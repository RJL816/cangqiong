"use strict";(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[0,656],{15296:function(e,t,a){a.r(t),t.default={company_info:"BDww5rnK_company_info",tree:"DZdyrpay_tree",search:"nacWuu6V_search",table:"gxoTPP9t_table",organization:"WXhdZRGq_organization",item:"_1A0DpeE5_item",managers:"avu5yVG7_managers",title:"NlOGNlbM_title",list:"_0BnofMH+_list",page:"_2FqD4aKG_page",avatar:"YK0gKCh4_avatar",loading:"OIbBwdKG_loading"}},70996:function(e,t,a){a.r(t),t.default={user_info:"_2T756X+h_user_info",item:"zopCz4ml_item",title:"WprfM4Ce_title",table:"avPrKPbU_table",container:"ytQm31U8_container"}},40072:function(e,t,a){var l=a(25028),n=a(9564);l(t,"__esModule",{value:!0}),t.default=function(e,t){(0,u.useEffect)((function(){if(e){var a=e&&new r.default(t);return a&&a.observe(e),function(){a&&a.disconnect(e)}}}),[e,t])};var u=a(65984),r=n(a(82504))},68692:function(e,t,a){var l=a(13568),n=a(93252),u=a(25028),r=a(4884),d=a(9564);u(t,"__esModule",{value:!0}),t.default=void 0;var i=d(a(26048)),c=d(a(78912)),f=d(a(35256)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=l(e)&&"function"!=typeof e)return{default:e};var a=v(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},d=u&&r;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=d?r(e,i):null;c&&(c.get||c.set)?u(n,i,c):n[i]=e[i]}return n.default=e,a&&a.set(e,n),n}(a(65984)),s=a(82416),m=["onChange","value"];function v(e){if("function"!=typeof n)return null;var t=new n,a=new n;return(v=function(e){return e?a:t})(e)}t.default=function(e){var t=e.onChange,a=e.value,l=(0,f.default)(e,m),n=(0,o.useState)(a||""),u=(0,c.default)(n,2),r=u[0],d=u[1],v=(0,o.useRef)(!1),E=(0,o.useRef)(/firefox/i.test(window.navigator.userAgent));(0,o.useEffect)((function(){d(a)}),[a]);var p=(0,o.useCallback)((function(e){d(e),!v.current&&t&&t(e)}),[t]),g=(0,o.useCallback)((function(){v.current=!0}),[]),_=(0,o.useCallback)((function(e){v.current=!1,!E.current&&t&&t(r)}),[r,t]);return o.default.createElement("div",{className:"kd-nc-search-input"},o.default.createElement(s.Text,(0,i.default)({value:r,onCompositionStart:g,onCompositionEnd:_,onChange:p},l)))}},51e3:function(e,t,a){var l=a(13568),n=a(13939),u=a(34716),r=a(70696),d=a(4884),i=a(3464),c=a(51400),f=a(25028),o=a(93252),s=a(9564);f(t,"__esModule",{value:!0}),t.renderMore=t.renderAvatar=t.default=void 0;var m=s(a(23992)),v=s(a(29052)),E=s(a(96631)),p=s(a(94924)),g=s(a(78912)),_=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=l(e)&&"function"!=typeof e)return{default:e};var a=x(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},u=f&&d;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=u?d(e,r):null;i&&(i.get||i.set)?f(n,r,i):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}(a(65984)),h=a(63548),b=a(82416),N=s(a(15296)),y=a(25096),C=a(57264),w=s(a(86920)),S=s(a(40072)),k=a(63516),O=s(a(68692)),M=s(a(75020));function x(e){if("function"!=typeof o)return null;var t=new o,a=new o;return(x=function(e){return e?a:t})(e)}function R(e,t){var a=n(e);if(u){var l=u(e);t&&(l=r(l).call(l,(function(t){return d(e,t).enumerable}))),a.push.apply(a,l)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,E.default)(e,t,a[t])})):i?c(e,i(a)):R(Object(a)).forEach((function(t){f(e,t,d(a,t))}))}return e}var P=t.renderAvatar=function(e){return _.default.createElement(b.Avatar,{className:N.default.avatar,src:e,alt:""})},T=t.renderMore=function(e,t,a){return _.default.createElement(b.BtnField,{type:"text",major:!0,onClick:function(){return D(t)}},"详情")},D=function(e){var t=(0,C.autoModalHeight)(520,640,640,_.default.createElement(w.default,{data:e}));h.Modal.confirm({title:"员工信息",showline:!0,footer:null,titleIcon:null,width:640,height:t,type:"normal",bodyStyle:{padding:0,overflow:"hidden"},body:_.default.createElement(w.default,{data:e}),closable:!0,maskClosable:!1})};t.default=_.default.memo((function(){var e=(0,_.useState)([]),t=(0,g.default)(e,2),a=t[0],l=t[1],n=(0,_.useState)([]),u=(0,g.default)(n,2),r=u[0],d=u[1],i=(0,_.useState)([]),c=(0,g.default)(i,2),f=c[0],o=c[1],s=(0,_.useState)([]),E=(0,g.default)(s,2),w=E[0],x=E[1],R=(0,_.useState)(null),D=(0,g.default)(R,2),j=D[0],A=D[1],G=(0,_.useState)(0),K=(0,g.default)(G,2),B=K[0],I=K[1],Q=(0,_.useState)(""),H=(0,g.default)(Q,2),U=H[0],V=H[1],W=(0,_.useState)(""),Y=(0,g.default)(W,2),q=Y[0],F=Y[1],X=(0,_.useState)(200),Z=(0,g.default)(X,2),J=Z[0],L=Z[1],$=(0,_.useState)(!1),ee=(0,g.default)($,2),te=ee[0],ae=ee[1],le=(0,_.useRef)({page_size:10,page_no:1}),ne=(0,_.useRef)(null),ue=(0,_.useRef)([{code:"number",name:"员工编号",width:178},{code:"name",name:"员工姓名",width:178},{code:"avatar",name:"员工头像",align:"center",width:178,render:P},{code:"opera",name:"操作",width:100,render:T}]),re=(0,_.useCallback)((0,p.default)(v.default.mark((function e(){var t,a;return v.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={tree_deep:-1,id:""},ae(!0),e.next=4,(0,k.getStorage)("NOCODE_COMPANY_ORG_TREE");case 4:(a=e.sent)&&(ae(!1),de(a)),(0,y.getCompanyOrg)(t).then((function(e){ae(!1),de(e),(0,k.setStorage)("NOCODE_COMPANY_ORG_TREE",e)}));case 7:case"end":return e.stop()}}),e)}))),[a]),de=(0,_.useCallback)((function(e){var t,a,n=(0,C.formateTreeData)(e.rows);(l(n),A(n[0]),null!==(t=n[0])&&void 0!==t&&t.id)&&(le.current.page_no=1,le.current.filter="entryentity.dpt.number EQ ".concat(null===(a=n[0])||void 0===a?void 0:a.number),ce(le.current))}),[]),ie=(0,_.useCallback)((function(e,t,a){return e.some((function(e){return e.key===a?(e.children=t,!0):(ie(e.children,t,a),!1)})),e}),[]),ce=(0,_.useCallback)((function(e){(0,y.getOrgUsers)(e).then((function(e){var t;I(e.totalCount),d(e.rows);var a=null===(t=e.extra)||void 0===t||null===(t=t.managers)||void 0===t?void 0:(0,m.default)(t).call(t,(function(e){return e.name}));F(a.join("、"))}))}),[]),fe=(0,_.useCallback)((function(e,t){o(e)}),[a]),oe=(0,_.useCallback)((function(e,t){le.current=z(z({},le.current),{},{page_size:t,page_no:e}),ce(le.current)}),[]),se=(0,_.useCallback)((function(e){return new RegExp(U,"i").test(e.title)}),[U]);(0,S.default)(ne.current,(function(e){L(e[0].contentRect.height-50)}));var me=(0,M.default)(V);return(0,_.useEffect)((function(){re()}),[]),te?_.default.createElement("div",{className:N.default.loading},_.default.createElement(h.Spin,{name:"Spin",type:"container"})):_.default.createElement("div",{className:N.default.company_info},_.default.createElement("div",{className:N.default.tree},_.default.createElement("div",{className:N.default.search},_.default.createElement(O.default,{prefix:_.default.createElement(h.Icon,{prefix:"nocodeplatformicon",type:"sousuo"}),onChange:function(e){return me(e)},placeholder:"搜索",size:"small",borderType:"bordered"})),_.default.createElement(h.Tree,{name:"Tree",treeData:a,expandedKeys:f,onExpand:fe,filterTreeNode:se,filterValue:U,selectedKeys:w,onSelect:function(e,t){var a=t.node;le.current.page_no=1,le.current.filter="entryentity.dpt.number EQ ".concat(null==a?void 0:a.number),ce(le.current),A(a),x(e)},defaultExpandRoot:!0,height:"100%",virtual:!0,selectable:!0,estimatedItemSize:36})),_.default.createElement("div",{className:N.default.table},_.default.createElement("div",{className:N.default.organization},_.default.createElement("div",{className:N.default.item},_.default.createElement("div",{className:N.default.title},"组织编号"),_.default.createElement("div",null,(null==j?void 0:j.number)||"-")),_.default.createElement("div",{className:N.default.item},_.default.createElement("div",{className:N.default.title},"组织名称"),_.default.createElement("div",null,(null==j?void 0:j.name)||"-")),_.default.createElement("div",{className:N.default.item},_.default.createElement("div",{className:N.default.title},"上级组织"),_.default.createElement("div",null,(null==j?void 0:j.parentname)||"-")),_.default.createElement("div",{className:N.default.item},_.default.createElement("div",{className:N.default.title},"组织负责人"),_.default.createElement("div",{className:N.default.managers},q||"-"))),_.default.createElement("div",{ref:ne,className:N.default.list},_.default.createElement(b.DataGrid,{emptyCellHeight:J,style:{height:"100%"},columns:ue.current,dataSource:r})),_.default.createElement("div",{className:N.default.page},_.default.createElement(h.Pagination,{pageType:"nicety",current:le.current.page_no,showQuickJumper:!1,showSizeChanger:!0,pageSize:le.current.page_size,dropdownProps:{getPopupContainer:function(){return document.body}},onChange:oe,total:B}))))}))},86920:function(e,t,a){var l=a(25028),n=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var u=n(a(23992)),r=n(a(65984)),d=a(82416),i=n(a(70996));t.default=r.default.memo((function(e){var t,a=e.data;return r.default.createElement("div",{className:i.default.user_info},r.default.createElement("div",null,r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"员工编号"),r.default.createElement("div",null,(null==a?void 0:a.number)||"-")),r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"姓名"),r.default.createElement("div",null,(null==a?void 0:a.name)||"-"))),r.default.createElement("div",null,r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"头像"),r.default.createElement(d.Avatar,{src:null==a?void 0:a.avatar,alt:""})),r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"性别"),r.default.createElement("div",null,(null==a?void 0:a.gender)||"-"))),r.default.createElement("div",null,r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"生日"),r.default.createElement("div",null,(null==a?void 0:a.birthday)||"-")),r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"手机号"),r.default.createElement("div",null,(null==a?void 0:a.phone)||"-"))),r.default.createElement("div",null,r.default.createElement("div",{className:i.default.item},r.default.createElement("div",{className:i.default.title},"邮箱"),r.default.createElement("div",null,(null==a?void 0:a.email)||"-"))),(null==a?void 0:a.orgs)&&(null==a?void 0:a.orgs.length)>0&&r.default.createElement("div",{className:i.default.table},r.default.createElement("table",{cellSpacing:1,cellPadding:1},r.default.createElement("tr",null,r.default.createElement("th",null,"所属组织编码"),r.default.createElement("th",null,"组织名称")),null==a||null===(t=a.orgs)||void 0===t?void 0:(0,u.default)(t).call(t,(function(e,t){return r.default.createElement("tr",{key:e.orgNum+t},r.default.createElement("td",null,e.orgNum),r.default.createElement("td",null,e.orgName))})))))}))}}]);