"use strict";(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[415],{20552:function(e,t,n){n.r(t),t.default={icon_pop:"L4d1n3Co_icon_pop",pop:"wDS8lVOy_pop",pop_main:"pM5A9eK0_pop_main",colors:"RHIwvsm9_colors",icons:"+e5WT0CW_icons","icon-item-f-style":"LUv9eLkI_icon-item-f-style","icon-item-f-style-active":"FbkEq6b8_icon-item-f-style-active"}},4200:function(e,t,n){n.r(t),t.default={pop:"js8Jd4ya_pop",avatar:"coK+fk++_avatar"}},58495:function(e,t,n){n.r(t),t.default={"nocode-save-template-modal":"_6F96kUhg_nocode-save-template-modal","nocode-save-template-modal-form-item-checkbox":"_1cAwLZM5_nocode-save-template-modal-form-item-checkbox","nocode-save-template-modal-footer":"s2nsVvte_nocode-save-template-modal-footer","nocode-save-template-modal-body":"+fqon2-X_nocode-save-template-modal-body","nocode-save-template-upload-wrapper":"qz3PdAnC_nocode-save-template-upload-wrapper","icon-selector":"lnxgyB0B_icon-selector","nocode-save-template-upload-desc":"Pc+XS6pH_nocode-save-template-upload-desc","checkbox-group":"ImKtv5OJ_checkbox-group",checkbox:"dHGjNzbj_checkbox"}},43332:function(e,t,n){var a=n(13568),l=n(93252),o=n(25028),r=n(4884),u=n(9564);o(t,"__esModule",{value:!0}),t.default=void 0;var c=u(n(26048)),i=n(41936),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},u=o&&r;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var i=u?r(e,c):null;i&&(i.get||i.set)?o(l,c,i):l[c]=e[c]}return l.default=e,n&&n.set(e,l),l}(n(65984)),f=n(34896);function s(e){if("function"!=typeof l)return null;var t=new l,n=new l;return(s=function(e){return e?n:t})(e)}t.default=(0,d.memo)((function(e){var t=e.children,n=e.to,a=(0,i.useLocation)().search,l=n;return l=(0,f.urlParamWithDebug)(l,a),d.default.createElement(i.Link,(0,c.default)({},e,{to:l}),t)}))},10352:function(e,t,n){var a=n(13568),l=n(93252),o=n(25028),r=n(4884),u=n(9564);o(t,"__esModule",{value:!0}),t.default=void 0;var c=u(n(23992)),i=u(n(96631)),d=u(n(78912)),f=n(63548),s=u(n(71252)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},u=o&&r;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var i=u?r(e,c):null;i&&(i.get||i.set)?o(l,c,i):l[c]=e[c]}return l.default=e,n&&n.set(e,l),l}(n(65984)),v=u(n(20552));function p(e){if("function"!=typeof l)return null;var t=new l,n=new l;return(p=function(e){return e?n:t})(e)}t.default=m.default.memo((function(e){var t,n,a=e.data,l=e.colorIndex,o=e.iconIndex,r=e.onSelect,u=e.isLineIconStyle,p=(0,m.useState)(0),g=(0,d.default)(p,2),h=g[0],_=g[1],y=(0,m.useState)(0),b=(0,d.default)(y,2),E=b[0],k=b[1],x=(0,m.useRef)(null);(0,m.useEffect)((function(){_(l)}),[l]),(0,m.useEffect)((function(){k(o)}),[o]);var C=(0,m.useCallback)((function(e,t){_(e),k(t),null==r||r(e,t)}),[r,a]);return(0,m.useLayoutEffect)((function(){var e,t,n,l=null===(e=x.current)||void 0===e?void 0:e.getElementsByTagName("path");l&&(Array.prototype.forEach.call(l,(function(e){return e.removeAttribute("style")})),u?null===(t=l[E])||void 0===t||t.setAttribute("style","fill:".concat(null==a?void 0:a.colors[h].value)):null===(n=l[E])||void 0===n||n.setAttribute("style","fill:#fff"))}),[E,h,x.current]),m.default.createElement("div",{className:v.default.pop_main},m.default.createElement("div",{className:v.default.colors},null==a?void 0:(0,c.default)(t=a.colors).call(t,(function(e,t){return m.default.createElement("div",{key:t,onClick:function(){return C(t,E)},style:{backgroundColor:e.value}},h===t&&m.default.createElement(f.Icon,{prefix:"nocodeplatformicon",type:"gouxuan"}))}))),m.default.createElement("div",{ref:x,className:v.default.icons},null==a?void 0:(0,c.default)(n=a.svgs).call(n,(function(e,t){var n=E===t?null==a?void 0:a.colors[h].value:"",l=E===t?"#fff":"";return m.default.createElement("div",{key:t,onClick:function(){return C(h,t)},className:(0,s.default)((0,i.default)((0,i.default)({},v.default["icon-item-f-style"],u),v.default["icon-item-f-style-active"],u&&E===t)),style:{backgroundColor:u?l:n,color:u?n:l},dangerouslySetInnerHTML:{__html:e.content}})}))))}))},6896:function(e,t,n){var a=n(13568),l=n(93252),o=n(25028),r=n(4884),u=n(9564);o(t,"__esModule",{value:!0}),t.default=void 0;var c=u(n(1900)),i=u(n(760)),d=u(n(78912)),f=n(63548),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},u=o&&r;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var i=u?r(e,c):null;i&&(i.get||i.set)?o(l,c,i):l[c]=e[c]}return l.default=e,n&&n.set(e,l),l}(n(65984)),m=u(n(4200)),v=u(n(10352)),p=n(57264),g=u(n(71252));function h(e){if("function"!=typeof l)return null;var t=new l,n=new l;return(h=function(e){return e?n:t})(e)}t.default=s.default.memo((function(e){var t=e.onChange,n=e.image,a=e.placement,l=e.triggerClassName,o=e.popperClassName,r=e.isLineIconStyle,u=e.svgData,h=e.readonly,_=(0,s.useState)({colorIndex:void 0,iconIndex:void 0}),y=(0,d.default)(_,2),b=y[0],E=y[1],k=(0,s.useRef)(null),x=(0,s.useCallback)((function(e,t){var n,a,l=(0,p.getQueryString)("color",e),o=(0,p.getQueryString)("svg",e),r=l&&"undefined"!==l?null==t||null===(n=t.colors)||void 0===n?void 0:(0,c.default)(n).call(n,(function(e){return e.value===l||e.key===l})):0,u=o&&"undefined"!==o?null==t||null===(a=t.svgs)||void 0===a?void 0:(0,c.default)(a).call(a,(function(e){return e.label===o})):0;E({colorIndex:r,iconIndex:u})}),[]),C=function(e,t){E({colorIndex:e,iconIndex:t})};(0,s.useLayoutEffect)((function(){var e,t;if(u&&k.current){var n=r?null==u||null===(e=u.colors)||void 0===e||null===(e=e[b.colorIndex])||void 0===e?void 0:e.value:"#fff";null===(t=k.current.getElementsByTagName("path"))||void 0===t||null===(t=t[0])||void 0===t||t.setAttribute("style","fill:".concat(n," "))}}),[u,b,k.current,r]),(0,s.useEffect)((function(){x(n,u)}),[n,u]);var I=(0,s.useCallback)((function(e){if(e)x(n,u);else{var a,l,o,r=encodeURIComponent(null==u||null===(a=u.colors)||void 0===a||null===(a=a[b.colorIndex])||void 0===a?void 0:a.value),c=null==u||null===(l=u.svgs)||void 0===l?void 0:l[b.iconIndex].label,d=(0,i.default)(o="nocode/v2/nocode_sys/common/svgs/create_svg_line?color=".concat(r,"&svg=")).call(o,c);null==t||t(d)}}),[u,b,t]),w=(0,s.useMemo)((function(){return s.default.createElement(v.default,{data:u,iconIndex:b.iconIndex,colorIndex:b.colorIndex,onSelect:C,isLineIconStyle:r})}),[u,b,r]),L=(0,s.useMemo)((function(){var e,t;return s.default.createElement("div",{ref:k,className:(0,g.default)(m.default.avatar,l),style:{backgroundColor:r?"":null==u||null===(e=u.colors)||void 0===e||null===(e=e[b.colorIndex])||void 0===e?void 0:e.value},dangerouslySetInnerHTML:{__html:(null==u||null===(t=u.svgs)||void 0===t||null===(t=t[b.iconIndex])||void 0===t?void 0:t.content)||""}})}),[u,b,r]);return h?L:s.default.createElement(f.Tooltip,{placement:a||"rightTop",arrow:!1,popperClassName:(0,g.default)(m.default.pop,o),gap:0,tip:w,trigger:"click",onVisibleChange:I},L)}))},54864:function(e,t,n){var a=n(13568),l=n(13939),o=n(34716),r=n(70696),u=n(4884),c=n(3464),i=n(51400),d=n(25028),f=n(93252),s=n(9564);d(t,"__esModule",{value:!0}),t.default=t.INIT_TEMPLATE_VALUE=void 0;var m=s(n(29052)),v=s(n(26048)),p=s(n(94924)),g=s(n(78912)),h=s(n(99148)),_=s(n(96631)),y=s(n(23992)),b=s(n(99308)),E=s(n(760)),k=s(n(70696)),x=s(n(50524)),C=s(n(28429)),I=s(n(73020)),w=s(n(25288)),L=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=a(e)&&"function"!=typeof e)return{default:e};var n=R(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},o=d&&u;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var c=o?u(e,r):null;c&&(c.get||c.set)?d(l,r,c):l[r]=e[r]}return l.default=e,n&&n.set(e,l),l}(n(65984)),N=n(63548),T=n(37220),F=n(82416),M=s(n(58495)),A=s(n(6896)),S=n(25096),O=n(59876),j=n(66028);function R(e){if("function"!=typeof f)return null;var t=new f,n=new f;return(R=function(e){return e?n:t})(e)}function B(e,t){var n=l(e);if(o){var a=o(e);t&&(a=r(a).call(a,(function(t){return u(e,t).enumerable}))),n.push.apply(n,a)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,_.default)(e,t,n[t])})):c?i(e,c(n)):B(Object(n)).forEach((function(t){d(e,t,u(n,t))}))}return e}var V="nocode-save-template",D=function(e){return(0,y.default)(e).call(e,(function(e){return e.id}))},q=t.INIT_TEMPLATE_VALUE={name:"",desc:"",icon:"",domains:[],trades:[]},z={domains:[],trades:[]},U=function(e,t){return P(P({},e),t)},H=function(e){var t=e.value,n=e.onChange,a=e.options,l=function(e,a){var l,o=e.target.checked?(0,h.default)(new b.default((0,E.default)(l=[]).call(l,(0,h.default)(t),[a]))):(0,k.default)(t).call(t,(function(e){return e!==a}));null==n||n(o)};return L.default.createElement("div",{className:M.default["checkbox-group"]},L.default.createElement(N.Checkbox,{className:M.default.checkbox,checked:t.length===a.length,value:"all",key:"all",onChange:function(e){var t;t=e.target.checked?(0,y.default)(a).call(a,(function(e){return e.id})):[],null==n||n(t)}},"全部"),(0,y.default)(a).call(a,(function(e){return L.default.createElement(N.Checkbox,{className:M.default.checkbox,value:e.id,key:e.id,checked:(0,x.default)(t).call(t,e.id),onChange:function(t){return l(t,e.id)}},e.name)})))},W=(0,L.forwardRef)((function(e,t){var n=e.prefixCls,a=e.value,l=e.svgData,o=N.Form.useForm(),r=(0,g.default)(o,1)[0],u=(0,L.useReducer)(U,z),c=(0,g.default)(u,2),i=c[0],d=c[1],f=(0,L.useReducer)(j.assignDataReducer,a||q),s=(0,g.default)(f,2),v=s[0],h=s[1];(0,L.useEffect)((function(){_()}),[]);var _=(0,L.useCallback)((0,p.default)(m.default.mark((function e(){var t,n,a,l,o,r,u,c;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,T.getTradesAndDomains)();case 3:t=e.sent,n=t.rows,l=(a=void 0===n?[]:n)[0]||{},o=l.domains,r=void 0===o?[]:o,u=a[1]||{},c=u.trades,d({domains:r,trades:void 0===c?[]:c}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),[d]);(0,L.useImperativeHandle)(t,(function(){return{validateFields:y}}));var y=function(){return new C.default((function(e,t){r.validateFields().then((function(t){var n=(0,I.default)(t);e(n)})).catch((function(e){return t(e)}))}))};return(0,L.useEffect)((function(){if(a){var e=a.name,t=a.icon,n=a.trades,l=a.domains,o=a.desc;r.setFieldsValue({name:e,icon:t||O.DEFAULT_FORM_IMAGE,trades:D(n),domains:D(l),desc:o})}}),[]),L.default.createElement("div",{className:M.default["".concat(n,"-modal-body")]},L.default.createElement(N.Form,{layout:"vertical",form:r,labelWidth:"100%",wrapperWidth:"100%",onValuesChange:function(e,t){}},L.default.createElement(N.Form.Item,{label:"模板名称",name:"name",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入模板名称"},{type:"string",validator:function(e,t,n,a,l){return null!=t&&(0,w.default)(t).call(t)?[]:[new Error("请输入模板名称")]}}]},L.default.createElement(N.Input,{type:"text",value:v.name,borderType:"bordered",size:"large",placeholder:"请输入模板名称",maxLength:50,onChange:function(e){h({name:e.target.value})}})),L.default.createElement(N.Form.Item,{label:"图标",name:"icon",required:!0,validateTrigger:"onBlur"},L.default.createElement(A.default,{isLineIconStyle:!0,placement:"bottomLeft",triggerClassName:M.default["icon-selector"],svgData:l,image:v.icon||O.DEFAULT_FORM_IMAGE,onChange:function(e){r.setFieldValue("icon",e),h({icon:e})}})),L.default.createElement(N.Form.Item,{label:"模板描述",name:"desc",validateTrigger:"onBlur"},L.default.createElement(F.Textarea,{size:"large",value:v.desc,autoSize:{minRows:3,maxRows:3},borderType:"bordered",placeholder:"请输入模板描述",onChange:function(e){return h({desc:e})},maxLength:255,showCount:!0})),L.default.createElement(N.Form.Item,{className:M.default["".concat(n,"-modal-form-item-checkbox")],label:"领域",name:"domains",rules:[{required:!0,message:"请选择领域"}]},L.default.createElement(H,{value:v.domains,options:i.domains,onChange:function(e){h({domains:e}),r.setFieldValue("domains",e)}})),L.default.createElement(N.Form.Item,{className:M.default["".concat(n,"-modal-form-item-checkbox")],label:"行业",name:"trades",rules:[{required:!0,message:"请选择行业"}]},L.default.createElement(H,{value:v.trades,options:i.trades,onChange:function(e){h({trades:e}),r.setFieldValue("trades",e)}}))))})),G=function(e){var t=e.prefixCls,n=e.confirmBtnProps,a=void 0===n?{}:n,l=e.onCancel,o=e.onConfirm;return L.default.createElement("div",{className:M.default["".concat(t,"-modal-footer")]},L.default.createElement(N.Button,{onClick:l,type:"second",size:"small",className:M.default["".concat(t,"-modal-cancel-btn")]},"取消"),L.default.createElement(N.Button,(0,v.default)({type:"primary",size:"small",style:{marginLeft:"12px"},onClick:o,className:M.default["".concat(t,"-modal-ok-btn")]},a),"确定"))};t.default=function(e){var t=e.title,n=e.value,a=e.visible,l=e.setVisible,o=e.onConfirm,r=e.confirmBtnProps,u=(0,L.useRef)(null),c=(0,L.useState)({}),i=(0,g.default)(c,2),d=i[0],f=i[1],s=function(){var e=(0,p.default)(m.default.mark((function e(){var t,n;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.getLineIconAndColor)();case 3:t=e.sent,n=t.row,f(void 0===n?{}:n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,L.useEffect)((function(){s()}),[]);var v=function(){(0,u.current.validateFields)().then((function(e){var t=e.name;e=P(P({},e),{},{name:(0,w.default)(t).call(t)}),l(!1),null==o||o(e)})).catch((function(e){}))},h=function(){l(!1)};return L.default.createElement(N.Modal,{mask:!0,visible:a,body:L.default.createElement(W,{prefixCls:V,ref:u,value:n,svgData:d}),titleIcon:null,className:M.default["".concat(V,"-modal")],footer:L.default.createElement(G,{prefixCls:V,confirmBtnProps:r,onConfirm:v,onCancel:h}),maskClosable:!1,width:480,height:830,keyboard:!1,title:t||"保存为模板",closable:!0,draggable:!1,destroyOnClose:!0,onCancel:h,onOk:v})}}}]);