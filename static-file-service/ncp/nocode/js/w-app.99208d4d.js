"use strict";(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[560],{5480:function(e,t,a){a.r(t),t.default={modal:"_6P32Nzmm_modal",modalBody:"_3vhPyGtn_modalBody",modalFooter:"_0FNe3CpY_modalFooter",modalFooterRight:"_2w5lqUPs_modalFooterRight",modalFooterBtn:"XvFraAx2_modalFooterBtn",fieldItem:"D7Pu4N+N_fieldItem"}},8748:function(e,t,a){a.r(t),t.default={app_header:"ktcF3PYR_app_header",left:"_9AxCdhZ5_left",ml12:"qWnmYsCZ_ml12",app_logo:"tSwGKkBI_app_logo",app_name:"SSQ2qPT1_app_name",nav:"P7qM9tdg_nav",user:"CIaFqBSZ_user",user_item:"TdUzpAnv_user_item",avatar_wrapper:"YDDMCYIZ_avatar_wrapper",avatar:"TH+650J4_avatar",app_container:"fXYCMBVS_app_container",user_info_pop:"_3BUVbZ1F_user_info_pop"}},48640:function(e,t,a){a.r(t),t.default={app_left:"J-FOgXA9_app_left","leaf-icon-wrapper":"tsNn+cDH_leaf-icon-wrapper",avatar:"t0RjazoE_avatar","empty-group":"C8aBKBa-_empty-group",search:"BIfT2sQl_search","search-icon":"k54CQOJ1_search-icon","group-node-hover":"_5Y7shU38_group-node-hover",blue:"jdAXE2P0_blue","switch-icon":"mps35ixO_switch-icon",app_main:"_6PDgQBQf_app_main",app_main_bg:"xiDIoCV9_app_main_bg",title:"GLiPVPX8_title","title-name":"h2Z7KB3r_title-name","go-designer":"w-9VVRZu_go-designer"}},26688:function(e,t,a){a.r(t),t.default={base:"O1zyc0rU_base",name_field:"JgZKgY3D_name_field",input_error:"Yj1Rh3Jc_input_error",name:"OTjTUUwV_name",empty_tip:"_1B01kiPE_empty_tip",dot:"B-qq8uHk_dot",hidden_field:"ytHb7azd_hidden_field",hidden_name:"fbgOvGPz_hidden_name",hidden_wrapper:"Ji0qsMFt_hidden_wrapper",orgs_field:"+Blo+1wn_orgs_field",orgs_name:"VfQ+CpWo_orgs_name",person_field:"Fe0D0ZTE_person_field",person_name:"lIMuSzrh_person_name","tab-editor":"HVinxl5z_tab-editor","tab-editor-item":"o8G5rp3A_tab-editor-item","is-active":"KrAug184_is-active",setting_option:"_2E6m9jBC_setting_option",setting_option_timeitem_wrapper:"_2Z16rxVO_setting_option_timeitem_wrapper",setting_option_timeitem:"GXZvFfBJ_setting_option_timeitem",setting_option_item:"HSsrOBoN_setting_option_item",setting_option_name:"sd9+m-k2_setting_option_name",edit_item:"_5OF88OBN_edit_item"}},50032:function(e,t,a){a.r(t),t.default={layout:"jQn3Zs+b_layout",head:"lEhMJ5Vd_head",search:"N3idDjuA_search",body:"NzxCQHJ7_body",footer:"O29oxuIy_footer",clear:"Q075H-R+_clear",item_content:"loVwSEO9_item_content",label:"_9g3Fos28_label",count:"_4BQAm+JD_count"}},98764:function(e,t,a){a.r(t),t.default={layout:"YOwHo1WE_layout",head:"NDPeFpUz_head",body:"-2FfTb1g_body",filtereditor:"SvGXeCeZ_filtereditor",editor_bottom:"OpXL1iQP_editor_bottom",footer:"_2JenMy5w_footer",clear:"aogiJCC5_clear",item_content:"VcbjsXeP_item_content",label:"jhFHXE5J_label",count:"iy4Efyv6_count",with_filter_footer:"gSm8q8Ia_with_filter_footer"}},27804:function(e,t,a){a.r(t),t.default={side_bar:"CnKEP5+L_side_bar"}},78064:function(e,t,a){a.r(t),t.default={layout:"_2fwWkkO4_layout",head:"N+JBAPre_head",body:"_0QTcb--J_body",footer:"mkdLJcki_footer",clear:"tilRIwj3_clear",item_content:"_2aJp72Zi_item_content",label:"OuCea6dn_label",count:"cFGXAybf_count"}},21348:function(e,t,a){a.r(t),t.default={layout:"_9xCoS+le_layout",title:"gt0cDyE7_title"}},3012:function(e,t,a){a.r(t),t.default={view_config:"LAQynChd_view_config",config_body:"_2vLtSPkg_config_body",footer:"Tz+cc4+3_footer"}},28424:function(e,t,a){a.r(t),t.default={container:"xZCkvLlf_container",main:"Q4tOYR7D_main",actions:"bWy1YpOa_actions",buttons:"UauZzE7y_buttons",buttonsChild:"pGUbxXTz_buttonsChild",toolbarItem:"_9hxMKAcW_toolbarItem",dropdown:"G5v3uNwU_dropdown",toolbarIcon:"bTs9mrxX_toolbarIcon",svgIcon:"D57oEenD_svgIcon",vas_action:"IE4yQ52l_vas_action",search:"_4DAkdQkg_search","search-icon":"+sOWIZZw_search-icon",split_line:"p0ji3vEu_split_line",refresh:"_1yOhcDKz_refresh",refresh_load:"B-0JbAbj_refresh_load",fullscreen:"-8WLaLyw_fullscreen",list:"a+6TzMd-_list",nav:"RVTtC7kZ_nav",btn:"lmIDBi2N_btn","btn-active":"avPw+fjY_btn-active",tab:"ESYNR47Z_tab",tab_name:"aTpmAIzV_tab_name","filter-bar":"O129BCan_filter-bar","filter-label-bar":"CqIf1MhZ_filter-label-bar",setting:"PVuYjJK5_setting","row-setting":"bIz6uQSC_row-setting",table_list:"Xu4D4ge8_table_list",page:"_2Rk6iEn1_page",page_total:"S-M6H+mE_page_total","container-full-screen":"BpZlnBP9_container-full-screen",pop_bill:"_5X6H8833_pop_bill",pop_container:"H0rgIR0u_pop_container",head_filter_tab_header:"FkWuPBoO_head_filter_tab_header"}},51764:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,a=(0,i.useRef)(0),n=(0,i.useRef)(!1),l=function(){n.current=!0,clearTimeout(a.current)};(0,i.useEffect)((function(){return l}),[]);var c=function(){var i=(0,o.default)(r.default.mark((function o(){return r.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e(l);case 3:r.next=9;break;case 5:throw r.prev=5,r.t0=r.catch(0),new Error("轮询出错：",r.t0);case 9:if(!n.current){r.next=11;break}return r.abrupt("return");case 11:return r.abrupt("return",a.current=(0,u.default)(c,t));case 12:case"end":return r.stop()}}),o,null,[[0,5]])})));return function(){return i.apply(this,arguments)}}(),d=function(){var e=(0,o.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.current=!1,e.next=3,c();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return[d,l]};var r=l(a(29052)),u=l(a(67584)),o=l(a(94924)),i=a(65984)},29084:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.showBatchErrNotice=t.getErrTips=t.TextUpdateOptions=t.SensitiveTypes=t.NoBatchEditTypes=t.NoBatchEditStatus=t.MultiUpdateOptions=t.DefaultUpdateWay=void 0;var r=l(a(760)),u=a(57264),o=(t.NoBatchEditTypes=["nocodecreatorfield","nocodecreatedatefield","nocodemodifierfield","nocodemodifydatefield","nocodebillnofield","nocodeattachmentuploadfield","nocodeimageuploadfield","nocodegraphicdisplayfield","nocoderichtextfield","nocodeentryentity"],t.NoBatchEditStatus=["2","3","4"],t.SensitiveTypes=["text","textarea"],t.DefaultUpdateWay="update"),i=(t.MultiUpdateOptions=[{label:"追加",value:"add"},{label:"覆盖",value:o}],t.TextUpdateOptions=[{label:"覆盖",value:o},{label:"关键词替换",value:"replace"}],t.getErrTips=function(){var e,t,a,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"操作",o=n?(0,r.default)(e="".concat(n,"条记录")).call(e,u,"成功"):"",i=l?(0,r.default)(t="".concat(l,"条记录")).call(t,u,"失败"):"";return(0,r.default)(a="".concat(o)).call(a,i?"，".concat(i):"","。")});t.showBatchErrNotice=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"操作",a=e.data,n=void 0===a?{}:a,l=e.message;if(n){var o,c=n.successCount,d=n.failCount;(0,u.showNotice)("error",(0,r.default)(o="".concat(i(c,d,t))).call(o,l?"\n".concat(l):""))}else(0,u.showNotice)("error",l)}},4804:function(e,t,a){var n=a(13939),l=a(34716),r=a(70696),u=a(4884),o=a(3464),i=a(51400),c=a(25028),d=a(9564);c(t,"__esModule",{value:!0}),t.removeAllItem=t.getValueArray=t.getInputType=t.getFormatType=t.getFilterItemValue=t.getEnumList=t.getDefaultFilterList=t.formatValue=t.convertItems=t.convertCompareTypes=t.VALUE_EMPTY_COMPARE_TYPE=t.SelectTypes=t.MULTI_COMPARE_TYPE=t.INPUT_TYPE=t.COMPARE_TYPE=void 0;var f=d(a(96631)),s=d(a(35256)),m=d(a(13568)),p=d(a(70696)),v=d(a(38456)),h=d(a(23992)),g=d(a(1900)),_=d(a(50524)),y=a(57264),b=a(12700),E=["items"];function C(e,t){var a=n(e);if(l){var o=l(e);t&&(o=r(o).call(o,(function(t){return u(e,t).enumerable}))),a.push.apply(a,o)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,f.default)(e,t,a[t])})):o?i(e,o(a)):C(Object(a)).forEach((function(t){c(e,t,u(a,t))}))}return e}var k=t.INPUT_TYPE=function(e){return e.notInput="notInput",e.text="text",e.number="number",e.dateTime="datetime",e.none="none",e.dateRange="dateRange",e.select="select",e.multiSelect="multiSelect",e.enumEq="enum_eq",e.refbill="refbill",e.textarea="textarea",e}({}),x=(t.COMPARE_TYPE=function(e){return e.enumEq="001",e}({}),t.SelectTypes=[k.select,k.multiSelect]),I=t.removeAllItem=function(e){return(0,p.default)(e).call(e,(function(e){return"all"!==e.type}))},S=(t.getInputType=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=((0,v.default)(e).call(e,(function(e){return e.value===t}))||{}).inputCtlType;return n===k.select&&a?k.multiSelect:n},t.getEnumList=function(e){var t;return(0,h.default)(t=I(e)).call(t,(function(e,t){return{value:t,label:e.label,fieldValue:e.fieldValue}}))},t.getValueArray=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Array.isArray(e)?(0,h.default)(e).call(e,(function(e){var a=(0,g.default)(t).call(t,(function(t){return t.fieldValue===e.fieldValue}));return a>-1?a:e.label})):[]}),N=(t.getFilterItemValue=function(e,t,a){return t===k.enumEq?"object"===(0,m.default)(null==e?void 0:e[0])?S(e,a):e:(0,_.default)(x).call(x,t)||t===k.refbill?Array.isArray(e)?null==e?void 0:(0,h.default)(e).call(e,(function(e){return(null==e?void 0:e.fieldValue)||e||""})):e:t===k.dateRange?null==e?void 0:(0,h.default)(e).call(e,(function(e){return e.fieldValue||""})):(null==e||null===(n=e[0])||void 0===n?void 0:n.fieldValue)||"";var n},["second","date","month","year"]),F=["yyyy-MM-dd hh:mm:ss","yyyy-MM-dd","yyyy-MM","yyyy"],T=[k.dateRange,k.dateTime],A=(t.getFormatType=function(e){return N[Number(e)]},t.formatValue=function(e,t,a){if((0,_.default)(T).call(T,a)){var n=F[Number(t)];if(e instanceof Date)return(0,y.dateFormat)(n,e);if(Array.isArray(e))return(0,h.default)(e).call(e,(function(e){return(0,y.dateFormat)(n,e)}))}return e},t.convertCompareTypes=function(e){return(0,h.default)(e).call(e,(function(e){var t;return{label:null===(t=e.name)||void 0===t?void 0:t.zh_CN,value:e.id,inputCtlType:e.inputCtlType}}))}),M=t.convertItems=function(e){return e&&(0,h.default)(e).call(e,(function(e){var t;return{value:e.value,label:null==e||null===(t=e.name)||void 0===t?void 0:t.zh_CN}}))};t.getDefaultFilterList=function(e,t){var a=(0,b.filterDataTransform)(e,t);return a.length?(0,h.default)(a).call(a,(function(e,t){var a=e.items,n=(0,s.default)(e,E);return w(w({},n),{},{compareTypes:A(e.compareTypes),valueList:M(a)||[],id:t,key:n.number+(0,y.getRandomValues)()})})):[]},t.VALUE_EMPTY_COMPARE_TYPE=["501","502","701","702"],t.MULTI_COMPARE_TYPE=["1502","1501"]},46412:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(23992)),p=s(a(760)),v=s(a(50524)),h=s(a(68456)),g=s(a(38456)),_=s(a(33260)),y=s(a(96631)),b=s(a(78912)),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=T(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),C=a(63548),w=a(82416),k=s(a(5480)),x=a(98464),I=a(57264),S=a(60644),N=a(29084),F=a(16428);function T(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(T=function(e){return e?a:t})(e)}function A(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):i?c(e,i(a)):A(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var P=(0,E.memo)((function(e){var t,a=e.labelText,n=void 0===a?"更新方式":a,l=e.options,r=e.value,u=e.defaultValue,o=e.onChange,i=e.className,c=(0,E.useState)((null==l||null===(t=l[0])||void 0===t?void 0:t.value)||""),d=(0,b.default)(c,2),f=d[0],s=d[1];(0,E.useEffect)((function(){s(r)}),[r]);var p=(0,E.useCallback)((function(e,t){s(t),null==o||o(t)}),[o]);return E.default.createElement(w.FieldItem,{labelText:n,className:i,showTitle:!0},E.default.createElement(C.Radio.Group,{defaultValue:u||f,value:f,onChange:p},null==l?void 0:(0,m.default)(l).call(l,(function(e){return E.default.createElement(C.Radio,{value:e.value,key:e.value},e.label)}))))})),D="add",L="update",O="replace",B=(0,E.memo)((function(e){e.visible;var t=e.controlMeta,a=e.refBillProps,n=e.colHeadFilter,l=e.isChange,r=e.opType,u=e.onChange,o=e.onUpdateChange,i=e.onSearchChange,c=t.entityId,d=t.isMulti,f=t.displayProp,s=t.items,m=t.fieldName,h=t.maxLength,g=(0,E.useState)([]),_=(0,b.default)(g,2),y=_[0],x=_[1],I=w.ListFilterUtil.getValueTypeByType,F=w.ListFilterUtil.getValue,T=w.ListFilterUtil.transform2Options,A=w.ListFilterUtil.createValue,D=I(t),L="select"===D&&!0===d?"multiSelect":D,B=F(L,y,null==n?void 0:n[m],d),V=M(M({},a),{},{batchInvokeListConfig:function(){return a.batchInvokeListConfig(c,t)},controlMeta:t,value:Array.isArray(B)?B.join(","):B,onChange:function(e){return U(Array.isArray(e)?e:""===e?[]:null==e?void 0:e.split(","),L)}}),U=function(e,t){var a=A(e,"number"===t?"decimal":t);x(a),null==u||u(a,t)};(0,E.useEffect)((function(){c&&"refbill"===D&&(null==a||a.batchInvokeQuery(c,{page_size:10,page_no:1,search:"",select:f})),l&&x([])}),[c,D,l]),(0,E.useEffect)((function(){o(d?N.MultiUpdateOptions[0].value:N.DefaultUpdateWay)}),[d,L]);var R=(0,E.useCallback)((function(e){return(null==t?void 0:t.ThousandsSeparator)?function(e){var t=e.split("."),a=/\B(?=(\d{3})+(?!\d))/g;if(2===t.length){var n,l=(0,b.default)(t,2),r=l[0],u=l[1];return(0,p.default)(n="".concat(r.replace(a,","),".")).call(n,u)}return t[0].replace(a,",")}("".concat(e)):String(e)}),[]),j=(0,E.useMemo)((function(){var e={},a=(null==t?void 0:t.dataRange)||{},n=a.min,l=a.max;return(0,S.isUndefined)(n)||""===n||(e.min=Number(n)),(0,S.isUndefined)(l)||""===l||(e.max=Number(l)),e}),[t]),K=(0,w.useKDRefBill)(V,!!a&&"refbill"===L),z=function(){var e={};switch(L){case"refbill":e=M(M({className:"kd-modal-body-refbill"},K),{},{value:B[0]});break;case"number":e=M(M({},j),{},{showStepper:!0,formatter:R,decimalLength:null==t?void 0:t.scale,digitLength:null==t?void 0:t.precision});break;case"textarea":e={maxLength:h,count:!0,showCount:!0};break;case"datetime":case"dateRange":e={formatType:null==t?void 0:t.formatType}}return e}(),q="refbill"===L?z.value:B,H=M(M({title:"更新为",name:"value",options:T(s),className:"kd-modal-body-infoValue",colHeadFilter:null==n?void 0:n[m],fieldType:L,borderType:"bordered",isMulti:d},z),{},{onChange:function(e){return U(e,L)},allowClear:"number"!==L,value:null==q?"":q});return E.default.createElement(E.default.Fragment,null,(0,v.default)(N.SensitiveTypes).call(N.SensitiveTypes,L)&&E.default.createElement("div",{className:k.default.updateVal},E.default.createElement(P,{className:k.default.fieldItem,options:N.TextUpdateOptions,value:r,defaultValue:N.TextUpdateOptions[0].value,onChange:o}),r===O&&E.default.createElement(E.default.Fragment,null,E.default.createElement(w.FieldItem,{className:k.default.fieldItem,labelText:"查找",showTitle:!0,required:!0},E.default.createElement(w.Text,{onChange:i})),E.default.createElement(w.FieldItem,{className:k.default.fieldItem,labelText:"替换为",showTitle:!0},E.default.createElement(w.Text,{onChange:u,maxLength:h||2e3})))),r!==O&&E.default.createElement(C.ConfigProvider,{value:{prefixCls:"kd"}},E.default.createElement("div",{className:k.default.fieldItem},E.default.createElement(w.ConditionFilterItem,{data:[H],customInput:[{type:"notInput",render:function(e){var t=e.value,a=e.className;return E.default.createElement("span",{className:a},t)}}],valueRequired:!0,className:"kd-item",conditionFilterItemType:2}))),d&&E.default.createElement(P,{value:r,className:k.default.fieldItem,options:N.MultiUpdateOptions,defaultValue:N.MultiUpdateOptions[0].value,onChange:o}))}));B.displayName="BatchEditContent";t.default=function(e){var t=e.visible,a=e.setVisible,n=e.appId,l=e.formId,r=e.activeSchemaId,u=e.searchKeywords,o=e.selectedQueryString,i=e.listFilterConfig,c=e.colHeadFilter,d=e.onConfirmEdit,f=e.orderBy,s=e.refBillProps,m=e.onColHeadFilterVisibleChange,y=e.listFilters,S=(0,E.useState)({}),T=(0,b.default)(S,2),A=T[0],P=T[1],V=(0,E.useState)(""),U=(0,b.default)(V,2),R=U[0],j=U[1],K=(0,E.useState)(""),z=(0,b.default)(K,2),q=z[0],H=z[1],W=(0,E.useState)(!1),Y=(0,b.default)(W,2),Q=Y[0],G=Y[1],X=(0,E.useState)([]),Z=(0,b.default)(X,2),J=Z[0],$=Z[1],ee=(0,E.useState)(""),te=(0,b.default)(ee,2),ae=te[0],ne=te[1],le=(0,E.useState)(!1),re=(0,b.default)(le,2),ue=re[0],oe=re[1],ie=function(){a(!1)};(0,E.useEffect)((function(){var e=[];null==i||i.forEach((function(t){var a;if(t.type&&!t.innerTable&&!(0,v.default)(N.NoBatchEditTypes).call(N.NoBatchEditTypes,t.type)&&!(0,v.default)(N.NoBatchEditStatus).call(N.NoBatchEditStatus,t.status))if("nocodedaterangefield"===t.type){if((0,h.default)(a=t.fieldName).call(a,"_startdate")){var n=t.fieldName.replace("_startdate",""),l=t.fieldCaption.replace(".开始","");e.push({label:l,value:n})}}else e.push({label:t.fieldCaption,value:t.fieldName})})),P({name:"field",title:"内容",value:"",options:e,fieldType:"select",borderType:"bordered",onChange:ve,className:"nocode-designer-modal-body-fielddata",placeholder:"请选择"})}),[i]);var ce,de=(0,g.default)(i).call(i,(function(e){var t;return""!==R&&(0,_.default)(t=e.fieldName).call(t,R)>-1})),fe=(0,E.useState)(!0===(null==de?void 0:de.isMulti)?D:L),se=(0,b.default)(fe,2),me=se[0],pe=se[1],ve=function(e){j(e),G(!0);var t,a=null==i?void 0:(0,g.default)(i).call(i,(function(t){var a;return(0,_.default)(a=t.fieldName).call(a,e)>-1})),n=a;"nocodedaterangefield"===a.type&&((0,h.default)(t=a.fieldName).call(t,"_startdate")&&(n=M(M({},a),{},{name:a.name.replace(".开始",""),fieldCaption:a.fieldCaption.replace(".开始",""),fieldName:a.fieldName.replace("_startdate",""),number:a.number.replace("_startdate","")})));m(n),he(n),H(a.type)},he=function(e){var t=!0===(null==e?void 0:e.isMulti)?D:L;pe(t)},ge=function(e,t){G(!1),$(e)},_e=(0,E.useCallback)((function(e){(0,F.unstable_batchedUpdates)((function(){ne(""),(0,v.default)(N.SensitiveTypes).call(N.SensitiveTypes,q)&&$([]),pe(e)}))}),[q]),ye=(0,E.useCallback)((function(e){ne(e)}),[]),be=(0,E.useMemo)((function(){return A.value=R,[A]}),[A,R]),Ee=(0,E.useCallback)((function(){var e=[{field:R,value:J,updateMode:me}];switch(q){case"nocodedaterangefield":var t=J;0===J.length&&(t=[{fieldValue:""},{fieldValue:""}]),e=[{field:R+"_startdate",value:[t[0]],updateMode:me},{field:R+"_enddate",value:[t[1]],updateMode:me}];break;case"nocodetextfield":case"nocodetextareafield":me===O&&(e[0].value=[{fieldValue:J.toString(),search:ae}])}var a={filter:o,fields:e,schemaId:r,orderBy:f,operation:"edit"};return y&&(a.queryFilter=y[0]),u&&(a.search=u),a}),[R,J,me,ae,q,o,r,f,y,u]),Ce=function(){""!==R?me!==O||ae?(oe(!0),(0,x.batchEditFormDataListItemWithFilter)(n,l,Ee()).then((function(e){oe(!1);var t=e.successCount;(0,I.showNotice)("success","".concat(t,"条记录批量编辑成功")),d(null),ie()})).catch((function(e){oe(!1),(0,N.showBatchErrNotice)(e,"批量编辑"),d(e),ie()}))):(0,I.showNotice)("warn","请填写要查找的内容"):(0,I.showNotice)("info","请先选择内容进行批量编辑")};return E.default.createElement(C.Modal,{visible:t,closable:!0,title:"批量编辑",body:E.default.createElement(E.default.Fragment,null,E.default.createElement(w.ConditionFilterItem,{data:be,customInput:[{type:"notInput",render:function(e){var t=e.value,a=e.className;return E.default.createElement("span",{className:a},t)}}],valueRequired:!0,className:"kd-item",conditionFilterItemType:2}),de&&E.default.createElement(B,{visible:t,controlMeta:de,refBillProps:s,colHeadFilter:c,isChange:Q,opType:me,onChange:ge,onUpdateChange:_e,onSearchChange:ye})),width:480,height:460,className:k.default.modal,onCancel:ie,footer:E.default.createElement("div",{className:k.default.modalFooter},E.default.createElement("div",{className:k.default.modalFooterRight},E.default.createElement(C.Button,{size:"small",className:k.default.modalFooterBtn,onClick:ie},"取消"),E.default.createElement(C.Button,{size:"small",loading:ue,disabled:ue,type:"primary",className:k.default.modalFooterBtn,"data-nc-action":(0,p.default)(ce="".concat(n,"|")).call(ce,l,"|au_be_comf"),onClick:Ce},"确定"))),showline:!1,maskClosable:!1,keyboard:!1})}},38512:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(90896)),c=o(a(29052)),d=o(a(94924)),f=o(a(78912)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=E(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),m=o(a(62336)),p=o(a(91292)),v=a(98464),h=o(a(51764)),g=a(57264),_=a(88268),y=a(32460),b=o(a(40436));function E(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(E=function(e){return e?a:t})(e)}var C={1:_.LOADING,2:_.SUCCESS,3:_.CANCELED,4:_.FAILURE},w={1:"取消",2:"完成",3:"关闭",4:"关闭"},k=(0,s.memo)((function(e){var t=e.title,a=void 0===t?"导出":t,n=e.visible,l=e.taskId,r=e.exportIdsLength,u=(e.formId,e.closeModal),o=e.isAtt,E=void 0!==o&&o,k=e.titleTips,x=(0,b.default)().state,I=(0,s.useState)({}),S=(0,f.default)(I,2),N=S[0],F=S[1],T=E?"附件":"记录",A=function(){var e=(0,d.default)(c.default.mark((function e(){var t,a,n,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.queryExportUrl)({taskId:l});case 2:a=e.sent,O(),n=null==a||null===(t=a.row)||void 0===t?void 0:t.urls,Array.isArray(n)&&(r=x.rootConfig.csrfToken,n.forEach((function(e,t){var a=(0,g.getTicketUrl)(r,e);(0,g.download)(a)})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,d.default)(c.default.mark((function e(t){var a,n,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.queryExportStatus)({taskId:l},E);case 2:if(!(a=e.sent).row){e.next=12;break}if(n=a.row,r=n.status,null!==n.progress&&F(a.row),C[r]!==_.LOADING){e.next=8;break}return e.abrupt("return");case 8:C[r]===_.SUCCESS&&A(),t(),e.next=13;break;case 12:t();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=(0,h.default)(M,1e3),D=(0,f.default)(P,2),L=D[0],O=D[1];(0,s.useEffect)((function(){l&&L()}),[]);var B=function(){u&&u()},V=function(){var e=(0,d.default)(c.default.mark((function e(){var t,a;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C[null==N?void 0:N.status]!==_.LOADING){e.next=7;break}return e.next=3,(0,v.cancelExport)({taskId:l},E);case 3:return a=e.sent,(null===(t=a.row)||void 0===t?void 0:t.canceled)?(O(),(0,g.showNotice)("success","已取消".concat(T,"导出")),B()):(0,g.showNotice)("error","取消".concat(T,"导出失败")),e.abrupt("return");case 7:B();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=(0,s.useCallback)((function(){return s.default.createElement("div",{style:{paddingTop:122}},s.default.createElement(p.default,{percent:(0,i.default)((null==N?void 0:N.progress)||0),status:C[null==N?void 0:N.status],textMap:["".concat(T,"导出中，请耐心等待"),"导出失败",E?"导出成功":"导出成功，共导出".concat(r||0,"条记录")]}))}),[N]);return s.default.createElement(m.default,{visible:n,title:a,titleTips:k,body:U(),onCancel:V,onClose:B,cancelText:w[null==N?void 0:N.status],renderFooter:function(){return s.default.createElement(y.ImportExportModalFooter,{cancelText:w[null==N?void 0:N.status]||"取消",onCancel:V})}})}));k.displayName="ExportModal";t.default=k},24668:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(29052)),c=o(a(94924)),d=o(a(78912)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),s=a(63548),m=a(82416),p=o(a(86360)),v=a(98464),h=o(a(38512)),g=a(16428),_=a(57264),y=a(82116);function b(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(b=function(e){return e?a:t})(e)}var E=function(e){var t=[];return e.forEach((function(e){e.canExport&&t.push({label:e.name,value:e.key})})),t},C=(0,f.memo)((function(e){var t=e.formId,a=e.activeSchemaId,n=e.searchKeyWord,l=e.selectedQueryString,r=e.filters,u=e.selectedCount,o=e.totalCount,b=e.onItemClick,C=(0,f.useState)(""),w=(0,d.default)(C,2),k=w[0],x=w[1],I=(0,f.useState)([]),S=(0,d.default)(I,2),N=S[0],F=S[1],T=(0,f.useState)(""),A=(0,d.default)(T,2),M=A[0],P=A[1],D=(0,f.useState)(!1),L=(0,d.default)(D,2),O=L[0],B=L[1],V=(0,f.useState)(!1),U=(0,d.default)(V,2),R=U[0],j=U[1],K=(0,f.useState)(y.EXPORT_SELECTED),z=(0,d.default)(K,2),q=z[0],H=z[1],W=(0,f.useCallback)((0,c.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,v.getExportFieldList)({formid:t,attr:!0},!0).then((function(e){var t=(null==e?void 0:e.rows)||[];(0,g.unstable_batchedUpdates)((function(){F(E(t)),B(!0)}))})).catch((function(e){}));case 1:case"end":return e.stop()}}),e)}))),[t]),Y=(0,f.useCallback)((0,c.default)(i.default.mark((function e(){var u,o,c,d;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=3;break}return(0,_.showNotice)("warning","请选择要导出的附件"),e.abrupt("return");case 3:return o={formid:t,selects:k,filters:q===y.EXPORT_ALL?r:l,search:n,schemaId:a},e.next=6,(0,v.sendExportData)(o,!0);case 6:c=e.sent,(d=null==c||null===(u=c.row)||void 0===u?void 0:u.taskId)&&(0,g.unstable_batchedUpdates)((function(){P(d),B(!1),j(!0)}));case 9:case"end":return e.stop()}}),e)}))),[t,k,l,n,a]),Q=(0,f.useCallback)((function(){B(!1)}),[]),G=(0,f.useCallback)((function(e){x(e)}),[]),X=(0,f.useCallback)((function(){(0,g.unstable_batchedUpdates)((function(){x(""),j(!1)}))}),[]),Z=(0,f.useCallback)((function(e){if(b)return b(e);H(e),W()}),[W]),J=(0,f.useMemo)((function(){return f.default.createElement(s.Dropdown.Menu,{onClick:Z},f.default.createElement(s.Dropdown.Item,{key:y.EXPORT_SELECTED,disabled:0===u},f.default.createElement("span",{style:y.dropdownTitleStyle},"导出选中（已选",u,"条）")),f.default.createElement(s.Dropdown.Item,{key:y.EXPORT_ALL,disabled:0===o},f.default.createElement("span",{style:y.dropdownTitleStyle},"导出全部（共",o||0,"条）")))}),[Z,u,o]);return f.default.createElement(f.default.Fragment,null,f.default.createElement(s.Dropdown,{trigger:"click",menu:J},f.default.createElement(m.BtnField,{type:"text",text:"导出附件",icon:{prefix:"nocodeplatformicon",type:"daochu"}})),O&&f.default.createElement(p.default,{height:208,okText:"导出",onOk:Y,onCancel:Q,title:"导出附件",body:f.default.createElement(m.FieldItem,{labelText:"内容",showTitle:!0,required:!0},f.default.createElement(m.Select,{value:k,options:N,onChange:G,style:{fontSize:14}}))}),R&&f.default.createElement(h.default,{title:"导出附件",visible:R,closeModal:X,taskId:M,isAtt:!0}))}));C.displayName="ExportAttachBtn";t.default=C},82116:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.dropdownTitleStyle=t.default=t.EXPORT_SELECTED=t.EXPORT_ALL=void 0;var i=o(a(29052)),c=o(a(94924)),d=o(a(78912)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=_(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),s=a(41936),m=a(63548),p=a(98464),v=o(a(38512)),h=a(82416),g=a(57264);function _(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(_=function(e){return e?a:t})(e)}var y=t.EXPORT_SELECTED="exportSelected",b=t.EXPORT_ALL="exportAll",E="导出表单记录",C=t.dropdownTitleStyle={fontSize:14};t.default=(0,f.memo)((function(e){var t,a=e.selectedRows,n=(e.tableDataSource,e.totalCount),l=e.searchKeyWord,r=e.createUiActionDataStr,u=e.onClick,o=e.activeSchemaId,_=e.selectedQueryString,w=e.selectedCount,k=e.filters,x=void 0===k?"":k,I=(0,s.useParams)().targetFormId,S=(0,f.useState)(!1),N=(0,d.default)(S,2),F=N[0],T=N[1],A=(0,f.useState)(""),M=(0,d.default)(A,2),P=M[0],D=M[1],L=(0,f.useState)(!1),O=(0,d.default)(L,2),B=O[0],V=O[1],U=(0,f.useState)([]),R=(0,d.default)(U,2),j=R[0],K=R[1],z=(0,f.useState)([]),q=(0,d.default)(z,2),H=q[0],W=q[1],Y=(0,f.useRef)([]),Q=null===(t=Y.current)||void 0===t?void 0:t.length,G=function(){var e=(0,c.default)(i.default.mark((function e(t){var n,l,r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=2;break}return e.abrupt("return",u(t));case 2:return Y.current=t===y?a:[],e.next=5,(0,p.getExportFieldList)({formid:I});case 5:n=e.sent,(l=null==n?void 0:n.rows)&&(r=[],o=[],l.forEach((function(e){var t=e.key,a=e.name,n=e.canExport,l=e.reason;r.push({key:t,title:a,disabled:!n,tips:l}),n&&o.push(t)})),K(r),W(o)),T(!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=(0,f.useCallback)((function(){T(!1)}),[]),Z=function(){var e=(0,c.default)(i.default.mark((function e(t){var a,n,r,u,c,d;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Array.isArray(t)&&t.length>0)){e.next=11;break}return n=t.join(","),r={formid:I,selects:n,filters:x,search:l,schemaId:o},Array.isArray(Y.current)&&Q>0&&(r.ids=Y.current,null!==(u=r.ids)&&void 0!==u&&u.length&&(r.filters=_)),e.next=6,(0,p.sendExportData)(r);case 6:null!=(c=e.sent)&&null!==(a=c.row)&&void 0!==a&&a.taskId&&(D(null==c||null===(d=c.row)||void 0===d?void 0:d.taskId),T(!1),V(!0)),e.next=12;break;case 11:(0,g.showNotice)("warning","请选择导出字段");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=f.default.createElement(m.Dropdown.Menu,{onClick:G},f.default.createElement(m.Dropdown.Item,{key:y,disabled:0===w,"data-nc-action":r("au_lo_op_os")},f.default.createElement("span",{style:C},"导出选中（已选",w,"条）")),f.default.createElement(m.Dropdown.Item,{key:b,disabled:0===n,"data-nc-action":r("au_lo_op_oa")},f.default.createElement("span",{style:C},"导出全部（共",n||0,"条）"))),$=(0,f.useCallback)((function(){V(!1)}),[]);return f.default.createElement(f.default.Fragment,null,f.default.createElement(m.Dropdown,{trigger:"click",menu:J},f.default.createElement(h.BtnField,{type:"text",text:"导出",icon:{prefix:"nocodeplatformicon",type:"daochu"}})),F&&f.default.createElement(h.ListItemSettingPop,{title:E,onClose:X,checkedKeys:H,onConfirm:Z,data:j,width:480,showLock:!1,okText:"导出"}),B&&f.default.createElement(v.default,{title:E,titleTips:"将所选记录导出至Excel文件中",visible:B,closeModal:$,taskId:P,exportIdsLength:Q>0?w:n}))}))},27076:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(26048)),c=o(a(78912)),d=o(a(35256)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=v(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),s=(a(63548),o(a(32460))),m=a(82416),p=["refresh","onClick"];function v(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(v=function(e){return e?a:t})(e)}t.default=function(e){var t=e.refresh,a=e.onClick,n=(0,d.default)(e,p),l=(0,f.useState)(!1),r=(0,c.default)(l,2),u=r[0],o=r[1],v=(0,f.useCallback)((function(){o(!1)}),[]);return f.default.createElement(f.default.Fragment,null,f.default.createElement(m.BtnField,(0,i.default)({type:"text",text:"导入",icon:{prefix:"nocodeplatformicon",type:"xiazai"}},n,{onClick:function(){if(a)return a();o(!0)}})),u&&f.default.createElement(s.default,{visible:u,closeModal:v,refresh:t}))}},75220:function(e,t,a){a(25028)(t,"__esModule",{value:!0}),t.LeftLayoutSkeleton=void 0;t.LeftLayoutSkeleton=[{width:"100%",height:"100%",child:[{width:"240px",height:"100%",type:"MENU",child:[{width:"216px",height:"28px",margin:"12px",type:"INPUT"},{width:"auto",height:"auto",margin:"12px 12px 8px 0px",child:[{width:"16px",height:"16px",type:"INPUT"},{width:"120px",height:"16px",type:"INPUT",margin:"0px 0px 0px 8px"}]},{width:"auto",height:"auto",margin:"20px 12px 8px 0px",child:[{width:"16px",height:"16px",type:"INPUT"},{width:"160px",height:"16px",type:"INPUT",margin:"0px 0px 0px 8px"}]},{width:"auto",height:"auto",margin:"20px 12px 8px 0px",child:[{width:"16px",height:"16px",type:"INPUT"},{width:"120px",height:"16px",type:"INPUT",margin:"0px 0px 0px 8px"}]},{width:"auto",height:"auto",margin:"20px 12px 8px 0px",child:[{width:"16px",height:"16px",type:"INPUT"},{width:"160px",height:"16px",type:"INPUT",margin:"0px 0px 0px 8px"}]},{width:"auto",height:"auto",margin:"20px 12px 8px 24px",child:[{width:"16px",height:"16px",type:"INPUT"},{width:"120px",height:"16px",type:"INPUT",margin:"0px 0px 0px 8px"}]},{width:"auto",height:"auto",margin:"20px 12px 8px 24px",child:[{width:"16px",height:"16px",type:"INPUT"},{width:"160px",height:"16px",type:"INPUT",margin:"0px 0px 0px 8px"}]}]},{width:"calc(100vw - 264px)",height:"100%",type:"CONCENT",margin:"12px",child:[{width:"100%",height:"36px",margin:"0px 0px 32px 0px",flexDirection:"row",alignItems:"center",child:[{width:"116px",height:"36px",type:"INPUT"},{width:"48px",height:"20px",type:"INPUT",repeat:4}]},{width:"216px",height:"28px",type:"INPUT",margin:"0px 0px 16px 12px"},{width:"98%",height:"100%",type:"INPUT",margin:"0px 0px 16px 12px"},{width:" 98%",height:"28px",margin:"0px 0px 0px 12px",justifyContent:"flex-end",child:[{width:"520px",height:"28px",type:"INPUT"}]}]}]}]},65300:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=t.DetailHeaderLayout=void 0;var i=o(a(760)),c=o(a(33260)),d=o(a(26048)),f=o(a(96631)),s=o(a(78912)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=D(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),p=a(41936),v=o(a(8748)),h=a(39392),g=o(a(1520)),_=a(63548),y=a(95936),b=a(25096),E=a(57264),C=o(a(12992)),w=o(a(32504)),k=a(82416),x=a(57056),I=o(a(48864)),S=o(a(71252)),N=o(a(70072)),F=a(6940),T=o(a(60584)),A=a(88268),M=a(80672),P=a(63516);function D(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(D=function(e){return e?a:t})(e)}var L=t.DetailHeaderLayout=(0,m.memo)((function(e){var t,a,n,l=(0,h.useTranslation)().t,r=(0,p.useParams)(),u=r.appId,o=r.targetFormId,D=r.shareId,L=r.Status,O=r.pkId,B=(0,m.useContext)(y.Context),V=B.state,U=B.dispatch,R=(0,m.useState)(!1),j=(0,s.default)(R,2),K=j[0],z=j[1],q=(0,m.useState)(L),H=(0,s.default)(q,2),W=H[0],Y=H[1],Q=(0,m.useState)(O),G=(0,s.default)(Q,2),X=G[0],Z=G[1],J=V.appsList[u],$=J||{},ee=$.istemplate,te=$.manage,ae=void 0!==te&&te,ne=$.image,le=$.name,re=V.userInfo,ue=((0,m.useContext)(x.AuthorizeContext)||{}).authList||{},oe=ue.editShareAuth,ie=ue.detailShareReqireLoginAuth,ce=ue.detailShareNotReqireLoginAuth,de=ue.inputShareReqireLoginAuth,fe=ue.inputShareNotReqireLoginAuth,se=ue.printAuth,me=(0,N.default)(o),pe=(0,m.useRef)();(0,m.useEffect)((function(){var e=function(e){Y(e)};return T.default.on(A.UPDATE_STATUS,e),function(){T.default.off(A.UPDATE_STATUS,e)}}),[]),(0,m.useEffect)((function(){var e=function(e){Z(e)};return T.default.on(A.UPDATE_PKID,e),function(){T.default.off(A.UPDATE_PKID,e)}}),[]),(0,m.useEffect)((function(){pe.current=me}),[me]);var ve=(0,m.useMemo)((function(){return"edit"===W}),[W]),he=(0,m.useMemo)((function(){return"view"===W}),[W]),ge=(0,m.useMemo)((function(){return ve?oe:he?ie||ce:de||fe}),[ve,he,oe,ie,ce,fe,de]);(0,m.useEffect)((function(){if(!J&&u){var e="nocode/v2/nocode_sys/app/".concat(u);(0,P.getWithPriority)((0,F.getStoreData)(e,""),(0,b.getAppInfoById)(u).then((function(t){return(0,F.setStoreData)(e,"",t||{}),t})),(function(e){var t;e&&U({type:M.UPDATE_APP_INFO_BY_ID,payload:{id:u,value:null===(t=e.rows)||void 0===t?void 0:t[0]}})}))}}),[J,u]),(0,m.useEffect)((function(){document.title=le||""}),[le]),(0,m.useEffect)((function(){return document.body.addEventListener("click",(function(){return z(!1)})),function(){return document.body.removeEventListener("click",(function(){return z(!1)}))}}),[]);var _e=function(){(0,E.showNotice)("error","预览时无法使用此功能")},ye=(0,m.useCallback)((function(){if(ee)return _e(),!0}),[ee]),be=ee?_e:void 0,Ee=(0,m.useMemo)((function(){return ee?{handleClickTheme:_e,handleClickLogout:_e}:{}}),[ee]),Ce=(0,c.default)(t=window.location.pathname).call(t,"detail")>-1,we=Ce&&("view"===L||!O),ke=(0,m.useMemo)((function(){return Ce?he?"详情":O?"编辑":"":"列表"}),[Ce,we]),xe=(0,E.getQueryString)("color",ne)||"";return m.default.createElement(m.default.Fragment,null,m.default.createElement(g.default,{className:v.default.app_header},m.default.createElement(g.default.Left,{className:v.default.left},!Ce&&m.default.createElement(I.default,{onItemClick:ye}),m.default.createElement("div",{className:(0,S.default)(v.default.app_logo,(0,f.default)({},v.default.ml12,!Ce))},m.default.createElement("img",{src:(0,E.getShareImage)(ne,D),style:{backgroundColor:xe},alt:""})),m.default.createElement("span",{className:v.default.app_name},le||"")),m.default.createElement(g.default.Right,{className:v.default.user},se&&he&&m.default.createElement(k.BtnField,{className:v.default.user_item,type:"text",onClick:function(){var e,t;(0,E.openner)((0,i.default)(e=(0,i.default)(t="/".concat(u,"/print/")).call(t,o,"/")).call(e,X,"/view"))},text:"打印",icon:{prefix:"nocodeplatformicon",type:"dayin"}}),!D&&re&&m.default.createElement(m.default.Fragment,null,ge&&m.default.createElement(C.default,{config:{appId:u,targetFormId:o,Status:L||"addNew"},size:"small",className:v.default.user_item,shareLink:[(0,E.getPathName)(),window.location.search].join(""),linkName:le,modalTitle:ke,iconType:"fenxiang",onClick:be,allowNoAuth:we,shareReqireLogin:ve?oe:he?ie:de,shareNotReqireLogin:ve?oe:he?ce:fe}),ae&&m.default.createElement(k.BtnField,{size:"small","data-nc-action":(0,i.default)(a="".concat(u,"|")).call(a,o,"|tb_set"),type:"text",className:v.default.user_item,text:l("apps.moreActions"),onClick:function(){var e;if(ee)return _e();o?(0,E.openner)((0,i.default)(e="/".concat(u,"/admin/")).call(e,o)):(0,E.openner)("/".concat(u,"/admin"))},icon:{prefix:"nocodeplatformicon",type:"shezhi5"}}),m.default.createElement(_.Tooltip,{placement:"bottomRight",trigger:"click",visible:K,arrow:!1,popperClassName:v.default.user_info_pop,tip:m.default.createElement(w.default,(0,d.default)({appId:u,formId:o,setVisible:z,data:re},Ee))},m.default.createElement("div",{className:v.default.avatar_wrapper,"data-nc-action":(0,i.default)(n="".concat(u,"|")).call(n,o,"|tb_head_bn"),onClick:function(){re&&z(!0)}},m.default.createElement(k.Avatar,{className:v.default.avatar,src:re.avatar})))))),m.default.createElement("div",{className:v.default.app_container},m.default.createElement(p.Outlet,null)))}));L.displayName="AppsHeaderLayout";t.default=L},76308:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(760)),c=o(a(1900)),d=o(a(35680)),f=o(a(50524)),s=o(a(96631)),m=o(a(78912)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=M(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),v=a(41936),h=o(a(48640)),g=a(63548),_=a(89208),y=(a(66200),a(82416)),b=o(a(71252)),E=a(59876),C=(o(a(84140)),o(a(33856)),o(a(40436))),w=a(80672),k=o(a(4496)),x=a(57264),I=o(a(68692)),S=o(a(732)),N=a(60644),F=a(75220),T=o(a(53704)),A=a(16428);function M(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(M=function(e){return e?a:t})(e)}t.default=function(e){var t,a=(0,v.useParams)(e),n=a.appId,l=a.targetFormId,r=(0,S.default)(),u=(0,p.useState)([]),o=(0,m.default)(u,2),M=o[0],P=o[1],D=p.default.useState([]),L=(0,m.default)(D,2),O=L[0],B=L[1],V=p.default.useState(""),U=(0,m.default)(V,2),R=U[0],j=U[1],K=(0,C.default)(),z=K.state,q=K.dispatch,H=(0,p.useState)(""),W=(0,m.default)(H,2),Y=W[0],Q=W[1],G=(0,p.useState)(""),X=(0,m.default)(G,2),Z=X[0],J=X[1],$=(0,p.useState)(!1),ee=(0,m.default)($,2),te=ee[0],ae=ee[1],ne=(0,p.useState)(!1),le=(0,m.default)(ne,2),re=le[0],ue=le[1],oe=(0,p.useState)(!1),ie=(0,m.default)(oe,2),ce=ie[0],de=ie[1],fe=null==z||null===(t=z.appsList)||void 0===t?void 0:t[n],se=(0,p.useRef)(!1),me=(fe||{}).istemplate;se.current=me;var pe=function(e){q({type:w.UPDATE_SELECTED_FORMDATA,payload:e})},ve=function(e,t,a){var l,r;(e.stopPropagation(),se.current)?(0,x.showNotice)("error","预览时无法使用此功能"):(0,x.isCustomPage)(a)?(0,x.openner)((0,i.default)(l="/".concat(n,"/admin/")).call(l,t)):(0,x.openner)((0,i.default)(r="/".concat(n,"/designer/")).call(r,t))},he=function(e){var t,a=e.name,l=e.formId,r=e.type;return p.default.createElement("div",{className:h.default.title},p.default.createElement("span",{className:h.default["title-name"],title:a},a),l&&p.default.createElement(g.Icon,{prefix:"nocodeplatformicon",type:"jichushezhi",className:(0,b.default)(h.default["go-designer"],"go-designer-icon"),onClick:function(e){return ve(e,l,r)},"data-nc-action":(0,i.default)(t="".concat(n,"|")).call(t,l,"|au_lfm_set"),title:(0,x.isCustomPage)(r)?"配置卡片看板":"配置表单"}))},ge=(0,p.useCallback)((function(e){var t,a,u=(0,N.cloneDeep)((null===(t=e[0])||void 0===t?void 0:t.row)||{}),o=(0,N.cloneDeep)(e[1]),c=(null==o?void 0:o.rows)||[],d=(0,_.transformTreeData)(c,he,(function(e){return ye(e,u)}));(0,A.unstable_batchedUpdates)((function(){ae(!c.length),ue(!0),P(d),de(!0)}));var f,s,m=(0,_.getTreeFirstFormNode)(c);l?m=(0,_.getNodeByFormId)(c,l):(null===(f=m)||void 0===f?void 0:f.formId)&&r((0,i.default)(s="/".concat(n,"/home/")).call(s,m.formId),{replace:!0});pe(m);var p=null===(a=m)||void 0===a?void 0:a.key;m&&J(p),m&&Q(p)}),[n,l,me]),_e=(0,p.useCallback)((function(){return(0,_.getMenuTreeData)(n,(function(e){e[0]&&e[1]&&ge(e)})).catch((function(e){(0,x.showNotice)("error",(null==e?void 0:e.message)||"请求失败"),ue(!1)}))}),[n,l,ge]);(0,p.useEffect)((function(){_e()}),[]);var ye=function(e,t){var a=e.formId,n=e.image,l=e.hasChild,r=(e.key,function(e,t,a){var n=function(e){return!e}(e);return n?a?"":"wenjianjiakai":"leaf"}(a,0,l)),u="leaf"===r?n||E.DEFAULT_FORM_IMAGE:r;return r&&p.default.createElement("div",{className:(0,b.default)((0,s.default)({},h.default["leaf-icon-wrapper"],"leaf"===r))},"leaf"===r?function(e,t){var a,n,l,r,u=(0,x.getQueryString)("color",t),o=(0,x.getQueryString)("svg",t),i=u&&"undefined"!==u?null==e||null===(a=e.colors)||void 0===a?void 0:(0,c.default)(a).call(a,(function(e){return e.value===u||e.key===u})):0,f=o&&"undefined"!==o?null==e||null===(n=e.svgs)||void 0===n?void 0:(0,c.default)(n).call(n,(function(e){return e.label===o})):0,s=null==e||null===(l=e.colors)||void 0===l||null===(l=l[i])||void 0===l?void 0:l.value,m=null==e||null===(r=e.svgs)||void 0===r||null===(r=r[f])||void 0===r?void 0:r.content;return p.default.createElement("div",{ref:function(e){var t;null==e||null===(t=e.getElementsByTagName("path"))||void 0===t||null===(t=t[0])||void 0===t||t.setAttribute("style","fill:".concat(s," "))},className:(0,b.default)(h.default.avatar),dangerouslySetInnerHTML:{__html:(null==m?void 0:(0,d.default)(m).call(m,/<title>.*?<\/title>/g,""))||""}})}(t,n||E.DEFAULT_FORM_IMAGE):p.default.createElement(g.Icon,{type:u,prefix:"nocodeplatformicon",className:(0,b.default)((0,s.default)({},h.default["empty-group"],"wenjianjiakai"===r||"wenjianguan"===r),h.default["switch-icon"])}))},be=(0,p.useCallback)((function(e){var t;return!(null===(t=e.name)||void 0===t||!(0,f.default)(t).call(t,R))}),[R]),Ee=(0,p.useCallback)((function(e,t){var a,l=t.node;l&&(Q(l.key),pe(l),r((0,i.default)(a="/".concat(n,"/home/")).call(a,l.formId)))}),[r]),Ce=(0,p.useCallback)((function(e){j(e)}),[]);return p.default.createElement(p.default.Fragment,null,!ce&&p.default.createElement(y.Skeleton,{options:F.LeftLayoutSkeleton}),p.default.createElement("div",{className:h.default.app_left},p.default.createElement("div",{className:h.default.search},p.default.createElement(I.default,{placeholder:"搜索",borderType:"bordered",prefix:p.default.createElement(g.Icon,{prefix:"nocodeplatformicon",type:"sousuo"}),size:"small",onChange:Ce,allowClear:!0})),te||!re?p.default.createElement(y.EmptyData,null):p.default.createElement(g.Tree,{name:"Tree",treeData:M,expandedKeys:O,defaultExpandRoot:!0,showIcon:!0,virtual:!1,checkStrictly:!1,checkable:!1,estimatedItemSize:44,onExpand:function(e,t){B(e)},filterTreeNode:be,filterValue:R,selectedKeys:[Y],onSelect:Ee,className:h.default.tree,setTreeNodeClassName:function(e){return e.formId?"":h.default["group-node-hover"]},scrollToKey:Z,switcherIcon:[p.default.createElement(g.Icon,{prefix:"nocodeplatformicon",type:"wenjianjiaguan",className:h.default["switch-icon"]}),p.default.createElement(g.Icon,{prefix:"nocodeplatformicon",type:"wenjianjiakai",className:h.default["switch-icon"]})]})),p.default.createElement("div",{className:h.default.app_main},p.default.createElement(T.default,{className:h.default.app_main_bg},!te&&l&&re?p.default.createElement(v.Outlet,{context:{selectedNode:null==z?void 0:z.selectedFormData}}):p.default.createElement(y.EmptyData,{src:k.default,desc:"暂无数据",imageWidth:224,imageHeight:128,textGap:16}))))}},64484:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=t.Tab=void 0;var m=s(a(23992)),p=s(a(96631)),v=s(a(78912)),h=k(a(65984)),g=s(a(26688)),_=a(82416),y=s(a(71252)),b=a(69400),E=k(a(72544)),C=a(63548);function w(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(w=function(e){return e?a:t})(e)}function k(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=w(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}function x(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}var I=[{value:"none",label:"不隐藏"},{value:"all",label:"全隐藏"},{value:"pc",label:"仅在PC端隐藏"},{value:"mobile",label:"仅在移动端隐藏"}],S=t.Tab=function(e){var t=e.onChange,a=e.value,n=e.options;return h.default.createElement("div",{className:g.default["tab-editor"]},(0,m.default)(n).call(n,(function(e){var n=e.iconClassName,l=e.iconTitle,r=e.value,u=e.label;return h.default.createElement("div",{key:r,className:(0,y.default)(g.default["tab-editor-item"],(0,p.default)({},g.default["is-active"],a===r)),onClick:function(){return t(r)},title:n&&l},u)})))};t.default=(0,h.memo)((function(e){var t=e.name,a=e.assignOrgs,n=e.assignUsers,l=e.onApi,r=e.hidden,u=e.schematype,f=void 0===u?E.SchemaTypes.List:u,s=e.ganttconfig,m=e.timemode,y=void 0===m?E.TimeModeTypes.Day:m,w=e.fieldList,k=(0,h.useState)(a||[]),N=(0,v.default)(k,2),F=N[0],T=N[1],A=(0,h.useState)(n||[]),M=(0,v.default)(A,2),P=M[0],D=M[1],L=(0,h.useState)(t||""),O=(0,v.default)(L,2),B=O[0],V=O[1],U=(0,h.useState)(!1),R=(0,v.default)(U,2),j=R[0],K=R[1],z=(0,h.useState)(r||""),q=(0,v.default)(z,2),H=q[0],W=q[1],Y=(0,h.useState)({schematype:f,ganttconfig:s,timemode:y}),Q=(0,v.default)(Y,2),G=Q[0],X=Q[1],Z=C.Form.useForm(),J=(0,v.default)(Z,1)[0];(0,h.useEffect)((function(){V(t)}),[t]),(0,h.useEffect)((function(){W(r)}),[r]),(0,h.useEffect)((function(){X({schematype:f,ganttconfig:s,timemode:y})}),[f,s,y]);var $=(0,h.useCallback)((function(e){V(e),ee(!e)}),[]),ee=(0,h.useCallback)((function(e){K(e)}),[]),te=(0,h.useCallback)((function(e){ee(!e.target.value)}),[ee]),ae=((0,h.useCallback)((function(e){null==T||T(e)}),[]),(0,h.useCallback)((function(e){D(e)}),[]),(0,h.useCallback)((function(e){W(e)}),[]));(0,h.useEffect)((function(){null==l||l({getBase:function(){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):i?c(e,i(a)):x(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}({name:B,hidden:H},G)},validateFields:function(){J.validateFields()}})}),[l,B,H,F,P,G,J]);return h.default.createElement("div",{className:g.default.base},h.default.createElement(C.Form,{form:J},h.default.createElement("div",{className:g.default.name_field},h.default.createElement("div",{className:g.default.name},h.default.createElement("span",null,"名称"),h.default.createElement("span",{className:g.default.dot},"*")),h.default.createElement(_.Text,{className:(0,p.default)({},g.default.input_error,j&&!(null!=B&&B.length)),value:B,onBlur:te,onChange:$,borderType:"bordered",maxLength:b.VIEW_MAX_LENGTH}),j&&h.default.createElement("div",{className:g.default.empty_tip},"请输入名称")),h.default.createElement("div",{className:g.default.hidden_field},h.default.createElement("div",{className:g.default.hidden_name},"从导航栏隐藏"),h.default.createElement("div",{className:g.default.hidden_wrapper},h.default.createElement(S,{onChange:ae,value:H||"none",options:I}))),h.default.createElement(E.default,{data:G,fieldList:w,onChange:function(e){X(e)}})))}))},26064:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),c=a(82416),d=o(a(71252)),f=o(a(50032));function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}var m=function(e){var t=e.selectAllEle;return i.default.createElement("div",{className:f.default.footer},t)};t.default=function(e){var t=e.data,a=e.checkedKeys,n=e.onConfirm,l=e.onApi,r=e.lockIndex,u=e.onSyncCurrentColumnData,o=(0,i.useRef)();return(0,i.useEffect)((function(){null==l||l({getColumn:function(){var e,t;return null===(e=o.current)||void 0===e||null===(t=e.getColumn)||void 0===t?void 0:t.call(e)}})}),[l,o.current]),i.default.createElement("div",{className:f.default.layout},i.default.createElement("div",{className:f.default.head},i.default.createElement("div",{className:f.default.title},"配置列表项"),i.default.createElement(c.BtnField,{type:"text",onClick:u,className:(0,d.default)(f.default.btn),text:"同步当前条件",icon:{prefix:"nocodeplatformicon",type:"qiehuan"}})),i.default.createElement(c.ListItemSetting,{ref:o,checkedKeys:a,onConfirm:n,data:t,lockIndex:r,bodyClassName:f.default.body,renderHeader:function(e,t){return i.default.createElement("div",{className:f.default.search},t)},renderFooter:function(e,t){return i.default.createElement(m,{selectAllEle:e})}}))}},36652:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(96631)),c=o(a(78912)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=v(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),f=a(82416),s=o(a(71252)),m=o(a(63176)),p=o(a(98764));function v(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(v=function(e){return e?a:t})(e)}var h=(0,d.forwardRef)((function(e,t){var a,n,l=e.data,r=e.configuredFilterItems,u=void 0===r?[]:r,o=e.onApi,v=e.onSyncCurrentFilterData,h=e.getEnumFilterValue,_=(0,d.useRef)(),y=(0,d.useState)({}),b=(0,c.default)(y,2),E=b[0],C=b[1];(0,d.useImperativeHandle)(t,(function(){var e;return{updateVerifyAndGetMsg:null===(e=_.current)||void 0===e?void 0:e.updateVerifyAndGetMsg}}),[null===(a=_.current)||void 0===a?void 0:a.updateVerifyAndGetMsg]);var w=(0,d.useCallback)((function(e){h(e).then((function(t){C((0,i.default)({},null==e?void 0:e.fieldName,t))}))}),[]),k=(0,d.useCallback)((function(e){var t,a;null===(t=_.current)||void 0===t||null===(a=t.onFilterAdd)||void 0===a||a.call(t,e)}),[]),x=(0,d.useCallback)((function(){var e,t;null===(e=_.current)||void 0===e||null===(t=e.onFilterClear)||void 0===t||t.call(e)}),[]);(0,d.useEffect)((function(){null==o||o({getFilter:function(){var e,t;return null===(e=_.current)||void 0===e||null===(t=e.getFilter)||void 0===t?void 0:t.call(e)}})}),[o,_.current]);var I=(0,m.default)(),S=(0,d.useMemo)((function(){var e,t;return((null==_||null===(e=_.current)||void 0===e||null===(t=e.getFilter)||void 0===t?void 0:t.call(e))||[]).length}),[null==_||null===(n=_.current)||void 0===n?void 0:n.getFilter]);return d.default.createElement("div",{className:p.default.layout},d.default.createElement("div",{className:p.default.head},d.default.createElement("div",{className:p.default.title},"配置筛选条件"),d.default.createElement(f.BtnField,{type:"text",onClick:v,className:(0,s.default)(p.default.btn),text:"同步当前条件",icon:{prefix:"nocodeplatformicon",type:"qiehuan"}})),d.default.createElement(f.ListFilterSetting,{ref:_,valueRequired:!0,data:l,configuredFilterItems:u,colHeadFilter:E,onColHeadFilterVisibleChange:w,showFooter:!1,showEmpty:!1,showVarSelect:!1,bodyClassName:p.default.body,filterEditorClassName:(0,s.default)(p.default.filtereditor,(0,i.default)({},p.default.editor_bottom,S)),refBillProps:I,renderFooter:function(e,t,a){return d.default.createElement(g,{className:(0,s.default)((0,i.default)({},p.default.with_filter_footer,S)),filters:l,onAdd:k,onClear:x,addFilterElement:e})}}))})),g=function(e){var t=e.onClear,a=e.addFilterElement,n=e.className,l=(0,d.useCallback)((function(){null==t||t()}),[t]);return d.default.createElement("div",{className:(0,s.default)(p.default.footer,n)},a,d.default.createElement(f.BtnField,{size:"small",type:"text",className:p.default.clear,onClick:l},"清空"))};t.default=h},72544:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.timeModeList=t.default=t.colorList=t.TimeModeTypes=t.SchemaTypes=void 0;var m=s(a(99148)),p=s(a(96631)),v=s(a(50524)),h=s(a(23992)),g=s(a(760)),_=s(a(28429)),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=x(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),b=a(64484),E=a(82416),C=a(57264),w=a(63548),k=s(a(26688));function x(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(x=function(e){return e?a:t})(e)}function I(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):i?c(e,i(a)):I(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var N=t.SchemaTypes=function(e){return e.List="0",e.Gantt="1",e}({}),F=[{value:N.List,label:"列表"},{value:N.Gantt,label:"甘特图"}],T=t.TimeModeTypes=function(e){return e.Day="0",e.Week="1",e.Month="2",e.QuarterYear="3",e.Year="4",e}({}),A=t.timeModeList=[{value:T.Day,label:"日"},{value:T.Week,label:"周"},{value:T.Month,label:"月"},{value:T.QuarterYear,label:"季"},{value:T.Year,label:"年"}],M=(t.colorList=["#B3D5FF","#A1ECFF","#A1F5E8","#A1E6B5","#DDFF8F","#FFEF8A","#FFE0A6","#FFCAA8","#FFADB6","#FE95AC","#D4A8FF","#99CCFF","#D9D9D9","#276FF5","#16B0F1","#16B8B1","#1BA854","#77C404","#FDC200","#FF991C","#FF5F1F","#FB2323","#F90D58","#701DF0","#0E5FD8","#999999"],function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===e.length)throw new Error("颜色不能为空");for(var a="";!a||(0,v.default)(t).call(t,a);)a=e[Math.floor(Math.random()*e.length)];return a}),P=function e(t,a){if(!t)return[];var n=[];return t.forEach((function(t){if(a(t)){var l,r=S(S({},t),{},{key:t.number,title:t.name});null!==(l=t.children)&&void 0!==l&&l.length&&(r.children=e(t.children,a)),n.push(r)}})),n},D=function(e){var t;return!!e&&(0,v.default)(t=["nocodedaterangefield","nocodedatefield","nocodecreatedatefield","nocodemodifydatefield"]).call(t,e.type)},L=function(e){if(e)return"value"===e.type?new Date(e.value):void 0},O=(0,y.memo)((function(e){var t,a=e.data,n=void 0===a?{}:a,l=e.fieldList,r=e.onChange,u=n.schematype,o=n.ganttconfig,i=void 0===o?[]:o,c=n.timemode,d=P(l,D),f=function(e,t){null==r||r(S(S({},n),{},(0,p.default)({},e,t)))},s=function(e){f("ganttconfig",e)},v=function(e,t,a){var n=null==i?void 0:(0,h.default)(i).call(i,(function(n){return n.taskId===t.taskId?S(S({},n),{},(0,p.default)({},e,a?{value:a,type:"value"}:void 0)):n}));s(n)},x=function(e,t,a){var n=null==i?void 0:(0,h.default)(i).call(i,(function(n){return n.taskId===t.taskId?S(S({},n),{},(0,p.default)({},e,{value:null==a?void 0:a[0],type:"field"})):n}));s(n)},I=(0,y.useCallback)((function(e,t){var a,n,l,r=null===(a=t[e])||void 0===a?void 0:a.value,u=r?Array.isArray(r)?r:[r]:[];return{type:"treeSelect",data:d,showSearch:!0,selectedKeys:u,varSelectActive:"field"===(null===(n=t[e])||void 0===n?void 0:n.type),isVar:"field"===(null===(l=t[e])||void 0===l?void 0:l.type),onSelect:function(){for(var a,n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return x.apply(void 0,(0,g.default)(a=[e,t]).call(a,l))},onClear:function(){return function(e,t){var a=null==i?void 0:(0,h.default)(i).call(i,(function(a){return a.taskId===t.taskId?S(S({},a),{},(0,p.default)({},e,void 0)):a}));s(a)}(e,t)}}}),[d]);return y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:k.default.hidden_field},y.default.createElement("div",{className:k.default.hidden_name},"视图类型"),y.default.createElement("div",{className:k.default.hidden_wrapper},y.default.createElement(b.Tab,{onChange:function(e){f("schematype",e)},value:u||N.List,options:F}))),u===N.Gantt&&y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:k.default.hidden_field},y.default.createElement("div",{className:k.default.hidden_name},"开始时间-结束时间"),y.default.createElement(E.EditOptionList,{bgcolorChecked:!0,itemClassName:k.default.edit_item,isNewOptionEdit:!(null!==(t=i[(null==i?void 0:i.length)-1||0])&&void 0!==t&&t.name),keyMap:{id:"taskId",color:"taskColor"},options:i,limitCount:5,onAdd:function(){var e;if(!(i.length>=5)){var t,a,l=(a=null==n||null===(t=n.ganttconfig)||void 0===t?void 0:(0,h.default)(t).call(t,(function(e){return e.taskColor})),{taskId:(0,C.createUUid)(),taskColor:M(E.EditOptionList.darkColorList,a)}),r=(0,g.default)(e=[]).call(e,(0,m.default)(i),[l]);s(r)}},onChange:s,renderOption:function(e,t,a){var n,l;null===(n=t.start)||void 0===n||n.value,null===(l=t.end)||void 0===l||l.value;return y.default.createElement("div",{className:k.default.setting_option},y.default.createElement("div",{className:k.default.setting_option_name},a),y.default.createElement(w.Form.Item,{label:t.name,name:t.taskId,className:k.default.setting_option_timeitem_wrapper,rules:[function(e){e.getFieldValue;return{validator:function(e,a){return t.start||t.end?_.default.resolve():_.default.reject(new Error("开始和结束时间不能同时为空"))}}}]},y.default.createElement("div",{className:k.default.setting_option_timeitem},y.default.createElement("div",{className:k.default.setting_option_item},y.default.createElement(E.InputCombo,{placeholder:"开始时间",fieldType:"datetime",value:L(t.start),onChange:function(e){return v("start",t,e)},varSelectProps:I("start",t)})),y.default.createElement("div",{className:k.default.setting_option_item},y.default.createElement(E.InputCombo,{placeholder:"结束时间",fieldType:"datetime",value:L(t.end),onChange:function(e){return v("end",t,e)},varSelectProps:I("end",t)})))))}})),y.default.createElement("div",{className:k.default.hidden_field},y.default.createElement("div",{className:k.default.hidden_name},"时间尺度"),y.default.createElement("div",{className:k.default.hidden_wrapper},y.default.createElement(b.Tab,{onChange:function(e){f("timemode",e)},value:c||T.Day,options:A})))))}));O.displayName="GanttSettingLayout";t.default=O},47968:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(23992)),c=o(a(78912)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=m(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),f=a(63548),s=o(a(27804));function m(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(m=function(e){return e?a:t})(e)}var p=d.default.memo((function(e){var t=e.selectedKey,a=e.menu,n=e.width,l=e.onSelect,r=f.Layout.Sider,u=(0,d.useState)(t),o=(0,c.default)(u,2),m=o[0],p=o[1],v=(0,d.useCallback)((function(e){var t=e.key;e.item,e.keyPath;p(t),null==l||l(t)}),[l]);return(0,d.useEffect)((function(){p(t)}),[t]),d.default.createElement(d.default.Fragment,null,d.default.createElement(r,{width:n,className:s.default.side_bar},d.default.createElement(f.Menu,{mode:"inline",theme:"light",onClick:v,defaultSelectedKey:"1",selectedKey:m,defaultOpenKeys:["sub1"],style:{width:"100%",height:"100%",borderRight:0}},null==a?void 0:(0,i.default)(a).call(a,(function(e){var t=e.key,a=e.icon,n=e.title;return d.default.createElement(f.Menu.Item,{key:t,icon:d.default.createElement(f.Icon,{prefix:"nocodeplatformicon",type:a})},n)})))))}));p.displayName="SiderMenu";t.default=p},91492:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),c=a(82416),d=o(a(71252)),f=o(a(78064));function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}var m=function(e){var t=e.onClear,a=e.addFilterElement,n=(0,i.useCallback)((function(){null==t||t()}),[t]);return i.default.createElement("div",{className:f.default.footer},a,i.default.createElement(c.BtnField,{size:"small",type:"text",className:f.default.clear,onClick:n},"清空"))};t.default=function(e){var t=e.data,a=e.configuredSortItems,n=e.onApi,l=e.onSyncCurrentSortData,r=(0,i.useRef)(),u=(0,i.useCallback)((function(e){var t,a;null===(t=r.current)||void 0===t||null===(a=t.onSortAdd)||void 0===a||a.call(t,e)}),[]),o=(0,i.useCallback)((function(){var e,t;null===(e=r.current)||void 0===e||null===(t=e.onSortClear)||void 0===t||t.call(e)}),[]);return(0,i.useEffect)((function(){null==n||n({getSort:function(){var e,t;return null===(e=r.current)||void 0===e||null===(t=e.getSort)||void 0===t?void 0:t.call(e)}})}),[n,r.current]),i.default.createElement("div",{className:f.default.layout},i.default.createElement("div",{className:f.default.head},i.default.createElement("div",{className:f.default.title},"配置排序条件"),i.default.createElement(c.BtnField,{type:"text",onClick:l,className:(0,d.default)(f.default.btn),text:"同步当前条件",icon:{prefix:"nocodeplatformicon",type:"qiehuan"}})),i.default.createElement(c.ListSort,{ref:r,data:t||[],configuredSortItems:a,showFooter:!1,showEmpty:!1,bodyClassName:f.default.body,addText:"添加排序规则",renderFooter:function(e,a,n){return i.default.createElement(m,{filters:t,onAdd:u,onClear:o,addFilterElement:e})}}))}},45444:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(23992)),c=o(a(50524)),d=o(a(70696)),f=o(a(78912)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),m=o(a(21348)),p=a(82416),v=o(a(59480));function h(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(h=function(e){return e?a:t})(e)}t.default=function(e){var t=e.statCards,a=e.onApi,n=(0,s.useState)([]),l=(0,f.default)(n,2),r=l[0],u=l[1],o=(0,s.useMemo)((function(){return(0,i.default)(r).call(r,(function(e){e.index,e.display;var t=e.id;e.cardId;return{label:e.title,value:t}}))}),[r]);(0,s.useEffect)((function(){u(t)}),[t]),(0,s.useEffect)((function(){null==a||a({getStatistic:function(){return r}})}),[a,r]);var h=(0,s.useCallback)((function(e){u((0,v.default)((function(t){t.forEach((function(t){t.display=Array.isArray(e)?(0,c.default)(e).call(e,t.id):t.id===e}))})))}),[]),g=(0,s.useMemo)((function(){var e;return null===(e=(0,d.default)(r).call(r,(function(e){return e.display})))||void 0===e?void 0:(0,i.default)(e).call(e,(function(e){return e.id}))}),[r]);return s.default.createElement("div",{className:m.default.layout},s.default.createElement("div",{className:m.default.title},"配置统计卡片"),s.default.createElement(p.Checkbox,{value:g,options:o,onChange:h}))}},41316:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(26048)),p=s(a(96631)),v=s(a(78912)),h=s(a(70696)),g=s(a(24244)),_=s(a(38456)),y=s(a(50524)),b=a(63548),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=M(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),C=s(a(3012)),w=s(a(47968)),k=a(82416),x=s(a(64484)),I=s(a(36652)),S=s(a(26064)),N=s(a(91492)),F=s(a(45444)),T=a(57264),A=a(4804);function M(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(M=function(e){return e?a:t})(e)}function P(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):i?c(e,i(a)):P(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var L=function(e){return e.base="base",e.filter="filter",e.sort="sort",e.column="column",e.statistic="statistic",e}(L||{}),O=[{key:L.base,title:"基础",icon:"jichushezhi"},{key:(0,h.default)(L),title:"筛选",icon:"shaixuan"},{key:(0,g.default)(L),title:"排序",icon:"paixu3"},{key:L.column,title:"列设置",icon:"lieshezhi"},{key:L.statistic,title:"统计",icon:"xinjianbaobiao"}];t.default=function(e){var t=e.visible,a=e.onClose,n=e.base,l=(0,h.default)(e),r=(0,g.default)(e),u=e.column,o=e.statistic,i=e.createUiActionDataStr,c=e.onConfirm,d=(0,E.useState)(O[0].key),f=(0,v.default)(d,2),s=f[0],M=f[1],P=(0,E.useRef)(),B=(0,E.useRef)(),V=(0,E.useState)({}),U=(0,v.default)(V,2),R=U[0],j=U[1],K=(0,E.useState)({}),z=(0,v.default)(K,2),q=z[0],H=z[1],W=(0,E.useState)({}),Y=(0,v.default)(W,2),Q=Y[0],G=Y[1],X=(0,E.useState)({}),Z=(0,v.default)(X,2),J=Z[0],$=Z[1],ee=(0,E.useState)([]),te=(0,v.default)(ee,2),ae=te[0],ne=te[1],le=(0,E.useState)(!1),re=(0,v.default)(le,2),ue=re[0],oe=re[1],ie=(0,E.useRef)(!1);(0,E.useEffect)((function(){t&&M(O[0].key)}),[t]),(0,E.useEffect)((function(){j(n)}),[n]),(0,E.useEffect)((function(){H(l.configuredFilterItems)}),[l.configuredFilterItems]),(0,E.useEffect)((function(){G(r.configuredSortItems)}),[r.configuredSortItems]),(0,E.useEffect)((function(){var e=u.lockIndex,t=u.checkedKeys,a=u.data;$({lockIndex:e,checkedKeys:t,data:a})}),[u.lockIndex,u.checkedKeys,u.data]),(0,E.useEffect)((function(){ne(o.data)}),[o]);var ce=(0,E.useCallback)((function(e){P.current=D(D({},P.current),e)}),[P.current]),de=(0,E.useMemo)((function(){return(0,p.default)((0,p.default)((0,p.default)((0,p.default)((0,p.default)({},L.base,x.default),(0,h.default)(L),I.default),(0,g.default)(L),N.default),L.column,S.default),L.statistic,F.default)}),[]),fe=(0,E.useMemo)((function(){return(0,p.default)((0,p.default)((0,p.default)((0,p.default)((0,p.default)({},L.base,D(D({},R),{},{fieldList:l.data,onApi:ce})),(0,h.default)(L),D(D({},l),{},{configuredFilterItems:q,onApi:ce})),(0,g.default)(L),D(D({},r),{},{configuredSortItems:Q,onApi:ce})),L.column,D(D(D({},u),J),{},{onApi:ce})),L.statistic,{statCards:ae,onApi:ce})}),[R,l,q,r,Q,J,ae,ce]),se=(0,E.useCallback)((function(e){var t,a,n,l,r,u,o,i,c,d;switch(e){case L.base:var f=null===(t=(a=P.current).getBase)||void 0===t?void 0:t.call(a);j(f);break;case(0,h.default)(L):var s=null===(n=(l=P.current).getFilter)||void 0===n?void 0:n.call(l);H(s);break;case(0,g.default)(L):var m=null===(r=(u=P.current).getSort)||void 0===r?void 0:r.call(u);G(m);break;case L.column:var p=(null===(o=(i=P.current).getColumn)||void 0===o?void 0:o.call(i))||{},v=p.lockIndex,_=p.checkedKeys,y=p.listData;$({lockIndex:v,checkedKeys:_,data:y});break;case L.statistic:var b=null===(c=(d=P.current).getStatistic)||void 0===c?void 0:c.call(d);ne(b)}}),[s]),me=(0,E.useCallback)((function(e){M(e),se(s)}),[s,se]),pe=(0,E.useMemo)((function(){return de[s]}),[de,s]),ve=(0,E.useMemo)((function(){return fe[s]}),[fe,s]),he=((0,E.useCallback)((function(e){var t,a,n,l,r,u,o,i,c,d,f={};switch(e){case L.base:var s=null===(t=(a=P.current).getBase)||void 0===t?void 0:t.call(a);f={name:s.name,hidden:s.hidden};break;case(0,h.default)(L):f={configuredFilterItems:null===(n=(l=P.current).getFilter)||void 0===n?void 0:n.call(l)};break;case(0,g.default)(L):f={configuredSortItems:null===(r=(u=P.current).getSort)||void 0===r?void 0:r.call(u)};break;case L.column:var m=null===(o=(i=P.current).getColumn)||void 0===o?void 0:o.call(i);f={lockIndex:m.lockIndex,checkedKeys:m.checkedKeys,listData:m.data};break;case L.statistic:f={statCards:null===(c=(d=P.current).getStatistic)||void 0===c?void 0:c.call(d)}}return D({name:R.name,hidden:R.hidden,configuredFilterItems:q,configuredSortItems:Q,statCards:ae,lockIndex:J.lockIndex,checkedKeys:J.checkedKeys,listData:J.data},f)}),[R,q,Q,J,ae]),(0,E.useCallback)((function(){var e,t,a,n,l,r,u,o,i,c,d=null===(e=(t=P.current).getBase)||void 0===e?void 0:e.call(t),f=null===(a=(n=P.current).getFilter)||void 0===a?void 0:a.call(n),s=null===(l=(r=P.current).getSort)||void 0===l?void 0:l.call(r),m=null===(u=(o=P.current).getColumn)||void 0===u?void 0:u.call(o),p=null===(i=(c=P.current).getStatistic)||void 0===i?void 0:i.call(c),v=null==m?void 0:m.lockIndex;return{name:(null==d?void 0:d.name)||R.name,hidden:(null==d?void 0:d.hidden)||R.hidden,schematype:(null==d?void 0:d.schematype)||R.schematype||"0",ganttconfig:(null==d?void 0:d.ganttconfig)||R.ganttconfig||[],timemode:(null==d?void 0:d.timemode)||R.timemode||"0",configuredFilterItems:f||q,configuredSortItems:s||Q,statCards:p||ae,lockIndex:0===v?v:v||J.lockIndex,checkedKeys:(null==m?void 0:m.checkedKeys)||J.checkedKeys,listData:(null==m?void 0:m.listData)||J.data}}),[R,q,Q,J,ae])),ge=(0,E.useCallback)((function(){var e,t,a,n,l=he(),r=null===(e=P.current)||void 0===e||null===(t=e.getBase)||void 0===t?void 0:t.call(e);if(r){if(!r.name)return void(0,T.showNotice)("warnning","请输入视图名称");if("1"===r.schematype){var u,o,i;if(!r.ganttconfig||null===(u=r.ganttconfig)||void 0===u||!u.length)return void(0,T.showNotice)("warnning","请配置甘特图开始时间-结束时间");if(null===(o=P.current)||void 0===o||o.validateFields(),null===(i=r.ganttconfig)||void 0===i?void 0:(0,_.default)(i).call(i,(function(e){return!e.start&&!e.end})))return}}var d=null==B||null===(a=B.current)||void 0===a||null===(n=a.updateVerifyAndGetMsg)||void 0===n?void 0:n.call(a);if(s===(0,h.default)(L)){if(null!=d&&d.length)return void(0,T.showNotice)("warnning","筛选值不能为空")}else{var f=!1;if(l.configuredFilterItems.forEach((function(e){var t=e.compareType,a=e.value;(0,y.default)(A.VALUE_EMPTY_COMPARE_TYPE).call(A.VALUE_EMPTY_COMPARE_TYPE,t)||a.length||((0,T.showNotice)("warnning","筛选值不能为空"),f=!0)})),f)return}null==c||c(l)}),[s,c,he]),_e=(0,E.useCallback)((function(){ie.current?oe(!0):null==a||a()}),[a]),ye=(0,E.useCallback)((function(e){switch(e){case"ok":oe(!1),ge();break;case"cancel":oe(!1),null==a||a()}}),[ge,a]);return E.default.createElement(b.Drawer,{placement:"right",visible:t,onClose:_e,title:"视图配置",width:800,className:C.default.view_config,maskStyle:{opacity:0}},E.default.createElement("div",{className:C.default.config_body,onFocusCapture:function(){ie.current=!0}},E.default.createElement(w.default,{width:160,menu:O,selectedKey:O[0].key,onSelect:me}),E.default.createElement(pe,(0,m.default)({ref:B},ve))),E.default.createElement("div",{className:C.default.footer},E.default.createElement(k.BtnField,{text:"取消",size:"small",onClick:_e}),E.default.createElement(k.BtnField,{type:"primary",text:"确定",size:"small","data-nc-action":i("au_lo_cview_vs_comf"),onClick:ge})),ue&&E.default.createElement(k.ConfirmModal,{type:"warning",visible:ue,title:"存在未保存内容，是否保存？",actions:[{key:"cancel",text:"取消"},{key:"ok",text:"保存"}],onAction:ye}))}},26260:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(73980),s=a(13440),m=a(59992),p=a(60600),v=a(93252),h=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var g=h(a(29052)),_=h(a(99148)),y=h(a(94924)),b=h(a(96631)),E=h(a(78912)),C=h(a(70696)),w=h(a(38456)),k=h(a(760)),x=h(a(28429)),I=h(a(67584)),S=h(a(23992)),N=h(a(50524)),F=h(a(1900)),T=h(a(35680)),A=h(a(52892)),M=h(a(24496)),P=h(a(73020)),D=h(a(72400)),L=be(a(65984)),O=be(a(16428)),B=a(41936),V=a(39392),U=h(a(28424)),R=a(63548),j=h(a(54348)),K=h(a(27076)),z=h(a(46412)),q=h(a(82116)),H=h(a(21980)),W=a(71120),Y=a(57264),Q=a(12700),G=a(69400),X=h(a(71252)),Z=h(a(40436)),J=h(a(64668)),$=h(a(4496)),ee=a(82416),te=h(a(68692)),ae=be(a(55867)),ne=ae,le=a(57056),re=h(a(41316)),ue=h(a(16476)),oe=a(98464),ie=a(85040),ce=be(a(67112)),de=h(a(59480)),fe=a(25096),se=a(78016),me=h(a(75020)),pe=h(a(78932)),ve=h(a(36060)),he=h(a(63176)),ge=a(29084),_e=h(a(24668));function ye(e){if("function"!=typeof v)return null;var t=new v,a=new v;return(ye=function(e){return e?a:t})(e)}function be(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=ye(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}function Ee(e,t){var a=void 0!==m&&p(e)||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){var a;if(!e)return;if("string"==typeof e)return Ce(e,t);var n=f(a=Object.prototype.toString.call(e)).call(a,8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return s(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,u=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return u=e.done,e},e:function(e){o=!0,r=e},f:function(){try{u||null==a.return||a.return()}finally{if(o)throw r}}}}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function we(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?we(Object(a),!0).forEach((function(t){(0,b.default)(e,t,a[t])})):i?c(e,i(a)):we(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var xe=(0,L.lazy)((function(){return Promise.all([a.e(428),a.e(808)]).then(a.t.bind(a,19108,23))})),Ie="delete",Se=function(e){return(null==e?void 0:(0,C.default)(e).call(e,(function(e){return!e.billStatus})))||[]},Ne=(0,L.memo)((function(e){var t,a=(0,L.useState)(!1),n=(0,E.default)(a,2),l=n[0],r=n[1],u=((0,V.useTranslation)().t,(0,B.useParams)()),o=u.appId,i=u.targetFormId,c=(0,Z.default)().state,d=c.userInfo,f=c.appsList,s=void 0===f?{}:f,m=c.compareTypes,p=void 0===m?{}:m,v=(d||{}).id,h=(s[o]||{}).istemplate,D=(0,L.useState)(!1),pe=(0,E.default)(D,2),ye=pe[0],be=pe[1],Ce=(0,L.useState)(!1),we=(0,E.default)(Ce,2),Ne=we[0],Fe=we[1],Te=(0,L.useState)({formId:i,pkId:""}),Ae=(0,E.default)(Te,2),Me=Ae[0],Pe=Ae[1],De=(0,L.useState)("edit"),Le=(0,E.default)(De,2),Oe=Le[0],Be=Le[1],Ve=(0,L.useState)(!1),Ue=(0,E.default)(Ve,2),Re=Ue[0],je=Ue[1],Ke=(0,L.useState)(0),ze=(0,E.default)(Ke,2),qe=ze[0],He=ze[1],We=(0,L.useContext)(le.AuthorizeContext)||{},Ye=We.authList,Qe=We.pending,Ge=We.setPending,Xe=We.formId,Ze=!Qe&&Xe===i,Je=(0,L.useState)([]),$e=(0,E.default)(Je,2),et=$e[0],tt=$e[1],at=(0,L.useState)(!1),nt=(0,E.default)(at,2),lt=nt[0],rt=nt[1],ut=(0,L.useState)(""),ot=(0,E.default)(ut,2),it=ot[0],ct=ot[1],dt=(0,L.useState)({}),ft=(0,E.default)(dt,2),st=ft[0],mt=ft[1],pt=(0,L.useState)(!1),vt=(0,E.default)(pt,2),ht=(vt[0],vt[1],(0,L.useState)({})),gt=(0,E.default)(ht,2),_t=gt[0],yt=gt[1],bt=(0,L.useState)(!1),Et=(0,E.default)(bt,2),Ct=Et[0],wt=Et[1],kt=(0,L.useState)(!1),xt=(0,E.default)(kt,2),It=xt[0],St=xt[1],Nt=e.vasWidth,Ft=e.btnWidth,Tt=Ye||{},At=Tt.viewAuth,Mt=Tt.editAuth,Pt=Tt.deleteAuth,Dt=Tt.importAuth,Lt=Tt.exportAuth,Ot=Tt.inputAuth,Bt=(Tt.printAuth,Tt.statisticAuth),Vt=Tt.detailShareReqireLoginAuth,Ut=Tt.detailShareNotReqireLoginAuth,Rt=Tt.editShareAuth,jt=Tt.inputShareReqireLoginAuth,Kt=Tt.inputShareNotReqireLoginAuth,zt=(0,L.useMemo)((function(){return(0,w.default)(et).call(et,(function(e){return e.active}))}),[et]),qt=(0,L.useMemo)((function(){return null==zt?void 0:zt.id}),[zt]),Ht=(0,L.useCallback)((function(e){var t,a;return(0,k.default)(t=(0,k.default)(a="".concat(o,"|")).call(a,i,"|")).call(t,e)}),[o,i]),Wt=function(e){(0,se.publishClickUserEvent)({appId:o,formId:i,action:e})},Yt=(0,L.useCallback)((function(e,t,a){document.body.style.overflow="hidden","view"===a?Wt("au_fo_detail"):"edit"===a&&Wt("au_fo_edit"),(0,O.unstable_batchedUpdates)((function(){Be(a),Pe({formId:e,pkId:t}),be(!0)}))}),[Wt,Pe,Be]),Qt=(0,L.useCallback)((function(){document.body.style.overflow="hidden",be(!0),Pe({formId:i,pkId:""}),Be("addNew")}),[i]),Gt=(0,L.useMemo)((function(){return{loadMore:!1,loadData:!1,updateFooter:!0,isMob:!1,operateCol:{needOperateCol:!0,width:200,disabled:!1}}}),[]),Xt=(0,H.default)({appId:o,formId:i,env:W.ENV_APP,viewAuth:At,pending:Qe,setPending:Ge},Gt,ke(ke({},ne),ce)),Zt=(0,E.default)(Xt,3),Jt=Zt[0],$t=Zt[1],ea=Zt[2],ta=Jt.formName,aa=Jt.dataSource,na=Jt.footerDataSource,la=Jt.pageNo,ra=Jt.pageSize,ua=Jt.totalCount,oa=Jt.visibleColumnKeys,ia=Jt.columns,ca=Jt.showListSettingPop,da=Jt.showFilterSettingPop,fa=Jt.showSortSettingPop,sa=Jt.listFilterConfig,ma=Jt.listItemConfig,pa=Jt.listTreeConfig,va=Jt.configuredFilterItems,ha=Jt.schemaConfiguredFilterItems,ga=Jt.listFilters,_a=Jt.searchKeywords,ya=Jt.colHeadFilters,ba=Jt.loading,Ea=Jt.orderInfo,Ca=Jt.colHeadFilter,wa=Jt.enumFilterValue,ka=Jt.stateInfo,xa=Jt.orderBy,Ia=Jt.bizButtons,Sa=Jt.selectedIds,Na=Jt.selectedCount,Fa=($t.onAfterAddRows,$t.onPaginationChange),Ta=$t.onListSettingConfirm,Aa=$t.onFilterItemDelete,Ma=$t.onFilterConfirm,Pa=$t.onAfterSave,Da=$t.onRefreshWithSetting,La=$t.onSearch,Oa=($t.onChangeFilters,$t.onSetShowFilterSettingPop),Ba=$t.onSetShowListSettingPop,Va=$t.onSetShowSortSettingPop,Ua=$t.onAggCellChange,Ra=$t.getEnumFilterValue,ja=$t.onGetEnumFilterValue,Ka=$t.onAggVisibleChange,za=$t.onColFilterConfirm,qa=$t.onColHeadFilterVisibleChange,Ha=$t.onRowDelete,Wa=$t.onColSort,Ya=$t.onLoadInitData,Qa=$t.setFormDataListState,Ga=$t.onAfterDeleteRows,Xa=$t.onSelectChange,Za=$t.onBatchDelete,Ja=$t.getSelectedQueryString,$a=$t.keepErrSelect;(0,L.useEffect)((function(){return window.addEventListener("resize",en),function(){window.removeEventListener("resize",en)}}));var en=function(){var e,t=(null===(e=document.getElementById("home_action_form"))||void 0===e?void 0:e.clientWidth)-Nt-Ft-169;He(t)};(0,L.useEffect)((function(){La(null)}),[i]);var tn=function(e,t,a){var n;tt(e);var l=null===(n=(0,w.default)(e).call(e,(function(e){return e.active})))||void 0===n?void 0:n.id;return Ya(o,t,W.ENV_APP,a,l)};(0,L.useEffect)((function(){var e=function(){var e=(0,y.default)(g.default.mark((function e(){var t;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Ze){e.next=6;break}return e.next=4,(0,oe.getViewData)(i);case 4:t=e.sent,tn(t.rows||[],i,At);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),Qa({dataSource:[],footerDataSource:[],pageNo:1,pageSize:20,totalCount:0,lastPage:!0,formName:"",loading:!1,listItemConfig:[],listFilterConfig:[],listStatInfo:[],configuredFilterItems:[],listFilters:[]});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=(0,y.default)(g.default.mark((function e(){var t;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,fe.getLineIconAndColor)();case 3:(t=e.sent)&&yt(t.row||{}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e(),t()}),[i,Ze,At]);var an=(0,L.useCallback)(function(){var e=(0,y.default)(g.default.mark((function e(t){return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==Ha||Ha(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Ha]),nn=(0,L.useCallback)(function(){var e=(0,y.default)(g.default.mark((function e(t,a){var n,l,r;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,ie.getFormAuth)(o,i,t);case 3:if(l=e.sent,!((null==l||null===(n=l.rows)||void 0===n?void 0:n[0])||{})[a]){e.next=9;break}return e.abrupt("return",x.default.resolve());case 9:return(0,Y.showNotice)("error","权限不足"),e.abrupt("return",x.default.reject((0,k.default)(r="".concat(t," has not ")).call(r,a," auth")));case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",x.default.reject(null===e.t0||void 0===e.t0?void 0:e.t0.message));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,a){return e.apply(this,arguments)}}(),[o,i]),ln=(0,L.useMemo)((function(){return[{name:"详情",major:!0,onClick:function(e,t){null==Yt||Yt(t,e.id,"view")},disabled:!At},{name:"编辑",major:!0,onClick:(t=(0,y.default)(g.default.mark((function e(t,a){return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn(t.id,"edit");case 3:null==Yt||Yt(a,t.id,"edit"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e,a){return t.apply(this,arguments)}),disabled:!Mt},{name:"删除",danger:!0,onClick:(e=(0,y.default)(g.default.mark((function e(t){return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=2;break}return e.abrupt("return",wn());case 2:return e.prev=2,e.next=5,nn(t.id,"delete");case 5:null==an||an(t.id),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2);case 11:case"end":return e.stop()}}),e,null,[[2,8]])}))),function(t){return e.apply(this,arguments)}),disabled:!Pt}];var e,t}),[Yt,an,Pt,Mt,At,h,nn]),rn=(0,L.useCallback)((function(){be(!1)}),[]),un=(0,L.useCallback)((function(){Ba(!1)}),[]),on=(0,L.useCallback)((function(e,t,a){Wt("au_lo_cs_comf"),null==Ta||Ta(e,t,a)}),[Ta]),cn=(0,L.useCallback)((function(e){Wt("au_lo_fil_comf"),null==Ma||Ma(e)}),[Ma,Wt]),dn=(0,L.useCallback)((function(e){Wt("au_lo_fil_clear")}),[Wt]),fn=(0,L.useCallback)((function(){Oa(!1)}),[]),sn=(0,L.useCallback)((function(){Va(!1)}),[]),mn=(0,L.useCallback)((function(e){Wt("au_lo_sort_comf"),Va(!1),null==Wa||Wa(e)}),[Wa,Va]),pn=(0,L.useCallback)((function(e){Wt("au_lo_sort_clear")}),[Wt]),vn=(0,L.useCallback)((function(){r(!0)}),[]),hn=((0,L.useCallback)((function(e){Oa(!0)}),[]),(0,L.useCallback)((function(e){null==Aa||Aa(e)}),[Aa]),(0,L.useCallback)((function(){je(!Re),(0,I.default)(en,100)}),[Re])),gn=(0,L.useMemo)((function(){return(0,G.filterOperateCol)(ia)}),[ia]),_n=(0,L.useMemo)((function(){return(0,G.getLockedIndex)(gn)}),[gn]),yn=(0,L.useMemo)((function(){return(0,Q.getListItemSettingData)(gn)}),[gn]),bn=((0,L.useMemo)((function(){return(0,Q.getTransferFilters)((0,Q.getFilters)(va,sa))}),[va,sa]),(0,L.useCallback)((0,y.default)(g.default.mark((function e(){var t;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,oe.getViewData)(i);case 2:t=e.sent,tn(t.rows||[],i,At).then((function(){(0,Y.showNotice)("success","刷新成功")}));case 4:case"end":return e.stop()}}),e)}))),[o,i,At,tn])),En=(0,L.useCallback)((function(e){null==La||La(e),(0,se.publishSearchUserEvent)({appId:o,formId:i,action:"au_lo_srh"})}),[La,o,i]),Cn=(0,me.default)(En),wn=function(){(0,Y.showNotice)("error","预览时无法使用此功能")},kn=function(e){return h?wn:e},xn=(0,L.useCallback)((function(e,t){var a=(0,G.orderToIsAsc)(t);null==Wa||Wa(void 0!==a?[{number:e,isAsc:a}]:[])}),[Wa]),In=(0,he.default)({appId:o}),Sn=(0,L.useCallback)((function(e,t){var a="";switch(e){case"name":a=Ht("au_ch_fil_name");break;case"count":a=Ht("au_ch_fil_count")}return L.default.createElement("div",{"data-nc-action":a,className:U.default.head_filter_tab_header},t)}),[]),Nn=(0,L.useCallback)((function(){}),[]),Fn=(0,L.useMemo)((function(){return{onAggCellChange:Ua,onAggVisibleChange:function(e,t){return e&&Ka(t)},colOperations:ln,stateInfo:ka,onRowDelete:kn(Ha),sort:{sorts:Ea,onSort:xn},filter:{filters:ya,colHeadFilter:Ca,onFilterClear:Nn,onFilterConfirm:za,onFilterShow:qa,getFilterActive:G.getFilterActive,refBillProps:In,renderTabElement:Sn}}}),[xn,Ca,Ua,Ka,qa,za,Ha,h,ya,Ea,ln,ka,In,Sn,Nn]),Tn=(0,L.useMemo)((function(){var e,t=(0,G.getShowColumns)(ia,oa),a={align:"center",name:"序号",title:L.default.createElement(ee.TableTitle,{title:"序号",type:"serial"}),code:"seq",width:54,lock:!0,render:function(e,t,a){if(!t.isAgg){var n=(la-1)*ra+a+1;return L.default.createElement("div",{title:n},n)}}};return(0,k.default)(e=[a]).call(e,t)}),[ia,oa,la,ra]),An=(0,L.useMemo)((function(){return(0,G.getListSortConfig)(pa)}),[pa]),Mn=(0,L.useMemo)((function(){return(0,G.getConfiguredSortItems)(An,Ea)}),[An,Ea]),Pn=(0,L.useCallback)((function(){Fe(!1)}),[]),Dn=((0,L.useCallback)((function(){Fe(!0)}),[]),function(e,t){if(h)return wn();switch(t){case"copy":Wt("au_lo_cview_copy"),On(e);break;case"edit":Wt("au_lo_cview_edit"),Bn(e);break;case"delete":Wt("au_lo_cview_del"),Ln(e)}}),Ln=function(){var e=(0,y.default)(g.default.mark((function e(t){return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,Y.showDeleteConfirmModal)({title:"",message:"确定要删除该视图吗？",detail:"",onOk:function(){var e=(0,y.default)(g.default.mark((function e(){var a,n,l,r;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Wt("au_lo_cview_del_comf"),e.next=4,(0,oe.deleteView)(t.id);case 4:a=(0,C.default)(et).call(et,(function(e){return e.id!==t.id})),n=(0,w.default)(a).call(a,(function(e){return e.active})),l=(0,de.default)(a,(function(e){!n&&e[0]&&(e[0].active=!0)})),tn(l||[],i,At),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,Y.showNotice)("error",(null===e.t0||void 0===e.t0?void 0:e.t0.message)||(null===e.t0||void 0===e.t0||null===(r=e.t0.data)||void 0===r||null===(r=r.result[0])||void 0===r?void 0:r.errors[0]));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),On=function(){var e=(0,y.default)(g.default.mark((function e(t){var a,n,l,r,u,c,d,f,s,m,h,_,y,E,C,w,k;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rt(!1),a=t.name,e.prev=2,e.next=5,(0,oe.copyView)({name:a,copySchemaId:t.id});case 5:return l=e.sent,r=null==l?void 0:l.result[0].id,e.next=9,null===(n=ce.getFormDataListSetting)||void 0===n?void 0:n.call(ce,{appId:o,formId:i,env:W.ENV_APP,schemaId:r,compareTypes:p});case 9:u=e.sent,c=u.configuredFilterItems,d=u.listFilterConfig,f=u.listItemConfig,s=u.listTreeConfig,m=u.name,h=u.hidden,_=u.statCards,y=u.orderInfo,E=u.ganttconfig,C=u.schematype,w=u.timemode,ct(r),k=(0,de.default)(et,(function(e){e.forEach((function(e){e.active=!1})),e.push({userid:v,hidden:"none",id:r,name:a,active:!0,index:Math.max(et.length-1,0),ganttconfig:E,schematype:C,timemode:w})})),tn(k||[],i,At),Fe(!0),mt(ke(ke({},st),{},(0,b.default)({},r,{name:m,hidden:h,configuredFilterItems:c,listFilterConfig:d,listItemConfig:f,listTreeConfig:s,visibleColumnKeys:(0,G.getVisibleColumnKeys)(f),statCards:_,orderInfo:y,ganttconfig:E,schematype:C,timemode:w}))),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),(0,Y.showNotice)("error",e.t0.message);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),Bn=function(e){var t;Fe(!0),rt(!1),null===(t=ce.getFormDataListSetting)||void 0===t||t.call(ce,{appId:o,formId:i,env:W.ENV_APP,schemaId:e.id,compareTypes:p}).then((function(t){var a=t.configuredFilterItems,n=t.listFilterConfig,l=t.listItemConfig,r=t.listTreeConfig,u=t.name,o=t.hidden,i=t.statCards,c=t.orderInfo,d=t.ganttconfig,f=t.timemode,s=t.schematype;ct(e.id),mt(ke(ke({},st),{},(0,b.default)({},e.id,{name:u,hidden:o,configuredFilterItems:a,listFilterConfig:n,listItemConfig:l,listTreeConfig:r,visibleColumnKeys:(0,G.getVisibleColumnKeys)(l),statCards:i,orderInfo:c,ganttconfig:d,timemode:f,schematype:s})))}))},Vn=function(){var e=(0,y.default)(g.default.mark((function e(t){var a,n;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return tn(t||[],i,At),a=(0,S.default)(t).call(t,(function(e){return e.id})),n={formId:i,schemaIds:a},e.prev=3,e.next=6,(0,oe.sortView)(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),Un=function(){var e=(0,y.default)(g.default.mark((function e(){var t,a,n,l,r,u,o,c,d,f,s;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=2;break}return e.abrupt("return",wn());case 2:return Wt("au_lo_cview_add"),rt(!1),e.prev=4,e.next=7,(0,oe.modifyView)({name:"未命名视图",formId:i});case 7:return t=e.sent,a=t.result[0].id,ct(a),n={userid:v,hidden:"none",id:a,name:"未命名视图",active:!0,index:Math.max((null==et?void 0:et.length)-1,0)},l=(0,de.default)(et,(function(e){e.forEach((function(e){e.active=!1})),e.push(n)})),e.next=14,tn(l||[],i,At);case 14:r=e.sent,u=r.configuredFilterItems,o=r.listFilterConfig,c=r.listItemConfig,d=r.listTreeConfig,f=r.statCards,s=r.orderInfo,mt(ke(ke({},st),{},(0,b.default)({},a,{name:n.name,hidden:n.hidden,configuredFilterItems:u,listFilterConfig:o,listItemConfig:c,listTreeConfig:d,visibleColumnKeys:(0,G.getVisibleColumnKeys)(c),statCards:f,orderInfo:s}))),Fe(!0),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),(0,Y.showNotice)("error",e.t0.message);case 23:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(){return e.apply(this,arguments)}}(),Rn=(0,L.useMemo)((function(){var e=[{key:"edit",label:"编辑"},{key:"copy",label:"复制"}];return(null==et?void 0:et.length)>1&&e.push({key:"delete",label:"删除"}),[{prefix:"nocodeplatformicon",type:"gengduo3",dropDownInfo:e,handleItemClick:Dn}]}),[et]),jn=function(e){Wt("au_lo_cview_open");var t=(0,de.default)(et,(function(t){t.forEach((function(t){t.active=t.id===e}))}));tn(t||[],i,At)},Kn=(0,L.useMemo)((function(){return st[it]||{}}),[st,it]),zn=(0,L.useMemo)((function(){return(0,G.getListSortConfig)((null==Kn?void 0:Kn.listTreeConfig)||[])}),[Kn]),qn=(0,L.useMemo)((function(){return(0,G.getConfiguredSortItems)(zn,Kn.orderInfo)}),[Kn,zn]),Hn=(0,L.useMemo)((function(){return(0,Q.getListItemSettingData)((null==Kn?void 0:Kn.listItemConfig)||[])}),[Kn]),Wn=(0,L.useMemo)((function(){return(0,G.getLockedIndex)((null==Kn?void 0:Kn.listItemConfig)||[])}),[Kn]),Yn=((0,L.useMemo)((function(){var e;return null==Kn||null===(e=Kn.statCards)||void 0===e?void 0:(0,C.default)(e).call(e,(function(e){return e.display}))}),[Kn]),(0,L.useCallback)(function(){var e=(0,y.default)(g.default.mark((function e(t){return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ae.getEnumFilterValue)(o,i,W.ENV_APP,null==Kn?void 0:Kn.configuredFilterItems,null==Kn?void 0:Kn.listFilterConfig,{fieldName:null==t?void 0:t.fieldName,compareType:null==t?void 0:t.compareType,value:null==t?void 0:t.value},"schemaConfig");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,i,Kn])),Qn=function(){var e=(0,y.default)(g.default.mark((function e(t){var a,n,l,r,u,o,c,d,f,s,m,p,v;return g.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name,n=t.hidden,l=t.configuredFilterItems,r=t.configuredSortItems,u=t.statCards,o=t.lockIndex,c=t.checkedKeys,d=t.listData,f=t.ganttconfig,s=t.timemode,m=t.schematype,p={id:it,name:a,hidden:n,filterRows:l,orderInfo:r,listItems:(0,G.convertToListItemConfig)(c,d,o,Kn.listItemConfig),statCards:u,ganttconfig:f,timemode:s,schematype:m},Pn(),e.prev=3,v=(0,de.default)(et,(function(e){var t=(0,w.default)(e).call(e,(function(e){return e.id===it}));t&&(t.name=a,t.hidden=n,t.ganttconfig=f,t.timemode=s,t.schematype=m)})),e.next=7,(0,oe.modifyView)(p);case 7:tn(v||[],i,At),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),Gn=(0,L.useMemo)((function(){return(0,C.default)(et).call(et,(function(e){return!(0,N.default)(G.VIEW_PC_HIDDEN).call(G.VIEW_PC_HIDDEN,e.hidden)}))}),[et]),Xn=(0,L.useCallback)((function(e,t,a,n){var l="0";Re||(l="1"),delete qe[l],He(qe),Xa({next:e,key:t,action:n})}),[qe,Xa]),Zn=(0,L.useMemo)((function(){return L.default.createElement("div",{className:U.default.table_list},L.default.createElement(ea.Provider,{value:Fn},L.default.createElement(ee.DataGrid,{dataSource:aa,columns:Tn,primaryKey:"id",footerDataSource:na,useVirtual:!0,columnResize:!0,rowSelection:{type:"checkbox",value:Sa||[],highlightRowWhenSelected:!0,column:{lock:!0},onChange:Xn,clickArea:"row",stopClickEventPropagation:!0}})))}),[Fn,aa,Tn,na,Sa,Xn]),Jn=(0,L.useMemo)((function(){return Ja()}),[Ja]),$n=(0,L.useCallback)((function(e){Ga(e,(0,G.filterData)(e,aa),!0).catch((function(e){(0,Y.showNotice)("error",e.message||"删除失败")}))}),[i,aa,Ga]),el=(0,L.useCallback)((function(e){if(e){var t=e.type,a=e.params;if(t===Ie){var n=(a||{}).pkId;$n(n)}}else null==Pa||Pa()}),[$n,Pa]),tl=function(e,t){var a={filter:Jn,schemaId:qt,orderBy:xa,operation:e};ga&&(a.queryFilter=ga[0]),_a&&(a.search=_a),(0,oe.batchEditFormDataListItemWithFilter)(o,i,a).then((function(e){e.totalCount;var a=e.successCount,n=e.failCount;if("0"===n){var l;(0,Y.showNotice)("success",(0,k.default)(l="".concat(a,"条记录")).call(l,t,"成功")),bn()}else{var r,u,o,i;(0,Y.showNotice)("warning",(0,k.default)(r=(0,k.default)(u=(0,k.default)(o="".concat(a,"条记录")).call(o,t,"成功，")).call(u,n,"条记录")).call(r,t,"失败"));Se(null==e||null===(i=e.data)||void 0===i?void 0:i.result);bn()}St(!1)})).catch((function(e){var a,n,l=Se(null==e||null===(a=e.data)||void 0===a?void 0:a.result),r=null==e||null===(n=e.data)||void 0===n?void 0:n.successCount,u="";(0,S.default)(l).call(l,(function(e){var t;""!==u&&(u+="；"),u+="第"+(null==e?void 0:e.billIndex)+"条表单记录："+(null==e||null===(t=e.errors)||void 0===t?void 0:t[0])})),r&&"0"!=r&&(u+="；"+r+"条记录"+t+"成功"),(0,Y.showNotice)("error",u||(null==e?void 0:e.message)||"".concat(t,"失败")),St(!1)}))},al=function(e,t,a){St(!0),a?(0,Y.showConfirmModal)({title:"确定对记录执行".concat(t,"操作吗？"),actions:[{text:"取消",key:"cancel"},{text:"确定",key:"confirm"}],onAction:function(a){"confirm"===a?tl(e,t):St(!1)},type:"prompt"}):tl(e,t)},nl=function(e){return L.default.createElement(R.Dropdown.Menu,null,(0,S.default)(e).call(e,(function(e){return L.default.createElement(R.Dropdown.Item,{key:e.key,disabled:It,onClick:function(t,a){al(e.key,e.name,e.secondConfirm)}},e.name)})))},ll=(0,L.useCallback)((function(e){Pa()}),[Pa,$a]),rl=(0,L.useCallback)((function(e,t){ja(e,t,!0)}),[ja]),ul=(0,L.useMemo)((function(){return"1"===(null==zt?void 0:zt.schematype)}),[zt]),ol=L.default.createElement(L.default.Fragment,null,L.default.createElement("div",{className:(0,X.default)(U.default.container)},L.default.createElement("div",{className:U.default.main},L.default.createElement("div",{className:U.default.actions,id:"home_action_form"},L.default.createElement("div",{className:U.default.buttons},L.default.createElement("div",{id:"home_action_form_button",className:U.default.buttonsChild},Ot&&L.default.createElement(ee.BtnField,{type:"primary",text:"录入","data-nc-action":Ht("au_lo_fill"),onClick:Qt}),Dt&&L.default.createElement(K.default,{"data-nc-action":Ht("au_lo_ip"),refresh:bn,onClick:h?wn:void 0}),Lt&&L.default.createElement(L.default.Fragment,null,L.default.createElement(q.default,{selectedRows:Sa||[],tableDataSource:aa,searchKeyWord:_a,totalCount:ua,createUiActionDataStr:Ht,onClick:h?wn:void 0,activeSchemaId:qt,selectedQueryString:Jn,filters:null==ga?void 0:ga[0],selectedCount:Na}),L.default.createElement(_e.default,{formId:i,activeSchemaId:qt,searchKeyWord:_a,selectedQueryString:Jn,filters:null==ga?void 0:ga[0],selectedCount:Na,totalCount:ua,onItemClick:kn()})),Mt&&L.default.createElement(L.default.Fragment,null,L.default.createElement(ee.BtnField,{disabled:0===Na,type:"text",text:"批量编辑",icon:{type:"bianji",prefix:"nocodeplatformicon"},"data-nc-action":Ht("au_lo_be"),onClick:function(){h?wn():wt(!0)}}),Ct&&L.default.createElement(z.default,{visible:Ct,setVisible:wt,appId:o,formId:i,activeSchemaId:qt,searchKeywords:_a,refBillProps:In,listFilterConfig:sa,listFilters:ga,listItemConfig:ma,onColHeadFilterVisibleChange:ja,colHeadFilter:wa,orderBy:xa,onConfirmEdit:ll,selectedQueryString:Jn})),Pt&&L.default.createElement(ee.BtnField,{type:"text",text:"删除",icon:{type:"shanchu2",prefix:"nocodeplatformicon"},"data-nc-action":Ht("au_lo_del"),disabled:0===Na,onClick:h?wn:function(){(0,Y.showConfirmModal)({type:"delete",title:"确定删除选中的".concat(Na,"条记录吗？"),onAction:function(e){if("ok"===e)Za().then((function(e){var t=e.successCount;(0,Y.showNotice)("success",(0,ge.getErrTips)(t,0,"删除"))})).catch((function(e){(0,ge.showBatchErrNotice)(e,"删除")}))}})}})),Na>0&&Ia.length>0&&function(){var e,t=qe;0!==t&&t==t||(t=(null===(e=document.getElementById("home_action_form"))||void 0===e?void 0:e.clientWidth)-Nt-Ft-169);var a=0,n=[];return L.default.createElement("div",{className:U.default.toolbarItem},(0,S.default)(Ia).call(Ia,(function(e,l){if((a+=40+15*e.name.length)<t)return L.default.createElement("div",{className:U.default.toolbarIcon},function(e,t){var a,n,l=(0,Y.getQueryString)("svg",t),r=l&&"undefined"!==l?null==e||null===(a=e.svgs)||void 0===a?void 0:(0,F.default)(a).call(a,(function(e){return e.label===l})):0,u=It?"#cccccc":"#666666",o=null==e||null===(n=e.svgs)||void 0===n||null===(n=n[r])||void 0===n?void 0:n.content;return L.default.createElement("div",{ref:function(e){var t;null==e||null===(t=e.getElementsByTagName("path"))||void 0===t||null===(t=t[0])||void 0===t||t.setAttribute("style","fill:".concat(u," "))},disabled:It,className:(0,X.default)(U.default.svgIcon),dangerouslySetInnerHTML:{__html:(0,T.default)(o).call(o,/<title>.*?<\/title>/g,"")||""}})}(_t,e.icon),L.default.createElement(ee.BtnField,{type:"text",text:e.name,disabled:It,onClick:h?wn:function(t,a){al(e.key,e.name,e.secondConfirm)}}));n.push(e)})),n.length>0&&L.default.createElement(R.Dropdown,{menu:nl(n)},L.default.createElement("span",{className:U.default.dropdown},L.default.createElement(ee.BtnField,{type:"text",text:"更多"}),L.default.createElement(R.Icon,{type:"arrow-down"}))))}()),L.default.createElement("div",{className:U.default.vas_action,id:"home_vas_action_form"},L.default.createElement("div",{className:U.default.search},L.default.createElement(te.default,{placeholder:"搜索",borderType:"bordered",prefix:L.default.createElement(R.Icon,{prefix:"nocodeplatformicon",type:"sousuo"}),size:"small",onChange:Cn,value:_a,allowClear:!0})),L.default.createElement("div",{className:U.default.split_line}),L.default.createElement(ee.BtnField,{type:"text",className:U.default.refresh,"data-nc-action":Ht("au_lo_ref"),onClick:Da,icon:{prefix:"nocodeplatformicon",type:"shuaxin"}}),L.default.createElement(ee.BtnField,{className:U.default.fullscreen,type:"text","data-nc-action":Ht(Re?"au_lo_exitfull":"au_lo_full"),icon:{prefix:"nocodeplatformicon",type:Re?"suoxiao":"fangda"},onClick:hn}))),(null==ia?void 0:ia.length)>0?L.default.createElement(L.default.Fragment,null,L.default.createElement("div",{className:U.default.list},L.default.createElement("div",{className:U.default.nav},L.default.createElement(R.Tooltip,(0,b.default)({visible:lt,arrow:!1,placement:"topLeft",trigger:"click",onVisibleChange:function(e){rt(e)},tip:L.default.createElement(ue.default,{data:et,handleItemClick:function(e){jn(e.id),rt(!1)},toolbar:Rn,handleViewAdd:Un,draggable:!0,onDrop:Vn}),popperStyle:{padding:0,zIndex:1049}},"trigger","click"),L.default.createElement(ee.BtnField,{type:"text",className:(0,X.default)(U.default.btn,(0,b.default)({},U.default["btn-active"],lt)),icon:{prefix:"nocodeplatformicon",type:"shitu"}})),L.default.createElement(R.Tabs,{type:"card",showScrollArrow:!0,defaultActiveKey:qt,className:U.default.tab,onChange:jn},(0,S.default)(Gn).call(Gn,(function(e){return L.default.createElement(R.Tabs.TabPane,{key:e.id,tab:L.default.createElement("div",{className:U.default.tab_name},e.name)})}))),L.default.createElement("div",{className:U.default.setting},L.default.createElement(ve.default,{title:"筛选",onClose:fn,onConfirm:cn,onClear:dn,data:sa||[],configuredFilterItems:va,style:{width:"640px",height:"332px"},maskClosable:!0,maskStyle:{opacity:0},draggable:!0,showClearAll:!0,refBillProps:In,onColHeadFilterVisibleChange:rl,colHeadFilter:wa,visible:da,onVisibleChange:Oa},L.default.createElement(ee.BtnField,{type:"text",title:"筛选",className:(0,X.default)(U.default.btn,(0,b.default)({},U.default["btn-active"],da||(null==va?void 0:va.length)>0)),icon:{prefix:"nocodeplatformicon",type:"shaixuan"}})),L.default.createElement(ee.ListSortDropdown,{title:"排序",onClose:sn,onConfirm:mn,onClear:pn,data:An||[],configuredSortItems:Mn,style:{width:"480px",height:"480px"},maskClosable:!0,maskStyle:{opacity:0},draggable:!0,showClearAll:!0,visible:fa,onVisibleChange:function(e){Va(e)}},L.default.createElement(ee.BtnField,{type:"text",title:"排序",className:(0,X.default)(U.default.btn,(0,b.default)({},U.default["btn-active"],fa||(null==Ea?void 0:Ea.length)>0)),icon:{prefix:"nocodeplatformicon",type:"paixu3"}})),L.default.createElement(ee.ListItemSettingDropdown,{title:"列设置",onClose:un,checkedKeys:oa,onConfirm:on,data:yn||[],lockIndex:_n,height:480,maskClosable:!0,maskStyle:{opacity:0},okProps:{"data-nc-action":Ht("au_lo_cs_comf")},onVisibleChange:function(e){Ba(e)},visible:ca,showLock:!ul,draggable:!0},L.default.createElement(ee.BtnField,{type:"text",title:"列设置",className:(0,X.default)(U.default.btn,U.default["row-setting"],(0,b.default)({},U.default["btn-active"],ca)),icon:{prefix:"nocodeplatformicon",type:"lieshezhi"}})),Bt&&L.default.createElement(ee.BtnField,{onClick:vn,title:"统计",type:"text",className:U.default.btn,icon:{prefix:"nocodeplatformicon",type:"xinjianbaobiao"},"data-nc-action":Ht("au_lo_analy")}))),ul?L.default.createElement(xe,{activeSchema:zt,dataSource:aa,columns:Tn,viewMode:zt.timemode}):Zn),L.default.createElement("div",{className:U.default.page},L.default.createElement("span",{className:U.default.page_total},"已选",Na,"条"),L.default.createElement(R.Pagination,{showSizeChanger:!0,showQuickJumper:!1,defaultCurrent:la,current:la,total:ua,pageSize:ra,onChange:function(e,t){null==Fa||Fa(e,t)},pageType:"nicety"}))):ba?null:ee.EmptyData&&L.default.createElement(ee.EmptyData,{src:$.default,desc:"暂无数据",imageWidth:224,imageHeight:128,textGap:16}))),Bt&&L.default.createElement(J.default,{env:W.ENV_APP,visible:l,formName:ta,setVisible:r,listFilterConfig:sa,configuredFilterItems:va,getConfiguredFilterItems:function(){var e,t,a,n,l,r=(0,S.default)(e=(0,C.default)(t=va||[]).call(t,(function(e){return"001"===e.compareType}))).call(e,(function(e){return e.fieldName})),u=new A.default((0,C.default)(a=(0,S.default)(n=ha||[]).call(n,(function(e){var t=e.compareType,a=e.fieldName;return"001"===t&&(0,N.default)(r).call(r,a)?null:[(0,M.default)(e),e]}))).call(a,Boolean)),o=Ee(va||[]);try{for(o.s();!(l=o.n()).done;){var i=l.value,c=(0,M.default)(i);u.has(c)||u.set(c,i)}}catch(e){o.e(e)}finally{o.f()}return(0,_.default)((0,P.default)(u).call(u))},getEnumFilterValue:Ra,viewInfo:et,activeSchemaId:qt,disabled:h,disabledAction:wn}),ye&&(Mt||Oe)&&L.default.createElement(j.default,{visible:ye,billList:aa,config:{formId:"bos_nocode_bill",appId:o,targetFormId:Me.formId,pkId:Me.pkId,Status:Oe,rootPageId:null===(t=c.rootConfig)||void 0===t?void 0:t.pageId},onRefresh:el,close:rn,disabled:h,disabledMsg:"预览时无法使用此功能",showDelete:Pt,showEdit:Mt,showCopy:Ot,viewAuth:At,detailShareReqireLogin:Vt,detailShareNotReqireLogin:Ut,editShare:Rt,inputShareReqireLogin:jt,inputShareNotReqireLogin:Kt}),Ne&&L.default.createElement(re.default,{visible:Ne,onClose:Pn,onConfirm:Qn,onGetCurrentData:function(e){return{filter:{data:sa,configuredFilterItems:va||[]},sort:{data:An||[],configuredSortItems:Mn||[]},column:{checkedKeys:oa||[],data:(0,Q.getListItemSettingData)(gn)||[],lockIndex:(0,G.getLockedIndex)(gn)}}[e]},base:{name:null==Kn?void 0:Kn.name,hidden:null==Kn?void 0:Kn.hidden,schematype:null==Kn?void 0:Kn.schematype,ganttconfig:null==Kn?void 0:Kn.ganttconfig,timemode:null==Kn?void 0:Kn.timemode},filter:{data:(null==Kn?void 0:Kn.listFilterConfig)||[],configuredFilterItems:(null==Kn?void 0:Kn.configuredFilterItems)||[],getEnumFilterValue:Yn,onSyncCurrentFilterData:function(){mt((function(e){return ke(ke({},e),{},(0,b.default)({},it,ke(ke({},e[it]),{},{configuredFilterItems:(0,G.copyArray)(va)})))}))}},sort:{data:zn||[],configuredSortItems:qn||[],onSyncCurrentSortData:function(){mt((function(e){return ke(ke({},e),{},(0,b.default)({},it,ke(ke({},e[it]),{},{orderInfo:Ea})))}))}},column:{checkedKeys:(null==Kn?void 0:Kn.visibleColumnKeys)||[],data:Hn||[],lockIndex:Wn,onSyncCurrentColumnData:function(){mt((function(e){return ke(ke({},e),{},(0,b.default)({},it,ke(ke({},e[it]),{},{lockIndex:_n,visibleColumnKeys:(0,G.copyArray)(oa),listItemConfig:(0,G.copyArray)(ma)})))}))}},statistic:{data:(null==Kn?void 0:Kn.statCards)||[]},createUiActionDataStr:Ht}));return Re?O.default.createPortal(L.default.createElement("div",{className:U.default["container-full-screen"]},ol),document.body):ol}));Ne.displayName="AppFormList";var Fe=function(){var e,t,a=(0,B.useParams)(),n=a.targetFormId,l=a.appId,r=(0,B.useOutletContext)().selectedNode,u=(0,L.useContext)(le.AuthorizeContext)||{},o=u.authList,i=u.pending,c=u.formId,d=!i&&c===n,f=null===(e=document.getElementById("home_vas_action_form"))||void 0===e?void 0:e.clientWidth,s=null===(t=document.getElementById("home_action_form_button"))||void 0===t?void 0:t.clientWidth;return d&&(0,D.default)(o).every((function(e){return!1===e}))?L.default.createElement(B.Navigate,{to:"/noPermission",replace:!0}):r?(0,Y.isCustomPage)(null==r?void 0:r.type)?L.default.createElement(pe.default,{pageId:r.formId,appId:l,readonly:!0}):L.default.createElement(Ne,{vasWidth:f,btnWidth:s}):null};Fe.displayName="AppHomePage";t.default=Fe}}]);