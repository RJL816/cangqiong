(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[185,728],{29436:function(e,t,a){"use strict";a.r(t),t.default={"loading-wrapper":"eZ4cHM3T_loading-wrapper","nocode-designer-wrapper":"xeYy+Eyr_nocode-designer-wrapper"}},94088:function(e,t,a){"use strict";a.r(t),t.default={drawer:"E2JRONYS_drawer",title:"Pbs3HJKx_title","title-desc":"gBxXL6nm_title-desc",add:"paclbU17_add",icon:"l6rsexmB_icon",drawer_content:"+t8iy6KC_drawer_content",drawer_footer:"KH4-AS7r_drawer_footer"}},50312:function(e,t,a){"use strict";a.r(t),t.default={container:"_3sh2aIe2_container",bg_img:"_4vGEjwUM_bg_img",main:"xaeIbVYZ_main"}},2116:function(e,t,a){"use strict";a.r(t),t.default={bg:"Tx1HgS3g_bg",bg_main:"_9JkeT9lS_bg_main",form:"gvztMGS9_form","operation-setting":"UPZBWhOV_operation-setting",hidden:"uP9GE+E5_hidden"}},63508:function(e,t,a){"use strict";a.r(t),t.default={aside:"H-nO1sIg_aside",searcher:"K4HvYwko_searcher",roles:"yFQl4Bru_roles",empty:"S8FgG0So_empty","role-item":"plkEv-uU_role-item","is-active":"fuLSaPWb_is-active","role-name":"MFm+eXXH_role-name","pop-active":"Xb9UaFmD_pop-active",extra:"_2fgEs77+_extra","drag-icon":"Zqp3Dl-M_drag-icon",popper:"W32AqGtK_popper"}},6972:function(e,t,a){"use strict";a.r(t),t.default={setting:"_7808LEUd_setting",title:"-dgSYDms_title","form-setting":"WYzS0mhV_form-setting"}},45632:function(e,t,a){"use strict";a.r(t),t.default={"form-auth":"U7SzRb9N_form-auth","custom-page-auth":"PYdjuZoi_custom-page-auth","custom-page-name":"_5+FUDQGc_custom-page-name","custom-page-switch":"cwFhcktu_custom-page-switch","no-perm":"eU6gOA7A_no-perm","auth-item":"lBy+E4+f_auth-item",name:"MCZ3Wr4x_name","record-auth":"_4qPWJGbh_record-auth",filter:"vYs-gqET_filter","is-active":"oXLqVT2x_is-active","filter-label-bar":"RmOUhENY_filter-label-bar",setting:"rtslxjPs_setting",title:"F2fWcgZL_title","form-setting":"DvHxaCFq_form-setting",hidden:"HK1UkPB-_hidden",bizButtonSetting:"BpNAJGie_bizButtonSetting",row:"sa0lZm+M_row"}},10528:function(e,t,a){"use strict";a.r(t),t.default={"right-of-use":"pVT4jUkh_right-of-use","operation-setting":"PPefB9lA_operation-setting"}},22444:function(e,t,a){"use strict";a.r(t),t.default={wrapper:"O5iM66b+_wrapper","role-item":"_10gFKvcz_role-item",extra:"_4ZXSf5B-_extra","role-name":"FmxUjSdg_role-name","drag-icon":"ZBmAX4bi_drag-icon","title-more":"Q56ul5XT_title-more","title-drag":"qgSPImSR_title-drag",title:"DYV44+u-_title","title-icon":"sPJrAaBV_title-icon",delete_content:"tineTX0e_delete_content",desc:"LDV2utUZ_desc"}},66436:function(e,t,a){"use strict";var n=a(25028),r=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;r(a(13939)),r(a(73980));var l=window.__kd_cdnPath__||window.__domainurl__,u={nocode:{url:"".concat(l+"ncp","/nocode-designer/nocodeRemoteEntry.js"),scope:"nocode_designer"},components:{url:"".concat(l+"ncp","/nocode-component/nocodeComponentEntry.js"),scope:"nocode_component"},base:{url:"".concat(l,"public/designer-base/designerBaseRemoteEntry.js"),scope:"designer_base"},nocodeflow:{url:"".concat(l+"ncp","/nocode-flow/nocodeFlowRemoteEntry.js"),scope:"nocode_flow"}};t.default=u},9308:function(e,t,a){"use strict";var n=a(13568),r=a(13939),l=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),c=a(25028),f=a(93252),s=a(9564);c(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onDragStart,a=e.onDragEnter,n=e.onDragLeave,r=e.onDragOver,l=e.onDragEnd,u=e.onDrop,o={onDragStart:function(e){e.stopPropagation();var a=e.currentTarget;a.setAttribute(E,!0);var n=a.getAttribute(y);e.dataTransfer.setData("text",n),null==t||t(e)},onDragEnter:function(e){var t=e.currentTarget;w(t),null==a||a(e)},onDragLeave:function(e){var t=e.currentTarget;b(t),null==n||n(e)},onDragOver:function(e){e.preventDefault(),null==r||r(e)},onDragEnd:function(e){var t=e.currentTarget;t.removeAttribute(E),t.style.opacity="",null==l||l(e)},onDrop:function(e){var t=e.dataTransfer.getData("text"),a=e.currentTarget,n=null==a?void 0:a.getAttribute(y);null==u||u(e,{sourceIndex:t,destinationIndex:n}),b(a)}};return{dragDropEvent:function(e){return g(g({},o),{},(0,m.default)({draggable:!0},y,e))}}};var m=s(a(96631));!function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},l=c&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?o(e,u):null;i&&(i.get||i.set)?c(r,u,i):r[u]=e[u]}r.default=e,a&&a.set(e,r)}(a(65984));function p(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(p=function(e){return e?a:t})(e)}function v(e,t){var a=r(e);if(l){var n=l(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):i?d(e,i(a)):v(Object(a)).forEach((function(t){c(e,t,o(a,t))}))}return e}var h="data-top-drag-style",_="data-bottom-drag-style",E="data-dragging",y="data-drag-key",S=[h,_],w=function(e){+document.querySelector("[".concat(E,"]")).getAttribute(y)>+e.getAttribute(y)?e.setAttribute(h,!0):e.setAttribute(_,!0)},b=function(e){var t;t=e,S.forEach((function(e){return t.removeAttribute(e)}))}},98688:function(e,t,a){"use strict";var n=a(25028),r=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a(78912)),u=r(a(99308)),o=r(a(52892)),i=a(65984),d=new u.default,c=new u.default,f=new o.default;t.default=function(e,t){var a=(0,i.useState)(!1),n=(0,l.default)(a,2),r=n[0],u=n[1],o=(0,i.useState)(!1),s=(0,l.default)(o,2),m=s[0],p=s[1];return(0,i.useEffect)((function(){if(e){if(c.has(e)||window[t])return u(!0),void p(!1);if(d.has(e))return f.has(e)||f.set(e,[]),void f.get(e).push([function(){u(!0)},function(){u(!1),p(!0)}]);d.add(e),u(!1),p(!1);var a=document.createElement("script");return a.src=e,a.type="text/javascript",a.async=!0,a.onload=function(){(c.add(e),u(!0),f.has(e))&&(f.get(e).forEach((function(e){return(0,(0,l.default)(e,1)[0])()})),f.delete(e))},document.head.appendChild(a),a.onerror=function(){(u(!1),p(!0),f.has(e))&&(f.get(e).forEach((function(e){var t=(0,l.default)(e,2);t[0];return(0,t[1])()})),f.delete(e))},function(){d.delete(e),f.delete(e),document.head.removeChild(a)}}}),[e]),{errorLoading:m,ready:r}}},56824:function(e,t,a){"use strict";var n=a(25028),r=a(9564);n(t,"__esModule",{value:!0}),t.useFederatedModule=void 0;var l=r(a(52892)),u=r(a(760)),o=r(a(29052)),i=r(a(78912)),d=r(a(94924)),c=a(65984),f=r(a(98688)),s=r(a(66436));var m=new l.default;t.useFederatedModule=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"./Main",l=s.default[e],p=l.url,v=l.scope,g=(0,u.default)(t=(0,u.default)(n="".concat(p,"-")).call(n,v,"-")).call(t,r),h=(0,c.useState)((function(){return m.get(g)||null})),_=(0,i.default)(h,2),E=_[0],y=_[1],S=(0,f.default)(p,v),w=S.ready,b=S.errorLoading,I=(0,c.useRef)(!1);return(0,c.useEffect)((function(){I.current?E&&y(null):I.current=!0}),[g]),(0,c.useEffect)((function(){w&&!E&&function(e,t){var n=s.default[e].scope;return(0,d.default)(o.default.mark((function e(){var r,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.I("default");case 3:return r=window[n],e.next=6,r.init(a.S.default);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:return e.next=13,window[n].get(t);case 13:return l=e.sent,u=l(),e.abrupt("return",u);case 16:case"end":return e.stop()}}),e,null,[[0,8]])})))}(e,r)().then((function(e){var t=e;m.set(g,t),y(t)}))}),[E,w,g]),{errorLoading:b,Component:E}}},77296:function(e,t,a){"use strict";var n=a(13568),r=a(13939),l=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),c=a(25028),f=a(93252),s=a(9564);c(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(29052)),p=s(a(94924)),v=s(a(78912)),g=s(a(96631)),h=s(a(94728)),_=s(a(50524)),E=s(a(760)),y=s(a(70696)),S=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=F(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},l=c&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?o(e,u):null;i&&(i.get||i.set)?c(r,u,i):r[u]=e[u]}return r.default=e,a&&a.set(e,r),r}(a(65984)),w=s(a(71252)),b=a(56824),I=a(57288),C=a(57264),P=s(a(40436)),O=a(4440),T=a(16428),N=s(a(29436));function F(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(F=function(e){return e?a:t})(e)}function x(e,t){var a=r(e);if(l){var n=l(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(Object(a),!0).forEach((function(t){(0,g.default)(e,t,a[t])})):i?d(e,i(a)):x(Object(a)).forEach((function(t){c(e,t,o(a,t))}))}return e}var A=[{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"ZkkM8aSPDj",Index:1,Id:"ZkkM8aSPDj",Key:"nocodecreatorfield",Name:"创建人",FieldType:"NoCodeCreatorField"},{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"Adb5iWON2Y",Features:'{"_Type_":"Features","Copyable":false}',Id:"Adb5iWON2Y",Key:"nocodecreatedatefield",Name:"创建日期",FieldType:"NoCodeCreateDateField"},{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"d70tu1iLBS",Index:3,Id:"d70tu1iLBS",Key:"nocodemodifierfield",Name:"修改人",FieldType:"NoCodeModifierField"},{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"S78gWsEw5e",Index:2,Features:'{"_Type_":"Features","Copyable":false}',Id:"S78gWsEw5e",Key:"nocodemodifydatefield",Name:"修改日期",FieldType:"NoCodeModifyDateField"}],D=[{_Type_:"NoCodeCreatorField",BillEntityId:"68bde9ca00000eac",BillEntityIdEx:"68bde9ca00000eac",Features:{_Type_:"Features",Ver:1,Copyable:!1},DataRange:{_Type_:"NoCodeDataRangeField",min:"0",max:"3"},PropsDisplay:"name,number,gender,phone,email",Id:"ZkkM8aSPDj",LableHyperlink:!1,FieldName:"f1807354271661201409",Key:"nocodecreatorfield",Name:"创建人"},{_Type_:"NoCodeCreateDateField",Features:{_Type_:"Features",Ver:1,Copyable:!1},Id:"Adb5iWON2Y",FieldName:"f1807354271662465026",Key:"nocodecreatedatefield",Name:"创建日期"},{_Type_:"NoCodeModifierField",BillEntityId:"68bde9ca00000eac",BillEntityIdEx:"68bde9ca00000eac",Features:{_Type_:"Features",Ver:1,Copyable:!1},DataRange:{_Type_:"NoCodeDataRangeField",min:"0",max:"3"},PropsDisplay:"name,number,gender,phone,email",Id:"d70tu1iLBS",LableHyperlink:!1,FieldName:"f1807354271661201410",Key:"nocodemodifierfield",Name:"修改人"},{_Type_:"NoCodeModifyDateField",Features:{_Type_:"Features",Ver:1,Copyable:!1},Id:"S78gWsEw5e",FieldName:"f1807354271662465027",Key:"nocodemodifydatefield",Name:"修改日期"}],M=["NoCodeCreatorField","NoCodeCreateDateField","NoCodeModifierField","NoCodeModifyDateField"],L=function(e,t){var a,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.formmeta,l=e.entitymeta,u=r.Items,o=l.Items,i=(0,h.default)(u).call(u,(function(e,t){var a=t.FieldType;return(0,_.default)(M).call(M,a)?(0,E.default)(e).call(e,a):e}),[]),d=n?(0,h.default)(A).call(A,(function(e,a){var n=a.FieldType;return(0,_.default)(i).call(i,n)?e:(0,E.default)(e).call(e,k(k({},a),{},{ParentId:t}))}),[]):[];e.formmeta=k(k({},r),{},{Items:(0,E.default)(a=(0,y.default)(u).call(u,(function(e){var t,a=e._Type_;return!(0,_.default)(t=["BizBtnFlexPanelAp","NoCodeBizButtonAp"]).call(t,a)}))).call(a,d)});var c=(0,h.default)(D).call(D,(function(e,t){var a=t._Type_;return(0,_.default)(i).call(i,a)?e:(0,E.default)(e).call(e,t)}),[]);return e.entitymeta=k(k({},l),{},{Items:(0,E.default)(o).call(o,c)}),e},R=(0,S.forwardRef)((function(e,t){var a=e.formId,n=e.appId,r=e.value,l=e.floatMenu,u=e.fieldStatusSettingMode,o=e.fieldStatusSettingOptions,i=e.needSystemField,d=(0,S.useState)(),c=(0,v.default)(d,2),f=c[0],s=c[1],h=(0,S.useState)(),_=(0,v.default)(h,2),E=_[0],y=_[1],F=(0,S.useState)([]),x=(0,v.default)(F,2),A=x[0],D=x[1],M=((0,b.useFederatedModule)("nocode").Component||{}).NoCodeDesigner,R=(0,P.default)().state.fileServer,U=R.imageUrl,V=void 0===U?"":U,j=R.attachmentUrl,B=void 0===j?"":j,Y=(0,S.useRef)(),W=(0,S.useCallback)((function(e){(0,I.fetchData)("","nocode/getDomainModel.do",{modelType:e,targetFormId:a}).then((function(e){return s(e.data)}))}),[]),q=function(){var e=(0,p.default)(m.default.mark((function e(){var t,r,l,u,o,d;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,O.getFormMetaData)({appId:n,targetFormId:a});case 3:r=e.sent,l=r.rows,o=(null===(t=(u=void 0===l?[]:l)[0])||void 0===t?void 0:t.metadata)||{},(0,T.unstable_batchedUpdates)((function(){var e;y(L(o,a,i)),D((null===(e=u[0])||void 0===e?void 0:e.tableMetas)||[])})),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),d=e.t0.message,(0,C.showNotice)("error",d);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),z=(0,S.useCallback)((function(e){Y.current=k({},e)}),[]);(0,S.useEffect)((function(){W("NoCodeModel"),q()}),[]),(0,S.useImperativeHandle)(t,(function(){return{getDesignerRef:function(){return Y.current}}}));var K=(0,w.default)((0,g.default)({},N.default["nocode-designer-wrapper"],!0));return f&&E&&M?S.default.createElement("div",{className:K},S.default.createElement(M,{meta:f,data:E,tableMetas:A,onApi:z,settingData:null,floatMenu:l,defaultFieldStatusMap:r,fieldStatusSettingMode:u,fieldStatusSettingOptions:o,baseUrl:{attachment:B,picture:V}})):null}));R.displayName="DesignerPermissionView";t.default=R},8992:function(e,t,a){"use strict";var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),d=a(63548),c=o(a(77296)),f=o(a(94088));function s(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(s=function(e){return e?a:t})(e)}t.default=function(e){var t=e.formId,a=e.appId,n=e.visible,r=e.value,l=e.title,u=e.fieldPermissionMenu,o=e.fieldStatusSettingMode,s=void 0===o?"default":o,m=e.fieldStatusSettingOptions,p=e.needSystemField,v=e.setVisible,g=e.onChange,h=(0,i.useRef)(null);return i.default.createElement(d.Drawer,{mask:!0,maskStyle:{opacity:0},visible:n,onClose:function(){return v(!1)},getContainer:function(){return document.body},width:960,keyboard:!1,className:f.default.drawer,title:l,maskClosable:!0,destroyOnClose:!0},i.default.createElement("div",{className:f.default.drawer_content},i.default.createElement(c.default,{formId:t,appId:a,value:r,floatMenu:u,fieldStatusSettingMode:s,fieldStatusSettingOptions:m,ref:h,needSystemField:p}),i.default.createElement("div",{className:f.default.drawer_footer},i.default.createElement(d.Button,{onClick:function(){return v(!1)},style:{marginRight:"12px"}},"取消"),i.default.createElement(d.Button,{type:"primary",onClick:function(){var e=(h.current||{}).getDesignerRef,t=((null==e?void 0:e())||{}).fieldStatusMap;null==g||g(t,{getDesignerRef:e}),v(!1)}},"确定"))))}},53704:function(e,t,a){"use strict";var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),d=o(a(87452)),c=o(a(71252)),f=o(a(50312));function s(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(s=function(e){return e?a:t})(e)}var m=(0,i.memo)((function(e){var t=e.children,a=e.className,n=e.mainClassName;return i.default.createElement("div",{className:(0,c.default)(a,f.default.container)},i.default.createElement("img",{src:d.default,className:f.default.bg_img,width:"100%",height:520}),i.default.createElement("div",{className:(0,c.default)(n,f.default.main)},t))}));m.displayName="BgContainer";t.default=m},26920:function(e,t,a){"use strict";var n=a(13568),r=a(13939),l=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),c=a(25028),f=a(93252),s=a(9564);c(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(29052)),p=s(a(28429)),v=s(a(73020)),g=s(a(67584)),h=s(a(13939)),_=s(a(94728)),E=s(a(25288)),y=s(a(96631)),S=s(a(94924)),w=s(a(78912)),b=U(a(65984)),I=a(63548),C=s(a(85744)),P=a(20680),O=s(a(72492)),T=U(a(46100)),N=U(a(31448)),F=U(a(93012)),x=a(57264),k=a(66028),A=s(a(2116)),D=s(a(71252)),M=a(60644),L=s(a(53704));function R(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(R=function(e){return e?a:t})(e)}function U(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=R(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},l=c&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?o(e,u):null;i&&(i.get||i.set)?c(r,u,i):r[u]=e[u]}return r.default=e,a&&a.set(e,r),r}function V(e,t){var a=r(e);if(l){var n=l(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):i?d(e,i(a)):V(Object(a)).forEach((function(t){c(e,t,o(a,t))}))}return e}var B=function(e){return e?W:q},Y=function(e){var t=e.name,a=void 0===t?"":t,n=e.desc,r=void 0===n?"":n,l=e.users,u=void 0===l?[]:l,o=e.id,i=e.manage,d=e.useType,c=e.orgs;return{id:o,name:a,desc:r,users:u,orgs:void 0===c?[]:c,useType:d,manage:i?W:q}},W="0",q="1",z=[{label:"拥有应用的全部管理权",value:W},{label:"无",value:q}];t.default=function(e){var t=e.formList,a=e.appId,n=e.creatorId,r=e.rolePermission,l=e.onAfterSave,u=e.setRolePermission,o=I.Form.useForm(),i=(0,w.default)(o,1)[0],d=(0,b.useReducer)(k.assignDataReducer,Y(r)),c=(0,w.default)(d,2),f=c[0],s=c[1],R=(0,b.useRef)(null),U=(0,b.useRef)(null),V=(0,b.useState)(!1),q=(0,w.default)(V,2),K=q[0],H=q[1],Z=(0,b.useState)(!1),G=(0,w.default)(Z,2),X=G[0],J=G[1],Q=(0,b.useState)(!0),$=(0,w.default)(Q,2),ee=$[0],te=$[1],ae=(0,b.useState)(!0),ne=(0,w.default)(ae,2),re=ne[0],le=ne[1],ue="0"===f.manage,oe=!!r.system,ie=(0,b.useRef)(!1),de=function(){var e=(0,S.default)(m.default.mark((function e(t){var a,n,o,i,d,c,f,s,p;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:[t]},ie.current=!0,n=(0,x.showLoadingMessage)("保存中，请稍候..."),e.prev=3,e.next=6,(0,P.saveRole)(a);case 6:o=e.sent,i=o.failCount,d=o.result,ie.current=!1,"0"===i&&(n({type:"success",content:"保存成功"}),f=null==d||null===(c=d[0])||void 0===c?void 0:c.id,l(f),s=j(j({},t),{},{id:f,system:r.system}),u(s)),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(3),ie.current=!1,p=e.t0.message,n({type:"error",content:p,duration:0});case 19:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();(0,b.useEffect)((function(){var e=Y(r),t=e.name,a=e.desc,n=e.manage,l=e.useType,u=e.users,o=e.orgs;s(e),i.setFieldsValue({name:t,desc:a,manage:n,useType:l,users:u,orgs:o})}),[r]);var ce=(0,b.useMemo)((function(){var e=f.name,t=f.desc,a=f.users,n=void 0===a?[]:a,l=f.manage,u=f.useType,o=f.id,i=f.orgs,d=void 0===i?[]:i,c=r.name,s=r.desc,m=r.users,p=void 0===m?[]:m,v=r.orgs,g=void 0===v?[]:v,h=r.manage,_=r.useType;return o!==r.id||e===c&&t===s&&(0,M.isEqual)(n,p)&&(0,M.isEqual)(d,g)&&l===B(h)&&u===_&&ee&&re}),[f,r,ee,re]),fe=(0,b.useMemo)((function(){var e=f.useType;return!!(e===T.USE_TYPE_SELF&&X||e===T.USE_TYPE_CUSTOM&&K)}),[f,X,K]),se=(0,b.useMemo)((function(){return n&&oe?[n]:[]}),[oe,n]),me=(0,b.useMemo)((function(){var e=null!=r&&r.formPerm?(0,_.default)(t).call(t,(function(e,t){var a,n,l=t.formId;null!=r&&null!==(a=r.formPerm)&&void 0!==a&&a[l]&&(e[l]=null==r||null===(n=r.formPerm)||void 0===n?void 0:n[l]);return e}),{}):(0,_.default)(t).call(t,(function(e,t){return e[t.formId]=F.INIT_FORM_PERM,e}),{});return e}),[r,t]),pe=(0,b.useMemo)((function(){return null==r?void 0:r.appPerm}),[r]);return r?b.default.createElement(L.default,{className:A.default.bg,mainClassName:A.default.bg_main},b.default.createElement("div",{className:A.default.form},b.default.createElement(I.Form,{layout:"vertical",form:i,labelWidth:"100%",wrapperWidth:"100%",onValuesChange:function(e,t){}},b.default.createElement(I.Form.Item,{label:b.default.createElement("span",{title:"角色的名称"},"角色名称"),name:"name",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入角色名称"},{type:"string",validator:function(e,t,a,n,r){return null!=t&&(0,E.default)(t).call(t)?[]:[new Error("请输入角色名称")]}}]},b.default.createElement(I.Input,{type:"text",borderType:"bordered",size:"large",placeholder:"请输入角色名称",maxLength:30,value:f.name,onChange:function(e){return s({name:e.target.value})}})),b.default.createElement(I.Form.Item,{label:b.default.createElement("span",{title:"角色的描述"},"描述"),name:"desc"},b.default.createElement(I.Input,{type:"text",borderType:"bordered",size:"large",placeholder:"请输入描述",maxLength:50,value:f.desc,onChange:function(e){return s({desc:e.target.value})}})),b.default.createElement(I.Form.Item,{label:b.default.createElement("span",{title:"选择可以使用该角色的组织"},"授权组织"),name:"orgs"},b.default.createElement(O.default,{value:f.orgs,onChange:function(e){s({orgs:e})},withScope:!0})),b.default.createElement(I.Form.Item,{label:b.default.createElement("span",{title:"选择可以使用该角色的人员"},"授权人员"),name:"users"},b.default.createElement(C.default,{value:f.users,disabledIds:se,onChange:function(e){s({users:e})},withScope:!0})),b.default.createElement(I.Form.Item,{label:b.default.createElement("span",{title:"设置角色的应用管理权"},"应用管理权"),name:"manage"},b.default.createElement(I.Select,{value:f.manage,options:z,borderType:"bordered",size:"large",placeholder:"请选择",disabled:oe,onChange:function(e){return function(e){var t=f.useType;e===W&&t!==T.USE_TYPE_ALL?(s({manage:e,useType:T.USE_TYPE_ALL}),i.setFieldsValue({manage:e,useType:T.USE_TYPE_ALL})):s({manage:e})}(e)}})),b.default.createElement(I.Form.Item,{label:b.default.createElement("span",{title:"设置角色的应用使用权"},"应用使用权"),name:"useType"},b.default.createElement(T.default,{value:f.useType,disabled:ue,onChange:function(e){return s({useType:e})},footer:b.default.createElement(b.default.Fragment,null,b.default.createElement("div",{className:(0,D.default)([A.default["operation-setting"],(0,y.default)({},A.default.hidden,f.useType!==T.USE_TYPE_SELF)])},b.default.createElement(N.default,{ref:U,allowFieldAuth:!1,value:pe,handleEqualChange:function(e){return le(e)},onChange:function(e){var t=e.funcPermSet;J(!(null!=t&&t.length))}})),b.default.createElement("div",{className:(0,D.default)([(0,y.default)({},A.default.hidden,f.useType!==T.USE_TYPE_CUSTOM)])},b.default.createElement(F.default,{ref:R,key:"".concat(null==r?void 0:r.id,"-formPermSetting"),roleId:null==r?void 0:r.id,formList:t,value:me,appId:a,handleEqualChange:function(e){return te(e)},onChange:function(e){var t=(0,h.default)(e).every((function(t){var a=(e[t]||{}).funcPermSet,n=void 0===a?[]:a;return!(null!=n&&n.length)}));H(t)}})),b.default.createElement("div",{className:"kd-form-field-wrapper-message"},fe&&"应用使用权不能为空"))}))),b.default.createElement("div",{className:A.default["btn-area"]},b.default.createElement(I.Button,{type:"primary",disabled:ce,onClick:function(){if(fe)return(0,x.showNotice)("error","应用使用权不能为空");ie.current||new p.default((function(e,t){i.validateFields().then((function(t){var a=(0,v.default)(t);e(a)})).catch((function(e){return t(e)}))})).then((function(e){var t=e.useType,a=e.name,n=e.desc,l=e.manage,u=e.users,o=e.orgs,i=r.id,d=r.appId,c=(r.seq,{name:a,desc:n,appId:d,manage:l===W,users:u,orgs:o,useType:t});if(i&&(c.id=i),t===T.USE_TYPE_CUSTOM){var f=R.current.formPerm;c.formPerm=f}if(t===T.USE_TYPE_SELF){var s=U.current.appPerm;c.appPerm=s}de(c)})).catch((function(e){var t=e.message;(0,x.showNotice)("error",t)}))}},"保存"),b.default.createElement(I.Button,{disabled:ce,style:{marginLeft:"12px"},onClick:function(){if(!ie.current){var e=r.name,t=r.desc,a=r.users,n=void 0===a?[]:a,l=r.useType,u=r.manage,o=r.orgs,d=void 0===o?[]:o;s({name:e,desc:t,users:n,orgs:d,useType:l,manage:B(u)}),i.setFieldsValue({name:e,desc:t,users:n,orgs:d,useType:l,manage:B(u)}),l===T.USE_TYPE_CUSTOM&&(0,g.default)((function(){var e=R.current.dispatchSetting;null==e||e({type:"MERGE",payload:me})})),l===T.USE_TYPE_SELF&&(0,g.default)((function(){var e=U.current.dispatchSetting;null==e||e((0,N.transformAppPerm)(pe))}))}}},"取消")))):null}},84692:function(e,t,a){"use strict";var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(61260)),d=o(a(70696)),c=o(a(23992)),f=o(a(33260)),s=o(a(26048)),m=o(a(96631)),p=o(a(99148)),v=o(a(78912)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),h=a(63548),_=a(82416),E=o(a(71252)),y=o(a(75020)),S=o(a(9308)),w=o(a(63508));function b(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(b=function(e){return e?a:t})(e)}var I=[{name:"复制",key:"copy"},{name:"删除",key:"delete"}],C=function(e){var t=e.name,a=e.index,n=e.isSelected,r=e.isAdmin,l=e.onClick,u=e.setRoles,o=e.handleMenuItemClick,f=e.onSort,_=(0,g.useState)(!1),y=(0,v.default)(_,2),b=y[0],C=y[1],P=(0,S.default)({onDrop:function(e,t){var n=t.sourceIndex,r=t.destinationIndex;n!==r&&a===+r&&u((function(e){var t=(0,p.default)(e),a=(0,i.default)(t).call(t,n,1),l=(0,v.default)(a,1)[0];return(0,i.default)(t).call(t,r,0,l),null==f||f(t),t}))}}).dragDropEvent,O=(0,g.useMemo)((function(){return r?(0,d.default)(I).call(I,(function(e){return"delete"!==e.key})):I}),[r]);return g.default.createElement("div",(0,s.default)({className:(0,E.default)(w.default["role-item"],(0,m.default)((0,m.default)({},w.default["pop-active"],b),w.default["is-active"],n))},P(a)),g.default.createElement("span",{className:w.default["role-name"],onClick:l},t),g.default.createElement("span",{className:w.default.extra},g.default.createElement(h.Dropdown,{menu:g.default.createElement(h.Dropdown.Menu,null,null==O?void 0:(0,c.default)(O).call(O,(function(e){return g.default.createElement(h.Dropdown.Item,{key:e.key},g.default.createElement("span",null,e.name))}))),popperClassName:w.default.popper,visible:b,onItemClick:function(e){C(!1),null==o||o(e)},onVisibleChange:function(e){C(e)},trigger:"hover"},g.default.createElement(h.Button,{type:"text"},g.default.createElement(h.Icon,{prefix:"nocodeplatformicon",type:"gengduo3"}))),g.default.createElement(h.Button,{type:"text",className:w.default["drag-icon"]},g.default.createElement(h.Icon,{prefix:"nocodeplatformicon",type:"tuozhuai"}))))};t.default=function(e){var t=e.activeRoleId,a=(e.appId,e.roleList),n=e.onAdd,r=e.onCopy,l=e.onDelete,u=e.onSort,o=e.setActiveRoleId,i=(0,g.useState)(a||[]),s=(0,v.default)(i,2),m=s[0],p=s[1],E=(0,g.useRef)(null),S=(0,g.useState)(""),b=(0,v.default)(S,2),I=b[0],P=b[1],O=(0,y.default)((function(e){var t;null==e||e.persist();var a=null===(t=E.current)||void 0===t||null===(t=t.input)||void 0===t?void 0:t.value;P(a)}),500);(0,g.useEffect)((function(){p(a||[])}),[a]);var T=(0,g.useMemo)((function(){return I?(0,d.default)(m).call(m,(function(e){var t=e.name;return(0,f.default)(t).call(t,I)>-1})):m}),[I,m]);return g.default.createElement("div",{className:w.default.aside},g.default.createElement("div",{className:w.default.searcher},g.default.createElement(h.Input,{size:"small",ref:E,className:w.default.search_box,defaultValue:I,prefix:g.default.createElement(h.Icon,{prefix:"nocodeplatformicon",type:"sousuo"}),onChange:O,placeholder:"搜索角色",borderType:"bordered"}),g.default.createElement(h.Button,{icon:g.default.createElement(h.Icon,{prefix:"nocodeplatformicon",type:"jia4"}),type:"primary",onClick:n})),g.default.createElement("div",{className:w.default.roles},I&&!T.length?g.default.createElement("div",{className:w.default.empty},g.default.createElement(_.EmptyData,{desc:"暂无搜索结果"})):(0,c.default)(T).call(T,(function(e,a){var n=e.name,i=e.id,d=e.system;return g.default.createElement(C,{name:n,id:i,key:i,index:a,handleMenuItemClick:function(t){return function(e,t){switch(e){case"delete":l&&l(t);break;case"copy":r&&r(t)}}(t,e)},isSelected:t===i,isAdmin:!!d,setRoles:p,onClick:function(e){return o(i)},onSort:u})}))))}},31448:function(e,t,a){"use strict";var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.transformAppPerm=t.default=t.VIEW_OPTIONS_VALUE=t.VIEW_OPTIONS=t.SettingItem=t.EDIT_OPTIONS_VALUE=t.EDIT_OPTIONS=t.ADD_OPTIONS_VALUE=t.ADD_OPTIONS=void 0;var i=o(a(23992)),d=o(a(67584)),c=o(a(70696)),f=o(a(13939)),s=o(a(94728)),m=o(a(50524)),p=o(a(760)),v=o(a(99148)),g=o(a(78912)),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=I(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),_=a(63548),E=o(a(8992)),y=a(57264),S=a(66028),w=a(60644),b=o(a(6972));function I(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(I=function(e){return e?a:t})(e)}var C=function(e,t){return"NoCodeBizButtonAp"===e||"BizBtnFlexPanelAp"===e||"NoCodeEntryEntity"===t},P=t.SettingItem=function(e){var t=e.title,a=e.value,n=e.options,r=e.allowFieldAuth,l=e.onChange,u=e.formId,o=e.appId,m=e.checked,p=e.onSwitchChange,v=e.fieldPermSet,y=e.onPermSetChange,S=(0,h.useState)(m),w=(0,g.default)(S,2),I=w[0],P=w[1],O=(0,h.useState)(a),T=(0,g.default)(O,2),N=T[0],F=T[1],x=(0,h.useState)(!1),k=(0,g.default)(x,2),A=k[0],D=k[1],M=(0,h.useRef)(m);M.current=I;(0,h.useEffect)((function(){F(a)}),[a]),(0,h.useEffect)((function(){P(m)}),[m]);var L=(0,h.useCallback)((function(e){var t,a=(0,c.default)(t=(0,f.default)(e)).call(t,(function(t){return"noperm"===e[t]}));null==y||y(a)}),[]),R=(0,h.useMemo)((function(){return null==v?void 0:(0,s.default)(v).call(v,(function(e,t){return e[t]="noperm",e}),{})}),[v]);return h.default.createElement("div",{className:b.default.setting},h.default.createElement("div",{className:b.default.title},t),h.default.createElement(_.Switch,{checked:I,onChange:function(e){P(e);var t=e?(0,i.default)(n).call(n,(function(e){return e.value})):[];F(t),p(e),(0,d.default)((function(){null==l||l(t)}),0)}}),r&&h.default.createElement("div",{className:b.default["form-setting"],onClick:function(){return D(!0)}},null!=v&&v.length?"部分权限":"全部权限"),h.default.createElement(_.Checkbox.Group,{onChange:function(e){F(e),!M.current&&e.length&&(P(!0),(0,d.default)((function(){p(!0)}),0)),null==l||l(e)},style:{marginLeft:"24px"},value:N},(0,i.default)(n).call(n,(function(e){var t=e.value,a=e.label;return h.default.createElement(_.Checkbox,{value:t,key:t},a)}))),h.default.createElement(E.default,{title:"编辑权限",visible:A,setVisible:D,formId:u,appId:o,value:R,fieldStatusSettingMode:"permission",fieldPermissionMenu:[{key:"hasperm",label:"有权限"},{key:"noperm",label:"无权限"}],fieldStatusSettingOptions:{defaultStatus:"hasperm",hideMenu:C},onChange:L}))},O=t.VIEW_OPTIONS=[{value:"view-001",label:"导出"},{value:"view-002",label:"打印"},{value:"view-003",label:"统计"},{value:"view-004",label:"详情页分享（登录）"},{value:"view-005",label:"详情页分享（免登录）"}],T=t.ADD_OPTIONS=[{value:"add-001",label:"导入"},{value:"add-002",label:"录入页分享（登录）"},{value:"add-003",label:"录入页分享（免登录）"}],N=t.EDIT_OPTIONS=[{value:"edit-001",label:"编辑页分享（登录）"}],F=t.VIEW_OPTIONS_VALUE=(0,i.default)(O).call(O,(function(e){return e.value})),x=t.ADD_OPTIONS_VALUE=(0,i.default)(T).call(T,(function(e){return e.value})),k=t.EDIT_OPTIONS_VALUE=(0,i.default)(N).call(N,(function(e){return e.value})),A={funcPermSet:["view","view-001","view-002","view-003","view-004","view-005","add","add-001","add-002","add-003","edit","edit-001","delete"]},D=t.transformAppPerm=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:A).funcPermSet;return{viewFuncPerms:(0,c.default)(e).call(e,(function(e){return(0,m.default)(F).call(F,e)})),addFuncPerms:(0,c.default)(e).call(e,(function(e){return(0,m.default)(x).call(x,e)})),editFuncPerms:(0,c.default)(e).call(e,(function(e){return(0,m.default)(k).call(k,e)})),isDeleteOpOpen:null==e?void 0:(0,m.default)(e).call(e,"delete"),isViewOpOpen:null==e?void 0:(0,m.default)(e).call(e,"view"),isAddOpOpen:null==e?void 0:(0,m.default)(e).call(e,"add"),isEditOpOpen:null==e?void 0:(0,m.default)(e).call(e,"edit")}},M=(0,h.forwardRef)((function(e,t){var a=e.value,n=e.allowFieldAuth,r=void 0===n||n,l=e.formId,u=e.appId,o=e.handleEqualChange,i=e.onChange,d=(0,h.useReducer)(S.assignDataReducer,D(a||A)),c=(0,g.default)(d,2),f=c[0],s=c[1],m=(0,h.useCallback)((function(e){s({editFuncPerms:e})}),[s]),E=(0,h.useCallback)((function(e){s({addFuncPerms:e})}),[s]),I=(0,h.useCallback)((function(e){s({viewFuncPerms:e})}),[s]),C=function(e){var t,a=e.viewFuncPerms,n=e.editFuncPerms,r=e.addFuncPerms,l=e.isDeleteOpOpen,u=e.isViewOpOpen,o=e.isEditOpOpen,i=e.isAddOpOpen,d=(0,p.default)(t=[]).call(t,(0,v.default)(a),(0,v.default)(n),(0,v.default)(r));return l&&d.push("delete"),u&&d.push("view"),i&&d.push("add"),o&&d.push("edit"),{funcPermSet:d}};return(0,h.useImperativeHandle)(t,(function(){return{appPerm:C(f),dispatchSetting:s}}),[f]),(0,h.useEffect)((function(){var e=D(a);(0,w.isEqual)((0,y.deepTransformArrayToObj)(e),(0,y.deepTransformArrayToObj)(f))||s(e),o(!0)}),[a]),(0,h.useEffect)((function(){var e=D(a),t=(0,w.isEqual)((0,y.deepTransformArrayToObj)(e),(0,y.deepTransformArrayToObj)(f));o(t),null==i||i(C(f))}),[f]),h.default.createElement("div",{className:b.default["operate-setting"]},h.default.createElement(P,{title:"查看",options:O,value:f.viewFuncPerms,allowFieldAuth:r,formId:l,appId:u,checked:f.isViewOpOpen,onSwitchChange:function(e){s({isViewOpOpen:e})},onChange:I}),h.default.createElement(P,{title:"录入",options:T,value:f.addFuncPerms,allowFieldAuth:!1,formId:l,appId:u,checked:f.isAddOpOpen,onSwitchChange:function(e){s({isAddOpOpen:e})},onChange:E}),h.default.createElement(P,{title:"编辑",options:N,value:f.editFuncPerms,allowFieldAuth:r,formId:l,appId:u,checked:f.isEditOpOpen,onSwitchChange:function(e){s({isEditOpOpen:e})},onChange:m}),h.default.createElement("div",{className:b.default.setting},h.default.createElement("div",{className:b.default.title},"删除"),h.default.createElement(_.Switch,{checked:f.isDeleteOpOpen,onChange:function(e){s({isDeleteOpOpen:e})}})))}));t.default=M},93012:function(e,t,a){"use strict";var n=a(13568),r=a(13939),l=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),c=a(25028),f=a(93252),s=a(9564);c(t,"__esModule",{value:!0}),t.default=t.INIT_FORM_PERM=void 0;var m=s(a(29052)),p=s(a(22796)),v=s(a(13939)),g=s(a(70696)),h=s(a(23992)),_=s(a(50524)),E=s(a(38456)),y=s(a(760)),S=s(a(67584)),w=s(a(94924)),b=s(a(78912)),I=s(a(96631)),C=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=B(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},l=c&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?o(e,u):null;i&&(i.get||i.set)?c(r,u,i):r[u]=e[u]}return r.default=e,a&&a.set(e,r),r}(a(65984)),P=a(63548),O=a(31448),T=a(12700),N=a(69400),F=a(55867),x=a(57264),k=s(a(71252)),A=a(82416),D=a(98464),M=a(37220),L=s(a(45632)),R=a(60644),U=a(57264),V=a(71120),j=s(a(36060));function B(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(B=function(e){return e?a:t})(e)}function Y(e,t){var a=r(e);if(l){var n=l(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){(0,I.default)(e,t,a[t])})):i?d(e,i(a)):Y(Object(a)).forEach((function(t){c(e,t,o(a,t))}))}return e}var q=[],z="MERGE",K="UPDATE",H="DELETE",Z=function(e,t){var a=t.type,n=t.payload,r=t.deleteKey;switch(a){case z:return W({},n);case K:return W(W({},e),n);case H:var l=W({},e);return(0,p.default)(l,r)&&delete l[r],l;default:return e}},G=function(e,t){var a=W({},e);return(0,v.default)(t).forEach((function(e){var n=t[e];Array.isArray(n)&&!n.length?delete a[e]:a[e]=n})),a},X={funcPermSet:["view"]},J=t.INIT_FORM_PERM={record:"0",funcPermSet:["view","view-001","view-002","view-003","view-004","view-005","add","add-001","add-002","add-003","edit","edit-001","delete"],fieldPermSet:{},filters:[]},Q=function(e){var t=e.value,a=e.options,n=e.onChange,r=(0,C.useState)(t),l=(0,b.default)(r,2),u=l[0],o=l[1];return(0,C.useEffect)((function(){o(t)}),[t]),C.default.createElement("div",{className:L.default.bizButtonSetting},C.default.createElement("div",{className:L.default.row},C.default.createElement("div",{className:L.default.title},"业务操作"),C.default.createElement(P.Checkbox.Group,{onChange:function(e){var t;o(e);var r=(0,g.default)(t=(0,h.default)(a).call(a,(function(e){return e.id}))).call(t,(function(t){return!(0,_.default)(e).call(e,t)}));null==n||n(r)},style:{marginLeft:"108px"},value:u},(0,h.default)(a).call(a,(function(e){var t=e.id,a=e.text;return C.default.createElement(P.Checkbox,{value:t,key:t},(null==a?void 0:a.zh_CN)||"")})))))},$=function(e){var t=e.formInfo,a=e.value,n=e.appId,r=e.onChange,l=t.name,u=t.formId,o=(0,C.useState)(!!a),i=(0,b.default)(o,2),d=i[0],c=i[1],f=(0,C.useReducer)(G,a||J),s=(0,b.default)(f,2),p=s[0],v=s[1],B=(0,C.useState)([]),Y=(0,b.default)(B,2),z=Y[0],K=(Y[1],(0,C.useState)(!1)),H=(0,b.default)(K,2),Z=H[0],X=H[1],$=(0,C.useState)(!1),ee=(0,b.default)($,2),te=ee[0],ae=ee[1],ne=(0,C.useState)(),re=(0,b.default)(ne,2),le=re[0],ue=re[1],oe=(0,C.useState)([]),ie=(0,b.default)(oe,2),de=ie[0],ce=ie[1],fe=(0,C.useState)([]),se=(0,b.default)(fe,2),me=se[0],pe=se[1],ve=(0,C.useRef)(!1),ge=(0,C.useRef)(!1),he=(0,C.useRef)(),_e="2"===p.record,Ee=(0,C.useRef)({}),ye=(0,C.useRef)([]);Ee.current=p,ye.current=me;var Se=(0,C.useCallback)((function(){ae(!1)}),[]),we=function(e){var t,a=null===(t=p.filters||[])||void 0===t?void 0:(0,g.default)(t).call(t,(function(t,a){return e!==a}));Te({filters:a})},be=function(){var e=(0,w.default)(m.default.mark((function e(t,a){return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,F.getEnumFilterValue)(n,u,V.ENV_APP,a||p.filters||[],de,{fieldName:null==t?void 0:t.fieldName,compareType:null==t?void 0:t.compareType,value:null==t?void 0:t.value},"schemaConfig");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ie=(0,C.useCallback)((function(e,t){be({fieldName:null==e?void 0:e.fieldName,compareType:null==e?void 0:e.compareType,value:null==e?void 0:e.value},t).then((function(t){ue((function(a){return W(W({},a),{},(0,I.default)({},null==e?void 0:e.fieldName,t))}))}))}),[be]),Ce=(0,C.useMemo)((function(){return(0,T.getTransferFilters)((0,T.getFilters)(p.filters||[],de))}),[p.filters,de]),Pe=function(){var e=(0,w.default)(m.default.mark((function e(){var t,a,r,l,o,i,d,c;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,D.getFormDataListSetting)(n,u,"1",{});case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:t=e.t0,a=t.rows,r=(void 0===a?[]:a)[0]||{},l=r.listFilterConfig,o=void 0===l?[]:l,i=r.listItemConfig,d=void 0===i?[]:i,ce((0,h.default)(o).call(o,(function(e){var t=(0,E.default)(d).call(d,(function(t){return e.fieldName===t.number}))||{};return W(W({},e),t)}))),ve.current=!0,e.next=19;break;case 14:e.prev=14,e.t1=e.catch(0),c=e.t1.message,(0,x.showNotice)("error",c);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),Oe=function(){var e=(0,w.default)(m.default.mark((function e(){var t,a,r;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,M.getBizButtonByFormId)(n,u);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:t=e.t0,a=t.rows,pe((void 0===a?[]:a)||[]),ge.current=!0,e.next=18;break;case 13:e.prev=13,e.t1=e.catch(0),r=e.t1.message,(0,x.showNotice)("error",r);case 18:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();(0,C.useEffect)((function(){Z&&!ve.current&&Pe(),Z&&!ge.current&&Oe()}),[Z]);var Te=function(e){var t=W(W({},Ee.current),e);v(e),null==r||r(t)},Ne=function(e,t){var a,n=Ee.current.funcPermSet,r=void 0===n?[]:n,l={add:O.ADD_OPTIONS_VALUE,edit:O.EDIT_OPTIONS_VALUE,view:O.VIEW_OPTIONS_VALUE}[t]||[],u=(0,y.default)(a=(0,g.default)(r).call(r,(function(e){return!(0,_.default)(l).call(l,e)}))).call(a,e);Te({funcPermSet:u})},Fe=function(e,t){var a=Ee.current.funcPermSet,n=void 0===a?[]:a,r=e?(0,y.default)(n).call(n,t):(0,g.default)(n).call(n,(function(e){return e!==t}));Te({funcPermSet:r})},xe=function(e){var t,a=Ee.current.fieldPermSet,n=void 0===a?{}:a,r=n.view,l=void 0===r?[]:r,u=(0,y.default)(t=(0,g.default)(l).call(l,(function(e){return!(0,E.default)(me).call(me,(function(t){return t.id===e}))}))).call(t,e),o=W(W({},n),{},{view:u});Te({fieldPermSet:o})};(0,C.useEffect)((function(){(0,R.isEqual)((0,U.deepTransformArrayToObj)(a),(0,U.deepTransformArrayToObj)(p))||(c(!!a),v(a||J))}),[a]);var ke=(0,C.useMemo)((function(){var e=p.funcPermSet,t=void 0===e?[]:e;return{viewFuncPerms:(0,g.default)(t).call(t,(function(e){return(0,_.default)(O.VIEW_OPTIONS_VALUE).call(O.VIEW_OPTIONS_VALUE,e)})),addFuncPerms:(0,g.default)(t).call(t,(function(e){return(0,_.default)(O.ADD_OPTIONS_VALUE).call(O.ADD_OPTIONS_VALUE,e)})),editFuncPerms:(0,g.default)(t).call(t,(function(e){return(0,_.default)(O.EDIT_OPTIONS_VALUE).call(O.EDIT_OPTIONS_VALUE,e)})),isDeleteOpOpen:null==t?void 0:(0,_.default)(t).call(t,"delete"),isViewOpOpen:null==t?void 0:(0,_.default)(t).call(t,"view"),isAddOpOpen:null==t?void 0:(0,_.default)(t).call(t,"add"),isEditOpOpen:null==t?void 0:(0,_.default)(t).call(t,"edit")}}),[p]),Ae=(0,C.useMemo)((function(){var e,t=p.fieldPermSet,a=void 0===t?{}:t;return(0,g.default)(e=(null==a?void 0:a.view)||[]).call(e,(function(e){return!(0,E.default)(me).call(me,(function(t){return t.id===e}))}))}),[p,me]),De=(0,C.useMemo)((function(){var e=p.fieldPermSet,t=void 0===e?{}:e;return(null==t?void 0:t.input)||[]}),[p]),Me=(0,C.useMemo)((function(){var e=p.fieldPermSet,t=void 0===e?{}:e;return(null==t?void 0:t.edit)||[]}),[p]),Le=(0,C.useMemo)((function(){var e,t=p.fieldPermSet,a=void 0===t?{}:t;return(0,g.default)(e=(0,h.default)(me).call(me,(function(e){return e.id}))).call(e,(function(e){var t;return!(0,_.default)(t=(null==a?void 0:a.view)||[]).call(t,e)}))}),[p,me]);return C.default.createElement("div",{className:L.default["form-auth"]},C.default.createElement(P.Collapse,{defaultActiveKey:z,name:"Collapse_".concat(u),onChange:function(){X(!Z)}},C.default.createElement(P.Collapse.Panel,{header:l,panelKey:u,extra:C.default.createElement(P.Switch,{checked:d,onChange:function(e){c(e),null==r||r(e?p:void 0)}})},C.default.createElement("div",{className:(0,k.default)((0,I.default)((0,I.default)({},L.default["no-perm"],!0),L.default.hidden,d))},"[记录范围]、[操作权限] 的配置需开启后生效"),C.default.createElement("div",{className:(0,k.default)((0,I.default)({},L.default.hidden,!d))},C.default.createElement("div",{className:L.default["auth-item"]},C.default.createElement("div",{className:L.default.name,title:"设置角色可以使用的记录范围"},"记录范围"),C.default.createElement("div",{className:L.default["record-auth"]},C.default.createElement(P.Radio.Group,{onChange:function(e){var t=Ee.current.fieldPermSet.view,a=void 0===t?[]:t,n=(0,g.default)(a).call(a,(function(e){return(0,E.default)(me).call(me,(function(t){return t.id===e}))})),r=n.length?{view:n}:{},l="3"===e.target.value?W(W({},J),{},{fieldPermSet:r,record:e.target.value}):{record:e.target.value};Te(l)},value:p.record},C.default.createElement(P.Radio,{value:"0"},"可以使用所有记录"),C.default.createElement(P.Radio,{value:"1"},"可以使用自己的记录"),C.default.createElement(P.Radio,{value:"3"},"可以查看所有记录，只能编辑、删除自己录入的记录"),C.default.createElement(P.Radio,{value:"2"},"自定义")),_e&&C.default.createElement(j.default,{title:"筛选",onClose:Se,onConfirm:function(e){var t=(0,N.getEffectiveFilterItems)(e);Te({filters:t}),ae(!1)},data:de||[],configuredFilterItems:p.filters||q,style:{width:"640px",height:"332px"},maskClosable:!0,maskStyle:{opacity:0},draggable:!0,showClearAll:!0,onDelete:we,onColHeadFilterVisibleChange:Ie,colHeadFilter:le,visible:te,onDropdownVisibleChange:function(e){he.current=e},onVisibleChange:function(e){(0,S.default)((function(){he.current||ae(e)}))}},C.default.createElement("p",{className:(0,k.default)([(0,g.default)(L.default),(0,I.default)({},L.default["is-active"],te)])},C.default.createElement(P.Icon,{prefix:"nocodeplatformicon",type:"shaixuan"}),"筛选"))),_e&&C.default.createElement(A.FilterLabelBar,{maxLabelCount:3,filters:Ce,onDelete:we,className:L.default["filter-label-bar"]})),"3"!==p.record&&C.default.createElement("div",{className:L.default["auth-item"]},C.default.createElement("div",{className:L.default.name,title:"设置角色的操作权限"},"操作权限"),C.default.createElement("div",{className:L.default["op-auth"]},C.default.createElement(O.SettingItem,{title:"查看",options:O.VIEW_OPTIONS,value:ke.viewFuncPerms,allowFieldAuth:!0,formId:u,appId:n,checked:ke.isViewOpOpen,onSwitchChange:function(e){Fe(e,"view")},fieldPermSet:Ae,onChange:function(e){return Ne(e,"view")},onPermSetChange:function(e){var t,a,n=Ee.current.fieldPermSet,r=void 0===n?{}:n,l=r.view,u=void 0===l?[]:l,o=(0,h.default)(t=ye.current).call(t,(function(e){return e.id})),i=(0,y.default)(a=(0,g.default)(u).call(u,(function(e){return(0,_.default)(o).call(o,e)}))).call(a,e),d=W(W({},r),{},{view:i});Te({fieldPermSet:d})}}),C.default.createElement(O.SettingItem,{title:"录入",options:O.ADD_OPTIONS,value:ke.addFuncPerms,allowFieldAuth:!0,formId:u,appId:n,checked:ke.isAddOpOpen,onSwitchChange:function(e){Fe(e,"add")},onChange:function(e){return Ne(e,"add")},fieldPermSet:De,onPermSetChange:function(e){var t=Ee.current.fieldPermSet,a=W(W({},void 0===t?{}:t),{},{input:e});Te({fieldPermSet:a})}}),C.default.createElement(O.SettingItem,{title:"编辑",options:O.EDIT_OPTIONS,value:ke.editFuncPerms,allowFieldAuth:!0,formId:u,appId:n,fieldPermSet:Me,checked:ke.isEditOpOpen,onSwitchChange:function(e){Fe(e,"edit")},onChange:function(e){return Ne(e,"edit")},onPermSetChange:function(e){var t=Ee.current.fieldPermSet,a=W(W({},void 0===t?{}:t),{},{edit:e});Te({fieldPermSet:a})}}),C.default.createElement("div",{className:L.default.setting},C.default.createElement("div",{className:L.default.title},"删除"),C.default.createElement(P.Switch,{checked:ke.isDeleteOpOpen,onChange:function(e){Fe(e,"delete")}})),!!me.length&&C.default.createElement(Q,{options:me,value:Le,onChange:xe}))),"3"===p.record&&!!me.length&&C.default.createElement("div",{className:L.default["auth-item"]},C.default.createElement("div",{className:L.default.name,title:"设置角色的操作权限"},"操作权限"),C.default.createElement("div",{className:L.default["op-auth"]},C.default.createElement(Q,{options:me,value:Le,onChange:xe})))))))},ee=function(e){var t=e.formInfo,a=e.value,n=e.onChange,r=t.name,l=(0,C.useState)(!!a),u=(0,b.default)(l,2),o=u[0],i=u[1];return C.default.createElement("div",{className:(0,k.default)(L.default["form-auth"],L.default["custom-page-auth"])},C.default.createElement("div",{className:L.default["custom-page-name"]},r),C.default.createElement(P.Switch,{className:L.default["custom-page-switch"],checked:o,onChange:function(e){i(e),null==n||n(e?X:void 0)}}))},te=(0,C.forwardRef)((function(e,t){var a=e.roleId,n=e.formList,r=e.value,l=void 0===r?{}:r,u=e.appId,o=e.handleEqualChange,i=e.onChange,d=(0,C.useReducer)(Z,l),c=(0,b.default)(d,2),f=c[0],s=c[1],m=function(e,t){s(void 0===t?{type:H,deleteKey:e}:{type:K,payload:(0,I.default)({},e,t)})};return(0,C.useEffect)((function(){(0,R.isEqual)((0,U.deepTransformArrayToObj)(l),(0,U.deepTransformArrayToObj)(f))||s({type:z,payload:l}),o(!0)}),[l]),(0,C.useEffect)((function(){var e=(0,R.isEqual)((0,U.deepTransformArrayToObj)(l),(0,U.deepTransformArrayToObj)(f));o(e),null==i||i(f)}),[f]),(0,C.useImperativeHandle)(t,(function(){return{formPerm:f,dispatchSetting:s}}),[f,s]),C.default.createElement(C.default.Fragment,null,(0,h.default)(n).call(n,(function(e){var t,n,r=e.formId;return"custom"===e.type?C.default.createElement(ee,{formInfo:e,key:(0,y.default)(n="".concat(a,"-")).call(n,r),value:f[r],onChange:function(e){return m(r,e)}}):C.default.createElement($,{formInfo:e,key:(0,y.default)(t="".concat(a,"-")).call(t,r),appId:u,value:f[r],onChange:function(e){return m(r,e)}})})))}));t.default=te},46100:function(e,t,a){"use strict";var n=a(25028),r=a(9564);n(t,"__esModule",{value:!0}),t.default=t.USE_TYPE_VIEWALL=t.USE_TYPE_SELF=t.USE_TYPE_CUSTOM=t.USE_TYPE_ALL=void 0;var l=r(a(65984)),u=a(63548),o=r(a(10528)),i=t.USE_TYPE_ALL="all",d=t.USE_TYPE_SELF="own",c=t.USE_TYPE_CUSTOM="custom",f=[{label:"可以使用所有的表单记录",value:i},{label:"可以使用自己录入的表单记录",value:d},{label:"可以查看所有记录，只能编辑、删除自己录入的记录",value:t.USE_TYPE_VIEWALL="viewall"},{label:"自定义",value:c}];t.default=function(e){var t=e.value,a=e.disabled,n=e.onChange,r=e.footer;return l.default.createElement("div",{className:o.default["right-of-use"]},l.default.createElement(u.Select,{value:t,options:f,borderType:"bordered",size:"large",placeholder:"请选择",disabled:a,onChange:function(e){return null==n?void 0:n(e)}}),r)}},76004:function(e,t,a){"use strict";var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.getNextSelectedId=t.default=void 0;var i=o(a(23992)),d=o(a(73020)),c=o(a(25288)),f=o(a(1900)),s=o(a(29052)),m=o(a(94924)),p=o(a(78912)),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=N(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),g=o(a(84692)),h=o(a(26920)),_=a(85040),E=a(20680),y=a(25096),S=a(57264),w=a(41936),b=a(95936),I=a(82416),C=a(63548),P=a(46100),O=a(78016),T=o(a(22444));function N(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(N=function(e){return e?a:t})(e)}var F=t.getNextSelectedId=function(e,t){var a,n=(0,f.default)(t).call(t,(function(t){return t.id===e})),r=n>0?t[n-1]:void 0,l=t[n+1];return r?a=r.id:l&&(a=l.id),a};t.default=function(){var e,t=(0,w.useParams)().appId,a=(0,v.useContext)(b.Context),n=a.state,r=a.dispatch,l=n.appsList[t],u=n.userInfo,o=((l||{}).creater||{}).id,f=void 0===o?"":o,N=(0,v.useState)([]),x=(0,p.default)(N,2),k=x[0],A=x[1],D=(0,v.useState)(null),M=(0,p.default)(D,2),L=M[0],R=M[1],U=(0,v.useState)(""),V=(0,p.default)(U,2),j=V[0],B=V[1],Y=C.Form.useForm(),W=(0,p.default)(Y,1)[0],q=(0,v.useState)(""),z=(0,p.default)(q,2),K=z[0],H=z[1],Z=(0,v.useState)(!1),G=(0,p.default)(Z,2),X=G[0],J=G[1],Q=(0,v.useState)(null),$=(0,p.default)(Q,2),ee=$[0],te=$[1],ae=(0,v.useState)([]),ne=(0,p.default)(ae,2),re=ne[0],le=ne[1],ue=(0,v.useRef)(null),oe=function(){var e=(0,m.default)(s.default.mark((function e(){var a,n,r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,_.getPermForms)(t);case 3:a=e.sent,n=(a||{}).rows,A(void 0===n?[]:n),e.next=14;break;case 8:e.prev=8,e.t0=e.catch(0),r=e.t0.message,(0,S.showNotice)("error",r),A([]);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,m.default)(s.default.mark((function e(a){var n,r,l,u,o;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,E.getRoleList)(t);case 3:n=e.sent,r=(n||{}).rows,R(l=void 0===r?[]:r),l.length&&(a?B(a):(u=l[0].id,B(u))),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),o=e.t0.message,(0,S.showNotice)("error",o);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=(0,m.default)(s.default.mark((function e(t){var a,n,r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,E.getRoleDetail)(t);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:a=e.t0,n=a.rows,te((void 0===n?[]:n)[0]||null),e.next=18;break;case 13:e.prev=13,e.t1=e.catch(2),r=e.t1.message,(0,S.showNotice)("error",r);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=(0,m.default)(s.default.mark((function e(t,a){var n,r,l,u,o,i,d;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:[t]},e.prev=1,e.next=4,(0,E.saveRole)(n);case 4:r=e.sent,l=r.failCount,u=r.result,"0"===l&&((0,S.showNotice)("success",a||"新增角色成功"),i=null==u||null===(o=u[0])||void 0===o?void 0:o.id,ie(i)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),d=e.t0.message,(0,S.showNotice)("error",d);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}(),fe=function(){var e=(0,m.default)(s.default.mark((function e(a){var n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,O.publishClickUserEvent)({appId:t,formId:"",action:"sa_pm_copy"}),n=a.id,ce({id:n,copy:!0},"复制角色成功");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=(0,m.default)(s.default.mark((function e(a){var n,r,l;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={data:(0,i.default)(a).call(a,(function(e){return{id:e.id,appId:t}})),reorder:!0},e.prev=1,e.next=4,(0,E.saveRole)(n);case 4:r=e.sent,"0"===r.failCount&&(0,S.showNotice)("success","排序成功"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),l=e.t0.message,(0,S.showNotice)("error",l);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();(0,v.useEffect)((function(){oe(),ie()}),[]),(0,v.useEffect)((function(){de(j)}),[j]),(0,v.useEffect)((function(){!l&&(0,y.getAppInfoById)(t,r)}),[l,u]);var me=function(){var e=(0,m.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ue.current=t,J(!0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=(0,m.default)(s.default.mark((function e(t){var a,n,r,l,u,o;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,S.showLoadingMessage)("角色删除中，请稍候..."),n=t.id,r=j,j===n&&(r=F(n,L)),l=[{id:n}],e.prev=5,e.next=8,(0,E.deleteRole)(l);case 8:u=e.sent,"0"===u.failCount&&(a({type:"success",content:"删除成功"}),X&&J(!1),H(""),ie(r)),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(5),o=e.t0.message,a({type:"error",content:o});case 18:le([]);case 19:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=(0,m.default)(s.default.mark((function e(t){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ie(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return v.default.createElement("div",{className:T.default.wrapper},v.default.createElement(g.default,{activeRoleId:j,roleList:L,onAdd:function(){(0,O.publishClickUserEvent)({appId:t,formId:"",action:"sa_pm_cr"});var e={appId:t,name:"未命名角色",manage:!0,useType:P.USE_TYPE_ALL,users:[],orgs:[]};ce(e,"新增角色成功")},onDelete:me,onCopy:fe,onSort:se,setActiveRoleId:B}),L&&(ee?v.default.createElement(h.default,{key:null==ee?void 0:ee.id,formList:k,appId:t,creatorId:f,rolePermission:ee,setRolePermission:te,onAfterSave:ve}):null),v.default.createElement(I.ConfirmModal,{visible:X,type:"delete",disabledActions:re,title:'确定要删除角色"'.concat(null===(e=ue.current)||void 0===e?void 0:e.name,'"吗？'),content:v.default.createElement("div",{className:T.default.delete_content},v.default.createElement("div",{className:T.default.desc},"删除角色后，该角色授权的组织、人员权限将一并删除，不可恢复"),v.default.createElement(C.Form,{layout:"vertical",form:W,labelWidth:"100%",wrapperWidth:"100%",onValuesChange:function(e,t){}},v.default.createElement(C.Form.Item,{label:"请输入该角色名称",name:"name",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入角色名称"},{type:"string",validator:function(e,t,a,n,r){return null!=t&&(0,c.default)(t).call(t)?[]:[new Error("请输入角色名称")]}}]},v.default.createElement(C.Input,{type:"text",borderType:"bordered",size:"large",placeholder:"请输入",maxLength:50,value:K,onChange:function(e){return H(e.target.value)}})))),onAction:function(e){switch(e){case"ok":W.validateFields().then((function(e){var t;(0,d.default)(e),K===(null===(t=ue.current)||void 0===t?void 0:t.name)?(pe(ue.current),le(["ok","cancel"])):(0,S.showNotice)("error","名称输入错误，删除失败")})).catch((function(e){}));break;case"cancel":H(""),J(!1)}}}))}},87452:function(e,t,a){"use strict";e.exports=a.p+"ncp/nocode/images/141804a566a929dccb3e.png"},22796:function(e,t,a){e.exports=a(11576)},82568:function(e,t,a){"use strict";a(43400);var n=a(19832);e.exports=n.Reflect.has},43400:function(e,t,a){"use strict";a(33952)({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},11576:function(e,t,a){"use strict";var n=a(82568);e.exports=n}}]);