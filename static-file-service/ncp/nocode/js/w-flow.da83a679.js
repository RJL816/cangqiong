"use strict";(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[688],{13792:function(e,t,a){a.r(t),t.default={tag:"B0BB54zw_tag",success:"vNynaJ6y_success",error:"xV9OxNu3_error",warning:"rc2CssHi_warning",going:"IeZiZcJw_going",reject:"vZjZ7H70_reject"}},56124:function(e,t,a){a.r(t),t.default={header:"EKFI1FZG_header",header_main:"o69fZx-U_header_main"}},29436:function(e,t,a){a.r(t),t.default={"loading-wrapper":"eZ4cHM3T_loading-wrapper","nocode-designer-wrapper":"xeYy+Eyr_nocode-designer-wrapper"}},94088:function(e,t,a){a.r(t),t.default={drawer:"E2JRONYS_drawer",title:"Pbs3HJKx_title","title-desc":"gBxXL6nm_title-desc",add:"paclbU17_add",icon:"l6rsexmB_icon",drawer_content:"+t8iy6KC_drawer_content",drawer_footer:"KH4-AS7r_drawer_footer"}},62500:function(e,t,a){a.r(t),t.default={header_formname:"-l8F5Byn_header_formname",header_formname_input:"jZHRzDD-_header_formname_input",header_formname_editicon:"oSIYjYRW_header_formname_editicon"}},94958:function(e,t,a){a.r(t),t.default={header_nav:"GWucqz0j_header_nav",header_nav_container:"Ovudhbpp_header_nav_container",header_nav_menu:"q2r5C6zu_header_nav_menu",header_nav_menu_item:"i1eYlHah_header_nav_menu_item",header_nav_menu_item_divider:"_4rcXUi6A_header_nav_menu_item_divider"}},35796:function(e,t,a){a.r(t),t.default={designer_header:"_4DC7qUOQ_designer_header","ml-4":"sQTfxIjx_ml-4",leftnav:"_8jFJaegp_leftnav",leftnav_container:"Tlk052ri_leftnav_container",leftnav_container_name:"llNFgECc_leftnav_container_name",leftnav_container_input:"_4OSiyrYk_leftnav_container_input",leftnav_container_editicon:"KBQ4o41C_leftnav_container_editicon",mainnav:"_08sCtpNE_mainnav",selected:"MjxYJmkB_selected",rightnav:"GhAq-Vei_rightnav",btn_group:"A+gJV6aM_btn_group",lunch_btn:"bAGsurS3_lunch_btn",save_btn:"l0U7usep_save_btn",seperator:"GRrnLxSh_seperator",btn_dropdown:"dC6QpHry_btn_dropdown",isOpen:"Mv6713Cr_isOpen","rightnav-preview":"MrTjmbNw_rightnav-preview","rightnav-save":"me9enQtr_rightnav-save",designer_container:"Mspu39-2_designer_container",designer_container_notop:"_1HzAhyxR_designer_container_notop",dropdown_panel:"_35CMn2sU_dropdown_panel"}},97496:function(e,t,a){a.r(t),t.default={footer:"X7vri77E_footer",lunch_flow_modal:"cugvzC+9_lunch_flow_modal"}},38300:function(e,t,a){a.r(t),t.default={container:"RE6bQFL-_container",main:"wXVegECB_main",actions:"gr31fFN-_actions",buttons:"mZMIW3Ox_buttons",list:"IKFw8hsO_list"}},29596:function(e,t,a){a.r(t),t.default={loading_wrapper:"N7Q-77Dl_loading_wrapper",hidden:"ZvdR8I3o_hidden"}},66436:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;l(a(13939)),l(a(73980));var r=window.__kd_cdnPath__||window.__domainurl__,u={nocode:{url:"".concat(r+"ncp","/nocode-designer/nocodeRemoteEntry.js"),scope:"nocode_designer"},components:{url:"".concat(r+"ncp","/nocode-component/nocodeComponentEntry.js"),scope:"nocode_component"},base:{url:"".concat(r,"public/designer-base/designerBaseRemoteEntry.js"),scope:"designer_base"},nocodeflow:{url:"".concat(r+"ncp","/nocode-flow/nocodeFlowRemoteEntry.js"),scope:"nocode_flow"}};t.default=u},98688:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(78912)),u=l(a(99308)),o=l(a(52892)),i=a(65984),d=new u.default,f=new u.default,c=new o.default;t.default=function(e,t){var a=(0,i.useState)(!1),n=(0,r.default)(a,2),l=n[0],u=n[1],o=(0,i.useState)(!1),s=(0,r.default)(o,2),p=s[0],m=s[1];return(0,i.useEffect)((function(){if(e){if(f.has(e)||window[t])return u(!0),void m(!1);if(d.has(e))return c.has(e)||c.set(e,[]),void c.get(e).push([function(){u(!0)},function(){u(!1),m(!0)}]);d.add(e),u(!1),m(!1);var a=document.createElement("script");return a.src=e,a.type="text/javascript",a.async=!0,a.onload=function(){(f.add(e),u(!0),c.has(e))&&(c.get(e).forEach((function(e){return(0,(0,r.default)(e,1)[0])()})),c.delete(e))},document.head.appendChild(a),a.onerror=function(){(u(!1),m(!0),c.has(e))&&(c.get(e).forEach((function(e){var t=(0,r.default)(e,2);t[0];return(0,t[1])()})),c.delete(e))},function(){d.delete(e),c.delete(e),document.head.removeChild(a)}}}),[e]),{errorLoading:p,ready:l}}},56824:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.useFederatedModule=void 0;var r=l(a(52892)),u=l(a(760)),o=l(a(29052)),i=l(a(78912)),d=l(a(94924)),f=a(65984),c=l(a(98688)),s=l(a(66436));var p=new r.default;t.useFederatedModule=function(e){var t,n,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"./Main",r=s.default[e],m=r.url,_=r.scope,v=(0,u.default)(t=(0,u.default)(n="".concat(m,"-")).call(n,_,"-")).call(t,l),g=(0,f.useState)((function(){return p.get(v)||null})),h=(0,i.default)(g,2),y=h[0],b=h[1],E=(0,c.default)(m,_),w=E.ready,C=E.errorLoading,N=(0,f.useRef)(!1);return(0,f.useEffect)((function(){N.current?y&&b(null):N.current=!0}),[v]),(0,f.useEffect)((function(){w&&!y&&function(e,t){var n=s.default[e].scope;return(0,d.default)(o.default.mark((function e(){var l,r,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.I("default");case 3:return l=window[n],e.next=6,l.init(a.S.default);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:return e.next=13,window[n].get(t);case 13:return r=e.sent,u=r(),e.abrupt("return",u);case 16:case"end":return e.stop()}}),e,null,[[0,8]])})))}(e,l)().then((function(e){var t=e;p.set(v,t),b(t)}))}),[y,w,v]),{errorLoading:C,Component:y}}},63176:function(e,t,a){var n=a(13939),l=a(34716),r=a(70696),u=a(4884),o=a(3464),i=a(51400),d=a(25028),f=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var c=f(a(29052)),s=f(a(96631)),p=f(a(94924)),m=f(a(78912)),_=a(65984),v=(f(a(60584)),a(98464)),g=a(41936),h=a(90568);function y(e,t){var a=n(e);if(l){var o=l(e);t&&(o=r(o).call(o,(function(t){return u(e,t).enumerable}))),a.push.apply(a,o)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):o?i(e,o(a)):y(Object(a)).forEach((function(t){d(e,t,u(a,t))}))}return e}t.default=function(e){var t=e||{},a=t.appId,n=t.defaultQueryParams,l=t.queryCallback,r=(n||{}).pageSize,u=void 0===r?20:r,o=(0,g.useParams)().appId,i=a||o,d=(0,_.useState)(),f=(0,m.default)(d,2),s=f[0],y=f[1],E=function(){var e=(0,p.default)(c.default.mark((function e(t,a){var n,r;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b({env:"1",page_size:(null==a?void 0:a.page_size)||u||20,page_no:(null==a?void 0:a.page_no)||1},a),y(n),e.next=4,(0,v.loadFormDataList)(i,t,n);case 4:r=e.sent,null==l||l(),(0,h.publishEvent)("setQuery",{args:{formId:t,param:n},data:r});case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(){var e=(0,p.default)(c.default.mark((function e(t){var a;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,v.queryEntryData)(null==t?void 0:t.appId,null==t?void 0:t.formId,null==t?void 0:t.pkId,{page_size:(null==t?void 0:t.page_size)||10,page_no:(null==t?void 0:t.page_no)||1,entry:null==t?void 0:t.entry});case 3:a=e.sent,null==t||t.callback(a),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,p.default)(c.default.mark((function e(t,a){var n;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.getFormDataListSetting)(i,t,a.env,{selects:a.displayProp});case 2:n=e.sent,(0,h.publishEvent)("setListConfig",{args:{formId:t},data:n});case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return{batchInvokeQuery:E,addControlAction:h.addEventListener,baseUrl:window.__nocode_file_host__,batchInvoke:function(){},batchInvokeTable:w,batchInvokeListConfig:C,getControlText:function(e){return(null==e?void 0:e.zh_CN)||""},queryParams:s}}},43332:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(26048)),d=a(41936),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),c=a(34896);function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}t.default=(0,f.memo)((function(e){var t=e.children,a=e.to,n=(0,d.useLocation)().search,l=a;return l=(0,c.urlParamWithDebug)(l,n),f.default.createElement(d.Link,(0,i.default)({},e,{to:l}),t)}))},1160:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),d=a(82416),f=o(a(13792)),c=o(a(71252));function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}var p={willApproval:f.default.warning,approve:f.default.success,handled:f.default.sucess,done:f.default.success,terminate:f.default.reject,withdraw:f.default.reject,exception_terminate:f.default.error,willHandled:f.default.going,launch:f.default.going},m=(0,i.memo)((function(e){var t=e.status,a=e.text,n=e.className;return i.default.createElement(d.Tag,{className:(0,c.default)(p[t]||p.launch,n)},a)}));m.displayName="FlowStatusTag";t.default=m},1520:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(23992)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),f=o(a(71252)),c=o(a(56124));function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}var p=(0,d.memo)((function(e){var t=e.children,a=e.className;return d.default.createElement("div",{className:(0,f.default)(c.default.header,a)},null==t?void 0:(0,i.default)(t).call(t,(function(e,t){return d.default.cloneElement(e,{key:t})})))}));p.displayName="Header";var m=(0,d.memo)((function(e){var t=e.children,a=e.className;return d.default.createElement("div",{className:a},t)}));m.displayName="HeaderLeft";var _=(0,d.memo)((function(e){var t=e.children,a=e.className;return d.default.createElement("div",{className:(0,f.default)(c.default.header_main,a)},t)}));_.displayName="HeaderMain",p.Left=m,p.Main=_,p.Right=m;t.default=p},77296:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),f=a(25028),c=a(93252),s=a(9564);f(t,"__esModule",{value:!0}),t.default=void 0;var p=s(a(29052)),m=s(a(94924)),_=s(a(78912)),v=s(a(96631)),g=s(a(94728)),h=s(a(50524)),y=s(a(760)),b=s(a(70696)),E=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=D(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=f&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?f(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),w=s(a(71252)),C=a(56824),N=a(57288),I=a(57264),F=s(a(40436)),S=a(4440),k=a(16428),M=s(a(29436));function D(e){if("function"!=typeof c)return null;var t=new c,a=new c;return(D=function(e){return e?a:t})(e)}function O(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,v.default)(e,t,a[t])})):i?d(e,i(a)):O(Object(a)).forEach((function(t){f(e,t,o(a,t))}))}return e}var L=[{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"ZkkM8aSPDj",Index:1,Id:"ZkkM8aSPDj",Key:"nocodecreatorfield",Name:"创建人",FieldType:"NoCodeCreatorField"},{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"Adb5iWON2Y",Features:'{"_Type_":"Features","Copyable":false}',Id:"Adb5iWON2Y",Key:"nocodecreatedatefield",Name:"创建日期",FieldType:"NoCodeCreateDateField"},{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"d70tu1iLBS",Index:3,Id:"d70tu1iLBS",Key:"nocodemodifierfield",Name:"修改人",FieldType:"NoCodeModifierField"},{ParentId:"1807354269337556992",_Type_:"NoCodeSystemAp",FieldId:"S78gWsEw5e",Index:2,Features:'{"_Type_":"Features","Copyable":false}',Id:"S78gWsEw5e",Key:"nocodemodifydatefield",Name:"修改日期",FieldType:"NoCodeModifyDateField"}],x=[{_Type_:"NoCodeCreatorField",BillEntityId:"68bde9ca00000eac",BillEntityIdEx:"68bde9ca00000eac",Features:{_Type_:"Features",Ver:1,Copyable:!1},DataRange:{_Type_:"NoCodeDataRangeField",min:"0",max:"3"},PropsDisplay:"name,number,gender,phone,email",Id:"ZkkM8aSPDj",LableHyperlink:!1,FieldName:"f1807354271661201409",Key:"nocodecreatorfield",Name:"创建人"},{_Type_:"NoCodeCreateDateField",Features:{_Type_:"Features",Ver:1,Copyable:!1},Id:"Adb5iWON2Y",FieldName:"f1807354271662465026",Key:"nocodecreatedatefield",Name:"创建日期"},{_Type_:"NoCodeModifierField",BillEntityId:"68bde9ca00000eac",BillEntityIdEx:"68bde9ca00000eac",Features:{_Type_:"Features",Ver:1,Copyable:!1},DataRange:{_Type_:"NoCodeDataRangeField",min:"0",max:"3"},PropsDisplay:"name,number,gender,phone,email",Id:"d70tu1iLBS",LableHyperlink:!1,FieldName:"f1807354271661201410",Key:"nocodemodifierfield",Name:"修改人"},{_Type_:"NoCodeModifyDateField",Features:{_Type_:"Features",Ver:1,Copyable:!1},Id:"S78gWsEw5e",FieldName:"f1807354271662465027",Key:"nocodemodifydatefield",Name:"修改日期"}],A=["NoCodeCreatorField","NoCodeCreateDateField","NoCodeModifierField","NoCodeModifyDateField"],R=function(e,t){var a,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=e.formmeta,r=e.entitymeta,u=l.Items,o=r.Items,i=(0,g.default)(u).call(u,(function(e,t){var a=t.FieldType;return(0,h.default)(A).call(A,a)?(0,y.default)(e).call(e,a):e}),[]),d=n?(0,g.default)(L).call(L,(function(e,a){var n=a.FieldType;return(0,h.default)(i).call(i,n)?e:(0,y.default)(e).call(e,T(T({},a),{},{ParentId:t}))}),[]):[];e.formmeta=T(T({},l),{},{Items:(0,y.default)(a=(0,b.default)(u).call(u,(function(e){var t,a=e._Type_;return!(0,h.default)(t=["BizBtnFlexPanelAp","NoCodeBizButtonAp"]).call(t,a)}))).call(a,d)});var f=(0,g.default)(x).call(x,(function(e,t){var a=t._Type_;return(0,h.default)(i).call(i,a)?e:(0,y.default)(e).call(e,t)}),[]);return e.entitymeta=T(T({},r),{},{Items:(0,y.default)(o).call(o,f)}),e},j=(0,E.forwardRef)((function(e,t){var a=e.formId,n=e.appId,l=e.value,r=e.floatMenu,u=e.fieldStatusSettingMode,o=e.fieldStatusSettingOptions,i=e.needSystemField,d=(0,E.useState)(),f=(0,_.default)(d,2),c=f[0],s=f[1],g=(0,E.useState)(),h=(0,_.default)(g,2),y=h[0],b=h[1],D=(0,E.useState)([]),O=(0,_.default)(D,2),L=O[0],x=O[1],A=((0,C.useFederatedModule)("nocode").Component||{}).NoCodeDesigner,j=(0,F.default)().state.fileServer,P=j.imageUrl,B=void 0===P?"":P,H=j.attachmentUrl,z=void 0===H?"":H,W=(0,E.useRef)(),U=(0,E.useCallback)((function(e){(0,N.fetchData)("","nocode/getDomainModel.do",{modelType:e,targetFormId:a}).then((function(e){return s(e.data)}))}),[]),V=function(){var e=(0,m.default)(p.default.mark((function e(){var t,l,r,u,o,d;return p.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.getFormMetaData)({appId:n,targetFormId:a});case 3:l=e.sent,r=l.rows,o=(null===(t=(u=void 0===r?[]:r)[0])||void 0===t?void 0:t.metadata)||{},(0,k.unstable_batchedUpdates)((function(){var e;b(R(o,a,i)),x((null===(e=u[0])||void 0===e?void 0:e.tableMetas)||[])})),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),d=e.t0.message,(0,I.showNotice)("error",d);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),K=(0,E.useCallback)((function(e){W.current=T({},e)}),[]);(0,E.useEffect)((function(){U("NoCodeModel"),V()}),[]),(0,E.useImperativeHandle)(t,(function(){return{getDesignerRef:function(){return W.current}}}));var G=(0,w.default)((0,v.default)({},M.default["nocode-designer-wrapper"],!0));return c&&y&&A?E.default.createElement("div",{className:G},E.default.createElement(A,{meta:c,data:y,tableMetas:L,onApi:K,settingData:null,floatMenu:r,defaultFieldStatusMap:l,fieldStatusSettingMode:u,fieldStatusSettingOptions:o,baseUrl:{attachment:z,picture:B}})):null}));j.displayName="DesignerPermissionView";t.default=j},8992:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),d=a(63548),f=o(a(77296)),c=o(a(94088));function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}t.default=function(e){var t=e.formId,a=e.appId,n=e.visible,l=e.value,r=e.title,u=e.fieldPermissionMenu,o=e.fieldStatusSettingMode,s=void 0===o?"default":o,p=e.fieldStatusSettingOptions,m=e.needSystemField,_=e.setVisible,v=e.onChange,g=(0,i.useRef)(null);return i.default.createElement(d.Drawer,{mask:!0,maskStyle:{opacity:0},visible:n,onClose:function(){return _(!1)},getContainer:function(){return document.body},width:960,keyboard:!1,className:c.default.drawer,title:r,maskClosable:!0,destroyOnClose:!0},i.default.createElement("div",{className:c.default.drawer_content},i.default.createElement(f.default,{formId:t,appId:a,value:l,floatMenu:u,fieldStatusSettingMode:s,fieldStatusSettingOptions:p,ref:g,needSystemField:m}),i.default.createElement("div",{className:c.default.drawer_footer},i.default.createElement(d.Button,{onClick:function(){return _(!1)},style:{marginRight:"12px"}},"取消"),i.default.createElement(d.Button,{type:"primary",onClick:function(){var e=(g.current||{}).getDesignerRef,t=((null==e?void 0:e())||{}).fieldStatusMap;null==v||v(t,{getDesignerRef:e}),_(!1)}},"确定"))))}},76040:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(78912)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),f=a(63548),c=o(a(62500));function s(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(s=function(e){return e?a:t})(e)}var p="doubleClick";t.default=function(e){var t=e.formName,a=e.updateFormName,n=e.placeholder,l=void 0===n?"请输入表单名称":n,r=e.tips,u=void 0===r?"点击修改表单名称":r,o=e.doubleClickTips,s=void 0===o?"双击修改表单名称":o,m=e.defaultName,_=void 0===m?"未命名表单":m,v=(0,d.useRef)(null),g=(0,d.useState)(t===_),h=(0,i.default)(g,2),y=h[0],b=h[1],E=(0,d.useState)(t),w=(0,i.default)(E,2),C=w[0],N=w[1];(0,d.useEffect)((function(){N(t),b(t===_)}),[t]),(0,d.useEffect)((function(){v.current&&y&&v.current.select()}),[]),(0,d.useEffect)((function(){y!==p?y&&v.current.focus():v.current.select()}),[y]);var I=(0,d.useCallback)((function(e){a(e),F(e),N(e),b(!1)}),[]),F=function(e){document.title="配置：".concat(e)};return d.default.createElement("div",{className:c.default.header_formname},y?d.default.createElement(f.Input,{allowClear:!0,defaultValue:C,value:C,onChange:function(e){var t=e.target.value;N(t)},onBlur:function(e){var a=e.target.value;I(a||t||_)},onPressEnter:function(e){I(e||_)},maxLength:50,ref:v,className:c.default.header_formname_input,placeholder:l,borderType:"bordered"}):d.default.createElement(d.default.Fragment,null,d.default.createElement("p",{title:s,onDoubleClick:function(){b(p)}},C),d.default.createElement(f.Icon,{prefix:"nocodeplatformicon",title:u,className:c.default.header_formname_editicon,type:"bianji",onClick:function(){return b(!0)}})))}},48864:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(760)),d=o(a(23992)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),c=o(a(732)),s=a(41936),p=a(63548),m=a(39392),_=o(a(94958)),v=a(95936),g=a(57264);function h(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(h=function(e){return e?a:t})(e)}var y=(0,f.lazy)((function(){return a.e(0).then(a.t.bind(a,51e3,23))})),b="businessManage";t.default=function(e){var t=e.onItemClick,a=e.openNewPage,n=void 0===a||a,l=(0,m.useTranslation)().t,r=(0,c.default)(),u=(0,s.useParams)(),o=u.appId,h=u.targetFormId,E=(0,f.useContext)(v.Context).dispatch,w=(0,f.useCallback)((function(e){var t,a;return(0,i.default)(t=(0,i.default)(a="".concat(o||"","|")).call(a,h||"","|")).call(t,e)}),[o,h]),C=[{path:"/home",title:l("designer.key0004"),icon:"qiyeguanli",useActionName:"tb_h_bn"},{path:"/app",title:l("designer.key0005"),icon:"quanbuyingyong",key:"allApp",useActionName:"tb_as_bn"},{path:"/template",title:l("designer.key0006"),icon:"moban2",useActionName:"tb_ts_bn"},{path:"/flow",title:l("designer.key0008"),icon:"liucheng-xian",useActionName:"tb_fs_bn"},{type:"divider"},{title:l("designer.key0007"),icon:"jichushezhi",key:b,useActionName:"tb_em_bn"}],N=f.default.createElement(p.Dropdown.Menu,{className:_.default.header_nav_menu},(0,d.default)(C).call(C,(function(e,t){var a=e.title,n=(e.path,e.icon),l=e.type,r=e.useActionName;return"divider"===l?f.default.createElement("li",{key:t,className:_.default.header_nav_menu_item_divider}):f.default.createElement(p.Dropdown.Item,{key:t,className:_.default.header_nav_menu_item,"data-nc-action":w(r)},f.default.createElement(f.default.Fragment,null,f.default.createElement(p.Icon,{prefix:"nocodeplatformicon",type:n}),a))})));return f.default.createElement(f.default.Fragment,null,f.default.createElement(p.Dropdown,{placement:"topLeft",menu:N,onItemClick:function(e){if("function"==typeof t&&t(e))return;var a=C[e];if(a){var l=a.path;if(l)n?(0,g.openner)(l):r(l);else if(a.key===b){var u=(0,g.autoModalHeight)(520,768);p.Modal.confirm({title:"企业管理",showline:!0,titleIcon:null,footer:null,width:960,height:u,type:"normal",bodyStyle:{padding:0,display:"flex",overflow:"hidden",flexBasis:0},body:f.default.createElement(f.Suspense,{fallback:f.default.createElement(f.default.Fragment,null)}," ",f.default.createElement(y,{dispatch:E})," "),closable:!0,maskClosable:!1})}}}},f.default.createElement("div",{className:_.default.header_nav},f.default.createElement("div",{className:_.default.header_nav_container},f.default.createElement(p.Icon,{prefix:"nocodeplatformicon",type:"9gedian"})))))}},64360:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(96631)),d=o(a(78912)),f=o(a(50524)),c=o(a(38456)),s=o(a(760)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=S(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),m=a(41936),_=a(63548),v=a(88268),g=o(a(48864)),h=o(a(1520)),y=o(a(43332)),b=o(a(76040)),E=o(a(60584)),w=a(57264),C=a(95936),N=o(a(35796)),I=o(a(71252)),F=o(a(10100));function S(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(S=function(e){return e?a:t})(e)}var k=(0,p.memo)((function(){var e,t=(0,m.useParams)(),a=t.flowId,n=t.appId,l=t.origin,r=t.procInstId,u=function(e){var t=["cosmic"];return(0,f.default)(t).call(t,e)}(l),o=!!r,S=(0,p.useState)(Date.now()),k=(0,d.default)(S,2),M=k[0],D=k[1],O=(0,p.useState)(""),T=(0,d.default)(O,2),L=T[0],x=T[1],A=(0,p.useState)(!1),R=(0,d.default)(A,2),j=R[0],P=R[1],B=(0,p.useState)({}),H=(0,d.default)(B,2),z=H[0],W=H[1],U=(0,p.useState)(!1),V=(0,d.default)(U,2),K=V[0],G=V[1],Z=(0,p.useState)(!1),q=(0,d.default)(Z,2),Y=q[0],Q=q[1],J=(0,p.useState)(null),X=(0,d.default)(J,2),$=X[0],ee=X[1],te=(0,p.useState)(!1),ae=(0,d.default)(te,2),ne=ae[0],le=ae[1],re=(0,p.useRef)(!1),ue=(0,p.useContext)(C.Context).state.rootConfig,oe=(0,p.useMemo)((function(){var e;return(null===(e=z.nodes)||void 0===e?void 0:(0,c.default)(e).call(e,(function(e){return"StartSignalEvent"===e._Type_})))||{}}),[z]),ie=oe.formId,de=oe.triggerMode,fe=(0,p.useCallback)((function(e){var t;return(0,s.default)(t="".concat(n,"||")).call(t,e)}),[n]);(0,p.useEffect)((function(){document.title=L?"配置流程：".concat(L):"查看流程"}),[L]);var ce=function e(){var t=r||a,n=window.sessionStorage.getItem("nocode-flow-data-".concat(t));n&&(x(n||"未命名流程"),window.removeEventListener("storage",e,!1),window.localStorage.removeItem("nocode-flow-data-".concat(t)))};(0,p.useLayoutEffect)((function(){return ce(),window.addEventListener("storage",ce,!1),function(){window.removeEventListener("storage",ce,!1)}}),[]);var se=(0,p.useCallback)((function(e){D([Date.now(),"save",e].join())}),[]),pe=(0,p.useCallback)((function(){if(ne&&!Y){if(!(0,w.isCNLanguage)(ue))return(0,w.showNotice)("warnning",v.LANG_INVALID);G(!0),D([Date.now(),"save"].join())}}),[ne,Y,ue]),me=(0,p.useCallback)((function(){ne&&!K&&("time"!==de?ie?(re.current=!0,Q(!0),D([Date.now(),"save"].join())):(0,w.showNotice)("warnning","请选择触发表单"):(0,w.showConfirmModal)({type:"prompt",title:"确认立即触发此流程吗？",onAction:function(e){if("ok"===e)se("timer")}}))}),[ie,de,ne,K,se]),_e=(0,p.useCallback)((function(e){e!==L&&(x(e),E.default.emit(v.UPDATE_FLOWNAME,e))}),[L]),ve=(0,p.useCallback)((function(e,t){switch(e){case v.REFBILL_REFRESH_REF_LIST:t===ie&&ee(Date.now());break;case v.SHOW_LUNCH_FLOW_MODAL:re.current&&(P(!0),re.current=!1)}}),[ie]);return p.default.createElement(p.default.Fragment,null,!u&&p.default.createElement(h.default,{className:N.default.designer_header},p.default.createElement(h.default.Left,{className:N.default.leftnav},!o&&p.default.createElement(g.default,null),p.default.createElement("div",{className:N.default.leftnav_container},!o&&p.default.createElement(p.default.Fragment,null,"配置：",p.default.createElement("div",{className:N.default.leftnav_container_name},p.default.createElement(y.default,{to:(0,s.default)(e="/".concat(n,"/admin/flow/")).call(e,a),className:N.default.leftnav_container_name,"data-nc-action":fe("tb_crumb_fl")},"流程管理"))),L&&(o?p.default.createElement("p",null,L):p.default.createElement(p.default.Fragment,null,p.default.createElement(_.Icon,{prefix:"nocodeplatformicon",type:"fangxiangyou"}),p.default.createElement(b.default,{formName:L,updateFormName:_e,defaultName:"未命名流程",placeholder:"请输入流程名称",tips:"点击修改流程名称",doubleClickTips:"双击修改流程名称"}))))),p.default.createElement(h.default.Main,{className:N.default.mainnav}),p.default.createElement(h.default.Right,{className:N.default.rightnav},!o&&p.default.createElement("div",{className:N.default.btn_group},p.default.createElement(_.Button,{title:"点击执行流程",size:"small",className:N.default.lunch_btn,disabled:!ne,"data-nc-action":fe("tb_execute"),loading:Y,onClick:me},"立即执行"),p.default.createElement(_.Button,{title:"点击发布流程",size:"small",className:N.default.save_btn,disabled:!ne,"data-nc-action":fe("tb_publish"),type:"primary",loading:K,onClick:pe},"发布")))),p.default.createElement("div",{className:(0,I.default)(N.default.designer_container,(0,i.default)({},N.default.designer_container_notop,u))},p.default.createElement(m.Outlet,{context:{save:M,flowTitle:L,setFlowData:W,saveStatus:function(){G(!1),Q(!1)},listenerActionCallback:ve,isMountDesigner:ne,setIsMountDesigner:le,setFlowTitle:x}})),p.default.createElement(F.default,{visible:j,setVisible:P,onConfirm:se,formId:ie,appId:n,refresh:$}))}));k.displayName="FlowHeaderLayout";t.default=k},10100:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),f=a(25028),c=a(93252),s=a(9564);f(t,"__esModule",{value:!0}),t.default=void 0;var p=s(a(70696)),m=s(a(23992)),_=s(a(96631)),v=s(a(78912)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=D(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=f&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?f(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),h=a(63548),y=a(82416),b=a(89068),E=s(a(97496)),w=a(98464),C=a(16428),N=s(a(59480)),I=a(57264),F=s(a(63176)),S=s(a(60584)),k=a(88268),M=s(a(75020));function D(e){if("function"!=typeof c)return null;var t=new c,a=new c;return(D=function(e){return e?a:t})(e)}function O(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,_.default)(e,t,a[t])})):i?d(e,i(a)):O(Object(a)).forEach((function(t){f(e,t,o(a,t))}))}return e}var L=(0,g.memo)((function(e){var t=e.appId,a=e.visible,n=e.formId,l=e.showAddRecord,r=void 0===l||l,u=e.refresh,o=e.setVisible,i=e.onConfirm,d=(0,g.useState)([]),f=(0,v.default)(d,2),c=f[0],s=f[1],_=(0,g.useState)([]),D=(0,v.default)(_,2),O=D[0],L=D[1],x=(0,g.useState)([]),A=(0,v.default)(x,2),R=A[0],j=A[1],P=(0,g.useState)([]),B=(0,v.default)(P,2),H=B[0],z=B[1],W=(0,g.useState)(""),U=(0,v.default)(W,2),V=U[0],K=U[1],G=(0,g.useState)([]),Z=(0,v.default)(G,2),q=Z[0],Y=Z[1],Q=(0,g.useState)([]),J=(0,v.default)(Q,2),X=J[0],$=J[1],ee=(0,g.useState)({}),te=(0,v.default)(ee,2),ae=te[0],ne=te[1],le=(0,F.default)({appId:t}),re=(0,g.useRef)({page_no:1,page_size:10,filter:"",env:1,order_by:"",search:""}),ue=(0,g.useCallback)((function(e){var a=e.rows[0].listItemConfig,l=[],r=[];a.forEach((function(e){var a={align:"nocodedecimalfield"===e.type?"right":"",title:e.name,number:e.number,type:e.type};r.push({key:e.number,title:e.name}),e.display&&l.push({code:e.number,title:g.default.createElement(y.TableTitle,a),lock:e.locked,width:e.width||200,render:function(a,l,r){return g.default.createElement(b.CellRender,{value:a,type:e.type,readOnly:!0,record:l,rowIndex:r,oriAppId:t,oriFormId:n,id:l.id,fieldName:e.number,title:e.name})}})})),(0,C.unstable_batchedUpdates)((function(){L(l),j(r)}))}),[t,n]),oe=(0,g.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};re.current=T(T({},re.current),e),(0,w.getFormDataList)(t,n,T({},re.current)).then((function(e){s(e)})).catch((function(e){}))}),[t,n]),ie=(0,M.default)(oe),de=(0,g.useCallback)((function(e,a){var l=(0,p.default)(X).call(X,(function(e){return e.fieldName!==a}));e.forEach((function(e){"001"===e.compareType?!e.value.some((function(e){return"all"===e.type}))&&l.push(e):l.push(e)})),(0,C.unstable_batchedUpdates)((function(){$(l),ne((0,N.default)((function(e){e[a]&&(e[a].items=l)})))})),(0,w.sendColHeadFilter)({data:[{appid:t,formid:n,filterrows:l}]},1,a).then((function(e){oe({filter:e.extra.filters[0]})}))}),[t,n,X]),fe=(0,g.useCallback)((function(e,t,a,n){Y(e)}),[]),ce=(0,g.useCallback)((function(e){K(e),oe({search:e})}),[oe]),se=(0,g.useCallback)((function(e,a){var l={data:[{appId:t,formId:n,orderInfo:[{number:e,isAsc:1===a}]}]};(0,w.sendColHeadSort)(l,1).then((function(e){var t=e.extra.orderBy;oe({order_by:t})}))}),[oe,t,n]),pe=(0,g.useCallback)((function(e){var a=(0,m.default)(e).call(e,(function(e){return{compareType:e.compareType,fieldName:e.fieldName,value:e.value}}));$(e),(0,w.sendFormFilterSetting)({data:[{appid:t,formid:n,filterrows:a}]},1).then((function(e){oe({filter:e.extra.filters[0]})}))}),[t,n,oe]),me=(0,g.useCallback)((function(e,a){var l=e.fieldName;(0,w.getEnumFilterValue)(t,n,l,a,1).then((function(t){ne((0,N.default)((function(n){n[l]={configuredFilter:{items:a},fieldFilterConfig:e,groupInfo:t.rows}})))}))}),[t,n]),_e=(0,g.useCallback)((function(e,t){oe({page_no:e,page_size:t})}),[oe]),ve=(0,g.useCallback)((function(){if(null==q||!q[0])return(0,I.showNotice)("warnning","请选择要执行的数据");o(!1),i(q[0])}),[q,i]),ge=(0,g.useCallback)((function(e,a){(0,w.getColHeadFilter)({appId:t,formId:n,env:1,fieldName:e,params:{filterRows:a,filter:""}}).then((function(t){ne((0,N.default)((function(a){a[e]=t.rows[0]})))})).catch((function(e){}))}),[t,n]);(0,g.useEffect)((function(){a&&ie()}),[a,ie]),(0,g.useEffect)((function(){n&&t&&(ie(),(0,w.getFormDataListSetting)(t,n,1,{}).then((function(e){z(e.rows[0]),ue(e)})).catch((function(e){})))}),[n,t,u]);var he=(0,g.useMemo)((function(){return(0,I.autoModalHeight)(520,768)}),[document.body.offsetHeight]),ye={data:c,config:H,searchValue:V,tableSelectedKeys:q,colHeadFilter:ae,tableColumn:O,tableColumnData:R,primaryKey:"id",multiSelect:!1,tableFilterData:X,refBillProps:le,totalNode:r?g.default.createElement(y.BtnField,{type:"ghost",size:"small",onClick:function(){S.default.emit(k.ADD_NEW_RECORD,{formId:n})},icon:{prefix:"ncicon",type:"zengjia-yuan"}},"新增记录"):null,onSort:se,onFilterConfirm:de,onRowSelectChange:fe,onSearch:ce,onFilterChange:pe,onColHeadFilterVisibleChange:me,onPageChange:_e,onFilterShow:ge};return g.default.createElement(h.Modal,{title:"请选择",visible:a,width:1180,height:he,destroyOnClose:!0,maskClosable:!1,bodyStyle:{padding:"16px 24px",overflow:"hidden"},onCancel:function(){return o(!1)},className:E.default.lunch_flow_modal,body:g.default.createElement(y.DataGridLayout,ye),footer:g.default.createElement("div",{className:E.default.footer},g.default.createElement(y.BtnField,{size:"small",onClick:function(){return o(!1)}},"取消"),g.default.createElement(y.BtnField,{size:"small",type:"primary",onClick:ve},"确认"))})}));L.displayName="LunchFlowModalLayout";t.default=L},75160:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),f=a(25028),c=a(93252),s=a(9564);f(t,"__esModule",{value:!0}),t.default=void 0;var p=s(a(760)),m=s(a(13568)),_=s(a(96631)),v=s(a(78912)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=k(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=f&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?f(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),h=a(41936),y=a(57264),b=a(82416),E=a(6940),w=a(25960),C=s(a(40436)),N=s(a(54348)),I=s(a(1160)),F=s(a(732)),S=s(a(38300));function k(e){if("function"!=typeof c)return null;var t=new c,a=new c;return(k=function(e){return e?a:t})(e)}function M(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,_.default)(e,t,a[t])})):i?d(e,i(a)):M(Object(a)).forEach((function(t){f(e,t,o(a,t))}))}return e}var O=(0,g.memo)((function(){var e,t,a,n=(0,C.default)().state,l=((0,F.default)(),(0,h.useParams)()),r=l.appId,u=l.flowId,o=l.targetFormId,i=n.selectedFlow,d=(0,g.useState)({}),f=(0,v.default)(d,2),c=f[0],s=f[1],_=(0,g.useState)(!1),k=(0,v.default)(_,2),M=k[0],O=k[1],T=(0,g.useState)([]),L=(0,v.default)(T,2),x=L[0],A=L[1],R=(0,g.useState)(""),j=(0,v.default)(R,2),P=j[0],B=j[1],H=(0,g.useState)({page_no:1,page_size:20,processNumber:i.number}),z=(0,v.default)(H,2),W=z[0],U=z[1],V=(0,g.useMemo)((function(){return{page_no:W.page_no,page_size:W.page_size}}),[W]);(0,g.useEffect)((function(){U(D(D({},W),{},{page_no:1,processNumber:i.number}))}),[i.number]);var K=(0,p.default)(e="processNumber=".concat(W.processNumber,"&appId=")).call(e,r),G=(0,E.useGetHook)((0,p.default)(t="".concat(w.ADMIN_FLOW_LSIT_CONFIG,"?")).call(t,K),null).data,Z=(0,E.useGetHook)((0,p.default)(a="".concat(w.ADMIN_FLOW_LSIT_DATA,"?")).call(a,K),V),q=Z.data,Y=Z.refresh,Q=(0,g.useCallback)((function(e){var t,a;return(0,p.default)(t=(0,p.default)(a="".concat(r,"|")).call(a,o,"|")).call(t,e)}),[r,o]),J=(0,g.useCallback)((function(e,t,a){s({Status:"view",appId:r,pkId:t.businessKey,targetFormId:t.targetFormId,procInstId:t.procInstId,formId:"bos_nocode_bill",rootPageId:null==n?void 0:n.rootConfig.pageId}),B(t.procInstId),O(!0)}),[n.rootConfig]),X=(0,g.useCallback)((function(e){var t=e.rows[0].listItemConfig,a=[];t.forEach((function(e){var t=e.number,n=e.name,l=e.type;e.width;e.display&&a.push({code:e.number,lock:e.locked,width:200,title:g.default.createElement(b.TableTitle,{title:n,key:t,type:l,number:t,hideFilter:!0,hideSort:!0}),render:function(e,t,a){if("object"===(0,m.default)(e)&&null!=e&&e.isApprovalStatus){var n=e.handleState,l=e.handleStateDesc;return g.default.createElement(I.default,{status:n,text:l})}return g.default.createElement("span",{title:e},e)}})})),a.push({code:"operator",title:g.default.createElement(b.TableTitle,{title:"操作",key:"operator",type:"operator",number:"operator",hideFilter:!0,hideSort:!0}),lock:!0,width:100,render:function(e,t,a){return g.default.createElement(b.BtnField,{major:!0,type:"text","data-nc-action":Q("sa_fg_detail"),onClick:function(){return J(e,t,a)},text:"详情"})}}),A(a)}),[Q]);(0,g.useEffect)((function(){G&&X(G)}),[G]);var $=(0,g.useCallback)((function(){var e;if(window.isIE){(0,y.showConfirm)("该功能暂不支持IE浏览器，\n请尝试使用其他浏览器（推荐Chrome）。","",4)}else(0,y.openner)((0,p.default)(e="/".concat(r,"/flow/")).call(e,u))}),[r,u]);return g.default.createElement(g.default.Fragment,null,g.default.createElement("div",{className:S.default.container},g.default.createElement("div",{className:S.default.main},g.default.createElement("div",{className:S.default.actions},g.default.createElement("div",{className:S.default.buttons},g.default.createElement(b.BtnField,{title:"点击配置当前选中的流程",type:"primary","data-nc-action":Q("sa_fg_set"),onClick:$},"配置流程"))),g.default.createElement("div",{className:S.default.list},g.default.createElement(b.DataGridLayout,{totalNode:g.default.createElement(g.default.Fragment,null),rowSelection:!1,style:{width:"100%"},tableColumn:x,data:q,searchNode:g.default.createElement("span",null),buttonNode:g.default.createElement("span",null),onPageChange:function(e,t){return U(D(D({},W),{},{page_no:e,page_size:t}))}})))),M&&g.default.createElement(N.default,{visible:M,close:function(){return O(!1)},billList:[],flowId:P,config:c,onRefresh:Y,detailShareReqireLogin:!0,detailShareNotReqireLogin:!0}))}));O.displayName="AdminFlowPage";t.default=O},47008:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(96631)),d=o(a(78912)),f=o(a(26048)),c=o(a(760)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?r(l,i,d):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),p=a(41936),m=o(a(87168)),_=a(63548),v=a(88268),g=o(a(60584)),h=o(a(71252)),y=o(a(40436)),b=o(a(8992)),E=o(a(29596)),w=a(95936);function C(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(C=function(e){return e?a:t})(e)}var N=(0,s.memo)((function(e){var t,a,n=(0,p.useParams)(),l=n.flowId,r=(n.procdefineId,n.procInstId),u=n.pkId,o=(0,y.default)().state;if(null==o||null===(t=o.rootConfig)||void 0===t||!t.pageId)return null;var i=u?(0,c.default)(a="".concat(r,"-")).call(a,u):l,d=u?"view":"";return s.default.createElement(s.Suspense,{fallback:s.default.createElement("div",null)},s.default.createElement(m.default,(0,f.default)({config:{formId:"bos_nocode_wfdesign",targetFormId:i,Status:d,rootPageId:o.rootConfig.pageId}},e)))})),I=(0,s.memo)((function(){var e=(0,p.useOutletContext)(),t=(0,p.useParams)().appId,a=e.save,n=(e.flowTitle,e.setFlowData),l=e.saveStatus,r=e.listenerActionCallback,u=e.isMountDesigner,o=e.setIsMountDesigner,c=e.setFlowTitle,m=(0,s.useState)({appId:t}),y=(0,d.default)(m,2),C=y[0],I=y[1],F=(0,s.useState)(!1),S=(0,d.default)(F,2),k=S[0],M=S[1],D=(0,s.useContext)(w.Context).state,O=(0,s.useState)(),T=(0,d.default)(O,2),L=T[0],x=T[1],A=function(e){I(e),M(!0)};(0,s.useEffect)((function(){if(L){var e=L.addEventListener(v.DESIGNER_MOUNT,R),t=L.addEventListener(v.NOCODE_FLOW_DATA,n),a=L.addEventListener("showFieldPermission",A),l=function(e){null==L||L.publishEvent(v.NOCODE_DESIGNER_UPDATE,{type:v.UPDATE_FLOWNAME,payload:e})};g.default.on(v.UPDATE_FLOWNAME,l);var u=function(e){null==L||L.publishEvent(v.ADD_NEW_RECORD,e)};g.default.on(v.ADD_NEW_RECORD,u);var o=L.addEventListener(v.REFBILL_REFRESH_REF_LIST,(function(e){return r(v.REFBILL_REFRESH_REF_LIST,e)})),i=L.addEventListener(v.SEND_MESSAGE_TO_PLATFORM,(function(e){return r(e.type,e)})),d=L.addEventListener(v.UPDATE_NOCODE_FLOW_NAME,(function(e){return c(e)}));return function(){null==e||e(),null==t||t(),null==a||a(),null==o||o(),null==i||i(),null==d||d(),g.default.off(v.UPDATE_FLOWNAME,l),g.default.off(v.ADD_NEW_RECORD,u)}}}),[L,r]),(0,s.useEffect)((function(){a&&(null==L||L.publishEvent(v.NOCODE_FLOW_SAVE,a))}),[a]),(0,s.useEffect)((function(){L&&L.publishEvent(v.NOCODE_DESIGNER_SAVE_API,{saveStatus:l},!0)}),[l,L]),(0,s.useEffect)((function(){(null==D?void 0:D.compareTypes)&&(null==L||L.publishEvent(v.SET_COMPARE_TYPES,null==D?void 0:D.compareTypes,!0))}),[null==D?void 0:D.compareTypes,L]);var R=(0,s.useCallback)((function(){null==o||o(!0)}),[]);return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:(0,h.default)((0,i.default)({},E.default.hidden,!u))},s.default.createElement(N,(0,f.default)({onRef:x,options:{rootConfig:D.rootConfig}},e))),s.default.createElement("div",{className:(0,h.default)([E.default.loading_wrapper,(0,i.default)({},E.default.hidden,u)])},s.default.createElement(_.Spin,{name:"Spin"})),s.default.createElement(b.default,(0,f.default)({title:"录入内容",visible:k,setVisible:M,needSystemField:!1},C)))}));I.displayName="FlowDesigner";t.default=I}}]);