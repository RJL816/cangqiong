"use strict";(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[16],{83968:function(e,t,a){a.r(t),t.default={create_app_body:"LFBvFp4v_create_app_body",item:"qHz08nSc_item",red:"PaNhx5ey_red",edit_avatar:"tR8zBJkw_edit_avatar",avatar:"PqRRypwX_avatar",edit:"zkdtwKjZ_edit"}},41472:function(e,t,a){a.r(t),t.default={edit_avatar:"hMv-Mxl6_edit_avatar",avatar:"n4FmMikB_avatar",edit:"lZfT9sX9_edit"}},69892:function(e,t,a){a.r(t),t.default={wrapper:"A-x2qx-v_wrapper",desc:"tGNwtg-4_desc",upload:"qcVX43-T_upload","upload-handler":"hPbgQoyX_upload-handler",layer:"gg6Oc2ui_layer",show:"tfJbYtf5_show","add-icon":"mQtbKtC5_add-icon","btn-text":"KvsnEvFV_btn-text","image-cropper":"jcbgxXWx_image-cropper"}},89440:function(e,t,a){a.r(t),t.default={"app-preview":"_7vn6o+Dz_app-preview",preview_footer:"zzIcWQQQ_preview_footer",tips:"WVDyo4uO_tips"}},85320:function(e,t,a){a.r(t),t.default={"template-detail":"VoO4mPdW_template-detail",appPreview:"IZJpqe3b_appPreview","preview-mode":"-yoYbS1y_preview-mode","iframe-area":"_28ap+YZg_iframe-area",layer:"BvwRKJBV_layer",preview_footer:"OczO7cKe_preview_footer",tips:"HMgpcart_tips","spin-wrapper":"_17lT4ODu_spin-wrapper",show:"u5vP9JvW_show","preview-btn":"lADi6fxs_preview-btn",wrapper:"vE5qf2Mj_wrapper",main:"_2TPgcrUm_main","main-left":"PMUfJmpP_main-left","main-right":"X0QSQb3x_main-right",block:"JtTMQhCv_block",title:"_8sPXvmNv_title",desc:"Lzmyuj6Y_desc",collapse:"CfK1Pn7-_collapse","left-top":"OxiTIsQH_left-top","app-icon":"brLphXiK_app-icon",detail:"DRbig3Nc_detail","name-area":"Row5q+ot_name-area",name:"ohm3UPJZ_name",btns:"qrKPuGfq_btns","use-info":"bxp56Wbn_use-info",rate:"AWBeKMTT_rate",score:"n6J2187H_score",count:"P7MLQQhn_count","tag-wrapper":"YiWlKBK3_tag-wrapper",tag:"kyQdEIJ+_tag","role-list":"PHZclOrx_role-list","role-item":"Uqt8LnZf_role-item","role-pre":"GZ5DHoj0_role-pre","role-name":"UHWcj2By_role-name","form-list":"RsGqcyvE_form-list","form-item":"_368rK2ob_form-item","form-icon":"q95Tgono_form-icon","form-name":"lgQRqHuG_form-name","info-item":"_1oWlFpPl_info-item","info-title":"qNr9Zvjg_info-title","info-content":"y9LdhYwW_info-content","comment-list":"RifjlRqk_comment-list","load-more":"BWSIF9Za_load-more","no-more":"yumPt9yr_no-more","no-comments":"c66gCY4g_no-comments","comment-item":"O0Xe5e+a_comment-item",avatar:"fUUxqUww_avatar","comment-detail":"ey5h8Uib_comment-detail",create:"eX61+fwK_create","create-name":"WcV45Zeh_create-name","create-date":"F1860G6L_create-date","score-detail":"_5TNbAKnB_score-detail","comment-content":"uIritY7E_comment-content"}},69208:function(e,t,a){a.r(t),t.default={app_templates:"lI9F9CJA_app_templates",card:"EyU1v+JZ_card",template_item:"gS05dWWn_template_item",more:"_8NhEq77C_more","pop-active":"E2WnsalD_pop-active",template_btns:"fQa0Qc9H_template_btns",template_creator:"WErV5ovr_template_creator",template_domains:"rUG4FbMN_template_domains",tag:"vkovVlXu_tag",canHover:"EQV4Bx-N_canHover",template_item_detail:"p029KDgt_template_item_detail",template_item_info:"d9zWmq8i_template_item_info",template_item_name:"vxMK+dRg_template_item_name",template_item_desc:"_9I5S+cf-_template_item_desc",template_item_imagewrapper:"mr3W1blI_template_item_imagewrapper",template_item_footer:"VE+aQ1J5_template_item_footer",banner:"lQ-bZOas_banner","banner-item":"-OC04795_banner-item","left-area":"k+Dx6Lmo_left-area",title:"bhGp8lqf_title",desc:"mP1E0MkO_desc","go-detail":"vUCn+9Nw_go-detail","right-area":"Pqh7X97c_right-area","bg-image":"iwOxxXZF_bg-image","linear-bg":"iexq2soc_linear-bg",popper:"MAerB7wo_popper"}},7436:function(e,t,a){a.r(t),t.default={"template-detail":"grZdes5Z_template-detail",wrapper:"jJBYTDm9_wrapper","preview-area":"faE9nT2n_preview-area",bill:"_2M-I8xNN_bill","bill-main":"s65MIoJm_bill-main","prev-btn":"TaTyWyjU_prev-btn","next-btn":"_81wsb4XO_next-btn","preview-footer":"Aelf3bzc_preview-footer",tips:"DOPBkO-b_tips",btns:"IsFcoyUK_btns",main:"_8Y5JCsDQ_main","template-info":"_972UXbGe_template-info","form-icon":"CwewQvEc_form-icon","info-right":"V4-0t2Pp_info-right",name:"KwT-buO5_name","use-info":"uM7QyKQZ_use-info",rate:"hTIFyTc3_rate",score:"z2IFtwD6_score",count:"z4fvPKDH_count","tag-wrapper":"_1jukznq6_tag-wrapper",tag:"RfR56l6N_tag",block:"CtVUc+fD_block",title:"+k7KZc7o_title",desc:"nwudby1P_desc","info-item":"PBfSp4Sl_info-item","info-title":"Wi-kGURO_info-title","info-content":"nojCKQ2P_info-content","comment-list":"dN9g3jBY_comment-list","load-more":"zjk74YLG_load-more","no-more":"pkmLRXbI_no-more","no-comments":"MgfoPzLa_no-comments","comment-item":"KwztahrR_comment-item",avatar:"if8YFSGk_avatar","comment-detail":"HdGBXwCK_comment-detail",create:"z0jhz+v8_create","create-name":"PLNOrbaT_create-name","create-date":"sF2j2EuK_create-date","score-detail":"puCmKHlK_score-detail","comment-content":"sa6FgOBP_comment-content"}},89188:function(e,t,a){a.r(t),t.default={bill_templates:"U4Z1pXOF_bill_templates",template_item:"C5munfN0_template_item",template_item_name:"bTxBYF6D_template_item_name",more:"tejjKvBC_more","pop-active":"_46K1AMOT_pop-active",template_btns:"q+OAFSgo_template_btns",template_creator:"wvixSXCT_template_creator",template_item_preview:"cgqC5zCs_template_item_preview",template_item_imagewrapper:"-sdESNWi_template_item_imagewrapper",template_item_info:"oBLJM+QL_template_item_info",creator_name:"uJKWxYlO_creator_name",popper:"j19bwX74_popper"}},25452:function(e,t,a){a.r(t),t.default={"create-app-modal":"TRunv9xH_create-app-modal","create-app-modal-body":"l+orzU5v_create-app-modal-body","create-app-modal-form-item-checkbox":"QTylZms-_create-app-modal-form-item-checkbox","create-app-modal-footer":"zEaQfPuj_create-app-modal-footer","footer-checkbox":"QLY90lLI_footer-checkbox"}},84212:function(e,t,a){a.r(t),t.default={template_filter:"XP58APYg_template_filter",tab:"icIRykOp_tab",tab_item:"wD8Krs1z_tab_item","is-active":"jopsY8JE_is-active",searcher:"IZa7p9m0_searcher",search_select:"LwKistEu_search_select",search_box:"_7+tf8aPT_search_box",filter_wrapper:"_3hQZoJAr_filter_wrapper",main:"VM207gCG_main",content:"_71Q2ac6R_content","select-app-popper":"_1Qh-jel0_select-app-popper"}},97072:function(e,t,a){a.r(t),t.default={template_empty:"GyY6vKX1_template_empty",template_empty_text:"l9C8g9lQ_template_empty_text"}},37120:function(e,t,a){a.r(t),t.default={"save-app-template-modal":"GxOdXOx2_save-app-template-modal","save-app-template-modal-form-item-checkbox":"MyPjMGqm_save-app-template-modal-form-item-checkbox","save-app-template-modal-footer":"+KWW9xiZ_save-app-template-modal-footer","save-app-template-modal-body":"ovjyezdb_save-app-template-modal-body","switch-image":"N2qCa2BV_switch-image","save-app-template-upload-wrapper":"WTlPONz1_save-app-template-upload-wrapper","save-app-template-upload-desc":"G0gpHJ6g_save-app-template-upload-desc","footer-checkbox":"FV2hitRk_footer-checkbox","save-app-template-navigate":"wKgKs0h0_save-app-template-navigate","nav-item":"rdXzO0rL_nav-item","save-app-template-form":"uqStkJxU_save-app-template-form","save-app-template-preview":"XraGAU7h_save-app-template-preview","preview-desc":"HsvlSEZ3_preview-desc","checkbox-group":"puY-DBIz_checkbox-group",checkbox:"k6KWbOr4_checkbox","anchor-locator":"wITfWgs2_anchor-locator"}},70032:function(e,t,a){a.r(t),t.default={"select-app-modal":"wpv9EboF_select-app-modal",main:"_9uoI6xwI_main","loading-wrapper":"Bf1LbM7T_loading-wrapper",apps:"Q-eTLAXa_apps",app_item:"iTrjCsBn_app_item",template_btns:"dYXU2irn_template_btns",template_creator:"oI3hMM+r_template_creator",app_item_detail:"+hw5UB1r_app_item_detail",app_item_info:"FnDHRjHq_app_item_info",app_item_name:"IAhLqyC5_app_item_name",app_item_desc:"fVa7Nx8F_app_item_desc",app_item_icon:"PUEePYqN_app_item_icon",empty:"ohikhKrk_empty",loadMore:"u2iRIQfk_loadMore"}},32710:function(e,t,a){a.r(t),t.default={filter:"uR8NMKSw_filter",filter_title:"d4AYdrYA_filter_title",filter_options:"IiFQ1vfw_filter_options",filter_options_item:"Ecc2bY6Y_filter_options_item","is-active":"t4J5wO0G_is-active"}},5470:function(e,t,a){a.r(t),t.default={"app-template-card":"jnAKdBeZ_app-template-card",banner:"FKY4GCCF_banner","banner-image":"DTcOm-dv_banner-image","banner-bg":"_78ViwkU+_banner-bg",hot:"Ad51IqHF_hot",new:"PCFrUmES_new",title:"rwnzKRFX_title",desc:"UzxG1BY6_desc","tag-wrapper":"xsdtmQ2A_tag-wrapper",footer:"midFCdUe_footer","footer-left":"o6VSSVkz_footer-left","footer-right":"s4UxZJmG_footer-right",tag:"_0Q+uB7h+_tag",hidden:"qBQu1w5g_hidden","bill-template-card":"e8GhkV3e_bill-template-card",main:"Q16PJNxh_main","main-right":"Q04y9-+J_main-right","form-icon":"yoD9J4Ik_form-icon"}},55956:function(e,t,a){a.r(t),t.default={template:"XL92k+8X_template",template_main:"_0Ah9AtH3_template_main",hidden:"PPWvWtXk_hidden",skeleton:"xNP-xwje_skeleton"}},96672:function(e,t,a){a.r(t),t.default={"export-setting-modal":"UQv4jp+2_export-setting-modal","export-setting-modal-footer":"h--U+50k_export-setting-modal-footer","footer-checkbox":"udSu7e9E_footer-checkbox",app:"_59EJfa1c_app",app_detail:"Bh1f6QVI_app_detail",app_info:"_9GJqA6BQ_app_info",app_name:"AlRA+N3Y_app_name",app_desc:"MAgbTwCs_app_desc",app_icon:"gnr3uhqX_app_icon"}},34796:function(e,t,a){a.r(t),t.default={pop:"-zvfG8Wu_pop",avatar:"vC2nJF0S_avatar"}},62840:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.commentTemplate=function(e){return i.apply(this,arguments)},t.getTemplateComments=function(e,t){return c.apply(this,arguments)},t.getTemplateScore=function(e,t){return d.apply(this,arguments)};var r=l(a(29052)),u=l(a(94924)),o=a(50460);function i(){return(i=(0,u.default)(r.default.mark((function e(t){var a,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:[t]},"nocode/v2/nocode_sys/common/template/comment",e.next=4,(0,o.post)("nocode/v2/nocode_sys/common/template/comment",a);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=(0,u.default)(r.default.mark((function e(t,a){var n,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="nocode/v2/nocode_sys/common/template/comment/".concat(t),e.next=3,(0,o.get)(n,a);case 3:return l=e.sent,e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=(0,u.default)(r.default.mark((function e(t,a){var n,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="nocode/v2/nocode_sys/common/template/view/".concat(t),e.next=3,(0,o.get)(n,a);case 3:return l=e.sent,e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},95876:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(90896)),u=l(a(67584)),o=l(a(78912)),i=l(a(94707)),c=l(a(14996)),d=a(65984),f=function(){function e(t){var a=this;(0,i.default)(this,e),this.initTime=5,this.isOK=!1,this.timeOut=50,this.num=0,this.half=0,this.count=0,this.begin=function(){a.num=(0,r.default)(a.initTime*Math.random()+"")+a.initTime,a.half=a.num/2,a.count=0,a.isOK=!1,a._setSchedule(0),a._setLoading(!0),a.circulationSubCount()},this.over=function(){a.isOK=!0,a._setSchedule(100),(0,u.default)((function(){a._setLoading(!1)}),200)},this.initTime=(null==t?void 0:t.initTime)||this.initTime,this.timeOut=(null==t?void 0:t.timeOut)||this.timeOut,this._setLoading=function(e){var a;null==t||null===(a=t.setLoading)||void 0===a||a.call(t,e)},this._setSchedule=function(e){var a;null==t||null===(a=t.setSchedule)||void 0===a||a.call(t,e)}}return(0,c.default)(e,[{key:"_setLoading",value:function(e){}},{key:"_setSchedule",value:function(e){}},{key:"computedSpeed",value:function(){this.count>=this.half&&(this.timeOut=2*this.timeOut,this.half+=this.half/2)}},{key:"circulationSubCount",value:function(){var e=this;(0,u.default)((function(){e.isOK||(e.computedSpeed(),e.count+=.1,e.count>=e.num?e._setSchedule(99):e._setSchedule(e.count/e.num*100),e.circulationSubCount())}),this.timeOut)}}]),e}();t.default=function(e){var t=e||{},a=t.beginCallBack,n=t.overCallBack,l=t.timeOut,u=void 0===l?50:l,i=(0,d.useState)(0),c=(0,o.default)(i,2),s=c[0],m=c[1],p=(0,d.useState)(!1),v=(0,o.default)(p,2),g=v[0],_=v[1],h=(0,d.useRef)({});return(0,d.useEffect)((function(){h.current=new f({setSchedule:m,setLoading:_,timeOut:u})}),[]),{begin:function(){var e,t;null==a||a(),null===(e=h.current)||void 0===e||null===(t=e.begin)||void 0===t||t.call(e)},over:function(){var e,t;null===(e=h.current)||void 0===e||null===(t=e.over)||void 0===t||t.call(e),null==n||n()},loading:g,setLoading:_,schedule:(0,r.default)(s+"")}}},98712:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(25288)),p=s(a(96631)),v=s(a(78912)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=x(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),_=a(63548),h=a(82416),b=s(a(83968)),E=s(a(34780)),w=a(16428),y=s(a(85744));function x(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(x=function(e){return e?a:t})(e)}function N(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):i?c(e,i(a)):N(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}t.default=g.default.memo((function(e){var t=e.data,a=e.update,n=e.onApi,l=e.showCreater,r=e.hideTransformBtn,u=(0,g.useState)(""),o=(0,v.default)(u,2),i=o[0],c=o[1],d=(0,g.useState)(""),f=(0,v.default)(d,2),s=f[0],x=f[1],N=(0,g.useState)(!1),k=(0,v.default)(N,2),T=k[0],I=k[1],M=(0,g.useRef)(t||{});(0,g.useEffect)((function(){M.current=t,(0,w.unstable_batchedUpdates)((function(){c((null==t?void 0:t.name)||""),x((null==t?void 0:t.description)||"")}))}),[t]);var S=(0,g.useCallback)((function(e,t){M.current=C(C({},M.current),{},(0,p.default)({},e,t||"")),a(M.current)}),[a]),F=(0,g.useCallback)((function(e){e&&(0,m.default)(e).call(e)?I(!1):I(!0)}),[]),O=(0,g.useCallback)((function(e,t,a){a&&F(t),M.current[e]!==t&&S(e,(0,m.default)(t).call(t))}),[F]),P=(0,g.useCallback)((function(e){M.current.image!==e&&S("image",e)}),[S]),R=(0,g.useCallback)((function(e){var t,n;null!=e&&e.length&&(null===(t=e[0])||void 0===t?void 0:t.id)!==(null===(n=M.current)||void 0===n||null===(n=n.creater)||void 0===n?void 0:n.id)&&a(C(C({},M.current),{},{creater:e[0]}),"creater")}),[a]);return(0,g.useEffect)((function(){n&&n({setError:I})}),[]),g.default.createElement(g.default.Fragment,null,g.default.createElement("div",{className:b.default.create_app_body},g.default.createElement("div",{className:b.default.item,style:{height:88,marginBottom:0}},g.default.createElement("div",{title:"应用的名称"},g.default.createElement("span",null,"名称"),g.default.createElement("span",{className:b.default.red},"*")),g.default.createElement(h.Text,{value:i,onBlur:function(){return O("name",i,!0)},onChange:c,borderType:"bordered",placeholder:"请输入应用名称",maxLength:50}),T&&g.default.createElement("div",{className:b.default.red},"请输入应用名称")),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",{title:"应用的图标"},g.default.createElement("span",null,"图标"),g.default.createElement("span",{className:b.default.red},"*")),g.default.createElement("div",{className:b.default.edit_avatar},g.default.createElement(E.default,{onChange:P,svgStr:null==t?void 0:t.image,triggerClassName:b.default.avatar},g.default.createElement("div",{className:b.default.edit},g.default.createElement(_.Icon,{prefix:"nocodeplatformicon",type:"bianji"}))))),l&&g.default.createElement("div",{className:b.default.item},g.default.createElement("div",{title:"更换"},g.default.createElement("span",null,"移交创建人")),g.default.createElement("div",null,g.default.createElement(y.default,{value:[null==t?void 0:t.creater]||0,isMulti:!1,onChange:R,withScope:!1,buttonOption:{text:"移交",icon:"qiehuan",hide:r}}))),g.default.createElement("div",{className:b.default.item},g.default.createElement("div",{title:"应用的说明"},"说明"),g.default.createElement(h.Textarea,{showCount:!0,value:s,countPosition:"inner",onChange:function(e){return x(e)},onBlur:function(){return O("description",s,!1)},autoSize:{minRows:3,maxRows:3},maxLength:255,borderType:"bordered",placeholder:"请输入应用说明"}))))}))},74428:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(73980),s=a(13440),m=a(59992),p=a(60600),v=a(93252),g=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0,t.mergeProps=S,t.withNativeProps=F,t.withStopPropagation=P;var _=g(a(11908)),h=g(a(13440)),b=g(a(73980)),E=g(a(78912)),w=g(a(96631)),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),x=g(a(71252)),N=a(60644);function C(e){if("function"!=typeof v)return null;var t=new v,a=new v;return(C=function(e){return e?a:t})(e)}function k(e,t){var a=void 0!==m&&p(e)||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){var a;if(!e)return;if("string"==typeof e)return T(e,t);var n=f(a=Object.prototype.toString.call(e)).call(a,8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return s(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,u=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return u=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){o=!0,r=e})),f:function(){try{u||null==a.return||a.return()}finally{if(o)throw r}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function I(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,w.default)(e,t,a[t])})):i?c(e,i(a)):I(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}function S(){function e(e,t){return void 0===t?e:t}for(var t=M({},arguments.length<=0?void 0:arguments[0]),a=1;a<arguments.length;a++)t=(0,N.assignWith)(t,a<0||arguments.length<=a?void 0:arguments[a],e);return t}function F(e,t){var a=M({},t.props);for(var n in e.className&&(a.className=(0,x.default)(t.props.className,e.className)),e.style&&(a.style=M(M({},a.style),e.style)),void 0!==e.tabIndex&&(a.tabIndex=e.tabIndex),e)e.hasOwnProperty(n)&&((0,_.default)(n).call(n,"data-")||(0,_.default)(n).call(n,"aria-"))&&(a[n]=e[n]);return y.default.cloneElement(t,a)}var O={click:"onClick"};function P(e,t){var a,n=M({},t.props),l=k(e);try{var r=function(){var e=a.value,l=O[e];n[l]=function(e){var a,n;e.stopPropagation(),null===(a=(n=t.props)[l])||void 0===a||a.call(n,e)}};for(l.s();!(a=l.n()).done;)r()}catch(e){l.e(e)}finally{l.f()}return y.default.cloneElement(t,n)}function R(e,t){var a=function(e){var t=(0,y.useRef)(e);t.current=(0,y.useMemo)((function(){return e}),[e]);var a=(0,y.useRef)();return a.current||(a.current=function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return t.current.apply(this,a)}),a.current}(e);(0,y.useLayoutEffect)((function(){var e=t.current;if(e){if(window.ResizeObserver){var n,l=new ResizeObserver((function(){n=window.requestAnimationFrame((function(){return a(e)}))}));return l.observe(e),function(){window.cancelAnimationFrame(n),l.disconnect()}}a(e)}}),[t])}var j={direction:"end",rows:1,expandText:"",content:"",collapseText:"",stopPropagationForActionButtons:[],onContentClick:function(){}};function A(e){if(!e)return 0;var t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0}t.default=function(e){var t=S(j,e),a=(0,y.useRef)(null),n=(0,y.useState)({}),l=(0,E.default)(n,2),r=l[0],u=l[1],o=(0,y.useState)(!1),i=(0,E.default)(o,2),c=i[0],d=i[1],f=(0,y.useState)(!1),s=(0,E.default)(f,2),m=s[0],p=s[1],v=(0,y.useMemo)((function(){return(0,h.default)(t.content)}),[t.content]);function g(e,t){return(0,b.default)(v).call(v,e,t).join("")}function _(){var e=a.current;if(e&&e.offsetParent){var n=window.getComputedStyle(e),l=document.createElement("div");(0,b.default)(Array.prototype).apply(n).forEach((function(e){l.style.setProperty(e,n.getPropertyValue(e))})),l.style.position="fixed",l.style.left="999999px",l.style.top="999999px",l.style.zIndex="-1000",l.style.height="auto",l.style.minHeight="auto",l.style.maxHeight="auto",l.style.textOverflow="clip",l.style.whiteSpace="normal",l.style.wordBreak="break-all",l.style.webkitLineClamp="unset",l.style.display="block";var r=A(n.lineHeight),o=Math.floor(r*(t.rows+.5)+A(n.paddingTop)+A(n.paddingBottom));if(l.innerText=t.content,document.body.appendChild(l),l.offsetHeight<=o)p(!1);else{p(!0);var i=t.content.length,d=c?t.collapseText:t.expandText,f=Math.floor((0+i)/2),s="middle"===t.direction?function e(t,a){if(t[1]-t[0]<=1&&a[1]-a[0]<=1)return{leading:g(0,t[0])+"...",tailing:"..."+g(a[1],i)};var n=Math.floor((t[0]+t[1])/2),r=Math.ceil((a[0]+a[1])/2);return l.innerText=g(0,n)+"..."+d+"..."+g(r,i),l.offsetHeight<=o?e([n,t[1]],[a[0],r]):e([t[0],n],[r,a[1]])}([0,f],[f,i]):function e(a,n){if(n-a<=1)return"end"===t.direction?{leading:g(0,a)+"..."}:{tailing:"..."+g(n,i)};var r=Math.round((a+n)/2);return"end"===t.direction?l.innerText=g(0,r)+"..."+d:l.innerText=d+"..."+g(r,i),l.offsetHeight<=o?"end"===t.direction?e(r,n):e(a,r):"end"===t.direction?e(a,r):e(r,n)}(0,i);u(s)}document.body.removeChild(l)}}R(_,a),(0,y.useLayoutEffect)((function(){_()}),[t.content,t.direction,t.rows,t.expandText,t.collapseText]);var w=m&&t.expandText?P(t.stopPropagationForActionButtons,y.default.createElement("a",{onClick:function(){d(!0)}},t.expandText)):null,x=m&&t.expandText?P(t.stopPropagationForActionButtons,y.default.createElement("a",{onClick:function(){d(!1)}},t.collapseText)):null;return F(t,y.default.createElement("div",{ref:a,className:"adm-ellipsis",style:{wordBreak:"break-all"},onClick:function(e){e.target===e.currentTarget&&t.onContentClick(e)}},m?c?y.default.createElement(y.default.Fragment,null,t.content,x):y.default.createElement(y.default.Fragment,null,r.leading,w,r.tailing):t.content))}},41956:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(65984)),u=a(63548),o=l(a(34780)),i=l(a(41472));t.default=function(e){var t=e.value,a=e.onChange;return r.default.createElement("div",{className:i.default.edit_avatar},r.default.createElement(o.default,{onChange:a,svgStr:t,triggerClassName:i.default.avatar},r.default.createElement("div",{className:i.default.edit},r.default.createElement(u.Icon,{prefix:"nocodeplatformicon",type:"bianji"}))))}},76684:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(96631)),c=o(a(78912)),d=o(a(73980)),f=o(a(28429)),s=o(a(50524)),m=o(a(13872)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),v=a(63548),g=a(57264),_=o(a(69892)),h=o(a(71252));function b(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(b=function(e){return e?a:t})(e)}var E=(0,g.getUrlWithDataCenter)("nocode/v2/nocode_sys/image"),w=["image/jpg","image/jpeg","image/png"],y=(0,g.getUrlWithDataCenter)((0,g.getFullUrl)("nocode/v2/nocode_sys/image"));t.default=function(e){var t=e.value,a=e.desc,n=e.imageFileserver,l=e.onChange,r=(0,p.useState)(!1),u=(0,c.default)(r,2),o=u[0],b=u[1],x=(0,p.useState)(""),N=(0,c.default)(x,2),C=N[0],k=N[1],T=(0,p.useState)((0,g.getTemplateImageUrl)(n,t)),I=(0,c.default)(T,2),M=I[0],S=I[1],F=(0,p.useState)(!1),O=(0,c.default)(F,2),P=O[0],R=O[1];(0,p.useEffect)((function(){var e=(0,g.getTemplateImageUrl)(n,t);M!==e&&S(e)}),[t]);var j=p.default.createElement(p.default.Fragment,null,p.default.createElement(v.Icon,{className:_.default["add-icon"],type:"add"}),p.default.createElement("p",{className:_.default["btn-text"]},"上传图片"));return p.default.createElement("div",{className:_.default.wrapper},p.default.createElement(v.Upload,{className:_.default.upload,data:{action:"upload",tempstorage:!0},name:"file",action:E,showUploadList:!1,accept:".jpg,.jpeg,.png",onChange:function(e){e.file},beforeUpload:function(e){var t=e.size,a=e.type;if(t/1024/1024>20)return(0,g.showNotice)("error","上传失败，图片大小不能超过20M"),!1;if(!(0,s.default)(w).call(w,a))return(0,g.showNotice)("error","上传失败，".concat(e.name," 不是 jpg、jpeg、png 类型的文件")),!1;C&&m.default.revokeObjectURL(C);var n=m.default.createObjectURL(e);return k(n),b(!0),!1}},p.default.createElement("div",{className:_.default["upload-handler"],onMouseOver:function(){return R(!0)},onMouseLeave:function(){return R(!1)}},M?p.default.createElement("img",{src:(0,g.getUrlWithDataCenter)(M),alt:"avatar"}):j,p.default.createElement("div",{className:(0,h.default)(_.default.layer,(0,i.default)({},_.default.show,P))},p.default.createElement(v.Icon,{prefix:"nocodeplatformicon",type:"bianji"})))),p.default.createElement("div",{className:_.default.desc},a),p.default.createElement(v.ImageCropper,{autoCropArea:1,imageMaxSize:20,containerWidth:800,containerHeight:588,aspectRatio:2.5,visible:o,title:"图片裁剪",image:C,onClose:function(){b(!1)},onCropSuccess:function(e){!function(e,t){var a=new FileReader;a.readAsDataURL(e),a.addEventListener("load",(function(e){t&&t(e.target.result)}))}(e,(function(e){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,n=new Image;n.src=e,n.addEventListener("load",(function(){var e=1920,l=1920,r=[this.naturalWidth,this.naturalHeight],u=r[0],o=r[1],i=!1;u>e&&(i=!0,l=o/(u/e)),o>l&&(i=!0,e=u/(o/l)),i||(e=u,l=o);var c=document.createElement("canvas"),d=c.getContext("2d");c.setAttribute("id","canvas"),c.width=e,c.height=l,d.clearRect(0,0,e,l),d.drawImage(n,0,0,e,l);var f=c.toDataURL("image/png",t);a&&a(f)}))}(e,1,(function(e){(function(e){return new f.default((function(t,a){var n=new FormData;n.append("file",e),n.append("action","upload"),n.append("tempstorage","true");var l=new XMLHttpRequest;l.open("POST",y),l.onload=function(e){200===this.status&&e.target.response?t(JSON.parse(e.target.response)):a(e)},l.send(n)}))})(function(e){for(var t,a=e.split(","),n=a[0].match(/:(.*?);/)[1],l=atob(a[1]),r=l.length,u=new Uint8Array(r);r--;)u[r]=l.charCodeAt(r);return new File([u],"".concat((0,d.default)(t=Math.random().toString(36)).call(t,-8),".png"),{type:n})}(e)).then((function(e){var t=e.data;if("0"===e.errorCode){var a=(t||{}).url;if(!a)return;var r=(0,g.getTemplateImageUrl)(n,a);S(r),l(a)}})).finally((function(){return b(!1)}))}))}))},dragMode:"move",cropBoxMovable:!1,className:_.default["image-cropper"],okText:"确定裁剪"}))}},80100:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(29052)),p=s(a(760)),v=s(a(96631)),g=s(a(94924)),_=s(a(78912)),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=k(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),b=a(63548),E=s(a(75020)),w=s(a(89924)),y=a(66028),x=a(25096),N=a(57264),C=s(a(89440));function k(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(k=function(e){return e?a:t})(e)}function T(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,v.default)(e,t,a[t])})):i?c(e,i(a)):T(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var M={visible:!1,id:"",info:{}};t.default=function(e){var t,a,n,l=e.visible,r=e.setVisible,u=e.templateInfo,o=void 0===u?{}:u,i=e.onClose,c=(0,h.useReducer)(y.assignDataReducer,M),d=(0,_.default)(c,2),f=d[0],s=d[1],v=o.appid,k=o.id,T=window.location.search,S=(0,p.default)(t=(0,p.default)(a=(0,p.default)(n="".concat(window.__domainurl__)).call(n,"nocode","/")).call(a,v)).call(t,T),F=(0,h.useCallback)((function(){var e=o.icon,t=o.name,a=o.desc;s({visible:!0,id:k,info:{icon:e,name:t,desc:a}})}),[o,s]),O=(0,h.useCallback)(function(){var e=(0,g.default)(m.default.mark((function e(t){var a,n,l,r;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=f.id,e.prev=1,e.next=4,(0,x.configApp)(I({templateId:a},t));case 4:n=e.sent,(l=n.result[0])&&(0,N.openner)("/".concat(l.id,"/home")),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),r=e.t0.message,(0,N.showNotice)("error",r);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),[f]),P=(0,E.default)(O,500);return h.default.createElement(h.default.Fragment,null,h.default.createElement(b.Drawer,{className:C.default["app-preview"],height:"100%",placement:"bottom",keyboard:!1,visible:l,onClose:i,title:"预览应用"},h.default.createElement("iframe",{src:S,frameBorder:"0",width:"100%",height:"100%"}),h.default.createElement("div",{className:C.default.preview_footer},h.default.createElement("div",{className:C.default.tips},h.default.createElement(b.Icon,{prefix:"nocodeplatformicon",type:"tishi"}),"当前为模板预览模式，完整功能请使用模板创建应用。"),h.default.createElement("div",{className:C.default.btns},h.default.createElement(b.Button,{onClick:function(){return null==r?void 0:r(!1)},style:{marginRight:"12px"}},"退出预览"),h.default.createElement(b.Button,{type:"primary",onClick:F},"使用")))),h.default.createElement(w.default,{value:f.info,visible:f.visible,setVisible:function(e){return s({visible:e})},onConfirm:P}))}},52868:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(29052)),p=s(a(760)),v=s(a(70696)),g=s(a(23992)),_=s(a(25288)),h=s(a(13440)),b=s(a(73980)),E=s(a(38456)),w=s(a(1900)),y=s(a(96631)),x=s(a(94924)),N=s(a(99148)),C=s(a(78912)),k=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=K(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),T=a(63548),I=s(a(75020)),M=a(66028),S=a(57264),F=a(88268),O=a(37220),P=a(98464),R=a(25096),j=a(62840),A=s(a(71252)),L=a(82416),B=s(a(85320)),U=s(a(73500)),D=s(a(80100)),q=s(a(89924)),z=a(59876),Q=a(60644),W=s(a(40436));function K(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(K=function(e){return e?a:t})(e)}function V(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,y.default)(e,t,a[t])})):i?c(e,i(a)):V(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var J={visible:!1,appId:"",templateId:""},G={name:"",id:"",showConfirm:!1},X={showModal:!1,id:"",info:{}},Y={visible:!1,id:"",info:{}},Z={total:0,comments:[],hasMore:!1};function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;return e.length>t?"".concat(e.substr(0,t-1),"..."):e}t.default=function(e){var t,a,n,l,r,u,o,i,c,d=e.visible,f=e.setVisible,s=e.value,K=void 0===s?{}:s,V=(e.canEdit,e.onClose),ee=e.createApp,te=e.imageFileserver,ae=e.refreshTemplates,ne=(0,k.useState)(),le=(0,C.default)(ne,2),re=le[0],ue=le[1],oe=(0,k.useReducer)(M.assignDataReducer,Z),ie=(0,C.default)(oe,2),ce=ie[0],de=ie[1],fe=(0,k.useState)({}),se=(0,C.default)(fe,2),me=se[0],pe=se[1],ve=(0,k.useReducer)(M.assignDataReducer,G),ge=(0,C.default)(ve,2),_e=ge[0],he=ge[1],be=(0,k.useReducer)(M.assignDataReducer,X),Ee=(0,C.default)(be,2),we=Ee[0],ye=Ee[1],xe=(0,k.useReducer)(M.assignDataReducer,J),Ne=(0,C.default)(xe,2),Ce=Ne[0],ke=Ne[1],Te=(0,k.useReducer)(M.assignDataReducer,Y),Ie=(0,C.default)(Te,2),Me=Ie[0],Se=Ie[1],Fe=(0,k.useState)(!0),Oe=(0,C.default)(Fe,2),Pe=Oe[0],Re=Oe[1],je=(0,k.useState)(!1),Ae=(0,C.default)(je,2),Le=(Ae[0],Ae[1]),Be=(0,k.useReducer)(M.assignDataReducer,K),Ue=(0,C.default)(Be,2),De=Ue[0],qe=Ue[1],ze=(0,k.useState)(!1),Qe=(0,C.default)(ze,2),We=Qe[0],Ke=Qe[1],Ve=(0,k.useState)(!1),He=(0,C.default)(Ve,2),Je=He[0],Ge=He[1],Xe=(0,W.default)().state,Ye=Xe.userInfo,Ze=Xe.rootConfig,$e=Ye||{},et=$e.isAdminUser,tt=$e.createApp,at=(0,k.useRef)({page_size:5,page_no:1}),nt=De||{},lt=nt.id,rt=nt.appid,ut=nt.icon,ot=nt.image,it=nt.name,ct=nt.domains,dt=void 0===ct?[]:ct,ft=nt.trades,st=void 0===ft?[]:ft,mt=nt.tag,pt=nt.desc,vt=nt.frequency,gt=(nt.users,nt.orgs,nt.createdate),_t=void 0===gt?"-":gt,ht=nt.org,bt=(0,S.getQueryString)("color",ut),Et=window.location.search,wt=(0,p.default)(t=(0,p.default)(a=(0,p.default)(n="".concat(window.__domainurl__)).call(n,"nocode","/")).call(a,rt)).call(t,Et),yt={backgroundColor:bt},xt=(0,k.useMemo)((function(){var e,t,a=(null==mt?void 0:mt.split(" "))||[];a=(0,v.default)(e=(0,g.default)(a).call(a,(function(e){var t=(null==e?void 0:(0,_.default)(e).call(e))||"";return(0,h.default)(t).length>8?(0,b.default)(t).call(t,0,8):t}))).call(e,Boolean);var n=(0,p.default)(t=[]).call(t,(0,N.default)(a),(0,N.default)((0,g.default)(dt).call(dt,(function(e){return e.name}))),(0,N.default)((0,g.default)(st).call(st,(function(e){return e.name}))));return null!=n&&n.length?n:["暂无标签"]}),[mt,dt,st]),Nt=(0,k.useCallback)((function(e){he({showConfirm:e})}),[he]),Ct=(0,k.useCallback)((function(){he({id:lt,name:it,showConfirm:!0})}),[he,lt,it]),kt=(0,k.useCallback)((0,x.default)(m.default.mark((function e(){var t,a,n,l;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_e.id){e.next=3;break}return e.abrupt("return");case 3:if(!Je){e.next=5;break}return e.abrupt("return");case 5:return Ge(!0),a=(0,S.showLoadingMessage)("正在删除模板，请稍候..."),e.prev=7,e.next=10,(0,O.deleteTemplateById)(t);case 10:n=e.sent,n.result&&(a({type:"success",content:"删除成功"}),ae(),Nt(!1),f(!1)),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(7),l=e.t0.message,a({type:"error",content:l});case 20:Ge(!1);case 21:case"end":return e.stop()}}),e,null,[[7,15]])}))),[_e,Nt,ae,Je]),Tt=(0,k.useCallback)((function(){ye({showModal:!0,id:lt,info:{appid:rt,name:it,trades:(0,g.default)(st).call(st,(function(e){return e.id})),domains:(0,g.default)(dt).call(dt,(function(e){return e.id})),desc:pt,icon:ut,image:ot,tag:mt,org:ht}})}),[ye,De]),It=(0,k.useCallback)(function(){var e=(0,x.default)(m.default.mark((function e(t){var a,n,l;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=we.id,n=H({id:a,type:"1"},t),e.prev=2,e.next=5,(0,P.modifyTemp)(n);case 5:e.sent&&((0,S.showNotice)("success","修改成功"),ye({showModal:!1}),ae((function(e){var t=(0,E.default)(e).call(e,(function(e){return e.id===a}));qe(t||{})}))),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),l=e.t0.message,(0,S.showNotice)("error",l);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),[we,ae,qe]),Mt=(0,I.default)(It,300),St=((0,k.useCallback)((function(){ke({visible:!0,appId:rt,templateId:lt})}),[ke,De]),(0,k.useCallback)((function(){ke({visible:!1})}),[ke,De])),Ft=(0,k.useCallback)((function(){if(!(0,S.isCNLanguage)(Ze))return(0,S.showNotice)("warnning",F.LANG_INVALID);Se({visible:!0,id:lt,info:{icon:ut,name:it,description:pt}})}),[De,Se,Ze]),Ot=(0,k.useCallback)(function(){var e=(0,x.default)(m.default.mark((function e(t){var a,n,l,r,u;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,S.showLoadingMessage)("正在创建应用，请稍候..."),n=Me.id,e.prev=2,e.next=5,(0,R.configApp)(H({templateId:n},t));case 5:l=e.sent,(r=l.result[0])&&(a({type:"success",content:"创建应用成功"}),(0,S.openner)("/".concat(r.id,"/home"))),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),u=e.t0.message,a({type:"error",content:u});case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),[Me]),Pt=function(){var e=(0,x.default)(m.default.mark((function e(){var t,a,n;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,R.getLineIconAndColor)();case 3:t=e.sent,a=t.row,ue(a),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),n=e.t0.message,(0,S.showNotice)("error",n);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Rt=(0,k.useCallback)((0,x.default)(m.default.mark((function e(){var t,a,n,l,r=arguments;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.prev=1,e.next=4,(0,j.getTemplateScore)(lt,t);case 4:a=e.sent,n=a.row,pe(void 0===n?{}:n),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),l=e.t0.message,(0,S.showNotice)("error",l);case 16:case"end":return e.stop()}}),e,null,[[1,11]])}))),[lt,pe]),jt=(0,k.useCallback)((0,x.default)(m.default.mark((function e(){var t,a,n,l,r,u,o,i,c,d=arguments;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]&&d[0],a=H({},at.current),e.prev=2,e.next=5,(0,j.getTemplateComments)(lt,a);case 5:(n=e.sent)&&(r=n.rows,u=n.lastPage,o=n.totalCount,i=t?(0,p.default)(l=ce.comments||[]).call(l,r):r,de({hasMore:!u,comments:i,total:o})),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),c=e.t0.message,(0,S.showNotice)("error",c);case 14:case"end":return e.stop()}}),e,null,[[2,9]])}))),[lt,ce,de]),At=(0,I.default)(Ot,500);(0,k.useEffect)((function(){d&&Re(!0)}),[d]),(0,k.useEffect)((function(){(0,Q.isEqual)(K,De)||qe(K)}),[K]),(0,k.useEffect)((function(){Pt()}),[]),(0,k.useEffect)((function(){d&&(Rt(),jt())}),[lt]);return k.default.createElement(k.default.Fragment,null,k.default.createElement(T.Drawer,{className:B.default["template-detail"],height:"100%",placement:"bottom",keyboard:!1,visible:d,onClose:V,title:"模板详情"},k.default.createElement("div",{className:(0,A.default)(B.default.appPreview,(0,y.default)({},B.default["preview-mode"],We)),style:yt},k.default.createElement("div",{className:B.default["iframe-area"],onMouseOver:function(){return Le(!0)},onMouseLeave:function(){return Le(!1)}},k.default.createElement("iframe",{src:wt,frameBorder:"0",width:"100%",height:"720px",onLoad:function(){return Re(!1)}}),k.default.createElement("div",{className:(0,A.default)(B.default.layer,(0,y.default)({},B.default.show,!Pe)),onClick:function(){return Ke(!0)}},k.default.createElement("div",{className:B.default["preview-btn"],"data-nc-action":"root-template||ts_at_tp_pv"},"点击预览")),Pe&&k.default.createElement("div",{className:B.default["spin-wrapper"]},k.default.createElement(T.Spin,{name:"spin"})),We&&k.default.createElement("div",{className:B.default.preview_footer},k.default.createElement("div",{className:B.default.tips},k.default.createElement(T.Icon,{prefix:"nocodeplatformicon",type:"tishi"}),"当前为模板预览模式，完整功能请使用模板创建应用。"),k.default.createElement("div",{className:B.default.btns},k.default.createElement(T.Button,{onClick:function(){Ke(!1),Le(!1)},style:{marginRight:"12px"}},"退出预览"),k.default.createElement(T.Button,{type:"primary",onClick:Ft,disabled:!tt,"data-nc-action":"root-template||ts_at_pvg_use_bn"},"使用"))))),k.default.createElement("div",{className:B.default.wrapper},k.default.createElement("div",{className:B.default.main},k.default.createElement("div",{className:B.default["main-left"]},k.default.createElement("section",{className:B.default["left-top"]},k.default.createElement("img",{src:(0,S.getUrlWithDataCenter)((0,S.getFullUrl)(ut)),alt:" ",className:B.default["app-icon"]}),k.default.createElement("div",{className:B.default.detail},k.default.createElement("div",{className:B.default["name-area"]},k.default.createElement("div",{className:B.default.name},it),k.default.createElement("div",{className:B.default.btns},et&&k.default.createElement(k.default.Fragment,null,k.default.createElement(T.Button,{type:"text",size:"small",icon:k.default.createElement(T.Icon,{prefix:"nocodeplatformicon",type:"shanchu2"}),onClick:Ct},"删除"),k.default.createElement(T.Button,{type:"text",size:"small",icon:k.default.createElement(T.Icon,{prefix:"nocodeplatformicon",type:"bianji"}),onClick:Tt,"data-nc-action":"root-template||ts_at_tp_edit"},"编辑")),k.default.createElement(T.Button,{type:"primary",onClick:Ft,disabled:!tt,"data-nc-action":"root-template||ts_at_tp_use"},"使用"))),k.default.createElement("div",{className:B.default["use-info"]},k.default.createElement("div",{className:B.default.count},"已使用 ",vt),k.default.createElement("div",{className:B.default.count},"已查看 ",(null==me?void 0:me.view)||0)),k.default.createElement("div",{className:B.default["tag-wrapper"]},(0,g.default)(xt).call(xt,(function(e,t){return k.default.createElement("div",{className:B.default.tag,key:t},e)}))))),k.default.createElement("section",{className:B.default.block,style:{marginTop:"40px"}},k.default.createElement("div",{className:B.default.title},"应用说明"),k.default.createElement("div",{className:B.default.desc},pt||"暂无描述")),k.default.createElement("section",{className:B.default.block},k.default.createElement("div",{className:B.default.title},"应用内容"),k.default.createElement("div",{className:B.default.collapse},k.default.createElement(T.Collapse,{name:"app_template_collapse"},k.default.createElement(T.Collapse.Panel,{header:"表单（".concat((null===(l=me.forms)||void 0===l?void 0:l.length)||0,"）"),panelKey:"form-list"},k.default.createElement("div",{className:B.default["form-list"]},(0,g.default)(r=me.forms||[]).call(r,(function(e,t){var a,n=e.name,l=e.icon;return k.default.createElement("div",{className:B.default["form-item"],key:(0,p.default)(a="template_".concat(lt,"_forms_")).call(a,t),title:n},function(e){var t,a,n,l;if(!re)return k.default.createElement("div",{className:B.default["form-icon"]});var r=(0,S.getQueryString)("color",e),u=(0,S.getQueryString)("svg",e),o=r&&"undefined"!==r?null==re||null===(t=re.colors)||void 0===t?void 0:(0,w.default)(t).call(t,(function(e){return e.value===r||e.key===r})):0,i=u&&"undefined"!==u?null==re||null===(a=re.svgs)||void 0===a?void 0:(0,w.default)(a).call(a,(function(e){return e.label===u})):0,c=null==re||null===(n=re.colors)||void 0===n||null===(n=n[o])||void 0===n?void 0:n.value;return k.default.createElement("div",{ref:function(e){var t;null==e||null===(t=e.getElementsByTagName("path"))||void 0===t||null===(t=t[0])||void 0===t||t.setAttribute("style","fill:".concat(c," "))},className:(0,A.default)(B.default["form-icon"]),dangerouslySetInnerHTML:{__html:(null==re||null===(l=re.svgs)||void 0===l||null===(l=l[i])||void 0===l?void 0:l.content)||""}})}(l||z.DEFAULT_FORM_IMAGE),k.default.createElement("div",{className:B.default["form-name"]},n))})))))),k.default.createElement("div",{className:B.default.collapse},k.default.createElement(T.Collapse,{name:"app_template_collapse"},k.default.createElement(T.Collapse.Panel,{header:"角色（".concat((null===(u=me.roles)||void 0===u?void 0:u.length)||0,"）"),panelKey:"role-list"},k.default.createElement("div",{className:B.default["role-list"]},(0,g.default)(o=me.roles||[]).call(o,(function(e,t){var a;return k.default.createElement("div",{className:B.default["role-item"],key:(0,p.default)(a="template_".concat(lt,"_roles_")).call(a,t),title:e},k.default.createElement("span",{className:B.default["role-pre"]}),k.default.createElement("div",{className:B.default["role-name"]},e))})))))),k.default.createElement("div",{className:B.default.collapse},k.default.createElement(T.Collapse,{name:"app_template_collapse"},k.default.createElement(T.Collapse.Panel,{header:"流程（".concat((null===(i=me.flows)||void 0===i?void 0:i.length)||0,"）"),panelKey:"role-list"},k.default.createElement("div",{className:B.default["role-list"]},(0,g.default)(c=me.flows||[]).call(c,(function(e,t){var a;return k.default.createElement("div",{className:B.default["role-item"],key:(0,p.default)(a="template_".concat(lt,"_flows_")).call(a,t),title:e},k.default.createElement("span",{className:B.default["role-pre"]}),k.default.createElement("div",{className:B.default["role-name"]},e))})))))))),k.default.createElement("div",{className:B.default["main-right"]},k.default.createElement("div",{className:B.default.block,style:{marginTop:"24px"}},k.default.createElement("div",{className:B.default.title},"开发者信息"),k.default.createElement("div",{className:B.default["create-info"]},k.default.createElement("div",{className:B.default["info-item"]},k.default.createElement("span",{className:B.default["info-title"]},"发布来源"),k.default.createElement("span",{className:B.default["info-content"]},ht||"-")),k.default.createElement("div",{className:B.default["info-item"]},k.default.createElement("span",{className:B.default["info-title"]},"发布时间"),k.default.createElement("span",{className:B.default["info-content"]},_t)))))))),k.default.createElement(L.ConfirmModal,{type:"delete",visible:_e.showConfirm,title:"删除模板",content:"确认删除【".concat($(_e.name),"】模板吗？一旦删除，不可恢复"),onAction:function(e){switch(e){case"ok":kt();break;case"cancel":Nt(!1)}}}),k.default.createElement(U.default,{title:"保存为应用模板",value:we.info,visible:we.showModal,imageFileserver:te,isEdit:!0,setVisible:function(e){return ye({showModal:e})},onConfirm:Mt,confirmBtnProps:{"data-nc-action":"root-template||sat_comf"}}),k.default.createElement(D.default,{visible:Ce.visible,templateInfo:De,setVisible:function(e){return ke({visible:e})},onClose:St,createApp:ee}),k.default.createElement(q.default,{value:Me.info,visible:Me.visible,setVisible:function(e){return Se({visible:e})},onConfirm:At}))}},39492:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(29052)),c=o(a(70696)),d=o(a(73980)),f=o(a(23992)),s=o(a(99148)),m=o(a(94924)),p=o(a(78912)),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=I(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),g=o(a(12152)),_=a(63548),h=a(37220),b=a(25096),E=a(57264),w=o(a(52868)),y=a(40196),x=a(95936),N=o(a(40436)),C=a(66028),k=o(a(74428)),T=o(a(69208));function I(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(I=function(e){return e?a:t})(e)}var M={visible:!1,templateInfo:{},canEdit:!1};t.default=function(e){var t,a=e.filterConfig,n=e.loaded,l=e.handleLoaded,r=a.domain,u=a.trade,o=a.keyword,I=a.templateFilter,S=(0,v.useState)(null),F=(0,p.default)(S,2),O=F[0],P=F[1],R=(0,v.useReducer)(C.assignDataReducer,M),j=(0,p.default)(R,2),A=j[0],L=j[1],B=(null===(t=(0,v.useContext)(x.Context).state.userInfo)||void 0===t?void 0:t.id)||"",U=(0,N.default)().state.fileServer.imageUrl,D=void 0===U?"":U,q=(0,v.useCallback)(function(){var e=(0,m.default)(i.default.mark((function e(t){var a,n,d,f,s,m,p;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,c.default)(a=["type EQ 1",r?"domains.fbasedataid.id IN ".concat(r):"",u?"trades.fbasedataid.id IN ".concat(u):"",o?"name CS '".concat(o,"'"):""]).call(a,Boolean).join(" and "),d=n?{filter:n}:{},"0"!==I&&(d.template_filter=I),e.prev=3,e.next=6,(0,h.getFormTemplates)(d);case 6:f=e.sent,s=f.rows,P(m=void 0===s?[]:s),null==t||t(m),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(3),P([]),p=e.t0.message,(0,E.showNotice)("error",p);case 19:l(!0);case 20:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),[r,u,o,I]),z=(0,v.useCallback)(function(){var e=(0,m.default)(i.default.mark((function e(t){var a,n,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,b.configApp)({templateId:t});case 3:a=e.sent,(n=a.result[0])&&(0,E.openner)("/".concat(n.id,"/home")),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),l=e.t0.message,(0,E.showNotice)("error",l);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[]),Q=(0,v.useCallback)((function(){L({visible:!1})}),[L]),W=(0,v.useCallback)((function(e){var t,a=(null===(t=e.creator)||void 0===t?void 0:t.id)||"";L({visible:!0,templateInfo:e,canEdit:B===a})}),[L,B]);(0,v.useEffect)((function(){q()}),[q]);var K=(0,v.useMemo)((function(){if(r||u||o.length>0||"0"!==I)return null;if(null==O||!O.length)return null;var e=(0,d.default)(O).call(O,0,4),t=(0,f.default)(e).call(e,(function(e){return e.id})).join("-");return v.default.createElement("div",{className:T.default.banner,key:t,"data-nc-action":"root-template||ts_at_bnr"},v.default.createElement(_.Carousel,{name:"Carousel",autoplay:!0},(0,f.default)(e).call(e,(function(e){var t=e.image,a=e.icon,n=e.id,l=e.name,r=e.desc,u=(0,E.getTemplateImageUrl)(D,t),o=(0,E.getQueryString)("color",a),i={backgroundColor:"".concat(o)},c={backgroundImage:"linear-gradient(270deg, transparent 0%, ".concat(o," 100%)")};return v.default.createElement("div",{className:T.default["banner-item"],key:n,onClick:function(){return W(e)}},v.default.createElement("div",{className:T.default["left-area"],style:i},v.default.createElement("div",{className:T.default.title},l),v.default.createElement("div",{className:T.default.desc,title:r||"暂无描述"},v.default.createElement(k.default,{rows:2,content:(0,y.getDescFormat)(r)})),v.default.createElement("div",{className:T.default["go-detail"],style:{color:"".concat(o)}},"查看详情")),v.default.createElement("div",{className:T.default["right-area"]},v.default.createElement("img",{src:u,className:T.default["bg-image"],alt:"图片"}),v.default.createElement("div",{className:T.default["linear-bg"],style:c})))}))))}),[O,r,u,I]),V=(0,v.useMemo)((function(){if(null==O||!O.length)return null;var e=Math.max.apply(Math,(0,s.default)((0,f.default)(O).call(O,(function(e){return e.frequency||0}))));return v.default.createElement("ul",{className:T.default.app_templates},(0,f.default)(O).call(O,(function(t){var a=t.id,n=(t.creator,t.name),l=t.desc,r=t.org,u=t.tag,o=t.domains,i=t.trades,c=t.frequency,d=t.image,s=t.icon,m=t.createdate,p=(0,f.default)(o).call(o,(function(e){return e.name})),g=(0,f.default)(i).call(i,(function(e){return e.name})),_=(Date.now()-new Date(m.replace(/-/g,"/")).getTime())/864e5<30;return v.default.createElement(y.AppTemplateCard,{key:a,className:T.default.card,name:n,desc:l,org:r,tag:u,domains:p,trades:g,frequency:c,image:d,icon:s,imageFileserver:D,isHot:!!e&&c===e,isNew:_,onClick:function(){return W(t)},style:{cursor:"pointer"},"data-nc-action":"root-template||ts_at"})})))}),[O,D,B,W]);return v.default.createElement(v.default.Fragment,null,K,n&&O&&(O.length?V:v.default.createElement(g.default,{text:"暂无应用模板"})),v.default.createElement(w.default,{visible:A.visible,imageFileserver:D,value:A.templateInfo,canEdit:A.canEdit,setVisible:function(e){return L({visible:e})},onClose:Q,createApp:z,refreshTemplates:q}))}},52988:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(29052)),p=s(a(760)),v=s(a(23992)),g=s(a(38456)),_=s(a(1900)),h=s(a(35680)),b=s(a(96631)),E=s(a(94924)),w=s(a(99148)),y=s(a(78912)),x=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=q(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),N=a(63548),C=s(a(75020)),k=a(66028),T=a(57264),I=a(88268),M=a(37220),S=a(98464),F=a(62840),O=s(a(71252)),P=a(82416),R=s(a(7436)),j=s(a(7976)),A=a(59876),L=a(60644),B=s(a(40436)),U=s(a(21044)),D=s(a(54864));function q(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(q=function(e){return e?a:t})(e)}function z(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){(0,b.default)(e,t,a[t])})):i?c(e,i(a)):z(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var W={name:"",id:"",showConfirm:!1},K={showModal:!1,id:"",info:{}},V={total:0,comments:[],hasMore:!1};function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;return e.length>t?"".concat(e.substr(0,t-1),"..."):e}t.default=function(e){var t=e.visible,a=e.setVisible,n=e.value,l=void 0===n?{}:n,r=e.canEdit,u=void 0!==r&&r,o=e.svgData,i=e.refreshTemplates,c=e.canJumpPrev,d=e.canJumpNext,f=e.jumpTo,s=e.onUseTemplate,b=(0,x.useReducer)(k.assignDataReducer,V),q=(0,y.default)(b,2),z=q[0],J=q[1],G=(0,x.useState)({}),X=(0,y.default)(G,2),Y=X[0],Z=X[1],$=(0,x.useReducer)(k.assignDataReducer,W),ee=(0,y.default)($,2),te=ee[0],ae=ee[1],ne=(0,x.useReducer)(k.assignDataReducer,K),le=(0,y.default)(ne,2),re=le[0],ue=le[1],oe=(0,x.useReducer)(k.assignDataReducer,l),ie=(0,y.default)(oe,2),ce=ie[0],de=ie[1],fe=(0,x.useState)(!1),se=(0,y.default)(fe,2),me=se[0],pe=se[1],ve=(0,x.useState)(!1),ge=(0,y.default)(ve,2),_e=ge[0],he=ge[1],be=(0,x.useState)(null),Ee=(0,y.default)(be,2),we=Ee[0],ye=Ee[1],xe=(0,B.default)().state.rootConfig,Ne=(0,x.useRef)({page_size:5,page_no:1}),Ce=ce||{},ke=Ce.id,Te=Ce.appid,Ie=Ce.icon,Me=Ce.name,Se=Ce.domains,Fe=void 0===Se?[]:Se,Oe=Ce.trades,Pe=void 0===Oe?[]:Oe,Re=Ce.desc,je=Ce.frequency,Ae=Ce.createdate,Le=void 0===Ae?"-":Ae,Be=Ce.org,Ue=Ce.formid,De=(0,x.useMemo)((function(){return{formId:"bos_nocode_bill",targetFormId:Ue,Status:"addNew",pkId:"",appId:Te}}),[Te,Ue]),qe=(0,x.useMemo)((function(){var e,t=(0,p.default)(e=[]).call(e,(0,w.default)((0,v.default)(Fe).call(Fe,(function(e){return e.name}))),(0,w.default)((0,v.default)(Pe).call(Pe,(function(e){return e.name}))));return null!=t&&t.length?t:["暂无标签"]}),[Fe,Pe]),ze=(0,x.useCallback)((function(e){e&&ye(e)}),[]),Qe=(0,x.useMemo)((function(){return{rootConfig:xe}}),[xe]),We=(0,x.useCallback)((function(e){ae({showConfirm:e})}),[ae]),Ke=(0,x.useCallback)((function(){ae({id:ke,name:Me,showConfirm:!0})}),[ae,ke,Me]),Ve=(0,x.useCallback)((0,E.default)(m.default.mark((function e(){var t,n,l,r;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=te.id){e.next=3;break}return e.abrupt("return");case 3:if(!me){e.next=5;break}return e.abrupt("return");case 5:return pe(!0),n=(0,T.showLoadingMessage)("正在删除模板，请稍候..."),e.prev=7,e.next=10,(0,M.deleteTemplateById)(t);case 10:l=e.sent,l.result&&(n({type:"success",content:"删除成功"}),i(),We(!1),a(!1)),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(7),r=e.t0.message,n({type:"error",content:r});case 20:pe(!1);case 21:case"end":return e.stop()}}),e,null,[[7,15]])}))),[te,We,i,me]),He=(0,x.useCallback)((function(){ue({showModal:!0,id:ke,info:{name:Me,trades:(0,v.default)(Pe).call(Pe,(function(e){return e.id})),domains:(0,v.default)(Fe).call(Fe,(function(e){return e.id})),desc:Re,icon:Ie}})}),[ue,ce]),Je=(0,x.useCallback)(function(){var e=(0,E.default)(m.default.mark((function e(t){var a,n,l;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=re.id,n=Q({id:a,type:"0"},t),e.prev=2,e.next=5,(0,S.modifyTemp)(n);case 5:e.sent&&((0,T.showNotice)("success","修改成功"),ue({showModal:!1}),i((function(e){var t=(0,g.default)(e).call(e,(function(e){return e.id===a}));de(t||{})}))),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),l=e.t0.message,(0,T.showNotice)("error",l);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),[re,i,de]),Ge=(0,C.default)(Je,300),Xe=(0,C.default)(f),Ye=(0,x.useCallback)((0,E.default)(m.default.mark((function e(){var t,a,n,l,r=arguments;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.prev=1,e.next=4,(0,F.getTemplateScore)(ke,t);case 4:a=e.sent,n=a.row,Z(void 0===n?{}:n),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),l=e.t0.message,(0,T.showNotice)("error",l);case 16:case"end":return e.stop()}}),e,null,[[1,11]])}))),[ke,Z]),Ze=(0,x.useCallback)((0,E.default)(m.default.mark((function e(){var t,a,n,l,r,u,o,i,c,d=arguments;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]&&d[0],a=Q({},Ne.current),e.prev=2,e.next=5,(0,F.getTemplateComments)(ke,a);case 5:(n=e.sent)&&(r=n.rows,u=n.lastPage,o=n.totalCount,i=t?(0,p.default)(l=z.comments||[]).call(l,r):r,J({hasMore:!u,comments:i,total:o})),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),c=e.t0.message,(0,T.showNotice)("error",c);case 14:case"end":return e.stop()}}),e,null,[[2,9]])}))),[ke,z,J]),$e=(0,x.useCallback)((function(){return(0,T.isCNLanguage)(xe)?s?s({id:ke,icon:Ie||A.DEFAULT_FORM_IMAGE}):void he(!0):(0,T.showNotice)("warnning",I.LANG_INVALID)}),[he,s,ke,xe]);(0,x.useEffect)((function(){(0,L.isEqual)(l,ce)||de(l)}),[l]),(0,x.useEffect)((function(){t&&(Ye(),Ze())}),[ke]),(0,x.useEffect)((function(){we&&(null==we||we.cleanPage(),null==we||we.loadPage(De))}),[De,we]),(0,x.useEffect)((function(){we&&(0,T.addUnloadListener)(we)}),[we]);return x.default.createElement(x.default.Fragment,null,x.default.createElement(N.Drawer,{className:R.default["template-detail"],height:"100%",placement:"bottom",keyboard:!1,visible:t,onClose:function(){return a(!1)},title:"模板详情",destroyOnClose:!0},x.default.createElement("div",{className:R.default.wrapper},x.default.createElement("div",{className:R.default["preview-area"]},x.default.createElement("div",{className:R.default.bill},c&&x.default.createElement("div",{className:R.default["prev-btn"],onClick:function(){return Xe("prev")}},x.default.createElement(N.Icon,{prefix:"nocodeplatformicon",type:"fangxiangzuo"})),x.default.createElement("div",{className:R.default["bill-main"]},x.default.createElement(U.default,{onRef:ze,config:null,options:Qe})),d&&x.default.createElement("div",{className:R.default["next-btn"],onClick:function(){return Xe("next")}},x.default.createElement(N.Icon,{prefix:"nocodeplatformicon",type:"fangxiangyou"}))),x.default.createElement("div",{className:R.default["preview-footer"]},x.default.createElement("div",{className:R.default.tips},x.default.createElement(N.Icon,{prefix:"nocodeplatformicon",type:"tishi"}),"当前为模板预览模式，完整功能请使用模板创建表单。"),x.default.createElement("div",{className:R.default.btns},u&&x.default.createElement(x.default.Fragment,null,x.default.createElement(N.Button,{type:"text",size:"small",icon:x.default.createElement(N.Icon,{prefix:"nocodeplatformicon",type:"shanchu2"}),onClick:Ke},"删除"),x.default.createElement(N.Button,{type:"text",size:"small",icon:x.default.createElement(N.Icon,{prefix:"nocodeplatformicon",type:"bianji"}),onClick:He},"编辑")),x.default.createElement(N.Button,{type:"primary",onClick:$e,"data-nc-action":"root-template||ts_ft_use"},"使用")))),x.default.createElement("div",{className:R.default.main},x.default.createElement("section",{className:R.default["template-info"]},function(e){var t,a,n,l;if(!o)return x.default.createElement("div",{className:R.default["form-icon"]});var r=(0,T.getQueryString)("color",e),u=(0,T.getQueryString)("svg",e),i=r&&"undefined"!==r?null==o||null===(t=o.colors)||void 0===t?void 0:(0,_.default)(t).call(t,(function(e){return e.value===r||e.key===r})):0,c=u&&"undefined"!==u?null==o||null===(a=o.svgs)||void 0===a?void 0:(0,_.default)(a).call(a,(function(e){return e.label===u})):0,d=null==o||null===(n=o.colors)||void 0===n||null===(n=n[i])||void 0===n?void 0:n.value,f=null==o||null===(l=o.svgs)||void 0===l||null===(l=l[c])||void 0===l?void 0:l.content;return x.default.createElement("div",{ref:function(e){var t;null==e||null===(t=e.getElementsByTagName("path"))||void 0===t||null===(t=t[0])||void 0===t||t.setAttribute("style","fill:".concat(d," "))},className:(0,O.default)(R.default["form-icon"]),dangerouslySetInnerHTML:{__html:(null==f?void 0:(0,h.default)(f).call(f,/<title>.*?<\/title>/g,""))||""}})}(Ie||A.DEFAULT_FORM_IMAGE),x.default.createElement("div",{className:R.default["info-right"]},x.default.createElement("div",{className:R.default.name,title:Me||"-"},Me||"-"),x.default.createElement("div",{className:R.default["use-info"]},x.default.createElement("div",{className:R.default.count},"已使用 ",je),x.default.createElement("div",{className:R.default.count},"已查看 ",(null==Y?void 0:Y.view)||0)),x.default.createElement("div",{className:R.default["tag-wrapper"]},(0,v.default)(qe).call(qe,(function(e,t){return x.default.createElement("div",{className:R.default.tag,key:t},e)}))))),x.default.createElement("div",{className:R.default.block},x.default.createElement("div",{className:R.default.title},"表单说明"),x.default.createElement("div",{className:R.default.desc,title:Re||"暂无描述"},Re||"暂无描述")),x.default.createElement("div",{className:R.default.block,style:{marginTop:"24px"}},x.default.createElement("div",{className:R.default.title},"开发者信息"),x.default.createElement("div",{className:R.default["create-info"]},x.default.createElement("div",{className:R.default["info-item"]},x.default.createElement("span",{className:R.default["info-title"]},"发布来源"),x.default.createElement("span",{className:R.default["info-content"]},Be||"-")),x.default.createElement("div",{className:R.default["info-item"]},x.default.createElement("span",{className:R.default["info-title"]},"发布时间"),x.default.createElement("span",{className:R.default["info-content"]},Le))))))),x.default.createElement(P.ConfirmModal,{type:"delete",visible:te.showConfirm,title:"删除模板",content:"确认删除【".concat(H(te.name),"】模板吗？一旦删除，不可恢复"),onAction:function(e){switch(e){case"ok":Ve();break;case"cancel":We(!1)}}}),x.default.createElement(D.default,{title:"保存为表单模板",value:re.info,visible:re.showModal,setVisible:function(){return ue({showModal:!1})},onConfirm:Ge}),x.default.createElement(j.default,{visible:_e,setVisible:he,templateId:ke,formIcon:Ie||A.DEFAULT_FORM_IMAGE}))}},9231:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(29052)),c=o(a(70696)),d=o(a(1900)),f=o(a(38456)),s=o(a(23992)),m=o(a(99148)),p=o(a(94924)),v=o(a(78912)),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=T(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),_=a(37220),h=a(66028),b=a(57264),E=o(a(12152)),w=o(a(52988)),y=a(40196),x=a(25096),N=a(95936),C=o(a(89188)),k=o(a(75020));function T(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(T=function(e){return e?a:t})(e)}var I={visible:!1,templateInfo:{},canEdit:!1};t.default=function(e){var t=e.filterConfig,a=e.loaded,n=e.handleLoaded,l=e.onUseTemplate,r=t.domain,u=t.trade,o=t.keyword,T=t.templateFilter,M=(0,g.useState)(null),S=(0,v.default)(M,2),F=S[0],O=S[1],P=(0,g.useReducer)(h.assignDataReducer,I),R=(0,v.default)(P,2),j=R[0],A=R[1],L=((0,g.useContext)(N.Context).state.userInfo||{}).id,B=void 0===L?"":L,U=(0,g.useState)(),D=(0,v.default)(U,2),q=D[0],z=D[1],Q=(0,g.useCallback)(function(){var e=(0,p.default)(i.default.mark((function e(t){var a,l,d,f,s,m,p;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,c.default)(a=["type EQ 0",r?"domains.fbasedataid.id IN ".concat(r):"",u?"trades.fbasedataid.id IN ".concat(u):"",o?"name CS '".concat(o,"'"):""]).call(a,Boolean).join(" and "),d=l?{filter:l}:{},"0"!==T&&(d.template_filter=T),e.prev=3,e.next=6,(0,_.getFormTemplates)(d);case 6:f=e.sent,s=f.rows,O(m=void 0===s?[]:s),null==t||t(m),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(3),O([]),p=e.t0.message,(0,b.showNotice)("error",p);case 19:n(!0);case 20:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),[r,u,o,T,O]),W=(0,g.useCallback)((function(e){var t,a=(null===(t=e.creator)||void 0===t?void 0:t.id)||"";A({visible:!0,templateInfo:e,canEdit:B===a})}),[A,B]),K=(0,g.useMemo)((function(){var e=j.templateInfo.id;return(null==F?void 0:(0,d.default)(F).call(F,(function(t){return t.id===e})))||0}),[j,F]),V=!(null==F||!F.length)&&0!==K,H=!(null==F||!F.length)&&K!==(null==F?void 0:F.length)-1,J=(0,g.useCallback)((function(e){var t="prev"===e?K-1:K+1,a=null==F?void 0:(0,f.default)(F).call(F,(function(e,a){return a===t}));if(a){var n,l=(null==a||null===(n=a.creator)||void 0===n?void 0:n.id)||"";A({templateInfo:a,canEdit:B===l})}}),[K,B]),G=(0,k.default)(J),X=function(){var e=(0,p.default)(i.default.mark((function e(){var t,a,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,x.getLineIconAndColor)();case 3:t=e.sent,a=t.row,z(a),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),n=e.t0.message,(0,b.showNotice)("error",n);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){Q()}),[Q]),(0,g.useEffect)((function(){X()}),[]);var Y=(0,g.useMemo)((function(){if(null==F||!F.length)return null;var e=Math.max.apply(Math,(0,m.default)((0,s.default)(F).call(F,(function(e){return e.frequency||0}))));return g.default.createElement("ul",{className:C.default.bill_templates},(0,s.default)(F).call(F,(function(t){var a=t.id,n=(t.creator,t.name),l=t.desc,r=t.org,u=t.tag,o=t.domains,i=t.trades,c=t.frequency,d=t.image,f=t.icon,m=t.createdate,p=(0,s.default)(o).call(o,(function(e){return e.name})),v=(0,s.default)(i).call(i,(function(e){return e.name})),_=(Date.now()-new Date(m.replace(/-/g,"/")).getTime())/864e5<30;return g.default.createElement(y.BillTemplateCard,{key:a,className:C.default.card,name:n,desc:l,org:r,tag:u,domains:p,trades:v,frequency:c,image:d,icon:f,isHot:!!e&&c===e,isNew:_,svgData:q,onClick:function(){return W(t)}})})))}),[F,B,W,q]);return g.default.createElement(g.default.Fragment,null,a&&F&&(null!=F&&F.length?Y:g.default.createElement(E.default,{text:"暂无表单模板"})),g.default.createElement(w.default,{visible:j.visible,value:j.templateInfo,canEdit:j.canEdit,svgData:q,setVisible:function(e){return A({visible:e})},refreshTemplates:Q,canJumpPrev:V,canJumpNext:H,jumpTo:G,onUseTemplate:l}))}},89924:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(28429)),p=s(a(73020)),v=s(a(25288)),g=s(a(96631)),_=s(a(78912)),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),b=a(63548),E=s(a(41956)),w=s(a(25452)),y=a(82416),x=a(66028),N=a(60644);function C(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(C=function(e){return e?a:t})(e)}function k(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,g.default)(e,t,a[t])})):i?c(e,i(a)):k(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var I="create-app",M=(0,h.forwardRef)((function(e,t){var a=e.prefixCls,n=e.value,l=b.Form.useForm(),r=(0,_.default)(l,1)[0],u=(0,h.useReducer)(x.assignDataReducer,n||{}),o=(0,_.default)(u,2),i=o[0],c=o[1];(0,h.useImperativeHandle)(t,(function(){return{validateFields:d}}));var d=function(){return new m.default((function(e,t){r.validateFields().then((function(t){var a=(0,p.default)(t);e(a)})).catch((function(e){return t(e)}))}))};return(0,h.useEffect)((function(){if(!(0,N.isEqual)(n,i)){var e=n.icon,t=n.name,a=n.description;r.setFieldsValue({icon:e,name:t,description:a}),c(n)}}),[n]),h.default.createElement("div",{className:w.default["".concat(a,"-modal-body")]},h.default.createElement(b.Form,{layout:"vertical",form:r,labelWidth:"100%",wrapperWidth:"100%"},h.default.createElement(b.Form.Item,{label:"名称",name:"name",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入应用名称"},{type:"string",validator:function(e,t,a,n,l){return null!=t&&(0,v.default)(t).call(t)?[]:[new Error("请输入应用名称")]}}]},h.default.createElement(b.Input,{type:"text",borderType:"bordered",size:"large",placeholder:"请输入应用名称",maxLength:50,value:i.name,onChange:function(e){return c({name:e.target.value})}})),h.default.createElement(b.Form.Item,{label:"图标",name:"icon",required:!0,validateTrigger:"onBlur"},h.default.createElement(E.default,{value:i.icon,onChange:function(e){return c({icon:e})}})),h.default.createElement(b.Form.Item,{label:"说明",name:"description",validateTrigger:"onBlur"},h.default.createElement(y.Textarea,{size:"large",showCount:!0,autoSize:{minRows:3,maxRows:3},borderType:"bordered",placeholder:"请输入应用说明",maxLength:255,value:i.description,onChange:function(e){return c({description:e})}}))))})),S=function(e){var t=e.prefixCls,a=e.onCancel,n=e.onConfirm;return h.default.createElement("div",{className:w.default["".concat(t,"-modal-footer")]},h.default.createElement(b.Button,{onClick:a,type:"second",size:"small",className:w.default["".concat(t,"-modal-cancel-btn")]},"取消"),h.default.createElement(b.Button,{type:"primary",size:"small",style:{marginLeft:"12px"},onClick:n,className:w.default["".concat(t,"-modal-ok-btn")]},"确定"))};t.default=function(e){var t=e.title,a=void 0===t?"从模版创建应用":t,n=e.showFooterCheckbox,l=void 0===n||n,r=e.footerCheckBoxProps,u=void 0===r?{dataKey:"copyData",text:"保留示例数据"}:r,o=e.value,i=e.visible,c=e.setVisible,d=e.onConfirm,f=u||{},s=f.dataKey,m=f.text,p=(0,h.useRef)(null),E=(0,h.useState)(!0),y=(0,_.default)(E,2),x=y[0],N=y[1],C=function(){(0,p.current.validateFields)().then((function(e){var t=e.name;e=T(T({},e),{},(0,g.default)({name:(0,v.default)(t).call(t)},s,x)),c(!1),null==d||d(e)})).catch((function(e){}))},k=function(){c(!1)};return(0,h.useEffect)((function(){i||x||N(!0)}),[i]),h.default.createElement(b.Modal,{mask:!0,visible:i,body:h.default.createElement(M,{prefixCls:I,ref:p,value:o}),titleIcon:null,className:w.default["".concat(I,"-modal")],footer:h.default.createElement(h.default.Fragment,null,h.default.createElement("div",{className:w.default["footer-checkbox"]},l&&h.default.createElement(b.Checkbox,{checked:x,onChange:function(e){N(e.target.checked)}},m)),h.default.createElement(S,{prefixCls:I,onConfirm:C,onCancel:k})),maskClosable:!1,width:480,height:436,title:a,closable:!0,draggable:!1,destroyOnClose:!0,keyboard:!1,onCancel:k,onOk:C})}},69064:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(23992)),c=o(a(29052)),d=o(a(96631)),f=o(a(94924)),s=o(a(78912)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=N(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),p=a(63548),v=a(37220),g=o(a(37992)),_=o(a(75020)),h=o(a(71252)),b=a(60644),E=a(57264),w=a(66028),y=a(78016),x=o(a(84212));function N(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(N=function(e){return e?a:t})(e)}var C=[{value:"0",label:"应用模板"},{value:"1",label:"表单模板"}],k=[{value:"0",label:"全部应用"},{value:"1",label:"我创建的"}],T=[{value:"0",label:"全部表单"},{value:"1",label:"我创建的"}],I={domains:[],trades:[]};t.default=function(e){var t=e.value,a=e.showTab,n=e.onChange,l=e.children,r=(0,m.useReducer)(w.assignDataReducer,I),u=(0,s.default)(r,2),o=u[0],N=u[1],M=(0,m.useReducer)(w.assignDataReducer,t),S=(0,s.default)(M,2),F=S[0],O=S[1],P=F.currentType,R=F.keyword,j=F.domain,A=F.trade,L=F.templateFilter,B=(0,_.default)(n,500),U=(0,m.useCallback)((0,f.default)(c.default.mark((function e(){var t,a,n,l,r,u,o,i,d,f;return c.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,v.getTradesAndDomains)();case 3:t=e.sent,a=t.rows,l=(n=void 0===a?[]:a)[0]||{},r=l.domains,u=void 0===r?[]:r,o=n[1]||{},i=o.trades,d=void 0===i?[]:i,u.unshift({name:"全部领域",id:""}),d.unshift({name:"全部行业",id:""}),N({domains:u,trades:d}),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(0),f=e.t0.message,(0,E.showNotice)("error",f);case 18:case"end":return e.stop()}}),e,null,[[0,13]])}))),[N]),D=(0,m.useCallback)((function(e){O({domain:e}),n({domain:e})}),[O,n]),q=(0,m.useCallback)((function(e){O({trade:e}),n({trade:e})}),[O,n]),z=(0,m.useCallback)((function(){var e={appId:"root-template",formId:"",eventName:"search",event:"".concat("0"===P?"ts_at_srh":"ts_ft_srh")};(0,y.publishUserEvent)(e)}),[P]),Q=(0,_.default)(z),W=(0,m.useCallback)((function(e){var t=e.target.value;O({keyword:t}),B({keyword:t}),Q()}),[O,B,Q]),K=(0,m.useCallback)((function(e){e!==P&&(O({currentType:e,domain:"",trade:"",keyword:""}),n({currentType:e,domain:"",trade:"",keyword:""}))}),[P,O,n]),V=(0,m.useCallback)((function(e){(0,y.publishUserEvent)({appId:"root-template",formId:"",action:"".concat("0"===e?"0"===P?"ts_at_as":"ts_ft_as":"0"===P?"ts_at_mc":"ts_ft_mc")}),e!==L&&(O({templateFilter:e}),n({templateFilter:e}))}),[L,O,n]);return(0,m.useEffect)((function(){U()}),[]),(0,m.useEffect)((function(){(0,b.isEqual)(t,F)||O(t)}),[t]),m.default.createElement("div",{className:x.default.template_filter},m.default.createElement("header",null,m.default.createElement("div",{className:x.default.tab},a&&(0,i.default)(C).call(C,(function(e){var t=e.value,a=e.label;return m.default.createElement("div",{className:(0,h.default)([x.default.tab_item,(0,d.default)({},x.default["is-active"],P===t)]),key:t,onClick:function(){return K(t)},"data-nc-action":"root-template||".concat("0"===P?"ts_at_tab":"ts_ft_tab")},a)}))),m.default.createElement("div",{className:x.default.searcher},m.default.createElement(p.Input,{className:x.default.search_box,value:R,prefix:m.default.createElement(p.Icon,{prefix:"nocodeplatformicon",type:"sousuo"}),onChange:W,placeholder:"关键词搜索".concat("0"===P?"应用":"表单","模板"),borderType:"bordered"}),m.default.createElement(p.Select,{placeholder:"请选择",className:x.default.search_select,borderType:"bordered",value:L,options:"0"===P?k:T,onChange:V,popperClassName:x.default["select-app-popper"]}))),m.default.createElement("div",{className:x.default.main},m.default.createElement("div",{className:x.default.content},m.default.createElement("div",{className:x.default.filter_wrapper},m.default.createElement(g.default,{title:"领 域：",value:j,options:o.domains,onChange:D,itemProps:{"data-nc-action":"root-template||".concat("0"===P?"ts_at_dom":"ts_ft_dom")}}),m.default.createElement(g.default,{title:"行 业：",value:A,options:o.trades,onChange:q,itemProps:{"data-nc-action":"root-template||".concat("0"===P?"ts_at_dom":"ts_ft_dom")}})),l)))}},12152:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(65984)),u=l(a(4496)),o=l(a(71252)),i=l(a(97072));t.default=function(e){var t=e.className,a=e.text,n=void 0===a?"暂无数据":a;return r.default.createElement("div",{className:(0,o.default)(i.default.template_empty,t)},r.default.createElement("img",{src:u.default,alt:n,width:224,height:128}),r.default.createElement("div",{className:i.default.template_empty_text},n))}},73500:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=t.INIT_TEMPLATE_VALUE=void 0;var m=s(a(29052)),p=s(a(96631)),v=s(a(26048)),g=s(a(94924)),_=s(a(78912)),h=s(a(99148)),b=s(a(23992)),E=s(a(70696)),w=s(a(50524)),y=s(a(99308)),x=s(a(760)),N=s(a(28429)),C=s(a(73020)),k=s(a(25288)),T=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=U(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),I=a(63548),M=a(37220),S=a(82416),F=s(a(37120)),O=s(a(41956)),P=s(a(76684)),R=a(40196),j=a(29588),A=a(66028),L=s(a(75020)),B=a(78016);function U(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(U=function(e){return e?a:t})(e)}function D(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){(0,p.default)(e,t,a[t])})):i?c(e,i(a)):D(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var z="save-app-template",Q={domains:[],trades:[]},W=function(e,t){var a;return(0,b.default)(a=(0,E.default)(e).call(e,(function(e){return(0,w.default)(t).call(t,e.id)}))).call(a,(function(e){return e.name}))},K=function(){var e=Math.floor(20*Math.random()+1);return e<10?"0".concat(e):"".concat(e)},V=function(e){var t=e.value,a=e.onChange,n=e.options,l=function(e,n){var l,r=e.target.checked?(0,h.default)(new y.default((0,x.default)(l=[]).call(l,(0,h.default)(t),[n]))):(0,E.default)(t).call(t,(function(e){return e!==n}));null==a||a(r)};return T.default.createElement("div",{className:F.default["checkbox-group"]},T.default.createElement(I.Checkbox,{className:F.default.checkbox,checked:t.length===n.length,value:"all",key:"all",onChange:function(e){var t;t=e.target.checked?(0,b.default)(n).call(n,(function(e){return e.id})):[],null==a||a(t)}},"全部"),(0,b.default)(n).call(n,(function(e){return T.default.createElement(I.Checkbox,{className:F.default.checkbox,value:e.id,key:e.id,checked:(0,w.default)(t).call(t,e.id),onChange:function(t){return l(t,e.id)}},e.name)})))},H=function(e){var t=e.id,a=e.title,n=e.showTitle;return void 0===n||n?T.default.createElement("div",{className:F.default["anchor-locator"],id:t},a):T.default.createElement("div",{id:t})},J=t.INIT_TEMPLATE_VALUE={name:"",desc:"",icon:"",image:"",tag:"",domains:[],trades:[]},G=(0,T.forwardRef)((function(e,t){var a=e.prefixCls,n=e.value,l=e.imageFileserver,r=I.Form.useForm(),u=(0,_.default)(r,1)[0],o=(0,T.useReducer)(A.assignDataReducer,Q),i=(0,_.default)(o,2),c=i[0],d=i[1],f=(0,T.useReducer)(A.assignDataReducer,n||J),s=(0,_.default)(f,2),p=s[0],h=s[1],b=(0,T.useRef)(null);(0,T.useEffect)((function(){E()}),[]);var E=(0,T.useCallback)((0,g.default)(m.default.mark((function e(){var t,a,n,l,r,u,o,i;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,M.getTradesAndDomains)();case 3:t=e.sent,a=t.rows,l=(n=void 0===a?[]:a)[0]||{},r=l.domains,u=void 0===r?[]:r,o=n[1]||{},i=o.trades,d({domains:u,trades:void 0===i?[]:i}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),[d]);(0,T.useImperativeHandle)(t,(function(){return{validateFields:w}}));var w=function(){return new N.default((function(e,t){u.validateFields().then((function(t){var a=(0,C.default)(t);e(a)})).catch((function(e){return t(e)}))}))};(0,T.useEffect)((function(){if(n){var e=n.image,t=n.name,a=n.trades,l=n.domains,r=n.desc,o=n.icon,i=n.tag,c=void 0===i?"":i;u.setFieldsValue({image:e,name:t,trades:a,domains:l,desc:r,icon:o,tag:c})}}),[]);var y=(0,T.useMemo)((function(){var e=p.name,t=p.desc,a=p.icon,n=p.image,l=p.tag,r=p.domains,u=p.trades,o=p.org,i=void 0===o?"金蝶官方":o,d=c.domains,f=c.trades;return{name:e,desc:t,icon:a,image:n,tag:l,frequency:0,org:i,domains:W(d,r),trades:W(f,u)}}),[p,c,l]);return T.default.createElement("div",{className:F.default["".concat(a,"-modal-body")]},T.default.createElement("section",{className:F.default["".concat(a,"-navigate")]},T.default.createElement(I.Anchor,{affix:!1,getContainer:function(){return b.current},offsetTop:350},T.default.createElement(I.Anchor.Link,{href:"#app-template-form_basic",title:T.default.createElement("div",{className:F.default["nav-item"]},T.default.createElement(I.Icon,{prefix:"nocodeplatformicon",type:"jichushezhi"}),"基础")}),T.default.createElement(I.Anchor.Link,{href:"#app-template-form_tags",title:T.default.createElement("div",{className:F.default["nav-item"]},T.default.createElement(I.Icon,{prefix:"nocodeplatformicon",type:"biaoqian"}),"标签")}))),T.default.createElement("section",{className:F.default["".concat(a,"-form")],ref:b},T.default.createElement(I.Form,{layout:"vertical",form:u,labelWidth:"100%",wrapperWidth:"100%"},T.default.createElement(H,{showTitle:!1,id:"app-template-form_basic"}),T.default.createElement(I.Form.Item,{label:"名称",name:"name",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入模板名称"},{type:"string",validator:function(e,t,a,n,l){return null!=t&&(0,k.default)(t).call(t)?[]:[new Error("请输入模板名称")]}}]},T.default.createElement(I.Input,{type:"text",value:p.name,borderType:"bordered",size:"large",placeholder:"请输入模板名称",maxLength:50,onChange:function(e){h({name:e.target.value})}})),T.default.createElement(I.Form.Item,{label:"图标",name:"icon",required:!0,validateTrigger:"onBlur"},T.default.createElement(O.default,{value:p.icon,onChange:function(e){return h({icon:e})}})),T.default.createElement("div",{className:F.default["switch-image"]},T.default.createElement("div",{onClick:function(){var e=p.image,t=K();if(/\/ncp\/images\/app_template_image_/g.test(e))for(var a=e.replace(/app_template_image_(\S+)/g,"$1");t===a;)t=K();var n="/ncp/images/app_template_image_".concat(t,".png");h({image:n}),u.setFieldValue("image",n)}},T.default.createElement(I.Icon,{prefix:"nocodeplatformicon",type:"qiehuan"}),"切换随机图片")),T.default.createElement(I.Form.Item,{label:"场景图片",name:"image",rules:[{required:!0,message:"请上传图片"}]},T.default.createElement(P.default,{value:p.image,desc:"请上传小于20M的 jpg、jpeg、png文件",imageFileserver:l,onChange:function(e){return h({image:e})}})),T.default.createElement(I.Form.Item,{label:"说明",name:"desc",validateTrigger:"onBlur"},T.default.createElement(S.Textarea,{size:"large",value:p.desc,autoSize:{minRows:3,maxRows:3},borderType:"bordered",placeholder:"请输入模板描述",onChange:function(e){return h({desc:e})},maxLength:255,showCount:!0})),T.default.createElement(H,{title:"标签",id:"app-template-form_tags"}),T.default.createElement(I.Form.Item,{className:F.default["".concat(a,"-modal-form-item-checkbox")],label:"领域",name:"domains",rules:[{required:!0,message:"请选择领域"}]},T.default.createElement(V,{value:p.domains,options:c.domains,onChange:function(e){h({domains:e}),u.setFieldValue("domains",e)}})),T.default.createElement(I.Form.Item,{className:F.default["".concat(a,"-modal-form-item-checkbox")],label:"行业",name:"trades",rules:[{required:!0,message:"请选择行业"}]},T.default.createElement(V,{value:p.trades,options:c.trades,onChange:function(e){h({trades:e}),u.setFieldValue("trades",e)}})))),T.default.createElement("section",{className:F.default["".concat(a,"-preview")]},T.default.createElement(R.AppTemplateCard,(0,v.default)({},y,{imageFileserver:l,style:{margin:0}})),T.default.createElement("div",{className:F.default["preview-desc"]},"模版中心卡片预览")))})),X=function(e){var t=e.prefixCls,a=e.onCancel,n=e.onConfirm,l=e.confirmBtnProps,r=void 0===l?{}:l;return T.default.createElement("div",{className:F.default["".concat(t,"-modal-footer")]},T.default.createElement(I.Button,{onClick:a,type:"second",size:"small",className:F.default["".concat(t,"-modal-cancel-btn")]},"取消"),T.default.createElement(I.Button,(0,v.default)({type:"primary",size:"small",style:{marginLeft:"12px"},onClick:n,className:F.default["".concat(t,"-modal-ok-btn")]},r),"确定"))};t.default=function(e){var t=e.title,a=e.value,n=e.isEdit,l=void 0!==n&&n,r=e.imageFileserver,u=e.visible,o=e.setVisible,i=e.onConfirm,c=e.confirmBtnProps,d=void 0===c?{}:c,f=e.copyDataProps,s=void 0===f?{}:f,m=(0,j.useWindowSize)().height,p=(0,T.useState)(m-64),v=(0,_.default)(p,2),g=v[0],h=v[1],b=(0,T.useRef)(null),E=(0,T.useState)(!0),w=(0,_.default)(E,2),y=w[0],x=w[1],N=(0,L.default)(h),C=function(){(0,b.current.validateFields)().then((function(e){var t=e.name;e=q(q({},e),{},{name:(0,k.default)(t).call(t)}),l||(e.copyData=y),o(!1),null==i||i(e)})).catch((function(e){}))},M=function(){o(!1)};return(0,T.useEffect)((function(){var e=m-64;e%2!=0&&N(e-1)}),[m]),T.default.createElement(I.Modal,{mask:!0,keyboard:!1,visible:u,body:T.default.createElement(G,{prefixCls:z,ref:b,value:a,imageFileserver:r}),titleIcon:null,className:F.default["".concat(z,"-modal")],footer:T.default.createElement(T.default.Fragment,null,!l&&T.default.createElement("div",{className:F.default["footer-checkbox"]},T.default.createElement(I.Checkbox,{checked:y,onChange:function(e){(0,B.publishClickUserEvent)(s),x(e.target.checked)}},"保留示例数据")),T.default.createElement(X,{prefixCls:z,confirmBtnProps:d,onConfirm:C,onCancel:M})),maskClosable:!1,width:960,height:g,title:t||"保存为模板",closable:!0,draggable:!1,destroyOnClose:!0,onCancel:M,onOk:C})}},7976:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(29052)),p=s(a(760)),v=s(a(23992)),g=s(a(96631)),_=s(a(94924)),h=s(a(78912)),b=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=I(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),E=a(63548),w=a(57264),y=a(25096),x=a(20680),N=s(a(12152)),C=s(a(74428)),k=s(a(75020)),T=s(a(70032));function I(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(I=function(e){return e?a:t})(e)}function M(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,g.default)(e,t,a[t])})):i?c(e,i(a)):M(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}var F=function(e){var t=e.templateId,a=e.formIcon,n=e.onClose,l=(0,b.useState)(null),r=(0,h.default)(l,2),u=r[0],o=r[1],i=(0,b.useState)(!1),c=(0,h.default)(i,2),d=c[0],f=c[1],s=(0,b.useState)(!1),g=(0,h.default)(s,2),I=g[0],M=g[1],F=(0,b.useRef)(null),O=(0,b.useState)(!1),P=(0,h.default)(O,2),R=P[0],j=P[1],A=(0,b.useRef)({page_size:40,page_no:1}),L=(0,b.useCallback)((0,_.default)(m.default.mark((function e(){var t,a,n=arguments;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.length>0&&void 0!==n[0]&&n[0])||!I){e.next=3;break}return e.abrupt("return");case 3:a=S({app_filter:"0"},A.current),(0,y.getAppList)(a,(function(){})).then((function(e){if(e){d&&f(!1);var a=e.rows,n=e.lastPage,l=t?(0,p.default)(u).call(u,a):a;M(n),o(l)}else M(!0),o([])}));case 5:case"end":return e.stop()}}),e)}))),[I,M,o,d,u]),B=(0,b.useCallback)((function(){A.current.page_no+=1,L(!0)}),[L]),U=(0,b.useCallback)(function(){var e=(0,_.default)(m.default.mark((function e(l){var r,u,o,i,c,d;return m.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=2;break}return e.abrupt("return");case 2:return j(!0),r=(0,w.showLoadingMessage)("正在创建表单，请稍候..."),e.prev=4,o={image:a},e.next=8,(0,x.createForm)(l,[{name:"",templateId:t,menuInfo:o}]);case 8:i=e.sent,c=i.result[0].number,r({type:"success",content:"创建表单成功"}),n(),(0,w.openner)((0,p.default)(u="/".concat(l,"/designer/")).call(u,c)),e.next=21;break;case 15:e.prev=15,e.t0=e.catch(4),d=e.t0.message,r({type:"error",content:d}),(0,w.showNotice)("error",d);case 21:j(!1);case 22:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}(),[t,n,a,R,j]),D=(0,k.default)(U,500),q=(0,b.useCallback)((function(){if(F.current){var e=new window.IntersectionObserver((function(e){e[0].intersectionRatio<=0||B()}));return e.observe(F.current),e}}),[B,F.current]);return(0,b.useEffect)((function(){d&&L()}),[d]),(0,b.useEffect)((function(){var e=q();return function(){e&&e.disconnect()}}),[q]),(0,b.useEffect)((function(){f(!0)}),[]),d?b.default.createElement("div",{className:T.default["loading-wrapper"]},b.default.createElement(E.Spin,{name:"Spin"})):b.default.createElement("div",{className:T.default.main},u&&u.length?b.default.createElement(b.default.Fragment,null,b.default.createElement("ul",{className:T.default.apps},(0,v.default)(u).call(u,(function(e){var t=e.name,a=e.id,n=e.image,l=e.description,r=(0,w.getQueryString)("color",n)||"";return b.default.createElement("li",{className:T.default.app_item,key:a,onClick:function(){return D(a)}},b.default.createElement("div",{className:T.default.app_item_detail},b.default.createElement("div",{className:T.default.app_item_icon},b.default.createElement("img",{src:(0,w.getUrlWithDataCenter)((0,w.getFullUrl)(n)),alt:t,style:{backgroundColor:r}})),b.default.createElement("div",{className:T.default.app_item_info},b.default.createElement("div",{className:T.default.app_item_name},t),b.default.createElement("div",{className:T.default.app_item_desc,title:l},b.default.createElement(C.default,{rows:3,content:l||"暂无描述"})))))}))),b.default.createElement("div",{ref:F,className:T.default.loadMore,style:{display:I?"none":"block"}},"加载中...")):b.default.createElement(N.default,{text:"暂无应用，请先创建应用",className:T.default.empty}))},O=(0,b.memo)((function(e){var t=e.templateId,a=e.formIcon,n=e.visible,l=e.setVisible,r=(0,b.useCallback)((function(){l(!1)}),[l]);return b.default.createElement(E.Modal,{mask:!0,visible:n,keyboard:!1,body:b.default.createElement(F,{templateId:t,formIcon:a,onClose:r}),titleIcon:null,className:T.default["select-app-modal"],footer:null,maskClosable:!1,width:1220,height:"calc(100% - 64px)",title:"请选择表单所属的应用",closable:!0,destroyOnClose:!0,onCancel:r})}));O.displayName="SelectApp";t.default=O},37992:function(e,t,a){var n=a(25028),l=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a(26048)),u=l(a(96631)),o=l(a(70696)),i=l(a(23992)),c=l(a(65984)),d=l(a(71252)),f=l(a(32710));t.default=function(e){var t=e.className,a=e.style,n=e.title,l=e.options,s=void 0===l?[]:l,m=e.value,p=e.onChange,v=e.itemProps,g=void 0===v?{}:v,_=(0,d.default)([(0,o.default)(f.default),t]);return c.default.createElement("div",{className:_,style:a},c.default.createElement("div",{className:f.default.filter_title},n),c.default.createElement("ul",{className:f.default.filter_options},(0,i.default)(s).call(s,(function(e){var t=e.name,a=e.id;return c.default.createElement("li",(0,r.default)({key:a,className:(0,d.default)([f.default.filter_options_item,(0,u.default)({},f.default["is-active"],m===a)]),onClick:function(){return null==p?void 0:p(a)}},g),t)}))))}},40196:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.getDescFormat=t.BillTemplateCard=t.AppTemplateCard=void 0;var i=o(a(70696)),c=o(a(23992)),d=o(a(25288)),f=o(a(13440)),s=o(a(73980)),m=o(a(760)),p=o(a(1900)),v=o(a(35680)),g=o(a(26048)),_=o(a(99148)),h=o(a(35256)),b=o(a(96631)),E=o(a(78912)),w=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=F(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),y=o(a(74428)),x=o(a(71252)),N=a(57264),C=o(a(32200)),k=o(a(19820)),T=a(59876),I=o(a(5470)),M=["name","className","desc","image","icon","domains","trades","tag","imageFileserver","isHot","isNew","onClick","org","frequency","style"],S=["name","className","desc","icon","domains","trades","isHot","isNew","onClick","org","frequency","svgData"];function F(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(F=function(e){return e?a:t})(e)}var O=t.getDescFormat=function(e){return e?e.replace(/(\n)+/g," "):"暂无描述"},P=function(e){var t=e.name,a=e.list,n=e.containerWidth,l=void 0===n?248:n,r=(0,w.useRef)(null),u=(0,w.useState)(!1),o=(0,E.default)(u,2),i=o[0],c=o[1];return(0,w.useLayoutEffect)((function(){var e=r.current,t=e.offsetLeft,a=e.clientWidth;c(t+a>l)}),[a,t,l]),w.default.createElement("div",{className:(0,x.default)(I.default.tag,(0,b.default)({},I.default.hidden,i)),ref:r},t)};t.AppTemplateCard=function(e){var t=e.name,a=void 0===t?"标题":t,n=e.className,l=e.desc,r=e.image,u=e.icon,o=e.domains,p=e.trades,v=e.tag,b=e.imageFileserver,E=e.isHot,T=void 0!==E&&E,S=e.isNew,F=void 0!==S&&S,R=e.onClick,j=e.org,A=e.frequency,L=e.style,B=(0,h.default)(e,M),U=(0,N.getQueryString)("color",u),D=(0,N.getTemplateImageUrl)(b,r),q=(0,w.useMemo)((function(){return U?{backgroundImage:"linear-gradient(270deg, transparent 0%, ".concat(U," 100%)")}:{}}),[U]),z=(0,w.useMemo)((function(){var e,t,a=(null==v?void 0:v.split(" "))||[];a=(0,i.default)(e=(0,c.default)(a).call(a,(function(e){var t=(null==e?void 0:(0,d.default)(e).call(e))||"";return(0,f.default)(t).length>8?(0,s.default)(t).call(t,0,8):t}))).call(e,Boolean);var n=(0,m.default)(t=[]).call(t,(0,_.default)(a),(0,_.default)(o),(0,_.default)(p));return null!=n&&n.length?n:["暂无标签"]}),[v,o,p]);return w.default.createElement("div",(0,g.default)({className:(0,x.default)(n,I.default["app-template-card"]),style:L,onClick:R},B),w.default.createElement("div",{className:I.default.banner},r&&w.default.createElement("img",{className:I.default["banner-image"],src:(0,N.getUrlWithDataCenter)(D),alt:" "}),w.default.createElement("div",{className:I.default["banner-bg"],style:q}),w.default.createElement("div",{className:I.default.title},a||"名称"),F&&w.default.createElement("img",{className:I.default.new,src:C.default,alt:"new",width:48,height:48}),T&&w.default.createElement("img",{className:I.default.hot,src:k.default,alt:"hot",width:48,height:48})),w.default.createElement("div",{className:I.default.desc,title:l||"暂无描述"},w.default.createElement(y.default,{rows:2,content:O(l)})),w.default.createElement("div",{className:I.default["tag-wrapper"]},(0,c.default)(z).call(z,(function(e,t){return w.default.createElement(P,{key:t,name:e,list:z})}))),w.default.createElement("div",{className:I.default.footer},w.default.createElement("div",{className:I.default["footer-left"]},"来自",j||"金蝶官方"),w.default.createElement("div",{className:I.default["footer-right"]},"已使用 ",A||0)))};(t.BillTemplateCard=function(e){var t=e.name,a=void 0===t?"标题":t,n=e.className,l=e.desc,r=e.icon,u=e.domains,o=e.trades,i=e.isHot,d=void 0!==i&&i,f=e.isNew,s=void 0!==f&&f,b=e.onClick,E=e.org,M=e.frequency,F=e.svgData,R=(0,h.default)(e,S),j=(0,w.useMemo)((function(){var e,t=(0,m.default)(e=[]).call(e,(0,_.default)(u),(0,_.default)(o));return null!=t&&t.length?t:["暂无标签"]}),[u,o]);return w.default.createElement("div",(0,g.default)({className:(0,x.default)(n,I.default["bill-template-card"]),onClick:b},R),w.default.createElement("div",{className:I.default.main},function(e){var t,a,n,l;if(!F)return w.default.createElement("div",{className:I.default["form-icon"]});var r=(0,N.getQueryString)("color",e),u=(0,N.getQueryString)("svg",e),o=r&&"undefined"!==r?null==F||null===(t=F.colors)||void 0===t?void 0:(0,p.default)(t).call(t,(function(e){return e.value===r||e.key===r})):0,i=u&&"undefined"!==u?null==F||null===(a=F.svgs)||void 0===a?void 0:(0,p.default)(a).call(a,(function(e){return e.label===u})):0,c=null==F||null===(n=F.colors)||void 0===n||null===(n=n[o])||void 0===n?void 0:n.value,d=null==F||null===(l=F.svgs)||void 0===l||null===(l=l[i])||void 0===l?void 0:l.content;return w.default.createElement("div",{ref:function(e){var t;null==e||null===(t=e.getElementsByTagName("path"))||void 0===t||null===(t=t[0])||void 0===t||t.setAttribute("style","fill:".concat(c," "))},className:(0,x.default)(I.default["form-icon"]),dangerouslySetInnerHTML:{__html:(null==d?void 0:(0,v.default)(d).call(d,/<title>.*?<\/title>/g,""))||""}})}(r||T.DEFAULT_FORM_IMAGE),w.default.createElement("div",{className:I.default["main-right"]},w.default.createElement("div",{className:I.default.title,title:a||"-"},a||"-"),w.default.createElement("div",{className:I.default.desc,title:l||"暂无描述"},w.default.createElement(y.default,{rows:2,content:O(l)})),w.default.createElement("div",{className:I.default["tag-wrapper"]},(0,c.default)(j).call(j,(function(e,t){return w.default.createElement(P,{key:t,name:e,list:j,containerWidth:220})}))),s&&w.default.createElement("img",{className:I.default.new,src:C.default,alt:"new",width:48,height:48}),d&&w.default.createElement("img",{className:I.default.hot,src:k.default,alt:"hot",width:48,height:48}))),w.default.createElement("div",{className:I.default.footer},w.default.createElement("div",{className:I.default["footer-left"]},"来自",E||"金蝶官方"),w.default.createElement("div",{className:I.default["footer-right"]},"已使用 ",M||0)))}).displayName="BillTemplateCard"},96888:function(e,t,a){var n=a(13568),l=a(13939),r=a(34716),u=a(70696),o=a(4884),i=a(3464),c=a(51400),d=a(25028),f=a(93252),s=a(9564);d(t,"__esModule",{value:!0}),t.default=t.TEMPLATE_TYPE_BILL=t.TEMPLATE_TYPE_APP=void 0;var m=s(a(96631)),p=s(a(78912)),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=N(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},r=d&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=r?o(e,u):null;i&&(i.get||i.set)?d(l,u,i):l[u]=e[u]}return l.default=e,a&&a.set(e,l),l}(a(65984)),g=s(a(55956)),_=s(a(69064)),h=a(66028),b=s(a(9231)),E=s(a(39492)),w=a(82416),y=a(60108),x=s(a(71252));function N(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(N=function(e){return e?a:t})(e)}function C(e,t){var a=l(e);if(r){var n=r(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):i?c(e,i(a)):C(Object(a)).forEach((function(t){d(e,t,o(a,t))}))}return e}t.TEMPLATE_TYPE_APP="0",t.TEMPLATE_TYPE_BILL="1";var T={currentType:"0",templateFilter:"0",domain:"",trade:"",keyword:""},I=(0,v.memo)((function(e){var t=e.type,a=void 0===t?"0":t,n=e.showTab,l=void 0===n||n,r=e.onUseBillTemplate,u=(0,v.useReducer)(h.assignDataReducer,k(k({},T),{},{currentType:a})),o=(0,p.default)(u,2),i=o[0],c=o[1],d=i.currentType,f=(0,v.useState)(!1),s=(0,p.default)(f,2),N=s[0],C=s[1],I=function(e){C(e)},M=(0,v.useCallback)((function(e){c(e)}),[c]);return v.default.createElement(v.default.Fragment,null,v.default.createElement("div",{className:(0,x.default)(g.default[N?"hidden":"skeleton"],g.default.template)},v.default.createElement(w.Skeleton,{options:y.TemplateSkeleton})),v.default.createElement("div",{className:(0,x.default)((0,m.default)({},g.default.hidden,!N),g.default.template)},v.default.createElement(_.default,{value:i,showTab:l,onChange:M},v.default.createElement("div",{className:g.default.template_main},"0"===d&&v.default.createElement(E.default,{filterConfig:i,handleLoaded:I,loaded:N}),"1"===d&&v.default.createElement(b.default,{filterConfig:i,onUseTemplate:r,handleLoaded:I,loaded:N})))))}));I.displayName="Templates";t.default=I},96908:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(29052)),c=o(a(94924)),d=o(a(78912)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=x(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),s=o(a(62336)),m=o(a(91292)),p=a(82416),v=a(57264),g=a(76732),_=a(32460),h=a(63548),b=o(a(74428)),E=o(a(95876)),w=o(a(80648)),y=o(a(96672));function x(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(x=function(e){return e?a:t})(e)}var N=function(e){var t=e.data,a=e.visible,n=e.onClose,l=e.onConfirm,r=t.name,u=t.image,o=t.description,i=(0,f.useState)(!0),c=(0,d.default)(i,2),s=c[0],m=c[1],p=function(){n(),null==l||l(s)},g=(0,f.useMemo)((function(){return f.default.createElement("div",{className:y.default.app_detail},f.default.createElement("div",{className:y.default.app_icon},f.default.createElement("img",{src:(0,v.getUrlWithDataCenter)((0,v.getFullUrl)(u)),alt:r})),f.default.createElement("div",{className:y.default.app_info},f.default.createElement("div",{className:y.default.app_name},r),f.default.createElement("div",{className:y.default.app_desc,title:o},f.default.createElement(b.default,{rows:3,content:o||"暂无描述"}))))}),[r,u,o]);return(0,f.useEffect)((function(){a||s||m(!0)}),[a]),f.default.createElement(h.Modal,{mask:!0,visible:a,body:g,titleIcon:null,className:y.default["export-setting-modal"],footer:f.default.createElement("div",{className:y.default["export-setting-modal-footer"]},f.default.createElement("div",{className:y.default["footer-checkbox"]},f.default.createElement(h.Checkbox,{checked:s,onChange:function(e){m(e.target.checked)}},"导出表单记录")),f.default.createElement(h.Button,{type:"primary",size:"small",style:{marginLeft:"12px"},onClick:p,className:y.default["export-setting-modal-ok-btn"]},"导出")),maskClosable:!1,width:480,height:232,title:"导出应用",closable:!0,draggable:!1,destroyOnClose:!0,keyboard:!1,onCancel:function(){n()},onOk:p})},C=w.default.CancelToken,k=(0,f.memo)((function(e){var t=e.visible,a=e.appInfo,n=void 0===a?{}:a,l=e.onClose,r=(0,f.useState)(!1),u=(0,d.default)(r,2),o=u[0],h=u[1],b=(0,f.useRef)(null),w=(0,E.default)({timeOut:10,beginCallBack:function(){h(!0)},overCallBack:function(){h(!1)}}),y=w.begin,x=w.schedule,k=w.over,T=function(){var e=(0,c.default)(i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=b.current)||void 0===t||t.call(b),k();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=(0,f.useMemo)((function(){return f.default.createElement("div",{style:{paddingTop:122}},f.default.createElement(m.default,{percent:x,textMap:["应用导出中，请耐心等待"]}))}),[x]),M=function(){var e=(0,c.default)(i.default.mark((function e(t){var a,l,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.id,y(),e.prev=2,e.next=5,(0,g.downloadFile)((0,v.getUrlWithDataCenter)("/nocode/v2/nocode_sys/common/app_export"),{params:{appId:a,withData:t},cancelToken:new C((function(e){b.current=e}))});case 5:k(),p.WebMsg.showConfirmModal({type:"success",title:"导出成功",actions:[{text:"我知道了",key:"ok"}]}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),l=e.t0.message,r=e.t0.code,k(),"ERR_CANCELED"===r?(0,v.showNotice)("warnning","已取消导出"):(0,v.showNotice)("error",l);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();return f.default.createElement(f.default.Fragment,null,f.default.createElement(N,{data:n,visible:t,onClose:l,onConfirm:M}),f.default.createElement(s.default,{visible:o,title:"导出应用",titleTips:"",body:I,onCancel:T,onClose:function(){return h(!1)},cancelText:"取消",renderFooter:function(){return f.default.createElement(_.ImportExportModalFooter,{cancelText:"取消",onCancel:T})}}))}));k.displayName="ExportApp";t.default=k},34780:function(e,t,a){var n=a(13568),l=a(93252),r=a(25028),u=a(4884),o=a(9564);r(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(760)),c=o(a(1900)),d=o(a(78912)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var l={__proto__:null},o=r&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?u(e,i):null;c&&(c.get||c.set)?r(l,i,c):l[i]=e[i]}return l.default=e,a&&a.set(e,l),l}(a(65984)),s=a(63548),m=o(a(34796)),p=o(a(10352)),v=a(57264),g=a(25096),_=o(a(71252));function h(e){if("function"!=typeof l)return null;var t=new l,a=new l;return(h=function(e){return e?a:t})(e)}var b=function(e){var t=(null==e?void 0:e.length)||0;return Math.floor(Math.random()*t)};t.default=f.default.memo((function(e){var t=e.onChange,a=e.svgStr,n=(e.placement,e.triggerClassName),l=e.popperClassName,r=e.children,u=(0,f.useState)(null),o=(0,d.default)(u,2),h=o[0],E=o[1],w=(0,f.useState)({colorIndex:0,iconIndex:0}),y=(0,d.default)(w,2),x=y[0],N=y[1],C=(0,f.useRef)(null),k=(0,f.useMemo)((function(){var e;return(null==h||null===(e=h.colors)||void 0===e||null===(e=e[x.colorIndex])||void 0===e?void 0:e.value)||""}),[h,x.colorIndex]);(0,f.useEffect)((function(){a&&h&&T(a,h)}),[a,h]),(0,f.useEffect)((function(){(0,g.getIconAndColor)().then((function(e){var n=e.row;if(E(n),a)T(a,n);else{var l,r,u=b(n.colors),o=b(n.svgs);N({colorIndex:u,iconIndex:o});var c=encodeURIComponent(null==n||null===(l=n.colors)||void 0===l||null===(l=l[u])||void 0===l?void 0:l.value),d=null==n?void 0:n.svgs[o].label;null==t||t((0,i.default)(r="nocode/v2/nocode_sys/common/svgs/create_svg?color=".concat(c,"&svg=")).call(r,d))}}))}),[]);var T=(0,f.useCallback)((function(e,t){var a,n,l=(0,v.getQueryString)("color",e),r=(0,v.getQueryString)("svg",e),u=l&&"undefined"!==l?(0,c.default)(a=t.colors).call(a,(function(e){return e.value===l||e.key===l})):0,o=r&&"undefined"!==r?(0,c.default)(n=t.svgs).call(n,(function(e){return e.label===r})):0;N({colorIndex:u,iconIndex:o})}),[]),I=(0,f.useCallback)((function(e,t){N({colorIndex:e,iconIndex:t})}),[]),M=(0,f.useCallback)((function(){var e,t,a;if(h){var n=encodeURIComponent(null==h||null===(e=h.colors[x.colorIndex])||void 0===e?void 0:e.value),l=null==h||null===(t=h.svgs)||void 0===t?void 0:t[x.iconIndex].label;return(0,i.default)(a="nocode/v2/nocode_sys/common/svgs/create_svg?color=".concat(n,"&svg=")).call(a,l)}}),[x,h]),S=(0,f.useCallback)((function(e){if(!e){var n=M();n!==a&&(null==t||t(n))}}),[M,t,a]),F=(0,f.useMemo)((function(){return f.default.createElement(p.default,{data:h,iconIndex:x.iconIndex,colorIndex:x.colorIndex,onSelect:I})}),[h,x]),O=(0,f.useMemo)((function(){var e,t=(null==h||null===(e=h.svgs)||void 0===e||null===(e=e[x.iconIndex])||void 0===e?void 0:e.content)||"";return f.default.createElement("div",{ref:C,className:(0,_.default)(m.default.avatar,n),style:{backgroundColor:k},dangerouslySetInnerHTML:{__html:t}})}),[h,x]);return f.default.createElement(s.Tooltip,{placement:"rightTop",arrow:!1,popperClassName:(0,_.default)(m.default.pop,l),tip:F,trigger:"click",onVisibleChange:S},O,r)}))},60108:function(e,t,a){a(25028)(t,"__esModule",{value:!0}),t.TemplateSkeleton=void 0;t.TemplateSkeleton=[{width:"1180px",height:"100%",margin:"0 auto",flexDirection:"column",child:[{width:"100%",height:"36px",type:"HEAD",child:[{width:"auto",height:"36px",child:[{width:"64px",height:"36px",repeat:3,type:"INPUT",margin:"0px 24px 0px 0px"}]},{width:"auto",height:"36px",child:[{width:"250px",height:"36px",type:"INPUT"},{width:"120px",height:"36px",type:"INPUT"}]}]},{width:"470px",height:"35px",type:"INPUT",margin:"16px 0px 3px 0px"},{width:"100%",height:"28px",type:"INPUT",margin:"16px 0px 16px 0px"},{width:"408px",height:"16px",type:"INPUT",margin:"0px 0px 26px 0px"},{width:"100%",height:"196px",type:"INPUT",margin:"0px 0px 20px 0px"},{width:"100%",height:"auto",flexWrap:"wrap",child:[{width:"280px",height:"236px",type:"CARD",repeat:8,child:[{width:"100%",height:"100%",flexDirection:"column",child:[{width:"280px",height:"112px",margin:"0px",type:"INPUT"},{width:"248px",height:"16px",type:"INPUT",margin:"12px 0px 8px 16px"},{width:"200px",height:"16px",margin:"0px 0px 12px 16px",type:"INPUT"},{width:"auto",height:"20px",flexDirection:"row",margin:"0px 0px 16px 4px",child:[{width:"52px",height:"20px",repeat:2,type:"INPUT"}]},{width:"260px",height:"12px",type:"HEAD",margin:"0px 0px 0px 4px",child:[{width:"72px",height:"12px",type:"INPUT"},{width:"64px",height:"12px",type:"INPUT",margin:"0px"}]}]}]}]}]}]},19820:function(e,t,a){e.exports=a.p+"ncp/nocode/images/12fee1355bd897303914.png"},32200:function(e,t,a){e.exports=a.p+"ncp/nocode/images/c28159ea4bcf53f3ef4b.png"}}]);