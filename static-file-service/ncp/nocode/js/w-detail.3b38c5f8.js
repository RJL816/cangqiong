"use strict";(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[684],{56124:function(e,t,a){a.r(t),t.default={header:"EKFI1FZG_header",header_main:"o69fZx-U_header_main"}},584:function(e,t,a){a.r(t),t.default={"drop-down-more":"VO-pdXZ6_drop-down-more","drop-down-wrapper":"IlmRvFmm_drop-down-wrapper"}},41984:function(e,t,a){a.r(t),t.default={title:"qLjUtZsH_title","title-text":"efmw-EDh_title-text","title-extra":"eIyoSavp_title-extra","title-icon-wrapper":"Sp1ON+W0_title-icon-wrapper","title-icon":"_7oGux5vD_title-icon",disabled:"o1waaUji_disabled",hidden:"DGig4wXC_hidden","icon-delete":"OYdSJrc8_icon-delete"}},60868:function(e,t,a){a.r(t),t.default={card_wrapper:"QwOfef2u_card_wrapper",card_title:"nMe8nMt1_card_title",display_card:"_5Y+JrrHa_display_card",card_body:"AqIDNHFT_card_body",draggable_area_left:"gLfWsjw6_draggable_area_left",draggable_area_top:"yqjoPGbk_draggable_area_top",draggable_area_right:"iUrbdjEg_draggable_area_right"}},30836:function(e,t,a){a.r(t),t.default={app_container:"ApS+IMsm_app_container"}},8748:function(e,t,a){a.r(t),t.default={app_header:"ktcF3PYR_app_header",left:"_9AxCdhZ5_left",ml12:"qWnmYsCZ_ml12",app_logo:"tSwGKkBI_app_logo",app_name:"SSQ2qPT1_app_name",nav:"P7qM9tdg_nav",user:"CIaFqBSZ_user",user_item:"TdUzpAnv_user_item",avatar_wrapper:"YDDMCYIZ_avatar_wrapper",avatar:"TH+650J4_avatar",app_container:"fXYCMBVS_app_container",user_info_pop:"_3BUVbZ1F_user_info_pop"}},94958:function(e,t,a){a.r(t),t.default={header_nav:"GWucqz0j_header_nav",header_nav_container:"Ovudhbpp_header_nav_container",header_nav_menu:"q2r5C6zu_header_nav_menu",header_nav_menu_item:"i1eYlHah_header_nav_menu_item",header_nav_menu_item_divider:"_4rcXUi6A_header_nav_menu_item_divider"}},98171:function(e,t,a){a.r(t),t.default={app_form_detail:"_5zTCZcku_app_form_detail",box:"ohFcZq8L_box",main:"fCZWr7mq_main",bill:"nLrZBefF_bill",has_flow:"qXOFJu1Z_has_flow",scroll:"XBM8fxc7_scroll",flow:"YLHj8Mpb_flow",footer:"SgJ9CUFc_footer",footer_main:"KzNQOdtU_footer_main",footer_main_tips:"wMiZVY4H_footer_main_tips",btns:"UGMiso5u_btns",mr12:"_3Z7QuvqL_mr12"}},96860:function(e,t,a){var n=a(25028),r=a(9564);n(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a(78912)),u=a(65984),o=r(a(40072));t.default=function(e,t){var a=(0,u.useState)(!1),n=(0,l.default)(a,2),r=n[0],i=n[1],d=(0,u.useRef)(),f=(0,u.useCallback)((function(e){var a=e[0].target,n=a.clientWidth,r=a.scrollWidth,l=r>n;(d.current!==r||l)&&(l||(d.current=r),i(l),null==t||t(l))}),[t]);return(0,o.default)(e,f),r}},40072:function(e,t,a){var n=a(25028),r=a(9564);n(t,"__esModule",{value:!0}),t.default=function(e,t){(0,l.useEffect)((function(){if(e){var a=e&&new u.default(t);return a&&a.observe(e),function(){a&&a.disconnect(e)}}}),[e,t])};var l=a(65984),u=r(a(82504))},1520:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(23992)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),f=o(a(71252)),c=o(a(56124));function s(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(s=function(e){return e?a:t})(e)}var p=(0,d.memo)((function(e){var t=e.children,a=e.className;return d.default.createElement("div",{className:(0,f.default)(c.default.header,a)},null==t?void 0:(0,i.default)(t).call(t,(function(e,t){return d.default.cloneElement(e,{key:t})})))}));p.displayName="Header";var m=(0,d.memo)((function(e){var t=e.children,a=e.className;return d.default.createElement("div",{className:a},t)}));m.displayName="HeaderLeft";var v=(0,d.memo)((function(e){var t=e.children,a=e.className;return d.default.createElement("div",{className:(0,f.default)(c.default.header_main,a)},t)}));v.displayName="HeaderMain",p.Left=m,p.Main=v,p.Right=m;t.default=p},42104:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(23992)),d=o(a(78912)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),c=a(63548),s=o(a(584));function p(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(p=function(e){return e?a:t})(e)}t.default=function(e){var t=e.menu,a=e.onItemClick,n=e.onVisibleChange,r=e.placement,l=e.triggerElement,u=e.trigger,o=e.getHoverTrigger,p=(0,f.useState)(!1),m=(0,d.default)(p,2),v=m[0],_=m[1],g=null==o?void 0:o();(0,f.useLayoutEffect)((function(){null==g||g.classList.add(s.default["drop-down-wrapper"])}),[g]);return f.default.createElement("div",{className:s.default["drop-down-more"],"data-more-dropdown":!0},f.default.createElement(c.Dropdown,{menu:function(e){return f.default.createElement(c.Dropdown.Menu,null,null==e?void 0:(0,i.default)(e).call(e,(function(e){return f.default.createElement(c.Dropdown.Item,{key:e.key},f.default.createElement("span",null,e.label))})))}(t),popperClassName:s.default.popper,visible:v,onItemClick:a,onVisibleChange:function(e){_(e),null==n||n(e),null==g||g.setAttribute("data-trigger-visible",e)},trigger:u||"hover",placement:r},l||f.default.createElement(c.Icon,{prefix:"nocodeplatformicon",type:"gengduo3"})))}},12992:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(29052)),d=o(a(760)),f=o(a(73980)),c=o(a(94924)),s=o(a(78912)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=k(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),m=a(39392),v=o(a(1524)),_=a(4440),g=a(82416),h=a(25096),y=a(6940),b=a(80672),w=a(63516),E=o(a(40436));function k(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(k=function(e){return e?a:t})(e)}var I=(0,p.memo)((function(e){var t,a=e.config,n=e.className,r=e.size,l=void 0===r?"middle":r,u=e.shareLink,o=e.modalTitle,k=void 0===o?"列表页":o,I=e.iconType,N=void 0===I?"fenxiang":I,C=e.onClick,S=e.allowNoAuth,A=e.shareReqireLogin,x=e.shareNotReqireLogin,M=(0,E.default)(),P=M.state,L=M.dispatch,T=a.appId,D=a.targetFormId,F=a.Status,O=a.pkId,j=P.userInfo,q=P.appsList[T],U=P.fileServer,R=P.selectedFormData,H=(0,m.useTranslation)().t,B=(0,p.useState)(R||{}),Z=(0,s.default)(B,2),z=Z[0],Y=Z[1],W=(0,p.useState)(!1),K=(0,s.default)(W,2),V=K[0],G=K[1];(0,p.useEffect)((function(){if(!q){var e="nocode/v2/nocode_sys/app/".concat(T);(0,w.getWithPriority)((0,y.getStoreData)(e,""),(0,h.getAppInfoById)(T).then((function(t){return(0,y.setStoreData)(e,"",t),t})),(function(e){var t,a=null==e||null===(t=e.rows)||void 0===t?void 0:t[0];a&&L({type:b.UPDATE_APP_INFO_BY_ID,payload:{id:T,value:a}})}))}}),[q,T]);var Q=(0,p.useMemo)((function(){var e,t;return(0,d.default)(e="".concat(null===(t=z.name)||void 0===t?void 0:(0,f.default)(t).call(t,0,50-k.length))).call(e,k)}),[z,k,F]),X=function(){var e=(0,c.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=2;break}return e.abrupt("return",C());case 2:(0,_.getFormData)({appId:T,targetFormId:D}).then((function(e){var t,a=(null==e||null===(t=e.rows)||void 0===t?void 0:t[0])||{};Y(a),G(!0)})).catch((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=(0,p.useCallback)((function(){G(!1)}),[]);return p.default.createElement(p.default.Fragment,null,p.default.createElement(g.BtnField,{size:l,type:"text","data-nc-action":(0,d.default)(t="".concat(T,"|")).call(t,D,"|tb_share"),onClick:X,className:n,text:H("apps.share"),icon:{prefix:"nocodeplatformicon",type:N}}),V&&p.default.createElement(v.default,{visible:V,title:"分享",onCancel:J,onOk:J,shareTitle:Q,needLoginLink:u,shareByPeople:null==j?void 0:j.name,shareAppImage:null==q?void 0:q.image,formid:O||z.formId,fileServer:U,allowNoAuth:S,formData:z,config:a,shareReqireLogin:A,shareNotReqireLogin:x}))}));I.displayName="ShareButton";t.default=I},38504:function(e,t,a){var n=a(13568),r=a(13939),l=a(34716),u=a(70696),o=a(4884),i=a(3464),d=a(51400),f=a(25028),c=a(93252),s=a(9564);f(t,"__esModule",{value:!0}),t.default=t.OperationType=void 0;var p=s(a(26048)),m=s(a(96631)),v=s(a(13568)),_=s(a(23992)),g=s(a(38456)),h=s(a(760)),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=N(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},l=f&&o;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=l?o(e,u):null;i&&(i.get||i.set)?f(r,u,i):r[u]=e[u]}return r.default=e,a&&a.set(e,r),r}(a(65984)),b=a(63548),w=s(a(41984)),E=s(a(71252)),k=s(a(96860)),I=s(a(42104));function N(e){if("function"!=typeof c)return null;var t=new c,a=new c;return(N=function(e){return e?a:t})(e)}function C(e,t){var a=r(e);if(l){var n=l(e);t&&(n=u(n).call(n,(function(t){return o(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,m.default)(e,t,a[t])})):i?d(e,i(a)):C(Object(a)).forEach((function(t){f(e,t,o(a,t))}))}return e}t.OperationType=function(e){return e.edit="edit",e.delete="delete",e.close="close",e.collect="collect",e.collected="collected",e.redirect="redirect",e.arrow="mobredirect",e}({});var A=function(e){return e.edit="bianji",e.delete="shanchu2",e.close="guanbi",e.collect="xinxing-xian",e.collected="xinxing-mian",e.redirect="liebiao2",e.mobredirect="youqie",e}(A||{}),x=function(){};t.default=(0,y.memo)((function(e){var t=e.text,a=e.operations,n=e.className,r=e.getHoverTrigger,l=e.draggableClassName,u=e.allowCollapse,o=void 0!==u&&u,i=(0,y.useRef)(),d=(0,k.default)(i.current,x);return y.default.createElement("div",{className:(0,E.default)(w.default.title,n)},y.default.createElement("div",{className:(0,E.default)(w.default["title-text"],l),ref:i,title:t},t),y.default.createElement("div",{className:w.default["title-extra"]},d&&o?function(e){return y.default.createElement(I.default,{getHoverTrigger:r,onItemClick:function(t){var a,n=null==e||null===(a=(0,g.default)(e).call(e,(function(e){return e.type===t})))||void 0===a?void 0:a.onClick;null==n||n()},menu:null==e?void 0:(0,_.default)(e).call(e,(function(e){return{key:e.type,label:e.label}})),placement:"bottomLeft",triggerElement:y.default.createElement(b.Icon,{prefix:"nocodeplatformicon",type:"gengduo"})})}(a):function(e){return null==e?void 0:(0,_.default)(e).call(e,(function(e,t){var a,n,r,l,u,o,i;"object"===(0,v.default)(e)?(r=A[e.type],l=e.color,u=e.disabled,i=e.onClick,o=e.style):r=A[e];var d=(0,E.default)(w.default["title-icon"],(0,m.default)((0,m.default)({},w.default.disabled,u),w.default["icon-delete"],r===A.close||r===A.delete)),f="hover"===e.trigger?(0,m.default)((0,m.default)({},"data-card-title",!0),"className",(0,E.default)(w.default["title-icon-wrapper"],(0,m.default)({},w.default.hidden,"hover"===e.trigger))):null;return y.default.createElement("div",(0,p.default)({},f,{key:(0,h.default)(a=(0,h.default)(n="".concat(r,"-")).call(n,e.label)).call(a,t)}),y.default.createElement(b.Icon,{prefix:"nocodeplatformicon",onClick:i,type:r,className:d,style:S(S({},o),{},{color:l})}))}))}(a)))}))},2500:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),d=a(63548),f=o(a(38504)),c=o(a(71252)),s=o(a(60868));function p(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(p=function(e){return e?a:t})(e)}var m=(0,i.forwardRef)((function(e,t){var a=e.title,n=e.draggableClassName,r=e.operations,l=e.wrapperClassName,u=e.className,o=e.children,p=e.style,m=e.loadData,v=e.init,_=e.isVisibleInit,g=void 0!==_&&_,h=(0,i.useRef)();return(0,i.useEffect)((function(){var e=h.current;if(g&&m&&e){var t=new window.IntersectionObserver((function(e){e[0].intersectionRatio<=0||e[0].isIntersecting&&!v&&m()}));return e&&t.observe(e),function(){t.disconnect()}}}),[h.current,v]),i.default.createElement("div",{ref:h,className:(0,c.default)(s.default.card_wrapper,l)},i.default.createElement(d.Card,{title:i.default.createElement(f.default,{className:s.default.card_title,text:a,getHoverTrigger:function(){return h.current},draggableClassName:n,operations:r}),className:(0,c.default)(s.default.display_card,u),style:p},i.default.createElement("div",{className:s.default.card_body},o)))}));m.displayName="CardWrapper";t.default=m},47236:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),d=a(41936),f=a(65300),c=o(a(30836));function s(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(s=function(e){return e?a:t})(e)}var p=(0,i.memo)((function(){return"cosmic"===(0,d.useParams)().origin?i.default.createElement("div",{className:c.default.app_container},i.default.createElement(d.Outlet,null)):i.default.createElement(f.DetailHeaderLayout,null)}));t.default=p},65300:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=t.DetailHeaderLayout=void 0;var i=o(a(760)),d=o(a(33260)),f=o(a(26048)),c=o(a(96631)),s=o(a(78912)),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=D(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),m=a(41936),v=o(a(8748)),_=a(39392),g=o(a(1520)),h=a(63548),y=a(95936),b=a(25096),w=a(57264),E=o(a(12992)),k=o(a(32504)),I=a(82416),N=a(57056),C=o(a(48864)),S=o(a(71252)),A=o(a(70072)),x=a(6940),M=o(a(60584)),P=a(88268),L=a(80672),T=a(63516);function D(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(D=function(e){return e?a:t})(e)}var F=t.DetailHeaderLayout=(0,p.memo)((function(e){var t,a,n,r=(0,_.useTranslation)().t,l=(0,m.useParams)(),u=l.appId,o=l.targetFormId,D=l.shareId,F=l.Status,O=l.pkId,j=(0,p.useContext)(y.Context),q=j.state,U=j.dispatch,R=(0,p.useState)(!1),H=(0,s.default)(R,2),B=H[0],Z=H[1],z=(0,p.useState)(F),Y=(0,s.default)(z,2),W=Y[0],K=Y[1],V=(0,p.useState)(O),G=(0,s.default)(V,2),Q=G[0],X=G[1],J=q.appsList[u],$=J||{},ee=$.istemplate,te=$.manage,ae=void 0!==te&&te,ne=$.image,re=$.name,le=q.userInfo,ue=((0,p.useContext)(N.AuthorizeContext)||{}).authList||{},oe=ue.editShareAuth,ie=ue.detailShareReqireLoginAuth,de=ue.detailShareNotReqireLoginAuth,fe=ue.inputShareReqireLoginAuth,ce=ue.inputShareNotReqireLoginAuth,se=ue.printAuth,pe=(0,A.default)(o),me=(0,p.useRef)();(0,p.useEffect)((function(){var e=function(e){K(e)};return M.default.on(P.UPDATE_STATUS,e),function(){M.default.off(P.UPDATE_STATUS,e)}}),[]),(0,p.useEffect)((function(){var e=function(e){X(e)};return M.default.on(P.UPDATE_PKID,e),function(){M.default.off(P.UPDATE_PKID,e)}}),[]),(0,p.useEffect)((function(){me.current=pe}),[pe]);var ve=(0,p.useMemo)((function(){return"edit"===W}),[W]),_e=(0,p.useMemo)((function(){return"view"===W}),[W]),ge=(0,p.useMemo)((function(){return ve?oe:_e?ie||de:fe||ce}),[ve,_e,oe,ie,de,ce,fe]);(0,p.useEffect)((function(){if(!J&&u){var e="nocode/v2/nocode_sys/app/".concat(u);(0,T.getWithPriority)((0,x.getStoreData)(e,""),(0,b.getAppInfoById)(u).then((function(t){return(0,x.setStoreData)(e,"",t||{}),t})),(function(e){var t;e&&U({type:L.UPDATE_APP_INFO_BY_ID,payload:{id:u,value:null===(t=e.rows)||void 0===t?void 0:t[0]}})}))}}),[J,u]),(0,p.useEffect)((function(){document.title=re||""}),[re]),(0,p.useEffect)((function(){return document.body.addEventListener("click",(function(){return Z(!1)})),function(){return document.body.removeEventListener("click",(function(){return Z(!1)}))}}),[]);var he=function(){(0,w.showNotice)("error","预览时无法使用此功能")},ye=(0,p.useCallback)((function(){if(ee)return he(),!0}),[ee]),be=ee?he:void 0,we=(0,p.useMemo)((function(){return ee?{handleClickTheme:he,handleClickLogout:he}:{}}),[ee]),Ee=(0,d.default)(t=window.location.pathname).call(t,"detail")>-1,ke=Ee&&("view"===F||!O),Ie=(0,p.useMemo)((function(){return Ee?_e?"详情":O?"编辑":"":"列表"}),[Ee,ke]),Ne=(0,w.getQueryString)("color",ne)||"";return p.default.createElement(p.default.Fragment,null,p.default.createElement(g.default,{className:v.default.app_header},p.default.createElement(g.default.Left,{className:v.default.left},!Ee&&p.default.createElement(C.default,{onItemClick:ye}),p.default.createElement("div",{className:(0,S.default)(v.default.app_logo,(0,c.default)({},v.default.ml12,!Ee))},p.default.createElement("img",{src:(0,w.getShareImage)(ne,D),style:{backgroundColor:Ne},alt:""})),p.default.createElement("span",{className:v.default.app_name},re||"")),p.default.createElement(g.default.Right,{className:v.default.user},se&&_e&&p.default.createElement(I.BtnField,{className:v.default.user_item,type:"text",onClick:function(){var e,t;(0,w.openner)((0,i.default)(e=(0,i.default)(t="/".concat(u,"/print/")).call(t,o,"/")).call(e,Q,"/view"))},text:"打印",icon:{prefix:"nocodeplatformicon",type:"dayin"}}),!D&&le&&p.default.createElement(p.default.Fragment,null,ge&&p.default.createElement(E.default,{config:{appId:u,targetFormId:o,Status:F||"addNew"},size:"small",className:v.default.user_item,shareLink:[(0,w.getPathName)(),window.location.search].join(""),linkName:re,modalTitle:Ie,iconType:"fenxiang",onClick:be,allowNoAuth:ke,shareReqireLogin:ve?oe:_e?ie:fe,shareNotReqireLogin:ve?oe:_e?de:ce}),ae&&p.default.createElement(I.BtnField,{size:"small","data-nc-action":(0,i.default)(a="".concat(u,"|")).call(a,o,"|tb_set"),type:"text",className:v.default.user_item,text:r("apps.moreActions"),onClick:function(){var e;if(ee)return he();o?(0,w.openner)((0,i.default)(e="/".concat(u,"/admin/")).call(e,o)):(0,w.openner)("/".concat(u,"/admin"))},icon:{prefix:"nocodeplatformicon",type:"shezhi5"}}),p.default.createElement(h.Tooltip,{placement:"bottomRight",trigger:"click",visible:B,arrow:!1,popperClassName:v.default.user_info_pop,tip:p.default.createElement(k.default,(0,f.default)({appId:u,formId:o,setVisible:Z,data:le},we))},p.default.createElement("div",{className:v.default.avatar_wrapper,"data-nc-action":(0,i.default)(n="".concat(u,"|")).call(n,o,"|tb_head_bn"),onClick:function(){le&&Z(!0)}},p.default.createElement(I.Avatar,{className:v.default.avatar,src:le.avatar})))))),p.default.createElement("div",{className:v.default.app_container},p.default.createElement(m.Outlet,null)))}));F.displayName="AppsHeaderLayout";t.default=F},48864:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(760)),d=o(a(23992)),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),c=o(a(732)),s=a(41936),p=a(63548),m=a(39392),v=o(a(94958)),_=a(95936),g=a(57264);function h(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(h=function(e){return e?a:t})(e)}var y=(0,f.lazy)((function(){return a.e(0).then(a.t.bind(a,51e3,23))})),b="businessManage";t.default=function(e){var t=e.onItemClick,a=e.openNewPage,n=void 0===a||a,r=(0,m.useTranslation)().t,l=(0,c.default)(),u=(0,s.useParams)(),o=u.appId,h=u.targetFormId,w=(0,f.useContext)(_.Context).dispatch,E=(0,f.useCallback)((function(e){var t,a;return(0,i.default)(t=(0,i.default)(a="".concat(o||"","|")).call(a,h||"","|")).call(t,e)}),[o,h]),k=[{path:"/home",title:r("designer.key0004"),icon:"qiyeguanli",useActionName:"tb_h_bn"},{path:"/app",title:r("designer.key0005"),icon:"quanbuyingyong",key:"allApp",useActionName:"tb_as_bn"},{path:"/template",title:r("designer.key0006"),icon:"moban2",useActionName:"tb_ts_bn"},{path:"/flow",title:r("designer.key0008"),icon:"liucheng-xian",useActionName:"tb_fs_bn"},{type:"divider"},{title:r("designer.key0007"),icon:"jichushezhi",key:b,useActionName:"tb_em_bn"}],I=f.default.createElement(p.Dropdown.Menu,{className:v.default.header_nav_menu},(0,d.default)(k).call(k,(function(e,t){var a=e.title,n=(e.path,e.icon),r=e.type,l=e.useActionName;return"divider"===r?f.default.createElement("li",{key:t,className:v.default.header_nav_menu_item_divider}):f.default.createElement(p.Dropdown.Item,{key:t,className:v.default.header_nav_menu_item,"data-nc-action":E(l)},f.default.createElement(f.default.Fragment,null,f.default.createElement(p.Icon,{prefix:"nocodeplatformicon",type:n}),a))})));return f.default.createElement(f.default.Fragment,null,f.default.createElement(p.Dropdown,{placement:"topLeft",menu:I,onItemClick:function(e){if("function"==typeof t&&t(e))return;var a=k[e];if(a){var r=a.path;if(r)n?(0,g.openner)(r):l(r);else if(a.key===b){var u=(0,g.autoModalHeight)(520,768);p.Modal.confirm({title:"企业管理",showline:!0,titleIcon:null,footer:null,width:960,height:u,type:"normal",bodyStyle:{padding:0,display:"flex",overflow:"hidden",flexBasis:0},body:f.default.createElement(f.Suspense,{fallback:f.default.createElement(f.default.Fragment,null)}," ",f.default.createElement(y,{dispatch:w})," "),closable:!0,maskClosable:!1})}}}},f.default.createElement("div",{className:v.default.header_nav},f.default.createElement("div",{className:v.default.header_nav_container},f.default.createElement(p.Icon,{prefix:"nocodeplatformicon",type:"9gedian"})))))}},2284:function(e,t,a){var n=a(13568),r=a(93252),l=a(25028),u=a(4884),o=a(9564);l(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a(29052)),d=o(a(38456)),f=o(a(67584)),c=o(a(96631)),s=o(a(94924)),p=o(a(78912)),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var a=A(t);if(a&&a.has(e))return a.get(e);var r={__proto__:null},o=l&&u;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var d=o?u(e,i):null;d&&(d.get||d.set)?l(r,i,d):r[i]=e[i]}return r.default=e,a&&a.set(e,r),r}(a(65984)),v=a(41936),_=a(57264),g=o(a(98171)),h=a(98464),y=o(a(40436)),b=o(a(49148)),w=o(a(3308)),E=o(a(21044)),k=o(a(64004)),I=o(a(71252)),N=o(a(60584)),C=a(88268),S=a(85040);function A(e){if("function"!=typeof r)return null;var t=new r,a=new r;return(A=function(e){return e?a:t})(e)}t.default=function(e){var t,a=(0,v.useParams)(),n=a.appId,r=a.targetFormId,l=a.pkId,u=a.Status,o=a.shareId,A=a.taskId,x=a.procInstId,M=a.origin,P=a.userTaskActivityId,L=a.userTaskBusinessKey,T=a.userTaskCurrentUserId,D=(0,y.default)(),F=D.state,O=D.sendUiData,j=F.userInfo,q=F.rootConfig,U=(0,m.useState)(u),R=(0,p.default)(U,2),H=R[0],B=R[1],Z=(0,m.useState)(l||""),z=(0,p.default)(Z,2),Y=z[0],W=z[1],K=(0,m.useState)([]),V=(0,p.default)(K,2),G=V[0],Q=V[1],X=(0,m.useMemo)((function(){if(P&&L&&T){var e,t=(0,d.default)(G).call(G,(function(e){return e.procInstId===x})),a=null==t||null===(e=t.approvalInfo)||void 0===e?void 0:(0,d.default)(e).call(e,(function(e){return e.taskId===A}));return null==a?void 0:a.nodeEntityNumber}return r}),[G,x,A,r,P,L,T]),J=(0,w.default)(X),$=(0,m.useState)(null),ee=(0,p.default)($,2),te=ee[0],ae=ee[1],ne=(0,m.useState)(!1),re=(0,p.default)(ne,2),le=re[0],ue=re[1],oe=(0,m.useState)(!1),ie=(0,p.default)(oe,2),de=ie[0],fe=ie[1],ce=(0,_.getQueryString)("pageId")||"",se=(0,m.useState)(!1),pe=(0,p.default)(se,2),me=pe[0],ve=pe[1],_e=(0,m.useState)({}),ge=(0,p.default)(_e,2),he=ge[0],ye=ge[1],be=he.add,we=void 0===be||be,Ee=he.edit,ke=void 0===Ee||Ee,Ie=he.view,Ne=void 0===Ie||Ie,Ce=he.delete,Se=void 0===Ce||Ce,Ae=he.add_fixed,xe=void 0!==Ae&&Ae,Me=G.length>0;(0,m.useEffect)((function(){N.default.emit(C.UPDATE_STATUS,H)}),[H]),(0,m.useEffect)((function(){N.default.emit(C.UPDATE_PKID,Y)}),[Y]);var Pe=(0,m.useCallback)((0,s.default)(i.default.mark((function e(){var t,a,l;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,S.getFormAuth)(n,r,Y,x,P,L,T);case 3:t=e.sent,a=t.rows,ye((void 0===a?[]:a)[0]||[]),ue(!0),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),l=e.t0.message,(0,_.showNotice)("error",l);case 15:case"end":return e.stop()}}),e,null,[[0,10]])}))),[n,r,Y,x,P,L,T]);(0,m.useEffect)((function(){Pe()}),[Pe]);var Le=(0,m.useMemo)((function(){return!!(le&&te&&j)&&(!(we||!function(e){return"addNew"===e}(H))||(!(Ne||!function(e){return"view"===e}(H)||Me||!de)||!(ke||!function(e){return"edit"===e}(H)||Me||!de)))}),[le,te,j,he,Me,de]),Te=(0,m.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";fe(!1),(0,h.getApprovalInfo)({entityNumber:r,businessKey:e||l}).then((function(e){Q((null==e?void 0:e.rows)||[]),fe(!0)}))}),[r,l]);(0,m.useEffect)((function(){r&&l&&!o&&Te()}),[r,l,o,Te]);var De=(0,m.useMemo)((function(){var e={formId:"bos_nocode_bill",targetFormId:r,Status:u||"addNew",pkId:l,procInstId:x,appId:n};return P&&L&&T&&(e.userTaskActivityId=P,e.userTaskBusinessKey=L,e.userTaskCurrentUserId=T),A&&(e.taskId=A),e}),[]),Fe=(0,m.useCallback)((function(){var e;if("cosmic"===M)return(0,f.default)((function(){window.parent.postMessage({pageId:ce,type:"invokeCustomEvent",content:{CloseWindow:"true"}},"*")}),2e3),!1;null!==(e=window.top)&&void 0!==e&&e.close()||Te()}),[]),Oe=(0,m.useCallback)((function(e){if(e){ae(e);var t=null==e?void 0:e.getPageStatus();t&&B(t)}}),[]),je=(0,m.useCallback)((function(e,t,a){var l,u=null==e||null===(l=e.setPkId)||void 0===l?void 0:l[0];if(P&&L)return Fe(),!1;if(u&&!t&&(W(u),Te(u),null!=e&&e.setFormStatus||(null==te||te.setFormStatus("view",a),B("view"))),u&&Y&&u!==Y){var o=[n,"detail",r,u,t?"edit":"view"].join("/");window.location.href=(0,_.getFullPathName)(o)}}),[W,Te,B,te,Y]),qe=(0,m.useCallback)((function(e){B(e)}),[]);return(0,m.useEffect)((function(){te&&(0,_.addUnloadListener)(te)}),[te]),null!=F&&null!==(t=F.rootConfig)&&void 0!==t&&t.pageId?Le?m.default.createElement(v.Navigate,{to:"/noPermission",replace:!0}):m.default.createElement("div",{className:g.default.app_form_detail,style:{background:J}},m.default.createElement("div",{className:(0,I.default)(g.default.box,(0,c.default)({},g.default.has_flow,Me))},m.default.createElement("div",{className:g.default.main},m.default.createElement("div",{className:g.default.bill},m.default.createElement(E.default,{onRef:Oe,config:De,options:{onStatusChange:qe,sendUiData:O,rootConfig:q}})),m.default.createElement("div",{className:g.default.flow},Me&&m.default.createElement(b.default,{taskId:A,data:G,setFormLock:ve,config:De,onSubmit:Fe,bosApi:te})))),m.default.createElement(k.default,{status:H,bosApi:te,authList:{deleteAuth:Se,inputAuth:we,editAuth:ke,viewAuth:Ne},config:De,isSharePage:!j,inputAuthFixed:xe,formLock:me,origin:M,newPkId:Y,setStatus:B,copyCallback:function(){return Q([])},delCallback:Fe,saveCallback:je})):null}}}]);