(self.webpackChunknocode_platform=self.webpackChunknocode_platform||[]).push([[324],{27552:function(e,t,a){"use strict";a.r(t),t.default={success:"_9XUh7nPh_success",dot:"jKJFoPe6_dot",title:"NRcsuMJh_title",state:"NKFmk0JX_state",info:"GGIhTJYm_info",flag:"E6aBzt3v_flag",error:"iyFH6FMi_error",warning:"XUizVfz5_warning",going:"pynC4FIZ_going",reject:"rVwSA6gf_reject",item:"AOlOJisH_item",usr:"+5G4IBAL_usr",editor:"sXJFkmaL_editor",icon:"bNyqF9pn_icon",Auditor:"CWsTQG3Z_Auditor",handler:"OV6hQAAD_handler",des:"+xnDFcZn_des",node:"OZnUlsId_node",launch:"ybdbi0Um_launch",finish:"BlWVwbIL_finish"}},74745:function(e,t,a){"use strict";a.r(t),t.default={footer:"jH6vBe3z_footer",footer_morepanel:"_3xO81pl8_footer_morepanel",footer_btn:"lVD7G3F9_footer_btn",modal_btn:"aL5Kr-Py_modal_btn",err:"hZmbxDx6_err",pop:"N4uBMxnx_pop",modal_body:"-rpyY+M5_modal_body",input:"WRAYX41C_input"}},62964:function(e,t,a){"use strict";a.r(t),t.default={apply:"aWVKeVfC_apply",list:"_2PNIUhVY_list",node:"_5AM5dhQY_node"}},34903:function(e,t,a){"use strict";a.r(t),t.default={container:"giKco2LC_container",main:"DAicFDlH_main",form_detail:"PCN1Yogy_form_detail",form_box:"td4kxZ40_form_box",flow_status:"_0KmFXOgZ_flow_status",small:"CCnM5mh9_small",large:"cHSew3fc_large",running:"dAnwlKnN_running",end:"waeBKkER_end",withdraw:"Cw7PbdwV_withdraw",terminate:"Z4tPjB4P_terminate",exception_terminate:"bspAVv78_exception_terminate",load_more:"uJOh9PF7_load_more"}},34964:function(e,t,a){"use strict";a(25028)(t,"__esModule",{value:!0}),t.FLOW_ACTION_TYPES=void 0;t.FLOW_ACTION_TYPES={consent:"Consent",terminate:"Terminate",reject:"Reject",cancel:"TaskCancel"}},40072:function(e,t,a){"use strict";var l=a(25028),n=a(9564);l(t,"__esModule",{value:!0}),t.default=function(e,t){(0,u.useEffect)((function(){if(e){var a=e&&new r.default(t);return a&&a.observe(e),function(){a&&a.disconnect(e)}}}),[e,t])};var u=a(65984),r=n(a(82504))},20456:function(e,t,a){"use strict";var l=a(13568),n=a(93252),u=a(25028),r=a(4884),d=a(9564);u(t,"__esModule",{value:!0}),t.UserInputItem=t.LaunchItem=t.FlowItem=t.FinishItem=t.AuditItem=void 0;var o=d(a(760)),c=d(a(23992)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=l(e)&&"function"!=typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},d=u&&r;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=d?r(e,o):null;c&&(c.get||c.set)?u(n,o,c):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}(a(65984)),f=a(63548),s=d(a(71252)),m=a(57264),p=a(65873),v=d(a(27552));function h(e){if("function"!=typeof n)return null;var t=new n,a=new n;return(h=function(e){return e?a:t})(e)}var _={willApproval:v.default.warning,willHandled:v.default.warning,approve:v.default.success,handled:v.default.success,done:v.default.success,launch:v.default.success,pass:v.default.success,terminate:v.default.reject,withdraw:v.default.reject,reject:v.default.error,exception_terminate:v.default.error},E={withdraw:"yichexiao",exception_terminate:"cuowushibai",terminate:"foujue2",approve:"tongyi",handled:"tongyi",launch:"tongyi",pass:"tongyi",done:"tongyi"},N=t.FinishItem=(0,i.memo)((function(e){var t=e.item,a=(0,s.default)(v.default.item,v.default.finish,_[t.handleState]||_.handled),l=E[t.handleState]||"right-bold";return i.default.createElement("div",{className:a},i.default.createElement("div",{className:(0,s.default)(v.default.dot,"kdm-nc-flow-dot")},i.default.createElement("p",null,i.default.createElement(f.Icon,{prefix:"nocodeplatformicon",type:l}))),i.default.createElement("div",{className:v.default.info},i.default.createElement("div",{className:v.default.title,style:{marginBottom:0}},i.default.createElement("div",null,i.default.createElement("p",null,t.nodeName)),i.default.createElement("div",{className:v.default.state},t.handleStateDesc),i.default.createElement("div",null,t.message))))})),y=t.LaunchItem=(0,i.memo)((function(e){var t,a,l=e.item;return i.default.createElement("div",{className:(0,s.default)(v.default.item,v.default.launch)},i.default.createElement("div",{className:(0,s.default)(v.default.dot,"kdm-nc-flow-dot")},i.default.createElement("p",null)),i.default.createElement("div",{className:v.default.info},i.default.createElement("div",{className:v.default.editor},i.default.createElement("div",{className:v.default.icon,style:{background:l.bg}},i.default.createElement(p.Avatar,{src:(null===(t=l.approverInfos)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.handlerAvatar)||""})),i.default.createElement("div",{className:v.default.handler},i.default.createElement("div",{className:v.default.usr},i.default.createElement("p",null,(null==l||null===(a=l.approverInfos)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.handlerName)||""),i.default.createElement("span",null,l.handleTime?(0,m.dateFormat)("MM-dd hh:mm",l.handleTime):"")),i.default.createElement("div",null,(null==l?void 0:l.handleStateDesc)||"")))))})),g=t.AuditItem=(0,i.memo)((function(e){var t,a,l=e.item,n=e.className,u=e.config,r=e.curNode,d=l.taskId,h=l.handleTime,N=l.handleState,y=l.nodeName,g=l.handleStateDesc,I=l.approverInfos,b=l.message,w=(0,s.default)(v.default.item,n,_[N]||_.willHandled),k=E[N],C=(0,i.useMemo)((function(){return(null==l?void 0:l.canHandle)&&d!==r.taskId&&"willApproval"===N}),[l,N,r,d]),S=(0,i.useCallback)((function(){var e,t,a,n,r=u.appId,d=u.targetFormId,c=u.pkId;(0,m.openner)((0,o.default)(e=(0,o.default)(t=(0,o.default)(a=(0,o.default)(n="/m/".concat(r,"/detail/")).call(n,d,"/")).call(a,c,"/view/flow/")).call(t,l.procInstId,"/task/")).call(e,l.taskId))}),[l,u]);return i.default.createElement("div",{className:w},i.default.createElement("div",{className:(0,s.default)(v.default.dot,"kdm-nc-flow-dot")},i.default.createElement("p",null)),i.default.createElement("div",{className:v.default.info},i.default.createElement("div",{className:v.default.title},i.default.createElement("div",null,i.default.createElement("p",null,y),C&&i.default.createElement(p.BtnField,{type:"text",major:!0,onClick:S,style:{flex:"none"},icon:{prefix:"nocodeplatformicon",type:"daishenpi"}},"审批")),i.default.createElement("div",{className:v.default.state},g)),"willApproval"===N?i.default.createElement("div",{className:v.default.Auditor},(0,c.default)(I).call(I,(function(e){return i.default.createElement("p",{key:null==e?void 0:e.handlerId},i.default.createElement(p.Avatar,{src:(null==e?void 0:e.handlerAvatar)||""}),i.default.createElement("span",null,(null==e?void 0:e.handlerName)||""))}))):i.default.createElement("div",{className:v.default.editor},i.default.createElement("div",{className:v.default.icon},i.default.createElement(p.Avatar,{src:(null==I||null===(t=I[0])||void 0===t?void 0:t.handlerAvatar)||""}),k&&i.default.createElement(f.Icon,{className:v.default.flag,prefix:"nocodeplatformicon",type:k})),i.default.createElement("div",{className:v.default.handler},i.default.createElement("div",{className:v.default.usr},i.default.createElement("p",null,(null==I||null===(a=I[0])||void 0===a?void 0:a.handlerName)||""),i.default.createElement("span",null,h?(0,m.dateFormat)("MM-dd hh:mm",h):"")),i.default.createElement("div",{className:v.default.des},b||"")))))})),I=t.UserInputItem=(0,i.memo)((function(e){var t,a,l=e.item,n=e.className,u=e.config,r=l.procInstId,d=l.nodeBusinessKey,h=l.nodeId,N=(l.nodeType,l.handleState),y=l.approverInfos,g=l.canInputOrView,I=u||{},b=I.appId,w=I.targetFormId,k=I.pkId,C=I.userTaskActivityId,S=I.userTaskBusinessKey,M=(0,s.default)(v.default.item,n,_[l.handleState]||_.willHandled),x=E[l.handleState],A=(0,i.useMemo)((function(){return(0,c.default)(y).call(y,(function(e){return e.handlerId})).join()}),[y]),F=(0,i.useCallback)((function(e){var t,a,l,n,u,c,i,f=(0,o.default)(t=(0,o.default)(a=(0,o.default)(l=(0,o.default)(n=(0,o.default)(u=(0,o.default)(c=(0,o.default)(i="/m/".concat(b,"/detail/")).call(i,w,"/")).call(c,k,"/")).call(u,e,"/flow/")).call(n,r,"/")).call(l,h,"/")).call(a,d,"/")).call(t,A);(0,m.openner)(f)}),[A,b,w,k,r,h,d,S]),T=(0,i.useMemo)((function(){return!C&&!S&&g}),[C,g,S]);return i.default.createElement("div",{className:M},i.default.createElement("div",{className:(0,s.default)(v.default.dot,"kdm-nc-flow-dot")},i.default.createElement("p",null)),i.default.createElement("div",{className:v.default.info},i.default.createElement("div",{className:v.default.title},i.default.createElement("div",null,i.default.createElement("p",null,l.nodeName),T?"handled"===N?i.default.createElement(p.BtnField,{type:"text",major:!0,style:{flex:"none"},onClick:function(){return F("view")},icon:{prefix:"ncicon",type:"yanjing"}},"查看"):i.default.createElement(p.BtnField,{type:"text",major:!0,style:{flex:"none"},onClick:function(){return F("edit")},icon:{prefix:"nocodeplatformicon",type:"bianji"}},"录入"):null),i.default.createElement("div",{className:v.default.state},l.handleStateDesc)),"willHandled"!==l.handleState&&i.default.createElement("div",{className:v.default.editor},i.default.createElement("div",{className:v.default.icon,style:{background:l.bg}},i.default.createElement(p.Avatar,{src:(null===(t=l.approverInfos)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.handlerAvatar)||""}),x&&i.default.createElement(f.Icon,{className:v.default.flag,prefix:"nocodeplatformicon",type:x})),i.default.createElement("div",{className:v.default.handler},i.default.createElement("div",{className:v.default.usr},i.default.createElement("p",null,(null==l||null===(a=l.approverInfos)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.handlerName)||""),i.default.createElement("span",null,l.handleTime?(0,m.dateFormat)("MM-dd hh:mm",l.handleTime):"")),i.default.createElement("div",{className:v.default.des},(null==l?void 0:l.message)||"")))))})),b=t.FlowItem=(0,i.memo)((function(e){var t=e.item,a=e.className,l=(0,s.default)(v.default.item,a,_[t.handleState]||_.willHandled),n=E[t.handleState];return i.default.createElement("div",{className:l},i.default.createElement("div",{className:(0,s.default)(v.default.dot,"kdm-nc-flow-dot")},i.default.createElement("p",null)),i.default.createElement("div",{className:v.default.info},i.default.createElement("div",{className:v.default.title},i.default.createElement("div",null,i.default.createElement("p",null,t.nodeName)),i.default.createElement("div",{className:v.default.state},t.handleStateDesc)),i.default.createElement("div",{className:v.default.editor},i.default.createElement("div",{className:v.default.icon,style:{background:t.bg}},i.default.createElement(f.Icon,{prefix:"nocodeplatformicon",type:t.icon}),n&&i.default.createElement(f.Icon,{className:v.default.flag,prefix:"nocodeplatformicon",type:n})),i.default.createElement("div",{className:v.default.handler},i.default.createElement("div",{className:v.default.usr},i.default.createElement("p",null,t.handlerName||t.nodeTypeName),i.default.createElement("span",null,t.handleTime?(0,m.dateFormat)("MM-dd hh:mm",t.handleTime):"")),i.default.createElement("div",{className:v.default.des},(null==t?void 0:t.message)||"")))))}));I.displayName="UserInputItem",g.displayName="AuditItem",b.displayName="FlowItem",N.displayName="FinishItem",y.displayName="LaunchItem"},36012:function(e,t,a){"use strict";var l=a(13568),n=a(13939),u=a(34716),r=a(70696),d=a(4884),o=a(3464),c=a(51400),i=a(25028),f=a(93252),s=a(9564);i(t,"__esModule",{value:!0}),t.default=void 0;var m=s(a(23992)),p=s(a(25288)),v=s(a(78912)),h=s(a(96631)),_=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=l(e)&&"function"!=typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},u=i&&d;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=u?d(e,r):null;o&&(o.get||o.set)?i(n,r,o):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}(a(65984)),E=a(18656),N=a(63548),y=a(65873),g=a(98464),I=a(34964),b=s(a(74745)),w=a(16428),k=a(57264);function C(e){if("function"!=typeof f)return null;var t=new f,a=new f;return(C=function(e){return e?a:t})(e)}function S(e,t){var a=n(e);if(u){var l=u(e);t&&(l=r(l).call(l,(function(t){return d(e,t).enumerable}))),a.push.apply(a,l)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){(0,h.default)(e,t,a[t])})):o?c(e,o(a)):S(Object(a)).forEach((function(t){i(e,t,d(a,t))}))}return e}(0,h.default)((0,h.default)((0,h.default)({},I.FLOW_ACTION_TYPES.consent,{title:"审批意见",btn:"同意"}),I.FLOW_ACTION_TYPES.terminate,{title:"审批意见",btn:"否决"}),I.FLOW_ACTION_TYPES.reject,{title:"驳回意见",btn:"驳回"});var x=[{key:I.FLOW_ACTION_TYPES.consent,text:"同意",primary:!0},{key:I.FLOW_ACTION_TYPES.terminate,text:"否决"},{key:I.FLOW_ACTION_TYPES.reject,text:"驳回"},{key:I.FLOW_ACTION_TYPES.cancel,text:"撤回"}],A=(0,_.memo)((function(e){var t,a=e.data,l=void 0===a?{}:a,n=e.curNode,u=e.onSubmit,r=e.bosApi,d=l.canWithdraw,o=void 0!==d&&d,c=(l.notifyMsgMustInput,l.approvalInfo,l.disAllowNodeList,l.procInstId),i=(0,_.useState)(""),f=(0,v.default)(i,2),s=f[0],h=f[1],C=(0,_.useState)(!1),S=(0,v.default)(C,2),A=S[0],F=S[1],T=(0,_.useState)(!1),O=(0,v.default)(T,2),j=O[0],P=O[1],L=(0,_.useState)([]),W=(0,v.default)(L,2),B=W[0],D=W[1],U=(0,_.useState)(!1),Y=(0,v.default)(U,2),H=Y[0],R=Y[1],K=(0,_.useRef)({}),V=(0,_.useRef)({}),z=(0,_.useRef)(!1),Z=(0,_.useMemo)((function(){return(null==n?void 0:n.canHandle)&&!(null==n||!n.taskId)&&"willApproval"===(null==n?void 0:n.handleState)}),[n]),J=(0,_.useMemo)((function(){var e,t=[],a=4;Z&&(null===(e=n.decisionOptions)||void 0===e||e.forEach((function(e,l){var n=e.number,u=e.name,r=e.auditMessageMustInput;u.length>=5&&4===a&&(a=3),t.push({key:n,text:u,primary:0===l,auditMessageMustInput:r})})));o&&t.push(x[3]),Z&&n.canDisallow&&t.push(x[2]);var l=t.length;return(0,m.default)(t).call(t,(function(e,t){var n=l>a&&t>=a-1;return n&&(z.current=!0),M(M({},e),{},{isMoreBtn:n})}))}),[n,Z]),X=(0,_.useCallback)((function(e){return(0,p.default)(e).call(e)?(R(!1),!0):(R(!0),!1)}),[R]),G=(0,_.useCallback)((function(){var e=K.current,t=e.key,a=e.auditMessageMustInput;t&&(a&&!X(s)||r&&r.invokeHandle("click","btnsave",[],[],(function(e,a){if("1001"!==e.errorCode){var l=(0,k.checkMobileSaveActions)(e),r=l.isSuccess;l.actions;if(r){var d=M({action:t,taskId:(null==n?void 0:n.taskId)||"",message:s},V.current);(0,g.taskApply)(d).then((function(){y.WebMsg.showToast({type:0,content:"审批意见提交成功。"}),null==u||u(),(0,w.unstable_batchedUpdates)((function(){h(""),F(!1)}))})).catch((function(e){return y.WebMsg.showToast({type:2,content:"审批意见提交审批失败，".concat(e.message,"。")})}))}}else y.WebMsg.showToast({type:2,content:"表单加载中，请稍候......"})})))}),[null==n?void 0:n.taskId,s,u,X,r]),q=(0,_.useCallback)((function(){(0,g.taskCancel)({procInstId:c}).then((function(){y.WebMsg.showToast({type:0,content:"撤回提交成功"}),F(!1),null==u||u()})).catch((function(e){return y.WebMsg.showToast({type:2,content:"".concat(e.message)})}))}),[l,s,u,c]),Q=(0,_.useCallback)((function(e){K.current={key:I.FLOW_ACTION_TYPES.reject,auditMessageMustInput:!0},V.current={nextNodeId:e.value},(0,w.unstable_batchedUpdates)((function(){F(!0),P(!1)}))}),[l]),$=(0,_.useCallback)((function(){var e=n.disAllowNodeList,t=null==e?void 0:(0,m.default)(e).call(e,(function(e){return{label:e.name,value:e.nodeId}}));(0,w.unstable_batchedUpdates)((function(){D(t||[]),P(!0)}))}),[n,D]),ee=(0,_.useCallback)((function(e){switch(e){case"ok":G();break;case"cancel":(0,w.unstable_batchedUpdates)((function(){h(""),R(!1),F(!1)}))}}),[G,q,$]),te=function(e){var t=e.key;e.auditMessageMustInput;switch(t){case I.FLOW_ACTION_TYPES.reject:$();break;case I.FLOW_ACTION_TYPES.cancel:q();break;default:K.current=e,V.current={},F(!0)}},ae={className:b.default.pop,visible:j,placement:"bottom",title:"驳回至",footer:null,onClose:function(){return P(!1)}},le=(0,_.useMemo)((function(){return _.default.createElement(N.Dropdown.Menu,null,(0,m.default)(J).call(J,(function(e,t){return e.isMoreBtn?_.default.createElement(N.Dropdown.Item,{key:e.key},_.default.createElement(y.BtnField,{type:"text",onClick:function(){return te(e)}},e.text)):null})))}),[J]);return _.default.createElement(_.default.Fragment,null,_.default.createElement("div",{className:b.default.footer},(0,m.default)(J).call(J,(function(e,t){return e.isMoreBtn?null:_.default.createElement("div",{key:e.key,className:b.default.footer_btn},_.default.createElement(y.BtnField,{type:"text",major:!!e.primary,onClick:function(){return te(e)}},e.text))})),z.current&&_.default.createElement(N.Dropdown,{trigger:"hover",menu:le,popperClassName:b.default.footer_morepanel,className:b.default.footer_morepanel},_.default.createElement("div",{className:b.default.footer_btn},_.default.createElement(y.BtnField,{type:"text"},"更多")))),_.default.createElement(E.Modal,{visible:A,title:n.nodeName||"",bodyClassName:b.default.modal_body,content:_.default.createElement("div",{className:b.default.input},_.default.createElement(y.Textarea,{value:s,placeholder:"请输入审批意见",showCount:!0,countPosition:"inner",autoSize:{minRows:3,maxRows:3},onChange:h,maxLength:245}),H&&_.default.createElement("div",{className:b.default.err},"审批意见为必填项")),actions:[{key:"cancel",text:"取消"},{key:"ok",primary:!0,text:(null===(t=K.current)||void 0===t?void 0:t.text)||"确定"}],onAction:function(e,t){return ee(e.key)}}),_.default.createElement(E.Popup,ae,_.default.createElement(y.Select.Content,{onSelect:Q,data:B})))}));A.displayName="MobileFlowDetailFooter";t.default=A},97668:function(e,t,a){"use strict";var l=a(13568),n=a(93252),u=a(25028),r=a(4884),d=a(9564);u(t,"__esModule",{value:!0}),t.default=void 0;var o=d(a(23992)),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=l(e)&&"function"!=typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},d=u&&r;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=d?r(e,o):null;c&&(c.get||c.set)?u(n,o,c):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}(a(65984)),i=a(20456),f=d(a(62964));function s(e){if("function"!=typeof n)return null;var t=new n,a=new n;return(s=function(e){return e?a:t})(e)}var m={NoCodeWfNodeUserInput:i.UserInputItem,NoCodeWfNodeEnd:i.FinishItem,NoCodeWfNodeStart:i.LaunchItem,NoCodeWfNodeAudit:i.AuditItem},p=(0,c.memo)((function(e){var t=e.data,a=e.config,l=e.curNode,n=(t||{}).approvalInfo;return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:f.default.apply},c.default.createElement("div",{className:f.default.list},null==n?void 0:(0,o.default)(n).call(n,(function(e,n){var u=m[e.nodeType]||i.FlowItem;return c.default.createElement(u,{key:e.taskId,curNode:l,className:n===t.length-2?f.default.node:"",item:e,config:a})})))))}));p.displayName="MobileFlowListLayout";t.default=p},83324:function(e,t,a){"use strict";var l=a(13568),n=a(93252),u=a(25028),r=a(4884),d=a(9564);u(t,"__esModule",{value:!0}),t.default=void 0;var o=d(a(38456)),c=d(a(70696)),i=d(a(67584)),f=d(a(78912)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=l(e)&&"function"!=typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},d=u&&r;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var c=d?r(e,o):null;c&&(c.get||c.set)?u(n,o,c):n[o]=e[o]}return n.default=e,a&&a.set(e,n),n}(a(65984)),m=a(41936),p=d(a(34903)),v=d(a(97668)),h=a(98464),_=d(a(36012)),E=a(18656),N=d(a(71252)),y=d(a(40072)),g=d(a(40436)),I=a(16428);function b(e){if("function"!=typeof n)return null;var t=new n,a=new n;return(b=function(e){return e?a:t})(e)}var w=(0,s.lazy)((function(){return a.e(168).then(a.t.bind(a,87168,23))})),k={running:["liuchengxiangqing-jinxingzhong",p.default.running],end:["yiwancheng",p.default.end],withdraw:["liuchengxiangqing-yichehui",p.default.withdraw],terminate:["yifoujue",p.default.terminate],exception_terminate:["yichangzhongzhi",p.default.exception_terminate]},C=(0,s.memo)((function(){var e,t=(0,m.useParams)(),a=t.appId,l=t.targetFormId,n=t.pkId,u=t.procInstId,r=t.Status,d=t.taskId,b=(0,s.useState)({}),C=(0,f.default)(b,2),S=C[0],M=C[1],x=(0,s.useState)(!1),A=(0,f.default)(x,2),F=A[0],T=A[1],O=(0,s.useState)(!1),j=(0,f.default)(O,2),P=j[0],L=j[1],W=(0,g.default)(),B=W.sendUiData,D=W.state,U=(0,s.useState)(r),Y=(0,f.default)(U,2),H=(Y[0],Y[1]),R=(0,s.useState)(null),K=(0,f.default)(R,2),V=K[0],z=K[1],Z=(0,s.useRef)(null);(0,y.default)(Z.current,(function(e){F||(e[0].contentRect.height>230?(0,I.unstable_batchedUpdates)((function(){T(!0),L(!1)})):(0,I.unstable_batchedUpdates)((function(){T(!1),L(!0)})))}));var J=(0,s.useMemo)((function(){var e=(S||{}).approvalInfo;return(d&&e?(0,o.default)(e).call(e,(function(e){return e.taskId===d})):{})||{}}),[d,S]),X=(0,s.useCallback)((function(){(0,h.getApprovalInfo)({entityNumber:l,businessKey:n}).then((function(e){var t,a=(0,c.default)(t=e.rows).call(t,(function(e){return e.procInstId===u}));M(a[0])}))}),[l,n,u]),G=(0,s.useCallback)((function(){L(!P)}),[P]),q=(0,s.useCallback)((function(){X(),(0,i.default)((function(){return window.history.go(-1)}),2e3)}),[X]),Q=(0,s.useCallback)((function(e){if(e){z(e);var t=null==e?void 0:e.getPageStatus();t&&H(t)}}),[]),$=(0,s.useCallback)((function(e){H(e)}),[]);(0,s.useEffect)((function(){X()}),[]);var ee=(S||{}).processStatus,te={appId:a,targetFormId:l,pkId:n,Status:r,formId:"bos_nocode_bill",procInstId:u,taskId:d},ae=(null==k?void 0:k[null==ee?void 0:ee.handleState])||k.running,le=ae[0],ne=(0,N.default)(p.default.flow_status,ae[1]);return null!=D&&null!==(e=D.rootConfig)&&void 0!==e&&e.pageId?s.default.createElement("div",{className:p.default.container},s.default.createElement("div",{className:p.default.main},s.default.createElement("div",{className:p.default.form_detail},s.default.createElement("div",{ref:Z,className:p.default.form_box},s.default.createElement("div",{className:ne},s.default.createElement(E.Icon,{prefix:"nocodeplatformicon",type:le})),s.default.createElement("div",{style:P?{}:{height:230,overflow:"hidden"}},s.default.createElement(w,{onRef:Q,config:te,device:"mobile",options:{onStatusChange:$,labelDirection:"h",sendUiData:B,rootConfig:D.rootConfig}})),F&&s.default.createElement("div",{className:p.default.load_more,onClick:G},s.default.createElement(E.Icon,{type:P?"arrow-up":"arrow-down"})))),s.default.createElement(v.default,{data:S,curNode:J,config:te})),s.default.createElement(_.default,{data:S,curNode:J,onSubmit:q,bosApi:V})):null}));t.default=C},71252:function(e,t){var a;!function(){"use strict";var l={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var a=arguments[t];a&&(e=r(e,u(a)))}return e}function u(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var a in e)l.call(e,a)&&e[a]&&(t=r(t,a));return t}function r(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}()}}]);