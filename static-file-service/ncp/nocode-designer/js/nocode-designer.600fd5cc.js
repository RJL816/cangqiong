!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["nocode-designer"]=t():e["nocode-designer"]=t()}(self,(function(){return function(){var e,t,n={5724:function(e,t,n){"use strict";n.r(t),n.d(t,{NoCodeDesigner:function(){return Fd}});var r={};n.r(r),n.d(r,{addCache:function(){return Oi},addControlCache:function(){return Li},clearCache:function(){return ji},deleteControlCache:function(){return Vi},getControlCache:function(){return Ui},hasCache:function(){return Bi},hasControlCache:function(){return Ki}});var o=n(4716),a=n.n(o),i=n(4884),l=n.n(i),c=n(7435),u=n.n(c),s=n(8264),f=n(2992),d=n(3939),p=n.n(d),v=n(696),m=n.n(v),g=n(1908),h=n.n(g),y=n(760),b=n.n(y),C=n(2581),E=n.n(C),I=n(3992),x=n.n(I),N=n(2400),T=n.n(N),A=n(524),S=n.n(A),w=n(5984),F=n.n(w),k=n(8040),D=n.n(k),P=n(3548),M=n(5992),R=n(2664),_="Id",O="FieldType",B="FieldId",j="EntryId",L="_Type_",U="Value",K="Label",V="ParentId",z="Items",G="Bgc",H="data-control-id",q="data-drag-id",Y="data-drag-over",W="data-selection",Q="data-mouse-over",X="data-cut-control",Z="data-is-dragging",J="data-right-drag-style",$="data-drag-direction",ee="data-outline-drag-tree-node",te="data-change-name",ne=function(e){return e?(0,f.c)({},H,null==e?void 0:e[_]):{}},re=n(6428),oe=n.n(re),ae=F().createContext({});ae.displayName="DesignerContext";var ie=function(e){var t=(0,w.useContext)(ae),n=(t.prefixCls,t.getKdesignerApi),r=(t.invokeAction,t.fieldStatusSettingMode),o=(0,w.useMemo)((function(){return n()}),[]),a=o.selection,i=o.data,l=a.setSelect,c=(0,w.useMemo)((function(){return i.getRootId()}),[]),u=((0,w.useRef)(null),(0,w.useRef)(null),(0,w.useCallback)((function(e){var t;e.stopPropagation();var n=e.currentTarget.dataset,o=n.controlId,a=n.enableClick;if(!r||c!==o&&"false"!==a){var i=document.querySelectorAll(b()(t="[".concat(H,'="')).call(t,o,'"]'))[0];null==i||i.setAttribute(Q,"true")}}),[r])),s=(0,w.useCallback)((function(e){var t;e.stopPropagation();var n=e.currentTarget.dataset.controlId;document.querySelectorAll(b()(t="[".concat(H,'="')).call(t,n,'"]'))[0].removeAttribute(Q)}),[]);return{onMouseOver:u,onMouseOut:s,onContextMenu:function(e){e.stopPropagation();var t=e.currentTarget.dataset,n=t.controlId,o=t.selection;if(i.getRootId()!==n){var a=i.findControl(n);r||(e.preventDefault(),o||l([n]),k.eventBus.emit("contextmenu",{event:e,field:a}))}}}},le=n(1260),ce=n.n(le);function ue(e){var t=e||window.event;return k.OS===k.MAC?t.metaKey:t.ctrlKey}var se,fe,de=n(3440),pe=n.n(de),ve=n(9992),me=n.n(ve),ge=n(600),he=n.n(ge),ye=n(4984),be=n(8496),Ce=n(7348),Ee=n.n(Ce),Ie=n(2272),xe=n.n(Ie),Ne=n(8456),Te=n.n(Ne),Ae=n(3980),Se=n.n(Ae),we=n(644),Fe=n.n(we),ke=function(e){return e.DEFAULT="1",e.DISABLED="2",e.READONLY="3",e.HIDDEN="4",e}({}),De=n(2892),Pe=n.n(De),Me="nocode-designer",Re=["ParentId","Id"],_e="entity",Oe="all",Be="nocode-designer-main-root",je="System_",Le="NoCodeGroupContainerAp",Ue="NoCodeBizButtonAp",Ke="BizBtnFlexPanelAp",Ve="NoCodeBillFormAp",ze="NoCodeEntryEntity",Ge="NoCodeRefBillTable",He=[Ue,Le],qe=b()(se=[Ge,ze,Le,Ue]).call(se,["NoCodeBillNoField","NoCodeCreateDateField","NoCodeCreatorField","NoCodeModifyDateField","NoCodeModifierField"]),Ye={"#276FF5":"#F2F9FF","#16AFF1":"#F2FDFF","#16B8B0":"#F2FFFC","#FDC200":"#FFFDE6","#77C404":"#FAFFEB","#1BA854":"#F2FFF5","#FF991C":"#FFFBF2","#FF5F1F":"#FFF8F2","#FB2323":"#FFF4F2","#F90D58":"#FFF2F4","#701DF0":"#F9F2FF","#0E5FD8":"#F2F9FF"},We=[{name:"经典",primaryColor:"#276FF5"},{name:"都市",primaryColor:"#701DF0"},{name:"夜幕",primaryColor:"#0E5FD8"},{name:"沙漠",primaryColor:"#FF5F1F"},{name:"雪山",primaryColor:"#276FF5"},{name:"港湾",primaryColor:"#F90D58"},{name:"高尔夫",primaryColor:"#1BA854"},{name:"乡野",primaryColor:"#16B8B0"}],Qe=["UploadDefValue","PictureDefValue","NoCodeDefValue","FieldRequired","Status","Visibility"],Xe=function(e){return e.DEFAULT="1",e.DISABLED="2",e.READONLY="3",e.HIDDEN="4",e}({}),Ze=function(e){return"NoCodeDateRangeField"===e},Je=function(e){return"NoCodeDateField"===e},$e=function(e){return(null==e?void 0:S()(e).call(e,"NoCodeRefBillField"))||(null==e?void 0:S()(e).call(e,"NoCodeMulRefBillField"))},et=function(e){var t;return S()(t=["NoCodeCreatorField","NoCodeModifierField"]).call(t,e)},tt=function(e){var t;return S()(t=["NoCodeCreatorField","NoCodeCreateDateField","NoCodeModifierField","NoCodeModifyDateField","NoCodeBillNoField"]).call(t,e)},nt=function(e){var t;return S()(t=["NoCodeCreatorField","NoCodeCreateDateField","NoCodeModifierField","NoCodeModifyDateField"]).call(t,e)},rt=function(e){return"NoCodeImageUploadField"===e},ot=function(e){return"NoCodeAttachmentUploadField"===e},at=function(e){return"NoCodeEntryEntity"===e},it=function(e){return"NoCodeRefBillTable"===e},lt=function(e){return"NoCodeBillFormAp"===e||"NoCodeBillEntity"===e},ct=function(e){return e===Ue||e===Ke},ut=function(e){return"NoCodeSelectItemField"===e},st=function(e){return"NoCodeRichTextField"===e},ft=function(e){return"NoCodeGraphicDisplayField"===e},dt=function(e){return e&&Date.parse(e)?new Date(e):null},pt=function(e){if(!e)return null;var t=(e=function(e){return e?p()(e).reduce((function(t,n){return t[(0,we.lowerFirst)(n)]=e[n],t}),{}):e}(e))||[],n=t.start,r=void 0===n?"":n,o=t.end,a=void 0===o?"":o;return[dt(r),dt(a)]},vt=function(e){return"hide"===e},mt=function(e,t){if(!t)return"";var n,r=t._Type_;return ut(r)?b()(n="".concat(e,"[")).call(n,Pt(t.SelectItemType)?"多选":"单选","]"):$e(r)?function(e,t){var n;return b()(n="".concat(e,"[")).call(n,t?"多条":"单条","]")}(e,Pt(t.Multi)):e},gt=function(e){return"NoCodeGroupContainerAp"===e},ht=n(9480),yt=n.n(ht),bt=n(2504),Ct=["children"],Et=["children","valueItems","billEntityId","displayProp","isMulti","compareTypes","refSelf"];function It(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}function Nt(e,t){var n=void 0!==me()&&he()(e)||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return Tt(e,t);var r=Se()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return pe()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function Tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var At=["FieldName","TableName","Key"],St=function(e){return e?Array.isArray(e)?e:[e]:[]},wt=function(e,t){var n=(0,we.cloneDeep)(e),r=n._Type_,o=n.EntityData;n[V]=t;var a=(0,k.createUUid)();if(n[_]=a,o&&(n.EntityData[_]=a,n.EntityData[V]=t,n[B]&&(n[B]=a),n[j]&&(n[j]=a)),Ze(r)){Ee()(n,"EndDateFieldKey"),Ee()(n,"EndDateFieldName"),Ee()(n,"StartDateFieldKey"),Ee()(n,"StartDateFieldName");var i=yt()(o,(function(e){Ee()(e,"EndDateFieldKey"),Ee()(e,"EndDateFieldName"),Ee()(e,"StartDateFieldKey"),Ee()(e,"StartDateFieldName")}));xe()(n,"EntityData",i)}if(at(r)){Ee()(n,"TableName");var l=yt()(o,(function(e){Ee()(e,"TableName")}));xe()(n,"EntityData",l)}return Ut(r)&&(Number(n.GroupIndex)>0?n.GroupIndex=Number(n.GroupIndex)+1:(n.GroupParentId=(0,k.createUUid)(),n.GroupIndex=0)),n.Inherit&&(n.Inherit=!1),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:At;return null==t||t.forEach((function(t){e[t]&&delete e[t],e.EntityData&&e.EntityData[t]&&Ee()(e.EntityData,t)})),e}(n)},Ft=function e(t,n,r){var o,a,i=n.Id,l=wt(n,r),c=m()(o=t[z]).call(o,(function(e){return e[V]===i}));return b()(a=[l]).call(a,(0,we.flattenDeep)(x()(c).call(c,(function(n){return e(t,n,l[_])}))))},kt=function(e){var t;return S()(t=["default","hidden","disabled","readonly","mustInput"]).call(t,e)},Dt=function(e){var t=e.SelectItemType,n=e.CustomContent,r=e.DefValue;if(!Array.isArray(n))return"";if("0"===t){var o=Te()(n).call(n,(function(e){return e.Value===r}));return(null==o?void 0:o.Label)||""}if("1"===t){var a=[],i=r.split(",");return n.forEach((function(e){null!=i&&S()(i).call(i,null==e?void 0:e.Value)&&a.push(e.Label)})),a.join(",")}return""},Pt=function(e){return"1"===(0,we.toString)(e)},Mt=function(e){if(!e)return"Select";var t=e.DropDownOrTilePc,n=e.SelectItemType;return"1"===(0,we.toString)(t)?Pt(n)?"Checkbox":"Radio":"Select"},Rt=function(e){var t,n=e.CustomContent;if(!n)return[];var r=Array.isArray(n)?n:(null==n?void 0:n.ops)||[];return m()(t=(null==r?void 0:x()(r).call(r,(function(e){return{label:null==e?void 0:e[K],value:null==e?void 0:e[U],color:null==e?void 0:e[G]}})))||[]).call(t,(function(e){return e.label}))||[]},_t=function(e){var t=e.CustomContent;return!!t&&(!Array.isArray(t)&&(null==t?void 0:t.bgcSwitch))},Ot=function(e){var t=e.SelectItemType,n=e.NoCodeDefValue;return Pt(t)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e?null==e?void 0:e.split(t||","):[]}(n,","):n},Bt=function(e){return void 0!==e&&0==+e},jt=function(e,t){var n,r=e.formmeta,o=null==r||null===(n=r.Items)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.SysSetting;return o?JSON.parse(o):function(e){var t=e.Categories,n=void 0===t?[]:t;return m()(n).call(n,(function(e){var t;return null==e||null===(t=e.Id)||void 0===t?void 0:h()(t).call(t,je)})).reduce((function(e,t){return e[t.Id]=!1,e}),{})}(t)},Lt=function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t},Ut=function(e){return e===Le},Kt=function(e){var t=e.split("."),n=/\B(?=(\d{3})+(?!\d))/g;if(2===t.length){var r,o=(0,s.c)(t,2),a=o[0],i=o[1];return b()(r="".concat(a.replace(n,","),".")).call(r,i)}return t[0].replace(n,",")},Vt=null===(fe=window.location.search)||void 0===fe||null===(fe=fe.match(/(^|&|\?)kdcdc=([^&]*)(&|$)/i))||void 0===fe?void 0:fe[2],zt=function(e){return e?!S()(e).call(e,"kdcdc")&&Vt?e+(S()(e).call(e,"?")?"&":"?")+"kdcdc="+Vt:e:""},Gt=function(e){if(e)return window.__domainurl__+("/"===e[0]?Se()(e).call(e,1):e)},Ht=function(e,t){return t?t.indexOf("background")>-1?Gt(t):e+t:t};var qt=function(e){if("string"!=typeof e)return!1;try{var t=JSON.parse(e);return!("object"!=(0,be.c)(t)||!t)}catch(e){return!1}},Yt=function(e){return e&&qt(e)?0===(e=JSON.parse(e)).valueType&&e.value||"":e},Wt=function(e){if(!(0,we.isUndefined)(e)){var t=e.start,n=e.end;return{start:Yt(t),end:Yt(n)}}},Qt=function(e){return qt(e)?JSON.parse(e):{}},Xt=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NoCodeDefValue",r=xt({},e);return r[n]&&(r=xt(xt({},r),{},(0,f.c)({},n,"DateRangeDefValue"===n?Wt(r[n]):Yt(r[n])))),null!==(t=r.EntityData)&&void 0!==t&&t[n]&&(r=xt(xt({},r),{},{EntityData:xt(xt({},r.EntityData),{},(0,f.c)({},n,"DateRangeDefValue"===n?Wt(r[n]):Yt(r[n])))})),r},Zt=function(e,t){var n=e.PropsDisplay,r=e.DataRange,o=e.BillEntityIdEx,a=e.Multi,i=e._Type_,l=(e.Status,e.MustInput),c=(e.EmptyText,e.Key),u=e.Name,s=e.DefaultDisplay,f=e.Id,d=e.FieldType,p=1===parseInt(a),v=et(i)?"bos_user":o||t.getControlPropertyDefaultValue(d,"BillEntityIdEx");return{displayProp:n||t.getControlPropertyDefaultValue(d,"PropsDisplay"),dataRange:r,isMulti:p,entityId:v,type:($e(i)||it(i)?"NoCodeMulRefBillField":i).toLowerCase(),id:f,allowClear:!0,mustInput:l,key:c,name:u,defaultDisplay:s,showSelected:!0,disabled:!1,readonly:!1,hidden:!1}},Jt=function e(t,n,r){return(t||[]).reduce((function(t,o){var a,i,l=o.id,c=o.option,u=void 0===c?{}:c,s=u.children,f=(0,ye.c)(u,Ct),d=b()(a="".concat(n,".")).call(a,l),p=null!=d&&S()(d).call(d,"fbasedataid")?l.split(".fbasedataid")[0]:d;if(((null==p||null===(i=p.split("."))||void 0===i?void 0:i.length)||0)>r)return t;var v=xt({},f);s&&(v.children=e(s,n,r));var m=xt(xt({},o),{},{id:d,option:v||{}});return b()(t).call(t,m)}),[])},$t=function e(t,n,r){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return m()(o=(n||[]).reduce((function(n,o){var i,l,c=o.caption,u=o.type,s=o.id,f=o.option,d=void 0===f?{}:f,p=o.typeCaption,v=null!=s&&S()(s).call(s,"fbasedataid")?s.split(".fbasedataid")[0]:s,m=(null==v||null===(i=v.split("."))||void 0===i?void 0:i.length)||0;if("group"!==u&&m>a)return n;var g=d.children,h=d.valueItems,y=d.billEntityId,C=d.displayProp,E=d.isMulti,I=(d.compareTypes,d.refSelf),x=(0,ye.c)(d,Et),N=function(e){return null==e?void 0:e.split("-")[0]}(u).toLowerCase(),T=function(e){var t=e.compareTypesMap,n=e.type,r=e.entityId,o=t[n]||[];return"bos_user"===r?o="nocodecreatorfield":"bos_adminorg"===r&&(o="orgfield"),"string"==typeof o&&(o=t[o]),o}({compareTypesMap:r,type:N,entityId:y}),A=s,w=xt({title:c,key:A,compareTypes:T,type:u,titlePrefix:p,selectable:"group"!==u},x);return $e(u)||et(u)||it(u)?w=(0,R.c)(w,{displayProp:C,entityId:y,isMulti:E}):ut(u)&&(w=(0,R.c)(w,{isMulti:E})),h&&(w.items=h),g?w.children=e(t,g,r,a):!0===I&&(w.children=e(t,Jt(t,A,a),r,a)),"group"!==u||null!==(l=w)&&void 0!==l&&null!==(l=l.children)&&void 0!==l&&l.length?b()(n).call(n,w):n}),[])).call(o,(function(e){var t=e.type,n=e.entityId;return!$e(t)&&!et(t)||null!==n}))},en=function(e,t,n){var r,o=document.querySelector(b()(r="[".concat(H,'="')).call(r,e,'"]'));o&&(o.setAttribute(H,t),null==n||n(o))},tn=function(e,t,n){if(t){var r=t.GroupParentId,o=t.GroupIndex,a=t.Id,i="forward"===n?-1:1,l=e.findControlByCondition((function(e){return e.GroupParentId===r}));if("forward"!==n||0!==Number(o))if("back"!==n||Number(o)!==l.length-1){var c=Te()(l).call(l,(function(e){return Number(e.GroupIndex)===Number(o)+i}));if(c){var u=xt(xt({},t),{},{GroupIndex:c.GroupIndex});e.insertControl((0,k.createInsertAction)({targetId:c.Id,values:[u],isPre:"forward"===n})).then((function(t){var n=[[c.Id,{GroupIndex:o}]];e.batchUpdateControlPropertyValues((0,k.createUpdateAction)(n))}))}}else{var s=e.getNextSibling(a).control;if(!s)return;if(Ut(s._Type_)){var f,d=e.findControlByCondition((function(e){return e.GroupParentId===s.GroupParentId}));if(null!=d&&d.length)e.insertControl((0,k.createInsertAction)({targetId:null===(f=d[d.length-1])||void 0===f?void 0:f.Id,values:l,isPre:!1}))}else e.insertControl((0,k.createInsertAction)({targetId:s.Id,values:l,isPre:!1}))}else{var p=e.getPrevSibling(a).control;if(!p)return;if(Ut(p._Type_)){var v,m=e.findControlByCondition((function(e){return e.GroupParentId===p.GroupParentId}));if(null!=m&&m.length)e.insertControl((0,k.createInsertAction)({targetId:null===(v=m[0])||void 0===v?void 0:v.Id,values:l,isPre:!0}))}else e.insertControl((0,k.createInsertAction)({targetId:p.Id,values:l,isPre:!0}))}}},nn={NoCodeTextField:"文本",NoCodeTextAreaField:"文本",NoCodeCreateDateField:"日期",NoCodeModifyDateField:"日期",NoCodeBillNoField:"文本"},rn=function(e,t,n,r){var o,a,i=e._Type_,l=e.Multi,c=e.SelectItemType,u=e.Name,s=e.Key,f=e.BillEntityIdEx;if($e(i)){var d,v,m=Te()(d=p()(t)).call(d,(function(e){return S()(s).call(s,e)}));if(m)return t[m]||"";var g=f||n.getControlPropertyDefaultValue(i,"BillEntityIdEx");return b()(v="[".concat(r[g]||"","]")).call(v,1==l?"[多条]":"[单条]")}if(it(i))return b()(a="[".concat(u||"-","]")).call(a,1==l?"[多条]":"[单条]");if(ut(i))return"[选项]".concat(1===c?"[多选]":"[单选]");if("NoCodeCreatorField"===i||"NoCodeModifierField"===i)return"[人员][单条]";var h=nn[i]||(null===(o=n.getControlMeta(i))||void 0===o?void 0:o.Name);return"[".concat(h,"]")},on=function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Nt(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,i=a.titlePrefix,l=a.key,c=a.children,u=a.type;if(c&&e(c,r),$e(u))r[l.split(".").pop()]=i||""}}catch(e){o.e(e)}finally{o.f()}return r},an=function(e,t){var n,r=x()(n=m()(e).call(e,(function(e){return Ut(null==e?void 0:e._Type_)}))).call(n,(function(e){return e.Id}));return r.length&&e.forEach((function(e){if(S()(r).call(r,e.ParentId)&&e.EntityData){var n=xt(xt({},e.EntityData),{},{ParentId:t});e.EntityData=n}})),e},ln=function(){var e=(0,w.useContext)(ae),t=e.getKdesignerApi,n=e.fieldStatusSettingMode,r=(0,w.useMemo)((function(){return t()}),[]),o=r.data,a=r.selection,i=a.setSelect,l=a.appendSelect,c=a.getSelection,u=(0,w.useCallback)((function(e){e.stopPropagation();var t=o.getRootId(),r=c(),a=function(e){for(;!e.dataset.controlId&&"ui-designer-root"!==e.id;)e=e.parentNode;return e}(e.target).dataset,u=a.controlId,s=a.enableClick;if(!n||t!==u&&"false"!==s){var f=!0;if(r.length>0&&(f=o.isSiblings(r[0],u)),f||!ue(e))if(ue(e)){var d=r.indexOf(u);if(d>=0){var p=(0,M.c)(r);ce()(p).call(p,d,1),p.length>0&&i(p)}else l([u])}else i([u])}}),[n]);return u},cn="zidingyifuwu",un={NoCodeTextField:"wenben",NoCodeTextAreaField:"duoxingwenben",NoCodeDateField:"riqi4",NoCodeDecimalField:"shuzhi",NoCodeSelectItemField:"xuanxiang",NoCodeRefBillField:"duoxuanjichuziliao",NoCodeMulRefBillField:"duoxuanjichuziliao",NoCodeAddressFormatField:"dizhi",NoCodeDateRangeField:"riqi4",NoCodeEntryEntity:"biaoge16",NoCodeRefBillTable:"biaoge16",NoCodeRichTextField:"fuwenbenbianjiqi",NoCodeGEOField:"dizhi",NoCodeImageUploadField:"tupian3",NoCodeAttachmentUploadField:"fujian2",NoCodeGraphicDisplayAp:"tuwen",NoCodeBillListAp:"biaodanliebiao",NoCodeCountDownAp:"daojishi",NoCodeMapAp:"ditu",NoCodeCreateDateField:"chuangjianriqi2",NoCodeCreatorField:"chuangjianren2",NoCodeModifyDateField:"xiugairiqi2",NoCodeModifierField:"xiugairen2",NoCodeBillNoField:"bianma",EntryEntity:"biaodanliebiao",GridContainerAp:"zhagerongqi",MessageCarouselContainerAp:"lunborongqi",TabPageAp:"yeqian2",ButtonAp:"anniu3",VectorAp:"zititubiao",ToolbarAp:"gongjulan",NoCodeBizButtonAp:"anniu3",NoCodeGraphicDisplayField:"tuwen",NoCodeGroupContainerAp:"fenzurongqi"};function sn(e,t){return $e(e)?"duoxuanjichuziliao":un[e]||t||cn}var fn=null;function dn(e,t){var n;!function(){fn&&document.body.removeChild(fn);fn=null}(),fn=document.createElement("div");var r=sn(e),o=b()(n='\n    <i class="designericon designericon-'.concat(r,'" style="font-size:20px;vertical-align: -3px"></i>\n    ')).call(n,t,"\n  ");return fn.innerHTML=o,fn.style.cssText="position:absolute;top:-9999px;left:-9999px;opacity:1!important;width: 124px;height: 32px;line-height: 32px;padding: 0 8px;background: #fff;box-shadow: '0px 4px 12px 0px rgba(40,50,70,0.2)';border-radius: 4px;box-sizing: border-box;",document.body.appendChild(fn),fn}var pn=function(e,t,n){e.dataTransfer&&e.dataTransfer.setDragImage&&(e.dataTransfer.dropEffect="move",e.dataTransfer.setDragImage(dn(t,n),-20,-24))},vn=n(9308),mn=n.n(vn),gn=n(4244),hn=n.n(gn),yn=function(e){for(var t=null;;){var n;if(e.dataset.dragId){t=e;break}if(!("kd-nc-grid-panel"!==e.className||null!==(n=e)&&void 0!==n&&null!==(n=n.dataset)&&void 0!==n&&n.groupContainerItem))break;e=e.parentNode}return t},bn=function(e){for(;!e.dataset.groupBarItemId&&"ui-designer-root"!==e.id;)e=e.parentNode;return e},Cn=["data-left-drag-style",J,"data-top-drag-style","data-bottom-drag-style",$],En=function(e){Cn.forEach((function(t){return e.removeAttribute(t)}))},In=function(){setTimeout((function(){var e,t=(0,M.c)(new(mn())(b()(e=[]).call(e,(0,M.c)(document.querySelectorAll("[".concat($,"]"))),(0,M.c)(document.querySelectorAll("[".concat(Y,"]"))))));t.length&&t.forEach((function(e){En(e),e.removeAttribute(Y)}))}),200)},xn=null,Nn="",Tn=!1,An=function(e){Nn=e},Sn=function(e){xn=e},wn=function(){var e=(0,w.useContext)(ae),t=e.getKdesignerApi,n=e.pubUIAction,r=t(),o=r.data,a=r.selection,i=r.meta,l=r.dataFactory,c=(0,w.useContext)(k.GlobalConfigContext),u=c.env,s=c.showMessage,f=o.getRootId(),d=document.querySelector(".kd-row"),p=function(e,t){var n=Array.isArray(e)?e:[e];return o.getAllParentControlIds(t).some((function(e){return S()(n).call(n,e)}))},v=(0,w.useCallback)((function(e,t,r){var c=(r||{}).isPrev,s=void 0!==c&&c,d=u[k.CONTROL_DRAG_DATA].data,p=(void 0===d?{}:d).Id,v=o.findControl(e),m=-1;if(e===f)m=s?1:-1;else{var g=o.findControlIndex(e);if(s)m=g;else{var h,y=o.getSubControls(e),b=y.length;if(b>0)m=o.findControlIndex(null===(h=y[b-1])||void 0===h?void 0:h[_])+1;else m=g+1}}var C=v[L],E=i.getControlMeta(C).IsContainer,I=void 0!==E&&E?e:o.getParentControlId(e)||f,x=o.findControl(I)[L],N=i.canAdd(p,x);if(N&&!1!==(null==N?void 0:N.success)){if(n({eventName:"drag",action:"fd_add_drag"}),Ut(C))return function(e,t){var n,r,i=u[k.CONTROL_DRAG_DATA].data,c=(void 0===i?{}:i).Id,s=t.Id,f=(t.ParentId,null===(n=bn(e))||void 0===n?void 0:n.getAttribute("data-group-bar-item-id"));if(Ut(c)){if(f){(r=l({type:c,parentId:o.getParentControlId(s),transferData:{Key:"nc_".concat((0,k.createUUid)().toLowerCase())}})).GroupParentId=t.GroupParentId,r.GroupIndex=Number(t.GroupIndex)+1;var d=f;if(e.getAttribute("data-group-bar-item-id"))d=e.getAttribute("data-group-bar-item-id");else{var p,v=hn()(p=o.findControlByCondition((function(e){return e.GroupParentId===t.GroupParentId}))).call(p,(function(e,t){return Number(e.GroupIndex)-Number(t.GroupIndex)}));d=v[v.length-1].Id}return void o.insertControl((0,k.createInsertAction)({targetId:d,values:[r],isPre:!1},{isInstrucAdd:!0})).then((function(e){a.setSelect(r.Id)}))}(r=l({type:c,parentId:s})).GroupParentId=(0,k.createUUid)(),r.GroupIndex=0}else r=l(f?{type:c,parentId:f}:{type:c,parentId:s});o.addControl((0,k.createAddAction)(r)).then((function(e){a.setSelect(r.Id)})),delete u[k.CONTROL_DRAG_DATA]}(t,v);var T=l({type:p,parentId:I});o.addControl((0,k.createAddAction)(T,{index:m})).then((function(e){var t=e[0].value;a.setSelect(Array.isArray(t)?[t[0][_]]:[t[_]])})),delete u[k.CONTROL_DRAG_DATA]}}),[u[k.CONTROL_DRAG_DATA],n]),m=(0,w.useCallback)((function(e){var t,n,r,a,l;e.stopPropagation();var c=document.querySelector(b()(t="[".concat(H,"='")).call(t,f,"']")),m=u[k.CONTROL_DRAG_DATA];if(c&&(xn||m)){var g=xn||[];null==e||e.currentTarget.removeAttribute(Z),Sn(null),An("");var h=e.target,y=g[0],C=o.findControl(y),E=e.target,I=(E=null!==(n=e.target)&&void 0!==n&&null!==(n=n.dataset)&&void 0!==n&&n.tabsHeader&&Ut(y?null==C?void 0:C._Type_:null===(r=m.data)||void 0===r?void 0:r.Id)?E.lastChild:yn(e.target)).dataset.dragId||"";if(!(g&&(null==g?void 0:g.length)>0&&p(g,I))){var N=(null===(a=E.dataset)||void 0===a?void 0:a.dragDirection)||"right",T=!1;if(En(E),S()(l=["top","left"]).call(l,N)&&(T=!0),!(S()(g).call(g,I)||I===f&&null!=d&&d.contains(h))){if(null!=g&&g.length){var A=o.findControl(I),w=A._Type_;if(Ut(w))return function(e,t){for(var n,r=e.dropControl,o=e.dragControlIds,a=e.dataContext,l=(r.ParentId,r.Id),c=r._Type_,u=bn(t).getAttribute("data-group-bar-item-id"),f=l,d=[],v=[],m=[],g=function(){var e=o[h],t=a.findControl(e),n=a.findControl(t.ParentId);if(n&&it(n._Type_))return s("表格的内容无法移动到表格之外"),{v:void 0};if(p(e,l))return{v:void 0};var g=a.findControl(e),y=g._Type_,b=(g.ParentId,g.GroupIndex),C=g.GroupParentId,E=i.canAdd(y,c);if("object"===(0,be.c)(E)&&!E.success)return{v:s(E.message)};if(Ut(y))if(u){if(g.GroupParentId!==r.GroupParentId){var I,N,T={GroupParentId:r.GroupParentId,GroupIndex:Number(r.GroupIndex)+1,ParentId:r.ParentId};v.push([g.Id,T]);var A=hn()(I=a.findControlByCondition((function(e){return e.GroupParentId===r.GroupParentId}))).call(I,(function(e,t){return Number(e.GroupIndex)-Number(t.GroupIndex)}));ce()(A).call(A,Number(r.GroupIndex)+1,0,g),null==A||A.forEach((function(e,t){Number(e.GroupIndex)!==t&&v.push([e.Id,{GroupIndex:t}])}));var S=hn()(N=a.findControlByCondition((function(e){return e.GroupParentId===g.GroupParentId&&e.Id!==g.Id}))).call(N,(function(e,t){return Number(e.GroupIndex)-Number(t.GroupIndex)}));null==S||S.forEach((function(e,t){Number(e.GroupIndex)!==t&&v.push([e.Id,{GroupIndex:t}])}))}else{var w,F=hn()(w=a.findControlByCondition((function(e){return e.GroupParentId===r.GroupParentId&&e.Id!==g.Id}))).call(w,(function(e,t){return Number(e.GroupIndex)-Number(t.GroupIndex)}));Number(r.GroupIndex)<Number(g.GroupIndex)?ce()(F).call(F,Number(r.GroupIndex)+1,0,g):ce()(F).call(F,Number(r.GroupIndex),0,g),null==F||F.forEach((function(e,t){Number(e.GroupIndex)!==t&&v.push([e.Id,{GroupIndex:t}])}))}m.push({Id:e})}else{m.push({Id:e,ParentId:l});var D=a.findControl(f).Status;if(void 0!==D){var P=a.getAllSubControlIds(e);d.push.apply(d,(0,M.c)(x()(P).call(P,(function(e){return[e,{Status:D}]}))))}if(1===o.length&&void 0!==b&&C){var R=a.findControlByCondition((function(t){return t.GroupParentId===C&&t.Id!==e}));if(R.length>0&&(d.push([e,{GroupIndex:0,GroupParentId:(0,k.createUUid)()}]),0===Number(b))){var _=x()(R).call(R,(function(e,t){return[e.Id,{GroupIndex:t}]}));d.push.apply(d,(0,M.c)(_))}}}else u?d.push([e,{ParentId:u}]):d.push([e,{ParentId:l}])},h=0;h<o.length;h++)if(n=g())return n.v;v.length>0&&a.batchUpdateControlPropertyValues((0,k.createUpdateAction)(v),!1),m.length>0&&a.insertControl((0,k.createInsertAction)({targetId:f,values:m,isPre:!1})),d.length>0&&a.batchUpdateControlPropertyValues((0,k.createUpdateAction)(d)),In()}({dropControl:A,dragControlIds:g,dataContext:o},E);o.swapControl((0,k.createSwapAction)({origin:g,target:I,isPrev:T})).then((function(e){}))}else v(I,E,{isPrev:T});In()}}}}),[]),g=(0,w.useCallback)((function(e){var t,n,r,a,l;e.preventDefault(),null==e||e.currentTarget.setAttribute(Z,"true");var c=u[k.CONTROL_DRAG_DATA];if(xn||c){var s=xn||[],f=yn(e.target),d=(null==f||null===(t=f.dataset)||void 0===t?void 0:t.dragId)||null;if(d){var p=Nn;if(p&&d&&p!==d){var v,m=document.querySelectorAll(b()(v="[".concat(q,"='")).call(v,p,"']"));m&&m.forEach((function(e){return En(e)})),An(d)}else if(""===p)An(d);else if(p&&d&&p===d){var g;if(null!==(g=e.target)&&void 0!==g&&null!==(g=g.dataset)&&void 0!==g&&g.tabsHeader)Tn=!0;else if(Tn){var h,y;Tn=!1;var C=document.querySelectorAll(b()(h=b()(y="[".concat(q,"='")).call(y,p,"'] [")).call(h,$,"]"));C&&C.forEach((function(e){return En(e)}))}}var E=s[0],I=o.findControl(E),x=null==f||null===(n=f.dataset)||void 0===n?void 0:n.groupBarItemId;if(null!==(r=e.target)&&void 0!==r&&null!==(r=r.dataset)&&void 0!==r&&r.tabsHeader&&Ut(E?null==I?void 0:I._Type_:null===(a=c.data)||void 0===a?void 0:a.Id)){var N=e.target.lastChild;null==N||N.setAttribute(J,"true"),null==N||N.setAttribute($,"right"),An(null==N?void 0:N.dataset.dragId)}if(!d||null==s||!S()(s).call(s,d))if(x)Ut(E?null==I?void 0:I._Type_:null===(l=c.data)||void 0===l?void 0:l.Id)&&(null==f||f.setAttribute(J,"true"),null==f||f.setAttribute($,"right"));else{var T=o.findControl(d)._Type_,A=i.getControlMeta(T).IsContainer;if(void 0!==A&&A)return;var w=function(e,t,n){var r=e.getBoundingClientRect(),o=r.x,a=r.y,i=o+r.width,l=a+r.height,c=(o+i)/2,u="";return o<t&&t<i&&a<=n&&n<=a+8?u="left":o<t&&t<i&&l-8<=n&&n<l?u="right":o<=t&&t<=c&&a<n&&n<l?u="left":c<t&&t<i&&a<n&&n<l&&(u="right"),u}(f,e.clientX,e.clientY),F=f.dataset.dragDirection;w&&w!==F&&(F&&(f.removeAttribute("data-".concat(F,"-drag-style")),f.removeAttribute($)),null==f||f.setAttribute("data-".concat(w,"-drag-style"),"true"),null==f||f.setAttribute($,w))}}else An("")}}),[f]);return{onDragOver:g,onDragEnd:(0,w.useCallback)((function(e){e.preventDefault(),In(),Sn(null),An(""),null==e||e.currentTarget.removeAttribute(Z)}),[f]),onDrop:m,onDragLeave:(0,w.useCallback)((function(e){var t;null!==(t=e.currentTarget)&&void 0!==t&&t.contains(e.relatedTarget)||(In(),null==e||e.currentTarget.removeAttribute(Z))}),[])}};function Fn(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Dn=function(e){for(var t=null;;){var n,r;if(null!==(n=e)&&void 0!==n&&null!==(n=n.dataset)&&void 0!==n&&n.dragId&&(null===(r=e)||void 0===r||null===(r=r.dataset)||void 0===r||!r.groupBarItemId)){t=e;break}if("ui-designer-root"===e.id)break;e=e.parentNode}return t},Pn=function(e){var t=(0,w.useContext)(ae),n=t.getKdesignerApi,r=t.fieldStatusSettingMode,o=(0,w.useMemo)((function(){return n()}),[]),a=o.data,i=o.meta,l=a.getRootId(),c=l===e[_],u=a.findControl(e[_]),s=null==u?void 0:u._Type_,d=(i.getControlMeta(s)||{}).IsContainer,p=void 0!==d&&d,v=(0,w.useCallback)((function(e){var t;e.stopPropagation();var n,r=e.currentTarget,o=(r=yn(r)).dataset.dragId||null,i=[o],l=a.findControl(o),c=l._Type_,u=l.GroupParentId;!Ut(c)||null!==(t=r)&&void 0!==t&&null!==(t=t.dataset)&&void 0!==t&&t.groupBarItemId||(i=x()(n=a.findControlByCondition((function(e){return e.GroupParentId===u}))).call(n,(function(e){return e.Id})));Sn(i);var s=a.findControl(o),f=s._Type_,d=s.Name;pn(e,f,d)}),[l]),m=(0,w.useCallback)((function(e){var t,n=Dn(e.currentTarget);!n||null!=n&&null!==(t=n.dataset)&&void 0!==t&&t.dragOver||n.setAttribute(Y,"true")}),[]),g=(0,w.useCallback)((function(e){var t=Dn(e.currentTarget);if(null!=t&&t.contains(e.relatedTarget)){var n=yn(e.currentTarget);null!=n&&n.dataset.groupBarItemId&&null!=n&&n.dataset.dragDirection&&En(n)}else null!=t&&t.dataset.dragOver&&t.removeAttribute(Y)}),[]),h=p?{onDragEnter:m,onDragLeave:g}:{};return kn(kn((0,f.c)({},q,e[_]),h),{},{onDragStart:v,draggable:!c&&!r})},Mn=function(e){if(!e)return{};e.Id;var t=e.Status,n=e.Visibility,r=e.Key,o=(0,w.useContext)(ae),a=o.fieldStatusSettingMode,i=o.isPC,l=o.fieldStatusMap,c=null==l?void 0:l[r];return(t!==Xe.HIDDEN||a&&c)&&function(e,t){return e&&"mob"!==t||!e&&"pc"!==t}(i,n)&&"hidden"!==c?{}:(0,f.c)({},"data-hidden",!0)};function Rn(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var On=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=ie(e),r=ln();if(!e)return _n({onMouseDown:r},n);var o=ne(e),a=Pn(e),i=Mn(e);return t?_n(_n(_n({},o),n),{},{onMouseDown:r,dragEvent:a},i):_n(_n(_n({},o),n),{},{onMouseDown:r})},Bn=n(1252),jn=n.n(Bn),Ln=function(e){var t=e.field,n=On(t),r=(t._Type_,t.Id),o=t.Name||r,a=jn()(["undefined-control-root","text-omit"]);return F().createElement("div",(0,R.c)({},n,{className:a}),o)},Un=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isPC,o=void 0===r||r,a=n.excludeType,i=void 0===a?"":a,l=n.ctrlType,c=void 0===l?"":l,u=e[_],s=[],f=t[z].length,d=0;d<f;d++){var p=t[z][d],v=p[L];if(!(p[V]!==u||i&&i===v||c&&c!==v)){if(Ut(v)&&0!==Number(p.GroupIndex))continue;var m=ja(p,{isPC:o});m&&s.push(m)}}return s},Kn=n.p+"images/34cd7b92da1639c0f67b4f2cb967347a.png",Vn=n(2416),zn=n(5873),Gn=(0,w.memo)((function(e){var t,n=e.field,r=(0,w.useContext)(ae),o=r.isPC,a=r.getKdesignerApi,i=r.prefixCls,l=r.baseUrl,c=a().data,u=n.ColumnSpan,s=n.Gutter,d=n.BackColor,p=n.BackImage,v=n.CustomStyle,m=c.getData(),g=c.getRootId(),h=c.findControl,y=On(n,!1),C=Un(n,m,{isPC:o,excludeType:Ke},h),E=jn()("".concat(i,"-root-panel"),(0,f.c)({},b()(t="".concat(i,"-root-panel-")).call(t,o?"isPC":"isMb"),!0)),I=(0,w.useMemo)((function(){var e;return F().createElement("div",{className:b()(e="".concat(i,"-root-panel-")).call(e,o?"isPC":"isMb","-empty")},F().createElement("img",{src:Kn,alt:"暂无数据",className:"empty-img"}),F().createElement("div",{className:"empty-desc"},"您还没有内容，点击或拖拽左侧内容新建"))}),[o]),N=(0,w.useCallback)((function(){return F().createElement("div",{className:"".concat(i,"-root-panel-content"),style:o?{padding:"24px"}:{}},o?F().createElement(Vn.GridPanel,{column:u,gutter:s||[24,24],id:"root-grid-panel"},null==C?void 0:x()(C).call(C,(function(e,t){var n,r;return F().cloneElement(e,{itemKey:e.key||(null==e||null===(n=e.props)||void 0===n||null===(n=n.field)||void 0===n?void 0:n.key),columnSpan:null==e||null===(r=e.props)||void 0===r||null===(r=r.field)||void 0===r?void 0:r.ColumnSpan})}))):C)}),[o,C,u,s,Vn.GridPanel]),T=null==m?void 0:m.name,A=o?Vn.FormBanner:zn.FormBanner,S=(0,w.useMemo)((function(){return v&&F().createElement(A,{title:T,image:Ht(l.picture,p)})}),[v,T,l.picture,p,A,Ht]),k=wn();return F().createElement("div",{className:"".concat(i,"-root-panel-wrapper"),style:{backgroundColor:v&&d},"data-drag-id":g},F().createElement("div",(0,R.c)({id:"ui-designer-root"},y,{className:E},k),C.length?F().createElement("div",{className:"".concat(i,"-root-panel-scroll")},S,N()):F().createElement(F().Fragment,null,S,I)))}));Gn.displayName="RootPanel";var Hn=Gn,qn=(0,w.forwardRef)((function(e,t){var n=e.prefixCls,r=e.value,o=e.maxLength,a=e.style,i=e.onBlur,l=(0,w.useState)(r),c=(0,s.c)(l,2),u=c[0],f=c[1];(0,w.useEffect)((function(){var e;null==t||null===(e=t.current)||void 0===e||e.select()}),[]);var d=(0,w.useCallback)((function(e){var t=e.target.value;f(t)}),[f]),p=function(){var e,n=document.getElementById(Be);null==t||null===(e=t.current)||void 0===e||e.blur(),setTimeout((function(){null==n||n.focus()}),0)},v=(0,w.useCallback)((function(e){e.stopPropagation(),e.ctrlKey&&(e.preventDefault(),p()),e.keyCode===k.keyCode.ENTER&&p()}),[]);return F().createElement("input",{ref:t,style:a,type:"text",value:u,maxLength:o,className:"".concat(n,"-global-edit-control-name"),onBlur:i,onChange:d,onKeyDown:v})})),Yn=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,w.useContext)(ae),r=n.prefixCls,o=n.getKdesignerApi,a=(0,w.useContext)(k.GlobalConfigContext).showMessage,i=o(),l=i.data,c=i.meta,u=e.Id,s=(0,w.useRef)(null),d=(0,w.useRef)(null),p=(0,w.useRef)(null),v=(0,w.useRef)(null),m=(0,w.useCallback)((function(){var e;d.current&&s.current&&(null==v||null===(e=v.current)||void 0===e||e.blur())}),[]),g=(0,w.useCallback)((function(){p.current=window.requestAnimationFrame(m)}),[]),h=(0,w.useCallback)((function(){oe().unmountComponentAtNode(s.current),document.body.removeChild(s.current),s.current=null,d.current=null;var e=document.getElementById("ui-designer-root");null==e||e.removeEventListener("scroll",g,!0),p.current&&window.cancelAnimationFrame(p.current)}),[]),y=(0,w.useCallback)((function(e){var t=(l.findControl(u)||{}).Name;e.target.value||a("控件名称不能为空");var n=e.target.value||t;n!==t&&l.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[u,{Name:n}]])),h()}),[]),C=(0,w.useCallback)((function(e){d.current=e;var t,n,o,a=(null==e?void 0:e.getBoundingClientRect())||{},i=a.left,f=a.top,p=a.width,m=a.height,h=l.findControl(u),C=h.Name,E=h._Type_,I=c.getControlMetaEditor(E,"Name").MaxLength;s.current||(s.current=document.createElement("div"),s.current.style.cssText=b()(t=b()(n=b()(o="position: fixed;z-index: 0;left: ".concat(i+1,"px;top: ")).call(o,f,"px;width: ")).call(n,p-2,"px;height: ")).call(t,m,"px;background: transparent;"));oe().render(F().createElement(qn,{ref:v,prefixCls:r,value:C,maxLength:I,style:{width:"100%",height:"".concat(m-1,"px")},onBlur:y}),s.current),document.body.appendChild(s.current);var x=document.getElementById("ui-designer-root");null==x||x.addEventListener("scroll",g,!0)}),[]),E=(0,w.useCallback)((function(e){var t=e.currentTarget;C(t)}),[]),I=(0,w.useCallback)((function(e){if(s.current&&e!==u)h(),k.eventBus.off("add-control-id",I);else if(t&&e===u){var n,r,o=document.querySelector(b()(n=b()(r="[".concat(H,'="')).call(r,u,'"] [')).call(n,te,'="true"]'));if(!o)return;C(o)}}),[]);return(0,w.useEffect)((function(){return k.eventBus.on("add-control-id",I),function(){k.eventBus.off("add-control-id",I)}}),[]),(0,f.c)({onDoubleClick:E},te,!0)},Wn=["field","children","tipsTrigger","dragEvent","wrapperStyle"],Qn=function(e,t){var n=e.Key;return function(e){var t=e.MustInput,n=e.FieldRequired;return e.Status===Xe.DEFAULT&&(t||"2"===n||"3"===n)}(e)&&!kt(t[n])||"mustInput"===t[n]},Xn=function(e){var t,n,r=(0,w.useContext)(ae),o=r.isPC,a=r.prefixCls,i=r.fieldStatusMap,l=e.field,c=e.children,u=e.tipsTrigger,s=e.dragEvent,d=void 0===s?{}:s,p=e.wrapperStyle,v=void 0===p?{}:p,m=(0,ye.c)(e,Wn),g=l.Name,h=l.LabelWidth,y=(l.ShowTitle,l.HelpTips),C=l.TitleArea,E=(l.MustInput,l.Status,l.FieldRequired,l.Key),I=!vt(C),x=(0,R.c)({width:h},e.labelStyle),N=Yn(l),T=Qn(l,i),A=(0,R.c)({padding:"0 12px",margin:"0 -12px"},v);return o?F().createElement("div",(0,R.c)({style:A},d),F().createElement(Vn.FieldItem,(0,R.c)({className:jn()((0,f.c)({},b()(n="".concat(a,"-item-")).call(n,i[E]),i[E])),labelClassName:"".concat(a,"-designer-field-item"),labelProps:N,labelText:g,required:T,labelStyle:x,showTitle:I,tips:y,tipsTrigger:o?u:"click",tipsDisabled:!0},m),c)):F().createElement(Vn.FieldItem,(0,R.c)({className:jn()((0,f.c)({},b()(t="".concat(a,"-item-")).call(t,i[E]),i[E])),labelClassName:"".concat(a,"-designer-field-item"),labelProps:N,labelText:g,required:T,labelStyle:x,showTitle:I,tips:y,tipsTrigger:o?u:"click",tipsDisabled:!0},m,d),c)},Zn=(0,w.memo)((function(e){var t=e.value,n=(0,w.useContext)(ae).prefixCls;return F().createElement("p",{className:"".concat(n,"-readonly-text")},""===t||null==t?"-":t)})),Jn=function(e){var t=e.type,n=e.field,r=void 0===n?{}:n,o=e.props,a=void 0===o?{}:o,i=e.isMb,l=void 0!==i&&i,c=r.Status,u=r.Key,s=(0,w.useContext)(ae),f=s.fieldStatusMap,d=s.fieldStatusSettingMode;if(c===ke.READONLY&&!kt(f[u])||"readonly"===f[u])return F().createElement(Zn,{value:a.readonlyValue||(null==r?void 0:r.DefValue)});var p=(0,w.useMemo)((function(){return l?zn[t]:Vn[t]}),[t]),v=function(e,t){var n,r=t.fieldStatusMap,o=e.EmptyText,a=e.NoCodeDefValue,i=e.ShowClearButton,l=e.Status,c=e.MaxLength,u=e.MinLength,s=e._Type_,f=e.DateRangeEmptyText,d=e.DateRangeDefValue,p=e.Key,v={readOnly:!0,disabled:(n=l,n===ke.DISABLED&&!kt(r[p])||"disabled"===r[p])};if((0,we.isUndefined)(a)||$e(s)||(Je(s)?v.value=a&&Date.parse(a)?new Date(a):void 0:v.value=a),(0,we.isUndefined)(d)||(v.value=pt(d)),(0,we.isUndefined)(o)||(v.placeholder=o),Ze(s)&&f){var m=f.start,g=void 0===m?"":m,h=f.end,y=void 0===h?"":h;v.placeholder=[g,y]}return(0,we.isUndefined)(i)||(v.allowClear=i),(0,we.isUndefined)(c)||(v.maxLength=c),(0,we.isUndefined)(u)||(v.mixLength=u),v}(r,{fieldStatusSettingMode:d,fieldStatusMap:f});return F().createElement(p,(0,R.c)({},v,a))},$n=function(e){return F().createElement(Jn,(0,R.c)({isMb:!0},e))},er=(0,w.memo)((function(e){var t=e.field,n=On(t),r={borderType:"bordered"};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Jn,{type:"Text",field:t,props:r}))}));er.displayName="TextFieldAp";var tr=er,nr=function(e){var t,n=e.field,r=On(n),o=Mt(n),a=Ot(n),i={readonlyValue:Dt(n),options:Rt(n),defaultValue:a,value:a,mode:Pt(null==n?void 0:n.SelectItemType)?"multiple":"single",showBgcBlock:_t(n)};return S()(t=["Checkbox","Radio"]).call(t,o)&&(i.vertical=Bt(null==n?void 0:n.TileTypePc)),F().createElement(Xn,(0,R.c)({},r,{field:n}),F().createElement(Jn,{type:o,field:n,props:i}))},rr="setListTreeConfig",or="setFormRules",ar="setRuleInfo",ir="deleteFormRule",lr="setBizRules",cr="deleteBizRule",ur="setRefBillTreeData",sr="setTreeNodeChildren",fr="setInputForm",dr="setRefPropDisp",pr="getSvgLine",vr="setSwitchFieldTypes",mr="showDesignerError",gr="setDefValueForFormula",hr="setAvailableAssociationFields",yr="updateAssociation",br="loadDesignerMetadata",Cr=["field"];function Er(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Er(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Er(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var xr=function(e){var t,n=e.field,r=((0,ye.c)(e,Cr),(0,w.useState)([])),o=(0,s.c)(r,2),a=o[0],i=o[1],l=(0,w.useContext)(ae).getKdesignerApi,c=On(n),u=((0,w.useMemo)((function(){return l()}),[]).data.getData(),n.EmptyText,n.DataRage,n.showClearButton,n.Status),f=n.ShowType,d=n.PropsDisplay;n.Visibility;(0,w.useEffect)((function(){return k.eventBus.on(dr,p),function(){k.eventBus.off(dr,p)}}),[]);Xe.DISABLED;var p=(0,w.useCallback)((function(e){var t=x()(e).call(e,(function(e){return{fieldCaption:e.PropCap,fieldName:e.PropKey,items:e.items,type:e.type}}));i(t||[])}),[]);d&&(null===(t=d.split(","))||void 0===t||x()(t).call(t,(function(e){var t=(null==a?void 0:Te()(a).call(a,(function(t){return t.fieldName===e})))||{},n=t.fieldCaption;t.type;return{ApType:"NoCodeTextFieldAp",FieldType:"NoCodeTextField",Id:t.fieldName,Name:n,_Type_:"NoCodeTextField"}}))),Ir({ShowSeqField:!0,SeqName:"序号",ShowBatExportBtn:!1,ShowBatImportBtn:!1,showAddRowBtn:!1,EntityData:Ir(Ir({},n.EntityData),{},{_Type_:"NoCodeEntryEntity"}),operations:["取消"]},n);return"1"===f?F().createElement(Xn,(0,R.c)({},c,{field:n}),F().createElement(Jn,{type:"RefBill",field:n})):null},Nr=function(e){var t=e.field,n=On(t),r=t.CounterDisplay,o=t.DefaultLines,a={showCount:!!(0,we.isUndefined)(r)||r,autoSize:{minRows:o||1,maxRows:o||1},style:{pointerEvents:"none"}};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Jn,{type:"Textarea",field:t,props:a}))},Tr=function(e){var t=e.field,n=On(t),r=(t.EmptyText,t.DefValue,t.showClearButton,t.Status,t.ThousandsSeparator),o=t.Scale,a=t.Precision,i=t.Stepper,l={borderType:"bordered",readOnly:!0,allowClear:!1,formatter:(0,w.useCallback)((function(e){return r?Kt("".concat(e)):String(e)}),[r]),decimalLength:o,maxLength:a,showStepper:i};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Jn,{type:"Number",field:t,props:l}))},Ar=new(Pe())([["2","month"],["3","year"]]),Sr=function(e){var t=e.field,n=On(t),r=t.FormatType,o={borderType:"bordered",showTime:"0"===r,readOnly:!0,allowClear:!1,picker:Ar.get(r)||"date"};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Jn,{type:"DatePicker",field:t,props:o}))},wr=function(e){var t=e.field,n=On(t),r={borderType:"bordered",showTime:"0"===t.FormatType,readOnly:!0,allowClear:!1};return t=Xt(t,"DateRangeDefValue"),F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Jn,{type:"DateRangePicker",field:t,props:r}))},Fr=n(1848),kr=n.n(Fr),Dr=["ShowSelChexkbox","ShowSeqField","SeqName","ShowBatExportBtn","ShowBatImportBtn"],Pr=["field","className","showSeqField","showSelChexkbox","seqName","operations","subControls","showBatImportBtn","showBatExportBtn","showAddRowBtn"],Mr=function(e){var t=e.field,n=On(t),r=t.ShowSelChexkbox,o=t.ShowSeqField,a=t.SeqName,i=void 0===a?"序号":a,l=t.ShowBatExportBtn,c=t.ShowBatImportBtn,u=(0,ye.c)(t,Dr),s=(0,w.useRef)(null);return"1"===u.ShowType?null:F().createElement(Xn,(0,R.c)({field:t,tipsTrigger:"click"},n,{wrapperStyle:{margin:0,padding:0}}),F().createElement(Rr,(0,R.c)({showSeqField:o,showSelChexkbox:r,seqName:i,ref:s,field:t,showBatExportBtn:l,showBatImportBtn:c},u)))},Rr=(0,w.forwardRef)((function(e,t){var n,r,o,a=e.field,i=e.className,l=(e.showSeqField,e.showSelChexkbox,e.seqName),c=e.operations,u=void 0===c?["复制","删除","更多"]:c,s=e.subControls,d=(e.showBatImportBtn,e.showBatExportBtn,e.showAddRowBtn,(0,ye.c)(e,Pr),(0,w.useContext)(k.ConfigContext)),p=d.getPrefixCls,v=(d.prefixCls,(0,w.useContext)(ae).getKdesignerApi),m=(0,w.useMemo)((function(){return v()}),[]).data,g=p("nocode-designer-entry"),h=m.getData(),y=s||Un(a,h,{},m.findControl),C=jn()((0,f.c)((0,f.c)({},"".concat(g,"-body"),!0),i,i)),E=kr()(n=new Array(1)).call(n,"");return y.length?F().createElement("div",{className:"".concat(g),ref:t},F().createElement("div",{className:"".concat(g,"-toolbar")},F().createElement("div",{className:"".concat(g,"-toolbar-btns")},F().createElement(P.Button,{size:"small",className:"add-btn",icon:F().createElement(P.Icon,{prefix:"ncicon",type:"zengjia-yuan"}),type:"ghost"},"新增"),F().createElement(P.Button,{size:"small",className:"import-btn",icon:F().createElement(P.Icon,{prefix:"ncicon",type:"daoru"})},"导入"))),F().createElement("div",{className:C},F().createElement("div",{className:"".concat(g,"-grid-view")},F().createElement("ul",{className:b()(r="".concat(g,"-checkbox-col ")).call(r,g,"-sticky"),style:{left:0}},F().createElement("li",{className:"thead"},F().createElement("span",{className:"checkbox"})),F().createElement("li",null,F().createElement("span",{className:"checkbox"}))),F().createElement("ul",{className:b()(o="".concat(g,"-seqcol ")).call(o,g,"-sticky"),style:{left:40}},F().createElement("li",{className:"thead",title:l},l),F().createElement("li",null,"1")),F().createElement("div",{className:"".concat(g,"-main")},y),((null==y?void 0:y.length)>0||u.length>0)&&F().createElement("ul",{className:"".concat(g,"-sticky-right")},F().createElement("li",{className:"thead"},"操作"),x()(E).call(E,(function(e,t){return F().createElement("li",{key:t},x()(u).call(u,(function(e,t){return F().createElement("div",{key:t,className:"op"},e)})))})))))):F().createElement("div",{className:"".concat(g,"-empty")},"拖拽或点击添加内容")})),_r=n(2796),Or=n.n(_r),Br=n(8429),jr=n.n(Br),Lr=n(1900),Ur=n.n(Lr),Kr="INIT_FORM_DATA",Vr="UPDATE_FORM_DATA",zr="UPDATE_CONTROL_PROPS",Gr="ADD_CONTROL",Hr="DEL_CONTROL",qr="UPDATE_APP_FORM_LIST",Yr=(0,w.memo)((function(e){var t=e.prefixClass,n=e.defaultBatchValue,r=e.handleAddOption,o=(0,w.useState)(!1),a=(0,s.c)(o,2),i=a[0],l=a[1],c=(0,w.useState)(n),u=(0,s.c)(c,2),f=u[0],d=u[1];(0,w.useEffect)((function(){d(n)}),[n]);var p=F().createElement("div",{className:"".concat(t,"_batchaddpanel_form")},F().createElement("label",{className:"".concat(t,"_batchaddpanel_form_label")},"每行对应一个选项"),F().createElement(P.TextArea,{className:"".concat(t,"_batchaddpanel_form_textarea"),defaultValue:f,value:f,placeholder:"请输入",borderType:"bordered",count:!1,autoSize:{minRows:19,maxRows:19},maxLength:2e3,onChange:function(e){d(e.target.value)}})),v=(0,w.useCallback)((function(){var e,t=null==f?void 0:m()(e=f.split(/[\r\n\t]/)).call(e,Boolean),n=(0,M.c)(new(mn())(t));d(n.join("\n")),r(n),l(!1)}),[f,r]),g=(0,w.useCallback)((function(){d(n),l(!1)}),[n]),h=(0,w.useMemo)((function(){var e="".concat(t,"_batchaddpanel_footer");return F().createElement("div",{className:e},F().createElement("div",{className:"".concat(e,"_action")},F().createElement(P.Button,{size:"small",className:jn()("".concat(e,"_action_btn"),"".concat(e,"_action_cancel")),onClick:g},"取消"),F().createElement(P.Button,{size:"small",type:"primary",className:jn()("".concat(e,"_action_btn"),"".concat(e,"_action_copy")),onClick:v},"确定")))}),[v]);return F().createElement(F().Fragment,null,F().createElement("div",{className:"".concat(t,"-handle-batchadd"),onClick:function(){l(!0)}},"批量编辑"),i&&F().createElement(P.Modal,{className:"".concat(t,"_batchaddpanel"),bodyClassName:"".concat(t,"_batchaddpanel_body"),body:p,title:"批量编辑",onCancel:function(){return l(!1)},onOk:function(){return l(!1)},visible:i,height:560,footer:h}))})),Wr=n(5288),Qr=n.n(Wr),Xr=(0,w.memo)((function(e){var t=e.className,n=e.value,r=e.colorList,o=void 0===r?[]:r,a=e.onChange,i=e.renderIcon,l=(0,w.useContext)(ae),c=l.getPrefixCls,u=l.prefixCls,f=c&&c(u,"colorpicker-content"),d=(0,w.useState)(n),p=(0,s.c)(d,2),v=p[0],m=p[1];(0,w.useEffect)((function(){!(0,we.isUndefined)(n)&&m(n)}),[n]);return F().createElement("ul",{className:jn()("".concat(f),t)},null==o?void 0:x()(o).call(o,(function(e){return F().createElement("li",{onClick:function(){return function(e){m(e),null==a||a(e)}(e)},key:e,className:"".concat(f,"-item"),style:{backgroundColor:e}},v===e&&("function"==typeof i?i():F().createElement(P.Icon,{className:jn()("".concat(f,"-item-light")),prefix:"designericon",type:"shuzhankaibeifen"})))})))})),Zr=Xr,Jr=["#E0EFFF","#CFF7FF","#D6FFF8","#DCFAE4","#EDFFBD","#FFF8B8","#FFF1D4","#FFE7D6","#FFDBE0","#FFC4CF","#ECD6FF","#C7E5FF","#E5E5E5"],$r=["#276FF5","#16B0F1","#16B8B1","#1BA854","#77C404","#FDC200","#FF991C","#FF5F1F","#FB2323","#F90D58","#701DF0","#0E5FD8","#999999"],eo=function(e){var t=e.prefixClass,n=e.value,r=e.onChange,o=(0,w.useState)(!1),a=(0,s.c)(o,2),i=a[0],l=a[1],c=(0,w.useState)(n),u=(0,s.c)(c,2),d=u[0],p=u[1];(0,w.useEffect)((function(){!(0,we.isUndefined)(n)&&p(n)}),[n]);var v="".concat(t,"-colorpicker"),m=function(e){p(e),null==r||r(e),l(!1)},g=F().createElement(P.Dropdown.Menu,{style:{width:380,padding:8}},F().createElement("div",{className:"".concat(v,"-content")},F().createElement(Zr,{colorList:Jr,onChange:m,value:d}),F().createElement(Zr,{renderIcon:function(){return F().createElement(P.Icon,{className:jn()("".concat(v,"-content-list-item-dark")),prefix:"designericon",type:"shuzhankaibeifen"})},colorList:$r,onChange:m,value:d})));return F().createElement(P.Dropdown,{popperClassName:"".concat(v,"-popup"),placement:"bottomLeft",menu:g,trigger:"click",visible:i,onVisibleChange:function(e){return l(e)}},F().createElement("div",{style:{backgroundColor:d},className:v},F().createElement(P.Icon,{className:jn()("".concat(v,"-arrow"),(0,f.c)((0,f.c)({},"".concat(v,"-arrow-up"),i),"".concat(v,"-arrow-light"),S()($r).call($r,d))),prefix:"designericon",type:"zhankai3"})))};function to(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function no(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ro=(0,w.memo)((function(e){var t=e.index,n=e.option,r=e.options,o=e.prefixClass,a=e.isNewOptionEdit,i=e.onDrop,l=e.handleEditOption,c=e.handleDeleteOption,u=e.bgcolorChecked,d=(0,w.useState)(!1),p=(0,s.c)(d,2),v=(p[0],p[1]),m=(0,w.useState)(a),g=(0,s.c)(m,2),h=g[0],y=g[1],b=(0,w.useState)(no({},n)),C=(0,s.c)(b,2),E=C[0],I=C[1],x=(0,w.useRef)(null),N=(0,w.useRef)(null),T=(0,w.useRef)(null),A="".concat(o,"-item");(0,w.useEffect)((function(){I(no({},n))}),[n]),(0,w.useEffect)((function(){N.current&&h&&N.current.select()}),[N,h]);var S=(0,w.useCallback)((function(e){e.persist();var t=e.target.value,n=no(no({},E),{},(0,f.c)((0,f.c)({},K,t),U,po(t)));I(n)}),[E]),k=(0,w.useCallback)((function(e){e.persist(),I((function(t){return no(no({},t),{},(0,f.c)({},U,e.target.value))}))}),[]),D=(P.Dropdown.Menu,"".concat(A,"-detail-item"),P.Input,n[K],E[K],"".concat(A,"-detail-input"),"".concat(A,"-detail-item"),P.Input,n[U],E[U],"".concat(A,"-detail-input"),function(){var e;if(y(!1),E[K]&&null!==(e=E[K])&&void 0!==e&&Qr()(e).call(e)){var t=Te()(r).call(r,(function(e){return e[K]===E[K]}));t&&E[_]!==t[_]?c(n[_]):l(E)}else c(n[_])});return F().createElement(Vn.Draggable,{index:t,onDrop:i},F().createElement("div",{className:"".concat(A,"-wrapper")},F().createElement("div",{className:A},u&&F().createElement(eo,{value:n[G],prefixClass:o,onChange:function(e){var t=no(no({},E),{},(0,f.c)({},G,e));I(t),l(t)}}),F().createElement("div",{title:"双击修改显示值",className:"".concat(A,"-content"),onDoubleClick:function(){y(!0),v(!1)}},h?F().createElement(P.Input,{ref:N,className:"".concat(A,"-content_edit"),borderType:"bordered",size:"large",defaultValue:n[K],onBlur:D,onPressEnter:D,onChange:function(e){e.persist();var t=e.target.value;I((function(e){return no(no({},e),{},(0,f.c)((0,f.c)({},K,t),U,po(t)))}))}}):F().createElement("p",null,n[K])),F().createElement("div",{className:"".concat(A,"-operate")},!h&&-1===n[_].indexOf(co)&&F().createElement(P.Icon,{className:"".concat(A,"-operate-edit"),prefix:"designericon",type:"bianji3",onClick:function(){y(!0)},ref:x}),F().createElement(P.Icon,{className:"".concat(A,"-operate-drag"),prefix:"designericon",type:"tuozhuailiebiao"}))),F().createElement("div",{title:"删除选项",className:"".concat(A,"-delete"),onClick:function(){return c(n[_])}},F().createElement(P.Icon,{prefix:"designericon",type:"xingshanchu"}))))})),oo=ro;function ao(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function io(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ao(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var lo=n(7136).hooks.useOnDrop,co="other",uo=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=m()(e).call(e,(function(e){return!S()(t).call(t,e)})),r=0;r<n.length;r++){var o=r+Math.floor(Math.random()*(n.length-r)),a=[n[o],n[r]];n[r]=a[0],n[o]=a[1]}return b()(t).call(t,n)},so=(0,M.c)(Se()($r).call($r,0,-1)),fo=function(e){return e&&Array.isArray(e)&&0!==e.length?x()(e).call(e,(function(e){return e[_]?e:io(io({},e),{},(0,f.c)({},_,(0,k.createUUid)()))})):e},po=function(e){return encodeURIComponent(e)},vo=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.editor,a=(e.locked,e.Name),i=e.Tips,l=(e.field,o.Enum,o.NameHidden),c=o.Default,u=o.Required,d=o.Title,p="".concat(r,"-custom-option"),v=(0,w.useState)((0,we.isUndefined)(n)?[]:fo(function(e){return Array.isArray(e)?e:null==e?void 0:e.ops}(n||c))||[]),g=(0,s.c)(v,2),h=g[0],y=g[1],C=(0,w.useState)(""),E=(0,s.c)(C,2),I=E[0],N=E[1],T=(0,w.useState)((0,we.isUndefined)(null==n?void 0:n.bgcSwitch)?null==c?void 0:c.bgcSwitch:null==n?void 0:n.bgcSwitch),A=(0,s.c)(T,2),D=A[0],M=A[1],R=(0,w.useRef)(null==h?void 0:h.some((function(e){return e[_].indexOf(co)>-1}))),O=(0,w.useRef)(null),B=(0,w.useRef)({});(0,w.useEffect)((function(){var e="";B.current={},null==h||h.forEach((function(t){var n,r=null==t?void 0:t[K];r&&(e="".concat(e?e+"\n"+r:r),((null===(n=t[_])||void 0===n?void 0:n.indexOf(co))>-1||"其他"===t[K]||"其他"===t[U])&&(R.current=!0))})),N(e)}),[h]),(0,w.useLayoutEffect)((function(){D||(so=uo(m()(so).call(so,(function(e){return!S()(Jr).call(Jr,e)}))))}),[D]),(0,w.useEffect)((function(){var e,t=m()(e=x()(h).call(h,(function(e){return e[G]}))).call(e,Boolean);so=uo(so,t)}),[]);var j=function(e){var n=[];if(Array.isArray(e))n=x()(e).call(e,(function(e,t){var n=(0,f.c)((0,f.c)((0,f.c)({},K,e),U,po(e)),_,(0,k.createUUid)());return D&&(n[G]=so[t%so.length]),n})),function(e){Array.isArray(e)&&(y(e),t({bgcSwitch:D,ops:e}))}(n);else{var r=(0,f.c)((0,f.c)((0,f.c)({},_,(0,k.createUUid)()),K,""),U,"");D&&(r[G]=so[((null==h?void 0:h.length)||0)%so.length]),O.current=r,n=h?null==h?void 0:b()(h).call(h,r):[r],y(n)}},L=function(e){if(null!=e&&e[_]){var n=null==h?void 0:x()(h).call(h,(function(t){return t[_]===e[_]?e:t}));y(n),t({bgcSwitch:D,ops:n})}},V=function(e){if(e){var n=m()(h).call(h,(function(t){return t[_]!==e}));y(n),0===n.length&&D===(null==c?void 0:c.bgcSwitch)?t({bgcSwitch:D,empty:!0}):t({bgcSwitch:D,ops:n})}},z=(0,w.useCallback)((function(e){if(e){var n=e.sourceIndex,r=e.destinationIndex,o=(0,we.cloneDeep)(h),a=ce()(o).call(o,n,1)[0];ce()(o).call(o,r,0,a),t({bgcSwitch:D,ops:o}),y(o)}}),[h,D,t]),H=lo(z);return F().createElement("div",{className:p},F().createElement("div",{className:"".concat(p,"-title")},F().createElement(k.NameTipWrapper,{nameHidden:l,className:r,name:a,tips:i,required:u,title:d}),F().createElement("div",{className:"".concat(p,"-title-colorswitch")},F().createElement("span",{className:"".concat(p,"-title-colorswitch-text")},"彩色"),F().createElement(P.Switch,{checked:D,onChange:function(e){M(e);var n=null==h?void 0:x()(h).call(h,(function(t,n){if(e&&(0,we.isUndefined)(t.Bgc)){var r=so[n%so.length];return io((0,f.c)({},G,r),t)}var o=(0,we.cloneDeep)(t);return delete o[G],o}));y(n),t({bgcSwitch:e,ops:n})}}))),F().createElement(Vn.DragContainer,null,F().createElement("div",{className:jn()("".concat(p,"-list"))},null==h?void 0:x()(h).call(h,(function(e,t){var n;return F().createElement(oo,{key:e[_],index:t,options:h,option:e,prefixClass:p,handleDeleteOption:V,handleEditOption:L,isNewOptionEdit:(null===(n=O.current)||void 0===n?void 0:n[_])===e[_],bgcolorChecked:D,onDrop:H})})))),F().createElement("div",{className:jn()("".concat(p,"-handle"))},F().createElement("div",{className:jn()("".concat(p,"-handle-addoption")),onClick:function(){return j()}},F().createElement(P.Icon,{prefix:"designericon",type:"zengjia-yuan"}),F().createElement("span",null,"添加选项")),F().createElement(Yr,{prefixClass:p,defaultBatchValue:I,handleAddOption:j})))};function mo(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function go(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):mo(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ho=(0,M.c)(Se()($r).call($r,0,-1)),yo=function(e){return S()(He).call(He,e)},bo=function(e,t,n){var r=t._Type_,o=t.EntityData,a=void 0===o?{}:o,i=[],l=p()(e).reduce((function(t,o){var a=n.getControlMetaProperty(r,o),l=n.getControlPropertyDefaultValue(r,o),c=a.Tag;return c!==_e&&c!==Oe||(t[o]=e[o],(0,we.isEqual)(e[o],l)&&i.push(o)),t}),{});return(0,ht.produce)(a,(function(e){(0,R.c)(e,l),i.forEach((function(t){delete e[t]}))}))},Co=function(e,t,n,r){r.globalConfig,r.dataContext,r.selectionContext,r.action,r.dataFactory,r.modelFactory;var o=r.metaReader;if(!n)return!1;var a=n._Type_,i=n.EntityData,l=void 0===i?{}:i;if(yo(a))return!1;var c=[],u=p()(t).reduce((function(e,n){var r=o.getControlMetaProperty(a,n),i=o.getControlPropertyDefaultValue(a,n),l=r.Tag;return l!==_e&&l!==Oe||(e[n]=t[n],(0,we.isEqual)(t[n],i)&&c.push(n)),e}),{}),s=(0,ht.produce)(l,(function(e){(0,R.c)(e,u),c.forEach((function(t){delete e[t]}))}));return p()(u).length?(0,k.createUpdateAction)([[e,{EntityData:s}]]):void 0},Eo=["ApType","EntityData",B,O,_,"Index","Features","FieldName",V],Io=function(e,t){return"string"==typeof e?e:(null==e?void 0:e[t])||(null==e?void 0:e.Default)},xo=function(e,t){var n=t.dataContext,r=t.metaReader,o=e._Type_,a=e.Id,i=e.ParentId,l=n.getRootId();if(ct(o))return e;var c=n.findControl(i),u=c._Type_,s=c.Status,f=r.getControlMeta(o),d=f.ApType,v=f.BaseType,m=r.getControlMeta(u).BaseType;if(d&&!yo(o)){var g,h=p()(e).reduce((function(t,n){var a=r.getControlMetaProperty(o,n).Tag;return(a===_e||a===Oe||S()(Re).call(Re,n))&&(t[n]=e[n]),t}),{});Ut(u)&&(h.ParentId=l);var y="".concat(v,"Id");if(e[y]=a,e.FieldType=o,e.ApType=Io(d,m),ut(o)&&(null==h||null===(g=h.CustomContent)||void 0===g||null===(g=g.ops)||void 0===g||!g.length)){var b;ho=uo(ho);var C=r.getControlPropertyDefaultValue(o,"CustomContent"),E=x()(b=C.ops).call(b,(function(e,t){return go(go({},e),{},{Bgc:ho[t]})})),I={bgcSwitch:!0,ops:fo(E)};e.CustomContent=I,(0,R.c)(h,{CustomContent:I})}e.EntityData=h}return(at(u)||it(u))&&(e._isEntryField_=!0),Ut(u)&&s&&(e.Status=s),e};function No(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function To(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?No(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):No(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Ao=function(e,t){var n,r=e.SourceForm,o=e.BillEntityIdEx,a=new(mn())(t);return"1"===r||!(!o||S()(n=["bos_user","bos_adminorg"]).call(n,o))&&a.has(o)},So=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return t?[x()(t).call(t,(function(t){var a=t||{},i=a.label,l=a.value,c=a.children,u=a.icon,s=a.customParams,f=To({key:l,title:i},n);return u&&(f.icon=u),c?(c.length&&(f.children=e(c,{},null==s?void 0:s.currentApp,o)[0]),f.checkable=!1,f.selectable=!1):f.isLeaf=!0,r&&o.push(l),f})),o]:t},wo=function(e){var t=(null==e?void 0:e.FieldType)||e._Type_;return it(t)&&"1"===e.ShowType||$e(t)&&"2"===e.ShowType},Fo=function(e){var t;return S()(t=["NoCodeCreatorField","NoCodeCreateDateField","NoCodeModifierField","NoCodeModifyDateField","NoCodeBillNoField"]).call(t,e)},ko=function(e,t){var n=["NoCodeRefBillTable","NoCodeRichTextField","NoCodeGroupContainerAp","NoCodeGraphicDisplayField"];return S()(n).call(n,e)},Do=function(e,t){var n={},r="string"==typeof t?t:(0,M.c)(t).join(),o=S()(r).call(r,"_startdate")?r.replace("_startdate","").replace("_enddate",""):r,a=new(mn())(o.split(",")),i=[];return e.forEach((function(e){a.add(e.Key),n[e.Key]=e})),a.forEach((function(e){null!=n&&n[e]&&i.push(n[e])})),i},Po=function(e,t){var n,r;return e.EntityData=t,e.ApType=tt(t._Type_)?"NoCodeSystemAp":e._Type_,e._Type_=t._Type_,e.FieldType=t._Type_,n=e,r=t,p()(r).forEach((function(e){Or()(n,e)||(0,R.c)(n,(0,f.c)({},e,r[e]))})),e},Mo=function(e,t){var n,r,o,a,i=t||{},l=i.Id,c=i.SourceForm,u=i.PropsDisplay,s=i.inner2Outer,f=i.BillEntityIdEx,d=(0,we.cloneDeep)(e),p=new(mn())(u?u.split(","):[]),v=f||"".concat(l,"_table"),m=(null==d||null===(n=d.entitymeta)||void 0===n?void 0:n.Items)||[],g=(null==d||null===(r=d.formmeta)||void 0===r?void 0:r.Items)||[],h={},y=[],b=S()(o=["bos_user","bos_adminorg"]).call(o,v),C=new(mn());return null==d||null===(a=d.formmeta)||void 0===a||null===(a=a.Items)||void 0===a||a.forEach((function(e){h[e.Id]=e})),m.length&&(g.forEach((function(e){(Ut(e._Type_)||lt(e._Type_))&&C.add(e.Id)})),m.forEach((function(e){var t,n,r=Po((null==h?void 0:h[e.Id])||{},e);if(r._isEntryField_=!0,"1"===c)!(s||!Fo(e._Type_))||ko(e._Type_)||Ut(e._Type_)||lt(e._Type_)||(r.isShow=!s||p.has(e.Key),y.push(r));else if(b||(Fo(e._Type_)||C.has(null==r?void 0:r.ParentId))&&!ko(r._Type_)){var o=p.has(e.Key);Ze(e._Type_)&&(t=e.Key,n=p,o=(0,M.c)(n).some((function(e){return S()(e).call(e,t)}))),r.isShow=o,y.push(r)}}))),y},Ro=function(e,t,n,r,o,a,i){var l=[],c=e.reduce((function(e,a){var i,c=r.findControl(a)||{},u=c.ParentId,s=c.Key,f=c.RefTableId,d=c.RefBillId,p=c._Type_,v=r.findControl(u)||{},m=v._Type_,g=v.SourceForm,h=v.BillEntityIdEx,y=v.PropsDisplay;if(it(m)){var C,E="1"!==g||h?h:"".concat(u,"_table"),I=a.replace("_".concat(u),"");"1"!==g&&S()(C=t[E].ids).call(C,I)||n({key:Hr,payload:{form:E,id:I}});var x=new(mn())(y?y.split(","):[]),N=s.toLowerCase().replace("_".concat(u.toLowerCase()),"");Ze(p)?(x.delete("".concat(N,"_startdate")),x.delete("".concat(N,"_enddate"))):x.delete(N);var A=(0,M.c)(x).join();l=[[u,{PropsDisplay:A}]]}return d&&delete o[d],f&&T()(o).forEach((function(e){e.Id!==f&&e.ParentId!==f||delete o[e.Id]})),b()(i=[]).call(i,(0,M.c)(e),[a])}),[]);a(o),jr().all([r.deleteControl((0,k.createDeleteAction)(c)),r.batchUpdateControlPropertyValues((0,k.createUpdateAction)(l))]).then((function(){null==i||i()})).catch((function(e){}))},_o=function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[{},{}],a=e.Id,i=e.Key,l=e._Type_,c=e.EntityData,u=(0,we.cloneDeep)(e),s=t.toLowerCase(),f=i.toLowerCase(),d=S()(f).call(f,s)?f:b()(n="".concat(f,"_")).call(n,s),p=S()(a).call(a,t)?a:b()(r="".concat(a,"_")).call(r,t);return["isShow","UploadDefValue","PictureDefValue","NoCodeDefValue","FieldRequired","Status","Visibility"].forEach((function(e){delete u[e],delete c[e]})),Ze(l)&&(u.StartDateFieldKey="".concat(d,"_startdate"),u.EndDateFieldKey="".concat(d,"_enddate"),u.EntityData.StartDateFieldKey="".concat(d,"_startdate"),u.EntityData.EndDateFieldKey="".concat(d,"_enddate")),To(To(To({},u),{},{Id:p,Key:d,ParentId:t,FieldId:p},o[0]),{},{EntityData:To(To({},c),{},{Id:p,Key:d,ParentId:t},o[1]),_isEntryField_:!0})},Oo=function(e,t,n,r){var o=t.reduce((function(e,t){return To(To({},e),{},(0,f.c)({},t.Id,t))}),{}),a=[],i=e.reduce((function(e,t){var i=To({},t);if(t.isShow){var l,c;a.push(i.Key),delete i.isShow;var u=function(e,t,n){if(t){var r=n.getDefaultData(e._Type_),o=[{},{}];return Qe.forEach((function(a){var i=n.getControlMetaProperty(e._Type_,a).Tag,l=i===_e||i===Oe,c=t[a]||r[a];l?(c&&(o[1][a]=c),c&&(o[0][a]=c)):c&&(o[0][a]=c)})),o}}(t,o[b()(l="".concat(i.Id,"_")).call(l,n)],r);return b()(c=[]).call(c,(0,M.c)(e),[_o(i,n,u)])}return e}),[]);return[i,a]},Bo=["dragEvent"];function jo(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jo(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Uo=function(e){var t,n=e.field,r=(e.rootWidth,e.rowHeight),o=e.headHeight,a=e.isMb,i=void 0!==a&&a,l=e.autoRowHeight,c=n.Id,u=n.Key,s=n.Name,d=n.ListFieldId,p=n.HelpTips,v=n.Status,m=On(n),g=m.dragEvent,h=(0,ye.c)(m,Bo),y=(0,w.useContext)(ae),C=y.prefixCls,E=y.fieldStatusMap,I=y.getKdesignerApi,x=y.billPropsData,N=y.fieldStatusSettingMode,T=(I()||{}).data,A=(0,w.useMemo)((function(){var e=T.getParentControl(c),t=T.findControl(c);return e.BillEntityIdEx!==T.getRootId()&&(!(null!=t&&t.RefBillId)&&!(null!=t&&t.RefTableId)&&it(e._Type_)&&Ao(e,(null==x?void 0:x.innerForm)||[]))}),[x,c]),S=A?Yn(n):{},k=jn()(["".concat(C,"-entry-field"),(0,f.c)({"item-mb":i,"item-hidden":v===Xe.HIDDEN},b()(t="".concat(C,"-item-")).call(t,E[u]),E[u])]),D=s,P={};return!l&&(P={height:r}),F().createElement("div",(0,R.c)({className:k},h,g,{"data-entry-field":n.Key,"data-enable-click":"permission"!==N||A}),F().createElement("div",(0,R.c)({className:"cellHead",style:{height:o}},S),F().createElement(Vn.FieldItem.Label,{value:"fseq"===d?"#":D,required:Qn(n,E),tips:p,prefixCls:"nc-field-item",style:{marginBottom:"0",fontWeight:"bold"}})),F().createElement("div",{className:"cellContent",style:Lo({},P)}))},Ko=function(e){var t,n,r,o,a=e.field,i=a.FieldType,l=a.FileMaxSize,c=a.UploadNum,u=a.ImageFileType,s=a.UploadPrompt,f=a.ButtonText,d=(0,w.useContext)(ae).getKdesignerApi,p=On(a),v=d().meta,g=v.getControlPropertyDefaultValue,h=(0,v.getControlMetaEditor)(i,"ImageFileType").Enum,y=g(i,"FileMaxSize"),C=g(i,"ImageFileType"),E=u||C,I=x()(t=E.split(",")).call(t,(function(e){return m()(h).call(h,(function(t){return t.Id===e}))[0].Name})),N=s?b()(n=b()(r=b()(o="请上传小于".concat(l||y,"M的")).call(o,I.join("，"),"文件，文件个数不少于")).call(r,(null==c?void 0:c.min)||0,"个，不多于")).call(n,(null==c?void 0:c.max)||1,"个。"):"";return F().createElement(Xn,(0,R.c)({},p,{field:a}),F().createElement(Vn.Picture,(0,R.c)({style:{fontSize:"12px",textAlign:"left",pointerEvents:"none"},noticeInfo:N,buttonText:f,pasteThumbnail:!1},{})))},Vo=n(5680),zo=n.n(Vo),Go=function(e){var t,n,r,o=e.field,a=o.FieldType,i=o.FileMaxSize,l=o.UploadNum,c=o.UploadModel,u=(o.UploadPrompt,o.ButtonText),s=o.AttachmentFileType,f=(0,w.useContext)(ae).getKdesignerApi,d=On(o),p=f().meta,v=p.getControlPropertyDefaultValue,m=(p.getControlMetaEditor,v(a,"FileMaxSize")),g=b()(t=b()(n=b()(r="请上传小于".concat(i||m,"M的")).call(r,null==s?void 0:zo()(s).call(s,".",""),"文件，文件个数不少于")).call(n,(null==l?void 0:l.min)||0,"个，不多于")).call(t,(null==l?void 0:l.max)||1,"个。");return F().createElement(Xn,(0,R.c)({},d,{field:o}),F().createElement(Vn.Attachment,(0,R.c)({style:{fontSize:"12px",textAlign:"left",pointerEvents:"none"},fileList:[],mode:c,uploadNum:l,noticeInfo:g,buttonText:u,pasteThumbnail:!1},{})))},Ho=function(e){var t=e.field,n=On(t),r=window.__kd_cdnPath__||window.__domainurl__,o=t.NoCodeDefValue,a=t.DefaultHeight,i=t.Status,l=t.AutoHeight,c=i===Xe.READONLY,u=i===Xe.DISABLED;return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Vn.RichText,{height:a,autoHeight:l,content:o,srcUrl:r,readOnly:c,disabled:u,isDesigner:!0}))},qo=function(e){var t=e.field,n=On(t),r=t.Content,o=t.Margin,a=t.DefaultHeight,i=t.AutoHeight,l=Qt(o),c=l.margin,u=l.marginTop,s=l.marginRight,f=l.marginBottom,d=l.marginLeft,p={marginTop:"".concat(u,"px"),marginRight:"".concat(s,"px"),marginBottom:"".concat(f,"px"),marginLeft:"".concat(d,"px")},v=-1===c?p:{margin:"".concat(c,"px")};return F().createElement("div",{className:"graphic-display-ap",style:"0"!==c?v:{}},F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Vn.GraphicDisplay,{content:r,autoHeight:i,defaultHeight:a})))},Yo=n(1184),Wo=function(e){var t,n=(0,w.useContext)(ae),r=(n.isPC,n.getKdesignerApi),o=(0,w.useMemo)((function(){return r()}),[]).data,a=(o.getData(),e.ParentId),i=e.GroupParentId,l=o.getSubControls(a);return hn()(t=m()(l).call(l,(function(e){return e.GroupParentId===i}))).call(t,(function(e,t){return Number(e.GroupIndex)-Number(t.GroupIndex)}))};function Qo(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qo(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Qo(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Zo=function(e){if(!e)return{};var t=ie({Id:e}),n=ln(),r=ne({Id:e}),o=Pn({Id:e});return Xo(Xo(Xo({},t),{},{onMouseDown:n},r),o)},Jo=["controlId","parentColumn","className"];function $o(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ta=function(e){var t=e.controlId,n=e.parentColumn,r=e.className,o=(0,ye.c)(e,Jo),a=(0,w.useContext)(ae),i=a.prefixCls,l=a.getKdesignerApi,c=a.isPC,u=l().data,s=u.getData(),f=u.findControl,d=Un({Id:t},s,{isPC:c,excludeType:Ke},f);return F().createElement(Vn.GridPanel,(0,R.c)({column:0===d.length?1:n},o),d.length>0?x()(d).call(d,(function(e){var t,r,o,a=(null==e||null===(t=e.props)||void 0===t?void 0:t.field)||{},i=a.ColumnSpan,l=a.key,c=a.id,u=(o=i,Math.min(n,Number(o)||4));return null!=e&&null!==(r=e.props)&&void 0!==r&&null!==(r=r.field)&&void 0!==r&&r.ColumnSpan&&(e.props.field.ColumnSpan=u),F().cloneElement(e,{key:c,itemKey:e.key||l,columnSpan:u})})):F().createElement("div",(0,R.c)({className:jn()(r,"".concat(i,"_group_item_dropbox")),columnSpan:4},o),"拖拽内容到这里"))},na=(0,w.memo)((function(e){var t=e.id,n=e.hidden,r=e.defaultBar,o=e.handleItemClick,a=(0,w.useContext)(ae),i=a.getKdesignerApi,l=a.fieldStatusMap,c=(a.prefixCls,a.fieldStatusSettingMode),u=(0,w.useMemo)((function(){return i()}),[]).data.findControl(t),s=u.Status,f=u.Key,d=Zo(t),p=(0,R.c)({},((0,Yo.c)(d),d)),v=Yn({Id:t},!1),m=null==l?void 0:l[f];return F().cloneElement(r,ea(ea(ea({id:t,"data-group-bar-item-id":t},p),v),{},{"data-enable-click":"permission"!==c,style:{color:n?"#cccccc":"inherit",opacity:(s!==Xe.HIDDEN||c&&m)&&"hidden"!==m?"1":"0.5"},onClick:function(e){o(t)}}))}));na.displayName="TabBar";var ra=function(e){var t,n=e.id,r=e.columnSpan,o=(0,w.useContext)(ae),a=o.getKdesignerApi,i=o.fieldStatusMap,l=o.prefixCls,c=(0,w.useMemo)((function(){return a()}),[]).data.findControl(n),u=(c.Status,c.Key),s=Mn(c);return F().createElement(ta,(0,R.c)({key:n,controlId:n,parentColumn:r,"data-group-container-item":n,className:jn()((0,f.c)({},b()(t="".concat(l,"-item-")).call(t,i[u]),i[u]))},s))},oa=function(e){var t,n=e.field,r=e.columnSpan,o=(0,w.useContext)(ae),a=o.getKdesignerApi,i=o.fieldStatusMap,l=o.prefixCls,c=o.fieldStatusSettingMode,u=(0,w.useMemo)((function(){return a()}),[]),d=u.selection,p=(u.data,n.Id),v=n.Key,m=(n.Name,n.TitleArea,n.Collapse),g=(n.HelpTips,n.ColumnSpan,(0,w.useState)(p)),h=(0,s.c)(g,2),y=h[0],C=h[1],E=(0,w.useRef)([]),I=(0,w.useRef)(null),x=(0,w.useReducer)((function(e){return e+1}),0),N=(0,s.c)(x,2);N[0],N[1];(0,w.useEffect)((function(){if(I.current){var e=I.current.querySelector("[data-tabs-header]");null==e||e.setAttribute("data-group-bar",p)}}),[]);var T=Wo(n).reduce((function(e,t){var n=t.Id,o=t.Name,a=t.TitleArea,i=t.HelpTips;return e.push({id:n,name:o,titleHidden:vt(a),tips:i,key:n,label:o,children:F().createElement(ra,{id:n,columnSpan:r})}),e}),[]);E.current=T,(0,w.useEffect)((function(){var e=d.getSelection()||[],t=e[0];if(t){var n,r=Te()(T).call(T,(function(e){return e.id===t}))?null==e?void 0:e[0]:null==T||null===(n=T[0])||void 0===n?void 0:n.id;C(r),document.querySelectorAll("[".concat(W,"=true]")).forEach((function(t){S()(e).call(e,t[H])||null==t||t.removeAttribute(W)}))}}),[T.length]);var A=function(e){"permission"!==c&&y!==e&&(en(y,e),C(e),d.setSelect(e))},k=function(){var e,t=d.getActiveSelectedId();(null===(e=E.current)||void 0===e?void 0:Te()(e).call(e,(function(e){return e.id===t})))&&y!==t&&C(t)};(0,w.useEffect)((function(){var e=d.addSelectChangeListener(k);return function(){e()}}),[k]);var D=Zo(y),P=(0,R.c)({},((0,Yo.c)(D),D)),M=Mn(n),_=1===T.length?M:{};return F().createElement(Vn.Tabs,(0,R.c)({ref:I,activeKey:y,allowCollapse:m,onChange:A,"data-group-container":p},P,_,{"data-enable-click":"permission"!==c,renderTabBar:function(e,t){return F().createElement(na,(0,R.c)({},e,{defaultBar:t,handleItemClick:A}))},items:T,className:jn()((0,f.c)({},b()(t="".concat(l,"-item-")).call(t,i[v]),1===T.length&&i[v]))}))},aa=["dragEvent"],ia=(0,w.memo)((function(e){var t=e.field,n=(0,w.useContext)(ae).prefixCls,r=On(t),o=r.dragEvent,a=(0,ye.c)(r,aa),i=t.Name;t.EmptyText,t.DataRage,t.showClearButton,t.Status,t.Visibility;return F().createElement("div",(0,R.c)({className:"".concat(n,"-bizbutton")},a,o),F().createElement(Vn.BtnField,null,i))}));ia.displayName="NoCodeBizButtonAp";var la={NoCodeTextField:tr,NoCodeSelectItemField:nr,NoCodeRefBillField:xr,NoCodeMulRefBillField:xr,NoCodeTextAreaField:Nr,NoCodeDecimalField:Tr,NoCodeDateField:Sr,NoCodeDateRangeField:wr,NoCodeEntryEntity:Mr,NoCodeRefBillTable:Mr,NoCodeEntryFieldAp:Uo,NoCodeImageUploadField:Ko,NoCodeAttachmentUploadField:Go,NoCodeCreateDateField:tr,NoCodeCreatorField:tr,NoCodeModifyDateField:tr,NoCodeModifierField:tr,NoCodeBillNoField:tr,NoCodeGroupContainerAp:oa,NoCodeBizButtonAp:ia,NoCodeRichTextField:Ho,NoCodeGraphicDisplayField:qo},ca=function(e){var t=e.field,n=On(t);return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement($n,{type:"Text",field:t,props:{}}))},ua=function(e){var t,n=e.field,r=n._Type_,o=n.ShowType,a=On(n),i=Mt(n),l=Ot(n),c={readonlyValue:Dt(n),options:Rt(n),defaultValue:l,value:l,multiple:Pt(null==n?void 0:n.SelectItemType),showBgcBlock:_t(n)};return S()(t=["Checkbox","Radio"]).call(t,i)&&(c.vertical=Bt(null==n?void 0:n.TileTypePc)),$e(r)&&"2"===o?null:F().createElement(Xn,(0,R.c)({},a,{field:n}),F().createElement($n,{type:i,field:n,props:c}))},sa=function(e){var t=e.field,n=On(t),r=t.CounterDisplay,o=t.DefaultLines,a={showCount:!!(0,we.isUndefined)(r)||r,autoSize:{minRows:o,maxRows:o}};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement($n,{type:"Textarea",field:t,props:a}))},fa=function(e){var t=e.field,n=On(t),r=(t.EmptyText,t.DefValue,t.showClearButton,t.Status,t.ThousandsSeparator),o=t.Scale,a=t.Precision,i=t.Stepper,l={borderType:"bordered",readOnly:!0,allowClear:!1,formatter:(0,w.useCallback)((function(e){return r?"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","):String(e)}),[r]),decimalLength:o,showStepper:i,maxLength:a};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement($n,{type:"Number",field:t,props:l}))},da={0:"second",1:"day"},pa=function(e){var t=e.field,n=On(t),r={borderType:"bordered",picker:da[t.FormatType||"1"]};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement($n,{type:"DatePicker",field:t,props:r}))},va={0:"second",1:"day"},ma=function(e){var t=e.field,n=On(t),r={borderType:"bordered",picker:va[t.FormatType||"1"]};return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement($n,{type:"DateRangePicker",field:t,props:r}))},ga=function(e){var t,n,r,o,a=e.field,i=(0,w.useContext)(ae).getKdesignerApi,l=a.FieldType,c=a.FileMaxSize,u=a.UploadNum,s=a.ImageFileType,f=i().meta,d=f.getControlPropertyDefaultValue,p=(0,f.getControlMetaEditor)(l,"ImageFileType").Enum,v=d(l,"FileMaxSize"),g=d(l,"ImageFileType"),h=s||g,y=x()(t=h.split(",")).call(t,(function(e){return m()(p).call(p,(function(t){return t.Id===e}))[0].Name})),C=On(a),E={disabled:!0,noticeInfo:b()(n=b()(r=b()(o="请上传小于".concat(c||v,"M的")).call(o,y.join(),"文件，文件个数不少于")).call(r,(null==u?void 0:u.min)||0,"个，不多于")).call(n,(null==u?void 0:u.max)||1,"个。")};return F().createElement(Xn,(0,R.c)({},C,{field:a}),F().createElement($n,{type:"Picture",field:a,props:E}))},ha=function(e){var t,n,r,o=e.field,a=o.FieldType,i=o.FileMaxSize,l=o.UploadNum,c=o.UploadModel,u=o.UploadPrompt,s=o.ButtonText,f=o.AttachmentFileType,d=(0,w.useContext)(ae).getKdesignerApi,p=On(o),v=(0,d().meta.getControlPropertyDefaultValue)(a,"FileMaxSize"),m=u?b()(t=b()(n=b()(r="请上传小于".concat(i||v,"M的")).call(r,null==f?void 0:zo()(f).call(f,".",""),"文件，文件个数不少于")).call(n,(null==l?void 0:l.min)||0,"个，不多于")).call(t,(null==l?void 0:l.max)||1,"个。"):"";return F().createElement(Xn,(0,R.c)({},p,{field:o}),F().createElement(zn.Attachment,(0,R.c)({style:{fontSize:"12px",textAlign:"left"},fileList:[],mode:c,uploadNum:l,noticeInfo:m,buttonText:s},{disabled:!0})))},ya=function(e){var t=e.field,n=On(t),r=t.NoCodeDefValue,o=t.DefaultHeight,a=t.AutoHeight,i=t.Status===Xe.READONLY,l=Qt(r);return F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(zn.RichText,{readOnly:i,content:(null==l?void 0:l.value)||"",height:o,autoHeight:a}))},ba=function(e){var t=e.field,n=On(t),r=t.Content,o=t.Margin,a=t.DefaultHeight,i=t.AutoHeight,l=Qt(o),c=l.margin,u=l.marginTop,s=l.marginRight,f=l.marginBottom,d=l.marginLeft,p={marginTop:"".concat(u,"px"),marginRight:"".concat(s,"px"),marginBottom:"".concat(f,"px"),marginLeft:"".concat(d,"px")},v=-1===c?p:{margin:"".concat(c,"px")};return F().createElement("div",{className:"graphic-display-ap",style:"0"!==c?v:{}},F().createElement(Xn,(0,R.c)({},n,{field:t}),F().createElement(Vn.GraphicDisplay,{content:r,autoHeight:i,defaultHeight:a})))},Ca=["controlId"],Ea=["defaultBar","handleItemClick"];function Ia(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function xa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ia(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Na=function(e){var t=e.controlId,n=(0,ye.c)(e,Ca),r=(0,w.useContext)(ae),o=r.prefixCls,a=r.getKdesignerApi,i=r.isPC,l=a().data,c=l.getData(),u=l.findControl,s=Un({Id:t},c,{isPC:i,excludeType:Ke},u);return F().createElement(zn.GridPanel,(0,R.c)({gutter:[24,24]},n),s.length>0?s:F().createElement("div",(0,R.c)({className:"".concat(o,"_group_item_dropbox")},n),"拖拽内容到这里"))},Ta=(0,w.memo)((function(e){var t=e.defaultBar,n=e.handleItemClick,r=(0,ye.c)(e,Ea),o=r.id,a=r.tips,i=Zo(o),l=Yn({Id:o},!1);return F().cloneElement(t,xa(xa(xa({id:o,"data-group-bar-item-id":o,tips:a},i),l),{},{onClick:function(e){n(o),i.onClick(e)}}))}));Ta.displayName="TabBar";var Aa=function(e){var t=e.id;return F().createElement(Na,{key:t,controlId:t,"data-group-container-item":t})},Sa=function(e){var t=e.field,n=(0,w.useContext)(ae),r=n.getKdesignerApi,o=(n.prefixCls,r().selection),a=t.Id,i=(t.Name,t.TitleArea,t.HelpTips,t.Collapse),l=(0,w.useState)(a),c=(0,s.c)(l,2),u=c[0],f=c[1],d=(0,w.useRef)([]),p=(0,w.useRef)(null);(0,w.useEffect)((function(){if(p.current){var e=p.current.querySelector("[data-tabs-header]");null==e||e.setAttribute("data-group-bar",a)}}),[]);var v=Wo(t).reduce((function(e,t){var n=t.Id,r=t.Name,o=t.TitleArea,a=t.HelpTips;return e.push({id:n,name:r,titleHidden:vt(o),tips:a,key:n,label:r,children:F().createElement(Aa,{id:n})}),e}),[]);d.current=v;var m=function(){var e,t=o.getActiveSelectedId();(null===(e=d.current)||void 0===e?void 0:Te()(e).call(e,(function(e){return e.id===t})))&&f(t)};(0,w.useEffect)((function(){var e=o.getSelection();null!=e&&e[0]&&(Te()(v).call(v,(function(t){return t.id===(null==e?void 0:e[0])}))&&f(null==e?void 0:e[0]))}),[v.length]),(0,w.useEffect)((function(){var e=o.getSelection();if((null==e?void 0:e[0])===u&&!Te()(v).call(v,(function(e){return e.id===u}))){var t=null==v?void 0:v[0].id;en(u,t,(function(e){e.removeAttribute(W)})),f(t)}}),[v,u]),(0,w.useEffect)((function(){m();var e=o.addSelectChangeListener(m);return function(){e()}}),[]);var g=function(e){o.setSelect([e]),f(e)},h=Zo(u);return F().createElement(zn.Tabs,(0,R.c)({ref:p,activeKey:u,allowCollapse:i,onChange:g,"data-group-container":a,items:v,renderTabBar:function(e,t){return F().createElement(Ta,(0,R.c)({},e,{defaultBar:t,handleItemClick:g}))}},h))},wa=["NoCodeImageUploadField","NoCodeAttachmentUploadField"],Fa=function(e){var t=e.field,n=t._Type_,r=(t.ShowBatImportBtn,t.ShowBatExportBtn,t.ShowSeqField),o=(t.ShowType,(0,w.useContext)(ae)),a=o.getKdesignerApi,i=o.prefixCls,l=a(),c=l.data,u=l.meta,s=c.getData(),f=c.findControl,d=u.getControlPropertyDefaultValue(n,"SeqName"),p=t.SeqName,v=void 0===p?d:p,m=Un(t,s,{isPC:!1},f),g=(0,w.useMemo)((function(){var e,t;if(r)return"".concat(v,"：1");var n=Te()(m).call(m,(function(e){var t,n=(null==e||null===(t=e.props)||void 0===t?void 0:t.field)._Type_;return!S()(wa).call(wa,n)}));if(!n)return"-";var o=null==n||null===(e=n.props)||void 0===e?void 0:e.field,a=o.Name,i=o.DefValue;return b()(t="".concat(a,"：")).call(t,i||"-")}),[r,v,m]);return m.length?F().createElement(F().Fragment,null,F().createElement("div",{className:"".concat(i,"-entry-mb-operator")},F().createElement(P.Button,{type:"ghost",size:"small",icon:F().createElement(P.Icon,{prefix:"ncicon",type:"zengjia-yuan"})},"新增"),F().createElement(P.Button,{size:"small",icon:F().createElement(P.Icon,{prefix:"ncicon",type:"xuanze"})},"选择")),F().createElement("div",{className:"".concat(i,"-entry-mb-item")},F().createElement(zn.CollapsePanel,{isOpen:!0,title:g,extra:F().createElement(P.Icon,{prefix:"designericon",type:"shanchu"}),transitionDuration:0},x()(m).call(m,(function(e,t){return F().createElement("div",{className:"".concat(i,"-entry-mb-sub-control"),key:t},e)}))))):F().createElement("div",{className:"".concat(i,"-entry-mb-empty")},"拖拽或点击添加内容")},ka=function(e){var t=e.field,n=t._Type_,r=t.ShowType,o=On(t);return it(n)&&"1"===r?null:F().createElement(Xn,(0,R.c)({field:t,tipsTrigger:"click"},o),F().createElement(Fa,{field:t}))},Da={NoCodeTextField:ca,NoCodeSelectItemField:ua,NoCodeDecimalField:fa,NoCodeRefBillField:ua,NoCodeMulRefBillField:ua,NoCodeTextAreaField:sa,NoCodeGroupContainerAp:Sa,NoCodeEntryEntity:ka,NoCodeRefBillTable:ka,NoCodeCreateDateField:ca,NoCodeCreatorField:ca,NoCodeModifyDateField:ca,NoCodeModifierField:ca,NoCodeBillNoField:ca,NoCodeDateField:pa,NoCodeDateRangeField:ma,NoCodeAttachmentUploadField:ha,NoCodeImageUploadField:ga,NoCodeRichTextField:ya,NoCodeGraphicDisplayField:ba};function Pa(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pa(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Ra={UndefinedControl:Ln,RootPanel:Hn},_a=Ma(Ma(Ma({},la),Da),Ra);function Oa(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ba(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Oa(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ja=function(e){var t,n,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).isPC,o=void 0===r||r,a=e.ParentId,i=e._Type_,l=e.Id,c=e._isEntryField_,u=(0,F().useContext(ae).getKdesignerApi)(),s=u.meta,f=(u.data.getSubControls(l).length,null===(t=s.getControlMeta(i))||void 0===t?void 0:t.IsContainer),d=Ba(Ba({},s.getDefaultData(i)),e),p=b()(n="".concat(f?"".concat(l):l,"-")).call(n,d.Visibility),v={field:Xt(d),key:p,_IsContainer:f};if(!a)return F().createElement(_a.RootPanel,v);var m,g,h=(g=o,m=$e(m=o&&c?"NoCodeEntryFieldAp":i)?"NoCodeRefBillField":m,g?la[m]:Da[m]);return h?F().createElement(h,v):F().createElement(_a.UndefinedControl,v)},La=function(e){var t=e.value;e.oldValue.forEach((function(e){var t;document.querySelectorAll(b()(t="[".concat(H,'="')).call(t,e,'"]')).forEach((function(e){return null==e?void 0:e.removeAttribute(W)}))})),t.forEach((function(e){var t;document.querySelectorAll(b()(t="[".concat(H,'="')).call(t,e,'"]')).forEach((function(e){null==e||e.setAttribute(W,"true"),e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView({block:"nearest"})}))}))},Ua=n(4496),Ka=n.n(Ua),Va="nocodedesigner.CopyContent",za="nocodedesigner.CopyIds",Ga=function(e){window.sessionStorage.setItem(Va,Ka()(e))},Ha=function(){var e=window.sessionStorage.getItem(Va);return e&&(e=JSON.parse(e)),e},qa=function(e){window.sessionStorage.setItem(za,Ka()(e))},Ya=function(){var e=window.sessionStorage.getItem(za);return e&&(e=JSON.parse(e)),e},Wa=function(){window.sessionStorage.removeItem(Va),window.sessionStorage.removeItem(za)},Qa=function(){var e=(0,w.useContext)(ae).getKdesignerApi,t=(0,w.useMemo)((function(){return e()}),[]).selection.getSelection;return{setCopyContent:Ga,getCopyContent:Ha,setCopyIds:qa,getCopyIds:Ya,setDatasetCutControl:function(){t().forEach((function(e){var t;document.querySelectorAll(b()(t="[".concat(H,'="')).call(t,e,'"]')).forEach((function(e){e.setAttribute(X,"true")}))}))},removeDatasetCutControl:function(){var e=document.querySelectorAll("[".concat(X,"]"));return e.length&&e.forEach((function(e){e.removeAttribute(X)})),e.length},clearCopyContent:Wa}},Xa=function(e,t,n,r,o,a,i,l){var c=e.getSelection,u=e.setSelect,s=(e.getActiveSelectedId,c());if(s.length>0){if(S()(s).call(s,r))return n("禁止删除根节点");var f=m()(s).call(s,(function(e){return e!==r})),d=t.getData().Items,p=Te()(d).call(d,(function(e){return S()(f).call(f,e.Id)}));if(!p)return;var v=p.Id,g=p.ParentId,h=p._Type_,y=(p.RefBillId,p.RefTableId,p.GroupIndex);if(1===f.length){var b=t.getNextSelectedControlId(v),C=t.findControl(b);b===g&&ct(h)?g=r:!C||b===v||wo(C)||gt(h)&&0===Number(y)&&1===Number(C.GroupIndex)||(g=b)}else if(ct(h)){var E=t.findControlByCondition((function(e){return e.ParentId===g&&!S()(f).call(f,e.Id)}));g=E.length?E[0].Id:r}else{var I=t.getPrevSibling(v).control;I&&(g=I.Id)}Ro(f,o,a,t,i,l,(function(){u([g])}))}},Za=function(e,t){var n=(0,w.useContext)(ae),r=n.getKdesignerApi,o=(n.invokeSaveAction,n.fieldStatusSettingMode),a=n.pubUIAction,i=n.billPropsData,l=n.dispatchBillData,c=n.getHideFieldRef,u=n.setHideFieldRef,s=(0,w.useMemo)((function(){return r()}),[]),f=s.data,d=s.selection,p=s.meta,v=f.getRootId(),g=d.getSelection,h=d.setSelect,y=d.getActiveSelectedId,C=(0,w.useContext)(k.GlobalConfigContext),E=C.showMessage,I=C.keywordMapping,N=Qa(),T=N.setCopyContent,A=N.getCopyContent,F=N.setCopyIds,D=N.getCopyIds,P=N.setDatasetCutControl,R=N.removeDatasetCutControl,O=N.clearCopyContent;(0,w.useEffect)((function(){var t=e.current;if(t&&!o){var n=function(e){var n=(e.target||{}).className;if("nocode-designer-designer-field-item-edit"!==(void 0===n?"":n)){var r=g(),o=y(),N=e.keyCode;switch(N){case k.keyCode.BACKSPACE:case k.keyCode.DELETE:e.preventDefault(),Xa(d,f,E,v,i,l,c(),u),r.length>0&&setTimeout((function(){return t.focus()}),50);break;case k.keyCode.ESC:e.preventDefault();var w=s.selection.getActiveSelectedId();if(w!==s.data.getRootId()){var B=s.data.findControl(w),j=s.data.findControlByCondition((function(e){return e.Id===B.ParentId}))[0];if(j._Root_)return;h(j.Id)}break;case k.keyCode.C:if(e.preventDefault(),e.ctrlKey){null==e||e.stopPropagation();var U=g().reduce((function(e,t){var n,r,o=f.findControl(t),a=p.getControlMeta((null==o?void 0:o.FieldType)||o[L]),i=a.Inside,l=a.CategoryId,c=a.Name;if(i)return e;if(S()(l).call(l,je))return E("".concat(c,"只能在画布中添加一次，不能复制")),e;if(gt(o[L])&&(null===(r=f.getAllSubControls(o.Id))||void 0===r?void 0:m()(r).call(r,(function(e){return $e(e[L])||it(e[L])}))).length>0)return E("分组内包含关联表单或表格，不能复制"),e;return $e(o[L])||it(o[L])?(E("无法复制关联表单与表格控件"),e):b()(n=[]).call(n,(0,M.c)(e),[o])}),[]);T(U),F(U.reduce((function(e,t){var n=f.getAllSubControlIds(null==t?void 0:t.Id)||[];return b()(e).call(e,n)}),[]))}break;case k.keyCode.V:if(e.preventDefault(),e.ctrlKey){var K=A();if(Array.isArray(K)){var z,G=R()>0;f.getData();if(G){var H=K.reduce((function(e,t){var n;return b()(n=[t[_]]).call(n,(0,M.c)(e))}),[]);if(S()(H).call(H,o))return;return f.getAllParentControlIds(o).some((function(e){return S()(H).call(H,e)}))?void E("当【源控件】是【目标控件】的父级时，无法剪切/粘贴"):void f.swapControl((0,k.createSwapAction)({origin:H,target:o})).then((function(e){d.setSelect([H[0]]),O()}))}var q=f.findControl(o),Y=q.FieldType,W=q[L],Q=o,X=p.getControlMeta(Y||W).IsContainer;X&&!it(W)||(Q=f.getParentControlId(o));var Z=D(),J={Items:f.findControlByCondition((function(e){return null==Z?void 0:S()(Z).call(Z,e.Id)}))},$=K.reduce((function(e,t){var n=Ft(J,t,Q);return b()(e).call(e,an(n,v))}),[]),ee=f.findControlIndex(o);if(X){var te=f.getSubControls(o),ne=te.length;ne>0&&(ee=f.findControlIndex(te[ne-1][_]))}var re=m()(z=x()($).call($,(function(e){return f.findControl(e.ParentId)?e.Id:null}))).call(z,Boolean);f.addControl((0,k.createPasteAction)($,{index:ee+1})).then((function(e){var t=m()(re).call(re,(function(e){return f.findControl(e)}));h(t)}))}}break;case k.keyCode.X:if(e.preventDefault(),e.ctrlKey){null==e||e.stopPropagation();var oe=g(),ae=[],ie=[];oe.forEach((function(e){var t=f.findControl(e);it(t[L])||$e(t[L])||(ae.push(t),ie.push(e))})),F(ie),T(ae),P()}break;case k.keyCode.ENTER:var le,ce;e.preventDefault();var ue=y({dataContext:f,selectionContext:d}),se=f.findControl(ue);se=f.getContainerControl(se);var fe=p.canAdd("NoCodeTextField",se[I.type]);if(!(!0===fe||"object"===(0,be.c)(fe)&&fe.success))return;a({eventName:"enter",action:"fd_add_enter"});var de=null===(le=p.getControlMeta(null===(ce=se)||void 0===ce?void 0:ce[I.type]))||void 0===le?void 0:le.IsContainer,pe=(0,k.createControlData)(f.getMeta(),C)({type:"NoCodeTextField",parentId:de?se[I.id]:v}),ve=se[I.id]===ue?-1:f.findControlIndex(ue)+1;f.addControl((0,k.createAddAction)(pe,{index:ve})).then((function(e){if(null!=e&&e.length){var t=e[0].value;d.setSelect(Array.isArray(t)?[t[0][I.id]]:[t[I.id]])}}));break;case k.keyCode.D:if(e.preventDefault(),N===k.keyCode.D&&!e.ctrlKey)return;var me=f.getData(),ge=d.getSelection(),he=function(e){var t=p.getControlMeta(e[L]),n=t.CategoryId,r=t.Name;return!S()(n).call(n,je)||(E("".concat(r,"只能在画布中添加一次，不能重复")),!1)};if(ge.length>1){var ye=ge.reduce((function(e,t){var n=f.findControl(t);if(!he(n))return e;var r=Ft(me,n,n[V]);return b()(e).call(e,an(r,v))}),[]);f.addControl((0,k.createPasteAction)(ye)).then((function(){}))}else{var Ce=f.findControl(o);if(!he(Ce))return;var Ee=an(Ft(me,Ce,Ce[V]),v),Ie=f.findControlIndex(Ce[_])+1;f.addControl((0,k.createPasteAction)(Ee,{index:Ie})).then((function(){d.setSelect([Ee[0][_]])}))}break;case k.keyCode.Z:case k.keyCode.Y:e.preventDefault();break;case k.keyCode.LEFT:case k.keyCode.RIGHT:case k.keyCode.UP:case k.keyCode.DOWN:e.preventDefault();var xe=N===k.keyCode.LEFT||N===k.keyCode.UP?f.getPrevSibling(o):f.getNextSibling(o),Ne=xe&&xe.control;Ne&&h([Ne[_]])}}};return t.addEventListener("keydown",n,!0),function(){t.removeEventListener("keydown",n,!0)}}}),[i])},Ja=function(e,t){var n=t.selection,r=e.Id,o=(0,w.useContext)(ae).fieldStatusSettingMode,a=n.setSelect;(0,w.useEffect)((function(){o||a([r])}),[])},$a=(0,k.isMac)(),ei=function(){var e=(0,w.useReducer)((function(e){return e+1}),0),t=(0,s.c)(e,2)[1],n=(0,w.useContext)(ae),r=n.getKdesignerApi,o=n.getPrefixCls,a=n.prefixCls,i=n.billPropsData,l=n.dispatchBillData,c=n.getHideFieldRef,u=n.setHideFieldRef,d=(0,w.useMemo)((function(){return r()}),[]),p=d.data,v=d.selection,g=d.meta,h=(0,w.useContext)(k.GlobalConfigContext).showMessage,y=Qa(),C=y.setCopyContent,E=y.getCopyIds,I=y.setCopyIds,N=y.getCopyContent,T=y.setDatasetCutControl,A=y.removeDatasetCutControl,D=y.clearCopyContent,R=(0,w.useRef)(null),O=o&&o(a,"nav-tool"),B=v.getSelection,j=v.setSelect,U=v.getActiveSelectedId,K=v.addSelectChangeListener,z=p.getRootId(),G=p.canUndo(),q=p.canRedo(),Y=U(),W=p.findControl(Y)[L],Q=g.getControlMeta(W).CategoryId,X=B();(0,w.useEffect)((function(){var e=K(t);return function(){e()}}),[]);var Z=(0,w.useCallback)((function(e){return ct(W)?"back"===e?"forward":"back":e}),[W]),J=(0,w.useMemo)((function(){var e,t=Ut(W),n=null===(e=p.getAllSubControls(Y))||void 0===e?void 0:m()(e).call(e,(function(e){return it(e._Type_)||$e(e._Type_)}));return!!(Y===z||S()(Q).call(Q,je)||it(W)||$e(W)||t&&n.length)}),[z,Y,W]),$=(0,w.useMemo)((function(){return Y===z}),[z,Y]),ee=$||X.length>1,te=((0,w.useCallback)((function(){q&&p.redo()}),[q]),(0,w.useCallback)((function(){G&&p.undo()}),[G]),function(e){var t=setTimeout((function(){!function(e){var t,n=document.querySelector(b()(t="[".concat(H,'="')).call(t,e,'"]'));n&&(n.scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded():n.scrollIntoView({block:"nearest"}))}(e),clearTimeout(t),t=null}))}),ne=(0,w.useCallback)((function(){var e=B();if(1===e.length){var t=p.findControl(e[0]),n=t.Key,r=t._Type_;if(Ut(r))return void tn(p,t,"forward");var o=p.getPrevSibling(e[0]).control;if(o&&Ut(o._Type_))return void tn(p,o,"back");var a=p.getParentControl(e[0]),i=a.Id,l=a._Type_,c=a.PropsDisplay;if(it(l)){var u=c.split(","),s=n.toLowerCase().replace("_".concat(i.toLowerCase()),""),f=Ur()(u).call(u,(function(e){return e===s}));if(u.length>1&&0!==f){var d=ce()(u).call(u,f,1);ce()(u).call(u,f-1,0,d[0]),p.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[i,{PropsDisplay:u.join()}]]))}}p.moveControl(e[0],Z("forward")),te(e[0])}}),[Z]),re=(0,w.useCallback)((function(){var e=B();if(1===e.length){var t=p.findControl(e[0]),n=t.Key,r=t._Type_;if(Ut(r))return void tn(p,t,"back");var o=p.getNextSibling(e[0]).control;if(o&&Ut(o._Type_))return void tn(p,o,"forward");var a=p.getParentControl(e[0]),i=a.Id,l=a._Type_,c=a.PropsDisplay;if(it(l)){var u=c.split(","),s=n.toLowerCase().replace("_".concat(i.toLowerCase()),""),f=Ur()(u).call(u,(function(e){return e===s}));if(u.length>1&&f!==u.length-1){var d=ce()(u).call(u,f,1);ce()(u).call(u,f+1,0,d[0]),p.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[i,{PropsDisplay:u.join()}]]))}}p.moveControl(e[0],Z("back")),te(e[0])}}),[Z]),oe=(0,w.useCallback)((function(e){null==e||e.stopPropagation();var t=B();if(1!==t.length||z!==t[0]){var n=x()(t).call(t,(function(e){return p.findControl(e)}));I(t),C(n),T()}}),[]),ie=(0,w.useCallback)((function(e){null==e||e.stopPropagation();var t=B();if(1===t.length&&z===t[0])return h("禁止复制根节点");var n=t.reduce((function(e,t){var n,r=p.findControl(t),o=g.getControlMeta((null==r?void 0:r.FieldType)||r[L]),a=o.Inside,i=o.CategoryId,l=o.Name;return a?e:S()(i).call(i,je)?(h("".concat(l,"只能在画布中添加一次，不能复制")),e):it(r[L])||$e(r[L])?(h("关联表单与表格控件，不能复制"),e):b()(n=[]).call(n,(0,M.c)(e),[r])}),[]);C(n),I(n.reduce((function(e,t){var n=p.getAllSubControlIds(t.Id)||[];return b()(e).call(e,n)}),[]))}),[]),le=(0,w.useCallback)((function(){var e=N();if(Array.isArray(e)){var t,n=A()>0;p.getData();if(n){var r=e.reduce((function(e,t){var n;return b()(n=[t[_]]).call(n,(0,M.c)(e))}),[]);if(S()(r).call(r,Y))return;return p.getAllParentControlIds(Y).some((function(e){return S()(r).call(r,e)}))?void h("当【源控件】是【目标控件】的父级时，无法剪切/粘贴"):void p.swapControl((0,k.createSwapAction)({origin:r,target:Y})).then((function(e){v.setSelect([r[0]]),D()}))}var o=p.findControl(Y),a=o.FieldType,i=o[L],l=Y,c=g.getControlMeta(a||i).IsContainer;c||(l=p.getParentControlId(Y));var u=E(),s={Items:p.findControlByCondition((function(e){return null==u?void 0:S()(u).call(u,e.Id)}))},f=e.reduce((function(e,t){var n=Ft(s,t,l);return b()(e).call(e,an(n,z))}),[]),d=p.findControlIndex(Y);if(c){var y=p.getSubControls(Y),C=y.length;C>0&&(d=p.findControlIndex(y[C-1][_]))}var I=m()(t=x()(f).call(f,(function(e){return p.findControl(e.ParentId)?e.Id:null}))).call(t,Boolean);p.addControl((0,k.createPasteAction)(f,{index:d+1})).then((function(e){var t=m()(I).call(I,(function(e){return p.findControl(e)}));j(t)}))}}),[Y]),ue=(0,w.useCallback)((function(e){e.stopPropagation();var t=v.getSelection(),n=p.getData();if(1!==t.length||z!==t[0]){var r=function(e){var t=g.getControlMeta(e[L]),n=t.CategoryId,r=t.Name;return!S()(n).call(n,je)||(h("".concat(r,"只能在画布中添加一次，不能重复")),!1)};if(t.length>1){var o=t.reduce((function(e,t){var o=p.findControl(t);if(!r(o)||$e(o[L])||it(o[L]))return e;var a=Ft(n,o,o[V]);return b()(e).call(e,an(a,z))}),[]);p.addControl((0,k.createPasteAction)(o)).then((function(){}))}else{var a=p.findControl(Y);if(!r(a)||$e(a[L])||it(a[L]))return;var i=an(Ft(n,a,a[V]),z),l=p.findControlIndex(a[_])+1;p.addControl((0,k.createPasteAction)(i,{index:l})).then((function(){v.setSelect([i[0][_]])}))}}}),[Y]),se=jn()("".concat(O,"-operation-btn"));return F().createElement("div",{className:O,ref:R},F().createElement("div",{title:"前移",onClick:ne,className:jn()((0,f.c)({},"".concat(O,"-operation-disable"),ee),se)},F().createElement(P.Icon,{prefix:"designericon",type:"qianyi"})),F().createElement("div",{title:"后移",onClick:re,className:jn()((0,f.c)((0,f.c)({},"".concat(O,"-last-operation"),!0),"".concat(O,"-operation-disable"),ee),se)},F().createElement(P.Icon,{prefix:"designericon",type:"houyi"})),F().createElement("div",{title:"剪切\n".concat($a?"⌘+X":"Ctrl+X"),onClick:J?void 0:oe,className:jn()((0,f.c)({},"".concat(O,"-operation-disable"),J),se)},F().createElement(P.Icon,{prefix:"designericon",type:"jianqie"})),F().createElement("div",{title:"复制\n".concat($a?"⌘+C":"Ctrl+C"),onClick:J?void 0:ie,className:jn()((0,f.c)({},"".concat(O,"-operation-disable"),J),se)},F().createElement(P.Icon,{prefix:"designericon",type:"fuzhi"})),F().createElement("div",{title:"粘贴\n".concat($a?"⌘+V":"Ctrl+V"),onClick:le,className:jn()((0,f.c)({},"".concat(O,"-last-operation"),!0),se)},F().createElement(P.Icon,{prefix:"designericon",type:"zhantie"})),F().createElement("div",{title:"重复",onClick:J?void 0:ue,className:jn()((0,f.c)({},"".concat(O,"-operation-disable"),J),se)},F().createElement(P.Icon,{prefix:"designericon",type:"zhongfu"})),F().createElement("div",{title:"删除\nDelete",onClick:$?void 0:function(){Xa(v,p,h,z,i,l,c(),u)},key:"Delete",className:jn()((0,f.c)({},"".concat(O,"-operation-disable"),$),se)},F().createElement(P.Icon,{prefix:"designericon",type:"shanchu"})))},ti=function(){var e=(0,w.useContext)(ae),t=e.getPrefixCls,n=e.prefixCls,r=e.isPC,o=e.setIsPC,a=t&&t(n,"nav-deviceswitch"),i=function(e){o(e)};return F().createElement("div",{className:a},F().createElement("div",{className:"".concat(a,"-container")},F().createElement("div",{className:jn()("".concat(a,"-container-item"),{actived:r}),onClick:function(){return i(!0)},title:"PC端"},F().createElement("div",{className:"".concat(a,"-container-item-icon")},F().createElement(P.Icon,{prefix:"designericon",type:"PC"}))),F().createElement("div",{className:jn()("".concat(a,"-container-item"),{actived:!r}),onClick:function(){return i(!1)},title:"移动端"},F().createElement("div",{className:"".concat(a,"-container-item-icon")},F().createElement(P.Icon,{prefix:"designericon",type:"shouji2"})))))},ni=[{name:"1列",id:"1",icon:"1lie"},{name:"2列",id:"2",icon:"2lie"},{name:"3列",id:"3",icon:"3lie"},{name:"4列",id:"4",icon:"4lie"}],ri="ColumnSpan",oi=function(){var e=(0,w.useContext)(ae),t=e.prefixCls,n=e.getKdesignerApi,r=e.isPC,o=n(),a=o.data,i=o.meta,l=a.getRootId(),c=a.findControl(l),u=c[ri],s=c._Type_,d=i.getControlPropertyDefaultValue(s,ri),p=String(u||d);return(0,k.useDataChangeForceUpdateEffect)(o),F().createElement("div",{className:jn()("".concat(t,"-column-switch"),{hide:!r})},F().createElement("div",{className:"".concat(t,"-column-switch-wrapper")},x()(ni).call(ni,(function(e){var n=e.id,r=e.icon;return F().createElement("div",{className:jn()("".concat(t,"-column-item"),{"is-active":p===n}),onClick:function(){var e;p!==(e=n)&&a.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[l,(0,f.c)({},ri,e)]]))},key:n,title:"".concat(n,"列")},F().createElement("div",{className:"".concat(t,"-column-item-icon")},F().createElement(P.Icon,{prefix:"designericon",type:r})))}))))},ai=function(){var e=(0,w.useContext)(ae),t=e.getPrefixCls,n=e.prefixCls,r=t&&t(n),o="".concat(r,"-top-view-main"),a=F().createElement("div",{className:o},F().createElement(ei,null),F().createElement(oi,null),F().createElement(ti,null));return F().createElement(k.ViewHeader,{content:a,portalId:o})},ii=function(e){var t=e.Id,n=(0,w.useContext)(ae).getKdesignerApi,r=(0,w.useMemo)((function(){return n()}),[]),o=r.meta,a=r.data.findControl(t)||{},i=a._Type_,l=a.Key,c=a.Multi,u=void 0===c?"0":c,f=a.SelectItemType,d=(o.getControlMeta(i)||{}).Name,p=(0,w.useRef)(null),v=(0,w.useState)(mt(d,a)),m=(0,s.c)(v,2),g=m[0],h=m[1];return(0,k.useDataChangeForceUpdateEffect)(r),(0,w.useEffect)((function(){var e=mt(d,{SelectItemType:f,Multi:u,_Type_:i});h(e)}),[t,i,f,u]),(0,w.useEffect)((function(){if($e(i))return k.eventBus.on("".concat(l,"_refbill"),(function(e){p.current=e.formName,h(mt(p.current,a))})),function(){k.eventBus.off("".concat(l,"_refbill"))}}),[l]),g};function li(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?li(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):li(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ui=(0,w.memo)((function(e){var t=e.field,n=e.className,r=t.Id,o=t._Type_,a=t.BillEntityId,i=t.Id,l=t.Name,c=(0,w.useContext)(ae),u=c.prefixCls,d=c.getKdesignerApi,p=c.invokeAction,v=c.fieldStatusSettingMode,g=c.getHideFieldRef,h=c.setHideFieldRef,y=(0,w.useMemo)((function(){return d()}),[]),C=y.data,E=y.selection,I=y.meta,N=y.error,A=y.controlCacheApi,D=I.getMeta(),R=(C.getParentControl(r)||{})._Type_,B=(0,w.useRef)(),j=(0,w.useRef)([]),U=(0,w.useState)([]),K=(0,s.c)(U,2),z=K[0],G=K[1],H=(0,w.useState)(!1),q=(0,s.c)(H,2),Y=q[0],W=q[1],Q=(0,w.useState)(!1),X=(0,s.c)(Q,2),Z=X[0],J=X[1],$=A.hasCache("controlId",r);(0,k.useOnClickOutside)([B],(function(e){W(!1)})),(0,w.useEffect)((function(){if(W(!1),J(!1),r&&!S()(qe).call(qe,o)&&!v&&!it(R)){if($){var e;if(D.Controls){var n,a,i=C.findControl(t[V]),l=I.getControlMeta(o),c=b()(n=[]).call(n,(0,M.c)(qe),[o,"HiddenControl"]);j.current=m()(a=D.Controls||[]).call(a,(function(e){if(S()(c).call(c,e[_])||!1===e.Visible||(null==l?void 0:l.BaseType)!==(null==e?void 0:e.BaseType))return!1;var t=I.canAdd(e.Id,i[L]);return!0===t||"object"===(0,be.c)(t)&&t.success}))}return G(j.current),void((null===(e=j.current)||void 0===e?void 0:e.length)>0&&J(!0))}var u=t.Key;p("canSwitchFieldTypes",[[u,t.FieldType]],[]);var s=function(e){var t=e[u]||[];0!==t.length?(G(t),(null==t?void 0:t.length)>0&&J(!0)):W(!1)};return k.eventBus.on(vr,s),function(){k.eventBus.off(vr,s)}}}),[i,o,$]);var ee=ii(t),te=(0,w.useMemo)((function(){if(o)return sn(o)}),[o,sn]),ne="".concat(u,"_contextmenu_panel");return F().createElement("div",{className:jn()(n,"switchfield")},F().createElement("div",{className:"switchfield_content"},te&&F().createElement(P.Icon,{prefix:"designericon",type:te,className:"switchfield_content_icon"}),F().createElement("span",{className:"switchfield_content_name"},o?ee||"":"批量编辑")),Z&&F().createElement(k.DropDownPanel,{scrollHidden:!0,popperClassName:"".concat(u,"_contextmenu"),visible:Y,onVisibleChange:function(e){return W(e)},placement:"bottomLeft",content:Y&&F().createElement("div",{ref:B,className:ne},x()(z).call(z,(function(e){var n,r="",c="";"object"===(0,be.c)(e)?(r=e.Id,c=e.Name):(r=e,c=null===(n=I.getControlMeta(r))||void 0===n?void 0:n.Name);return F().createElement("div",{key:r,title:c,className:"".concat(ne,"_item"),onClick:function(){return function(e){if(e){var n,r="";if($e(o)){if(r=I.getControlMeta(b()(n="".concat(o,"_")).call(n,a)).Name,null!=t&&t.RefTableId){var c=ci({},g()),u=T()(c).reduce((function(e,n){return n.ParentId!==(null==t?void 0:t.RefTableId)&&n.Id!==(null==t?void 0:t.RefTableId)?ci(ci({},e),{},(0,f.c)({},n.Id,n)):e}),{});h(u)}}else r=I.getControlMeta(o).Name;var s=(r||l)===l,d=I.getControlMeta(e).Name,p=s?{Name:d}:{};C.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[i,ci((0,f.c)({},O,e),p)]])).then((function(){E.setSelect([i]),N.getError(i)&&N.deleteError([i]),W(!1)})).catch((function(e){}))}}(r)}},F().createElement(P.Icon,{prefix:"designericon",type:sn(r),className:"nocode-designer-control-icon"}),F().createElement("p",{className:"".concat(ne,"_item_text")},c))})))},F().createElement("div",{className:"switchfield_action"},F().createElement(P.Icon,{prefix:"designericon",type:"qiehuan",className:"operation-bar-name-icon"}),F().createElement("span",{className:"switchfield_action_text"},"转换"))))}));ui.displayName="SwitchField";var si=ui,fi=function(e,t){var n=t.Hide;return!(!n||"object"!==(0,be.c)(n))&&n.Hide},di=(0,w.memo)((function(){var e=(0,w.useContext)(ae).prefixCls,t=(0,w.useState)(!1),n=(0,s.c)(t,2),r=n[0],o=n[1],a=(0,w.useRef)({}),i=(0,w.useRef)({}),l=(0,w.useRef)(null);return(0,k.useOnClickOutside)([l],(function(e){o(!1)})),(0,w.useEffect)((function(){var e=function(e){var t,n=e.event,r=e.field,l=n.pageX,c=n.pageY;a.current.style.cssText+=b()(t=";left: ".concat(l,"px;top: ")).call(t,c,"px;"),i.current=r,o(!0)};return k.eventBus.on("contextmenu",e),function(){k.eventBus.off("contextmenu",e)}}),[]),(0,w.useEffect)((function(){var e=function(e){var t=document.getElementById("app");(!t||null!=t&&t.contains(e.target))&&r&&o(!1)};return window.addEventListener("scroll",e,!0),function(){window.removeEventListener("scroll",e,!0)}}),[r]),(0,re.createPortal)(F().createElement("div",{ref:a,className:"".concat(e,"_contextmenu")},F().createElement(k.DropDownPanel,{popperClassName:"".concat(e,"-quick-setting-dropdown"),visible:r,onVisibleChange:function(e){return o(e)},placement:"bottomLeft",content:F().createElement(gi,{ref:l,controlId:i.current.Id,field:i.current,prefixCls:e})})),document.body)})),pi=di;function vi(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function mi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vi(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var gi=(0,w.memo)((0,w.forwardRef)((function(e,t){var n,r=e.prefixCls,o=e.controlId,a=(0,w.useContext)(ae).getKdesignerApi,i=(0,w.useMemo)((function(){return a()}),[]),l=i.meta,c=i.data,u=c.findControl(o),s=(u||{})._Type_,f=c.getData(),d=l.getDefaultData(s),p=l.getControlMeta(s),v=(0,w.useMemo)((function(){return mi(mi({},d),u)}),[d,u]),m=(0,k.getModelData)(p.Properties,mi(mi({},f),{},{field:v}))||[],g=hn()(n=function(e,t,n){var r,o=[],a=Nt(e);try{for(a.s();!(r=a.n()).done;){var i=r.value,l=i.Nodes,c=void 0===l?[]:l,u=i.Key;if(0===t.length||S()(t).call(t,u)){var s,f=Nt(c);try{for(f.s();!(s=f.n()).done;){var d=s.value;!1!==d.Visible&&n(d)&&o.push(d)}}catch(e){f.e(e)}finally{f.f()}}}}catch(e){a.e(e)}finally{a.f()}return o}(m,[],(function(e){var t;return!fi(0,e)&&(null==e||null===(t=e.Editor)||void 0===t?void 0:t.EnableQuickSetting)}))).call(n,(function(e,t){return e.GroupSubSeq-t.GroupSubSeq}));return(0,k.useDataChangeForceUpdateEffect)(i),null!=u&&u.Id?F().createElement("div",{className:"setting-panel",ref:t},F().createElement(si,{field:v}),(null==g?void 0:g.length)>0&&F().createElement("div",{className:"basic-setting ".concat(r,"-property-view")},x()(g).call(g,(function(e){return F().createElement(k.PropertyViewItem,(0,R.c)({},e,{key:e.Id,field:v,className:"kdesigner-right-view",enableMutiSelect:!1}))})))):null}))),hi=(0,w.memo)((function(e){var t=e.field,n=e.mainViewDom,r=e.prefixCls,o=(0,w.useState)(!1),a=(0,s.c)(o,2),i=a[0],l=a[1],c=(0,w.useContext)(ae).getKdesignerApi,u=((0,w.useMemo)((function(){return c()}),[]),(0,w.useRef)(null)),f=(0,w.useRef)(null);return(0,k.useOnClickOutside)([u,f],(function(e){var t=document.getElementById("app");(!t||null!=t&&t.contains(e.target))&&i&&(l(!1),n.focus())})),(0,w.useEffect)((function(){var e=function(e){var t=document.getElementById("app");(!t||null!=t&&t.contains(e.target))&&i&&l(!1)};return window.addEventListener("scroll",e,!0),function(){window.removeEventListener("scroll",e,!0)}}),[i]),F().createElement(k.DropDownPanel,{gap:2,ref:f,visible:i,placement:"bottomLeft",popperClassName:"".concat(r,"-quick-setting-dropdown"),aaa:"快捷面板",content:i?!!t.Id&&F().createElement(gi,{ref:u,controlId:t.Id,field:t,prefixCls:r}):F().createElement("div",null)},F().createElement("span",{className:"operation-bar-item",onClick:function(e){e.stopPropagation(),l((function(e){return!e})),n.focus()},title:"设置"},F().createElement(P.Icon,{prefix:"designericon",type:"shezhi"})))}),(function(e,t){return(0,we.isEqual)(e.field,t.field)&&e.mainViewDom===t.mainViewDom})),yi="ui-designer-root",bi="1050",Ci="-1";function Ei(e,t){if(t){var n=0,r=new window.IntersectionObserver((function(e){e.forEach((function(e){if(e.intersectionRatio!==n){if(e.intersectionRatio<1&&e.intersectionRatio>0){var r=e.boundingClientRect,o=e.intersectionRect;n>e.intersectionRatio&&r.top<o.top||r.bottom==o.bottom&&r.top<o.top?(t.setAttribute("data-visible","true"),t.style.zIndex=Ci):(t.setAttribute("data-visible","true"),t.style.zIndex=bi)}else e.intersectionRatio>0?(t.setAttribute("data-visible","true"),t.style.zIndex=bi):(t.setAttribute("data-visible","false"),t.style.zIndex=Ci);n=e.intersectionRatio}}))}),{threshold:[1e-6,.999999]});return r.observe(e),r}}var Ii=(0,w.memo)((function(e){var t=e.prefixCls,n=e.field,r=e.kdesignerApi,o=e.mainViewDom,a=e.rootDom,i=e.billPropsData,l=e.dispatchBillData,c=e.getHideField,u=e.setHideField,f=n.Id,d=n._Type_,p=n.SourceForm,v=n.ColumnSpan,g=void 0===v?1:v,h=n.Status,y=n.Margin,b=(0,w.useContext)(k.GlobalConfigContext).showMessage,C=r.data,E=r.selection,I=r.meta,x=(0,w.useRef)(null),N=C.getData(),T=C.getRootId(),A=C.findControl(T).ColumnSpan,D=void 0===A?2:A,M=I.getControlMeta(d),R=M.Inside,O=M.CategoryId,B=M.Name,j=S()(O).call(O,je),L=document.querySelector('[data-control-id="'.concat(f,'"]')),U=(0,w.useReducer)((function(e){return e+1}),0),K=(0,s.c)(U,2)[1];(0,w.useEffect)((function(){var e=x.current;if(e){var t=Ei(L,e);return function(){t.disconnect()}}}),[x.current,L]);var z=(0,w.useCallback)((function(e){var t=x.current;if(t&&a&&e){var n=a.getBoundingClientRect(),r=t.getBoundingClientRect().width,o=e.left,i=e.top,l=(e.width,n.left),c=n.top,u=n.width,s=n.height,f=o<l?l:o;o+r>l+u&&(f=l+u-r);var d=i-24-2;t.style.left="".concat(f,"px"),t.style.top="".concat(d,"px");var p=d>=c-24-2&&d<=c+s;"true"===t.dataset.visible&&(p&&t.style.zIndex===Ci?t.style.zIndex=bi:p||t.style.zIndex!==bi||(t.style.zIndex=Ci))}}),[x.current,a,L]);(0,k.useTraceElementPosition)({selectedCtrlNode:L,callback:z,depth:[g,h,D,y]});var G=ii(n),H=(0,w.useMemo)((function(){return sn(d)}),[d,sn]);(0,w.useEffect)((function(){var e=C.addDataChangeListener((function(){e&&K()}));return function(){e&&e(),e=null}}),[K]);var q=(0,w.useMemo)((function(){var e=C.getParentControl(f);return!!it(null==e?void 0:e._Type_)&&"2"===e.SourceForm}),[f,i,p]),Y=(0,w.useMemo)((function(){return it(d)||$e(d)}),[d]);return L&&L.getAttribute("id")!==yi&&o&&!R?F().createElement("div",{ref:x,className:"".concat(t,"-operation-bar-wrap")},F().createElement("div",{className:"operation-bar-name mr-2"},F().createElement(P.Icon,{prefix:"designericon",type:H,className:"operation-bar-name-icon"}),F().createElement("span",null,G||"")),F().createElement("div",{className:"operation-bar-left"},!q&&!Y&&F().createElement("span",{className:jn()(["operation-bar-item"]),onClick:function(e){if(o.focus(),j)return b("".concat(B,"只能在画布中添加一次，不能重复"));e.stopPropagation();var t=E.getSelection(),r=C.findControl(t[0]),a=an(Ft(N,n,n[V]),T);if(m()(a).call(a,(function(e){return $e(e._Type_)||it(e._Type_)})).length&&gt(r._Type_))b("分组内包含关联表单或表格，不能重复");else{var i=C.findControlIndex(f)+1;C.addControl((0,k.createPasteAction)(a,{index:i})).then((function(){E.setSelect([a[0][_]])}))}},title:"重复"},F().createElement(P.Icon,{prefix:"designericon",type:"zhongfu"})),F().createElement("span",{className:jn()(["operation-bar-item"]),onClick:function(e){o.focus(),e.stopPropagation();var t=C.getNextSelectedControlId(f),r=c();Ro([f],i,l,C,r,u,(function(){var e=t,r=C.findControl(t);ct(d)&&!r?e=T:r&&!wo(r)||(e=n[V]),E.setSelect([e])}))},title:"删除"},F().createElement(P.Icon,{prefix:"designericon",type:"shanchu"}))),!q&&F().createElement(hi,{mainViewDom:o,field:n,prefixCls:t})):null})),xi=function(e){var t=(0,w.useContext)(ae),n=t.getKdesignerApi,r=t.prefixCls,o=t.isPC,a=t.billPropsData,i=t.dispatchBillData,l=t.getHideFieldRef,c=t.setHideFieldRef,u=(0,w.useMemo)((function(){return n()}),[]),f=u.data,d=u.selection,p=u.meta,v=d.getSelection(),m=f.getRootId(),g=(f.findControl(m).ColumnSpan,document.getElementById(Be)),h=document.getElementById(yi),y=(0,w.useReducer)((function(e){return e+1}),0),C=(0,s.c)(y,2),E=C[0],I=C[1];(0,w.useRef)("");return(0,k.useSelectionChangeForceUpdateEffect)(u),(0,w.useLayoutEffect)((function(){I()}),[o]),F().createElement(F().Fragment,null,x()(v).call(v,(function(e){var t,n,o,s=f.findControl(e)||{},d=s.ColumnSpan,v=void 0===d?1:d,m=s._Type_,y=mi(mi({},p.getDefaultData(m)),s),C=ct(m)?document.getElementById("biz-button-panel"):h,I=f.findControlIndex(e),x=b()(t=b()(n=b()(o="operation-bar-item-".concat(e,"-")).call(o,I,"-")).call(n,v,"-")).call(t,E);return F().createElement(Ii,{key:x,prefixCls:r,billPropsData:a,dispatchBillData:i,getHideField:l,setHideField:c,field:y,mainViewDom:g,rootDom:C,kdesignerApi:u})})),F().createElement(pi,null))},Ni={1:"default",2:"disabled",3:"readonly",4:"hidden"},Ti=function(e,t){return at(t)||ct(e)},Ai=(0,w.memo)((function(e){var t=e.prefixCls,n=e.field,r=e.rootDom,o=e.kdesignerApi,a=e.containerDom,i=e.floatMenu,l=e.fieldStatusMap,c=e.fieldStatusSettingOptions,u=void 0===c?{}:c,d=e.dispatchFieldStatus,p=n.Id,v=n._Type_,m=n.Key,g=n.Status,h=n.FieldRequired,y=n.ParentId,b=o.data,C=(o.selection,o.meta),E=(0,w.useRef)(null),I=r.getBoundingClientRect(),N=C.getControlMeta(v),T=N.Inside,A=(N.CategoryId,N.Name,N.IsContainer),S=b.findControl(y)._Type_,D=u.defaultStatus,M=void 0===D?"default":D,_=u.hideMenu,O=void 0===_?Ti:_,B=u.onFieldStatusChange,j=C.getControlMetaEditor(v,"Status"),L=(0,w.useState)(!1),U=(0,s.c)(L,2),K=U[0],V=U[1],z=(0,w.useMemo)((function(){if(null!=l&&l[m])return l[m];if(!i||null==i||!i.length){var e=Ni[g]||M;return e===M&&"2"===h?"mustInput":e}return M}),[m,l,i,g,h,u]),G=(0,w.useMemo)((function(){if(!(0,we.isUndefined)(i))return i;var e=(j||{}).Enum,t=[];return null==e||e.forEach((function(e){t.push({key:Ni[e.Id],label:e.Name})})),A&&!it(v)||!t.length||t.push({key:"mustInput",label:"必填"}),t}),[j,A,i,v]);(0,w.useEffect)((function(){var e=E.current;if(e){var t=Ei(a,e);return function(){t.disconnect()}}}),[E.current,a]);var H=(0,w.useCallback)((function(e){var t=E.current;if(t&&r){t.getBoundingClientRect().width;var n=e.left,o=e.top,a=(e.width,I.left),i=I.top,l=(I.width,I.height),c=n<a?a:n,u=o-24-2;t.style.left="".concat(c,"px"),t.style.top="".concat(u,"px");var s=u>=i-24-2&&u<=i+l;"true"===t.dataset.visible&&(s&&t.style.zIndex===Ci?t.style.zIndex=bi:s||t.style.zIndex!==bi||(t.style.zIndex=Ci))}}),[E.current,r,I]);(0,k.useTraceElementPosition)({selectedCtrlNode:a,callback:H});var q=(0,w.useMemo)((function(){var e,t;return(null===(e=Te()(G).call(G,(function(e){return e.key===z})))||void 0===e?void 0:e.label)||(null===(t=G[0])||void 0===t?void 0:t.label)}),[G,z]),Y=function(e){if(V(!1),"function"!=typeof B)if(it(v)){var t=(b.findControlByCondition((function(e){return e.ParentId===p}))||[]).reduce((function(t,n){return(0,R.c)(t,(0,f.c)({},n.Key,e))}),(0,f.c)({},m,e));d(t)}else d((0,f.c)({},m,e));else null==B||B(e,n,o,d,l)},W=(0,w.useMemo)((function(){return F().createElement(P.Dropdown.Menu,{onClick:Y},x()(G).call(G,(function(e){return F().createElement(P.Dropdown.Item,{key:e.key},F().createElement("span",{className:"".concat(t,"-permission-setting-panel-item")},e.label||e.key))})))}),[G]);return!a||a.getAttribute("id")===yi||!r||null!=O&&O(v,S)||T?null:F().createElement("div",{ref:E,className:"".concat(t,"-permission-setting-wrap")},F().createElement(P.Dropdown,{selectable:!0,popperClassName:"".concat(t,"-permission-setting-panel"),trigger:"click",visible:K,onVisibleChange:V,selectedKey:z,menu:W},F().createElement("div",{className:"permission-setting-label"},F().createElement("span",{className:"permission-setting-label-text"},q),F().createElement(P.Icon,{className:"permission-setting-label-icon",prefix:"designericon",type:K?"xialajiantoufanxiang":"xialajiantou"}))))}));Ai.displayName="PermissionSettingItem";var Si=function(e){var t=(0,w.useContext)(ae),n=t.getKdesignerApi,r=t.prefixCls,o=t.floatMenu,a=t.fieldStatusMap,i=t.dispatchFieldStatus,l=t.fieldStatusSettingOptions,c=(0,w.useMemo)((function(){return n()}),[]),u=c.data,f=c.selection.getSelection(),d=u.getRootId(),p=document.querySelector('[data-control-id="'.concat(d,'"]')),v=(0,w.useReducer)((function(e){return e+1}),0);(0,s.c)(v,2)[1];return(0,k.useSelectionChangeForceUpdateEffect)(c),(0,k.useDataChangeForceUpdateEffect)(c),F().createElement(F().Fragment,null,x()(f).call(f,(function(e){var t,n,s=u.findControl(e),f=s.ColumnSpan,d=void 0===f?1:f,v=(s._Type_,u.findControlIndex(e)),m=document.querySelector('[data-control-id="'.concat(e,'"]'));return F().createElement(Ai,{key:b()(t=b()(n="permission-setting-item-".concat(e,"-")).call(n,v,"-")).call(t,d),prefixCls:r,field:s,rootDom:p,containerDom:m,kdesignerApi:c,floatMenu:o,fieldStatusMap:a,fieldStatusSettingOptions:l,dispatchFieldStatus:i})})))},wi=function(e){var t=(0,(0,w.useContext)(ae).getKdesignerApi)(),n=e.name,r=e.id,o=e.onSelect,a=e.getClassName,i=e.isActive,l=t.data.findControl(r)._Root_;return F().createElement("div",{className:jn()(a("item"),(0,f.c)((0,f.c)({},a("active-item"),i),a("item-disabled"),l)),onClick:function(){o({name:n,id:r,disabled:l})}},F().createElement("div",{className:a("item-text")},F().createElement("span",null,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return e?pe()(e).length>t?Se()(e).call(e,0,t)+"...":e:""}(n))),F().createElement("div",{className:a("item-text-dumb-node")}))},Fi=function(e){var t=e.items,n=e.onSelect,r=e.prefixCls,o=void 0===r?"":r,a=(0,w.useState)(!1),i=(0,s.c)(a,2),l=i[0],c=i[1],u=(0,w.useState)(!1),f=(0,s.c)(u,2),d=f[0],p=f[1],v=(0,w.useRef)(null),m=(0,w.useRef)(null),g=(0,w.useCallback)((function(e){var t;return b()(t="".concat(o,"-")).call(t,e)}),[]),h=(0,w.useCallback)((function(e,t){var n=e.offsetWidth,r=t.offsetWidth;if(r>n){var o=e.scrollLeft;o>0?o+n>=r?(p(!1),c(!0)):(p(!0),c(!0)):(c(!1),p(!0))}else c(!1),p(!1)}),[]);(0,w.useEffect)((function(){var e=new bt.c((function(e){var t=(0,s.c)(e,1)[0],n=t.target.parentElement;k.console.log("resize-----"),h(n,t.target)}));return e.observe(m.current),function(){e.disconnect()}}),[]);var y=function(e){k.console.log("Scroll resize-----");var t=v.current,n=m.current;h(t,n)},C=function(e){var t=v.current.offsetWidth;v.current.scrollLeft=Math.max(0,v.current.scrollLeft+("left"===e?-t:t))},E=function(e,t){t.stopPropagation();k.console.log(t,t.deltaY,t.deltaMode);var n=.4*t.deltaY;v.current.scrollLeft=Math.max(0,v.current.scrollLeft+("left"===e?-n:n))};return(0,w.useEffect)((function(){var e=v.current,t=m.current,n=e.offsetWidth,r=t.offsetWidth;r>n&&(e.scrollLeft=r-n)}),[t]),F().createElement("div",{className:g("container-box"),onScroll:y},l&&F().createElement("div",{className:g("left-arrow"),onClick:function(){return C("left")},onWheel:function(e){return E("left",e)}},F().createElement(P.Icon,{type:"zuoqie",prefix:"designericon"})),F().createElement("div",{className:g("container"),ref:v,onScroll:y},F().createElement("div",{className:g("list"),ref:m},x()(t).call(t,(function(e,r){return F().createElement(wi,(0,R.c)({},e,{onSelect:n,getClassName:g,key:e.id,isActive:r===t.length-1}))})))),d&&F().createElement("div",{className:g("right-arrow"),onClick:function(){return C("right")},onWheel:function(e){return E("right",e)}},F().createElement(P.Icon,{type:"youqie",prefix:"designericon"})))},ki=function(){var e=(0,w.useContext)(ae),t=e.prefixCls,n=e.getKdesignerApi,r=e.getPrefixCls,o=n(),a=(0,w.useCallback)((function(){var e,t=o.selection.getActiveSelectedId(),n=o.data.getAllParentControls(t,!0);return x()(e=n.reverse()).call(e,(function(e){return{id:e.Id,name:e.Name}}))}),[]),i=(0,w.useState)(a),l=(0,s.c)(i,2),c=l[0],u=l[1];(0,w.useEffect)((function(){var e=function(){var e=a();u(e)},t=o.selection.addSelectChangeListener(e),n=o.data.addDataChangeListener(e);return function(){t(),n()}}),[]);var f=(0,w.useCallback)((function(e){var t=e.id;e.disabled||o.selection.setSelect([t])}),[]);return F().createElement(Fi,{items:c,onSelect:f,prefixCls:r(t,"breadcrumb")})},Di=(0,w.memo)((0,w.forwardRef)((function(e,t){var n=e.className,r=(0,w.useContext)(ae).prefixCls,o=t||(0,w.useRef)(null);return F().createElement("div",{ref:o,className:jn()("".concat(r,"_erroricon"),n)},F().createElement("div",{className:"".concat(r,"_erroricon_content")},F().createElement(P.Icon,{className:"".concat(r,"_erroricon_gantanhao"),prefix:"designericon",type:"gantanhao"})))})));Di.displayName="ErrorIcon";var Pi=Di,Mi=function(e){var t=e.prefixCls,n=e.id,r=(e.rootDom,e.nodeErrorData),o=document.querySelector('[data-control-id="'.concat(n,'"]')),a=(0,w.useRef)(),i=(0,w.useMemo)((function(){var e;return(null===(e=p()(r||{}))||void 0===e?void 0:e.length)||0}),[r]),l=(0,w.useMemo)((function(){return 0===i?"":"存在有".concat(i,"条错误，请修复后再发布！")}),[r,i]);return o?i>0?(null==o||o.setAttribute("data-control-error",n),(0,re.createPortal)(F().createElement(P.Tooltip,{tip:l},F().createElement(Pi,{ref:a,className:"".concat(t,"-error-tips")})),o)):(null==o||o.removeAttribute("data-control-error"),null):null};Mi.displayName="ErrorTips";var Ri=Mi,_i=new(Pe()),Oi=function(e,t){if(null!=_i&&_i.has(e)){var n=_i.get(e);n.set(t,!0),_i.set(e,n)}else{var r=new(Pe());r.set(t,!0),_i.set(e,r)}},Bi=function(e,t){return!(null==_i||!_i.has(e))&&_i.get(e).has(t)},ji=function(e){if(e){var t=_i.get(e);t&&(t.clear(),_i.set(e,t))}},Li=function(e,t){_i.set(e,t)},Ui=function(e){return e?_i.get(e):_i},Ki=function(e){return _i.has(e)},Vi=function(e){return!!Ki(e)&&_i.delete(e)},zi=function(e){var t=e.data,n=(e.selection,e.error),r=n.getError();(0,k.useErrorChangeForceUpdateEffect)(e);var o=(0,w.useCallback)((function(e){var t;if(n){var o=e;p()(o||{}).length||ji("controlId");var a={};p()(o).forEach((function(e){var t;o[e]&&(a[e]={},null===(t=o[e])||void 0===t||t.forEach((function(t){var n,r=t.propertyName,o=t.error;a[e][r]?a[e][r]=b()(n=[]).call(n,(0,M.c)(a[e][r]),[{msg:o}]):a[e][r]={msg:[o]}})))})),(null===(t=p()(r))||void 0===t?void 0:t.length)>0&&p()(r).forEach((function(e){if(!a[e]){var t=document.querySelector('[data-control-error="'.concat(e,'"]'));t&&t.removeAttribute("data-control-error")}})),n.replaceError(a)}}),[n,r]);(0,w.useEffect)((function(){return k.eventBus.on(mr,o),function(){k.eventBus.off(mr,o)}}),[o,r]);var a=(0,w.useCallback)((function(e){e.type,e.value;var t=e.actions;if((null==t?void 0:t.length)>0){for(var o=[],a=0;a<t.length;a++){var i=t[a]||{},l=i.type,c=i.value;"DELETE"===l&&r[c]&&o.push(c)}o.length>0&&n.deleteError(o)}}),[r]);(0,w.useEffect)((function(){var e=t.addDataChangeListener(a);return function(){e()}}),[r])},Gi=function(e){if(e){var t=document.querySelector('[data-control-id="'.concat(e,'"]'));t&&(null!=t&&t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():null==t||t.scrollIntoView({block:"center"}))}},Hi=function(e){var t=e.isPC,n=e.errorControlIdList,r=e.error,o=e.root,a=e.prefixCls,i=(0,w.useState)([]),l=(0,s.c)(i,2),c=l[0],u=l[1],f=(0,w.useState)([]),d=(0,s.c)(f,2),v=d[0],g=d[1],h=(0,w.useMemo)((function(){return{root:o,rootMargin:"0px 0px 0px 0px",threshold:[0,.25,.5,.75,1],trackVisibility:!0,delay:200}}),[o]),y=(0,w.useCallback)((function(e,t){var n,r=window.IntersectionObserver;if(r&&e)return n=new r((function(e){t(e)}),h),n.observe(e),n}),[h]),C=function(e,t){return S()(e).call(e,t)?m()(e).call(e,(function(e){return e!==t})):e},E=(0,w.useCallback)((function(e,t,n){t.forEach((function(t){var n=t.rootBounds,r=n.top,o=n.height;if(t.isIntersecting)g((function(t){return C(t,e)})),u((function(t){return C(t,e)}));else{var a=t.boundingClientRect.y>o,i=t.boundingClientRect.y<r;a?g((function(){var t;return S()(v).call(v,e)?v:b()(t=[]).call(t,(0,M.c)(v),[e])})):i&&u((function(){var t;return S()(c).call(c,e)?c:b()(t=[]).call(t,(0,M.c)(c),[e])}))}}))}),[v,c]);(0,w.useEffect)((function(){if((null==n?void 0:n.length)>0){for(var e={},t=function(){var t,a=n[o];if(r[a]&&null!==(t=p()(r[a]))&&void 0!==t&&t.length){var i=document.querySelector('[data-control-id="'.concat(a,'"]'));e[a]=y(i,(function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];E.apply(void 0,b()(e=[a]).call(e,n))}))}else{var l;null===(l=e[a])||void 0===l||l.disconnect(),g((function(e){return C(e,a)})),u((function(e){return C(e,a)}))}},o=0;o<(null==n?void 0:n.length);o++)t();return function(){p()(e).forEach((function(t){var n;null===(n=e[t])||void 0===n||n.disconnect()}))}}}),[t,n,v,c]),(0,w.useEffect)((function(){null!=n&&n.length||(g([]),u([]))}),[n]);return F().createElement(F().Fragment,null,c.length>0&&F().createElement("div",{className:jn()("".concat(a,"_errorguide"),"".concat(a,"_errorguide_top")),title:"定位到错误的字段",onClick:function(){if(c.length>0){var e=c[0];Gi(e)}}},F().createElement(P.Icon,{className:"".concat(a,"_errorguide_shuidi"),prefix:"designericon",type:"shuidizhixiang"}),F().createElement(Pi,{className:"".concat(a,"_errorguide_icon")})),v.length>0&&F().createElement("div",{className:jn()("".concat(a,"_errorguide"),"".concat(a,"_errorguide_bottom")),title:"定位到错误的字段",onClick:function(){if(v.length>0){var e=v[0];Gi(e)}}},F().createElement(P.Icon,{className:"".concat(a,"_errorguide_shuidi"),prefix:"designericon",type:"shuidizhixiang"}),F().createElement(Pi,{className:"".concat(a,"_errorguide_icon")})))},qi=function(e){var t=(0,w.useContext)(ae),n=t.getKdesignerApi,r=t.prefixCls,o=t.isPC,a=(0,w.useMemo)((function(){return n()}),[]),i=a.data,l=(a.selection,a.error),c=i.getRootId(),u=l.getError(),f=(0,w.useMemo)((function(){return p()(u)}),[u]),d=i.getData(),v=document.getElementById(Be),m=document.querySelector('[data-control-id="'.concat(c,'"]')),g=(0,w.useReducer)((function(e){return e+1}),0),h=(0,s.c)(g,2)[1];return(0,k.useErrorChangeForceUpdateEffect)(a),zi(a),(0,w.useLayoutEffect)((function(){h()}),[o,d.Items.length]),F().createElement(F().Fragment,null,x()(f).call(f,(function(e){return F().createElement(Ri,{key:e,prefixCls:r,id:e,nodeErrorData:u[e],rootDom:m})})),m&&(0,re.createPortal)(F().createElement(Hi,{isPC:o,prefixCls:r,errorControlIdList:f,error:u,root:v}),m))},Yi=(0,w.memo)((function(e){e.field;var t,n=(0,w.useContext)(ae),r=n.prefixCls,o=n.getKdesignerApi,a=(0,w.useMemo)((function(){return"".concat(r,"-bizbuttonpanel")}),[r]),i=(0,w.useReducer)((function(e){return e+1}),0),l=(0,s.c)(i,2)[1],c=o(),u=c.data,f=c.selection;(0,w.useEffect)((function(){var e=u.addDataChangeListener(g);return function(){e()}}),[]);var d=u.findControl,p=u.getData(),v=Te()(t=p[z]).call(t,(function(e){return e[L]===Ke}))||{},m=Un(v,p,{ctrlType:Ue},d),g=(0,w.useCallback)((function(e){e.type;var t=e.value;if(Array.isArray(null==t?void 0:t.Items)){for(var n=null,r=!1,o=t.Items,a=0;a<o.length;a++){var i=o[a],c=i[L];if(c===Ke)n=i;else if(c===Ue){r=!0;break}}if(!r&&n){var s=n.Id,d=u.getRootId();u.deleteControl((0,k.createDeleteAction)([s])).then((function(){f.setSelect([d])}))}}l()}),[]),h=ne(v),y=wn();if(0!==(null==m?void 0:m.length))return F().createElement("div",(0,R.c)({className:a},h,{"data-drag-id":v.Id},y),F().createElement("div",{className:"".concat(a,"-main"),id:"biz-button-panel"},F().createElement("div",{className:"".concat(a,"-main-content")},F().createElement("div",{className:"".concat(a,"-main-scroll")},m))))}));Yi.displayName="BizButtonPanel";var Wi=Yi,Qi=(0,w.memo)((function(e){var t=(0,w.useContext)(ae),n=t.getKdesignerApi,r=t.prefixCls,o=t.isPC,a=t.fieldStatusSettingMode,i=t.floatMenu,l=(0,w.useReducer)((function(e){return e+1}),0),c=(0,s.c)(l,2)[1],u=(0,w.useMemo)((function(){return n()}),[]),f=u.data,d=u.selection,p=f.getRootId(),v=f.findControl(p),m=ja(v),g=(0,w.useRef)(null),h=ln(),y=(0,w.useCallback)((function(){d.getSelection().forEach((function(e){var t;return(0,M.c)(document.querySelectorAll(b()(t="[".concat(H,'="')).call(t,e,'"]'))).forEach((function(e){e.getAttribute(W)||e.setAttribute(W,"true")}))}))}),[]),C=(0,w.useCallback)((function(e){e.type,e.value;c(),setTimeout((function(){y()}),100)}),[]);(0,w.useEffect)((function(){var e=d.addSelectChangeListener(La),t=f.addDataChangeListener(C);return function(){e(),t()}}),[]),(0,w.useLayoutEffect)((function(){y()}),[o]),Za(g),Ja(v,u);var E=(0,w.useMemo)((function(){return{prefixCls:"kd"}}),[]);return F().createElement(F().Fragment,null,F().createElement(ai,null),F().createElement(P.ConfigProvider,{value:E},F().createElement("div",{className:"".concat(r,"-main-view-container"),ref:g,id:Be,tabIndex:-1},F().cloneElement(m,{onClick:h}),F().createElement(Wi,{field:v})),!a&&F().createElement(ki,null)),a?F().createElement(Si,{floatMenu:i}):F().createElement(xi,null),F().createElement(qi,null))}));Qi.tabKey="MainView",Qi.tabName="主视图",Qi.displayName="MainView";var Xi=Qi,Zi="kdesigner-tree-node-drag-line-by-control",Ji="control",$i="",el=["\\"],tl=function(e){e.preventDefault()},nl=function(){var e=(0,w.useContext)(ae).getKdesignerApi,t=(0,w.useMemo)((function(){return e()}),[]),n=t.data,r=t.views,o=t.selection,a=(t.meta,n.getRootId()),i=(0,w.useContext)(k.GlobalConfigContext).showMessage,l=(0,w.useCallback)((function(e){!function(e,t){"outline"!==(Ji=null==t?void 0:t.getViewActiveKey("left"))&&t&&t.setViewActiveKey("left")("outline"),$i=$i||Ji}(0,r)}),[]),c=(0,w.useCallback)((function(e){!function(e){var t;if(!el.some((function(t){return e.indexOf(t)>=0}))){var n=e.replace("/","\\/").replace("=","\\="),r=document.querySelector(".kdesigner-tree-node-item-id".concat(n," .kdesigner-tree-node-root"));if(r){var o=null==r?void 0:r.className;S()(o).call(o,Zi)||(r.className=b()(t="".concat(o," ")).call(t,Zi))}}}(e)}),[]),u=(0,w.useCallback)((function(e){var t;tl(e);var n=document.querySelector(b()(t="[".concat(H,"='")).call(t,a,"']"));null==n||n.removeAttribute(ee)}),[]);(0,w.useEffect)((function(){return k.eventBus.on("drag-control-tab",l),k.eventBus.on("drag-control_".concat(a),c),document.body.addEventListener("dragend",u),function(){k.eventBus.off("drag-control-tab",l),k.eventBus.off("drag-control_".concat(a),c),document.body.removeEventListener("dragend",u)}}),[]);var s=(0,w.useCallback)((function(e){var t,r=e.event,o=e.node;r.stopPropagation();var i=o.nodeKey;(i=i.substr(2))===a&&tl(r);var l=document.querySelector(b()(t="[".concat(H,"='")).call(t,a,"']"));null==l||l.setAttribute(ee,i);var c=n.findControl(i),u=c._Type_,s=c.Name;pn(r,u,s)}),[a]),f=(0,w.useCallback)((function(e){e.event,e.node}),[]),d=(0,w.useCallback)((0,we.debounce)((function(e){e.event;var t=e.node;k.eventBus.emit("drag-tree-node",t.key)}),100),[]),p=(0,w.useCallback)((function(e){e.event,e.node}),[]),v=(0,w.useCallback)((function(e){e.event;var t,r=e.node,l=e.dropPosition,c=r.key,u=document.querySelector(b()(t="[".concat(H,"='")).call(t,a,"']")).dataset.outlineDragTreeNode,s=Se()(c).call(c,2),f=n.findControl(u),d=n.findControl(s);s===a&&0!==l||(f.Id!==d.ParentId?n.swapControl((0,k.createSwapAction)({origin:u,target:Se()(c).call(c,2),isPrev:-1===l&&s!==a,dropPosition:l})).then((function(e){o.setSelect([u])})):i("控件类型不符合，不能添加。"))}),[]);return{onDragStart:s,onDragEnter:f,onDragOver:d,onDragLeave:p,onDrop:v,onDragEnd:(0,w.useCallback)((function(e){e.event;var t,n=e.node,r=document.querySelector(b()(t="[".concat(H,"='")).call(t,a,"']"));null==r||r.removeAttribute(ee),k.eventBus.emit("drag-tree-node",n.key)}),[])}};function rl(e,t){var n=void 0!==me()&&he()(e)||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return ol(e,t);var r=Se()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return pe()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ol(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function ol(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function al(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?al(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):al(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ll=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(0,M.c)(e),o=[],a={},i=[];return r.forEach((function(e,r){var l,c=e.Id,u=e.Name,s=e.ParentId,f=e.Key,d=e._Type_,p=e.Multi,v=e.SelectItemType,m=t.getControlMeta(d).Name,g=s?b()(l="[".concat(m,"]")).call(l,u||f||c):"".concat(u||f||c),h={key:n?"${"+"model.".concat(f)+"}":f,title:g,parentId:s,id:c,type:d,isLeaf:!0};if(Ut(d)&&(h.selectable=!1,h.isLeaf=null),ut(d)&&(h.title+="（".concat(1==v?"多选":"单选","）")),$e(d)){var y=t.getControlPropertyDefaultValue(d,"BillEntityIdEx"),C=il({BillEntityId:y,BillEntityIdEx:y},e),E=C.BillEntityId,I=C.BillEntityIdEx;h.title+="（".concat("1"===p?"多条":"单条","）"),h.children=[],h.isAsyncNode=!0,h.isLeaf=null,h.BillEntityId=E,h.BillEntityIdEx=I}var x=n?"${"+"model.".concat(f,"_startdate")+"}":"".concat(f,"_startdate"),N=n?"${"+"model.".concat(f,"_enddate")+"}":"".concat(f,"_enddate");Ze(d)?(o.push(il(il({},h),{},{key:x,title:g+".开始"})),o.push(il(il({},h),{},{key:N,title:g+".结束"}))):o.push(h),h.parentId?Ze(d)?(i.push(il(il({},h),{},{key:x,title:g+".开始"})),i.push(il(il({},h),{},{key:N,title:g+".结束"}))):i.push(h):a=il(il({},h),{},{isLeaf:!1})})),function e(t,n,r){var o=(0,M.c)(n),a=0;n.forEach((function(n,i){if((null==n?void 0:n.parentId)===t.id){var l,c=b()(l="".concat(r,"_")).call(l,a++);ce()(o).call(o,i,1,void 0),t.children?t.children.push(n):t.children=[n],e(n,o,c)}}))}(a,i,"0"),[a]},cl=function e(t){var n=t.options,r=t.currRefbillTableKey,o=void 0===r?"":r;return n?n.reduce((function(t,n){var r=n.key,a=n.title,i=n.titlePrefix,l=n.children,c=n.type,u=n.entityId,s=n.isMulti,f={key:r,title:a,titlePrefix:o===r?i.replace("[多条]","[循环中：单条]"):i,type:c,isMulti:s,selectable:!0};return"group"===c&&(f.selectable=!1),$e(c)&&(f.BillEntityId=u,f.BillEntityIdEx=u),l&&(f.children=e({options:l})),b()(t).call(t,f)}),[]):n},ul=function e(t){var n=t.metaApi,r=t.options;return r?r.reduce((function(t,r){var o,a=r.key,i=r.title,l=r.children,c=r.type,u=r.entityId,s=r.isMulti,f=r.titlePrefix,d=null!=a&&S()(a).call(a,"fbasedataid")?a.split(".fbasedataid")[0]:a,p=(null==d||null===(o=d.split("."))||void 0===o?void 0:o.length)||0;if(!Ut(c)&&p>1)return t;var v={key:"${"+"model.".concat(a)+"}",title:i,titlePrefix:f,type:c,isMulti:s};return(Ut(c)||at(c))&&(v.selectable=!1,v.isLeaf=null),u&&(v.entityId=u),l&&(v.children=e({options:l,metaApi:n})),b()(t).call(t,v)}),[]):r},sl=function e(t){var n=t.options;return n?n.reduce((function(t,n){var r,o=n.key,a=n.title,i=n.titlePrefix,l=n.children,c=n.type,u=n.isMulti,s=n.sourceForm,f={key:o,title:a,titlePrefix:i};return l&&!u&&(f.children=e({options:l})),"1"===s||o.split(".").length>1&&void 0!==s?t:$e(c)||et(c)||it(c)?b()(t).call(t,f):(f.selectable=!1,null!=f&&null!==(r=f.children)&&void 0!==r&&r.length?b()(t).call(t,f):t)}),[]):n},fl=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key";return t.reduce((function(t,r){var o=[];return r[n]&&o.push(r[n]),r.children&&o.push.apply(o,(0,M.c)(e(r.children,n))),b()(t).call(t,o)}),[])},dl=function(e){var t,n=[],r={},o=rl(e);try{for(o.s();!(t=o.n()).done;){var a=t.value;r[a.Id]=il(il({},a),{},{children:[]})}}catch(e){o.e(e)}finally{o.f()}var i,l=rl(e);try{for(l.s();!(i=l.n()).done;){var c=i.value;c.ParentId?r[c.ParentId]&&r[c.ParentId].children.push(r[c.Id]):n.push(r[c.Id])}}catch(e){l.e(e)}finally{l.f()}return n},pl={},vl="id",ml="",gl=(0,w.memo)((0,w.forwardRef)((function(e,t){var n=e.data,r=(0,w.useContext)(ae),o=r.getKdesignerApi,a=r.prefixCls,i=r.getPrefixCls,l=(0,w.useMemo)((function(){return o()}),[]),c=l.data,u=l.selection,f=c.getRootId(),d=(0,w.useState)(!0),v=(0,s.c)(d,2),g=v[0],h=v[1],y=(0,w.useState)(!1),C=(0,s.c)(y,2),E=C[0],I=C[1],N=(0,w.useState)([f]),T=(0,s.c)(N,2),A=T[0],D=T[1],R=(0,w.useState)(600),O=(0,s.c)(R,2),B=O[0],j=O[1],U=(0,w.useState)(void 0),K=(0,s.c)(U,2),V=K[0],G=K[1],H=(0,w.useRef)(null),q=(0,w.useRef)(null),Y=(0,w.useState)(n),W=(0,s.c)(Y,2),Q=W[0],X=W[1],Z=(0,w.useRef)(null);Za(H,!0);var J=nl(),$=J.onDragStart,ee=J.onDragEnter,te=J.onDragOver,ne=J.onDragLeave,re=J.onDrop,oe=J.onDragEnd,ie=i&&i(a,"outline"),le=(0,w.useState)([]),ue=(0,s.c)(le,2),se=ue[0],fe=ue[1],de=(0,w.useMemo)((function(){var e="".concat(ie,"-search-prefix-icon");return F().createElement(P.Icon,{prefix:"designericon",type:"sousuo",className:e})}),[ie]),ve=(0,w.useCallback)((function(e){var t=e.value,n=t.reduce((function(e,t){var n,r;return b()(n=[]).call(n,(0,M.c)(e),[b()(r="".concat(vl)).call(r,t)])}),[]);D(n);var r=(0,M.c)(se);t.forEach((function(e){for(var t,n=e;n!==f&&""!==n;){var o,a=b()(o="".concat(vl)).call(o,n);!S()(r).call(r,a)&&r.unshift(a),n=c.getParentControlId(n)}var i=b()(t="".concat(vl)).call(t,f);!S()(r).call(r,i)&&r.unshift(i)})),fe(r)}),[f,se]),me=(0,w.useCallback)((function(e){var t=e.value;X(t)}),[]);(0,w.useEffect)((function(){var e=u.addSelectChangeListener(ve),t=c.addDataChangeListener(me);return function(){e(),t()}}),[ve]),(0,w.useEffect)((function(){var e=(0,we.debounce)((function(){var e=document.body.clientHeight-30-80-20;j(e),Z.current&&(Z.current.style.height="".concat(e,"px"))}),100);return window.addEventListener("resize",e),function(){pl={},window.removeEventListener("resize",e)}}),[]),(0,w.useEffect)((function(){var e=document.body.clientHeight-30-80-20;j(e),Z.current&&(Z.current.style.height="".concat(e,"px"))}),[Z]);var ge=(0,w.useCallback)((function(e){var t;if(ml!==e){var n=(0,M.c)(se),r=c.getParentControlId(e),o=b()(t="".concat(vl)).call(t,e);for(!S()(n).call(n,o)&&n.push(o);e&&r&&r!==f;){var a;r=c.getParentControlId(r);var i=b()(a="".concat(vl)).call(a,r);S()(n).call(n,i)||n.push(i)}ml=e,fe(n)}}),[se]);(0,w.useEffect)((function(){return k.eventBus.on("drag-control_".concat(f),ge),function(){k.eventBus.off("drag-control_".concat(f),ge)}}),[ge]);var he=(0,w.useCallback)((function(){var e=!g;if(h(e),e)fe([]),Z.current&&(Z.current.scrollTop=0);else{var t,n=x()(t=Q[z]).call(t,(function(e){var t;return b()(t="".concat(vl)).call(t,e[_])}));fe(n)}}),[g,Q,Z.current]),ye=(0,w.useCallback)((function(){I(!E)}),[E]),be=(0,w.useCallback)((function(e){var t=x()(e).call(e,(function(e){return e.substr(2)}));u.setSelect(t);var n=e[0],r=Ur()(se).call(se,(function(e){return n===e})),o=(0,M.c)(se);r>=0?ce()(o).call(o,r,1):o.push(n),fe(o)}),[se]),Ce=(0,w.useMemo)((function(){return function(e,t,n){var r=(0,M.c)(e[z]),o=[],a=[],i={},l=[];return r.forEach((function(e,r){var a,c,u,s=e.Id,f=e.Name,d=e.ParentId,v=e.Key,m={key:s,title:f||v||s,parentId:d,Hidden:"4"===e.Status,disabled:e._Root_};null!=n&&n.prefix&&(m=il(il({},m),{},{key:b()(c="".concat(n.prefix)).call(c,s),parentId:d?b()(u="".concat(n.prefix)).call(u,d):d})),t&&(m.title=b()(a="".concat(f,"（")).call(a,v,"）")),n&&r>0&&p()(n).forEach((function(t){m[t]=e[L]})),o.push(m),(it(e[L])&&"1"===e.ShowType||$e(e[L])&&null!=e&&e.RefTableId&&"2"===(null==e?void 0:e.ShowType))&&(m.Hidden=!0),m.parentId?l.push(m):i=il({},m)})),function e(t,n,r){var o=(0,M.c)(n),i=0;t.parentId||a.push(il(il({},t),{},{level:r})),n.forEach((function(n,l){if((null==n?void 0:n.parentId)===t.key){var c,u=b()(c="".concat(r,"_")).call(c,i++);t.Hidden&&(n.Hidden=!0),a.push(il(il({},n),{},{level:u})),ce()(o).call(o,l,1,void 0),t.children?t.children.push(n):t.children=[n],e(n,o,u)}}))}(i,l,"0"),i.searchData=a,[i]}(Q,E,{prefix:vl})}),[Q,E]),Ee=(0,w.useCallback)((function(e){var t,n,r,o,a,i=(0,M.c)((null==Ce||null===(t=Ce[0])||void 0===t?void 0:t.searchData)||[]),l=Qr()(n=e.target.value).call(n),c=x()(r=hn()(o=x()(a=m()(i).call(i,(function(e){var t,n,r;return(null===(t=e.key)||void 0===t?void 0:S()(n=Se()(t).call(t,2)).call(n,l))||S()(r=e.title).call(r,l)}))).call(a,(function(e){var t;return{id:null===(t=e.key)||void 0===t?void 0:Se()(t).call(t,2),level:e.level}}))).call(o,(function(e){return e.level}))).call(r,(function(e){return e.id}));pl[l]=(0,M.c)(c),G(l)}),[Ce]),Ie=(0,w.useCallback)((function(){if(!V||!pl[V])return null;var e=pl[V],t=e.length;if(t<=0)return f;var n=u.getActiveSelectedId();if(!S()(e).call(e,n))return e[0];var r=e.indexOf(n);return r===t-1?r=0:r++,e[r]}),[V]),xe=(0,w.useCallback)((function(){q.current&&q.current.focus();var e=Ie(),t=c.findControl(e);e&&u.setSelect([t?e:f])}),[q,Ie]),Ne=function(e,t){e.stopPropagation(),e.preventDefault();var n=(0,M.c)(se),r=n.indexOf(t);r>=0?ce()(n).call(n,r,1):n.push(t),fe(n)},Te=[function(e){return F().createElement(P.Icon,{prefix:"designericon",type:"shouqi3",onClick:function(t){return Ne(t,e.nodeKey)}})},function(e){return F().createElement(P.Icon,{prefix:"designericon",type:"zhankai3",onClick:function(t){return Ne(t,e.nodeKey)}})}],Ae=(0,w.useCallback)((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).nodeKey;if(!e)return F().createElement(P.Icon,{prefix:"designericon",type:"Flexmianban"});var t=sn((c.findControl(Se()(e).call(e,2))||{})[L],"Flexmianban");return F().createElement(P.Icon,{prefix:"designericon",type:t})}),[]),Fe=(0,w.useCallback)((function(e){return e.Hidden?"kdesigner-form-designer-outline-tree-node-disabled":""}),[]);return F().createElement("div",{className:"".concat(ie,"-wrap")},F().createElement("div",{className:"".concat(ie,"-search")},F().createElement(P.Input,{size:"small",prefix:de,placeholder:"搜索大纲",borderType:"bordered",className:"".concat(ie,"-search-input"),onChange:Ee,onPressEnter:xe,value:V,ref:q,allowClear:!0}),F().createElement(P.Icon,{prefix:"designericon",className:"".concat(ie,"-search-icon"),onClick:he,type:g?"shouqiquanbu":"zhankaiquanbu",title:g?"全部展开":"全部收起"}),F().createElement(P.Icon,{prefix:"designericon",className:"".concat(ie,"-search-icon"),onClick:ye,type:E?"zhanshi":"yincang",title:E?"隐藏标识":"显示标识"})),F().createElement("div",{ref:H,className:"".concat(ie,"-tree"),tabIndex:-1},F().createElement(P.Tree,{name:"OutlineTree",treeData:Ce,height:B,width:280,onExpand:function(e,t){var n,r=t.expanded,o=t.node.key,a=m()(e).call(e,Boolean);a=r?b()(n=[o]).call(n,(0,M.c)(a)):m()(a).call(a,(function(e){return e!==o})),a=pe()(new(mn())(a)),fe(a)},expandedKeys:se,className:ie,virtual:!1,draggable:!0,icon:Ae,showIcon:!0,selectedKeys:A,onSelect:be,onDragStart:$,onDragEnter:ee,onDragOver:te,onDragLeave:ne,onDrop:re,onDragEnd:oe,ref:Z,setTreeNodeClassName:Fe,switcherIcon:Te})))})));gl.tabKey="Outline",gl.tabName="大纲",gl.displayName="Outline";var hl=gl,yl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALgAAABoCAMAAAB108raAAAAb1BMVEUAAADX3unW2ebX3ujY3+nk6OnW3OjZ3urX3eXX3OjZ3unX3efX3ejX3ujZ3uvY3eje3u/X3OfX3ejX3unX3ejW3ejX3ejY3ujX3ejh5/Pf5e/X3OjX3enX3enY3ejW3OjY3eji6PPW3OfK0NvQ1uBUAKD9AAAAIXRSTlMADgcbKgQgFSQnGDQ8QxI4CzE/LkdJ+Evo+si0aH1e2o9Ktf8OAAADNElEQVR42u3a21KrMBSA4ZVAoJwpKm2BHqB9/2fcTG0qrUAOpu7FmE9mqOjFL7MIOAO8BN2c6uO2LLfH+rShsBDpoS67gbI+pIBfvufVA+U+B9xYs+1GbRsGiDlVN6lyAK1s283YZoDUoexmlQdA6dAJoSzPyoclsCkCQoKiqR8OI5wWZztcQgjckWb4E3RXKKuGi/b00l5hWxWbweIxu9w0gEp+LzuG8wv8Ftc9dH/v8kSXwB4QSUs+35Fw0SkxPXEdJE7nHuNiXn8NsPgyqAENWsosGQ2fFTz/WWykxpfwP28DWJz4EMgN1AmwqOVuLg26IT/eihKYVfB7FGDB1wsPZgV87QEs+FXHYBbh1zBg0d1I/x4WNlzAhttwSTbchkuy4TZckg234ZL+cHhS7VpDdlUCvyZpjXpNOaMk9AmFocpseAXGkSDe3MQrAtzObPgODHOKjweFA59aw8CosHj/JvbRhzP3fdQbwx2ex8mEjGIOp3EyKc7xhtOsmJFRtOHrYtYb1nAvFkAaTuKFhruZyAvDaegF67XrORRU5RkXZdFVFvHvPz9HxsOHTxhc4RJQ4kUcz372onASfTyJVNLZOhJ4TTh1J27Ussha7AXhpEhGxanMgzehDMI3MfPhYTLJma/2PfdqFbhixsOdiegi6YUwLRXkaoTvusv5fOl2rQRSzPJhiuO6psO7803XimVFERfxgyIeHKNT3YEiccrlfHdphWIBF0b5q2DVb8EV/zzYc1/H5c4314nDswdxFvfbfd8LYQRdKRPO9/mBcM4zkTWMcDxlEidc6ZRH2chdOrt+3aTwDfXUSU24wpRHQiNTThx1opDzk1ZgLcbgmb+McALPQked6VF5E3NY2peGKfsK12D64nQVeISPigbTy6GrxGPa4aZvQIGaFYVeqsH0LT9QLWcAQDSYfshaqfK0w8V4eGs0nCMP4TnJ++0/hHvqGOQaEITnQDWYDnfUpUsN94FpMB0ealhuuA7T4b4GHOHplZ/63/QH+43vsYWnGlCEEw02/CfhuQa9cMOoBhv+J8OZBhv+E6DBhtvwARtuw385fDEvTA4t7BXVJb8UjPU17H+K3WpesHGw6wAAAABJRU5ErkJggg==",bl=["NCPG_Hide"],Cl=function(e){var t=(0,w.useContext)(ae),n=t.getKdesignerApi,r=t.prefixCls,o=t.billPropsData,a=t.dispatchBillData,i=t.invokeAction,l=(0,w.useMemo)((function(){return n()}),[]),c=l.selection,u=l.data,f=(0,w.useState)(null),d=(0,s.c)(f,2),p=d[0],v=d[1],g=u.getRootId(),h=function(){var e=c.getSelection();if(1===(null==e?void 0:e.length)){var t=u.findControl(e[0]),n=u.getParentControl(e[0])||{},r=n._Type_,a=n.BillEntityIdEx;!a||!it(r)||null!=o&&o[a]||i("getDesignerMetadata",[a]),v(t)}else v({})},y=(0,k.useActivedSelectedId)({dataContext:u,selectionContext:c}).activedSelectId,b=(0,w.useMemo)((function(){return u.getParentControl(y)}),[y]),C=(0,w.useCallback)((function(e){var t;if(null!=e&&e.data){var n=(null==e?void 0:e.data)||{},r=x()(t=n.entitymeta.Items).call(t,(function(e){return e.Id}));a({key:Vr,payload:{form:e.billEntityIdEx||n.id,info:{data:n,ids:r}}})}}),[]);if((0,w.useEffect)((function(){return k.eventBus.on(br,C),function(){k.eventBus.off(br,C)}}),[C]),(0,w.useEffect)((function(){var e=c.addSelectChangeListener(h);return function(){e()}}),[h]),(0,w.useEffect)((function(){h()}),[]),null!=b&&b.BillEntityIdEx&&it(null==b?void 0:b._Type_)){if(!Ao(b,(null==o?void 0:o.innerForm)||[]))return F().createElement(Vn.EmptyData,{src:yl,desc:"无法编辑应用外表单内容的属性"});if((null==b?void 0:b.BillEntityIdEx)===u.getRootId())return F().createElement(Vn.EmptyData,{src:yl,desc:"表格为当前表单时无法编辑内容属性"});if(p.RefTableId||p.RefBillId)return F().createElement(Vn.EmptyData,{src:yl,desc:"无法编辑属性，请于原单编辑"})}return F().createElement(F().Fragment,null,(null==p?void 0:p.Id)&&g!==p.Id&&F().createElement(si,{field:p,className:"".concat(r,"_property_switchfield")}),F().createElement(k.PropertyView,(0,R.c)({},e,{filterPropertyHandler:function(e){return(0,ht.produce)(e,(function(e){return m()(e).call(e,(function(e){return!S()(bl).call(bl,e.Key)}))}))}})))};Cl.tabKey="property",Cl.tabName="属性";var El=Cl,Il=n(3020),xl=n.n(Il);function Nl(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nl(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Nl(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Al=[{label:"4",value:4},{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8},{label:"9",value:9},{label:"10",value:10}],Sl=/^[a-zA-Z]+$/,wl=function(e,t){return Tl(Tl({},e),t)},Fl=(0,w.forwardRef)((function(e,t){var n=e.className,r=(0,w.useContext)(ae),o=r.getBillnoSetting,a=r.setBillnoSetting,i=P.Form.useForm(),l=(0,s.c)(i,1)[0],c=(0,w.useReducer)(wl,o()),u=(0,s.c)(c,2),d=u[0],p=u[1],v=d.billNoPreview,m=d.billNoYMD,g=d.billNoHMS,h=d.billNoPrefix,y=d.billNoRandomNum,b=(0,w.useCallback)((function(e){var t=e.billNoPreview,n=e.billNoYMD,r=e.billNoHMS,o=e.billNoPrefix,a=e.billNoRandomNum,i=t?t.replace(/^([a-zA-Z]+)\d+$/g,"$1"):"";o&&Sl.test(o)&&(i=o,n&&(i+="".concat(Lt(new Date,"yyyyMMdd"))),r&&(i+="".concat(Lt(new Date,"hhmmss"))),a&&(i+="".concat(function(e){for(var t=[];t.length<e;)t.push(Math.floor(10*Math.random()));return t.join("")}(a))),p({billNoPreview:i}))}),[m,g,h,y]),C=(0,w.useCallback)((function(e){var t=e.target.value;p({billNoPrefix:t}),b(Tl(Tl({},d),{},{billNoPrefix:t}))}),[p,b]),E=(0,w.useCallback)((function(e){var t=!d[e];p((0,f.c)({},e,t)),b(Tl(Tl({},d),{},(0,f.c)({},e,t)))}),[d,p,b]),I=(0,w.useCallback)((function(e){p({billNoRandomNum:e}),b(Tl(Tl({},d),{},{billNoRandomNum:e}))}),[p,b]),x=(0,w.useCallback)((function(){return new(jr())((function(e,t){l.validateFields().then((function(t){xl()(t);a(d),e(!0)})).catch((function(e){return t(e)}))}))}),[a,d]);return(0,w.useImperativeHandle)(t,(function(){return{saveForm:x}}),[x]),F().createElement("div",{className:"".concat(n,"-modal-body")},F().createElement(P.Form,{layout:"vertical",form:l,labelWidth:100,wrapperWidth:"100%",onValuesChange:function(e,t){}},F().createElement("div",{className:jn()("".concat(n,"-form-item"),"".concat(n,"-form-item-vertical"))},F().createElement("div",{className:"".concat(n,"-form-item-label")},"编码示意"),F().createElement("div",{className:"".concat(n,"-form-item-desc")},v||"-")),F().createElement(P.Form.Item,{label:"前缀字母",name:"billNoPrefix",required:!0,validateTrigger:"onChange",rules:[{required:!0,message:"请输入前缀字母"},{type:"string",pattern:/^[a-zA-Z]+$/,message:"格式错误，只能输入大小写字母"}]},F().createElement(P.Input,{type:"text",borderType:"bordered",size:"middle",value:d.billNoPrefix,placeholder:"最多不超过8位",maxLength:8,onChange:C})),F().createElement("div",{className:jn()("".concat(n,"-form-item"),"".concat(n,"-form-item-horizontal"))},F().createElement("div",{className:"".concat(n,"-form-item-label")},"年月日"),F().createElement(P.Switch,{checked:d.billNoYMD,onClick:function(){return E("billNoYMD")}})),F().createElement("div",{className:jn()("".concat(n,"-form-item"),"".concat(n,"-form-item-horizontal"))},F().createElement("div",{className:"".concat(n,"-form-item-label")},"时分秒"),F().createElement(P.Switch,{checked:d.billNoHMS,onClick:function(){return E("billNoHMS")}})),F().createElement(P.Form.Item,{label:"n位随机数",name:"billNoRandomNum",required:!0,rules:[{required:!0,message:"请选择n位随机数"}]},F().createElement(P.Select,{placeholder:"请选择",borderType:"bordered",value:d.billNoRandomNum,options:Al,onChange:I}))))})),kl=function(e){var t=e.className,n=e.onCancel,r=e.onConfirm;return F().createElement("div",{className:"".concat(t,"-modal-footer")},F().createElement(P.Button,{onClick:n,type:"second",size:"small",className:"".concat(t,"-modal-cancel-btn")},"取消"),F().createElement(P.Button,{type:"primary",size:"small",style:{marginLeft:"12px"},onClick:r,className:"".concat(t,"-modal-ok-btn")},"确定"))},Dl=function(e){var t=e.className,n=e.visible,r=e.setVisible,o=e.onConfirm,a=(0,w.useRef)(null),i=function(){r(!1)};return F().createElement(P.Modal,{mask:!0,visible:n,body:F().createElement(Fl,{className:t,ref:a}),bodyStyle:{justifyContent:"start",alignItems:"start",overflowX:"hidden",overflowY:"auto",flexDirection:"column"},titleIcon:null,className:"".concat(t,"-modal"),footer:F().createElement(kl,{className:t,onConfirm:function(){(0,a.current.saveForm)().then((function(){null==o||o(),r(!1)})).catch((function(e){}))},onCancel:i}),maskClosable:!1,width:320,height:438,title:"设置表单编号格式",closable:!0,destroyOnClose:!0,onCancel:i,onOk:i})};function Pl(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ml(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pl(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Pl(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Rl="System_CategoryBillNo",_l=["NoCodeBillNoField"],Ol=["NoCodeCreateDateField","NoCodeCreatorField","NoCodeModifyDateField","NoCodeModifierField"],Bl=function(e){var t=e.prefixCls,n=e.data,r=(0,w.useContext)(k.DataFactoryContext).dataFactory,o=(0,w.useContext)(k.GlobalConfigContext),a=o.env,i=o.keywordMapping,l=(0,w.useContext)(ae),c=l.getKdesignerApi,u=l.showMessage,s=c(),f=s.data,d=s.selection,p=s.meta,v=n.Name,m=n.Id,g=(0,(0,w.useContext)(k.GlobalConfigContext).getOutlineItemIcon)(m),h=(0,w.useCallback)((function(){var e,t,n=f.getRootId(),o=d.getActiveSelectedId(),a=f.findControl(o);a=f.getContainerControl(a);var l=p.canAdd(m,a[i.type]);if(!(!0===l||"object"===(0,be.c)(l)&&l.success))return(null==l?void 0:l.message)&&u(l.message),!1;var c=null===(e=p.getControlMeta(null===(t=a)||void 0===t?void 0:t[i.type]))||void 0===e?void 0:e.IsContainer,s=r({type:m,parentId:c?a[i.id]:n}),v=a[i.id]===o?-1:f.findControlIndex(o)+1;f.addControl((0,k.createAddAction)(s,{index:v})).then((function(e){if(null!=e&&e.length){var t=e[0].value;d.setSelect(Array.isArray(t)?[t[0][i.id]]:[t[i.id]])}}))}),[m]),y=(0,w.useCallback)((function(e){var t={type:"control",data:n};a[k.CONTROL_DRAG_DATA]=t}),[n]);return F().createElement("div",{className:"".concat(t,"-control-item"),draggable:!0,onDragStart:y,onClick:h},g,F().createElement("div",{className:"".concat(t,"-control-name")},v))},jl=(0,w.forwardRef)((function(e,t){var n=e.data,r=e.prefixCls,o=e.titleSuffix,a=e.showSwitch,i=void 0===a||a,l=e.onSwitchChange,c=(0,w.useContext)(ae),u=c.setSystemSetting,d=c.getSystemSetting,p=((0,c.getKdesignerApi)().data,n.Name),v=n.Controls,m=n.Id,g=(0,w.useState)((function(){var e,t=d();return(null==t?void 0:t[m])||(null==t||null===(e=t[m])||void 0===e?void 0:e.value)||!1})),h=(0,s.c)(g,2),y=h[0],b=h[1],C=(0,w.useCallback)((function(e){var t=Ml(Ml({},d()),{},(0,f.c)({},m,e));b(e),u(t)}),[y,b,u]);return(0,w.useImperativeHandle)(t,(function(){return{isOpen:y,setIsOpen:C}}),[y,C]),F().createElement("div",{className:"".concat(r,"-category-group")},F().createElement("div",{className:"".concat(r,"-category-group-title")},F().createElement("div",{className:"group-name"},p,F().createElement("div",{className:"group-title-suffix"},o)),i&&F().createElement(P.Switch,{checked:y,onClick:function(){return function(){var e=!y;if(!1!==l(m,e)){var t=Ml(Ml({},d()),{},(0,f.c)({},m,e));b(e),u(t)}}()}})),F().createElement("div",{className:"".concat(r,"-category-list")},y&&x()(v).call(v,(function(e){return F().createElement(Bl,{key:e.Id,prefixCls:r,data:e})}))))})),Ll=function(e){var t=e.meta,n=(0,w.useContext)(ae),r=n.prefixCls,o=(0,n.getKdesignerApi)(),a=o.data,i=(o.selection,(0,w.useState)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.Controls,n=void 0===t?[]:t,r=e.Categories,o=void 0===r?[]:r,a=m()(o).call(o,(function(e){var t;return null==e||null===(t=e.Id)||void 0===t?void 0:h()(t).call(t,je)}));return x()(a).call(a,(function(e){var t=m()(n).call(n,(function(t){return(null==t?void 0:t.CategoryId)===(null==e?void 0:e.Id)}));return Ml(Ml({},e),{},{Controls:t})}))}(t||[])}))),l=(0,s.c)(i,2),c=l[0],u=(l[1],(0,w.useState)(!1)),f=(0,s.c)(u,2),d=f[0],p=f[1],v=(0,w.useRef)(null),g=function(){p(!0)},y=function(e,t){if(e===Rl&&t&&!1===d)return p(!0),!1;if(e===Rl&&!t){var n,r=x()(n=a.findControlByCondition((function(e){return S()(_l).call(_l,e._Type_)}))).call(n,(function(e){return e.Id}));r.length&&a.deleteControl((0,k.createDeleteAction)(r),!1)}if("System_CategoryRecordInfo"===e&&!t){var o,i=x()(o=a.findControlByCondition((function(e){return S()(Ol).call(Ol,e._Type_)}))).call(o,(function(e){return e.Id}));i.length&&a.deleteControl((0,k.createDeleteAction)(i),!1)}};return F().createElement(F().Fragment,null,F().createElement("div",{className:"".concat(r,"-system-categories")},x()(c).call(c,(function(e){var t=e.Id;return t===Rl?F().createElement(jl,{ref:v,prefixCls:r,key:t,data:e,onSwitchChange:y,titleSuffix:F().createElement(P.Icon,{prefix:"designericon",type:"shezhi",onClick:g})}):F().createElement(jl,{prefixCls:r,key:t,data:e,showSwitch:!1,onSwitchChange:y})}))),F().createElement(Dl,{className:"".concat(r,"-billno-setting"),visible:d,setVisible:p,onConfirm:function(){var e=v.current,t=e.isOpen,n=e.setIsOpen;!1===t&&n(!0)}}))};Ll.tabKey="CategorySystem",Ll.tabName="系统功能",Ll.displayName="CategorySystem";var Ul=Ll,Kl=["type","value"],Vl=["Name","_Type_","RefBillId","RefTableId","EntityData","ParentId","Key"];function zl(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zl(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):zl(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Hl=function(e,t,n,r){var o,a=e.globalConfig,i=e.dataContext,l=e.selectionContext,c=e.action,u=e.dataFactory,d=e.modelFactory,v=e.metaReader,m=(c.type,c.value),g=((0,ye.c)(c,Kl),r.controlCacheApi),h=r.dispatchBillData,y=r.billPropsData,C=r.getHideFieldRef,I=r.setHideFieldRef,N=[],A=C();return m.forEach((function(e){var t,n=(0,s.c)(e,2),r=n[0],o=n[1],m=i.findControl(r),C=i.findControlIndex(r),I=m?v.getDefaultData(null===(t=m)||void 0===t?void 0:t._Type_):{},w=(m=Gl(Gl({},I),m))||{},F=w.Name,D=w._Type_,P=w.RefBillId,_=w.RefTableId,B=w.EntityData,j=w.ParentId,U=(w.Key,(0,ye.c)(w,Vl)),K=i.findControl(j)||{},V=K._Type_,z=K.BillEntityIdEx,G=K.SourceForm;if("Status"in o){var H=function(e,t,n,r){var o=(0,s.c)(e,2),a=o[0],i=o[1],l=n.getAllSubControls(a),c=n.getAllParentControls(a),u=l.reduce((function(e,n){var o=n.Id;if(n._Type_,a!==n.Id){var l,c=b()(l=[]).call(l,(0,M.c)(e),[[o,i]]),u=Co(o,i,n,{metaReader:r});return u&&c.push(u),c}if(null!=n&&n.RefBillId||null!=n&&n.RefTableId){var f=(null==n?void 0:n.RefBillId)||(null==n?void 0:n.RefTableId),d=t[f],p=bo(i,d,r);t[f]=To(To(To({},d),i),{},{EntityData:p}),null!=n&&n.RefTableId&&E()(t).forEach((function(e){var o=(0,s.c)(e,2),a=o[0],l=o[1];if(l.ParentId===(null==n?void 0:n.RefTableId)){var c=bo(i,d,r);t[a]=To(To(To({},l),i),{},{EntityData:c})}}))}return e}),[]),f=c.reduce((function(e,n){var o=n.Id,a=n._Type_,l=n.Status;if((Ut(a)||it(a))&&Number(l)>Number(i.Status)){var c,u=[[o,Ut(a)?{Status:"1"}:i]],s=Co(o,i,n,{metaReader:r});!Ut(a)&&s&&u.push(s);var f=t[null==n?void 0:n.RefBillId];if(f){var d=bo(i,f,r);t[null==n?void 0:n.RefBillId]=To(To(To({},f),i),{},{EntityData:d})}return b()(c=[]).call(c,(0,M.c)(e),u)}return e}),[]),d=b()(u).call(u,f);return d.length&&(0,k.createUpdateAction)(d)}(e,A,i,v);H&&N.push(H)}if("FormatType"in o){var q=m,Y=q.DateRangeDefValue,W=q.NoCodeDefValue;Y&&Ze(D)&&(0,R.c)(o,{DateRangeDefValue:void 0}),W&&Je(D)&&(0,R.c)(o,{NoCodeDefValue:void 0})}if("ParentId"in o){var Q=i.findControl(o.ParentId),X=Q.Status,Z=Q._Type_;if(Ut(Z)&&void 0!==X){var J=i.getAllSubControlIds(r);N.push((0,k.createUpdateAction)(x()(J).call(J,(function(e){return[e,{Status:X}]}))))}}if($e(D)){if("ShowType"in o){var $=o.ShowType;if(m=Gl(Gl(Gl({},m),o),{},{EntityData:Gl(Gl({},m.EntityData),o)}),N.push((0,k.createDeleteAction)([r])),A[r]=m,_||"2"!==$){if(_&&"2"===$){var ee=T()(A).reduce((function(e,t){if(t.Id===_||t.ParentId===_){var n;delete A[t.Id];var r=t.Id===_?Gl(Gl(Gl({},t),o),{},{EntityData:Gl(Gl({},t.EntityData),o)}):t;return b()(n=[]).call(n,(0,M.c)(e),[r])}return e}),[]);N.push((0,k.createAddAction)(ee,{index:C})),setTimeout((function(){return l.setSelect([_])}),100)}}else{var te,ne,re=(0,k.createUUid)(3);delete U.FieldType,delete U.FieldId,delete U.EntryId;var oe=xo(u({type:Ge,parentId:j,transferData:Gl(Gl({},U),{},{Name:F,RefBillId:r,Id:re,ShowType:"2",SourceForm:"2",Key:"nc_".concat((0,k.createUUid)().toLowerCase())})}),{dataContext:i,metaReader:v});g.addCache("controlId",oe.Id);var ae=Mo((null==y||null===(te=y[null==U?void 0:U.BillEntityIdEx])||void 0===te?void 0:te.data)||[],oe);ae=(ae=Do(ae,oe.PropsDisplay)).reduce((function(e,t){var n;return t.isShow?b()(n=[]).call(n,(0,M.c)(e),[_o(t,oe.Id)]):e}),[]),N.push((0,k.createAddAction)(b()(ne=[oe]).call(ne,(0,M.c)(ae)),{index:C})),m.RefTableId=re,m.EntityData.RefTableId=re,A[r]=m,setTimeout((function(){return l.setSelect([re])}),100)}}if(_&&!(O in o)&&!("ShowType"in o)&&!it(V)){var ie=A[_];A[_]=Gl(Gl({},ie),o),A[_].EntityData=Gl(Gl({},ie.EntityData),o)}}if(it(D)){var le=A[P];A[P]=Gl(Gl({},le),o),A[P].EntityData=Gl(Gl({},le.EntityData),o),"inner2Outer"in o&&N.push((0,k.createUpdateAction)([[r,{EntityData:Gl(Gl({},B),{},{inner2Outer:!0})}]])),"ShowType"in o&&(N.push((0,k.createDeleteAction)([r])),N.push((0,k.createAddAction)([Gl({},A[P])],{index:C})),delete A[P],i.findControlByCondition((function(e){e.Id===r&&(m=Gl(Gl(Gl({},m),o),{},{EntityData:Gl(Gl({},m.EntityData),o)}),A[e.Id]=m),e.ParentId===r&&(A[e.Id]=e)})),setTimeout((function(){return l.setSelect([P])}),100))}if(j&&it(V)){var ce=z||"1"!==G?z:j+"_table",ue=r.replace("_".concat(j),""),se=p()(o).reduce((function(e,t){return function(e){var t;return S()(t=["Status","DisplayRules","FieldRequired","NoCodeDefValue","QueryFormValue","FormulaValue","UploadDefValue","PictureDefValue","Visibility"]).call(t,e)}(t)?e:Gl(Gl({},e),{},(0,f.c)({},t,o[t]))}),{});p()(se).length&&(h({key:zr,payload:{form:ce,id:ue,data:se}}),i.findControlByCondition((function(e){var t;e.Id.split("_").length>1&&S()(t=e.Id).call(t,ue)&&e.Id!==r&&N.push((0,k.createUpdateAction)([[e.Id,Gl(Gl({},o),{},{EntityData:Gl(Gl({},e.EntityData),o)})]]))})),T()(A).forEach((function(e){var t;if(S()(t=e.Id).call(t,ue)){var n=A[e.Id];A[e.Id]=Gl(Gl({},n),o),A[e.Id].EntityData=Gl(Gl({},n.EntityData),o)}})))}var fe=Co(r,o,m,{globalConfig:a,dataContext:i,selectionContext:l,action:c,dataFactory:u,modelFactory:d,metaReader:v});if(fe&&N.push(fe),O in o){var de=o[O],pe=v.getControlMeta(de).ApType,ve=v.getControlMeta(V).BaseType,me=function(e,t,n,r,o){var a=n.EntityData,i=n.Id,l=p()(a).reduce((function(t,n){if(n===L)return t[n]=e,t;var r=o.getControlMetaProperty(e,n).Tag;return(r===_e||r===Oe||S()(Re).call(Re,n))&&(t[n]=a[n]),t}),{}),c={};if(ut(e)){var u;ho=uo(ho);var s=o.getControlPropertyDefaultValue(e,"CustomContent"),f=null==s||null===(u=s.ops)||void 0===u?void 0:x()(u).call(u,(function(e,t){return go(go({},e),{},{Bgc:ho[t]})})),d={bgcSwitch:!0,ops:fo(f)};c.CustomContent=d,l.CustomContent=d}return null!=r&&r.Name&&(l.Name=null==r?void 0:r.Name),(0,k.createUpdateAction)([[i,go({ApType:t,_Type_:e,FieldType:e,EntityData:l},c)]])}(de,Io(pe,ve),m,o,v);N.push(me);var ge=function(e,t,n){var r=[];if(p()(t).forEach((function(t){var o;if(!S()(Eo).call(Eo,t)){var a=n.getControlMetaProperty(e,t);a&&0!==(null===(o=p()(a))||void 0===o?void 0:o.length)||r.push(t)}})),r.length>0)return(0,k.createRemovePropAction)([null==t?void 0:t.Id,r])}(de,m,v);ge&&N.push(ge)}})),I(A),b()(o=[c]).call(o,N)};function ql(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ql(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):ql(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Wl="1",Ql=(0,w.memo)((function(e){var t=(0,w.useReducer)((function(e){return e+1}),0),n=(0,s.c)(t,2)[1],r=(0,(0,w.useContext)(k.ConfigContext).getPrefixCls)("nocode-designer-entry"),o=(0,w.useCallback)((function(e){Wl=e,n()}),[Wl]);return F().createElement("div",{className:"".concat(r,"-modal-body")},F().createElement("div",{className:"".concat(r,"-modal-body-menu")},F().createElement("div",{className:jn()({cur:"1"===Wl}),onClick:function(){return o("1")}},F().createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZgAAAEACAMAAAC50JBJAAAAZlBMVEUAAADf39/o6Oj////k5OTc3Nzd3d3y8vLi4uL////6+vrZ2dmZmZnz8/Ompqbo6Oifn5/4+PicnJz19fXU1NTCwsK4uLjj4+PGxsbb29upqamurq6ioqKxsbHu7u6+vr7Pz8/Kyso7+HZuAAAACXRSTlMA/tAL7dLNTk5icRcsAAAF4UlEQVR42uzdXW7iQBBFYWB+Mq6uxhhswDgEsv9NTpJ5yZM7zEjMreacFdTVJ9ESQmLx3tNqOSaSaFyunhZ/+rZKJNXq24fL95Ta3NlflZKFKcatXW5T+v4us0pjrnxssFvzmH68vS8p5QcYG+rWnNKvxSq1DzE21K1t+rlYpvwYYyPdmlNajKl7jLGRbu3eYFJ6kLHBbgVGMmBEA0Y0YEQDRjRgRANGNGBEA0Y0YEQDRjRgRANGtCLM6Xlntn9u6xhrYSrBvPjazDbe1THWwlSCGX1v1vqpkrEWphLM0a9mvV8qGWthKsGc/WA2eF/JWAvTHMxuGIatX4Zh7fth6GoYa2Gag1n6p56rGGthmoNp+/7ix74/+7rvxyrGWpgKb8zRs9nZh1rGWpgKMOeTWbf1vpaxFqYCzOZi1rq3tYy1MM3AdDkf/DXnq29fcq5jrIVpBubqnzrXMdbCNAPzOk0bP03T2tfTdK1jrIVp/o2ZvDW7eKpmrIVpFqbbbjuzk79UM9bCNAtz8LNZ9ud6xlqYZmGufjRb+r6esRamWZi9Lz+++K9nrIVpFuYw7sza8aWesRYmfowhGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEjGjCivcOQZMCI9gbT/EMpNWGKdSswkgEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEj2hdg8qGtZmwTpjJMd/J1NWObMJVh9g7M/SvDDA7M3SvDtJMDc+/KMN3R3Y8bYO5bGWZy3ywbYO5cGea0HXYNMPeuDHPNTQPMf6j8+APz5YABBphbAgYYYG4JGGCAuSVggAHmloABBphbuj9MzrtqxjZh4lcyogEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEjGn9TIhswovFRJhkwogEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEjGjCiASMaMKIBIxowogEj2u/27m03bSiIwrBdkjTjvXw2NhAD8fu/ZB3c9nLvSJXcmWF917nw0q8AQkiTClPcpvzmZ6yYEQ/TLg1W3VI4GStmRMP0FX67FD7GihnRMBdgrKUPM3DyMVbMiIXJgVG+1MDsY6yYEQszAqU8VEDpYqyYEQsj9SCbD6B2MVbM2MIktA3/Y5L+R5gjMPoYK2Z8J8wCdLWPsWLGN8IcgW5yMlbMSIYpP4C59jJWzEiFuVXA2LoZK2YkwtQzcHI0VsyIh5kadMHTWDEjGqZcu0yuxooZ0TBXYPA1VsyIhfkExvKPwsVYMSMSpu/wF78rS9ovzA0M82/4YwyXz8owKjGMUgyjFMMoxTBKMYxSDKMUwyjFMEoxjFIMoxTDKMUwSjGMUgyjFMMoxTBKMYxSDKMUwyjFMyVqMYxSfClTiWGUYhilGEYphlGKYZRiGKUYRimGUYphlGIYpRhGKYZRimGUYhilGEYphlGKYZRiGKUYRimGUSoVpqh5P2Z36TD9qcGqWVonY8WM5P2Y7tLwfsy+0mE+gGMhRX7h/Zi0HcPUwHX7I6DyMVbMiIUJFc7ypWiA3sVYMSPx5l/IQ4fOx1gxYwuTkPNMyX6+H6YYGlSlj7FiRirM6TID3bF3MlbMSIW5Y1UtDJO0c5hpGE5XYObFpZ1tYRKmDnPrYqyYsYVJWYDBxVgxIx6mlE0O3F2MFTNiYe4zWnkYgJOLsWJGNAzwKQ8jcHYxVsyIham77RBWsQAV3/wTdgwjAUA1XhseKN1Z+njcFV+6e+lkrJiR+rhcTiG/FW7Gihn8lYxSDKMUwyjFMEoxjFIMoxTDKMUwSjGMUgyjFMMoxTBKMYxSDKPUGubMMAqtYfLQPs1YsaJdw/wI9XOMtfSsdXjLfp5D/xRjDT1rH8J7lv0Ief8EYw09a5+H1yzLDi8h1K33sXaeta1DeDlkq8NrIFVeD9nm/S2QGm/v2eoXDlT1L9hoSkAAAAAASUVORK5CYII="}),F().createElement("p",null,"添加空白表格")),F().createElement("div",{className:jn()({cur:"2"===Wl}),onClick:function(){return o("2")}},F().createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZgAAAEACAMAAAC50JBJAAAAb1BMVEUAAADi4uLo6Ojd3d3////y8vLi4uL////6+vrZ2dmZmZm1tbX4+PidnZ3Nzc2wsLDAwMCrq6u5ubnS0tLw8PDl5eW9vb2oqKilpaXExMTKysrt7e3r6+vz8/OioqKfn5/19fXi4uLU1NTe3t7o6OiHDuK7AAAAB3RSTlMA89DQC05Omgim0gAAB5ZJREFUeNrs2t1u2kAQhmGgSfvt5/W/E4PLUgf7/q+xkFZKjkqcTrSzZt6DiDlAmtGjYA7YXHvcbZ2lpO3ucfOnh52zVLV7eHXZOjcHj0/lHJIpjV19mJ3bXmV2bgorPzaxXcPkvl2eL86FOzg2qV2Dc983OzffxbFJ7Tpf/mW2LtzHsSntGpzbOOfv49iUdvWvMHdybGK7GozKDEZpBqM0g1GawSjNYJRmMEozGKUZjNIMRmkGozSDUZrBKO0mTH0ageb0tI5jkUy3YDruAeT06zgWyXQLxrEBjqxXciyS6RbMgQVwZrWSY5FMt2AyPgEVzys5Fsn0L5ixqqqclz97NlXlP3psyMpsxDXflOUsOMrDRNhGAGbiu04fPhYFWb29EBzFYSJsIwEzt+0zD21bsm/bacHHQ0ZOAI5k7QVHeZgI2wg9Yw4MQMlq2bHhxP0I1MyPkqM4TIRtpGDKHvA5z8uOxURWKMiz5CgOE2EbMZj8GZjJeeGxOJBtzkZyFIeJsI0MjO+6Fw5dVzDvurDsWF+T7EfBUR4mwjYyMAXfVS47FhnJ0guO8jARtpGBGer6F/u63nNf18WyYweyISvBUR4mwjZiz5iaM/BM94kHaoaKdIKjPEyEbYRgPHMP9Py58NhjzlOAr5nPgqM8TIRtZGCeWAKBp4XHjj35AmAm+yA4ysNE2EYEpuABmNgsPLYhh7/vZyY4ysNE2EYEpuEEDCyWHTu8fW0pyUFwlIeJsI0EzMs0AvPULTvWX3r3UnCUh/mibezHGGve1WBUZjBKMxilGYzSDEZpBqM0g1GawSjNYJRmMEozGKUZjNIMRmkGozSDUZrBKM1glGYwSjMYpV1hLJUZjNIuMD/+o8u7kymtXQ1GZQajNINRmsEozWCUZjBKMxilGYzSDEZpBvObXTPITRgIguCxTa9tMGCMAw6Q/P+PUSJFHMmoo9kBTd3q1qu6jTYoGSYoGSYoGSYoGSYoGSYoGSYoGSYoGSYoGSYoGSYofwiz3MaXeSyehsdh2onHl3ksnobHYQozjAG3MDMzjAGvMOeBGcaAU5h2JjlfMowBlzBr8vIJa5i2lNLgh0MpZ5NCR9nqpmKYqZuvMIfBjtzgm57cGFVH2OqnYph+AWAPg0KOAPYdh8aoOsJWN1XC3LGHad95bIA1u71VdYStblorDEZygx25MquOsNVL64XBG/nR8WBXHWGrk9YMgzXJqbGrjrDVR+uG2ZJcw646wlYfrRqmJw/kbFcdYauP1gxzIwtmcmVWHWGrk9YLs7/w2KIZ2J2sqiNs9dJaYZqBHAGcOk6tUXWErW5aKcyW7H/vHVuj6ghb3bROmJ4s93tHb1LoKFvd9F/CLMv1ZU7peBryl0xQMkxQMkxQMkxQMkxQMkxQvti7YxoAAAAGYf5dY4OjtUCyd8JMCTMlzJQwU8JMCTMlzJQwU8JMCTMlzJQwU8JMCTPlpmRLmClTtiTMlDBTwkwJMyXMlDBTwkwJMyXMlDBTwkwJMyXMlDBTwkwJMyXMlDBTwkwJM1V795acNhAFYRgHx6NpJBsbMBcjEJb2v8ZI5ILzwOghxaTPof8VnKkv8a1c7jGYYnlql34eG8yUhil3R/RVu8LJY4OZkjDNGr96LXw8NpgpCfMKvH2EJh6ArY/HBjOlYNreJQytgIOPxwYzpWDegGU4twGWLh4bzJSCCd3i8ie29y42WfLdmuX7mPII1C42WfLdmgVmDsx8bLJkuzULzA6o9j42WbLdmgNmDuDkZJMl160ZYOpX4LDyssmS6dYMMMsNMCvdbLLkuTUDzP4IbB1tsoRL//2af4FZVaiip02WPLfeHKY+AidXmyyZbs2wHLvwtcmS69bbwjwDs/p3hYtNlmy33hKmwddWLjZZst16S5jl3zAuNlny3apfxnB7q2AoEwxpgiFNMKQJhjTBkCYY0gRDmmBIEwxpgiFNMKQJhjTBkCYY0gRDmmBIEwxpgiFNMKRppoQ2wZCmD2WUCYY0wZAmGNIEQ5pgSBMMaYIhTTCkCYY0wZAmGNIEQ5pgSBMMaYIhTTCkCYY0wZAmGNIEQ9oYTPGh/ZjsjcM02wp91a508thgptH9mGpdaT8me+P7MfMiFO1a+zGZS8N0wCwMRWDj47HBTCmYuEYbhooKaFw8Nphp5JN/Ec5VgI9NFku3foVJbGL52GSxdOsoTLGosKl9bLJYujUNs10fgWreONlksXRrGuYdfevnxskmi6Vb0zCrz8XuBTisfGyyWLr1ApMaxTiULjZZLN2ahrn8S3CxyWLp1hRMffl6ee5ik8XSrddh3g8ow7lPYOtik8XSrddh5n+2A2ZA62KTxdKt12H2+Ilf7IBN6WKTxdKt12FCBLCZzY5A1fnYZLF0awImnF5wbl472WSxdGsCpq9exfajcPOj9GAm/ZYMaYIhTTCkCYY0wZAmGNIEQ5pgSBMMaYIhTTCkCYY0wZAmGNJ6mFYwhPUwD7G8m8cGK5U9zLfY3cdjLd3axenke4zNXTzW0K1NjE+T/r9M29zBYw3d2rRxOplMHh9i7Ervj7Vza9nF+PA4GWSmUVE1HVyGnkRD1PRpMPkBXitvH6PdbmgAAAAASUVORK5CYII="}),F().createElement("p",null,"添加已有表单"))))})),Xl=function(e){P.Modal.confirm({title:"添加表格",width:480,height:304,className:"nocode-designer-entry-modal",showline:!0,maskClosable:!1,titleIcon:null,body:F().createElement(Ql,null),okButtonProps:{size:"small"},cancelButtonProps:{size:"small"},bodyStyle:{padding:24},destroyOnClose:!0,onOk:function(){return function(e){var t=e.dataContext,n=e.dataFactory,r=e.action,o=e.metaReader,a=e.handleConfig,i=a.controlCacheApi,l=a.getHideFieldRef,c=a.setHideFieldRef,u=(r||{}).value,s=xo(n({type:Ge,parentId:u.ParentId,transferData:{Name:"表格",Id:(0,k.createUUid)(3),Key:"nc_".concat((0,k.createUUid)().toLowerCase()),SourceForm:Wl,ShowType:"2",Multi:"1",DataRange:{max:"100",min:"0"}}}),{dataContext:t,metaReader:o}),d=xo(n({type:"NoCodeMulRefBillField",parentId:u.ParentId,transferData:{Name:"表格",Key:"nc_".concat((0,k.createUUid)().toLowerCase()),SourceForm:Wl,ShowType:"2",Multi:"1",DataRange:{max:"100",min:"0"}}}),{dataContext:t,metaReader:o});s.RefBillId=d.Id,s.EntityData.RefBillId=d.Id,d.RefTableId=s.Id,d.EntityData.RefTableId=s.Id;var p=[(0,k.createAddAction)([s])];i.addCache("controlId",s.Id),c(Yl(Yl({},l()),{},(0,f.c)({},d.Id,d))),t.batchActions(p),setTimeout((function(){return a.selection.setSelect([s.Id])}),300)}(e)}})},Zl=["type","value"];function Jl(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function $l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jl(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ec=function(e,t,n,r){var o=e.globalConfig,a=e.dataContext,i=e.selectionContext,l=e.action,c=e.dataFactory,u=(e.modelFactory,e.metaReader),s=a.getRootId(),d=l.type,p=l.value,v=(0,ye.c)(l,Zl),g=o.showMessage,h=St(p),y=r.dispatchBillData,C=r.billPropsData,E=r.getHideFieldRef,I=r.setHideFieldRef,x=i.getSelection(),N=[],T=[],A=E();if(it(p._Type_))return Xl({dataContext:a,dataFactory:c,action:l,metaReader:u,handleConfig:r}),n("自定义插入关联表单表格事件"),!1;var w=setTimeout((function(){if(1===h.length){var e=a.getParentControl(h[0].Id),t=a.findControl(x[0]);it(null==e?void 0:e[L])&&it(null==t?void 0:t[L])||k.eventBus.emit("add-control-id",h[0].Id)}clearTimeout(w),w=null}),0),F=a.getData(),D=h.reduce((function(e,t){var r,o,i,c=t,d=c._Type_,p=(c.Id,c.ParentId);if(ct(d)&&p===s){var v,h=Te()(v=F[z]).call(v,(function(e){return e[L]===Ke}));if(h)t[V]=h[_];else{var E=(0,k.createUUid)(),I=u.getControlMeta(Ke);N.push((0,f.c)((0,f.c)((0,f.c)((0,f.c)((0,f.c)({},V,s),L,Ke),_,E),"_Root_",!0),"Name",null==I?void 0:I.Name)),t[V]=E}}var w=u.getControlMeta(d).Name,D=a.findControl(t[V]),P=D||{},R=P._Type_,O=P.Status;if(tt(d)&&!it(R)){var B=a.findControlByCondition((function(e){return e._Type_===d}));m()(B).call(B,(function(e){var t=a.findControl(e.ParentId);return!it(t._Type_)})).length>0&&(g("".concat(w,"只能在画布中添加一次")),n("".concat(w,"只能在画布中添加一次")))}if(!t||null!==(r=t)&&void 0!==r&&r.FieldName||null!==(o=t)&&void 0!==o&&o.StartDateFieldName||(t=xo(t,{dataContext:a,metaReader:u})),it(R)){var j,U,K,G=$l($l({},u.getDefaultData(R)),D)||{},H=G.BillEntityIdEx,q=G.SourceForm,Y=G.PropsDisplay,W=G.RefBillId,Q=G.EntityData;if(!H&&"2"===q)return n("请先选择需要关联的表单"),!1;if(H&&(null==C||!C[H]))return g("数据加载中，请稍后"),n("数据加载中，请稍后"),!1;if(t.Key=null!==(j=t)&&void 0!==j&&j.Key?t.Key.toLowerCase():"nc_".concat((0,k.createUUid)().toLowerCase()),null===(U=t)||void 0===U||null===(U=U.Key)||void 0===U||!S()(U).call(U,p.toLowerCase())){if(!Ao(D,(null==C?void 0:C.innerForm)||[]))return g("应用外表单无法编辑"),n("应用外表单无法编辑"),!1;if((null==D?void 0:D.BillEntityIdEx)===s)return g("表格为当前表单时无法编辑"),n("表格为当前表单时无法编辑"),!1;t.EntityData=$l($l({},t.EntityData),{},{Key:t.Key});var X=H||"1"!==q?H:p+"_table",Z=x[x.length-1],J=t[V]===Z,$={form:X,data:$l({},t)};if(y({key:Gr,payload:$}),!J)$.prevId=Z.replace("_".concat(p),""),K=(a.findControl(Z)||{}).Key.toLowerCase().replace("_".concat(p.toLowerCase()),"");if(l.index>0){var ee=a.getData().Items;ee[l.index-1]&&(K=ee[l.index-1].Key.toLowerCase().replace("_".concat(p.toLowerCase()),""))}t=_o(t,p)}O&&(t.Status=O);var te=t.Key.toLowerCase().replace("_".concat(p.toLowerCase()),""),ne=function(e,t,n){var r=e?e.split(","):[],o=Array.isArray(t)?t:[t];if(n){var a,i,l=Ur()(r).call(r,(function(e){return e===n}));l>-1?ce()(a=r).apply(a,b()(i=[l+1,0]).call(i,(0,M.c)(o))):r=b()(r).call(r,o)}else r=b()(r).call(r,o);return r.join()}(Y,Ze(t._Type_)?["".concat(te,"_startdate"),"".concat(te,"_enddate")]:te,K);A[W].PropsDisplay=ne,A[W].EntityData.PropsDisplay=ne,T.push((0,k.createUpdateAction)([[p,{PropsDisplay:ne}],[p,{EntityData:$l($l({},Q),{},{PropsDisplay:ne})}]]))}return Ut(d)&&!t.GroupParentId&&(t.GroupParentId=(0,k.createUUid)(),t.GroupIndex=0),b()(i=[]).call(i,(0,M.c)(e),[t])}),[]),P=[$l({type:d,value:b()(D).call(D,N)},v)];return I(A),b()(P).call(P,T)},tc=function(e,t,n,r){e.globalConfig;var o=e.dataContext,a=(e.selectionContext,e.action),i=(e.dataFactory,e.modelFactory,e.metaReader,[a]),l=[],c=a.value;return(Array.isArray(c)?c:[c]).forEach((function(e){var t=o.findControl(e)||{},n=t._Type_;if(Ut(n)){var r=t.GroupIndex,a=t.GroupParentId;if(0===Number(r)){var i=o.findControlByCondition((function(e){return Ut(e._Type_)&&e.GroupParentId===a&&void 0!==e.GroupIndex&&0!==Number(e.GroupIndex)}));i.length&&l.push((0,k.createDeleteAction)(x()(i).call(i,(function(e){return e.Id}))))}}})),b()(i).call(i,l)};function nc(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function rc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nc(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):nc(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var oc=[Ue],ac=function(e,t,n,r){var o,a=e.globalConfig,i=e.dataContext,l=(e.selectionContext,e.action),c=(e.dataFactory,e.modelFactory,e.metaReader),u=(r.billPropsData,r.getHideFieldRef),s=r.setHideFieldRef,f=a.showMessage,d=l.type,p=l.value,v=p,m=p.origin,g=p.target,h=p.isPrev,y=p.dropPosition,C=g,E=Array.isArray(m)?m:[m],I=i.getData().Items,N=i.getRootId(),T=E[0],A=N,w=[],F={},D=!1,P=I.length,R=y&&0!==y,B=i.findControl(C),j=i.getParentControl(C)||{},U=i.getParentControl(T);if(it(j._Type_)&&it(U._Type_)&&B._isEntryField_){if(U.Id!==j.Id)return f("表格内容无法移动到其它表格");var K=j||{},z=K.EntityData,G=K.RefBillId,H=i.findControl(Array.isArray(m)?m:[m]),q=i.getAllSiblings(C).reduce((function(e,t){var n,r,o;return S()(m).call(m,t.Id)?e:t.Id===C?h?b()(r=[]).call(r,(0,M.c)(e),(0,M.c)(H),[t]):b()(o=[]).call(o,(0,M.c)(e),[t],(0,M.c)(H)):b()(n=[]).call(n,(0,M.c)(e),[t])}),[]),Y=x()(q).call(q,(function(e){var t,n="".concat(e.Key.toLowerCase().replace("_".concat(e.ParentId.toLowerCase()),""));return Ze(e._Type_)?b()(t="".concat(n,"_startdate,")).call(t,n,"_enddate"):n}),[]).join();w.push((0,k.createUpdateAction)([[B.ParentId,{PropsDisplay:Y}],[B.ParentId,{EntityData:rc(rc({},z),{},{PropsDisplay:Y})}]]));var W=u(),Q=(null==W?void 0:W[G])||{},X=rc(rc({},null==Q?void 0:Q.EntityData),{},{PropsDisplay:Y});W[G]=rc(rc({},Q),{},{PropsDisplay:Y,EntityData:X}),s(W)}if(h){var Z=i.findControl(C),J=Z[L];Z[V];if(!c.getControlMeta(J).IsContainer||R)((i.getPrevSibling(C)||{}).control||{})[_]||(D=!0)}for(var $=0,ee=-1,te=function(){var e=I[$],t=e[_];if(t===C){F=e,ee=$;var n=e[L],r=e[V],o=c.getControlMeta(n).IsContainer;if(h){if(ee=ee<=0?0:ee-1,A=r,o&&(A=t),R&&(A=r),D){var a=i.getSubControls(A);ee=(ee=i.findControlIndex(a[0][_])-1)<0?$:ee}return $=P,1}if(r&&!o||R)A=r;else if(o){A=e[_];var l=i.getSubControls(t),u=l.length;u>0&&(ee=Ur()(I).call(I,(function(e){var t;return e[_]===(null===(t=l[u-1])||void 0===t?void 0:t[_])})))}$=P}else $++};$<P&&!te(););F[L];var ne=i.findControl(A)||{},re=i.findControl(T),oe=re.ApType,ae=ne[L],ie=re[O]||re[L],le=re.ParentId,ce=re.EntityData,ue=re._isEntryField_,se=re.GroupIndex,fe=re.GroupParentId,de=i.findControl(le);(de||{})._Type_;if(ae===Ve&&S()(oc).call(oc,ie))return f("控件类型不符合，不能添加。");var pe=c.canAdd(ie,ae);if(!("object"!==(0,be.c)(pe)||pe.success||it(ae)&&tt(ie)))return f(pe.message);if(1===E.length&&Ut(ie)&&void 0!==se&&fe){var ve=i.findControlByCondition((function(e){return e.GroupParentId===fe&&e.Id!==T}));if(ve.length>0&&(w.push((0,k.createUpdateAction)([[T,{GroupIndex:0,GroupParentId:(0,k.createUUid)()}]])),0===Number(se))){var me=x()(ve).call(ve,(function(e,t){return[e.Id,{GroupIndex:t}]}));w.push((0,k.createUpdateAction)(me))}}if(ct(ie)&&(h?ee+=1:ee-=1),v=rc(rc({},v),{},{origin:E,targetIndex:ee,targetParentId:A}),(at(ae)||it(ae))&&!ue)return f("表格之外的内容无法移动到表格内");if((!at(ae)||!it(ae)||!Ut(ae))&&ue&&de.Id!==ne.Id)return f("表格的内容无法移动到表格之外");if(oe){var ge=c.getControlMeta(ie).ApType,he=c.getControlMeta(ae).BaseType,ye=Io(ge,he);oe!==ye&&w.push((0,k.createUpdateAction)([[T,{ApType:ye}]]))}return le!==A&&ce&&w.push((0,k.createUpdateAction)([[T,{EntityData:rc(rc({},ce),{},{ParentId:A})}]])),b()(o=[{type:d,value:v}]).call(o,w)},ic=["globalConfig","dataContext","selectionContext","action","dataFactory","modelFactory","metaReader"],lc=["type","value"];function cc(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function uc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var sc=function(e,t,n,r){var o=e.globalConfig,a=e.dataContext,i=(e.selectionContext,e.action),l=(e.dataFactory,e.modelFactory,e.metaReader),c=((0,ye.c)(e,ic),i.type),u=i.value,s=(0,ye.c)(i,lc),f=St(u),d=o.showMessage,p=r.controlCacheApi,v=m()(f).call(f,(function(e){var t=e._Type_,n=e._isEntryField_,r=a.findControl(e.ParentId);if(r){var o=r._Type_,i=l.canAdd(t,r);return"object"!==(0,be.c)(i)||i.success?!at(o)&&n?(d("父容器控件类型不符合，不能添加。"),!1):!(at(o)&&!n)||(d("父容器控件类型不符合，不能添加。"),!1):(d(i.message),!1)}return!1})),g=x()(v).call(v,(function(e){return e.Id}));f=x()(f).call(f,(function(e){if(S()(g).call(g,e.Id)){var t=e._Type_,n=e.ApType,r=(e.NoCodeDefValue,e.DateRangeDefValue,uc({},e)),o=a.findControl(e.ParentId)._Type_;if(n){var i=l.getControlMeta(t).ApType,c=l.getControlMeta(o).BaseType;r.ApType=Io(i,c)}return r}return e}));var h=function e(t){var n,r=[];(n=r).push.apply(n,(0,M.c)(m()(f).call(f,(function(e){return S()(t).call(t,e.Id)}))));var o=m()(f).call(f,(function(e){return S()(t).call(t,e.ParentId)}));o.length>0&&(r=x()(o).call(o,(function(e){return e.Id})).reduce((function(t,n){var r;return b()(r=[]).call(r,(0,M.c)(t),(0,M.c)(e([n])))}),r));return r}(g);setTimeout((function(){1===g.length&&k.eventBus.emit("add-control-id",g[0])}),0),p.addCache("controlId",g[0]);var y=[uc({type:c,value:h},s)];return m()(y).call(y,(function(e){var t;return 0!==(null===(t=e.value)||void 0===t?void 0:t.length)}))},fc=["type","value"],dc=(0,f.c)((0,f.c)((0,f.c)((0,f.c)((0,f.c)({},k.ActionType.ADD,ec),k.ActionType.UPDATE,Hl),k.ActionType.DELETE,tc),k.ActionType.DRAG,ac),k.ActionType.PASTE,sc),pc={NoCodeCreatorField:"nocodecreatorfield",NoCodeCreateDateField:"nocodecreatedatefield",NoCodeModifierField:"nocodemodifierfield",NoCodeModifyDateField:"nocodemodifydatefield",NoCodeBillNoField:"nocodebillnofield"},vc=function(e,t){var n=e.action,r=e.dataContext,o=e.selectionContext,a=e.globalConfig,i=e.dataFactory,l=e.modelFactory,c=e.metaReader,u=e.success,s=e.fail,f=(a.dataRef,a.keywordMapping),d=[],p=function(e){var n=[],r=t.controlCacheApi;return jr().all(x()(e).call(e,(function(e){var t=e.type,n=e.value;(0,ye.c)(e,fc);if(t===k.ActionType.ADD||t===k.ActionType.PASTE){var o=St(n);return jr().all(x()(o).call(o,(function(e){var t,n=pc[e[f.type]];n?null!=e&&null!==(t=e.Key)&&void 0!==t&&S()(t).call(t,e.ParentId.toLowerCase())||(e[f.key]=n):e[f.key]=e[f.key]||"nc_".concat((0,k.createUUid)().toLowerCase());return r.addCache("controlId",e.Id),e}))).then((function(t){return e.value=t,e}))}return jr().resolve(e)}))).then((function(e){return u(b()(e).call(e,n))}))},v=n.type,m=dc[v];if(m){var g=m({globalConfig:a,dataContext:r,selectionContext:o,action:n,dataFactory:i,modelFactory:l,metaReader:c},p,s,t);g&&d.push.apply(d,(0,M.c)(g))}else d.push(n);d.length&&p(d)},mc="none",gc=function(e){var t,n,r=e.handleChange,o=e.value,a=e.className,i=e.editor,l=e.locked,c=e.Name,u=e.Tips,s=i.Enum,f=i.NameHidden,d=i.Default,p=i.Required,v=i.Title,g=x()(t=m()(s).call(s,(function(e){return e.Id!==mc}))).call(t,(function(e){return(0,R.c)({},e,{Value:e.Value||e.Id})})),h=(0,we.isUndefined)(o)?d||(null===(n=g[0])||void 0===n?void 0:n.Value):String(o),y=h===mc;return F().createElement("div",{className:"".concat(a,"-switch-select")},F().createElement("div",{className:"".concat(a,"-switch-wrap")},F().createElement(k.NameTipWrapper,{nameHidden:f,className:a,name:c,tips:u,required:p,title:v}),F().createElement(P.Switch,{checked:h!==mc,size:"large",disabled:l,onClick:function(){return function(){if(!l){var e=h!==mc?mc:g[0].Value||"";r(e)}}()}})),F().createElement("div",{className:jn()("".concat(a,"-tab-wrap"),{"is-hidden":y})},x()(g).call(g,(function(e){return F().createElement("div",{key:e.Value,className:jn()(["".concat(a,"-tab-item"),{"is-active":h===e.Value}]),onClick:function(){return t=e.Value,void r(t);var t}},e.Name)}))))},hc=function(e,t){if(!t)return!0;var n=(t||{}).formId,r=void 0===n?"":n;return e.formId===r},yc=function(e){e.id;var t=e.formId,n=e.enableListener,r=void 0===n?hc:n,o=e.eventName,a=e.parser,i=e.defaultValue,l=void 0===i?{}:i,c=(0,w.useState)(l),u=(0,s.c)(c,2),f=u[0],d=u[1],p=(0,w.useCallback)((function(e){var n=e.args;if(null==r?void 0:r({formId:t},n)){var o="function"==typeof a?a(e):function(e){var t=e.data,n=e.args;return{data:t.rows,param:n.param}}(e);d(o)}}),[d,a,t,r]);return(0,w.useEffect)((function(){return k.eventBus.on(o,p),function(){k.eventBus.off(o,p)}}),[o,t,p]),f},bc=function(e){var t=e.api,n=e.parser,r=t.isVersionEqual,o=t.getData,a=(0,w.useState)((function(){return r()?n(o()):[]})),i=(0,s.c)(a,2),l=i[0],c=i[1],u=(0,w.useCallback)((function(e){var t=e.value,r=n(t);c(r)}),[]);return(0,w.useEffect)((function(){var e=t.addDataChangeListener(u);return function(){e()}}),[]),l};function Cc(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ec(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cc(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Ic=Vn.treeUtils.dfs,xc=function(e,t){var n=t.type,r=t.data;return Nc[n]?Nc[n](e,r):e},Nc={updateRelationFormId:function(e,t){return Ec(Ec({},e),{},{relationFormId:t})},updateFilterInfos:function(e,t){return Ec(Ec({},e),{},{filterInfos:t})},updateSortInfos:function(e,t){return Ec(Ec({},e),{},{sortInfos:t})},updateResult:function(e,t){return Ec(Ec({},e),{},{result:t})},updateState:function(e,t){return t}},Tc=function(e){var t=P.Form.useForm(),n=(0,s.c)(t,1)[0],r=e.visible,o=e.onClose,a=e.invokeActions,i=e.queryFormValue,l=e.refBillData,c=e.onConfirm,u=e.field,d=e.compareTypesMap,p=e.formId,v=(0,w.useContext)(ae),g=v.prefixCls,h=v.baseUrl,y=v.onDownLoad,b=v.getControlText,C=v.batchInvoke,E=v.getKdesignerApi,I=v.curListTreeApi,N=v.fetchListTree,T=(0,w.useState)(r),A=(0,s.c)(T,2),S=A[0],D=A[1],M=(0,w.useState)({}),R=(0,s.c)(M,2),_=R[0],O=R[1],B=(0,w.useReducer)(xc,i),j=(0,s.c)(B,2),L=j[0],U=j[1],K=u.Key,V=E(),z=V.data,G=V.meta,H=z.getRootId(),q=(0,w.useState)({}),Y=(0,s.c)(q,2),W=Y[0],Q=Y[1],X=(0,w.useRef)(),Z={baseUrl:h,batchInvoke:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];C(e,u.Key,t,n)},getControlText:b,addControlAction:function(e,t){k.eventBus.on(e,t)},onDownLoad:y,batchInvokeListConfig:function(e){C("listconfig","nocodeformdesigner",[e])},batchInvokeQuery:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.select,u=void 0===c?"":c,s=t.page_size,f=void 0===s?10:s,d=t.page_no,p=void 0===d?1:d,v=t.ids;C("query","nocodeformdesigner",[e,{filter:r,search:a,order_by:l,select:u,page_size:f,page_no:p,ids:void 0===v?[]:v}])}},J=yc({id:K,formId:L.relationFormId,eventName:"setListTreeConfig",parser:function(e){var t=e.data;return $t(t,t,d)},defaultValue:[]}),$=bc({api:I,parser:function(e){return $t(e,e,d)}}),ee=(0,w.useMemo)((function(){return L.relationFormId?L.relationFormId===p?$:J:[]}),[L.relationFormId,p,$,J]),te=(0,w.useMemo)((function(){var e=z.findControl(H);return[{key:e.Key,title:e.Name,selectable:!1,children:ul({metaApi:G,options:$})}]}),[$,H]),ne=yc({id:K,formId:L.relationFormId,eventName:"filterItemLook"}),re=(0,w.useMemo)((function(){var e;return Array.isArray(L.filterInfos)?x()(e=L.filterInfos).call(e,(function(e){return Ec(Ec({},e),{},{value:"string"==typeof e.value?JSON.parse(e.value):e.value||[]})})):[]}),[L.filterInfos]);(0,w.useEffect)((function(){var e=ne.data,t=ne.param,n=(void 0===t?{}:t).enumField;if(n){var r=null==re?void 0:m()(re).call(re,(function(e){return e.fieldName===n})),o=Ic(ee,(function(e){return e.key===n}));O((function(t){return Ec(Ec({},t),{},(0,f.c)({},n,{configuredFilter:{enumEqCompareType:"001",items:r},fieldFilterConfig:o,groupInfo:e}))}))}}),[ne,re,ee]);(0,w.useEffect)((function(){S&&L.relationFormId&&a.invokeGetListConfig(L.relationFormId)}),[L.relationFormId,S]),(0,w.useEffect)((function(){S&&N()}),[S]),(0,w.useEffect)((function(){D(r)}),[r]);var oe=function(){D(!1),null==o||o()},ie=function(){return new(jr())((function(e,t){n.validateFields().then((function(t){var n=xl()(t);e(n)})).catch((function(e){return t(e)}))}))},le=F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(P.Form,{layout:"vertical",form:n,labelWidth:"100%",wrapperWidth:"100%",onValuesChange:function(e,t){}},F().createElement(Vn.BillQuickFinder,{ref:X,refBillData:l,validData:W,configuredFilterItems:re,listFilterConfig:ee||[],onGetFieldRecords:function(e){a.invokeGetFieldRecords(L.relationFormId,e.fieldName)},fieldRecords:_||{},variablesTree:te,field:u,onFilterChange:function(e){U({type:"updateFilterInfos",data:e})},relationFormId:L.relationFormId,result:L.result,sortInfos:L.sortInfos,onSortChange:function(e){U({type:"updateSortInfos",data:e})},onRelationFormChange:function(e){Q({relationForm:!e}),U({type:"updateRelationFormId",data:e})},onResultChange:function(e){U({type:"updateResult",data:e})},refBillProps:Z})));return F().createElement(P.Modal,{visible:S,className:"".concat(g,"-def-editor-modal"),body:le,bodyClassName:"".concat(g,"-def-editor-modal-body"),width:640,maskClosable:!1,destroyOnClose:!0,closable:!0,onCancel:oe,title:"查找表单记录",footer:F().createElement("div",null,F().createElement(P.Button,{size:"small",style:{marginRight:"12px"},onClick:oe},"取消"),F().createElement(P.Button,{size:"small",type:"primary",onClick:function(){ie().then((function(e){var t,n;if(!(null===(t=(n=X.current).updateVerifyAndGetMsg)||void 0===t?void 0:t.call(n)).length){var r={valueType:2,value:L};if(!L.relationFormId)return void Q({relationForm:!0});a.invokeSaveBizRule(r),null==c||c(r)}})).catch((function(e){}))}},"确定"))})};function Ac(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Ac(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var wc=Vn.Condition.constants,Fc=wc.allFieldRegExp,kc=wc.allExpRegExp,Dc={textDef:[0,1,2],decimalDef:[0,1,2],richEditorDef:[0,1],geoDef:[0,1],addressDef:[0,1],selectDef:[0,1,2],refBillDef:[0,1],dateRangeDef:[0,1],dateDef:[0,1,2],imageDef:[0,1],attachmentDef:[0,1],groupContainerDef:[],entryEntityDef:[],graphicDisplay:[]},Pc=[{label:"查找表单记录",key:"search",id:1,icon:"chazhaobiaodanjilu-xian"},{label:"运算公式",key:"formula",id:2,icon:"yunsuangongshi"}],Mc={valueType:2,value:{relationFormId:"",filterInfos:[],sortInfos:[],result:[]}},Rc={valueType:0,value:""},_c=function(e){var t,n=e.handleChange,r=e.value,o=e.className,a=e.locked,i=e.Editor,l=e.Name,c=e.Tips,u=e.field,f=(e.id,e.propName,e.inputFieldProps),d=e.editorType,p=e.getRenderValue,v=i.NameHidden,g=i.Required,h=i.minPlaceholder,y=void 0===h?"请输入":h,C=(i.maxPlaceholder,i.Title),E=(0,w.useContext)(ae),I=E.prefixCls,N=E.invokeAction,A=E.getKdesignerApi,D=E.getExpressionData,M=E.getRefBillData,R=E.getDataRef,_=E.getCompareTypes,O=(0,w.useState)(!1),B=(0,s.c)(O,2),j=B[0],L=B[1],U=(0,w.useState)(!1),K=(0,s.c)(U,2),V=K[0],z=K[1],G=(0,w.useState)(null),H=(0,s.c)(G,2),q=(H[0],H[1],(0,w.useState)(null)),Y=(0,s.c)(q,2),W=Y[0],Q=Y[1],X=A(),Z=X.data,J=X.meta,$=_(),ee=Z.getRootId(),te=u.ParentId,ne=Z.findControl(te)._Type_,re=(0,w.useState)(r),oe=(0,s.c)(re,2),ie=oe[0],le=oe[1],ce=(0,w.useState)(!1),ue=(0,s.c)(ce,2),se=ue[0],fe=ue[1],de=(0,w.useReducer)((function(e){return e+1}),0),pe=(0,s.c)(de,2),ve=(pe[0],pe[1]),me=(0,w.useRef)(null),ge=(0,w.useRef)(null);(0,w.useEffect)((function(){var e=Z.addDataChangeListener((function(){ve()}));return function(){e()}}),[]),(0,w.useEffect)((function(){(0,we.isEqual)(ie,r)||le(r)}),[r]);var he=(0,k.useDebounce)(n),ye=R(),be=yc({id:u.Key,eventName:"setDefValueForQueryForm",parser:function(e){return{data:e.bizRule,param:{}}}}).data,Ce=function(e,t){try{if(e&&"string"==typeof e){var n=JSON.parse(e);return n.valueType===t?n.value:""}if("dateRangeDef"===d){var r=e.start,o=e.end,a=r&&"string"==typeof r&&JSON.parse(r),i=o&&"string"==typeof o&&JSON.parse(o);if(0===t)return{start:(null==a?void 0:a.valueType)===t?null==a?void 0:a.value:"",end:(null==i?void 0:i.valueType)===t?null==i?void 0:i.value:""};if(2===t)return(null==a?void 0:a.valueType)===t?null==a?void 0:a.value:""}}catch(e){}},Ee=(0,w.useMemo)((function(){try{return"string"==typeof be?Ce(be,2):null==be?void 0:be.value}catch(e){}}),[be]),Ie=(0,w.useMemo)((function(){return D()}),[D]),xe=(0,w.useMemo)((function(){return M()}),[M]);(0,w.useEffect)((function(){return k.eventBus.on(dr,Qe),function(){k.eventBus.off(dr,Qe)}}),[]);var Ne=(0,w.useMemo)((function(){return Z.findControlByCondition((function(e){var t=e._Type_,n=e.ParentId,r=(n&&Z.findControl(n)||{})._Type_;return!at(r)&&!at(t)}))}),[]);(0,w.useEffect)((function(){var e=ll(Ne,J,!1);Q(e)}),[Ne]);var Ae,Se,Fe=(Ae=Ie.functionOperations,T()(Ae)),ke=(Se=Dc[d],null==Pc?void 0:m()(Pc).call(Pc,(function(e){return null==Se?void 0:S()(Se).call(Se,e.id)}))),De=function(e){e.stopPropagation(),N("deleteBizRule",[{formId:ye.id,fieldKey:u.Key}],[]),Me(Rc),fe(!1)},Pe={invokeGetListConfig:function(e){e!==ee&&N("listtreeconfig",[e])},invokeGetFieldRecords:function(e){N("getFilterItemLook",[e,{getEnumData:"true",enumField:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",filterrows:[]}])},invokeSaveBizRule:function(e){N("saveBizRule",[{formId:ye.id,fieldKey:u.Key,ruleInfo:Ka()(e)}])}},Me=function(e){e=Ka()(e),le(e),he(e)},Re=function(e,t){var r=(0,s.c)(e,2),o=r[0],a=void 0===o?"":o,i=r[1],l=void 0===i?"":i,c={start:Ka()({valueType:t,value:a}),end:Ka()({valueType:t,value:l})};le(c),n(c)},_e=function(e,t){var n,r,o=Te()(n=e[0].data).call(n,(function(e){return e.value===t}));return o=o||Te()(r=e[1].data).call(r,(function(e){return e.value===t}))},Oe=function(e){var t;if("string"==typeof e)t=e;else if(Array.isArray(e)){if("dateRangeDef"===d)return void Re(e,0);t=e.join(",")}else t=null!=e&&e.target?e.target.value:e;Me({valueType:0,value:t})},Be={prefixCls:"kd"},je=Sc(Sc({},f),{},{value:null!==(t=null==f?void 0:f.value)&&void 0!==t?t:"function"==typeof p?p(Ce(ie,0)):Ce(ie,0),onChange:Oe}),Le={fieldType:"findForm",borderType:"bordered",value:Ce(ie,2),onChange:Oe,disabled:a,placeholder:y,onClear:De,onClick:function(){return Ye("search")}},Ue=function(e){var t=e?e.split("@@"):["","",null],n=(0,s.c)(t,3);return[n[1],n[2]]}(Ce(ie,1)),Ke={fieldType:"formula",onClick:function(){return Ye("formula")},value:Ue[0],expressionData:Ie.functionTypes,fieldData:W,onClear:De,lang:Number(Ue[1]||1),readOnly:!0,autofocus:!1},Ve=function(e){try{if(e&&"string"==typeof e)return JSON.parse(e).valueType||0;if("dateRangeDef"===d){var t=e.start,n=(e.end,t&&"string"==typeof t&&JSON.parse(t));return(null==n?void 0:n.valueType)||0}}catch(e){}}(ie),ze={1:Ke,2:Le}[Ve],Ge=(0,w.useMemo)((function(){return"fileDef"===d}),[d]),He=(at(ne)||Ge||Sc({data:ke,popperClassName:"".concat(I,"-def-editor-var-select-panel"),type:"dropdownSelect",onSelect:function(e){return Ye(e[0])},varSelectActive:se,onVarSelectActive:fe},ze),function(){L(!0)}),qe=function(){N("getBizRule",[{formId:ye.id,fieldKey:u.Key}],[]),z(!0)},Ye=(0,w.useCallback)((function(e){var t,n={search:qe,formula:He};if("formula"===e&&!W){var r=ll(Ne,J,!1);Q(r)}null===(t=n[e])||void 0===t||t.call(n)}),[Ne,qe,He]),We=function e(t,n,r){return null==t?void 0:x()(t).call(t,(function(t){return t.key===n?Sc(Sc({},t),{},{children:r}):t.children?Sc(Sc({},t),{},{children:e(t.children,n,r)}):t}))},Qe=function(e){var t;Q((function(t){var n;return We(t,null===(n=ge.current)||void 0===n?void 0:n.Key,function(e,t){var n=t||{},r=(n.Name,n.Key),o=n.ParentId;return n.controlType,null==e?void 0:x()(e).call(e,(function(e){var t,n,a=e.PropCap,i=e.PropKey,l=(e.isMulti,e.items,e.type,a);return{key:b()(t="".concat(r,".")).call(t,i),title:l,parentId:o,id:b()(n="".concat(r,".")).call(n,i),isLeaf:!0}}))}(e,ge.current))})),null===(t=me.current)||void 0===t||t.call(me),me.current=null};return F().createElement(F().Fragment,null,!Ge&&F().createElement(k.NameTipWrapper,{nameHidden:v,className:o,name:l,tips:c,required:g,title:C}),F().createElement("div",{onClick:function(){Ge&&Ye("search")},className:"".concat(I,"-def-editor")},F().createElement(P.ConfigProvider,{value:Be},F().createElement(Vn.InputCombo,je))),F().createElement(P.ConfigProvider,{value:Be},j&&F().createElement(Vn.Condition,{loadData:function(e){e.children,e.isLeaf;var t,n=e.key,r=e.isAsyncNode,o=(null===(t=Z.findControlByCondition((function(e){return e.Key===n})))||void 0===t?void 0:t[0])||{},a=J.getControlMeta(o._Type_).Name;return ge.current=Sc({controlType:a},o),new(jr())((function(e){if(r){me.current=e;var t=function(e){return"NoCodeMulRefBillField_bos_adminorg"===e}(o._Type_)||function(e){return"NoCodeMulRefBillField_bos_user"===e}(o._Type_)?J.getControlMetaEditor(o._Type_,"BillEntityIdEx").Default:o.EntityData.BillEntityIdEx;N("click",[o.Id,"entitymeta","PropsDisplay",{BillEntityIdEx:t,itemKey:o.Key}],[])}else e()}))},value:Ue[0],language:Number(Ue[1]||1),modalTitle:"编辑运算公式",editorTitle:u.Name,visible:j,editorPlaceholder:"请编辑运算公式",fieldData:W,fieldTitle:"表单内容",expressionData:Ie.functionTypes,operations:Fe,onClose:function(){L(!1),fe(0!==Ve&&!(null==ze||!ze.value))},onConfirm:function(e,t){e=function(e,t){var n,r;if(!e)return"";var o=(e=e.replace(/）/g,")").replace(/（/g,"(").replace(/“/g,'"').replace(/”/g,'"').replace(/‘/g,"'").replace(/’/g,"'")).replace(Fc,"$1").replace(kc,"$1");return b()(n=b()(r="".concat(o,"@@")).call(r,e,"@@")).call(n,t?1:0)}(e,t),Pe.invokeSaveBizRule({valueType:1,value:e}),L(!1),!e&&fe(!1),Me(e?{valueType:1,value:e}:Rc)}})),V&&F().createElement(Tc,{visible:V,onClose:function(){z(!1),fe(0!==Ve&&!(null==ze||!ze.value))},invokeActions:Pe,queryFormValue:Ee||Mc.value,refBillData:xe,field:u,compareTypesMap:$,formId:ye.id,onConfirm:function(e){z(!1),!e.value.relationFormId&&fe(!1);var t=function(e,t){var n,r=(null===(n=_e(e,t))||void 0===n?void 0:n.label)||"";return r?"查找：".concat(r):""}(xe,e.value.relationFormId);"dateRangeDef"===d?Re([t,t],e.valueType):e.value.relationFormId?Me({valueType:e.valueType,value:t}):Me(Rc)}}))},Oc=(0,w.memo)((function(e){var t=e.locked,n=e.editor,r=e.field,o=e.handleChange,a=e.value,i=e.className,l=n.Relationproperty,c=r||{},u=c[void 0===l?"CustomContent":l],s=c.SelectItemType,d=c.AllowClear,p=void 0===d||d,v=Array.isArray(u)?u:(null==u?void 0:u.ops)||[],g=(0,w.useMemo)((function(){var e;return m()(e=(null==v?void 0:x()(v).call(v,(function(e){return{label:e.Label,value:e.Value}})))||[]).call(e,(function(e){return e.label}))}),[v]),h=1==s,y=function(e){t||o(e)};(0,w.useEffect)((function(){if(a&&g.length){var e=JSON.parse(a)||{},t=e.value,n=(null==t?void 0:t.split(","))||[];if(n.length){var r=x()(g).call(g,(function(e){return e.value}));if((n=m()(n).call(n,(function(e){return S()(r).call(r,e)}))).length){var o=n.join(",");t!==o&&(e.value=o,y(Ka()(e)))}else y("")}}}),[g]);var b=(0,f.c)({className:"".concat(i,"-select-def-editor"),scrollHidden:!1,disabled:t,placeholder:"请选择",borderType:"bordered",allowClear:p,onChange:y,mode:h?"multiple":"single",options:g,fieldType:"combo"},"placeholder","请选择");return F().createElement(_c,(0,R.c)({},e,{handleChange:y,getRenderValue:function(e){return h?(0,we.isEmpty)(e)?[]:null==e?void 0:e.split(","):(0,we.isEmpty)(e)?"":e},editorType:"selectDef",inputFieldProps:b}))}));Oc.displayName="SelectOptionEditor";var Bc=Oc;function jc(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jc(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):jc(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Uc="min",Kc="max",Vc=function(e){return{type:Uc,value:e}},zc=function(e){return{type:Kc,value:e}},Gc=function(e,t){var n=t.type,r=t.value;switch(n){case Uc:return Lc(Lc({},e),{},{min:r});case Kc:return Lc(Lc({},e),{},{max:r});default:return e}},Hc=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.locked,a=e.Editor,i=e.Name,l=e.Tips,c=a.NameHidden,u=a.Required,d=a.minPlaceholder,p=void 0===d?"最小值":d,v=a.maxPlaceholder,m=void 0===v?"最大值":v,g=a.Min,h=a.Title,y=(0,w.useReducer)(Gc,{min:!1,max:!1}),b=(0,s.c)(y,2),C=b[0],E=b[1],I=(0,w.useReducer)(Gc,{min:String((null==n?void 0:n.min)||""),max:String((null==n?void 0:n.max)||"")}),x=(0,s.c)(I,2),N=x[0],T=x[1];(0,w.useEffect)((function(){var e=String((null==n?void 0:n.min)||""),t=String((null==n?void 0:n.max)||""),r=C.min,o=C.max;r||e===N.min||T(Vc(e)),o||t===N.max||T(zc(t))}),[n,C]);var A=function(e,n){var r=Lc(Lc({},N),{},(0,f.c)({},n,e));t(r)},S=(0,k.useDebounce)(A,300),D=function(e){E({type:e,value:!0})};return F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:c,className:r,name:i,tips:l,required:u,title:h}),F().createElement("div",{className:"".concat(r,"-datascope-editor")},F().createElement(P.Stepper,{type:"embed",value:N.min,zeroShow:!0,onChange:function(e){var t=e.target.value||"",n=N.max;!e.nativeEvent&&!Fe()(g)&&t<g&&(t=g),t&&n&&t>Number(n)&&(t=n),T(Vc(t)),t&&!Fe()(g)&&t<g||"-"===t||S(t,Uc)},onFocus:function(){return D(Uc)},onBlur:function(e){E(Vc(!1));var t=N.min;!Fe()(g)&&(Number(t)<g||""===t)&&(T(Vc(String(g))),A(String(g),Uc))},disabled:o,placeholder:p}),F().createElement("div",{className:"".concat(r,"-seperator")},"-"),F().createElement(P.Stepper,{type:"embed",value:N.max,zeroShow:!0,onFocus:function(){return D(Kc)},onBlur:function(e){E(zc(!1));var t=N.min,n=N.max;if(""!==t&&n<=Number(t)||!Fe()(g)&&Number(n)<=g){var r="";""!==n&&""!==t&&n<Number(t)&&(r=t),!Fe()(g)&&Number(n)<=g&&(r=g),""!==r&&(T(zc(r)),A(r,Kc))}},onChange:function(e){var t=e.target.value||"",n=N.min;!e.nativeEvent&&t&&(!Fe()(g)&&t<g&&(t=g),n&&t<Number(n)&&(t=n)),T(zc(t)),(t&&n&&t>=Number(n)||""===n&&"-"!==t||""===t)&&(!Fe()(g)&&t&&t>=g||Fe()(g))&&S(t,Kc)},disabled:o,placeholder:m})))};var qc=(0,w.memo)((function(e){var t=e.item,n=e.index,r=e.prefixClass,o=e.isSysControl,a=e.fieldInfo,i=e.innerForm,l=e.isNew,c=e.disabled,u=e.isRefSelf,f=e.onDrop,d=e.onTitleChange,p=e.onShowField,v=e.onDelectField,m=e.showMessage,g=(0,w.useState)((null==t?void 0:t.Name)||""),h=(0,s.c)(g,2),y=h[0],b=h[1],C=(0,w.useState)(!1),E=(0,s.c)(C,2),I=E[0],x=E[1],N=(0,w.useRef)(null),T=a.inner2Outer,A=a.SourceForm,S=(0,w.useMemo)((function(){return!c&&(T||i)}),[T,i,c]),k=(0,w.useMemo)((function(){return!l&&("1"===A&&T||"1"!==A)}),[T,i,A,l]),D=(0,w.useMemo)((function(){return!c&&(!u&&("1"===A||S))}),[T,S,c]);(0,w.useEffect)((function(){t.Name&&b(t.Name)}),[t.Name]);var P=(0,w.useCallback)((function(){var e;y||(null==m||m("控件名不能为空"),b(null==t?void 0:t.Name)),x(!1),null===(e=N.current)||void 0===e||e.blur(),y&&d(y,n,t)}),[y,d]),M=(0,w.useCallback)((function(){S&&!o&&v(n,t,l)}),[t,n,v,S,l,o]),R=(0,w.useCallback)((function(){x(!0),setTimeout((function(){var e;return null===(e=N.current)||void 0===e?void 0:e.focus()}),200)}),[]),_=(0,w.useCallback)((function(e,t){!c&&(null==f||f(e,t))}),[f,c]);return F().createElement(Vn.Draggable,{index:n,onDrop:_,disabled:c},F().createElement("div",{className:"".concat(r,"-list-drag-item")},F().createElement("div",null,F().createElement("div",{className:"".concat(r,"-list-drag-item-title")},F().createElement("i",{className:"designericon designericon-".concat((null==un?void 0:un[t._Type_])||"wenben")}),I?F().createElement(Vn.Text,{ref:N,value:y,size:"small",onChange:b,onPressEnter:P,onBlur:P}):F().createElement("span",{title:y},y)),F().createElement("div",{className:"".concat(r,"-list-drag-item-btns")},D&&!(null!=t&&t.RefBillId)&&!(null!=t&&t.RefTableId)&&F().createElement("i",{className:"designericon designericon-bianji3",onClick:R}),k&&F().createElement("i",{className:jn()("designericon",{"designericon-zhanshi":t.isShow},{"designericon-yincang":!(null!=t&&t.isShow)}),onClick:function(){return p(n,t)}}),F().createElement("i",{className:"designericon designericon-tuozhuailiebiao"}))),D&&F().createElement("i",{className:jn()("nocodeplatformicon","nocodeplatformicon-xingshanchu",{gray:!(S&&!o)}),onClick:M})))}));qc.displayName="BillFieldItem";var Yc=qc;function Wc(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wc(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Wc(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Xc="refreshPropsDisplayList",Zc=F().memo((function(e){e.handleChange;var t=e.value,n=e.className,r=e.editor,o=(e.locked,e.Name),a=e.Tips,i=e.field,l=e.id,c=e.propName,u=e.rootId,d=r.NameHidden,p=r.Required,v=r.Title,g=(0,w.useContext)(ae),h=g.invokeAction,y=g.billPropsData,C=g.dispatchBillData,E=g.getKdesignerApi,I=g.getHideFieldRef,N=g.setHideFieldRef,T=(0,w.useContext)(k.GlobalConfigContext).showMessage,A=E(),D=A.data,R=A.selection,_=A.meta,O=(A.controlCacheApi,i.BillEntityIdEx),B=i.RefTableId,j=i.RefBillId,L=i._Type_,U=i.SourceForm,K=i.inner2Outer,V=i.ShowType,z="".concat(n,"-bill-props"),G=(0,w.useState)([]),H=(0,s.c)(G,2),q=H[0],Y=H[1],W=(0,w.useRef)(t),Q=(0,w.useRef)({fieldId:l,tableId:B,refId:j,code:c}),X=(0,w.useRef)(Qc({},y)||{}),Z=$e(L)&&B?B:l,J=(0,w.useRef)(Z),$=(0,w.useRef)(O||"1"!==U?O:"".concat(Z,"_table")),ee=(0,w.useRef)(new(mn())(t?t.split(","):[])),te=(0,w.useRef)([]),ne=(0,w.useMemo)((function(){return Ao(i,y.innerForm||[])}),[i,K,null==y?void 0:y.innerForm]),re=(0,w.useCallback)((function(e){if(W.current!==e){var t=Q.current,n=t.fieldId,r=t.code,o=[[n,(0,f.c)({},r,e)]];D.batchUpdateControlPropertyValues((0,k.createUpdateAction)(o))}}),[]),oe=(0,w.useCallback)((function(e,t){var n=[],r=t||{},o=r.Key,a=r.isShow;if(D.findControlByCondition((function(r){var o;r.Id.split("_").length>1&&S()(o=r.Id).call(o,t.Id)&&n.push([r.Id,{Name:e}])})),"1"!==U&&(!a||"1"===V)){var i=(D.findControl(u)||{}).refFieldEdit,l=void 0===i?{}:i,c="string"==typeof l?JSON.parse(l||"{}"):(0,we.cloneDeep)(l);c[$.current]=c[$.current]||{},c[$.current][o]={title:e,status:"edit"},n.push([u,{refFieldEdit:c}])}D.batchUpdateControlPropertyValues((0,k.createUpdateAction)(n))}),[U,u,V]),ie=(0,w.useCallback)((function(e,t){var n=t.sourceIndex,r=t.destinationIndex,o=(0,we.cloneDeep)(q),a=ce()(o).call(o,n,1)[0];ce()(o).call(o,r,0,a),Y((0,M.c)(o)),ye(o),te.current=o,k.eventBus.emit(Xc,{id:Q.current.fieldId,data:(0,M.c)(o)})}),[q,Y]),le=(0,w.useCallback)((function(e,t,n){C({key:zr,payload:{form:$.current,id:n.Id,data:{Name:e}}}),oe(e,n)}),[C,q]),ue=(0,w.useCallback)((function(e){return e.reduce((function(e,t){var n,r;return t.isShow?Ze(t._Type_)?b()(n=[]).call(n,(0,M.c)(e),["".concat(t.Key,"_startdate"),"".concat(t.Key,"_enddate")]):b()(r=[]).call(r,(0,M.c)(e),[t.Key]):e}),[])}),[]),se=(0,w.useCallback)((function(e,t){var n=(0,we.cloneDeep)(q);if(n[e].isShow=!n[e].isShow,"2"===V)if(n[e].isShow)D.addControl((0,k.createAddAction)(_o(n[e],l)));else{var r,o=I();Ro([b()(r="".concat(t.Id,"_")).call(r,l)],y,C,D,o,N)}var a=ue(n);"1"===V&&re(a.join());var i=new(mn())(a);n=Do(n,i),te.current=n,Y(n)}),[q,l,y,V]),fe=(0,w.useCallback)((function(e,t){if(O&&!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])){var n=(D.findControl(u)||{}).refFieldEdit,r=void 0===n?{}:n,o="string"==typeof r?JSON.parse(r||"{}"):(0,we.cloneDeep)(r);o[$.current]=o[$.current]||{},o[$.current][t.Key]={status:"delete"},D.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[u,{refFieldEdit:o}]]))}if("2"===V&&null!=t&&t.isShow){var a=[];D.findControlByCondition((function(e){var n;S()(n=e.Id).call(n,t.Id)&&a.push(e.Id)}));var i=I();Ro(a,X.current,C,D,i,N)}else{var l,c=m()(l=(0,M.c)(ee.current)).call(l,(function(e){return!S()(e).call(e,t.Key)}));re(c.join())}C({key:Hr,payload:{form:$.current,id:t.Id}})}),[V,O,u]),de=(0,w.useCallback)((function(e,t,n){var r,o=window.sessionStorage.getItem("nocode-d-del-modal");if(!O||o||n||"1"===U)return fe(e,t);Vn.WebMsg.showConfirmModal({title:"确认删除“".concat(t.Name,"”吗？"),content:"会在表单“".concat((null===(r=X.current[O])||void 0===r||null===(r=r.data)||void 0===r?void 0:r.caption)||"","”中同步删除"),actions:[{key:"delete",text:"删除"},{key:"ok",text:"再想想"}],onAction:function(r){"delete"===r&&fe(e,t,n)},type:"delete",extra:F().createElement(P.Checkbox,{style:{marginTop:32},onChange:function(e){return e.target.checked&&window.sessionStorage.setItem("nocode-d-del-modal","true")}},"下次不再提醒")})}),[O,U,fe]),pe=(0,w.useCallback)((function(e,t,n){if(e.length){var r=Q.current.fieldId,o=D.findControlIndex(r),a=Oo(e,t,J.current,_),i=(0,s.c)(a,2),l=i[0],c=i[1];D.addControl((0,k.createAddAction)(l,{index:o+1})).then((function(){R.setSelect([r]),null==n||n(c.join())})).catch((function(e){}))}}),[]),ve=(0,w.useCallback)((function(e,t){D.deleteControl((0,k.createDeleteAction)(e)).then((function(e){null==t||t(e)})).catch((function(e){}))}),[]),me=(0,w.useCallback)((function(e,t){var n=Mo(e,i);ee.current.size&&(n=Do(n,ee.current)),Y(n),te.current=n,null==t||t(n)}),[i]),ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=(0,w.useRef)({fn:e,timer:null}).current;return(0,w.useEffect)((function(){n.fn=e}),[e]),(0,w.useCallback)((function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];n.timer&&clearTimeout(n.timer),n.timer=setTimeout((function(){n.fn.apply(n,r)}),t)}),[e])}(me,100),he=(0,w.useCallback)((function(e){var t;if(null!=e&&e.data){var n=(null==e?void 0:e.data)||{},r=x()(t=n.entitymeta.Items).call(t,(function(e){return e.Id}));C({key:Vr,payload:{form:e.billEntityIdEx||n.id,info:{data:n,ids:r}}})}}),[]),ye=(0,w.useCallback)((function(e){var t=Q.current.fieldId,n=D.getParentControl(t)._Type_;if(!it(n))if("2"===V){var r=D.getAllSubControls(t),o=r.reduce((function(e,n){var r;return n.Id===t?e:b()(r=[]).call(r,(0,M.c)(e),[n.Id])}),[]);ve(o,(function(){pe(e,r,(function(e){return re(e)}))}))}else re(ue(e).join())}),[V,U]);(0,w.useEffect)((function(){var e,t=((null==y?void 0:y[$.current])||{}).data,n=((null===(e=X.current)||void 0===e?void 0:e[$.current])||{}).data;t&&!(0,we.isEqual)(n,t)&&$.current&&ge(t),X.current=Qc({},y)}),[y]),(0,w.useEffect)((function(){var e;W.current=t,ee.current=new(mn())(t?t.split(","):[]);var n=((null===(e=X.current)||void 0===e?void 0:e[$.current])||{}).data;n&&(K||"1"!==U)&&ge(n)}),[t]),(0,w.useEffect)((function(){if($.current!==O&&"1"!==U&&($.current=O,W.current="",ee.current=new(mn()),Y([])),O){var e,t=((null===(e=X.current)||void 0===e?void 0:e[O])||{}).data;t?ge(t):h("getDesignerMetadata",[O]),h("click",[l,"entitymeta",c,{BillEntityIdEx:O,itemKey:i.Key}],[])}if(!O&&"1"!==U){var n,r=Se()(n=D.getAllSubControlIds(J.current)).call(n,1);r.length&&ve(r),te.current=[]}}),[O]),(0,w.useEffect)((function(){if(K){var e,t=((null===(e=X.current)||void 0===e?void 0:e[$.current])||{}).data;t&&ge(t)}}),[K]);var be=(0,w.useCallback)((function(e){var t=e.id,n=e.data;t!==Q.current.fieldId||(0,we.isEqual)(n,te.current)||(te.current=n,Y(n))}),[]);(0,w.useEffect)((function(){var e,t=((null===(e=X.current)||void 0===e?void 0:e[$.current])||{}).data;return t&&me(t),k.eventBus.on(Xc,be),function(){k.eventBus.off(Xc,be)}}),[]),(0,w.useEffect)((function(){return k.eventBus.on(br,he),function(){k.eventBus.off(br,he)}}),[he]);var Ce=(0,w.useMemo)((function(){return $e(L)&&"2"===V}),[L,V]);return F().createElement("div",{className:z},F().createElement("div",{className:"".concat(z,"-title")},F().createElement(k.NameTipWrapper,{nameHidden:d,className:n,name:o,tips:a,required:p,title:v})),F().createElement("div",{className:"".concat(z,"-list")},null!=q&&q.length?F().createElement(Vn.DragContainer,null,F().createElement("div",{className:"".concat(z,"-list-drag")},x()(q).call(q,(function(e,t){var n;return F().createElement(Yc,{key:e.Id,item:e,index:t,prefixClass:z,fieldInfo:i,disabled:Ce,isNew:!O||!(null!=y&&null!==(n=y[$.current])&&void 0!==n&&null!==(n=n.ids)&&void 0!==n&&S()(n).call(n,e.Id)),innerForm:ne,showMessage:T,isRefSelf:O===u,isSysControl:Fo(e._Type_),onDrop:ie,onTitleChange:le,onShowField:se,onDelectField:de})})))):F().createElement("div",{className:"".concat(z,"-empty")},F().createElement(Vn.EmptyData,{desc:"暂无内容"}))))}));function Jc(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function $c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jc(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Jc(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var eu=(0,w.memo)((function(e){var t,n,r,o,a=e.handleChange,i=e.value,l=e.className,c=e.editor,u=(e.locked,e.Name),f=e.Tips,d=e.field,p=(e.id,e.propName,c.NameHidden),v=c.Required,g=c.Title,h=d.FileMaxSize,y=d.UploadNum,C=d.ImageFileType,E=d.FieldType,I=d.ButtonText,N=(0,w.useContext)(ae),T=N.getKdesignerApi,A=N.baseUrl,S=(0,w.useState)([]),D=(0,s.c)(S,2),R=D[0],_=D[1],O=T(),B=(O.data,O.meta),j=B.getControlPropertyDefaultValue,L=(0,B.getControlMetaEditor)(E,"ImageFileType").Enum,U=j(E,"FileMaxSize"),K=j(E,"ImageFileType"),V="".concat(l,"-pic"),z=(0,w.useState)(""),G=(0,s.c)(z,2),H=G[0],q=G[1],Y=(0,w.useRef)(new(Pe())),W=(0,w.useCallback)((function(e){Vn.WebMsg.showNotificationMsg({param:[{type:2,content:e,duration:2e3}]})}),[]),Q=(0,w.useCallback)((function(e,t){return null!=y&&y.max&&t.length>y.max?(W("最多只能上传".concat(y.max,"个图片，请重新选择")),!1):!(h&&e.size/1024/1024>h)||(W("请上传小于".concat(h,"M的图片")),!1)}),[y.max,h,Y.current]),X=(0,w.useCallback)((function(e){var t=e.file,n=e.fileList;if(t.response&&"0"===t.response.errorCode){var r,o=t.uid,i=t.name,l=t.size,c={url:t.response.data.url,status:"success",uploadTime:Date.now()};Y.current.set(t.uid,$c({uid:o,name:i,size:l},c)),a(Ka()((0,M.c)(xl()(r=Y.current).call(r)))),n.forEach((function(e){e.uid===t.uid&&(e.url=A.picture+t.response.data.url)}))}_((0,M.c)(n))}),[R,Y.current,a]),Z=(0,w.useCallback)((function(e){var t,n=Ur()(R).call(R,(function(t){return t.uid===e.uid}));ce()(R).call(R,n,1),_((0,M.c)(R)),Y.current.get(e.uid)&&Y.current.delete(e.uid);var r=Y.current.size>0?Ka()((0,M.c)(xl()(t=Y.current).call(t))):"";a(r)}),[R,Y.current,a]);(0,w.useEffect)((function(){if(i&&qt(i)){var e=JSON.parse(i);(0,we.isArray)(e)?(Y.current=new(Pe()),e=x()(e).call(e,(function(e){Y.current.set(e.uid,$c({},e));var t=A.picture+e.url;return $c($c({},e),{},{url:t})})),_(e)):q(e.value)}else(0,re.unstable_batchedUpdates)((function(){_([]),q("")}))}),[i]);var J=C||K,$=x()(t=J.split(",")).call(t,(function(e){return m()(L).call(L,(function(t){return t.Id===e}))[0].Name}));return F().createElement("div",{className:V},F().createElement("div",{style:{marginBottom:"8px"}},F().createElement(k.NameTipWrapper,{nameHidden:p,className:l,name:u,tips:f,required:v,title:g})),!H&&F().createElement("div",null,F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(Vn.Picture,{fileList:R,action:zt(window.__domainurl__+"nocode/v2/nocode_sys/image"),data:{action:"upload",tempstorage:!1},accept:x()($).call($,(function(e){return"."+e})).join(","),multiple:!0,buttonText:I,onChange:X,onRemove:Z,beforeUpload:Q,noticeInfo:b()(n=b()(r=b()(o="请上传小于".concat(h||U,"M的")).call(o,$.join("、"),"文件，文件个数不少于")).call(r,(null==y?void 0:y.min)||0,"个，不多于")).call(n,(null==y?void 0:y.max)||1,"个。")}))))})),tu=function(e){var t=e.formVisible,n=e.prefixCls,r=e.refFldOptions,o=e.currFldOptions,a=e.refFldKey,i=e.currFldKey,l=e.handleChange;return t?F().createElement("div",{className:"".concat(n,"-form")},F().createElement("div",{className:"".concat(n,"-form-item")},F().createElement("div",{className:"".concat(n,"-form-item-label")},"关联表单内容"),F().createElement(P.Select,{className:"".concat(n,"-form-item-select"),borderType:"bordered",value:a,options:r,placeholder:"请选择",onChange:function(e){return l(e,"RefFldKey")}})),F().createElement("div",{className:"".concat(n,"-form-seperator")},"的值填充到"),F().createElement("div",{className:"".concat(n,"-form-item")},F().createElement("div",{className:"".concat(n,"-form-item-label")},"当前表单内容"),F().createElement(P.Select,{className:"".concat(n,"-form-item-select"),borderType:"bordered",value:i,options:o,placeholder:"请选择",onChange:function(e){return l(e,"CurrFldKey")}}))):null},nu=function(e){var t,n=e.prefixCls,r=e.data,o=e.index,a=e.isNewOption,i=e.handleDelete,l=e.handleUpdate,c=e.currFldOptions,u=e.refFldOptions,f=r.RefFldKey,d=r.CurrFldKey,p=(null===(t=Te()(u).call(u,(function(e){return e.value===f})))||void 0===t?void 0:t.label)||"",v=(0,w.useState)(!!a),m=(0,s.c)(v,2),g=m[0],h=m[1],y=(0,w.useRef)(null),b=(0,w.useRef)(null),C=(0,w.useCallback)((function(e,t){e.stopPropagation(),i(t)}),[i]),E=(0,w.useCallback)((function(){h(!0)}),[h]),I=(0,w.useCallback)((function(e,t){l(e,o,t)}),[l,o]),x=(0,w.useCallback)((function(){return F().createElement("div",{ref:y},F().createElement(tu,{formVisible:g,prefixCls:n,currFldOptions:c,refFldOptions:u,refFldKey:f,currFldKey:d,handleChange:I}))}),[n,c,u,f,d,I,g]);return(0,k.useOnClickOutside)([y],(function(e){var t=document.getElementById("app");if((!t||null!=t&&t.contains(e.target))&&g){var n;if(null!==(n=b.current)&&void 0!==n&&n.contains(e.target))return;h(!1)}})),F().createElement(P.Tooltip,{trigger:"click",placement:"leftTop",popperStyle:{width:"636px"},popperClassName:"".concat(n,"-dropdown"),tip:x(),visible:g},F().createElement("div",{className:"".concat(n,"-option"),onClick:E,ref:b},F().createElement("div",{className:"".concat(n,"-option-name")},p),F().createElement("div",{className:"".concat(n,"-option-right-btns")},F().createElement(P.Icon,{prefix:"designericon",type:"bianji3"}),F().createElement(P.Icon,{prefix:"designericon",type:"shanchu",onClick:function(e){return C(e,o)}}))))};function ru(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ru(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):ru(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var au={CurrFldKey:"",RefFldKey:""},iu="DELETE",lu="UPDATE",cu="MERGE",uu=function(e,t){var n=t.type,r=t.index,o=t.payload;return yt()(e,(function(e){switch(n){case"ADD":e.push(o);break;case lu:e[r]=ou(ou({},e[r]),o);break;case iu:ce()(e).call(e,r,1);break;case cu:e=o}return e}))},su=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.editor,a=(e.locked,e.Name),i=e.Tips,l=e.field,c=o.NameHidden,u=o.Required,d=o.Title,p=l.Id,v=(0,w.useContext)(ae),m=v.prefixCls,g=v.getKdesignerApi,h=v.getCurrentRefBillPropsData,y=g(),C=y.data,E=y.meta,I=(0,w.useReducer)(uu,n||[]),N=(0,s.c)(I,2),T=N[0],A=N[1],S=(0,w.useState)((function(){var e=C.findControlByCondition((function(e){var t=e._Type_,n=e.ParentId,r=C.getRootId(),o=(n&&C.findControl(n)||{})._Type_;return!(at(o)||at(t)||function(e){return"NoCodeGEOField"===e}(t)||rt(t)||ot(t)||e.Id===p||e.Id===r)})).reduce((function(e,t){var n=t._Type_;return"NoCodeDateRangeField"===E.getControlMeta(n).Id?b()(e).call(e,[{label:"".concat(t.Name,".开始"),value:"".concat(t.Key,"_startdate")},{label:"".concat(t.Name,".结束"),value:"".concat(t.Key,"_enddate")}]):b()(e).call(e,{label:t.Name,value:t.Key})}),[]);return e})),D=(0,s.c)(S,1)[0],M=(0,w.useState)([]),R=(0,s.c)(M,2),_=R[0],O=R[1],B=(0,w.useState)(null),j=(0,s.c)(B,2),L=j[0],U=j[1],K=(0,w.useCallback)((function(){U(T.length),A({type:"ADD",payload:au})}),[T,A]),V=(0,w.useCallback)((function(e,t,n){A({type:lu,index:t,payload:(0,f.c)({},n,e)})}),[A]),z=(0,w.useCallback)((function(e){U(null),A({type:iu,index:e})}),[A]),G=(0,w.useCallback)((function(e){var t=x()(e).call(e,(function(e){return{label:e.PropCap,value:e.PropKey}}));O(t)}),[]);return(0,w.useEffect)((function(){return G(h()),k.eventBus.on(dr,G),function(){k.eventBus.off(dr,G)}}),[]),(0,w.useEffect)((function(){(0,we.isEqual)(n,T)||t(T)}),[T]),(0,w.useEffect)((function(){(0,we.isEqual)(n||[],T)||A({type:cu,payload:n})}),[n]),F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:c,className:r,name:a,tips:i,required:u,title:d}),F().createElement("div",{className:"".concat(m,"-relate-field")},x()(T).call(T,(function(e,t){return F().createElement(nu,{key:t,prefixCls:"".concat(m,"-relate-field"),data:e,index:t,isNewOption:L===t,handleUpdate:V,handleDelete:z,currFldOptions:D,refFldOptions:_})}))),F().createElement("div",{className:"".concat(m,"-relate-field-add")},F().createElement("div",{className:"add-btn",onClick:K},F().createElement(P.Icon,{type:"zengjia-yuan",prefix:"designericon"}),F().createElement("span",{className:"".concat(m,"-relate-field-add-option-desc")},"添加"))))};function fu(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function du(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var pu="start",vu="end",mu=function(e,t){return du(du({},e),t)},gu=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.locked,a=e.Editor,i=e.Name,l=e.Tips,c=a.NameHidden,u=a.Required,d=a.minPlaceholder,p=void 0===d?"请输入":d,v=a.maxPlaceholder,m=void 0===v?"请输入":v,g=a.Title,h=(0,w.useReducer)(mu,(0,f.c)((0,f.c)({},pu,!1),vu,!1)),y=(0,s.c)(h,2),b=y[0],C=y[1],E=(0,w.useReducer)(mu,(0,f.c)((0,f.c)({},pu,String((null==n?void 0:n[pu])||"")),vu,String((null==n?void 0:n[vu])||""))),I=(0,s.c)(E,2),x=I[0],N=I[1];(0,w.useEffect)((function(){var e=String((null==n?void 0:n[pu])||""),t=String((null==n?void 0:n[vu])||""),r=b[pu],o=b[vu];r||e===x[pu]||N((0,f.c)({},pu,e)),o||t===x[vu]||N((0,f.c)({},vu,t))}),[n,b]);var T=(0,k.useDebounce)((function(e,n){var r=du(du({},x),{},(0,f.c)({},n,e));t(r)}),300),A=function(e){C((0,f.c)({},e,!0))},S=function(e){C((0,f.c)({},e,!0))};return F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:c,className:r,name:i,tips:l,required:u,title:g}),F().createElement("div",{className:"".concat(r,"-datascope-editor")},F().createElement(P.Input,{borderType:"bordered",value:x[pu],onChange:function(e){var t=e.target.value||"";N((0,f.c)({},pu,t)),T(t,pu)},onFocus:function(){return A(pu)},onBlur:function(){return S(vu)},disabled:o,placeholder:p}),F().createElement("div",{className:"".concat(r,"-seperator")},"-"),F().createElement(P.Input,{borderType:"bordered",value:x[vu],onFocus:function(){return A(vu)},onBlur:function(){return S(vu)},onChange:function(e){var t=e.target.value||"";N((0,f.c)({},vu,t)),T(t,vu)},disabled:o,placeholder:m})))},hu=function(e){e.handleChange;var t=e.value,n=(e.className,e.locked),r=e.field.FormatType,o=(0,w.useContext)(ae).prefixCls,a={className:"".concat(o,"-daterange-editor"),popperClassName:"".concat(o,"-range-picker-dropdown"),disabled:n,placeholder:["起始日期","结束日期"],formatType:r,allowClear:!0,fieldType:"dateRange"};return F().createElement(_c,(0,R.c)({},e,{getRenderValue:function(e){return pt(e)},editorType:"dateRangeDef",value:t,inputFieldProps:a}))},yu=new(Pe())([["2","month"],["3","year"]]),bu=function(e){var t=e.handleChange,n=e.value,r=(e.className,e.locked),o=e.field.FormatType,a=(0,w.useContext)(ae).prefixCls,i=((0,w.useMemo)((function(){return{picker:yu.get(o)||"date"}}),[o]),{className:"".concat(a,"-date-editor"),disabled:r,placeholde:"请选择",formatType:o,allowClear:!0,fieldType:"date",placeholder:"请选择"});return F().createElement(_c,(0,R.c)({},e,{editorType:"dateDef",value:n,getRenderValue:function(e){return e&&Date.parse(e)?new Date(e):void 0},handleChange:function(e){t(e)},inputFieldProps:i}))};function Cu(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cu(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Cu(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Iu=(0,w.memo)((function(e){var t,n,r,o=e.handleChange,a=e.value,i=e.className,l=e.editor,c=e.Name,u=e.Tips,d=e.field,p=l.NameHidden,v=l.Required,g=l.Title,h=d.FileMaxSize,y=d.UploadNum,C=d.UploadModel,E=d.AttachmentFileType,I=d.FieldType,N=d.ButtonText,T=(0,w.useContext)(ae),A=T.getKdesignerApi,S=T.baseUrl,D=(0,w.useState)(""),P=(0,s.c)(D,2),R=P[0],_=P[1],O=(0,w.useState)([]),B=(0,s.c)(O,2),j=B[0],L=B[1],U=(0,w.useState)(""),K=(0,s.c)(U,2),V=K[0],z=K[1],G=A(),H=(G.data,G.meta.getControlPropertyDefaultValue),q=H(I,"AttachmentFileType"),Y=H(I,"FileMaxSize"),W=h||Y,Q=E||q,X=(0,w.useRef)(new(Pe())),Z=(0,w.useCallback)((function(e){if(!e||"{}"===e)return[];if(qt(e)){var t=JSON.parse(e);return Array.isArray(t)?x()(t).call(t,(function(e){return X.current.set(e.uid,e),Eu(Eu({},e),{},{url:S.attachment+e.url})})):t.value}return""}),[]);(0,w.useEffect)((function(){X.current=new(Pe());var e=Z(a);Array.isArray(e)?(L(e),z("")):z(e)}),[Z,a,L]);var J=(0,w.useCallback)((function(e){Vn.WebMsg.showNotificationMsg({param:[{type:2,content:e,duration:2e3}]})}),[]),$=(0,w.useCallback)((function(e,t){return null!=y&&y.max&&t.length>y.max?(J("最多只能上传".concat(y.max,"个文件，请重新选择")),!1):!(W&&e.size/1024/1024>W)||(J("请上传小于".concat(W,"M的文件")),!1)}),[null==y?void 0:y.max,W]),ee=(0,w.useCallback)((function(e){var t=e.file,n=e.fileList;if("done"===t.status&&t.response.status){var r,a=t.lastModified,i=t.uid,l=t.name,c=t.type,u=t.size,s={status:"success",url:t.response.data.url,uploadTime:Date.now()};X.current.set(t.uid,Eu({lastModified:a,uid:i,name:l,type:c,size:u},s)),o(Ka()((0,M.c)(xl()(r=X.current).call(r))));var f=x()(n).call(n,(function(e){return e.uid===t.uid?X.current.get(t.uid):e}));L(f)}else L((0,M.c)(n))}),[o]),te=(0,w.useCallback)((function(e){var t=m()(j).call(j,(function(t){return t.uid!==e.uid}));if(X.current.get(e.uid)){var n;X.current.delete(e.uid);var r=X.current.size>0?Ka()((0,M.c)(xl()(n=X.current).call(n))):"";o(r)}return L((0,M.c)(t)),!0}),[j,o]),ne=(0,w.useCallback)((function(e){var t,n=X.current.get(e.uid);n&&(n.name=e.name,X.current.set(e.uid,n),o(Ka()((0,M.c)(xl()(t=X.current).call(t)))));L(yt()((function(t){t.forEach((function(t){t.uid===e.uid&&(t.name=e.name)}))})))}),[j,o]);return(0,w.useEffect)((function(){var e,t;_(b()(e=b()(t="".concat(c,"(")).call(t,X.current.size,"/")).call(e,(null==y?void 0:y.max)||1,")"))}),[y,j]),F().createElement("div",{className:"".concat(i,"-attachment-editor")},F().createElement("div",{style:{marginBottom:"8px"}},F().createElement(k.NameTipWrapper,{nameHidden:p,className:i,name:R,tips:u,required:v,title:g})),!V&&F().createElement("div",null,F().createElement(Vn.Attachment,(0,f.c)({multiple:!0,action:zt(window.__domainurl__+"nocode/v2/nocode_sys/attachment"),data:{action:"upload",tempstorage:!1},fileList:j,buttonText:N,mode:C,onChange:ee,beforeUpload:$,onRemove:te,onChangeFileName:ne,accept:Q||"",uploadNum:y,noticeInfo:b()(t=b()(n=b()(r="请上传小于".concat(W,"M的")).call(r,null==Q?void 0:zo()(Q).call(Q,".",""),"文件，文件个数不少于")).call(n,(null==y?void 0:y.min)||0,"个，不多于")).call(t,(null==y?void 0:y.max)||1,"个")},"mode",1))))}));function xu(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xu(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):xu(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Tu,Au,Su,wu=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.field,a=o.Precision,i=o.Scale,l=o.DataRange,c=o.ThousandsSeparator,u=(0,w.useMemo)((function(){var e={},t=l||{},n=t.min,r=t.max;return(0,we.isUndefined)(n)||""===n||(e.min=Number(n)),(0,we.isUndefined)(r)||""===r||(e.max=Number(r)),e}),[l]),s=(0,w.useCallback)((function(e){return c?Kt("".concat(e)):String(e)}),[c]),f=Nu(Nu({className:"".concat(r,"-number-def-editor")},u),{},{showStepper:!0,decimalLength:i,formatter:s,maxLength:a,fieldType:"number",placeholder:"请输入"});return F().createElement(_c,(0,R.c)({},e,{editorType:"decimalDef",value:"".concat(n),onChange:function(e){t(e)},inputFieldProps:f}))},Fu="#F8FAFC",ku=(0,M.c)(new(mn())(x()(Tu=p()(Ye)).call(Tu,(function(e){return Ye[e]})))),Du=b()(Au=[Fu]).call(Au,ku),Pu=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.editor,a=e.locked,i=e.field,l=e.Name,c=e.Tips,u=o.NameHidden,s=o.Default,f=o.Required,d=o.Title,p=i.BackImage,v=(0,w.useRef)(!0),m=(0,we.isUndefined)(n)?s:String(n),g=function(e){a||t(e)};return(0,w.useEffect)((function(){!m&&g(ku[0])}),[]),(0,w.useEffect)((function(){if(p&&!v.current){var e=Te()(We).call(We,(function(e,t){return S()(p).call(p,"background_".concat(t+1))}));g(e?Ye[e.primaryColor]:Fu)}v.current=!1}),[p,We]),F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:u,className:r,name:l,tips:c,required:f,title:d}),F().createElement(Zr,{className:"".concat(r,"-colorpicker-content"),colorList:Du,prefixClass:r,onChange:g,value:m}))},Mu=n(3872),Ru=n.n(Mu),_u=zt((Su="nocode/v2/nocode_sys/image",window.__domainurl__+Su)),Ou=["image/png","image/jpeg","image/jpg"],Bu=function(e){var t=(0,w.useContext)(ae),n=t.baseUrl,r=t.showMessage,o=e.handleChange,a=e.value,i=e.className,l=e.editor,c=e.locked,u=e.Name,d=e.Tips,p=l.NameHidden,v=l.Default,m=l.Required,g=l.Images,h=void 0===g?[]:g,y=l.Title,b=(0,we.isUndefined)(a)?v:String(a),C="".concat(i,"-bgimage"),E=(0,w.useState)(!1),I=(0,s.c)(E,2),N=I[0],T=I[1],A=(0,w.useState)(""),D=(0,s.c)(A,2),M=D[0],_=D[1],O=F().useState(null!=b?b:Ht(n.picture,b)),B=(0,s.c)(O,2),j=B[0],L=B[1];(0,w.useEffect)((function(){b&&L(Ht(n.picture,b))}),[b]),(0,w.useEffect)((function(){!b&&U(v)}),[]);var U=function(e){c||o(e)},K=F().createElement("div",null,F().createElement(P.Icon,{className:"".concat(C,"-content-upload-add"),type:"add"}),F().createElement("p",{className:"".concat(C,"-content-upload-text")},"上传自定义图片")),V={data:{action:"upload",tempstorage:!0},name:"file",action:"nocode/v2/nocode_sys/image",showUploadList:!1,listType:"picture",accept:Ou.toString(),onChange:function(e){e.file},beforeUpload:function(e){if(S()(Ou).call(Ou,e.type)){M&&Ru().revokeObjectURL(M);var t=Ru().createObjectURL(e);return _(t),T(!0),!1}}};return F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:p,className:i,name:u,tips:d,required:m,title:y}),F().createElement("div",{className:"".concat(C,"-content")},x()(We).call(We,(function(e,t){var n=h[t]||h[0],r=Gt(n);return F().createElement("div",{key:t,className:"".concat(C,"-content-item"),onClick:function(){return U(n)}},F().createElement("img",{className:"".concat(C,"-content-image"),src:r,alt:e.name}),F().createElement("div",{className:"".concat(C,"-content-handle")},F().createElement("span",{className:"".concat(C,"-content-text")},e.name),F().createElement("span",{className:jn()("".concat(C,"-content-uncheck"),(0,f.c)({},"".concat(C,"-content-check"),n===b))})))})),F().createElement(P.Upload,(0,R.c)({className:"".concat(C,"-content-upload")},V),j&&!S()(h).call(h,b)?F().createElement("img",{src:zt(j),alt:"avatar",style:{width:"100%"}}):K),F().createElement(P.ImageCropper,{autoCropArea:1,imageMaxSize:20,containerWidth:800,containerHeight:588,aspectRatio:6,visible:N,title:"图片裁剪",image:M,onClose:function(){T(!1)},onCropSuccess:function(e){var t=new FileReader;t.readAsDataURL(e),t.addEventListener("load",(function(){var t;(t=e,new(jr())((function(e,n){var r=new FormData;r.append("file",t),r.append("action","upload"),r.append("tempstorage","true");var o=new XMLHttpRequest;o.open("POST",_u),o.onload=function(t){200===this.status&&t.target.response?e(JSON.parse(t.target.response)):n(t)},o.onerror=function(e){n(e)},o.send(r)}))).then((function(e){var t=e.data;if("0"===e.errorCode){var a=(t||{}).url;if(!a)return;var i=Ht(n.picture,a);L(i),o(a)}else r("裁剪图片失败，请稍后重试")})).catch((function(e){r("裁剪图片失败，请稍后重试")})).finally((function(){return T(!1)}))}))},dragMode:"move",cropBoxMovable:!1,className:"".concat(C,"-content-cropper"),okText:"确定裁剪"})))};function ju(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ju(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):ju(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Uu=Vn.treeUtils.exludeTreeNodeByCallback,Ku=[{value:1,label:"编辑"},{value:2,label:"禁用"},{value:3,label:"只读"},{value:4,label:"隐藏"},{value:5,label:"必录"},{value:6,label:"非必录"}],Vu=new(Pe())([[1,["NoCodeGraphicDisplayField"]],[2,["NoCodeGraphicDisplayField","NoCodeGroupContainerAp"]],[3,["NoCodeGroupContainerAp"]],[4,[]],[5,["NoCodeGraphicDisplayField","NoCodeGroupContainerAp"]],[6,["NoCodeGraphicDisplayField","NoCodeGroupContainerAp"]]]),zu=function(e){var t=e.value,n=e.onChange,r=e.fieldOptions,o=(0,w.useState)(t||[]),a=(0,s.c)(o,2),i=a[0],l=a[1],c=(0,(0,w.useContext)(ae).getKdesignerApi)().data,u=function(e,t){var r=Te()(i).call(i,(function(e,n){return n===t})).actionType;if(e!==r){var o=r<5&&e>4||e<5&&r>4,a=x()(i).call(i,(function(n,r){if(t===r){var a=n.fieldName,i=Vu.get(e)||[],l=St(a),u=m()(l).call(l,(function(e){var t,n=((null===(t=c.findControlByCondition((function(t){return t.Key===e})))||void 0===t?void 0:t[0])||{})._Type_;return S()(i).call(i,n)}));return o?{fieldName:[],actionType:e}:u.length?{fieldName:m()(l).call(l,(function(e){return!S()(u).call(u,e)})),actionType:e}:Lu(Lu({},n),{},{actionType:e})}return n}));l(a),n(a)}},f=function(e,t){var r=x()(i).call(i,(function(n,r){return t===r?Lu(Lu({},n),{},{fieldName:e}):n}));l(r),n(r)};return(0,w.useEffect)((function(){var e=t||[];(0,we.isEqual)(e,i)||l(e)}),[t]),F().createElement("div",{className:"display-rule-true-actions"},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},x()(i).call(i,(function(e,t){var o,a=e.actionType,c=e.fieldName,s=Vu.get(a)||[],d=Uu(r,(function(e){var t=e.type,n=e.children;return!S()(s).call(s,t)||!!n.length})),p=fl(d,"key"),v=m()(o=St(c)).call(o,(function(e){return S()(p).call(p,e)}));return F().createElement("div",{className:"row_item",key:t},F().createElement(P.Select,{className:"action-type-select",value:a,options:Ku,placeholder:"请选择",borderType:"bordered",size:"middle",onChange:function(e){return u(e,t)}}),F().createElement(Vn.KDTreeSelect,{mode:"multiple",className:"field-name-select",virtual:!1,value:v,treeData:d,showFullLabelTips:!0,treeCheckStrictly:a>4,onChange:function(e){return f(e,t)}}),F().createElement(P.Icon,{className:"delete_icon",prefix:"ncicon",type:"xingshanchu",onClick:function(){return function(e){var t=(0,M.c)(i);ce()(t).call(t,e,1),l(t),n(t)}(t)}}))}))),F().createElement("div",{className:"footer-btns"},F().createElement("div",{className:"add-btn",onClick:function(){var e,t=b()(e=[]).call(e,(0,M.c)(i),[{actionType:"",fieldName:[]}]);l(t),n(t)}},F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zengjia-yuan"}),"添加规则效果"),!!i.length&&F().createElement("div",{className:"clear-all",onClick:function(){l([]),n([])}},"清空")))};function Gu(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gu(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Gu(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var qu=Vn.treeUtils.dfs,Yu=Vn.treeUtils.getListConfigPure,Wu=Vn.ListFilterUtil.getVarSelectDisabled,Qu=function(e,t){return Hu(Hu({},e),t)},Xu=function(e){var t=e.prefixCls,n=e.value,r=e.fieldKey,o=e.ruleId,a=e.listFilterConfig,i=e.fieldOptions,l=e.onChange,c=P.Form.useForm(),u=(0,s.c)(c,1)[0],d=(0,w.useContext)(ae),p=d.invokeAction,v=d.getKdesignerApi,g=d.baseUrl,h=d.batchInvoke,y=d.getControlText,b=d.onDownLoad,C=v(),E=C.data,I=C.meta,x=E.getRootId(),N=(0,w.useReducer)(Qu,n),A=(0,s.c)(N,2),D=A[0],M=A[1],R=(0,w.useState)({}),_=(0,s.c)(R,2),O=_[0],B=_[1],j=(0,w.useRef)(),L=yc({id:r,formId:x,eventName:"filterItemLook"}),U=(0,w.useMemo)((function(){return Yu(a)}),[a]),K=(0,w.useMemo)((function(){return ul({metaApi:I,options:a})}),[a]);(0,w.useEffect)((function(){var e=L.data,t=L.param,n=(void 0===t?{}:t).enumField;if(n){var r,o=null===(r=D.preCondition)||void 0===r?void 0:m()(r).call(r,(function(e){return e.fieldName===n})),i=qu(a,(function(e){return e.key===n}));B((function(t){return Hu(Hu({},t),{},(0,f.c)({},n,{configuredFilter:{enumEqCompareType:"001",items:o},fieldFilterConfig:i,groupInfo:e}))}))}}),[L,D.preCondition,a]);var V=(0,w.useMemo)((function(){return!(null!=o&&S()(o).call(o,"new_rule_"))}),[n]),z={baseUrl:g,batchInvoke:function(e,t){h(e,r,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])},getControlText:y,addControlAction:function(e,t){return k.eventBus.on(e,t),function(){k.eventBus.off(e,t)}},onDownLoad:b,batchInvokeListConfig:function(e){h("listconfig","nocodeformdesigner",[e])},batchInvokeQuery:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.select,u=void 0===c?"":c,s=t.page_size,f=void 0===s?10:s,d=t.page_no,p=void 0===d?1:d,v=t.ids;h("query","nocodeformdesigner",[e,{filter:r,search:a,order_by:l,select:u,page_size:f,page_no:p,ids:void 0===v?[]:v}])}},G=(0,w.useCallback)((function(){var e,t,n=null===(e=j.current)||void 0===e||null===(t=e.updateVerifyAndGetMsg)||void 0===t?void 0:t.call(e);new(jr())((function(e,t){u.validateFields().then((function(t){var n=xl()(t);e(n)})).catch((function(e){return t(e)}))})).then((function(e){var t=e.name;e=Hu(Hu({},e),{},{name:Qr()(t).call(t)});var r=Hu(Hu({},e),{},{formId:x,ruleType:"0"});V&&(r.ruleId=o),!n.length&&p("saveFormRule",[r])})).catch((function(e){}))}),[x,o,V]),H=(0,k.useDebounce)(G),q=function(e,t){M((0,f.c)({},e,t));var n=new(Pe())([["name","ruleName"],["preCondition","expression"],["trueAction","trueaction"]]).get(e)||e;l((0,f.c)({},n,t))};return F().createElement("div",{className:"display-rules-setting"},F().createElement("div",{className:"setting-form"},F().createElement(P.Form,{layout:"vertical",form:u,labelWidth:"100%",wrapperWidth:"100%",onValuesChange:function(e,t){}},F().createElement(P.Form.Item,{label:"规则名称",name:"name",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入规则名称"},{type:"string",validator:function(e,t,n,r,o){return null!=t&&Qr()(t).call(t)?[]:[new Error("请输入规则名称")]}}]},F().createElement(P.Input,{type:"text",borderType:"bordered",size:"middle",placeholder:"请输入规则名称",maxLength:50,value:D.name,onChange:function(e){return q("name",e.target.value)}})),F().createElement(P.Form.Item,{label:"当满足以下条件时",name:"preCondition",rules:[{type:"array",required:!0,message:"请添加判断条件"}]},F().createElement(Vn.FilterEditor,{id:"filter",ref:j,valueRequired:!0,name:"添加判断条件",tips:"",variablesTree:K||[],listFilterConfig:U||[],onGetFieldRecords:function(e){!function(e){p("getFilterItemLook",[e,{getEnumData:"true",enumField:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",filterrows:[]}])}(x,e.fieldName)},fieldRecords:O,nameHidden:!0,style:{marginTop:"0px"},getVarSelectDisabled:Wu,fieldData:{fieldType:"treeSelect",style:{width:"184px"}},filterFooterData:{listType:"tree",triggerText:"添加判断条件"},value:D.preCondition||[],refBillProps:z,onChange:function(e){u.setFieldValue("preCondition",e),q("preCondition",e)}})),F().createElement(P.Form.Item,{label:"则执行",name:"trueAction",rules:[{type:"array",required:!0,validator:function(e,t,n,r,o){return null!=t&&t.length&&t.every((function(e){return T()(e).every((function(e){return"string"==typeof e?""!==e:!Array.isArray(e)||0!==e.length}))}))?[]:[new Error("请添加规则效果")]}}]},F().createElement(zu,{prefixCls:t,value:D.trueAction,fieldOptions:i,onChange:function(e){return q("trueAction",e)}})))),F().createElement("div",{className:"setting-footer"},F().createElement(P.Button,{size:"small",type:"primary",onClick:H},"保存")))},Zu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcAAAAEACAMAAAATE1b1AAACQ1BMVEUAAADb3eja4uzZ3ejY3efg5OfY3enW3una3unV4unY3+nb5O3X3enY3ejb3ufX3ejX4ebN2OTW2+fX3OfY3OnX2+jY3enX3ejX3OfX3enW3ObV3efX3ejV3OXW3ePY3unX3OfX3OZloPrY3efX3ejW3u8AHWDd5O80Rm76zMJCU3kSKWItP2s8TXTr1tQnOmmLl7ItQGktQGktcvQoOmf8z8XY3en20sobMGYjOGk9e/MuQGm01v//zsIsP2jj6vXx1M8mN2r9z8JDU3r40cjz1M8mO2knWLkscvYCHV8zd/b7zsQsP2l3nOzW3OjW3Oe11v8DHl/d4+4zd/UAHF4MJGD/wrVQfuO01v8AHF612P+DneYncPf/v7Iscfri6PNriOJGT3fpraN4jt5TY4UocPdseZiDtvx3luS01/+MlbEocPbi6POz1f/W3Ocnb/UsPmiFuP/K0Nv/zcAAHF7Y5PWq0P+XxP97rPy92fzV2uXe5O+hyf+y0/3O1OD/s6tlc5OOvv+Wwf2z0PkrRHgjMVP21M6ZufNXlv0wdPVda43Q1+JAUHjv2tr+yL0/gvjY3+ojZeD80MV8iaVYZ4omNlrk5vBnnvro4uc0Rm3+wrdtephSYYQpOmKss8vE0fEnbO7m5OvFzd4hXs9LW39Ni/e0vNSircXrtrb/ubCVhZrS3vRkkOzr4OO7xNWbpbyHrfR2ovRWfuaLo+KpmsvcssCSnbbdrKq5maF3bIliXYAXLGeuwu+Di9bLts52htdyg6mPG3iNAAAAbHRSTlMAEgsaJgYiGB0PKwQhLxYpDgkfLTQVOD89SEMzRTclOzoyW0FLH4b9d/SRTMmFUTT88d3Ss7CSjSkS/vzz256SbR/HnIBcQAnu47Oei4nz1cm/vZ6AaVby4NBpX1A5IdXJtbKhhHdsaDSrUjldQMwIAAAMu0lEQVR42uzZQY3EMAxAUV96KZEwKIxWGhyRCQyJQt5dqVpNh4Hd9yh8WYmTAAAAAAAAAAAAAAAAAAAAAACAb+t27NnMfmxrPMOyZVPbEg+wvLKt1xMKtp2/P1u0t2Zr/c/B1gP4hBE8srUjumu3P9zt0V02co75a5z5IbrLPsa8DAEres9/77wIWMeYH4aA1Zzz5joHBSxjzJshYDHzi4DFCFicgMUJWJxLTHHWiOos8tV5SqvOY3Z1vpMaiu6yuegum4vusrno7oddu3tRIgrjOP5U9mZFQZRuSQXbTXRRN90sdFFERdFVVEQv9ELQxdOe9MzCprRzUahDOZIXJl5UtlTrtkGv9LK9/WnNzKozo44Fe5DOrz74Mnouv5zjOeo4OEI3Do7QjYMjdOPgCB2DI3QMjtAxOELH4AgdgyN0DI7QMThCx+AIHYMjdAyO0DE4QsfgCB2DI3QMjtAxOELH4AgdgyN0DI7QMThCx6ievnj0Yu/PvXsIHGN6et9oOXuYoDGk3F3Dd4qQMaLarBG0m4Axnmpe3jeCzhIwhlOrSDlvhBwgXIzG7Wcbxj+zhjKYV04/OeNE+3L/f0ANlaTro2HM75KfjTbkwyAjaeSlyzYNY9Z57uxFjxAuBlKSC+rmzc/S9Wn+/y5UH9W8bMnv+jwjPfan2dmPXy4TMEbh7l48lQaXPtrS9+UKAWMMgelXZea6DPh0moAxhFol1I8bMgB6AmIELMm2Ei/Iy46DBI3118j7/XqTSugFFCFgoNUrbqvKtv2EjTUXmH6VGvs6b18gbKy3kvT7NUIDtvQcJ3Css5r05avhsqZ7lLCb4J+AgwPmslOZzFQ2p2Zcvar0VWockjdNs9k0TegVdMParSmOls20ZJWMq5eXHfW6fDdXeBwM6EIOuDo2utPBke5lOu6pHVcfsG5L+VYIYc29+/qSHS8LM6br+QmCtGatU88zaP75sirH1Qe03YaWaBmbm3szmU5/MM2ZQjp98tr5iwRmaTw10sYRcpmQnNpx9XsY+UEEFdPp9He336RwHD128hzBWB4fCYiegCFZtePqDxH2exFkpZ12D52HZ515ibKYrkiN/EnAqUzIlNLxiUUJ/QhRkQua34TrgWh5mC4Wi88mJ4XvKgFYkhwJ4wiZLurGJ27dWJTbdzio+sqNaJtvwwGtslUslq2y8I0tJd2tWZ/qNvSAEzcW6Xb6DneplWzTCgT0uAFFiPaL6NJkqsfQl9Bbiw/oF/Q9Fq4nkQHdvpdIbyu3pHoNfRNzQ0HAPgULCxNw4Aw8Q1qLpfoZ9jFiQknA3oKFMS/gtPCVy5YIGSOdxbf0NayDvOKAvQX58euymJ4WUZ44902kr3Vb+hvSV2mKA/oFww3fnRkYUOPTvN+vy3C+zFYbMLogvxRRHmh9EoyPRhnKz0nKA0YXjA6o8zZ0W8Ixmhj1OBcBPATqA0YXtCIDarwNXZUIQwnYr2A56iPQ3d5YpKXVCdSAfQo+GxRQXCcNLd+c9CSSCefmPTu8awf/xt8dsLfgw6gVdPrtt/cftPyHzMZkFICAPQXfiP5+mM26lIdIPyuT0AG7C74W/b23pWMfaWf55u0D8W/89QG7ChZEf4/af9PesGxFLL4uHluxcgPpIOZl2rF9h8e5aL/2rncABAwX/NXOff0qDcUBHP9RNsLFgTiuuPeece+9Emdi1GhM3P4UTN0rzjgTTdQY44xxvKlPPhn/Ng8t0IJtT738xB74fW5Dlz59Q8s55d6fRWe/dMOg0XbDsoGfXEsOl0AJBQLWFXxXdDZBNywb3WBIJtiPeVN5CZRQIaAoKJ1L001zB/2pOwmBlcx3REB7waKjdbppziAnuRAEVCpfKOQL+ToF41h1jd4UCWgruKDoZJZumjDIWRYCqXdB5v8FvHrO7m8C3nRy0XsqZoNeMcjFsEDeCmOFXEEsuVxlbag79v8CXjltc+Nks2oBX0gCDnGTgMDplZNDCeUCOk/FbF6sm6YOdhW8y2i8EwN+dw44VzctG+wuAgGT6pZDCeUCOk/F7Jmqm1aN8hCwgtHuTgx4q+hkyIAJlYHgAC8xCJKuET6ghHIB3zkOAwcMWKEbNg7wFIYAiWV8QAnlAp51HAYOHDi3MpIf6GlYHwiOTEcGxPfOAZfphhUDvWUgMLTODPj5toPJw4YN1g2Lh0kk4L/RQl3xcDgeD2lQFupXL9MvkxEvDVBCuYAPSk4ODx9ujgQnDJfIa/A/JMMRM5AZKhbXIGHsN8Zr94BPFpacHMjn5+iGgXmJCLScFk79WSb157FOCPi55GhmPr9KN0y15vMF+3Z1PwqtpaVTTUAJ1QJ+KTkrFCpD+dUFmb7QSr0SqZSSAUlZAaeXnB3P5cyh/LKcTHcvaJ1kNsUB7QGflpwdzuXMofzcnFQcWiaebRZKqBbwVcnZwe7ujeZUTLdUFlolkeWADQGvuwUcMcIcys8ZIReFlojGIjLZSFYsXsdQQrWAD0rOJmYyo8ypmIxcCFoiFmlCuwZ8XXK2UnQxhvKLM3IJaIVEhAP+XUBjKD8hIxeBPl3pSLZfKhJLhOAf6YpwQIeAz9wCikkL84FErp9c1r6T/icNk0OrIkMjYjHWgve2/d+b0C/6b6WR8B1QDJlW62WDUn9tqAbUojEi6Bf9TAyJvwmYMadiUp6yqaxYUg36ArEwB5QHXGgPmBXMgWC2J4ZGgZIW44DygC/twwhxExloPlCK9IxG/QZMx9IGsSGW+rUgVm7naucFlFA54KNS6Y094FTdMDXSI5TvQS1Not0Dfiw9v+MQcFmkZ9JAJs4Bq7xmYl7fufO8FlB84q4EnDvUTWxorEysHPfDQGVM3zF9/yAOisVaN5wTnM6jhMoBH9gDig6r9VWrywFjPaUBjd61MIm+CbH42xYvgrFdk2jrgK8aAk7VB8ZW6PqqWE+FgUZXgg76Qx/w3HkSXgGf3rljfYgRt4sRc9LpVWIgmO4xDUgk2iEgEa+AP+wB+5pGiWFE3x6LA4Vo2FMinBBL2CeUUDngW3vA6h1kzjLrjmJpPOZ2DihoIpL7jxVS/tPeAV9+tQWckiCh0XwH1Ad+B5YeXbtzp1QLGCYRAgKhcFPaO+B12zj+SVADxgmhhMIBn+Fz8oBdHFASgjDgdXxpCxinwQElIQgDPsVHz4MZsOsP8a64WBz2pZAO/UC+2YCvbQG7aNAEbE4wAvqYSrvRXMAfeN0WsD8NkoD9CaGEwgG/4Ssr4PgQDSCQDNXpH+ovFqd992MWlFA44Ft8qkTAv9YpAb/idA6ICgf8gN/eWAGTNIBAbw7oK+AlfPsXAXsne4vFbZsD/oeAiJ9tAXvTIAmYJIQS6gZ8ifihZAXUaAABrS0CXj0n11TAR4gPAxqw8QJtrk3WfuPaOmf//+iDmlNprxEvBzYgHZRQLaD1K9YPEPGlFbAPDZKAlFBC3YCvEPGRFTBKAwj04YB+LqFPEfEjB0SlAz6zAvbyIdorGhUvXvgSKglBF3C6sWcFpAEE+pi0PppYnLcFsbKOOzDPtV3AB9bDiLo74ngIjmgfQiijbMAvdX+3aQoER5QSyigW0Lrrva0LuAmCgwP6CvgZEadzQNUCvrY9DkT8EciAvTign4AfEPFbMANSQhnFAlpD94d1f/51CQQHB/QV8Akivg1kQFIooVpAa/YTha8cEFUN+BKFDxwQVQ34CIVrHFCVgCcbA35E4VSpaja0qXHoTdmAr7Gs/QPuR2+qBXxpPZA3dts+4FL0pmzA61g2o+0D9kMZtQIutH2jQpjZ9gH9vAVVClj3QB6XTq7uToZ2Fd2GXpQOuC3aAQEhuhTdqRbwsv0bFUujMLsDAgL0W7p/HP5jd6suNOO8LOA4K+DSfgCwpCMCtkKRxAXXfovAML9UNQmAA6ofcFN1dyYwtQKugbLxHFCtgMtLVdM4IKl1RQov/AdcDmU7OSCRWf844K7GgPOhbFJ1dwawpmwoUrjnGnALGOaVqtZC2RoOSORQkcL9q24BdzcEXAiGaRyQyL4iCddfm9ecg83jgMG6Cd7zvoJaAWc23BMXAmvOiSIJl8m0iEtAa1wIrEnbixQ+Od4Fj0HFmsapMw5IZu2/G0nsglrAGQ0PcBdWrqB8D2zevn9VcJcGNcvXnxG2TpsHpmlrzAPAmreWaDB41fEDjGnrGcMkqBprHhgLjMBekjfhggv2ObTdYLPjjGk2VK0/U03KSBJup5gVffzi5lWj3pbdYDfvTMX6P4+sBUZj7dGRFI4c6Y5Cg61nquaBaafY5ouoKiadqZlk3QKr5gMLuPk7xlbsqNaaVzu0ExhjjDHGGGOMMcYYY4wxxhhjjDHGGGN/7zcWyc9ypV5uJAAAAABJRU5ErkJggg==";function Ju(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function $u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ju(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Ju(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var es=Vn.treeUtils.exludeTreeNodeByCallback,ts=function(e){var t=e.handleAdd;return F().createElement("div",{className:"rule-empty"},F().createElement("img",{src:Zu,alt:"暂无卡片",width:224,height:128}),F().createElement("div",{className:"empty-text"},"暂无规则，点击下方按钮添加"),F().createElement(P.Button,{type:"primary",icon:F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zengjia-yuan"}),onClick:t},"添加规则"))},ns=function e(t,n,r,o){return t.reduce((function(t,a){var i=a._Type_,l=a.Name,c=a.Key,u=a.BillEntityIdEx,s=a.SelectItemType,f=a.Multi,d=a.children,p={title:l,titlePrefix:rn(a,n,r,o),key:c,type:i,entityId:u,isMulti:1===s||1===f};return d&&(p.children=e(d,n,r,o)),b()(t).call(t,p)}),[])},rs=(0,w.forwardRef)((function(e,t){var n=e.prefixCls,r=e.field,o=e.refreshEditorDisplay,a=(0,w.useState)(),i=(0,s.c)(a,2),l=i[0],c=i[1],u=(0,w.useState)(null),f=(0,s.c)(u,2),d=f[0],p=f[1],v=(0,w.useContext)(ae),g=v.invokeAction,h=v.getDisplayRules,y=v.setDisplayRules,C=v.getCompareTypes,E=v.getKdesignerApi,I=v.curListTreeApi,N=v.getRefBillNameMap,T=E(),A=T.data,D=T.meta,R=C(),_=r.Key,O=(A.getRootId(),bc({api:I,parser:function(e){return $t(e,e,R)}})),B=(0,w.useMemo)((function(){return on(O)}),[O]),j=(0,w.useMemo)((function(){var e,t=A.getData().Items||[],n=es((null===(e=dl(t)[0])||void 0===e?void 0:e.children)||[],(function(e){var t=e._Type_,n=e.BillEntityIdEx,r=e.showType,o=e.children;return!(!Ut(t)||null==o||!o.length)||(it(t)?"1"!==r:$e(t)?!(null!=e&&e.RefTableId&&"2"===(null==e?void 0:e.ShowType)):!(ct(t)||("NoCodeMulRefBillField"===t||"NoCodeRefBillField"===t)&&void 0===n))}));return ns(n,B,D,N())}),[B,N]),L=(0,w.useCallback)((function(){var e=(null==d?void 0:d.length)||0,t="new_rule_".concat((0,k.createUUid)()),n={ruleId:t,ruleName:"规则".concat(e+1),depfldkeys:"",affectfldkeys:"",expression:[],trueaction:[]};p(d?b()(d).call(d,n):[n]),c(t)}),[d]),U=function(e){var t=(null==d?void 0:Ur()(d).call(d,(function(t){return t.ruleId===e})))||0,n=l;if(l===e){var r=t>0?d[t-1]:void 0,o=d[t+1];r?n=r.ruleId:o&&(n=o.ruleId)}return n},K=function(e,t,n){e.stopPropagation(),null===Vn.WebMsg||void 0===Vn.WebMsg||Vn.WebMsg.showConfirmModal({title:"确定删除".concat(t,"吗？"),type:"delete",onAction:function(e){if("ok"===e)!function(e){if("string"==typeof e&&S()(e).call(e,"new_rule_")){var t=U(e);c(t),p((function(t){return null==t?void 0:m()(t).call(t,(function(t){return t.ruleId!==e}))}))}else g("deleteFormRule",[e])}(n)}})},V=(0,w.useCallback)((function(e){p(e),e.length&&c(e[0].ruleId)}),[]),z=function(e){p((function(t){return null==t?void 0:x()(t).call(t,(function(t){return t.ruleId===l?$u($u({},t),e):t}))}))};(0,w.useEffect)((function(){var e=function(e){V(e),o()};return k.eventBus.on(or,e),function(){k.eventBus.off(or,e)}}),[]),(0,w.useEffect)((function(){var e=function(e){var t=U(e);c(t),p((function(t){return null==t?void 0:m()(t).call(t,(function(t){return t.ruleId!==e}))})),function(e){var t=h();y(null==t?void 0:m()(t).call(t,(function(t){return t.ruleId!==e}))),o()}(e)};return k.eventBus.on(ir,e),function(){k.eventBus.off(ir,e)}}),[p,l]),(0,w.useEffect)((function(){var e=function(e){z(e),c(e.ruleId),function(e){var t=h(),n=$u($u({},(null==d?void 0:Te()(d).call(d,(function(e){return e.ruleId===l})))||{}),e),r=null!=l&&S()(l).call(l,"new_rule_")?b()(t).call(t,n):x()(t).call(t,(function(e){return e.ruleId===l?n:e}));y(r),o()}(e)};return k.eventBus.on(ar,e),function(){k.eventBus.off(ar,e)}}),[p,l]),(0,w.useImperativeHandle)(t,(function(){return{getRules:function(){return null==d?void 0:x()(d).call(d,(function(e){var t="null"===e.depfldkeys?"":e.depfldkeys,n="null"===e.affectfldkeys?"":e.affectfldkeys;return $u($u({},e),{},{depfldkeys:t,affectfldkeys:n})}))}}}),[d]);var G=(0,w.useMemo)((function(){var e=(l?null==d?void 0:Te()(d).call(d,(function(e){return e.ruleId===l})):{})||{},t=e.ruleName,n=void 0===t?"":t,r=e.expression,o=void 0===r?[]:r,a=e.trueaction;return{name:n,preCondition:o,trueAction:void 0===a?[]:a}}),[l,d]);return d?F().createElement("div",{className:"".concat(n,"-main")},d.length?F().createElement(F().Fragment,null,F().createElement("div",{className:"left-area"},F().createElement("div",{className:"rule-list"},null==d?void 0:x()(d).call(d,(function(e){var t,n,r=e.ruleName,o=e.ruleId,a=e.depfldkeys,i=e.affectfldkeys;return m()(t=(0,M.c)(new(mn())(b()(n=[]).call(n,(0,M.c)(a.split(",")),(0,M.c)(i.split(",")))))).call(t,Boolean),F().createElement("div",{className:jn()("rule-item",{"is-active":l===o}),key:o,onClick:function(){return c(o)}},F().createElement("div",{className:"rule-name"},r,F().createElement(P.Icon,{prefix:"ncicon",type:"jingshi",className:jn()("warning-icon",{show:!1})})),F().createElement("div",{className:"tags"},S()(a).call(a,_)&&F().createElement("span",{className:"tag-item"},"触发"),S()(i).call(i,_)&&F().createElement("span",{className:"tag-item"},"受影响的")),F().createElement("div",{className:"delete-btn",onClick:function(e){return K(e,r,o)}},F().createElement(P.Icon,{prefix:"designericon",type:"shanchu"})))}))),F().createElement("div",{className:"add-rule",onClick:L},F().createElement("span",{className:"add-btn"},F().createElement(P.Icon,{prefix:"designericon",type:"zengjia-yuan"}),"新增规则"))),F().createElement("div",{className:"right-area"},F().createElement(Xu,{key:l,prefixCls:n,value:G,fieldKey:_,ruleId:l,listFilterConfig:O,fieldOptions:j,onChange:z}))):F().createElement(ts,{handleAdd:L})):null})),os=function(e){var t=e.prefixCls,n=e.title,r=e.visible,o=e.setVisible,a=e.field,i=e.refreshEditorDisplay,l=(0,w.useRef)(null),c=function(){o(!1)};return F().createElement(P.Modal,{mask:!0,visible:r,body:F().createElement(rs,{ref:l,prefixCls:t,field:a,refreshEditorDisplay:i}),titleIcon:null,className:"".concat(t,"-modal"),footer:null,maskClosable:!1,width:960,height:520,keyboard:!1,title:F().createElement("span",{title:n},n),closable:!0,draggable:!1,destroyOnClose:!0,onCancel:c,onOk:c})},as=function(e){var t=e.locked,n=e.field,r=n.Name,o=n.Key,a=(0,w.useState)(!1),i=(0,s.c)(a,2),l=i[0],c=i[1],u=(0,w.useContext)(ae),f=u.invokeAction,d=u.prefixCls,p=u.getKdesignerApi,v=u.getDisplayRules,m=u.fetchListTree,g=p().data.getRootId(),h=v(),y=(0,w.useReducer)((function(e){return e+1}),0),b=(0,s.c)(y,2)[1],C=function(){f("getFormRules",[{formId:g,fieldKey:o}]),m(),c(!0)},E=(0,w.useMemo)((function(){var e=h.reduce((function(e,t){var n=t.affectfldkeys,r=t.depfldkeys;return null!=n&&S()(n).call(n,o)||S()(r).call(r,o)?e+1:e}),0);return 0!==e?"".concat(e,"条规则"):""}),[h,o]),I="".concat(d,"-displayrules");return F().createElement(F().Fragment,null,F().createElement(k.CustomInputTrigger,(0,R.c)({},e,{placeholder:"请选择",disabled:t,value:E,onClick:C,onInputClick:C})),F().createElement(os,{prefixCls:I,visible:l,setVisible:c,field:n,title:"".concat(r,"-显示规则"),refreshEditorDisplay:b}))},is=function(e){var t=e.value,n=e.className,r=e.field,o=r._Type_,a=r.DefaultLines,i=r.MaxLength,l={className:"".concat(n,"-text-def-editor"),fieldType:"text",placeholder:"请输入",maxLength:i};return function(e){return"NoCodeTextAreaField"===e}(o)&&(l.fieldType="textarea",l.autoSize={minRows:a||1,maxRows:a||1}),F().createElement(_c,(0,R.c)({},e,{editorType:"textDef",value:t,inputFieldProps:l}))};function ls(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function cs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ls(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):ls(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var us={},ss=(0,w.memo)((function(e){var t,n,r=(0,w.useContext)(ae),o=r.invokeAction,a=r.getKdesignerApi,i=e.handleChange,l=e.value,c=e.className,u=e.editor,s=(e.locked,e.Name),f=e.Tips,d=e.field,p=(e.id,u.Enum,u.NameHidden),v=u.Default,m=u.Required,g=u.HasCheck,h=u.Title,y=a().data.getRootId(),b=l;try{g&&"object"===(0,be.c)(JSON.parse(l))&&(b=JSON.parse(l))}catch(e){g&&(b={})}var C=void 0===(null===(t=b)||void 0===t?void 0:t.enable)?null==v?void 0:v.enable:b.enable,E=(0,w.useCallback)((function(e){return Array.isArray(e)&&(null==e?void 0:x()(e).call(e,(function(e){return cs(cs({},e),{},{label:e.name,value:e.id})})))||[]}),[]),I=yc({id:d.Key,formId:y,eventName:"setTriggerProcess",parser:E});null!=I&&I.length&&(us[y]=I),(0,w.useEffect)((function(){us[y]||o("getTriggerProcess",[])}),[y]);var N=(0,w.useCallback)((function(e){if(g){var t=cs(cs({},b),{},{value:e});i(Ka()(t))}else i(e)}),[i,b,g]),T=(0,w.useMemo)((function(){return{name:s,className:c,nameHidden:p,tips:f,required:m,title:h}}),[s,c,p,f,m,h]),A=(0,w.useMemo)((function(){return cs(cs({},e),{},{editor:cs(cs({},e.Editor),{},{NameHidden:!0})})}),[e]);return F().createElement("div",{className:"".concat(c,"-trigger-process")},g?F().createElement(k.NameTipSwitchWrapper,(0,R.c)({switchValue:C,onSwitchChange:function(e){var t=cs(cs({},b),{},{enable:e});i(Ka()(t))}},T)):F().createElement(k.NameTipWrapper,T),(!g||C)&&F().createElement(k.EditorPropertySelect,(0,R.c)({},A,{value:g?null===(n=b)||void 0===n?void 0:n.value:l,options:Array.isArray(us[y])?us[y]:[],scrollHidden:!1,onChange:N,handleChange:N})))}));ss.displayName="TriggerProcessEditor";var fs=(0,k.ErrorBoundaryWrap)(ss,"TriggerProcessEditor");function ds(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ps(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ds(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):ds(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var vs=Vn.treeUtils.getListConfigPure,ms=Vn.treeUtils.treeNodeTransform,gs=Vn.treeUtils.dfs,hs=Vn.ListFilterUtil.getVarSelectDisabled,ys=(0,w.forwardRef)((function(e,t){var n,r,o=e.prefixCls,a=e.field,i=e.formId,l=e.value,c=e.onChange,u=(0,w.useContext)(ae),d=u.invokeAction,p=u.baseUrl,v=u.onDownLoad,g=(u.getBaseHooks,u.getKdesignerApi),h=u.getCompareTypes,y=u.getControlText,C=u.batchInvoke,E=u.curListTreeApi,I=u.getHideFieldRef,N=g(),T=N.data,A=N.meta,D=I(),M=a.Key,R=a._Type_,_=a.ParentId,O=null===(n=D[a.RefBillId])||void 0===n?void 0:n.Key,B=T.findControl(_),j=B.RefBillId,L=B._Type_,U=null===(r=D[j])||void 0===r?void 0:r.Key,K=(T.getRootId(),(0,w.useState)({})),V=(0,s.c)(K,2),z=V[0],G=V[1],H=(0,w.useRef)(null),q=(0,w.useRef)(null),Y=(0,w.useRef)([]),W=h();(0,w.useImperativeHandle)(t,(function(){return{updateVerifyAndGetMsg:function(){return q.current.updateVerifyAndGetMsg()}}}),[]);var Q=yc({id:M,formId:i,eventName:"filterItemLook"}),X=(0,w.useMemo)((function(){return Array.isArray(l)?x()(l).call(l,(function(e){return ps(ps({},e),{},{value:"string"==typeof e.value?JSON.parse(e.value):e.value||[]})})):[]}),[l]),Z=(0,w.useCallback)((function(e){d("getFilterItemLook",[e,{getEnumData:"true",enumField:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",filterrows:[]}])}),[d]),J=(0,w.useCallback)((function(e){Z(i,e.fieldName)}),[Z]),$=bc({api:E,parser:function(e){return $t(e,e,W)}}),ee=bc({api:E,parser:function(e){var t,n,r=$t(e,e,W,4),o=O||M,a=it(L)?Se()(t=b()(n="".concat(U,".")).call(n,M)).call(t,0,-4):o,i=gs(r,(function(e){return e.key===a}));return ms((null==i?void 0:i.children)||[],(function(e){var t=e.key,n=a.replace(/\./g,"\\."),r=t.replace(new RegExp("^"+n+"\\.(\\S+)"),"$1");return!((null!=r&&S()(r).call(r,"fbasedataid")?r.split(".fbasedataid")[0]:r).split(".").length>2)&&ps(ps({},e),{},{key:r})}))}}),te=(0,w.useMemo)((function(){return ct(R)?$:ee}),[R,$,ee]),ne=(0,w.useMemo)((function(){return ul({metaApi:A,options:$})}),[$]),re=(0,w.useMemo)((function(){return vs(te)}),[te]);(0,w.useEffect)((function(){var e=Q.data,t=Q.param,n=(void 0===t?{}:t).enumField;if(n){var r=null==X?void 0:m()(X).call(X,(function(e){return e.fieldName===n})),o=gs(te,(function(e){return e.key===n}));G((function(t){return ps(ps({},t),{},(0,f.c)({},n,{configuredFilter:{enumEqCompareType:"001",items:r},fieldFilterConfig:o,groupInfo:e}))}))}}),[Q,X,te]);var oe=(0,w.useCallback)((function(e){Y.current.length<e.length&&e.length>7&&setTimeout((function(){return H.current.scrollTo(0,1e4)}),100),Y.current=e}),[]),ie={baseUrl:p,batchInvoke:function(e,t){C(e,M,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])},getControlText:y,addControlAction:function(e,t){return k.eventBus.on(e,t),function(){k.eventBus.off(e,t)}},onDownLoad:v,batchInvokeListConfig:function(e){C("listconfig","nocodeformdesigner",[e])},batchInvokeQuery:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.select,u=void 0===c?"":c,s=t.page_size,f=void 0===s?10:s,d=t.page_no,p=void 0===d?1:d,v=t.ids;C("query","nocodeformdesigner",[e,{filter:r,search:a,order_by:l,select:u,page_size:f,page_no:p,ids:void 0===v?[]:v}])}};return F().createElement("div",{className:"".concat(o,"-modal-body"),ref:H},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(Vn.FilterEditor,{ref:q,valueRequired:!0,nameHidden:!0,id:"filter",name:"配置筛选条件",tips:"",style:{marginTop:"0px"},fieldData:{fieldType:"treeSelect",style:{width:"184px"}},filterFooterData:{listType:"tree",triggerText:"添加筛选条件",treeProps:{defaultExpandAll:!1}},variablesTree:ne||[],listFilterConfig:re||[],fieldRecords:z||[],value:X,refBillProps:ie,onChange:function(e){var t=e;Array.isArray(e)&&(t=x()(e).call(e,(function(e){return ps(ps({},e),{},{value:"object"===(0,be.c)(e.value)?Ka()(e.value):e.value||""})}))),c(t),oe(e)},onGetFieldRecords:J,getVarSelectDisabled:hs})))})),bs=function(e){var t=e.prefixCls,n=e.onCancel,r=e.onConfirm;return F().createElement("div",{className:"".concat(t,"-modal-footer")},F().createElement("div",{className:"".concat(t,"-modal-footer-right")},F().createElement(P.Button,{size:"small",className:"".concat(t,"-modal-footer-btn"),onClick:n},"取消"),F().createElement(P.Button,{size:"small",type:"primary",className:"".concat(t,"-modal-footer-btn"),onClick:r},"确定")))},Cs=(0,w.memo)((function(e){var t=e.prefixCls,n=e.title,r=e.value,o=e.formId,a=e.field,i=(e.fieldData,e.visible),l=e.setVisible,c=e.onChange,u=(0,w.useState)(r),f=(0,s.c)(u,2),d=f[0],p=f[1],v=(0,w.useRef)();(0,w.useEffect)((function(){p(r)}),[r]);var m=function(){l(!1),p(r)};return F().createElement(P.Modal,{mask:!0,visible:i,body:F().createElement(ys,{ref:v,prefixCls:t,field:a,formId:o,value:d,onChange:function(e){p(e)}}),titleIcon:null,className:"".concat(t,"-modal"),footer:F().createElement(bs,{prefixCls:t,onCancel:m,onConfirm:function(){var e,t,n=null===(e=(t=v.current).updateVerifyAndGetMsg)||void 0===e?void 0:e.call(t);null!=n&&n.length||(null==c||c(d),m())}}),maskClosable:!1,width:640,height:520,keyboard:!1,bodyStyle:{padding:0,overflow:"hidden"},title:n,closable:!0,draggable:!1,destroyOnClose:!0,onCancel:m,onOk:m})}));Cs.displayName="LimitSelectRangeModal";var Es=Cs;function Is(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function xs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Is(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Is(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Ns=(0,w.memo)((function(e){var t,n=e.handleChange,r=e.value,o=e.className,a=e.editor,i=e.locked,l=e.Name,c=e.Tips,u=e.field,f=a.NameHidden,d=a.Required,p=a.Default,v=a.Title,m=p.showEnable,g=u._Type_,h=(0,w.useState)(!1),y=(0,s.c)(h,2),b=y[0],C=y[1],E=void 0===r.enable?p.enable:r.enable,I=(0,w.useContext)(ae),x=I.prefixCls,N=I.getKdesignerApi,T=I.fetchListTree,A=N(),S=A.data,D=A.meta,P=(0,w.useMemo)((function(){return $e(g)||it(g)?u.BillEntityIdEx||D.getControlPropertyDefaultValue(u.FieldType,"BillEntityIdEx"):S.getRootId()}),[g,S,null==u?void 0:u.BillEntityIdEx]),M=(0,w.useCallback)((function(e){n({enable:E,value:e})}),[n,E]),_="".concat(x,"-enablefilter-editor"),O=xs(xs({},a),{},{NameHidden:!0}),B=(0,w.useMemo)((function(){return{name:l,className:o,nameHidden:f,tips:c,required:d,title:v}}),[l,o,f,c,d,v]);return F().createElement("div",{className:_},m?F().createElement(k.NameTipSwitchWrapper,(0,R.c)({switchValue:E,onSwitchChange:function(e){var t=xs(xs({},r),{},{enable:e});n(t)}},B)):F().createElement("div",{className:"".concat(o,"-nav")},F().createElement(k.NameTipWrapper,B)),E&&F().createElement(F().Fragment,null,F().createElement(k.CustomInputTrigger,(0,R.c)({},e,{editor:O,disabled:i,value:(null==r||null===(t=r.value)||void 0===t?void 0:t.length)>0?"".concat(r.value.length,"个条件"):"",onClick:function(){C(!0),T()}})),F().createElement(Es,{formId:P,field:u,prefixCls:_,visible:b,setVisible:C,value:(null==r?void 0:r.value)||[],title:l,onChange:M})))}));Ns.displayName="EnableFilterEditor";var Ts=(0,k.ErrorBoundaryWrap)(Ns,"EnableFilterEditor"),As=window.__kd_cdnPath__||window.__domainurl__,Ss=zt(window.__domainurl__+"nocode/v2/nocode_sys/image"),ws=(0,w.memo)((function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.editor,a=e.Name,i=e.Tips,l=e.field,c=o.NameHidden,u=o.Required,f=o.Title,d=l.FieldType,p=(0,w.useContext)(ae).baseUrl,v=void 0===p?{}:p,m=(0,w.useRef)(""),g=(0,w.useState)(!1),h=(0,s.c)(g,2),y=h[0],b=h[1],C="".concat(r,"-richtext-def-editor"),E=(0,w.useMemo)((function(){return st(d)}),[d]),I=E&&qt(n)?Yt(n):n,x=(0,w.useCallback)((function(e){m.current=e}),[]);(0,w.useEffect)((function(){m.current=I}),[I]);var N=function(){b(!1)},T=(0,w.useMemo)((function(){return F().createElement("div",null,F().createElement(Vn.RichText,{width:780,toobarMode:"scrolling",content:I,srcUrl:As,imageUrlPrefix:window.origin,imagesUploadUrl:Ss,pictureServer:v.picture,onChange:x,resize:!1,hasFullScreen:!1}))}),[I,v.picture,x]);return F().createElement("div",{className:C},F().createElement("div",{className:"".concat(C,"-name-tip")},F().createElement(k.NameTipWrapper,{nameHidden:c,className:r,name:a,tips:i,required:u,title:f})),F().createElement(Vn.BtnField,{className:"".concat(C,"-edit-btn"),type:"primary",text:"编辑默认值",onClick:function(){b(!0)}}),y&&F().createElement(P.Modal,{width:780,height:482,className:"".concat(C,"-modal"),visible:y,title:"".concat(E?"富文本":"图文展示","-默认值"),body:T,onCancel:N,footer:F().createElement("div",{className:"".concat(C,"-footer")},F().createElement(Vn.BtnField,{size:"small",style:{marginRight:"12px"},onClick:N},"取消"),F().createElement(Vn.BtnField,{size:"small",type:"primary",onClick:function(){var e=m.current,n=Ka()({value:e,valueType:0});e!==n&&t(E?n:e),b(!1)}},"确定"))}))}));function Fs(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ks(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fs(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Fs(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Ds=Vn.treeUtils.dfs,Ps=F().memo((function(e){e.handleChange;var t=e.value,n=e.className,r=e.editor,o=(e.locked,e.Name),a=e.Tips,i=e.field,l=e.id,c=e.propName,u=r.NameHidden,d=r.Required,p=r.Title,v=i||{},g=(v.DataFill,v.Name),h=v.SelectBillPid,y=v.RefTableId,b=v.RefBillId,C=v.ShowType,E=v.SourceForm,I=v.inner2Outer,N=v.Key,T=(0,w.useContext)(ae),A=T.invokeAction,S=T.getKdesignerApi,D=(T.prefixCls,T.billPropsData),R=T.dispatchBillData,_=S(),O=_.data,B=_.controlCacheApi,j="".concat(n,"-bill-type"),L=(0,w.useState)((0,M.c)((null==D?void 0:D.appFormList)||[])),U=(0,s.c)(L,2),K=U[0],V=U[1],z=(0,w.useRef)(null),G=(0,w.useRef)(null),H=(0,w.useRef)(B.hasCache("controlId",l)),q=(0,w.useState)(!0),Y=(0,s.c)(q,2),W=Y[0],Q=Y[1],X=(0,w.useCallback)((function(e){var t=e.children,n=void 0===t?[]:t;n[0].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"gerenzhongxin",style:{color:"#3987ED"}}),n[1].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zuzhi",style:{color:"#3987ED"}});var r=So(n),o=(0,s.c)(r,2),a=o[0],i=o[1];R({key:qr,payload:{data:a,innerForm:i}}),V(a)}),[]),Z=(0,w.useCallback)((function(){var e={showTree:"true",ignoreCosmicForm:"true"};Array.isArray(h)&&(e.parentId=h[h.length-1]),"2"===E&&A("click",[l,"entitymeta",c,e])}),[E]),J=(0,w.useCallback)((function(e){var t=e[i.Key]||[];0===t.length||"1"===E?Q(!0):(null==t?void 0:t.length)>0&&Q(!1)}),[]);(0,w.useEffect)((function(){return"1"!==E&&Z(),H.current&&"1"!==E&&Q(!1),H.current||k.eventBus.on(vr,J),k.eventBus.on(ur,X),k.eventBus.on(sr,$),function(){H.current||k.eventBus.off(vr,J),k.eventBus.off(ur,X),k.eventBus.off(sr,$)}}),[]),(0,w.useEffect)((function(){var e,n=t&&(null===(e=Ds(K,(function(e){return e.key===t})))||void 0===e?void 0:e.title)||"关联表单";k.eventBus.emit("".concat(N,"_refbill"),{formName:n})}),[t,K]);var $=function(e){var t;V((function(t){return ee(t,G.current,So(e,{isAsyncNode:!0})[0])})),null===(t=z.current)||void 0===t||t.call(z),z.current=null},ee=function e(t,n,r){return x()(t).call(t,(function(t){return t.key===n?null!=r&&r.length?ks(ks({},t),{},{children:r,isLeaf:!0}):ks(ks({},t),{},{isLeaf:!0}):t.children?ks(ks({},t),{},{children:e(t.children,n,r)}):t}))},te=(0,w.useCallback)((function(e,t){var n=ks((0,f.c)((0,f.c)({},c,e),"PropsDisplay",""),t),r=[[l,n]];if("2"===C){var o,a=m()(o=O.getAllSubControlIds(l)).call(o,(function(e){return e!==l}));O.deleteControl((0,k.createDeleteAction)(a))}O.batchUpdateControlPropertyValues((0,k.createUpdateAction)(r))}),[c,y,b,l,C]),ne=(0,w.useCallback)((function(){var e=[[l,{inner2Outer:!0}]];O.batchUpdateControlPropertyValues((0,k.createUpdateAction)(e))}),[l,t,g]);return(0,w.useEffect)((function(){I&&V([{key:t,title:g,isLeaf:!0}])}),[g,I]),(0,w.useEffect)((function(){"1"===E&&V([{key:t||"",title:I?g:"内部表单",isLeaf:!0}])}),[]),F().createElement("div",{className:j},F().createElement(k.NameTipWrapper,{nameHidden:u,className:n,name:o,tips:a,required:d,title:p}),"1"===E&&!I&&F().createElement("div",{className:"".concat(j,"-title-btn")},F().createElement(Vn.BtnField,{type:"text",major:!0,onClick:ne},"转化为外部表单")),F().createElement("div",{className:"".concat(j,"-tree-select")},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(Vn.KDTreeSelect,{allowClear:!0,value:t,treeData:K,showTreeIcon:!0,disabled:W,treeIcon:function(e){return e.icon},onChange:function(e,n){if(e!==t){var r,o={};if((t?null===(r=Ds(K,(function(e){return e.key===t})))||void 0===r?void 0:r.title:"关联表单")===g)if(e){var a=n[0]||{},i=a.title,l=void 0===i?"":i,c=a.parentKeys,u=a.isAsyncNode;o.Name=l,o.SelectBillPid=u?c:void 0}else e||(o.Name="关联表单",o.SelectBillPid=void 0);else{var s=n[0]||{},f=s.title,d=s.parentKeys,p=s.isAsyncNode;o.Name=f,o.SelectBillPid=p?d:void 0}te(e,o)}},treeLoadData:function(e){var t=e.key,n=e.children,r=e.isLeaf;return new(jr())((function(e){n||r?e():(z.current=e,G.current=t,A("queryTreeNodeChildren",[t]))}))},treeDefaultExpandedKeys:h,dropdownStyle:{width:"320px"}}))))})),Ms=[{label:"大 (24px)",value:"24"},{label:"中 (16px)",value:"16"},{label:"小 (8px)",value:"8"},{label:"无 (0px)",value:"0"}],Rs=function(e){var t=e.handleChange,n=e.value,r=e.className,o=e.editor,a=e.locked,i=e.Name,l=e.Tips,c=(e.field,e.id,e.propName,Qt(n)),u=c.margin,f=void 0===u?"0":u,d=c.marginTop,p=c.marginRight,v=c.marginBottom,m=c.marginLeft,g=(0,w.useState)(f),h=(0,s.c)(g,2),y=h[0],b=h[1],C=(0,w.useState)(d||0),E=(0,s.c)(C,2),I=E[0],x=E[1],N=(0,w.useState)(p||0),T=(0,s.c)(N,2),A=T[0],S=T[1],D=(0,w.useState)(v||0),P=(0,s.c)(D,2),M=P[0],R=P[1],_=(0,w.useState)(m||0),O=(0,s.c)(_,2),B=O[0],j=O[1],L="".concat(r,"-margin");(0,w.useEffect)((function(){var e=-1===y?{marginTop:I,marginRight:A,marginBottom:M,marginLeft:B}:{margin:y};t(Ka()(e))}),[y,I,A,M,B]);var U=(0,w.useCallback)((function(e){b(e)}),[]),K=(0,w.useCallback)((function(e){x(e)}),[]),V=(0,w.useCallback)((function(e){S(e)}),[]),z=(0,w.useCallback)((function(e){R(e)}),[]),G=(0,w.useCallback)((function(e){j(e)}),[]);return F().createElement("div",{className:L},F().createElement("div",{className:jn()("".concat(L,"-item"),"".concat(L,"-select"))},F().createElement(k.EditorPropertySelect,{options:Ms,editor:o,value:y,handleChange:U,className:L,Name:i,locked:a,tips:l})),"-1"===y&&F().createElement(F().Fragment,null,F().createElement("div",{className:"".concat(L,"-item")},F().createElement(k.NameTipWrapper,{className:r,name:"上间距"}),F().createElement(Vn.Number,{value:I,onChange:K,showStepper:!1,placeholder:"请输入"})),F().createElement("div",{className:"".concat(L,"-item")},F().createElement(k.NameTipWrapper,{className:r,name:"下间距"}),F().createElement(Vn.Number,{value:M,onChange:z,showStepper:!1,placeholder:"请输入"})),F().createElement("div",{className:"".concat(L,"-item")},F().createElement(k.NameTipWrapper,{className:r,name:"左间距"}),F().createElement(Vn.Number,{value:B,onChange:G,showStepper:!1,placeholder:"请输入"})),F().createElement("div",{className:"".concat(L,"-item")},F().createElement(k.NameTipWrapper,{className:r,name:"右间距"}),F().createElement(Vn.Number,{value:A,onChange:V,showStepper:!1,placeholder:"请输入"}))))};function _s(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Os(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Bs=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?x()(t).call(t,(function(t){var r=t.label,o=t.value,a=t.children,i=t.selectable,l=t.icon,c=Os({key:o,title:r},n);return(0,we.isUndefined)(i)||(c.selectable=i),l&&(c.icon=l),a?(a.length&&(c.children=e(a)),c.checkable=!1):c.isLeaf=!0,c})):t},js=F().memo((function(e){e.handleChange;var t=e.value,n=e.className,r=e.editor,o=(e.locked,e.Name),a=e.Tips,i=e.field,l=e.id,c=e.propName,u=r.NameHidden,d=r.Required,p=r.needPathValue,v=r.Title,m=(i.DataFill,i.Name,i.SelectBillPid),g=(0,w.useContext)(ae),h=g.invokeAction,y=g.getKdesignerApi,b=g.prefixCls,C=g.getDataRef,E=y().data,I="".concat(b,"-bill-type"),N=(0,w.useState)([]),T=(0,s.c)(N,2),A=T[0],S=T[1],D=(0,w.useRef)(null),M=(0,w.useRef)(null),R=(0,w.useCallback)((function(e){var t=null;t=Array.isArray(e)?e:[e],S(Bs(t))}),[p]),_=(0,w.useCallback)((function(){var e={showTree:"true"},t={nocodeformdesigner:C()};Array.isArray(m)&&(e.parentId=m[m.length-1]),h("click",[l,"entitymeta",c,e],[t])}),[]);(0,w.useEffect)((function(){_()}),[]),(0,w.useEffect)((function(){return k.eventBus.on(fr,R),k.eventBus.on(sr,O),function(){k.eventBus.off(fr,R),k.eventBus.off(sr,O)}}),[]);var O=function(e){var t;S((function(t){return B(t,M.current,Bs(e,{isAsyncNode:!0}))})),null===(t=D.current)||void 0===t||t.call(D),D.current=null},B=function e(t,n,r){return x()(t).call(t,(function(t){return t.key===n?null!=r&&r.length?Os(Os({},t),{},{children:r,isLeaf:!0}):Os(Os({},t),{},{isLeaf:!0}):t.children?Os(Os({},t),{},{children:e(t.children,n,r)}):t}))};return F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:u,className:n,name:o,tips:a,required:d,title:v}),F().createElement("div",{className:"".concat(I,"-tree-select")},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(Vn.KDTreeSelect,{allowClear:!0,value:t,treeData:A,showTreeIcon:!0,treeIcon:function(e){return e.icon},onChange:function(e,n){e!==t&&E.batchUpdateControlPropertyValues((0,k.createUpdateAction)([[l,(0,f.c)({},c,e)]]))},treeLoadData:function(e){var t=e.key,n=e.children,r=e.isLeaf;return new(jr())((function(e){n||r?e():(D.current=e,M.current=t,h("queryTreeNodeChildren",[t]))}))},treeDefaultExpandedKeys:m}))))}));js.displayName="InputFormEditor";var Ls=js;function Us(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ks(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Us(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Vs=function(e){var t=e.value,n=(e.className,e.handleChange),r=e.field,o=(e.rootId,(0,w.useContext)(ae)),a=o.baseUrl,i=o.onDownLoad,l=o.prefixCls,c=o.getControlText,u=o.batchInvoke,s=o.getBaseHooks,f=o.getKdesignerApi,d=r.SelectScope,p=d?{rawFilter:d.value}:{},v=f().meta,g=s("useKDRefBill"),h=r.BillEntityIdEx||v.getControlPropertyDefaultValue(r.FieldType,"BillEntityIdEx"),y=function(e,t){try{if(e&&"string"==typeof e){var n=JSON.parse(e);return n.valueType===t?n.value:""}}catch(e){}}(t,0),b=function(e,t){var n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.page_size,s=void 0===c?10:c,f=t.page_no,d=void 0===f?1:f,v=t.ids;e&&u("query","nocodeformdesigner",[e,Ks({filter:r,search:a,order_by:l,select:"",page_size:s,page_no:d,ids:void 0===v?[]:v},p)])},C=1===parseInt(r.Multi),E={controlMeta:Zt(r,v),onChange:function(e){var t;"string"==typeof e?t=e:Array.isArray(e)&&(t=e.join(",")),n(Ka()({valueType:0,value:t}))},baseUrl:a,batchInvoke:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];u(e,r.Key,t,n)},getControlText:c,addControlAction:function(e,t){k.eventBus.on(e,t)},onDownLoad:i,batchInvokeListConfig:function(){h&&u("listconfig","nocodeformdesigner",[h])},batchInvokeQuery:b,value:y},I=g(E,!0),x=I.searchKeywords;(0,w.useEffect)((function(){b(h,{page_size:10,page_no:1,search:x,select:r.PropsDisplay,ids:y?y.split(","):[]})}),[t,r.PropsDisplay,h]);var N=Ks(Ks({className:"".concat(l,"-refbill-def-editor-input"),fieldType:"refbill"},I),{},{value:C?y?y.split(","):[]:y||"",placeholder:"请选择",showSelected:!1});return F().createElement(_c,(0,R.c)({},e,{editorType:"refBillDef",inputFieldProps:N}))},zs=function(e){var t,n=e.handleChange,r=e.value,o=e.className,a=e.editor,i=e.Name,l=e.Tips,c=e.renderItem,u=e.field,f=e.id,d=a.Enum,p=a.NameHidden,v=a.Default,m=a.Required,g=a.Title,h=(0,(0,w.useContext)(ae).getKdesignerApi)().controlCacheApi,y=x()(d).call(d,(function(e){return(0,R.c)({},e,{Value:e.Value||e.Id})})),b=(0,we.isUndefined)(r)?v||(null===(t=y[0])||void 0===t?void 0:t.Value):String(r),C=h.hasCache("controlId",f),E=(0,w.useState)(!("Multi"!==e.Id||C)),I=(0,s.c)(E,2),N=I[0],T=I[1],A=(0,w.useCallback)((function(e){var t=e[u.Key]||[];0!==t.length?(null==t?void 0:t.length)>0&&T(!1):T(!0)}),[]);(0,w.useEffect)((function(){if("Multi"===e.Id&&!C)return k.eventBus.on(vr,A),function(){k.eventBus.off(vr,A)}}),[]);return F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:p,className:o,name:i,tips:l,required:m,title:g}),F().createElement("div",{className:"".concat(o,"-tab-editor")},x()(y).call(y,(function(e){var t=e.IconClassName,r=e.IconTitle;return F().createElement("div",{key:e.Value,disabled:N,className:jn()(["".concat(o,"-tab-editor-item"),{"is-active":b===e.Value,"is-disabled":!0===N}]),onClick:function(){return t=e.Value,void(N||n(t));var t},title:t&&r},c?c(e):t?F().createElement("i",{className:t}):e.Name)}))))},Gs=n(6076),Hs=n.n(Gs),qs=["compareTypes","compareType","compareTypeCaption","fieldName","fieldCaption","items","value"];function Ys(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ws(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Ys(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Qs=Vn.Condition.constants,Xs=Qs.allFieldRegExp,Zs=Qs.allExpRegExp,Js=Vn.treeUtils.exludeTreeNodeByCallback,$s=Vn.treeUtils.transformTreeToListConfig,ef=function(e){try{return decodeURIComponent(e)}catch(t){return e}},tf=function(e){return null==e?void 0:x()(e).call(e,(function(e){return Ws(Ws({},e),{},{value:ef(e.value)})}))},nf=[{id:"edit",name:{zh_CN:"编辑"}},{id:"mustinput",name:{zh_CN:"必填"}},{id:"readonly",name:{zh_CN:"只读"}},{id:"disabled",name:{zh_CN:"禁用"}}],rf=function e(t,n,r,o){return t.reduce((function(t,a){var i,l=a._Type_,c=a.Key,u=a.Name,s=a.FormatType,f=a.SelectItemType,d=a.Multi,p=a.children;if(tt(l)||it(l)||st(l)||ft(l))return t;var v=$e(l)||it(l)?"NoCodeMulRefBillField":l,g=null==v?void 0:v.toLowerCase();if(Ze(l)){var h=[{title:"".concat(u,".开始"),titlePrefix:"[日期]",key:"".concat(c,"_startdate"),formatType:s,type:"nocodedatefield",compareTypes:nf,checkable:!0,selectable:!1},{title:"".concat(u,".结束"),titlePrefix:"[日期]",key:"".concat(c,"_enddate"),formatType:s,type:"nocodedatefield",compareTypes:nf,checkable:!0,selectable:!1}];return b()(t).call(t,h)}var y={};if($e(l)||et(l)||it(l))y=Zt(a,r);else if(rt(l)){var C,E=r.getControlMetaEditor(l,"ImageFileType").Enum,I=r.getControlPropertyDefaultValue(l,"FileMaxSize"),N=r.getControlPropertyDefaultValue(l,"ImageFileType"),T=(null==a?void 0:a.ImageFileType)||N,A=x()(C=T.split(",")).call(C,(function(e){return m()(E).call(E,(function(t){return t.Id===e}))[0].Name}));y={UploadNum:(null==a?void 0:a.UploadNum)||{max:9,min:0},FileMaxSize:a.FileMaxSize||I,typeArr:A}}else if(ot(l)){var S=r.getControlPropertyDefaultValue(l,"AttachmentFileType"),w=r.getControlPropertyDefaultValue(l,"FileMaxSize"),F=(null==a?void 0:a.AttachmentFileType)||S;y={UploadNum:(null==a?void 0:a.UploadNum)||{max:9,min:0},maxSize:a.FileMaxSize||w,fileType:F}}var k=a.CustomContent?null===(i=a.CustomContent.ops)||void 0===i?void 0:x()(i).call(i,(function(e){return{name:{zh_CN:e.Label},value:e.Value,bgc:e.Bgc}})):void 0,D=Ws({title:u,titlePrefix:rn(a,n,r,o),key:c,type:g,isMulti:1===f||1===d,items:k,formatType:s,compareTypes:nf,checkable:!0,selectable:!1},y);return Ut(l)&&p&&(p&&(D.children=e(p,n,r,o)),D.checkable=!1),b()(t).call(t,D)}),[])},of=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(t||[]).reduce((function(t,o){var a,i=o.caption,l=o.type,c=o.id,u=o.option,s=void 0===u?{}:u,f=o.typeCaption,d=s.sourceForm,p=(null==c||null===(a=c.split("."))||void 0===a?void 0:a.length)||0;if("group"!==l&&p>r)return t;if(tt(l)||it(l)||void 0!==d||st(l)||ft(l))return t;var v=null==l?void 0:l.toLowerCase();"nocodedaterangefield"===v?v="nocodedatefield":($e(l)||et(l)||it(l))&&(v="nocodemulrefbillfield");var g,h=s.children,y=s.valueItems,C=s.billEntityId,E=s.displayProp,I=s.isMulti,N=s.formatType,T={title:i,titlePrefix:f,key:c,compareTypes:nf,type:v,formatType:N,selectable:!1,checkable:!0};if($e(l)||et(l)||it(l)){if(!C)return t;T=(0,R.c)(T,{displayProp:E,entityId:C,isMulti:I})}else if(ut(l))T=(0,R.c)(T,{isMulti:I});else if(rt(l)){var A,S=s.ImageFileType,w=s.FileMaxSize,F=s.UploadNum,k=n.getControlMetaEditor(l,"ImageFileType").Enum,D=n.getControlPropertyDefaultValue(l,"FileMaxSize"),P=n.getControlPropertyDefaultValue(l,"ImageFileType"),M=n.getControlPropertyDefaultValue(l,"UploadNum"),_=S||P,O=x()(A=_.split(",")).call(A,(function(e){return m()(k).call(k,(function(t){return t.Id===e}))[0].Name}));T=(0,R.c)(T,{UploadNum:F||M,FileMaxSize:w||D,typeArr:O})}else if(ot(l)){var B=s.AttachmentFileType,j=s.FileMaxSize,L=s.UploadNum,U=n.getControlPropertyDefaultValue(l,"AttachmentFileType"),K=n.getControlPropertyDefaultValue(l,"FileMaxSize"),V=B||U,z=n.getControlPropertyDefaultValue(l,"UploadNum");T=(0,R.c)(T,{UploadNum:L||z,maxSize:j||K,fileType:V})}if((y&&(T.items=y),h&&(T.children=e(h,n,r)),"group"===l)&&(T.checkable=!1,null===(g=T)||void 0===g||null===(g=g.children)||void 0===g||!g.length))return t;return b()(t).call(t,T)}),[])},af=(0,w.memo)((function(e){var t=e.item,n=e.index,r=e.filterOptions,o=e.fieldTree,a=e.prefixCls,i=e.handleCompareTypeChange,l=e.refBillProps,c=e.fieldRecords,u=e.handleValChange,f=e.handleVarSelect,d=e.handleDelete,v=e.verifyData,g=e.formId,h=t.compareTypes,y=t.compareType,C=(t.compareTypeCaption,t.fieldName),E=(t.fieldCaption,t.items),I=t.value,x=(0,ye.c)(t,qs),N=Vn.ListFilterUtil.getCompareTypeOptions,A=Vn.ListFilterUtil.getVarSelectedKeysInfo,k=Vn.ListFilterUtil.getValueTypeByType,D=Vn.ListFilterUtil.getNewValue,M=Vn.ListFilterUtil.transform2Options,R=Vn.ListFilterUtil.VALUE_EMPTY_COMPARE_TYPE,_=(0,w.useContext)(ae),O=_.getBaseHooks,B=_.invokeAction,j=_.getKdesignerApi,L=_.getExpressionData,U=_.getRefBillData,K=_.getCompareTypes,V=_.batchInvoke,z=_.baseUrl,G=j().data,H=O("useKDRefBill"),q=(0,w.useState)(!1),Y=(0,s.c)(q,2),W=Y[0],Q=Y[1],X=x||{},Z=X.entityId,J=X.formatType,$=X.type,ee=X.displayProp,te=k(x),ne="refbill"===te?l?te:"text":"select"===te&&!0===t.isMulti?"multiSelect":te,re=D(ne,I,null==c?void 0:c[C]),oe=(0,w.useState)(!1),ie=(0,s.c)(oe,2),le=ie[0],ce=ie[1],ue=(0,w.useState)(!1),se=(0,s.c)(ue,2),fe=se[0],de=se[1],pe=(0,w.useState)(!1),ve=(0,s.c)(pe,2),me=ve[0],ge=ve[1],he=K(),Ce=G.getRootId(),Ee={name:"field",value:C,options:r,fieldType:"treeSelect",disabled:!0,borderType:"bordered",className:"".concat(a,"-modal-body-fielddata")},Ie={name:"compareType",value:y,options:N(h)||[],className:"".concat(a,"-modal-body-infoType"),fieldType:"select",onChange:function(e){return i(e,n,ne)},borderType:"bordered"},xe=A(I),Ne=(0,w.useMemo)((function(){return L()}),[L]),Te={valueType:0,fieldValue:""};(0,w.useEffect)((function(){!function(e,t){var n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.select,u=void 0===c?"":c,s=t.page_size,f=void 0===s?10:s,d=t.page_no,p=void 0===d?1:d,v=t.ids;"refbill"===te&&e&&V("query","nocodeformdesigner",[e,{filter:r,search:a,order_by:l,select:u,page_size:f,page_no:p,ids:void 0===v?[]:v}])}(Z,{page_size:10,page_no:1,search:"",select:ee,ids:re||[]})}),[I,Z]);var Ae,Se,we=[{label:"查找表单记录",key:"search",id:1,icon:"chazhaobiaodanjilu-xian"}],Fe={valueType:2,value:{relationFormId:"",filterInfos:[],sortInfos:[],result:[]}},ke=(Ae={nocodetextfield:[0,1,2],nocodetextareafield:[0,1,2],nocodedecimalfield:[0,1,2],nocoderichtextfield:[0,1],nocodegeofield:[0,1],nocodeaddressfield:[0,1],nocodeselectitemfield:[0,1,2],nocodemulrefbillfield:[0,1],nocodedaterangefield:[0,1],nocodedatefield:[0,1,2],nocodeimageuploadfield:[0,1],nocodeattachmentuploadfield:[0,1],nocodegroupcontainerfield:[],nocodeentryentityfield:[],nocodegraphicdisplayfield:[0,1],nocodebillnofield:[0,1,2]}[$],null==we?void 0:m()(we).call(we,(function(e){return null==Ae?void 0:S()(Ae).call(Ae,e.id)}))),De=H(Ws(Ws({},l),{},{batchInvokeListConfig:function(){return l.batchInvokeListConfig(Z)},controlMeta:x,onChange:function(e){return u(Array.isArray(e)?e:""===e?[]:null==e?void 0:e.split(","),n,ne)}}),!0),Pe="refbill"===ne?Ws(Ws({className:"".concat(a,"-modal-body-refbill")},De),{},{value:1===x.multi?re:re[0]}):"picture"===ne?{UploadNum:t.UploadNum,FileMaxSize:t.FileMaxSize,typeArr:t.typeArr}:"attachment"===ne?{UploadNum:t.UploadNum,maxSize:t.maxSize,fileType:t.fileType}:{},Me=function(e){try{if(qt(e)){var t=JSON.parse(e);return(null==t?void 0:t.valueType)||0}var n;if(e&&"object"===(0,be.c)(e))return(null===(n=e[0])||void 0===n?void 0:n.valueType)||0}catch(e){}}(I),Re=function(e,t){try{if(qt(e)){var n=JSON.parse(e);return(null==n?void 0:n.valueType)===t?n.value:""}var r,o;if(e&&"object"===(0,be.c)(e))return 2===t?null===(o=e[0])||void 0===o?void 0:o.fieldValue:(null===(r=e[0])||void 0===r?void 0:r.valueType)===t?e[0].fieldValue:""}catch(e){}},_e=function(e){var t=e?e.split("@@"):["","",null],n=(0,s.c)(t,3);return[n[1],n[2]]}(Re(I,1)),Oe=function(e){e.stopPropagation(),f(t.fieldName,Te,ne),ge(!1)},Be=(Se=Ne.functionOperations,T()(Se)),je={fieldType:"formula",onClick:function(){return ze("formula")},value:_e[0],expressionData:Ne.functionTypes,fieldData:o,onClear:Oe,lang:Number(_e[1]||1),readOnly:!0,autofocus:!1},Le={fieldType:"findForm",borderType:"bordered",value:Re(I,2),onChange:function(e){var n;n="string"==typeof e?e:Array.isArray(e)?e.join(","):null!=e&&e.target?e.target.value:e,f(t.fieldName,{valueType:0,fieldValue:n},ne)},placeholder:"请输入",onClear:Oe,onClick:function(){return ze("search")}},Ue={1:je,2:Le}[Me],Ke=function(){ce(!0)},Ve=function(){de(!0)},ze=(0,w.useCallback)((function(e){var t,n={search:Ve,formula:Ke};null===(t=n[e])||void 0===t||t.call(n)}),[Ve,Ke]),Ge=function(e,t){var n,r=(null===(n=He(e,t))||void 0===n?void 0:n.label)||"";return r=r?"查找：".concat(r):""},He=function e(t,n){var r;return t.children.forEach((function(t){if(t.value===n&&(r=t),t.children){var o=e(t,n);o&&(r=o)}})),r},qe=(0,w.useMemo)((function(){var e;return 2===Me&&(null===(e=I[0])||void 0===e||null===(e=e.rule)||void 0===e?void 0:e.value)||Fe.value}),[I]),Ye={invokeGetListConfig:function(e){e!==Ce&&B("listtreeconfig",[e])},invokeGetFieldRecords:function(e){B("getFilterItemLook",[e,{getEnumData:"true",enumField:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",filterrows:[]}])},invokeSaveBizRule:function(e){}},We=(0,w.useMemo)((function(){var e=U();return e.children[0].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"gerenzhongxin",style:{color:"#3987ED"}}),e.children[1].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zuzhi",style:{color:"#3987ED"}}),e}),[U]),Qe=Ws(Ws({name:"value",options:M(tf(E)),className:"".concat(a,"-modal-body-infoValue"),fieldType:ne,borderType:"bordered",placeholder:S()(R).call(R,y)?"":void 0,colHeadFilter:null==c?void 0:c[C],formatType:J,baseUrl:z,isMulti:t.isMulti,varSelectProps:Ws({showSearch:!0,defaultExpandAll:!0,className:"".concat(a,"-modal-body-var"),visible:W,disabled:"none"===te||"001"===y,value:T()(xe).join(),popperClassName:"".concat(a,"-def-editor-var-select-panel"),type:"dropdownSelect",selectedKeys:p()(xe),data:ke,varSelectActive:me,onVarSelectActive:ge,onVisibleChange:Q,onSelect:function(e){return ze(e[0])}},Ue)},Pe),{},{onChange:function(e){return u(e,n,ne)},allowClear:"number"!==ne,value:t.isMulti?re:"refbill"===ne?Pe.value:re});return F().createElement(F().Fragment,{key:C+y+n},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(Vn.ConditionFilterItem,{onDelete:function(){return d(n)},data:[Ee,Ie,Qe],customInput:[{type:"notInput",render:function(e){var t=e.value,n=e.className;return F().createElement("span",{className:n},t)}}],valueRequired:!0,className:"".concat(a,"-item"),verifyData:v}),le&&F().createElement(Vn.Condition,{value:_e[0],language:Number(_e[1]||1),modalTitle:"编辑运算公式",editorTitle:t.name,visible:le,editorPlaceholder:"请编辑运算公式",fieldData:o,fieldTitle:"表单内容",expressionData:Ne.functionTypes,operations:Be,onClose:function(){ce(!1),ge(0!==Me&&!(null==Ue||!Ue.value))},onConfirm:function(e,n){e=function(e,t){var n,r;if(!e)return"";var o=(e=e.replace(/）/g,")").replace(/（/g,"(").replace(/“/g,'"').replace(/”/g,'"').replace(/‘/g,"'").replace(/’/g,"'")).replace(Xs,"$1").replace(Zs,"$1");return b()(n=b()(r="".concat(o,"@@")).call(r,e,"@@")).call(n,t?1:0)}(e,n),ce(!1),f(t.fieldName,e?{valueType:1,fieldValue:e}:Te,ne)}})),fe&&F().createElement(Tc,{visible:fe,onClose:function(){de(!1),ge(0!==Me&&!(null==Ue||!Ue.value))},invokeActions:Ye,queryFormValue:qe||Fe.value,refBillData:We,field:t,compareTypesMap:he,formId:g,onConfirm:function(e){de(!1);var n=Ge(We,e.value.relationFormId);f(t.fieldName,e?{valueType:e.valueType,fieldValue:n,rule:e}:Te,ne)}}))}));af.displayName="ChildrenItem";var lf=(0,w.forwardRef)((function(e,t){var n=e.prefixCls,r=e.fieldKey,o=e.formId,a=e.inputFormId,i=e.value,l=e.onChange,c=e.onConfirm,u=(0,w.useContext)(ae),f=u.baseUrl,d=u.onDownLoad,p=u.getControlText,v=u.batchInvoke,g=u.getCompareTypes,y=u.getKdesignerApi,C=u.curFormulaTreeApi,E=u.getRefBillNameMap,I=(0,w.useRef)(null),N=(0,w.useRef)(null),T=(0,w.useRef)([]),A=y(),S=A.data,D=A.meta,R=g(),_=S.getRootId();(0,w.useImperativeHandle)(t,(function(){return{updateVerifyAndGetMsg:function(){return N.current.updateVerifyAndGetMsg()}}}),[]);var O=yc({id:r,formId:o,eventName:"filterItemLook"}),B=(0,w.useMemo)((function(){if(Array.isArray(i)){var e=[];return i.forEach((function(t){e.push(Ws(Ws({},t),{},{value:"string"==typeof t.value?JSON.parse(t.value):t.value||[]}))})),e}return[]}),[i]),j=bc({api:C,parser:function(e){return $t(e,e,R)}}),L=yc({id:r,formId:a,eventName:"setListTreeConfig",parser:function(e){var t=e.data;return of(t,D)},defaultValue:[]}),U=(0,w.useMemo)((function(){return on(j)}),[j]),K=(0,w.useMemo)((function(){var e,t,n=x()(e=S.getData().Items||[]).call(e,(function(e){var t=e._Type_;return Ws(Ws({},D.getDefaultData(t)),e)})),r=Js((null===(t=dl(n)[0])||void 0===t?void 0:t.children)||[],(function(e){var t=e._Type_,n=e.BillEntityIdEx,r=e.showType;return it(t)?"1"!==r:!(ct(t)||nt(t)||("NoCodeMulRefBillField"===t||"NoCodeRefBillField"===t)&&void 0===n)}));return rf(r,U,D,E())}),[U,E]),V=(0,w.useMemo)((function(){return a?a!==_?L:K:[]}),[K,L,a,_]),z=(0,w.useMemo)((function(){return $s(V)}),[V]),G=(0,w.useMemo)((function(){return x()(B).call(B,(function(e){return e.fieldName}))}),[B]),H=(0,w.useMemo)((function(){return cl({options:j})}),[j]),q=(0,w.useCallback)((function(e){T.current.length<e.length&&e.length>7&&setTimeout((function(){return I.current.scrollTo(0,1e4)}),100),T.current=e}),[]),Y=function(e){var t=e;if(Array.isArray(e)){var n=[];e.forEach((function(e){n.push(Ws(Ws({},e),{},{value:"object"===(0,be.c)(e.value)?Ka()(e.value):e.value||""}))})),t=n}l(t),q(e)},W={baseUrl:f,batchInvoke:function(e,t){v(e,r,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])},getControlText:p,addControlAction:function(e,t){k.eventBus.on(e,t)},onDownLoad:d,batchInvokeListConfig:function(e){v("listconfig","nocodeformdesigner",[e])},batchInvokeQuery:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.select,u=void 0===c?"":c,s=t.page_size,f=void 0===s?10:s,d=t.page_no,p=void 0===d?1:d,g=t.ids;v("query","nocodeformdesigner",[e,{filter:r,search:a,order_by:l,select:u,page_size:f,page_no:p,ids:void 0===g?[]:g}])}},Q=Vn.ListFilterUtil.filterDataTransform,X=Vn.ListFilterUtil.filterNoValue,Z=Vn.ListFilterUtil.getNewDefaultFilterDataExcept,J=(Vn.ListFilterUtil.getFilterOptions,Vn.ListFilterUtil.createNewValue),$=(0,w.useState)([]),ee=(0,s.c)($,2),te=ee[0],ne=ee[1],re=(0,w.useMemo)((function(){return ne([]),Q(B,z)||[]}),[B,z]);(0,w.useImperativeHandle)(t,(function(){return{updateVerifyAndGetMsg:function(){var e=X(re);return ne(e),m()(e).call(e,(function(e){return!e.verifyStatus}))}}}),[re]);var oe=(0,w.useCallback)((function(e){return Ws(Ws({},e),{},{value:e.value||[]})}),[]),ie=(0,w.useCallback)((function(){(null==B?void 0:B.length)>0&&Y([])}),[B,Y]),le=(0,w.useCallback)((function(e,t,n){var r=[],o=Te()(B).call(B,(function(e,n){return t===n})).fieldName,a=-1;if(null!=o&&Hs()(o).call(o,"_startdate")||null!=o&&Hs()(o).call(o,"_enddate")){var i=o.replace(/^(\S+)(_startdate|_enddate)/g,"$1");a=Ur()(B).call(B,(function(e,n){var r;return(null===(r=e.fieldName)||void 0===r?void 0:h()(r).call(r,i))&&t!==n}))}B.forEach((function(o,i){t===i||a===i?r.push(oe({fieldName:o.fieldName,compareType:e,value:o.value,fieldType:n})):r.push(oe({fieldName:o.fieldName,compareType:o.compareType,value:o.value,fieldType:n}))})),Y(r)}),[B,Y]),ue=function(e){var t=(0,M.c)(B);ce()(t).call(t,e,1),Y(t)},se=function(e,t,n,r){var o=[];B.forEach((function(n,a){if(n.fieldName===e){var i=[];i.push(t),o.push(oe({fieldName:n.fieldName,compareType:n.compareType,value:i,fieldType:r}))}else o.push(oe({fieldName:n.fieldName,compareType:n.compareType,value:n.value,fieldType:r}))})),Y(o)},fe=function(e,t,n){!function(e,t,n){var r=[];B.forEach((function(o,a){t===a?r.push(oe({fieldName:o.fieldName,compareType:o.compareType,value:e,fieldType:n})):r.push(oe({fieldName:o.fieldName,compareType:o.compareType,value:o.value}))})),Y(r)}(J(e,n),t,n)};return F().createElement("div",{className:"".concat(n,"-modal"),ref:I},F().createElement("div",{className:"".concat(n,"-modal-body"),style:{marginTop:"0px"}},re.length>0&&F().createElement("div",{style:{width:"100%"}},x()(re).call(re,(function(e,t){return F().createElement(af,{key:(null==e?void 0:e.key)||(null==e?void 0:e.fieldName),item:e,index:t,filterOptions:V,fieldTree:H,prefixCls:n,handleCompareTypeChange:le,refBillProps:W,fieldRecords:O,handleValChange:fe,handleVarSelect:se,handleDelete:ue,verifyData:te,formId:o})})))),F().createElement("div",{className:"".concat(n,"-modal-footer")},F().createElement("div",{className:"".concat(n,"-modal-footer-left")},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(Vn.AddTreeItem,{treeData:V,triggerText:"添加录入内容",onCheck:function(e,t){var n=[],r=B.reduce((function(e,t){var n=t.fieldName,r=t.compareType;(null!=n&&Hs()(n).call(n,"_startdate")||null!=n&&Hs()(n).call(n,"_enddate"))&&(e[n.replace(/^(\S+)(_startdate|_enddate)/g,"$1")]=r);return e}),{});e.forEach((function(e,t){var o=Te()(B).call(B,(function(t){return t.fieldName===e}));if(o)n.push(o);else{var a=Z(z,e,re);if(a){if(null!=e&&Hs()(e).call(e,"_startdate")||null!=e&&Hs()(e).call(e,"_enddate")){var i=e.replace(/^(\S+)(_startdate|_enddate)/g,"$1");r[i]&&(a.compareType=r[i])}n=b()(n).call(n,oe(a))}}})),Y(n)},checkedKeys:G}))),F().createElement("div",{className:"".concat(n,"-modal-footer-right")},F().createElement(P.Button,{size:"small",className:"".concat(n,"-modal-footer-btn"),onClick:ie},"清空"),F().createElement(P.Button,{size:"small",type:"primary",className:"".concat(n,"-modal-footer-btn"),onClick:c},"确定"))))})),cf=(0,w.memo)((function(e){var t=e.prefixCls,n=e.title,r=e.value,o=e.formId,a=e.inputFormId,i=e.visible,l=e.setVisible,c=e.fieldKey,u=e.onChange,f=(0,w.useState)(r),d=(0,s.c)(f,2),p=d[0],v=d[1],m=(0,w.useRef)(),g=function(){l(!1),v(r)};return F().createElement(P.Modal,{mask:!0,visible:i,body:F().createElement(lf,{ref:m,prefixCls:t,fieldKey:c,formId:o,inputFormId:a,value:p,onChange:function(e){v(e)},onConfirm:function(){null==u||u(p),g()}}),titleIcon:null,className:"".concat(t,"-modal"),maskClosable:!1,footer:F().createElement(F().Fragment,null),width:640,height:520,keyboard:!1,bodyStyle:{padding:0,overflow:"hidden"},footerStyle:{display:"none"},title:n,closable:!0,draggable:!1,destroyOnClose:!0,onCancel:g,onOk:g})}));cf.displayName="InputContentModal";var uf=cf;function sf(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ff(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sf(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):sf(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var df=(0,w.memo)((function(e){var t,n,r=e.handleChange,o=e.className,a=e.editor,i=e.locked,l=e.Name,c=e.Tips,u=e.field,f=e.rootId,d=a.NameHidden,p=a.Required,v=a.Title,m=u.Key,g=u._Type_,h=u.InputForm,y=(0,w.useState)(!1),b=(0,s.c)(y,2),C=b[0],E=b[1],I=(0,w.useContext)(ae),x=I.invokeAction,N=I.prefixCls,T=I.getKdesignerApi,A=I.fetchListTree,D=T().data,P="string"==typeof(n=e.value)&&""!=n?JSON.parse(n):n,M=(0,w.useMemo)((function(){return"nocodemulrefbillfield"===g.toLocaleLowerCase()?u.BillEntityIdEx:D.getRootId()}),[g,D,null==u?void 0:u.BillEntityIdEx]),_=(0,w.useMemo)((function(){if(h){var e=h.lastIndexOf(".")+1,t=h.lastIndexOf("["),n=e>0&&t>-1?h.substring(e,t):h;return S()(n).call(n,f)?f:n}return""}),[h]);(0,w.useEffect)((function(){var e=null==P?void 0:P.targetId;e&&e!=h&&r("")}),[h]);var O,B=(0,w.useCallback)((function(e){var t=Ka()({value:e,targetId:h});r(t)}),[r]),j="".concat(N,"-inputContnet-editor"),L=ff(ff({},a),{},{NameHidden:!0}),U=(0,w.useMemo)((function(){return{name:l,className:o,nameHidden:d,tips:c,required:p,title:v}}),[l,o,d,c,p,v]);return F().createElement("div",{className:j},F().createElement("div",{className:"".concat(o,"-nav")},F().createElement(k.NameTipWrapper,U)),F().createElement(k.CustomInputTrigger,(0,R.c)({},e,{editor:L,disabled:i,value:(null==P||null===(t=P.value)||void 0===t?void 0:t.length)>0?(O=P.value,"".concat(O.length,"个内容")):"",onClick:function(){E(!0),A("formula"),_&&x("listtreeconfig",[_])}})),F().createElement(uf,{formId:M,inputFormId:_,prefixCls:j,visible:C,setVisible:E,fieldKey:m,value:(null==P?void 0:P.value)||[],title:l,onChange:B}))}));df.displayName="InputContentEditor";var pf=(0,k.ErrorBoundaryWrap)(df,"InputContentEditor");function vf(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function mf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vf(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):vf(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var gf=Vn.treeUtils.exludeTreeNodeByCallback,hf=Vn.treeUtils.dfs,yf=function e(t,n,r,o,a){return t.reduce((function(t,i){var l,c=i._Type_,u=i.Name,s=i.Key,f=i.BillEntityIdEx,d=i.SelectItemType,p=i.Multi,v=i.children,m=i.selectable;if(Ze(c)){var g,h,y=[{title:"".concat(u,".开始"),titlePrefix:"[日期]",key:a?b()(g="".concat(a,".")).call(g,s,"_startdate"):"".concat(s,"_startdate"),type:c,entityId:f},{title:"".concat(u,".结束"),titlePrefix:"[日期]",key:a?b()(h="".concat(a,".")).call(h,s,"_enddate"):"".concat(s,"_enddate"),type:c,entityId:f}];return b()(t).call(t,y)}var C=void 0!==m?m:!Ut(c),E={title:u,titlePrefix:rn(i,n,r,o),key:a?b()(l="".concat(a,".")).call(l,s):s,type:c,entityId:f,isMulti:1===d||1==p,selectable:C};if(1!=p&&v){var I=it(c)?s:void 0;E.children=e(v,n,r,o,I)}return Ut(c)&&(E.selectable=!1),b()(t).call(t,E)}),[])},bf=function(e){var t=e.value,n=e.isMultiMode,r=void 0!==n&&n,o=e.sourceFieldOptions,a=e.relationFieldId,i=e.selBillValue,l=e.onChange,c=e.curListFilterConfig,u=(0,w.useState)(t||[]),f=(0,s.c)(u,2),d=f[0],p=f[1],v=(0,w.useContext)(ae),m=v.getKdesignerApi,g=v.getRefBillNameMap,h=m(),y=h.data,C=h.meta,E=Vn.ListFilterUtil.filterTreeData,I=Vn.ListFilterUtil.canClearSourceField,N=(0,w.useMemo)((function(){return on(c)}),[c]),T=(0,w.useMemo)((function(){var e,t,n=x()(e=y.getData().Items||[]).call(e,(function(e){var t=e._Type_;return mf(mf({},C.getDefaultData(t)),e)})),o=gf((null===(t=dl(n)[0])||void 0===t?void 0:t.children)||[],(function(e){var t=e._Type_,n=e.BillEntityIdEx,o=e.showType,l=e.Multi,c=e.children,u=e.Key,s=e.RefBillKey;return r?(!s||s!==a)&&(!(!it(t)&&!$e(t)||n!==i||u===a||1!=l)||!(1==l||!c.length)&&(e.selectable=!1,!0)):(!a||u!==a&&s!==a)&&(it(t)?"1"!==o:!(ct(t)||nt(t)||("NoCodeMulRefBillField"===t||"NoCodeRefBillField"===t)&&void 0===n))}));return yf(o,N,C,g())}),[r,i,a,N,g]),A=function(e,t){var n=Te()(d).call(d,(function(e,n){return n===t})).fieldId;if(e!==n){var r=x()(d).call(d,(function(n,r){return t===r?mf(mf({},n),{},{sourceField:e}):n}));p(r),l(r)}},S=function(e,t){var n=x()(d).call(d,(function(n,r){if(t===r){var a=E(o,hf(T,(function(t){return t.key===e})));return I(a,n.sourceField)?mf(mf({},n),{},{targetField:e}):mf(mf({},n),{},{targetField:e,sourceField:""})}return n}));p(n),l(n)};(0,w.useEffect)((function(){var e=t||[];(0,we.isEqual)(e,d)||p(e)}),[t]);return F().createElement("div",{className:"bill-finder-actions"},x()(d).call(d,(function(e,t){var n=e.sourceField,r=e.targetField,a=hf(T,(function(e){return e.key===r}))||{},c=E(o,mf({selBillValue:i},a));return F().createElement("div",{className:"row_item",key:t},F().createElement("span",{className:"txt"},"将"),F().createElement(Vn.KDTreeSelect,{className:"target-field-select",virtual:!1,allowClear:!0,value:r,treeData:T,showFullLabelTips:!0,onChange:function(e){return S(e,t)},suffixIcon:F().createElement(P.Icon,{prefix:"designericon",type:"duixiangxuanze2"})}),F().createElement("span",{className:"txt"},"的值赋为"),F().createElement(Vn.KDTreeSelect,{className:"source-field-select",virtual:!1,disabled:""===r||void 0===r,value:n,treeData:c,showFullLabelTips:!0,treeCheckStrictly:!0,onChange:function(e){return A(e,t)},suffixIcon:F().createElement(P.Icon,{prefix:"designericon",type:"duixiangxuanze2"})}),F().createElement(P.Icon,{className:"delete_icon",prefix:"ncicon",type:"xingshanchu",onClick:function(){return function(e){var t=(0,M.c)(d);ce()(t).call(t,e,1),p(t),l(t)}(t)}}))})),F().createElement("div",{className:"footer-btns"},F().createElement("div",{className:"add-btn",onClick:function(){var e,t=b()(e=[]).call(e,(0,M.c)(d),[{sourceField:"",targetField:""}]);p(t),l(t)}},F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zengjia-yuan"}),"添加写入规则"),!!d.length&&F().createElement("div",{className:"clear-all",onClick:function(){p([]),l([])}},"清空")))},Cf=["children"];function Ef(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function If(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ef(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Ef(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var xf=Vn.treeUtils.dfs,Nf=Vn.treeUtils.getListConfigPure,Tf=Vn.treeUtils.treeNodeTransform,Af=Vn.treeUtils.getListSortConfig,Sf=Vn.treeUtils.getMultiRefChildrenExclude,wf=Vn.ListFilterUtil.getVarSelectDisabled,Ff={key:"currentRecord",title:"本记录"},kf={key:"currentRecord",title:"查询结果",isMulti:!0},Df=[{label:"单条",value:"0"},{label:"多条",value:"1"}],Pf=[{type:"array",required:!0,validator:function(e,t,n,r,o){return null!=t&&t.length&&t.every((function(e){return T()(e).every((function(e){return"string"==typeof e?""!==e:!Array.isArray(e)||0!==e.length}))}))?[]:[new Error("请添加写入规则")]}}],Mf=function(e,t){return If(If({},e),t)},Rf=function(e){var t,n=e.value,r=e.refBillData,o=e.field,a=e.ruleId,i=e.compareTypesMap,l=e.formId,c=e.listFilterConfig,u=e.curFormFieldTree,d=e.onChange,p=(0,w.useContext)(ae),v=p.prefixCls,g=p.baseUrl,h=p.onDownLoad,y=p.getControlText,C=p.batchInvoke,E=p.invokeAction,I=p.getDataRef,N=p.getKdesignerApi,T=P.Form.useForm(),A=(0,s.c)(T,1)[0],D=(0,w.useState)({}),R=(0,s.c)(D,2),_=R[0],O=R[1],B=o.Key,j=o.ParentId,L=N(),U=L.data,K=L.meta,V=U.getRootId(),z=(0,w.useReducer)(Mf,n),G=(0,s.c)(z,2),H=G[0],q=G[1],Y=(0,w.useRef)(),W=(0,w.useRef)(),Q={baseUrl:g,batchInvoke:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];C(e,o.Key,t,n)},getControlText:y,addControlAction:function(e,t){return k.eventBus.on(e,t),function(){k.eventBus.off(e,t)}},onDownLoad:h,batchInvokeListConfig:function(e){C("listconfig","nocodeformdesigner",[e])},batchInvokeQuery:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m()(t),r=void 0===n?"":n,o=t.search,a=void 0===o?"":o,i=t.order_by,l=void 0===i?"":i,c=t.select,u=void 0===c?"":c,s=t.page_size,f=void 0===s?10:s,d=t.page_no,p=void 0===d?1:d,v=t.ids;C("query","nocodeformdesigner",[e,{filter:r,search:a,order_by:l,select:u,page_size:f,page_no:p,ids:void 0===v?[]:v}])}},X=(0,w.useMemo)((function(){var e=r.children,t=void 0===e?[]:e;return t[0].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"gerenzhongxin",style:{color:"#3987ED"}}),t[1].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zuzhi",style:{color:"#3987ED"}}),So(t)[0]}),[r]),Z=yc({id:B,formId:H.relationFormId,eventName:"setListTreeConfig",parser:function(e){var t=e.data;return $t(t,t,i)},defaultValue:[]}),J=(0,w.useMemo)((function(){if(2===H.valueType)return""===H.relationFormId?[]:H.relationFormId===l?c:Z;if(3===H.valueType){var e;if(""===H.relationFieldId)return[];var t=(null===(e=xf(u,(function(e){return e.key===H.relationFieldId})))||void 0===e?void 0:e.children)||[];return Tf(t,(function(e){var t=e.compareTypes,n=void 0===t?[]:t,r=e.key,o=H.relationFieldId.replace(/\./g,"\\."),a=r.replace(new RegExp("^"+o+"\\.(\\S+)"),"$1");if((null!=a&&S()(a).call(a,"fbasedataid")?a.split(".fbasedataid")[0]:a).split(".").length>2)return!1;var i=m()(n).call(n,(function(e){return"001"!==e.id}));return If(If({},e),{},{compareTypes:i,key:a})}))}return[]}),[H.relationFormId,H.relationFieldId,H.valueType,l,c,Z,u]),$=(0,w.useMemo)((function(){return Nf(J)}),[J]),ee=(0,w.useMemo)((function(){return Af(J)}),[J]),te=(0,w.useMemo)((function(){var e;return"1"===H.valueType2Multi?[kf]:b()(e=[Ff]).call(e,(0,M.c)(Sf(J)))}),[J,H.valueType2Multi]),ne=(0,w.useMemo)((function(){if(!H.relationFieldId)return!1;var e=xf(u,(function(e){return e.key===H.relationFieldId}));return null==e?void 0:e.isMulti}),[H.relationFieldId,u]),re=(0,w.useMemo)((function(){var e;if(""===H.relationFieldId)return[];if(3===H.valueType&&ne&&"1"===H.valueType3Multi)return[kf];var t=xf(u,(function(e){return e.key===H.relationFieldId})),n=Tf((null==t?void 0:t.children)||[],(function(e){var t=e.children,n=(0,ye.c)(e,Cf),r=n.isMulti,o=n.key,a=H.relationFieldId.replace(/\./g,"\\."),i=o.replace(new RegExp("^"+a+"\\.(\\S+)"),"$1");return!((null!=i&&S()(i).call(i,"fbasedataid")?i.split(".fbasedataid")[0]:i).split(".").length>2)&&If(If({},!r&&t?e:n),{},{key:i})}));return b()(e=[Ff]).call(e,(0,M.c)(n))}),[H.relationFieldId,u,H.valueType3Multi,ne]),oe=(0,w.useMemo)((function(){return ul({metaApi:K,options:c})}),[c]),ie=(0,w.useMemo)((function(){return sl({options:c})}),[c,V]),le=(null===(t=xf(u,(function(e){return e.key===H.relationFieldId})))||void 0===t?void 0:t.entityId)||"",ce=yc({id:B,formId:H.relationFormId,eventName:"filterItemLook"}),ue=(0,w.useMemo)((function(){var e;return Array.isArray(H.filterInfos)?x()(e=H.filterInfos).call(e,(function(e){return If(If({},e),{},{value:"string"==typeof e.value?JSON.parse(e.value):e.value||[]})})):[]}),[H.filterInfos]);(0,w.useEffect)((function(){var e=ce.data,t=ce.param,n=(void 0===t?{}:t).enumField;if(n){var r=null==ue?void 0:m()(ue).call(ue,(function(e){return e.fieldName===n})),o=xf(J,(function(e){return e.key===n}));O((function(t){return If(If({},t),{},(0,f.c)({},n,{configuredFilter:{enumEqCompareType:"001",items:r},fieldFilterConfig:o,groupInfo:e}))}))}}),[ce,ue,J]),(0,w.useEffect)((function(){var e;H.relationFormId&&((e=H.relationFormId)!==V&&E("listtreeconfig",[e]))}),[H.relationFormId]),(0,w.useEffect)((function(){if(2===H.valueType){var e=H.filterInfos,t=H.sortInfos,n=H.relationFormId,r=H.valueType2Result,o=H.valueType2Multi,a=H.valueType2Top;A.setFieldsValue({filterInfos:e,sortInfos:t,relationFormId:n,valueType2Result:r,valueType2Multi:o,valueType2Top:a})}else if(3===H.valueType){var i=H.relationFieldId,l=H.valueType3Result,c=H.valueType3FilterInfos,u=H.valueType3SortInfos,s=H.valueType3Multi,f=H.valueType3Top;A.setFieldsValue({relationFieldId:i,valueType3Result:l,valueType3FilterInfos:c,valueType3SortInfos:u,valueType3Multi:s,valueType3Top:f})}}),[H.valueType]),(0,w.useEffect)((function(){var e=H.valueType2Top;A.setFieldsValue({valueType2Top:e})}),[H.valueType2Multi]),(0,w.useEffect)((function(){var e=H.valueType3Top;A.setFieldsValue({valueType3Top:e})}),[H.valueType3Multi]);var se=(0,w.useMemo)((function(){return!(null!=a&&S()(a).call(a,"new_rule_"))}),[n]),fe=(0,w.useMemo)((function(){return 2===H.valueType?"1"===H.valueType2Multi:3===H.valueType&&(ne&&"1"===H.valueType3Multi)}),[H.valueType,H.valueType2Multi,H.valueType3Multi,ne]),de=function(e){!function(e){E("getFilterItemLook",[e,{getEnumData:"true",enumField:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",filterrows:[]}])}(H.relationFormId,e.fieldName)},pe=function(e,t){q((0,f.c)({},e,t)),d((0,f.c)({},e,t))},ve=function(e){q(e),d(e)};(0,w.useEffect)((function(){(0,we.isEqual)(n,H)||(q(n),A.setFieldsValue(n))}),[n]);return F().createElement("div",{className:"bill-finder-setting",key:a},F().createElement("div",{className:"setting-form"},F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(P.Form,{layout:"vertical",form:A,labelWidth:"100%",wrapperWidth:"100%",onValuesChange:function(e,t){}},F().createElement(P.Form.Item,{label:"规则名称",name:"ruleName",required:!0,validateTrigger:"onBlur",rules:[{required:!0,message:"请输入规则名称"},{type:"string",validator:function(e,t,n,r,o){return null!=t&&Qr()(t).call(t)?[]:[new Error("请输入规则名称")]}}]},F().createElement(P.Input,{type:"text",borderType:"bordered",size:"middle",placeholder:"请输入规则名称",maxLength:50,value:H.ruleName,onChange:function(e){return pe("ruleName",e.target.value)}})),F().createElement(P.Form.Item,{label:"查找方式",name:"valueType",rules:[{required:!0,message:"请输入规则名称",type:"number"}]},F().createElement(Vn.Sectioner,{defaultValue:2,value:H.valueType,options:[{label:"通过筛选条件",value:2},{label:"通过关联表单",value:3}],onChange:function(e){return pe("valueType",e)}})),2===H.valueType&&F().createElement(F().Fragment,null,F().createElement(P.Form.Item,{label:"查找表单",name:"relationFormId",required:!0},F().createElement(Vn.KDTreeSelect,{allowClear:!0,value:H.relationFormId||"",treeData:X,showTreeIcon:!0,treeIcon:function(e){return e.icon},onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(e=e||"")!==H.relationFormId&&(ve({relationFormId:e,filterInfos:[],sortInfos:[],valueType2Result:[]}),A.setFieldsValue({relationFormId:e,filterInfos:null,sortInfos:null,valueType2Result:null}))}})),F().createElement(P.Form.Item,{label:"配置筛选条件",name:"filterInfos",rules:[{type:"array",required:!0,message:"请配置筛选条件"}]},F().createElement(Vn.FilterEditor,{id:"filter",ref:Y,valueRequired:!0,name:"配置筛选条件",tips:"",variablesTree:oe||[],listFilterConfig:$,onGetFieldRecords:de,fieldRecords:_,nameHidden:!0,style:{marginTop:"0px"},getVarSelectDisabled:wf,fieldData:{fieldType:"treeSelect",style:{width:"184px"}},filterFooterData:{listType:"tree",triggerText:"添加筛选条件",treeProps:{defaultExpandAll:!1}},value:H.filterInfos||[],refBillProps:Q,onChange:function(e){A.setFieldValue("filterInfos",e),pe("filterInfos",e)}})),F().createElement(P.Form.Item,{label:"配置排序条件",name:"sortInfos"},F().createElement(Vn.OrderByEditor,{id:"filter",name:"配置排序条件",nameHidden:!0,tips:"",style:{marginTop:"0px"},treeData:ee||[],value:H.sortInfos||[],onChange:function(e){return pe("sortInfos",e)}})),F().createElement(P.Form.Item,{label:"查找数量",name:"valueType2Multi"},F().createElement(Vn.Sectioner,{defaultValue:"0",value:H.valueType2Multi,options:Df,onChange:function(e){ve({valueType2Multi:e,valueType2Result:[]}),A.setFieldsValue({valueType2Multi:e,valueType2Result:null})}})),"1"===H.valueType2Multi&&F().createElement(P.Form.Item,{label:"数量上限（最多1000条）",name:"valueType2Top",required:!0},F().createElement(P.InputNumber,{borderType:"bordered",value:H.valueType2Top,min:0,max:1e3,mustInScope:!0,decimalLength:0,onChange:function(e){var t;return pe("valueType2Top",(null===(t=e.target)||void 0===t?void 0:t.value)||"")}})),F().createElement(P.Form.Item,{label:"查找到记录后",name:"valueType2Result",rules:Pf},F().createElement(bf,{prefixCls:v,isMultiMode:fe,selBillValue:H.relationFormId||"",sourceFieldOptions:te,value:H.valueType2Result||[],onChange:function(e){return pe("valueType2Result",e)},curListFilterConfig:c}))),3===H.valueType&&F().createElement(F().Fragment,null,F().createElement(P.Form.Item,{label:"选择关联表单",name:"relationFieldId",required:!0},F().createElement(Vn.KDTreeSelect,{className:"suffix-icon-no-animation",allowClear:!0,value:H.relationFieldId,treeData:ie,suffixIcon:F().createElement(P.Icon,{prefix:"designericon",type:"duixiangxuanze2"}),onChange:function(e){e!==H.relationFieldId&&(ve({relationFieldId:e,valueType3Result:[],valueType3FilterInfos:[],valueType3SortInfos:[]}),A.setFieldsValue({relationFieldId:e,valueType3Result:null,valueType3FilterInfos:null,valueType3SortInfos:null}))},showFullLabelTips:!0})),ne&&F().createElement(F().Fragment,null,F().createElement(P.Form.Item,{label:"配置筛选条件",name:"valueType3FilterInfos",rules:[{type:"array",required:!0,message:"请配置筛选条件"}]},F().createElement(Vn.FilterEditor,{id:"filter",ref:W,valueRequired:!0,name:"配置筛选条件",tips:"",variablesTree:oe||[],listFilterConfig:$,onGetFieldRecords:de,fieldRecords:_,nameHidden:!0,style:{marginTop:"0px"},getVarSelectDisabled:wf,fieldData:{fieldType:"treeSelect",style:{width:"184px"}},filterFooterData:{listType:"tree",triggerText:"添加筛选条件",treeProps:{defaultExpandAll:!1}},value:H.valueType3FilterInfos||[],refBillProps:Q,onChange:function(e){A.setFieldValue("valueType3FilterInfos",e),pe("valueType3FilterInfos",e)}})),F().createElement(P.Form.Item,{label:"配置排序条件",name:"valueType3SortInfos"},F().createElement(Vn.OrderByEditor,{id:"filter",name:"配置排序条件",nameHidden:!0,tips:"",style:{marginTop:"0px"},treeData:ee||[],value:H.valueType3SortInfos||[],onChange:function(e){return pe("valueType3SortInfos",e)}})),F().createElement(P.Form.Item,{label:"查找数量",name:"valueType3Multi"},F().createElement(Vn.Sectioner,{defaultValue:"0",value:H.valueType3Multi,options:Df,onChange:function(e){ve({valueType3Multi:e,valueType3Result:[]}),A.setFieldsValue({valueType3Multi:e,valueType3Result:null})}})),"1"===H.valueType3Multi&&F().createElement(P.Form.Item,{label:"数量上限（最多1000条）",name:"valueType3Top",required:!0},F().createElement(P.InputNumber,{borderType:"bordered",value:H.valueType3Top,min:0,max:1e3,mustInScope:!0,decimalLength:0,onChange:function(e){var t;return pe("valueType3Top",(null===(t=e.target)||void 0===t?void 0:t.value)||"")}}))),F().createElement(P.Form.Item,{label:"查找到记录后",name:"valueType3Result",rules:Pf},F().createElement(bf,{prefixCls:v,isMultiMode:fe,selBillValue:le||"",relationFieldId:H.relationFieldId,sourceFieldOptions:re,value:H.valueType3Result||[],onChange:function(e){return pe("valueType3Result",e)},curListFilterConfig:c})))))),F().createElement("div",{className:"setting-footer"},F().createElement(P.Button,{size:"small",type:"primary",onClick:function(){var e,t=U.findControl(j),n=t._Type_,r=t.Key,i=it(n)?b()(e="".concat(r,".")).call(e,o.Key):o.Key;new(jr())((function(e,t){A.validateFields().then((function(t){var n=xl()(t);e(n)})).catch((function(e){return t(e)}))})).then((function(e){var t,n,r=e.ruleName,o=e.valueType,l=e.valueType2Result,c=e.valueType3Result,u=e.relationFormId,s=e.relationFieldId,f=e.filterInfos,d=e.valueType2Multi,p=e.valueType2Top,v=e.valueType3FilterInfos,m=e.valueType3SortInfos,g=e.valueType3Multi,h=e.valueType3Top,y=e.sortInfos||[],b=2===o&&(null===(t=Y.current)||void 0===t||null===(n=t.updateVerifyAndGetMsg)||void 0===n?void 0:n.call(t)),C={result:2===o?l:c,relationFormId:2===o?u:s};if(2===o)C.filterInfos=f,C.sortInfos=y,C.multi=d,"1"===d&&(C.top=p);else if(3===o){var x,N;if(ne)if(C.multi=g,C.filterInfos=v,C.sortInfos=m,"1"===g&&(C.top=h),(null===(x=W.current)||void 0===x||null===(N=x.updateVerifyAndGetMsg)||void 0===N?void 0:N.call(x)).length)return}var T={ruleName:Qr()(r).call(r),valueType:o,value:C},A={formId:V,fieldKey:i,ruleInfo:Ka()(T)};se&&(A.ruleId=a);var S={nocodeformdesigner:I()};!b.length&&E("saveBizRule",[A],[S])})).catch((function(e){}))}},"保存")))};function _f(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Of(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_f(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):_f(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var Bf=function(e){var t=e.handleAdd;return F().createElement("div",{className:"rule-empty"},F().createElement("img",{src:Zu,alt:"暂无卡片",width:224,height:128}),F().createElement("div",{className:"empty-text"},"暂无规则，点击下方按钮添加"),F().createElement(P.Button,{type:"primary",icon:F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zengjia-yuan"}),onClick:t},"添加规则"))},jf={valueType:2,relationFormId:"",relationFieldId:"",filterInfos:[],sortInfos:[],valueType2Result:[],valueType3Result:[],valueType3FilterInfos:[],valueType3SortInfos:[],valueType2Multi:"0",valueType3Multi:"0",valueType2Top:"100",valueType3Top:"100"},Lf=function(e){var t=e.ruleInfo,n=e.affectfldkeys,r=e.depfldkeys,o=e.ruleId,a=t&&qt(t)?JSON.parse(t):{},i=a.ruleName,l=a.valueType,c=a.value,u=void 0===c?{}:c,s=Of(Of({},jf),{},{affectfldkeys:n,depfldkeys:r,ruleId:o,ruleName:i,valueType:l});if(2===l){var d=u.filterInfos,p=void 0===d?[]:d,v=u.sortInfos,m=void 0===v?[]:v,g=u.result,h=void 0===g?[]:g,y=u.relationFormId,b=void 0===y?"":y,C=u.multi,E=u.top;(0,R.c)(s,{filterInfos:p,sortInfos:m,valueType2Multi:C,valueType2Result:h,relationFormId:b}),E&&(0,R.c)(s,{valueType2Top:E})}else if(3===l){var I=u.result,x=void 0===I?[]:I,N=u.relationFormId,T=void 0===N?"":N;(0,R.c)(s,{valueType3Result:x,relationFieldId:T}),["filterInfos","sortInfos","multi","top"].forEach((function(e){var t=u[e];t&&(0,R.c)(s,(0,f.c)({},"valueType3".concat((0,we.upperFirst)(e)),t))}))}return s},Uf=(0,w.forwardRef)((function(e,t){var n=e.prefixCls,r=e.field,o=e.refreshEditorDisplay,a=(0,w.useState)(),i=(0,s.c)(a,2),l=i[0],c=i[1],u=(0,w.useState)(null),f=(0,s.c)(u,2),d=f[0],p=f[1],v=(0,w.useContext)(ae),g=v.invokeAction,h=v.getKdesignerApi,y=v.getRefBillData,C=v.getCompareTypes,E=v.getBizRules,I=v.setBizRules,N=v.curListTreeApi,T=h().data.getRootId(),A=r.Key,D=C(),M=bc({api:N,parser:function(e){return $t(e,e,D)}}),R=bc({api:N,parser:function(e){return $t(e,e,D,4)}}),_=(0,w.useCallback)((function(){null==d||d.length;var e="new_rule_".concat((0,k.createUUid)()),t=Of({ruleId:e,ruleName:"未命名规则",depfldkeys:"",affectfldkeys:""},jf);p(d?b()(d).call(d,t):[t]),c(e)}),[d]),O=function(e){var t=(null==d?void 0:Ur()(d).call(d,(function(t){return t.ruleId===e})))||0,n=l;if(l===e){var r=t>0?d[t-1]:void 0,o=d[t+1];r?n=r.ruleId:o&&(n=o.ruleId)}return n},B=function(e,t,n){e.stopPropagation(),null===Vn.WebMsg||void 0===Vn.WebMsg||Vn.WebMsg.showConfirmModal({title:"确定删除".concat(t,"吗？"),type:"delete",onAction:function(e){if("ok"===e)!function(e){if("string"==typeof e&&S()(e).call(e,"new_rule_")){var t=O(e);c(t),p((function(t){return null==t?void 0:m()(t).call(t,(function(t){return t.ruleId!==e}))}))}else g("deleteBizRule",[{ruleId:e}])}(n)}})},j=(0,w.useCallback)((function(e){p(x()(e).call(e,Lf)),e.length&&c(e[0].ruleId)}),[]),L=function(e){p((function(t){return null==t?void 0:x()(t).call(t,(function(t){return t.ruleId===l?Of(Of({},t),e):t}))}))},U=(0,w.useMemo)((function(){return y()}),[y]);(0,w.useEffect)((function(){var e=function(e){j(e),o()};return k.eventBus.on(lr,e),function(){k.eventBus.off(lr,e)}}),[]),(0,w.useEffect)((function(){var e=function(e){var t=O(e);c(t),p((function(t){return null==t?void 0:m()(t).call(t,(function(t){return t.ruleId!==e}))})),function(e){var t=E();I(null==t?void 0:m()(t).call(t,(function(t){return t.ruleId!==e}))),o()}(e)};return k.eventBus.on(cr,e),function(){k.eventBus.off(cr,e)}}),[p,l]),(0,w.useEffect)((function(){var e=function(e){L(e),c(e.ruleId),function(e){var t=E(),n=Of(Of({},(null==d?void 0:Te()(d).call(d,(function(e){return e.ruleId===l})))||{}),e),r=null!=l&&S()(l).call(l,"new_rule_")?b()(t).call(t,n):x()(t).call(t,(function(e){return e.ruleId===l?n:e}));I(r),o()}(e)};return k.eventBus.on(ar,e),function(){k.eventBus.off(ar,e)}}),[p,l]),(0,w.useImperativeHandle)(t,(function(){return{getRules:function(){return null==d?void 0:x()(d).call(d,(function(e){var t="null"===e.depfldkeys?"":e.depfldkeys,n="null"===e.affectfldkeys?"":e.affectfldkeys;return Of(Of({},e),{},{depfldkeys:t,affectfldkeys:n})}))}}}),[d]);var K=(0,w.useMemo)((function(){return l?null==d?void 0:Te()(d).call(d,(function(e){return e.ruleId===l})):{}}),[l,d]);return d?d.length?F().createElement("div",{className:"".concat(n,"-main")},F().createElement("div",{className:"left-area"},F().createElement("div",{className:"rule-list"},null==d?void 0:x()(d).call(d,(function(e){var t=e.ruleName,n=e.ruleId,r=e.depfldkeys,o=e.affectfldkeys;return F().createElement("div",{className:jn()("rule-item",{"is-active":l===n}),key:n,onClick:function(){return c(n)}},F().createElement("div",{className:"rule-name"},t,F().createElement(P.Icon,{prefix:"ncicon",type:"jingshi",className:jn()("warning-icon",{show:!1})})),F().createElement("div",{className:"tags"},S()(r).call(r,A)&&F().createElement("span",{className:"tag-item"},"触发"),S()(o).call(o,A)&&F().createElement("span",{className:"tag-item"},"受影响的")),F().createElement("div",{className:"delete-btn",onClick:function(e){return B(e,t,n)}},F().createElement(P.Icon,{prefix:"designericon",type:"shanchu"})))}))),F().createElement("div",{className:"add-rule",onClick:_},F().createElement("span",{className:"add-btn"},F().createElement(P.Icon,{prefix:"designericon",type:"zengjia-yuan"}),"新增规则"))),F().createElement("div",{className:"right-area"},F().createElement(Rf,{value:K,refBillData:U,field:r,ruleId:l,compareTypesMap:D,formId:T,listFilterConfig:M,curFormFieldTree:R,onChange:L}))):F().createElement("div",{className:"".concat(n,"-main")},F().createElement(Bf,{handleAdd:_})):null})),Kf=function(e){var t=e.prefixCls,n=e.title,r=e.visible,o=e.setVisible,a=e.field,i=e.listFilterConfig,l=e.refreshEditorDisplay,c=(0,w.useRef)(null),u=function(){o(!1)};return F().createElement(P.Modal,{mask:!0,visible:r,body:F().createElement(Uf,{ref:c,prefixCls:t,field:a,listFilterConfig:i,refreshEditorDisplay:l}),titleIcon:null,className:"".concat(t,"-modal"),footer:null,maskClosable:!1,width:960,height:644,keyboard:!1,title:F().createElement("span",{title:n},n),closable:!0,draggable:!1,destroyOnClose:!0,onCancel:u,onOk:u})},Vf=function(e){var t=e.locked,n=e.field,r=n.Name,o=n.Key,a=n.ParentId,i=(0,w.useState)(!1),l=(0,s.c)(i,2),c=l[0],u=l[1],f=(0,w.useContext)(ae),d=f.invokeAction,p=f.prefixCls,v=f.getKdesignerApi,m=f.getDataRef,g=f.getBizRules,h=f.fetchListTree,y=v().data,C=y.getRootId(),E=g()||[],I=(0,w.useReducer)((function(e){return e+1}),0),x=(0,s.c)(I,2)[1],N=function(){var e,t=y.findControl(a),r=t._Type_,o=t.Key,i=it(r)?b()(e="".concat(o,".")).call(e,n.Key):n.Key,l=[{nocodeformdesigner:m()}];d("getBizRules",[{formId:C,fieldKey:i}],l),h(),u(!0)},T=(0,w.useMemo)((function(){var e=E.reduce((function(e,t){var n=t.affectfldkeys,r=t.depfldkeys;return null!=n&&S()(n).call(n,o)||S()(r).call(r,o)?e+1:e}),0);return 0!==e?"".concat(e,"条规则"):""}),[E,o]),A="".concat(p,"-billFinder");return F().createElement(F().Fragment,null,F().createElement(k.CustomInputTrigger,(0,R.c)({},e,{placeholder:"请选择",disabled:t,value:T,onClick:N,onInputClick:N})),F().createElement(Kf,{prefixCls:A,visible:c,setVisible:u,field:n,title:"".concat(r,"-查找表单记录"),refreshEditorDisplay:x}))},zf=Vn.Condition.constants,Gf=zf.allFieldRegExp,Hf=zf.allExpRegExp,qf=zf.expRegExp,Yf={valueType:1,value:""},Wf=Ka()(Yf),Qf={prefixCls:"kd"},Xf=function(e){var t,n=e.className,r=e.locked,o=e.Editor,a=e.Name,i=e.Tips,l=e.field,c=o.NameHidden,u=o.Required,f=o.Title,d=(0,w.useContext)(ae),p=d.invokeAction,v=d.getKdesignerApi,m=d.getExpressionData,g=d.getCompareTypes,h=d.curFormulaTreeApi,y=d.fetchListTree,C=l.ParentId,E=l.Name,I=l.Key,x=(0,w.useState)(!1),N=(0,s.c)(x,2),A=N[0],S=N[1],D=v(),M=D.data,R=(D.meta,M.findControl(C)),_=R._Type_,O=R.Key,B=it(_)?b()(t="".concat(O,".")).call(t,I):I,j=M.getRootId(),L=(0,w.useState)(Wf),U=(0,s.c)(L,2),K=U[0],V=U[1],z=g(),G=(0,w.useMemo)((function(){return m()}),[m]),H=(0,w.useMemo)((function(){return T()(G.functionOperations)}),[G]),q=function(e){var t=e||{},n=t.bizRule,r=t.fieldKey;n&&r===B&&V(n)};(0,w.useEffect)((function(){return k.eventBus.on(gr,q),function(){k.eventBus.off(gr,q)}}),[]);var Y=bc({api:h,parser:function(e){return $t(e,e,z)}}),W=(0,w.useMemo)((function(){var e=it(_)?O:void 0;return cl({options:Y,currRefbillTableKey:e})}),[Y,j,O]);(0,w.useEffect)((function(){p("getBizRule",[{formId:j,fieldKey:B}],[])}),[]);(0,w.useEffect)((function(){y("formula")}),[E]);var Q=function(e){var t=Ka()(e);V(t)},X=(0,w.useMemo)((function(){return e=function(e){try{if(qt(e)){var t=JSON.parse(e);return(null==t?void 0:t.value)||""}return""}catch(e){}}(K),t=e?e.split("@@"):["","",null],[(n=(0,s.c)(t,3))[1],n[2]];var e,t,n}),[K]),Z=(0,w.useCallback)((function(){S(!0)}),[S]),J=(0,w.useCallback)((function(){S(!1)}),[S]),$=(0,w.useCallback)((function(){Z()}),[Z]);return F().createElement(F().Fragment,null,F().createElement(k.NameTipWrapper,{nameHidden:c,className:n,name:a,tips:i,required:u,title:f}),F().createElement(P.ConfigProvider,{value:Qf},F().createElement(Vn.InputCombo,{fieldType:"formula",placeholder:"请输入",disabled:r,onClick:$,value:X[0],expressionData:G.functionTypes,fieldData:W,onClear:function(e){e.stopPropagation(),p("deleteBizRule",[{formId:j,fieldKey:B}],[]),Q(Yf)},lang:Number(X[1]||1),readOnly:!0,autofocus:!1})),F().createElement(P.ConfigProvider,{value:Qf},A&&F().createElement(Vn.Condition,{value:X[0],language:Number(X[1]||1),modalTitle:"编辑运算公式",editorTitle:l.Name,visible:A,editorPlaceholder:"请编辑运算公式",fieldData:W,fieldTitle:"表单内容",expressionData:G.functionTypes,operations:H,defaultExpandAll:!1,onClose:J,onConfirm:function(e,t){e=function(e,t){var n,r;if(!e)return"";var o=(e=e.replace(/）/g,")").replace(/（/g,"(").replace(/“/g,'"').replace(/”/g,'"').replace(/‘/g,"'").replace(/’/g,"'")).replace(/ {{/g,"{{").replace(/}} /g,"}}").replace(Gf,"$1");return o=o.replace(Hf,(function(e){var t;return((null===(t=e.match(qf))||void 0===t?void 0:t[1])||"").replace("YMDDATE","DATE")})),b()(n=b()(r="".concat(o,"@@")).call(r,e,"@@")).call(n,t?1:0)}(e,t);var n,r={valueType:1,value:e};n=r,p("saveBizRule",[{formId:j,fieldKey:B,ruleInfo:Ka()(n)}]),Q(r),S(!1)}})))},Zf=F().memo((function(e){var t,n=e.data,r=e.iconIndex,o=e.onSelect,a=e.isLineIconStyle,i=e.prefixClass,l=(0,w.useState)(0),c=(0,s.c)(l,2),u=c[0],d=c[1],p=(0,w.useRef)(null);(0,w.useEffect)((function(){d(r)}),[r]);var v=(0,w.useCallback)((function(e){d(e),null==o||o(e)}),[o,n]);return(0,w.useLayoutEffect)((function(){var e,t,n=null===(e=p.current)||void 0===e?void 0:e.getElementsByTagName("path");n&&(Array.prototype.forEach.call(n,(function(e){return e.removeAttribute("style")})),null===(t=n[u])||void 0===t||t.setAttribute("style","fill:#212121"))}),[u,p.current]),F().createElement("div",{className:"".concat(i,"-popmain")},F().createElement("div",{ref:p,className:"".concat(i,"-icons")},null==n?void 0:x()(t=n.svgs).call(t,(function(e,t){var n=u===t?"#212121":"";return F().createElement("div",{key:t,onClick:function(){return v(t)},className:jn()((0,f.c)((0,f.c)({},"".concat(i,"-iconf"),a),"".concat(i,"-iconf-active"),a&&u===t)),style:{color:n},dangerouslySetInnerHTML:{__html:e.content}})}))))})),Jf=(0,w.memo)((function(e){var t=e.handleChange,n=e.className,r=e.editor,o=e.Name,a=e.Tips,i=e.value,l=r.NameHidden,c=r.Required,u=(0,w.useContext)(ae),f=u.invokeAction,d=u.prefixCls,p=(u.getKdesignerApi,"".concat(d,"-iconPicker-editor")),v=(0,w.useState)({iconIndex:void 0}),m=(0,s.c)(v,2),g=m[0],h=m[1],y=(0,w.useRef)(null),C=(0,w.useState)({}),E=(0,s.c)(C,2),I=E[0],x=E[1];(0,w.useEffect)((function(){f("getSvgLine",[])}),[]);var N=(0,w.useCallback)((function(e){var t,n;x(null==e||null===(t=e.data)||void 0===t?void 0:t.row),D(i,null==e||null===(n=e.data)||void 0===n?void 0:n.row)}),[]);(0,w.useEffect)((function(){return k.eventBus.on(pr,N),function(){k.eventBus.off(pr,N)}}),[]);var T=(0,w.useMemo)((function(){return{name:o,className:n,nameHidden:l,tips:a,required:c}}),[o,n,l,a,c]),A=function(e){var n,r;h({iconIndex:e});var o=encodeURIComponent("#666666"),a=null==I||null===(n=I.svgs)||void 0===n?void 0:n[e].label,i=b()(r="nocode/v2/nocode_sys/common/svgs/create_svg_line?color=".concat(o,"&svg=")).call(r,a);null==t||t(i)},S=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href).split("?")[1],n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=null==t?void 0:t.match(n);return null!=r?unescape(r[2]):null},D=(0,w.useCallback)((function(e,t){var n,r=S("svg",e),o=r&&"undefined"!==r?null==t||null===(n=t.svgs)||void 0===n?void 0:Ur()(n).call(n,(function(e){return e.label===r})):0;h({iconIndex:o})}),[]);(0,w.useLayoutEffect)((function(){var e;if(I&&y.current){null===(e=y.current.getElementsByTagName("path"))||void 0===e||null===(e=e[0])||void 0===e||e.setAttribute("style","fill:".concat("#212121"," "))}}),[I,g,y.current]);var M=(0,w.useMemo)((function(){return F().createElement(Zf,{data:I,iconIndex:g.iconIndex,onSelect:A,prefixClass:p,isLineIconStyle:!0})}),[I,g]),R=(0,w.useCallback)((function(e){if(e)D(i,I);else{var n,r,o=encodeURIComponent("#666666"),a=null==I||null===(n=I.svgs)||void 0===n?void 0:n[g.iconIndex].label,l=b()(r="nocode/v2/nocode_sys/common/svgs/create_svg_line?color=".concat(o,"&svg=")).call(r,a);null==t||t(l)}}),[I,g,t]),_=(0,w.useMemo)((function(){var e,t,n=S("svg",i),r=n&&"undefined"!==n?null==I||null===(e=I.svgs)||void 0===e?void 0:Ur()(e).call(e,(function(e){return e.label===n})):0;return F().createElement("div",{ref:y,className:"".concat(p,"-avatar"),dangerouslySetInnerHTML:{__html:(null==I||null===(t=I.svgs)||void 0===t||null===(t=t[r])||void 0===t?void 0:t.content)||""}})}),[I,g,i]);return F().createElement("div",{className:p},F().createElement("div",{className:"".concat(p,"-nav")},F().createElement(k.NameTipWrapper,T)),F().createElement("div",null,F().createElement(P.ConfigProvider,{value:{prefixCls:"kd"}},F().createElement(P.Tooltip,{placement:"bottomLeft",arrow:!1,popperClassName:"".concat(p,"-pop"),gap:0,tip:M,trigger:"click",onVisibleChange:R},_))))}));Jf.displayName="IconPickerEditor";var $f=(0,k.ErrorBoundaryWrap)(Jf,"IconPickerEditor"),ed=(0,w.memo)((function(e){e.handleChange;var t=e.className,n=e.editor,r=(e.locked,e.Name),o=e.Tips,a=e.field,i=(e.id,e.propName,e.rootId),l=n.NameHidden,c=n.Required,u=n.Title,f=(0,w.useContext)(ae),d=f.invokeAction,p=f.getHideFieldRef,v=(0,w.useContext)(k.GlobalConfigContext).showMessage,m=(0,w.useState)(""),g=(0,s.c)(m,2),h=g[0],y=g[1],b=(0,w.useState)([]),C=(0,s.c)(b,2),E=C[0],I=C[1],N=(0,w.useState)({}),T=(0,s.c)(N,2),A=T[0],S=T[1],D=a.BillEntityIdEx,P=a.Key,M=a._Type_,R=a.RefBillId,_="".concat(t,"-association"),O=(0,w.useMemo)((function(){var e,t,n;R&&it(M)&&(t=null===(n=p())||void 0===n?void 0:n[R]);return(null===(e=t)||void 0===e?void 0:e.Key)||P}),[P,M,R]),B=(0,w.useCallback)((function(e){return x()(e).call(e,(function(e){var t=e||{};return{value:t.id,label:t.caption}}))}),[]),j=(0,w.useCallback)((function(e){var t=e||{},n=t.selected,r=t.data,o=B(r||[]);I(o||[]),y(n||"")}),[B]),L=(0,w.useCallback)((function(e,t){d(yr,[i,O,D,e||""]),y(e)}),[i,O,D,d,y]),U=(0,w.useCallback)((function(e){"failure"===(null==e?void 0:e.state)&&(v((null==e?void 0:e.message)||"双向关联失败","error"),y(""))}),[]);(0,w.useEffect)((function(){i&&O&&D&&d("getAvailableAssociationFields",[i,O,D])}),[D,O,i,d]),(0,w.useEffect)((function(){return k.eventBus.on(hr,j),k.eventBus.on(yr,U),k.eventBus.on(vr,S),function(){k.eventBus.off(hr,j),k.eventBus.off(yr,U),k.eventBus.off(vr,S)}}),[]);(0,w.useMemo)((function(){var e=null==A?void 0:A[a.Key];return!D||0===(null==e?void 0:e.length)}),[D,A,a]);return F().createElement("div",{className:"".concat(_,"-box")},F().createElement(k.NameTipWrapper,{nameHidden:l,className:t,name:r,tips:o,required:c,title:u}),F().createElement(Vn.Select,{allowClear:!0,value:h,disabled:!1,options:E,onChange:L}))}));ed.displayName="AssociationEditor";var td=ed,nd=function(){var e=[];return[[gc,"switchtabsel",""],[vo,"customoption",""],[Bc,"selectoption",""],[Hc,"datascope",""],[zs,"Tab",""],[eu,"picturedef",""],[Ps,"refbilltype",""],[Zc,"refbillprops",""],[su,"dataFill",""],[gu,"inputrange",""],[hu,"DateRange",""],[bu,"date",""],[wu,"decimaldef",""],[Iu,"attachdef",""],[Pu,"backcolor"],[Bu,"backimage"],[as,"displayrule"],[Vf,"bizrule"],[Xf,"formularule"],[is,"textdef",""],[fs,"triggerprocess"],[Ts,"enablefilter"],[pf,"inputContent"],[ws,"richtextdef"],[Rs,"margin"],[Ls,"inputForm"],[Vs,"mulrefbilldef"],[$f,"iconPicker",""],[td,"association"]].forEach((function(t){var n=(0,s.c)(t,3),r=n[0],o=n[1],a=n[2];e.push([o,r,a])})),e};function rd(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function od(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rd(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):rd(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var ad={BizappId:"bizappId",Name:"name",Id:"id",appNum:"formId",Key:"key",EntityId:"rootEntityId"},id=function(e,t){p()(t).forEach((function(n){Or()(e,n)||(0,R.c)(e,(0,f.c)({},n,t[n]))}))},ld=function(e){return(0,ht.produce)(e,(function(e){e.forEach((function(t){(function(e){return e._Type_===Le&&!e.GroupParentId&&!e.GroupIndex&&!e.isTab})(t)&&(t.GroupParentId=(0,k.createUUid)(),t.GroupIndex=0,m()(e).call(e,(function(e){return e.ParentId===t.Id&&function(e){return e._Type_===Le&&!e.GroupParentId&&!e.GroupIndex&&e.isTab}(e)})).forEach((function(e,n){e.GroupParentId=t.GroupParentId,e.GroupIndex=n+1,e.ParentId=t.ParentId})))}))}))},cd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,we.cloneDeep)(e),r=n.formmeta,o=n.entitymeta,a={},i={},l=r.Items[0].Id,c=[l],u=new(Pe()),d={},v=E()(t).reduce((function(e,t){return od(od({},e),(n=t,a=(0,s.c)(n,2),i=a[0],l=a[1],c=null==l||null===(r=l.formmeta)||void 0===r||null===(r=r.Items)||void 0===r?void 0:r.reduce((function(e,t){return To(To({},e),{},(0,f.c)({},t.Id,t))}),{}),null==l||null===(o=l.entitymeta)||void 0===o||null===(o=o.Items)||void 0===o?void 0:o.reduce((function(e,t){var n;return To(To({},e),{},(0,f.c)({},b()(n="".concat(t.Key,"_")).call(n,i),Po((null==c?void 0:c[t.Id])||{},t)))}),{})));var n,r,o,a,i,l,c}),{});p()(r).forEach((function(e){r[e]&&ad[e]&&(a[ad[e]]=r[e])}));var g=r.Items.reduce((function(e,t){var n,r=t||{},o=r._Type_,a=r.Id,i=r.FieldType;return Ut(o)&&c.push(a),at(i)||it(i)?b()(n=[]).call(n,(0,M.c)(e),[a]):e}),[]),h=o.Items.reduce((function(e,t){var n,r=t||{},o=r._Type_,a=r.Id,i=r.SourceForm,s=r.ParentId||l;return d[a]=t,it(o)&&"2"===i&&u.set(a,t),it(o)&&wo(t)&&S()(c).call(c,s)?b()(n=[]).call(n,(0,M.c)(e),[t.Id]):e}),[]);return a[z]=ld(r.Items.reduce((function(e,t){var n=od({},t);if(null!=n&&n.ParentId){var a=n.FieldId||n.EntryId||n.CardEntryId,s=null==d?void 0:d[a];s&&(n.EntityData=s,n.ApType=n._Type_,n._Type_=s._Type_,n.FieldType=s._Type_,id(n,s))}else{var f,p=Te()(f=o.Items).call(f,(function(e){return(null==e?void 0:e.Id)===n.Id}));p&&(n.EntityData=p,id(n,p))}var y=n.ParentId,C=n.Key,E=n.EntityData;n._isEntryField_&&delete n._isEntryField_,S()(g).call(g,y)&&(n._isEntryField_=!0);var I,x=n.ParentId||l;if(S()(c).call(c,x)&&wo(n)||S()(h).call(h,x))return i[n.Id]=n,e;if(u.has(y)){var N,T,A=C.toLowerCase().replace("_".concat(y.toLowerCase()),"")+"_"+u.get(y).BillEntityIdEx,w=v[A];if(w){var F,k=[{},{}];Qe.forEach((function(e){n[e]&&(k[0][e]=n[e]),E[e]&&(k[1][e]=E[e])}));var D=_o(w,y,k);return delete(t=od({},D)).EntityData,d[D.Id]=D.EntityData,b()(F=[]).call(F,(0,M.c)(e),[D])}return o[z]=m()(N=o[z]).call(N,(function(e){return e.Id!==n.Id})),r[z]=m()(T=r[z]).call(T,(function(e){return e.Id!==n.Id})),e}return b()(I=[]).call(I,(0,M.c)(e),[n])}),[])),o.Items=T()(d),[a,i,n]},ud=function(e,t){var n,r,o=e||{},a=o._Type_,i=o.EntityData,l=void 0===i?{}:i,c=o.ApType,u=od({},e);c&&(u._Type_=c);var s=b()(n=m()(r=p()(l)).call(r,(function(e){return t.getControlMetaProperty(a,e).Tag===_e}))).call(n,["EntityData","ApType","_isEntryField_"]);return s.forEach((function(e){delete u[e]})),u},sd=function e(t,n){return t.reduce((function(t,r){var o,a=r.Id;return n[a]?b()(t).apply(t,b()(o=[r]).call(o,(0,M.c)(e(n[a],n)))):b()(t).call(t,r)}),[])},fd=function(e,t,n,r){var o=n.meta,a=e.entitymeta,i=e.formmeta,l=t.Items,c=void 0===l?[]:l,u=c.reduce((function(e,t){var n=t.ParentId;return void 0!==n&&(void 0===e[n]?e[n]=[t]:e[n].push(t)),e}),{}),s=sd([c[0]],u),f=s.reduce((function(e,t){var n=t.Key,o=t.EntityData;t.Id;if(o){var a,i,l=od(od({},o),{},{Key:n});if(it(l._Type_)){var c,u,s,f=od({},null===(c=r[l.RefBillId])||void 0===c?void 0:c.EntityData);return f.Key=null===(u=r[l.RefBillId])||void 0===u?void 0:u.Key,b()(s=[]).call(s,(0,M.c)(e),[l,f])}var d=null==r||null===(a=r[null==l?void 0:l.RefTableId])||void 0===a?void 0:a.EntityData;if($e(l._Type_)&&null!=l&&l.RefTableId&&d){var p,v=T()(r).reduce((function(e,t){var n;return t.ParentId===(null==l?void 0:l.RefTableId)?b()(n=[]).call(n,(0,M.c)(e),[t.EntityData]):e}),[]);return b()(p=[]).call(p,(0,M.c)(e),[l,d],(0,M.c)(v))}return b()(i=[]).call(i,(0,M.c)(e),[l])}return e}),[]),d=s.reduce((function(e,t){var n,a=t||{},i=a.RefTableId,l=a.FieldType,c=a.RefBillId,u=ud(t,o);if(it(l)){var s,f=ud(r[c],o);return b()(s=[]).call(s,(0,M.c)(e),[u,f])}var d=null==r?void 0:r[i];if($e(l)&&i&&d){var p,v=T()(r).reduce((function(e,t){var n;return t.ParentId===i?b()(n=[]).call(n,(0,M.c)(e),[ud(t,o)]):e}),[]);return b()(p=[]).call(p,(0,M.c)(e),[u,ud(d,o)],(0,M.c)(v))}return b()(n=[]).call(n,(0,M.c)(e),[u])}),[]),p=od(od({},i),{},{Items:d}),v=od(od({},a),{},{Items:f});return(0,R.c)(e,{formmeta:p,entitymeta:v})},dd=function(e){var t=e.kdesignerApi,n=e.keywordMapping;return function(e,r,o,a){var i=t.current.meta,l="string"==typeof r?r:r[n.type],c=i.getControlMeta(l)||{},u=c.BaseType,s=c.ApType,f=null==s?void 0:s.Default,d="string"==typeof e?e:e[n.type],p=i.getControlMeta(d)||{},v=p.BaseType,m=p.ApType,g=p.Id,h=m?(null==m?void 0:m[u])||(null==m?void 0:m.Default):g;if(!a.IsContainer)return!1;var y=function(e){var t=i.getControlMeta(e).NotAccept;if(t){var n=t.Ids;return null==n?void 0:S()(n).call(n,h)}}(l);if(y)return{message:"控件类型不符合，不能添加。",success:!1};if(!(y=function(e){var t=i.getControlMeta(e).Accept;if(!t)return!0;if(t){var n=t.Basetypes,r=t.Ids;return(null==r?void 0:S()(r).call(r,h))&&(null==n?void 0:S()(n).call(n,v))}}(l)))return{message:"控件类型不符合，不能添加。",success:!1};return!!(y=function(e){var t=i.getControlMeta(e).AcceptParent;if(!t)return!0;if(t){var n=t.Basetypes,r=t.Ids;return(null==r?void 0:S()(r).call(r,f))||(null==n?void 0:S()(n).call(n,u))}}(d))||{message:"父容器类型不符合,不能添加。",success:!1}}},pd=["property"],vd={},md=(0,w.memo)((function(e){var t=e.tabName,n=e.tabKey;if(!S()(pd).call(pd,n))return t;var r=(0,w.useContext)(ae),o=r.getKdesignerApi,a=r.prefixCls,i=(0,w.useMemo)((function(){return o()}),[]),l=i.error,c=i.meta,u=i.data,f=i.selection,d=l.getError(),v=f.getSelection(),m=(0,w.useState)(!1),g=(0,s.c)(m,2),h=g[0],y=g[1],b=(0,w.useState)([]),C=(0,s.c)(b,2),E=C[0],I=C[1];(0,k.useErrorChangeForceUpdateEffect)(i),(0,k.useSelectionChangeForceUpdateEffect)(i),(0,w.useEffect)((function(){var e;if((null==v?void 0:v.length)>0&&(null===(e=p()(d))||void 0===e?void 0:e.length)>0){var t=v.some((function(e){var t=u.findControl(e)._Type_,n=c.getControlMetaPropertyGroups(t);if(d[e]){var r=p()(d[e]);if(I(r),r.length>0){var o=vd[t];o||(o=[],n.forEach((function(e){null!=e&&e.Nodes&&(null==e||e.Nodes.forEach((function(e){o.push(e.Id)})))})),vd[t]=o);var a=r[0];return S()(o).call(o,a)}}return!1}));y(t)}else h&&y(!1)}),[v,d]);var x=(0,w.useMemo)((function(){return 0===(null==E?void 0:E.length)?"":"存在有".concat(null==E?void 0:E.length,"条错误，请修复后再发布！")}),[E]);return F().createElement("div",{className:"".concat(a,"_customtab")},F().createElement("span",{className:"".concat(a,"_customtab_name")},t),h&&F().createElement(P.Tooltip,{tip:x},F().createElement(Pi,{className:"".concat(a,"_customtab_icon")})))}));md.displayName="CustomTab";var gd=md;n(3192);function hd(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function yd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hd(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):hd(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}var bd={appFormList:[],innerForm:[]},Cd=(0,ht.produce)((function(e,t){var n,r,o=t.key,a=t.payload,i=(null==e?void 0:e[null==a?void 0:a.form])||{},l=i.data,c=void 0===l?{}:l,u=i.ids,s=void 0===u?[]:u,f=c||{},d=f.entitymeta,p=void 0===d?{Items:[]}:d,v=f.formmeta,g=void 0===v?{Items:[]}:v;switch(o){case Kr:for(var h in a){var y;if(Object.prototype.hasOwnProperty.call(a,h))e[h]={data:a[h],ids:x()(y=a[h].entitymeta.Items).call(y,(function(e){return e.Id}))}}break;case Vr:e[a.form]=a.info;break;case Gr:if(null==s||!S()(s).call(s,a.data.Id)){var b,C;a.data.ParentId=S()(b=a.form).call(b,"_table")?a.data.ParentId:a.form,a.data.EntityData.ParentId=S()(C=a.form).call(C,"_table")?a.data.EntityData.ParentId:a.form;var E=yd({},a.data);delete E.EntityData,null!=e&&e[null==a?void 0:a.form]?(p.Items.push(a.data.EntityData),g.Items.push(E)):e[a.form]={data:{entitymeta:{Items:[a.data.EntityData]},formmeta:{Items:[E]}},ids:[]}}break;case Hr:p.Items=m()(n=p.Items).call(n,(function(e){return e.Id!==a.id})),g.Items=m()(r=g.Items).call(r,(function(e){return e.Id!==a.id}));break;case zr:p.Items.some((function(e){return e.Id===a.id&&(e=(0,R.c)(e,a.data),!0)})),g.Items.some((function(e){return e.Id===a.id&&(e=(0,R.c)(e,a.data),!0)}));break;case qr:e.appFormList=a.data,e.innerForm=a.innerForm;break;case"COPY_FORM_DATA":e[a.form]=yd({},e[a.source])}}));function Ed(){var e=[],t=[],n=1,r=0,o={setData:function(e){if(e){var n=t;t=e,o.fireEvent({value:t,oldValue:n})}},getData:function(){return t},getDataVersion:function(){return r},setDataVersion:function(e){r=e},increaseVersion:function(){n++},getVersion:function(){return n},isVersionEqual:function(){return n===r},addDataChangeListener:function(t){return e.push(t),function(){e=m()(e).call(e,(function(e){return e!==t}))}},fireEvent:function(t){e.forEach((function(e){try{e(t)}catch(e){}}))}};return o}function Id(e,t){var n=p()(e);if(a()){var r=a()(e);t&&(r=m()(r).call(r,(function(t){return l()(e,t).enumerable}))),n.push.apply(n,r)}return n}function xd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Id(Object(n),!0).forEach((function(t){(0,f.c)(e,t,n[t])})):u()?Object.defineProperties(e,u()(n)):Id(Object(n)).forEach((function(t){Object.defineProperty(e,t,l()(n,t))}))}return e}(0,ht.enableES5)(),k.ControlView.tabName="内容";var Nd={id:"Id",type:"_Type_",name:"Name",key:"Key",parentId:"ParentId",items:"Items",fieldType:"FieldType",EntityData:"EntityData"},Td=function(e,t){return xd(xd({},e),t)},Ad=function e(t){return t.reduce((function(t,n){var r=n.selectable,o=n.children,a=n.value,i=n.label;return!1!==r&&(t[a]=i),null!=o&&o.length?xd(xd({},t),e(o)):t}),{})},Sd=(0,w.memo)((0,w.forwardRef)((function(e,t){var n=e.data,o=void 0===n?{}:n,a=e.meta,i=void 0===a?{}:a,l=e.onData,c=e.settingData,u=e.showMessage,d=void 0===u?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";P.Message[t]({content:e,closable:"error"===t,duration:2e3,style:{background:"#fff",borderColor:"#fff",color:"#212121",boxShadow:"0 4px 10px 1px rgba(0,0,0,0.12)"}})}:u,v=(e.handleCustomInputEditor,e.invokeAction),g=void 0===v?function(e,t,n){}:v,y=e.enforceInvokeAction,C=void 0===y?function(e,t,n){}:y,I=e.baseHooks,N=e.baseUrl,A=e.onApi,D=e.onDownLoad,M=e.addControlAction,R=e.getControlText,_=e.batchInvoke,O=e.floatMenu,B=e.defaultFieldStatusMap,j=void 0===B?{}:B,L=e.fieldStatusSettingMode,U=void 0!==L&&L,K=e.fieldStatusSettingOptions,V=e.expression,z=void 0===V?[]:V,G=e.refBillData,H=void 0===G?[]:G,q=e.tableMetas,Y=void 0===q?[]:q,W=e.compareTypes,Q=void 0===W?{}:W,X=e.ncpToolKits,Z=void 0===X?{}:X,J=(0,w.useState)(!0),$=(0,s.c)(J,2),ee=$[0],te=$[1],ne=(0,w.useRef)(null),re=(0,w.useRef)(o),oe=(0,w.useRef)({}),ie=(0,w.useRef)([]),le=(0,w.useReducer)(Cd,bd),ce=(0,s.c)(le,2),ue=ce[0],se=ce[1],fe=(0,w.useRef)({}),de=(0,w.useRef)(null),pe=(0,w.useRef)(jt(o,i)),ve=(0,w.useRef)(function(e){var t,n=e.formmeta,r=null==n||null===(t=n.Items)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.BillNoSetting;return r?JSON.parse(r):{}}(o)),me=(0,w.useRef)([]),ge=(0,w.useRef)([]),he=(0,w.useReducer)(Td,j||{}),ye=(0,s.c)(he,2),be=ye[0],Ce=ye[1],Ee=(0,w.useRef)(Ed()),Ie=(0,w.useRef)(Ed()),xe=(0,w.useCallback)((function(e){return e}),[]),Ne=(0,w.useMemo)((function(){return function(e,t){return(0,k.adaptorMeta)(e,(0,k.mergeTransformKeyMap)(k.transformKeyMap,(0,f.c)({},"items",["Enum"])),t)}(i,o.formmeta)}),[]),Te=(0,w.useMemo)((function(){var e=Y.reduce((function(e,t){return null!=t&&t.billEntityIdEx?xd(xd({},e),{},(0,f.c)({},t.billEntityIdEx,t.data)):e}),{}),t=cd(o,(0,we.cloneDeep)(e)),n=(0,s.c)(t,3),r=n[0],a=n[1],i=n[2];return oe.current=a,re.current=i,null==l||l(i),p()(e).length&&se({key:Kr,payload:e}),r}),[o,Y]);(0,w.useEffect)((function(){fe.current=ue}),[ue]);var Ae=(0,w.useCallback)((function(){return(0,we.cloneDeep)(oe.current)}),[]),Se=(0,w.useCallback)((function(e){oe.current=e}),[]),Fe=(0,w.useCallback)((function(e){var t=(null==c?void 0:c[e])||{},n=t.value,r=t.items,o=void 0===r?[]:r;return!n||p()(o).reduce((function(e,t){return!1===o[t].value&&e.push(t),e}),[])}),[c]),ke=(0,w.useCallback)((function(e){(0,Z.publishUserEvent)(xd({appId:Te.bizappId,formId:Te.id},e))}),[Z]),De=(0,w.useCallback)((function(e){switch(e){case"main":return{main:Xi};case"left":return{control:k.ControlView,systemCategories:Ul,outline:hl};case"right":return{property:El};default:return{}}}),[]),Pe=(0,w.useMemo)((function(){return{showMessage:d,getViews:De,processPropertyName:xe,keywordMapping:Nd,enableSearch:!0,enableError:!0,dataPortalIdPrefix:"nocode-designer-top-view",controlViewSetting:{className:"".concat(Me,"-control-view"),hideHelpIcon:!0,hideAnchorIcon:!0,hideTitleTips:!0,searchInputPlaceholder:"内容",filterCategories:function(e){return m()(e).call(e,(function(e){var t;return!(null!=e&&null!==(t=e.Id)&&void 0!==t&&h()(t).call(t,"System_"))}))},handleItemClick:function(){ke({eventName:"click",action:"fd_add_click"})},getEmptyView:function(){return F().createElement(F().Fragment,null,F().createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOAAAACACAMAAAAlB5WJAAAAjVBMVEUAAADh4uvY3+rZ3erb3enY3+rX3ufZ3e3X3OfZ3Ord3uTX3efY3urX4uvX3efW3OjZ4Onb4Ovj6fPj6fPX3ejn7/bk6PPi5/Tj6fTj6fPj6fTk6fXj6PTi6PTi6PTj5/Ti6fPj6fTk6PTj6fPh5fLj6fPj6vPi6PPk6fXL0NzX3Oji6PPi6PPK0NvX3ehGj5HoAAAALHRSTlMAGhcSJSwiCTIOBj4oDDlENUbD7UoreU7ixq6gh1vMPd3SkfFmgG2ZZvD3u03m2McAAAUISURBVHja7NgLjpswFAVQvxlCKoiSgMdg/oSQTKTe/a+vlaoKw5BOAFV6RpwdWLbv+4jNZrPZbDb/hYqjLLxoCUh9CbMoVmI91D2V+EKm91Uc0rnVeKq+OcJuRYJvJIWwlveo8YL64QkrFRov0jbeogoxQWhb3ng5JsqteqdOiclKiwI1lphBxsISEWaKhBUazNYI/rwUo2Sat8F557q7c9DmqcSolH/UpBhRRhUNVFGJEalgrsEX16aiUVVzte6VRhiS+YGeOuTSrqSJMZQp+ieVYYhxtXAk+nRM34o1+iTbiu+V6EsUvUAl6Cu5RmmOvsyll7gZ+nLBkkJfRC+L0MdztgjRU9AEBXpCwVAxcn+z75DhBOxpmDKaKINJ88uZB0yJSxO5CUwPwU0Ng1Y0mdIw1IKZAqaYZohZ/8Jk5AMu+oaJYMWBQSqaRUkYeDVsNxhymimH4SY4MSPmeqCZDleuMaNgaGi2hmu/doehotkqGO6CjxSdkhYoma5n5PMmdH5LKgUbatELNVU8P2GMjqRFJMvlTIROSoukLPdr2ViVX17rM8FFiE5Li7Qs5/oLOgEtEqBzEVxodM60yBkdLbiQ6OxokR3LQgiDS4u4MAguVn/AdT/R/fvbekPm3Tl+/KZXWibI//jjsspC/+YHf/1cY6u2Czqf62u298eToTemumsYl/b+yVTA0Dr2D7z7o99zuqLz+eFav7L44Q+EZrjHJ9uXTq4/1MDQxke714a/2rn73kZBOIDjPx5EFLWP197tMb3dXdOO7v2/vMOwNLhpCxQWR/xgNPOvfdPELRWoRSPU0TTvV+VRGu62W/qtv/itms/M/2VetmsR7av7HLOK84qhHGLJ5z320nC/XtMoL18KKtZnoiogCsZNcz5XB9/K7kfYRHh9VvD1B5xABCqqM7SdNNwtZsFfgJbZokdWQmg177WRpn8zGvgVdiFmvQSBYPKiyAFw1ov/7E7C42EnIWAxG4IhCMJ0CK2yfn+l6UkEnUaCZmImhDp16HtBCkmVXcNX0nQXciIQERcRuBWqLGyiTeXKG3FZHrtPe4o1GS8TlzUZ3ARTO9tI0ylJcxWGG+TU1j7OhNisuYrDDRCzRXcxpjSTuQUC3nLGkO14fokwKZ1yCxV4IwgxpOjzleufCMsKuBXwhhHSn49xGfwZPdy+MOTIwUS4FeIfiDHCSB3nqzZw//7WpT1vp0OnEGVWUEna34KU7oGOvBZnmX2nbiHL3LA6ciDyWl5n9rWFz6+r3QZaNHPFwAlxtpdedJ92lK1l3QZWzmgeN5A8SE/Hk/Ym5bmQ+ihdAgvnQR49Fynzg9mnC6kPBvYKHz88l5nzg+4zCinzGQSs1V7Ib+lIbxSgClWfWZgxL2At9+S51QM/yq6niiGPkUcP9Nys41lqZiFSGHI7Y7BVevLcbuVVfvKLIifhAqEEUKdevhvmrGRfIXYHXuJvebSTg4UIu5zBS/xNqzb9HzPDCsFE0ResxxnB7T3jCn7ibzu2HCg8R+lIQ/8dGKt6oBCRy75N4HBhYSLqUEPruw/jNVxobdyBg4W4dgBjNlC4xLk9GLWhQpJK4HBhaWl8y9QtC0f8+A9UOOrHY5DCcT8fp0KLwj0kY6AQQzL6CxeQjt7CChLyXjjiXS6CF64ySMuHwtUcUlMv0+5rC9PuawvT7msL0+5Thfv270Nqz88OvEjq7/tkMplMJl/uP6GQwUEv7e1KAAAAAElFTkSuQmCC",alt:"搜索无结果",className:"".concat(Me,"-control-empty-img")}),F().createElement("span",{className:"".concat(Me,"-control-empty-img")},"暂无搜索结果"))},hideItemView:Fe("Categories"),onDragStart:function(e,t,n){pn(e,t,n)}},propertyViewSetting:{className:"".concat(Me,"-property-view"),hideItemView:Fe("Property")},getOutlineItemIcon:function(e){return F().createElement(P.Icon,{prefix:"designericon",type:sn(e),className:"nocode-designer-control-icon"})},canAddCallback:dd({showMessage:d,kdesignerApi:ne,keywordMapping:Nd}),preHandle:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vc.apply(void 0,b()(t).call(t,[xd(xd({},ne.current||{}),{},{billPropsData:fe.current,invokeAction:g,getHideFieldRef:Ae,setHideFieldRef:Se,dispatchBillData:se})]))},getPropertyEditors:nd,filterProperty:fi,renderCustomTab:function(e,t){return F().createElement(gd,t)}}}),[d,De,xe,nd,Fe,Ae,Se,se]),Re=(0,w.useCallback)((function(){return pe.current}),[]),_e=(0,w.useCallback)((function(e){pe.current=e,re.current.sysSetting=e;var t=Ee.current.increaseVersion,n=Ie.current.increaseVersion;t(),n()}),[]),Oe=(0,w.useCallback)((function(){return ve.current}),[]),Be=(0,w.useCallback)((function(e){ve.current=e,re.current.billNoSetting=e;var t=Ee.current.increaseVersion,n=Ie.current.increaseVersion;t(),n()}),[]),je=(0,w.useCallback)((function(e){me.current=e}),[]),Le=(0,w.useCallback)((function(e){ge.current=e}),[]),Ue=(0,w.useCallback)((function(){return ee?"pc":"mobile"}),[ee]),Ke=(0,w.useCallback)((function(e,t){var n=(0,we.cloneDeep)(fe.current),r=E()(n).reduce((function(e,t){var n;return null!==(n=t[1])&&void 0!==n&&n.data?xd(xd({},e),{},(0,f.c)({},t[0],t[1].data)):e}),{}),o=cd(e,r),a=(0,s.c)(o,3),i=a[0],l=a[1],c=a[2];oe.current=l,re.current=c,null==t||t.data.resetData(i,!1)}),[]),Ve=(0,w.useCallback)((function(e,t){k.eventBus.emit(e,t)}),[]),ze=(0,w.useCallback)((function(e){ne.current=xd(xd({},e),{},{originApi:e,selection:xd(xd({},e.selection),{},{getActiveSelectedId:function(){return e.selection.getActiveSelectedId()||e.data.getRootId()}}),controlCacheApi:r}),A({kdesignerApi:ne.current,getDesignerClientType:Ue,fieldStatusMap:be,resetDesignerData:Ke,getSystemSetting:Re,getBillnoSetting:Oe,pubEvent:Ve})}),[A,Ue,be]),Ge=(0,w.useCallback)((function(e,t){re.current=fd(re.current,e,ne.current,oe.current),re.current.sysSetting=Re(),re.current.billNoSetting=Oe(),re.current.setting=c,l&&l(re.current,t);var n=Ee.current.increaseVersion,r=Ie.current.increaseVersion;n(),r()}),[c]);(0,w.useEffect)((function(){A({kdesignerApi:ne.current,fieldStatusMap:be,getDesignerClientType:Ue,resetDesignerData:Ke,getSystemSetting:Re,getBillnoSetting:Oe,pubEvent:Ve})}),[Ue,be]),(0,w.useEffect)((function(){var e=null==Te?void 0:Te.id;g("getFormRules",[{formId:e,fieldKey:""}]),g("getBizRules",[{formId:e,fieldKey:""}]),C("listtreeconfig",[e,"formula"])}),[]),(0,w.useEffect)((function(){return k.eventBus.on(or,je),k.eventBus.on(lr,Le),function(){k.eventBus.off(or,je),k.eventBus.off(lr,Le)}}),[]);var He=function(e){var t=null==Te?void 0:Te.id,n=e.args,r=e.data,o=n||{},a=o.formId,i=o.param,l=(void 0===i?{}:i).sourceType;if(""===a||a===t){var c="formula"===l?Ee.current:Ie.current,u=c.setData,s=c.setDataVersion,f=c.getVersion;u(r),s(f())}};(0,w.useEffect)((function(){return k.eventBus.on(rr,He),function(){k.eventBus.off(rr,He)}}),[]);var qe=(0,w.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";window.requestAnimationFrame((function(){var t="formula"===e?Ee.current:Ie.current,n=t.isVersionEqual,r=t.getVersion;if(!n()){var o=null==Te?void 0:Te.id;if(1!==r()){var a="formula"===e?["","formula"]:[""],i=[{nocodeformdesigner:re.current}];g("listtreeconfig",a,i)}else{g("listtreeconfig","formula"===e?[o,"formula"]:[o])}}}))}),[]);(0,w.useEffect)((function(){if(null!=H&&H.children){var e=H.children,t=void 0===e?[]:e;t[0].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"gerenzhongxin",style:{color:"#3987ED"}}),t[1].icon=F().createElement(P.Icon,{prefix:"nocodeplatformicon",type:"zuzhi",style:{color:"#3987ED"}});var n=So(t),r=(0,s.c)(n,2),o=r[0],a=r[1];se({key:qr,payload:{data:o,innerForm:a}})}}),[H]);var Ye=(0,w.useMemo)((function(){return Ad((null==H?void 0:H.children)||[])}),[H]),We=(0,w.useRef)({getKdesignerApi:function(){return ne.current},getExpressionData:function(){return z},getRefBillData:function(){return H},getRefBillNameMap:function(){return Ye},getCompareTypes:function(){return Q},getDataRef:function(){return re.current},getCurrentRefBillPropsData:function(){return ie.current},getDisplayRules:function(){return me.current},getBizRules:function(){return ge.current},setCurrentRefBillPropsData:function(e,t){ie.current[e]=t},fetchListTree:qe,curFormulaTreeApi:Ee.current,curListTreeApi:Ie.current,getSystemSetting:Re,setSystemSetting:_e,getBillnoSetting:Oe,setBillnoSetting:Be,setDisplayRules:je,setBizRules:Le,getHideFieldRef:Ae,setHideFieldRef:Se,showMessage:d,invokeAction:g,baseUrl:N,prefixCls:Me,getPrefixCls:function(e,t,n){var r;return n||(e=e||Me,t?b()(r="".concat(e,"-")).call(r,t):e)},getBaseHooks:function(e){return(null==I?void 0:I[e])||function(){}},onDownLoad:D,addControlAction:M,getControlText:R,batchInvoke:_}),Qe=(0,w.useMemo)((function(){return xd({isPC:ee,setIsPC:te,floatMenu:O,fieldStatusSettingMode:U,fieldStatusSettingOptions:K,fieldStatusMap:be,billPropsData:ue,pubUIAction:ke,dispatchFieldStatus:Ce,dispatchBillData:se},We.current)}),[ee,U,O,K,be,ue,ke,se]),Xe=(0,w.useCallback)((function(){var e,t=x()(e=T()(De("right"))).call(e,(function(e){return(null==e?void 0:e.tabKey)||""})),n=Fe("Property");return ne.current&&!0!==n?m()(t).call(t,(function(e){return!0})):t}),[Fe]),Ze=(0,w.useCallback)((function(){var e,t=x()(e=T()(De("left"))).call(e,(function(e){return(null==e?void 0:e.tabKey)||""})),n=Fe("Categories");return!0===n?t:m()(t).call(t,(function(e){return null==n||!S()(n).call(n,e)}))}),[Fe]);return(0,w.useEffect)((function(){var e=function(){var e=ne.current.views,t=e.getViewVisibleKeys("left"),n=e.getViewVisibleKeys("right"),r=Ze(),o=Xe();(0,we.isEqual)(r,t)||e.setViewsVisibleSetting("left")(r),(0,we.isEqual)(o,n)||e.setViewsVisibleSetting("right")(o)},t=ne.current.selection.addSelectChangeListener(e);return e(),function(){t&&t()}}),[c]),F().createElement(F().Fragment,null,F().createElement(P.ConfigProvider,{value:{prefixCls:"kdesigner"}},F().createElement(ae.Provider,{value:Qe},F().createElement(wd,{className:"".concat(Me,"-root"),ref:de,globalConfig:Pe,onData:Ge,meta:Ne,data:Te,onApi:ze}))))}))),wd=D();Sd.displayName="NoCodeDesigner";var Fd=Sd},3192:function(){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t}(),t=[],n=null,r=null;i.prototype.THROTTLE_TIMEOUT=100,i.prototype.POLL_INTERVAL=null,i.prototype.USE_MUTATION_OBSERVER=!0,i._setupCrossOriginUpdater=function(){return n||(n=function(e,n){r=e&&n?f(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},t.forEach((function(e){e._checkForIntersections()}))}),n},i._resetCrossOriginUpdater=function(){n=null,r=null},i.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},i.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},i.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]}))},i.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},i.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var r=this._checkForIntersections,a=null,i=null;this.POLL_INTERVAL?a=n.setInterval(r,this.POLL_INTERVAL):(l(n,"resize",r,!0),l(t,"scroll",r,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(i=new n.MutationObserver(r)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push((function(){var e=t.defaultView;e&&(a&&e.clearInterval(a),c(e,"resize",r,!0)),c(t,"scroll",r,!0),i&&i.disconnect()}));var u=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=u){var s=o(t);s&&this._monitorIntersections(s.ownerDocument)}}},i.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var r=this.root&&(this.root.ownerDocument||this.root)||e,a=this._observationTargets.some((function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=r;){var a=o(n);if((n=a&&a.ownerDocument)==t)return!0}return!1}));if(!a){var i=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),i(),t!=r){var l=o(t);l&&this._unmonitorIntersections(l.ownerDocument)}}}},i.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()},i.prototype._checkForIntersections=function(){if(this.root||!n||r){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(r){var o=r.element,i=u(o),l=this._rootContainsTarget(o),c=r.entry,s=e&&l&&this._computeTargetAndRootIntersection(o,i,t),f=null;this._rootContainsTarget(o)?n&&!this.root||(f=t):f={top:0,bottom:0,left:0,right:0,width:0,height:0};var d=r.entry=new a({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:i,rootBounds:f,intersectionRect:s});c?e&&l?this._hasCrossedThreshold(c,d)&&this._queuedEntries.push(d):c&&c.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},i.prototype._computeTargetAndRootIntersection=function(t,o,a){if("none"!=window.getComputedStyle(t).display){for(var i,l,c,s,d,v,m,g,h=o,y=p(t),b=!1;!b&&y;){var C=null,E=1==y.nodeType?window.getComputedStyle(y):{};if("none"==E.display)return null;if(y==this.root||9==y.nodeType)if(b=!0,y==this.root||y==e)n&&!this.root?!r||0==r.width&&0==r.height?(y=null,C=null,h=null):C=r:C=a;else{var I=p(y),x=I&&u(I),N=I&&this._computeTargetAndRootIntersection(I,x,a);x&&N?(y=I,C=f(x,N)):(y=null,h=null)}else{var T=y.ownerDocument;y!=T.body&&y!=T.documentElement&&"visible"!=E.overflow&&(C=u(y))}if(C&&(i=C,l=h,c=void 0,s=void 0,d=void 0,v=void 0,m=void 0,g=void 0,c=Math.max(i.top,l.top),s=Math.min(i.bottom,l.bottom),d=Math.max(i.left,l.left),v=Math.min(i.right,l.right),g=s-c,h=(m=v-d)>=0&&g>=0&&{top:c,bottom:s,left:d,right:v,width:m,height:g}||null),!h)break;y=y&&p(y)}return h}},i.prototype._getRootRect=function(){var t;if(this.root&&!v(this.root))t=u(this.root);else{var n=v(this.root)?this.root:e,r=n.documentElement,o=n.body;t={top:0,left:0,right:r.clientWidth||o.clientWidth,width:r.clientWidth||o.clientWidth,bottom:r.clientHeight||o.clientHeight,height:r.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(t)},i.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100})),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},i.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var o=0;o<this.thresholds.length;o++){var a=this.thresholds[o];if(a==n||a==r||a<n!=a<r)return!0}},i.prototype._rootIsInDom=function(){return!this.root||d(e,this.root)},i.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return d(n,t)&&(!this.root||n==t.ownerDocument)},i.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},i.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=i,window.IntersectionObserverEntry=a}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function a(e){this.time=e.time,this.target=e.target,this.rootBounds=s(e.rootBounds),this.boundingClientRect=s(e.boundingClientRect),this.intersectionRect=s(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,o=r.width*r.height;this.intersectionRatio=n?Number((o/n).toFixed(4)):this.isIntersecting?1:0}function i(e,t){var n,r,o,a=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(a.root&&1!=a.root.nodeType&&9!=a.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,o=null,function(){o||(o=setTimeout((function(){n(),o=null}),r))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(a.rootMargin),this.thresholds=this._initThresholds(a.threshold),this.root=a.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function l(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detachEvent&&e.detachEvent("on"+t,n)}function u(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function s(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function f(e,t){var n=t.top-e.top,r=t.left-e.left;return{top:n,left:r,height:t.height,width:t.width,bottom:n+t.height,right:r+t.width}}function d(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;return 9==t.nodeType&&t!=e?o(t):(n&&n.assignedSlot&&(n=n.assignedSlot.parentNode),n&&11==n.nodeType&&n.host?n.host:n)}function v(e){return e&&9===e.nodeType}}()},2504:function(e,t,n){"use strict";var r=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var o=r[n];e.call(t,o[1],o[0])}},t}()}(),o="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,a=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),i="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(a):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var l=["top","right","bottom","left","width","height","size","weight"],c="undefined"!=typeof MutationObserver,u=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,o=0;function a(){n&&(n=!1,e()),r&&c()}function l(){i(a)}function c(){var e=Date.now();if(n){if(e-o<2)return;r=!0}else n=!0,r=!1,setTimeout(l,t);o=e}return c}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){o&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),c?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){o&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;l.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),s=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},f=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||a},d=y(0,0,0,0);function p(e){return parseFloat(e)||0}function v(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+p(e["border-"+n+"-width"])}),0)}function m(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return d;var r=f(e).getComputedStyle(e),o=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var o=r[n],a=e["padding-"+o];t[o]=p(a)}return t}(r),a=o.left+o.right,i=o.top+o.bottom,l=p(r.width),c=p(r.height);if("border-box"===r.boxSizing&&(Math.round(l+a)!==t&&(l-=v(r,"left","right")+a),Math.round(c+i)!==n&&(c-=v(r,"top","bottom")+i)),!function(e){return e===f(e).document.documentElement}(e)){var u=Math.round(l+a)-t,s=Math.round(c+i)-n;1!==Math.abs(u)&&(l-=u),1!==Math.abs(s)&&(c-=s)}return y(o.left,o.top,l,c)}var g="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof f(e).SVGGraphicsElement}:function(e){return e instanceof f(e).SVGElement&&"function"==typeof e.getBBox};function h(e){return o?g(e)?function(e){var t=e.getBBox();return y(0,0,t.width,t.height)}(e):m(e):d}function y(e,t,n,r){return{x:e,y:t,width:n,height:r}}var b=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=y(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=h(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),C=function(e,t){var n,r,o,a,i,l,c,u=(r=(n=t).x,o=n.y,a=n.width,i=n.height,l="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(l.prototype),s(c,{x:r,y:o,width:a,height:i,top:o,right:r+a,bottom:i+o,left:r}),c);s(this,{target:e,contentRect:u})},E=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof f(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof f(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new C(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),I="undefined"!=typeof WeakMap?new WeakMap:new r,x=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=u.getInstance(),r=new E(t,n,this);I.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){x.prototype[e]=function(){var t;return(t=I.get(this))[e].apply(t,arguments)}}));var N=void 0!==a.ResizeObserver?a.ResizeObserver:x;t.c=N},1452:function(e,t,n){"use strict";var r=new Error;e.exports=new Promise((function(e,t){if("undefined"!=typeof designer_base)return e();n.l(window.DESIGNER_BASE_ENTRY,(function(n){if("undefined"!=typeof designer_base)return e();var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;r.message="Loading script failed.\n("+o+": "+a+")",r.name="ScriptExternalLoadError",r.type=o,r.request=a,t(r)}),"designer_base")})).then((function(){return designer_base}))},9768:function(e,t,n){"use strict";var r=new Error;e.exports=new Promise((function(e,t){if("undefined"!=typeof kd_libs)return e();n.l(window.KD_LIBS_ENTRY,(function(n){if("undefined"!=typeof kd_libs)return e();var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;r.message="Loading script failed.\n("+o+": "+a+")",r.name="ScriptExternalLoadError",r.type=o,r.request=a,t(r)}),"kd_libs")})).then((function(){return kd_libs}))},954:function(e,t,n){"use strict";var r=new Error;e.exports=new Promise((function(e,t){if("undefined"!=typeof nocode_component)return e();n.l(window.NOCODE_COMPONENT_ENTRY,(function(n){if("undefined"!=typeof nocode_component)return e();var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;r.message="Loading script failed.\n("+o+": "+a+")",r.name="ScriptExternalLoadError",r.type=o,r.request=a,t(r)}),"nocode_component")})).then((function(){return nocode_component}))},3440:function(e,t,n){e.exports=n(6128)},760:function(e,t,n){e.exports=n(1188)},6076:function(e,t,n){e.exports=n(104)},1848:function(e,t,n){e.exports=n(7444)},696:function(e,t,n){e.exports=n(8320)},1900:function(e,t,n){e.exports=n(3352)},8456:function(e,t,n){e.exports=n(120)},524:function(e,t,n){e.exports=n(8760)},3992:function(e,t,n){e.exports=n(8776)},3980:function(e,t,n){e.exports=n(7584)},4244:function(e,t,n){e.exports=n(4644)},1260:function(e,t,n){e.exports=n(9384)},1908:function(e,t,n){e.exports=n(8812)},5288:function(e,t,n){e.exports=n(9408)},3020:function(e,t,n){e.exports=n(2612)},4496:function(e,t,n){e.exports=n(9140)},2892:function(e,t,n){e.exports=n(2572)},2581:function(e,t,n){e.exports=n(7752)},4884:function(e,t,n){e.exports=n(5716)},7435:function(e,t,n){e.exports=n(6860)},4716:function(e,t,n){e.exports=n(9224)},3939:function(e,t,n){e.exports=n(424)},2400:function(e,t,n){e.exports=n(7052)},8429:function(e,t,n){e.exports=n(9516)},7348:function(e,t,n){e.exports=n(7768)},2796:function(e,t,n){e.exports=n(1576)},2272:function(e,t,n){e.exports=n(8436)},9308:function(e,t,n){e.exports=n(948)},9992:function(e,t,n){e.exports=n(9928)},3872:function(e,t,n){e.exports=n(456)},600:function(e,t,n){e.exports=n(4800)},5680:function(e,t,n){e.exports=n(8816)},1252:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=i(e,a(n)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=i(t,n));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},5280:function(e,t,n){"use strict";var r=n(6128);e.exports=r},4224:function(e,t,n){"use strict";var r=n(1324);e.exports=r},6188:function(e,t,n){"use strict";var r=n(984);e.exports=r},8404:function(e,t,n){"use strict";var r=n(2960);e.exports=r},9152:function(e,t,n){"use strict";var r=n(5720);e.exports=r},7296:function(e,t,n){"use strict";var r=n(5052);e.exports=r},5672:function(e,t,n){"use strict";var r=n(7339);e.exports=r},296:function(e,t,n){"use strict";var r=n(7584);e.exports=r},376:function(e,t,n){"use strict";var r=n(5608);e.exports=r},6404:function(e,t,n){"use strict";var r=n(8792);e.exports=r},9468:function(e,t,n){"use strict";var r=n(9224);e.exports=r},7144:function(e,t,n){"use strict";var r=n(9928);n(6536),n(7576),n(7772),n(5656),e.exports=r},9184:function(e,t,n){"use strict";var r=n(8308);e.exports=r},5920:function(e,t,n){"use strict";var r=n(6956);e.exports=r},9259:function(e,t,n){"use strict";n(4176),n(7572);var r=n(9832);e.exports=r.Array.from},3376:function(e,t,n){"use strict";n(3276);var r=n(9832);e.exports=r.Array.isArray},7160:function(e,t,n){"use strict";n(2216);var r=n(6180);e.exports=r("Array","concat")},8011:function(e,t,n){"use strict";n(4124);var r=n(6180);e.exports=r("Array","fill")},5592:function(e,t,n){"use strict";n(4864);var r=n(6180);e.exports=r("Array","filter")},4216:function(e,t,n){"use strict";n(8628);var r=n(6180);e.exports=r("Array","findIndex")},8256:function(e,t,n){"use strict";n(6952);var r=n(6180);e.exports=r("Array","find")},6184:function(e,t,n){"use strict";n(6504);var r=n(6180);e.exports=r("Array","includes")},4340:function(e,t,n){"use strict";n(1904);var r=n(6180);e.exports=r("Array","indexOf")},3844:function(e,t,n){"use strict";n(7092);var r=n(6180);e.exports=r("Array","map")},6368:function(e,t,n){"use strict";n(3948);var r=n(6180);e.exports=r("Array","push")},4792:function(e,t,n){"use strict";n(5863);var r=n(6180);e.exports=r("Array","slice")},4416:function(e,t,n){"use strict";n(8280);var r=n(6180);e.exports=r("Array","sort")},3612:function(e,t,n){"use strict";n(4152);var r=n(6180);e.exports=r("Array","splice")},7340:function(e,t,n){"use strict";n(340),n(2352);var r=n(6180);e.exports=r("Array","values")},2412:function(e,t,n){"use strict";n(4388);var r=n(6180);e.exports=r("Function","bind")},4556:function(e,t,n){"use strict";n(340),n(4176);var r=n(68);e.exports=r},4756:function(e,t,n){"use strict";var r=n(2360),o=n(2412),a=Function.prototype;e.exports=function(e){var t=e.bind;return e===a||r(a,e)&&t===a.bind?o:t}},8884:function(e,t,n){"use strict";var r=n(2360),o=n(7160),a=Array.prototype;e.exports=function(e){var t=e.concat;return e===a||r(a,e)&&t===a.concat?o:t}},6172:function(e,t,n){"use strict";var r=n(2360),o=n(1340),a=String.prototype;e.exports=function(e){var t=e.endsWith;return"string"==typeof e||e===a||r(a,e)&&t===a.endsWith?o:t}},8784:function(e,t,n){"use strict";var r=n(2360),o=n(8011),a=Array.prototype;e.exports=function(e){var t=e.fill;return e===a||r(a,e)&&t===a.fill?o:t}},680:function(e,t,n){"use strict";var r=n(2360),o=n(5592),a=Array.prototype;e.exports=function(e){var t=e.filter;return e===a||r(a,e)&&t===a.filter?o:t}},1231:function(e,t,n){"use strict";var r=n(2360),o=n(4216),a=Array.prototype;e.exports=function(e){var t=e.findIndex;return e===a||r(a,e)&&t===a.findIndex?o:t}},2600:function(e,t,n){"use strict";var r=n(2360),o=n(8256),a=Array.prototype;e.exports=function(e){var t=e.find;return e===a||r(a,e)&&t===a.find?o:t}},8180:function(e,t,n){"use strict";var r=n(2360),o=n(6184),a=n(4464),i=Array.prototype,l=String.prototype;e.exports=function(e){var t=e.includes;return e===i||r(i,e)&&t===i.includes?o:"string"==typeof e||e===l||r(l,e)&&t===l.includes?a:t}},4156:function(e,t,n){"use strict";var r=n(2360),o=n(4340),a=Array.prototype;e.exports=function(e){var t=e.indexOf;return e===a||r(a,e)&&t===a.indexOf?o:t}},1352:function(e,t,n){"use strict";var r=n(2360),o=n(3844),a=Array.prototype;e.exports=function(e){var t=e.map;return e===a||r(a,e)&&t===a.map?o:t}},8896:function(e,t,n){"use strict";var r=n(2360),o=n(6368),a=Array.prototype;e.exports=function(e){var t=e.push;return e===a||r(a,e)&&t===a.push?o:t}},7736:function(e,t,n){"use strict";var r=n(2360),o=n(7820),a=String.prototype;e.exports=function(e){var t=e.replaceAll;return"string"==typeof e||e===a||r(a,e)&&t===a.replaceAll?o:t}},8688:function(e,t,n){"use strict";var r=n(2360),o=n(4792),a=Array.prototype;e.exports=function(e){var t=e.slice;return e===a||r(a,e)&&t===a.slice?o:t}},3808:function(e,t,n){"use strict";var r=n(2360),o=n(4416),a=Array.prototype;e.exports=function(e){var t=e.sort;return e===a||r(a,e)&&t===a.sort?o:t}},6312:function(e,t,n){"use strict";var r=n(2360),o=n(3612),a=Array.prototype;e.exports=function(e){var t=e.splice;return e===a||r(a,e)&&t===a.splice?o:t}},1240:function(e,t,n){"use strict";var r=n(2360),o=n(9559),a=String.prototype;e.exports=function(e){var t=e.startsWith;return"string"==typeof e||e===a||r(a,e)&&t===a.startsWith?o:t}},8125:function(e,t,n){"use strict";var r=n(2360),o=n(4352),a=String.prototype;e.exports=function(e){var t=e.trim;return"string"==typeof e||e===a||r(a,e)&&t===a.trim?o:t}},9304:function(e,t,n){"use strict";n(8824);var r=n(9832),o=n(9867);r.JSON||(r.JSON={stringify:JSON.stringify}),e.exports=function(e,t,n){return o(r.JSON.stringify,null,arguments)}},2548:function(e,t,n){"use strict";n(340),n(6775),n(2648),n(2352),n(4176);var r=n(9832);e.exports=r.Map},9196:function(e,t,n){"use strict";n(6448);var r=n(9832);e.exports=r.Object.assign},4856:function(e,t,n){"use strict";n(8708);var r=n(9832).Object,o=e.exports=function(e,t,n){return r.defineProperty(e,t,n)};r.defineProperty.sham&&(o.sham=!0)},2536:function(e,t,n){"use strict";n(6360);var r=n(9832);e.exports=r.Object.entries},3416:function(e,t,n){"use strict";n(7648);var r=n(9832).Object,o=e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)};r.getOwnPropertyDescriptor.sham&&(o.sham=!0)},2936:function(e,t,n){"use strict";n(5032);var r=n(9832);e.exports=r.Object.getOwnPropertyDescriptors},920:function(e,t,n){"use strict";n(9276);var r=n(9832);e.exports=r.Object.getOwnPropertySymbols},2613:function(e,t,n){"use strict";n(88);var r=n(9832);e.exports=r.Object.keys},6104:function(e,t,n){"use strict";n(7016);var r=n(9832);e.exports=r.Object.values},6496:function(e,t,n){"use strict";n(816),n(340),n(2352),n(6244),n(8128),n(3728),n(96),n(196),n(4176);var r=n(9832);e.exports=r.Promise},3216:function(e,t,n){"use strict";n(3223);var r=n(9832);e.exports=r.Reflect.deleteProperty},2568:function(e,t,n){"use strict";n(3400);var r=n(9832);e.exports=r.Reflect.has},1060:function(e,t,n){"use strict";n(9988);var r=n(9832);e.exports=r.Reflect.set},7376:function(e,t,n){"use strict";n(340),n(2352),n(1160),n(4176);var r=n(9832);e.exports=r.Set},1340:function(e,t,n){"use strict";n(976);var r=n(6180);e.exports=r("String","endsWith")},4464:function(e,t,n){"use strict";n(3512);var r=n(6180);e.exports=r("String","includes")},7820:function(e,t,n){"use strict";n(1204),n(2008),n(6988);var r=n(6180);e.exports=r("String","replaceAll")},9559:function(e,t,n){"use strict";n(6432);var r=n(6180);e.exports=r("String","startsWith")},4352:function(e,t,n){"use strict";n(3003);var r=n(6180);e.exports=r("String","trim")},2767:function(e,t,n){"use strict";n(2216),n(2352),n(9276),n(2240),n(9452),n(1344),n(4436),n(6992),n(8028),n(6380),n(6176),n(1176),n(781),n(6720),n(5536),n(4732),n(4243),n(7548),n(3787),n(176);var r=n(9832);e.exports=r.Symbol},5180:function(e,t,n){"use strict";n(340),n(2352),n(4176),n(6992);var r=n(1104);e.exports=r.f("iterator")},6888:function(e,t,n){"use strict";n(7532),n(5536);var r=n(1104);e.exports=r.f("toPrimitive")},4800:function(e,t,n){"use strict";e.exports=n(420)},8816:function(e,t,n){"use strict";e.exports=n(9576)},7944:function(e,t,n){"use strict";var r=n(5280);e.exports=r},2396:function(e,t,n){"use strict";var r=n(4224);e.exports=r},420:function(e,t,n){"use strict";var r=n(6188);e.exports=r},8176:function(e,t,n){"use strict";var r=n(8404);e.exports=r},7112:function(e,t,n){"use strict";var r=n(9152);e.exports=r},8360:function(e,t,n){"use strict";var r=n(7296);e.exports=r},9576:function(e,t,n){"use strict";n(6508);var r=n(5672);e.exports=r},3232:function(e,t,n){"use strict";var r=n(296);e.exports=r},2176:function(e,t,n){"use strict";var r=n(376);e.exports=r},8520:function(e,t,n){"use strict";var r=n(6404);e.exports=r},2900:function(e,t,n){"use strict";var r=n(9468);e.exports=r},9216:function(e,t,n){"use strict";var r=n(7144);n(9264),n(8460),n(4448),n(4184),n(1216),n(5196),n(2948),n(2252),n(6396),e.exports=r},7268:function(e,t,n){"use strict";var r=n(9184);e.exports=r},6340:function(e,t,n){"use strict";var r=n(5920);e.exports=r},28:function(e,t,n){"use strict";var r=n(8536),o=n(8944),a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(o(e)+" is not a function")}},9556:function(e,t,n){"use strict";var r=n(9496),o=n(8944),a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(o(e)+" is not a constructor")}},1459:function(e,t,n){"use strict";var r=n(7432),o=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw new a("Can't set "+o(e)+" as a prototype")}},1472:function(e){"use strict";e.exports=function(){}},4572:function(e,t,n){"use strict";var r=n(2360),o=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new o("Incorrect invocation")}},2032:function(e,t,n){"use strict";var r=n(8608),o=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(o(e)+" is not an object")}},3648:function(e,t,n){"use strict";var r=n(2064);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},3028:function(e,t,n){"use strict";var r=n(2819),o=n(4180),a=n(5316);e.exports=function(e){for(var t=r(this),n=a(t),i=arguments.length,l=o(i>1?arguments[1]:void 0,n),c=i>2?arguments[2]:void 0,u=void 0===c?n:o(c,n);u>l;)t[l++]=e;return t}},9980:function(e,t,n){"use strict";var r=n(1884),o=n(4580),a=n(2819),i=n(7547),l=n(4992),c=n(9496),u=n(5316),s=n(4895),f=n(4656),d=n(68),p=Array;e.exports=function(e){var t=a(e),n=c(this),v=arguments.length,m=v>1?arguments[1]:void 0,g=void 0!==m;g&&(m=r(m,v>2?arguments[2]:void 0));var h,y,b,C,E,I,x=d(t),N=0;if(!x||this===p&&l(x))for(h=u(t),y=n?new this(h):p(h);h>N;N++)I=g?m(t[N],N):t[N],s(y,N,I);else for(E=(C=f(t,x)).next,y=n?new this:[];!(b=o(E,C)).done;N++)I=g?i(C,m,[b.value,N],!0):b.value,s(y,N,I);return y.length=N,y}},7464:function(e,t,n){"use strict";var r=n(445),o=n(4180),a=n(5316),i=function(e){return function(t,n,i){var l,c=r(t),u=a(c),s=o(i,u);if(e&&n!=n){for(;u>s;)if((l=c[s++])!=l)return!0}else for(;u>s;s++)if((e||s in c)&&c[s]===n)return e||s||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}},7608:function(e,t,n){"use strict";var r=n(1884),o=n(9252),a=n(2899),i=n(2819),l=n(5316),c=n(4872),u=o([].push),s=function(e){var t=1===e,n=2===e,o=3===e,s=4===e,f=6===e,d=7===e,p=5===e||f;return function(v,m,g,h){for(var y,b,C=i(v),E=a(C),I=l(E),x=r(m,g),N=0,T=h||c,A=t?T(v,I):n||d?T(v,0):void 0;I>N;N++)if((p||N in E)&&(b=x(y=E[N],N,C),e))if(t)A[N]=b;else if(b)switch(e){case 3:return!0;case 5:return y;case 6:return N;case 2:u(A,y)}else switch(e){case 4:return!1;case 7:u(A,y)}return f?-1:o||s?s:A}};e.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)}},5384:function(e,t,n){"use strict";var r=n(2064),o=n(3336),a=n(3896),i=o("species");e.exports=function(e){return a>=51||!r((function(){var t=[];return(t.constructor={})[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},4888:function(e,t,n){"use strict";var r=n(2064);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},1716:function(e,t,n){"use strict";var r=n(9172),o=n(3204),a=TypeError,i=Object.getOwnPropertyDescriptor,l=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=l?function(e,t){if(o(e)&&!i(e,"length").writable)throw new a("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},940:function(e,t,n){"use strict";var r=n(9252);e.exports=r([].slice)},3864:function(e,t,n){"use strict";var r=n(940),o=Math.floor,a=function(e,t){var n=e.length;if(n<8)for(var i,l,c=1;c<n;){for(l=c,i=e[c];l&&t(e[l-1],i)>0;)e[l]=e[--l];l!==c++&&(e[l]=i)}else for(var u=o(n/2),s=a(r(e,0,u),t),f=a(r(e,u),t),d=s.length,p=f.length,v=0,m=0;v<d||m<p;)e[v+m]=v<d&&m<p?t(s[v],f[m])<=0?s[v++]:f[m++]:v<d?s[v++]:f[m++];return e};e.exports=a},2556:function(e,t,n){"use strict";var r=n(3204),o=n(9496),a=n(8608),i=n(3336)("species"),l=Array;e.exports=function(e){var t;return r(e)&&(t=e.constructor,(o(t)&&(t===l||r(t.prototype))||a(t)&&null===(t=t[i]))&&(t=void 0)),void 0===t?l:t}},4872:function(e,t,n){"use strict";var r=n(2556);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},7547:function(e,t,n){"use strict";var r=n(2032),o=n(5872);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){o(e,"throw",t)}}},9592:function(e){"use strict";e.exports=function(e,t){return 1===t?function(t,n){return t[e](n)}:function(t,n,r){return t[e](n,r)}}},347:function(e,t,n){"use strict";var r=n(3336)("iterator"),o=!1;try{var a=0,i={next:function(){return{done:!!a++}},return:function(){o=!0}};i[r]=function(){return this},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){try{if(!t&&!o)return!1}catch(e){return!1}var n=!1;try{var a={};a[r]=function(){return{next:function(){return{done:n=!0}}}},e(a)}catch(e){}return n}},7936:function(e,t,n){"use strict";var r=n(9252),o=r({}.toString),a=r("".slice);e.exports=function(e){return a(o(e),8,-1)}},636:function(e,t,n){"use strict";var r=n(6744),o=n(8536),a=n(7936),i=n(3336)("toStringTag"),l=Object,c="Arguments"===a(function(){return arguments}());e.exports=r?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=l(e),i))?n:c?a(t):"Object"===(r=a(t))&&o(t.callee)?"Arguments":r}},3928:function(e,t,n){"use strict";var r=n(4488),o=n(6968),a=n(8104),i=n(1884),l=n(4572),c=n(9511),u=n(5799),s=n(536),f=n(3848),d=n(3120),p=n(9172),v=n(992).fastKey,m=n(2344),g=m.set,h=m.getterFor;e.exports={getConstructor:function(e,t,n,s){var f=e((function(e,o){l(e,d),g(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),p||(e.size=0),c(o)||u(o,e[s],{that:e,AS_ENTRIES:n})})),d=f.prototype,m=h(t),y=function(e,t,n){var r,o,a=m(e),i=b(e,t);return i?i.value=n:(a.last=i={index:o=v(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=i),r&&(r.next=i),p?a.size++:e.size++,"F"!==o&&(a.index[o]=i)),e},b=function(e,t){var n,r=m(e),o=v(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key===t)return n};return a(d,{clear:function(){for(var e=m(this),t=e.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=void 0),t=t.next;e.first=e.last=void 0,e.index=r(null),p?e.size=0:this.size=0},delete:function(e){var t=this,n=m(t),r=b(t,e);if(r){var o=r.next,a=r.previous;delete n.index[r.index],r.removed=!0,a&&(a.next=o),o&&(o.previous=a),n.first===r&&(n.first=o),n.last===r&&(n.last=a),p?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=m(this),r=i(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!b(this,e)}}),a(d,n?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return y(this,0===e?0:e,t)}}:{add:function(e){return y(this,e=0===e?0:e,e)}}),p&&o(d,"size",{configurable:!0,get:function(){return m(this).size}}),f},setStrong:function(e,t,n){var r=t+" Iterator",o=h(t),a=h(r);s(e,t,(function(e,t){g(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?f("keys"===t?n.key:"values"===t?n.value:[n.key,n.value],!1):(e.target=void 0,f(void 0,!0))}),n?"entries":"values",!n,!0),d(t)}}},6072:function(e,t,n){"use strict";var r=n(3952),o=n(5216),a=n(992),i=n(2064),l=n(896),c=n(5799),u=n(4572),s=n(8536),f=n(8608),d=n(9511),p=n(5836),v=n(2280).f,m=n(7608).forEach,g=n(9172),h=n(2344),y=h.set,b=h.getterFor;e.exports=function(e,t,n){var h,C=-1!==e.indexOf("Map"),E=-1!==e.indexOf("Weak"),I=C?"set":"add",x=o[e],N=x&&x.prototype,T={};if(g&&s(x)&&(E||N.forEach&&!i((function(){(new x).entries().next()})))){var A=(h=t((function(t,n){y(u(t,A),{type:e,collection:new x}),d(n)||c(n,t[I],{that:t,AS_ENTRIES:C})}))).prototype,S=b(e);m(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"===e||"set"===e;!(e in N)||E&&"clear"===e||l(A,e,(function(n,r){var o=S(this).collection;if(!t&&E&&!f(n))return"get"===e&&void 0;var a=o[e](0===n?0:n,r);return t?this:a}))})),E||v(A,"size",{configurable:!0,get:function(){return S(this).collection.size}})}else h=n.getConstructor(t,e,C,I),a.enable();return p(h,e,!1,!0),T[e]=h,r({global:!0,forced:!0},T),E||n.setStrong(h,e,C),h}},1100:function(e,t,n){"use strict";var r=n(4664),o=n(7876),a=n(1008),i=n(2280);e.exports=function(e,t,n){for(var l=o(t),c=i.f,u=a.f,s=0;s<l.length;s++){var f=l[s];r(e,f)||n&&r(n,f)||c(e,f,u(t,f))}}},660:function(e,t,n){"use strict";var r=n(3336)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},2480:function(e,t,n){"use strict";var r=n(2064);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},3848:function(e){"use strict";e.exports=function(e,t){return{value:e,done:t}}},896:function(e,t,n){"use strict";var r=n(9172),o=n(2280),a=n(8981);e.exports=r?function(e,t,n){return o.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},8981:function(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},4895:function(e,t,n){"use strict";var r=n(2319),o=n(2280),a=n(8981);e.exports=function(e,t,n){var i=r(t);i in e?o.f(e,i,a(0,n)):e[i]=n}},6968:function(e,t,n){"use strict";var r=n(2280);e.exports=function(e,t,n){return r.f(e,t,n)}},5424:function(e,t,n){"use strict";var r=n(896);e.exports=function(e,t,n,o){return o&&o.enumerable?e[t]=n:r(e,t,n),e}},8104:function(e,t,n){"use strict";var r=n(5424);e.exports=function(e,t,n){for(var o in t)n&&n.unsafe&&e[o]?e[o]=t[o]:r(e,o,t[o],n);return e}},4408:function(e,t,n){"use strict";var r=n(5216),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},6940:function(e,t,n){"use strict";var r=n(8944),o=TypeError;e.exports=function(e,t){if(!delete e[t])throw new o("Cannot delete property "+r(t)+" of "+r(e))}},9172:function(e,t,n){"use strict";var r=n(2064);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},1940:function(e,t,n){"use strict";var r=n(5216),o=n(8608),a=r.document,i=o(a)&&o(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},8200:function(e){"use strict";var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},472:function(e){"use strict";e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7587:function(e,t,n){"use strict";var r=n(2276).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},3322:function(e,t,n){"use strict";var r=n(5924),o=n(1432);e.exports=!r&&!o&&"object"==typeof window&&"object"==typeof document},5924:function(e){"use strict";e.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},6028:function(e,t,n){"use strict";var r=n(2276);e.exports=/MSIE|Trident/.test(r)},1172:function(e,t,n){"use strict";var r=n(2276);e.exports=/ipad|iphone|ipod/i.test(r)&&"undefined"!=typeof Pebble},6772:function(e,t,n){"use strict";var r=n(2276);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},1432:function(e,t,n){"use strict";var r=n(5216),o=n(7936);e.exports="process"===o(r.process)},1824:function(e,t,n){"use strict";var r=n(2276);e.exports=/web0s(?!.*chrome)/i.test(r)},2276:function(e){"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},3896:function(e,t,n){"use strict";var r,o,a=n(5216),i=n(2276),l=a.process,c=a.Deno,u=l&&l.versions||c&&c.version,s=u&&u.v8;s&&(o=(r=s.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&i&&(!(r=i.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=i.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},1244:function(e,t,n){"use strict";var r=n(2276).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},3620:function(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9492:function(e,t,n){"use strict";var r=n(9252),o=Error,a=r("".replace),i=String(new o("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,c=l.test(i);e.exports=function(e,t){if(c&&"string"==typeof e&&!o.prepareStackTrace)for(;t--;)e=a(e,l,"");return e}},9035:function(e,t,n){"use strict";var r=n(896),o=n(9492),a=n(1376),i=Error.captureStackTrace;e.exports=function(e,t,n,l){a&&(i?i(e,t):r(e,"stack",o(n,l)))}},1376:function(e,t,n){"use strict";var r=n(2064),o=n(8981);e.exports=!r((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",o(1,7)),7!==e.stack)}))},3952:function(e,t,n){"use strict";var r=n(5216),o=n(9867),a=n(1248),i=n(8536),l=n(1008).f,c=n(6155),u=n(9832),s=n(1884),f=n(896),d=n(4664),p=function(e){var t=function(n,r,a){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,a)}return o(e,this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var n,o,v,m,g,h,y,b,C,E=e.target,I=e.global,x=e.stat,N=e.proto,T=I?r:x?r[E]:r[E]&&r[E].prototype,A=I?u:u[E]||f(u,E,{})[E],S=A.prototype;for(m in t)o=!(n=c(I?m:E+(x?".":"#")+m,e.forced))&&T&&d(T,m),h=A[m],o&&(y=e.dontCallGetSet?(C=l(T,m))&&C.value:T[m]),g=o&&y?y:t[m],(n||N||typeof h!=typeof g)&&(b=e.bind&&o?s(g,r):e.wrap&&o?p(g):N&&i(g)?a(g):g,(e.sham||g&&g.sham||h&&h.sham)&&f(b,"sham",!0),f(A,m,b),N&&(d(u,v=E+"Prototype")||f(u,v,{}),f(u[v],m,g),e.real&&S&&(n||!S[m])&&f(S,m,g)))}},2064:function(e){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},9380:function(e,t,n){"use strict";var r=n(2064);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},9867:function(e,t,n){"use strict";var r=n(5200),o=Function.prototype,a=o.apply,i=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?i.bind(a):function(){return i.apply(a,arguments)})},1884:function(e,t,n){"use strict";var r=n(1248),o=n(28),a=n(5200),i=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:a?i(e,t):function(){return e.apply(t,arguments)}}},5200:function(e,t,n){"use strict";var r=n(2064);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},5404:function(e,t,n){"use strict";var r=n(9252),o=n(28),a=n(8608),i=n(4664),l=n(940),c=n(5200),u=Function,s=r([].concat),f=r([].join),d={};e.exports=c?u.bind:function(e){var t=o(this),n=t.prototype,r=l(arguments,1),c=function(){var n=s(r,l(arguments));return this instanceof c?function(e,t,n){if(!i(d,t)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";d[t]=u("C,a","return new C("+f(r,",")+")")}return d[t](e,n)}(t,n.length,n):t.apply(e,n)};return a(n)&&(c.prototype=n),c}},4580:function(e,t,n){"use strict";var r=n(5200),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},3564:function(e,t,n){"use strict";var r=n(9172),o=n(4664),a=Function.prototype,i=r&&Object.getOwnPropertyDescriptor,l=o(a,"name"),c=l&&"something"===function(){}.name,u=l&&(!r||r&&i(a,"name").configurable);e.exports={EXISTS:l,PROPER:c,CONFIGURABLE:u}},7864:function(e,t,n){"use strict";var r=n(9252),o=n(28);e.exports=function(e,t,n){try{return r(o(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},1248:function(e,t,n){"use strict";var r=n(7936),o=n(9252);e.exports=function(e){if("Function"===r(e))return o(e)}},9252:function(e,t,n){"use strict";var r=n(5200),o=Function.prototype,a=o.call,i=r&&o.bind.bind(a,a);e.exports=r?i:function(e){return function(){return a.apply(e,arguments)}}},6180:function(e,t,n){"use strict";var r=n(5216),o=n(9832);e.exports=function(e,t){var n=o[e+"Prototype"],a=n&&n[t];if(a)return a;var i=r[e],l=i&&i.prototype;return l&&l[t]}},3464:function(e,t,n){"use strict";var r=n(9832),o=n(5216),a=n(8536),i=function(e){return a(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e])||i(o[e]):r[e]&&r[e][t]||o[e]&&o[e][t]}},68:function(e,t,n){"use strict";var r=n(636),o=n(1636),a=n(9511),i=n(7256),l=n(3336)("iterator");e.exports=function(e){if(!a(e))return o(e,l)||o(e,"@@iterator")||i[r(e)]}},4656:function(e,t,n){"use strict";var r=n(4580),o=n(28),a=n(2032),i=n(8944),l=n(68),c=TypeError;e.exports=function(e,t){var n=arguments.length<2?l(e):t;if(o(n))return a(r(n,e));throw new c(i(e)+" is not iterable")}},3676:function(e,t,n){"use strict";var r=n(9252),o=n(3204),a=n(8536),i=n(7936),l=n(9352),c=r([].push);e.exports=function(e){if(a(e))return e;if(o(e)){for(var t=e.length,n=[],r=0;r<t;r++){var u=e[r];"string"==typeof u?c(n,u):"number"!=typeof u&&"Number"!==i(u)&&"String"!==i(u)||c(n,l(u))}var s=n.length,f=!0;return function(e,t){if(f)return f=!1,t;if(o(this))return t;for(var r=0;r<s;r++)if(n[r]===e)return t}}}},1636:function(e,t,n){"use strict";var r=n(28),o=n(9511);e.exports=function(e,t){var n=e[t];return o(n)?void 0:r(n)}},1440:function(e,t,n){"use strict";var r=n(9252),o=n(2819),a=Math.floor,i=r("".charAt),l=r("".replace),c=r("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,f,d){var p=n+e.length,v=r.length,m=s;return void 0!==f&&(f=o(f),m=u),l(d,m,(function(o,l){var u;switch(i(l,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,p);case"<":u=f[c(l,1,-1)];break;default:var s=+l;if(0===s)return o;if(s>v){var d=a(s/10);return 0===d?o:d<=v?void 0===r[d-1]?i(l,1):r[d-1]+i(l,1):o}u=r[s-1]}return void 0===u?"":u}))}},5216:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4664:function(e,t,n){"use strict";var r=n(9252),o=n(2819),a=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return a(o(e),t)}},3328:function(e){"use strict";e.exports={}},3320:function(e){"use strict";e.exports=function(e,t){}},7896:function(e,t,n){"use strict";var r=n(3464);e.exports=r("document","documentElement")},124:function(e,t,n){"use strict";var r=n(9172),o=n(2064),a=n(1940);e.exports=!r&&!o((function(){return 7!==Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},2899:function(e,t,n){"use strict";var r=n(9252),o=n(2064),a=n(7936),i=Object,l=r("".split);e.exports=o((function(){return!i("z").propertyIsEnumerable(0)}))?function(e){return"String"===a(e)?l(e,""):i(e)}:i},9376:function(e,t,n){"use strict";var r=n(9252),o=n(8536),a=n(9284),i=r(Function.toString);o(a.inspectSource)||(a.inspectSource=function(e){return i(e)}),e.exports=a.inspectSource},9055:function(e,t,n){"use strict";var r=n(8608),o=n(896);e.exports=function(e,t){r(t)&&"cause"in t&&o(e,"cause",t.cause)}},992:function(e,t,n){"use strict";var r=n(3952),o=n(9252),a=n(3328),i=n(8608),l=n(4664),c=n(2280).f,u=n(1600),s=n(1920),f=n(5432),d=n(6696),p=n(9380),v=!1,m=d("meta"),g=0,h=function(e){c(e,m,{value:{objectID:"O"+g++,weakData:{}}})},y=e.exports={enable:function(){y.enable=function(){},v=!0;var e=u.f,t=o([].splice),n={};n[m]=1,e(n).length&&(u.f=function(n){for(var r=e(n),o=0,a=r.length;o<a;o++)if(r[o]===m){t(r,o,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:s.f}))},fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!l(e,m)){if(!f(e))return"F";if(!t)return"E";h(e)}return e[m].objectID},getWeakData:function(e,t){if(!l(e,m)){if(!f(e))return!0;if(!t)return!1;h(e)}return e[m].weakData},onFreeze:function(e){return p&&v&&f(e)&&!l(e,m)&&h(e),e}};a[m]=!0},2344:function(e,t,n){"use strict";var r,o,a,i=n(3184),l=n(5216),c=n(8608),u=n(896),s=n(4664),f=n(9284),d=n(924),p=n(3328),v="Object already initialized",m=l.TypeError,g=l.WeakMap;if(i||f.state){var h=f.state||(f.state=new g);h.get=h.get,h.has=h.has,h.set=h.set,r=function(e,t){if(h.has(e))throw new m(v);return t.facade=e,h.set(e,t),t},o=function(e){return h.get(e)||{}},a=function(e){return h.has(e)}}else{var y=d("state");p[y]=!0,r=function(e,t){if(s(e,y))throw new m(v);return t.facade=e,u(e,y,t),t},o=function(e){return s(e,y)?e[y]:{}},a=function(e){return s(e,y)}}e.exports={set:r,get:o,has:a,enforce:function(e){return a(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},4992:function(e,t,n){"use strict";var r=n(3336),o=n(7256),a=r("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||i[a]===e)}},3204:function(e,t,n){"use strict";var r=n(7936);e.exports=Array.isArray||function(e){return"Array"===r(e)}},8536:function(e){"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},9496:function(e,t,n){"use strict";var r=n(9252),o=n(2064),a=n(8536),i=n(636),l=n(3464),c=n(9376),u=function(){},s=l("Reflect","construct"),f=/^\s*(?:class|function)\b/,d=r(f.exec),p=!f.test(u),v=function(e){if(!a(e))return!1;try{return s(u,[],e),!0}catch(e){return!1}},m=function(e){if(!a(e))return!1;switch(i(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!d(f,c(e))}catch(e){return!0}};m.sham=!0,e.exports=!s||o((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?m:v},5072:function(e,t,n){"use strict";var r=n(4664);e.exports=function(e){return void 0!==e&&(r(e,"value")||r(e,"writable"))}},6155:function(e,t,n){"use strict";var r=n(2064),o=n(8536),a=/#|\.prototype\./,i=function(e,t){var n=c[l(e)];return n===s||n!==u&&(o(t)?r(t):!!t)},l=i.normalize=function(e){return String(e).replace(a,".").toLowerCase()},c=i.data={},u=i.NATIVE="N",s=i.POLYFILL="P";e.exports=i},9511:function(e){"use strict";e.exports=function(e){return null==e}},8608:function(e,t,n){"use strict";var r=n(8536);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},7432:function(e,t,n){"use strict";var r=n(8608);e.exports=function(e){return r(e)||null===e}},1016:function(e){"use strict";e.exports=!0},9300:function(e,t,n){"use strict";var r=n(8608),o=n(7936),a=n(3336)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"===o(e))}},5376:function(e,t,n){"use strict";var r=n(3464),o=n(8536),a=n(2360),i=n(6416),l=Object;e.exports=i?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&a(t.prototype,l(e))}},5799:function(e,t,n){"use strict";var r=n(1884),o=n(4580),a=n(2032),i=n(8944),l=n(4992),c=n(5316),u=n(2360),s=n(4656),f=n(68),d=n(5872),p=TypeError,v=function(e,t){this.stopped=e,this.result=t},m=v.prototype;e.exports=function(e,t,n){var g,h,y,b,C,E,I,x=n&&n.that,N=!(!n||!n.AS_ENTRIES),T=!(!n||!n.IS_RECORD),A=!(!n||!n.IS_ITERATOR),S=!(!n||!n.INTERRUPTED),w=r(t,x),F=function(e){return g&&d(g,"normal",e),new v(!0,e)},k=function(e){return N?(a(e),S?w(e[0],e[1],F):w(e[0],e[1])):S?w(e,F):w(e)};if(T)g=e.iterator;else if(A)g=e;else{if(!(h=f(e)))throw new p(i(e)+" is not iterable");if(l(h)){for(y=0,b=c(e);b>y;y++)if((C=k(e[y]))&&u(m,C))return C;return new v(!1)}g=s(e,h)}for(E=T?e.next:g.next;!(I=o(E,g)).done;){try{C=k(I.value)}catch(e){d(g,"throw",e)}if("object"==typeof C&&C&&u(m,C))return C}return new v(!1)}},5872:function(e,t,n){"use strict";var r=n(4580),o=n(2032),a=n(1636);e.exports=function(e,t,n){var i,l;o(e);try{if(!(i=a(e,"return"))){if("throw"===t)throw n;return n}i=r(i,e)}catch(e){l=!0,i=e}if("throw"===t)throw n;if(l)throw i;return o(i),n}},9976:function(e,t,n){"use strict";var r=n(2224).IteratorPrototype,o=n(4488),a=n(8981),i=n(5836),l=n(7256),c=function(){return this};e.exports=function(e,t,n,u){var s=t+" Iterator";return e.prototype=o(r,{next:a(+!u,n)}),i(e,s,!1,!0),l[s]=c,e}},536:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(1016),i=n(3564),l=n(8536),c=n(9976),u=n(7800),s=n(2288),f=n(5836),d=n(896),p=n(5424),v=n(3336),m=n(7256),g=n(2224),h=i.PROPER,y=i.CONFIGURABLE,b=g.IteratorPrototype,C=g.BUGGY_SAFARI_ITERATORS,E=v("iterator"),I="keys",x="values",N="entries",T=function(){return this};e.exports=function(e,t,n,i,v,g,A){c(n,t,i);var S,w,F,k=function(e){if(e===v&&_)return _;if(!C&&e&&e in M)return M[e];switch(e){case I:case x:case N:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",P=!1,M=e.prototype,R=M[E]||M["@@iterator"]||v&&M[v],_=!C&&R||k(v),O="Array"===t&&M.entries||R;if(O&&(S=u(O.call(new e)))!==Object.prototype&&S.next&&(a||u(S)===b||(s?s(S,b):l(S[E])||p(S,E,T)),f(S,D,!0,!0),a&&(m[D]=T)),h&&v===x&&R&&R.name!==x&&(!a&&y?d(M,"name",x):(P=!0,_=function(){return o(R,this)})),v)if(w={values:k(x),keys:g?_:k(I),entries:k(N)},A)for(F in w)(C||P||!(F in M))&&p(M,F,w[F]);else r({target:t,proto:!0,forced:C||P},w);return a&&!A||M[E]===_||p(M,E,_,{name:v}),m[t]=_,w}},2224:function(e,t,n){"use strict";var r,o,a,i=n(2064),l=n(8536),c=n(8608),u=n(4488),s=n(7800),f=n(5424),d=n(3336),p=n(1016),v=d("iterator"),m=!1;[].keys&&("next"in(a=[].keys())?(o=s(s(a)))!==Object.prototype&&(r=o):m=!0),!c(r)||i((function(){var e={};return r[v].call(e)!==e}))?r={}:p&&(r=u(r)),l(r[v])||f(r,v,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},7256:function(e){"use strict";e.exports={}},5316:function(e,t,n){"use strict";var r=n(4596);e.exports=function(e){return r(e.length)}},2408:function(e,t,n){"use strict";var r=n(3464),o=n(9592),a=r("Map");e.exports={Map:a,set:o("set",2),get:o("get",1),has:o("has",1),remove:o("delete",1),proto:a.prototype}},24:function(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},9836:function(e,t,n){"use strict";var r,o,a,i,l,c=n(5216),u=n(4604),s=n(1884),f=n(3368).set,d=n(8604),p=n(6772),v=n(1172),m=n(1824),g=n(1432),h=c.MutationObserver||c.WebKitMutationObserver,y=c.document,b=c.process,C=c.Promise,E=u("queueMicrotask");if(!E){var I=new d,x=function(){var e,t;for(g&&(e=b.domain)&&e.exit();t=I.get();)try{t()}catch(e){throw I.head&&r(),e}e&&e.enter()};p||g||m||!h||!y?!v&&C&&C.resolve?((i=C.resolve(void 0)).constructor=C,l=s(i.then,i),r=function(){l(x)}):g?r=function(){b.nextTick(x)}:(f=s(f,c),r=function(){f(x)}):(o=!0,a=y.createTextNode(""),new h(x).observe(a,{characterData:!0}),r=function(){a.data=o=!o}),E=function(e){I.head||r(),I.add(e)}}e.exports=E},1243:function(e,t,n){"use strict";var r=n(28),o=TypeError,a=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw new o("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new a(e)}},3080:function(e,t,n){"use strict";var r=n(9352);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},9720:function(e,t,n){"use strict";var r=n(9300),o=TypeError;e.exports=function(e){if(r(e))throw new o("The method doesn't accept regular expressions");return e}},8980:function(e,t,n){"use strict";var r=n(9172),o=n(9252),a=n(4580),i=n(2064),l=n(9547),c=n(4060),u=n(6500),s=n(2819),f=n(2899),d=Object.assign,p=Object.defineProperty,v=o([].concat);e.exports=!d||i((function(){if(r&&1!==d({b:1},d(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol("assign detection"),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!==d({},e)[n]||l(d({},t)).join("")!==o}))?function(e,t){for(var n=s(e),o=arguments.length,i=1,d=c.f,p=u.f;o>i;)for(var m,g=f(arguments[i++]),h=d?v(l(g),d(g)):l(g),y=h.length,b=0;y>b;)m=h[b++],r&&!a(p,g,m)||(n[m]=g[m]);return n}:d},4488:function(e,t,n){"use strict";var r,o=n(2032),a=n(6452),i=n(3620),l=n(3328),c=n(7896),u=n(1940),s=n(924),f="prototype",d="script",p=s("IE_PROTO"),v=function(){},m=function(e){return"<"+d+">"+e+"</"+d+">"},g=function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t},h=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;h="undefined"!=typeof document?document.domain&&r?g(r):(t=u("iframe"),n="java"+d+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F):g(r);for(var o=i.length;o--;)delete h[f][i[o]];return h()};l[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(v[f]=o(e),n=new v,v[f]=null,n[p]=e):n=h(),void 0===t?n:a.f(n,t)}},6452:function(e,t,n){"use strict";var r=n(9172),o=n(3109),a=n(2280),i=n(2032),l=n(445),c=n(9547);t.f=r&&!o?Object.defineProperties:function(e,t){i(e);for(var n,r=l(t),o=c(t),u=o.length,s=0;u>s;)a.f(e,n=o[s++],r[n]);return e}},2280:function(e,t,n){"use strict";var r=n(9172),o=n(124),a=n(3109),i=n(2032),l=n(2319),c=TypeError,u=Object.defineProperty,s=Object.getOwnPropertyDescriptor,f="enumerable",d="configurable",p="writable";t.f=r?a?function(e,t,n){if(i(e),t=l(t),i(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=s(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:f in n?n[f]:r[f],writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(i(e),t=l(t),i(n),o)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1008:function(e,t,n){"use strict";var r=n(9172),o=n(4580),a=n(6500),i=n(8981),l=n(445),c=n(2319),u=n(4664),s=n(124),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=l(e),t=c(t),s)try{return f(e,t)}catch(e){}if(u(e,t))return i(!o(a.f,e,t),e[t])}},1920:function(e,t,n){"use strict";var r=n(7936),o=n(445),a=n(1600).f,i=n(940),l="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return l&&"Window"===r(e)?function(e){try{return a(e)}catch(e){return i(l)}}(e):a(o(e))}},1600:function(e,t,n){"use strict";var r=n(2884),o=n(3620).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},4060:function(e,t){"use strict";t.f=Object.getOwnPropertySymbols},7800:function(e,t,n){"use strict";var r=n(4664),o=n(8536),a=n(2819),i=n(924),l=n(2480),c=i("IE_PROTO"),u=Object,s=u.prototype;e.exports=l?u.getPrototypeOf:function(e){var t=a(e);if(r(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof u?s:null}},5432:function(e,t,n){"use strict";var r=n(2064),o=n(8608),a=n(7936),i=n(3648),l=Object.isExtensible,c=r((function(){l(1)}));e.exports=c||i?function(e){return!!o(e)&&((!i||"ArrayBuffer"!==a(e))&&(!l||l(e)))}:l},2360:function(e,t,n){"use strict";var r=n(9252);e.exports=r({}.isPrototypeOf)},2884:function(e,t,n){"use strict";var r=n(9252),o=n(4664),a=n(445),i=n(7464).indexOf,l=n(3328),c=r([].push);e.exports=function(e,t){var n,r=a(e),u=0,s=[];for(n in r)!o(l,n)&&o(r,n)&&c(s,n);for(;t.length>u;)o(r,n=t[u++])&&(~i(s,n)||c(s,n));return s}},9547:function(e,t,n){"use strict";var r=n(2884),o=n(3620);e.exports=Object.keys||function(e){return r(e,o)}},6500:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},2288:function(e,t,n){"use strict";var r=n(7864),o=n(2032),a=n(1459);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return o(n),a(r),t?e(n,r):n.__proto__=r,n}}():void 0)},2768:function(e,t,n){"use strict";var r=n(9172),o=n(2064),a=n(9252),i=n(7800),l=n(9547),c=n(445),u=a(n(6500).f),s=a([].push),f=r&&o((function(){var e=Object.create(null);return e[2]=2,!u(e,2)})),d=function(e){return function(t){for(var n,o=c(t),a=l(o),d=f&&null===i(o),p=a.length,v=0,m=[];p>v;)n=a[v++],r&&!(d?n in o:u(o,n))||s(m,e?[n,o[n]]:o[n]);return m}};e.exports={entries:d(!0),values:d(!1)}},1616:function(e,t,n){"use strict";var r=n(6744),o=n(636);e.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},416:function(e,t,n){"use strict";var r=n(4580),o=n(8536),a=n(8608),i=TypeError;e.exports=function(e,t){var n,l;if("string"===t&&o(n=e.toString)&&!a(l=r(n,e)))return l;if(o(n=e.valueOf)&&!a(l=r(n,e)))return l;if("string"!==t&&o(n=e.toString)&&!a(l=r(n,e)))return l;throw new i("Can't convert object to primitive value")}},7876:function(e,t,n){"use strict";var r=n(3464),o=n(9252),a=n(1600),i=n(4060),l=n(2032),c=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=a.f(l(e)),n=i.f;return n?c(t,n(e)):t}},9832:function(e){"use strict";e.exports={}},5240:function(e){"use strict";e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},5524:function(e,t,n){"use strict";var r=n(5216),o=n(728),a=n(8536),i=n(6155),l=n(9376),c=n(3336),u=n(3322),s=n(5924),f=n(1016),d=n(3896),p=o&&o.prototype,v=c("species"),m=!1,g=a(r.PromiseRejectionEvent),h=i("Promise",(function(){var e=l(o),t=e!==String(o);if(!t&&66===d)return!0;if(f&&(!p.catch||!p.finally))return!0;if(!d||d<51||!/native code/.test(e)){var n=new o((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((n.constructor={})[v]=r,!(m=n.then((function(){}))instanceof r))return!0}return!t&&(u||s)&&!g}));e.exports={CONSTRUCTOR:h,REJECTION_EVENT:g,SUBCLASSING:m}},728:function(e,t,n){"use strict";var r=n(5216);e.exports=r.Promise},7211:function(e,t,n){"use strict";var r=n(2032),o=n(8608),a=n(1243);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},4880:function(e,t,n){"use strict";var r=n(728),o=n(347),a=n(5524).CONSTRUCTOR;e.exports=a||!o((function(e){r.all(e).then(void 0,(function(){}))}))},8604:function(e){"use strict";var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null},n=this.tail;n?n.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}},e.exports=t},3520:function(e,t,n){"use strict";var r=n(2032);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},2840:function(e,t,n){"use strict";var r=n(4580),o=n(4664),a=n(2360),i=n(3520),l=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in l||o(e,"flags")||!a(l,e)?t:r(i,e)}},9952:function(e,t,n){"use strict";var r=n(9511),o=TypeError;e.exports=function(e){if(r(e))throw new o("Can't call method on "+e);return e}},4604:function(e,t,n){"use strict";var r=n(5216),o=n(9172),a=Object.getOwnPropertyDescriptor;e.exports=function(e){if(!o)return r[e];var t=a(r,e);return t&&t.value}},3120:function(e,t,n){"use strict";var r=n(3464),o=n(6968),a=n(3336),i=n(9172),l=a("species");e.exports=function(e){var t=r(e);i&&t&&!t[l]&&o(t,l,{configurable:!0,get:function(){return this}})}},5836:function(e,t,n){"use strict";var r=n(6744),o=n(2280).f,a=n(896),i=n(4664),l=n(1616),c=n(3336)("toStringTag");e.exports=function(e,t,n,u){var s=n?e:e&&e.prototype;s&&(i(s,c)||o(s,c,{configurable:!0,value:t}),u&&!r&&a(s,"toString",l))}},924:function(e,t,n){"use strict";var r=n(8852),o=n(6696),a=r("keys");e.exports=function(e){return a[e]||(a[e]=o(e))}},9284:function(e,t,n){"use strict";var r=n(5216),o=n(4408),a="__core-js_shared__",i=r[a]||o(a,{});e.exports=i},8852:function(e,t,n){"use strict";var r=n(1016),o=n(9284);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.35.1",mode:r?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"})},4928:function(e,t,n){"use strict";var r=n(2032),o=n(9556),a=n(9511),i=n(3336)("species");e.exports=function(e,t){var n,l=r(e).constructor;return void 0===l||a(n=r(l)[i])?t:o(n)}},6392:function(e,t,n){"use strict";var r=n(9252),o=n(5016),a=n(9352),i=n(9952),l=r("".charAt),c=r("".charCodeAt),u=r("".slice),s=function(e){return function(t,n){var r,s,f=a(i(t)),d=o(n),p=f.length;return d<0||d>=p?e?"":void 0:(r=c(f,d))<55296||r>56319||d+1===p||(s=c(f,d+1))<56320||s>57343?e?l(f,d):r:e?u(f,d,d+2):s-56320+(r-55296<<10)+65536}};e.exports={codeAt:s(!1),charAt:s(!0)}},2424:function(e,t,n){"use strict";var r=n(9252),o=2147483647,a=/[^\0-\u007E]/,i=/[.\u3002\uFF0E\uFF61]/g,l="Overflow: input needs wider integers to process",c=RangeError,u=r(i.exec),s=Math.floor,f=String.fromCharCode,d=r("".charCodeAt),p=r([].join),v=r([].push),m=r("".replace),g=r("".split),h=r("".toLowerCase),y=function(e){return e+22+75*(e<26)},b=function(e,t,n){var r=0;for(e=n?s(e/700):e>>1,e+=s(e/t);e>455;)e=s(e/35),r+=36;return s(r+36*e/(e+38))},C=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=d(e,n++);if(o>=55296&&o<=56319&&n<r){var a=d(e,n++);56320==(64512&a)?v(t,((1023&o)<<10)+(1023&a)+65536):(v(t,o),n--)}else v(t,o)}return t}(e);var n,r,a=e.length,i=128,u=0,m=72;for(n=0;n<e.length;n++)(r=e[n])<128&&v(t,f(r));var g=t.length,h=g;for(g&&v(t,"-");h<a;){var C=o;for(n=0;n<e.length;n++)(r=e[n])>=i&&r<C&&(C=r);var E=h+1;if(C-i>s((o-u)/E))throw new c(l);for(u+=(C-i)*E,i=C,n=0;n<e.length;n++){if((r=e[n])<i&&++u>o)throw new c(l);if(r===i){for(var I=u,x=36;;){var N=x<=m?1:x>=m+26?26:x-m;if(I<N)break;var T=I-N,A=36-N;v(t,f(y(N+T%A))),I=s(T/A),x+=36}v(t,f(y(I))),m=b(u,E,h===g),u=0,h++}}u++,i++}return p(t,"")};e.exports=function(e){var t,n,r=[],o=g(m(h(e),i,"."),".");for(t=0;t<o.length;t++)n=o[t],v(r,u(a,n)?"xn--"+C(n):n);return p(r,".")}},4144:function(e,t,n){"use strict";var r=n(3564).PROPER,o=n(2064),a=n(5276);e.exports=function(e){return o((function(){return!!a[e]()||"​᠎"!=="​᠎"[e]()||r&&a[e].name!==e}))}},6832:function(e,t,n){"use strict";var r=n(9252),o=n(9952),a=n(9352),i=n(5276),l=r("".replace),c=RegExp("^["+i+"]+"),u=RegExp("(^|[^"+i+"])["+i+"]+$"),s=function(e){return function(t){var n=a(o(t));return 1&e&&(n=l(n,c,"")),2&e&&(n=l(n,u,"$1")),n}};e.exports={start:s(1),end:s(2),trim:s(3)}},5235:function(e,t,n){"use strict";var r=n(3896),o=n(2064),a=n(5216).String;e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol("symbol detection");return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},72:function(e,t,n){"use strict";var r=n(4580),o=n(3464),a=n(3336),i=n(5424);e.exports=function(){var e=o("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,l=a("toPrimitive");t&&!t[l]&&i(t,l,(function(e){return r(n,this)}),{arity:1})}},5080:function(e,t,n){"use strict";var r=n(3464),o=n(9252),a=r("Symbol"),i=a.keyFor,l=o(a.prototype.valueOf);e.exports=a.isRegisteredSymbol||function(e){try{return void 0!==i(l(e))}catch(e){return!1}}},2636:function(e,t,n){"use strict";for(var r=n(8852),o=n(3464),a=n(9252),i=n(5376),l=n(3336),c=o("Symbol"),u=c.isWellKnownSymbol,s=o("Object","getOwnPropertyNames"),f=a(c.prototype.valueOf),d=r("wks"),p=0,v=s(c),m=v.length;p<m;p++)try{var g=v[p];i(c[g])&&l(g)}catch(e){}e.exports=function(e){if(u&&u(e))return!0;try{for(var t=f(e),n=0,r=s(d),o=r.length;n<o;n++)if(d[r[n]]==t)return!0}catch(e){}return!1}},7780:function(e,t,n){"use strict";var r=n(5235);e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},3368:function(e,t,n){"use strict";var r,o,a,i,l=n(5216),c=n(9867),u=n(1884),s=n(8536),f=n(4664),d=n(2064),p=n(7896),v=n(940),m=n(1940),g=n(3492),h=n(6772),y=n(1432),b=l.setImmediate,C=l.clearImmediate,E=l.process,I=l.Dispatch,x=l.Function,N=l.MessageChannel,T=l.String,A=0,S={},w="onreadystatechange";d((function(){r=l.location}));var F=function(e){if(f(S,e)){var t=S[e];delete S[e],t()}},k=function(e){return function(){F(e)}},D=function(e){F(e.data)},P=function(e){l.postMessage(T(e),r.protocol+"//"+r.host)};b&&C||(b=function(e){g(arguments.length,1);var t=s(e)?e:x(e),n=v(arguments,1);return S[++A]=function(){c(t,void 0,n)},o(A),A},C=function(e){delete S[e]},y?o=function(e){E.nextTick(k(e))}:I&&I.now?o=function(e){I.now(k(e))}:N&&!h?(i=(a=new N).port2,a.port1.onmessage=D,o=u(i.postMessage,i)):l.addEventListener&&s(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!d(P)?(o=P,l.addEventListener("message",D,!1)):o=w in m("script")?function(e){p.appendChild(m("script"))[w]=function(){p.removeChild(this),F(e)}}:function(e){setTimeout(k(e),0)}),e.exports={set:b,clear:C}},4180:function(e,t,n){"use strict";var r=n(5016),o=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):a(n,t)}},445:function(e,t,n){"use strict";var r=n(2899),o=n(9952);e.exports=function(e){return r(o(e))}},5016:function(e,t,n){"use strict";var r=n(24);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},4596:function(e,t,n){"use strict";var r=n(5016),o=Math.min;e.exports=function(e){var t=r(e);return t>0?o(t,9007199254740991):0}},2819:function(e,t,n){"use strict";var r=n(9952),o=Object;e.exports=function(e){return o(r(e))}},3504:function(e,t,n){"use strict";var r=n(4580),o=n(8608),a=n(5376),i=n(1636),l=n(416),c=n(3336),u=TypeError,s=c("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,c=i(e,s);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!o(n)||a(n))return n;throw new u("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},2319:function(e,t,n){"use strict";var r=n(3504),o=n(5376);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},6744:function(e,t,n){"use strict";var r={};r[n(3336)("toStringTag")]="z",e.exports="[object z]"===String(r)},9352:function(e,t,n){"use strict";var r=n(636),o=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return o(e)}},8944:function(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},6696:function(e,t,n){"use strict";var r=n(9252),o=0,a=Math.random(),i=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+i(++o+a,36)}},928:function(e,t,n){"use strict";var r=n(2064),o=n(3336),a=n(9172),i=n(1016),l=o("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),n.delete("a",2),n.delete("b",void 0),i&&(!e.toJSON||!n.has("a",1)||n.has("a",2)||!n.has("a",void 0)||n.has("b"))||!t.size&&(i||!a)||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[l]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},6416:function(e,t,n){"use strict";var r=n(5235);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3109:function(e,t,n){"use strict";var r=n(9172),o=n(2064);e.exports=r&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},3492:function(e){"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},3184:function(e,t,n){"use strict";var r=n(5216),o=n(8536),a=r.WeakMap;e.exports=o(a)&&/native code/.test(String(a))},1084:function(e,t,n){"use strict";var r=n(9832),o=n(4664),a=n(1104),i=n(2280).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||i(t,e,{value:a.f(e)})}},1104:function(e,t,n){"use strict";var r=n(3336);t.f=r},3336:function(e,t,n){"use strict";var r=n(5216),o=n(8852),a=n(4664),i=n(6696),l=n(5235),c=n(6416),u=r.Symbol,s=o("wks"),f=c?u.for||u:u&&u.withoutSetter||i;e.exports=function(e){return a(s,e)||(s[e]=l&&a(u,e)?u[e]:f("Symbol."+e)),s[e]}},5276:function(e){"use strict";e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},9232:function(e,t,n){"use strict";var r=n(3952),o=n(2360),a=n(7800),i=n(2288),l=n(1100),c=n(4488),u=n(896),s=n(8981),f=n(9055),d=n(9035),p=n(5799),v=n(3080),m=n(3336)("toStringTag"),g=Error,h=[].push,y=function(e,t){var n,r=o(b,this);i?n=i(new g,r?a(this):b):(n=r?this:c(b),u(n,m,"Error")),void 0!==t&&u(n,"message",v(t)),d(n,y,n.stack,1),arguments.length>2&&f(n,arguments[2]);var l=[];return p(e,h,{that:l}),u(n,"errors",l),n};i?i(y,g):l(y,g,{name:!0});var b=y.prototype=c(g.prototype,{constructor:s(1,y),message:s(1,""),name:s(1,"AggregateError")});r({global:!0,constructor:!0,arity:2},{AggregateError:y})},816:function(e,t,n){"use strict";n(9232)},2216:function(e,t,n){"use strict";var r=n(3952),o=n(2064),a=n(3204),i=n(8608),l=n(2819),c=n(5316),u=n(8200),s=n(4895),f=n(4872),d=n(5384),p=n(3336),v=n(3896),m=p("isConcatSpreadable"),g=v>=51||!o((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),h=function(e){if(!i(e))return!1;var t=e[m];return void 0!==t?!!t:a(e)};r({target:"Array",proto:!0,arity:1,forced:!g||!d("concat")},{concat:function(e){var t,n,r,o,a,i=l(this),d=f(i,0),p=0;for(t=-1,r=arguments.length;t<r;t++)if(h(a=-1===t?i:arguments[t]))for(o=c(a),u(p+o),n=0;n<o;n++,p++)n in a&&s(d,p,a[n]);else u(p+1),s(d,p++,a);return d.length=p,d}})},4124:function(e,t,n){"use strict";var r=n(3952),o=n(3028),a=n(1472);r({target:"Array",proto:!0},{fill:o}),a("fill")},4864:function(e,t,n){"use strict";var r=n(3952),o=n(7608).filter;r({target:"Array",proto:!0,forced:!n(5384)("filter")},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},8628:function(e,t,n){"use strict";var r=n(3952),o=n(7608).findIndex,a=n(1472),i="findIndex",l=!0;i in[]&&Array(1)[i]((function(){l=!1})),r({target:"Array",proto:!0,forced:l},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a(i)},6952:function(e,t,n){"use strict";var r=n(3952),o=n(7608).find,a=n(1472),i="find",l=!0;i in[]&&Array(1)[i]((function(){l=!1})),r({target:"Array",proto:!0,forced:l},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a(i)},7572:function(e,t,n){"use strict";var r=n(3952),o=n(9980);r({target:"Array",stat:!0,forced:!n(347)((function(e){Array.from(e)}))},{from:o})},6504:function(e,t,n){"use strict";var r=n(3952),o=n(7464).includes,a=n(2064),i=n(1472);r({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},1904:function(e,t,n){"use strict";var r=n(3952),o=n(1248),a=n(7464).indexOf,i=n(4888),l=o([].indexOf),c=!!l&&1/l([1],1,-0)<0;r({target:"Array",proto:!0,forced:c||!i("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return c?l(this,e,t)||0:a(this,e,t)}})},3276:function(e,t,n){"use strict";n(3952)({target:"Array",stat:!0},{isArray:n(3204)})},340:function(e,t,n){"use strict";var r=n(445),o=n(1472),a=n(7256),i=n(2344),l=n(2280).f,c=n(536),u=n(3848),s=n(1016),f=n(9172),d="Array Iterator",p=i.set,v=i.getterFor(d);e.exports=c(Array,"Array",(function(e,t){p(this,{type:d,target:r(e),index:0,kind:t})}),(function(){var e=v(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=void 0,u(void 0,!0);switch(e.kind){case"keys":return u(n,!1);case"values":return u(t[n],!1)}return u([n,t[n]],!1)}),"values");var m=a.Arguments=a.Array;if(o("keys"),o("values"),o("entries"),!s&&f&&"values"!==m.name)try{l(m,"name",{value:"values"})}catch(e){}},7092:function(e,t,n){"use strict";var r=n(3952),o=n(7608).map;r({target:"Array",proto:!0,forced:!n(5384)("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},3948:function(e,t,n){"use strict";var r=n(3952),o=n(2819),a=n(5316),i=n(1716),l=n(8200);r({target:"Array",proto:!0,arity:1,forced:n(2064)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=o(this),n=a(t),r=arguments.length;l(n+r);for(var c=0;c<r;c++)t[n]=arguments[c],n++;return i(t,n),n}})},5863:function(e,t,n){"use strict";var r=n(3952),o=n(3204),a=n(9496),i=n(8608),l=n(4180),c=n(5316),u=n(445),s=n(4895),f=n(3336),d=n(5384),p=n(940),v=d("slice"),m=f("species"),g=Array,h=Math.max;r({target:"Array",proto:!0,forced:!v},{slice:function(e,t){var n,r,f,d=u(this),v=c(d),y=l(e,v),b=l(void 0===t?v:t,v);if(o(d)&&(n=d.constructor,(a(n)&&(n===g||o(n.prototype))||i(n)&&null===(n=n[m]))&&(n=void 0),n===g||void 0===n))return p(d,y,b);for(r=new(void 0===n?g:n)(h(b-y,0)),f=0;y<b;y++,f++)y in d&&s(r,f,d[y]);return r.length=f,r}})},8280:function(e,t,n){"use strict";var r=n(3952),o=n(9252),a=n(28),i=n(2819),l=n(5316),c=n(6940),u=n(9352),s=n(2064),f=n(3864),d=n(4888),p=n(7587),v=n(6028),m=n(3896),g=n(1244),h=[],y=o(h.sort),b=o(h.push),C=s((function(){h.sort(void 0)})),E=s((function(){h.sort(null)})),I=d("sort"),x=!s((function(){if(m)return m<70;if(!(p&&p>3)){if(v)return!0;if(g)return g<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)h.push({k:t+r,v:n})}for(h.sort((function(e,t){return t.v-e.v})),r=0;r<h.length;r++)t=h[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));r({target:"Array",proto:!0,forced:C||!E||!I||!x},{sort:function(e){void 0!==e&&a(e);var t=i(this);if(x)return void 0===e?y(t):y(t,e);var n,r,o=[],s=l(t);for(r=0;r<s;r++)r in t&&b(o,t[r]);for(f(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}}(e)),n=l(o),r=0;r<n;)t[r]=o[r++];for(;r<s;)c(t,r++);return t}})},4152:function(e,t,n){"use strict";var r=n(3952),o=n(2819),a=n(4180),i=n(5016),l=n(5316),c=n(1716),u=n(8200),s=n(4872),f=n(4895),d=n(6940),p=n(5384)("splice"),v=Math.max,m=Math.min;r({target:"Array",proto:!0,forced:!p},{splice:function(e,t){var n,r,p,g,h,y,b=o(this),C=l(b),E=a(e,C),I=arguments.length;for(0===I?n=r=0:1===I?(n=0,r=C-E):(n=I-2,r=m(v(i(t),0),C-E)),u(C+n-r),p=s(b,r),g=0;g<r;g++)(h=E+g)in b&&f(p,g,b[h]);if(p.length=r,n<r){for(g=E;g<C-r;g++)y=g+n,(h=g+r)in b?b[y]=b[h]:d(b,y);for(g=C;g>C-r+n;g--)d(b,g-1)}else if(n>r)for(g=C-r;g>E;g--)y=g+n-1,(h=g+r-1)in b?b[y]=b[h]:d(b,y);for(g=0;g<n;g++)b[g+E]=arguments[g+2];return c(b,C-r+n),p}})},7532:function(){},4388:function(e,t,n){"use strict";var r=n(3952),o=n(5404);r({target:"Function",proto:!0,forced:Function.bind!==o},{bind:o})},8824:function(e,t,n){"use strict";var r=n(3952),o=n(3464),a=n(9867),i=n(4580),l=n(9252),c=n(2064),u=n(8536),s=n(5376),f=n(940),d=n(3676),p=n(5235),v=String,m=o("JSON","stringify"),g=l(/./.exec),h=l("".charAt),y=l("".charCodeAt),b=l("".replace),C=l(1..toString),E=/[\uD800-\uDFFF]/g,I=/^[\uD800-\uDBFF]$/,x=/^[\uDC00-\uDFFF]$/,N=!p||c((function(){var e=o("Symbol")("stringify detection");return"[null]"!==m([e])||"{}"!==m({a:e})||"{}"!==m(Object(e))})),T=c((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),A=function(e,t){var n=f(arguments),r=d(t);if(u(r)||void 0!==e&&!s(e))return n[1]=function(e,t){if(u(r)&&(t=i(r,this,v(e),t)),!s(t))return t},a(m,null,n)},S=function(e,t,n){var r=h(n,t-1),o=h(n,t+1);return g(I,e)&&!g(x,o)||g(x,e)&&!g(I,r)?"\\u"+C(y(e,0),16):e};m&&r({target:"JSON",stat:!0,arity:3,forced:N||T},{stringify:function(e,t,n){var r=f(arguments),o=a(N?A:m,null,r);return T&&"string"==typeof o?b(o,E,S):o}})},7548:function(e,t,n){"use strict";var r=n(5216);n(5836)(r.JSON,"JSON",!0)},4316:function(e,t,n){"use strict";n(6072)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(3928))},2648:function(e,t,n){"use strict";var r=n(3952),o=n(9252),a=n(28),i=n(9952),l=n(5799),c=n(2408),u=n(1016),s=c.Map,f=c.has,d=c.get,p=c.set,v=o([].push);r({target:"Map",stat:!0,forced:u},{groupBy:function(e,t){i(e),a(t);var n=new s,r=0;return l(e,(function(e){var o=t(e,r++);f(n,o)?v(d(n,o),e):p(n,o,[e])})),n}})},6775:function(e,t,n){"use strict";n(4316)},3787:function(){},6448:function(e,t,n){"use strict";var r=n(3952),o=n(8980);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},8708:function(e,t,n){"use strict";var r=n(3952),o=n(9172),a=n(2280).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==a,sham:!o},{defineProperty:a})},6360:function(e,t,n){"use strict";var r=n(3952),o=n(2768).entries;r({target:"Object",stat:!0},{entries:function(e){return o(e)}})},7648:function(e,t,n){"use strict";var r=n(3952),o=n(2064),a=n(445),i=n(1008).f,l=n(9172);r({target:"Object",stat:!0,forced:!l||o((function(){i(1)})),sham:!l},{getOwnPropertyDescriptor:function(e,t){return i(a(e),t)}})},5032:function(e,t,n){"use strict";var r=n(3952),o=n(9172),a=n(7876),i=n(445),l=n(1008),c=n(4895);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){for(var t,n,r=i(e),o=l.f,u=a(r),s={},f=0;u.length>f;)void 0!==(n=o(r,t=u[f++]))&&c(s,t,n);return s}})},9672:function(e,t,n){"use strict";var r=n(3952),o=n(5235),a=n(2064),i=n(4060),l=n(2819);r({target:"Object",stat:!0,forced:!o||a((function(){i.f(1)}))},{getOwnPropertySymbols:function(e){var t=i.f;return t?t(l(e)):[]}})},88:function(e,t,n){"use strict";var r=n(3952),o=n(2819),a=n(9547);r({target:"Object",stat:!0,forced:n(2064)((function(){a(1)}))},{keys:function(e){return a(o(e))}})},2352:function(){},7016:function(e,t,n){"use strict";var r=n(3952),o=n(2768).values;r({target:"Object",stat:!0},{values:function(e){return o(e)}})},8128:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(28),i=n(1243),l=n(5240),c=n(5799);r({target:"Promise",stat:!0,forced:n(4880)},{allSettled:function(e){var t=this,n=i.f(t),r=n.resolve,u=n.reject,s=l((function(){var n=a(t.resolve),i=[],l=0,u=1;c(e,(function(e){var a=l++,c=!1;u++,o(n,t,e).then((function(e){c||(c=!0,i[a]={status:"fulfilled",value:e},--u||r(i))}),(function(e){c||(c=!0,i[a]={status:"rejected",reason:e},--u||r(i))}))})),--u||r(i)}));return s.error&&u(s.value),n.promise}})},1572:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(28),i=n(1243),l=n(5240),c=n(5799);r({target:"Promise",stat:!0,forced:n(4880)},{all:function(e){var t=this,n=i.f(t),r=n.resolve,u=n.reject,s=l((function(){var n=a(t.resolve),i=[],l=0,s=1;c(e,(function(e){var a=l++,c=!1;s++,o(n,t,e).then((function(e){c||(c=!0,i[a]=e,--s||r(i))}),u)})),--s||r(i)}));return s.error&&u(s.value),n.promise}})},3728:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(28),i=n(3464),l=n(1243),c=n(5240),u=n(5799),s=n(4880),f="No one promise resolved";r({target:"Promise",stat:!0,forced:s},{any:function(e){var t=this,n=i("AggregateError"),r=l.f(t),s=r.resolve,d=r.reject,p=c((function(){var r=a(t.resolve),i=[],l=0,c=1,p=!1;u(e,(function(e){var a=l++,u=!1;c++,o(r,t,e).then((function(e){u||p||(p=!0,s(e))}),(function(e){u||p||(u=!0,i[a]=e,--c||d(new n(i,f)))}))})),--c||d(new n(i,f))}));return p.error&&d(p.value),r.promise}})},2996:function(e,t,n){"use strict";var r=n(3952),o=n(1016),a=n(5524).CONSTRUCTOR,i=n(728),l=n(3464),c=n(8536),u=n(5424),s=i&&i.prototype;if(r({target:"Promise",proto:!0,forced:a,real:!0},{catch:function(e){return this.then(void 0,e)}}),!o&&c(i)){var f=l("Promise").prototype.catch;s.catch!==f&&u(s,"catch",f,{unsafe:!0})}},6160:function(e,t,n){"use strict";var r,o,a,i=n(3952),l=n(1016),c=n(1432),u=n(5216),s=n(4580),f=n(5424),d=n(2288),p=n(5836),v=n(3120),m=n(28),g=n(8536),h=n(8608),y=n(4572),b=n(4928),C=n(3368).set,E=n(9836),I=n(3320),x=n(5240),N=n(8604),T=n(2344),A=n(728),S=n(5524),w=n(1243),F="Promise",k=S.CONSTRUCTOR,D=S.REJECTION_EVENT,P=S.SUBCLASSING,M=T.getterFor(F),R=T.set,_=A&&A.prototype,O=A,B=_,j=u.TypeError,L=u.document,U=u.process,K=w.f,V=K,z=!!(L&&L.createEvent&&u.dispatchEvent),G="unhandledrejection",H=function(e){var t;return!(!h(e)||!g(t=e.then))&&t},q=function(e,t){var n,r,o,a=t.value,i=1===t.state,l=i?e.ok:e.fail,c=e.resolve,u=e.reject,f=e.domain;try{l?(i||(2===t.rejection&&Z(t),t.rejection=1),!0===l?n=a:(f&&f.enter(),n=l(a),f&&(f.exit(),o=!0)),n===e.promise?u(new j("Promise-chain cycle")):(r=H(n))?s(r,n,c,u):c(n)):u(a)}catch(e){f&&!o&&f.exit(),u(e)}},Y=function(e,t){e.notified||(e.notified=!0,E((function(){for(var n,r=e.reactions;n=r.get();)q(n,e);e.notified=!1,t&&!e.rejection&&Q(e)})))},W=function(e,t,n){var r,o;z?((r=L.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},!D&&(o=u["on"+e])?o(r):e===G&&I("Unhandled promise rejection",n)},Q=function(e){s(C,u,(function(){var t,n=e.facade,r=e.value;if(X(e)&&(t=x((function(){c?U.emit("unhandledRejection",r,n):W(G,n,r)})),e.rejection=c||X(e)?2:1,t.error))throw t.value}))},X=function(e){return 1!==e.rejection&&!e.parent},Z=function(e){s(C,u,(function(){var t=e.facade;c?U.emit("rejectionHandled",t):W("rejectionhandled",t,e.value)}))},J=function(e,t,n){return function(r){e(t,r,n)}},$=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Y(e,!0))},ee=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw new j("Promise can't be resolved itself");var r=H(t);r?E((function(){var n={done:!1};try{s(r,t,J(ee,n,e),J($,n,e))}catch(t){$(n,t,e)}})):(e.value=t,e.state=1,Y(e,!1))}catch(t){$({done:!1},t,e)}}};if(k&&(B=(O=function(e){y(this,B),m(e),s(r,this);var t=M(this);try{e(J(ee,t),J($,t))}catch(e){$(t,e)}}).prototype,(r=function(e){R(this,{type:F,done:!1,notified:!1,parent:!1,reactions:new N,rejection:!1,state:0,value:void 0})}).prototype=f(B,"then",(function(e,t){var n=M(this),r=K(b(this,O));return n.parent=!0,r.ok=!g(e)||e,r.fail=g(t)&&t,r.domain=c?U.domain:void 0,0===n.state?n.reactions.add(r):E((function(){q(r,n)})),r.promise})),o=function(){var e=new r,t=M(e);this.promise=e,this.resolve=J(ee,t),this.reject=J($,t)},w.f=K=function(e){return e===O||undefined===e?new o(e):V(e)},!l&&g(A)&&_!==Object.prototype)){a=_.then,P||f(_,"then",(function(e,t){var n=this;return new O((function(e,t){s(a,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete _.constructor}catch(e){}d&&d(_,B)}i({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:O}),p(O,F,!1,!0),v(F)},196:function(e,t,n){"use strict";var r=n(3952),o=n(1016),a=n(728),i=n(2064),l=n(3464),c=n(8536),u=n(4928),s=n(7211),f=n(5424),d=a&&a.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!a&&i((function(){d.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=u(this,l("Promise")),n=c(e);return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}}),!o&&c(a)){var p=l("Promise").prototype.finally;d.finally!==p&&f(d,"finally",p,{unsafe:!0})}},6244:function(e,t,n){"use strict";n(6160),n(1572),n(2996),n(9348),n(4072),n(5832)},9348:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(28),i=n(1243),l=n(5240),c=n(5799);r({target:"Promise",stat:!0,forced:n(4880)},{race:function(e){var t=this,n=i.f(t),r=n.reject,u=l((function(){var i=a(t.resolve);c(e,(function(e){o(i,t,e).then(n.resolve,r)}))}));return u.error&&r(u.value),n.promise}})},4072:function(e,t,n){"use strict";var r=n(3952),o=n(1243);r({target:"Promise",stat:!0,forced:n(5524).CONSTRUCTOR},{reject:function(e){var t=o.f(this);return(0,t.reject)(e),t.promise}})},5832:function(e,t,n){"use strict";var r=n(3952),o=n(3464),a=n(1016),i=n(728),l=n(5524).CONSTRUCTOR,c=n(7211),u=o("Promise"),s=a&&!l;r({target:"Promise",stat:!0,forced:a||l},{resolve:function(e){return c(s&&this===u?i:this,e)}})},96:function(e,t,n){"use strict";var r=n(3952),o=n(1243);r({target:"Promise",stat:!0},{withResolvers:function(){var e=o.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}})},3223:function(e,t,n){"use strict";var r=n(3952),o=n(2032),a=n(1008).f;r({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var n=a(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},3400:function(e,t,n){"use strict";n(3952)({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},9988:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(2032),i=n(8608),l=n(5072),c=n(2064),u=n(2280),s=n(1008),f=n(7800),d=n(8981);r({target:"Reflect",stat:!0,forced:c((function(){var e=function(){},t=u.f(new e,"a",{configurable:!0});return!1!==Reflect.set(e.prototype,"a",1,t)}))},{set:function e(t,n,r){var c,p,v,m=arguments.length<4?t:arguments[3],g=s.f(a(t),n);if(!g){if(i(p=f(t)))return e(p,n,r,m);g=d(0)}if(l(g)){if(!1===g.writable||!i(m))return!1;if(c=s.f(m,n)){if(c.get||c.set||!1===c.writable)return!1;c.value=r,u.f(m,n,c)}else u.f(m,n,d(0,r))}else{if(void 0===(v=g.set))return!1;o(v,m,r)}return!0}})},176:function(){},1204:function(){},6784:function(e,t,n){"use strict";n(6072)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(3928))},1160:function(e,t,n){"use strict";n(6784)},976:function(e,t,n){"use strict";var r,o=n(3952),a=n(1248),i=n(1008).f,l=n(4596),c=n(9352),u=n(9720),s=n(9952),f=n(660),d=n(1016),p=a("".slice),v=Math.min,m=f("endsWith");o({target:"String",proto:!0,forced:!!(d||m||(r=i(String.prototype,"endsWith"),!r||r.writable))&&!m},{endsWith:function(e){var t=c(s(this));u(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,o=void 0===n?r:v(l(n),r),a=c(e);return p(t,o-a.length,o)===a}})},3512:function(e,t,n){"use strict";var r=n(3952),o=n(9252),a=n(9720),i=n(9952),l=n(9352),c=n(660),u=o("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~u(l(i(this)),l(a(e)),arguments.length>1?arguments[1]:void 0)}})},4176:function(e,t,n){"use strict";var r=n(6392).charAt,o=n(9352),a=n(2344),i=n(536),l=n(3848),c="String Iterator",u=a.set,s=a.getterFor(c);i(String,"String",(function(e){u(this,{type:c,string:o(e),index:0})}),(function(){var e,t=s(this),n=t.string,o=t.index;return o>=n.length?l(void 0,!0):(e=r(n,o),t.index+=e.length,l(e,!1))}))},6988:function(e,t,n){"use strict";var r=n(3952),o=n(4580),a=n(9252),i=n(9952),l=n(8536),c=n(9511),u=n(9300),s=n(9352),f=n(1636),d=n(2840),p=n(1440),v=n(3336),m=n(1016),g=v("replace"),h=TypeError,y=a("".indexOf),b=a("".replace),C=a("".slice),E=Math.max;r({target:"String",proto:!0},{replaceAll:function(e,t){var n,r,a,v,I,x,N,T,A,S=i(this),w=0,F=0,k="";if(!c(e)){if((n=u(e))&&(r=s(i(d(e))),!~y(r,"g")))throw new h("`.replaceAll` does not allow non-global regexes");if(a=f(e,g))return o(a,e,S,t);if(m&&n)return b(s(S),e,t)}for(v=s(S),I=s(e),(x=l(t))||(t=s(t)),N=I.length,T=E(1,N),w=y(v,I);-1!==w;)A=x?s(t(I,w,v)):p(I,v,w,[],void 0,t),k+=C(v,F,w)+A,F=w+N,w=w+T>v.length?-1:y(v,I,w+T);return F<v.length&&(k+=C(v,F)),k}})},2008:function(){},6432:function(e,t,n){"use strict";var r,o=n(3952),a=n(1248),i=n(1008).f,l=n(4596),c=n(9352),u=n(9720),s=n(9952),f=n(660),d=n(1016),p=a("".slice),v=Math.min,m=f("startsWith");o({target:"String",proto:!0,forced:!!(d||m||(r=i(String.prototype,"startsWith"),!r||r.writable))&&!m},{startsWith:function(e){var t=c(s(this));u(e);var n=l(v(arguments.length>1?arguments[1]:void 0,t.length)),r=c(e);return p(t,n,n+r.length)===r}})},3003:function(e,t,n){"use strict";var r=n(3952),o=n(6832).trim;r({target:"String",proto:!0,forced:n(4144)("trim")},{trim:function(){return o(this)}})},2240:function(e,t,n){"use strict";n(1084)("asyncIterator")},3840:function(e,t,n){"use strict";var r=n(3952),o=n(5216),a=n(4580),i=n(9252),l=n(1016),c=n(9172),u=n(5235),s=n(2064),f=n(4664),d=n(2360),p=n(2032),v=n(445),m=n(2319),g=n(9352),h=n(8981),y=n(4488),b=n(9547),C=n(1600),E=n(1920),I=n(4060),x=n(1008),N=n(2280),T=n(6452),A=n(6500),S=n(5424),w=n(6968),F=n(8852),k=n(924),D=n(3328),P=n(6696),M=n(3336),R=n(1104),_=n(1084),O=n(72),B=n(5836),j=n(2344),L=n(7608).forEach,U=k("hidden"),K="Symbol",V="prototype",z=j.set,G=j.getterFor(K),H=Object[V],q=o.Symbol,Y=q&&q[V],W=o.RangeError,Q=o.TypeError,X=o.QObject,Z=x.f,J=N.f,$=E.f,ee=A.f,te=i([].push),ne=F("symbols"),re=F("op-symbols"),oe=F("wks"),ae=!X||!X[V]||!X[V].findChild,ie=function(e,t,n){var r=Z(H,t);r&&delete H[t],J(e,t,n),r&&e!==H&&J(H,t,r)},le=c&&s((function(){return 7!==y(J({},"a",{get:function(){return J(this,"a",{value:7}).a}})).a}))?ie:J,ce=function(e,t){var n=ne[e]=y(Y);return z(n,{type:K,tag:e,description:t}),c||(n.description=t),n},ue=function(e,t,n){e===H&&ue(re,t,n),p(e);var r=m(t);return p(n),f(ne,r)?(n.enumerable?(f(e,U)&&e[U][r]&&(e[U][r]=!1),n=y(n,{enumerable:h(0,!1)})):(f(e,U)||J(e,U,h(1,y(null))),e[U][r]=!0),le(e,r,n)):J(e,r,n)},se=function(e,t){p(e);var n=v(t),r=b(n).concat(ve(n));return L(r,(function(t){c&&!a(fe,n,t)||ue(e,t,n[t])})),e},fe=function(e){var t=m(e),n=a(ee,this,t);return!(this===H&&f(ne,t)&&!f(re,t))&&(!(n||!f(this,t)||!f(ne,t)||f(this,U)&&this[U][t])||n)},de=function(e,t){var n=v(e),r=m(t);if(n!==H||!f(ne,r)||f(re,r)){var o=Z(n,r);return!o||!f(ne,r)||f(n,U)&&n[U][r]||(o.enumerable=!0),o}},pe=function(e){var t=$(v(e)),n=[];return L(t,(function(e){f(ne,e)||f(D,e)||te(n,e)})),n},ve=function(e){var t=e===H,n=$(t?re:v(e)),r=[];return L(n,(function(e){!f(ne,e)||t&&!f(H,e)||te(r,ne[e])})),r};u||(q=function(){if(d(Y,this))throw new Q("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,t=P(e),n=function(e){var r=void 0===this?o:this;r===H&&a(n,re,e),f(r,U)&&f(r[U],t)&&(r[U][t]=!1);var i=h(1,e);try{le(r,t,i)}catch(e){if(!(e instanceof W))throw e;ie(r,t,i)}};return c&&ae&&le(H,t,{configurable:!0,set:n}),ce(t,e)},S(Y=q[V],"toString",(function(){return G(this).tag})),S(q,"withoutSetter",(function(e){return ce(P(e),e)})),A.f=fe,N.f=ue,T.f=se,x.f=de,C.f=E.f=pe,I.f=ve,R.f=function(e){return ce(M(e),e)},c&&(w(Y,"description",{configurable:!0,get:function(){return G(this).description}}),l||S(H,"propertyIsEnumerable",fe,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!u,sham:!u},{Symbol:q}),L(b(oe),(function(e){_(e)})),r({target:K,stat:!0,forced:!u},{useSetter:function(){ae=!0},useSimple:function(){ae=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!c},{create:function(e,t){return void 0===t?y(e):se(y(e),t)},defineProperty:ue,defineProperties:se,getOwnPropertyDescriptor:de}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:pe}),O(),B(q,K),D[U]=!0},9452:function(){},8539:function(e,t,n){"use strict";var r=n(3952),o=n(3464),a=n(4664),i=n(9352),l=n(8852),c=n(7780),u=l("string-to-symbol-registry"),s=l("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(e){var t=i(e);if(a(u,t))return u[t];var n=o("Symbol")(t);return u[t]=n,s[n]=t,n}})},1344:function(e,t,n){"use strict";n(1084)("hasInstance")},4436:function(e,t,n){"use strict";n(1084)("isConcatSpreadable")},6992:function(e,t,n){"use strict";n(1084)("iterator")},9276:function(e,t,n){"use strict";n(3840),n(8539),n(1896),n(8824),n(9672)},1896:function(e,t,n){"use strict";var r=n(3952),o=n(4664),a=n(5376),i=n(8944),l=n(8852),c=n(7780),u=l("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(e){if(!a(e))throw new TypeError(i(e)+" is not a symbol");if(o(u,e))return u[e]}})},6380:function(e,t,n){"use strict";n(1084)("matchAll")},8028:function(e,t,n){"use strict";n(1084)("match")},6176:function(e,t,n){"use strict";n(1084)("replace")},1176:function(e,t,n){"use strict";n(1084)("search")},781:function(e,t,n){"use strict";n(1084)("species")},6720:function(e,t,n){"use strict";n(1084)("split")},5536:function(e,t,n){"use strict";var r=n(1084),o=n(72);r("toPrimitive"),o()},4732:function(e,t,n){"use strict";var r=n(3464),o=n(1084),a=n(5836);o("toStringTag"),a(r("Symbol"),"Symbol")},4243:function(e,t,n){"use strict";n(1084)("unscopables")},6536:function(e,t,n){"use strict";var r=n(3336),o=n(2280).f,a=r("metadata"),i=Function.prototype;void 0===i[a]&&o(i,a,{value:null})},6508:function(e,t,n){"use strict";n(6988)},7576:function(e,t,n){"use strict";n(1084)("asyncDispose")},7772:function(e,t,n){"use strict";n(1084)("dispose")},9264:function(e,t,n){"use strict";n(3952)({target:"Symbol",stat:!0},{isRegisteredSymbol:n(5080)})},1216:function(e,t,n){"use strict";n(3952)({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:n(5080)})},8460:function(e,t,n){"use strict";n(3952)({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:n(2636)})},5196:function(e,t,n){"use strict";n(3952)({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:n(2636)})},4448:function(e,t,n){"use strict";n(1084)("matcher")},2948:function(e,t,n){"use strict";n(1084)("metadataKey")},5656:function(e,t,n){"use strict";n(1084)("metadata")},4184:function(e,t,n){"use strict";n(1084)("observable")},2252:function(e,t,n){"use strict";n(1084)("patternMatch")},6396:function(e,t,n){"use strict";n(1084)("replaceAll")},3624:function(e,t,n){"use strict";n(340);var r=n(472),o=n(5216),a=n(5836),i=n(7256);for(var l in r)a(o[l],l),i[l]=i.Array},1624:function(e,t,n){"use strict";n(340);var r=n(3952),o=n(5216),a=n(4604),i=n(4580),l=n(9252),c=n(9172),u=n(928),s=n(5424),f=n(6968),d=n(8104),p=n(5836),v=n(9976),m=n(2344),g=n(4572),h=n(8536),y=n(4664),b=n(1884),C=n(636),E=n(2032),I=n(8608),x=n(9352),N=n(4488),T=n(8981),A=n(4656),S=n(68),w=n(3848),F=n(3492),k=n(3336),D=n(3864),P=k("iterator"),M="URLSearchParams",R=M+"Iterator",_=m.set,O=m.getterFor(M),B=m.getterFor(R),j=a("fetch"),L=a("Request"),U=a("Headers"),K=L&&L.prototype,V=U&&U.prototype,z=o.RegExp,G=o.TypeError,H=o.decodeURIComponent,q=o.encodeURIComponent,Y=l("".charAt),W=l([].join),Q=l([].push),X=l("".replace),Z=l([].shift),J=l([].splice),$=l("".split),ee=l("".slice),te=/\+/g,ne=Array(4),re=function(e){return ne[e-1]||(ne[e-1]=z("((?:%[\\da-f]{2}){"+e+"})","gi"))},oe=function(e){try{return H(e)}catch(t){return e}},ae=function(e){var t=X(e,te," "),n=4;try{return H(t)}catch(e){for(;n;)t=X(t,re(n--),oe);return t}},ie=/[!'()~]|%20/g,le={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ce=function(e){return le[e]},ue=function(e){return X(q(e),ie,ce)},se=v((function(e,t){_(this,{type:R,target:O(e).entries,index:0,kind:t})}),M,(function(){var e=B(this),t=e.target,n=e.index++;if(!t||n>=t.length)return e.target=void 0,w(void 0,!0);var r=t[n];switch(e.kind){case"keys":return w(r.key,!1);case"values":return w(r.value,!1)}return w([r.key,r.value],!1)}),!0),fe=function(e){this.entries=[],this.url=null,void 0!==e&&(I(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===Y(e,0)?ee(e,1):e:x(e)))};fe.prototype={type:M,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,a,l,c,u=this.entries,s=S(e);if(s)for(n=(t=A(e,s)).next;!(r=i(n,t)).done;){if(a=(o=A(E(r.value))).next,(l=i(a,o)).done||(c=i(a,o)).done||!i(a,o).done)throw new G("Expected sequence with length 2");Q(u,{key:x(l.value),value:x(c.value)})}else for(var f in e)y(e,f)&&Q(u,{key:f,value:x(e[f])})},parseQuery:function(e){if(e)for(var t,n,r=this.entries,o=$(e,"&"),a=0;a<o.length;)(t=o[a++]).length&&(n=$(t,"="),Q(r,{key:ae(Z(n)),value:ae(W(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],Q(n,ue(e.key)+"="+ue(e.value));return W(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var de=function(){g(this,pe);var e=_(this,new fe(arguments.length>0?arguments[0]:void 0));c||(this.size=e.entries.length)},pe=de.prototype;if(d(pe,{append:function(e,t){var n=O(this);F(arguments.length,2),Q(n.entries,{key:x(e),value:x(t)}),c||this.length++,n.updateURL()},delete:function(e){for(var t=O(this),n=F(arguments.length,1),r=t.entries,o=x(e),a=n<2?void 0:arguments[1],i=void 0===a?a:x(a),l=0;l<r.length;){var u=r[l];if(u.key!==o||void 0!==i&&u.value!==i)l++;else if(J(r,l,1),void 0!==i)break}c||(this.size=r.length),t.updateURL()},get:function(e){var t=O(this).entries;F(arguments.length,1);for(var n=x(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){var t=O(this).entries;F(arguments.length,1);for(var n=x(e),r=[],o=0;o<t.length;o++)t[o].key===n&&Q(r,t[o].value);return r},has:function(e){for(var t=O(this).entries,n=F(arguments.length,1),r=x(e),o=n<2?void 0:arguments[1],a=void 0===o?o:x(o),i=0;i<t.length;){var l=t[i++];if(l.key===r&&(void 0===a||l.value===a))return!0}return!1},set:function(e,t){var n=O(this);F(arguments.length,1);for(var r,o=n.entries,a=!1,i=x(e),l=x(t),u=0;u<o.length;u++)(r=o[u]).key===i&&(a?J(o,u--,1):(a=!0,r.value=l));a||Q(o,{key:i,value:l}),c||(this.size=o.length),n.updateURL()},sort:function(){var e=O(this);D(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=O(this).entries,r=b(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)r((t=n[o++]).value,t.key,this)},keys:function(){return new se(this,"keys")},values:function(){return new se(this,"values")},entries:function(){return new se(this,"entries")}},{enumerable:!0}),s(pe,P,pe.entries,{name:"entries"}),s(pe,"toString",(function(){return O(this).serialize()}),{enumerable:!0}),c&&f(pe,"size",{get:function(){return O(this).entries.length},configurable:!0,enumerable:!0}),p(de,M),r({global:!0,constructor:!0,forced:!u},{URLSearchParams:de}),!u&&h(U)){var ve=l(V.has),me=l(V.set),ge=function(e){if(I(e)){var t,n=e.body;if(C(n)===M)return t=e.headers?new U(e.headers):new U,ve(t,"content-type")||me(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),N(e,{body:T(0,x(n)),headers:T(0,t)})}return e};if(h(j)&&r({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return j(e,arguments.length>1?ge(arguments[1]):{})}}),h(L)){var he=function(e){return g(this,K),new L(e,arguments.length>1?ge(arguments[1]):{})};K.constructor=he,he.prototype=K,r({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:he})}}e.exports={URLSearchParams:de,getState:O}},6372:function(){},3944:function(){},272:function(e,t,n){"use strict";n(1624)},8580:function(){},5188:function(e,t,n){"use strict";var r=n(3952),o=n(3464),a=n(2064),i=n(3492),l=n(9352),c=n(928),u=o("URL");r({target:"URL",stat:!0,forced:!(c&&a((function(){u.canParse()})))},{canParse:function(e){var t=i(arguments.length,1),n=l(e),r=t<2||void 0===arguments[1]?void 0:l(arguments[1]);try{return!!new u(n,r)}catch(e){return!1}}})},1488:function(e,t,n){"use strict";n(4176);var r,o=n(3952),a=n(9172),i=n(928),l=n(5216),c=n(1884),u=n(9252),s=n(5424),f=n(6968),d=n(4572),p=n(4664),v=n(8980),m=n(9980),g=n(940),h=n(6392).codeAt,y=n(2424),b=n(9352),C=n(5836),E=n(3492),I=n(1624),x=n(2344),N=x.set,T=x.getterFor("URL"),A=I.URLSearchParams,S=I.getState,w=l.URL,F=l.TypeError,k=l.parseInt,D=Math.floor,P=Math.pow,M=u("".charAt),R=u(/./.exec),_=u([].join),O=u(1..toString),B=u([].pop),j=u([].push),L=u("".replace),U=u([].shift),K=u("".split),V=u("".slice),z=u("".toLowerCase),G=u([].unshift),H="Invalid scheme",q="Invalid host",Y="Invalid port",W=/[a-z]/i,Q=/[\d+-.a-z]/i,X=/\d/,Z=/^0x/i,J=/^[0-7]+$/,$=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,re=/^[\u0000-\u0020]+/,oe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,ae=/[\t\n\r]/g,ie=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)G(t,e%256),e=D(e/256);return _(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,o=0,a=0;a<8;a++)0!==e[a]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=a),++o);return o>n&&(t=r,n=o),t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=O(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},le={},ce=v({},le,{" ":1,'"':1,"<":1,">":1,"`":1}),ue=v({},ce,{"#":1,"?":1,"{":1,"}":1}),se=v({},ue,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),fe=function(e,t){var n=h(e,0);return n>32&&n<127&&!p(t,e)?e:encodeURIComponent(e)},de={ftp:21,file:null,http:80,https:443,ws:80,wss:443},pe=function(e,t){var n;return 2===e.length&&R(W,M(e,0))&&(":"===(n=M(e,1))||!t&&"|"===n)},ve=function(e){var t;return e.length>1&&pe(V(e,0,2))&&(2===e.length||"/"===(t=M(e,2))||"\\"===t||"?"===t||"#"===t)},me=function(e){return"."===e||"%2e"===z(e)},ge={},he={},ye={},be={},Ce={},Ee={},Ie={},xe={},Ne={},Te={},Ae={},Se={},we={},Fe={},ke={},De={},Pe={},Me={},Re={},_e={},Oe={},Be=function(e,t,n){var r,o,a,i=b(e);if(t){if(o=this.parse(i))throw new F(o);this.searchParams=null}else{if(void 0!==n&&(r=new Be(n,!0)),o=this.parse(i,null,r))throw new F(o);(a=S(new A)).bindURL(this),this.searchParams=a}};Be.prototype={type:"URL",parse:function(e,t,n){var o,a,i,l,c,u=this,s=t||ge,f=0,d="",v=!1,h=!1,y=!1;for(e=b(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=L(e,re,""),e=L(e,oe,"$1")),e=L(e,ae,""),o=m(e);f<=o.length;){switch(a=o[f],s){case ge:if(!a||!R(W,a)){if(t)return H;s=ye;continue}d+=z(a),s=he;break;case he:if(a&&(R(Q,a)||"+"===a||"-"===a||"."===a))d+=z(a);else{if(":"!==a){if(t)return H;d="",s=ye,f=0;continue}if(t&&(u.isSpecial()!==p(de,d)||"file"===d&&(u.includesCredentials()||null!==u.port)||"file"===u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&de[u.scheme]===u.port&&(u.port=null));d="","file"===u.scheme?s=Fe:u.isSpecial()&&n&&n.scheme===u.scheme?s=be:u.isSpecial()?s=xe:"/"===o[f+1]?(s=Ce,f++):(u.cannotBeABaseURL=!0,j(u.path,""),s=Re)}break;case ye:if(!n||n.cannotBeABaseURL&&"#"!==a)return H;if(n.cannotBeABaseURL&&"#"===a){u.scheme=n.scheme,u.path=g(n.path),u.query=n.query,u.fragment="",u.cannotBeABaseURL=!0,s=Oe;break}s="file"===n.scheme?Fe:Ee;continue;case be:if("/"!==a||"/"!==o[f+1]){s=Ee;continue}s=Ne,f++;break;case Ce:if("/"===a){s=Te;break}s=Me;continue;case Ee:if(u.scheme=n.scheme,a===r)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=g(n.path),u.query=n.query;else if("/"===a||"\\"===a&&u.isSpecial())s=Ie;else if("?"===a)u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=g(n.path),u.query="",s=_e;else{if("#"!==a){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=g(n.path),u.path.length--,s=Me;continue}u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,u.path=g(n.path),u.query=n.query,u.fragment="",s=Oe}break;case Ie:if(!u.isSpecial()||"/"!==a&&"\\"!==a){if("/"!==a){u.username=n.username,u.password=n.password,u.host=n.host,u.port=n.port,s=Me;continue}s=Te}else s=Ne;break;case xe:if(s=Ne,"/"!==a||"/"!==M(d,f+1))continue;f++;break;case Ne:if("/"!==a&&"\\"!==a){s=Te;continue}break;case Te:if("@"===a){v&&(d="%40"+d),v=!0,i=m(d);for(var C=0;C<i.length;C++){var E=i[C];if(":"!==E||y){var I=fe(E,se);y?u.password+=I:u.username+=I}else y=!0}d=""}else if(a===r||"/"===a||"?"===a||"#"===a||"\\"===a&&u.isSpecial()){if(v&&""===d)return"Invalid authority";f-=m(d).length+1,d="",s=Ae}else d+=a;break;case Ae:case Se:if(t&&"file"===u.scheme){s=De;continue}if(":"!==a||h){if(a===r||"/"===a||"?"===a||"#"===a||"\\"===a&&u.isSpecial()){if(u.isSpecial()&&""===d)return q;if(t&&""===d&&(u.includesCredentials()||null!==u.port))return;if(l=u.parseHost(d))return l;if(d="",s=Pe,t)return;continue}"["===a?h=!0:"]"===a&&(h=!1),d+=a}else{if(""===d)return q;if(l=u.parseHost(d))return l;if(d="",s=we,t===Se)return}break;case we:if(!R(X,a)){if(a===r||"/"===a||"?"===a||"#"===a||"\\"===a&&u.isSpecial()||t){if(""!==d){var x=k(d,10);if(x>65535)return Y;u.port=u.isSpecial()&&x===de[u.scheme]?null:x,d=""}if(t)return;s=Pe;continue}return Y}d+=a;break;case Fe:if(u.scheme="file","/"===a||"\\"===a)s=ke;else{if(!n||"file"!==n.scheme){s=Me;continue}switch(a){case r:u.host=n.host,u.path=g(n.path),u.query=n.query;break;case"?":u.host=n.host,u.path=g(n.path),u.query="",s=_e;break;case"#":u.host=n.host,u.path=g(n.path),u.query=n.query,u.fragment="",s=Oe;break;default:ve(_(g(o,f),""))||(u.host=n.host,u.path=g(n.path),u.shortenPath()),s=Me;continue}}break;case ke:if("/"===a||"\\"===a){s=De;break}n&&"file"===n.scheme&&!ve(_(g(o,f),""))&&(pe(n.path[0],!0)?j(u.path,n.path[0]):u.host=n.host),s=Me;continue;case De:if(a===r||"/"===a||"\\"===a||"?"===a||"#"===a){if(!t&&pe(d))s=Me;else if(""===d){if(u.host="",t)return;s=Pe}else{if(l=u.parseHost(d))return l;if("localhost"===u.host&&(u.host=""),t)return;d="",s=Pe}continue}d+=a;break;case Pe:if(u.isSpecial()){if(s=Me,"/"!==a&&"\\"!==a)continue}else if(t||"?"!==a)if(t||"#"!==a){if(a!==r&&(s=Me,"/"!==a))continue}else u.fragment="",s=Oe;else u.query="",s=_e;break;case Me:if(a===r||"/"===a||"\\"===a&&u.isSpecial()||!t&&("?"===a||"#"===a)){if(".."===(c=z(c=d))||"%2e."===c||".%2e"===c||"%2e%2e"===c?(u.shortenPath(),"/"===a||"\\"===a&&u.isSpecial()||j(u.path,"")):me(d)?"/"===a||"\\"===a&&u.isSpecial()||j(u.path,""):("file"===u.scheme&&!u.path.length&&pe(d)&&(u.host&&(u.host=""),d=M(d,0)+":"),j(u.path,d)),d="","file"===u.scheme&&(a===r||"?"===a||"#"===a))for(;u.path.length>1&&""===u.path[0];)U(u.path);"?"===a?(u.query="",s=_e):"#"===a&&(u.fragment="",s=Oe)}else d+=fe(a,ue);break;case Re:"?"===a?(u.query="",s=_e):"#"===a?(u.fragment="",s=Oe):a!==r&&(u.path[0]+=fe(a,le));break;case _e:t||"#"!==a?a!==r&&("'"===a&&u.isSpecial()?u.query+="%27":u.query+="#"===a?"%23":fe(a,le)):(u.fragment="",s=Oe);break;case Oe:a!==r&&(u.fragment+=fe(a,ce))}f++}},parseHost:function(e){var t,n,r;if("["===M(e,0)){if("]"!==M(e,e.length-1))return q;if(t=function(e){var t,n,r,o,a,i,l,c=[0,0,0,0,0,0,0,0],u=0,s=null,f=0,d=function(){return M(e,f)};if(":"===d()){if(":"!==M(e,1))return;f+=2,s=++u}for(;d();){if(8===u)return;if(":"!==d()){for(t=n=0;n<4&&R(ee,d());)t=16*t+k(d(),16),f++,n++;if("."===d()){if(0===n)return;if(f-=n,u>6)return;for(r=0;d();){if(o=null,r>0){if(!("."===d()&&r<4))return;f++}if(!R(X,d()))return;for(;R(X,d());){if(a=k(d(),10),null===o)o=a;else{if(0===o)return;o=10*o+a}if(o>255)return;f++}c[u]=256*c[u]+o,2!=++r&&4!==r||u++}if(4!==r)return;break}if(":"===d()){if(f++,!d())return}else if(d())return;c[u++]=t}else{if(null!==s)return;f++,s=++u}}if(null!==s)for(i=u-s,u=7;0!==u&&i>0;)l=c[u],c[u--]=c[s+i-1],c[s+--i]=l;else if(8!==u)return;return c}(V(e,1,-1)),!t)return q;this.host=t}else if(this.isSpecial()){if(e=y(e),R(te,e))return q;if(t=function(e){var t,n,r,o,a,i,l,c=K(e,".");if(c.length&&""===c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""===(o=c[r]))return e;if(a=10,o.length>1&&"0"===M(o,0)&&(a=R(Z,o)?16:8,o=V(o,8===a?1:2)),""===o)i=0;else{if(!R(10===a?$:8===a?J:ee,o))return e;i=k(o,a)}j(n,i)}for(r=0;r<t;r++)if(i=n[r],r===t-1){if(i>=P(256,5-t))return null}else if(i>255)return null;for(l=B(n),r=0;r<n.length;r++)l+=n[r]*P(256,3-r);return l}(e),null===t)return q;this.host=t}else{if(R(ne,e))return q;for(t="",n=m(e),r=0;r<n.length;r++)t+=fe(n[r],le);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return p(de,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&pe(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,a=e.port,i=e.path,l=e.query,c=e.fragment,u=t+":";return null!==o?(u+="//",e.includesCredentials()&&(u+=n+(r?":"+r:"")+"@"),u+=ie(o),null!==a&&(u+=":"+a)):"file"===t&&(u+="//"),u+=e.cannotBeABaseURL?i[0]:i.length?"/"+_(i,"/"):"",null!==l&&(u+="?"+l),null!==c&&(u+="#"+c),u},setHref:function(e){var t=this.parse(e);if(t)throw new F(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new je(e.path[0]).origin}catch(e){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+ie(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",ge)},getUsername:function(){return this.username},setUsername:function(e){var t=m(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=fe(t[n],se)}},getPassword:function(){return this.password},setPassword:function(e){var t=m(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=fe(t[n],se)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ie(e):ie(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Ae)},getHostname:function(){var e=this.host;return null===e?"":ie(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Se)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=b(e))?this.port=null:this.parse(e,we))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+_(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Pe))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=b(e))?this.query=null:("?"===M(e,0)&&(e=V(e,1)),this.query="",this.parse(e,_e)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=b(e))?("#"===M(e,0)&&(e=V(e,1)),this.fragment="",this.parse(e,Oe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var je=function(e){var t=d(this,Le),n=E(arguments.length,1)>1?arguments[1]:void 0,r=N(t,new Be(e,!1,n));a||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Le=je.prototype,Ue=function(e,t){return{get:function(){return T(this)[e]()},set:t&&function(e){return T(this)[t](e)},configurable:!0,enumerable:!0}};if(a&&(f(Le,"href",Ue("serialize","setHref")),f(Le,"origin",Ue("getOrigin")),f(Le,"protocol",Ue("getProtocol","setProtocol")),f(Le,"username",Ue("getUsername","setUsername")),f(Le,"password",Ue("getPassword","setPassword")),f(Le,"host",Ue("getHost","setHost")),f(Le,"hostname",Ue("getHostname","setHostname")),f(Le,"port",Ue("getPort","setPort")),f(Le,"pathname",Ue("getPathname","setPathname")),f(Le,"search",Ue("getSearch","setSearch")),f(Le,"searchParams",Ue("getSearchParams")),f(Le,"hash",Ue("getHash","setHash"))),s(Le,"toJSON",(function(){return T(this).serialize()}),{enumerable:!0}),s(Le,"toString",(function(){return T(this).serialize()}),{enumerable:!0}),w){var Ke=w.createObjectURL,Ve=w.revokeObjectURL;Ke&&s(je,"createObjectURL",c(Ke,w)),Ve&&s(je,"revokeObjectURL",c(Ve,w))}C(je,"URL"),o({global:!0,constructor:!0,forced:!i,sham:!a},{URL:je})},4484:function(e,t,n){"use strict";n(1488)},7840:function(){},6128:function(e,t,n){"use strict";var r=n(9259);e.exports=r},1324:function(e,t,n){"use strict";var r=n(3376);e.exports=r},1056:function(e,t,n){"use strict";var r=n(7340);e.exports=r},984:function(e,t,n){"use strict";var r=n(4556);n(3624),e.exports=r},2960:function(e,t,n){"use strict";var r=n(4756);e.exports=r},1188:function(e,t,n){"use strict";var r=n(8884);e.exports=r},104:function(e,t,n){"use strict";var r=n(6172);e.exports=r},7444:function(e,t,n){"use strict";var r=n(8784);e.exports=r},8320:function(e,t,n){"use strict";var r=n(680);e.exports=r},3352:function(e,t,n){"use strict";var r=n(1231);e.exports=r},120:function(e,t,n){"use strict";var r=n(2600);e.exports=r},8760:function(e,t,n){"use strict";var r=n(8180);e.exports=r},5720:function(e,t,n){"use strict";var r=n(4156);e.exports=r},8776:function(e,t,n){"use strict";var r=n(1352);e.exports=r},5052:function(e,t,n){"use strict";var r=n(8896);e.exports=r},7339:function(e,t,n){"use strict";var r=n(7736);e.exports=r},7584:function(e,t,n){"use strict";var r=n(8688);e.exports=r},4644:function(e,t,n){"use strict";var r=n(3808);e.exports=r},9384:function(e,t,n){"use strict";var r=n(6312);e.exports=r},8812:function(e,t,n){"use strict";var r=n(1240);e.exports=r},9408:function(e,t,n){"use strict";var r=n(8125);e.exports=r},2612:function(e,t,n){"use strict";n(3624);var r=n(636),o=n(4664),a=n(2360),i=n(1056),l=Array.prototype,c={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.values;return e===l||a(l,e)&&t===l.values||o(c,r(e))?i:t}},9140:function(e,t,n){"use strict";var r=n(9304);e.exports=r},2572:function(e,t,n){"use strict";var r=n(2548);n(3624),e.exports=r},5608:function(e,t,n){"use strict";var r=n(9196);e.exports=r},8792:function(e,t,n){"use strict";var r=n(4856);e.exports=r},7752:function(e,t,n){"use strict";var r=n(2536);e.exports=r},5716:function(e,t,n){"use strict";var r=n(3416);e.exports=r},6860:function(e,t,n){"use strict";var r=n(2936);e.exports=r},9224:function(e,t,n){"use strict";var r=n(920);e.exports=r},424:function(e,t,n){"use strict";var r=n(2613);e.exports=r},7052:function(e,t,n){"use strict";var r=n(6104);e.exports=r},9516:function(e,t,n){"use strict";var r=n(6496);n(3624),e.exports=r},7768:function(e,t,n){"use strict";var r=n(3216);e.exports=r},1576:function(e,t,n){"use strict";var r=n(2568);e.exports=r},8436:function(e,t,n){"use strict";var r=n(1060);e.exports=r},948:function(e,t,n){"use strict";var r=n(7376);n(3624),e.exports=r},9928:function(e,t,n){"use strict";var r=n(2767);n(3624),e.exports=r},8308:function(e,t,n){"use strict";var r=n(5180);n(3624),e.exports=r},6956:function(e,t,n){"use strict";var r=n(6888);e.exports=r},456:function(e,t,n){"use strict";var r=n(2296);e.exports=r},5120:function(e,t,n){"use strict";n(272),n(6372),n(3944),n(8580);var r=n(9832);e.exports=r.URLSearchParams},2296:function(e,t,n){"use strict";n(5120),n(4484),n(5188),n(7840);var r=n(9832);e.exports=r.URL},9464:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{c:function(){return r}})},2992:function(e,t,n){"use strict";n.d(t,{c:function(){return l}});var r=n(8520),o=n(8496),a=n(6340);function i(e){var t=function(e,t){if("object"!=(0,o.c)(e)||!e)return e;var n=e[a];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=(0,o.c)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,o.c)(t)?t:t+""}function l(e,t,n){return(t=i(t))in e?r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},2664:function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var r=n(2176),o=n(8176);function a(){var e;return a=r?o(e=r).call(e):function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(null,arguments)}},1184:function(e,t,n){"use strict";function r(e){if(null==e)throw new TypeError("Cannot destructure "+e)}n.d(t,{c:function(){return r}})},4984:function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var r=n(2900),o=n(7112);function a(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(o(t).call(t,r)>=0)continue;n[r]=e[r]}return n}(e,t);if(r){var l=r(e);for(a=0;a<l.length;a++)n=l[a],o(t).call(t,n)>=0||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},8264:function(e,t,n){"use strict";n.d(t,{c:function(){return c}});var r=n(2396);var o=n(9216),a=n(420),i=n(8360);var l=n(5956);function c(e,t){return function(e){if(r(e))return e}(e)||function(e,t){var n=null==e?null:void 0!==o&&a(e)||e["@@iterator"];if(null!=n){var r,l,c,u,s=[],f=!0,d=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=c.call(n)).done)&&(i(s).call(s,r.value),s.length!==t);f=!0);}catch(e){d=!0,l=e}finally{try{if(!f&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(d)throw l}}return s}}(e,t)||(0,l.c)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},5992:function(e,t,n){"use strict";n.d(t,{c:function(){return u}});var r=n(2396),o=n(9464);var a=n(9216),i=n(420),l=n(7944);var c=n(5956);function u(e){return function(e){if(r(e))return(0,o.c)(e)}(e)||function(e){if(void 0!==a&&null!=i(e)||null!=e["@@iterator"])return l(e)}(e)||(0,c.c)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},8496:function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var r=n(9216),o=n(7268);function a(e){return a="function"==typeof r&&"symbol"==typeof o?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e},a(e)}},5956:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var r=n(3232),o=n(7944),a=n(9464);function i(e,t){if(e){var n;if("string"==typeof e)return(0,a.c)(e,t);var i=r(n={}.toString.call(e)).call(n,8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?o(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?(0,a.c)(e,t):void 0}}}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e].call(a.exports,a,a.exports,o),a.exports}return o.m=n,o.c=r,o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="nocode-designer:",o.l=function(n,r,a,i){if(e[n])e[n].push(r);else{var l,c;if(void 0!==a)for(var u=document.getElementsByTagName("script"),s=0;s<u.length;s++){var f=u[s];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==t+a){l=f;break}}l||(c=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.setAttribute("data-webpack",t+a),l.src=n),e[n]=[r];var d=function(t,r){l.onerror=l.onload=null,clearTimeout(p);var o=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach((function(e){return e(r)})),t)return t(r)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=d.bind(null,l.onerror),l.onload=d.bind(null,l.onload),c&&document.head.appendChild(l)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){o.S={};var e={},t={};o.I=function(n,r){r||(r=[]);var a=t[n];if(a||(a=t[n]={}),!(r.indexOf(a)>=0)){if(r.push(a),e[n])return e[n];o.o(o.S,n)||(o.S[n]={});o.S[n];var i=function(e){var t=function(e){"undefined"!=typeof console&&console.warn};try{var a=o(e);if(!a)return;var i=function(e){return e&&e.init&&e.init(o.S[n],r)};if(a.then)return l.push(a.then(i,t));var c=i(a);if(c&&c.then)return l.push(c.catch(t))}catch(e){t()}},l=[];if("default"===n)i(1452),i(9768),i(954);return l.length?e[n]=Promise.all(l).then((function(){return e[n]=1})):e[n]=1}}}(),function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e+"../"}(),o(5724)}()}));