"use strict";(self.webpackChunknocode_component=self.webpackChunknocode_component||[]).push([[8600],{35500:function(e,t,a){a.r(t);var n=a(65984),l=a.n(n),r=a(47906),o=a(39756),c=a(20024),i=a(62132);t.default=l().memo((function(e){var t=e.controlMeta,a=(0,n.useContext)(o.m).model,u=a.batchInvoke,d=a.getControlText,s=a.getFormStatus,f=t.pageId,v=t.id,m=t.text,p=t.opk,b=t.btnType,h=t.icon,y=t.parentId,g="view"===s(f),k=(0,n.useCallback)((function(){u("itemClick",f,y,[v,p])}),[]),C=(0,i.c)(k),E=(0,c.c)(t),w=E.disabled,S=E.hidden;return g||S?null:l().createElement(r.BtnField,{size:"small",style:{marginRight:"12px"},type:b||"",disabled:g||w,onClick:C,text:d(m),icon:{type:h,prefix:"ncicon"}})}))},70248:function(e,t,a){a.r(t);a(87912),a(97308);var n=a(30112),l=a(72048),r=a(38456),o=a.n(r),c=a(13939),i=a.n(c),u=a(34716),d=a.n(u),s=a(70696),f=a.n(s),v=a(4884),m=a.n(v),p=a(3464),b=a.n(p),h=a(51400),y=a.n(h),g=a(25028),k=a.n(g),C=a(65984),E=a.n(C),w=a(47906),S=a(39756),I=a(20024),x=a(56492),N=a(69984),R=a(27448);function M(e,t){var a=i()(e);if(d()){var n=d()(e);t&&(n=f()(n).call(n,(function(t){return m()(e,t).enumerable}))),a.push.apply(a,n)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,n.c)(e,t,a[t])})):b()?y()(e,b()(a)):M(Object(a)).forEach((function(t){k()(e,t,m()(a,t))}))}return e}t.default=E().memo((function(e){var t=(0,C.useContext)(S.m),a=t.meta,n=t.model,r=e.controlMeta,c=r.pageId,i=r.tableId,u=(0,C.useRef)(null),d=(0,C.useState)(),s=(0,l.c)(d,2),f=s[0],v=s[1],m=x.c.getChildMetas(r,a),p=(0,C.useMemo)((function(){var e=i?n.getControlMeta(c,i):o()(m).call(m,(function(e){return"grid"===e.type}));return v(e.Status),T(T({},e||{}),{},{caption:(null==e?void 0:e.text)||{}})}),[r]),b=(0,I.c)(T(T({},p),{},{Status:f})),h=b.hidden,y=b.required,g=(0,C.useCallback)((function(e){(null==e?void 0:e.k)===p.id&&c===(null==e?void 0:e.pageId)&&v(e.v)}),[p,c]);return(0,C.useEffect)((function(){u.current&&(u.current.parentNode.parentNode.parentNode.style.display=h?"none":"block")}),[h]),n.useEventListener(R.uu,g),E().createElement(N.c,{required:y,controlMeta:p},E().createElement(w.AdvContainer,{ref:u,id:null==r?void 0:r.id},x.c.getChildren(r,a)))}))},12404:function(e,t,a){a.r(t);var n=a(65984),l=a.n(n),r=a(47906),o=a(39756),c=a(56492);t.default=l().memo((function(e){var t,a=(0,n.useContext)(o.m).meta,i=e.controlMeta,u={alignItems:i.ai,flexDirection:i.dr,justifyContent:i.jc,flexGrow:i.gr,flexWrap:i.wr,height:(null===(t=i.h)||void 0===t?void 0:t.zh_CN)||""};return l().createElement(r.AdvContainerChild,{style:u,id:null==i?void 0:i.id},c.c.getChildren(i,a))}))},25020:function(e,t,a){a.r(t);var n=a(65984),l=a.n(n),r=a(47906),o=a(39756),c=a(56492);t.default=l().memo((function(e){var t=(0,n.useContext)(o.m).meta,a=e.controlMeta,i={flexGrow:a.gr,marginBottom:"8px"};return l().createElement(r.AdvContainerToolBar,{style:i},c.c.getChildren(a,t))}))},66040:function(e,t,a){a.d(t,{c:function(){return at}});a(87912),a(97308);var n=a(13939),l=a.n(n),r=a(34716),o=a.n(r),c=a(70696),i=a.n(c),u=a(4884),d=a.n(u),s=a(3464),f=a.n(s),v=a(51400),m=a.n(v),p=a(25028),b=a.n(p),h=a(58496),y=a(2664),g=a(30112),k=a(65984),C=a.n(k),E="Yumgr-Iw_readonly_text",w=(0,k.memo)((function(e){var t=e.onClick,a=e.value,n=e.style;return C().createElement("p",{className:E,style:n,onClick:t},a||"")})),S=a(74238),I=a(73032),x=(0,k.memo)((function(e){var t=(0,S.uY)(e),a=t.value,n=t.onTdClick,l=t.disabled,r=t.controlMeta,o=(0,S.Ml)("focus",{value:a.v,disabled:l,isValidate:!(null==r||!r.rules)});return l?C().createElement(w,{value:a.v,onClick:n}):C().createElement(I.default,(0,y.c)({},t,{fieldItemRef:o}))})),N=a(85268);var R=(0,k.memo)((function(e){var t=(0,S.uY)(e),a=t.value,n=t.onTdClick;return t.disabled?C().createElement(w,{value:a.v,onClick:n}):C().createElement(N.default,t)})),M=a(67860),T=a(9172),F=a(14020),K=function(){};var D=(0,k.memo)((function(e){var t,a=(0,S.uY)(e),n=a.value,l=a.onTdClick,r=a.disabled,o=a.onBlur,c=(0,k.useRef)(null),i=(0,k.useCallback)((function(t){var a;return null!==(a=e.meta.editor)&&void 0!==a&&a.thousandsSeparator?(0,F.mQ)("".concat(t)):String(t)}),[null===(t=e.meta.editor)||void 0===t?void 0:t.thousandsSeparator]);return(0,M.c)([c],(function(e){o(e)})),r?C().createElement(w,{style:{justifyContent:"flex-end"},value:i(n.v),onClick:l}):C().createElement("div",{ref:c},C().createElement(T.default,(0,y.c)({},a,{onBlur:K})))})),O=a(72048),_=(a(86456),a(23992)),j=a.n(_),A=a(73980),V=a.n(A),Y=a(760),B=a.n(Y),q=a(39756),L=a(38680),G=a(47404),z=a(46276),P=a(28140),U=a(94780),W=a(49624),H=function(e){var t=(0,k.useContext)(q.m).model,a=e.rowIndex,n=e.meta,l=t.addEventListener,r=(0,z.s)(n,e).readonly,o=(0,S.uY)(e,"change"),c=o.onTdClick,u=o.disabled,d=o.onChange,s=o.controlMeta,f=n.pageId,v=n.dataIndex,m=n.id,p=n.gridId,b=1===n.editor.multi,h=((0,k.useRef)(null),(0,k.useState)(null)),y=(0,O.c)(h,2),g=y[0],E=y[1],w=(0,k.useCallback)((function(e){var t=e[0],n=t.args,l=t.methodname,r=t.key;switch(l){case G.Tb:r===m&&(0,W.M)(n[0]);break;case G.op:r===m&&(0,W.Q)(n[0]);break;default:if(n[0].k!==v||n[0].r!==a)return;E(e)}}),[m]),I=(0,k.useMemo)((function(){var t;return e.value?j()(t=e.value).call(t,(function(e){var t=(null==e?void 0:V()(e).call(e,2))||[];t=i()(t).call(t,(function(e){return e}));var a=t.length>0?t.join("｜"):"-";return{label:e[1]||"-",value:e[0],des:a}})):[]}),[e.value]);t.useInvokeControlMethod(s,w),(0,k.useEffect)((function(){var e,t,a=l(B()(e=B()(t="".concat(L.lN,"-")).call(t,f,"-")).call(e,p),w);return function(){null==a||a()}}),[]);var x="view"!==t.getFormStatus(f);return e.value,u?C().createElement("div",{onClick:c},C().createElement(U.c,{readonly:r,silence:x,data:I,multi:b,meta:n,model:t})):C().createElement(P.default,{invokeData:g,value:e.value,onChange:function(e){d(e),t.batchInvoke(L.gR,f,m,[["%","","%",e,1,0]])},controlMeta:s})};H.displayName="KDTableRefBill";var X=(0,k.memo)(H),$=a(47906),J=a(35084),Q=a(27448),Z=a(62132);var ee=(0,k.memo)((function(e){var t=e.rowIndex,a=e.meta,n=e.record,l=e.gridStatus,r=(0,k.useContext)(q.m).model,o=(0,k.useContext)(J.q).dispatch,c=a.pageId,i=(a.id,a.dataIndex),u=a.editor,d=a.gridId,s=u.opr,f="view"===r.getFormStatus(c)||"2"===l||"3"===l,v=(0,k.useMemo)((function(){var e,t;return(null==n||null===(e=n.cprop)||void 0===e?void 0:e.canEditRow)||void 0===(null==n||null===(t=n.cprop)||void 0===t?void 0:t.canEditRow)}),[n]),m=(0,k.useCallback)((function(e){if(!f){var a={fieldKey:i,row:t,selRows:[t],isClientNewRow:!1,clientNewRows:"",selDatas:[]},n=[(0,g.c)({},d,a),[]],l=e.id,u=e.opk;r.batchInvoke("entryRowClick",c,d,[t],n),r.batchInvoke("itemClick",c,d,[l,u],[]),o({type:Q.cT,payload:[t,i]})}}),[f,v]),p=(0,Z.c)(m);return j()(s).call(s,(function(e){return C().createElement($.BtnField,{major:!0,key:"btn-".concat(e.id),type:"text",disabled:f,onClick:function(){return p(e)},text:r.getControlText(e.text)})}))})),te=a(18368),ae=(0,k.memo)((function(e){var t=(0,S.uY)(e,"change"),a=t.value,n=t.onTdClick,l=t.disabled,r=t.onBlur,o=t.onChange,c=t.controlMeta,i=(0,k.useRef)(null);(0,k.useEffect)((function(){var e;l||(null===(e=i.current)||void 0===e||e.focus())}),[l]);var u=(0,k.useMemo)((function(){var e,t=a.v;if("string"==typeof t)return a;if(!t)return"";var n=t||{},l=n.start,r=void 0===l?"":l,o=n.end,c=void 0===o?"":o;return r||c?B()(e="".concat(r||"","~")).call(e,c||""):""}),[a]);return l?C().createElement(w,{value:u,onClick:n}):C().createElement("div",{tabIndex:-1,onBlur:r,ref:i,style:{outline:"none"}},C().createElement(te.default,{controlMeta:c,value:a,onChange:o}))})),ne=a(82992),le=(0,k.memo)((function(e){var t=(0,S.uY)(e,"change"),a=t.value,n=t.onTdClick,l=t.disabled,r=t.onBlur,o=t.onChange,c=t.controlMeta,i=(0,k.useRef)(null);return(0,k.useEffect)((function(){var e;l||(null===(e=i.current)||void 0===e||e.focus())}),[l]),l?C().createElement(w,{value:a.v,onClick:n}):C().createElement("div",{tabIndex:-1,onBlur:r,ref:i,style:{outline:"none"}},C().createElement(ne.default,{controlMeta:c,value:a,onChange:o}))})),re=a(50524),oe=a.n(re),ce=a(71136),ie=a(73524),ue=a(12988);function de(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=i()(n).call(n,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?de(Object(a),!0).forEach((function(t){(0,g.c)(e,t,a[t])})):f()?m()(e,f()(a)):de(Object(a)).forEach((function(t){b()(e,t,d()(a,t))}))}return e}var fe=(0,k.memo)((function(e){var t,a,n=(0,S.uY)(e,"change"),l=(0,k.useContext)(q.m).model.getControlText,r=n.value,o=n.onTdClick,c=n.disabled,i=n.controlMeta,u=i.ops,d=i.customContent,s=i.type,f=i.scopeOfView,v=void 0===f?1:f,m=j()(t=u||(null==d?void 0:d.ops)||[]).call(t,(function(e){return se(se({},e),{},{label:l(e.label),color:e.bgc})})),p=oe()(a=["checkbox","mulcombo"]).call(a,s),b=p?"mulcombo":"combo",h=0===v,g=p?(0,ie.S_)(r.v):r.v,E=(0,S.Ml)("focus",{value:g,disabled:c,isValidate:!(null==i||!i.rules)});return c&&!h?C().createElement(ce.u,{value:(0,ie.AP)(m,(0,ie.S_)(r.v)),defaultValue:"",onClick:o}):C().createElement(ue.default,(0,y.c)({},n,{fieldItemRef:E,controlMeta:(0,y.c)(i,{type:b})}))})),ve=a(63536),me=(0,k.memo)((function(e){var t=(0,S.uY)(e,"change"),a=t.value,n=t.onTdClick,l=t.disabled,r=t.controlMeta,o=(0,S.Ml)("focus",{value:a.v,disabled:l,isValidate:!(null==r||!r.rules)});return l?C().createElement(w,{value:a.v,onClick:n}):C().createElement(ve.default,(0,y.c)({},t,{fieldItemRef:o}))})),pe=a(51432),be=(0,k.memo)((function(e){var t=(0,S.uY)(e,"change"),a=t.value,n=t.onTdClick,l=t.disabled,r=t.controlMeta,o=(0,S.Ml)("focus",{value:a.v,disabled:l,isValidate:!(null==r||!r.rules)});return l?C().createElement(w,{value:a.v,onClick:n}):C().createElement(pe.default,(0,y.c)({},t,{fieldItemRef:o}))}));be.displayName="KDGridUrlField";var he=be,ye=a(24496),ge=a.n(ye),ke=(a(21300),a(76124),a(63548)),Ce=a(60644),Ee=a(71252),we=a.n(Ee),Se={"grid-field-modal":"CqX6M-qU_grid-field-modal","grid-field-modal-readonly":"_3FOMfAe-_grid-field-modal-readonly","grid-field-modal-footer":"RKal2lmY_grid-field-modal-footer","grid-field-modal-title":"aJHTOvWq_grid-field-modal-title","grid-field-modal-title-label":"MSSDz8Z6_grid-field-modal-title-label",mustInput:"YEXMV3nI_mustInput","grid-field-modal-title-tips":"_67HnVahw_grid-field-modal-title-tips","grid-field-modal-title-tips-icon":"lj3VWOES_grid-field-modal-title-tips-icon"},Ie="grid-field-modal",xe=function(e){var t=e.className,a=e.onCancel,n=e.onConfirm;return C().createElement("div",{className:Se[t]},C().createElement(ke.Button,{onClick:a,type:"second",size:"small",className:Se["".concat(t,"-cancel-btn")]},"取消"),C().createElement(ke.Button,{type:"primary",size:"small",style:{marginLeft:"12px"},onClick:n,className:Se["".concat(t,"-ok-btn")]},"确定"))},Ne=function(e){var t=e.className,a=e.value,n=e.required,l=e.tips;return C().createElement("div",{className:Se["".concat(t)]},C().createElement("label",{className:Se["".concat(t,"-label")]},a),n&&C().createElement("span",{className:Se.mustInput},"*"),l&&C().createElement(ke.Tooltip,{placement:"bottom",tip:l,trigger:"hover",popperClassName:Se["".concat(t,"-tips")],popperStyle:{"--arrowSpill":"-5px",marginTop:"-4px"}},C().createElement(ke.Icon,{type:"tips",className:Se["".concat(t,"-tips-icon")]})))},Re=(0,k.memo)((function(e){var t=e.className,a=e.modalBody,n=e.readOnly,l=e.visible,r=e.title,o=e.titleTips,c=e.required,i=e.hideFooter,u=e.onConfirm,d=e.onCancel,s=we()([Se[Ie],t,(0,g.c)({},Se["".concat(Ie,"-readonly")],n)]),f=n||i?null:C().createElement(xe,{className:"".concat(Ie,"-footer"),onConfirm:u,onCancel:d});return C().createElement(ke.Modal,{mask:!0,visible:l,body:a,titleIcon:null,className:s,footer:f,maskClosable:!1,width:560,height:520,title:C().createElement(Ne,{className:"".concat(Ie,"-title"),value:r,required:c,tips:o}),closable:!0,destroyOnClose:!0,onCancel:d,onOk:d,onClick:function(e){null==e||e.stopPropagation()}})}));Re.displayName="GridFieldsModal";var Me=Re,Te=a(45240),Fe="u0dDxSXn_grid-picture-wrapper",Ke="_5UypmUWR_notEmpty",De="hoEiBfWC_display_name";function Oe(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=i()(n).call(n,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,n)}return a}function _e(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(a),!0).forEach((function(t){(0,g.c)(e,t,a[t])})):f()?m()(e,f()(a)):Oe(Object(a)).forEach((function(t){b()(e,t,d()(a,t))}))}return e}var je=(0,k.forwardRef)((function(e,t){var a=e.meta,n=e.value,l=e.onFileListChange,r=(0,k.useRef)(n);(0,k.useImperativeHandle)(t,(function(){return{getUploadResult:function(){return r.current}}}));return C().createElement(Te.default,{value:n,controlMeta:a,onChange:function(e){r.current=e,null==l||l(e)}})})),Ae=(0,k.memo)((function(e){var t=(0,k.useContext)(q.m).model,a=e.rowIndex,n=e.meta,l=e.value,r=e.record,o=t.batchInvoke,c=(0,k.useState)(!1),i=(0,O.c)(c,2),u=i[0],d=i[1],s=n.pageId,f=n.dataIndex,v=(n.id,n.header),m=n.editor,p=void 0===m?{}:m,b=n.gridId,h=p.mi,y=p.pictureDefValue,E=p.helpTips,w=p.displayCount,S=p.uploadNum,I=(0,k.useRef)(t.getFileServer("picture")),x=(0,k.useState)((function(){return l||y||void 0})),N=(0,O.c)(x,2),R=N[0],M=N[1],T=(0,k.useState)(""),K=(0,O.c)(T,2),D=K[0],_=K[1],j=(0,k.useRef)(null),A=(0,k.useMemo)((function(){return(0,F.AA)(R)?JSON.parse(R):R||[]}),[R]),V=(0,k.useMemo)((function(){var t=e.readonly?"3":p.Status;return _e(_e({},p),{},{pageId:s,id:f,TitleArea:"hide",Status:t})}),[p,p.Status,s,f]),Y=(0,z.s)(V,e),L=Y.readonly,G=Y.disabled,P=(0,k.useCallback)((function(e){var a,n,l=t.getControlText(v);if(L||G)return l;var r="string"==typeof e?JSON.parse(e||"[]"):e;return w?B()(a=B()(n="".concat(l,"(")).call(n,(null==r?void 0:r.length)||0,"/")).call(a,(null==S?void 0:S.max)||1,")"):l}),[w,S,v,L,G]),U=(0,k.useMemo)((function(){var e,t;return(null==r||null===(e=r.cprop)||void 0===e?void 0:e.canEditRow)||void 0===(null==r||null===(t=r.cprop)||void 0===t?void 0:t.canEditRow)}),[r]),W=(0,k.useCallback)((function(){if((!L||A.length)&&U){var e={fieldKey:f,row:a,selRows:[a],isClientNewRow:!1,clientNewRows:"",selDatas:[]},t=[(0,g.c)({},b,e),[]];o("entryRowClick",s,b,[a],t);var n=P(A);D!==n&&_(n),d(!0)}}),[s,b,f,a,L,A,d,U]);(0,k.useEffect)((function(){(0,Ce.isEqual)(l,R)||M(l)}),[l]);var H=(0,k.useCallback)((function(){var e=j.current.getUploadResult,t=(null==e?void 0:e())||[],n="string"==typeof t?t:ge()(t);"[]"===n&&(n=""),o("updateValue",s,"",[],[{},[{k:f,r:a,v:n}]]),M(t),d(!1)}),[d,M,j.current]),X=(0,k.useCallback)((function(){d(!1)}),[d]),$=(0,k.useCallback)((function(e){var t=P(e);D!==t&&_(t)}),[P,D]),J=(0,k.useMemo)((function(){if(1===A.length){var e,t=A[0],a=(t.name,t.url);return C().createElement(C().Fragment,null,C().createElement("img",{src:B()(e="".concat(I.current)).call(e,(0,F.oA)(a)),alt:"",width:20,height:20}))}if(A.length>1){var n,l=A[0].url;return C().createElement(C().Fragment,null,C().createElement("img",{src:B()(n="".concat(I.current)).call(n,(0,F.oA)(l)),alt:"",width:20,height:20}),C().createElement("span",{className:De},"等",A.length,"张"))}return!L&&C().createElement(ke.Icon,{prefix:"ncicon",type:"daochu3"})}),[L,A]),Q=we()(Fe,(0,g.c)({},Ke,!!A.length));return C().createElement(C().Fragment,null,C().createElement("div",{className:Q,onClick:W},J),C().createElement(Me,{title:D,titleTips:E,required:h,readOnly:L||!!G,visible:u,modalBody:C().createElement(je,{ref:j,meta:V,value:R,onFileListChange:$}),onConfirm:H,onCancel:X}))}));Ae.displayName="GridPictureField";var Ve=Ae,Ye=a(44880),Be=a(31520),qe="pD7Sl5NG_grid-attachment-wrapper",Le="FLvAFEkY_notEmpty",Ge="NynjvQuw_cell_display",ze="uLVyC6Zg_thumb_nail_icon";function Pe(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=i()(n).call(n,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(a),!0).forEach((function(t){(0,g.c)(e,t,a[t])})):f()?m()(e,f()(a)):Pe(Object(a)).forEach((function(t){b()(e,t,d()(a,t))}))}return e}var We=(0,k.forwardRef)((function(e,t){var a=e.gridId,n=e.model,l=e.rowIndex,r=e.meta,o=e.value,c=e.onFileListChange,i=r.id,u=r.pageId,d=(0,k.useState)([]),s=(0,O.c)(d,2),f=s[0],v=s[1],m=(0,k.useRef)(o);(0,k.useImperativeHandle)(t,(function(){return{getUploadResult:function(){return m.current}}}));var p=function(e){m.current=e,null==c||c(e)},b=(0,k.useCallback)((function(e){var t=e[0].args[0]||{},a=t.rowIndex,n=t.tileAttField;a===l&&n===i&&v(e)}),[l,i,p]);return(0,k.useEffect)((function(){var e,t,l=n.addEventListener(B()(e=B()(t="".concat(L.lN,"-")).call(t,u,"-")).call(e,a),b);return function(){null==l||l()}}),[b]),C().createElement(Be.default,{controlMeta:r,value:o,rowIndex:l,invokeData:f,onChange:p})})),He=(0,k.memo)((function(e){var t=(0,k.useContext)(q.m).model,a=e.rowIndex,n=e.meta,l=e.value,r=e.record,o=t.batchInvoke,c=(0,k.useState)(!1),i=(0,O.c)(c,2),u=i[0],d=i[1],s=n.pageId,f=n.dataIndex,v=(n.id,n.header),m=n.editor,p=void 0===m?{}:m,b=n.gridId,h=p.mi,y=p.uploadDefValue,E=p.helpTips,w=p.displayCount,S=p.uploadNum,I=(0,k.useState)((function(){return l||y||[]})),x=(0,O.c)(I,2),N=x[0],R=x[1],M=(0,k.useState)(""),T=(0,O.c)(M,2),F=T[0],K=T[1],D=(0,k.useRef)(null),_=Ue(Ue({},p),{},{pageId:s,id:f,TitleArea:"hide"}),j=(0,z.s)(_,e),A=j.readonly,V=j.disabled,Y=(0,k.useMemo)((function(){var e,t;return(null==r||null===(e=r.cprop)||void 0===e?void 0:e.canEditRow)||void 0===(null==r||null===(t=r.cprop)||void 0===t?void 0:t.canEditRow)}),[r]),L=(0,k.useCallback)((function(e){var a,n,l=t.getControlText(v);return A||V?l:w?B()(a=B()(n="".concat(l,"(")).call(n,e.length,"/")).call(a,(null==S?void 0:S.max)||1,")"):l}),[w,S,v,A,V]),G=(0,k.useCallback)((function(e){var t=L(e);K(t)}),[L,K]),P=(0,k.useCallback)((function(){if((!A||N.length)&&Y){var e={fieldKey:f,row:a,selRows:[a],isClientNewRow:!1,clientNewRows:"",selDatas:[]},t=[(0,g.c)({},b,e),[]];o("entryRowClick",s,b,[a],t),G(N),d(!0)}}),[s,b,f,a,A,N,d,Y,G]);(0,k.useEffect)((function(){(0,Ce.isEqual)(l,N)||R(l||[])}),[l,G]),(0,k.useEffect)((function(){G(N)}),[A,V,N]);var U=(0,k.useCallback)((function(){var e=D.current.getUploadResult,n=(null==e?void 0:e())||[];t.batchInvoke("updateValue",s,"",[],[{},[{k:f,r:a,v:n}]])}),[a,f]),W=(0,k.useCallback)((function(){d(!1)}),[d]),H=(0,k.useCallback)((function(e){G(N),U()}),[G,N,U]),X=(0,k.useMemo)((function(){if(1===N.length){var e=N[0],a=e.name,n=e.type;return C().createElement(C().Fragment,null,C().createElement("div",{className:ze},C().createElement("img",{src:(0,Ye.SY)(n)})),C().createElement("span",{className:Ge},t.getControlText(a)))}return N.length>1?C().createElement(C().Fragment,null,C().createElement(ke.Icon,{prefix:"ncicon",type:"weishibiefujian"}),C().createElement("span",{className:Ge},N.length)):!A&&C().createElement(ke.Icon,{prefix:"ncicon",type:"daochu3"})}),[A,N]),$=we()(qe,(0,g.c)({},Le,!!N.length));return C().createElement(C().Fragment,null,C().createElement("div",{className:$,onClick:P},X),C().createElement(Me,{title:F,titleTips:E,required:h,readOnly:A||V,visible:u,modalBody:C().createElement(We,{ref:D,model:t,meta:_,pageId:s,gridId:b,rowIndex:a,value:N,onFileListChange:H}),onCancel:W,hideFooter:!0}))}));He.displayName="GridAttachmentField";var Xe=He,$e=a(59956);var Je=(0,k.memo)((function(e){var t=(0,S.uY)(e),a=t.value,n=t.onTdClick,l=t.disabled,r=t.controlMeta,o=(0,S.Ml)("focus",{value:(0,F.Wg)(a.v),disabled:l,isValidate:!(null==r||!r.rules)}),c=(0,k.useCallback)((function(e){var a=(0,F.MH)(e);null==t||t.onChange(a)}),[t]);return l?C().createElement(w,{value:(0,F.MH)(a.v),onClick:n}):C().createElement($e.default,(0,y.c)({},t,{onChange:c,fieldItemRef:o}))})),Qe=a(19728);function Ze(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=i()(n).call(n,(function(t){return d()(e,t).enumerable}))),a.push.apply(a,n)}return a}function et(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(a),!0).forEach((function(t){(0,g.c)(e,t,a[t])})):f()?m()(e,f()(a)):Ze(Object(a)).forEach((function(t){b()(e,t,d()(a,t))}))}return e}var tt={text:x,textarea:R,number:D,radio:fe,checkbox:fe,combo:fe,mulcombo:fe,refbill:X,refbilllist:X,operate:ee,daterange:ae,timerange:ae,datetime:le,date:le,year:le,month:le,email:me,url:he,picture:Ve,attachmentfield:Xe,telephone:Je,idcard:x,passwordbox:(0,k.memo)((function(e){var t=(0,S.uY)(e),a=t.value,n=t.onTdClick;return t.disabled?C().createElement(w,{value:a.v?"●●●●●●":"",onClick:n}):C().createElement(Qe.default,t)}))};var at=(0,k.memo)((function(e){var t,a=e.value,n=e.meta,l=e.rowIndex,r=n.dataIndex,o=n.id,c=et(et({},n),{},{id:r,gridId:o}),i=tt[null==n||null===(t=n.editor)||void 0===t?void 0:t.type];return i?C().createElement(i,(0,y.c)({},e,{meta:c})):"seq"===n.dataIndex?l+1:"object"===(0,h.c)(a)?"":a}))},33160:function(e,t,a){a.d(t,{c:function(){return c}});var n=a(65984),l=a.n(n),r=a(63548),o="XtjiBRnl_title",c=function(e){var t=e.title,a=e.tips,n=e.isMust;return l().createElement("div",{className:o},l().createElement("p",{title:t||""}," ",t||""," "),n?l().createElement("span",null,"*"):null,a?l().createElement(r.Tooltip,{tip:a},l().createElement(r.Icon,{type:"tips"})):null)}},84180:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var n=a(72048),l=a(760),r=a.n(l),o=a(90896),c=a.n(o),i=a(23992),u=a.n(i),d=(a(87912),a(97308),a(65984)),s=a.n(d),f=a(39756),v=a(47906),m=a(38680),p=a(27448),b=a(66040),h=a(23832),y=a(61260),g=a.n(y),k=a(86132),C={columns:[],dataSource:[],dataIndex:{},focusTd:["-1","-1"]},E=(0,k.c)((function(e,t){var a=t.type,n=t.payload;switch(a){case p.OK:e.columns=n;break;case p.GI:e.dataSource=n;break;case p.Wy:n.forEach((function(t){return e.dataSource.push(t)}));break;case p.CY:n.forEach((function(t){var a;null!==(a=e.dataSource)&&void 0!==a&&a[t.r]&&(e.dataSource[t.r][t.k]=t.v)}));break;case p.o$:for(var l=n.length-1;l>=0;l--){var r;g()(r=e.dataSource).call(r,n[l],1)}break;case p.cT:e.focusTd=n;break;default:console.error("can not find action ".concat(a))}})),w=a(35084),S=a(33160);var I=(0,d.memo)((function(e){var t=(0,d.useReducer)(E,C),a=(0,n.c)(t,2),l=a[0],o=a[1],i=(0,d.useContext)(f.m).model,y=i.getControlText,g=i.emitEvent,k=e.controlMeta,I=k.pageId,x=k.id,N=i.addControlAction,R=(0,d.useRef)({});k.caption=k.text;var M=function(e){e.forEach((function(t){var a,n,l=t.methodname,c=t.args;switch(l){case m.Ir:break;case m.eo:o({type:p.Wy,payload:F(c[0],R.current)});break;case m.yY:o({type:p.o$,payload:c[0]});break;case m.yi:case m.qo:case m.mO:break;default:g(r()(a=r()(n="".concat(m.lN,"-")).call(n,I,"-")).call(a,x),e)}}))},T=function(e){if(e.data){R.current=e.data.dataindex;var t=F(e.data.rows,e.data.dataindex);o({type:p.GI,payload:t})}else o({type:p.CY,payload:e.fieldstates}),e.fieldstates.forEach((function(e){var t,a;g(r()(t=r()(a="".concat(m.lN,"-")).call(a,I,"-")).call(t,x,"-validate"),e)}))},F=function(e,t){return u()(e).call(e,(function(e){var a={};for(var n in t)a[n]=e[t[n]];return a}))};return(0,d.useEffect)((function(){var e=N(m.y4,I,x,M),t=N(m.sv,I,x,T);return function(){null==e||e(),null==t||t()}}),[]),(0,d.useEffect)((function(){var e,t;e=k.columns,t=[],e.forEach((function(e){var a,n,l,r,o=e.editor,i=void 0===o?{}:o,u=i.Visibility,d=void 0===u?"all":u,f=i.Status;e.pageId=I,e.id=x,!e.hasOwnProperty("visible")&&(0,h.SC)(d)&&t.push({code:e.dataIndex,title:s().createElement(S.c,{isMust:"1"===f&&(null===(a=e.editor)||void 0===a?void 0:a.mi),tips:null===(n=e.editor)||void 0===n?void 0:n.helpTips,title:y(e.header)}),width:e.width||c()(y(e.w))||200,lock:"operate"===(null==e||null===(l=e.editor)||void 0===l?void 0:l.type),align:"number"===(null==e||null===(r=e.editor)||void 0===r?void 0:r.type)?"right":"left",render:function(t,a,n){return s().createElement(b.c,{meta:e,value:t,record:a,rowIndex:n})}})})),o({type:p.OK,payload:t})}),[]),null==l||l.columns,s().createElement(w.q.Provider,{value:{state:l,dispatch:o}},s().createElement(v.DataGrid,{columns:(null==l?void 0:l.columns)||[],dataSource:(null==l?void 0:l.dataSource)||[]}))}))},96200:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ve}});var n=a(13939),l=a.n(n),r=a(34716),o=a.n(r),c=a(4884),i=a.n(c),u=a(3464),d=a.n(u),s=a(51400),f=a.n(s),v=a(25028),m=a.n(v),p=a(30112),b=a(72048),h=(a(86456),a(46428),a(87912),a(97308),a(73980)),y=a.n(h),g=a(70696),k=a.n(g),C=a(24244),E=a.n(C),w=a(23992),S=a.n(w),I=a(760),x=a.n(I),N=a(90896),R=a.n(N),M=a(50524),T=a.n(M),F=a(65984),K=a.n(F),D=a(39756),O=a(47906),_=a(63548),j=a(38680),A=a(27448),V=a(59992),Y=a.n(V),B=Y()("更新下拉数据"),q=Y()("设置下拉选中值"),L=Y()("设置下拉选项"),G=Y()("设置F7表格数据"),z=Y()("设置F7表格配置信息"),P=Y()("设置F7表格请求过滤条件"),U=(Y()("F7单个删除已选"),Y()("设置F7表格行选择数据")),W=Y()("更新F7表格行选择数据和下标"),H=Y()("设置F7表格行选择数据下标"),X=Y()("F7点击清空按钮"),$=Y()("设置表格筛选项"),J=Y()("表格列排序"),Q=Y()("关联表单表格模式列头设置"),Z=Y()("关联表单表格模式数据"),ee=a(66040),te=a(23832),ae="zitJITXT_reftable",ne=a(61260),le=a.n(ne),re=a(86132);function oe(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=k()(n).call(n,(function(t){return i()(e,t).enumerable}))),a.push.apply(a,n)}return a}function ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){(0,p.c)(e,t,a[t])})):d()?f()(e,d()(a)):oe(Object(a)).forEach((function(t){m()(e,t,i()(a,t))}))}return e}var ie={dataIndex:{},focusTd:["-1","-1"],value:[],label:"",options:[],columns:[],dataSource:[],tableData:{rows:[]},tableConfig:{},tableColumn:[],tableColumnData:[],tableFilterData:[],rowSelected:[],selectedKeys:[],colFilter:{},colSort:{},permission:!1},ue=(0,re.c)((function(e,t){var a,n=t.type,l=t.payload;switch(n){case A.OK:e.columns=l;break;case A.GI:e.dataSource=l;break;case A.Wy:l.forEach((function(t){return e.dataSource.push(t)}));break;case A.CY:l.forEach((function(t){var a;null!==(a=e.dataSource)&&void 0!==a&&a[t.r]&&(e.dataSource[t.r][t.k]=t.v)}));break;case A.o$:for(var r=l.length-1;r>=0;r--){var o;le()(o=e.dataSource).call(o,l[r],1)}break;case A.cT:e.focusTd=l;break;case B:e.value=l.value,e.options=l.options,e.selectedKeys=l.selectedKeys;break;case q:e.value=l.value,e.selectedKeys=l.selectedKeys;break;case L:e.options=l;break;case Z:e.dataSource=l,e.selectedKeys=S()(a=l.rows).call(a,(function(e){return e.id}));break;case G:e.tableData=l.data;break;case Q:e.column=l;break;case z:e.tableConfig=l.tableConfig,e.rowSelected=l.rowSelected,e.tableColumn=l.tableColumn,e.tableColumnData=l.tableColumnData,e.selectedKeys=l.selectedKeys,e.permission=l.permission;break;case $:e.tableFilterData=l;break;case U:e.rowSelected=l.rowSelected,e.selectedKeys=l.selectedKeys;break;case X:e.rowSelected=[],e.selectedKeys=[];break;case H:e.selectedKeys=l.selectedKeys,e.rowSelected=l.rowSelected;break;case W:e.selectedKeys=l.selectedKeys,e.rowSelected=ce(ce({},e.rowSelected),l.rowSelected);break;case P:e.colFilter[l.key]=l.value;break;case J:e.colSort=l}})),de=a(35084),se=a(33160),fe=a(14020),ve=a(58496),me=a(81043),pe=(a(21300),a(99308)),be=a.n(pe),he=a(33260),ye=a.n(he),ge=a(35680),ke=a.n(ge),Ce=a(24496),Ee=a.n(Ce),we=a(72400),Se=a.n(we),Ie=a(46276),xe=a(76352),Ne=a(62132),Re=a(79748);function Me(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=k()(n).call(n,(function(t){return i()(e,t).enumerable}))),a.push.apply(a,n)}return a}function Te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(a),!0).forEach((function(t){(0,p.c)(e,t,a[t])})):d()?f()(e,d()(a)):Me(Object(a)).forEach((function(t){m()(e,t,i()(a,t))}))}return e}var Fe=O.DataGrid.CellRender,Ke=function(e){var t=e.state,a=e.dispatch,n=e.controlMeta,l=e.model,r=e.formateData,o=e.updateServerValue,c=e.onSearchAction,i=e.f7Params,u=e.onF7Search,d=e.setVisible,s=n.pageId,f=n.id,v=n.propsDisplay,m=n.multi,p=t.tableData,h=t.tableConfig,y=t.rowSelected,g=t.selectedKeys,C=t.permission,w=t.colFilter,I=t.tableColumn,N=t.tableColumnData,R=t.tableFilterData,M=(0,Ie.s)(n),D=M.readonly,_=M.disabled,A=(0,F.useState)([]),V=(0,b.c)(A,2),Y=V[0],B=V[1],L=(0,F.useState)(""),G=(0,b.c)(L,2),P=G[0],Q=G[1],Z=1===m,ee=(0,F.useRef)(!1),te=(0,F.useRef)((null==v?void 0:v.split(","))||[]),ae=(0,F.useRef)(l.getFileServer()),ne=(0,F.useRef)(Te({},t)),re=(0,F.useRef)(D||_);(0,F.useEffect)((function(){re.current=D||_}),[D,_]),(0,F.useEffect)((function(){ne.current=Te({},t)}),[t]);var oe=(0,F.useCallback)((function(){a({type:X})}),[a]),ce=(0,F.useCallback)((function(e){var n,l=e.pkId,o=Te({},t.rowSelected),c=v.split(","),i=S()(c).call(c,(function(t){return e[t]})),d=r(x()(n=[l]).call(n,(0,me.c)(i))),s=new(be())(t.selectedKeys),f=Z?(0,me.c)(s.add(l)):[l];o[l]=d,a({type:H,payload:{selectedKeys:f,rowSelected:o}}),u({})}),[Z,v,t.selectedKeys,u,t.rowSelected]),ie=(0,F.useCallback)((function(e){a({type:$,payload:e});var t=S()(e).call(e,(function(e){return{compareType:e.compareType,fieldName:e.fieldName,value:e.value}}));u({filter:t})}),[u,a]),ue=(0,F.useCallback)((function(){ee.current=!1,i.current={key:"",filter:"",pageNum:1,pageSize:10,sort:""},a({type:$,payload:[]}),Q(""),d(!1)}),[a]),de=(0,F.useCallback)((function(){var e;ee.current=!0;var n=Array.isArray(t.selectedKeys)?E()(e=(0,me.c)(t.selectedKeys)).call(e):t.selectedKeys;a({type:q,payload:{value:Z?n:n.join(),selectedKeys:n}}),l.batchInvoke(j.I$,s,f,[{rows:n}]),ue()}),[t.selectedKeys,o,a,ue]),se=(0,F.useCallback)((function(e,t){var n={};if(0===t)delete n[e];else{var l,r=-1===t?"desc":"";n[e]=x()(l="".concat(e)).call(l,r?" "+r:"")}u({sort:n[e]||""}),B([{number:e,isAsc:1===t}]),a({type:J,payload:n})}),[u,B,a]),pe=(0,F.useCallback)((function(e){Q(e),u({key:e||"",pageNum:1})}),[u]),he=(0,F.useCallback)((function(e,t){u({pageNum:e,pageSize:t})}),[u]),ge=(0,F.useCallback)((function(e){var n=Te({},t.rowSelected),l=new(be())(t.selectedKeys);e.forEach((function(e){delete n[e],l.delete(e)})),a({type:U,payload:{rowSelected:n,selectedKeys:(0,me.c)(l)}})}),[t.rowSelected,t.selectedKeys,a]),Ce=(0,F.useCallback)((function(e,n,l,o){var c,i=t.tableData;"uncheck"!==o&&"uncheck-all"!==o||ge(l);var u=null==i?void 0:k()(c=i.rows).call(c,(function(t){return T()(e).call(e,t.id)})),d={};u.forEach((function(e){var t=e.id,a=e._title_;if(a){var n,l=ye()(a).call(a,"|"),o=a.substring(0,l),c=ke()(n=a.substr(l+1)).call(n,"|","｜");d[e.id]={value:t,label:o,des:c}}else{var i=[e.id];te.current.forEach((function(t){i.push(e[t])})),d[e.id]=r(i)}})),a({type:W,payload:{selectedKeys:e,rowSelected:d}})}),[t.tableData,r,ge]),we=(0,F.useCallback)((function(e,t){l.batchInvoke(j.kD,s,f,[[e.fieldName,t]])}),[s,f]),Me=(0,F.useCallback)((function(e){var t,a=l.getConfig(s),n={params:"1",appId:a.appId,fId:a.formId,fileName:e.name},r=x()(t="".concat(e.url,"&kd_cs_ticket=")).call(t,l.Global.token);(0,fe.gr)(r,n)}),[]),Ke=(0,F.useCallback)((function(e,t){l.batchInvoke(j.kD,s,f,[[e,t]])}),[s,f]),De=(0,F.useCallback)((function(e,a){var n,l;e.forEach((function(t,a){t.value.forEach((function(t){"all"===t.type&&le()(e).call(e,a,1)}))}));var r=(null==t?void 0:t.tableFilterData)||[],o=(null==r||null===(n=k()(r))||void 0===n?void 0:n.call(r,(function(e){return e.fieldName!==a})))||[],c=x()(l=[]).call(l,(0,me.c)(e),(0,me.c)(o));ie(c)}),[ie,t.tableFilterData]),Oe=(0,F.useCallback)((function(e){var t="nocodedecimalfield"===e.type?"right":"",a={align:t,title:e.name,number:e.number,type:e.type};return{code:e.number,title:K().createElement(O.TableTitle,a),width:200,align:t,lock:!1,render:function(t,a,n){var r;if(T()(r=["nocodeimageuploadfield","nocodeattachmentuploadfield","nocodeselectitemfield","nocodeentryentity","nocoderichtextfield","nocodegraphicdisplayfield"]).call(r,e.type)){var o=t;return"nocodeselectitemfield"===e.type&&(o=Array.isArray(t)?S()(t).call(t,(function(e){return Te(Te({},e),{},{label:l.getControlText(e.name)})})):[]),K().createElement(Fe,{readOnly:!0,type:e.type,baseUrl:ae.current,onDownLoad:Me,value:o,record:a,rowIndex:n})}return null===t?"":"boolean"==typeof t?t?"是":"否":"object"===(0,ve.c)(t)?Ee()(t):t}}}),[se,Me]),_e=(0,F.useCallback)((function(e){var t=e.id;l.batchInvoke(j.E_,s,f,[[t,v,f]])}),[s,f,v]),je=(0,F.useCallback)((function(e){var t,a=e.id,n=null===(t=ne.current.selectedKeys)||void 0===t?void 0:k()(t).call(t,(function(e){return e!==a}));c(n)}),[Z]),Ae=(0,F.useCallback)((function(e,t){switch(e){case"delete":je(t);break;case"detail":l.batchInvoke("showInfo",s,f,[[t.id]]);break;case"edit":_e(t)}}),[je,_e,s,f]),Ve=(0,Ne.c)(Ae),Ye=(0,F.useCallback)((function(e,t){var a=e.listItemConfig,n=i.current,l=n.pageSize*(n.pageNum-1),r=[{code:"No",title:"序号",width:60,align:"center",lock:!0,render:function(e,t,a){return l+a+1}}],o=[{key:"No",title:"序号"}];return a.forEach((function(e){r.push(Oe(e)),o.push({key:e.number,title:e.name})})),t&&r.push({code:"operator",title:"操作",width:100,lock:!0,render:function(e,t,a){return K().createElement(xe.c,{isF7:!0,onItemClick:Ve,disabled:re.current,record:t})}}),Te(Te({},e),{},{data:o,column:r,editF7Record:_e})}),[D,_,Ve,_e]),Be=(0,F.useCallback)((function(e){var t={},n=[];e.selected.forEach((function(e){t[e[0]]=r(e),n.push(e[0])}));var l=void 0===e.permission,o=Ye(e.data.rows[0],l);a({type:z,payload:{tableConfig:e.data.rows[0],tableColumn:o.column,tableColumnData:o.data,permission:l,rowSelected:t,selectedKeys:n}})}),[Ye,a]),qe=(0,F.useCallback)((0,fe.Cu)((function(){l.batchInvoke("addNewRef",s,f,[[v,f]])})),[v,s,f]),Le=(0,Re.c)({pageId:s,fieldKey:f,model:l,baseUrl:ae,onDownLoad:Me});return{props:{primaryKey:"id",mode:Z?"multiple":"single",config:h,sorts:Y,tableColumn:I,tableColumnData:N,tableFilterData:R,rowSelected:Se()(y)||[],tableSelectedKeys:g,data:p,searchValue:P,colHeadFilter:w,showSelected:Z,showAddRecord:C,refBillProps:Le,onAddRecord:qe,onRowSelectChange:Ce,onCancel:ue,onSearch:pe,onClean:oe,onFilterChange:ie,onPageChange:he,onDelSelect:ge,onColHeadFilterVisibleChange:we,onOk:de,onSort:se,onFilterConfirm:De,onFilterShow:Ke},setTableListConfig:Be,refreshRefList:ce}},De=a(49624),Oe=a(37668),_e=a(7336);function je(e,t){var a=l()(e);if(o()){var n=o()(e);t&&(n=k()(n).call(n,(function(t){return i()(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ae(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?je(Object(a),!0).forEach((function(t){(0,p.c)(e,t,a[t])})):d()?f()(e,d()(a)):je(Object(a)).forEach((function(t){m()(e,t,i()(a,t))}))}return e}var Ve=(0,F.memo)((function(e){var t=(0,F.useReducer)(ue,ie),a=(0,b.c)(t,2),n=a[0],l=a[1],r=(0,F.useContext)(D.m).model,o=(0,F.useState)(!1),c=(0,b.c)(o,2),i=c[0],u=c[1],d=r.getControlText,s=r.emitEvent,f=e.controlMeta,v=f.pageId,m=f.id,p=f.dataRange,h=f.Status,g=(0,F.useRef)(h),C=(0,F.useRef)({}),w=(0,F.useRef)(Ae({},n)),I=(0,F.useRef)([]),N=(0,F.useRef)([]);(0,F.useEffect)((function(){w.current=n}),[n]);var M=(0,F.useRef)({pageNum:1,pageSize:10});f.caption=f.text;var V=(0,F.useCallback)((function(e){var t=(null==e?void 0:y()(e).call(e,2))||[];t=k()(t).call(t,(function(e){return e}));var a=t.length>0?t.join("｜"):"";return{label:e[1]||"-",value:e[0],des:a}}),[]),Y=(0,F.useCallback)((function(e){var t={k:m,r:0,v:e};r.batchInvoke(j.yo,v,"",[],[{},[t]])}),[]),B=(0,F.useCallback)((function(e){var t=M.current,a=t.pageNum,n=t.pageSize;r.batchInvoke(j.kV,v,m,[[n,a,"","","",{showType:"list",pks:e}]])}),[]),q=(0,F.useRef)({key:"",filter:"",pageNum:1,pageSize:10,sort:""}),L=(0,F.useCallback)((function(e){q.current=Ae(Ae({},q.current),e);var t=q.current,a=t.key,n=k()(t),l=t.pageNum,o=t.pageSize,c=E()(t);r.batchInvoke(j.kV,v,m,[[o,l,a,n,c]])}),[v,m]),z=(0,Ne.c)(L),U=(0,F.useCallback)((function(e){if(null!=e&&e.v){var t,a=S()(t=e.v).call(t,(function(e){return e[0]}));B(a)}else B([])}),[l,B,V]),W=Ke({state:n,controlMeta:f,model:r,f7Params:q,dispatch:l,onF7Search:z,formateData:V,updateServerValue:Y,onSearchAction:B,setVisible:u}),H=W.setTableListConfig,X=W.refreshRefList,$=W.props,J=(0,F.useCallback)((function(e){var t=[];e.forEach((function(e){var a,n,l,r,o=e.editor,c=void 0===o?{}:o,i=c.Visibility,u=void 0===i?"all":i,s=c.Status,f="seq"===(null==e?void 0:e.dataIndex)?"center":"number"===(null==e||null===(a=e.editor)||void 0===a?void 0:a.type)?"right":"left",p="1"===s&&(null===(n=e.editor)||void 0===n?void 0:n.mi)||"5"===s;(e.pageId=v,e.id=m,!e.hasOwnProperty("visible")&&(0,te.SC)(u))&&t.push({code:e.dataIndex,title:K().createElement(se.c,{isMust:p,tips:null===(l=e.editor)||void 0===l?void 0:l.helpTips,title:d(e.header)}),width:e.width||R()(d(e.w))||200,lock:"operate"===(null==e||null===(r=e.editor)||void 0===r?void 0:r.type),align:f,render:function(t,a,n){return K().createElement(ee.c,{meta:e,gridStatus:g.current,value:t,record:a,rowIndex:n})}})})),l({type:A.OK,payload:t})}),[v,m]),Q=function(e,t){return S()(e).call(e,(function(e){var a={};for(var n in t)a[n]=e[t[n]];return a}))},Z=(0,F.useCallback)((function(){I.current=(0,_e.gB)(I.current,N.current),J(I.current)}),[J]),ne=(0,Ne.c)(Z,20),le=(0,F.useCallback)((function(e){var t=(e||{}).v;if(T()(t).call(t,"@@")){var a=t.split("@@"),n=(0,b.c)(a,2),l=n[0],o=n[1];N.current.push({key:l,status:o}),ne()}else Number(t)<5&&(g.current=t,ne()),r.emitEvent(A.uu,Ae(Ae({},e||{}),{},{pageId:v}))}),[ne]);r.useInvokeControlMethod(f,(function(e){e.forEach((function(t){var a,n,o=t.methodname,c=t.args;switch(o){case j.Ir:break;case j.eo:p.max<=w.current.dataSource.length&&(0,Oe.s9)("最多只能录入".concat(p.max,"条数据"),3e3,1),l({type:A.Wy,payload:Q(c[0],C.current)});break;case j.yY:l({type:A.o$,payload:c[0]});break;case j.yi:case j.qo:case j.mO:break;case j.ct:var i,d;if(-1===c[0].r)l({type:G,payload:c[0]});else s(x()(i=x()(d="".concat(j.lN,"-")).call(d,v,"-")).call(i,m),e);break;case j.WK:var f,b,h;if(-1===c[0].r)c[0].selected=(null===(f=c[0])||void 0===f?void 0:f.selected)||[],H(c[0]);else s(x()(b=x()(h="".concat(j.lN,"-")).call(h,v,"-")).call(b,m),e);break;case j.__:l({type:P,payload:{key:c[0].args[0],value:c[0].data.rows[0]}});break;case j.S6:var y,g;if(c[0].data.rows[0],-1===c[0].r)l({type:P,payload:{key:c[0].args[0],value:c[0].data.rows[0]}});else s(x()(y=x()(g="".concat(j.lN,"-")).call(g,v,"-")).call(y,m),e);break;case j.kT:U({v:c[0]});break;case j.Tb:(0,De.M)(c[0]);break;case j.X3:(0,De.Q)(c[0]);break;case j.c$:X(c[0]);break;case j.mS:break;case j.MX:c[0],z({}),r.batchInvoke(j.gd,v,m,[[]]),u(!0);break;default:s(x()(a=x()(n="".concat(j.lN,"-")).call(n,v,"-")).call(a,m),e)}}))})),r.useUpdateControlStates(f,(function(e){if(e.data){C.current=e.data.dataindex,p.max<e.data.rows.length&&(0,Oe.s9)("最多只能录入".concat(p.max,"条数据"),3e3,1);var t=Q(e.data.rows,e.data.dataindex);l({type:A.GI,payload:t})}else l({type:A.CY,payload:e.fieldstates}),e.fieldstates.forEach((function(e){var t,a;s(x()(t=x()(a="".concat(j.lN,"-")).call(a,v,"-")).call(t,m,"-validate"),Ae(Ae({},e),{},{isLoadData:!1}))}))})),r.useControlActionListener(j.oH,f,le),(0,F.useEffect)((function(){I.current=(null==f?void 0:f.columns)||[],J(I.current)}),[]);var re=(0,F.useMemo)((function(){return(0,fe.k3)(520,1080)}),[]),oe=(0,F.useCallback)((function(){var e;null==$||null===(e=$.onCancel)||void 0===e||e.call($),u(!1)}),[null==$?void 0:$.onCancel]);return K().createElement(de.q.Provider,{value:{state:n,dispatch:l}},K().createElement(O.DataGrid,{className:ae,columns:(null==n?void 0:n.columns)||[],dataSource:(null==n?void 0:n.dataSource)||[]}),K().createElement(_.Modal,{title:"请选择",closable:!0,maskClosable:!1,mask:!0,keyboard:!1,showline:!0,getContainer:document.body,footer:null,visible:i,draggable:!0,destroyOnClose:!0,body:K().createElement(O.RefBillF7Content,$),onCancel:oe,width:1180,height:re,bodyStyle:{padding:0,height:"100%",overflow:"hidden"}}))}))}}]);