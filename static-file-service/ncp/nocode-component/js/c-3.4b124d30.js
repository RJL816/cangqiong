"use strict";(self.webpackChunknocode_component=self.webpackChunknocode_component||[]).push([[9028],{42996:function(e,a,t){t.r(a);var l=t(72048),n=t(65984),o=t.n(n),c=t(74238),r=t(38680),u=t(69984),i=t(14020),d=t(36260);a.default=function(e){var a=e.controlMeta,t=a.content,s=a.margin,f=a.autoHeight,v=a.defaultHeight,b=(0,i.yi)(s),p=b.margin,m=b.marginTop,y=b.marginRight,k=b.marginBottom,g=b.marginLeft,h={marginTop:"".concat(m,"px"),marginRight:"".concat(y,"px"),marginBottom:"".concat(k,"px"),marginLeft:"".concat(g,"px"),width:"auto"},C=-1===p?h:{margin:"".concat(p,"px"),width:"auto"},w=(0,n.useState)(t),S=(0,l.c)(w,2),F=S[0],K=S[1],D=(0,n.useRef)(),E=(0,n.useCallback)((function(e){K(e)}),[]),I=(0,n.useCallback)((function(e){var a;(E(e.v),!1===e.isLoadData)&&(null===(a=D.current)||void 0===a||a.validateFields("",e.v))}),[E]);(0,c.C3)(r.sv,a,I),(0,n.useEffect)((function(){E(t)}),[t]);var _=(0,c.sB)(a),R=_.hidden,N=_.required,T=_.rules;return R?null:o().createElement(u.c,{controlMeta:a,style:"0"!==p?C:{},required:N,rules:T,ref:D},o().createElement(d.c,{content:F,autoHeight:f,defaultHeight:v}))}},99964:function(e,a,t){t.r(a);var l=t(65984),n=t.n(l),o=t(47906),c=t(39756);a.default=(0,l.memo)((function(e){var a=e.controlMeta,t=(0,l.useContext)(c.m).model.getConfig,r=a.imageKey,u=t(a.pageId);return n().createElement(o.Image,{src:u.mobdomainurl+r})}))},23132:function(e,a,t){t.r(a),t.d(a,{default:function(){return Se}});var l=t(13939),n=t.n(l),o=t(34716),c=t.n(o),r=t(4884),u=t.n(r),i=t(3464),d=t.n(i),s=t(51400),f=t.n(s),v=t(25028),b=t.n(v),p=t(58496),m=t(81043),y=t(30112),k=t(72048),g=(t(86456),t(21300),t(87912),t(97308),t(50524)),h=t.n(g),C=t(73980),w=t.n(C),S=t(70696),F=t.n(S),K=t(24244),D=t.n(K),E=t(23992),I=t.n(E),_=t(760),R=t.n(_),N=t(99308),T=t.n(N),O=t(33260),x=t.n(O),H=t(35680),M=t.n(H),j=t(61260),z=t.n(j),A=t(24496),q=t.n(A),B=t(72400),U=t.n(B),P=t(65984),V=t.n(P),L=t(39756),G=t(14020),Q=t(69984),W=t(47906),$=t(38680),J=t(59992),X=t.n(J),Y=X()("更新下拉数据"),Z=X()("设置下拉选中值"),ee=X()("设置下拉选项"),ae=X()("设置F7表格数据"),te=X()("设置F7表格配置信息"),le=X()("设置F7表格请求过滤条件"),ne=(X()("F7单个删除已选"),X()("设置F7表格行选择数据")),oe=X()("更新F7表格行选择数据和下标"),ce=X()("设置F7表格行选择数据下标"),re=X()("F7点击清空按钮"),ue=X()("设置表格筛选项"),ie=X()("表格列排序"),de=X()("关联表单表格模式列头设置"),se=X()("关联表单表格模式数据"),fe=t(86132);function ve(e,a){var t=n()(e);if(c()){var l=c()(e);a&&(l=F()(l).call(l,(function(a){return u()(e,a).enumerable}))),t.push.apply(t,l)}return t}function be(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?ve(Object(t),!0).forEach((function(a){(0,y.c)(e,a,t[a])})):d()?f()(e,d()(t)):ve(Object(t)).forEach((function(a){b()(e,a,u()(t,a))}))}return e}var pe={value:[],label:"",options:[],column:[],dataSource:[],tableData:{rows:[]},tableConfig:{},tableColumn:[],tableColumnData:[],tableFilterData:[],rowSelected:{},selectedKeys:[],colFilter:{},colSort:{}},me=(0,fe.c)((function(e,a){var t,l=a.type,n=a.payload;switch(l){case Y:e.value=n.value,e.options=n.options,e.selectedKeys=n.selectedKeys;break;case Z:e.value=n.value,e.selectedKeys=n.selectedKeys;break;case ee:e.options=n;break;case se:e.dataSource=n,e.selectedKeys=I()(t=n.rows).call(t,(function(e){return e.id}));break;case ae:e.tableData=n.data;break;case de:e.column=n;break;case te:e.tableConfig=n.tableConfig,e.rowSelected=n.rowSelected,e.tableColumn=n.tableColumn,e.tableColumnData=n.tableColumnData,e.selectedKeys=n.selectedKeys;break;case ue:e.tableFilterData=n;break;case ne:e.rowSelected=n.rowSelected,e.selectedKeys=n.selectedKeys;break;case re:e.rowSelected=[],e.selectedKeys=[];break;case ce:e.selectedKeys=n.selectedKeys,e.rowSelected=n.rowSelected;break;case oe:e.selectedKeys=n.selectedKeys,e.rowSelected=be(be({},e.rowSelected),n.rowSelected);break;case le:e.colFilter[n.key]=n.value;break;case ie:e.colSort=n}})),ye=t(76352),ke=t(46276),ge=t(49624);function he(e,a){var t=n()(e);if(c()){var l=c()(e);a&&(l=F()(l).call(l,(function(a){return u()(e,a).enumerable}))),t.push.apply(t,l)}return t}function Ce(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?he(Object(t),!0).forEach((function(a){(0,y.c)(e,a,t[a])})):d()?f()(e,d()(t)):he(Object(t)).forEach((function(a){b()(e,a,u()(t,a))}))}return e}var we=function(e){var a=e.controlMeta,t=e.invokeData,l=e.onChange,n=(0,P.useContext)(L.m).model,o=(0,P.useReducer)(me,pe),c=(0,k.c)(o,2),r=c[0],u=c[1],i=(0,P.useState)(0),d=(0,k.c)(i,2),s=(d[0],d[1]),f=(0,P.useState)([]),v=(0,k.c)(f,2),b=v[0],y=v[1],g=a.pageId,C=a.id,S=(a.dataRange,a.propsDisplay),K=a.dispSelected,E=a.refbilltype,_=(0,ke.s)(a),N=_.readonly,O=(_.placeholder,_.disabled),H=_.hidden,j=_.required,A=_.rules,B=(0,P.useRef)((null==S?void 0:S.split(","))||[]),J=(0,P.useRef)(!1),X=(0,P.useRef)({attachment:n.getFileServer("attachment"),picture:n.getFileServer("picture")}),Y=(0,P.useRef)(r),fe=(0,P.useRef)(N||O),ve=(0,P.useRef)(!1);(0,P.useEffect)((function(){fe.current=N||O}),[N,O]);var be=(0,P.useRef)({pageNum:1,pageSize:10}),he=(0,P.useRef)({key:"",filter:"",pageNum:1,pageSize:10,sort:""}),we=1===a.multi,Se=W.DataGrid.CellRender,Fe=(0,P.useMemo)((function(){var e;return!h()(e=["bos_user","bos_adminorg"]).call(e,E)}),[E]),Ke=(0,P.useCallback)((function(e){var a=(null==e?void 0:w()(e).call(e,2))||[];a=F()(a).call(a,(function(e){return e}));var t=a.length>0?a.join("｜"):"-";return{label:e[1]||"-",value:e[0],des:t}}),[]),De=(0,P.useCallback)((function(e){if(l)return l(e);var a={k:C,r:0,v:e};n.batchInvoke($.yo,g,"",[],[{},[a]]),n.batchInvoke($.Se,g,C,[[e,0]])}),[l]),Ee=(0,P.useCallback)((function(e,a){var t=e?we?e:[e]:[],l=[];r.options.forEach((function(e){h()(t).call(t,e.value)&&l.push(e.label)})),u({type:Z,payload:{value:e||(we?[]:""),selectedKeys:t}}),(!we||we&&!J.current)&&De(t)}),[r.options,we,De]),Ie=(0,P.useCallback)((function(e){var a=be.current,t=a.pageNum,l=a.pageSize;n.batchInvoke($.kV,g,C,[[l,t,"","","",{showType:"list",pks:e}]])}),[]),_e=(0,P.useCallback)((function(e,a){r.selectedKeys,be.current.pageNum=e,be.current.pageSize=a,Ie(r.selectedKeys)}),[r.selectedKeys,Ie]),Re=(0,P.useCallback)((0,G.Cu)((function(e){he.current=Ce(Ce({},he.current),e);var a=he.current,t=a.key,l=F()(a),o=a.pageNum,c=a.pageSize,r=D()(a);n.batchInvoke($.kV,g,C,[[c,o,t,l,r]])})),[g,C]),Ne=(0,P.useCallback)((function(){N||O||(ve.current=!0,Re({}),n.batchInvoke($.gd,g,C,[[]]))}),[N,O,Re]),Te=(0,P.useCallback)((function(){u({type:re})}),[u]),Oe=(0,P.useCallback)((function(e){var a,t=e.pkId,l=Ce({},r.rowSelected),n=S.split(","),o=I()(n).call(n,(function(a){return e[a]})),c=Ke(R()(a=[t]).call(a,(0,m.c)(o))),i=new(T())(r.selectedKeys),d=we?(0,m.c)(i.add(t)):[t];l[t]=c,ve.current?(u({type:ce,payload:{selectedKeys:d,rowSelected:l}}),Re({})):(Ie(d),De(d))}),[we,S,r.selectedKeys,Re,r.rowSelected]),xe=(0,P.useCallback)((function(e){u({type:ue,payload:e});var a=I()(e).call(e,(function(e){return{compareType:e.compareType,fieldName:e.fieldName,value:e.value}}));Re({filter:a})}),[Re,u]),He=(0,P.useCallback)((function(){ve.current=!1,he.current={key:"",filter:"",pageNum:1,pageSize:10,sort:""}}),[]),Me=(0,P.useCallback)((function(){ve.current=!0;var e=r.selectedKeys;u({type:Z,payload:{value:we?e:e.join(),selectedKeys:e}}),De(e.join()),He()}),[r.selectedKeys,De,u,He]),je=(0,P.useCallback)((function(e,a){var t={};if(0===a)delete t[e];else{var l,n=-1===a?"desc":"";t[e]=R()(l="".concat(e)).call(l,n?" "+n:"")}Re({sort:t[e]||""}),y([{number:e,isAsc:1===a}]),u({type:ie,payload:t})}),[Re,y,u]),ze=(0,P.useCallback)((function(e){Re({key:e||""})}),[Re]),Ae=(0,P.useCallback)((function(e,a){Re({pageNum:e,pageSize:a})}),[Re]),qe=(0,P.useCallback)((function(e){var a=Ce({},r.rowSelected),t=new(T())(r.selectedKeys);e.forEach((function(e){delete a[e],t.delete(e)})),u({type:ne,payload:{rowSelected:a,selectedKeys:(0,m.c)(t)}})}),[r.rowSelected,r.selectedKeys,u]),Be=(0,P.useCallback)((function(e,a,t,l){var n,o=r.tableData;"uncheck"!==l&&"uncheck-all"!==l||qe(t);var c=null==o?void 0:F()(n=o.rows).call(n,(function(a){return h()(e).call(e,a.id)})),i={};c.forEach((function(e){var a=e.id,t=e._title_;if(t){var l,n=x()(t).call(t,"|"),o=t.substring(0,n),c=M()(l=t.substr(n+1)).call(l,"|","｜");i[e.id]={value:a,label:o,des:c}}else{var r=[e.id];B.current.forEach((function(a){r.push(e[a])})),i[e.id]=Ke(r)}})),u({type:oe,payload:{selectedKeys:e,rowSelected:i}})}),[r.tableData,Ke,qe]),Ue=(0,P.useCallback)((function(e,a){n.batchInvoke($.kD,g,C,[[e.fieldName,a]])}),[g,C]),Pe=(0,P.useCallback)((function(e){var a,t=n.getConfig(g),l={params:"1",appId:t.appId,fId:t.formId,fileName:e.name},o=R()(a="".concat(e.url,"&kd_cs_ticket=")).call(a,n.Global.token);(0,G.gr)(o,l)}),[]),Ve=(0,P.useCallback)((function(e,a){n.batchInvoke($.kD,g,C,[[e,a]])}),[g,C]),Le=(0,P.useCallback)((function(e,a){var t,l;e.forEach((function(a,t){a.value.forEach((function(a){"all"===a.type&&z()(e).call(e,t,1)}))}));var n=(null==r?void 0:r.tableFilterData)||[],o=(null==n||null===(t=F()(n))||void 0===t?void 0:t.call(n,(function(e){return e.fieldName!==a})))||[],c=R()(l=[]).call(l,(0,m.c)(e),(0,m.c)(o));xe(c)}),[xe,r.tableFilterData]),Ge=(0,P.useCallback)((function(e){var a="nocodedecimalfield"===e.type?"right":"",t={align:a,title:e.name,number:e.number,type:e.type};return{code:e.number,title:V().createElement(W.TableTitle,t),width:200,align:a,lock:!1,render:function(a,t,l){var o;if(h()(o=["nocodeimageuploadfield","nocodeattachmentuploadfield","nocodeselectitemfield"]).call(o,e.type)){var c=a;return"nocodeselectitemfield"===e.type&&(c=Array.isArray(a)?I()(a).call(a,(function(e){return Ce(Ce({},e),{},{label:n.getControlText(e.name)})})):[]),V().createElement(Se,{readOnly:!0,type:e.type,baseUrl:X.current,onDownLoad:Pe,value:c,record:t,rowIndex:l})}return null===a?"":"boolean"==typeof a?a?"是":"否":"object"===(0,p.c)(a)?q()(a):a}}}),[je,Pe]),Qe=(0,P.useCallback)((function(e){var a=e.id;n.batchInvoke($.E_,g,C,[[a,S]])}),[g,C,S]),We=(0,P.useCallback)((function(e){var a,t=e.id,l=null===(a=Y.current.selectedKeys)||void 0===a?void 0:F()(a).call(a,(function(e){return e!==t}));Ee(we?l:l.join(),null),Ie(l)}),[Ee,we]),$e=(0,P.useCallback)((function(e,a){switch(e){case"delete":We(a);break;case"detail":n.batchInvoke("showInfo",g,C,[[a.id]]);break;case"edit":Qe(a)}}),[We,Qe,g,C]),Je=(0,P.useCallback)((function(e,a){var t=e.listItemConfig,l=a?he.current:be.current,n=l.pageSize*(l.pageNum-1),o=[{code:"No",title:"序号",width:60,align:"center",lock:!0,render:function(e,a,t){return n+t+1}}],c=[];return t.forEach((function(e){o.push(Ge(e)),c.push({key:e.number,title:e.name})})),(Fe&&a||!a)&&o.push({code:"operator",title:"操作",width:100,lock:!0,render:function(e,t,l){return V().createElement(ye.c,{isF7:a,onItemClick:$e,disabled:fe.current,record:t})}}),Ce(Ce({},e),{},{data:c,column:o,editF7Record:Qe})}),[Fe,N,O,$e,Qe]),Xe=(0,P.useCallback)((function(e){var a=(Je(e.data.rows[0],!1)||{}).column;u({type:de,payload:a})}),[]),Ye=(0,P.useCallback)((function(e){var a={},t=[];e.selected.forEach((function(e){a[e[0]]=Ke(e),t.push(e[0])}));var l=Je(e.data.rows[0],!0);u({type:te,payload:{tableConfig:e.data.rows[0],tableColumn:l.column,tableColumnData:l.data,rowSelected:a,selectedKeys:t}})}),[Je,u]),Ze=(0,P.useCallback)((0,G.Cu)((function(){n.batchInvoke("addNewRef",g,C,[[S]])})),[S,g,C]),ea=(0,P.useCallback)((function(e){if(null!=e&&e.v){var a,t=I()(a=e.v).call(a,(function(e){return e[0]}));Ie(t)}else Ie([])}),[u,Ie,Ke]),aa=(0,P.useCallback)((function(e){var a,t,l,n;if(e){var o=e[0],c=o.methodname,r=o.args;switch(c){case $.Ex:u({type:ee,payload:null===(a=r[0])||void 0===a||null===(a=a.data)||void 0===a?void 0:I()(a).call(a,(function(e){return Ke(e)}))}),s((null===(t=r[0])||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length)>0?0:2);break;case $.ct:"list"===(null===(l=r[0].args)||void 0===l||null===(l=l[5])||void 0===l?void 0:l.showType)?u({type:se,payload:r[0].data}):u({type:ae,payload:r[0]});break;case $.WK:var i;if("list"===(null===(n=r[0].args)||void 0===n||null===(n=n[0])||void 0===n?void 0:n.showType))Xe(r[0]);else r[0].selected=(null===(i=r[0])||void 0===i?void 0:i.selected)||[],Ye(r[0]);break;case $.__:u({type:le,payload:{key:r[0].args[0],value:r[0].data.rows[0]}});break;case $.S6:r[0].data.rows[0],u({type:le,payload:{key:r[0].args[0],value:r[0].data.rows[0]}});break;case $.kT:ea({v:r[0]});break;case"showUserInfo":(0,ge.M)(r[0]);break;case"showOrgInfo":(0,ge.Q)(r[0]);break;case $.c$:Oe(r[0])}}}),[Oe,ea,s,u,Ye,Xe]);return n.useUpdateControlStates(a,ea),n.useInvokeControlMethod(a,aa),(0,P.useEffect)((function(){aa(t)}),[t]),(0,P.useEffect)((function(){Y.current=r}),[r]),(0,P.useEffect)((function(){ea(e.value),n.batchInvoke($.gd,g,C,[[{showType:"list"}]])}),[]),H?null:V().createElement(Q.c,{controlMeta:a,required:j,rules:A},V().createElement(W.RefBillGridView,{dataSource:(null==r?void 0:r.dataSource)||[],disabled:O,readOnly:N,column:(null==r?void 0:r.column)||[],mode:we?"multiple":"single",tablePrimaryKey:"id",tableSorts:b,tableColFilter:null==r?void 0:r.colFilter,tableData:null==r?void 0:r.tableData,tableConfig:null==r?void 0:r.tableConfig,tableColumn:null==r?void 0:r.tableColumn,tableColumnData:null==r?void 0:r.tableColumnData,tableFilterData:null==r?void 0:r.tableFilterData,tableSelected:null!=r&&r.rowSelected?U()(null==r?void 0:r.rowSelected):[],tableSelectedKeys:(null==r?void 0:r.selectedKeys)||[],showSelected:1===K,f7Options:{showAddRecord:Fe,onAddRecord:Ze},onChange:Ee,onPageChange:_e,moreClick:Ne,onF7Search:ze,onF7FilterChange:xe,onF7PageChange:Ae,onF7Ok:Me,onF7Cancel:He,onF7Clean:Te,onF7DelSelect:qe,onF7RowSelectChange:Be,f7ColHeadFilter:r.colFilter,onF7ColHeadFilterVisibleChange:Ue,onF7Sort:je,onF7TitleFilterConfirm:Le,onF7TitleFilterShow:Ve}))};we.displayName="KDRefBillGridView";var Se=V().memo(we)},5364:function(e,a,t){t.r(a);var l,n=t(2664),o=t(34984),c=t(72048),r=t(760),u=t.n(r),i=t(65984),d=t.n(i),s=t(47906),f=t(39756),v=t(74238),b=t(38680),p=t(69984),m=t(14020),y=["hidden","readonly","required","rules"],k=window.NOCODE_SHARE_ID?"noCodeShareId=".concat(window.NOCODE_SHARE_ID):"",g=window.__kd_cdnPath__||window.__domainurl__,h=(0,m.oA)(window.__domainurl__+u()(l="nocode/v2/nocode_sys/image".concat(k?"?":"")).call(l,k));a.default=function(e){var a=e.controlMeta,t=a.id,l=a.pageId,r=(0,i.useContext)(f.m).model,u=r.getFileServer("picture"),m=(0,i.useRef)(),k=(0,i.useState)(""),C=(0,c.c)(k,2),w=C[0],S=C[1],F=(0,i.useRef)();(0,v.C3)(b.sv,a,(function(e){var a;(S((null==e?void 0:e.v)||""),!1===e.isLoadData)&&(null===(a=F.current)||void 0===a||a.validateFields("",(null==e?void 0:e.v)||""))}));var K=(0,v.sB)(a),D=K.hidden,E=K.readonly,I=K.required,_=K.rules,R=(0,o.c)(K,y),N=a.defaultHeight,T=a.autoHeight;return D?null:d().createElement(p.c,{controlMeta:a,required:I,rules:_,ref:F},d().createElement(s.RichText,(0,n.c)({ref:m,readOnly:E,height:N,autoHeight:T,content:w,srcUrl:g,imageUrlPrefix:window.origin,imagesUploadUrl:h,pictureServer:u,onChange:function(e){r.setPostData(l,t,e)},onBlur:function(e){var a={k:t,r:0,v:e};r.batchInvoke("updateValue",l,"",[],[{},[a]])}},R)))}}}]);