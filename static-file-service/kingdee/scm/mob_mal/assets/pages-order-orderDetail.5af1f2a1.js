var e=(e,l,s)=>new Promise(((r,t)=>{var o=e=>{try{n(s.next(e))}catch(l){t(l)}},a=e=>{try{n(s.throw(e))}catch(l){t(l)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,a);n((s=s.apply(e,l)).next())}));import{M as l,r as s,c as r,D as t,d as o,e as a,f as n,s as u,a as d,g as f,u as i,l as c,t as _,h as m,i as I,j as p,F as w,m as b,k,O as x,b as g,p as y,ae as h}from"./index-45b322f7.js";import{c as C,b as v,_ as D}from"./s-pur-info-card.21d6f8a0.js";import{_ as F}from"./su-popup.9d6f394f.js";import{_ as j}from"./su-tabs.79d7f7f1.js";import{_ as T}from"./su-sticky.dcc8e273.js";import{_ as B}from"./s-layout.940eafb4.js";import"./index.f474d5f6.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uni-data-checkbox.f4bf4f0e.js";import"./uni-cloud.es.7d5f2c52.js";import"./uni-load-more.575c3b96.js";import"./uni-icons.c22fa7d9.js";const P=E({__name:"orderDetail",setup(E){const P=l({currentTab:0,orderInfo:{},showPurInfo:!1,showRemark:!1,supplierIdEditing:"",goodsIdEditing:""});s("测试测试测试");const A=r((()=>{switch(P.orderInfo.billstatus){case"A":return"保存";case"B":return"已提交";case"C":return"已审核";case"D":return"已关闭";case"Z":return"已作废"}})),R=r((()=>({background:S(P.orderInfo.billstatus),color:$(P.orderInfo.billstatus),borderColor:Z(P.orderInfo.billstatus)})));function O(e){if(null==e)return;let l=e.toString(),s=l.indexOf(".");if(-1==s)return N(l);{l=parseFloat(e).toFixed(2).toString();let r=l.substring(0,s),t=l.slice(s);return N(r)+t}}function N(e){if(null==e||null==e)return e;let l=e.split("").reverse();for(let s=0;4*s+3<l.length;s++){let e=4*s+3;l.splice(e,0,",")}return l.reverse().join("")}function S(e){switch(e){case"A":return"#e9f3fe";case"B":case"C":return"#F2FFF5";case"D":case"Z":return"#F5F5F5"}}function $(e){switch(e){case"A":return"#276FF5";case"B":case"C":return"#1BA854";case"D":case"Z":return"#666666"}}function Z(e){switch(e){case"A":return"#276FF5";case"B":case"C":return"#6DD18E";case"D":case"Z":return"#CCCCCC"}}const L=r((()=>{let e=[];for(let l in P.orderInfo.entryentity)P.orderInfo.entryentity[l].supplierName=P.orderInfo.entryentity[l][0].supplier_name,P.orderInfo.entryentity[l].note=P.orderInfo.entryentity[l][0].note,P.orderInfo.entryentity[l].supplierId=l,P.orderInfo.entryentity[l].platform=P.orderInfo.platform,P.orderInfo.entryentity[l].platformName=P.orderInfo.platform_name,P.orderInfo.entryentity[l].freight="none",P.orderInfo.entryentity[l].placeOrderItemList=[],P.orderInfo.entryentity[l].forEach((e=>{e.thumbnail=e.goodsimg,e.goodsName=e.goods_name,e.goodsAmount=e.taxamount,e.goodsPrice=e.taxprice,e.goodsId=e.goods_id,e.materialName=e.material_name,e.purTypeName=e.purtype_name,e.costProjectName=e.entrycostproject_name,e.goodsUseName=e.goodsuse_name,e.platform=P.orderInfo.platform,e.billstatus=P.orderInfo.billstatus,P.orderInfo.entryentity[l].placeOrderItemList.push(e)})),e.push(P.orderInfo.entryentity[l]);return e})),M=r((()=>L.value.find((e=>e.supplierId==P.supplierIdEditing)).placeOrderItemList.find((e=>e.goodsId==P.goodsIdEditing)))),q=r((()=>L.value.find((e=>e.supplierId==P.supplierIdEditing)).note));r((()=>"A"==P.orderInfo.billstatus));const z=[{name:"商品明细",value:"goodsDetail"},{name:"订单明细",value:"orderDetail"},{name:"发票明细",value:"invoiceDetail"}];function Q(e){P.supplierIdEditing=e,P.showRemark=!0}function U(l){return e(this,null,(function*(){x({title:"取消确认",content:"订单取消后将无法恢复，请确认是否要取消？",success:function(l){l.confirm&&function(){e(this,null,(function*(){0==(yield u.$api.order.cancelOrder({data:{ids:[P.orderInfo.id]}})).errorCode&&(P.orderInfo.billstatus="Z")}))}()}})}))}function G(l){return e(this,null,(function*(){0==(yield u.$api.order.auditOrder({data:{billno:P.orderInfo.billno,id:[P.orderInfo.id]}})).errorCode&&(P.orderInfo.billstatus="C")}))}function H(l){!function(){e(this,null,(function*(){const e=yield u.$api.order.oneMoreOrder({id:P.orderInfo.id});0==e.errorCode&&(u.$store("cart").selectedList=[],u.$store("order").rePlaceOrder(e),u.$router.go("/pages/order/submit-order",{rePlace:!0}))}))}()}function J(){return e(this,null,(function*(){(yield u.$api.order.confirmReceipt({data:{ids:[P.orderInfo.id]}})).errorCode}))}function K(e){P.currentTab!==e.index&&(P.currentTab=e.index)}function V(e){if(null==e||""==e||null==e)return"";return new Date(e).toLocaleDateString()}function W(e){switch(e){case"1":return"价外税(含税)";case"2":return"价外税(不含税)";case"3":return"价内税(含税)"}}function X(e,l){P.supplierIdEditing=e,P.goodsIdEditing=l,P.showPurInfo=!0}return t((l=>{console.log(l.id),function(l,s,r=1,t=1){e(this,null,(function*(){const e=yield u.$api.order.detail({pageNo:r,pageSize:t,id:l,billno:s});0==e.errorCode&&(P.orderInfo=e.data.rows[0])}))}(l.id,l.billno)})),(e,l)=>{const s=d(g("s-pur-info-card"),C),r=d(g("su-popup"),F),t=d(g("s-remark-card"),v),u=y,x=d(g("su-tabs"),j),E=d(g("su-sticky"),T),N=d(g("s-order-list-item-card"),D),S=h,$=d(g("s-layout"),B);return o(),a($,null,{default:n((()=>[f(r,{show:P.showPurInfo,onClose:l[2]||(l[2]=()=>P.showPurInfo=!1)},{default:n((()=>[f(s,{supplierId:P.supplierIdEditing,goodsId:P.goodsIdEditing,canEdit:!1,goodsDetail:i(M),onClickAckBtn:l[0]||(l[0]=()=>P.showPurInfo=!1),onClickCloseIcon:l[1]||(l[1]=()=>P.showPurInfo=!1)},null,8,["supplierId","goodsId","goodsDetail"])])),_:1},8,["show"]),f(r,{show:P.showRemark,onClose:l[5]||(l[5]=()=>P.showRemark=!1)},{default:n((()=>[f(t,{canEdit:!1,content:i(q),onClickAckBtnRemark:l[3]||(l[3]=()=>P.showRemark=!1),onClickCloseIconRemark:l[4]||(l[4]=()=>P.showRemark=!1)},null,8,["content"])])),_:1},8,["show"]),f(u,{class:"order-card"},{default:n((()=>[f(u,{class:"head"},{default:n((()=>[f(u,{class:"order-card-head ss-flex ss-row-between ss-col-center"},{default:n((()=>[f(u,{class:"order-number"},{default:n((()=>[c(_(P.orderInfo.billno),1)])),_:1}),f(u,{class:"ss-flex"},{default:n((()=>[f(u,{class:"status-tag",style:m([i(R)])},{default:n((()=>[c(_(i(A)),1)])),_:1},8,["style"])])),_:1})])),_:1}),f(u,{class:"ss-flex-col info"},{default:n((()=>[f(u,{class:"content ss-flex"},{default:n((()=>[c(" 电商平台"),f(u,{class:"content-value"},{default:n((()=>[c(_(P.orderInfo.platform_name),1)])),_:1})])),_:1}),f(u,{class:"content ss-flex"},{default:n((()=>[c(" 申请组织"),f(u,{class:"content-value"},{default:n((()=>[c(_(P.orderInfo.deporg_name),1)])),_:1})])),_:1}),f(u,{class:"content ss-flex"},{default:n((()=>[c(" 申请人"),f(u,{class:"content-value"},{default:n((()=>[c(_(P.orderInfo.reqperson_name),1)])),_:1})])),_:1}),f(u,{class:"content ss-flex"},{default:n((()=>[c(" 订货日期"),f(u,{class:"content-value"},{default:n((()=>[c(_(V(P.orderInfo.billdate)),1)])),_:1})])),_:1})])),_:1})])),_:1}),f(E,{bgColor:"#fff",stickyToTop:!1,class:"ss-m-t-20"},{default:n((()=>[f(x,{showNavLine:!0,list:z,scrollable:!1,onChange:K,current:P.currentTab},null,8,["current"])])),_:1}),0==P.currentTab?(o(),a(u,{key:0,class:"ss-flex-col content-area"},{default:n((()=>[(o(!0),I(w,null,p(i(L),((e,l)=>(o(),a(N,{class:k([{cardTop:0!=l},"itemCard"]),goodsDetailItem:e,canEdit:!1,onOnClickRowPurInfo:X,onOnClickRemark:Q},null,8,["class","goodsDetailItem"])))),256)),f(u,{class:"amountDtailTittle"},{default:n((()=>[c("商务明细")])),_:1}),f(u,{class:"ss-flex-col amountDetail"},{default:n((()=>[f(u,{class:"ss-flex ss-row-between"},{default:n((()=>[c(" 付款条件："),f(u,null,{default:n((()=>[c(_(P.orderInfo.paycond_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex valueStyle ss-row-between"},{default:n((()=>[c(" 结算方式："),f(u,null,{default:n((()=>[c(_(P.orderInfo.settletype_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex valueStyle ss-row-between"},{default:n((()=>[c(" 结算币别："),f(u,null,{default:n((()=>[c(_(P.orderInfo.curr_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex valueStyle ss-row-between"},{default:n((()=>[c(" 计税类型："),f(u,null,{default:n((()=>[c(_(W(P.orderInfo.taxtype)||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex valueStyle ss-row-between"},{default:n((()=>[c(" 订单金额（含附加费）："),f(u,{class:"amountStyle"},{default:n((()=>[c("￥"+_(O(P.orderInfo.sumtaxamount)),1)])),_:1})])),_:1})])),_:1})])),_:1})):b("",!0),1==P.currentTab?(o(),a(u,{key:1,class:"ss-flex-col content-area"},{default:n((()=>[f(u,{class:"amountDtailTittle"},{default:n((()=>[c("申请信息")])),_:1}),f(u,{class:"ss-flex-col remarkFee"},{default:n((()=>[f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("订货日期")])),_:1}),f(u,null,{default:n((()=>[c(_(V(P.orderInfo.billdate)||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("业务类型")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.businesstype_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("申请人")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.reqperson_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("申请组织")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.deporg_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("需求日期")])),_:1}),f(u,null,{default:n((()=>[c(_(V(P.orderInfo.delidate)||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("采购员")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.person_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex-col remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("申请事由")])),_:1}),f(u,{class:"textArea ss-flex ss-row-center"},{default:n((()=>[f(S,{class:"area",disabled:!0,value:P.orderInfo.remark},null,8,["value"])])),_:1})])),_:1})])),_:1}),f(u,{class:"amountDtailTittle"},{default:n((()=>[c("收货明细")])),_:1}),f(u,{class:"ss-flex-col remarkFee"},{default:n((()=>[f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("收货人")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.receipt_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("收货人电话")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.receipt_phone||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("收货人邮政编码")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.receipt_postalcode||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("收货人邮箱")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.receipt_email||"-"),1)])),_:1})])),_:1})])),_:1}),f(u,{class:"amountDtailTittle"},{default:n((()=>[c("电商信息")])),_:1}),f(u,{class:"ss-flex-col remarkFee"},{default:n((()=>[f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("电商平台")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.platform_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("电商订单号")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.jdorderid||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("电商订单状态")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.orderstatus_name||"-"),1)])),_:1})])),_:1})])),_:1})])),_:1})):b("",!0),2==P.currentTab?(o(),a(u,{key:2,class:"ss-flex-col content-area"},{default:n((()=>[f(u,{class:"amountDtailTittle"},{default:n((()=>[c("组织信息")])),_:1}),f(u,{class:"ss-flex-col remarkFee"},{default:n((()=>[f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("采购组织")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.org_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("收货组织")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.rcvorg_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("核算组织")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.settleorg_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("费用承担部门")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.expenseorg_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("成本中心")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.costorg_name||"-"),1)])),_:1})])),_:1})])),_:1}),f(u,{class:"amountDtailTittle"},{default:n((()=>[c("开票信息")])),_:1}),f(u,{class:"ss-flex-col remarkFee"},{default:n((()=>[f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("开票单位")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.invoiceorg_name||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("发票抬头")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.invoiceorg_ffirmname||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("纳税识别号")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.invoiceorg_ftaxregnum||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("开户银行")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.invoiceorg_depositbank||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("银行账号")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.invoiceorg_bankaccount||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,{class:"ss-line-1 info-titlte"},{default:n((()=>[c("公司地址")])),_:1}),f(u,{class:"info-content"},{default:n((()=>[c(_(P.orderInfo.invoiceorg_faddress||"-"),1)])),_:1})])),_:1}),f(u,{class:"ss-flex ss-row-between remark"},{default:n((()=>[f(u,null,{default:n((()=>[c("公司电话")])),_:1}),f(u,null,{default:n((()=>[c(_(P.orderInfo.invoiceorg_phone||"-"),1)])),_:1})])),_:1})])),_:1})])),_:1})):b("",!0),f(u,{class:"ss-flex toolbar"},{default:n((()=>["D"!=P.orderInfo.billstatus&&"Z"!=P.orderInfo.billstatus?(o(),a(u,{key:0,class:"toolBtn",onClick:U},{default:n((()=>[c("取消订单")])),_:1})):b("",!0),f(u,{class:k(["toolBtn",{oneMoreBtn:"D"==P.orderInfo.billstatus||"Z"==P.orderInfo.billstatus||"C"==P.orderInfo.billstatus||"A"==P.orderInfo.billstatus}]),onClick:H},{default:n((()=>[c("再来一单")])),_:1},8,["class"]),"C"==P.orderInfo.billstatus&&"1"!=P.orderInfo.platform?(o(),a(u,{key:1,class:"toolBtn oneMoreBtn",onClick:J},{default:n((()=>[c("电商确认收货")])),_:1})):b("",!0),"B"==P.orderInfo.billstatus?(o(),a(u,{key:2,class:"toolBtn oneMoreBtn",onClick:G},{default:n((()=>[c("审核")])),_:1})):b("",!0)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-1eed0e49"]]);export{P as default};
