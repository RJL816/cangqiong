// Build date: 2024/8/28 19:42:15
 // Version: 0.0.0
 "use strict";
(self["webpackChunkreact_flow_plan"] = self["webpackChunkreact_flow_plan"] || []).push([[830],{

/***/ 446:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  CusContext: function() { return /* binding */ CusContext; },
  "default": function() { return /* binding */ src_App; }
});

// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.symbol.js
var es_symbol = __webpack_require__(36063);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.symbol.description.js
var es_symbol_description = __webpack_require__(91827);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.symbol.iterator.js
var es_symbol_iterator = __webpack_require__(42479);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.symbol.to-primitive.js
var es_symbol_to_primitive = __webpack_require__(31240);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.concat.js
var es_array_concat = __webpack_require__(83814);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.filter.js
var es_array_filter = __webpack_require__(59252);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.find.js
var es_array_find = __webpack_require__(68965);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.find-index.js
var es_array_find_index = __webpack_require__(13016);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.from.js
var es_array_from = __webpack_require__(46942);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.includes.js
var es_array_includes = __webpack_require__(34523);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.iterator.js
var es_array_iterator = __webpack_require__(30940);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.map.js
var es_array_map = __webpack_require__(72074);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.slice.js
var es_array_slice = __webpack_require__(73730);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.sort.js
var es_array_sort = __webpack_require__(64506);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.date.to-primitive.js
var es_date_to_primitive = __webpack_require__(77416);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.function.name.js
var es_function_name = __webpack_require__(39990);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.number.constructor.js
var es_number_constructor = __webpack_require__(87736);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.object.get-own-property-descriptor.js
var es_object_get_own_property_descriptor = __webpack_require__(84495);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.object.get-own-property-descriptors.js
var es_object_get_own_property_descriptors = __webpack_require__(25802);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.object.keys.js
var es_object_keys = __webpack_require__(45084);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.object.to-string.js
var es_object_to_string = __webpack_require__(37623);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.regexp.exec.js
var es_regexp_exec = __webpack_require__(23315);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.regexp.to-string.js
var es_regexp_to_string = __webpack_require__(801);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.set.js
var es_set = __webpack_require__(31475);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.string.includes.js
var es_string_includes = __webpack_require__(64023);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.string.iterator.js
var es_string_iterator = __webpack_require__(78864);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.add-all.js
var esnext_set_add_all = __webpack_require__(1705);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.delete-all.js
var esnext_set_delete_all = __webpack_require__(49331);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.difference.js
var esnext_set_difference = __webpack_require__(99933);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.every.js
var esnext_set_every = __webpack_require__(71323);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.filter.js
var esnext_set_filter = __webpack_require__(48788);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.find.js
var esnext_set_find = __webpack_require__(44453);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.intersection.js
var esnext_set_intersection = __webpack_require__(37135);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.is-disjoint-from.js
var esnext_set_is_disjoint_from = __webpack_require__(98592);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.is-subset-of.js
var esnext_set_is_subset_of = __webpack_require__(7551);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.is-superset-of.js
var esnext_set_is_superset_of = __webpack_require__(96038);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.join.js
var esnext_set_join = __webpack_require__(89298);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.map.js
var esnext_set_map = __webpack_require__(3402);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.reduce.js
var esnext_set_reduce = __webpack_require__(50996);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.some.js
var esnext_set_some = __webpack_require__(78546);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.symmetric-difference.js
var esnext_set_symmetric_difference = __webpack_require__(80839);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.set.union.js
var esnext_set_union = __webpack_require__(70963);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/web.dom-collections.for-each.js
var web_dom_collections_for_each = __webpack_require__(46112);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/web.dom-collections.iterator.js
var web_dom_collections_iterator = __webpack_require__(45005);
// EXTERNAL MODULE: ./node_modules/.pnpm/react@17.0.2/node_modules/react/index.js
var react = __webpack_require__(14552);
// EXTERNAL MODULE: ./node_modules/.pnpm/@reactflow+core@11.10.4_@types+react@17.0.80_immer@10.1.1_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/@reactflow/core/dist/esm/index.mjs + 4 modules
var esm = __webpack_require__(95594);
// EXTERNAL MODULE: ./node_modules/.pnpm/@reactflow+background@11.3.9_@types+react@17.0.80_immer@10.1.1_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/@reactflow/background/dist/esm/index.mjs
var dist_esm = __webpack_require__(53673);
// EXTERNAL MODULE: ./node_modules/.pnpm/@reactflow+minimap@11.7.9_@types+react@17.0.80_immer@10.1.1_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/@reactflow/minimap/dist/esm/index.mjs
var minimap_dist_esm = __webpack_require__(89039);
// EXTERNAL MODULE: ./node_modules/.pnpm/@reactflow+controls@11.2.9_@types+react@17.0.80_immer@10.1.1_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/@reactflow/controls/dist/esm/index.mjs
var controls_dist_esm = __webpack_require__(19504);
// EXTERNAL MODULE: ./node_modules/.pnpm/reactflow@11.10.4_@types+react@17.0.80_immer@10.1.1_react-dom@17.0.2_react@17.0.2__react@17.0.2/node_modules/reactflow/dist/base.css
var base = __webpack_require__(66799);
;// CONCATENATED MODULE: ./src/global.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var global = ({});
;// CONCATENATED MODULE: ./src/App.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var App = ({"gaiFlow":"gaiFlow-App-lWcG_","mainFlow":"mainFlow-App-xI4nq","loading":"loading-App-eo1zu","loadingImg":"loadingImg-App-saSOQ","flowContent":"flowContent-App-kn9KD","hidden":"hidden-App-odNcX"});
;// CONCATENATED MODULE: ./src/assets/image/loading.gif
var loading_namespaceObject = __webpack_require__.p + "assets/loading.f2c0a6b4.gif";
;// CONCATENATED MODULE: ./src/const.ts
var isDev="production"==='development';
// EXTERNAL MODULE: ./node_modules/.pnpm/zustand@4.5.2_@types+react@17.0.80_immer@10.1.1_react@17.0.2/node_modules/zustand/esm/index.mjs
var zustand_esm = __webpack_require__(61513);
// EXTERNAL MODULE: ./node_modules/.pnpm/zustand@4.5.2_@types+react@17.0.80_immer@10.1.1_react@17.0.2/node_modules/zustand/esm/react/shallow.mjs
var shallow = __webpack_require__(26897);
// EXTERNAL MODULE: ./src/components/storeProvider/index.tsx
var storeProvider = __webpack_require__(28700);
;// CONCATENATED MODULE: ./src/hooks/useStoreInContext.ts
function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:String(i);}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function useStoreInContext(selector,opt){var _opt;var store=(0,react.useContext)(storeProvider/* StoreContext */.P);if(!store){throw new Error('Missing StoreProvider');}if(((_opt=opt)===null||_opt===void 0?void 0:_opt.shallow)===undefined){opt=_objectSpread(_objectSpread({},opt),{},{shallow:true});}return (0,zustand_esm/* useStore */.Pj)(store,opt.shallow?(0,shallow/* useShallow */.k)(selector):selector);}/* harmony default export */ var hooks_useStoreInContext = (useStoreInContext);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.array.reduce.js
var es_array_reduce = __webpack_require__(42900);
;// CONCATENATED MODULE: ./src/newComponents/edges/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var edges = ({"edgeLabel":"edgeLabel-index-AufBE"});
;// CONCATENATED MODULE: ./src/newComponents/edges/customEdge.tsx
function customEdge_typeof(o){"@babel/helpers - typeof";return customEdge_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},customEdge_typeof(o);}function customEdge_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function customEdge_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?customEdge_ownKeys(Object(t),!0).forEach(function(r){customEdge_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):customEdge_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function customEdge_defineProperty(obj,key,value){key=customEdge_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function customEdge_toPropertyKey(t){var i=customEdge_toPrimitive(t,"string");return"symbol"==customEdge_typeof(i)?i:String(i);}function customEdge_toPrimitive(t,r){if("object"!=customEdge_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=customEdge_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}// const setMarkerEnd = (str = "url('#1__')", obj: Record<string, string>) => {
//   // 从字符串中提取查询字符串部分并转换为JSON对象
//   const queryString = str.split('__')[1];
//   const params = queryString.slice(0, queryString.length - 2).split('&');
//   const parsedJson: Record<string, string> = {};
//   params.forEach((param) => {
//     const [key, value] = param.split('=');
//     parsedJson[key] = value;
//   });
//   // 合并传入的JSON对象，覆盖已有的字段
//   const mergedJson = { ...parsedJson, ...obj };
//   // 重新构建带有合并参数的查询字符串
//   const updatedQueryString = Object.keys(mergedJson)
//     .map((key) => `${key}=${mergedJson[key]}`)
//     .join('&');
//   // 构建最终的字符串
//   const result = `url('#1__${updatedQueryString}')`;
//   return result;
// };
function CustomEdge(props){var data=props.data,selected=props.selected,sourceX=props.sourceX,sourceY=props.sourceY,targetX=props.targetX,targetY=props.targetY,sourcePosition=props.sourcePosition,targetPosition=props.targetPosition,_props$style=props.style,style=_props$style===void 0?{}:_props$style,markerEnd=props.markerEnd;// const [groupInnerNodePath, setGroupInnerNodePath] = useState<string>('');
var _useState=(0,react.useState)({}),_useState2=_slicedToArray(_useState,2),pathConfig=_useState2[0],setPathConfig=_useState2[1];var _getBezierPath=(0,esm/* getBezierPath */.Fp)(pathConfig),_getBezierPath2=_slicedToArray(_getBezierPath,3),edgePath=_getBezierPath2[0],labelX=_getBezierPath2[1],labelY=_getBezierPath2[2];// console.log('CustomEdge props ===>', props);
// console.log('markerEnd before ===>', markerEnd);
// markerEnd = setMarkerEnd(markerEnd!, selected ? { color: '#5582f3' } : data.hasErr ? { color: 'red' } : {});
// console.log('markerEnd after ===>', markerEnd);
(0,react.useEffect)(function(){// if (sourceHandleId === source + '_innerTop') {
//   setPathConfig({
//     sourceX: targetX,
//     sourceY,
//     targetX,
//     targetY,
//   });
// } else {
// setPathConfig({
//   sourceX,
//   sourceY,
//   targetX,
//   targetY,
// });
var path={sourceX:sourceX,sourceY:sourceY,targetX:targetX,targetY:targetY};if(sourcePosition==='bottom'){path.sourceY=path.sourceY-5;}else if(sourcePosition==='left'){path.sourceX=path.sourceX+5;}else if(sourcePosition==='right'){path.sourceX=path.sourceX-5;}if(targetPosition==='top'){path.targetY=path.targetY+5;}setPathConfig(path);// }
},[targetPosition,sourcePosition,sourceX,sourceY,targetX,targetY]);return/*#__PURE__*/react.createElement(react.Fragment,null,/*#__PURE__*/react.createElement(esm/* BaseEdge */.tE,{path:edgePath,markerEnd:markerEnd,style:customEdge_objectSpread(customEdge_objectSpread({},style),{},{stroke:selected?'#5582f3':data.hasErr?'red':''// markerEnd: {
//   color: selected ? '#5582f3' : data.hasErr ? 'red' : '',
// },
})}),data.edgeName?/*#__PURE__*/react.createElement(esm/* EdgeLabelRenderer */.rV,null,/*#__PURE__*/react.createElement("div",{style:{transform:"translate(-50%, -50%) translate(".concat(labelX,"px,").concat(labelY,"px)"),// 文案 错误优先
color:data.hasErr?'red':selected?'#5582F3':'black',boxShadow:'0px 4px 10px 2px rgba(0,31,122,0.04)',borderRadius:4,background:data.edgeName===''?'transparent':'white',pointerEvents:'all'},className:"".concat(edges.edgeLabel),title:data.hasErr?data.errInfo.reduce(function(a,item){return a+item.msg;},''):undefined// title={data.hasErr ? 'this is error' : undefined}
},data.edgeName)):null);}
;// CONCATENATED MODULE: ./src/newComponents/edges/index.ts
var EDGE_TYPE={customEdge:CustomEdge};
;// CONCATENATED MODULE: ./src/newComponents/edges/connectionLine.tsx
function ConnectioinLine(_ref){var _ref$fromX=_ref.fromX,fromX=_ref$fromX===void 0?0:_ref$fromX,_ref$fromY=_ref.fromY,fromY=_ref$fromY===void 0?0:_ref$fromY,_ref$toX=_ref.toX,toX=_ref$toX===void 0?0:_ref$toX,_ref$toY=_ref.toY,toY=_ref$toY===void 0?0:_ref$toY;// const { connectionHandleId, connectionHandleType } = useStore((s) => {
//   return {
//     connectionHandleId: s.connectionHandleId ? s.connectionHandleId : undefined,
//     connectionHandleType: s.connectionHandleType,
//   }
// })
return/*#__PURE__*/react.createElement("g",null,/*#__PURE__*/react.createElement("path",{style:{stroke:'rgb(85, 130, 243)'},fill:"none",strokeWidth:1.5,className:"animated",d:"M".concat(fromX,",").concat(fromY," C ").concat(fromX," ").concat(toY," ").concat(fromX," ").concat(toY," ").concat(toX,",").concat(toY)}),/*#__PURE__*/react.createElement("circle",{cx:toX,cy:toY,fill:"#fff",r:3,style:{stroke:'rgb(85, 130, 243)'},strokeWidth:1.5}));}/* harmony default export */ var connectionLine = (ConnectioinLine);
;// CONCATENATED MODULE: ./src/newComponents/nodes/customActionNode/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var customActionNode = ({"nodeText":"nodeText-index-O6JxD"});
;// CONCATENATED MODULE: ./src/assets/svg/cusAction.svg
var _title, _g;
var _excluded = ["svgRef", "title"];
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var SvgCusAction = function SvgCusAction(_ref) {
  var svgRef = _ref.svgRef,
    title = _ref.title,
    props = _objectWithoutProperties(_ref, _excluded);
  return /*#__PURE__*/react.createElement("svg", _extends({
    width: "14px",
    height: "15px",
    viewBox: "0 0 14 15",
    ref: svgRef
  }, props), title === undefined ? _title || (_title = /*#__PURE__*/react.createElement("title", null, "\u5F62\u72B6\u7ED3\u5408")) : title ? /*#__PURE__*/react.createElement("title", null, title) : null, _g || (_g = /*#__PURE__*/react.createElement("g", {
    id: "\\u9875\\u9762-1",
    stroke: "none",
    strokeWidth: 1,
    fill: "none",
    fillRule: "evenodd"
  }, /*#__PURE__*/react.createElement("g", {
    id: "1.0-\\u9996\\u9875-\\u5361\\u7247",
    transform: "translate(-513, -739)",
    fill: "#999999",
    fillRule: "nonzero"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u7F16\\u7EC4-3",
    transform: "translate(65, 509)"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u5361\\u7247",
    transform: "translate(318, 24)"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u7F16\\u7EC4-7",
    transform: "translate(24, 204)"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u7F16\\u7EC4-10",
    transform: "translate(105.5, 0)"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u7F16\\u7EC4",
    transform: "translate(0, 2)"
  }, /*#__PURE__*/react.createElement("path", {
    d: "M2.27333333,10.9533333 C3.25270555,10.9533333 4.04666667,11.7472945 4.04666667,12.7266667 C4.04666667,13.7060389 3.25270555,14.5 2.27333333,14.5 C1.29395184,14.5 0.5,13.7060427 0.5,12.7266667 C0.5,11.7472907 1.29395184,10.9533333 2.27333333,10.9533333 Z M2.27333333,11.8866667 C1.80941905,11.8866667 1.43333333,12.262755 1.43333333,12.7266667 C1.43333333,13.1905784 1.80941905,13.5666667 2.27333333,13.5666667 C2.73723978,13.5666667 3.11333333,13.1905731 3.11333333,12.7266667 C3.11333333,12.2627602 2.73723978,11.8866667 2.27333333,11.8866667 Z M12.7266667,5.72666667 C12.9843995,5.72666667 13.1933333,5.93560045 13.1933333,6.19333333 L13.1933333,12.7266667 C13.1933333,12.9843995 12.9843995,13.1933333 12.7266667,13.1933333 L6.19333333,13.1933333 C5.93560045,13.1933333 5.72666667,12.9843995 5.72666667,12.7266667 C5.72666667,12.4689338 5.93560045,12.26 6.19333333,12.26 L12.26,12.26 L12.26,6.19333333 C12.26,5.96423744 12.4250835,5.77369885 12.6427827,5.73418529 L12.7266667,5.72666667 Z M8.80666667,1.80666667 C9.06439955,1.80666667 9.27333333,2.01560045 9.27333333,2.27333333 C9.27333333,2.53106622 9.06439955,2.74 8.80666667,2.74 L2.74,2.74 L2.74,8.80666667 C2.74,9.03576256 2.57491652,9.22630115 2.35721726,9.26581471 L2.27333333,9.27333333 C2.01560045,9.27333333 1.80666667,9.06439955 1.80666667,8.80666667 L1.80666667,2.27333333 C1.80666667,2.01560045 2.01560045,1.80666667 2.27333333,1.80666667 L8.80666667,1.80666667 Z M12.7266667,0.5 C13.7060427,0.5 14.5,1.29395184 14.5,2.27333333 C14.5,3.25270555 13.7060389,4.04666667 12.7266667,4.04666667 C11.7472945,4.04666667 10.9533333,3.25270555 10.9533333,2.27333333 C10.9533333,1.29395184 11.7472907,0.5 12.7266667,0.5 Z M12.7266667,1.43333333 C12.262755,1.43333333 11.8866667,1.80941905 11.8866667,2.27333333 C11.8866667,2.73723978 12.2627602,3.11333333 12.7266667,3.11333333 C13.1905731,3.11333333 13.5666667,2.73723978 13.5666667,2.27333333 C13.5666667,1.80941905 13.1905784,1.43333333 12.7266667,1.43333333 Z",
    id: "\\u5F62\\u72B6\\u7ED3\\u5408"
  }))))))))));
};
var ForwardRef = /*#__PURE__*/react.forwardRef(function (props, ref) {
  return /*#__PURE__*/react.createElement(SvgCusAction, _extends({
    svgRef: ref
  }, props));
});
/* harmony default export */ var cusAction = (ForwardRef);
;// CONCATENATED MODULE: ./src/assets/svg/gptAction.svg
var gptAction_title, gptAction_g;
var gptAction_excluded = ["svgRef", "title"];
function gptAction_extends() { gptAction_extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return gptAction_extends.apply(this, arguments); }
function gptAction_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = gptAction_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function gptAction_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var SvgGptAction = function SvgGptAction(_ref) {
  var svgRef = _ref.svgRef,
    title = _ref.title,
    props = gptAction_objectWithoutProperties(_ref, gptAction_excluded);
  return /*#__PURE__*/react.createElement("svg", gptAction_extends({
    width: "15px",
    height: "15px",
    viewBox: "0 0 15 15",
    ref: svgRef
  }, props), title === undefined ? gptAction_title || (gptAction_title = /*#__PURE__*/react.createElement("title", null, "\u5F62\u72B6\u7ED3\u5408")) : title ? /*#__PURE__*/react.createElement("title", null, title) : null, gptAction_g || (gptAction_g = /*#__PURE__*/react.createElement("g", {
    id: "\\u9875\\u9762-1",
    stroke: "none",
    strokeWidth: 1,
    fill: "none",
    fillRule: "evenodd"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u753B\\u677F",
    transform: "translate(-26, -47)",
    fill: "#666666",
    fillRule: "nonzero"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u7F16\\u7EC4",
    transform: "translate(26.5, 47.5)"
  }, /*#__PURE__*/react.createElement("path", {
    d: "M7.16666667,0 C9.09280649,0 10.899236,0.764056632 12.2342553,2.09906856 C13.5692728,3.4341008 14.3333333,5.2405299 14.3333333,7.16666667 C14.3333333,9.09280586 13.5692708,10.899236 12.2342534,12.2342534 C10.899236,13.5692708 9.09280586,14.3333333 7.16666667,14.3333333 C5.2405299,14.3333333 3.4341008,13.5692728 2.09906563,12.2342524 C0.764056632,10.899236 0,9.09280649 0,7.16666667 C0,5.24052927 0.764054602,3.43410075 2.09906954,2.09906368 C3.43410075,0.764054602 5.24052927,0 7.16666667,0 Z M7.16666667,1 C5.50847046,1 3.95552586,1.65683997 2.80617632,2.80617046 C1.65683997,3.95552586 1,5.50847046 1,7.16666667 C1,8.82486414 1.65684097,10.3778078 2.80617144,11.5271447 C3.95552801,12.6764885 5.50847252,13.3333333 7.16666667,13.3333333 C8.82486208,13.3333333 10.3778057,12.6764875 11.5271466,11.5271466 C12.6764875,10.3778057 13.3333333,8.82486208 13.3333333,7.16666667 C13.3333333,5.50847252 12.6764885,3.95552801 11.5271476,2.80617437 C10.3778078,1.65684097 8.82486414,1 7.16666667,1 Z M7.33333333,5.33333333 C7.60947571,5.33333333 7.83333333,5.55719096 7.83333333,5.83333333 L7.833,9.999 L8.5,10 C8.77614237,10 9,10.2238576 9,10.5 C9,10.7761424 8.77614237,11 8.5,11 L7.3435366,10.999898 C7.34014369,10.9999659 7.3367425,11 7.33333333,11 L7.323,10.999 L6.16666667,11 C5.89052429,11 5.66666667,10.7761424 5.66666667,10.5 C5.66666667,10.2238576 5.89052429,10 6.16666667,10 L6.833,9.999 L6.83266667,6.33333333 L6.66666667,6.33333333 C6.42120678,6.33333333 6.2170583,6.15645817 6.17472234,5.92320897 L6.16666667,5.83333333 C6.16666667,5.55719096 6.39052429,5.33333333 6.66666667,5.33333333 L7.33333333,5.33333333 Z M7.16666667,2.83333333 C7.6269,2.83333333 8,3.20643333 8,3.66666667 C8,4.1269 7.6269,4.5 7.16666667,4.5 C6.70643333,4.5 6.33333333,4.1269 6.33333333,3.66666667 C6.33333333,3.20643333 6.70643333,2.83333333 7.16666667,2.83333333 Z",
    id: "\\u5F62\\u72B6\\u7ED3\\u5408"
  }))))));
};
var gptAction_ForwardRef = /*#__PURE__*/react.forwardRef(function (props, ref) {
  return /*#__PURE__*/react.createElement(SvgGptAction, gptAction_extends({
    svgRef: ref
  }, props));
});
/* harmony default export */ var gptAction = (gptAction_ForwardRef);
;// CONCATENATED MODULE: ./src/assets/svg/info.svg
var info_title, info_g;
var info_excluded = ["svgRef", "title"];
function info_extends() { info_extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return info_extends.apply(this, arguments); }
function info_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = info_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function info_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var SvgInfo = function SvgInfo(_ref) {
  var svgRef = _ref.svgRef,
    title = _ref.title,
    props = info_objectWithoutProperties(_ref, info_excluded);
  return /*#__PURE__*/react.createElement("svg", info_extends({
    width: "15px",
    height: "15px",
    viewBox: "0 0 15 15",
    ref: svgRef
  }, props), title === undefined ? info_title || (info_title = /*#__PURE__*/react.createElement("title", null, "\u5F62\u72B6\u7ED3\u5408")) : title ? /*#__PURE__*/react.createElement("title", null, title) : null, info_g || (info_g = /*#__PURE__*/react.createElement("g", {
    id: "\\u9875\\u9762-1",
    stroke: "none",
    strokeWidth: 1,
    fill: "none",
    fillRule: "evenodd"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u753B\\u677F",
    transform: "translate(-26, -131)",
    fill: "#666666",
    fillRule: "nonzero"
  }, /*#__PURE__*/react.createElement("g", {
    id: "\\u7F16\\u7EC4",
    transform: "translate(26.5, 131.5)"
  }, /*#__PURE__*/react.createElement("path", {
    d: "M7.16668,0 C11.1247224,0 14.3333467,3.20862429 14.3333467,7.16666667 C14.3333467,11.124709 11.1247224,14.3333333 7.16668,14.3333333 L0.5,14.3333333 C0.223857625,14.3333333 0,14.1094757 0,13.8333333 L0,7.16666667 C0,3.20862653 3.20863539,0 7.16668,0 Z M7.16668,1 C3.76091952,1 1,3.76091189 1,7.16666667 L1,13.333 L7.16668,13.3333333 C10.4967541,13.3333333 13.2103212,10.6937679 13.3292797,7.39273862 L13.3333467,7.16666667 C13.3333467,3.76090904 10.5724376,1 7.16668,1 Z M7.16664667,10 C7.44278904,10 7.66664667,10.2238576 7.66664667,10.5 C7.66664667,10.7761424 7.44278904,11 7.16664667,11 L3.83331333,11 C3.55717096,11 3.33331333,10.7761424 3.33331333,10.5 C3.33331333,10.2238576 3.55717096,10 3.83331333,10 L7.16664667,10 Z M9.83331333,7.33333333 C10.1094557,7.33333333 10.3333133,7.55719096 10.3333133,7.83333333 C10.3333133,8.10947571 10.1094557,8.33333333 9.83331333,8.33333333 L3.83331333,8.33333333 C3.55717096,8.33333333 3.33331333,8.10947571 3.33331333,7.83333333 C3.33331333,7.55719096 3.55717096,7.33333333 3.83331333,7.33333333 L9.83331333,7.33333333 Z M9.83331333,4.66666667 C10.1094557,4.66666667 10.3333133,4.89052429 10.3333133,5.16666667 C10.3333133,5.44280904 10.1094557,5.66666667 9.83331333,5.66666667 L3.83331333,5.66666667 C3.55717096,5.66666667 3.33331333,5.44280904 3.33331333,5.16666667 C3.33331333,4.89052429 3.55717096,4.66666667 3.83331333,4.66666667 L9.83331333,4.66666667 Z",
    id: "\\u5F62\\u72B6\\u7ED3\\u5408"
  }))))));
};
var info_ForwardRef = /*#__PURE__*/react.forwardRef(function (props, ref) {
  return /*#__PURE__*/react.createElement(SvgInfo, info_extends({
    svgRef: ref
  }, props));
});
/* harmony default export */ var info = (info_ForwardRef);
;// CONCATENATED MODULE: ./src/assets/svg/shuchu.svg
var _path;
var shuchu_excluded = ["svgRef", "title"];
function shuchu_extends() { shuchu_extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return shuchu_extends.apply(this, arguments); }
function shuchu_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = shuchu_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function shuchu_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var SvgShuchu = function SvgShuchu(_ref) {
  var svgRef = _ref.svgRef,
    title = _ref.title,
    props = shuchu_objectWithoutProperties(_ref, shuchu_excluded);
  return /*#__PURE__*/react.createElement("svg", shuchu_extends({
    className: "icon",
    width: 200,
    height: 200,
    style: {
      verticalAlign: "middle",
      fill: "currentColor",
      overflow: "hidden"
    },
    viewBox: "0 0 1024 1024",
    ref: svgRef
  }, props), title ? /*#__PURE__*/react.createElement("title", null, title) : null, _path || (_path = /*#__PURE__*/react.createElement("path", {
    d: "M652.960525 62.5C706.205638 62.5 750 104.104644 750 156.25L750 280.509949C750 297.768847 736.008897 311.759949 718.75 311.759949C701.491103 311.759949 687.5 297.768847 687.5 280.509949L687.5 156.25C687.5 139.359763 672.384459 125 652.960525 125L159.539474 125C140.115539 125 125 139.359763 125 156.25L125 843.75C125 860.640238 140.115539 875 159.539474 875L652.960525 875C672.384459 875 687.5 860.640238 687.5 843.75L687.5 718.658447C687.5 701.39955 701.491103 687.408447 718.75 687.408447C736.008897 687.408447 750 701.39955 750 718.658447L750 843.75C750 895.895356 706.205638 937.5 652.960525 937.5L159.539474 937.5C106.294362 937.5 62.5 895.895356 62.5 843.75L62.5 156.25C62.5 104.104644 106.294362 62.5 159.539474 62.5L652.960525 62.5zM809.248441 355.562725L927.909044 456.788138C954.169725 479.190253 957.297713 518.639247 934.895597 544.899931C932.754766 547.409503 930.418616 549.745653 927.909044 551.886484L809.248441 653.111897C796.1181 664.312956 776.393603 662.748963 765.192547 649.618622C753.991488 636.488278 755.555481 616.763781 768.685822 605.562725L855.75 531.21875L437.5 531.25C420.241103 531.25 406.25 517.258897 406.25 500C406.25 482.741103 420.241103 468.75 437.5 468.75L845.5625 468.71875L768.685822 403.111897C756.565506 392.772459 754.300541 375.170447 762.833741 362.196256L765.192547 359.056C776.393603 345.925659 796.1181 344.361666 809.248441 355.562725z"
  })));
};
var shuchu_ForwardRef = /*#__PURE__*/react.forwardRef(function (props, ref) {
  return /*#__PURE__*/react.createElement(SvgShuchu, shuchu_extends({
    svgRef: ref
  }, props));
});
/* harmony default export */ var shuchu = (shuchu_ForwardRef);
;// CONCATENATED MODULE: ./src/assets/svg/shuru.svg
var shuru_path;
var shuru_excluded = ["svgRef", "title"];
function shuru_extends() { shuru_extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return shuru_extends.apply(this, arguments); }
function shuru_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = shuru_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function shuru_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var SvgShuru = function SvgShuru(_ref) {
  var svgRef = _ref.svgRef,
    title = _ref.title,
    props = shuru_objectWithoutProperties(_ref, shuru_excluded);
  return /*#__PURE__*/react.createElement("svg", shuru_extends({
    className: "icon",
    width: 200,
    height: 200,
    style: {
      verticalAlign: "middle",
      fill: "currentColor",
      overflow: "hidden"
    },
    viewBox: "0 0 1024 1024",
    ref: svgRef
  }, props), title ? /*#__PURE__*/react.createElement("title", null, title) : null, shuru_path || (shuru_path = /*#__PURE__*/react.createElement("path", {
    d: "M840.460525 62.5C893.705638 62.5 937.5 104.104644 937.5 156.25L937.5 843.75C937.5 895.895356 893.705638 937.5 840.460525 937.5L347.039475 937.5C293.794362 937.5 250 895.895356 250 843.75L250 718.658447C250 701.39955 263.991102 687.408447 281.25 687.408447C298.508898 687.408447 312.5 701.39955 312.5 718.658447L312.5 843.75C312.5 860.640238 327.615541 875 347.039475 875L840.460525 875C859.884459 875 875 860.640238 875 843.75L875 156.25C875 139.359763 859.884459 125 840.460525 125L347.039475 125C327.615541 125 312.5 139.359763 312.5 156.25L312.5 280.509949C312.5 297.768847 298.508898 311.759949 281.25 311.759949C263.991102 311.759949 250 297.768847 250 280.509949L250 156.25C250 104.104644 293.794362 62.5 347.039475 62.5L840.460525 62.5zM465.498441 355.562725L584.159044 456.788138C610.419725 479.190253 613.547713 518.639247 591.145597 544.899931C589.004766 547.409503 586.668616 549.745653 584.159044 551.886484L465.498441 653.111897C452.3681 664.312956 432.643603 662.748963 421.442547 649.618622C410.241488 636.488278 411.805481 616.763781 424.935822 605.562725L512 531.21875L93.75 531.25C76.491102 531.25 62.5 517.258897 62.5 500C62.5 482.741103 76.491102 468.75 93.75 468.75L501.8125 468.71875L424.935822 403.111897C412.815506 392.772459 410.550541 375.170447 419.083741 362.196256L421.442547 359.056C432.643603 345.925659 452.3681 344.361666 465.498441 355.562725z"
  })));
};
var shuru_ForwardRef = /*#__PURE__*/react.forwardRef(function (props, ref) {
  return /*#__PURE__*/react.createElement(SvgShuru, shuru_extends({
    svgRef: ref
  }, props));
});
/* harmony default export */ var shuru = (shuru_ForwardRef);
;// CONCATENATED MODULE: ./src/newComponents/configuration/common/SvgIcon.tsx
function SvgIcon(props){var type=props.type;var renderDom=function renderDom(){switch(type){case'input':return/*#__PURE__*/react.createElement(shuru,null);case'output':return/*#__PURE__*/react.createElement(shuchu,null);case'LLMAction':return/*#__PURE__*/react.createElement(gptAction,null);case'JavaPluginAction':return/*#__PURE__*/react.createElement(cusAction,null);case'MessageAction':return/*#__PURE__*/react.createElement(info,null);default:break;}};return/*#__PURE__*/react.createElement(react.Fragment,null,renderDom());}/* harmony default export */ var common_SvgIcon = (SvgIcon);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.object.assign.js
var es_object_assign = __webpack_require__(71145);
// EXTERNAL MODULE: ./node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/omit.js
var omit = __webpack_require__(53870);
var omit_default = /*#__PURE__*/__webpack_require__.n(omit);
;// CONCATENATED MODULE: ./src/assets/svg/xiala.svg
var xiala_path;
var xiala_excluded = ["svgRef", "title"];
function xiala_extends() { xiala_extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return xiala_extends.apply(this, arguments); }
function xiala_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = xiala_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function xiala_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var SvgXiala = function SvgXiala(_ref) {
  var svgRef = _ref.svgRef,
    title = _ref.title,
    props = xiala_objectWithoutProperties(_ref, xiala_excluded);
  return /*#__PURE__*/react.createElement("svg", xiala_extends({
    className: "icon",
    width: 200,
    height: 200,
    style: {
      verticalAlign: "middle",
      fill: "currentColor",
      overflow: "hidden"
    },
    viewBox: "0 0 1024 1024",
    ref: svgRef
  }, props), title ? /*#__PURE__*/react.createElement("title", null, title) : null, xiala_path || (xiala_path = /*#__PURE__*/react.createElement("path", {
    d: "M540.330667 637.952L303.559111 401.180444a36.181333 36.181333 0 0 0-50.631111 0 35.726222 35.726222 0 0 0-0.056889 50.631112l258.673778 258.730666a35.896889 35.896889 0 0 0 59.164444-13.312l254.179556-254.293333a31.914667 31.914667 0 0 0-0.056889-44.657778 31.971556 31.971556 0 0 0-44.714667-0.113778l-239.786666 239.786667z"
  })));
};
var xiala_ForwardRef = /*#__PURE__*/react.forwardRef(function (props, ref) {
  return /*#__PURE__*/react.createElement(SvgXiala, xiala_extends({
    svgRef: ref
  }, props));
});
/* harmony default export */ var xiala = (xiala_ForwardRef);
;// CONCATENATED MODULE: ./src/newComponents/configuration/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var configuration = ({"sourceHandle":"sourceHandle-index-wcZkx","targetHandle":"targetHandle-index-YB2_f","hidden":"hidden-index-GFVdN","icon":"icon-index-Ytccu","handleHover":"handleHover-index-QCeRt","sourceHandleLeft":"sourceHandleLeft-index-CsI6Q","sourceHandleBottom":"sourceHandleBottom-index-IBvHE","sourceHandleRight":"sourceHandleRight-index-SSCx5","targetHandleTop":"targetHandleTop-index-HVecV","wrapper":"wrapper-index-RrQcF","content":"content-index-MPiqx","name":"name-index-FjD9w","error":"error-index-p9YbB","errorText":"errorText-index-ohwZJ","wrapperImage":"wrapperImage-index-hiVO8","notDraggable":"notDraggable-index-G2GSF"});
;// CONCATENATED MODULE: ./src/newComponents/configuration/handle.tsx
function handle_extends(){handle_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};return handle_extends.apply(this,arguments);}function handle_slicedToArray(arr,i){return handle_arrayWithHoles(arr)||handle_iterableToArrayLimit(arr,i)||handle_unsupportedIterableToArray(arr,i)||handle_nonIterableRest();}function handle_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function handle_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return handle_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return handle_arrayLikeToArray(o,minLen);}function handle_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function handle_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function handle_arrayWithHoles(arr){if(Array.isArray(arr))return arr;}// function selector(s: ReactFlowState) {
//   return {
//     nodeInternals: s.nodeInternals,
//     edges: s.edges,
//   }
// }
function SourceHandle(props){var showHandle=props.showHandle,position=props.position;var _useState=(0,react.useState)(false),_useState2=handle_slicedToArray(_useState,2),hover=_useState2[0],setHover=_useState2[1];return/*#__PURE__*/react.createElement(esm/* Handle */.h7,handle_extends({type:"source",className:"".concat(!showHandle?configuration.hidden:''," ").concat(configuration.sourceHandle," ").concat(hover?configuration.handleHover:''," ").concat(position==='left'?configuration.sourceHandleLeft:position==='bottom'?configuration.sourceHandleBottom:configuration.sourceHandleRight)// onConnect={(params) => console.log('handle onConnect', params)}
,onMouseEnter:function onMouseEnter(){return setHover(true);},onMouseLeave:function onMouseLeave(){return setHover(false);}},omit_default()(props,'showHandle')),/*#__PURE__*/react.createElement(xiala,{className:configuration.icon}));}function TargetHandle(props){var showHandle=props.showHandle,position=props.position;var _useState3=(0,react.useState)(false),_useState4=handle_slicedToArray(_useState3,2),hover=_useState4[0],setHover=_useState4[1];return/*#__PURE__*/react.createElement(esm/* Handle */.h7,handle_extends({type:"target",className:"".concat(!showHandle?configuration.hidden:''," ").concat(configuration.targetHandle," ").concat(hover?configuration.handleHover:''," ").concat(position==='top'?configuration.targetHandleTop:''),onMouseEnter:function onMouseEnter(){return setHover(true);},onMouseLeave:function onMouseLeave(){return setHover(false);}},omit_default()(props,'showHandle')),/*#__PURE__*/react.createElement(xiala,{className:configuration.icon}));}
;// CONCATENATED MODULE: ./src/newComponents/configuration/wrapper.tsx
function wrapper_typeof(o){"@babel/helpers - typeof";return wrapper_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},wrapper_typeof(o);}function wrapper_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function wrapper_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?wrapper_ownKeys(Object(t),!0).forEach(function(r){wrapper_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):wrapper_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function wrapper_defineProperty(obj,key,value){key=wrapper_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function wrapper_toPropertyKey(t){var i=wrapper_toPrimitive(t,"string");return"symbol"==wrapper_typeof(i)?i:String(i);}function wrapper_toPrimitive(t,r){if("object"!=wrapper_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=wrapper_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function wrapper_slicedToArray(arr,i){return wrapper_arrayWithHoles(arr)||wrapper_iterableToArrayLimit(arr,i)||wrapper_unsupportedIterableToArray(arr,i)||wrapper_nonIterableRest();}function wrapper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function wrapper_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return wrapper_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wrapper_arrayLikeToArray(o,minLen);}function wrapper_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function wrapper_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function wrapper_arrayWithHoles(arr){if(Array.isArray(arr))return arr;}// TODO：node为input 或 output 时会被react-flow按默认类型添加边框 修改typeName
// ps: https://reactflow.dev/api-reference/types/node#default-node-types
function CustomNodeWrapper(_ref){var children=_ref.children,nodeData=_ref.nodeData,selected=_ref.selected;// const id = useNodeId();
var _useState=(0,react.useState)(nodeData.nodeType),_useState2=wrapper_slicedToArray(_useState,2),nodeType=_useState2[0],setNodeType=_useState2[1];var _useState3=(0,react.useState)(false),_useState4=wrapper_slicedToArray(_useState3,2),showErr=_useState4[0],setShowErr=_useState4[1];var _useState5=(0,react.useState)(false),_useState6=wrapper_slicedToArray(_useState5,2),showHandle=_useState6[0],setShowHandle=_useState6[1];var generateHandles=function generateHandles(){// if (!showHandle) return null;
if(nodeType==='input'){return/*#__PURE__*/react.createElement(react.Fragment,null,/*#__PURE__*/react.createElement(SourceHandle,{id:"bottom",showHandle:showHandle,position:esm/* Position */.yX.Bottom}));}if(nodeType==='output'){return/*#__PURE__*/react.createElement(react.Fragment,null,/*#__PURE__*/react.createElement(TargetHandle,{id:"top",showHandle:showHandle,position:esm/* Position */.yX.Top}));}return/*#__PURE__*/react.createElement(react.Fragment,null,/*#__PURE__*/react.createElement(TargetHandle,{id:"top",showHandle:showHandle,position:esm/* Position */.yX.Top}),/*#__PURE__*/react.createElement(SourceHandle,{id:"bottom",showHandle:showHandle,position:esm/* Position */.yX.Bottom}),/*#__PURE__*/react.createElement(SourceHandle,{id:"left",showHandle:showHandle,position:esm/* Position */.yX.Left}),/*#__PURE__*/react.createElement(SourceHandle,{id:"right",showHandle:showHandle,position:esm/* Position */.yX.Right}));};(0,react.useEffect)(function(){if(!nodeData.hasErr){setShowErr(false);}setNodeType(nodeData.nodeType);},[nodeData]);return/*#__PURE__*/react.createElement("div",{className:"".concat(configuration.wrapper),style:wrapper_objectSpread(wrapper_objectSpread({},nodeData===null||nodeData===void 0?void 0:nodeData.nodeStyle),{},{height:nodeData===null||nodeData===void 0?void 0:nodeData.height,width:nodeData===null||nodeData===void 0?void 0:nodeData.width,border:selected?'2px solid #5582f3':nodeData.hasErr?'2px solid red':undefined}),onMouseEnter:function onMouseEnter(){return setShowHandle(true);},onMouseLeave:function onMouseLeave(){return setShowHandle(false);}},/*#__PURE__*/react.createElement("div",{className:configuration.content},/*#__PURE__*/react.createElement(common_SvgIcon,{type:nodeData.nodeType}),/*#__PURE__*/react.createElement("span",{className:configuration.name,title:nodeData.nodeName},children)),generateHandles(),nodeData.hasErr?/*#__PURE__*/react.createElement("span",{className:"".concat(configuration.error),onMouseEnter:function onMouseEnter(){return setShowErr(true);},onMouseLeave:function onMouseLeave(){return setShowErr(false);}// title={nodeData.errInfo.reduce(
//   (a, item) => a + item.msg,
//   '',
// )}
},"!",/*#__PURE__*/react.createElement("div",{style:{display:showErr?'block':'none',boxShadow:"0px 4px 10px 0px rgba(0,0,0,0.2)"},className:"".concat(configuration.errorText)},nodeData.errInfo.reduce(function(a,item){return a+item.msg;},''))):null);}/* harmony default export */ var wrapper = (/*#__PURE__*/(0,react.memo)(CustomNodeWrapper));
;// CONCATENATED MODULE: ./src/newComponents/nodes/customActionNode/index.tsx
function JavaPluginActionNodeRender(_ref){var data=_ref.data,selected=_ref.selected;return/*#__PURE__*/react.createElement(wrapper,{nodeData:data,selected:selected},/*#__PURE__*/react.createElement("span",{className:"".concat(customActionNode.nodeText)},data.nodeName));}var JavaPluginActionNode=/*#__PURE__*/(0,react.memo)(JavaPluginActionNodeRender);/* harmony default export */ var nodes_customActionNode = (JavaPluginActionNode);
;// CONCATENATED MODULE: ./src/newComponents/nodes/inputNode/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var inputNode = ({"nodeText":"nodeText-index-oxw13"});
;// CONCATENATED MODULE: ./src/newComponents/nodes/inputNode/index.tsx
function InputNodeRender(_ref){var data=_ref.data,selected=_ref.selected;return/*#__PURE__*/react.createElement(wrapper,{nodeData:data,selected:selected},/*#__PURE__*/react.createElement("span",{className:"".concat(inputNode.nodeText)},data.nodeName));}var InputNode=/*#__PURE__*/(0,react.memo)(InputNodeRender);/* harmony default export */ var nodes_inputNode = (InputNode);
;// CONCATENATED MODULE: ./src/newComponents/nodes/llmNode/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var llmNode = ({"nodeText":"nodeText-index-CytMY"});
;// CONCATENATED MODULE: ./src/newComponents/nodes/llmNode/index.tsx
function LLMNodeRender(_ref){var data=_ref.data,selected=_ref.selected;(0,react.useEffect)(function(){console.log('dataChanged');},[data]);return/*#__PURE__*/react.createElement(wrapper,{nodeData:data,selected:selected},/*#__PURE__*/react.createElement("span",{className:"".concat(llmNode.nodeText)},data.nodeName));}var LLMNode=/*#__PURE__*/(0,react.memo)(LLMNodeRender);/* harmony default export */ var nodes_llmNode = (LLMNode);
;// CONCATENATED MODULE: ./src/newComponents/nodes/messageNode/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var messageNode = ({"nodeText":"nodeText-index-puqAy"});
;// CONCATENATED MODULE: ./src/newComponents/nodes/messageNode/index.tsx
function MessageNodeRender(_ref){var data=_ref.data,selected=_ref.selected;return/*#__PURE__*/react.createElement(wrapper,{nodeData:data,selected:selected},/*#__PURE__*/react.createElement("span",{className:"".concat(messageNode.nodeText)},data.nodeName));}var MessageNode=/*#__PURE__*/(0,react.memo)(MessageNodeRender);/* harmony default export */ var nodes_messageNode = (MessageNode);
;// CONCATENATED MODULE: ./src/newComponents/nodes/outputNode/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var outputNode = ({"nodeText":"nodeText-index-TU5PG"});
;// CONCATENATED MODULE: ./src/newComponents/nodes/outputNode/index.tsx
function OutputNodeRender(_ref){var data=_ref.data,selected=_ref.selected;return/*#__PURE__*/react.createElement(wrapper,{nodeData:data,selected:selected},/*#__PURE__*/react.createElement("span",{className:"".concat(outputNode.nodeText)},data.nodeName));}var OutputNode=/*#__PURE__*/(0,react.memo)(OutputNodeRender);/* harmony default export */ var nodes_outputNode = (OutputNode);
;// CONCATENATED MODULE: ./src/newComponents/nodes/index.ts
var NODE_TYPE={LLMAction:nodes_llmNode,JavaPluginAction:nodes_customActionNode,MessageAction:nodes_messageNode,input:nodes_inputNode,output:nodes_outputNode};var ACTION_NODE=['LLMAction','JavaPluginAction','MessageAction'];
;// CONCATENATED MODULE: ./src/newComponents/panel/index.less
// extracted by mini-css-extract-plugin
/* harmony default export */ var panel = ({"panel":"panel-index-fJfiR","title":"title-index-SygAV","text":"text-index-gtiOt","panelContent":"panelContent-index-mxfvl"});
;// CONCATENATED MODULE: ./src/utils/basic.ts
function basic_typeof(o){"@babel/helpers - typeof";return basic_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},basic_typeof(o);}function basic_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function basic_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?basic_ownKeys(Object(t),!0).forEach(function(r){basic_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):basic_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function basic_defineProperty(obj,key,value){key=basic_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function basic_toPropertyKey(t){var i=basic_toPrimitive(t,"string");return"symbol"==basic_typeof(i)?i:String(i);}function basic_toPrimitive(t,r){if("object"!=basic_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=basic_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}var NODES=[// { value: 'input', name: '输入', caption: '执行起点，用户触发任务后首先执行该节点' },
// { value: 'output', name: '输出', caption: '执行终点，触发后停止执行该任务' },
{value:'LLMAction',name:'提示词',caption:'调用已保存的提示词，大模型将根据提示词生成内容'},{value:'JavaPluginAction',name:'自定义操作',caption:'支持业务应用实现的自定义操作，如后端业务逻辑执行或前端界面更新'},{value:'MessageAction',name:'消息',caption:'回复指定内容，用于引导、提示用户'}];var RULE_ERROR_CODE={SAME_NAME:{code:0,msg:'节点名称不可重复。'},// 重名
RING:{code:1,msg:'节点不可形成环路。'},// 环结构
NOT_LINK_OUTPUT:{code:2,msg:'节点连线不完整。'},// 终点未连接到output节点
DISCRETE:{code:3,msg:'不允许存在离散节点。'},// 存在离散节点
UNCLOSE:{code:4,msg:'节点连线不完整'},// 存在未双端闭合节点(包含2)
OTHER:{code:5,msg:'other error'}};var TYPEIDS={LLMAction:'2',JavaPluginAction:'4',MessageAction:'5',Condition:'6',output:'1',input:'0'};var BASIC_NODE_CONFIG_SIZE={width:200,height:50};var BASIC_NODE_CONFIG=basic_objectSpread(basic_objectSpread({},BASIC_NODE_CONFIG_SIZE),{},{zIndex:-100});var BASIC_LAYOUT_CONFIG={AXIS:{x:0,y:0},groupOffset:25,HorizontalSpacing:250,VerticalSpacing:100};
;// CONCATENATED MODULE: ./src/newComponents/configuration/wrapperImage.tsx
function WrapperImage(_ref){var node=_ref.node,handleDragStart=_ref.handleDragStart;// const currentNode = NODES[nodeKey as keyof typeof NODES]
// const { connectionHandleId, connectionHandleType } = useStore((s) => {
//   return {
//     connectionHandleId: s.connectionHandleId ? s.connectionHandleId : undefined,
//     connectionHandleType: s.connectionHandleType,
//   }
// })
var isLock=hooks_useStoreInContext(function(state){return state.isLock;});var _useContext=(0,react.useContext)(CusContext),hasInputNode=_useContext.hasInputNode,hasOutputNode=_useContext.hasOutputNode,handleAddNode=_useContext.handleAddNode;var draggable=function draggable(){if(isLock)return false;if(node.value==='input'){return!hasInputNode;}if(node.value==='output'){return!hasOutputNode;}return true;};var isDraggable=draggable();var handleClickItem=function handleClickItem(){if(isDraggable){handleAddNode(node.value);}};return/*#__PURE__*/react.createElement("div",{draggable:isDraggable,onDragStart:function onDragStart(event){return handleDragStart(event,node);},className:"".concat(!isDraggable?configuration.notDraggable:''," ").concat(configuration.wrapperImage),title:node.caption,onClick:function onClick(){return handleClickItem();}},/*#__PURE__*/react.createElement("span",{className:configuration.content},/*#__PURE__*/react.createElement(common_SvgIcon,{type:node.value}),/*#__PURE__*/react.createElement("span",{className:configuration.name,title:node.name},node.name)));}/* harmony default export */ var wrapperImage = (/*#__PURE__*/react.memo(WrapperImage));
;// CONCATENATED MODULE: ./src/newComponents/panel/panel.tsx
// import { Node, Panel } from 'reactflow';
// import { NODE_TYPE, NODE_TYPE_KEY } from '../nodes';
// import { IDControler, generateNodes } from '../../utils/generate';
// import { CustomNode } from '../nodes/type';
// interface PanelProps {
//   nodes: CustomNode[]
//   setNodes: (nodes: CustomNode[]) => void
//   // handleDragStart: React.Dispatch<React.SetStateAction<keyof typeof NODE_TYPE | null>>;
// }
function CustomPanel(){// const panelClick = (key: keyof typeof NODE_TYPE) => {
//   if (key === 'input' && nodes.some(node => node.type === 'input')) {
//     return
//   }
//   if (key === 'output' && nodes.some(node => node.type === 'output')) {
//     return
//   }
//   const id = String(IDControler.getId())
//   const newNode = generateNodes[key](id)
//   setNodes(nodes.concat(newNode))
// }
var isLock=hooks_useStoreInContext(function(state){return state.isLock;});var onDragStart=(0,react.useCallback)(function(event,node){if(isLock)return;event.dataTransfer.setData('application/reactflow',node.value);event.dataTransfer.effectAllowed='move';},[isLock]);return/*#__PURE__*/react.createElement("div",{className:"".concat(panel.panel)},/*#__PURE__*/react.createElement("div",{className:"".concat(panel.title)},/*#__PURE__*/react.createElement("span",{className:"".concat(panel.text)},"\u8282\u70B9")),/*#__PURE__*/react.createElement("div",{className:panel.panelContent},NODES.map(function(node,i){return/*#__PURE__*/react.createElement(wrapperImage,{handleDragStart:onDragStart,node:node,key:i});})))//   <Panel
//     position='top-left'
//     className=' w-[280px] h-full bg-white m-0 p-[8px] flex flex-col items-center'
//     // onDragEnd={(e: DragEvent<HTMLDivElement>) => {
//   // }}
// >
//   {NODES.map((node) => {
//     return <WrapperImage handleDragStart={onDragStart} node={node} />;
//   })}
// </Panel>
;}
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.map.js
var es_map = __webpack_require__(60965);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.delete-all.js
var esnext_map_delete_all = __webpack_require__(21969);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.every.js
var esnext_map_every = __webpack_require__(24941);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.filter.js
var esnext_map_filter = __webpack_require__(89514);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.find.js
var esnext_map_find = __webpack_require__(33995);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.find-key.js
var esnext_map_find_key = __webpack_require__(31861);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.includes.js
var esnext_map_includes = __webpack_require__(63469);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.key-of.js
var esnext_map_key_of = __webpack_require__(28163);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.map-keys.js
var esnext_map_map_keys = __webpack_require__(47469);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.map-values.js
var esnext_map_map_values = __webpack_require__(66875);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.merge.js
var esnext_map_merge = __webpack_require__(40486);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.reduce.js
var esnext_map_reduce = __webpack_require__(3458);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.some.js
var esnext_map_some = __webpack_require__(19928);
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/esnext.map.update.js
var esnext_map_update = __webpack_require__(36161);
;// CONCATENATED MODULE: ./src/utils/check.ts
// import type { CustomEdgeType } from '../newComponents/edges/customEdge'
// import type { CustomNode } from '../newComponents/nodes/types'
function checkAll(nodes,edges){var sameNameStatus=checkSameName(nodes);if(sameNameStatus.hasErr){return sameNameStatus;}var treeStatus=checkRing(nodes,edges);if(treeStatus.hasErr){return treeStatus;}return{hasErr:false,errIdList:[]};}function checkSameName(nodes){var nameMap=new Map();var errIdMap=new Map();for(var i=0;i<nodes.length;i++){var name=nodes[i].data.nodeName;var status=nameMap.has(name);if(status){errIdMap.set(nodes[i].id,'node');errIdMap.set(nameMap.get(nodes[i].data.nodeName),'node');}nameMap.set(name,nodes[i].id);}// for (let j = 0; j < edges.length; j++) {
//   const name
//     = edges[j].data!.edgeName && edges[j].data!.edgeName !== ''
//       ? edges[j].data!.edgeName
//       : null
//   if (!name) {
//     continue
//   }
//   const status = nameMap.has(name)
//   if (status) {
//     errIdMap.set(edges[j].id, 'edge')
//     errIdMap.set(nameMap.get(edges[j].data!.edgeName), 'edge')
//   }
//   nameMap.set(name, edges[j].id)
// }
var arrFromErrIdMap=Array.from(errIdMap);console.log(arrFromErrIdMap);var errIdList=arrFromErrIdMap.map(function(value){return{id:value[0],type:value[1],errInfo:RULE_ERROR_CODE.SAME_NAME};});return{hasErr:errIdList.length>0,errIdList:errIdList};}// export const checkEdge = (edges: CustomEdge[]) => {};
function checkRing(nodes,edges){var hasRingStatus=false;var errIdList=[];var isNotLinkOutput=false;var isDiscreteNode=false;var isUnclosed=false;function dfs(node,arr){var index=arr.findIndex(function(id){return id===node.id;});if(index!==-1){hasRingStatus=true;errIdList=errIdList.concat(arr.slice(index,arr.length).map(function(id){return{errInfo:RULE_ERROR_CODE.RING,type:'node',id:id};}));return;}if(!hasRingStatus&&!isNotLinkOutput){var newArr=arr.concat(node.id);var linkEdges=edges.filter(function(edge){return edge.source===node.id;});var targetNode=linkEdges.map(function(edge){return nodes.find(function(node){return node.id===edge.target;});});if(targetNode.length===0&&node.data.nodeType!=='output'){isNotLinkOutput=true;errIdList=errIdList.concat({errInfo:RULE_ERROR_CODE.NOT_LINK_OUTPUT,type:'node',id:node.id});return;}targetNode.forEach(function(node){dfs(node,newArr);});}}var startNode=nodes.find(function(node){return node.data.nodeType==='input';});var idArr=[];var _loop=function _loop(i){if(nodes[i].data.nodeType==='input'){if(!edges.find(function(edge){return edge.source===nodes[i].id;})){isDiscreteNode=true;errIdList.push({errInfo:RULE_ERROR_CODE.DISCRETE,type:'node',id:nodes[i].id});return 0;// continue
}}else if(nodes[i].data.nodeType==='output'){if(!edges.find(function(edge){return edge.target===nodes[i].id;})){isDiscreteNode=true;errIdList.push({errInfo:RULE_ERROR_CODE.DISCRETE,type:'node',id:nodes[i].id});return 0;// continue
}}else{if(!edges.find(function(edge){return edge.source===nodes[i].id;})&&!edges.find(function(edge){return edge.target===nodes[i].id;})){isDiscreteNode=true;errIdList.push({errInfo:RULE_ERROR_CODE.DISCRETE,type:'node',id:nodes[i].id});return 0;// continue
}if(!edges.find(function(edge){return edge.source===nodes[i].id;})||!edges.find(function(edge){return edge.target===nodes[i].id;})){isUnclosed=true;errIdList.push({errInfo:RULE_ERROR_CODE.UNCLOSE,type:'node',id:nodes[i].id});return 0;// continue
}}},_ret;for(var i=0;i<nodes.length;i++){_ret=_loop(i);if(_ret===0)continue;}dfs(startNode,idArr);var hasErr=hasRingStatus||isNotLinkOutput||isDiscreteNode||isUnclosed;return{hasErr:hasErr,errIdList:errIdList};}
;// CONCATENATED MODULE: ./src/utils/edge.ts
function edge_typeof(o){"@babel/helpers - typeof";return edge_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},edge_typeof(o);}function edge_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function edge_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?edge_ownKeys(Object(t),!0).forEach(function(r){edge_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):edge_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function edge_defineProperty(obj,key,value){key=edge_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function edge_toPropertyKey(t){var i=edge_toPrimitive(t,"string");return"symbol"==edge_typeof(i)?i:String(i);}function edge_toPrimitive(t,r){if("object"!=edge_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=edge_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function getEdgeColor(hasErr,selected){return selected?'#5582f3':hasErr?'red':'#b2b2b8';}function getMarkerEndStyle(markerEnd,hasErr,selected){markerEnd=markerEnd?edge_objectSpread({},markerEnd):{};return edge_objectSpread(edge_objectSpread({},markerEnd),{},{color:getEdgeColor(hasErr,selected)});}function getEdgeStyle(style,hasErr,selected){style=style?edge_objectSpread({},style):{};return edge_objectSpread(edge_objectSpread({},style),{},{stroke:getEdgeColor(hasErr,selected)});}function getEdgeAndMarkerEndStyle(markerEnd,style,hasErr,selected){return{markerEnd:getMarkerEndStyle(markerEnd,hasErr,selected),style:getEdgeStyle(style,hasErr,selected)};}function sortEdges(a,b){if(a.selected===b.selected){return Number(a.data.hasErr===true)-Number(b.data.hasErr===true);}else{return Number(a.selected===true)-Number(b.selected===true);}}
;// CONCATENATED MODULE: ./src/newComponents/edges/config.ts
function generateCustomEdge(id,name,source,target,sourceHandle,targetHandle){return{id:id,source:source,target:target,sourceHandle:sourceHandle||undefined,targetHandle:targetHandle||undefined,// animated: true,
markerEnd:{type:esm/* MarkerType */.TG.ArrowClosed,width:20,height:20// color: 'red',
},type:'customEdge',label:name||'',data:{edgeName:name||'',edgeType:'Condition',hasErr:false,errInfo:[]}};}
;// CONCATENATED MODULE: ./src/newComponents/nodes/customActionNode/config.ts
function config_typeof(o){"@babel/helpers - typeof";return config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},config_typeof(o);}function config_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function config_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?config_ownKeys(Object(t),!0).forEach(function(r){config_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):config_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function config_defineProperty(obj,key,value){key=config_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function config_toPropertyKey(t){var i=config_toPrimitive(t,"string");return"symbol"==config_typeof(i)?i:String(i);}function config_toPrimitive(t,r){if("object"!=config_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=config_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function generateJavaPluginActionNodeConfig(id){return config_objectSpread(config_objectSpread({},BASIC_NODE_CONFIG),{},{id:id,type:'JavaPluginAction',data:config_objectSpread(config_objectSpread({},BASIC_NODE_CONFIG_SIZE),{},{nodeName:'自定义操作',nodeType:'JavaPluginAction',nodeData:{},nodeStyle:{},nodeId:'',hasErr:false,errInfo:[]}),position:{x:0,y:0}});}
;// CONCATENATED MODULE: ./src/newComponents/nodes/inputNode/config.ts
function inputNode_config_typeof(o){"@babel/helpers - typeof";return inputNode_config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},inputNode_config_typeof(o);}function inputNode_config_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function inputNode_config_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?inputNode_config_ownKeys(Object(t),!0).forEach(function(r){inputNode_config_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):inputNode_config_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function inputNode_config_defineProperty(obj,key,value){key=inputNode_config_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function inputNode_config_toPropertyKey(t){var i=inputNode_config_toPrimitive(t,"string");return"symbol"==inputNode_config_typeof(i)?i:String(i);}function inputNode_config_toPrimitive(t,r){if("object"!=inputNode_config_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=inputNode_config_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function generateInputNodeConfig(){return inputNode_config_objectSpread(inputNode_config_objectSpread({},BASIC_NODE_CONFIG),{},{id:'0',type:'input',data:inputNode_config_objectSpread(inputNode_config_objectSpread({},BASIC_NODE_CONFIG_SIZE),{},{nodeName:'输入节点',nodeType:'input',nodeData:{},nodeStyle:{},nodeId:'',hasErr:false,errInfo:[]}),deletable:false,position:{x:0,y:0}});}
;// CONCATENATED MODULE: ./src/newComponents/nodes/llmNode/config.ts
function llmNode_config_typeof(o){"@babel/helpers - typeof";return llmNode_config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},llmNode_config_typeof(o);}function llmNode_config_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function llmNode_config_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?llmNode_config_ownKeys(Object(t),!0).forEach(function(r){llmNode_config_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):llmNode_config_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function llmNode_config_defineProperty(obj,key,value){key=llmNode_config_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function llmNode_config_toPropertyKey(t){var i=llmNode_config_toPrimitive(t,"string");return"symbol"==llmNode_config_typeof(i)?i:String(i);}function llmNode_config_toPrimitive(t,r){if("object"!=llmNode_config_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=llmNode_config_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function generateLLMNodeConfig(id){return llmNode_config_objectSpread(llmNode_config_objectSpread({},BASIC_NODE_CONFIG),{},{id:id,type:'LLMAction',data:llmNode_config_objectSpread(llmNode_config_objectSpread({},BASIC_NODE_CONFIG_SIZE),{},{nodeName:'提示词',nodeType:'LLMAction',nodeData:{},nodeStyle:{},nodeId:'',hasErr:false,errInfo:[]}),position:{x:0,y:0}});}
;// CONCATENATED MODULE: ./src/newComponents/nodes/messageNode/config.ts
function messageNode_config_typeof(o){"@babel/helpers - typeof";return messageNode_config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},messageNode_config_typeof(o);}function messageNode_config_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function messageNode_config_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?messageNode_config_ownKeys(Object(t),!0).forEach(function(r){messageNode_config_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):messageNode_config_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function messageNode_config_defineProperty(obj,key,value){key=messageNode_config_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function messageNode_config_toPropertyKey(t){var i=messageNode_config_toPrimitive(t,"string");return"symbol"==messageNode_config_typeof(i)?i:String(i);}function messageNode_config_toPrimitive(t,r){if("object"!=messageNode_config_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=messageNode_config_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function generateMessageActionNodeConfig(id){return messageNode_config_objectSpread(messageNode_config_objectSpread({},BASIC_NODE_CONFIG),{},{id:id,type:'MessageAction',data:messageNode_config_objectSpread(messageNode_config_objectSpread({},BASIC_NODE_CONFIG_SIZE),{},{nodeName:'消息节点',nodeType:'MessageAction',nodeData:{},nodeStyle:{},nodeId:'',hasErr:false,errInfo:[]}),position:{x:0,y:0}});}
;// CONCATENATED MODULE: ./src/newComponents/nodes/outputNode/config.ts
function outputNode_config_typeof(o){"@babel/helpers - typeof";return outputNode_config_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},outputNode_config_typeof(o);}function outputNode_config_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function outputNode_config_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?outputNode_config_ownKeys(Object(t),!0).forEach(function(r){outputNode_config_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):outputNode_config_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function outputNode_config_defineProperty(obj,key,value){key=outputNode_config_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function outputNode_config_toPropertyKey(t){var i=outputNode_config_toPrimitive(t,"string");return"symbol"==outputNode_config_typeof(i)?i:String(i);}function outputNode_config_toPrimitive(t,r){if("object"!=outputNode_config_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=outputNode_config_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function generateOutputNodeConfig(){return outputNode_config_objectSpread(outputNode_config_objectSpread({},BASIC_NODE_CONFIG),{},{id:'1',type:'output',data:outputNode_config_objectSpread(outputNode_config_objectSpread({},BASIC_NODE_CONFIG_SIZE),{},{nodeName:'输出节点',nodeType:'output',nodeData:{},nodeStyle:{},nodeId:'',hasErr:false,errInfo:[]}),deletable:false,position:{x:0,y:0}});}
;// CONCATENATED MODULE: ./src/utils/generate.ts
function generateId(){var id=0;return{getNow:function getNow(){return id;},getId:function getId(){id+=1;return id;},setId:function setId(max){id=max;}};}var IDControler=generateId();var generateNodes={input:generateInputNodeConfig,output:generateOutputNodeConfig,LLMAction:generateLLMNodeConfig,JavaPluginAction:generateJavaPluginActionNodeConfig,MessageAction:generateMessageActionNodeConfig};function generateInitialNodesAndEdges(){var input=generateNodes.input();var output=generateNodes.output();output.position={x:0,y:200};return{nodes:[input,output],edges:[generateEdge(String(IDControler.getId()),'',input.id,output.id,'bottom','top')]};}function generateEdge(id,edgeName,source,target,sourceHandle,targetHandle){var edge=generateCustomEdge(id,edgeName,source,target,sourceHandle,targetHandle);return edge;}function getNodePosition(nodes){var sourcePosition=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{x:0,y:0};var space=arguments.length>2?arguments[2]:undefined;var position={x:(sourcePosition.x||0)+(space.x||0),y:(sourcePosition.y||0)+(space.y||0)};var currentNode=nodes.find(function(n){return n.position.x===position.x&&n.position.y===position.y;});if(currentNode){return getNodePosition(nodes,position,space);}return position;}
;// CONCATENATED MODULE: ./src/utils/invokeAction.ts
function invokeAction(model,type,data){// console.log('invokeAction ====>', model, type, data);
switch(type){case'editNode':case'saveFlow':case'newNode':case'delNode':case'editFlow':case'init':model.invokeAsync(type,data);}}
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.number.is-nan.js
var es_number_is_nan = __webpack_require__(34258);
;// CONCATENATED MODULE: ./src/utils/judge.ts
function isNull(data){return data===null;}function isUndefined(data){return typeof data==='undefined';}function judge_isNaN(data){return Number.isNaN(data);}function isValidData(data){return!(isNull(data)||isUndefined(data)||judge_isNaN(data));}
// EXTERNAL MODULE: ./node_modules/.pnpm/core-js@3.37.1/node_modules/core-js/modules/es.number.parse-int.js
var es_number_parse_int = __webpack_require__(61647);
;// CONCATENATED MODULE: ./src/utils/transform.ts
function transform_typeof(o){"@babel/helpers - typeof";return transform_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},transform_typeof(o);}function transform_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function transform_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?transform_ownKeys(Object(t),!0).forEach(function(r){transform_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):transform_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function transform_defineProperty(obj,key,value){key=transform_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function transform_toPropertyKey(t){var i=transform_toPrimitive(t,"string");return"symbol"==transform_typeof(i)?i:String(i);}function transform_toPrimitive(t,r){if("object"!=transform_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=transform_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}var rawType={messageAction:'5',JavaPluginAction:'4',LLMAction:'2',inputNode:'input',outputNode:'output',5:'kd.ai.gai.core.engine.flow.MessageAction',4:'kd.ai.gai.core.engine.flow.JavaPluginAction',2:'kd.ai.gai.core.engine.flow.LLMAction'};var SAVE_TYPE_MAP={input:'0',output:'1',LLMAction:'2',JavaPluginAction:'4',MessageAction:'5',Condition:'6'};function transformRawDataToFlowData(rawData,isLock){var nodes=[];var edges=[];var input=rawData.start;var output=rawData.end;var positionY=0;var inputNode=generateNodes.input();inputNode.data.nodeName=input.name;function setPosition(node,position){if(position){node.position=position;}else{node.position=transform_objectSpread(transform_objectSpread({},inputNode.position),{},{y:positionY});positionY=positionY+150;}}// inputNode
setPosition(inputNode,input.position);nodes.push(inputNode);rawData.actions.forEach(function(action){var param=action.type.split('.');var properties=action.properties;var type=param[param.length-1];var actionNode=generateNodes[type](String(properties.id));actionNode.data.nodeName=properties.name;setPosition(actionNode,properties.position);if(isLock){actionNode.deletable=false;}nodes.push(actionNode);});rawData.transfers.forEach(function(transfer){var actionEdge=generateEdge(String(transfer.id),transfer.condition?transfer.condition.name:'',String(transfer.fromNodeId),String(transfer.toNodeId),'bottom','top');IDControler.setId(Math.max(IDControler.getNow(),transfer.id));if(isLock){actionEdge.deletable=false;}edges.push(actionEdge);});var outputNode=generateNodes.output();outputNode.data.nodeName=output.name;setPosition(outputNode,output.position);nodes.push(outputNode);return{nodes:nodes,edges:edges};}function transformNodeWhenNewNode(node,_nodes,edges){var nodeRawdata=createRawNodeData(node.id,node.data.nodeType,node.data.nodeName);nodeRawdata.position=node.position;nodeRawdata.transferInList=edges.filter(function(edge){return edge.target===node.id;}).map(function(edge){return Number(edge.id);});nodeRawdata.transferOutList=edges.filter(function(edge){return edge.source===node.id;}).map(function(edge){return Number(edge.id);});return nodeRawdata;}function transformEdgeWhenNewNode(edge,_nodes,_edges){var edgeRawData=createTransfer(edge.id,edge.source,edge.target);if(edge.data&&edge.data.edgeName&&edge.data.edgeName.length>0){edgeRawData.condition={name:edge.data.edgeName};}return edgeRawData;}function transformFlowDataToRawData(nodes,edges){// TODO: 由内向外转化时可能被删除。不应该默认input output 存在。校验逻辑应该增加输入输出节点是否存在的校验。
// NOTE: 禁止输入输出被删除，所以默认 input output 存在
// 或对newNode或editNode等操作行为添加新的flowdatatoRawData方法，保证此函数在调用前进行check,调用时input，output节点必定存在
var start=null;var end=null;var actions=[];var transfers=[];var input=nodes.find(function(node){return node.type==='input';});var output=nodes.find(function(node){return node.type==='output';});var inputRawNode=createRawNodeData(input.id,input.data.nodeType,input.data.nodeName);var nextEdges=edges.filter(function(edge){return edge.source===input.id;});inputRawNode.transferOutList=nextEdges.map(function(edge){return Number(edge.id);});inputRawNode.position=input.position;start=inputRawNode;function transformEdge(outEdges){outEdges.forEach(function(edge){var transfer=createTransfer(edge.id,edge.source,edge.target);if(edge.data&&edge.data.edgeName&&edge.data.edgeName.length>0){transfer.condition={name:edge.data.edgeName};}transfers.push(transfer);});// 可用于下一次递归的edge，非output
var usefulEdges=outEdges.filter(function(edge){return edge.target!=='1';});usefulEdges.forEach(function(edge){var nextNodeId=edge.target;var nextAction=actions.find(function(action){return action.properties.id===Number.parseInt(nextNodeId);});if(nextAction){nextAction.properties.transferInList.push(Number.parseInt(edge.id));}else{var nextNode=nodes.find(function(node){return node.id===nextNodeId;});if(nextNode){var newAction={type:rawType[SAVE_TYPE_MAP[nextNode.data.nodeType]],properties:createRawNodeData(nextNode.id,nextNode.data.nodeType,nextNode.data.nodeName)};newAction.properties.transferInList.push(Number.parseInt(edge.id));var _nextEdges=edges.filter(function(edge){return edge.source===nextNode.id;});newAction.properties.transferOutList=_nextEdges.map(function(edge){return Number.parseInt(edge.id);});newAction.properties.position=nextNode.position;actions.push(newAction);transformEdge(_nextEdges);}}});}transformEdge(nextEdges);var outputRawNode=createRawNodeData(output.id,output.data.nodeType,output.data.nodeName);var outputTransferIn=edges.filter(function(edge){return edge.target===output.id;});outputRawNode.transferInList=outputTransferIn.map(function(edge){return Number.parseInt(edge.id);});outputRawNode.position=output.position;end=outputRawNode;return{start:start,end:end,actions:actions,transfers:transfers};}function createTransfer(id,source,target){return{id:Number.parseInt(id),fromNodeId:Number.parseInt(source),toNodeId:Number.parseInt(target),condition:null};}function createRawNodeData(id,type,name){return{id:Number.parseInt(id),name:name,transferInList:[],transferOutList:[],type:SAVE_TYPE_MAP[type]};}
;// CONCATENATED MODULE: ./src/App.tsx
function App_typeof(o){"@babel/helpers - typeof";return App_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},App_typeof(o);}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=App_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e){throw _e;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e2){didErr=true;err=_e2;},f:function f(){try{if(!normalCompletion&&it.return!=null)it.return();}finally{if(didErr)throw err;}}};}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||App_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return App_arrayLikeToArray(arr);}function App_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function App_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?App_ownKeys(Object(t),!0).forEach(function(r){App_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):App_ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function App_defineProperty(obj,key,value){key=App_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function App_toPropertyKey(t){var i=App_toPrimitive(t,"string");return"symbol"==App_typeof(i)?i:String(i);}function App_toPrimitive(t,r){if("object"!=App_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=App_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function App_slicedToArray(arr,i){return App_arrayWithHoles(arr)||App_iterableToArrayLimit(arr,i)||App_unsupportedIterableToArray(arr,i)||App_nonIterableRest();}function App_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function App_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return App_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return App_arrayLikeToArray(o,minLen);}function App_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function App_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function App_arrayWithHoles(arr){if(Array.isArray(arr))return arr;}// import debounce from 'lodash/debounce';
var CusContext=/*#__PURE__*/(0,react.createContext)({});var _generateInitialNodes=generateInitialNodesAndEdges(),defaultNodes=_generateInitialNodes.nodes,defaultEdges=_generateInitialNodes.edges;function FlowComponent(){var _useStoreInContext=hooks_useStoreInContext(function(state){return{isLock:state.isLock,model:state.model,rawData:state.rawData,saveStatus:state.saveStatus,modifyName:state.modifyName,nodeValidates:state.nodeValidates,isInit:state.isInit,setSaveStatus:state.setSaveStatus,setModifyName:state.setModifyName,setIsLock:state.setIsLock};}),isLock=_useStoreInContext.isLock,model=_useStoreInContext.model,rawData=_useStoreInContext.rawData,saveStatus=_useStoreInContext.saveStatus,modifyName=_useStoreInContext.modifyName,nodeValidates=_useStoreInContext.nodeValidates,isInit=_useStoreInContext.isInit,setSaveStatus=_useStoreInContext.setSaveStatus,setModifyName=_useStoreInContext.setModifyName,setIsLock=_useStoreInContext.setIsLock;// const [dragKey, setDragKey] = useState<keyof typeof NODE_TYPE | null>(null);
var edgeTypes=(0,react.useMemo)(function(){return EDGE_TYPE;},[]);var nodeTypes=(0,react.useMemo)(function(){return NODE_TYPE;},[]);var wrapperRef=(0,react.useRef)(null);var _useNodesState=(0,esm/* useNodesState */.ck)(defaultNodes),_useNodesState2=App_slicedToArray(_useNodesState,3),nodes=_useNodesState2[0],setNodes=_useNodesState2[1],onNodesChange=_useNodesState2[2];var _useEdgesState=(0,esm/* useEdgesState */.fM)(defaultEdges),_useEdgesState2=App_slicedToArray(_useEdgesState,3),edges=_useEdgesState2[0],setEdges=_useEdgesState2[1],onEdgesChange=_useEdgesState2[2];var reactFlowInstanceRef=(0,react.useRef)();var isComponentInit=(0,react.useRef)(true);var isHidden=(0,react.useRef)(true);var isLockRef=(0,react.useRef)(null);var num=(0,react.useRef)(1);var hasInputNode=!!nodes.find(function(n){return n.type==='input';});var hasOutputNode=!!nodes.find(function(n){return n.type==='output';});(0,esm/* useOnSelectionChange */.p4)({onChange:function onChange(selectAction){console.log('selectAction ===>',selectAction);var selectNodes=selectAction.nodes;var selectEdges=selectAction.edges;if(selectNodes.length+selectEdges.length===0){// select背景
setEdges(function(edges){return edges.map(function(edge){var _edge$data;var hasErr=(_edge$data=edge.data)===null||_edge$data===void 0?void 0:_edge$data.hasErr;var _getEdgeAndMarkerEndS=getEdgeAndMarkerEndStyle(edge.markerEnd,edge.style,hasErr,false),markerEnd=_getEdgeAndMarkerEndS.markerEnd,style=_getEdgeAndMarkerEndS.style;edge.markerEnd=markerEnd;edge.style=style;return edge;}).sort(sortEdges);});if(model){var invokeData={id:-1,typeName:'flow'};// invokeAction(model, 'editFlow', invokeData);
setTimeout(function(){invokeAction(model,'editFlow',invokeData);},200);}}// if (selectNodes.length + selectEdges.length > 1) {
//   // 多选 不处理
//   selectEdges.forEach((edge) => {
//     const hasErr = edge.data?.hasErr
//     const { markerEnd, style } = getEdgeAndMarkerEndStyle(
//       edge.markerEnd!,
//       edge.style,
//       hasErr,
//       true,
//     )
//     edge.markerEnd = markerEnd
//     edge.style = style
//   })
//   return
// }
// 其余情况视为单选
// selectNodes.forEach((node) => {
//   if (model) {
//     resetNodeError(node.id)
//     const invokeData = {
//       id: Number(node.id),
//       typeName: node.data.nodeType,
//       type: TYPEIDS[node.data.nodeType],
//       nodeName: node.data.nodeName,
//     }
//     setTimeout(() => {
//       invokeAction(model, 'editNode', invokeData)
//     }, 200)
//   }
// })
// 重置选择线
// setEdges((edges) =>
//   edges
//     .map((edge) => {
//       const currEdge = selectEdges.find((n) => n.id === edge.id)
//       const { markerEnd, style } = getEdgeAndMarkerEndStyle(
//         edge.markerEnd!,
//         edge.style,
//         edge.data!.hasErr,
//         !!currEdge?.selected,
//       )
//       edge.markerEnd = markerEnd
//       edge.style = style
//       return edge
//     })
//     .sort(sortEdges),
// )
// selectEdges.sort(sortEdges).forEach((edge) => {
//   // const hasErr = edge.data?.hasErr;
//   // const { markerEnd, style } = getEdgeAndMarkerEndStyle(edge.markerEnd!, edge.style, hasErr, true);
//   // console.log('selectEdge ====>', markerEnd);
//   // edge.markerEnd = markerEnd;
//   // edge.style = style;
//   if (model) {
//     resetEdgeError(edge.id)
//     const invokeData = {
//       id: Number(edge.id),
//       typeName: edge.data!.edgeType,
//       type: TYPEIDS[edge.data!.edgeType!],
//       nodeName: edge.data!.edgeName,
//     }
//     setTimeout(() => {
//       invokeAction(model, 'editNode', invokeData)
//     }, 200)
//   }
// })
// setEdges((edges) => {
//   return edges.sort(sortEdges);
// });
}});var resetNodeError=function resetNodeError(id){setNodes(function(nodes){return nodes.map(function(node){if(node.id===id){var newErrorInfo=node.data.errInfo.filter(function(info){return info.code===RULE_ERROR_CODE.OTHER.code;});node.data=App_objectSpread(App_objectSpread({},node.data),{},{hasErr:newErrorInfo.length>0,errInfo:newErrorInfo});}return node;});});};var resetEdgeError=function resetEdgeError(id){setEdges(function(edges){return edges.map(function(edge){if(edge.id===id){var newErrorInfo=edge.data.errInfo.filter(function(info){return info.code===RULE_ERROR_CODE.OTHER.code;});var hasErr=newErrorInfo.length>0;var selected=edge.selected;var _getEdgeAndMarkerEndS2=getEdgeAndMarkerEndStyle(edge.markerEnd,edge.style,hasErr,selected),markerEnd=_getEdgeAndMarkerEndS2.markerEnd,style=_getEdgeAndMarkerEndS2.style;edge.markerEnd=markerEnd;edge.style=style;edge.data=App_objectSpread(App_objectSpread({},edge.data),{},{hasErr:hasErr,errInfo:newErrorInfo});}return edge;}).sort(sortEdges);});};var handleNodesChange=function handleNodesChange(changes){// if (isLock) {
//   changes = changes.filter((n) => n.type !== 'remove');
// }
// changes.length && onNodesChange(changes);
// console.log('handleNodesChange ===>', changes)
onNodesChange(changes);var selectedNode=changes.filter(function(n){return n.type==='select'&&n.selected;})[0];if(selectedNode){var currNode=nodes.find(function(n){return n.id===selectedNode.id;});if(model){resetNodeError(currNode.id);var invokeData={id:Number(currNode.id),typeName:currNode.data.nodeType,type:TYPEIDS[currNode.data.nodeType],nodeName:currNode.data.nodeName};setTimeout(function(){invokeAction(model,'editNode',invokeData);},200);}}};var handleEdgesChange=function handleEdgesChange(changes){// if (isLock) {
//   changes = changes.filter((n) => n.type !== 'remove');
// }
// changes.length && onEdgesChange(changes);
// console.log('handleEdgesChange ===>', changes)
onEdgesChange(changes);var selectedEdge=changes.filter(function(n){return n.type==='select'&&n.selected;})[0];if(selectedEdge){var currEdge=edges.find(function(n){return n.id===selectedEdge.id;});if(model){resetEdgeError(currEdge.id);var invokeData={id:Number(currEdge.id),typeName:currEdge.data.edgeType,type:TYPEIDS[currEdge.data.edgeType],nodeName:currEdge.data.edgeName};setTimeout(function(){invokeAction(model,'editNode',invokeData);},200);}}};var getNodeName=function getNodeName(nodes,nodeName){var name="".concat(nodeName,"_").concat(num.current++);var sameNameNode=nodes.find(function(n){return n.data.nodeName===name;});if(sameNameNode){return getNodeName(nodes,nodeName);}return name;};// const resetSelection = () => {
//   setNodes(nodes => nodes.map(n => ({ ...n, selected: false })))
//   setEdges(edges => edges.map(e => ({ ...e, selected: false })))
// }
var resetErrCode=function resetErrCode(){setNodes(function(nodes){return nodes.map(function(node){node.data=App_objectSpread(App_objectSpread({},node.data),{},{hasErr:false,errInfo:[]});return node;});});setEdges(function(edges){return edges.map(function(edge){var selected=edge.selected;var _getEdgeAndMarkerEndS3=getEdgeAndMarkerEndStyle(edge.markerEnd,edge.style,false,selected),markerEnd=_getEdgeAndMarkerEndS3.markerEnd,style=_getEdgeAndMarkerEndS3.style;edge.markerEnd=markerEnd;edge.style=style;edge.data=App_objectSpread(App_objectSpread({},edge.data),{},{hasErr:false,errInfo:[]});return edge;}).sort(sortEdges);});};// const resetEdgeOtherError = (id: string) => {
//   setEdges((edges) =>
//     edges
//       .map((edge) => {
//         if (edge.id === id) {
//           const newErrorInfo = edge.data!.errInfo.filter((info) => info.code !== RULE_ERROR_CODE.OTHER.code);
//           const hasErr = newErrorInfo.length > 0;
//           const selected = edge.selected;
//           const { markerEnd, style } = getEdgeAndMarkerEndStyle(edge.markerEnd!, edge.style, hasErr, selected);
//           edge.markerEnd = markerEnd;
//           edge.style = style;
//           edge.data = {
//             ...edge.data!,
//             hasErr,
//             errInfo: newErrorInfo,
//           };
//         }
//         return edge;
//       })
//       .sort(sortEdges),
//   );
// };
// const resetNodeOtherError = (id: string) => {
//   setNodes((nodes) =>
//     nodes.map((node) => {
//       if (node.id === id) {
//         const newErrorInfo = node.data.errInfo.filter((info) => info.code !== RULE_ERROR_CODE.OTHER.code);
//         node.data = {
//           ...node.data,
//           hasErr: newErrorInfo.length > 0,
//           errInfo: newErrorInfo,
//         };
//       }
//       return node;
//     }),
//   );
// };
(0,react.useEffect)(function(){if(saveStatus){resetErrCode();// TODO check 保存条件 --done
var checkStatus=checkAll(nodes,edges);if(!checkStatus.hasErr){// 允许保存
var _rawData=transformFlowDataToRawData(nodes,edges);// console.log(rawData);
if(model){// resetSelection();
invokeAction(model,'saveFlow',_rawData);}}else{if(model){invokeAction(model,'saveFlow',{errorCodes:Array.from(new Set(checkStatus.errIdList.map(function(n){return n.errInfo.code;})))});}// const newEdges = edges;
// const newNodes = nodes;
setNodes(function(nodes){return nodes.map(function(node){var err=checkStatus.errIdList.find(function(err){return err.id===node.id&&err.type==='node';});if(err){node.data=App_objectSpread(App_objectSpread({},node.data),{},{hasErr:true,errInfo:node.data.errInfo.concat(err.errInfo)});}return node;});});setEdges(function(edges){return edges.map(function(edge){var err=checkStatus.errIdList.find(function(err){return err.id===edge.id&&err.type==='edge';});if(err){var edgeData=edge.data;if(edgeData){var _getEdgeAndMarkerEndS4=getEdgeAndMarkerEndStyle(edge.markerEnd,edge.style,true,edge.selected),markerEnd=_getEdgeAndMarkerEndS4.markerEnd,style=_getEdgeAndMarkerEndS4.style;edge.markerEnd=markerEnd;edge.style=style;edge.data=App_objectSpread(App_objectSpread({},edgeData),{},{hasErr:true,errInfo:edgeData.errInfo.concat(err.errInfo)});}}return edge;}).sort(sortEdges);});}setSaveStatus(false);}},[saveStatus]);(0,react.useEffect)(function(){if(rawData){var _transformRawDataToFl=transformRawDataToFlowData(rawData,isLock),_nodes=_transformRawDataToFl.nodes,_edges=_transformRawDataToFl.edges;setNodes(_nodes);setEdges(_edges);// TODO: 还是有问题
// HACK:这里hack处理，在更新节点（异步获取）时，如果不进行 fitView，流程图的位置不对，如果不用 setTimeout，reactFlow fitView 是旧的(错的)
setTimeout(function(){var _reactFlowInstanceRef;(_reactFlowInstanceRef=reactFlowInstanceRef.current)===null||_reactFlowInstanceRef===void 0||_reactFlowInstanceRef.fitView();},100);isLockRef.current=isLock;}},[rawData]);(0,react.useEffect)(function(){if(isLock!==isLockRef.current){if(isLock){setNodes(function(prev){console.log('node ===>',prev);return prev.map(function(n){return App_objectSpread(App_objectSpread({},n),{},{deletable:false});});});setEdges(function(prev){return prev.map(function(n){return App_objectSpread(App_objectSpread({},n),{},{deletable:false});});});}else{setNodes(function(prev){return prev.map(function(n){if(n.type==='input'||n.type==='output'){return n;}else{return App_objectSpread(App_objectSpread({},n),{},{deletable:true});}});});setEdges(function(prev){return prev.map(function(n){return App_objectSpread(App_objectSpread({},n),{},{deletable:true});});});}isLockRef.current=isLock;}},[isLock]);(0,react.useEffect)(function(){if(modifyName&&isValidData(modifyName.nodeId)){if(nodes.find(function(node){return node.id===String(modifyName.nodeId);})){var newNodes=nodes.map(function(node){if(node.id!==String(modifyName.nodeId)){return node;}else{return App_objectSpread(App_objectSpread({},node),{},{data:App_objectSpread(App_objectSpread({},node.data),{},{nodeName:modifyName.nodeName})});}});setNodes(function(){return newNodes;});}if(edges.find(function(edge){return edge.id===String(modifyName.nodeId);})){var newEdges=edges.map(function(edge){var _edge$data2;var _getEdgeAndMarkerEndS5=getEdgeAndMarkerEndStyle(edge.markerEnd,edge.style,(_edge$data2=edge.data)===null||_edge$data2===void 0?void 0:_edge$data2.hasErr,edge.selected),markerEnd=_getEdgeAndMarkerEndS5.markerEnd,style=_getEdgeAndMarkerEndS5.style;edge.markerEnd=markerEnd;edge.style=style;if(edge.id===String(modifyName.nodeId)){return App_objectSpread(App_objectSpread({},edge),{},{label:modifyName.nodeName,data:App_objectSpread(App_objectSpread({},edge.data),{},{edgeName:modifyName.nodeName})});}else{return edge;}});setEdges(function(){return newEdges.sort(sortEdges);});}setModifyName();}},[modifyName]);(0,react.useEffect)(function(){if(nodeValidates&&nodeValidates.length){var nodesValidateInner=[];var edgesValidateInner=[];var _loop=function _loop(){var nodeValidate=nodeValidates[i];if(nodeValidate.nodeId!==-1){if(nodes.find(function(node){return node.id===String(nodeValidate.nodeId);})){nodesValidateInner.push(nodeValidate);}if(edges.find(function(edge){return edge.id===String(nodeValidate.nodeId);})){edgesValidateInner.push(nodeValidate);}}};for(var i=0;i<nodeValidates.length;i++){_loop();}if(nodesValidateInner.length){setNodes(function(nodes){var nodesCache=_toConsumableArray(nodes);nodesValidateInner.forEach(function(nodeValidate){var index=nodesCache.findIndex(function(n){return String(nodeValidate.nodeId)===n.id;});if(index>-1){var _node=nodesCache[index];if(nodeValidate.status==='error'){_node.data=App_objectSpread(App_objectSpread({},_node.data),{},{hasErr:true,errInfo:_node.data.errInfo.filter(function(info){return info.code!==RULE_ERROR_CODE.OTHER.code;}).concat({code:RULE_ERROR_CODE.OTHER.code,msg:nodeValidate.validMessage})});}else if(nodeValidate.status==='pass'){_node.data=App_objectSpread(App_objectSpread({},_node.data),{},{hasErr:false,errInfo:[]});}}});return nodesCache;});}if(edgesValidateInner.length){setEdges(function(edges){var edgesCache=_toConsumableArray(edges);edgesValidateInner.forEach(function(edgeValidate){var index=edgesCache.findIndex(function(n){return String(edgeValidate.nodeId)===n.id;});if(index>-1){var _edge=edgesCache[index];if(edgeValidate.status==='error'){var _getEdgeAndMarkerEndS6=getEdgeAndMarkerEndStyle(_edge.markerEnd,_edge.style,true,_edge.selected),markerEnd=_getEdgeAndMarkerEndS6.markerEnd,style=_getEdgeAndMarkerEndS6.style;_edge.markerEnd=markerEnd;_edge.style=style;_edge.data=App_objectSpread(App_objectSpread({},_edge.data),{},{hasErr:true,errInfo:_edge.data.errInfo.filter(function(info){return info.code!==RULE_ERROR_CODE.OTHER.code;}).concat({code:RULE_ERROR_CODE.OTHER.code,msg:edgeValidate.validMessage})});}else if(edgeValidate.status==='pass'){var hasErr=false;var selected=_edge.selected;var _getEdgeAndMarkerEndS7=getEdgeAndMarkerEndStyle(_edge.markerEnd,_edge.style,hasErr,selected),_markerEnd=_getEdgeAndMarkerEndS7.markerEnd,_style=_getEdgeAndMarkerEndS7.style;_edge.markerEnd=_markerEnd;_edge.style=_style;_edge.data=App_objectSpread(App_objectSpread({},_edge.data),{},{hasErr:hasErr,errInfo:[]});}}});return edgesCache.sort(sortEdges);});}}},[nodeValidates]);var onConnect=function onConnect(connection){if(isLock)return;// 已存在
var isAlreadyExists=edges.some(function(edge){return edge.source===connection.source&&edge.target===connection.target;});// 自我形成环结构
var isSurroundingOneself=connection.source===connection.target;// 双节点间最小环结构
var isToNodesRing=edges.some(function(edge){return edge.source===connection.target&&edge.target===connection.source;});if(!isAlreadyExists&&!isSurroundingOneself&&!isToNodesRing){var newEdge=generateEdge(String(IDControler.getId()),'',connection.source,connection.target,connection.sourceHandle,connection.targetHandle);// 通知后端新增节点
if(model){var transfer=transformEdgeWhenNewNode(newEdge,nodes,edges.concat(newEdge));var invokeData={id:Number(newEdge.id),type:TYPEIDS[newEdge.data.edgeType],nodes:[],transfers:[transfer]};invokeAction(model,'newNode',invokeData);}setEdges(function(edges){return edges.concat(newEdge).sort(sortEdges);});}else{// TODO ： 走统一报错
// model.invokeAync()通知后台使用系统悬浮报错或警告 或 自己实现顶部浮窗报错
}};var handleAddNode=(0,react.useCallback)(function(type,position){var newNode=generateNodes[type](String(IDControler.getId()));if(ACTION_NODE.includes(type)){// newNode.data.nodeName += `_${num++}`;
newNode.data.nodeName=getNodeName(nodes,newNode.data.nodeName);}if(position){newNode.position=reactFlowInstanceRef.current.screenToFlowPosition({x:position.x,y:position.y});}else{var inputNode=nodes.find(function(n){return n.type==='input';});var _position={x:0,y:0};if(type!=='input'){_position=getNodePosition(nodes,{x:inputNode?inputNode.position.x:0},{y:80});}newNode.positionAbsolute={x:0,y:0};newNode.position=_position;}if(model){var _rawData2=transformNodeWhenNewNode(newNode,nodes.concat(newNode),edges);var invokeData={id:Number(newNode.id),type:TYPEIDS[newNode.data.nodeType],nodes:[_rawData2],transfers:[]};invokeAction(model,'newNode',invokeData);}setNodes(function(nds){return nds.concat(newNode);});},[nodes,edges]);var onDragOver=(0,react.useCallback)(function(event){event.preventDefault();event.dataTransfer.dropEffect='move';},[]);var onDrop=function onDrop(event){event.preventDefault();var type=event.dataTransfer.getData('application/reactflow');console.log('onDrop ===>',type);// check if the dropped element is valid
if(typeof type==='undefined'||!type){return;}handleAddNode(type,{x:event.clientX,y:event.clientY});};var handleNodesDelete=function handleNodesDelete(nodes){if(isLock)return;if(model){var invokeData={nodeIds:nodes.map(function(node){return Number(node.id);}),transferIds:[]};invokeAction(model,'delNode',invokeData);}};var handleEdgesDelete=function handleEdgesDelete(edges){if(isLock)return;if(model){var invokeData={nodeIds:[],transferIds:edges.map(function(edge){return Number(edge.id);})};invokeAction(model,'delNode',invokeData);}};(0,react.useEffect)(function(){var resizeObserver=new ResizeObserver(function(entries){var _iterator=_createForOfIteratorHelper(entries),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var entry=_step.value;var target=entry.target;var width=target.offsetWidth;var height=target.offsetHeight;if(width===0&&height===0){// console.log('元素被隐藏了');
isHidden.current=true;}else{// console.log('isHidden ===>', isHidden);
if(isHidden.current){// console.log('元素展示了');
isHidden.current=false;}else{// console.log('元素大小改变了');
isHidden.current=false;if(!isComponentInit.current){if(reactFlowInstanceRef.current){// console.log('resizeObserver handle');
reactFlowInstanceRef.current.fitView();}}}}}}catch(err){_iterator.e(err);}finally{_iterator.f();}});if(wrapperRef.current){resizeObserver.observe(wrapperRef.current);}isComponentInit.current=false;return function(){if(wrapperRef.current){resizeObserver.unobserve(wrapperRef.current);}resizeObserver.disconnect();};},[]);return/*#__PURE__*/react.createElement("div",{className:"".concat(App.gaiFlow)},/*#__PURE__*/react.createElement(CusContext.Provider,{value:{hasInputNode:hasInputNode,hasOutputNode:hasOutputNode,handleAddNode:handleAddNode}},/*#__PURE__*/react.createElement("div",{className:"".concat(App.mainFlow),ref:wrapperRef},isInit?/*#__PURE__*/react.createElement("div",{className:App.loading},/*#__PURE__*/react.createElement("img",{className:App.loadingImg,src:loading_namespaceObject})):null,/*#__PURE__*/react.createElement(esm/* ReactFlow */.Gc,{nodes:nodes,edges:edges,onNodesChange:handleNodesChange,onEdgesChange:handleEdgesChange,onConnect:onConnect,onNodesDelete:handleNodesDelete,onEdgesDelete:handleEdgesDelete,nodeTypes:nodeTypes,edgeTypes:edgeTypes// onDragEnd={handleDrop}
,onDrop:onDrop,onDragOver:onDragOver,onInit:function onInit(instance){reactFlowInstanceRef.current=instance;},className:"".concat(App.flowContent," ").concat(isInit?App.flowContent:''),connectionLineComponent:connectionLine,connectionLineType:esm/* ConnectionLineType */.Do.Bezier// zoom配置
,minZoom:0.5,maxZoom:2.0// 禁用双击放大
,zoomOnDoubleClick:false// 禁用节点拖拽
,nodesDraggable:true// 拖拽时选择
,selectionOnDrag:true// 禁用拖拽时选中节点 开启后切换节点触发两次 useOnSelectionChange
// selectNodesOnDrag={false}
,panOnDrag:true,panOnScroll:false// 删除
// deleteKeyCode={null}
// 多选
// multiSelectionKeyCode={null}
// 划选
// selectionKeyCode={null}
// 异步生成的节点直接设置 fitView 可能导致位置不对
// fitView
,edgesUpdatable:!isLock// edgesFocusable={!isLock}
,nodesConnectable:!isLock// nodesFocusable={!isLock}
// draggable={!isLock}
// elementsSelectable={!isLock}
},/*#__PURE__*/react.createElement(dist_esm/* Background */.V,{id:"flowBackground",gap:20,size:2,color:"#ECEDF3",style:{backgroundColor:'#E2E7EF'},variant:dist_esm/* BackgroundVariant */._.Dots}),isDev?/*#__PURE__*/react.createElement(react.Fragment,null,/*#__PURE__*/react.createElement(minimap_dist_esm/* MiniMap */.o,{pannable:true,draggable:true,zoomable:true,nodeColor:"transparent",nodeStrokeColor:function nodeStrokeColor(node){switch(node.type){case'inputNode':return'green';case'outputNode':return'blue';case'conditioin':return'purple';case'taskNode':return'orange';default:return'orange';}},nodeBorderRadius:10}),' ',/*#__PURE__*/react.createElement(controls_dist_esm/* Controls */.H,null,/*#__PURE__*/react.createElement(react.Fragment,null,/*#__PURE__*/react.createElement(controls_dist_esm/* ControlButton */.a,{onClick:function onClick(){return invokeAction(model,'saveFlow',{});}},"save"),/*#__PURE__*/react.createElement(controls_dist_esm/* ControlButton */.a,{onClick:function onClick(){return model===null||model===void 0?void 0:model.invokeAsync('getModifyName',nodes[Math.floor(Math.random()*nodes.length)].id);}},"changeName"),/*#__PURE__*/react.createElement(controls_dist_esm/* ControlButton */.a,{onClick:function onClick(){return model===null||model===void 0?void 0:model.invokeAsync('getNodeValidate',nodes[Math.floor(Math.random()*nodes.length)].id);}},"getError"),/*#__PURE__*/react.createElement(controls_dist_esm/* ControlButton */.a,{onClick:function onClick(){return model===null||model===void 0?void 0:model.invokeAsync('resetNodeValidate',nodes[Math.floor(Math.random()*nodes.length)].id);}},"resetError"),/*#__PURE__*/react.createElement(controls_dist_esm/* ControlButton */.a,{onClick:function onClick(){return setIsLock(!isLock);}},isLock?'unLock':'lock')))):null)),/*#__PURE__*/react.createElement(CustomPanel,null)));}function ReactFlowProviderFlow(){return/*#__PURE__*/react.createElement(esm/* ReactFlowProvider */.Ln,null,/*#__PURE__*/react.createElement(FlowComponent,null));}/* harmony default export */ var src_App = (ReactFlowProviderFlow);

/***/ })

}]);
//# sourceMappingURL=chunk.830.a1367c70.js.map