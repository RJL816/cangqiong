var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(t,C,y){t instanceof String&&(t=String(t));for(var J=t.length,H=0;H<J;H++){var x=t[H];if(C.call(y,x,H,t))return{i:H,v:x}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,C,y){if(t==Array.prototype||t==Object.prototype)return t;t[C]=y.value;return t};$jscomp.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var C=0;C<t.length;++C){var y=t[C];if(y&&y.Math==Math)return y}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(t,C){var y=$jscomp.propertyToPolyfillSymbol[C];if(null==y)return t[C];y=t[y];return void 0!==y?y:t[C]};
$jscomp.polyfill=function(t,C,y,J){C&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(t,C,y,J):$jscomp.polyfillUnisolated(t,C,y,J))};$jscomp.polyfillUnisolated=function(t,C,y,J){y=$jscomp.global;t=t.split(".");for(J=0;J<t.length-1;J++){var H=t[J];if(!(H in y))return;y=y[H]}t=t[t.length-1];J=y[t];C=C(J);C!=J&&null!=C&&$jscomp.defineProperty(y,t,{configurable:!0,writable:!0,value:C})};
$jscomp.polyfillIsolated=function(t,C,y,J){var H=t.split(".");t=1===H.length;J=H[0];J=!t&&J in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var x=0;x<H.length-1;x++){var f=H[x];if(!(f in J))return;J=J[f]}H=H[H.length-1];y=$jscomp.IS_SYMBOL_NATIVE&&"es6"===y?J[H]:null;C=C(y);null!=C&&(t?$jscomp.defineProperty($jscomp.polyfills,H,{configurable:!0,writable:!0,value:C}):C!==y&&(void 0===$jscomp.propertyToPolyfillSymbol[H]&&(y=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[H]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(H):$jscomp.POLYFILL_PREFIX+y+"$"+H),$jscomp.defineProperty(J,$jscomp.propertyToPolyfillSymbol[H],{configurable:!0,writable:!0,value:C})))};$jscomp.polyfill("Array.prototype.find",function(t){return t?t:function(C,y){return $jscomp.findInternal(this,C,y).v}},"es6","es3");
(function(){function t(v,D){var r=this,E,q,n,g,u,F,z,G,L,N,K=!1,S=!0,R,W,X,ba,T;this.getSchemaList=function(){return q};this.setClickEditPublishSchemeListener=function(b){T=b};this.getClickEditPublishSchemeListener=function(){return T};this.setCheckBeforeEditAndPublishScheme=function(b){ba=b};this.getCheckBeforeEditAndPublishScheme=function(){return ba};this.setJudgeHaveMorePublishSchema=function(b){X=b};this.getJudgeHaveMorePublishSchema=function(){return X};this.setDrawPublishSchemaList=function(b){W=
b};this.getDrawPublishSchemaList=function(){return W};this.setAllSchemas=function(b){u=b};this.getAllSchemas=function(){return u};this.setFunJudgePublishOper=function(b){R=b};this.setSchemas=function(b){F=b;null!=b&&0!=b.length||g.getJqUi().data("bIsSearch")?(S=u&&u.length!=F.length?!1:!0,q.getJqUi().css("top","0"),g.getJqUi().css("display","block")):(q.getJqUi().css("top","0"),g.getJqUi().css("display","none"));W&&q.setDrawPublishSchemaList(!0);ba&&q.setCheckBeforeEditAndPublishScheme(!0);T&&q.setClickEditPublishSchemeListener(T);
q.setItemModels(b);n.getJqUi().css("display","flex");b&&0<b.length&&n.getJqUi().css("display","none")};this.setSchemaStatus=function(b){b.setIsDefault(!b.IsDefault());for(var d=0;d<F.length;d++)F[d].getFId()==b.getFId()?F[d]=b:b.IsDefault()&&F[d].IsDefault()&&F[d].setIsDefault(!1);r.setSchemas(F)};this.setMaxHeight=function(b){var d=E.find(".schema-frequentlyused").css("marginTop"),m=0;null!=d&&2<d.length&&(m=d.substring(0,d.length-2));E.css("max-height",b+"px");q.getJqUi().css("max-height",b-q.getJqUi().parent().prop("offsetTop")-
q.getJqUi().prop("offsetTop")-m-2+"px")};this.setSelectedSchema=function(b){q.setSelected(b);b&&(W?z.show():b.getSchemaType()==O.SCHEMATYPE_SYSTEM?z.hide():z.show())};this.getSelectedSchema=function(){return q.getSelected()};this.getSchemas=function(){return q.getItemModels()};this.addActionListeners=function(b){q.addItemClickListener(function(d,m){b.ItemClickListener(d)});q.addSelectedChangedListener(function(d){b.selectedChangedListener(d)});q.addDeleteIconClickListener(function(d,m){K=!1;b.deleteListener(d,
m)});q.addEditIconClickListener(function(d,m){b.EditListener(d,m)});q.addSetDefaultListener(function(d){K=!1;b.setDefaultAttrListener(d,g.getText())});g.addSearchListener(function(d){K=!1;n.setText(f.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c"));g.getJqUi().data("bIsSearch",!0);b.searchLisenter(d)});q.addUpIconClickListener(function(d,m){m=[];for(var w=1;w<F.length;w++)if(F[w].getFId()==d.getFId()){d.setSeq(d.getSeq()+1);F[w-1].setSeq(F[w-1].getSeq()-1);m.push(d.toJsonObject());
m.push(F[w-1].toJsonObject());F.splice(w,1);F.splice(w-1,0,d);break}b.doSeqListener(m,F,function(){K=!1;r.setSchemas(F)})});z.on("click",function(){K=!1;b.saveListener()});G.on("click",function(){R?R(function(){K=!1;b.saveAsListener()}):(K=!1,b.saveAsListener())});L.on("click",function(){R?R(function(){K=!1;b.createListener()}):(K=!1,b.createListener())});N.on("click",b.exportSqlListener)};this.getJqUi=function(){return E};this.initSchemaList=function(){var b=$("div.schema-manage-list");0<b.length&&
(q.getJqUi().css("height","30px"),q.getJqUi().css("height",b.prop("scrollHeight")))};var da=function(b){b=b.currentTarget.childNodes;for(var d=0;d<b.length;d++){var m=$(b[d]);m.hasClass("schema-icon-hide")?m.removeClass("schema-icon-hide"):m.hasClass("schema-manage-list-item-value")&&m.css("max-width","285px")}},Z=function(b){b=b.currentTarget.childNodes;for(var d=0;d<b.length;d++){var m=$(b[d]);m.hasClass("schema-delete-icon-show")||m.hasClass("schema-default-icon-show")||m.hasClass("schema-undefault-icon-show")||
m.hasClass("schema-edit-icon-show")||m.hasClass("schema-up-icon-show")?m.addClass("schema-icon-hide"):m.hasClass("schema-manage-list-item-value")&&m.css("max-width","360px")}},aa=function(b,d,m){m.text(d.getSchemaName());m.prop("title",d.getSchemaName());var w=d.getSchemaType(),A=$("<div>");A.data("setDefaultModel",d);A.addClass("schema-setdefault-icon");A.addClass("schema-icon-hide");A.prop("title",f.get("setDefaultScheme","\u8bbe\u4e3a\u9ed8\u8ba4\u65b9\u6848"));d&&d.IsDefault()?(m.text(f.get("def",
"(\u9ed8\u8ba4)")+d.getSchemaName()),m.prop("title",f.get("def","(\u9ed8\u8ba4)")+d.getSchemaName()),m.css("font-weight","bold"),A.addClass("schema-default-icon-show"),x.background(A,"icon_default"),A.prop("title",f.get("cancelDefaultScheme","\u53d6\u6d88\u9ed8\u8ba4\u65b9\u6848"))):(A.addClass("schema-undefault-icon-show"),x.background(A,"icon_undefault"),A.on("mouseover",function(h){x.background(A,"icon_default")}),A.on("mouseout",function(h){x.background(A,"icon_undefault")}));var M;W?M=ca(d):
w!=O.SCHEMATYPE_SYSTEM&&(M=ca(d));if(M){var a=M.deleteIcon;var c=M.editIcon;var e=M.upIcon}v||(b.on("mouseover",da),b.on("mouseout",Z));b.append(m);b.append(A);c&&b.append(c);a&&b.append(a);e&&b.append(e)},ca=function(b){var d=$("<div>");d.data("deleteModel",b);d.addClass("schema-delete-icon");d.addClass("schema-delete-icon-show");x.background(d,"icon_delete");d.on("mouseover",function(A){x.background(d,"icon_delete_hover")});d.on("mouseout",function(A){x.background(d,"icon_delete")});d.addClass("schema-icon-hide");
d.prop("title",f.get("deleteScheme","\u5220\u9664\u65b9\u6848"));var m=$("<div>");m.data("EditModel",b);m.addClass("schema-edit-icon");m.addClass("schema-edit-icon-show");x.background(m,"icon_edit");m.on("mouseover",function(A){x.background(m,"icon_edit_hover")});m.on("mouseout",function(A){x.background(m,"icon_edit")});m.addClass("schema-icon-hide");m.prop("title",f.get("editScheme","\u4fee\u6539\u65b9\u6848\u540d\u79f0"));if(K&&S){var w=$("<div>");w.data("UpModel",b);w.addClass("schema-up-icon");
w.addClass("schema-up-icon-show");x.background(w,"icon_up_schema");w.on("mouseover",function(A){x.background(w,"icon_up_schema_on")});w.on("mouseout",function(A){x.background(w,"icon_up_schema")});w.addClass("schema-icon-hide");w.prop("title",f.get("upScheme","\u4e0a\u79fb\u65b9\u6848"))}K=!0;return{deleteIcon:d,editIcon:m,upIcon:w}},fa=function(){var b=new ia(f.get("usedScheme","\u5206\u6790\u65b9\u6848"));b.getJqUi().addClass("schema-name-label");var d=$("<div tabIndex=-1 style='outline: none;'>");
d.css({width:"10px","float":"left",height:"34px"});d.on("mousedown",p);d.on("mouseup",p);d.on("keydown",p);d.on("keyup",p);var m=$("<div>");m.addClass("schema-title");m.append(d);m.append(b.getJqUi());N=$("<span>");N.addClass("schema-head-exportBtn");N.addClass("schema-head-exportBtn-hide");N.addClass("schema-head-button");N.text(f.get("exportSql","\u5bfc\u51fa\u811a\u672c"));G=$("<span>");G.addClass("schema-head-button");G.text(f.get("saveAs","\u53e6\u5b58\u4e3a"));z=$("<span>");z.addClass("schema-head-button");
z.text(f.get("save","\u4fdd\u5b58"));L=$("<span>");L.addClass("schema-head-button");L.text(f.get("create","\u65b0\u5efa"));b=f.get("usedSchemeEmpty","\u53ef\u7528\u65b9\u6848\u4e3a\u7a7a\uff0c\u8bf7\u5148\u65b0\u5efa\u65b9\u6848\u3002");n=new ia(b);n.setAlign(ia.ALIGN_CENTER);n.getJqUi().addClass("label-empty-schema");n.getJqUi().attr("title",b);q=new C;q.setCustomItemPainter(aa);v||(!D||D.protectedParseDesignable()?(N.appendTo(m),G.appendTo(m),z.appendTo(m),L.appendTo(m)):(z.appendTo(m),b=f.get("usedSchemeEmptyReadOnly",
"\u53ef\u7528\u65b9\u6848\u4e3a\u7a7a")),n.setText(b),q.getJqUi().append(n.getJqUi()));b=$("<div>");b.addClass("schema-content-div");g=new ma;g.setAlwaysShowCleanIcon(!1);"IE"==ka.getBrowserName()&&"11"==ka.getBrowserVersion()||g.setPlaceholder(f.get("inputSchemaName","\u641c\u7d22\u65b9\u6848\u540d\u79f0"));g.setShowSearchIcon(!0);d=g.getJqUi();d.css({left:"12px",top:"0",width:"376px",height:"26px",position:"relative"});b.append(d);b.append(q.getJqUi());d=$("<div>");d.addClass("schema-border");var w=
$("<div>");w.addClass("schema-frequentlyused");w.addClass("schema-default");w.append(d);w.append(m);w.append(b);return w},ea=!1,U=!1,l=!1,p=function(b){var d=b.type;b=b.keyCode;d&&"mousedown"===d&&(U=!0);d&&"mouseup"===d&&(U=!1);d&&b&&"keydown"===d&&"17"==b&&(ea=!0);d&&b&&"keyup"===d&&"17"==b&&(ea=!1);ea&&U&&!l&&(l=!0,N.removeClass("schema-head-exportBtn-hide"))};(function(){E=$("<div>");E.on("click",function(b){b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});E.addClass("schema-mainPan");
E.append(fa())})()}function C(){var v=this,D=[],r,E,q,n,g,u,F,z,G,L,N,K,S,R,W,X;this.setPublishAppMenuAndCenter=function(l){R=l};this.setClickEditPublishSchemeListener=function(l){X=l};this.getClickEditPublishSchemeListener=function(){return X};this.setCheckBeforeEditAndPublishScheme=function(l){W=l};this.getCheckBeforeEditAndPublishScheme=function(){return W};this.setDrawRightSchemaList=function(l){N=l};this.setDrawPublishSchemaList=function(l){L=l};this.setItemModels=function(l,p){D=l?l:[];K=p?
p:ba;Z()};var ba=function(l,p){return l===p};this.getItemModels=function(){return D};this.setSelected=function(l){var p=r;v.getSelected()==l?fa():(r=l,n&&n(v,p,r))};this.getSelected=function(){return r};this.getJqUi=function(){if(!E){E=$("<div>");E.addClass("schema-manage-list");var l=$("<div>");l.addClass("schema-manage-list-owner");l.on("mouseup",ea);l.appendTo(E);Z();fa()}return E};this.initDeleteIcon=function(){E.find(".schema-delete-icon").hasClass("schema-delete-icon-hide")?E.find(".schema-delete-icon").removeClass("schema-delete-icon-hide"):
E.find(".schema-delete-icon").addClass("schema-delete-icon-hide")};this.setCustomItemPainter=function(l){q=l};this.addSelectedChangedListener=function(l){n=l};this.addItemClickListener=function(l){z=l};this.addDeleteIconClickListener=function(l){g=l};this.addEditIconClickListener=function(l){u=l};this.addUpIconClickListener=function(l){G=l};this.addSetDefaultListener=function(l){F=l};var T=function(l,p){l.text(p)},da=function(){return E.find(".schema-manage-list-item")},Z=function(){if(E){E.find(".schema-manage-list-item-container").remove();
da().remove();var l=E.find(".schema-manage-list-owner");l.empty();if(0==D.length&&R){var p=$("<div>");p.addClass("sa-qing-search-content-container");var b=$("<div>");b.addClass("sa-qing-search-no-data-tips");b.css({width:"130px",height:"130px"});x.background(b,"public-no-data");var d=$("<div>");d.addClass("sa-qing-search-manager-content-emptytip");d.text(f.get("noSaveSchema","\u6682\u65e0\u5df2\u4fdd\u5b58\u7684\u5206\u6790\u65b9\u6848"));p.append(b);p.append(d);l.append(p)}else{b=p=!1;for(var m,
w,A=0;A<D.length;A++)if(N)ca(D[A],l);else if(D[A].getSchemaType()==O.SCHEMATYPE_SYSTEM){S=!0;if(0==p){p=!0;d=$("<div>");d.addClass("schema-manage-list-item-container");var M=$("<div>");M.addClass("schema-manage-list-nodeline-head");x.background(M,"tree-expanded_hover");M.on("click",aa);M.on("mouseover",function(B){x.background(M,"tree-expanded")});M.on("mouseout",function(B){x.background(M,"tree-expanded_hover")});var a=$("<div>");a.addClass("schema-manage-item-system-icon");x.background(a,"icon_system");
var c=$("<div>");c.addClass("schema-manage-item-text");c.text(f.get("systemSchema","\u7cfb\u7edf\u65b9\u6848"));c.css("margin-left","10px");if(L){var e=new la;e.setIconType(la.ICON_TYPE_QUESTION);e.setTipsText(f.get("PublishSchemaInfoTip","\u62e5\u6709\u8be5\u53d1\u5e03\u8bb0\u5f55\u6743\u9650\u7684\u7528\u6237\u548c\u89d2\u8272\u53ef\u67e5\u770b\u4ee5\u4e0b\u6240\u6709\u65b9\u6848"));e=e.getJqUi();var h=4<c.text().length?128:87;e.css({left:h+"px",top:"6px",cursor:"pointer"})}h=$("<div>");h.addClass("schema-manage-list-title-item");
M.appendTo(h);a.appendTo(h);c.appendTo(h);L&&e.appendTo(h);h.appendTo(d)}ca(D[A],d)}else if(D[A].getSchemaType()==O.SCHEMATYPE_USERDEFINED){if(0==b){b=!0;m=$("<div>");m.addClass("schema-manage-list-item-container");var k=$("<div>");k.addClass("schema-manage-list-nodeline-head");x.background(k,"tree-expanded_hover");k.on("click",aa);k.on("mouseover",function(B){x.background(k,"tree-expanded")});k.on("mouseout",function(B){x.background(k,"tree-expanded_hover")});a=$("<div>");a.addClass("schema-manage-item-user-icon");
x.background(a,"icon_user");c=$("<div>");c.addClass("schema-manage-item-text");c.text(f.get("userSchema","\u7528\u6237\u65b9\u6848"));c.css("margin-left","10px");w=$("<div>");w.addClass("schema-manage-list-title-item");k.appendTo(w);a.appendTo(w);c.appendTo(w);w.appendTo(m)}ca(D[A],m)}!p&&b?(!S&&w.remove(),m.appendTo(l),!S&&da().css("padding","5px 5px 5px 15px")):p&&b?(d.appendTo(l),m.appendTo(l)):p&&!b&&d.appendTo(l)}}},aa=function(l){var p=$(l.target);p.off("mouseover");p.off("mouseout");l=p.parents(".schema-manage-list-title-item").siblings(".schema-manage-list-item");
"block"==l.css("display")?(l.css("display","none"),x.background(p,"tree-collapsed"),p.on("mouseover",function(b){x.background(p,"tree-collapsed")}),p.on("mouseout",function(b){x.background(p,"tree-collapsed_hover")})):(l.css("display","block"),x.background(p,"tree-expanded"),p.on("mouseover",function(b){x.background(p,"tree-expanded")}),p.on("mouseout",function(b){x.background(p,"tree-expanded_hover")}))},ca=function(l,p){var b=$("<div>");b.addClass("schema-manage-list-item");N&&b.css("padding-left",
"12px");var d=$("<div>");d.addClass("schema-manage-list-item-value");d.data("model",l);b.data("model",l);(q?q:T)(b,l,d);p.append(b)},fa=function(){if(E){var l=da();l.removeClass("schema-manage-list-item_selected_enabled");for(var p=0;p<l.length;p++){var b=$(l[p]),d=b.data("model");if(r&&K(d,r)){b.addClass("schema-manage-list-item_selected_enabled");break}}}},ea=function(l){var p=$(l.target),b=p.data("deleteModel"),d=p.data("setDefaultModel"),m=p.data("EditModel"),w=p.data("UpModel"),A=p.data("model");
z&&A&&!b&&!d&&U(function(){v.setSelected(A);z(A)},A);b&&U(function(){g(b,p)},b);m&&U(function(){var M=p.siblings(".schema-manage-list-item-value");u(m,M)},m);w&&U(function(){G(w,p)},w);d&&U(function(){F(d)},d)},U=function(l,p){W?X&&X(l,p):l()}}function y(){var v,D,r,E,q,n,g,u;this.setSize=function(z,G){};this.setInputWidth=function(z){u=z};this.getDefault=function(){return n};this.setScheamList=function(z){q=z};this.setInputValue=function(z){g.setText(z)};this.getInputValue=function(){return g.getText()};
this.setFocus=function(){g.requestFocus()};this.showMessage=function(z,G){clearTimeout(E);D.text(z);G&&D.css("color",G);E=setTimeout(function(){D.text("")},5E3)};this.getJqUi=function(){if(!v){v=$("<div>");var z=$("<div>");z.addClass("schema-input-container");var G=new ia;G.setText(f.get("schemeName","\u65b9\u6848\u540d\u79f0"));G.setRequired(!0);G=G.getJqUi();na.layoutCtrl(G,8,0,72,21);g=new oa;var L=g.getJqUi();L.addClass("schema-name-input");u&&L.css("width",u+"px");D=$("<div>");D.addClass("message-tips");
q&&(r=$("<div>"),r.addClass("schema_default_icon"),u&&r.css("left",u+80+"px"),r.on("click",F),0==q.length?(r.addClass("icon_default"),x.background(r,"icon_default"),r.removeClass("icon_undefault"),r.attr("title",f.get("cancelDefaultScheme","\u53d6\u6d88\u9ed8\u8ba4\u65b9\u6848")),n=!0):(r.addClass("icon_undefault"),x.background(r,"icon_undefault"),r.removeClass("icon_default"),r.attr("title",f.get("setDefaultScheme","\u8bbe\u4e3a\u9ed8\u8ba4\u65b9\u6848")),n=!1));z.append(G);z.append(L);q&&z.append(r);
v.append(z);v.append(D)}return v};var F=function(){n?(r.addClass("icon_undefault"),x.background(r,"icon_undefault"),r.removeClass("icon_default"),r.attr("title",f.get("setDefaultScheme","\u8bbe\u4e3a\u9ed8\u8ba4\u65b9\u6848")),n=!1):(r.addClass("icon_default"),x.background(r,"icon_default"),r.removeClass("icon_undefault"),r.attr("title",f.get("cancelDefaultScheme","\u53d6\u6d88\u9ed8\u8ba4\u65b9\u6848")),n=!0)}}function J(v){var D=$("<div class='sa-ctrl-common-modallayer'>"),r=new pa(D),E=0,q=0,n=
320,g=240,u=v?v:$(document.body),F,z;this.setTitle=function(G){z=G};this.setClosingListener=function(G){F=G};this.setSize=function(G,L){n=G;g=L};this.showDialog=function(G){D.appendTo(u);if(!E){var L=u.prop("clientWidth"),N=u.prop("clientHeight");E=L-n>>1;q=(N-g)/3}r.setBounds(E,q,n,g);r.setToolbarVisible(!1);r.setContent(G);r.setTitle(z);r.addClosingListener(function(K,S){if(S)F(S);else return K.destroy(),D.remove(),!0});r.addClosedListener(function(K){K.destroy();D.remove()});r.showFooterPane();
r.show()};this.destroy=function(){r.destroy();D.remove()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.schemamanage&&(com.kingdee.bos.qing.schemamanage={});"undefined"==typeof com.kingdee.bos.qing.schemamanage.ui&&(com.kingdee.bos.qing.schemamanage.ui={});var H=com.kingdee.bos.qing.schemamanage.ui;
H.List=C;H.SaveOrEditSchemaDialog=J;H.SchemaNameInputPane=y;var x,f,pa,ia,O,ja,na,ka,la,ha,V,Q,qa,oa,ma;(function(){var v=com.kingdee.bos.qing.framework.common;f=v.MultilanguageManager.createPackageAccessor(H);v=com.kingdee.bos.qing.schemamanage;x=v.MyIcons;ha=v.SchemaManage;v=com.kingdee.bos.qing.ui.component;pa=v.Dialog;ia=v.Label;Q=v.MessageDialog;qa=v.SimpleConfirmer;oa=v.TextField;ma=v.SearchBox;la=v.HelpIcon;v=com.kingdee.bos.qing.schemamanage.model;O=v.SchemaAttrModel;ja=v.SchemaModel;v=com.kingdee.bos.qing.common;
na=v.DomUtil;ka=v.BrowserUtil;v=com.kingdee.bos.qing.schemamanage.common;V=v.SchemaManageFacade})();H.Main=function(v,D){var r=this,E,q,n,g,u=[],F,z,G,L,N=!1,K,S,R;this.setClickPublishSchemaUpIcon=function(a){K=a};this.getClickPublishSchemaUpIcon=function(){return K};this.setCurrentPublishSchema=function(a){var c=new O;c.setFId(a.getCurrentSchemaId());c.setSchemaName(a.getCurrentSchemaName());c.setSchemaType(a.getCurrentSchemaType());S=c};this.setCreatePublishPlan=function(a){N=a};this.setOperatorPrevCheckListener=
function(a){L=a};this.setCacheSchemaListener=function(a){F=a};this.setSchemaList=function(a){u=a};this.setJudger=function(a){z=a};this.setFunJudgePublishOper=function(a){G=a};this.setPageOpenWay=function(a){};this.getJqUi=function(){E||(n||(n=new t(g.getSchemaReadOnly(),z)),n.addActionListeners(da),n.setFunJudgePublishOper(G),E=n.getJqUi());return E};this.getHeight=function(){return E.prop("offsetHeight")+1};this.setRemoteImpl=function(a){q=a};this.loadPublishSchemaAttrs=function(a,c,e){R=e;n||(n=
new t(g.getSchemaReadOnly()));(new V(q,function(h){n.setDrawPublishSchemaList(!0);n.setCheckBeforeEditAndPublishScheme(!0);n.setClickEditPublishSchemeListener(W);n.setJudgeHaveMorePublishSchema(!0);ba(h,!1)},function(h){if(701001===h)return n.showMessage(f.get("exeError","\u6267\u884c\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a")+oData+f.get("contactSupport","\uff0c\u8bf7\u8054\u7cfb\u652f\u6301\u4eba\u5458"),"error"),!0})).loadAllPublishSchemaAttrByBizTag(a,c)};var W=function(a,c){(new V(q,function(e){e?
a&&a():g.showPrompt(f.get("currentSchemaNotExist","\u5f53\u524d\u53d1\u5e03\u65b9\u6848\u4e0d\u5b58\u5728"))})).judgeSchemaIsDel(c.getFId())};this.loadAttrs=function(a){R=a;n||(n=new t(g.getSchemaReadOnly(),z),n.setFunJudgePublishOper(G));(new V(q,function(c){ba(c,!1)},function(c){if(701001===c)return n.showMessage(f.get("exeError","\u6267\u884c\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a")+c+f.get("contactSupport","\uff0c\u8bf7\u8054\u7cfb\u652f\u6301\u4eba\u5458"),"error"),!0})).schemaManage_loadAttrs(D,
v)};var X=function(){var a=g.getMaxHeight();null!=a&&n.setMaxHeight(a-30)},ba=function(a,c){if(a){for(var e=[],h=0;h<a.length;h++){var k=new O;k.fromJsonObject(a[h]);e.push(k)}u=e;n.setAllSchemas(e);n.setSchemas(e);c||n.initSchemaList();T();g&&!c&&g.setAnimateHeight(r.getHeight(),X)}};this.setParameterPassToUI=function(a){g=a};var T=function(){for(var a=g.getCurrentSchemaId(),c=n.getSchemas(),e=0;e<c.length;e++)if(c[e].getFId()==a){n.setSelectedSchema(c[e]);break}};this.resize=function(){n.initSchemaList();
g&&g.setAnimateHeight(r.getHeight(),X)};var da={ItemClickListener:function(a){Z(function(){if(g.getDesigner().getConductor().isDirty()){var c=f.get("sureSwitch","\u76f4\u63a5\u5207\u6362"),e=f.get("confirmExitPrefix","\u68c0\u6d4b\u5230\u60a8\u6709\u66f4\u6539\u5185\u5bb9\uff0c\u662f\u5426\u4e0d\u4fdd\u5b58")+c+f.get("confirmExitSuffix","\uff1f\u82e5\u4e0d\u4fdd\u5b58\uff0c\u5c06\u4e22\u5931\u8fd9\u4e9b\u66f4\u6539\u3002"),h=f.get("sureReturn","\u8fd4\u56de\u7f16\u8f91"),k=Q.createFeedbackDialog();
k.setMsgImageType(Q.MSG_CONFIRM);k.setButtonText(Q.RETURN_OK,c);k.setButtonText(Q.RETURN_CANCEL,h);k.setMessage(e);k.showDialog();k.setClosingChecker(function(B){B==Q.RETURN_OK&&m();T();return!0})}else m()},a)},setDefaultAttrListener:function(a){w(a)},deleteListener:function(a,c){A(a,c)},EditListener:function(a,c){p(a,c)},selectedChangedListener:function(a){a=a.getSelected();n.setSelectedSchema(a);a&&a.getFId()&&g.cacheSelectedSchemaName(a.getSchemaName())},searchLisenter:function(a){if(a=a.getText().trim()){for(var c=
n.getAllSchemas(),e=[],h=0;h<c.length;h++)0<=c[h].getSchemaName().toLowerCase().indexOf(a.toLowerCase())&&e.push(c[h]);n.setSchemas(e)}else n.setSchemas(u);T();r.resize()},saveListener:function(){Z(ca,S)},saveAsListener:function(){Z(fa,S)},createListener:function(){Z(ea,null)},exportSqlListener:function(){var a;n.getSelectedSchema()&&(a=n.getSelectedSchema().getFId());a?(new V(q,function(c){(new V).getExportedData(c)},function(c,e){return!1})).schemaManage_exportSql(a):g.showPrompt(f.get("selectScheme",
"\u8bf7\u9009\u62e9\u65b9\u6848"),"prompt")},doSeqListener:function(a,c,e){d(a,function(){u=c;F&&F(u);e&&e();T()},c)}},Z=function(a,c){c&&c.getSchemaType()==O.SCHEMATYPE_SYSTEM&&L?L(function(){(new V(q,function(e){e.publishInfoPerCheck==ha.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST?a&&a():e.publishInfoPerCheck==ha.THEME_IS_DEL?aa($(document.body),"msg-warning",f.get("ThemeIsDel","\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u6765\u6e90\u88ab\u5220\u9664")):e.publishInfoPerCheck==ha.PUBLISHINFO_NOEXIST?aa($(document.body),
"msg-warning",f.get("publishInfoExist","\u53d1\u5e03\u8bb0\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")):e.publishInfoPerCheck==ha.PERMISSION_CANCEL?aa($(document.body),"msg-jurisdiction",f.get("notAuthority","\u60a8\u6ca1\u6709\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u67e5\u770b\u6743\u9650, \u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba")+'"'+e.publishInfoUserName+'"'+f.get("authority","\u6388\u6743")):e.publishInfoPerCheck==ha.PUBLSIHPLAN_DELETE&&aa($(document.body),"msg-warning",f.get("publishPlanExist",
"\u8be5\u5206\u6790\u65b9\u6848\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"))})).checkPublishInfoAndAuthority(D,c)}):a&&a()},aa=function(a,c,e){a=new Q;a.setOptionType(Q.OPTION_OK);a.setButtonText(Q.RETURN_OK,f.get("ISee","\u6211\u77e5\u9053\u4e86"));a.setMessage([e,c]);a.setCustomPainter(function(h,k){var B=$("<div>");B.addClass("sa-ctrl-msgdlg-icon");x.background(B,k[1]);var I=$("<div>");I.addClass("sa-ctrl-msgdlg-content");I.text(k[0]);h.append(B);h.append(I)});a.showDialog(380,280)},ca=function(){var a=
g.getCurrentSchemaId(),c=new O,e=new ja;e.setSchemaContent(g.getDesigner().getJsonModelBook());if(null==a||""==a){var h=new y;h.setSize(null,100);h.setInputWidth(300);h.setScheamList(u);var k=new J($(document.body));k.setSize(450,200);k.setTitle(f.get("saveScheme","\u4fdd\u5b58\u65b9\u6848"));k.setClosingListener(function(B){if(B){B=h.getDefault();var I=h.getInputValue().trim();l(I,h)&&(c.setSchemaName(I),c.setSchemaType(N?O.SCHEMATYPE_SYSTEM:O.SCHEMATYPE_USERDEFINED),c.setIsDefault(B),c.setSource(v),
c.setSeq(u.length),e.setSchemaAttr(c),(B=g.getSaveSchemaListener())&&B(e,h,k,function(){R&&R.animateHeight(0);M(e.getSchemaAttr())}))}});k.showDialog(h.getJqUi())}else c.setFId(a),c.setSchemaName(g.getCurrentSchemaName()),e.setSchemaAttr(c),(a=g.getSaveSchemaListener())&&a(e);setTimeout(function(){h&&h.setFocus()},100)},fa=function(){var a=new y;a.setSize(null,100);a.setInputWidth(300);a.setScheamList(u);var c=new J($(document.body));c.setSize(450,200);c.setTitle(f.get("saveAsScheme","\u53e6\u5b58\u65b9\u6848"));
c.setClosingListener(function(e){if(e){var h=a.getDefault();e=a.getInputValue().trim();if(l(e,a)){var k=new O,B=new ja;k.setSchemaType(N?O.SCHEMATYPE_SYSTEM:O.SCHEMATYPE_USERDEFINED);k.setIsDefault(h);if(h)for(h=0;h<u.length;h++)u[h].setIsDefault(!1);k.setSchemaName(e);k.setSource(v);k.setSeq(u.length);B.setSchemaAttr(k);e=g.getDesigner();B.setSchemaContent(e.getJsonModelBook());(e=g.getSaveSchemaListener())&&e(B,a,c,function(){R&&R.animateHeight(0);M(B.getSchemaAttr())})}}});c.showDialog(a.getJqUi());
setTimeout(function(){a&&a.setFocus()},100)},ea=function(){if(g.getDesigner().getConductor().isDirty()){var a=f.get("sureCreate","\u76f4\u63a5\u65b0\u5efa"),c=f.get("confirmExitPrefix","\u68c0\u6d4b\u5230\u60a8\u6709\u66f4\u6539\u5185\u5bb9\uff0c\u662f\u5426\u4e0d\u4fdd\u5b58")+a+f.get("confirmExitSuffix","\uff1f\u82e5\u4e0d\u4fdd\u5b58\uff0c\u5c06\u4e22\u5931\u8fd9\u4e9b\u66f4\u6539\u3002"),e=f.get("sureReturn","\u8fd4\u56de\u7f16\u8f91"),h=Q.createFeedbackDialog();h.setMsgImageType(Q.MSG_CONFIRM);
h.setButtonText(Q.RETURN_OK,a);h.setButtonText(Q.RETURN_CANCEL,e);h.setMessage(c);h.showDialog();h.setClosingChecker(function(k){k==Q.RETURN_OK&&U();return!0})}else U()},U=function(){var a=new y;a.setSize(null,100);a.setInputWidth(300);a.setScheamList(u);var c=new J($(document.body));c.setSize(450,200);c.setTitle(f.get("createScheme","\u65b0\u5efa\u65b9\u6848"));c.setClosingListener(function(e){if(e){var h=a.getDefault(),k=a.getInputValue().trim();if(l(k,a)){for(e=0;e<u.length;e++){var B=N?O.SCHEMATYPE_SYSTEM:
O.SCHEMATYPE_USERDEFINED;if(u[e].getSchemaType()==B&&u[e].getSchemaName()==k){a.showMessage(f.get("schemeNameCanNotRepeat","\u65b9\u6848\u540d\u79f0\u5df2\u5b58\u5728"),"#FCAD05");return}}e=function(){var I=new O,P=new ja;I.setSchemaType(N?O.SCHEMATYPE_SYSTEM:O.SCHEMATYPE_USERDEFINED);I.setIsDefault(h);if(h)for(var Y=0;Y<u.length;Y++)u[Y].setIsDefault(!1);I.setSchemaName(k);I.setSource(v);I.setSeq(u.length);P.setSchemaAttr(I);I=g.getDesigner();I.setJsonModelBook(null);I.born();P.setSchemaContent(I.getJsonModelBook());
(I=g.getSaveSchemaListener())&&I(P,a,c,function(ra){M(ra)})};(B=g.getReloadMetaFun())?B(e):e()}}});c.showDialog(a.getJqUi());setTimeout(function(){a&&a.setFocus()},100)},l=function(a,c){return null==a||""==a||0==a.length?(c.showMessage(f.get("schemeNameCanNotNull","\u8bf7\u8f93\u5165\u65b9\u6848\u540d\u79f0"),"#FCAD05"),!1):50<a.length?(c.showMessage(f.get("schemeNameCanNotExceedLimit","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26"),"#FCAD05"),!1):!0},p=function(a,c){var e=new y;e.setSize(null,
100);e.setInputWidth(300);var h=new J($(document.body));h.setSize(450,200);var k=a.getSchemaName(),B=e.getJqUi();e.setInputValue(k);h.setTitle(f.get("editScheme","\u4fee\u6539\u65b9\u6848\u540d\u79f0"));h.setClosingListener(function(I){if(I){var P=e.getInputValue().trim();null==P||""==P||0==P.length?e.showMessage(f.get("schemeNameCannotNUll","\u8bf7\u8f93\u5165\u65b9\u6848\u540d\u79f0"),"#FCAD05"):50<P.length?e.showMessage(f.get("schemeNameCanNotExceedLimit","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26"),
"#FCAD05"):b(P,c)?e.showMessage(f.get("existSchemeName","\u65b9\u6848\u540d\u79f0\u91cd\u590d"),"#FCAD05"):k!=P?(new V(q,function(Y){Y&&(a.IsDefault()?(c.text(f.get("def","(\u9ed8\u8ba4)")+P),c.prop("title",f.get("def","(\u9ed8\u8ba4)")+P)):(c.text(P),c.prop("title",P)),a.setSchemaName(P),g.getCurrentSchemaId()==a.getFId()&&(g.cacheCurrentSchemaName(P),g.setCurrentSchemaName(f.get("currentScheme","\u5f53\u524d\u65b9\u6848\uff1a")+P)),g.showSuccess(f.get("editSuccess","\u4fee\u6539\u6210\u529f\u3002")));
h&&h.destroy()},function(Y,ra){return 701001===Y?(e&&e.showMessage(f.get("exeError","\u6267\u884c\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a")+Y+f.get("contactSupport","\uff0c\u8bf7\u8054\u7cfb\u652f\u6301\u4eba\u5458"),"#f62222"),!0):703001===Y||2201001===Y?(e&&e.showMessage(f.get("existSchemeName","\u65b9\u6848\u540d\u79f0\u91cd\u590d"),"#FCAD05"),!0):!1})).schemaManage_editSchema(a.getFId(),P,D,v,a.getSchemaType()):h&&h.destroy()}});h.showDialog(B);setTimeout(function(){e&&e.setFocus()},100)},b=
function(a,c){c=c.parent(".schema-manage-list-item").siblings();for(var e=0;e<c.length;e++)if($(c[e]).find(".schema-manage-list-item-value").text()==a)return!0;return!1},d=function(a,c,e){var h=new V(q,function(I){c&&c()},function(I,P){return!1}),k=[];if(K)for(var B=0;B<e.length;B++)k.push(e[B].toJsonObject());h.schemaManage_updateSeq(a,D,K,0<k.length?k:null)},m=function(){var a=n.getSelectedSchema();a&&null!=a.getFId()?(new V(q,function(c){c&&g&&(g.loadSchemaContent(c.schemaContent),g.cacheCurrentSchemaName(c.schemaName),
g.setCurrentSchemaName(f.get("currentScheme","\u5f53\u524d\u65b9\u6848\uff1a")+c.schemaName),g.cacheCurrentSchemaId(c.fId),g.setCurrentSchemaType(c.schemaType),g.setAnimateHeight(0),c.schemaContent&&c.schemaContent.isTooModern&&(c=new Q,c.setOptionType(Q.OPTION_OK),c.setCustomPainter(function(e,h){var k=$("<div>");k.css("text-align","center");k.css("margin-top","42px");k.text(h);e.append(k)}),c.setMessage(f.get("compatibleHighVersion","\u6b64\u65b9\u6848\u662f\u7531\u9ad8\u7248\u672c\u7684\u8f7b\u5206\u6790\u6240\u521b\u5efa\uff0c\u7cfb\u7edf\u5df2\u81ea\u52a8\u517c\u5bb9\u5176\u4e2d\u7684\u53ef\u8bc6\u522b\u90e8\u5206\u3002")),
c.showDialog(420,210)))},function(c){if(701001===c||702001===c)return g.showError(f.get("exeError","\u6267\u884c\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a")+c+f.get("contactSupport","\uff0c\u8bf7\u8054\u7cfb\u652f\u6301\u4eba\u5458")),!0})).schemaManage_loadContent(a.getFId(),D,v):g.showPrompt(f.get("selectScheme","\u8bf7\u9009\u62e9\u65b9\u6848"))},w=function(a){if(a){n.setSchemaStatus(a);var c=a.IsDefault();if(c)for(var e=0;e<u.length;e++){var h=u[e];h.getFId()!=a.getFId()&&h.setIsDefault(!1)}T();
(new V(q,function(k){!0===k&&(g.showSuccess(c?f.get("setSuccess","\u8bbe\u7f6e\u6210\u529f\u3002"):f.get("cancelSuccess","\u53d6\u6d88\u6210\u529f\u3002")),g.cacheSelectedSchemaName(a.getSchemaName()))},function(k){if(701001===k)return n.setSchemaStatus(a),g.showError(f.get("exeError","\u6267\u884c\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a")+k+f.get("contactSupport","\uff0c\u8bf7\u8054\u7cfb\u652f\u6301\u4eba\u5458")),!0})).schemaManage_setDefaultAttr(a,D,n.getJudgeHaveMorePublishSchema())}else g.showPrompt(f.get("selectScheme",
"\u8bf7\u9009\u62e9\u65b9\u6848"))},A=function(a,c){if(n.getJudgeHaveMorePublishSchema()&&1==n.getAllSchemas().length)g.showPrompt(f.get("atLeastOneSchema","\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u53d1\u5e03\u65b9\u6848"));else if(a){var e=new qa;e.setText(f.get("confrimDeleteShceme","\u5220\u9664\u65b9\u6848\u201c#1\u201d\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u8be5\u65b9\u6848\u5417\uff1f").replace("#1",a.getSchemaName()));e.setConfirmedListener(function(h){h&&(new V(q,
function(k){if(!0===k){a.getFId()==g.getCurrentSchemaId()&&(g.cacheCurrentSchemaId(null),g.cacheCurrentSchemaName(null),g.setCurrentSchemaName(""));g.cacheSelectedSchemaName(null);g.showSuccess(f.get("deleteSuccess","\u5220\u9664\u6210\u529f"));for(k=0;k<u.length;k++){var B=u[k];B.getFId()==a.getFId()&&u.splice(k,1)}var I=n.getSchemas();for(k=0;k<I.length;k++)B=I[k],B.getFId()==a.getFId()&&I.splice(k,1);n.setSchemas(I);T();F&&F(u);r.resize()}else"noSchema"==k&&g.showPrompt(f.get("deleteSchemaTip",
"\u60a8\u5728\u5176\u4ed6\u9875\u9762\u7f16\u8f91\u8be5\u53d1\u5e03\u8bb0\u5f55\u65f6\uff0c\u5220\u9664\u4e86\u5176\u4ed6\u65b9\u6848\uff0c\u8bf7\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u53d1\u5e03\u65b9\u6848\u3002"))},function(k){if(701001===k)return g.showError(f.get("exeError","\u6267\u884c\u9519\u8bef\uff0c\u9519\u8bef\u7801\uff1a")+k+f.get("contactSupport","\uff0c\u8bf7\u8054\u7cfb\u652f\u6301\u4eba\u5458")),!0})).schemaManage_deleteSchema(a.getFId(),D,v,n.getJudgeHaveMorePublishSchema())});e.show(c)}},
M=function(a){u.unshift(a);n.setSchemas(u);n.setSelectedSchema(a);F&&F(u);r.resize()}}})();
//qingVersionTag: 20250324