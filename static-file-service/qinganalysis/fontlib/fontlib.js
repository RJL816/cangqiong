var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(u){var N=0;return function(){return N<u.length?{done:!1,value:u[N++]}:{done:!0}}};$jscomp.arrayIterator=function(u){return{next:$jscomp.arrayIteratorImpl(u)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(u,N,h){if(u==Array.prototype||u==Object.prototype)return u;u[N]=h.value;return u};$jscomp.getGlobal=function(u){u=["object"==typeof globalThis&&globalThis,u,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var N=0;N<u.length;++N){var h=u[N];if(h&&h.Math==Math)return h}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(u,N){var h=$jscomp.propertyToPolyfillSymbol[N];if(null==h)return u[N];h=u[h];return void 0!==h?h:u[N]};
$jscomp.polyfill=function(u,N,h,T){N&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(u,N,h,T):$jscomp.polyfillUnisolated(u,N,h,T))};$jscomp.polyfillUnisolated=function(u,N,h,T){h=$jscomp.global;u=u.split(".");for(T=0;T<u.length-1;T++){var U=u[T];if(!(U in h))return;h=h[U]}u=u[u.length-1];T=h[u];N=N(T);N!=T&&null!=N&&$jscomp.defineProperty(h,u,{configurable:!0,writable:!0,value:N})};
$jscomp.polyfillIsolated=function(u,N,h,T){var U=u.split(".");u=1===U.length;T=U[0];T=!u&&T in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var L=0;L<U.length-1;L++){var X=U[L];if(!(X in T))return;T=T[X]}U=U[U.length-1];h=$jscomp.IS_SYMBOL_NATIVE&&"es6"===h?T[U]:null;N=N(h);null!=N&&(u?$jscomp.defineProperty($jscomp.polyfills,U,{configurable:!0,writable:!0,value:N}):N!==h&&(void 0===$jscomp.propertyToPolyfillSymbol[U]&&(h=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[U]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(U):$jscomp.POLYFILL_PREFIX+h+"$"+U),$jscomp.defineProperty(T,$jscomp.propertyToPolyfillSymbol[U],{configurable:!0,writable:!0,value:N})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(u){if(u)return u;var N=function(L,X){this.$jscomp$symbol$id_=L;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:X})};N.prototype.toString=function(){return this.$jscomp$symbol$id_};var h="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",T=0,U=function(L){if(this instanceof U)throw new TypeError("Symbol is not a constructor");return new N(h+(L||"")+"_"+T++,L)};return U},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(u){if(u)return u;u=Symbol("Symbol.iterator");for(var N="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),h=0;h<N.length;h++){var T=$jscomp.global[N[h]];"function"===typeof T&&"function"!=typeof T.prototype[u]&&$jscomp.defineProperty(T.prototype,u,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return u},"es6",
"es3");$jscomp.iteratorPrototype=function(u){u={next:u};u[Symbol.iterator]=function(){return this};return u};$jscomp.iteratorFromArray=function(u,N){u instanceof String&&(u+="");var h=0,T=!1,U={next:function(){if(!T&&h<u.length){var L=h++;return{value:N(L,u[L]),done:!1}}T=!0;return{done:!0,value:void 0}}};U[Symbol.iterator]=function(){return U};return U};$jscomp.polyfill("Array.prototype.keys",function(u){return u?u:function(){return $jscomp.iteratorFromArray(this,function(N){return N})}},"es6","es3");
$jscomp.findInternal=function(u,N,h){u instanceof String&&(u=String(u));for(var T=u.length,U=0;U<T;U++){var L=u[U];if(N.call(h,L,U,u))return{i:U,v:L}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(u){return u?u:function(N,h){return $jscomp.findInternal(this,N,h).v}},"es6","es3");
(function(){function u(){var L,X,Y,t,ba=[];this.setId=function(a){L=a};this.getId=function(){return L};this.setCode=function(a){X=a};this.getCode=function(){return X};this.setDisplayName=function(a){Y=a};this.getDisplayName=function(){return Y};this.setPreset=function(a){t=a};this.isPreset=function(){return t};this.setFontResources=function(a){ba=a};this.getFontResources=function(){return ba};this.fromJsonObject=function(a){if(a){L=a.id;X=a.code;Y=a.displayName;t=a.isPreset;a=a.fontResourcePos;var E=
[],n;for(n in a){var ea=new N;ea.fromJsonObject(a[n]);E.push(ea)}ba=E}};this.toJsonObject=function(){var a={};a.id=L;a.code=X;a.displayName=Y;a.isPreset=t;a.fontResourcePos=[];for(var E in ba){var n=ba[E].toJsonObject();a.fontResourcePos.push(n)}return a};this.copy=function(){var a=new u;a.setId(L);a.setCode(X);a.setDisplayName(Y);a.setPreset(t);var E=[],n;for(n in ba)E.push(ba[n].copy());a.setFontResources(E);return a}}function N(){var L,X,Y,t,ba,a,E;this.setId=function(n){L=n};this.getId=function(){return L};
this.setFontId=function(n){X=n};this.getFontId=function(){return X};this.setPath=function(n){Y=n};this.getPath=function(){return Y};this.setOrder=function(n){t=n};this.getOrder=function(){return t};this.setPathType=function(n){ba=n};this.getPathType=function(){return ba};this.getPathTypeEnum=function(){return h.FontResourceType.convert(ba)};this.setFileSize=function(n){a=n};this.getFileSize=function(){return a};this.setFileDisplayName=function(n){E=n};this.getFileDisplayName=function(){return E};
this.fromJsonObject=function(n){n&&(L=n.id,X=n.fontId,Y=n.path,t=n.order,ba=n.pathType,a=n.fileSize,E=n.fileDisplayName)};this.toJsonObject=function(){var n={};n.id=L;n.fontId=X;n.path=Y;n.order=t;n.pathType=ba;n.fileSize=a;n.fileDisplayName=E;return n};this.copy=function(){var n=new N;n.setId(L);n.setFontId(X);n.setPath(Y);n.setOrder(t);n.setPathType(ba);n.setFileSize(a);n.setFileDisplayName(E);return n}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==
typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.fontlib&&(com.kingdee.bos.qing.fontlib={});"undefined"==typeof com.kingdee.bos.qing.fontlib.model&&(com.kingdee.bos.qing.fontlib.model={});var h=com.kingdee.bos.qing.fontlib.model;h.FontModel=function(){var L,X,Y,t,ba,a,E,n,ea,y,V;this.setId=function(O){L=O};this.getId=function(){return L};this.setCode=function(O){X=O};this.getCode=function(){return X};
this.setDisplayName=function(O){Y=O};this.getDisplayName=function(){return Y};this.setCreatorId=function(O){t=O};this.getCreatorId=function(){return t};this.setCreatorName=function(O){ba=O};this.getCreatorName=function(){return ba};this.setModifierId=function(O){a=O};this.getModifierId=function(){return a};this.setModifierName=function(O){E=O};this.getModifierName=function(){return E};this.setCreateTime=function(O){n=O};this.getCreateTime=function(){return n};this.setModifyTime=function(O){ea=O};
this.getModifyTime=function(){return ea};this.getCreateFormatTime=function(){return y};this.getModifyFormatTime=function(){return V};this.fromJsonObject=function(O){O&&(L=O.id,X=O.code,Y=O.displayName,t=O.creatorId,ba=O.creatorName,a=O.modifierId,E=O.modifierName,n=O.createTime,ea=O.modifyTime,y=O.createFormatTime,V=O.modifyFormatTime)};this.toJsonObject=function(){var O={};O.id=L;O.code=X;O.displayName=Y;O.creatorId=t;O.creatorName=ba;O.modifierId=a;O.modifierName=E;O.createTime=n;O.modifyTime=ea;
return O}};h.FontInfo=u;h.FontResource=N;h.UploadFileInfo=function(){var L,X,Y;this.setFileName=function(t){L=t};this.getFileName=function(){return L};this.setDisplayName=function(t){X=t};this.getDisplayName=function(){return X};this.setFileSize=function(t){Y=t};this.getFileSize=function(){return Y};this.fromJsonObject=function(t){t&&(L=t.fileName,X=t.displayName,Y=t.fileSize)};this.toJsonObject=function(){var t={};t.fileName=L;t.displayName=X;t.fileSize=Y;return t}};h.ImportFontModel=function(){var L,
X,Y=-1;this.setCode=function(t){L=t};this.getCode=function(){return L};this.setDisplayName=function(t){X=t};this.getDisplayName=function(){return X};this.setHandleStrategy=function(t){Y=t};this.getHandleStrategy=function(){return Y};this.toJsonObject=function(){var t={};t.code=L;t.displayName=X;t.handleStrategy=Y;return t};this.fromJsonObject=function(t){t&&(L=t.code,X=t.displayName,Y=t.handleStrategy)}};var T,U;(function(){var L=com.kingdee.bos.qing.framework.common;U=L.MultilanguageManager;L=com.kingdee.bos.qing.fontlib.common;
T=U.createPackageAccessor(L)})();h.ConflictImportFontHandleType=new function(){this.IGNORE=0;this.OVERWRITE=1;this.RENAME=2};h.FontResourceType=new function(){function L(X,Y){this.name=function(){return Y};this.index=function(){return X}}this.QING=new L(0,T.get("uploadFont","\u4e0a\u4f20\u5b57\u4f53\u6587\u4ef6"));this.LOCAL=new L(1,T.get("localFont","\u5ba2\u6237\u7aef\u672c\u5730\u5b57\u4f53"));this.OTHER=new L(2,T.get("fontLink","\u7f51\u7edc\u94fe\u63a5"));this.PRESET=new L(3,T.get("presetFont",
"\u7cfb\u7edf\u9884\u7f6e"));this.convert=function(X){switch(X){case 0:return this.QING;case 1:return this.LOCAL;case 2:return this.OTHER;default:return null}}}})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.fontlib&&(com.kingdee.bos.qing.fontlib={});"undefined"==typeof com.kingdee.bos.qing.fontlib.common&&(com.kingdee.bos.qing.fontlib.common={});var u=com.kingdee.bos.qing.fontlib.common;u.FontLibFacade=function(t,ba,a,E){N.call(this,t,ba,a,E);
var n=this.protectedMethod,ea=function(y){y.appID="qing"};this.loadAllFontIds=function(y){y={searchContent:y};ea(y);n.remote("loadAllFontIds",y)};this.removeFonts=function(y){y={fontIds:JSON.stringify(y)};ea(y);n.remote("batchRemoveFonts",y)};this.loadAllFonts=function(y,V,O){y={pageSize:V,targetPage:y,searchContent:O};ea(y);n.remote("loadAllFonts",y)};this.loadFontInfo=function(y){y={fontId:y};ea(y);n.remote("loadFontInfo",y)};this.updateFontInfo=function(y){y={fontInfo:JSON.stringify(y.toJsonObject())};
ea(y);n.remote("updateFont",y)};this.addFont=function(y){y={fontInfo:JSON.stringify(y.toJsonObject())};ea(y);n.remote("addFont",y)};this.getUploadFileInfo=function(y){y={fileName:y};ea(y);n.remote("getUploadFileInfo",y)};this.isFontExist=function(y){y={fontId:y};ea(y);n.remote("isFontExist",y)};this.checkPermission=function(){var y={};ea(y);n.remote("isPermitted",y)};this.exportFonts=function(y){y={selectedFontId:JSON.stringify(y)};ea(y);n.remote("exportFonts",y)};this.parseImportFile=function(y){y=
{importFileName:y};ea(y);n.remote("parseImportFile",y)};this.importSelectedFonts=function(y,V){y={fileName:y,selectedFontCodes:JSON.stringify(V)};ea(y);n.remote("importSelectedFonts",y)};this.importConflictFonts=function(y,V){for(var O=[],ya=0;ya<V.length;ya++)O.push(JSON.stringify(V[ya].toJsonObject()));y={fileName:y,conflictFonts:JSON.stringify(O)};ea(y);n.remote("importConflictFonts",y)}};u.FontLibRemoteImpl=function(){h.call(this);var t;this.getRemoteUrl=function(){return t};this.setRemoteUrl=
function(ba){t=ba}};var N,h,T,U,L,X,Y;(function(){var t=com.kingdee.bos.qing.framework.common;N=t.AbstractFacade;h=t.AbstractRemoteCall;T=com.kingdee.bos.qing.framework.common.AbstractIcons;X=t.MultilanguageManager;Y=t.TabbedUiUtil;t=com.kingdee.bos.qing.fontlib.common;L=X.createPackageAccessor(t);t=com.kingdee.bos.qing.common;U=t.Util})();u.Icons=new function(){T.call(this);var t=this.protectedMethod;this.protectedInit=function(ba,a){ba=com.kingdee.bos.qing.fontlib.skin.ComboIcon;if(!ba)throw Error("com.kingdee.bos.qing.macro.ComboIcon not found.");
ba.define(a,"background");t.registIcon(0,0,"nodata");ba.define(a,"tm-publish");t.registIcon(0,0,"icon-side-close");a.setStartPosition(33,0);a.setIconSize(17,14);t.registIcon(0,0,"icon-side-open");ba.define(a,"font-library");t.registIcon(0,0,"delete_hover");t.registIcon(1,0,"delete");t.registIcon(2,0,"delete_disabled");t.registIcon(0,1,"font-file-icon");t.registIcon(0,2,"upload-file-button-icon");ba.define(a,"group-theme-no-data");t.registIcon(0,0,"font-library-no-data");ba.define(a,"no-font-resource");
t.registIcon(0,0,"no-font-resource")}};u.FontLibUtil=new function(){var t=U.decodeParamFromUrl(window.location.search,"path"),ba=/[`~!@#$%^&*()+<>?:"{},.\/;'[\]]/im,a=/[\u00b7\uff01#\uffe5\uff08\u2014\u2014\uff09\uff1a\uff1b\u201c\u201d\u2018\u3001\uff0c|\u300a\u3002\u300b\uff1f\u3001\u3010\u3011[\]]/im;this.jumpToFontLibDetailPanel=function(E,n){var ea=t+"/qing/fontLibDetail.do";n&&0<n.length?(ea=U.appendParamToUrl(ea,"fontId",n),E=L.get("editFont","\u7f16\u8f91\u5b57\u4f53 - ")+E,n=ea):(E=L.get("newFont",
"\u65b0\u5efa\u5b57\u4f53"),n=(new Date).getTime());Y.openNewTab(E,ea,n,Y.QING_ANALYSIS)};this.checkCustomName=function(E){return a.test(E)||ba.test(E)?!1:!0};this.checkCustomStrExistQuotation=function(E){return/["']/.test(E)};this.equals=function(E,n){if(void 0===E||null===E)E="";if(void 0===n||null===n)n="";return E===n}}})();(function(){function u(C,I){Aa.call(this);var D=this,k=D.protectedMethod,e=I?I.copy():new ya,l,Q,M,F,G=com.kingdee.bos.qing.fontlib.common.Icons,p=["attachment","local","link"],W=[".ttf",".ttc",".woff",".otf",".woff2"],da,S,f,v,w,Z,m,B,q,c,d,H,K=!1;(function(){var J=I?a.get("editFontResource","\u7f16\u8f91\u5b57\u4f53\u6765\u6e90"):a.get("addFontResource","\u6dfb\u52a0\u5b57\u4f53\u6765\u6e90");k.setTitle(J);k.setSelectable(!0);D.setSize(400,300);k.setContentPaneCreator(function(){if(!da){da=$("<div>");
da.addClass("font-lib-resource-add-edit-dialog-main");na(da);var z=da;w=$("<div>");w.addClass("font-lib-resource-content");var b=e.getPathType();ka(p[b]?p[b]:p[0]);z.append(w)}return da});k.setClosingChecker2(function(z){if(K)return k.getMessageCurtain().showPrompt(a.get("fileUploading","\u6587\u4ef6\u6b63\u5728\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002\u3002"),2E3),!1;z=F.getUserObject();var b=!1;z===V.LOCAL.index()?(b=ea.checkCustomStrExistQuotation(l.getText()))&&k.getMessageCurtain().showPrompt(a.get("illegalFontLocalName",
"\u5ba2\u6237\u7aef\u672c\u5730\u5b57\u4f53\u540d\u79f0\u4e0d\u80fd\u5305\u542b\u5355\u5f15\u53f7\u3001\u53cc\u5f15\u53f7\u3002"),2E3):z===V.OTHER.index()&&(b=ea.checkCustomStrExistQuotation(Q))&&k.getMessageCurtain().showPrompt(a.get("illegalFontLinkName","\u7f51\u7edc\u94fe\u63a5\u4e0d\u80fd\u5305\u542b\u5355\u5f15\u53f7\u3001\u53cc\u5f15\u53f7\u3002"),2E3);if(b||ia())return!1;z=F.getUserObject();if(z===V.LOCAL.index()?x(z,l.getText()):z===V.OTHER.index()&&x(z,Q.getText()))return k.getMessageCurtain().showPrompt(a.get("fileDuplicated",
"\u5b57\u4f53\u6765\u6e90\u5df2\u5b58\u5728\u3002"),2E3),!1;z=F.getUserObject();e.setPathType(z);z===V.LOCAL.index()?e.setPath(l.getText()):z===V.QING.index()?(e.setPath(M.getFileName()),e.setFileDisplayName(M.getDisplayName()),e.setFileSize(M.getFileSize())):z===V.OTHER.index()&&e.setPath(Q.getText());d&&d(e);return!0},function(z){k.destroy();return!0});k.setClosingAction(function(z){k.destroy();return!0})})();this.setFinalCallBack=function(J){d=J};this.setCheckFileExist=function(J){H=J};var x=function(J,
z,b){var g=!0;if(I){var r=I.getPathType();J!==V.QING.index()&&(g=I.getPath(),g=J!==r||z!==g)}return g&&H(J,z,b)},ia=function(){var J=F.getUserObject();if(J===V.LOCAL.index())return J=$.trim(l.getText()),(J=!J||0===J.length)&&k.getMessageCurtain().showPrompt(a.get("inputName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002"),2E3),J;if(J===V.QING.index())return(J=!M)&&k.getMessageCurtain().showPrompt(a.get("uploadAttachment","\u8bf7\u4e0a\u4f20\u9644\u4ef6\u3002"),2E3),J;if(J===V.OTHER.index())return J=$.trim(Q.getText()),
(J=!J||0===J.length)&&k.getMessageCurtain().showPrompt(a.get("inputURL","\u8bf7\u8f93\u5165URL\u3002"),2E3),J},na=function(J){var z=$("<div>"),b=a.get("sourceType","\u6765\u6e90\u65b9\u5f0f");z.text(b);z.attr("title",b);z.addClass("font-lib-resource-dialog-source-type-text");F=new sa;F.setItemModels(p);b=e.getPathType();F.setUserObject(b);F.setSelected(p[b]?p[b]:p[0]);F.setCustomPainter(function(r,A,P){r="";switch(P){case p[0]:r=a.get("uploadFont","\u4e0a\u4f20\u5b57\u4f53\u6587\u4ef6");break;case p[1]:r=
a.get("localFont","\u5ba2\u6237\u7aef\u672c\u5730\u5b57\u4f53");break;case p[2]:r=a.get("fontLink","\u7f51\u7edc\u94fe\u63a5")}P=$("<div>");P.text(r);A.append(P)});F.addSelectedChangedListener(qa);b=F.getJqUi();b.addClass("font-lib-resource-dialog-combo-box");var g=$("<div>");g.addClass("font-lib-resource-dialog-source-type");g.append(z);g.append(b);J.append(g)},qa=function(J,z,b){ka(b)},ka=function(J){switch(J){case p[0]:F.setUserObject(V.QING.index());ma();break;case p[1]:F.setUserObject(V.LOCAL.index());
if(!S){S=$("<div>");J=$("<div>");J.addClass("font-lib-resource-dialog-column");var z=$("<div>"),b=a.get("name","\u5b57\u4f53\u540d\u79f0");z.text(b);z.attr("title",b);z.addClass("font-lib-resource-dialog-path-title");var g=a.get("fontResourceNameType","\u6b64\u5904\u7684\u540d\u79f0\u662f\u6307\u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u5df2\u5b89\u88c5\u5b57\u4f53\u7684\u540d\u79f0\u3002");b=$("<div>");b.text(g);g=new U;g.setTipsSize(200,55);g.setText(b);b=g.getJqUi();b.addClass("font-lib-resource-dialog-path-prompt");
z.appendTo(J);b.appendTo(J);l=new y;z=e.getPathType();b="";z===V.LOCAL.index()&&(b=(z=e.getPath())&&0<z.length?z:"");l.setText(b);z=l.getJqUi();z.addClass("font-lib-resource-path-input");S.append(J);S.append(z);w.append(S)}S.show();f&&f.hide();v&&v.hide();break;case p[2]:F.setUserObject(V.OTHER.index());if(!v){v=$("<div>");J=$("<div>");J.addClass("font-lib-resource-dialog-column");b=$("<div>");g=a.get("link","URL");b.text(g);b.attr("title",g);b.addClass("font-lib-resource-dialog-path-title");var r=
a.get("fontResourceLinkType","\u6b64\u5904\u7684URL\u662f\u6307\u5b57\u4f53\u7684\u5916\u90e8\u5f15\u7528\u94fe\u63a5\uff0c\u901a\u8fc7\u8be5\u94fe\u63a5\u53ef\u4ee5\u83b7\u53d6\u5b57\u4f53\u3002");g=$("<div>");g.text(r);r=new U;r.setTipsSize(250,55);r.setText(g);g=r.getJqUi();g.addClass("font-lib-resource-dialog-path-prompt");b.appendTo(J);g.appendTo(J);Q=new y;e.getPathType()===V.OTHER.index()&&(z=(z=e.getPath())&&0<z.length?z:"");z&&Q.setText(z);Q.setPlaceholder("https://www.XXX.com/xx.ttf");z=
Q.getJqUi();z.addClass("font-lib-resource-path-input");v.append(J);v.append(z);w.append(v)}S&&S.hide();f&&f.hide();v.show()}},R=function(){M=null;B.empty();Z.show();m.hide()},ma=function(){if(!f){f=$("<div>");var J=$("<div>");J.addClass("font-lib-resource-dialog-column");var z=$("<div>"),b=a.get("attachment","\u5b57\u4f53\u6587\u4ef6");z.text(b);z.attr("title",b);z.addClass("font-lib-resource-dialog-path-title");var g=a.get("uploadFileTip","\u652f\u6301ttf\u3001ttc\u3001otf\u3001woff\u3001woff2\u6587\u4ef6\u3002");
b=$("<div>");b.text(g);g=new U;g.setTipsSize(260,40);g.setText(b);b=g.getJqUi();b.addClass("font-lib-resource-dialog-path-prompt");z.appendTo(J);b.appendTo(J);z=$("<div>");G.background(z,"upload-file-button-icon");z=new L(a.get("uploadFile","\u4e0a\u4f20\u6587\u4ef6"),z);z.setFinalCallBack(oa);Z=z.getJqUi();Z.addClass("font-lib-resource-upload-file-button");m=$("<div>");m.addClass("font-lib-resource-upload-file-info");z=$("<div>");G.background(z,"font-file-icon");z.addClass("font-lib-resource-font-file-icon");
B=$("<div>");B.addClass("font-lib-resource-upload-file-info-text");if(e.getPathType()===V.QING.index()){var r=ra(e.getFileDisplayName(),pa(e.getFileSize()));M=new wa;M.setFileName(e.getPath());M.setDisplayName(e.getFileDisplayName());M.setFileSize(e.getFileSize())}r&&B.append(r);c=$("<div>");G.background(c,"delete");c.on("mouseover mouseout",function(A){"mouseover"===A.type?G.background(c,"delete_hover"):"mouseout"===A.type&&G.background(c,"delete")});c.addClass("font-lib-resource-upload-file-info-delete");
c.on("click",function(){R()});q=$("<div>");q.addClass("font-lib-resource-upload-file-loading");q.css("background-image",la.getIconUrl("common","loading.gif"));q.hide();m.append(z);m.append(B);m.append(q);m.append(c);f.append(J);f.append(Z);f.append(m);w.append(f);M?(Z.hide(),m.show()):(Z.show(),m.hide())}S&&S.hide();f.show();v&&v.hide()},oa=function(){var J=$("<input type='file' id='uploadBtn'>");J.addClass("font-lib-upload-file");J.attr("accept",W);J.on("change",function(z){K=!0;if(z=z.currentTarget.files[0]){var b=
z.name,g=z.size,r=b.lastIndexOf(".");r=b.substring(r,b.length).toLowerCase();da.find("#uploadBtn").val("");var A=!1;for(P in W)if(r===W[P]){A=!0;break}if(A)if(0===g)K=!1,k.getMessageCurtain().showPrompt(a.get("uploadFileIsNull","\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a\u7a7a\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3);else if(52428800<=g)K=!1,k.getMessageCurtain().showPrompt(a.get("fileTooLarge","\u6587\u4ef6\u592a\u5927\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3);else{var P=ra(b,pa(g));B.append(P);
Z.hide();q.show();c.hide();m.show();(new N(function(ja){M=new wa;M.setFileName(ja);M.setDisplayName(b);M.setFileSize(g);x(V.QING.index(),b,g)?(k.getMessageCurtain().showPrompt(a.get("fileDuplicated","\u5b57\u4f53\u6765\u6e90\u5df2\u5b58\u5728\u3002"),2E3),M=null,R()):(q.hide(),c.show())},function(){R()},function(){K=!1})).upload(z,k.getMessageCurtain(),!1)}else K=!1,k.getMessageCurtain().showPrompt(a.get("fileTypeIncorrect","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),
2E3)}J.val("")});J.click()},ra=function(J,z){var b=$("<div>"),g=$("<div>"),r=$("<div>");g.addClass("font-lib-detail-edit-dialog-upload-file-name");g.text(J);r.text(" ("+z+") ");r.addClass("font-lib-detail-edit-dialog-upload-file-size");b.append(g);b.append(r);return b},pa=function(J){return 1048576<=J?(J/1048576).toFixed(2)+"MB":1024<=J?(J/1024).toFixed(2)+"KB":J+"B"}}function N(C,I,D){var k,e,l,Q;this.upload=function(p,W,da){k=W;da&&F();W=new FormData;W.append("filename",p);p=new XMLHttpRequest;
p.addEventListener("error",M,!1);var S=com.kingdee.bos.qing.framework.common.RemoteFrameworkRegister.getUploadUrl();da&&p.upload.addEventListener("progress",G,!1);p.open("post",S,!0);p.onload=function(f){200===this.status&&(f=JSON.parse(this.response),"number"==typeof f.errorCode&&3099003===f.errorCode?(I&&I(),k.showError(f.errorMessage)):(f=f.data,C&&C(f)),e&&e.remove(),Q&&Q.remove(),D&&D())};p.send(W)};var M=function(p){k&&k.showPrompt(a.get("uploadFailed","\u4e0a\u4f20\u5931\u8d25\u3002"))},F=
function(){e=$("<div>");e.addClass("font-importing-exporting-main");var p=$(document.body);Q=$("<div class='font-ctrl-modallayer'>");Q.appendTo(p);l=$("<progress value='0' max='100'>");l.addClass("font-importing-upload-progress");var W=$("<div>");W.addClass("font-importing-exporting-text");W.text(a.get("uploading","\u6b63\u5728\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u5019"));e.append(l);e.append(W);p.append(e)},G=function(p){var W=l.get(0);p.lengthComputable&&(W.max=p.total,W.value=p.loaded)}}function h(C,
I,D){var k,e,l=!!D,Q,M;this.setInputCallBack=function(G){M=G};var F=function(){M&&M()};this.setEnabled=function(G){Q=G;e&&e.setEnabled(G)};this.getText=function(){return"undefined"==typeof e?null:$.trim(e.getText())};this.setText=function(G){I=G;e&&e.setText(G)};this.setWidth=function(G){k&&k.css("width",G)};this.getJqUi=function(){if(!k){k=$("<div>");k.addClass("font-lib-input");k.css("width","230");var G=$("<div>");G.addClass("font-lib-input-title");var p=$("<span>");p.css("font-size","12px");p.text(C);
if(l){var W=$("<span>");W.text("*");W.css("color","red")}G.append(p);l&&G.append(W);e=new y;e.setEnabled(Q);e.addEditedListener(F);I&&e.setText(I);p=e.getJqUi();p.addClass("font-lib-input-frame");k.append(G);k.append(p)}return k}}function T(){var C,I,D,k,e,l=!0,Q=!1,M=!1;this.getJqUi=function(){C||(C=$("<div>"),C.addClass("font-lib-expansion"),F(C),I=$("<div>"),I.addClass("font-lib-expansion-maim"),!M&&I.css("paddingLeft","10px"),I.append(D),C.append(I));return C};this.setContentPanel=function(G){D=
G;I&&I.empty();I&&I.append(D)};this.setTitle=function(G){k=G};this.setPrompt=function(G){e=G};this.setPromptShow=function(G){Q=G};this.setSwitchVisual=function(G){M=G};var F=function(G){var p=$("<div>");p.addClass("font-lib-expansion-title");var W=$("<div>");W.addClass("font-lib-expansion-switch-triangle");var da={transform:"rotate(0deg)",transition:"transform 100ms linear"},S={transform:"rotate(-90deg)",transition:"transform 100ms linear"},f=$("<div>");f.addClass("font-lib-expansion-switch");f.on("click",
function(){l?(W.css(S),I.hide()):(W.css(da),I.show());l=!l});f.append(W);M?f.show():f.hide();var v=$("<span>");v.addClass("font-lib-expansion-title-name");v.text(k);!M&&v.css("marginLeft","10px");if(Q){var w=$("<div>");w.text(e);var Z=new U;Z.setText(w);Z.setTipsSize(350,55);w=Z.getJqUi();w.css("margin-top","4px");w.addClass("font-lib-expansion-prompt")}p.append(f);p.append(v);Q&&p.append(w);G.append(p)}}function U(){var C,I,D,k;this.setText=function(e){I=e};this.setTipsSize=function(e,l){D=e;k=l};
this.getJqUi=function(){if(!C){C=$("<div>");var e=new ua;e.setIconType(ua.ICON_TYPE_QUESTION);e.setTipsSize(D,k);e.setTipsHtml(I);e=e.getJqUi();e.addClass("font-lib-prompt-help-icon");C.append(e)}return C}}function L(C,I){var D,k;this.setFinalCallBack=function(l){k=l};var e=function(){k&&k()};this.getJqUi=function(){if(!D){D=$("<div>");D.addClass("font-lib-upload-file-button");I&&I.addClass("font-lib-resource-upload-file-button-icon");I&&I.appendTo(D);var l=$("<div>");l.addClass("font-lib-resource-upload-file-button-text");
l.text(C);l.attr("title",C);D.append(l);D.on("click",e)}return D}}function X(){function C(m){KTDefaultCellRender.call(this,m);var B=this,q=this.paintCellUI;this.paintCellUI=function(d,H){var K=B.getCurrentRowIdx(),x=B.getCurrentRow(),ia=B.getCurrentColIdx();x=x.getUserObject();K<E.getHeadRowCount()?q(d,H):0===ia?(H=$("<div>"),H.text(x.getCode()),H.addClass("font-lib-import-table-code"),H.appendTo(d)):1===ia?(H=$("<div>"),H.text(x.getDisplayName()),H.addClass("font-lib-import-table-displayName"),H.appendTo(d)):
2===ia&&(d=E.createCtrlInCell(d,B.getCellWidth(),B.getCellHeight(),sa),d.setItemModels([aa.IGNORE,aa.OVERWRITE,aa.RENAME]),d.setUserObject(x),H=(H=l[x.getCode()])?H.getSelected():aa.IGNORE,d.setSelected(H),d.setCustomPainter(c),l[x.getCode()]=d)};var c=function(d,H,K){switch(K){case aa.IGNORE:d=a.get("ignoreBtn","\u5ffd\u7565");break;case aa.OVERWRITE:d=a.get("overwriteBtn","\u8986\u76d6");break;case aa.RENAME:d=a.get("renameBtn","\u91cd\u547d\u540d");break;default:d=""}K=$("<div>");K.text(d);K.appendTo(H)}}
Aa.call(this);var I=this,D=I.protectedMethod,k,e,l={},Q,M,F,G,p;(function(){D.setTitle(a.get("exportFonts","\u5bfc\u5165\u5b57\u4f53"));D.setSelectable(!0);I.setSize(600,450);D.setContentPaneCreator(function(){if(!k){k=$("<div>");if(e&&0<e.length)for(var m=0;m<e.length;m++)e[m].setHandleStrategy(aa.IGNORE);m=k;var B=$("<div>");var q=1<M?a.get("importResultTips","\u6210\u529f\u5bfc\u5165#1\u4e2a\u5b57\u4f53\uff0c\u4ee5\u4e0b\u5b57\u4f53\u7f16\u7801\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002"):a.get("importResultTips2",
"\u6210\u529f\u5bfc\u5165#1\u4e2a\u5b57\u4f53\uff0c\u4ee5\u4e0b\u5b57\u4f53\u7f16\u7801\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002");q=q.replace("#1",M);B.text(q);B.attr(q);B.addClass("font-lib-import-conflict-tips");B.appendTo(m);m=k;B=$("<div>");B.addClass("font-lib-import-conflict-operation");da(B);S(B);f(B);B.appendTo(m);Z(k)}return k});D.setClosingChecker2(function(m){m=[];for(var B in l){var q=l[B],c=q.getSelected();c!==aa.IGNORE&&(q=q.getUserObject(),q.setHandleStrategy(c),m.push(q))}if(0===
m.length)return D.destroy(),G&&G(!1,!1),!0;W(m)},function(m){D.destroy();G&&G(!1,void 0);return!0});D.setClosingAction(function(m){D.destroy();return!0})})();var W=function(m){(new ta(Q,function(B){D.destroy();B=B.isOverwritePreset;G&&G(!0,B)},function(B){D.getMessageCurtain().showPrompt(a.get("handleConflictFontsFailed","\u5904\u7406\u5931\u8d25\u3002"),3E3);return!1})).importConflictFonts(F,m)};this.setRemoteImpl=function(m){Q=m};this.setImportFileName=function(m){F=m};this.setConflictImportFontModels=
function(m){e=m?m:[]};this.setSuccessImportQuantity=function(m){M=m};this.setHandleFinalCallBack=function(m){G=m};var da=function(m){v(a.get("ignoreAllBtn","\u5168\u90e8\u5ffd\u7565"),!0,function(){w(aa.IGNORE)},m).css("margin-left","3px")},S=function(m){v(a.get("overwriteAllBtn","\u5168\u90e8\u8986\u76d6"),!0,function(){w(aa.OVERWRITE)},m)},f=function(m){v(a.get("renameAllBtn","\u5168\u90e8\u91cd\u547d\u540d"),!1,function(){w(aa.RENAME)},m)},v=function(m,B,q,c){var d=$("<div>");d.text(m);d.addClass("font-import-conflict-all-operate");
d.on("click",q);d.appendTo(c);B&&(m=$("<div>"),m.addClass("font-import-conflict-btn-split-line"),m.appendTo(c));return d},w=function(m){for(var B=0;B<e.length;B++)e[B].setHandleStrategy(m);for(var q in l)l[q].setSelected(m)},Z=function(m){p=E.createTable();E.bindTableListenerForCtrl(p);p.setColumnFitVisibleWidth(!1);var B=new C(p);B.setOutsideVisible(!1);p.setCellRender(B);p.setSyncUIWhenModelChanged(!1);B=$(p.getUI());B.addClass("font-lib-no-x-scroll-table");B.css("top","40px");B.children().css("overflow-x",
"hidden");m.append(B)};this.paintTable=function(){p||Z(k);E.clear(p);p.addColumns(3);p.getColumn(0).setWidth(210);p.getColumn(1).setWidth(210);p.getColumn(2).setWidth(100);var m=E.createHeadRow(p);m.getCell(0).setValue(a.get("fontCode","\u5b57\u4f53\u7f16\u7801"));m.getCell(1).setValue(a.get("fontDisplay","\u5b57\u4f53\u663e\u793a\u540d\u79f0"));m.getCell(2).setValue(a.get("handleType","\u5904\u7406\u7b56\u7565"));for(m=0;m<e.length;m++){var B=e[m];E.createRow(p).setUserObject(B)}E.refresh(p)}}"undefined"==
typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.fontlib&&(com.kingdee.bos.qing.fontlib={});"undefined"==typeof com.kingdee.bos.qing.fontlib.common&&(com.kingdee.bos.qing.fontlib.common={});"undefined"==typeof com.kingdee.bos.qing.fontlib.common.ui&&(com.kingdee.bos.qing.fontlib.common.ui={});var Y=com.kingdee.bos.qing.fontlib.common.ui;
Y.FontLibInfoPanel=function(){function C(q){KTDefaultCellRender.call(this,q);var c=this,d=this.paintCellUI;this.paintCellUI=function(K,x){var ia=c.getCurrentRowIdx(),na=c.getCurrentRow(),qa=c.getCurrentColIdx(),ka=na.getUserObject();if(ia<E.getHeadRowCount()){if(d(K,x),0===qa&&1===ia){x=!(!Q||!Q.isChecked());Q=new n;Q.setChecked(x);Q.addCheckedListener(function(oa,ra){if(ra)if(oa.isChecked())for(var pa in F)G[pa]=!0,F[pa].setChecked(!0);else for(pa in F)delete G[pa],F[pa].setChecked(!1);B()});var R=
Q.getJqUi();R.addClass("font-lib-head-check-box");R.appendTo(K)}}else if(0===qa){ia=ka.getId();na=new n;x=!1;for(R in G)if(ia===R){x=!0;break}na.setChecked(x);na.setUserObject(ka);na.addCheckedListener(function(oa,ra){if(ra){ra=oa.isChecked();oa=oa.getUserObject().getId();F[oa].setChecked(ra);if(ra){oa=G[oa]=!0;for(var pa in F)if(!F[pa].isChecked()){oa=!1;break}oa&&Q.setChecked(!0)}else delete G[oa],Q.setChecked(!1);B()}});F[ia]=na;R=na.getJqUi();R.addClass("font-lib-check-box");R.appendTo(K)}else if(1===
qa)R=da*(W-1)+ia+1-E.getHeadRowCount(),x=$("<div>"),x.addClass("font-lib-table-serial-number"),x.text(R),x.appendTo(K);else if(2===qa){R=$("<div>");R.addClass("font-lib-table-element");var ma=ka.getCode();void 0===ka.getCreatorName()&&(x=$("<div>"),x.addClass("font-lib-table-preset-label"),x.text(a.get("preset","\u9884\u7f6e")),x.appendTo(R));x=$("<div>");x.attr("title",ma);x.addClass("font-lib-table-name");x.appendTo(R);x.on("click",function(){var oa=ka.getId(),ra=new ta(S,function(pa){pa&&!0===
pa?ea.jumpToFontLibDetailPanel(ma,oa):f.showPrompt(a.get("fontNotExist","\u5b57\u4f53\u4e0d\u5b58\u5728\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5\u3002"),2E3)},function(pa,J){if(40277008===pa)return f.showPrompt(a.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),5E3),!0});ra.setShowBlocking(!1);ra.isFontExist(oa)});H(x,p,ma);R.appendTo(K)}else 3===qa?(R=$("<div>"),x=ka.getDisplayName(),R.attr("title",x),R.addClass("font-lib-table-display-name"),
R.addClass("font-lib-table-element"),H(R,p,x),R.appendTo(K)):4===qa?(x=$("<div>"),x.addClass("font-lib-table-creator"),x.addClass("font-lib-table-element"),R=(R=ka.getCreatorName())?R:a.get("presetFont","\u7cfb\u7edf\u9884\u7f6e"),x.text(R),x.attr("title",R),x.appendTo(K)):5===qa?(x=$("<div>"),x.addClass("font-lib-table-create-time"),x.addClass("font-lib-table-element"),R=ka.getCreateFormatTime(),R=ka.getCreatorName()?R:"-",x.text(R),x.attr("title",R),x.appendTo(K)):6===qa?(x=$("<div>"),x.addClass("font-lib-table-modifier"),
x.addClass("font-lib-table-element"),R=(R=ka.getModifierName())?R:a.get("presetFont","\u7cfb\u7edf\u9884\u7f6e"),x.text(R),x.attr("title",R),x.appendTo(K)):7===qa&&(x=$("<div>"),x.addClass("font-lib-table-modify-time"),x.addClass("font-lib-table-element"),R=ka.getModifyFormatTime(),R=ka.getCreatorName()?R:"-",x.text(R),x.attr("title",R),x.appendTo(K))};var H=function(K,x,ia){if(x&&ia){x=x.toUpperCase();var na=ia.toUpperCase(),qa=na.split(x),ka=x.length,R;for(R in qa){var ma=na.indexOf(qa[R]),oa=ia.substr(pa,
qa[R].length);ma+=qa[R].length;var ra=na.length-ma;na=na.substr(ma,ra);ia=ia.substr(ma,ra);ma=$("<span>");ma.text(oa);ma.appendTo(K);if(R!=qa.length-1&&1<qa.length){var pa=na.indexOf(x);oa=ia.substr(pa,ka);ma=pa+ka;ra=na.length-ma;na=na.substr(ma,ra);ia=ia.substr(ma,ra);ma=$("<span>");ma.text(oa);ma.css("color","red");ma.clone().appendTo(K)}}}else K.text(ia)}}var I=this,D,k,e,l,Q,M=[],F={},G={},p,W,da,S,f,v;this.setItemCheckedCallBack=function(q){v=q};this.setRemoteImpl=function(q){S=q};this.setMessageCurtain=
function(q){f=q};this.updateSelectedRowAllPage=function(q){G={};for(var c in q)G[q[c]]=!0;this.updateUi(M)};this.getSelectedFontAllPage=function(){return Object.keys(G)};this.containPresetFont=function(q){for(var c in q){var d=F[q[c]];if((d=d&&d.getUserObject())&&"100000"===d.setCreatorId())return!0}return!1};this.getJqUi=function(){D||(D=$("<div>"),t.layoutCtrlWithLRTB(D,0,0,null,32,0,null),M&&0<M.length?w():Z(D));return D};this.resize=function(){l&&I.updateUi()};this.updateUi=function(q,c,d){q&&
(M=q);c&&(W=c);d&&(da=d);if(M&&0<M.length){l&&$(l.getUI()).show();e&&e.hide();k&&k.hide();l||w();E.clear(l);F={};l.addColumns(8);l.getColumn(0).setWidth(20);l.getColumn(1).setWidth(30);l.getColumn(2).setWidth(100);l.getColumn(3).setWidth(150);l.getColumn(4).setWidth(60);l.getColumn(5).setWidth(120);l.getColumn(6).setWidth(60);l.getColumn(7).setWidth(120);q=E.createHeadRow(l);q.getCell(1).setValue("#");q.getCell(2).setValue(a.get("fontCode","\u5b57\u4f53\u7f16\u7801"));q.getCell(3).setValue(a.get("fontDisplayName",
"\u5b57\u4f53\u663e\u793a\u540d\u79f0"));q.getCell(4).setValue(a.get("creator","\u521b\u5efa\u4eba"));q.getCell(5).setValue(a.get("createTime","\u521b\u5efa\u65f6\u95f4"));q.getCell(6).setValue(a.get("modifier","\u6700\u540e\u4fee\u6539\u4eba"));q.getCell(7).setValue(a.get("modifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4"));for(q=0;q<M.length;q++)c=M[q],E.createRow(l).setUserObject(c);E.refresh(l);q=m(F);c=Object.keys(G).length;v&&v(q,c);q===M.length?Q.setChecked(!0):Q.setChecked(!1)}else k&&e||
Z(D),p&&0<p.length?(k.show(),e&&e.hide()):(e.show(),k&&k.hide()),l&&$(l.getUI()).hide()};this.setSearchContent=function(q){p=q};var w=function(){if(D){l=E.createTable();l.setColumnFitVisibleWidth(!0);var q=new C(l);q.setOutsideVisible(!1);l.setCellRender(q);l.setSyncUIWhenModelChanged(!0);q=$(l.getUI());t.layoutCtrlWithLRTB(q,0,0,null,0,0,null);D.append(q)}},Z=function(q){if(p){k=$("<div>");var c=$("<div>");com.kingdee.bos.qing.fontlib.common.Icons.background(c,"nodata");c.addClass("font-lib-no-match-search-font-icon");
var d=$("<div>");d.text(a.get("noMatchingFont","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c\u3002"));d.addClass("font-lib-no-data-prompt");k.append(c);k.append(d);q.append(k)}else e=$("<div>"),c=$("<div>"),com.kingdee.bos.qing.fontlib.common.Icons.background(c,"font-library-no-data"),c.addClass("font-lib-no-created-font-icon"),d=$("<div>"),d.text(a.get("noFont","\u8bf7\u70b9\u51fb\u5de5\u5177\u680f\u3010\u65b0\u5efa\u3011\u6309\u94ae\uff0c\u65b0\u5efa\u5b57\u4f53")),d.addClass("font-lib-no-data-prompt"),
e.append(c),e.append(d),q.append(e)},m=function(q){var c=0,d;for(d in q)q[d].isChecked()&&c++;return c},B=function(){var q=m(F),c=Object.keys(G).length;v&&v(q,c)}};Y.FontLibDetailPanel=function(C,I){function D(b){KTDefaultCellRender.call(this,b);var g=this,r=this.paintCellUI;this.paintCellUI=function(A,P){var ja=g.getCurrentRowIdx(),fa=g.getCurrentRow(),va=g.getCurrentColIdx();fa=fa.getUserObject();if(ja<E.getHeadRowCount())r(A,P);else if(0===va){fa=parseInt(fa.getOrder())+1;var ha=$("<div>");ha.addClass("font-lib-source-order");
ha.text(fa);ha.appendTo(A)}else if(1===va){ha=$("<div>");P=fa.getPathType();switch(P){case V.LOCAL.index():ha.text(a.get("localFont","\u5ba2\u6237\u7aef\u672c\u5730\u5b57\u4f53"));break;case V.QING.index():ha.text(a.get("uploadFont","\u4e0a\u4f20\u5b57\u4f53\u6587\u4ef6"));break;case V.OTHER.index():ha.text(a.get("fontLink","\u7f51\u7edc\u94fe\u63a5"));break;case V.PRESET.index():ha.text(a.get("presetFont","\u7cfb\u7edf\u9884\u7f6e"))}ha.addClass("font-lib-source-type");ha.appendTo(A)}else if(2===
va){P=fa.getPathType();switch(P){case V.LOCAL.index():ha=a.get("name","\u540d\u79f0")+": ";var xa=fa.getPath();break;case V.QING.index():ha=a.get("attachment","\u9644\u4ef6")+": ";xa=fa.getFileDisplayName();break;case V.OTHER.index():ha=a.get("link","\u94fe\u63a5")+": ";xa=fa.getPath();break;case V.PRESET.index():ha=a.get("attachment","\u9644\u4ef6")+": ",xa=fa.getFileDisplayName()}fa=$("<div>");fa.text(ha+xa);fa.attr("title",xa);fa.addClass("font-lib-source-detail");fa.appendTo(A)}else 3===va&&(ha=
$("<div>"),R(ha,fa),ma(ha,fa),oa(ha,fa),ra(ha,fa),ha.addClass("font-lib-source-operation"),ha.appendTo(A))}}var k=this,e,l,Q,M,F,G,p,W,da,S,f,v=!1,w,Z,m;this.isDirty=function(){var b=$.trim(p.getText()),g=$.trim(W.getText());if(!ea.equals(b,I.getCode())||!ea.equals(g,I.getDisplayName()))return!0;b=I.getFontResources();if(b.length!==f.length)return!0;for(var r in f){g=b[r];var A=f[r];if(A.getId()!==g.getId()||g.getPath()!==A.getPath())return!0}return!1};this.setTabDirty=function(b){m=b};var B=function(){m&&
m(!0)};this.setMessageCurtain=function(b){Z=b};this.getJqUi=function(){if(!e){q();e=$("<div>");e.addClass("font-lib-detail-main-panel");c();var b=$("<div>");!w&&K(b);l=$("<div>");l.addClass("font-lib-resource-data-display-area");f&&0<f.length?H(l):d(l);b.append(l);var g=new T;g.setTitle(a.get("fontResource","\u5b57\u4f53\u6765\u6e90"));g.setPromptShow(!0);g.setPrompt(a.get("fontResourcePrompt","\u7531\u4e8e\u6d4f\u89c8\u5668\u517c\u5bb9\u6027\u7684\u95ee\u9898\uff0c\u4e00\u4e2a\u5b57\u4f53\u5141\u8bb8\u8bbe\u7f6e\u591a\u4e2a\u6765\u6e90\uff0c\u4f18\u5148\u4f7f\u7528\u4f18\u5148\u7ea7\u9760\u524d\u7684\u5b57\u4f53\u6765\u6e90\u3002"));
g.setContentPanel(b);b=g.getJqUi();b.addClass("font-lib-resource-expansion");e.append(b)}return e};this.resize=function(){k.updateResourceUi()};this.getFontInfo=function(){da.setCode($.trim(p.getText()));da.setDisplayName($.trim(W.getText()));da.setFontResources(f);return da};this.setModel=function(b){I=b;q();p&&p.setText(da.getCode());W&&W.setText(da.getDisplayName());k.updateResourceUi()};this.updateResourceUi=function(){f&&0<f.length?(M&&M.hide(),Q&&Q.show(),ka()):(Q&&Q.hide(),M||d(l),M.show())};
var q=function(){if(I){var b=I.getFontResources();b.sort(function(r,A){return r.getOrder()-A.getOrder()});for(var g in b)b[g].setOrder(g);da=I.copy()}else da=new O;w=da.isPreset();f=da.getFontResources()},c=function(){var b=$("<div>");b.addClass("font-lib-basic-info-main");var g=da.getCode();p=new h(a.get("fontCode","\u5b57\u4f53\u7f16\u7801"),g,!0);p.setEnabled(!w);!w&&p.setInputCallBack(function(){var A=p.getText();na(A);B()});g=p.getJqUi();g.addClass("font-lib-basic-info-input");var r=da.getDisplayName();
W=new h(a.get("fontDisplayName","\u5b57\u4f53\u663e\u793a\u540d\u79f0"),r,!0);W.setEnabled(!w);!w&&W.setInputCallBack(function(){B()});r=W.getJqUi();r.addClass("font-lib-basic-info-input");b.append(g);b.append(r);g=new T;g.setTitle(a.get("basicInfo","\u57fa\u672c\u4fe1\u606f"));g.setPromptShow(!1);g.setContentPanel(b);b=g.getJqUi();e.append(b)},d=function(b){M=$("<div>");var g=$("<div>");com.kingdee.bos.qing.fontlib.common.Icons.background(g,"no-font-resource");g.addClass("font-lib-no-font-resource-icon");
var r=$("<div>");r.text(a.get("noFontResource","\u6682\u65e0\u5b57\u4f53\u6765\u6e90"));r.addClass("font-lib-no-font-resource-prompt");M.append(g);M.append(r);b.append(M)},H=function(b){Q=$("<div>");Q.addClass("font-lib-resource-main");var g=Q;S=E.createTable();S.setColumnFitVisibleWidth(!1);var r=new D(S);r.setOutsideVisible(!0);S.setCellRender(r);S.setSyncUIWhenModelChanged(!1);r=$(S.getUI());t.layoutCtrlWithLRTB(r,10,0,null,10,0,null);r.addClass("font-lib-no-x-scroll-table");r.children("overflowX",
"hidden");g.append(r);!v&&ka();x(Q);b.append(Q)},K=function(b){var g=new Ba(a.get("newFontResource","\u6dfb\u52a0\u5b57\u4f53\u6765\u6e90"));g.setHighlight(!0);g.addActionListener(function(){var r=new u(C,null);r.setFinalCallBack(function(A){A.setFontId(da.getId());A.setOrder(f.length);f.push(A);k.updateResourceUi();B();Z&&Z.showSuccess(a.get("addFontResourceSuccess","\u6dfb\u52a0\u5b57\u4f53\u6765\u6e90\u6210\u529f\u3002"))});r.setCheckFileExist(z);r.showDialog()});g=g.getJqUi();g.addClass("font-lib-resource-new-button");
b.append(g)},x=function(b){var g=$("<div>"),r=com.kingdee.bos.qing.fontlib.common.Icons,A=$("<div>");r.background(A,"icon-side-open");A.addClass("font-lib-resource-css-message-open-button");A.hide();var P=$("<div>");r.background(P,"icon-side-close");P.addClass("font-lib-resource-css-message-close-button");var ja=$("<div>");ia(ja);A.on("click",function(){A.hide();P.show();ja.show();E.refresh(S)});P.on("click",function(){A.show();P.hide();ja.hide();E.refresh(S)});g.append(A);g.append(P);g.append(ja);
b.append(g)},ia=function(b){var g=$("<div>");g.addClass("font-lib-resource-css-main");var r=$("<div>");r.addClass("font-lib-resource-css-title");r.text(a.get("previewCss","\u9884\u89c8CSS"));var A=$("<div>");A.addClass("font-lib-resource-css-content");var P=$("<p>");P.text("@font-face {");var ja=$("<p>");F=$("<div>");var fa=$("<span>");F.addClass("font-lib-detail-css-preview-family-name");fa.text('";');F.appendTo(ja);fa.appendTo(ja);na(p.getText());fa=$("<p>");fa.text("\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0src:");
G=$("<span>");qa(G,f);var va=$("<p>");va.text("}");A.append(P);A.append(ja);A.append(fa);A.append(G);A.append(va);g.append(r);g.append(A);b.append(g)},na=function(b){F&&(F.text('\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0font-family:\u00a0"'+b),F.attr("title",b))},qa=function(b,g){if(b){b.empty();var r=g.length-1,A;for(A in g){var P=$("<p>");P.css("height","17px");var ja=$("<span>");ja.addClass("font-lib-resource-preview-url-prefix");var fa=$("<span>");fa.addClass("font-lib-resource-preview-url-suffix");
var va=g[A],ha=va.getPathType(),xa="\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0",za="";ha===V.LOCAL.index()?(za=va.getPath(),xa+='local("'+za):ha===V.QING.index()?(za=va.getFileDisplayName(),xa+='url("'+za):ha===V.OTHER.index()?(za=va.getPath(),xa+='url("'+za):ha===V.PRESET.index()&&(za=va.getFileDisplayName(),xa+='url("'+za);ja.text(xa);fa.text('")'+(A==r?";":","));P.attr("title",za);P.append(ja);P.append(fa);b.append(P)}}},ka=function(){v=!0;S||H(l);E.clear(S);S.addColumns(w?
3:4);S.getColumn(0).setWidth(80);S.getColumn(1).setWidth(200);S.getColumn(2).setWidth(910);!w&&S.getColumn(3).setWidth(200);var b=E.createHeadRow(S);b.getCell(0).setValue(a.get("priority","\u4f18\u5148\u7ea7"));b.getCell(1).setValue(a.get("sourceType","\u6765\u6e90\u65b9\u5f0f"));b.getCell(2).setValue(a.get("sourceDetail","\u6765\u6e90\u8be6\u60c5"));!w&&b.getCell(3).setValue(a.get("operation","\u64cd\u4f5c"));for(b=0;b<f.length;b++){var g=f[b];E.createRow(S).setUserObject(g)}E.refresh(S);qa(G,f);
v=!1},R=function(b,g){var r=$("<div>");r.addClass("font-lib-source-operation-button");r.text(a.get("moveUp","\u4e0a\u79fb"));var A=g.getOrder();r.on("click",function(){if(0<A){var P=A-1,ja=f[A];f[A]=f[P];f[P]=ja;f[A].setOrder(A);f[P].setOrder(P);ka();B()}});0<A?J(r):pa(r);b.append(r)},ma=function(b,g){var r=$("<div>");r.addClass("font-lib-source-operation-button");r.text(a.get("moveDown","\u4e0b\u79fb"));var A=g.getOrder();r.on("click",function(){if(A<f.length-1){var P=parseInt(A)+1,ja=f[A];f[A]=
f[P];f[P]=ja;f[A].setOrder(A);f[P].setOrder(P);ka();B()}});A<f.length-1?J(r):pa(r);b.append(r)},oa=function(b,g){var r=$("<div>");r.addClass("font-lib-source-operation-button");r.text(a.get("edit","\u7f16\u8f91"));r.on("click",function(){var A=new u(C,g);A.setFinalCallBack(function(P){var ja=g.getOrder();P.setId(g.getId());P.setFontId(g.getFontId());P.setOrder(ja);f[ja]=P;ka();B()});A.setCheckFileExist(z);A.showDialog()});b.append(r)},ra=function(b,g){var r=$("<div>");r.addClass("font-lib-source-operation-button");
r.text(a.get("delete","\u5220\u9664"));r.on("click",function(){var A=ca.createFeedbackDialog();A.setOptionType(ca.OPTION_OK_CANCEL);A.setMsgImageType(ca.MSG_DELETE);A.setMessage(a.get("deleteFontResourcePrompt","\u6240\u9009\u5b57\u4f53\u6765\u6e90\u5220\u9664\u540e\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u8be5\u5b57\u4f53\u6765\u6e90\u5417\uff1f"));A.setClosingChecker(function(P){if(P===ca.RETURN_OK){P=g.getOrder();0<f.length&&f.splice(P,1);for(var ja in f)f[ja].setOrder(ja);k.updateResourceUi();
B();Z&&Z.showSuccess(a.get("deleteFontResourceSuccess","\u5220\u9664\u5b57\u4f53\u6765\u6e90\u6210\u529f\u3002"))}return!0});A.showDialog()});b.append(r)},pa=function(b){b.css("color","#b2b2b2");b.css("cursor","default")},J=function(b){b.css("color","");b.css("cursor","pointer")},z=function(b,g,r){var A=!1;if(b===V.QING.index())for(var P in f){if(b=f[P],g===b.getFileDisplayName()&&r===b.getFileSize()){A=!0;break}}else for(P in f)g===f[P].getPath()&&(A=!0);return A}};Y.UploadPanel=N;Y.ImportFontsDialog=
function(C){function I(v){KTDefaultCellRender.call(this,v);var w=this,Z=this.paintCellUI;this.paintCellUI=function(m,B){var q=w.getCurrentRowIdx(),c=w.getCurrentRow(),d=w.getCurrentColIdx();c=c.getUserObject();q<E.getHeadRowCount()?(Z(m,B),0===d&&1===q&&(p=new n,p.setChecked(f(l)),p.addCheckedListener(function(H,K){if(K){H=H.isChecked();for(var x in l)l[x].setChecked(H)}}),c=p.getJqUi(),c.addClass("font-lib-head-check-box"),c.appendTo(m))):0===d?(B=c.getCode(),q=l[B],d=new n,l[B]=d,d.setUserObject(c),
d.setChecked(q&&q.isChecked()),d.addCheckedListener(function(H,K){K&&(H=f(l),p.setChecked(H))}),c=d.getJqUi(),c.addClass("font-lib-check-box"),c.appendTo(m)):1===d?(B=c.getCode(),c=$("<div>"),c.text(B),c.addClass("font-lib-import-table-code"),c.appendTo(m)):2===d&&(c=c.getDisplayName(),B=$("<div>"),B.text(c),B.addClass("font-lib-import-table-displayName"),B.appendTo(m))}}Aa.call(this);var D=this,k=D.protectedMethod,e,l,Q,M,F,G,p;(function(){k.setTitle(a.get("exportFonts","\u5bfc\u5165\u5b57\u4f53"));
k.setSelectable(!0);D.setSize(600,450);k.setContentPaneCreator(function(){G||(G=$("<div>"),G.addClass("font-lib-import-panel"),S(G));return G});k.setClosingChecker2(function(v){v=l;var w=[],Z;for(Z in v){var m=v[Z];m.isChecked()&&(m=m.getUserObject(),w.push(m.getCode()))}if(0<w.length)da(w);else return k.getMessageCurtain().showPrompt(a.get("noFontSelected","\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u5b57\u4f53\u3002"),2E3),!1},function(v){k.destroy();return!0});k.setClosingAction(function(v){k.destroy();
return!0})})();this.setImportSuccessCallBack=function(v){Q=v};var W=function(v,w){Q&&Q(v,w)};this.setRemoteImpl=function(v){M=v};this.setImportFileName=function(v){e=v};var da=function(v){(new ta(M,function(w){k.destroy();if(w&&0<w.length){for(var Z=v.length,m=w.length,B=[],q=0;q<w.length;q++){var c=B,d=c.push;a:{var H=w[q];for(var K=0;K<C.length;K++){var x=C[K];if(H===x.getCode()){H=x;break a}}H=void 0}d.call(c,H)}w=new X;w.setRemoteImpl(M);w.setImportFileName(e);w.setHandleFinalCallBack(W);w.setSuccessImportQuantity(Z-
m);w.setConflictImportFontModels(B);w.showDialog();w.paintTable()}else W(!0,!1)},function(w){k.getMessageCurtain().showPrompt(a.get("importFontsFailed","\u5bfc\u5165\u5b57\u4f53\u5931\u8d25\u3002"),3E3);return!0})).importSelectedFonts(e,v)},S=function(v){F=E.createTable();F.setColumnFitVisibleWidth(!1);var w=new I(F);w.setOutsideVisible(!1);F.setCellRender(w);F.setSyncUIWhenModelChanged(!1);w=$(F.getUI());w.addClass("font-lib-no-x-scroll-table");w.children().css("overflow-x","hidden");v.append(w)};
this.paintTable=function(){F||S(G);E.clear(F);l={};F.addColumns(3);F.getColumn(0).setWidth(30);F.getColumn(1).setWidth(225);F.getColumn(2).setWidth(255);var v=E.createHeadRow(F);v.getCell(0).setValue("");v.getCell(1).setValue(a.get("fontCode","\u5b57\u4f53\u7f16\u7801"));v.getCell(2).setValue(a.get("fontDisplayName","\u5b57\u4f53\u663e\u793a\u540d\u79f0"));for(v=0;v<C.length;v++){var w=C[v];E.createRow(F).setUserObject(w)}E.refresh(F)};var f=function(v){for(var w in v)if(!v[w].isChecked())return!1;
return!0}};var t,ba,a,E,n,ea,y,V,O,ya,Ba,Aa,ca,sa,ta,wa,la,ua,aa;(function(){var C=com.kingdee.bos.qing.common;t=C.DomUtil;C=com.kingdee.bos.qing.framework.common;ba=C.MultilanguageManager;la=C.Resource;C=com.kingdee.bos.qing.fontlib.common;a=ba.createPackageAccessor(C);ea=C.FontLibUtil;ta=C.FontLibFacade;C=com.kingdee.bos.qing.fontlib.model;O=C.FontInfo;ya=C.FontResource;wa=C.UploadFileInfo;V=C.FontResourceType;aa=C.ConflictImportFontHandleType;C=com.kingdee.bos.qing.common.ui;E=C.TableUtil;C=com.kingdee.bos.qing.ui.component;
n=C.CheckBox;y=C.TextField;Ba=C.Button;Aa=C.AbstractModalDialog;ca=C.MessageDialog;sa=C.ComboBox;ua=C.HelpIcon})()})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.fontlib&&(com.kingdee.bos.qing.fontlib={});"undefined"==typeof com.kingdee.bos.qing.fontlib.ui&&(com.kingdee.bos.qing.fontlib.ui={});var u=com.kingdee.bos.qing.fontlib.ui;u.FontLibEntrance=function(ca){var sa,ta,wa,la=new N,ua,aa,C,I,D,k=
new Y,e=new U;this.resize=function(){D&&D.resize()};this.getJqUi=function(){if(!sa){sa=$("<div>");sa.addClass("font-lib-main");sa.append(k.getJqUi());ta=$("<div>");ta.addClass("font-lib-main-panel");sa.append(ta);var c=la.getJqUi();la.createButton(c,!1,p,h.get("newFontBtn","\u65b0\u5efa"));ua=la.createButton(c,!1,W,h.get("deleteFontBtn","\u5220\u9664"));la.createButton(c,!1,da,h.get("importBtn","\u5bfc\u5165"));aa=la.createButton(c,!1,S,h.get("exportBtn","\u5bfc\u51fa"));la.createButton(c,!1,f,h.get("refreshFontBtn",
"\u5237\u65b0"));la.createButton(c,!1,v,h.get("closeTab","\u9000\u51fa"));ua.setEnabled(!1);aa.setEnabled(!1);Z();sa.append(c);M();G()}return sa};var l=function(c,d){return new E(ca,c,d)},Q=function(c,d){e.refreshSelectedRowTotal(d);0>=d?(ua.setEnabled(!1),aa.setEnabled(!1)):(ua.setEnabled(!0),aa.setEnabled(!0))},M=function(){e.setSelectedAllOrNotListener(function(c,d){c?l(function(H){F(H,e.refreshTotalRow);l(function(K){D.updateSelectedRowAllPage(K);d(K.length)}).loadAllFontIds(I)},function(H,K){if(40277008===
H)return k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),5E3),!0}).loadAllFonts(e.getCurrentPage(),e.getPageSize(),I):D.updateSelectedRowAllPage({})});e.setJumpToPageListener(function(c,d,H){l(function(K){F(K,H)},function(K,x){if(40277008===K)return k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),
5E3),!0}).loadAllFonts(c,d,I)});e.setAutoHide(!0);e.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);wa=e.getJqUi();ta.append(wa)},F=function(c,d){d?d(c.totalRow):e.refreshPagination();d=[];c=c.fonts;for(var H in c){var K=new V;K.fromJsonObject(c[H]);d.push(K)}D.updateUi(d,e.getCurrentPage(),e.getPageSize())},G=function(){l(function(c){D=new n;D.setItemCheckedCallBack(Q);D.setRemoteImpl(ca);D.setMessageCurtain(k);ta.append(D.getJqUi());F(c,e.resetPaginationAndJumpToFirstPage)}).loadAllFonts(1,
e.getPageSize(),I)},p=function(){var c=l(function(d){ea.jumpToFontLibDetailPanel(null,null)},function(d,H){if(40277008===d)return k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),5E3),!0});c.setShowBlocking(!1);c.checkPermission()},W=function(){var c=t.createFeedbackDialog();c.setOptionType(t.OPTION_OK_CANCEL);c.setMsgImageType(t.MSG_DELETE);c.setMessage(h.get("deleteFontPrompt","\u6240\u9009\u5b57\u4f53\u5220\u9664\u540e\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u8be5\u5b57\u4f53\u5417\uff1f"));
c.setClosingChecker(function(d){d===t.RETURN_OK&&(d=D.getSelectedFontAllPage(),l(function(){k.showSuccess(h.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"),2E3);l(function(H){e.refreshSelectedRowTotal(0);D.updateSelectedRowAllPage({});F(H,e.resetPaginationAndJumpToFirstPage)}).loadAllFonts(1,e.getPageSize(),I)},function(H,K){40277008===H?k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),5E3):
40277009===H?(k.showPrompt(h.get("noDeletePermission","\u9884\u7f6e\u7684\u5b57\u4f53\u65e0\u6cd5\u5220\u9664\u3002"),2E3),l(function(x){e.refreshSelectedRowTotal(0);D.updateSelectedRowAllPage({});F(x,e.resetPaginationAndJumpToFirstPage)}).loadAllFonts(1,e.getPageSize(),I)):k.showPrompt(h.get("deleteFailure","\u5220\u9664\u5931\u8d25"),2E3);return!0}).removeFonts(d));return!0});c.showDialog()},da=function(){var c=$("<input type='file' id='importBtn'>");c.attr("accept",[".qing-font"]);c.on("change",
function(d){if(d=d.currentTarget.files[0]){var H=d.name,K=d.size,x=H.lastIndexOf(".");H=H.substring(x+1,H.length).toLowerCase();sa.find("#importBtn").val("");"qing-font"!==H?k.showPrompt(h.get("fileTypeIncorrect","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),3E3):0===K?k.showPrompt(h.get("importFileIsNull","\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a\u7a7a\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),3E3):104857600<=K?k.showPrompt(h.get("fileTooLarge","\u6587\u4ef6\u592a\u5927\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),
3E3):(new ya(function(ia){w(ia)})).upload(d,k,!0)}c.val("")});c.click()},S=function(){var c=D.getSelectedFontAllPage();!c||0>=c.length||(D.containPresetFont(c)?k.showPrompt(h.get("noPermissionExportPresetFonts","\u9884\u7f6e\u7684\u5b57\u4f53\u65e0\u6cd5\u5bfc\u51fa\u3002"),3E3):l(function(d){d=d.exportFileName;var H="Qing-"+(new Date).getTime()+".qing-font";a.downloadFile(H,d)},function(d,H){40277008===d?k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),
5E3):40277014===d?k.showPrompt(h.get("noPermissionExportPresetFonts","\u9884\u7f6e\u7684\u5b57\u4f53\u65e0\u6cd5\u5bfc\u51fa\u3002"),3E3):k.showPrompt(h.get("exportFailed","\u5bfc\u51fa\u5931\u8d25\u3002"),2E3);return!0}).exportFonts(c))},f=function(){l(function(c){D.updateSelectedRowAllPage({});e.refreshSelectedRowTotal(0);F(c,e.refreshTotalRow)},function(c,d){if(40277008===c)return k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),
5E3),!0}).loadAllFonts(e.getCurrentPage(),e.getPageSize(),I)},v=function(){X.closeCurrentTab()},w=function(c){l(function(d){if(d&&0<d.length){for(var H=[],K=0;K<d.length;K++){var x=new Aa;x.fromJsonObject(d[K]);H.push(x)}B(c,H)}else k.showPrompt(h.get("noFoundImportFont","\u6240\u9009\u6587\u4ef6\u4e2d\u672a\u53d1\u73b0\u53ef\u5bfc\u5165\u7684\u5b57\u4f53\u4fe1\u606f\u3002"),5E3)},function(d){40277012===d?k.showPrompt(h.get("noFoundUploadFile","\u4e0a\u4f20\u6587\u4ef6\u5931\u8d25\u3002"),3E3):40277013===
d&&k.showPrompt(h.get("parseImportFileError","\u5bfc\u5165\u5b57\u4f53\u6587\u4ef6\u89e3\u6790\u5f02\u5e38\u3002"),3E3)}).parseImportFile(c)},Z=function(){C=new L;C.addSearchListener(m);C.setSearchListenerDelay(1E3);C.setAlwaysShowCleanIcon(!1);C.setShowSearchIcon(!0);C.setPlaceholder(h.get("searchBoxPlaceholder","\u641c\u7d22\u5b57\u4f53\u7f16\u7801/\u5b57\u4f53\u663e\u793a\u540d\u79f0"));var c=C.getJqUi();c.addClass("font-lib-search");var d=c.find(":input");d.focus(function(){c.css({width:"300px"})});
d.blur(function(){c.css({width:"210px"})});la.getJqUi().append(c)},m=function(c){I=C.getText().trim();D.setSearchContent(I);c=l(function(H){D.updateSelectedRowAllPage({});e.refreshSelectedRowTotal(0);F(H,e.resetPaginationAndJumpToFirstPage)},function(H,K){if(40277008===H)return k.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),5E3),!0});var d=e.getPageSize();c.loadAllFonts(1,d,I)},B=function(c,d){d=
new Ba(d);d.setImportFileName(c);d.setRemoteImpl(ca);d.setImportSuccessCallBack(function(H,K){H&&(K?k.showSuccess(h.get("importFontsSuccessComplex","\u5bfc\u5165\u6210\u529f\uff0c\u4e0e\u9884\u7f6e\u5b57\u4f53\u7f16\u7801\u51b2\u7a81\u7684\u5b57\u4f53\u5df2\u8fdb\u884c\u91cd\u547d\u540d\u64cd\u4f5c\u3002"),5E3):k.showSuccess(h.get("importFontsSuccessSimple","\u5bfc\u5165\u6210\u529f\u3002"),2E3));q()});d.showDialog();d.paintTable()},q=function(){l(function(c){I="";var d=C.getJqUi().find(":input");
d.val("");d.blur();D.updateSelectedRowAllPage({});e.refreshSelectedRowTotal(0);F(c,e.resetPaginationAndJumpToFirstPage)}).loadAllFonts(1,e.getPageSize())}};u.FontLibDetailEntrance=function(ca,sa){var ta,wa,la,ua=new N,aa=new Y,C=!1,I=!1,D,k;this.getJqUi=function(){ta||Q();return ta};this.setCloseButtonCallBack=function(f){D=f};var e=function(){D&&D()};this.setTabDirty=function(f){k=f};var l=function(f){k&&k(f)};this.isDirty=function(){return!I&&la.isDirty()};this.resize=function(){la&&la.resize()};
var Q=function(){ta=$("<div>");ta.addClass("font-lib-main");ta.append(aa.getJqUi());wa=$("<div>");wa.addClass("font-lib-detail-main-panel-background");ta.append(wa);var f=new O;sa?S(function(v){f.fromJsonObject(v);C=!!f.isPreset();M();da(f);f.getCode()||aa.showError(h.get("fontNotExist","\u5b57\u4f53\u4e0d\u5b58\u5728\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5\u3002"))}).loadFontInfo(sa):(C=!1,M(),da(f))},M=function(){var f=ua.getJqUi();!C&&ua.createButton(f,!1,F,h.get("saveFontBtn","\u4fdd\u5b58"));
!C&&ua.createButton(f,!1,G,h.get("refreshFontBtn","\u5237\u65b0"));ua.createButton(f,!1,e,h.get("closeTab","\u9000\u51fa"));ta.append(f)},F=function(){var f=la.getFontInfo();p(f)&&W(f)},G=function(){if(sa)S(function(v){if(v){var w=new O;w.fromJsonObject(v);la.setModel(w);l(!1);aa.showSuccess(h.get("refreshSuccess","\u5237\u65b0\u6210\u529f\u3002"),2E3);I=!1}else aa.showPrompt(h.get("fontInfoNoExist","\u5b57\u4f53\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),l(!1),I=!0},function(v,
w){if(40277008===v)return aa.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),5E3),!0}).loadFontInfo(sa);else{var f=new O;la.setModel(f);l(!1);aa.showSuccess(h.get("refreshSuccess","\u5237\u65b0\u6210\u529f\u3002"),2E3);I=!1}},p=function(f){var v=f.getCode(),w=f.getDisplayName();f=f.getFontResources();if(v&&0!==v.length||w&&0!==w.length)if(v&&0!==v.length)if(w&&0!==w.length)if(f&&0!==f.length){if(50<
v.length)return aa.showPrompt(h.get("fontNameOverLength","\u5b57\u4f53\u7f16\u7801\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),2E3),!1;if(50<w.length)return aa.showPrompt(h.get("displayNameOverLength","\u5b57\u4f53\u663e\u793a\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),2E3),!1;if(!ba.checkVariableNaming(v))return aa.showPrompt(h.get("illegalFontName","\u5b57\u4f53\u7f16\u7801\u5fc5\u987b\u4ee5\u5b57\u6bcd\u5f00\u5934\uff0c\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u3002"),
4E3),!1;if(!ea.checkCustomName(w))return aa.showPrompt(h.get("illegalFontDisplayName","\u5b57\u4f53\u663e\u793a\u540d\u79f0\u4e0d\u5141\u8bb8\u5305\u542b\u7279\u6b8a\u5b57\u7b26\u3002"),2E3),!1}else return aa.showPrompt(h.get("noFoundFontResource","\u8bf7\u6dfb\u52a0\u5b57\u4f53\u6765\u6e90\u3002"),2E3),!1;else return aa.showPrompt(h.get("noFoundDisplayName","\u8bf7\u8f93\u5165\u5b57\u4f53\u663e\u793a\u540d\u79f0\u3002"),2E3),!1;else return aa.showPrompt(h.get("noFoundFontCode","\u8bf7\u8f93\u5165\u5b57\u4f53\u7f16\u7801\u3002"),
2E3),!1;else return aa.showPrompt(h.get("noFoundFontCodingAndDisplayName","\u8bf7\u8f93\u5165\u5b57\u4f53\u7f16\u7801\u548c\u5b57\u4f53\u663e\u793a\u540d\u79f0\u3002"),2E3),!1;return!0},W=function(f){var v=S(function(Z){var m=new O;m.fromJsonObject(Z);la.setModel(m);sa=m.getId();l(!1);aa.showSuccess(h.get("saveSuccess","\u4fdd\u5b58\u6210\u529f"),2E3)},function(Z,m){if(40277005===Z)aa.showPrompt(h.get("fontNameAndDisplayNameDuplicated","\u5b57\u4f53\u7f16\u7801\u548c\u5b57\u4f53\u663e\u793a\u540d\u79f0\u5df2\u5b58\u5728\u3002"),
2E3);else if(40277006===Z)aa.showPrompt(h.get("fontNameDuplicated","\u5b57\u4f53\u7f16\u7801\u5df2\u5b58\u5728\u3002"),2E3);else if(40277007===Z)aa.showPrompt(h.get("fontDisplayNameDuplicated","\u5b57\u4f53\u663e\u793a\u540d\u79f0\u5df2\u5b58\u5728\u3002"),2E3);else if(40277008===Z)aa.showPrompt(h.get("noPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002"),2E3);else if(40277010===Z)aa.showPrompt(h.get("fontInfoOutdated",
"\u5f53\u524d\u9875\u9762\u5df2\u5931\u6548\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5\u3002"),2E3),l(!1),I=!0;else if(40277011===Z)aa.showPrompt(h.get("fontInfoNoExist","\u5b57\u4f53\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),l(!1),I=!0;else return!1;return!0}),w=f.getId();w&&0<w.length?v.updateFontInfo(f):v.addFont(f)},da=function(f){la=new y(ca,f);la.setMessageCurtain(aa);la.setTabDirty(l);wa.append(la.getJqUi());la.updateResourceUi()},S=function(f,v){return new E(ca,
f,v)}};var N,h,T,U,L,X,Y,t,ba,a,E,n,ea,y,V,O,ya,Ba,Aa;(function(){var ca=com.kingdee.bos.qing.ui.component;N=ca.Toolbar;Y=ca.MessageCurtain;t=ca.MessageDialog;ca=com.kingdee.bos.qing.common;ba=ca.Util;ca=com.kingdee.bos.qing.framework.common;T=ca.MultilanguageManager;X=ca.TabbedUiUtil;a=ca.RemoteFramework;ca=com.kingdee.bos.qing.fontlib.common;h=T.createPackageAccessor(ca);E=ca.FontLibFacade;ea=ca.FontLibUtil;ca=com.kingdee.bos.qing.fontlib.model;V=ca.FontModel;O=ca.FontInfo;Aa=ca.ImportFontModel;
ca=com.kingdee.bos.qing.fontlib.common.ui;n=ca.FontLibInfoPanel;y=ca.FontLibDetailPanel;ya=ca.UploadPanel;Ba=ca.ImportFontsDialog;ca=com.kingdee.bos.qing.biz.common;U=ca.ComplexPaginationBar;ca=com.kingdee.bos.qing.ui.component;L=ca.SearchBox})()})();
//qingVersionTag: 20250324