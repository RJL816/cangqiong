var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(v){var C=0;return function(){return C<v.length?{done:!1,value:v[C++]}:{done:!0}}};$jscomp.arrayIterator=function(v){return{next:$jscomp.arrayIteratorImpl(v)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(v,C,B){if(v==Array.prototype||v==Object.prototype)return v;v[C]=B.value;return v};$jscomp.getGlobal=function(v){v=["object"==typeof globalThis&&globalThis,v,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var C=0;C<v.length;++C){var B=v[C];if(B&&B.Math==Math)return B}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(v,C){var B=$jscomp.propertyToPolyfillSymbol[C];if(null==B)return v[C];B=v[B];return void 0!==B?B:v[C]};
$jscomp.polyfill=function(v,C,B,G){C&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(v,C,B,G):$jscomp.polyfillUnisolated(v,C,B,G))};$jscomp.polyfillUnisolated=function(v,C,B,G){B=$jscomp.global;v=v.split(".");for(G=0;G<v.length-1;G++){var H=v[G];if(!(H in B))return;B=B[H]}v=v[v.length-1];G=B[v];C=C(G);C!=G&&null!=C&&$jscomp.defineProperty(B,v,{configurable:!0,writable:!0,value:C})};
$jscomp.polyfillIsolated=function(v,C,B,G){var H=v.split(".");v=1===H.length;G=H[0];G=!v&&G in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var x=0;x<H.length-1;x++){var L=H[x];if(!(L in G))return;G=G[L]}H=H[H.length-1];B=$jscomp.IS_SYMBOL_NATIVE&&"es6"===B?G[H]:null;C=C(B);null!=C&&(v?$jscomp.defineProperty($jscomp.polyfills,H,{configurable:!0,writable:!0,value:C}):C!==B&&(void 0===$jscomp.propertyToPolyfillSymbol[H]&&(B=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[H]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(H):$jscomp.POLYFILL_PREFIX+B+"$"+H),$jscomp.defineProperty(G,$jscomp.propertyToPolyfillSymbol[H],{configurable:!0,writable:!0,value:C})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(v){if(v)return v;var C=function(x,L){this.$jscomp$symbol$id_=x;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:L})};C.prototype.toString=function(){return this.$jscomp$symbol$id_};var B="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",G=0,H=function(x){if(this instanceof H)throw new TypeError("Symbol is not a constructor");return new C(B+(x||"")+"_"+G++,x)};return H},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(v){if(v)return v;v=Symbol("Symbol.iterator");for(var C="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),B=0;B<C.length;B++){var G=$jscomp.global[C[B]];"function"===typeof G&&"function"!=typeof G.prototype[v]&&$jscomp.defineProperty(G.prototype,v,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return v},"es6",
"es3");$jscomp.iteratorPrototype=function(v){v={next:v};v[Symbol.iterator]=function(){return this};return v};$jscomp.iteratorFromArray=function(v,C){v instanceof String&&(v+="");var B=0,G=!1,H={next:function(){if(!G&&B<v.length){var x=B++;return{value:C(x,v[x]),done:!1}}G=!0;return{done:!0,value:void 0}}};H[Symbol.iterator]=function(){return H};return H};$jscomp.polyfill("Array.prototype.keys",function(v){return v?v:function(){return $jscomp.iteratorFromArray(this,function(C){return C})}},"es6","es3");
(function(){function v(){var n=this,r,m=[],l=[],k=[],u;this.setType=function(f){r=f};this.getType=function(){return r};this.supportIncrementalMaterialize=function(){return!1};this.protectedIsTableInUse=function(){throw Error("override me");};this.insertSource=function(f,c){for(var b=!1,p=f.getSourceId(),a=0;a<m.length;a++)if(p==m[a].getSourceId()){b=!0;break}b||(m.splice(c,0,f),e(v.KEY_ADD_PREPARED_SOURCE,[f]))};this.batchAddSource=function(f){for(var c=[],b=0;b<f.length;b++){for(var p=!1,a=f[b],
d=a.getSourceId(),t=0;t<m.length;t++)if(d==m[t].getSourceId()){p=!0;break}p||(m.push(a),c.push(a))}e(v.KEY_ADD_PREPARED_SOURCE,c)};this.setSource=function(f,c){m=f;!c&&e(v.KEY_SET_PREPARED_SOURCE,m)};this.removeSource=function(f){var c=m.indexOf(f);return-1<c?(m.splice(c,1),e(v.KEY_REMOVE_PREPARED_SOURCE,[f]),c):-1};this.batchRemoveUserSqlTable=function(f){f=n.getUserSqlTables(f);for(var c=0;c<f.length;c++)n.removeTableIfUseless(f[c])};this.batchRemoveSource=function(f){for(var c=0;c<f.length;c++){var b=
m.indexOf(f[c]);-1<b&&m.splice(b,1)}e(v.KEY_REMOVE_PREPARED_SOURCE,f)};this.getSource=function(f){for(var c=0,b=m.length;c<b;c++)if(m[c].getId()==f)return m[c]};this.getAllSource=function(){return m};this.isSourceUsed=function(f){f=f.getId();for(var c=0,b=l.length;c<b;c++){var p=l[c];if(p.getSourceUid()==f&&n.protectedIsTableInUse(p))return!0}return!1};this.addTable=function(f){for(var c=0,b=l.length;c<b;c++)if(l[c].isSame(f))return;l.push(f);f.addPropertyChangeCallback(e);e(v.KEY_ADD_TABLE,f)};this.updateTable=
function(f,c){for(var b=-1,p=0,a=l.length;p<a;p++)if(l[p].isSame(c)){b=p;break}-1<b&&(l.splice(b,1),l.splice(b,0,f),c.removePropertyChangeCallback(e),f.addPropertyChangeCallback(e))};this.batchAddTable=function(f){for(var c=0;c<f.length;c++)n.addTable(f[c])};this.setTables=function(f){l=f};this.getTable=function(f){for(var c=0,b=l.length;c<b;c++)if(l[c].getUid()==f)return l[c]};this.removeTable=function(f){var c=l.indexOf(f);-1<c&&(l.splice(c,1),f.removePropertyChangeCallback(e),e(v.KEY_REMOVE_TABLE,
f));return c};this.batchRemoveTable=function(f){for(var c=0;c<f.length;c++){var b=f[c];n.removeTable(b);b.removePropertyChangeCallback(e)}};this.insertTable=function(f,c){for(var b=0,p=l.length;b<p;b++)if(l[b].isSame(f))return;l.splice(c,0,f);f.addPropertyChangeCallback(e);e(v.KEY_ADD_TABLE,f)};this.getUserSqlTables=function(f){for(var c=[],b=0,p=l.length;b<p;b++){var a=l[b];a.isUserSql()&&a.getSourceUid()==f&&c.push(a)}return c};this.getAllUserSqlTables=function(){for(var f=[],c=0,b=l.length;c<b;c++)l[c].isUserSql()&&
f.push(l[c]);return f};this.getAllTable=function(f){for(var c=[],b=0,p=l.length;b<p;b++){var a=l[b];f?(n.protectedIsTableInUse(a)||a.isUserSql())&&c.push(a):n.protectedIsTableInUse(a)&&c.push(a)}return c};this.getSameTable=function(f){for(var c=0,b=l.length;c<b;c++)if(l[c].isSame(f))return l[c]};this.isSameTableAndSourceExist=function(f,c,b){for(var p=0;p<l.length;p++){var a=l[p];if(a.getTableName()==c&&a.getNamespace()==b&&n.getSource(a.getSourceUid()).getSourceId()==f)return!0}return!1};this.setMaterializedConfig=
function(f){u=f};this.getMaterializedConfig=function(){return u};this.toJsonObject=function(){var f={};f.type=r;for(var c=[],b=0;b<m.length;b++)c.push(m[b].toJsonObject());f.sources=c;c=[];for(b=0;b<l.length;b++){var p=l[b];(n.protectedIsTableInUse(p)||p.isUserSql())&&c.push(p.toJsonObject())}f.tables=c;u&&(f.materializedConfig=u.toJsonObject());n.protectedToJsonObject(f);return f};this.fromJsonObject=function(f){r=f.type;var c=f.sources;if(c)for(var b=0;b<c.length;b++){var p=c[b],a=new H;a.fromJsonObject(p);
m.push(a)}if(c=f.tables)for(b=0;b<c.length;b++)p=new B,p.fromJsonObject(c[b]),p.addPropertyChangeCallback(e),l.push(p);(b=f.materializedConfig)?(u=new O,u.fromJsonObject(b)):u=null;n.protectedFromJsonObject(f)};this.isUserSqlTableInUse=function(f){f=n.getSameTable(f);return n.protectedIsTableInUse(f)};this.protectedToJsonObject=function(f){};this.protectedFromJsonObject=function(f){};this.addPropertyChangeCallback=function(f){k.push(f)};this.removePropertyChangeCallback=function(f){f=k.indexOf(f);
-1<f&&k.splice(f,1)};this.clearPropertyChangeCallback=function(){k=[]};var e=function(f,c){for(var b=0,p=k.length;b<p;b++)k[b](f,c)};this.protectedMethod={firePropertyChangeEvt:e,copy:function(f){f.setType(r);for(var c=[],b=0;b<m.length;b++)c.push(m[b].copy());f.setSource(c,!0);c=[];for(b=0;b<l.length;b++)c.push(l[b].clone());f.setTables(c);u&&f.setMaterializedConfig(u.copy())}}}function C(){var n=this,r,m,l,k,u,e,f,c,b=[];this.setId=function(a){r=a};this.getId=function(){return r};this.setAlias=
function(a){m=a;k=void 0;p(v.KEY_NODE_CHANGE_ALIAS,n)};this.getAlias=function(){return m};this.setNameIndex=function(a){k=a};this.getNameIndex=function(){return k};this.getX=function(){return u};this.getY=function(){return e};this.getWidth=function(){return f};this.getHeight=function(){return c};this.setPosition=function(a,d){u=a;e=d};this.changePosition=function(a,d){n.setPosition(a,d);p(v.KEY_NODE_CHANGE_POSITION,n)};this.setSize=function(a,d){f=a;c=d};this.setType=function(a){l=a};this.getType=
function(a){return l};this.addPropertyChangeCallback=function(a){b.push(a)};this.removePropertyChangeCallback=function(a){a=b.indexOf(a);-1<a&&b.splice(a,1)};this.toJsonObject=function(){var a={};a.id=r;a.alias=m;a.x=u;a.y=e;a.type=l;k&&(a.nameIndex=k);n.protectedToJson(a);return a};this.fromJsonObject=function(a){r=a.id;m=a.alias;u=a.x;e=a.y;l=a.type;var d=parseInt(a.nameIndex);isNaN(d)||(k=d);n.protectedFromJson(a)};this.protectedToJson=function(a){};this.protectedFromJson=function(a){};var p=function(a,
d){for(var t=0,A=b.length;t<A;t++)b[t](a,d)};this.protectedMethod={firePropertyChangeEvt:function(a){p(a,n)}}}function B(){var n=this,r,m,l,k,u,e,f,c=[],b=[];this.setUid=function(a){r=a};this.getUid=function(){return r};this.isUserSql=function(){return e?!0:!1};this.getUserSql=function(){return e};this.setUserSql=function(a){e=a};this.setTableName=function(a){m=a};this.getTableName=function(){return m};this.setSourceUid=function(a){l=a};this.getSourceUid=function(){return l};this.setNamespace=function(a){k=
a};this.getNamespace=function(){return k};this.setDisplayName=function(a){u=a};this.getDisplayName=function(){return u};this.setSelectedFields=function(a){f=a;p(v.KEY_TABLE_SELECT_FIELD,n)};this.getSelectedFields=function(){return f};this.setFilterItems=function(a){c=a;p(v.KEY_TABLE_SET_FILTER,n)};this.getFilterItems=function(){return c};this.addPropertyChangeCallback=function(a){b.push(a)};this.removePropertyChangeCallback=function(a){a=b.indexOf(a);-1<a&&b.splice(a,1)};this.isSame=function(a){return l==
a.getSourceUid()&&m==a.getTableName()&&k==a.getNamespace()&&(!n.isUserSql()&&!a.isUserSql()||n.isUserSql()&&a.isUserSql()&&(a=a.getUserSql(),a.getSqlType()==e.getSqlType()&&a.getContent()==e.getContent()))?!0:!1};this.toJsonObject=function(){var a={};a.id=r;a.name=m;a.sourceId=l;a.namespace=k;n.isUserSql()&&(a.userSQL=e.toJsonObject());if(f){for(var d=[],t=0;t<f.length;t++)d.push(f[t].toJsonObject());a.selectedFields=d}if(c){d=[];for(t=0;t<c.length;t++)d.push(c[t].toJsonObject());a.filterItems=d}return a};
this.fromJsonObject=function(a){r=a.id;m=a.name;l=a.sourceId;k=a.namespace;u=a.displayName;a.userSQL&&(e=new G,e.fromJsonObject(a.userSQL));var d=a.selectedFields;if(d){for(var t=[],A=0;A<d.length;A++){var h=new x;h.fromJsonObject(d[A]);t.push(h)}f=t}if(a=a.filterItems){d=[];for(A=0;A<a.length;A++)t=new w,t.fromJsonObject(a[A]),d.push(t);c=d}};this.clone=function(){var a=new B;a.setUid(r);a.setTableName(m);a.setNamespace(k);a.setDisplayName(u);a.setSourceUid(l);e&&a.setUserSql(e.copy());var d=[];
if(f){for(var t=0;t<f.length;t++)d.push(f[t].clone());a.setSelectedFields(d)}d=[];for(t=0;t<c.length;t++)d.push(c[t].copy());a.setFilterItems(d);return a};var p=function(a,d){for(var t=0,A=b.length;t<A;t++)b[t](a,d)}}function G(){var n,r;this.getSqlType=function(){return n};this.setSqlType=function(m){n=m};this.setContent=function(m){r=m};this.getContent=function(){return r};this.fromJsonObject=function(m){n=m.type;r=m.content};this.toJsonObject=function(){var m={};m.type=n;m.content=r;return m};
this.copy=function(){var m=new G;m.setSqlType(n);m.setContent(r);return m}}function H(){var n,r,m,l,k,u;this.setId=function(e){n=e};this.getId=function(){return n};this.getSourceId=function(){return r};this.setSourceId=function(e){r=e};this.setSourceRefId=function(e){m=sId};this.getSourceRefId=function(){return m};this.getName=function(){return l};this.setName=function(e){l=e};this.setSourceType=function(e){k=e};this.getSourceType=function(){return k};this.setModelId=function(e){u=e};this.getModelId=
function(){return u};this.copy=function(){var e=new H;e.setId(n);e.setSourceId(r);e.setSourceType(k);e.setName(l);e.setSourceType(k);e.setModelId(u);return e};this.toJsonObject=function(){var e={};e.id=n;e.modelSetSourceId=r;e.modelSetSourceRefId=m;e.modelId=u;e.type=k;return e};this.fromJsonObject=function(e){n=e.id;r=e.modelSetSourceId;m=e.modelSetSourceRefId;k=e.type;l=e.name}}function x(){var n=this,r,m,l,k,u,e,f,c,b,p;this.setTableId=function(d){r=d};this.getTableId=function(){return r};this.setFromNode=
function(d){m=d};this.getSourceNodeId=function(){return m};this.setName=function(d){l=d};this.getName=function(){return l};this.getFullName=function(){return m?m+"_"+l:r+"_"+l};this.setAlias=function(d){k=d};this.getAlias=function(){return k?k:l};this.setDataType=function(d){a(d);u=d};this.getDataType=function(){return u};this.setAppointedDataType=function(d){d&&a(d);e=d==u?null:d};this.getAppointedDataType=function(){return e};this.getOutputDataType=function(){return e?e:u};this.setRoundMode=function(d){c=
d};this.getRoundMode=function(){return c};this.setScale=function(d){f=d};this.getScale=function(){return f};this.getFormat=function(){return b};this.setFormat=function(d){b=d};this.setExtensions=function(d){p=d};this.getEnumValue=function(){return p?p[x.EXTENSION_BIZ_FIELD_ENUM_KEY]:null};this.isMulBaseData=function(){return p?p[x.EXTENSION_IS_MUL_BASE_DATA]:!1};this.isPk=function(){return p?p[x.EXTENSION_IS_PK]:!1};this.isEnum=function(){if(n.isMulBaseData()||n.getOutputDataType()!=x.DT_STRING)return!1;
var d=n.getEnumValue();return 0==(d?Object.keys(d):[]).length?!1:!0};this.fromJsonObject=function(d){l=d.name;k=d.alias;u=d.dataType;e=d.appointedDataType;m=d.fromNode;void 0!=d.scale&&(f=d.scale);d.roundMode&&(c=d.roundMode);p=d.extensions;d.format&&(b=d.format);d.tableId&&(r=d.tableId)};this.toJsonObject=function(){var d={};d.name=l;d.alias=k;d.dataType=u;d.fromNode=m;e&&(d.appointedDataType=e);void 0!=f&&(d.scale=f);c&&(d.roundMode=c);p&&(d.extensions=p);r&&(d.tableId=r);return d};var a=function(d){if(d!==
x.DT_STRING&&d!==x.DT_INT&&d!==x.DT_NUMBER&&d!==x.DT_DATE&&d!==x.DT_DATETIME&&d!==x.DT_BOOLEAN)throw Error("IllegalArgument: "+d);};this.clone=function(){var d=new x;d.setName(l);u&&d.setDataType(u);d.setAlias(k);e&&d.setAppointedDataType(e);d.setFromNode(m);void 0!=f&&d.setScale(f);c&&d.setRoundMode(c);d.setExtensions(p);b&&d.setFormat(b);r&&d.setTableId(r);return d};this.equals=function(d){return l==d.getName()&&k==d.getAlias()&&e==d.getAppointedDataType()&&f==d.getScale()&&c==d.getRoundMode()?
!0:!1}}function L(){var n,r,m,l;this.isExtractAllData=function(){return m};this.isPreviewAllData=function(){return l};this.setExtractPartlyData=function(k,u){n=k;r=u};this.setExtractAllDataAndPreviewCount=function(k){n=L.ALL_DATA_NUMBER;r=k};this.getExtractCount=function(){return n};this.setExtractCount=function(k){n=k};this.getPreviewCount=function(){return r};this.setPreviewCount=function(k){r=k};this.setExtractAllData=function(k){m=k};this.setPreviewAllData=function(k){l=k};this.setPreviewPartlyDataMode=
function(k,u,e){n=u;r=e;m=k};this.setPreviewPartlyDataMode=function(k,u,e,f){n=u;r=e;m=k;l=f};this.setPreviewAllDataMode=function(){l=m=!0};this.backup=function(){var k=new L;k.setExtractCount(n);k.setPreviewCount(r);k.setExtractAllData(m);k.setPreviewAllData(l);return k};this.toJsonObject=function(){var k={};k.extractCount=m?L.ALL_DATA_NUMBER:n;k.previewCount=l?L.ALL_DATA_NUMBER:r;return k}}function N(){var n=this,r,m;this.setId=function(l){r=l};this.getId=function(){return r};this.toJsonObject=
function(){var l={};l.id=r;l.type=m;n.protectedToJson(l);return l};this.protectedToJson=function(l){};this.protectedMethod={setType:function(l){m=l}}}function T(){var n=[],r,m=[];this.isValid=function(){return r};this.getCases=function(){return m};this.getCheckedNodeIds=function(){return n};this.fromJsonObject=function(l){r=l.valid;n=l.nodeIds;if(l=l.cases){m=[];for(var k=new Z,u=0;u<l.length;u++){var e=l[u],f=k.getInvalidityCase(e.type);e&&(f.fromJsonObject(e),m.push(f))}}}}function Z(){this.getInvalidityCase=
function(n){switch(n){case J.TYPE_MULTI_OUTPUT:return new D;case J.TYPE_LACK_OUTPUT:return new U;case J.TYPE_INVALID_CONFIG:return new ca;case J.TYPE_LACK_INPUT:return new da;case J.TYPE_INVALID_UPWARDNODE:return new ea;case J.TYPE_INVALID_SOURCE:return new fa;case J.TYPE_TABLE_NO_FIELD:return new ha;case J.TYPE_TABLE_NO_AUTHORITY:return new ia}}}function J(){var n,r=this;this.getType=function(){return n};this.fromJsonObject=function(m){n=m.type;r.protectedFromJsonObject(m)};this.protectedFromJsonObject=
function(m){}}function D(){J.call(this);var n=[];this.protectedFromJsonObject=function(r){n=r.outputNodes};this.getOutputNodeIds=function(){return n}}function U(){J.call(this)}function ca(){J.call(this);var n;this.protectedFromJsonObject=function(r){n=r.nodeIds};this.getNodeIds=function(){return n}}function ia(){J.call(this);var n;this.protectedFromJsonObject=function(r){n=r.nodeIds};this.getNodeIds=function(){return n}}function da(){J.call(this);var n;this.protectedFromJsonObject=function(r){n=r.nodeIds};
this.getNodeIds=function(){return n}}function ea(){J.call(this);var n;this.protectedFromJsonObject=function(r){n=r.nodeIds};this.getNodeIds=function(){return n}}function fa(){J.call(this);var n;this.protectedFromJsonObject=function(r){n=r.nodeIds};this.getNodeIds=function(){return n}}function ha(){J.call(this);var n;this.protectedFromJsonObject=function(r){n=r.nodeIds};this.getNodeIds=function(){return n}}function X(){var n,r=[],m=[];this.getField=function(l){return r[l]};this.getAllField=function(){return r};
this.getColumnCount=function(){return r?r.length:0};this.getOneRow=function(l){return m[l]};this.getRowCount=function(){return m?m.length:0};this.getNodeId=function(){return n};this.fromJsonObject=function(l){for(var k=l.fields,u=0;u<k.length;u++){var e=new x;e.fromJsonObject(k[u]);r.push(e)}m=l.data;n=l.nodeId}}function w(){var n,r,m,l,k=0,u=0,e,f=null;this.setField=function(b){(n=b)&&!b.isMulBaseData()&&r&&m&&(b=b.getOutputDataType(),b!==x.DT_DATE&&b!==x.DT_DATETIME||w.REG_DATETIME.test(m)||w.isCompareOpWithinOrNotWithinValue(r)||
(m=(new Date).getTime()));c()};this.updateNotExistFieldByMyself=function(){var b=new x;b.setFromNode(n.getSourceNodeId());b.setName(n.getName());b.setAlias(n.getAlias());n=b};this.updateNotExistField=function(b){var p=new x;p.setFromNode(b.getSourceNodeId());p.setName(b.getName());p.setAlias(b.getAlias());n=p};this.getField=function(){return n};this.getTargetFieldFullName=function(){return n?n.getFullName():null};this.setCompareOp=function(b){r=b};this.getCompareOp=function(){return r};this.setValue=
function(b){m=b;c()};this.getValue=function(){return m};this.setDisplayValue=function(b){l=b};this.getDisplayValue=function(b){return l?!b&&w.isCompareOpWithinOrNotWithinValue(r)?JSON.parse(l).join(","):w.isCompareOpRelativeDateRangeValue(r)?(b=n.getOutputDataType()===x.DT_DATETIME,K.modelToDisplayText(f,b)):l:""};this.setLeftBracketCount=function(b){k=b};this.getLeftBracketCount=function(){return k};this.setRightBracketCount=function(b){u=b};this.getRightBracketCount=function(){return u};this.setLogicOp=
function(b){e=b};this.getLogicOp=function(){return e};this.setRelativeDateRange=function(b){f=b};this.getRelativeDateRange=function(){return f};this.isEmpty=function(){return 0===k&&0===u&&!n&&!r&&!m&&!e};var c=function(){if(n&&r){var b=n.getOutputDataType();if(m){var p=n.isEnum(),a=n.isMulBaseData(),d=p?n.getEnumValue():null;if(w.isCompareOpWithinOrNotWithinValue(r))if(p){b=JSON.parse(m);p=[];for(a=0;a<b.length;a++){var t=d[b[a]];t&&p.push(t)}l=JSON.stringify(p)}else l=m;else a?l=m:b===x.DT_DATE||
b===x.DT_DATETIME?(d=new Date,d.setTime(m),p=new com.kingdee.bos.qing.common.DateFormater,a=p.setFormatString,b=b===x.DT_DATE?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",a.call(p,b),l=p.format(d)):b===x.DT_BOOLEAN?(d=com.kingdee.bos.qing.framework.common.MultilanguageManager.createPackageAccessor(y),l=m===x.BOOLEAN_TRUE?d.get("dataTypeTrue","\u771f"):m===x.BOOLEAN_FALSE?d.get("dataTypeFalse","\u5047"):""):l=p?d[m]?d[m]:"":m}else l=w.isCompareOpRelativeDateRangeValue(r)&&null!=f?K.modelToDisplayText(f,b===
x.DT_DATETIME):null}};this.copy=function(){var b=new w;b.setField(n);b.setCompareOp(r);b.setValue(m);b.setDisplayValue(l);b.setLeftBracketCount(k);b.setRightBracketCount(u);b.setLogicOp(e);b.setRelativeDateRange(f);return b};this.equals=function(b){if(!b)return!1;var p;if(p=n.equals(b.getField())&&r===b.getCompareOp()&&m===b.getValue()&&k===b.getLeftBracketCount()&&u===b.getRightBracketCount()&&e===b.getLogicOp())p=f||b.getRelativeDateRange()?f&&b.getRelativeDateRange()?JSON.stringify(f.toJsonObject())===
JSON.stringify(b.getRelativeDateRange().toJsonObject()):!1:!0;return p?!0:!1};this.toJsonObject=function(){if(!n)return null;var b={};b.field=n.toJsonObject();b.compareOp=r;b.value=m;b.displayValue=l;b.leftBrackets=k;b.rightBrackets=u;b.logicOp=e;f&&(b.relativeDateRange=f.toJsonObject());return b};this.fromJsonObject=function(b){b&&(n=new x,n.fromJsonObject(b.field),r=b.compareOp,m=b.value,l=b.displayValue,k=b.leftBrackets,u=b.rightBrackets,e=b.logicOp,b=b.relativeDateRange)&&(f=new aa,f.fromJsonObject(b))}}
function P(){var n=this,r,m=[];this.getNodeIdInConfig=function(){return[]};this.addPropertyChangeCallback=function(l){m.push(l)};this.toJsonObject=function(){var l={};l.type=r;n.protectedToJsonObject(l);return l};this.fromJsonObject=function(l){r=l.type;n.protectedFromJsonObject(l)};this.protectedToJsonObject=function(l){};this.protectedFromJsonObject=function(l){};this.protectedMethod={firePropertyChangeEvt:function(l){for(var k=0,u=m.length;k<u;k++)m[k](l)},setType:function(l){r=l}}}function ba(){P.call(this);
var n=this,r=this.protectedMethod;r.setType(P.TYPE_FILTER);var m=[];this.getFilterItems=function(){return m};this.setFilterItems=function(l){m=l};this.copyFilterItems=function(){for(var l=[],k=0;k<m.length;k++)l.push(m[k].copy());return l};this.firePropertyChangeEvt=function(){r.firePropertyChangeEvt(TableModeler.KEY_TRANSFORM_FILTER)};this.getNotEmptyFilterItems=function(){for(var l=[],k=0;k<m.length;k++)m[k].isEmpty()||l.push(m[k]);return l};this.protectedToJsonObject=function(l){for(var k=n.getNotEmptyFilterItems(),
u=[],e=0,f=k.length;e<f;e++)u.push(k[e].toJsonObject());l.filterItems=u};this.protectedFromJsonObject=function(l){if(l){l=l.filterItems;for(var k=0;k<l.length;k++){var u=new w;u.fromJsonObject(l[k]);m.push(u)}}};this.clone=function(){var l=new ba;l.setFilterItems(n.getNotEmptyFilterItems());return l}}function O(){var n=O.TYPE_ONCE,r=O.STRATEGY_FULL,m,l;this.setType=function(k){if(k===O.TYPE_ONCE||k===O.TYPE_TIMING)n=k;else throw Error("IllegalArgument: "+k);};this.getType=function(){return n};this.setStrategy=
function(k){if(k===O.STRATEGY_FULL||k===O.STRATEGY_INCREMENTAL)r=k;else throw Error("IllegalArgument: "+k);};this.getStrategy=function(){return r};this.setSchedule=function(k){m=k};this.getSchedule=function(){return m};this.setBasedFields=function(k){l=k};this.getBasedFields=function(){return l};this.copy=function(){var k=new O;k.setType(n);k.setStrategy(r);m&&k.setSchedule(m.copy());if(l){for(var u=[],e=0;e<l.length;e++)u.push(l[e].copy());k.setBasedFields(u)}return k};this.toJsonObject=function(){var k=
{};k.type=n;k.strategy=r;m&&(k.schedule=m.toJsonObject());if(l){for(var u=[],e=0;e<l.length;e++)u.push(l[e].toJsonObject());k.basedFields=u}return k};this.fromJsonObject=function(k){n=k.type;r=k.strategy;k.schedule&&(m=new V,m.fromJsonObject(k.schedule));if(k=k.basedFields){l=[];for(var u=0;u<k.length;u++){var e=new Y;e.fromJsonObject(k[u]);l.push(e)}}};this.equals=function(k){if(k instanceof O){if(n!==k.getType()||r!==k.getStrategy())return!1;var u=k.getSchedule();if(m&&!u||!m&&u)return!1;if(m&&
u){var e=m.toJsonObject();u=u.toJsonObject();for(var f in e)if(e[f]!==u[f])return!1}k=k.getBasedFields();if(!l&&!k)return!0;if(!l||!k||l.length!==k.length)return!1;for(e=0;e<l.length;e++)if(!l[e].equals(k[e]))return!1;return!0}return!1}}function Y(){var n,r,m,l;this.setTableId=function(k){n=k};this.getTableId=function(){return n};this.setTableName=function(k){r=k};this.getTableName=function(){return r};this.setName=function(k){m=k};this.getName=function(){return m};this.setAlias=function(k){l=k};
this.getAlias=function(){return l};this.copy=function(){var k=new Y;k.setTableId(n);k.setTableName(r);k.setName(m);k.setAlias(l);return k};this.toJsonObject=function(){var k={};k.tableId=n;k.tableName=r;k.name=m;k.alias=l;return k};this.fromJsonObject=function(k){n=k.tableId;r=k.tableName;m=k.name;l=k.alias};this.equals=function(k){return k instanceof Y?n===k.getTableId()&&r===k.getTableName()&&m===k.getName()&&l===k.getAlias():!1}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&
(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.designer&&(com.kingdee.bos.qing.modeler.designer={});var y=com.kingdee.bos.qing.modeler.designer;y.QingModeler=function(){var n;this.setModelerModel=function(r){n=r};this.getModelerModel=function(){return n};this.toJsonObject=
function(){var r={};r.modelerModel=n.toJsonObject();return r};this.fromJsonObject=function(r){(r=r.modelerModel)&&(n=y.ModelerModerParser.parseToModel(r.type,r))}};y.AbstractModelerModelParser=function(){this.parseToModel=function(n){throw Error("override me");}};y.ModelerModel=v;y.AbstractPage=function(){function n(e,f,c,b){this.getLeftExtension=function(){return e};this.getTopExtension=function(){return f};this.getHorizonExtension=function(){return e+c};this.getVerticalExtension=function(){return f+
b}}var r=this,m=1024,l=768,k=[];this.getWidth=function(){return m};this.getHeight=function(){return l};this.addPropertyChangeCallback=function(e){k.push(e)};this.setExtension=function(e,f,c,b){e=new n(e,f,c,b);m+=e.getHorizonExtension();l+=e.getVerticalExtension();u(v.KEY_PAGE_SIZE,e)};this.toJsonObject=function(){var e={};e.width=m;e.height=l;r.protectedToJsonObject(e);return e};this.fromJsonObject=function(e){m=e.width;l=e.height;r.protectedFromJsonObject(e)};this.protectedToJsonObject=function(e){};
this.protectedFromJsonObject=function(e){};var u=function(e,f){for(var c=0,b=k.length;c<b;c++)k[c](e,f)};this.protectedMethod={firePropertyChangeEvt:u}};y.Node=C;y.Table=B;y.DesignTimeSource=H;y.Field=x;y.UserSQL=G;y.PreviewConfig=L;y.RuntimeModel=function(){var n,r=[],m=[],l;this.setOutputVertexId=function(k){n=k};this.addEdge=function(k){r.push(k)};this.addVertex=function(k){m.push(k)};this.getVertexes=function(){return m};this.setPreviewConfig=function(k){l=k};this.toJsonObject=function(){for(var k=
{},u=[],e=[],f=0,c=r.length;f<c;f++)u.push(r[f].toJsonObject());f=0;for(c=m.length;f<c;f++)e.push(m[f].toJsonObject());k.edges=u;k.vertexes=e;k.outputVertexId=n;k.previewConfig=l?l.toJsonObject():null;return k}};y.Edge=function(n,r){this.toJsonObject=function(){var m={};m.fromId=n;m.toId=r;return m}};y.SourceVertex=function(){N.call(this);var n,r,m;this.protectedMethod.setType(N.TYPE_SOURCE);this.setTable=function(l){n=l};this.setSource=function(l){r=l};this.setSelectedFields=function(l){m=l};this.protectedToJson=
function(l){l.table=n.toJsonObject();l.source=r.toJsonObject();if(m){for(var k=[],u=0;u<m.length;u++)k.push(m[u].toJsonObject());l.selectedFields=k}}};y.ExecuteResult=function(){var n,r=[],m,l;this.getNodeId=function(){return n};this.getValidity=function(){return l};this.getPreviewData=function(){return m};this.getFields=function(){return r};this.fromJsonObject=function(k){n=k.nodeId;var u=k.validity;u&&(l=new T,l.fromJsonObject(u));if(u=k.previewData)m=new X,m.fromJsonObject(u);if(k=k.fields)for(u=
0;u<k.length;u++){var e=k[u],f=new x;f.fromJsonObject(e);r.push(f)}}};y.PreviewData=X;y.PreviewResult=function(){var n,r,m,l,k;this.getPreviewData=function(){return n};this.getTotalRowCount=function(){return m};this.getJobId=function(){return l};this.getJobName=function(){return k};this.getModelerValidity=function(){return r};this.fromJsonObject=function(u){u.modelerValidity?r=u.modelerValidity:(n=new X,n.fromJsonObject(u.previewData),l=u.jobId,k=u.jobName,m=u.totalRowCount)}};y.FilterItem=w;y.MaterializedConfig=
O;y.BasedField=Y;y.FilterConfig=ba;var aa,K,V;(function(){var n=com.kingdee.bos.qing.common;aa=n.RelativePeriodModel;n=com.kingdee.bos.qing.common.ui;K=n.RelativePeriodPanel;n=com.kingdee.bos.qing.schedule;V=n.QingSchedule})();y.ModelerModerParser=new function(){var n={};this.registerParser=function(r,m){n[r]=m};this.parseToModel=function(r,m){return(r=n[r])&&r.parseToModel(m)}};v.TYPE_TABLE_MODELER="table";v.TYPE_RELATION_MODELER="relation";v.TYPE_METRIC_MODELER="metric";v.KEY_UPDATE_TABLE="update_table";
v.KEY_ADD_TABLE="add_table";v.KEY_REMOVE_TABLE="remove_table";v.KEY_TABLE_SELECT_FIELD="table_select_field";v.KEY_TABLE_SET_FILTER="table_set_filter";v.KEY_PAGE_SIZE="page_change_size";v.KEY_ADD_PREPARED_SOURCE="add_prepared_source";v.KEY_REMOVE_PREPARED_SOURCE="remove_prepared_source";v.KEY_SET_PREPARED_SOURCE="set_prepared_source";v.KEY_NODE_CHANGE_ALIAS="node_change_alias";v.KEY_NODE_CHANGE_POSITION="node_change_position";v.KEY_TABLE_NODE_SELECT_FIELD="table_node_select_field";C.TYPE_TABLE="table";
C.TYPE_TRANSFORM="transform";x.DT_BOOLEAN="BOOLEAN";x.DT_INT="INT";x.DT_NUMBER="NUMBER";x.DT_DATE="DATE";x.DT_DATETIME="DATETIME";x.DT_STRING="STRING";x.ROUND_MODE_UP="ROUND_UP";x.ROUND_MODE_DOWN="ROUND_DOWN";x.ROUND_MODE_HALF_UP="ROUND_HALF_UP";x.BOOLEAN_TRUE="true";x.BOOLEAN_FALSE="false";x.EXTENSION_BIZ_FIELD_ENUM_KEY="bizFieldEnumKey";x.EXTENSION_IS_MUL_BASE_DATA="isMulBaseData";x.EXTENSION_IS_PK="isPK";y.UIDHelper=new function(){var n,r={};this.init=function(a,d){r={};n=a;d&y.UIDHelper.SUPPORT_TYPE_NODE&&
f();d&y.UIDHelper.SUPPORT_TYPE_SOURCE&&c();d&y.UIDHelper.SUPPORT_TYPE_TABLE&&b();d&y.UIDHelper.SUPPORT_TYPE_LINE&&p();d&y.UIDHelper.SUPPORT_TYPE_DIMENSION&&l();d&y.UIDHelper.SUPPORT_TYPE_PUBLIC_DIMENSION&&k();d&y.UIDHelper.SUPPORT_TYPE_METRIC&&u();d&y.UIDHelper.SUPPORT_TYPE_REFERENCE&&e()};this.getUID=function(a){var d=r[a];d||(d=0);d+=1;r[a]=d;return a+d};var m=function(a,d,t){for(var A=0,h=0;h<d.length;h++)for(var g=t(d[h]),q=0;q<g.length;q++){var z=g[q];A=Math.max(A,parseInt(z.slice(a.length,z.length)))}r[a]=
A},l=function(){var a=n.getAllDimension();a&&m(y.UIDHelper.NS_DIMENSION,a,function(d){return[d.getDimensionId()]})},k=function(){var a=n.getPublicDimensions();a&&m(y.UIDHelper.NS_PUBLIC_DIMENSION,a,function(d){return[d.getId()]});(a=n.getAllDimension())&&m(y.UIDHelper.NS_PUBLIC_DIMENSION,a,function(d){return[d.getPublicDimensionId()]})},u=function(){var a=n.getAllMetric();a&&m(y.UIDHelper.NS_METRIC,a,function(d){return[d.getId()]})},e=function(){var a=n.getExprReferences();a&&m(y.UIDHelper.NS_REFERENCE,
a,function(d){return[d.getId()]})},f=function(){var a=n.getAllNodes();a&&m(y.UIDHelper.NS_NODE,a,function(d){var t=[];t.push(d.getId());d.getType()==C.TYPE_TRANSFORM&&(d=d.getNodeIdInConfig(),t=t.concat(d));return t})},c=function(){var a=n.getAllSource();a&&m(y.UIDHelper.NS_SOURCE,a,function(d){return[d.getId()]})},b=function(){var a=n.getAllTable();a&&m(y.UIDHelper.NS_TABLE,a,function(d){return[d.getUid()]})},p=function(){var a=n.getAllLines();a&&m(y.UIDHelper.NS_LINE,a,function(d){return[d.getId()]})}};
y.UIDHelper.NS_NODE="n";y.UIDHelper.NS_LINE="l";y.UIDHelper.NS_TABLE="t";y.UIDHelper.NS_SOURCE="s";y.UIDHelper.NS_DIMENSION="d";y.UIDHelper.NS_PUBLIC_DIMENSION="pd";y.UIDHelper.NS_METRIC="m";y.UIDHelper.NS_REFERENCE="r";y.UIDHelper.SUPPORT_TYPE_NODE=1;y.UIDHelper.SUPPORT_TYPE_LINE=2;y.UIDHelper.SUPPORT_TYPE_TABLE=4;y.UIDHelper.SUPPORT_TYPE_SOURCE=8;y.UIDHelper.SUPPORT_TYPE_DIMENSION=16;y.UIDHelper.SUPPORT_TYPE_PUBLIC_DIMENSION=32;y.UIDHelper.SUPPORT_TYPE_METRIC=64;y.UIDHelper.SUPPORT_TYPE_REFERENCE=
128;y.UIDHelper.METRIC_SCENE=y.UIDHelper.SUPPORT_TYPE_TABLE|y.UIDHelper.SUPPORT_TYPE_SOURCE|y.UIDHelper.SUPPORT_TYPE_DIMENSION|y.UIDHelper.SUPPORT_TYPE_PUBLIC_DIMENSION|y.UIDHelper.SUPPORT_TYPE_METRIC|y.UIDHelper.SUPPORT_TYPE_REFERENCE;L.ALL_DATA_NUMBER=-1;N.TYPE_SOURCE="source";N.TYPE_TRANSFORM_FIELD_SELECT="field_select";N.TYPE_TRANSFORM_FIELD_SETTING="field_setting";N.TYPE_TRANSFORM_GROUP_BY="group_by";N.TYPE_TRANSFORM_FILTER="filter";N.TYPE_TRANSFORM_SORT="sort";N.TYPE_TRANSFORM_JOIN="join";J.TYPE_MULTI_OUTPUT=
"multiOutput";J.TYPE_LACK_OUTPUT="lackOutputNode";J.TYPE_INVALID_CONFIG="invalidConfig";J.TYPE_LACK_INPUT="lackInputNode";J.TYPE_INVALID_UPWARDNODE="invalidUpwardNode";J.TYPE_INVALID_SOURCE="invalidSource";J.TYPE_TABLE_NO_FIELD="tableNoField";J.TYPE_TABLE_NO_AUTHORITY="tableNoAuthority";w.REG_NUMBER=/^-?\d+(\.\d+)?$/;w.REG_DATETIME=/^-?\d+(\.\d+)?$/;w.COMPARE_EQUAL="EQUAL";w.COMPARE_NOT_EQUAL="NOT_EQUAL";w.COMPARE_GREATER="GREATER";w.COMPARE_GREATER_EQUAL="GREATER_EQUAL";w.COMPARE_LESS="LESS";w.COMPARE_LESS_EQUAL=
"LESS_EQUAL";w.COMPARE_INCLUDE="INCLUDE";w.COMPARE_NOT_INCLUDE="NOT_INCLUDE";w.COMPARE_START_WITH="START_WITH";w.COMPARE_END_WITH="END_WITH";w.COMPARE_NULL="NULL";w.COMPARE_NOT_NULL="NOT_NULL";w.COMPARE_IN="IN";w.COMPARE_NOT_IN="NOT_IN";w.COMPARE_RELATIVE_DATE_RANGE="RELATIVE_DATE_RANGE";w.LOGIC_AND="AND";w.LOGIC_OR="OR";w.COMPARES_FOR_STRING=[w.COMPARE_EQUAL,w.COMPARE_NOT_EQUAL,w.COMPARE_INCLUDE,w.COMPARE_NOT_INCLUDE,w.COMPARE_START_WITH,w.COMPARE_END_WITH,w.COMPARE_NULL,w.COMPARE_NOT_NULL,w.COMPARE_IN,
w.COMPARE_NOT_IN];w.COMPARES_FOR_ENUM=[w.COMPARE_EQUAL,w.COMPARE_NOT_EQUAL,w.COMPARE_NULL,w.COMPARE_NOT_NULL,w.COMPARE_IN,w.COMPARE_NOT_IN];w.COMPARES_FOR_NUMBER=[w.COMPARE_EQUAL,w.COMPARE_NOT_EQUAL,w.COMPARE_GREATER,w.COMPARE_GREATER_EQUAL,w.COMPARE_LESS,w.COMPARE_LESS_EQUAL,w.COMPARE_NULL,w.COMPARE_NOT_NULL,w.COMPARE_IN,w.COMPARE_NOT_IN];w.COMPARES_FOR_DATETIME=[w.COMPARE_RELATIVE_DATE_RANGE,w.COMPARE_EQUAL,w.COMPARE_NOT_EQUAL,w.COMPARE_GREATER,w.COMPARE_GREATER_EQUAL,w.COMPARE_LESS,w.COMPARE_LESS_EQUAL,
w.COMPARE_NULL,w.COMPARE_NOT_NULL];w.COMPARES_FOR_BOOLEAN=[w.COMPARE_EQUAL,w.COMPARE_NOT_EQUAL,w.COMPARE_NULL,w.COMPARE_NOT_NULL];w.isCompareOpWithoutValue=function(n){return n===w.COMPARE_NULL||n===w.COMPARE_NOT_NULL};w.isCompareOpWithinOrNotWithinValue=function(n){return n===w.COMPARE_IN||n===w.COMPARE_NOT_IN};w.isCompareOpRelativeDateRangeValue=function(n){return n===w.COMPARE_RELATIVE_DATE_RANGE};w.getSelectableCompares=function(n,r){switch(n){case x.DT_STRING:return r?w.COMPARES_FOR_ENUM:w.COMPARES_FOR_STRING;
case x.DT_NUMBER:case x.DT_INT:return w.COMPARES_FOR_NUMBER;case x.DT_DATE:case x.DT_DATETIME:return w.COMPARES_FOR_DATETIME;case x.DT_BOOLEAN:return w.COMPARES_FOR_BOOLEAN;default:throw Error("Unknown DataType");}};w.FiltersCheckingResult=function(n,r){var m=r;this.getFiltersErrorRow=function(){return n};this.getPrompt=function(){return m};this.setPrompt=function(l){m=l}};P.TYPE_FIELD_SELECT="field_select";P.TYPE_FIELD_SETTING="field_setting";P.TYPE_FILTER="filter";P.TYPE_SORT="sort";P.TYPE_GROUP_BY=
"group_by";P.TYPE_CALCULATED_FIELD="calculated_field";P.TYPE_CUSTOM_GROUP="custom_group";P.TYPE_JOIN="join";P.TYPE_UNION="union";O.TYPE_ONCE="once";O.TYPE_TIMING="timing";O.STRATEGY_FULL="full";O.STRATEGY_INCREMENTAL="incremental";y.ENTITY_SEPARATOR="@#!&@"})();(function(){function v(){V.call(this);var e=this,f=this.protectedMethod,c=[],b=[],p=[],a=[],d=[];e.setType(V.TYPE_METRIC_MODELER);e.setMaterializedConfig(new u);this.protectedIsTableInUse=function(h){return!0};this.isTableReferred=function(h){t();for(var g=0;g<a.length;g++){var q=a[g];if(q instanceof L&&q.getTableId()==h.getUid())return!0}for(g=0;g<c.length;g++){q=c[g].getFilterItems();for(var z=0;z<q.length;z++){var E=q[z].getField();if(E&&E.getTableId()==h.getUid())return!0}}return!1};this.getAllDimension=
function(){return b};this.setDimensions=function(h){b=h};this.addDimension=function(h,g){isNaN(g)?b.push(h):b.splice(g,0,h);f.firePropertyChangeEvt(v.KEY_ADD_DIMENSION,h)};this.removeDimension=function(h){for(var g=0;g<b.length;g++)if(b[g].isSame(h))return b.splice(g,1),f.firePropertyChangeEvt(v.KEY_REMOVE_DIMENSION,[h]),g;return-1};this.updateDimension=function(h,g){if(isNaN(g))return!1;b.splice(g,1);b.splice(g,0,h);f.firePropertyChangeEvt(v.KEY_UPDATE_DIMENSION,b)};this.updateDimensions=function(h){b=
h;f.firePropertyChangeEvt(v.KEY_BATCH_UPDATE_DIMENSION,h)};this.getDimensionById=function(h){for(var g=0;g<b.length;g++)if(b[g].getDimensionId()==h)return b[g]};this.getDimensionByName=function(h){for(var g=0;g<b.length;g++)if(b[g].getName()==h)return b[g]};this.getPublicDimensions=function(){return p};this.getPublicDimensionById=function(h){for(var g=0;g<p.length;g++)if(p[g].getId()==h)return p[g]};this.getSamePublicDimension=function(h){for(var g=0;g<p.length;g++){var q=p[g];if(q.isSame(h))return q}};
this.setPublicDimensions=function(h){p=h};this.removePublicDimensionById=function(h){for(var g=0;g<p.length;g++)if(p[g].getId()==h)return p.splice(g,1),g;return-1};this.addPublicDimension=function(h,g){isNaN(g)?p.push(h):p.splice(g,0,h)};this.checkDimensionRef=function(h,g){var q=e.getAllTable();if(g&&2<=q.length)return!0;for(g=0;g<b.length;g++)if(b[g].getPublicDimensionId()==h)return!0;return!1};this.checkTableExist=function(h){for(var g=e.getAllTable(),q=0;q<g.length;q++)if(h==g[q].getUid())return!0;
return!1};this.setMetrics=function(h){if((c=h)&&0<c.length)for(h=0;h<c.length;h++){var g=c[h];g.removePropertyChangeCallback(f.firePropertyChangeEvt);g.addPropertyChangeCallback(f.firePropertyChangeEvt)}};this.addMetric=function(h,g){isNaN(g)?c.push(h):c.splice(g,0,h);h.addPropertyChangeCallback(f.firePropertyChangeEvt);f.firePropertyChangeEvt(v.KEY_ADD_METRIC,h)};this.removeMetric=function(h){var g=c.indexOf(h);return-1<g?(c.splice(g,1),f.firePropertyChangeEvt(v.KEY_REMOVE_METRIC,h),h.removePropertyChangeCallback(f.firePropertyChangeEvt),
g):-1};this.updateMetric=function(h){var g=e.getMetric(h.getId());g&&(g.update(h),f.firePropertyChangeEvt(v.KEY_UPDATE_METRIC,g))};this.getAllMetric=function(){return c};this.getMetric=function(h){for(var g=0;g<c.length;g++){var q=c[g];if(q.getId()==h)return q}};this.setExprReferences=function(h){a=h};this.setUnreferencedRef=function(h){d=h};this.getExprReferences=function(){return a};this.getExprReference=function(h){for(var g=0;g<a.length;g++){var q=a[g];if(h==q.getId())return q}};this.addExprRefIfNotExist=
function(h){for(var g=0;g<a.length;g++){var q=a[g];if(q.equals(h))return q}for(g=0;g<d.length;g++)if(q=d[g],q.equals(h)){h=q;d.splice(g,1);break}a.push(h);return h};this.protectedToJsonObject=function(h){for(var g=[],q=0;q<c.length;q++)g.push(c[q].toJsonObject());h.metrics=g;t();g=[];for(q=0;q<a.length;q++)g.push(a[q].toJsonObject());h.references=g;g=[];for(q=0;q<d.length;q++)g.push(d[q].toJsonObject());h.unreferencedRef=g;g=[];for(q=0;q<b.length;q++)g.push(b[q].toJsonObject());h.dimensions=g;g=[];
for(q=0;q<p.length;q++)p[q].isEmpty()||g.push(p[q].toJsonObject());h.publicDimensions=g;e.getMaterializedConfig()||(q=new u,h.materializedConfig=q.toJsonObject())};this.protectedFromJsonObject=function(h){var g=h.metrics;if(g)for(var q=0;q<g.length;q++){var z=new C;z.fromJsonObject(g[q]);z.addPropertyChangeCallback(f.firePropertyChangeEvt);c.push(z)}if(g=h.references)for(q=0;q<g.length;q++){z=g[q];switch(z.type){case x.FIELD_TYPE:var E=new L;break;case x.METRIC_TYPE:E=new N;break;case x.DIMENSION_TYPE:E=
new T;break;default:throw Error("unknown type");}E.fromJsonObject(z);a.push(E)}if(g=h.dimensions)for(q=0;q<g.length;q++)z=new B,z.fromJsonObject(g[q]),b.push(z);if(h=h.publicDimensions)for(q=0;q<h.length;q++)g=new G,g.fromJsonObject(h[q]),p.push(g);g=A();q=[];for(h=0;h<g.length;h++)z=g[h],e.getExprReference(z)||q.push(z);for(h=0;h<q.length;h++)for(g=q[h],z=0;z<c.length;z++){E=c[z];var I=E.getExpr();E.setExpr(K.ExprRefHelper.replaceRefText(I,g,""))}};this.copyMetrics=function(){for(var h=[],g=0;g<
c.length;g++){var q=c[g].clone();h.push(q)}return h};this.copyExprReferences=function(){for(var h=[],g=0;g<a.length;g++){var q=a[g].copy();h.push(q)}return h};this.copy=function(){var h=new v;f.copy(h);for(var g=[],q=0;q<c.length;q++)g.push(c[q].clone());h.setMetrics(g);g=[];for(q=0;q<b.length;q++)g.push(b[q].copy());h.setDimensions(g);g=[];for(q=0;q<p.length;q++)g.push(p[q].copy());h.setPublicDimensions(g);g=[];for(q=0;q<a.length;q++)g.push(a[q].copy());h.setExprReferences(g);g=[];for(q=0;q<d.length;q++)g.push(d[q].copy());
h.setUnreferencedRef(g);return h};var t=function(){for(var h=A(),g=[],q=[],z=0;z<a.length;z++){var E=a[z];-1<h.indexOf(E.getId())?g.push(E):q.push(E)}a=g;d=q},A=function(){for(var h=[],g=0;g<c.length;g++){var q=c[g].getExpr();(q=K.ExprRefHelper.getRefTextInExpr(q))&&(h=h.concat(q))}return h}}function C(){var e=this,f,c,b,p,a,d="#,##0.00",t=[],A=[];this.addPropertyChangeCallback=function(h){A.push(h)};this.removePropertyChangeCallback=function(h){h=A.indexOf(h);-1<h&&A.splice(h,1)};this.setNumber=
function(h){f=h};this.getNumber=function(){return f};this.setId=function(h){c=h};this.getId=function(){return c};this.setName=function(h){b=h};this.getName=function(){return b};this.setDesc=function(h){p=h};this.getDesc=function(){return p};this.setExpr=function(h){a=h};this.getExpr=function(){return a};this.setFormat=function(h){d=h};this.getFormat=function(){return d};this.setFilterItems=function(h){t=h;h=v.KEY_SET_METRIC_FILTER;for(var g=0,q=A.length;g<q;g++)A[g](h,e)};this.getFilterItems=function(){return t};
this.update=function(h){f=h.getNumber();a=h.getExpr();b=h.getName();p=h.getDesc();h.getFormat()&&(d=h.getFormat());t=h.getFilterItems()};this.clone=function(){var h=new C;h.setNumber(f);h.setId(c);h.setExpr(a);h.setName(b);h.setDesc(p);h.setFormat(d);for(var g=[],q=0;q<t.length;q++){var z=t[q].copy();g.push(z)}h.setFilterItems(g);return h};this.equals=function(h){if(h.getName()!==b||h.getDesc()!==p||h.getExpr()!==a||h.getFormat()!==d||h.getNumber()!==f||t.length!==h.getFilterItems().length)return!1;
h=h.getFilterItems();for(var g=0;g<t.length;g++)if(!t[g].equals(h[g]))return!1;return!0};this.toJsonObject=function(){var h={};h.number=f;h.id=c;h.name=b;h.desc=p;h.expr=a;h.format=d;for(var g=[],q=0;q<t.length;q++)g.push(t[q].toJsonObject());h.filterItems=g;return h};this.fromJsonObject=function(h){c=h.id;f=h.number;b=h.name;p=h.desc;a=h.expr;h.format&&(d=h.format);if(h=h.filterItems)for(var g=0;g<h.length;g++){var q=new k;q.fromJsonObject(h[g]);t.push(q)}}}function B(){var e,f,c,b=!1,p=!1,a,d,t,
A,h=this;this.setDimensionId=function(g){e=g};this.getDimensionId=function(){return e};this.setName=function(g){f=g};this.getName=function(){return f};this.setNumber=function(g){c=g};this.getNumber=function(){return c};this.setNumberModified=function(g){b=g};this.isNumberModified=function(){return b};this.setNameModified=function(g){p=g};this.isNameModified=function(){return p};this.setDimensionType=function(g){a=g};this.getDimensionType=function(){return a};this.setDateFormat=function(g){d=g};this.getDateFormat=
function(){return d};this.setRequired=function(g){t=g};this.isRequired=function(){return t};this.getPublicDimensionId=function(){return A};this.setPublicDimensionId=function(g){A=g};this.copy=function(){var g=new B;g.setDimensionId(e);g.setName(f);g.setNumber(c);g.setNumberModified(b);g.setNameModified(p);g.setDimensionType(a);d?g.setDateFormat(d):a==B.TYPE_DATE&&g.setDateFormat(B.VALUE_YYYY);g.setRequired(t);g.setPublicDimensionId(A);return g};this.isSame=function(g){return g?f==g.getName()&&c==
g.getNumber()&&b==g.isNumberModified()&&p==g.isNameModified()&&a==g.getDimensionType()&&e==g.getDimensionId()&&(d==g.getDateFormat()||null==d&&g.getDateFormat()==B.VALUE_YYYY)&&A==g.getPublicDimensionId()?!0:!1:!1};this.toJsonObject=function(){var g={};g.id=e;g.name=f;g.number=c;g.isNumberModified=b;g.isNameModified=p;g.dimensionType=a;g.dateFormatType=d;g.required=t;g.publicDimensionId=A;return g};this.fromJsonObject=function(g){e=g.id;f=g.name;c=g.number;b=g.isNumberModified;p=g.isNameModified;
a=g.dimensionType;void 0!=g.dateFormatType&&h.setDateFormat(g.dateFormatType);g.required&&h.setRequired(g.required);A=g.publicDimensionId}}function G(){var e,f,c=!1,b=[];this.setId=function(a){e=a};this.getId=function(){return e};this.setName=function(a){f=a};this.getName=function(){return f};this.setNameModified=function(a){c=a};this.isNameModified=function(){return c};this.isSame=function(a){if(!a)return!1;a=a.getFields();if(a.length!=b.length)return!1;for(var d=0;d<b.length;d++)if(!b[d].isSame(a[d]))return!1;
return!0};this.getDataType=function(){return 0==b.length?null:b[0].getDataType()};this.setFields=function(a){b=a};this.addField=function(a){b.push(a)};this.insertField=function(a,d){b.splice(a,0,d)};this.getFields=function(){return b};this.getFieldByIndex=function(a){return b[a]};this.getLastField=function(){return b[b.length-1]};this.removeField=function(a){b.splice(a,1)};this.empty=function(a){f=null;a&&(e=null)};this.isEmpty=function(){return!f};this.updateFields=function(a){for(var d=0;d<b.length;d++){var t=
b[d];if(t&&t.getName()){var A=t.getTableId();A=a[A]?a[A]:[];for(var h=!1,g=0;g<A.length;g++)if(A[g]&&A[g].getName()==t.getName()){h=!0;t.update(A[g]);break}h||t.updateWhenNotExist();t.setExist(h)}}};this.isDataTypeConsistent=function(){if(0==b.length)return!1;var a=b[0];if(!a)return!1;for(var d=1;d<b.length;d++){var t=b[d];if(!t||a.getDataType()!=t.getDataType()||!p(a.getField(),t.getField()))return!1}return!0};this.tryGenerateId=function(a){var d=!0;if(a){a=a.getFields();for(var t=0;t<b.length;t++){var A=
a[t].getField().getFullName(),h=b[t].getField().getFullName();if(A==h){d=!1;break}}}else d=!1;if(!e||d)d=com.kingdee.bos.qing.modeler.designer.UIDHelper,e=d.getUID(d.NS_PUBLIC_DIMENSION)};this.tryGenerateName=function(a){if(0!=b.length){var d=b[0];f=c||!d.getAlias()?f:a()}};this.isFieldsCompleted=function(){for(var a=!1,d=0;d<b.length;d++)b[d].getName()&&(a=!0);if(!a&&!f)return!0;for(d=0;d<b.length;d++)if(a=b[d],!a.getName()||!a.isExist())return!1;return!0};this.copy=function(){var a=new G;a.setId(e);
a.setName(f);for(var d=[],t=0;t<b.length;t++){var A=b[t].copy();d.push(A)}a.setFields(d);a.setNameModified(c);return a};this.toJsonObject=function(){var a={};a.id=e;a.name=f;a.isNameModified=c;for(var d=[],t=0;t<b.length;t++)d.push(b[t].toJsonObject());a.fields=d;return a};this.fromJsonObject=function(a){e=a.id;f=a.name;c=a.isNameModified;if(a=a.fields)for(var d=0;d<a.length;d++){var t=new H;t.fromJsonObject(a[d]);b.push(t)}};var p=function(a,d){a=a?a.getEnumValue():null;d=d?d.getEnumValue():null;
if(!a&&!d)return!0;if(!a&&d||a&&!d||Object.keys(d).length!=Object.keys(a).length)return!1;for(var t in d){var A=d[t],h=a[t];if(!h||h!=A)return!1}return!0}}function H(){var e=new m,f=!0;this.getField=function(){return e};this.setField=function(c){e=c};this.setName=function(c){e.setName(c)};this.getName=function(){return e.getName()};this.getTableId=function(){return e.getTableId()};this.setTableId=function(c){e.setTableId(c)};this.getDataType=function(){return e.getDataType()};this.setDataType=function(c){e.setDataType(c)};
this.getAlias=function(){return e.getAlias()};this.setAlias=function(c){e.setAlias(c)};this.setExist=function(c){f=c};this.isExist=function(){return f};this.update=function(c){e=c};this.updateWhenNotExist=function(){var c=new m;c.setName(e.getName());c.setTableId(e.getTableId());c.setAlias(e.getAlias());e=c};this.copy=function(){var c=new H;c.setField(e);c.setExist(f);return c};this.isSame=function(c){return e.getName()==c.getName()&&e.getTableId()==c.getTableId()?!0:!1};this.toJsonObject=function(){var c=
{};c.name=e.getName();c.tableId=e.getTableId();c.alias=e.getAlias();return c};this.fromJsonObject=function(c){e.setName(c.name);e.setTableId(c.tableId);e.setAlias(c.alias)}}function x(){var e=this,f,c;this.setId=function(b){f=b};this.getId=function(){return f};this.setType=function(b){c=b};this.getType=function(){return c};this.getRefDisplayText=function(b){throw Error("override me");};this.isRightDisplayFormat=function(b,p){throw Error("override me");};this.fromDisplayText=function(b,p,a){throw Error("override me");
};this.equals=function(b){throw Error("override me");};this.fromJsonObject=function(b){f=b.id;c=b.type;e.protectedFromJsonObject(b)};this.toJsonObject=function(){var b={};b.id=f;b.type=c;e.protectedToJsonObject(b);return b};this.protectedFromJsonObject=function(b){};this.protectedToJsonObject=function(b){};this.protectedMethod={copy:function(b){b.setId(f);b.setType(c)}}}function L(){x.call(this);var e=this,f=this.protectedMethod,c,b,p;e.setType(x.FIELD_TYPE);this.setTableId=function(a){c=a};this.getTableId=
function(){return c};this.setFieldName=function(a){b=a};this.getFieldName=function(){return b};this.setAlias=function(a){p=a};this.getRefDisplayText=function(a){a=a.getTable(c);var d=p?p:b;return K.TableNameHelper.getDisplayText(a)+"."+d};this.isRightDisplayFormat=function(a){return-1<a.indexOf(".")};this.fromDisplayText=function(a,d,t){var A=a.split(".")[0];c=A;var h=d.getAllTable();for(d=0;d<h.length;d++){var g=h[d];if(K.TableNameHelper.getDisplayText(g)==A){c=g.getUid();break}}b=a=a.substring(A.length+
1);t=t?t[c]:[];for(d=0;d<t.length;d++)if(A=t[d],A.getAlias()==a){b=A.getName();p=a;break}};this.equals=function(a){return a.getType()!=e.getType()?!1:a.getTableId()==c&&a.getFieldName()==b?!0:!1};this.copy=function(){var a=new L;f.copy(a);a.setTableId(c);a.setFieldName(b);a.setAlias(p);return a};this.protectedFromJsonObject=function(a){c=a.tableId;b=a.fieldName;p=a.alias};this.protectedToJsonObject=function(a){a.tableId=c;a.fieldName=b}}function N(){x.call(this);var e=this,f=this.protectedMethod,
c;e.setType(x.METRIC_TYPE);this.setMetricId=function(b){c=b};this.getMetricId=function(){return c};this.getRefDisplayText=function(b){return(b=b.getMetric(c))?b.getName():""};this.isRightDisplayFormat=function(b,p){var a=b.match(/^[\u3000\u4E00-\u9FA5a-zA-Z0-9_]{1,}$/),d=!1;if(a){p=p.getAllMetric();for(var t=0;t<p.length;t++)p[t].getName()==b&&(d=!0)}return a&&d};this.fromDisplayText=function(b,p){p=p.getAllMetric();for(var a=0;a<p.length;a++){var d=p[a];if(d.getName()==b){c=d.getId();break}}if(!c)throw Error("invalid ref");
};this.equals=function(b){return b.getType()!=e.getType()?!1:c==b.getMetricId()};this.copy=function(){var b=new N;f.copy(b);b.setMetricId(c);return b};this.protectedFromJsonObject=function(b){c=b.metricId};this.protectedToJsonObject=function(b){b.metricId=c}}function T(){x.call(this);var e=this,f=this.protectedMethod,c,b;e.setType(x.DIMENSION_TYPE);this.setDimensionId=function(p){c=p};this.getDimensionId=function(){return c};this.setDimensionName=function(p){b=p};this.getDimensionName=function(){return b};
this.getRefDisplayText=function(p){var a=p.getDimensionById(c);a||(a=p.getDimensionByName(b));return a?a.getName():b};this.isRightDisplayFormat=function(p,a){var d=p.match(/^[\u3000\u4E00-\u9FA5a-zA-Z0-9_()]{1,}$/),t=!1;if(d){a=a.getAllDimension();for(var A=0;A<a.length;A++)a[A].getName()==p&&(t=!0)}return d&&t};this.fromDisplayText=function(p,a){a=a.getAllDimension();for(var d=0;d<a.length;d++){var t=a[d];if(t.getName()==p){c=t.getDimensionId();b=t.getName();break}}if(!c)throw Error("invalid ref");
};this.equals=function(p){return p.getType()!=e.getType()?!1:c==p.getDimensionId()&&b==p.getDimensionName()};this.copy=function(){var p=new T;f.copy(p);p.setDimensionId(c);p.setDimensionName(b);return p};this.protectedFromJsonObject=function(p){c=p.dimensionId;b=p.dimensionName};this.protectedToJsonObject=function(p){p.dimensionId=c;p.dimensionName=b}}function Z(){var e,f,c=[];this.isValid=function(){return e};this.getCases=function(){return c};this.isModelEmpty=function(){return f};this.fromJsonObject=
function(b){e=b.valid;f=b.modelIsEmpty;if(b=b.cases){c=[];for(var p=new J,a=0;a<b.length;a++){var d=b[a],t=p.getInvalidityCase(d.type);d&&(t.fromJsonObject(d),c.push(t))}}}}function J(){this.getInvalidityCase=function(e){switch(e){case D.TYPE_NO_METRIC:return new ca;case D.TYPE_INVALID_FIELD_REF:return new ia;case D.TYPE_INVALID_EXPR:return new fa;case D.TYPE_INVALID_FIELD_FILTER_REF:return new da;case D.TYPE_INVALID_DIMENSION_REF:return new w;case D.TYPE_INVALID_DIMENSION_TYPE:return new P;case D.TYPE_INVALID_PUBLIC_DIMENSION:return new O;
case D.TYPE_INVALID_TABLE:return new aa;case D.TYPE_INVALID_EXPR_DATA_TYPE:return new ha;case D.TYPE_INCOMPLETE_MATERIALIZED_CONFIG:return new Y;case D.TYPE_INVALID_DIMENSION_NOT_EXIST:case D.TYPE_INVALID_DIMENSION_GRANULARITY_NOT_MATCH:case D.TYPE_INVALID_DIMENSION_TYPE_NOT_MATCH:return new ea}}}function D(){var e,f=this;this.getType=function(){return e};this.fromJsonObject=function(c){e=c.type;f.protectedFromJsonObject(c)};this.protectedFromJsonObject=function(c){}}function U(){D.call(this);var e=
[];this.getMetricIds=function(){return e};this.protectedFromJsonObject=function(f){f&&f.metricIds&&(e=f.metricIds)}}function ca(){D.call(this)}function ia(){U.call(this)}function da(){U.call(this)}function ea(){U.call(this)}function fa(){U.call(this);var e;this.getMetricPrompt=function(c){if(!e)return null;for(var b=Object.keys(e),p=0;p<b.length;p++)for(var a=b[p],d=e[a],t=0;t<d.length;t++)if(c==d[t])return a};var f=this.protectedFromJsonObject;this.protectedFromJsonObject=function(c){f(c);e=c.promptMap}}
function ha(){U.call(this);var e=this.protectedFromJsonObject;this.protectedFromJsonObject=function(f){e(f)}}function X(){D.call(this);var e;this.getDimensionIds=function(){return e};this.protectedFromJsonObject=function(f){f.dimensionIds&&(e=f.dimensionIds)}}function w(){X.call(this)}function P(){X.call(this)}function ba(){D.call(this);var e;this.getPublicDimensionIds=function(){return e};this.protectedFromJsonObject=function(f){f.publicDimensionIds&&(e=f.publicDimensionIds)}}function O(){ba.call(this)}
function Y(){D.call(this)}function y(){D.call(this);var e,f;this.getTableIds=function(){return e};this.getInvalidTableMap=function(){return f};this.protectedFromJsonObject=function(c){c.tableIds&&(e=c.tableIds);c.tableException&&(f=c.tableException)}}function aa(){y.call(this)}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==
typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.designer&&(com.kingdee.bos.qing.modeler.designer={});"undefined"==typeof com.kingdee.bos.qing.modeler.designer.metricdesigner&&(com.kingdee.bos.qing.modeler.designer.metricdesigner={});var K=com.kingdee.bos.qing.modeler.designer.metricdesigner;K.MetricModeler=v;K.Metric=C;K.ExprValidity=function(){var e,f,c;this.isValid=function(){return e};this.getPrompt=function(){return f};this.getExceptionType=
function(){return c};this.fromJsonObject=function(b){e=b.valid;f=b.prompt;c=b.exceptionType}};K.Dimension=B;K.PublicDimension=G;K.MappingField=H;K.DimensionFilterItem=function(){var e,f;this.getDimensionKey=function(){return e};this.setDimensionKey=function(c){e=c};this.getValues=function(){return f};this.setValues=function(c){f=c};this.fromJsonObject=function(c){e=c.dimensionKey;f=c.values};this.toJsonObject=function(){var c={};c.dimensionKey=e;c.values=f;return c}};K.ModelerValidity=Z;K.MetricModelerInvalidityCase=
D;K.TableFieldMeta=function(){var e={},f;this.getTableFieldMap=function(){return e};this.setTableFieldMap=function(c){e=c};this.getValidity=function(){return f};this.setValidity=function(c){f=c};this.fromJsonObject=function(c){if(c){var b=c.validity;b&&(f=new Z,f.fromJsonObject(b));e={};if(c=c.tableFields){b=Object.keys(c);for(var p=0;p<b.length;p++){var a=b[p],d=e,t=a;a=c[a];for(var A=[],h=0;h<a.length;h++){var g=new m;g.fromJsonObject(a[h]);A.push(g)}d[t]=A}}}}};K.DimensionExprReference=T;var V,
n,r,m,l,k,u;(function(){var e=com.kingdee.bos.qing.modeler.designer;V=e.ModelerModel;n=e.AbstractModelerModelParser;r=e.ModelerModerParser;m=e.Field;l=e.UIDHelper;k=e.FilterItem;u=e.MaterializedConfig})();r.registerParser(V.TYPE_METRIC_MODELER,new function(){n.call(this);this.parseToModel=function(e){var f=new v;f.fromJsonObject(e);return f}});v.KEY_ADD_METRIC="metric_designer_add_metric";v.KEY_REMOVE_METRIC="metric_designer_remove_metric";v.KEY_UPDATE_METRIC="metric_designer_update_metric";v.KEY_ADD_DIMENSION=
"metric_designer_add_dimension";v.KEY_REMOVE_DIMENSION="metric_designer_remove_dimension";v.KEY_UPDATE_DIMENSION="metric_designer_update_dimension";v.KEY_BATCH_UPDATE_DIMENSION="metric_designer_batch_update_dimension";v.KEY_SET_METRIC_FILTER="metric_designer_set_metric_filter";B.TYPE_DATE="DATE";B.TYPE_NORMAL="NORMAL";B.VALUE_YYYY=0;B.VALUE_QUARTER=1;B.VALUE_MONTH=2;B.VALUE_DAY=3;B.VALUE_YEAR_QUARTER=4;B.VALUE_YEAR_MONTH=5;B.VALUE_YEAR_WEEK=6;B.VALUE_WEEK_OF_YEAR=7;B.VALUE_DAY_OF_WEEK=8;B.VALUE_YEAR_MONTH_DAY=
9;K.TableNameHelper=new function(){var e={};this.removeTableName=function(c){c=c.getUid();e[c]&&(e[c]=null)};this.addTableName=function(c,b){c=c.getUid();e[c]=b};this.getDisplayText=function(c){var b=c.getUid(),p=e[b];if(p)return p;for(c=p=(p=c.getDisplayName())?p:c.getTableName();-1<c.indexOf(".");)c=c.replace(".","_");c=f(c);return e[b]=c};var f=function(c,b){for(var p=b?c+"_"+b:c,a=!1,d=Object.keys(e),t=0;t<d.length;t++)if(e[d[t]]==p){a=!0;break}return a?f(c,b?b+1:1):p}};K.ExprRefHelper=new function(){function e(q){p.call(this,
q,"#666")}function f(q){p.call(this,q,"#e8893a")}function c(q){p.call(this,q,"#789262")}function b(q){p.call(this,q,"#4071ee")}function p(q,z){this.getText=function(){return q};this.getColor=function(){return z}}var a=this,d,t=[],A=/\[(.+?)\]/g;this.setGlobal=function(q){d=q};this.translateToExeExpr=function(q,z){for(var E=a.getRefTextInExpr(q),I=0;I<E.length;I++){var M=E[I];a:{var F=M;for(var S=z,Q=d.getModelerModel(),R=Q.getExprReferences(),W=0;W<R.length;W++){var ja=R[W];if(ja.getRefDisplayText(Q)==
F){F=ja;break a}}for(W=0;W<t.length;W++)if(R=new t[W],R.isRightDisplayFormat(F,Q)){try{R.fromDisplayText(F,Q,S)}catch(ka){continue}R=Q.addExprRefIfNotExist(R);R.getId()||(F=R,S=l.getUID(l.NS_REFERENCE),F.setId(S));F=R;break a}F=void 0}F&&(q=a.replaceRefText(q,M,F.getId()))}return q};this.translateToTextSegment=function(q){var z=a.getRefTextInExpr(q),E=[],I=d.getModelerModel();h(q,z,function(M,F){M&&0<M.length&&(M=new e(M),E.push(M));F&&(F=I.getExprReference(F),F=F instanceof L?new b("["+F.getRefDisplayText(I)+
"]"):F instanceof N?new f("["+F.getRefDisplayText(I)+"]"):F instanceof T?new c("["+F.getRefDisplayText(I)+"]"):new e("[]"),E.push(F))});return E};var h=function(q,z,E){for(var I,M,F=0;F<z.length;F++){var S=z[F],Q=q.indexOf("["+S+"]");-1<Q&&(void 0==I||I>Q)&&(I=Q,M=S)}I||0==I?(F=q.substring(0,I),E(F,M,I),q=q.substring(I+("["+M+"]").length),h(q,z,E)):E(q,null,null)};this.translateToDisplayExpr=function(q){for(var z=a.getRefTextInExpr(q),E=d.getModelerModel(),I=0;I<z.length;I++){var M=z[I],F=E.getExprReference(M);
F=F instanceof L?F.getRefDisplayText(E):F instanceof N?F.getRefDisplayText(E):F instanceof T?F.getRefDisplayText(E):"";q=a.replaceRefText(q,M,F)}return q};this.getRefTextInExpr=function(q){var z=[];q=q.match(A);if(!q)return z;for(var E=0;E<q.length;E++){var I=q[E];I=I.substring(1,I.length-1);0>z.indexOf(I)&&z.push(I)}return z};this.getRefFullDisplayText=function(q){var z=d.getModelerModel();return"["+q.getRefDisplayText(z)+"]"};this.createFieldReference=function(q,z){var E=new L;E.setTableId(q);E.setFieldName(z.getName());
E.setAlias(z.getAlias());return g(E)};this.createMetricReference=function(q){var z=new N;z.setMetricId(q);return g(z)};this.registReference=function(q){0<t.indexOf(q)||t.push(q)};this.getMetricReferredInfo=function(q){var z=[];q=q.getId();for(var E=d.getModelerModel(),I=E.getAllMetric(),M=0;M<I.length;M++){var F=I[M];if(F.getId()!=q)for(var S=a.getRefTextInExpr(F.getExpr()),Q=0;Q<S.length;Q++){var R=E.getExprReference(S[Q]);R instanceof N&&R.getMetricId()==q&&z.push(F)}}return z};this.replaceRefText=
function(q,z,E){E="["+E+"]";for(z="["+z+"]";-1<q.indexOf(z);)q=q.replace(z,E);return q};var g=function(q){var z=l.getUID(l.NS_REFERENCE);q.setId(z);return d.getModelerModel().addExprRefIfNotExist(q)}};x.FIELD_TYPE="field";x.METRIC_TYPE="metric";x.DIMENSION_TYPE="dimension";K.ExprRefHelper.registReference(L);K.ExprRefHelper.registReference(N);K.ExprRefHelper.registReference(T);D.TYPE_NO_METRIC="noMetric";D.TYPE_INVALID_FIELD_REF="invalidFieldRef";D.TYPE_INVALID_EXPR="invalidExpr";D.TYPE_INVALID_EXPR_DATA_TYPE=
"invalidExprDataType";D.TYPE_INVALID_FIELD_FILTER_REF="invalidFieldFilterRef";D.TYPE_INVALID_DIMENSION_REF="invalidDimensionRef";D.TYPE_INVALID_DIMENSION_TYPE="invalidDimensionType";D.TYPE_INVALID_PUBLIC_DIMENSION="invalidPublicDimension";D.TYPE_INVALID_TABLE="invalidTable";D.TYPE_INVALID_TABLE_FILTER="invalidTableFilter";D.TYPE_DB_CONNECTION_FAIL="dbConnectionFail";D.TYPE_USER_NO_DB_CENTER_PERMISSION="userNoDBCenterPermission";D.TYPE_CREATOR_NO_DB_CENTER_PERMISSION="creatorNoDBCenterPermission";
D.TYPE_USER_NO_PUBLIC_SOURCE_PERMISSION="userNoPublicSourcePermission";D.TYPE_CREATOR_NO_PUBLIC_SOURCE_PERMISSION="creatorNoPublicSourcePermission";D.TYPE_USER_NO_ENTITY_PERMISSION="userNoEntityPermission";D.TYPE_REF_PUBLIC_SOURCE_NOT_EXIST="refPublicSourceNotExist";D.TYPE_TABLE_NOT_EXIST="tableNotExist";D.TYPE_MODEL_NOT_EXIST="modelNotExist";D.TYPE_MODEL_DAMAGE="modelDamage";D.TYPE_MODEL_NO_DATA_PERMISSION="modelNoDataPermission";D.TYPE_MODEL_CYCLE_REFERENCE="modelCycleReference";D.TYPE_INCOMPLETE_MATERIALIZED_CONFIG=
"incompleteMaterializedConfig";D.TYPE_INVALID_DIMENSION_GRANULARITY_NOT_MATCH="invalidDimensionGranularityNotMatch";D.TYPE_INVALID_DIMENSION_TYPE_NOT_MATCH="invalidDimensionTypeNotMatch";D.TYPE_INVALID_DIMENSION_NOT_EXIST="invalidDimensionNotExist"})();
//qingVersionTag: 20250324