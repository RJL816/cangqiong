var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(W){var za=0;return function(){return za<W.length?{done:!1,value:W[za++]}:{done:!0}}};$jscomp.arrayIterator=function(W){return{next:$jscomp.arrayIteratorImpl(W)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(W,za,Aa){if(W==Array.prototype||W==Object.prototype)return W;W[za]=Aa.value;return W};$jscomp.getGlobal=function(W){W=["object"==typeof globalThis&&globalThis,W,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var za=0;za<W.length;++za){var Aa=W[za];if(Aa&&Aa.Math==Math)return Aa}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(W,za){var Aa=$jscomp.propertyToPolyfillSymbol[za];if(null==Aa)return W[za];Aa=W[Aa];return void 0!==Aa?Aa:W[za]};
$jscomp.polyfill=function(W,za,Aa,Qa){za&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(W,za,Aa,Qa):$jscomp.polyfillUnisolated(W,za,Aa,Qa))};$jscomp.polyfillUnisolated=function(W,za,Aa,Qa){Aa=$jscomp.global;W=W.split(".");for(Qa=0;Qa<W.length-1;Qa++){var La=W[Qa];if(!(La in Aa))return;Aa=Aa[La]}W=W[W.length-1];Qa=Aa[W];za=za(Qa);za!=Qa&&null!=za&&$jscomp.defineProperty(Aa,W,{configurable:!0,writable:!0,value:za})};
$jscomp.polyfillIsolated=function(W,za,Aa,Qa){var La=W.split(".");W=1===La.length;Qa=La[0];Qa=!W&&Qa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Oa=0;Oa<La.length-1;Oa++){var Ya=La[Oa];if(!(Ya in Qa))return;Qa=Qa[Ya]}La=La[La.length-1];Aa=$jscomp.IS_SYMBOL_NATIVE&&"es6"===Aa?Qa[La]:null;za=za(Aa);null!=za&&(W?$jscomp.defineProperty($jscomp.polyfills,La,{configurable:!0,writable:!0,value:za}):za!==Aa&&(void 0===$jscomp.propertyToPolyfillSymbol[La]&&(Aa=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[La]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(La):$jscomp.POLYFILL_PREFIX+Aa+"$"+La),$jscomp.defineProperty(Qa,$jscomp.propertyToPolyfillSymbol[La],{configurable:!0,writable:!0,value:za})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(W){if(W)return W;var za=function(Oa,Ya){this.$jscomp$symbol$id_=Oa;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:Ya})};za.prototype.toString=function(){return this.$jscomp$symbol$id_};var Aa="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",Qa=0,La=function(Oa){if(this instanceof La)throw new TypeError("Symbol is not a constructor");return new za(Aa+(Oa||"")+"_"+Qa++,Oa)};return La},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(W){if(W)return W;W=Symbol("Symbol.iterator");for(var za="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Aa=0;Aa<za.length;Aa++){var Qa=$jscomp.global[za[Aa]];"function"===typeof Qa&&"function"!=typeof Qa.prototype[W]&&$jscomp.defineProperty(Qa.prototype,W,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return W},
"es6","es3");$jscomp.iteratorPrototype=function(W){W={next:W};W[Symbol.iterator]=function(){return this};return W};$jscomp.iteratorFromArray=function(W,za){W instanceof String&&(W+="");var Aa=0,Qa=!1,La={next:function(){if(!Qa&&Aa<W.length){var Oa=Aa++;return{value:za(Oa,W[Oa]),done:!1}}Qa=!0;return{done:!0,value:void 0}}};La[Symbol.iterator]=function(){return La};return La};
$jscomp.polyfill("Array.prototype.keys",function(W){return W?W:function(){return $jscomp.iteratorFromArray(this,function(za){return za})}},"es6","es3");$jscomp.findInternal=function(W,za,Aa){W instanceof String&&(W=String(W));for(var Qa=W.length,La=0;La<Qa;La++){var Oa=W[La];if(za.call(Aa,Oa,La,W))return{i:La,v:Oa}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(W){return W?W:function(za,Aa){return $jscomp.findInternal(this,za,Aa).v}},"es6","es3");
(function(){function W(){var n,a,P,Y,H,da,E,J,Sa,U="",oa,cb,ab;this.setModelId=function(pa){n=pa};this.getModelId=function(){return n};this.setModelType=function(pa){P=pa};this.getModelType=function(){return P};this.setModelName=function(pa){a=pa};this.getModelName=function(){return a};this.setModelNumber=function(pa){Y=pa};this.getModelNumber=function(){return Y};this.setLevel=function(pa){H=parseInt(pa)-1};this.getLevel=function(){return H};this.setSpreadState=function(pa){da=pa};this.isSpreadState=
function(){return da};this.setParentId=function(pa){E=pa};this.getParentId=function(){return E};this.setInheritPermissions=function(pa){Sa=pa};this.isInheritPermissions=function(){return Sa};this.setEnable=function(pa){J=pa};this.isEnable=function(){return J};this.setAbstract=function(pa){U=pa};this.getAbstract=function(){return U};this.setDataAuthId=function(pa){ab=pa};this.getDataAuthId=function(){return ab};this.setDataAuth=function(pa){cb=pa};this.getQingModelerDataAuth=function(){return cb};
this.setErrorCode=function(pa){oa=pa};this.getErrorCode=function(){return oa}}function za(){W.call(this);var n=this,a=[];this.setChildren=function(P){a=P};this.getChildren=function(){return a};this.toJsonObject=function(){var P={};P.id=n.getModelId();P.type=n.getModelType();P.name=n.getModelName();P.number=n.getModelNumber();P.level=n.getLevel();P.dataAuthId=n.getDataAuthId();P.children=a;void 0!=n.isEnable()&&(P.enable=n.isEnable()?"1":"0");P.inherit=n.isInheritPermissions()?"1":"0";return P};this.fromJsonObject=
function(P){n.setModelId(P.id);n.setModelType(P.type);n.setModelName(P.name);n.setModelNumber(P.number);n.setLevel(P.level);P.dataAuthId&&n.setDataAuthId(P.dataAuthId);n.setSpreadState(!0);var Y=P.children;if(Y&&0<Y.length){for(var H=0;H<Y.length;H++){var da=Y[H];if(da.children){var E=new za;E.fromJsonObject(da);a.push(E);E.setParentId(n.getModelId())}}for(H=0;H<Y.length;H++)da=Y[H],da.children||(E=new Aa,E.fromJsonObject(da),a.push(E),E.setParentId(n.getModelId()))}n.setErrorCode(P.code);P.inherit&&
n.setInheritPermissions("1"==P.inherit);P.status&&n.setEnable("1"==P.status);P.dataAuthId&&n.setDataAuthId(P.dataAuthId)}}function Aa(){W.call(this);var n=this;this.toJsonObject=function(){var a={};a.id=n.getModelId();a.type=n.getModelType();a.name=n.getModelName();a.number=n.getModelNumber();a.level=n.getLevel();a.inherit=n.isInheritPermissions()?"1":"0";a.enable=n.isEnable()?"1":"0";return a};this.fromJsonObject=function(a){n.setModelId(a.id);n.setModelType(a.type);n.setModelName(a.name);n.setModelNumber(a.number);
n.setLevel(a.level);n.setErrorCode(a.code);n.setSpreadState(!0);a.inherit&&n.setInheritPermissions("1"==a.inherit);a.status&&n.setEnable("1"==a.status);a.dataAuthId&&n.setDataAuthId(a.dataAuthId)}}function Qa(){var n=this,a,P,Y,H,da="",E,J,Sa,U;this.setErrorCode=function(oa){E=oa};this.getErrorCode=function(){return E};this.setUserName=function(oa){a=oa};this.getUserName=function(){return a};this.setUserId=function(oa){P=oa};this.getUserId=function(){return P};this.setEnable=function(oa){Y=oa};this.isEnable=
function(){return Y};this.setInheritPermissions=function(oa){H=oa};this.isInheritPermissions=function(){return H};this.setAbstract=function(oa){da=oa};this.getAbstract=function(){return da};this.setDataAuth=function(oa){J=oa};this.getQingModelerDataAuth=function(){return J};this.setDataAuthId=function(oa){Sa=oa};this.getDataAuthId=function(){return Sa};this.setJobNumber=function(oa){U=oa};this.getJobNumber=function(){return U};this.toJsonObject=function(){var oa={};oa.viewerName=a;oa.viewerId=P;oa.status=
Y;oa.inherit=H;return oa};this.fromJsonObject=function(oa){n.setUserId(oa.viewerId);n.setJobNumber(oa.number);n.setUserName(oa.viewerName);n.setEnable(!0);n.setErrorCode(oa.code);"0"===oa.status&&n.setEnable(!1);n.setInheritPermissions(!0);"0"===oa.inherit&&n.setInheritPermissions(!1);n.setDataAuthId(oa.dataAuthId)};this.initialize=function(oa,cb){n.setUserId(oa);n.setUserName(cb);n.setEnable(!1);n.setInheritPermissions(!0)}}function La(){var n,a,P,Y,H,da=!1;this.setModelId=function(E){n=E};this.getModelId=
function(){return n};this.setRowAuth=function(E){a=E};this.getRowAuth=function(){return a};this.setCellAuth=function(E){P=E};this.getCellAuth=function(){return P};this.setRoleRowAuth=function(E){Y=E};this.getRoleRowAuth=function(){return Y};this.setRoleCellAuth=function(E){H=E};this.getRoleCellAuth=function(){return H};this.setRoleExist=function(E){da=E};this.isRoleExist=function(){return da};this.toString=function(E){var J=a?a.toString():Ga.get("notExistFilterItems","\u884c\u7ea7\u6743\u9650\uff1a\u8fc7\u6ee4\u9879\u672a\u8bbe\u7f6e"),
Sa=P?P.toString():Ga.get("notExistUnviewableFields","\u5217\u7ea7\u6743\u9650\uff1a\u6240\u6709\u5b57\u6bb5\u53ef\u89c1");return E?a||P?J:"":a||P?J+"\n"+Sa:""};this.toJsonObject=function(){var E={};E.modelId=n;P&&(E.columnLevel=P.toJsonObject());H&&(E.roleColumnLevel=H.toJsonObject());a&&(E.rowLevel=a.toJsonObject());Y&&(E.roleRowLevel=Y.toJsonObject());return E};this.fromJsonObject=function(E){n=E.modelId;da=E.isExistsRoleDataAuth;E.columnLevel&&(P=new Ya,P.fromJsonObject(E.columnLevel));E.rowLevel&&
E.rowLevel.filterItems&&(a=new Oa,a.fromJsonObject(E.rowLevel));E.roleRowLevel&&E.roleRowLevel.filterItems&&(Y=new Oa,Y.fromJsonObject(E.roleRowLevel));E.roleColumnLevel&&(H=new Ya,H.fromJsonObject(E.roleColumnLevel))}}function Oa(){var n=[],a=!1,P=-1;this.getFilterItems=function(){return n};this.setFilterItems=function(H){n=H};this.setInvalid=function(H){a=H};this.isInvalid=function(){return a};this.setErrorLine=function(H){P=H};this.getErrorLine=function(){return P};this.toString=function(){for(var H=
Ga.get("rowAuth","\u884c\u7ea7\u6743\u9650\uff1a"),da=0;da<n.length;da++){var E=Da.FilterTypeUtil.getTypeDesc(n[da].getLogicOp())+" ";if(0!==da||da===n.length-1)E="";var J=n[da].getProperty().getAlias(),Sa=Da.FilterTypeUtil.getTypeDesc(n[da].getCompareOp()),U=n[da].getValue();if(n[da].getProperty().isEnum())for(var oa=Object.keys(n[da].getProperty().getEnumValue()),cb=0;cb<oa.length;cb++){var ab=oa[cb];U&&U.match(ab)&&(U=U.replace(ab,n[da].getProperty().getEnumValue()[ab]))}n[da].getCompareOp()==
m.COMPARE_VARIABLE&&(U=va.getImpl(va.SYS_VAR_HELPER).switchSQLToDisplayMode("@"+U));n[da].getProperty().getDataType()==Ha.DT_DATETIME?U=Y(U,Ha.DT_DATETIME):n[da].getProperty().getDataType()==Ha.DT_DATE&&(U=Y(U,Ha.DT_DATE));oa=J+" "+Sa+" "+U+" "+E;if(n[da].getCompareOp()==m.COMPARE_NULL||n[da].getCompareOp()==m.COMPARE_NOT_NULL)oa=J+" "+Sa+" "+E;if(n[da].getCompareOp()==m.COMPARE_IN||n[da].getCompareOp()==m.COMPARE_NOT_IN)oa=J+" "+Sa.replace("#1",U)+" "+E;H+=oa;if(1<=da)break}2<n.length?H+=Ga.get("filterItems",
"\u7b49#1\u884c\u8fc7\u6ee4\u9879").replace("#1",n.length):0>=n.length&&(H=Ga.get("notExistFilterItems","\u884c\u7ea7\u6743\u9650\uff1a\u8fc7\u6ee4\u9879\u672a\u8bbe\u7f6e"));return H};var Y=function(H,da){var E=new Date;E.setTime(parseInt(H));var J=E.getFullYear(),Sa=E.getMonth()+1+"";2>Sa.length&&(Sa="0"+Sa);var U=E.getDate()+"";2>U.length&&(U="0"+U);H=E.getHours()+"";2>H.length&&(H="0"+H);var oa=E.getMinutes()+"";2>oa.length&&(oa="0"+oa);E=E.getSeconds()+"";2>E.length&&(E="0"+E);H=J+"-"+Sa+"-"+
U+" "+H+":"+oa+":"+E;da===Ha.DT_DATE&&(H=J+"-"+Sa+"-"+U);return H};this.toJsonObject=function(){for(var H={},da=[],E=0;E<n.length;E++)da.push(n[E].toJsonObject());H.filterItems=da;return H};this.fromJsonObject=function(H){H=H.filterItems;for(var da=0;da<H.length;da++){var E=new m;E.fromJsonObject(H[da]);n.push(E);E.isExist()||a||(a=!0,P=da+1)}}}function Ya(){var n,a=[],P=[];this.getRelation=function(){return n};this.setRelation=function(Y){n=Y};this.getNoAuthFields=function(){return a};this.setNoAuthFields=
function(Y){a=Y};this.getSelectedFields=function(){return P};this.setSelectedFields=function(Y){P=Y};this.toString=function(){for(var Y=Ga.get("columnAuth","\u5217\u7ea7\u6743\u9650\uff1a\u4e0d\u53ef\u89c1\u5b57\u6bb5\u6709"),H=0;H<a.length;H++){0!==H&&(Y+=Ga.get("comma","\u3001"));var da=a[H].getAlias();Y+=da;if(2<=H)break}3<a.length?Y+=Ga.get("fields","\u7b49#1\u4e2a\u5b57\u6bb5").replace("#1",a.length):0>=a.length&&(Y=Ga.get("notExistUnviewableFields","\u5217\u7ea7\u6743\u9650\uff1a\u6240\u6709\u5b57\u6bb5\u53ef\u89c1"));
return Y};this.toJsonObject=function(){var Y={};Y.relation=n;for(var H=[],da=0;da<a.length;da++)H.push(a[da].toJsonObject());Y.noAuthFields=H;return Y};this.fromJsonObject=function(Y){n=Y.relation;if(Y.noAuthFields&&(Y=Y.noAuthFields))for(var H=0;H<Y.length;H++){var da=new Ha;da.fromJsonObject(Y[H]);a.push(da)}}}function m(){var n,a,P,Y=0,H=0,da,E=!1,J=!0,Sa=null;this.setRoleFilter=function(U){E=U};this.isRoleFilter=function(){return E};this.setExist=function(U){J=U};this.isExist=function(){return J};
this.setProperty=function(U){n=U};this.getProperty=function(){return n};this.setCompareOp=function(U){a=U};this.getCompareOp=function(){return a};this.setValue=function(U){P=U};this.getValue=function(){return P};this.setValueMode=function(U){if(U===m.MODE_CONST||U===m.MODE_SYS_VAR||U===m.MODE_MACRO_VAR)Sa=U;else throw Error("IllegalArgument: "+U);};this.isSystemVariant=function(){return Sa==m.MODE_SYS_VAR?!0:!1};this.isMacroVar=function(){return Sa==m.MODE_MACRO_VAR?!0:!1};this.setLeftBracketCount=
function(U){Y=U};this.getLeftBracketCount=function(){return Y};this.setRightBracketCount=function(U){H=U};this.getRightBracketCount=function(){return H};this.setLogicOp=function(U){da=U};this.getLogicOp=function(){return da};this.isEmpty=function(){return 0==Y&&0==H&&!n&&!a&&!P&&!da};this.copy=function(){var U=new m;U.setProperty(n);U.setCompareOp(a);U.setValue(P);U.setLeftBracketCount(Y);U.setRightBracketCount(H);U.setLogicOp(da);U.setExist(J);return U};this.toJsonObject=function(){if(!n)return null;
var U={};U.field=n.toJsonObject();U.compareOp=a;U.value=P;U.leftBrackets=Y;U.rightBrackets=H;U.logicOp=da;Sa&&(U.mode=Sa);return U};this.fromJsonObject=function(U){U&&(n=new Ha,n.fromJsonObject(U.field),a=U.compareOp,P=U.value,Y=U.leftBrackets,H=U.rightBrackets,da=U.logicOp,J=U.exists,Sa=U.mode)}}function Ha(){var n=this,a,P,Y,H,da,E,J,Sa,U,oa,cb,ab={};this.setFromNodeId=function(R){a=R};this.getFromNodeId=function(){return a};this.getNumber=function(){return P};this.setNumber=function(R){P=R};this.setName=
function(R){Y=R};this.getName=function(){return Y};this.getFullName=function(){return a+"_"+Y};this.setAlias=function(R){H=R};this.getAlias=function(){return H?H:Y};this.isDimension=function(){return ab[Ua.IS_DIMENSION]};this.isMetric=function(){return ab[Ua.IS_METRIC]};var pa=function(R){if(R!==Ha.DT_STRING&&R!==Ha.DT_INT&&R!==Ha.DT_NUMBER&&R!==Ha.DT_DATE&&R!==Ha.DT_DATETIME&&R!==Ha.DT_BOOLEAN)throw Error("IllegalArgument: "+R);};this.setDataType=function(R){pa(R);da=R};this.getDataType=function(){return da};
this.setAppointedDataType=function(R){R&&pa(R);E=R==da?null:R};this.getAppointedDataType=function(){return E};this.getOutputDataType=function(){return E?E:da};this.setRoundMode=function(R){Sa=R};this.getRoundMode=function(){return Sa};this.setScale=function(R){J=R};this.getScale=function(){return J};this.setEnumValue=function(R){U=R};this.getEnumValue=function(){return U};this.setMulBaseData=function(R){oa=R};this.getMulBaseData=function(){return oa};this.isEnum=function(){return oa||n.getOutputDataType()!=
Ha.DT_STRING?!1:0!=(U?Object.keys(U):[]).length};this.setExist=function(R){cb=R};this.isExist=function(){return cb};this.setExtensions=function(R){ab=R};this.getExtensions=function(){return ab};this.fromJsonObject=function(R){Y=R.name;a=R.fromNode;H=R.alias;P=R.number;E=R.appointedDataType;da=R.dataType;R.scale&&(J=R.scale);R.roundMode&&(Sa=R.roundMode);R.extensions&&(ab=R.extensions,U=ab.bizFieldEnumKey,cb=ab.isExists,oa=ab.isMulBaseData)};this.toJsonObject=function(){var R={};R.name=Y;R.fromNode=
a;R.alias=H;R.dataType=da;R.number=P;Sa&&(R.roundMode=Sa);void 0!==J&&(R.scale=J);R.extensions=ab;return R};this.clone=function(){var R=new Ha;Y&&R.setName(Y);a&&R.setFromNodeId(a);H&&R.setAlias(H);E&&R.setAppointedDataType(E);da&&R.setDataType(da);J&&R.setScale(J);ab&&R.setExtensions(ab);Sa&&R.setRoundMode(Sa);oa&&R.setMulBaseData(oa);U&&R.setEnumValue(U);P&&R.setNumber(P);return R};this.equals=function(R){return Y==R.getName()&&H==R.getAlias()&&E==R.getAppointedDataType()&&J==R.getScale()&&Sa==
R.getRoundMode()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.auth&&(com.kingdee.bos.qing.modeler.modelset.auth=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.auth.model&&(com.kingdee.bos.qing.modeler.modelset.auth.model={});var Da=com.kingdee.bos.qing.modeler.modelset.auth.model;Da.ModelFolderNode=za;Da.ModelLeafNode=Aa;Da.UserDataAuth=Qa;Da.ModelSetRole=function(){var n,a,P,Y=[],H="",da=!1;this.getModelSetRoleId=function(){return n};this.setModelSetRoleId=function(E){n=E};this.getModelSetRoleName=function(){return a};this.setModelSetRoleName=function(E){a=E};this.getModelSetId=function(){return P};
this.setModelSetId=function(E){P=E};this.getUserNames=function(){return H};this.setUserNames=function(E){H=E};this.isHide=function(){return da};this.setHide=function(E){da=E};this.fromJsonObject=function(E){n=E.modelSetRoleId;a=E.modelSetRoleName;P=E.modelSetId;if(E.userNames){E=E.userNames;for(var J=0;J<E.length;J++)Y.push(E[J]),H=H+E[J]+";"}da=!1};this.toJsonObject=function(){var E={};E.modelSetRoleId=n;E.modelSetRoleName=a;E.modelSetId=P;E.userNames=JSON.stringify(Y);return E}};Da.QingModelerDataAuth=
function(){var n=[];this.setModels=function(a){n=a};this.getModels=function(){return n};this.toString=function(a){return n[0]?n[0].toString(a):""};this.toJsonObject=function(){for(var a={},P=[],Y=0;Y<n.length;Y++)P.push(n[Y].toJsonObject());a.dataAuthContents=P;return a};this.fromJsonObject=function(a){a=a.dataAuthContents;for(var P=0;P<a.length;P++){var Y=new La;Y.fromJsonObject(a[P]);n.push(Y)}}};Da.DataAuthModeler=La;Da.RowAuth=Oa;Da.CellAuth=Ya;Da.ModelStatus=function(){var n,a;this.setModelId=
function(P){n=P};this.getModelId=function(){return n};this.setStateCode=function(P){a=P};this.getStateCode=function(){return a};this.fromJsonObject=function(P){n=P.modelId;a=P.code}};Da.FilterItem=m;Da.Property=Ha;var Ga,va;(function(){var n=com.kingdee.bos.qing.framework.common;Ga=n.MultilanguageManager.createPackageAccessor(Da);n=com.kingdee.bos.qing.modeler.common;va=n.VariateHelperFactory})();za.MODELSET_TYPE="modelset";za.DIRECTORY_TYPE="directory";Aa.DATA_TABLE_MODEL="data_table_model";Aa.ENTITY_MODEL=
"entity_model";Aa.RELATION_MODEL="relation_model";Aa.METRICS_MODEL="metric_model";Aa.METRIC="metric";Qa.USER="0";Qa.ROLE="1";Qa.MODELSET_ROLE="2";m.REG_NUMBER=/^-?\d+(\.\d+)?$/;m.REG_DATETIME=/^-?\d+(\.\d+)?$/;m.COMPARE_EQUAL="EQUAL";m.COMPARE_NOT_EQUAL="NOT_EQUAL";m.COMPARE_GREATER="GREATER";m.COMPARE_GREATER_EQUAL="GREATER_EQUAL";m.COMPARE_LESS="LESS";m.COMPARE_LESS_EQUAL="LESS_EQUAL";m.COMPARE_INCLUDE="INCLUDE";m.COMPARE_NOT_INCLUDE="NOT_INCLUDE";m.COMPARE_START_WITH="START_WITH";m.COMPARE_END_WITH=
"END_WITH";m.COMPARE_NULL="NULL";m.COMPARE_NOT_NULL="NOT_NULL";m.COMPARE_IN="IN";m.COMPARE_NOT_IN="NOT_IN";m.COMPARE_VARIABLE="VARIABALE_MATCH";m.LOGIC_AND="AND";m.LOGIC_OR="OR";m.COMPARE_WITH_RAW="RAW";m.COMPARE_WITH_APPOINTED="APPOINTED";m.MODE_CONST="Const";m.MODE_SYS_VAR="SystemVar";m.MODE_MACRO_VAR="MacroVar";m.COMPARES_FOR_STRING=[m.COMPARE_VARIABLE,m.COMPARE_EQUAL,m.COMPARE_NOT_EQUAL,m.COMPARE_INCLUDE,m.COMPARE_NOT_INCLUDE,m.COMPARE_START_WITH,m.COMPARE_END_WITH,m.COMPARE_NULL,m.COMPARE_NOT_NULL,
m.COMPARE_IN,m.COMPARE_NOT_IN];m.COMPARES_FOR_ENUM=[m.COMPARE_EQUAL,m.COMPARE_NOT_EQUAL,m.COMPARE_NULL,m.COMPARE_NOT_NULL,m.COMPARE_IN,m.COMPARE_NOT_IN];m.COMPARES_FOR_NUMBER=[m.COMPARE_VARIABLE,m.COMPARE_EQUAL,m.COMPARE_NOT_EQUAL,m.COMPARE_GREATER,m.COMPARE_GREATER_EQUAL,m.COMPARE_LESS,m.COMPARE_LESS_EQUAL,m.COMPARE_NULL,m.COMPARE_NOT_NULL,m.COMPARE_IN,m.COMPARE_NOT_IN];m.COMPARES_FOR_DATETIME=[m.COMPARE_EQUAL,m.COMPARE_NOT_EQUAL,m.COMPARE_GREATER,m.COMPARE_GREATER_EQUAL,m.COMPARE_LESS,m.COMPARE_LESS_EQUAL,
m.COMPARE_NULL,m.COMPARE_NOT_NULL];m.COMPARES_FOR_BOOLEAN=[m.COMPARE_EQUAL,m.COMPARE_NOT_EQUAL,m.COMPARE_NULL,m.COMPARE_NOT_NULL];m.isCompareOpWithoutValue=function(n){return n==m.COMPARE_NULL||n==m.COMPARE_NOT_NULL};m.isCompareOpWithinOrNotWithinValue=function(n){return n==m.COMPARE_IN||n==m.COMPARE_NOT_IN};m.isCompareOpMatchVariable=function(n){return n==m.COMPARE_VARIABLE};m.getSelectableCompares=function(n,a){switch(n){case Ha.DT_STRING:return a?m.COMPARES_FOR_ENUM:m.COMPARES_FOR_STRING;case Ha.DT_NUMBER:case Ha.DT_INT:return m.COMPARES_FOR_NUMBER;
case Ha.DT_DATE:case Ha.DT_DATETIME:return m.COMPARES_FOR_DATETIME;case Ha.DT_BOOLEAN:return m.COMPARES_FOR_BOOLEAN;default:throw Error("Unknown DataType");}};m.FiltersCheckingResult=function(n,a){var P=a;this.getFiltersErrorRow=function(){return n};this.getPrompt=function(){return P};this.setPrompt=function(Y){P=Y}};Da.FilterTypeUtil=new function(){this.getTypeDesc=function(n){switch(n){case m.COMPARE_EQUAL:return Ga.get("compareEqual","\u7b49\u4e8e");case m.COMPARE_NOT_EQUAL:return Ga.get("compareNotEqual",
"\u4e0d\u7b49\u4e8e");case m.COMPARE_GREATER:return Ga.get("compareGreater","\u5927\u4e8e");case m.COMPARE_GREATER_EQUAL:return Ga.get("compareGreaterEqual","\u5927\u4e8e\u7b49\u4e8e");case m.COMPARE_LESS:return Ga.get("compareLess","\u5c0f\u4e8e");case m.COMPARE_LESS_EQUAL:return Ga.get("compareLessEqual","\u5c0f\u4e8e\u7b49\u4e8e");case m.COMPARE_INCLUDE:return Ga.get("compareInclude","\u5305\u542b");case m.COMPARE_NOT_INCLUDE:return Ga.get("compareNotInclude","\u4e0d\u5305\u542b");case m.COMPARE_START_WITH:return Ga.get("compareStartWith",
"\u5f00\u5934\u662f");case m.COMPARE_END_WITH:return Ga.get("compareEndWith","\u7ed3\u5c3e\u662f");case m.COMPARE_NULL:return Ga.get("compareNull","\u4e3a\u7a7a");case m.COMPARE_NOT_NULL:return Ga.get("compareNotNull","\u4e0d\u4e3a\u7a7a");case m.COMPARE_IN:return Ga.get("compareIn","\u5728#1\u4e4b\u5185");case m.COMPARE_NOT_IN:return Ga.get("compareNotIn","\u4e0d\u5728#1\u4e4b\u5185");case m.LOGIC_AND:return Ga.get("logicAnd","\u5e76\u4e14");case m.LOGIC_OR:return Ga.get("logicOr","\u6216\u8005");
case m.COMPARE_VARIABLE:return Ga.get("compareVariable","\u5339\u914d\u53d8\u91cf");default:return""}}};Ha.BOOLEAN_TRUE="true";Ha.BOOLEAN_FALSE="false";Ha.DT_BOOLEAN="BOOLEAN";Ha.DT_DATE="DATE";Ha.DT_DATETIME="DATETIME";Ha.DT_INT="INT";Ha.DT_NUMBER="NUMBER";Ha.DT_STRING="STRING";Ha.ROUND_MODE_DOWN="ROUND_DOWN";Ha.ROUND_MODE_HALF_UP="ROUND_HALF_UP";Ha.ROUND_MODE_UP="ROUND_UP";Da.DataAuthUtil=new function(){this.generateMetricModelId=function(n,a){return Aa.METRIC+"-"+n+"-"+a}};var Ua={};Da.FieldExtensionKey=
Ua;Ua.IS_DIMENSION="isDimension";Ua.IS_METRIC="isMetric"})();(function(){function W(){Qa.call(this);var Ya;this.getRemoteUrl=function(){return Ya};this.setRemoteUrl=function(m){Ya=m}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.auth&&(com.kingdee.bos.qing.modeler.modelset.auth={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.auth.common&&(com.kingdee.bos.qing.modeler.modelset.auth.common={});var za=com.kingdee.bos.qing.modeler.modelset.auth.common;za.Facade=function(Ya,m,Ha,Da){Aa.call(this,Ya,m,Ha,Da);var Ga=this.protectedMethod;this.loadUsableModelNode=function(va){Ga.remote("loadUsableModelNodes",{modelSetId:va})};this.loadSupportSystemVar=function(){Ga.remote("loadSupportSystemVar",
{})};this.deleteInvalidData=function(){Ga.remote("deleteInvalidData",{})};this.loadUsableUserDataAuth=function(va,Ua,n){Ga.remote("loadUsableDataAuthByModel",{type:n,modelId:Ua,modelSetId:va})};this.authorizedDataAuth=function(va,Ua,n,a,P,Y){Ga.remote("authorizedDataAuth",{type:a,modelId:va,modelType:P,viewerId:Ua,status:n,modelSetId:Y})};this.setInherit=function(va,Ua,n,a){Ga.remote("setInherit",{type:a,modelId:va,viewerId:Ua,inherit:n})};this.doDeleteUser=function(va,Ua,n){va={type:n,viewerIds:JSON.stringify(Ua),
modelId:va};Ga.remote("deleteDataAuth",va)};this.deleteDataAuthByModelSetId=function(va,Ua,n){va={type:n,viewerIds:JSON.stringify(Ua),modelSetId:va};Ga.remote("deleteDataAuthByModelSetId",va)};this.doAddUser=function(va,Ua,n){va={type:n,modelIds:JSON.stringify(va),viewerIds:JSON.stringify(Ua)};Ga.remote("setDataAuth",va)};this.addUsers=function(va,Ua,n){va={type:n,viewerIds:JSON.stringify(Ua),modelSetId:va};Ga.remote("addUsers",va)};this.deletePermission=function(va,Ua,n){Ga.remote("deleteDataAuthContent",
{type:n,modelId:va,viewerId:Ua})};this.getModelSetRoles=function(va){Ga.remote("getModelSetRoles",{modelSetId:va})};this.loadUsableModelDataAuth=function(va,Ua,n){Ga.remote("loadUsableDataAuthByUser",{type:Ua,modelSetId:va,viewerId:n})};this.loadModelSetViewer=function(va,Ua){Ga.remote("loadModelSetViewer",{type:va,modelSetId:Ua})};this.queryDataAuthContent=function(va,Ua,n,a){Ga.remote("queryDataAuthContent",{type:n,modelId:Ua,inherit:va,viewerId:a})};this.queryDataAuthContents=function(va){va={dataAuthIds:JSON.stringify(va)};
Ga.remote("queryDataAuthContents",va)};this.getFields=function(va,Ua){Ga.remote("getFields",{modelId:va,includeMetric:Ua})};this.setDataAuthContent=function(va,Ua,n,a,P){va={type:Ua,modelId:a,viewerId:va,inherit:n,content:JSON.stringify(P.toJsonObject())};Ga.remote("setDataAuthContent",va)};this.checkModel=function(va){Ga.remote("checkModel",{modelSetId:va})};this.checkModelExistMV=function(va){Ga.remote("checkModelExistMV",{modelId:va})}};var Aa,Qa,La;(function(){var Ya=com.kingdee.bos.qing.framework.common;
Aa=Ya.AbstractFacade;Qa=Ya.AbstractRemoteCall;La=Ya.AbstractIcons})();za.Integration=new function(){var Ya=new W,m,Ha;this.setDataAuthorityManager=function(Da){m=Da};this.getDataAuthorityManager=function(){return m};this.setModelDesignerEntrance=function(Da){Ha=Da};this.getModelDesignerEntrance=function(){return Ha};this.getRemoteImpl=function(){return Ya};this.setRemoteUrl=function(Da){Ya.setRemoteUrl(Da)}};za.Icons=new function(){La.call(this);var Ya=this.protectedMethod;this.protectedInit=function(Ha,
Da){Ha=com.kingdee.bos.qing.modeler.modelset.auth.ComboIcon;if(!Ha)throw Error("com.kingdee.bos.qing.modeler.modelset.auth.ComboIcon not found.");Ha.define(Da,"model-auth");Da.setStartPosition(1,1);Da.setGap(2);Da.setIconSize(16,16);m(0,0,"icon-relation-model");m(0,1,"icon-data-table-model");m(0,2,"icon-entity-model");m(0,3,"icon-relation-model_selected");m(0,4,"icon-data-table-model_selected");m(0,5,"icon-entity-model_selected");m(0,6,"icon-metrics-model");m(0,7,"icon-metrics");Da.setStartPosition(1,
27);Da.setGap(2,1);Da.setIconSize(16,16);m(1,0,"btn-delete");m(1,1,"btn-edit");m(1,2,"btn-cooperation");m(1,4,"btn-inherit");m(1,5,"icon-expanded_hover");m(1,6,"icon-collapsed_hover");m(0,0,"btn-delete_hover");m(0,1,"btn-edit_hover");m(0,2,"btn-cooperation_hover");m(0,4,"btn-inherit_hover");m(0,5,"icon-expanded");m(0,6,"icon-collapsed");m(0,10,"btn-refresh");m(0,10,"btn-refresh_hover");m(0,11,"btn-delete_white");Da.setStartPosition(1,72);Da.setGap(2);Da.setIconSize(16,16);m(0,0,"icon-datetime");m(0,
1,"icon-date");m(0,2,"icon-number");m(0,3,"icon-int");m(0,4,"icon-string");m(0,5,"icon-boolean");m(1,0,"icon-datetime_selected");m(1,1,"icon-date_selected");m(1,2,"icon-number_selected");m(1,3,"icon-int_selected");m(1,4,"icon-string_selected");m(1,5,"icon-boolean_selected");Da.setStartPosition(1,114);Da.setGap(1);Da.setIconSize(170,98);m(0,0,"icon-empty");m(0,1,"icon-search_none");Da.setStartPosition(1,234);Da.setGap(1);Da.setIconSize(270,198);m(0,0,"icon-instructions");Da.setStartPosition(0,498);
Da.setGap(3);Da.setIconSize(16,16);m(0,0,"icon-metrics-model_selected");m(0,1,"icon-metrics_selected");Da.setStartPosition(33,498);Da.setGap(3);Da.setIconSize(20,20);m(0,0,"icon-field-visible");m(0,1,"icon-field-novisible")};var m=function(Ha,Da,Ga){Ya.registIcon(Ha,Da,Ga)}};var Oa=new function(){var Ya;this.hookCollector=function(m){Ya=m};this.occur=function(m,Ha){try{Ya&&Ya(m,Ha)}catch(Da){window.console&&console.warn(Da)}};this.getPageShowMethod=function(m){switch(m){case "0":return Oa.BY_MODEL;
case "1":return Oa.BY_USER_OR_ROLE}};this.getAuthUserOrRoleType=function(m){var Ha=com.kingdee.bos.qing.modeler.modelset.auth.model.UserDataAuth;switch(m){case Ha.USER:return Oa.SYSTEM_USER;case Ha.ROLE:return Oa.SYSTEM_ROLE;case Ha.MODELSET_ROLE:return Oa.MODELSET_ROLE}};this.getAuthInheritMethod=function(m){return m?Oa.USER_AND_ROLE:Oa.ONLY_USER}};Oa.PAGE_SHOW_METHOD="page-show-method";Oa.AUTH_USER_ROLE_TYPE="auth-user-role-type";Oa.DATA_AUTH_SETTING_SHOW_METHOD="data-auth-setting-show-method";
Oa.DATA_AUTH_SETTING_INHERIT_METHOD="data-auth-setting-inherit-method";Oa.BY_MODEL="\u6309\u6a21\u578b\u5c55\u793a";Oa.BY_USER_OR_ROLE="\u6309\u7528\u6237/\u89d2\u8272\u5c55\u793a";Oa.SYSTEM_USER="\u5f53\u524d\u7cfb\u7edf\u7528\u6237";Oa.SYSTEM_ROLE="\u5f53\u524d\u7cfb\u7edf\u89d2\u8272";Oa.MODELSET_ROLE="\u5f53\u524d\u6a21\u578b\u96c6\u89d2\u8272";Oa.ROW_AUTH="\u884c\u7ea7\u6743\u9650";Oa.COL_AUTH="\u5217\u7ea7\u6743\u9650";Oa.ONLY_USER="\u4ec5\u7528\u6237";Oa.USER_AND_ROLE="\u7528\u6237\u52a0\u89d2\u8272";
za.UserOperationReporter=Oa})();(function(){function W(N,K){this.toString=function(){return K};this.getValue=function(){return N}}function za(N){function K(){var ua,F;this.getLeftToolBarJqUi=function(){null==ua&&(ua=e());return ua};var e=function(){ua=$("<div>");ua.addClass("sbm-left-panel-toolbar");var h=$("<span>");h.addClass("sbm-left-panel-toolbar-text");h.text(a.get("deployedModels","\u5df2\u90e8\u7f72\u7684\u6a21\u578b"));h.appendTo(ua);c().appendTo(ua);h=$("<div>");h.addClass("sbm-left-refresh-btn");H.backgroundWithHover(h,
"btn-refresh");h.on("click",function(){O="";F.clear();sa.empty();Ba.checkModel()});h.attr("title",a.get("refreshModels","\u5237\u65b0\u6a21\u578b"));h.appendTo(ua);return ua},c=function(){F=new cb;F.setSearchListenerDelay(1E3);F.setShowSearchIcon(!0);F.setFoucs();F.setPlaceholder(a.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));var h=F.getJqUi();h.removeClass("sa-ctrl-common-singlelineborder");h.addClass("sbm-left-search-box");h.find(".sa-ctrl-searchbox-close").on("click",function(z){O=
F.getText();na&&Ba.initTreeRoot(O)});var l=h.find(":input");this.searchModel=function(){O=F.getText();na&&Ba.initTreeRoot(O)};l.attr("oninput","searchModel();");l.hide();h.on("mouseenter",function(z){h.css("width","135px");h.addClass("sa-ctrl-common-singlelineborder");l.show()});h.on("mouseleave",function(z){if(null==F.getText()||0===F.getText().length)h.css("width","20px"),h.removeClass("sa-ctrl-common-singlelineborder"),l.hide()});return h}}function M(){var ua=this,F,e,c={};c[Na.DATA_TABLE_MODEL]=
"data-table-model";c[Na.ENTITY_MODEL]="entity-model";c[Na.RELATION_MODEL]="relation-model";c[Na.METRICS_MODEL]="metrics-model";c[Na.METRIC]="metrics";var h,l,z=0,v=null,D=null,Z;this.getLeftTreeTableJqUi=function(){sa||(sa=$("<div>"),sa.addClass("sbm-left-tree-table"),ua.checkModel());return sa};this.checkModel=function(){X.createFacade(function(A){t=[];if(A)for(var q=0;q<A.length;q++){var B=new vb;B.fromJsonObject(A[q]);20001005===B.getStateCode()&&t.push(B.getModelId())}Q&&Q(t);u()},function(A,
q){return!1}).checkModel(db)};var u=function(){X.createFacade(function(A){A&&A.children?(ja.hide(),na=new gb,na.fromJsonObject(A),na=na.getChildren()[0],b(),sa.show(),Ea.setText(a.get("operationInstructions","\u8bf7\u70b9\u51fb\u5de6\u4fa7\u6a21\u578b\u8fdb\u884c\u6570\u636e\u6743\u9650\u8bbe\u7f6e")),Ea.updateIcon("icon-instructions",270,198),d.show(),x&&x(!0)):(r.hide(),d.hide(),na=null,sa.hide(),qa.setText(a.get("noDeployedModel","\u6682\u65e0\u5df2\u90e8\u7f72\u7684\u6a21\u578b")),ja.show(),x&&
x(!1))},function(A,q){return!1}).loadUsableModelNode(db)},b=function(){D=$("<div>");J.layoutCtrlWithLRTB(D,0,0,null,2,0,null);D.appendTo(sa);h=new lb;v=h.getJqUi();v.appendTo(D);h.setLineHeight(30);h.setRootVisible(!1);h.setNodePainter(w);h.addSelectingListener(g);ua.initTreeRoot(O);Z||(Z=new P,Z.setCallbackImmediately(function(){ua.resizeHeight()}),Z.observe())},g=function(A,q){if(q.getUserObject()instanceof gb&&q.getUserObject().getModelType()!==Na.METRICS_MODEL)return!1;F&&F===q||(d.hide(),r.show(),
p(A,q),F=q,aa=q.getUserObject(),e=aa.getModelId(),Ka=la=ba=!0,Fa.setCurrentTabPane(Ia))},p=function(A,q){var B=A.searchUiByModel(F);if(B){var T=B.find("#sbm-left-tree"),V=c[F.getUserObject().getModelType()];H.background(T,"icon-"+V);if(T=B.find(".sbm-left-tree-number_selected"))T.removeClass("sbm-left-tree-number_selected"),T.addClass("sbm-left-tree-number");if(B=B.find(".data-auth-preset_selected"))B.removeClass("data-auth-preset_selected"),B.addClass("data-auth-preset")}A=A.searchUiByModel(q);B=
A.find("#sbm-left-tree");q=c[q.getUserObject().getModelType()];H.background(B,"icon-"+q+"_selected");if(q=A.find(".sbm-left-tree-number"))q.removeClass("sbm-left-tree-number"),q.addClass("sbm-left-tree-number_selected");if(q=A.find(".data-auth-preset"))q.removeClass("data-auth-preset"),q.addClass("data-auth-preset_selected")};this.initTreeRoot=function(A){var q=new lb.BranchNode;q.setUserObject(na);q.setExpanded(!0);f(q,na,A,!0);l=q;0===l.getChildCount()?(sa.hide(),qa.setText(a.get("noMatchedResult",
"\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),qa.updateIcon("icon-search_none"),ja.show()):(ja.hide(),h.setRoot(l),r.hide(),e&&(h.expandToNode(F,!0),h.setSelecteds([F]),p(h,F),r.show()),sa.show(),ua.resizeHeight())};this.resizeHeight=function(){if(D){z=k(l,-1);var A=D.height(),q=31*z+Math.max(10-z,0);q>A&&(q=A);v.css("height",q+"px")}};var f=function(A,q,B,T){B&&(B=B.trim().toLowerCase());var V=function(Za){var $a=Za.getModelName().toLowerCase();Za=Za.getModelNumber();return!B||
-1!==$a.indexOf(B)||Za&&-1!==Za.toLowerCase().indexOf(B)?!0:!1};q=q.getChildren();for(var fa=0;fa<q.length;fa++)if(q[fa]instanceof gb){var ea=new lb.BranchNode;ea.setUserObject(q[fa]);ea.setExpanded(!1);e&&e===q[fa].getModelId()&&(F=ea);f(ea,q[fa],B,!1);B&&0<B.length&&ea.setExpanded(!0);B&&""!==B||T&&ea.setExpanded(!0);var ia=q[fa].getModelType()==Na.METRICS_MODEL&&B&&V(q[fa]);(0!==ea.getChildCount()||ia)&&A.addChild(ea);ia&&ea.setExpanded(0!==ea.getChildCount())}for(T=0;T<q.length;T++)q[T]instanceof
Na&&(!B||V(q[T]))&&(fa=new lb.LeafNode,fa.setUserObject(q[T]),e&&e===q[T].getModelId()&&(F=fa),A.addChild(fa))},w=function(A,q){if(q.getUserObject()instanceof gb&&q.getUserObject().getModelType()!==Na.METRICS_MODEL)q.setSelectable(!1),A.text(q.getUserObject().getModelName());else{var B=0,T=q.getUserObject().getModelId();if(-1!==t.indexOf(T)){var V=q.getUserObject().getModelName(),fa=q.getUserObject().getModelType(),ea=$("<div id='sModelId'>"),ia=$("<span>");ia.text(a.get("modelException","\u6a21\u578b\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));
ia.appendTo(ea);ia=$("<span id='"+T+"'>");$(document).on("click","#"+T,function(){n.getModelDesignerEntrance()(db,T,V,fa)});ia.text(" "+a.get("viewModel","\u67e5\u770b\u8be5\u6a21\u578b"));ia.css({cursor:"pointer",color:"rgb(14, 95, 216)"});ia.appendTo(ea);ia=mb.createWarning();q.getUserObject().getModelType()===Na.METRICS_MODEL?J.layoutCtrlWithLRTB(ia,B+2,null,12,7,null,12):J.layoutCtrlWithLRTB(ia,B+2,null,12,9,null,12);A.append(ia);var Za=new wb;Za.mounting(ia);Za.setSuggestedSize(265,40);Za.setHtml(ea);
B+=20}y&&(ea=$("<div>"),ea.addClass("data-auth-preset"),ea.text(a.get("preset","\u9884\u7f6e")),J.layoutCtrlWithLRTB(ea,B,null,24,9,null,11),A.append(ea),B+=30);ea=$("<div id='sbm-left-tree'>");J.layoutCtrlWithLRTB(ea,B,null,16,8,null,16);ia=c[q.getUserObject().getModelType()];H.background(ea,"icon-"+ia);A.append(ea);ea=$("<div>");J.layoutCtrlWithLRTB(ea,B+20,0,null,0,null,30);B=$("<div>");J.layoutCtrlWithLRTB(B,0,0,null,0,null,30);B.css({display:"flex"});var $a=$("<span class='sbm-left-tree-text'>");
$a.css({"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"});B.append($a);ia=$("<span class='sbm-left-tree-number-container'>");Za=$("<span>");Za.addClass("sbm-left-tree-number");ia.css({"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden","padding-left":"5px"});ia.append(Za);var bb=q.getUserObject().getModelName(),fb=q.getUserObject().getModelNumber();if(O){var hb=bb.trim().toLowerCase(),kb=O.trim().toLowerCase(),ha=hb.indexOf(kb);if(-1!=ha){hb=ha+kb.length;var wa=
$("<span>");wa.text(bb.slice(0,ha));wa.appendTo($a);wa=$("<span>");wa.text(bb.slice(ha,hb));wa.appendTo($a);wa.css("color","red");ha=$("<span>");ha.text(bb.slice(hb));ha.appendTo($a)}else $a.text(bb);$a="( "+fb+" )";bb=$a.trim().toLowerCase().indexOf(kb);-1!=bb?(kb=bb+kb.length,hb=$("<span>"),hb.text($a.slice(0,bb)),hb.appendTo(Za),hb=$("<span>"),hb.text($a.slice(bb,kb)),hb.appendTo(Za),hb.css("color","red"),bb=$("<span>"),bb.text($a.slice(kb)),bb.appendTo(Za)):Za.text("( "+fb+" )")}else $a.text(q.getUserObject().getModelName()),
Za.text("( "+fb+" )");ia.appendTo(B);B.appendTo(ea);A.css({overflow:"visible"});A.append(ea)}A.attr("title",q.getUserObject().getModelName()+" ( "+fb+" )");q=parseInt(q.getUserObject().getLevel());A.css({width:290-20*q+"px"})},k=function(A,q){q+=1;if(A instanceof lb.BranchNode)for(var B=A.getAllChildren(),T=0;T<B.length;T++)q=k(A.getChild(T),q);return q}}function L(){var ua,F=[xa.USER,xa.ROLE,xa.MODELSET_ROLE];Ma[xa.USER]=new function(){var e,c,h,l,z,v=[];this.getTable=function(){return l};this.getJqUi=
function(){if(!e){e=$("<div>");c=$("<div>");J.layoutCtrlWithLRTB(c,800,0,null,-35,null,35);var g=$("<div>");g.text(a.get("addUsers","\u6dfb\u52a0\u7528\u6237"));g.addClass("sbm-right-panel-sys-user-add");!y&&g.appendTo(c);g.on("mousedown",D);h=$("<div>");h.text(a.get("deleteUsers","\u79fb\u9664\u7528\u6237"));h.addClass("sbm-right-panel-sys-user-delete");!y&&h.appendTo(c);h.on("mousedown",u);c.appendTo(e);l=new ca;l.setTabType(xa.USER);z=l.getUserTableJqUi();z.appendTo(e)}return e};var D=function(){var g=
U;g.setCallBack(function(w){if(!w||!w.content)return!0;w=w.content;var k=w.selecteds;if("cancel"===w.operation||"undefined"===k)return!0;Z(k)});for(var p=[],f=0;f<v.length;f++)p.push(v[f].getUserId());g.openUserForm(p)},Z=function(g){for(var p=[],f=Object.keys(g),w=0;w<v.length;w++){var k=v[w].getUserId();p.push(k)}w=[];for(k=0;k<f.length;k++)-1==p.indexOf(f[k])&&w.push(f[k]);f=w.slice(0);if(0===f.length)return!0;p=aa.getModelId();X.createFacade(function(A){X.getMessageCurtain().showSuccess(a.get("successfullyAdded",
"\u6dfb\u52a0\u6210\u529f\u3002"));for(var q=0;q<f.length;q++){var B=f[q],T=g[B],V=new xa;V.initialize(B,T);V.setJobNumber(A[B]);v.push(V)}Xa.occur(Xa.AUTH_USER_ROLE_TYPE,Xa.getAuthUserOrRoleType(G));l.updateTable(v)},function(A,q){return 20007014==A?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==A?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),
!0):!1}).doAddUser([p],f,xa.USER)},u=function(){var g=l.getSelectedUsers();if(0===g.length)X.getMessageCurtain().showPrompt(a.get("selectUsersToDelete","\u8bf7\u9009\u62e9\u9700\u8981\u79fb\u9664\u7684\u7528\u6237\u3002"));else{for(var p=[],f=0;f<g.length;f++)p.push(g[f].getUserId());f=g[0].getUserName();var w=new Qa,k=a.get("confirmDeleteUsers","\u786e\u5b9a\u8981\u79fb\u9664\u201c#1\u201d\u7b49#2\u4e2a\u7528\u6237\u5417?").replace("#1",f).replace("#2",p.length);1===g.length&&(k=a.get("confirmDeleteUser",
"\u786e\u5b9a\u8981\u79fb\u9664\u7528\u6237\u201c#1\u201d\u5417\uff1f").replace("#1",f));w.setConfirmMsg(k);w.setConfirmListener(function(){b(p,!0)});w.createDialog().show()}},b=function(g,p){var f=aa.getModelId();X.createFacade(function(w){p&&X.getMessageCurtain().showSuccess(a.get("deleteSucceeded","\u79fb\u9664\u6210\u529f\u3002"));w=[];for(var k=0;k<v.length;k++)-1==g.indexOf(v[k].getUserId())&&w.push(v[k]);v=w;l.updateTable(v)},function(w,k){return 20007014==w?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy",
"\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==w?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}).doDeleteUser(f,g,G)};this.getTitle=function(){return a.get("currentSysUser","\u5f53\u524d\u7cfb\u7edf\u7528\u6237")};this.into=function(){G=xa.USER;aa&&ba?(l.clearTable(),ya(aa.getModelId(),xa.USER,function(){v=ka.slice(0);l.updateTable(v);
ba=!1},aa.getModelType())):l.updateTable(v)}};Ma[xa.ROLE]=new function(){var e,c,h,l,z,v=[];this.getTable=function(){return l};this.getJqUi=function(){if(!e){e=$("<div>");c=$("<div>");J.layoutCtrlWithLRTB(c,800,0,null,-35,null,35);var g=$("<div>");g.text(a.get("addRoles","\u6dfb\u52a0\u89d2\u8272"));g.addClass("sbm-right-panel-sys-role-add");!y&&g.appendTo(c);g.on("mousedown",D);h=$("<div>");h.text(a.get("deleteRoles","\u79fb\u9664\u89d2\u8272"));h.addClass("sbm-right-panel-sys-role-delete");!y&&
h.appendTo(c);h.on("mousedown",u);c.appendTo(e);l=new ca;l.setTabType(xa.ROLE);z=l.getUserTableJqUi();z.appendTo(e)}return e};var D=function(){var g=U;g.setCallBack(function(w){if(!w||!w.content)return!0;w=w.content;var k=w.selecteds;if("cancel"===w.operation||"undefined"===k)return!0;Z(k)});for(var p=[],f=0;f<v.length;f++)p.push(v[f].getUserId());g.openRoleForm(p)},Z=function(g){for(var p=[],f=Object.keys(g),w=0;w<v.length;w++){var k=v[w].getUserId();p.push(k)}w=[];for(k=0;k<f.length;k++)-1==p.indexOf(f[k])&&
w.push(f[k]);f=w.slice(0);if(0===f.length)return!0;p=aa.getModelId();X.createFacade(function(A){X.getMessageCurtain().showSuccess(a.get("successfullyAdded","\u6dfb\u52a0\u6210\u529f\u3002"));for(var q=0;q<f.length;q++){var B=f[q],T=g[B],V=new xa;V.initialize(B,T);V.setJobNumber(A[B]);v.push(V)}Xa.occur(Xa.AUTH_USER_ROLE_TYPE,Xa.getAuthUserOrRoleType(G));l.updateTable(v)},function(A,q){return 20007014==A?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),
!0):20003102==A?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}).doAddUser([p],f,xa.ROLE)},u=function(){var g=l.getSelectedUsers();if(0===g.length)X.getMessageCurtain().showPrompt(a.get("selectRolesToDelete","\u8bf7\u9009\u62e9\u9700\u8981\u79fb\u9664\u7684\u89d2\u8272\u3002"));else{for(var p=[],f=0;f<g.length;f++)p.push(g[f].getUserId());f=g[0].getUserName();var w=new Qa,k=a.get("confirmDeleteRoles",
"\u786e\u5b9a\u8981\u79fb\u9664\u201c#1\u201d\u7b49#2\u4e2a\u89d2\u8272\u5417?").replace("#1",f).replace("#2",p.length);1===g.length&&(k=a.get("confirmDeleteRole","\u786e\u5b9a\u8981\u79fb\u9664\u89d2\u8272\u201c#1\u201d\u5417\uff1f").replace("#1",f));w.setConfirmMsg(k);w.setConfirmListener(function(){b(p,!0)});w.createDialog().show()}},b=function(g,p){var f=aa.getModelId();X.createFacade(function(w){p&&X.getMessageCurtain().showSuccess(a.get("deleteSucceeded","\u79fb\u9664\u6210\u529f\u3002"));w=
[];for(var k=0;k<v.length;k++)-1==g.indexOf(v[k].getUserId())&&w.push(v[k]);v=w;l.updateTable(v)},function(w,k){return 20007014==w?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==w?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u5931\u8d25\u3002")),!0):!1}).doDeleteUser(f,g,G)};this.getTitle=
function(){return a.get("currentSysRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272")};this.into=function(){G=xa.ROLE;Ka?(l.clearTable(),ya(aa.getModelId(),xa.ROLE,function(){v=ka.slice(0);l.updateTable(v);Ka=!1},aa.getModelType())):l.updateTable(v)}};Ma[xa.MODELSET_ROLE]=new function(){var e,c,h,l,z,v=[];this.getTable=function(){return l};this.getJqUi=function(){if(!e){e=$("<div>");c=$("<div>");J.layoutCtrlWithLRTB(c,800,0,null,-35,null,35);var p=$("<div>");p.text(a.get("modelSetRoleManage","\u6a21\u578b\u96c6\u89d2\u8272\u7ba1\u7406"));
p.addClass("sbm-right-panel-model-role-manage");p.appendTo(c);p.on("mousedown",D);h=$("<div>");h.text(a.get("deleteRoles","\u79fb\u9664\u89d2\u8272"));h.addClass("sbm-right-panel-model-role-delete");!y&&h.appendTo(c);h.on("mousedown",Z);p=$("<div>");p.text(a.get("addRoles","\u6dfb\u52a0\u89d2\u8272"));p.addClass("sbm-right-panel-model-role-add");!y&&p.appendTo(c);p.on("mousedown",b);c.appendTo(e);l=new ca;l.setTabType(xa.MODELSET_ROLE);z=l.getUserTableJqUi();z.appendTo(e)}return e};var D=function(){n.getDataAuthorityManager()(db,
xb,y)},Z=function(){var p=l.getSelectedUsers();if(0===p.length)X.getMessageCurtain().showPrompt(a.get("selectRolesToDelete","\u8bf7\u9009\u62e9\u9700\u8981\u79fb\u9664\u7684\u89d2\u8272\u3002"));else{for(var f=[],w=0;w<p.length;w++)f.push(p[w].getUserId());w=p[0].getUserName();var k=new Qa,A=a.get("confirmDeleteRoles","\u786e\u5b9a\u8981\u79fb\u9664\u201c#1\u201d\u7b49#2\u4e2a\u89d2\u8272\u5417?").replace("#1",w).replace("#2",f.length);1===p.length&&(A=a.get("confirmDeleteRole","\u786e\u5b9a\u8981\u79fb\u9664\u89d2\u8272\u201c#1\u201d\u5417\uff1f").replace("#1",
w));k.setConfirmMsg(A);k.setConfirmListener(function(){u(f,!0)});k.createDialog().show()}},u=function(p,f){var w=aa.getModelId();X.createFacade(function(k){f&&X.getMessageCurtain().showSuccess(a.get("deleteSucceeded","\u79fb\u9664\u6210\u529f\u3002"));k=[];for(var A=0;A<v.length;A++)-1==p.indexOf(v[A].getUserId())&&k.push(v[A]);v=k;l.updateTable(v)},function(k,A){return 20007014==k?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),
!0):20003102==k?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u5931\u8d25\u3002")),!0):!1}).doDeleteUser(w,p,G)},b=function(){var p=new Oa;p.setFunAfterSelect(g);for(var f=[],w=0;w<v.length;w++)20007007!==v[w].getErrorCode()&&f.push(v[w].getUserId());p.setPreSelected(f);p.showDialog()},g=function(p){for(var f=[],w=[],k=[],A=0;A<v.length;A++)k.push(v[A].getUserId());for(A=0;A<p.length;A++){var q=p[A].getModelSetRoleId();
w.push(q);-1==k.indexOf(q)&&f.push(q)}if(0===f.length)return!0;w=aa.getModelId();X.createFacade(function(B){X.getMessageCurtain().showSuccess(a.get("successfullyAdded","\u6dfb\u52a0\u6210\u529f\u3002"));for(B=0;B<p.length;B++){var T=p[B].getModelSetRoleId();if(-1!=f.indexOf(T)){var V=p[B].getModelSetRoleName(),fa=new xa;fa.initialize(T,V);v.push(fa)}}Xa.occur(Xa.AUTH_USER_ROLE_TYPE,Xa.getAuthUserOrRoleType(G));l.updateTable(v)},function(B,T){return 20007014==B?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy",
"\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==B?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}).doAddUser([w],f,xa.MODELSET_ROLE)};this.getTitle=function(){return a.get("currentModelSetRole","\u5f53\u524d\u6a21\u578b\u96c6\u89d2\u8272")};this.into=function(){G=xa.MODELSET_ROLE;la?(l.clearTable(),ya(aa.getModelId(),xa.MODELSET_ROLE,
function(){v=ka.slice(0);l.updateTable(v);la=!1},aa.getModelType())):l.updateTable(v)}};this.getJqUi=function(){if(!ua){ua=$("<div>");J.layoutCtrlWithLRTB(ua,5,0,null,10,0,null);Fa=new ab;Fa.setTabLevel(ab.SECOND_LEVEL);for(var e=!0,c=0;c<F.length;c++){var h=F[c];Fa.addTab(Ma[h],e);e&&(G=h,Ia=Fa.getCurrentTabPane());e=!1}Fa.getJqUi().appendTo(ua)}return ua}}function ca(){function ua(){KTDefaultCellRender.call(this,c);var u=this,b=this.paintCellUI;this.paintCellUI=function(f,w){var k=u.getCurrentRowIdx(),
A=u.getCurrentColIdx();if(k>=pa.getHeadRowCount()){var q=u.getCurrentRow().getUserObject(),B=$(f),T=$("<div>");if(0==A)f=new R,f.setChecked(!1),f.setUserObject(q),f.addCheckedListener(function(ea,ia){if(!ia)return!0;if(ea.isChecked()){ea=!0;for(ia=0;ia<l.length;ia++)if(!l[ia].isChecked()){ea=!1;break}z.setChecked(ea)}else z.setChecked(!1)}),l.push(f),q=$("<div>"),f=f.getJqUi(),f.addClass("sbm-right-panel-viewer-index"),f.appendTo(q),f=$("<div>"),f.text(k-2),f.addClass("sbm-right-panel-viewer-index"),
f.css("top","-6px"),f.appendTo(q),q.addClass("sbm-right-panel-viewer-index-container"),B.append(q);else if(1==A)k=15,q.getErrorCode()&&0!==q.getErrorCode()&&(k=mb.createWarning(),J.layoutCtrlWithLRTB(k,15,null,12,14,null,12),k.appendTo(B),20007012===q.getErrorCode()?k.attr("title",a.get("userDisabled","\u8be5\u7cfb\u7edf\u7528\u6237\u5df2\u88ab\u7981\u7528")):20007013===q.getErrorCode()?k.attr("title",a.get("roleDisabled","\u8be5\u7cfb\u7edf\u89d2\u8272\u5df2\u88ab\u7981\u7528")):100===q.getErrorCode()&&
k.attr("title",a.get("userIsCoop","\u8be5\u7528\u6237\u662f\u672c\u6a21\u578b\u96c6\u7684\u534f\u4f5c\u6210\u5458\uff0c\u62e5\u6709\u6a21\u578b\u96c6\u4e0b\u6240\u6709\u6a21\u578b\u7684\u5168\u90e8\u6570\u636e\u6743\u9650\uff0c\u672c\u6761\u6743\u9650\u8bbe\u7f6e\u65e0\u6548\u3002")),k=32),T.text(q.getUserName()),T.attr("title",q.getUserName()),J.layoutCtrlWithLRTB(T,k,0,null,10,null,23),T.css("line-height","23px"),B.append(T);else if(2==A)T.text(q.getJobNumber()),T.attr("title",q.getJobNumber()),
J.layoutCtrlWithLRTB(T,15,0,null,10,null,23),T.css("line-height","23px"),B.append(T);else if(3==A)k=new ob,k.setUserObject(q),k.addStateChangeListener(g),k.setOn(q.isEnable()),k.setEnabled(!y),k=k.getJqUi(),k.addClass("sbm-right-panel-enable-button"),y&&k.css("cursor","not-allowed"),q=$("<div>"),q.addClass("sbm-right-panel-enable-button-container"),k.appendTo(q),B.append(q);else if(4==A){var V=$("<div>");H.backgroundWithHover(V,"btn-edit");V.addClass("sbm-right-panel-edit-icon");V.on("click",function(){var ea=
parseInt(V.attr("rowIdx")),ia=c.getRow(ea).getUserObject().isInheritPermissions(),Za=c.getRow(ea).getUserObject().getUserId();ia=G===xa.USER?ia:!1;var $a=new Ya(ia,aa,G,Za,y);aa&&(ia=aa.getModelId(),t&&-1!==t.indexOf(ia)&&(F.checkModelExistMV(ia,function(bb){bb&&$a.setErrorPrompt(a.get("onlyShowDataAuth","\u6a21\u578b\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002\u7531\u4e8e\u5f53\u524d\u6a21\u578b\u5df2\u5b58\u5728\u7269\u5316\u6570\u636e\uff0c\u4ee5\u4e0b\u4ec5\u5c55\u793a\u5bf9\u7269\u5316\u6570\u636e\u751f\u6548\u7684\u6570\u636e\u6743\u9650\u5185\u5bb9\u3002"))}),
$a.setFooterClosingOnly(!0)));$a.setFunAfterSettingAuth(function(bb,fb){l=[];c.getRow(ea).getUserObject().setEnable(!0);c.getRow(ea).getUserObject().setDataAuth(fb);c.updateUI()});$a.showDialog()});V.attr("title",a.get("editPermission","\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));V.attr("rowIdx",k);f=$("<div>");f.addClass("sbm-right-panel-edit-icon-container");V.appendTo(f);if(G===xa.USER&&aa.getModelType()!==Na.METRIC){var fa=$("<div>");q.isInheritPermissions()?(H.background(fa,"btn-inherit"),fa.attr("title",
a.get("permissionInherited","\u672c\u6761\u6743\u9650\u540c\u65f6\u53d7\u7528\u6237\u6743\u9650\u548c\u89d2\u8272\u6743\u9650\u7684\u5f71\u54cd\u3002\u70b9\u51fb\u56fe\u6807\u53ef\u8c03\u6574\u4e3a\u4ee5\u5355\u72ec\u8bbe\u7f6e\u7684\u7528\u6237\u6743\u9650\u4e3a\u51c6\u3002"))):(H.background(fa,"btn-inherit_hover"),fa.attr("title",a.get("noPermissionInherited","\u672c\u6761\u6743\u9650\u4ee5\u5355\u72ec\u8bbe\u7f6e\u7684\u7528\u6237\u6743\u9650\u4e3a\u51c6\uff0c\u4e0d\u53d7\u89d2\u8272\u6743\u9650\u7684\u5f71\u54cd\u3002\u70b9\u51fb\u56fe\u6807\u53ef\u6062\u590d\u4e3a\u540c\u65f6\u53d7\u7528\u6237\u6743\u9650\u548c\u89d2\u8272\u6743\u9650\u7684\u5f71\u54cd\u3002")));
fa.addClass("sbm-right-panel-edit-icon");fa.css({cursor:"pointer","margin-left":"25px"});!y&&fa.on("click",function(){var ea=parseInt(fa.attr("rowIdx"));p(ea)});fa.attr("rowIdx",k);fa.css("cursor",y?"not-allowed":"pointer");fa.appendTo(f)}f.appendTo(B)}else 5==A?(f=q.getQingModelerDataAuth(),F.paintSummaryCell(B,f,k,q.isEnable(),aa.getModelType()===Na.METRIC),T=q.getDataAuthId(),ma[T]=B,ra[T]=q,Pa[T]=k,!f&&T&&(B.empty(),k=$("<div>"),k.addClass("sa-common-loading-icon"),k.css("background-image",Y.getIconUrl("common",
"loading.gif")),J.layoutCtrlCenterAlign(k,23),J.layoutCtrlMiddleAlign(k,23),k.appendTo(B))):b(f,w)}else b(f,w),0==A&&1==k&&(z=new R,z.addCheckedListener(function(ea,ia){if(ia)for(ia=0;ia<l.length;ia++)l[ia].setChecked(ea.isChecked())}),z.setChecked(!1),B=$("<div>"),k=z.getJqUi(),k.addClass("sbm-right-panel-viewer-index"),k.appendTo(B),k=$("<div>"),k.text("#"),k.addClass("sbm-right-panel-viewer-index"),k.css("top","-6px"),k.appendTo(B),B.addClass("sbm-right-panel-viewer-index-container"),B.css("top",
"3px"),B.appendTo(f)),$(f).css("color","#666")};var g=function(f,w,k){if(w){var A=f.getUserObject();w=aa.getModelId();var q=aa.getModelType();A=A.getUserId();X.createFacade(function(B){l=[];f.getUserObject().setEnable(k);c.updateUI()},function(B,T){return 20007014==B?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20007005==B?(X.getMessageCurtain().showPrompt(a.get("modelNoFound",
"\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20007006==B?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==B?(X.getMessageCurtain().showPrompt(a.get("modelNoFound","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):!1}).authorizedDataAuth(w,A,k,G,q,db)}},p=function(f){var w=
aa.getModelId(),k=c.getRow(f).getUserObject(),A=k.getUserId(),q=!k.isInheritPermissions();X.createFacade(function(B){l=[];c.getRow(f).getUserObject().setInheritPermissions(q);c.updateUI();Xa.occur(Xa.DATA_AUTH_SETTING_INHERIT_METHOD,Xa.getAuthInheritMethod(q))},function(B,T){return 20007014==B?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==B?(X.getMessageCurtain().showPrompt(a.get("modelNoFound",
"\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):!1}).setInherit(w,A,q,G)}}var F=this,e,c,h,l=[],z,v,D={};D[xa.USER]=a.get("sysUserSummary","\u5f53\u524d\u7cfb\u7edf\u7528\u6237\u7684\u6570\u636e\u6743\u9650\u6458\u8981");D[xa.ROLE]=a.get("sysRoleSummary","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272\u7684\u6570\u636e\u6743\u9650\u6458\u8981");D[xa.MODELSET_ROLE]=a.get("modelSetRoleSummary","\u5f53\u524d\u6a21\u578b\u96c6\u89d2\u8272\u7684\u6570\u636e\u6743\u9650\u6458\u8981");
this.setTabType=function(u){v=u};this.clearTable=function(){pa.clearWithoutHead(c);c.updateUI()};this.getSelectedUsers=function(){for(var u=[],b=0;b<l.length;b++)l[b].isChecked()&&u.push(l[b].getUserObject());return u};this.getUserTableJqUi=function(){if(!h){h=$("<div>");J.layoutCtrlWithLRTB(h,0,0,null,0,0,null);c=pa.createTable();var u=$(c.getUI());J.layoutCtrlWithLRTB(u,0,0,null,0,0,null);c.setCellRender(new ua);c.setSyncUIWhenModelChanged(!1);c.setDraggableAdjusting(!0,3,0);c.setFrozenRows(3);
c.setColumnFitVisibleWidth(!0);u.appendTo(h)}return h};this.updateTable=function(u){l=[];pa.clear(c);c.addColumns(6);var b=pa.createHeadRow(c);b.getCell(0).setValue("");b.getCell(1).setValue(a.get("userName","\u7528\u6237\u540d\u79f0"));b.getCell(2).setValue(a.get("userId","\u5de5\u53f7"));G!==xa.USER&&(b.getCell(1).setValue(a.get("roleName","\u89d2\u8272\u540d\u79f0")),b.getCell(2).setValue(a.get("code","\u7f16\u7801")));b.getCell(3).setValue(a.get("enable","\u542f\u7528\u72b6\u6001"));b.getCell(4).setValue(a.get("settings",
"\u6570\u636e\u6743\u9650\u8bbe\u7f6e"));b.getCell(5).setValue(D[v]);c.getColumn(0).setWidth(122);c.getColumn(1).setWidth(240);c.getColumn(2).setWidth(240);c.getColumn(3).setWidth(240);c.getColumn(4).setWidth(240);c.getColumn(5).setWidth(458);G===xa.MODELSET_ROLE&&(c.getColumn(0).setWidth(122),c.getColumn(1).setWidth(240),c.getColumn(2).setHide(!0),c.getColumn(3).setWidth(240),c.getColumn(4).setWidth(240),c.getColumn(5).setWidth(699));b.setHeight(26);for(b=0;b<u.length;b++){var g=u[b],p=pa.createRow(c,
!0);p.setHeight(40);p.setUserObject(g)}c.updateUI();e||(e=new P,e.setCallbackImmediately(function(){F.resize()}),e.observe())};this.resize=function(){if(pb&&G===v){var u=l.slice(0);l=[];c.updateUI();if(u.length===l.length)for(var b=0;b<u.length;b++)l[b].setChecked(u[b].isChecked())}};this.checkModelExistMV=function(u,b){X.createFacade(function(g){b(g)},function(g,p){return!1}).checkModelExistMV(u)};this.paintSummaryCell=function(u,b,g,p,f){u.empty();f=b?b.toString(f):"";var w=f.split("\n"),k=$("<div>");
k.text(w[0]);J.layoutCtrlWithLRTB(k,15,80,null,2,null,16);k.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});var A=$("<div>");A.text(w[1]);J.layoutCtrlWithLRTB(A,15,80,null,22,null,16);A.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});p||(k.css("opacity","0.5"),A.css("opacity","0.5"));var q;b&&(q=b.getModels());q&&q[0]&&q[0].getRowAuth();var B=$("<div>");B.css("cursor","pointer");H.backgroundWithHover(B,"btn-delete");J.layoutCtrlWithLRTB(B,null,
34,16,14,null,16);B.on("click",function(){var T=new sb;T.setText(a.get("deleteDataPermission","\u6e05\u7a7a\u884c\u7ea7\u548c\u5217\u7ea7\u6570\u636e\u6743\u9650\u8bbe\u7f6e\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u6e05\u7a7a\u5417\uff1f"));T.setConfirmedListener(function(V){var fa=parseInt(B.attr("rowIdx"));V&&Z(fa)});T.show(B)});B.attr("title",a.get("deleteAllPermissions","\u6e05\u7a7a\u884c\u7ea7\u548c\u5217\u7ea7\u6570\u636e\u6743\u9650\u8bbe\u7f6e"));B.attr("rowIdx",g);!y&&B.appendTo(u);
""===f?B.css("display","none"):B.css("display","block");!w[1]&&k.css({top:"50%",transform:"translateY(-50%)"});u.append(k);u.append(A);u.attr("title",f)};var Z=function(u){var b=aa.getModelId(),g=c.getRow(u).getUserObject().getUserId();X.createFacade(function(p){X.getMessageCurtain().showSuccess(a.get("successToDeletePermission","\u5220\u9664\u6210\u529f\u3002"));l=[];c.getRow(u).getUserObject().setDataAuth(new ib);c.updateUI()},function(p,f){return 20007004==p?(X.getMessageCurtain().showPrompt(a.get("deleteFail",
"\u8be5\u6761\u6570\u636e\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}).deletePermission(b,g,G)}}var y=N,I,C,S,na,aa,ka=[],Fa,Ia,G,O,qa,ja,Ba,sa,Ea,d,r,t=[],Q,x,ba=!1,Ka=!1,la=!1,Ma={},Pa={},ma={},ra={};this.resize=function(){Ba.resizeHeight();Fa.getCurrentTabPane().getTable().resize()};this.setErrorStateListener=function(ua){Q=ua};this.setModelStateListener=function(ua){x=ua};this.getModelSetMainAreaJqUi=function(){I||(I=$("<div>"),I.addClass("sbm-container"),C=$("<div>"),
C.addClass("sbm-left-panel"),(new K).getLeftToolBarJqUi().appendTo(C),Ba=new M,sa=Ba.getLeftTreeTableJqUi(),sa.appendTo(C),qa=new La,ja=qa.getNoDataTableJqUi(),qa.setTopPx(46),ja.appendTo(C),ja.hide(),S=$("<div>"),S.addClass("sbm-right-panel"),r=(new L).getJqUi(),r.appendTo(S),r.hide(),Ea=new La,d=Ea.getNoDataTableJqUi(),d.appendTo(S),d.hide(),C.appendTo(I),S.appendTo(I));return I};var ya=function(ua,F,e,c){X.createFacade(function(h){ka=[];var l=[];if(h)for(var z=0;z<h.length;z++){var v=new xa;v.fromJsonObject(h[z]);
ka.push(v);l.push(v.getDataAuthId())}e&&e();h=[];for(z=1;z<=l.length;z++)h.push(l[z-1]),0===z%5&&(Ra(h,F,c),h=[]);0<h.length&&Ra(h,F,c)},function(h,l){e&&e();return 20007003==h?(X.getMessageCurtain().showPrompt(a.get("modelSetNoFound","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u5148\u5237\u65b0\u754c\u9762\u3002")),!0):21000002==h?(X.getMessageCurtain().showPrompt(a.get("modelSetNoFound","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u5148\u5237\u65b0\u754c\u9762\u3002")),!0):20003102==
h?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundRefresh","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u5148\u5237\u65b0\u754c\u9762\u3002")),!0):!1}).loadUsableUserDataAuth(db,ua,F)},Ra=function(ua,F,e){var c=X.createFacade(function(h){if(h)for(var l=0;l<ua.length;l++){var z=ua[l],v=new ib;h[z]&&v.fromJsonObject(h[z]);var D=ma[z];if(D){var Z=ra[z];Z.setDataAuth(v);z=Pa[z];Ma[F].getTable().paintSummaryCell(D,v,z,Z.isEnable(),e===Na.METRIC)}}},function(h,l){return!0});c.setShowBlocking(!1);
c.queryDataAuthContents(ua)}}function Aa(N){function K(){var F=this,e,c,h,l,z,v,D,Z,u,b,g,p=[],f,w={};w[xa.USER]=[];w[xa.ROLE]=[];w[xa.MODELSET_ROLE]=[];var k,A;this.updateModelState=function(ha){ha&&u.show();!ha&&u.hide()};this.isCurrentTabModelEmpty=function(){return 0===w[G].length};this.setSearchCallBack=function(ha){A=ha};this.refreshModel=function(){X.createFacade(function(ha){var wa=[];if(ha)for(var Ja=0;Ja<ha.length;Ja++){var Ca=new vb;Ca.fromJsonObject(ha[Ja]);20001005===Ca.getStateCode()&&
wa.push(Ca.getModelId())}L.updateModelState(0!==ha.length);L.updateErrorModels(wa);ha=q();ea(ha,!0)},function(ha,wa){return!1}).checkModel(db)};var q=function(){switch(G){case xa.USER:return c;case xa.ROLE:return h;case xa.MODELSET_ROLE:return l}};this.getJqUi=function(){e||(e=B());return e};var B=function(){e=$("<div>");J.layoutCtrlWithLRTB(e,0,0,null,0,0,null);c=$("<div>");c.text(a.get("currentSysUser","\u5f53\u524d\u7cfb\u7edf\u7528\u6237"));c.addClass("sbu-left-panel-user-label");c.appendTo(e);
c.on("mousedown",function(){if(G===xa.USER)return!1;G=xa.USER;ea(c)});h=$("<div>");h.text(a.get("currentSysRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272"));h.addClass("sbu-left-panel-user-label");h.css("left","100px");h.appendTo(e);h.on("mousedown",function(){if(G===xa.ROLE)return!1;G=xa.ROLE;ea(h)});l=$("<div>");l.text(a.get("currentModelSetRole","\u5f53\u524d\u6a21\u578b\u96c6\u89d2\u8272"));l.addClass("sbu-left-panel-user-label");l.css({left:"200px",width:"120px"});l.appendTo(e);l.on("mousedown",
function(){if(G===xa.MODELSET_ROLE)return!1;G=xa.MODELSET_ROLE;ea(l)});Z=$("<div>");Z.addClass("sbu-left-panel-link-container");Z.appendTo(e);Z.hide();var ha=$("<div>");ha.addClass(" sbu-left-panel-model-role-manage");ha.text(a.get("modelSetRoleManage","\u6a21\u578b\u96c6\u89d2\u8272\u7ba1\u7406"));ha.appendTo(Z);ha.on("mousedown",kb);v=new yb;v.setBorderVisible(!1);v.setEnabled(!0);v.addSelectedChangedListener(V);v.addPressedListener(fa);v.setCustomItemPainter(T);D=v.getJqUi();J.layoutCtrlWithLRTB(D,
0,0,null,36,32,null);D.appendTo(e);u=$("<div>");u.text(a.get("addUsers","\u6dfb\u52a0\u7528\u6237"));u.addClass("sbu-left-panel-add-user");!ca&&u.appendTo(e);u.on("mousedown",$a);!Ea&&u.hide();b=new La;g=b.getNoDataTableJqUi();b.setTopPx(100);b.setText(a.get("noUser","\u8bf7\u5148\u6dfb\u52a0\u7528\u6237"));!ca&&g.appendTo(e);g.hide();G=xa.USER;ea(c);k||(k=new P,k.setCallbackImmediately(function(){F.refreshHeight()}),k.observe());return e},T=function(ha,wa){ha.css({"font-size":"14px",height:"30px"});
var Ja=$("<div>");J.layoutCtrlWithLRTB(Ja,0,0,null,0,0,null);Ja.appendTo(ha);var Ca=$("<div>");H.background(Ca,"btn-cooperation");J.layoutCtrlWithLRTB(Ca,2,null,16,7,null,16);Ca.appendTo(Ja);var Wa=$("<div>");Wa.addClass("sbu-left-panel-list-item-label");Wa.text(wa.getUserName());Wa.appendTo(Ja);Wa.attr("title",wa.getUserName());wa.getErrorCode()&&0!==wa.getErrorCode()&&(Wa.css({left:"35px"}),Ca=mb.createWarning(),J.layoutCtrlWithLRTB(Ca,20,null,12,8,null,12),20007012===wa.getErrorCode()?Ca.attr("title",
a.get("userDisabled","\u8be5\u7cfb\u7edf\u7528\u6237\u5df2\u88ab\u7981\u7528")):20007013===wa.getErrorCode()?Ca.attr("title",a.get("roleDisabled","\u8be5\u7cfb\u7edf\u89d2\u8272\u5df2\u88ab\u7981\u7528")):100===wa.getErrorCode()&&Ca.attr("title",a.get("userIsCoop","\u8be5\u7528\u6237\u662f\u672c\u6a21\u578b\u96c6\u7684\u534f\u4f5c\u6210\u5458\uff0c\u62e5\u6709\u6a21\u578b\u96c6\u4e0b\u6240\u6709\u6a21\u578b\u7684\u5168\u90e8\u6570\u636e\u6743\u9650\uff0c\u672c\u6761\u6743\u9650\u8bbe\u7f6e\u65e0\u6548\u3002")),
Ca.appendTo(Ja));var Va=$("<div>");H.background(Va,"btn-delete");Va.addClass("sbu-left-panel-list-item-delete");!ca&&Va.appendTo(Ja);Va.attr("title",a.get("deleteRoles","\u79fb\u9664\u89d2\u8272"));G===xa.USER&&Va.attr("title",a.get("deleteUsers","\u79fb\u9664\u7528\u6237"));Va.on("mousedown",function(){var eb=new sb;eb.setText(a.get("confirmDeleteRole","\u786e\u5b9a\u8981\u79fb\u9664\u89d2\u8272\u201c#1\u201d\u5417\uff1f").replace("#1",Va.attr("userName")));G===xa.USER&&eb.setText(a.get("confirmDeleteUser",
"\u786e\u5b9a\u8981\u79fb\u9664\u7528\u6237\u201c#1\u201d\u5417\uff1f").replace("#1",Va.attr("userName")));eb.setConfirmedListener(function(qb){qb&&Za([Va.attr("userId")],!0)});eb.show(Va)});Va.attr("userId",wa.getUserId());Va.attr("userName",wa.getUserName());Va.hide();ha.on("mouseover",function(){wa.getUserId()!==ja&&(Va.show(),Wa.css("right","30px"))});ha.on("mouseout",function(){wa.getUserId()!==ja&&(Va.hide(),Wa.css("right","0px"))})},V=function(ha,wa,Ja){var Ca;$("<div>");$("<div>");$("<div>");
for(var Wa=0;Wa<wa.length;Wa++)if(Ca=ha.getItemUiByModel(wa[Wa])){var Va=Ca.find(".sbu-left-panel-list-item-delete");H.background(Va,"btn-delete");Va.hide();Ca=Ca.find(".sbu-left-panel-list-item-label");Ca.css("right","0px")}for(wa=0;wa<Ja.length;wa++)Ca=ha.getItemUiByModel(Ja[wa]),Va=Ca.find(".sbu-left-panel-list-item-delete"),H.background(Va,"btn-delete_white"),Va.show(),Ca=Ca.find(".sbu-left-panel-list-item-label"),Ca.css("right","30px")},fa=function(ha,wa){ha=ha.getSelecteds();ha[0].getUserId()!==
ja&&(f=ha[0],ja=ha[0].getUserId(),la(ja))},ea=function(ha,wa){X.createFacade(function(Ja){w[G]=[];if(!Ja||0===Ja.length)return ia(ha),!0;for(var Ca=0;Ca<Ja.length;Ca++){var Wa=new xa;Wa.fromJsonObject(Ja[Ca]);w[G].push(Wa)}ia(ha,wa)},function(Ja,Ca){return!1}).loadModelSetViewer(G,db)},ia=function(ha,wa){p=w[G].slice(0);z&&(z.removeClass("sbu-left-panel-user-label-selected"),z.addClass("sbu-left-panel-user-label"));z=ha;z.removeClass("sbu-left-panel-user-label");z.addClass("sbu-left-panel-user-label-selected");
G===xa.USER?(Z.hide(),u.text(a.get("addUsers","\u6dfb\u52a0\u7528\u6237")),D.css("top","40px"),b.setText(a.get("noUser","\u8bf7\u5148\u6dfb\u52a0\u7528\u6237"))):(G===xa.MODELSET_ROLE?(Z.show(),u.text(a.get("addRoles","\u6dfb\u52a0\u89d2\u8272")),D.css("top","74px")):(Z.hide(),u.text(a.get("addRoles","\u6dfb\u52a0\u89d2\u8272")),D.css("top","40px")),b.setText(a.get("noRole","\u8bf7\u5148\u6dfb\u52a0\u89d2\u8272")));F.refreshHeight();v.setItemModels(p);f=null;wa||(ja=null);v.setSelecteds([]);if(0<
p.length){g.hide();if(wa){for(ha=0;ha<p.length;ha++)if(p[ha].getUserId()==ja){f=p[ha];break}f?v.setSelecteds([f]):v.setSelecteds([p[0]])}else v.setSelecteds([p[0]]),ja=p[0].getUserId(),f=p[0];na.css("display","block");la(ja)}else Ea&&g.show(),!Ea&&g.hide(),na.css("display","none"),A&&A()};this.refreshHeight=function(){var ha=30*p.length+2,wa=D.css("top").indexOf("px");wa=D.css("top").slice(0,wa);var Ja=parseInt(wa)+ha,Ca=e.height()-parseInt(wa)-32;Ca<ha&&(ha=Ca,Ja=parseInt(wa)+ha);D.css("height",
ha+"px");u.css("top",Ja+"px")};var Za=function(ha,wa){X.createFacade(function(Ja){wa&&X.getMessageCurtain().showSuccess(a.get("deleteSucceeded","\u79fb\u9664\u6210\u529f\u3002"));Ja=[];for(var Ca=0;Ca<p.length;Ca++)-1==ha.indexOf(p[Ca].getUserId())&&Ja.push(p[Ca]);w[G]=Ja;ia(z)},function(Ja,Ca){return 20003102==Ja?(X.getMessageCurtain().showPrompt(a.get("modelNoFound","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u5220\u9664\u6570\u636e\u6743\u9650\u3002")),!0):20007003==Ja?(X.getMessageCurtain().showPrompt(a.get("modelSetNoFound",
"\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u5220\u9664\u6570\u636e\u6743\u9650\u3002")),!0):!1}).deleteDataAuthByModelSetId(db,ha,G)},$a=function(){if(G===xa.MODELSET_ROLE)return fb(),!0;var ha=U;ha.setCallBack(function(Ca){if(!Ca||!Ca.content)return!0;Ca=Ca.content;var Wa=Ca.selecteds;if("cancel"===Ca.operation||"undefined"===Wa)return!0;bb(Wa)});for(var wa=[],Ja=0;Ja<p.length;Ja++)wa.push(p[Ja].getUserId());G===xa.USER?ha.openUserForm(wa):G===xa.ROLE&&ha.openRoleForm(wa)},bb=
function(ha){for(var wa=[],Ja=Object.keys(ha),Ca=0;Ca<w[G].length;Ca++){var Wa=w[G][Ca].getUserId();wa.push(Wa)}Ca=[];for(Wa=0;Wa<Ja.length;Wa++)-1==wa.indexOf(Ja[Wa])&&Ca.push(Ja[Wa]);Ja=Ca.slice(0);if(0===Ja.length)return!0;X.createFacade(function(Va){X.getMessageCurtain().showSuccess(a.get("successfullyAdded","\u6dfb\u52a0\u6210\u529f\u3002"));for(Va=0;Va<Ja.length;Va++){var eb=new xa;eb.setUserId(Ja[Va]);eb.setUserName(ha[Ja[Va]]);w[G].push(eb)}Xa.occur(Xa.AUTH_USER_ROLE_TYPE,Xa.getAuthUserOrRoleType(G));
ia(z)},function(Va,eb){"20007006"==Va&&L.updateModelState(!1);return!0}).addUsers(db,Ja,G)},fb=function(){var ha=new Oa;ha.setFunAfterSelect(hb);for(var wa=[],Ja=0;Ja<p.length;Ja++)20007007!==p[Ja].getErrorCode()&&wa.push(p[Ja].getUserId());ha.setPreSelected(wa);ha.showDialog()},hb=function(ha){for(var wa=[],Ja=[],Ca=[],Wa=0;Wa<w[G].length;Wa++)Ca.push(w[G][Wa].getUserId());for(Wa=0;Wa<ha.length;Wa++){var Va=ha[Wa].getModelSetRoleId();Ja.push(Va);-1==Ca.indexOf(Va)&&wa.push(Va)}if(0===wa.length)return!0;
X.createFacade(function(eb){X.getMessageCurtain().showSuccess(a.get("successfullyAdded","\u6dfb\u52a0\u6210\u529f\u3002"));for(eb=0;eb<ha.length;eb++){var qb=ha[eb].getModelSetRoleId();if(-1!=wa.indexOf(qb)){var Nb=ha[eb].getModelSetRoleName(),Db=new xa;Db.initialize(qb,Nb);w[G].push(Db)}}Xa.occur(Xa.AUTH_USER_ROLE_TYPE,Xa.getAuthUserOrRoleType(G));ia(z)},function(eb,qb){"20007006"==eb&&L.updateModelState(!1);return!0}).addUsers(db,wa,G)},kb=function(){n.getDataAuthorityManager()(db,xb,ca)}}function M(){KTDefaultCellRender.call(this,
S);var F=this,e=this.paintCellUI,c={};c[Na.DATA_TABLE_MODEL]="data-table-model";c[Na.ENTITY_MODEL]="entity-model";c[Na.RELATION_MODEL]="relation-model";c[Na.METRICS_MODEL]="metrics-model";c[Na.METRIC]="metrics";this.paintCellUI=function(u,b){var g=F.getCurrentRowIdx(),p=F.getCurrentColIdx();if(g>=pa.getHeadRowCount()){var f=F.getCurrentRow().getUserObject(),w=$(u);if(0==p){u=$("<div>");J.layoutCtrlWithLRTB(u,0,0,null,0,0,null);u.appendTo(w);b=4+20*f.getLevel()-20+"px";u.css("left",b);b=0;-1!=sa.indexOf(f.getModelId())&&
(l(b,u,f.getModelId(),f.getModelName(),f.getModelType()),b=18);var k=$("<div>");J.layoutCtrlWithLRTB(k,b,null,16,13,null,16);p=f.getModelName();var A=!1;f instanceof gb&&(k.css("cursor","pointer"),H.backgroundWithHover(k,f.isSpreadState()?"icon-expanded":"icon-collapsed"),u.append(k),k.attr("iRowIdx",g),k.on("mousedown",z),A=!0);if(f.getModelType()===Na.METRICS_MODEL||f instanceof Na)f.getModelType()===Na.METRICS_MODEL&&(b+=20),ca&&(g=$("<div>"),g.addClass("data-auth-preset"),g.text(a.get("preset",
"\u9884\u7f6e")),J.layoutCtrlWithLRTB(g,b,null,24,13,null,11),u.append(g),b+=34),g=$("<div>"),A=(f.getModelType(),c[f.getModelType()]),H.background(g,"icon-"+A),u.append(g),A=!1,J.layoutCtrlWithLRTB(g,b,null,16,13,null,16);g=$.trim(Fa.getText());k=$("<div>");k.addClass("sbu-right-table-name");k.css("left",b+20+2+"px");g&&0<g.length?h(k,p,g,!1):k.text(p);b=$("<span>");b.css("padding-left","5px");b.css("color","#c0c0c0");g&&0<g.length&&!A?h(b,"( "+f.getModelNumber()+" )",g,!0):b.text("( "+f.getModelNumber()+
" )");!A&&b.appendTo(k);u.append(k)}else if(1==p)g=new ob,x[f.getModelId()]=g,g.setUserObject(f),g.setEnabled(!ca),g.addStateChangeListener(v),f=ja?f.isEnable():!1,g.setOn(f),f=g.getJqUi(),f.addClass("sbm-right-panel-enable-button"),ca&&f.css("cursor","not-allowed"),g=$("<div>"),g.addClass("sbm-right-panel-enable-button-container"),f.appendTo(g),w.append(g);else if(2==p&&(f instanceof Na||f.getModelType()===Na.METRICS_MODEL)){var q=$("<div>");H.backgroundWithHover(q,"btn-edit");q.addClass("sbm-right-panel-edit-icon");
q.on("click",function(){var V=parseInt(q.attr("rowIdx")),fa=S.getRow(V).getUserObject();V=fa.isInheritPermissions();V=G===xa.USER?V:!1;var ea=new Ya(V,fa,G,ja,ca);fa&&(V=fa.getModelId(),sa&&-1!==sa.indexOf(V)&&(L.checkModelExistMV(V,function(ia){ia&&ea.setErrorPrompt(a.get("onlyShowDataAuth","\u6a21\u578b\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002\u7531\u4e8e\u5f53\u524d\u6a21\u578b\u5df2\u5b58\u5728\u7269\u5316\u6570\u636e\uff0c\u4ee5\u4e0b\u4ec5\u5c55\u793a\u5bf9\u7269\u5316\u6570\u636e\u751f\u6548\u7684\u6570\u636e\u6743\u9650\u5185\u5bb9\u3002"))}),
ea.setFooterClosingOnly(!0)));ea.setFunAfterSettingAuth(function(ia,Za){fa.setEnable(!0);fa.setDataAuth(Za);S.updateUI();if(fa.getModelType()===Na.METRICS_MODEL)if(ia=Za.getModels()[0])if(ia=ia.getCellAuth())if(ia=ia.getNoAuthFields()){Za=[];for(var $a=0;$a<ia.length;$a++){var bb=ia[$a];bb=Eb.generateMetricModelId(fa.getModelId(),bb.getName());var fb=x[bb];fb&&fb.setOn(!1);(fb=fb.getUserObject())&&fb.setEnable(!1);Za.push(bb)}B(fa,Za)}else B(fa);else B(fa);else B(fa)});ea.showDialog()});var B=function(V,
fa){if(V.getModelType()==Na.METRICS_MODEL){V=V.getChildren();for(var ea=0;ea<V.length;ea++){var ia=V[ea];fa&&-1!=fa.indexOf(ia.getModelId())||((ia=x[ia.getModelId()])&&ia.setOn(!0),(ia=ia.getUserObject())&&ia.setEnable(!0))}}};q.attr("rowIdx",g);q.attr("title",a.get("editPermission","\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));q.appendTo(w);u=$("<div>");u.addClass("sbm-right-panel-edit-icon-container");q.appendTo(u);if(G===xa.USER&&f.getModelType()!==Na.METRIC){var T=$("<div>");T.addClass("sbm-right-panel-edit-icon");
T.css({cursor:"pointer","margin-left":"25px"});!ja||f.isInheritPermissions()?(H.background(T,"btn-inherit"),T.attr("title",a.get("permissionInherited","\u672c\u6761\u6743\u9650\u540c\u65f6\u53d7\u7528\u6237\u6743\u9650\u548c\u89d2\u8272\u6743\u9650\u7684\u5f71\u54cd\u3002\u70b9\u51fb\u56fe\u6807\u53ef\u8c03\u6574\u4e3a\u4ee5\u5355\u72ec\u8bbe\u7f6e\u7684\u7528\u6237\u6743\u9650\u4e3a\u51c6\u3002"))):f.isInheritPermissions()||(H.background(T,"btn-inherit_hover"),T.attr("title",a.get("noPermissionInherited",
"\u672c\u6761\u6743\u9650\u4ee5\u5355\u72ec\u8bbe\u7f6e\u7684\u7528\u6237\u6743\u9650\u4e3a\u51c6\uff0c\u4e0d\u53d7\u89d2\u8272\u6743\u9650\u7684\u5f71\u54cd\u3002\u70b9\u51fb\u56fe\u6807\u53ef\u6062\u590d\u4e3a\u540c\u65f6\u53d7\u7528\u6237\u6743\u9650\u548c\u89d2\u8272\u6743\u9650\u7684\u5f71\u54cd\u3002")));!ca&&T.on("click",function(){var V=parseInt(T.attr("rowIdx"));V=S.getRow(V).getUserObject();Z(V)});T.css("cursor",ca?"not-allowed":"pointer");T.attr("rowIdx",g);T.appendTo(u)}u.appendTo(w)}else 3==
p?((b=f.getQingModelerDataAuth())||(b=d[f.getDataAuthId()]),u=$("<div>"),J.layoutCtrlWithLRTB(u,0,0,null,0,0,null),u.appendTo(w),Ra(u,b,g,f.isEnable(),f.getModelType()===Na.METRIC),f.getDataAuthId()&&(p=f.getDataAuthId(),r[p]=u,Q[p]=f,t[p]=g),!b&&f.getDataAuthId()&&f.getModelType()!==gb.DIRECTORY_TYPE&&(u.empty(),f=$("<div>"),f.addClass("sa-common-loading-icon"),f.css("background-image",Y.getIconUrl("common","loading.gif")),J.layoutCtrlCenterAlign(f,23),J.layoutCtrlMiddleAlign(f,23),f.appendTo(u))):
e(u,b);w.css({"border-right":"1px solid rgb(240, 240, 240)"});w.css({"border-bottom":"1px solid rgb(240, 240, 240)"})}else e(u,b),$(u).css("color","#666")};var h=function(u,b,g,p){if(u&&b&&g){g=g.toUpperCase();for(var f=b.toUpperCase(),w=f.split(g),k=g.length,A=0;A<w.length;A++){var q=f.indexOf(w[A]),B=b.substr(0,w[A].length);q+=w[A].length;var T=f.length-q;f=f.substr(q,T);b=b.substr(q,T);q=$("<span>");q.text(B);p&&q.css("color","#c0c0c0");q.appendTo(u);A!==w.length-1&&1<w.length&&(q=f.indexOf(g),
B=b.substr(q,k),q+=k,T=f.length-q,f=f.substr(q,T),b=b.substr(q,T),q=$("<span>"),q.text(B),q.css("color","red"),q.clone().appendTo(u))}}},l=function(u,b,g,p,f){var w=$("<div>"),k=$("<span>");k.text(a.get("modelException","\u6a21\u578b\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));k.appendTo(w);k=$("<span id='"+g+"'>");$(document).on("click","#"+g,function(){n.getModelDesignerEntrance()(db,g,p,f)});k.text(" "+a.get("viewModel","\u67e5\u770b\u8be5\u6a21\u578b"));k.css({cursor:"pointer",
color:"rgb(14, 95, 216)"});k.appendTo(w);k=mb.createWarning();J.layoutCtrlWithLRTB(k,u,null,12,14,null,12);b.append(k);u=new wb;u.mounting(k);u.setSuggestedSize(265,40);u.setHtml(w)},z=function(u){var b=$(u.currentTarget).attr("iRowIdx"),g=qa[parseInt(b)-2],p=g.isSpreadState();g.setSpreadState(!p);u=g.getModelId();var f=g.getLevel();g=S.getRowsCount()-3;b=parseInt(b)-2;if(p)for(u=b;u<g&&!(parseInt(qa[u+1].getLevel())<=parseInt(f));u++)S.getRow(u+3).setHide(!0),qa[u+1].setSpreadState(!1);else for(p=
b;p<g;p++)f=qa[p+1],f instanceof gb&&f.getParentId()==u&&S.getRow(p+3).setHide(!1),f instanceof Na&&f.getParentId()==u&&S.getRow(p+3).setHide(!1);S.updateUI()},v=function(u,b,g){if(b){var p=u.getUserObject();b=p.getModelId();var f=p.getModelType();X.createFacade(function(w){u.getUserObject().setEnable(g);D(p,g);if(p instanceof gb&&p.getModelType()!==Na.METRICS_MODEL&&g){w=$(window).width();var k=$(window).height();w=w-425>>1;k=k-300>>1;var A=E.createFeedbackDialog();A.setBounds(425,300,w,k);A.setMsgImageType(E.MSG_WARNING);
A.setOptionType(E.OPTION_OK);A.setTitle(a.get("operatorTips","\u64cd\u4f5c\u63d0\u793a"));A.setMessage(a.get("authorized","\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6a21\u578b\u7684\u542f\u7528\u72b6\u6001\u5df2\u5f00\u542f\uff0c\u8be5\u76ee\u5f55\u4e0b\u672a\u6765\u65b0\u589e\u7684\u6a21\u578b\u7684\u542f\u7528\u72b6\u6001\u4e5f\u5c06\u81ea\u52a8\u5f00\u542f\u3002"));A.setButtonText(E.RETURN_OK,a.get("iKnow","\u6211\u77e5\u9053\u4e86"));A.showDialog()}if(p.getModelType()===
Na.METRIC&&(w=p.getParentId(),k=x[w])){k=k.getUserObject();var q=k.getDataAuthId();k=k.getQingModelerDataAuth();k||(k=d[q])||(k=new ib);A=r[q];q=t[q];var B=k.getModels();B||(B=[]);var T=B[0];T||(T=new tb);(B=T.getCellAuth())||(B=new rb);B.getNoAuthFields();var V=[],fa;for(fa in x)if(-1!=fa.indexOf("metric-"+w)){var ea=x[fa];if(ea&&!ea.isOn()){ea=ea.getUserObject();var ia=new Ta;ia.setAlias(ea.getModelName());V.push(ia)}}B.setNoAuthFields(V);T.setCellAuth(B);B=[];B.push(T);k.setModels(B);A&&q&&Ra(A,
k,q,g,!1)}S.updateUI()},function(w,k){return 20007014==w?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20007005==w?(X.getMessageCurtain().showPrompt(a.get("modelNoFound","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20007006==w?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),
!0):20003102==w?(X.getMessageCurtain().showPrompt(a.get("modelNoFound","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):!1}).authorizedDataAuth(b,ja,g,G,f,db)}},D=function(u,b){for(var g=0;g<O.length;g++)O[g].getModelType()!==Na.METRIC&&O[g].getParentId()==u.getModelId()&&(O[g].setEnable(b),D(O[g],b))},Z=function(u){var b=u.getModelId(),g=!u.isInheritPermissions();X.createFacade(function(p){u.setInheritPermissions(g);S.updateUI();Xa.occur(Xa.DATA_AUTH_SETTING_INHERIT_METHOD,
Xa.getAuthInheritMethod(g))},function(p,f){return 20007014==p?(X.getMessageCurtain().showPrompt(a.get("modelNoDeploy","\u6a21\u578b\u5df2\u53d6\u6d88\u90e8\u7f72\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):20003102==p?(X.getMessageCurtain().showPrompt(a.get("modelNoFound","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650\u3002")),!0):!1}).setInherit(b,ja,g,G)}}var L=this,ca=N,y,I,C,S,na,aa,ka,Fa,Ia,G,O=[],qa=[],ja,Ba,sa=[],Ea=!0,d={},
r={},t={},Q={},x={},ba={};ba[xa.USER]=a.get("sysUserSummary","\u5f53\u524d\u7cfb\u7edf\u7528\u6237\u7684\u6570\u636e\u6743\u9650\u6458\u8981");ba[xa.ROLE]=a.get("sysRoleSummary","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272\u7684\u6570\u636e\u6743\u9650\u6458\u8981");ba[xa.MODELSET_ROLE]=a.get("modelSetRoleSummary","\u5f53\u524d\u6a21\u578b\u96c6\u89d2\u8272\u7684\u6570\u636e\u6743\u9650\u6458\u8981");this.resize=function(){aa.refreshHeight();L.resizeTable()};this.updateErrorModels=function(F){sa=F};this.updateModelState=
function(F){Ea=F;aa&&aa.updateModelState(Ea);ka&&Ea&&ka.hide();ka&&!Ea&&ka.show()};this.getModelSetMainAreaJqUi=function(){y||(y=$("<div>"),y.addClass("sbu-container"),I=$("<div>"),I.addClass("sbu-left-panel"),aa=new K,aa.setSearchCallBack(ma),aa.getJqUi().appendTo(I),C=Ka(),I.appendTo(y),C.appendTo(y));return y};var Ka=function(){C=$("<div>");C.addClass("sbu-right-panel");var F=$("<div>");H.backgroundWithHover(F,"btn-refresh");F.css({cursor:"pointer","z-index":"999"});F.attr("title",a.get("refreshModels",
"\u5237\u65b0\u6a21\u578b"));J.layoutCtrlWithLRTB(F,null,250,16,13,null,16);F.on("click",function(){Fa.clear();aa.refreshModel()});F.appendTo(C);Fa=new cb;Fa.setSearchListenerDelay(1E3);Fa.setShowSearchIcon(!0);Fa.setPlaceholder(a.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));Fa.addSearchListener(ma);F=Fa.getJqUi();J.layoutCtrlWithLRTB(F,null,10,230,8,null,25);F.css({"z-index":"999"});F.appendTo(C);S=pa.createTable();na=$(S.getUI());S.setCellRender(new M);S.setSyncUIWhenModelChanged(!1);
S.setLargeDataMode(!0,!1);S.setColumnFitVisibleWidth(!0);S.setDraggableAdjusting(!0,3,0);S.setFrozenRows(3);na.appendTo(C);J.layoutCtrlWithLRTB(na,0,0,null,45,0,null);na.hide();Ia=new La;F=Ia.getNoDataTableJqUi();Ia.setTopPx(45);Ia.updateIcon("icon-search_none");Ia.setText(a.get("noMatchedResult","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));F.hide();F.appendTo(C);F=new La;ka=F.getNoDataTableJqUi();F.setText(a.get("noDeployedModel","\u6682\u65e0\u5df2\u90e8\u7f72\u7684\u6a21\u578b"));
ka.appendTo(C);Ea&&ka.hide();return C},la=function(F){X.createFacade(function(e){if(e){var c=new gb;c.fromJsonObject(e);O=[];Pa(c,O);e=[];for(c=0;c<O.length;c++)0<=O[c].getLevel()&&e.push(O[c]);qa=O=e;ma();e=[];for(c=0;c<O.length;c++)O[c]instanceof Na&&O[c].getDataAuthId()?e.push(O[c].getDataAuthId()):O[c].getModelType()===Na.METRICS_MODEL&&O[c].getDataAuthId()&&e.push(O[c].getDataAuthId());var h=[];for(c=1;c<=e.length;c++)h.push(e[c-1]),0===c%5&&(Ma(h),h=[]);0<h.length&&Ma(h)}},function(e,c){return 20007003==
e?(X.getMessageCurtain().showPrompt(a.get("modelSetNoFound","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u5148\u5237\u65b0\u754c\u9762\u3002")),!0):!1}).loadUsableModelDataAuth(db,G,F)},Ma=function(F){var e=X.createFacade(function(c){if(c)for(var h=0;h<F.length;h++){var l=F[h],z=new ib;c[l]&&z.fromJsonObject(c[l]);var v=r[l];d[l]=z;if(v){var D=Q[l];D.setDataAuth(z);var Z=t[l];if(D.getModelType()===Na.METRICS_MODEL){z||(z=d[l])||(z=new ib);var u=z.getModels();u||(u=[]);(l=u[0])||(l=new tb);
(u=l.getCellAuth())||(u=new rb);u.getNoAuthFields();var b=[],g;for(g in x)if(-1!=g.indexOf("metric-"+D.getModelId())){var p=x[g];if(p&&!p.isOn()){p=p.getUserObject();var f=new Ta;f.setAlias(p.getModelName());b.push(f)}}u.setNoAuthFields(b);l.setCellAuth(u);u=[];u.push(l);z.setModels(u)}Ra(v,z,Z,D.isEnable(),D.getModelType()===Na.METRIC)}}},function(c,h){return!0});e.setShowBlocking(!1);e.queryDataAuthContents(F)},Pa=function(F,e){e.push(F);F=F.getChildren();for(var c=0;c<F.length;c++)F[c]instanceof
Na||Pa(F[c],e);for(c=0;c<F.length;c++)F[c]instanceof gb||e.push(F[c])},ma=function(){Ea?ka&&ka.hide():ka&&ka.show();if(aa.isCurrentTabModelEmpty())ya([]);else{var F=$.trim(Fa.getText());F&&0<F.length&&0<O.length?(qa=ra(F),ya(qa)):(qa=O,ya(O))}},ra=function(F){var e=function(g,p){for(var f=0;f<O.length;f++)O[f]instanceof gb&&O[f].getModelId()===g&&(-1===p.indexOf(g)&&p.push(g),O[f].getParentId()&&e(O[f].getParentId(),p))},c=function(g){if(!(g instanceof Na)&&g.getModelType()!=Na.METRICS_MODEL)return!1;
var p=g.getModelName().toLowerCase();v=O[D].getModelNumber()?"( "+g.getModelNumber()+" )":g.getModelNumber();return-1!==p.indexOf(F)||v&&-1!==v.toLowerCase().indexOf(F)?!0:!1},h=function(g,p){for(var f=0;f<p.length;f++)if(-1<g.indexOf(p[f]))return!0;return!1};F=$.trim(F).toLowerCase();if(0===F.length)return[];for(var l=[],z=[],v,D=0;D<O.length;D++)c(O[D])&&(O[D]instanceof Na?(l.push(O[D]),e(O[D].getParentId(),z)):e(O[D].getModelId(),z));c=[];for(var Z=0;Z<O.length;Z++){var u=O[Z]instanceof gb&&-1<
z.indexOf(O[Z].getModelId()),b=O[Z]instanceof Na&&-1<l.indexOf(O[Z]);if(u||b)O[Z].setSpreadState(!0),c.push(O[Z])}for(l=0;l<c.length;l++)c[l]instanceof Na||(z=c[l].getChildren(),z=h(c,z),c[l].setSpreadState(z));return c},ya=function(F){if(0<$.trim(Fa.getText()).length&&0===F.length)na.hide(),ka&&ka.hide(),Ia.show();else{aa.isCurrentTabModelEmpty()?na.hide():na.show();Ia.hide();pa.clear(S);S.addColumns(4);var e=pa.createHeadRow(S);e.getCell(0).setValue(a.get("modelNameAndNumber","\u6a21\u578b\u540d\u79f0(\u7f16\u7801)"));
e.getCell(1).setValue(a.get("enable","\u542f\u7528\u72b6\u6001"));e.getCell(2).setValue(a.get("settings","\u6570\u636e\u6743\u9650\u8bbe\u7f6e"));e.getCell(3).setValue(ba[G]);e.setHeight(26);S.getColumn(0).setWidth(360);S.getColumn(1).setWidth(237);S.getColumn(2).setWidth(237);S.getColumn(3).setWidth(683);for(e=0;e<F.length;e++){var c=F[e];if(0<c.getLevel()){var h=S.addRow();h.setHeight(40);h.setUserObject(c)}}S.updateUI();Ba||(Ba=new P,Ba.setCallbackImmediately(function(){L.resizeTable()}),Ba.observe())}};
this.resizeTable=function(){!pb&&S.updateUI()};this.checkModelExistMV=function(F,e){X.createFacade(function(c){e(c)},function(c,h){return!1}).checkModelExistMV(F)};var Ra=function(F,e,c,h,l){F.empty();l=e?e.toString(l):"";var z=l.split("\n"),v=$("<div>");v.text(z[0]);J.layoutCtrlWithLRTB(v,15,80,null,2,null,16);v.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});v.appendTo(F);var D=$("<div>");D.text(z[1]);J.layoutCtrlWithLRTB(D,15,80,null,22,null,16);D.css({overflow:"hidden",
"white-space":"nowrap","text-overflow":"ellipsis"});D.appendTo(F);!z[1]&&v.css({top:"50%",transform:"translateY(-50%)"});h||(v.css("opacity","0.5"),D.css("opacity","0.5"));var Z;e&&(Z=e.getModels());var u;Z&&Z[0]&&(u=Z[0].getRowAuth());u&&u.isInvalid()&&(e=u.getErrorLine(),v.empty(),h=$("<div>"),h.text(a.get("rowAuth","\u884c\u7ea7\u6743\u9650\uff1a")),h.css({position:"relative",display:"inline-block","margin-right":"5px"}),h.appendTo(v),h=mb.createWarning(),h.css({position:"relative",display:"inline-block",
"margin-right":"5px"}),h.appendTo(v),h=$("<div>"),h.text(a.get("notExistFilter","\u8fc7\u6ee4\u6761\u4ef6\u7b2c#1\u884c\u5b57\u6bb5\u4e0d\u5b58\u5728").replace("#1",e)),h.css({position:"relative",display:"inline-block",color:"orange"}),h.appendTo(v));var b=$("<div>");b.css("cursor","pointer");H.backgroundWithHover(b,"btn-delete");J.layoutCtrlWithLRTB(b,null,34,16,14,null,16);b.on("click",function(){var g=new sb;g.setText(a.get("deleteDataPermission","\u6e05\u7a7a\u884c\u7ea7\u548c\u5217\u7ea7\u6570\u636e\u6743\u9650\u8bbe\u7f6e\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u6e05\u7a7a\u5417\uff1f"));
g.setConfirmedListener(function(p){var f=parseInt(b.attr("rowIdx"));f=S.getRow(f).getUserObject();p&&ua(f)});g.show(b)});b.attr("rowIdx",c);b.attr("title",a.get("deleteAllPermissions","\u6e05\u7a7a\u884c\u7ea7\u548c\u5217\u7ea7\u6570\u636e\u6743\u9650\u8bbe\u7f6e"));!ca&&b.appendTo(F);""===l?b.css("display","none"):b.css("display","block");F.attr("title",l)},ua=function(F){var e=F.getModelId();X.createFacade(function(c){F.setDataAuth(new ib);X.getMessageCurtain().showSuccess(a.get("successToDeletePermission",
"\u5220\u9664\u6210\u529f\u3002"));for(c=0;c<O.length;c++)O[c].getModelType()===Na.METRIC&&O[c].getParentId()===F.getModelId()&&O[c].setEnable(!1);S.updateUI()},function(c,h){return 20007004==c?(X.getMessageCurtain().showPrompt(a.get("deleteFail","\u8be5\u6761\u6570\u636e\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}).deletePermission(e,ja,G)}}function Qa(){var N=this,K=[400,300],M,L;this.setConfirmMsg=function(y){M=y};this.setConfirmListener=function(y){L=y};this.createDialog=
function(){var y=$("<div>"),I=$(document.body);y.addClass("sa-ctrl-common-modallayer");y.appendTo(I);var C=$(window).width(),S=$(window).height(),na=K[0],aa=K[1];C=C-na>>1;S=S-aa>>1;var ka=new Fb(y);ka.setTitle(a.get("operationConfirmation","\u64cd\u4f5c\u786e\u8ba4"));ka.setBounds(C,S,na,aa);ka.setToolbarVisible(!1);ka.setContent(N.createJqPanel());ka.addClosingListener(function(Fa,Ia){Ia&&L&&L();Fa.destroy();y.remove()});ka.showFooterPane();ca(y);y.appendTo(I);return ka};this.createJqPanel=function(){var y=
$("<div>"),I=$("<div>");J.layoutCtrl(I,140,20,98,80);Gb.background(I,"msg-delete");I.appendTo(y);I=$("<div>");I.addClass("data-auth-delete-dialog");I.text(M);I.attr("title",M);I.appendTo(y);return y};var ca=function(y){(y=y.children(".sa-ctrl-dialog"))&&0<y.length&&(y=y.children(".sa-ctrl-dialog-title"))&&0<y.length&&y.css("border-bottom","0px")}}function La(){var N,K,M,L,ca,y,I;this.getNoDataTableJqUi=function(){if(!N){N=$("<div>");J.layoutCtrlWithLRTB(N,0,0,null,0,0,null);N.css("min-height","125px");
K=$("<div>");K.addClass("sbm-left-not-data-container");K.appendTo(N);I=$("<div>");I.addClass("sbm-left-not-data-icon");H.background(I,"icon-empty");I.appendTo(K);var C=$("<div>");C.addClass("sbm-left-not-data-text");C.appendTo(K);L=$("<span>");L.text(M);L.appendTo(C);y=$("<span>");y.css({color:"rgb(14, 95, 216)",cursor:"pointer"});y.text(ca);y.appendTo(C);y.hide()}return N};this.setTopPx=function(C){N.css("top",C+"px")};this.setText=function(C){M=C;L.text(M)};this.setLinkText=function(C,S){ca=C;y.text(C);
y.on("click",S);y.show()};this.getText=function(){return M};this.updateIcon=function(C,S,na){H.background(I,C);S&&na&&(I.css({width:S+"px",height:na+"px"}),K.css("height",na+20+"px"),N.css("min-height",na+20+"px"))};this.hide=function(){N&&N.hide()};this.show=function(){N&&N.show()}}function Oa(){ub.call(this);var N=this,K=this.protectedMethod,M,L,ca,y,I,C=[],S=[],na,aa=[],ka,Fa,Ia=!1,G,O,qa=[],ja;(function(){K.setTitle(a.get("selectDataRole","\u9009\u62e9\u6a21\u578b\u96c6\u89d2\u8272"));N.setSize(640,
480);K.getDialogCtrl().setMinSize(640,480);K.setContentPaneCreator(function(){M=$("<div>");sa();return M});K.setClosingChecker(function(){if(0===C.length)K.destroy();else if(0!==aa.length)ka&&ka(aa),K.destroy();else{var x=new da,ba=a.get("selectOne","\u8bf7\u9009\u62e9\u4e00\u884c\u6570\u636e\u3002");x.getJqUi().appendTo(M);x.showPrompt(ba)}});K.setClosingAction(function(){K.destroy()})})();this.setFunAfterSelect=function(x){ka=x};this.setPreSelected=function(x){qa=x};var Ba=function(){var x=new cb;
x.setSearchListenerDelay(1E3);x.setShowSearchIcon(!0);x.setPlaceholder(a.get("searchRoleName","\u641c\u7d22\u89d2\u8272\u540d\u79f0"));var ba=x.getJqUi();J.layoutCtrlWithLRTB(ba,10,null,230,5,null,25);ba.find(".sa-ctrl-searchbox-close").on("click",function(Ma){Fa=x.getText();Ea(Fa,Ia)});var Ka=ba.find(":input");this.searchModelSetRole=function(){Fa=x.getText();Ea(Fa,Ia)};Ka.attr("oninput","searchModelSetRole();");ba.appendTo(M);ba=$("<div>");J.layoutCtrlWithLRTB(ba,300,null,180,5,null,25);Ka=new R;
var la=Ka.getJqUi();Ka.setChecked(Ia);Ka.addCheckedListener(function(Ma,Pa){Pa&&(Ia=Ma.isChecked(),Ea(Fa,Ia))});Ka.setText(a.get("showSelected","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));J.layoutCtrlWithLRTB(la,0,0,null,2,null,23);la.css("line-height","23px");la.appendTo(ba);ba.appendTo(M);L=r();J.layoutCtrlWithLRTB(L,10,10,null,45,10,null);L.appendTo(M)},sa=function(){var x=X.createFacade(function(ba){Ba();C=[];if(ba)for(var Ka=0;Ka<ba.length;Ka++){var la=new Hb;la.fromJsonObject(ba[Ka]);C.push(la);
-1!=qa.indexOf(la.getModelSetRoleId())&&aa.push(la)}y.setItemModels(C);0==C.length&&(ja=$("<div>"),ja.css({position:"absolute",width:"180px",height:"120px",top:"50%","margin-top":"-60px",left:"50%","margin-left":"-90px"}),ba=$("<div>"),ba.css({width:"170px",height:"98px",position:"absolute",left:"50%","margin-left":" -85px"}),H.background(ba,"icon-empty"),ba.appendTo(ja),ba=$("<div>"),ba.css({position:"absolute",bottom:"0px",width:"150px","text-align":"center",left:"50%","margin-left":"-75px",color:"rgb(153, 153, 153)",
"font-size":"14px"}),ba.text(a.get("noModelSetRole","\u6682\u65e0\u53ef\u9009\u7684\u6a21\u578b\u96c6\u89d2\u8272")),ba.appendTo(ja),ja.appendTo(L));t()},function(ba,Ka){return!1});x.setBlockingJqUi(M);x.getModelSetRoles(db)},Ea=function(x,ba){if(0!=C.length||x){var Ka=[];x&&(x=x.trim().toLowerCase());for(var la=0;la<C.length;la++){var Ma=C[la].getModelSetRoleName().toLowerCase();if(!x||-1!==Ma.indexOf(x)){if(ba){Ma=!1;for(var Pa=0;Pa<aa.length;Pa++)if(aa[Pa]==C[la]){Ma=!0;break}}else Ma=!0;Ma&&Ka.push(C[la])}}if(0===
Ka.length)return I.hide(),G.updateIcon("icon-search_none"),G.setText(a.get("noMatchedResult","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),ja&&ja.hide(),O.show(),!1;O.hide();I.show();S=[];y.setItemModels(Ka);x=!0;for(ba=0;ba<S.length;ba++)if(!S[ba].isChecked()){x=!1;break}na.setChecked(x)}else O.hide(),ja&&ja.show()},d=function(x){var ba=x.isChecked();x=x.getUserObject();for(var Ka=!1,la=-1,Ma=0;Ma<aa.length;Ma++)if(aa[Ma]==x){Ka=!0;la=Ma;break}Ka&&!ba&&aa.splice(la,1);!Ka&&
ba&&aa.push(x)},r=function(){L=$("<div>");na=new R;var x=na.getJqUi();na.setChecked(!1);na.addCheckedListener(function(ba,Ka){if(Ka){ba=ba.isChecked();for(Ka=0;Ka<S.length;Ka++)S[Ka].setChecked(ba),d(S[Ka]);ca.setText(a.get("selectedRoles","\uff08\u5df2\u9009\u62e9#1\u9879\uff09").replace("#1",aa.length))}});na.setText(a.get("selectAll","\u5168\u9009"));J.layoutCtrlWithLRTB(x,0,null,80,0,null,23);x.css("line-height","23px");x.appendTo(L);ca=new jb(a.get("selectedRoles","\uff08\u5df2\u9009\u62e9#1\u9879\uff09").replace("#1",
qa.length));x=ca.getJqUi();J.layoutCtrlWithLRTB(x,100,null,120,0,null,23);x.appendTo(L);y=new yb;y.setBorderVisible(!1);y.setEnabled(!1);y.setCustomItemPainter(Q);I=y.getJqUi();J.layoutCtrlWithLRTB(I,0,0,null,28,0,null);I.appendTo(L);G=new La;O=G.getNoDataTableJqUi();J.layoutCtrlWithLRTB(O,0,0,null,28,0,null);O.appendTo(L);O.hide();return L},t=function(){for(var x=!0,ba=0;ba<S.length;ba++)if(!S[ba].isChecked()){x=!1;break}na.setChecked(x)},Q=function(x,ba){var Ka=$("<div>");J.layoutCtrlWithLRTB(Ka,
0,0,null,0,0,null);Ka.appendTo(x);x.css({"font-size":"12px",height:"25px",color:"#666666"});x=new R;var la=x.getJqUi();x.setChecked(!1);for(var Ma=0;Ma<aa.length;Ma++)if(aa[Ma]==ba){x.setChecked(!0);break}x.addCheckedListener(function(Pa,ma){ma&&(ma=Pa.isChecked(),!ma&&na.setChecked(ma),d(Pa),ca.setText(a.get("selectedRoles","\uff08\u5df2\u9009\u62e9#1\u9879\uff09").replace("#1",aa.length)),ma&&t())});x.setUserObject(ba);S.push(x);J.layoutCtrlWithLRTB(la,0,null,16,2,null,23);la.css("line-height",
"23px");la.appendTo(Ka);x=$("<div>");H.background(x,"btn-cooperation");J.layoutCtrlWithLRTB(x,25,null,16,6,null,16);x.appendTo(Ka);x=$("<div>");J.layoutCtrlWithLRTB(x,50,0,null,2,null,23);x.css("line-height","23px");x.attr("title",ba.getModelSetRoleName());x.text(ba.getModelSetRoleName());x.appendTo(Ka)}}function Ya(N,K,M,L,ca){ub.call(this);var y=this,I=this.protectedMethod,C,S,na,aa,ka=N,Fa=0,Ia,G=!1;this.setFunAfterSettingAuth=function(Ba){Ia=Ba};this.setFooterClosingOnly=function(Ba){I.setFooterClosingOnly(Ba)};
this.setErrorPrompt=function(Ba){Ba&&I.getMessageCurtain().showError(Ba)};(function(){I.setTitle(a.get("editPermissionTitle","\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));y.setSize(880,570);I.getDialogCtrl().setMinSize(880,570);I.setContentPaneCreator(function(){C=$("<div>");if(ka){var Ba=$("<div>");J.layoutCtrlWithLRTB(Ba,0,0,null,0,null,20);Ba.appendTo(C);var sa=$("<div>");sa.text(a.get("inheritRoleAuth","\u663e\u793a\u5168\u90e8\u751f\u6548\u7684\u6743\u9650"));sa.addClass("auth-setting-switch-button-text");
sa.appendTo(Ba);sa=$("<div>");var Ea=$("<span>");Ea.text(a.get("viewAllAuth","\u9ed8\u8ba4\u663e\u793a\u8be5\u7528\u6237\u5355\u72ec\u8bbe\u7f6e\u7684\u6570\u636e\u6743\u9650\uff0c\u5f00\u542f\u540e\u53ef\u67e5\u770b\u8be5\u7528\u6237\u5168\u90e8\u751f\u6548\u7684\u6743\u9650\uff0c\u5305\u62ec\u7528\u6237\u62e5\u6709\u7684\u7cfb\u7edf\u89d2\u8272\u3001\u6a21\u578b\u96c6\u89d2\u8272\u7684\u6570\u636e\u6743\u9650\u3002"));Ea.appendTo(sa);Ea=new zb;Ea.setIconType(zb.ICON_TYPE_QUESTION);Ea.setTipsHtml(sa);
Ea.setTipsSize(300,70);sa=Ea.getJqUi();sa.addClass("auth-setting-switch-button-tips");sa.appendTo(Ba);sa=new ob;sa.setOn(!1);sa.addStateChangeListener(O);sa=sa.getJqUi();sa.addClass("auth-setting-switch-button");sa.appendTo(Ba);Fa+=32;Ba.show()}aa=new m(ka,K,M,L);aa.setTitle(a.get("rowLevelPermission","\u884c\u7ea7\u6743\u9650"));aa.setFunRoleAuth(qa);na=new Da(ka,K,M,L);na.setTitle(a.get("colLevelPermission","\u5217\u7ea7\u6743\u9650"));na.setFunRoleAuth(qa);S=new ab;S.setTabLevel(ab.SECOND_LEVEL);
S.addTab(aa,!0);K.getModelType()!==Na.METRIC?(S.addTab(na),Ba=S.getJqUi()):Ba=aa.getJqUi();Ba.appendTo(C);J.layoutCtrlWithLRTB(Ba,0,0,null,Fa,0,null);return C});I.setClosingChecker(function(){if(ca)I.destroy();else if(aa.isCompliant())if(na.checkLegality()&&aa.checkLegality()){var Ba=new ib,sa=[];Ba.setModels(sa);var Ea=new tb;Ea.setModelId(K.getModelId());sa.push(Ea);sa=new Ib;var d=aa.getFilterItem();sa.setFilterItems(d);Ea.setRowAuth(sa);na.isInitialized()?(d=new rb,sa=na.getRelation(),d.setRelation(sa),
d.setNoAuthFields(na.getNoAuth()),Ea.setCellAuth(d)):(sa=aa.getDataAuth())?Ea.setCellAuth(sa.getCellAuth()):(d=new rb,d.setRelation("intersection"),d.setNoAuthFields([]),Ea.setCellAuth(d));ja(Ba);I.destroy()}else Ba=new da,Ea=a.get("verificationFailed","\u884c\u7ea7\u6743\u9650\u8bbe\u7f6e\u4e0d\u5b8c\u6574"),Ba.getJqUi().appendTo(C),Ba.showPrompt(Ea);else I.destroy()});I.setClosingAction(function(){I.destroy()});I.setFooterClosingOnly(ca)})();var O=function(Ba,sa,Ea){Ea&&!G?(Ba.setOn(!1),I.getMessageCurtain().showPrompt(a.get("noRoleAuth",
"\u8be5\u7528\u6237\u4e0d\u5c5e\u4e8e\u4efb\u4f55\u89d2\u8272\u6216\u6240\u5c5e\u89d2\u8272\u5747\u672a\u8bbe\u7f6e\u6743\u9650\u3002"))):sa&&(ka=Ea,aa.setInherit(ka),na.setInherit(ka),S.getCurrentTabPane().doChangeInherit())},qa=function(Ba){G=Ba},ja=function(Ba){X.createFacade(function(sa){Ia&&Ia(ka,Ba)},function(sa,Ea){return 20003102==sa?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundOperFail","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}).setDataAuthContent(L,
M,ka,K.getModelId(),Ba)}}function m(N,K,M,L){var ca,y,I,C,S=N,na=!1,aa=!0,ka,Fa,Ia,G,O=[],qa=[],ja=[];this.setRoleExistListener=function(r){ka=r};this.setFunRoleAuth=function(r){Fa=r};this.setInherit=function(r){S=r;na=!0};this.doChangeInherit=function(){y.setRoleFilter(qa);y.changeInherit(S);na=!1};this.isCompliant=function(){return aa};this.getDataAuth=function(){return Ia};this.getFilterItem=function(){return y.getFilterItem()};this.checkLegality=function(){return null==y.checkModelValid()};this.getJqUi=
function(){if(!ca){ca=$("<div>");var r=$("<div>");J.layoutCtrlWithLRTB(r,0,0,null,0,0,null);r.appendTo(ca);y=new Ha;I=y.getJqUi();J.layoutCtrlWithLRTB(I,0,0,null,0,0,null);I.appendTo(r);var t=new La;C=t.getNoDataTableJqUi();t.setText(a.get("modelException","\u6a21\u578b\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));t.setLinkText(" "+a.get("viewModel","\u67e5\u770b\u8be5\u6a21\u578b"),d);C.appendTo(r);C.hide();Ba()}return ca};var Ba=function(r){var t=K.getModelId();r&&console.log("enter...");
X.createFacade(function(Q){ja=[];if(Q)for(var x=0;x<Q.length;x++){var ba=new Ta;ba.fromJsonObject(Q[x]);ja.push(ba)}y.setField(ja);sa(t)},function(Q,x){aa=!1;I.hide();C.show();return!0}).getFields(t)},sa=function(r){X.createFacade(function(t){O=[];qa=[];if(t&&t.dataAuthContents){var Q=new ib;Q.fromJsonObject(t);(Ia=Q.getModels()[0])&&Ia.isRoleExist()&&Fa&&Fa(Ia.isRoleExist());t=Ia.getRowAuth();Q=Ia.getRoleRowAuth();if(t){var x=t.getFilterItems();for(t=0;t<x.length;t++){t===x.length-1&&x[t].setLogicOp(null);
var ba=x[t],Ka=Ea(ba);ba.setProperty(Ka);O.push(ba)}}if(Q)for(Q=Q.getFilterItems(),t=0;t<Q.length;t++)0===t&&(x=Q[t].getLeftBracketCount(),Q[t].setLeftBracketCount(x+1)),t===Q.length-1&&(x=Q[t].getRightBracketCount(),Q[t].setRightBracketCount(x+1),Q[t].setLogicOp(null)),Q[t].setRoleFilter(!0),x=Q[t],ba=Ea(x),x.setProperty(ba),qa.push(Q[t]);S&&ka&&ka()}y.setFilterItem(O.slice(0))},function(t,Q){return 20003102==t?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundRefresh","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u5148\u5237\u65b0\u754c\u9762\u3002")),
!0):!1}).queryDataAuthContent(S,r,M,L)},Ea=function(r){r=r.getProperty();for(var t=r.getFullName(),Q=0;Q<ja.length;Q++){var x=ja[Q].getFullName();if(t==x){r=ja[Q].clone();break}}return r},d=function(){n.getModelDesignerEntrance()(db,K.getModelId(),K.getModelName(),K.getModelType())};this.setTitle=function(r){G=r};this.getTitle=function(){return G};this.into=function(){na&&(y.setRoleFilter(qa),y.changeInherit(S),na=!1);Xa.occur(Xa.DATA_AUTH_SETTING_SHOW_METHOD,Xa.ROW_AUTH)}}function Ha(){function N(d){function r(){var e=
[],c,h,l,z,v,D,Z=!1,u=!0;this.setItemModel=function(b){e=b};this.setShowFieldNameEnable=function(b){u=b};this.setRawTypeSwitchListener=function(b){};this.setSearchListener=function(b){c=b};this.setListItemPainter=function(b){h=b};this.setShowFieldNameListener=function(b){l=b};this.createJqPopup=function(b,g,p){z=$("<div>");z.appendTo(b);v=$("<div>");z.addClass("modeler-auth-field-popup");b=a.get("search","\u641c\u7d22");var f=new cb;f.setSearchListenerDelay(200);f.setPlaceholder(b);f.addSearchListener(function(){c(e,
f.getText(),v,g,h,Z,D)});b=f.getJqUi();b.addClass("modeler-auth-field-popup-search");b.appendTo(z);v.addClass("modeler-auth-field-popup-list-owner");v.on("click",function(A){var q=$(A.currentTarget);A=$(A.target);if(A=J.upwardSearchHasClass(A,q,"modeler-auth-field-popup-list-item"))A.addClass("modeler-auth-list-item_selected_enabled"),q=A.data("model"),p(q)});v.appendTo(z);b=z.find(".sa-ctrl-textfield-input");b.css("top","0px");b.css("height","100%");if(ca&&0!==ca.length)for(D&&D.hide(),b=0;b<e.length;b++)h&&
h(e[b],v,g,!1);else b=new jb,b.setText(a.get("noSelectField","\u6682\u65e0\u53ef\u9009\u5b57\u6bb5")),b.setEnabled(!1),b.setAlign(jb.ALIGN_CENTER),D=b.getJqUi(),D.addClass("modeler-auth-field-popup-search-result"),D.appendTo(v);if(u){b=new jb;var w=a.get("showFieldName","\u663e\u793a\u539f\u5b57\u6bb5\u540d\u79f0");b.setText(w);b=b.getJqUi();b.attr("title",w);J.layoutCtrlWithLRTB(b,2,null,84,2,10,23);w=new ob;w.addStateChangeListener(function(A,q,B){(Z=B)?l&&l(v,!0):l&&l(v,!1)});w.setOn(!1);w=w.getJqUi();
J.layoutCtrlWithLRTB(w,88,null,35,2,10,23);var k=$("<div>");k.addClass("modeler-auth-field-popup-show-field-name");w.appendTo(k);b.appendTo(k);k.appendTo(z)}else v.css("bottom","5px")}}function t(){ub.call(this);var e=this,c=this.protectedMethod,h=new jb,l=new jb,z=new Jb,v,D;this.setCaption=function(b,g){c.setTitle(b);h.setText(g)};this.setText=function(b,g){z.setText(b);var p=0;b&&(b=b.split("\n").length,p=1E3<b?1E3:b);l.setText(p+"/1000\u9879");D=function(f){var w=f?$.trim(z.getText()):null;g(f,
w)};c.setClosingAction(D)};this.showDialogLeftAnchorTo=function(b){b&&(e.setSize(450,405),b=J.upwardCoordinate(document.body,[0,0],document.body),e.setPosition(Math.max(0,b[0]-10),Math.max(6,b[1]-405+40)));z.addEditedListener(u);c.setContentPaneCreator(Z);e.showDialog();z.requestFocus()};this.setClosingChecker=function(b){b&&(v=function(){var g=b($.trim(z.getText()));g&&c.getMessageCurtain().showPrompt(g);return g?!1:!0},c.setClosingChecker(v))};var Z=function(){l.setAlign(jb.ALIGN_RIGHT);J.layoutCtrlWithLRTB(h.getJqUi(),
0,0,null,0,null,23);J.layoutCtrlWithLRTB(z.getJqUi(),0,0,null,30,null,260);J.layoutCtrlWithLRTB(l.getJqUi(),290,0,null,287,null,23);var b=$("<div>");b.append(h.getJqUi());b.append(z.getJqUi());b.append(l.getJqUi());return b},u=function(b){var g=b.getText(),p=[];g&&(p=g.trim().replace(/(\n\s*)+/g,"\n").split("\n"));g=p.length;1E3<g&&(b.setText(p.slice(0,1E3).join("\n")),g=1E3);l.setText(g+"/1000\u9879");c.getMessageCurtain().hide()}}function Q(){var e=[],c,h,l=[],z=[],v;this.setItemModel=function(b,
g){v=g;e=b};this.setListItemPainter=function(b){};this.setSelectedItemModel=function(b){l=b;z=l.slice(0)};this.setLastTimeSelectedModel=function(b){z=b};this.getSelectedItemModel=function(){return l};this.createJqPopup=function(b,g,p,f){c=$("<div>");c.appendTo(b);h=$("<div>");c.addClass("modeler-auth-field-popup");h.addClass("modeler-auth-enum-popup-list-owner");for(b=0;b<e.length;b++)Z(e[b],h,g,!1);g=new Ab;g.setHighlight(!0);g.setText(a.get("ok","\u786e\u5b9a"));g=g.getJqUi();g.css("z-index",3);
g.css("margin-left",10);J.layoutCtrlWithLRTB(g,"50%",null,50,null,8,28);g.on("click",function(w){z=l.slice(0);p(l)});b=new Ab(a.get("cancel","\u53d6\u6d88"));b.setHighlight(!1);b=b.getJqUi();b.css("z-index",3);b.css("margin-left",-80);J.layoutCtrlWithLRTB(b,"50%",null,50,null,8,28);b.on("click",function(w){l=z.slice(0);f()});h.appendTo(c);g.appendTo(c);b.appendTo(c);h.css("height","77%");return[-1,260]};var D=function(b,g){g=b.getUserObject();b=b.isChecked();g&&b?(b=u(g),0>b&&l.push(g)):g&&!b&&(b=
u(g),-1<b&&l.splice(b,1))},Z=function(b,g,p){var f=u(b);p=$("<div>");p.addClass("modeler-auth-field-popup-list-item");p.data("model",b);var w=$("<div>"),k=new R;k.setUserObject(b);k.setChecked(-1<f);k.addCheckedListener(D);f=k.getJqUi();f.addClass("modeler-auth-field-selection-checkbox-icon");f.data("model",k);k=$("<div>");k.text(b.fieldValue);k.addClass("modeler-auth-field-selection-checkbox-text");w.append(f);w.append(k);p.append(w);g.append(p)},u=function(b){for(var g=0;g<l.length;g++)if(v(b,l[g]))return g;
return-1}}KTDefaultCellRender.call(this,d);var x=this,ba=this.paintCellUI;this.paintCellUI=function(e,c){if(x.getCurrentRowIdx()<pa.getHeadRowCount()||!x.getCell())ba(e,c);else{var h=x.getCellWidth(),l=x.getCellHeight(),z=x.getCurrentRow();if(1==x.getCurrentColIdx()||5==x.getCurrentColIdx()){c=1==x.getCurrentColIdx();var v=x.getCell().getValue();ua(e,h,l,c,v,z)}else if(2==x.getCurrentColIdx()){var D=x.getCell().getValue();Ka(e,h,l,D,z)}else 3==x.getCurrentColIdx()?(c=x.getCell().getValue(),v=(D=z.getUserObject().getProperty())?
D.getOutputDataType():"",D=D?D.isEnum():!1,h=pa.createCtrlInCell(e,h,l,oa),h.setSelected(c),h.setItemModels(v?ta.getSelectableCompares(v,D):[]),h.setUserObject(z),h.setCustomPainter(ra),h.addSelectedChangedListener(G)):4==x.getCurrentColIdx()?(c=x.getCell().getValue(),Ra(e,h,l,c,z)):6==x.getCurrentColIdx()?(c=x.getCell().getValue(),F(e,h,l,c,z)):0==x.getCurrentColIdx()?(h=x.getCell().getValue(),l=$(e),l.find(".modeler-auth-filter-table-prompt").remove(),h&&(c=com.kingdee.bos.qing.common.ui.CommonIconUtil.createWarning(),
c.addClass("modeler-auth-filter-table-prompt"),c.attr("title",h),c.appendTo(l))):ba(e,c);z.getUserObject().isRoleFilter()&&$(e).css({"pointer-events":"none",opacity:"0.5"})}};var Ka=function(e,c,h,l,z){var v=new r;v.setItemModel(ca);v.setListItemPainter(Pa);v.setSearchListener(la);v.setShowFieldNameListener(Ma);e=pa.createCtrlInCell(e,c,h,Bb);e.setUserObject(z);e.setSelectedModel(l);e.setDropdownCreator(function(D,Z,u){return v.createJqPopup(D,Z,u)});e.addSelectionListener(function(D){var Z=D.getSelectedModel();
D=D.getUserObject();var u=D.getUserObject(),b=u.getProperty(),g=b?b.getOutputDataType():"",p=Z?Z.getOutputDataType():"";u.setProperty(Z);D.getCell(2).setValue(Z);if(g!=p||b.getEnumValue()!=Z.getEnumValue()){b=u.getCompareOp();Z=Z?Z.isEnum():!1;Z=ta.getSelectableCompares(p,Z);p=!1;for(g=0;g<Z.length;g++)if(b==Z[g]){p=!0;break}p||(b=ta.COMPARE_EQUAL);u.setCompareOp(b);Ia(D.getCell(3),b);u.setValue(null);Ia(D.getCell(4)," ")}K.checkModelValid()});e.setCustomPainter(function(D,Z){Z.text(D?D.getAlias():
"")})},la=function(e,c,h,l,z,v,D){D&&D.hide();c=c.trim().toLowerCase();D=[];for(var Z,u=0;u<e.length;u++){var b=e[u];Z=b.getAlias().trim().toLowerCase();(b=b.getNumber())&&(b=b.trim().toLowerCase());(Z=-1!=Z.indexOf(c)?!0:v&&-1!=b.indexOf(c)?!0:!1)&&D.push(e[u])}h.children().remove();if(0<D.length){for(u=0;u<D.length;u++)z(D[u],h,l);D.length=0}else e=new jb,c?e.setText(a.get("nothingSearched","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):e.setText(a.get("noSelectField","\u6682\u65e0\u53ef\u9009\u5b57\u6bb5")),
e.setEnabled(!1),e.setAlign(jb.ALIGN_CENTER),c=e.getJqUi(),c.addClass("modeler-auth-field-popup-search-result"),c.appendTo(h);Ma(h,v)},Ma=function(e,c){if(c)for(e=e.find(".modeler-auth-field-popup-list-item-field-name"),c=0;c<e.length;c++){var h=e.eq(c);h.css("display","inline-block");var l=h.prev().text()+h.text();h.prev().attr("title",null);h.parent().attr("title",l)}else for(e=e.find(".modeler-auth-field-popup-list-item-field-name"),c=0;c<e.length;c++)h=e.eq(c),h.css("display","none"),h.parent().attr("title",
null),h.prev().attr("title",h.prev().text())},Pa=function(e,c,h){var l=$("<div>");l.addClass("modeler-auth-field-popup-list-item");l.data("model",e);var z=e?e.getAlias():"",v=$("<span>");v.text(z);v.attr("title",z);v.addClass("modeler-auth-field-popup-list-item-text");z=e.getNumber();var D=$("<span>");D.addClass("modeler-auth-field-popup-list-item-field-name");D.text("("+z+")");l.append(v);l.append(D);c.append(l);h&&h.getAlias()==e.getAlias()&&ma(c,l)},ma=function(e,c){var h=null;0<e.height()?(clearTimeout(h),
c.addClass("modeler-auth-list-item_selected_enabled"),e.prop("scrollTop",c.prop("offsetTop"))):h=setTimeout(function(){ma(e,c)},0)},ra=function(e,c,h){switch(h){case ta.COMPARE_EQUAL:e=a.get("equal","\u7b49\u4e8e");break;case ta.COMPARE_NOT_EQUAL:e=a.get("notEqual","\u4e0d\u7b49\u4e8e");break;case ta.COMPARE_GREATER:e=a.get("greater","\u5927\u4e8e");break;case ta.COMPARE_GREATER_EQUAL:e=a.get("equalOrGreater","\u5927\u4e8e\u7b49\u4e8e");break;case ta.COMPARE_LESS:e=a.get("less","\u5c0f\u4e8e");break;
case ta.COMPARE_LESS_EQUAL:e=a.get("equalOrLess","\u5c0f\u4e8e\u7b49\u4e8e");break;case ta.COMPARE_INCLUDE:e=a.get("include","\u5305\u542b");break;case ta.COMPARE_NOT_INCLUDE:e=a.get("notInclude","\u4e0d\u5305\u542b");break;case ta.COMPARE_START_WITH:e=a.get("startWith","\u5f00\u5934\u662f");break;case ta.COMPARE_END_WITH:e=a.get("endWith","\u7ed3\u5c3e\u662f");break;case ta.COMPARE_NULL:e=a.get("compareNull","\u4e3a\u7a7a");break;case ta.COMPARE_NOT_NULL:e=a.get("compareNotNull","\u4e0d\u4e3a\u7a7a");
break;case ta.COMPARE_IN:e=a.get("compareIn","\u5728......\u4e4b\u5185");break;case ta.COMPARE_NOT_IN:e=a.get("compareNotIn","\u4e0d\u5728......\u4e4b\u5185");break;case ta.COMPARE_VARIABLE:e=a.get("compareVariable","\u5339\u914d\u53d8\u91cf");break;default:e=""}c.text(e)},ya=function(e,c){var h=a.get("enterSplit","\u7cbe\u786e\u5339\u914d\u591a\u503c\uff0c\u5404\u9879\u4e4b\u95f4\u4f7f\u7528\u56de\u8f66\u4f5c\u4e3a\u5206\u9694\u7b26"),l=e.getCompareOp()==ta.COMPARE_IN?a.get("compareIn","\u5728......\u4e4b\u5185"):
a.get("compareNotIn","\u4e0d\u5728......\u4e4b\u5185"),z=JSON.parse(e.getValue());z=z?z.join("\n"):"";var v=new t;v.setCaption(l,h);v.setClosingChecker(function(D){if(D&&5E4<D.length)return a.get("matchTooLong","\u5339\u914d\u9879\u4e0d\u80fd\u8d85\u8fc750000\u4e2a\u5b57\u7b26")});v.setText(z,function(D,Z){D&&Ba(c,e,Z)});v.showDialogLeftAnchorTo(c.getJqUi())},Ra=function(e,c,h,l,z){var v=$(e);v.empty();v.css("cursor","");var D=z.getUserObject(),Z=D.getCompareOp(),u=D.getProperty(),b=u?u.getOutputDataType():
"",g=u?u.getEnumValue():"",p=u?u.isEnum():!1;if(ta.isCompareOpMatchVariable(Z)){var f=pa.createCtrlInCell(e,c,h,oa);D.setValueMode(ta.MODE_SYS_VAR);e=Cb.getImpl(Cb.SYS_VAR_HELPER);var w=e.createSysVarAdapters(nb.SUPPORTED_VAR_TYPE);f.setItemModels(w);f.setUserObject(z);f.addSelectedChangedListener(Fa);f.setCustomPainter(function(V,fa,ea){ea?(V=ea.getDisplayName(),fa.text(V)):fa.text("")});e.loadVarModelAdapter(D.getValue(),function(V){V=V?V:w[0];f.setSelected(V);D.setValue(V.getId())})}else if(!ta.isCompareOpWithoutValue(Z))if(ta.isCompareOpWithinOrNotWithinValue(Z))if(p){var k=
[],A;for(A in g)k.push({fieldValue:g[A],fieldName:A});var q=[];(l=JSON.parse(D.getValue()))&&l.forEach(function(V){k.forEach(function(fa){V==fa.fieldName&&q.push({fieldValue:fa.fieldValue,fieldName:fa.fieldName})})});var B=new Q;B.setItemModel(k,function(V,fa){return V&&fa&&V.fieldName==fa.fieldName});B.setSelectedItemModel(q);e=pa.createCtrlInCell(e,c,h,Bb);e.setUserObject(z);e.setSelectedModel(q);e.setDropdownCreator(function(V,fa,ea,ia){return B.createJqPopup(V,fa,ea,ia)});e.addSelectionListener(function(V){var fa=
V.getSelectedModel();V=V.getUserObject().getUserObject();if(null==fa||0==fa.length)V.setValue(null);else{JSON.parse(V.getValue());var ea=[],ia;for(ia in fa)ea.push(fa[ia].fieldName);V.setValue(JSON.stringify(ea))}K.checkModelValid()});e.setCustomPainter(function(V,fa){var ea=[],ia;for(ia in V)ea.push(V[ia].fieldValue);fa.text(ea.join(","))})}else{var T=pa.createCtrlInCell(e,c,h,Kb);T.setClearable(!0);T.setUserObject(z);T.getJqUi().find(".sa-ctrl-f7selector-text").on("click",function(){ya(D,T)});T.addActionListener(function(V){ya(D,
T)});null!=l&&""!=l&&" "!=l&&l&&T.setModel(JSON.parse(l).join(","));T.setCustomPainter(function(V){return V});T.addClearListener(function(V){Ba(V,D,null)})}else if(b==Ta.DT_DATE||b==Ta.DT_DATETIME)v=new Date,l=l?parseInt(l):null,isNaN(l)||null==l?(D=z.getUserObject(),D.setValue(v.getTime())):v.setTime(l),e=pa.createCtrlInCell(e,c,h,b==Ta.DT_DATETIME?Lb:Mb),e.setDateObject(v),e.setUserObject(z),e.addModelChangedListener(sa);else if(b==Ta.DT_BOOLEAN)f=pa.createCtrlInCell(e,c,h,oa),f.setSelected(l),
f.setItemModels([Ta.BOOLEAN_TRUE,Ta.BOOLEAN_FALSE]),f.setUserObject(z),f.setCustomPainter(function(V,fa,ea){V=ea==Ta.BOOLEAN_TRUE?a.get("dataTypeTrue","\u771f"):ea==Ta.BOOLEAN_FALSE?a.get("dataTypeFalse","\u5047"):"";fa.text(V)}),f.addSelectedChangedListener(Ea);else if(na(u))z=$("<div>"),z.text(l),z.addClass("modeler-auth-common-cell-editable"),z.appendTo(v),v.css("cursor","pointer");else if(p){k=[];for(A in g)k=k.concat(A);f=pa.createCtrlInCell(e,c,h,oa);f.setSelected(l);f.setItemModels(k);f.setUserObject(z);
f.setCustomPainter(function(V,fa,ea){fa.text(g[ea])});f.addSelectedChangedListener(Ea)}},ua=function(e,c,h,l,z,v){e=pa.createCtrlInCell(e,c,h,oa);e.setSelected(z);e.setItemModels([0,1,2,3,4]);e.setUserObject(v);e.setCustomPainter(function(D,Z,u){D=l?"(":")";for(var b="",g=0;g<u;g++)b+=D;Z.text(b)});e.addSelectedChangedListener(l?O:qa)},F=function(e,c,h,l,z){e=pa.createCtrlInCell(e,c,h,oa);e.setSelected(l?l:null);e.setItemModels([null,ta.LOGIC_AND,ta.LOGIC_OR]);e.setUserObject(z);e.setCustomPainter(function(v,
D,Z){v="";Z==ta.LOGIC_AND?v=a.get("and","\u4e14"):Z==ta.LOGIC_OR&&(v=a.get("or","\u6216"));D.text(v)});e.addSelectedChangedListener(ja)}}var K=this,M,L,ca=[],y=[],I=[],C;this.setRoleFilter=function(d){y=d};this.changeInherit=function(d){var r=K.getFilterItem(),t=r[r.length-1];d?(t&&0<y.length?t.setLogicOp(ta.LOGIC_OR):t&&0===y.length&&t.setLogicOp(null),K.setFilterItem(r.concat(y).slice(0))):(t&&t.setLogicOp(null),K.setFilterItem(r.slice(0)))};this.setField=function(d){ca=d};this.setFilterItem=function(d){I=
d;K.updateUi()};this.getFilterItem=function(){for(var d=I.slice(0),r=[],t=0;t<d.length;t++)d[t].getProperty()&&!d[t].isRoleFilter()&&r.push(d[t]);return r};this.getJqUi=function(){if(!M){M=$("<div>");C=pa.createTable();C.setDraggableAdjusting(!1);C.setSyncUIWhenModelChanged(!0);C.setColumnFitVisibleWidth(!0);C.setScrollerVisible("hidden","auto");pa.bindTextEditor(C,S,aa);pa.bindTableListenerForCtrl(C,ka);var d=new N(C);d.setOutsideVisible(!1);C.setCellRender(d);C.addColumns(8);C.getColumn(0).setWidth(20);
C.getColumn(1).setWidth(72);C.getColumn(2).setWidth(140);C.getColumn(3).setWidth(72);C.getColumn(4).setWidth(140);C.getColumn(5).setWidth(72);C.getColumn(6).setWidth(72);C.getColumn(7).setWidth(100);d=pa.createHeadRow(C);d.getCell(1).setValue(a.get("leftBracket","\u5de6\u62ec\u53f7"));d.getCell(2).setValue(a.get("field","\u5b57\u6bb5"));d.getCell(3).setValue(a.get("compare","\u6bd4\u8f83"));d.getCell(4).setValue(a.get("value","\u503c"));d.getCell(5).setValue(a.get("rightBracket","\u53f3\u62ec\u53f7"));
d.getCell(6).setValue(a.get("logic","\u903b\u8f91"));d=$(C.getUI());J.layoutCtrlWithLRTB(d,0,0,null,0,0,null);d.appendTo(M)}return M};this.locateToErrorRow=function(d,r){for(var t=pa.getHeadRowCount();t<C.getRowsCount();t++)C.getRow(t).getCell(0).setValue("");0<=d&&C.getRow(d+pa.getHeadRowCount()).getCell(0).setValue(r)};this.checkModelValid=function(){var d=va.FilterCheckHelper.checkFilterProperty(I,ca);if(d||(d=va.FilterCheckHelper.checkFilterLogical(I)))return K.locateToErrorRow(d.getFiltersErrorRow(),
d.getPrompt()),d.getPrompt();K.locateToErrorRow(-1);return null};var S=function(d,r){if(4!=r)return!1;d=C.getRow(d).getUserObject();r=d.getCompareOp();if(ta.isCompareOpWithoutValue(r)||ta.isCompareOpWithinOrNotWithinValue(r)||ta.isCompareOpMatchVariable(r))return!1;d=d.getProperty();return na(d)},na=function(d){var r=d?d.getOutputDataType():"";d=d?d.isEnum():!1;return(r==Ta.DT_STRING||r==Ta.DT_NUMBER||r==Ta.DT_INT)&&!d},aa=function(d,r,t,Q,x){d=d.getUserObject();d.getValue()!==Q&&(d.setValue(Q),t.setValue(Q),
K.checkModelValid());return!0},ka=function(d,r,t,Q){d=null;if(r&&!I[t-3].isRoleFilter()){r=KTableUIAbstractView.createCellId(C.getRow(t),C.getColumn(C.getColumnsCount()-1));d=K.getJqUi().find("#"+r);var x=t-3;t=$("<div>");t.text(a.get("insert","\u63d2\u5165"));t.addClass("modeler-auth-filter-table-op");t.addClass("modeler-auth-filter-table-op-insert");t.appendTo(d);t.on("click",function(ba){ba=new ta;I.splice(x,0,ba);K.updateUi();K.checkModelValid()});t=$("<div>");t.text(a.get("deleteRow","\u5220\u9664"));
t.addClass("modeler-auth-filter-table-op");t.addClass("modeler-auth-filter-table-op-delete");t.appendTo(d);t.on("click",function(ba){I.splice(x,1);K.updateUi();K.checkModelValid()});d.css("text-align","center")}else L&&L.find(".modeler-auth-filter-table-op-insert").remove(),L&&L.find(".modeler-auth-filter-table-op-delete").remove();L=d};this.updateUi=function(){if(C){for(var d=I.length-1;0<=d;d--)if(I[d].isEmpty())I.splice(d,1);else break;pa.clearWithoutHead(C);var r=I.length,t=Math.max(7,r+4);for(d=
0;d<t;d++){if(d<r)var Q=I[d];else Q=new ta,I.push(Q);var x=pa.createRow(C);x.setUserObject(Q);x.getCell(0).setValue("");x.getCell(1).setValue(Q.getLeftBracketCount());x.getCell(2).setValue(Q.getProperty());x.getCell(3).setValue(Q.getCompareOp());x.getCell(4).setValue(Q.getValue()?Q.getValue():"");x.getCell(5).setValue(Q.getRightBracketCount());x.getCell(6).setValue(Q.getLogicOp()?Q.getLogicOp():"")}pa.refresh(C);K.checkModelValid()}};var Fa=function(d,r,t){d.getUserObject().getUserObject().setValue(t.getId());
K.checkModelValid()},Ia=function(d,r){d.setValue(""===r?" ":"");d.setValue(r)},G=function(d,r,t){d=d.getUserObject();var Q=d.getUserObject();Q.setCompareOp(t);d.getCell(3).setValue(t);if(ta.isCompareOpWithoutValue(r)!=ta.isCompareOpWithoutValue(t)||ta.isCompareOpWithinOrNotWithinValue(r)!=ta.isCompareOpWithinOrNotWithinValue(t))Q.setValue(null),Ia(d.getCell(4)," ");if(t==ta.COMPARE_VARIABLE||r==ta.COMPARE_VARIABLE)Q.setValue(null),Q.setValueMode(t==ta.COMPARE_VARIABLE?ta.MODE_SYS_VAR:ta.MODE_CONST),
Ia(d.getCell(4)," ");K.checkModelValid()},O=function(d,r,t){d=d.getUserObject();d.getUserObject().setLeftBracketCount(t);d.getCell(1).setValue(t);K.checkModelValid()},qa=function(d,r,t){d=d.getUserObject();d.getUserObject().setRightBracketCount(t);d.getCell(5).setValue(t);K.checkModelValid()},ja=function(d,r,t){d=d.getUserObject();d.getUserObject().setLogicOp(t);d.getCell(6).setValue(t);K.checkModelValid()},Ba=function(d,r,t){null!=t&&d.setModel(t.replace(/(\n\s*)+/g,","));if(null==t||r.getValue()!=
JSON.stringify(t.split("\n"))){d=d.getUserObject();if(null!=t&&""!=t){t=JSON.parse(JSON.stringify(t.split("\n")));var Q=[];t&&t.forEach(function(x){""!=x.trim()&&Q.push(x)});t=JSON.stringify(Q);r.setValue(t);d.getCell(4).setValue(t)}else r.setValue(null),d.getCell(4).setValue(null);K.checkModelValid()}},sa=function(d){var r=""+d.getDateObject().getTime();d=d.getUserObject();d.getUserObject().setValue(r);d.getCell(4).setValue(r);K.checkModelValid()},Ea=function(d,r,t){d=d.getUserObject();d.getUserObject().setValue(t);
d.getCell(4).setValue(t);K.checkModelValid()}}function Da(N,K,M,L){var ca=this,y,I,C,S,na=N,aa=!1,ka=0,Fa=null,Ia=null,G,O=[],qa,ja=[],Ba=[],sa,Ea="0",d="",r=!0,t,Q=[new W("intersection",a.get("intersection","\u4ea4\u96c6")),new W("union",a.get("union","\u5e76\u96c6"))],x=[new W("0",a.get("allFields","\u5168\u90e8\u5b57\u6bb5")),new W("1",a.get("viewableField","\u53ef\u67e5\u770b\u5b57\u6bb5")),new W("2",a.get("unViewableField","\u7981\u6b62\u67e5\u770b\u5b57\u6bb5"))];this.isInitialized=function(){return null!=
qa};this.setInherit=function(ma){na=ma;aa=!0};this.setFunRoleAuth=function(ma){t=ma};this.doChangeInherit=function(ma){na?(ka=45,Fa?Fa.show():Ka()):(ka=0,Fa&&Fa.hide());J.layoutCtrlWithLRTB(Ia,0,0,null,0,ka,null);qa.changeInherit(na,Ea,d,ma);aa=!1};this.getRelation=function(){return qa.getRelation()};this.getRoleNoAuth=function(){return qa.getRoleNoAuth()};this.getNoAuth=function(){return qa.getNoAuth()};this.getProperty=function(){return O};this.checkLegality=function(){return!0};this.getJqUi=function(){y||
(y=ba());return y};var ba=function(){y=$("<div>");I=$("<div>");J.layoutCtrlWithLRTB(I,0,0,null,-35,null,35);I.appendTo(y);var ma=new cb;ma.setSearchListenerDelay(1E3);ma.setShowSearchIcon(!0);ma.setPlaceholder(a.get("searchFieldContent","\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0"));var ra=ma.getJqUi();J.layoutCtrlWithLRTB(ra,null,0,160,0,8,27);var ya=ra.find(":input");this.searchField=function(){d=ma.getText();qa.updateViewable(Ea,d)};ya.attr("oninput","searchField();");ra.find(".sa-ctrl-searchbox-close").on("click",
function(Ra){d=ma.getText();qa.updateViewable(Ea,d)});ra.appendTo(I);ra=new oa;ra.setItemModels(x);ra.setSelected(x[0]);ra.addSelectedChangedListener(function(Ra,ua,F){Ea=F.getValue();qa.updateViewable(Ea,d)});ra=ra.getJqUi();J.layoutCtrlWithLRTB(ra,null,180,100,0,8,27);ra.appendTo(I);Ia=$("<div>");J.layoutCtrlWithLRTB(Ia,0,0,null,0,ka,null);Ia.appendTo(y);qa=new Ga;qa.setDataTable(!0);qa.setInherit(!1);qa.protectedInit(Ia);ra=new La;S=ra.getNoDataTableJqUi();ra.setText(a.get("modelException","\u6a21\u578b\u5f02\u5e38\uff0c\u65e0\u6cd5\u8bbe\u7f6e\u6570\u636e\u6743\u9650"));
ra.setLinkText(" "+a.get("viewModel","\u67e5\u770b\u8be5\u6a21\u578b"),Pa);S.appendTo(y);S.hide();la();return y},Ka=function(){Fa=$("<div>");J.layoutCtrlWithLRTB(Fa,0,0,null,null,0,45);Fa.appendTo(y);var ma=$("<div>");ma.addClass("auth-setting-combo-box-label");ma.appendTo(Fa);var ra=$("<span>");ra.text(a.get("effectiveFields","\u751f\u6548\u7684\u53ef\u89c1\u5b57\u6bb5\u96c6\u5408\u662f\u7528\u6237/\u89d2\u8272\u7684"));ra.appendTo(ma);ra=$("<span>");ra.text("*");ra.css("color","red");ra.appendTo(ma);
C=new oa;C.setItemModels(Q);C.setSelected(Q[0]);sa===Q[1].getValue()&&C.setSelected(Q[1]);C.addSelectedChangedListener(function(ya,Ra,ua){sa=ua.getValue();qa.setRelation(sa);qa.updateEffective()});ma=C.getJqUi();ma.addClass("auth-setting-combo-box");ma.appendTo(Fa);ka=45},la=function(ma){var ra=K.getModelId();ma&&console.log("enter...");X.createFacade(function(ya){O=[];if(ya)for(var Ra=0;Ra<ya.length;Ra++){var ua=new Ta;ua.fromJsonObject(ya[Ra]);O.push(ua)}qa.setProperty(O);Ma(ra)},function(ya,Ra){Ia.hide();
S.show();return!0}).getFields(ra,!0)},Ma=function(ma){X.createFacade(function(ra){Ba=[];ja=[];sa=Q[0].getValue();if(ra&&ra.dataAuthContents){var ya=new ib;ya.fromJsonObject(ra);(ya=ya.getModels()[0])&&ya.isRoleExist()&&t&&t(ya.isRoleExist());ra=ya.getCellAuth();ya=ya.getRoleCellAuth();ra&&(Ba=ra.getNoAuthFields(),sa=ra.getRelation()?ra.getRelation():Q[0].getValue());ya&&(ja=ya.getNoAuthFields())}C&&sa==Q[1].getValue()&&C.setSelected(Q[1]);qa.setRelation(sa);qa.setRoleNoAuth(ja);qa.setNoAuth(Ba);qa.protectedUpdateUi(O)},
function(ra,ya){return 20003102==ra?(X.getMessageCurtain().showPrompt(a.get("modelNoFoundRefresh","\u6a21\u578b\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u5148\u5237\u65b0\u754c\u9762\u3002")),!0):!1}).queryDataAuthContent(na,ma,M,L)},Pa=function(){n.getModelDesignerEntrance()(db,K.getModelId(),K.getModelName(),K.getModelType())};this.setTitle=function(ma){G=ma};this.getTitle=function(){return G};this.into=function(){aa&&ca.doChangeInherit(r);r=!1;Xa.occur(Xa.DATA_AUTH_SETTING_SHOW_METHOD,Xa.COL_AUTH)}}
function Ga(){function N(d){KTDefaultCellRender.call(this,d);var r=this,t=[Ta.DT_STRING,Ta.DT_NUMBER,Ta.DT_INT,Ta.DT_DATE,Ta.DT_DATETIME,Ta.DT_BOOLEAN],Q=this.paintCellUI,x=function(la){var Ma=$("<div>");Ma.addClass("auth-setting-field-enable");aa=new R;aa.setChecked(!1);aa.addCheckedListener(function(ma,ra){if(ra){for(ra=0;ra<ka.length;ra++)!ka[ra].getUserObject().isDimension()&&ka[ra].setChecked(ma.isChecked());C&&K.updateEffective()}});var Pa=aa.getJqUi();Pa.addClass("auth-setting-field-enable-combobox");
Pa.appendTo(Ma);Pa=$("<div>");Pa.text(a.get("viewEnable","\u53ef\u67e5\u770b\u5b57\u6bb5"));C&&Pa.text(a.get("userEnable","\u7528\u6237\u7ea7\u522b\u5b57\u6bb5\u53ef\u89c1\u6027"));Pa.addClass("auth-setting-field-enable-text");Pa.appendTo(Ma);Ma.appendTo(la)},ba=function(la,Ma,Pa){var ma=$(Ma);1==r.getCurrentColIdx()?Ka(Ma,r.getCellWidth(),r.getCellHeight(),la,r.getCurrentRow()):(Q(Ma,Pa),ma.css("cursor","default"))};this.paintCellUI=function(la,Ma){if(r.getCurrentRowIdx()<pa.getHeadRowCount())1===
r.getCurrentRowIdx()&&(C&&4===r.getCurrentColIdx()||!C&&3===r.getCurrentColIdx())?x(la):Q(la,Ma),$(la).css("color","#666");else{var Pa=$(la),ma=$("<div>"),ra=r.getCurrentRow().getUserObject(),ya=ra.getFullName(),Ra=0,ua=!0;if(0==r.getCurrentColIdx())Pa.empty(),ma.text(r.getCurrentRowIdx()-2),ma.addClass("field-table-cell-editable"),ma.css("text-align","center"),Pa.append(ma);else if(1==r.getCurrentColIdx())ba(ra,la,Ma),Pa.css("pointer-events","none");else if(2==r.getCurrentColIdx())Pa.empty(),ya=
r.getCell().getValue(),ma.text(ya),ma.addClass("field-table-cell-editable"),ma.attr("title",ya),Pa.append(ma),Pa.css("pointer-events","none");else if(C&&3==r.getCurrentColIdx()){la=new R;la.setEnabled(!1);for(Ra=0;Ra<ca.length;Ra++)if(ma=ca[Ra].getFullName(),ma==ya){ua=!1;break}la.setChecked(ua);Fa.push(la);ya=la.getJqUi();J.layoutCtrlWithLRTB(ya,75,null,23,4,null,23);Pa.append(ya)}else if(C&&4==r.getCurrentColIdx()){la=new R;if(0<G.length)ua=G[r.getCurrentRowIdx()-3].isChecked();else for(Ra=0;Ra<
y.length;Ra++)if(ma=y[Ra].getFullName(),ma==ya){ua=!1;break}la.setChecked(ua);la.setEnabled(!ra.isDimension());la.setUserObject(ra);la.addCheckedListener(function(F,e){e&&(ja(),K.updateEffective())});ka.push(la);ya=la.getJqUi();J.layoutCtrlWithLRTB(ya,75,null,23,4,null,23);Pa.append(ya);ra.isDimension()&&Pa.attr("title",a.get("dimensionTips","\u7ef4\u5ea6\u5b57\u6bb5\u5fc5\u9009"))}else if(C&&5==r.getCurrentColIdx()){ua=ra=!0;for(Ra=0;Ra<ca.length;Ra++)if(ma=ca[Ra].getFullName(),ma==ya){ra=!1;break}if(0<
G.length)ua=G[r.getCurrentRowIdx()-3].isChecked();else for(Ra=0;Ra<y.length;Ra++)if(ma=y[Ra].getFullName(),ma==ya){ua=!1;break}ua="intersection"==S?ua&&ra:ua||ra;ya=$("<div>");ua?H.background(ya,"icon-field-visible"):H.background(ya,"icon-field-novisible");Ia.push(ya);J.layoutCtrlWithLRTB(ya,75,null,25,6,null,23);Pa.append(ya)}else if(C||3!=r.getCurrentColIdx())Q(la,Ma);else{la=new R;if(0<G.length)ua=G[r.getCurrentRowIdx()-3].isChecked();else for(Ra=0;Ra<y.length;Ra++)if(ma=y[Ra].getFullName(),ma==
ya){ua=!1;break}la.setEnabled(!ra.isDimension());la.setChecked(ua);la.setUserObject(ra);la.addCheckedListener(function(F,e){e&&ja()});ka.push(la);ya=la.getJqUi();J.layoutCtrlWithLRTB(ya,105,null,23,4,null,23);Pa.append(ya);ra.isDimension()&&Pa.attr("title",a.get("dimensionTips","\u7ef4\u5ea6\u5b57\u6bb5\u5fc5\u9009"))}}};var Ka=function(la,Ma,Pa,ma,ra){var ya=ma.getDataType();ma=ma.getOutputDataType();la=pa.createCtrlInCell(la,Ma,Pa,oa);la.setSelected(ma);la.setItemModels(t);la.setUserObject(ra);
la.setCustomPainter(function(Ra,ua,F){Ra=Ra?!1:F==ya;var e="icon-"+F.toLowerCase(),c=$("<div>");c.addClass("field-table-datatype-icon");H.background(c,e);c.appendTo(ua);F=va.PropDataTypeUtil.getDataTypeDesc(F);e=$("<div>");e.text(F+(Ra?"("+a.get("origin","\u539f\u59cb")+")":""));e.addClass("field-table-datatype-text");e.appendTo(ua)});la.addSelectedChangedListener(Ea)}}var K=this,M,L=[],ca=[],y=[],I=!1,C=!1,S,na,aa,ka=[],Fa=[],Ia=[],G=[];this.setProperty=function(d){L=d};this.setRelation=function(d){S=
d};this.getRelation=function(){return S};this.setRoleNoAuth=function(d){ca=d};this.getRoleNoAuth=function(){return ca};this.setNoAuth=function(d){y=d};this.getNoAuth=function(){O();for(var d=[],r=0;r<G.length;r++){var t=G[r].getUserObject();!G[r].isChecked()&&d.push(t)}return y=d};this.setDataTable=function(d){I=d};this.setInherit=function(d){C=d};this.changeInherit=function(d,r,t,Q){C=d;M.removeAllRows();M.removeAllColumns();qa();y=K.getNoAuth();K.protectedUpdateUi(L);!Q&&K.updateViewable(r,t)};
this.updateEffective=function(){for(var d=0;d<ka.length;d++){var r=ka[d].isChecked(),t=Fa[d].isChecked();"intersection"==S?r&&t?H.background(Ia[d],"icon-field-visible"):H.background(Ia[d],"icon-field-novisible"):r||t?H.background(Ia[d],"icon-field-visible"):H.background(Ia[d],"icon-field-novisible")}};this.updateSearchResult=function(d){O();var r=M.getRowsCount();d=d.trim().toLowerCase();for(var t=3;t<r;t++)-1!==M.getRow(t).getUserObject().getAlias().toLowerCase().indexOf(d)?M.getRow(t).setHide(!1):
M.getRow(t).setHide(!0);Fa=[];Ia=[];ka=[];M.updateUI()};this.updateViewable=function(d,r){O();var t=M.getRowsCount();r=r.trim().toLowerCase();for(var Q=3;Q<t;Q++){var x=!0;"0"===d?x=!1:"1"===d?x=!G[Q-3].isChecked():"2"===d&&(x=G[Q-3].isChecked());var ba=M.getRow(Q).getUserObject().getAlias().toLowerCase();x=!x&&-1!==ba.indexOf(r);M.getRow(Q).setHide(!x)}Fa=[];Ia=[];ka=[];M.updateUI();ja();0<ka.length?na.hide():na.show()};var O=function(){if(0===G.length)for(var d=0;d<ka.length;d++)G.push(ka[d]);else for(d=
0;d<ka.length;d++)for(var r=ka[d].getUserObject(),t=0;t<G.length;t++)if(r==G[t].getUserObject()){G[t].setChecked(ka[d].isChecked());break}};this.protectedInit=function(d){M=new KTable;pa.bindTextEditor(M,Ba,sa);var r=new N(M);r.setOutsideVisible(!1);M.setCellRender(r);M.setSyncUIWhenModelChanged(!1);M.setColumnFitVisibleWidth(!1);M.setFrozenRows(3);M.setDraggableAdjusting(!0);qa();r=$(M.getUI());J.layoutCtrlWithLRTB(r,0,0,null,0,0,null);r.appendTo(d);r=new La;na=r.getNoDataTableJqUi();r.setTopPx(35);
r.updateIcon("icon-search_none");r.setText(a.get("noMatchedResult","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));na.appendTo(d);na.hide()};var qa=function(){var d=pa.createHeadRow(M);if(C){M.addColumns(6);M.getColumn(0).setWidth(80);M.getColumn(1).setWidth(I?120:80);M.getColumn(2).setWidth(I?120:80);M.getColumn(3).setWidth(I?145:105);M.getColumn(4).setWidth(I?160:100);M.getColumn(5).setWidth(I?145:105);d.getCell(0).setValue("#");d.getCell(1).setValue(a.get("fieldDataType",
"\u5b57\u6bb5\u7c7b\u578b"));d.getCell(2).setValue(a.get("fieldName","\u5b57\u6bb5\u540d\u79f0"));d.getCell(3).setValue(a.get("roleEnable","\u89d2\u8272\u7ea7\u522b\u5b57\u6bb5\u53ef\u89c1\u6027"));d.getCell(4).setValue(a.get("userEnable","\u7528\u6237\u7ea7\u522b\u5b57\u6bb5\u53ef\u89c1\u6027"));d.getCell(5).setValue(a.get("effectiveEnable","\u751f\u6548\u7684\u5b57\u6bb5\u53ef\u89c1\u6027"));var r=new KTStyle;r.setBackgroundColor("#F7D49F");M.getRow(0).getCell(5).setStyle(r);M.getRow(1).getCell(5).setStyle(r);
M.getRow(2).getCell(5).setStyle(r)}else M.addColumns(4),M.getColumn(0).setWidth(100),M.getColumn(1).setWidth(I?150:110),M.getColumn(2).setWidth(I?200:160),M.getColumn(3).setWidth(I?220:155),d.getCell(0).setValue("#"),d.getCell(1).setValue(a.get("fieldDataType","\u5b57\u6bb5\u7c7b\u578b")),d.getCell(2).setValue(a.get("fieldName","\u5b57\u6bb5\u540d\u79f0")),d.getCell(3).setValue(a.get("viewEnable","\u53ef\u67e5\u770b\u5b57\u6bb5"));r=new KTBorderStyle;r.setLeftBorderWidth(0);d.getCell(0).setBorder(r)};
this.protectedUpdateUi=function(d){Fa=[];Ia=[];ka=[];pa.clearWithoutHead(M);for(var r,t=0;t<d.length;t++){var Q=d[t];r=pa.createRow(M);r.setUserObject(Q);var x=r;x.getCell(1).setValue(Q.getOutputDataType());x.getCell(2).setValue(Q.getAlias())}r&&(d=(d=r.getBorder())?d.copy():new KTBorderStyle,d.setBottomBorderWidth(1),d.setBottomBorderPen("solid"),d.setBottomBorderColor("#eee"),r.setBorder(d));M.updateUI();ja()};var ja=function(){for(var d=!0,r=0;r<ka.length;r++)if(!ka[r].isChecked()){d=!1;break}aa.setChecked(d)},
Ba=function(d,r){return 2==r},sa=function(d,r,t,Q,x){d=d.getUserObject();r=!1;for(var ba=0;ba<L.length;ba++){var Ka=L[ba];if(d.getName()!=Ka.getName()&&Ka.getAlias()==Q){r=!0;break}}if(r)return t=a.get("duplicatedName","\u91cd\u590d\u7684\u5b57\u6bb5\u663e\u793a\u540d\u79f0\uff1a")+Q,x||(t+=a.get("abandonModify","\uff0c\u5df2\u653e\u5f03\u4fee\u6539\u3002")),X.getMessageCurtain().showPrompt(t),!1;d.getAlias()!=Q&&(t.setValue(Q),d.setAlias(Q));return!0},Ea=function(d,r,t){d.getUserObject().getUserObject().setAppointedDataType(t)}}
"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.auth&&(com.kingdee.bos.qing.modeler.modelset.auth=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.auth.ui&&(com.kingdee.bos.qing.modeler.modelset.auth.ui={});var va=com.kingdee.bos.qing.modeler.modelset.auth.ui;va.Main=function(){function N(){var G,O;this.getToolBarJqUi=function(){if(!M){M=$("<div>");M.addClass("modelset-data-auth-toolbar");var ja=$("<div>");ja.addClass("view-type-tab-title");ja.text(a.get("viewType","\u5c55\u793a\u65b9\u5f0f\uff1a"));ja.appendTo(M);G=$("<div>");G.addClass("view-type-box-checked");ja=aa[0];G.text(ja.toString());
G.attr("viewType",ja.getValue());G.attr("title",ja.toString());G.attr("checked","checked");G.on("click",qa);G.appendTo(M);O=$("<div>");O.addClass("view-type-box-unchecked");ja=aa[1];O.text(ja.toString());O.attr("viewType",ja.getValue());O.attr("title",ja.toString());O.on("click",qa);O.appendTo(M)}return M};var qa=function(ja){ja=$(ja.target);"checked"!==ja.attr("checked")&&("0"===ja.attr("viewType")?(pb=!0,G.attr("checked","checked"),G.removeClass("view-type-box-unchecked"),G.addClass("view-type-box-checked"),
O.removeAttr("checked"),O.removeClass("view-type-box-checked"),O.addClass("view-type-box-unchecked"),ca.hide(),L.show(),y.resize()):(pb=!1,O.attr("checked","checked"),O.removeClass("view-type-box-unchecked"),O.addClass("view-type-box-checked"),G.removeAttr("checked"),G.removeClass("view-type-box-checked"),G.addClass("view-type-box-unchecked"),I||(I=new Aa(na),I.updateErrorModels(C),I.updateModelState(S),ca=I.getModelSetMainAreaJqUi(),ca.appendTo(K)),L.hide(),ca.show(),I.resize()),Xa.occur(Xa.PAGE_SHOW_METHOD,
Xa.getPageShowMethod(ja.attr("viewType"))))}}var K,M,L,ca,y,I,C=[],S=!0,na=!1,aa=[new W("0",a.get("showByModel","\u6309\u6a21\u578b\u5c55\u793a")),new W("1",a.get("showByUser","\u6309\u7528\u6237\u6216\u89d2\u8272\u5c55\u793a"))];this.createJqUi=function(G){na=G;K=$("<div>");K.addClass("modelset-data-auth");M=(new N).getToolBarJqUi();M.appendTo(K);ka();y=new za(na);y.setErrorStateListener(Fa);y.setModelStateListener(Ia);L=y.getModelSetMainAreaJqUi();L.appendTo(K);var O=function(qa){qa.altKey&&qa.ctrlKey&&
qa.shiftKey&&"KeyL"===qa.code&&(console.log("\u6e05\u7406\u5e9f\u5f03\u7684\u6570\u636e\u6743\u9650"),qa=X.createFacade(function(){console.log("\u6e05\u7406\u5e9f\u5f03\u7684\u6570\u636e\u6743\u9650\u6210\u529f");document.body.removeEventListener("keydown",O,!0)},function(){console.log("\u6e05\u7406\u5e9f\u5f03\u7684\u6570\u636e\u6743\u9650\u5931\u8d25");document.body.removeEventListener("keydown",O,!0)}),qa.setShowBlocking(!1),qa.deleteInvalidData())};document.body.addEventListener("keydown",O,!0);
return K};var ka=function(){var G=X.createFacade(function(O){O&&0!=O.length&&nb.VARIANTTYPEENUM.forEach(function(qa){O.forEach(function(ja){qa.getTypeID()==ja&&nb.SUPPORTED_VAR_TYPE.push(qa)})})},function(){});G.setShowBlocking(!1);G.loadSupportSystemVar()},Fa=function(G){C=G;I&&I.updateErrorModels(C)},Ia=function(G){S=G;I&&I.updateModelState(S)}};var Ua,n,a,P,Y,H,da,E,J,Sa,U,oa,cb,ab,pa,R,ob,lb,sb,ub,yb,jb,Bb,Jb,Ab,Kb,Mb,Lb,mb,wb,zb,Gb,Fb,gb,Na,xa,ta,Ta,Hb,ib,tb,rb,Ib,vb,nb,Cb,db,xb,pb,Xa,Eb;(function(){var N=
com.kingdee.bos.qing.common;J=N.DomUtil;Sa=N.Util;N=com.kingdee.bos.qing.framework.common;a=N.MultilanguageManager.createPackageAccessor(va);P=N.WindowResizeObserver;Y=N.Resource;N=com.kingdee.bos.qing.ui.component;da=N.MessageCurtain;E=N.MessageDialog;oa=N.ComboBox;cb=N.SearchBox;ab=N.TabContainer;R=N.CheckBox;ob=N.SwitchButton;lb=N.Tree;sb=N.SimpleConfirmer;ub=N.AbstractModalDialog;yb=N.List;jb=N.Label;Bb=N.DropdownSelector;Jb=N.TextArea;Ab=N.Button;Kb=N.F7Selector;Lb=N.DateTimeSelector;Mb=N.DateSelector;
wb=N.Tips;zb=N.HelpIcon;Gb=N.Icons;Fb=N.Dialog;N=com.kingdee.bos.qing.integration;U=N.UserAndRoleForm;N=com.kingdee.bos.qing.modeler.modelset.auth.common;Ua=N.Facade;n=N.Integration;H=N.Icons;Xa=N.UserOperationReporter;N=com.kingdee.bos.qing.modeler.modelset.auth.model;gb=N.ModelFolderNode;Na=N.ModelLeafNode;xa=N.UserDataAuth;ta=N.FilterItem;Ta=N.Property;Hb=N.ModelSetRole;ib=N.QingModelerDataAuth;tb=N.DataAuthModeler;Ib=N.RowAuth;rb=N.CellAuth;vb=N.ModelStatus;Eb=N.DataAuthUtil;N=com.kingdee.bos.qing.modeler.common;
Cb=N.VariateHelperFactory;N=com.kingdee.bos.qing.modeler.common.model;nb=N.SystemVarType;N=com.kingdee.bos.qing.common.ui;pa=N.TableUtil;mb=N.CommonIconUtil;db=Sa.decodeParamFromUrl(location.search,"modelSetId");xb=Sa.decodeParamFromUrl(location.search,"modelSetName");pb=!0})();var X=new function(){var N;this.getMessageCurtain=function(){N||(N=new da,N.getJqUi().appendTo($("body")));return N};this.createFacade=function(K,M,L){var ca=n.getRemoteImpl();return new Ua(ca,K,function(y,I){return M?M(y,
I):!1},L)}};ta.COMPARE_WITH_RAW="RAW";ta.COMPARE_WITH_APPOINTED="APPOINTED";ta.MODE_CONST="Const";ta.MODE_SYS_VAR="SystemVar";ta.MODE_MACRO_VAR="MacroVar";va.PropDataTypeUtil=new function(){var N=this;this.getDataTypeDesc=function(K){switch(K){case Ta.DT_STRING:return a.get("text","\u6587\u672c");case Ta.DT_NUMBER:return a.get("number","\u6570\u503c");case Ta.DT_INT:return a.get("integer","\u6574\u6570");case Ta.DT_DATE:return a.get("dataTypeDate","\u65e5\u671f");case Ta.DT_DATETIME:return a.get("dateTime",
"\u65e5\u671f\u65f6\u95f4");case Ta.DT_BOOLEAN:return a.get("bool","\u5e03\u5c14");default:return""}};this.buildDataTypeInConsistentPrompt=function(K,M){var L=a.get("dataTypeNotMatch","\u5b57\u6bb5\u201c#1\u201d\u7684\u6570\u636e\u7c7b\u578b\u4e3a#2\uff0c\u4e0e\u5b57\u6bb5\u201c#3\u201d\u7684#4\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4");L=L.replace("#1",K.getAlias());L=L.replace("#2",N.getDataTypeDesc(K.getOutputDataType()));L=L.replace("#3",M.getAlias);return L=L.replace("#4",N.getDataTypeDesc(M.getOutputDataType()))}};
va.FilterCheckHelper=new function(){this.checkFilterProperty=function(K,M){if(!M)return K=a.get("noFieldToSelect","\u65e0\u53ef\u9009\u5b57\u6bb5"),new ta.FiltersCheckingResult(-1,K);for(var L,ca=0;ca<K.length;ca++){var y=K[ca];if(!y.isEmpty()&&!y.isRoleFilter()){a:{L=ca;for(var I=M,C=y.getProperty(),S=0;S<I.length;S++)if(C&&I[S].getFullName()==C.getFullName()){L=null;break a}I=a.get("lackField","\u7b2c#1\u884c\u5b57\u6bb5\u4e0d\u5b58\u5728\u3002");I=I.replace("#1",L+1);L=new ta.FiltersCheckingResult(L,
I)}L||(L=ca,(I=N(y))?(C=a.get("incompleteFilter","\u7b2c#1\u884c\u4e0d\u5b8c\u6574\uff0c"),C=C.replace("#1",L+1),L=new ta.FiltersCheckingResult(L,C+I)):L=null);if(!L)a:{L=y;y=ca;if(L.getCompareOp()==ta.COMPARE_VARIABLE&&L.isSystemVariant()){L=L.getValue();I=!1;for(C=0;C<nb.SUPPORTED_VAR_TYPE.length;C++)if(nb.SUPPORTED_VAR_TYPE[C].getTypeID()==L){I=!0;break}if(!I){L=a.get("invalidSystemVarType","\u7b2c#1\u884c\u65e0\u6548\u7684\u7cfb\u7edf\u53d8\u91cf\u3002");L=L.replace("#1",y+1);L=new ta.FiltersCheckingResult(y,
L);break a}}L=null}if(L)break}}return L};this.checkFilterLogical=function(K){var M=0,L=-1,ca,y=0;for(ca=0;ca<K.length;ca++)K[ca].isEmpty()||(y=ca);ca=y;for(y=0;y<K.length;y++){var I=K[y];if(!I.isEmpty()&&!I.isRoleFilter()){M+=I.getLeftBracketCount();M-=I.getRightBracketCount();0>L&&0!=M&&(L=y);if(0>M)return K=a.get("bracketMismatch","\u5de6\u53f3\u62ec\u53f7\u4e0d\u5339\u914d\u3002"),new ta.FiltersCheckingResult(L,K);if(y!=ca&&!I.getLogicOp())return K=a.get("lackLogicalSymbol","\u7b2c#1\u884c\u7f3a\u5c11\u903b\u8f91\u7b26"),
K=K.replace("#1",y+1),new ta.FiltersCheckingResult(y,K)}}return 0<M?(K=a.get("bracketMismatch","\u5de6\u53f3\u62ec\u53f7\u4e0d\u5339\u914d\u3002"),new ta.FiltersCheckingResult(L,K)):null};var N=function(K){var M=K.getCompareOp(),L=K.getProperty(),ca=K.getValue(),y=L?L.getOutputDataType():"";L=L?L.isEnum():!1;L=ta.getSelectableCompares(y,L);if(!ta.isCompareOpWithoutValue(M)){if(!ca)return a.get("lackValue","\u7f3a\u5c11\u503c\u3002");if(y==Ta.DT_NUMBER||y==Ta.DT_INT){if(!ta.REG_NUMBER.test(ca)&&!K.isSystemVariant()&&
M!=ta.COMPARE_IN&&M!=ta.COMPARE_NOT_IN)return a.get("valueMustBeNum","\u503c\u5fc5\u987b\u4e3a\u6570\u5b57\u3002")}else if(y==Ta.DT_DATE||y==Ta.DT_DATETIME)ta.REG_DATETIME.test(ca)||ta.isCompareOpWithinOrNotWithinValue(M)||K.setValue((new Date).getTime());else if(y==Ta.DT_BOOLEAN&&ca!=Ta.BOOLEAN_TRUE&&ca!=Ta.BOOLEAN_FALSE)return a.get("wrongBoolean","\u9519\u8bef\u7684\u5e03\u5c14\u503c\u3002")}if(!M)return a.get("lackComparisonOperator","\u7f3a\u5c11\u6bd4\u8f83\u7b26\u3002");K=!1;for(ca=0;ca<L.length;ca++)if(M==
L[ca]){K=!0;break}return K?null:a.get("comparisonMismatch","\u6bd4\u8f83\u7b26\u4e0d\u5339\u914d\u3002")}}})();
//qingVersionTag: 20250324