var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(L){var ea=0;return function(){return ea<L.length?{done:!1,value:L[ea++]}:{done:!0}}};$jscomp.arrayIterator=function(L){return{next:$jscomp.arrayIteratorImpl(L)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(L,ea,Y){if(L==Array.prototype||L==Object.prototype)return L;L[ea]=Y.value;return L};$jscomp.getGlobal=function(L){L=["object"==typeof globalThis&&globalThis,L,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var ea=0;ea<L.length;++ea){var Y=L[ea];if(Y&&Y.Math==Math)return Y}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(L,ea){var Y=$jscomp.propertyToPolyfillSymbol[ea];if(null==Y)return L[ea];Y=L[Y];return void 0!==Y?Y:L[ea]};
$jscomp.polyfill=function(L,ea,Y,ba){ea&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(L,ea,Y,ba):$jscomp.polyfillUnisolated(L,ea,Y,ba))};$jscomp.polyfillUnisolated=function(L,ea,Y,ba){Y=$jscomp.global;L=L.split(".");for(ba=0;ba<L.length-1;ba++){var ma=L[ba];if(!(ma in Y))return;Y=Y[ma]}L=L[L.length-1];ba=Y[L];ea=ea(ba);ea!=ba&&null!=ea&&$jscomp.defineProperty(Y,L,{configurable:!0,writable:!0,value:ea})};
$jscomp.polyfillIsolated=function(L,ea,Y,ba){var ma=L.split(".");L=1===ma.length;ba=ma[0];ba=!L&&ba in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var na=0;na<ma.length-1;na++){var qa=ma[na];if(!(qa in ba))return;ba=ba[qa]}ma=ma[ma.length-1];Y=$jscomp.IS_SYMBOL_NATIVE&&"es6"===Y?ba[ma]:null;ea=ea(Y);null!=ea&&(L?$jscomp.defineProperty($jscomp.polyfills,ma,{configurable:!0,writable:!0,value:ea}):ea!==Y&&(void 0===$jscomp.propertyToPolyfillSymbol[ma]&&(Y=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[ma]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(ma):$jscomp.POLYFILL_PREFIX+Y+"$"+ma),$jscomp.defineProperty(ba,$jscomp.propertyToPolyfillSymbol[ma],{configurable:!0,writable:!0,value:ea})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(L){if(L)return L;var ea=function(na,qa){this.$jscomp$symbol$id_=na;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:qa})};ea.prototype.toString=function(){return this.$jscomp$symbol$id_};var Y="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",ba=0,ma=function(na){if(this instanceof ma)throw new TypeError("Symbol is not a constructor");return new ea(Y+(na||"")+"_"+ba++,na)};return ma},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(L){if(L)return L;L=Symbol("Symbol.iterator");for(var ea="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Y=0;Y<ea.length;Y++){var ba=$jscomp.global[ea[Y]];"function"===typeof ba&&"function"!=typeof ba.prototype[L]&&$jscomp.defineProperty(ba.prototype,L,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return L},
"es6","es3");$jscomp.iteratorPrototype=function(L){L={next:L};L[Symbol.iterator]=function(){return this};return L};$jscomp.iteratorFromArray=function(L,ea){L instanceof String&&(L+="");var Y=0,ba=!1,ma={next:function(){if(!ba&&Y<L.length){var na=Y++;return{value:ea(na,L[na]),done:!1}}ba=!0;return{done:!0,value:void 0}}};ma[Symbol.iterator]=function(){return ma};return ma};
$jscomp.polyfill("Array.prototype.keys",function(L){return L?L:function(){return $jscomp.iteratorFromArray(this,function(ea){return ea})}},"es6","es3");$jscomp.findInternal=function(L,ea,Y){L instanceof String&&(L=String(L));for(var ba=L.length,ma=0;ma<ba;ma++){var na=L[ma];if(ea.call(Y,na,ma,L))return{i:ma,v:na}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(L){return L?L:function(ea,Y){return $jscomp.findInternal(this,ea,Y).v}},"es6","es3");
(function(){function L(){ba.call(this);var ia;this.getRemoteUrl=function(){return ia};this.setRemoteUrl=function(pa){ia=pa}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.common&&(com.kingdee.bos.qing.modeler.modelset.common={});var ea=com.kingdee.bos.qing.modeler.modelset.common;ea.Facade=function(ia,pa,N,va){Y.call(this,ia,pa,N,va);var n=this.protectedMethod;this.checkQingModelerPermission=function(){n.remote("checkQingModelerPermission",{})};this.checkQingModelerPresetPermission=function(){n.remote("checkQingModelerPresetPermission",{})};this.loadAllModelSetInfo=function(){n.remote("loadAllModelSetInfo",
{})};this.loadCoopInfoDetails=function(Z){Z={modelSet:JSON.stringify(Z.toJsonObject())};n.remote("loadCoopInfoDetails",Z)};this.previewCoopInfo=function(Z,Aa){Z={valueTextPairs:JSON.stringify(Z),type:Aa};n.remote("previewCoopInfo",Z)};this.saveOrUpdateModelSet=function(Z){Z={modelSet:JSON.stringify(Z.toJsonObject())};n.remote("saveOrUpdateModelSet",Z)};this.deleteModelSet=function(Z){n.remote("deleteModelSet",{modelSetId:Z})};this.saveOrUpdateCoopModelSetInfo=function(Z){Z={modelSet:JSON.stringify(Z.toJsonObject())};
n.remote("saveOrUpdateCoopModelSetInfo",Z)};this.updateModelSetEnabledStatus=function(Z,Aa){n.remote("updateModelSetEnabledStatus",{modelSetId:Z,enableStatus:Aa})};this.loadSingleModelSetInfo=function(Z){n.remote("loadSingleModelSetInfo",{modelSetId:Z})};this.getAllModelSetForExport=function(){n.remote("getAllModelSetForExport",{})};this.confirmExportModelSet=function(Z){Z={modelSetIdList:JSON.stringify(Z.modelSetList)};n.remote("confirmExportModelSet",Z)};this.getExportedData=function(Z){var Aa=
qa.formatDate("yyyyMMdd_HHmmss");na.downloadFile("Qing-"+Aa+".qing-mds",Z)};this.getEnableImportModelSet=function(Z){n.remote("getEnableImportModelSet",{fileName:Z})};this.importSelectedModelSet=function(Z,Aa,Ia,Ja){Z={fileName:Z,modelSetList:JSON.stringify({importModelSets:Aa}),firstTimeImport:Ia,cacheIdKey:Ja};n.remote("importSelectedModelSet",Z)};this.getAllDWResourceInfoList=function(Z,Aa,Ia,Ja,M){n.remote("getAllDWResourceInfoList",{targetPage:Z,pageSize:Aa,sortField:Ia,sortOrder:Ja,searchText:M})};
this.getAllScheduleResourceInfoList=function(Z,Aa,Ia,Ja,M,d,sa,Na){n.remote("getAllScheduleResourceInfoList",{targetPage:Z,pageSize:Aa,sortField:Ia,sortOrder:Ja,searchText:M,currentType:d,startDateTimeStamp:sa,endDateTimeStamp:Na})};this.hasResourceManager=function(){n.remote("hasResourceManager",{})};this.loadExceptionLog=function(Z){n.remote("loadExceptionLog",{id:Z})};this.checkDataWarehouseConfig=function(){n.remote("checkDataWarehouseConfig",{})}};var Y,ba,ma,na,qa;(function(){var ia=com.kingdee.bos.qing.framework.common;
Y=ia.AbstractFacade;ba=ia.AbstractRemoteCall;ma=ia.AbstractIcons;na=ia.RemoteFramework;ia=com.kingdee.bos.qing.common;qa=ia.Util})();ea.Integration=new function(){var ia=new L,pa,N,va;this.getRemoteImpl=function(){return ia};this.setRemoteUrl=function(n){ia.setRemoteUrl(n)};this.setModelSetMainPageEntrance=function(n){pa=n};this.getModelSetMainPageEntrance=function(){return pa};this.setModelDesignerPageEntrance=function(n){N=n};this.getModelDesignerPageEntrance=function(){return N};this.setDeployModelDesignerPageEntrance=
function(n){va=n};this.getDeployModelDesignerPageEntrance=function(){return va}};ea.ModelSetSubscribeHelper=new function(){var ia={},pa=com.kingdee.bos.qing.framework.common.RemoteFramework;this.putSubscribe=function(N,va){ia[N+""]=va;pa.subscribeChannel(N+"",va)};this.clear=function(){for(var N=Object.keys(ia),va=0;va<N.length;va++){var n=N[va];pa.unsubscribeChannel(n,ia[n])}ia={}};this.getCurrentPageClientId=function(){return pa.getClientID()}};ea.Icons=new function(){ma.call(this);var ia=this.protectedMethod;
this.protectedInit=function(va,n){va=com.kingdee.bos.qing.modeler.modelset.ComboIcon;if(!va)throw Error("com.kingdee.bos.qing.theme.ComboIcon not found.");va.define(n,"model-common");n.setStartPosition(1,62);n.setIconSize(20,20);N(0,1,"icon-enable");N(0,0,"icon-disabled");N(0,2,"icon-modelset");n.setStartPosition(0,81);n.setIconSize(18,18);N(0,4,"icon-right");N(1,4,"icon_down");n.setStartPosition(280,220);n.setIconSize(50,50);N(0,0,"user-not-exist");n.setGap(1);n.setStartPosition(9,-3);n.setIconSize(16,
16);N(5,5,"icon-tablemodel");n.setStartPosition(12,-2);N(5,6,"icon-relationmodel");n.setStartPosition(11,-2);N(5,7,"icon-entitymodel");N(5,8,"icon-metricmodel");n.setStartPosition(0,117);n.setIconSize(16,16);pa(0,1,"btn-delete");pa(0,2,"btn-edit");pa(0,3,"icon_export");pa(0,4,"icon-coorperation");n.setStartPosition(1,247);n.setIconSize(36,36);N(0,0,"icon-card-subject");n.setStartPosition(0,151);n.setIconSize(170,98);N(0,0,"icon-empty");n.setStartPosition(0,285);n.setIconSize(52,52);N(0,0,"btn-new-image");
N(0,1,"btn-new-image-hover");n.setStartPosition(0,337);n.setIconSize(56,56);N(0,0,"add-user-image");n.setStartPosition(56,337);n.setIconSize(50,50);N(0,0,"icon-preset-big");n.setStartPosition(0,500);n.setIconSize(16,16);pa(0,0,"btn-copy");n.setStartPosition(169,229);n.setIconSize(13,13);N(0,0,"icon-sort");N(0,1,"icon-sort-desc");N(0,2,"icon-sort-asc");n.setStartPosition(0,400);n.setIconSize(138,84);N(0,0,"icon-search-none");n.setStartPosition(196,257);n.setIconSize(14,14);N(0,0,"icon_date");va.define(n,
"no-data.png");n.setStartPosition(0,0);n.setGap(0);n.setIconSize(220,220);N(0,0,"no-data");va.define(n,"model-common2x");n.setGap(1);n.setStartPosition(0,0);n.setIconSize(32,32);pa(0,0,"auth");pa(0,1,"disable");pa(0,2,"enable");pa(0,3,"btn-copy")};var pa=function(va,n,Z){N(va+1,n,Z);N(va,n,Z+"_hover")},N=function(va,n,Z){ia.registIcon(va,n,Z)}};var xa=new function(){var ia;this.hookCollector=function(pa){ia=pa};this.occur=function(pa,N){try{ia&&ia(pa,N)}catch(va){window.console&&console.warn(va)}};
this.getModelSetType=function(pa){var N=com.kingdee.bos.qing.modeler.modelset.ui.ModelSetCard;switch(pa){case N.CREATE:return xa.CREATE_MODELSET;case N.COOPERATION:return xa.COOPERATION_MODELSET;case N.PRESET:return xa.PRESET_MODELSET}};this.getEnableStatus=function(pa){var N=com.kingdee.bos.qing.modeler.modelset.ui.ModelSetCard;switch(pa){case N.DISABLED:return xa.DISABLED;case N.ENABLED:return xa.ENABLED}}};xa.MODELSET_TYPE_WHEN_ENTER_MAIN_PAGE="modelset-type-when-enter-main-page";xa.MODELSET_IS_ENABLE_OR_DISABLE=
"modelset-is-enable-or-disable";xa.CREATE_MODELSET="\u6211\u521b\u5efa\u7684\u6a21\u578b\u96c6";xa.COOPERATION_MODELSET="\u6211\u53c2\u4e0e\u534f\u4f5c\u7684\u6a21\u578b\u96c6";xa.PRESET_MODELSET="\u7cfb\u7edf\u9884\u7f6e\u7684\u6a21\u578b\u96c6";xa.DISABLED="\u7981\u7528";xa.ENABLED="\u542f\u7528";ea.UserOperationReporter=xa})();(function(){function L(){var ba=this,ma,na,qa,xa,ia,pa,N,va,n,Z,Aa,Ia,Ja,M=[],d=[];this.setFId=function(D){ma=D};this.getFId=function(){return ma};this.setCreatorName=function(D){Aa=D};this.getCreatorName=function(){return Aa};this.getCreateTime=function(){return Ia};this.setCreateTime=function(D){Ia=D};this.getUpdateTime=function(){return Ja};this.setUpdateTime=function(D){Ja=D};this.setCreatorId=function(D){Z=D};this.getCreatorId=function(){return Z};this.getUsers=function(){return M};this.setUsers=
function(D){M=D};this.getRoles=function(){return d};this.setRoles=function(D){d=D};this.setModelSetName=function(D){na=D};this.getModelSetName=function(){return na};this.setDescription=function(D){qa=D};this.getDescription=function(){return qa};this.setDisabled=function(D){xa=D};this.getDisabled=function(){return xa};this.setPermission=function(D){ia=D};this.getPermission=function(){return ia};this.setTableModelNum=function(D){pa=D};this.getTableModelNum=function(){return pa};this.setEntityModelNum=
function(D){N=D};this.getEntityModelNum=function(){return N};this.setRelationModelNum=function(D){va=D};this.getRelationModelNum=function(){return va};this.setMetricModelNum=function(D){n=D};this.getMetricModelNum=function(){return n};this.copy=function(){var D=new L;D.setFId(ma);D.setModelSetName(na);D.setDescription(qa);D.setTableModelNum(pa);D.setEntityModelNum(N);D.setRelationModelNum(va);D.setMetricModelNum(n);D.setDisabled(xa);D.setPermission(ia);D.setUsers(M);D.setRoles(d);D.setCreatorId(Z);
D.setCreatorName(Aa);return D};this.fromJsonObject=function(D){ba.setFId(D.modelSetId);ba.setModelSetName(D.modelSetName);ba.setDescription(D.description);ba.setTableModelNum(D.tableModelNum);ba.setEntityModelNum(D.entityModelNum);ba.setRelationModelNum(D.relationModelNum);ba.setMetricModelNum(D.metricModelNum);ba.setDisabled(D.disabled);ba.setPermission(D.permission);ba.setCreatorId(D.creatorId);ba.setCreatorName(D.creatorName);ba.setCreateTime(D.createTime);ba.setUpdateTime(D.modifyTime);ba.setUsers(Na(D.users));
ba.setRoles(Na(D.roles))};this.toJsonObject=function(){var D={};D.modelSetId=ma;D.modelSetName=na;D.description=qa;D.tableModelNum=pa;D.entityModelNum=N;D.relationModelNum=va;D.metricModelNum=n;D.disabled=xa;D.permission=ia;D.creatorId=Z;D.createTime=Ia;D.modifyTime=Ja;D.users=sa(M);D.roles=sa(d);return D};var sa=function(D){var Pa=[];if(D)for(var Oa=0;Oa<D.length;Oa++)Pa.push(D[Oa].toJsonObject());return Pa},Na=function(D){var Pa=[];if(D)for(var Oa=0;Oa<D.length;Oa++){var Qa=new ea;Qa.fromJsonObject(D[Oa]);
Pa.push(Qa)}return Pa}}function ea(){var ba=this,ma,na,qa,xa,ia,pa;this.setPermission=function(N){ia=N};this.getPermission=function(){return ia};this.getValue=function(){return ma};this.setValue=function(N){ma=N};this.setJobId=function(N){qa=N};this.getJobId=function(){return qa};this.getText=function(){return na};this.setText=function(N){na=N};this.getColor=function(){return xa};this.setColor=function(N){xa=N};this.setAvailable=function(N){pa=N};this.isAvailable=function(){return pa};this.toJsonObject=
function(){var N={};N.value=ma;N.text=na;N.jobId=qa;N.color=xa;N.permission=ia;N.isAvailable=pa;return N};this.fromJsonObject=function(N){N&&(N.value&&ba.setValue(N.value),N.text&&ba.setText(N.text),N.jobId&&ba.setJobId(N.jobId),N.color&&ba.setColor(N.color),ba.setAvailable(N.isAvailable),ba.setPermission(N.permission))}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&
(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.model&&(com.kingdee.bos.qing.modeler.modelset.model={});var Y=com.kingdee.bos.qing.modeler.modelset.model;Y.ModelSetInfo=L;Y.ValueTextPair=ea;ea.ADMIN_PERM=0;ea.MEM_PERM=1;ea.CREATOR_PERM=2;L.NAMEEXIST="modelSetNameExist"})();(function(){function L(){Ja.call(this);var y=this,u=this.protectedMethod,v,l,B,w,h,G;this.setGlobal=function(X){v=X};this.setRootNode=function(X){B=X};this.setMessageCurtain=function(X){w=X};this.showExportDialog=function(){y.setSize(640,480);y.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);u.setTitle(M.get("exportModelSet","\u5bfc\u51fa\u6a21\u578b\u96c6"));u.setContentPaneCreator(O);u.setClosingChecker(y.isValidToAccepted,!0);u.setClosingAction(m);y.showDialog()};var m=function(X){if(X){X=
l.getCheckedModelSetNodes();var Q={},fa=[];for(i=0;i<X.length;i++)fa.push(X[i].getId());Q[L.MODEL_SET_LIST]=fa;U(Q)}},O=function(){var X=$("<div>"),Q=X.append;h=new Ia;h.addSearchListener(T);h.setSearchListenerDelay(400);h.setPlaceholder(M.get("searchModelSet","\u641c\u7d22\u6a21\u578b\u96c6\u540d\u79f0"));h.setShowSearchIcon(!0);var fa=h.getJqUi();fa.addClass("modelset-imexport-search-box");Q.call(X,fa);Q=X.append;fa=new Na;fa.setChecked(!1);fa.addCheckedListener(ka);fa.setText(M.get("showOnlyChecked",
"\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));fa=fa.getJqUi();fa.addClass("modelset-export-show-only-checked-box");d.layoutCtrl(fa,250,2,200,23);Q.call(X,fa);l=new ea(B);Q=l.getJqUi();X.append(Q);return X},T=function(X){G=h.getText().trim();l.searchKey(G)},ka=function(X,Q){Q&&(l.setShowOnlyChecked(X.isChecked()),l.searchKey(G))};this.isValidToAccepted=function(X){0===l.getCheckedModelSetNodes().length?(u.getMessageCurtain().showPrompt(M.get("selectNone","\u672a\u9009\u4e2d\u6a21\u578b\u96c6\u3002")),X(!1)):
X(!0)};var U=function(X){v.createFacade(function(Q){v.createFacade().getExportedData(Q)},function(Q,fa){return 20009002===Q?(w.showPrompt(M.get("publicSourceException","\u5bfc\u51fa\u5931\u8d25\uff0c\u516c\u5171\u6570\u636e\u6e90\u5f02\u5e38\u3002"),2E3),!0):20009001===Q?(w.showPrompt(M.get("invalidPermissionException","\u6743\u9650\u68c0\u67e5\u5931\u8d25\u3002"),2E3),!0):20009008===Q?(Q=M.get("exportModelSetCorruptionException","\u5bfc\u51fa\u6a21\u578b\u201c#1\u201d\u5931\u8d25\uff0c\u6a21\u578b\u6570\u636e\u635f\u574f\u6216\u6570\u636e\u7248\u672c\u4e0d\u517c\u5bb9\u3002").replace("#1",
fa),w.showPrompt(Q,2E3),!0):!1}).confirmExportModelSet(X)}}function ea(y){function u(){KTDefaultCellRender.call(this,ka);var e=this;this.paintCellUI=function(a,c){var q=e.getCurrentRow().getUserObject(),f=q.getName();a=$("<div>");a.addClass("modelset-export-area-list-item");var C=new Na,p=C.getJqUi(),H=$("<div>");p.addClass("modelset-export-area-list-item-checkbox");H.addClass("modelset-export-area-list-item-text");a.append(p);a.append(H);C.setChecked(q.isChecked());C.setUserObject(q);C.addCheckedListener(ta);
O[q.getId()]=C;if(0===q.getSubNodeLevel())H.text(f);else if(f=q.getName(),T&&f){C=T.toUpperCase();p=f.toUpperCase();var A=p.split(C),z=C.length,x;for(x in A){var E=p.indexOf(A[x]),aa=f.substr(k,A[x].length);E+=A[x].length;var R=p.length-E;p=p.substr(E,R);f=f.substr(E,R);E=$("<span>");E.text(aa);E.appendTo(H);if(x!==A.length-1&&1<A.length){var k=p.indexOf(C);aa=f.substr(k,z);E=k+z;R=p.length-E;p=p.substr(E,R);f=f.substr(E,R);E=$("<span>");E.text(aa);E.css("color","red");E.clone().appendTo(H)}}}else H.text(f);
q instanceof ia||(H.addClass("modelset-export-model-name-label"),a.append(Qa.createIcon(q.getModelSetType(),"modelset-export-model-icon")));c?(c=$(c),c.css("overflow","visible"),a.appendTo(c)):a.appendTo(jqDiv);d.layoutCtrlWithLRTB(a,0,0,null,0,0,null)}}var v=this,l,B=[],w=[],h=[],G=!1,m=!1,O,T,ka,U,X,Q;this.setShowOnlyChecked=function(e){m=e};this.getCheckedModelSetNodes=function(){var e,a=[];for(e=0;e<h.length;e++){var c=h[e];c.isChecked()&&a.push(c)}return a};this.getJqUi=function(){l||(fa(),l=
$("<div>"),l.addClass("modelset-export-area"),l.addClass("modelset-export-tree-selection-area"),X=$("<div>"),X.addClass("modelset-export-tree-selection-area-checked-prompt"),X.css("color","#666"),d.layoutCtrlWithLRTB(X,0,null,200,0,null,23),X.prependTo(l),U=ya(),l.append(U),Ga(),ra());return l};var fa=function(){var e=function(q){B.push(q);if(q instanceof N)h.push(q);else if(w.push(q),(q=q.getChildren())&&0<q.length)for(var f=0;f<q.length;f++)e(q[f])},a=y.getChildren();if(a&&0<a.length)for(var c=
0;c<a.length;c++)e(a[c])},ya=function(){ka=new KTable;var e=$(ka.getUI());e.children().css("overflow-x","hidden");var a=new u;ka.setCellRender(a);ka.setSyncUIWhenModelChanged(!1);ka.addTreeExpandListener(La);ka.addColumn().setWidth(400);d.layoutCtrlWithLRTB(e,0,0,null,23,0,null);return e},La=function(e,a){(e=ka.getRow(a.getRowIdx()).getUserObject())&&e.setExpanded(a.isExpanded())};this.searchKey=function(e){var a;T=e;G=!!T;for(a=0;a<h.length;a++){var c=h[a];var q=c.isChecked();if(e){var f=-1<c.getName().toUpperCase().indexOf(T.toUpperCase());
q=m?f&&q:f}else q=m?c.isChecked():!0;c.setVisible(q)}v.updateUi()};var Ma=function(){var e=function(a){var c=!0,q=!1;if(a instanceof ia){var f=a.getChildren();if(f&&0<f.length)for(var C=0;C<f.length;C++){var p=f[C];e(p);p.isVisible()&&(c=c&&p.isChecked());q=q||p.isVisible()}}else c=c&&a.isChecked(),q=q||a.isVisible();a.setVisible(q);a.setChecked(c)};e(y)};this.updateUi=function(){for(var e=!1,a=0;a<h.length;a++)e=e||h[a].isVisible();e?(Q&&Q.hide(),U&&U.remove(),U=ya(),l.append(U),Ga()):(Q||(Q=$("<div>"),
(new Oa).getJqUi().appendTo(Q),l.append(Q)),Q.show(),U.hide())};var Ga=function(){Ma();O={};for(var e=0;e<B.length;e++){var a=B[e];if(a.isVisible()){var c=sa.createRow(ka,!1),q=c.getCell(0),f=a.getSubNodeLevel();f=new KTCellTreeModel(f);c.setHeight(23);c.setUserObject(a);a instanceof ia?(a=G?!0:a.isExpanded(),f.setExpanded(a)):(a=a.getParentNode(),a=G?!0:a.isExpanded(),c.setHide(!a));q.setTreeModel(f)}}ka.updateUI()},ra=function(){for(var e=0,a=0;a<h.length;a++)h[a].isChecked()&&e++;e=M.get("checkedNumberPrompt",
"(\u5df2\u9009\u62e9 #1 \u9879)").replace("#1",e);X.text(e)},ta=function(e,a){if(a){e.getUserObject().check(e.isChecked(),b);for(e=0;e<B.length;e++)if(a=B[e],a.isVisible()){var c=O[a.getId()];c&&c.setChecked(a.isChecked())}ra()}},b=function(e){for(var a=!0,c=e.getChildren(),q=0;q<c.length;q++){var f=c[q];f.isVisible()&&(a=a&&f.isChecked())}e.setChecked(a);(e=e.getParentNode())&&b(e)}}function Y(){function y(B){KTDefaultCellRender.call(this,B);var w=this,h=this.paintCellUI;this.paintCellUI=function(m,
O){w.getCurrentRowIdx()<sa.getHeadRowCount()?h(m,O):($(m),2===w.getCurrentColIdx()?G(m,w.getCellWidth(),w.getCellHeight(),w.getCurrentRow()):h(m,O))};var G=function(m,O,T,ka){m=sa.createCtrlInCell(m,O,T,Z);m.setSelected(ka.getUserObject().strategy);"otherUserConflict"===ka.getUserObject().conflictType?m.setItemModels(Y.RENAME_CONFLICTTYPE):m.setItemModels(Y.ALL_CONFLICTTYPE);m.setUserObject(ka);m.setCustomPainter(function(U,X,Q){switch(Q){case Y.ALL_CONFLICTTYPE[0]:U=M.get("ignore","\u5ffd\u7565");
break;case Y.ALL_CONFLICTTYPE[1]:U=M.get("overwrite","\u8986\u76d6");break;case Y.ALL_CONFLICTTYPE[2]:U=M.get("rename","\u91cd\u547d\u540d");break;default:U=""}Q=$("<div>");Q.text(U);Q.appendTo(X)});m.addSelectedChangedListener(function(U,X,Q){U.getUserObject().getUserObject().strategy=Q})}}var u=this,v,l;this.getConflictModelList=function(){return l};this.getJqUi=function(B){v=sa.createTable();sa.bindTableListenerForCtrl(v);var w=new y(v);w.setOutsideVisible(!1);v.setCellRender(w);v.addColumns(3);
v.getColumn(0).setWidth(100);v.getColumn(1).setWidth(260);v.getColumn(2).setWidth(180);w=sa.createHeadRow(v);w.getCell(0).setValue(M.get("modelSetColName","\u6a21\u578b\u96c6\u540d\u79f0"));w.getCell(1).setValue(M.get("modelSetColDesc","\u6a21\u578b\u96c6\u63cf\u8ff0"));w.getCell(2).setValue(M.get("strategyCol","\u5904\u7406\u7b56\u7565"));l=B;for(var h in B)l[h].strategy=Y.ALL_CONFLICTTYPE[2];u.updateUi(B);sa.refresh(v);B=$(v.getUI());B.addClass("modelset-import-selection-table");return B};this.updateUi=
function(B){sa.clearWithoutHead(v);sa.refresh(v);for(var w,h=0;h<B.length;h++){var G=B[h];w=sa.createRow(v);w.setUserObject(G);w.getCell(0).setValue(G.modelSetName);w.getCell(1).setValue(G.desc);w.getCell(2).setValue(G.strategy)}sa.refresh(v)};this.refresh=function(){sa.refresh(v)}}function ba(y){Ja.call(this);var u=this,v=this.protectedMethod,l=[],B,w,h,G,m;this.setGlobal=function(U){B=U};this.setFunRefreshModelGroup=function(U){h=function(){y.showSuccess(M.get("importModelSetSuccess","\u6a21\u578b\u96c6\u5bfc\u5165\u6210\u529f\u3002"));
U()}};this.addConfirmListener=function(U){l.push(U)};this.createUi=function(U,X){u.setSize(640,480);u.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);v.setTitle(M.get("importModelSet","\u5bfc\u5165\u6a21\u578b\u96c6"));v.setContentPaneCreator(function(){var Q=$("<div>"),fa=Q.append;G=new Ia;G.addSearchListener(O);G.setSearchListenerDelay(400);G.setPlaceholder(M.get("searchModelSet","\u641c\u7d22\u6a21\u578b\u96c6\u540d\u79f0"));G.setShowSearchIcon(!0);var ya=G.getJqUi();ya.addClass("modelset-imexport-search-box");
fa.call(Q,ya);fa=Q.append;ya=new Na;ya.setChecked(!1);ya.addCheckedListener(T);ya.setText(M.get("showOnlyChecked","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));ya=ya.getJqUi();d.layoutCtrl(ya,250,2,200,23);fa.call(Q,ya);w=new ea(X);fa=w.getJqUi();fa.addClass("modelset-export-tree-selection-area");Q.append(fa);return Q});v.setClosingChecker(u.isValidToAccepted,!0);v.setClosingAction(function(Q){if(Q&&(Q=w.getCheckedModelSetNodes(),0!==Q.length)){for(var fa=[],ya=0;ya<Q.length;ya++)fa.push(Q[ya].toJsonObject());
ka(U,fa)}});u.showDialog()};var O=function(){m=G.getText().trim();w.searchKey(m)},T=function(U,X){X&&(w.setShowOnlyChecked(U.isChecked()),w.searchKey(m))};this.isValidToAccepted=function(U){0===w.getCheckedModelSetNodes().length?(v.getMessageCurtain().showPrompt(M.get("selectNone","\u672a\u9009\u4e2d\u6a21\u578b\u96c6\u3002")),U(!1)):U(!0)};var ka=function(U,X){B.createFacade(function(Q){var fa=Q.conflictModelSet,ya=Q.numberConflictModel;if(0<fa.length){ya=X.length-fa.length;var La=new ma;La.setCacheImportMapIdKey(Q.cacheMapIdKey);
La.setGlobal(B);La.setFunRefreshModelGroup(h);La.setArrNumberConflictModel(Q.numberConflictModel);La.createUi(U,fa,ya);La.repaint()}else 0<ya.length?(Q=new na,Q.setFunRefreshModelGroup(h),Q.createUi(ya),Q.repaint()):h&&h()},function(Q,fa){return 1020101===Q||1100021===Q?(y.showPrompt(M.get("resourceFileLimit","\u5bfc\u5165\u5931\u8d25\uff0c\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002"),2E3),!0):20009004===Q?(y.showPrompt(M.get("resourceFileIncomplete","\u5bfc\u5165\u5931\u8d25\uff0c\u6570\u636e\u5305\u4e0d\u5b8c\u6574\u3002"),
2E3),!0):20009008===Q?(y.showPrompt(M.get("importModelSetCorruptionException","\u5bfc\u5165\u5931\u8d25\uff0c\u6570\u636e\u6a21\u578b\u635f\u574f\u3002"),2E3),!0):20004001===Q?(y.showPrompt(M.get("MaterializedExceptionForImport","\u5bfc\u5165\u5931\u8d25\uff0c\u6a21\u578b\u7269\u5316\u5b58\u50a8\u8bbe\u7f6e\u89e3\u6790\u5f02\u5e38\u3002"),2E3),!0):30001001===Q?(y.showPrompt(M.get("noDataWarehouseConfigForImport","\u5f53\u524d\u73af\u5883\u672a\u914d\u7f6e\u201c\u8f7b\u6570\u4ed3\u6570\u636e\u6e90\u201d\u53c2\u6570\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5728MC\u4e2d\u8fdb\u884c\u914d\u7f6e\u3002"),
2E3),!0):30001002===Q?(y.showPrompt(M.get("dataWarehouseConfigParseException","\u201c\u8f7b\u6570\u4ed3\u6570\u636e\u6e90\u201d\u53c2\u6570\u89e3\u6790\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5728MC\u4e2d\u91cd\u65b0\u914d\u7f6e\u3002"),2E3),!0):!1}).importSelectedModelSet(U,X,!0,"")}}function ma(){Ja.call(this);var y=this,u=this.protectedMethod,v=[],l,B,w,h,G,m,O,T,ka,U,X=[];this.setCacheImportMapIdKey=function(ra){U=ra};this.setGlobal=function(ra){l=ra};this.setFunRefreshModelGroup=
function(ra){ka=ra};this.setArrNumberConflictModel=function(ra){X=ra};this.addConfirmListener=function(ra){v.push(ra)};this.createUi=function(ra,ta,b){G=ra;m=ta;T=b;y.setSize(640,480);y.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);u.setTitle(M.get("importModelSet","\u5bfc\u5165\u6a21\u578b\u96c6"));u.setContentPaneCreator(function(){var e=$("<div>"),a=M.get("importSuccessPrompt","\u6210\u529f\u5bfc\u5165#1\u4e2a\u6a21\u578b\u96c6\u3002\u4ee5\u4e0b\u6a21\u578b\u96c6\u540d\u79f0\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002").replace("#1",
b);a=new D(a);B=new Aa(M.get("allIgnore","\u5168\u90e8\u5ffd\u7565"));w=new Aa(M.get("allOverwrite","\u5168\u90e8\u8986\u76d6"));h=new Aa(M.get("allRename","\u5168\u90e8\u91cd\u547d\u540d"));B.addActionListener(fa);w.addActionListener(ya);h.addActionListener(La);a=a.getJqUi();var c=B.getJqUi(),q=w.getJqUi(),f=h.getJqUi();a.addClass("modelset-import-selection-prompt");c.addClass("modelset-import-selection-ignore-btn");q.addClass("modelset-import-selection-overwrite-btn");f.addClass("modelset-import-selection-rename-btn");
e.append(a);e.append(c);e.append(q);e.append(f);O=new Y;e.append(O.getJqUi(ta));return e});u.setClosingChecker2(y.isValidToAccepted,Q,!0);u.setClosingAction(function(e){!e&&X&&0<X.length&&Ga()});y.showDialog()};var Q=function(ra){ra(!0);0<T&&0==X.length&&ka&&ka()};this.repaint=function(){O.refresh()};var fa=function(){for(var ra in m)m[ra].strategy=Y.ALL_CONFLICTTYPE[0];O.updateUi(m)},ya=function(){for(var ra in m)"otherUserConflict"!==m[ra].conflictType&&(m[ra].strategy=Y.ALL_CONFLICTTYPE[1]);O.updateUi(m)},
La=function(){for(var ra in m)m[ra].strategy=Y.ALL_CONFLICTTYPE[2];O.updateUi(m)};this.isValidToAccepted=function(ra){Ma(G,m,ra)};var Ma=function(ra,ta,b){var e=[],a;for(a in ta)"ignore"!==ta[a].strategy&&(e=e.concat(ta[a]));0===e.length?b(!0):l.createFacade(function(c){b(!0);X=X.concat(c.numberConflictModel);0==X.length?ka&&ka():Ga()},function(c,q){return 1020101===c||1100021===c?(u.getMessageCurtain().showPrompt(M.get("resourceFileLimit","\u5bfc\u5165\u5931\u8d25\uff0c\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002"),
2E3),!0):20009008===c?(u.getMessageCurtain().showPrompt(M.get("importModelSetCorruptionException","\u5bfc\u5165\u5931\u8d25\uff0c\u6570\u636e\u6a21\u578b\u635f\u574f\u3002"),2E3),!0):20004001===c?(u.getMessageCurtain().showPrompt(M.get("MaterializedExceptionForImport","\u5bfc\u5165\u5931\u8d25\uff0c\u6a21\u578b\u7269\u5316\u5b58\u50a8\u8bbe\u7f6e\u89e3\u6790\u5f02\u5e38\u3002"),2E3),!0):30001001===c?(u.getMessageCurtain().showPrompt(M.get("noDataWarehouseConfigForImport","\u5f53\u524d\u73af\u5883\u672a\u914d\u7f6e\u201c\u8f7b\u6570\u4ed3\u6570\u636e\u6e90\u201d\u53c2\u6570\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5728MC\u4e2d\u8fdb\u884c\u914d\u7f6e\u3002"),
2E3),!0):30001002===c?(u.getMessageCurtain().showPrompt(M.get("dataWarehouseConfigParseException","\u201c\u8f7b\u6570\u4ed3\u6570\u636e\u6e90\u201d\u53c2\u6570\u89e3\u6790\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5728MC\u4e2d\u91cd\u65b0\u914d\u7f6e\u3002"),2E3),!0):!1}).importSelectedModelSet(ra,e,!1,U)},Ga=function(){u.destroy();var ra=new na;ra.setFunRefreshModelGroup(ka);ra.createUi(X);ra.repaint()}}function na(){Ja.call(this);var y=this,u=this.protectedMethod,v,l;this.setFunRefreshModelGroup=
function(B){l=B};this.createUi=function(B){y.setSize(640,480);y.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);u.setTitle(M.get("importModelSet","\u5bfc\u5165\u6a21\u578b\u96c6"));u.setContentPaneCreator(function(){var w=$("<div>"),h=M.get("modelNumberConflictPrompt","\u4ee5\u4e0b\u6a21\u578b\u4e0e\u5176\u4ed6\u6a21\u578b\u96c6\u7684\u6a21\u578b\u5b58\u5728\u6a21\u578b\u7f16\u7801\u51b2\u7a81\uff0c\u5df2\u5c06\u6a21\u578b\u7f16\u7801\u91cd\u547d\u540d\u3002");h=(new D(h)).getJqUi();
h.addClass("modelset-import-selection-prompt");w.append(h);v=new qa;w.append(v.getJqUi(B));return w});u.setFooterPaneCreator(function(w){var h=new Pa(M.get("iSee","\u6211\u77e5\u9053\u4e86"));h.addActionListener(function(G){u.destroy();l&&l()});h=h.getJqUi();h.addClass("sa-ctrl-dialog-footer-cancel");h.css("margin-left","-50px");h.appendTo(w)});u.setClosingAction(function(w){u.destroy();l&&l()});y.showDialog()};this.repaint=function(){v.refresh()}}function qa(){function y(l){KTDefaultCellRender.call(this,
l);var B=this,w=this.paintCellUI;this.paintCellUI=function(h,G){if(B.getCurrentRowIdx()<sa.getHeadRowCount())w(h,G);else if(0===B.getCurrentColIdx()){var m=B.getCurrentRow();G=$("<div>");var O=$("<div>");G.addClass("modelset-export-conflict-item-text");m=m.getUserObject();G.addClass("modelset-export-conflict-model-name-label");G.text(m.modelName);O.append(Qa.createModelIcon(m.modelType,"modelset-export-conflict-model-icon"));O.append(G);O.appendTo(h)}else w(h,G)}}var u=this,v;this.getJqUi=function(l){v=
sa.createTable();sa.bindTableListenerForCtrl(v);var B=new y(v);B.setOutsideVisible(!1);v.setCellRender(B);v.addColumns(4);v.getColumn(0).setWidth(150);v.getColumn(1).setWidth(150);v.getColumn(2).setWidth(120);v.getColumn(3).setWidth(120);B=sa.createHeadRow(v);B.getCell(0).setValue(M.get("modelName","\u6a21\u578b\u540d\u79f0"));B.getCell(1).setValue(M.get("modelSource","\u6765\u6e90"));B.getCell(2).setValue(M.get("modelNumber","\u6a21\u578b\u7f16\u7801"));B.getCell(3).setValue(M.get("renameModelNumber",
"\u91cd\u547d\u540d\u540e\u7684\u6a21\u578b\u7f16\u7801"));u.updateUi(l);sa.refresh(v);l=$(v.getUI());l.addClass("modelset-import-model-number-table");return l};this.refresh=function(){sa.refresh(v)};this.updateUi=function(l){sa.clearWithoutHead(v);for(var B,w=0;w<l.length;w++){var h=l[w];B=sa.createRow(v);B.getCell(1).setValue(h.modelSetName);B.getCell(2).setValue(h.oldModelNumber);B.getCell(3).setValue(h.newModelNumber);B.setUserObject(h)}sa.refresh(v)}}function xa(){var y,u,v,l,B=!1,w=!0;this.setName=
function(h){y=h};this.getName=function(){return y};this.setId=function(h){u=h};this.getId=function(){return u};this.setIsPreset=function(h){v=h};this.isPreset=function(){return v};this.setParentNode=function(h){l=h};this.getParentNode=function(){return l};this.setChecked=function(h){B=h};this.isChecked=function(){return B};this.setVisible=function(h){w=h};this.isVisible=function(){return w};this.getSubNodeLevel=function(){for(var h=-1,G=l;G;)h++,G=G.getParentNode();return h};this.check=function(h){};
this.protectedMethod={fromJsonObject:function(h){},toJsonObject:function(){return{}}}}function ia(){xa.call(this);var y=this,u=this.protectedMethod,v=!0,l=[];this.setExpanded=function(h){v=h};this.isExpanded=function(){return v};this.setChildren=function(h){l=h};this.getChildren=function(){return l};this.setParentId=function(h){_sParentId=h};this.getParentId=function(){return _sParentId};var B=function(h){switch(h){case ia.CREATE:return M.get("createdOfModelSet","\u6211\u521b\u5efa\u7684\u6a21\u578b\u96c6");
case ia.COOPERATION:return M.get("cooperationOfModelSet","\u6211\u53c2\u4e0e\u534f\u4f5c\u7684\u6a21\u578b\u96c6");case ia.PRESET:return M.get("preSetOfModelSet","\u5f53\u524d\u7cfb\u7edf\u9884\u7f6e\u7684\u6a21\u578b\u96c6");case ia.ALL:return M.get("allOfModelSet","\u5168\u90e8");default:return h}},w=function(h){switch(h){case ia.CREATE:return"1";case ia.COOPERATION:return"2";case ia.PRESET:return"3";case ia.ALL:return"4";default:return h}};this.fromJsonObject=function(h){u.fromJsonObject(h);y.setName(B(h.name));
y.setId(w(h.name));var G=h.modelSetList;if(G&&0<G.length)for(var m=0;m<G.length;m++){var O=G[m],T=new N;T.fromJsonObject(O);T.setParentNode(y);l.push(T)}if((h=h.children)&&0<h.length)for(m=0;m<h.length;m++)G=h[m],T=new ia,T.fromJsonObject(G),T.setParentNode(y),l.push(T)};this.toJsonObject=function(){return u.toJsonObject()};this.check=function(h,G){if(0!==l.length&&h!==y.isChecked()){y.setChecked(h);for(var m=0;m<l.length;m++){var O=l[m];O.isVisible()&&O.check(h,G)}}}}function pa(){xa.call(this);
var y=this,u=this.protectedMethod,v;this.setModelSetType=function(l){v=l};this.getModelSetType=function(){return v};this.protectedMethod={fromJsonObject:function(l){u.fromJsonObject(l);y.setId(l.modelSetId);y.setName(l.modelSetName);y.setModelSetType("")},toJsonObject:function(){var l=u.toJsonObject();y.getParentNode();l.modelSetId=y.getId();l.modelSetName=y.getName();l.modelSetType=v;return l}};this.check=function(l,B){l!==y.isChecked()&&(y.setChecked(l),B&&B(y.getParentNode()))}}function N(){pa.call(this);
var y=this.protectedMethod;this.fromJsonObject=function(u){y.fromJsonObject(u)};this.toJsonObject=function(){return y.toJsonObject()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.imexport&&(com.kingdee.bos.qing.modeler.modelset.imexport={});var va=com.kingdee.bos.qing.modeler.modelset.imexport;va.ExportDialog=L;va.UploadPane=function(){var y,u,v;this.createJqUi=function(G,m,O){y=O;O=$("<div>");O.addClass("modelset-importing-exporting-main");var T=$(document.body),ka=$("<div class='sa-ctrl-modallayer'>");ka.appendTo(T);u=$("<progress value='0' max='100'>");u.addClass("modelset-importing-upload-progress");var U=$("<div>");
U.addClass("modelset-importing-exporting-text");U.text(M.get("uploading","\u6b63\u5728\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u5019"));O.append(u);O.append(U);T.append(O);l(G,m,O,ka)};var l=function(G,m,O,T){var ka=new FormData;ka.append("filename",G);G=com.kingdee.bos.qing.framework.common.RemoteFrameworkRegister.getUploadUrl();var U=new XMLHttpRequest;U.upload.addEventListener("progress",B,!1);U.addEventListener("error",w,!1);U.open("post",G,!0);U.onload=function(X){200===this.status&&(X=JSON.parse(this.response),
"number"==typeof X.errorCode&&3099003===X.errorCode?y.showError(X.errorMessage):h(X.data,m),O.remove(),T.remove())};U.send(ka)},B=function(G){var m=u.get(0);G.lengthComputable&&(m.max=G.total,m.value=G.loaded)},w=function(G){_funErrorCallbackEvent&&_funErrorCallbackEvent(M.get("uploadFail","\u4e0a\u4f20\u5931\u8d25"))},h=function(G,m){m.createFacade(function(O){var T=new ia;T.fromJsonObject(O);0!==T.getChildren().length?(O=new ba(y),O.setGlobal(m),O.setFunRefreshModelGroup(v),O.createUi(G,T)):y.showPrompt(M.get("noModelSet",
"\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u6a21\u578b\u96c6\u3002"))},function(O,T){return!1}).getEnableImportModelSet(G)};this.setFunRefreshModelGroup=function(G){v=G}};va.FolderNode=ia;var n,Z,Aa,Ia,Ja,M,d,sa,Na,D,Pa,Oa;(function(){var y=com.kingdee.bos.qing.modeler.modelset.common;n=y.Icons;y=com.kingdee.bos.qing.ui.component;Z=y.ComboBox;Aa=y.WorkButton;D=y.Label;Pa=y.Button;Ia=y.SearchBox;Na=y.CheckBox;Ja=y.AbstractModalDialog;y=com.kingdee.bos.qing.framework.common;M=y.MultilanguageManager.createPackageAccessor(va);
y=com.kingdee.bos.qing.common.ui;sa=y.TableUtil;y=com.kingdee.bos.qing.modeler.common.ui;Oa=y.SearchNoDataContainer;y=com.kingdee.bos.qing.common;d=y.DomUtil})();L.MODEL_SET_LIST="modelSetList";Y.ALL_CONFLICTTYPE=["ignore","overwrite","rename"];Y.RENAME_CONFLICTTYPE=["ignore","rename"];Y.ALL_PUBLISHCONFLICTTYPE=["noDisposal","overwrite"];ia.CREATE="CREATE";ia.COOPERATION="COOPERATION";ia.PRESET="PRESET";ia.ALL="ALL";var Qa=new function(){this.createIcon=function(y,u){y=$("<span>");y.addClass(u);n.background(y,
"icon-modelset");return y};this.createModelIcon=function(y,u){var v=$("<span>");v.addClass(u);switch(y){case "1":y="icon-tablemodel";break;case "2":y="icon-entitymodel";break;case "3":y="icon-relationmodel";break;case "4":y="icon-metricmodel";break;default:y=""}n.background(v,y);return v}}})();(function(){function L(u,v,l){N.AbstractTabPane.call(this);var B;this.getTitle=function(){switch(u){case L.TYPE_DW_STORAGE:return d.get("dwStorageDetail","\u8f7b\u6570\u4ed3\u5b58\u50a8\u8be6\u60c5");case L.TYPE_SCHEDULE:return d.get("scheduleDetail","\u8c03\u5ea6\u4efb\u52a1\u8be6\u60c5");default:throw Error("unknown type.");}};this.getJqUi=function(){if(!B){B=$("<div>");if(L.TYPE_DW_STORAGE===u){var w=new ea;w.setGlobal(v);w.setPublic(l);w.getJqUi().appendTo(B)}L.TYPE_SCHEDULE===u&&(w=new Y,w.setGlobal(v),
w.getJqUi().appendTo(B))}return B}}function ea(){function u(a,c){KTDefaultCellRender.call(this,a);var q=this,f=this.paintCellUI;this.paintCellUI=function(H,A){var z=q.getCurrentRowIdx(),x=q.getCurrentRow(),E=q.getCurrentColIdx();q.setPaddingHV(8,1);if(1===z)f(H,A),C(z,E,H,c),3===E&&(A=new xa,A.setIconType(xa.ICON_TYPE_QUESTION),A.setTipsText(d.get("pathTips","\u8def\u5f84\u683c\u5f0f\u4e3a\uff1a\u6a21\u578b\u96c6\u540d\u79f0/\u76ee\u5f55\u540d\u79f0\u3002\u76ee\u5f55\u53ef\u80fd\u5b58\u5728\u591a\u5c42\u7ea7\uff0c\u5404\u5c42\u7ea7\u4e4b\u95f4\u7531\u201c/\u201d\u5206\u9694\u3002")),
A.setTipsSize(310,60),A=A.getJqUi(),M.layoutCtrlWithLRTB(A,($(H).outerWidth()>>1)+((new Ia).measureWidth(d.get("path","\u8def\u5f84"))>>1)+8,null,null,4,null,null),A.appendTo($(H)));else if(2<z&&(0===E||1===E)){A=$("<span>");A.css({"padding-right":"8px","padding-left":"8px","line-height":"28px"});var aa=x.getCell(E).getValue(),R=b();y(A,R,aa);A.appendTo(H)}else 2<z&&6===E?p(H,c,z,E):f(H,A);2<z&&6!==E&&$(H).find("span").attr("title",x.getCell(E).getValue())};var C=function(H,A,z,x){m||4!==A||(m=new ma,
m.setFunSortChangeListener(function(E){e(E,x,A)}),m.addDefaultSortingTips($(z),x[A]));m&&3!==A&&6!==A&&m.addSortingTips($(z),x[A])},p=function(H,A,z,x){if(A&&"operation"===A[x]&&(A=l.getRow(z).getUserObject())){var E=A.modelSetId,aa=A.modelSetName,R=A.modelId,k=A.modelType,I=A.modelName;H=$(H);A=$("<div>");A.text(d.get("open","\u6253\u5f00"));A.addClass("modelset-resourceinfo-open-link");A.appendTo(H);A.on("click",function(V){V.stopPropagation();Pa.getModelDesignerPageEntrance()(E,aa,R,k,I)})}}}var v,
l,B,w,h,G,m,O,T=new Oa,ka,U=new function(){var a=0,c=0,q="0KB",f=0,C=[];this.getTotalRow=function(){return a};this.getDWStorageSize=function(){return c};this.getTenantUsedSize=function(){return q};this.getTenantUsedSizePercent=function(){return f};this.getDetails=function(){return C};this.fromJsonObject=function(p){a=p.totalRow;c=p.dwStorageSize;q=p.tenantUsedSize;f=p.tenantUsedSizePercent;C=p.infos}},X=[d.get("modelNumber","\u6a21\u578b\u7f16\u7801"),d.get("modelName","\u6a21\u578b\u540d\u79f0"),
d.get("modelType","\u6a21\u578b\u7c7b\u578b"),d.get("path","\u8def\u5f84"),d.get("materializedStorageSize","\u7269\u5316\u5b58\u50a8\u7a7a\u95f4"),d.get("createTime","\u521b\u5efa\u65f6\u95f4"),d.get("operate","\u64cd\u4f5c")],Q="modelNumber modelName modelType path size createTime operation".split(" ");this.getJqUi=function(){v||(v=$("<div>"),v.css({position:"absolute",width:"100%",height:"100%"}),fa(),ya());return v};this.setGlobal=function(a){B=a};this.setPublic=function(a){ka=a};var fa=function(){T.setJumpToPageListener(function(a,
c,q){var f=B.createFacade(function(H){Ma(H,q)},function(H,A){return!1}),C=ra(),p=b();f.setShowBlocking(!0);f.setBlockingJqUi(v);f.getAllDWResourceInfoList(a,c,C.getField(),C.getOrder(),p)});T.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);v.append(T.getJqUi())},ya=function(){var a=B.createFacade(function(f){f&&U.fromJsonObject(f);T.resetPaginationAndJumpToFirstPage(U.getTotalRow());La()},function(f,C){return!1}),c=ra(),q=b();a.setShowBlocking(!0);a.setBlockingJqUi(v);a.getAllDWResourceInfoList(1,
T.getPageSize(),c.getField(),c.getOrder(),q)},La=function(){if(!O){O=new ba;O.setSearchListener(ta);var a=O.getJqUi();M.layoutCtrl(a,575,0,192,25);a.appendTo(v)}if(!l){l=sa.createTable();h=$(l.getUI());l.addColumns(X.length);l.getColumn(0).setWidth(130);l.getColumn(1).setWidth(130);l.getColumn(2).setWidth(110);l.getColumn(3).setWidth(198);l.getColumn(4).setWidth(130);l.getColumn(5).setWidth(132);l.getColumn(6).setWidth(70);a=sa.createHeadRow(l);for(var c=0;c<X.length;c++)a.getCell(c).setValue(X[c]);
a=new u(l,Q);a.setOutsideVisible(!1);l.setCellRender(a);l.setCellAcrossListener(function(C,p,H){m&&m.hideLastShowSortTips();1===p&&3!==H&&6!==H&&(m||(m=new ma,m.setFunSortChangeListener(function(A){e(A,Q,H)})),m.showSortingTips(C,Q[H]))});M.layoutCtrl(h,10,32,910,350);h.appendTo(v)}G||(G=$("<div>"),G.addClass("modelset-resourceinfo-no-search-result"),a=$("<div>"),a.addClass("modelset-resourceinfo-no-search-result-icon"),D.background(a,"icon-search-none"),a.appendTo(G),a=$("<div>"),a.addClass("modelset-resourceinfo-no-search-result-tips"),
a.text(d.get("noSearchResult","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),a.appendTo(G),G.appendTo(v));G.hide();a=U.getDetails();b()&&0===a.length&&G.show();if(!w){w=$("<div>");c=$("<div>");var q=U.getTenantUsedSizePercent(),f=U.getTenantUsedSize();q="<span style='color: "+(.9>q?"#688BF7":"#FB2323")+";'>"+f+"</span>";f=d.get("usedSpaceWithColon","\u5df2\u4f7f\u7528\u7a7a\u95f4\uff1a")+q;ka&&(f=U.getDWStorageSize(),f=d.get("usedSpaceWithColon","\u5df2\u4f7f\u7528\u7a7a\u95f4\uff1a")+
q+"/"+f+"GB");c.html(f);c.css("display","inline-block");c.appendTo(w);w.addClass("modelset-resourceinfo-used-label");w.appendTo(v);ka&&(q=new xa,q.setIconType(xa.ICON_TYPE_QUESTION),q.setTipsSize(250,105),q.setTipsText(d.get("usedSpaceHelpTips","\u8f7b\u6570\u4ed3\u5b58\u50a8\u662f\u5206\u5e03\u5f0f\u6570\u636e\u4ed3\u5e93\u5b58\u50a8\u7cfb\u7edf\u3002\u8f7b\u5efa\u6a21\u9ed8\u8ba4\u4e3a\u6bcf\u4e2a\u79df\u6237\u63d0\u4f9b50GB\u7684\u8f7b\u6570\u4ed3\u5b58\u50a8\u5bb9\u91cf\u3002\u5bb9\u91cf\u4e0d\u8db3\u65f6\u5c06\u65e0\u6cd5\u751f\u6210\u6a21\u578b\u7684\u7269\u5316\u5b58\u50a8\u6570\u636e\uff0c\u53ef\u8054\u7cfb\u7ba1\u7406\u5458\u52a0\u8d2d\u6269\u5bb9\uff0c\u6269\u5bb9\u90e8\u5206\u5728\u5f53\u524d\u79df\u6237\u5185\u5171\u4eab\u3002")),
q=q.getJqUi(),M.layoutCtrl(q,c.width()+3,0,16,16),q.appendTo(w))}Ga(a,Q)},Ma=function(a,c){a&&U.fromJsonObject(a);c?c(U.getTotalRow()):T.refreshPagination();a=U.getDetails()?U.getDetails():[];Ga(a,Q)},Ga=function(a,c){l.setSyncUIWhenModelChanged(!1);sa.clearWithoutHead(l);for(var q=0;q<a.length;q++)for(var f=sa.createRow(l),C=0;C<c.length;C++){var p=a[q][c[C]];switch(c[C]){case "createTime":p=a[q].displayCreateTime;f.getCell(C).setValue(p);break;case "modelType":f.getCell(C).setValue(Qa.modelTypeTransformName(p));
break;case "operation":f.setUserObject(a[q]);break;default:f.getCell(C).setValue(p)}}1<l.getRowsCount()&&(a=new KTBorderStyle,a.setLeftBorderWidth(0),l.getRow(1).getCell(0).setBorder(a));l.updateUI(!0);l.setSyncUIWhenModelChanged(!0);h.children(":first-child").children(":first-child").css("width","100%")},ra=function(){var a;m&&(a=m.getShowSortingModel());a||(a=new na,a.setField(Q[4]),a.setOrder(na.ORDER_DESC));return a},ta=function(){ya()},b=function(){return O?O.getInputContent().trim():null},e=
function(a,c,q){var f=b();c=c[q];q=na.ORDER_DESC;a&&(c=a.getField(),q=a.getOrder());a=B.createFacade(function(C){Ma(C,T.resetPaginationAndJumpToFirstPage)},function(C,p){return!1});a.setShowBlocking(!0);a.setBlockingJqUi(v);a.getAllDWResourceInfoList(1,T.getPageSize(),c,q,f)}}function Y(){function u(k,I){this.getTypeName=function(){return k};this.getTypeId=function(){return I}}function v(){var k=this,I,V=$("<input>"),ca,t,S,ja,ua,da,g,J,P,la;this.getStartDate=function(){return t};this.getEndDate=
function(){return S};this.setDateRangeText=function(Ha,F){t=Ha;S=F;V.val(t+"  \uff5e  "+S)};this.getStartDateTimeStamp=function(){return ja};this.getEndDateTimeStamp=function(){return ua};this.setDateRangePanel=function(Ha,F){da.setDateRange(Ha,F)};this.setAfterChangedListener=function(Ha){la=Ha;P.click(la)};this.getJqUi=function(){I||(I=oa());return I};var oa=function(){I=$("<div class='schedule-date-range-box-container'>");var Ha=$("<div>");Ha.appendTo(I);V=$("<input class='schedule-date-range-box-input' type=\"text\" readonly />");
V.appendTo(Ha);ca=$("<span class='schedule-date-range-box_icon'>");D.background(ca,"icon_date");ca.appendTo(Ha);g=$("<div class='schedule-date-range-container'>");var F=$("<div class='schedule-date-range-inner-container'>");da=new Z;F.append(da.getJqUi());var ha=$("<div class='schedule-date-range-box-footer'>");J=new Aa;J.setText(d.get("extraOk","\u786e\u5b9a"));P=J.getJqUi();P.addClass("schedule-date-range-box-footer_ok");J.addActionListener(Ra);var za=new Aa;za.setText(d.get("extraCancel","\u53d6\u6d88"));
var r=za.getJqUi();r.addClass("schedule-date-range-box-footer_cancel");za.addActionListener(Ba);ha.append(P);ha.append(r);ha.appendTo(g);F.appendTo(g);g.appendTo(I);Ha.click(function(){k.setDateRangePanel(ja,ua);g.show()});$(g).on("click",function(K){K.stopPropagation()});$(document).on("click",function(K){$(K.target).is(V)||$(K.target).is(ca)||$.contains(g[0],K.target)||g.hide()});return I},Ba=function(){g.hide()},Ra=function(){var Ha=da.getDateRange();ja=Ha[0];ua=Ha[1];Ha=new Ja;Ha.setFormatString("yyyy-MM-dd");
t=Ha.format(ja);S=Ha.format(ua);k.setDateRangeText(t,S);g.hide()}}function l(k,I){KTDefaultCellRender.call(this,k);var V=this,ca=this.paintCellUI;this.paintCellUI=function(da,g){var J=V.getCurrentRowIdx(),P=V.getCurrentRow(),la=V.getCurrentColIdx();V.setPaddingHV(8,1);if(1===J)ca(da,g),t(J,la,da,I),4===la&&(g=new xa,g.setIconType(xa.ICON_TYPE_QUESTION),g.setTipsText(d.get("pathTips","\u8def\u5f84\u683c\u5f0f\u4e3a\uff1a\u6a21\u578b\u96c6\u540d\u79f0/\u76ee\u5f55\u540d\u79f0\u3002\u76ee\u5f55\u53ef\u80fd\u5b58\u5728\u591a\u5c42\u7ea7\uff0c\u5404\u5c42\u7ea7\u4e4b\u95f4\u7531\u201c/\u201d\u5206\u9694\u3002")),
g.setTipsSize(310,60),g=g.getJqUi(),M.layoutCtrlWithLRTB(g,($(da).outerWidth()>>1)+((new Ia).measureWidth(d.get("path","\u8def\u5f84"))>>1)+8,null,null,4,null,null),g.appendTo($(da)));else if(2<J&&(1===la||2===la)){g=$("<span>");g.css({"padding-left":"8px","padding-right":"8px","line-height":"28px"});var oa=P.getCell(la).getValue(),Ba=x();y(g,Ba,oa);g.appendTo(da)}else 2<J&&8===la?S(da,I,J,la):2<J&&9===la?ja(da,I,J,la):ca(da,g);2<J&&8!==la&&9!==la&&$(da).find("span").attr("title",P.getCell(la).getValue())};
var t=function(da,g,J,P){fa||6!==g||(fa=new ma,fa.setFunSortChangeListener(function(la){R(la,P,g)}),fa.addDefaultSortingTips($(J),P[g]));fa&&4!==g&&5!==g&&8!==g&&9!==g&&fa.addSortingTips($(J),P[g])},S=function(da,g,J,P){if(g&&9<=g.length&&"executeState"===g[8]){g=w.getRow(J);var la=g.getUserObject();P=g.getCell(P);if(la){P=P.getValue();J="en"===Na.getUrlParamValue("language");if(1===P||5===P){g="green";J=J?50:30;var oa=d.get("success","\u6210\u529f")}else 0===P?(g="blue",J=J?70:40,oa=d.get("inProgress",
"\u8fdb\u884c\u4e2d")):(g="red",J=30,oa=d.get("fail","\u5931\u8d25"));da=$(da);var Ba=$("<div style='border: solid 1px;text-align:center;height: 16px'>");Ba.text(oa);Ba.css("color",g);Ba.css("width",J+"px");Ba.css("position","absolute");Ba.css("left","3px");Ba.css("top","0");Ba.css("bottom","0");Ba.css("margin","auto");Ba.appendTo(da);2===P&&(g=$("<div style='text-align:left;width:75px;height: 16px'>"),g.text(d.get("insufficientSchedulingTimes","\u8c03\u5ea6\u6b21\u6570\u4e0d\u8db3")),g.css("position",
"absolute"),g.css("top","0"),g.css("bottom","0"),g.css("left","45px"),g.css("margin","auto"),g.appendTo(da));if(3===P||4===P)g=$("<div>"),g.text(d.get("detail","\u8be6\u60c5")),g.addClass("modelset-resourceinfo-error-detail"),g.appendTo(da),g.on("click",function(Ra){ua(la.scheduleId)});5===P&&(g=$("<div style='text-align:left;width:86px;height: 16px'>"),g.text(d.get("warningRuleUnMatched","\u4e0d\u6ee1\u8db3\u9884\u8b66\u89c4\u5219")),g.attr("title",d.get("warningRuleUnMatched","\u4e0d\u6ee1\u8db3\u9884\u8b66\u89c4\u5219")),
g.css("position","absolute"),g.css("top","0"),g.css("bottom","0"),g.css("left","43px"),g.css("margin","auto"),g.appendTo(da))}}},ja=function(da,g,J,P){if(g&&"operation"===g[P]&&(g=w.getRow(J).getUserObject())){var la=g.modelSetId,oa=g.modelId,Ba=g.modelType,Ra=g.modelName,Ha=g.modelDeployId;da=$(da);g=$("<div>");g.text(d.get("open","\u6253\u5f00"));g.addClass("modelset-resourceinfo-open-link");g.appendTo(da);g.on("click",function(F){F.stopPropagation();Pa.getDeployModelDesignerPageEntrance()(la,oa,
Ba,Ra,Ha)})}},ua=function(da){var g=h.createFacade(function(J){if(J){var P=J.errorCode,la=J.errorMessage,oa=new ia;oa.setOptionType(ia.OPTION_OK);P=P&&la?d.get("errorCodeMessage","\u9519\u8bef\u4fe1\u606f\uff1a#1\r\n\u9519\u8bef\u7801\uff1a#2").replace("#1",la).replace("#2",P):P&&!la?d.get("errorCode","\u9519\u8bef\u7801\uff1a#1\u3002").replace("#1",P):!P&&la?d.get("errorMessage","\u9519\u8bef\u4fe1\u606f\uff1a#1\u3002").replace("#1",la):d.get("noErrorCodeMessage","\u6682\u65e0\u9519\u8bef\u7801\u548c\u9519\u8bef\u4fe1\u606f\uff0c\u8bf7\u67e5\u770b\u8be6\u60c5\u3002");
(J=J.errorStackTrace)&&oa.setDetail(J);oa.setMessage(P);oa.showDialog()}else h.getMessageCurtain().showPrompt(d.get("notFindExceptionLog","\u672a\u627e\u5230\u5bf9\u5e94\u7684\u65e5\u5fd7\u3002"),2E3)},function(J,P){return!1});g.setShowBlocking(!1);g.loadExceptionLog(da)}}var B,w,h,G,m,O,T=0,ka,U,X,Q,fa,ya,La,Ma,Ga=new Oa,ra,ta=new function(){var k=0,I=[];this.getTotalRow=function(){return k};this.getDetails=function(){return I};this.fromJsonObject=function(V){k=V.totalRow;I=V.infos}},b=[d.get("scheduleName",
"\u8c03\u5ea6\u540d\u79f0"),d.get("modelNumber","\u6a21\u578b\u7f16\u7801"),d.get("modelName","\u6a21\u578b\u540d\u79f0"),d.get("modelType","\u6a21\u578b\u7c7b\u578b"),d.get("path","\u8def\u5f84"),d.get("scheduleType","\u8c03\u5ea6\u7c7b\u578b"),d.get("executeStartTime","\u6267\u884c\u5f00\u59cb\u65f6\u95f4"),d.get("executeTime","\u6267\u884c\u65f6\u957f"),d.get("state","\u72b6\u6001"),d.get("operate","\u64cd\u4f5c")],e="scheduleName modelNumber modelName modelType path scheduleType executeTime consumeTime executeState operation".split(" "),
a=[new u(d.get("executeAllType","\u5168\u90e8\u72b6\u6001"),0),new u(d.get("success","\u6210\u529f"),1),new u(d.get("fail","\u5931\u8d25"),2),new u(d.get("inProgress","\u8fdb\u884c\u4e2d"),3)];this.getJqUi=function(){if(!B){B=$("<div>");B.css({position:"absolute",width:"100%",height:"100%"});var k=new Ja;k.setFormatString("yyyy-MM-dd");ka=void 0!=ka?ka:k.format(new Date);U=void 0!=U?U:k.format(new Date);X=void 0!=X?X:(new Date).setHours(0,0,0,0);Q=void 0!=Q?Q:(new Date).setHours(0,0,0,0)+864E5-1;
k=$("<div class='schedule-toolbox-container'>");k.appendTo(B);if(!Ma){Ma=new v;var I=Ma.getJqUi();Ma.setDateRangeText(ka,U);Ma.setDateRangePanel(X,Q);Ma.setAfterChangedListener(f);I.appendTo(k)}La||(La=c(),La.getJqUi().addClass("schedule-search-type-panel"),La.getJqUi().appendTo(k));ya||(ya=new ba,ya.setSearchListener(z),I=ya.getJqUi(),M.layoutCtrlWithLRTB(I,null,20,171,2,null,25),I.appendTo(k));C();ra=new xa;ra.setIconType(xa.ICON_TYPE_QUESTION);ra.setTipsHtml(d.get("scheduleTips","\u4ec5\u4fdd\u7559\u6700\u8fd1\u4e00\u5e74\u7684\u8c03\u5ea6\u8be6\u60c5"));
O=ra.getJqUi();M.layoutCtrl(O,null,40,16,16);B.append(O);p()}return B};this.setGlobal=function(k){h=k};var c=function(){var k=new n;k.setItemModels(a);k.setSelected(a[0]);k.addSelectedChangedListener(q);k.setCustomPainter(function(I,V,ca){V.text(ca.getTypeName())});return k},q=function(k,I,V){T=V.getTypeId();p()},f=function(){ka=Ma.getStartDate();U=Ma.getEndDate();X=Ma.getStartDateTimeStamp();Q=Ma.getEndDateTimeStamp();p()},C=function(){Ga.setJumpToPageListener(function(k,I,V){var ca=h.createFacade(function(ja){A(ja,
V)},function(ja,ua){return!1}),t=aa(),S=x();ca.setShowBlocking(!0);ca.setBlockingJqUi(B);ca.getAllScheduleResourceInfoList(k,I,t.getField(),t.getOrder(),S,T,X,Q)});Ga.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);Ga.getJqUi().css("top","32px");B.append(Ga.getJqUi())},p=function(){var k=h.createFacade(function(ca){ca&&ta.fromJsonObject(ca);Ga.resetPaginationAndJumpToFirstPage(ta.getTotalRow());ca=ta.getTotalRow();var t=-1<Na.getUrlParamValue("language").indexOf("en"),S=t?350:200;
O.css("left",(t?74:32)+8*(ca+"").length+"px");ra.setTipsSize(S,40);H()},function(ca,t){return!1}),I=aa(),V=x();k.setShowBlocking(!0);k.setBlockingJqUi(B);k.getAllScheduleResourceInfoList(1,Ga.getPageSize(),I.getField(),I.getOrder(),V,T,X,Q)},H=function(){if(!w){w=sa.createTable();G=$(w.getUI());w.addColumns(b.length);w.getColumn(0).setWidth(80);w.getColumn(1).setWidth(80);w.getColumn(2).setWidth(80);w.getColumn(3).setWidth(80);w.getColumn(4).setWidth(85);w.getColumn(5).setWidth(65);w.getColumn(6).setWidth(132);
w.getColumn(7).setWidth(132);w.getColumn(8).setWidth(120);w.getColumn(9).setWidth(46);for(var k=sa.createHeadRow(w),I=0;I<b.length;I++)k.getCell(I).setValue(b[I]);k=new l(w,e);k.setOutsideVisible(!1);w.setCellRender(k);w.setCellAcrossListener(function(V,ca,t){fa&&fa.hideLastShowSortTips();1===ca&&4!==t&&5!==t&&8!==t&&9!==t&&(fa||(fa=new ma,fa.setFunSortChangeListener(function(S){R(S,e,t)})),fa.showSortingTips(V,e[t]))});M.layoutCtrl(G,10,64,910,318);G.appendTo(B)}m||(m=$("<div>"),m.addClass("modelset-resourceinfo-no-search-result"),
k=$("<div>"),k.addClass("modelset-resourceinfo-no-search-result-icon"),D.background(k,"icon-search-none"),k.appendTo(m),k=$("<div>"),k.addClass("modelset-resourceinfo-no-search-result-tips"),k.text(d.get("noSearchResult","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),k.appendTo(m),m.appendTo(B));m.hide();k=ta.getDetails();x()&&0===k.length&&m.show();E(k,e)},A=function(k,I){k&&ta.fromJsonObject(k);I?I(ta.getTotalRow()):Ga.refreshPagination();k=ta.getDetails()?ta.getDetails():
[];E(k,e)},z=function(){p()},x=function(){return ya?ya.getInputContent().trim():null},E=function(k,I){w.setSyncUIWhenModelChanged(!1);sa.clearWithoutHead(w);for(var V=0;V<k.length;V++)for(var ca=sa.createRow(w),t=0;t<I.length;t++){var S=k[V][I[t]];switch(I[t]){case "executeTime":S=k[V].displayExecuteTime;ca.getCell(t).setValue(S);break;case "modelType":ca.getCell(t).setValue(Qa.modelTypeTransformName(S));break;case "scheduleType":var ja=d.get("fullMaterialize","\u5168\u91cf\u7269\u5316");"incremental"===
S&&(ja=d.get("incrementalMaterialize","\u589e\u91cf\u7269\u5316"));ca.getCell(t).setValue(ja);break;case "executeState":ca.setUserObject(k[V]);ca.getCell(t).setValue(S);break;case "operation":ca.setUserObject(k[V]);break;default:ca.getCell(t).setValue(S)}}1<w.getRowsCount()&&(k=new KTBorderStyle,k.setLeftBorderWidth(0),w.getRow(1).getCell(0).setBorder(k));w.updateUI(!0);w.setSyncUIWhenModelChanged(!0);G.children(":first-child").children(":first-child").css("width","100%")},aa=function(){var k;fa&&
(k=fa.getShowSortingModel());k||(k=new na,k.setField(e[6]),k.setOrder(na.ORDER_DESC));return k},R=function(k,I,V){I=I[V];V=na.ORDER_DESC;k&&(I=k.getField(),V=k.getOrder());k=x();var ca=h.createFacade(function(t){A(t,Ga.resetPaginationAndJumpToFirstPage)},function(t,S){return!1});ca.setShowBlocking(!0);ca.setBlockingJqUi(B);ca.getAllScheduleResourceInfoList(1,Ga.getPageSize(),I,V,k,T,X,Q)}}function ba(){var u,v,l;this.getJqUi=function(){if(!u){u=$("<div>");l=new va;l.setPlaceholder(d.get("searchModelNumberOrName",
"\u641c\u7d22\u6a21\u578b\u7f16\u7801/\u540d\u79f0"));l.setSearchListenerDelay(1E3);l.setShowSearchIcon(!0);l.addSearchListener(v);var B=l.getJqUi();B.css({width:"191px",height:"25px","float":"left",position:"relative"});B.appendTo(u)}return u};this.getInputContent=function(){return l.getText()};this.setSearchListener=function(B){v=B}}function ma(){var u,v,l;this.setShowSortingModel=function(m){v=m};this.getShowSortingModel=function(){return v};this.setFunSortChangeListener=function(m){l=m};this.showSortingTips=
function(m,O){var T=m.find(".modelset-resourceinfo-sort-box");0===T.length&&(T=new na,T.setField(O),T.setOrder(null),T=w(m,T),m.append(T));T.addClass("modelset-resourceinfo-sort-box_clickable");u=T};this.hideLastShowSortTips=function(){u.removeClass("modelset-resourceinfo-sort-box_clickable");B(u)};this.addSortingTips=function(m,O){if(v&&null!=v.getOrder()&&v.getField()===O){if((O=m.find(".modelset-resourceinfo-sort-box"))&&(O=O.data("sortable-data"))&&v.equals(O))return;O=w(m,v);m.append(O)}};this.addDefaultSortingTips=
function(m,O){v=new na;v.setField(O);v.setOrder(na.ORDER_DESC);O=w(m,v);m.append(O);u=O};var B=function(m){var O=m.data("sortable-data");O&&null==O.getOrder()&&m.remove()},w=function(m,O){var T=m.width();m=m.height();T=h(T-15-1,m-15-2);T.data("sortable-data",O);G(T);T.on("click",function(ka){ka=$(ka.currentTarget);var U=ka.data("sortable-data");U.getOrder()===na.ORDER_ASC?U.setOrder(na.ORDER_DESC):U.getOrder()===na.ORDER_DESC?"size"===U.getField()||"executeTime"===U.getField()?U.setOrder(na.ORDER_ASC):
U.setOrder(null):U.getOrder()||U.setOrder(na.ORDER_ASC);ka.data("sortable-data",U);G(ka);B(ka);v=U;l&&l(v)});return T},h=function(m,O){var T=$("<div>");D.background(T,"icon-sort");T.attr("title",d.get("sort","\u6392\u5e8f"));T.addClass("modelset-resourceinfo-sort-box");T.css("left",m);T.css("top",O);T.css("width",13);T.css("height",13);return T},G=function(m){var O=m.data("sortable-data");O.getOrder()===na.ORDER_ASC?D.background(m,"icon-sort-asc"):O.getOrder()===na.ORDER_DESC?D.background(m,"icon-sort-desc"):
O.getOrder()||D.background(m,"icon-sort")}}function na(){var u,v;this.setOrder=function(l){u=l};this.getOrder=function(){return u};this.setField=function(l){v=l};this.getField=function(){return v};this.equals=function(l){return v===l.getField()&&u===l.getOrder()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&
(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.ui&&(com.kingdee.bos.qing.modeler.modelset.ui={});var qa=com.kingdee.bos.qing.modeler.modelset.ui;qa.ResourceDetailDialog=function(){pa.call(this);var u=this.protectedMethod,v=this,l,B=!0;(function(){u.setTitle(d.get("resourceUsageInfo","\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5"));v.setSize(960,540);u.setSelectable(!0);
u.setContentPaneCreator(function(){w();var h=new N;h.setTabLevel(N.SECOND_LEVEL);var G=new L(L.TYPE_DW_STORAGE,l,B);h.addTab(G,!0);G=new L(L.TYPE_SCHEDULE,l,B);h.addTab(G,!1);return h.getJqUi()});u.setFooterClosingOnly(!0);u.setClosingChecker2(null,function(){u.destroy();return!0});u.setClosingAction(function(h){})})();this.setGlobal=function(h){l=h};this.setPublic=function(h){B=h};var w=function(){var h=l.createFacade(function(G){},function(G,m){return 30001001===G?(u.getMessageCurtain().showPrompt(d.get("noDataWarehouseConfig",
"\u5f53\u524d\u73af\u5883\u672a\u914d\u7f6e\u201c\u8f7b\u6570\u4ed3\u6570\u636e\u6e90\u201d\u53c2\u6570\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5728MC\u4e2d\u8fdb\u884c\u914d\u7f6e\u3002"),2E3),!0):30001002===G?(u.getMessageCurtain().showPrompt(d.get("dataWarehouseConfigParseError","\u201c\u8f7b\u6570\u4ed3\u6570\u636e\u6e90\u201d\u53c2\u6570\u89e3\u6790\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5728MC\u4e2d\u91cd\u65b0\u914d\u7f6e\u3002"),2E3),!0):!1});h.checkDataWarehouseConfig();
h.setShowBlocking(!1)}};var xa,ia,pa,N,va,n,Z,Aa,Ia,Ja,M,d,sa,Na,D,Pa,Oa,Qa;(function(){var u=com.kingdee.bos.qing.ui.component;xa=u.HelpIcon;ia=u.MessageDialog;pa=u.AbstractModalDialog;N=u.TabContainer;va=u.SearchBox;n=u.ComboBox;Aa=u.WorkButton;u=com.kingdee.bos.qing.common;Ja=u.DateFormater;M=u.DomUtil;Ia=u.TextMeasurer;u=com.kingdee.bos.qing.framework.common;d=u.MultilanguageManager.createPackageAccessor(qa);u=com.kingdee.bos.qing.common.ui;sa=u.TableUtil;Z=u.DateRangePanel;u=com.kingdee.bos.qing;
Na=u.Seer;u=com.kingdee.bos.qing.modeler.common.model;Qa=u.ModelType;u=com.kingdee.bos.qing.modeler.modelset.common;D=u.Icons;Pa=u.Integration;u=com.kingdee.bos.qing.biz.common;Oa=u.SimplePaginationBar})();L.TYPE_DW_STORAGE="dwStorage";L.TYPE_SCHEDULE="schedule";na.ORDER_DESC="DESC";na.ORDER_ASC="ASC";var y=function(u,v,l){if(v&&l){v=v.toUpperCase();var B=l.toUpperCase(),w=B.split(v),h=v.length,G;for(G in w){var m=B.indexOf(w[G]),O=l.substr(ka,w[G].length);m+=w[G].length;var T=B.length-m;B=B.substr(m,
T);l=l.substr(m,T);m=$("<span>");m.text(O);m.appendTo(u);if(G!=w.length-1&&1<w.length){var ka=B.indexOf(v);O=l.substr(ka,h);m=ka+h;T=B.length-m;B=B.substr(m,T);l=l.substr(m,T);m=$("<span>");m.text(O);m.css("color","red");m.clone().appendTo(u)}}}else u.text(l)}})();(function(){function L(){var b=350,e=250,a=6,c=!1,q,f;this.setDuration=function(C,p){b=C;e=p};this.setTimes=function(C,p){a=2*C+(p?1:0);c=p};this.setAction=function(C){q=C};this.blink=function(C,p,H){if(0>=a)throw Error("Illegal usage");clearTimeout(f);var A=function(){if(0==a)q&&q();else{if(a%2==(c?0:1)){C.addClass(p);var z=b}else C.removeClass(p),C.addClass(H),z=e;f=setTimeout(A,z);a--}};A()}}function ea(){var b,e=[],a,c,q,f;this.getJqUi=function(){b||C();return b};this.setFunCloseSearchResultPanel=
function(z){c=z};this.refresh=function(){var z=b.find(".sa-ctrl-list-owner");z.empty();z.css("top","40px");for(var x=$(document.createDocumentFragment()),E=H,aa=0;aa<e.length;aa++){var R=$("<div>");R.addClass("sa-ctrl-list-item");R.addClass("sa-ctrl-list-item_enabled");R.addClass("sa-ctrl-list-item-defaultlayout");var k=e[aa];R.data("model",k);E(R,k);x.append(R)}z.append(x);0==e.length&&(x=z.append,E=new Q,E.setIsShortTip(!0),E=E.getJqUi(),x.call(z,E))};var C=function(){b=$("<div>");b.addClass("modelset-search-lists");
b.css({"float":"right",right:"0px",height:"100%",width:"300px",position:"absolute",top:"56px",background:"white","z-index":"99999"});q||(q=new O,q.scrollSelectedToVisible(),q.setCustomItemPainter(H),q.addSelectedChangedListener(p),q.setUserObject(e),q.setItemModels(e));var z=q.getJqUi();z.find(".sa-ctrl-list-owner").css({top:"40px",bottom:"100px","overflow-x":"hidden"});b.append(z);z=$("<div>");z.addClass("modelset-search-close");z.css({width:"100px",height:"28px",left:"0",right:"0",bottom:"24px",
margin:"auto",position:"absolute","font-size":"14px",color:"white","text-align":"center","line-height":"28px","border-radius":"2px","margin-bottom":"45px",cursor:"pointer"});var x=$("<div>");x.text(d.get("close","\u5173\u95ed"));x.appendTo(z);z.on("click",function(){c&&c()});b.append(z)};this.setSearchText=function(z){a=z};this.setFunItemSelectedListener=function(z){f=z};this.setArrItemModel=function(z){e=z};var p=function(z,x,E){E&&0<E.length&&(z=E[0],f&&f(z))},H=function(z,x){z.addClass("modelset-search-item");
z.css({width:"270px",height:"75px","border-bottom":"1px solid #E2E7EF",left:"6px",top:"0px"});var E=$("<span class='modelset-search-item-type'>");M.background(E,"icon-card-subject");E.css({position:"absolute",width:"36px",height:"36px",transform:"scale(0.5, 0.5)","transform-origin":"top",top:"5px",left:"-3px"});var aa=$("<span>");aa.addClass("modelset-search-item-name");aa.css({position:"absolute","font-size":"14px",color:"black",width:"250px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",
top:"5px","margin-left":"27px"});aa.attr("title",x.getModelSetName());var R=$("<div class='modelset-search-item-creator'>"),k=$("<span>");k.text(d.get("creatorWithColon","\u521b\u5efa\u4eba\uff1a"));var I=$("<span>");R.append(k);R.append(I);k=x.getCreatorName();"100000"==x.getCreatorId()&&(k=d.get("systemPreset","\u7cfb\u7edf\u9884\u7f6e"));R.css({position:"absolute",top:"28px"});var V=$("<div class='modelset-search-item-description'>"),ca=$("<span>");ca.text(d.get("descriptionWithColon","\u63cf\u8ff0\uff1a"));
ca.css({top:"22px"});var t=$("<span>"),S=x.getDescription().trim();t.addClass("modelset-search-item-desc");t.css({width:"240px",position:"absolute","white-space":"nowrap",height:"20px",overflow:"hidden","text-overflow":"ellipsis"});t.attr("title",x.getDescription());V.css({position:"absolute",top:"50px"});V.append(ca);V.append(t);z.append(E);z.append(aa);z.append(R);S&&0<S.length&&z.append(V);a&&(A(aa,x.getModelSetName(),a),A(t,S,a),A(I,k,a));z.on("click",function(ja){q.setSelecteds([])})},A=function(z,
x,E){if(z&&x&&E){E=E.toUpperCase();var aa=x.toUpperCase(),R=aa.split(E),k=E.length,I;for(I in R){var V=aa.indexOf(R[I]),ca=x.substr(0,R[I].length);V+=R[I].length;var t=aa.length-V;aa=aa.substr(V,t);x=x.substr(V,t);V=$("<span>");V.text(ca);V.appendTo(z);I!=R.length-1&&1<R.length&&(V=aa.indexOf(E),ca=x.substr(V,k),V+=k,t=aa.length-V,aa=aa.substr(V,t),x=x.substr(V,t),V=$("<span>"),V.text(ca),V.css("color","red"),V.appendTo(z))}}}}function Y(){var b=this,e,a;this.getIsConfirmMsg=function(){return!1};
this.setSuggestSize=function(c){};this.getTitle=function(){};this.showDialog=function(){var c=D.createFeedbackDialog();c.setOptionType(D.OPTION_OK_CANCEL);b.getIsConfirmMsg()?c.setMsgImageType(D.MSG_CONFIRM):c.setMsgImageType(D.MSG_DELETE);c.setMessage(a);c.setClosingChecker(function(q){q==D.RETURN_OK&&b.doConfirmListener();return!0});c.showDialog()};this.doConfirmListener=function(){};this.setGlobal=function(c){e=c};this.getGlobal=function(){return e};this.setConfirmContent=function(c){a=c};this.protectedMethod=
{getGlobal:function(){return e}}}function ba(b){Y.call(this);var e=this,a=[],c;this.addSuccessCallback=function(f){a.push(f)};this.doConfirmListener=function(){q()};var q=function(){var f=function(p){p=0;for(var H=a.length;p<H;p++){var A=a[p];A&&A(b)}};c=e.getGlobal();var C=c.createFacade(f,function(p,H){H=p.toString();return 20005001==p?(c.getMessageCurtain().showPrompt(d.get("deleteModelTips","\u8bf7\u5148\u5220\u9664\u6a21\u578b\u96c6\u4e0b\u7684\u6a21\u578b\uff0c\u518d\u5220\u9664\u8be5\u6a21\u578b\u96c6\u3002")),
!0):20005002==p?(c.getMessageCurtain().showPrompt(d.get("modelSetDeleted","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\u6216\u65e0\u6743\u9650\u3002")),!0):"10"==H.substr(0,2)&&7==H.length&&1010004==p?(f(null),!0):!1});C.setShowBlocking(!0);C.deleteModelSet(b.getFId())};this.protectedCustomLayout=function(f,C,p){y.layoutCtrl(C,140,20,98,80);y.layoutCtrl(p,0,125,370,23)}}function ma(b){Y.call(this);var e;this.getIsConfirmMsg=function(){return!0};this.setEnableListener=function(a){e=a};this.doConfirmListener=
function(){e&&e()}}function na(b){var e=this,a=b,c=a.copy(),q=[910,600],f=[],C,p,H,A,z;this.addSuccessCallback=function(R){f.push(R)};this.createJqPanel=function(){var R=$("<div>"),k=$("<div class='modelset-cooper-content-container'>");p=new l;p.addTabChangedListener(aa);p.setTabLevel(l.SECOND_LEVEL);H=new qa(C,qa.USER,a);H.setCooperDetailUpdater(E);A=new qa(C,qa.ROLE,a);A.setCooperDetailUpdater(E);p.addTab(H,!0);p.addTab(A);var I=p.getJqUi();k.append(I);z=new G;z.addSearchListener(x);z.setSearchListenerDelay(0);
z.setPlaceholder(d.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));z.setShowSearchIcon(!0);I=z.getJqUi();y.layoutCtrl(I,665,5,206,22);R.append(k);R.append(I);return R};var x=function(){var R=z.getText(),k=p.getCurrentTabPane();R&&R.trim()?(R=R.trim().toUpperCase(),k.setSearchStatus(!0,R)):k.setSearchStatus(!1,null)};this.setGlobal=function(R){C=R};var E=function(R,k){for(var I=[],V=0;V<R.length;V++)I.push(R[V].toJsonObject());R=p.getCurrentTabPane();C.createFacade(function(ca){for(var t=
[],S=0;S<ca.length;S++){var ja=new h;ja.fromJsonObject(ca[S]);t.push(ja)}k&&k(t)},function(){return!1}).previewCoopInfo(I,R.getType())},aa=function(){x()};this.createDialog=function(){var R=$(document.body),k=$("<div class='sa-ctrl-common-modallayer'>");k.appendTo(R);var I=new Na(k);b.getPermission()!=n.COOPERATION_ADMIN&&I.setFooterClosingOnly(!0);I.setTitle(d.get("cooperManager","\u534f\u4f5c\u6210\u5458\u7ba1\u7406"));var V=q[0],ca=q[1],t=$(window).width(),S=$(window).height();I.setBounds(t-V>>
1,S-ca>>1,V,ca);I.setToolbarVisible(!1);I.setContent(e.createJqPanel());I.addClosingListener(function(ja,ua){ua?C.createFacade(function(da){if(da)for(a.fromJsonObject(da),c=a.copy(),da=0;da<f.length;da++)f[da]&&f[da](c);else for(da=0;da<f.length;da++)f[da]&&f[da]()},function(da,g){a=c;return 20005002==da?(C.getMessageCurtain().showPrompt(d.get("modelSetDeleted","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\u6216\u65e0\u6743\u9650\u3002")),!0):!1}).saveOrUpdateCoopModelSetInfo(a):a=c;ja.destroy();k.remove()});
I.showFooterPane();k.appendTo(R);return I}}function qa(b,e,a){l.AbstractTabPane.call(this);var c,q=this,f,C,p,H,A,z=!1,x=!1,E,aa=!1,R,k,I={};e==qa.USER?C=new N:e==qa.ROLE&&(C=new va);this.getTitle=function(){return e==qa.USER?d.get("CurrentSystemUser","\u5f53\u524d\u7cfb\u7edf\u7528\u6237"):d.get("CurrentSystemRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272")};this.setSearchStatus=function(g,J){f||(f=e==qa.USER?a.getUsers():a.getRoles());x=g;E=J;x?q.updateSearchUI():(aa=!1,q.updateUi(f))};this.getModel=
function(){return f};this.setCooperDetailUpdater=function(g){p=g};this.getType=function(){return e};this.updateSearchUI=function(){A.hide();R.hide();k.hide();var g=[];if(f&&0<f.length){for(var J=0;J<f.length;J++)if(f[J].isAvailable()){var P=f[J].getText().trim().toUpperCase();e==qa.USER?f[J].getJobId()?(-1<f[J].getJobId().trim().toUpperCase().indexOf(E)||-1<P.indexOf(E))&&g.push(f[J]):-1<P.indexOf(E)&&g.push(f[J]):-1<P.indexOf(E)&&g.push(f[J])}aa=0==g.length?!0:!1}else aa=!0;q.updateUi(g)};this.updateUi=
function(g){c.find(".cooper-container-card").remove();c.find(".cooper-container-card-Searching").remove();aa?R.show():R.hide();if(g){0==a.getPermission()?(z=!0,!x&&A.show()):(A&&A.hide(),x||0!=g.length||e==qa.ROLE&&k.show());V(g);for(var J=0;J<g.length;J++){var P=new ia(g[J]);P.isAddOperation(z);e==qa.USER&&g[J].getPermission()==h.CREATOR_PERM&&(H=g[J],P.setIsCreator(!0));P.setDeleteCardListener(ca);P.setType(e);P.updateCardSearchingStatus(x,E);P=P.getJqUi();x&&P.addClass("cooper-container-card-Searching");
c.append(P)}}};var V=function(g){if(H){for(var J=0;J<g.length;J++)if(g[J].getValue()==H.getValue())return;f.unshift(H)}},ca=function(g){g=g.getValue();for(var J=0;J<f.length;J++)if(f[J].getValue()==g){f.splice(J,1);break}e==qa.USER?a.setUsers(f):a.setRoles(f);C.setSelectedValue(f)};this.getJqUi=function(){if(!c){C.setSelectedListener(S);c=$("<div class='cooper-container'>");var g=new ia;g.setType(e);A=g.getJqUi();A.on("click",t);c.append(A);R=(new Q).getJqUi();c.append(R);g=$("<div>");var J=$("<div>"),
P=$("<div>");M.background(P,"icon-empty");P.css({position:"absolute",margin:"auto",top:"-50px","text-align":"center",width:"168px",height:"96px",bottom:"0",left:"0",right:"0"});J.text(d.get("noRoleDataResult","\u6682\u672a\u6dfb\u52a0\u5f53\u524d\u7cfb\u7edf\u89d2\u8272"));J.css({position:"absolute",margin:"auto",width:"auto",height:"16px","font-size":"14px",color:"#999999",top:"100px","text-align":"center",left:"0",bottom:"0",right:"0"});g.append(P);g.append(J);k=g;c.append(k);k.hide();R.hide();
A.hide()}return c};var t=function(){C.setSelectedValue(f);C.protectedClickEvent()},S=function(g){ua(g);if(da(g))p&&p(g,function(oa){f=oa;V(f);oa=f;for(var Ba=0;Ba<oa.length;Ba++){var Ra=oa[Ba],Ha=Ra.getValue();I[Ha]||(I[Ha]=Ra.toJsonObject())}e==qa.USER?a.setUsers(f):a.setRoles(f);ja();q.updateUi(f)});else{for(var J=0;J<g.length;J++){var P=g[J],la=I[P.getValue()];P.fromJsonObject(la)}f=g;e==qa.USER?a.setUsers(f):a.setRoles(f);ja();q.updateUi(f)}},ja=function(){for(var g=[],J=[],P=[],la=[],oa=0;oa<
f.length;oa++){var Ba=f[oa];Ba.getPermission()==h.CREATOR_PERM?g.push(Ba):Ba.getPermission()==h.ADMIN_PERM?J.push(Ba):P.push(Ba)}g&&0<g.length&&la.push(g[0]);for(oa=0;oa<J.length;oa++)la.push(J[oa]);for(oa=0;oa<P.length;oa++)la.push(P[oa]);f=la},ua=function(g){var J=e==qa.USER?a.getUsers():a.getRoles();for(var P={},la=0;la<J.length;la++){var oa=J[la];P[oa.getValue()]=oa.getPermission()}for(la=0;la<g.length;la++)J=g[la],P[J.getValue()]&&J.setPermission(P[J.getValue()])},da=function(g){for(var J=0;J<
g.length;J++)if(!I[g[J].getValue()])return!0;return!1}}function xa(b){var e=[440,330],a,c,q,f,C;this.setGlobal=function(z){q=z};this.setSaveOrUpdateSuccessCallback=function(z){C=z};this.showDialog=function(){var z=$(document.body),x=$("<div class='sa-ctrl-common-modallayer'>");x.appendTo(z);f=new Na(x);f.setSelectable(!0);var E=void 0!=b.getFId()?d.get("editDataModelSet","\u7f16\u8f91\u6a21\u578b\u96c6"):d.get("createDataModelSet","\u65b0\u5efa\u6a21\u578b\u96c6");f.setTitle(E);E=e[0];var aa=e[1],
R=$(window).width(),k=$(window).height();f.setBounds(R-E>>1,k-aa>>1,E,aa);f.setToolbarVisible(!1);f.setContent(A());f.showFooterPane();x.appendTo(z);var I=function(){f.destroy();x.remove()};f.addClosingListener(function(V,ca){if(ca){if(V=$.trim(a.getText()),ca=$.trim(c.getText()),H(V,ca)){var t=b.copy();t.setModelSetName(V);t.setDescription(ca);p(t,I,f.getMessageCurtain())}}else I()});f.show()};var p=function(z,x,E){var aa=q.createFacade(function(R){z.fromJsonObject(R);C&&C(z);x()},function(R,k){return 20005E3==
R?(R=d.get("modelSetNameSameWithOther","\u8be5\u540d\u79f0\u5df2\u88ab\u5176\u4ed6\u7528\u6237\u4f7f\u7528\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002"),"true"==k&&(R=d.get("modelSetNameSameWithMe","\u8be5\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002")),E.showPrompt(R),!0):20005002==R?(q.getMessageCurtain().showPrompt(d.get("modelSetDeleted","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\u6216\u65e0\u6743\u9650\u3002")),x(),!0):!1});aa.setShowBlocking(!0);aa.saveOrUpdateModelSet(z)},
H=function(z,x){return""==z?(f.getMessageCurtain().showPrompt(d.get("pleaseInputModelSetName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002")),!1):50<z.length?(f.getMessageCurtain().showPrompt(d.get("modelSetNameLengthTip","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")),!1):500<x.length?(f.getMessageCurtain().showPrompt(d.get("descriptionLengthTip","\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7500\u4e2a\u5b57\u7b26\u3002")),!1):!0},A=function(){var z=$("<div>"),x=new Pa;
x.setRequired(!0);x.setText(d.get("modelSetName","\u540d\u79f0"));x=x.getJqUi();a=new Oa;a.setText(b?b.getModelSetName():"");var E=a.getJqUi(),aa=new Pa;aa.setText(d.get("description","\u63cf\u8ff0"));aa=aa.getJqUi();c=new Qa;c.setText(b?b.getDescription():"");var R=c.getJqUi();x.appendTo(z);E.appendTo(z);aa.appendTo(z);R.appendTo(z);y.layoutCtrl(x,8,0,70,23);y.layoutCtrl(E,76,0,320,23);y.layoutCtrl(aa,8,48,70,23);y.layoutCtrl(R,76,54,320,150);return z}}function ia(b){function e(){Y.call(this);var t;
this.setDeleteListener=function(S){t=S};this.doConfirmListener=function(){t&&t()};this.protectedCustomLayout=function(S,ja,ua){y.layoutCtrl(ja,140,20,98,80);y.layoutCtrl(ua,0,125,370,23)}}var a,c,q,f,C,p,H=!1,A,z,x,E=function(){if(b)if(b.isAvailable()){a=$("<div class='cooper-container-card'>");var t=b.getText();f=B.createHeadImg(t,b.getColor());b.setColor(f[1]);var S=f[0],ja=$("<img class='cooper-container-card-content-headImg'>");ja.attr("src",S);a.append(ja);z=$("<div class='cooper-container-card-content-item'>");
z.text(t);a.append(z);var ua=$("<span>");ua.text(" \u25cf ");ua.css({color:"#1BA854"});ua.hide();var da=[d.get("admin","\u7ba1\u7406\u5458"),d.get("member","\u6210\u5458")];x=new m;x.setItemModels(da);b.getPermission()==h.ADMIN_PERM?(ua.show(),x.setSelected(da[0])):b.getPermission()==h.MEM_PERM&&x.setSelected(da[1]);x.addSelectedChangedListener(function(g,J,P){g=da.indexOf(P);-1!=g&&(b.setPermission(g),0==g?ua.show():ua.hide())});t=x.getJqUi();t.css({position:"absolute","float":"right",top:"137px",
width:"62px",height:"17px","text-align":"right",color:"#212121",left:"27px"});t.removeClass("sa-ctrl-common-singlelineborder");t.removeClass("sa-ctrl-common-singlelineborder_disabled");S=$("<span class='cooper-container-card-line'>");S.text("|");ja=$("<span class='cooper-container-card-delete-icon'>");ja.attr("title",d.get("delete","\u5220\u9664"));ja.on("click",I);ja.text(d.get("delete","\u5220\u9664"));aa(ja);q?(t=$("<div class='cooper-container-card-status'>"),S=$("<span>"),S.text(" \u25cf "),
S.css({color:"#FF991C"}),ja=$("<span>"),ja.text(d.get("creator","\u521b\u5efa\u8005")),t.append(S),t.append(ja),a.append(t)):C?(ua.css({position:"absolute",left:"16px",bottom:"14px","font-size":"12px"}),a.append(ua),a.append(t),a.append(S),a.append(ja)):(t=R(ua),a.append(t));ca()}else V();else a=$("<div class='cooper-container-card-creator'>"),t=$("<div class='cooper-container-card-creator-icon'>"),M.background(t,"add-user-image"),S=$("<div>"),c==qa.USER?S.text(d.get("addUsers","\u6dfb\u52a0\u7528\u6237")):
S.text(d.get("addRoles","\u6dfb\u52a0\u89d2\u8272")),a.append(t),a.append(S)},aa=function(t){"Delete"==d.get("delete","\u5220\u9664")&&t.css("right","15px")},R=function(t){var S=$("<div>"),ja=$("<span>");ja.text(x.getSelected());ja.css({color:"#212121"});S.append(t);S.append(ja);S.css({position:"absolute","float":"right",top:"137px",height:"17px",margin:"auto","text-align":"center",left:"0px",right:"0px"});return S};this.updateCardSearchingStatus=function(t,S){H=t;A=S};var k=function(t,S,ja){if(t&&
S&&ja){t.text("");ja=ja.toUpperCase();var ua=S.toUpperCase(),da=ua.split(ja),g=ja.length,J;for(J in da){var P=ua.indexOf(da[J]),la=S.substr(0,da[J].length);P+=da[J].length;var oa=ua.length-P;ua=ua.substr(P,oa);S=S.substr(P,oa);P=$("<span>");P.text(la);P.appendTo(t);J!=da.length-1&&1<da.length&&(P=ua.indexOf(ja),la=S.substr(P,g),P+=g,oa=ua.length-P,ua=ua.substr(P,oa),S=S.substr(P,oa),P=$("<span>"),P.text(la),P.css("color","red"),P.clone().appendTo(t))}}};this.setDeleteCardListener=function(t){p=t};
var I=function(){var t=d.get("ConfirmDelCoopCard","\u786e\u5b9a\u8981\u79fb\u9664\u201c#1\u201d\u5417\uff1f");t=b.getText()?t.replace("#1",b.getText()):t.replace("\u201c#1\u201d","");var S=new e;S.setConfirmContent(t);S.setDeleteListener(function(){p&&p(b);a.remove()});S.showDialog()};this.isAddOperation=function(t){C=t};this.setType=function(t){c=t};this.setIsCreator=function(t){q=t};this.getJqUi=function(){a||E();return a};var V=function(){a=$("<div class='cooper-container-card'>");var t=$("<div class='cooper-container-card-content-headImg'>");
M.background(t,"user-not-exist");t.appendTo(a);t=d.get("userNotExist","\u627e\u4e0d\u5230\u8be5\u7528\u6237");c==qa.ROLE&&(t=d.get("roleNotExist","\u627e\u4e0d\u5230\u8be5\u89d2\u8272"));var S=$("<div class='cooper-container-card-content-item-exception'>");S.attr("title",t);y.layoutCtrlCenterAlign(S,120);var ja=$("<span class='cooper-container-card-content-item-exception-prompt'>");ja.text("!");ja.appendTo(S);ja=$("<span>");ja.text(t);ja.appendTo(S);S.appendTo(a);t=$("<span class='cooper-container-card-delete-icon'>");
t.attr("title",d.get("delete","\u5220\u9664"));t.on("click",I);t.text(d.get("delete","\u5220\u9664"));y.layoutCtrlCenterAlign(t,24);C&&a.append(t)},ca=function(){if(c==qa.USER){var t=$("<div class='cooper-container-card-content-item-subtitle'>"),S=b.getJobId();t.text(S);a.append(t)}H&&k(z,b.getText(),A);H&&c==qa.USER&&k(t,b.getJobId(),A)}}function pa(){var b=this,e,a;this.getJqUi=function(){if(!e){e=$("<div>");a=$("<input readonly=readonly>");a.on("click",b.protectedClickEvent);var c=$("<span>");
c.appendTo(e);a.appendTo(e);c.on("click",b.protectedClickEvent)}return e};this.setSelectedValue=function(){throw Error("override me");};this.getSelectedValue=function(){throw Error("override me");};this.protectedClickEvent=function(){throw Error("override me");}}function N(){pa.call(this);var b=[],e=!1,a,c;this.setSelectedListener=function(p){c=p};var q=this.getJqUi;this.getJqUi=function(){a||(a=q());return a};this.setSelectedValue=function(p){b=p};this.getSelectedValue=function(){return b};this.protectedClickEvent=
function(){e||f()};var f=function(){e=!0;var p=w;p.setCallBack(function(H){for(var A={},z={},x=0;x<b.length;x++){var E=b[x].getValue();A[E]=b[x].getColor();z[E]=b[x].getPermission()}e=!1;if(H&&H.content&&(x=H.content,H=x.selecteds,"cancel"!=x.operation&&"undefined"!=H)){var aa=Object.keys(H);b=[];for(x=0;x<aa.length;x++){E=aa[x];var R=H[E],k=new h;k.setValue(E);k.setText(R);k.setColor(A[E]);0==z[E]?k.setPermission(0):k.setPermission(1);b.push(k)}c&&c(b)}});p.openUserForm(C())},C=function(){for(var p=
[],H=0;H<b.length;H++){var A=b[H].getValue();p.push(A)}return p}}function va(){pa.call(this);var b=[],e=!1,a,c;this.setSelectedListener=function(p){c=p};var q=this.getJqUi;this.getJqUi=function(){a||(a=q());return a};this.protectedClickEvent=function(){e||f()};this.setSelectedValue=function(p){b=p};this.getSelectedValue=function(){return b};var f=function(){e=!0;var p=w;p.setCallBack(function(H){for(var A={},z={},x=0;x<b.length;x++){var E=b[x].getValue();A[E]=b[x].getColor();z[E]=b[x].getPermission()}e=
!1;if(H&&H.content&&(x=H.content,H=x.selecteds,"cancel"!=x.operation&&"undefined"!=H)){var aa=Object.keys(H);b=[];for(x=0;x<aa.length;x++){E=aa[x];var R=H[E],k=new h;k.setValue(E);k.setText(R);k.setColor(A[E]);0==z[E]?k.setPermission(0):k.setPermission(1);b.push(k)}c&&c(b)}});p.openRoleForm(C())},C=function(){for(var p=[],H=0;H<b.length;H++){var A=b[H].getValue();p.push(A)}return p}}function n(b){var e,a,c,q=this,f,C=!1,p,H,A,z,x,E,aa,R,k,I;this.setGlobal=function(F){c=F};this.setType=function(F){a=
F};this.getType=function(){return a};this.setIsPreset=function(F){C=F};this.getJqUi=function(){e||V();return e};this.setCardSelectedListener=function(F){x=F};this.setSelected=function(F){(R=F)?e.addClass("modelset-card-selected"):e.removeClass("modelset-card-selected")};this.isSelected=function(){return R};var V=function(){e=$("<div>");e.addClass("modelset-card");e.on("mousedown",t);e.attr("id",b.getFId());e.on("mouseover",function(){ua(!0)});e.on("mouseout",function(){ua(!1)});var F=$("<div>");F.addClass("modelset-detail-container");
var ha=$("<span class='modelset-icon'>");M.background(ha,"icon-card-subject");F.append(ha);p=$("<span class='modelset-name'>");y.makeSelectable(p);p.css("cursor","pointer");C&&p.css("width","190px");p.on("click",function(za){Z.PermChecker.check(function(){za.stopPropagation();Ga.occur(Ga.MODELSET_TYPE_WHEN_ENTER_MAIN_PAGE,Ga.getModelSetType(a));var r=b.getFId(),K=b.getModelSetName(),W=C;Ia.getModelSetMainPageEntrance()(r,K,W)},C)});F.append(p);A=$("<div>");A.addClass("manage-icon-container");g(A);
F.append(A);e.append(F);C&&J(F);F=$("<div class='dataModel-detail-container'>");E=da(b.getTableModelNum(),"icon-tablemodel",d.get("tableModel","\u6570\u636e\u8868\u6a21\u578b"));y.layoutCtrlWithLRTB(E,30,null,103,0,null,60);E.find(".dataModel-icon").css({left:"8px"});E.find(".dataModel-name").css({left:"8px"});F.append(E);aa=da(b.getMetricModelNum(),"icon-metricmodel",d.get("metricModel","\u6307\u6807\u6a21\u578b"));y.layoutCtrlWithLRTB(aa,null,30,103,0,null,60);F.append(aa);y.makeSelectable(F,!1);
e.append(F);z=$("<div>");z.addClass("icon-container");I=new U;I.setIconType(U.ICON_TYPE_INFO);I.setTipsSize(250,130);I.setTipsHtml(ca());k=I.getJqUi();y.layoutCtrlWithLRTB(k,null,72,16,9,null,16);C&&y.layoutCtrlWithLRTB(k,null,10,16,9,null,16);z.append(k);H=$("<span class='modelset-card-card-pic'>");H.on("click",function(){Z.PermChecker.check(Ba,C)});M.backgroundWithHover(H,b.getDisabled()==n.DISABLED?"disable":"enable");!C&&z.append(H);H.css({cursor:"pointer"});y.layoutCtrlWithLRTB(H,null,33,34,
0,null,34);e.append(z);F=$("<span class='modelset-card-card-pic'>");F.css({cursor:"pointer"});M.backgroundWithHover(F,"auth");F.attr("title",d.get("cooperManager","\u534f\u4f5c\u6210\u5458\u7ba1\u7406"));F.on("click",function(){Z.PermChecker.check(Ra,C)});!C&&z.append(F);y.layoutCtrlWithLRTB(F,null,4,34,0,null,34);F=$("<span>");F.css({cursor:"pointer"});M.backgroundWithHover(F,"btn-copy");F.attr("title","\u590d\u5236");F.on("click",Ha);ja()},ca=function(){function F(wa,Ea){var Ca;this.getJqUi=function(){if(!Ca){Ca=
$("<div class='modelset-info-tips'>");var Fa=$("<span>");Fa.text(wa);Fa.css("font-weight","bold");var Da=$("<span>");Ea&&Da.text(Ea);Ca.append(Fa);Ca.append(Da)}return Ca}}var ha=$("<div>"),za=b.getCreatorName();C&&(za=d.get("systemPreset","\u7cfb\u7edf\u9884\u7f6e"));za=(new F(d.get("creatorWithColon","\u521b\u5efa\u4eba\uff1a"),za)).getJqUi();var r=new X;r.setFormatString("yyyy/MM/dd HH:mm:ss");r=r.format(b.getCreateTime());r=(new F(d.get("createTimeWithColon","\u521b\u5efa\u65f6\u95f4\uff1a"),
r)).getJqUi();var K=(new F(d.get("modelSetNameWithColon","\u540d\u79f0\uff1a"),b.getModelSetName())).getJqUi(),W=(new F(d.get("descriptionWithColon","\u63cf\u8ff0\uff1a"),b.getDescription())).getJqUi();ha.append(za);ha.append(r);ha.append(K);ha.append(W);return ha},t=function(F){x&&x(q)},S=function(){var F=b.getFId(),ha=n.DISABLED;b.getDisabled()==n.DISABLED&&(ha=n.ENABLED);var za=c.createFacade(function(){b.setDisabled(ha);M.backgroundWithHover(H,b.getDisabled()==n.DISABLED?"disable":"enable");ja();
var r=d.get("modelDisableTipsCallBack","\u6a21\u578b\u96c6\u201c#1\u201d\u7981\u7528\u6210\u529f\u3002");b.getDisabled()!=n.DISABLED&&(r=d.get("modelEnableTipsCallBack","\u6a21\u578b\u96c6\u201c#1\u201d\u542f\u7528\u6210\u529f\u3002"));r=r.replace("#1",b.getModelSetName());c.getMessageCurtain().showSuccess(r);Ga.occur(Ga.MODELSET_IS_ENABLE_OR_DISABLE,Ga.getEnableStatus(ha))},function(r,K){return 20005002==r?(c.getMessageCurtain().showPrompt(d.get("modelSetDeleted","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\u6216\u65e0\u6743\u9650\u3002")),
!0):!1});za.setShowBlocking(!0);za.updateModelSetEnabledStatus(F,ha)},ja=function(){I&&I.setTipsHtml(ca());var F=b.getModelSetName();p.text(F);p.attr("title",F);F=b.getDisabled()==n.DISABLED?d.get("enable","\u70b9\u51fb\u542f\u7528"):d.get("disabled","\u70b9\u51fb\u7981\u7528");H.attr("title",F);a==n.COOPERATION&&b.getPermission()!=n.COOPERATION_ADMIN||C?(A.hide(),z.css({"background-color":"#F1F1F1"})):(A.show(),z.css({"background-color":"#E6F1FE"}))};this.updateModelNum=function(){E.find(".dataModel-number").text(b.getTableModelNum());
aa.find(".dataModel-number").text(b.getMetricModelNum())};var ua=function(F){C||a==n.COOPERATION&&b.getPermission()!=n.COOPERATION_ADMIN||(F?(p.css("width","170px"),e.find(".edit-icon").css("display","block"),e.find(".delete-icon").css("display","block")):(p.css("width","230px"),e.find(".edit-icon").css("display","none"),e.find(".delete-icon").css("display","none")))},da=function(F,ha,za){var r=$("<div>");r.addClass("dataModel-Info-container");var K=$("<div>");K.addClass("dataModel-number");K.text(F);
r.append(K);y.layoutCtrlCenterAlign(K,103);F=$("<div>");F.addClass(ha+"-dataModel-mark");K=$("<span class='dataModel-icon'>");M.background(K,ha);F.append(K);ha=$("<span class='dataModel-name'>");ha.text(za);F.append(ha);r.append(F);r.attr("title",za);"Data Table Model"==za?(F.css({"max-width":"155px",width:"155px","margin-left":"-14px"}),ha.css({"max-width":"105px"})):"Metric Model"==za&&F.css({"margin-left":"-12px"});return r},g=function(F){if(!C){var ha=$("<span>");ha.addClass("edit-icon icon");
ha.attr("title",d.get("edit","\u7f16\u8f91"));M.backgroundWithHover(ha,"btn-edit");ha.on("click",function(){Z.PermChecker.check(P)});ha.appendTo(F);ha=$("<span>");ha.addClass("delete-icon icon");ha.attr("title",d.get("delete","\u5220\u9664"));ha.on("click",function(){Z.PermChecker.check(oa)});M.backgroundWithHover(ha,"btn-delete");ha.appendTo(F)}},J=function(F){var ha=$("<div>");y.makeSelectable(ha);ha.addClass("modelset-card-preset-text");ha.text(d.get("presetTag","\u9884 \u7f6e"));var za=$("<div>");
za.addClass("modelset-card-preset-icon");M.background(za,"icon-preset-big");ha.appendTo(F);za.appendTo(F)},P=function(){var F=new xa(b);F.setGlobal(c);F.setSaveOrUpdateSuccessCallback(function(ha){b.setModelSetName(ha.getModelSetName());b.setDescription(ha.getDescription());ja();c.getMessageCurtain().showSuccess(d.get("editDataModelSetTips","\u7f16\u8f91\u6a21\u578b\u96c6\u6210\u529f\u3002"))});F.showDialog()},la=function(){q.getJqUi().remove();f&&f(b,a)},oa=function(){if(0<b.getTableModelNum()||
0<b.getMetricModelNum()){var F=d.get("deleteModelTips","\u8bf7\u5148\u5220\u9664\u6a21\u578b\u96c6\u4e0b\u7684\u6a21\u578b\uff0c\u518d\u5220\u9664\u8be5\u6a21\u578b\u96c6\u3002");c.getMessageCurtain().showPrompt(F)}else{F=d.get("confirmToDeleteModelSet","\u5220\u9664\u6a21\u578b\u96c6\u201c#1\u201d\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u8be5\u6a21\u578b\u96c6\u5417\uff1f");F=F.replace("#1",b.getModelSetName());var ha=new ba(b);ha.setConfirmContent(F);ha.setGlobal(c);ha.addSuccessCallback(function(){la();
c.getMessageCurtain().showSuccess(d.get("deleteSuccess","\u5220\u9664\u6a21\u578b\u96c6\u6210\u529f\u3002"))});ha.showDialog()}},Ba=function(){if(a==n.COOPERATION&&b.getPermission()!=n.COOPERATION_ADMIN){var F=d.get("noPermissionDisableTips","\u60a8\u6ca1\u6709\u7981\u7528\u8be5\u6a21\u578b\u96c6\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u6a21\u578b\u96c6\u521b\u5efa\u8005\u6216\u7ba1\u7406\u5458\u7981\u7528\u3002");b.getDisabled()==n.DISABLED&&(F=d.get("noPermissionEnableTips","\u60a8\u6ca1\u6709\u542f\u7528\u8be5\u6a21\u578b\u96c6\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u6a21\u578b\u96c6\u521b\u5efa\u8005\u6216\u7ba1\u7406\u5458\u542f\u7528\u3002"));
c.getMessageCurtain().showPrompt(F)}else if(b.getDisabled()==n.DISABLED)S();else{F=d.get("modelDisableTips","\u7981\u7528\u540e\uff0c\u8be5\u6a21\u578b\u96c6\u4e0b\u6240\u6709\u5df2\u90e8\u7f72\u7684\u6a21\u578b\u5c06\u65e0\u6cd5\u4f7f\u7528\uff0c\u786e\u5b9a\u7981\u7528\u5417\uff1f");var ha=new ma(b);ha.setGlobal(c);ha.setConfirmContent(F);ha.setEnableListener(S);ha.showDialog()}},Ra=function(){c.createFacade(function(F){var ha=new sa;ha.fromJsonObject(F);b.setPermission(ha.getPermission());b.setUsers(ha.getUsers());
b.setRoles(ha.getRoles());F=new na(b);F.setGlobal(c);F.addSuccessCallback(function(za){za?(b.setUsers(za.getUsers()),b.setRoles(za.getRoles()),b.setPermission(za.getPermission()),b.setCreatorName(za.getCreatorName()),ja()):la();c.getMessageCurtain().showSuccess(d.get("setSuccess","\u8bbe\u7f6e\u6210\u529f\u3002"))});F.createDialog().show()},function(F){return 20005002==F?(c.getMessageCurtain().showPrompt(d.get("modelSetDeleted","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\u6216\u65e0\u6743\u9650\u3002")),
!0):!1}).loadCoopInfoDetails(b)},Ha=function(){console&&console.log("--copy ModelSet--")};this.setDelModelSetCallBack=function(F){f=F}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.ui&&(com.kingdee.bos.qing.modeler.modelset.ui={});var Z=com.kingdee.bos.qing.modeler.modelset.ui;Z.Main=function(){var b,e,a={},c={},q,f,C,p,H,A,z,x,E,aa=0;this.setMessageResize=function(r){E=r};this.setMessageWidth=function(r){aa=r};ta=new function(){var r;this.getMessageCurtain=function(){r||(r=new u,r.getJqUi().appendTo($("body")));return r};this.createFacade=function(K,W,wa){var Ea=Ia.getRemoteImpl();return new Aa(Ea,K,function(Ca,
Fa){return W?W(Ca,Fa):!1},wa)}};this.createJqUi=function(){var r=Ja.decodeParamFromUrl(location.search,"path");com.kingdee.bos.qing.modeler.modelset.common.Integration.setRemoteUrl((r?r:"/ierp")+"/qingmodeler/modelSetManage.do");b=$("<div class='modelset-manage'>");k(b);I();return b};var R=function(){document.body.style.height=document.documentElement.clientHeight+"px"},k=function(r){q=$("<div class='modelset-manage-toolbar'>");var K=$("<input type='file' id='uploadBtn'>");K.addClass("import-model-file");
K.css("display","none");K.attr("accept",[".qing-mds"]);K.on("change",function(W){if(W=b.find("#uploadBtn").get(0).files[0]){var wa=W.name,Ea=W.size,Ca=wa.lastIndexOf(".");wa=wa.substring(Ca+1,wa.length).toLowerCase();b.find("#uploadBtn").val("");"qing-mds"!=wa?ta.getMessageCurtain().showPrompt(d.get("fileTypeIncorrect","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3):0==Ea?ta.getMessageCurtain().showPrompt(d.get("uploadFileIsNull","\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a\u7a7a\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),
2E3):104857600<=Ea?ta.getMessageCurtain().showPrompt(d.get("fileTooLarge","\u6587\u4ef6\u592a\u5927\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3):(Ea=new Ma,Ea.createJqUi(W,ta,ta.getMessageCurtain()),Ea.setFunRefreshModelGroup(I))}K.val("")});K.appendTo(b);g(q,!1,function(){K.click()},"import",d.get("import","\u5bfc\u5165"),d.get("import","\u5bfc\u5165"));g(q,!1,ha,"export",d.get("export","\u5bfc\u51fa"),d.get("export","\u5bfc\u51fa"));g(q,!1,za,"resourceLimit",d.get("resources","\u8d44\u6e90\u9650\u989d"),
d.get("resources","\u8d44\u6e90\u9650\u989d"));g(q,!1,I,"refresh",d.get("refresh","\u5237\u65b0"),d.get("refresh","\u5237\u65b0"));z=V();q.append(z);r.append(q)},I=function(){A&&A.remove();A=$("<div class='modelset-manage-container'>");J(A);b.append(A);R();var r=new T;r.setCallbackImmediately(function(){R();A&&A&&A.css({width:da()+"px"});E&&E()});r.setDelay(250);r.observe()},V=function(){f=new G;f.addSearchListener(t);f.setSearchListenerDelay(0);f.setPlaceholder(d.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));
f.setShowSearchIcon(!0);var r=f.getJqUi();r.addClass("modelset-manage-toolbar-searchBox");r.css("right",20+aa+"px");r.find(":input").on("keydown",function(K){13==(K.keyCode||K.which||K.charCode)&&t()});f.setFoucs();document.body.addEventListener("mousedown",ca,!0);return r},ca=function(r){for(r=r.target;r!=document.body;){if(r==z[0]||A&&r==A[0]||p&&r==p.getJqUi()[0])return;r=r.parentNode}p&&ua(!1);document.body.removeEventListener("mousedown",ca,!0)},t=function(){C=f.getText();var r=0;p||(p=new ea,
p.setFunCloseSearchResultPanel(function(){p&&ua(!1)}),p.setFunItemSelectedListener(S),p.getJqUi().appendTo(b));H||(H=$("<div>"),H.addClass("modelset-search-total-records"),H.text(d.get("searchTotalRecords","\u5171\u627e\u5230\u201c#1\u201d\u4e2a\u7ed3\u679c").replace("#1",r)),H.css({"margin-top":"16px","margin-left":"10px",height:"20px",width:"300px","border-bottom":"2px solid rgb(226, 231, 239)"}),H.appendTo(p.getJqUi()));document.body.addEventListener("mousedown",ca,!0);ua(!0);var K=[];C&&C.trim()?
(C=C.trim().toUpperCase(),p.setSearchText(C),K=[],$.each(a,function(W,wa){for(W=0;W<wa.length;W++){var Ea=wa[W],Ca=Ea.getModelSetName().toUpperCase(),Fa=Ea.getDescription().toUpperCase(),Da=Ea.getCreatorName().toUpperCase();(-1<Ca.indexOf(C)||-1<Fa.indexOf(C)||-1<Da.indexOf(C))&&K.push(Ea)}}),p.setArrItemModel(K),r=K.length,H.text(d.get("searchTotalRecords","\u5171\u627e\u5230#1\u4e2a\u7ed3\u679c").replace("#1",r)),p.refresh()):ua(!1)},S=function(r){var K=$("#"+r.getFId()),W=c[r.getFId()];if(W){var wa=
A.find(".modelset-create").height();W.getType()==n.CREATE?wa=0:W.getType()==n.PRESET&&(wa=A.find(".modelset-cooperation").height()+wa);ja("modelset-manage-container",K,wa);W=new L;W.setTimes(2,!0);W.blink(K,"modelset-twinkle-high-light","modelset-card-selected");W.setAction(function(){var Ea=c[r.getFId()];la&&la(Ea);K.addClass("modelset-card-selected")})}},ja=function(r,K,W){document.querySelector("."+r).scrollTop=K.prop("offsetTop")+W},ua=function(r){r?p.getJqUi().show():p.getJqUi().hide();r=da(r);
A.css("width",r+"px")},da=function(r){var K=document.documentElement.clientWidth-20;p&&(r||"block"==p.getJqUi().css("display"))&&(K-=p.getJqUi().width());return K},g=function(r,K,W,wa,Ea,Ca){var Fa=function(Ka,Sa,Va,Ua){var Ta=Ka.data("menu");if(Ta&&Ta.isShowing())Ka.data("menu",null),Ta.hide();else{Ta=new com.kingdee.bos.qing.ui.component.Menu;Ta.setModel(Va());Ta.setHideListener(function(){Ka.data("menu",null)});Ka.data("menu",Ta);Va=null==Ua?_jqCorePane:Ua;Ua=Ka.prop("offsetLeft");var Wa=Ka.prop("offsetHeight")+
Ka.prop("offsetTop");Ta.show(Va,Ua,Wa,Sa,!0)}},Da=new v;Da.setIconSetter(function(Ka,Sa){M.background(Ka,Sa)});Da.setIconName(wa);Da.setText(Ea);Da.setTooltips(Ca);K&&Da.setShowDropdownArrow(!0);Da.addActionListener(function(Ka,Sa){K?Fa(Ka.getJqUi(),Sa,W,r):W(Ka)});Da.getJqUi().appendTo(r);return Da},J=function(r){ta.createFacade(function(K){ka.unsubscribeChannel("modelSetCard",P);$.each(K,function(W,wa){var Ea=$("<div>");Ea.append(Ha(W));Ea.addClass(e);var Ca=$("<div>");W==n.CREATE?Ca.addClass("create-modelset-card-container"):
W==n.COOPERATION?Ca.addClass("cooperation-modelset-card-container"):Ca.addClass("preset-modelset-card-container");Ca.css("display","block");W==n.CREATE&&Ca.append(Ba());var Fa=[];if(0<wa.length)for(var Da=0;Da<wa.length;Da++){var Ka=wa[Da],Sa=new sa;Sa.fromJsonObject(Ka);Fa.push(Sa);Ka=new n(Sa);Ka.setType(W);Ka.setGlobal(ta);Ka.setCardSelectedListener(la);Ka.setDelModelSetCallBack(F);Ka.setIsPreset(W===n.PRESET);Ca.append(Ka.getJqUi());c[Sa.getFId()]=Ka}else W!=n.COOPERATION&&W!=n.PRESET||Ca.append(oa(W));
a[W]=Fa;Ea.append(Ca);r.append(Ea)});ka.subscribeChannel("modelSetCard",P)}).loadAllModelSetInfo()},P=function(r){r=JSON.parse(r);var K=r.id,W=r[fa.DATA_TABLE_MODEL]?Number(r[fa.DATA_TABLE_MODEL]):0,wa=r[fa.ENTITY_MODEL]?Number(r[fa.ENTITY_MODEL]):0,Ea=r[fa.RELATION_MODEL]?Number(r[fa.RELATION_MODEL]):0,Ca=r[fa.METRICS_MODEL]?Number(r[fa.METRICS_MODEL]):0;$.each(a,function(Fa,Da){for(Fa=0;Fa<Da.length;Fa++)if(K==Da[Fa].getFId()){Da[Fa].setTableModelNum(W);Da[Fa].setEntityModelNum(wa);Da[Fa].setRelationModelNum(Ea);
Da[Fa].setMetricModelNum(Ca);c[K]&&c[K].updateModelNum();break}})},la=function(r){x!=r&&(r.setSelected(!0),x&&x.setSelected(!1),x=r)},oa=function(r){var K=$("<div>");K.addClass("no-modelset-display-container");var W=$("<div>");W.addClass("no-modelset-display-icon");M.background(W,"icon-empty");K.append(W);W=$("<div>");W.addClass("no-modelset-display-text");r==n.COOPERATION?W.text(d.get("noCooperationModelSet","\u6682\u65e0\u53c2\u4e0e\u534f\u4f5c\u7684\u6a21\u578b\u96c6")):W.text(d.get("noPreSetModelSet",
"\u6682\u65e0\u9884\u7f6e\u7684\u6a21\u578b\u96c6"));K.append(W);return K},Ba=function(){var r=$("<div>");r.addClass("modelset-create-card");var K=$("<div>");K.addClass("new-modelset-detail-container");K.on("click",Ra);var W=$("<div>");W.addClass("new-modelset-icon");M.background(W,"btn-new-image");K.append(W);y.layoutCtrlCenterAlign(W,50);var wa=$("<div>");wa.addClass("new-modelset-text");wa.text(d.get("newModelSet","\u521b\u5efa\u6a21\u578b\u96c6"));wa.attr("title",d.get("newModelSet","\u521b\u5efa\u6a21\u578b\u96c6"));
K.append(wa);r.append(K);r.on("mouseover",function(){wa.css("color","#276FF5");M.background(W,"btn-new-image-hover")});r.on("mouseout",function(){wa.css("color","#999999");M.background(W,"btn-new-image")});return r},Ra=function(){var r=new xa(new sa);r.setGlobal(ta);r.setSaveOrUpdateSuccessCallback(function(K){a[n.CREATE].unshift(K);var W=new n(K);W.setType(n.CREATE);W.setGlobal(ta);W.setCardSelectedListener(la);W.setDelModelSetCallBack(F);K.setTableModelNum(0);K.setEntityModelNum(0);K.setRelationModelNum(0);
c[K.getFId()]=W;K=W.getJqUi();W=$(".modelset-create .create-modelset-card-container");W.children()[1]?K.insertBefore(W.children()[1]):W.append(K);ta.getMessageCurtain().showSuccess(d.get("createDataModelSetTips","\u521b\u5efa\u6a21\u578b\u96c6\u6210\u529f\u3002"))});r.showDialog()},Ha=function(r){var K=$("<div>");K.addClass("title-container");var W=$("<span class='title-icon'>");M.background(W,"icon_down");W.on("click",function(){var Fa=$;a:{switch(r){case n.CREATE:var Da="modelset-create";break a;
case n.COOPERATION:Da="modelset-cooperation";break a;case n.PRESET:Da="modelset-preset";break a}Da=void 0}(Fa=Fa("."+Da).find("."+r.toLowerCase()+"-modelset-card-container"))&&"block"==Fa.css("display")?(Fa.hide(),M.background(W,"icon-right")):(Fa.show(),M.background(W,"icon_down"))});K.append(W);var wa=$("<span class='title-name'>"),Ea=wa.text;a:{switch(r){case n.CREATE:e="modelset-create modelset-title";var Ca=d.get("createdOfModelSet","\u6211\u521b\u5efa\u7684\u6a21\u578b\u96c6");break a;case n.COOPERATION:e=
"modelset-cooperation modelset-title";Ca=d.get("cooperationOfModelSet","\u6211\u53c2\u4e0e\u534f\u4f5c\u7684\u6a21\u578b\u96c6");break a;case n.PRESET:e="modelset-preset modelset-title";Ca=d.get("preSetOfModelSet","\u5f53\u524d\u7cfb\u7edf\u9884\u7f6e\u7684\u6a21\u578b\u96c6");break a}Ca=void 0}Ea.call(wa,Ca);K.append(wa);return K},F=function(r,K){var W=a[K],wa=W.indexOf(r);c[r.getFId()]=void 0;-1<wa&&(W.splice(wa,1),0==W.length&&(K==n.COOPERATION?A.find(".cooperation-modelset-card-container").append(oa(K)):
K==n.PRESET&&A.find(".preset-modelset-card-container").append(oa(K))))},ha=function(){ta.createFacade(function(r){var K=new ya;r?(K.fromJsonObject(r),r=new La,r.setRootNode(K),r.setGlobal(ta),r.setMessageCurtain(ta.getMessageCurtain()),r.showExportDialog()):ta.getMessageCurtain().showPrompt(d.get("noModelSetForExport","\u6ca1\u6709\u53ef\u4f9b\u5bfc\u51fa\u7684\u6a21\u578b\u96c6\u3002"),2E3)},function(r,K){if(20009001===r)return r=d.get("invalidPermissionForExport","\u65e0\u5bfc\u51fa\u6743\u9650\u3002"),
ta.getMessageCurtain().showPrompt(r,2E3),!0}).getAllModelSetForExport()},za=function(){ta.createFacade(function(r){var K=new ra;K.setGlobal(ta);K.setPublic(r);K.showDialog()},function(r,K){return!1}).hasResourceManager()}};var Aa,Ia,Ja,M,d,sa,Na,D,Pa,Oa,Qa,y,u,v,l,B,w,h,G,m,O,T,ka,U,X,Q,fa,ya,La,Ma,Ga,ra;(function(){var b=com.kingdee.bos.qing.modeler.modelset.common;Aa=b.Facade;Ia=b.Integration;M=b.Icons;Ga=b.UserOperationReporter;b=com.kingdee.bos.qing.modeler.common.model;fa=b.ModelType;b=com.kingdee.bos.qing.modeler.common.ui;
B=b.HeadImgGenerator;Q=b.SearchNoDataContainer;b=com.kingdee.bos.qing.common;Ja=b.Util;y=b.DomUtil;X=b.DateFormater;b=com.kingdee.bos.qing.framework.common;d=b.MultilanguageManager.createPackageAccessor(Z);T=b.WindowResizeObserver;ka=b.RemoteFramework;b=com.kingdee.bos.qing.modeler.modelset.model;sa=b.ModelSetInfo;h=b.ValueTextPair;b=com.kingdee.bos.qing.ui.component;Na=b.Dialog;D=b.MessageDialog;Pa=b.Label;Oa=b.TextField;Qa=b.TextArea;u=b.MessageCurtain;v=b.ToolbarButton;l=b.TabContainer;G=b.SearchBox;
m=b.ComboBox;O=b.List;U=b.HelpIcon;b=com.kingdee.bos.qing.modeler.modelset.imexport;La=b.ExportDialog;Ma=b.UploadPane;ya=b.FolderNode;b=com.kingdee.bos.qing.integration;w=b.UserAndRoleForm;ra=Z.ResourceDetailDialog})();var ta;Z.PermChecker=new function(){this.check=function(e,a){var c=Ia.getRemoteImpl();(new Aa(c,function(q){q?a?b(e):e&&e():ta.getMessageCurtain().showPrompt(d.get("noMenuPermission","\u60a8\u6ca1\u6709\u5f53\u524d\u83dc\u5355\u6743\u9650\u3002"))},function(q){ta.getMessageCurtain().showPrompt(d.get("noMenuPermission",
"\u60a8\u6ca1\u6709\u5f53\u524d\u83dc\u5355\u6743\u9650\u3002"));return!1})).checkQingModelerPermission()};var b=function(e){var a=Ia.getRemoteImpl();(new Aa(a,function(c){c?e&&e():ta.getMessageCurtain().showPrompt(d.get("noPermissionViewPreset","\u60a8\u6ca1\u6709\u201c\u9884\u7f6e\u6a21\u578b\u96c6\u67e5\u8be2\u201d\u7684\u83dc\u5355\u6743\u9650\u3002"))},function(c){ta.getMessageCurtain().showPrompt(d.get("noPermissionViewPreset","\u60a8\u6ca1\u6709\u201c\u9884\u7f6e\u6a21\u578b\u96c6\u67e5\u8be2\u201d\u7684\u83dc\u5355\u6743\u9650\u3002"));
return!1})).checkQingModelerPresetPermission()}};qa.USER="0";qa.ROLE="1";Z.ModelSetCard=n;n.CREATE="CREATE";n.COOPERATION="COOPERATION";n.PRESET="PRESET";n.COOPERATION_ADMIN="0";n.DISABLED="1";n.ENABLED="0"})();
//qingVersionTag: 20250324