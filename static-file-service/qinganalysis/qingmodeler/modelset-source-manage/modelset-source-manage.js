var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(T,V,X){T instanceof String&&(T=String(T));for(var Y=T.length,ca=0;ca<Y;ca++){var xa=T[ca];if(V.call(X,xa,ca,T))return{i:ca,v:xa}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(T,V,X){if(T==Array.prototype||T==Object.prototype)return T;T[V]=X.value;return T};$jscomp.getGlobal=function(T){T=["object"==typeof globalThis&&globalThis,T,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var V=0;V<T.length;++V){var X=T[V];if(X&&X.Math==Math)return X}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(T,V){var X=$jscomp.propertyToPolyfillSymbol[V];if(null==X)return T[V];X=T[X];return void 0!==X?X:T[V]};
$jscomp.polyfill=function(T,V,X,Y){V&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(T,V,X,Y):$jscomp.polyfillUnisolated(T,V,X,Y))};$jscomp.polyfillUnisolated=function(T,V,X,Y){X=$jscomp.global;T=T.split(".");for(Y=0;Y<T.length-1;Y++){var ca=T[Y];if(!(ca in X))return;X=X[ca]}T=T[T.length-1];Y=X[T];V=V(Y);V!=Y&&null!=V&&$jscomp.defineProperty(X,T,{configurable:!0,writable:!0,value:V})};
$jscomp.polyfillIsolated=function(T,V,X,Y){var ca=T.split(".");T=1===ca.length;Y=ca[0];Y=!T&&Y in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var xa=0;xa<ca.length-1;xa++){var Ka=ca[xa];if(!(Ka in Y))return;Y=Y[Ka]}ca=ca[ca.length-1];X=$jscomp.IS_SYMBOL_NATIVE&&"es6"===X?Y[ca]:null;V=V(X);null!=V&&(T?$jscomp.defineProperty($jscomp.polyfills,ca,{configurable:!0,writable:!0,value:V}):V!==X&&(void 0===$jscomp.propertyToPolyfillSymbol[ca]&&(X=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[ca]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(ca):$jscomp.POLYFILL_PREFIX+X+"$"+ca),$jscomp.defineProperty(Y,$jscomp.propertyToPolyfillSymbol[ca],{configurable:!0,writable:!0,value:V})))};$jscomp.polyfill("Array.prototype.find",function(T){return T?T:function(V,X){return $jscomp.findInternal(this,V,X).v}},"es6","es3");$jscomp.owns=function(T,V){return Object.prototype.hasOwnProperty.call(T,V)};
$jscomp.polyfill("Object.entries",function(T){return T?T:function(V){var X=[],Y;for(Y in V)$jscomp.owns(V,Y)&&X.push([Y,V[Y]]);return X}},"es8","es3");
(function(){function T(){var M=this,y,D,d,a,k,n,q,h,m,w;this.getId=function(){return y};this.setId=function(t){y=t};this.getSourceName=function(){return D};this.setSourceName=function(t){D=t};this.getModelSetId=function(){return d};this.setModelSetId=function(t){d=t};this.getSourceType=function(){return a};this.setSourceType=function(t){a=t};this.getModelerSource=function(){return k};this.setModelerSource=function(t){k=t};this.getRefSourceType=function(){return n};this.getRefSourceName=function(){return q};
this.getErrorMessage=function(){return h};this.getCreatorName=function(){return m};this.getCreateTime=function(){return w};this.copy=function(){var t=new T;t.fromJsonObject(M.toJsonObject());return t};this.fromJsonObject=function(t){y=t.id;a=t.sourceType;var K=t.source;if(K){if(a==da.ModelerSourceType.ERPCloudEntity)k=new H,n=ea.get("ERPCloudBusinessEntity","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79-\u4e1a\u52a1\u5b9e\u4f53");else if(a==da.ModelerSourceType.ERPCloudDBCenter)k=new H,n=ea.get("ERPCloudDBCenter",
"\u91d1\u8776\u4e91\u00b7\u82cd\u7a79-\u6570\u636e\u4e2d\u5fc3");else if(a==da.ModelerSourceType.PublicDBSource)k=new ka,n=ea.get("publicDBSource","\u516c\u5171\u6570\u636e\u6e90-\u6570\u636e\u5e93");else if(a==da.ModelerSourceType.ModelSet)k=new Ia,n=ea.get("modelSet","\u6a21\u578b\u96c6");else if(a==da.ModelerSourceType.FileSource)switch(K.fileType){case ca.TYPE_EXCEL:k=new xa;break;case ca.TYPE_XML:k=new Ka;break;case ca.TYPE_TXT:case ca.TYPE_CSV:k=new Ca;break;default:throw Error("do not support this file type!");
}else a==da.ModelerSourceType.DBSource?k=new Y:a==da.ModelerSourceType.OpenAPI&&(k=new pa,n=ea.get("OpenAPI","OpenAPI"));k.fromJsonObject(K)}t.sourceName?D=t.sourceName:a==da.ModelerSourceType.ERPCloudEntity?D=ea.get("businessEntity","\u4e1a\u52a1\u5b9e\u4f53"):a==da.ModelerSourceType.ERPCloudDBCenter&&(D=ea.get("DBCenter","\u6570\u636e\u4e2d\u5fc3"));q=t.refSourceName;h=t.errorMessage;m=t.creatorName;w=new Date(t.createTime)};this.toJsonObject=function(){var t={};t.id=y;t.sourceName=D;t.modelSetId=
d;t.sourceType=a;k&&(t.source=k.toJsonObject());return t};this.getSearchContent=function(){var t=[];if(h)return t;D&&t.push(D);m&&t.push(m);n&&t.push(n);a==da.ModelerSourceType.PublicDBSource?k.getRefSourceDBName()&&t.push(k.getRefSourceDBName()):a==da.ModelerSourceType.DBSource&&(k.getDbAddress()&&t.push(k.getDbAddress().toUpperCase()),k.getDbName()&&t.push(k.getDbName()),k.getSchema()&&t.push(k.getSchema()));return t}}function V(){var M,y,D,d;this.getId=function(){return M};this.getFromType=function(){return y};
this.getFromId=function(){return D};this.getModelName=function(){return d};this.fromJsonObject=function(a){M=a.id;y=a.fromType;D=a.fromId;d=a.modelName}}function X(){var M=this,y;this.setType=function(D){y=D};this.getType=function(){return y};this.clone=function(){throw Error("Override me.");};this.toJsonObject=function(){var D={};D.type=y;M.protectedToJsonObject(D);return D};this.fromJsonObject=function(D){y=D.type;M.protectedFromJsonObject(D)};this.protectedToJsonObject=function(){throw Error("Override me.");
};this.protectedFromJsonObject=function(D){throw Error("Override me.");};this.isSupportDelete=function(){return!0}}function Y(){X.call(this);var M=this,y,D,d,a,k,n,q,h,m,w=!0,t=new qa;this.getTypeName=function(){return M.getDbType()};this.getAdvanceSetting=function(){return t};this.setAdvanceSetting=function(K){t=K};this.getDbAddress=function(){return D};this.setDbType=function(K){y=K};this.getDbType=function(){return y};this.setDbAddress=function(K){D=K};this.getDbAddress=function(){return D};this.setDbPort=
function(K){d=K};this.getDbPort=function(){return d};this.setDbName=function(K){a=K};this.getDbName=function(){return a};this.setUserName=function(K){k=K};this.getUserName=function(){return k};this.setPassword=function(K){n=K};this.getPassword=function(){return n};this.setIsPasswordUpdated=function(K){w=K};this.isPasswordUpdated=function(){return w};this.setSchema=function(K){q=K};this.getSchema=function(){return q};this.setDbVersion=function(K){h=K};this.getDbVersion=function(){return h};this.setConnectType=
function(K){m=K};this.getConnectType=function(){return m};this.clone=function(){var K=new Y;K.setType(M.getType());K.setDbType(y);K.setDbAddress(D);K.setDbPort(d);K.setDbName(a);K.setUserName(k);K.setPassword(n);K.setSchema(q);K.setDbVersion(h);K.setConnectType(m);var ta=new qa;ta.setTimezone(t.getTimezone());ta.setCharset(t.getCharset());ta.setOtherSetting(t.getOtherSetting());K.setAdvanceSetting(ta);return K};this.protectedFromJsonObject=function(K){y=K.dbType;D=K.dbAddress;d=K.dbPort;a=K.dbName;
k=K.userName;n=ha.decode(K.password);K.schema&&(q=K.schema);K.dbVersion&&(h=K.dbVersion);K.connectType&&(m=K.connectType);K.advanceSetting&&t.fromJsonObject(K.advanceSetting)};this.protectedToJsonObject=function(K){K.type=da.ModelerSourceType.DBSource;K.dbType=y;K.dbAddress=D;K.dbPort=d;K.dbName=a;K.userName=k;K.password=ha.encode(n);q&&(K.schema=q);h&&(K.dbVersion=h);m&&(K.connectType=m);K.advanceSetting=t.toJsonObject();return K}}function ca(){X.call(this);var M=this,y,D,d,a,k;this.setFileName=
function(n){y=n};this.getFileName=function(){return y};this.setFileType=function(n){D=n};this.getFileType=function(){return D};this.setFileUrl=function(n){d=n};this.getFileUrl=function(){return d};this.setCharacterSet=function(n){a=n};this.getCharacterSet=function(){return a};this.setDefineTypeRowCount=function(n){k=n};this.getDefineTypeRowCount=function(){return k};this.clone=function(){var n=new ca;n.setFileType(D);n.setFileName(y);n.setFileUrl(d);return n};this.protectedToJsonObject=function(n){n.fileType=
D;n.fileName=y;n.fileUrl=d;n.characterSet=a;n.defineTypeRowCount=k;M.protectedToFileJsonObject(n);return n};this.protectedFromJsonObject=function(n){D=n.fileType;y=n.fileName;d=n.fileUrl;a=n.characterSet;k=n.defineTypeRowCount;M.protectedFromFileJsonObject(n)};this.protectedToFileJsonObject=function(n){};this.protectedFromFileJsonObject=function(n){}}function xa(){ca.call(this);var M=this;this.clone=function(){var y=new xa;y.setFileType(M.getFileType());y.setFileName(M.getFileName());y.setFileUrl(M.getFileUrl());
y.setCharacterSet(M.getCharacterSet());y.setDefineTypeRowCount(M.getDefineTypeRowCount());return y};this.getDisplayName=function(){return"Excel"}}function Ka(){ca.call(this);var M=this;this.clone=function(){var y=new Ka;y.setFileType(M.getFileType());y.setFileName(M.getFileName());y.setFileUrl(M.getFileUrl());y.setCharacterSet(M.getCharacterSet());y.setDefineTypeRowCount(M.getDefineTypeRowCount());return y};this.getDisplayName=function(){return"XML"}}function Ca(){ca.call(this);var M=this,y,D;this.setSplitSign=
function(d){y=d};this.getSplitSign=function(){return y};this.setTextLimitSign=function(d){D=d};this.getTextLimitSign=function(){return D};this.clone=function(){var d=new Ca;d.setFileType(M.getFileType());d.setFileName(M.getFileName());d.setFileUrl(M.getFileUrl());d.setCharacterSet(M.getCharacterSet());d.setDefineTypeRowCount(M.getDefineTypeRowCount());d.setSplitSign(y);d.setTextLimitSign(D);return d};this.protectedToFileJsonObject=function(d){d.splitSign=y;d.textLimitSign=D};this.protectedFromFileJsonObject=
function(d){y=d.splitSign;D=d.textLimitSign};this.getDisplayName=function(){return"TXT"}}function H(){X.call(this);var M=this;this.clone=function(){var y=new H;y.setType(M.getType());return y};this.protectedToJsonObject=function(y){return y};this.protectedFromJsonObject=function(y){};this.isSupportDelete=function(){return!1}}function ka(){X.call(this);var M,y,D,d,a;this.setRefId=function(k){M=k};this.getRefId=function(){return M};this.getSourceType=function(){return y};this.getPublicSourceType=function(){return D};
this.getPublicSourceCreator=function(){return d};this.getRefSourceDBName=function(){return a};this.protectedToJsonObject=function(k){k.refId=M;k.sourceType=y;k.publicSourceType=D;k.publicSourceCreator=d;return k};this.protectedFromJsonObject=function(k){M=k.refId;y=k.sourceType;D=k.publicSourceType;d=k.publicSourceCreator;a=k.refSourceDBName}}function Ia(){X.call(this);var M=this,y,D,d;this.setRefId=function(a){y=a};this.getRefId=function(){return y};this.setRefType=function(a){D=a};this.getRefType=
function(){return D};this.setModelSetCreator=function(a){d=a};this.getModelSetCreator=function(){return d};this.clone=function(){var a=new Ia;a.setType(M.getType());a.setRefId(y);a.setRefType(D);a.setModelSetCreator(d);return a};this.protectedToJsonObject=function(a){a.refId=y;a.refType=D;a.modelSetCreator=d;return a};this.protectedFromJsonObject=function(a){y=a.refId;D=a.refType;d=a.modelSetCreator};this.isSupportDelete=function(){return D!==Ia.TYPE_CURRENT}}function pa(){X.call(this);var M=this,
y,D,d;this.setUrl=function(a){y=a};this.getUrl=function(){return y};this.setAuthModel=function(a){d=a};this.getAuthModel=function(){return d};this.setOpenAPIType=function(a){D=a};this.getOpenAPIType=function(){return D};this.getTypeName=function(){return M.getOpenAPIType()};this.toJsonObject=function(){var a={};a.url=y;a.openAPIType=D;d&&(a.authModel=d);return a};this.fromJsonObject=function(a){y=a.url;D=a.openAPIType;d=a.authModel};this.clone=function(){var a=new pa;a.setUrl(y);a.setOpenAPIType(D);
a.setAuthModel(d);return a}}function ra(){var M;this.getAuthType=function(){return M};this.setAuthType=function(y){M=y};this.protectedToJsonObject=function(){throw Error("Override me.");};this.protectedFromJsonObject=function(y){throw Error("Override me.");}}function W(){ra.call(this);var M=this,y,D;this.getUserName=function(){return y};this.setUserName=function(d){y=d};this.getPassword=function(){return D};this.setPassword=function(d){D=d};this.protectedToJsonObject=function(){var d={};d.userName=
y;d.psw=D;d.authType=Z.BASIC;return d};this.protectedFromJsonObject=function(d){y=d.userName;D=d.psw;M.setAuthType(d.authType)}}function na(){ra.call(this);var M=this,y,D,d,a;this.getClientId=function(){return y};this.setClientId=function(k){y=k};this.getClientSecret=function(){return D};this.setClientSecret=function(k){D=k};this.getScope=function(){return d};this.setScope=function(k){d=k};this.getAuthURL=function(){return a};this.setAuthURL=function(k){a=k};this.protectedToJsonObject=function(){var k=
{};k.clientId=y;k.clientSecret=D;d&&(k.scope=d);k.authURL=a;k.authType=Z.BEARER;return k};this.protectedFromJsonObject=function(k){y=k.clientId;D=k.clientSecret;d=k.scope;a=k.authURL;M.setAuthType(k.authType)}}function Pa(){ra.call(this);var M=this,y,D;this.getUserName=function(){return y};this.setUserName=function(d){y=d};this.getPassword=function(){return D};this.setPassword=function(d){D=d};this.protectedToJsonObject=function(){var d={};d.userName=y;d.psw=D;d.authType=Z.DIGEST;return d};this.protectedFromJsonObject=
function(d){y=d.userName;D=d.psw;M.setAuthType(d.authType)}}function za(){ra.call(this);var M=this,y,D,d,a,k,n,q,h,m,w;this.getTokenEnhanced=function(){return y};this.setTokenEnhanced=function(t){y=t};this.getAppId=function(){return D};this.setAppId=function(t){D=t};this.getAppSecret=function(){return d};this.setAppSecret=function(t){d=t};this.getUserType=function(){return a};this.setUserType=function(t){a=t};this.getUserTypeValue=function(){return k};this.setUserTypeValue=function(t){k=t};this.getProxyUser=
function(){return n};this.setProxyUser=function(t){n=t};this.getCosmicType=function(){return q};this.setCosmicType=function(t){q=t};this.getAccountId=function(){return m};this.setAccountId=function(t){m=t};this.getTenantId=function(){return w};this.setTenantId=function(t){w=t};this.getCosmicServerAddress=function(){return h};this.setCosmicServerAddress=function(t){h=t};this.protectedToJsonObject=function(){var t={};t.appId=D;t.appSecret=d;t.userType=a;t.userTypeValue=k;t.proxyUser=n;t.cosmicType=
q;h&&(t.accountId=m,t.tenantId=w,t.cosmicServerAddress=h);t.authType=Z.COSMIC;t.tokenEnhanced=y;return t};this.protectedFromJsonObject=function(t){y=t.tokenEnhanced;D=t.appId;d=t.appSecret;a=t.userType;k=t.userTypeValue;n=t.proxyUser;q=t.cosmicType;m=t.accountId;w=t.tenantId;h=t.cosmicServerAddress;M.setAuthType(t.authType)}}function Aa(M,y,D,d,a){this.getName=function(){return M};this.getText=function(){return y};this.getIconName=function(){return a?La.handleIconName(D):D};this.isDisabled=function(){return d}}
"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.source&&(com.kingdee.bos.qing.modeler.modelset.source=
{});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.source.model&&(com.kingdee.bos.qing.modeler.modelset.source.model={});var da=com.kingdee.bos.qing.modeler.modelset.source.model;da.ModelSetSourceVO=T;da.ModelRefSourceVO=V;da.ModelSetDBSource=Y;da.ModelSetFileSource=ca;da.ExcelSource=xa;da.XMLSource=Ka;da.TextSource=Ca;da.ERPCloudSource=H;da.PublicDataSource=ka;da.ModelSetSource=Ia;da.ModelSetVO=function(){var M,y;this.setModelSetId=function(D){M=D};this.getModelSetId=function(){return M};
this.setModelSetName=function(D){y=D};this.getModelSetName=function(){return y};this.fromJsonObject=function(D){M=D.modelSetId;y=D.modelSetName}};da.OpenAPISource=pa;da.SourceType=Aa;da.BasicAuthModel=W;da.BearerAuthModel=na;da.DigestAuthModel=Pa;da.CosmicAuthModel=za;var ha,ea,qa;(function(){var M=com.kingdee.bos.qing.common;ha=M.Base64Util;M=com.kingdee.bos.qing.framework.common;ea=M.MultilanguageManager.createPackageAccessor(da);M=com.kingdee.bos.qing.data;qa=M.DBAdvanceSetting})();da.I18nIconUtil=
new function(){this.handleIconName=function(M){return"en"==com.kingdee.bos.qing.Seer.getUrlParamValue("language")?M+"_EN":M}};var La=da.I18nIconUtil;V.FROM_TYPE_MODEL="MODEL";V.FROM_TYPE_DEPLOY="DEPLOY";da.ModelerSourceType={ERPCloudEntity:"ERPCloudEntity",ERPCloudDBCenter:"ERPCloudDBCenter",DBSource:"DBSource",FileSource:"FileSource",PublicDBSource:"PublicDBSource",ModelSet:"ModelSet",OpenAPI:"OpenAPI"};ca.TYPE_EXCEL="EXCEL";ca.TYPE_CSV="CSV";ca.TYPE_TXT="TXT";ca.TYPE_XML="XML";ka.DB_SOURCE_TYPE=
"DB";Ia.TYPE_CURRENT="Current";Ia.TYPE_OTHER="Other";pa.TYPE_RESTFUL_DATA_SET="RESTFUL_DATA_SET";pa.TYPE_PROGRAM_DATA_SET="PROGRAM_DATA_SET";pa.TYPE_OPENAPI="OpenAPI";da.AuthModelFactory=new function(){var M={};this.getImpl=function(y){if(y=M[y])return new y};this.registImpl=function(y,D){M[y]=D}};var Z=da.AuthModelFactory;Z.BASIC="BASIC";Z.BEARER="BEARER";Z.DIGEST="DIGEST";Z.COSMIC="COSMIC";Z.registImpl(Z.BASIC,W);Z.registImpl(Z.BEARER,na);Z.registImpl(Z.DIGEST,Pa);Z.registImpl(Z.COSMIC,za);Aa.DBSource=
"DBSource";Aa.FileSource="FileSource";Aa.ERPCloud="ERPCloud";Aa.PublicSource="PublicSource";Aa.ModelSet="ModelSet";Aa.OpenAPI="OpenAPI"})();(function(){function T(){xa.call(this);var d;this.getRemoteUrl=function(){return d};this.setRemoteUrl=function(a){d=a}}function V(d){var a,k=this,n,q,h,m,w,t,K,ta;this.setMessageCurtain=function(O){};this.setSelected=function(O){(ta=O)?(h(d),a.addClass("source-manage-content-card-selected")):a.removeClass("source-manage-content-card-selected")};this.getSearchStatus=function(){return t};this.setSelectedListener=function(O){h=O};this.setEditListener=function(O){w=O};this.setDeleteListener=function(O){m=
O};this.setSearchTarget=function(O,ia){t=O;K=ia};this.getTitleJqUi=function(){return n};this.getCreateNameJqUi=function(){return q};this.setSearchTarget=function(O,ia){t=O;K=ia};this.getJqUi=function(){a||(a=$("<div class='source-manage-content-card'>"),n=$("<span class='source-manage-content-card-head-title'>"),q=$("<div class='source-manage-content-card-text'>"),k.protectedInitUi(a),a.on("click",E));sa();return a};this.protectedInitUi=function(O){throw Error("Override me");};var sa=function(){if(!d.getErrorMessage()){d.getSourceName()&&
(t?k.doHighLightText(n,d.getSourceName(),null):n.text(d.getSourceName()),n.attr("title",d.getSourceName()));if(d.getCreatorName()){var O=H.get("creator","\u521b\u5efa\u4eba\uff1a")+d.getCreatorName();t?k.doHighLightText(q,d.getCreatorName(),H.get("creator","\u521b\u5efa\u4eba\uff1a")):q.text(O);q.attr("title",O)}k.protectedUpdateUi()}};this.protectedUpdateUi=function(){throw Error("Override me");};this.getOperationJqUi=function(){if("true"==Y.Integration.getIsPreset())return $("<div>");var O=$("<span class='source-manage-content-card-head-operator'>"),
ia=function(){h(d);w&&w();sa()};if(d.getModelerSource().isSupportDelete()){var P=$("<span>");P.addClass("source-manage-content-card-head-operator-delete delete-icon");P.attr("title",H.get("deleteSource","\u5220\u9664"));P.on("click",function(Da){h(d);m&&m()});y.backgroundWithHover(P,"btn-delete");P.appendTo(O)}d.getErrorMessage()||(P=$("<span>"),P.addClass("source-manage-content-card-head-operator-edit edit-icon"),P.attr("title",H.get("editSource","\u7f16\u8f91")),P.on("click",ia),y.backgroundWithHover(P,
"btn-edit"),P.appendTo(O));return O};this.doHighLightText=function(O,ia,P){if(O&&ia){var Da=K.toUpperCase(),g=ia.toUpperCase(),ya=g.split(Da),Ja=Da.length;O.text("");if(P){var fa=$("<span>");fa.text(P);O.append(fa)}P=$("<span>");for(var ua in ya){fa=g.indexOf(ya[ua]);var Qa=ia.substr(0,ya[ua].length);fa+=ya[ua].length;var va=g.length-fa;g=g.substr(fa,va);ia=ia.substr(fa,va);fa=$("<span>");fa.text(Qa);fa.appendTo(P);if(ua!==ya.length-1&&1<ya.length){va=g.indexOf(Da);Qa=ia.substr(va,Ja);va+=Ja;var Ba=
g.length-va;g=g.substr(va,Ba);ia=ia.substr(va,Ba);va=$("<span>");va.text(Qa);va.css("color","#FF0000");va.appendTo(fa)}}O.append(P)}};var E=function(O){d&&k.setSelected(!0)}}function X(d){var a=this,k;this.getJqUi=function(){k=$("<div>");n(k);a.protectedInitUi(k);d&&a.protectedUpdateModelToUI(d);return k};this.protectedInitUi=function(){throw Error("Override me");};this.protectedUpdateModelToUI=function(q){throw Error("Override me");};this.protectedGetModelFromUI=function(){throw Error("Override me");
};this.protectedCheckParams=function(){throw Error("Override me");};var n=function(q){var h=$("<div>");h.css({"border-bottom":"1px solid #CCCCCC"});W.layoutCtrl(h,10,0,570,23);var m=(new na(H.get("authSettings","\u8ba4\u8bc1\u8bbe\u7f6e"))).getJqUi();m.appendTo(h);m.addClass("openApi-auth-settings");W.layoutCtrl(m,0,0,80,23);q.append(h)};this.protectedMethod={addAuthSettingsJq:n}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&
(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.source&&(com.kingdee.bos.qing.modeler.modelset.source={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.source.common&&(com.kingdee.bos.qing.modeler.modelset.source.common=
{});var Y=com.kingdee.bos.qing.modeler.modelset.source.common;Y.SourceManageFacade=function(d,a,k,n){ca.call(this,d,a,k,n);var q=this.protectedMethod;this.isDisabledSource=function(){q.remote("isDisabledSource",{})};this.loadModelSetSources=function(h){q.remote("loadModelSetSources",{modelSetId:h,orderBySourceType:!1})};this.saveModelSetSource=function(h){h={model:JSON.stringify(h.toJsonObject())};q.remote("saveModelSetSource",h)};this.updateModelSetSource=function(h){var m=h.getModelerSource();h=
{model:JSON.stringify(h.toJsonObject()),actualPassword:m.isPasswordUpdated?m.isPasswordUpdated():!0};q.remote("updateModelSetSource",h)};this.deleteModelSetSource=function(h,m){q.remote("deleteModelSetSource",{sourceId:h,modelSetId:m})};this.loadDBConnections=function(){q.remote("loadPermissionDBConnections",{})};this.loadPermissionModelSet=function(h){q.remote("loadPermissionModelSet",{modelSetId:h})};this.uploadFile=function(h){var m=com.kingdee.bos.qing.framework.common.RemoteFrameworkRegister.getUploadUrl();
h.open("post",m,!0)};this.getFileSize=function(h){q.remote("getFileSize",{fileUrl:h})};this.guessFileEncoding=function(h){q.remote("guessFileEncoding",{filePath:h})};this.loadRefModelInfos=function(h){q.remote("loadRefModelInfos",{sourceId:h})};this.openAPIInitialCheck=function(h){h={source:JSON.stringify(h.toJsonObject())};q.remote("openAPIInitialCheck",h)}};Y.RemoteImpl=T;var ca,xa,Ka,Ca,H,ka,Ia,pa,ra,W,na,Pa,za,Aa,da,ha,ea,qa,La,Z,M;(function(){var d=com.kingdee.bos.qing.framework.common;ca=d.AbstractFacade;
xa=d.AbstractRemoteCall;Ka=d.AbstractIcons;H=d.MultilanguageManager.createPackageAccessor(Y);d=com.kingdee.bos.qing.modeler.modelset.source.model;Ca=d.ModelerSourceType;ea=d.BasicAuthModel;qa=d.BearerAuthModel;La=d.DigestAuthModel;Z=d.CosmicAuthModel;ha=d.AuthModelFactory;d=com.kingdee.bos.qing.data;pa=d.DBSource;d=com.kingdee.bos.qing.dbmanage;Ia=d.DBSourceDisplayNameFactory;d=com.kingdee.bos.qing.ui.component;ka=d.HelpIcon;ra=d.TextField;Aa=d.PasswordField;Pa=d.ComboBox;na=d.Label;da=d.CheckBox;
d=com.kingdee.bos.qing.common;W=d.DomUtil;za=d.Base64Util;d=com.kingdee.bos.qing.modeler.modelset.source.model;M=d.I18nIconUtil})();Y.Integration=new function(){var d=new T,a,k;this.getRemoteImpl=function(){return d};this.setRemoteUrl=function(n){d.setRemoteUrl(n)};this.setModelSetId=function(n){a=n};this.getModelSetId=function(){return a};this.setIsPreset=function(n){k=n};this.getIsPreset=function(){return k}};Y.Icons=new function(){Ka.call(this);var d=this.protectedMethod;this.protectedInit=function(q,
h){q=com.kingdee.bos.qing.modeler.modelset.source.ComboIcon;if(!q)throw Error("com.kingdee.bos.qing.modeler.modelset.source.ComboIcon not found.");q.define(h,"dm");k(8,0,"checked");k(6,13,"upload_success");k(6,12,"upload_running");k(6,11,"upload_fail");k(6,10,"upload_pause");k(6,9,"upload_again");k(6,8,"refresh");k(6,2,"upload_icon");k(7,3,"download_icon");k(8,14,"up_move");k(8,15,"down_move");q.define(h,"source");a(0,0,"MYSQL");a(1,0,"SQLSERVER");a(2,0,"ORACLE");a(3,0,"POSTGRESQL");a(4,0,"DB2");
a(5,0,"ACCESS");a(6,0,"SQLITE");a(3,1,"HIVE");a(4,1,"HANA");a(5,1,"ODPS");a(6,1,"source_unsupported");a(0,1,"EXCEL");a(1,1,"CSV");a(2,1,"TXT");a(0,2,"SYBASE");a(1,2,"REDSHIFT");a(2,2,"TIDB");a(3,2,"DM");a(4,2,"source_openAPI");a(5,2,"GREENPLUM");a(6,2,"GAUSSDB");a(0,3,"APACHEDRILL");a(1,3,"SPARKSQL");a(2,3,"SYBASEIQ");a(3,3,"IMPALA");a(4,3,"KYLIN");a(5,3,"XML");a(0,4,"biz_source");a(1,4,"public_source");a(2,4,"modelSet_source");a(3,4,"db_source");a(4,4,"file_source");a(6,4,"COSMIC");a(6,3,"DORIS");
a(7,0,"KINGBASE");a(7,1,"TDSQL");a(7,2,"GBASE");a(7,3,"VASTBASE");a(7,4,"YASHANDB");a(8,0,"TXT_EN");a(8,1,"COSMIC_EN");q.define(h,"file");h.setStartPosition(1,37);h.setIconSize(15,18);a(0,0,"file_csv");a(0,1,"file_excel");a(0,2,"file_txt");a(0,3,"file_xml");q.define(h,"source-error");h.setIconSize(90,45);a(0,0,"source-error");h.setStartPosition(210,-10);h.setIconSize(170,98);a(0,0,"no-public-source");q.define(h,"source-round");h.setStartPosition(0,0);h.setGap(0);h.setIconSize(100,100);a(0,0,"ACCESS-ROUND");
a(0,1,"REDSHIFT-ROUND");a(0,2,"APACHEDRILL-ROUND");a(0,3,"HIVE-ROUND");a(0,4,"IMPALA-ROUND");a(0,5,"KYLIN-ROUND");a(0,6,"DB2-ROUND");a(0,7,"DM-ROUND");a(1,0,"GAUSSDB-ROUND");a(1,1,"GREENPLUM-ROUND");a(1,2,"HANA-ROUND");a(1,3,"MYSQL-ROUND");a(1,4,"ODPS-ROUND");a(1,5,"ORACLE-ROUND");a(1,6,"POSTGRESQL-ROUND");a(1,7,"SPARKSQL-ROUND");a(2,0,"SQLSERVER-ROUND");a(2,1,"SQLITE-ROUND");a(2,2,"SYBASEIQ-ROUND");a(2,3,"SYBASE-ROUND");a(2,4,"TIDB-ROUND");a(2,5,"DORIS-ROUND");a(2,6,"KINGBASE-ROUND");a(2,7,"TDSQL-ROUND");
a(3,0,"COSMIC-ROUND");a(3,1,"OPENAPI-ROUND");a(3,2,"EXCEL-ROUND");a(3,3,"CSV-ROUND");a(3,4,"ENTITY-ROUND");a(3,5,"DATACENTER-ROUND");a(3,6,"MODELSET-ROUND");a(3,7,"TXT-ROUND");a(4,2,"VASTBASE-ROUND");a(4,3,"COSMIC-ROUND_EN");a(4,4,"XML-ROUND");a(4,5,"YASHANDB-ROUND");a(4,7,"GBASE-ROUND");h.setStartPosition(0,502);h.setIconSize(16,16);n(0,0,"btn-delete");n(0,1,"btn-edit");h.setStartPosition(0,500);h.setIconSize(17,17);n(0,3,"btn-search");h.setStartPosition(0,590);h.setIconSize(52,52);n(0,0,"CreatorIcon")};
var a=function(q,h,m){d.registIcon(q,h,m)},k=function(q,h,m){a(q,h,m);a(q+1,h,m+"_selected")},n=function(q,h,m){a(q+1,h,m);a(q,h,m+"_hover")}};var y=Y.Icons;Y.SourceCardUIFactory=new function(){var d={};this.getImpl=function(a){var k=d[a.getSourceType()];if(k)return new k(a)};this.registImpl=function(a,k){d[a]=k}};var D=Y.SourceCardUIFactory;D.registImpl(Ca.DBSource,function(d){V.call(this,d);var a=this,k,n,q;this.protectedInitUi=function(m){var w=$("<div class='source-manage-content-card-icon'>");
y.background(w,d.getModelerSource().getDbType()+"-ROUND");w.attr("title",Ia.getDisplayName(d.getModelerSource().getDbType()));m.append(w);w=$("<div class='source-manage-content-card-head'>");w.append(a.getTitleJqUi());w.append(a.getOperationJqUi());m.append(w);w=$("<div class='source-manage-content-card-body'>");w.append(a.getCreateNameJqUi());k=$("<div class='source-manage-content-card-text'>");w.append(k);h(d.getModelerSource().getTypeName())&&(q=$("<div class='source-manage-content-card-text'>"),
w.append(q));n=$("<div class='source-manage-content-card-text'>");w.append(n);m.append(w)};var h=function(m){return m==pa.TYPE_POSTGRESQL||m==pa.TYPE_DB2||m==pa.TYPE_HANA||m==pa.TYPE_REDSHIFT||m==pa.TYPE_GREENPLUM||m==pa.TYPE_KYLIN||m==pa.TYPE_VASTBASE||m==pa.TYPE_GBASE||m==pa.TYPE_KINGBASE?!0:!1};this.protectedUpdateUi=function(){var m=d.getModelerSource().getTypeName()==pa.TYPE_ORACLE?H.get("SIDOrserverNameWithColon","SID/\u5b9e\u4f8b\u540d\uff1a"):H.get("dbWithColon","\u6570\u636e\u5e93\uff1a");
var w=d.getModelerSource().getDbName();a.getSearchStatus()?a.doHighLightText(k,w,m):k.text(m+w);k.attr("title",m+w);h(d.getModelerSource().getTypeName())&&(m=H.get("modeWithColon","\u6a21\u5f0f\uff1a")+d.getModelerSource().getSchema(),a.getSearchStatus()?a.doHighLightText(q,d.getModelerSource().getSchema(),H.get("modeWithColon","\u6a21\u5f0f\uff1a")):q.text(m),q.attr("title",m));d.getModelerSource().getDbAddress()&&(m=H.get("serverWithColon","\u670d\u52a1\u5668\uff1a")+d.getModelerSource().getDbAddress(),
a.getSearchStatus()?a.doHighLightText(n,d.getModelerSource().getDbAddress(),H.get("serverWithColon","\u670d\u52a1\u5668\uff1a")):n.text(m),n.attr("title",m))}});D.registImpl(Ca.FileSource,function(d){V.call(this,d);var a=this;this.protectedInitUi=function(k){var n=$("<div class='source-manage-content-card-icon'>");y.background(n,d.getModelerSource().getFileType()+"-ROUND");n.attr("title",d.getModelerSource().getDisplayName());k.append(n);n=$("<div class='source-manage-content-card-head'>");n.append(a.getTitleJqUi());
n.append(a.getOperationJqUi());k.append(n);n=$("<div class='source-manage-content-card-body'>");n.append(a.getCreateNameJqUi());k.append(n)};this.protectedUpdateUi=function(){}});D.registImpl(Ca.ERPCloudEntity,function(d){V.call(this,d);var a=this,k;this.protectedInitUi=function(n){var q=M.handleIconName("COSMIC-ROUND"),h=$("<div class='source-manage-content-card-icon'>");y.background(h,q);h.attr("title",H.get("businessEntity","\u4e1a\u52a1\u5b9e\u4f53"));n.append(h);q=$("<div class='source-manage-content-card-head'>");
q.append(a.getTitleJqUi());q.append(a.getOperationJqUi());n.append(q);q=$("<div class='source-manage-content-card-body'>");q.append(a.getCreateNameJqUi());k=$("<div class='source-manage-content-card-text'>");q.append(k);n.append(q)};this.protectedUpdateUi=function(){if(d.getRefSourceType()){var n=H.get("sourceType","\u7c7b\u578b\uff1a")+d.getRefSourceType();a.getSearchStatus()?a.doHighLightText(k,n):k.text(n);k.attr("title",n)}}});D.registImpl(Ca.ERPCloudDBCenter,function(d){V.call(this,d);var a=
this,k;this.protectedInitUi=function(n){var q=$("<div class='source-manage-content-card-head'>");if(d.getErrorMessage()){var h=$("<div>");w=$("<div class='source-manage-content-card-notice-icon'>");y.background(w,"DATACENTER-ROUND");w.appendTo(h);w=$("<span class='source-manage-content-card-notice-title'>");w.text(d.getSourceName());w.attr("title",d.getSourceName());w.appendTo(h);w=H.get("creator","\u521b\u5efa\u4eba\uff1a")+d.getCreatorName();var m=$("<span class='source-manage-content-card-notice-body-creator'>");
m.text(w);m.attr("title",w);m.appendTo(h);w=$("<span class='source-manage-content-card-body-ref-source-creator'>");m=H.get("source","\u6765\u6e90")+"\uff1a"+H.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79")+"/"+H.get("DBCenter","\u6570\u636e\u4e2d\u5fc3");w.text(m);w.attr("title",m);w.appendTo(h);w=new ka;w.setIconType(ka.ICON_TYPE_INFO);w.setTipsSize(300,145);w.setTipsHtml(h[0]);h=w.getJqUi();h.css("left",10);h.css("top",12);n.append(h);w=$("<div class='source-manage-content-card-error-icon'>");
y.background(w,"source-error");w.appendTo(n);h=$("<div class='source-manage-content-card-error-message'>");h.text(d.getErrorMessage());h.attr("title",d.getErrorMessage());h.appendTo(n)}else{h=M.handleIconName("COSMIC-ROUND");var w=$("<div class='source-manage-content-card-icon'>");y.background(w,h);w.attr("title",H.get("DBCenter","\u6570\u636e\u4e2d\u5fc3"));n.append(w);q.append(a.getTitleJqUi());h=$("<div class='source-manage-content-card-body'>");h.append(a.getCreateNameJqUi());k=$("<div class='source-manage-content-card-text'>");
h.append(k);n.append(h)}q.append(a.getOperationJqUi());n.append(q)};this.protectedUpdateUi=function(){if(d.getRefSourceType()){var n=H.get("sourceType","\u7c7b\u578b\uff1a")+d.getRefSourceType();a.getSearchStatus()?a.doHighLightText(k,n):k.text(n);k.attr("title",n)}}});D.registImpl(Ca.PublicDBSource,function(d){V.call(this,d);var a=this,k,n;this.protectedInitUi=function(q){var h=$("<div class='source-manage-content-card-head'>");if(d.getErrorMessage()){var m=$("<div>");t=$("<div class='source-manage-content-card-notice-icon'>");
y.background(t,d.getModelerSource().getPublicSourceType()+"-ROUND");t.appendTo(m);t=$("<span class='source-manage-content-card-notice-title'>");t.text(d.getSourceName());t.attr("title",d.getSourceName());t.appendTo(m);t=H.get("creator","\u521b\u5efa\u4eba\uff1a")+d.getCreatorName();var w=$("<span class='source-manage-content-card-notice-body-creator'>");w.text(t);w.attr("title",t);w.appendTo(m);t=H.get("publicSourceCreator","\u8be5\u516c\u5171\u6570\u636e\u6e90\u521b\u5efa\u4eba\uff1a")+d.getModelerSource().getPublicSourceCreator();
w=$("<span class='source-manage-content-card-body-ref-source-creator'>");w.text(t);w.attr("title",t);w.appendTo(m);t=d.getRefSourceName();w=H.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90")+"/";w=H.get("source","\u6765\u6e90")+"\uff1a"+w+t;t=$("<span class='source-manage-content-card-body-source'>");t.text(w);t.attr("title",w);t.appendTo(m);t=new ka;t.setIconType(ka.ICON_TYPE_INFO);t.setTipsSize(300,145);t.setTipsHtml(m[0]);m=t.getJqUi();m.css("left",10);m.css("top",12);q.append(m);t=$("<div class='source-manage-content-card-error-icon'>");
y.background(t,"source-error");t.appendTo(q);m=$("<div class='source-manage-content-card-error-message'>");m.text(d.getErrorMessage());m.attr("title",d.getErrorMessage());m.appendTo(q)}else{var t=$("<div class='source-manage-content-card-icon'>");y.background(t,d.getModelerSource().getPublicSourceType()+"-ROUND");t.attr("title",Ia.getDisplayName(d.getModelerSource().getPublicSourceType()));q.append(t);h.append(a.getTitleJqUi());m=$("<div class='source-manage-content-card-body'>");m.append(a.getCreateNameJqUi());
k=$("<div class='source-manage-content-card-text'>");m.append(k);n=$("<div class='source-manage-content-card-text'>");m.append(n);q.append(m)}h.append(a.getOperationJqUi());q.append(h)};this.protectedUpdateUi=function(){if(d.getRefSourceType()){var q=H.get("sourceType","\u7c7b\u578b\uff1a")+d.getRefSourceType();a.getSearchStatus()?a.doHighLightText(k,q):k.text(q);k.attr("title",q)}if(d.getModelerSource().getRefSourceDBName()){q=d.getModelerSource().getPublicSourceType()==pa.TYPE_ORACLE?H.get("SIDOrserverNameWithColon",
"SID/\u5b9e\u4f8b\u540d\uff1a"):H.get("dbWithColon","\u6570\u636e\u5e93\uff1a");var h=q+d.getModelerSource().getRefSourceDBName();a.getSearchStatus()?a.doHighLightText(n,d.getModelerSource().getRefSourceDBName(),q):n.text(h);n.attr("title",h)}}});D.registImpl(Ca.ModelSet,function(d){V.call(this,d);var a=this,k;this.protectedInitUi=function(n){var q=$("<div class='source-manage-content-card-head'>");if(d.getErrorMessage()){var h=$("<div>");w=$("<div class='source-manage-content-card-notice-icon'>");
y.background(w,"MODELSET-ROUND");w.appendTo(h);w=$("<span class='source-manage-content-card-notice-title'>");w.text(d.getSourceName());w.attr("title",d.getSourceName());w.appendTo(h);w=H.get("creator","\u521b\u5efa\u4eba\uff1a")+d.getCreatorName();var m=$("<span class='source-manage-content-card-notice-body-creator'>");m.text(w);m.attr("title",w);m.appendTo(h);w=H.get("modelSetCreator","\u8be5\u6a21\u578b\u96c6\u521b\u5efa\u4eba\uff1a")+d.getModelerSource().getModelSetCreator();m=$("<span class='source-manage-content-card-body-ref-source-creator'>");
m.text(w);m.attr("title",w);m.appendTo(h);w=d.getRefSourceName();m=H.get("modelSet","\u6a21\u578b\u96c6")+"/";m=H.get("source","\u6765\u6e90")+"\uff1a"+m+w;w=$("<span class='source-manage-content-card-body-source'>");w.text(m);w.attr("title",m);w.appendTo(h);w=new ka;w.setIconType(ka.ICON_TYPE_INFO);w.setTipsSize(300,145);w.setTipsHtml(h[0]);h=w.getJqUi();h.css("left",10);h.css("top",12);n.append(h);w=$("<div class='source-manage-content-card-error-icon'>");y.background(w,"source-error");w.appendTo(n);
h=$("<div class='source-manage-content-card-error-message'>");h.text(d.getErrorMessage());h.attr("title",d.getErrorMessage());h.appendTo(n)}else{var w=$("<div class='source-manage-content-card-icon'>");y.background(w,"MODELSET-ROUND");w.attr("title",H.get("modelSet","\u6a21\u578b\u96c6"));n.append(w);q.append(a.getTitleJqUi());h=$("<div class='source-manage-content-card-body'>");h.append(a.getCreateNameJqUi());k=$("<div class='source-manage-content-card-text'>");h.append(k);n.append(h)}q.append(a.getOperationJqUi());
n.append(q)};this.protectedUpdateUi=function(){if(d.getRefSourceType()){var n=H.get("sourceType","\u7c7b\u578b\uff1a")+d.getRefSourceType();a.getSearchStatus()?a.doHighLightText(k,n):k.text(n);k.attr("title",n)}}});D.registImpl(Ca.OpenAPI,function(d){V.call(this,d);var a=this,k;this.protectedInitUi=function(n){var q=$("<div class='source-manage-content-card-head'>");if(d.getErrorMessage()){var h=$("<div>");w=$("<div class='source-manage-content-card-notice-icon'>");y.background(w,"OPENAPI-ROUND");
w.appendTo(h);w=$("<span class='source-manage-content-card-notice-title'>");w.text(d.getSourceName());w.attr("title",d.getSourceName());w.appendTo(h);w=H.get("creator","\u521b\u5efa\u4eba\uff1a")+d.getCreatorName();var m=$("<span class='source-manage-content-card-notice-body-creator'>");m.text(w);m.attr("title",w);m.appendTo(h);w=new ka;w.setIconType(ka.ICON_TYPE_INFO);w.setTipsSize(300,145);w.setTipsHtml(h[0]);h=w.getJqUi();h.css("left",10);h.css("top",12);n.append(h);w=$("<div class='source-manage-content-card-error-icon'>");
y.background(w,"source-error");w.appendTo(n);h=$("<div class='source-manage-content-card-error-message'>");h.text(d.getErrorMessage());h.attr("title",d.getErrorMessage());h.appendTo(n)}else{var w=$("<div class='source-manage-content-card-icon'>");y.background(w,"OPENAPI-ROUND");w.attr("title",H.get("OpenAPI","OpenAPI"));n.append(w);q.append(a.getTitleJqUi());h=$("<div class='source-manage-content-card-body'>");h.append(a.getCreateNameJqUi());k=$("<div class='source-manage-content-card-text'>");h.append(k);
n.append(h)}q.append(a.getOperationJqUi());n.append(q)};this.protectedUpdateUi=function(){if(d.getRefSourceType()){var n=H.get("sourceType","\u7c7b\u578b\uff1a")+d.getRefSourceType();a.getSearchStatus()?a.doHighLightText(k,n):k.text(n);k.attr("title",n)}}});Y.ProductLineEnvironment=new function(){var d;this.getEnvironment=function(){return d};this.setEnvironment=function(a){d=a};this.checkEnvironment=function(a){return a&&d&&d==a?!0:!1}};Y.ProductLineEnvironment.COSMIC="COSMIC";Y.OpenAPIAuthFactory=
new function(){var d={};this.getImpl=function(a,k){if(a=d[a])return new a(k)};this.registImpl=function(a,k){d[a]=k}};D=Y.OpenAPIAuthFactory;D.registImpl(ha.BASIC,function(d){X.call(this,d);var a,k,n=/^[a-zA-Z0-9_]{1,}$/;this.protectedInitUi=function(q){var h=(new na(H.get("userName","\u7528\u6237\u540d"))).getJqUi();W.layoutCtrl(h,34,33,80,23);h.appendTo(q);a=new ra;a.setTabindex(1);h=a.getJqUi();W.layoutCtrl(h,100,33,170,23);h.appendTo(q);h=(new na(H.get("mima","\u5bc6\u7801"))).getJqUi();W.layoutCtrl(h,
34,66,80,23);h.appendTo(q);k=new Aa;k.setTabindex(2);h=k.getJqUi();W.layoutCtrl(h,100,66,170,23);h.appendTo(q)};this.protectedUpdateModelToUI=function(){a.setText(d.getUserName());k.setPassword(za.decode(d.getPassword()))};this.protectedGetModelFromUI=function(){var q=new ea;q.setUserName($.trim(a.getText()));q.setPassword(za.encode($.trim(k.getPassword())));return q};this.protectedCheckParams=function(){return $.trim(a.getText())?$.trim(k.getPassword())?$.trim(a.getText()).match(n)?50<$.trim(a.getText()).length?
H.get("userNameTooLong","\u7528\u6237\u540d\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):100<$.trim(k.getPassword()).length?H.get("mimaTooLong","\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"):null:H.get("userNameNotSpecial","\u7528\u6237\u540d\u53ea\u80fd\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\u3002"):H.get("mimaNotNull","\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\u3002"):H.get("userNameNotNull","\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\u3002")}});
D.registImpl(ha.BEARER,function(d){X.call(this,d);var a,k,n,q;this.protectedInitUi=function(h){var m=new na(H.get("clientId","\u5ba2\u6237\u7aef\u7f16\u7801"));m.setRequired(!0);m=m.getJqUi();m.attr("title",H.get("clientId","\u5ba2\u6237\u7aef\u7f16\u7801"));W.layoutCtrl(m,34,33,68,23);m.appendTo(h);m=new ka;m.setIconType(ka.ICON_TYPE_QUESTION);m.setTipsText("client_id");m=m.getJqUi();m.addClass("dm-notice-icon");W.layoutCtrl(m,102,37,16,16);m.appendTo(h);a=new ra;a.setTabindex(1);m=a.getJqUi();W.layoutCtrl(m,
124,33,170,23);m.appendTo(h);m=new na(H.get("clientSecret","\u5ba2\u6237\u7aef\u5bc6\u94a5"));m.setRequired(!0);m=m.getJqUi();W.layoutCtrl(m,34,66,80,23);m.appendTo(h);m=new ka;m.setIconType(ka.ICON_TYPE_QUESTION);m.setTipsText("client_secret");m=m.getJqUi();m.addClass("dm-notice-icon");W.layoutCtrl(m,102,70,16,16);m.appendTo(h);k=new Aa;k.setTabindex(2);m=k.getJqUi();W.layoutCtrl(m,124,66,170,23);m.appendTo(h);m=(new na(H.get("scope","\u6743\u9650\u8303\u56f4"))).getJqUi();m.attr("title",H.get("scope",
"\u6743\u9650\u8303\u56f4"));W.layoutCtrl(m,34,99,54,23);m.appendTo(h);m=new ka;m.setIconType(ka.ICON_TYPE_QUESTION);m.setTipsText("scope");m=m.getJqUi();m.addClass("dm-notice-icon");W.layoutCtrl(m,88,103,16,16);m.appendTo(h);n=new ra;a.setTabindex(3);m=n.getJqUi();W.layoutCtrl(m,124,99,170,23);m.appendTo(h);m=new na(H.get("authURL","\u8ba4\u8bc1URL"));m.setRequired(!0);m=m.getJqUi();m.attr("title",H.get("authURL","\u8ba4\u8bc1URL"));W.layoutCtrl(m,34,132,57,23);m.appendTo(h);m=new ka;m.setIconType(ka.ICON_TYPE_QUESTION);
m.setTipsText(H.get("tokenURL","\u83b7\u53d6access_token\u7684API\u5730\u5740"));m=m.getJqUi();m.addClass("dm-notice-icon");W.layoutCtrl(m,91,136,16,16);m.appendTo(h);q=new ra;q.setTabindex(4);m=q.getJqUi();W.layoutCtrl(m,124,132,456,23);m.appendTo(h)};this.protectedUpdateModelToUI=function(h){a.setText(d.getClientId());k.setPassword(za.decode(d.getClientSecret()));n.setText(d.getScope());q.setText(d.getAuthURL())};this.protectedGetModelFromUI=function(){var h=new qa;h.setClientId($.trim(a.getText()));
h.setClientSecret(za.encode($.trim(k.getPassword())));$.trim(n.getText())&&h.setScope($.trim(n.getText()));h.setAuthURL($.trim(q.getText()));return h};this.protectedCheckParams=function(){return $.trim(a.getText())?$.trim(k.getPassword())?$.trim(q.getText())?50<$.trim(a.getText()).length?H.get("clientIdTooLong","\u5ba2\u6237\u7aef\u7f16\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):100<$.trim(k.getPassword()).length?H.get("clientSecretTooLong","\u5ba2\u6237\u7aef\u5bc6\u94a5\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"):
50<$.trim(n.getText()).length?H.get("scopeTooLong","\u6743\u9650\u8303\u56f4\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):100<$.trim(q.getText()).length?H.get("authURLTooLong","\u8ba4\u8bc1URL\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"):null:H.get("authURLNotNull","\u8ba4\u8bc1URL\u4e0d\u80fd\u4e3a\u7a7a\u3002"):H.get("clientSecretNotNull","\u5ba2\u6237\u7aef\u5bc6\u94a5\u4e0d\u80fd\u4e3a\u7a7a\u3002"):H.get("clientIdNotNull","\u5ba2\u6237\u7aef\u7f16\u7801\u4e0d\u80fd\u4e3a\u7a7a\u3002")}});
D.registImpl(ha.DIGEST,function(d){X.call(this,d);var a,k,n=/^[a-zA-Z0-9_]{1,}$/;this.protectedInitUi=function(q){var h=(new na(H.get("userName","\u7528\u6237\u540d"))).getJqUi();W.layoutCtrl(h,34,33,80,23);h.appendTo(q);a=new ra;a.setTabindex(1);h=a.getJqUi();W.layoutCtrl(h,100,33,170,23);h.appendTo(q);h=(new na(H.get("mima","\u5bc6\u7801"))).getJqUi();W.layoutCtrl(h,34,66,80,23);h.appendTo(q);k=new Aa;k.setTabindex(2);h=k.getJqUi();W.layoutCtrl(h,100,66,170,23);h.appendTo(q)};this.protectedUpdateModelToUI=
function(){a.setText(d.getUserName());k.setPassword(za.decode(d.getPassword()))};this.protectedGetModelFromUI=function(){var q=new La;q.setUserName($.trim(a.getText()));q.setPassword(za.encode($.trim(k.getPassword())));return q};this.protectedCheckParams=function(){return $.trim(a.getText())?$.trim(k.getPassword())?50<$.trim(a.getText()).length?H.get("userNameTooLong","\u7528\u6237\u540d\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):$.trim(a.getText()).match(n)?100<$.trim(k.getPassword()).length?
H.get("mimaTooLong","\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"):null:H.get("userNameNotSpecial","\u7528\u6237\u540d\u53ea\u80fd\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\u3002"):H.get("mimaNotNull","\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\u3002"):H.get("userNameNotNull","\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\u3002")}});D.registImpl(ha.COSMIC,function(d){function a(R,G){this.getTypeName=function(){return R};this.getTypeCode=function(){return G}}
X.call(this,d);var k=this.protectedMethod,n=this,q=d,h=q&&q.getTokenEnhanced(),m=Y.ProductLineEnvironment.checkEnvironment(Y.ProductLineEnvironment.COSMIC),w,t,K,ta,sa,E,O,ia,P,Da,g=["Local","Other"],ya=["Mobile","Email","UserName"],Ja=[new a(H.get("local","\u5f53\u524d\u7cfb\u7edf"),g[0]),new a(H.get("other","\u5176\u4ed6\u7cfb\u7edf"),g[1])],fa=[new a(H.get("mobile","\u624b\u673a\u53f7"),ya[0]),new a(H.get("email","\u90ae\u7bb1"),ya[1]),new a(H.get("userName","\u7528\u6237\u540d"),ya[2])];this.protectedInitUi=
function(R){ia=new da;var G=ia.getJqUi();W.layoutCtrl(G,34,38,23,23);G.appendTo(R);G=(new na(H.get("tokenEnhanced","\u589e\u5f3a\u578bToken\u8ba4\u8bc1"))).getJqUi();G.attr("title",H.get("tokenEnhanced","\u589e\u5f3a\u578bToken\u8ba4\u8bc1"));W.layoutCtrl(G,54,40,220,16);G.appendTo(R);ia.addCheckedListener(function(){h!=ia.isChecked()&&(h=ia.isChecked(),q=n.protectedGetModelFromUI(),R.empty(),k.addAuthSettingsJq(R),n.protectedInitUi(R),n.protectedUpdateModelToUI(d))});G=new na(H.get("appId","\u7cfb\u7edf\u7f16\u7801"));
G.setRequired(!0);G=G.getJqUi();G.attr("title",H.get("appId","\u7cfb\u7edf\u7f16\u7801"));W.layoutCtrl(G,34,71,57,23);G.appendTo(R);G=new ka;G.setIconType(ka.ICON_TYPE_QUESTION);G.setTipsText("appId");G=G.getJqUi();G.addClass("dm-notice-icon");W.layoutCtrl(G,91,75,16,16);G.appendTo(R);w=new ra;w.setTabindex(1);G=w.getJqUi();W.layoutCtrl(G,124,71,170,23);G.appendTo(R);G=new na(H.get("appSecret","\u8ba4\u8bc1\u5bc6\u94a5"));G.setRequired(!0);G=G.getJqUi();G.attr("title",H.get("appSecret","\u8ba4\u8bc1\u5bc6\u94a5"));
W.layoutCtrl(G,320,71,57,23);G.appendTo(R);G=new ka;G.setIconType(ka.ICON_TYPE_QUESTION);G.setTipsText("appSecret");G=G.getJqUi();G.addClass("dm-notice-icon");W.layoutCtrl(G,377,75,16,16);G.appendTo(R);t=new Aa;t.setTabindex(2);G=t.getJqUi();W.layoutCtrl(G,410,71,170,23);G.appendTo(R);G=ua();G.appendTo(R);var aa=Qa();aa.appendTo(R);h?aa.hide():G.hide();m?va().appendTo(R):Ba().appendTo(R)};var ua=function(){var R=$("<div>"),G=new na(H.get("proxyUser","\u4ee3\u7406\u7528\u6237\u540d"));G.setRequired(!0);
G=G.getJqUi();W.layoutCtrl(G,34,104,90,23);G.appendTo(R);sa=new ra;G=sa.getJqUi();W.layoutCtrl(G,124,104,170,23);G.appendTo(R);return R},Qa=function(){var R=$("<div>"),G=(new na(H.get("usertype","\u7528\u6237\u7c7b\u578b"))).getJqUi();G.attr("title",H.get("usertype","\u7528\u6237\u7c7b\u578b"));W.layoutCtrl(G,34,104,80,23);G.appendTo(R);G=new Pa;G.setItemModels(fa);if(q&&q.getUserType()){var aa=ya.indexOf(q.getUserType());G.setSelected(fa[aa]);Da=q.getUserType()}else Da=ya[0],G.setSelected(fa[0]);
G.setCustomPainter(function(Ra,Ma,Ea){Ma.text(Ea.getTypeName())});G.addSelectedChangedListener(function(Ra,Ma,Ea){Da=Ea.getTypeCode();K.setText(Ea.getTypeName());ta.setText()});G=G.getJqUi();W.layoutCtrl(G,124,104,170,23);G.appendTo(R);K=new na(H.get("mobile","\u624b\u673a\u53f7"));K.setRequired(!0);G=K.getJqUi();W.layoutCtrl(G,320,104,90,23);G.appendTo(R);ta=new ra;G=ta.getJqUi();W.layoutCtrl(G,410,104,170,23);G.appendTo(R);return R},va=function(){var R=$("<div>"),G=(new na(H.get("cosmicType","\u8ba4\u8bc1\u670d\u52a1\u5668"))).getJqUi();
W.layoutCtrl(G,34,137,80,23);G.appendTo(R);G=new Pa;G.setItemModels(Ja);if(!q||q.getCosmicType()&&q.getCosmicType()!=g[1])P=g[0],G.setSelected(Ja[0]);else{P=g[1];G.setSelected(Ja[1]);var aa=Ba();aa.appendTo(R)}G.setCustomPainter(function(Ra,Ma,Ea){Ma.text(Ea.getTypeName())});G.addSelectedChangedListener(function(Ra,Ma,Ea){P=Ea.getTypeCode();P===g[0]?aa.empty():(aa=Ba(),aa.appendTo(R))});G=G.getJqUi();W.layoutCtrl(G,124,137,170,23);G.appendTo(R);return R},Ba=function(){var R=$("<div>");var G=m?33:
0;var aa=(new na(H.get("accountid","\u6570\u636e\u4e2d\u5fc3id"))).getJqUi();aa.attr("title",H.get("accountid","\u6570\u636e\u4e2d\u5fc3id"));W.layoutCtrl(aa,34,G+137,68,23);aa.appendTo(R);aa=new ka;aa.setIconType(ka.ICON_TYPE_QUESTION);aa.setTipsText("accountid");aa=aa.getJqUi();aa.addClass("dm-notice-icon");W.layoutCtrl(aa,102,G+141,16,16);aa.appendTo(R);E=new ra;E.setTabindex(1);aa=E.getJqUi();W.layoutCtrl(aa,124,G+137,170,23);aa.appendTo(R);aa=new na(H.get("serverAddress","\u670d\u52a1\u5668\u5730\u5740"));
aa.setRequired(!0);aa=aa.getJqUi();aa.attr("title",H.get("serverAddress","\u670d\u52a1\u5668\u5730\u5740"));W.layoutCtrl(aa,34,G+170,68,23);aa.appendTo(R);aa=new ka;aa.setIconType(ka.ICON_TYPE_QUESTION);var Ra=H.get("forExample","\u4f8b\u5982\uff1a")+"http://127.0.0.1:8080/ierp/";aa.setTipsText(Ra);aa=aa.getJqUi();aa.addClass("dm-notice-icon");W.layoutCtrl(aa,102,G+174,16,16);aa.appendTo(R);O=new ra;aa=O.getJqUi();W.layoutCtrl(aa,124,G+170,456,23);aa.appendTo(R);return R};this.protectedUpdateModelToUI=
function(){ia.setChecked(q.getTokenEnhanced());w.setText(q.getAppId());t.setPassword(za.decode(q.getAppSecret()));O&&(O.setText(q.getCosmicServerAddress()),E.setText(q.getAccountId()));if(q.getUserType()){for(var R=0;R<fa.length;R++)if(fa[R].getTypeCode()==q.getUserType()){K.setText(fa[R].getTypeName());break}ta.setText(q.getUserTypeValue())}sa.setText(q.getProxyUser())};this.protectedGetModelFromUI=function(){var R=new Z;R.setTokenEnhanced(ia.isChecked());R.setAppId($.trim(w.getText()));R.setAppSecret(za.encode($.trim(t.getPassword())));
R.setUserType(Da);R.setUserTypeValue($.trim(ta.getText()));R.setProxyUser($.trim(sa.getText()));R.setCosmicType(P);m&&P!=g[1]||(R.setCosmicServerAddress($.trim(O.getText())),R.setAccountId($.trim(E.getText())));return R};this.protectedCheckParams=function(){if(!$.trim(w.getText()))return H.get("appIdNotNull","\u7cfb\u7edf\u7f16\u7801\u4e0d\u80fd\u4e3a\u7a7a\u3002");if(!$.trim(t.getPassword()))return H.get("appSecretNotNull","\u8ba4\u8bc1\u5bc6\u94a5\u4e0d\u80fd\u4e3a\u7a7a\u3002");if(h&&!$.trim(sa.getText())||
!h&&!$.trim(ta.getText()))return H.get("userInfoNotNull","\u7528\u6237\u4fe1\u606f\u4e0d\u80fd\u4e3a\u7a7a\u3002");if(!(m&&P!=g[1]||$.trim(O.getText())))return H.get("serverAddressNotNull","\u670d\u52a1\u5668\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a\u3002");if(50<$.trim(w.getText()).length)return H.get("appIdTooLong","\u7cfb\u7edf\u7f16\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(100<$.trim(t.getPassword()).length)return H.get("appSecretTooLong","\u8ba4\u8bc1\u5bc6\u94a5\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002");
if(h&&50<$.trim(sa.getText()).length||!h&&50<$.trim(ta.getText()).length)return H.get("userInfoTooLong","\u7528\u6237\u4fe1\u606f\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(!m||P==g[1]){if(50<$.trim(E.getText()).length)return H.get("accountIdTooLong","\u6570\u636e\u4e2d\u5fc3id\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(100<$.trim(O.getText()).length)return H.get("serverAddressTooLong","\u670d\u52a1\u5668\u5730\u5740\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002")}return null}});
D=new function(){var d;this.hookCollector=function(a){d=a};this.occur=function(a,k,n){try{d&&d(a,k,n)}catch(q){window.console&&console.warn(q)}};this.getDetailType=function(a){var k=com.kingdee.bos.qing.modeler.modelset.source.model.ModelerSourceType,n=a.getModelerSource();switch(a.getSourceType()){case k.DBSource:return n.getDbType();case k.PublicDBSource:return n.getPublicSourceType();case k.FileSource:return n.getFileType()}return""}};D.SOURCE_TYPE="source-type";Y.UserOperationReporter=D})();(function(){function T(p){var L=this,A,C,x,u,v,J,N=!1,z,c={};this.setMessageCurtain=function(B){x=B};this.getJqUi=function(){A||b();return A};var b=function(){A=$("<div class='source-manage-content'>");if("true"!=ea.getIsPreset()){var B=$("<div class='source-manage-content-card'>"),F=$("<div class='source-manage-content-card-creator-icon'>");Z.background(F,"CreatorIcon");var Q=$('<div class="source-manage-content-card-creator">');Q.text(g.get("createSourceConnection","\u65b0\u5efa\u6570\u636e\u6e90\u8fde\u63a5"));
Q.attr(g.get("createSourceConnection","\u65b0\u5efa\u6570\u636e\u6e90\u8fde\u63a5"));B.append(F);B.append(Q);B.on("mouseover",function(){Z.background(F,"CreatorIcon_hover")});B.on("mouseleave",function(){Z.background(F,"CreatorIcon")});B.on("click",I);A.append(B)}};this.setSourceVOs=function(B){J=B;f()};this.setSelectSourceType=function(B){u=B;f()};this.setSearchText=function(B){z=B;N=0==B.length?!1:!0;f()};this.addModel=function(B){J||(J=[]);J.unshift(B);v=B;f()};this.removeModel=function(B){J&&
(B=J.indexOf(B),-1<B&&J.splice(B,1),f())};var f=function(){var B=function(oa){oa=oa.getSearchContent();for(var Ha=0;Ha<oa.length;Ha++)if(-1<oa[Ha].toUpperCase().indexOf(z))return!0;return!1},F=function(oa){oa=oa.getSourceType();return J[S].getSourceType()==u||u==E.ERPCloud&&(oa==K.ERPCloudEntity||oa==K.ERPCloudDBCenter)||u==E.PublicSource&&oa==K.PublicDBSource||u==E.ModelSet&&oa==K.ModelSet?!0:!1};C&&C.remove();C=$("<div>");if(J){for(var Q=[],S=0;S<J.length;S++)if(!z||B(J[S]))if(!u||F(J[S])){Q.push(J[S]);
var ba=a.getImpl(J[S]);ba.setMessageCurtain(x);ba.setSelectedListener(e);ba.setSearchTarget(N,z);ba.setEditListener(l);ba.setDeleteListener(r);c[J[S].getId()]=ba;ba=ba.getJqUi();C.append(ba)}A.append(C)}},e=function(B){if(v){var F=c[v.getId()];F&&F.setSelected(!1)}v=B},l=function(B){B=v.getSourceType();B=B==K.DBSource?new ca(v,p,x):B==K.FileSource?new Ia(v,p,x):B==K.OpenAPI?new Pa(v,p,x):new Aa(v,p,x);B.setEditSuccessCallback(function(F){x.showSuccess(g.get("editSuccess","\u7f16\u8f91\u6210\u529f\u3002"));
v.fromJsonObject(F);f()});B.createDialog()},r=function(){if(v){var B=new ha(p,function(F){var Q=F.length;if(0<Q){var S=new La;S.fromJsonObject(F[0]);var ba;F=S.getFromType();S=S.getModelName();1==Q?F==La.FROM_TYPE_MODEL?ba=g.get("sourceRefBySingleModel",'"#1"\u6570\u636e\u6e90\u8fde\u63a5\u5df2\u88ab"#2"\u6a21\u578b\u5f15\u7528\uff0c\u8bf7\u5148\u5220\u9664\u6a21\u578b\u4e2d\u7684\u6570\u636e\u6e90\u5f15\u7528\u4fe1\u606f\uff0c\u518d\u5220\u9664\u8be5\u6570\u636e\u6e90\u8fde\u63a5\u3002').replace("#1",
v.getSourceName()).replace("#2",S):F==La.FROM_TYPE_DEPLOY&&(ba=g.get("sourceRefBySingleDeploy",'"#1"\u6570\u636e\u6e90\u8fde\u63a5\u88ab\u5df2\u90e8\u7f72\u7684\u6a21\u578b"#2"\u5f15\u7528\uff0c\u8bf7\u5148\u5c06\u6a21\u578b\u53d6\u6d88\u90e8\u7f72\uff0c\u518d\u5220\u9664\u8be5\u6570\u636e\u6e90\u8fde\u63a5\u3002').replace("#1",v.getSourceName()).replace("#2",S)):F==La.FROM_TYPE_MODEL?ba=g.get("sourceRefByMultipleModel",'"#1"\u6570\u636e\u6e90\u8fde\u63a5\u5df2\u88ab"#2"\u7b49#3\u4e2a\u6a21\u578b\u5f15\u7528\uff0c\u8bf7\u5148\u5220\u9664\u6a21\u578b\u4e2d\u7684\u6570\u636e\u6e90\u5f15\u7528\u4fe1\u606f\uff0c\u518d\u5220\u9664\u8be5\u6570\u636e\u6e90\u8fde\u63a5\u3002').replace("#1",
v.getSourceName()).replace("#2",S).replace("#3",Q):F==La.FROM_TYPE_DEPLOY&&(ba=g.get("sourceRefByMultipleDeploy",'"#1"\u6570\u636e\u6e90\u8fde\u63a5\u5df2\u88ab"#2"\u7b49#3\u4e2a\u5df2\u90e8\u7f72\u7684\u6a21\u578b\u5f15\u7528\uff0c\u8bf7\u5148\u5c06\u6a21\u578b\u53d6\u6d88\u90e8\u7f72\uff0c\u518d\u5220\u9664\u8be5\u6570\u636e\u6e90\u8fde\u63a5\u3002').replace("#1",v.getSourceName()).replace("#2",S).replace("#3",Q));x.showPrompt(ba)}else Q=Ma.createFeedbackDialog(),Q.setOptionType(Ma.OPTION_OK_CANCEL),
Q.setMsgImageType(Ma.MSG_DELETE),Q.setMessage(g.get("confirmDeleteSource","\u786e\u5b9a\u5220\u9664\u8be5\u6570\u636e\u6e90\u8fde\u63a5\u5417\uff1f")),Q.setClosingChecker(function(oa){oa==Ma.RETURN_OK&&(new ha(p,function(){L.removeModel(v);x.showSuccess(g.get("deleteSourceSuccess","\u5220\u9664\u6570\u636e\u6e90\u8fde\u63a5\u6210\u529f\u3002"))},function(Ha,tb){return 20002007===Ha?(x.showPrompt(g.get("noCurrentModelSetPerm","\u5f53\u524d\u6a21\u578b\u96c6\u7684\u521b\u5efa\u8005\u6216\u7ba1\u7406\u5458\u5df2\u5c06\u60a8\u4ece\u534f\u4f5c\u6210\u5458\u4e2d\u79fb\u9664\uff0c\u65e0\u6cd5\u8fdb\u884c\u6b64\u64cd\u4f5c\u3002")),
!0):20002008===Ha?(x.showError(g.get("sourceIsRefenrenced","\u5220\u9664\u5931\u8d25\u3002\u8be5\u6570\u636e\u6e90\u8fde\u63a5\u5df2\u88ab\u5f15\u7528\u3002")),!0):20003301===Ha?(x.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1})).deleteModelSetSource(v.getId(),ea.getModelSetId());return!0}),Q.showDialog()});B.setShowBlocking(!0);B.loadRefModelInfos(v.getId())}},I=function(){var B=new V(p);B.setMessageCurtain(x);B.setCreateSuccessCallback(function(Q){var S=
new qa;S.fromJsonObject(Q);L.addModel(S);x.showSuccess(g.get("saveSuccess","\u65b0\u5efa\u6570\u636e\u6e90\u8fde\u63a5\u6210\u529f\u3002"));gb.occur(gb.SOURCE_TYPE,S.getSourceType(),gb.getDetailType(S))});var F=new R;F.setTitle(g.get("createSourceConnection","\u65b0\u5efa\u6570\u636e\u6e90\u8fde\u63a5"));F.setSteps([B]);F.show(960,540)}}function V(p){ia.call(this);var L=this,A=this.protectedMethod,C,x,u=[],v;E.NEW_SOURCES=[new E(E.DBSource,g.get("database","\u6570\u636e\u5e93"),"db_source",!1),new E(E.FileSource,
g.get("file","\u6587\u4ef6"),"file_source",!1),new E(E.OpenAPI,g.get("OpenAPI","OpenAPI"),"source_openAPI",!1)];E.EXISTING_SOURCE=[new E(E.ERPCloud,g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79"),"biz_source",!1),new E(E.PublicSource,g.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90"),"public_source",!1),new E(E.ModelSet,g.get("modelSet","\u6a21\u578b\u96c6"),"modelSet_source",!1)];E.K3CLOUD_NEW_SOURCES=[new E(E.FileSource,g.get("file","\u6587\u4ef6"),"file_source",!1),new E(E.DBSource,
g.get("database","\u6570\u636e\u5e93"),"db_source",!0),new E(E.OpenAPI,g.get("OpenAPI","OpenAPI"),"source_openAPI",!0)];E.K3CLOUD_EXISTING_SOURCE=[new E(E.ERPCloud,g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79"),"biz_source",!1),new E(E.ModelSet,g.get("modelSet","\u6a21\u578b\u96c6"),"modelSet_source",!1),new E(E.PublicSource,g.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90"),"public_source",!0)];this.setMessageCurtain=function(e){C=e};this.setCreateSuccessCallback=function(e){x=
e};this.getSubTitle=function(){return g.get("selectDataSourceType","\u9009\u62e9\u6570\u636e\u6e90\u7c7b\u578b")};this.protectedCreateUi=function(){var e=$("<div>");e.addClass("source-manage-source-type-main");if(hb){var l=E.K3CLOUD_NEW_SOURCES;var r=E.K3CLOUD_EXISTING_SOURCE}else l=E.NEW_SOURCES,r=E.EXISTING_SOURCE;var I=J(l,g.get("createNewDatabase","\u521b\u5efa\u4e00\u4e2a\u65b0\u6570\u636e\u6e90"),e,"120px","0px"),B=J(r,g.get("reSourceAuthToMe","\u5f15\u5165\u6388\u6743\u7ed9\u6211\u7684\u6570\u636e\u6e90"),
e,"120px","0px");u.push(I);u.push(B);N(I.getJqUi(),l,2);N(B.getJqUi(),r,1);l=$("<div>");l.append(e);return l};var J=function(e,l,r,I,B){var F=$("<div>");F.addClass("dm-source-type-typelist");F.css("height",I);F.css("top",B);F.appendTo(r);null!=l&&(r=$("<div>"),r.addClass("dm-source-type-typelist-title"),r.text(l),r.appendTo(F),hb&&(l=$("<div>"),l.text(g.get("sourceDisabled","\uff08\u5f53\u524d\u8f7b\u5efa\u6a21\u8bb8\u53ef\u6a21\u5f0f\u4e0b\uff0c\u4ee5\u4e0b\u90e8\u5206\u6570\u636e\u6e90\u7c7b\u578b\u4e0d\u53ef\u7528\uff09")),
l.css({width:"350px",height:"26px","line-height":"20px","font-weight":" bold",color:"orange",display:"inline-block"}),l.appendTo(r)));l=new G;l.setItemModels(e);l.setBorderVisible(!1);l.setCustomItemPainter(z);l.setCustomSelectedsPainter(c);e=l.getJqUi();e.addClass("dm-source-type-typelist-list");e.appendTo(F);l.addPressedListener(b);return l},N=function(e,l,r){if(hb){var I=$("<div>");I.css({height:"83px",position:"relative",width:130*r+"px",left:126*(l.length-r)+"px",opacity:"0.5","background-color":"#E5E5E5"});
I.appendTo(e)}},z=function(e,l){e.attr("title",l.getText());e.addClass("dm-source-type-typelist-item");var r=$("<div>");r.addClass("dm-source-type-typelist-item-icon");Z.background(r,l.getIconName());r.appendTo(e);r=$("<div>");r.addClass("dm-source-type-typelist-item-text");r.text(l.getText());r.appendTo(e)},c=function(e,l){for(var r=0;r<e.length;r++){var I=e[r];I.removeClass("dm-source-type-typelist-item_selected");I.find(".dm-source-type-typelist-item_selected-mark").remove();I.find(".dm-source-type-typelist-item_selected-icon").remove()}for(r=
0;r<l.length;r++)I=l[r],I.addClass("dm-source-type-typelist-item_selected"),e=$("<div>"),e.addClass("dm-source-type-typelist-item_selected-mark"),e.appendTo(I),e=$("<div>"),Z.background(e,"checked"),e.addClass("dm-source-type-typelist-item_selected-icon"),e.appendTo(I)},b=function(e){for(var l=0;l<u.length;l++)u[l]!=e&&u[l].setSelecteds([]);e=e.getSelecteds();v=0<e.length?e[0]:null};this.intoThisStep=function(e,l){};this.outThisStep=function(e,l){if(!v||v.isDisabled())A.getMessageCurtain().showPrompt(g.get("selectAnDataSource",
"\u8bf7\u9009\u4e2d\u4e00\u9879\u6570\u636e\u6e90\u3002")),l(L);else{var r;f(E.NEW_SOURCES)?v.getName()==E.DBSource?r=new X(p,C):v.getName()==E.FileSource?r=new Ka(p,C):v.getName()==E.OpenAPI&&(r=new na(p,C)):f(E.EXISTING_SOURCE)&&(v.getName()==E.ERPCloud?r=new pa(p,C):v.getName()==E.PublicSource?r=new ra(p,C):v.getName()==E.ModelSet&&(r=new W(p,C)));r.setCreateSuccessCallback(x);l([r])}};var f=function(e){for(var l=0;l<e.length;l++)if(v.getName()==e[l].getName())return!0;return!1}}function X(p,L){ia.call(this);
var A=this,C=this.protectedMethod,x,u,v=[];E.DB_SOURCES=[new E(O.TYPE_SQLSERVER,"SQL Server","SQLSERVER"),new E(O.TYPE_ORACLE,"ORACLE","ORACLE"),new E(O.TYPE_MYSQL,"MySQL","MYSQL"),new E(O.TYPE_POSTGRESQL,"Postgre SQL","POSTGRESQL"),new E(O.TYPE_DB2,"DB2","DB2"),new E(O.TYPE_ACCESS,"Access","ACCESS"),new E(O.TYPE_SQLITE,"SQLite","SQLITE"),new E(O.TYPE_HIVE,"Apache Hive","HIVE"),new E(O.TYPE_HANA,"HANA","HANA"),new E(O.TYPE_ODPS,"ODPS","ODPS"),new E(O.TYPE_REDSHIFT,"Amazon Redshift","REDSHIFT"),new E(O.TYPE_SYBASE,
"SYBASE","SYBASE"),new E(O.TYPE_TIDB,"TiDB","TIDB"),new E(O.TYPE_DM,"DM","DM"),new E(O.TYPE_GREENPLUM,"Greenplum","GREENPLUM"),new E(O.TYPE_GAUSSDB,"GaussDB","GAUSSDB"),new E(O.TYPE_APACHEDRILL,"Apache Drill","APACHEDRILL"),new E(O.TYPE_SPARKSQL,"Spark SQL","SPARKSQL"),new E(O.TYPE_SYBASEIQ,"Sybase IQ","SYBASEIQ"),new E(O.TYPE_IMPALA,"Apache Impala","IMPALA"),new E(O.TYPE_KYLIN,"Apache Kylin","KYLIN"),new E(O.TYPE_DORIS,"Apache Doris","DORIS"),new E(O.TYPE_KINGBASE,"KingBase","KINGBASE"),new E(O.TYPE_TDSQL,
"TDSQL","TDSQL"),new E(O.TYPE_GBASE,"GBase","GBASE"),new E(O.TYPE_VASTBASE,"Vastbase","VASTBASE"),new E(O.TYPE_YASHANDB,"YashanDB","YASHANDB")];this.setCreateSuccessCallback=function(c){x=c};this.getSubTitle=function(){return g.get("database","\u6570\u636e\u5e93")};this.protectedCreateUi=function(){var c=$("<div>");c.addClass("source-manage-source-type-main");var b=v.push,f=E.DB_SOURCES,e=g.get("database","\u6570\u636e\u5e93");var l=88*Math.ceil(E.DB_SOURCES.length/7)+26+"px";var r=$("<div>");r.addClass("dm-source-type-typelist");
r.css("height",l);r.css("top",void 0);r.appendTo(c);null!=e&&(l=$("<div>"),l.addClass("dm-source-type-typelist-title"),l.text(e),l.appendTo(r));e=new G;e.setItemModels(f);e.setBorderVisible(!1);e.setCustomItemPainter(J);e.setCustomSelectedsPainter(N);f=e.getJqUi();f.addClass("dm-source-type-typelist-list");f.appendTo(r);e.addPressedListener(z);b.call(v,e);b=$("<div>");b.append(c);return b};var J=function(c,b){c.attr("title",b.getText());c.addClass("dm-source-type-typelist-item");var f=$("<div>");
f.addClass("dm-source-type-typelist-item-icon");Z.background(f,b.getIconName());f.appendTo(c);f=$("<div>");f.addClass("dm-source-type-typelist-item-text");f.text(b.getText());f.appendTo(c)},N=function(c,b){for(var f=0;f<c.length;f++){var e=c[f];e.removeClass("dm-source-type-typelist-item_selected");e.find(".dm-source-type-typelist-item_selected-mark").remove();e.find(".dm-source-type-typelist-item_selected-icon").remove()}for(f=0;f<b.length;f++)e=b[f],e.addClass("dm-source-type-typelist-item_selected"),
c=$("<div>"),c.addClass("dm-source-type-typelist-item_selected-mark"),c.appendTo(e),c=$("<div>"),Z.background(c,"checked"),c.addClass("dm-source-type-typelist-item_selected-icon"),c.appendTo(e)},z=function(c){for(var b=0;b<v.length;b++)v[b]!=c&&v[b].setSelecteds([]);c=c.getSelecteds();u=0<c.length?c[0]:null};this.intoThisStep=function(c,b){};this.outThisStep=function(c,b){c?b(null):u?(c=new M,c.setDbType(u.getName()),c=A.createNextDbConnectStep(c),b([c])):(C.getMessageCurtain().showPrompt(g.get("selectAnDataSource",
"\u8bf7\u9009\u4e2d\u4e00\u9879\u6570\u636e\u6e90\u3002")),b(A))};this.createNextDbConnectStep=function(c){var b=new Y(p,L);b.setCreateSuccessCallback(x);b.setSource(c);return b}}function Y(p,L){ia.call(this);var A=this.protectedMethod,C,x,u,v,J;this.setCreateSuccessCallback=function(N){v=N};this.setSource=function(N){C=N;x=new qa;x.setSourceType(K.DBSource);x.setModelerSource(C)};this.getSource=function(){return C};this.getSubTitle=function(){return g.get("connectDbServer","\u8fde\u63a5\u6570\u636e\u5e93\u670d\u52a1\u5668")};
this.protectedCreateUi=function(){u||(u=new xa(p),u.setOuterMessageCurtain(A.getMessageCurtain()));u.setModel(x);return J=u.getJqUi()};this.intoThisStep=function(){};this.outThisStep=function(N,z){if(N)z(null);else{var c=function(b){var f,e=!0;(b=b.getSourceName())?50<b.length&&(f=g.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")):f=g.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002");f&&(A.getMessageCurtain().showPrompt(f),e=!1);return e};(function(){var b=
u.getModel();if(c(b))u.isModelValid(b.getModelerSource(),function(){(new ha(p,function(f){v&&v(f);z(null);return!0},function(f,e){return 20002003===f?(A.getMessageCurtain().showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):20002002===f?(A.getMessageCurtain().showPrompt(g.get("duplicateHashcode","\u5df2\u5b58\u5728\u8fde\u63a5\u4fe1\u606f\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\u3002")),!0):20003301===f?(L.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),
z(null),!0):!1})).saveModelSetSource(b)},function(f){A.getMessageCurtain().showPrompt(f);return!1});else return!1})()}};this.isLastStep=function(){return!0}}function ca(p,L,A){Ea.call(this);var C=this.protectedMethod,x,u,v,J=[960,540];this.setEditSuccessCallback=function(z){v=z};this.createDialog=function(){var z=$(document.body),c=$("<div class='sa-ctrl-common-modallayer'>");c.appendTo(z);var b=new Ja(c);b.setSelectable(!0);var f=g.get("editSourceConnection","\u7f16\u8f91\u6570\u636e\u6e90\u8fde\u63a5");
b.setTitle(f);u=b.getMessageCurtain();f=J[0];var e=J[1],l=z.prop("clientWidth"),r=z.prop("clientHeight");b.setBounds(l-f>>1,r-e>>1,f,e);b.setToolbarVisible(!1);f=b.setContent;x=new xa(L);x.setOuterMessageCurtain(u);x.setModel(p);e=x.getJqUi();f.call(b,e);b.showFooterPane();c.appendTo(z);var I=function(){b.destroy();c.remove()};b.addClosingListener(function(B,F){F?N(I):I()});return b};var N=function(z){var c=x.getModel();(function(b){var f,e=!0;(b=b.getSourceName())?50<b.length&&(f=g.get("nameTooLong",
"\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")):f=g.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002");f&&(u.showPrompt(f),e=!1);return e})(c)&&x.isModelValid(c.getModelerSource(),function(){var b=p.copy();b.setModelerSource(c.getModelerSource());b.setSourceName(c.getSourceName());b.setModelSetId(ea.getModelSetId());var f=new ha(L,function(e){z();v&&v(e)},function(e,l){return 20002003==e?(u.showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):
20002002===e?(u.showPrompt(g.get("duplicateHashcode","\u5df2\u5b58\u5728\u8fde\u63a5\u4fe1\u606f\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\u3002")),!0):20002004===e?(u.showPrompt(g.get("source_no_found","\u9009\u4e2d\u7684\u6570\u636e\u6e90\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20003301===e?(z(),A.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1});f.updateModelSetSource(b);f.setShowBlocking(!0)},
function(b){C.getMessageCurtain().showPrompt(b);return!1})}}function xa(p){var L,A,C,x,u,v=!0,J;this.setOuterMessageCurtain=function(z){J=z;x&&x.setOuterMessageCurtain(J)};this.setModel=function(z){if(L=z)if(z=L.getModelerSource().getDbType(),z==O.TYPE_ACCESS||z==O.TYPE_SQLITE)v=!1;C||N();z=L.getSourceName();var c=L.getModelerSource(),b=c.getDbType();C.setText(z);x=y.getDBConnectionPanel(b,p);x.setMoveDBList2Right(v);J&&x.setOuterMessageCurtain(J);x.setModel(c,L.getId())};this.getModel=function(){var z=
L?L.copy():new qa;var c=x.getModel();z.setModelSetId(ea.getModelSetId());var b=x.getAdvanceSettingModel();c.setAdvanceSetting(b);b=(b=C.getText())&&b.replace(/\s+/g,"");z.setSourceName(b);z.setModelerSource(c);return z};this.isModelValid=function(z,c,b){return x.isModelValid(z,c,b)};this.getJqUi=function(){if(A)return A;A=$("<div>");var z=$("<div>");z.addClass("source-manage-source-db-split-line");v&&A.append(z);C||N();z=L.getModelerSource().getTypeName();z=D.getDisplayName(z);var c=$("<div>");c.addClass("source-manage-source-db-source-type");
c.text(z);A.append(c);c=new fa;z=c.getJqUi();c.setText(g.get("name","\u540d\u79f0"));c=C.getJqUi();u=x.getJqUi();P.layoutCtrl(z,20,36,80,23);P.layoutCtrl(c,110,36,300,23);P.layoutCtrl(u,20,79,375,300);A.append(z);A.append(c);A.append(u);return A};var N=function(){C=new ua;var z=L.getModelerSource().getTypeName();x=y.getDBConnectionPanel(z,p);x.setOuterMessageCurtain(J)}}function Ka(p,L){ia.call(this);var A=this,C=this.protectedMethod,x,u,v=[];E.FILE_SOURCES=[new E(k.TYPE_EXCEL,"Excel","EXCEL"),new E(k.TYPE_CSV,
"CSV","CSV"),new E(k.TYPE_TXT,"TXT","TXT",!1,!0),new E(k.TYPE_XML,"XML","XML")];this.setCreateSuccessCallback=function(c){x=c};this.getSubTitle=function(){return g.get("file","\u6587\u4ef6")};this.protectedCreateUi=function(){var c=$("<div>");c.addClass("source-manage-source-type-main");var b=v.push,f=E.FILE_SOURCES,e=g.get("file","\u6587\u4ef6"),l=$("<div>");l.addClass("dm-source-type-typelist");l.css("height","120px");l.css("top",void 0);l.appendTo(c);if(null!=e){var r=$("<div>");r.addClass("dm-source-type-typelist-title");
r.text(e);r.appendTo(l)}e=new G;e.setItemModels(f);e.setBorderVisible(!1);e.setCustomItemPainter(J);e.setCustomSelectedsPainter(N);f=e.getJqUi();f.addClass("dm-source-type-typelist-list");f.appendTo(l);e.addPressedListener(z);b.call(v,e);b=$("<div>");b.append(c);return b};var J=function(c,b){c.attr("title",b.getText());c.addClass("dm-source-type-typelist-item");var f=$("<div>");f.addClass("dm-source-type-typelist-item-icon");Z.background(f,b.getIconName());f.appendTo(c);f=$("<div>");f.addClass("dm-source-type-typelist-item-text");
f.text(b.getText());f.appendTo(c)},N=function(c,b){for(var f=0;f<c.length;f++){var e=c[f];e.removeClass("dm-source-type-typelist-item_selected");e.find(".dm-source-type-typelist-item_selected-mark").remove();e.find(".dm-source-type-typelist-item_selected-icon").remove()}for(f=0;f<b.length;f++)e=b[f],e.addClass("dm-source-type-typelist-item_selected"),c=$("<div>"),c.addClass("dm-source-type-typelist-item_selected-mark"),c.appendTo(e),c=$("<div>"),Z.background(c,"checked"),c.addClass("dm-source-type-typelist-item_selected-icon"),
c.appendTo(e)},z=function(c){for(var b=0;b<v.length;b++)v[b]!=c&&v[b].setSelecteds([]);c=c.getSelecteds();u=0<c.length?c[0]:null};this.intoThisStep=function(c,b){};this.outThisStep=function(c,b){c?b(null):u?(c=u.getName()==k.TYPE_EXCEL?new n:u.getName()==k.TYPE_XML?new q:new h,c.setFileType(u.getName()),c=A.createNextFileConnectStep(c),b([c])):(C.getMessageCurtain().showPrompt(g.get("selectAnDataSource","\u8bf7\u9009\u4e2d\u4e00\u9879\u6570\u636e\u6e90\u3002")),b(A))};this.createNextFileConnectStep=
function(c){var b=new Ca(p,L);b.setSource(c);b.setCreateSuccessCallback(x);return b}}function Ca(p,L){ia.call(this);var A=this,C=this.protectedMethod,x,u,v;this.setSource=function(J){x=J};this.setCreateSuccessCallback=function(J){v=J};this.getSubTitle=function(){return g.get("uploadFile","\u4e0a\u4f20\u6587\u4ef6")};this.protectedCreateUi=function(){u=new ka;u.setCtxApi(A.getCtxApi());var J=ya.getUrlParamValue("flatFileSize");u.setFileSize(J?J:100);u.setSource(x.clone());u.setMessageCurtain(C.getMessageCurtain());
return u.getJqUi()};this.intoThisStep=function(J,N){};this.outThisStep=function(J,N){if(J)N(null);else if(u.getConnectionName())if(50<u.getConnectionName().length)C.getMessageCurtain().showPrompt(g.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"));else if(u.hasUploadFile()){J=new qa;var z=u.getSource();J.setModelerSource(z);J.setModelSetId(ea.getModelSetId());J.setSourceType(K.FileSource);J.setSourceName(u.getConnectionName());(new ha(p,function(c){v&&
v(c);N(null);return!0},function(c,b){return 20002003===c?(C.getMessageCurtain().showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):20003301===c?(L.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),N(null),!0):!1})).saveModelSetSource(J)}else C.getMessageCurtain().showPrompt(g.get("pleaseUploadFile","\u8bf7\u5148\u4e0a\u4f20\u6587\u4ef6\u3002"));else C.getMessageCurtain().showPrompt(g.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002"))};
this.isLastStep=function(){return!0}}function H(){function p(U,ja){this.toString=function(){return ja};this.getName=function(){return U}}var L=this,A,C=1,x=0,u,v,J,N,z,c,b,f,e,l=null;g.get("uploadFile","\u4e0a\u4f20\u6587\u4ef6");var r=!1,I={CSV:["csv"],TXT:["txt"],EXCEL:["xls","xlsx"],XML:["xml"]},B={XML:"text/xml",CSV:".csv",TXT:"text/plain",EXCEL:"application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},F=["CSV","TXT"],Q=["CSV","TXT"],S=[new p(",",g.get("comma",
"\u9017\u53f7")),new p(";",g.get("semicolon","\u5206\u53f7")),new p(" ",g.get("space","\u7a7a\u683c")),new p("\t",g.get("tabs","\u5236\u8868\u7b26")),new p("\u81ea\u5b9a\u4e49",g.get("custom","\u81ea\u5b9a\u4e49"))],ba=[new p("UTF-8","UTF-8"),new p("UTF-16BE","UTF-16BE"),new p("UTF-16LE","UTF-16LE"),new p("GB2312","GB2312"),new p("GB18030","GB18030"),new p("GBK","GBK")],oa=[new p('"',g.get("doubleQuotationMark","\u53cc\u5f15\u53f7")),new p("'",g.get("singleQuotationMark","\u5355\u5f15\u53f7"))],Ha=
[new p("50",g.get("checkFirstFiftyLines","\u4ec5\u68c0\u6d4b\u524d50\u884c")),new p("100",g.get("checkFirstOneHundredLines","\u4ec5\u68c0\u6d4b\u524d100\u884c")),new p("-1",g.get("checkWholeFile","\u68c0\u6d4b\u6574\u4e2a\u6587\u4ef6"))];this.getConnectionName=function(){return $.trim(f.getText())};this.setConnectionName=function(U){e=U};this.protectedDefaultActOnOtherSource=function(){return!1};this.setCtxApi=function(U){};this.getJqUi=function(){A||(A=$("<div>"),v&&v.getFileName()?Db(function(){L.protectedInitUi(A)}):
L.protectedInitUi(A));return A};this.protectedInitUi=function(){var U=v.getFileType(),ja=$("<span>");ja.addClass("source-manage-source-file-connect-name");ja.text(g.get("name","\u540d\u79f0"));f=new ua;var la=f.getJqUi();la.addClass("source-manage-source-file-connect-name-value");e&&f.setText(e);var ma=$("<div style='text-align:center'>"),Na=$("<input type='file' id='fileToUpload' style='width:0;height:0;position:absolute;left:-100px'>");Na.attr("accept",B[U]);var Va=$("<div type='button'>");Va.on("click",
function(){Na.click()});Va.addClass("dm-source-file-upload-btn_new");var Sa=$("<div>");Sa.css("text-align","center");var ib=$("<div>");ib.addClass("dm-source-file-upload-btn-text");ib.text(g.get("uploadFile","\u4e0a\u4f20\u6587\u4ef6"));var jb=$("<div>");jb.addClass("dm-source-file-upload-btn-icon");Z.background(jb,"upload_icon_selected");var pb=$("<span>");pb.addClass("dm-source-file-upload-prompt_new");pb.text(g.get("acceptFile","\u652f\u6301#1\u6587\u4ef6\uff0c\u4e14\u6587\u4ef6\u4e0d\u5927\u4e8e#2M").replace("#1",
I[U]).replace("#2",C));var Fa=$("<div id='fileDetailProgress'>");Fa.addClass("dm-source-db-file-upload-detail_new");Fa.hide();var Oa=$("<div>");Oa.addClass("dm-source-file-upload-filename_new");var Ta=$("<div>");Ta.addClass("dm-source-file-upload-filesize_new");var wa=$("<div>");wa.addClass("dm-source-file-upload-setting");if(0<=F.indexOf(U)){var Wa=new fa(g.get("splitSign","\u5206\u9694\u7b26"));J=new Ba;J.setItemModels(S);J.setSelected(S[0]);N=new ua;var kb=new fa(g.get("characterSet","\u7f16\u7801"));
z=new Ba;z.setItemModels(ba);z.setSelected(ba[0]);var lb=new fa(g.get("textLimitSign","\u6587\u672c\u9650\u5b9a\u7b26"));c=new Ba;c.setItemModels(oa);c.setSelected(oa[0]);var Ga=new fa(g.get("defineTypeRowCount","\u6570\u636e\u7c7b\u578b\u68c0\u6d4b"));b=new Ba;b.setItemModels(Ha);b.setSelected(Ha[0]);var Xa=Wa.getJqUi();P.layoutCtrl(Xa,20,15,70,23);var Ya=J.getJqUi();P.layoutCtrl(Ya,105,15,120,23);Wa=N.getJqUi();P.layoutCtrl(Wa,230,15,120,23);kb=kb.getJqUi();P.layoutCtrl(kb,20,50,70,23);var ub=z.getJqUi();
P.layoutCtrl(ub,105,50,120,23);lb=lb.getJqUi();P.layoutCtrl(lb,20,85,70,23);var vb=c.getJqUi();P.layoutCtrl(vb,105,85,120,23);Ga=Ga.getJqUi();P.layoutCtrl(Ga,20,120,72,23);var bb=b.getJqUi();P.layoutCtrl(bb,105,120,120,23);wa.append(Xa);wa.append(Ya);wa.append(Wa);wa.append(kb);wa.append(ub);wa.append(lb);wa.append(vb);wa.append(Ga);wa.append(bb);J.addSelectedChangedListener(tb);Wa.hide()}else Ga=new fa(g.get("defineTypeRowCount","\u6570\u636e\u7c7b\u578b\u68c0\u6d4b")),b=new Ba,b.setItemModels(Ha),
b.setSelected(Ha[0]),Ga=Ga.getJqUi(),P.layoutCtrl(Ga,20,20,72,23),bb=b.getJqUi(),P.layoutCtrl(bb,105,20,120,23),wa.append(Ga),wa.append(bb);wa.hide();if(v&&v.getFileName()){Fa.removeClass("dm-source-db-file-upload-detail_new");Fa.addClass("dm-source-file-upload-detail_new");Oa=$("<div>");Oa.addClass("dm-source-file-upload-filename_new");Ta=$("<div>");Ta.addClass("dm-source-file-upload-filesize_new");Xa=$("<div>");Xa.addClass("dm-source-file-upload-fileicon");Ya=$("<progress id='progressBar' value='0' max='100'>");
Ya.addClass("dm-source-file-upload-progress");r=!0;Ga=v.getFileName();Z.background(Xa,"file_"+U.toLowerCase());Oa.text(Ga);Oa.attr("title",Ga);var Ua;1048576>x?Ua=(x/1024).toFixed(2)+"KB":1048576<=x&&(Ua=(x/1048576).toFixed(2)+"M");Ta.text("("+Ua+")");Ta.attr("title",Ua);wa.removeClass("dm-source-file-upload-setting");wa.addClass("dm-source-file-upload-setting-reload_new");Ya.hide();Fa.show();0<=F.indexOf(U)&&v.getSplitSign()&&(Ua=v.getSplitSign(),Ga=Za(Ua,S),0>S.indexOf(Ga)?(J.setSelected(S[S.length-
1]),N.setText(Ua),Wa.show()):J.setSelected(Za(v.getSplitSign(),S)),z.setSelected(Za(v.getCharacterSet(),ba)),c.setSelected(Za(v.getTextLimitSign(),oa)));b.setSelected(Za(v.getDefineTypeRowCount(),Ha));wa.show();Fa.append(Xa);Fa.append(Oa);Fa.append(Ta);Fa.append(Ya)}else Fa.append(Oa),Fa.append(Ta);"placeholder"in $("<input>")[0]?(Na.change(function(mb){qb()}),Sa.append(jb),Sa.append(ib),Va.append(Sa),ma.append(Na),ma.append(Va),A.append(ma)):(ma=$("<form id='uploadForm' method='post' enctype='multipart/form-data' target='targetIframeC'>"),
Na=$("<input name='filename' type='file' id='fileToUpload' style='width:0;height:0;position:absolute;left:-100px' onchange='submit()' multiple/>"),Oa=$("<iframe name='targetIframeC' id='targetIframeC' style='height: 0;width: 0'>"),ma.attr("action","/qing_modeler/uploadFileForIE9.do?type="+I[U]),Sa.append(jb),Sa.append(ib),Va.append(Sa),ma.append(Na),A.append(ma),A.append(Oa),A.append(Va),Oa.on("load",function(mb){try{var wb=$(window.self.frames.targetIframeC.document).find("body");if(wb.html()){var cb=
JSON.parse(wb.html().toString()),db=cb.fileName,nb=cb.fileSize;mb={};mb.name=db;var rb=cb.errorCode;if("IE9001"==rb)u.showPrompt(g.get("fileTypeIncorrect","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e\u3002"));else if("IE9002"==rb)u.showPrompt(g.get("fileTooLarge","\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u6700\u5927\u9650\u5236\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u6587\u4ef6\u3002"));else if("IE9003"==rb)u.showPrompt(g.get("uploadFileIsNull","\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a\u7a7a\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"));
else{var eb=A.find(".dm-source-file-upload-filename_new"),fb=A.find(".dm-source-file-upload-filesize_new"),$a;1048576>nb?$a=(nb/1024).toFixed(2)+"KB":1048576<=nb&&($a=(nb/1048576).toFixed(2)+"M");eb.text(db);fb.text("("+$a+")");eb.attr("title",db);fb.attr("title",$a);var Eb=A.find(".dm-source-file-upload-fileicon");eb=A.find(".dm-source-file-upload-filename");fb=A.find(".dm-source-file-upload-filesize");Z.background(Eb,"file_"+U.toLowerCase());eb.text(db);fb.text("("+$a+")");eb.attr("title",db);fb.attr("title",
$a);Fa.show();xb().find("#uploadAreaText").hide();console&&console.log(cb);yb(mb,cb.data)}}}catch(Fb){console&&console.log(Fb),u.showError(g.get("uploadFail","\u4e0a\u4f20\u5931\u8d25\u3002"))}}));A.append(ja);A.append(la);A.append(pb);A.append(Fa);L.initExtraUi(A,Fa,Na);A.append(wa)};this.initExtraUi=function(){throw Error("Override me.");};this.setText=function(U){};this.setSource=function(U){v=U};this.getSource=function(){0<=F.indexOf(v.getFileType())&&(J.getSelected()==S[S.length-1]?v.setSplitSign($.trim(N.getText())):
v.setSplitSign(J.getSelected().getName()),v.setCharacterSet(z.getSelected().getName()),v.setTextLimitSign(c.getSelected().getName()));v.setDefineTypeRowCount(b.getSelected().getName());v.setType(K.FileSource);return v};this.getOnlySource=function(){return v};this.setFileSize=function(U){C=U};this.setMessageCurtain=function(U){u=U};this.hasUploadFile=function(){return r};this.changeStyleWhenDragEnter=function(){};this.beginUploadFile=function(U,ja){throw Error("Override me.");};this.changeStyleWhenUploadSucceed=
function(){throw Error("Override me.");};this.changeStyleWhenUploading=function(U){throw Error("Override me.");};this.changeStyleWhenUploadAgain=function(){};this.changeStyleWhenUploadFailed=function(){};var tb=function(){J.getSelected()==S[S.length-1]?N.getJqUi().show():N.getJqUi().hide()},qb=function(){var U,ja=A.find("#fileToUpload");null!=ja&&null!=ja.get(0)&&null!=ja.get(0).files&&(U=ja.get(0).files[0]);U&&zb(U)},zb=function(U){if(0!=U.size){L.changeStyleWhenDragEnter();A.find("#fileDetailProgress");
var ja=v.getFileType(),la=U.name,ma=U.size,Na=la.lastIndexOf(".");la=la.substring(Na+1,la.length).toLowerCase();ma>1048576*C?u.showPrompt(g.get("fileTooLarge","\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u6700\u5927\u9650\u5236\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u6587\u4ef6\u3002")):0>I[ja].indexOf(la)?u.showPrompt(g.get("fileTypeIncorrect","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e\u3002")):L.beginUploadFile(U,ja)}else A.find("#fileToUpload").val(""),u.showError(g.get("uploadFileIsNull","\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a\u7a7a\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"))},
yb=function(U,ja){(new ha(ea.getRemoteImpl(),function(la){la&&(v.setCharacterSet(la),z&&z.setSelected(Za(la,ba)));la=U.name;v.setFileUrl(ja);v.setFileName(la);r=!0;A.find(".dm-source-file-upload-setting").show();u.showSuccess(g.get("uploadSuccess","\u4e0a\u4f20\u6210\u529f\u3002"));L.changeStyleWhenUploadSucceed()},function(la,ma){L.changeStyleWhenUploadFailed();la=la.toString();return"20"==la.substr(0,2)&&7==la.length?(u.showError(g.get("uploadFail","\u4e0a\u4f20\u5931\u8d25\u3002")),!0):!1})).guessFileEncoding(ja)},
Db=function(U){var ja=new ha(ea.getRemoteImpl(),function(ma){x=ma;U()},function(ma,Na){return!1}),la=v.getFileUrl();ja.getFileSize(la)},Gb=function(U){L.changeStyleWhenUploading(U)},Hb=function(){},Ib=function(U){u.showError(g.get("uploadFail","\u4e0a\u4f20\u5931\u8d25\u3002"));L.changeStyleWhenUploadAgain()},Ab=function(){l.abort();L.changeStyleWhenUploadFailed()},Jb=function(){A.find("#fileDetailProgress").hide();A.find(".dm-source-file-upload-setting").hide();xb().find("#uploadAreaText").show();
v.setFileUrl("");v.setCharacterSet("");v.setFileName("");r=!1;A.find("#fileToUpload").val("");if(1<=window.navigator.userAgent.indexOf("MSIE")){var U=A.find("#fileToUpload"),ja=document.createElement("form"),la=U.nextSibling,ma=U.parentNode;ja.appendChild(U);ja.reset();ma.insertBefore(U,la)}},Kb=function(){qb()},Za=function(U,ja){for(var la in ja)if(ja[la].getName()==U)return ja[la]},xb=function(){return A.find(".dm-source-file-upload-area_new")};this.protectedMethod={uploadAcceptFile:zb,doSelectFile:qb,
uploadFile:function(U){r=!1;var ja=new FormData;ja.append("filename",U);l=new XMLHttpRequest;l.upload.addEventListener("progress",Gb,!1);l.addEventListener("load",Hb,!1);l.addEventListener("error",Ib,!1);l.addEventListener("abort",Ab(),!1);(new ha(ea.getRemoteImpl())).uploadFile(l);l.onload=function(la){if(200==this.status){la=this.response;var ma=null;try{ma=JSON.parse(la)}catch(Na){u.showError(g.get("uploadFail","\u4e0a\u4f20\u5931\u8d25\u3002"));L.changeStyleWhenUploadFailed();return}if(ma&&ma.data){yb(U,
ma.data);return}if(ma&&"4001002"==ma.errorCode){u.showError(g.get("uploadFileNoAccess","\u65e0\u4e0a\u4f20\u6587\u4ef6\u6743\u9650\u3002"));L.changeStyleWhenUploadFailed();return}if(ma&&3099003==ma.errorCode){u.showError(ma.errorMessage);return}if(ma&&ma.errorMessage){u.showError(ma.errorMessage);return}}u.showError(g.get("uploadFail","\u4e0a\u4f20\u5931\u8d25\u3002"));L.changeStyleWhenUploadFailed()};l.send(ja)},bindEventToJqUploadOperation:function(U,ja){U.off();if("delete"==ja)U.on("mousedown",
Jb);else if("uploadAgain"==ja)U.on("mousedown",Kb);else if("pause"==ja)U.on("mousedown",Ab)},supportActOnSameSource:function(U){return!(0<=Q.indexOf(U))}}}function ka(){H.call(this);var p=this.protectedMethod,L,A,C,x,u;this.setEditState=function(b){u=b};this.initExtraUi=function(b,f,e){L=b;A=f;var l=$("<div>");l.addClass("dm-source-file-upload-area_new");var r=$("<div id='uploadAreaText'>");r.addClass("dm-source-file-upload-areatext");l.append(e);l.append(r);l.on("dragenter",J);l.on("dragenter",N);
l.on("dragover",J);l.on("dragleave",J);l.on("dragleave",z);l.on("drop",c);u||(C=$("<div>"),C.addClass("dm-source-file-upload-state"),Z.background(C,"upload_running"));x=$("<div>");x.addClass("dm-source-file-upload-operation");"placeholder"in $("<input>")[0]?(r.on("click",function(){L.find("#fileToUpload").click()}),r.change(function(I){doSelectFile()}),r.text(g.get("clickOrDrag","\u70b9\u51fb\u6216\u5c06\u6587\u4ef6\u62d6\u62fd\u5230\u8fd9\u91cc\u4e0a\u4f20")),f.prepend(C),u||f.append(x)):(f.prepend(C),
u||f.append(x),r.text(g.get("clickForUploadFile","\u70b9\u51fb\u8fd9\u91cc\u4e0a\u4f20\u6587\u4ef6")),f=b.find("#uploadForm"),f.append(e),l.append(f),r.on("click",function(){e.click()}));b.append(l);u&&(r=v().find("#uploadAreaText"),r.hide())};this.changeStyleWhenDragEnter=function(){v().removeClass("dm-source-file-upload-area_enter")};this.beginUploadFile=function(b,f){f=b.name;var e=b.size,l=L.find(".dm-source-file-upload-filename_new"),r=L.find(".dm-source-file-upload-filesize_new"),I;1048576>
e?I=(e/1024).toFixed(2)+"KB":1048576<=e&&(I=(e/1048576).toFixed(2)+"M");l.text(f);r.text("("+I+")");l.attr("title",f);r.attr("title",I);A.show();p.uploadFile(b)};this.changeStyleWhenUploadSucceed=function(){u||Z.background(C,"upload_success");Z.backgroundWithHover(x,"btn-delete");p.bindEventToJqUploadOperation(x,"delete")};this.changeStyleWhenUploading=function(b){v().find("#uploadAreaText").hide();Z.background(x,"upload_pause");p.bindEventToJqUploadOperation(x,"pause");if(b.lengthComputable){if(1048576<=
b.total){var f=(b.loaded/1048576).toFixed(2)+"M";b=(b.total/1048576).toFixed(2)+"M"}else f=(b.loaded/1024).toFixed(2)+"KB",b=(b.total/1024).toFixed(2)+"KB";var e=L.find(".dm-source-file-upload-filesize_new");e.text("("+f+" of "+b+")");f==b&&e.text("("+b+")");e.attr("title",b)}};this.changeStyleWhenUploadPaused=function(){};this.changeStyleWhenUploadAgain=function(){Z.background(C,"upload_fail");Z.background(x,"upload_again");p.bindEventToJqUploadOperation(x,"uploadAgain")};this.changeStyleWhenUploadFailed=
function(){Z.backgroundWithHover(x,"btn-delete");p.bindEventToJqUploadOperation(x,"delete")};var v=function(){return L.find(".dm-source-file-upload-area_new")},J=function(b){b.originalEvent.stopPropagation();b.originalEvent.preventDefault()},N=function(b){v().addClass("dm-source-file-upload-area_enter")},z=function(b){v().removeClass("dm-source-file-upload-area_enter")},c=function(b){J(b);p.uploadAcceptFile(b.originalEvent.dataTransfer.files[0])}}function Ia(p,L,A){Ea.call(this);var C,x,u,v,J=[960,
540];this.setEditSuccessCallback=function(c){v=c};this.createDialog=function(){var c=$(document.body),b=$("<div class='sa-ctrl-common-modallayer'>");b.appendTo(c);u=new Ja(b);u.setSelectable(!0);var f=g.get("editSourceConnection","\u7f16\u8f91\u6570\u636e\u6e90\u8fde\u63a5");u.setTitle(f);x=u.getMessageCurtain();f=J[0];var e=J[1],l=c.prop("clientWidth"),r=c.prop("clientHeight");u.setBounds(l-f>>1,r-e>>1,f,e);u.setToolbarVisible(!1);u.setContent(z());u.showFooterPane();b.appendTo(c);var I=function(){u.destroy();
b.remove()};u.addClosingListener(function(B,F){F?N(I):I()});return u};var N=function(c){var b=function(l){c();v&&v(l)},f=function(l,r){return 20002003===l?(u.getMessageCurtain().showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):20002004===l?(u.getMessageCurtain().showPrompt(g.get("source_no_found","\u9009\u4e2d\u7684\u6570\u636e\u6e90\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20003301===l?(c(),A.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),
!0):!1};if(C.getConnectionName())if(50<C.getConnectionName().length)x.showPrompt(g.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"));else if(C.hasUploadFile()){var e=C.getSource();p.setModelerSource(e);p.setSourceName(C.getConnectionName());p.setModelSetId(ea.getModelSetId());b=new ha(L,b,f);b.setShowBlocking(!0);b.updateModelSetSource(p)}else x.showPrompt(g.get("pleaseUploadFile","\u8bf7\u5148\u4e0a\u4f20\u6587\u4ef6\u3002"));else x.showPrompt(g.get("emptyName",
"\u8bf7\u8f93\u5165\u540d\u79f0\u3002"))},z=function(){C=new ka;var c=ya.getUrlParamValue("flatFileSize");C.setFileSize(c?c:100);C.setSource(p.getModelerSource().clone());C.setMessageCurtain(x);C.setEditState(!0);C.setConnectionName(p.getSourceName());return C.getJqUi()}}function pa(p,L){ia.call(this);var A=this.protectedMethod,C,x,u=[];E.BIZ_SOURCES=[new E(K.ERPCloudEntity,g.get("businessEntity","\u4e1a\u52a1\u5b9e\u4f53"),"COSMIC",!1,!0),new E(K.ERPCloudDBCenter,g.get("DBCenter","\u6570\u636e\u4e2d\u5fc3"),
"COSMIC",!1,!0)];this.setCreateSuccessCallback=function(z){C=z};this.getSubTitle=function(){return g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79")};this.protectedCreateUi=function(){var z=$("<div>");z.addClass("source-manage-source-type-main");var c=u.push,b=E.BIZ_SOURCES,f=g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79"),e=$("<div>");e.addClass("dm-source-type-typelist");e.css("height","120px");e.css("top",void 0);e.appendTo(z);if(null!=f){var l=$("<div>");l.addClass("dm-source-type-typelist-title");
l.text(f);l.appendTo(e)}f=new G;f.setItemModels(b);f.setBorderVisible(!1);f.setCustomItemPainter(v);f.setCustomSelectedsPainter(J);b=f.getJqUi();b.addClass("dm-source-type-typelist-list");b.appendTo(e);f.addPressedListener(N);c.call(u,f);c=$("<div>");c.append(z);return c};var v=function(z,c){z.attr("title",c.getText());z.addClass("dm-source-type-typelist-item");var b=$("<div>");b.addClass("dm-source-type-typelist-item-icon");Z.background(b,c.getIconName());b.appendTo(z);b=$("<div>");b.addClass("dm-source-type-typelist-item-text");
b.text(c.getText());b.appendTo(z)},J=function(z,c){for(var b=0;b<z.length;b++){var f=z[b];f.removeClass("dm-source-type-typelist-item_selected");f.find(".dm-source-type-typelist-item_selected-mark").remove();f.find(".dm-source-type-typelist-item_selected-icon").remove()}for(b=0;b<c.length;b++)f=c[b],f.addClass("dm-source-type-typelist-item_selected"),z=$("<div>"),z.addClass("dm-source-type-typelist-item_selected-mark"),z.appendTo(f),z=$("<div>"),Z.background(z,"checked"),z.addClass("dm-source-type-typelist-item_selected-icon"),
z.appendTo(f)},N=function(z){for(var c=0;c<u.length;c++)u[c]!=z&&u[c].setSelecteds([]);z=z.getSelecteds();x=0<z.length?z[0]:null};this.intoThisStep=function(z,c){};this.outThisStep=function(z,c){if(z)c(null);else if(x){var b=new m;b.setType(x.getName());z=new qa;z.setModelerSource(b);z.setModelSetId(ea.getModelSetId());z.setSourceType(x.getName());b=new ha(p,function(f){C&&C(f);c(null);return!0},function(f,e){return 20002001===f?(A.getMessageCurtain().showPrompt(g.get("noDBCenterPerm","\u6ca1\u6709\u6570\u636e\u4e2d\u5fc3\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002")),
!0):20002005===f?(A.getMessageCurtain().showPrompt(g.get("sourceAlreadyExists","\u5df2\u5b58\u5728\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20003301===f?(L.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),c(null),!0):!1});b.saveModelSetSource(z);b.setShowBlocking(!0)}else A.getMessageCurtain().showPrompt(g.get("selectAnDataSource","\u8bf7\u9009\u4e2d\u4e00\u9879\u6570\u636e\u6e90\u3002"))};
this.isLastStep=function(){return!0}}function ra(p,L){ia.call(this);var A=this.protectedMethod,C,x,u,v=[];this.setCreateSuccessCallback=function(b){x=b};this.getSubTitle=function(){return g.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90")};this.protectedCreateUi=function(){var b=$("<div>");b.addClass("modelset-source-type-main");J(b);var f=$("<div>");f.append(b);return f};var J=function(b){var f=new ha(p,function(e){if(e)if(0==e.length){C=g.get("noAlternativeSource","\u5f53\u524d\u6ca1\u6709\u53ef\u9009\u62e9\u7684\u6570\u636e\u6e90\u3002");
var l=$("<div>");l.addClass("source-manage-source-public-no-source-container");e=$("<div>");e.addClass("source-manage-source-public-no-source-icon");Z.background(e,"no-public-source");l.append(e);e=$("<div>");e.addClass("source-manage-source-public-no-source-text");e.text(g.get("noAuthPublicSource","\u6682\u65e0\u6388\u6743\u7ed9\u6211\u7684\u516c\u5171\u6570\u636e\u6e90\u3002"));l.append(e);l.appendTo(b)}else{l=[];for(var r=0;r<e.length;r++){var I=new d;I.fromJsonObject(e[r]);var B=I.getId(),F=I.getName();
I=I.getDBSource();l.push(new E(B,F,I.getDbType()))}r=g.get("database","\u6570\u636e\u5e93");e=$("<div>");e.addClass("dm-source-type-typelist");e.css("height","420px");e.css("top",void 0);e.css("overflow","auto");e.appendTo(b);null!=r&&(B=$("<div>"),B.addClass("dm-source-type-typelist-title"),B.text(r),B.appendTo(e));r=new G;r.setItemModels(l);r.setBorderVisible(!1);r.setCustomItemPainter(N);r.setCustomSelectedsPainter(z);l=r.getJqUi();l.addClass("dm-source-type-typelist-list");l.appendTo(e);r.addPressedListener(c)}});
f.setShowBlocking(!0);f.loadDBConnections()},N=function(b,f){b.attr("title",f.getText());b.addClass("dm-source-type-typelist-item");var e=$("<div>");e.addClass("dm-source-type-typelist-item-icon");Z.background(e,f.getIconName());e.appendTo(b);e=$("<div>");e.addClass("dm-source-type-typelist-item-text");e.css({"text-overflow":"ellipsis",overflow:"hidden"});e.text(f.getText());e.appendTo(b)},z=function(b,f){for(var e=0;e<b.length;e++){var l=b[e];l.removeClass("dm-source-type-typelist-item_selected");
l.find(".dm-source-type-typelist-item_selected-mark").remove();l.find(".dm-source-type-typelist-item_selected-icon").remove()}for(e=0;e<f.length;e++)l=f[e],l.addClass("dm-source-type-typelist-item_selected"),b=$("<div>"),b.addClass("dm-source-type-typelist-item_selected-mark"),b.appendTo(l),b=$("<div>"),Z.background(b,"checked"),b.addClass("dm-source-type-typelist-item_selected-icon"),b.appendTo(l)},c=function(b){for(var f=0;f<v.length;f++)v[f]!=b&&v[f].setSelecteds([]);b=b.getSelecteds();u=0<b.length?
b[0]:null};this.intoThisStep=function(b,f){};this.outThisStep=function(b,f){b?f(null):u?(b=new ha(ea.getRemoteImpl(),function(e){for(var l=[],r=u.getText(),I=!1,B=0,F=e.length;B<F;B++){var Q=new qa;Q.fromJsonObject(e[B]);var S=Q.getSourceName();S==r?I=!0:u.getName()==Q.getSourceType()&&0==S.indexOf(r)&&l.push(S)}if(I){Q=1;for(B=!1;!B;){e=!1;for(B=0;B<l.length;B++)if(l[B]==r+"-"+Q){Q++;e=!0;break}B=!e}r=r+"-"+Q}l=new w;l.setType(K.PublicDBSource);l.setRefId(u.getName());Q=new qa;Q.setModelerSource(l);
Q.setSourceName(r);Q.setModelSetId(ea.getModelSetId());Q.setSourceType(K.PublicDBSource);(new ha(p,function(ba){x&&x(ba);f(null);return!0},function(ba,oa){return 20002006===ba?(A.getMessageCurtain().showPrompt(g.get("sourceAlreadyExists","\u5df2\u5b58\u5728\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20002004===ba?(A.getMessageCurtain().showPrompt(g.get("source_no_found","\u9009\u4e2d\u7684\u6570\u636e\u6e90\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),
!0):20003301===ba?(L.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),f(null),!0):!1})).saveModelSetSource(Q)}),b.setShowBlocking(!0),b.loadModelSetSources(ea.getModelSetId())):C?A.getMessageCurtain().showPrompt(C):A.getMessageCurtain().showPrompt(g.get("selectAnDataSource","\u8bf7\u9009\u4e2d\u4e00\u9879\u6570\u636e\u6e90\u3002"))};this.isLastStep=function(){return!0}}function W(p,L){ia.call(this);var A=this.protectedMethod,C,
x,u=[];this.setCreateSuccessCallback=function(c){C=c};this.getSubTitle=function(){return g.get("modelSet","\u6a21\u578b\u96c6")};this.protectedCreateUi=function(){var c=$("<div>");c.addClass("modelset-type-select-main");v(c);var b=$("<div>");b.append(c);return b};var v=function(c){var b=new ha(ea.getRemoteImpl(),function(f){if(f){f=Object.entries(f);for(var e=!0,l=0;l<f.length;l++){var r=f[l][0],I=f[l][1];if(I&&0!=I.length){var B=[];e=!1;for(var F=0;F<I.length;F++){var Q=new ta;Q.fromJsonObject(I[F]);
var S=Q.getModelSetId();Q=Q.getModelSetName();B.push(new E(S,Q,"modelSet_source"))}I=B;var ba=r;r=c;B=$("<div>");F=$("<div>");F.addClass("modelset-type-typelist-title");S=F;Q=S.text;a:{switch(ba){case "CREATE":ba=g.get("createdOfModelSet","\u6211\u521b\u5efa\u7684\u6a21\u578b\u96c6");break a;case "COOPERATION":ba=g.get("cooperationOfModelSet","\u6211\u53c2\u4e0e\u534f\u4f5c\u7684\u6a21\u578b\u96c6");break a;case "AUTHORIZE":ba=g.get("authorizeOfModelSet","\u6388\u6743\u7ed9\u6211\u7684\u6a21\u578b\u6240\u5728\u7684\u6a21\u578b\u96c6");
break a}ba=void 0}Q.call(S,ba);B.append(F);F=new G;F.setItemModels(I);F.setBorderVisible(!1);F.setCustomItemPainter(J);F.setCustomSelectedsPainter(N);F.addPressedListener(z);u.push(F);I=F.getJqUi();I.addClass("modelset-type-typelist-list");B.append(I);B.appendTo(r)}}e&&(f=$("<div class='modelset-type-no-source-container'>"),e=$("<div class='modelset-type-no-source-icon'>"),Z.background(e,"no-public-source"),e.appendTo(f),e=$("<div class='modelset-type-no-source-message'>"),e.text(g.get("noAvailableModelset",
"\u6682\u65e0\u53ef\u9009\u62e9\u7684\u6a21\u578b\u96c6")),e.appendTo(f),f.appendTo(c))}});b.setShowBlocking(!0);b.loadPermissionModelSet(ea.getModelSetId())},J=function(c,b){c.attr("title",b.getText());c.addClass("dm-source-type-typelist-item");var f=$("<div>");f.addClass("dm-source-type-typelist-item-icon");Z.background(f,b.getIconName());f.appendTo(c);f=$("<div>");f.addClass("dm-source-type-typelist-item-text");f.css({"text-overflow":"ellipsis",overflow:"hidden"});f.text(b.getText());f.appendTo(c)},
N=function(c,b){for(var f=0;f<c.length;f++){var e=c[f];e.removeClass("dm-source-type-typelist-item_selected");e.find(".dm-source-type-typelist-item_selected-mark").remove();e.find(".dm-source-type-typelist-item_selected-icon").remove()}for(f=0;f<b.length;f++)e=b[f],e.addClass("dm-source-type-typelist-item_selected"),c=$("<div>"),c.addClass("dm-source-type-typelist-item_selected-mark"),c.appendTo(e),c=$("<div>"),Z.background(c,"checked"),c.addClass("dm-source-type-typelist-item_selected-icon"),c.appendTo(e)},
z=function(c){for(var b=0;b<u.length;b++)u[b]!=c&&u[b].setSelecteds([]);c=c.getSelecteds();x=0<c.length?c[0]:null};this.intoThisStep=function(c,b){};this.outThisStep=function(c,b){c?b(null):x?(c=new ha(ea.getRemoteImpl(),function(f){for(var e=[],l=x.getText(),r=!1,I=0,B=f.length;I<B;I++){var F=new qa;F.fromJsonObject(f[I]);var Q=F.getSourceName();Q==l?r=!0:x.getName()==F.getSourceType()&&0==Q.indexOf(l)&&e.push(Q)}if(r){F=1;for(I=!1;!I;){f=!1;for(I=0;I<e.length;I++)if(e[I]==l+"-"+F){F++;f=!0;break}I=
!f}l=l+"-"+F}e=new t;e.setType(K.ModelSet);e.setRefId(x.getName());e.setRefType(ea.getModelSetId()==x.getName()?t.TYPE_CURRENT:t.TYPE_OTHER);F=new qa;F.setModelerSource(e);F.setSourceName(l);F.setModelSetId(ea.getModelSetId());F.setSourceType(K.ModelSet);(new ha(p,function(S){C&&C(S);b(null);return!0},function(S,ba){return 20002006===S?(A.getMessageCurtain().showPrompt(g.get("sourceAlreadyExists","\u5df2\u5b58\u5728\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),
!0):20002004===S?(A.getMessageCurtain().showPrompt(g.get("source_no_found","\u9009\u4e2d\u7684\u6570\u636e\u6e90\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20003301===S?(L.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),b(null),!0):!1})).saveModelSetSource(F)}),c.setShowBlocking(!0),c.loadModelSetSources(ea.getModelSetId())):A.getMessageCurtain().showPrompt(g.get("selectAnDataSource","\u8bf7\u9009\u4e2d\u4e00\u9879\u6570\u636e\u6e90\u3002"))};
this.isLastStep=function(){return!0}}function na(p,L){ia.call(this);var A=this.protectedMethod,C,x,u,v,J,N;this.setCreateSuccessCallback=function(c){C=c};this.getSubTitle=function(){return g.get("OpenAPI","OpenAPI")};this.protectedCreateUi=function(){var c=$("<div>");c.addClass("source-manage-source-type-main");z(c);return c};var z=function(c){x=new sa;x.setOpenAPIType(sa.TYPE_RESTFUL_DATA_SET);var b=$("<div>");b.addClass("source-manage-openApi-left-side");u=new aa;u.setText(g.get("RESTfulDataSet",
"RESTful\u6570\u636e\u96c6"));var f=u.getJqUi();u.setChecked(!0);var e=new aa;e.setText(g.get("programDataSet","\u7a0b\u5e8f\u6570\u636e\u96c6"));var l=e.getJqUi();f.appendTo(b);l.appendTo(b);var r=$("<div>");r.addClass("source-manage-openApi-right-side");var I=new fa;I.setText(g.get("name","\u540d\u79f0"));I=I.getJqUi();I.appendTo(r);v=new ua;var B=v.getJqUi();B.appendTo(r);var F=new fa("URL"),Q=F.getJqUi();Q.appendTo(r);J=new ua;J.setPlaceholder(g.get("RESTfulDataSetUrlPlaceholder","\u8bf7\u8f93\u5165URL\u5168\u8def\u5f84"));
var S=J.getJqUi();S.appendTo(r);N=new za(!1);var ba=N.initUi();P.layoutCtrl(ba,30,100,580,270);r.append(ba);var oa=new Ra;oa.addElement(u);oa.addElement(e);oa.addChangedListener(function(){u.isChecked()?(J.setPlaceholder(g.get("RESTfulDataSetUrlPlaceholder","\u8bf7\u8f93\u5165URL\u5168\u8def\u5f84")),F.setText("URL"),x.setOpenAPIType(sa.TYPE_RESTFUL_DATA_SET),ba.empty()&&(ba=N.initUi(),P.layoutCtrl(ba,30,100,580,270),r.append(ba))):e.isChecked()&&(J.setPlaceholder(g.get("programDataSetPlaceholder",
"\u8bf7\u8f93\u5165Java\u7c7b\u7684\u5168\u8def\u5f84")),F.setText(g.get("classPath","\u7c7b\u8def\u5f84")),x.setOpenAPIType(sa.TYPE_PROGRAM_DATA_SET),ba.empty());v.setText();J.setText()});P.layoutCtrl(f,20,20,200,20);P.layoutCtrl(l,20,60,200,20);P.layoutCtrl(I,40,14,50,23);P.layoutCtrl(B,100,14,510,23);P.layoutCtrl(Q,40,57,50,23);P.layoutCtrl(S,100,57,510,23);b.appendTo(c);r.appendTo(c)};this.intoThisStep=function(c,b){};this.outThisStep=function(c,b){if(c)b(null);else if(v.getText())if(J.getText())if(50<
v.getText().length)A.getMessageCurtain().showPrompt(g.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"));else{c=Da.encode($.trim(J.getText()));x.setUrl(c);c=N.getAbstractOpenAPIAuth();if(x.getOpenAPIType()===sa.TYPE_RESTFUL_DATA_SET&&c){if(null!=c.protectedCheckParams()){A.getMessageCurtain().showPrompt(c.protectedCheckParams());return}c=c.protectedGetModelFromUI();x.setAuthModel(c.protectedToJsonObject())}else x.setAuthModel(null);c=new ha(ea.getRemoteImpl(),
function(f){f=new qa;f.setSourceType(K.OpenAPI);f.setModelSetId(ea.getModelSetId());f.setSourceName($.trim(v.getText()));f.setModelerSource(x);(new ha(p,function(e){C&&C(e);b(null);return!0},function(e,l){return 20002003===e?(A.getMessageCurtain().showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):20002002===e?(A.getMessageCurtain().showPrompt(g.get("duplicateHashcode","\u5df2\u5b58\u5728\u8fde\u63a5\u4fe1\u606f\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\u3002")),!0):20003301===
e?(L.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),b(null),!0):!1})).saveModelSetSource(f)},Bb(A.getMessageCurtain()));c.setShowBlocking(!0);c.openAPIInitialCheck(x)}else x.getOpenAPIType()===sa.TYPE_RESTFUL_DATA_SET?A.getMessageCurtain().showPrompt(g.get("urlNotNull","URL\u4e0d\u80fd\u4e3a\u7a7a\u3002")):A.getMessageCurtain().showPrompt(g.get("classNameNotNull","Java\u7c7b\u7684\u5168\u8def\u5f84\u4e0d\u80fd\u4e3a\u7a7a\u3002"));
else A.getMessageCurtain().showPrompt(g.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002"))};this.isLastStep=function(){return!0}}function Pa(p,L,A){Ea.call(this);var C,x,u,v=[640,540],J,N,z,c;this.setEditSuccessCallback=function(e){u=e};this.createDialog=function(){var e=$(document.body),l=$("<div class='sa-ctrl-common-modallayer'>");l.appendTo(e);var r=new Ja(l);r.setSelectable(!0);var I=g.get("editSourceConnection","\u7f16\u8f91\u6570\u636e\u6e90\u8fde\u63a5");r.setTitle(I);x=r.getMessageCurtain();
I=v[0];var B=v[1],F=e.prop("clientWidth"),Q=e.prop("clientHeight");r.setBounds(F-I>>1,Q-B>>1,I,B);r.setToolbarVisible(!1);r.setContent(b());r.showFooterPane();l.appendTo(e);var S=function(){r.destroy();l.remove()};r.addClosingListener(function(ba,oa){oa?f(S):S()});return r};var b=function(){var e=$("<div>");J=new fa(g.get("RESTfulDataSet","RESTful\u6570\u636e\u96c6"));C=p.getModelerSource();var l=new fa;l.setText(g.get("name","\u540d\u79f0"));l=l.getJqUi();l.appendTo(e);N=new ua;var r=N.getJqUi();
r.appendTo(e);N.setText(p.getSourceName());P.layoutCtrl(l,20,35,80,23);P.layoutCtrl(r,80,35,510,23);r="URL";z=new ua;z.setPlaceholder(g.get("RESTfulDataSetUrlPlaceholder","\u8bf7\u8f93\u5165URL\u5168\u8def\u5f84"));"PROGRAM_DATA_SET"==C.getOpenAPIType()&&(z.setPlaceholder(g.get("programDataSetPlaceholder","\u8bf7\u8f93\u5165Java\u7c7b\u7684\u5168\u8def\u5f84")),J=new fa(g.get("programDataSet","\u7a0b\u5e8f\u6570\u636e\u96c6\uff1a")),r=g.get("classPath","\u7c7b\u8def\u5f84"));z.setText(Da.decode(C.getUrl()));
l=z.getJqUi();r=(new fa(r)).getJqUi();r.appendTo(e);P.layoutCtrl(r,20,73,80,23);P.layoutCtrl(l,80,73,510,23);l.appendTo(e);l=J.getJqUi();l.css("font-size","14px");P.layoutCtrl(l,0,0,200,23);l.appendTo(e);"RESTFUL_DATA_SET"==C.getOpenAPIType()&&(c=new za(!0),C.getAuthModel()&&c.setModel(C.getAuthModel()),l=c.initUi(),P.layoutCtrl(l,10,111,580,270),e.append(l));return e},f=function(e){if(N.getText())if(z.getText())if(50<N.getText().length)x.showPrompt(g.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"));
else{var l=C.clone(),r=Da.encode($.trim(z.getText()));l.setUrl(r);r=null;if("RESTFUL_DATA_SET"==C.getOpenAPIType()){var I=c.getAbstractOpenAPIAuth();if(I){if(null!=I.protectedCheckParams()){x.showPrompt(I.protectedCheckParams());return}(I=I.protectedGetModelFromUI())&&(r=I.protectedToJsonObject())}}l.setAuthModel(r);r=new ha(ea.getRemoteImpl(),function(B){B=p.copy();B.setSourceName($.trim(N.getText()));B.setModelSetId(ea.getModelSetId());B.setModelerSource(l);(new ha(L,function(F){e();u&&u(F)},function(F,
Q){return 20002003===F?(x.showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):20002002===F?(x.showPrompt(g.get("duplicateHashcode","\u5df2\u5b58\u5728\u8fde\u63a5\u4fe1\u606f\u76f8\u540c\u7684\u6570\u636e\u6e90\u8fde\u63a5\u3002")),!0):20002004===F?(x.showPrompt(g.get("source_no_found","\u9009\u4e2d\u7684\u6570\u636e\u6e90\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20003301===F?(e(),A.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),
!0):!1})).updateModelSetSource(B)},Bb(x));r.setShowBlocking(!0);r.openAPIInitialCheck(l)}else C.getOpenAPIType()===sa.TYPE_RESTFUL_DATA_SET?x.showPrompt(g.get("urlNotNull","URL\u4e0d\u80fd\u4e3a\u7a7a\u3002")):x.showPrompt(g.get("classNameNotNull","Java\u7c7b\u7684\u5168\u8def\u5f84\u4e0d\u80fd\u4e3a\u7a7a\u3002"));else x.showPrompt(g.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002"))}}function za(p){function L(c,b){this.getTypeName=function(){return c};this.getTypeCode=function(){return b}}
var A,C,x,u,v,J=p?38:43,N=[new L(g.get("noAuth","\u65e0"),null),new L("Basic",ab.BASIC),new L("Bearer",ab.BEARER),new L("Digest",ab.DIGEST),new L(g.get("cosmicAuth","\u82cd\u7a79\u8ba4\u8bc1"),ab.COSMIC)];this.setAbstractOpenAPIAuth=function(c){u=c};this.getAbstractOpenAPIAuth=function(){return u};this.initUi=function(){A=$("<div>");var c=(new fa(g.get("authType","\u8ba4\u8bc1\u65b9\u5f0f"))).getJqUi();c.attr("title",g.get("authType","\u8ba4\u8bc1\u65b9\u5f0f"));P.layoutCtrl(c,10,0,54,23);c.appendTo(A);
c=$("<div>");var b=$("<span>");b.text(g.get("httpAuthHelpIconTips","\u63d0\u4f9b\u5e38\u89c1HTTP\u8eab\u4efd\u8ba4\u8bc1\uff0c\u53ef\u4ee5\u6307\u5b9a\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u9274\u6743  "));b.appendTo(c);b=Cb.getQingModelerRESTfulAuthUrl();b=$("<a onclick='javascript:window.open(\""+b+"\");' href='#'>");b.text(g.get("viewDetails","\u67e5\u770b\u5e2e\u52a9\u6587\u6863"));b.css("cursor","pointer");b.css("color","#5582f3");b.appendTo(c);b=new sb;b.setIconType(sb.ICON_TYPE_QUESTION);
b.setTipsSize(200,70);b.setTipsHtml(c[0]);c=b.getJqUi();c.addClass("source-manage-openApi-notice-icon");P.layoutCtrl(c,64,4,16,16);c.appendTo(A);C=new Ba;C.setItemModels(N);C.setSelected(N[0]);C.setCustomPainter(function(f,e,l){e.text(l.getTypeName())});C.addSelectedChangedListener(function(f,e,l){f=l.getTypeCode();null==f?(u=null,v&&v.hide()):(v&&v.empty(),u=x&&f===x.getAuthType()?ob.getImpl(f,x):ob.getImpl(f,null),v=u.getJqUi(),P.layoutCtrl(v,0,J,580,227),v.appendTo(A),v.show())});c=C.getJqUi();
c.appendTo(A);P.layoutCtrl(c,100,0,170,23);z();A.addClass("sa-ctrl-common-foreground_enabled");return A};this.setModel=function(c){x=ab.getImpl(c.authType);x.protectedFromJsonObject(c)};var z=function(){if(x){for(var c=1;c<N.length;c++)if(N[c].getTypeCode()===x.getAuthType()){C.setSelected(N[c]);break}u=ob.getImpl(x.getAuthType(),x);v=u.getJqUi();P.layoutCtrl(v,0,J,580,227);v.appendTo(A)}}}function Aa(p,L,A){Ea.call(this);var C,x,u,v,J=[400,300];this.setEditSuccessCallback=function(c){v=c};this.createDialog=
function(){var c=$(document.body),b=$("<div class='sa-ctrl-common-modallayer'>");b.appendTo(c);var f=new Ja(b);f.setSelectable(!0);var e=g.get("editSourceConnection","\u7f16\u8f91\u6570\u636e\u6e90\u8fde\u63a5");f.setTitle(e);C=f.getMessageCurtain();e=J[0];var l=J[1],r=c.prop("clientWidth"),I=c.prop("clientHeight");f.setBounds(r-e>>1,I-l>>1,e,l);f.setToolbarVisible(!1);f.setContent(z());f.showFooterPane();b.appendTo(c);var B=function(){f.destroy();b.remove()};f.addClosingListener(function(F,Q){Q?
N(B):B()});return f};var N=function(c){var b=$.trim(x.getText()),f;""!==b&&50<b.length?f=g.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):""===b&&(f=g.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002"));f?C.showPrompt(f,2E3):b==p.getSourceName()?(c(),A.showSuccess(g.get("editSuccess","\u7f16\u8f91\u6210\u529f\u3002"))):(f=p.copy(),f.setSourceName(b),f.setModelSetId(ea.getModelSetId()),b=new ha(L,function(e){c();v&&v(e)},function(e,l){return 20002003===
e?(C.showPrompt(g.get("duplicateName","\u540d\u79f0\u91cd\u590d\u3002")),!0):20002004===e?(C.showPrompt(g.get("source_no_found","\u9009\u4e2d\u7684\u6570\u636e\u6e90\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002")),!0):20003301===e?(c(),A.showPrompt(g.get("modelSetNotExist","\u6a21\u578b\u96c6\u5df2\u88ab\u5220\u9664\uff0c\u64cd\u4f5c\u5931\u8d25\u3002")),!0):!1}),b.setShowBlocking(!0),b.updateModelSetSource(f))},z=function(){var c=$("<div>"),b=new fa;b.setText(g.get("source",
"\u6765\u6e90"));b=b.getJqUi();u=new ua;var f=p.getSourceType();var e=p.getRefSourceName();if(f==K.ERPCloudEntity){var l=g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79")+"/";e=g.get("businessEntity","\u4e1a\u52a1\u5b9e\u4f53")}else f==K.ERPCloudDBCenter?(l=g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79")+"/",e=g.get("DBCenter","\u6570\u636e\u4e2d\u5fc3")):f==K.PublicDBSource?l=g.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90")+"/":f==K.ModelSet&&(l=g.get("modelSet","\u6a21\u578b\u96c6")+
"/");f=l+e;u.setText(f);u.setEnabled(!1);l=u.getJqUi();l.attr("title",f);f=new fa;f.setText(g.get("name","\u540d\u79f0"));f=f.getJqUi();x=new ua;x.setText(p.getSourceName());e=x.getJqUi();f.appendTo(c);e.appendTo(c);b.appendTo(c);l.appendTo(c);P.layoutCtrl(b,60,20,70,23);P.layoutCtrl(l,60,45,280,23);P.layoutCtrl(f,60,100,70,23);P.layoutCtrl(e,60,125,280,23);return c}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos=
{});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.modeler&&(com.kingdee.bos.qing.modeler={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset&&(com.kingdee.bos.qing.modeler.modelset={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.source&&(com.kingdee.bos.qing.modeler.modelset.source={});"undefined"==typeof com.kingdee.bos.qing.modeler.modelset.source.ui&&(com.kingdee.bos.qing.modeler.modelset.source.ui={});var da=
com.kingdee.bos.qing.modeler.modelset.source.ui;da.MainUi=function(){function p(I,B){this.getTypeName=function(){return I};this.getTypeCode=function(){return B}}var L,A,C,x,u,v,J,N;this.createJqUi=function(){L||(N||(N=new Qa,N.getJqUi().appendTo($(document.body))),L=$("<div class='source-manage-main'>"),console.log(com.kingdee.bos.qing.Seer.getUrlParamValue("language")),z(L),J=new T(ea.getRemoteImpl()),J.setMessageCurtain(N),J.getJqUi().appendTo(L),r());return L};var z=function(I){A=$("<div class='source-manage-toolbar'>");
var B=$("<div class='source-manage-toolbar-title'>");B.text(g.get("dataSourceManage","\u6570\u636e\u6e90\u7ba1\u7406"));A.append(B);B=$("<div>");B.addClass("source-manage-toolbar-search-icon");B.attr("title",g.get("search","\u641c\u7d22"));Z.backgroundWithHover(B,"btn-search");B.on("mouseenter",function(){c()});A.append(B);var F=e();A.append(F);B.appendTo(A);I.append(A)},c=function(){if(v)v.css("display","block");else{v=$("<div>");C=new va;C.setSearchListenerDelay(1E3);C.addSearchListener(l);C.setAlwaysShowCleanIcon(!0);
C.setShowSearchIcon(!0);C.setPlaceholder(g.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));var I=C.getJqUi();I.addClass("source-manage-toolbar-searchBox");I.find(":input").on("keydown",function(F){13==(F.keyCode||F.which||F.charCode)&&l()});I.appendTo(v);v.appendTo(A)}C.setFoucs();var B=function(F){var Q=$(document.body).children(".sa-ctrl-common-popup");for(F=F.target;F!=document.body;){if(F==v[0]||u&&F==u.getJqUi()[0]||Q&&F==Q[0])return;F=F.parentNode}v.css("display","none");
document.body.removeEventListener("mousedown",B,!0)};document.body.addEventListener("mousedown",B,!0);return I},b=[new p(g.get("allType","\u5168\u90e8\u7c7b\u578b"),null),new p(g.get("database","\u6570\u636e\u5e93"),E.DBSource),new p(g.get("file","\u6587\u4ef6"),E.FileSource),new p(g.get("OpenAPI","OpenAPI"),E.OpenAPI),new p(g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79"),E.ERPCloud),new p(g.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90"),E.PublicSource),new p(g.get("modelSet","\u6a21\u578b\u96c6"),
E.ModelSet)],f=[new p(g.get("allType","\u5168\u90e8\u7c7b\u578b"),null),new p(g.get("file","\u6587\u4ef6"),E.FileSource),new p(g.get("database","\u6570\u636e\u5e93"),E.DBSource),new p(g.get("OpenAPI","OpenAPI"),E.OpenAPI),new p(g.get("ERPCloud","\u91d1\u8776\u4e91\u00b7\u82cd\u7a79"),E.ERPCloud),new p(g.get("modelSet","\u6a21\u578b\u96c6"),E.ModelSet),new p(g.get("publicDataSource","\u516c\u5171\u6570\u636e\u6e90"),E.PublicSource)],e=function(){u=new Ba;var I=hb?f:b;u.setItemModels(I);u.setSelected(I[0]);
u.setCustomPainter(function(B,F,Q){F.text(Q.getTypeName())});u.addSelectedChangedListener(function(B,F,Q){J.setSelectSourceType(Q.getTypeCode())});I=u.getJqUi();I.addClass("source-manage-toolbar-searchtype-combobox");return I},l=function(){x=$.trim(C.getText()).toUpperCase();J.setSearchText(x)},r=function(){var I=new ha(ea.getRemoteImpl(),function(B){if(B){for(var F=[],Q=0;Q<B.length;Q++){var S=new qa;S.fromJsonObject(B[Q]);F.push(S)}J.setSourceVOs(F)}});I.setShowBlocking(!0);I.loadModelSetSources(ea.getModelSetId())}};
var ha,ea,qa,La,Z,M,y,D,d,a,k,n,q,h,m,w,t,K,ta,sa,E,O,ia,P,Da,g,ya,Ja,fa,ua,Qa,va,Ba,R,G,aa,Ra,Ma,Ea,sb,gb,ob,ab,Cb,hb=!1;(function(){var p=com.kingdee.bos.qing.modeler.modelset.source.model;qa=p.ModelSetSourceVO;La=p.ModelRefSourceVO;M=p.ModelSetDBSource;k=p.ModelSetFileSource;n=p.ExcelSource;q=p.XMLSource;h=p.TextSource;m=p.ERPCloudSource;w=p.PublicDataSource;t=p.ModelSetSource;sa=p.OpenAPISource;K=p.ModelerSourceType;ta=p.ModelSetVO;E=p.SourceType;ab=p.AuthModelFactory;p=com.kingdee.bos.qing.modeler.modelset.source.common;
ha=p.SourceManageFacade;ea=p.Integration;Z=p.Icons;a=p.SourceCardUIFactory;gb=p.UserOperationReporter;ob=p.OpenAPIAuthFactory;p=com.kingdee.bos.qing.dbmanage;y=p.DBConnectionPanelFactory;D=p.DBSourceDisplayNameFactory;d=p.DBConnection;p=com.kingdee.bos.qing.data;O=p.DBSource;ia=p.AbstractImportEntityStep;p=com.kingdee.bos.qing;ya=p.Seer;p=com.kingdee.bos.qing.common;P=p.DomUtil;Da=p.Base64Util;p=com.kingdee.bos.qing.framework.common;g=p.MultilanguageManager.createPackageAccessor(da);Cb=p.OfficialArticleUtil;
p=com.kingdee.bos.qing.ui.component;Ja=p.Dialog;G=p.List;aa=p.RadioButton;Ra=p.RadioButtonGroup;fa=p.Label;ua=p.TextField;Qa=p.MessageCurtain;va=p.SearchBox;Ba=p.ComboBox;R=p.WizardDialog;Ma=p.MessageDialog;Ea=p.AbstractModalDialog;sb=p.HelpIcon})();new function(){this.handleIconName=function(p){return"en"==com.kingdee.bos.qing.CodeLoader.Seer.getUrlParamValue("language")?p+"_EN":p}};var Bb=function(p){return function(L,A){L=L.toString();if("20"==L.substr(0,2)&&7==L.length){if("20612"==L.substr(0,
5)||"20622"==L.substr(0,5))return!1;if(2061100==L)return p.showError(g.get("error2061100","\u8bf7\u586b\u5199\u6b63\u786e\u7684url\uff0c\u5982\u679c\u662f\u6839\u8def\u5f84\uff0c\u5fc5\u987b\u4ee5.QData\u7ed3\u5c3e\u3002")),!0;if(2061103==L)return p.showError(g.get("error2061103","pageSize\u7684\u503c\u5fc5\u987b\u57282000\u81f320000\u4e4b\u95f4\u3002")),!0;if(2061104==L)return p.showError(g.get("error2061104","\u53c2\u6570\u5f02\u5e38,pageNo\uff0cselectedFields\u4e3a\u7cfb\u7edf\u53c2\u6570\u3002")),
!0;if(2062100==L)return p.showError(g.get("error2062100","\u6ca1\u6709\u5b9e\u73b0\u63a5\u53e3ITableDataProvider\u3002")),!0;if(2061301==L)return p.showError(g.get("error2061301","\u8bf7\u586b\u5199\u6b63\u786e\u7684\u8ba4\u8bc1\u4fe1\u606f\u3002")),!0;if(2061302==L)return p.showPrompt(g.get("error2061302","\u8bf7\u586b\u5199\u5b8c\u6574\u7684\u8ba4\u8bc1\u4fe1\u606f\u3002")),!0;if(2061303==L)return p.showPrompt(g.get("error2061303","\u6458\u8981\u8ba4\u8bc1\u670d\u52a1\u5668\u8d28\u8be2\u5934\u53c2\u6570\u5f02\u5e38\u3002")),
!0;p.showError(A);return!0}return!1}}})();
//qingVersionTag: 20250324