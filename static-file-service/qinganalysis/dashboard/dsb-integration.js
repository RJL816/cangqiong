var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(y,Q,O){y instanceof String&&(y=String(y));for(var R=y.length,V=0;V<R;V++){var Y=y[V];if(Q.call(O,Y,V,y))return{i:V,v:Y}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(y,Q,O){if(y==Array.prototype||y==Object.prototype)return y;y[Q]=O.value;return y};$jscomp.getGlobal=function(y){y=["object"==typeof globalThis&&globalThis,y,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var Q=0;Q<y.length;++Q){var O=y[Q];if(O&&O.Math==Math)return O}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(y,Q){var O=$jscomp.propertyToPolyfillSymbol[Q];if(null==O)return y[Q];O=y[O];return void 0!==O?O:y[Q]};
$jscomp.polyfill=function(y,Q,O,R){Q&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(y,Q,O,R):$jscomp.polyfillUnisolated(y,Q,O,R))};$jscomp.polyfillUnisolated=function(y,Q,O,R){O=$jscomp.global;y=y.split(".");for(R=0;R<y.length-1;R++){var V=y[R];if(!(V in O))return;O=O[V]}y=y[y.length-1];R=O[y];Q=Q(R);Q!=R&&null!=Q&&$jscomp.defineProperty(O,y,{configurable:!0,writable:!0,value:Q})};
$jscomp.polyfillIsolated=function(y,Q,O,R){var V=y.split(".");y=1===V.length;R=V[0];R=!y&&R in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Y=0;Y<V.length-1;Y++){var K=V[Y];if(!(K in R))return;R=R[K]}V=V[V.length-1];O=$jscomp.IS_SYMBOL_NATIVE&&"es6"===O?R[V]:null;Q=Q(O);null!=Q&&(y?$jscomp.defineProperty($jscomp.polyfills,V,{configurable:!0,writable:!0,value:Q}):Q!==O&&(void 0===$jscomp.propertyToPolyfillSymbol[V]&&(O=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[V]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(V):$jscomp.POLYFILL_PREFIX+O+"$"+V),$jscomp.defineProperty(R,$jscomp.propertyToPolyfillSymbol[V],{configurable:!0,writable:!0,value:Q})))};$jscomp.polyfill("Array.prototype.find",function(y){return y?y:function(Q,O){return $jscomp.findInternal(this,Q,O).v}},"es6","es3");
(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.dashboard&&(com.kingdee.bos.qing.dashboard={});"undefined"==typeof com.kingdee.bos.qing.dashboard.cosmiccard&&(com.kingdee.bos.qing.dashboard.cosmiccard={});var y=com.kingdee.bos.qing.dashboard.cosmiccard;y.CloudHubSubscribeCardExecutor=function(){var K;
Q.call(this);this.initUi=function(I,E){E=$("<div class='cloudhub-subscribe-card-title'>");E.css({position:"absolute",top:0,left:"20px",height:"40px","line-height":"40px"});R.brush(R.DSB_CARD_TITLE,E);E.appendTo(I);E=$("<div>");E.css({position:"absolute",left:0,right:0,top:"40px",bottom:0});var ea=$("<iframe class='cloudhub-subscribe-card'>");ea.css({width:"100%",height:"100%",border:0});ea.appendTo(E);E.appendTo(I);R.brush(R.DSB_CARD,I);R.brush(R.DSB_CARD_SURFACE,I)};this.resize=function(I,E){};this.run=
function(I,E,ea){E=E.getEncodedModel();var sa=JSON.parse(E);E=sa.pubName;ea=K+"/index.html#/dform?formId=qing_yzjsubscribe_card";ea=ea+"&pubId="+sa.pubId+"&pubName="+E;sa=$(I.find(".cloudhub-subscribe-card"));I=$(I.find(".cloudhub-subscribe-card-title"));sa.attr("src",ea);I.text(E);I.attr("title",E)};this.destroy=function(I,E){};this.setParamPathPrefix=function(I){K=I}};y.CloudHubSubscribeCardSelector=function(){this.selectCard=function(K){Y.setCallback(function(I){if(I.pubId){I.pageId=void 0;var E=
JSON.stringify(I)}K(E)});Y.openSelector()}};y.CosmicCustomCardExecutor=function(){O.call(this);var K;this.initUi=function(I,E){E=$("<iframe class='cosmic-custom-card'>");E.css({position:"absolute",border:0,left:0,top:0,width:"100%",height:"100%"});R.brush(R.DSB_CARD,E);R.brush(R.DSB_CARD_SURFACE,E);E.appendTo(I)};this.resize=function(I,E){};this.run=function(I,E,ea){E=E.getEncodedModel();E=JSON.parse(E);ea=E.formNum;$(I.find(".cosmic-custom-card")).attr("src",K+"/index.html#/dform?formId="+ea+"&outerPageId="+
E.pageId)};this.destroy=function(I,E){};this.setParamPathPrefix=function(I){K=I}};y.CosmicCustomCardSelector=function(){this.selectCustomCard=function(K){V.setCallback(function(I){if(I.formNum){I.pageId=void 0;var E=JSON.stringify(I)}K(E)});V.openSelector()}};var Q,O,R,V,Y;(function(){var K=com.kingdee.bos.qing.dsb;Q=K.AbstractCloudhubSubscribesExecutor;O=K.AbstractCosmicCustomCardExecutor;R=K.CosmeticBag;K=com.kingdee.bos.qing.integration;V=K.CustomCardHelper;Y=K.CloudHubSubscribeCardHelper})()})();(function(){function y(){oa.AbstractWizardStep.call(this);var h=this,f,l,g;this.getBaseOnExistingTheme=function(){return g};this.setBaseOnExistingTheme=function(c){g=c};this.getJqUi=function(c){f||(l=c,f=h.protectedCreateUi());return f};this.protectedCreateUi=function(){throw Error("Override me.");};this.protectedMethod={getMessageCurtain:function(){return l.getMessageCurtain()}}}function Q(){var h,f=this;this.protectedInitUi=function(){throw Error("Override me.");};this.getRatioBtn=function(){h||
(h=f.protectedInitUi());return h};this.doNext=function(l,g,c){throw Error("Override me.");};this.isSelected=function(){return h.isChecked()};this.isSelectable=function(){return!0}}function O(h){Q.call(this);this.protectedInitUi=function(){var f=new z;f.setText(e.get("baseOnExistingTheme","\u57fa\u4e8e\u4e1a\u52a1\u4e3b\u9898\u590d\u5236\u65b9\u6848\u6216\u521b\u5efa"));f.setChecked(!0);return f};this.doNext=function(f,l,g){var c=f.getDsbRemoteImpl();(new ca(c,function(a){var d=new Aa;d.fromJsonObject(a);
0==d.getChildren().length?l.showPrompt(e.get("noTheme","\u6682\u65e0\u4e1a\u52a1\u4e3b\u9898\u3002")):(a=new V,a.setSchemaType(h),f.setFolderRoot(d),a.setStepContentInfo(f),g([a]))},function(a,d){a=a.toString();return"9"==a.substr(0,1)&&6==a.length?(l.showError(e.get("failToGetTheme","\u83b7\u53d6\u4e3b\u9898\u5931\u8d25\u3002")),!0):!1})).getAllSubject()}}function R(h){Ca.call(this,h);this.protectedInitImportTypes=function(){return[new O(y.SQUARE_TYPE)]};this.protectedGetSourceTypeText=function(){return e.get("currentSquareSource",
"\u5f53\u524d\u6570\u636e\u6597\u65b9\u7684\u6570\u636e\u6765\u6e90\uff1a")};this.protectedParseSourceType=function(f,l,g){var c=f.refType;g=null;var a=$("<div>");a.addClass("dsb-ref-item-btn-path-tag");l.append(a);"subject"==c?g=e.get("subject","\u4e1a\u52a1\u4e3b\u9898\uff1a"):"card"==c&&(g=e.get("card","\u5361\u7247\uff1a"));"true"==f.isPreset&&(c=$("<div>"),c.text(e.get("preset","\u9884\u7f6e")),c.addClass("dsb-ref-item-btn-path-tag"),c.addClass("dsb-ref-item-btn-preset-tag"),l.append(c));c=$("<div>");
c.addClass("dsb-ref-item-btn-path-tag");l.append(c);(l=f.ownerName)?c.text(f.publishName+" ("+l+e.get("shareCard","\u5206\u4eab\u7684\u5361\u7247")+")"):f.widgetSourcePath?c.text(f.widgetSourcePath):c.text(e.get("noSource","\u6765\u6e90\u5df2\u88ab\u5220\u9664"));a.text(g);return g}}function V(){Y.call(this);var h=this,f=this.protectedMethod,l=1;this.setSchemaType=function(g){l=g};this.getSubTitle=function(){return e.get("selectTheme","\u9009\u62e9\u4e1a\u52a1\u4e3b\u9898")};this.getNoDataText=function(){return e.get("noThemeMessageNotice",
"\u6682\u65e0\u4e1a\u52a1\u4e3b\u9898")};this.outThisStep=function(g,c){if(g)c();else{var a=f.getSelectedModel().getSelectedNode().getId(),d=f.getStepContentInfo();g=d.getDsbRemoteImpl();g=new ca(g,function(b){if(!b)return f.getMessageCurtain().showPrompt(e.get("noModeling","\u8be5\u4e3b\u9898\u6ca1\u6709\u5bf9\u5e94\u7684\u6570\u636e\uff0c\u8bf7\u5148\u8fdb\u884c\u6570\u636e\u51c6\u5907\u3002")),!0;var p=new I;p.setIsSquare(1==l);d.setId(a);d.setSchema(b);d.setImportSourceIsPublish(!1);p.setStepContentInfo(d);
c([p])},function(b,p){b=b.toString();return"9"==b.substr(0,1)&&6==b.length?(f.getMessageCurtain().showError(e.get("failToGetSchemaContent","\u83b7\u53d6\u65b9\u6848\u51fa\u9519\u3002")),!0):!1});h.setBaseOnExistingTheme(!0);g.loadSubjectSchemaAttrs(a,l)}}}function Y(){y.call(this);var h=this,f,l,g,c,a,d,b,p=new Da,k=new Da,m,t,u,D;this.setStepContentInfo=function(r){l=r};this.getSubTitle=function(){throw Error("overwrite me!");};this.getNoDataText=function(){throw Error("overwrite me!");};this.getSearchPlaceHolder=
function(){return e.get("enterSearchTheme","\u641c\u7d22\u4e1a\u52a1\u4e3b\u9898")};this.protectedCreateUi=function(){var r=l.getFolderRoot();r=v(r);g=r[0];c=r[1];1<g.length&&(a=g,p.setSelectedNode(H(g)),m=p);1<c.length&&(a=c,k.setSelectedNode(H(c)),m=k);r=$("<div>");var F=$("<div>");F.appendTo(r);q(F);u=$("<div>");var w=$("<div>");w.addClass("import-square-second-nodata-img");da.background(w,"nodata");w.appendTo(u);D=$("<div>");D.appendTo(u);D.addClass("import-square-second-nodata-text");M.layoutCtrlWithLRTB(F,
18,0,null,0,null,23);t=$("<div>");t.addClass("import-square-second-step");f=new sa;f.setSelectedModel(m);f.createJqUi(a).appendTo(t);t.appendTo(r);M.layoutCtrlWithLRTB(t,18,18,null,33,0,null);return r};this.intoThisStep=function(r,F){};this.outThisStep=function(r,F){throw Error("overwrite me!");};var H=function(r){for(var F,w=0;w<r.length;w++)if(0==r[w].getChildren().length){F=r[w];break}return F},q=function(r){var F=$("<div>");F.addClass("import-square-second-searchBar");d=new Ba;d.setShowSearchIcon(!0);
d.setPlaceholder(h.getSearchPlaceHolder);d.setSearchListenerDelay(800);d.addSearchListener(B);var w=d.getJqUi();M.layoutCtrlWithLRTB(w,0,null,200,0,null,25);w.appendTo(F);if(0<g.length){w=!1;for(var U=0;U<g.length;U++)if(g[U].getExtRptType()){w=!0;break}w=w?[new K(e.get("myExtReport","\u6211\u7684\u62a5\u8868"),!1),new K(e.get("presetExtReport","\u9884\u7f6e\u62a5\u8868"),!0)]:[new K(e.get("myTheme","\u6211\u7684\u4e3b\u9898"),!1),new K(e.get("presetTheme","\u9884\u7f6e\u4e3b\u9898"),!0)];b=new aa;
b.setItemModels(w);b.setSelected(0<c.length?w[0]:w[1]);b.setCustomPainter(function(S,T,ia){T.text(ia.getThemeCategoryName())});b.addSelectedChangedListener(function(S,T,ia){B()});w=b.getJqUi();w.addClass("import-square-second-ComboBox");w.appendTo(r)}F.appendTo(r)},v=function(r){var F=[],w=[];if(r=r.getChildren())for(var U=0;U<r.length;U++){var S=r[U];if(0==S.getChildren().length)S.isPreset()?F.push(S):w.push(S);else{var T=v(S);0<T[0].length&&(T[0].unshift(S),F=F.concat(T[0]));0<T[1].length&&(T[1].unshift(S),
w=w.concat(T[1]))}}return[F,w]},B=function(){a=c;m=k;b&&b.getSelected().isPreset()&&(a=g,m=p);var r=d.getText();if(r){var F=a,w=new Aa,U=[],S;for(S in F)0==F[S].getSubNodeLevel()&&U.push(F[S]);w.setChildren(U);r=r.trim();a=G(w,r.toUpperCase())}t.empty();0<a.length?(f.setSelectedModel(m),r=f.createJqUi(a,r),t.append(r)):(F=h.getNoDataText(),r&&(F=e.get("noSearchMessageNotice","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),D.text(F),t.append(u))},G=function(r,F){var w=[];if(r=
r.getChildren())for(var U=0;U<r.length;U++){var S=r[U];if(0==S.getChildren().length)-1<S.getName().toUpperCase().indexOf(F)&&w.push(S);else{var T=G(S,F);0<T.length&&-1==T.indexOf(S)&&(T.unshift(S),w=w.concat(T))}}return w};this.protectedMethod.getStepContentInfo=function(){return l};this.protectedMethod.getSelectedModel=function(){return m}}function K(h,f){this.getThemeCategoryName=function(){return h};this.isPreset=function(){return f}}function I(){y.call(this);var h=this,f=this.protectedMethod,
l,g,c,a,d=!0,b,p=new E;this.setIsSquare=function(k){d=k};this.over=function(k){if(k){k=c?!1:!0;var m=a.getAllStepOverCallback();m&&m(g,l,k,c)}};this.setCustomRefrenceHandler=function(k){b=k};this.setStepContentInfo=function(k){a=k;p.setBaseOnTheme(!0);p.setStepContentInfo(k)};this.isLastStep=function(){return!0};this.getSubTitle=function(){return e.get("chooseSchema","\u9009\u62e9\u65b9\u6848")};this.protectedCreateUi=function(){var k=d?e.get("establishNewSquare","\u7a7a\u767d\u65b9\u6848"):e.get("establishNewLonger",
"\u7a7a\u767d\u65b9\u6848");return p.createJqUi(k)};this.intoThisStep=function(k,m){};this.outThisStep=function(k,m){if(k)m();else{var t=a.getSchema();if(0!=t.length||!p.isLoadingChecked()){k=a.getId();var u=a.getDsbRemoteImpl();u=new ca(u,function(D){g=D.ref;b&&b(g);c=D.model;m();Z.occur(d?Z.DSB_IMPORT_SQUARE_TYPE:Z.DSB_IMPORT_LONGER_TYPE,g.refType)},function(D,H){D=D.toString();return"9"==D.substr(0,1)&&6==D.length?(f.getMessageCurtain().showError(e.get("failToGetSchema","\u83b7\u53d6\u65b9\u6848\u5931\u8d25\u3002")),
!0):!1});h.setBaseOnExistingTheme(!0);p.isLoadingChecked()&&0<t.length?(t=p.getSelectedSchema(),l=t.getSchemaName(),t=t.getSchemaId(),u.getSubjectReferenceMap(k,t)):u.getSubjectReferenceMap(k)}}}}function E(){var h=new z,f=new z,l,g,c,a,d;this.setBaseOnTheme=function(q){d=q};this.setPublishId=function(q){a=q};this.setStepContentInfo=function(q){l=q};this.createJqUi=function(q){var v=$("<div>");h.setText(e.get("copySchema","\u590d\u5236\u65b9\u6848"));var B=h.getJqUi();f.setText(q);q=f.getJqUi();var G=
new La,r=new X;r.addElement(h);r.addElement(f);r.addChangedListener(function(){h.isChecked()?G.setEnabled(!0):G.setEnabled(!1)});r=l.getSchema();0<r.length?(G.setEnabled(!0),h.setChecked(!0),f.setChecked(!1),g=H(r),c=p(g),G.setSelectedModel(c)):(G.setEnabled(!1),h.setEnabled(!1),h.setChecked(!1),f.setChecked(!0));r=G.getJqUi();var F=new ea;F.setItemModel(g);F.setListItemPainter(k);F.setSearchListener(u);G.setDropdownCreator(function(w,U,S){return F.createJqPopup(w,U,S)});G.setCustomPainter(function(w,
U){if(w)if(d)U.text(w.getSchemaName());else{var S=l.getDsbRemoteImpl();(new ca(S,function(T){T.publishInfoPerCheck==E.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST?U.text(w.getSchemaName()):T.publishInfoPerCheck==E.PUBLISHINFO_NOEXIST?b($(document.body),"msg-warning",e.get("publishInfoExist","\u8be5\u7ec4\u4ef6\u6765\u6e90\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")):T.publishInfoPerCheck==E.PERMISSION_CANCEL?b($(document.body),"msg-jurisdiction",e.get("notAuthority","\u60a8\u6ca1\u6709\u8be5\u7ec4\u4ef6\u6765\u6e90\u7684\u67e5\u770b\u6743\u9650, \u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba")+
'"'+T.publishInfoUserName+'"'+e.get("authority","\u6388\u6743")):T.publishInfoPerCheck==E.PUBLSIHPLAN_DELETE&&b($(document.body),"msg-warning",e.get("publishPlanExist","\u8be5\u5206\u6790\u65b9\u6848\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"))})).checkPublishInfoAndPermission(a,w.toJsonObject())}});G.addSelectionListener(function(w,U){U&&(c=w.getSelectedModel())});M.layoutCtrl(B,24,0,400,23);M.layoutCtrl(r,44,29,170,23);M.layoutCtrl(q,24,58,400,23);B.appendTo(v);r.appendTo(v);q.appendTo(v);
return v};var b=function(q,v,B){q=new ha;q.setOptionType(ha.OPTION_OK);q.setButtonText(ha.RETURN_OK,e.get("ISee","\u6211\u77e5\u9053\u4e86"));var G={};G.text=B;G.iconName=v;q.setMessage(G);q.setCustomPainter(function(r,F){var w=$("<div>");w.addClass("sa-ctrl-msgdlg-icon");da.background(w,F.iconName);var U=$("<div>");U.addClass("sa-ctrl-msgdlg-content");U.text(F.text);r.append(w);r.append(U)});q.showDialog(380,280)},p=function(q){for(var v=0;v<q.length;v++)if(q[v].IsDefault())return q[v];return q[0]};
this.isLoadingChecked=function(){return h.isChecked()};this.getSelectedSchema=function(){return c};var k=function(q,v,B){var G=!1,r=!1;v.empty();for(var F=0;F<q.length;F++){var w=q[F];if(w.getSchemaType()==xa.SCHEMATYPE_SYSTEM){if(0==G){G=!0;var U=$("<div>");U.addClass("import-schema-manage-list-item-container");var S=$("<div>");S.addClass("import-schema-manage-list-nodeline-head");da.background(S,"tree-expanded_hover");S.on("click",m);S.on("mouseover",function(Ga){da.background(S,"tree-expanded")});
S.on("mouseout",function(Ga){da.background(S,"tree-expanded_hover")});var T=$("<div>");T.addClass("import-schema-manage-item-system-icon");da.background(T,"icon_system");var ia=$("<div>");ia.addClass("import-schema-manage-item-text");ia.text(e.get("systemSchema","\u7cfb\u7edf\u65b9\u6848"));var ba=$("<div>");ba.addClass("import-schema-manage-list-title-item");S.appendTo(ba);T.appendTo(ba);ia.appendTo(ba);ba.appendTo(U)}t(w,U,B)}else if(w.getSchemaType()==xa.SCHEMATYPE_USERDEFINED){if(0==r){r=!0;var ta=
$("<div>");ta.addClass("import-schema-manage-list-item-container");var ka=$("<div>");ka.addClass("import-schema-manage-list-nodeline-head");da.background(ka,"tree-expanded_hover");ka.on("click",m);ka.on("mouseover",function(Ga){da.background(ka,"tree-expanded")});ka.on("mouseout",function(Ga){da.background(ka,"tree-expanded_hover")});T=$("<div>");T.addClass("import-schema-manage-item-user-icon");da.background(T,"icon_user");ia=$("<div>");ia.addClass("import-schema-manage-item-text");ia.text(e.get("userSchema",
"\u7528\u6237\u65b9\u6848"));var ua=$("<div>");ua.addClass("import-schema-manage-list-title-item");ka.appendTo(ua);T.appendTo(ua);ia.appendTo(ua);ua.appendTo(ta)}t(w,ta,B)}}!G&&r&&l.getImportSourceIsPublish()?(ta.appendTo(v),$(".import-schema-list-item-enable").css("padding-left","21px")):G&&r?(U.appendTo(v),ta.appendTo(v),$(".import-schema-list-item-enable").css("padding-left","21px")):G&&!r?(U.appendTo(v),$(".import-schema-list-item-enable").css("padding-left","21px")):G||!r||l.getImportSourceIsPublish()||
(ua.remove(),ta.appendTo(v))},m=function(q){var v=$(q.target);v.off("mouseover");v.off("mouseout");q=v.parents(".import-schema-manage-list-title-item").siblings(".import-schema-list-item");"block"==q.css("display")?(q.css("display","none"),da.background(v,"tree-collapsed"),v.on("mouseover",function(B){da.background(v,"tree-collapsed")}),v.on("mouseout",function(B){da.background(v,"tree-collapsed_hover")})):(q.css("display","block"),da.background(v,"tree-expanded"),v.on("mouseover",function(B){da.background(v,
"tree-expanded")}),v.on("mouseout",function(B){da.background(v,"tree-expanded_hover")}))},t=function(q,v,B){var G=q.getSchemaName(),r=$("<div>");r.addClass("import-schema-list-item");r.addClass("import-schema-list-item-enable");r.data("model",q);r.attr("title",G);var F=$("<span>");F.text(G);F.attr("title",G);F.addClass("import-schema-list-item-text");r.append(F);v.append(r);B&&B.getSchemaName()==q.getSchemaName()&&B.getSchemaType()==q.getSchemaType()&&D(v,r)},u=function(q,v,B,G,r){v=v.trim().toUpperCase();
var F=[];if(v)for(var w=0;w<q.length;w++)-1<q[w].getSchemaName().toUpperCase().indexOf(v)&&F.push(q[w]);else F=q;B.children().remove();0<F.length?r(F,B,G):(q=new Ea,q.setText(e.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c")),q.setAlign(Ea.ALIGN_CENTER),q.setEnabled(!1),q=q.getJqUi(),q.addClass("import-schema-search-result"),q.appendTo(B))},D=function(q,v){var B=null;0<q.height()?(clearTimeout(B),v.addClass("import-schema-list-item_selected_enabled"),q.prop("scrollTop",v.prop("offsetTop"))):
B=setTimeout(function(){D(q,v)},0)},H=function(q){for(var v=[],B=0;B<q.length;B++){var G=new xa;G.fromJsonObject(q[B]);v.push(G)}return v}}function ea(){var h=[],f,l,g,c;this.setItemModel=function(a){h=a};this.setSearchListener=function(a){f=a};this.setListItemPainter=function(a){l=a};this.createJqPopup=function(a,d,b){g=$("<div>");g.appendTo(a);g.addClass("import-schema");c=$("<div>");a=e.get("searchName","\u641c\u7d22\u65b9\u6848\u540d\u79f0");var p=new Ba;p.setSearchListenerDelay(500);p.setPlaceholder(a);
p.addSearchListener(function(){f(h,p.getText(),c,d,l)});a=p.getJqUi();a.addClass("import-schema-search");a.appendTo(g);c.addClass("import-schema-list-owner");c.on("click",function(k){var m=$(k.currentTarget);k=$(k.target);if(k=M.upwardSearchHasClass(k,m,"import-schema-list-item"))k.addClass("import-schema-list-item_selected_enabled"),m=k.data("model"),b(m)});c.appendTo(g);a=g.find(".sa-ctrl-textfield-input");a.css("top","0px");a.css("height","100%");l(h,c,d);return[170,227]}}function sa(){function h(d){KTDefaultCellRender.call(this,
d);var b=this;this.paintCellUI=function(m,t){var u=b.getCell().getValue();u=p(u);t?(m=$(t),u.appendTo(m)):(m=$(m),u.appendTo(m))};var p=function(m){m=b.getCell().getValue();var t=$("<div>");if(m.getChildren()&&0<m.getChildren().length){var u=$("<div>");u.addClass("theme-group-node");u.text(m.getName());if(m.isPreset()){var D=$("<span>");D.text(e.get("preset","\u9884\u7f6e"));D.addClass("dsb-integration-import-longer-from-suject-preset-tag");u.append(D)}}else{D=new z;u=D.getJqUi();D.addCheckedListener(function(q,
v){v&&f.setSelectedNode(m)});if(g&&0<g.length){var H=u.find(".sa-ctrl-common-foreground_enabled");k(H,m.getName(),g)}else D.setText(m.getName());H=f.getSelectedNode();a(H,m)?D.setChecked(!0):D.setChecked(!1)}t.append(u);return t},k=function(m,t,u){if(m&&t&&u){u=u.toUpperCase();var D=t.toUpperCase(),H=D.split(u),q=u.length,v;for(v in H){var B=D.indexOf(H[v]),G=t.substr(0,H[v].length);B+=H[v].length;var r=D.length-B;D=D.substr(B,r);t=t.substr(B,r);B=$("<span>");B.text(G);B.appendTo(m);v!=H.length-1&&
1<H.length&&(B=D.indexOf(u),G=t.substr(B,q),B+=q,r=D.length-B,D=D.substr(B,r),t=t.substr(B,r),B=$("<span>"),B.text(G),B.css("color","red"),B.clone().appendTo(m))}}}}var f,l,g;this.setSelectedModel=function(d){f=d};this.getId=function(){return f.getId()};this.createJqUi=function(d,b){g=b;var p=c(d);f.setPathChangeListener(function(){p.updateUI()});p.updateUI();return $(p.getUI())};var c=function(d){var b=new KTable;l=new h(b);b.setCellRender(l);b.setSyncUIWhenModelChanged(!1);b.addColumn().setWidth(400);
for(var p=0;p<d.length;p++){var k=d[p],m=b.addRow();m.setHeight(23);m=m.getCell(0);m.setValue(k);k=k.getSubNodeLevel();k=new KTCellTreeModel(k);m.setTreeModel(k)}return b},a=function(d,b){return d&&b.getParentNode().getName()==d.getParentNode().getName()?b.getId()==d.getId()?!0:!1:!1}}function Da(){var h,f;this.setSelectedNode=function(l){h=l;f&&f()};this.setPathChangeListener=function(l){f=l};this.getSelectedNode=function(){return h};this.getId=function(){return h.getId()}}function Aa(){var h=this,
f,l,g,c=!1,a,d=[];this.setName=function(b){f=b};this.getName=function(){return f};this.setId=function(b){l=b};this.getId=function(){return l};this.setIsPreset=function(b){g=b};this.isPreset=function(){return g};this.setExtRptType=function(b){c=0==b?!0:!1};this.getExtRptType=function(){return c};this.setParentNode=function(b){a=b};this.getParentNode=function(){return a};this.setChildren=function(b){d=b};this.getChildren=function(){return d};this.getSubNodeLevel=function(){for(var b=-1,p=a;p;)b++,p=
p.getParentNode();return b};this.toJsonObject=function(){var b={};b.children=d;return b};this.fromJsonObject=function(b){h.setName(b.name);b.themeId&&h.setId(b.themeId);b.id&&h.setId(b.id);b.extRptType&&h.setExtRptType(b.extRptType);h.setIsPreset(b.isPreset);if(b=b.children)for(var p=0;p<b.length;p++){var k=b[p];if(k){var m=new Aa;m.fromJsonObject(k);m.setParentNode(h);d.push(m)}}}}function xa(){var h,f,l,g,c;this.setSchemaId=function(a){};this.getSchemaId=function(){return h};this.setSchemaName=
function(a){f=a};this.getSchemaName=function(){return f};this.setSchemaType=function(a){l=a};this.getSchemaType=function(){return l};this.setIsDefault=function(a){g=a};this.IsDefault=function(){return g};this.fromJsonObject=function(a){h=a.fId;f=a.schemaName;l=a.schemaType;g=a.isDefault;c=a.source};this.toJsonObject=function(){var a={};a.fId=h;a.schemaName=f;a.schemaType=l;a.isDefault=g;a.source=c;return a}}function Ha(h){Q.call(this);this.protectedInitUi=function(){var f=new z;h===y.EXTREPORT_TYPE?
f.setText(e.get("fromQingcenterRef","\u4ece\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939\u5f15\u7528")):f.setText(e.get("fromQingcenter","\u4ece\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939\u590d\u5236\u65b9\u6848"));return f};this.doNext=function(f,l,g){var c=f.getDsbRemoteImpl();c=new ca(c,function(a){var d=a.qingCenterGroup;a=a.publish;if(0==d.length)return l.showPrompt(e.get("noPublish","\u6682\u65e0\u53d1\u5e03\u3002")),!0;for(var b=!1,p=!0,k=0;k<a.length;k++)a[k].qingCenterMenuVO.isPreset?
b=!0:p=!1;switch(h){case y.LONGER_TYPE:k=new Ma;break;case y.EXTREPORT_TYPE:k=new com.kingdee.bos.qing.dashboard.qingreport.ImportExtreportFromQingcenterSecondStep;break;default:throw Error("do not support this type!");}for(var m=[],t=0;t<d.length;t++){var u=new com.kingdee.bos.qing.publish.model.FolderNode;u.fromJsonObject(d[t]);m.push(u)}k.showPresetFilter(b,p);k.setQingcenterPublish(a);k.setRootTreeList(m);k.setStepContentInfo(f);g([k]);k.refreshTable()},function(a,d){a=a.toString();return"9"==
a.substr(0,1)&&6==a.length?(l.showError(e.get("failToGetQingcenterCatagory","\u83b7\u53d6\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939\u5206\u7c7b\u5931\u8d25\u3002")),!0):!1});h==y.LONGER_TYPE&&c.loadQingcenterGroup();h==y.EXTREPORT_TYPE&&c.loadAnalysisCenterExtreportGroup()}}function Ca(h){y.call(this);var f=this,l=this.protectedMethod,g,c;this.setStepContentInfo=function(d){g=d;c=f.protectedInitImportTypes()};this.addExtImportType=function(d){c.push(d)};this.over=function(d){d||(d=g.getAllStepOverCallback())&&
d(null,null,!1,null)};this.getSubTitle=function(){return e.get("selectSourceType","\u9009\u62e9\u6765\u6e90")};this.protectedGetSourceTypeText=function(){throw Error("overWrite me!");};this.protectedParseSourceType=function(d,b,p){throw Error("overWrite me!");};this.protectedInitImportTypes=function(d){throw Error("Implement me!");};this.protectedCreateUi=function(){var d=$("<div>");d.css("color","#666");if(h){var b=$("<div>");b.text(f.protectedGetSourceTypeText());var p=$("<div>");M.layoutCtrl(p,
14,27,648,16);f.protectedParseSourceType(h,p,g);var k=$("<div>");M.layoutCtrl(k,null,54,648,16);k.text(e.get("editSourceType","\u91cd\u65b0\u9009\u62e9\uff1a"));var m=a();M.layoutCtrl(m,14,81,634,290);d.append(b);d.append(p);d.append(k)}else m=a();d.append(m);return d};var a=function(){for(var d=new X,b=-30,p=$("<div>"),k=!1,m=0;m<c.length;m++){var t=c[m].getRatioBtn();!k&&t.isEnabled()&&(t.setChecked(!0),k=!0);var u=t.getJqUi();d.addElement(t);b+=30;M.layoutCtrl(u,0,b,400,20);p.append(u)}return p};
this.intoThisStep=function(d,b){};this.outThisStep=function(d,b){if(!d)for(d=0;d<c.length;d++){var p=c[d];if(p.isSelected()){p.doNext(g,l.getMessageCurtain(),b);break}}}}function Na(h){Ca.call(this,h);this.protectedInitImportTypes=function(){return[new O(y.LONGER_TYPE),new Ha(y.LONGER_TYPE)]};this.protectedGetSourceTypeText=function(){return e.get("currentLongerSource","\u5f53\u524d\u6570\u636e\u5206\u6790\u7684\u6570\u636e\u6765\u6e90\uff1a")};this.protectedParseSourceType=function(f,l,g){var c=
f.refType,a=null,d=$("<div>");d.addClass("dsb-ref-item-btn-path-tag");l.append(d);"subject"==c?a=e.get("subject","\u4e1a\u52a1\u4e3b\u9898\uff1a"):c&&0==c.indexOf("appmenu")?(a=e.get("appmenu","\u5e94\u7528\u83dc\u5355\uff1a"),g.setImportSourceIsPublish(!0)):c&&0==c.indexOf("qingcenter")?(a=e.get("qingcenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939\uff1a"),g.setImportSourceIsPublish(!0)):"guimenu"==c&&(a=e.get("guimenu","\u5ba2\u6237\u7aef\u5e94\u7528\u83dc\u5355\uff1a"));null!=a?("true"==
f.isPreset&&(g=$("<div>"),g.text(e.get("preset","\u9884\u7f6e")),g.addClass("dsb-ref-item-btn-path-tag"),g.addClass("dsb-ref-item-btn-preset-tag"),l.append(g)),g=$("<div>"),g.addClass("dsb-ref-item-btn-path-tag"),l.append(g),f.widgetSourcePath?g.text(f.widgetSourcePath):g.text(e.get("noSource","\u6765\u6e90\u5df2\u88ab\u5220\u9664"))):a=e.get("unsupportedDsbRefSource","\u5f53\u524d\u7cfb\u7edf\u4e0d\u652f\u6301\u8be5\u7ec4\u4ef6\u6765\u6e90");d.text(a);return a}}function Ia(){function h(n){KTDefaultCellRender.call(this,
n);var A=this,C=this.paintCellUI;this.paintCellUI=function(J,L){A.getCurrentRowIdx();var la=A.getCurrentRow(),va=A.getCurrentColIdx();if(A.getCurrentRowIdx()<ja.getHeadRowCount()||1==va||2==va)C(J,L);else if(0==va){la=la.getUserObject();va=new z;ta.addElement(va);q.getQingCenterMenuVO().id==la.getQingCenterMenuVO().id&&(va.setChecked(!0),H=va);var pa=la.getQingCenterMenuVO().name;L=$("<div class='qingcenter-publish-item-btn-name'>");if(b)if(b&&pa){var Pa=b.toUpperCase(),wa=pa.toUpperCase(),Fa=wa.split(Pa),
Sa=Pa.length;for(ma in Fa){var fa=wa.indexOf(Fa[ma]),Ra=pa.substr(Qa,Fa[ma].length);fa+=Fa[ma].length;var Ja=wa.length-fa;wa=wa.substr(fa,Ja);pa=pa.substr(fa,Ja);fa=$("<span>");fa.text(Ra);fa.appendTo(L);if(ma!=Fa.length-1&&1<Fa.length){var Qa=wa.indexOf(Pa);Ra=pa.substr(Qa,Sa);fa=Qa+Sa;Ja=wa.length-fa;wa=wa.substr(fa,Ja);pa=pa.substr(fa,Ja);fa=$("<span>");fa.text(Ra);fa.css("color","red");fa.clone().appendTo(L)}}}else L.text(pa);else L.text(pa);va.setUserObject(la);var ma=va.getJqUi();ma.addClass("qingcenter-publish-item-btn");
ma.appendTo(J);la.getQingCenterMenuVO().isPreset&&(ma=$("<div>"),ma.text(e.get("preset","\u9884\u7f6e")),ma.addClass("qingcenter-publish-item-btn-preset-tag"),ma.appendTo(J));L.appendTo(J)}}}y.call(this);var f=com.kingdee.bos.qing.publish.common.FilterModelType,l=com.kingdee.bos.qing.publish.common.CardFilterType,g=this,c=this.protectedMethod,a,d,b="",p,k,m,t,u=[],D,H,q,v,B={},G,r,F,w=!1,U={},S={},T=[void 0,void 0],ia=[new l(e.get("myLonger","\u6211\u7684\u5206\u6790"),!1),new l(e.get("presetLonger",
"\u9884\u7f6e\u5206\u6790"),!0)],ba,ta=new X;ta.addChangedListener(function(n,A){H=n;q=H.getUserObject()?H.getUserObject():q});var ka=new P;ka.setFormatString("yyyy-MM-dd HH:mm:ss");this.isLastStep=function(){return!1};this.setRootTreeList=function(n){t=n;for(n=0;n<t.length;n++)Ta(u,t[n]);for(n=0;n<u.length;n++){var A=u[n];if(!A.getRelationId()){var C=A.setRelationId,J=u[n],L="";L=J.getCenterId1()?L+J.getCenterId1():L;L=J.getCenterId2()?L+J.getCenterId2():L;L=J.getCenterId3()?L+J.getCenterId3():L;
L=J.getCenterId4()?L+J.getCenterId4():L;C.call(A,L)}}for(n=0;n<u.length;n++)if(A=u[n],C=A.getRelationId(),C=B[C])for(J=0;J<C.length;J++){if(C[J].qingCenterMenuVO.isPreset)for(L=A,U[L.getRelationId()]=!0;L.getParentNode();)L=L.getParentNode(),U[L.getRelationId()]=!0;if(!C[J].qingCenterMenuVO.isPreset)for(L=A,S[L.getRelationId()]=!0;L.getParentNode();)L=L.getParentNode(),S[L.getRelationId()]=!0}ua()};var ua=function(){for(var n=0;n<u.length;n++)u[n].setIsShow(!1);if(w)for(n=0;n<u.length;n++)U[u[n].getRelationId()]&&
u[n].setIsShow(!0),u[n].setIsPreset(w);else for(n=0;n<u.length;n++)S[u[n].getRelationId()]&&u[n].setIsShow(!0),u[n].setIsPreset(w)};this.setStepContentInfo=function(n){a=n};this.setQingcenterPublish=function(n){D=n;if(!(B&&0<B.length)&&D&&0!=D.length)for(var A in D){n=D[A];var C=n.qingCenterMenuVO.parentId,J=B[C];J||(J=[],B[C]=J);J.push(n)}q=new ya;q.fromJsonObject(D[0])};this.refreshTable=function(){G&&ja.refresh(G)};this.getSubTitle=function(){return e.get("selectQingcenterPublish","\u9009\u62e9\u5df2\u53d1\u5e03\u9879")};
this.showPresetFilter=function(n,A){F=n;A&&ia.reverse();w=A};this.protectedCreateUi=function(){G=ja.createTable();ja.bindTableListenerForCtrl(G);var n=new h(G);n.setOutsideVisible(!1);G.setCellRender(n);G.addColumns(3);G.getColumn(0).setWidth(220);G.getColumn(1).setWidth(90);G.getColumn(2).setWidth(150);n=ja.createHeadRow(G);n.getCell(0).setValue(e.get("publishName","\u53d1\u5e03\u540d\u79f0"));n.getCell(1).setValue(e.get("publishPerson","\u53d1\u5e03\u4eba"));n.getCell(2).setValue(e.get("publishTime",
"\u53d1\u5e03\u65f6\u95f4"));var A=$(G.getUI());A.addClass("qingcenter-publish-table");n=$("<div>");var C=$("<div>");C.css({position:"absolute",height:"82%",width:"100%",top:"33px"});m=$("<div>");m.text(e.get("noSearchMessageNotice","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));M.layoutCtrlCenterAlign(m,500);m.css({height:"20px","line-height":"20px","text-align":"center","font-size":"16px",color:"#BBBBBB",top:"50%","margin-top":"98.5px"});m.appendTo(C);var J=$("<div>");da.background(J,
"nodata");M.layoutCtrlCenterAlign(J,187);J.css({"background-size":"contain",top:"50%",height:"187px","margin-top":"-113.5px"});J.appendTo(C);v=C.hide();n.append(v);n.append(A);ba=new com.kingdee.bos.qing.publish.common.TreeListMenuPanel;ba.setTreeSelectorModel(u);ba.setSelectedDirNameListener(Ya);ba.setManagerDir(!1);A=ba.getJqUi();A.css("width","100%");C=new qa;C.setHorizontalSplit(!0);C.setResizeMode(qa.RESIZE_MODE_FIRST_FIXED);C.setSplitLineWide(10);C.setFirstSize(190,-1,-1);C.setSecondSize(436,
-1,-1);C.setFirstChild(qa.createChildWrapper(A));C.setSecondChild(qa.createChildWrapper(n));n=C.getJqUi();n.addClass("import-longer-from-qingcenter");A=$("<div>");C=Ga;J=new f;J.setSearchType(ia);J.setSelectedChangedListener(C);r=J.getJqUi();r.css({top:"-4px",left:"6px"});r.appendTo(A);!F&&r.hide();p=new Ba;p.addSearchListener(Ua);p.setSearchListenerDelay(100);p.setPlaceholder(e.get("enterSearchName","\u641c\u7d22\u53d1\u5e03\u540d\u79f0"));p.setShowSearchIcon(!0);C=p.getJqUi();C.addClass("import-longer-from-qingcenter-search-box");
C.appendTo(A);C=$("<div>");C.append(A);C.append(n);return C};var Ga=function(n,A,C){w=C.getTypeId();ua();w?(T[1]=ba.getDefaultItemValue(),T[0]||(T[0]=Va()),ba.setDefaultItemValue(T[0])):(T[0]=ba.getDefaultItemValue(),T[1]||(T[1]=Va()),ba.setDefaultItemValue(T[1]));ba.loadTreeListNodeModelExposer(u);Ua()},Va=function(){for(var n=0;n<u.length;n++){var A=u[n],C=B[A.getRelationId()],J;if(J=A.getIsShow()&&C)a:{for(J=0;J<C.length;J++)if(C[J].qingCenterMenuVO.isPreset==w){J=!0;break a}J=!1}if(J)return A.getRelationId()}},
Ta=function(n,A){if(A instanceof com.kingdee.bos.qing.publish.model.FolderNode&&-1==n.indexOf(A)&&(n.push(A),A=A.getChildren()))for(var C=0;C<A.length;C++)Ta(n,A[C])},Ua=function(){b=p.getText().trim();if(0<b.length){k={};for(var n=0;n<u.length;n++){var A=u[n],C=Wa(A);k[A.getRelationId()]=C.length}ba.setSearchStatus(!0);d&&ba.setDefaultItemValue(d.getRelationId());ba.updateTreeSearchUI(u,k)}else ba.setSearchStatus(!1),d&&ba.setDefaultItemValue(d.getRelationId()),ba.setTreeSelectorModel(u),ba.initDirOperatorUi()},
Wa=function(n){n=Xa(n);if(!b)return n;var A=[];if(0<n.length)for(var C=0;C<n.length;C++){var J=n[C];-1<J.qingCenterMenuVO.name.toUpperCase().indexOf(b.toUpperCase())&&A.push(J)}return A},Ya=function(n,A){ja.clearWithoutHead(G);if(A){d=A;n=b?Wa(A):Xa(A);A=$(G.getUI());v.show();A.hide();b?m.text(e.get("noSearchMessageNotice","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):m.text(e.get("noPublishRecords","\u6682\u65e0\u8bb0\u5f55"));for(var C=0,J=0;J<n.length;J++){C++;var L=new ya;
L.fromJsonObject(n[J]);0===J&&(q=L);var la=ja.createRow(G);la.setUserObject(L);la.getCell(0).setValue(L.getQingCenterMenuVO().name);la.getCell(1).setValue(L.getPublishPersonName());L=Number(L.getQingCenterMenuVO().publishTime);la.getCell(2).setValue(ka.format(L))}0<C&&(v.hide(),A.show())}ja.refresh(G)},Xa=function(n){n=n.getRelationId();if(n=B[n]){for(var A=[],C=0;C<n.length;C++)n[C].qingCenterMenuVO.isPreset==w&&A.push(n[C]);n=A}else n=[];return n};this.intoThisStep=function(n,A){};this.outThisStep=
function(n,A){if(n)A();else{if(null==H)return c.getMessageCurtain().showPrompt(e.get("choosePublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u3002")),!0;n=H.getUserObject().getQingCenterMenuVO();g.protectedDoNext(n,a,A)}};this.protectedDoNext=function(n,A,C){throw Error("overwrite me!");};this.protectedMethod.getStepContentInfo=function(){return a}}function Ma(){Ia.call(this);var h=this.protectedMethod;this.protectedDoNext=function(f,l,g){var c=f.id;f=l.getDsbRemoteImpl();(new ca(f,function(a){if(a.noModeling)h.getMessageCurtain().showPrompt(e.get("publishOfSubjectNoModeling",
"\u8be5\u53d1\u5e03\u5bf9\u5e94\u7684\u4e3b\u9898\u6ca1\u6709\u8fdb\u884c\u6570\u636e\u51c6\u5907\uff0c\u65e0\u6cd5\u4f7f\u7528\u3002"));else if(a.noTheme)h.getMessageCurtain().showPrompt(e.get("publishOfSubjectBeDeleted","\u8be5\u53d1\u5e03\u5bf9\u5e94\u7684\u4e3b\u9898\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u4f7f\u7528\u3002"));else{var d=new Ka;d.setPublishType("qingcenter_qing");d.setPublishId(c);l.setSchema(a);l.setImportSourceIsPublish(!0);d.setStepContentInfo(l);g([d])}},function(a,d){a=
a.toString();return"9"==a.substr(0,1)&&6==a.length?(h.getMessageCurtain().showError(e.get("failToGetPublishSchemaList","\u83b7\u53d6\u53d1\u5e03\u65b9\u6848\u5217\u8868\u5931\u8d25\u3002")),!0):!1})).getPublishSchema(c)}}function Ka(){y.call(this);var h=this,f=this.protectedMethod,l,g,c,a,d,b,p;this.over=function(k){if(k){k=a?!1:!0;var m=l.getAllStepOverCallback();m&&m(g,c,k,a,d);g&&Z.occur(Z.DSB_IMPORT_LONGER_TYPE,Z.getImportType(g.refType))}};this.setPublishType=function(k){p=k};this.setPublishId=
function(k){b=k};this.isLastStep=function(){return!0};this.setStepContentInfo=function(k){l=k};this.getSubTitle=function(){return e.get("chooseSchema","\u9009\u62e9\u65b9\u6848")};this.protectedCreateUi=function(){var k=e.get("establishNewLonger","\u7a7a\u767d\u65b9\u6848");_oSchemaSelectPanel=new E;_oSchemaSelectPanel.setStepContentInfo(l);_oSchemaSelectPanel.setPublishId(b);return _oSchemaSelectPanel.createJqUi(k)};this.intoThisStep=function(k,m){};this.outThisStep=function(k,m){if(k)m();else if(0!=
l.getSchema().length||!_oSchemaSelectPanel.isLoadingChecked()){var t=function(H,q,v){H=new ha;H.setOptionType(ha.OPTION_OK);H.setButtonText(ha.RETURN_OK,e.get("ISee","\u6211\u77e5\u9053\u4e86"));var B={};B.text=v;B.iconName=q;H.setMessage(B);H.setCustomPainter(function(G,r){var F=$("<div>");F.addClass("sa-ctrl-msgdlg-icon");da.background(F,r.iconName);var w=$("<div>");w.addClass("sa-ctrl-msgdlg-content");w.text(r.text);G.append(F);G.append(w)});H.showDialog(380,280)},u=l.getDsbRemoteImpl();k=new ca(u,
function(H){g=H.ref;a=H.model;d=H.operation;h.getBaseOnExistingTheme()||(_oSchemaSelectPanel.isLoadingChecked()?(H=_oSchemaSelectPanel.getSelectedSchema())&&(new ca(u,function(q){q.publishInfoPerCheck==E.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST?m():q.publishInfoPerCheck==E.THEME_IS_DEL?t($(document.body),"msg-warning",e.get("ThemeIsDel","\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u6765\u6e90\u88ab\u5220\u9664")):q.publishInfoPerCheck==E.PUBLISHINFO_NOEXIST?t($(document.body),"msg-warning",e.get("publishInfoExist",
"\u8be5\u7ec4\u4ef6\u6765\u6e90\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")):q.publishInfoPerCheck==E.PERMISSION_CANCEL?t($(document.body),"msg-jurisdiction",e.get("notAuthority","\u60a8\u6ca1\u6709\u8be5\u7ec4\u4ef6\u6765\u6e90\u7684\u67e5\u770b\u6743\u9650, \u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba")+'"'+q.publishInfoUserName+'"'+e.get("authority","\u6388\u6743")):q.publishInfoPerCheck==E.PUBLSIHPLAN_DELETE&&t($(document.body),"msg-warning",e.get("publishPlanExist","\u8be5\u5206\u6790\u65b9\u6848\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"))})).checkPublishInfoAndPermission(b,
H.toJsonObject()):m())},function(H,q){H=H.toString();return"9"==H.substr(0,1)&&6==H.length?(f.getMessageCurtain().showError(e.get("failToGetSchema","\u83b7\u53d6\u65b9\u6848\u5931\u8d25\u3002")),!0):!1});if(_oSchemaSelectPanel.isLoadingChecked()){var D=_oSchemaSelectPanel.getSelectedSchema();sSchemaId=D.getSchemaId();c=D.getSchemaName();k.getPublishReferenceMap(b,p,sSchemaId)}else k.getPublishReferenceMap(b,p)}}}function ya(){var h,f;this.getQingCenterMenuVO=function(){return h};this.setQingCenterMenuVO=
function(l){h=l};this.setPublishPersonName=function(l){f=l};this.getPublishPersonName=function(){return f};this.fromJsonObject=function(l){h=l.qingCenterMenuVO;f=l.publishPersonName}}function na(){var h,f,l,g,c,a,d;this.setImportSourceIsPublish=function(b){d=b};this.getImportSourceIsPublish=function(){return d};this.setParamPathPrefix=function(b){a=b};this.getParamPathPrefix=function(){return a};this.setAllStepOverCallback=function(b){h=b};this.getAllStepOverCallback=function(){return h};this.setFolderRoot=
function(b){f=b};this.getFolderRoot=function(){return f};this.setId=function(b){l=b};this.getId=function(){return l};this.setSchema=function(b){g=b};this.getSchema=function(){return g};this.setDsbRemoteImpl=function(b){c=b};this.getDsbRemoteImpl=function(){return c}}function ca(h,f,l,g){N.call(this,h,f,l,g);var c=this.protectedMethod;this.loadSubjectSchemaAttrs=function(a,d){c.remote("loadSubjectSchemaAttrs",{themeId:a,source:d})};this.loadBizSchemaAttrs=function(a,d){c.remote("loadBizSchemaAttrs",
{bizTag:a,source:d})};this.getAllSubject=function(){c.remote("getAllSubject",{})};this.loadExtReportWithoutDataset=function(a){c.remote("loadExtReportWithoutDataset",{spaceId:a,requestedAppId:"qing_rpt"})};this.checkExtreportPermission=function(){c.remote("checkExtreportPermission",{})};this.getAllExtreport=function(){c.remote("getAllExtreport",{})};this.getSubjectReferenceMap=function(a,d){c.remote("getSubjectReferenceMap",{refToId:a,schemaId:d})};this.getExtreportReferenceMap=function(a){c.remote("getExtreportReferenceMap",
{refToId:a})};this.getCardReferenceMap=function(a,d){c.remote("getCardReferenceMap",{refToId:a,schemaId:d});Z.occur(Z.DSB_IMPORT_SQUARE_TYPE,Z.IMPORT_CARD)};this.getPictureReferenceMap=function(a){c.remote("getPictureReferenceMap",{refToId:a})};this.getImageSize=function(a){c.remote("getImageSize",{imageFileName:a})};this.loadQingcenterGroup=function(){c.remote("loadQingcenterGroup",{})};this.loadAnalysisCenterExtreportGroup=function(){c.remote("loadAnalysisCenterExtreportGroup",{})};this.getPublishReferenceMap=
function(a,d,b){c.remote("getPublishReferenceMap",{refToId:a,schemaId:b,publishType:d})};this.getCopyReferenceMap=function(a,d,b,p,k,m){c.remote("getCopyReferenceMap",{dsbId:a,refToId:d,refType:b,uid:p,outerRefKey:k,fileKey:m})};this.loadAnalysisCenterPublish=function(a){c.remote("loadAnalysisCenterPublish",{path:a})};this.loadAppMenuTree=function(){c.remote("loadAppMenuTree",{})};this.loadAppMenuTreeForExtreport=function(){c.remote("loadAppMenuTreeForExtreport",{})};this.loadAppmenuPublish=function(a,
d,b,p){c.remote("loadAppmenuPublish",{cloudId:a,appId:d,appMenuId:b,appMenuId2:p})};this.getPublishSchema=function(a){c.remote("getPublishSchema",{publishId:a})};this.checkPublishInfoAndPermission=function(a,d){a={publishId:a,selectModel:JSON.stringify(d)};c.remote("checkPublishInfoAndPermission",a)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing=
{});"undefined"==typeof com.kingdee.bos.qing.dashboard&&(com.kingdee.bos.qing.dashboard={});var x=com.kingdee.bos.qing.dashboard;x.WidgetSourceSelector=function(){var h,f,l,g,c;this.setDsbRemoteImpl=function(b){h=b};this.setCustomSquareImportFuncTypes=function(b){l=b};this.setCustomLongerImportFuncTypes=function(b){g=b};this.setCustomQingReportImportFuncTypes=function(b){c=b};this.getDsbRemoteImpl=function(){return h};this.setParamPathPrefix=function(b){f=b};var a=function(b,p){if(p)for(var k=0;k<
p.length;k++)b.addExtImportType(new p[k])};this.selectSquare=function(b,p){var k=new R(b),m=new na;m.setParamPathPrefix(f);m.setAllStepOverCallback(function(t,u,D,H,q){p(t,u,D,H,q)});m.setDsbRemoteImpl(h);k.setStepContentInfo(m);a(k,l);b=b?e.get("checkSquareSource","\u6570\u636e\u6597\u65b9\u6765\u6e90"):e.get("addSquare","\u6dfb\u52a0\u6570\u636e\u6597\u65b9");m=new oa;m.setTitle(b);m.setSteps([k]);m.show(680,480)};this.copySquare=function(b,p){d(b,p,!0)};this.selectLonger=function(b,p){var k=new Na(b),
m=new na;m.setParamPathPrefix(f);m.setAllStepOverCallback(function(t,u,D,H,q){p(t,u,D,H,q)});m.setDsbRemoteImpl(h);k.setStepContentInfo(m);a(k,g);b=b?e.get("checkLongerSource","\u6570\u636e\u5206\u6790\u6765\u6e90"):e.get("addLonger","\u6dfb\u52a0\u6570\u636e\u5206\u6790");m=new oa;m.setTitle(b);m.setSteps([k]);m.show(680,480)};this.copyLonger=function(b,p){d(b,p,!1)};this.selectPicture=function(b,p){if(b){var k=b.refToId;var m=b.fullPath}var t=new com.kingdee.bos.qing.imagelib.choose.ui.ChooseImagePanel(k);
t.setFunClosedCallback(function(){p(!1)});t.setFunSelected(function(u,D){u=u.getFileName();(new ca(h,function(H){H=H.ref;H.widgetSourcePath=D;p(H)},function(H,q){return!1})).getPictureReferenceMap(u)});t.selectImage(function(){t.show()},m)};this.copyPicture=function(b,p){var k=b.refToId,m=new ca(h,function(t){t=t.ref;t.fullPath=b.fullPath;t.widgetSourcePath=b.widgetSourcePath;p(t)},function(t,u){return!1});m.setShowBlocking(!1);m.getPictureReferenceMap(k)};this.selectQingReport=function(b,p){com.kingdee.bos.qing.dashboard.qingreport&&
(b=new com.kingdee.bos.qing.dashboard.qingreport.SelectQingReport(b,p),b.setParamPathPrefix(f),b.setDsbRemoteImpl(h),b.setCustomQingReportImportFuncTypes(c),b.startSelect())};this.copyQingReport=function(b,p){var k=b.refToId,m=b.refType,t=function(D){D=D.ref;D.fullPath=b.fullPath;p(D)},u=function(D,H){return!1};m==Oa.QINGREPORT?(t=new ca(h,t,u),t.setShowBlocking(!1),t.getExtreportReferenceMap(k)):(t=new ca(h,t,u),t.setShowBlocking(!1),t.getPublishReferenceMap(k,m))};var d=function(b,p,k){k=(k=(k=
W.getUrlParamValue("dsbId"))?k:W.getUrlParamValue("publishId"))?k:W.getUrlParamValue("configId");var m=b.refToId,t=b.refType,u=b.uid,D=b.outerRefKey,H=b.fileKey,q=new ca(h,function(v){v=v.ref;v.fullPath=b.fullPath;p(v)},function(v,B){return!1});q.setShowBlocking(!1);q.getCopyReferenceMap(k,m,t,u,D,H)}};x.DsbFacade=function(h,f,l,g){ca.call(this,h,f,l,g);var c=this.protectedMethod;this.saveModel=function(a,d){c.remote("saveModel",{dsbId:a,model:d});za.interestInBehavior(za.DSB_SAVE,1)};this.loadModel=
function(a){c.remote("loadModel",{dsbId:a})};this.squareLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};c.remote("squareLoadSchema",a)};this.squareSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("squareSaveSchema",a)};this.longerLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};c.remote("longerLoadSchema",a)};this.longerSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("longerSaveSchema",a)};this.tryAddResourceLock=
function(a,d){c.remote("tryAddResourceLock",{groupId:a,resourceId:d})};this.closeResourceLock=function(a,d){c.remote("closeResourceLock",{groupId:a,resourceId:d})}};x.CommonDsbDesignerFacade=ca;x.PublishDsbDesignerFacade=function(h,f,l,g){ca.call(this,h,f,l,g);var c=this.protectedMethod;this.saveModel=function(a,d){c.remote("saveModel",{publishId:a,model:d})};this.loadModel=function(a){c.remote("loadModel",{publishId:a})};this.squareLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};
c.remote("squareLoadSchema",a)};this.squareSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("squareSaveSchema",a)};this.longerLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};c.remote("longerLoadSchema",a)};this.longerSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("longerSaveSchema",a)};this.syncModelToDsbSource=function(a,d){c.remote("syncModelToDsbSource",{publishId:a,model:d})};this.syncModelToNewDsb=function(a,
d){a={dsbModel:a,model:JSON.stringify(d.toJsonObject())};c.remote("syncModelToNewDsb",a)};this.protectedListUnpresetThemeGroup=function(){c.remote("listUnpresetThemeGroup",{})};this.checkDsbIsOpened=function(a){c.remote("checkResourceLockStatus",{publishId:a})};this.checkPublishExist=function(a){c.remote("checkPublishExist",{publishId:a})}};x.EmailPushDsbDesignerFacade=function(h,f,l,g){ca.call(this,h,f,l,g);var c=this.protectedMethod;this.saveModel=function(a,d){c.remote("saveModel",{configId:a,
model:d})};this.loadModel=function(a){c.remote("loadModel",{configId:a})};this.squareLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};c.remote("squareLoadSchema",a)};this.squareSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("squareSaveSchema",a)};this.longerLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};c.remote("longerLoadSchema",a)};this.longerSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("longerSaveSchema",
a)};this.syncModelToDsbSource=function(a,d){c.remote("syncModelToDsbSource",{configId:a,model:d})};this.syncModelToNewDsb=function(a,d,b){a={configId:a,dsbModel:b,model:JSON.stringify(d.toJsonObject())};c.remote("syncModelToNewDsb",a)};this.protectedListUnpresetThemeGroup=function(){c.remote("listUnpresetThemeGroup",{})};this.checkDsbIsOpened=function(a){c.remote("checkResourceLockStatus",{configId:a})};this.checkEmailConfigsExist=function(a){c.remote("checkEmailConfigsExist",{configId:a})}};x.LappPushDsbDesignerFacade=
function(h,f,l,g){ca.call(this,h,f,l,g);var c=this.protectedMethod;this.saveModel=function(a,d){c.remote("saveModel",{configId:a,model:d})};this.loadModel=function(a){c.remote("loadModel",{configId:a})};this.squareLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};c.remote("squareLoadSchema",a)};this.squareSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("squareSaveSchema",a)};this.longerLoadSchema=function(a){a={ref:JSON.stringify(a),editSchema:"1"};
c.remote("longerLoadSchema",a)};this.longerSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("longerSaveSchema",a)};this.syncModelToDsbSource=function(a,d){c.remote("syncModelToDsbSource",{configId:a,model:d})};this.syncModelToNewDsb=function(a,d,b){a={configId:a,dsbModel:b,model:JSON.stringify(d.toJsonObject())};c.remote("syncModelToNewDsb",a)};this.protectedListUnpresetThemeGroup=function(){c.remote("listUnpresetThemeGroup",{})};this.checkDsbIsOpened=function(a){c.remote("checkResourceLockStatus",
{configId:a})};this.checkLappConfigExist=function(a){c.remote("checkLappConfigExist",{configId:a})}};x.RuntimeDsbFacade=function(h,f,l,g){N.call(this,h,f,l,g);var c=this.protectedMethod;this.loadPublishedDsb=function(a){c.remote("loadPublishedDsb",{publishId:a})};this.loadPublishedDsbWithOper=function(a){c.remote("loadPublishedDsbWithOper",{timedPush:a})};this.squareLoadSchema=function(a){a={ref:JSON.stringify(a)};c.remote("squareLoadSchema",a)};this.squareSaveSchema=function(a,d){a={ref:JSON.stringify(a),
model:JSON.stringify(d)};c.remote("squareSaveSchema",a)};this.longerLoadSchema=function(a,d){a={ref:JSON.stringify(a),timedPush:d};c.remote("longerLoadSchema",a)};this.longerSaveSchema=function(a,d){a={ref:JSON.stringify(a),model:JSON.stringify(d)};c.remote("longerSaveSchema",a)};this.squareResetAndGetPubSchema=function(a){a={ref:JSON.stringify(a)};c.remote("squareResetSchema",a)};this.longerResetAndGetPubSchema=function(a){a={ref:JSON.stringify(a)};c.remote("longerResetSchema",a)};this.getImageSize=
function(a){c.remote("getImageSize",{imageFileName:a})};this.getPublishUsername=function(a){c.remote("getPublishUsername",{publishId:a})}};x.AbstractImportStep=y;x.AbstractImportUi=Q;x.ImportSchemaThirdStep=I;x.ImportLongerThirdStep=Ka;x.CommonDsbDesignerFacade=ca;x.AbstractImportFirstStep=Ca;x.AbstractImportFromHomepageSecondStep=Y;x.ImportFromQingCenterFirstStep=Ha;x.ImportFromQingcenterSecondStep=Ia;x.AbstractImportStep=y;x.StepContentInfo=na;x.FolderNode=Aa;var W,M,P,e,N,X,z,aa,oa,ja,Ea,qa,Ba,
La,ra,ha,za;(function(){var h=com.kingdee.bos.qing;W=h.Seer;h=com.kingdee.bos.qing.common;M=h.DomUtil;P=h.DateFormater;h=com.kingdee.bos.qing.framework.common;e=h.MultilanguageManager.createPackageAccessor(x);N=h.AbstractFacade;ra=h.AbstractIcons;h=com.kingdee.bos.qing.ui.component;X=h.RadioButtonGroup;z=h.RadioButton;aa=h.ComboBox;oa=h.WizardDialog;Ea=h.Label;qa=h.SplitPane;Ba=h.SearchBox;La=h.DropdownSelector;ha=h.MessageDialog;h=com.kingdee.bos.qing.common.ui;ja=h.TableUtil;h=com.kingdee.bos.qing.behavior;
za=h.BehaviorManager})();var da=new function(){ra.call(this);var h=this.protectedMethod;this.protectedInit=function(l,g){l=com.kingdee.bos.qing.dashboard.ComboIcon;if(!l)throw Error("com.kingdee.bos.qing.dashboard.ComboIcon not found.");l.define(g,"dsb-integration-sprite");g.setStartPosition(1,1);g.setGap(1);g.setIconSize(17,17);f(0,0,"icon_search");l.define(g,"nodata");g.setIconSize(220,220);f(0,0,"nodata");l.define(g,"common");g.setGap(1);g.setStartPosition(1,1);g.setIconSize(16,16);f(0,6,"tree-collapsed_hover");
f(1,6,"tree-collapsed");f(0,7,"tree-expanded_hover");f(1,7,"tree-expanded");l.define(g,"schema-manage-sprite.png");g.setIconSize(12,11);g.setStartPosition(16,2);g.setGap(2);f(0,1,"icon_user");f(0,0,"icon_system");l.define(g,"msg");g.setStartPosition(1,1);g.setGap(1);g.setIconSize(100,80);f(1,2,"msg-warning");f(2,0,"msg-jurisdiction");l.define(g,"dsb_operate");g.setStartPosition(1,12);g.setIconSize(16,16);g.setGap(1);f(0,2,"refresh");f(0,3,"filter");f(0,4,"fullscreen");f(1,4,"quitFullscreen");f(1,
0,"others")};var f=function(l,g,c){h.registIcon(l,g,c)}};y.LONGER_TYPE=0;y.SQUARE_TYPE=1;y.EXTREPORT_TYPE=2;E.THEME_IS_DEL="Theme is Delete";E.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST="success";E.PUBLISHINFO_NOEXIST="PublishInfo Not Exist";E.PERMISSION_CANCEL="Not Permission";E.PUBLSIHPLAN_DELETE="Publish Not Exist";xa.SCHEMATYPE_USERDEFINED=1;xa.SCHEMATYPE_SYSTEM=2;var Z=new function(){var h;this.hookCollector=function(f){h=f};this.occur=function(f,l){try{l&&h&&h(f,l)}catch(g){window.console&&console.warn(g)}};
this.getImportType=function(f){if(f&&0==f.indexOf("appmenu"))return Z.IMPORT_APPMENU;if(f&&0==f.indexOf("qingcenter"))return Z.IMPORT_CENTER;if("guimenu"==f)return Z.IMPORT_GUIMENU}};Z.DSB_IMPORT_LONGER_TYPE="dsb-import-longer-type";Z.DSB_IMPORT_SQUARE_TYPE="dsb-import-square-type";Z.DSB_IMPORT_EXREPORT_TYPE="dsb-import-qingreport-type";Z.IMPORT_CARD="card";Z.IMPORT_CENTER="center";Z.IMPORT_APPMENU="appmenu";Z.IMPORT_GUIMENU="guimenu";Z.IMPORT_EXTREPORTAPP="qingreport";x.UserOperationReporter=Z;var Oa=
{CARD:"card",SUBJECT:"subject",PICTURE:"picture",QINGCENTER:"qingcenter",QINGCENTER_QING:"qingcenter_qing",QINGCENTER_RPT:"qingcenter_rpt",APPMENU:"appmenu",APPMENU_QING:"appmenu_qing",APPMENU_RPT:"appmenu_rpt",PROGRAMABLECARD:"programableCard",MAP:"map",GUIMENU:"guimenu",QINGREPORT:"qingreport"};x.RefTypeEnum=Oa})();(function(){function y(x){xa.call(this,x);var W=!1;this.getSubTitle=function(){return I.get("selectReferenceType","\u9009\u62e9\u5f15\u7528\u7c7b\u578b")};this.protectedInitImportTypes=function(){var M=new Q;M.setExtreportAppPerm(W);return[M,new Ia(Ma.EXTREPORT_TYPE)]};this.protectedGetSourceTypeText=function(){return I.get("currentQingreportSource","\u5f53\u524d\u8f7b\u62a5\u8868\u7684\u6570\u636e\u6765\u6e90\uff1a")};this.protectedParseSourceType=function(M,P,e){var N=M.refType;e=null;var X=$("<div>");
X.addClass("dsb-ref-item-btn-path-tag");P.append(X);"qingreport"==N?e=I.get("qingreportApp","\u8f7b\u62a5\u8868\u5e94\u7528\u9996\u9875\uff1a"):N&&0==N.indexOf("appmenu")?e=I.get("appmenu","\u5e94\u7528\u83dc\u5355\uff1a"):0==N.indexOf("qingcenter")?e=I.get("qingcenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939\uff1a"):"guimenu"==N&&(e=I.get("guimenu","\u5ba2\u6237\u7aef\u5e94\u7528\u83dc\u5355\uff1a"));null!=e?("true"==M.isPreset&&(N=$("<div>"),N.text(I.get("preset","\u9884\u7f6e")),N.addClass("dsb-ref-item-btn-path-tag"),
N.addClass("dsb-ref-item-btn-preset-tag"),P.append(N)),N=$("<div>"),N.addClass("dsb-ref-item-btn-path-tag"),P.append(N),M.widgetSourcePath?N.text(M.widgetSourcePath):N.text(I.get("noSource","\u6765\u6e90\u5df2\u88ab\u5220\u9664"))):e=I.get("unsupportedDsbRefSource","\u5f53\u524d\u7cfb\u7edf\u4e0d\u652f\u6301\u8be5\u7ec4\u4ef6\u6765\u6e90");X.text(e)};this.setExtreportPermission=function(M){W=M}}function Q(){Ha.call(this);var x=!1;this.protectedInitUi=function(){var W=new E;W.setEnabled(x);var M=I.get("baseOnQingreportHomePage",
"\u4ece\u8f7b\u62a5\u8868\u6a21\u677f\u5f15\u7528");x||(M+=I.get("hasNoExtreportPerm","(\u672a\u5206\u914d\u3010\u8f7b\u62a5\u8868\u3011\u5e94\u7528\u7684\u529f\u80fd\u6743\u9650)"));W.setText(M);W.setChecked(x);return W};this.setExtreportAppPerm=function(W){x=W};this.doNext=function(W,M,P){W.getDsbRemoteImpl();var e=new R,N=Y.getUrlParamValue("path"),X=Y.getUrlParamValue("qingID");e.setRemoteUrl(N+"/qing_rpt/manage.do");(new ya(e,function(z){var aa=new ca;aa.fromJsonObject(z);0==aa.getChildren().length?
M.showPrompt(I.get("noExtreport","\u6682\u65e0\u62a5\u8868\u3002")):(z=new O,W.setFolderRoot(aa),z.setStepContentInfo(W),P([z]))},function(z,aa){return!1})).loadExtReportWithoutDataset(X)}}function O(){Ca.call(this);var x=this.protectedMethod,W,M,P;this.isLastStep=function(){return!0};this.over=function(e){e&&((e=x.getStepContentInfo().getAllStepOverCallback())&&e(P,M),na.occur(na.DSB_IMPORT_EXREPORT_TYPE,na.IMPORT_EXTREPORTAPP))};this.outThisStep=function(e,N){e?N():(e=x.getSelectedModel().getSelectedNode(),
W=e.getId(),M=e.getName(),e=x.getStepContentInfo().getDsbRemoteImpl(),(new ya(e,function(X){P=X.ref;N()},function(X,z){return!1})).getExtreportReferenceMap(W))};this.getSubTitle=function(){return I.get("selectQingreport","\u9009\u62e9\u62a5\u8868")};this.getNoDataText=function(){return I.get("noQingreport","\u6682\u65e0\u62a5\u8868")};this.getSearchPlaceHolder=function(){return I.get("enterSearchQiongreport","\u641c\u7d22\u62a5\u8868\u540d\u79f0")}}function R(){sa.call(this);var x;this.getRemoteUrl=
function(){return x};this.setRemoteUrl=function(W){x=W}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.dashboard&&(com.kingdee.bos.qing.dashboard={});"undefined"==typeof com.kingdee.bos.qing.dashboard.qingreport&&(com.kingdee.bos.qing.dashboard.qingreport={});var V=com.kingdee.bos.qing.dashboard.qingreport;
V.SelectQingReport=function(x,W){var M,P,e;this.startSelect=function(){var N=new y(x),X=new Na;X.setParamPathPrefix(M);X.setAllStepOverCallback(function(z,aa){W(z,aa)});X.setDsbRemoteImpl(P);(new ya(P,function(z){N.setExtreportPermission(1==z);N.setStepContentInfo(X);if(z=e)for(var aa=0;aa<z.length;aa++)N.addExtImportType(new z[aa]);z=I.get("addQingReport","\u6dfb\u52a0\u8f7b\u62a5\u8868");x&&(z=I.get("qingReportSource","\u8f7b\u62a5\u8868\u6765\u6e90"));aa=new ea;aa.setTitle(z);aa.setSteps([N]);
aa.show(680,480)},function(z,aa){return!1})).checkExtreportPermission()};this.setParamPathPrefix=function(N){M=N};this.setDsbRemoteImpl=function(N){P=N};this.setCustomQingReportImportFuncTypes=function(N){e=N}};V.QingReportExecutor=function(){com.kingdee.bos.qing.dsb.AbstractQingReportExecutor.call(this);var x,W=!1;this.initUi=function(P,e){e=$("<iframe allowfullscreen allowTransparency='true'id= "+e.getName()+">");e.css({width:"100%",border:"0px"});e.appendTo(P)};this.run=function(P,e,N){var X=e.getCardTitle(),
z=Y.getUrlParamValue("path"),aa=Y.getUrlParamValue("pageId"),oa=Y.getUrlParamValue("dsbId"),ja=Y.getUrlParamValue("publishId"),Ea=Y.getUrlParamValue("configId"),qa=Y.getUrlParamValue("sharingTargetId"),Ba=Y.getUrlParamValue("publishTargetType"),La=!W||e.getTopPage().isMobileSkinActive(),ra=e.getReferenceCustomMap(),ha=ra.refType,za=ra.uid;if(oa)var da=oa+"/"+za;else ja?da=qa?ja+"/"+qa+"/"+za:ja+"/"+za:Ea&&(da=Ea+"/"+za);oa=W?"report-widget-mobile":"report-widget";z=K.appendParamToUrl((z?z:"/ierp")+
"/qing/extreportEntrance.do","exhibitionScene",oa);aa&&(z=K.appendParamToUrl(z,"pageId",aa));z=K.appendParamToUrl(z,"extReportName",X);z=K.appendParamToUrl(z,"skin",Y.getUrlParamValue("skin"));z=K.appendParamToUrl(z,"language",Y.getUrlParamValue("language"));z=K.appendParamToUrl(z,"access_token",Y.getUrlParamValue("access_token"));z=K.appendParamToUrl(z,"schemaBiztagId",da);z=K.appendParamToUrl(z,"extreportWidgetId",e.getName());z=K.appendParamToUrl(z,"extreportTopWidgetId",e.getName());qa&&(z=K.appendParamToUrl(z,
"sharingTargetId",qa));Ba&&(z=K.appendParamToUrl(z,"dsbPublishTargetType",Ba));W&&(aa=Y.getUrlParamValue("appType"))&&(z=K.appendParamToUrl(z,"appType",aa));ha&&0==ha.indexOf("appmenu")?(z=K.appendParamToUrl(z,"publishId",ra.refToId),z=K.appendParamToUrl(z,"publishTargetType",0)):ha&&0==ha.indexOf("qingcenter")?(z=K.appendParamToUrl(z,"publishId",ra.refToId),z=K.appendParamToUrl(z,"publishTargetType",1)):z=K.appendParamToUrl(z,"extReportId",ra.refToId);z=com.kingdee.bos.qing.integration.PageHelper.getIframeUrl(z);
var Z=P.find("#"+e.getName());Z.attr("src",z);ra=Da.dip(Da.DSB_CARD);ha=e.getTopPage().isWidgetOpacityRequired();aa=e.getParent()instanceof Aa?!0:!1;if(e.isTheAffectedTargetOfAnother())var Oa=JSON.stringify(e.getExecutableAffectedParams());X={cardName:X,isDesignTime:N,exhibitionScene:oa,iFrameId:e.getName(),isRequireDecorateCard:La,isRequireOpacity:ha,isInWidgetPanel:aa,affectedParams:Oa,styleMap:ra};Z.data("extreportWidgetInfo",X);Z.on("load",function(){M(P,Z)});X=0;N||(X=e.getRefreshTiming(),0<
X&&(clearInterval(P.data("timedRefreshTag")),e=setInterval(function(){Z[0].contentWindow.location.reload(!0)},1E3*X),P.data("timedRefreshTag",e)))};this.setMobileMode=function(P){W=P};this.resize=function(P,e){e=P.find("#"+e.getName());M(P,e)};this.setDsbRemoteImpl=function(P){x=P};this.getDsbRemoteImpl=function(){return x};this.fireEvent=function(P,e,N){e=e.find("#"+N.getName());e[0].contentWindow&&e[0].contentWindow.postMessage({extreportCardMsg:P},"*")};this.destroy=function(P,e){console.log("Destroy ExtReport: "+
e.getDisplayName());clearInterval(P.data("timedRefreshTag"))};var M=function(P,e){P=P.prop("clientHeight");e.css("height",P+"px")}};V.ImportExtreportFromQingcenterSecondStep=function(){Ka.call(this);var x=this.protectedMethod,W,M,P;this.getSubTitle=function(){return I.get("selectPublishedQingreport","\u9009\u62e9\u5df2\u53d1\u5e03\u7684\u62a5\u8868")};this.over=function(e){e&&((e=x.getStepContentInfo().getAllStepOverCallback())&&e(P,M),na.occur(na.DSB_IMPORT_EXREPORT_TYPE,na.IMPORT_CENTER))};this.isLastStep=
function(){return!0};this.protectedDoNext=function(e,N,X){W=e.id;M=e.name;e=x.getStepContentInfo().getDsbRemoteImpl();(new ya(e,function(z){P=z.ref;X()},function(z,aa){return!1})).getPublishReferenceMap(W,"qingcenter_rpt")}};var Y,K,I,E,ea,sa,Da,Aa,xa,Ha,Ca,Na,Ia,Ma,Ka,ya,na,ca;(function(){var x=com.kingdee.bos.qing;Y=x.Seer;x=com.kingdee.bos.qing.common;K=x.Util;x=com.kingdee.bos.qing.framework.common;I=x.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.dashboard);sa=x.AbstractRemoteCall;
x=com.kingdee.bos.qing.ui.component;E=x.RadioButton;ea=x.WizardDialog;x=com.kingdee.bos.qing.dsb;Da=x.CosmeticBag;x=com.kingdee.bos.qing.dsb.model;Aa=x.WidgetPanel;x=com.kingdee.bos.qing.dashboard;xa=x.AbstractImportFirstStep;Ha=x.AbstractImportUi;Ca=x.AbstractImportFromHomepageSecondStep;Na=x.StepContentInfo;Ia=x.ImportFromQingCenterFirstStep;Ma=x.AbstractImportStep;Ka=x.ImportFromQingcenterSecondStep;ya=x.CommonDsbDesignerFacade;na=x.UserOperationReporter;ca=x.FolderNode})()})();
//qingVersionTag: 20250324