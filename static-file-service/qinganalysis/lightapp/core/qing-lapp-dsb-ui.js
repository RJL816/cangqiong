(function(){function M(A,ka,la,ea){var P,fa=!1,X;this.tryAgain=function(){X()};this.getWebApiToken=function(b){y("getWebApiToken",{timeStamp:b.timeStamp,state:b.state,client_id:b.clientId,sign:b.sign})};this.getSharingById=function(b){b={sharingTargetId:b,phoneModel:com.kingdee.bos.qing.lapp.integration.EnvUtil.getOS(),screenPixel:document.documentElement.clientWidth+", "+document.documentElement.clientHeight};y("get",b)};this.getDirListIfEmptyThenCreate=function(){var b={};try{getOS&&(b={phoneModel:getOS(),
screenPixel:document.documentElement.clientWidth+", "+document.documentElement.clientHeight})}catch(p){b={}}y("getDirListIfEmptyThenCreate",b)};this.orderDirectory=function(b){b={model:JSON.stringify(b)};y("reOrder",b)};this.batchEditDirectory=function(b){b={list:JSON.stringify(b.toJsonObject())};y("edit",b)};this.saveDirectory=function(b){b={model:JSON.stringify(b.toJsonObject())};y("saveLappDirectory",b)};this.deleteDirectory=function(b){y("delete",{id:b})};this.isDirectoryExisted=function(b){y("isExisted",
{name:b})};this.getAnalysisList=function(b,p,K,Q){y("getLappAnalysisList",null!=p?{directoryId:b,size:10,page:p,name:K,modifiedTime:Q}:{directoryId:b})};this.getAnalysisIdList=function(b,p){y("getIds",{directoryId:b,name:p})};this.getMyFollow=function(){y("getFavoriteList",{})};this.getFollow=function(b){y("getFavoriteList",{type:b})};this.savaAnalysis=function(b,p,K,Q){b={model:JSON.stringify(b.toJsonObject()),eid:p,scene:K,webShare:Q};y("saveLappAnalysis",b)};this.isAnalysisNameDuplicate=function(b,
p){y("isNameDuplicate",{parentId:b,name:p})};this.moveToOtherDirectory=function(b,p){y("moveToOtherDirectory",{directoryId:b,ids:p})};this.deleteAnalysis=function(b){y("deleteById",{id:b})};this.deleteAnalyses=function(b){y("delete",{ids:b})};this.updateFavorites=function(b){y("updateFavorites",{ids:b})};this.updateFavorite=function(b,p){y("updateFavorite",{id:b,sharingTargetId:p})};this.getSchemaContent=function(b,p){y("getSchemaContent",{id:b,ticket:p})};this.getSharing=function(b){y("query",{size:10,
page:b})};this.deleteShare=function(b){y("delete",{id:b})};this.deleteShareGroup=function(b){y("delete",{id:b})};this.getAnalysis=function(b){y("get",{id:b})};this.getUserUnReadCount=function(b){y("getUserUnReadCount",{scene:b})};this.getQuerySendedList=function(b,p){y("query",{type:"SEND",modifiedTime:p,size:6,page:b})};this.getQueryReceivedList=function(b,p){y("query",{type:"RECEIVE",modifiedTime:p,size:6,page:b})};this.getQueryReceivedUnreadedList=function(){y("getList",{type:"RECEIVE"})};this.clearReceivedList=
function(){y("delete",{type:"RECEIVE"})};this.clearSendedList=function(){y("delete",{type:"SEND"})};this.setReaded=function(b){y("setReaded",{sharingTargetId:b})};this.setShowBlocking=function(b){fa=b};var ma=function(){P=$("<div>");P.addClass("lapp-common-loading-modallayer");var b=$("<div>");b.addClass("lapp-common-loading");b.css("background-image",V.Resource.getIconUrl("core","loading.gif"));b.appendTo(P);P.appendTo($(document.body))},ha=function(b,p,K,Q){b=com.kingdee.bos.qing.lapp.integration.RemoteFrameworkUtil.createRemoteUrl(A,
b,Z);p.lappUserId=W;p.lappUserType=S;p.language=aa();var N=p.customSettings;delete p.customSettings;jQuery.support.cors=!0;N=N?N:{};N.type="POST";N.dataType="json";N.url=b;N.data=p;N.success=function(ba){K(ba)};N.error=function(ba,qa){Q(ba.status,qa,ba)};$.ajax(N)},y=function(b,p){fa&&ma();X=function(){fa&&ma();setTimeout(function(){ha(b,p,ia,ca)},1E3)};ha(b,p,ia,ca)},ia=function(b){"number"==typeof b.errorCode?ca(b.errorCode,b.errorMessage):(ka(b.data),P&&P.remove(),ea&&ea())},ca=function(b,p,K){0==
b&&(p="\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\uff0c\u4e0d\u80fd\u6b63\u5e38\u8fde\u63a5\u5230\u670d\u52a1\u5668\u3002");var Q=!1;la&&(Q=la(b,p));Q||(T?T(b,p,K):(p="\u8bbf\u95ee\u670d\u52a1\u5668\u8fc7\u7a0b\u51fa\u73b0\u9519\u8bef\uff1a"+p,b&&(p+="\r\n\u9519\u8bef\u7801\uff1a"+b),b=p,p=com.kingdee.bos.qing.ui.component.MessageDialog,K=new p,K.setOptionType(p.OPTION_OK),K.setMessage(b),K.showDialog()));P&&P.remove();ea&&ea()};this.protectedMethod={remote:y,setShowBlocking:function(b){fa=b}}}"undefined"==
typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.lapp&&(com.kingdee.bos.qing.lapp={});"undefined"==typeof com.kingdee.bos.qing.lapp.framework&&(com.kingdee.bos.qing.lapp.framework={});var V=com.kingdee.bos.qing.lapp.framework;V.Facade=M;var T;M.setCustomErrorHandler=function(A){T=A};M.setToken=function(A){};var W,
S;M.setUserIdAndUserType=function(A,ka){W=A;S=ka};var Z=!1;M.setWithoutDotDo=function(A){Z=A};var aa=function(){if(null==navigator.userAgent.split("lang:")[1]||""==navigator.userAgent.split("lang:")[1])var A="zh_CN";else if(A=navigator.userAgent.split("lang:")[1].split(";")[0],"zh-CN"==A)A="zh_CN";else if("en-CN"==A||"en-US"==A)A="en";return A}})();(function(){function M(a,m,e){var f=this,c,g,d,h,n,l=a();this.getJqUi=function(){v();return c};this.hasFilters=function(){if(0==l.length)return!1;for(var q=!1,C=0;C<l.length;C++)if(l[C].isOnShow()){q=!0;break}return q};this.setClosedListener=function(q){h=q};this.hide=function(){c&&c.css("display","none");h&&h()};this.updateUi=function(){g.empty();d.empty();n=[];for(var q=!1,C=0;C<l.length;C++)if(l[C].isOnShow()){var O=l[C].getAssociatedField(),J=V.create(l[C],O);J.setTitle(O.getText());J.setToggleListener(z);
J.getJqHead().appendTo(g);q||(q=!0,H(J));n.push(J)}};var v=function(){if(!c){c=$("<div style='display: none'>");c.addClass("lapp-filter-modallayer");c.on("click",function(r){"lapp-filter-modallayer"==r.target.className&&x()});var q=$("<div>");q.addClass("lapp-filter-container");g=$("<div>");g.addClass("lapp-filter-container-left");g.appendTo(q);d=$("<div>");d.addClass("lapp-filter-container-right");d.appendTo(q);var C=new Q(t.get("cancel","\u53d6\u6d88"),"#777777","#FFFFFF",x),O=new Q(t.get("OK",
"\u786e\u5b9a"),"#FFFFFF","#2B87F3",u),J=new K;J.addButton(C);J.addButton(O);J.getJqUi().appendTo(c);q.appendTo(c)}},z=function(q){for(var C=0;C<n.length;C++)n[C].cancelSelectedHead();H(q)},H=function(q){var C=function(O){O?q.updateUi():q.showNetworkError()};d.empty();q.doSelectedHead();q.getJqContent().appendTo(d);q.getFilter().getPreparedModel()?q.updateUi():m(l,q.getFilter(),C)},u=function(){for(var q=0;q<n.length;q++)n[q].protectedValidate();e(l);f.hide()},x=function(){l=a();f.hide()}}function V(){var a=
this,m=$("<span>"),e,f,c,g,d,h,n;this.getJqContent=function(){e||(e=$("<div>"),e.addClass("lapp-filter-content"));return e};this.getJqHead=function(){f||(f=$("<div>"),f.on("click",l),f.addClass("lapp-filter-head"),m.addClass("lapp-filter-title"),m.appendTo(f),h=$("<div>"),h.addClass("lapp-filter-head-circle"),h.appendTo(f),h.hide());return f};this.setTitle=function(z){m.text(z)};this.setToggleListener=function(z){n=z};this.protectedDoUpdateUi=function(){throw Error("Override me");};this.protectedValidate=
function(){};this.getFilter=function(){return c};this.setFilter=function(z){c=z};this.setFilterField=function(z){g=z};this.getFilterField=function(z){return g};this.doSelectedHead=function(){f.addClass("lapp-filter-text-selected")};this.cancelSelectedHead=function(){f.removeClass("lapp-filter-text-selected")};this.updateUi=function(){d&&d.remove();var z=!0;if(c.getState()==ra.STATE_VALID)c.getPreparedModel()?z=!1:v(t.get("noAlternativeValues","\u6ca1\u6709\u5907\u9009\u503c"));else{var H=c.getState();
H==ra.STATE_FIELD_ERROR?v(t.get("invalidField","\u65e0\u6548\u7684\u5b57\u6bb5")):H==ra.STATE_PMODEL_UNMATCH?(H=t.get("theFieldDataTypeDoesNotMatchTheFilter","\u5b57\u6bb5\u6570\u636e\u7c7b\u578b\u4e0e\u7b5b\u9009\u5668\u4e0d\u5339\u914d"),v(H)):v("something error!")}z||a.protectedDoUpdateUi()};this.showNetworkError=function(){d&&d.remove();v(t.get("busyServer","\u670d\u52a1\u5668\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"))};var l=function(){n(a)},v=function(z){d||(d=$("<div>"),d.addClass("lapp-filtercard-nochoice"));
d.text(z);d.appendTo(e)};this.protectedMethod={promptMsg:v,setDirty:function(z){z?h.show():h.hide()}}}function T(){V.call(this);var a=this,m=this.protectedMethod,e,f,c;this.protectedDoUpdateUi=function(){e=a.getFilter().getSelectableItems();var l=a.getJqContent();l.empty();f=new y;f.setSearchListenerDelay(800);f.addSearchListener(g);var v=f.getJqUi(),z=$("<div class='lapp-filter-container-searchBar'>");v.appendTo(z);z.appendTo(l);h()&&n(l)};var g=function(){e=a.getFilter().getSelectableItems();f.getText()&&
(e=$.grep(e,function(l){var v=!1;-1<l.getDisplayText().toUpperCase().indexOf(f.getText().toUpperCase())&&(v=!0);return v}));d()},d=function(){var l=a.getJqContent(),v=l.children();1<v.length&&v[1].remove();h()&&n(l)},h=function(){return 0==e.length?(f.getText()?m.promptMsg(t.get("noMatchedSearch","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):a.getFilter().isJustShowAffected()?m.promptMsg(t.get("noOptionValue","\u6ca1\u6709\u76f8\u5173\u503c\u9009\u9879\n\u60a8\u53ef\u4ee5\u5c1d\u8bd5\u5207\u6362\u5230\u5168\u90e8\u503c")):
m.promptMsg(t.get("noAlternativeValues","\u6ca1\u6709\u5907\u9009\u503c")),!1):!0},n=function(l){c=new xa;c.setItemHeight(44);c.getJqUi().addClass("lapp-filtercard-pane");c.getJqUi().appendTo(l);c.setItemCount(a.protectedItemSize());c.setCreateItemUiFunc(a.protectedItemCreateFunction);c.repaint()};this.protectedItemSize=function(){throw Error("Override me");};this.protectedItemCreateFunction=function(l){throw Error("Override me");};this.protectedMethod.repaintWithScrollState=function(){c.keepState();
c.repaint();c.restoreState()};this.protectedMethod.visitAllItem=function(l){for(var v=c.getPaintSectionUi(),z,H=0;H<v.length;H++)z=v[H],z=z.data("userObject"),l&&l(z)};this.protectedMethod.getVisibleSelectableItem=function(){return e}}function W(){T.call(this);var a=this,m=this.protectedMethod,e=new ca;this.protectedItemSize=function(){return m.getVisibleSelectableItem().length};this.protectedItemCreateFunction=function(c){var g=a.getFilter();c=m.getVisibleSelectableItem()[c];var d=g.isValueSelected(c.getValue()),
h=c.getDisplayText(),n=g.isExclude()?"line-through":"";g=new b;g.addCheckedListener(f);g.setUserObject(c);g.setText(h);g.setChecked(d);g.setCustomStyle("text-decoration",n);e.addElement(g);c=g.getJqUi();c.addClass("lapp-filtercard-discreteitem");c.data("userObject",g);return c};var f=function(c,g){if(g){g=a.getFilter();g.addSelectedValue(c.getUserObject().getValue());m.setDirty(!0);for(var d=g.getSelectableItems(),h=0;h<d.length;h++){var n=d[h];c.getUserObject()!=n&&g.removeSelectedValue(n.getValue())}}}}
function S(){T.call(this);var a=this,m=this.protectedMethod,e;this.protectedItemSize=function(){return m.getVisibleSelectableItem().length+1};this.protectedItemCreateFunction=function(d){if(0==d)return e=new ia,e.setChecked(f()),e.setText(t.get("all","(\u5168\u9009)")),e.addCheckedListener(g),d=e.getJqUi(),d.addClass("lapp-filtercard-discreteitem"),d;var h=d-1,n=a.getFilter(),l=m.getVisibleSelectableItem();d=n.isExclude();h=l[h];l=h.getValue();n=n.isValueSelected(l);l=h.getDisplayText();var v=d?"line-through":
"";d=new ia;d.addCheckedListener(c);d.setUserObject(h);d.setText(l);d.setChecked(n);d.setCustomStyle("text-decoration",v);h=d.getJqUi();h.addClass("lapp-filtercard-discreteitem");h.data("userObject",d);return h};var f=function(){for(var d=a.getFilter(),h=m.getVisibleSelectableItem(),n=0;n<h.length;n++)if(!d.isValueSelected(h[n].getValue()))return!1;return!0},c=function(d){var h=!d.isChecked();d.setChecked(h);d=d.getUserObject().getValue();var n=a.getFilter();h?n.addSelectedValue(d):n.removeSelectedValue(d);
m.setDirty(!0);f()?e.setChecked(!0):e.setChecked(!1)},g=function(d){var h=!d.isChecked();d.setChecked(h);d=a.getFilter();for(var n=m.getVisibleSelectableItem(),l=0;l<n.length;l++)h?d.addSelectedValue(n[l].getValue()):d.removeSelectedValue(n[l].getValue());m.setDirty(!0);m.repaintWithScrollState()}}function Z(){V.call(this);var a=this,m=this.protectedMethod;this.protectedDoUpdateUi=function(){var f=a.getJqContent();f.empty();var c=new p;c.addValueChangedListener(e);c.getJqUi().appendTo(f);var g=a.getFilter(),
d=g.getPreparedModel();if(g.isJustShowAffected()){f=d.getSelectedMin();d=d.getSelectedMax();var h=Math.min(d,Math.max(f,g.getFloor()));g=Math.min(d,Math.max(f,g.getCeiling()))}else f=d.getMin(),d=d.getMax(),h=g.getFloor(),g=g.getCeiling();c.setFormatString(a.getFilterField().getNumberFormat());c.setLimited(f,d);c.setValue(h,g)};var e=function(f){f=f.getValue();a.getFilter().setValue(f[0],f[1]);m.setDirty(!0)}}function aa(){V.call(this);var a=this,m=this.protectedMethod,e,f,c,g,d,h=new function(){var u,
x,q,C;this.initUi=function(){var r=[t.get("today","\u4eca\u5929"),t.get("thisWeek","\u672c\u5468"),t.get("thisMonth","\u672c\u6708")],E=[Y.PERIOD_DAY,Y.PERIOD_WEEK,Y.PERIOD_MONTH];C=new ca;for(var B=0;B<r.length;B++){var L=new b;L.addCheckedListener(O);L.setUserObject(E[B]);L.setText(r[B]);C.addElement(L);L=L.getJqUi();L.css({position:"absolute",left:"5%",right:"5%",top:44*B});L.appendTo(u)}};this.setJqParentUi=function(r){u=r};this.setFilter=function(r){x=r};this.setClickedCallback=function(r){q=
r};this.clearAllChecked=function(r){C.clearAllChecked()};this.transformToDateRange=function(){var r=x.getRelativePeriodModel();if(r.getAnchor()||0!=r.getWhichPeriod())return null;r=r.getPeriod();a:for(var E=C.getElements(),B=0;B<E.length;B++){var L=E[B].getUserObject();if(r==L){E[B].setChecked(!0);break a}}return J(r)};var O=function(r,E){if(E){r=r.getUserObject();E=J(r);var B=x.getRelativePeriodModel();B||(B=new Y,x.setRelativePeriodModel(B));B.setAnchor(null);B.setWhichPeriod(0);B.setPeriod(r);
B.setUpToNow(!1);B.setFromNowOn(0);x.setFullValue(!1);m.setDirty(!0);q(E)}},J=function(r){if(r==Y.PERIOD_DAY){r=new Date;r.setHours(0,0,0,0);var E=new Date;E.setHours(0,0,0,0);return[r,E]}if(r==Y.PERIOD_WEEK)return E=new Date,E.setHours(0,0,0,0),r=E.getTime(),E=E.getUTCDay(),[new Date(r-864E5*E),new Date(r+864E5*(6-E))];if(r==Y.PERIOD_MONTH){var B=new Date;B.setHours(0,0,0,0);r=B.getTime();E=B.getDate();B=(new Date(B.getFullYear(),B.getMonth()+1,0)).getDate();return[new Date(r-864E5*(E-1)),new Date(r+
864E5*(B-E))]}return null}};this.protectedDoUpdateUi=function(){var u=a.getJqContent();u.empty();var x=a.getFilter();h.setJqParentUi(u);h.setFilter(x);h.setClickedCallback(n);h.initUi();f=new ba(v);u=(new N(t.get("custom","\u81ea\u5b9a\u4e49"),f.getJqUi())).getJqUi();u.css({position:"absolute",left:"5%",right:"5%",top:"132px"});u.appendTo(a.getJqContent());g=x.getFromDateMs();d=x.getToDateMs();x.getRelativePeriodModel()&&(x=h.transformToDateRange())&&(g=x[0].getTime(),d=x[1].getTime());n([g,d])};
this.protectedValidate=function(){var u=a.getFilter(),x=u.getFromDateMs(),q=u.getToDateMs();x>q&&(u.setFromDateMs(q),u.setToDateMs(x))};var n=function(u){g=u[0];d=u[1];u=l(u[0])+"~"+l(u[1]);f.setDateText(u)},l=function(u){var x=new Date(u);u=x.getFullYear();var q=x.getMonth()+1;x=x.getDate();return u+t.get("calendarYearCharacter","\u5e74")+q+t.get("calendarMonthCharacter","\u6708")+x+t.get("calendarDay","\u65e5")},v=function(){e||(e=$("<div>"),e.addClass("lapp-filter-modallayer"),e.appendTo($(document.body)),
e.on("click",function(u){"lapp-filter-modallayer"==u.target.className&&H()}),c=new qa,c.getJqUi().appendTo(e),c.setDateMs([g,d]),c.setOkListener(z),c.setCancelListener(H));375===screen.width&&812===screen.height&&e.css({height:"auto",bottom:"34px"});e.show()},z=function(u){u=u.getSelectedDateMs();if(u[0]>u[1])(new ta).show(t.get("dateRangeError","\u7ed3\u675f\u65e5\u671f\u4e0d\u80fd\u65e9\u4e8e\u5f00\u59cb\u65e5\u671f"),ta.LENGTH_SHORT);else{g=u[0];d=u[1];h.clearAllChecked();var x=a.getFilter();x.setFullValue(!1);
x.setFromDateMs(g);x.setToDateMs(d);x.setRelativePeriodModel(null);m.setDirty(!0);n(u);e&&e.remove();e=null}},H=function(u){e.remove();e=null}}function A(){var a;this.protectedMethod={createLegendUi:function(m,e){a&&a.remove();a=null;a=$("<div>");a.addClass("lapp-square-legend-bar");e||(e=new fa);e=new ea(e);e.setModel(m);e.draw(a);return a}}}function ka(){la.call(this);this.protectedProcessText=function(a){var m=new com.kingdee.bos.qing.common.NumberFormater;m.setFormatString("#,##0");for(var e=
0;e<a.length;e++){a:{var f=a[e];if("string"==typeof f)try{var c=JSON.parse(f);if("object"==typeof c&&c){var g=!0;break a}}catch(h){}g=!1}if(!g)break;var d=JSON.parse(a[e]);f=d.name+"\uff1a";d=m.format(d.value);a[e]=f+d}}}function la(){P.call(this);var a=this;this.draw=function(m,e,f,c){f=m.length;for(var g=0;g<f;g++){var d=$("<div>");d.addClass("lapp-square-legend-item");if(0===g){var h=d,n=m[0],l=m[1],v=$("<div>");v.addClass("lapp-square-legend-square");var z=$("<div>");z.css({position:"relative",
width:"100%",height:"49%","background-color":n,"border-radius":"100px 100px 0 0"});n=$("<div>");n.css({position:"relative",width:"100%",height:"49%","background-color":l,"border-radius":"0 0 100px 100px"});z.appendTo(v);n.appendTo(v);v.appendTo(h)}else h=d,l=m[g],v=$("<div>"),v.addClass("lapp-square-legend-square"),v.css({"background-color":l}),v.appendTo(h);a.protectedProcessText(e);h=d;l=e[g];v=$("<div>");v.addClass("lapp-square-legend-text");v.text(l);v.appendTo(h);d.appendTo(c)}};this.protectedProcessText=
function(m){}}function ea(a){var m,e;this.setModel=function(f){m=f};this.draw=function(f){e=f;f=[];for(var c=[],g,d=m.getItemCount(),h=0;h<d;h++){var n=m.getColor(h),l=m.getText(h);m.getCaption&&m.getCaption(h)&&(l=m.getCaption(h)+"\uff1a"+l);f.push(n);c.push(l)}d=m.getOthersItemCount();0<d&&(g=t.get("itemsAndSoOn","\u5176\u5b83#1\u9879").replace("#1",d));h=$("<div>");h.addClass("lapp-square-legend-wrap");h.appendTo(e);d=$("<div>");d.css({position:"absolute",top:0,left:0,bottom:0});d.appendTo(h);
h=$("<div>");h.addClass("lapp-square-legend-container");h.appendTo(d);a.draw(f,c,g,h)}}function P(){this.draw=function(a,m,e,f){throw Error("override me");}}function fa(){function a(m,e){var f;this.getJqUi=function(){if(!f){f=$("<div>");f.addClass("lapp-square-legend-item");var c=$("<div>");c.addClass("lapp-square-legend-square");c.css({"background-color":m});var g=$("<div>");g.addClass("lapp-square-legend-text");g.text(e);c.appendTo(f);g.appendTo(f)}return f}}P.call(this);this.draw=function(m,e,
f,c){var g=m.length;m=m.slice(0,g);e=e.slice(0,g);null!=f&&(e.push(f),m.push("rgba(0,0,0,0)"),g++);for(f=0;f<g;f++)(new a(m[f],e[f])).getJqUi().appendTo(c)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.lapp&&(com.kingdee.bos.qing.lapp={});"undefined"==typeof com.kingdee.bos.qing.lapp.ui&&(com.kingdee.bos.qing.lapp.ui=
{});var X=com.kingdee.bos.qing.lapp.ui;X.AbstractDiscreteColorRender=P;X.LappFilter=M;X.LappLongerLegendRender=function(){A.call(this);var a=this.protectedMethod;this.createLegendUi=function(m){return a.createLegendUi(m,null)}};X.LappSquareLegendRender=function(){A.call(this);var a=this,m=this.protectedMethod;this.createLegendUi=function(e,f){if(f instanceof ya)return m.createLegendUi(f,a.getDiscreteColorRender(e))};this.getDiscreteColorRender=function(e){var f=com.kingdee.bos.qing.square.model.SquareModel;
switch(e){case f.ChartType_ProgressCircle:return new ka;case f.ChartType_ProgressBar:case f.ChartType_ProgressColumn:return new la;default:return null}}};var ma,ha,y,ia,ca,b,p,K,Q,N,ba,qa,xa,za,ja,ta,na,t,ya,G,ua,da,Y,ra,Aa,Ba,Ca,sa;(function(){var a=com.kingdee.bos.qing.lapp.component;ma=a.HeadBar;ha=a.SecondaryMenuBar;y=a.SearchBox;ia=a.CheckBar;ca=a.RadioBarGroup;b=a.RadioBar;p=a.RegionSlider;K=a.BottomBar;Q=a.BottomButton;N=a.DateSelectBar;ba=a.DateSelectBox;qa=a.DateRangeTabSelector;xa=a.DynamicScroller;
za=a.InfoDialog;ja=a.Icons;ta=a.Toast;a=com.kingdee.bos.qing.lapp.framework;na=a.Facade;a=com.kingdee.bos.qing.framework.common;t=a.MultilanguageManager.createPackageAccessor(X);a=com.kingdee.bos.qing.chart.model;ya=a.DiscreteColorLegendModel;a=com.kingdee.bos.qing.lapp.integration;G=a.EnvUtil;ua=a.PostMessageUtils;RemoteFrameworkUtil=a.RemoteFrameworkUtil;a=com.kingdee.bos.qing.common;da=a.Util;Y=a.RelativePeriodModel;a=com.kingdee.bos.qing.core.model;ra=a.AbstractFilter;Aa=a.DiscreteFilter;Ba=a.ContinuousFilter;
Ca=a.ContinuousDateFilter;a=com.kingdee.bos.qing;sa=a.Seer})();X.AbstractLappUi=function(){var a=this,m,e,f,c,g=G.getPortrait(),d,h,n,l,v,z,H,u,x,q,C,O,J=!0,r=!0,E,B,L="";this.createHeadBar=function(){c=new ma;c.setTitle("");c.setHamburgerMode();c.setBackListener(a.doBack);history.pushState&&window.addEventListener("popstate",function(){a.doBack()});("Android"!=G.getOS()||G.isImmediateExecutionMode())&&history.pushState(null,null,null);c.setHeadBarResizeListener(function(k){oa(k)});Da(function(){c.setTitle(l.getName());
L&&c.setDescription(L);Ea()});c.getJqUi().appendTo($(document.body));return c};this.setDescription=function(k){L=k};this.setFunGetPublishedDataSourceInfo=function(k){u=k};this.isDashboard=function(){};var Ia=function(){var k=(new com.kingdee.bos.qing.lapp.scene.SceneCommonUtil).getUrlParam("sharingTargetId"),w=window.FooterBar;if(w)w.setToken(com.kingdee.bos.qing.lapp.integration.TOKEN),w.setSharingTargetId(k),w.setUserInfo(Fa,q);else{var D=document.createElement("script");D.src=RemoteFrameworkUtil.createResourceUrl("share/qing-share-exhibition-foot.js");
D.onload=function(){w=window.FooterBar;w.setToken(com.kingdee.bos.qing.lapp.integration.TOKEN);w.setSharingTargetId(k);w.setUserInfo(Fa,q)};document.head.appendChild(D)}},Fa=function(){f=window.FooterBar.getJqUi(e);f.appendTo(e)};this.createSecondaryMenuBar=function(){Da(function(){document.title=l.getName();c=new ha;Ea();c.getJqUi().appendTo($(document.body))})};this.doBack=function(){a.protectedDoBack(v)};this.getJqContent=function(){m||(e=$("<div>"),e.addClass("lapp-modallayer"),e.appendTo($(document.body)),
(G.isImmediateExecutionMode()&&!G.isPageAfterRefresh()||G.isPreviewMode())&&e.css("top","0"),m=$("<div>"),m.addClass("lapp-content"),m.appendTo(e),375===screen.width&&812===screen.height&&e.css("bottom","34px"),a.protectedAdaptContent(m));return m};this.protectedDoBack=function(k){throw Error("Override me.");};this.protectedAdaptContent=function(k){};this.setUnloadListener=function(k){v=k};this.setContextGetter=function(k){z=k};this.setRepaintNeedListener=function(k){H=k};this.createFilterCards=function(k,
w,D){C=new M(k,w,D);C.hasFilters()||(J=!1,O&&O.getJqUi().hide())};this.hideHeadBar=function(){oa(0);c&&c.getJqUi().hide()};this.keepPortrait=function(k){g?k():(pa(),setTimeout(k,500))};this.loadHeadBar=function(k){var w=c?!0:!1;w||a.createHeadBar();k(l.getId(),x,q,function(D){l=D;n=l.isFavorite();Ga();va(E,B);w&&(c.getJqUi().show(),c.isMenuShowed()&&c.toggleMenu(),!G.isDingDingOffline()&&l.isLandscape()&&pa())})};this.getJqModalLayer=function(){return e};var oa=function(k){e&&e.css("top",k);H(k)},
Ja=function(k){c instanceof ha&&!c.isHasButtonInMenu()&&setTimeout(function(){oa(k);0==k?c.hide():c.show()},30)},Ea=function(){l&&"-1"!=l.getParentId()&&(l.isFavorite()?(h=c.addButtonInMenu("icon_followed",t.get("followed","\u5df2\u5173\u6ce8"),Ha),n=!0):(h=c.addButtonInMenu("icon_follow",t.get("follow","\u5173\u6ce8"),Ha),n=!1));G.supportShare()&&c.addButtonInMenu("icon_share",t.get("share","\u5206\u4eab"),Ka);c.addButtonInMenu("icon_about",t.get("about","\u4fe1\u606f"),La);c.addButtonInMenu("icon_refresh",
t.get("refresh","\u5237\u65b0"),function(){var k=l.getUrl();k=k+"&analysisId="+sa.getUrlParamValue("analysisId")+"&refresh=true&portrait="+g;var w=sa.getUrlParamValue("time"),D=sa.getUrlParamValue("appType");w&&(k=k+"&time="+w);D&&(k=k+"&appType="+D);"iOS"!=G.getOS()||G.isImmediateExecutionMode()||history.go(-1);G.isImmediateExecutionMode()?location.href=k:location.replace(k)});a.isDashboard()||(G.supportSwitchScreen()&&(d=g?c.addButtonInMenu("icon_turn_horizontal",t.get("horizontalScreen","\u6a2a\u5c4f"),
function(){pa()}):c.addButtonInMenu("icon_turn_vertical",t.get("verticalScreen","\u7ad6\u5c4f"),function(){pa()}),Ma(),!G.isDingDingOffline()&&l.isLandscape()&&pa()),!O&&J&&(O=c.addButtonInMenu("icon_filter",t.get("filter","\u8fc7\u6ee4"),Na)));Ja(0)},Da=function(k){z(function(w,D,F,R,I){l=w;x=D;q=F;k();va(E,B);a.isDashboard()||oa(e.css("top"))})},va=function(k,w){E=k;B=w;var D=10,F=10;w&&(D+=42);G.isNeedShowCommentUi()&&(Ia(),D+=48,F+=48);m&&m.css("bottom",D+"px");k&&k.css("bottom",F+"px")},Ma=function(){window.addEventListener("orientationchange",
function(){g=!g;d&&(g?(375===screen.width&&812===screen.height&&(document.body.style.height=document.documentElement.clientHeight-44+"px",$(document.body).css("margin-top","44px"),e.css("bottom","78px"),r||($(document.body).css("margin-top","0"),e.css("bottom","34px"),r=!0)),ja.background(d.getJqIcon(),"icon_turn_horizontal"),d.getJqText().text(t.get("horizontalScreen","\u6a2a\u5c4f"))):(ja.background(d.getJqIcon(),"icon_turn_vertical"),d.getJqText().text(t.get("verticalScreen","\u7ad6\u5c4f")),$(document.body).css("margin-top",
"0"),375===screen.width&&812===screen.height&&(e.css("bottom","34px"),r=!0)));var k=88;c.isMenuShowed&&!c.isMenuShowed()&&(k=44);oa(k);c.getJqUi().appendTo($(document.body))})},pa=function(){G.rotateUI(g,l.getUrl())},Ha=function(){var k=da.decodeParamFromUrl(location.search,"sharingTargetId");na.setToken(com.kingdee.bos.qing.lapp.integration.TOKEN);na.setUserIdAndUserType(x,q);na.setWithoutDotDo(!0);(new na("lappAnalysisMgr",function(){n=!n;Ga()},function(){})).updateFavorite(l.getId(),k)},Ga=function(){n?
(ja.background(h.getJqIcon(),"icon_followed"),h.getJqText().text(t.get("followed","\u5df2\u5173\u6ce8"))):(ja.background(h.getJqIcon(),"icon_follow"),h.getJqText().text(t.get("follow","\u5173\u6ce8")))},La=function(){var k=function(w){if(w){var D=a.isDashboard()?t.get("dsbInfo","\u4eea\u8868\u677f\u4fe1\u606f"):t.get("cardInfo","\u6570\u636e\u5361\u7247\u4fe1\u606f"),F=new za;F.setTitle(D);F.setBottomText(t.get("close","\u5173\u95ed"));F.setHeight(200);F.setContentCreator(function(){var R=$("<div>");
R.css("overflow","auto");var I=$("<div>"),wa=30,U=$("<p class=lapp-about-content>");-1!=l.getParentId()&&(U.text(t.get("publishTime","\u53d1\u5e03\u65f6\u95f4\uff1a")+w.getPublishTime()),U.appendTo(I),wa-=15);U=$("<p class=lapp-about-content>");U.text(t.get("publisher","\u53d1\u5e03\u4eba\uff1a")+w.getPublisher());U.appendTo(I);a.isDashboard()||(U=$("<p class=lapp-about-content>"),U.text(t.get("extractDataTime","\u6570\u636e\u66f4\u65b0\u65f6\u95f4\uff1a")+w.getExtractDataTime()),U.appendTo(I),wa-=
15);U=$("<p class=lapp-about-content>");U.text(t.get("loginOrg","\u5f53\u524d\u767b\u5f55\u7ec4\u7ec7\uff1a")+w.getLoginOrgName());U.appendTo(I);l.getUrl()&&-1!=l.getParentId()&&Oa("<p class=lapp-about-content>",l).appendTo(I);I.css("margin-top",wa+"px");I.appendTo(R);return R});F.showDialog()}};u&&u(k,l.getPublishId(),da.decodeParamFromUrl(location.search,"tag"));!u&&k()},Oa=function(k,w){var D=$(k),F=w.getUrl();F=da.appendParamToUrl(F,"analysisId",w.getId());!G.isYzj()&&(F=da.appendParamToUrl(F,
"appType",G.getAppType()));D.text(t.get("dataUrl","\u6570\u636e\u5185\u5bb9\u94fe\u63a5 "));k=$("<span>");k.addClass("lapp-info-data-url-content-copyicon");ja.background(k,"icon_copy");k.on("click",function(R){R=Pa(F);var I=$("<span>");I.addClass("lapp-info-data-url-content-copyicon-end");D.append(I);R?I.text(t.get("copySuccess","\u590d\u5236\u6210\u529f")):I.text(t.get("copyFail","\u590d\u5236\u5931\u8d25"));setTimeout(function(){I.remove()},2E3)});k.appendTo(D);return D},Pa=function(k){var w=document.createElement("textarea");
document.body.appendChild(w);w.value=k;w.select();k=document.execCommand("copy");document.body.removeChild(w);return k},Ka=function(){if(G.isImmediateExecutionMode())ua.postMessageWhenImmediateExecution(ua.TYPE_CARD_FULLSCREEN_SHARE,function(F){var R=window.location.href,I=da.decodeParamFromUrl(R,"publishId");R=da.decodeParamFromUrl(R,"time");F.iframeId=I+R;F.analysisId=l.getId();F.lappUserId=x;F.lappUserType=q});else{var k=window.ShareOuter,w=l.getId();if(k)k.setIsNewShare(!0),k.doShare(w,x,q);else{var D=
document.createElement("script");D.src=RemoteFrameworkUtil.createResourceUrl("share/qing-share-outer.js");D.onload=function(){k=window.ShareOuter;k.setIsNewShare(!0);k.doShare(w,x,q)};document.head.appendChild(D)}}375===screen.width&&812===screen.height&&(r&&(e.css("bottom","34px"),$(document.body).css("margin-top","0")),r=!1)},Na=function(){var k=C.getJqUi();"none"==k.css("display")?(C.updateUi(),k.css("display",""),k.appendTo(e)):C.hide()};this.protectedMethod={createCommentUi:va}};V.create=function(a,
m){if(a instanceof Aa)var e=a.isSingleValueMode()?new W:new S;else if(a instanceof Ba)e=new Z;else if(a instanceof Ca)e=new aa;else throw Error("Modify here.");e.setFilterField(m);e.setFilter(a);return e}})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.lapp&&(com.kingdee.bos.qing.lapp={});"undefined"==typeof com.kingdee.bos.qing.lapp.ui&&(com.kingdee.bos.qing.lapp.ui={});var M=com.kingdee.bos.qing.lapp.ui,V=M.AbstractLappUi;var T=com.kingdee.bos.qing.lapp.integration.EnvUtil;M.LappIntegration=
new function(){var W=[],S=[],Z=!1,aa;this.addPopStateListener=function(A){W.push(A)};this.popPopStateListener=function(){return W.pop()};this.addScrollListener=function(A){S.push(A)};this.setCardFullscreen=function(A){Z=A};this.isCardFullscreen=function(){return Z};this.setResizeListener=function(A){aa=A};this.fireResizeListener=function(){aa&&aa()};$(document.body).on("touchmove scroll",function(){for(var A=0;A<S.length;A++)S[A]()})};M.LappUi=function(){V.call(this);this.protectedDoBack=function(W){var S=
M.LappIntegration.popPopStateListener();if(S)T.isDingDingOffline()&&T.hideNavTitle(),S(),history.pushState(null,null,null);else if(W)W(function(){T.closeWebView();return!0});else return T.closeWebView(),!0};this.isDashboard=function(){return!0}}})();
//qingVersionTag: 20250324