var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(oa,ka,va){oa instanceof String&&(oa=String(oa));for(var Ja=oa.length,La=0;La<Ja;La++){var Xa=oa[La];if(ka.call(va,Xa,La,oa))return{i:La,v:Xa}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(oa,ka,va){if(oa==Array.prototype||oa==Object.prototype)return oa;oa[ka]=va.value;return oa};$jscomp.getGlobal=function(oa){oa=["object"==typeof globalThis&&globalThis,oa,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var ka=0;ka<oa.length;++ka){var va=oa[ka];if(va&&va.Math==Math)return va}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(oa,ka){var va=$jscomp.propertyToPolyfillSymbol[ka];if(null==va)return oa[ka];va=oa[va];return void 0!==va?va:oa[ka]};
$jscomp.polyfill=function(oa,ka,va,Ja){ka&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(oa,ka,va,Ja):$jscomp.polyfillUnisolated(oa,ka,va,Ja))};$jscomp.polyfillUnisolated=function(oa,ka,va,Ja){va=$jscomp.global;oa=oa.split(".");for(Ja=0;Ja<oa.length-1;Ja++){var La=oa[Ja];if(!(La in va))return;va=va[La]}oa=oa[oa.length-1];Ja=va[oa];ka=ka(Ja);ka!=Ja&&null!=ka&&$jscomp.defineProperty(va,oa,{configurable:!0,writable:!0,value:ka})};
$jscomp.polyfillIsolated=function(oa,ka,va,Ja){var La=oa.split(".");oa=1===La.length;Ja=La[0];Ja=!oa&&Ja in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Xa=0;Xa<La.length-1;Xa++){var lb=La[Xa];if(!(lb in Ja))return;Ja=Ja[lb]}La=La[La.length-1];va=$jscomp.IS_SYMBOL_NATIVE&&"es6"===va?Ja[La]:null;ka=ka(va);null!=ka&&(oa?$jscomp.defineProperty($jscomp.polyfills,La,{configurable:!0,writable:!0,value:ka}):ka!==va&&(void 0===$jscomp.propertyToPolyfillSymbol[La]&&(va=1E9*Math.random()>>>0,
$jscomp.propertyToPolyfillSymbol[La]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(La):$jscomp.POLYFILL_PREFIX+va+"$"+La),$jscomp.defineProperty(Ja,$jscomp.propertyToPolyfillSymbol[La],{configurable:!0,writable:!0,value:ka})))};$jscomp.polyfill("Array.prototype.find",function(oa){return oa?oa:function(ka,va){return $jscomp.findInternal(this,ka,va).v}},"es6","es3");$jscomp.owns=function(oa,ka){return Object.prototype.hasOwnProperty.call(oa,ka)};
$jscomp.polyfill("Object.values",function(oa){return oa?oa:function(ka){var va=[],Ja;for(Ja in ka)$jscomp.owns(ka,Ja)&&va.push(ka[Ja]);return va}},"es8","es3");$jscomp.arrayIteratorImpl=function(oa){var ka=0;return function(){return ka<oa.length?{done:!1,value:oa[ka++]}:{done:!0}}};$jscomp.arrayIterator=function(oa){return{next:$jscomp.arrayIteratorImpl(oa)}};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(oa){if(oa)return oa;var ka=function(Xa,lb){this.$jscomp$symbol$id_=Xa;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:lb})};ka.prototype.toString=function(){return this.$jscomp$symbol$id_};var va="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",Ja=0,La=function(Xa){if(this instanceof La)throw new TypeError("Symbol is not a constructor");return new ka(va+(Xa||"")+"_"+Ja++,Xa)};return La},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(oa){if(oa)return oa;oa=Symbol("Symbol.iterator");for(var ka="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),va=0;va<ka.length;va++){var Ja=$jscomp.global[ka[va]];"function"===typeof Ja&&"function"!=typeof Ja.prototype[oa]&&$jscomp.defineProperty(Ja.prototype,oa,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return oa},
"es6","es3");$jscomp.iteratorPrototype=function(oa){oa={next:oa};oa[Symbol.iterator]=function(){return this};return oa};$jscomp.iteratorFromArray=function(oa,ka){oa instanceof String&&(oa+="");var va=0,Ja=!1,La={next:function(){if(!Ja&&va<oa.length){var Xa=va++;return{value:ka(Xa,oa[Xa]),done:!1}}Ja=!0;return{done:!0,value:void 0}}};La[Symbol.iterator]=function(){return La};return La};
$jscomp.polyfill("Array.prototype.keys",function(oa){return oa?oa:function(){return $jscomp.iteratorFromArray(this,function(ka){return ka})}},"es6","es3");
(function(){function oa(d){this.call=function(u,g,h,e,a){u=Gb.createRemoteUrl(d,g,!0);h.lappUserId=fa?fa.getLappUserId():"";h.lappUserType=fa?fa.getLappUserType():"";h.datacenterUUID=fa?fa.getDatacenterUUID():"";g=Hb.getUrlParamValue("language");h.language=g;g=h.customSettings;delete h.customSettings;jQuery.support.cors=!0;g=g?g:{};g.type="POST";g.dataType="json";g.url=u;mb.isIEBrowser()&&(g.url=u.replace("https:",window.location.protocol));g.data=h;g.success=function(f){e(f)};g.error=function(f,
l,r){a(f.status,l,f)};$.ajax(g)}}function ka(d,u,g,h){Zb.call(this,new oa(d),u,g,h);var e=this.protectedMethod;this.uploadBase64Image=function(a){tb.uploadBase64Image(d,u,g,h,a)};this.getOwnDirList=function(a,f){e.remote("getDirListIfEmptyThenCreate",{isQingAdminRole:a,qingAdminRoleUserId:f})};this.isAnalysisNameDuplicate=function(a,f){e.remote("isNameDuplicate",{parentId:a,name:f})};this.saveAnalysis=function(a,f,l,r,D){a={model:JSON.stringify(a.toJsonObject()),eid:f,scene:l,webShare:r,overWrite:D};
e.remote("saveLappAnalysis",a)};this.deleteAnalysis=function(a){e.remote("deleteById",{id:a})};this.getAnalysisList=function(a,f){e.remote("getLappAnalysisList",{directoryId:a,showAll:f})};this.getAnalysisListOnCondition=function(a,f,l,r,D,C,w){e.remote("getLappAnalysisListOnCondition",{directoryId:a,searchText:f,currentType:l,targetPage:r,pageSize:D,sortField:C,sortOrder:w})};this.addSharing=function(a){a={model:JSON.stringify(a.toJsonObject()),webShare:!0};e.remote("add",a)};this.saveGroup=function(a){a=
{model:JSON.stringify(a.toJsonObject())};e.remote("saveLappDirectory",a)};this.deleteGroup=function(a){e.remote("delete",{id:a})};this.deleteByPublishIds=function(a){e.remote("deleteByPublishIds",{publishIds:a})};this.syncDatacenterInfo=function(a,f){a={datacenterInfo:JSON.stringify(a),publishIds:JSON.stringify(f)};e.remote("syncDatacenterInfo",a)};this.getDatacenterInfo=function(a){e.remote("getDatacenterInfo",{datacenterUUID:a})};this.updateDatacenterInfo=function(a){a={datacenterInfo:JSON.stringify(a.toJsonObject())};
e.remote("updateDatacenterInfo",a)};this.getLogicDeletedPublishIds=function(){e.remote("getLogicDeletedPublishIds",{})};this.getAnalysisInfo=function(a,f){e.remote("getAnalysisInfo",{directoryId:a,name:f})};this.batchUpdatePublishInfo=function(a){a={publishInfos:JSON.stringify(a)};e.remote("batchUpdatePublishInfo",a)};this.getAllPublishIds=function(){e.remote("getAllPublishIds",{})};this.isExistedThirdpartyInfo=function(a,f,l){e.remote("isExistedThirdpartyInfo",{appId:a,licenseCode:f,timestamp:l,
qingLoginType:"ENCRYPT_LOGIN"})};this.loadByUserAndPublishIds=function(a,f){a={publishIds:JSON.stringify(a),lappUsers:JSON.stringify(f)};e.remote("loadByUserAndPublishIds",a)};this.handover=function(a,f,l){a={publishIds:JSON.stringify(a),fromLappUsers:JSON.stringify(f),toLappUsers:JSON.stringify(l)};e.remote("handover",a)};this.getAnalysisInfoById=function(a){e.remote("get",{id:a})};this.getAllUserDirList=function(a){e.remote("getAllUserDirList",{needGroup:a})};this.getAnalysisInfosByDirIds=function(a,
f,l,r,D){a={directoryIds:JSON.stringify(a),searchText:f,filterType:l,iTargetPage:r,iPageSize:D};e.remote("getAnalysisInfosByDirIds",a)};this.getPublishCountAggPath=function(a,f){e.remote("getPublishCountAggPath",{searchText:a,filterType:f})};this.getAnalysisInfosByPublishIds=function(a){a={publishIds:JSON.stringify(a)};e.remote("getAnalysisInfosByPublishIds",a)}}function va(d,u,g,h){$b.call(this,d,u,g,h);var e=this.protectedMethod;this.getLappContext=function(a){e.remote("getLappContext",{publishTargetType:ya.MOBILE,
appType:a?com.kingdee.bos.qing.lapp.integration.AppType.YZJ:""})};this.getShareContext=function(){e.remote("getShareContext",{publishTargetType:ya.MOBILE})};this.getLappContextsByIds=function(a,f){a={publishTargetType:ya.MOBILE,userIds:JSON.stringify(a),appType:f};e.remote("getLappContextsByIds",a)};this.loadPublishInfo=function(a){e.remote("loadPublishInfo",{publishTargetType:ya.MOBILE,publishId:a})};this.loadPublishInfoByPublishIdArr=function(a){e.remote("loadPublishInfoByPublishIdArr",{publishTargetType:ya.MOBILE,
publishIdArr:a})};this.loadAllPublishInfosByPagination=function(a,f,l){e.remote("loadAllPublishInfosByPagination",{publishTargetType:ya.MOBILE,publishIdArr:a,sortField:f,sortOrder:l})};this.saveThumbnailInfo=function(a,f){a={publishTargetType:ya.MOBILE,thumbnailInfo:JSON.stringify(a.toJsonObject()),overWrite:f};e.remote("saveThumbnailInfo",a)};this.updateThumbnailInfo=function(a,f){a={publishTargetType:ya.MOBILE,publishName:f,thumbnailInfo:JSON.stringify(a.toJsonObject())};e.remote("updateThumbnailInfo",
a)};this.getThumbnailInfo=function(a){e.remote("getThumbnailInfo",{publishTargetType:ya.MOBILE,publishId:a})};this.exportSquareImg=function(a,f,l){a={publishTargetType:ya.MOBILE,modelWrapper:JSON.stringify(a),width:f,height:l};e.remote("exportSquareImg",a)};this.getExportedImgUrl=function(a,f){return fb.getLoadImgUrl(f,"export")};this.saveConfigInfo=function(a,f,l,r,D,C){a={publishTargetType:ya.MOBILE,modelBook:f?JSON.stringify(f):null,configModel:JSON.stringify(a.toJsonObject()),thumbnailModelBook:l?
JSON.stringify(l):null,paramPathPrefix:r,dsbPublishId:D,scene:C};e.remote("saveConfigInfo",a)};this.loadConfigInfo=function(a){e.remote("loadConfigInfo",{publishTargetType:ya.MOBILE,pushTargetType:a})};this.updateConfigInfo=function(a,f){a={publishTargetType:ya.MOBILE,configModel:JSON.stringify(a.toJsonObject()),paramPathPrefix:f};e.remote("updateConfigInfo",a)};this.deleteConfigInfo=function(a,f){e.remote("deleteConfigInfo",{publishTargetType:ya.MOBILE,configId:a,pushTargetType:f})};this.loadAllPushRecord=
function(a,f){e.remote("loadAllPushRecord",{publishTargetType:ya.MOBILE,pushTargetType:f,configId:a})};this.loadPushRecordErrorInfo=function(a,f){e.remote("loadPushRecordErrorInfo",{publishTargetType:ya.MOBILE,pushRecordId:a})};this.deletePushRecord=function(a){a={publishTargetType:ya.MOBILE,arrYzjPushRecordModel:JSON.stringify(a)};e.remote("deletePushRecord",a)};this.doPush=function(a,f,l,r){return e.remote("doPush",{publishTargetType:ya.MOBILE,configId:a,timeStamp:f,paramPathPrefix:l,pushTargetType:r})};
this.getServerTimeStamp=function(){e.remote("getServerTimeStamp",{publishTargetType:ya.MOBILE})};this.getServerTimeStampForDoPush=function(){e.remote("getServerTimeStampForDoPush",{publishTargetType:ya.MOBILE})};this.updateScheduleState=function(a,f,l){e.remote("updateScheduleState",{publishTargetType:ya.MOBILE,openSchedule:a,configId:f,paramPathPrefix:l})};this.getUserIdsByRoleId=function(a){a={publishTargetType:ya.MOBILE,roleId:JSON.stringify(a)};e.remote("getUserIdsByRoleId",a)};this.loadPushContext=
function(){e.remote("loadPushContext",{publishTargetType:ya.MOBILE})};this.updateLappThumbnail=function(a,f,l,r,D){e.remote("updateLappThumbnail",{publishTargetType:ya.MOBILE,lappId:a,schemaId:f,fromPageClientId:l,subscribeKey:r,lappUserType:D})};this.loadPushSchema=function(a,f){e.remote("loadPushSchema",{publishTargetType:ya.MOBILE,configId:a,pushTargetType:f})};this.updatePushSchema=function(a,f,l){a={publishTargetType:ya.MOBILE,configId:a,model:JSON.stringify(l),pushTargetType:f};e.remote("updatePushSchema",
a)};this.loadDatacenterInfo=function(){e.remote("loadDatacenterInfo",{publishTargetType:ya.MOBILE})};this.finishSync=function(a){e.remote("finishSync",{publishTargetType:ya.MOBILE,datacenterUUID:a})};this.cronExpression=function(a){e.remote("cronExpression",{publishTargetType:ya.MOBILE,cron:a})};this.checkSameSource=function(a,f){e.remote("checkSameSource",{publishId:a,sourceId:f,publishTargetType:ya.MOBILE})};this.loadThirdPartyConfig=function(){e.remote("loadThirdPartyConfig",{publishTargetType:ya.MOBILE})};
this.updateThirdPartyConfig=function(a){a={thirdPartyConfig:JSON.stringify(a),publishTargetType:ya.MOBILE};e.remote("updateThirdPartyConfig",a)};this.deleteThirdPartyConfig=function(){e.remote("deleteThirdPartyConfig",{publishTargetType:ya.MOBILE})};this.loadPermissionLappContexts=function(a,f){a={appType:f,publishIds:JSON.stringify(a),publishTargetType:ya.MOBILE};e.remote("loadPermissionLappContexts",a)};this.updateModelTime=function(a,f){a={arrCreateTime:JSON.stringify(a),arrUpdateTime:JSON.stringify(f),
publishTargetType:ya.MOBILE};e.remote("updateModelTime",a)};this.updatePublishLappConfigs=function(a){a={publishLappConfigs:JSON.stringify(a),publishTargetType:ya.MOBILE};e.remote("updatePublishLappConfigs",a)};this.getAllLappContextsByUserIds=function(a){a={publishTargetType:ya.MOBILE,userIds:JSON.stringify(a)};e.remote("getAllLappContextsByUserIds",a)};this.loadPushRecordConfigInfo=function(a){e.remote("loadPushRecordConfigInfo",{publishTargetType:ya.MOBILE,pushTargetType:a})};this.saveLappPushRecordConfig=
function(a,f,l){e.remote("saveLappPushRecordConfig",{publishTargetType:ya.MOBILE,pushTargetType:a,strategy:f,value:l})}}function Ja(){var d=this,u,g,h,e,a,f,l,r,D,C,w,n,k,p,m=[],t;this.getEId=function(){return u};this.setEId=function(c){u=c};this.getLappUserId=function(){return g};this.setLappUserId=function(c){g=c};this.getLappUserType=function(){return h};this.setLappUserType=function(c){h=c};this.setUserName=function(c){e=c};this.getUserName=function(){return e};this.getAccountId=function(){return a};
this.setAccountId=function(c){a=c};this.getScene=function(){return f};this.setScene=function(c){f=c};this.setServerHostUrl=function(c){l=c};this.getServerHostUrl=function(){return l};this.setAppId=function(c){r=c};this.getAppId=function(){return r};this.setDatacenterUUID=function(c){D=c};this.getDatacenterUUID=function(){return D};this.setDatacenterEditor=function(c){C=c};this.isDatacenterEditor=function(){return C};this.setQingAdminRole=function(c){w=c};this.getQingAdminRole=function(){return w};
this.setQingAdminRoleUserId=function(c){n=c};this.getQingAdminRoleUserId=function(){return n};this.setConfiguredPublishUrlPrefix=function(c){k=c};this.getConfiguredPublishUrlPrefix=function(){return k};this.setExtraPublishUrlParamMap=function(c){p=c};this.getExtraPublishUrlParamMap=function(){return p};this.appendExtraPublishUrlParam=function(c){if(p)for(var q in p){var z=p[q];z&&(c=mb.appendParamToUrl(c,q,z))}return c};this.setPublishLappConfigs=function(c){m=c};this.getPublishLappConfigs=function(){return m};
this.setPrivate=function(c){t=c};this.isPrivate=function(){return t};this.fromJsonObject=function(c){if(c){c.eid&&d.setEId(c.eid);c.lappUserId&&d.setLappUserId(c.lappUserId);if(null==g||""==$.trim(g))g="";c.lappUserType&&d.setLappUserType(c.lappUserType);c.userName&&d.setUserName(c.userName);c.accountId&&d.setAccountId(c.accountId);c.scene&&d.setScene(c.scene);c.serverHostUrl&&d.setServerHostUrl(c.serverHostUrl);c.appId&&d.setAppId(c.appId);c.datacenterUUID&&d.setDatacenterUUID(c.datacenterUUID);
c.isDatacenterEditor&&d.setDatacenterEditor(c.isDatacenterEditor);c.isQingAdminRole&&d.setQingAdminRole(c.isQingAdminRole);c.qingAdminRoleUserId&&d.setQingAdminRoleUserId(c.qingAdminRoleUserId);c.configuredPublishUrlPrefix&&d.setConfiguredPublishUrlPrefix(c.configuredPublishUrlPrefix);c.extraPublishUrlParamMap&&d.setExtraPublishUrlParamMap(c.extraPublishUrlParamMap);if(c.publishLappConfigs){var q=c.publishLappConfigs;m=[];for(var z=0;z<q.length;z++){var L=new La;L.fromJsonObject(q[z]);m.push(L)}}d.setPrivate(c.isPrivate)}}}
function La(){var d,u,g,h,e,a,f;this.setId=function(l){d=l};this.getId=function(){return d};this.setAppType=function(l){u=l};this.getAppType=function(){return u};this.setOrderId=function(l){g=l};this.getOrderId=function(){return g};this.setLappUserId=function(l){h=l};this.getLappUserId=function(){return h};this.setLappUserType=function(l){e=l};this.getLappUserType=function(){return e};this.setCorpId=function(l){a=l};this.getCorpId=function(){return a};this.setAppImageFile=function(l){f=l};this.getAppImageFile=
function(){return f};this.fromJsonObject=function(l){d=l.id;u=l.appType;g=l.orderId;h=l.lappUserId;if(null==h||""==$.trim(h))h="";e=l.lappUserType;a=l.corpId;f=l.appImageFile};this.toJsonObject=function(){var l={};l.id=d;l.appType=u;l.orderId=g;l.lappUserId=h;l.lappUserType=e;l.corpId=a;l.appImageFile=f;return l}}function Xa(){var d,u,g;this.setDatacenterUUID=function(h){d=h};this.getDatacenterUUID=function(){return d};this.setAccountName=function(h){u=h};this.getAccountName=function(){return u};
this.setProductType=function(h){g=h};this.getProductType=function(){return g};this.fromJsonObject=function(h){h&&(d=h.datacenterUUID,u=h.accountName,g=h.productType)};this.toJsonObject=function(){var h={};h.datacenterUUID=d;h.accountName=u;h.productType=g;return h}}function lb(d){ac.call(this,d,ya.MOBILE);var u=this,g=this.protectedMethod,h,e,a,f,l=!1;this.setPublishContext=function(m){h=m};this.getPublishContext=function(){return h};this.getJqUi=function(){e||(e=$("<div>"),l?(u.protectedUpdateUI(!0),
l=!1):r());return e};this.getUserIdsByValueTextPair=function(m){for(var t=[],c=0;c<m.length;c++){var q=m[c].getValue();-1==t.indexOf(q)&&t.push(q)}return t};this.protectedAutoSelectAppType=function(){};var r=function(){D(function(){u.protectedAutoSelectAppType();var m=fa.getLappUserId();u.protectedIsOwnDealLappContext()||null!=m&&""!=$.trim(m)?u.protectedUpdateUI(!0):u.protectedUpdateUI(!1)},function(){u.protectedUpdateUI(!1)})},D=function(m,t){gb.LappIntegration.loadLappContext(d,u.protectedIsOnlyYzj(),
!0,m,function(c,q){g.getOuterMessageCurtain().showPrompt(q,2E3);t&&t()})};this.protectedUpdateUI=function(m){m?(a||(a=u.protectedCreateContainer(),a.appendTo(e)),a.show(),setTimeout(C,2E3)):(a&&a.hide(),p().appendTo(e),fa=null)};this.protectedCreateContainer=function(){throw Error();};this.protectedIsOnlyYzj=function(){throw Error();};this.protectedIsOwnDealLappContext=function(){return!1};var C=function(){if(fa.getLappUserId()){var m=new ka("lappAnalysisMgr",function(t){t&&0<t.length&&w(t)},function(t,
c){return!0});m.setShowBlocking(!1);m.getLogicDeletedPublishIds()}},w=function(m){var t=g.createFacade(function(c){c&&0<c.length&&n(c)},function(c,q){return!0});t.setShowBlocking(!1);t.deletePublishInfos(ya.MOBILE,m)},n=function(m){var t=new ka("lappAnalysisMgr",function(c){},function(c,q){return!0});t.setShowBlocking(!1);t.deleteByPublishIds(m)};this.setHasLappContext=function(m){l=m};var k=function(){for(var m=fa.getPublishLappConfigs(),t=0;t<m.length;t++){var c=m[t];if(fa.getLappUserType()==c.getLappUserType())return c.getAppType()}},
p=function(){var m=$("<div>");m.addClass("sa-qing-publish-manager-content-emptytip");m.css({top:"80px"});var t=b.get("lappUserIdNullTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u540c\u6b65\u7528\u6237\u4fe1\u606f\u3002\u64cd\u4f5c\u65b9\u5f0f\u8bf7\u53c2\u8003"),c=pb.getMobileLightAppUrl(),q=$("<a onclick='javascript:window.open(\""+c+"\");' href='#'>");q.css({cursor:"pointer",color:"var(--color-main, #5582f3)"});fa&&"K3CLOUD"==
fa.getScene()&&k()==hb.DINGDING_OFFLINE&&(t=b.get("lappUserIdNullDDTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u60a8\u5728\u9489\u9489\u79fb\u52a8\u7aef\u7684\u661f\u7a7a\u8f7b\u5e94\u7528\u4e2d\u7ed1\u5b9a\u7528\u6237\u4fe1\u606f\uff0c\u64cd\u4f5c\u65b9\u5f0f\u8bf7\u53c2\u8003"),q=$("<a onclick='javascript:window.open(\""+c+"\");' href='#'>"));m.text(t);q.text(b.get("helpDocument","\u5e2e\u52a9\u6587\u6863"));q.appendTo(m);return m};this.protectedMethod.getPublishContext=
function(){return h};this.protectedMethod.getLappContextsByUserSelector=function(m,t,c){var q=g.createFacade(function(z){var L=new Cc;L.fromJsonObject(z);L.isSuccess()?t(L.getAuthorizedUsers(),L.getFailedUserIds(),!1):t(L.getAuthorizedUsers(),L.getFailedUserIds(),!0,function(){var B=L.getFailedUserNames(),y=b.get("authorizedPersion","\u6388\u6743\u6210\u529f\u4eba\u6570\uff1a")+L.getAuthorizedUsers().length;y+="\n"+b.get("authorizationFailures","\u6388\u6743\u5931\u8d25\u4eba\u6570\uff1a")+B.length;
for(var aa=b.get("detailOfFailures","\u83b7\u53d6\u4ee5\u4e0b\u7528\u6237\u79fb\u52a8\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u5148\u540c\u6b65\u79fb\u52a8\u8f7b\u5e94\u7528\u8d26\u53f7\uff1a")+"\r\n",V=0;V<B.length;V++){var pa=B[V];0!=V&&(aa+=b.get("comma","\uff0c"));if(50<V){aa+="...";break}aa+=pa}B=com.kingdee.bos.qing.ui.component.MessageDialog;V=new B;V.setOptionType(B.OPTION_OK);V.setMessage(y);aa&&V.setDetail(aa);V.showDialog()})},function(z,L){g.getOuterMessageCurtain().showPrompt(L,
2E3);c()});q.setShowBlocking(!1);q.getLappContextsByIds(m,k())};this.protectedMethod.cutAndUploadImageToCloud=function(m,t,c,q,z,L,B){if(m){var y=new ka("image",function(aa){t(aa);c(!0,q,z,L);B&&B()},function(aa,V){g.getOuterMessageCurtain().showPrompt(V,2E3);c(!0);return!0});y.setShowBlocking(!1);y.uploadBase64Image(m)}else c(!0,q,z,L),B&&B()};this.protectedMethod.isDsbPublish=function(){return h.getScene()==$a.Scene.Longer||h.getScene()==$a.Scene.Square?!1:!0};this.protectedMethod.getNotDuplicatedUserIds=
function(m,t){for(var c=0;c<t.length;c++){for(var q=!1,z=0;z<m.length;z++)if(t[c]==m[z]){q=!0;break}q||m.push(t[c])}return m};this.protectedMethod.loadPermissionTip=function(m,t){m.addClass("sa-role-permission-tip");m.text("!");m.on("mouseenter",function(c){f?f.show():(f=$("<div>"),f.on("mouseenter",function(){f&&f.show()}),f.on("mouseleave",function(q){f&&f.hide()}),f.addClass("sa-role-permission-tip-text"),c=b.get("onlyCurrentRoleUser","\u5c06\u6388\u6743\u7ed9\u5f53\u524d\u9009\u5b9a\u89d2\u8272\u7684\u6240\u6709\u7528\u6237\uff0c\u5982\u679c\u5f53\u524d\u9009\u5b9a\u89d2\u8272\u7684\u7528\u6237\u540e\u7eed\u53d1\u751f\u589e\u51cf\uff0c\u60a8\u53ef\u4ee5\u5728\u201c\u53d1\u5e03\u7ba1\u7406\u201d\u91cc\u901a\u8fc7\u201c\u4e00\u952e\u540c\u6b65\u6240\u6709\u89d2\u8272\u201d\u529f\u80fd\u540c\u6b65\u7528\u6237\u6743\u9650\u3002"),
f.text(c),t(f))});m.on("mouseleave",function(c){f&&f.hide()})};this.protectedMethod.refreshUi=function(m){a=e=null;l=!0;m&&m()};this.protectedMethod.getCurrentAppType=k;this.protectedMethod.toggleLappContext=function(m){for(var t=fa.getPublishLappConfigs(),c=0;c<t.length;c++){var q=t[c];if(q.getAppType()==m){fa.setLappUserId(q.getLappUserId());fa.setLappUserType(q.getLappUserType());fa.setEId(q.getCorpId());break}}};this.protectedMethod.createLappUserIdNullTips=p;this.protectedMethod.getDisplayStyles=
function(){var m=[new ub(b.get("displayStyleThumbnail","\u7f29\u7565\u56fe"),Ba.DISPLAYSTYLE_THUMNAIL)];k()==hb.YZJ&&m.push(new ub(b.get("displayStyleExecute","\u7acb\u5373\u6267\u884c"),Ba.DISPLAYSTYLE_EXECUTION));return m};this.protectedMethod.supportLandscape=function(){var m=k();return m==hb.YZJ||m==hb.DINGDING_OFFLINE?!0:!1};this.protectedMethod.refreshLappContext=function(m){D(m)};this.protectedMethod.createLappUserIdNullMessageDialog=function(){var m=Sa.createFeedbackDialog();m.setOptionType(Sa.RETURN_OK);
m.setMsgImageType(Sa.MSG_WARNING);m.setExtendPainter(function(t,c){var q=$("<div>");q.addClass("qing-publish-lapp-user-empty-tip");c=b.get("lappUserIdNullTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u540c\u6b65\u7528\u6237\u4fe1\u606f\u3002\u64cd\u4f5c\u65b9\u5f0f\u8bf7\u53c2\u8003");var z=pb.getMobileLightAppUrl(),L=$("<a onclick='javascript:window.open(\""+z+"\");' href='#'>");L.css({cursor:"pointer",color:"var(--color-main, #5582f3)"});
fa&&"K3CLOUD"==fa.getScene()&&k()==hb.DINGDING_OFFLINE&&(c=b.get("lappUserIdNullDDTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u60a8\u5728\u9489\u9489\u79fb\u52a8\u7aef\u7684\u661f\u7a7a\u8f7b\u5e94\u7528\u4e2d\u7ed1\u5b9a\u7528\u6237\u4fe1\u606f\uff0c\u64cd\u4f5c\u65b9\u5f0f\u8bf7\u53c2\u8003"),L=$("<a onclick='javascript:window.open(\""+z+"\");' href='#'>"));q.text(c);L.text(b.get("helpDocument","\u5e2e\u52a9\u6587\u6863"));L.appendTo(q);q.appendTo(t)});
return m}}function Dc(d){lb.call(this,d);var u=this,g=this.protectedMethod,h,e,a,f,l=window.pcyzjShare,r;this.getWidth=function(){return 400};this.getHeight=function(){return g.isDsbPublish()?300:363};this.isEditPublish=function(){return!1};this.protectedCreateContainer=function(){var k=$("<div>");if(l){var p=0,m=g.getPublishContext(),t=$("<div>").text("*");t.addClass("sa-qing-publish-edit-star");var c=new Da,q=c.getJqUi();c.setText(b.get("publishName","\u53d1\u5e03\u540d\u79f0"));h=new bb;c=h.getJqUi();
E.layoutCtrl(t,0,p+2,5,18);E.layoutCtrl(q,8,p,64,23);E.layoutCtrl(c,120,p,230,23);t.appendTo(k);q.appendTo(k);c.appendTo(k);p+=43;q=new Da;t=q.getJqUi();q.setText(b.get("description","\u63cf\u8ff0"));e=new sb;q=e.getJqUi();E.layoutCtrl(t,8,p,64,23);g.isDsbPublish()?E.layoutCtrl(q,120,p,230,120):E.layoutCtrl(q,120,p,230,32);t.appendTo(k);q.appendTo(k);p+=52;g.isDsbPublish()||(q=new Da,t=q.getJqUi(),q.setText(b.get("thumbnail","\u7f29\u7565\u56fe")),a=new Ib(m,g.createFacade,g.getOuterMessageCurtain()),
a.setSchedulable(!1),q=a.getJqUi(),E.layoutCtrl(t,8,p,64,23),E.layoutCtrl(q,120,p,230,115),t.appendTo(k),q.appendTo(k),p+=131,q=new Da,t=q.getJqUi(),q.setText(b.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e")),f=new qb,m.getHasDirectModeTable()?(f.setOn(!1),f.setEnabled(!1)):m.isHaveToCarryData()?(f.setOn(!0),f.setEnabled(!1)):f.setOn(!1),q=f.getJqUi(),E.layoutCtrl(t,8,p-2,100,23),E.layoutCtrl(q,120,p,31,19),m.supportPublishWithCarryData()&&(t.appendTo(k),q.appendTo(k)))}else k.addClass("sa-qing-publish-manager-content-emptytip"),
k.text(b.get("CLoudHubUnavailable","\u4e91\u4e4b\u5bb6\u672a\u542f\u7528\uff0c\u6682\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd"));return k};this.protectedIsOnlyYzj=function(){return!0};this.getModelFromUI=function(){var k=g.getPublishContext(),p=new nb;p.setPublishSourceType(k.getCurrentSourceType());p.setPublishTargetType(u.getPublishTargetType());p.setTagId(k.getBizTag());p.setName($.trim(h.getText()));p.setPath("lightapp");p.setPathText("lightapp");p.setAnalysis(!0);p.setSchemeId(nb.CURRENT_SCHEMA_ID);
p.setSpaceID(k.getSpaceID());f&&p.setCarryData(f.isOn());return p};this.getJsonModel=function(){return g.getPublishContext().getCurrentContentModel()};this.checkUIInput=function(k){if(null==fa||!fa.getLappUserId())return b.get("lappUserIdNull","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25");if(!l)return b.get("CLoudHubUnavailable","\u4e91\u4e4b\u5bb6\u672a\u542f\u7528\uff0c\u6682\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd");var p=h.getText();if(null==p||0==$.trim(p).length)return b.get("publishNameNotEmpty",
"\u8bf7\u8f93\u5165\u53d1\u5e03\u540d\u79f0");if(50<p.length)return b.get("publishNameTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26");if(50<e.getText().length)return b.get("descriptionCanNotExceedLimit50","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u5b57\u7b26");if(g.isDsbPublish())k(!0);else return p=a.getBase64Img(),g.cutAndUploadImageToCloud(p,function(m){r=m},k),null};var D=function(k,p){var m=fa.getScene();k=n(k);var t=new ka("lappAnalysisMgr",function(c){C(c,p)},function(c,
q){g.getOuterMessageCurtain().showPrompt(b.get("saveAnalysisFailed","\u5206\u4eab\u5931\u8d25")+q,2E3);return!0});t.setShowBlocking(!1);t.saveAnalysis(k,fa.getEId(),m,!0)},C=function(k,p){var m=g.createFacade(function(t){w(k,t.userName,t.userPictureFiled,p)},function(t,c){g.getOuterMessageCurtain().showPrompt(b.get("saveAnalysisFailed","\u5206\u4eab\u5931\u8d25")+c,2E3);return!0});m.setShowBlocking(!1);m.getShareContext()},w=function(k,p,m,t){var c=new Ec;c.setAnalysisId(k);c.setAuthorId(fa.getLappUserId());
c.setAuthorName(p);c.setAuthorHeadUrl(m);k=new ka("sharing",function(q){var z=r;z=z?ib+"image/downloadImage?path="+z:g.isDsbPublish()?ib+"qing-lapp/core/resource/icon_chart_dsb.png":ib+"qing-lapp/core/resource/icon_chart.png";q=ib+"sharing/getShareUrlById.do"+q;var L=new Fc;L.setOpenNewPage(!0);L.setSelectGroup(!0);L.setTitle(h.getText());L.setContent(e.getText());L.setThumbUrl(z);L.setWebpageUrl(q);L.setCallback(function(B){t.showSuccess(b.get("shareSuccess","\u5206\u4eab\u6210\u529f\u3002"))});
l.share(L.toJsonObject())},function(q,z){g.getOuterMessageCurtain().showPrompt(b.get("saveAnalysisFailed","\u5206\u4eab\u5931\u8d25")+z,2E3);return!0});k.setShowBlocking(!1);k.addSharing(c);Ab.occur(Ab.COMMUNICATE_TYPE,Ab.YZJ_COMMUNICATE)};this.getNewPublishSuccessCallback=function(){return D};var n=function(k){var p=g.getPublishContext(),m=fa.getScene(),t=new Ba;t.setScene(m);t.setParentId("-1");t.setName(h.getText());t.setCardDesc(e.getText());t.setUploadData(!1);m=p.getLappEntranceUrl();m=gb.LappIntegration.getRealPublishUrl(m,
p.getParamPathPrefix(),fa.getConfiguredPublishUrlPrefix());m=mb.appendParamToUrl(m,"accountId",fa.getAccountId());m=mb.appendParamToUrl(m,"publishId",k.getId());m=fa.appendExtraPublishUrlParam(m);t.setUrl(m);t.setLayoutType(Ba.LT_NORMAL);t.setLargeThumbnail(r);t.setSmallThumbnail(r);t.setPublishId(k.getId());g.isDsbPublish()?t.setViewType(Ba.VIEW_TYPE_DASHBOARD):p.getScene()==$a.Scene.Square?t.setViewType(Ba.VIEW_TYPE_SQUARE):t.setViewType(Ba.VIEW_TYPE_LONGER);return t}}function Fc(){var d,u,g,h,
e,a,f;this.setOpenNewPage=function(l){d=l};this.getOpenNewPage=function(){return d};this.setSelectGroup=function(l){u=l};this.getSelectGroup=function(){return u};this.setTitle=function(l){g=l};this.getTitle=function(){return g};this.setContent=function(l){h=l};this.getContent=function(){return h};this.setThumbUrl=function(l){e=l};this.getThumbUrl=function(){return e};this.setWebpageUrl=function(l){a=l};this.getWebpageUrl=function(){return a};this.setCallback=function(l){f=l};this.getCallback=function(){return f};
this.toJsonObject=function(){var l={};l.openNewPage=d;l.selectGroup=u;l.title=g;l.content=h;l.thumbUrl=ib+"qing-lapp/core/resource/icon_qing.png";l.webpageUrl=a;l.callback=f;l.appName="\u8f7b\u5206\u6790";l.param={appId:com.kingdee.bos.qing.lapp.integration.APP_ID,lightAppId:com.kingdee.bos.qing.lapp.integration.APP_ID,customStyle:2,contentUrl:e};return l}}function Gc(){var d,u,g,h=376,e=685;this.setContent=function(a){g=a;d&&(u.empty(),u.append(g))};this.setHeight=function(a){e=a};this.getHeight=
function(){return e};this.setWidth=function(a){h=a};this.getWidth=function(){return h};this.getJqUi=function(){if(!d){d=$("<div>");d.css({"background-color":"rgb(0, 0, 0)","border-radius":"12px",position:"absolute",width:h+"px",height:e+"px"});var a=$("<div>");a.css({"background-color":"rgb(51, 51, 51)","border-radius":"10px",position:"absolute",top:"5px",left:"50px",width:"10px",height:"10px"});var f=h/2-20,l=$("<div>");l.css({"background-color":"rgb(34, 34, 34)","border-radius":"4px",position:"absolute",
left:f+"px",top:"6px",width:"40px",height:"8px"});f=$("<div>");f.text(b.get("preview","\u9884\u89c8"));f.css({"text-align":"center","line-height":"40px","font-size":"14px",color:"rgb(51, 51, 51)","background-color":"rgb(255, 255, 255)","border-bottom":"1px solid rgb(204, 204, 204)",position:"absolute",left:"8px",right:"8px",top:"20px",height:"40px"});var r=$("<div>");r.css({"background-color":"rgb(0, 0, 0)","border-radius":"0px 4px 4px 0px",position:"absolute",left:h+"px",top:"145px",width:"3px",
height:"60px"});var D=h-16,C=e-20-8-40-1;u=$("<div>");u.css({position:"absolute","background-color":"rgb(226, 231, 239)",left:"8px",top:"61px",width:D+"px",height:C+"px","border-radius":"0px 0px 6px 6px"});g&&u.append(g);g.css("border-radius","0px 0px 6px 6px");d.append(a);d.append(l);d.append(r);d.append(f);d.append(u)}return d}}function Ib(d,u,g){var h=this,e,a=!0,f=300,l=150,r=new Jb;r.setSchemaModelBook(d.getCurrentContentModel().schemaContent);var D,C,w=$("<div class='sa-publish-thumbnailcut-texttips'>");
this.setThumbnailSize=function(p,m){f=p;l=m};this.getBase64Img=function(){return e};this.getThumbnailInfo=function(){return r};this.setSchedulable=function(p){a=p};this.getJqUi=function(){if(!D){D=$("<div class='sa-publish-thumbnailcut'>");if(d.getScene()!=$a.Scene.Square||a)D.on("click",h.showThumbnailCutSettingDialog),D.css("cursor","pointer");C=$("<img class='sa-publish-thumbnailcut-img'>");C.attr("src",cb.getIconUrl("lightapp/common","icon_chart_building.png"));C.appendTo(D);w=$("<div class='sa-publish-thumbnailcut-texttips'>");
d.getScene()==$a.Scene.Square?(w.text(b.get("loadingSquareImg","\u6b63\u5728\u521b\u5efa\u7f29\u7565\u56fe...")),n()):d.getScene()==$a.Scene.Longer&&w.text(b.get("creatThumbnailForAnalysis","\u70b9\u51fb\u8fd9\u91cc\u4e3a\u60a8\u7684\u5206\u6790\u521b\u5efa\u7f29\u7565\u56fe"));w.appendTo(D);if(a||d.getScene()==$a.Scene.Longer){var p=$("<div class='sa-publish-thumbnailcut-plus-icon'>");Ma.background(p,"icon_add_blue");p.appendTo(D)}}return D};var n=function(){var p=u(function(m){C.off("load");C.on("load",
function(){var c=new Image;c.onload=function(){var q=document.createElement("canvas");q.width=c.width;q.height=c.height;q.getContext("2d").drawImage(c,0,0,c.width,c.height);e=q.toDataURL("image/png")};c.src=t});var t=u().getExportedImgUrl(d.getParamPathPrefix(),m);C.attr("src",t);w.hide()});p.setShowBlocking(!1);p.exportSquareImg(k(),f,l)};this.needInitLongerThumbnailImage=function(p){return d.getScene()===$a.Scene.Longer&&a&&p&&!e?!0:!1};this.initLongerThumbnailImage=function(p,m){html2canvas(p[0].contentDocument.body,
{width:260,height:130,onrendered:function(t){if(t=t.toDataURL())e=t,m()}})};var k=function(){for(var p=d.getCurrentContentModel().schemaContent,m,t=p.pages,c=t.length,q=0;q<c;q++)if(t[q].current){m=t[q];break}m||(m=t[0]);t={};t.meta=p.meta;t.model=m.model;t.preferences=m.preferences;return t};this.showThumbnailCutSettingDialog=function(){var p=r.copy();p=new bc(d.getScene(),d.getMobilePreviewUrl(),p);p.setClosedCallback(function(m,t){r=m;t&&(w.hide(),e=t,C.off("load"),C.attr("src",e))});p.setSchedulable(a);
p.showDialog()}}function bc(d,u,g){db.call(this);var h=this,e=this.protectedMethod,a,f,l,r=g,D,C,w;(function(){e.setTitle(b.get("creatThumbnail","\u751f\u6210\u7f29\u7565\u56fe"));h.setSize(800,570);e.setContentPaneCreator(function(){d==$a.Scene.Longer&&(f=new Hc,f.setThumbnailInfo(r),f.setUrl(u),d==$a.Scene.Square&&f.setThumbnailEditable(!1));l=new cc;l.setScheduleModel(r.getSchedule());if(C&&f)return a=new jb,a.setTabLevel(jb.SECOND_LEVEL),a.addTab(f,!0),a.addTab(l,!1),a.addTabChangedListener(function(p,
m){m instanceof cc&&!f.getIframeLoadStatus()&&(e.getMessageCurtain().showPrompt(b.get("inLoadTip","\u6b63\u5728\u751f\u6210\u7f29\u7565\u56fe\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"),2E3),a.setCurrentTabPane(f))}),a.getJqUi();if(C){var n=$("<div>");h.setSize(800,500);l.getJqUi().appendTo(n);return n}if(f){n=$("<div>");h.setSize(800,500);var k=f.getJqUi();k.find(".sa-publish-thumbnailcut-container").css({top:0});k.appendTo(n);return n}return $("<div>")});e.setClosingChecker(function(n){f?f.getIframeLoadStatus()?
(a&&a.setCurrentTabPane(f),f.iframeToCanvas(function(k){D=k;r=f.getThumbnailInfo();n(!0)})):(e.getMessageCurtain().showPrompt(b.get("inLoadTip","\u6b63\u5728\u751f\u6210\u7f29\u7565\u56fe\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"),2E3),n(!1)):n(!0)},!0);e.setClosingAction(function(n){n&&(r.setSchedule(l.getScheduleModel()),w&&w(r,D))})})();this.setSchedulable=function(n){C=n};this.setClosedCallback=function(n){w=n}}function Hc(){jb.AbstractTabPane.call(this);var d,u,g,h,e,a,f,l,r,D=!0,C;this.getTitle=
function(){return b.get("thumbnail","\u7f29\u7565\u56fe")};this.setUrl=function(c){r=c};this.setThumbnailEditable=function(c){D=c};this.setThumbnailInfo=function(c){C=c};this.getJqUi=function(){if(!d){d=$("<div class='sa-publish-thumbnailcut-setting'>");u=$("<div class='sa-publish-thumbnailcut-container'>");g=$("<div>");D&&g.addClass("sa-publish-thumbnailcut-aperture");D&&g.on("mousedown",p);D&&g.on("mouseenter",n);D&&g.on("mouseleave",k);e=$("<div class='sa-publish-thumbnailcut-shield'>");a=$("<div class='sa-publish-thumbnailcut-shield'>");
f=$("<div class='sa-publish-thumbnailcut-shield'>");l=$("<div class='sa-publish-thumbnailcut-shield'>");e.appendTo(u);a.appendTo(u);f.appendTo(u);l.appendTo(u);k();var c=$("<div>");c.addClass("sa-publish-thumbnailcut-dragchunk");Ma.background(c,"icon_drag");D&&c.appendTo(g);g.appendTo(u);h=$("<iframe class='sa-publish-thumbnailcut-iframe'>");h.attr("src",r);h.appendTo(u);u.appendTo(d);w()}return d};var w=function(){C&&g.css({left:C.getApertureLeft()-2+1,top:C.getApertureTop()-2,width:C.getApertureWidth(),
height:C.getApertureHeight()});var c={from:"LAPP_MESSAGE",layoutType:Ba.LT_NORMAL,model:C.getSchemaModelBook()};h.on("load",function(){h[0].contentWindow.postMessage(JSON.stringify(c),r)})},n=function(){e.show();a.show();f.show();l.show();var c=parseInt(g.css("width")),q=parseInt(g.css("height")),z=parseInt(g.css("left")),L=parseInt(g.css("top")),B=parseInt(g.css("border-left-width"));e.css({left:0,top:Math.max(0,L),width:z,bottom:0});a.css({left:0,top:0,height:L,width:z+c+B});f.css({left:z+c+B,top:0,
height:L+q+B,right:0});l.css({left:Math.max(0,z),top:L+q+B,right:0,bottom:0})},k=function(){e.hide();a.hide();f.hide();l.hide()},p=function(c){var q=$(c.target),z=c.clientX,L=c.clientY,B=parseInt(g.css("left")),y=parseInt(g.css("top"));c=$(document.body);if(q.hasClass("sa-publish-thumbnailcut-dragchunk")){var aa=parseInt(g.css("width"));c.on("mousemove",function(V){var pa=V.clientX-z,N=g.offset().top;V=2*(V.clientY-N);var W=parseInt(u.width());N=parseInt(u.height());var J=parseInt(g.css("border-left-width"));
W=W-parseInt(g.css("left"))-J;N=N-parseInt(g.css("top"))-J;g.css({width:Math.min(W,2*N,Math.max(283,Math.min(V,aa+pa)))});pa=parseInt(g.css("width"))/2;g.css({height:pa});n()});c.on("mouseup",m)}else c.on("mousemove",function(V){var pa=V.clientX;V=V.clientY;var N=parseInt(g.css("border-left-width")),W=parseInt(u.width())-parseInt(g.width())-N,J=parseInt(u.height())-parseInt(g.height())-N;g.css({left:Math.min(W,Math.max(-N,B+(pa-z))),top:Math.min(J,Math.max(-N,y+(V-L)))});n()}),c.on("mouseup",t)},
m=function(c){var q=$(document.body);q.off("mousemove");q.off("mouseup");q=g.offset().top;var z=g.offset().left,L=c.clientX;c=c.clientY;var B=g.outerWidth(),y=g.outerHeight();(L>z+B||L<z||c<q||c>q+y)&&k()},t=function(c){c=$(document.body);c.off("mousemove");c.off("mouseup")};this.iframeToCanvas=function(c){html2canvas(h[0].contentDocument.body,{onrendered:function(q){var z=parseInt(g.css("top"))+parseInt(g.css("border-left-width")),L=parseInt(g.css("left"))+parseInt(g.css("border-left-width")),B=
parseInt(g.css("width")),y=parseInt(g.css("height")),aa=1;window.devicePixelRatio&&1<window.devicePixelRatio&&(aa=window.devicePixelRatio);q=q.getContext("2d").getImageData(aa*L,aa*z,aa*B,aa*y);z=document.createElement("canvas");com.kingdee.bos.qing.common.CanvasUtil.createContext2d(z,B,y).putImageData(q,0,0);B=z.toDataURL();c(B)}})};this.getThumbnailInfo=function(){var c=new Jb;c.setApertureTop(parseInt(g.css("top"))+parseInt(g.css("border-left-width")));c.setApertureLeft(parseInt(g.css("left"))+
parseInt(g.css("border-left-width")));c.setApertureWidth(parseInt(g.css("width")));c.setApertureHeight(parseInt(g.css("height")));var q=null;try{q=h[0].contentWindow.com.kingdee.bos.qing.lapp.scene.LappLongerUtil.getJsonModelBook()}catch(z){console.log(z)}q||(q=C.getSchemaModelBook());c.setSchemaModelBook(q);if(q=h[0].contentDocument.getElementById("table1MainView"))c.setScrollTop(q.scrollTop),c.setScrollLeft(q.scrollLeft);return c};this.getIframeLoadStatus=function(){if(h){try{return h[0].contentWindow.com.kingdee.bos.qing.lapp.scene.LappLongerUtil.getLoadStatus()}catch(c){console.log(c)}return!1}return!0}}
function cc(){jb.AbstractTabPane.call(this);var d,u,g;this.getTitle=function(){return b.get("updateStrategy","\u66f4\u65b0\u7b56\u7565")};this.getJqUi=function(){if(!d){d=$("<div>");g=new dc;g.allowCustomPeriod(!1);g.setUnTimingButtonText(b.get("disposableExtract","\u4e0d\u66f4\u65b0"));g.setTimingButtonText(b.get("timingExtract","\u5b9a\u65f6\u66f4\u65b0"));g.setSchedule(u);var h=g.getJqUi();E.layoutCtrlWithLRTB(h,10,10,null,10,10,null);h.appendTo(d)}return d};this.setScheduleModel=function(h){u=
h;g&&g.setSchedule(u)};this.getScheduleModel=function(){return g?g.getSchedule():null}}function ec(d){function u(v,A){v=v.match(new RegExp("(^|&)"+A+"=([^&]*)(&|$)"));return null!=v?unescape(v[2]):null}fc.call(this,d,ya.MOBILE);lb.call(this,d);var g=this,h=this.protectedMethod,e,a,f=[],l,r,D,C,w,n,k,p,m=!0,t,c,q,z,L,B,y,aa={},V={},pa,N=!1,W=0,J,Q,H=new com.kingdee.bos.qing.biz.common.ComplexPaginationBar,ca;this.protectedAutoSelectAppType=function(){(k=g.getAutoSelectedData())&&h.toggleLappContext(k.appType)};
this.getTitle=function(){return b.get("lapp","\u79fb\u52a8\u8f7b\u5e94\u7528")};this.relayoutViews=function(){r&&r.relayoutViews()};this.setPathSelectorModel=function(v,A){t=v;na=A};this.getPathSelectorModel=function(){return t};this.protectedCreateContainer=function(){var v=$("<div>");x().appendTo(v);var A=$("<div>");A.addClass("sa-qing-publish-manager");Oa(A);S(A);var F=fa.getLappUserId();if(null==F||""==$.trim(F))return N=!0,v=h.createLappUserIdNullTips(),A.find(".sa-qing-publish-lapp-setting").css("top",
"0px"),A.find(".sa-qing-publish-lapp-logo-header").css("top","-34px"),v.appendTo(A),A;N=!1;e=wa();e.getJqUi().appendTo(A);F=$("<div>");E.layoutCtrlWithLRTB(F,220,0,null,0,0,null);ca=M();ca.appendTo(F);a=za(d);a.setPaginationBar(H);l=a.getJqUi();l.appendTo(F);r=Ga();r.setPaginationBar(H);D=r.getJqUi();D.appendTo(F);D.hide();var P=b.get("configPermLabel","\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e");C=Z(P,function(){var da;m?a&&(da=a.getSelectedPublish()):r&&(da=r.getSelectedPublish());if(da&&0!=da.length){var ba=
new gc(d,ya.MOBILE,hc.LAPP);ba.setCallbackAfterSetting(ea);var la=h.getPublishContext();ba.setSpaceID(la.getSpaceID());ba.setPublishModels(da);ba.showDialog()}else h.getOuterMessageCurtain().showPrompt(b.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))});E.layoutCtrlWithLRTB(C,null,200,140,8,null,null);w=Z(b.get("del","\u5220\u9664"),T);E.layoutCtrlWithLRTB(w,null,145,45,8,null,null);C.appendTo(F);w.appendTo(F);F.appendTo(A);A.find(".sa-qing-publish-manager-content-container").css("top",
"32px");Ya();A.appendTo(v);E.layoutCtrlWithLRTB(A,0,0,null,40,0,null);return v};var ea=function(v){if(v&&0!=v.length){for(var A=[],F=[],P=0;P<v.length;P++){var da=V[v[P].getPublishId()];da&&(da.setPermLabels(v[P].getPermLabels()),A.push(da),F.push(da.getId()))}v=h.createFacade(function(ba){ra();h.getOuterMessageCurtain().showSuccess(b.get("settingSuccess","\u8bbe\u7f6e\u6210\u529f\u3002"));U(F,!1)});v.setShowBlocking(!0);v.updatePublishPermLabel(A)}},T=function(v){if((v=m?a.getSelectedPublish():r.getSelectedPublish())&&
0!=v.length){for(var A=[],F=0;F<v.length;F++)A.push(v[F].getPublishId());v=Sa.createFeedbackDialog();v.setOptionType(Sa.OPTION_OK_CANCEL);v.setMsgImageType(Sa.MSG_DELETE);v.setMessage(b.get("publishDeleteTips","\u5220\u9664\u8bb0\u5f55\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f"));v.setClosingChecker(function(P){P==Sa.RETURN_OK&&(P=new ka("lappAnalysisMgr",function(da){da=h.createFacade(function(ba){for(ba=0;ba<A.length;ba++)for(var la=0;la<y.length;la++){var sa=
y[la];sa.getId()==A[ba]&&(y.splice(la,1),na[sa.getParentId()].minus())}a.setAllPublishModels(y);r.setAllPublishModels(y);ra();h.getOuterMessageCurtain().showSuccess(b.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(ba,la){h.getOuterMessageCurtain().showPrompt(la,2E3);return!0});da.setShowBlocking(!1);da.deletePublishInfos(ya.MOBILE,A)},function(da,ba){h.getOuterMessageCurtain().showPrompt(ba,2E3);return!0}),P.setShowBlocking(!1),P.deleteByPublishIds(A));return!0});v.showDialog()}else h.getOuterMessageCurtain().showPrompt(b.get("selectPublish",
"\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))},M=function(){H.protectedMethod.setTotalSelectedRowAndSelectedAllVisual(!0,!1);H.protectedMethod.setTotalPageVisual(!1);H.protectedMethod.setCurrentPageVisual(!1);H.protectedMethod.setFirstBtnAndEndBtnVisual(!1);H.setJumpToPageListener(function(v,A,F){(new ka("lappAnalysisMgr",function(P){var da=[];if(P.infos&&0<P.infos.length){for(var ba=P.infos,la=0;la<ba.length;la++){var sa=ba[la],xa=new Ba;xa.fromJsonObject(sa);xa.setPreset(n.isPreset());da.push(xa)}ba=
[];for(la=0;la<da.length;la++)if(sa=da[la].getUrl())sa=u(sa,"publishId"),ba.push(sa);da=new va(d,function(Ha){if(void 0===Ha||null===Ha||0===Ha.length)ca.hide(),C.hide(),w.hide(),F?F(P.totalRow):H.refreshPagination(),a.setSearchStatus(!1),a.setAnalysisModels(null,V),a.updateSearchContentUI(q),r.setSearchStatus(!1),r.setListPublishModel(null,Q.isPreset());else{p=[];for(var Qa=0;Qa<Ha.length;Qa++){var Ua=new nb;Ua.fromJsonObject(Ha[Qa]);for(var rb=0;rb<y.length;rb++){var ob=y[rb];if(Ua.getId()===ob.getPublishId()){ob.setSpaceID(Ua.getSpaceID());
ob.setModifierName(Ua.getModifierName());p.push(ob);break}}}ca.show();C.show();w.show();F?F(P.totalRow):H.refreshPagination();a.setSearchStatus(!0);a.setAnalysisModels(p,V);a.updateSearchContentUI(q);r.setSearchStatus(!0);r.setListPublishModel(p,Q.isPreset())}r.updateSearchContentUI(q)},function(){return!1});da.setShowBlocking(!0);da.loadAllPublishInfosByPagination(JSON.stringify(ba),L,B)}if(void 0===P.infos||null===P.infos||0===P.infos.length)ca.hide(),C.hide(),w.hide(),F?F(P.totalRow):H.refreshPagination(),
a.setSearchStatus(c),a.setAnalysisModels(null,V),r.setSearchStatus(c),r.setListPublishModel(null,Q.isPreset())},function(P,da){return!0})).getAnalysisListOnCondition(n.getId(),q,J,v,A,L,B)});H.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);return H.getJqUi()},ra=function(v){(new ka("lappAnalysisMgr",function(A){var F=[];if(A.infos&&0<A.infos.length){for(var P=A.infos,da=0;da<P.length;da++){var ba=P[da],la=new Ba;la.fromJsonObject(ba);la.setPreset(n.isPreset());F.push(la)}P=[];for(da=
0;da<F.length;da++)if(ba=F[da].getUrl())ba=u(ba,"publishId"),P.push(ba);F=new va(d,function(sa){if(void 0===sa||null===sa||0===sa.length)ca.hide(),C.hide(),w.hide(),H.resetPaginationAndJumpToFirstPage(A.totalRow),a.setSearchStatus(c),a.setAnalysisModels(null,V,v),r.setSearchStatus(c),r.setListPublishModel(null,Q.isPreset(),v);else{ca.show();C.show();w.show();H.resetPaginationAndJumpToFirstPage(A.totalRow);p=[];for(var xa=0;xa<sa.length;xa++){var Ha=new nb;Ha.fromJsonObject(sa[xa]);for(var Qa=0;Qa<
y.length;Qa++){var Ua=y[Qa];if(Ha.getId()===Ua.getPublishId()){Ua.setSpaceID(Ha.getSpaceID());Ua.setModifierName(Ha.getModifierName());p.push(Ua);break}}}a.setSearchStatus(c);a.setAnalysisModels(p,V,v);a.updateSearchContentUI(q);r.setSearchStatus(c);r.setListPublishModel(p,Q.isPreset(),v);r.updateSearchContentUI(q)}},function(){return!1});F.setShowBlocking(!0);F.loadAllPublishInfosByPagination(JSON.stringify(P),L,B)}if(void 0===A.infos||null===A.infos||0===A.infos.length)ca.hide(),C.hide(),w.hide(),
H.resetPaginationAndJumpToFirstPage(0),a.setSearchStatus(c),a.setAnalysisModels(null,V,!0),r.setSearchStatus(c),r.setListPublishModel(null,Q.isPreset(),!0)},function(A,F){return!0})).getAnalysisListOnCondition(n.getId(),q,J,1,H.getPageSize(),L,B)};this.protectedIsOnlyYzj=function(){return!1};this.protectedIsOwnDealLappContext=function(){return!0};var x=function(){var v=$("<div class='sa-qing-publish-titlebar'>"),A=new ic,F=[new yb(b.get("allType","\u5168\u90e8\u7c7b\u578b"),0),new yb(b.get("moduleSquare",
"\u6570\u636e\u6597\u65b9"),2),new yb(b.get("moduleLonger","\u6570\u636e\u5206\u6790"),1),new yb(b.get("dashboard","\u4eea\u8868\u677f"),3)];A.setSearchType(F);A.setSelectedChangedListener(Ka);A.getJqUi().appendTo(v);A=new jc;A.setSearchListener(O);pa=A;pa.getJqUi().appendTo(v);A=new kc;A.setSortModel(Ca);z=A;A=z.getJqUi();A.appendTo(v);E.layoutCtrlWithLRTB(A,700,60,null,0,0,null);A=new lc;A.setClickListener(ha);A.getJqUi().appendTo(v);return v},ha=function(v){(m=v)?(v=r.getSelectedPublishMap(),a.setSelectedPublishMap(v),
l.show(),D.hide()):(v=a.getSelectedPublishMap(),r.setSelectedPublishMap(v),D.show(),l.hide());ra(!1)},Ka=function(v,A,F){W=F.getTypeId();0==W?J=void 0:1==W?J=Ba.VIEW_TYPE_LONGER:2==W?J=Ba.VIEW_TYPE_SQUARE:3==W&&(J=Ba.VIEW_TYPE_DASHBOARD);O()},Ga=function(){var v=new mc;v.setOuterMessageCurtain(h.getOuterMessageCurtain());v.setDeletePublishListener(Pa);v.setEditPublishListener(ma);v.setEditPublishContentListenter(g.getPublishContentEditEntrance());v.setTabType(3);v.setReSearchListener(O);v.setCardImgUrlCreator(function(A,
F){var P=cb.getIconUrl("publish","icon_chart_building.png");A?P=tb.downloadImage(A):"3"==F&&(P=cb.getIconUrl("publish","icon_dashboard_building.png"));return P});return v},Pa=function(v,A){var F=v.getId(),P=new ka("lappAnalysisMgr",function(da){da=h.createFacade(function(ba){for(ba=0;ba<y.length;ba++)if(y[ba].getId()==F){y.splice(ba,1);break}a.setAllPublishModels(y);r.setAllPublishModels(y);na[v.getParentId()].minus();A();h.getOuterMessageCurtain().showSuccess(b.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},
function(ba,la){h.getOuterMessageCurtain().showPrompt(la,2E3);return!0});da.setShowBlocking(!1);da.deletePublishInfo(ya.MOBILE,v.getPublishId())},function(da,ba){h.getOuterMessageCurtain().showPrompt(ba,2E3);return!0});P.setShowBlocking(!1);P.deleteAnalysis(v.getId())},O=function(){q=pa.getInputContent().trim();if(0<q.length){c=!0;var v=q=q.toUpperCase();ia();for(var A={},F=!0,P=0;P<t.length;P++)for(var da=t[P].getValue(),ba=aa[da],la=A[da]=0;la<ba.length;la++)J&&(F=ba[la].getViewType()==J),F&&-1<
ba[la].getName().toUpperCase().indexOf(v)&&(A[da]+=1);e.updateSearchUI(t,A)}else ia(),c=!1,e.setModel(t),e.updateUI()},Ca=function(v,A){L=v.getPropertyName();B=A==nc.SORT_TYPE_ASC?"ASC":"DESC";O()},Oa=function(v){var A=fa.getPublishLappConfigs();if(!(1>=A.length)){var F=$("<div>");F.addClass("sa-qing-publish-lapp-logo-header");E.layoutCtrlWithLRTB(F,null,72,100,-74,null,32);F.appendTo(v);for(var P=$("<div>"),da=A[0],ba=0;ba<A.length;ba++){var la=A[ba];if(fa.getLappUserType()==la.getLappUserType()){da=
la;break}}Ra(P,da);E.layoutCtrlWithLRTB(P,null,22,78,0,null,30);P.appendTo(F);var sa=$("<div>");sa.addClass("sa-qing-publish-lapp-logo-triangle-down");sa.appendTo(F);var xa=!1,Ha,Qa=function(Ua){E.isDescendent(Ua.target,F[0])||E.isDescendent(Ua.target,Ha[0])||(xa=!1,sa.removeClass("sa-qing-publish-lapp-logo-triangle-up"),sa.addClass("sa-qing-publish-lapp-logo-triangle-down"),Ha&&Ha.hide())};F.on("click",function(){xa?(sa.removeClass("sa-qing-publish-lapp-logo-triangle-up"),sa.addClass("sa-qing-publish-lapp-logo-triangle-down"),
Ha&&Ha.hide(),xa=!1,$(document.body).off("mousedown",Qa)):(sa.removeClass("sa-qing-publish-lapp-logo-triangle-down"),sa.addClass("sa-qing-publish-lapp-logo-triangle-up"),Ha&&Ha.remove(),Ha=ab(v,A),xa=!0,$(document.body).on("mousedown",Qa))})}},Ta=function(v){h.refreshUi(function(){v&&h.toggleLappContext(v);W=0;t=null;J=void 0;g.refreshCurrentPanel()})},Ra=function(v,A){if(A.getAppType()==hb.THIRDPARTY){var F=$("<img>");F.appendTo(v);E.layoutCtrl(F,0,0,78,30);v=fb.getLoadImgUrl(A.getAppImageFile(),
"image-library");F.attr("src",v)}else F="icon_"+A.getAppType(),Ma.background(v,F)},ab=function(v,A){var F=function(ba){var la=$("<div>");Ra(la,ba);la.on("click",function(){Ta(ba.getAppType())});return la},P=$("<div>");P.addClass("sa-qing-publish-lapp-logo-pane");P.appendTo(v);for(v=0;v<A.length;v++){var da=F(A[v]);E.layoutCtrl(da,0,32*v,78,30);da.css("margin-left","12px");v!=A.length-1&&da.css("border-bottom","1px solid #ccc");da.appendTo(P)}N?E.layoutCtrlWithLRTB(P,null,74,108,-1,null,32*A.length):
E.layoutCtrlWithLRTB(P,null,74,108,-41,null,32*A.length);return P},S=function(v){var A=[];fa.getQingAdminRole()&&A.push([b.get("lappManager","\u79fb\u52a8\u8f7b\u5e94\u7528\u7ba1\u7406"),R,null]);if(fa.getLappUserId()){var F=new Wa;F.setIconType(Wa.ICON_TYPE_QUESTION);F.setTipsSize(230,105);F.setTipsText(b.get("rolesHelpIconTips","\u7531\u4e8e\u53d1\u5e03\u5230\u201c\u79fb\u52a8\u8f7b\u5e94\u7528\u201d\u7684\u53d1\u5e03\u9879\u672c\u8eab\u7684\u7279\u6b8a\u6027\uff0c\u4ec5\u5728\u53d1\u5e03\u5f53\u65f6\u8bb0\u5f55\u4e0b\u7528\u6237\u4fe1\u606f\uff08\u89d2\u8272\u7edf\u4e00\u8f6c\u6362\u6210\u7528\u6237\uff09\u3002\u5f53\u7cfb\u7edf\u4e2d\u89d2\u8272\u6240\u5305\u542b\u7684\u7528\u6237\u53d1\u751f\u53d8\u5316\uff0c\u53ef\u5728\u6b64\u5904\u5237\u65b0\u6388\u6743\u3002"));
A.push([b.get("syncLappRoles","\u4e00\u952e\u540c\u6b65\u6240\u6709\u89d2\u8272"),ja,F])}if(0!=A.length){var P,da=!1,ba=$("<div>");ba.addClass("sa-qing-publish-lapp-setting");F=$("<div>");Ma.background(F,"icon-setting");F.appendTo(ba);var la=$("<span>");la.attr("title",b.get("setting","\u8bbe\u7f6e"));la.text(b.get("setting","\u8bbe\u7f6e"));la.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});la.appendTo(ba);var sa=function(xa){E.isDescendent(xa.target,ba[0])||E.isDescendent(xa.target,
P[0])||(da=!1,P&&P.hide())};ba.on("click",function(){if(da)P&&P.hide(),da=!1,$(document.body).off("mousedown",sa);else{if(!P){var xa=$("<div>");xa.addClass("sa-qing-publish-lapp-setting-selector");xa.appendTo(v);for(var Ha=0;Ha<A.length;Ha++){var Qa=A[Ha][2],Ua=A[Ha][0],rb=A[Ha][1],ob=$("<div>");ob.addClass("sa-qing-publish-lapp-setting-selector-item");ob.text(Ua);ob.on("click",rb);ob.appendTo(xa);Qa&&(Qa=Qa.getJqUi(),E.layoutCtrlWithLRTB(Qa,null,6,null,6+26*Ha,null,16),Qa.appendTo(xa))}N?E.layoutCtrlWithLRTB(xa,
null,0,null,-2,null,26*A.length):E.layoutCtrlWithLRTB(xa,null,0,null,-42,null,26*A.length);P=xa}P&&P.show();da=!0;$(document.body).on("mousedown",sa)}});E.layoutCtrlWithLRTB(ba,null,10,60,-40,null,0);E.layoutCtrlWithLRTB(F,null,40,18,-26,null,18);E.layoutCtrlWithLRTB(la,null,6,30,-28,null,26);ba.appendTo(v)}},R=function(){var v=!1,A=new Kb(d);A.setFunRefreshLappContext(function(P){h.refreshLappContext(P);v=!0});A.setCloseListener(function(){v&&Ta()});A.setOutMessageCurtain(h.getOuterMessageCurtain());
var F=h.getPublishContext();A.setParamPathPrefix(F.getParamPathPrefix());A.showDialog()},ja=function(){G(function(v){U(v,!0)})},U=function(v,A){var F=new va(d,function(P){K(P.permissionLappContexts,P.authorizedUserNum,P.failedUserNames,P.roleNames,P.permissionUsers,A)},function(){return!1});F.setShowBlocking(A);F.loadPermissionLappContexts(v,h.getCurrentAppType())},G=function(v){(new ka("lappAnalysisMgr",function(A){A||(A=[]);v(A)},function(A,F){h.getOuterMessageCurtain().showPrompt(F,2E3);return!0})).getAllPublishIds()},
K=function(v,A,F,P,da,ba){A=new ka("lappAnalysisMgr",function(la){ba&&(new Ic(F,P)).showDialog();var sa=la.addedPermissionUsers;la={};for(var xa in sa){for(var Ha=[],Qa=sa[xa],Ua=0;Ua<Qa.length;Ua++){var rb=Qa[Ua];da[rb]&&Ha.push(da[rb])}la[xa]=Ha}JSON.stringify(la)!=JSON.stringify({})&&(xa=new va(d),xa.setShowBlocking(ba),xa.saveMessage(la))},function(la,sa){h.getOuterMessageCurtain().showPrompt(sa,2E3);return!0});A.setShowBlocking(ba);A.batchUpdatePublishInfo(v)},wa=function(){var v=new oc;v.setOuterMessageCurtain(h.getOuterMessageCurtain());
v.setSelectedItemListener(I);v.setModel(t);v.setAddItemListener(ta);v.setUpdateItemListener(Ia);v.setDeleteItemListener(Fa);v.setLoadItemListener(Aa);return v},za=function(v){v=new Jc(v);v.setMessageCurtain(h.getOuterMessageCurtain());v.setDeleteCallback(Na);v.setEditCallback(ma);v.setEditPublishContentListenter(g.getPublishContentEditEntrance());v.setReSearchListener(O);return v},na={};this.getDirectoryMap=function(){return na};var ia=function(){for(var v=0;v<t.length;v++)aa[t[v].getValue()]=[];
for(v=0;v<y.length;v++){var A=aa[y[v].getParentId()];A&&A.push(y[v])}},Aa=function(v){if(null==t){var A=new ka("lappDirectoryMgr",function(F){for(var P=[],da=0;da<F.length;da++){var ba=new Lb;ba.fromJsonObject(F[da]);na[ba.getId()]=ba;var la=new Bb;la.setValue(ba.getId());la.setText(ba.getName());la.setIsPreset(ba.isPreset());P.push(la)}t=P;y=null;v(t);Ya()},function(F,P){h.getOuterMessageCurtain().showPrompt(P,2E3);return!0});A.setShowBlocking(!1);A.getOwnDirList(fa.getQingAdminRole(),fa.getQingAdminRoleUserId())}else v(t);
k&&"lightapp"==k.path&&k.lappPathName&&e.setDefaultItemValue(k.lappPathName)},Ya=function(){t&&0==t.length&&a&&a.setTipsText(b.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55"))},I=function(v){Q=v;a||(a=za(d));n=na[v.getValue()];null==k&&a.setAutoSelectedData(null);y?(a.setAllPublishModels(y),r.setAllPublishModels(y),f=aa[n.getId()],ra(!0)):(new ka("lappAnalysisMgr",function(A){X(A)},function(A,F){(void 0).showPrompt(F,2E3);return!0})).getAnalysisList(n.getId(),!0);k&&qa()},X=function(v){var A=
[];if(v&&v.content&&0<v.content.length){v=v.content;for(var F=[],P=[],da=0;da<v.length;da++){var ba=v[da],la=new Ba;la.fromJsonObject(ba);F.push(""+la.getCreateTime());P.push(""+la.getUpdateTime());la.setPreset(n.isPreset());A.push(la)}(new va(d,function(sa){if(sa&&sa.arrCreateTime&&sa.arrUpdateTime){var xa=sa.arrCreateTime;sa=sa.arrUpdateTime;for(var Ha=0;Ha<xa.length;Ha++){var Qa=A[Ha];Qa.setCreateFormatTime(xa[Ha]);Qa.setUpdateFormatTime(sa[Ha])}}y=A;ia();Y(y)},function(){return!1})).updateModelTime(F,
P)}else y=A,ia(),Y(y)},Y=function(v){for(var A=[],F=0;F<v.length;F++){var P=v[F].getUrl();P&&(P=u(P,"publishId"),A.push(P))}(new va(d,function(da){for(var ba=0,la=da.length;ba<la;ba++){var sa=new nb;sa.fromJsonObject(da[ba]);var xa=da[ba].id;V[xa]||(V[xa]=sa)}for(ba=0;ba<y.length;ba++)da=y[ba],la=da.getPublishId(),V[la]&&(da.setCarryData(V[la].getCarryData()),da.setSpaceID(V[la].getSpaceID()),da.setModifierName(V[la].getModifierName()));f=aa[n.getId()];r.setLappMapIdCardModelDetail(V);z.sort();a.setAllPublishModels(y);
r.setAllPublishModels(y)})).loadPublishInfoByPublishIdArr(JSON.stringify(A));return A},qa=function(){for(var v=0;v<f.length;v++)if(f[v].getPublishId()==k.id){a.setAutoSelectedData(k);k=null;break}},ta=function(v,A,F){var P=new Lb;P.setName(v);P.setSeq(ua(A));(new ka("lappDirectoryMgr",function(da){var ba=new Bb;ba.setValue(da);ba.setText(v);P.setId(da);na[da]=P;F(ba);O()},function(da,ba){h.getOuterMessageCurtain().showPrompt(ba,2E3);return!0})).saveGroup(P)},ua=function(v){var A=!1,F;for(F in na){var P=
na[F];v<P.getSeq()&&(v=P.getSeq(),A=!0)}A&&(v+=1);return v},Ia=function(v,A,F){var P=na[v];if(P){var da=P.getName();P.setName(A);(new ka("lappDirectoryMgr",function(ba){F(ba)},function(ba,la){P.setName(da);h.getOuterMessageCurtain().showPrompt(la,2E3);return!0})).saveGroup(P)}},Fa=function(v,A){aa[v]&&(0==aa[v].length?(new ka("lappDirectoryMgr",function(F){delete na[v];delete aa[v];A();h.getOuterMessageCurtain().showSuccess(b.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(F,P){h.getOuterMessageCurtain().showPrompt(P,
2E3);return!0})).deleteGroup(v):h.getOuterMessageCurtain().showPrompt(b.get("deleteNotEmpty","\u8bf7\u5148\u5220\u9664\u76ee\u5f55\u4e0b\u7684\u53d1\u5e03\u8bb0\u5f55\u3002"),2E3))},Na=function(v,A){var F=v.getId(),P=new ka("lappAnalysisMgr",function(da){da=h.createFacade(function(ba){ba=y.indexOf(v);-1!==ba&&y.splice(ba,1);for(ba=0;ba<y.length;ba++)if(y[ba].getId()==F){y.splice(ba,1);break}r.setAllPublishModels(y);a.setAllPublishModels(y);O();na[v.getParentId()].minus();A();h.getOuterMessageCurtain().showSuccess(b.get("deleteSuccess",
"\u5220\u9664\u6210\u529f\u3002"))},function(ba,la){h.getOuterMessageCurtain().showPrompt(la,2E3);return!0});da.setShowBlocking(!1);da.deletePublishInfo(ya.MOBILE,v.getPublishId())},function(da,ba){h.getOuterMessageCurtain().showPrompt(ba,2E3);return!0});P.setShowBlocking(!1);P.deleteAnalysis(v.getId())},ma=function(v,A){h.createFacade(function(F){var P=new nb;P.fromJsonObject(F);F=new Kc(d);F.setHasLappContext(!0);F.setPublishContext(h.getPublishContext());F.setPathSelectorModel(t);F.setPublishModel(v);
F.setDeskPublishModel(P);P=F.getEditPublishSuccessCallback();var da=b.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f");F=new Lc(da,F);P&&F.addSuccessCallback(P);F.addSuccessCallback(A);F.setOuterMessageCurtain(h.getOuterMessageCurtain());F.setFunCrateFacade(h.createFacade);F.showDialog()},function(F,P){return 2301001==F?(h.getOuterMessageCurtain().showPrompt(b.get("publishSourcePublishNotExistException","\u539f\u53d1\u5e03\u4fe1\u606f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002")),
!0):!1}).loadPublishInfo(v.getPublishId())},Z=function(v,A){var F=$("<span>");F.text(v);F.attr("title",v);F.addClass("sa-qing-publish-workbutton");F.addClass("qing-publish-ellipsis-text");if(A)F.on("click",A);return F}}function Kb(d){db.call(this);var u=this,g=this.protectedMethod,h=this.showDialog,e,a,f,l,r,D,C,w;this.setFunRefreshLappContext=function(k){C=k};this.setCloseListener=function(k){w=k};this.setOutMessageCurtain=function(k){a=k};this.setParamPathPrefix=function(k){D=k};this.showDialog=
function(){u.setSize(486,480);g.setTitle(b.get("lappManager","\u79fb\u52a8\u8f7b\u5e94\u7528\u7ba1\u7406"));g.setSelectable(!0);g.setContentPaneCreator(n);g.setClosingChecker2(function(k){r.getCurrentTabPane().check(e,k)},function(k){k(!0)},!0);g.setClosingAction(function(k){k&&r.getCurrentTabPane().commit(a);w&&w()});e=g.getMessageCurtain();h()};var n=function(){var k=$("<div>"),p=[];f=new Mc(d,e);f.setFunRefreshLappContext(C);l=new Nc(d,e,D);l.setFunRefreshLappContext(C);p.push(l);p.push(f);var m=
!0;r=new jb;r.setTabLevel(jb.SECOND_LEVEL);for(var t=0;t<p.length;t++)r.addTab(p[t],m),m=!1;r.addTabChangedListener(function(z,L){for(z=0;z<p.length;z++){var B=p[z];L!=B&&(B=B.getHelpIcon())&&(B=B.getJqUi(),Ma.background(B,"icon_help"))}if(B=L.getHelpIcon())B=B.getJqUi(),Ma.background(B,"icon_help_white")});t=r.getJqUi();E.layoutCtrl(t,0,0,454,364);t.appendTo(k);m=t.find(".sa-ctrl-tab-second-head");m.css({"padding-left":"18px","max-width":"180px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"});
for(t=0;t<m.length;t++){var c=$(m[t]);c.attr("title",p[t].getTitle());var q=p[t].getHelpIcon();q&&(c.css("padding-right","26px"),q=q.getJqUi(),q.css("z-index",2),q.appendTo(c),E.layoutCtrlWithLRTB(q,null,6,16,6,null,16))}return k}}function Nc(d,u,g){jb.AbstractTabPane.call(this);var h,e,a,f,l,r;this.setFunRefreshLappContext=function(q){r=q};this.getJqUi=function(){if(!h){h=$("<div>");l=$("<div>");E.layoutCtrl(l,10,10,466,23);l.appendTo(h);var q=new Da;q.setText(b.get("defineLappOrderDesc","\u5df2\u914d\u7f6e\u7684\u79fb\u52a8\u529e\u516c\u5e73\u53f0"));
q=q.getJqUi();q.css("font-size","14px");q.css("padding-right","26px");E.layoutCtrl(q,0,0,null,23);q.appendTo(l);var z=new Wa;z.setIconType(Wa.ICON_TYPE_QUESTION);z.setTipsSize(230,100);z.setTipsText(b.get("configuredLappTips","\u5f53\u7cfb\u7edf\u914d\u7f6e\u591a\u4e2a\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u65f6\uff0c\u53ef\u901a\u8fc7\u4e0a\u79fb\u6309\u94ae\u5b9a\u4e49\u53d1\u5e03\u5230\u79fb\u52a8\u8f7b\u5e94\u7528\u65f6\uff0c\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u7684\u663e\u793a\u987a\u5e8f\uff0c\u8c03\u6574\u540e\uff0c\u53d1\u5e03\u65f6\u9ed8\u8ba4\u4f7f\u7528\u7b2c\u4e00\u4e2a\u5df2\u540c\u6b65\u7528\u6237\u4fe1\u606f\u7684\u79fb\u52a8\u529e\u516c\u5e73\u53f0"));
z=z.getJqUi();E.layoutCtrlWithLRTB(z,null,6,16,5,null,16);z.appendTo(q);q=fa.getPublishLappConfigs();D(q,h)}return h};this.getTitle=function(){return b.get("defineLappOrder","\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u914d\u7f6e")};this.into=function(){};this.check=function(q,z){z(!0)};this.commit=function(q){for(var z=fa.getPublishLappConfigs(),L=[],B=0;B<z.length;B++)z[B].setOrderId(z.length-B),L.push(z[B].toJsonObject());(new va(d,function(y){q.showSuccess(b.get("updateSuccess","\u4fee\u6539\u6210\u529f\u3002"))},
function(){return!1})).updatePublishLappConfigs(L)};this.getHelpIcon=function(){if(!a){var q=$("<div>"),z=$("<span>");z.text(b.get("publishConfigHelpIconTips","\u53ef\u5b9a\u4e49\u53d1\u5e03\u5230\u79fb\u52a8\u8f7b\u5e94\u7528\u65f6\uff0c\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u7684\u663e\u793a\u987a\u5e8f\uff0c\u8fd8\u53ef\u6dfb\u52a0\u79fb\u52a8\u529e\u516c\u5e73\u53f0 "));z.appendTo(q);z=$("<a onclick='javascript:window.open(\""+pb.getMobileLightAppUrl()+"\");' href='#'>");z.text(b.get("viewDetails",
"\u67e5\u770b\u5e2e\u52a9\u6587\u6863"));z.css("cursor","pointer");z.css("color","#5582f3");z.appendTo(q);a=new Wa;a.setIconType(Wa.ICON_TYPE_QUESTION);a.setTipsSize(200,70);a.setTipsHtml(q[0])}return a};var D=function(q,z){var L=!1;e=[];for(var B=0;B<q.length;B++){var y=$("<div>");y.css("border-bottom","1px solid #E5E5E5");E.layoutCtrl(y,4,34+48*B,444,48);y.appendTo(z);var aa=q[B],V=$("<div>");V.css("margin-top","9px");var pa=V,N=aa;if(N.getAppType()==hb.THIRDPARTY){var W=$("<img>");W.appendTo(pa);
E.layoutCtrl(W,0,0,78,30);pa=fb.getLoadImgUrl(N.getAppImageFile(),"image-library");W.attr("src",pa)}else W="icon_"+N.getAppType(),Ma.background(pa,W);E.layoutCtrl(V,5,null,78,30);V.appendTo(y);V=$("<div>");V.appendTo(y);E.layoutCtrlWithLRTB(V,null,0,100,null,0,30);0!=B&&t(aa,q,V,z);aa.getAppType()==hb.THIRDPARTY&&(L=!0,w(aa,V),p(aa,V));e.push(y)}L||C(z,34+48*q.length);0==q.length?(l.hide(),f&&f.css("top","16px")):l.show()},C=function(q,z){f=$("<div>");f.text(b.get("addLapp","\u6dfb\u52a0\u79fb\u52a8\u529e\u516c\u5e73\u53f0"));
f.attr("title",b.get("addLapp","\u6dfb\u52a0\u79fb\u52a8\u529e\u516c\u5e73\u53f0"));f.css("color","#3382F3");f.css("cursor","pointer");f.on("click",function(){m(!0)});E.layoutCtrl(f,10,z+16,200,30);f.appendTo(q)},w=function(q,z){q=$("<div>");q.attr("title",b.get("del","\u5220\u9664"));q.addClass("sa-qing-publish-lapp-setting-config-tool");Ma.background(q,"btn_delete");q.on("click",function(){var L=Sa.createFeedbackDialog();L.setOptionType(Sa.OPTION_OK_CANCEL);L.setMsgImageType(Sa.MSG_DELETE);L.setMessage(b.get("thirdpartyConfigDelTips",
"\u4ec5\u5220\u9664\u8be5\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5728\u6b64\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u4e0a\u7684\u53d1\u5e03\u8bb0\u5f55\u5c06\u4f1a\u4fdd\u7559\uff0c\u786e\u8ba4\u5220\u9664\u5417\uff1f"));L.setClosingChecker(function(B){B==Sa.RETURN_OK&&n();return!0});L.showDialog()});q.appendTo(z)},n=function(q){(new va(d,function(z){u.showSuccess(b.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"));k()},function(z,L){return!1})).deleteThirdPartyConfig()},
k=function(){r(function(){c();var q=fa.getPublishLappConfigs();D(q,h)})},p=function(q,z){q=$("<div>");q.attr("title",b.get("edit","\u7f16\u8f91"));q.addClass("sa-qing-publish-lapp-setting-config-tool");Ma.background(q,"btn_edit");q.on("click",function(){m(!1)});q.appendTo(z)},m=function(q){var z=new Oc(d);z.setCreateStatus(q);z.setOutMessageCurtain(u);z.setParamPathPrefix(g);z.setUpdateListener(k);z.showDialog()},t=function(q,z,L,B){var y=$("<div>");y.attr("title",b.get("move","\u4e0a\u79fb"));y.addClass("sa-qing-publish-lapp-setting-config-tool");
Ma.background(y,"btn_orderup");y.on("click",function(){c();for(var aa=0;aa<z.length;aa++)if(z[aa]==q){z[aa]=z[aa-1];z[aa-1]=q;D(z,B);break}});y.appendTo(L)},c=function(){for(var q=0;q<e.length;q++)e[q].remove();f&&f.remove()}}function Mc(d,u){jb.AbstractTabPane.call(this);var g,h,e,a,f,l,r;this.setFunRefreshLappContext=function(k){r=k};this.getJqUi=function(){g||(g=$("<div>"));if(!fa.getLappUserId())return 0==fa.getPublishLappConfigs().length?u.showPrompt(b.get("lappNull","\u8bf7\u5148\u914d\u7f6e\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u3002")):
u.showPrompt(b.get("lappUserIdNull","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\u3002")),h&&h.hide(),e&&e.hide(),g;fa.getDatacenterUUID()?D():C();return g};this.getTitle=function(){return b.get("modifyDatacenterName","\u4fee\u6539\u6570\u636e\u4e2d\u5fc3\u540d\u79f0")};this.into=function(){};this.check=function(k,p){if(fa.getLappUserId()){var m=a.getText();null==m||0==$.trim(m).length?(k.showPrompt(b.get("datacenterNameCanNotEmpty","\u6570\u636e\u4e2d\u5fc3\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002")),
p(!1)):50<m.length?(k.showPrompt(b.get("datacenterNameToLong","\u6570\u636e\u4e2d\u5fc3\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")),p(!1)):p(!0)}else 0==fa.getPublishLappConfigs().length?u.showPrompt(b.get("lappNull","\u8bf7\u5148\u914d\u7f6e\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u3002")):u.showPrompt(b.get("lappUserIdNull","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\u3002")),p(!1)};this.commit=function(k){var p=new ka("lappDatacenter",function(){k.showSuccess(b.get("updateSuccess",
"\u4fee\u6539\u6210\u529f\u3002"))},function(m,t){k.showPrompt(t,2E3);return!0});f.setAccountName(a.getText());p.updateDatacenterInfo(f)};this.getHelpIcon=function(){if(!l){var k=$("<div>"),p=$("<span>");p.text(b.get("datacenterHelpIconTips","\u6307\u5b9a\u5728\u8f7b\u5206\u6790\u79fb\u52a8\u8f7b\u5e94\u7528\u4e2d\u5207\u6362\u6570\u636e\u4e2d\u5fc3\u65f6\u6570\u636e\u4e2d\u5fc3\u7684\u663e\u793a\u540d\u79f0 "));p.appendTo(k);p=$("<a onclick='javascript:window.open(\""+pb.getMobileLightAppUrl()+"\");' href='#'>");
p.text(b.get("viewDetails","\u67e5\u770b\u5e2e\u52a9\u6587\u6863"));p.css("cursor","pointer");p.css("color","#5582f3");p.appendTo(k);l=new Wa;l.setIconType(Wa.ICON_TYPE_QUESTION);l.setTipsSize(180,70);l.setTipsHtml(k[0])}return l};var D=function(){h&&h.hide();if(e)e.show();else{e=$("<div>");var k=new Da;k.setText(b.get("rName","\u540d\u79f0"));k=k.getJqUi();a=new bb;a.setText("");var p=a.getJqUi();E.layoutCtrl(k,10,20,448,23);E.layoutCtrl(p,8,50,434,23);E.layoutCtrl(e,0,0,"100%","100%");k.appendTo(e);
p.appendTo(e);e.appendTo(g);n(function(m){a.setText(m)})}},C=function(){e&&e.hide();if(h)h.show();else{h=$("<div>");var k=$("<span>");k.text(b.get("datacenterSyncFailed","\u6570\u636e\u4e2d\u5fc3\u672a\u540c\u6b65\u6210\u529f\uff0c"));k.appendTo(h);k=$("<span>");k.text(b.get("clickToSync","\u70b9\u51fb\u624b\u52a8\u540c\u6b65"));k.appendTo(h);k.css("color","#3382F3");k.css("cursor","pointer");k.on("click",w);E.layoutCtrl(h,126,130,250,23);h.appendTo(g)}},w=function(){gb.LappIntegration.syncDatacenterInfo(d,
function(){var k=new Sa;k.setOptionType(Sa.OPTION_OK);k.setMessage(b.get("syncDatacenterSuccess","\u6570\u636e\u4e2d\u5fc3\u540c\u6b65\u6210\u529f"));k.setClosedAction(function(){r(D)});k.showDialog()},function(){var k=new Sa;k.setOptionType(Sa.OPTION_OK);k.setMessage(b.get("syncDatacenterFail","\u6570\u636e\u4e2d\u5fc3\u540c\u6b65\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"));k.setClosedAction(function(){C()});k.showDialog()})},n=function(k){(new ka("lappDatacenter",function(p){f=new Xa;f.fromJsonObject(p);
k(f.getAccountName())},function(p,m){u.showPrompt(m,2E3);return!0})).getDatacenterInfo(fa.getDatacenterUUID())}}function Oc(d){db.call(this);var u=this,g=this.protectedMethod,h=this.showDialog,e,a,f,l,r,D,C,w,n,k,p,m,t={USER_NAME:b.get("userName","\u7528\u6237\u540d"),PHONE:b.get("phone","\u624b\u673a\u53f7"),EMAIL:b.get("email","\u7535\u5b50\u90ae\u7bb1")};this.setCreateStatus=function(J){f=J};this.setUpdateListener=function(J){m=J};this.setOutMessageCurtain=function(J){a=J};this.setParamPathPrefix=
function(J){};this.showDialog=function(){u.setSize(454,340);g.setTitle(f?b.get("addLapp","\u6dfb\u52a0\u79fb\u52a8\u529e\u516c\u5e73\u53f0"):b.get("thirdPartyConfig","\u7f16\u8f91\u79fb\u52a8\u529e\u516c\u5e73\u53f0"));g.setSelectable(!0);g.setContentPaneCreator(c);g.setClosingChecker(function(J){var Q=D.getText();null==Q||0==$.trim(Q).length?(e.showPrompt(b.get("appIdEmpty","\u8bf7\u8f93\u5165\u5e94\u7528ID\u3002")),J(!1)):Q&&50<Q.length?(e.showPrompt(b.get("appIdTooLong","\u5e94\u7528ID\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")),
J(!1)):w&&w.getAppImageFile()||p?y(Q,J):(e.showPrompt(b.get("appIconEmpty","\u8bf7\u4e0a\u4f20\u5e94\u7528\u56fe\u6807\u3002")),J(!1))},!0);g.setClosingAction(function(J){J&&(p?N(p,function(Q){V(Q)}):V())});e=g.getMessageCurtain();h()};var c=function(){Hb.getUrlParamValue("language");var J=$("<div>"),Q=q(J),H=new Da;H.setText(b.get("appId","\u79fb\u52a8\u529e\u516c\u5e73\u53f0ID"));H.setRequired(!0);H=H.getJqUi();H.attr("title",b.get("appId","\u79fb\u52a8\u529e\u516c\u5e73\u53f0ID"));H.appendTo(J);
var ca=new Wa;ca.setIconType(Wa.ICON_TYPE_QUESTION);ca.setTipsSize(180,70);ca.setTipsText(b.get("appIdHelpTips","\u8f7b\u5206\u6790\u4ea7\u54c1\u7814\u53d1\u56e2\u961f\u9881\u53d1\u7684\u79fb\u52a8\u529e\u516c\u5e73\u53f0ID\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003\u914d\u7f6e\u6587\u6863"));ca=ca.getJqUi();ca.appendTo(J);D=new bb;var ea=D.getJqUi();ea.appendTo(J);var T=new Da;T.setRequired(!0);T.setText(b.get("userIndentity","\u7528\u6237\u6807\u8bc6"));T=T.getJqUi();T.attr("title",b.get("userIndentity",
"\u7528\u6237\u6807\u8bc6"));T.appendTo(J);var M=new Wa;M.setIconType(Wa.ICON_TYPE_QUESTION);M.setTipsSize(180,70);M.setTipsText(b.get("userIndentityHelpTips","\u6784\u5efa\u5355\u70b9\u767b\u5f55\u94fe\u63a5\u65f6\u4f7f\u7528\u7684\u7528\u6237\u6807\u8bc6\u7c7b\u578b\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003\u914d\u7f6e\u6587\u6863"));M=M.getJqUi();M.appendTo(J);C=new kb;var ra=C.getJqUi();ra.appendTo(J);var x=new Da;x.setRequired(!0);x.setText(b.get("appIcon","\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u56fe\u6807"));
x=x.getJqUi();x.attr("title",b.get("appIcon","\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u56fe\u6807"));x.appendTo(J);var ha=new Wa;ha.setIconType(Wa.ICON_TYPE_QUESTION);ha.setTipsSize(180,50);ha.setTipsText(b.get("uploadIconHelpTips","\u5efa\u8bae\u4e0a\u4f20\u957f\u5bbd\u6bd4\u4e3a8:3\u7684\u56fe\u7247"));ha=ha.getJqUi();ha.appendTo(J);var Ka=new pc;Ka.appendInvislbelUiTo(J);Ka=L(Ka);Ka.appendTo(J);var Ga=z();Ga.appendTo(J);E.layoutCtrl(H,8,10,94,23);E.layoutCtrl(Q,0,10,16,16);E.layoutCtrl(ca,102,15,
16,16);E.layoutCtrl(ea,138,10,284,23);E.layoutCtrl(T,8,70,62,23);E.layoutCtrl(M,72,75,16,16);E.layoutCtrl(ra,138,70,284,23);E.layoutCtrl(x,8,130,104,23);E.layoutCtrl(ha,114,135,16,16);E.layoutCtrl(Ka,138,130,78,30);E.layoutCtrl(Ga,8,190,400,30);aa(function(Pa){w.getAppId()&&D.setText(w.getAppId());w.getAppUserType()?C.setSelected(t[w.getAppUserType()]):C.setSelected(t[Pa[0]]);for(var O=C,Ca=O.setItemModels,Oa=[],Ta=0;Ta<Pa.length;Ta++)Oa.push(t[Pa[Ta]]);Ca.call(O,Oa);w.getAppImageFile()?(l.show(),
l.attr("src",fb.getLoadImgUrl(w.getAppImageFile(),"image-library"))):r.show()});return J},q=function(J){var Q=!1,H=!1,ca=!1,ea=function(M){var ra=M.type;M=M.keyCode;ra&&"mousedown"===ra&&(H=!0);ra&&M&&"keydown"===ra&&"17"==M&&(Q=!0);Q&&H&&!ca&&(ca=!0,ra=$("<div>"),ra.text(n),ra.appendTo(J),E.layoutCtrl(ra,6,210,200,23))},T=$("<div tabIndex=-1 style='outline: none;'>");T.on("mousedown",ea);T.on("keydown",ea);T.addClass("sa-qing-publish-edit-star");T.css("cursor","pointer");T.appendTo(J);return T},
z=function(){var J=$("<a>");J.text(b.get("downloadThirdpartyConfigFile","\u70b9\u51fb\u4e0b\u8f7d  \u8f7b\u5206\u6790\u96c6\u6210\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u914d\u7f6e\u6587\u6863"));J.attr("title",b.get("downloadThirdpartyConfigFile","\u70b9\u51fb\u4e0b\u8f7d  \u8f7b\u5206\u6790\u96c6\u6210\u79fb\u52a8\u529e\u516c\u5e73\u53f0\u914d\u7f6e\u6587\u6863"));J.attr("href","#");J.css("color","#3382F3");J.css("cursor","pointer");J.on("click",function(){window.open(Kb.LAPP_CONFIGURE_FILE_URL+fa.getScene())});
return J},L=function(J){var Q=$("<div>");Q.addClass("sa-qing_publish-lapp-thirdparty-config");Q.attr("title",b.get("uploadImage","\u70b9\u51fb\u4e0a\u4f20\u56fe\u7247"));r=$("<div>");r.addClass("sa-qing_publish-lapp-thirdparty-config-add");E.layoutCtrl(r,30,6,16,16);r.appendTo(Q);r.hide();var H=B(Q);H.hide();l=$("<img>");E.layoutCtrl(l,0,0,"100%","100%");l.appendTo(Q);l.hide();Q.on("mouseenter",function(){(w&&w.getAppImageFile()||p)&&H.show()});Q.on("mouseleave",function(){(w&&w.getAppImageFile()||
p)&&H.hide()});Q.on("mousedown",function(ca){J.selectFile(pa,".jpg, .png, .bmp, .gif",function(ea){return 0==ea.indexOf("image/")})});return Q},B=function(J){var Q=$("<div>");Q.css("z-index","1");Q.css("background","rgba(85, 85, 85, 0.69");E.layoutCtrlWithLRTB(Q,0,0,null,0,0,null);Q.appendTo(J);J=$("<div>");Ma.background(J,"btn_edit_white");E.layoutCtrl(J,30,6,16,16);J.appendTo(Q);return Q},y=function(J,Q){(new ka("tools",function(H){H?Q(!0):(e.showPrompt(b.get("appIdNotFound","\u8bf7\u6839\u636e\u914d\u7f6e\u6587\u6863\u8f93\u5165\u6b63\u786e\u7684\u79fb\u52a8\u529e\u516c\u5e73\u53f0ID\u3002")),
Q(!1))},function(H,ca){g.getMessageCurtain().showPrompt(ca,2E3);return!0})).isExistedThirdpartyInfo(J,n,k)},aa=function(J){(new va(d,function(Q){w=new Pc;w.fromJsonObject(Q.thirdPartyConfig);n=Q.licenseCode;k=Q.timestamp;J(Q.appUserTypes)},function(Q,H){return!1})).loadThirdPartyConfig()},V=function(J){w.setAppId(D.getText());W();J&&w.setAppImageFile(J);(new va(d,function(Q){a.showSuccess(b.get("successToSaveConfigInfo","\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\u6210\u529f\u3002"));m&&m()},function(Q,
H){return"1100021"==Q?(a.showPrompt(b.get("resourceLimit","\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\u5931\u8d25\uff0c\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002")),!0):"1100022"==Q?(a.showPrompt(b.get("fileNotImage","\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\u5931\u8d25\uff0c\u8be5\u6587\u4ef6\u7c7b\u578b\u4e0d\u662f\u56fe\u7247\u3002")),!0):!1})).updateThirdPartyConfig(w.toJsonObject())},pa=function(J){var Q=J.getFile();Q&&(J.isSizeLargeThan(20971520)?e.showPrompt(b.get("overSize","\u56fe\u7247\u5927\u5c0f\u4e0d\u80fd\u5927\u4e8e20M\u3002")):
J.isTypeMatched()?(J=URL.createObjectURL(Q),r&&r.hide(),l.show(),l.attr("src",J),p=Q):e.showPrompt(b.get("fileNotImage","\u8be5\u6587\u4ef6\u7c7b\u578b\u4e0d\u662f\u56fe\u7247\u3002")))},N=function(J,Q){var H=new Mb;H.setShowBlocking(!0);H.setText(b.get("uploadImage","\u6b63\u5728\u4e0a\u4f20\u56fe\u7247"));H.setRequestPreparer(function(ea){ea.append("filename",J)});H.setFinishedHandler(function(ea,T,M){ea&&(3099003==T?e.showError(M):e.showError(b.get("failToUploadImg","\u4e0a\u4f20\u56fe\u7247\u5931\u8d25\u3002")))});
H.setSuccessHandler(function(ea){Q(ea.data)});var ca=Nb.getUploadUrl();H.uploadTo(ca)},W=function(){for(var J in t)if(C.getSelected()==t[J]){w.setAppUserType(J);break}}}function Ic(d,u){db.call(this);var g=this,h=this.protectedMethod,e=this.showDialog;this.showDialog=function(){g.setSize(430,420);h.setTitle(b.get("synchronizationCompleted","\u540c\u6b65\u5b8c\u6210"));h.setSelectable(!0);h.setContentPaneCreator(a);h.setFooterClosingOnly(!0);h.setClosingChecker2(null,function(f){h.destroy();return!0});
h.setClosingAction(function(f){});e()};var a=function(){var f=$("<div>"),l=$("<div>");l.addClass("sa-role-permission-tip");l.css("display","block");l.css("background-color","#33CC99");l.text("\u221a");l.appendTo(f);E.layoutCtrl(l,4,6,16,16);l=$("<div>");l.css("font-size","14px");0==u.length?l.text(b.get("noUpdateLappRoles","\u6ca1\u6709\u5df2\u6388\u6743\u7684\u89d2\u8272\uff0c\u672c\u6b21\u540c\u6b65\u672a\u5bf9\u89d2\u8272\u8fdb\u884c\u66f4\u65b0")):l.text(b.get("updateLappRolesSucess","\u5df2\u6210\u529f\u66f4\u65b0\u4ee5\u4e0b#1\u4e2a\u89d2\u8272\uff1a").replace("#1",
u.length));l.appendTo(f);E.layoutCtrl(l,30,8,350,16);l="";for(var r=0;r<u.length;r++)l+=u[r],r<u.length-1&&(l+="\uff0c");r=$("<div>");r.css("color","#828282");r.css("overflow-y","auto");r.text(l);r.appendTo(f);E.layoutCtrl(r,30,46,350,100);if(d&&0<d.length){l=$("<div>");l.addClass("sa-role-permission-tip");l.css("display","block");l.text("!");l.appendTo(f);E.layoutCtrl(l,4,150,16,16);l=$("<div>");l.css("font-size","14px");l.text(b.get("getLappUserFail","\u83b7\u53d6\u4ee5\u4e0b#1\u4e2a\u7528\u6237\u7684\u79fb\u52a8\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u5148\u540c\u6b65\u79fb\u52a8\u8f7b\u5e94\u7528\u8d26\u53f7\uff1a").replace("#1",
d.length));l.appendTo(f);E.layoutCtrl(l,30,152,350,32);l="";for(r=0;r<d.length;r++)l+=d[r],r<d.length-1&&(l+="\uff0c");r=$("<div>");r.css("color","#828282");r.css("overflow-y","auto");r.text(l);r.appendTo(f);E.layoutCtrl(r,30,208,350,98)}return f}}function Lc(d,u){db.call(this);var g=this,h=this.protectedMethod,e=[],a,f;(function(){h.setTitle(d);g.setSize(u.getWidth(),u.getHeight());h.setSelectable(!0);u.setOuterMessageCurtain(h.getMessageCurtain());u.setFuncReSize(h.getDialogCtrl().setBounds);h.setContentPaneCreator(function(){return u.getJqUi()});
h.setClosingChecker(function(n){l(n)},!0);h.setClosingAction(function(n){})})();this.setOuterMessageCurtain=function(n){a=n};this.setFunCrateFacade=function(n){f=n};this.addSuccessCallback=function(n){e.push(n)};var l=function(n){var k=u.checkUIInput(function(p,m){p?D(function(){var t=u.getModelFromUI(),c=function(L){L=fa.getScene();var B=fa.getEId(),y=u.getModelFromUI();(new ka("lappAnalysisMgr",function(aa){r(y,function(){var V=function(){!m&&a.showSuccess(b.get("updateSuccess","\u4fee\u6539\u6210\u529f\u3002"));
var pa=u.getDeskModelFromUI();if(e&&0<e.length)for(var N=0;N<e.length;N++){var W=e[N];W&&W(y,pa)}n(!0)};u.getThumbnailInfo()?f(function(pa){V()},function(pa,N){h.getMessageCurtain().showPrompt(b.get("updateFailed","\u4fee\u6539\u5931\u8d25\u3002")+N,2E3);return!0}).updateThumbnailInfo(u.getThumbnailInfo(),y.getName()):V()})},function(aa,V){h.getMessageCurtain().showPrompt(b.get("updateFailed","\u4fee\u6539\u5931\u8d25\u3002")+V,2E3);return!0})).saveAnalysis(y,B,L,!0)},q=f(c,function(L,B){2301001==
L?c():h.getMessageCurtain().showPrompt(B,2E3);return!0}),z=u.getDeskModelFromUI();z.setFailedUserIds(u.getFailedUserIds());z.setName(t.getName());z.setPath("lightapp");q.updatePublishInfo(ya.MOBILE,z,null,Ob.UPDATE_ALL,t.getName())}):n(p)});k&&(h.getMessageCurtain().showPrompt(k,2E3),n(!1))},r=function(n,k){var p=u.getThumbnailChange();u.getThumbnailPath()&&p&&fa.isPrivate()?w(u.getPublishModel().getId(),function(m){u.setThumbnailPath(m);n.setLargeThumbnail(m);k()}):k()},D=function(n){var k=u.getThumbnailChange(),
p=u.getThumbnailPath();if(p)if(k){var m=u.getPublishModel().getLargeThumbnail();k=function(c){m=c;m!==p?C(p,function(q){u.setThumbnailPath(q);n()}):(u.setThumbnailPath(u.getPublishModel().getLargeThumbnail()),n())};if(m){var t=m.lastIndexOf(".");t=m.substring(t+1);m=tb.downloadImage(m);(new com.kingdee.bos.qing.imagelib.choose.ui.ImageBase64Tool).changeToBase64(m,t,k)}else k()}else u.setThumbnailPath(u.getPublishModel().getLargeThumbnail()),n();else u.setThumbnailPath(""),n()},C=function(n,k,p){p=
new ka("image",function(m){k(m)},function(m,t){return!1});p.setShowBlocking(!1);p.uploadBase64Image(n)},w=function(n,k){var p=new ka("lappAnalysisMgr",function(m){var t=new Ba;t.fromJsonObject(m);k(t.getLargeThumbnail())},function(m,t){return!1});p.setShowBlocking(!1);p.getAnalysisInfoById(n)}}function Kc(d){lb.call(this,d);var u=this,g=this.protectedMethod,h=!0,e,a,f,l,r,D,C,w,n,k,p,m,t,c,q,z,L;this.setPublishModel=function(H){n=H};this.getPublishModel=function(){return n};this.setDeskPublishModel=
function(H){k=H};this.setPathSelectorModel=function(H){p=H};this.setThumbnailPath=function(H){z=H};this.getThumbnailPath=function(){return z};this.getThumbnailChange=function(){return L};this.getFailedUserIds=function(){return t};this.getWidth=function(){return 850};this.getHeight=function(){return 600};this.isEditPublish=function(){return!0};var B=function(){if(h){e.setText(n.getName());f.setText(n.getCardDesc());r.setText(n.getBottomAnnotation());for(var H=null,ca=0;ca<p.length;ca++){var ea=p[ca];
if(ea.getValue()==n.getParentId()){H=ea;break}}a.setSelected(H);H=new qc;H.setRoles(k.getRoles());H.setUsers(k.getUsers());H.setPermLabels(k.getPermLabels());w.setPermissionConfig(H)}y()||(k&&k.getThumbnailInfo()&&k.getThumbnailInfo().getSchedule()&&k.getThumbnailInfo().getSchedule().getPeriod()?l&&l.setModel(b.get("timingExtract","\u5b9a\u65f6\u66f4\u65b0")):l&&l.setModel(b.get("disposableExtract","\u4e0d\u66f4\u65b0")),n.isLandscape()&&D&&D.setOn(!0))},y=function(){return n.getViewType()==Ba.VIEW_TYPE_DASHBOARD};
this.protectedCreateContainer=function(){var H=$("<div>"),ca=$("<div>");ca.addClass("qing-publish-info-wrapper");ca.css("padding-right","10px");var ea=(new Da(b.get("publishSetting","\u53d1\u5e03\u8bbe\u7f6e\uff1a"))).getJqUi();ea.addClass("qing-publish-info-label");E.layoutCtrlWithLRTB(ea,0,0,null,0,null,23);ca.append(ea);var T=$("<div>");T.addClass("qing-publish-info-item");ea=new Da;var M=b.get("publishName","\u53d1\u5e03\u540d\u79f0");ea.setRequired(!0);ea.setText(M);ea.setTooltips(M);ea=ea.getJqUi();
ea.addClass("qing-publish-info-label");E.layoutCtrl(ea,0,0,105,23);T.append(ea);e=new bb;var ra=$("<div>");e.addEditedListener(function(){var Ka=new Pb;Ka.setPublishModel(n);Ka.editPublishNameListener(a.getSelected().getValue(),e,!0,!1,28,T,ra)});e.addBlurListener(function(){ra.remove()});ea=e.getJqUi();T.append(ea);E.layoutCtrl(ea,115,0,250,23);ea=new Da(b.get("publishPath","\u53d1\u5e03\u8def\u5f84"));ea.setRequired(!0);M=ea.getJqUi();M.addClass("qing-publish-info-label");E.layoutCtrl(M,0,0,105,
23);a=N();var x=a.getJqUi();E.layoutCtrl(x,115,0,250,23);ea=$("<div>");ea.addClass("qing-publish-info-item");ea.append(M);ea.append(x);M=$("<div>");M.css("margin-top","28px");M.addClass("qing-publish-info-items-block");M.append(T);M.append(ea);ca.append(M);ea=$("<div>");ea.addClass("qing-publish-info-items-block");ca.append(ea);var ha=new Da;x=ha.getJqUi();M=b.get("description","\u63cf\u8ff0");ha.setText(M);ha.setTooltips(M);x.addClass("qing-publish-info-label");E.layoutCtrl(x,0,0,105,23);f=new sb;
M=f.getJqUi();E.layoutCtrl(M,115,0,250,50);ha=$("<div>");ha.addClass("qing-publish-info-item");ha.css("height","50px");ha.append(x);ha.append(M);ea.append(ha);!y()&&k&&k.getThumbnailInfo()&&(x=new Da,M=b.get("thumbnail","\u7f29\u7565\u56fe"),x.setText(M),x.setTooltips(M),l=new vb,l.addActionListener(pa));ha=new Da;x=ha.getJqUi();M=b.get("bottomAnnotation","\u5e95\u90e8\u5907\u6ce8");ha.setText(M);ha.setTooltips(M);x.addClass("qing-publish-info-label");E.layoutCtrl(x,0,0,105,23);r=new bb;M=r.getJqUi();
E.layoutCtrl(M,115,0,250,23);ha=$("<div>");ha.addClass("qing-publish-info-item");ha.append(x);ha.append(M);ea.append(ha);x=new Da;M=b.get("displayStyle","\u5448\u73b0\u65b9\u5f0f");x.setText(M);x.setTooltips(M);M=x.getJqUi();M.addClass("qing-publish-info-label");E.layoutCtrl(M,0,0,105,23);x=g.getDisplayStyles();C=new kb;C.setItemModels(x);C.setSelected(n.getDisplayStyle()==Ba.DISPLAYSTYLE_THUMNAIL?x[0]:x[1]);x=C.getJqUi();y()?(n.getLargeThumbnail()&&(z=n.getFullLargeThumbnail()),c=aa()):c=V();E.layoutCtrl(c,
347,13,18,18);E.layoutCtrl(x,115,0,227,23);ha=$("<div>");ha.addClass("qing-publish-info-item");ha.append(M);ha.append(x);ha.append(c);ea.append(ha);!y()&&g.supportLandscape()&&(ha=new Da,x=ha.getJqUi(),M=b.get("landscapeDefault","\u9ed8\u8ba4\u6a2a\u5c4f\u6253\u5f00"),ha.setText(M),ha.setTooltips(M),x.addClass("qing-publish-info-label"),E.layoutCtrl(x,0,0,105,23),D=new qb,D.setOn(!1),M=D.getJqUi(),E.layoutCtrl(M,115,0,250,23),ha=$("<div>"),ha.addClass("qing-publish-info-item"),ha.append(x),ha.append(M),
ea.append(ha));ea=$("<div>");ea.addClass("qing-publish-info-wrapper");ea.css("padding-left","10px");w=g.createPermConfigPanel(null,u.getPublishContext().getSpaceID());M=w.getJqUi();ea.append(M);ca.appendTo(H);ea.appendTo(H);B();return H};var aa=function(){var H=$("<span>");H.addClass("sa-ctrl-f7selector-btn");H.addClass("sa-ctrl-f7selector-btnedit");H.css("cursor","pointer");H.attr("title",b.get("editThumbnailAndSchedule1","\u7f16\u8f91\u7f29\u7565\u56fe"));Ma.background(H,"btn_edit_on");var ca=function(ea,
T,M){q=T;M&&(L=M,z=ea)};H.on("click",function(){(new com.kingdee.bos.qing.imagelib.choose.ui.ChooseThumbnailDialog(z,q,ca)).show()});return H};this.protectedIsOnlyYzj=function(){return!1};var V=function(){var H=$("<span>");H.addClass("sa-ctrl-f7selector-btn");H.addClass("sa-ctrl-f7selector-btnedit");H.css("cursor","pointer");H.attr("title",b.get("editSchedule","\u7f16\u8f91\u66f4\u65b0\u7b56\u7565"));Ma.background(H,"btn_edit");H.on("click",function(){pa()});return H},pa=function(){var H=k.getThumbnailInfo(),
ca=H.copy();ca=new bc(null,null,ca);ca.setClosedCallback(function(ea,T){H=ea;H.getSchemaId()&&(h=!1);k.setThumbnailInfo(H);B()});ca.setSchedulable(!0);ca.showDialog()};this.getThumbnailInfo=function(){return k.getThumbnailInfo()};var N=function(){var H=new kb;H.setItemModels(p);H.setSelected(p[0]);H.setCustomPainter(function(ca,ea,T){ca=T.getText();ea.text(ca)});return H};this.getModelFromUI=function(){var H=new Ba;H.fromJsonObject(n.toJsonObject());y()&&H.setLargeThumbnail(z);H.setAuthorizedUsers(m);
H.setName(e.getText());H.setCardDesc(f.getText());H.setBottomAnnotation(r.getText());H.setParentId(a.getSelected().getValue());D&&H.setLandscape(D.isOn());C&&H.setDisplayStyle(C.getSelected().getValue());return H};this.getDeskModelFromUI=function(){var H=w?w.getPermissionConfig():null;if(H){var ca=H.getUsers();var ea=t;if(ea){for(var T=[],M=0;M<ca.length;M++){var ra=ca[M],x=ra.getValue();-1==ea.indexOf(x)&&T.push(ra)}ca=T}k.setUsers(ca);k.setRoles(H.getRoles());k.setPermLabels(H.getPermLabels())}return k};
var W=function(H){return null==H||0==$.trim(H).length},J=function(H){var ca=new com.kingdee.bos.qing.imagelib.model.ThumbnailUrlModel,ea=ca.getImagePathFromJson(q);ca.checkHasImage(ea,H)};this.checkUIInput=function(H){if(null==fa||!fa.getLappUserId())return b.get("lappUserIdNull","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25");var ca=e.getText();if(W(ca))return b.get("publishNameNotEmpty","\u8bf7\u8f93\u5165\u53d1\u5e03\u540d\u79f0");if(50<ca.length)return b.get("publishNameTooLong",
"\u8bf7\u8f93\u5165\u5c11\u4e8e50\u4e2a\u5b57\u7b26\u7684\u53d1\u5e03\u540d\u79f0");if(!a.getSelected())return b.get("publishPathNotEmpty","\u8bf7\u8f93\u5165\u53d1\u5e03\u8def\u5f84");if(50<f.getText().length)return b.get("descriptionCanNotExceedLimit50","\u63cf\u8ff0\u4e0d\u80fd\u8d85\u8fc750\u5b57\u7b26");if(!W(r.getText())&&50<r.getText().length)return b.get("bottomAnnotationCanNotExceedLimit50","\u5e95\u90e8\u5907\u6ce8\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26");var ea=function(){var T=function(){},
M=function(Pa){var O=[],Ca=w?w.getPermissionConfig():null;Ca&&(O=u.getUserIdsByValueTextPair(Ca.getUsers()));O=g.getNotDuplicatedUserIds(O,Pa);g.getLappContextsByUserSelector(O,function(Oa,Ta,Ra,ab){ab&&ab();m=Oa;t=Ta;ca!=n.getName()||a.getSelected().getValue()!=n.getParentId()?(Oa=new ka("lappAnalysisMgr",function(S){!0===S?(g.getOuterMessageCurtain().showPrompt(b.get("duplicateName","\u201c\u53d1\u5e03\u540d\u79f0\u201d\u5df2\u5b58\u5728\u3002"),2E3),H(!1)):H(!0,Ra)},function(S,R){g.getOuterMessageCurtain().showPrompt(R,
2E3);H(!1);return!0}),Oa.setShowBlocking(!1),Oa.isAnalysisNameDuplicate(a.getSelected().getValue(),ca)):H(!0,Ra)},function(){H(!1);return!0})},ra=[],x=[],ha=w?w.getPermissionConfig():null;if(ha){var Ka=ha.getRoles();if(Ka&&0<Ka.length)for(var Ga=0;Ga<Ka.length;Ga++)ra.push(Ka[Ga].getValue());if((ha=ha.getPermLabels())&&0<ha.length)for(Ga=0;Ga<ha.length;Ga++)x.push(ha[Ga].getId())}0<ra.length||0<x.length?(new va(d,M,T)).loadUserIdsByRoleIdAndPermLabelId(ra,x,null,k.getId()):M([])};J(function(T){T?
ea():(g.getOuterMessageCurtain().showPrompt(b.get("imgHasBeenDeleted","\u201c\u7f29\u7565\u56fe\u201d\u5f15\u7528\u7684\u56fe\u7247\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")),H(!1))})};this.getEditPublishSuccessCallback=function(){return Q};var Q=function(){}}function Jc(d){var u,g,h,e,a=[],f={},l={},r=[],D,C,w,n,k,p,m,t,c,q,z;this.getSelectedPublish=function(){return l?Object.values(l):[]};this.getSelectedPublishMap=function(){return l};this.setSelectedPublishMap=function(N){l=
N?N:{}};this.setPaginationBar=function(N){z=N};this.setAutoSelectedData=function(N){m=N};this.setSearchStatus=function(N){t=N};this.setMessageCurtain=function(N){p=N};this.setDeleteCallback=function(N){C=N};this.setEditCallback=function(N){w=N};this.setThumbnailSettingCallback=function(N){n=N};this.setEditPublishContentListenter=function(N){k=N};this.setReSearchListener=function(N){c=N};this.getJqUi=function(){u||(u=$("<div>"),u.addClass("sa-qing-publish-manager-content-container"),h=$("<div>"),h.appendTo(u),
g=$("<div>"),g.addClass("sa-qing-publish-manager-content-emptytip"),g.appendTo(u),e=$("<div>"),e.css("margin-left","10px"),e.appendTo(u));return u};this.setTipsText=function(N){D=N;g&&e&&(g.text(D),g.show(),e.hide())};this.setAllPublishModels=function(N){q=N};this.setAnalysisModels=function(N,W,J){r=N;J&&(l={},f={});V();h.addClass("sa-qing-publish-no-data-tips");Ma.background(h,"no-data");h.css("transform","scaleX(0.85) scaleY(0.85)");if(null==r||0==r.length)t?g.text(b.get("emptySearchTips","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):
g.text(b.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55")),h.show(),g.show(),e.hide();else if(h.hide(),g.hide(),e.show(),e.empty(),0<r.length){a=[];N=0<Object.keys(l).length;for(J=0;J<r.length;J++){var Q=new Qc(r[J],W[r[J].getPublishId()],p);Q.setAllPublishModels(q);Q.setDeleteCallback(C);Q.setDeletedListener(y);Q.setThumbnailSettingCallback(n);Q.setEditCallback(w);Q.setEditPublishContentListenter(k);Q.setReSearchListener(c);Q.setCheckedListener(aa);Q.setAlwaysShowCheckBox(N);l[r[J].getId()]&&
(f[r[J].getId()]=Q,Q.setChecked(!0));a.push(Q);Q=Q.getJqUi();if(m&&r[J].getPublishId()==m.id){var H=Q;m=null}Q.appendTo(e)}H&&L(H)}};this.updateSearchContentUI=function(N){if(t){var W=u.find(".sa-publish-item"),J;for(J in r){var Q=void 0,H=W[J],ca=r[J].getName();if(H&&ca&&N){var ea=N.toUpperCase(),T=ca.toUpperCase(),M=T.split(ea),ra=ea.length,x=$("<div>");x.addClass("sa-publish-item-head-name sa-qing-publish-fontfamily");for(Q in M){var ha=T.indexOf(M[Q]),Ka=ca.substr(0,M[Q].length);ha+=M[Q].length;
var Ga=T.length-ha;T=T.substr(ha,Ga);ca=ca.substr(ha,Ga);ha=$("<span>");ha.text(Ka);ha.appendTo(x);if(Q!==M.length-1&&1<M.length){Ga=T.indexOf(ea);Ka=ca.substr(Ga,ra);Ga+=ra;var Pa=T.length-Ga;T=T.substr(Ga,Pa);ca=ca.substr(Ga,Pa);Ga=$("<span>");Ga.text(Ka);Ga.css("color","#FF0000");Ga.appendTo(ha)}$(H.children[0]).children(".sa-publish-item-head-name.sa-qing-publish-fontfamily").remove()}x.appendTo(H.children[0]);x.attr("title",x.text())}}}};var L=function(N){B("sa-qing-publish-manager-content-container",
N);N.parent().children(".publish-card-selected").removeClass("publish-card-selected");N.addClass("publish-card-blink");N.addClass("publish-card-selected");setTimeout(function(){N.parent().children(".publish-card-blink").removeClass("publish-card-blink")},2E3)},B=function(N,W){document.querySelector("."+N).scrollTop=W.prop("offsetTop")},y=function(N){for(var W=0;W<r.length;W++)if(r[W].getId()==N.getId()){r.splice(W,1);break}},aa=function(N,W){W&&(W=N.getPublishModel().getId(),N.isChecked()?(f[W]=N,
l[W]=N.getPublishModel(),1==Object.keys(l).length&&pa(!0,W)):(delete f[W],delete l[W],0==Object.keys(l).length&&pa(!1,W)),V())},V=function(){if(z){var N=Object.keys(l).length;z.refreshSelectedRowTotal(N)}},pa=function(N,W){for(var J=0;J<a.length;J++){var Q=N||a[J].getPublishModel().getId()!=W;a[J].setAlwaysShowCheckBox(N,Q)}}}function Qc(d,u,g){var h=this,e,a,f,l,r,D,C,w,n=!1,k=!1,p,m,t,c,q,z,L,B,y,aa;this.getPublishModel=function(){return d};this.setAlwaysShowCheckBox=function(T,M){k=T;w&&M&&(k?
w.show():w.hide())};this.setChecked=function(T){n=T;C&&C.setChecked(n)};this.isChecked=function(){return C?C.isChecked():n};this.setCheckedListener=function(T){z=T};this.setDeleteCallback=function(T){};this.setDeletedListener=function(T){c=T};this.setEditCallback=function(T){m=T};this.setAllPublishModels=function(T){y=T};this.setEditPublishContentListenter=function(T){t=T};this.setThumbnailSettingCallback=function(T){q=T};this.getThumbnailSettingCallback=function(){return q};this.getJqUi=function(){if(!e){e=
$("<div class='sa-publish-item'>");e.on("mouseenter",H);e.on("mouseleave",ca);e.on("click",ea);var T=$("<div class='sa-publish-item-head'>");if(d.isPreset()){var M=$("<div>");M.text(b.get("preset","\u9884\u7f6e"));M.addClass("sa-qing-publish-manager-card-name-preset-tag");M.appendTo(T)}d.getViewType()==Ba.VIEW_TYPE_DASHBOARD?(M=$("<div>"),Ma.background(M,"dashboard"),M.addClass("sa-qing-publish-manager-card-pic-type"),M.appendTo(T)):d.getViewType()==Ba.VIEW_TYPE_SQUARE?(M=$("<div>"),Ma.background(M,
"squareData"),M.addClass("sa-qing-publish-manager-card-pic-type"),M.appendTo(T)):d.getViewType()==Ba.VIEW_TYPE_LONGER&&(M=$("<div>"),Ma.background(M,"dataAnalysis"),M.addClass("sa-qing-publish-manager-card-pic-type"),M.appendTo(T));a=$("<div class='sa-publish-item-head-name sa-qing-publish-fontfamily'>");a.appendTo(T);l=$("<div class='sa-publish-item-head-op-container'>");l.appendTo(T);T.appendTo(e);T=cb.getIconUrl("lightapp/common","icon_chart_building.png");d.getLargeThumbnail()?T=tb.downloadImage(d.getLargeThumbnail()):
u&&u.getPublishSourceType()==zb.DASHBOARD&&(T=d.getFullLargeThumbnail());d.isPreset()||(N(),d.getDemo()||d.getScene()!=fa.getScene()||W());D=$("<img class='sa-publish-item-img'>");D.attr("src",T);D.appendTo(e);r=$("<div class='sa-publish-item-desc-container'>");f=$("<div class='sa-publish-item-desc-text sa-qing-publish-fontfamily'>");f.appendTo(r);r.appendTo(e);ca()}pa();return e};var V,pa=function(){f&&f.empty();a&&a.text(d.getName());a&&a.attr("title",d.getName());u&&u.getPublishSourceType()==zb.DASHBOARD&&
D.attr("src",d.getFullLargeThumbnail());if(f){var T=b.get("noDescFornow","\u6682\u65e0\u63cf\u8ff0");d.getCardDesc()&&(T=d.getCardDesc());var M=b.get("descriptionColons","\u63cf\u8ff0\uff1a")+T;T=$("<div>");var ra=$("<span>"),x=$("<span>");x.text(b.get("publishSourceColons","\u53d1\u5e03\u6765\u6e90\uff1a"));x.appendTo(T);if(u){var ha=u.getPublishSourceName();d.setPublishSourceName(ha)}ha?ra.text(u.getPublishSourceGroupName()+"/"+ha):(ha=$("<span>"),ha.text("!"),ha.addClass("sa-qing-publish-item-source-promt"),
ha.appendTo(T),d.getViewType()==Ba.VIEW_TYPE_DASHBOARD?ra.text(b.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u88ab\u5220\u9664")):(d.getViewType()==Ba.VIEW_TYPE_SQUARE||d.getViewType()==Ba.VIEW_TYPE_LONGER)&&ra.text(b.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664")));ra.appendTo(T);ra=b.get("permissionColons","\u6388\u6743\uff1a");if(u){if(u.isPreset())ha=u.getRoles(),x=u.getUsers(),ha=0==ha.length&&0==x.length?b.get("permissionNoRoleAndUserText","\u672a\u9009\u62e9\u89d2\u8272\u6216\u7528\u6237"):
0!=ha.length&&0!=x.length?b.get("roleAndUserNames","\u89d2\u8272\uff1a#1\uff0c\u7528\u6237\uff1a#2").replace("#1",getRoleOrUserNames(ha)).replace("#2",getRoleOrUserNames(x)):0!=ha.length?b.get("roleNames","\u89d2\u8272\uff1a#1").replace("#1",getRoleOrUserNames(ha)):b.get("userNames","\u7528\u6237\uff1a#1").replace("#1",getRoleOrUserNames(x)),ra+=ha;else{ha=u.getRoles();x=u.getUsers();var Ka=u.getPermLabels(),Ga="",Pa=b.get("comma","\u3001");ha&&0<ha.length&&(Ga+=b.get("permissionRolesText","\u89d2\u8272#1\u4e2a").replace("#1",
ha.length)+Pa);x&&0<x.length&&(Ga+=b.get("permissionUsersText","\u7528\u6237#1\u4e2a").replace("#1",x.length)+Pa);Ka&&0<Ka.length&&(Ga+=b.get("permLabelCount","\u6743\u9650\u6807\u7b7e#1\u4e2a").replace("#1",Ka.length)+Pa);Ga=0<Ga.length?Ga.slice(0,-1):b.get("noAuthTarget","\u672a\u9009\u62e9\u6388\u6743\u76ee\u6807");ra+=Ga}d.setRoles(u.getRoles());d.setUsers(u.getUsers());d.setPermLabels(u.getPermLabels())}ha=b.get("refreshData","\u66f4\u65b0\u6570\u636e");u&&u.getCarryData()&&(ha=b.get("notRefreshData",
"\u4e0d\u518d\u66f4\u65b0\u6570\u636e"));ha=b.get("isCarryDataColons","\u662f\u5426\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e\uff1a")+ha;x=$("<div>");x.text(M);M=$("<div>");M.text(ra);ra=$("<div>");ra.text(ha);f.append(x);f.append(T);f.append(M);f.append(ra)}};this.setReSearchListener=function(T){B=T};var N=function(){C=new Cb;z&&C.addCheckedListener(function(T,M){z(h,M||aa)});C.setChecked(n);w=C.getJqUi();w.on("click",function(T){T.stopPropagation()});E.layoutCtrlWithLRTB(w,null,8,18,11,null,
18);w.appendTo(e)},W=function(){p=$("<span>");p.addClass("sa-publish-item-head-op-item sa-publish-item-head-op-layout sa-publish-item-head-edit");Ma.background(p,"btn_edit");p.attr("title",b.get("edit","\u7f16\u8f91"));if(t){var T=[J,Q],M=[b.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f"),b.get("editPublishContentItem","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848")];L=new Qb(e,M,T);L.setOuterMessageCurtain(g);"3"==d.getViewType()&&L.setIsDashboardPublish(!0);p.on("click",function(ra){ra.stopPropagation();
L.show($(ra.currentTarget),d)})}else p.on("click",function(ra){clearTimeout(V);ra.stopPropagation();V=setTimeout(J,300)});!d.getDemo()&&p.appendTo(l)},J=function(T){var M=d.getParentId();m&&m(d,function(ra,x){M==ra.getParentId()?(d.setName(ra.getName()),d.setCardDesc(ra.getCardDesc()),d.setBottomAnnotation(ra.getBottomAnnotation()),d.setViewType(ra.getViewType()),d.setDisplayStyle(ra.getDisplayStyle()),u.setRoles(x.getRoles()),u.setUsers(x.getUsers()),u.setPermLabels(x.getPermLabels()),d.setLandscape(ra.isLandscape()),
d.setLargeThumbnail(ra.getLargeThumbnail()),pa()):(u.setRoles(x.getRoles()),u.setUsers(x.getUsers()),u.setPermLabels(x.getPermLabels()),e.remove(),c&&c(d),x=y.indexOf(d),y[x]=ra);B&&B()})},Q=function(T){t(T,function(M){M&&(T.setLargeThumbnail(M),M=tb.downloadImage(M),D.attr("src",M))},ya.MOBILE)},H=function(){r.show();l.find(".sa-publish-item-head-op-item").show();w&&w.show()},ca=function(){r.hide();l.find(".sa-publish-item-head-op-item").hide();L&&L.hide();!k&&w&&w.hide()},ea=function(T){C&&(aa=
!0,T=!C.isChecked(),C.setChecked(T),aa=!1)}}function Lb(){var d,u,g,h,e,a;this.setId=function(f){d=f};this.getId=function(){return d};this.setName=function(f){u!=f&&(u=f)};this.getName=function(){return u};this.getCompleteName=function(){return u+(g?" ("+g+")":"")};this.setAnalysesCount=function(f){g!=f&&(g=f)};this.getAnalysesCount=function(){return g?g:0};this.minus=function(){--g};this.setSeq=function(f){h=f};this.getSeq=function(){return h};this.setDeleted=function(f){e=f};this.setPreset=function(f){a=
f};this.isPreset=function(){return a};this.fromJsonObject=function(f){d=f.id;u=f.name;g=f.analyticalCount;h=f.seq;a=f.preset};this.toJsonObject=function(){var f={};f.id=d;f.name=u;f.isDeleted=e;f.seq=h;return f}}function Ba(){var d,u,g,h,e,a,f,l,r,D,C,w,n,k,p,m,t,c,q,z,L,B,y,aa,V=!1,pa,N=!1,W,J,Q,H=[],ca=[],ea=[],T=[],M,ra;this.getModifierName=function(){return ra};this.setModifierName=function(x){ra=x};this.getSpaceID=function(){return M};this.setSpaceID=function(x){M=x};this.getLappUserType=function(){return fa.getLappUserType()};
this.getUsers=function(){return ea};this.setUsers=function(x){ea=x};this.getPermLabels=function(){return T};this.setPermLabels=function(x){T=x};this.getCarryData=function(){return Q};this.setCarryData=function(x){Q=x};this.getRoles=function(){return ca};this.setRoles=function(x){ca=x};this.getPublishSourceName=function(){return J};this.setPublishSourceName=function(x){J=x};this.getCreateTime=function(){return k};this.setCreateTime=function(x){k=x};this.getCreateFormatTime=function(){return p};this.setCreateFormatTime=
function(x){p=x};this.getUpdateTime=function(){return m};this.setUpdateTime=function(x){m=x};this.getUpdateFormatTime=function(){return t};this.setUpdateFormatTime=function(x){t=x};this.setId=function(x){d=x};this.getId=function(){return d};this.setCreatorName=function(x){u=x};this.getCreatorName=function(){return k};this.setParentId=function(x){g=x};this.getParentId=function(){return g};this.setPublishId=function(x){c=x};this.getPublishId=function(){return c};this.setName=function(x){h=x};this.getName=
function(){return h};this.setScene=function(x){e=x};this.getScene=function(){return e};this.isFavorite=function(){return a};this.setFavorite=function(x){a=x};this.setShareCreator=function(x){w=x};this.getShareCreator=function(){return w};this.setShareTime=function(x){n=x};this.getShareTime=function(){return n};this.setCardDesc=function(x){f=x};this.getCardDesc=function(){return f};this.setUrl=function(x){l=x};this.getUrl=function(){return l};this.setSmallThumbnail=function(x){D=x};this.getSmallThumbnail=
function(){return D};this.setLargeThumbnail=function(x){C=x};this.getLargeThumbnail=function(){return C};this.getFullLargeThumbnail=function(){var x=this.getLargeThumbnail();return x=x?tb.downloadImage(x):cb.getIconUrl("lightapp/common","icon_dashboard_building.png")};this.setLayoutType=function(x){r=x};this.setUploadData=function(x){z=x};this.isUploadData=function(){return z};this.setQsId=function(x){L=x};this.getQsId=function(){return L};this.setSchemaId=function(x){B=x};this.getSchemaId=function(){return B};
this.setDemo=function(x){y=x};this.getDemo=function(){return y};this.isDeleted=function(){return aa};this.getViewType=function(){return q};this.setViewType=function(x){q=x};this.setAuthorizedUsers=function(x){H=x};this.getAuthorizedUsers=function(){return H};this.setPreset=function(x){V=x};this.isPreset=function(){return V};this.setBottomAnnotation=function(x){pa=x};this.getBottomAnnotation=function(){return pa};this.setLandscape=function(x){N=x};this.isLandscape=function(){return N};this.setDisplayStyle=
function(x){W=x};this.getDisplayStyle=function(x){return W};this.fromJsonObject=function(x){d=x.id;g=x.parentId;h=x.name;e=x.scene;a=x.favorite;f=x.description;l=x.url;C=x.largeThumb;D=x.smallThumb;z=x.withData;L=x.qsId;B=x.schemaId;y=x.demo;w=x.shareCreator;n=x.shareTime;aa=x.isDeleted;c=x.publishId;q=x.viewType;W=x.displayStyle;pa=x.bottomAnnotation;N=x.landscape;H=x.authorizedUsers;k=x.createTime;p=x.createFormatTime;m=x.updateTime;t=x.updateFormatTime;M=x.spaceId};this.toJsonObject=function(){var x=
{};x.id=d;x.creatorName=u;x.parentId=g;x.name=h;x.scene=e;x.favorite=a;x.description=f;x.url=l;x.layoutType=r;x.largeThumb=C;x.smallThumb=D;x.withData=z;x.qsId=L;x.schemaId=B;x.demo=y;x.shareCreator=w;x.shareTime=n;x.publishId=c;x.viewType=q;x.displayStyle=W;x.bottomAnnotation=pa;x.landscape=N;x.authorizedUsers=H;x.updateTime=m;x.createTime=k;x.PublishSourceName=J;x.Roles=ca;x.spaceId=M;return x}}function ub(d,u){this.toString=function(){return d};this.getValue=function(){return u}}function Ec(){var d,
u,g,h;this.setAnalysisId=function(e){d=e};this.setAuthorId=function(e){u=e};this.setAuthorName=function(e){g=e};this.setAuthorHeadUrl=function(e){h=e};this.toJsonObject=function(){var e={};e.analysisId=d;e.creatorId=u;e.creatorName=g;e.avatar=h;return e}}function Cc(){var d,u,g,h,e;this.isSuccess=function(){return d};this.getAuthorizedUsers=function(){return u};this.getFailedUserNames=function(){return g};this.getFailedUserIds=function(){return h};this.getOthersCount=function(){return e};this.fromJsonObject=
function(a){d=a.success;u=a.authorizedUsers;g=a.failedUserNames;h=a.failedUserIds;e=a.othersCount}}function Rc(d,u,g,h,e){db.call(this);var a=this,f=this.protectedMethod,l=this.showDialog,r,D,C,w;this.showDialog=function(){f.setTitle(d);a.setSize(480,570);f.setSelectable(!0);f.setContentPaneCreator(n);f.setClosingAction(function(c){});f.setClosingChecker(function(c){p(c)},!0);D=f.getMessageCurtain();l()};var n=function(){w||(w=$("<div>"),k(function(c,q,z){var L=new Db;L.addTabChangedListener(function(B,
y){C=y});L.addTab(Ea.YZJ_ROBOT,Za.getIconName(Ea.YZJ_ROBOT),Za.getPushUIPane(Ea.YZJ_ROBOT,g,t,D,h,e),!0,!1);c&&L.addTab(Ea.WXQYH_ROBOT,Za.getIconName(Ea.WXQYH_ROBOT),Za.getPushUIPane(Ea.WXQYH_ROBOT,g,t,D,h,e),!1,!1);z&&L.addTab(Ea.DINGDING,Za.getIconName(Ea.DINGDING),Za.getPushUIPane(Ea.DINGDING,g,t,D,h,e),!1,!1);q&&L.addTab(Ea.MISSION_CLOUD_SERVICE_ACCOUNT,Za.getIconName(Ea.MISSION_CLOUD_SERVICE_ACCOUNT),Za.getPushUIPane(Ea.MISSION_CLOUD_SERVICE_ACCOUNT,g,t,D,h,e),!1,c?!0:!1);c||L.addTab(Ea.WXQYH_ROBOT,
Za.getIconName(Ea.WXQYH_ROBOT)+"_off",null,!1,!1,b.get("wxqyhPushDisable","\u5f53\u524d\u73af\u5883\u6682\u672a\u914d\u7f6e\u4f01\u4e1a\u5fae\u4fe1\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u914d\u7f6e\u540e\u4f7f\u7528"));z||L.addTab(Ea.DINGDING,Za.getIconName(Ea.DINGDING)+"_off",null,!1,!1,b.get("dingdingPushDisable","\u5f53\u524d\u73af\u5883\u6682\u672a\u914d\u7f6e\u9489\u9489\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u914d\u7f6e\u540e\u4f7f\u7528"));q||L.addTab(Ea.MISSION_CLOUD_SERVICE_ACCOUNT,
Za.getIconName(Ea.MISSION_CLOUD_SERVICE_ACCOUNT)+"_off",null,!1,!0,b.get("missionCloudPushDisable","\u5f53\u524d\u73af\u5883\u6682\u672a\u914d\u7f6e\u7f8e\u4fe1\u4e91\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u914d\u7f6e\u540e\u4f7f\u7528"));L.getJqUi().appendTo(w)}));return w},k=function(c){var q=!1,z=!1,L=!1,B=new t(function(y){y[Ea.WXQYH_ROBOT]&&!0===y[Ea.WXQYH_ROBOT]&&(q=!0);y[Ea.MISSION_CLOUD_SERVICE_ACCOUNT]&&!0===y[Ea.MISSION_CLOUD_SERVICE_ACCOUNT]&&(z=!0);y[Ea.DINGDING]&&!0===y[Ea.DINGDING]&&
(L=!0);c(q,z,L)},function(y,aa){L=z=q=!1;c(q,z,L);return!0});B.setShowBlocking(!0);B.loadPushContext()},p=function(c){C.getModel(function(q){if(q){if(!C.checkWarningRuleExist())return f.getMessageCurtain().showPrompt(b.get("saveWarningRuleTips","\u9884\u8b66\u89c4\u5219\u4e0d\u5b58\u5728\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u6216\u5220\u9664\u3002")),c(!1),!1;m(q,c)}else c(!1)})},m=function(c,q){var z=C.getThumbnailModelBook(),L=g.getCurrentContentModel();(new t(function(B){q(!0);r||(r=new Rb,r.getJqUi().appendTo($(document.body)));
r.showSuccess(b.get("successToSaveConfigInfo","\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\u6210\u529f\u3002"));B=com.kingdee.bos.qing.behavior.BehaviorManager;B.recordResourceOperation(B.OperationType.QING_PUSH)},function(B,y){q(!1);return 4300101==B?(D.showError(b.get("failToSaveConfig","\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\u5931\u8d25\u3002")),!0):2301013==B?(D.showPrompt(b.get("NoMapCanNotSaveConfig","\u627e\u4e0d\u5230\u5f15\u7528\u7684\u5730\u56fe\u6a21\u677f\uff0c\u65e0\u6cd5\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\u3002"),
2E3),!0):2301016==B?(D.showPrompt(b.get("publishNoOperAuthException","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),!0):!1})).saveConfigInfo(c,L,z,g.getParamPathPrefix(),g.getDsbPublishId(),g.getScene())},t=function(c,q,z){return new va(u,c,q,z)}}function rc(){var d=this,u,g,h,e=!1,a,f,l,r,D,C,w,n,k,p,m,t="",c,q,z,L,B,y,aa,V=!1,pa,N;this.setDsbThumbnailDeleteCallBack=function(O){L=O};this.setModel=function(O){c=O;k=c.getName();n=c.getNameRule();w=c.getSchedule();t=c.getThumbnailPath();p=c.getCreateTime();
m=c.getCreateFormatTime()};this.getModel=function(O){d.protectedCheckUIInput()?ea(O):O(null)};this.setPushTargetType=function(O){h=O};this.getPushTargetType=function(){return h};this.setEditMode=function(O){e=O};this.setPublishContext=function(O){g=O};this.setOuterMessageCurtain=function(O){u=O};this.getOuterMessageCurtain=function(){return u};this.setCreateFacadeMethod=function(O){a=O};this.createFacade=function(){return a};this.getThumbnailCutPanel=function(){return C};this.getThumbnailModelBook=
function(){return C?C.getThumbnailInfo().getSchemaModelBook():null};this.setPushSchemaEditEntrance=function(O){q=O};this.getPushSchemaEditEntrance=function(){return q};this.setDesigner=function(O){B=O};this.getDesigner=function(){return B};this.isEmpty=function(O){return null==O||0==$.trim(O).length};this.protectedCheckUIInput=function(){};this.protectedGetModel=function(){return c};this.protectedGetModelFromUI=function(){};this.protectedGetGapHeight=function(){return 26};this.protectedGetJqCustomUI=
function(){};this.protectedGetCustomUIHeight=function(){};this.protectedGetStartY=function(){return 20};this.clear=function(){f&&(w=c=null,k=n="",l.setModel(null),r.setModel(null),D.setText(""))};this.getJqUi=function(){f||J();return f};var W=function(){var O=!1;if(c&&c.getSourceType()==zb.DASHBOARD||g&&g.getCurrentSourceType()==zb.DASHBOARD&&!e)O=!0;return O},J=function(){f=$("<div>");var O=W(),Ca=!(e&&!O),Oa=new Da;Oa.setRequired(!0);Oa.setText(b.get("pushName","\u540d\u79f0"));Oa=Oa.getJqUi();
l=new vb;l.addActionListener(Q);var Ta=l.getJqUi(),Ra=new Da;Ra.setRequired(!0);Ra.setText(b.get("pushTime","\u63a8\u9001\u9891\u7387"));Ra=Ra.getJqUi();Ra.attr("title",b.get("pushTime","\u63a8\u9001\u9891\u7387"));r=new vb;r.addActionListener(H);var ab=r.getJqUi();if(!W()){var S=new Da;S.setText(b.get("warningRule","\u9884\u8b66\u89c4\u5219"));S=S.getJqUi();S.attr("title",b.get("warningRule","\u9884\u8b66\u89c4\u5219"));pa=new vb;pa.addActionListener(M);pa.addClearListener(x);N=pa.getJqUi();if(!e){var R=
$("<span>");R.addClass("sa-qing-publish-edit-icon");R.attr("title",b.get("warningRuleEdit","\u7f16\u8f91\u9884\u8b66\u89c4\u5219"));Ma.backgroundWithHover(R,"icon-rule-setting");R.on("click",ha)}}var ja=d.protectedGetJqCustomUI(c),U=d.protectedGetCustomUIHeight(),G=new Da;G.setText(b.get("describe","\u63cf\u8ff0"));G=G.getJqUi();D=new sb;var K=D.getJqUi(),wa=d.protectedGetStartY(),za=Ca?50:230;c?(wa=c.getName(),null!=c.getNameRule()&&(wa=wa+"-\uff08"+b.get("systemDate","\u7cfb\u7edf\u65e5\u671f")+
"\uff09"),l.setModel(wa),w=c.getSchedule(),r.setModel(c.getSchedule().toString()),D.setText(c.getDescText()),wa=0,W()||(y=c.getWarningRuleName(),Ga(c.getWarningRuleName()))):W()||Pa();var na=d.protectedGetGapHeight(),ia=wa;E.layoutCtrl(Oa,27,ia,70,23);E.layoutCtrl(Ta,113,ia,310,23);ia=ia+23+na;E.layoutCtrl(ja,0,ia,435,U);ia=ia+U+na;E.layoutCtrl(Ra,27,ia,70,23);E.layoutCtrl(ab,113,ia,310,23);ia=ia+23+na;W()||(E.layoutCtrl(S,27,ia,70,23),e?E.layoutCtrl(N,113,ia,310,23):(E.layoutCtrl(N,113,ia,290,23),
E.layoutCtrl(R,405,ia-20,20,16)),ia=ia+23+na);E.layoutCtrl(G,27,ia,70,23);ia+=7;E.layoutCtrl(K,113,ia,310,za);Oa.appendTo(f);Ta.appendTo(f);Ra.appendTo(f);ab.appendTo(f);W()||(S.appendTo(f),N.appendTo(f),e||R.appendTo(f));ja.appendTo(f);G.appendTo(f);K.appendTo(f);Ca&&(O?(ia=ia+za+na,O=new Da,O.setText(b.get("thumbnail","\u7f29\u7565\u56fe")),O=O.getJqUi(),E.layoutCtrl(O,27,ia,70,23),O.appendTo(f),z=new com.kingdee.bos.qing.imagelib.choose.ui.ChooseThumbnailPane,z.setDsbThumbnailDeleteCallBack(function(Aa,
Ya,I){L&&L(Aa,Ya,I);z.getThumbnailUrlModel().getImageFileName()===Aa&&(Aa=wb.createWarning(),Aa.addClass("dm-entity-list-item-notexist"),Aa.attr("title",b.get("imgHasBeenDeleted","\u201c\u7f29\u7565\u56fe\u201d\u5f15\u7528\u7684\u56fe\u7247\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e")),E.layoutCtrl(Aa,93,ia),Aa.appendTo(f))}),z.setRemoveImgNotExistIconCallBack(function(){f.find(".dm-entity-list-item-notexist").remove()}),!t||-1<t.indexOf("{")?t=z.getThumbnailUrlModel().getImagePathFromJson(t):
c&&c.getThumbnailPath()&&(t=fb.getLoadImgUrl(c.getThumbnailPath(),"card-thumbnail")),O=z.init(t),ia+=8,E.layoutCtrl(O,113,ia,310,150),O.appendTo(f)):(ia=ia+za+na,O=new Da,O.setText(b.get("thumbnail","\u7f29\u7565\u56fe")),O=O.getJqUi(),C=new Ib(g,a,d.getOuterMessageCurtain()),C.setThumbnailSize(310,150),C.setSchedulable(!1),Ca=C.getJqUi(),E.layoutCtrl(O,27,ia,70,23),ia+=6,E.layoutCtrl(Ca,113,ia,310,150),O.appendTo(f),Ca.appendTo(f)))},Q=function(O,Ca,Oa){O=new Sc(k,n);O.setClosingListener(function(Ta,
Ra){k=Ta;n=null;Ra&&(n=Ra.getValue(),Ta=Ta+"-"+b.get("systemDate","\u7cfb\u7edf\u65e5\u671f"));l.setModel(Ta)});O.showDialog()},H=function(){var O=new Tc(w);O.setCreateFacadeMethod(a);O.setClosingListener(function(Ca){w=Ca;r.setModel(w.toString())});O.showDialog()},ca=function(O){if(z){var Ca=z.getDashboardThumbnailUrl(),Oa=new com.kingdee.bos.qing.imagelib.model.ThumbnailUrlModel;Ca=Oa.getImagePathFromJson(Ca);Oa.checkHasImage(Ca,O)}else O(!1)},ea=function(O){var Ca=D.getText();d.isEmpty(k)?(u.showPrompt(b.get("pushNameCanNotEmpty",
"\u8bf7\u8f93\u5165\u63a8\u9001\u540d\u79f0\u3002")),O(null)):d.isEmpty(w)?(u.showPrompt(b.get("pushTimeCanNotEmpty","\u8bf7\u8f93\u5165\u63a8\u9001\u65f6\u95f4\u3002")),O(null)):100<$.trim(Ca).length?(u.showPrompt(b.get("descToLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002")),O(null)):W()?ca(function(Oa){Oa?O(T()):(u.showPrompt(b.get("imgHasBeenDeleted","\u201c\u7f29\u7565\u56fe\u201d\u5f15\u7528\u7684\u56fe\u7247\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")),
O(null))}):O(T())},T=function(){var O=d.protectedGetModelFromUI();O.setPushTargetType(h);O.setName($.trim(k));O.setCreateTime(p);O.setCreateFormatTime(m);n&&O.setNameRule(n);O.setSchedule(w);O.setDescText($.trim(D.getText()));O.setWarningRuleName(y);O.setWarningRuleStatus(!0);if(c){if(O.setId(c.getId()),O.setTagId(c.getTagId()),O.setSourceType(c.getSourceType()),O.setOpenSchedule(c.getOpenSchedule()),O.setHasPermission(c.isHasPermission()),O.setSourceName(c.getSourceName()),O.setSchemaType(c.getSchemaType()),
O.setThumbnailPath(c.getThumbnailPath()),z&&z.isImageChange()){var Ca=z.getDashboardThumbnailUrl();O.setThumbnailPath(Ca)}}else C&&(Ca=C.getThumbnailInfo(),O.setApeLeft(Ca.getApertureLeft()),O.setApeTop(Ca.getApertureTop()),O.setScoLeft(Ca.getScrollLeft()),O.setScoTop(Ca.getScrollTop()),O.setApeWidth(Ca.getApertureWidth()),O.setApeHeight(Ca.getApertureHeight())),O.setTagId(g.getBizTag()),O.setSourceType(g.getCurrentSourceType()),O.setOpenSchedule(!0),z&&(Ca=z.getDashboardThumbnailUrl(),O.setThumbnailPath(Ca));
return O},M=function(O){e||null==B?(new com.kingdee.bos.qing.core.ui.WarningRuleSelector).showDialog(aa,y,ra,function(Ca){V=d.checkWarningRuleExist();Pa()}):B.getConductor().popupWarningRuleSelector(y,ra,function(Ca){V=d.checkWarningRuleExist();Pa()})},ra=function(O){y=O},x=function(O){y=null;Pa()},ha=function(O){null!=B&&B.getConductor().popupWarningRuleEditor(function(Ca){Ca&&(g.getCurrentContentModel().schemaContent=B.getJsonModelBook(),V=d.checkWarningRuleExist(),Pa())})};this.checkWarningRuleExist=
function(){return null==y||null!=B&&B.getConductor().checkWarningRuleExist(y)||null!=aa&&com.kingdee.bos.qing.core.ui.WarningRuleSelector.checkWarningRuleExist(aa,y)?!0:!1};var Ka=function(O){var Ca=new a(function(Ra){O(Ra.model)}),Oa=c.getId(),Ta=c.getPushTargetType();Ca.loadPushSchema(Oa,Ta)},Ga=function(){Ka(function(O){var Ca=com.kingdee.bos.qing.CodeLoader;Ca.setCallback(function(){aa=com.kingdee.bos.qing.ModelHelper.fromJson(O);V=d.checkWarningRuleExist();Pa()});Ca.setRootPath(".");Ca.loadJs("core/qing-scene.js")})},
Pa=function(){N.css("color","#666666");var O=N.find(".warning-rule-item-notexist");O&&O.remove();O=N.find(".sa-ctrl-f7selector-text");O.css("margin-left","0px");null==y&&(pa.setModel(b.get("warningRuleTips","\u8bf7\u9009\u62e9\u9884\u8b66\u89c4\u5219")),N.css("color","#b2b2b2"),N.attr("title",b.get("warningRuleTips","\u8bf7\u9009\u62e9\u9884\u8b66\u89c4\u5219")));null!=y&&V&&(pa.setModel(b.get("selectedWarningRule","\u5df2\u9009\u62e9\u9884\u8b66\u89c4\u5219")+y),N.attr("title",""));if(null!=y&&!V){pa.setModel(b.get("TheWarningRuleNotExist",
"\u9884\u8b66\u89c4\u5219#1\u4e0d\u5b58\u5728").replace("#1",y));N.attr("title","");var Ca=wb.createWarning();Ca.addClass("warning-rule-item-notexist");Ca.attr("title",b.get("warningRuleNotExist","\u9884\u8b66\u89c4\u5219\u4e0d\u5b58\u5728"));N.append(Ca);O.css("margin-left","16px")}y?pa.setClearable(!0):pa.setClearable(!1)}}function Sb(){Db.AbstractTabPane.call(this);rc.call(this);var d=this,u,g;this.into=function(){d.clear();g&&g.setModel("")};this.protectedGetModelFromUI=function(){var e=$.trim(g.getModel()),
a=new Tb;a.setWebhook(e);return a};this.protectedGetJqCustomUI=function(){if(!u){u=$("<div>");var e=new Da;e.setRequired(!0);e.setText("Webhook");var a=new Wa;a.setIconType(Wa.ICON_TYPE_QUESTION);a.setTipsSize(240,62);var f=pb.getMobileTimedPushUrl();f=$("<a onclick='javascript:window.open(\""+f+"\");' href='#'>");f.css({cursor:"pointer",color:"var(--color-main, #5582f3)"});f.text(b.get("helpDocument","\u5e2e\u52a9\u6587\u6863"));a.setTipsHtml(b.get("whatsWebhook","\u7fa4\u7ba1\u7406\u5458\u6dfb\u52a0\u7fa4\u7ec4\u673a\u5668\u4eba\u540e\uff0c\u5373\u53ef\u67e5\u770b\u7fa4\u7ec4\u673a\u5668\u4eba\u7684Webhook\u5730\u5740\u3002\u64cd\u4f5c\u65b9\u5f0f\u8bf7\u53c2\u8003")+
f.prop("outerHTML"));a=a.getJqUi();g=new vb;g.addActionListener(h);e=e.getJqUi();f=g.getJqUi();var l=d.protectedGetModel();l&&(g.setModel(l.getWebhook()),g.getJqUi().attr("title",g.getModel()));E.layoutCtrl(e,27,0,64,23);E.layoutCtrl(a,92,3,16,16);E.layoutCtrl(f,113,0,310,23);e.appendTo(u);a.appendTo(u);f.appendTo(u)}return u};this.protectedGetCustomUIHeight=function(){return 23};this.protectedGetStartY=function(){return 20};this.getEditWebhook=function(){return g};this.protectedGetGapHeight=function(){return 18};
this.protectedCheckUIInput=function(){var e=g.getModel();return d.isEmpty(e)?(d.getOuterMessageCurtain().showPrompt(b.get("webhookCanNotEmpty","\u8bf7\u8f93\u5165\u7fa4\u7ec4\u673a\u5668\u4ebaWebhook\u5730\u5740\u3002")),!1):!0};var h=function(){var e=new Uc(g.getModel());e.setPushTargetType(d.getPushTargetType());e.setClosingListener(function(a){g.setModel(a);g.getJqUi().attr("title",a)});e.showDialog()}}function Vc(d,u){db.call(this);var g=this,h=this.protectedMethod,e=this.showDialog,a,f,l,r,D;
this.setModel=function(w){r=w};this.setFinishedEditListener=function(w){l=w};this.setDsbThumbnailDeleteCallBack=function(w){D=w};this.showDialog=function(){h.setTitle(b.get("editSchedulePush","\u7f16\u8f91\u5b9a\u65f6\u63a8\u9001"));g.setSize(480,560);h.setSelectable(!0);h.setContentPaneCreator(C);h.setClosingAction(function(w){});h.setClosingChecker(function(w){f.getModel(function(n){if(null==n)w(!1);else{if(!f.checkWarningRuleExist())return h.getMessageCurtain().showPrompt(b.get("saveWarningRuleTips",
"\u9884\u8b66\u89c4\u5219\u4e0d\u5b58\u5728\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u6216\u5220\u9664\u3002")),w(!1),!1;w(!0);l&&l(n)}})},!0);a=h.getMessageCurtain();e()};var C=function(){var w=r.getPushTargetType();f=Za.getPushUIPane(w,u,d,a);f.setEditMode(!0);f.setPushTargetType(w);f.setModel(r);f.setDsbThumbnailDeleteCallBack(function(n,k,p){D&&D(n,k,p)});return f.getJqUi()}}function Sc(d,u){db.call(this);var g=this,h=this.protectedMethod,e=this.showDialog,a,f,l,r,D,C,w=[b.get("nameFixed","\u56fa\u5b9a\u540d\u79f0"),
b.get("nameDate","\u540d\u79f0+\u7cfb\u7edf\u65e5\u671f")];this.setClosingListener=function(k){C=k};this.showDialog=function(){g.setSize(480,340);h.setTitle(b.get("pushName","\u540d\u79f0"));h.setSelectable(!0);h.setContentPaneCreator(n);h.setClosingChecker(function(k,p){k=f.getText();return null==k||0==$.trim(k).length?(a.showPrompt(b.get("pushNameCanNotEmpty","\u8bf7\u8f93\u5165\u63a8\u9001\u540d\u79f0\u3002")),!1):50<k.length?(a.showPrompt(b.get("pushNameToLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")),
!1):!0});h.setClosingAction(function(k){k&&C&&C(f.getText(),r.getSelected())});a=h.getMessageCurtain();e()};var n=function(){var k=$("<div>"),p=new Da;p.setText(b.get("nameRule","\u89c4\u5219"));p=p.getJqUi();l=new kb;l.setSelected(w[0]);l.setItemModels(w);l.addSelectedChangedListener(function(L,B,y){y==w[0]?(D&&D.hide(),r.setSelected(null)):(D&&D.show(),r.setSelected(Eb.getArrDateFormat()[0]))});var m=l.getJqUi(),t=new Da;t.setRequired(!0);t.setText(b.get("pushName","\u540d\u79f0"));t=t.getJqUi();
f=new bb;f.setText(d);var c=f.getJqUi();D=$("<div>");var q=new Da;q.setText(b.get("dateFormat","\u65e5\u671f\u683c\u5f0f"));q=q.getJqUi();q.appendTo(D);r=new kb;r.setItemModels(Eb.getArrDateFormat());var z=r.getJqUi();z.appendTo(D);E.layoutCtrl(p,30,10,70,23);E.layoutCtrl(m,115,10,300,23);E.layoutCtrl(t,30,69,70,23);E.layoutCtrl(c,115,69,300,23);E.layoutCtrl(D,0,128,448,23);E.layoutCtrl(q,30,0,70,23);E.layoutCtrl(z,115,0,300,23);p.appendTo(k);m.appendTo(k);t.appendTo(k);c.appendTo(k);D.appendTo(k);
u?(l.setSelected(w[1]),r.setSelected(Eb.searchDateFormatObj(u))):D.hide();return k}}function Uc(d){db.call(this);var u=this,g=this.protectedMethod,h=this.showDialog,e,a,f,l;this.setClosingListener=function(n){f=n};this.setPushTargetType=function(n){l=n};this.showDialog=function(){u.setSize(480,340);g.setTitle("Webhook");g.setSelectable(!0);g.setContentPaneCreator(r);g.setClosingChecker(function(){var n=C(e.getText());if(null==n||0==$.trim(n).length)return a.showPrompt(b.get("webhookCanNotEmpty","\u8bf7\u8f93\u5165\u7fa4\u7ec4\u673a\u5668\u4ebaWebhook\u5730\u5740\u3002")),
!1;n=n.split(";");if(5<n.length)return a.showPrompt(b.get("webhookTooMuch","Webhook\u5730\u5740\u4e0d\u53ef\u8d85\u8fc75\u4e2a\u3002")),!1;for(var k=0;k<n.length;k++){var p=n[k];if(255<p.length)return a.showPrompt(b.get("webhookToLong","Webhook\u5730\u5740\u8fc7\u957f\uff0c\u8bf7\u68c0\u67e5\u5730\u5740\u662f\u5426\u6b63\u786e")),!1;if(!w(p))return a.showPrompt(b.get("webhookWrongFormat","Webhook\u5730\u5740\u683c\u5f0f\u9519\u8bef")),!1}return!0});g.setClosingAction(function(n){n&&f&&f(C(e.getText()))});
a=g.getMessageCurtain();h()};var r=function(){var n=$("<div>"),k=$("<div>");k.addClass("qing-push-webhook-input-tip");E.layoutCtrl(k,0,0,448,32);var p=b.get("enterWebhook","\u8bf7\u8f93\u5165\u7fa4\u7ec4\u673a\u5668\u4ebaWebhook\u5730\u5740\uff0c\u591a\u4e2a\u5730\u5740\u53ef\u7528\u82f1\u6587\u5206\u53f7\u5206\u9694\uff0c\u6700\u591a\u53ef\u8f93\u51655\u4e2a");k.text(p);k.attr("title",p);k.appendTo(n);e=new sb;k=e.getJqUi();k.addClass("lapp-webhook-textarea-real");e.setText(D(d));e.addEditedListener(function(){e.setText(D(e.getText()))});
E.layoutCtrl(k,0,40,448,180);k.appendTo(n);return n},D=function(n){n&&-1<n.indexOf(";")&&(n=n.replace(/;(?!\n|$)/g,";\n"));return n},C=function(n){n=$.trim(n);return n=n.replace(/\n/g,"").replace(/(^;|;$)/g,"")},w=function(n){var k=/(http|https):\/\/([\w.]+\/?)\S*/;return l==Ea.YZJ_ROBOT&&k.test(n)&&-1!=n.indexOf("/gateway/robot/webhook/send?yzjtype=0&yzjtoken=")&&(k=n.indexOf("/gateway/robot/webhook/send?yzjtype=0&yzjtoken="),-1==n.indexOf("/gateway/robot/webhook/send?yzjtype=0&yzjtoken=",k+1))||
l==Ea.WXQYH_ROBOT&&(k=n.indexOf("https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key="),0==k&&-1==n.indexOf("https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=",k+1))||l==Ea.DINGDING&&(k=n.indexOf("https://oapi.dingtalk.com/robot/send?access_token="),0==k&&-1==n.indexOf("https://oapi.dingtalk.com/robot/send?access_token=",k+1))?!0:!1}}function Tc(d){db.call(this);var u=this,g=this.protectedMethod,h=this.showDialog,e,a,f,l;this.setClosingListener=function(C){l=C};this.setCreateFacadeMethod=function(C){f=
C};this.showDialog=function(){u.setSize(480,340);g.setTitle(b.get("pushTime","\u63a8\u9001\u65f6\u95f4"));g.setSelectable(!0);g.setContentPaneCreator(r);g.setClosingChecker(function(){var C=a.getSchedule();if("Custom"==C.getPeriod()){var w=C.getCron();C=C.getCronMsg();if("undefined"==typeof w||""==w)return e.showPrompt(b.get("cronErrorMessage","\u8bf7\u8f93\u5165\u8868\u8fbe\u5f0f\u3002")),!1;if(C)return e.showPrompt(C),!1}return!0});g.setClosingAction(function(C){C&&l&&l(a.getSchedule())});e=g.getMessageCurtain();
h()};var r=function(){a=new com.kingdee.bos.qing.schedule.ScheduleSelector;a.isOnlyPeriod(!0);a.setCronAnalysisFacade(D);var C=a.getJqUi();C.css("left","120px");C.css("top","30px");d&&a.setSchedule(d.copy());return C},D=function(C,w,n){w=new f(w,n);w.setShowBlocking(!0);w.cronExpression(C)}}function Wc(d,u,g){function h(B){KTDefaultCellRender.call(this,B);var y=this,aa=this.paintCellUI,V;this.setFacade=function(pa){V=pa};this.paintCellUI=function(pa,N){var W=y.getCurrentRowIdx(),J=y.getCurrentRow(),
Q=y.getCurrentColIdx();if(W<Va.getHeadRowCount()||1==Q||3==Q)aa(pa,N),1==W&&0==Q&&(W=$("<div>"),W.addClass("total-checkbox-ctrl"),N=new Cb,W.data("checkBoxModel",N),J=N.getJqUi(),W.append(J),W.on("click",c),W.appendTo(pa)),$(pa).find("span").css({"padding-right":"8px","padding-left":"6px"});else if(0==Q){var H=J.getUserObject();Q=$("<div>");Q.addClass("push-detail-name-left");N=new Cb;J=N.getJqUi();Q.data("checkBoxModel",N);Q.data("yzjPushRecordModel",H);Q.data("tableModel",B);Q.attr("rowIndex",W);
Q.on("click",t);Q.append(J);W=$("<div>");W.addClass("push-detail-name-right");W.text(H.getName());Q.appendTo(pa);W.appendTo(pa)}else if(2==Q){H=J.getUserObject();W=H.getErrorCode();N=H.getErrorMessage();null!=N?4300114==W?(Q="#ff831f",J=b.get("someFailure","\u90e8\u5206\u5931\u8d25")):4300112==W?(Q="#ff831f",J=b.get("unPush","\u672a\u63a8\u9001")):(Q="red",J=b.get("pushFailure","\u5931\u8d25")):(Q="green",J=b.get("pushSuccess","\u6210\u529f"));var ca=$("<div style='border: solid 1px;text-align:center;height: 16px'>");
ca.text(J);ca.css("color",Q);ca.css("width","60px");ca.css("position","absolute");ca.css("top","0");ca.css("bottom","0");ca.css("margin","auto");ca.appendTo(pa);if(4300112==W)W=$("<div style='text-align:left;width:75px;height: 16px'>"),W.text(b.get("warningRuleUnMatched","\u4e0d\u6ee1\u8db3\u9884\u8b66\u89c4\u5219")),W.css("position","absolute"),W.css("top","0"),W.css("bottom","0"),W.css("left","70px"),W.css("margin","auto"),W.appendTo(pa);else if(N||0!=W)W=new xb(b.get("errorDetail","\u8be6\u60c5")),
W.addActionListener(function(){H.getErrorStack()?m(H):(new V(function(ea){H.fromErrorInfoJsonObject(ea);m(H)},function(ea,T){m(H);return!0})).loadPushRecordErrorInfo(H.getId())}),W=W.getJqUi(),W.addClass("lapp-push-failure-detail"),W.appendTo(pa)}}}db.call(this);var e=this,a=this.protectedMethod,f=this.showDialog,l,r,D,C,w=["yzj-push-manage-fileSize","Wx-push-manage-fileSize","Mxy-push-manage-fileSize","dingding-push-manage-filSize"];this.setPushTargetType=function(B){C=B};this.setFacade=function(B){D=
B};this.showDialog=function(B){a.setTitle(b.get("scheduleDetails","\u63a8\u9001\u660e\u7ec6"));e.setSize(800,570);a.setSelectable(!0);a.setFooterClosingOnly(!0);a.setClosingChecker2(null,function(y){a.destroy();return!0});a.setContentPaneCreator(function(){return n(B)});a.setClosingAction(function(y){});l=a.getMessageCurtain();f();r&&Va.refresh(r)};var n=function(B){if(0==B.length)var y=k();else{y=$("<div>");r=Va.createTable();var aa=new h(r);aa.setFacade(D);aa.setOutsideVisible(!1);r.setCellRender(aa);
r.setSyncUIWhenModelChanged(!0);r.addColumns(4);r.getColumn(0).setWidth(200);r.getColumn(1).setWidth(200);r.getColumn(2).setWidth(200);r.getColumn(3).setWidth(150);aa=Va.createHeadRow(r);aa.getCell(0).setValue(b.get("pushName","\u540d\u79f0"));aa.getCell(1).setValue(b.get("pushTime","\u63a8\u9001\u65f6\u95f4"));aa.getCell(2).setValue(b.get("pushState","\u63a8\u9001\u72b6\u6001"));aa.getCell(3).setValue(b.get("fileSize","\u6587\u4ef6\u5927\u5c0f"));for(var V=aa=0;V<B.length;V++){var pa=new Ub;pa.fromJsonObject(B[V]);
pa=pa.getFileSize();aa+=z(pa)}V=new Vb;V.setTotalRowNum(B.length);V.setContentPane(y);V.setTotalPushRecordFileSize(L(aa));V.setBatchHandleEvent(function(N){for(var W,J=[],Q=[],H=0,ca=0;ca<N.length;ca++){var ea=N[ca];!W&&(W=ea.tableModel);J.push(ea.rowIndex);ea=ea.pushRecordModel;Q.push(ea.toJsonObject());ea=ea.getFileSize();H+=z(ea)}N=$(".push-record-total-value").text();N=q(H,N,!1);$(".push-record-total-value").text(N);(new D(function(){l.showSuccess(b.get("successToDeletePushRecord","\u5220\u9664\u63a8\u9001\u8bb0\u5f55\u6210\u529f\u3002"));
for(var T=0,M=0;M<J.length;M++)W.removeRow(J[M]-T),T++;W.updateUI(!0);T=H;M=d.getRow(u);var ra=M.getCell(g).getValue();ra=q(T,ra,!1);M.getCell(g).setValue(ra);M=$("."+w[C]).text();T=q(T,M,!1);$("."+w[C]).text(T)},function(T,M){return"4300101"==T?(l.showError(b.get("failToDeletePushRecord","\u5220\u9664\u63a8\u9001\u8bb0\u5f55\u5931\u8d25\u3002")),!0):"4300104"==T?(l.showError(b.get("failToDeleteAnalysis","\u7f51\u7edc\u8fde\u63a5\u5f02\u5e38\uff0c\u5220\u9664\u5206\u6790\u5931\u8d25\u3002")),!0):
"5001"==T?(l.showError(M),!0):!1})).deletePushRecord(Q)});V.paintBatchDelUI().appendTo(y);p(B);B=$(r.getUI());E.layoutCtrlWithLRTB(B,0,0,null,65,0,null);B.appendTo(y)}return y},k=function(){var B=$("<div>"),y=$("<div>");y.addClass("no-data-image");Ma.background(y,"no-data");y.appendTo(B);y=$("<div>");y.addClass("no-push-config-data");y.text(b.get("noData","\u6682\u65e0\u8bb0\u5f55"));y.appendTo(B);return B},p=function(B){Va.clearWithoutHead(r);if(B)for(var y=0;y<B.length;y++){var aa=new Ub;aa.fromJsonObject(B[y]);
var V=Va.createRow(r);V.setUserObject(aa);V.getCell(0).setValue(aa.getName());V.getCell(1).setValue(aa.getPushFormatTime());V.getCell(3).setValue(aa.getFileSize())}Va.refresh(r)},m=function(B){var y=B.getErrorStack(),aa=B.getErrorCode(),V=B.getErrorMessage(),pa=b.get(aa.toString(),V);B=b.get("errorMsg","\u9519\u8bef\u4fe1\u606f\uff1a");B=V&&4300114==aa?B+b.get("errorWebhook","\u90e8\u5206Webhook\u5b9a\u65f6\u63a8\u9001\u5931\u8d25"):V&&4300115==aa?B+b.get("allWebhookFailure","\u5168\u90e8Webhook\u5b9a\u65f6\u63a8\u9001\u5931\u8d25"):
V&&2101006!=aa&&2101018!=aa?B+V:B+b.get(aa.toString(),pa);if(2101006==aa)(pa=y.match(/(\(|\uff08)([^(\)|\uff09)]+)(\)|\uff09)/))&&pa[2]&&(y=pa[2]),y=b.get("noAuthorityForTheseEntities","\u5c1a\u672a\u83b7\u5f97\u4ee5\u4e0b\u5b9e\u4f53\u6570\u636e\u8868\u7684\u67e5\u770b\u6743\u9650\uff1a")+"\r  "+y.replace(/,/g,b.get("semicolon","\uff1b")+"\r  ");else if("2101018"==aa){if(pa=/(?:\u3010\s)(.+)(?=\s\u3011)/.exec(y)){y=pa[1];var N=b.get("notSupportQingAnalysis","\u4ee5\u4e0b\u4e1a\u52a1\u5b9e\u4f53\u5c1a\u672a\u5f00\u542f\u201c\u652f\u6301\u8f7b\u5206\u6790\u201d\u8bbe\u7f6e\u9879\uff1a")+
"\r  "+y.replace(/,/g,b.get("semicolon","\uff1b")+"\r  ")}B=b.get("entityNotSupportQingAnalysis","\u4e1a\u52a1\u5b9e\u4f53\u672a\u5f00\u542f\u201c\u652f\u6301\u8f7b\u5206\u6790\u201d\u8bbe\u7f6e\u9879\uff0c\u8bf7\u5728\u5f00\u53d1\u5e73\u53f0\u7684\u5bf9\u5e94\u8868\u5355\u4e2d\u8fdb\u884c\u8bbe\u7f6e   ");y=pb.getSupportQingAnalysisUrl();N?Wb(B,N,y):Wb(B,V,y);return}B=B+"\n"+b.get("errorCode","\u9519\u8bef\u7801\uff1a")+aa;V=com.kingdee.bos.qing.ui.component.MessageDialog;N=new V;N.setOptionType(V.OPTION_OK);
N.setMessage(B);y&&N.setDetail(y);N.showDialog()},t=function(B){var y=$(B.currentTarget).data("checkBoxModel").isChecked();B=$(".total-checkbox-ctrl");B=$(B).data("checkBoxModel");if(y){a:{y=$(".push-detail-name-left");for(var aa=0;aa<y.length;aa++)if(!$(y[aa]).data("checkBoxModel").isChecked()){y=!1;break a}y=!0}B.setChecked(y)}else B.setChecked(y)},c=function(B){B=$(B.currentTarget).data("checkBoxModel").isChecked();for(var y=$(".push-detail-name-left"),aa=0;aa<y.length;aa++)$(y[aa]).data("checkBoxModel").setChecked(B)},
q=function(B,y,aa){y=z(y);return L(aa?y+B:y-B)},z=function(B){var y=Math.floor(100*parseFloat(B.substring(0,B.length-2)));return"MB"==B.substring(B.length-2,B.length)?1024*y:y},L=function(B){B/=100;return 1024>B?0==B?B+"KB":B.toFixed(2)+"KB":(1*B/1024).toFixed(2)+"MB"}}function Db(){var d=this,u,g=$("<div>"),h=$("<div>"),e,a,f=[];this.getJqUi=function(){u||(u=$("<div>"),g.addClass("sa-qing-publish-tab-container"),h.addClass("sa-qing-publish-tabpane-container"),g.appendTo(u),h.appendTo(u));return u};
this.addTab=function(C,w,n,k,p,m){if(l(C)){var t=$("<span>");t.addClass("sa-qing-publish-tab");Ma.background(t,w);t.appendTo(g);p||(C=$("<span>"),C.addClass("sa-qing-publish-tab-border"),C.appendTo(g));null==n?t.attr("title",m):(t.on("click",function(c){D(t,n)}),k&&D(t,n))}};this.getCurrentTabPane=function(){return a};this.addTabChangedListener=function(C){f.push(C)};var l=function(C){for(var w=Object.keys(Ea),n=0;n<w.length;n++)if(Ea[w[n]]==C)return!0;return!1},r=function(C){for(var w=0;w<f.length;w++)(0,f[w])(d,
C)},D=function(C,w){a=w;e||(e=$("<span>"),e.addClass("sa-qing-publish-tab_selected"),e.appendTo(g));var n=e,k=n.css;a:{for(var p=g.children(".sa-qing-publish-tab"),m=0;m<p.length;m++)if(p[m]==C[0]){C=m;break a}C=-1}k.call(n,"left",87*C+13+"px");n=w.getJqUi();k=h.children();C=!1;for(p=0;p<k.length;p++)k[p]==n[0]?(C=!0,$(k[p]).css("display","block"),w.into(),r(w)):$(k[p]).css("display","none");C||(E.layoutCtrlWithLRTB(n,0,0,null,0,0,null),n.appendTo(h),w.into(),r(w))}}function Pc(){var d,u,g,h;this.setId=
function(e){d=e};this.getId=function(){return d};this.setAppId=function(e){u=e};this.getAppId=function(){return u};this.setAppUserType=function(e){g=e};this.getAppUserType=function(){return g};this.setAppImageFile=function(e){h=e};this.getAppImageFile=function(){return h};this.fromJsonObject=function(e){e&&(d=e.id,u=e.appId,g=e.appUserType,h=e.appImageFile)};this.toJsonObject=function(){var e={};e.id=d;e.appId=u;e.appUserType=g;e.appImageFile=h;return e}}function Pb(){var d=new Xb,u=new Rb,g,h;this.setPublishContext=
function(e){g=e};this.setPublishModel=function(e){h=e};this.editPublishNameListener=function(e,a,f,l,r,D,C){var w=new ka("lappAnalysisMgr",function(n){n=n.content;var k=[],p=a.getText();if(""!=p){for(var m=0;m<n.length;m++){var t=n[m].name,c=n[m].viewType;if(f)c=c==h.getViewType();else{var q=g&&g.getScene();c=l?c==Ba.VIEW_TYPE_DASHBOARD:"Longer"==q&&c==Ba.VIEW_TYPE_LONGER||"Square"==q&&c==Ba.VIEW_TYPE_SQUARE}c&&-1<t.indexOf(p.trim())&&k.push(t)}0<k.length?(d.setCustomItemPainter(function(z,L){z.on("mousedown",
function(B){a.setText(L);C.remove();B.stopPropagation()});z.text(L);z.attr("title",L)}),d.setItemModels(k),d.setSelecteds([k[0]]),n=d.getJqUi(),m=a.getJqUi(),k=m.width(),p=m.css("left"),m=m.position().top+m.height(),E.layoutCtrl(n,p,m,k,122),n.css("z-index","9999"),n.find(".sa-ctrl-list-owner").css("height","100px"),k=$("<div>"),k.addClass("history-publish-name"),k.text(b.get("HistoryPublishName","\u5386\u53f2\u53d1\u5e03\u540d\u79f0")),k.css({right:r+"px",top:m+100+"px"}),n.appendTo(C),k.appendTo(C),
C.appendTo(D)):C.remove()}else C.remove()},function(n,k){u.showPrompt(k,2E3);return!0});w.setShowBlocking(!1);w.getAnalysisList(e,!1)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.timedpush&&(com.kingdee.bos.qing.timedpush={});var gb=com.kingdee.bos.qing.timedpush;gb.LappSchedulePush=function(){this.createDialog=
function(d,u,g,h,e){(new Rc(d,u,g,h,e)).showDialog()}};gb.LappPushManagePanel=function(d,u,g,h,e){function a(I){KTDefaultCellRender.call(this,I);var X=this,Y=this.paintCellUI;this.paintCellUI=function(ua,Ia){var Fa=X.getCurrentRowIdx(),Na=X.getCurrentRow(),ma=X.getCurrentColIdx(),Z=$(ua),v=Na.getUserObject();if(1==Fa){Y(ua,Ia);var A=$(ua).find("span");A.css({"padding-right":"12px","padding-left":"2px"});if(!/Trident|MSIE/.test(window.navigator.userAgent)&&(c&&1!=ma&&2!=ma&&4!=ma&&6!=ma&&c.addSortingTips($(ua),
L[ma]),!c&&3==ma&&!z)){z=new f;H=[];for(A=0;A<J.length;A++)H.push(J[A].toJsonObject());z.setArrJson(H);z.setFunSortchangeListener(function(sa,xa){xa?c.setShowSortingModel(z.getShowSortingModel()):(xa=new l,xa.setField("PushCreateTime"),xa.setOrder(l.ORDER_DESC));sa=[];for(var Ha=0;Ha<J.length;Ha++)sa.push(J[Ha].toJsonObject());z.setArrJson(sa);z.sortArrJson(sa,xa,function(Qa){Ga(Qa);ia()},function(Qa){return"fileSize"==Qa?"sFileSizeNoFormat":Qa})});z.addPushCreateTimeSortingTips($(ua),L[ma])}}if(X.getCurrentRowIdx()<
Va.getHeadRowCount()||2==ma||5==ma)Y(ua,Ia),A=$(ua).find("span"),A.css({"padding-right":"12px","padding-left":"5px"});else if(1==ma)Y(ua,Ia),A=$(ua).find("span"),A.css({"padding-right":"12px","padding-left":"2px"}),A.attr("title",Na.getCell(1).getValue());else if(0==ma)Y(ua,Ia),A=$(ua).find("span"),A.css({"padding-right":"8px","padding-left":"6px",left:"8px"}),A.attr("title",Na.getCell(0).getValue()),A.addClass("sa-publish-item-list-head"),ab(v.getSourceName())?"subject"==v.getSourceType()?(ua=wb.createWarning(),
ua.attr("title",b.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u5220\u9664")),E.layoutCtrl(ua,0,8),Z.append(ua)):"dashboard"==v.getSourceType()&&(ua=wb.createWarning(),ua.attr("title",b.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u5220\u9664")),E.layoutCtrl(ua,0,8),Z.append(ua)):v.getWarningRuleStatus()||(ua=wb.createWarning(),ua.attr("title",b.get("warningRuleInvalidTips","\u9884\u8b66\u89c4\u5219\u4e0d\u5b58\u5728")),E.layoutCtrl(ua,0,8),Z.append(ua));else if(3==ma){Z=v.getCreateFormatTime();
var F=$("<span>");F.text(Z);F.attr("title",Z);F.css("line-height","28px");F.css("padding-left","6px");F.css("padding-right","8px");F.appendTo(ua)}else if(4==ma){var P=new qb;P.setOn(v.getOpenSchedule()&&v.getWarningRuleStatus()&&v.getSourceName());var da=P.isOn();P.addStateChangeListener(function(sa,xa){xa&&(sa=sa.isOn(),v.setOpenSchedule(sa),S(P,sa,da,v))});P.setEnabled(!1);Z=$("<div>");Z.css({opacity:"0","z-index":"100"});E.layoutCtrl(Z,5,5,100,23);v.isHasPermission()?(P.setEnabled(!0),ab(v.getSourceName())?
(P.setEnabled(!1),"subject"==v.getSourceType()?F=b.get("ButtonMessageAfterSubjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u542f\u52a8\u63a8\u9001\u914d\u7f6e"):"dashboard"==v.getSourceType()&&(F=b.get("ButtonMessageAfterDashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u542f\u52a8\u63a8\u9001\u914d\u7f6e")),Z.attr("title",F),Z.appendTo(ua)):v.getWarningRuleStatus()||(P.setEnabled(!1),F=b.get("ButtonMessageAfterWarningRuleInvalidTips",
"\u9884\u8b66\u89c4\u5219\u4e0d\u5b58\u5728,\u65e0\u6cd5\u542f\u52a8\u63a8\u9001\u914d\u7f6e"),Z.attr("title",F),Z.appendTo(ua))):(F=b.get("sourceIsPublishNoPermissionOrNotFound","\u539f\u53d1\u5e03\u4e0d\u5b58\u5728\u6216\u672a\u6388\u6743"),Z.attr("title",F),Z.appendTo(ua));Z=P.getJqUi();Z.addClass("push-schedule-state-btn");E.layoutCtrl(Z,26,16,31,19);Z.appendTo(ua)}else if(6==ma){Z=new xb(b.get("scheduleDetails","\u63a8\u9001\u660e\u7ec6"));Z.addActionListener(function(){R(v,I,Fa,5)});Z=Z.getJqUi();
Z.addClass("push-record-detail");Z.appendTo(ua);Z.attr("title",b.get("scheduleDetails","\u63a8\u9001\u660e\u7ec6"));Z.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});Z=[ta,qa];F=[b.get("editPushInfoItem","\u7f16\u8f91\u63a8\u9001\u4fe1\u606f"),b.get("editPushContentItem","\u7f16\u8f91\u63a8\u9001\u65b9\u6848")];var ba=new Qb($(D.getUI()),F,Z);Z=new xb(b.get("editPushConfig","\u7f16\u8f91"));var la=Z.getJqUi();la.addClass("edit-push-config");Z.addActionListener(function(){ba.show(la,
Na);var sa=r.find(".sa-qing-publish-manager-editcontent-selector"),xa=la.offset().left-82;sa.offset({left:xa})});la.appendTo(ua);la.attr("title",b.get("editPushConfig","\u7f16\u8f91"));la.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});Z=new xb(b.get("DeletePushConfig","\u5220\u9664"));Z.addActionListener(function(){var sa=Sa.createFeedbackDialog();sa.setOptionType(Sa.OPTION_OK_CANCEL);sa.setMsgImageType(Sa.MSG_DELETE);sa.setMessage(b.get("confirmDeleteTheConfig","\u5220\u9664\u8be5\u8bb0\u5f55\u540e\u5c06\u540c\u65f6\u6e05\u7a7a\u8be5\u8bb0\u5f55\u4e0b\u751f\u6210\u7684\u6240\u6709\u63a8\u9001\u660e\u7ec6\u6570\u636e\uff0c\u786e\u5b9a\u5220\u9664\u8be5\u8bb0\u5f55\u5417\uff1f"));
sa.setClosingChecker(function(xa){xa==Sa.RETURN_OK&&U(v,I,Fa);return!0});sa.showDialog()});Z=Z.getJqUi();Z.addClass("delete-push-config-and-pushrecord");Z.appendTo(ua);Z.attr("title",b.get("DeletePushConfig","\u5220\u9664"));Z.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});Z=new xb(b.get("pushImmediately","\u7acb\u5373\u63a8\u9001"));F=v.isHasPermission()&&!ab(v.getSourceName())&&v.getWarningRuleStatus();Z.setEnabled(F);Z.addActionListener(function(){var sa=new com.kingdee.bos.qing.publish.common.SchedulePushDialog;
sa.setConfirmListener(function(){G(v)});sa.showDialog(v.getName(),b.get("mobileApplicationGroup","\u79fb\u52a8\u5e94\u7528\u7fa4\u7ec4"))});Z=Z.getJqUi();Z.addClass("push-immediately");Z.appendTo(ua);Z.attr("title",b.get("pushImmediately","\u7acb\u5373\u63a8\u9001"));Z.css({overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"})}};var qa=function(ua){aa(ua.getUserObject())},ta=function(ua){var Ia=new Vc(y,B);Ia.setModel(ua.getUserObject());Ia.setFinishedEditListener(function(Fa){ja(Fa,
ua,I)});Ia.setDsbThumbnailDeleteCallBack(function(Fa,Na,ma){if(J)for(var Z in J){var v=J[Z].getThumbnailPath();if(v&&-1<v.indexOf("{")){var A=new com.kingdee.bos.qing.imagelib.model.ThumbnailUrlModel;A.getImagePathFromJson(v);A.getImageFileName()===Fa&&(v=new com.kingdee.bos.qing.imagelib.model.PathModel,v.setNameSpace("$user$"),v.setGroupName(Na),v.setName(ma),A.setImageFullPathModel(v),A.setImageFileName(""),v=A.getJsonImagePath(),J[Z].setThumbnailPath(v))}}});Ia.showDialog()}}function f(){var I,
X,Y,qa;this.setShowSortingModel=function(ma){X=ma};this.getShowSortingModel=function(){return X};this.setFunSortchangeListener=function(ma){Y=ma};this.setArrJson=function(ma){qa=ma};this.showSortingTips=function(ma,Z){var v=ma.find(".resourceinfo-detaillist-sort-box");0==v.length&&(v=new l,v.setField(Z),v.setOrder(null),v=Na(ma,v),ma.append(v));v.addClass("resourceinfo-detaillist-sort-box_clickable")};this.hideSortingTips=function(ma){ma=ma.find(".resourceinfo-detaillist-sort-box");ma.removeClass("resourceinfo-detaillist-sort-box_clickable");
ua(ma)};this.addSortingTips=function(ma,Z){X&&null!=X.getOrder()&&X.getField()==Z&&(Z=Na(ma,X),ma.append(Z))};this.addPushCreateTimeSortingTips=function(ma,Z){var v=new l;v.setField(Z);v.setOrder(l.ORDER_DESC);Z=Na(ma,v);ma.append(Z)};this.sortArrJson=function(ma,Z,v,A){switch(Z.getOrder()){case l.ORDER_ASC:var F=!0;break;case l.ORDER_DESC:F=!1;break;default:F=!1}Z=Z.getField();A&&(Z=A(Z));ma=[].concat(ma);ma.sort(ta(Z,F));A=[];for(var P=[],da=[],ba=[],la=[],sa=0;sa<ma.length;sa++){var xa=ma[sa][Z];
xa||0===xa?/^\d+?.*$/.test(xa)?(P=P||[],P.push(ma[sa])):/^[a-zA-Z]+?.*$/.test(xa)?(da=da||[],da.push(ma[sa])):/^[\u4e00-\u9fa5]+?.*$/.test(xa)?(ba=ba||[],ba.push(ma[sa])):(la=la||[],la.push(ma[sa])):(A=A||[],A.push(ma[sa]))}ma=F?[].concat(P||[]).concat(da||[]).concat(ba||[]).concat(la||[]).concat(A||[]):[].concat(A||[]).concat(la||[]).concat(ba||[]).concat(da||[]).concat(P||[]);v&&v(ma)};var ta=function(ma,Z){return function(v,A){if("pushName"==ma){var F=v.lappSchedulePushConfigModel.name;var P=A.lappSchedulePushConfigModel.name}else"PushCreateTime"==
ma?(F=v.lappSchedulePushConfigModel.createTime,P=A.lappSchedulePushConfigModel.createTime):"sFileSizeNoFormat"==ma&&(F=v.lappSchedulePushConfigModel.sFileSizeNoFormat,P=A.lappSchedulePushConfigModel.sFileSizeNoFormat);v=F-P;isNaN(v)&&(v=String(F).localeCompare(String(P),"zh-CN",{sensitivity:"accent"}));return Z?v:-v}},ua=function(ma){var Z=ma.data("sortable-data");Z&&null==Z.getOrder()&&ma.remove()},Ia=function(ma,Z){var v=f.BOX_LEN-2,A=$("<div>");Ma.background(A,"icon_sortable-v");A.attr("title",
b.get("sort","\u6392\u5e8f"));A.addClass("resourceinfo-detaillist-sort-box");A.css("left",ma);A.css("top",Z);A.css("width",v);A.css("height",v);return A},Fa=function(ma){var Z=ma.data("sortable-data");Z.getOrder()==l.ORDER_ASC?Ma.background(ma,"icon_sort-asc-esc"):Z.getOrder()==l.ORDER_DESC?Ma.background(ma,"icon_sort-asc-desc"):Z.getOrder()||Ma.background(ma,"icon_sortable-v")},Na=function(ma,Z){var v=ma.width();ma=ma.height();v=Ia(v-f.BOX_LEN-1,ma-f.BOX_LEN-1);v.data("sortable-data",Z);Fa(v);v.on("click",
function(A){A=$(A.currentTarget);var F=A.data("sortable-data");"PushCreateTime"==F.getField()?F.getOrder()==l.ORDER_ASC?F.setOrder(l.ORDER_DESC):F.getOrder()==l.ORDER_DESC?F.setOrder(l.ORDER_ASC):F.getOrder()||F.setOrder(l.ORDER_ASC):F.getOrder()==l.ORDER_ASC?F.setOrder(l.ORDER_DESC):F.getOrder()==l.ORDER_DESC?F.setOrder(null):F.getOrder()||F.setOrder(l.ORDER_ASC);A.data("sortable-data",F);Fa(A);ua(A);I&&I[0]!=A[0]&&I&&I.remove();I=A;X=F;Y&&Y(qa,I?I.data("sortable-data"):null)});return v}}function l(){var I,
X;this.getOrder=function(){return I};this.setOrder=function(Y){I=Y};this.getField=function(){return X};this.setField=function(Y){X=Y}}jb.AbstractTabPane.call(this);var r,D,C,w,n,k,p,m=new com.kingdee.bos.qing.biz.common.SimplePaginationBar,t,c,q,z,L="pushName pushFrom pushTime PushCreateTime scheduleEnable fileSize operation".split(" "),B=h,y=g,aa=e,V=["yzj-push-manage-fileSize","Wx-push-manage-fileSize","Mxy-push-manage-fileSize","dingding-push-manage-filSize"],pa=[b.get("yzj","\u4e91\u4e4b\u5bb6"),
b.get("enterPriseWx","\u4f01\u4e1a\u5fae\u4fe1"),b.get("mxy","\u7f8e\u4fe1\u4e91"),b.get("dingding","\u9489\u9489")],N,W,J=[],Q=[],H=[],ca;this.setClickTimedPushManager=function(I){ca=I};this.setAutoSelectedData=function(I){N=I};this.getJqUi=function(){null==r&&ea();return r};this.getTitle=function(){switch(d){case Ea.YZJ_ROBOT:return b.get("cloudHub","\u4e91\u4e4b\u5bb6");case Ea.WXQYH_ROBOT:return b.get("enterpriseWeChat","\u4f01\u4e1a\u5fae\u4fe1");case Ea.MISSION_CLOUD_SERVICE_ACCOUNT:return b.get("missionCloud",
"\u7f8e\u4fe1\u4e91");case Ea.DINGDING:return b.get("dingding","\u9489\u9489");default:throw Error("unknown type");}};this.relayoutViews=function(){D&&"none"==w.css("display")&&(Va.refresh(D),D.relayoutViews());if(W&&W.hasSelected()){var I=W.getSelected();W.removeAllSelecteds();I&&W.addSelected(I)}I=r.find(".sa-publish-item-list-head");for(var X in Q)Aa(I[X],Q[X].getName(),p)};var ea=function(){r=$("<div>");r.addClass("sa-qing-publish-manager");ca&&r.css("top","3px");n=na();k=n.getJqUi();k.css("z-index",
"999");E.layoutCtrl(k,-15,-3,171,25);t=T();t.css("margin-top","36px");t.css("border-top","1px solid #ccc");w=$("<div>");w.addClass("sa-qing-publish-manager-content-emptytip");w.appendTo(r);var I=function(X){Ga(X);if(0==J.length)Oa();else{m.resetPaginationAndJumpToFirstPage(J.length);for(var Y=X=0;Y<J.length;Y++){var qa=J[Y].getFileSize();X+=Pa(qa)}Y=new Vb;Y.setMarkClassName(V[d]);Y.setTotalFileSize(O(X));Y.setPushDetailSettingDisplayPrev(x);Y.paintPushDetailSetting().appendTo(r);k.appendTo(r);t.appendTo(r);
C=Ca();C.appendTo(r);w.hide();Q=J.slice(0,20);Ra(Q)}};d==Ea.MISSION_CLOUD_SERVICE_ACCOUNT||d==Ea.YZJ_ROBOT||d==Ea.WXQYH_ROBOT||d==Ea.DINGDING?(new y(I,function(){w.hide();return!1})).loadConfigInfo(d):Oa()},T=function(){m.setJumpToPageListener(function(I,X,Y){var qa=J.length;0<qa&&qa<=I*X&&(Q=J.slice((I-1)*X,qa));0<qa&&qa>I*X&&(Q=J.slice((I-1)*X,I*X));Y?Y(qa):m.refreshPagination();Ra(Q)});m.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);return m.getJqUi()},M=function(I){m.resetPaginationAndJumpToFirstPage(I.length);
Q=I.slice(0,m.getPageSize());m.setJumpToPageListener(function(X,Y,qa){var ta=I.length;0<ta&&ta<=X*Y&&(Q=I.slice((X-1)*Y,ta));0<ta&&ta>X*Y&&(Q=I.slice((X-1)*Y,X*Y));qa?qa(ta):m.refreshPagination();Ra(Q)})},ra=function(I){for(var X,Y,qa=Y=0;qa<I.length;qa++)X=I[qa],X=X.getFileSize(),Y+=Pa(X);$("."+V[d]).text(O(Y))},x=function(){(new y(function(I){if(I){var X=new sc;X.fromJsonObject(I)}I=new tc;I.setPushRecordConfig(X);I.setContentPane(r);I.setPushDetailSettingAfter(ha);I.showDialog()},function(){return!1})).loadPushRecordConfigInfo(d)},
ha=function(I,X){var Y=new y(function(qa){qa&&Ka(!0)},function(){u.showError(pa[d]+b.get("pushStorageSetError","\u7684\u63a8\u9001\u660e\u7ec6\u8bbe\u7f6e\u5931\u8d25\u3002"));return!1});Y.setBlockingPrompt(b.get("savePushDetailConfigInfo","\u6b63\u5728\u4fdd\u5b58\u63a8\u9001\u660e\u7ec6\u8bbe\u7f6e"));Y.saveLappPushRecordConfig(d,I,X)},Ka=function(I){var X=new y(function(Y){null==Y||0==Y.length?Oa():(Ga(Y),ia());I&&u.showSuccess(b.get("pushDetailSetSuccess","\u63a8\u9001\u660e\u7ec6\u8bbe\u7f6e\u4fdd\u5b58\u6210\u529f\u3002"))},
function(){w.hide();return!1});X.setShowBlocking(!1);X.loadConfigInfo(d)},Ga=function(I){J=[];if(d==Ea.YZJ_ROBOT||d==Ea.WXQYH_ROBOT||d==Ea.DINGDING)for(var X=0;X<I.length;X++){var Y=new Tb;Y.fromJsonObject(I[X]);J.push(Y)}else if(d==Ea.MISSION_CLOUD_SERVICE_ACCOUNT)for(X=0;X<I.length;X++)Y=new eb,Y.fromJsonObject(I[X]),J.push(Y)},Pa=function(I){var X=Math.floor(100*parseFloat(I.substring(0,I.length-2)));return"MB"==I.substring(I.length-2,I.length)?1024*X:X},O=function(I){I/=100;return 1024>I?0==I?
I+"KB":I.toFixed(2)+"KB":(1*I/1024).toFixed(2)+"MB"},Ca=function(){D=Va.createTable();Va.setupSingleRowSelection(D);W=D.getSelectionModel();Va.bindTableListenerForCtrl(D);D.setDraggableAdjusting(!0,2,0,new com.kingdee.bos.qing.publish.common.MyCustomExpendor);D.setColumnFitVisibleWidth(!0);var I=new a(D);I.setOutsideVisible(!1);D.setCellRender(I);D.setSyncUIWhenModelChanged(!0);D.addColumns(7);D.getColumn(0).setWidth(130);D.getColumn(1).setWidth(155);D.getColumn(2).setWidth(65);D.getColumn(3).setWidth(138);
D.getColumn(4).setWidth(63);D.getColumn(5).setWidth(80);D.getColumn(6).setWidth(212);I=Va.createHeadRow(D);I.getCell(0).setValue(b.get("pushName","\u540d\u79f0"));I.getCell(1).setValue(b.get("pushFrom","\u6765\u6e90"));I.getCell(2).setValue(b.get("pushTime","\u63a8\u9001\u9891\u7387"));I.getCell(3).setValue(b.get("PushCreateTime","\u521b\u5efa\u65f6\u95f4"));I.getCell(4).setValue(b.get("scheduleEnable","\u542f\u7528\u72b6\u6001"));I.getCell(5).setValue(b.get("fileSize","\u6587\u4ef6\u5927\u5c0f"));
I.getCell(6).setValue(b.get("operation","\u64cd\u4f5c"));/Trident|MSIE/.test(window.navigator.userAgent)||D.setCellAcrossListener(function(X,Y,qa){r&&r.find(".resourceinfo-detaillist-table-op").remove();var ta=X&&0<X.length?X[0]:null;if(q!=ta&&(q&&(c.hideSortingTips($(q)),q=null),1==Y&&1!=qa&&2!=qa&&4!=qa&&6!=qa)){if(!c){c=new f;H=[];for(Y=0;Y<J.length;Y++)H.push(J[Y].toJsonObject());c.setArrJson(H);c.setFunSortchangeListener(function(ua,Ia){Ia||(Ia=new l,Ia.setField("PushCreateTime"),Ia.setOrder(l.ORDER_DESC));
ua=[];for(var Fa=0;Fa<J.length;Fa++)ua.push(J[Fa].toJsonObject());c.setArrJson(ua);c.sortArrJson(ua,Ia,function(Na){Ga(Na);ia()},function(Na){return"fileSize"==Na?"sFileSizeNoFormat":Na})})}c.showSortingTips(X,L[qa]);q=ta}});I=$(D.getUI());I.css("margin-top","67px");I.addClass("sa-qing-publish-manager-content-container");I.children("div:first-child").css("overflow-y","overlay");return I},Oa=function(){r.empty();w.detach();w=$("<div>");var I=$("<div>");I.addClass("no-data-image");Ma.background(I,"no-data");
I.appendTo(w);I=$("<div>");I.addClass("no-push-config-data");I.text(b.get("noData","\u6682\u65e0\u76f8\u5173\u6570\u636e"));I.appendTo(w);w.appendTo(r);w.show()},Ta=function(){w.detach();w=$("<div>");var I=$("<div>");I.addClass("no-data-image");Ma.background(I,"no-data");I.appendTo(w);I=$("<div>");I.addClass("no-search-push-config-data");I.text(b.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));I.appendTo(w);w.appendTo(r);w.show()},Ra=function(I){Va.clearWithoutHead(D);
W.removeAllSelecteds();var X=!1;if(I){for(var Y=0;Y<I.length;Y++){var qa=I[Y],ta=b.get(qa.getSourceType(),"\u4e1a\u52a1\u4e3b\u9898"),ua=Va.createRow(D,!1),Ia=new KTBorderStyle;Ia.setBottomBorderWidth(1);Ia.setBottomBorderPen("solid");Ia.setBottomBorderColor("#E5E5E5");ua.setBorder(Ia);ua.setUserObject(qa);Ia=qa.getName();null!=qa.getNameRule()&&(Ia=Ia+"-\uff08"+b.get("systemDate","\u7cfb\u7edf\u65e5\u671f")+"\uff09");ua.getCell(0).setValue(Ia);ta=ab(qa.getSourceName())?b.get("sourceHadBeDelete",
"\u8be5#\u5df2\u88ab\u5220\u9664").replace("#",ta):qa.getSourceGroupName()+"/"+qa.getSourceName();ua.getCell(1).setValue(ta);ua.getCell(2).setValue(qa.getSchedule().toString());ua.getCell(5).setValue(qa.getFileSize());if(N&&qa.getId()==N.id){X=!0;var Fa=Y}}N=null}Va.refresh(D);X&&(Fa+=Va.getHeadRowCount(),X=W.createRowTarget(Fa),W.addSelected(X),D.scrollCellVisible(Fa,0,!1));Fa=r.find(".sa-publish-item-list-head");for(Y in I)Aa(Fa[Y],I[Y].getName(),p)},ab=function(I){return null==I||0==I.length},
S=function(I,X,Y,qa){qa=qa.getId();(new y(function(ta){},function(ta,ua){I.setOn(Y);return"4300101"==ta?(u.showError(b.get("failToChangScheduleState","\u4fee\u6539\u72b6\u6001\u5931\u8d25\u3002")),!0):!1})).updateScheduleState(X,qa,B.getParamPathPrefix())},R=function(I,X,Y,qa){(new y(function(ta){var ua=new Wc(X,Y,qa);ua.setPushTargetType(d);ua.setFacade(y);ua.showDialog(ta)},function(ta,ua){return"4300101"==ta?(u.showError(b.get("failToGetPushRecord","\u83b7\u53d6\u63a8\u9001\u4fe1\u606f\u5931\u8d25\u3002")),
!0):!1})).loadAllPushRecord(I.getId(),d)},ja=function(I,X,Y){(new y(function(qa){u.showSuccess(b.get("successToEditConfig","\u7f16\u8f91\u63a8\u9001\u4fe1\u606f\u6210\u529f\u3002"));Ka()},function(qa,ta){return"4300101"==qa?(u.showError(b.get("failToEditConfig","\u7f16\u8f91\u63a8\u9001\u4fe1\u606f\u5931\u8d25\u3002")),!0):!1})).updateConfigInfo(I,B.getParamPathPrefix())},U=function(I,X,Y){var qa=I.getId();(new y(function(ta){var ua=X.getRow(Y).getCell(5).getValue();ta=$("."+V[d]).text();ua=Pa(ua);
ta=Pa(ta);ta=O(ta-ua);$("."+V[d]).text(ta);Ka();u.showSuccess(b.get("successToDeletePushConfig","\u5220\u9664\u63a8\u9001\u914d\u7f6e\u4fe1\u606f\u6210\u529f\u3002"))},function(ta,ua){return"4300101"==ta?(u.showError(b.get("failToDeletePushConfig","\u5220\u9664\u63a8\u9001\u914d\u7f6e\u4fe1\u606f\u5931\u8d25\u3002")),!0):!1})).deleteConfigInfo(qa,I.getPushTargetType())},G=function(I){var X=new y(function(Y){var qa="ExtractData"+Y,ta=new uc;K(ta,qa);var ua=I.getId(),Ia=new y(function(Fa){wa(ta,qa);
ta.destroy();Ka();u.showSuccess(b.get("pushImmediatelySuccess","\u63a8\u9001\u6210\u529f\u3002"))},function(Fa,Na,ma){wa(ta,qa);ta.destroy();if(-1==Fa)return!0;if("4300110"==Fa)return u.showPrompt(b.get("networkError","\u7f51\u7edc\u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u3002")),!0;if("1001013"==Fa)return u.showPrompt(b.get("sendMessageError","\u673a\u5668\u4eba\u53d1\u9001\u6d88\u606f\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u673a\u5668\u4ebawebhook\u5730\u5740\u662f\u5426\u6b63\u786e\u3002")),
!0;if("2301013"==Fa)return u.showPrompt(b.get("2301013","\u627e\u4e0d\u5230\u5f15\u7528\u7684\u5730\u56fe\u6a21\u677f\uff0c\u65e0\u6cd5\u63a8\u9001\u3002"),2E3),!0;if(21000008==Fa)return u.showPrompt(b.get("21000008","\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u3010\u8f7b\u5efa\u6a21\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002"),2E3),!0;if(2101019==Fa)return u.showPrompt(b.get("noModelerPermission","\u5c1a\u672a\u83b7\u5f97\u6570\u636e\u8868\u6a21\u578b\u7684\u6570\u636e\u6743\u9650\u3002"),
2E3),!0;if(2101006==Fa){Na=com.kingdee.bos.qing.ui.component.MessageDialog;var Z=new Na;Z.setOptionType(Na.OPTION_OK);Z.setMessage(b.get(Fa.toString(),"\u5c1a\u672a\u83b7\u5f97\u5b9e\u4f53\u6570\u636e\u8868\u7684\u67e5\u770b\u6743\u9650"));ma&&Z.setDetail(ma);Z.showDialog();return!0}return"2101018"==Fa?(Z=b.get("pushError","\u63a8\u9001\u5931\u8d25")+"\uff0c"+b.get("entityNotSupportQingAnalysis","\u4e1a\u52a1\u5b9e\u4f53\u672a\u5f00\u542f\u201c\u652f\u6301\u8f7b\u5206\u6790\u201d\u8bbe\u7f6e\u9879\uff0c\u8bf7\u5728\u5f00\u53d1\u5e73\u53f0\u7684\u5bf9\u5e94\u8868\u5355\u4e2d\u8fdb\u884c\u8bbe\u7f6e   "),
Fa=pb.getSupportQingAnalysisUrl(),Wb(Z,Na,Fa),!0):"4300114"==Fa?(Z=b.get("errorMsg","\u9519\u8bef\u4fe1\u606f\uff1a")+b.get("errorWebhook","\u90e8\u5206Webhook\u5b9a\u65f6\u63a8\u9001\u5931\u8d25"),Ya(Z,Fa,ma),!0):"4300115"==Fa?(Z=b.get("errorMsg","\u9519\u8bef\u4fe1\u606f\uff1a")+b.get("allWebhookFailure","\u5168\u90e8Webhook\u5b9a\u65f6\u63a8\u9001\u5931\u8d25"),Ya(Z,Fa,ma),!0):!1});Ia.setCancelable(!0);Ia.setShowBlocking(!1);Y=Ia.doPush(ua,Y,B.getParamPathPrefix(),I.getPushTargetType());ta.setClosedListener(Y);
ta.showDialog()},function(Y,qa){var ta;2101001==Y?ta=b.get("publishSourceSubjectNotExist","\u539f\u4e1a\u52a1\u4e3b\u9898\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"):2106001==Y?ta=b.get("publishSourceDashboardNotExist","\u539f\u4eea\u8868\u677f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"):2101010==Y||2301010==Y?ta=b.get("themeFileSizeLimit","\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002"):2100001==Y&&(ta=b.get("qingStorageNoSpace","\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u4eba\u5458\u6dfb\u52a0\u78c1\u76d8\u3002"));
return ta?(u.showError(ta),!0):!1});X.setShowBlocking(!1);X.getServerTimeStampForDoPush()},K=function(I,X){fb.subscribeChannel(X,function(Y){za(I,Y)})},wa=function(I,X){fb.unsubscribeChannel(X,function(Y){za(I,Y)})},za=function(I,X){if("pushing"==X)I.setText(b.get("pushing","\u63a8\u9001\u4e2d"));else{var Y=com.kingdee.bos.qing.CodeLoader;Y.setRootPath(".");Y.setCallback(function(){var qa=JSON.parse(X),ta=new com.kingdee.bos.qing.prepare.model.ProgressModel;ta.fromJsonObject(qa);ta.isFinshed()||I.setText(ta.toText())});
Y.loadJs("prepare/publish-prepare.js");Y.loadI18n("prepare","prepare")}},na=function(){var I=new vc;I.setSearchListener(ia);return I},ia=function(){p=n.getInputContent().trim();var I=[];if(c&&c.getShowSortingModel()){H=[];for(var X=0;X<J.length;X++)H.push(J[X].toJsonObject());c.setArrJson(H);c.sortArrJson(H,c.getShowSortingModel(),function(Y){Ga(Y)},function(Y){return"fileSize"==Y?"sFileSizeNoFormat":Y})}if(0<p.length){p=p.toUpperCase();for(X in J)-1<J[X].getName().toUpperCase().indexOf(p)&&I.push(J[X]);
0<I.length?(w.hide(),t.show(),C.show(),ra(I),M(I),Ra(Q)):(m.resetPaginationAndJumpToFirstPage(0),t.hide(),Ta(),C.hide(),m.setJumpToPageListener(function(Y,qa,ta){ta?ta(0):m.refreshPagination()}),$("."+V[d]).text(O(0)))}else w.hide(),t.show(),C.show(),ra(J),M(J),Ra(Q)},Aa=function(I,X,Y){if(I&&X&&Y){Y=Y.toUpperCase();var qa=X.toUpperCase(),ta=qa.split(Y),ua=Y.length,Ia=$("<span>");Ia.addClass("sa-publish-item-list-head-name");for(var Fa in ta){var Na=qa.indexOf(ta[Fa]),ma=X.substr(0,ta[Fa].length);
Na+=ta[Fa].length;var Z=qa.length-Na;qa=qa.substr(Na,Z);X=X.substr(Na,Z);Na=$("<span>");Na.text(ma);Na.appendTo(Ia);if(Fa!==ta.length-1&&1<ta.length){Z=qa.indexOf(Y);ma=X.substr(Z,ua);Z+=ua;var v=qa.length-Z;qa=qa.substr(Z,v);X=X.substr(Z,v);Z=$("<span>");Z.text(ma);Z.css("color","#FF0000");Z.appendTo(Na)}$(I).children(".sa-publish-item-list-head-name").remove()}$(I).text("");Ia.appendTo($(I));$(I).attr("title",Ia.text())}};f.BOX_LEN=15;var Ya=function(I,X,Y){var qa=com.kingdee.bos.qing.ui.component.MessageDialog,
ta=new qa;I=I+"\n"+b.get("errorCode","\u9519\u8bef\u7801\uff1a")+X;ta.setOptionType(qa.OPTION_OK);ta.setMessage(I);Y&&ta.setDetail(Y);ta.showDialog()};l.ORDER_DESC="DESC";l.ORDER_ASC="ASC"};gb.Analysis=Ba;var Hb,cb,$a,Fb,$b,wc,fc,Ob,ac,qb,oc,Ma,Ab,Qb,ya,Ea,Bb,nb,Tb,eb,Ub,Eb,Jb,E,mb,Nb,Zb,b,kb,Da,bb,sb,db,jb,Sa,vb,xb,Va,pc,Rb,Yb,xc,Wa,yc,wb,zc,dc,zb,Ac,hb,Gb,uc,fb,Mb,nc,mc,kc,lc,jc,vc,ic,yb,pb,Bc,Xb,Vb,Cb,tc,sc,qc,hc,gc;(function(){var d=com.kingdee.bos.qing;Hb=d.Seer;cb=d.CodeLoader;d=com.kingdee.bos.qing.publish.common;
$a=d.PublishContext;Fb=d.PublishFactory;$b=d.PublishFacade;wc=d.SinglePublishManagerDialog;Ob=d.PublishToDialog;ac=d.AbstractPublishToPanel;fc=d.AbstractPublishManagerPanel;oc=d.MenuPanel;Ab=d.UserOperationReporter;Qb=d.MultiOperationContainer;uc=d.SchedulePushingDialog;nc=d.SortWidget;mc=d.ListPublishContentPanel;kc=d.PublishManagerSortPanel;lc=d.PublishViewSwitchPanel;jc=d.PublishSearchPanel;ic=d.FilterModelType;yb=d.CardFilterType;d=com.kingdee.bos.qing.timedpush.common;Ma=d.MyIcons;tc=d.PushDetailSettingDialog;
Vb=d.PushRecordDetailSetting;vc=d.PubshSearchPanel;d=com.kingdee.bos.qing.publish.model;ya=d.PublishTargetType;Ea=d.PushTargetType;nb=d.PublishModel;zb=d.PublishSourceType;Jb=d.ThumbnailInfo;qc=d.PermissionConfig;hc=d.PublishContainerType;d=com.kingdee.bos.qing.timedpush.model;Tb=d.ChatRobotSchedulePushConfigModel;Ub=d.PushRecordModel;Eb=d.EmailNameRule;eb=d.MissionCloudPushConfigModel;sc=d.LappPushRecordConfig;d=com.kingdee.bos.qing.common;E=d.DomUtil;mb=d.Util;d=com.kingdee.bos.qing.framework.common;
Nb=d.RemoteFrameworkRegister;Zb=d.AbstractFacade;b=d.MultilanguageManager.createPackageAccessor(gb);fb=d.RemoteFramework;Mb=d.FileUploader;pb=d.OfficialArticleUtil;Bc=d.Resource;Bc.bindLoader(cb);d=com.kingdee.bos.qing.ui.component;kb=d.ComboBox;Da=d.Label;bb=d.TextField;sb=d.TextArea;db=d.AbstractModalDialog;jb=d.TabContainer;Sa=d.MessageDialog;qb=d.SwitchButton;vb=d.F7Selector;xb=d.WorkButton;Rb=d.MessageCurtain;Yb=d.RadioButton;xc=d.RadioButtonGroup;Wa=d.HelpIcon;yc=d.Dialog;Xb=d.List;Cb=d.CheckBox;
zc=d.DropdownSelector;d=com.kingdee.bos.qing.biz.common;Bb=d.ValueTextPair;d=com.kingdee.bos.qing.schedule;dc=d.ScheduleSelector;d=com.kingdee.bos.qing.common.ui;Va=d.TableUtil;pc=d.LocalFileSelector;wb=d.CommonIconUtil;d=com.kingdee.bos.qing.lapp.integration;Ac=d.EnvUtil;hb=d.AppType;Gb=d.RemoteFrameworkUtil;d=com.kingdee.bos.qing.publish.permission;gc=d.PermLabelSettingDialog})();cb.setRootPath(".");cb.loadJs("biz-common/qing-biz-common.js");cb.loadSkinCss("biz-common","biz-common");cb.loadSkinJs("biz-common",
"skin");cb.loadI18n("biz-common","biz-common");var fa,ib=com.kingdee.bos.qing.lapp.integration.SERVER_HOST_URL,Wb=function(d,u,g){var h=new Sa;h.setOptionType(Sa.OPTION_OK);h.setMessage(d);u&&h.setDetail(u);g&&h.setCustomPainter(function(e,a){var f=$("<div class='sa-ctrl-msgdlg-text'>");f.css("bottom",20);f.text(a);a=$("<a onclick='javascript:window.open(\""+g+"\");' href='#'>");a.css({cursor:"pointer",color:"#5582f3"});a.text(b.get("viewDocument","\u67e5\u770b\u5e2e\u52a9\u6587\u6863"));f.append(a);
e.append(f)});h.showDialog()},tb=new function(){this.uploadBase64Image=function(g,h,e,a,f){fa.isPrivate()?u(g,h,e,a,f):d(g,h,e,a,f)};var d=function(g,h,e,a,f){if(mb.isIEBrowser()&&window.XDomainRequest)g=new XDomainRequest,g.timeout=1E4,a=ib+"image/uploadImage",a=a.replace("https:",window.location.protocol),g.open("POST",a),g.send(f),g.onload=function(r){r=JSON.parse(r.target.responseText);h(r.data.path)},g.onerror=function(){e&&e(500,"fail to upload thumbnail")};else{g=new FormData;g.append("picture[]",
f);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState)if(200==l.status)try{var r=JSON.parse(l.responseText);"number"==typeof r.errorCode&&3099003==r.errorCode?e&&e(r.errorMessage):h(r.data.path)}catch(D){e&&e(200,"parse error")}else e&&e(l.status,"fail to upload thumbnail")};l.open("POST",ib+"image/uploadImage",!0);l.send(g)}},u=function(g,h,e,a,f){g=atob(f.split(",")[1]);a=[];for(f=0;f<g.length;f++)a.push(g.charCodeAt(f));g=new Blob([new Uint8Array(a)],{type:"image/png"});
var l=new File([g],new Date+".png");g=new Mb;g.setShowBlocking(!1);g.setRequestPreparer(function(r){r.append("filename",l)});g.setFinishedHandler(function(r,D,C){r&&(3099003==D?e&&e(D,C):e&&e(500,"fail to upload thumbnail"))});g.setSuccessHandler(function(r){h(r.data)});a=Nb.getUploadUrl();g.uploadTo(a)};this.downloadImage=function(g){return fa.isPrivate()?fb.getLoadImgUrl(g,"lapp-thumbnail"):ib+"image/downloadImage?path="+g}};Fb.addPublishFacade(ya.MOBILE,va);gb.PublishToYunzhijiaDialogFactory=new function(){this.createDialog=
function(d,u,g){u=new Dc(u);u.setPublishContext(g);g=u.getNewPublishSuccessCallback();d=new Ob(d,u);g&&d.addSuccessCallback(g);return d}};Fb.addPublishToPanel(ya.MOBILE,function(d,u){lb.call(this,d);var g=this,h=this.protectedMethod,e,a,f,l,r,D,C,w,n,k,p,m,t,c,q,z,L,B,y=new Ba,aa,V=!1,pa;this.getWidth=function(){return 850};this.getHeight=function(){return 600};this.createPreviewViewer=function(){if(!h.isDsbPublish()){a=$("<iframe>");a.addClass("sa-qing-publish-lapp-preview-iframe");var S=h.getPublishContext(),
R={from:"LAPP_MESSAGE",layoutType:Ba.LT_NORMAL,model:S.getCurrentContentModel().schemaContent,isDraggable:!1};a.attr("src",S.getMobilePreviewUrl());a.on("load",function(U){a[0].contentWindow.postMessage(JSON.stringify(R),S.getMobilePreviewUrl())});var ja=new Gc;ja.setContent(a);return ja}};var N=function(S){var R=h.getPublishContext(),ja=$("<div>");ja.addClass("qing-publish-info-wrapper");ja.css("padding-right","10px");var U=(new Da(b.get("publishSetting","\u53d1\u5e03\u8bbe\u7f6e\uff1a"))).getJqUi();
U.addClass("qing-publish-info-label");E.layoutCtrlWithLRTB(U,0,0,null,0,null,23);ja.append(U);U=$("<div>");U.addClass("qing-publish-info-item");U.css({height:"35px","margin-top":"3px"});var G=new Da,K=b.get("","\u79fb\u52a8\u529e\u516c\u5e73\u53f0");G.setRequired(!0);G.setText(K);G.setTooltips(K);G=G.getJqUi();G.addClass("qing-publish-info-label");E.layoutCtrl(G,0,0,105,35);U.append(G);G=W(S).getJqUi();E.layoutCtrl(G,115,0,250,35);U.append(G);var wa=$("<div>");wa.addClass("qing-publish-info-item");
G=new Da;K=b.get("publishName","\u53d1\u5e03\u540d\u79f0");G.setRequired(!0);G.setText(K);G.setTooltips(K);G=G.getJqUi();G.addClass("qing-publish-info-label");E.layoutCtrl(G,0,0,105,23);wa.append(G);l=new bb;var za=$("<div>");l.addEditedListener(function(){var Ya=new Pb;Ya.setPublishContext(R);Ya.editPublishNameListener(r.getSelected().getValue(),l,!1,!1,28,wa,za)});l.addBlurListener(function(){za.remove()});G=l.getJqUi();wa.append(G);E.layoutCtrl(G,115,0,250,23);G=new Da(b.get("publishPath","\u53d1\u5e03\u8def\u5f84"));
G.setRequired(!0);var na=G.getJqUi();na.addClass("qing-publish-info-label");E.layoutCtrl(na,0,0,105,23);r=ra();K=r.getJqUi();var ia=ca();E.layoutCtrl(ia,347,4,18,18);E.layoutCtrl(K,115,0,227,23);G=$("<div>");G.addClass("qing-publish-info-item");G.append(na);G.append(K);G.append(ia);na=$("<div>");na.css("margin-top","28px");na.addClass("qing-publish-info-items-block");na.append(U);na.append(wa);na.append(G);ja.append(na);G=R.getHasDirectModeTable();na=R.isHaveToCarryData();R.supportPublishWithCarryData()&&
(ia=new Da,U=ia.getJqUi(),K=b.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"),ia.setText(K),ia.setTooltips(K),U.addClass("qing-publish-info-label"),E.layoutCtrl(U,0,0,105,23),n=new qb,G?(n.setOn(!1),n.setEnabled(!1)):na?(n.setOn(!0),n.setEnabled(!1)):n.setOn(!1),ia=n.getJqUi(),E.layoutCtrl(ia,115,0,250,23),K=$("<div>"),K.addClass("qing-publish-info-item"),K.append(U),K.append(ia),U=$("<div>"),U.addClass("qing-publish-info-items-block"),U.append(K),ja.append(U));U=$("<div>");U.addClass("qing-publish-info-items-block");
R.supportPublishWithCarryData()&&U.css("height","245px");ja.append(U);if(R.getScene()==$a.Scene.Longer){K=new Da;K.setRequired(!0);K.setText(b.get("layoutType","\u5c55\u793a\u6a21\u5f0f"));K=K.getJqUi();K.addClass("qing-publish-info-label");E.layoutCtrl(K,0,0,105,23);f=new kb;ia=[new ub(b.get("standard","\u6807\u51c6"),Ba.LT_NORMAL),new ub(b.get("fitWidth","\u9002\u5e94\u5bbd\u5ea6"),Ba.LT_WIDTH),new ub(b.get("fitHeight","\u9002\u5e94\u9ad8\u5ea6"),Ba.LT_HEIGHT),new ub(b.get("fitScreen","\u9002\u5e94\u5c4f\u5e55"),
Ba.LT_ALL)];f.setItemModels(ia);f.setSelected(ia[0]);f.addSelectedChangedListener(H);ia=f.getJqUi();E.layoutCtrl(ia,115,0,250,23);var Aa=$("<div>");Aa.addClass("qing-publish-info-item");Aa.append(K);Aa.append(ia);U.append(Aa)}Aa=new Da;ia=Aa.getJqUi();K=b.get("description","\u63cf\u8ff0");Aa.setText(K);Aa.setTooltips(K);ia.addClass("qing-publish-info-label");E.layoutCtrl(ia,0,0,105,23);D=new sb;K=D.getJqUi();E.layoutCtrl(K,115,0,250,50);Aa=$("<div>");Aa.addClass("qing-publish-info-item");Aa.css("height",
"50px");Aa.append(ia);Aa.append(K);U.append(Aa);Aa=new Da;ia=Aa.getJqUi();K=b.get("bottomAnnotation","\u5e95\u90e8\u5907\u6ce8");Aa.setText(K);Aa.setTooltips(K);ia.addClass("qing-publish-info-label");E.layoutCtrl(ia,0,0,105,23);w=new bb;K=w.getJqUi();E.layoutCtrl(K,115,0,250,23);Aa=$("<div>");Aa.addClass("qing-publish-info-item");Aa.append(ia);Aa.append(K);U.append(Aa);C=new Ib(R,h.createFacade,h.getOuterMessageCurtain());C.setSchedulable(!G&&!na);C.getJqUi();G=new Da;K=b.get("displayStyle","\u5448\u73b0\u65b9\u5f0f");
G.setText(K);G.setTooltips(K);G=G.getJqUi();G.addClass("qing-publish-info-label");E.layoutCtrl(G,0,0,105,23);p=new kb;ia=h.getDisplayStyles();p.setItemModels(ia);p.setSelected(ia[0]);na=p.getJqUi();q=ea(R);E.layoutCtrl(q,347,13,18,18);E.layoutCtrl(na,115,0,227,23);K=$("<div>");K.addClass("qing-publish-info-item");K.append(G);K.append(na);K.append(q);U.append(K);G=new Da;B=G.getJqUi();K=b.get("landscapeDefault","\u9ed8\u8ba4\u6a2a\u5c4f\u6253\u5f00");G.setText(K);G.setTooltips(K);B.addClass("qing-publish-info-label");
E.layoutCtrl(B,0,0,105,23);k=new qb;k.setOn(!1);L=k.getJqUi();E.layoutCtrl(L,115,0,250,23);G=$("<div>");G.addClass("qing-publish-info-item");G.append(B);G.append(L);U.append(G);ha();S.append(ja)},W=function(S){var R=fa.getPublishLappConfigs();for(S=0;S<R.length;S++)if(fa.getLappUserType()==R[S].getLappUserType()){var ja=R[S];break}ja||(ja=R[0]);S=new zc;S.setSelectedModel(ja);S.setDropdownCreator(function(U,G,K){G=J(R,G,K).getJqUi();G.appendTo(U);E.layoutCtrlWithLRTB(G,0,0,null,0,0,null);return[-1,
35*R.length]});S.setCustomPainter(function(U,G){G.empty();U=Q(U);U.css("top","-5px");G.append(U)});return S},J=function(S,R,ja){var U=S[S.length-1],G=new Xb;G.setToggleSelectingEnabled(!1);G.setItemModels(S);G.setSelecteds([R]);G.setCustomItemPainter(function(K,wa){var za=Q(wa);za.css({margin:"auto",top:"1px"});K.append(za);K.css("height","34px");U!=wa&&(wa=$("<div>"),wa.addClass("qing-publish-app-item-separator"),K.append(wa))});G.addSelectedChangedListener(function(K,wa,za){var na=wa[0];K=za[0];
na!=K&&(h.toggleLappContext(K.getAppType()),ja&&ja(K),fa.getLappUserId()?(t&&t.show(),e=null,Pa(r),x(),ha()):(K=h.createLappUserIdNullMessageDialog(),K.setClosingChecker(function(ia){h.toggleLappContext(na.getAppType());ja&&ja(na);return!0}),K.showDialog()))});return G},Q=function(S){if(S){var R=$("<div>");R.addClass("qing-publish-lapp-icon");if(S.getAppType()==hb.THIRDPARTY){var ja=$("<img>");ja.appendTo(R);E.layoutCtrl(ja,0,0,"100%","100%");S=fb.getLoadImgUrl(S.getAppImageFile(),"image-library");
ja.attr("src",S)}else ja="icon_"+S.getAppType(),Ma.background(R,ja);return R}},H=function(S,R,ja){S={from:"LAPP_MESSAGE",layoutType:ja.getValue()};a[0].contentWindow.postMessage(JSON.stringify(S),window.location.href)},ca=function(){var S=$("<span>");S.css("cursor","pointer");S.attr("title",b.get("publishManage","\u53d1\u5e03\u7ba1\u7406"));Ma.background(S,"publish_manager");S.on("click",function(){var R=new ec(g.getRemoteImpl());R.setPublishContext(g.getPublishContext());R.setHasLappContext(!0);
R.setPathSelectorModel(e,Ka);R.setPublishContentEditEntrance(g.getPublishContentEditEntrance());R=new wc(R);R.setClosedCallback(function(ja){e=ja.getPathSelectorModel();Ka=ja.getDirectoryMap();r.setItemModels(e);if(ja=r.getSelected()){for(var U=null,G=0;G<e.length;G++){var K=e[G];if(K.getValue()==ja.getValue()){U=K;break}}r.setSelected(U)}});R.showDialog()});return S},ea=function(S){var R=$("<div>");R.addClass("sa-ctrl-f7selector-btn");R.addClass("sa-ctrl-f7selector-btnedit");R.css("cursor","pointer");
S.getScene()==$a.Scene.Longer?R.attr("title",b.get("editThumbnailAndSchedule","\u7f16\u8f91\u7f29\u7565\u56fe\u548c\u66f4\u65b0\u7b56\u7565")):R.attr("title",b.get("editSchedule","\u7f16\u8f91\u66f4\u65b0\u7b56\u7565"));Ma.background(R,"btn_edit");R.on("click",function(){C.showThumbnailCutSettingDialog()});return R};this.protectedCreateContainer=function(){var S=$("<div>");E.layoutCtrlWithLRTB(S,0,0,null,0,0,null);t=$("<div>");t.addClass("lapp-publish-edit-panel");h.isDsbPublish()?T(t):N(t);var R=
$("<div>");R.addClass("qing-publish-info-wrapper");R.css("padding-left","10px");c=h.createPermConfigPanel(null,g.getPublishContext().getSpaceID());var ja=c.getJqUi();R.append(ja);t.append(R);S.append(t);return S};this.protectedIsOnlyYzj=function(){return!1};var T=function(S){var R=h.getPublishContext(),ja=$("<div>");ja.addClass("qing-publish-info-wrapper");ja.css("padding-right","10px");var U=(new Da(b.get("publishSetting","\u53d1\u5e03\u8bbe\u7f6e\uff1a"))).getJqUi();U.addClass("qing-publish-info-label");
E.layoutCtrlWithLRTB(U,0,0,null,0,null,23);ja.append(U);U=$("<div>");U.addClass("qing-publish-info-item");U.css({height:"35px","margin-top":"3px"});var G=new Da,K=b.get("","\u79fb\u52a8\u529e\u516c\u5e73\u53f0");G.setRequired(!0);G.setText(K);G.setTooltips(K);K=G.getJqUi();K.addClass("qing-publish-info-label");E.layoutCtrl(K,0,0,105,35);U.append(K);K=W(S).getJqUi();E.layoutCtrl(K,115,0,250,35);U.append(K);var wa=$("<div>");wa.addClass("qing-publish-info-item");G=new Da;K=b.get("publishName","\u53d1\u5e03\u540d\u79f0");
G.setRequired(!0);G.setText(K);G.setTooltips(K);K=G.getJqUi();K.addClass("qing-publish-info-label");E.layoutCtrl(K,0,0,105,23);wa.append(K);l=new bb;var za=$("<div>");l.addEditedListener(function(){(new Pb).editPublishNameListener(r.getSelected().getValue(),l,!1,!0,28,wa,za)});l.addBlurListener(function(){za.remove()});K=l.getJqUi();wa.append(K);E.layoutCtrl(K,115,0,250,23);K=new Da(b.get("publishPath","\u53d1\u5e03\u8def\u5f84"));K.setRequired(!0);G=K.getJqUi();G.addClass("qing-publish-info-label");
E.layoutCtrl(G,0,0,105,23);r=ra();var na=r.getJqUi(),ia=ca();E.layoutCtrl(ia,347,4,18,18);E.layoutCtrl(na,115,0,227,23);K=$("<div>");K.addClass("qing-publish-info-item");K.append(G);K.append(na);K.append(ia);G=$("<div>");G.css("margin-top","28px");G.addClass("qing-publish-info-items-block");G.append(U);G.append(wa);G.append(K);ja.append(G);U=R.getHasDirectModeTable();G=R.isHaveToCarryData();na=new Da;R=na.getJqUi();K=b.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e");na.setText(K);
na.setTooltips(K);R.addClass("qing-publish-info-label");E.layoutCtrl(R,0,0,105,23);n=new qb;U?(n.setOn(!1),n.setEnabled(!1)):G?(n.setOn(!0),n.setEnabled(!1)):n.setOn(!1);K=n.getJqUi();E.layoutCtrl(K,115,0,250,23);U=$("<div>");U.addClass("qing-publish-info-item");U.append(R);U.append(K);R=$("<div>");R.addClass("qing-publish-info-items-block");R.append(U);ja.append(R);R=$("<div>");R.addClass("qing-publish-info-items-block");R.css("height","245px");ja.append(R);G=new Da;U=G.getJqUi();K=b.get("description",
"\u63cf\u8ff0");G.setText(K);G.setTooltips(K);U.addClass("qing-publish-info-label");E.layoutCtrl(U,0,0,105,23);D=new sb;K=D.getJqUi();E.layoutCtrl(K,115,0,250,50);G=$("<div>");G.addClass("qing-publish-info-item");G.css("height","50px");G.append(U);G.append(K);R.append(G);G=new Da;U=G.getJqUi();K=b.get("bottomAnnotation","\u5e95\u90e8\u5907\u6ce8");G.setText(K);G.setTooltips(K);U.addClass("qing-publish-info-label");E.layoutCtrl(U,0,0,105,23);w=new bb;K=w.getJqUi();E.layoutCtrl(K,115,0,250,23);G=$("<div>");
G.addClass("qing-publish-info-item");G.append(U);G.append(K);R.append(G);U=new Da;K=b.get("displayStyle","\u5448\u73b0\u65b9\u5f0f");U.setText(K);U.setTooltips(K);U=U.getJqUi();U.addClass("qing-publish-info-label");E.layoutCtrl(U,0,0,105,23);p=new kb;K=h.getDisplayStyles();p.setItemModels(K);p.setSelected(K[0]);K=p.getJqUi();q=M();E.layoutCtrl(q,347,13,18,18);E.layoutCtrl(K,115,0,227,23);G=$("<div>");G.addClass("qing-publish-info-item");G.append(U);G.append(K);G.append(q);R.append(G);S.append(ja)},
M=function(){var S=$("<div>");S.addClass("sa-ctrl-f7selector-btn");S.addClass("sa-ctrl-f7selector-btnedit");S.css("cursor","pointer");S.attr("title",b.get("editThumbnailBtn","\u7f16\u8f91\u7f29\u7565\u56fe"));Ma.background(S,"btn_edit");var R=function(ja,U,G){z=U;G&&(m=ja)};S.on("click",function(){(new com.kingdee.bos.qing.imagelib.choose.ui.ChooseThumbnailDialog(m,z,R)).show()});return S},ra=function(){var S=new kb;Pa(S);return S},x=function(){var S=h.getDisplayStyles();p.setItemModels(S);p.setSelected(S[0])},
ha=function(){h.supportLandscape()?(B&&B.show(),L&&L.show()):(B&&B.hide(),L&&L.hide())},Ka={},Ga=function(S){for(var R=[],ja=0;ja<S.length;ja++){var U=new Lb;U.fromJsonObject(S[ja]);Ka[U.getId()]=U;var G=new Bb;G.setValue(U.getId());G.setText(U.getName());R.push(G)}return R},Pa=function(S){if(null==e){var R=new ka("lappDirectoryMgr",function(ja){e=Ga(ja);S.setItemModels(e);S.setSelected(e[0]);S.setCustomPainter(function(U,G,K){K?(U=K.getText(),G.text(U)):0<e.length&&S.setSelected(e[0])})},function(ja,
U){h.getOuterMessageCurtain().showPrompt(U,2E3);return!0});R.setShowBlocking(!1);R.getOwnDirList()}else S.setItemModels(e),S.setSelected(e[0])};this.isEditPublish=function(){return!1};this.getModelFromUI=function(){var S=h.getPublishContext(),R=new nb;R.setPublishSourceType(S.getCurrentSourceType());R.setPublishTargetType(g.getPublishTargetType());R.setTagId(S.getBizTag());R.setName($.trim(l.getText()));R.setPath("lightapp");R.setPathText("lightapp");R.setAnalysis(!0);R.setSchemeId(nb.CURRENT_SCHEMA_ID);
R.setSpaceID(S.getSpaceID());if(S=c?c.getPermissionConfig():null){R.setRoles(S.getRoles());var ja=S.getUsers();var U=aa;if(U){for(var G=[],K=0;K<ja.length;K++){var wa=ja[K],za=wa.getValue();-1==U.indexOf(za)&&G.push(wa)}ja=G}R.setUsers(ja);R.setPermLabels(S.getPermLabels())}R.setId(pa);n&&R.setCarryData(n.isOn());aa&&R.setFailedUserIds(aa);return R};this.getJsonModel=function(){return h.getPublishContext().getCurrentContentModel()};var O=function(S){return null==S||0==$.trim(S).length},Ca=function(S){var R=
new com.kingdee.bos.qing.imagelib.model.ThumbnailUrlModel,ja=R.getImagePathFromJson(z);R.checkHasImage(ja,S)};this.checkUIInput=function(S){if(null==fa||!fa.getLappUserId())return b.get("lappUserIdNull","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\u3002");var R=l.getText();if(O(R))return b.get("publishNameNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u540d\u79f0\u3002");if(50<R.length&&50<D.getText().length&&!O(w.getText())&&50<w.getText().length)return b.get("NameAndDesAndAnnoCanNotExceedLimit50Tip",
"\u53d1\u5e03\u540d\u79f0\u3001\u63cf\u8ff0\u957f\u5ea6\u548c\u5e95\u90e8\u5907\u6ce8\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(50<R.length&&50<D.getText().length)return b.get("NameAndDesCanNotExceedLimit50Tip","\u53d1\u5e03\u540d\u79f0\u3001\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(50<R.length&&!O(w.getText())&&50<w.getText().length)return b.get("NameAndAnnoCanNotExceedLimit50Tip","\u53d1\u5e03\u540d\u79f0\u3001\u5e95\u90e8\u5907\u6ce8\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");
if(50<D.getText().length&&!O(w.getText())&&50<w.getText().length)return b.get("DesAndAnnoCanNotExceedLimit50Tip","\u63cf\u8ff0\u957f\u5ea6\u3001\u5e95\u90e8\u5907\u6ce8\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(50<R.length)return b.get("publishNameTooLongTip","\u53d1\u5e03\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(r.getSelected()){if(50<D.getText().length)return b.get("descriptionCanNotExceedLimit50Tip","\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");
if(!O(w.getText())&&50<w.getText().length)return b.get("bottomAnnotationCanNotExceedLimit50Tip","\u5e95\u90e8\u5907\u6ce8\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");var ja=function(){var U=h.getPublishContext().getBizTag(),G=function(Ya,I){},K=function(Ya){var I=new ka("lappAnalysisMgr",function(X){if(X){var Y=new Ba;Y.fromJsonObject(X);pa=Y.getPublishId();X=new va(d,function(qa){var ta=qa.permissionId;qa.sameSource?Oa(S,Ya,ta):(pa=null,h.getOuterMessageCurtain().showPrompt(b.get("duplicateName",
"\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0\u3002"),2E3),S(!1))},function(){return!1});X.setShowBlocking(!0);X.checkSameSource(pa,U)}else Ra(S,Ya,!1,!1)},function(X,Y){h.getOuterMessageCurtain().showPrompt(Y,2E3);S(!1);return!0});I.setShowBlocking(!1);I.getAnalysisInfo(r.getSelected().getValue(),R)},wa=[],za=[],na=c?c.getPermissionConfig():null;if(na){var ia=na.getRoles();if(ia&&0<ia.length)for(var Aa=0;Aa<ia.length;Aa++)wa.push(ia[Aa].getValue());if((na=
na.getPermLabels())&&0<na.length)for(Aa=0;Aa<na.length;Aa++)za.push(na[Aa].getId())}0<wa.length||0<za.length?(G=new va(d,K,G),K=h.getPublishContext().getScene(),G.loadUserIdsByRoleIdAndPermLabelId(wa,za,K)):K([])};Ca(function(U){U?ja():(h.getOuterMessageCurtain().showPrompt(b.get("imgHasBeenDeleted","\u201c\u7f29\u7565\u56fe\u201d\u5f15\u7528\u7684\u56fe\u7247\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")),S(!1))})}else return b.get("publishPathNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u8def\u5f84\u3002");
return null};var Oa=function(S,R,ja){var U=h.getPublishContext().getCurrentSourceType(),G=b.get(U,U);U=$(document.body);var K=$("<div class='sa-ctrl-common-modallayer'>");K.appendTo(U);var wa=new yc(K),za=b.get("operateConfirm","\u64cd\u4f5c\u786e\u8ba4");wa.setTitle(za);za=U.prop("clientWidth");var na=U.prop("clientHeight");wa.setBounds(za-300>>1,na-200>>1,300,200);wa.setToolbarVisible(!1);za=$("<div>");na=b.get("publishSameSourceNameDuplicate","\u8be5#1\u5df2\u53d1\u5e03\u8fc7\u540c\u540d\u83dc\u5355\uff0c\u786e\u5b9a\u8981\u8986\u76d6\u5417\uff1f").replace("#1",
G);G=$("<span>");G.text(na);G.attr("title",na);var ia=b.get("isAddOldPermission","\u540c\u65f6\u6388\u6743\u7ed9\u539f\u83dc\u5355\u5df2\u6388\u6743\u7684\u7528\u6237\u548c\u89d2\u8272");na=(new Da(ia)).getJqUi();na.attr("title",ia);var Aa=new qb;ia=Aa.getJqUi();E.layoutCtrl(G,5,10,270,23);E.layoutCtrl(na,5,45,210,23);E.layoutCtrlWithLRTB(ia,215,null,31,47,null,19);G.appendTo(za);na.appendTo(za);ia.appendTo(za);wa.setContent(za);wa.addClosingListener(function(Ya,I){I?(V=!0,Aa.isOn()&&(R=R.concat(ja)),
Ra(S,R,!0,Aa.isOn())):(pa=null,S(!1));Ya.destroy();K.remove();return!0});wa.showFooterPane();wa.show();K.appendTo(U)},Ta=function(){if(a){try{return a[0].contentWindow.com.kingdee.bos.qing.lapp.scene.LappLongerUtil.getLoadStatus()}catch(S){console.log(S)}return!1}return!0},Ra=function(S,R,ja,U){var G=[],K=c?c.getPermissionConfig():null;K&&(G=g.getUserIdsByValueTextPair(K.getUsers()));G=h.getNotDuplicatedUserIds(G,R);var wa=function(za,na){y.setAuthorizedUsers(za);h.isDsbPublish()?(za=m)?h.cutAndUploadImageToCloud(za,
function(ia){m=ia},S,!1,ja,U,na):(S(!0,!1,ja,U),na&&na()):(za=function(){var ia=C.getBase64Img();h.cutAndUploadImageToCloud(ia,function(Aa){m=Aa},S,!1,ja,U,na)},C.needInitLongerThumbnailImage(a)?Ta()?C.initLongerThumbnailImage(a,za):(h.getOuterMessageCurtain().showPrompt(b.get("inLoadTip","\u6b63\u5728\u751f\u6210\u7f29\u7565\u56fe\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"),2E3),S(!1)):za())};0<G.length?h.getLappContextsByUserSelector(G,function(za,na,ia,Aa){aa=na;wa(za,Aa)},function(){S(!1);return!0}):
wa([])},ab=function(S){var R=h.getPublishContext(),ja=fa.getScene();y.setScene(ja);y.setParentId(r.getSelected().getValue());y.setCreatorName(fa.getUserName());y.setName(l.getText());y.setCardDesc(D.getText());y.setUploadData(!1);ja=R.getLappEntranceUrl();ja=gb.LappIntegration.getRealPublishUrl(ja,R.getParamPathPrefix(),fa.getConfiguredPublishUrlPrefix());ja=mb.appendParamToUrl(ja,"accountId",fa.getAccountId());ja=mb.appendParamToUrl(ja,"publishId",S.getId());ja=fa.appendExtraPublishUrlParam(ja);
if(h.isDsbPublish()){var U=R.getCurrentContentModel(),G=new com.kingdee.bos.qing.dsb.model.DashboardModel;G.fromJsonObject(U);G.getPage().isMobileDesired()&&p.getSelected().getValue()==Ba.DISPLAYSTYLE_EXECUTION&&(U=G.getPage().getHeight(),ja=mb.appendParamToUrl(ja,"height",U))}y.setUrl(ja);y.setLayoutType(f?f.getSelected().getValue():Ba.LT_NORMAL);y.setLargeThumbnail(m);y.setSmallThumbnail(m);y.setPublishId(S.getId());y.setBottomAnnotation(w.getText());k&&y.setLandscape(k.isOn());p&&y.setDisplayStyle(p.getSelected().getValue());
h.isDsbPublish()?y.setViewType(Ba.VIEW_TYPE_DASHBOARD):R.getScene()==$a.Scene.Square?y.setViewType(Ba.VIEW_TYPE_SQUARE):y.setViewType(Ba.VIEW_TYPE_LONGER);y.setSpaceID(S.getSpaceID());y.setModifierName(S.getModifierName());return y};this.getNewPublishSuccessCallback=function(){return function(S,R,ja){var U=fa.getScene(),G=ab(S),K=new ka("lappAnalysisMgr",function(wa){if(h.isDsbPublish())!ja&&R.showSuccess(b.get("publishSuccess","\u53d1\u5e03\u6210\u529f\u3002"));else{G.setId(wa);var za=C.getThumbnailInfo();
za.setAnalysisId(wa);za.setPublishId(S.getId());G.getViewType()==Ba.VIEW_TYPE_SQUARE&&(za.setApertureWidth(300),za.setApertureHeight(150));wa=h.createFacade(function(na){V=!1;!ja&&R.showSuccess(b.get("publishSuccess","\u53d1\u5e03\u6210\u529f\u3002"));na.isConAvailable||(na=new Sa,na.setOptionType(Sa.OPTION_OK),na.setMessage(b.get("connectImageServerFail","\u5f53\u524d\u670d\u52a1\u5668\u65e0\u6cd5\u8fde\u63a5\u5230\u4e91\u7aef\u56fe\u7247\u670d\u52a1\u5668\uff0c\u7f29\u7565\u56fe\u8c03\u5ea6\u66f4\u65b0\u529f\u80fd\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528\u3002")),
na.showDialog())},function(na,ia){V=!1;h.getOuterMessageCurtain().showPrompt(b.get("publishFailed","\u53d1\u5e03\u5931\u8d25\uff1a")+ia,2E3)});wa.setShowBlocking(!1);wa.saveThumbnailInfo(za,V)}},function(wa,za){V=!1;h.getOuterMessageCurtain().showPrompt(b.get("publishFailed","\u53d1\u5e03\u5931\u8d25\uff1a")+za,2E3)});K.setShowBlocking(!1);K.saveAnalysis(G,fa.getEId(),U,!1,V)}};this.getAnalysisSchemaArray=function(){return null}});Kb.LAPP_CONFIGURE_FILE_URL="https://q.kdcloud.com/qing-releasenote/lappConfigurationDocument.do?productType=";
Fb.addPublishManagePanel(ya.MOBILE,ec);Ba.LT_NORMAL="NORMAL";Ba.LT_WIDTH="WIDTH";Ba.LT_HEIGHT="HEIGHT";Ba.LT_ALL="ALL";Ba.LT_ADAPT="ADAPT";Ba.VIEW_TYPE_LONGER="1";Ba.VIEW_TYPE_SQUARE="2";Ba.VIEW_TYPE_DASHBOARD="3";Ba.DISPLAYSTYLE_THUMNAIL="1";Ba.DISPLAYSTYLE_EXECUTION="2";var Za=new function(){var d={},u={};this.registMobileSchedulePushUIPane=function(g,h,e){d[g]=h;u[g]=e};this.getIconName=function(g){return d[g]};this.getPushUIPane=function(g,h,e,a,f,l){var r=u[g];if(null==r)return null;r=new r;
r.setPushTargetType(g);r.setEditMode(!1);r.setPublishContext(h);r.setCreateFacadeMethod(e);r.setOuterMessageCurtain(a);r.setPushSchemaEditEntrance(f);r.setDesigner(l);return r};this.registMobileSchedulePushUIPane(Ea.DINGDING,"icon_dingding_off",null)};Za.registMobileSchedulePushUIPane(Ea.YZJ_ROBOT,"icon_yzj",Sb);Za.registMobileSchedulePushUIPane(Ea.WXQYH_ROBOT,"icon_wxqyh",Sb);Za.registMobileSchedulePushUIPane(Ea.DINGDING,"icon_dingding",Sb);Za.registMobileSchedulePushUIPane(Ea.MISSION_CLOUD_SERVICE_ACCOUNT,
"icon_missioncloud",function(){Db.AbstractTabPane.call(this);rc.call(this);var d=this,u,g,h,e,a,f=eb.PUSH_TO_GROUP;this.into=function(){u&&(d.clear(),a.setChecked(!0),h.setText(""),g.setText(""))};this.protectedGetModelFromUI=function(){var w=new eb;w.setPushToTarget(f);w.setUserIds(D());w.setGroupIds(C());return w};this.protectedGetGapHeight=function(){return 16};this.protectedGetJqCustomUI=function(){u||l();return u};this.protectedGetCustomUIHeight=function(){return 62};this.protectedCheckUIInput=
function(){if(f==eb.PUSH_TO_GROUP){var w=C();if(d.isEmpty(w))return d.getOuterMessageCurtain().showPrompt(b.get("group","\u7fa4\u7ec4")+b.get("canNotBeEmpty","\u4e0d\u80fd\u4e3a\u7a7a\u3002")),!1;if(!/^[0-9,]*$/.test(w))return d.getOuterMessageCurtain().showPrompt(b.get("illegalGroupInput","\u7fa4\u7ec4\u53ea\u80fd\u8f93\u5165\u6570\u5b57\u548c\u82f1\u6587\u9017\u53f7\u3002")),!1;if(255<w.length)return d.getOuterMessageCurtain().showPrompt(b.get("group","\u7fa4\u7ec4")+b.get("inputTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7#1\u5b57\u7b26\u3002").replace("#1",
255)),!1}else{w=D();if(d.isEmpty(w))return d.getOuterMessageCurtain().showPrompt(b.get("user","\u7528\u6237")+b.get("canNotBeEmpty","\u4e0d\u80fd\u4e3a\u7a7a\u3002")),!1;if(255<w.length)return d.getOuterMessageCurtain().showPrompt(b.get("user","\u7528\u6237")+b.get("inputTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7#1\u5b57\u7b26\u3002").replace("#1",255)),!1}return!0};var l=function(){u=$("<div>");var w=new Da;w.setRequired(!0);w.setText(b.get("pushTarget","\u63a8\u9001\u76ee\u6807"));var n=new xc;
a=new Yb;a.setChecked(!0);a.setText(b.get("group","\u7fa4\u7ec4"));a.setUserObject(eb.PUSH_TO_GROUP);n.addElement(a);e=new Yb;e.setText(b.get("user","\u7528\u6237"));e.setUserObject(eb.PUSH_TO_USER);n.addElement(e);h=new bb;h.setPlaceholder(b.get("enterUserId","\u8bf7\u8f93\u5165\u7528\u6237id\uff0c\u591a\u4e2a\u7528\u6237id\u7528\u82f1\u6587\u9017\u53f7\u5206\u5272"));g=new bb;g.setPlaceholder(b.get("enterGroupTag","\u8bf7\u8f93\u5165\u5206\u7ec4id\uff0c\u591a\u4e2a\u5206\u7ec4id\u7528\u82f1\u6587\u9017\u53f7\u5206\u5272"));
w=w.getJqUi();var k=a.getJqUi(),p=e.getJqUi(),m=g.getJqUi(),t=h.getJqUi();t.css("display","none");n.addChangedListener(function(c){f=c.getUserObject();c=g.getJqUi();var q=h.getJqUi();f==eb.PUSH_TO_GROUP?(c.css("display",""),q.css("display","none")):(c.css("display","none"),g.setText(""),q.css("display",""))});r();n=0;E.layoutCtrl(w,27,n,70,23);E.layoutCtrl(k,113,n,60,23);E.layoutCtrl(p,173,n,60,23);n=n+23+16;E.layoutCtrl(m,113,n,310,23);E.layoutCtrl(t,113,n,310,23);w.appendTo(u);p.appendTo(u);k.appendTo(u);
m.appendTo(u);t.appendTo(u)},r=function(){var w=d.protectedGetModel();w&&(w.getPushToTarget()==eb.PUSH_TO_USER?(e.setChecked(!0),h.setText(w.getUserIds())):g.setText(w.getGroupIds()))},D=function(){if(f==eb.PUSH_TO_GROUP)return null;var w=h.getText();return $.trim(w)},C=function(){if(f==eb.PUSH_TO_GROUP){var w=g.getText();return $.trim(w)}return null}});gb.LappIntegration=new function(){var d=this,u;this.setLappPrivateUrl=function(n){u=n};this.getLappPrivateUrl=function(){return u};this.getRealPublishUrl=
function(n,k,p){k&&p&&(n=n.replace(k,p));return n};this.deleteLappPublishInfos=function(n,k){h(n,function(){for(var p=fa.getLappUserId(),m=fa.getLappUserType(),t=fa.getEId(),c=fa.getPublishLappConfigs(),q=0;q<c.length;q++){var z=c[q];z.getLappUserId()&&(fa.setLappUserId(z.getLappUserId()),fa.setLappUserType(z.getLappUserType()),fa.setEId(z.getCorpId()),a(k))}fa.setLappUserId(p);fa.setLappUserType(m);fa.setEId(t)})};this.loadLappContext=function(n,k,p,m,t){n=new va(n,function(c){fa=new Ja;fa.fromJsonObject(c);
if(!fa.getLappUserId()){c=fa.getPublishLappConfigs();for(var q=0;q<c.length;q++){var z=c[q];if(z.getLappUserId()){g(z.getAppType());break}}}ib=fa.getServerHostUrl();Ac.setEnv(ib,fa.getAppId());fa.isPrivate()&&Gb.setRemoteUrlCreator(function(L,B){L=com.kingdee.bos.qing.common.Base64Util.encode("/"+L+"/"+B);return com.kingdee.bos.qing.framework.common.RemoteFramework.getLappPrivateUrl(L)});m&&m()},function(c,q){t&&t(c,q);return!0});n.setShowBlocking(p);n.getLappContext(k)};var g=function(n){for(var k=
fa.getPublishLappConfigs(),p=0;p<k.length;p++){var m=k[p];if(m.getAppType()==n){fa.setLappUserId(m.getLappUserId());fa.setLappUserType(m.getLappUserType());fa.setEId(m.getCorpId());break}}},h=function(n,k){d.loadLappContext(n,!1,!1,function(){fa.getLappUserId()?k():fa=null})},e=function(n,k,p,m){d.loadLappContext(n,!1,!m,k,p)},a=function(n){var k=new ka("lappAnalysisMgr",function(){},function(){return!0});k.setShowBlocking(!1);k.deleteByPublishIds(n)};this.syncDatacenterInfo=function(n,k,p){var m=
new va(n,function(t){if(t.isNeedSync){var c=t.datacenterUUID,q=t.datacenterInfo,z=t.publishIds;h(n,function(){var L=new ka("lappDatacenter",function(B){f(n,c,k,p)},function(B,y){return!0});z||(z=[]);L.setShowBlocking(!1);L.syncDatacenterInfo(q,z)})}else p&&p()},function(){return!0});m.setShowBlocking(!1);m.loadDatacenterInfo()};var f=function(n,k,p,m){n=new va(n,function(){p&&p()},function(){m&&m();return!0});n.setShowBlocking(!1);n.finishSync(k)};this.loadHandoverDirName=function(n,k,p,m,t,c){e(n,
function(){fa.getLappUserId()?l(n,p,function(q){for(var z=[],L=0;L<p.length;L++)z=z.concat(q[p[L]]);r(k,z,m,t,c)},t,c):t&&t(0,b.get("lappUserIdNullTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u540c\u6b65\u7528\u6237\u4fe1\u606f"))},t,c)};this.handover=function(n,k,p,m,t,c){e(n,function(){fa.getLappUserId()?l(n,[p,m],function(q){D(k,q[p],q[m],t,c)},c):c&&c(0,b.get("lappUserIdNullTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u540c\u6b65\u7528\u6237\u4fe1\u606f"))},
c)};var l=function(n,k,p,m,t){n=new va(n,function(c){p&&p(c)},function(c,q){m&&m(c,q);return!0});n.setShowBlocking(!t);n.getAllLappContextsByUserIds(k)},r=function(n,k,p,m,t){var c=new ka("lappAnalysisMgr",function(q){p&&p(q)},function(q,z){m&&m(q,z);return!0});c.setShowBlocking(!t);c.loadByUserAndPublishIds(n,k)},D=function(n,k,p,m,t){(new ka("lappAnalysisMgr",function(c){m&&m()},function(c,q){t&&t(c,q);return!0})).handover(n,k,p)};this.getLappPublishInfosByPublishIds=function(n,k,p,m){e(n,function(){fa.getLappUserId()?
C(k,p,m):m&&m(0,b.get("lappUserIdNullTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u540c\u6b65\u7528\u6237\u4fe1\u606f"))},m)};var C=function(n,k,p){var m=new ka("lappAnalysisMgr",function(t){k&&k(t)},function(t,c){p&&p(t,c);return!0});m.setShowBlocking(!1);m.getAnalysisInfosByPublishIds(n)};this.getPublishCountAggPath=function(n,k,p,m){var t=new ka("lappAnalysisMgr",function(c){p&&p(c)},function(c,q){m&&m(c,q);return!0});t.setShowBlocking(!1);
t.getPublishCountAggPath(n,k)};this.getAnalysisInfosByDirIds=function(n,k,p,m,t,c,q){var z=new ka("lappAnalysisMgr",function(L){c&&c(L)},function(L,B){q&&q(L,B);return!0});z.setShowBlocking(!1);z.getAnalysisInfosByDirIds(n,k,p,m,t)};this.getLappAllUserDirList=function(n,k,p,m){e(n,function(){fa.getLappUserId()?w(k,p,m):m&&m(0,b.get("lappUserIdNullTips","\u83b7\u53d6\u8f7b\u5e94\u7528\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u540c\u6b65\u7528\u6237\u4fe1\u606f"))},
m)};var w=function(n,k,p){(new ka("lappDirectoryMgr",function(m){k&&k(m)},function(m,t){p&&p(m,t);return!0})).getAllUserDirList(n)}};Db.AbstractTabPane=function(){this.getJqUi=function(){};this.into=function(){}}})();
//qingVersionTag: 20250324