(function(){function z(){var k=this,b;this.setMessageType=function(a){b=a};this.getMessageType=function(){return b};this.isServerMessage=function(){throw Error("Override me.");};this.isClientMessage=function(){throw Error("Override me.");};this.toJson=function(){throw Error("Override me.");};this.fromJson=function(a){throw Error("Override me.");};this.protectedMethod={toJson:function(){return{messageType:k.getMessageType()}}}}function A(){z.call(this);this.isServerMessage=function(){return!1};this.isClientMessage=
function(){return!0}}function G(){A.call(this);var k=this.protectedMethod;this.setMessageType(e.ClientPing);var b;this.setClientIDs=function(a){b=a||[]};this.getClientIDs=function(){return b};this.toJson=function(){var a=k.toJson();a.clientIDs=b;return a};this.fromJson=function(a){b=a.clientIDs}}function y(){A.call(this);var k=this.protectedMethod;this.setMessageType(e.ClientRemoteCall);var b,a,d,r,n,v;this.getAppID=function(){return b};this.setAppID=function(t){b=t};this.getClientID=function(){return a};
this.getClientIDs=function(){return[a]};this.setClientID=function(t){a=t};this.getCallID=function(){return d};this.setCallID=function(t){d=t};this.getOrderID=function(){return r};this.setOrderID=function(t){r=t};this.getServiceType=function(){return n};this.setServiceType=function(t){n=t};this.getParams=function(){return v};this.setParams=function(t){v=t};this.toJson=function(){var t=k.toJson();b&&(t.appID=b);t.clientID=a;t.callID=d;r&&(t.orderID=r);t.serviceType=n;t.params=v;return t};this.fromJson=
function(t){t.appID&&(b=t.appID);a=t.clientID;d=t.callID;t.orderID&&(r=t.orderID);n=t.serviceType;v=t.params}}function D(){A.call(this);var k=this.protectedMethod;this.setMessageType(e.ServerRemoteCallAck);var b,a;this.getClientID=function(){return b};this.setClientID=function(d){b=d};this.getCallID=function(){return a};this.setCallID=function(d){a=d};this.toJson=function(){var d=k.toJson();d.clientID=b;d.callID=a;return d};this.fromJson=function(d){b=d.clientID;a=d.callID}}function I(){D.call(this);
this.setMessageType(e.ServerChannelAck)}function F(){A.call(this);this.setMessageType(e.ClientRemoteCallCancel);var k=this.protectedMethod,b,a;this.getClientID=function(){return b};this.getClientIDs=function(){return[b]};this.setClientID=function(d){b=d};this.getCallID=function(){return a};this.setCallID=function(d){a=d};this.toJson=function(){var d=k.toJson();d.clientID=b;d.callID=a;return d};this.fromJson=function(d){b=d.clientID;a=d.callID}}function J(){A.call(this);var k=this.protectedMethod;
this.setMessageType(e.ClientClosed);var b;this.setClientIDs=function(a){b=a};this.getClientIDs=function(){return b};this.toJson=function(){var a=k.toJson();a.clientIDs=b;return a};this.fromJson=function(a){b=a.clientIDs}}function K(){A.call(this);var k=this.protectedMethod;this.setMessageType(e.ClientPolling);var b,a;this.setClientIDs=function(d){b=d};this.setClientIDAndCallIDs=function(d){a=d};this.toJson=function(){var d=k.toJson();d.clientIDs=b;d.clientIDAndCallIDs=a;return d};this.fromJson=function(d){b=
d.clientIDs;a=d.clientIDAndCallIDs}}function m(){z.call(this);this.getClientID=function(){throw Error("Override me.");};this.isServerMessage=function(){return!0};this.isClientMessage=function(){return!1}}function u(){m.call(this);var k=this.protectedMethod;this.setMessageType(e.ClientControlAck);var b;this.getControlType=function(){return b};this.toJson=function(){var a=k.toJson();a.controlType=b;return a};this.fromJson=function(a){b=a.controlType};this.getClientID=function(){return null}}function B(){m.call(this);
var k=this.protectedMethod;this.setMessageType(e.ServerPong);var b;this.getClientID=function(){return b};this.toJson=function(){var a=k.toJson();a.clientID=b;return a};this.fromJson=function(a){b=a.clientID}}function w(){m.call(this);var k=this.protectedMethod;this.setMessageType(e.ServerRemoteCall);var b,a,d,r;this.getClientID=function(){return b};this.setClientID=function(n){b=n};this.getCallID=function(){return a};this.setCallID=function(n){a=n};this.getOrderID=function(){return d};this.setOrderID=
function(n){d=n};this.getData=function(){return r};this.setData=function(n){r=n};this.toJson=function(){var n=k.toJson();n.clientID=b;n.callID=a;d&&(n.orderID=d);n.data=r;return n};this.fromJson=function(n){b=n.clientID;a=n.callID;n.orderID&&(d=n.orderID);r=n.data}}function H(){m.call(this);var k=this.protectedMethod;this.setMessageType(e.ClientRemoteCallAck);var b,a;this.getClientID=function(){return b};this.getCallID=function(){return a};this.toJson=function(){var d=k.toJson();d.clientID=b;d.callID=
a;return d};this.fromJson=function(d){b=d.clientID;a=d.callID}}function g(){m.call(this);var k=this.protectedMethod;this.setMessageType(e.ServerChannel);var b,a,d,r,n;this.getClientID=function(){return b};this.setClientID=function(v){b=v};this.getClientID=function(){return b};this.getCallID=function(){return a};this.getChannel=function(){return d};this.setChannel=function(v){d=v};this.getData=function(){return n};this.setData=function(v){n=v};this.toJson=function(){var v=k.toJson();v.clientID=b;v.callID=
a;v.channel=d;r&&(v.timestamp=r);v.data=n;return v};this.fromJson=function(v){b=v.clientID;a=v.callID;d=v.channel;v.timestamp&&(r=v.timestamp);n=v.data}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&
(com.kingdee.bos.qing.framework.remote={});var f=com.kingdee.bos.qing.framework.remote;f.PostMessage=function(){var k,b;this.isRequestPostMessageType=function(){return"Request"==k};this.isResponsePostMessageType=function(){return"Response"==k};this.setRequestPostMessageType=function(){k="Request"};this.setResponsePostMessageType=function(){k="Response"};this.isPostMessagePong=function(){return"PostMessagePong"==b};this.isPostMessagePing=function(){return"PostMessagePing"==b};this.setPostMessagePong=
function(){b="PostMessagePong"};this.setPostMessagePing=function(){b="PostMessagePing"};this.isShowMonitor=function(){return"ShowMonitor"==b};this.isCloseMonitor=function(){return"CloseMonitor"==b};this.getContent=function(){return b};this.setContent=function(a){b=a};this.isArray=function(){return b instanceof Array};this.toJson=function(){var a={};a.QingPostMessageType=k;if(b instanceof Array){for(var d=[],r=0;r<b.length;r++){var n=b[r].toJson();d.push(n)}a.QingPostMessageContent=d}else a.QingPostMessageContent=
"string"==typeof b?b:[b.toJson()];return a};this.fromJson=function(a){k=a.QingPostMessageType;b=E.fromJson(a.QingPostMessageContent)||a.QingPostMessageContent}};f.ClientPingMessage=G;f.ClientRemoteCallMessage=y;f.ServerRemoteCallAckMessage=D;f.ServerChannelAckMessage=I;f.ClientRemoteCallCancelMessage=F;f.ClientClosedMessage=J;f.ClientPollingMessage=K;f.AbstractServerMessage=m;f.ClientControlAckMessage=u;f.ServerPongMessage=B;f.ServerRemoteCallMessage=w;f.ServerChannelMessage=g;f.ClientRemoteCallAckMessage=
H;var e={},p={},E=new function(){var k=function(b){var a=b.messageType;return a&&(a=p[a])?(a=new a,a.fromJson(b),a):null};this.fromJson=function(b){if(b){if(b instanceof Array){for(var a=[],d=0;d<b.length;d++){var r=k(b[d]);r&&a.push(r)}return a}return k(b)}return null}};f.MessageUtil=E;e.ClientPing="ClientPing";p[e.ClientPing]=G;e.ClientRemoteCall="ClientRemoteCall";p[e.ClientRemoteCall]=y;e.ServerRemoteCallAck="ServerRemoteCallAck";p[e.ServerRemoteCallAck]=D;e.ServerChannelAck="ServerChannelAck";
p[e.ServerChannelAck]=I;e.ClientRemoteCallCancel="ClientRemoteCallCancel";p[e.ClientRemoteCallCancel]=F;e.ClientClosed="ClientClosed";p[e.ClientClosed]=J;e.ClientPolling="ClientPolling";p[e.ClientPolling]=K;e.ClientControlAck="ClientControlAck";p[e.ClientControlAck]=u;e.ServerPong="ServerPong";p[e.ServerPong]=B;e.ServerRemoteCall="ServerRemoteCall";p[e.ServerRemoteCall]=w;e.ClientRemoteCallAck="ClientRemoteCallAck";p[e.ClientRemoteCallAck]=H;e.ServerWebsocketIsReady="ServerWebsocketIsReady";p[e.ServerWebsocketIsReady]=
function(){m.call(this);this.setMessageType(e.ServerWebsocketIsReady);this.getClientID=function(){return null}};e.ServerChannel="ServerChannel";p[e.ServerChannel]=g;f.MessageType=e})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&(com.kingdee.bos.qing.framework.remote={});var z=com.kingdee.bos.qing.framework.remote;z.ProxyIframeDialog=function(G,y,D){function I(g){(g=
g||window.event)&&g.stopPropagation?g.stopPropagation():window.event&&(window.event.cancelBubble=!0)}function F(g,f,e,p){void 0===p?p=!0:p="";try{var E=!!window.navigator.msPointerEnabled}catch(d){E=!1}try{var k="ontouchstart"in document&&!J()}catch(d){k=!1}try{var b="ontouchstart"in document&&J()}catch(d){b=!1}var a=null;if(E)switch(f){case "mousedown":f="MSPointerDown";break;case "mousemove":f="MSPointerMove";break;case "mouseup":f="MSPointerUp";break;case "mouseover":f="MSPointerOver";break;case "mouseout":f=
"MSPointerOut"}else if(k)switch(f){case "mousedown":f="touchstart";break;case "mousemove":f="touchmove";break;case "mouseup":f="touchend";break;case "mouseover":f="";break;case "mouseout":f=""}if(b)switch(f){case "mousedown":a="touchstart";break;case "mousemove":a="touchmove";break;case "mouseup":a="touchend";break;case "mouseover":a="";break;case "mouseout":a=""}""!==f&&(g.addEventListener?g.addEventListener(f,e,p):g.attachEvent?g.attachEvent("on"+f,e):g["on"+f]=e,null!=a&&""!==a&&(g.addEventListener?
g.addEventListener(a,e,p):g.attachEvent?g.attachEvent("on"+a,e):g["on"+a]=e))}function J(){for(var g=navigator.userAgent,f="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";"),e=!0,p=0;p<f.length;p++)if(0<g.indexOf(f[p])){e=!1;break}return e}var K=this,m,u,B,w;this.show=function(){m&&m.style&&(m.style.display="")};this.postMessage=function(g,f){w&&w.contentWindow.postMessage(g,f)};this.getProxyQingMessageSenderWindow=function(){return w?w.contentWindow:null};var H=function(){var g,f,e,p=
!1;F(u,"mousedown",function(b){p=!0;g=b.offsetX;f=b.offsetY;e=B.offsetWidth;u.style.cursor="move";k("none")});var E=function(){p=!1;u.style.cursor="";k("")};F(u,"mouseup",E);F(document,"mouseup",E);F(document,"mousemove",function(b){if(p){var a=b.clientX-g;b=b.clientY-f;window.innerWidth<a+e&&(a=window.innerWidth-e);b>window.innerHeight-u.offsetHeight&&(b=window.innerHeight-u.offsetHeight);0>a&&(a=0);0>b&&(b=0);m.style.left=a+"px";m.style.top=b+"px"}});var k=function(b){document.body.style.userSelect=
b;B.style.pointerEvents=b;var a=document.querySelectorAll("iframe");if(a&&a.length)for(var d=0;d<a.length;d++){var r=a[d];r.style.pointerEvents=b;r.style.userSelect=b}}};(function(){m=document.createElement("div");m.style.position="absolute";m.style.width="800px";m.style.display="none";m.style.height="600px";m.style.top="100px";m.style.left="100px";m.style.backgroundColor="#FFFFFF";m.style.boxShadow="0 2px 8px 0 rgba(0,0,0,0.15)";m.style.borderRadius="2px";m.style.zIndex="123456789";u=document.createElement("div");
u.style.position="absolute";u.style.top="0px";u.style.left="0px";u.style.right="0px";u.style.height="40px";u.style.lineHeight="39px";u.style.fontSize="16px";u.style.fontWeight="700";u.style.paddingLeft="16px";u.style.paddingRight="50px";u.style.userSelect="none";u.style.overflow="hidden";u.style.borderBottom="1px solid #ccc";u.style.boxSizing="border-box";u.innerText=G;m.appendChild(u);var g=document.createElement("div");g.style.position="absolute";g.style.top="10px";g.style.right="40px";g.style.height=
"20px";g.style.lineHeight="20px";g.style.fontSize="20px";g.style.fontWeight="700";g.style.cursor="pointer";g.style.color="#7f93bc";g.style.userSelect="none";g.innerText="--";g.onclick=function(e){"--"==g.innerText?(m.style.top=null,g.innerText="+",m.style.bottom="00px",m.style.left="0px",m.style.width="250px",m.style.height="40px"):(g.innerText="--",m.style.width="800px",m.style.height="600px",m.style.top="100px",m.style.left="100px",m.style.bottom=null);I(e)};F(g,"mouseover",function(){g.style.color=
"#2B87F3"});F(g,"mouseout",function(){g.style.color="#7f93bc"});m.appendChild(g);var f=document.createElement("div");f.style.position="absolute";f.style.top="10px";f.style.right="11px";f.style.height="20px";f.style.lineHeight="20px";f.style.fontSize="20px";f.style.fontWeight="700";f.style.cursor="pointer";f.style.color="#7f93bc";f.style.userSelect="none";f.innerText="\u00d7";f.onclick=function(e){m.style.display="none";var p=new A;p.setRequestPostMessageType();p.setContent("CloseMonitor");K.postMessage(JSON.stringify(p.toJson()),
"*");I(e)};F(f,"mouseover",function(){f.style.color="#2B87F3"});F(f,"mouseout",function(){f.style.color="#7f93bc"});m.appendChild(f);B=document.createElement("div");B.style.position="absolute";B.style.top="40px";B.style.bottom="0px";B.style.left="0px";B.style.right="0px";m.appendChild(B);w=document.createElement("iframe");w.name="qing_proxy["+y+"]";w.frameborder="0";w.scrolling="no";w.style.height="100%";w.style.width="100%";w.style.border="0";B.appendChild(w);document.body.insertBefore(m,document.body.children[0]);
H();w.src=D})()};var A=z.PostMessage})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&(com.kingdee.bos.qing.framework.remote={});var z=com.kingdee.bos.qing.framework.remote,A,G;(function(){var y=com.kingdee.bos.qing;A=
y.Seer;y=com.kingdee.bos.qing.common;G=y.Util})();z.ClientEnvImpl=new function(){this.getProfilerRemoteUrl=function(){var y=G.decodeParamFromUrl(location.search,"path");y=(y?y:"/ierp")+"/qingshared/profilerEntrance.do";var D=A.getUrlParamValue("appID");D&&(y=G.appendParamToUrl(y,"appID",D));return y}}})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&(com.kingdee.bos.qing.framework.remote={});var z=com.kingdee.bos.qing.framework.remote;z.QingMessageSenderClient=new function(){var w=
this,H,g,f,e,p,E={},k,b,a=[],d,r=null,n={},v;this.start=function(c,h,l,q,x){v=c;e=h;H=l;g=q;f=x;c=new F;c.setClientIDs([e]);p=new D;p.setRequestPostMessageType();p.setContent(c);if(!g&&!H)throw Error("sDomainUrl and sWebSocketUrl is null");a:if(self==top)P();else{try{if(top.com&&top.com.kingdee&&top.com.kingdee.bos&&top.com.kingdee.bos.qing&&top.com.kingdee.bos.qing.framework&&top.com.kingdee.bos.qing.framework.remote&&top.com.kingdee.bos.qing.framework.remote.QingMessageSenderClient){r=top;break a}}catch(C){}try{c=
{QingPostMessageType:"InitProxy"},c.ClientID=e,c.DomainUrl=H,c.WebSocketUrl=g,c.RemoteProxyUrl=f,top.postMessage(JSON.stringify(c),"*")}catch(C){}try{if(top.com&&top.com.kingdee&&top.com.kingdee.bos&&top.com.kingdee.bos.qing&&top.com.kingdee.bos.qing.framework&&top.com.kingdee.bos.qing.framework.remote){r=top;break a}}catch(C){}setTimeout(t,1E3)}G.setRemoteCallListener(S);w.subscribeChannel("BehaviorChannel",T);B.addMenuItem("\u7f51\u7edc\u8bf7\u6c42\u76d1\u63a7\u5668",U);B.addMenuItem("\u6027\u80fd\u76d1\u63a7\u5668",
V)};var t=function(){if(!b){try{for(var c=parent;c&&c.com&&c.com.kingdee&&c.com.kingdee.bos&&c.com.kingdee.bos.qing&&c.com.kingdee.bos.qing.framework&&c.com.kingdee.bos.qing.framework.remote&&c.com.kingdee.bos.qing.framework.remote.QingMessageSenderClient&&(r=c),c!=top;)c=c.parent}catch(h){}r||P()}},P=function(){if(!b){var c=H+f;c=A.appendParamToUrl(c,"path",H);g&&(c=A.appendParamToUrl(c,"webSocketUrl",g));window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+
(window.location.port?":"+window.location.port:""));k=new I("\u8f7b\u5206\u6790\u7f51\u7edc\u8bf7\u6c42\u67e5\u770b\u5668",window.location.origin,c)}};this.getClientID=function(){if(e)return e;throw new Exception("RemoteFramework is not started");};var U=function(){if(k)k.show();else{var c=new D;c.setRequestPostMessageType();c.setContent("ShowMonitor");L(c,null)}},V=function(){var c=com.kingdee.bos.qing.SkinUtil.getUrlParamValue(),h=z.ClientEnvImpl.getProfilerRemoteUrl();c&&(h=A.appendParamToUrl(h,
"skin",c));com.kingdee.bos.qing.framework.common.TabbedUiUtil.openNewTab("\u6027\u80fd\u76d1\u63a7\u5668",h)},N={},L=function(c,h){if(c&&h){var l=h.source;h.source&&h.target&&h.source!=h.target||(l=null);if(l&&(h=c.getContent(),h instanceof Array))for(var q=0;q<h.length;q++)for(var x=h[q].getClientIDs(),C=0;C<x.length;C++){var M=x[C];N[M]=l;var O=function(){delete N[M]};try{l.onunload||(l.onunload=O)}catch(X){}}}if(b||r){if(0<a.length){for(C=0;a.length>C;C++)Q(a[C]);a=[]}Q(c)}else c&&a.push(c)},Q=
function(c){c&&(r?r.postMessage(JSON.stringify(c.toJson()),"*"):k&&k.postMessage(JSON.stringify(c.toJson()),"*"))},S=function(c,h){var l=new D;l.fromJson(c);if(l.isRequestPostMessageType())l.isPostMessagePing()?(c=new D,c.setResponsePostMessageType(),c.setPostMessagePong(),(l=h.source)&&h.target&&h.source!=h.target||(l=null),R(l,c.toJson())):L(l,h);else if(l.isResponsePostMessageType()&&(l.isPostMessagePong()&&(r=k?null:(c=h.source)&&h.target&&h.source!=h.target?c:null,b=!0,L(null,h)),h=l.getContent(),
c=l.toJson(),h&&l.isArray()))for(l=0;l<h.length;l++){var q=h[l];if(q&&q.isServerMessage()){var x=q.getClientID();if(x==e)if(q instanceof m){x=q;q=x.getData();x=x.getCallID();var C=E[x];delete E[x];if(C)try{C(q)}catch(O){window.console&&console.warn(O)}}else{if(q instanceof u&&(x=q.getChannel(),q=q.getData(),(x=n[x])&&0<x.length))for(C=0;C<x.length;C++){var M=x[C];M&&M(q)}}else R(N[x],c)}}};this.cancel=function(c){var h=E[c];delete E[c];h&&(h({errorCode:-1,errorMessage:"Request Canceled."}),h=new K,
h.setClientID(e),h.setCallID(c),c=new D,c.setRequestPostMessageType(),c.setContent([h]),L(c,null))};this.closePage=function(c,h){var l=A.createUUID();w.call(l,"QingSystemFramework",{remoteMethod:"closePage",clientID:e},c,h)};this.call=function(c,h,l,q,x){d||(d=y.setInterval(W,3E3));E[c]=q;q=new J;q.setAppID(v);l.requestedAppId&&q.setAppID(l.requestedAppId);q.setClientID(e);q.setCallID(c);q.setServiceType(h);q.setParams(l);c=new D;c.setRequestPostMessageType();c.setContent([q]);L(c,null)};this.subscribeChannel=
function(c,h){var l=n[c];l||(l=[]);l.push(h);n[c]=l};this.unsubscribeChannel=function(c,h){var l=n[c];if(l)for(var q=0;q<l.length;q++)if(l[q]==h){l.splice(q,1);break}l&&0!=l.length?n[c]=l:delete n[c]};var R=function(c,h){if(c)c.postMessage(JSON.stringify(h),"*");else if(c=document.getElementsByTagName("iframe"),0<c.length)for(var l=0;l<c.length;l++){var q=c[l];try{q.contentWindow!=(null==k?null:k.getProxyQingMessageSenderWindow())&&q.contentWindow.postMessage(JSON.stringify(h),"*")}catch(x){}}},W=
function(){L(p,null)},T=function(c){try{com.kingdee.bos.qing.behavior.BehaviorManager.onBehaviorChannelMessage(c)}catch(h){window.console&&console.warn(h)}}};var A,G,y,D=z.PostMessage,I=z.ProxyIframeDialog,F=z.ClientPingMessage,J=z.ClientRemoteCallMessage,K=z.ClientRemoteCallCancelMessage,m=z.ServerRemoteCallMessage,u=z.ServerChannelMessage,B;(function(){var w=com.kingdee.bos.qing.common;A=w.Util;w=com.kingdee.bos.qing.framework.common;G=w.WindowMessageHelper;y=w.WorkerHelper;w=com.kingdee.bos.qing.common.ui;
B=w.EngineeringMenu})()})();
//qingVersionTag: 20250324