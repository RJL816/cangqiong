(function(){function z(){var f=this,a;this.setMessageType=function(b){a=b};this.getMessageType=function(){return a};this.isServerMessage=function(){throw Error("Override me.");};this.isClientMessage=function(){throw Error("Override me.");};this.toJson=function(){throw Error("Override me.");};this.fromJson=function(b){throw Error("Override me.");};this.protectedMethod={toJson:function(){return{messageType:f.getMessageType()}}}}function y(){z.call(this);this.isServerMessage=function(){return!1};this.isClientMessage=
function(){return!0}}function D(){y.call(this);var f=this.protectedMethod;this.setMessageType(e.ClientPing);var a;this.setClientIDs=function(b){a=b||[]};this.getClientIDs=function(){return a};this.toJson=function(){var b=f.toJson();b.clientIDs=a;return b};this.fromJson=function(b){a=b.clientIDs}}function E(){y.call(this);var f=this.protectedMethod;this.setMessageType(e.ClientRemoteCall);var a,b,c,t,n,u;this.getAppID=function(){return a};this.setAppID=function(r){a=r};this.getClientID=function(){return b};
this.getClientIDs=function(){return[b]};this.setClientID=function(r){b=r};this.getCallID=function(){return c};this.setCallID=function(r){c=r};this.getOrderID=function(){return t};this.setOrderID=function(r){t=r};this.getServiceType=function(){return n};this.setServiceType=function(r){n=r};this.getParams=function(){return u};this.setParams=function(r){u=r};this.toJson=function(){var r=f.toJson();a&&(r.appID=a);r.clientID=b;r.callID=c;t&&(r.orderID=t);r.serviceType=n;r.params=u;return r};this.fromJson=
function(r){r.appID&&(a=r.appID);b=r.clientID;c=r.callID;r.orderID&&(t=r.orderID);n=r.serviceType;u=r.params}}function B(){y.call(this);var f=this.protectedMethod;this.setMessageType(e.ServerRemoteCallAck);var a,b;this.getClientID=function(){return a};this.setClientID=function(c){a=c};this.getCallID=function(){return b};this.setCallID=function(c){b=c};this.toJson=function(){var c=f.toJson();c.clientID=a;c.callID=b;return c};this.fromJson=function(c){a=c.clientID;b=c.callID}}function A(){B.call(this);
this.setMessageType(e.ServerChannelAck)}function p(){y.call(this);this.setMessageType(e.ClientRemoteCallCancel);var f=this.protectedMethod,a,b;this.getClientID=function(){return a};this.getClientIDs=function(){return[a]};this.setClientID=function(c){a=c};this.getCallID=function(){return b};this.setCallID=function(c){b=c};this.toJson=function(){var c=f.toJson();c.clientID=a;c.callID=b;return c};this.fromJson=function(c){a=c.clientID;b=c.callID}}function q(){y.call(this);var f=this.protectedMethod;
this.setMessageType(e.ClientClosed);var a;this.setClientIDs=function(b){a=b};this.getClientIDs=function(){return a};this.toJson=function(){var b=f.toJson();b.clientIDs=a;return b};this.fromJson=function(b){a=b.clientIDs}}function x(){y.call(this);var f=this.protectedMethod;this.setMessageType(e.ClientPolling);var a,b;this.setClientIDs=function(c){a=c};this.setClientIDAndCallIDs=function(c){b=c};this.toJson=function(){var c=f.toJson();c.clientIDs=a;c.clientIDAndCallIDs=b;return c};this.fromJson=function(c){a=
c.clientIDs;b=c.clientIDAndCallIDs}}function h(){z.call(this);this.getClientID=function(){throw Error("Override me.");};this.isServerMessage=function(){return!0};this.isClientMessage=function(){return!1}}function l(){h.call(this);var f=this.protectedMethod;this.setMessageType(e.ClientControlAck);var a;this.getControlType=function(){return a};this.toJson=function(){var b=f.toJson();b.controlType=a;return b};this.fromJson=function(b){a=b.controlType};this.getClientID=function(){return null}}function w(){h.call(this);
var f=this.protectedMethod;this.setMessageType(e.ServerPong);var a;this.getClientID=function(){return a};this.toJson=function(){var b=f.toJson();b.clientID=a;return b};this.fromJson=function(b){a=b.clientID}}function v(){h.call(this);var f=this.protectedMethod;this.setMessageType(e.ServerRemoteCall);var a,b,c,t;this.getClientID=function(){return a};this.setClientID=function(n){a=n};this.getCallID=function(){return b};this.setCallID=function(n){b=n};this.getOrderID=function(){return c};this.setOrderID=
function(n){c=n};this.getData=function(){return t};this.setData=function(n){t=n};this.toJson=function(){var n=f.toJson();n.clientID=a;n.callID=b;c&&(n.orderID=c);n.data=t;return n};this.fromJson=function(n){a=n.clientID;b=n.callID;n.orderID&&(c=n.orderID);t=n.data}}function C(){h.call(this);var f=this.protectedMethod;this.setMessageType(e.ClientRemoteCallAck);var a,b;this.getClientID=function(){return a};this.getCallID=function(){return b};this.toJson=function(){var c=f.toJson();c.clientID=a;c.callID=
b;return c};this.fromJson=function(c){a=c.clientID;b=c.callID}}function k(){h.call(this);var f=this.protectedMethod;this.setMessageType(e.ServerChannel);var a,b,c,t,n;this.getClientID=function(){return a};this.setClientID=function(u){a=u};this.getClientID=function(){return a};this.getCallID=function(){return b};this.getChannel=function(){return c};this.setChannel=function(u){c=u};this.getData=function(){return n};this.setData=function(u){n=u};this.toJson=function(){var u=f.toJson();u.clientID=a;u.callID=
b;u.channel=c;t&&(u.timestamp=t);u.data=n;return u};this.fromJson=function(u){a=u.clientID;b=u.callID;c=u.channel;u.timestamp&&(t=u.timestamp);n=u.data}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&
(com.kingdee.bos.qing.framework.remote={});var d=com.kingdee.bos.qing.framework.remote;d.PostMessage=function(){var f,a;this.isRequestPostMessageType=function(){return"Request"==f};this.isResponsePostMessageType=function(){return"Response"==f};this.setRequestPostMessageType=function(){f="Request"};this.setResponsePostMessageType=function(){f="Response"};this.isPostMessagePong=function(){return"PostMessagePong"==a};this.isPostMessagePing=function(){return"PostMessagePing"==a};this.setPostMessagePong=
function(){a="PostMessagePong"};this.setPostMessagePing=function(){a="PostMessagePing"};this.isShowMonitor=function(){return"ShowMonitor"==a};this.isCloseMonitor=function(){return"CloseMonitor"==a};this.getContent=function(){return a};this.setContent=function(b){a=b};this.isArray=function(){return a instanceof Array};this.toJson=function(){var b={};b.QingPostMessageType=f;if(a instanceof Array){for(var c=[],t=0;t<a.length;t++){var n=a[t].toJson();c.push(n)}b.QingPostMessageContent=c}else b.QingPostMessageContent=
"string"==typeof a?a:[a.toJson()];return b};this.fromJson=function(b){f=b.QingPostMessageType;a=m.fromJson(b.QingPostMessageContent)||b.QingPostMessageContent}};d.ClientPingMessage=D;d.ClientRemoteCallMessage=E;d.ServerRemoteCallAckMessage=B;d.ServerChannelAckMessage=A;d.ClientRemoteCallCancelMessage=p;d.ClientClosedMessage=q;d.ClientPollingMessage=x;d.AbstractServerMessage=h;d.ClientControlAckMessage=l;d.ServerPongMessage=w;d.ServerRemoteCallMessage=v;d.ServerChannelMessage=k;d.ClientRemoteCallAckMessage=
C;var e={},g={},m=new function(){var f=function(a){var b=a.messageType;return b&&(b=g[b])?(b=new b,b.fromJson(a),b):null};this.fromJson=function(a){if(a){if(a instanceof Array){for(var b=[],c=0;c<a.length;c++){var t=f(a[c]);t&&b.push(t)}return b}return f(a)}return null}};d.MessageUtil=m;e.ClientPing="ClientPing";g[e.ClientPing]=D;e.ClientRemoteCall="ClientRemoteCall";g[e.ClientRemoteCall]=E;e.ServerRemoteCallAck="ServerRemoteCallAck";g[e.ServerRemoteCallAck]=B;e.ServerChannelAck="ServerChannelAck";
g[e.ServerChannelAck]=A;e.ClientRemoteCallCancel="ClientRemoteCallCancel";g[e.ClientRemoteCallCancel]=p;e.ClientClosed="ClientClosed";g[e.ClientClosed]=q;e.ClientPolling="ClientPolling";g[e.ClientPolling]=x;e.ClientControlAck="ClientControlAck";g[e.ClientControlAck]=l;e.ServerPong="ServerPong";g[e.ServerPong]=w;e.ServerRemoteCall="ServerRemoteCall";g[e.ServerRemoteCall]=v;e.ClientRemoteCallAck="ClientRemoteCallAck";g[e.ClientRemoteCallAck]=C;e.ServerWebsocketIsReady="ServerWebsocketIsReady";g[e.ServerWebsocketIsReady]=
function(){h.call(this);this.setMessageType(e.ServerWebsocketIsReady);this.getClientID=function(){return null}};e.ServerChannel="ServerChannel";g[e.ServerChannel]=k;d.MessageType=e})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&(com.kingdee.bos.qing.framework.remote={});var z=com.kingdee.bos.qing.framework.remote;z.ProxyIframeDialog=function(D,E,B){function A(k){(k=
k||window.event)&&k.stopPropagation?k.stopPropagation():window.event&&(window.event.cancelBubble=!0)}function p(k,d,e,g){void 0===g?g=!0:g="";try{var m=!!window.navigator.msPointerEnabled}catch(c){m=!1}try{var f="ontouchstart"in document&&!q()}catch(c){f=!1}try{var a="ontouchstart"in document&&q()}catch(c){a=!1}var b=null;if(m)switch(d){case "mousedown":d="MSPointerDown";break;case "mousemove":d="MSPointerMove";break;case "mouseup":d="MSPointerUp";break;case "mouseover":d="MSPointerOver";break;case "mouseout":d=
"MSPointerOut"}else if(f)switch(d){case "mousedown":d="touchstart";break;case "mousemove":d="touchmove";break;case "mouseup":d="touchend";break;case "mouseover":d="";break;case "mouseout":d=""}if(a)switch(d){case "mousedown":b="touchstart";break;case "mousemove":b="touchmove";break;case "mouseup":b="touchend";break;case "mouseover":b="";break;case "mouseout":b=""}""!==d&&(k.addEventListener?k.addEventListener(d,e,g):k.attachEvent?k.attachEvent("on"+d,e):k["on"+d]=e,null!=b&&""!==b&&(k.addEventListener?
k.addEventListener(b,e,g):k.attachEvent?k.attachEvent("on"+b,e):k["on"+b]=e))}function q(){for(var k=navigator.userAgent,d="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";"),e=!0,g=0;g<d.length;g++)if(0<k.indexOf(d[g])){e=!1;break}return e}var x=this,h,l,w,v;this.show=function(){h&&h.style&&(h.style.display="")};this.postMessage=function(k,d){v&&v.contentWindow.postMessage(k,d)};this.getProxyQingMessageSenderWindow=function(){return v?v.contentWindow:null};var C=function(){var k,d,e,g=
!1;p(l,"mousedown",function(a){g=!0;k=a.offsetX;d=a.offsetY;e=w.offsetWidth;l.style.cursor="move";f("none")});var m=function(){g=!1;l.style.cursor="";f("")};p(l,"mouseup",m);p(document,"mouseup",m);p(document,"mousemove",function(a){if(g){var b=a.clientX-k;a=a.clientY-d;window.innerWidth<b+e&&(b=window.innerWidth-e);a>window.innerHeight-l.offsetHeight&&(a=window.innerHeight-l.offsetHeight);0>b&&(b=0);0>a&&(a=0);h.style.left=b+"px";h.style.top=a+"px"}});var f=function(a){document.body.style.userSelect=
a;w.style.pointerEvents=a;var b=document.querySelectorAll("iframe");if(b&&b.length)for(var c=0;c<b.length;c++){var t=b[c];t.style.pointerEvents=a;t.style.userSelect=a}}};(function(){h=document.createElement("div");h.style.position="absolute";h.style.width="800px";h.style.display="none";h.style.height="600px";h.style.top="100px";h.style.left="100px";h.style.backgroundColor="#FFFFFF";h.style.boxShadow="0 2px 8px 0 rgba(0,0,0,0.15)";h.style.borderRadius="2px";h.style.zIndex="123456789";l=document.createElement("div");
l.style.position="absolute";l.style.top="0px";l.style.left="0px";l.style.right="0px";l.style.height="40px";l.style.lineHeight="39px";l.style.fontSize="16px";l.style.fontWeight="700";l.style.paddingLeft="16px";l.style.paddingRight="50px";l.style.userSelect="none";l.style.overflow="hidden";l.style.borderBottom="1px solid #ccc";l.style.boxSizing="border-box";l.innerText=D;h.appendChild(l);var k=document.createElement("div");k.style.position="absolute";k.style.top="10px";k.style.right="40px";k.style.height=
"20px";k.style.lineHeight="20px";k.style.fontSize="20px";k.style.fontWeight="700";k.style.cursor="pointer";k.style.color="#7f93bc";k.style.userSelect="none";k.innerText="--";k.onclick=function(e){"--"==k.innerText?(h.style.top=null,k.innerText="+",h.style.bottom="00px",h.style.left="0px",h.style.width="250px",h.style.height="40px"):(k.innerText="--",h.style.width="800px",h.style.height="600px",h.style.top="100px",h.style.left="100px",h.style.bottom=null);A(e)};p(k,"mouseover",function(){k.style.color=
"#2B87F3"});p(k,"mouseout",function(){k.style.color="#7f93bc"});h.appendChild(k);var d=document.createElement("div");d.style.position="absolute";d.style.top="10px";d.style.right="11px";d.style.height="20px";d.style.lineHeight="20px";d.style.fontSize="20px";d.style.fontWeight="700";d.style.cursor="pointer";d.style.color="#7f93bc";d.style.userSelect="none";d.innerText="\u00d7";d.onclick=function(e){h.style.display="none";var g=new y;g.setRequestPostMessageType();g.setContent("CloseMonitor");x.postMessage(JSON.stringify(g.toJson()),
"*");A(e)};p(d,"mouseover",function(){d.style.color="#2B87F3"});p(d,"mouseout",function(){d.style.color="#7f93bc"});h.appendChild(d);w=document.createElement("div");w.style.position="absolute";w.style.top="40px";w.style.bottom="0px";w.style.left="0px";w.style.right="0px";h.appendChild(w);v=document.createElement("iframe");v.name="qing_proxy["+E+"]";v.frameborder="0";v.scrolling="no";v.style.height="100%";v.style.width="100%";v.style.border="0";w.appendChild(v);document.body.insertBefore(h,document.body.children[0]);
C();v.src=B})()};var y=z.PostMessage})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.framework&&(com.kingdee.bos.qing.framework={});"undefined"==typeof com.kingdee.bos.qing.framework.remote&&(com.kingdee.bos.qing.framework.remote={});var z=com.kingdee.bos.qing.framework.remote,y=z.PostMessage,D=z.ProxyIframeDialog,E=function(p,
q,x,h){var l,w,v=function(g,m,f){g+=0>g.indexOf("?")?"?":"&";return g=g+m+"="+window.encodeURIComponent(f)},C=function(){var g=q+x;g=v(g,"path",q);h&&(g=v(g,"webSocketUrl",h));l=new D("\u8f7b\u5206\u6790\u7f51\u7edc\u8bf7\u6c42\u67e5\u770b\u5668",p,g)},k={},d=[],e=function(g,m){if(g&&m&&m.source){var f=m.source;m.source&&m.target&&m.source!=m.target||(f=null);if(f){m=g.getContent();for(var a=0;a<m.length;a++)for(var b=m[a].getClientIDs(),c=0;c<b.length;c++){var t=b[c];k[t]=f;var n=function(){delete k[t]};
try{f.onunload||(f.onunload=n)}catch(u){}}}}if(w){if(0<d.length){for(c=0;d.length>c;c++)l.postMessage(JSON.stringify(d[c].toJson()),"*");d=[]}g&&l.postMessage(JSON.stringify(g.toJson()),"*")}else g&&d.push(g)};this.onRequestMessageCallback=function(g,m){var f=new y;f.fromJson(g);f.isPostMessagePing()?(g=new y,g.setResponsePostMessageType(),g.setPostMessagePong(),(f=m.source)&&m.target&&m.source!=m.target||(f=null),B(f,g.toJson()),l||C(),e(null,m)):f.isShowMonitor()?l.show():(l||C(),e(f,m))};this.onResponseMessageCallback=
function(g){var m=new y;m.fromJson(g);if(m.isPostMessagePong())w=!0,l||C(),e(null,null);else{var f=m.getContent();if(f&&m.isArray())for(m=0;m<f.length;m++){var a=f[m];a&&a.isServerMessage()&&(a=a.getClientID(),B(k[a],g))}}}},B=function(p,q){if(p)p.postMessage(JSON.stringify(q),"*");else if(p=document.getElementsByTagName("iframe"),0<p.length)for(var x=0;x<p.length;x++){var h=p[x];try{var l=0==(h.name?h.name:"").indexOf("qing_proxy[")?!1:!0;l&&h.contentWindow.postMessage(JSON.stringify(q),"*")}catch(w){}}},
A={};z=function(p){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var q=!1;p.origin&&p.origin==window.location.origin&&(q=!0);if(q){q=null;if("string"===typeof p.data)try{q=JSON.parse(p.data)}catch(l){return}else q=p.data;if("InitProxy"==q.QingPostMessageType){var x=p.origin,h=A[x];h||(h=new E(x,q.DomainUrl,q.RemoteProxyUrl,q.WebSocketUrl),A[x]=h);q=new y;q.setRequestPostMessageType();q.setPostMessagePing();
h.onRequestMessageCallback(q.toJson(),p)}else"Request"==q.QingPostMessageType?(h=A[p.origin],h.onRequestMessageCallback(q,p)):"Response"==q.QingPostMessageType&&(h=A[p.origin],h.onResponseMessageCallback(q))}};window.addEventListener?window.addEventListener("message",z,!1):window.attachEvent?window.attachEvent("onmessage",z):window.onmessage=z})();
//qingVersionTag: 20250324