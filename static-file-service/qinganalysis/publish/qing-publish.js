var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(Aa){var Va=0;return function(){return Va<Aa.length?{done:!1,value:Aa[Va++]}:{done:!0}}};$jscomp.arrayIterator=function(Aa){return{next:$jscomp.arrayIteratorImpl(Aa)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(Aa,Va,Pa){if(Aa==Array.prototype||Aa==Object.prototype)return Aa;Aa[Va]=Pa.value;return Aa};$jscomp.getGlobal=function(Aa){Aa=["object"==typeof globalThis&&globalThis,Aa,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var Va=0;Va<Aa.length;++Va){var Pa=Aa[Va];if(Pa&&Pa.Math==Math)return Pa}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(Aa,Va){var Pa=$jscomp.propertyToPolyfillSymbol[Va];if(null==Pa)return Aa[Va];Pa=Aa[Pa];return void 0!==Pa?Pa:Aa[Va]};
$jscomp.polyfill=function(Aa,Va,Pa,kb){Va&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(Aa,Va,Pa,kb):$jscomp.polyfillUnisolated(Aa,Va,Pa,kb))};$jscomp.polyfillUnisolated=function(Aa,Va,Pa,kb){Pa=$jscomp.global;Aa=Aa.split(".");for(kb=0;kb<Aa.length-1;kb++){var fb=Aa[kb];if(!(fb in Pa))return;Pa=Pa[fb]}Aa=Aa[Aa.length-1];kb=Pa[Aa];Va=Va(kb);Va!=kb&&null!=Va&&$jscomp.defineProperty(Pa,Aa,{configurable:!0,writable:!0,value:Va})};
$jscomp.polyfillIsolated=function(Aa,Va,Pa,kb){var fb=Aa.split(".");Aa=1===fb.length;kb=fb[0];kb=!Aa&&kb in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var nb=0;nb<fb.length-1;nb++){var Db=fb[nb];if(!(Db in kb))return;kb=kb[Db]}fb=fb[fb.length-1];Pa=$jscomp.IS_SYMBOL_NATIVE&&"es6"===Pa?kb[fb]:null;Va=Va(Pa);null!=Va&&(Aa?$jscomp.defineProperty($jscomp.polyfills,fb,{configurable:!0,writable:!0,value:Va}):Va!==Pa&&(void 0===$jscomp.propertyToPolyfillSymbol[fb]&&(Pa=1E9*Math.random()>>>0,
$jscomp.propertyToPolyfillSymbol[fb]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(fb):$jscomp.POLYFILL_PREFIX+Pa+"$"+fb),$jscomp.defineProperty(kb,$jscomp.propertyToPolyfillSymbol[fb],{configurable:!0,writable:!0,value:Va})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(Aa){if(Aa)return Aa;var Va=function(nb,Db){this.$jscomp$symbol$id_=nb;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:Db})};Va.prototype.toString=function(){return this.$jscomp$symbol$id_};var Pa="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",kb=0,fb=function(nb){if(this instanceof fb)throw new TypeError("Symbol is not a constructor");return new Va(Pa+(nb||"")+"_"+kb++,nb)};return fb},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(Aa){if(Aa)return Aa;Aa=Symbol("Symbol.iterator");for(var Va="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Pa=0;Pa<Va.length;Pa++){var kb=$jscomp.global[Va[Pa]];"function"===typeof kb&&"function"!=typeof kb.prototype[Aa]&&$jscomp.defineProperty(kb.prototype,Aa,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return Aa},
"es6","es3");$jscomp.iteratorPrototype=function(Aa){Aa={next:Aa};Aa[Symbol.iterator]=function(){return this};return Aa};$jscomp.iteratorFromArray=function(Aa,Va){Aa instanceof String&&(Aa+="");var Pa=0,kb=!1,fb={next:function(){if(!kb&&Pa<Aa.length){var nb=Pa++;return{value:Va(nb,Aa[nb]),done:!1}}kb=!0;return{done:!0,value:void 0}}};fb[Symbol.iterator]=function(){return fb};return fb};
$jscomp.polyfill("Array.prototype.keys",function(Aa){return Aa?Aa:function(){return $jscomp.iteratorFromArray(this,function(Va){return Va})}},"es6","es3");$jscomp.owns=function(Aa,Va){return Object.prototype.hasOwnProperty.call(Aa,Va)};$jscomp.polyfill("Object.values",function(Aa){return Aa?Aa:function(Va){var Pa=[],kb;for(kb in Va)$jscomp.owns(Va,kb)&&Pa.push(Va[kb]);return Pa}},"es8","es3");
$jscomp.polyfill("Object.is",function(Aa){return Aa?Aa:function(Va,Pa){return Va===Pa?0!==Va||1/Va===1/Pa:Va!==Va&&Pa!==Pa}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(Aa){return Aa?Aa:function(Va,Pa){var kb=this;kb instanceof String&&(kb=String(kb));var fb=kb.length;Pa=Pa||0;for(0>Pa&&(Pa=Math.max(Pa+fb,0));Pa<fb;Pa++){var nb=kb[Pa];if(nb===Va||Object.is(nb,Va))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(Aa,Va,Pa){if(null==Aa)throw new TypeError("The 'this' value for String.prototype."+Pa+" must not be null or undefined");if(Va instanceof RegExp)throw new TypeError("First argument to String.prototype."+Pa+" must not be a regular expression");return Aa+""};$jscomp.polyfill("String.prototype.includes",function(Aa){return Aa?Aa:function(Va,Pa){return-1!==$jscomp.checkStringArgs(this,Va,"includes").indexOf(Va,Pa||0)}},"es6","es3");
$jscomp.findInternal=function(Aa,Va,Pa){Aa instanceof String&&(Aa=String(Aa));for(var kb=Aa.length,fb=0;fb<kb;fb++){var nb=Aa[fb];if(Va.call(Pa,nb,fb,Aa))return{i:fb,v:nb}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(Aa){return Aa?Aa:function(Va,Pa){return $jscomp.findInternal(this,Va,Pa).v}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(Aa){return Aa?Aa:function(Va,Pa){var kb=$jscomp.checkStringArgs(this,Va,"endsWith");Va+="";void 0===Pa&&(Pa=kb.length);Pa=Math.max(0,Math.min(Pa|0,kb.length));for(var fb=Va.length;0<fb&&0<Pa;)if(kb[--Pa]!=Va[--fb])return!1;return 0>=fb}},"es6","es3");
(function(){function Aa(){var sa=this,m,Qa,Na,Xa,pb,Ba,Cb,h,ja,gb=!0,Ea=[],bb=[],wb=[],ub=[],Jb,lb,Eb,Hb,yb,cb,Ab,Sa,hb=!1,Ua=!1,ea,Ca,S,Z=[],G,F,P,n,w,C;this.getModifierName=function(){return C};this.setModifierName=function(f){C=f};this.getCreatorID=function(){return w};this.setCreatorID=function(f){w=f};this.getSpaceID=function(){return n};this.setSpaceID=function(f){n=f};this.setWidgetsExecutingTag=function(f){P=f};this.setSchemaTag=function(f){_sSchemaTag=f};this.setPublishSourceFId=function(f){F=
f};this.getPublishSourceFId=function(){return F};this.getId=function(){return m};this.setId=function(f){m=f};this.getPublishTargetType=function(){return Qa};this.setPublishTargetType=function(f){Qa=f};this.getPublishSourceType=function(){return Na};this.setPublishSourceType=function(f){Na=f};this.getPublishSourceName=function(){return Xa};this.setPublishSourceName=function(f){Xa=f};this.getPublishSourceGroupName=function(){return pb};this.setPublishSourceGroupName=function(f){pb=f};this.getName=function(){return Ba};
this.setName=function(f){Ba=f};this.getPath=function(){return Cb};this.setPath=function(f){Cb=f};this.getPathText=function(){return h};this.setPathText=function(f){h=f};this.getSchemeId=function(){return ja};this.setSchemeId=function(f){ja=f};this.isAnalysis=function(){return gb};this.setAnalysis=function(f){gb=f};this.getUsers=function(){return Ea?Ea:[]};this.setUsers=function(f){Ea=f};this.getSchemaAttrSelected=function(){return wb};this.setSchemaAttrSelected=function(f){wb=f};this.getSchemaModelSelected=
function(){return ub};this.setSchemaModelSelected=function(f){ub=f};this.getRoles=function(){return bb?bb:[]};this.setRoles=function(f){bb=f};this.getTagId=function(){return Jb};this.setTagId=function(f){Jb=f};this.getCarryData=function(){return lb};this.setCarryData=function(f){lb=f};this.getCreateTime=function(){return yb};this.setCreateTime=function(f){yb=f};this.getCreateFormatTime=function(){return cb};this.setCreateFormatTime=function(f){cb=f};this.getUpdateTime=function(){return Sa};this.setUpdateTime=
function(f){Sa=f};this.getUpdateFormatTime=function(){return Ab};this.setUpdateFormatTime=function(f){Ab=f};this.getThumbnailInfo=function(){return Eb};this.setThumbnailInfo=function(f){Eb=f};this.getIsOverwrite=function(){return hb};this.setIsOverwrite=function(f){hb=f};this.getIsAddOldPermission=function(){return Ua};this.setIsAddOldPermission=function(f){Ua=f};this.isPreset=function(){return ea};this.setIsPreset=function(f){ea=f};this.setFailedUserIds=function(f){Ca=f};this.getFailedUserIds=function(){return Ca};
this.setNoOperValueMap=function(f){S=f};this.getNoOperValueMap=function(){return S};this.setCarryUsers=function(f){Z=f};this.getCarryUsers=function(){return Z};this.setLastBiztag=function(f){G=f};this.getLastBiztag=function(){return G};this.getPermLabels=function(){return Hb?Hb:[]};this.setPermLabels=function(f){Hb=f};this.toJsonObject=function(){var f={};f.id=m;f.name=Ba;f.publishTargetType=Qa;f.publishSourceType=Na;f.publishSourceName=Xa;f.publishSourceGroupName=pb;f.path=Cb;f.pathText=h;f.isCanAnalysis=
gb;f.schemaId=ja;f.tagId=Jb;f.carryData=lb;f.createTime=yb;f.updateTime=Sa;f.thumbnailInfo=Eb;f.isOverwrite=hb;f.isAddOldPermission=Ua;f.isPreset=ea;f.failedUserIds=Ca;f.noOperValueMap=S;f.publishSourceFId=F;f.lastBiztag=G;f.spaceId=n;f.creatorId=w;for(var V=[],W=0;W<Ea.length;W++){var za=Ea[W];V.push(za.toJsonObject())}f.users=V;W=[];for(za=0;za<bb.length;za++)W.push(bb[za].toJsonObject());f.roles=W;if(Z){V=[];for(W=0;W<Z.length;W++)za=Z[W],V.push(za.toJsonObject());f.carryUsers=V}za=[];if(Hb&&0<
Hb.length)for(W=0;W<Hb.length;W++)za.push(Hb[W].toJsonObject());f.permLabels=za;f.executingTagMap=P;return f};this.fromJsonObject=function(f){sa.setId(f.id);sa.setName(f.name);sa.setPublishTargetType(f.publishTargetType);sa.setPublishSourceType(f.publishSourceType);sa.setPublishSourceName(f.publishSourceName);sa.setPublishSourceGroupName(f.publishSourceGroupName);sa.setPath(f.path);sa.setPathText(f.pathText);sa.setAnalysis(f.isCanAnalysis);sa.setSchemeId(f.schemaId);sa.setCarryData(f.carryData);sa.setTagId(f.tagId);
sa.setCreateTime(f.createTime);sa.setCreateFormatTime(f.createFormatTime);sa.setUpdateFormatTime(f.updateFormatTime);if(f.thumbnailInfo){var V=f.thumbnailInfo;Eb=new fb;Eb.fromJsonObject(V)}sa.setIsOverwrite(f.isOverwrite);sa.setIsAddOldPermission(f.isAddOldPermission);sa.setIsPreset(f.isPreset);sa.setFailedUserIds(f.failedUserIds);sa.setLastBiztag(f.lastBiztag);sa.setSpaceID(f.spaceId);sa.setCreatorID(f.creatorId);sa.setModifierName(f.modifierName);(V=f.noOperValueMap)&&sa.setNoOperValueMap(V);var W=
[],za=f.users;if(za){for(V=0;V<za.length;V++){var va=new qb;va.fromJsonObject(za[V]);W.push(va)}sa.setUsers(W)}V=[];if(va=f.roles){for(W=0;W<va.length;W++)za=new qb,za.fromJsonObject(va[W]),V.push(za);sa.setRoles(V)}W=[];if(za=f.carryUsers){for(V=0;V<za.length;V++)va=new qb,va.fromJsonObject(za[V]),W.push(va);sa.setCarryUsers(W)}V=[];if(f=f.permLabels)for(va=0;va<f.length;va++)W=new Db,W.fromJsonObject(f[va]),V.push(W);sa.setPermLabels(V)};this.copy=function(){var f=new Aa;f.fromJsonObject(sa.toJsonObject());
f.setModifierName(C);return f}}function Va(){var sa,m,Qa,Na,Xa,pb,Ba,Cb,h,ja;this.setSpaceID=function(gb){ja=gb};this.getSpaceID=function(){return ja};this.setOrderId=function(gb){h=gb};this.getOrderId=function(){return h};this.setRelationId=function(gb){Ba=gb};this.getRelationId=function(){return Ba};this.setId=function(gb){sa=gb};this.getId=function(){return sa};this.setName=function(gb){m=gb};this.getName=function(){return m};this.setParentId=function(gb){Qa=gb};this.getParentId=function(){return Qa};
this.setIsPreset=function(gb){Na=gb};this.getIsPreset=function(){return Na};this.setParentNode=function(gb){Xa=gb};this.getParentNode=function(){return Xa};this.setIsHidden=function(gb){pb=gb};this.getIsHidden=function(){return pb};this.setIsSearch=function(gb){Cb=gb};this.getIsSearch=function(){return Cb};this.getSubNodeLevel=function(){for(var gb=0,Ea=Xa;Ea;)gb++,Ea=Ea.getParentNode();return gb}}function Pa(){Va.call(this);var sa=this,m=[],Qa,Na,Xa,pb,Ba,Cb;this.setCenterId1=function(h){Na=h};this.getCenterId1=
function(){return Na};this.setCenterId2=function(h){Xa=h};this.getCenterId2=function(){return Xa};this.setCenterId3=function(h){pb=h};this.getCenterId3=function(){return pb};this.setCenterId4=function(h){Ba=h};this.getCenterId4=function(){return Ba};this.setChildren=function(h){m=h};this.getChildren=function(){return m};this.setIsOpenDir=function(h){Qa=h};this.getIsOpenDir=function(){return Qa};this.getIsShow=function(){return Cb};this.setIsShow=function(h){Cb=h};this.toJsonObject=function(){var h=
{};h.children=m;return h};this.fromJsonObject=function(h){sa.setName(h.name);sa.setId(h.id);sa.setIsPreset(h.isPreset);sa.setParentId(h.parentId);sa.setRelationId(h.relationId);sa.setIsHidden(!1);sa.setIsOpenDir(!0);sa.setOrderId(h.orderId);sa.setCenterId1(h.levelId1);sa.setCenterId2(h.levelId2);sa.setCenterId3(h.levelId3);sa.setCenterId4(h.levelId4);sa.setSpaceID(h.spaceId);if(h=h.children)for(var ja=0;ja<h.length;ja++){var gb=h[ja];if(gb.tagId||gb.source){var Ea=new kb;Ea.fromJsonObject(gb);Ea.setParentNode(sa);
m.push(Ea)}else Ea=new Pa,Ea.fromJsonObject(gb),Ea.setParentNode(sa),m.push(Ea)}}}function kb(){Va.call(this);var sa=this,m,Qa;this.setTagId=function(Na){m=Na};this.getTagId=function(){return m};this.setSource=function(Na){Qa=Na};this.getSource=function(){return Qa};this.fromJsonObject=function(Na){sa.setName(Na.name);sa.setId(Na.id);sa.setIsPreset(Na.isPreset);sa.setParentId(Na.parentId);sa.setTagId(Na.tagId);sa.setIsHidden(!1);sa.setSource(Na.source);sa.setOrderId(Na.orderId);sa.setSpaceID(Na.spaceId)}}
function fb(){var sa,m,Qa=0,Na=0,Xa=760,pb=380,Ba=0,Cb=0,h,ja,gb,Ea;this.getAnalysisId=function(){return sa};this.setAnalysisId=function(bb){sa=bb};this.getPublishId=function(){return m};this.setPublishId=function(bb){m=bb};this.setApertureTop=function(bb){Qa=bb};this.getApertureTop=function(){return Qa};this.setApertureLeft=function(bb){Na=bb};this.getApertureLeft=function(){return Na};this.setApertureWidth=function(bb){Xa=bb};this.getApertureWidth=function(){return Xa};this.setApertureHeight=function(bb){pb=
bb};this.getApertureHeight=function(){return pb};this.setScrollTop=function(bb){Ba=bb};this.getScrollTop=function(){return Ba};this.setScrollLeft=function(bb){Cb=bb};this.getScrollLeft=function(){return Cb};this.setSchemaModelBook=function(bb){h=bb};this.getSchemaModelBook=function(){return h};this.setSchemaId=function(bb){gb=bb};this.getSchemaId=function(){return gb};this.setSchedule=function(bb){ja=bb};this.getSchedule=function(){return ja};this.setScheduled=function(bb){Ea=bb};this.isScheduled=
function(){return Ea};this.toJsonObject=function(){var bb={};bb.analysisId=sa;bb.publishId=m;bb.apertureTop=Qa;bb.apertureLeft=Na;bb.apertureWidth=Xa;bb.apertureHeight=pb;bb.scrollTop=Ba;bb.scrollLeft=Cb;bb.schedule=ja?ja.toJsonObject():null;bb.modelBook=h;bb.isScheduled=Ea;return bb};this.fromJsonObject=function(bb){sa=bb.analysisId;m=bb.publishId;Qa=bb.apertureTop;Na=bb.apertureLeft;Xa=bb.apertureWidth;pb=bb.apertureHeight;Ba=bb.scrollTop;Cb=bb.scrollLeft;Ea=bb.isScheduled;var wb=bb.schedule;wb&&
(ja=new Gb,ja.fromJsonObject(wb));h=bb.modelBook;gb=bb.schemaId;return bb};this.copy=function(){var bb=new fb;bb.fromJsonObject(this.toJsonObject());bb.setSchemaId(gb);return bb}}function nb(){function sa(Qa){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);Qa&&0!=Qa&&(this.protectedParseDesignable=function(){return 0==(Qa&ba.ANALYSIS_EDITABLE)},this.protectedParseDataDetailReadable=function(){return 0==(Qa&ba.ANALYSIS_DETAIL)},this.protectedParseExportable=function(){return 0==
(Qa&ba.ANALYSIS_EXPORT)},this.protectedParsePrintable=function(){return 0==(Qa&ba.ANALYSIS_PRINT)},this.protectedParsePublishable=function(){return 0==(Qa&ba.ANALYSIS_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(Qa&ba.ANALYSIS_TIMEPUSH)})}function m(Qa){com.kingdee.bos.qing.core.SquareDesignerOperationJudger.call(this);Qa&&0!=Qa&&(this.protectedParsePublishable=function(){return 0==(Qa&ba.CARD_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(Qa&ba.CARD_TIMEPUSH)})}
this.protectedMethod={parseLongerDesignerOperationJudger:function(Qa){return new sa(Qa)},parseSquareDesignerOperationJudger:function(Qa){return new m(Qa)}}}function Db(){var sa=this,m,Qa,Na,Xa,pb;this.getSpaceID=function(){return pb};this.setSpaceID=function(Ba){pb=Ba};this.getId=function(){return m};this.setId=function(Ba){m=Ba};this.getName=function(){return Qa};this.setName=function(Ba){Qa=Ba};this.getCreateTime=function(){return Na};this.setCreateTime=function(Ba){Na=Ba};this.getOperatePerms=
function(){return Xa};this.setOperatePerms=function(Ba){Xa=Ba};this.toJsonObject=function(){var Ba={};Ba.labelId=m;Ba.labelName=Qa;Ba.spaceId=pb;var Cb=[];if(Xa&&0<Xa.length)for(var h=0;h<Xa.length;h++){var ja=Xa[h].toJsonObject();Cb.push(ja)}Ba.operatePerms=Cb;return Ba};this.fromJsonObject=function(Ba){sa.setId(Ba.labelId);sa.setName(Ba.labelName);sa.setSpaceID(Ba.spaceId);sa.setCreateTime(new Date(Ba.createTime));Ba=Ba.operatePerms;var Cb=[];if(Ba&&0<Ba.length)for(var h=0;h<Ba.length;h++){var ja=
new Ib;ja.fromJsonObject(Ba[h]);Cb.push(ja)}sa.setOperatePerms(Cb)}}function Ib(){var sa=this,m,Qa,Na=0;this.getSceneType=function(){return m};this.setSceneType=function(Xa){m=Xa};this.getOperateType=function(){return Qa};this.setOperateType=function(Xa){Qa=Xa};this.getNoPermValue=function(){return Na};this.setNoPermValue=function(Xa){Na=Xa};this.toJsonObject=function(){var Xa={};Xa.sceneType=m;Xa.operateType=Qa;Xa.noPermValue=Na;return Xa};this.fromJsonObject=function(Xa){sa.setSceneType(Xa.sceneType);
sa.setOperateType(Xa.operateType);sa.setNoPermValue(Xa.noPermValue)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&(com.kingdee.bos.qing.publish={});"undefined"==typeof com.kingdee.bos.qing.publish.model&&(com.kingdee.bos.qing.publish.model={});var ib=com.kingdee.bos.qing.publish.model,
Gb=com.kingdee.bos.qing.schedule.QingSchedule,qb=com.kingdee.bos.qing.biz.common.ValueTextPair,Ma={},Ga={},db={},ba={},ia={},La={},Wa={},ob={},zb={};ib.PublishSourceType=Ma;ib.PublishTargetType=Ga;ib.PushTargetType=db;ib.OperCodeType=ba;ib.PublishModel=Aa;ib.FolderNode=Pa;ib.LeafNode=kb;ib.ThumbnailInfo=fb;ib.OperCodeMap=function(){this.getOperCodeMap=function(){var sa={};sa[La.SQUARE_LONGER]={1:"openAnalysisTool",2:"interactiveAnalytics",4:"export",8:"print",16:"publishTo",32:"timingPush",64:"scanDetails"};
sa[La.LONGER]={1:"openAnalysisTool",2:"interactiveAnalytics",4:"export",8:"print",16:"publishTo",32:"timingPush",64:"scanDetails"};sa[La.SQUARE]={256:"publishTo",512:"timingPush",128:"personalDesign"};sa[La.QING_RPT]={4:"export",8:"print",16:"saveSnapshot",32:"editSnapshot"};return sa};this.getOperNameMap=function(){return{readOnly:"\u4ec5\u67e5\u770b",editable:"\u7f16\u8f91",longerEditable:"\u7f16\u8f91","export":"\u5bfc\u51fa",print:"\u6253\u5370",publishTo:"\u53d1\u5e03\u5230",timingPush:"\u5b9a\u65f6\u63a8\u9001",
scanDetails:"\u67e5\u770b\u660e\u7ec6",canAnalysis:"\u53ef\u8fdb\u5165\u201c\u6570\u636e\u5206\u6790\u201d",canSquare:"\u53ef\u8fdb\u5165\u8bbe\u8ba1\u5668",saveSnapshot:"\u4fdd\u5b58\u5feb\u7167",openAnalysisTool:"\u53ef\u6253\u5f00\u201d\u6570\u636e\u5206\u6790\u201c\u5de5\u5177",interactiveAnalytics:"\u4ea4\u4e92\u5f0f\u5206\u6790",personalDesign:"\u53ef\u4e2a\u6027\u5316\u8bbe\u8ba1"}}};ib.PublishOperModel=function(){var sa=this,m,Qa,Na,Xa,pb;this.setText=function(Ba){pb=Ba};this.getText=function(){return pb};
this.getPublishId=function(){return m};this.setPublishId=function(Ba){m=Ba};this.getType=function(){return Qa};this.setType=function(Ba){Qa=Ba};this.getNoOperAuthValue=function(){return Na};this.setNoOperAuthValue=function(Ba){Na=Ba};this.getLevel=function(){return Xa};this.setLevel=function(Ba){Xa=Ba};this.toJsonObject=function(){var Ba={};Ba.publishId=m;Ba.type=Qa;Ba.noOperAuthValue=Na;return Ba};this.fromJsonObject=function(Ba){Ba&&(Ba.publishId&&sa.setPublishId(Ba.publishId),Ba.type&&sa.setType(Ba.type),
Ba.noOperAuthValue&&sa.setNoOperAuthValue(Ba.noOperAuthValue))}};ib.OCarryDataType=ia;ib.OperType=La;ib.RtSquareEditableConfirmerModel=function(sa){com.kingdee.bos.qing.core.RtSquareEditableConfirmer.call(this);nb.call(this);var m=this.protectedMethod;this.protectedParseSquareDesignerAccessable=function(){return 0==(sa&ba.ENTRY_SQUARE)};this.protectedParseSquareDesignerOperationJudger=function(){return m.parseSquareDesignerOperationJudger(sa)};this.protectedParseAdvancedAnalysisAccessable=function(){return 0==
(sa&ba.ENTRY_ANALYSIS)};this.protectedParseAdvancedAnalysisOperationJudger=function(){return m.parseLongerDesignerOperationJudger(sa)}};ib.RtLongerEditableConfirmerModel=function(sa){com.kingdee.bos.qing.core.RtLongerEditableConfirmer.call(this);nb.call(this);var m=this.protectedMethod;this.protectedParseLongerDesignerAccessable=function(){return 0==(sa&ba.ENTRY_ANALYSIS)};this.protectedParseLongerDesignerOperationJudger=function(){return m.parseLongerDesignerOperationJudger(sa)}};ib.LongerDesignerOperationJudgerModel=
function(sa){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);sa&&0!=sa&&(this.protectedParseDesignable=function(){return 0==(sa&ba.ANALYSIS_EDITABLE)},this.protectedParseDataDetailReadable=function(){return 0==(sa&ba.ANALYSIS_DETAIL)},this.protectedParseExportable=function(){return 0==(sa&ba.ANALYSIS_EXPORT)},this.protectedParsePrintable=function(){return 0==(sa&ba.ANALYSIS_PRINT)},this.protectedParsePublishable=function(){return 0==(sa&ba.ANALYSIS_PUBLISH)},this.protectedParseTimingPushable=
function(){return 0==(sa&ba.ANALYSIS_TIMEPUSH)})};ib.PublishVO=function(){var sa=this,m,Qa;this.getName=function(){return m};this.setName=function(Na){m=Na};this.getCreatorName=function(){return Qa};this.setCreatorName=function(Na){Qa=Na};this.fromJsonObject=function(Na){sa.setName(Na.name);sa.setCreatorName(Na.creatorName)}};ib.PermissionLabelModel=Db;ib.PermissionLabelTarget=function(){var sa=this,m,Qa,Na;this.getTargetId=function(){return m};this.setTargetId=function(Xa){m=Xa};this.getTargetName=
function(){return Qa};this.setTargetName=function(Xa){Qa=Xa};this.getTargetType=function(){return Na};this.setTargetType=function(Xa){Na=Xa};this.toJsonObject=function(){var Xa={};Xa.targetId=m;Xa.targetName=Qa;Xa.targetType=Na;return Xa};this.fromJsonObject=function(Xa){sa.setTargetId(Xa.targetId);sa.setTargetName(Xa.targetName);sa.setTargetType(Xa.targetType)}};ib.OperatePermission=Ib;ib.PermLabelTargetType=Wa;ib.OperatePermLevelType=ob;ib.PermissionConfig=function(){var sa,m,Qa,Na;this.getPermLabels=
function(){return sa};this.setPermLabels=function(Xa){sa=Xa};this.getUsers=function(Xa){return m};this.setUsers=function(Xa){m=Xa};this.getRoles=function(){return Qa};this.setRoles=function(Xa){Qa=Xa};this.setNoOperateValue=function(Xa){Na=Xa};this.getNoOperateValue=function(){return Na}};ib.PermLabelRefPublishModel=function(){var sa,m,Qa,Na,Xa,pb;this.getPublishId=function(){return sa};this.getPublishName=function(){return m};this.getPublishToType=function(){return Qa};this.getPathText=function(){return Na};
this.getCreateTime=function(){return Xa};this.getSceneType=function(){return pb};this.fromJsonObject=function(Ba){sa=Ba.publishId;m=Ba.publishName;Qa=Ba.publishToType;Na=Ba.pathText;Xa=Ba.createTime;pb=Ba.sceneType}};ib.PublishVerifyCode=zb;ib.VerifyModel=function(){var sa=this,m,Qa,Na,Xa,pb,Ba,Cb;this.setSameInputTemplateName=function(h){pb=h};this.getSameInputTemplateName=function(){return pb};this.isPathEmpty=function(){return Ba};this.setPathEmpty=function(h){Ba=h};this.isNameEmpty=function(){return Cb};
this.setNameEmpty=function(h){Cb=h};this.getPublishSourceName=function(){return m};this.setPublishSourceName=function(h){m=h};this.isNameExist=function(){return Qa};this.setNameExist=function(h){Qa=h};this.isSameSourceNameExist=function(){return Na};this.setSameSourceNameExist=function(h){Na=h};this.setLockedByOther=function(h){Xa=h};this.isLockedByOther=function(){return Xa};this.toJsonObject=function(){var h={};h.publishSourceName=m;h.isNameExist=Qa;h.isSameSourceNameExist=Na;h.isLockedByOther=
Xa;return h};this.fromJsonObject=function(h){sa.setPublishSourceName(h.publishSourceName);sa.setNameExist(h.isNameExist);sa.setSameSourceNameExist(h.isSameSourceNameExist);sa.setLockedByOther(h.isLockedByOther)}};zb.EmptyName=1;zb.SameName=2;zb.DuplicateName=3;zb.EmptyPath=4;zb.LockByOther=5;Ma.SUBJECT="subject";Ma.BILL="bill";Ma.DASHBOARD="dashboard";Ma.REPORT="report";Ma.CONTROL="control";Ma.EXTREPORT="extreport";Ga.APPMENU=0;Ga.CENTER=1;Ga.MOBILE=2;Ga.GUIMENU=4;Ga.CARD_REPOSITORY=5;Ga.EMAIL=6;
db.YZJ_ROBOT=0;db.WXQYH_ROBOT=1;db.DINGDING=3;ba.ANALYSIS_EDITABLE=2;ba.ANALYSIS_EXPORT=4;ba.ANALYSIS_PRINT=8;ba.ANALYSIS_PUBLISH=16;ba.ANALYSIS_TIMEPUSH=32;ba.ANALYSIS_DETAIL=64;ba.CARD_PUBLISH=256;ba.CARD_TIMEPUSH=512;ba.ENTRY_ANALYSIS=1;ba.ENTRY_SQUARE=128;ba.RPT_EXPORT=4;ba.RPT_PRINT=8;ba.RPT_SAVE_SNAPSHOT=16;ba.RPT_EDIT_SNAPSHOT=32;ia.REALTIMECARRYDATA="0";ia.NEVERCARRYDATA="1";ia.CARRRYDATABYUSER="2";La.SQUARE_LONGER="0";La.LONGER="1";La.SQUARE="2";La.QING_RPT="3";Wa.USER=0;Wa.ROLE=1;ob.PARENT=
1;ob.CHILDREN=2;Aa.CURRENT_SCHEMA_ID="currentAnalysisState";Aa.QING_CENTER_ID="c81a0135-1157-41a4-8e08-de55179916c1";ib.PublishContainerType={APPMENU:1,CENTER:2,LAPP:3,CARD:4}})();(function(){function Aa(){var qb,Ma,Ga,db,ba,ia,La,Wa,ob,zb,sa,m,Qa,Na,Xa,pb,Ba,Cb,h=!1;this.setIsQingRpt=function(ja){h=ja};this.isQingRpt=function(){return h};this.setSpaceID=function(ja){qb=ja};this.getSpaceID=function(){return qb};this.setDashBoardAnalysis=function(ja){Cb=ja};this.getDashBoardAnalysis=function(){return Cb};this.setWidgetsExecutingTag=function(ja){Ba=ja};this.getWidgetsExecutingTag=function(){return Ba};this.setSchemaTag=function(ja){pb=ja};this.getSchemaTag=function(){return pb};
this.getChoiceAnalysisSchema=function(){return Xa};this.setChoiceAnalysisSchema=function(ja){Xa=ja};this.getSource=function(){return Na};this.setSource=function(ja){Na=ja};this.getBizTag=function(){return Ma};this.setBizTag=function(ja){Ma=ja};this.getCurrentSourceType=function(){return Ga};this.setCurrentSourceType=function(ja){Ga=ja};this.setHaveToCarryData=function(ja){db=ja};this.isHaveToCarryData=function(){return db};this.setHasDirectModeTable=function(ja){ba=ja};this.getHasDirectModeTable=
function(){return ba};this.getCurrentContentModel=function(){return ia};this.setCurrentContentModel=function(ja){ia=ja};this.setPublishSourceName=function(ja){La=ja};this.getPublishSourceName=function(){return La};this.setScene=function(ja){Wa=ja};this.getScene=function(){return Wa};this.setMobilePreviewUrl=function(ja){ob=ja};this.getMobilePreviewUrl=function(){return ob};this.getLappEntranceUrl=function(){return zb};this.setLappEntranceUrl=function(ja){zb=ja};this.setParamPathPrefix=function(ja){sa=
ja};this.getParamPathPrefix=function(){return sa};this.supportPublishWithCarryData=function(){return Ga!=nb.REPORT&&Ga!=nb.CONTROL&&Ga!=nb.EXTREPORT?!0:!1};this.setRefToId=function(ja){m=ja};this.getRefToId=function(){return m};this.setDsbPublishId=function(ja){Qa=ja};this.getDsbPublishId=function(){return Qa};this.supportPublishMoreSchemaScene=function(ja){return Wa==Aa.Scene.Longer&&(ja==Db.APPMENU||ja==Db.CENTER)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee=
{});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&(com.kingdee.bos.qing.publish={});"undefined"==typeof com.kingdee.bos.qing.publish.common&&(com.kingdee.bos.qing.publish.common={});var Va=com.kingdee.bos.qing.publish.common;Va.PublishContext=Aa;Va.PublishFacade=function(qb,Ma,Ga,db){kb.call(this,qb,Ma,Ga,db);var ba=this.protectedMethod;this.savePublishInfo=function(ia,
La,Wa,ob,zb,sa){Wa={publishTargetType:ia,publishInfo:JSON.stringify(La.toJsonObject()),schemeModel:Wa?JSON.stringify(Wa):null,oldPublishId:ob,sDsbPublishId:zb,scene:sa};ba.remote("savePublishInfo",Wa);La=La.getCarryData()?ib.PUBLISH_CARRY_DATA:"";ib.occur(ib.PUBLISH_TO_TYPE,ib.getPublishTargetName(ia),La)};this.deletePublishInfo=function(ia,La){ba.remote("deletePublishInfo",{publishTargetType:ia,id:La})};this.deletePublishInfos=function(ia,La){ia={publishTargetType:ia,ids:JSON.stringify(La)};ba.remote("deletePublishInfos",
ia)};this.updatePublishInfo=function(ia,La,Wa,ob,zb){ia={publishTargetType:ia,publishInfo:JSON.stringify(La.toJsonObject()),schemeModel:Wa?JSON.stringify(Wa):null,updateType:ob,name:zb};ba.remote("updatePublishInfo",ia)};this.updatePublishPermLabel=function(ia){var La=[];if(ia&&0<ia.length)for(var Wa=0;Wa<ia.length;Wa++)La.push(ia[Wa].toJsonObject());ia={publishInfos:JSON.stringify(La)};ba.remote("updatePublishPermLabel",ia)};this.loadUserOrRole=function(ia){ba.remote("loadUserOrRole",{publishTargetType:-1,
permissionType:ia})};this.saveMessage=function(ia){ia={publishIdUserMap:JSON.stringify(ia)};ba.remote("saveMessage",ia)};this.loadPublishOperModel=function(ia,La,Wa){ba.remote("loadPublishOperModel",{biztag:ia,isEdit:La,dsbRefToPublishId:Wa})};this.loadPublishOperList=function(ia,La,Wa){ba.remote("loadPublishOperList",{publishId:ia,dsbPublishId:La,timedPush:Wa})};this.loadUserByRoles=function(ia){ia={roles:JSON.stringify(ia)};ba.remote("loadUserByRoles",ia)};this.loadUserIdsByRoleIdAndPermLabelId=
function(ia,La,Wa,ob){ia={roleIds:JSON.stringify(ia),permLabelIds:JSON.stringify(La),sceneType:Wa,publishId:ob};ba.remote("loadUserIdsByRoleIdAndPermLabelId",ia)};this.judgePublishOper=function(ia,La,Wa,ob){ba.remote("judgePublishOper",{publishId:ia,dsbPublishId:La,scene:Wa,publishOperValue:ob})};this.getAllSchemaAttrs=function(ia,La,Wa,ob){ba.remote("getAllSchemaAttrs",{bizTag:ia,publishSourceType:La,source:Wa,isEditPublishInfo:ob})};this.getSchemaAttrByPublishId=function(ia,La,Wa){ba.remote("getSchemaAttrByPublishId",
{publishId:ia,publishSourceType:La,source:Wa})};this.getPublishedRecordNameByInputText=function(ia,La,Wa){ba.remote("getPublishedRecordNameByInputText",{publishSourceType:ia,inputText:La,publishTargetType:Wa})};this.checkOperatorResourceLock=function(ia,La,Wa){ba.remote("checkOperatorResourceLock",{groupId:ia,OpResourceId:La,resourceId:Wa})};this.tryRequireResourceLock=function(ia,La){ba.remote("tryRequireResourceLock",{groupId:ia,resourceId:La})};this.tryAddResourceLock=function(ia,La){ba.remote("tryAddResourceLock",
{groupId:ia,resourceId:La})};this.closeResourceLock=function(ia,La,Wa){ba.remote("closeResourceLock",{groupId:ia,resourceId:La,OpResourceId:Wa})};this.checkBeforeEditAndPublishInfo=function(ia,La,Wa){ia={publishId:ia,publishSourceType:La,arrJsonSelectSchemaModel:JSON.stringify(Wa)};ba.remote("checkBeforeEditAndPublishInfo",ia)};this.checkPublishInfoIsExist=function(ia){ba.remote("checkPublishInfoIsExist",{publishId:ia})};this.loadPermLabels=function(ia,La){ba.remote("loadPermLabels",{spaceId:ia,sceneType:La})};
this.deletePermissionLabel=function(ia){ia={permLabelIds:JSON.stringify(ia)};ba.remote("deletePermissionLabel",ia)};this.savePermissionLabel=function(ia,La){var Wa=[];if(La&&0<La.length)for(var ob=0;ob<La.length;ob++)Wa.push(La[ob].toJsonObject());ia={permLabel:JSON.stringify(ia.toJsonObject()),permLabelTargets:JSON.stringify(Wa)};ba.remote("savePermissionLabel",ia)};this.loadPermissionLabelTarget=function(ia){ba.remote("loadPermissionLabelTarget",{permLabelId:ia})};this.loadUserNameByUserIds=function(ia){ia=
{userIds:JSON.stringify(ia)};ba.remote("loadUserNameByUserIds",ia)};this.loadRoleNameByRoleIds=function(ia){ia={roleIds:JSON.stringify(ia)};ba.remote("loadRoleNameByRoleIds",ia)};this.loadPermLabelRefPublish=function(ia,La,Wa,ob,zb,sa,m,Qa){ba.remote("loadPermLabelRefPublish",{targetPage:ia,pageSize:La,searchText:Wa,permLabelId:ob,publishToType:zb,sceneType:sa,sortField:m,isDesc:Qa})};this.verifyPublishName=function(ia){var La=[];if(ia&&0<ia.length)for(var Wa=0;Wa<ia.length;Wa++)La.push(ia[Wa].toJsonObject());
ia={publishInfos:JSON.stringify(La)};ba.remote("verifyPublishName",ia)};this.batchSavePublishInfos=function(ia,La,Wa,ob,zb,sa){var m=[];if(ia&&0<ia.length)for(var Qa=0;Qa<ia.length;Qa++)m.push(ia[Qa].toJsonObject());ia={publishInfos:JSON.stringify(m),schemeListJsons:La?JSON.stringify(La):null,oldPublishIds:Wa?JSON.stringify(Wa):null,dsbPublishIds:ob?JSON.stringify(ob):null,tag:zb,scene:sa};ba.remote("batchSavePublishInfos",ia)}};Va.PublishSubscribeHelper=new function(){var qb={},Ma=com.kingdee.bos.qing.framework.common.RemoteFramework;
this.putSubscribe=function(Ga,db){qb[Ga+""]=db;Ma.subscribeChannel(Ga+"",db)};this.clear=function(){for(var Ga=Object.keys(qb),db=0;db<Ga.length;db++){var ba=Ga[db];Ma.unsubscribeChannel(ba,qb[ba])}qb={}};this.getCurrentPageClientId=function(){return Ma.getClientID()}};Va.AbstractPublishItem=function(qb){var Ma;this.getPublishModel=function(){return qb};this.getJqUi=function(){Ma||(Ma=$("<div>"));return Ma}};Va.DisplayPublishedRecordName=function(qb,Ma){var Ga,db;this.setPublishModel=function(ba){db=
ba};this.getPublishModel=function(){return db};this.setPublishContext=function(ba){Ga=ba};this.getPublishContext=function(){return Ga};this.getPublishedRecordNameByInputText=function(ba,ia,La,Wa){var ob=null==db?Ga.getCurrentSourceType():db.getPublishSourceType();La=Ib.createPublishFacade(ia,Ma,La,Wa);La.setShowBlocking(!1);La.getPublishedRecordNameByInputText(ob,ba,ia)}};var Pa,kb,fb,nb,Db;(function(){var qb=com.kingdee.bos.qing.framework.common;Pa=qb.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.publish);
kb=qb.AbstractFacade;fb=qb.AbstractIcons;qb=com.kingdee.bos.qing.publish.model;nb=qb.PublishSourceType;Db=qb.PublishTargetType})();Va.PublishAdvanceViewType={DSB_VIEW:"1",LONGER_VIEW:"2",SQUARE_VIEW:"3",QING_RPT_VIEW:"4"};Aa.Scene={};Aa.Scene.Square="Square";Aa.Scene.Longer="Longer";Aa.Scene.Dashboard="Dashboard";Aa.Scene.Dashboard_Analysis="Dashboard-Analysis";Aa.Scene.Report="Report";Aa.Scene.getSceneName=function(qb){switch(qb){case Aa.Scene.Dashboard:return Pa.get("dashboard","\u4eea\u8868\u677f");
case Aa.Scene.Longer:return Pa.get("moduleLonger","\u6570\u636e\u5206\u6790");case Aa.Scene.Square:return Pa.get("moduleSquare","\u6570\u636e\u6597\u65b9");case Aa.Scene.Report:return Pa.get("extreport","\u8f7b\u62a5\u8868");default:return""}};Va.PublishFactory=new function(){var qb={},Ma={};this.addBatchPublishPanel=function(ia,La){Ma[ia]=La};this.createBatchPublishPanel=function(ia,La,Wa){return(ia=Ma[ia])?new ia(La,Wa):null};this.addPublishToPanel=function(ia,La){qb[ia]=La};var Ga=[],db={};this.addPublishManagePanel=
function(ia,La){for(var Wa=!1,ob=0,zb=Ga.length;ob<zb;ob++)if(Ga[ob]==ia){Wa=!0;Ga[ob]=ia;break}Wa||Ga.push(ia);Ga.sort();db[ia]=La};var ba={};this.addPublishFacade=function(ia,La){ba[ia]=La};this.getAllPublishManageTargetType=function(){return Ga};this.createBatchPublishToDialog=function(ia,La,Wa,ob,zb,sa,m){ia=new Va.BatchPublishToDialog(Wa,zb,ia);ia.setSpaceID(sa);ia.setPublishContexts(La);ia.setPublishContentEditEntrance(ob);ia.setLockedByOtherTemplate(m);return ia};this.createPublishToDialog=
function(ia,La,Wa,ob,zb){ob=new qb[ob](La,ob);ob.setPublishContext(Wa);La=ob.getNewPublishSuccessCallback();ia=new Va.PublishToDialog(ia,ob,zb);ia.setBiztag(Wa.getBizTag());ia.setDsbPublishId(Wa.getDsbPublishId());ia.setDsbRefToId(Wa.getRefToId());ia.setScene(Wa.getScene());La&&ia.addSuccessCallback(La);return ia};this.createPublishToEditDialog=function(ia,La,Wa){var ob=Wa.getPublishTargetType();ia=new qb[ob](ia,ob);ia.setPublishContext(La);ia.setPublishModel(Wa);Wa=Pa.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f");
La=ia.getUpdatePublishSuccessCallback();Wa=new Va.PublishToDialog(Wa,ia);La&&Wa.addSuccessCallback(La);return Wa};this.createPublishManagePanel=function(ia,La,Wa){return new db[La](ia,Wa)};this.createPublishFacade=function(ia,La,Wa,ob,zb){return new ba[ia](La,Wa,ob,zb)}};var Ib=Va.PublishFactory,ib=new function(){var qb;this.hookCollector=function(Ma){qb=Ma};this.occur=function(Ma,Ga,db){try{qb&&qb(Ma,Ga,db)}catch(ba){window.console&&console.warn(ba)}};this.getPublishTargetName=function(Ma){if(0==
Ma)return"Appmenu";if(1==Ma)return"Center";if(2==Ma)return"Mobile";if(4==Ma)return"Guimenu";if(5==Ma)return"Card";if(6==Ma)return"Email"}};ib.PUBLISH_TO_TYPE="publish-to-type";ib.PUBLISH_CARRY_DATA="\u643a\u5e26\u6570\u636e";ib.COMMUNICATE_TYPE="communicate-type";ib.YZJ_COMMUNICATE="\u4e91\u4e4b\u5bb6\u6c9f\u901a";ib.EMAIL_SCHEDULE_PUSH="\u90ae\u4ef6\u5b9a\u65f6\u63a8\u9001";ib.CHAT_ROBOT_SCHEDULE_PUSH="\u7fa4\u7ec4\u673a\u5668\u4eba\u5b9a\u65f6\u63a8\u9001";ib.MISSION_CLOUD_SCHEDULE_PUSH="\u7f8e\u4fe1\u4e91\u5b9a\u65f6\u63a8\u9001";
Va.UserOperationReporter=ib;Va.PublishAdvancePanelFactory=new function(){var qb={};this.addPublishAdvancePanel=function(Ma,Ga){qb[Ma]=Ga};this.createPublishAdvancePanel=function(Ma,Ga,db){if(Ma=qb[Ma])return new Ma(Ga,db)}};var Gb=new function(){var qb={};this.addOperatePermPane=function(Ma,Ga){qb[Ma]=Ga};this.createOperatePermPane=function(Ma,Ga){if(Ma=qb[Ma])return new Ma(Ga)}};Va.OperatePermPaneFactory=Gb;Gb=new function(){fb.call(this);var qb=this.protectedMethod;this.protectedInit=function(db,
ba){db=com.kingdee.bos.qing.publish.common.ComboIcon;if(!db)throw Error("com.kingdee.bos.qing.publish.common.ComboIcon not found.");db.define(ba,"icon_f7.svg");Ga(0,0,"icon_f7");db.define(ba,"public-iconandimage");ba.setGap(1);ba.setStartPosition(1,51);ba.setIconSize(18,18);Ga(0,0,"icon_select");Ga(0,1,"publish_manager");Ga(1,2,"btn_delete_on");Ga(0,2,"btn_delete");Ga(1,3,"btn_edit_on");Ga(1,3,"btn_edit_hover");Ga(0,3,"btn_edit");Ga(0,4,"btn_add_sub");Ga(1,4,"btn_add_sub_on");Ga(0,5,"btn_add_current");
Ga(1,5,"btn_add_current_on");Ga(0,7,"icon_dir_close");Ga(0,8,"icon_dir_open");Ga(1,7,"icon_dir_close_on");Ga(1,8,"icon_dir_open_on");Ga(0,6,"icon_lapp_setting");Ga(1,10,"card2list");Ga(0,10,"card2listN");Ga(1,9,"card2pic");Ga(0,9,"card2picN");ba.setStartPosition(0,170);ba.setIconSize(12,12);Ga(0,0,"icon_select_small");ba.setStartPosition(1,1);ba.setIconSize(16,16);Ga(0,0,"icon_search");Ga(0,1,"icon_search_hover");ba.setStartPosition(1,111);ba.setIconSize(40,38);Ga(0,0,"icon_preset");ba.setStartPosition(115,
1);ba.setIconSize(16,16);Ga(0,0,"refresh");db.define(ba,"no-data.png");ba.setStartPosition(0,0);ba.setGap(0);ba.setIconSize(220,220);Ga(0,0,"no-data");db.define(ba,"icon_open_tips_background.png");ba.setStartPosition(0,0);ba.setGap(0);ba.setIconSize(264,192);Ga(0,0,"icon_open_tips_background");db.define(ba,"tm");ba.setGap(1);ba.setStartPosition(1,1);ba.setIconSize(16,16);Ma(0,14,"extreportData");db.define(ba,"icon_help.png");Ga(0,0,"icon_help");db.define(ba,"icon_help.png");Ga(0,1,"icon_help_white");
db.define(ba,"tm-publish");ba.setGap(0);ba.setStartPosition(0,0);ba.setIconSize(17,14);Ga(0,0,"icon-side-close");ba.setStartPosition(33,0);ba.setIconSize(17,14);Ga(0,0,"icon-side-open");ba.setStartPosition(55,0);ba.setIconSize(16,16);Ga(0,0,"dataAnalysis");ba.setStartPosition(77,0);ba.setIconSize(16,16);Ga(0,0,"dashboard");ba.setStartPosition(102,0);ba.setIconSize(16,16);Ga(0,0,"squareData");ba.setStartPosition(126,0);ba.setIconSize(15,16);Ga(0,0,"del");ba.setStartPosition(199,0);ba.setIconSize(15,
16);Ga(0,0,"del_on");ba.setStartPosition(150,0);ba.setIconSize(16,16);Ga(0,0,"edit");ba.setStartPosition(175,0);ba.setIconSize(16,16);Ga(0,0,"edit_on");ba.setStartPosition(221,0);ba.setIconSize(16,16);Ga(0,0,"add");ba.setStartPosition(244,0);ba.setIconSize(16,16);Ga(0,0,"add_on");ba.setStartPosition(295,0);ba.setIconSize(18,18);Ga(0,0,"btn_delete");ba.setStartPosition(269,0);ba.setIconSize(18,18);Ga(0,0,"btn_delete_on");db.define(ba,"schema-manage-sprite.png");ba.setStartPosition(1,21);ba.setGap(1);
ba.setIconSize(16,16);Ga(0,0,"icon_undefault");Ga(1,0,"icon_default");Ga(0,1,"icon_edit");Ga(1,1,"icon_edit_hover");db.define(ba,"public-no-data");Ga(0,0,"public-no-data");db.define(ba,"common");ba.setStartPosition(1,1);ba.setGap(1);ba.setIconSize(16,16);Ma(0,6,"tree-collapsed");Ma(0,7,"tree-expanded");db.define(ba,"msg");ba.setStartPosition(1,1);ba.setGap(1);ba.setIconSize(100,80);Ga(1,2,"msg-warning");Ga(1,1,"msg-operatorTips");Ga(2,0,"msg-jurisdiction");db.define(ba,"extreport");ba.setGap(1);ba.setStartPosition(0,
0);ba.setIconSize(16,16);Ga(1,6,"btn-view");Ga(0,6,"btn-view_hover");db.define(ba,"perm-label");ba.setGap(0);ba.setStartPosition(0,0);ba.setIconSize(18,18);Ga(0,0,"perm-label");db.define(ba,"perm-label-hover");Ga(0,0,"perm-label_hover");db.define(ba,"dm");ba.setGap(1);ba.setStartPosition(1,1);ba.setIconSize(16,16);Ga(3,15,"btn_reference")};var Ma=function(db,ba,ia){Ga(db,ba,ia+"_hover");Ga(db+1,ba,ia)},Ga=function(db,ba,ia){qb.registIcon(db,ba,ia)}};Va.MyIcons=Gb})();(function(){function Aa(S){Ga.call(this);var Z=this,G,F=Ba.getAllPublishManageTargetType()[0],P=this.protectedMethod,n,w;(function(){P.setTitle(m.get("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406"));Z.setSize(705,500);P.setSelectable(!0);P.setContentPaneCreator(function(){n||(n=new Va(S,F),n.setSpaceID(G));n.setMessageCurtain(P.getMessageCurtain());return n.getJqUi()});P.setFooterClosingOnly(!0);P.setClosingChecker2(null,function(C){P.destroy();w&&n&&w(n.getPermLabels());return!0});P.setClosingAction(function(C){})})();
this.setSpaceID=function(C){G=C};this.setClosedCallback=function(C){w=C}}function Va(S,Z){function G(c){KTDefaultCellRender.call(this,c);var l=this,g=this.paintCellUI;this.paintCellUI=function(k,b){var a=l.getCurrentRowIdx(),d=l.getCurrentColIdx(),t=l.getCurrentRow().getUserObject();if(a<Qa.getHeadRowCount())g(k,b),0==d&&1==a&&(W=new ba,W.addCheckedListener(function(p,Q){if(Q){p=p.isChecked();pa=[];Q=za?Object.values(za):[];for(var J=0;J<Q.length;J++){var U=Q[J];p!=U.isChecked()&&U.setChecked(p);
p&&pa.push(U.getUserObject())}R()}}),pa.length==ca.length&&W.setChecked(!0),b=W.getJqUi(),Na.layoutCtrl(b,12,2,23,23),b.appendTo(k));else if(0==d)b=new ba,b.setUserObject(t.getId()),b.addCheckedListener(function(p,Q){if(Q){Q=p.isChecked();p=p.getUserObject();var J=pa.indexOf(p);Q?-1==J&&pa.push(p):-1!=J&&pa.splice(J,1);Q=pa.length==ca.length;W.isChecked()!=Q&&W.setChecked(Q);R()}}),-1!=pa.indexOf(t.getId())&&b.setChecked(!0),za[t.getId()]=b,b=b.getJqUi(),Na.layoutCtrl(b,12,4,23,23),b.appendTo(k);
else if(1==d)b=$("<div>"),b.addClass("publish-permission-label-cell-text"),a=t.getName(),b.text(a),b.attr("title",a),b.appendTo(k);else if(2==d){b=$("<div>");b.addClass("publish-permission-label-cell-text");if((a=t.getOperatePerms())&&0<a.length){d=[];for(var y=0;y<a.length;y++){var z=lb.Scene.getSceneName(a[y].getSceneType());-1==d.indexOf(z)&&d.push(z)}a=d.join(" , ")}else a=m.get("closePermission","\u672a\u5f00\u542f\u6743\u9650\u63a7\u5236");b.text(a);b.appendTo(k)}else 3==d?(b=$("<div>"),b.addClass("publish-permission-label-cell-text"),
b.css("text-align","center"),a=Ja.format(t.getCreateTime()),b.text(a),b.appendTo(k)):4==d&&(b=$("<div>"),b.addClass("publish-permission-label-operate-cell"),a=$("<div>"),a.addClass("publish-permission-label-operate-cell-btn"),a.attr("title",m.get("edit","\u7f16\u8f91")),a.on("click",function(){ka(t)}),Eb.backgroundWithHover(a,"btn_edit"),b.append(a),b.appendTo(k))}}var F,P,n,w,C,f,V,W,za={},va,pa=[],Ja,ca,wa,na=new pb;this.setSpaceID=function(c){va=c};this.getPermLabels=function(){return ca};this.setMessageCurtain=
function(c){wa=c};this.getJqUi=function(){!F&&Ia();return F};var Ia=function(){F=$("<div>");P=$("<div>");P.css({width:"100%",height:"100%"});Ja=new Xa;Ja.setFormatString("yyyy-MM-dd HH:mm:ss");C=new db;var c=C.getJqUi();w=u(m.get("create","\u65b0\u5efa"),function(){ka()});Na.layoutCtrl(w,110,2,null,null);w.hide();n=u(m.get("del","\u5220\u9664"),aa);Na.layoutCtrl(n,155,2,null,null);n.hide();N();var l=$(f.getUI());Na.layoutCtrl(l,null,25,670,350);P.append(c);P.append(w);P.append(n);P.append(l);F.append(P);
E()},aa=function(){if(pa&&0!=pa.length){var c=ia.createFeedbackDialog();c.setOptionType(ia.OPTION_OK_CANCEL);c.setMsgImageType(ia.MSG_DELETE);c.setMessage(m.get("deletePermLabelTips","\u5220\u9664\u6743\u9650\u6807\u7b7e\u540e\uff0c\u6743\u9650\u6807\u7b7e\u7684\u5f15\u7528\u5173\u7cfb\u5c06\u540c\u6b65\u5220\u9664\u4e14\u4e0d\u53ef\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f"));c.setClosingChecker(function(l){l==ia.RETURN_OK&&X();return!0});c.showDialog()}else wa.showPrompt(m.get("selectPermLabelTips",
"\u8bf7\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u6743\u9650\u6807\u7b7e\u3002"))},X=function(){Ba.createPublishFacade(Z,S,function(c){wa.showSuccess(m.get("deleteSuccess","\u5220\u9664\u6210\u529f"));E()},function(c,l){wa.showPrompt(m.get("deleteFail","\u5220\u9664\u5931\u8d25"))}).deletePermissionLabel(pa)},E=function(){Ba.createPublishFacade(Z,S,function(c){ca=[];pa=[];if(c&&0<c.length)for(var l=0;l<c.length;l++){var g=new cb;g.fromJsonObject(c[l]);ca.push(g)}if(ca&&0!=ca.length){if(w.show(),
n.show(),V&&V.hide(),P&&P.show(),R(),f){za={};Qa.clearWithoutHead(f);if(ca&&0<ca.length)for(c=0;c<ca.length;c++)Qa.createRow(f).setUserObject(ca[c]);Qa.refresh(f)}}else P&&P.hide(),I()},function(c,l){wa.showPrompt(m.get("loadPermLabelFail","\u52a0\u8f7d\u6743\u9650\u6807\u7b7e\u5217\u8868\u5931\u8d25\u3002"))}).loadPermLabels(va)},I=function(){if(!V){V=$("<div>");Eb.background(V,"no-data");V.addClass("publish-no-data-tips");var c=$("<span>");c.addClass("publish-no-data-tips-span");c.text(m.get("noPermLabel",
"\u6682\u672a\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e\uff0c"));var l=u(m.get("createPermLabelTips","\u65b0\u5efa\u4e00\u4e2a\u6743\u9650\u6807\u7b7e\u3002"),function(){ka()});l.addClass("publish-no-data-tips-span");V.append(c);V.append(l);F.append(V)}V.show()},R=function(){var c="";pa&&0<pa.length&&(c=m.get("selectedNum","\u5df2\u9009#1\u6761\uff0c").replace("#1",pa.length));var l="";ca&&0<ca.length&&(l=m.get("totalNum","\u5171#1\u6761").replace("#1",ca.length));c+=l;C.setText(c);na.setFontSize(12);c=
na.measureWidth(c);110<=c?(w.css("left",c+"px"),n.css("left",c+45+"px")):(w.css("left","110px"),n.css("left","155px"))},u=function(c,l){var g=$("<span>");g.text(c);g.addClass("sa-qing-publish-workbutton");if(l)g.on("click",l);return g},N=function(){f=Qa.createTable();var c=new G(f);c.setOutsideVisible(!1);f.setCellRender(c);f.setDraggableAdjusting(!0,Qa.getHeadRowCount(),0,new Pa);f.addColumns(5);f.getColumn(0).setWidth(40);f.getColumn(1).setWidth(100);f.getColumn(2).setWidth(250);f.getColumn(3).setWidth(200);
f.getColumn(4).setWidth(80);c=Qa.createHeadRow(f);c.getCell(1).setValue(m.get("publishName","\u540d\u79f0"));c.getCell(2).setValue(m.get("controlRange","\u63a7\u5236\u8303\u56f4"));c.getCell(3).setValue(m.get("createTime","\u521b\u5efa\u65f6\u95f4"));c.getCell(4).setValue(m.get("operate","\u64cd\u4f5c"))},ka=function(c){var l=c?Ca.EDIT:Ca.CREATE,g=new kb(S,Z,l);g.setSpaceID(va);l==Ca.EDIT&&g.setPermLabel(c);g.setEditSuccessCallback(function(k,b){k=b==Ca.CREATE?m.get("createSuccess","\u65b0\u5efa\u6210\u529f\u3002"):
m.get("updateSuccess","\u4fee\u6539\u6210\u529f\u3002");wa.showSuccess(k);E()});g.showDialog()}}function Pa(){KTableUIDraggableAdjustingHandler.CustomExpendor.call(this);this.getTailBlankForDragging=function(){return-1}}function kb(S,Z,G){Ga.call(this);var F=this,P=this.protectedMethod,n=this.showDialog,w=P.getMessageCurtain(),C,f,V,W,za,va=/[-<>&'"\\/@$]/;this.setSpaceID=function(ca){za=ca};this.setPermLabel=function(ca){C=ca};this.setEditSuccessCallback=function(ca){W=ca};this.showDialog=function(){G==
Ca.CREATE?pa():Ba.createPublishFacade(Z,S,function(ca){f=[];if(ca&&0<ca.length)for(var wa=0;wa<ca.length;wa++){var na=new Ab;na.fromJsonObject(ca[wa]);f.push(na)}pa()},function(ca,wa){w.showPrompt(m.get("loadTargetFail","\u83b7\u53d6\u6388\u6743\u5bf9\u8c61\u5931\u8d25\u3002"))}).loadPermissionLabelTarget(C.getId())};var pa=function(){var ca=C?C.getName():"";ca=Ca.getDialogTitle(G,ca);P.setTitle(ca);F.setSize(700,515);P.setSelectable(!0);P.setFooterClosingOnly(G==Ca.VIEW);P.setContentPaneCreator(function(){V||
(V=new fb(S,Z,G),V.setSpaceID(za),G!=Ca.CREATE&&V.setPermLabelDetail(C,f));return V.getJqUi()});P.setClosingChecker2(function(wa){if(G==Ca.VIEW)return P.destroy(),!0;Ja()},function(wa){P.destroy();return!0});P.setClosingAction(function(wa){});n()},Ja=function(){var ca=V.getPermLabelDetail();if(ca){var wa=ca.permLabel;var na=ca.permTargets}if(ca=wa?wa.getName():""){if(50<ca.length)return w.showPrompt(m.get("nameLengthTips","\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")),!1;if(va.test(ca))return w.showPrompt(m.get("nameIllegalTips",
"\u540d\u79f0\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u5b57\u7b26#1").replace("#1","-<>&'\"\\/@$")),!1}else return w.showPrompt(m.get("nameRequiredTips","\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002")),!1;if(!na||0==na.length)return w.showPrompt(m.get("noPermTargetTips","\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u89d2\u8272\u6216\u7528\u6237\u3002")),!1;C=wa;f=na;Ba.createPublishFacade(Z,S,function(Ia){C.setId(Ia);W&&W(C,G);P.destroy();return!0},function(Ia,aa){if(2302001==Ia)return w.showPrompt(m.get("duplicateNameTips",
"\u5df2\u5b58\u5728\u76f8\u540c\u540d\u79f0\u7684\u6743\u9650\u6807\u7b7e\uff0c\u8bf7\u91cd\u547d\u540d\u3002")),!0;w.showPrompt(m.get("saveFail","\u4fdd\u5b58\u5931\u8d25\u3002"));return!1}).savePermissionLabel(C,f);return!0}}function fb(S,Z,G){var F,P=G==Ca.VIEW,n,w,C=[],f=[],V,W,za,va,pa,Ja,ca;this.setSpaceID=function(E){V=E};this.setPermLabelDetail=function(E,I){n=E;w=I;f=[];if((E=n.getOperatePerms())&&0<E.length)for(I=0;I<E.length;I++)-1==f.indexOf(E[I].getSceneType())&&f.push(E[I].getSceneType())};
this.getPermLabelDetail=function(){if(!P&&F){var E=n?n.getId():"";n=new cb;n.setId(E);n.setName(W.getText());var I=[];for(E=0;E<C.length;E++)if(-1!=f.indexOf(C[E].getSceneType())){var R=C[E].getOperatePerm();I=I.concat(R)}n.setOperatePerms(I);n.getSpaceID()||n.setSpaceID(V);w=[];if((R=za.getSelectedValue())&&0<R.length)for(E=0;E<R.length;E++)I=new Ab,I.setTargetType(Hb.ROLE),I.setTargetId(R[E].getValue()),I.setTargetName(R[E].getText()),w.push(I);if((R=va.getSelectedValue())&&0<R.length)for(E=0;E<
R.length;E++)I=new Ab,I.setTargetType(Hb.USER),I.setTargetId(R[E].getValue()),I.setTargetName(R[E].getText()),w.push(I)}E={};E.permLabel=n;E.permTargets=w;return E};this.getJqUi=function(){if(!F){F=$("<div>");var E=new db(m.get("publishName","\u540d\u79f0"));E.setRequired(!0);E=E.getJqUi();W=new La;W.setEnabled(!P);W.setPlaceholder(m.get("nameInputTips","\u8bf7\u8f93\u5165\u540d\u79f0"));var I=W.getJqUi();Na.layoutCtrl(I,65,-1,220,24);F.append(E);F.append(I);wa();X();E=65;var R=m.get("controlRange",
"\u63a7\u5236\u8303\u56f4");I=(new db(R)).getJqUi();I.attr("title",R);Na.layoutCtrl(I,null,78,60,null);R=na(lb.Scene.Longer);Na.layoutCtrl(R,E,78,70,24);E+=90;var u=na(lb.Scene.Square);Na.layoutCtrl(u,E,78,70,24);E+=90;var N=na(lb.Scene.Dashboard);Na.layoutCtrl(N,E,78,70,24);E+=90;var ka=na(lb.Scene.Report);Na.layoutCtrl(ka,E,78,70,24);F.append(I);F.append(u);F.append(R);F.append(N);F.append(ka);if(n){W.setText(n.getName());I=[];R=[];if(w&&0<w.length)for(E=0;E<w.length;E++)u=w[E],N=new ja,N.setValue(u.getTargetId()),
N.setText(u.getTargetName()),u.getTargetType()==Hb.USER?I.push(N):R.push(N);P?(Ja.setUserObject(I),Ja.setShowViewIcon(0<I.length),pa.setUserObject(R),pa.setShowViewIcon(0<R.length)):(va.setSelectedValue(I),za.setSelectedValue(R));R=n.getOperatePerms();I={};if(R&&0<R.length)for(E=0;E<R.length;E++)u=I[R[E].getSceneType()],u||(u=[],I[R[E].getSceneType()]=u),u.push(R[E]);for(E=0;E<C.length;E++)R=C[E].getSceneType(),C[E].setOperatePerm(I[R])}}return F};var wa=function(){var E=(new db(m.get("role","\u89d2\u8272"))).getJqUi();
Na.layoutCtrl(E,null,40,null,null);var I=(new db(m.get("user","\u7528\u6237"))).getJqUi();Na.layoutCtrl(I,350,40,null,null);if(P){pa=new gb;pa.setDisplayTextGetter(function(N){var ka=N?N.length:0;return 1==ka?m.get("selectSingleRole",'\u5df2\u9009\u62e9\u89d2\u8272"#1"').replace("#1",N[0].getText()):1<ka?m.get("selectMultiRole",'\u5df2\u9009\u62e9"#1"\u7b49#2\u4e2a\u89d2\u8272').replace("#1",N[0].getText()).replace("#2",N.length):m.get("selectNoRole","\u5c1a\u672a\u9009\u62e9\u89d2\u8272")});pa.setViewListener(Ia,
m.get("viewRoles","\u67e5\u770b\u89d2\u8272"));var R=pa.getJqUi();Na.layoutCtrl(R,65,37,220,24);Ja=new gb;Ja.setDisplayTextGetter(function(N){var ka=N?N.length:0;return 1==ka?m.get("selectSingleUser",'\u5df2\u9009\u62e9\u7528\u6237"#1"').replace("#1",N[0].getText()):1<ka?m.get("selectMultiUser",'\u5df2\u9009\u62e9"#1"\u7b49#2\u4e2a\u7528\u6237').replace("#1",N[0].getText()).replace("#2",N.length):m.get("selectNoUser","\u5c1a\u672a\u9009\u62e9\u7528\u6237")});Ja.setViewListener(aa,m.get("viewUsers",
"\u67e5\u770b\u7528\u6237"));var u=Ja.getJqUi()}else za=new Cb,R=za.getJqUi(),Na.layoutCtrl(R,65,37,220,24),va=new h,u=va.getJqUi();Na.layoutCtrl(u,415,37,220,24);F.append(E);F.append(R);F.append(I);F.append(u)},na=function(E){var I=new ba,R=lb.Scene.getSceneName(E);I.setTooltips(R);I.setText(R);for(R=0;R<C.length;R++)if(C[R].getSceneType()==E){var u=C[R];break}I.addCheckedListener(function(N,ka){ka&&(ka=f.indexOf(E),N.isChecked()?-1==ka&&f.push(E):-1!=ka&&f.splice(ka,1),u.setEnable(N.isChecked()))});
I.setEnabled(!P);G==Ca.CREATE?(I.setChecked(!0),f.push(E)):-1!=f.indexOf(E)&&I.setChecked(!0);u.setEnable(I.isChecked());return I.getJqUi()},Ia=function(E){var I=[];if(E&&0<E.length)for(var R=0;R<E.length;R++)I.push(E[R].getValue());Ba.createPublishFacade(Z,S,function(u){var N=[];if(u&&0<u.length)for(var ka=0;ka<u.length;ka++){var c=new ja;c.fromJsonObject(u[ka]);N.push(c)}u=new Ea;u.setTitle(m.get("role","\u89d2\u8272"));u.setValueText(N);u.showDialog()}).loadRoleNameByRoleIds(I)},aa=function(E){var I=
[];if(E&&0<E.length)for(var R=0;R<E.length;R++)I.push(E[R].getValue());Ba.createPublishFacade(Z,S,function(u){var N=[];if(u&&0<u.length)for(var ka=0;ka<u.length;ka++){var c=new ja;c.fromJsonObject(u[ka]);N.push(c)}u=new Ea;u.setTitle(m.get("user","\u7528\u6237"));u.setTableHead(m.get("userName","\u59d3\u540d"),m.get("userAccount","\u8d26\u53f7"));u.setValueText(N);u.showDialog()}).loadUserNameByUserIds(I)},X=function(){var E=(new db(m.get("operatePerm","\u64cd\u4f5c\u6743\u9650"))).getJqUi();Na.layoutCtrl(E,
null,115,null,null);F.append(E);C=[];ca=new Wa;ca.setBorderVisible(!0);ca.setTabHeadItemHeight(35);ca.setTabHeadWidth(130);E=new nb(lb.Scene.Longer,!P);C.push(E);E=new nb(lb.Scene.Square,!P);C.push(E);E=new nb(lb.Scene.Dashboard,!P);C.push(E);E=new nb(lb.Scene.Report,!P);C.push(E);ca.setTabPanes(C);E=ca.getJqUi();Na.layoutCtrl(E,null,140,668,260);F.append(E);setTimeout(function(){ca.refreshUi()},0)}}function nb(S,Z){Wa.AbstractTabPane.call(this);var G,F=!0,P,n,w={};this.getSceneType=function(){return S};
this.setEnable=function(f){F=f;n&&n.setEnable(F)};this.getOperatePerm=function(){!G&&C();w=n.getNoOperateValueMap();var f=Object.keys(w),V=[];if(F&&f&&0<f.length)for(var W=0;W<f.length;W++){var za=new yb;za.setSceneType(S);za.setOperateType(f[W]);za.setNoPermValue(w[f[W]]);V.push(za)}return V};this.setOperatePerm=function(f){w={};if(f&&0<f.length)for(var V=0;V<f.length;V++)w[f[V].getOperateType()]|=f[V].getNoPermValue()};this.getTabHeadText=function(){P||(P=lb.Scene.getSceneName(S));return P};this.getJqUi=
function(){!G&&C();return G};var C=function(){G=$("<div>");var f=$("<div>");f.css({width:"calc(100% - 70px)",height:"calc(100% - 20px)",position:"absolute",left:"35px",top:"10px"});n=hb.createOperatePermPane(S,Z);n.setEnable(F);n.setNoOperateValueMap(w);f.append(n.getJqUi());G.append(f)}}function Db(S,Z){var G=this,F,P,n,w=!0,C=[],f={},V={},W=0,za=0;this.setEnable=function(ca){w=ca;F&&pa(w)};this.getHeight=function(){return W};this.getWidth=function(){return za};this.getJqUi=function(){F||(F=$("<div>"),
pa(w),va());return F};this.getNoOperateValueMap=function(){f={};if(w&&C&&0!=C.length)for(var ca=0;ca<C.length;ca++){var wa=C[ca],na=wa.getUserObject();wa=wa.isChecked()?0:na.getNoOperAuthValue();f[na.getType()]=wa|f[na.getType()]}return f};this.setNoOperateValueMap=function(ca){f=ca?ca:{};F&&va()};this.setParentNoOperateValue=function(ca){V=ca?ca:{}};var va=function(){if(w&&C&&0!=C.length)for(var ca=0;ca<C.length;ca++){var wa=C[ca],na=wa.getUserObject(),Ia=0==(V[na.getType()]&na.getNoOperAuthValue());
na=Ia&&0==(f[na.getType()]&na.getNoOperAuthValue());wa.setChecked(na);wa.setEnabled(Ia&&S)}};this.protectedInitUi=function(ca){throw Error("Override me");};this.protectedIsSameLine=function(){return!0};var pa=function(ca){if(ca){if(n&&n.hide(),P?P.show():(P=$("<div>"),P.css({width:"100%",height:"100%",position:"absolute",overflow:"auto"}),G.protectedInitUi(P),F.append(P)),C&&0<C.length)for(ca=0;ca<C.length;ca++)C[ca].setChecked(!0)}else P&&P.hide(),n?n.show():(n=$("<div>"),ca=m.get("notInControlScopeTips",
"\u201c#1\u201d\u4e0d\u5728\u63a7\u5236\u8303\u56f4\u5185").replace("#1",lb.Scene.getSceneName(Z)),n.text(ca),n.css({position:"absolute",color:"rgb(102, 102, 102)",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}),F.append(n))},Ja=function(ca,wa){if(ca&&wa&&0!=wa.length){ca.addCheckedListener(function(Ia,aa){if(!Ia.isChecked())for(aa=0;aa<wa.length;aa++){var X=wa[aa];X.isEnabled()&&X.setChecked(Ia.isChecked())}});for(var na=0;na<wa.length;na++)wa[na].addCheckedListener(function(Ia,aa){Ia.isChecked()&&
ca.isEnabled()&&ca.setChecked(Ia.isChecked())})}};this.protectedMethod={createOperatePermGroupUi:function(ca,wa,na,Ia){if(!wa||0==wa.length)return 0;for(var aa=na,X,E=[],I=0;I<wa.length;I++){var R=wa[I],u=new ba;u.setUserObject(R);var N=R.getText();u.setText(N);var ka=u.getJqUi();ka.attr("title",N);ca.append(ka);C.push(u);N=Ia;R.getLevel()==Sa.CHILDREN?(E.push(u),N+=20):X=u;Na.layoutCtrl(ka,N,aa,160,23);aa+=23}S&&0<E.length&&Ja(X,E);return aa-na},createOperatePermItem:function(ca,wa,na,Ia){var aa=
new Jb;aa.setType(ca);aa.setNoOperAuthValue(wa);aa.setLevel(na);aa.setText(Ia);return aa},setWidth:function(ca){za=ca},setHeight:function(ca){W=ca}}}function Ib(S,Z){Ga.call(this);var G=this,F=this.protectedMethod,P,n,w,C,f,V;(function(){F.setTitle(m.get("selectPermLabel","\u9009\u62e9\u6743\u9650\u6807\u7b7e"));G.setSize(480,450);F.setSelectable(!0);F.setContentPaneCreator(function(){n||(n=new ib(S,Z),n.setSpaceID(P),n.setSceneType(V));n.setAllPermLabel(w);n.setSelected(C);return n.getJqUi()});F.setClosingChecker2(function(W){W=
n.getSelected();f&&f(W);F.destroy();return!0},function(W){F.destroy();return!0});F.setClosingAction(function(W){})})();this.setSpaceID=function(W){P=W};this.setPermLabel=function(W){w=W};this.setSelected=function(W){C=W};this.setCallbackAfterSelected=function(W){f=W};this.setSceneType=function(W){V=W}}function ib(S,Z){function G(u){KTDefaultCellRender.call(this,u);var N=this,ka=this.paintCellUI;this.paintCellUI=function(l,g){var k=N.getCurrentRowIdx(),b=N.getCurrentColIdx(),a=N.getCurrentRow().getUserObject();
if(k<Qa.getHeadRowCount())ka(l,g),0==b&&1==k&&(Ja=new ba,Ja.addCheckedListener(function(y,z){if(z){y=y.isChecked();pa=[];z=ca?Object.values(ca):[];for(var p=0;p<z.length;p++){var Q=z[p];y!=Q.isChecked()&&Q.setChecked(y);y&&pa.push(Q.getUserObject())}}}),pa.length==va.length&&Ja.setChecked(!0),g=Ja.getJqUi(),Na.layoutCtrl(g,12,2,23,23),g.appendTo(l));else if(0==b)g=new ba,g.setUserObject(a),g.addCheckedListener(function(y,z){if(z){z=y.isChecked();y=y.getUserObject();var p=R(pa,y);z?-1==p&&pa.push(y):
-1!=p&&pa.splice(p,1);z=pa.length==va.length;Ja.isChecked()!=z&&Ja.setChecked(z)}}),-1!=R(pa,a)&&g.setChecked(!0),ca[a.getId()]=g,g=g.getJqUi(),Na.layoutCtrl(g,12,4,23,23),g.appendTo(l);else if(1==b)g=$("<div>"),g.addClass("publish-permission-label-cell-text"),k=a.getName(),(b=W.getText()?W.getText().trim():"")?c(g,b,k):g.text(k),g.attr("title",k),g.appendTo(l);else if(2==b){g=$("<div>");g.addClass("publish-permission-label-cell-text");if((k=a.getOperatePerms())&&0<k.length){b=[];for(var d=0;d<k.length;d++){var t=
lb.Scene.getSceneName(k[d].getSceneType());-1==b.indexOf(t)&&b.push(t)}k=b.join(" , ")}else k=m.get("closePermission","\u672a\u5f00\u542f\u6743\u9650\u63a7\u5236");g.text(k);g.appendTo(l)}else 3==b&&(g=$("<div>"),g.addClass("publish-permission-label-edit-icon"),g.attr("title",m.get("view","\u67e5\u770b")),g.on("click",function(){var y=new kb(F,P,Ca.VIEW);y.setSpaceID(wa);y.setPermLabel(a);y.showDialog()}),Eb.backgroundWithHover(g,"btn-view"),g.appendTo(l))};var c=function(l,g,k){if(g&&k){g=g.toUpperCase();
var b=k.toUpperCase(),a=b.split(g),d=g.length,t;for(t in a){var y=b.indexOf(a[t]),z=k.substr(Q,a[t].length);y+=a[t].length;var p=b.length-y;b=b.substr(y,p);k=k.substr(y,p);y=$("<span>");y.text(z);y.appendTo(l);if(t!=a.length-1&&1<a.length){var Q=b.indexOf(g);z=k.substr(Q,d);y=Q+d;p=b.length-y;b=b.substr(y,p);k=k.substr(y,p);y=$("<span>");y.text(z);y.css("color","red");y.clone().appendTo(l)}}}else l.text(k)}}var F=S,P=Z,n,w,C,f,V,W,za,va,pa=[],Ja,ca={},wa,na;this.setSceneType=function(u){na=u};this.setSpaceID=
function(u){wa=u};this.setAllPermLabel=function(u){va=za=u};this.getSelected=function(){var u=[];if(za&&0<za.length&&0<pa.length)for(var N=0;N<pa.length;N++)-1!=R(za,pa[N])&&u.push(pa[N]);return u};this.setSelected=function(u){pa=u?u:[]};this.getJqUi=function(){!n&&Ia();return n};var Ia=function(){n=$("<div>");W=new ob;W.setPlaceholder(m.get("searchPermLabelTips","\u641c\u7d22\u6743\u9650\u6807\u7b7e\u540d\u79f0"));W.setShowSearchIcon(!0);W.addSearchListener(X);f=W.getJqUi();Na.layoutCtrl(f,null,
-2,180,24);var u=$("<div>");u.addClass("publish-permission-label-manage-icon");u.attr("title",m.get("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406"));u.on("click",function(N){N=new Aa(F);N.setSpaceID(wa);N.showDialog();N.setClosedCallback(function(ka){na?Ba.createPublishFacade(P,F,function(c){var l=[];if(c&&0<c.length)for(var g=0;g<c.length;g++){var k=new cb;k.fromJsonObject(c[g]);l.push(k)}aa(l)}).loadPermLabels(wa,na):aa(ka)})});Eb.background(u,"perm-label");Eb.backgroundWithHover(u,"perm-label");
E();C=$(V.getUI());Na.layoutCtrl(C,null,28,450,305);n.append(f);n.append(u);n.append(C);setTimeout(function(){I()},0)},aa=function(u){za=u;pa=[];if(za&&0<za.length&&ca)for(u=0;u<za.length;u++){var N=ca[za[u].getId()];N&&N.isChecked()&&pa.push(za[u])}X()},X=function(){var u=W.getText()?W.getText().trim():"",N=!1;if(u){N=!0;va=[];for(var ka=0;ka<za.length;ka++)-1!=za[ka].getName().indexOf(u)&&va.push(za[ka])}else va=za;I(N)},E=function(){V=Qa.createTable();var u=new G(V);u.setOutsideVisible(!1);V.setCellRender(u);
V.setDraggableAdjusting(!0,Qa.getHeadRowCount(),0,new Pa);V.addColumns(4);V.getColumn(0).setWidth(40);V.getColumn(1).setWidth(60);V.getColumn(2).setWidth(270);V.getColumn(3).setWidth(80);u=Qa.createHeadRow(V);u.getCell(1).setValue(m.get("publishName","\u540d\u79f0"));u.getCell(2).setValue(m.get("controlRange","\u63a7\u5236\u8303\u56f4"));u.getCell(3).setValue(m.get("operate","\u64cd\u4f5c"))},I=function(u){ca={};if(va&&0!=va.length){if(w&&w.hide(),f.show(),C.show(),V){Qa.clearWithoutHead(V);if(va&&
0<va.length)for(u=0;u<va.length;u++)Qa.createRow(V).setUserObject(va[u]);Qa.refresh(V)}}else!u&&f.hide(),C.hide(),u=u?m.get("emptySearchTips","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"):m.get("noPermLabelTips","\u6682\u672a\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e"),w||(w=$("<div>"),w.css({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#666"}),n.append(w)),w.text(u),w.show()},R=function(u,N){if(!u||0==u.length||!N)return-1;for(var ka=0;ka<u.length;ka++)if(u[ka].getId()==
N.getId())return ka;return-1}}function Gb(S,Z,G){var F,P,n,w,C,f,V,W={},za={},va;this.setSpaceID=function(I){va=I};this.setMessageCurtain=function(I){f=I};this.getJqUi=function(){if(!F){F=$("<div>");P=$("<div>");P.addClass("publish-perm-label-setting-split-pane");P.css("border-right","1px solid #ccc");pa();var I=new sa;I.setHorizontalSplit(!0);I.setEnabled(!0);I.setFirstSize(130,130,200);I.setSecondSize(438,-1,-1);I.setResizeMode(sa.RESIZE_MODE_FIRST_FIXED);I.setFirstChild(sa.createChildWrapper(P));
I.setSecondChild(sa.createChildWrapper(n));F.append(I.getJqUi());wa()}return F};this.setPublishModels=function(I){V=I?I:[];W={};za={};if(V&&0!=V.length)for(I=0;I<V.length;I++){var R=V[I].getId(),u=V[I].getPermLabels();if(u&&0!=u.length)for(var N=0;N<u.length;N++){var ka=u[N].getId();W[ka]=u[N];za[ka]?za[ka].push(R):za[ka]=[R]}}wa()};this.getPublishModels=function(){if(F&&V&&0!=V.length)for(var I=w.getUserObjects(),R=C.getUserObjects(),u=0;u<V.length;u++){var N=[];if(I&&0<I.length)for(var ka=0;ka<
I.length;ka++)N.push(I[ka]);if(R&&0<R.length)for(ka=0;ka<R.length;ka++){var c=za[R[ka].getId()];c&&c.includes(V[u].getId())&&N.push(R[ka])}V[u].setPermLabels(N)}return V};var pa=function(){n=$("<div>");n.addClass("publish-perm-label-setting-split-pane");var I=$("<div>");I.addClass("publish-perm-label-setting");var R=$("<div>");R.addClass("publish-perm-label-setting-tips");var u=m.get("referenceForAll","\u5e94\u7528\u4e8e\u5de6\u4fa7\u5168\u90e8\u8bb0\u5f55\u7684\u6743\u9650\u6807\u7b7e");R.text(u);
R.attr("title",u);u=new zb;u.setIconType(zb.ICON_TYPE_QUESTION);u.setTipsText(m.get("referenceForAllTips","\u5c55\u793a\u5728\u5de6\u4fa7\u6240\u6709\u8bb0\u5f55\u4e2d\u5747\u4f7f\u7528\u7684\u6743\u9650\u6807\u7b7e\uff0c\n\u53ef\u4ee5\u540c\u65f6\u4e3a\u5de6\u4fa7\u6240\u6709\u8bb0\u5f55\u6dfb\u52a0\u6216\u5220\u9664\u6743\u9650\u6807\u7b7e\u3002"));u=u.getJqUi();Na.layoutCtrl(u,180,0,null,null);var N=$("<div>");N.addClass("publish-permission-label-manage-icon");N.css("top","0px");N.attr("title",
m.get("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406"));N.on("click",function(ka){ka=new Aa(S);ka.setSpaceID(va);ka.showDialog()});Eb.backgroundWithHover(N,"perm-label");I.append(R);I.append(u);I.append(N);w=Ja(I,!0);R=$("<div>");R.addClass("publish-perm-label-setting");R.css("top","5px");u=$("<div>");u.addClass("publish-perm-label-setting-tips");N=m.get("referenceForPart","\u5e94\u7528\u4e8e\u5de6\u4fa7\u90e8\u5206\u8bb0\u5f55\u7684\u6743\u9650\u6807\u7b7e");u.text(N);u.attr("title",N);
N=new zb;N.setIconType(zb.ICON_TYPE_QUESTION);N.setTipsText(m.get("referenceForPartTips","\u5c55\u793a\u5728\u5de6\u4fa7\u90e8\u5206\u8bb0\u5f55\u4e2d\u4f7f\u7528\u7684\u6743\u9650\u6807\u7b7e\uff0c\n\u5220\u9664\u540e\u5c06\u4ece\u5de6\u4fa7\u4f7f\u7528\u4e86\u8be5\u6743\u9650\u6807\u7b7e\u7684\u8bb0\u5f55\u4e2d\u79fb\u9664\u8be5\u6743\u9650\u6807\u7b7e\u3002"));N=N.getJqUi();Na.layoutCtrl(N,180,0,null,null);R.append(u);R.append(N);C=Ja(R,!1,!0);n.append(I);n.append(R)},Ja=function(I,R,u){var N=
new bb;N.setDisplayTextGetter(function(ka){return ka.getName()});N.setLabelClickListener(function(ka){var c=new kb(S,Z,Ca.VIEW);c.setSpaceID(va);c.setPermLabel(ka);c.showDialog()});R&&N.setAddClickListener(na,m.get("addPermLabel","\u6dfb\u52a0\u6743\u9650\u6807\u7b7e"));u&&N.setReferenceClickListener(ca,m.get("viewReferenceRange","\u67e5\u770b\u5e94\u7528\u8303\u56f4"));R=N.getJqUi();R.addClass("publish-perm-label-setting-editor");R.css("top","20px");I.append(R);return N},ca=function(I){var R=new qb;
R.setTabType(G);for(var u=za[I.getId()],N=[],ka=0;ka<V.length;ka++)u&&u.includes(V[ka].getId())&&N.push(V[ka]);R.setPermLabel(I);R.setReferencePublish(N);R.showDialog()},wa=function(){if(F){P.empty();if(V&&0<V.length){var I=$("<div>");I.css({position:"relative",height:"21px",width:"100%",left:"0px"});var R=m.get("selectedCount","\u5df2\u9009(#1)").replace("#1",V.length);I.text(R);P.append(I);R=$("<div>");R.css({position:"relative",height:"calc(100% - 21px)",width:"100%",left:"0px","overflow-y":"scroll"});
for(I=0;I<V.length;I++){var u=R,N=u.append,ka=V[I],c=$("<div>");c.css({position:"relative",height:"28px",width:"100%",left:"-10px"});switch(G){case ea.APPMENU:"dashboard"==ka.getPublishSourceType()?Ia(c,ka.isPreset()):"extreport"==ka.getPublishSourceType()?E(c,ka.isPreset()):X(c,ka.isPreset());break;case ea.CENTER:"dashboard"==ka.getPublishSourceType()?Ia(c,ka.isPreset()):"extreport"==ka.getPublishSourceType()?E(c,ka.isPreset()):X(c,ka.isPreset());break;case ea.LAPP:"3"==ka.getViewType()?Ia(c,ka.isPreset()):
"2"==ka.getViewType()?aa(c,ka.isPreset()):"1"==ka.getViewType()&&X(c,ka.isPreset());break;case ea.CARD:"dashboard"==ka.getPublishSourceType()?Ia(c,ka.isPreset()):aa(c,ka.isPreset())}var l=$("<div class='sa-publish-item-list-head-name'>");l.text(ka.getName());l.attr("title",ka.getName());l.appendTo(c);N.call(u,c)}P.append(R)}R=[];u=[];if((N=Object.keys(W))&&0<N.length)for(I=0;I<N.length;I++)za[N[I]].length==V.length?R.push(W[N[I]]):u.push(W[N[I]]);w.setUserObjects(R);C.setUserObjects(u)}},na=function(){Ba.createPublishFacade(Z,
S,function(I){var R=[];if(I&&0<I.length)for(var u=0;u<I.length;u++){var N=new cb;N.fromJsonObject(I[u]);R.push(N)}I=new Ib(S,Z);I.setSpaceID(va);I.setPermLabel(R);I.setCallbackAfterSelected(function(ka){w.setUserObjects(ka)});I.setSelected(w.getUserObjects());I.showDialog()},function(I,R){f.showPrompt(m.get("loadPermLabelFail","\u52a0\u8f7d\u6743\u9650\u6807\u7b7e\u5217\u8868\u5931\u8d25"))}).loadPermLabels(va)},Ia=function(I,R){var u=$("<div>");Eb.background(u,"dashboard");u.addClass("sa-qing-publish-manager-card-list-type");
R&&u.css("margin-left","5px");u.appendTo(I)},aa=function(I,R){var u=$("<div>");Eb.background(u,"squareData");u.addClass("sa-qing-publish-manager-card-list-type");R&&u.css("margin-left","5px");u.appendTo(I)},X=function(I,R){var u=$("<div>");Eb.background(u,"dataAnalysis");u.addClass("sa-qing-publish-manager-card-list-type");R&&u.css("margin-left","5px");u.appendTo(I)},E=function(I,R){var u=$("<div>");Eb.background(u,"extreportData");u.addClass("sa-qing-publish-manager-card-list-type");R&&u.css("margin-left",
"5px");u.appendTo(I)}}function qb(){function S(Ja){KTDefaultCellRender.call(this,Ja);var ca=this,wa=this.paintCellUI;this.paintCellUI=function(na,Ia){var aa=ca.getCurrentRowIdx(),X=ca.getCurrentColIdx(),E=ca.getCurrentRow().getUserObject();if(aa<Qa.getHeadRowCount())wa(na,Ia);else if(0==X){Ia=$("<div>");Ia.addClass("publish-reference-cell");aa=$("<div>");switch(f){case ea.APPMENU:"dashboard"==E.getPublishSourceType()?W(aa,E.isPreset()):"extreport"==E.getPublishSourceType()?pa(aa,E.isPreset()):va(aa,
E.isPreset());break;case ea.CENTER:"dashboard"==E.getPublishSourceType()?W(aa,E.isPreset()):"extreport"==E.getPublishSourceType()?pa(aa,E.isPreset()):va(aa,E.isPreset());break;case ea.LAPP:"3"==E.getViewType()?W(aa,E.isPreset()):"2"==E.getViewType()?za(aa,E.isPreset()):"1"==E.getViewType()&&va(aa,E.isPreset());break;case ea.CARD:"dashboard"==E.getPublishSourceType()?W(aa,E.isPreset()):za(aa,E.isPreset())}aa.addClass("publish-reference-type-icon");E=E.getName();X=$("<div>");X.addClass("publish-reference-name");
X.text(E);Ia.attr("title",E);Ia.append(aa);Ia.append(X);Ia.appendTo(na)}}}Ga.call(this);var Z=this,G=this.protectedMethod,F=this.showDialog,P,n,w,C,f;this.setTabType=function(Ja){f=Ja};this.setPermLabel=function(Ja){P=Ja};this.setReferencePublish=function(Ja){n=Ja};this.showDialog=function(){var Ja=P.getName()+m.get("referenceRange","-\u5e94\u7528\u8303\u56f4");G.setTitle(Ja);Z.setSize(450,400);G.setFooterClosingOnly(!0);G.setContentPaneCreator(function(){V();setTimeout(function(){if(w){Qa.clearWithoutHead(w);
if(n&&0<n.length)for(var ca=0;ca<n.length;ca++)Qa.createRow(w).setUserObject(n[ca]);Qa.refresh(w)}},0);return C});G.setClosingChecker2(null,function(ca){G.destroy();return!0});G.setClosingAction(function(ca){});F()};var V=function(){w=Qa.createTable();var Ja=new S(w);Ja.setOutsideVisible(!1);w.setCellRender(Ja);w.addColumns(1);w.getColumn(0).setWidth(200);Qa.createHeadRow(w).getCell(0).setValue(m.get("publishRecord","\u53d1\u5e03\u8bb0\u5f55"));C=$(w.getUI());Na.layoutCtrl(C,null,null,250,300)},W=
function(Ja,ca){var wa=$("<div>");Eb.background(wa,"dashboard");wa.addClass("sa-qing-publish-manager-card-list-type");ca&&wa.css("margin-left","5px");wa.appendTo(Ja)},za=function(Ja,ca){var wa=$("<div>");Eb.background(wa,"squareData");wa.addClass("sa-qing-publish-manager-card-list-type");ca&&wa.css("margin-left","5px");wa.appendTo(Ja)},va=function(Ja,ca){var wa=$("<div>");Eb.background(wa,"dataAnalysis");wa.addClass("sa-qing-publish-manager-card-list-type");ca&&wa.css("margin-left","5px");wa.appendTo(Ja)},
pa=function(Ja,ca){var wa=$("<div>");Eb.background(wa,"extreportData");wa.addClass("sa-qing-publish-manager-card-list-type");ca&&wa.css("margin-left","5px");wa.appendTo(Ja)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&(com.kingdee.bos.qing.publish={});"undefined"==typeof com.kingdee.bos.qing.publish.permission&&
(com.kingdee.bos.qing.publish.permission={});var Ma=com.kingdee.bos.qing.publish.permission;Ma.PermLabelManageDialog=Aa;Ma.PublishPermissionConfigPane=function(S,Z,G){var F,P,n,w,C,f,V,W,za,va=340;this.setOperatePermHeight=function(na){va=na};this.setSpaceID=function(na){za=na};this.getPermissionConfig=function(){F&&(f=new Ua,f.setRoles(P.getSelectedValue()),f.setUsers(n.getSelectedValue()),w&&f.setNoOperateValue(w.getNoOperateValueMap()),f.setPermLabels(C.getUserObjects()));return f};this.setPermissionConfig=
function(na){f=na;F&&wa()};this.setParentNoOperateValue=function(na){W=na;F&&wa()};this.setMessageCurtain=function(na){V=na};this.getJqUi=function(){!F&&pa();return F};var pa=function(){F=$("<div>");F.addClass("qing-publish-permission-panel");var na=(new db(m.get("permissionSetting","\u6743\u9650\u8bbe\u7f6e\uff1a"))).getJqUi();na.addClass("qing-publish-info-label");Na.layoutCtrlWithLRTB(na,0,0,null,0,null,23);F.append(na);var Ia=(new db(m.get("role","\u89d2\u8272"))).getJqUi();Ia.addClass("qing-publish-info-label");
Na.layoutCtrl(Ia,0,0,105,23);P=new Cb;na=P.getJqUi();Na.layoutCtrlWithLRTB(na,115,10,null,0,null,23);var aa=$("<div>");aa.addClass("qing-publish-info-item");aa.append(Ia);aa.append(na);na=(new db(m.get("user","\u7528\u6237"))).getJqUi();na.addClass("qing-publish-info-label");Na.layoutCtrl(Ia,0,0,105,23);n=new h;var X=n.getJqUi();Na.layoutCtrlWithLRTB(X,115,10,null,0,null,23);Ia=$("<div>");Ia.addClass("qing-publish-info-item");Ia.append(na);Ia.append(X);na=$("<div>");na.css({"margin-top":"28px",height:va+
"px"});na.addClass("qing-publish-info-items-block");na.append(aa);na.append(Ia);F.append(na);if(S){aa=(new db(m.get("operatePerm","\u64cd\u4f5c\u6743\u9650"))).getJqUi();aa.addClass("qing-publish-info-label");Na.layoutCtrl(aa,0,0,105,23);w=new hb.createOperatePermPane(S,!0,!1);Ia=w.getJqUi();X=0;var E=115;w.protectedIsSameLine()||(X=15,E=50);Na.layoutCtrlWithLRTB(Ia,E,10,null,X,5,null);X=$("<div>");X.addClass("qing-publish-info-item");X.css("height","240px");X.append(aa);X.append(Ia);na.append(X)}na=
m.get("permLabelTips","\u6743\u9650\u6807\u7b7e\u662f\u4e00\u7ec4\u5305\u542b\u4e86\u89d2\u8272\u3001\u7528\u6237\u548c\u64cd\u4f5c\u6743\u9650\u7684\u5b9a\u4e49\u3002\n\u53ef\u4ee5\u4f7f\u7528\u6743\u9650\u6807\u7b7e\u4e0e\u5f53\u524d\u6743\u9650\u8bbe\u7f6e\u5171\u540c\u8fdb\u884c\u63a7\u5236\u3002");C=new bb;C.setTitle(m.get("usePermLabel","\u4f7f\u7528\u6743\u9650\u6807\u7b7e"),na);C.setDisplayTextGetter(function(I){return I.getName()});C.setLabelClickListener(function(I){var R=new kb(Z,G,Ca.VIEW);
R.setSpaceID(za);R.setPermLabel(I);R.showDialog()});C.setAddClickListener(ca,m.get("addPermLabel","\u6dfb\u52a0\u6743\u9650\u6807\u7b7e"));C.setLabelChecker(Ja);na=C.getJqUi();na.addClass("qing-publish-permission-label-editor");F.append(na);wa()},Ja=function(na){if(S){var Ia=!1,aa=na.getOperatePerms();if(aa&&0<aa.length)for(var X=0;X<aa.length;X++)if(aa[X].getSceneType()==S){Ia=!0;break}aa="";Ia||(Ia=lb.Scene.getSceneName(S),aa=m.get("sceneWarningTips","\u201c#1\u201d\u4e0d\u5728\u6743\u9650\u6807\u7b7e\u201c#2\u201d\u7684\u63a7\u5236\u8303\u56f4\u5185\uff0c\u8bf7\u5220\u9664\u8be5\u6807\u7b7e\u3002").replace("#1",
Ia).replace("#2",na.getName()));return aa}},ca=function(){Ba.createPublishFacade(G,Z,function(na){var Ia=[];if(na&&0<na.length)for(var aa=0;aa<na.length;aa++){var X=new cb;X.fromJsonObject(na[aa]);Ia.push(X)}na=new Ib(Z,G);na.setSceneType(S);na.setSpaceID(za);na.setPermLabel(Ia);na.setCallbackAfterSelected(function(E){C.setUserObjects(E)});na.setSelected(C.getUserObjects());na.showDialog()},function(na,Ia){V.showPrompt(m.get("loadPermLabelFail","\u52a0\u8f7d\u6743\u9650\u6807\u7b7e\u5217\u8868\u5931\u8d25\u3002"))}).loadPermLabels(za,
S)},wa=function(){f&&(P.setSelectedValue(f.getRoles()),n.setSelectedValue(f.getUsers()),C.setUserObjects(f.getPermLabels()));if(w){var na=f?f.getNoOperateValue():{},Ia=W?Object.keys(W):[];if(0<Ia.length)for(var aa=0;aa<Ia.length;aa++)na[Ia[aa]]=(na[Ia[aa]]?na[Ia[aa]]:0)|W[Ia[aa]];w.setParentNoOperateValue(W);w.setNoOperateValueMap(na)}}};Ma.PermLabelSettingDialog=function(S,Z,G){Ga.call(this);var F=this,P=this.protectedMethod,n,w,C,f;(function(){P.setTitle(m.get("batchConfigPermLabel","\u6279\u91cf\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e"));
F.setSize(610,405);P.setSelectable(!0);P.setContentPaneCreator(function(){C||(C=new Gb(S,Z,G),C.setSpaceID(n),C.setMessageCurtain(P.getMessageCurtain()));C.setPublishModels(w);return C.getJqUi()});P.setClosingChecker2(function(V){f&&f(C.getPublishModels());P.destroy();return!0},function(V){P.destroy();return!0});P.setClosingAction(function(V){})})();this.setSpaceID=function(V){n=V};this.setPublishModels=function(V){w=V;C&&C.setPublishModels(w)};this.setCallbackAfterSetting=function(V){f=V}};var Ga,
db,ba,ia,La,Wa,ob,zb,sa,m,Qa,Na,Xa,pb,Ba,Cb,h,ja,gb,Ea,bb,wb,ub,Jb,lb,Eb,Hb,yb,cb,Ab,Sa,hb,Ua,ea;(function(){var S=com.kingdee.bos.qing.ui.component;Ga=S.AbstractModalDialog;db=S.Label;ba=S.CheckBox;ia=S.MessageDialog;La=S.TextField;Wa=S.LeftTabContainer;ob=S.SearchBox;zb=S.HelpIcon;sa=S.SplitPane;S=com.kingdee.bos.qing.framework.common;m=S.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.publish);S=com.kingdee.bos.qing.common.ui;Qa=S.TableUtil;S=com.kingdee.bos.qing.common;Na=S.DomUtil;
Xa=S.DateFormater;pb=S.TextMeasurer;S=com.kingdee.bos.qing.publish.common;Ba=S.PublishFactory;Eb=S.MyIcons;hb=S.OperatePermPaneFactory;lb=S.PublishContext;S=com.kingdee.bos.qing.biz.common;Cb=S.RoleDialogSelector;h=S.UserDialogSelector;ja=S.ValueTextPair;gb=S.DataViewer;Ea=S.ValueTextTableDialog;bb=S.LabelEditor;S=com.kingdee.bos.qing.publish.model;wb=S.OperCodeType;ub=S.OperType;Jb=S.PublishOperModel;Hb=S.PermLabelTargetType;yb=S.OperatePermission;cb=S.PermissionLabelModel;Ab=S.PermissionLabelTarget;
Sa=S.OperatePermLevelType;Ua=S.PermissionConfig;ea=S.PublishContainerType})();hb.addOperatePermPane(lb.Scene.Dashboard,function(S){Db.call(this,S,lb.Scene.Dashboard);var Z=this.protectedMethod;this.protectedInitUi=function(G){var F=25,P=$("<div>");P.css({width:"50%",height:"100%",position:"absolute",overflow:"auto","border-right":"#ccc solid 1px"});var n=(new db(m.get("squareComponent","\u201c\u6570\u636e\u6597\u65b9\u201d\u7ec4\u4ef6\uff1a"))).getJqUi();P.append(n);var w=Z.createOperatePermItem(ub.SQUARE,
wb.ENTRY_SQUARE,Sa.PARENT,m.get("personalDesign","\u53ef\u4e2a\u6027\u5316\u8bbe\u8ba1")),C=$("<div>");w=Z.createOperatePermGroupUi(C,[w],F,0);n.append(C);n=[];C=Z.createOperatePermItem(ub.LONGER,wb.ENTRY_ANALYSIS,Sa.PARENT,m.get("openAnalysisTool","\u53ef\u6253\u5f00\u201d\u6570\u636e\u5206\u6790\u201c\u5de5\u5177"));n.push(C);C=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_EDITABLE,Sa.CHILDREN,m.get("interactiveAnalytics","\u4ea4\u4e92\u5f0f\u5206\u6790"));n.push(C);C=Z.createOperatePermItem(ub.LONGER,
wb.ANALYSIS_EXPORT,Sa.CHILDREN,m.get("export","\u5bfc\u51fa"));n.push(C);C=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_PRINT,Sa.CHILDREN,m.get("print","\u6253\u5370"));n.push(C);C=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_PUBLISH,Sa.CHILDREN,m.get("publishTo","\u53d1\u5e03"));n.push(C);C=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_TIMEPUSH,Sa.CHILDREN,m.get("timingPush","\u5b9a\u65f6\u63a8\u9001"));n.push(C);C=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_DETAIL,Sa.CHILDREN,m.get("scanDetails",
"\u67e5\u770b\u660e\u7ec6"));n.push(C);F+=w+5;w=$("<div>");Z.createOperatePermGroupUi(w,n,F,0);P.append(w);F=$("<div>");F.css({width:"50%",height:"100%",position:"absolute","overflow-y":"auto",left:"50%"});w=(new db(m.get("longerComponent","\u201c\u6570\u636e\u5206\u6790\u201d\u7ec4\u4ef6\uff1a"))).getJqUi();Na.layoutCtrl(w,35,null,null,null);F.append(w);w=[];n=Z.createOperatePermItem(ub.SQUARE_LONGER,wb.ENTRY_ANALYSIS,Sa.PARENT,m.get("enterAnalysisTool","\u53ef\u8fdb\u5165\u201d\u6570\u636e\u5206\u6790\u201c\u5de5\u5177"));
w.push(n);n=Z.createOperatePermItem(ub.SQUARE_LONGER,wb.ANALYSIS_EDITABLE,Sa.CHILDREN,m.get("interactiveAnalytics","\u4ea4\u4e92\u5f0f\u5206\u6790"));w.push(n);n=Z.createOperatePermItem(ub.SQUARE_LONGER,wb.ANALYSIS_EXPORT,Sa.CHILDREN,m.get("export","\u5bfc\u51fa"));w.push(n);n=Z.createOperatePermItem(ub.SQUARE_LONGER,wb.ANALYSIS_PRINT,Sa.CHILDREN,m.get("print","\u6253\u5370"));w.push(n);n=Z.createOperatePermItem(ub.SQUARE_LONGER,wb.ANALYSIS_DETAIL,Sa.CHILDREN,m.get("scanDetails","\u67e5\u770b\u660e\u7ec6"));
w.push(n);n=$("<div>");Z.createOperatePermGroupUi(n,w,25,35);F.append(n);G.append(P);G.append(F)};this.protectedIsSameLine=function(){return!1}});hb.addOperatePermPane(lb.Scene.Longer,function(S){Db.call(this,S,lb.Scene.Longer);var Z=this.protectedMethod;this.protectedInitUi=function(G){var F=[],P=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_EDITABLE,Sa.PARENT,m.get("interactiveAnalytics","\u4ea4\u4e92\u5f0f\u5206\u6790"));F.push(P);P=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_EXPORT,Sa.PARENT,
m.get("export","\u5bfc\u51fa"));F.push(P);P=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_PRINT,Sa.PARENT,m.get("print","\u6253\u5370"));F.push(P);P=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_PUBLISH,Sa.PARENT,m.get("publishTo","\u53d1\u5e03"));F.push(P);P=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_TIMEPUSH,Sa.PARENT,m.get("timingPush","\u5b9a\u65f6\u63a8\u9001"));F.push(P);P=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_DETAIL,Sa.PARENT,m.get("scanDetails","\u67e5\u770b\u660e\u7ec6"));F.push(P);
P=$("<div>");Z.createOperatePermGroupUi(P,F,0,0);G.append(P)}});hb.addOperatePermPane(lb.Scene.Square,function(S){Db.call(this,S,lb.Scene.Square);var Z=this.protectedMethod;this.protectedInitUi=function(G){var F=[],P=Z.createOperatePermItem(ub.SQUARE,wb.ENTRY_SQUARE,Sa.PARENT,m.get("personalDesign","\u53ef\u4e2a\u6027\u5316\u8bbe\u8ba1"));F.push(P);P=Z.createOperatePermItem(ub.SQUARE,wb.CARD_PUBLISH,Sa.CHILDREN,m.get("publishTo","\u53d1\u5e03"));F.push(P);P=Z.createOperatePermItem(ub.SQUARE,wb.CARD_TIMEPUSH,
Sa.CHILDREN,m.get("timingPush","\u5b9a\u65f6\u63a8\u9001"));F.push(P);P=$("<div>");F=Z.createOperatePermGroupUi(P,F,0,0);var n=[],w=Z.createOperatePermItem(ub.LONGER,wb.ENTRY_ANALYSIS,Sa.PARENT,m.get("openAnalysisTool","\u53ef\u6253\u5f00\u201d\u6570\u636e\u5206\u6790\u201c\u5de5\u5177"));n.push(w);w=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_EDITABLE,Sa.CHILDREN,m.get("interactiveAnalytics","\u4ea4\u4e92\u5f0f\u5206\u6790"));n.push(w);w=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_EXPORT,Sa.CHILDREN,
m.get("export","\u5bfc\u51fa"));n.push(w);w=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_PRINT,Sa.CHILDREN,m.get("print","\u6253\u5370"));n.push(w);w=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_PUBLISH,Sa.CHILDREN,m.get("publishTo","\u53d1\u5e03"));n.push(w);w=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_TIMEPUSH,Sa.CHILDREN,m.get("timingPush","\u5b9a\u65f6\u63a8\u9001"));n.push(w);w=Z.createOperatePermItem(ub.LONGER,wb.ANALYSIS_DETAIL,Sa.CHILDREN,m.get("scanDetails","\u67e5\u770b\u660e\u7ec6"));
n.push(w);w=$("<div>");Z.createOperatePermGroupUi(w,n,0+(F+5),0);F=$("<div>");F.append(P);F.append(w);G.append(F)}});hb.addOperatePermPane(lb.Scene.Report,function(S){Db.call(this,S,lb.Scene.Report);var Z=this.protectedMethod;this.protectedInitUi=function(G){var F=[],P=Z.createOperatePermItem(ub.QING_RPT,wb.RPT_EXPORT,Sa.PARENT,m.get("export","\u5bfc\u51fa"));F.push(P);P=Z.createOperatePermItem(ub.QING_RPT,wb.RPT_PRINT,Sa.PARENT,m.get("print","\u6253\u5370"));F.push(P);P=Z.createOperatePermItem(ub.QING_RPT,
wb.RPT_SAVE_SNAPSHOT,Sa.PARENT,m.get("saveSnapshot","\u4fdd\u5b58\u5feb\u7167"));F.push(P);P=Z.createOperatePermItem(ub.QING_RPT,wb.RPT_EDIT_SNAPSHOT,Sa.PARENT,m.get("editSnapshot","\u7f16\u8f91\u5feb\u7167"));F.push(P);P=$("<div>");Z.createOperatePermGroupUi(P,F,0,0);G.append(P)}});var Ca={CREATE:1,EDIT:2,VIEW:3,getDialogTitle:function(S,Z){switch(S){case Ca.CREATE:return m.get("createPermLabel","\u65b0\u5efa\u6743\u9650\u6807\u7b7e");case Ca.EDIT:return m.get("editPermLabel","\u7f16\u8f91\u6743\u9650\u6807\u7b7e");
case Ca.VIEW:return m.get("viewPermLabel","\u67e5\u770b\u6743\u9650\u6807\u7b7e")+"-"+Z;default:return Z}}}})();(function(){function Aa(c,l,g){Z.call(this);var k=this,b=this.showDialog,a=this.protectedMethod,d=[],t,y,z,p,Q,J,U;(function(){a.setTitle(c);k.setSize(l.getWidth(l.isEditPublish()),l.getHeight(l.isEditPublish()));a.setSelectable(!0);l.setOuterMessageCurtain(a.getMessageCurtain());l.setPublishContentEditEntrance(g);l.setFuncReSize(a.getDialogCtrl().setBounds);a.getDialogCtrl().addClosedListener(function(da){U&&U.remove()});a.setContentPaneCreator(function(){return l.getJqUi()});a.setClosingChecker(function(da){A(da)},
!0);a.setClosingAction(function(da){})})();this.showPrompt=function(da,B){a.getMessageCurtain().showPrompt(da,B)};this.showDialog=function(){var da=l.createPreviewViewer?l.createPreviewViewer():null;if(da){var B=$(document.body),D=B.prop("clientWidth");B=B.prop("clientHeight");var T=l.getWidth(l.isEditPublish()),la=l.getHeight(l.isEditPublish());T+=da.getWidth()+10;D=(D-T>>1)+da.getWidth()+10;k.setPosition(D,B-la>>1)}b();if(D=l.createAddToHomepageUi?l.createAddToHomepageUi():null)ja.layoutCtrl(D,
16,6,200,23),$(".sa-ctrl-dialog-footer:first").append(D);O(da)};var O=function(da){if(da){U=$("<div>");U.css("z-index","999999");var B=da.getJqUi();U.append(B);$(document.body).append(U);var D=da.getWidth();da=da.getHeight();var T=(l.getHeight(l.isEditPublish())-da)/2,la=$(".sa-ctrl-dialog-title:first");B=la.offset().top+T;var oa=la.offset().left-D-10;ja.layoutCtrl(U,oa,B,D,da);la.on("mousemove",function(ra){ra=la.offset().top+T;var qa=la.offset().left-D-10;void 0!=qa&&U.css("left",qa+"px");void 0!=
ra&&U.css("top",ra+"px")})}};this.setEditPublishInfo=function(da){J=da};this.getEditPublishInfo=function(){return J};this.getDialogCtrl=function(){return a.getDialogCtrl()};this.setOuterMessageCurtain=function(da){t=da};this.addSuccessCallback=function(da){d.push(da)};this.setBiztag=function(da){y=da};this.setDsbPublishId=function(da){z=da};this.setDsbRefToId=function(da){p=da};this.setScene=function(da){Q=da};var v=function(da,B){if(d&&0<d.length)for(var D=0;D<d.length;D++){var T=d[D];T&&T(da,t,
B)}},A=function(da){var B=l.checkUIInput(function(D,T,la,oa){if(D)if(l.isEditPublish())fa(da,T);else{D=l.getModelFromUI();var ra=l.getPublishContext();D.getPublishSourceType()==bb.DASHBOARD&&D.getCarryData()&&!ra.getWidgetsExecutingTag()?(a.getMessageCurtain().showPrompt(h.get("publishNotReadyToCarryData",'\u5f00\u542f"\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"\uff0c\u9700\u6570\u636e\u51c6\u5907\u5b8c\u6210\u540e\u624d\u53ef\u8fdb\u884c\u53d1\u5e03\u64cd\u4f5c\uff0c\u8bf7\u5173\u95ed\u53d1\u5e03\u5f39\u7a97\u540e\u91cd\u8bd5\u3002'),
2E3),da(!1)):K(da,la?la:!1,T,oa?oa:!1)}else da(D)},J,function(D){a.getMessageCurtain().showPrompt(D,2E3);da(!1)});B&&(a.getMessageCurtain().showPrompt(B,2E3),da(!1))},K=function(da,B,D,T){var la=l.getModelFromUI();la.setIsOverwrite(B);la.setIsAddOldPermission(T);z?la.setPublishSourceFId(p?p:y):la.setPublishSourceFId(y);B=la.getId();la.setId(null);var oa=l.getPublishContext();T=oa.getWidgetsExecutingTag();la.setWidgetsExecutingTag(T);T=l.getAnalysisSchemaArray();var ra=[];if(null!=T)for(var qa=0;qa<
T.length;qa++)ra.push(T[qa].toJsonObject());T=null==T?[l.getJsonModel()]:ra;m.PublishFactory.createPublishFacade(l.getPublishTargetType(),l.getRemoteImpl(),function(Ka){la.setId(Ka);d&&0!=d.length?v(la,D):D||t&&t.showSuccess(h.get("publishSuccess","\u53d1\u5e03\u6210\u529f\u3002"));da(!0);Ka=com.kingdee.bos.qing.behavior.BehaviorManager;Ka.recordResourceOperation(Ka.OperationType.QING_PUBLISH)},function(Ka,H){if(2301005==Ka)return a.getMessageCurtain().showPrompt(h.get("publishNoCascadePermission",
"\u60a8\u6ca1\u6709\u8be5\u8bb0\u5f55\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u201c#1\u201d\u68c0\u67e5\u6388\u6743\u3002").replace("#1",H),2E3),da(!1),!0;if(2301006==Ka)return a.getMessageCurtain().showPrompt(h.get("publishSourcePublishNotExistException","\u539f\u53d1\u5e03\u4fe1\u606f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),da(!1),!0;if(2301007==Ka)return a.getMessageCurtain().showPrompt(h.get("publishSourceSubjectNotExist","\u539f\u4e1a\u52a1\u4e3b\u9898\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),
2E3),da(!1),!0;if(2301008==Ka)return a.getMessageCurtain().showPrompt(h.get("publishSourceDashboardNotExist","\u539f\u4eea\u8868\u677f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),da(!1),!0;if(2301009==Ka)return a.getMessageCurtain().showPrompt(h.get("publishUpdateSameSourceNameDuplicate","\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0\u3002"),2E3),da(!1),!0;if(2301010==Ka)return a.getMessageCurtain().showPrompt(h.get("qingFileStorageLimit",
"\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002"),2E3),da(!1),!0;if(2301011==Ka)return a.getMessageCurtain().showPrompt(h.get("publishSourceExtReportNotExist","\u539f\u62a5\u8868\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),da(!1),!0;if(2300001==Ka)return a.getMessageCurtain().showPrompt(h.get("qingStorageNoSpace","\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u4eba\u5458\u6dfb\u52a0\u78c1\u76d8\u3002"),2E3),da(!1),!0;if(2301013==Ka)return a.getMessageCurtain().showPrompt(h.get("mapNotFound",
"\u627e\u4e0d\u5230\u5f15\u7528\u7684\u5730\u56fe\u6a21\u677f\uff0c\u65e0\u6cd5\u53d1\u5e03\u3002"),2E3),da(!1),!0;if(2301014==Ka)return a.getMessageCurtain().showPrompt(h.get("publishCascadeMaxLimit","\u6700\u5927\u53d1\u5e03\u5c42\u7ea7\u4e0d\u80fd\u8d85\u8fc7#1\u5c42\u3002").replace("#1",H),2E3),da(!1),!0;if(2301002==Ka)return xa(da,la,D),!0;if(2301016==Ka)return a.getMessageCurtain().showPrompt(h.get("publishNoOperAuthException","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),da(!1),!0;if(23771004==
Ka)return Ka=h.get("canNotPublish","\u62a5\u8868\u6a21\u677f\u201c#1\u201d\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u53d1\u5e03\u3002").replace("#1",oa.getPublishSourceName()),a.getMessageCurtain().showPrompt(Ka,2E3),da(!1),!0;da(!1);return!1}).savePublishInfo(l.getPublishTargetType(),la,T,B,z,Q)},xa=function(da,B,D){B=$(document.body);var T=$("<div class='sa-ctrl-common-modallayer'>");T.appendTo(B);var la=new ca(T),oa=h.get("operateConfirm","\u64cd\u4f5c\u786e\u8ba4");
la.setTitle(oa);oa=B.prop("clientWidth");var ra=B.prop("clientHeight");la.setBounds(oa-300>>1,ra-200>>1,300,200);la.setToolbarVisible(!1);oa=$("<div>");var qa=h.get("publishSameSourceNameDuplicate","\u53d1\u5e03\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u786e\u5b9a\u8981\u8986\u76d6\u5417\uff1f");ra=$("<span>");ra.text(qa);ra.attr("title",qa);var Ka=h.get("isAddOldPermission","\u540c\u65f6\u6388\u6743\u7ed9\u539f\u83dc\u5355\u5df2\u6388\u6743\u7684\u7528\u6237\u548c\u89d2\u8272");qa=(new wa(Ka)).getJqUi();
qa.attr("title",Ka);var H=new na;Ka=H.getJqUi();ja.layoutCtrl(ra,5,10,270,23);ja.layoutCtrl(qa,5,45,210,23);ja.layoutCtrlWithLRTB(Ka,215,null,31,47,null,19);ra.appendTo(oa);qa.appendTo(oa);Ka.appendTo(oa);la.setContent(oa);la.addClosingListener(function(M,ma){ma?K(da,!0,D,H.isOn()):da(!1);M.destroy();T.remove();return!0});la.showFooterPane();la.show();T.appendTo(B)},fa=function(da,B){var D=l.getModelFromUI(),T=m.PublishFactory.createPublishFacade(l.getPublishTargetType(),l.getRemoteImpl(),function(qa){var Ka=
new com.kingdee.bos.qing.publish.CardModel;Ka.fromJsonObject(qa);Ka&&Ka.getImagePath()&&D.setImagePath(Ka.getImagePath());v(D);B||t&&t.showSuccess(h.get("updateSuccess","\u4fee\u6539\u6210\u529f\u3002"));da(!0)},function(qa,Ka){Ka=!1;2301001==qa||2301005==qa?(a.getMessageCurtain().showPrompt(h.get("publishInfoNotExistException","\u8be5\u8bb0\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),Ka=!0):2301002==qa?(qa=D.getPublishSourceType(),h.get(qa,qa),a.getMessageCurtain().showPrompt(h.get("publishUpdateSameSourceNameDuplicate",
"\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0\u3002"),2E3),Ka=!0):2301016==qa?(a.getMessageCurtain().showPrompt(h.get("publishNoOperAuthException","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),Ka=!0):3001002==qa&&(a.getMessageCurtain().showPrompt(h.get("publishNotExist","\u60a8\u5728\u5176\u4ed6\u9875\u9762\u5220\u9664\u4e86\u8be5\u53d1\u5e03\u8bb0\u5f55\u3002"),2E3),Ka=!0);da(!1);return Ka}),la=[],oa=D.getSchemaModelSelected();if(oa&&0<oa.length)for(var ra=
0;ra<oa.length;ra++)la.push(oa[ra].toJsonObject());la=0==la.length?null:la;oa=null==la?Aa.UPDATE_NOSCHEME:Aa.UPDATE_ALL;T.updatePublishInfo(l.getPublishTargetType(),D,la,oa);D.setSchemaModelSelected(null)}}function Va(){KTableUIDraggableAdjustingHandler.CustomExpendor.call(this);this.getTailBlankForDragging=function(){return-1}}function Pa(c,l,g){Z.call(this);var k=this,b=this.protectedMethod,a,d;(function(){var t=h.get("publishToPrefix","\u53d1\u5e03\u5230#1").replace("#1",N(l))+"-"+h.get("publishSettingTitle",
"\u53d1\u5e03\u8bbe\u7f6e");b.setTitle(t);k.setSize(750,500);b.setSelectable(!0);b.setContentPaneCreator(function(){a||(c.setOuterMessageCurtain(b.getMessageCurtain()),c.setShowPublishResult(!0),a=c.getJqUi(!0));return a});b.setClosingChecker(function(y){var z=c.getPublishModels();z&&0!=z.length?c.checkPublishModel(z,function(p){p&&0<p.length?(c.setVerifyModel(p),c.setPublishSuccessCount(0),c.updateUI(),b.getMessageCurtain().showPrompt(h.get("batchPublishSettingTips","\u90e8\u5206\u53d1\u5e03\u8bbe\u7f6e\u4e0d\u6b63\u786e\uff0c\u8bf7\u4fee\u6539\u3002")),
y(!1)):c.batchSavePublishInfos(g,function(Q,J){Q&&0<Q.length?(c.updateDataForPublishResult(Q,J),c.updateUI(),y(!1)):(d&&d(),y(!0))},function(){y(!1)})},function(p,Q){y(!1)}):y(!0)},!0);b.setClosingAction(function(y){})})();this.setSuccessCallback=function(t){d=t}}function kb(c,l,g){G.AbstractWizardStep.call(this);var k=this,b,a,d,t,y,z;this.showPrompt=function(p,Q){d&&d.showPrompt(p,Q)};this.setSpaceID=function(p){y=p};this.setPublishContexts=function(p){a=p};this.setLockedByOtherTemplate=function(p){z=
p};this.setPublishContentEditEntrance=function(p){t=p};this.getSubTitle=function(){return h.get("publishSettingTitle","\u53d1\u5e03\u8bbe\u7f6e")};this.getJqUi=function(p){b||(d=p.getMessageCurtain(),b=m.PublishFactory.createBatchPublishPanel(c,g,y),b.setPublishContexts(a),b.setOuterMessageCurtain(d),b.setPublishContentEditEntrance(t),b.setLockedByOtherTemplate(z));return b.getJqUi()};this.getBatchPublishPanel=function(){return b};this.intoThisStep=function(p,Q){b&&b.setOuterMessageCurtain(d)};this.outThisStep=
function(p,Q){p?Q():(p=b.getPublishModels(),b.checkPublishModel(p,function(J){b.setVerifyModel(J);b.updateUI();J&&0<J.length?(d.showPrompt(h.get("batchPublishSettingTips","\u90e8\u5206\u53d1\u5e03\u8bbe\u7f6e\u4e0d\u6b63\u786e\uff0c\u8bf7\u4fee\u6539\u3002")),Q(k)):Q()},function(J,U){Q(k)}))};this.over=function(p){}}function fb(c,l,g){G.AbstractWizardStep.call(this);var k=this,b,a,d,t,y,z,p,Q=!0;this.setSpaceID=function(J){p=J};this.getSubTitle=function(){return h.get("setPermission","\u8bbe\u7f6e\u6743\u9650")};
this.setSuccessCallback=function(J){z=J};this.getJqUi=function(J){if(!b){t=J.getMessageCurtain();b=$("<div>");b.addClass("qing-publish-batch-permission-config");a=$("<div>");a.addClass("publish-perm-label-setting-split-pane");a.css("border-right","1px solid #ccc");J=$("<div>");J.addClass("publish-perm-label-setting-split-pane");d=new u(l,g,c);d.setOperatePermHeight(240);d.setSpaceID(p);var U=d.getJqUi();J.append(U);U=new aa;U.setHorizontalSplit(!0);U.setEnabled(!0);U.setFirstSize(180,130,200);U.setSecondSize(478,
-1,-1);U.setResizeMode(aa.RESIZE_MODE_FIRST_FIXED);U.setFirstChild(aa.createChildWrapper(a));U.setSecondChild(aa.createChildWrapper(J));J=U.getJqUi();b.append(J)}return b};this.intoThisStep=function(J,U){y=J.getBatchPublishPanel();J=y.getPublishModels();y&&y.setOuterMessageCurtain(t);a.empty();if(J&&0<J.length){U=$("<div>");U.css({position:"relative",height:"21px",width:"100%",left:"0px"});var O=h.get("countForPublish","\u5f85\u53d1\u5e03\uff08#1\uff09").replace("#1",J.length);U.text(O);a.append(U);
U=$("<div>");U.css({position:"relative",height:"calc(100% - 21px)",width:"100%",left:"0px","overflow-y":"auto"});for(O=0;O<J.length;O++){var v=U,A=v.append,K=J[O],xa=$("<div>");xa.css({position:"relative",height:"28px",width:"100%",overflow:"hidden"});if(K.isPreset()){var fa=$("<div>");fa.text(h.get("preset","\u9884\u7f6e"));fa.addClass("sa-qing-publish-manager-name-preset-tag");fa.appendTo(xa)}var da=l;fa=$("<div>");fa.css({width:"16px",height:"16px",display:"inline-block",position:"relative",top:"-6px"});
switch(da){case m.PublishContext.Scene.Dashboard:da="dashboard";fa.css("top","1px");break;case m.PublishContext.Scene.Square:da="squareData";break;case m.PublishContext.Scene.Longer:da="dataAnalysis";break;case m.PublishContext.Scene.Report:da="extreportData";break;default:da=""}0<da.length&&m.MyIcons.background(fa,da);fa.appendTo(xa);fa=$("<div>");fa.css({"line-height":"28px","padding-left":"2px","padding-right":"2px","text-overflow":"ellipsis","white-space-collapse":"collapse","text-wrap":"nowrap",
display:"inline-block",position:"relative",overflow:"hidden",width:"calc(100% - 20px)"});fa.text(K.getName());fa.attr("title",K.getName());fa.appendTo(xa);A.call(v,xa)}a.append(U)}};this.outThisStep=function(J,U){if(J)U();else if((J=y.getPublishModels())&&0<J.length){for(var O=d.getPermissionConfig(),v=0;v<J.length;v++)O&&(J[v].setRoles(O.getRoles()),J[v].setUsers(O.getUsers()),J[v].setNoOperValueMap(O.getNoOperateValue()),J[v].setPermLabels(O.getPermLabels()));y.batchSavePublishInfos(l,function(A,
K){if(A&&0!=A.length){var xa=y;xa.updateDataForPublishResult(A,K);A=new Pa(xa,c,l);A.setSuccessCallback(z);A.showDialog()}else z&&z();U()},function(){Q=!1;U(k);Q=!0})}};this.isLastStep=function(){return Q};this.over=function(J){}}function nb(c,l){var g,k,b;this.getRemoteImpl=function(){return c};this.getPublishTargetType=function(){return l};this.setOuterMessageCurtain=function(a){g=a};this.getWidth=function(){return 830};this.getHeight=function(){return 460};this.setPublishContentEditEntrance=function(a){k=
a};this.getPublishContentEditEntrance=function(){return k};this.setFuncReSize=function(a){b=a};this.getFunResize=function(){return b};this.protectedMethod={createFacade:function(a,d,t){return m.PublishFactory.createPublishFacade(l,c,a,d,t)},getOuterMessageCurtain:function(){return g},createPermConfigPanel:function(a,d){a=new u(a,c,l);a.setSpaceID(d);a.setMessageCurtain(g);return a},loadParentNoOperateValue:function(a,d,t){var y=m.PublishFactory.createPublishFacade(l,c,function(Q){t&&t(Q.noOperValueMap)},
function(Q,J){if(2301006==Q)return g.showPrompt(h.get("publishSourcePublishNotExistException","\u539f\u53d1\u5e03\u4fe1\u606f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),!0});if(a){var z=a.getBizTag();var p=a.getDsbPublishId();a.getRefToId()&&(z=a.getRefToId())}d&&(z=d.getId(),p=null);y.loadPublishOperModel(z,null!=d,p)},createPublishManagerBtn:function(a){var d=$("<div>");d.attr("title",h.get("publishManage","\u53d1\u5e03\u7ba1\u7406"));m.MyIcons.background(d,"publish_manager");
d.on("click",a);d.addClass("publish-batch-manager-btn");return d},createOperateBtn:function(a,d){var t=$("<div>");t.text(a);t.attr("title",a);t.on("click",d);t.addClass("publish-batch-operate-btn");return t},getCustomExpendor:function(){return new Va},bindDynamicCtrlInCell:function(a,d,t,y,z){t&&(ja.layoutCtrl(t,2,1,y-4,z-2),t.addClass("qing-publish-table-cell-active-hide"),t.css("line-height",z-2+"px"),a.append(t));ja.layoutCtrl(d,0,1,y,z-2);d.addClass("qing-publish-table-cell-active-show");a.append(d);
a.addClass("qing-publish-table-cell")}}}function Db(c,l){var g=this,k,b,a,d=[],t,y=new Hb,z,p,Q,J=Eb.NEVERCARRYDATA;new R;var U={CHILDREN:1,PARENT:2},O;this.setTimedPush=function(A){O=A};this.getTimedPush=function(){return O};this.setOuterMessageCurtain=function(A){k=A};this.setPublishTargetType=function(A){b=A};this.setRemoteImpl=function(A){a=A};this.setParentNoOperValue=function(A){t=A};this.setTimingCarryData=function(A){};this.setInitSuccessCallBackHandler=function(A){z=A};this.setRefreshWidth=
function(A){p=A};this.getCarryData=function(){return J};this.getCarryDataUsers=function(){return[]};this.getNoOperValueMap=function(){for(var A={},K=0;K<d.length;K++){var xa=d[K];if(!xa.isChecked()){xa=xa.getUserObject();var fa=xa.getNoOperAuthValue()|A[xa.getType()];A[xa.getType()]=fa}}return A};var v=function(A){var K=new n;K.setUserObject(A);d.push(K);A=y.getOperCodeMap()[A.getType()][A.getNoOperAuthValue()];A=h.get(A,y.getOperNameMap()[A]);K.setText(A);K.setTooltips(A);return K};this.setCarryDataUsers=
function(A){};this.roleSelectedHandler=function(A){};this.userSelectedHandler=function(A){};this.initUi=function(){throw Error("Override me");};this.loadPublishOperModel=function(){var A=m.PublishFactory.createPublishFacade(b,a,function(fa){g.setParentNoOperValue(fa.noOperValueMap);g.setTimingCarryData(fa.isTimingCarryData);fa.parentPublishVo&&(Q=new Ab,Q.fromJsonObject(fa.parentPublishVo));z&&z(g.initUi(),p)},function(fa,da){if(2301006==fa)return k.showPrompt(h.get("publishSourcePublishNotExistException",
"\u539f\u53d1\u5e03\u4fe1\u606f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),!0});if(c){var K=c.getBizTag();var xa=c.getDsbPublishId();c.getRefToId()&&(K=c.getRefToId())}l&&(K=l.getId(),xa=null);A.loadPublishOperModel(K,null!=l,xa)};this.showOrHide=function(A,K){K?A.show():A.hide()};this.protectedMethod={createOperPerLabelUI:function(A){var K=new wa;K.setText(h.get("funcPer","\u64cd\u4f5c\u6743\u9650\uff1a"));K=K.getJqUi();K.attr("title",h.get("funcPer","\u64cd\u4f5c\u6743\u9650\uff1a"));
K.appendTo(A);ja.layoutCtrl(K,40,0,60,23)},createHelpIcon:function(){var A=new Ia;A.setIconType(Ia.ICON_TYPE_QUESTION);var K=h.get("whatsFuncPer","\u672a\u6388\u6743\u7684\u64cd\u4f5c\u6743\u9650\u5df2\u88ab\u7f6e\u7070");Q&&(K=Q.getName()?h.get("helpInstruction","\u201c#1\u201d\u53d1\u5e03\u5e76\u6388\u6743\u7ed9\u60a8\u7684\u201c#2\u201d\u4e2d\uff0c\u672a\u6388\u6743\u7684\u64cd\u4f5c\u6743\u9650\u5df2\u88ab\u7f6e\u7070").replace("#1",Q.getCreatorName()).replace("#2",Q.getName()):h.get("helpInstructionForDel",
"\u8be5\u53d1\u5e03\u8bb0\u5f55\u5c5e\u4e8e\u518d\u6b21\u53d1\u5e03\uff0c\u6765\u6e90\u53d1\u5e03\u8bb0\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\uff0c\u672a\u6388\u6743\u7684\u64cd\u4f5c\u6743\u9650\u5df2\u88ab\u7f6e\u7070"));var xa=K,fa=$("<div>");fa.css({visibility:"hidden","font-size":"12px",width:220});$("body").append(fa);fa.text(xa);xa=fa.height();fa.remove();A.setTipsSize(250,xa+20);A.setTipsText(K);return A.getJqUi()},createOperSelectedUi:function(A,K){for(var xa=0,fa=$("<div>"),
da=[],B=[],D=0;D<K.length;D++){var T=K[D],la=v(T),oa=la.getJqUi();T.getLevel()==U.CHILDREN?(ja.layoutCtrl(oa,A+10,xa,200,23),B.push(la)):(da.push(la),ja.layoutCtrl(oa,A,xa,200,23));xa+=23;oa.appendTo(fa)}if(0!=da.length)for(D=0;D<da.length;D++)la=da[D],la.addCheckedListener(function(ra,qa){if(!ra.isChecked())for(qa=0;qa<B.length;qa++){var Ka=B[qa];Ka.isEnabled()&&Ka.setChecked(ra.isChecked())}});if(0!=B.length)for(D=0;D<B.length;D++)la=B[D],la.addCheckedListener(function(ra,qa){if(ra.isChecked())for(qa=
0;qa<da.length;qa++){var Ka=da[qa];Ka.isEnabled()&&Ka.setChecked(ra.isChecked())}});return fa},getOperLevelType:function(){return U},updateAdavanceSetUi:function(){for(var A=!1,K=0;K<d.length;K++){var xa=d[K],fa=xa.getUserObject(),da=!0;t&&(da=0==(t[fa.getType()]&fa.getNoOperAuthValue()));xa.setEnabled(da);da||(A=!0);l&&l.getNoOperValueMap()?(fa=0==(l.getNoOperValueMap()[fa.getType()]&fa.getNoOperAuthValue()),xa.setChecked(fa&&da)):xa.setChecked(da)}return A},createPublishOperModel:function(A,K,xa){var fa=
new cb;fa.setType(A);fa.setNoOperAuthValue(K);fa.setLevel(xa);return fa}}}function Ib(c,l){Db.call(this,c,l);var g=this,k=this.protectedMethod;this.initUi=function(){var b=$("<div>");b.addClass("sa-qing-publish-advance-set-ui");b.hide();k.createOperPerLabelUI(b);var a=new ib,d=[],t=k.createPublishOperModel(yb.SQUARE_LONGER,lb.ENTRY_ANALYSIS,k.getOperLevelType().PARENT);d.push(t);t=k.createPublishOperModel(yb.SQUARE_LONGER,lb.ANALYSIS_EDITABLE,k.getOperLevelType().CHILDREN);d.push(t);t=k.createPublishOperModel(yb.SQUARE_LONGER,
lb.ANALYSIS_EXPORT,k.getOperLevelType().CHILDREN);d.push(t);t=k.createPublishOperModel(yb.SQUARE_LONGER,lb.ANALYSIS_PRINT,k.getOperLevelType().CHILDREN);d.push(t);t=k.createPublishOperModel(yb.SQUARE_LONGER,lb.ANALYSIS_DETAIL,k.getOperLevelType().CHILDREN);d.push(t);d=k.createOperSelectedUi(10,d);a.setTitle(h.get("moduleLonger","\u6570\u636e\u5206\u6790"));a.setOperJqUi(d);d=new ib;var y=$("<div>"),z=[],p=k.createPublishOperModel(yb.SQUARE,lb.ENTRY_SQUARE,k.getOperLevelType().PARENT);z.push(p);p=
k.createOperSelectedUi(10,z);ja.layoutCtrl(p,0,0,350,23*z.length);p.appendTo(y);p=[];t=k.createPublishOperModel(yb.LONGER,lb.ENTRY_ANALYSIS,k.getOperLevelType().PARENT);p.push(t);t=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_EDITABLE,k.getOperLevelType().CHILDREN);p.push(t);t=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_EXPORT,k.getOperLevelType().CHILDREN);p.push(t);t=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_PRINT,k.getOperLevelType().CHILDREN);p.push(t);g.getTimedPush()||(t=k.createPublishOperModel(yb.LONGER,
lb.ANALYSIS_PUBLISH,k.getOperLevelType().CHILDREN),p.push(t),t=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_TIMEPUSH,k.getOperLevelType().CHILDREN),p.push(t));t=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_DETAIL,k.getOperLevelType().CHILDREN);p.push(t);t=k.createOperSelectedUi(10,p);ja.layoutCtrl(t,0,23*z.length+6,350,23*p.length);t.appendTo(y);d.setTitle(h.get("moduleSquare","\u6570\u636e\u6597\u65b9"));d.setOperJqUi(y);y=new pa;y.setTabLevel(pa.SECOND_LEVEL);y.addTab(d,!0);y.addTab(a);a=y.getJqUi();
a.children(".sa-ctrl-second-tab-container").css({border:"0px solid #ccc"});ja.layoutCtrl(a,60,26,350,280);a.appendTo(b);k.updateAdavanceSetUi()&&(a=k.createHelpIcon(b),ja.layoutCtrl(a,105,3,16,16),a.appendTo(b));return b}}function ib(){pa.AbstractTabPane.call(this);var c=this,l,g,k;this.setOperJqUi=function(b){k=b};this.protectedInit=function(b){k.appendTo(b)};this.setTitle=function(b){l=b};this.getTitle=function(){return l};this.getJqUi=function(){g||(g=$("<div>"),c.protectedInit(g));return g};this.protectedInit=
function(b){k.appendTo(b)};this.protectedUpdateUi=function(b){};this.protectedModelChanged=function(b,a){}}function Gb(){function c(){va.call(this);var t=new S,y=new S,z=new f,p=new f,Q,J,U=!1,O=!1,v,A,K=[],xa,fa,da,B,D;this.setSelectableAndSelected=function(e,x){Q=e;J=x;e=Q;t.setPublishAppMenuAndCenter(!0);t.setCustomItemPainter(T);t.addSelectedChangedListener(la);t.setItemModels(e);ra(J)};var T=function(e,x,q){oa(x,e,q)},la=function(e,x,q){e.setSelected(q)},oa=function(e,x,q){x.on("click",function(){t.setSelected(e)});
q.css("max-width","220px");U?H(q,v,e.getSchemaName()):q.text(e.getSchemaName());q.prop("title",e.getSchemaName());x.append(q)},ra=function(e,x){y.setDrawRightSchemaList(!0);y.setCustomItemPainter(ha);y.addSelectedChangedListener(la);y.setItemModels(e);x&&y.setSelected([x])},qa=function(e,x,q){var Fa=x.getFId()?x.getSchemaName():x.getSchemaName()+h.get("editingPlanContent","(\u6b63\u5728\u7f16\u8f91\u7684\u5185\u5bb9)");q.prop("title",Fa);q.css("max-width","230px");var Ra=$("<div>");Ra.data("defaultModel",
x);Ra.addClass("public-setdefault-icon");Ra.addClass("public-icon-hide");Ra.prop("title",h.get("setDefaultScheme","\u8bbe\u4e3a\u9ed8\u8ba4\u65b9\u6848"));if(x&&x.IsDefault()){var rb=h.get("cancelDefaultScheme","\u53d6\u6d88\u9ed8\u8ba4\u65b9\u6848");Ka(q,Ra,Fa,rb,x.IsDefault());q.html(h.get("def","(\u9ed8\u8ba4)")+q.html())}else rb=h.get("setDefaultScheme","\u8bbe\u4e3a\u9ed8\u8ba4\u65b9\u6848"),Ka(q,Ra,Fa,rb,x.IsDefault());Ra.on("click",eb);var xb=$("<div>");xb.data("EditModel",x);xb.addClass("public-edit-icon");
xb.addClass("public-edit-icon-show");m.MyIcons.background(xb,"icon_edit");xb.on("mouseover",function(L){m.MyIcons.background(xb,"icon_edit_hover")});xb.on("mouseout",function(L){m.MyIcons.background(xb,"icon_edit")});xb.addClass("public-icon-hide");xb.prop("title",h.get("editScheme","\u4fee\u6539\u65b9\u6848\u540d\u79f0"));y.addEditIconClickListener(Da);e.on("mouseover",r);e.on("mouseout",Y);e.append(q);e.append(Ra);e.append(xb)},Ka=function(e,x,q,Fa,Ra){O?H(e,A,q):e.text(q);Ra?(x.addClass("public-default-icon-show"),
m.MyIcons.background(x,"icon_default")):(m.MyIcons.background(x,"icon_undefault"),x.addClass("public-undefault-icon-show"),x.on("mouseenter",function(rb){m.MyIcons.background(x,"icon_default")}),x.on("mouseleave",function(rb){m.MyIcons.background(x,"icon_undefault")}));x.prop("title",Fa)},H=function(e,x,q){if(x&&q){x=x.toUpperCase();var Fa=q.toUpperCase(),Ra=Fa.split(x),rb=x.length,xb;for(xb in Ra){var L=Fa.indexOf(Ra[xb]),ta=q.substr(sb,Ra[xb].length);L+=Ra[xb].length;var Ta=Fa.length-L;Fa=Fa.substr(L,
Ta);q=q.substr(L,Ta);L=$("<span>");L.text(ta);L.appendTo(e);if(xb!=Ra.length-1&&1<Ra.length){var sb=Fa.indexOf(x);ta=q.substr(sb,rb);L=sb+rb;Ta=Fa.length-L;Fa=Fa.substr(L,Ta);q=q.substr(L,Ta);L=$("<span>");L.text(ta);L.css("color","red");L.clone().appendTo(e)}}}else e.text(q)};this.getSelecteds=function(){return J};this.protectedCreateLeftJqTitle=function(){var e=$("<div>");e.text(h.get("savedAnalysisPlan","\u5df2\u4fdd\u5b58\u7684\u5206\u6790\u65b9\u6848"));return e};this.protectedCreateRightJqTitle=
function(){var e=$("<div>");e.text(h.get("publishAnalysisSchema","\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848"));fa=new Cb;fa.setText("\u2191");fa.addActionListener($a);da=new Cb;da.setText("\u2193");da.addActionListener(tb);var x=$("<div>");x.append(e);x.append(fa.getJqUi());x.append(da.getJqUi());ja.layoutCtrlWithLRTB(e,0,40,null,0,0,null);ja.layoutCtrlWithLRTB(fa.getJqUi(),null,20,20,0,0,null);ja.layoutCtrlWithLRTB(da.getJqUi(),null,0,20,0,0,null);return x};this.protectedGetLeftCtrl=
function(){var e=new qb;e.setSearchBox(z);z.addSearchListener(function(x){var q=x.getText(),Fa=x.getJqUi().parents(".import-square-searchBar").siblings(".schema-manage-list-owner");Fa.empty();""==q?(v=q,U=!1,t.setItemModels(Q,function(Ra,rb){var xb=Ra.getSchemaName()==rb.getSchemaName()&&Ra.getSchemaType()==rb.getSchemaType();return Ra&&rb?xb:Ra==rb}),(x=Ya(t))&&t.setSelected(x)):(v=q.trim(),U=!0,ma(q,Q,Fa,x,t,Gb.Selector_LEFT_CONTAINER_MARK))});e.setList(t);e.setPainterMark(Gb.Selector_LEFT_CONTAINER_MARK);
e.setHasSystemSchema(d);return e};this.protectedGetRightCtrl=function(){var e=new qb;e.setSearchBox(p);p.addSearchListener(function(x){var q=x.getText(),Fa=x.getJqUi().parents(".import-square-searchBar").siblings(".schema-manage-list-owner");Fa.empty();""==q?(fa.setEnabled(!0),da.setEnabled(!0),A=q,O=!1,y.setItemModels(J,function(Ra,rb){return Ra&&rb?Ra.getSchemaName()==rb.getSchemaName():Ra==rb}),(x=Ya(y))&&y.setSelected(x)):(fa.setEnabled(!1),da.setEnabled(!1),A=q.trim(),O=!0,ma(q,J,Fa,x,y,Gb.Selector_RIGHT_CONTAINER_MARK))});
e.setList(y);e.setPainterMark(Gb.Selector_RIGHT_CONTAINER_MARK);e.setHasSystemSchema(d);return e};var M=function(e,x,q){q==Gb.Selector_LEFT_CONTAINER_MARK?b=[]:a=[];for(var Fa=[],Ra=0;Ra<x.length;Ra++){var rb=x[Ra];-1<rb.getSchemaName().trim().toUpperCase().indexOf(e.trim().toUpperCase())&&(Fa.push(rb),q==Gb.Selector_LEFT_CONTAINER_MARK?b.push(rb):a.push(rb))}return Fa},ma=function(e,x,q,Fa,Ra,rb){e=M(e,x,rb);0!=e.length?(Ra.setItemModels(e,function(xb,L){return xb&&L?xb.getSchemaName()==L.getSchemaName()&&
xb.getSchemaType()==L.getSchemaType():xb==L}),(q=Ya(Ra))&&Ra.setSelected(q)):Oa(Fa,q)},Oa=function(e,x){e=$("<div>");e.addClass("sa-qing-search-content-container");var q=$("<div>");q.addClass("sa-qing-search-no-data-tips");q.css({width:"130px",height:"130px"});m.MyIcons.background(q,"public-no-data");var Fa=$("<div>");Fa.addClass("sa-qing-search-manager-content-emptytip");Fa.text(h.get("noResult","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));e.append(q);e.append(Fa);x.append(e)};
this.protectedSelect=function(e){if(e)if(e=Ya(t)){if(-1<ya(e.getSchemaName(),J)){for(var x=1;;){var q=e.getSchemaName();q+="_"+x;if(-1<$.inArray(q,K))x++;else if(-1<ya(q,J))x++,K.push(q);else break}e.setSchemaName(q)}J.push(e);A&&""!=A?(a.push(e),ra(a,e)):ra(J,e);y.setSelected(e)}else l.warn(h.get("briefSchemaPrompt1","\u672a\u9009\u4e2d\u201c\u5df2\u4fdd\u5b58\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"));else 1==J.length?l.warn(h.get("atLeastSaveAnalysisPlan","\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u5206\u6790\u65b9\u6848\u3002")):
(e=Ya(y))?(q=K.indexOf(e.getSchemaName()),-1<q&&K.splice(q,1),A&&""!=A?(q=ya(e.getSchemaName(),a),ab(e.getSchemaName(),a,!0),Ha(a,q)):(q=ya(e.getSchemaName(),J),ab(e.getSchemaName(),J,!1),Ha(J,q))):l.warn(h.get("briefFieldPrompt4","\u672a\u9009\u4e2d\u201c\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"))};var Ha=function(e,x){0<e.length&&(0==x?y.setSelected(e[0]):y.setSelected(e[x-1]))},ya=function(e,x){for(var q=0;q<x.length;q++)if(x[q].getSchemaName()==e)return q;return-1},ab=
function(e,x,q){var Fa=ya(e,x);-1<Fa?(q&&(e=ya(e,J),-1<e&&J.splice(e,1)),x.splice(Fa,1),t.setSelected(null),ra(x,null)):l.warn(h.get("briefFieldPrompt4","\u672a\u9009\u4e2d\u201c\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"))},Ya=function(e){var x=e.getSelected();e=null;x&&(e=new ea,x=$.extend(!0,{},x.toJsonObject()),e.fromJsonObject(x),e.setIsDefault(!1),e.setSchemaType(ea.SCHEMATYPE_USERDEFINED));return e},$a=function(e){if(0<J.length)if(e=y.getSelected()){var x=ya(e.getSchemaName(),
J);0<x?(J.splice(x,1),J.splice(x-1,0,e),ra(J,e),y.setSelected(e)):0==x&&l.warn(h.get("currentFirstRecord","\u5f53\u524d\u8bb0\u5f55\u5df2\u7ecf\u662f\u7b2c\u4e00\u6761\u8bb0\u5f55\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4e0a\u79fb"))}else l.warn(h.get("briefFieldPrompt4","\u672a\u9009\u4e2d\u201c\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"));else l.warn(h.get("briefFieldPrompt4","\u672a\u9009\u4e2d\u201c\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"))},tb=function(e){if(0<
J.length)if(e=y.getSelected()){var x=ya(e.getSchemaName(),J);x<J.length-1?(J.splice(x,1),J.splice(x+1,0,e),ra(J,e),y.setSelected(e)):x==J.length-1&&l.warn(h.get("currentLastRecord","\u5f53\u524d\u8bb0\u5f55\u5df2\u7ecf\u662f\u6700\u540e\u4e00\u6761\u8bb0\u5f55\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4e0b\u79fb"))}else l.warn(h.get("briefFieldPrompt4","\u672a\u9009\u4e2d\u201c\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"));else l.warn(h.get("briefFieldPrompt4","\u672a\u9009\u4e2d\u201c\u5c06\u8981\u53d1\u5e03\u7684\u5206\u6790\u65b9\u6848\u201d\u3002"))},
ha=function(e,x,q){e.on("click",function(){y.setSelected(x)});if(D&&xa&&x.getSchemaName()==xa.getSchemaName()){q=$("<div>");q.data("InputModel",xa);q.addClass("pubilc-input-text");var Fa=new Ba;Fa.setText(B?B:x.getSchemaName());Fa.addBlurListener(function(){ua(Fa,x)});Fa.addAcceptableListener(function(){ua(Fa,x)});var Ra=Fa.getJqUi();Ra.css("height","26px");Ra.removeClass("sa-ctrl-common-singlelineborder");Ra.find(".sa-ctrl-textfield-input").addClass("sa-qing-publish-ctrl-textfield-input");q.append(Ra);
e.append(q);Fa.requestFocus()}else qa(e,x,q)},ua=function(e,x){e=e.getText();if(""==e)l.warn(h.get("schemeNameCanNotNull","\u8bf7\u8f93\u5165\u65b9\u6848\u540d\u79f0"));else if(50<e.length)l.warn(h.get("schemeNameCanNotExceedLimit","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26"));else{var q;a:{for(q=0;q<J.length;q++){var Fa=J[q];if(Fa!=x&&Fa.getSchemaName()==e){q=!0;break a}}q=!1}q?(l.warn(h.get("existSchemeName","\u65b9\u6848\u540d\u79f0\u91cd\u590d")),B=e,xa=x):(B=null,D=xa.getSchemaName()!=
x.getSchemaName(),x.setSchemaName(e));A&&""!=A?y.setItemModels(a):y.setItemModels(J);y.setSelected(xa)}},Da=function(e,x){xa=e;var q=x.siblings(".public-edit-icon");y.setSelected(e);q.hide();q.siblings(".public-setdefault-icon, .schema-manage-list-item-value").hide();q=$("<div>");q.data("InputModel",e);q.addClass("pubilc-input-text");var Fa=new Ba;Fa.setText(e.getSchemaName());Fa.addBlurListener(function(){ua(Fa,e)});Fa.addAcceptableListener(function(){ua(Fa,e)});var Ra=Fa.getJqUi();Ra.css("height",
"26px");Ra.removeClass("sa-ctrl-common-singlelineborder");Ra.find(".sa-ctrl-textfield-input").addClass("sa-qing-publish-ctrl-textfield-input");q.append(Ra);x.parent(".schema-manage-list-item").append(q);Fa.requestFocus()},eb=function(e){e=$(e.currentTarget).data("defaultModel");e.setIsDefault(!e.IsDefault());for(var x=0;x<J.length;x++){var q=J[x];e.getSchemaName()!=q.getSchemaName()&&q.IsDefault()&&q.setIsDefault(!1)}A&&""!=A?y.setItemModels(a):y.setItemModels(J);y.setSelected(e)},r=function(e){e=
$(e.currentTarget);0<e.find(".public-icon-hide").length&&e.find(".public-icon-hide").removeClass("public-icon-hide")},Y=function(e){e=$(e.currentTarget);0<e.find(".public-default-icon-show").length&&e.find(".public-default-icon-show").addClass("public-icon-hide");0<e.find(".public-edit-icon-show").length&&e.find(".public-edit-icon-show").addClass("public-icon-hide");0<e.find(".public-undefault-icon-show").length&&e.find(".public-undefault-icon-show").addClass("public-icon-hide")}}Z.call(this);var l=
this,g=this.protectedMethod,k,b,a,d=!1;this.show=function(t,y,z,p,Q,J){d=J;var U;l.setSize(720,480);g.setTitle(h.get("analysisScheme","\u540c\u65f6\u9009\u62e9\u66f4\u591a\u65b9\u6848"));g.setContentPaneCreator(function(){U=new c;U.setSelectableAndSelected(t,y);return U.getJqUi()});g.setClosingChecker(function(){var O=z(U.getSelecteds());return k=O},k);g.setClosingAction(function(O){O?Q(U.getSelecteds()):p()});l.showDialog();U.relayout()};this.warn=function(t){g.getMessageCurtain().showPrompt(t)}}
function qb(){var c,l,g,k,b;this.getSearchBox=function(){return l};this.setSearchBox=function(a){l=a};this.getList=function(){return g};this.setList=function(a){g=a};this.getPainterMark=function(){return k};this.setPainterMark=function(a){k=a};this.getHasSystemSchema=function(){return b};this.setHasSystemSchema=function(a){b=a};this.getJqUi=function(){if(c)return c;c=$("<div>");var a=$("<div>");a.addClass("import-square-searchBar");l.setShowSearchIcon(!0);l.setPlaceholder(h.get("enterSearchText",
"\u641c\u7d22\u65b9\u6848\u540d\u79f0"));var d=l.getJqUi();ja.layoutCtrlWithLRTB(d,4,null,200,0,null,30);d.css({width:"98%",position:"relative","margin-bottom":"5px"});a.append(d);d=g.getJqUi();var t=d.find(".schema-manage-list-owner");t.parent().css({"max-height":"343px","overflow-y":"hidden"});t.css({"overflow-y":"auto","max-height":"301px"});$(t).before(a);c.append(d);c.css("border","1px solid #dbdbdb");return c}}function Ma(){var c,l,g,k;this.setGroupName=function(b){k=b};this.getGroupName=function(){return k};
this.setPropertyName=function(b){l=b};this.getPropertyName=function(){return l};this.setDescName=function(b){c=b};this.getDescName=function(){return c};this.setUserObject=function(b){g=b};this.getUserObject=function(){return g}}function Ga(){var c=this,l=[],g,k,b,a,d=Ga.SORT_TYPE_DESC;this.sort=function(){a&&a(b,d)};this.setFunSortModel=function(z){a=z};this.setSortTitle=function(z){g=z};this.setArrSortField=function(z){l=z};this.getArrSortField=function(){return l};this.getSortMenuModel=function(){if(!k&&
l&&0!==l.length){k=new P;var z=g?g:h.get("sort","\u6392\u5e8f");k.setText(z);k.setGroupName(z);for(var p in l){z=l[p];var Q=!1;0==p&&(Q=!0,b=z);z=t(z,Q);k.addItemModel(z)}k.addSeperator();p=new Ma;p.setDescName(h.get("DESC","\u964d\u5e8f"));p.setGroupName("SortType");p.setPropertyName(Ga.SORT_TYPE_DESC);p=t(p,!0);k.addItemModel(p);p=new Ma;p.setDescName(h.get("ASC","\u5347\u5e8f"));p.setGroupName("SortType");p.setPropertyName(Ga.SORT_TYPE_ASC);p=t(p,!1);k.addItemModel(p)}return k};var t=function(z,
p){p=F.createRadio(z.getDescName(),z.getPropertyName(),p,y);p.setUserObject(z);p.setGroupName(z.getGroupName());return p},y=function(z){if(z=z.getUserObject()){var p=z.getPropertyName();p==Ga.SORT_TYPE_DESC||p==Ga.SORT_TYPE_ASC?d=p:b=z;c.sort()}}}function db(){var c=this,l,g,k,b,a,d=!0,t;this.setEnable=function(O){d=O};this.getDropDownContent=function(O){throw Error("orrive me");};this.getPopupHeight=function(){throw Error("orrive me");};this.showRefreshBtn=function(){return!1};this.getJqUi=function(){l||
y();return l};this.setPlaceholder=function(O){y();"placeholder"in g[0]?g.attr("placeholder",O):(a&&a.remove(),a=$("<div>"),a.text(O),a.css("color","#ccc"),a.on("mousedown",function(v){g.focus()}),a.appendTo(c.getJqUi()),ja.layoutCtrlWithLRTB(a,4,4,null,2,2,null),U())};var y=function(){if(!l){l=$("<div>");l.addClass("sa-ctrl-combobox");if(d)l.on("click",p);l.css("border-bottom","1px solid #ccc");g=$("<input readonly=readonly>");g.addClass("sa-ctrl-textfield-input");g.css({color:"#666","text-overflow":"ellipsis",
padding:"0px 16px 0px 4px"});g.appendTo(l);k=$("<div>");k.addClass("sa-ctrl-combobox-arrow sa-ctrl-combobox-arrow_enabled");k.appendTo(l);k.on("mouseenter",function(O){z(!0)});k.on("mouseleave",function(O){z(!1)});z(!1)}},z=function(O){var v=b?"arrow-up":"arrow-down";O&&(v+="_hover");Na.background(k,v)},p=function(){if(d){if(b)$(document.body).off("mousedown",J),b.detach(),b=null;else{var O=$(document.body),v=b=$("<div>"),A=$("<div>");A.addClass("sa-ctrl-common-border");A.appendTo(v);b.addClass("sa-qing-publish-dropdown-selector");
t=c.getDropDownContent(!1);t.appendTo(b);c.showRefreshBtn()&&(v=$("<div>"),v.addClass("sa-qing-publish-menuRefresh"),m.MyIcons.background(v,"refresh"),v.on("click",Q),v.attr("title",h.get("refreshMenu","\u5237\u65b0\u5e94\u7528\u83dc\u5355")),v.appendTo(b),b.css("border","1px solid rgba(138, 153, 170, 0.4)"));var K=c.getPopupHeight();b.css("z-index",999999);b.appendTo(O);var xa=O.prop("clientHeight"),fa=l.outerHeight();v=l.outerWidth();var da=[0,fa-1];da=ja.upwardCoordinate(l[0],da,O[0]);A=da[0];
var B=da[1];K=0>K?Math.max(0,(xa>>1)-fa):K;B+K>xa&&(da=[0,0],da=ja.upwardCoordinate(l[0],da,O[0]),O=da[1]-K+1,0<=O&&(B=O));ja.layoutCtrl(b,A,B,v,K);$(document.body).on("mousedown",J)}z(!1)}},Q=function(){t&&(t.remove(),t=c.getDropDownContent(!0),t.appendTo(b))},J=function(O){for(var v=$(document.body),A=$(O.target);A[0]!=v[0];){if(A[0]==l[0])return;A=A.parent()}for(A=$(O.target);A[0]!=v[0];){if(A[0]==b[0])return;A=A.parent()}p()},U=function(){a&&setTimeout(function(){a.css("display",g.val()?"none":
"")},0)};this.protectedMethod={updateText:function(O){y();g.val(O?O:"");O&&g.attr("title",O);"placeholder"in g[0]||U()},doDropdown:p}}function ba(c,l){var g=this,k,b,a,d,t,y,z=c,p,Q,J;this.getJqUi=function(){k||K();return k};this.getModel=function(){return z};this.setModel=function(B){z=B;da()};this.setItemClickListener=function(B){Q=B};var U=function(){d&&l&&d.show()},O=function(){d&&d.hide()},v;this.addDeleteOperate=function(B,D){d||(d=$("<div class='sa-qing-publish-manager-dir-op'>"),d.appendTo(k));
t=$("<span>");t.addClass("sa-qing-publish-manager-dir-op-item");m.MyIcons.background(t,B);t.on("click",function(T){clearTimeout(v);T.stopPropagation();v=setTimeout(function(){O();D(g)},300)});t.appendTo(d)};this.addEditOperate=function(B,D){d||(d=$("<div class='sa-qing-publish-manager-dir-op'>"),d.appendTo(k));y=$("<span>");y.addClass("sa-qing-publish-manager-dir-op-item");m.MyIcons.background(y,B);y.on("click",function(T){clearTimeout(v);T.stopPropagation();v=setTimeout(function(){O();D(g)},300)});
y.appendTo(d)};var A=function(B){clearTimeout(v);B&&B.stopPropagation();v=setTimeout(function(){g.setSelected(!0)},300)},K=function(){k=$("<div>");k.addClass("sa-qing-publish-manager-dir-item");k.on("click",A);k.on("mousemove",function(D){D.stopPropagation()});if(z&&z.isPreset())xa();else{k.on("mouseover",U);k.on("mouseout",O);a=new Ba;var B=a.getJqUi();B.addClass("sa-qing-publish-manager-dir-item-name-edit");B.hide();a.setEnabled(!0);a.addBlurListener(function(){var D=a.getText();D&&(D=D.trim(),
a.setText(D),B.attr("title",D));J(g,D,fa)});B.on("keydown",function(D){if(13==(D.keyCode||D.which||D.charCode)){if(D=a.getText())D=D.trim(),a.setText(D),B.attr("title",D);J(g,D,fa)}});B.appendTo(k)}b=$("<span>");b.addClass("sa-qing-publish-manager-dir-item-name");z&&z.isPreset()&&b.css("margin-left","8px");b.appendTo(k);da()};this.setFinishEditCallback=function(B){J=B};var xa=function(){var B=$("<div>");B.text(h.get("preset","\u9884\u7f6e"));B.addClass("sa-qing-publish-manager-menuPanel-preset-tag");
B.appendTo(k)},fa=function(){k.on("click",A);b.show();a.getJqUi().hide()};this.edit=function(){k.off("click");b.hide();var B=a.getJqUi();B.show();var D=z?z.getText():"";a.setText(D);B.attr("title",D);a.requestFocus()};this.setSelected=function(B){p=B;da()};var da=function(){var B=z?z.getText():"";b&&b.text(B);b&&b.attr("title",B);p?(k.addClass("sa-qing-publish-manager-dir-item-name-selected"),B=k.find(".sa-qing-publish-manager-menuPanel-preset-tag"),B.addClass("sa-qing-publish-manager-menuPanel-preset-tag-Selected"),
k.removeClass("sa-qing-publish-manager-dir-item"),Q(g)):(k.removeClass("sa-qing-publish-manager-dir-item-name-selected"),B=k.find(".sa-qing-publish-manager-menuPanel-preset-tag"),B.removeClass("sa-qing-publish-manager-menuPanel-preset-tag-Selected"),k.addClass("sa-qing-publish-manager-dir-item"))}}function ia(c,l){this.getTypeName=function(){return c};this.getTypeId=function(){return l}}function La(){var c;this.setSyncSearchingUI=function(l){c=l};this.getTailBlankForDragging=function(){return 0};
this.isRowDraggable=function(l,g){return!1};this.isColumnDraggable=function(l,g){return 0===g?!1:!0};this.getMinRowHeightLimited=function(l,g){return 3};this.getMinColumnWidthLimited=function(l,g){return 4};this.rowDraggedAction=function(l,g,k){var b=l.isSyncUIWhenModelChanged();l.setSyncUIWhenModelChanged(!0);g=l.getRow(g);g.setHeight(g.getHeight()+k);l.setSyncUIWhenModelChanged(b)};this.setMinColumnWidth=function(l){};this.columnDraggedAction=function(l,g,k){var b=l.isSyncUIWhenModelChanged();l.setSyncUIWhenModelChanged(!0);
g=l.getColumn(g);g.setWidth(g.getWidth()+k);l.setSyncUIWhenModelChanged(b);c&&c()}}function Wa(){function c(D){var T,la,oa,ra,qa;this.showDeletePrompt=function(Ka){Ka?(la.css({"margin-left":"17px"}),qa.show()):(la.css({"margin-left":"0px"}),qa.hide())};this.setContent=function(Ka){la.attr("title",Ka);qa.attr("title",Ka);ra.addClass("sa-publish-detail-desc-item-head-name");var H=251-oa.width()-2;la.text(Ka);ra.css("width",H+"px")};this.getJqUi=function(){if(!T){var Ka=$("<div>");oa=$("<span class='sa-qing-publish-detail-message-title'>");
oa.attr("title",D);oa.text(D);ra=$("<div>");qa=za.createWarning();ja.layoutCtrl(qa,62,2);la=$("<span>");la.attr("title","");la.text("");qa.appendTo(ra);la.appendTo(ra);oa.appendTo(Ka);ra.appendTo(Ka);qa.hide();T=Ka}return T}}var l,g,k,b,a,d,t,y,z,p,Q,J=!1,U,O,v,A,K={1:h.get("moduleLonger","\u6570\u636e\u5206\u6790"),2:h.get("moduleSquare","\u6570\u636e\u6597\u65b9"),3:h.get("dashboard","\u4eea\u8868\u677f")},xa={dashboard:h.get("dashboard","\u4eea\u8868\u677f"),subject:h.get("moduleSquare","\u6570\u636e\u6597\u65b9"),
bill:h.get("moduleSquare","\u6570\u636e\u6597\u65b9")},fa={dashboard:h.get("dashboard","\u4eea\u8868\u677f"),subject:h.get("moduleLonger","\u6570\u636e\u5206\u6790"),extreport:h.get("qReport","\u62a5\u8868"),bill:h.get("moduleLonger","\u6570\u636e\u5206\u6790")};this.setTabType=function(D){Q=D};this.setIsCardSelector=function(D){J=D};this.setLappMapIdCardModelDetail=function(D){v=D};this.setCardImgUrlCreator=function(D){};this.setProfile=function(D,T){(new X).setFormatString("yyyy-MM-dd HH:mm:ss");
l.text(D.getName());l.attr("title",D.getName());k.setContent(D.getName());switch(Q){case Sa.APPMENU:a.setContent(fa[D.getPublishSourceType()]);var la=B(D.getPublishSourceType(),D.getPublishSourceGroupName(),D.getPublishSourceName());break;case Sa.CENTER:a.setContent(fa[D.getPublishSourceType()]);la=B(D.getPublishSourceType(),D.getPublishSourceGroupName(),D.getPublishSourceName());break;case Sa.LAPP:a.setContent(K[D.getViewType()]);b.attr("src",T);la=D.getCardDesc();y.setContent(la?la:h.get("noDescription",
"\u6682\u65e0\u63cf\u8ff0"));T=D.getViewType();la=D.getPublishSourceName();var oa={1:"subject",2:"subject",3:"dashboard"},ra={1:h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664"),2:h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664"),3:h.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u5220\u9664")};la?(d.showDeletePrompt(!1),T=oa[T],v[D.getPublishId()]&&(T=v[D.getPublishId()].getPublishSourceGroupName()),la=T+"/"+la):(d.showDeletePrompt(!0),
la=ra[T]);break;case Sa.CARD:a&&a.setContent(xa[D.getPublishSourceType()]),b.attr("src",T),la=D.getCardDesc(),y.setContent(la?la:h.get("noDescription","\u6682\u65e0\u63cf\u8ff0")),la=B(D.getPublishSourceType(),D.getPublishSourceGroupName(),D.getPublishSourceName()),O&&O.setContent(D.getPathText())}if(D.isPreset())T=D.getRoles(),oa=D.getUsers(),T=0==T.length&&0==oa.length?h.get("permissionNoRoleAndUserText","\u672a\u9009\u62e9\u89d2\u8272\u6216\u7528\u6237"):0!=T.length&&0!=oa.length?h.get("roleAndUserNames",
"\u89d2\u8272\uff1a#1\uff0c\u7528\u6237\uff1a#2").replace("#1",da(T)).replace("#2",da(oa)):0!=T.length?h.get("roleNames","\u89d2\u8272\uff1a#1").replace("#1",da(T)):h.get("userNames","\u7528\u6237\uff1a#1").replace("#1",da(oa));else{T=D.getRoles();oa=D.getUsers();ra=D.getPermLabels();var qa="",Ka=h.get("comma","\u3001");T&&0<T.length&&(qa+=h.get("permissionRolesText","\u89d2\u8272#1\u4e2a").replace("#1",T.length)+Ka);oa&&0<oa.length&&(qa+=h.get("permissionUsersText","\u7528\u6237#1\u4e2a").replace("#1",
oa.length)+Ka);ra&&0<ra.length&&(qa+=h.get("permLabelCount","\u6743\u9650\u6807\u7b7e#1\u4e2a").replace("#1",ra.length)+Ka);T=qa=0<qa.length?qa.slice(0,-1):h.get("noAuthTarget","\u672a\u9009\u62e9\u6388\u6743\u76ee\u6807")}d&&d.setContent(la);t&&t.setContent(T);p&&p.setContent(D.getCarryData()?h.get("yes","\u4e0d\u518d\u66f4\u65b0\u6570\u636e"):h.get("no","\u66f4\u65b0\u6570\u636e"));z.setContent(D.getCreateFormatTime());A.setContent(D.getUpdateFormatTime());U&&U.setContent(D.isPreset()?h.get("systemPreset",
"\u7cfb\u7edf\u9884\u7f6e"):D.getModifierName())};this.getJqUi=function(){if(!g){var D=$("<div>"),T=$("<div class='sa-publish-item'>"),la=$("<div class='sa-publish-item-head'>");l=$("<div class='sa-publish-item-head-name sa-qing-publish-fontfamily'>");l.css("width","200px");l.text("");l.appendTo(la);b=$("<img class='sa-publish-item-img'>");b.attr("src",null);la.appendTo(T);b.appendTo(T);T.appendTo(D);var oa=$("<div>"),ra=7;k=new c(h.get("detailPublishName","\u53d1\u5e03\u540d\u79f0\uff1a "));var qa=
k.getJqUi();ja.layoutCtrl(qa,10,ra,251,18);qa.appendTo(oa);ra+=23;U=new c(h.get("creatorName","\u53d1\u5e03\u4eba\uff1a "));qa=U.getJqUi();ja.layoutCtrl(qa,10,ra,251,18);qa.appendTo(oa);J?(ra+=23,O=new c(h.get("PublishContent","\u53d1\u5e03\u76ee\u5f55\uff1a ")),qa=O.getJqUi(),ja.layoutCtrl(qa,10,ra,251,18),qa.appendTo(oa)):(ra+=23,a=new c(h.get("detailPublishType","\u7c7b\u578b\uff1a ")),qa=a.getJqUi(),ja.layoutCtrl(qa,10,ra,251,18),qa.appendTo(oa),ra+=23,d=new c(h.get("detailPublishSource","\u53d1\u5e03\u6765\u6e90\uff1a ")),
qa=d.getJqUi(),ja.layoutCtrl(qa,10,ra,251,18),qa.appendTo(oa),ra+=23,t=new c(h.get("detailPermission","\u6388\u6743\uff1a ")),qa=t.getJqUi(),ja.layoutCtrl(qa,10,ra,251,18),qa.appendTo(oa),ra+=23,p=new c(h.get("detailCarryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e\uff1a ")),qa=p.getJqUi(),ja.layoutCtrl(qa,10,ra,251,18),qa.appendTo(oa));ra+=23;z=new c(h.get("detailPublishTime","\u53d1\u5e03\u65f6\u95f4\uff1a "));qa=z.getJqUi();ja.layoutCtrl(qa,10,ra,251,18);qa.appendTo(oa);ra+=23;A=new c(h.get("editPublishTime",
"\u53d1\u5e03\u4fe1\u606f\u4fee\u6539\u65f6\u95f4\uff1a"));qa=A.getJqUi();ja.layoutCtrl(qa,10,ra,251,18);qa.appendTo(oa);ra+=23;y=new c(h.get("detailDescription","\u63cf\u8ff0\uff1a "));qa=y.getJqUi();ja.layoutCtrl(qa,10,ra,251,18);qa.appendTo(oa);oa.appendTo(D);oa.css({position:"relative",top:"186px","line-height":"20px",color:"#666666"});if(Q==Sa.APPMENU||Q==Sa.CENTER)qa.remove(),la.remove(),b.remove(),T.removeClass("sa-publish-item"),oa.css({position:"relative",top:"18px","line-height":"18px"});
T.css({"float":"right",right:"3px"});g=D}return g};var da=function(D){for(var T="",la=0;la<D.length;la++)T=0==la?T+D[la].getText():T+(","+D[la].getText());return T},B=function(D,T,la){var oa="";la?(d&&d.showDeletePrompt(!1),oa=T+"/"+la):(d&&d.showDeletePrompt(!0),D==bb.SUBJECT?oa=h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664"):D==bb.DASHBOARD?oa=h.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u88ab\u5220\u9664"):D==bb.EXTREPORT&&(oa+=h.get("extReportDeleted",
"\u8be5\u8f7b\u62a5\u8868\u5df2\u88ab\u5220\u9664")));return oa}}function ob(c,l,g){var k=this,b,a,d;this.setOuterMessageCurtain=function(Q){d=Q};this.setIsDashboardPublish=function(Q){a=Q};this.setRemoteImpl=function(Q){b=Q};this.getRemoteImpl=function(){return b};this.show=function(Q,J){var U=Q.data("jqContainer");U||(U=p(Q,J),Q.data("jqContainer",U));(J=Q.attr("showContainer"))&&"1"==J?y(U):(U.show(),k.adjustContainerPosition(U),Q.attr("showContainer",1),$(document.body).on("mousedown",z),$(document.body).on("mousewheel",
t))};this.hide=function(){for(var Q=c.find(".sa-qing-publish-manager-editcontent-selector"),J=0;J<Q.length;J++){var U=$(Q[J]);y(U)}};var t=function(){for(var Q=c.find(".sa-qing-publish-manager-editcontent-selector"),J=0;J<Q.length;J++){var U=$(Q[J]);y(U)}},y=function(Q){Q.hide();Q.data("jqEditBtn").attr("showContainer",0);$(document.body).off("mousedown",z);$(document.body).off("mousewheel",t)},z=function(Q){for(var J=c.find(".sa-qing-publish-manager-editcontent-selector"),U=0;U<J.length;U++){var O=
$(J[U]),v=O.data("jqEditBtn");O.is(":visible")&&(ja.isDescendent(Q.target,O[0])||ja.isDescendent(Q.target,v[0]))||y(O)}};this.adjustContainerPosition=function(Q){var J=Q.data("jqEditBtn");var U=J.position().left;var O=parseInt(J.css("marginLeft"));isNaN(O)||(U+=O);var v=J.position().top;O=parseInt(J.css("marginTop"));isNaN(O)||(v+=O);for(var A=$(J.parent());!A.is(c);)U+=A.position().left,U+=A.scrollLeft(),O=parseInt(A.css("marginLeft")),isNaN(O)||(U+=O),v+=A.position().top,O=parseInt(A.css("marginTop")),
isNaN(O)||(v+=O),A=$(A.parent());U=U+J.width()-Q.width()+5;v+=J.height();A=Q.height();v+A>=c.height()&&(v=v-J.height()-A);Q.css({left:U+"px",top:v+"px"})};var p=function(Q,J){var U=l.length,O=26*U,v=$("<div class='sa-qing-publish-manager-editcontent-selector'>");v.css({position:"absolute",height:O+"px",width:"110px"});v.data("jqEditBtn",Q);for(Q=0;Q<U;Q++){O=l[Q];var A=$("<div class='sa-qing-publish-manager-editcontent-selector-item'>");A.css({top:26*Q+"px",height:"26px","line-height":"26px",overflow:"hidden",
"text-overflow":"ellipsis","white-space":"nowrap"});A.attr("title",O);A.attr("operateIdx",Q);A.text(O);A.on("click",function(K){K.stopPropagation();y(v);$(K.currentTarget).attr("title")==h.get("editPublishContentItem","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848")&&a&&J.getCarryData()?d.showPrompt(h.get("dsbPublishedCannotEditScheme",'\u5f53\u524d\u53d1\u5e03\u8bb0\u5f55\u5df2\u5f00\u542f"\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"\uff0c\u65e0\u6cd5\u7f16\u8f91\u53d1\u5e03\u65b9\u6848\u3002')):(K=
$(K.currentTarget).attr("operateIdx"),g[K](J))});A.appendTo(v)}v.appendTo(c);return v}}function zb(c,l,g){V.call(this);var k=this,b,a,d,t,y,z,p,Q=l,J=!1,U,O,v,A,K=!0,xa="BORDER",fa;this.setAlwaysShowSelectBtn=function(oa,ra){K=oa;v&&ra&&(K?v.show():v.hide())};this.getPublishModel=function(){return c};this.setHideCardTypePic=function(oa){A=oa};this.setSelected=function(oa){J=oa;O&&O.setChecked(J)};this.setPublishManager=function(oa){U=oa};this.getJqUi=function(){if(!b){b=$("<div class='sa-publish-item'>");
b.on("mouseenter",da);b.on("mouseleave",B);b.on("click",D);var oa=$("<div class='sa-publish-item-head'>");if(c.isPreset()){var ra=$("<div>");ra.text(h.get("preset","\u9884\u7f6e"));ra.addClass("sa-qing-publish-manager-card-name-preset-tag");ra.appendTo(oa)}"dashboard"==c.getPublishSourceType()?(ra=$("<div>"),m.MyIcons.background(ra,"dashboard"),ra.addClass("sa-qing-publish-manager-card-pic-type"),ra.appendTo(oa)):"subject"!=A&&(ra=$("<div>"),m.MyIcons.background(ra,"squareData"),ra.addClass("sa-qing-publish-manager-card-pic-type"),
ra.appendTo(oa));a=$("<div class='sa-publish-item-head-name sa-qing-publish-fontfamily'>");a.appendTo(oa);y=$("<div class='sa-publish-item-head-op-container'>");y.appendTo(oa);oa.appendTo(b);z=$("<img class='sa-publish-item-img'>");Q||(Q=I.getIconUrl("publish","icon_chart_building.png"));z.attr("src",Q);z.appendTo(b);t=$("<div class='sa-publish-item-desc-container'>");d=$("<div class='sa-publish-item-desc-text sa-qing-publish-fontfamily'>");d.appendTo(t);t.appendTo(b);v&&v.appendTo(b);B()}k.updateUi();
return b};this.updateUi=function(){a&&(a.text(c.getName()),a.attr("title",c.getName()));z&&z.attr("src",c.getShowImagePath());if(d){var oa=c.getCardDesc();oa&&0!=oa.length||(oa=h.get("noDescFornow","\u6682\u65e0\u63cf\u8ff0"));var ra=h.get("descriptionColons","\u63cf\u8ff0\uff1a")+oa,qa=c.getPublishSourceType(),Ka=c.getPublishSourceName();oa=$("<div>");var H=$("<span>"),M=$("<span>");M.text(h.get("publishSourceColons","\u53d1\u5e03\u6765\u6e90\uff1a"));M.appendTo(oa);Ka?H.text(c.getPublishSourceGroupName()+
"/"+Ka):(Ka=za.createWarning(),ja.layoutCtrl(Ka,0,8),Ka.appendTo(oa),qa==bb.SUBJECT?H.text(h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664")):qa==bb.DASHBOARD?H.text(h.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u88ab\u5220\u9664")):qa==bb.EXTREPORT&&H.text(h.get("extReportDeleted","\u8be5\u62a5\u8868\u5df2\u88ab\u5220\u9664")));H.appendTo(oa);d.text(ra);if(U){H=h.get("permissionColons","\u6388\u6743\uff1a");if(c.isPreset())ra=H,qa=c.getRoles(),H=c.getUsers(),
qa=0==qa.length&&0==H.length?h.get("permissionNoRoleAndUserText","\u672a\u9009\u62e9\u89d2\u8272\u6216\u7528\u6237"):0!=qa.length&&0!=H.length?h.get("roleAndUserNames","\u89d2\u8272\uff1a#1\uff0c\u7528\u6237\uff1a#2").replace("#1",T(qa)).replace("#2",T(H)):0!=qa.length?h.get("roleNames","\u89d2\u8272\uff1a#1").replace("#1",T(qa)):h.get("userNames","\u7528\u6237\uff1a#1").replace("#1",T(H)),H=ra+qa;else{ra=H;qa=c.getRoles();H=c.getUsers();Ka=c.getPermLabels();M="";var ma=h.get("comma","\u3001");qa&&
0<qa.length&&(M+=h.get("permissionRolesText","\u89d2\u8272#1\u4e2a").replace("#1",qa.length)+ma);H&&0<H.length&&(M+=h.get("permissionUsersText","\u7528\u6237#1\u4e2a").replace("#1",H.length)+ma);Ka&&0<Ka.length&&(M+=h.get("permLabelCount","\u6743\u9650\u6807\u7b7e#1\u4e2a").replace("#1",Ka.length)+ma);M=0<M.length?M.slice(0,-1):h.get("noAuthTarget","\u672a\u9009\u62e9\u6388\u6743\u76ee\u6807");H=ra+M}ra=h.get("isCarryDataColons","\u662f\u5426\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e\uff1a")+
(c.getCarryData()?h.get("yes","\u4e0d\u518d\u66f4\u65b0\u6570\u636e"):h.get("no","\u66f4\u65b0\u6570\u636e"));qa=$("<div>");qa.text(H);H=$("<div>");H.text(ra);d.append(oa);d.append(qa);d.append(H)}}};this.refreshImage=function(oa){oa&&z.attr("src",oa)};var da=function(){t.show();c.isPreset()||y.find(".sa-publish-item-head-op-item").show();v&&v.show()},B=function(){t.hide();c.isPreset()||y.find(".sa-publish-item-head-op-item").hide();la&&la.hide();K||v&&v.hide()},D=function(oa){O&&(fa=!0,oa=!O.isChecked(),
O.setChecked(oa),fa=!1)},T=function(oa){for(var ra="",qa=0;qa<oa.length;qa++)ra=0==qa?ra+oa[qa].getText():ra+(","+oa[qa].getText());return ra};this.addOperate=function(oa,ra,qa){p=$("<span>");p.addClass("sa-publish-item-head-op-item sa-publish-item-head-op-layout");p.attr("title",ra);m.MyIcons.background(p,oa);p.on("click",function(Ka){Ka.stopPropagation();B();qa()});p.hide();p.appendTo(y)};this.getSelector=function(){return O};var la;this.addOperates=function(oa,ra,qa,Ka){var H=Ka.length;1==H?k.addOperate(oa,
qa[0],Ka[0]):1<H&&(p=$("<span>"),p.addClass("sa-publish-item-head-op-item sa-publish-item-head-op-layout"),p.attr("title",ra),m.MyIcons.background(p,oa),p.hide(),p.appendTo(y),la=new ob(b,qa,Ka),la.setOuterMessageCurtain(g),"dashboard"==c.getPublishSourceType()&&la.setIsDashboardPublish(!0),p.on("click",function(M){M.stopPropagation();la.show($(M.currentTarget),c)}))};this.addSelectButton=function(oa,ra){v&&v.remove();xa=ra;O=xa==zb.SINGLE_SELECTED_STYLE_SELECTBTN?new w:new n;O.setChecked(J);O.setUserObject(c);
O.addCheckedListener(function(qa,Ka){oa(k,qa,Ka||fa)});v=O.getJqUi();v.on("click",function(qa){qa.stopPropagation()});!K&&v.hide();ja.layoutCtrlWithLRTB(v,null,8,18,11,null,18);b&&v.appendTo(b)}}function sa(c){V.call(this);var l,g,k,b=this,a;this.getPublishModel=function(){return c};this.setSelected=function(y){g=y};this.isSelected=function(){return g};this.setSingleSelected=function(y){a=y};this.getJqUi=function(){l||(l=$("<div>"));return l};this.getSelector=function(){return k};this.addSelectButton=
function(y){a?t(l,y):d(l,y)};var d=function(y,z){var p=new n;p.setChecked(g);k=p;p.setUserObject(c);p.addCheckedListener(function(Q,J){z(b,Q,J)});p=p.getJqUi();p.appendTo(y);p.css("height","0px");p.find(".sa-ctrl-checkbox-box").css({top:"8px"});p.find(".sa-ctrl-checkbox-text").css("height","0px")},t=function(y,z){k&&k.getJqUi().remove();var p=new w;p.setChecked(g);k=p;p.setUserObject(c);p.addCheckedListener(function(Q,J){z(b,Q,J)});p=p.getJqUi();p.appendTo(y);p.find(".sa-ctrl-common-foreground_enabled").css("height",
"0px")}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&(com.kingdee.bos.qing.publish={});"undefined"==typeof com.kingdee.bos.qing.publish.common&&(com.kingdee.bos.qing.publish.common={});var m=com.kingdee.bos.qing.publish.common;m.PushManager=function(c){Z.call(this);var l=this,g=this.protectedMethod,
k,b,a,d,t,y,z,p;(function(){g.setTitle(h.get("pushManagement","\u5b9a\u65f6\u63a8\u9001\u7ba1\u7406"));l.setSize(850,570);g.setSelectable(!0);g.getDialogCtrl().setMinSize(850,570);g.getDialogCtrl().setFullScreenEnabled();g.getDialogCtrl().setResizeEnabled();g.getDialogCtrl().addResizeListener(function(){var U=_oTabContainer.getCurrentTabPane();Q(null,U)});g.setContentPaneCreator(function(){_oTabContainer=new pa;_oTabContainer.setTabLevel(pa.SECOND_LEVEL);_oTabContainer.addTabChangedListener(Q);_oTabContainer.addTabChangedListener(J);
var U=!(p&&p.type&&"-1"!=p.type),O=g.getMessageCurtain();if(k){var v=new k(a,t,d,c);v.setOuterMessageCurtain(O);p&&"-1"==p.type&&(U=!0,v.setAutoSelectedData(p));_oTabContainer.addTab(v,U);U=!1}v=Object.keys(Jb);for(var A=0,K=v.length;A<K;A++){var xa=Jb[v[A]],fa=new b(xa,O,y,z,c);p&&p.type==xa&&(U=!0,fa.setAutoSelectedData(p));_oTabContainer.addTab(fa,U);U=!1}return _oTabContainer.getJqUi()});g.setFooterClosingOnly(!0);g.setClosingChecker2(null,function(U){g.destroy();return!0});g.setClosingAction(function(U){})})();
this.setSelectedData=function(U){p=U};this.registerEmailPushPanelConstructor=function(U){k=U};this.initEmailPushConfig=function(U,O,v){a=U;t=O;d=v};this.registerLappPushPanelConstructor=function(U){b=U};this.initLappPushConfig=function(U,O){y=U;z=O};var Q=function(U,O){O&&O.relayoutViews()},J=function(U,O){null==p&&O&&O.setAutoSelectedData(null)}};m.PublishManagerDialog=function(c,l,g,k,b){Z.call(this);var a=this,d=this.protectedMethod,t,y;(function(){d.setTitle(h.get("publishManage","\u53d1\u5e03\u7ba1\u7406"));
a.setSize(810,570);d.setSelectable(!0);d.getDialogCtrl().setMinSize(810,570);d.getDialogCtrl().setFullScreenEnabled();d.getDialogCtrl().setResizeEnabled();d.getDialogCtrl().addResizeListener(function(){var J=t.getCurrentTabPane();p(null,J)});var Q=[];d.setContentPaneCreator(function(){t=new pa;t.setTabLevel(pa.SECOND_LEVEL);t.addTabChangedListener(p);for(var J=m.PublishFactory.getAllPublishManageTargetType(),U=!(y&&-1!=J.indexOf(y.type)),O=function(){t.setCurrentTabPane(t.getCurrentTabPane())},v=
0,A=J.length;v<A;v++){var K=J[v];k&&(K==E.CARD_REPOSITORY||K==E.MOBILE)||b&&K==E.MOBILE||(K=m.PublishFactory.createPublishManagePanel(c,J[v],b),K.setPublishContext(l),K.setRefreshCurrentPanel(O),K.setOuterMessageCurtain(d.getMessageCurtain()),K.setPublishContentEditEntrance(g),y&&y.type==J[v]&&(U=!0,K.setAutoSelectedData(y)),t.addTab(K,U),Q.push(K.getTitle),U=!1)}J=t.getJqUi();U=J.find(".sa-ctrl-tab-second-head");U.css({"max-width":"100px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"});
for(v=0;v<U.length;v++)$(U[v]).attr("title",Q[v]);return J});d.setFooterClosingOnly(!0);d.setClosingChecker2(null,function(J){d.destroy();z();return!0});d.setClosingAction(function(J){z()})})();var z=function(){com.kingdee.bos.qing.publish.common.PublishSubscribeHelper.clear()},p=function(Q,J){J&&J.relayoutViews()};this.setSelectedData=function(Q){y=Q}};m.SinglePublishManagerDialog=function(c){Z.call(this);var l=this,g=this.protectedMethod,k;(function(){g.setTitle(h.get("publishManage","\u53d1\u5e03\u7ba1\u7406")+
"-"+c.getTitle());l.setSize(850,570);g.setSelectable(!0);g.getDialogCtrl().setMinSize(850,570);g.getDialogCtrl().setFullScreenEnabled();g.getDialogCtrl().setResizeEnabled();g.getDialogCtrl().addResizeListener(function(){c&&c.relayoutViews()});c.setOuterMessageCurtain(g.getMessageCurtain());g.setContentPaneCreator(function(){var b=c.getJqUi();b.css("top","2px");return b});g.setFooterClosingOnly(!0);g.setClosingAction(function(b){com.kingdee.bos.qing.publish.common.PublishSubscribeHelper.clear();k&&
k(c)})})();this.setClosedCallback=function(b){k=b}};m.PublishToDialog=Aa;m.AbstractPublishPanel=nb;m.AbstractPublishToPanel=function(c,l){nb.call(this,c,l);this.setPublishModel=function(g){throw Error("Override me");};this.isEditPublish=function(){throw Error("Override me");};this.setPublishSourceType=function(g){throw Error("Override me");};this.getJqUi=function(){throw Error("Override me");};this.checkUIInput=function(g){throw Error("Override me");};this.getModelFromUI=function(){throw Error("Override me");
};this.getJsonModel=function(){throw Error("Override me");};this.getNewPublishSuccessCallback=function(){return null};this.getUpdatePublishSuccessCallback=function(){return null}};m.AbstractPublishManagerPanel=function(c,l){nb.call(this,c,l);pa.AbstractTabPane.call(this);var g,k,b;this.setAutoSelectedData=function(a){b=a};this.getAutoSelectedData=function(){return b};this.setPathSelectorModel=function(a){throw Error("Override me");};this.relayoutViews=function(){throw Error("Override me");};this.setPublishContext=
function(a){g=a};this.getPublishContext=function(){return g};this.setRefreshCurrentPanel=function(a){k=a};this.refreshCurrentPanel=function(){k&&k()}};m.AnalysisSchemeDialogSelector=function(c,l){com.kingdee.bos.qing.biz.common.AbstractDialogSelector.call(this);var g=this,k,b,a,d=[],t,y=[],z=!1,p=[];this.setSuccessCallBack=function(O){t=O};this.setPublishModel=function(O){a=O};this.getPublishModel=function(){return a};this.setPublishContext=function(O){b=O};this.getPublishContext=function(){return b};
this.setSelectedListener=function(O){};var Q=g.getJqUi;this.getJqUi=function(){k||(k=Q());return k};this.protectedClickEvent=function(){J()};this.setSelectedValue=function(O){d=O;g.updateUI()};this.getSelectedValue=function(){return d};this.getDisplayText=function(){return 0==d.length?h.get("PleaseChoiceOtherPlan","\u8bf7\u9009\u62e9\u9700\u8981\u540c\u65f6\u53d1\u5e03\u7684\u5176\u4ed6\u65b9\u6848"):1==d.length?d[0].getFId()?h.get("selectMultiPlan","\u5df2\u9009\u62e9#1\u4e2a\u65b9\u6848").replace("#1",
d.length):h.get("PleaseChoiceOtherPlan","\u8bf7\u9009\u62e9\u9700\u8981\u540c\u65f6\u53d1\u5e03\u7684\u5176\u4ed6\u65b9\u6848"):h.get("selectMultiPlan","\u5df2\u9009\u62e9#1\u4e2a\u65b9\u6848").replace("#1",d.length)};this.getAllSchemaAttrByFid=function(){var O=a.getId();m.PublishFactory.createPublishFacade(l,c,t,void 0).getSchemaAttrByPublishId(O,a.getPublishSourceType(),0)};var J=function(){if(null==a){var O=b.getDashBoardAnalysis()?b.getSchemaTag():b.getBizTag();var v=b.getCurrentSourceType();
var A=!1;if(0==d.length){var K=b.getCurrentContentModel(),xa=new ea;xa.fromJsonObject(K.schemaAttr);xa.setSchemaType(ea.SCHEMATYPE_USERDEFINED);d.push(xa)}}else O=a.getId(),v=a.getPublishSourceType(),A=!0,0==y.length&&(y=U(a.getSchemaAttrSelected()));m.PublishFactory.createPublishFacade(l,c,function(fa){for(var da=new Gb,B=[],D=0;D<fa.length;D++){var T=new ea;T.fromJsonObject(fa[D]);B.push(T);T.getSchemaType()==ea.SCHEMATYPE_SYSTEM&&(z=!0)}da.show(B,d,function(la){if(0<la.length)return!0;da.warn(h.get("addAnalysisPlan",
"\u81f3\u5c11\u6dfb\u52a0\u4e00\u4e2a\u5206\u6790\u65b9\u6848\u3002"));return!1},function(){null!=a?(d=U(y),a.setSchemaModelSelected(null)):d=U(p);g.setSelectedValue(d)},function(la){p=U(la);for(var oa=!1,ra=0;ra<la.length;ra++)if(la[ra].IsDefault()){oa=!0;break}d=la;!oa&&d[0].setIsDefault(!0);g.setSelectedValue(la);oa=[];var qa=[];for(ra=0;ra<la.length;ra++){var Ka=new Ca,H=la[ra];H.setSchemaType(ea.SCHEMATYPE_SYSTEM);Ka.setSchemaAttr(H);if(!H.getFId()){var M=b.getCurrentContentModel();Ka.setSchemaContent(M.schemaContent)}oa.push(H);
qa.push(Ka)}null!=a?(a.setSchemaAttrSelected(oa),a.setSchemaModelSelected(qa)):b.setChoiceAnalysisSchema(qa)},z)},function(fa,da){}).getAllSchemaAttrs(O,v,0,A)},U=function(O){for(var v=[],A=0;A<O.length;A++){var K=new ea;K.fromJsonObject(JSON.parse(JSON.stringify(O[A].toJsonObject())));v.push(K)}return v}};m.CarrryDataUserDialogSelector=function(c){com.kingdee.bos.qing.biz.common.AbstractDialogSelector.call(this);var l=this,g=[],k=!1,b,a,d,t,y,z,p,Q=160,J=[],U=[],O=h.get("selectedUserLabel","\u5df2\u9009 #1 \u9879");
this.setSelectedListener=function(B){};var v=l.getJqUi;this.getJqUi=function(){b||(b=v(),A(),b.on("mouseover",function(){0<g.length&&a.show()}),b.on("mouseleave",function(){a.hide()}));return b};this.setHeight=function(B){Q=B};this.setSelectedValue=function(B){g=B;l.updateUI()};this.setDataModel=function(B){J=B;U=[];for(var D=[],T=0;T<g.length;T++){for(var la=!1,oa=0;oa<B.length;oa++)if(g[T].getValue()==B[oa].getValue()){la=!0;break}la&&D.push(g[T])}K(J);l.setSelectedValue(D)};this.getSelectedValue=
function(){return g};this.protectedClickEvent=function(){d||xa();(k=!k)?d.css("display","block"):d.css("display","none");document.body.addEventListener("mousedown",fa,!0)};this.getDisplayText=function(){var B=g[0];if(0!=g.length&&B){B=B.getText();var D=h.get("selectMultiUser","\u5df2\u9009\u62e9#1\u7b49#2\u4e2a\u7528\u6237").replace("#2",g.length);var T=h.get("selectSingleUser","\u5df2\u9009\u62e9\u7528\u6237#1");D=1==g.length?T:D;D=D.replace("#1",B)}else D=h.get("selectNoUser","\u5c1a\u672a\u9009\u62e9\u7528\u6237");
O=h.get("selectedUserLabel","\u5df2\u9009 #1 \u9879").replace("#1","<b style='color:red'>"+g.length+" </b>");y&&y.html(O);return D};var A=function(){a=$("<div>");a.css({position:"absolute",height:"18px",width:"18px",right:"25px",bottom:"6px",cursor:"pointer",display:"none"});m.MyIcons.background(a,"btn_delete");a.on("click",function(){var B=pb.createFeedbackDialog();B.setMsgImageType(pb.MSG_CONFIRM);B.setMessage(h.get("confirmClearUser","\u786e\u5b9a\u6e05\u7a7a\u7528\u6237\uff1f"));B.setClosingChecker(function(D){D==
pb.RETURN_OK&&(g=[],U=[],l.setSelectedValue(g),K(J));return!0});B.showDialog()});a.appendTo(b)},K=function(B){if(t){t.find(".sa-qing-publish-carry-user-selector-user-cbox").remove();for(var D=0;D<B.length;D++)if(-1==U.indexOf(B[D].getValue())){var T=B[D];U.push(T.getValue());var la=new n;la.setUserObject(T);la.setText(T.getText());for(var oa=!1,ra=0;ra<g.length;ra++)if(g[ra].getValue()==T.getValue()){oa=!0;break}la.setChecked(oa);la.addCheckedListener(function(qa,Ka){Ka=qa.getUserObject();if(qa.isChecked())g.push(Ka);
else{qa=-1;for(var H=0;H<g.length;H++)if(g[H].getValue()==Ka.getValue()){qa=H;break}g.splice(qa,1)}l.setSelectedValue(g)});T=la.getJqUi();T.addClass("sa-qing-publish-carry-user-selector-user-cbox");T.appendTo(t)}}},xa=function(){d=$("<div>");d.addClass("sa-qing-publish-select-user-ui");var B=$("<div>");B.addClass("sa-qing-publish-search-head-ui");z=new f;z.setSearchListenerDelay(1E3);z.setPlaceholder(h.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));z.addSearchListener(da);z.setAlwaysShowCleanIcon(!0);
var D=z.getJqUi();D.addClass("sa-qing-publish-search-box");D.removeClass("sa-ctrl-common-singlelineborder");var T=$("<div>");T.addClass("sa-qing-publish-select-user-search-icon");T.attr("title",h.get("search","\u641c\u7d22"));m.MyIcons.background(T,"icon_search");T.appendTo(B);D.appendTo(B);B.appendTo(d);t=$("<div>");t.addClass("sa-qing-publish-select-user-middle");K(J);t.appendTo(d);B=$("<div>");B.addClass("sa-qing-publish-select-user-bottom-ui");y=$("<div>");O=O.replace("#1","<b style='color:red'>"+
g.length+" </b>");y.html(O);y.appendTo(B);D=$("<div>");D.text(h.get("clearBtn","\u6e05\u7a7a"));D.addClass("sa-qing-publish-select-user-clear-btn");D.on("click",function(la){g=[];U=[];l.setSelectedValue(g);K(J)});D.appendTo(B);p=new Ja(h.get("confirm","\u786e\u5b9a"));p.setHighlight(!0);T=p.getJqUi();T.addClass("sa-qing-publish-select-user-ok-btn");T.appendTo(B);p.addActionListener(function(la){k=!k;d.css("display","none")});B.appendTo(d);d.appendTo(c);ja.layoutCtrl(y,10,5,60,16);ja.layoutCtrl(D,
70,5,30,16);ja.layoutCtrl(T,180,5,30,16);ja.layoutCtrl(d,10,0,300,Q);document.body.addEventListener("mousedown",fa,!0)},fa=function(B){for(B=B.target;B!=document.body;){if(B==d[0]||B==b[0])return;B=B.parentNode}k=!k;d.css("display","none");document.body.removeEventListener("mousedown",fa,!0)},da=function(){if(z){for(var B=z.getText().trim(),D=[],T=0;T<J.length;T++)-1!=J[T].getText().indexOf(B)&&D.push(J[T]);U=[];K(D)}}};m.AdvanceSetPanel=Db;m.DsbAdvanceSetPanel=Ib;m.AbstractDropDownContentSelector=
db;m.ListItemSelector=function(){db.call(this);var c=this,l=this.protectedMethod,g,k=[],b,a=[];this.setListItem=function(p){k=p;g&&d()};this.getListItem=function(){return k};this.setSelectedByItemValue=function(p){for(var Q,J=0;J<k.length;J++)k[J].getValue()==p&&(Q=k[J]);Q&&c.setSelectedValue(Q)};this.setSelectedValue=function(p){b=p;l.updateText(b?b.getText():"");g&&d()};this.getSelectedValue=function(){return b};this.addSelectedChangedListener=function(p){a.push(p)};var d=function(){g.setItemModels(k);
g.setSelecteds(b?[b]:[])},t=function(){g||(g=new Xa,g.setCustomItemPainter(y),d(),g.addSelectedChangedListener(function(p,Q,J){p=b;J=0<J.length?J[0]:null;l.doDropdown();b=J;l.updateText(b?b.getText():"");for(Q=0;Q<a.length;Q++)(0,a[Q])(c,p,J)}))},y=function(p,Q){p.addClass("sa-qing-publish-dropdown-selector-list-item");p.text(Q.getText());p.attr("title",Q.getText())};this.getDropDownContent=function(p){g||t();return g.getJqUi()};var z=200;this.setMaxHeight=function(p){z=p};this.getPopupHeight=function(){return null==
k||0==k.length?22:Math.min(30*k.length+2,z+2)}};m.MenuPanel=function(){var c=this,l,g,k,b;this.setOuterMessageCurtain=function(M){b=M};var a=!0,d,t,y,z=!1,p=!1,Q,J,U,O,v,A,K,xa;this.getJqUi=function(){k||(k=$("<div>"),g=$("<div>"),a&&B(g),l=$("<div>"),l.addClass("sa-qing-publish-manager-dir-editor-container"),z&&l.css("top","0px"),c.updateUI(),g.appendTo(k),l.appendTo(k));return k};this.setIsCardSelector=function(M,ma){z=M};this.setEditable=function(M){a=M};this.setModel=function(M){U=M};this.setEmptyMenudHint=
function(M){Q=M};this.setDefaultItemValue=function(M){J=M};this.getLastSelectedItem=function(){return fa};this.setLastSelectedItem=function(M){fa=M};this.setSelectedItemListener=function(M){O=M};this.setLoadItemListener=function(M){v=M};this.setAddItemListener=function(M){A=M};this.setUpdateItemListener=function(M){xa=M};this.setDeleteItemListener=function(M){K=M};var fa;this.getSelectedModel=function(){return fa?fa.getModel():null};var da=function(){if(Q){var M=$("<div class='sa-qing-publish-manager-dir-empty'>"),
ma=$("<span>");ma.text(Q);ma.appendTo(M);M.appendTo(l)}},B=function(M){var ma=$("<div>");ma.addClass("sa-qing-publish-manager-dir-item-newDir");var Oa=$("<span>");Oa.addClass("sa-qing-publish-manager-newDir-item-name");Oa.text(h.get("Dir","\u76ee\u5f55"));Oa.appendTo(ma);d=$("<div>");d.addClass("sa-qing-publish-manager-newDir-item-add");m.MyIcons.background(d,"add");d.on("mouseover",function(Ha){m.MyIcons.background(d,"add_on")});d.on("mouseout",function(Ha){m.MyIcons.background(d,"add")});d.on("click",
function(){var Ha=new ba(null,!0),ya=Ha.getJqUi();Ha.setFinishEditCallback(qa);ya.appendTo(l);Ha.edit()});d.attr("title",h.get("newDir","\u65b0\u589e\u76ee\u5f55"));d.appendTo(ma);t=$("<div>");t.addClass("sa-qing-publish-manager-dir-operator-edit");t.on("click",function(){fa.edit();fa.setFinishEditCallback(Ka)});m.MyIcons.background(t,"btn_edit");t.on("mouseover",function(Ha){m.MyIcons.background(t,"btn_edit_on")});t.on("mouseout",function(Ha){m.MyIcons.background(t,"btn_edit")});t.attr("title",h.get("editDir",
"\u7f16\u8f91\u76ee\u5f55"));t.appendTo(ma);y=$("<div>");y.addClass("sa-qing-publish-manager-dir-operator-del");y.on("click",function(){var Ha=c.getSelectedModel();if(Ha){var ya=new pb;ya.setOptionType(pb.OPTION_OK_CANCEL);var ab=h.get("confirmToDelDir","\u786e\u5b9a\u5220\u9664\u8be5\u76ee\u5f55\uff1f");ya.setMessage(ab);ya.setClosingChecker(function(Ya){Ya==pb.RETURN_OK&&K(Ha.getValue(),function(){var $a=fa.getJqUi();if(fa){var tb=$a.next();tb&&0!=tb.length||(tb=$a.prev());$a.remove();tb&&tb.prev()&&
0!=tb.prev().length&&tb.click()}else $a.remove();H(Ha)});return!0});ya.showDialog()}else oMenuItemPanel.getJqUi().remove()});m.MyIcons.background(y,"btn_delete");y.on("mouseover",function(Ha){m.MyIcons.background(y,"btn_delete_on")});y.on("mouseout",function(Ha){m.MyIcons.background(y,"btn_delete")});y.attr("title",h.get("deleteDir","\u5220\u9664\u76ee\u5f55"));y.appendTo(ma);ma.appendTo(M)};this.updateUI=function(){p=!1;l.empty();if(U)if(0<U.length){for(var M,ma=D(),Oa,Ha=0;Ha<U.length;Ha++){var ya=
U[Ha],ab=new ba(ya,!0),Ya=ab.getJqUi();ab.setItemClickListener(ra);a&&J!=ya.getValue()&&ab.setFinishEditCallback(Ka);0==Ha&&(Oa=ab);if(!z||ya.getIsShow())ab.setSelected(Ha==ma),Ya.appendTo(l),Ha==ma&&(M=Ya)}!M&&Oa.setSelected(!0);z&&la();T(M)}else a||da();else v(function($a){U=$a;c.updateUI()})};var D=function(){var M=z?1:0;fa&&(J=fa.getModel().getValue());for(var ma=0;ma<U.length;ma++){var Oa=U[ma];if(!J&&z&&0<ma)if(Oa.getIsShow())break;else M+=1;if(J&&(J==Oa.getText()||J==Oa.getValue())){M=ma;break}}return M},
T=function(M){if(l&&M){var ma=l.prop("clientHeight"),Oa=l.prop("scrollTop"),Ha=Oa+ma,ya=M.prop("offsetTop");M=ya+M.prop("offsetHeight");ya<Oa?l.prop("scrollTop",ya-10):M>Ha&&l.prop("scrollTop",M-ma+10)}},la=function(){for(var M=l.find(".sa-qing-publish-manager-dir-item-name"),ma=1;ma<M.length;ma++)$(M[ma]).css("margin-left","30px");M=l.find(".sa-qing-publish-manager-menuPanel-preset-tag");for(ma=0;ma<M.length;ma++)$(M[ma]).css({"margin-left":"30px","margin-right":"-25px"})};this.updateSearchUI=function(M,
ma){p=!0;l.empty();if(M)if(0<M.length){for(var Oa,Ha=!1,ya=0;ya<M.length;ya++){var ab=M[ya];if(!z||ab.getIsShow()){var Ya=new ba(ab,!0);0==ya&&(Oa=Ya);var $a="("+ma[ab.getValue()]+")",tb=Ya.getJqUi();oa(tb,$a,ma[ab.getValue()]);Ya.setItemClickListener(ra);var ha=!fa.getModel().isPreset()&&ab.isPreset()?a?0:1:M.indexOf(fa.getModel());ya==ha&&(Ya.setSelected(!0),Ha=!0);tb.attr("title",ab.getText()+" "+$a);tb.find(".sa-qing-publish-manager-dir-item-name").attr("title",ab.getText()+" "+$a);tb.appendTo(l)}}Ha||
Oa.setSelected(!0);z&&la()}else a||da()};this.updateSelectorSearchUI=function(M,ma){p=!0;l.empty();if(0<M.length){for(var Oa,Ha=!1,ya=0;ya<M.length;ya++){var ab=M[ya];if(!z||ab.getIsShow()){var Ya=new ba(ab,!0);0===ya&&(Oa=Ya);if(ab.isPreset()||"allCard"==ab.getValue())var $a="("+ma[ab.getValue()]+")",tb=ma[ab.getValue()];else $a="("+ma[ab.getText()]+")",tb=ma[ab.getText()];var ha=Ya.getJqUi();oa(ha,$a,tb);Ya.setItemClickListener(ra);ab=fa?fa.getModel().isPreset()!=ab.isPreset()?1:M.indexOf(fa.getModel()):
1;ya==ab&&(Ya.setSelected(!0),Ha=!0);ha.appendTo(l)}}Ha||Oa.setSelected(!0);z&&la()}else a||da()};var oa=function(M,ma,Oa){var Ha=$("<div class='sa-qing-publish-manager-Card-Lapp-Search-Number'>");Ha.text(ma);Ha.title=ma;Ha.appendTo(M);0<Oa&&(Oa=$("<div class='sa-qing-publish-manager-Card-Lapp-Search-Number-with-color'>"),Oa.text(ma),Oa.appendTo(M),Ha.hide(),Oa.show())},ra=function(M){if(fa!=M){fa&&fa.setSelected(!1);if(p){if(fa){var ma=fa.getJqUi(),Oa=ma.find(".sa-qing-publish-manager-Card-Lapp-Search-Number");
0<parseInt(Oa.text().substring(1,Oa.text().length-1))&&(ma.find(".sa-qing-publish-manager-Card-Lapp-Search-Number").hide(),ma.find(".sa-qing-publish-manager-Card-Lapp-Search-Number-with-color").show())}ma=M.getJqUi();ma.find(".sa-qing-publish-manager-Card-Lapp-Search-Number").show();ma.find(".sa-qing-publish-manager-Card-Lapp-Search-Number-with-color").hide()}fa=M;ma=fa.getModel();M=M.getModel();a&&(M.isPreset()?(d.hide(),t.hide(),y.hide()):(d.show(),t.show(),y.show()));O(ma)}},qa=function(M,ma,Oa){ma?
50<ma.length?b.showPrompt(h.get("publishNameTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),2E3):A(ma,M.getJqUi().index(),function(Ha){U.push(Ha);M.setModel(Ha);M.setFinishEditCallback(Ka);M.setItemClickListener(ra);Oa()}):M.getJqUi().remove()},Ka=function(M,ma,Oa){if(ma)if(50<ma.length)b.showPrompt(h.get("publishNameTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),2E3);else{var Ha=M.getModel(),ya=function(ab){Ha.setValue(ab);Ha.setText(ma);M.setModel(Ha);
Oa()};Ha.getText()!=ma?xa(Ha.getValue(),ma,ya):Oa()}else b.showPrompt(h.get("dirNameNotEmpty","\u76ee\u5f55\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002"),2E3)},H=function(M){for(var ma=0;ma<U.length;ma++)M.getValue()==U[ma].getValue()&&U.splice(ma,1),0==U.length&&v(function(Oa){U=Oa;c.updateUI()})}};m.ListPublishContentPanel=function(){function c(e,x){KTDefaultCellRender.call(this,e);var q=this,Fa=this.paintCellUI;this.paintCellUI=function(mb,Za){var jb=q.getCurrentRow(),Bb=q.getCurrentColIdx(),Kb=
q.getCurrentRowIdx(),vb=jb.getUserObject();if(q.getCurrentRowIdx()<Ea.getHeadRowCount())Fa(mb,Za),0==Bb&&1==Kb&&(O=new n,O.addCheckedListener(function(Nb,Ob){if(Ob){K={};Ob=Object.values(v);for(var Pb=0;Pb<Ob.length;Pb++){Ob[Pb].setChecked(Nb.isChecked());var Qb=Ob[Pb].getUserObject();Nb.isChecked()?K[Qb.getId()]=Qb:delete K[Qb.getId()]}A=Nb.isChecked()?fa.length:0;Y()}}),O.setChecked(0<A&&fa&&A==fa.length),Za=O.getJqUi(),Za.addClass("publish-content-tabel-checkbox-cell"),Za.css("top","0px"),Za.appendTo(mb));
else if(0==Bb)Za=new n,Za.addCheckedListener(function(Nb,Ob){Ob&&(Nb.isChecked()?(K[vb.getId()]=vb,A++):(delete K[vb.getId()],A--),O.setChecked(A==fa.length),Y())}),jb=K&&Object.keys(K).includes(vb.getId()),Za.setChecked(jb),Za.setUserObject(vb),v[vb.getId()]=Za,Za=Za.getJqUi(),Za.addClass("publish-content-tabel-checkbox-cell"),Za.appendTo(mb);else if(1==Bb){Za=$("<div class='sa-publish-item-list-head'>");vb.isPreset()&&(jb=$("<div>"),jb.text(h.get("preset","\u9884\u7f6e")),jb.addClass("sa-qing-publish-manager-name-preset-tag"),
jb.appendTo(Za));switch(z){case Sa.APPMENU:"dashboard"==vb.getPublishSourceType()?ta(Za,vb.isPreset()):"extreport"==vb.getPublishSourceType()?Fb(Za,vb.isPreset()):sb(Za,vb.isPreset());break;case Sa.CENTER:"dashboard"==vb.getPublishSourceType()?ta(Za,vb.isPreset()):"extreport"==vb.getPublishSourceType()?Fb(Za,vb.isPreset()):sb(Za,vb.isPreset());break;case Sa.LAPP:"3"==vb.getViewType()?ta(Za,vb.isPreset()):"2"==vb.getViewType()?Ta(Za,vb.isPreset()):"1"==vb.getViewType()&&sb(Za,vb.isPreset());break;
case Sa.CARD:"dashboard"==vb.getPublishSourceType()?ta(Za,vb.isPreset()):Ta(Za,vb.isPreset())}jb=$("<div class='sa-publish-item-list-head-name'>");jb.text(vb.getName());jb.attr("title",vb.getName());jb.appendTo(Za);Za.appendTo(mb)}else if(2==Bb)z==Sa.LAPP?(Bb=vb.getPublishSourceName(),Za=ua(vb.getViewType(),Bb,vb)):(Bb=vb.getPublishSourceGroupName(),Za=ha(vb.getPublishSourceType(),Bb,vb.getPublishSourceName())),jb=$("<span>"),jb.text(Za),jb.attr("title",Za),jb.css("line-height","28px"),jb.css("padding-right",
"8px"),Bb?jb.css("padding-left","8px"):(jb.css("padding-left","17px"),Bb=za.createWarning(),ja.layoutCtrl(Bb,0,8),Bb.attr("title",Za),Bb.appendTo(mb)),$(mb).css("text-overflow","ellipsis"),jb.appendTo(mb);else if(3==Bb)Za=$("<div>"),jb="",vb.isPreset()?(jb=eb(vb.getRoles(),vb.getUsers()),Za.attr("title",jb)):jb=Da(vb.getRoles(),vb.getUsers(),vb.getPermLabels()),Za.text(jb),Za.attr("title",jb),Za.css("line-height","28px"),Za.css("padding-left","8px"),Za.css("padding-right","8px"),Za.css("overflow",
"hidden"),Za.css("text-overflow","ellipsis"),Za.appendTo(mb);else if(4==Bb)Za=$("<div>"),jb=vb.getCreateFormatTime(),Za.text(jb),Za.attr("title",jb),Za.css("line-height","28px"),Za.css("padding-left","8px"),Za.css("padding-right","8px"),Za.css("overflow","hidden"),Za.css("text-overflow","ellipsis"),Za.appendTo(mb);else if(5==Bb&&!vb.isPreset()){z==Sa.LAPP?(Za=[rb,L],jb=[h.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f"),h.get("editPublishContentItem","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848")]):
vb.getPublishSourceType()==bb.EXTREPORT?(Za=[Ra],jb=[h.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f")]):(Za=[Ra,xb],jb=[h.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f"),h.get("editPublishContentItem","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848")]);var Lb=new ob(g,jb,Za);Lb.setOuterMessageCurtain(x);(z==Sa.APPMENU||z==Sa.CENTER||z==Sa.CARD)&&"dashboard"==vb.getPublishSourceType()||z==Sa.LAPP&&"3"==vb.getViewType()?Lb.setIsDashboardPublish(!0):Lb.setIsDashboardPublish(!1);
var Mb=$("<span>");Mb.addClass("sa-qing-publish-manager-op-edit-workButton");Mb.attr("title",h.get("edit","\u7f16\u8f91"));m.MyIcons.background(Mb,"btn_edit");Mb.on("mouseover",function(Nb){m.MyIcons.background(Mb,"btn_edit_on")});Mb.on("mouseout",function(Nb){m.MyIcons.background(Mb,"btn_edit")});Mb.appendTo(mb);Mb.on("click",function(){Lb.setRemoteImpl(Ha);Lb.show(Mb,vb);var Nb=g.find(".sa-qing-publish-manager-editcontent-selector"),Ob=Mb.offset().left-87;Nb.offset({left:Ob})})}};var Ra=function(mb){var Za=
mb.getPath();H(mb,function(jb){if(Za==jb.getPath())mb.fromJsonObject(jb.toJsonObject());else{for(var Bb=0;Bb<fa.length;Bb++){var Kb=fa[Bb];Kb.getId()==jb.getId()&&(fa.splice(Bb,1),ma&&0<ma.length&&(Kb=ma.indexOf(Kb),ma[Kb]=jb))}Oa&&Oa();x.showSuccess(h.get("updateSuccess","\u4fee\u6539\u6210\u529f\u3002"))}tb();ra&&ra()})},rb=function(mb){var Za=mb.getParentId();H(mb,function(jb,Bb){if(Za==jb.getParentId()){mb.setName(jb.getName());mb.setCardDesc(jb.getCardDesc());mb.setBottomAnnotation(jb.getBottomAnnotation());
mb.setViewType(jb.getViewType());mb.setDisplayStyle(jb.getDisplayStyle());var Kb=la[mb.getPublishId()];Kb.setRoles(Bb.getRoles());Kb.setUsers(Bb.getUsers());Kb.setPermLabels(Bb.getPermLabels());mb.setRoles(Bb.getRoles());mb.setUsers(Bb.getUsers());mb.setPermLabels(Bb.getPermLabels());mb.setLandscape(jb.isLandscape());mb.setLargeThumbnail(jb.getLargeThumbnail());tb()}else{Kb=la[mb.getPublishId()];Kb.setRoles(Bb.getRoles());Kb.setUsers(Bb.getUsers());Kb.setPermLabels(Bb.getPermLabels());for(Bb=0;Bb<
fa.length;Bb++)if(fa[Bb].getParentId()==mb.getParentId()){fa.splice(Bb,1);break}ma&&0<ma.length&&(Bb=ma.indexOf(mb),ma[Bb]=jb);tb();ra&&ra()}ra&&ra()})},xb=function(mb){M(mb,function(Za){Ka&&Ka(mb,function(jb){mb.setUpdateTime(jb)})})},L=function(mb){M(mb,function(Za){Ka&&Ka(mb)},E.MOBILE)},ta=function(mb,Za){var jb=$("<div>");m.MyIcons.background(jb,"dashboard");jb.addClass("sa-qing-publish-manager-card-list-type");Za&&jb.css("margin-left","5px");jb.appendTo(mb)},Ta=function(mb,Za){var jb=$("<div>");
m.MyIcons.background(jb,"squareData");jb.addClass("sa-qing-publish-manager-card-list-type");Za&&jb.css("margin-left","5px");jb.appendTo(mb)},sb=function(mb,Za){var jb=$("<div>");m.MyIcons.background(jb,"dataAnalysis");jb.addClass("sa-qing-publish-manager-card-list-type");Za&&jb.css("margin-left","5px");jb.appendTo(mb)},Fb=function(mb,Za){var jb=$("<div>");m.MyIcons.background(jb,"extreportData");jb.addClass("sa-qing-publish-manager-card-list-type");Za&&jb.css("margin-left","5px");jb.appendTo(mb)}}
function l(){KTableSelectionRender.call(this);var e=$("<div>");this.show=function(q,Fa,Ra,rb,xb){ja.layoutCtrl(e,Fa,Ra,rb-Fa,xb-Ra);x();e.css("z-index",0);q.append(e)};this.remove=function(){e.remove()};this.current=function(){x()};this.letOthersOld=function(q){};var x=function(q){e.addClass("sa-common-table-selection");if(q=a.getSelectionModel().getSelected())if(q=q.getRowIdx(),q=a.getRow(q).getUserObject(),z==Sa.CARD){var Fa=qa(q.getImagePath());D.setProfile(q,Fa)}else z==Sa.LAPP?(Fa=qa(q.getLargeThumbnail(),
q.getViewType()),D.setProfile(q,Fa)):D.setProfile(q,null)}}var g,k,b,a,d,t,y,z=Sa.CARD,p=this,Q,J,U,O,v={},A=0,K={},xa=0,fa,da,B,D,T,la,oa,ra,qa,Ka,H,M,ma,Oa,Ha,ya;this.setRemoteImpl=function(e){Ha=e};this.getRemoteImpl=function(){return Ha};this.getSelectedPublish=function(){return Object.values(K)};this.getSelectedPublishMap=function(){return K};this.setSelectedPublishMap=function(e){K=e};this.setPaginationBar=function(e){ya=e};this.getJqUi=function(){if(!g){g=$("<div>");g.addClass("sa-qing-publish-manager-content-container");
k=$("<div>");k.addClass("sa-qing-publish-manager-content-emptytip");k.appendTo(g);a=Ea.createTable();Ea.setupSingleRowSelection(a);a.setSelectionRender(l);B=a.getSelectionModel();var e=new La;e.setSyncSearchingUI(Ya);a.setDraggableAdjusting(!0,3,0,e);a.setColumnFitVisibleWidth(!0);e=new c(a,oa);e.setOutsideVisible(!1);a.setCellRender(e);a.setSyncUIWhenModelChanged(!0);d=$(a.getUI());d.addClass("sa-qing-publish-manager-content-table");d.children().css("overflow-x","hidden");d.appendTo(g);T=$a();T.appendTo(g);
T.hide();b=$("<div>");b.addClass("sa-qing-publish-init-tips");z==Sa.APPMENU&&(m.MyIcons.background(b,"icon_open_tips_background"),k.text(t?t:""));b.appendTo(g);b.show()}return g};this.setOuterMessageCurtain=function(e){oa=e};this.setSearchStatus=function(e){J=e};this.setCardImgUrlCreator=function(e){qa=e};this.updateSearchContentUI=function(e){Q=e;if(J){e=g.find(".sa-publish-item-list-head");for(var x in fa){var q=void 0,Fa=e[x],Ra=fa[x].getName();if(Fa&&Ra&&Q){var rb=Q.toUpperCase(),xb=Ra.toUpperCase(),
L=xb.split(rb),ta=rb.length,Ta=$("<div>");Ta.addClass("sa-publish-item-list-head-name");for(q in L){var sb=xb.indexOf(L[q]),Fb=Ra.substr(0,L[q].length);sb+=L[q].length;var mb=xb.length-sb;xb=xb.substr(sb,mb);Ra=Ra.substr(sb,mb);sb=$("<span>");sb.text(Fb);sb.appendTo(Ta);if(q!==L.length-1&&1<L.length){mb=xb.indexOf(rb);Fb=Ra.substr(mb,ta);mb+=ta;var Za=xb.length-mb;xb=xb.substr(mb,Za);Ra=Ra.substr(mb,Za);mb=$("<span>");mb.text(Fb);mb.css("color","#FF0000");mb.appendTo(sb)}$(Fa).children(".sa-publish-item-list-head-name").remove()}Ta.appendTo($(Fa));
$(Fa).attr("title",Ta.text())}}}};this.relayoutViews=function(){a&&(Ea.refresh(a),a.relayoutViews());ab(U)};this.setEditPublishListener=function(e){H=e};this.setTabType=function(e){z=e};this.setDeletePublishListener=function(e){};this.setEditPublishContentListenter=function(e){M=e};this.setLoadAppMenuContentListener=function(e){Oa=e};this.setLappMapIdCardModelDetail=function(e){la=e};this.setTipsText=function(e){t=e;k&&(k.text(t),b.show(),k.show(),d.hide())};this.setIsPreset=function(e){y=e};this.getIsPreset=
function(){return y};this.setAllPublishModels=function(e){ma=e};var ab=function(e){var x=g.outerWidth();(U=e)?(630>x?(a.setColumnFitVisibleWidth(!0),d&&d.css("width",x+"px"),Ea.refresh(a),a.setColumnFitVisibleWidth(!1)):a.setColumnFitVisibleWidth(!0),d&&d.css("width",x-275+"px")):(a.setColumnFitVisibleWidth(!0),d&&d.css("width",x+"px"));Ea.refresh(a);Ya()};this.setReSearchListener=function(e){ra=e};var Ya=function(){if(B&&B.hasSelected()){var e=B.getSelected();B.removeAllSelecteds();e&&B.addSelected(e);
e=e.getRowIdx()-Ea.getHeadRowCount();a.scrollCellVisible(e,0,!1)}p.updateSearchContentUI(Q,J)};this.setAutoSelectedModel=function(e){da=e};this.setListPublishModel=function(e,x,q){fa=e;y=x;q&&(K={});tb(x)};var $a=function(){var e=$("<div>"),x=$("<div>");m.MyIcons.background(x,"icon-side-open");x.addClass("sa-qing-publish-manager-card-detail-message-open");x.appendTo(e);var q=$("<div>");m.MyIcons.background(q,"icon-side-close");q.addClass("sa-qing-publish-manager-card-detail-message-close");q.css("margin-right",
"261px");q.hide();q.appendTo(e);var Fa=$("<div class='sa-qing-publish-detail-message-panel'>");Fa.css("width","275px");var Ra=$("<div class='qing-publish-detail-message-container'>");Ra.css("width","268px");D=new Wa;D.setTabType(z);D.getJqUi().appendTo(Ra);Ra.appendTo(Fa);Fa.appendTo(e);Fa.hide();x.on("click",function(){Fa.show();x.hide();q.show();ab(!0)});q.on("click",function(){Fa.hide();x.show();q.hide();ab(!1)});return e},tb=function(e){v={};A=0;m.MyIcons.background(b,"no-data");b.removeClass("sa-qing-publish-init-tips");
b.addClass("sa-qing-publish-no-data-tips");if(null==fa||0==fa.length)J?k.text(h.get("emptySearchTips","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):k.text(h.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55")),b.show(),k.show(),d.hide(),T.hide();else{b.hide();k.hide();d.show();T.show();la&&D.setLappMapIdCardModelDetail(la);Ea.clear(a);B.removeAllSelecteds();a.setScrollerVisible("auto","auto");a.addColumns(e?5:6);a.getColumn(0).setWidth(40);a.getColumn(0).setHide(e);
a.getColumn(1).setWidth(150);a.getColumn(2).setWidth(130);a.getColumn(3).setWidth(150);a.getColumn(4).setWidth(157);var x=Ea.createHeadRow(a);x.getCell(1).setValue(h.get("publishName","\u53d1\u5e03\u540d\u79f0"));x.getCell(2).setValue(h.get("publishSource","\u53d1\u5e03\u6765\u6e90"));x.getCell(3).setValue(h.get("permission","\u6388\u6743"));x.getCell(4).setValue(h.get("publishTime","\u53d1\u5e03\u65f6\u95f4"));e||(a.getColumn(5).setWidth(60),x.getCell(5).setValue(h.get("operate","\u64cd\u4f5c")));
e=!1;x=0;for(var q=fa.length;x<q;x++){var Fa=fa[x],Ra=Ea.createRow(a,!1);Ra.setUserObject(Fa);Ra.setHeight(30);var rb=new KTBorderStyle;rb.setBottomBorderWidth(1);rb.setBottomBorderPen("solid");rb.setBottomBorderColor("#E5E5E5");Ra.setBorder(rb);if(da&&Fa.getId()==da.getId()){e=!0;var xb=x}K&&K[Fa.getId()]&&A++}Ea.refresh(a);Y();e?xb=B.createRowTarget(xb+Ea.getHeadRowCount()):(xa==fa.length&&(xa=fa.length-1),xb=B.createRowTarget(Ea.getHeadRowCount()+xa));B.addSelected(xb)}},ha=function(e,x,q){var Fa=
"";q?Fa=x+"/"+q:e==bb.SUBJECT?Fa=h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664"):e==bb.DASHBOARD?Fa=h.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u88ab\u5220\u9664"):e==bb.EXTREPORT&&(Fa+=h.get("extReportDeleted","\u8be5\u8f7b\u62a5\u8868\u5df2\u88ab\u5220\u9664"));return Fa},ua=function(e,x,q){var Fa={1:"subject",2:"subject",3:"dashboard"},Ra={1:h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664"),2:h.get("subjectDeleted","\u8be5\u4e1a\u52a1\u4e3b\u9898\u5df2\u88ab\u5220\u9664"),
3:h.get("dashboardDeleted","\u8be5\u4eea\u8868\u677f\u5df2\u5220\u9664")};x?(e=Fa[e],la[q.getPublishId()]&&(e=la[q.getPublishId()].getPublishSourceGroupName()),x=e+"/"+x):x=Ra[e];return x},Da=function(e,x,q){var Fa="",Ra=h.get("comma","\u3001");e&&0<e.length&&(Fa+=h.get("permissionRolesText","\u89d2\u8272#1\u4e2a").replace("#1",e.length)+Ra);x&&0<x.length&&(Fa+=h.get("permissionUsersText","\u7528\u6237#1\u4e2a").replace("#1",x.length)+Ra);q&&0<q.length&&(Fa+=h.get("permLabelCount","\u6743\u9650\u6807\u7b7e#1\u4e2a").replace("#1",
q.length)+Ra);return Fa=0<Fa.length?Fa.slice(0,-1):h.get("noAuthTarget","\u672a\u9009\u62e9\u6388\u6743\u76ee\u6807")},eb=function(e,x){return 0==e.length&&0==x.length?h.get("permissionNoRoleAndUserText","\u672a\u9009\u62e9\u89d2\u8272\u6216\u7528\u6237"):0!=e.length&&0!=x.length?h.get("roleAndUserNames","\u89d2\u8272\uff1a#1\uff0c\u7528\u6237\uff1a#2").replace("#1",r(e)).replace("#2",r(x)):0!=e.length?h.get("roleNames","\u89d2\u8272\uff1a#1").replace("#1",r(e)):h.get("userNames","\u7528\u6237\uff1a#1").replace("#1",
r(x))},r=function(e){for(var x="",q=0;q<e.length;q++)x=0==q?x+e[q].getText():x+(","+e[q].getText());return x},Y=function(){if(ya){var e=Object.keys(K).length;ya.refreshSelectedRowTotal(e)}}};m.MyCustomExpendor=La;m.MultiOperationContainer=ob;m.TreeListMenuPanel=function(){var c,l=!0,g=!1,k=4,b,a,d,t,y,z,p,Q=this,J,U,O,v,A,K,xa=!1,fa={},da;this.getJqUi=function(){J||(J=$("<div>"),J.addClass("sa-qing-publish-manager-dir-container-analysiscenter"),Q.initDirOperatorUi());return J};this.setMaxDirLevel=
function(r){k=r};this.initDirOperatorUi=function(){J.empty();if(l){var r=$("<div>");r.addClass("sa-qing-publish-manager-dir");var Y=$("<div>");Y.addClass("sa-qing-publish-manager-dir-operator");var e=h.get("Dir","\u76ee\u5f55");Y.text(e);Y.attr("title",e);Y.appendTo(r);U=$("<div>");U.appendTo(r);var x=$("<div>");x.addClass("sa-qing-publish-manager-dir-operator-del");x.on("click",Ha);m.MyIcons.background(x,"btn_delete");x.on("mouseover",function(rb){m.MyIcons.background(x,"btn_delete_on")});x.on("mouseout",
function(rb){m.MyIcons.background(x,"btn_delete")});x.attr("title",h.get("deleteDir","\u5220\u9664\u76ee\u5f55"));x.appendTo(U);var q=$("<div>");q.addClass("sa-qing-publish-manager-dir-operator-edit");q.on("click",Da);m.MyIcons.background(q,"btn_edit");q.on("mouseover",function(rb){m.MyIcons.background(q,"btn_edit_on")});q.on("mouseout",function(rb){m.MyIcons.background(q,"btn_edit")});q.attr("title",h.get("editDir","\u7f16\u8f91\u76ee\u5f55"));q.appendTo(U);var Fa=$("<div>");Fa.addClass("sa-qing-publish-manager-dir-operator-add-next");
Fa.on("click",$a);m.MyIcons.background(Fa,"btn_add_sub");Fa.on("mouseover",function(rb){m.MyIcons.background(Fa,"btn_add_sub_on")});Fa.on("mouseout",function(rb){m.MyIcons.background(Fa,"btn_add_sub")});Fa.attr("title",h.get("addChildDir","\u65b0\u589e\u5b50\u7ea7"));Fa.appendTo(U);var Ra=$("<div>");Ra.addClass("sa-qing-publish-manager-dir-operator-add-current");Ra.on("click",ab);m.MyIcons.background(Ra,"btn_add_current");Ra.on("mouseover",function(rb){m.MyIcons.background(Ra,"btn_add_current_on")});
Ra.on("mouseout",function(rb){m.MyIcons.background(Ra,"btn_add_current")});Ra.attr("title",h.get("addSameLevelDir","\u65b0\u589e\u540c\u7ea7"));Ra.appendTo(U);r.appendTo(J)}B();r=b.getJqUi();Y=r.find(".sa-ctrl-list-owner");l&&ja.layoutCtrlWithLRTB(Y,0,0,null,34,0,null);r.appendTo(J);b.scrollSelectedToVisible()};this.updateTreeSearchUI=function(r,Y){a=r;fa=Y;for(Y=0;Y<r.length;Y++)r[Y].setIsHidden(!1),r[Y].setIsOpenDir(!0);D(r)};this.setSearchStatus=function(r){xa=r};this.setAutoSelectedData=function(r){da=
r};var B=function(){b=new Xa;var r=[],Y=[];if(a&&0<a.length){if(!g)for(var e=0;e<a.length;e++)1<a[e].getSubNodeLevel()?(a[e].setIsHidden(!0),a[e].setIsOpenDir(!1)):1==a[e].getSubNodeLevel()&&a[e].setIsOpenDir(!1);g=!0;e=!1;if(A&&A!=a[0].getRelationId())for(var x in a){var q=a[x];if(A==q.getRelationId()){Y.push(q);e=!0;var Fa=q.getSubNodeLevel();q.getCenterId1()&&r.push(q.getCenterId1());q.getCenterId2()&&r.push(q.getCenterId2());q.getCenterId3()&&r.push(q.getCenterId3());break}}!e&&Y.push(a[0])}else p(D);
if(da){e=[];for(x in a)"-1"!=r.indexOf(a[x].getId())&&(e.push(a[x]),a[x].setIsHidden(!1),Fa!=a[x].getSubNodeLevel()&&a[x].setIsOpenDir(!0));for(x in a)for(var Ra in e)e[Ra].getId()==a[x].getParentId()&&e[Ra].getSubNodeLevel()!=Fa&&a[x].setIsHidden(!1)}b.setBorderVisible(!1);b.scrollSelectedToVisible();b.setCustomItemPainter(T);b.addSelectedChangedListener(Ka);b.setUserObject(a);b.setItemModels(a);b.setSelecteds(Y)};this.loadTreeListNodeModelExposer=function(r){D(r)};var D=function(r){a=r;Q.initDirOperatorUi()},
T=function(r,Y){r.addClass("sa-qing-publish-menu-lists-dir");var e=$("<div>"),x=Y.getName();Y.getId()==wb.QING_CENTER_ID&&"\u6211\u7684\u8f7b\u5206\u6790"==x&&(x=h.get("myQingCenter",x));e.text(x);e.addClass("sa-qing-publish-menu-lists-dir-text");e.css("margin-left",14*Y.getSubNodeLevel()+"px");r.attr("title",x);x=$("<div>");x.addClass("sa-qing-publish-menu-lists-dir-opt-icon");x.css("margin-left",14*Y.getSubNodeLevel()+"px");x.data("oItemModel",Y);Y.getIsHidden()?r.hide():(r.show(),x.on("mousedown",
function(Ra){Ra.stopPropagation();var rb=$(Ra.currentTarget).data("oItemModel");if(rb&&rb.getId()){rb.getChildren()&&0<rb.getChildren().length?(Ra=rb.getIsOpenDir(),rb.setIsOpenDir(!Ra)):rb.setIsOpenDir(!0);ma(rb,!1);qa(b.getUserObject());for(var xb=J.find(".sa-ctrl-list-item"),L=0;L<xb.length;L++){Ra=xb.eq(L);var ta=Ra.data("model");var Ta=rb;ta=ta==Ta?!0:ta&&Ta&&ta instanceof ub&&Ta instanceof ub&&ta.getCenterId1()==Ta.getCenterId1()&&ta.getCenterId2()==Ta.getCenterId2()&&ta.getCenterId3()==Ta.getCenterId3()&&
ta.getCenterId4()==Ta.getCenterId4()?!0:!1;if(ta){rb=J.find(".sa-ctrl-list-owner");xb=rb.prop("clientHeight");L=rb.prop("scrollTop");ta=L+xb;Ta=Ra.prop("offsetTop");Ra=Ta+Ra.prop("offsetHeight");Ta<L?rb.prop("scrollTop",Ta-10):Ra>ta&&rb.prop("scrollTop",Ra-xb+10);break}}}Ra=b.getJqUi().find(".sa-qing-publish-menu-lists-dir-opt-icon-selected");la(K.getIsOpenDir(),Ra,!0)}));l||Y.getIsShow()||r.hide();Y.getIsOpenDir()&&0<Y.getChildren().length?la(!0,x,void 0):la(!1,x,void 0);if(0<Y.getChildren().length){var q=
Y.getChildren();if(l)r.append(x);else for(var Fa=0;Fa<q.length;Fa++)if(q[Fa].getIsShow()){r.append(x);break}}r.append(e);q=$("<div>");Y.getIsPreset()&&(q=$("<div>"),q.text(h.get("preset","\u9884\u7f6e")),q.addClass("sa-qing-publish-menu-lists-dir-preset"),q.css("margin-left",14*Y.getSubNodeLevel()+24+"px"),"Preset"==q.text()?e.css("margin-left",14*Y.getSubNodeLevel()+45+"px"):e.css("margin-left",14*Y.getSubNodeLevel()+33+"px"),r.append(q));Y==b.getSelecteds()[0]?(r.addClass("sa-publish-menu-lists-item-selected"),
r.addClass("sa-ctrl-list-item_selected_enabled"),x.addClass("sa-qing-publish-menu-lists-dir-opt-icon-selected"),Y.getIsPreset()&&q.addClass("sa-qing-publish-menu-lists-dir-preset-selected")):(r.on("mouseenter",function(Ra){b.getSelecteds()}),r.on("mouseleave",function(Ra){b.getSelecteds()}));xa&&(x="("+fa[Y.getRelationId()]+")",r.attr("title",Y.getName()+" "+x),ra(r,x,fa[Y.getRelationId()]))},la=function(r,Y,e){if(r)r=oa("div",1,3,7,1),r.style.borderBottom="1px solid black",e&&(r.style.borderBottom=
"1px solid white"),$(r).appendTo(Y);else{r=oa("div",1,4,7,1);var x=oa("div",4,1,0,7);r.style.borderTop="1px solid black";x.style.borderLeft="1px solid black";e&&(r.style.borderTop="1px solid white",x.style.borderLeft="1px solid white");$(r).appendTo(Y);$(x).appendTo(Y)}},oa=function(r,Y,e,x,q){r=document.createElement(r);r.style.overflow="hidden";r.style.position="absolute";r.style.left=Y+"px";r.style.top=e+"px";r.style.width=(0>x?0:x)+"px";r.style.height=(0>q?0:q)+"px";return r},ra=function(r,Y,
e){var x=$("<div class='sa-qing-publish-manager-Center-Search-Number'>");x.text(Y);x.title=Y;x.appendTo(r);0<e&&(e=$("<div class='sa-qing-publish-manager-Center-Search-Number-with-Color'>"),e.text(Y),e.appendTo(r),x.hide(),e.show())},qa=function(r){var Y=J.find(".sa-ctrl-list-owner");Y.empty();for(var e=$(document.createDocumentFragment()),x=T,q=0;q<r.length;q++){var Fa=$("<div>");Fa.addClass("sa-ctrl-list-item");Fa.addClass("sa-ctrl-list-item_enabled");Fa.addClass("sa-ctrl-list-item-defaultlayout");
var Ra=r[q];Fa.data("model",Ra);x(Fa,Ra);e.append(Fa)}Y.append(e)},Ka=function(r,Y,e){if(r=e[0]){K=r;A=e=r.getRelationId();d(e,r);e=b;var x=Y[0];if(Y=e.getJqUi().find(".sa-publish-menu-lists-item-selected")){Y.removeClass("sa-publish-menu-lists-item-selected");var q=Y.find(".sa-qing-publish-menu-lists-dir-opt-icon-selected");x&&la(x.getIsOpenDir(),q,!1);q&&0<q.length&&(q.removeClass("sa-qing-publish-menu-lists-dir-opt-icon-selected"),q.css("color","rgb(138, 158, 191)"));(x=Y.find(".sa-qing-publish-menu-lists-dir-preset-selected"))&&
0<x.length&&x.removeClass("sa-qing-publish-menu-lists-dir-preset-selected");xa&&(x=Y.find(".sa-qing-publish-manager-Center-Search-Number"),0<parseInt(x.text().substring(1,x.text().length-1))&&(Y.find(".sa-qing-publish-manager-Center-Search-Number-with-Color").show(),Y.find(".sa-qing-publish-manager-Center-Search-Number").hide()))}if(e=e.getItemUiByModel(r))Y=e.find(".sa-qing-publish-menu-lists-dir-opt-icon"),e.addClass("sa-ctrl-list-item_selected_enabled"),e.addClass("sa-publish-menu-lists-item-selected"),
la(r.getIsOpenDir(),Y,!0),Y.addClass("sa-qing-publish-menu-lists-dir-opt-icon-selected"),Y.css("color","white"),r.getChildren()&&0>=r.getChildren().length&&la(!0,Y,!0),r.getIsPreset()&&(Y=e.find(".sa-qing-publish-menu-lists-dir-preset"))&&Y.addClass("sa-qing-publish-menu-lists-dir-preset-selected"),xa&&(e.find(".sa-qing-publish-manager-Center-Search-Number-with-Color").hide(),e.find(".sa-qing-publish-manager-Center-Search-Number").show());r.getIsPreset()?U&&U.hide():U&&U.show()}},H=function(r,Y){var e=
null;r?e=r:0<b.getJqUi().find(".sa-publish-menu-lists-item-selected").length&&Y&&(e=Y);return e},M=function(r,Y){-1==r.indexOf(Y)&&r.push(Y);Y.getParentNode()&&M(r,Y.getParentNode());return r},ma=function(r,Y){r.setIsHidden(Y);if(r=r instanceof ub&&r.getChildren())for(Y=0;Y<r.length;Y++)r[Y].getParentNode().getIsOpenDir()&&!r[Y].getParentNode().getIsHidden()?ma(r[Y],!r[Y].getIsHidden()):ma(r[Y],!0)},Oa=function(r,Y){r.push(Y);if((Y=Y.getChildren())&&0<Y.length)for(var e=0;e<Y.length;e++)Y[e].getChildren()&&
0<Y[e].getChildren().length?Oa(r,Y[e]):r.push(Y[e]);return r},Ha=function(){var r=H(b.getSelecteds()[0],void 0);if(r){var Y=new pb;Y.setOptionType(pb.OPTION_OK_CANCEL);var e=h.get("confirmToDelDir","\u786e\u5b9a\u5220\u9664\u8be5\u76ee\u5f55\uff1f");Y.setMessage(e);Y.setClosingChecker(function(x){if(x==pb.RETURN_OK){x=[];x=Oa(x,r);for(var q=[],Fa=0;Fa<x.length;Fa++)q.push(x[Fa].getRelationId());y(q,ya)}return!0});Y.showDialog()}else O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),
2E3)},ya=function(r){if(r){r=H(b.getSelecteds()[0],void 0);var Y=[];Oa(Y,r);for(var e in Y){var x=tb(Y[e],a);-1<x&&a.splice(x,1)}b.setItemModels(a);b.setSelecteds([]);e=[];M(e,r);for(Y=1;Y<e.length;Y++)if((x=e[Y].getChildren())&&0<x.length){var q=tb(r,x);-1<q?x.splice(q,1):(q=tb(e[Y-1],x),-1<q&&x.splice(q,1,e[Y-1]))}b.setUserObject(a);qa(a)}},ab=function(){var r=H(b.getSelecteds()[0],void 0);if(r){var Y=Ya(r,"ADD_CURRENT"),e=b.getItemUiByModel(b.getUserObject()[Y]);e&&0<e.length?(c=new Ba,x=c.getJqUi(),
x.show(),c.setEnabled(!0),x.addClass("sa-qing-publish-manager-dir-editing"),x.children().css("position","relative"),x.children().css("padding-left",30*(r.getSubNodeLevel()-1)+"px"),x.insertAfter(e),c.requestFocus(),c.addBlurListener(function(){var q=c.getText();q&&(q=q.trim(),c.getJqUi().attr("title",q));c.getJqUi().remove();ua(q)&&t("ADD_CURRENT",r,q,ha,Y)}),x.on("keydown",function(q){if(13==(q.keyCode||q.which||q.charCode)){if(q=c.getText())q=q.trim(),c.getJqUi().attr("title",q);c.getJqUi().remove();
ua(q)&&t("ADD_CURRENT",r,q,ha,Y)}})):O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3)}else if(0<a.length)O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3);else{c=new Ba;var x=c.getJqUi();x.show();c.setEnabled(!0);x.addClass("sa-qing-publish-manager-dir-editing");x.children().css("position","relative");x.appendTo(J);c.requestFocus();c.addBlurListener(function(){var q=c.getText();q&&(q=q.trim(),
c.getJqUi().attr("title",q));c.getJqUi().remove();if(ua(q)){var Fa=new ub;t("ADD_CURRENT",Fa,q,ha,null)}});x.on("keydown",function(q){if(13==(q.keyCode||q.which||q.charCode)){if(q=c.getText())q=q.trim(),c.getJqUi().attr("title",q);c.getJqUi().remove();if(ua(q)){var Fa=new ub;t("ADD_CURRENT",Fa,q,ha,null)}}})}},Ya=function(r,Y){var e=a.length-1;if("ADD_CURRENT"==Y)return r.getParentNode()&&(Y=tb(r.getParentNode(),a),e=[],e=Oa(e,r.getParentNode()),e=parseInt(Y)+e.length-1),e;if("ADD_SUB"==Y)return r.getChildren()&&
0<r.getChildren().length?(Y=tb(r,a),e=[],e=Oa(e,r),e=parseInt(Y)+e.length-1):Y=tb(r,a)},$a=function(){var r=H(b.getSelecteds()[0],void 0);if(r){var Y=Ya(r,"ADD_SUB"),e=b.getItemUiByModel(b.getUserObject()[Y]);if(e&&0<e.length)if(r.getSubNodeLevel()>=k-1)O.showPrompt(h.get("theMaxDirenctoryLevel","\u6700\u591a\u53ef\u652f\u63014\u7ea7\u76ee\u5f55\uff0c\u5f53\u524d\u76ee\u5f55\u4e3a\u7b2c4\u7ea7\u76ee\u5f55\uff0c\u65e0\u6cd5\u65b0\u589e\u4e0b\u7ea7\u76ee\u5f55\u3002"),2E3);else{c=new Ba;var x=c.getJqUi();
x.show();c.setEnabled(!0);x.addClass("sa-qing-publish-manager-dir-editing");x.children().css("position","relative");x.children().css("padding-left",30*(r.getSubNodeLevel()-1)+"px");x.insertAfter(e);c.requestFocus();c.addBlurListener(function(){var q=c.getText();q&&(q=q.trim(),c.getJqUi().attr("title",q));c.getJqUi().remove();ua(q)&&t("ADD_SUB",r,q,ha,Y)});x.on("keydown",function(q){if(13==(q.keyCode||q.which||q.charCode)){if(q=c.getText())q=q.trim(),c.getJqUi().attr("title",q);c.getJqUi().remove();
ua(q)&&t("ADD_SUB",r,q,ha,Y)}})}else O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3)}else O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3)},tb=function(r,Y){if(r){var e=Y.indexOf(r);if(0>e)for(var x in Y)if(Y[x].getRelationId()==r.getRelationId()&&Y[x].getId()==r.getId()&&Y[x].getParentId()==r.getParentId()&&Y[x].getName()==r.getName()){e=x;break}return e}O.showPrompt(h.get("selectedOneDirectory",
"\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3)},ha=function(r,Y,e,x){if(r&&r.relationId&&r.id){var q=new ub;q.setName(r.name);q.setId(r.id);q.setParentId(r.parentId);q.setRelationId(r.relationId);q.setIsPreset(r.isPreset);q.setCenterId1(r.levelId1);q.setCenterId2(r.levelId2);q.setCenterId3(r.levelId3);q.setCenterId4(r.levelId4);if(null==Y)a.push(q),b.setSelecteds([q]);else if("ADD_CURRENT"==x&&q.getParentId()==e.getParentId())q.setParentNode(e.getParentNode()),e.getParentNode()?(e.getParentNode().getChildren().push(q),
a.splice(Y+1,0,q)):a.push(q);else{q.setParentNode(e);e.getChildren().push(q);a.splice(Y+1,0,q);e.setIsOpenDir(!0);for(var Fa in e.getChildren())e.getChildren()[Fa].setIsHidden(!1)}b.setItemModels(a);b.setUserObject(a);qa(a)}},ua=function(r,Y){return r&&r!=Y?50<r.length?(O.showPrompt(h.get("publishNameTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),2E3),!1):!0:!1},Da=function(){var r=H(b.getSelecteds()[0],void 0);if(r){var Y=b.getItemUiByModel(r);if(Y&&0<Y.length){c=new Ba;
var e=c.getJqUi();e.show();c.setEnabled(!0);e.addClass("sa-qing-publish-menu-lists-dir-text-edit");e.css("left",14*(r.getSubNodeLevel()+1)+14+"px");var x=Y.find(".sa-qing-publish-menu-lists-dir-text");x&&x.hide();e.appendTo(Y);Y=r.getName();r.getId()==wb.QING_CENTER_ID&&"\u6211\u7684\u8f7b\u5206\u6790"==Y&&(Y=h.get("myQingCenter",Y));c.setText(Y);c.requestFocus();c.addBlurListener(function(){var q=c.getText();q&&(q=q.trim(),c.getJqUi().attr("title",q));e.remove();ua(q,r.getName())?z(r,q,eb):x.show()});
e.on("keydown",function(q){if(13==(q.keyCode||q.which||q.charCode)){if(q=c.getText())q=q.trim(),c.getJqUi().attr("title",q);e.remove();ua(q,r.getName())?z(r,q,eb):x.show()}})}else O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3)}else O.showPrompt(h.get("selectedOneDirectory","\u8bf7\u5148\u9009\u4e2d\u5177\u4f53\u76ee\u5f55\u3002"),2E3)},eb=function(r,Y){if(r){var e=c.getText(),x=tb(Y,a);Y.setName(e);e=Y.getSubNodeLevel()+1;1==e?Y.setCenterId1(r):
2==e?Y.setCenterId2(r):3==e?Y.setCenterId3(r):4==e&&Y.setCenterId4(r);Y.setId(r);a.splice(x,1,Y);b.setItemModels(a);b.setUserObject(a);r=[];Oa(r,Y);x=Y.getId();if(1==e)for(e=1;e<r.length;e++){var q=r[e].getParentNode();q.getRelationId()==Y.getRelationId()&&r[e].setParentId(x);r[e].setCenterId1(x)}else if(2==e)for(e=1;e<r.length;e++)q=r[e].getParentNode(),q.getRelationId()==Y.getRelationId()&&r[e].setParentId(x),r[e].setCenterId2(x);else if(3==e)for(e=1;e<r.length;e++)q=r[e].getParentNode(),q.getRelationId()==
Y.getRelationId()&&r[e].setParentId(x),r[e].setCenterId3(x)}qa(a)};this.setOuterMessageCurtain=function(r){O=r};this.setManagerDir=function(r){l=r};this.setEmptyMenudHint=function(r){v=r};this.getEmptyMenudHint=function(){return v};this.setDefaultItemValue=function(r){A=r};this.getDefaultItemValue=function(){return A};this.setTreeSelectorModel=function(r){a=r};this.getTreeSelectorModel=function(){return a};this.setAddDirNameListener=function(r){t=r};this.setDeleteDirNameListener=function(r){y=r};
this.setUpdateDirNameListener=function(r){z=r};this.setLoadDirNameListener=function(r){p=r};this.setSelectedDirNameListener=function(r){d=r}};m.TreeItemSelector=function(){db.call(this);var c=this,l=this.protectedMethod,g,k=[],b,a;this.getDropDownContent=function(O){c.initTreeSelector();return g.getJqUi()};this.setSelectedListener=function(O){a=O};this.setSelectedTreePath=function(O){b=O;l.updateText(b?b.getText():"")};this.getSelectedTreePath=function(){return b};this.initTreeSelector=function(){if(k){g=
new gb;g.setRootVisible(!1);g.setNodePainter(Q);var O=g,v=O.setRoot,A=k,K=new ub;K.setParentId(" ");K.setName("\u65b0\u589e\u76ee\u5f55");K.setId(" ");K=d(K);y(K,A);v.call(O,K);g.hookLoadingHandler(p);g.addSelectingListener(J);g.getRoot().setExpanded(!0);g.getRoot().setSelectable(!1);g.setLineHeight(30);ja.layoutCtrl(g.getJqUi(),0,1,"100%",118);g.getJqUi().css("border","1px solid rgba(138, 153, 170, 0.4)");g.getJqUi().css("background","white");g.getJqUi().appendTo($(document.body))}else return null};
this.setArrFolderNode=function(O){k=O};this.getArrFolderNode=function(){return k};var d=function(O){var v=new gb.BranchNode;v.setUserObject(O);return v},t=function(O){var v=new gb.LeafNode;v.setUserObject(O);return v},y=function(O,v){if(v&&0<v.length)for(var A=0;A<v.length;A++){var K=v[A];0<K.getChildren().length?z(O,K):O.addChild(t(K))}},z=function(O,v){var A=0<v.getChildren().length?d(v):t(v);O.addChild(A);O=v.getChildren();if(0!=O.length)for(v=0;v<O.length;v++)O[v].getChildren()?z(A,O[v]):A.addChild(t(O[v]))},
p=function(O,v){setTimeout(function(){y(O);v()},500)},Q=function(O,v){O.css("padding-left","4px");O.css("padding-right","4px");O.text(v.getUserObject().getName())},J=function(O,v){for(var A=v.getTreePath(),K=O="",xa=1;xa<A.length;xa++){1<xa&&(O+="/",K+="/");var fa=A[xa];O+=fa.getUserObject().getName();K+=fa.getUserObject().getId()}v=v.getUserObject().getRelationId();A=new Ua;A.setValue(v);A.setText(O);b=A;l.updateText(b?b.getText():"");l.doDropdown();a&&a(c,b)},U=200;this.setMaxHeight=function(O){U=
O};this.getPopupHeight=function(){return null==k||0==k.length?22:Math.min(30*k.length+2,U+2)}};m.SchedulePushDialog=function(){Z.call(this);var c=this,l=this.protectedMethod,g=this.showDialog,k;this.setConfirmListener=function(b){k=b};this.showDialog=function(b,a){l.setTitle(h.get("pushConfirm","\u63a8\u9001\u786e\u8ba4"));c.setSize(320,200);l.setSelectable(!0);l.setContentPaneCreator(function(){var d=h.get("confirmPushImmediately","\u5373\u5c06\u63a8\u9001\u201c#1\u201d\u81f3#2\uff0c\u786e\u5b9a\u63a8\u9001\u5417\uff1f").replace("#1",
b).replace("#2",a),t=$("<div>"),y=$("<div>");y.addClass("delete-record-text");y.text(d);y.appendTo(t);return t});l.setClosingAction(function(d){d&&k&&k()});g()}};m.SchedulePushingDialog=function(){Z.call(this);var c=this,l=this.protectedMethod,g=this.showDialog,k,b,a,d,t,y=I.getIconUrl("common","htmlLoad/sway.gif");this.setTitle=function(p){t=p};this.setText=function(p){d=p;a&&a.text(d)};this.setConfirmListener=function(p){k=p};this.setClosedListener=function(p){b=p};this.destroy=function(){l.destroy()};
this.showDialog=function(){l.setTitle(t?t:h.get("pushing","\u63a8\u9001\u4e2d"));c.setSize(480,320);l.setSelectable(!0);l.setContentPaneCreator(function(){var p=$("<div>"),Q=$("<img>");Q.addClass("progress-background");Q.prop("src",y);a=$("<div>");a.addClass("pushing-tips");a.text(d);Q.appendTo(p);a.appendTo(p);return p});l.setClosingAction(function(p){p?k&&k():b&&b()});l.setFooterPaneCreator(z);g()};var z=function(p){var Q=new com.kingdee.bos.qing.ui.component.Button(h.get("tryCancelPush","\u5c1d\u8bd5\u53d6\u6d88\u63a8\u9001"));
Q.setHighlight(!0);ja.layoutCtrlWithLRTB(Q.getJqUi(),"50%",0,100,null,13,28);Q.getJqUi().addClass("dialog-footer-close");Q.getJqUi().appendTo(p);Q.addActionListener(function(J){b&&b();c.destroy()})}};m.SortWidget=Ga;m.SortField=Ma;m.CardDetailMessagePanel=Wa;m.SelectorListPublishContentPanel=function(){function c(H){KTDefaultCellRender.call(this,H);var M=this,ma=this.paintCellUI;this.paintCellUI=function(Ha,ya){var ab=M.getCurrentRow(),Ya=M.getCurrentColIdx();if(ab=ab.getUserObject())var $a=ab.getPublishModel();
(new X).setFormatString("yyyy-MM-dd HH:mm:ss");M.getCurrentRowIdx()<Ea.getHeadRowCount()||1!=Ya&&2!=Ya&&3!=Ya&&4!=Ya&&0!=Ya?ma(Ha,ya):1==Ya?(ya=$("<div class='sa-publish-item-list-head'>"),$a.isPreset()&&(Ya=$("<div>"),Ya.text(h.get("preset","\u9884\u7f6e")),Ya.addClass("sa-qing-publish-manager-name-preset-tag"),Ya.appendTo(ya)),"dashboard"==$a.getPublishSourceType()?(Ya=$a.isPreset(),ab=$("<div>"),m.MyIcons.background(ab,"dashboard"),ab.addClass("sa-qing-publish-manager-card-list-type"),Ya&&ab.css("margin-left",
"5px"),ab.appendTo(ya)):z||(Ya=$a.isPreset(),ab=$("<div>"),m.MyIcons.background(ab,"squareData"),ab.addClass("sa-qing-publish-manager-card-list-type"),Ya&&ab.css("margin-left","5px"),ab.appendTo(ya)),Ya=$("<div class='sa-publish-item-list-head-name'>"),Ya.text($a.getName()),Ya.attr("title",$a.getName()),Ya.appendTo(ya),ya.appendTo(Ha)):2==Ya?($a=($a=$a.getCardDesc())?$a:h.get("noDescription","\u6682\u65e0\u63cf\u8ff0"),ya=$("<div>"),ya.text($a),ya.attr("title",$a),ya.css("line-height","28px"),ya.css("padding-left",
"8px"),ya.css("padding-right","8px"),ya.appendTo(Ha)):3==Ya?(ya=$("<div>"),$a=Q?$a.getPathText():$a.isPreset()?h.get("systemPreset","\u7cfb\u7edf\u9884\u7f6e"):$a.getCreatorName(),ya.text($a),ya.attr("title",$a),ya.css("line-height","28px"),ya.css("padding-left","8px"),ya.css("padding-right","8px"),ya.appendTo(Ha)):4==Ya?(ya=$("<div>"),$a=$a.getCreateFormatTime(),ya.text($a),ya.attr("title",$a),ya.css("margin-top","7px"),ya.css("padding-left","8px"),ya.css("padding-right","8px"),ya.appendTo(Ha)):
0==Ya&&(da[ab.getPublishModel().getId()]?(ab.setSelected(!0),J=ab):ab.setSelected(!1),ab.addSelectButton(Oa),z&&T.addElement(ab.getSelector()),ab.getJqUi().appendTo(Ha))};var Oa=function(Ha,ya,ab){var Ya=ya.isChecked(),$a=Ha.getPublishModel();if(ab||z)Ya?(z&&(da={},J&&(U=J.getSelector(),J.getPublishModel().getId()!=$a.getId()&&(J.setSelected(!1),U.setChecked(!1))),J=Ha,U=ya),da[$a.getId()]=$a):(z&&(U=J=null),delete da[$a.getId()]),fa($a,Ya)}}function l(){KTableSelectionRender.call(this);var H=$("<div>");
this.show=function(ma,Oa,Ha,ya,ab){ja.layoutCtrl(H,Oa,Ha,ya-Oa,ab-Ha);M();H.css("z-index",0);ma.append(H)};this.remove=function(){H.remove()};this.current=function(){M()};this.letOthersOld=function(ma){};var M=function(ma){H.addClass("sa-common-table-selection");if(ma=a.getSelectionModel().getSelected()){ma=ma.getRowIdx();ma=a.getRow(ma).getUserObject().getPublishModel();var Oa=xa(ma.getImagePath());D.setProfile(ma,Oa)}}}var g,k,b,a,d,t,y,z=!1,p,Q=!0,J,U,O,v=this,A,K,xa,fa,da={},B,D,T,la;this.getJqUi=
function(){if(!g){g=$("<div>");g.addClass("sa-qing-publish-manager-content-container");b=$("<div>");b.appendTo(g);k=$("<div>");k.addClass("sa-qing-publish-manager-content-emptytip");k.appendTo(g);a=Ea.createTable();var H=new La;H.setSyncSearchingUI(qa);a.setDraggableAdjusting(!0,3,0,H);a.setColumnFitVisibleWidth(!0);H=new c(a);H.setOutsideVisible(!1);a.setCellRender(H);a.setSyncUIWhenModelChanged(!0);Ea.setupSingleRowSelection(a);a.setSelectionRender(l);y=a.getSelectionModel();d=$(a.getUI());d.addClass("sa-qing-publish-manager-content-table");
d.children().css("overflow-x","hidden");d.appendTo(g);B=ra();B.appendTo(g);B.hide()}return g};this.setSearchStatus=function(H){K=H};this.setCardImgUrlCreator=function(H){xa=H};this.getSelectedPublishCardItem=function(){return da};this.setSelectedPublishCardItem=function(H){da=H};this.getSelectedPublishModels=function(){var H=[],M;for(M in da)H.push(da[M]);return H};this.setListSelectedModel=function(H){};this.setSingleSelected=function(H){z=H};this.setIsDashBoardSelector=function(H){};this.relayoutViews=
function(){a&&(Ea.refresh(a),a.relayoutViews());if(y&&y.hasSelected()){var H=y.getSelected();y.removeAllSelecteds();H&&y.addSelected(H);H=H.getRowIdx()-Ea.getHeadRowCount();a.scrollCellVisible(H,0,!1)}oa(O)};this.setEditPublishListener=function(H){};this.setDeletePublishListener=function(H){};this.setTipsText=function(H){t=H;k&&(k.text(t),k.show(),d.hide())};this.setSelectedChangeListener=function(H){fa=H};var oa=function(H){var M=g.outerWidth();(O=H)?(a.setColumnFitVisibleWidth(!0),d&&d.css("width",
M+"px"),Ea.refresh(a),a.setColumnFitVisibleWidth(!1),d&&d.css("width",M-269+"px")):(a.setColumnFitVisibleWidth(!0),d&&d.css("width",M+"px"));Ea.refresh(a);qa()},ra=function(){var H=$("<div>"),M=$("<div>");m.MyIcons.background(M,"icon-side-open");M.addClass("sa-qing-publish-manager-card-detail-message-open");M.appendTo(H);var ma=$("<div>");m.MyIcons.background(ma,"icon-side-close");ma.addClass("sa-qing-publish-manager-card-detail-message-close");ma.hide();ma.appendTo(H);var Oa=$("<div class='sa-qing-publish-detail-message-panel'>");
D=new Wa;D.setTabType(Sa.CARD);D.setIsCardSelector(!0);D.getJqUi().appendTo(Oa);Oa.appendTo(H);Oa.hide();M.on("click",function(){Oa.show();M.hide();ma.show();oa(!0)});ma.on("click",function(){Oa.hide();M.show();ma.hide();oa(!1)});return H};this.setListPublishModel=function(H,M,ma){p=H;Q=M;la=ma;y.removeAllSelecteds();b.addClass("sa-qing-publish-no-data-tips");m.MyIcons.background(b,"no-data");if(null==p||0==p.length)K?k.text(h.get("emptySearchTips","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):
k.text(h.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55")),b.show(),k.show(),d.hide(),B.hide();else{b.hide();k.hide();d.show();B.show();Ea.clear(a);a.setScrollerVisible("auto","auto");a.addColumns(5);a.getColumn(1).setWidth(100);a.getColumn(2).setWidth(110);a.getColumn(3).setWidth(110);a.getColumn(4).setWidth(107);a.getColumn(0).setWidth(14);H=Ea.createHeadRow(a);H.getCell(1).setValue(h.get("publishName","\u53d1\u5e03\u540d\u79f0"));H.getCell(2).setValue(h.get("description","\u63cf\u8ff0"));
Q?H.getCell(3).setValue(h.get("Dir","\u76ee\u5f55")):H.getCell(3).setValue(h.get("publishPerson","\u53d1\u5e03\u4eba"));H.getCell(4).setValue(h.get("publishTime","\u53d1\u5e03\u65f6\u95f4"));T=new R;for(H=0;H<p.length;H++)ma=new sa(p[H]),ma.setSingleSelected(z),z&&la&&0==H&&(da={},da[p[H].getId()]=p[H]),M=Ea.createRow(a,!1),M.setUserObject(ma),M.setHeight(30),ma=new KTBorderStyle,ma.setBottomBorderWidth(1),ma.setBottomBorderPen("solid"),ma.setBottomBorderColor("#E5E5E5"),M.setBorder(ma);Ea.refresh(a);
Ka()}oa(O)};this.updateSelectorSearchContentUI=function(H){A=H;if(K){var M=g.find(".sa-publish-item-list-head"),ma;for(ma in p){var Oa=void 0,Ha=M[ma],ya=p[ma].getName();if(Ha&&ya&&H){var ab=H.toUpperCase(),Ya=ya.toUpperCase(),$a=Ya.split(ab),tb=ab.length,ha=$("<div>");ha.addClass("sa-publish-item-list-head-name");for(Oa in $a){var ua=Ya.indexOf($a[Oa]),Da=ya.substr(0,$a[Oa].length);ua+=$a[Oa].length;var eb=Ya.length-ua;Ya=Ya.substr(ua,eb);ya=ya.substr(ua,eb);ua=$("<span>");ua.text(Da);ua.appendTo(ha);
if(Oa!==$a.length-1&&1<$a.length){eb=Ya.indexOf(ab);Da=ya.substr(eb,tb);eb+=tb;var r=Ya.length-eb;Ya=Ya.substr(eb,r);ya=ya.substr(eb,r);eb=$("<span>");eb.text(Da);eb.css("color","#FF0000");eb.appendTo(ua)}$(Ha).children(".sa-publish-item-list-head-name").remove()}ha.appendTo(Ha);$(Ha).attr("title",ha.text())}}}};var qa=function(){Ka();v.updateSelectorSearchContentUI(A,K)},Ka=function(){if(y&&y.hasSelected()){var H=y.getSelected();y.removeAllSelecteds();H&&y.addSelected(H);H=H.getRowIdx()-Ea.getHeadRowCount();
a.scrollCellVisible(H,0,!1)}else H=y.createRowTarget(Ea.getHeadRowCount()),y.addSelected(H)}};m.FilterModelType=function(){var c,l,g,k;this.setSearchType=function(a){l=a};this.setSelectedChangedListener=function(a){g=a};this.setSelected=function(a){k.setSelected(a)};this.getJqUi=function(){c||(c=b());return c};var b=function(){k=new C;k.setItemModels(l);k.setSelected(l[0]);k.addSelectedChangedListener(g);k.setCustomPainter(function(t,y,z){y.text(z.getTypeName());y.attr("title",z.getTypeName())});
var a=k.getJqUi(),d="en"==Qa.getUrlParamValue("language")?"107px":"77px";a.css({"float":"left",left:"15px",height:"27px",position:"relative",width:d,"margin-right":"25px",top:"6px"});return a}};m.PublishManagerSortPanel=function(){var c,l=[],g,k,b=function(){g=$("<div>");var a=new Ma;a.setDescName(h.get("publishTime","\u53d1\u5e03\u65f6\u95f4"));a.setGroupName("SortField");a.setPropertyName("createTime");var d=new Ma;d.setDescName(h.get("publishName","\u540d\u79f0"));d.setGroupName("SortField");d.setPropertyName("name");
l.push(a);l.push(d);c=new Ga;c.setArrSortField(l);c.setFunSortModel(k);var t=c.getSortMenuModel();a=h.get("sort","\u6392\u5e8f");d=new W;d.setSelectedModel(a);d.setDropdownCreator(function(y,z,p,Q){z=new F;z.setModel(t);z.setHideListener(function(){Q()});z=z.getJqUi();y.append(z);return[z.prop("offsetWidth"),z.prop("offsetHeight")]});a=d.getJqUi();ja.layoutCtrlWithLRTB(a,null,20,53);ja.layoutCtrlMiddleAlign(a,24);a.appendTo(g);a.css({"margin-top":"-11px",top:"19px"});return g};this.getJqUi=function(){g||
(g=b());return g};this.setSortModel=function(a){k=a};this.sort=function(){c.sort()}};m.PublishViewSwitchPanel=function(){var c,l;this.getJqUi=function(){c||(c=g());return c};this.setClickListener=function(k){l=k};var g=function(){c=$("<div>");var k=$("<span>");k.addClass("sa-qing-publish-manager-dir-operator-right-titleBar-card2pic");m.MyIcons.background(k,"card2pic");k.attr("title",h.get("cardView","\u5361\u7247\u89c6\u56fe"));k.css("right","40px");k.appendTo(c);var b=$("<span>");b.addClass("sa-qing-publish-manager-dir-operator-right-titleBar-card2list");
m.MyIcons.background(b,"card2listN");b.attr("title",h.get("listView","\u5217\u8868\u89c6\u56fe"));b.css("right","-6px");b.appendTo(c);k.on("click",function(){m.MyIcons.background(k,"card2pic");m.MyIcons.background(b,"card2listN");l(!0)});b.on("click",function(){m.MyIcons.background(k,"card2picN");m.MyIcons.background(b,"card2list");l(!1)});return c}};m.PublishCardItem=zb;m.PublishSearchPanel=function(){var c,l,g;this.getInputContent=function(){return g.getText()};this.getJqUi=function(){if(!c){var k=
$("<div>");g=new f;g.setPlaceholder(h.get("searchContent","\u641c\u7d22\u53d1\u5e03\u540d\u79f0"));g.setSearchListenerDelay(1E3);g.setShowSearchIcon(!0);g.addSearchListener(l);var b=g.getJqUi();b.addClass("sa-qing-publish-manager-searchBox");b.appendTo(k);c=k}return c};this.setSearchListener=function(k){l=k}};m.CardFilterType=ia;m.BatchPublishToDialog=function(c,l,g){var k,b,a,d,t,y,z;this.showPrompt=function(p,Q){z&&z.showPrompt(p,Q)};this.showDialog=function(){k=new G;var p=h.get("publishToPrefix",
"\u53d1\u5e03\u5230#1").replace("#1",N(c));k.setTitle(p);z=new kb(c,l,g);z.setPublishContexts(b);z.setLockedByOtherTemplate(y);z.setPublishContentEditEntrance(a);z.setSpaceID(t);p=new fb(c,l,g);p.setSpaceID(t);p.setSuccessCallback(d);k.setSteps([z,p]);k.show(700,500)};this.setSpaceID=function(p){t=p};this.setPublishContexts=function(p){b=p};this.setPublishContentEditEntrance=function(p){a=p};this.setSuccessCallback=function(p){d=p};this.setLockedByOtherTemplate=function(p){y=p}};m.AbstractBatchPublishPanel=
function(c,l){function g(H){KTDefaultCellRender.call(this,H);var M=this,ma=this.paintCellUI;this.paintCellUI=function(Ha,ya){var ab=M.getCurrentRowIdx(),Ya=M.getCurrentColIdx(),$a=M.getCurrentRow().getUserObject(),tb=$a?$a.getPublishSourceName():"",ha=M.getCellWidth(),ua=M.getCellHeight();if(ab<Ea.getHeadRowCount())ma(Ha,ya),4==Ya&&1==ab&&(ha=b.createPublishManagerBtn(function(){a.protectedOpenPublishManager()}),ja.layoutCtrlWithLRTB(ha,null,2,null,2,null,null),ha.appendTo(Ha));else if(1==Ya||2==
Ya)ma(Ha,ya);else if(0==Ya){ha=Oa(fa[tb]);if(ha){var Da=za.createWarning();Da.attr("title",ha);Da.addClass("qing-publish-warning");$(Ha).append(Da)}T[tb]=Da}else if(3==Ya){Da=$a.getName();var eb=$("<span>");eb.text(Da);eb.attr("title",Da);ya=new Ba;ya.addBlurListener(function(r){r=$.trim(r.getText());$a.getName()!=r&&($a.setName(r),eb.text(r),eb.attr("title",r),(r=fa[tb])&&(r.isNameEmpty()||r.isNameExist()||r.isSameSourceNameExist()||r.getSameInputTemplateName())&&((r=T[tb])&&r.remove(),delete fa[tb]))});
ya.setText(Da);Da=ya.getJqUi();b.bindDynamicCtrlInCell($(Ha),Da,eb,ha,ua)}else 4==Ya?(eb=$("<span>"),Da=$a.getPathText(),eb.text(Da),eb.attr("title",Da),Da=a.protectedCreatePathSelector(),$a.getPath()&&(ya=new Ua,ya.setValue($a.getPath()),ya.setText($a.getPathText()),Da.setSelectedPath(ya)),Da.setSelectedListener(function(r){var Y="",e="";r&&(Y=r.getText(),e=r.getValue());if($a.getPath()!=e||$a.getPathText()!=Y)$a.setPath(e),$a.setPathText(Y),eb.text(Y),eb.attr("title",Y),(r=fa[tb])&&(r.isPathEmpty()||
r.isNameExist()||r.isSameSourceNameExist()||r.getSameInputTemplateName())&&((r=T[tb])&&r.remove(),delete fa[tb])}),D[tb]=Da,Da=Da.getJqUi(),b.bindDynamicCtrlInCell($(Ha),Da,eb,ha,ua)):5==Ya?xa&&(eb=$("<span>"),Da=da[tb]?h.get("rePublish","\u91cd\u65b0\u53d1\u5e03"):h.get("cancelPublish","\u53d6\u6d88\u53d1\u5e03"),eb.text(Da),eb.attr("title",Da),Da=new C,Da.setItemModels([!0,!1]),Da.setSelected(da[tb]),Da.addSelectedChangedListener(function(r,Y,e){Y!==e&&(r=e?h.get("rePublish","\u91cd\u65b0\u53d1\u5e03"):
h.get("cancelPublish","\u53d6\u6d88\u53d1\u5e03"),eb.text(r),eb.attr("title",r),da[tb]=e)}),Da.setCustomPainter(function(r,Y,e){r=e?h.get("rePublish","\u91cd\u65b0\u53d1\u5e03"):h.get("cancelPublish","\u53d6\u6d88\u53d1\u5e03");Y.text(r);Y.attr("title",r)}),Da=Da.getJqUi(),b.bindDynamicCtrlInCell($(Ha),Da,eb,ha,ua)):6==Ya&&(Da=$("<div>"),Da.addClass("publish-batch-operate-cell-content"),ya=b.createOperateBtn(h.get("copyPath","\u590d\u5236\u8def\u5f84"),function(){var r=$a.getPath();r?(Q=new Ua,Q.setValue(r),
Q.setText($a.getPathText()),b.getOuterMessageCurtain().showSuccess(h.get("copySuccess","\u590d\u5236\u6210\u529f\u3002"),2E3)):Q=null}),ya.css("margin-right","5px"),Da.append(ya),ya=b.createOperateBtn(h.get("pastePath","\u7c98\u8d34\u8def\u5f84"),function(){if(Q&&$a.getPath()!=Q.getValue()){var r=D[tb];r&&r.setSelectedPath(Q)}}),Da.append(ya),ya=$("<div>"),ya.addClass("publish-batch-copy-path-cell-ctrl"),ya.append(Da),b.bindDynamicCtrlInCell($(Ha),ya,null,ha,ua))};var Oa=function(Ha){if(!Ha)return"";
if(Ha.isNameEmpty())var ya=h.get("publishNameEmpty","\u53d1\u5e03\u540d\u79f0\u4e3a\u7a7a\u3002");else if(Ha.isPathEmpty())ya=h.get("publishPathEmpty","\u53d1\u5e03\u8def\u5f84\u4e3a\u7a7a\u3002");else if(Ha.getSameInputTemplateName())ya=h.get("nameExistWithInput","\u53d1\u5e03\u540d\u79f0\u548c\u53d1\u5e03\u8def\u5f84\u4e0e\u62a5\u8868\u6a21\u677f\u201c#1\u201d\u76f8\u540c\uff0c\u540c\u4e00\u8def\u5f84\u4e0b\u4e0d\u5141\u8bb8\u91cd\u540d\u53d1\u5e03\u3002").replace("#1",Ha.getSameInputTemplateName());
else if(Ha.isNameExist()||Ha.isSameSourceNameExist())ya=h.get("publishUpdateSameSourceNameDuplicate","\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0\u3002");return ya}}function k(H){pa.AbstractTabPane.call(this);var M,ma,Oa;this.getPublishTable=function(){return M};this.setPublishTableCreator=function(Ha){ma=Ha};this.isLockedByOther=function(){return H};this.getTitle=function(){return H?h.get("lockedTemplate","\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\u7684\u62a5\u8868\u6a21\u677f"):
h.get("publishFailedTemplate","\u53d1\u5e03\u5931\u8d25\u7684\u62a5\u8868\u6a21\u677f")};this.getJqUi=function(){if(!Oa){Oa=$("<div>");M=ma();var Ha=$(M.getUI());Oa.append(Ha)}return Oa}}nb.call(this,c,l);var b=this.protectedMethod,a=this,d,t,y,z,p,Q,J=!1,U=[],O=!1,v=!1,A={},K=0,xa=!1,fa={},da={},B=[],D={},T={},la=!1;this.setShowPublishResult=function(H){la=H};this.getPathSelector=function(){return D};this.getCopyPath=function(){return Q};this.setCopyPath=function(H){Q=H};this.setPublishSuccessCount=
function(H){K=H};this.setVerifyModel=function(H){fa={};if(H&&0<H.length)for(var M=0;M<H.length;M++){var ma=H[M].getPublishSourceName();fa[ma]=H[M]}};this.setLockedByOtherTemplate=function(H){da={};if(!H||0!=H.length)for(var M=0;M<H.length;M++)da[H[M]]=!0};this.setPublishContexts=function(H){U=[];A={};if(H&&0<H.length)for(var M=0;M<H.length;M++){var ma=a.protectedConvertPublishModel(H[M]);ma.setSpaceID(H[M].getSpaceID());U.push(ma);A[H[M].getPublishSourceName()]=H[M]}};this.updateDataForPublishResult=
function(H,M){var ma=O;O=!1;v=ma==O;K=M;fa={};da={};B=[];if(H&&0==H.length)xa=!1,U=[],A={};else{M={};for(var Oa=0;Oa<H.length;Oa++){var Ha=H[Oa].getPublishSourceName();M[Ha]=A[Ha];H[Oa].isLockedByOther()?da[Ha]=!0:(B.push(Ha),fa[Ha]=H[Oa])}H=[];for(Oa=0;Oa<U.length;Oa++)M[U[Oa].getPublishSourceName()]&&H.push(U[Oa]);U=H;A=M;0<B.length&&0<Object.keys(da).length&&(O=!0);xa=0==B.length;v=ma!=O}};this.getPublishContexts=function(){return A};this.getPublishContext=function(H){return A[H]};this.getPublishModels=
function(){for(var H=[],M=0;M<U.length;M++)!1!==da[U[M].getPublishSourceName()]&&H.push(U[M]);return H};this.protectedOpenPublishManager=function(){throw Error("overwrite me.");};this.protectedCreatePathSelector=function(){throw Error("overwrite me.");};this.protectedLoadDataBeforeInit=function(H,M){M&&setTimeout(function(){M()},0)};this.getJqUi=function(H){d&&!H||oa();return d};var oa=function(){d=$("<div>");z=$("<span>");z.addClass("qing-publish-batch-tips");d.append(z);t=$("<div>");t.addClass("qing-publish-batch-content");
d.append(t);a.protectedLoadDataBeforeInit(d,function(){J=!0;a.updateUI()})},ra=function(){var H=Ea.createTable(),M=new g(H);M.setOutsideVisible(!1);H.setCellRender(M);H.setColumnFitVisibleWidth(!0);H.setDraggableAdjusting(!0,Ea.getHeadRowCount(),0,b.getCustomExpendor());Ea.bindTableListenerForCtrl(H,function(Oa,Ha,ya,ab){!(ya<Ea.getHeadRowCount()||6==ab)&&(p&&p.css("visibility","hidden"),Ha&&(Oa=$(H.getUI()),ya=KTableUIAbstractView.createCellId(H.getRow(ya),H.getColumn(6)),ya=Oa.find("#"+ya+" .publish-batch-copy-path-cell-ctrl")))&&
(ya.css("visibility","visible"),p=ya)});H.addColumns(7);H.getColumn(0).setWidth(25);H.getColumn(1).setWidth(25);H.getColumn(2).setWidth(140);H.getColumn(3).setWidth(180);H.getColumn(4).setWidth(200);H.getColumn(5).setWidth(110);H.getColumn(6).setWidth(140);M=Ea.createHeadRow(H);M.getCell(1).setValue("#");M.getCell(2).setValue(h.get("reportTemplate","\u62a5\u8868\u6a21\u677f"));M.getCell(3).setValue(h.get("publishName","\u53d1\u5e03\u540d\u79f0"));M.getCell(4).setValue(h.get("publishPath","\u53d1\u5e03\u8def\u5f84"));
M.getCell(5).setValue(h.get("operate","\u64cd\u4f5c"));M=M.getCell(1);var ma=new KTStyle;ma.setTextAlign("left");M.setStyle(ma);ma=new KTBorderStyle;ma.setBorderWidth(0);M.setBorder(ma);return H};this.updateUI=function(){if(d&&J){var H=Object.keys(da),M=0,ma=H.length,Oa=B.length;if(la){if(0<ma||0<Oa){var Ha=h.get("publishResult","\u6210\u529f\u53d1\u5e03#1\u4e2a\u62a5\u8868\u3002\u4ee5\u4e0b\u62a5\u8868\u6a21\u677f\u53d1\u5e03\u5931\u8d25\uff0c\u5931\u8d25\u539f\u56e0\u4e3a\uff1a#2\uff0c\u8bf7\u5904\u7406\u3002").replace("#1",
K);var ya="";O?(ya=1==ma?ya+h.get("lockedByOtherWhenPublishOne","\u201c#1\u201d\u62a5\u8868\u6a21\u677f\u5728\u53d1\u5e03\u65f6\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff1b").replace("#1",H[0]):ya+h.get("lockedByOtherWhenPublish","\u201c#1\u201d\u7b49#2\u4e2a\u62a5\u8868\u6a21\u677f\u5728\u53d1\u5e03\u65f6\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff1b").replace("#1",H[0]).replace("#2",ma),ya=1==Oa?ya+h.get("nameExistWithPath","\u201c#1\u201d\u62a5\u8868\u6a21\u677f\u5728\u5176\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0").replace("#1",
B[0]):ya+h.get("namesExistWithPath","\u201c#1\u201d\u7b49#2\u4e2a\u62a5\u8868\u6a21\u677f\u5728\u5176\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0").replace("#1",B[0]).replace("#2",Oa),M+=20):0<H.length?ya=h.get("templateLockedByOther","\u62a5\u8868\u6a21\u677f\u5728\u53d1\u5e03\u65f6\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a"):0<B.length&&(ya=h.get("publishNameExist","\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0"));
Ha=Ha.replace("#2",ya)}}else 0<ma&&(Ha=1==ma?h.get("filterLockedTemplate","\u201c#1\u201d\u62a5\u8868\u6a21\u677f\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u53d1\u5e03\uff0c\u5df2\u81ea\u52a8\u8fc7\u6ee4\u4e0d\u80fd\u53d1\u5e03\u7684\u62a5\u8868\u6a21\u677f\u3002").replace("#1",H[0]):h.get("filterLockedTemplates","\u201c#1\u201d\u7b49#2\u4e2a\u62a5\u8868\u6a21\u677f\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u53d1\u5e03\uff0c\u5df2\u81ea\u52a8\u8fc7\u6ee4\u4e0d\u80fd\u53d1\u5e03\u7684\u62a5\u8868\u6a21\u677f\u3002").replace("#1",
H[0]).replace("#2",ma));Ha?(M+=30,z.text(Ha),z.show()):z&&z.hide();ja.layoutCtrlWithLRTB(t,0,0,null,M,0,null);v&&t.empty();0==t.children().length&&(O?(H=new pa,H.setTabLevel(pa.SECOND_LEVEL),H.addTabChangedListener(function(ab,Ya){xa=Ya.isLockedByOther();y=Ya.getPublishTable();qa()}),Ha=new k(!1),H.addTab(Ha),Ha.setPublishTableCreator(ra),M=new k(!0),H.addTab(M),M.setPublishTableCreator(ra),M=H.getJqUi(),t.append(M),H.setCurrentTabPane(Ha)):(y=ra(),H=$(y.getUI()),t.append(H)));qa()}};var qa=function(){Ea.clearWithoutHead(y);
D={};T={};for(var H=1,M=Object.keys(da),ma=0;ma<U.length;ma++){var Oa=U[ma].getPublishSourceName(),Ha=-1!=M.indexOf(Oa);O&&xa^Ha||(Ha=Ea.createRow(y),Ha.setUserObject(U[ma]),Ha.getCell(2).setValue(Oa),Ha.getCell(1).setValue(H),H++)}y.getColumn(5).setHide(!xa);Ea.refresh(y)};this.protectedGetAnalysisSchemaArray=function(H){throw Error("Override me.");};this.protectedConvertPublishModel=function(H){throw Error("Override me.");};var Ka=function(H,M){if(2301005==H)return h.get("publishNoCascadePermission",
"\u60a8\u6ca1\u6709\u8be5\u8bb0\u5f55\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u201c#1\u201d\u68c0\u67e5\u6388\u6743\u3002").replace("#1",M);if(2301006==H)return h.get("publishSourcePublishNotExistException","\u539f\u53d1\u5e03\u4fe1\u606f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");if(2301007==H)return h.get("publishSourceSubjectNotExist","\u539f\u4e1a\u52a1\u4e3b\u9898\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");if(2301008==H)return h.get("publishSourceDashboardNotExist",
"\u539f\u4eea\u8868\u677f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");if(2301009==H||2301002==H)return h.get("publishUpdateSameSourceNameDuplicate","\u53d1\u5e03\u8def\u5f84\u4e0b\u5df2\u5b58\u5728\u76f8\u540c\u7684\u53d1\u5e03\u540d\u79f0\u3002");if(2301010==H)return h.get("qingFileStorageLimit","\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002");if(2301011==H)return h.get("batchPublishExtReportNotExist","\u90e8\u5206\u539f\u62a5\u8868\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");
if(2300001==H)return h.get("qingStorageNoSpace","\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u4eba\u5458\u6dfb\u52a0\u78c1\u76d8\u3002");if(2301013==H)return h.get("mapNotFound","\u627e\u4e0d\u5230\u5f15\u7528\u7684\u5730\u56fe\u6a21\u677f\uff0c\u65e0\u6cd5\u53d1\u5e03\u3002");if(2301014==H)return h.get("publishCascadeMaxLimit","\u6700\u5927\u53d1\u5e03\u5c42\u7ea7\u4e0d\u80fd\u8d85\u8fc7#1\u5c42\u3002").replace("#1",M);if(2301016==H)return h.get("publishNoOperAuthException",
"\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002")};this.batchSavePublishInfos=function(H,M,ma){if(U&&0!=U.length){for(var Oa=[],Ha=[],ya=[],ab=0;ab<U.length;ab++){var Ya=U[ab],$a=A[Ya.getPublishSourceName()],tb=$a.getDsbPublishId(),ha=$a.getRefToId();tb&&ha?Ya.setPublishSourceFId(ha):Ya.setPublishSourceFId($a.getBizTag());ha=Ya.getId();Ya.setId(null);var ua=$a.getWidgetsExecutingTag();Ya.setWidgetsExecutingTag(ua);Ya=[];ua=a.protectedGetAnalysisSchemaArray($a);if(null!=ua)for(ab=0;ab<ua.length;ab++)Ya.push(ua[ab].toJsonObject());
else Ya.push($a.getCurrentContentModel());Oa.push(JSON.stringify(Ya));Ha.push(ha);ya.push(tb)}b.createFacade(function(Da){var eb=[],r=U.length;if(Da&&0<Da.length)for(var Y=0;Y<Da.length;Y++){var e=new hb;e.fromJsonObject(Da[Y]);eb.push(e);r--}M&&M(eb,r)},function(Da,eb){eb=Ka(Da,eb);Da=!1;eb&&(b.getOuterMessageCurtain().showPrompt(eb,2E3),Da=!0);ma&&ma();return Da}).batchSavePublishInfos(U,Oa,Ha,ya,l,H)}else M&&M([],0)};this.checkPublishModel=function(H,M,ma){if(H&&0!=H.length){for(var Oa=[],Ha={},
ya=0;ya<H.length;ya++){var ab=H[ya].getName(),Ya=H[ya].getPath(),$a=ab+"|"+Ya,tb=new hb,ha=!1;ab?Ya?Ha[$a]&&(tb.setSameInputTemplateName(Ha[$a]),ha=!0):(tb.setPathEmpty(!0),ha=!0):(tb.setNameEmpty(!0),ha=!0);ha?(tb.setPublishSourceName(H[ya].getPublishSourceName()),Oa.push(tb)):Ha[$a]=H[ya].getPublishSourceName()}0<Oa.length?M&&M(Oa):b.createFacade(function(ua){if(ua&&0<ua.length)for(var Da=0;Da<ua.length;Da++){var eb=new hb;eb.fromJsonObject(ua[Da]);Oa.push(eb)}M&&M(Oa)},function(ua,Da){ma&&ma(ua,
Da);return!1}).verifyPublishName(H)}else M([])}};m.AbstractPublishPathSelector=function(){var c;this.setSelectedListener=function(l){c=l};this.getSelectedListener=function(){return c};this.setSelectedPath=function(l){throw Error("overwrite me.");};this.getSelectedPath=function(){throw Error("overwrite me.");};this.getJqUi=function(){throw Error("overwrite me.");}};var Qa,Na,Xa,pb,Ba,Cb,h,ja,gb,Ea,bb,wb,ub,Jb,lb,Eb,Hb,yb,cb,Ab,Sa,hb,Ua,ea,Ca,S,Z,G,F,P,n,w,C,f,V,W,za,va,pa,Ja,ca,wa,na,Ia,aa,X,E,I,R,
u;(function(){var c=com.kingdee.bos.qing;Qa=c.Seer;c=com.kingdee.bos.qing.ui.component;Na=c.Icons;Xa=c.List;pb=c.MessageDialog;Ba=c.TextField;Cb=c.WorkButton;gb=c.Tree;Z=c.AbstractModalDialog;G=c.WizardDialog;F=c.Menu;P=c.MenuModel;n=c.CheckBox;w=c.RadioButton;C=c.ComboBox;f=c.SearchBox;W=c.DropdownSelector;R=c.RadioButtonGroup;pa=c.TabContainer;Ja=c.Button;ca=c.Dialog;wa=c.Label;na=c.SwitchButton;Ia=c.HelpIcon;aa=c.SplitPane;c=com.kingdee.bos.qing.framework.common;h=c.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.publish);
c=com.kingdee.bos.qing.common;ja=c.DomUtil;X=c.DateFormater;c=com.kingdee.bos.qing.common.ui;Ea=c.TableUtil;za=c.CommonIconUtil;va=c.AbstractLeftRightSelector;c=com.kingdee.bos.qing.publish.model;bb=c.PublishSourceType;E=c.PublishTargetType;wb=c.PublishModel;ub=c.FolderNode;Jb=c.PushTargetType;lb=c.OperCodeType;Eb=c.OCarryDataType;Hb=c.OperCodeMap;yb=c.OperType;cb=c.PublishOperModel;Ab=c.PublishVO;Sa=c.PublishContainerType;hb=c.VerifyModel;c=com.kingdee.bos.qing.publish.common;V=c.AbstractPublishItem;
c=com.kingdee.bos.qing;I=c.CodeLoader;c=com.kingdee.bos.qing.biz.common;Ua=c.ValueTextPair;c=com.kingdee.bos.qing.schemamanage.model;ea=c.SchemaAttrModel;Ca=c.SchemaModel;c=com.kingdee.bos.qing.schemamanage.ui;S=c.List;c=com.kingdee.bos.qing.publish.permission;u=c.PublishPermissionConfigPane})();Aa.UPDATE_NAME=0;Aa.UPDATE_PATH=1;Aa.UPDATE_USER=2;Aa.UPDATE_ROLE=3;Aa.UPDATE_SCHEME=4;Aa.UPDATE_ANALYSIS=5;Aa.UPDATE_ALL=6;Aa.UPDATE_NOSCHEME=7;Aa.UPDATE_USER_AND_ROLE=9;Aa.UPDATE_CREATETIME=10;Aa.UPDATE_PERM_LABEL=
11;Aa.UPDATE_AUTH_TARGET=12;var N=function(c){switch(c){case E.APPMENU:return h.get("appMenu","\u5e94\u7528\u83dc\u5355");case E.CENTER:return h.get("qingAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939");case E.MOBILE:return h.get("lapp","\u79fb\u52a8\u8f7b\u5e94\u7528");case E.CARD_REPOSITORY:return h.get("cardRepository","\u5361\u7247\u5e93");default:return""}};m.PublishAdvancePanelFactory.addPublishAdvancePanel(m.PublishAdvanceViewType.DSB_VIEW,Ib);m.PublishAdvancePanelFactory.addPublishAdvancePanel(m.PublishAdvanceViewType.LONGER_VIEW,
function(c,l){Db.call(this,c,l);var g=this,k=this.protectedMethod;this.initUi=function(){var b=$("<div>");b.addClass("sa-qing-publish-advance-set-ui");b.hide();k.createOperPerLabelUI(b);var a=[],d=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_EDITABLE,k.getOperLevelType().CHILDREN);a.push(d);d=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_EXPORT,k.getOperLevelType().CHILDREN);a.push(d);d=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_PRINT,k.getOperLevelType().CHILDREN);a.push(d);g.getTimedPush()||
(d=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_PUBLISH,k.getOperLevelType().CHILDREN),a.push(d),d=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_TIMEPUSH,k.getOperLevelType().CHILDREN),a.push(d));d=k.createPublishOperModel(yb.LONGER,lb.ANALYSIS_DETAIL,k.getOperLevelType().CHILDREN);a.push(d);a=k.createOperSelectedUi(20,a);ja.layoutCtrl(a,40,23,350,220);a.appendTo(b);k.updateAdavanceSetUi()&&(a=k.createHelpIcon(b),ja.layoutCtrl(a,105,3,16,16),a.appendTo(b));return b}});m.PublishAdvancePanelFactory.addPublishAdvancePanel(m.PublishAdvanceViewType.SQUARE_VIEW,
function(c,l){Db.call(this,c,l);var g=this.protectedMethod;this.initUi=function(){var k=$("<div>");k.addClass("sa-qing-publish-advance-set-ui");k.hide();g.createOperPerLabelUI(k);var b=23,a=[],d=g.createPublishOperModel(yb.SQUARE,lb.ENTRY_SQUARE,g.getOperLevelType().PARENT);a.push(d);d=g.createPublishOperModel(yb.SQUARE,lb.CARD_PUBLISH,g.getOperLevelType().CHILDREN);a.push(d);d=g.createPublishOperModel(yb.SQUARE,lb.CARD_TIMEPUSH,g.getOperLevelType().CHILDREN);a.push(d);d=g.createOperSelectedUi(20,
a);ja.layoutCtrl(d,40,b,350,23*a.length);d.appendTo(k);b+=23*a.length;a=[];d=g.createPublishOperModel(yb.LONGER,lb.ENTRY_ANALYSIS,g.getOperLevelType().PARENT);a.push(d);d=g.createPublishOperModel(yb.LONGER,lb.ANALYSIS_EDITABLE,g.getOperLevelType().CHILDREN);a.push(d);d=g.createPublishOperModel(yb.LONGER,lb.ANALYSIS_EXPORT,g.getOperLevelType().CHILDREN);a.push(d);d=g.createPublishOperModel(yb.LONGER,lb.ANALYSIS_PRINT,g.getOperLevelType().CHILDREN);a.push(d);d=g.createPublishOperModel(yb.LONGER,lb.ANALYSIS_PUBLISH,
g.getOperLevelType().CHILDREN);a.push(d);d=g.createPublishOperModel(yb.LONGER,lb.ANALYSIS_TIMEPUSH,g.getOperLevelType().CHILDREN);a.push(d);d=g.createPublishOperModel(yb.LONGER,lb.ANALYSIS_DETAIL,g.getOperLevelType().CHILDREN);a.push(d);d=g.createOperSelectedUi(20,a);ja.layoutCtrl(d,40,b+6,350,23*a.length);d.appendTo(k);g.updateAdavanceSetUi()&&(b=g.createHelpIcon(k),ja.layoutCtrl(b,105,3,16,16),b.appendTo(k));return k}});m.PublishAdvancePanelFactory.addPublishAdvancePanel(m.PublishAdvanceViewType.QING_RPT_VIEW,
function(c,l){Db.call(this,c,l);var g=this.protectedMethod;this.initUi=function(){var k=$("<div>");k.addClass("sa-qing-publish-advance-set-ui");k.hide();g.createOperPerLabelUI(k);var b=[],a=g.createPublishOperModel(yb.QING_RPT,lb.RPT_EXPORT,g.getOperLevelType().CHILDREN);b.push(a);a=g.createPublishOperModel(yb.QING_RPT,lb.RPT_PRINT,g.getOperLevelType().CHILDREN);b.push(a);a=g.createPublishOperModel(yb.QING_RPT,lb.RPT_SAVE_SNAPSHOT,g.getOperLevelType().CHILDREN);b.push(a);b=g.createOperSelectedUi(20,
b);ja.layoutCtrl(b,40,23,350,220);b.appendTo(k);g.updateAdavanceSetUi()&&(b=g.createHelpIcon(k),ja.layoutCtrl(b,105,3,16,16),b.appendTo(k));return k}});Gb.Selector_LEFT_CONTAINER_MARK="leftList";Gb.Selector_RIGHT_CONTAINER_MARK="rightList";var ka=new function(){var c;this.getCardFilterType=function(){c||(c=[new ia(h.get("myPublish","\u6211\u7684\u53d1\u5e03"),!1),new ia(h.get("presetPublish","\u9884\u7f6e\u53d1\u5e03"),!0)]);return c}};m.PresetSearchTypeUtil=ka;Ga.SORT_TYPE_DESC=1;Ga.SORT_TYPE_ASC=
2;zb.SELECTED_STYLE_BORDER="BORDER";zb.MUTI_SELECTED_STYLE_SELECTBTN="BUTTON";zb.SINGLE_SELECTED_STYLE_SELECTBTN="SINGLE_BUTTON"})();(function(){function Aa(ea,Ca){La.call(this,ea,gb.APPMENU);var S=this,Z=this.protectedMethod,G,F,P,n,w,C,f,V,W,za={},va,pa,Ja,ca,wa,na,Ia,aa,X,E,I,R=new com.kingdee.bos.qing.biz.common.ComplexPaginationBar,u,N=[new cb(Ma.get("allType","\u5168\u90e8\u7c7b\u578b"),3),new cb(Ma.get("moduleLonger","\u6570\u636e\u5206\u6790"),0),new cb(Ma.get("dashboard","\u4eea\u8868\u677f"),1)],ka=3,c;this.getTitle=function(){return Ma.get("appMenu","\u5e94\u7528\u83dc\u5355")};this.getJqUi=function(){G||(G=l());return G};
this.relayoutViews=function(){w&&w.relayoutViews()};var l=function(){var B=$("<div>");y().appendTo(B);F=$("<div>");F.addClass("sa-qing-publish-manager");var D=$("<div>");D.css("border-right","1px solid #E5E5E5");ib.layoutCtrlWithLRTB(D,5,null,222,0,0,null);c=S.getAutoSelectedData();C=U(F);C.getJqUi().appendTo(D);var T=$("<div>");ib.layoutCtrlWithLRTB(T,229,0,null,0,0,null);u=b();w=O();w.setPaginationBar(R);var la=w.getJqUi(),oa=Ma.get("configPermLabel","\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e");P=da(oa,
function(){var ra=w?w.getSelectedPublish():[];if(ra&&0!=ra.length){var qa=new Ua(ea,gb.APPMENU,Qa.APPMENU);qa.setCallbackAfterSetting(g);var Ka=S.getPublishContext();qa.setSpaceID(Ka.getSpaceID());qa.setPublishModels(ra);qa.showDialog()}else Z.getOuterMessageCurtain().showPrompt(Ma.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))});ib.layoutCtrlWithLRTB(P,null,200,140,8,null,null);n=da(Ma.get("del","\u5220\u9664"),k);ib.layoutCtrlWithLRTB(n,null,145,45,8,null,null);d(!Ca);
u.appendTo(T);P.appendTo(T);n.appendTo(T);la.appendTo(T);u.hide();d(!1);D.appendTo(F);T.appendTo(F);F.appendTo(B);F.find(".sa-qing-publish-manager-content-container").css("top","32px");ib.layoutCtrlWithLRTB(F,0,0,null,41,0,null);return B},g=function(B){if(B&&0!=B.length){var D=Z.createFacade(function(T){a();Z.getOuterMessageCurtain().showSuccess(Ma.get("settingSuccess","\u8bbe\u7f6e\u6210\u529f\u3002"))});D.setShowBlocking(!0);D.updatePublishPermLabel(B)}},k=function(B){if((B=w?w.getSelectedPublish():
[])&&0!=B.length){for(var D=[],T=0;T<B.length;T++)D.push(B[T].getId());B=Eb.createFeedbackDialog();B.setOptionType(Eb.OPTION_OK_CANCEL);B.setMsgImageType(Eb.MSG_DELETE);B.setMessage(Ma.get("publishDeleteTips","\u5220\u9664\u8bb0\u5f55\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f"));B.setClosingChecker(function(la){la==Eb.RETURN_OK&&(la=Z.createFacade(function(oa){a();Z.getOuterMessageCurtain().showSuccess(Ma.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},
function(oa,ra){Z.getOuterMessageCurtain().showPrompt(ra,2E3);return!0}),la.setShowBlocking(!1),la.deletePublishInfos(gb.APPMENU,D));return!0});B.showDialog()}else Z.getOuterMessageCurtain().showPrompt(Ma.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))},b=function(){R.protectedMethod.setTotalSelectedRowAndSelectedAllVisual(!0,!1);R.protectedMethod.setTotalPageVisual(!1);R.protectedMethod.setCurrentPageVisual(!1);R.protectedMethod.setFirstBtnAndEndBtnVisual(!1);R.setJumpToPageListener(function(B,
D,T){var la=Z.createFacade(function(ra){if(void 0===ra.infos||null===ra.infos||0===ra.infos.length)u.hide(),d(!1),T?T(ra.totalRow):R.refreshPagination(),w.setSearchStatus(!1),w.setListPublishModel(null,Ca);else{var qa=ra.infos;I=[];for(var Ka=0;Ka<qa.length;Ka++){var H=new Ea;H.fromJsonObject(qa[Ka]);I.push(H)}u.show();d(!Ca);T?T(ra.totalRow):R.refreshPagination();w.setSearchStatus(!0);w.setListPublishModel(I,Ca);w.updateSearchContentUI(V)}},function(){return!1});la.setShowBlocking(!0);var oa=S.getPublishContext();
la.loadAllPublishInfosByPagination(Ca,Ia,aa,X,E,B,D,V,Ja,wa,na,oa.getSpaceID(),oa.isQingRpt())});R.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);return R.getJqUi()},a=function(){var B=Z.createFacade(function(T){if(void 0===T.infos||null===T.infos||0===T.infos.length)u.hide(),d(!1),R.resetPaginationAndJumpToFirstPage(T.totalRow),w.setSearchStatus(f),w.setListPublishModel(null,Ca,!0);else{R.resetPaginationAndJumpToFirstPage(T.totalRow);T=T.infos;I=[];for(var la=0;la<T.length;la++){var oa=
new Ea;oa.fromJsonObject(T[la]);I.push(oa)}u.show();d(!Ca);w.setSearchStatus(f);w.setListPublishModel(I,Ca,!0);w.updateSearchContentUI(V)}},function(){return!1});B.setShowBlocking(!0);var D=S.getPublishContext();B.loadAllPublishInfosByPagination(Ca,Ia,aa,X,E,1,R.getPageSize(),V,Ja,wa,na,D.getSpaceID(),D.isQingRpt())},d=function(B){B?(P.show(),n.show()):(P.hide(),n.hide())},t=function(){var B=Z.createFacade(function(T){for(var la=0;la<W.length;la++){var oa=J(W[la]);oa&&(za[oa]=[])}for(var ra in za)T[ra]||
(T[ra]=0);C.setSearchStatus(f);C.setDefaultItemValue(pa);C.updateTreeSearchUI(W,T)},function(){return!1});B.setShowBlocking(!0);var D=S.getPublishContext();B.loadHitNumberOfAllPath(Ca,V,Ja,D.getSpaceID(),D.isQingRpt())},y=function(){var B=$("<div class='sa-qing-publish-titlebar'>");if(!S.getPublishContext().isQingRpt()){var D=z,T=new yb;T.setSearchType(N);T.setSelectedChangedListener(D);T.getJqUi().appendTo(B)}D=new Ab;D.setSearchListener(Q);va=D;va.getJqUi().appendTo(B);D=new zb;D.setSortModel(p);
ca=D;ca.getJqUi().appendTo(B);return B},z=function(B,D,T){ka=T.getTypeId();3==ka?Ja=void 0:1==ka?Ja="dashboard":0==ka?Ja="moduleLonger":2==ka&&(Ja="extreport");Q()},p=function(B,D){wa=B.getPropertyName();na=D==Hb.SORT_TYPE_ASC?"ASC":"DESC";Q()},Q=function(){V=va.getInputContent().trim();0<V.length?(f=!0,V=V.toUpperCase(),t()):(f=!1,C.setSearchStatus(f),C.setDefaultItemValue(pa),C.rollBackSearchStatus())},J=function(B){var D=B.getCloudId();B.getAppId()&&(D+=B.getAppId(),B.getAppMenuId()&&(D+=B.getAppMenuId(),
B.getAppMenuId2()&&(D+=B.getAppMenuId2())));return D},U=function(B){B=new Va(B);B.setTreeItemSelectedListener(K);B.setLoadItemListener(v);c&&B.setAutoSelectedData(c);return B},O=function(){var B=new ob;B.setOuterMessageCurtain(Z.getOuterMessageCurtain());B.setDeletePublishListener(fa);B.setEditPublishListener(xa);B.setTabType(1);B.setTipsText(Ma.get("appMenuClickTips","\u8bf7\u70b9\u51fb\u5de6\u4fa7\u83dc\u5355\u8fdb\u884c\u67e5\u770b"));B.setEditPublishContentListenter(S.getPublishContentEditEntrance());
B.setLoadAppMenuContentListener(v);B.setReSearchListener(Q);B.setRemoteImpl(ea);return B},v=function(){var B=Z.createFacade(function(D){var T=new kb;T.fromJsonObject(D);D=T.getChildren();W=[];for(T=0;T<D.length;T++)A(W,D[T]);C.setTreeNodeList(W)},function(D,T){return 2313E3<D&&2313999>=D?(Z.getOuterMessageCurtain().showPrompt(T,2E3),!0):!1});B.setShowBlocking(!0);B.getAppMenuTree(S.getPublishContext().getSpaceID(),Ca)},A=function(B,D){B.push(D);if(D instanceof kb&&(D=D.getChildren()))for(var T=0;T<
D.length;T++)A(B,D[T])},K=function(B){Ia=B.getCloudId();aa=B.getAppId();X=B.getAppMenuId();E=B.getAppMenuId2();null==c&&w&&w.setAutoSelectedModel(null);pa=B;J(B);a()},xa=function(B,D){var T=S.getPublishContext();B=ba.createPublishToEditDialog(ea,T,B);B.addSuccessCallback(D);B.setOuterMessageCurtain(Z.getOuterMessageCurtain());B.setEditPublishInfo(!0);B.showDialog()},fa=function(B,D){B=B.getId();var T=Z.createFacade(function(la){D();Z.getOuterMessageCurtain().showSuccess(Ma.get("deleteSuccessCurtain",
"\u5220\u9664\u6210\u529f\u3002"))},function(la,oa){Z.getOuterMessageCurtain().showPrompt(oa,2E3);return!0});T.setShowBlocking(!1);T.deletePublishInfo(gb.APPMENU,B)},da=function(B,D){var T=$("<span>");T.text(B);T.attr("title",B);T.addClass("sa-qing-publish-workbutton");T.addClass("qing-publish-ellipsis-text");if(D)T.on("click",D);return T}}function Va(ea){function Ca(u){KTDefaultCellRender.call(this,u);var N=this;this.paintCellUI=function(l,g){var k=N.getCell(),b=k.getValue();k=ka(b,k);g?(l=$(g),
k.appendTo(l)):(l=$(l),k.appendTo(l))};var ka=function(l,g){var k=l.getDisplayName(),b=$("<div>");b.addClass("sa-qing-publish-menu-item");var a=$("<span>"),d=bb.createWarning();ib.layoutCtrl(d,0,12);k==Pa.CLOUD_HAS_BEEN_DELETED?(k=Ma.get("cloudHasBeenDeleted","\u8be5\u670d\u52a1\u4e91\u5df2\u88ab\u5220\u9664"),a.css({"margin-left":"10px"}),b.append(d)):k==Pa.APP_HAS_BEEN_DELETED?(k=Ma.get("appHasBeenDeleted","\u8be5\u5e94\u7528\u5df2\u88ab\u5220\u9664"),a.css({"margin-left":"10px"}),b.append(d)):
k==Pa.APP_MENU_HAS_BEEN_DELETED&&(k=Ma.get("appMenuHasBeenDeleted","\u8be5\u5e94\u7528\u83dc\u5355\u5df2\u88ab\u5220\u9664"),a.css({"margin-left":"10px"}),b.append(d));b.attr("title",k);d.attr("title",k);a.text(k);0<l.getSubNodeLevel()&&(b.css("cursor","pointer"),g.getUserObject()&&b.addClass("sa-qing-publish-menu-item-selected"),b.on("mousedown",function(t){X(l,b,g)}),V&&I(V,l,b,g),w&&R(w,l,b,g));b.append(a);C&&0<l.getSubNodeLevel()&&(d="("+f[E(l)]+")",b.attr("title",k+" "+d),c(a,b,d,f[E(l)]));ib.layoutCtrlWithLRTB(b,
0,0,null,0,0,null);return b},c=function(l,g,k,b){var a=$("<div class='sa-qing-publish-manager-App-menu-Search-Number'>");a.text(k);a.title=k;a.appendTo(l);0<b&&(b=$("<div class='sa-qing-publish-manager-App-menu-Search-Number-with-color'>"),b.text(k),b.appendTo(l),a.hide(),b.show(),"sa-qing-publish-menu-item sa-qing-publish-menu-item-selected"==g[0].className&&(a.show(),b.hide()))}}var S,Z,G,F,P,n,w,C=!1,f={},V,W,za=!1,va;this.setAutoSelectedData=function(u){(n=u)&&n.path&&(w=JSON.parse(n.path))};
this.setDefaultItemValue=function(u){V=u};this.setTreeItemSelectedListener=function(u){S=u};this.setLoadItemListener=function(u){P=u};this.setTreeNodeList=function(u){F=u;Z&&Ia()};this.getJqUi=function(){if(!Z){var u=$("<div>");G=pa();G.text(Ma.get("loading","\u52a0\u8f7d\u4e2d"));G.appendTo(u);Ja();Z=u}return Z};var pa=function(){G||(G=$("<div>"),G.addClass("sa-qing-publish-manager-content-emptytip"));return G},Ja=function(){F||P(function(u){F=u;Ia()})},ca,wa,na=function(u){wa=ca=null;ca=new KTable;
wa=$(ca.getUI());wa.children().css("overflow-x","hidden");ca.setCellRender(new Ca(ca));ca.setSyncUIWhenModelChanged(!1);ca.addColumn().setWidth(225);var N=new KTStyle;N.setVerticalAlign("middle");ca.setStyle(N);N=ca;for(var ka=0;ka<u.length;ka++){var c=u[ka],l=N.addRow();l.setHeight(32);var g=l.getCell(0);g.setValue(c);var k=c.getSubNodeLevel();k=new KTCellTreeModel(k);za||(0<k.getLevel()?(k.setExpanded(!1),1<k.getLevel()&&l.setHide(!0)):k.setExpanded(!0));C&&(za=!0,k.setExpanded(!0));g.setTreeModel(k);
if(V){g=V;var b=c,a=k,d=l;g.getCloudId()?g.getCloudId()==b.getCloudId()&&(a.setExpanded(!0),d.setHide(!1)):g.getAppId()?g.getAppId()==b.getAppId()&&(a.setExpanded(!0),d.setHide(!1)):g.getAppMenuId()?g.getAppMenuId()==b.getAppMenuId()&&(a.setExpanded(!0),d.setHide(!1)):g.getAppMenuId2()&&g.getAppMenuId2()==b.getAppMenuId2()&&(a.setExpanded(!0),d.setHide(!1))}w&&(g=w,g.cloudId?g.cloudId==c.getCloudId()&&(k.setExpanded(!0),l.setHide(!1),va=l):g.appId?g.appId==c.getAppId()&&(k.setExpanded(!0),l.setHide(!1),
va=l):g.appMenuId?g.appMenuId==c.getAppMenuId()&&(k.setExpanded(!0),l.setHide(!1),va=l):g.appMenuId2&&g.appMenuId2==c.getAppMenuId2()&&(k.setExpanded(!0),l.setHide(!1),va=l))}ca.updateUI();return wa};this.rollBackSearchStatus=function(){Z.find(".sa-qing-publish-manager-App-menu-Search-Number").remove();Z.find(".sa-qing-publish-manager-App-menu-Search-Number-with-color").remove();for(var u=Z.find(".sa-qing-publish-menu-item"),N=0;N<u.length;N++)$(u[N]).attr("title",u[N].textContent);V&&S&&S(V)};var Ia=
function(){if(F&&0<F.length)Z.empty(),na(F).appendTo(Z);else{ea.empty();ea.css({"margin-top":"32px"});G=pa();G.text(Ma.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55"));G.appendTo(ea);var u=$("<div>");sa.background(u,"no-data");u.addClass("sa-qing-publish-no-data-tips");u.appendTo(ea)}};this.setSearchStatus=function(u){C=u};this.updateTreeSearchUI=function(u,N){f=N;Z.empty();u&&0<u.length?na(u).appendTo(Z):(G=pa(),G.text(Ma.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55")),G.appendTo(Z))};
var aa,X=function(u,N,ka){if(aa!=ka){Z.find(".sa-qing-publish-menu-item-selected").removeClass("sa-qing-publish-menu-item-selected");N.addClass("sa-qing-publish-menu-item-selected");if(C){if(W){var c=W.find(".sa-qing-publish-manager-App-menu-Search-Number");0<parseInt(c.text().substring(1,c.text().length-1))&&(W.find(".sa-qing-publish-manager-App-menu-Search-Number").hide(),W.find(".sa-qing-publish-manager-App-menu-Search-Number-with-color").show())}N.find(".sa-qing-publish-manager-App-menu-Search-Number").show();
N.find(".sa-qing-publish-manager-App-menu-Search-Number-with-color").hide()}aa&&aa.setUserObject(!1);ka.setUserObject(!0);aa=ka;V=u;W=N;S&&S(u)}};this.scrollSelectedToVisible=function(){va&&ca.scrollCellVisible(ca.getRowIndex(va),0,!1)};var E=function(u){var N=u.getCloudId();u.getAppId()&&(N+=u.getAppId(),u.getAppMenuId()&&(N+=u.getAppMenuId(),u.getAppMenuId2()&&(N+=u.getAppMenuId2())));return N},I=function(u,N,ka,c){u.getAppMenuId2()?u.getAppMenuId2()==N.getAppMenuId2()&&X(N,ka,c):u.getAppMenuId()?
u.getAppMenuId()!=N.getAppMenuId()||N.getAppMenuId2()||X(N,ka,c):u.getAppId()&&(u.getAppId()!=N.getAppId()||N.getAppMenuId()||X(N,ka,c))},R=function(u,N,ka,c){u.appMenuId2?u.appMenuId2==N.getAppMenuId2()&&X(N,ka,c):u.appMenuId?u.appMenuId!=N.getAppMenuId()||N.getAppMenuId2()||X(N,ka,c):u.appId&&(u.appId!=N.getAppId()||N.getAppMenuId()||X(N,ka,c))}}function Pa(){var ea,Ca,S,Z,G,F,P,n;this.setIsShow=function(w){n=w};this.getIsShow=function(){return n};this.setCloudId=function(w){ea=w};this.getCloudId=
function(){return ea};this.setAppId=function(w){Ca=w};this.getAppId=function(){return Ca};this.setAppMenuId=function(w){S=w};this.getAppMenuId=function(){return S};this.setAppMenuId2=function(w){F=w};this.getAppMenuId2=function(){return F};this.setDisplayName=function(w){Z=w};this.getDisplayName=function(){return Z};this.setParentNode=function(w){G=w};this.getParentNode=function(){return G};this.setPublishModels=function(w){P=w};this.getPublishModels=function(){return P};this.getSubNodeLevel=function(){for(var w=
-1,C=G;C;)w++,C=C.getParentNode();return w}}function kb(){Pa.call(this);var ea=this,Ca=[];this.setChildren=function(S){Ca=S};this.getChildren=function(){return Ca};this.toJsonObject=function(){var S={};S.children=Ca;return S};this.fromJsonObject=function(S){ea.setDisplayName(S.displayName);ea.setCloudId(S.cloudId);S.appId&&ea.setAppId(S.appId);S.appMenuId&&ea.setAppMenuId(S.appMenuId);S.appMenuId2&&ea.setAppMenuId2(S.appMenuId2);if(S=S.children)for(var Z=0;Z<S.length;Z++){var G=S[Z];if(G.type){var F=
new fb;F.fromJsonObject(G);F.setParentNode(ea);Ca.push(F)}else F=new kb,F.fromJsonObject(G),F.setParentNode(ea),Ca.push(F)}}}function fb(){Pa.call(this);var ea=this,Ca;this.setType=function(S){Ca=S};this.getType=function(){return Ca};this.fromJsonObject=function(S){ea.setType(S.type);ea.setDisplayName(S.displayName);ea.setCloudId(S.cloudId);S.appId&&ea.setAppId(S.appId);S.appMenuId&&ea.setAppMenuId(S.appMenuId);S.appMenuId2&&ea.setAppMenuId2(S.appMenuId2)}}function nb(){db.call(this);var ea=this,
Ca,S,Z;this.protectedClickEvent=function(){G()};this.setSelectedValue=function(F){Ca=F;ea.updateUI()};this.getSelectedValue=function(){return Ca};this.getDisplayText=function(){var F=Ma.get("selectPublishPath","\u8bf7\u9009\u62e9\u53d1\u5e03\u8def\u5f84");Ca&&(F=Ca.getText(),F=F.replace(Pa.CLOUD_HAS_BEEN_DELETED,Ma.get("cloudHasBeenDeleted","\u8be5\u670d\u52a1\u4e91\u5df2\u88ab\u5220\u9664")),F=F.replace(Pa.APP_HAS_BEEN_DELETED,Ma.get("appHasBeenDeleted","\u8be5\u5e94\u7528\u5df2\u88ab\u5220\u9664")),
F=F.replace(Pa.APP_MENU_HAS_BEEN_DELETED,Ma.get("appMenuHasBeenDeleted","\u8be5\u5e94\u7528\u83dc\u5355\u5df2\u88ab\u5220\u9664")));return F};this.setSelectedListener=function(F){Z=F};var G=function(){var F=wb;F.setCallBack(function(P){if(P&&P.content){var n=P.content;S=n.cloudName+"/"+n.appName+"/";n.appMenuId&&(S+=n.appMenuName+"/");n.appMenuId2&&(S+=n.appMenuName2+"/");S&&S.endsWith("/")&&(S=S.substring(0,S.length-1));P=new ja;var w=P.setValue,C={};C.cloudId=n.cloudId;C.cloudNumber=n.cloudNumber;
C.appId=n.appId;C.appNumber=n.appNumber;n.appMenuId&&(C.appMenuId=n.appMenuId,C.appMenuNumber=n.appMenuNumber);n.appMenuId2&&(C.appMenuId2=n.appMenuId2,C.appMenuNumber2=n.appMenuNumber2);n=JSON.stringify(C);w.call(P,n);P.setText(S);Ca=P;ea.updateUI();Z&&Z(ea,Ca)}});F.openAppMenuForm()}}function Db(){Xa.call(this);var ea=this,Ca,S;this.setSelectedPath=function(Z){S=Z;Ca&&(Ca.setSelectedValue(S),(Z=ea.getSelectedListener())&&Z(S))};this.getSelectedPath=function(){return S};this.getJqUi=function(){Ca||
(Ca=new nb,Ca.setSelectedListener(function(Z,G){(Z=ea.getSelectedListener())&&Z(G);S=G}),Ca.setSelectedValue(S));return Ca.getJqUi()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&(com.kingdee.bos.qing.publish={});"undefined"==typeof com.kingdee.bos.qing.publish.env&&(com.kingdee.bos.qing.publish.env=
{});var Ib=com.kingdee.bos.qing.publish.env;Ib.PublishAppMenuFolderNode=kb;Ib.PublishAppMenuLeafNode=fb;Ib.AbstractPublishAppMenuNode=Pa;var ib,Gb,qb,Ma,Ga,db,ba,ia,La,Wa,ob,zb,sa,m,Qa,Na,Xa,pb,Ba,Cb,h,ja,gb,Ea,bb,wb,ub,Jb,lb,Eb,Hb,yb,cb,Ab,Sa,hb,Ua;(function(){var ea=com.kingdee.bos.qing.common;ib=ea.DomUtil;Gb=ea.Util;ea=com.kingdee.bos.qing;qb=ea.CodeLoader;ea=com.kingdee.bos.qing.common.ui;bb=ea.CommonIconUtil;ea=com.kingdee.bos.qing.framework.common;Ma=ea.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.publish);
ea=com.kingdee.bos.qing.publish.common;Ga=ea.PublishFacade;ba=ea.PublishFactory;ia=ea.AbstractPublishToPanel;La=ea.AbstractPublishManagerPanel;Wa=ea.SinglePublishManagerDialog;ob=ea.ListPublishContentPanel;sa=ea.MyIcons;Hb=ea.SortWidget;zb=ea.PublishManagerSortPanel;yb=ea.FilterModelType;Ab=ea.PublishSearchPanel;cb=ea.CardFilterType;Ba=ea.AnalysisSchemeDialogSelector;Cb=ea.DisplayPublishedRecordName;hb=ea.PublishContext;Na=ea.AbstractBatchPublishPanel;Xa=ea.AbstractPublishPathSelector;ea=com.kingdee.bos.qing.integration;
wb=ea.OpenAppMenuForm;ea=com.kingdee.bos.qing.publish.model;gb=ea.PublishTargetType;Ea=ea.PublishModel;Sa=ea.PublishSourceType;m=ea.PermissionConfig;Qa=ea.PublishContainerType;ea=com.kingdee.bos.qing.ui.component;ub=ea.Label;Jb=ea.TextField;lb=ea.SwitchButton;Eb=ea.MessageDialog;h=ea.List;ea=com.kingdee.bos.qing.schemamanage.model;pb=ea.SchemaAttrModel;ea=com.kingdee.bos.qing.biz.common;db=ea.AbstractDialogSelector;ja=ea.ValueTextPair;ea=com.kingdee.bos.qing.publish.permission;Ua=ea.PermLabelSettingDialog})();
qb.setRootPath(".");qb.loadJs("biz-common/qing-biz-common.js");qb.loadSkinCss("biz-common","biz-common");qb.loadSkinJs("biz-common","skin");qb.loadI18n("biz-common","biz-common");ba.addPublishFacade(gb.APPMENU,function(ea,Ca,S,Z){Ga.call(this,ea,Ca,S,Z);var G=this.protectedMethod;this.getAppMenuTree=function(F,P){G.remote("getAppMenuTree",{publishTargetType:gb.APPMENU,spaceId:F,isPreset:P})};this.loadPublishInfos=function(F,P,n,w){G.remote("loadPublishInfos",{publishTargetType:gb.APPMENU,cloudId:F,
appId:P,appMenuId:n,appMenuId2:w})};this.loadAllPublishInfos=function(F){G.remote("loadAllPublishInfos",{publishTargetType:gb.APPMENU,isPresetPublish:F})};this.loadAllPublishInfosByPagination=function(F,P,n,w,C,f,V,W,za,va,pa,Ja,ca){G.remote("loadAllPublishInfosByPagination",{publishTargetType:gb.APPMENU,isPresetPublish:F,cloudId:P,appId:n,appMenuId:w,appMenuId2:C,targetPage:f,pageSize:V,searchText:W,currentType:za,sortField:va,sortOrder:pa,spaceId:Ja,isQingRpt:ca})};this.loadHitNumberOfAllPath=function(F,
P,n,w,C){G.remote("loadHitNumberOfAllPath",{publishTargetType:gb.APPMENU,isPresetPublish:F,searchText:P,currentType:n,spaceId:w,isQingRpt:C})};this.checkPresetPermission=function(){G.remote("checkPresetPermission",{publishTargetType:gb.APPMENU})}});ba.addPublishToPanel(gb.APPMENU,function(ea,Ca){ia.call(this,ea,Ca);var S=this,Z=this.protectedMethod,G,F,P,n,w,C,f,V,W=new h,za,va;this.getHeight=function(){return 600};this.getWidth=function(){return Ja()?850:945};this.setPublishModel=function(aa){G=
aa.copy()};this.isEditPublish=function(){return null!=G};this.setPublishContext=function(aa){F=aa};this.getPublishContext=function(){return F};var pa=function(){var aa=Ja()?250:220;P=$("<div>");var X=$("<div>");X.addClass("qing-publish-info-wrapper");X.css("padding-right","10px");var E=(new ub(Ma.get("publishSetting","\u53d1\u5e03\u8bbe\u7f6e\uff1a"))).getJqUi();E.addClass("qing-publish-info-label");ib.layoutCtrlWithLRTB(E,0,0,null,0,null,23);X.append(E);n=$("<div>");n.addClass("qing-publish-info-item");
E=new ub(Ma.get("publishName","\u53d1\u5e03\u540d\u79f0"));E.setRequired(!0);E=E.getJqUi();E.addClass("qing-publish-info-label");ib.layoutCtrl(E,0,0,105,23);w=new Jb;var I=$("<div>");w.addEditedListener(function(g){clearTimeout(za);za=setTimeout(function(){var k=w.getText();if(""!=k){var b=new Cb(Ca,ea);null!=G?b.setPublishModel(G):b.setPublishContext(F);b.getPublishedRecordNameByInputText(k,Ca,function(a){I.empty();a=a[w.getText()];if(null!=a){W.setCustomItemPainter(function(z,p){z.on("mousedown",
function(Q){w.setText(p);I.remove();Q.stopPropagation()});z.text(p);z.attr("title",p)});W.setItemModels(a);W.setSelecteds([a[0]]);a=W.getJqUi();var d=R.width(),t=R.css("left"),y=R.position().top+R.height();ib.layoutCtrl(I,t,y,d,122);I.css("z-index","9999");a.css({width:d+"px",height:"122px"});a.find(".sa-ctrl-list-owner").css("height","100px");d=$("<div>");d.addClass("history-publish-name");d.text(Ma.get("HistoryPublishName","\u5386\u53f2\u53d1\u5e03\u540d\u79f0"));d.css({right:"13px",top:"100px"});
a.appendTo(I);d.appendTo(I);n.append(I)}else I.remove()})}else I.remove()},1E3)});w.addBlurListener(function(){I.remove()});var R=w.getJqUi();ib.layoutCtrl(R,115,0,aa,23);n.append(E);n.append(R);E=new ub(Ma.get("publishPath","\u53d1\u5e03\u8def\u5f84"));E.setRequired(!0);var u=E.getJqUi();u.addClass("qing-publish-info-label");ib.layoutCtrl(u,0,0,105,23);C=new nb;E=C.getJqUi();var N=$("<div>");N.addClass("qing-publish-info-item");N.append(u);N.append(E);u=$("<div>");u.css("margin-top","28px");u.addClass("qing-publish-info-items-block");
u.append(n);u.append(N);X.append(u);if(null==G){u=aa-18-5;var ka=ca();ib.layoutCtrl(ka,115+u+5,4,18,18);N.append(ka);ib.layoutCtrl(E,115,0,u,23)}else ib.layoutCtrl(E,115,0,aa,23);E=null==G&&F.supportPublishWithCarryData();N=!1;u=$("<div>");if(E){N=!0;ka=(new ub(Ma.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"))).getJqUi();ka.attr("title",Ma.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"));ka.addClass("qing-publish-info-label");ib.layoutCtrl(ka,0,0,105,23);
f=new lb;F.getHasDirectModeTable()?(f.setOn(!1),f.setEnabled(!1)):F.isHaveToCarryData()?(f.setOn(!0),f.setEnabled(!1)):f.setOn(!1);var c=f.getJqUi();ib.layoutCtrl(c,115,0,aa,23);var l=$("<div>");l.addClass("qing-publish-info-item");l.append(ka);l.append(c);u.addClass("qing-publish-info-items-block");u.append(l);X.append(u)}if(null==G?F.supportPublishMoreSchemaScene(Ca):"dashboard"!=G.getPublishSourceType()&&"extreport"!=G.getPublishSourceType())N=!1,ka=(new ub(Ma.get("analysisScheme","\u540c\u65f6\u9009\u62e9\u66f4\u591a\u65b9\u6848"))).getJqUi(),
ka.attr("title",Ma.get("analysisScheme","\u540c\u65f6\u9009\u62e9\u66f4\u591a\u65b9\u6848")),ka.addClass("qing-publish-info-label"),ib.layoutCtrl(ka,0,0,105,23),V=new Ba(ea,Ca),V.setPublishContext(F),V.setPublishModel(G),V.setSuccessCallBack(function(g){for(var k=[],b=0;b<g.length;b++){var a=new pb;a.fromJsonObject(g[b]);k.push(a)}G.setSchemaAttrSelected(k);wa()}),null!=G&&V.getAllSchemaAttrByFid(),c=V.getJqUi(),ib.layoutCtrl(c,115,0,aa,23),aa=$("<div>"),aa.addClass("qing-publish-info-item"),aa.append(ka),
aa.append(c),ka=$("<div>"),E&&aa.css("height","251px"),ka.addClass("qing-publish-info-items-block"),ka.append(aa),X.append(ka);N&&u.css("height","350px");aa=$("<div>");aa.addClass("qing-publish-info-wrapper");aa.css("padding-left","10px");Ja()||(X.css("width","41%"),aa.css("width","59%"));E=hb.Scene.Longer;N=G?G.getPublishSourceType()==Sa.DASHBOARD:F.getCurrentSourceType()==Sa.DASHBOARD;N?E=hb.Scene.Dashboard:Ja()&&(E=hb.Scene.Report);va=Z.createPermConfigPanel(E,F.getSpaceID());E=va.getJqUi();aa.append(E);
X.appendTo(P);aa.appendTo(P);wa()},Ja=function(){return G?G.getPublishSourceType()==Sa.EXTREPORT:F.getCurrentSourceType()==Sa.EXTREPORT};this.getJqUi=function(){P||pa();return P};var ca=function(){var aa=$("<span>");aa.attr("title",Ma.get("publishManage","\u53d1\u5e03\u7ba1\u7406"));sa.background(aa,"publish_manager");aa.on("click",function(){var X=new Aa(S.getRemoteImpl());X.setPublishContext(F);X.setPublishContentEditEntrance(S.getPublishContentEditEntrance());(new Wa(X)).showDialog()});return aa},
wa=function(){if(G){w.setText(G.getName());var aa=new ja;aa.setValue(G.getPath());aa.setText(G.getPathText());C.setSelectedValue(aa);V&&V.setSelectedValue(G.getSchemaAttrSelected());aa=new m;aa.setRoles(G.getRoles());aa.setUsers(G.getUsers());aa.setNoOperateValue(G.getNoOperValueMap());aa.setPermLabels(G.getPermLabels());va.setPermissionConfig(aa)}Z.loadParentNoOperateValue(F,G,function(X){va.setParentNoOperateValue(X)})};this.getModelFromUI=function(){new Ea;if(null==G){var aa=new Ea;aa.setPublishSourceType(F.getCurrentSourceType());
aa.setPublishTargetType(S.getPublishTargetType());aa.setTagId(F.getBizTag());aa.setLastBiztag(F.getDashBoardAnalysis()?F.getSchemaTag():F.getBizTag());aa.setSchemeId("currentAnalysisState");aa.setSpaceID(F.getSpaceID())}else aa=G,aa.setSchemeId(G.getSchemeId());aa.setName($.trim(w.getText()));var X=C.getSelectedValue();aa.setPath(X.getValue());aa.setPathText(X.getText());aa.setAnalysis(!0);f&&(X=f.isOn(),aa.setCarryData(X));if(X=va?va.getPermissionConfig():null)aa.setRoles(X.getRoles()),aa.setUsers(X.getUsers()),
aa.setNoOperValueMap(X.getNoOperateValue()),aa.setPermLabels(X.getPermLabels());return aa};this.getJsonModel=function(){return F.getCurrentContentModel()};this.getAnalysisSchemaArray=function(){return F.getChoiceAnalysisSchema()};this.checkUIInput=function(aa,X,E){var I=w.getText();if(null==I||0==$.trim(I).length)return Ma.get("publishNameNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u540d\u79f0\u3002");if(50<I.length)return Ma.get("publishNameTooLongTip","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");
if(C.getSelectedValue())X&&G&&(G.getPublishSourceType()==Sa.SUBJECT||G.getPublishSourceType()==Sa.BILL)?na(E,aa):aa(!0);else return Ma.get("publishPathNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u8def\u5f84\u3002")};var na=function(aa,X){ba.createPublishFacade(Ca,ea,function(E){1==E?aa(Ma.get("publishNotExist","\u60a8\u5728\u5176\u4ed6\u9875\u9762\u5220\u9664\u4e86\u8be5\u53d1\u5e03\u8bb0\u5f55\u3002")):(E=G&&G.getSchemaModelSelected())&&0<E.length?Ia(E,aa,X):X(!0)}).checkPublishInfoIsExist(G.getId())},
Ia=function(aa,X,E){for(var I=ba.createPublishFacade(Ca,ea,function(N){1==N?X(Ma.get("deleteAllSchemaTip","\u60a8\u5728\u591a\u4e2a\u9875\u9762\u7f16\u8f91\u8be5\u53d1\u5e03\u8bb0\u5f55\u65f6\uff0c\u5220\u9664\u4e86\u6240\u6709\u7684\u5206\u6790\u65b9\u6848\uff0c\u8bf7\u91cd\u65b0\u6dfb\u52a0\u3002")):E(!0)}),R=[],u=0;u<aa.length;u++)R.push(aa[u].toJsonObject());I.checkBeforeEditAndPublishInfo(G.getId(),G.getPublishSourceType(),R)}});ba.addPublishManagePanel(gb.APPMENU,Aa);Pa.CLOUD_HAS_BEEN_DELETED=
"CLOUD_HAS_BEEN_DELETED";Pa.APP_HAS_BEEN_DELETED="APP_HAS_BEEN_DELETED";Pa.APP_MENU_HAS_BEEN_DELETED="APP_MENU_HAS_BEEN_DELETED";Ib.CardSelectMessager=new function(){var ea=Gb.decodeParamFromUrl(location.search,"pageId"),Ca=Gb.decodeParamFromUrl(location.search,"clientID");this.sendSelectCardId=function(S,Z){S={cardId:S,cardName:Z};top.window.invokeCustomEvent&&top.window.invokeCustomEvent(ea,"",[Ca,"sendCardInfo",JSON.stringify(S)])};this.sendCancelCardId=function(S){S={cardId:S};top.window.invokeCustomEvent&&
top.window.invokeCustomEvent(ea,"",[Ca,"cancelSendCardInfo",JSON.stringify(S)])}};ba.addBatchPublishPanel(gb.APPMENU,function(ea,Ca){Na.call(this,ea,gb.APPMENU);var S=this;this.protectedConvertPublishModel=function(Z){var G=new Ea;G.setPublishSourceType(Z.getCurrentSourceType());G.setPublishTargetType(gb.APPMENU);G.setTagId(Z.getBizTag());G.setLastBiztag(Z.getDashBoardAnalysis()?Z.getSchemaTag():Z.getBizTag());G.setSchemeId("currentAnalysisState");G.setPublishSourceName(Z.getPublishSourceName());
G.setSpaceID(Z.getSpaceID());return G};this.protectedGetAnalysisSchemaArray=function(Z){return Z.getChoiceAnalysisSchema()};this.protectedOpenPublishManager=function(){var Z=new Aa(S.getRemoteImpl());Z.setPublishContentEditEntrance(S.getPublishContentEditEntrance());var G=Object.values(S.getPublishContexts())[0];Z.setPublishContext(G);(new Wa(Z)).showDialog()};this.protectedCreatePathSelector=function(){return new Db}})})();(function(){function Aa(cb,Ab){ba.call(this,cb,fb.CENTER);var Sa=this,hb=this.protectedMethod,Ua,ea,Ca,S,Z,G,F,P,n,w,C,f,V,W,za,va,pa,Ja,ca=new com.kingdee.bos.qing.biz.common.ComplexPaginationBar,wa,na=[new Xa(ja.get("allType","\u5168\u90e8\u7c7b\u578b"),3),new Xa(ja.get("moduleLonger","\u6570\u636e\u5206\u6790"),0),new Xa(ja.get("dashboard","\u4eea\u8868\u677f"),1)],Ia=3;this.getTitle=function(){return ja.get("qingAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939")};this.getJqUi=
function(){Ua||(Ua=aa());return Ua};this.relayoutViews=function(){S&&S.resize();Ca&&Ca.relayoutViews()};var aa=function(){var v=$("<div>");Ua=v;ka().appendTo(v);var A=$("<div>");A.addClass("sa-qing-publish-manager");k(A);var K=$("<div>");G=Sa.getAutoSelectedData();ea=b();ea.getJqUi().appendTo(K);S.setFirstChild(qb.createChildWrapper(K),function(){ea&&ea.getJqUi().css({width:S.getNonemptyFirstWide()+"px"});Ca&&Ca.relayoutViews()});var xa=$("<div>");h.layoutCtrlWithLRTB(xa,0,10,"100%",0,0,null);wa=
I();Ca=a();Ca.setPaginationBar(ca);K=Ca.getJqUi();var fa=ja.get("configPermLabel","\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e");pa=O(fa,function(){var da=Ca?Ca.getSelectedPublish():[];if(da&&0!=da.length){var B=new yb(cb,fb.CENTER,ib.CENTER);B.setCallbackAfterSetting(E);var D=Sa.getPublishContext();B.setSpaceID(D.getSpaceID());B.setPublishModels(da);B.showDialog()}else hb.getOuterMessageCurtain().showPrompt(ja.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))});h.layoutCtrlWithLRTB(pa,
null,200,140,8,null,null);Ja=O(ja.get("del","\u5220\u9664"),X);h.layoutCtrlWithLRTB(Ja,null,145,45,8,null,null);u(!Ab);wa.appendTo(xa);pa.appendTo(xa);Ja.appendTo(xa);K.appendTo(xa);S.setSecondChild(qb.createChildWrapper(xa),function(){var da=Ua.outerWidth();xa&&xa.getJqUi().css({width:da-S.getNonemptyFirstWide()+"px"});Ca&&Ca.relayoutViews()});A.find(".sa-qing-publish-manager-content-container").css("left","-4px");A.find(".sa-qing-publish-manager-content-container").css("top","32px");A.appendTo(v);
h.layoutCtrlWithLRTB(A,0,0,null,40,0,null);return v},X=function(v){if((v=Ca?Ca.getSelectedPublish():[])&&0!=v.length){for(var A=[],K=0;K<v.length;K++)A.push(v[K].getId());v=Eb.createFeedbackDialog();v.setOptionType(Eb.OPTION_OK_CANCEL);v.setMsgImageType(Eb.MSG_DELETE);v.setMessage(ja.get("publishDeleteTips","\u5220\u9664\u8bb0\u5f55\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f"));v.setClosingChecker(function(xa){xa==Eb.RETURN_OK&&(xa=hb.createFacade(function(fa){R();
hb.getOuterMessageCurtain().showSuccess(ja.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(fa,da){hb.getOuterMessageCurtain().showPrompt(da,2E3);return!0}),xa.setShowBlocking(!1),xa.deletePublishInfos(fb.CENTER,A));return!0});v.showDialog()}else hb.getOuterMessageCurtain().showPrompt(ja.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))},E=function(v){if(v&&0!=v.length){var A=hb.createFacade(function(K){R();hb.getOuterMessageCurtain().showSuccess(ja.get("settingSuccess",
"\u8bbe\u7f6e\u6210\u529f\u3002"))});A.setShowBlocking(!0);A.updatePublishPermLabel(v)}},I=function(){ca.protectedMethod.setTotalSelectedRowAndSelectedAllVisual(!0,!1);ca.protectedMethod.setTotalPageVisual(!1);ca.protectedMethod.setCurrentPageVisual(!1);ca.protectedMethod.setFirstBtnAndEndBtnVisual(!1);ca.setJumpToPageListener(function(v,A,K){var xa=hb.createFacade(function(da){if(void 0===da.infos||null===da.infos||0===da.infos.length)wa.hide(),u(!1),K?K(0):ca.refreshPagination(),Ca.setSearchStatus(!1),
Ca.setListPublishModel(null,C.getIsPreset(),!1);else{var B=da.infos;F=[];for(var D=0;D<B.length;D++){var T=new Db;T.fromJsonObject(B[D]);F.push(T)}wa.show();u(!Ab);K?K(da.totalRow):ca.refreshPagination();Ca.setSearchStatus(!0);Ca.setListPublishModel(F,C.getIsPreset(),!1);Ca.updateSearchContentUI(n)}},function(){return!1});xa.setShowBlocking(!0);var fa=Sa.getPublishContext();xa.loadAllPublishInfosByPagination(C.getIsPreset(),va,v,A,n,f,W,za,fa.getSpaceID(),fa.isQingRpt())});ca.setComboBoxItemModelsAndSelectedItem([5,
10,20,50,100,500,1E3],2);return ca.getJqUi()},R=function(){var v=hb.createFacade(function(K){if(void 0===K.infos||null===K.infos||0===K.infos.length)ca.resetPaginationAndJumpToFirstPage(0),wa.hide(),u(!1),Ca.setSearchStatus(P),Ca.setListPublishModel(null,C.getIsPreset(),!0);else{wa.show();u(!Ab);ca.resetPaginationAndJumpToFirstPage(K.totalRow);K=K.infos;F=[];for(var xa=0;xa<K.length;xa++){var fa=new Db;fa.fromJsonObject(K[xa]);F.push(fa)}Ca.setSearchStatus(P);Ca.setListPublishModel(F,C.getIsPreset(),
!0);Ca.updateSearchContentUI(n)}},function(){return!1});v.setShowBlocking(!0);var A=Sa.getPublishContext();v.loadAllPublishInfosByPagination(C.getIsPreset(),va,1,ca.getPageSize(),n,f,W,za,A.getSpaceID(),A.isQingRpt())},u=function(v){v?(pa.show(),Ja.show()):(pa.hide(),Ja.hide())},N=function(){var v=hb.createFacade(function(K){Z.forEach(function(xa){xa=xa.getRelationId();K[xa]||(K[xa]=0)});ea.setSearchStatus(P);ea.updateTreeSearchUI(Z,K)},function(){return!1});v.setShowBlocking(!0);var A=Sa.getPublishContext();
v.loadHitNumberOfAllPath(Ab,n,f,A.getSpaceID(),A.isQingRpt())},ka=function(){var v=$("<div class='sa-qing-publish-titlebar'>");if(!Sa.getPublishContext().isQingRpt()){var A=c,K=new Na;K.setSearchType(na);K.setSelectedChangedListener(A);K.getJqUi().appendTo(v)}A=new Qa;A.setSearchListener(g);w=A;w.getJqUi().appendTo(v);A=new m;A.setSortModel(l);V=A;V.getJqUi().appendTo(v);return v},c=function(v,A,K){Ia=K.getTypeId();switch(Ia){case 3:f=void 0;break;case 1:f="dashboard";break;case 0:f="moduleLonger";
break;case 2:f="extreport"}g()},l=function(v,A){W=v.getPropertyName();za=A==Hb.SORT_TYPE_ASC?"ASC":"DESC";g()},g=function(){n=w.getInputContent().trim();0<n.length?(P=!0,n=n.toUpperCase(),N()):(P=!1,ea.setSearchStatus(P),ea.setTreeSelectorModel(Z),ea.initDirOperatorUi())},k=function(v){S=new qb;S.setHorizontalSplit(!0);S.setEnabled(!0);S.setSplitLineWide(10);S.setResizeMode(qb.RESIZE_MODE_FIRST_FIXED);S.setFirstSize(180,180,278);S.setSecondSize(620,0,-1);S.getJqUi().addClass("sa-qing-publish-manager");
v.append(S.getJqUi())},b=function(){var v=new zb;v.setOuterMessageCurtain(hb.getOuterMessageCurtain());v.setDefaultItemValue(G&&G.path?G.path:Db.QING_CENTER_ID);v.setAutoSelectedData(G);v.setUpdateDirNameListener(J);v.setAddDirNameListener(Q);v.setDeleteDirNameListener(U);v.setLoadDirNameListener(z);v.setSelectedDirNameListener(d);v.setTreeSelectorModel(Z);return v},a=function(){var v=new Wa;v.setOuterMessageCurtain(hb.getOuterMessageCurtain());v.setDeletePublishListener(y);v.setEditPublishListener(t);
v.setTabType(2);v.setEditPublishContentListenter(Sa.getPublishContentEditEntrance());v.setReSearchListener(g);v.setRemoteImpl(cb);return v},d=function(v,A){va=v;C=A;null==G&&Ca&&Ca.setAutoSelectedModel(null);R()},t=function(v,A){var K=Sa.getPublishContext();v=Ma.createPublishToEditDialog(cb,K,v);v.addSuccessCallback(A);v.setOuterMessageCurtain(hb.getOuterMessageCurtain());v.setEditPublishInfo(!0);v.showDialog()},y=function(v,A){v=v.getId();var K=hb.createFacade(function(xa){A();hb.getOuterMessageCurtain().showSuccess(ja.get("deleteSuccess",
"\u5220\u9664\u6210\u529f\u3002"))},function(xa,fa){hb.getOuterMessageCurtain().showPrompt(fa,2E3);return!0});K.setShowBlocking(!1);K.deletePublishInfo(fb.CENTER,v)},z=function(v){if(Z)v(Z);else{var A=hb.createFacade(function(K){for(var xa=[],fa=0;fa<K.length;fa++){var da=new ob;da.fromJsonObject(K[fa]);xa.push(da)}K=[];for(fa=0;fa<xa.length;fa++)p(K,xa[fa]);Z=K;v(Z)},function(K,xa){hb.getOuterMessageCurtain().showPrompt(xa,2E3);return!0});A.setShowBlocking(!0);A.loadCenterGroup(Sa.getPublishContext().getSpaceID(),
Ab)}},p=function(v,A){-1==v.indexOf(A)&&v.push(A);if(A=A.getChildren())for(var K=0;K<A.length;K++)A[K]instanceof ob?p(v,A[K]):-1==v.indexOf(A[K])&&v.push(A[K])},Q=function(v,A,K,xa,fa){var da=A.getCenterId1(),B=A.getCenterId2(),D=A.getCenterId3(),T=A.getCenterId4();hb.createFacade(function(la){xa(la,fa,A,v);g()},function(la,oa){2311402==la?hb.getOuterMessageCurtain().showPrompt(ja.get("duplicateName","\u76ee\u5f55\u540d\u79f0\u91cd\u590d\u3002"),2E3):hb.getOuterMessageCurtain().showPrompt(oa,2E3);
xa();return!0}).saveCenterGroup(v,da,B,D,T,K,Sa.getPublishContext().getSpaceID())},J=function(v,A,K){var xa=v.getSubNodeLevel()+1,fa=v.getCenterId1(),da=v.getCenterId2(),B=v.getCenterId3(),D=v.getCenterId4();hb.createFacade(function(T){K(T,v)},function(T,la){2311402==T?hb.getOuterMessageCurtain().showPrompt(ja.get("duplicateName","\u76ee\u5f55\u540d\u79f0\u91cd\u590d\u3002"),2E3):hb.getOuterMessageCurtain().showPrompt(la,2E3);K();return!0}).updateCenterGroup(xa,fa,da,B,D,A,Sa.getPublishContext().getSpaceID())},
U=function(v,A){hb.createFacade(function(K){A(K);hb.getOuterMessageCurtain().showSuccess(ja.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(K,xa){2311401==K?hb.getOuterMessageCurtain().showPrompt(ja.get("deleteNotEmpty","\u8bf7\u5148\u5220\u9664\u76ee\u5f55\u4e0b\u7684\u53d1\u5e03\u8bb0\u5f55\u3002"),2E3):hb.getOuterMessageCurtain().showPrompt(xa,2E3);return!0}).deleteCenterGroup(v,Sa.getPublishContext().getSpaceID())};this.setTreeSelectorModel=function(v){Z=v};this.getTreeSelectorModel=
function(){return Z};var O=function(v,A){var K=$("<span>");K.text(v);K.attr("title",v);K.addClass("sa-qing-publish-workbutton");K.addClass("qing-publish-ellipsis-text");if(A)K.on("click",A);return K}}function Va(){ia.call(this);var cb=this,Ab,Sa,hb;this.setSelectedPath=function(Ua){hb=Ua;Ab&&(Ab.setSelectedTreePath(hb),(Ua=cb.getSelectedListener())&&Ua(hb))};this.getSelectedPath=function(){return hb};this.setFolderNode=function(Ua){Sa=Ua;Ab&&Ab.setArrFolderNode(Sa)};this.getJqUi=function(){Ab||(Ab=
new sa,Ab.setPlaceholder(ja.get("selectPath","\u8bf7\u9009\u62e9\u53d1\u5e03\u8def\u5f84")),Ab.setSelectedListener(function(Ua,ea){(Ua=cb.getSelectedListener())&&Ua(ea);hb=ea}),Sa&&Ab.setArrFolderNode(Sa),hb&&Ab.setSelectedTreePath(hb));return Ab.getJqUi()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&
(com.kingdee.bos.qing.publish={});var Pa,kb=com.kingdee.bos.qing.publish,fb,nb,Db,Ib,ib,Gb,qb,Ma,Ga,db,ba,ia,La,Wa,ob,zb,sa,m,Qa,Na,Xa,pb,Ba,Cb,h,ja,gb,Ea,bb,wb,ub,Jb,lb,Eb,Hb,yb;(function(){var cb=com.kingdee.bos.qing;Pa=cb.CodeLoader;cb=com.kingdee.bos.qing.common;h=cb.DomUtil;cb=com.kingdee.bos.qing.framework.common;ja=cb.MultilanguageManager.createPackageAccessor(kb);cb=com.kingdee.bos.qing.publish.common;Ma=cb.PublishFactory;Ga=cb.PublishFacade;db=cb.AbstractPublishToPanel;ba=cb.AbstractPublishManagerPanel;
ia=cb.AbstractPublishPathSelector;La=cb.SinglePublishManagerDialog;Wa=cb.ListPublishContentPanel;zb=cb.TreeListMenuPanel;sa=cb.TreeItemSelector;Hb=cb.SortWidget;m=cb.PublishManagerSortPanel;Qa=cb.PublishSearchPanel;Na=cb.FilterModelType;Xa=cb.CardFilterType;wb=cb.AnalysisSchemeDialogSelector;Jb=cb.DisplayPublishedRecordName;pb=cb.PublishContext;Gb=cb.MyIcons;Cb=cb.AbstractBatchPublishPanel;cb=com.kingdee.bos.qing.publish.model;fb=cb.PublishTargetType;Db=cb.PublishModel;ob=cb.FolderNode;Ba=cb.PublishSourceType;
Ib=cb.PermissionConfig;ib=cb.PublishContainerType;cb=com.kingdee.bos.qing.biz.common;nb=cb.ValueTextPair;cb=com.kingdee.bos.qing.ui.component;gb=cb.Label;Ea=cb.TextField;bb=cb.SwitchButton;qb=cb.SplitPane;lb=cb.List;Eb=cb.MessageDialog;cb=com.kingdee.bos.qing.schemamanage.model;ub=cb.SchemaAttrModel;cb=com.kingdee.bos.qing.publish.permission;yb=cb.PermLabelSettingDialog})();Pa.setRootPath(".");Pa.loadJs("biz-common/qing-biz-common.js");Pa.loadSkinCss("biz-common","biz-common");Pa.loadSkinJs("biz-common",
"skin");Pa.loadI18n("biz-common","biz-common");Ma.addPublishFacade(fb.CENTER,function(cb,Ab,Sa,hb){Ga.call(this,cb,Ab,Sa,hb);var Ua=this.protectedMethod;this.loadCenterGroup=function(ea,Ca){Ua.remote("loadCenterGroup",{publishTargetType:fb.CENTER,spaceId:ea,isPreset:Ca})};this.saveCenterGroup=function(ea,Ca,S,Z,G,F,P){Ua.remote("saveCenterGroup",{publishTargetType:fb.CENTER,addType:ea,centerId1:Ca,centerId2:S,centerId3:Z,centerId4:G,name:F,spaceId:P})};this.updateCenterGroup=function(ea,Ca,S,Z,G,
F,P){Ua.remote("updateCenterGroup",{publishTargetType:fb.CENTER,iLevel:ea,name:F,centerId1:Ca,centerId2:S,centerId3:Z,centerId4:G,spaceId:P})};this.deleteCenterGroup=function(ea,Ca){ea={publishTargetType:fb.CENTER,arrDeleteRelationId:JSON.stringify(ea),spaceId:Ca};Ua.remote("deleteCenterGroup",ea)};this.loadPublishInfos=function(ea,Ca){Ua.remote("loadPublishInfos",{publishTargetType:fb.CENTER,path:ea,isPreset:Ca})};this.loadAllPublishInfos=function(ea){Ua.remote("loadAllPublishInfos",{publishTargetType:fb.CENTER,
isPresetPublish:ea})};this.loadAllPublishInfosByPagination=function(ea,Ca,S,Z,G,F,P,n,w,C){Ua.remote("loadAllPublishInfosByPagination",{publishTargetType:fb.CENTER,isPresetPublish:ea,path:Ca,targetPage:S,pageSize:Z,searchText:G,currentType:F,sortField:P,sortOrder:n,spaceId:w,isQingRpt:C})};this.loadHitNumberOfAllPath=function(ea,Ca,S,Z,G){Ua.remote("loadHitNumberOfAllPath",{publishTargetType:fb.CENTER,isPresetPublish:ea,searchText:Ca,currentType:S,spaceId:Z,isQingRpt:G})}});Ma.addPublishToPanel(fb.CENTER,
function(cb,Ab){db.call(this,cb,Ab);var Sa=this,hb=this.protectedMethod,Ua,ea,Ca,S,Z,G,F,P,n,w,C=new lb,f,V;this.getHeight=function(){return 600};this.getWidth=function(){return za()?850:945};this.setUpdateType=function(X){n=X};this.getUpdateType=function(){return n};this.setPublishModel=function(X){Ua=X.copy()};this.isEditPublish=function(){return null!=Ua};this.setPublishContext=function(X){ea=X};this.getPublishContext=function(){return ea};this.setTreeSelectorModel=function(X){Ca=X};var W=function(){var X=
za()?250:220;S=$("<div>");var E=$("<div>");E.addClass("qing-publish-info-wrapper");E.css("padding-right","10px");var I=(new gb(ja.get("publishSetting","\u53d1\u5e03\u8bbe\u7f6e\uff1a"))).getJqUi();I.addClass("qing-publish-info-label");h.layoutCtrlWithLRTB(I,0,0,null,0,null,23);E.append(I);Z=$("<div>");Z.addClass("qing-publish-info-item");I=new gb(ja.get("publishName","\u53d1\u5e03\u540d\u79f0"));I.setRequired(!0);I=I.getJqUi();I.addClass("qing-publish-info-label");h.layoutCtrl(I,0,0,105,23);G=new Ea;
var R=$("<div>");G.addEditedListener(function(g){clearTimeout(f);f=setTimeout(function(){var k=G.getText();if(""!=k){var b=new Jb(Ab,cb);null!=Ua?b.setPublishModel(Ua):b.setPublishContext(ea);b.getPublishedRecordNameByInputText(k,Ab,function(a){R.empty();a=a[G.getText()];if(null!=a){C.setCustomItemPainter(function(z,p){z.on("mousedown",function(Q){G.setText(p);R.remove();Q.stopPropagation()});z.text(p);z.attr("title",p)});C.setItemModels(a);C.setSelecteds([a[0]]);a=C.getJqUi();var d=u.width(),t=u.css("left"),
y=u.position().top+u.height();h.layoutCtrl(R,t,y,d,122);R.css("z-index","9999");a.css({width:d+"px",height:"122px"});a.find(".sa-ctrl-list-owner").css("height","100px");d=$("<div>");d.addClass("history-publish-name");d.text(ja.get("HistoryPublishName","\u5386\u53f2\u53d1\u5e03\u540d\u79f0"));d.css({right:"13px",top:"100px"});a.appendTo(R);d.appendTo(R);Z.append(R)}else R.remove()})}else R.remove()},1E3)});G.addBlurListener(function(){R.remove()});var u=G.getJqUi();h.layoutCtrl(u,115,0,X,23);Z.append(I);
Z.append(u);I=new gb(ja.get("publishPath","\u53d1\u5e03\u8def\u5f84"));I.setRequired(!0);var N=I.getJqUi();N.addClass("qing-publish-info-label");h.layoutCtrl(N,0,0,105,23);F=pa();I=F.getJqUi();var ka=$("<div>");ka.addClass("qing-publish-info-item");ka.append(N);ka.append(I);N=$("<div>");N.css("margin-top","28px");N.addClass("qing-publish-info-items-block");N.append(Z);N.append(ka);E.append(N);if(null==Ua){N=X-18-5;var c=va();h.layoutCtrl(c,115+N+5,4,18,18);ka.append(c);h.layoutCtrl(I,115,0,N,23)}else h.layoutCtrl(I,
115,0,X,23);I=null==Ua&&ea.supportPublishWithCarryData();ka=!1;if(I){ka=!0;var l=(new gb(ja.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"))).getJqUi();l.attr("title",ja.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"));l.addClass("qing-publish-info-label");h.layoutCtrl(l,0,0,105,23);w=new bb;ea.getHasDirectModeTable()?(w.setOn(!1),w.setEnabled(!1)):ea.isHaveToCarryData()?(w.setOn(!0),w.setEnabled(!1)):w.setOn(!1);c=w.getJqUi();h.layoutCtrl(c,115,0,X,23);N=$("<div>");
N.addClass("qing-publish-info-item");N.append(l);N.append(c);l=$("<div>");l.addClass("qing-publish-info-items-block");l.append(N);E.append(l)}if(null==Ua?ea.supportPublishMoreSchemaScene(Ab):"dashboard"!=Ua.getPublishSourceType()&&"extreport"!=Ua.getPublishSourceType())ka=!1,N=(new gb(ja.get("analysisScheme","\u540c\u65f6\u9009\u62e9\u66f4\u591a\u65b9\u6848"))).getJqUi(),N.attr("title",ja.get("analysisScheme","\u540c\u65f6\u9009\u62e9\u66f4\u591a\u65b9\u6848")),N.addClass("qing-publish-info-label"),
h.layoutCtrl(N,0,0,105,23),P=new wb(cb,Ab),P.setPublishContext(ea),P.setPublishModel(Ua),P.setSuccessCallBack(function(g){for(var k=[],b=0;b<g.length;b++){var a=new ub;a.fromJsonObject(g[b]);k.push(a)}Ua.setSchemaAttrSelected(k);na()}),null!=Ua&&P.getAllSchemaAttrByFid(),c=P.getJqUi(),h.layoutCtrl(c,115,0,X,23),X=$("<div>"),X.addClass("qing-publish-info-item"),X.append(N),X.append(c),N=$("<div>"),I&&N.css("height","283px"),N.addClass("qing-publish-info-items-block"),N.append(X),E.append(N);ka&&l.css("height",
"350px");X=$("<div>");X.addClass("qing-publish-info-wrapper");X.css("padding-left","10px");za()||(E.css("width","41%"),X.css("width","59%"));l=pb.Scene.Longer;I=Ua?Ua.getPublishSourceType()==Ba.DASHBOARD:ea.getCurrentSourceType()==Ba.DASHBOARD;I?l=pb.Scene.Dashboard:za()&&(l=pb.Scene.Report);V=hb.createPermConfigPanel(l,ea.getSpaceID());l=V.getJqUi();X.append(l);E.appendTo(S);X.appendTo(S);na()},za=function(){return Ua?Ua.getPublishSourceType()==Ba.EXTREPORT:ea.getCurrentSourceType()==Ba.EXTREPORT};
this.getJqUi=function(){S||(W(),Ja(F,!1));return S};var va=function(){var X=$("<span>");X.attr("title",ja.get("publishManage","\u53d1\u5e03\u7ba1\u7406"));Gb.background(X,"publish_manager");X.on("click",function(){var E=new Aa(Sa.getRemoteImpl());E.setPublishContext(ea);E.setTreeSelectorModel(Ca);E.setPublishContentEditEntrance(Sa.getPublishContentEditEntrance());E=new La(E);E.setClosedCallback(function(I){(Ca=I.getTreeSelectorModel())&&0!=Ca.length||(Ca=null);Ja(F,!0)});E.showDialog()});X.css("cursor",
"pointer");return X},pa=function(){var X=new sa;X.setPlaceholder(ja.get("selectPath","\u8bf7\u9009\u62e9\u53d1\u5e03\u8def\u5f84"));X.setMaxHeight(118);X.getJqUi().css("background","white");return X},Ja=function(X,E){if(null==Ca){var I=hb.createFacade(function(R){for(var u=[],N=0;N<R.length;N++){var ka=new ob;ka.fromJsonObject(R[N]);u.push(ka)}R=[];for(N=0;N<u.length;N++)wa(R,u[N]);Ca=R;X.setArrFolderNode(ca());E&&F.setSelectedTreePath(null)},function(R,u){hb.getOuterMessageCurtain().showPrompt(u,
2E3);return!0});I.setShowBlocking(!0);I.setBlockingJqUi(S);I.loadCenterGroup(Sa.getPublishContext().getSpaceID(),!1)}else X.setArrFolderNode(ca()),E&&F.setSelectedTreePath(null)},ca=function(){for(var X=[],E=0;E<Ca.length;E++)if(!Ca[E].getIsPreset()&&!Ca[E].getParentId()){var I=Ca[E].getName();Ca[E].getId()==Db.QING_CENTER_ID&&"\u6211\u7684\u8f7b\u5206\u6790"==I&&Ca[E].setName(ja.get("myQingCenter",I));X.push(Ca[E])}return X},wa=function(X,E){-1==X.indexOf(E)&&X.push(E);if(E=E.getChildren())for(var I=
0;I<E.length;I++)E[I]instanceof ob?wa(X,E[I]):-1==X.indexOf(E[I])&&X.push(E[I])},na=function(){if(Ua){G.setText(Ua.getName());var X=new nb;X.setValue(Ua.getPath());X.setText(Ua.getPathText());F.setSelectedTreePath(X);P&&P.setSelectedValue(Ua.getSchemaAttrSelected());X=new Ib;X.setRoles(Ua.getRoles());X.setUsers(Ua.getUsers());X.setNoOperateValue(Ua.getNoOperValueMap());X.setPermLabels(Ua.getPermLabels());V.setPermissionConfig(X)}hb.loadParentNoOperateValue(ea,Ua,function(E){V.setParentNoOperateValue(E)})};
this.getModelFromUI=function(){var X=new Db;null==Ua?(X.setPublishSourceType(ea.getCurrentSourceType()),X.setPublishTargetType(Sa.getPublishTargetType()),X.setTagId(ea.getBizTag()),X.setLastBiztag(ea.getDashBoardAnalysis()?ea.getSchemaTag():ea.getBizTag()),X.setSchemeId(Db.CURRENT_SCHEMA_ID),X.setSpaceID(ea.getSpaceID())):(X=Ua,X.setSchemeId(Ua.getSchemeId()));X.setName($.trim(G.getText()));var E=F.getSelectedTreePath();X.setPath(E.getValue());X.setPathText(E.getText());X.setAnalysis(!0);w&&(E=w.isOn(),
X.setCarryData(E));if(E=V?V.getPermissionConfig():null)X.setRoles(E.getRoles()),X.setUsers(E.getUsers()),X.setNoOperValueMap(E.getNoOperateValue()),X.setPermLabels(E.getPermLabels());return X};this.getJsonModel=function(){return ea.getCurrentContentModel()};this.getAnalysisSchemaArray=function(){return ea.getChoiceAnalysisSchema()};this.checkUIInput=function(X,E,I){var R=G.getText();if(null==R||0==$.trim(R).length)return ja.get("publishNameNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u540d\u79f0\u3002");
if(50<R.length)return ja.get("publishNameTooLongTip","\u53d1\u5e03\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(F.getSelectedTreePath())E&&Ua&&(Ua.getPublishSourceType()==Ba.SUBJECT||Ua.getPublishSourceType()==Ba.BILL)?Ia(I,X):X(!0);else return ja.get("publishPathNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u8def\u5f84\u3002")};var Ia=function(X,E){Ma.createPublishFacade(Ab,cb,function(I){1==I?X(ja.get("publishNotExist","\u60a8\u5728\u5176\u4ed6\u9875\u9762\u5220\u9664\u4e86\u8be5\u53d1\u5e03\u8bb0\u5f55\u3002")):
(I=Ua&&Ua.getSchemaModelSelected())&&0<I.length?aa(I,X,E):E(!0)}).checkPublishInfoIsExist(Ua.getId())},aa=function(X,E,I){for(var R=Ma.createPublishFacade(Ab,cb,function(ka){1==ka?E(ja.get("deleteAllSchemaTip","\u60a8\u5728\u591a\u4e2a\u9875\u9762\u7f16\u8f91\u8be5\u53d1\u5e03\u8bb0\u5f55\u65f6\uff0c\u5220\u9664\u4e86\u6240\u6709\u7684\u5206\u6790\u65b9\u6848\uff0c\u8bf7\u91cd\u65b0\u6dfb\u52a0\u3002")):I(!0)}),u=[],N=0;N<X.length;N++)u.push(X[N].toJsonObject());R.checkBeforeEditAndPublishInfo(Ua.getId(),
Ua.getPublishSourceType(),u)}});Ma.addPublishManagePanel(fb.CENTER,Aa);Ma.addBatchPublishPanel(fb.CENTER,function(cb,Ab){Cb.call(this,cb,fb.CENTER);var Sa=this,hb=this.protectedMethod,Ua=[],ea=[],Ca;this.protectedLoadDataBeforeInit=function(n,w){G(n,function(){Ca=n;w&&w()})};this.protectedConvertPublishModel=function(n){var w=new Db;w.setPublishSourceType(n.getCurrentSourceType());w.setPublishTargetType(fb.CENTER);w.setTagId(n.getBizTag());w.setLastBiztag(n.getDashBoardAnalysis()?n.getSchemaTag():
n.getBizTag());w.setSchemeId(Db.CURRENT_SCHEMA_ID);w.setPublishSourceName(n.getPublishSourceName());w.setSpaceID(n.getSpaceID());return w};this.protectedGetAnalysisSchemaArray=function(n){return n.getChoiceAnalysisSchema()};this.protectedOpenPublishManager=function(){var n=new Aa(Sa.getRemoteImpl());n.setTreeSelectorModel(Ua);n.setPublishContentEditEntrance(Sa.getPublishContentEditEntrance());var w=Object.values(Sa.getPublishContexts())[0];n.setPublishContext(w);n=new La(n);n.setClosedCallback(function(C){(Ua=
C.getTreeSelectorModel())&&0!=Ua.length?(P(),S()):G(Ca,function(){S()})});n.showDialog()};var S=function(){for(var n=Object.values(Sa.getPathSelector()),w={},C=0;C<n.length;C++){n[C].setFolderNode(ea);var f=n[C].getSelectedPath();if(f){-1==Object.keys(w).indexOf(f.getValue())&&(V=Z(f.getValue(),ea,"",w),w[f.getValue()]=V);var V=w[f.getValue()];V?V!=f.getText()&&(f.setText(V),n[C].setSelectedPath(f)):n[C].setSelectedPath(null)}}if(n=Sa.getCopyPath())-1==Object.keys(w).indexOf(n.getValue())&&(V=Z(n.getValue(),
ea,"",w),w[n.getValue()]=V),(w=w[n.getValue()])?n.setText(w):Sa.setCopyPath(null)},Z=function(n,w,C,f){if(!w||0==w.length)return"";for(var V=0;V<w.length;V++){var W=w[V],za=C?C+"/"+W.getName():W.getName();f[W.getRelationId()]=za;if(W.getRelationId()==n||(W=W.getChildren())&&0<W.length&&(za=Z(n,W,za,f)))return za}return""};this.protectedCreatePathSelector=function(){var n=new Va;n.setFolderNode(ea);return n};var G=function(n,w){var C=hb.createFacade(function(f){for(var V=[],W=0;W<f.length;W++){var za=
new ob;za.fromJsonObject(f[W]);V.push(za)}f=[];for(W=0;W<V.length;W++)F(f,V[W]);Ua=f;P();w&&w()},function(f,V){hb.getOuterMessageCurtain().showPrompt(V,2E3);return!0});C.setShowBlocking(!0);C.setBlockingJqUi(n);C.loadCenterGroup(Ab,!1)},F=function(n,w){-1==n.indexOf(w)&&n.push(w);if(w=w.getChildren())for(var C=0;C<w.length;C++)w[C]instanceof ob?F(n,w[C]):-1==n.indexOf(w[C])&&n.push(w[C])},P=function(){ea=[];for(var n=0;n<Ua.length;n++)if(!Ua[n].getIsPreset()&&!Ua[n].getParentId()){var w=Ua[n].getName();
Ua[n].getId()==Db.QING_CENTER_ID&&"\u6211\u7684\u8f7b\u5206\u6790"==w&&Ua[n].setName(ja.get("myQingCenter",w));ea.push(Ua[n])}}})})();(function(){function Aa(G,F){La.call(this,G,nb.CARD_REPOSITORY);var P=this,n=this.protectedMethod,w,C,f,V,W,za,va,pa=[],Ja=[],ca,wa,na,Ia=!1,aa=!0,X,E,I,R,u,N=[],ka,c,l=!1,g=!1,k=!1,b=[new Ua(Ea.get("allType","\u5168\u90e8\u7c7b\u578b"),2),new Ua(Ea.get("moduleSquare","\u6570\u636e\u6597\u65b9"),0),new Ua(Ea.get("dashboard","\u4eea\u8868\u677f"),1)],a=2,d,t=new com.kingdee.bos.qing.biz.common.ComplexPaginationBar,y;this.getTitle=function(){return Ea.get("cardRepository","\u5361\u7247\u5e93")};this.getJqUi=
function(){w||(w=z());return w};this.relayoutViews=function(){W&&W.relayoutViews()};var z=function(){var ha=$("<div>");xa().appendTo(ha);var ua=$("<div>");ua.addClass("sa-qing-publish-manager");na=P.getAutoSelectedData();C=oa();C.getJqUi().appendTo(ua);var Da=$("<div>");Ba.layoutCtrlWithLRTB(Da,220,0,null,0,0,null);y=J();y.appendTo(Da);f=ra();f.setPaginationBar(t);V=f.getJqUi();W=Ka();W.setPaginationBar(t);za=W.getJqUi();za.hide();var eb=Ea.get("configPermLabel","\u8bbe\u7f6e\u6743\u9650\u6807\u7b7e");
ka=tb(eb,function(){var r;aa?f&&(r=f.getSelectedPublishModels()):W&&(r=W.getSelectedPublish());if(r&&0!=r.length){var Y=new Ga(G,nb.CARD_REPOSITORY,Ma.CARD);Y.setCallbackAfterSetting(p);var e=P.getPublishContext();Y.setSpaceID(e.getSpaceID());Y.setPublishModels(r);Y.showDialog()}else n.getOuterMessageCurtain().showPrompt(Ea.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))});Ba.layoutCtrlWithLRTB(ka,null,200,140,8,null,null);c=tb(Ea.get("del","\u5220\u9664"),Q);Ba.layoutCtrlWithLRTB(c,
null,145,45,8,null,null);ka.appendTo(Da);c.appendTo(Da);v(!F);V.appendTo(Da);za.appendTo(Da);Da.appendTo(ua);ua.find(".sa-qing-publish-manager-content-container").css("top","32px");ua.appendTo(ha);Ba.layoutCtrlWithLRTB(ua,0,0,null,40,0,null);return ha},p=function(ha){if(ha&&0!=ha.length){var ua=n.createFacade(function(Da){U();n.getOuterMessageCurtain().showSuccess(Ea.get("settingSuccess","\u8bbe\u7f6e\u6210\u529f\u3002"))});ua.setShowBlocking(!0);ua.updatePublishPermLabel(ha)}},Q=function(ha){if((ha=
aa?f.getSelectedPublishModels():W.getSelectedPublish())&&0!=ha.length){for(var ua=[],Da=0;Da<ha.length;Da++)ua.push(ha[Da].getId());ha=Eb.createFeedbackDialog();ha.setOptionType(Eb.OPTION_OK_CANCEL);ha.setMsgImageType(Eb.MSG_DELETE);ha.setMessage(Ea.get("publishDeleteTips","\u5220\u9664\u8bb0\u5f55\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f"));ha.setClosingChecker(function(eb){eb==Eb.RETURN_OK&&(eb=n.createFacade(function(r){U();n.getOuterMessageCurtain().showSuccess(Ea.get("deleteSuccess",
"\u5220\u9664\u6210\u529f\u3002"))},function(r,Y){n.getOuterMessageCurtain().showPrompt(Y,2E3);return!0}),eb.setShowBlocking(!1),eb.deletePublishInfos(nb.CARD_REPOSITORY,ua));return!0});ha.showDialog()}else n.getOuterMessageCurtain().showPrompt(Ea.get("selectPublish","\u8bf7\u9009\u62e9\u53d1\u5e03\u8bb0\u5f55\u3002"))},J=function(){t.protectedMethod.setTotalSelectedRowAndSelectedAllVisual(!0,!1);t.protectedMethod.setTotalPageVisual(!1);t.protectedMethod.setCurrentPageVisual(!1);t.protectedMethod.setFirstBtnAndEndBtnVisual(!1);
t.setJumpToPageListener(function(ha,ua,Da){var eb=n.createFacade(function(r){if(void 0===r.infos||null===r.infos||0===r.infos.length)y.hide(),v(!1),Da?Da(r.totalRow):t.refreshPagination(),f.setSearchStatus(!1),f.setPublishModels(null,!1),f.updateSearchContentUI(X),W.setSearchStatus(!1),W.setListPublishModel(null,F,!1);else{var Y=r.infos;ca=[];for(var e=0;e<Y.length;e++){var x=new kb;x.fromJsonObject(Y[e]);ca.push(x)}y.show();v(!F);Da?Da(r.totalRow):t.refreshPagination();f.setSearchStatus(!0);f.setPublishModels(ca,
!1);f.updateSearchContentUI(X);W.setSearchStatus(!0);W.setListPublishModel(ca,F,!1)}W.updateSearchContentUI(X)},function(){return!1});eb.setShowBlocking(!0);eb.loadAllPublishInfosByPagination(F,wa,ha,ua,X,d,I,R)});t.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);return t.getJqUi()},U=function(){var ha=n.createFacade(function(ua){if(void 0===ua.infos||null===ua.infos||0===ua.infos.length)y.hide(),v(!1),t.resetPaginationAndJumpToFirstPage(ua.totalRow),ca=[];else{y.show();v(!F);t.resetPaginationAndJumpToFirstPage(ua.totalRow);
ua=ua.infos;ca=[];for(var Da=0;Da<ua.length;Da++){var eb=new kb;eb.fromJsonObject(ua[Da]);ca.push(eb)}}O(!0)},function(){return!1});ha.setShowBlocking(!0);ha.loadAllPublishInfosByPagination(F,wa,1,t.getPageSize(),X,d,I,R)},O=function(ha){ca&&0<ca.length?(f.setSearchStatus(Ia),f.setPublishModels(ca,ha),f.updateSearchContentUI(X),W.setSearchStatus(Ia),W.setListPublishModel(ca,F,ha),W.updateSearchContentUI(X)):(f.setSearchStatus(Ia),f.setPublishModels(null,ha),W.setSearchStatus(Ia),W.setListPublishModel(null,
F,ha))},v=function(ha){ha?(ka.show(),c.show()):(ka.hide(),c.hide())},A=function(){var ha=n.createFacade(function(ua){va.forEach(function(Da){Da=Da.getValue();ua[Da]||(ua[Da]=0)});C.updateSearchUI(va,ua)},function(){return!1});ha.setShowBlocking(!0);ha.loadHitNumberOfAllPath(F,X,d)},K=function(ha){if(aa!=ha){if(ha){var ua=W.getSelectedPublishMap();f.setSelectedPublishCardItem(ua);V.show();za.hide()}else ua=f.getSelectedPublishCardItem(),W.setSelectedPublishMap(ua),za.show(),V.hide();aa=ha;O(!1)}},
xa=function(){var ha=$("<div class='sa-qing-publish-titlebar'>"),ua=D,Da=new cb;Da.setSearchType(b);Da.setSelectedChangedListener(ua);Da.getJqUi().css("margin-right","0px");Da.getJqUi().appendTo(ha);ua=$("<div tabIndex=-1 style='outline: none;'>");ua.css({width:"20px","float":"left",height:"40px",left:"15px",position:"relative"});ua.appendTo(ha);ua.on("mousedown",fa);ua.on("mouseup",fa);ua.on("keydown",fa);ua.on("keyup",fa);ua=new hb;ua.setSearchListener(T);u=ua;u.getJqUi().appendTo(ha);ua=new Ab;
ua.setSortModel(la);E=ua;ua=E.getJqUi();ua.appendTo(ha);Ba.layoutCtrlWithLRTB(ua,700,60,null,0,0,null);ua=new Sa;ua.setClickListener(K);ua.getJqUi().appendTo(ha);return ha},fa=function(ha){var ua=ha.type;ha=ha.keyCode;ua&&"mousedown"===ua&&(g=!0);ua&&"mouseup"===ua&&(g=!1);ua&&ha&&"keydown"===ua&&"17"==ha&&(l=!0);ua&&ha&&"keyup"===ua&&"17"==ha&&(l=!1);ua&&ha&&"keydown"===ua&&"16"==ha&&(k=!0);ua&&ha&&"keyup"===ua&&"16"==ha&&(k=!1);l&&g&&k&&(da(),k=g=l=!1)},da=function(){n.createFacade(function(ha){for(var ua=
0;ua<ha.length;ua++){var Da=new kb;Da.fromJsonObject(ha[ua]);N.push(Da)}(new Va(G,N,B)).showDialog()}).loadAllPublishInfos(!1)},B=function(ha){n.createFacade(function(ua){n.createFacade().getExportedData(ua)},function(ua,Da){return!1}).exportEmbeddedPublishInfo(ha)},D=function(ha,ua,Da){a=Da.getTypeId();d=2==a?void 0:1==a?"dashboard":"subject";T()},T=function(){X=u.getInputContent().trim();0<X.length?(Ia=!0,X=X.toUpperCase(),A()):(Ia=!1,C.setModel(va),C.updateUI())},la=function(ha,ua){I=ha.getPropertyName();
R=ua==Hb.SORT_TYPE_ASC?"ASC":"DESC";T()},oa=function(){var ha=new zb;ha.setOuterMessageCurtain(n.getOuterMessageCurtain());na&&na.path&&ha.setDefaultItemValue(na.path);ha.setSelectedItemListener(H);ha.setModel(va);ha.setAddItemListener(ab);ha.setUpdateItemListener(Ya);ha.setDeleteItemListener($a);ha.setLoadItemListener(ya);return ha},ra=function(){var ha=new Pa;ha.setPublishManager(!0);F||ha.setSingleSelected(!1);ha.setAlwaysShowSelectBtn(!1);ha.setOuterMessageCurtain(n.getOuterMessageCurtain());
ha.setCardImgUrlCreator(M);ha.setDeletePublishListener(Oa);ha.setEditPublishListener(ma);ha.setEditPublishContentListenter(P.getPublishContentEditEntrance());ha.setSelectedChangeListener(qa);ha.setReSearchListener(T);return ha},qa=function(ha,ua){},Ka=function(){var ha=new yb;ha.setOuterMessageCurtain(n.getOuterMessageCurtain());ha.setDeletePublishListener(Ha);ha.setEditPublishListener(ma);ha.setCardImgUrlCreator(M);ha.setEditPublishContentListenter(P.getPublishContentEditEntrance());ha.setReSearchListener(T);
return ha},H=function(ha){wa=ha.getValue();null==na&&f&&f.setAutoSelectedModel(null);U()},M=function(ha){if(!ha)return pb.getIconUrl("publish","icon_dashboard_building.png");if("publish"==ha.substring(2,9))return ha;var ua=P.getPublishContext().getParamPathPrefix();return n.createFacade().getCardImgUrl(ua,ha)},ma=function(ha,ua){var Da=P.getPublishContext();ha=db.createPublishToEditDialog(G,Da,ha);ha.addSuccessCallback(ua);ha.setOuterMessageCurtain(n.getOuterMessageCurtain());ha.showDialog()},Oa=
function(ha,ua){var Da=n.createFacade(function(eb){ua();n.getOuterMessageCurtain().showSuccess(Ea.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(eb,r){return!1});Da.setShowBlocking(!1);Da.deletePublishInfo(nb.CARD_REPOSITORY,ha)},Ha=function(ha,ua){ha=ha.getId();var Da=n.createFacade(function(eb){ua();n.getOuterMessageCurtain().showSuccess(Ea.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(eb,r){return!1});Da.setShowBlocking(!1);Da.deletePublishInfo(nb.CARD_REPOSITORY,
ha)},ya=function(ha){var ua=n.createFacade(function(Da){for(var eb=[],r=0;r<Da.length;r++){var Y=new Db;Y.setValue(Da[r].id);Y.setText(Da[r].name);Y.setIsPreset(Da[r].isPreset);eb.push(Y)}va=eb;for(Da=0;Da<va.length;Da++)va[Da].isPreset()?pa.push(va[Da]):Ja.push(va[Da]);va=F?pa:Ja;ha(va)},function(Da,eb){return!1});ua.setShowBlocking(!0);ua.loadGroups(F)},ab=function(ha,ua,Da){n.createFacade(function(eb){var r=new Db;r.setValue(eb.id);r.setText(eb.name);Da(r);T()},function(eb,r){return 2312402==eb?
(n.getOuterMessageCurtain().showPrompt(Ea.get("duplicateName","\u76ee\u5f55\u540d\u79f0\u91cd\u590d\u3002"),2E3),!0):!1}).saveGroup(ha)},Ya=function(ha,ua,Da){n.createFacade(function(eb){Da(eb)},function(eb,r){return 2312402==eb?(n.getOuterMessageCurtain().showPrompt(Ea.get("duplicateName","\u76ee\u5f55\u540d\u79f0\u91cd\u590d\u3002"),2E3),!0):!1}).updateGroup(ha,ua)},$a=function(ha,ua){n.createFacade(function(Da){ua();n.getOuterMessageCurtain().showSuccess(Ea.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},
function(Da,eb){return 2312401==Da?(n.getOuterMessageCurtain().showPrompt(Ea.get("deleteNotEmpty","\u8bf7\u5148\u5220\u9664\u76ee\u5f55\u4e0b\u7684\u53d1\u5e03\u8bb0\u5f55\u3002"),2E3),!0):!1}).deleteGroup(ha)};this.setPathSelectorModel=function(ha){for(var ua=0;ua<ha.length;ua++)ha[ua].isPreset()?pa.push(ha[ua]):Ja.push(ha[ua]);va=F?pa:Ja};this.getPathSelectorModel=function(){return pa.concat(Ja)};var tb=function(ha,ua){var Da=$("<span>");Da.text(ha);Da.attr("title",ha);Da.addClass("sa-qing-publish-workbutton");
Da.addClass("qing-publish-ellipsis-text");if(ua)Da.on("click",ua);return Da}}function Va(G,F,P){function n(){KTDefaultCellRender.call(this,f);var va=this,pa=this.paintCellUI;this.paintCellUI=function(Ja,ca){if(va.getCurrentRowIdx()>=h.getHeadRowCount()){var wa=va.getCurrentRow(),na=va.getCurrentColIdx(),Ia=wa.getUserObject();wa=$(Ja);var aa=$("<div>");0==na?(aa=new Xa,Ja=aa.getJqUi(),aa.setChecked(!1),aa.setUserObject(Ia),W.push(aa),Ja.css({position:"relative","margin-left":"30%"}),wa.append(Ja)):
1==na?(aa.text(Ia.getName()),aa.attr("title",Ia.getName()),aa.css({position:"relative","margin-left":"5%"}),wa.append(aa)):2==na?(Ia=Ia.getPublishSourceGroupName()+"/"+Ia.getPublishSourceName(),aa.text(Ia),aa.attr("title",Ia),aa.css({position:"relative","margin-left":"5%"}),wa.append(aa)):3==na?(Ja=new ja,Ja.setFormatString("yyyy-MM-dd HH:mm:ss"),Ia=Ja.format(Ia.getCreateTime()),aa.text(Ia),aa.attr("title",Ia),aa.css({position:"relative","margin-left":"5%"}),wa.append(aa)):pa(Ja,ca)}else pa(Ja,ca)}}
Qa.call(this);var w=this,C=this.protectedMethod,f,V,W=[];(function(){C.setTitle(Ea.get("exportWithoutDataForEmbedded","\u5d4c\u5165\u5f0f\u53d1\u5e03\u4fe1\u606f\u5bfc\u51fa"));w.setSize(520,570);C.getDialogCtrl().setMinSize(520,570);C.setContentPaneCreator(function(){var va=$("<div>");V=new Na(Ea.get("export","\u5bfc\u51fa"));var pa=V.getJqUi();pa.addClass("sa-qing-publish-hidden-export");V.addActionListener(za);f=new KTable;var Ja=new n;f.setCellRender(Ja);f.setSyncUIWhenModelChanged(!1);f.addColumns(4);
f.getColumn(0).setWidth(32);f.getColumn(1).setWidth(152);f.getColumn(2).setWidth(152);f.getColumn(3).setWidth(152);Ja=h.createHeadRow(f);Ja.getCell(0).setValue("");Ja.getCell(1).setValue(Ea.get("publishName","\u53d1\u5e03\u540d\u79f0"));Ja.getCell(2).setValue(Ea.get("publishPath","\u53d1\u5e03\u8def\u5f84"));Ja.getCell(3).setValue(Ea.get("publishTime","\u53d1\u5e03\u65f6\u95f4"));Ja=$(f.getUI());Ja.css({top:"3%",height:"90%",position:"relative"});Ja.children().css("overflow-x","hidden");for(var ca=
0;ca<F.length;ca++){var wa=F[ca],na=wa.getPublishSourceType(),Ia=wa.getCarryData();"bill"===na&&!0!==Ia&&(na=h.createRow(f,!1),na.setHeight(23),na.setUserObject(wa))}f.updateUI();va.append(pa);va.append(Ja);return va});C.setFooterPaneCreator(function(va){var pa=new Na(Ea.get("close","\u5173\u95ed"));pa.setHighlight(!0);var Ja=pa.getJqUi();Ba.layoutCtrlWithLRTB(Ja,275,0,null,15,60,null);Ja.css({"margin-left":"-50px",width:"40px"});Ja.appendTo(va);pa.addActionListener(function(){C.destroy()})});C.setClosingAction(function(){C.destroy()})})();
var za=function(){for(var va=[],pa=0;pa<W.length;pa++)W[pa].isChecked()&&va.push(W[pa].getUserObject().getId());if(0==va.length)return C.getDialogCtrl().getMessageCurtain().showPrompt(Ea.get("atLeastOnePublishInfo","\u8bf7\u81f3\u5c11\u9009\u4e2d\u4e00\u6761\u53d1\u5e03\u4fe1\u606f\u8fdb\u884c\u53d1\u5e03\u3002")),!1;P(va)}}function Pa(){var G,F,P,n,w,C,f=!1,V=!1,W={},za={},va,pa,Ja,ca,wa,na,Ia=!1,aa,X=!1,E,I,R=!0;this.setAlwaysShowSelectBtn=function(b){R=b};this.setPaginationBar=function(b){I=b};
this.setOuterMessageCurtain=function(b){n=b};this.setSingleSelected=function(b){V=!0;f=b};this.setPublishManager=function(b){Ia=b};this.getSelectedPublishModels=function(){var b=[],a;for(a in W)b.push(W[a]);return b};this.setSelectedChangeListener=function(b){pa=b};this.setDeletePublishListener=function(b){};this.setEditPublishListener=function(b){Ja=b};this.setReSearchListener=function(b){ca=b};this.setEditPublishContentListenter=function(b){wa=b};this.setCardImgUrlCreator=function(b){na=b};this.getJqUi=
function(){G||(G=$("<div>"),G.addClass("sa-qing-publish-manager-content-container"),P=$("<div>"),P.appendTo(G),F=$("<div>"),F.addClass("sa-qing-publish-manager-content-emptytip"),F.appendTo(G),aa=$("<div>"),Ia&&aa.css("margin-left","10px"),aa.appendTo(G));return G};this.setPublishModels=function(b,a){C=b;a&&(W={});P.addClass("sa-qing-publish-no-data-tips");sa.background(P,"no-data");if(null==C||0==C.length)X?F.text(Ea.get("emptySearchTips","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):
F.text(Ea.get("emptyPublish","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55")),P.show(),F.show(),aa.hide();else{P.hide();F.hide();aa.show();aa.empty();var d;E=new Z;za={};for(b=0;b<C.length;b++){a=C[b];var t=na(a.getImagePath());t=new Gb(a,t,n);t.setPublishManager(Ia);if(V){if(f)0==b&&1!=Object.keys(W).length&&(W={},W[a.getId()]=a),t.addSelectButton(ka,Gb.SINGLE_SELECTED_STYLE_SELECTBTN),t.setHideCardTypePic("subject"),E.addElement(t.getSelector());else{t.addSelectButton(c,Gb.MUTI_SELECTED_STYLE_SELECTBTN);
var y=R||0<Object.keys(W).length;t.setAlwaysShowSelectBtn(y)}W[a.getId()]&&(t.setSelected(!0),pa&&pa(a,!0))}za[a.getId()]=t;y=t.getJqUi();w&&a.getId()==w.getId()&&(d=y);(Ja||wa)&&l(t,a);y.appendTo(aa)}d&&u(d);g()}};this.setAutoSelectedModel=function(b){w=b};this.setTipsText=function(b){va=b;F&&(F.text(va),F.show(),aa.hide())};this.setAllPublishModels=function(b){};this.setSelectedPublishCardItem=function(b){W=b};this.getSelectedPublishCardItem=function(){return W};this.setSearchStatus=function(b){X=
b};this.updateSearchContentUI=function(b){if(X){var a=G.find(".sa-publish-item"),d;for(d in C){var t=void 0,y=a[d],z=C[d].getName();if(y&&z&&b){var p=b.toUpperCase(),Q=z.toUpperCase(),J=Q.split(p),U=p.length,O=$("<div>");O.addClass("sa-publish-item-head-name sa-qing-publish-fontfamily");for(t in J){var v=Q.indexOf(J[t]),A=z.substr(0,J[t].length);v+=J[t].length;var K=Q.length-v;Q=Q.substr(v,K);z=z.substr(v,K);v=$("<span>");v.text(A);v.appendTo(O);if(t!==J.length-1&&1<J.length){K=Q.indexOf(p);A=z.substr(K,
U);K+=U;var xa=Q.length-K;Q=Q.substr(K,xa);z=z.substr(K,xa);K=$("<span>");K.text(A);K.css("color","#FF0000");K.appendTo(v)}$(y).find(".sa-publish-item-head-name.sa-qing-publish-fontfamily").remove()}O.appendTo(y.children[0]);O.attr("title",O.text())}}}};var u=function(b){N("sa-qing-publish-manager-content-container",b);b.parent().children(".publish-card-selected").removeClass("publish-card-selected");b.addClass("publish-card-blink");b.addClass("publish-card-selected");setTimeout(function(){b.parent().children(".publish-card-blink").removeClass("publish-card-blink")},
2E3)},N=function(b,a){document.querySelector("."+b).scrollTop=a.prop("offsetTop")},ka=function(b,a,d){d&&f&&(a=a.isChecked(),b=b.getPublishModel(),a?(d=Object.values(W),pa&&d&&0<d.length&&pa(d[0],!1),W={},W[b.getId()]=b):delete W[b.getId()],pa&&pa(b,a))},c=function(b,a,d){d&&!f&&(a=a.isChecked(),b=b.getPublishModel(),a?(W[b.getId()]=b,R||1!=Object.keys(W).length||k(!0,b)):(delete W[b.getId()],R||0!=Object.keys(W).length||k(!1,b)),g(),pa&&pa(b,a))},l=function(b,a){var d=[],t=[];if(Ja){var y=function(){var z=
a.getPath();Ja(a,function(p){if(z==p.getPath())a.fromJsonObject(p.toJsonObject()),b.updateUi();else{b.getJqUi().remove();for(var Q=0;Q<C.length;Q++)C[Q].getId()==p.getId()&&C.splice(Q,1)}ca&&ca();n.showSuccess(Ea.get("updateSuccess","\u4fee\u6539\u6210\u529f\u3002"))})};d.push(y);t.push(Ea.get("editPublishInfoItem","\u7f16\u8f91\u53d1\u5e03\u4fe1\u606f"))}wa&&(y=function(){wa(a,function(z){z&&(a.setImagePath(z),z=na(z),b.refreshImage(z))})},d.push(y),t.push(Ea.get("editPublishContentItem","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848")));
1==t.length&&(t[0]=Ea.get("edit","\u7f16\u8f91"));b.addOperates("btn_edit",Ea.get("edit","\u7f16\u8f91"),t,d)},g=function(){if(!f&&I){var b=Object.keys(W).length;I.refreshSelectedRowTotal(b)}},k=function(b,a){for(var d=Object.keys(za),t=0;t<d.length;t++){var y=b||d[t]!=a.getId();za[d[t]].setAlwaysShowSelectBtn(b,y)}}}function kb(){ib.call(this);var G,F,P,n;this.setImagePath=function(f){G=f};this.getImagePath=function(){return G};this.getShowImagePath=function(){var f=G;return f=f?com.kingdee.bos.qing.framework.common.RemoteFramework.getLoadImgUrl(f,
"card-thumbnail"):pb.getIconUrl("publish","icon_dashboard_building.png")};this.setCreatorName=function(f){P=f};this.getCreatorName=function(){return P};this.setCreatorID=function(f){n=f};this.getCreatorID=function(){return n};this.setCardDesc=function(f){F=f};this.getCardDesc=function(){return F};var w=this.toJsonObject;this.toJsonObject=function(){var f=w();f.imagePath=G;f.cardDesc=F;f.creatorName=P;f.creatorId=n;return f};var C=this.fromJsonObject;this.fromJsonObject=function(f){C(f);G=f.imagePath;
F=f.cardDesc;P=f.creatorName;n=f.creatorId}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.publish&&(com.kingdee.bos.qing.publish={});var fb=com.kingdee.bos.qing.publish;fb.CardSelector=function(G,F){La.call(this,G,nb.CARD_REPOSITORY);var P=this,n=this.protectedMethod,w,C=!1,f,V=!0,W,za,va,pa=[],
Ja=!1,ca=!0,wa=[],na,Ia=!1,aa=!1,X,E,I,R,u,N,ka,c,l,g,k,b=[],a=[],d=[],t=!1,y=!1,z,p=[],Q=[],J=[],U=[],O=[new Ua(Ea.get("myCard","\u6211\u7684\u5361\u7247"),!1),new Ua(Ea.get("presetCard","\u9884\u7f6e\u5361\u7247"),!0)],v={},A={},K,xa;this.setParamPathPrefix=function(L){na=L};this.setSingleSelected=function(L){Ja=L};this.getSelectedPublishModels=function(){return ca?u.getSelectedPublishModels():N.getSelectedPublishModels()};this.showDSBCard=function(L){C=L};var fa=[new Ua(Ea.get("allType","\u5168\u90e8\u7c7b\u578b"),
2),new Ua(Ea.get("moduleSquare","\u6570\u636e\u6597\u65b9"),0),new Ua(Ea.get("dashboard","\u4eea\u8868\u677f"),1)],da=2;this.getJqUi=function(){w||(w=B());return w};var B=function(){var L=$("<div>"),ta=D();ta.appendTo(L);var Ta=$("<div>");Ta.addClass("sa-qing-publish-manager");u=ab();ka=u.getJqUi();N=Ya();c=N.getJqUi();c.hide();var sb=$("<div class='sa-qing-card-selector-tab'>");Ba.layoutCtrlWithLRTB(sb,0,null,220,0,0,null);var Fb=$("<div class='sa-qing-card-selector-tab-head'>");Ba.layoutCtrlWithLRTB(Fb,
0,0,null,0,null,34);f=W=Ha();var mb=W.getJqUi(),Za=$("<span class='sa-qing-card-selector-tab-head-text'>");Za.text(Ea.get("ByPublisher","\u6309\u53d1\u5e03\u4eba"));Za.addClass("sa-qing-card-selector-tab-head-selected");Za.on("click",function(){f=W;V=!0;var vb=W.getJqUi();Za.addClass("sa-qing-card-selector-tab-head-selected");var Lb=W.getSelectedModel();vb.show();vb=za.getJqUi();Bb.removeClass("sa-qing-card-selector-tab-head-selected");vb.hide();tb(Lb);M()});za=ya();var jb=za.getJqUi();jb.hide();
za.setEmptyMenudHint(Ea.get("noSharedCards","\u6682\u672a\u6536\u5230\u4ed6\u4eba\u53d1\u5e03\u7684\u5361\u7247"));var Bb=$("<span class='sa-qing-card-selector-tab-head-text'>");Bb.css("left","10px");Bb.text(Ea.get("ByDirectory","\u6309\u76ee\u5f55"));Bb.attr("title",Ea.get("ByDirectory","\u6309\u76ee\u5f55"));Bb.css({overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"});Bb.on("click",function(){f=za;V=!1;var vb=za.getJqUi();Bb.addClass("sa-qing-card-selector-tab-head-selected");vb.show();
vb=W.getJqUi();Za.removeClass("sa-qing-card-selector-tab-head-selected");vb.hide();null!=va&&0==pa.length?(vb=n.createFacade(function(Lb){pa=r(Lb);for(Lb=0;Lb<pa.length;Lb++)pa[Lb].isPreset()?J.push(pa[Lb]):U.push(pa[Lb]);J.unshift(U[0]);pa=t?J:U;e();ua();za.updateUI();M()},function(Lb,Mb){return!1}),vb.setShowBlocking(!0),vb.loadCardGroupByDirectory(C)):(vb=za.getSelectedModel(),eb(vb),M())});Za.appendTo(Fb);Bb.appendTo(Fb);var Kb=$("<div class='sa-qing-card-selector-tab-container'>");Ba.layoutCtrlWithLRTB(Kb,
0,0,null,35,0,null);mb.appendTo(Kb);jb.appendTo(Kb);Fb.appendTo(sb);Kb.appendTo(sb);sb.appendTo(Ta);sb=$("<div>");Ba.layoutCtrlWithLRTB(sb,225,0,null,0,0,null);ka.appendTo(sb);c.appendTo(sb);sb.appendTo(Ta);Ta.appendTo(L);Ba.layoutCtrlWithLRTB(Ta,0,0,null,40,0,null);Ja&&(ta.css("top","-10px"),Ba.layoutCtrlWithLRTB(Ta,0,0,null,32,0,null));return L},D=function(){var L=$("<div class='sa-qing-publish-titlebar'>");xa=T(O,oa);k=xa.getJqUi();k.appendTo(L);k.hide();C&&T(fa,la).getJqUi().appendTo(L);var ta=
new hb;ta.setSearchListener(M);l=ta;l.getJqUi().appendTo(L);ta=new Ab;ta.setSortModel(qa);g=ta;ta=g.getJqUi();ta.appendTo(L);Ba.layoutCtrlWithLRTB(ta,500,70,null,0,0,null);ta=new Sa;ta.setClickListener(H);ta.getJqUi().appendTo(L);return L},T=function(L,ta){var Ta=new cb;Ta.setSearchType(L);Ta.setSelectedChangedListener(ta);return Ta},la=function(L,ta,Ta){da=Ta.getTypeId();K=2==da?void 0:1==da?"dashboard":"subject";M()},oa=function(L,ta,Ta){L=Ta.getTypeId();ta=W.getLastSelectedItem();Ta=za.getLastSelectedItem();
t?(d[1]=ta,d[3]=Ta,d[0]&&W.setLastSelectedItem(d[0]),d[2]&&za.setLastSelectedItem(d[2]),va=Q,pa=U,R=a):(d[0]=ta,d[2]=Ta,d[1]&&W.setLastSelectedItem(d[1]),d[3]&&za.setLastSelectedItem(d[3]),va=p,pa=J,R=b);t=L;e();Y();M()},ra=function(){var L=[];if(aa){var ta=l.getInputContent().trim();ta=ta.toUpperCase();for(var Ta in I)-1<I[Ta].getName().toUpperCase().indexOf(ta)&&L.push(I[Ta])}else L=I;ca?(u.setSearchStatus(aa),u.setPublishModels(L,y),u.updateSearchContentUI(ta)):(N.setSearchStatus(aa),N.setListPublishModel(L,
V,y),N.updateSelectorSearchContentUI(ta))},qa=function(L,ta){if(R&&0<R.length){switch(ta){case Hb.SORT_TYPE_ASC:L=Ka(L.getPropertyName(),!0);R.sort(L);break;case Hb.SORT_TYPE_DESC:L=Ka(L.getPropertyName(),!1);R.sort(L);break;default:L=Ka(L.getPropertyName(),!1),R.sort(L)}x()}Ia&&(Y(),e());M()},Ka=function(L,ta){return"name"==L?function(Ta,sb){Ta=Ta.toJsonObject();sb=sb.toJsonObject();sb=Ta[L].localeCompare(sb[L],"zh-Hans-CN",{sensitivity:"accent"});return ta?sb:-sb}:function(Ta,sb){Ta=Ta.toJsonObject();
var Fb=sb.toJsonObject();sb=Ta[L];Ta=Fb[L];Fb=0;sb>Ta?Fb=1:Ta>sb&&(Fb=-1);return ta?Fb:-Fb}},H=function(L){if(ca!=L){if(L){var ta=N.getSelectedPublishCardItem();u.setSelectedPublishCardItem(ta);ka.show();c.hide()}else ta=u.getSelectedPublishCardItem(),N.setSelectedPublishCardItem(ta),c.show(),ka.hide();ca=L;M()}},M=function(){if(Ia){var L=l.getInputContent().trim();if(0<L.length){aa=!0;L=L.toUpperCase();Y();R&&e();var ta={};ua();if(V){for(var Ta=0,sb=0;sb<va.length;sb++){var Fb=Oa(va[sb]);if("allCard"!=
Fb){ta[Fb]=0;for(var mb=v[Fb],Za=0;Za<mb.length;Za++)ma(mb[Za])&&-1<mb[Za].getName().toUpperCase().indexOf(L)&&(ta[Fb]+=1,Ta+=1)}}ta.allCard=Ta;f.updateSearchUI(va,ta)}else{for(sb=Ta=0;sb<pa.length;sb++)if(Fb=Oa(pa[sb]),"allCard"!=Fb)for(ta[Fb]=0,mb=A[Fb],Za=0;Za<mb.length;Za++)ma(mb[Za])&&-1<mb[Za].getName().toUpperCase().indexOf(L)&&(ta[Fb]+=1,Ta+=1);ta.allCard=Ta;f.updateSelectorSearchUI(pa,ta)}}else aa=!1,ua(),V?f.setModel(va):f.setModel(pa),f.updateUI()}},ma=function(L){var ta=!0;switch(K){case "dashboard":ta=
"dashboard"==L.getPublishSourceType();break;case "subject":ta="dashboard"!=L.getPublishSourceType()}return ta},Oa=function(L){return"allCard"==L.getValue()?L=L.getValue():L=V?L.getValue():L.isPreset()?L.getValue():L.getText()},Ha=function(){var L=new zb;L.setIsCardSelector(!0,!0);L.setOuterMessageCurtain(n.getOuterMessageCurtain());L.setSelectedItemListener(tb);L.setModel(va);L.setEditable(!1);L.setLoadItemListener(rb);return L},ya=function(){var L=new zb;L.setIsCardSelector(!0,!1);L.setOuterMessageCurtain(n.getOuterMessageCurtain());
L.setSelectedItemListener(eb);L.setModel(pa);L.setEditable(!1);L.setLoadItemListener(xb);return L},ab=function(){var L=new Pa;L.setSingleSelected(Ja);L.setCardImgUrlCreator(q);L.setSelectedChangeListener($a);return L},Ya=function(){var L=new m;L.setDeletePublishListener(Ra);L.setEditPublishListener(Fa);L.setIsDashBoardSelector(C);L.setSelectedChangeListener($a);L.setSingleSelected(Ja);L.setCardImgUrlCreator(q);return L},$a=function(L,ta){if(!Ja||ta){if(ta)F&&F.sendSelectCardId(L.getId(),L.getName()),
-1==wa.indexOf(L)&&wa.push(L);else{for(ta=0;ta<wa.length;ta++)wa[ta].getId()==L.getId()&&wa.splice(ta,1);F&&F.sendCancelCardId(L.getId())}N.setListSelectedModel(wa)}},tb=function(L){if(f==W){y=z!=L?!0:!1;z=L;Ia||(Ia=!0,u.setAllPublishModels(R));X="allCard"==L.getValue()?R:v[L.getValue()];L=[];switch(da){case 1:for(var ta=0;ta<X.length;ta++)"dashboard"==X[ta].getPublishSourceType()&&L.push(X[ta]);I=L;break;case 0:for(ta=0;ta<X.length;ta++)"dashboard"!=X[ta].getPublishSourceType()&&L.push(X[ta]);I=
L;break;case 2:I=X}ra()}},ha=function(L){var ta=n.createFacade(function(Ta){for(var sb=0;sb<Ta.length;sb++){var Fb=new kb;Fb.fromJsonObject(Ta[sb]);if(C||Fb.getPublishSourceType()!=Ib.DASHBOARD)Fb.isPreset()?b.push(Fb):a.push(Fb)}R=a;0<b.length&&(k.show(),0==a.length&&(R=b,va=p,xa.setSelected(O[1]),t=!0));x();Y();ua();L(va)});ta.setShowBlocking(!0);ta.loadAllSelectorPublishInfos(C)},ua=function(){if(V){va[0].setIsShow(!0);for(var L=1;L<va.length;L++){va[L].setIsShow(!1);var ta=v[va[L].getValue()];
ta&&va[L].setIsShow(Da(ta))}}else for(pa[0].setIsShow(!0),L=1;L<pa.length;L++)pa[L].setIsShow(!1),(ta=pa[L].isPreset()?A[pa[L].getValue()]:A[pa[L].getText()])&&pa[L].setIsShow(Da(ta))},Da=function(L){for(var ta=0;ta<L.length;ta++)if(t){if(-1<b.indexOf(L[ta]))return!0}else if(-1<a.indexOf(L[ta]))return!0;return!1},eb=function(L){y=z!=L?!0:!1;z=L;E=R&&"allCard"==L.getValue()?R:L.isPreset()?A[L.getValue()]:A[L.getText()];L=[];switch(da){case 1:for(var ta=0;ta<E.length;ta++)"dashboard"==E[ta].getPublishSourceType()&&
L.push(E[ta]);I=L;break;case 0:for(ta=0;ta<E.length;ta++)"dashboard"!=E[ta].getPublishSourceType()&&L.push(E[ta]);I=L;break;case 2:I=E}ra()},r=function(L){for(var ta=[],Ta=0;Ta<L.length;Ta++){var sb=new Db;sb.setValue(L[Ta].id);sb.setText(L[Ta].name);sb.setIsPreset(L[Ta].isPreset);ta.push(sb)}return ta},Y=function(){for(var L=0;L<va.length;L++)"allCard"!=va[L].getValue()&&(v[va[L].getValue()]=[]);for(L=0;L<R.length;L++){var ta=R[L].isPreset()?"100000":R[L].getCreatorID();v[ta]&&v[ta].push(R[L])}v.allCard=
R},e=function(){for(var L,ta=0;ta<pa.length;ta++)"allCard"!=pa[ta].getValue()&&(L=pa[ta].isPreset()?pa[ta].getValue():pa[ta].getText(),A[L]=[]);for(ta=0;ta<R.length;ta++)L=R[ta].isPreset()?R[ta].getPath():R[ta].getPathText(),A[L]&&A[L].push(R[ta]);A.allCard=R},x=function(){for(var L=[],ta=[],Ta=0;Ta<R.length;Ta++)R[Ta].isPreset()?L.push(R[Ta]):ta.push(R[Ta]);R=L.concat(ta)},q=function(L){if(!L)return pb.getIconUrl("publish","icon_dashboard_building.png");if("publish"==L.substring(2,9))return L;var ta=
n.createFacade(),Ta=P.getPublishContext(),sb=na;Ta&&(sb=Ta.getParamPathPrefix());return ta.getCardImgUrl(sb,L)},Fa=function(L,ta){var Ta=P.getPublishContext();L=db.createPublishToEditDialog(G,Ta,L);L.addSuccessCallback(ta);L.setOuterMessageCurtain(n.getOuterMessageCurtain());L.showDialog()},Ra=function(L,ta){L=L.getId();var Ta=n.createFacade(function(sb){ta();n.getOuterMessageCurtain().showSuccess(Ea.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},function(sb,Fb){return!1});Ta.setShowBlocking(!1);
Ta.deletePublishInfo(nb.CARD_REPOSITORY,L)},rb=function(L){if(null==va){var ta=n.createFacade(function(Ta){va=r(Ta);for(Ta=0;Ta<va.length;Ta++)for(Ta=0;Ta<va.length;Ta++)va[Ta].isPreset()?p.push(va[Ta]):Q.push(va[Ta]);p.unshift(Q[0]);va=Q;R=null;ha(L)},function(Ta,sb){return!1});ta.setShowBlocking(!0);ta.loadCardGroupByPerson(C)}else L(va)},xb=function(L){if(null==pa){var ta=n.createFacade(function(Ta){pa=r(Ta);ua();L(pa)},function(Ta,sb){return!1});ta.setShowBlocking(!0);ta.loadCardGroupByDirectory(C)}else L(pa)}};
fb.CardModel=kb;var nb,Db,Ib,ib,Gb,qb,Ma,Ga,db,ba,ia,La,Wa,ob,zb,sa,m,Qa,Na,Xa,pb,Ba,Cb,h,ja,gb,Ea,bb,wb,ub,Jb,lb,Eb,Hb,yb,cb,Ab,Sa,hb,Ua,ea,Ca,S,Z;(function(){var G=com.kingdee.bos.qing;pb=G.CodeLoader;G=com.kingdee.bos.qing.common;Ba=G.DomUtil;ja=G.DateFormater;gb=G.Util;G=com.kingdee.bos.qing.framework.common;Ea=G.MultilanguageManager.createPackageAccessor(fb);bb=G.RemoteFramework;G=com.kingdee.bos.qing.publish.common;db=G.PublishFactory;ba=G.PublishFacade;ia=G.AbstractPublishToPanel;La=G.AbstractPublishManagerPanel;
Wa=G.SinglePublishManagerDialog;yb=G.ListPublishContentPanel;ob=G.ListItemSelector;zb=G.MenuPanel;sa=G.MyIcons;Hb=G.SortWidget;m=G.SelectorListPublishContentPanel;cb=G.FilterModelType;Ab=G.PublishManagerSortPanel;Sa=G.PublishViewSwitchPanel;Gb=G.PublishCardItem;hb=G.PublishSearchPanel;Ua=G.CardFilterType;ea=G.PublishContext;Ca=G.DisplayPublishedRecordName;G=com.kingdee.bos.qing.publish.model;nb=G.PublishTargetType;Ib=G.PublishSourceType;ib=G.PublishModel;qb=G.PermissionConfig;Ma=G.PublishContainerType;
G=com.kingdee.bos.qing.biz.common;Db=G.ValueTextPair;G=com.kingdee.bos.qing.ui.component;wb=G.Label;ub=G.TextField;Jb=G.TextArea;lb=G.SwitchButton;Eb=G.MessageDialog;S=G.List;Z=G.RadioButtonGroup;Qa=G.AbstractModalDialog;Na=G.Button;Xa=G.CheckBox;G=com.kingdee.bos.qing.common.ui;Cb=G.CommonIconUtil;h=G.TableUtil;G=com.kingdee.bos.qing.publish.permission;Ga=G.PermLabelSettingDialog})();pb.setRootPath(".");pb.loadJs("biz-common/qing-biz-common.js");pb.loadSkinCss("biz-common","biz-common");pb.loadSkinJs("biz-common",
"skin");pb.loadI18n("biz-common","biz-common");db.addPublishFacade(nb.CARD_REPOSITORY,function(G,F,P,n){ba.call(this,G,F,P,n);var w=this.protectedMethod;this.loadGroups=function(C){w.remote("loadGroups",{publishTargetType:nb.CARD_REPOSITORY,isPreset:C})};this.loadCardGroupByDirectory=function(C){w.remote("loadCardGroupByDirectory",{publishTargetType:nb.CARD_REPOSITORY,showDSBCard:C})};this.loadAllPublishInfos=function(C){w.remote("loadAllPublishInfos",{publishTargetType:nb.CARD_REPOSITORY,isPresetPublish:C})};
this.loadAllPublishInfosByPagination=function(C,f,V,W,za,va,pa,Ja){w.remote("loadAllPublishInfosByPagination",{publishTargetType:nb.CARD_REPOSITORY,isPresetPublish:C,path:f,targetPage:V,pageSize:W,searchText:za,currentType:va,sortField:pa,sortOrder:Ja})};this.loadHitNumberOfAllPath=function(C,f,V){w.remote("loadHitNumberOfAllPath",{publishTargetType:nb.CARD_REPOSITORY,isPresetPublish:C,searchText:f,currentType:V})};this.loadAllSelectorPublishInfos=function(C){w.remote("loadAllSelectorPublishInfos",
{publishTargetType:nb.CARD_REPOSITORY,showDSBCard:C})};this.loadCardGroupByPerson=function(C){w.remote("loadCardGroupByPerson",{publishTargetType:nb.CARD_REPOSITORY,showDSBCard:C})};this.saveGroup=function(C){w.remote("saveGroup",{publishTargetType:nb.CARD_REPOSITORY,name:C})};this.updateGroup=function(C,f){w.remote("updateGroup",{publishTargetType:nb.CARD_REPOSITORY,id:C,name:f})};this.deleteGroup=function(C){w.remote("deleteGroup",{publishTargetType:nb.CARD_REPOSITORY,id:C})};this.loadPublishInfos=
function(C,f){w.remote("loadPublishInfos",{publishTargetType:nb.CARD_REPOSITORY,path:C,isPreset:f})};this.loadOtherShareCardBaseInfo=function(C,f){w.remote("loadOtherShareCardBaseInfo",{publishTargetType:nb.CARD_REPOSITORY,showDSBCard:C,ownerId:f})};this.getCardImgUrl=function(C,f){return com.kingdee.bos.qing.framework.common.RemoteFramework.getLoadImgUrl(f,"card-thumbnail")};this.updateCardThumbnail=function(C,f,V){w.remote("updateCardThumbnail",{publishTargetType:nb.CARD_REPOSITORY,publishId:C,
fromPageClientId:f,subscribeKey:V})};this.exportEmbeddedPublishInfo=function(C){C={publishTargetType:nb.CARD_REPOSITORY,selectedPublishModelIds:JSON.stringify(C)};w.remote("exportEmbeddedPublishInfo",C)};this.getExportedData=function(C){var f=gb.formatDate("yyyyMMdd_HHmmss");bb.downloadFile("Qing-"+f+".qing-pkg",C)}});db.addPublishToPanel(nb.CARD_REPOSITORY,function(G,F){ia.call(this,G,F);var P=this,n=this.protectedMethod,w,C,f,V,W,za,va,pa,Ja,ca,wa,na,Ia,aa,X=new S,E;this.getHeight=function(){return 600};
this.getWidth=function(){return 945};this.getJqUi=function(){w||R();return w};this.setPublishModel=function(b){na=b};this.isEditPublish=function(){return null!=na};this.setPublishContext=function(b){wa=b};this.getPublishContext=function(){return wa};this.setPathSelectorModel=function(b){Ia=b};this.createAddToHomepageUi=function(){if(!P.isEditPublish()){var b=!1;try{var a=com.kingdee.bos.qing.integration.CardHomepageAddHelper;a&&a.addCardToHomepage&&(b=!0)}catch(t){console&&console.warn("unsupport add card to Homepage",
t)}if(b){va=new Xa;va.setText(Ea.get("addToHomepage","\u6dfb\u52a0\u5230\u5f53\u524d\u7528\u6237\u9996\u9875"));va.setChecked(!0);var d=va.getJqUi()}return d}};var I=function(){var b=!1;if(na&&na.getPublishSourceType()==Ib.DASHBOARD||wa&&wa.getCurrentSourceType()==Ib.DASHBOARD&&!na)b=!0;return b},R=function(){var b=I(),a=P.isEditPublish();w=$("<div>");f=$("<div>");f.addClass("qing-publish-info-wrapper");f.css({"padding-right":"10px",width:"41%"});var d=(new wb(Ea.get("publishSetting","\u53d1\u5e03\u8bbe\u7f6e\uff1a"))).getJqUi();
d.addClass("qing-publish-info-label");Ba.layoutCtrlWithLRTB(d,0,0,null,0,null,23);f.append(d);C=$("<div>");C.addClass("qing-publish-info-item");d=new wb(Ea.get("publishName","\u53d1\u5e03\u540d\u79f0"));d.setRequired(!0);d=d.getJqUi();d.addClass("qing-publish-info-label");Ba.layoutCtrl(d,0,0,105,23);V=new ub;var t=$("<div>");V.addEditedListener(function(J){clearTimeout(E);E=setTimeout(function(){var U=V.getText();if(""!=U){var O=new Ca(F,G);null!=na?O.setPublishModel(na):O.setPublishContext(wa);O.getPublishedRecordNameByInputText(U,
F,function(v){t.empty();v=v[V.getText()];if(null!=v){X.setCustomItemPainter(function(fa,da){fa.on("mousedown",function(B){V.setText(da);t.remove();B.stopPropagation()});fa.text(da);fa.attr("title",da)});X.setItemModels(v);X.setSelecteds([v[0]]);v=X.getJqUi();var A=y.width(),K=y.css("left"),xa=y.position().top+y.height();Ba.layoutCtrl(t,K,xa,A,122);t.css("z-index","9999");v.css({width:A+"px",height:"122px"});v.find(".sa-ctrl-list-owner").css("height","100px");A=$("<div>");A.addClass("history-publish-name");
A.text(Ea.get("HistoryPublishName","\u5386\u53f2\u53d1\u5e03\u540d\u79f0"));A.css({right:"13px",top:"100px"});v.appendTo(t);A.appendTo(t);C.append(t)}else t.remove()})}else t.remove()},1E3)});V.addBlurListener(function(){t.remove()});var y=V.getJqUi();Ba.layoutCtrl(y,115,0,220,23);C.append(d);C.append(y);d=new wb(Ea.get("publishPath","\u53d1\u5e03\u8def\u5f84"));d.setRequired(!0);var z=d.getJqUi();z.addClass("qing-publish-info-label");Ba.layoutCtrl(z,0,0,105,23);W=ka();d=W.getJqUi();var p=$("<div>");
p.addClass("qing-publish-info-item");p.append(z);p.append(d);z=$("<div>");z.css("margin-top","28px");z.addClass("qing-publish-info-items-block");z.append(C);z.append(p);f.append(z);a?Ba.layoutCtrl(d,115,0,220,23):(z=N(),Ba.layoutCtrl(z,317,4,18,18),p.append(z),Ba.layoutCtrl(d,115,0,197,23));d=!1;a||(p=(new wb(Ea.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e"))).getJqUi(),p.attr("title",Ea.get("carryData","\u4ee5\u540e\u4e0d\u518d\u66f4\u65b0\u6570\u636e")),p.addClass("qing-publish-info-label"),
Ba.layoutCtrl(p,0,0,105,23),pa=new lb,wa.getHasDirectModeTable()?(pa.setOn(!1),pa.setEnabled(!1)):wa.isHaveToCarryData()?(pa.setOn(!0),pa.setEnabled(!1)):pa.setOn(!1),z=pa.getJqUi(),Ba.layoutCtrl(z,115,0,220,23),wa.supportPublishWithCarryData()&&(d=!0,a=$("<div>"),a.addClass("qing-publish-info-item"),a.append(p),a.append(z),p=$("<div>"),p.addClass("qing-publish-info-items-block"),p.append(a),f.append(p)));a=$("<div>");a.addClass("qing-publish-info-items-block");d&&a.css("height","283px");f.append(a);
d=(new wb(Ea.get("description","\u63cf\u8ff0"))).getJqUi();d.attr("title",Ea.get("description","\u63cf\u8ff0"));d.addClass("qing-publish-info-label");Ba.layoutCtrl(d,0,0,105,23);za=new Jb;p=za.getJqUi();Ba.layoutCtrl(p,115,0,220,50);z=$("<div>");z.addClass("qing-publish-info-item");z.css("height","50px");z.append(d);z.append(p);a.append(z);if(b){var Q=$("<div>");Q.addClass("qing-publish-info-item");Q.css("height","140px");b=new wb;b.setText(Ea.get("thumbnail","\u7f29\u7565\u56fe"));b=b.getJqUi();
b.addClass("qing-publish-info-label");Ba.layoutCtrl(b,0,0,105,23);na&&na.getImagePath()&&(Ja=com.kingdee.bos.qing.framework.common.RemoteFramework.getLoadImgUrl(na.getImagePath(),"card-thumbnail"));ca=new com.kingdee.bos.qing.imagelib.choose.ui.ChooseThumbnailPane;ca.setDsbThumbnailDeleteCallBack(function(J,U,O){ca.getThumbnailUrlModel().getImageFileName()===J&&(J=Cb.createWarning(),J.addClass("dm-entity-list-item-notexist"),J.attr("title",Ea.get("imgHasBeenDeleted","\u201c\u7f29\u7565\u56fe\u201d\u5f15\u7528\u7684\u56fe\u7247\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e")),
Ba.layoutCtrl(J,115,0),J.appendTo(Q))});ca.setRemoveImgNotExistIconCallBack(function(){f.find(".dsb").remove()});d=ca.init(Ja);Ba.layoutCtrl(d,115,0,220,140);Q.append(b);Q.append(d);a.append(Q)}b=$("<div>");b.addClass("qing-publish-info-wrapper");b.css({"padding-left":"10px",width:"59%"});a=ea.Scene.Square;I()?a=ea.Scene.Dashboard:(d=na?na.getPublishSourceType()==Ib.EXTREPORT:wa.getCurrentSourceType()==Ib.EXTREPORT,d&&(a=ea.Scene.Report));aa=n.createPermConfigPanel(a,wa.getSpaceID());a=aa.getJqUi();
b.append(a);f.appendTo(w);b.appendTo(w);l()};this.getNewPublishSuccessCallback=function(){return u};var u=function(b,a){if(va&&va.isChecked())try{com.kingdee.bos.qing.integration.CardHomepageAddHelper.addCardToHomepage(b.getId(),b.getName())}catch(d){console&&console.error("Add card to Homepage failed",d)}a.showSuccess(Ea.get("publishSuccess","\u53d1\u5e03\u6210\u529f\u3002"))},N=function(){var b=$("<span>");b.attr("title",Ea.get("publishManage","\u53d1\u5e03\u7ba1\u7406"));sa.background(b,"publish_manager");
b.on("click",function(){var a=new Aa(P.getRemoteImpl());a.setPublishContext(wa);a.setPathSelectorModel(Ia);a.setPublishContentEditEntrance(P.getPublishContentEditEntrance());a=new Wa(a);a.setClosedCallback(function(d){Ia=d.getPathSelectorModel();W.setListItem(g());if(d=W.getSelectedValue()){for(var t=null,y=0;y<Ia.length;y++){var z=Ia[y];if(z.getValue()==d.getValue()){t=z;break}}W.setSelectedValue(t)}});a.showDialog()});return b},ka=function(){var b=new ob;b.setPlaceholder(Ea.get("selectPublishPath",
"\u8bf7\u9009\u62e9\u53d1\u5e03\u8def\u5f84"));b.setMaxHeight(118);c(b);return b},c=function(b){if(null==Ia){var a=n.createFacade(function(d){for(var t=[],y=0;y<d.length;y++){var z=new Db;z.setValue(d[y].id);z.setText(d[y].name);z.setIsPreset(d[y].isPreset);t.push(z)}Ia=t;b.setListItem(g())},function(d,t){return!1});a.setBlockingJqUi(w);a.setShowBlocking(!0);a.loadGroups(!1)}else b.setListItem(g())},l=function(){if(na){V.setText(na.getName());var b=new Db;b.setValue(na.getPath());b.setText(na.getPathText());
W.setSelectedValue(b);za.setText(na.getCardDesc());b=new qb;b.setRoles(na.getRoles());b.setUsers(na.getUsers());b.setNoOperateValue(na.getNoOperValueMap());b.setPermLabels(na.getPermLabels());aa.setPermissionConfig(b)}n.loadParentNoOperateValue(wa,na,function(a){aa.setParentNoOperateValue(a)})},g=function(){for(var b=[],a=0;a<Ia.length;a++)Ia[a].isPreset()||b.push(Ia[a]);return b};this.getJsonModel=function(){return wa.getCurrentContentModel()};this.getAnalysisSchemaArray=function(){return wa.getChoiceAnalysisSchema()};
this.getModelFromUI=function(){var b=new kb;if(null==na){b.setPublishSourceType(wa.getCurrentSourceType());b.setPublishTargetType(P.getPublishTargetType());b.setTagId(wa.getBizTag());b.setSpaceID(wa.getSpaceID());if(ca){var a=ca.getDashboardThumbnailUrl();b.setImagePath(a)}b.setSchemeId(ib.CURRENT_SCHEMA_ID)}else b=na,ca&&ca.isImageChange()&&(a=ca.getDashboardThumbnailUrl(),b.setImagePath(a)),b.setSchemeId(na.getSchemeId());b.setName($.trim(V.getText()));a=W.getSelectedValue();b.setPath(a.getValue());
b.setPathText(a.getText());b.setAnalysis(!0);pa&&(a=pa.isOn(),b.setCarryData(a));b.setCardDesc(za.getText());if(a=aa?aa.getPermissionConfig():null)b.setRoles(a.getRoles()),b.setUsers(a.getUsers()),b.setNoOperValueMap(a.getNoOperateValue()),b.setPermLabels(a.getPermLabels());return b};var k=function(b){if(ca){var a=ca.getDashboardThumbnailUrl(),d=new com.kingdee.bos.qing.imagelib.model.ThumbnailUrlModel;a=d.getImagePathFromJson(a);d.checkHasImage(a,b)}else b(!1)};this.checkUIInput=function(b){var a=
V.getText();if(null==a||0==$.trim(a).length)return Ea.get("publishNameNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u540d\u79f0\u3002");if(50<a.length&&50<za.getText().length)return Ea.get("nameAndDescriptionCanNotExceedLimit50Tip","\u53d1\u5e03\u540d\u79f0\u3001\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(50<a.length)return Ea.get("publishNameTooLongTip","\u53d1\u5e03\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(W.getSelectedValue()){if(50<
za.getText().length)return Ea.get("descriptionCanNotExceedLimit50Tip","\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");I()?k(function(d){d?b(!0):(n.getOuterMessageCurtain().showPrompt(Ea.get("imgHasBeenDeleted","\u201c\u7f29\u7565\u56fe\u201d\u5f15\u7528\u7684\u56fe\u7247\u5df2\u88ab\u5220\u9664\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")),b(!1))}):b(!0)}else return Ea.get("publishPathNotEmptyTip","\u8bf7\u8f93\u5165\u53d1\u5e03\u8def\u5f84\u3002");return null}});db.addPublishManagePanel(nb.CARD_REPOSITORY,
Aa)})();
//qingVersionTag: 20250324