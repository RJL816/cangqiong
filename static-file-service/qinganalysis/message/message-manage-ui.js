var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(q,m,h){q instanceof String&&(q=String(q));for(var u=q.length,z=0;z<u;z++){var P=q[z];if(m.call(h,P,z,q))return{i:z,v:P}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(q,m,h){if(q==Array.prototype||q==Object.prototype)return q;q[m]=h.value;return q};$jscomp.getGlobal=function(q){q=["object"==typeof globalThis&&globalThis,q,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var m=0;m<q.length;++m){var h=q[m];if(h&&h.Math==Math)return h}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(q,m){var h=$jscomp.propertyToPolyfillSymbol[m];if(null==h)return q[m];h=q[h];return void 0!==h?h:q[m]};
$jscomp.polyfill=function(q,m,h,u){m&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(q,m,h,u):$jscomp.polyfillUnisolated(q,m,h,u))};$jscomp.polyfillUnisolated=function(q,m,h,u){h=$jscomp.global;q=q.split(".");for(u=0;u<q.length-1;u++){var z=q[u];if(!(z in h))return;h=h[z]}q=q[q.length-1];u=h[q];m=m(u);m!=u&&null!=m&&$jscomp.defineProperty(h,q,{configurable:!0,writable:!0,value:m})};
$jscomp.polyfillIsolated=function(q,m,h,u){var z=q.split(".");q=1===z.length;u=z[0];u=!q&&u in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var P=0;P<z.length-1;P++){var v=z[P];if(!(v in u))return;u=u[v]}z=z[z.length-1];h=$jscomp.IS_SYMBOL_NATIVE&&"es6"===h?u[z]:null;m=m(h);null!=m&&(q?$jscomp.defineProperty($jscomp.polyfills,z,{configurable:!0,writable:!0,value:m}):m!==h&&(void 0===$jscomp.propertyToPolyfillSymbol[z]&&(h=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[z]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(z):$jscomp.POLYFILL_PREFIX+h+"$"+z),$jscomp.defineProperty(u,$jscomp.propertyToPolyfillSymbol[z],{configurable:!0,writable:!0,value:m})))};$jscomp.polyfill("Array.prototype.find",function(q){return q?q:function(m,h){return $jscomp.findInternal(this,m,h).v}},"es6","es3");
(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.message&&(com.kingdee.bos.qing.message={});"undefined"==typeof com.kingdee.bos.qing.message.model&&(com.kingdee.bos.qing.message.model={});var q=com.kingdee.bos.qing.message.model;q.MessageDetailVo=function(){var h=this,u,z,P,v,ka,na,la,W,
ma,n,c,t,k,D,x,N;this.getMessageId=function(){return u};this.setMessageId=function(b){u=b};this.getMessageReceiverRelId=function(){return z};this.setMessageReceiverRelId=function(b){z=b};this.getMessageLevel=function(){return P};this.setMessageLevel=function(b){P=b};this.getMessageType=function(){return v};this.setMessageType=function(b){v=b};this.getBizType=function(){return ka};this.setBizType=function(b){ka=b};this.getBizId=function(){return na};this.setBizId=function(b){na=b};this.getMessageTitle=
function(){return la};this.setMessageTitle=function(b){la=b};this.getMessageContent=function(){return W};this.setMessageContent=function(b){W=b};this.getSenderId=function(){return n};this.setSenderId=function(b){n=b};this.getSendDate=function(){return c};this.setSendDate=function(b){c=b};this.getSendDateStr=function(){return t};this.setSendDateStr=function(b){t=b};this.getSendDateFormatStr=function(){return k};this.setSendDateFormatStr=function(b){k=b};this.getMessageContentStr=function(){return ma};
this.setMessageContentStr=function(b){ma=b};this.getReceiverId=function(){return D};this.setReceiverId=function(b){D=b};this.getReadDate=function(){return x};this.setReadDate=function(b){x=b};this.getIsRead=function(){return N};this.setIsRead=function(b){N=b};this.fromJsonObject=function(b){b&&(h.setMessageId(b.messageId),h.setMessageLevel(b.messageLevel),h.setMessageType(b.messageType),h.setBizType(b.bizType),h.setBizId(b.bizId),h.setMessageTitle(b.messageTitle),h.setMessageContent(b.messageContent),
h.setSenderId(b.senderId),h.setSendDate(b.sendDate),h.setSendDateStr(b.sendDateStr),h.setSendDateFormatStr(b.sendDateFormatStr),h.setMessageContentStr(b.messageContentStr),h.setReceiverId(b.receiverId),h.setReadDate(b.readDate),h.setIsRead(b.isRead),h.setMessageReceiverRelId(b.messageReceiverRelId))};this.toJsonObject=function(){var b={};b.messageId=u;b.messageLevel=P;b.messageType=v;b.bizType=ka;b.bizId=na;b.messageTitle=la;b.messageContent=W;b.senderId=n;b.sendDate=c;b.sendDateStr=t;b.sendDateFormatStr=
k;b.messageContentStr=ma;b.receiverId=D;b.readDate=x;b.isRead=N;b.messageReceiverRelId=z;return b}};var m={};q.MessageBizType=m;m.SYSTEM_NEW="0";m.HAND_OVER_NEWS="1";m.AUTHORIZED_NEWS="2";m.QUARTZ_NEWS="3";m.QUARTZ_SUCCESS="6";m.THEME_SUCCESS="7";m.QUARTZ_WARNINGRULE_UNMATCHED="8";m.QUARTZ_PUSH_PART_FAIL="h";m.QING_RELEASE_NEWS="4";m.OPERATIONS_NEWS="a";m.QUESTIONNAIRE_NEWS="b";m.LAPP_SYNC_ROLE="5";m.QDM_COOP_MEM="c";m.QDM_UPDATE_MODELSET_STATUS="d";m.QDM_DEPLOY_MODEL="e";m.AUTH_PUBLIC_DB="9";m.QDM_ONCE_MATERIALIZED_SUCCESS=
"f";m.QDM_ONCE_MATERIALIZED_NEWS="g"})();(function(){function q(n){m.call(this);var c;this.getJqUi=function(){c||c||(c=$("<div>"),c.html(n.getMessageContentStr()));return c};this.needRefresh=function(){return!1}}function m(){this.needRefresh=function(){throw Error("orrive me");};this.getJqUi=function(){throw Error("orrive me");}}function h(){na.call(this);var n;this.getRemoteUrl=function(){return n};this.setRemoteUrl=function(c){n=c}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&
(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.message&&(com.kingdee.bos.qing.message={});"undefined"==typeof com.kingdee.bos.qing.message.common&&(com.kingdee.bos.qing.message.common={});var u=com.kingdee.bos.qing.message.common;u.Facade=function(n,c,t,k){v.call(this,n,c,t,k);var D=this.protectedMethod;this.queryUnreadMessage=function(){D.remote("queryUnReadMessageCount",{})};this.queryImportantUnReadMessage=function(){D.remote("queryImportantUnReadMessage",
{})};this.deleteMessageByRule=function(){D.remote("deleteMessageByRule",{})};this.isNeedSyncMessageData=function(){D.remote("getIsFinishSyncToday",{})};this.syncMessageData=function(x){x=JSON.parse(x);D.remote("syncMessageData",x)};this.queryMessageDetailById=function(x,N){D.remote("queryMessageDetailById",{messageId:x,messageReceiverRelId:N})};this.loadMessageList=function(x,N,b,l,r,Z){D.remote("queryMessageListByPage",{appType:x,messageType:N,startDate:b,endDate:l,searchContent:r,lastOrNextFlag:Z})};
this.clearUnreadMessage=function(){D.remote("clearAllMessage",{})};this.readMessage=function(x,N){D.remote("readMessage",{messageId:x,messageReceiverRelId:N})};this.messageToUnread=function(x,N){D.remote("messageToUnread",{messageId:x,messageReceiverRelId:N})};this.deleteMessage=function(x){D.remote("deleteMessage",{messageReceiverRelId:x})}};u.RemoteImpl=h;u.MessageImportantDialog=function(n){var c,t,k;this.show=function(){k?c.css("bottom",k+10+"px"):c.css("bottom","10px")};this.setBottom=function(b){k=
b};this.setGlobalDependence=function(b){t=b};this.getJqUi=function(){c||D();return c};var D=function(){c=$("<div>");c.addClass("management-message-dialog");var b=$("<div>");b.addClass("management-message-titleBar");var l=$("<div>");l.addClass("message-title-notice-icon");W.background(l,"message-notice");l.appendTo(b);l=$("<div>");l.text(n.getMessageTitle());l.addClass("management-message-title");l.attr("title",n.getMessageTitle());var r=$("<div>");r.text("\u00d7");r.addClass("management-message-close-btn");
r.on("click",function(Z){x()});l.appendTo(b);r.appendTo(b);b.appendTo(c);b=$("<div>");b.addClass("management-message-content");b.html(n.getMessageContentStr());b.appendTo(c);b=$("<div>");b.addClass("sa-ctrl-button sa-ctrl-button_enabled");b.addClass("sa-ctrl-button-background-highlight");b.addClass("message-footer");P.layoutCtrlWithLRTB(b,"50%",0,100,null,13,28);l=$("<div>");l.addClass("sa-ctrl-button-text sa-ctrl-button-text-highlight");l.text(z.get("messageISee","\u6211\u77e5\u9053\u4e86"));l.on("click",
function(Z){x()});l.appendTo(b);b.appendTo(c)},x=function(){c&&c.remove();N(n.getMessageId(),n.getMessageReceiverRelId())},N=function(b,l){var r=t.createFacade(function(Z){n.setIsRead("1")});r.setBlockingJqUi(c);r.readMessage(b,l)}};u.MessageDetailDialog=function(){la.call(this);var n=this,c=this.protectedMethod,t=$("<div>"),k,D,x,N;(function(){c.setTitle(z.get("messageSeeTitle","\u6d88\u606f\u67e5\u770b"));n.setSize(600,450);c.setSelectable(!0);c.setScrollable(!0);c.getDialogCtrl().setFullScreenEnabled();
c.getDialogCtrl().addResizeListener(function(){x&&x.needRefresh()&&x.refresh()});c.setFooterClosingOnly(!0);c.setContentPaneCreator(function(){return t});c.setClosingAction(function(l){n.destroy()})})();this.destroy=function(){c.destroy();N&&N()};this.setFunDestory=function(l){N=l};this.show=function(l,r){x=ma.createPublishToDialog(l,r.getBizType(),r,c.getMessageCurtain());n.showDialog();n.refresh(r)};this.setFunLastMessageHandler=function(l){k=l};this.setFunNextMessageHandler=function(l){D=l};this.refresh=
function(l,r){x=ma.createPublishToDialog(l,r.getBizType(),r,c.getMessageCurtain());t.remove();c.getDialogCtrl().setContent(b(r),!1);x.needRefresh()&&x.refresh()};var b=function(l){t=$("<div>");var r=$("<div>");r.addClass("message-detail-dialog-time");r.text(l.getSendDateFormatStr());r.appendTo(t);l=$("<div>");l.addClass("message-detail-turn");r=$("<div>");r.addClass("message-detail-turn-last");r.attr("title",z.get("lastLabelText","\u4e0a\u4e00\u6761"));W.backgroundWithHover(r,"left");r.appendTo(l);
r.on("click",function(Z){k(c)});r=$("<div>");r.addClass("message-detail-turn-next");W.backgroundWithHover(r,"right");r.attr("title",z.get("nextLabelText","\u4e0b\u4e00\u6761"));r.on("click",function(Z){D(c)});r.appendTo(l);l.appendTo(t);l=x.getJqUi();P.layoutCtrlWithLRTB(l,0,0,null,25,0,null);l.appendTo(t);return t}};u.AbstractMessageDialog=function(){this.protectedMethod={initDrag:function(n,c,t){var k,D,x,N,b=n.css("cursor"),l=c.css("cursor"),r,Z=!1,qa=0,ra=function(f){qa=2>qa?++qa:0;if(!(0<qa)){var K=
P.getCurrentTargetPosition(f);K=P.upwardCoordinate(f.target,K,n[0]);f=K[0]-r[0];K=K[1]-r[1];f=f+x>k?k-x:f;K=K+N>D?D-N:K;K=0>K?0:K;t.css("left",(0>f?0:f)+"px");t.css("top",K+"px")}},sa=function(f){c.css("cursor",l);n.css("cursor",b);n.off("mousemove",ra);n.off("mouseleave",sa);n.off("mouseup",sa)};c.on("mousedown",function(f){Z=!0;r=P.getCurrentTargetPosition(f);r=P.upwardCoordinate(f.target,r,t[0])});c.on("mouseup",function(f){Z=!1;r=null});c.on("mousemove",function(f){Z&&(Z=!1,k=n.width(),D=n.height(),
x=t.outerWidth(),N=t.outerHeight(),n.on("mousemove",ra),n.on("mouseleave",sa),n.on("mouseup",sa),n.css("cursor","move"),c.css("cursor","move"))})}}};u.AbstractMessageDetailDialog=m;u.UBBHtmlTransTool=function(){};var z,P,v,ka,na,la;(function(){var n=com.kingdee.bos.qing.framework.common;v=n.AbstractFacade;ka=n.AbstractIcons;na=n.AbstractRemoteCall;z=n.MultilanguageManager.createPackageAccessor(u);n=com.kingdee.bos.qing.common;P=n.DomUtil;n=com.kingdee.bos.qing.ui.component;la=n.AbstractModalDialog})();
u.Icons=new function(){ka.call(this);var n=this.protectedMethod;this.protectedInit=function(t,k){t=com.kingdee.bos.qing.message.ComboIcon;if(!t)throw Error("com.kingdee.bos.qing.message.ComboIcon not found.");t.define(k,"message_img");k.setGap(0);k.setStartPosition(0,0);k.setIconSize(16,16);c(0,0,"message_icon");k.setStartPosition(20,2);k.setIconSize(20,20);c(0,0,"icon_search");k.setStartPosition(43,2);k.setIconSize(20,20);c(0,0,"icon_search_hover");k.setStartPosition(104,2);k.setIconSize(22,26);
c(0,0,"icon_clear_all");k.setStartPosition(72,2);k.setIconSize(22,26);c(0,0,"icon_clear_all_hover");k.setStartPosition(142,2);k.setIconSize(32,32);c(0,0,"message-notice");k.setStartPosition(10,180);k.setIconSize(20,30);c(0,0,"threePoints");k.setStartPosition(10,221);k.setIconSize(20,30);c(0,0,"threePoints_hover");k.setStartPosition(0,42);k.setIconSize(40,40);c(0,0,"quartz_success");c(0,0,"theme_success");c(0,1,"quartz_warningrule_unmatched");c(0,1,"quartz_push_part_fail");c(1,0,"quartz_new");c(1,
1,"system-push");c(1,2,"qing_release");c(1,3,"hand_over");c(1,4,"authorized_new");c(2,0,"modelset-auth");c(2,1,"modelset-cancel-auth");c(2,2,"model-deploy");c(2,3,"model-cancel-deploy");c(2,4,"model-revert");c(2,5,"datasource-auth");c(2,6,"datasource-cancel-auth");c(2,7,"modelset-enable");c(2,8,"modelset-disable");k.setStartPosition(0,0);t.define(k,"common_img");k.setIconSize(16,16);c(0,0,"left");c(1,0,"left_hover");c(0,1,"right");c(1,1,"right_hover");k.setStartPosition(10,45);k.setIconSize(170,98);
c(0,0,"nodata");k.setStartPosition(10,160);k.setIconSize(170,98);c(0,0,"empty")};var c=function(t,k,D){n.registIcon(t,k,D)}};var W=u.Icons;u.Integration=new function(){var n=new h,c,t;this.getRemoteImpl=function(){return n};this.setRemoteUrl=function(k){n.setRemoteUrl(k)};this.setImportJSCodeForManager=function(k){c=k};this.getImportJSCodeForManager=function(){return c};this.getAppId=function(){return t};this.setAppId=function(k){t=k}};u.MessageFactory=new function(){var n={};this.addMessageDetailToPanel=
function(c,t){n[c]=t};this.addPublishFacade=function(c,t){};this.createPublishToDialog=function(c,t,k,D){var x=n[t];c=x?new x(c,t,k,D):new q(k);return c}};var ma=u.MessageFactory})();(function(){function q(){N.call(this);var f=this,K=this.protectedMethod,L,Q,B,O,aa,ba,ca,M=0,ja=$("<div>"),E,U,oa,pa,ea,p,y=Z.ALL,I=r.ALLTYPE,R,J,da="",ha,T=[],ta=[],ua=0,va=!1,w,V,G=[],S,F,H,fa,Y,xa,wa,ya,Ga,Ka,La=240,Da,Ea,Ma=[new h(v.get("allType","\u5168\u90e8\u7c7b\u578b"),r.ALLTYPE),new h(v.get("biz","\u4e1a\u52a1\u6d88\u606f"),r.BIZ),new h(v.get("featureUpdate","\u7279\u6027\u66f4\u65b0"),r.PUBLISH),new h(v.get("system","\u7cfb\u7edf\u6d88\u606f"),r.SYSTEM)],Ba=[new h(v.get("allAppType","\u5168\u90e8\u5e94\u7528"),
Z.ALL),new h(v.get("qingApp","\u8f7b\u5206\u6790"),Z.QING),new h(v.get("qrtApp","\u8f7b\u62a5\u8868"),Z.QING_RPT),new h(v.get("qdmApp","\u8f7b\u5efa\u6a21"),Z.QING_MODELER)],Oa=function(){if(!Q){var a=$(document.body);Q=$("<div>");Q.addClass("message-ctrl-common-modallayer");B=$("<div>");B.addClass("message-sa-ctrl-dialog");B.appendTo(Q);ha=$("<div>");ha.addClass("sa-ctrl-dialog-title sa-ctrl-dialog-titlebar");ja.addClass("sa-ctrl-dialog-title");ja.html(v.get("message","\u6d88\u606f"));ja.appendTo(ha);
var d=$("<div>");d.addClass("message-clear-all-ui");var g=$("<div>");g.addClass("message-clear-all-icon");g.attr("title",v.get("clearUnreadMessage","\u6e05\u9664\u6240\u6709\u672a\u8bfb\u6d88\u606f"));d.on("click",function(){Sa(g)});W.background(g,"icon_clear_all");g.appendTo(d);var e=$("<div>");e.addClass("message-clear-tips");e.text(v.get("clearUnReadLabel","\u6e05\u9664\u672a\u8bfb"));e.appendTo(d);d.appendTo(ha);d.on("mouseover",function(){W.background(g,"icon_clear_all_hover")});d.on("mouseleave",
function(){W.background(g,"icon_clear_all")});d=$("<div>");d.text("\u00d7");d.on("click",f.destroy);d.addClass("sa-ctrl-dialog-close");d.appendTo(ha);ha.appendTo(B);d=$("<div>");d.addClass("message-ctrl-dialog-contentpane");e=$("<div>");e.addClass("message-ctrl-dialog-padding");e.appendTo(d);Ta();O.appendTo(e);d.appendTo(B);Q.appendTo(a);K.initDrag(Q,ha,B);document.body.addEventListener("mousedown",Na,!0);Ua()}},Na=function(a){var d=$(document.body).children(".sa-ctrl-common-popup"),g=$(document.body).children(".message-clear-all-icon");
for(a=a.target;a!=document.body;){if(a==B[0]||d&&a==d[0]||g&&a==g[0]||0<$(a).find(".sa-ctrl-simpleconfirmer").length||0<$(a).find(".sa-ctrl-dialog").length||0<$(a).find(".sa-common-loading-panel").length)return;a=a.parentNode}f.destroy();document.body.removeEventListener("mousedown",Na,!0)};this.getJqUi=function(){return Oa()};this.setFunMessageNoticShowOrHide=function(a){S=a};this.setBounds=function(a,d,g,e,C,A){Oa();g?B.css("left",g):B.css("left","");e?B.css("top",e):B.css("top","");C?B.css("right",
C):B.css("right","");A?B.css("bottom",A):B.css("bottom","");B.css("width",a);B.css("height",d);this.setSize(a,d)};this.setPosition=function(a,d,g,e){xa=a;wa=d;ya=g;Ga=e};this.setSize=function(a,d){a&&(Ka=a);La=d};this.show=function(){$(document.body);f.setBounds(Ka,La,xa,wa,ya,Ga);B.css("display","block")};this.destroy=function(){Q&&Q.remove();F&&F()};this.setFunDestory=function(a){F=a};this.setGlobalDependence=function(a){L=a};this.getMessageCurtain=function(a){a||Da||(Da=new ma,Da.getJqUi().appendTo(B));
return Da};this.setViewSize=function(a,d,g,e,C,A){f.setSize(a,d);f.setPosition(g,e,C,A)};var Ua=function(){var a=L.createFacade(Va);a.setBlockingJqUi(O);a.queryUnreadMessage()},Va=function(a){null==a||0==a?(S(!1),M=0):(M=a,S(!0));za()},Wa=function(){aa=new ka;aa.setItemModels(Ba);var a=P.getAppId();a=a==qa.QING_ANALYSIS?Ba[1]:a==qa.QING_RPT?Ba[2]:a==qa.QING_MODELER?Ba[3]:Ba[0];aa.setSelected(a);y=a.getTypeId();aa.setCustomPainter(function(d,g,e){g.text(e.getTypeName());g.attr("title",e.getTypeName())});
aa.addSelectedChangedListener(function(d,g,e){Ha();G=[];y=e.getTypeId();Ca(y,I,R,J,da,null)});a=aa.getJqUi();a.addClass("message-searchtype-combobox");return a},Xa=function(){ba=new ka;ba.setItemModels(Ma);ba.setSelected(Ma[0]);ba.setCustomPainter(function(d,g,e){g.text(e.getTypeName());g.attr("title",e.getTypeName())});ba.addSelectedChangedListener(function(d,g,e){Ha();I=e.getTypeId();Ca(y,I,R,J,da,null)});var a=ba.getJqUi();a.addClass("message-searchtype-combobox");return a},Ha=function(){J=R=null;
T=[];ua=0},Ta=function(){var a=P.getImportJSCodeForManager();a&&a();if(!O){O=$("<div>");O.css("right","2px");O.css("height","100%");ca=$("<div>");ca.addClass("message-search-view");a=$("<div>");a.addClass("message-search-icon");a.attr("title",v.get("search","\u641c\u7d22"));W.backgroundWithHover(a,"icon_search");a.on("mouseenter",function(){Ya()});var d=Wa(),g=Xa();a.appendTo(ca);d.appendTo(ca);g.appendTo(ca);ca.appendTo(O);E=$("<div>");E.addClass("message-container");E.css("overflow-x","hidden");
E.css("overflow-y","auto");E.appendTo(O);la.layoutCtrlWithLRTB(E,5,5,null,45,10,null);E.on("scroll",function(e){if(0<ta.length){for(e=0;e<ta.length;e++){var C=ta[e];C&&C.isShowing()&&C.hide()}ta.splice(0,1)}clearTimeout(Y);Y=setTimeout(function(){var A;if(A=!(E.prop("clientHeight")>=E.prop("scrollHeight"))){A=E.prop("scrollTop");var X=E.prop("clientHeight"),ia=E.prop("scrollHeight");A=A+X>=ia-2}if(A)if(ua>=T.length)Ca(y,I,R,J,da,ra);else for(A=0;ua<T.length&&100>A;A++)Pa(T[ua]);E.prop("scrollTop")},
100)});T=[];ua=0;G=[];Ca(y,I,R,J,da,null)}return O},Ya=function(){if(ea)ea.show();else{ea=$("<div>");p=new na;p.setSearchListenerDelay(1E3);p.setPlaceholder(v.get("searchContent","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));p.addSearchListener(Za);p.setAlwaysShowCleanIcon(!0);p.setShowSearchIcon(!0);var a=p.getJqUi();a.addClass("message-search-box");var d=a.find(":input");d&&d.css("font-size","12px");d=$("<div>");d.addClass("message-search-icon");d.attr("title",v.get("search","\u641c\u7d22"));W.background(d,
"icon_search_hover");d.appendTo(ea);a.appendTo(ea);ea.appendTo(ca)}p.setFoucs();var g=function(e){if(!(0<p.getText().trim().length)){var C=$(document.body).children(".sa-ctrl-common-popup");for(e=e.target;e!=document.body;){if(e==ea[0]||ba&&e==ba.getJqUi()[0]||aa&&e==aa.getJqUi()[0]||C&&e==C[0])return;e=e.parentNode}ea.hide();document.body.removeEventListener("mousedown",g,!0)}};document.body.addEventListener("mousedown",g,!0)},Za=function(){Ha();var a="";p&&(a=p.getText().trim());0==a.length&&0==
da.length||a==da||(da=a,Ca(y,I,R,J,da,null))},Sa=function(a){0==M?(a=v.get("clearAllUnreadMessageWarn","\u6682\u65e0\u672a\u8bfb\u6d88\u606f"),f.getMessageCurtain().showPrompt(a,2E3)):(Ea=new k,Ea.setText(v.get("confirmClearAllUnreadMessage","\u786e\u5b9a\u6e05\u9664\u6d88\u606f\u76d2\u5b50\u7684\u6240\u6709\u672a\u8bfb\u5417\uff1f")),Ea.setConfirmedListener(function(d){d&&(d=L.createFacade($a),d.setBlockingJqUi(O),d.clearUnreadMessage())}),Ea.show(a))},$a=function(a){M=0;za();E.find(".message-type-notice").hide();
for(a=0;a<T.length;a++){var d=T[a];d.getIsRead()!=l.READ&&d.setIsRead(l.READ)}for(a=0;a<G.length;a++)d=G[a],d.getIsRead()!=l.READ&&d.setIsRead(l.READ)},Ca=function(a,d,g,e,C,A){if(!va||A!=ra){var X=L.createFacade(ab);X.setBlockingJqUi(O);X.loadMessageList(a,d,g,e,C,A)}},Pa=function(a){a=new m(a,da,E);a.setGlobalDependence(L);a.setFunDeleteMessage(bb);a.setFunHandlerReadMessage(cb);a.setFunHandlerUnReadMessage(db);a.setFunDoClickMessageToLook(Fa);a.setArrMenuList(ta);a.getJqUi().appendTo(E);ua++},
ab=function(a){var d=a.lastOrNextFlag;va=a.queryAllData;if(a.noData||!(d||a.messageDeailVoList&&0!=a.messageDeailVoList.length))E.find(".message-group-list").remove(),Qa(),U.show();else if(!va||!a.messageDeailVoList||0!=a.messageDeailVoList.length){console.log("----------------");U&&U.hide();var g=a.messageDeailVoList;R=a.startDate;J=a.endDate;d||E.find(".message-group-list").remove();if(d=0==G.length)w=a.startDate,V=a.endDate;for(a=0;a<g.length;a++){var e=new b;e.fromJsonObject(g[a]);T.push(e);d&&
G.push(e);100>a&&Pa(e)}}},cb=function(a,d){H=a;var g=L.createFacade(function(e){a.setIsRead(l.READ);(e=Ia(H.getMessageId(),H.getMessageReceiverRelId(),G))&&e.setIsRead(l.READ);--M;za();d.removeNoticeUI();0==M&&S(!1)});g.setBlockingJqUi(O);g.readMessage(H.getMessageId(),a.getMessageReceiverRelId())},db=function(a,d){H=a;var g=L.createFacade(function(e){a.setIsRead(l.UNREAD);(e=Ia(H.getMessageId(),H.getMessageReceiverRelId(),G))&&e.setIsRead(l.UNREAD);M+=1;za();d.showNoticeUI();0!=M&&S(!0)});g.setBlockingJqUi(O);
g.messageToUnread(H.getMessageId(),a.getMessageReceiverRelId())},bb=function(a,d,g){if(a.getMessageType()!=r.BIZ)g=v.get("deleteNoBizMessageNotice","\u53ea\u80fd\u5220\u9664\u201c\u4e1a\u52a1\u6d88\u606f\u201d"),f.getMessageCurtain().showPrompt(g,2E3);else{H=a;var e=new k;e.setText(v.get("confirmDelMessage","\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u8be5\u6761\u6d88\u606f\u5417\uff1f"));e.setConfirmedListener(function(C){C&&(C=L.createFacade(function(A){null!=
A&&A.isRead!=l.READ&&(--M,za(),d.removeNoticeUI());A=v.get("deleteMessageSuccess","\u5220\u9664\u6d88\u606f\u6210\u529f");f.getMessageCurtain().showSuccess(A,2E3);d.removeJqUI();A=-1;for(var X=0;X<T.length;X++)if(H.getMessageId()==T[X].getMessageId()&&H.getMessageReceiverRelId()==T[X].getMessageReceiverRelId()){A=X;break}-1!=A&&T.splice(A,1);A=-1;for(X=0;X<G.length;X++)if(H.getMessageId()==G[X].getMessageId()&&H.getMessageReceiverRelId()==G[X].getMessageReceiverRelId()){A=X;break}-1!=A&&G.splice(A,
1);0==T.length&&(E.find(".message-group-list").remove(),Qa(),U.show())}),C.setBlockingJqUi(O),C.deleteMessage(a.getMessageReceiverRelId()))});e.show(g)}},Qa=function(){U||(U=$("<div>"),U.addClass("message-no-data-bg-container"),oa=$("<div class='message-no-search-display-icon'>"),oa.appendTo(U),pa=$("<div class='message-no-search-display-text'>"),pa.appendTo(U),E.append(U));da?(W.background(oa,"nodata"),pa.text(v.get("noSearchMessageNotice","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"))):
(W.background(oa,"empty"),pa.text(v.get("noMessageNotice","\u6682\u65e0\u76f8\u5173\u6d88\u606f")))},Ia=function(a,d,g){if(!g)return null;for(var e=0;e<g.length;e++)if(a==g[e].getMessageId()&&d==g[e].getMessageReceiverRelId())return g[e];return null},eb=function(){var a=H.getMessageId(),d=H.getMessageReceiverRelId();var g=-1;for(var e=0;e<T.length;e++)if(a==T[e].getMessageId()&&d==T[e].getMessageReceiverRelId()){g=e;break}a=E.find(".message-group-list");g=null!=a&&-1!=g&&a.length>g?a[g]:null;(a=Ia(H.getMessageId(),
H.getMessageReceiverRelId(),T))&&a.getIsRead()!=l.READ&&a.setIsRead(l.READ);g&&$(g).find(".message-type-notice").hide()},Fa=function(a){if(null!=a){H=a;var d=L.createFacade(function(g){a.getIsRead()!=l.READ&&(a.setIsRead(l.READ),--M,za(),eb());fa||(fa=new D(a),fa.setFunNextMessageHandler(fb),fa.setFunLastMessageHandler(gb),fa.showDialog(),fa.setFunDestory(function(){fa=null}));fa.refresh(g,a)});d.setBlockingJqUi(O);d.queryMessageDetailById(a.getMessageId(),a.getMessageReceiverRelId())}},za=function(){var a=
v.get("message","\u6d88\u606f");0<M?a+="<b>("+M+")</b>":S(!1);ja.html(a)},fb=function(a){var d=Ja(ra,H.getMessageId(),H.getMessageReceiverRelId(),a);null==d&&va?(d=v.get("noMoreMessage","\u6ca1\u6709\u66f4\u591a\u4e86\u3002"),a.getMessageCurtain().showPrompt(d,2E3)):Fa(d)},gb=function(a){var d=Ja(sa,H.getMessageId(),H.getMessageReceiverRelId(),a);null==d?(d=v.get("noMoreMessage","\u6ca1\u6709\u66f4\u591a\u4e86\u3002"),a.getMessageCurtain().showPrompt(d,2E3)):Fa(d)},Ja=function(a,d,g,e){for(var C=
-1,A=0;A<G.length;A++){var X=G[A];if(d==X.getMessageId()&&g==X.getMessageReceiverRelId()){C=A;break}}if(C<G.length&&0<=C){if(a==ra&&C<G.length-1)return G[C+1];if(a==sa&&0<C)return G[C-1];if(a==sa&&0==C)return null}if(va&&a==ra)return C=v.get("lastMessageNotice","\u8fd9\u5df2\u7ecf\u662f\u6700\u540e\u4e00\u6761\u6d88\u606f\u4e86\u3002"),e.getMessageCurtain().showPrompt(C,2E3),null;C=L.createFacade(function(ia){va=ia.queryAllData;if(null==ia.messageDeailVoList||0==ia.messageDeailVoList.length){var Aa=
v.get("noMoreMessage","\u6ca1\u6709\u66f4\u591a\u4e86\u3002");e.getMessageCurtain().showPrompt(Aa,2E3)}else{Aa=ia.messageDeailVoList;w=ia.startDate;V=ia.endDate;for(ia=0;ia<Aa.length;ia++){var Ra=new b;Ra.fromJsonObject(Aa[ia]);G.push(Ra)}Aa=Ja(a,d,g,e);Fa(Aa)}});C.setBlockingJqUi(O);C.loadMessageList(y,null,w,V,null,a)}}function m(f,K,L){var Q=this,B,O,aa,ba,ca,M,ja,E,U,oa,pa,ea,p,y=[],I={0:"system-push",1:"hand_over",2:"authorized_new",5:"authorized_new",3:"quartz_new",6:"quartz_success",7:"theme_success",
8:"quartz_warningrule_unmatched",4:"qing_release",a:"system-push",b:"system-push",f:"quartz_success",g:"quartz_new",h:"quartz_push_part_fail"},R={ADD_COOP_MEM:"modelset-auth",DEL_COOP_MEM:"modelset-cancel-auth",ENABLE_MODELSET:"modelset-enable",DISABLE_MODELSET:"modelset-disable",DEPLOY_MODEL:"model-deploy",UNDEPLOYED_MODEL:"model-cancel-deploy",REVERT_MODEL:"model-revert",AUTH_PUBLIC_SQ:"datasource-auth",DEL_AUTH_PUBLIC_SQ:"datasource-cancel-auth",AUTH_PUBLIC_DB:"datasource-auth",DEL_AUTH_PUBLIC_DB:"datasource-cancel-auth"};
this.setGlobalDependence=function(w){};this.getJqUi=function(){B||ha();return B};this.getMenu=function(){return _oMenu};this.setFunHandlerReadMessage=function(w){oa=w};this.setFunHandlerUnReadMessage=function(w){pa=w};this.setFunDeleteMessage=function(w){ea=w};this.setFunDoClickMessageToLook=function(w){p=w};this.setArrMenuList=function(w){y=w};this.removeJqUI=function(){B&&B.remove()};this.removeNoticeUI=function(){U&&U.hide()};this.showNoticeUI=function(){U?U.show():J()};var J=function(){U=$("<div>");
U.addClass("message-type-notice");U.appendTo(E)},da=function(w){var V=w.getBizType();w=w.getMessageContentStr();return I[V]?I[V]:R[w]?R[w]:"system-push"},ha=function(){B=$("<div>");B.addClass("message-group-list");O=$("<div>");O.addClass("message-type-icon-view");E=$("<div>");E.addClass("message-type-icon-container");var w=$("<div>");W.background(w,da(f));w.addClass("message-type-icon");w.appendTo(E);E.appendTo(O);f.getIsRead()!=l.READ&&J();O.appendTo(B);ca=$("<div>");w=$("<div>");w.addClass("message-spot-icon-ui");
W.backgroundWithHover(w,"threePoints");w.appendTo(ca);ca.addClass("message-oper-icon-view");ca.on("click",T);ca.appendTo(B);aa=$("<div>");aa.addClass("message-content-container");w=$("<span>");var V=f.getMessageTitle();if(null!=K){var G=K.toUpperCase(),S=V.toUpperCase(),F=S.split(G),H=G.length,fa;for(fa in F){var Y=S.indexOf(F[fa]),xa=V.substr(ya,F[fa].length);Y+=F[fa].length;var wa=S.length-Y;S=S.substr(Y,wa);V=V.substr(Y,wa);Y=$("<span>");Y.text(xa);Y.appendTo(w);if(fa!=F.length-1&&1<F.length){var ya=
S.indexOf(G);xa=V.substr(ya,H);Y=ya+H;wa=S.length-Y;S=S.substr(Y,wa);V=V.substr(Y,wa);Y=$("<span>");Y.text(xa);Y.css("color","red");Y.clone().appendTo(w)}}}else w.text(V);w.addClass("message-content-view");w.appendTo(aa);ba=$("<span>");ba.addClass("message-group-title-span");M=$("<div>");M.text(v.get("clickToView","\u70b9\u51fb\u67e5\u770b"));M.addClass("message-see-btn");M.on("click",function(Ga){p(f)});M.appendTo(ba);ja=$("<div>");ja.text(f.getSendDateStr());ja.addClass("message-time-label");ja.appendTo(ba);
ba.appendTo(aa);aa.appendTo(B)},T=function(w){w=$(w.currentTarget);var V=w.parent(),G=new n,S=new c;if(f.getIsRead()!=l.READ){var F=new t(ta);F.setUserObject();F.setText(v.get("markToRead","\u6807\u8bb0\u5df2\u8bfb"))}else F=new t(ua),F.setUserObject(),F.setText(v.get("markToUnRead","\u6807\u8bb0\u672a\u8bfb"));S.addItemModel(F);f.getMessageType()==r.BIZ&&(F=new t(va),F.setUserObject(),F.setText(v.get("deleteSth","\u5220\u9664...")),S.addItemModel(F));G.setModel(S);F=V.outerWidth();var H=V.outerHeight();
F=[F-2,H+3];F=la.upwardCoordinate(V[0],F,L[0]);S=S.getItemCount();G.show(V,F[0],F[1],w,!0,[0,-2+24*(S-2)]);0<y.length&&y.splice(0,1);y.push(G)},ta=function(w){oa(f,Q)},ua=function(w){pa(f,Q)},va=function(w){ea(f,Q,B)}}function h(f,K){this.getTypeName=function(){return f};this.getTypeId=function(){return K}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing=
{});"undefined"==typeof com.kingdee.bos.qing.message&&(com.kingdee.bos.qing.message={});"undefined"==typeof com.kingdee.bos.qing.message.ui&&(com.kingdee.bos.qing.message.ui={});var u=com.kingdee.bos.qing.message.ui,z,P,v,ka,na,la,W,ma,n,c,t,k,D,x,N,b;(function(){var f=com.kingdee.bos.qing.common;la=f.DomUtil;f=com.kingdee.bos.qing.framework.common;v=f.MultilanguageManager.createPackageAccessor(u);f=com.kingdee.bos.qing.ui.component;na=f.SearchBox;ma=f.MessageCurtain;ka=f.ComboBox;n=f.Menu;c=f.MenuModel;
t=f.MenuItemModel;k=f.SimpleConfirmer;f=com.kingdee.bos.qing.message.common;W=f.Icons;z=f.Facade;P=f.Integration;D=f.MessageDetailDialog;x=f.MessageImportantDialog;N=f.AbstractMessageDialog;f=com.kingdee.bos.qing.message.model;b=f.MessageDetailVo})();u.Main=function(){var f,K,L,Q,B,O,aa,ba,ca,M=new function(){var p;this.getMessageCurtain=function(){p||(p=new ma,p.getJqUi().appendTo($("body")));return p};this.createFacade=function(y,I,R){var J=P.getRemoteImpl();return new z(J,y,function(da,ha){return I?
I(da,ha):!1},R)}},ja=function(p){var y=M.createFacade(function(I){E(I,p)});y.setShowBlocking(!1);y.isNeedSyncMessageData()},E=function(p,y){var I=p.productLine,R=p.clusterName,J=p.cloudMessageUrl,da=p.accountId;p.isFinishSyncData?ea(y):(p={type:"GET",dataType:"text"},p.url=J+"/qing-message/message/findThreeDaysBeforeMessageList?timestamp="+(new Date).getTime(),p.data={productLine:I,clusterCode:R,accountId:da},p.timeout=1E4,p.success=function(ha){var T=M.createFacade(function(ta){ea(y)});T.setShowBlocking(!1);
T.syncMessageData(ha)},$.ajax(p))};this.getJqUi=function(p){if(!f){f=$("<div>");f.addClass("sa-statusbar-message");f.on("click",pa);K=$("<div>");K.addClass("sa-statusbar-messageicon");var y=$("<div>");y.addClass("sa-statusbar-messageicon");W.background(y,"message_icon");y.appendTo(K);y=$("<div>");y.addClass("sa-statusbar-messagetip");y.text(v.get("message","\u6d88\u606f"));y.appendTo(f);K.appendTo(f);L||(L=$("<div>"),L.addClass("message-notice"),L.appendTo(K));L&&L.hide();y=M.createFacade(U);y.setShowBlocking(!1);
y.queryUnreadMessage();ja(p)}return f};this.setFunOpenMessageDialog=function(p){ca=p};this.setViewSize=function(p,y,I,R){B=p;O=y;aa=I;ba=R};this.setMessageWidth=function(p){};this.setMessageDialogBounds=function(p,y,I,R){if(Q){var J=$(document.body).prop("clientHeight");J=parseInt(.8*J);Q.setBounds("25%",J,p,y,I,R)}};var U=function(p){null==p||0==p?L&&L.hide():L&&L.show()},oa=function(p){p?L.show():L.hide()},pa=function(){ca&&ca();Q||(Q=new q,Q.setGlobalDependence(M),Q.setFunMessageNoticShowOrHide(oa),
Q.setFunDestory(function(){Q=null}));var p=$(document.body).prop("clientHeight");p=parseInt(.8*p);Q.setViewSize("25%",p,B,O,aa,ba);Q.show()},ea=function(p){var y=M.createFacade(function(I){if(I&&0<I.length)for(var R=0;R<I.length;R++){var J=new b;J.fromJsonObject(I[R]);J=new x(J);J.setGlobalDependence(M);J.setBottom(p);J.getJqUi().appendTo($(document.body));J.show()}},function(I,R){return!1});y.setShowBlocking(!1);y.queryImportantUnReadMessage()}};var l={READ:"1",UNREAD:"0"},r={BIZ:1,PUBLISH:2,SYSTEM:3,
ALLTYPE:null},Z={ALL:null,QING:"0",QING_RPT:"1",QING_MODELER:"2"},qa={QING_ANALYSIS:"qing",QING_RPT:"qing_rpt",QING_MODELER:"qing_modeler"},ra="1",sa="0"})();
//qingVersionTag: 20250324