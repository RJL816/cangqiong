var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(p,C,k){p instanceof String&&(p=String(p));for(var t=p.length,x=0;x<t;x++){var Q=p[x];if(C.call(k,Q,x,p))return{i:x,v:Q}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,C,k){if(p==Array.prototype||p==Object.prototype)return p;p[C]=k.value;return p};$jscomp.getGlobal=function(p){p=["object"==typeof globalThis&&globalThis,p,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var C=0;C<p.length;++C){var k=p[C];if(k&&k.Math==Math)return k}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(p,C){var k=$jscomp.propertyToPolyfillSymbol[C];if(null==k)return p[C];k=p[k];return void 0!==k?k:p[C]};
$jscomp.polyfill=function(p,C,k,t){C&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(p,C,k,t):$jscomp.polyfillUnisolated(p,C,k,t))};$jscomp.polyfillUnisolated=function(p,C,k,t){k=$jscomp.global;p=p.split(".");for(t=0;t<p.length-1;t++){var x=p[t];if(!(x in k))return;k=k[x]}p=p[p.length-1];t=k[p];C=C(t);C!=t&&null!=C&&$jscomp.defineProperty(k,p,{configurable:!0,writable:!0,value:C})};
$jscomp.polyfillIsolated=function(p,C,k,t){var x=p.split(".");p=1===x.length;t=x[0];t=!p&&t in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Q=0;Q<x.length-1;Q++){var da=x[Q];if(!(da in t))return;t=t[da]}x=x[x.length-1];k=$jscomp.IS_SYMBOL_NATIVE&&"es6"===k?t[x]:null;C=C(k);null!=C&&(p?$jscomp.defineProperty($jscomp.polyfills,x,{configurable:!0,writable:!0,value:C}):C!==k&&(void 0===$jscomp.propertyToPolyfillSymbol[x]&&(k=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[x]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(x):$jscomp.POLYFILL_PREFIX+k+"$"+x),$jscomp.defineProperty(t,$jscomp.propertyToPolyfillSymbol[x],{configurable:!0,writable:!0,value:C})))};$jscomp.polyfill("Array.prototype.find",function(p){return p?p:function(C,k){return $jscomp.findInternal(this,C,k).v}},"es6","es3");$jscomp.polyfill("Object.is",function(p){return p?p:function(C,k){return C===k?0!==C||1/C===1/k:C!==C&&k!==k}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(p){return p?p:function(C,k){var t=this;t instanceof String&&(t=String(t));var x=t.length;k=k||0;for(0>k&&(k=Math.max(k+x,0));k<x;k++){var Q=t[k];if(Q===C||Object.is(Q,C))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(p,C,k){if(null==p)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(C instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return p+""};$jscomp.polyfill("String.prototype.includes",function(p){return p?p:function(C,k){return-1!==$jscomp.checkStringArgs(this,C,"includes").indexOf(C,k||0)}},"es6","es3");
(function(){function p(){var t=this,x,Q,da,N,V,K,ea,fa,I;this.getFormatCreateTime=function(){return fa};this.setFormatCreateTime=function(a){fa=a};this.getSpaceID=function(){return x};this.setSpaceID=function(a){x=a};this.getSpaceName=function(){return Q};this.setSpaceName=function(a){Q=a};this.getSpaceType=function(){return da};this.setSpaceType=function(a){da=a};this.getDescription=function(){return N};this.setDescription=function(a){N=a};this.getRoleType=function(){return V};this.setRoleType=function(a){V=
a};this.getCreatorID=function(){return K};this.setCreatorID=function(a){K=a};this.getCreateTime=function(){return ea};this.setCreateTime=function(a){ea=a};this.isDefault=function(){return I};this.setDefault=function(a){I=a};this.fromJsonObject=function(a){t.setSpaceID(a.id);t.setSpaceName(a.name);t.setSpaceType(a.spaceType);t.setDescription(a.description);t.setRoleType(a.collaborationRoleType);t.setCreatorID(a.creatorId);t.setFormatCreateTime(a.formatCreateTime);t.setDefault(a.isDefault)};this.toJsonObject=
function(){var a={};a.id=x;a.name=Q;a.spaceType=da;a.description=N;a.collaborationRoleType=V;a.creatorId=K;a.createTime=ea;a.formatCreateTime=fa;a.isDefault=I;return a};this.copy=function(){var a=new p;a.fromJsonObject(t.toJsonObject());return a}}function C(){var t=this,x,Q,da,N,V,K,ea,fa,I;this.isExists=function(){return ea};this.setIsExists=function(a){ea=a};this.getSpaceID=function(){return x};this.setSpaceID=function(a){x=a};this.getMemberID=function(){return Q};this.setMemberID=function(a){Q=
a};this.getMemberType=function(){return da};this.setMemberType=function(a){da=a};this.getRoleType=function(){return N};this.setRoleType=function(a){N=a};this.setMemberName=function(a){V=a};this.getMemberName=function(){return V};this.setColor=function(a){K=a};this.getColor=function(){return K};this.getUserAccount=function(){return fa};this.setUserAccount=function(a){fa=a};this.getMemberSource=function(){return I};this.setMemberSource=function(a){I=a};this.fromJsonObject=function(a){t.setSpaceID(a.spaceId);
t.setMemberID(a.memberId);t.setMemberType(a.memberType);t.setRoleType(a.collaborationRoleType);t.setColor(a.color);t.setMemberName(a.memberName);t.setIsExists(a.isExists);t.setUserAccount(a.userAccount);var D=[];if(a=a.memberSources)for(var y=0;y<a.length;y++){var f=new C;f.fromJsonObject(a[y]);D.push(f)}t.setMemberSource(D)};this.toJsonObject=function(){var a={};a.spaceId=x;a.memberId=Q;a.memberType=da;a.collaborationRoleType=N;a.memberName=V;a.color=K;a.isExists=ea;a.userAccount=fa;return a}}"undefined"==
typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.collaboration&&(com.kingdee.bos.qing.collaboration={});"undefined"==typeof com.kingdee.bos.qing.collaboration.model&&(com.kingdee.bos.qing.collaboration.model={});var k=com.kingdee.bos.qing.collaboration.model;k.CollaborationSpaceModel=p;k.CollaborationMemberModel=
C;k.CollaborationSpaceRefData=function(){var t=this,x,Q,da,N,V;this.getDataID=function(){return x};this.setDataID=function(K){x=K};this.getDataName=function(){return Q};this.setDataName=function(K){Q=K};this.getSourceApp=function(){return da};this.setSourceApp=function(K){da=K};this.getDataType=function(){return N};this.setDataType=function(K){N=K};this.getPath=function(){return V};this.setPath=function(K){V=K};this.fromJsonObject=function(K){t.setDataID(K.id);t.setDataName(K.name);t.setDataType(K.type);
t.setSourceApp(K.sourceApp);t.setPath(K.path)};this.toJsonObject=function(){var K={};K.id=x;K.name=Q;K.sourceApp=da;K.type=N;K.path=V;return K}};k.CollaborationSpaceLockModel=function(){var t,x,Q,da,N;this.getHolderId=function(){return t};this.getHolderName=function(){return x};this.getResourceId=function(){return Q};this.getLockType=function(){return da};this.isUserAcquiredLock=function(){return N};this.fromJsonObject=function(V){t=V.holderId;x=V.holderName;da=V.lockType;Q=V.resourceId;N=V.isUserAcquiredLock}};
k.CollaborationRoleType={};k.AppType={};k.MemberType={};k.SpaceType={};k.RefDataType={};k.LockType={};k.CollaborationRoleType.MEMBER="MEMBER";k.CollaborationRoleType.ADMIN="ADMIN";k.CollaborationRoleType.CREATOR="CREATOR";k.AppType.RPT="RPT";k.AppType.QING="QING";k.MemberType.USER="USER";k.MemberType.ROLE="ROLE";k.MemberType.ALL="ALL";k.SpaceType.COLLABORATION="COLLABORATION";k.SpaceType.PERSONAL="PERSONAL";k.SpaceType.PRESET="PRESET";k.RefDataType.DATASET="DATASET";k.RefDataType.REPORT="REPORT";
k.RefDataType.DASHBOARD="DASHBOARD";k.RefDataType.THEME="THEME";k.RefDataType.PUBLISH="PUBLISH";k.RefDataType.PUSH="PUSH";k.LockType.IMPLICIT_LOCK=0;k.LockType.EXPLICIT_LOCK=1})();(function(){function p(I,a,D,y){x.call(this,I,a,D,y);var f=this.protectedMethod;this.loadCollaborationSpaces=function(u,E,J,ra){u={isAsc:E,sortField:u,searchText:ra,spaceType:J,appID:t.getUrlParamValue("appID")};f.remote("loadCollaborationSpaces",u)};this.saveCollaborationSpace=function(u){u={spaceModel:JSON.stringify(u.toJsonObject())};f.remote("saveCollaborationSpace",u)};this.deleteCollaborationSpace=function(u){f.remote("deleteCollaborationSpace",{spaceId:u})};this.saveCollaborationMembers=function(u,
E,J){u={spaceMembers:L(u),spaceId:E,memberType:J};f.remote("saveCollaborationMembers",u)};this.deleteCollaborationMembers=function(u,E,J){u={spaceMembers:L(u),isConfirmed:E,spaceId:J};f.remote("deleteCollaborationMembers",u)};var L=function(u){var E=[];if(u&&0<u.length)for(var J=0;J<u.length;J++)E.push(u[J].toJsonObject());return JSON.stringify(E)};this.queryUserDefaultSpace=function(){var u={appID:t.getUrlParamValue("appID")};f.remote("queryUserDefaultSpace",u)};this.loadCollaborationMembers=function(u,
E){f.remote("loadCollaborationMembers",{spaceId:u,memberType:E})};this.loadCollaborationMembersForView=function(u){f.remote("loadCollaborationMembersForView",{spaceId:u})};this.createMemberModel=function(u,E){u={memberIds:JSON.stringify(u),memberType:E};f.remote("createMemberModel",u)};this.acquireLock=function(u,E,J){f.remote("acquireLock",{resourceId:u,isExplicitLock:E,groupId:J})};this.releaseLock=function(u,E,J){f.remote("releaseLock",{resourceId:u,isExplicitLock:E,groupId:J})};this.getLockInfos=
function(u,E){u={groupId:u,resourceIds:JSON.stringify(E)};f.remote("getLockInfos",u)};this.getCollaborationMemberRoleType=function(u){f.remote("getCollaborationMemberRoleType",{spaceId:u})};this.updateCollaborationMemberRoleType=function(u,E,J){f.remote("updateCollaborationMemberRoleType",{spaceId:u,memberId:E,roleType:J})};this.updateUserDefaultSpace=function(u){u={spaceModel:JSON.stringify(u.toJsonObject())};f.remote("updateUserDefaultSpace",u)}}function C(){Q.call(this);var I;this.getRemoteUrl=
function(){return I};this.setRemoteUrl=function(a){I=a}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.collaboration&&(com.kingdee.bos.qing.collaboration={});"undefined"==typeof com.kingdee.bos.qing.collaboration.common&&(com.kingdee.bos.qing.collaboration.common={});var k=com.kingdee.bos.qing.collaboration.common;
k.SpaceFacade=p;k.SpaceHelper=new function(){var I=this;this.getSpaceRemoteImpl=function(){var a=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");a=(a?a:"/ierp")+"/qing_rpt/collaborationSpace.do";var D=new C;D.setRemoteUrl(a);return D};this.getFacadeInstance=function(a,D,y){var f=I.getSpaceRemoteImpl();return new p(f,a,function(L,u){return D?D(L,u):!1},y)};this.highlightKeyWords=function(a,D,y){if(D&&y){D=D.toUpperCase();var f=y.toUpperCase(),L=f.split(D),u=D.length,
E;for(E in L){var J=f.indexOf(L[E]),ra=y.substr(T,L[E].length);J+=L[E].length;var ia=f.length-J;f=f.substr(J,ia);y=y.substr(J,ia);J=$("<span>");J.text(ra);J.appendTo(a);if(E!=L.length-1&&1<L.length){var T=f.indexOf(D);ra=y.substr(T,u);J=T+u;ia=f.length-J;f=f.substr(J,ia);y=y.substr(J,ia);J=$("<span>");J.text(ra);J.css("color","red");J.clone().appendTo(a)}}}else J=$("<span>"),J.text(y),J.appendTo(a)};this.getRoleTypeName=function(a){switch(a){case V.CREATOR:return N.get("creator","\u521b\u5efa\u8005");
case V.ADMIN:return N.get("admin","\u7ba1\u7406\u5458");case V.MEMBER:return N.get("member","\u6210\u5458");default:return""}};this.getAppTypeName=function(a){switch(a){case K.RPT:return N.get("qingReport","\u8f7b\u62a5\u8868");case K.QING:return N.get("qingAnalysis","\u8f7b\u5206\u6790");default:return""}};this.getRefDataTypeName=function(a){switch(a){case ea.DATASET:return N.get("dataset","\u6570\u636e\u96c6");case ea.REPORT:return N.get("reportTemplate","\u62a5\u8868\u6a21\u677f");case ea.DASHBOARD:return N.get("dashboard",
"\u4eea\u8868\u677f");case ea.THEME:return N.get("subject","\u4e1a\u52a1\u4e3b\u9898");case ea.PUBLISH:return N.get("publishRecords","\u53d1\u5e03\u8bb0\u5f55");case ea.PUSH:return N.get("pushRecords","\u63a8\u9001\u8bb0\u5f55");default:return""}};this.getSpaceGroupName=function(a){var D=a.getSpaceType();a=a.getRoleType();switch(D){case fa.PRESET:var y=N.get("presetSpace","\u9884\u7f6e\u7a7a\u95f4");break;case fa.PERSONAL:y=N.get("personalSpace","\u4e2a\u4eba\u7a7a\u95f4");break;case fa.COLLABORATION:y=
N.get("collaborationSpace","\u534f\u4f5c\u7a7a\u95f4"),y=a===V.CREATOR?y+N.get("owned"," (\u6211\u62e5\u6709\u7684)"):y+N.get("involved"," (\u6211\u53c2\u4e0e\u534f\u4f5c\u7684)")}return y};this.getSpaceName=function(a){if(a)switch(a.getSpaceType()){case fa.PERSONAL:return N.get("mySpace","\u6211\u7684\u7a7a\u95f4");case fa.PRESET:return N.get("presetSpace","\u9884\u7f6e\u7a7a\u95f4");default:return a.getSpaceName()}};this.getSpaceIcon=function(){return k.Icons}};var t,x,Q,da,N,V,K,ea,fa;(function(){var I=
com.kingdee.bos.qing;t=I.Seer;I=com.kingdee.bos.qing.framework.common;x=I.AbstractFacade;Q=I.AbstractRemoteCall;da=I.AbstractIcons;N=I.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.collaboration);I=com.kingdee.bos.qing.collaboration.model;V=I.CollaborationRoleType;K=I.AppType;ea=I.RefDataType;fa=I.SpaceType})();k.Icons=new function(){da.call(this);var I=this.protectedMethod;this.protectedInit=function(y,f){y=com.kingdee.bos.qing.collaboration.common.ComboIcon;if(!y)throw Error("com.kingdee.bos.qing.collaboration.common.ComboIcon not found.");
y.define(f,"collaboration-icon");f.setStartPosition(0,0);f.setIconSize(22,22);D(0,0,"collaboration-icon");y.define(f,"collaboration-mgmt");f.setStartPosition(0,0);f.setIconSize(22,22);D(0,0,"collaboration-mgmt");y.define(f,"collaboration-group");f.setIconSize(16,16);f.setGap(1);f.setStartPosition(1,1);D(0,2,"arrow-down");D(0,3,"arrow-up");y.define(f,"collaboration-common");f.setGap(1);f.setStartPosition(0,117);f.setIconSize(16,16);a(0,1,"btn-delete");a(0,2,"btn-edit");a(0,4,"btn-member");f.setStartPosition(0,
151);f.setIconSize(170,98);D(0,0,"icon-empty");f.setStartPosition(280,220);f.setIconSize(50,50);D(0,0,"user-not-exist");f.setStartPosition(0,337);f.setIconSize(56,56);D(0,0,"add-user-image");f.setStartPosition(5,151);f.setIconSize(164,94);D(0,0,"icon-no-data");f.setStartPosition(0,400);f.setIconSize(138,84);D(0,0,"icon-search-none");y.define(f,"collaboration-designer");f.setGap(1);f.setIconSize(16,16);f.setStartPosition(84,52);D(0,2,"unlock");D(0,3,"lock_by_other");D(0,4,"lock_by_me");y.define(f,
"schema-manage-sprite");f.setStartPosition(1,21);f.setGap(1);f.setIconSize(16,16);D(0,0,"icon_undefault");D(1,0,"icon_default")};var a=function(y,f,L){D(y,f,L+"_hover");D(y+1,f,L)},D=function(y,f,L){I.registIcon(y,f,L)}}})();(function(){function p(a){var D,y,f,L,u;this.getJqUi=function(){if(!D){D=$("<div>");y=new V;y.setTabLevel(V.SECOND_LEVEL);f=new C(x.USER);L=new C(x.ROLE);u=new C(x.ALL);y.addTab(f);y.addTab(L);y.addTab(u);var J=y.getJqUi();J.addClass("qing-space-member-tab-container");D.append(J);E(a)}return D};var E=function(J){var ra=da.getFacadeInstance(function(ia){var T=[],aa=[],m=[],la=ia.memberInfoList;ia=ia.allMemberInfoList;if(la&&0<la.length)for(var oa=0;oa<la.length;oa++){var ba=new t;ba.fromJsonObject(la[oa]);
ba.getMemberType()==x.USER?T.push(ba):ba.getMemberType()==x.ROLE&&aa.push(ba)}if(ia&&0<ia.length)for(oa=0;oa<ia.length;oa++)ba=new t,ba.fromJsonObject(ia[oa]),m.push(ba);f.setMembers(T);L.setMembers(aa);u.setMembers(m);y.setCurrentTabPane(f)},function(ia,T){return!1});ra.setBlockingJqUi(D);ra.loadCollaborationMembersForView(J)}}function C(a){V.AbstractTabPane.call(this);var D,y;this.setMembers=function(f){y=f};this.getTitle=function(){return a==x.USER?I.get("systemUser","\u5f53\u524d\u7cfb\u7edf\u7528\u6237"):
a==x.ROLE?I.get("systemRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272"):I.get("allCollaborationMember","\u6240\u6709\u534f\u4f5c\u6210\u5458")};this.getJqUi=function(){D||(D=new k(a),D.setMembers(y));return D.getJqUi()}}function k(a){function D(T){KTDefaultCellRender.call(this,T);var aa=this,m=this.paintCellUI;this.paintCellUI=function(la,oa){var ba=aa.getCurrentRowIdx(),na=aa.getCurrentRow(),ta=aa.getCurrentColIdx();na=na.getUserObject();var W=K.getHeadRowCount();if(ba<W)m(la,oa);else if(0==ta){var Y=
$("<div class='qing-view-member-table-cell-item'>");ba=na.getMemberName();y!=x.ROLE&&(ba=ba+"("+na.getUserAccount()+")");Y.text(ba);Y.attr("title",ba);Y.appendTo(la)}else if(1==ta){ba=$("<div class='qing-view-member-table-cell-item'>");a:{switch(na.getRoleType()){case Q.MEMBER:Y=I.get("member","\u6210\u5458");break a;case Q.ADMIN:Y=I.get("admin","\u7ba1\u7406\u5458");break a;case Q.CREATOR:Y=I.get("creator","\u521b\u5efa\u8005");break a}Y=void 0}ba.text(Y);ba.attr("title",Y);ba.appendTo(la)}else if(2==
ta){ba=$("<div class='qing-view-member-table-cell-item'>");ta=[];na=na.getMemberSource();for(W=0;W<na.length;W++){var ya=na[W];ya.getMemberType()==x.USER&&(Y=I.get("systemUser","\u5f53\u524d\u7cfb\u7edf\u7528\u6237"));ya.getMemberType()==x.ROLE&&ta.push(ya.getMemberName())}if(0<ta.length)for(Y=Y?Y+"\u3001"+I.get("systemRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272"):I.get("systemRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272"),Y+="(",na=0;na<ta.length;na++)Y=Y+ta[na]+"\u3001",na==ta.length-1&&(Y=Y.substring(0,
Y.length-1),Y+=")");ba.text(Y);ba.attr("title",Y);ba.appendTo(la)}m(la,oa)}}var y=a,f,L,u,E=[];this.setMembers=function(T){E=T};this.getJqUi=function(){f||(f=$("<div>"),f.css({width:"100%",height:"100%"}),J());return f};var J=function(){if(0!=document.body.clientHeight&&0!=document.body.clientWidth)if(L||ia(),K.clearWithoutHead(L),E&&0<E.length){for(var T=0,aa=E.length;T<aa;T++){var m=E[T],la=K.createRow(L,!0);la.setUserObject(m);la.setHeight(30)}setTimeout(function(){K.refresh(L)},0)}else ra()},
ra=function(){f.empty();var T=$("<div>");T.addClass("qing-view-member-panel-no-data");var aa=$("<div>");aa.addClass("qing-view-member-panel-no-data-icon");T.append(aa);var m=$("<div>");m.addClass("qing-view-member-panel-no-data-text");T.append(m);var la=I.get("noData","\u6682\u65e0\u6570\u636e");m.text(la);fa.background(aa,"icon-empty");f.append(T)},ia=function(){L=K.createTable();L.setColumnFitVisibleWidth(!0);K.setupSingleRowSelection(L);var T=new D(L);T.setOutsideVisible(!1);L.setCellRender(T);
if(L){L.addColumns(2);L.getColumn(0).setWidth(200);L.getColumn(1).setWidth(100);T=K.createHeadRow(L);var aa=new KTStyle;aa.setBackgroundColor(com.kingdee.bos.qing.common.CommonTableSkin.HEAD_ROW_BACKGROUND_COLOR);aa.setBold(!0);aa.setTextAlign("center");T.setStyle(aa);T.getCell(0).setValue(I.get("user","\u7528\u6237"));T.getCell(1).setValue(I.get("type","\u7c7b\u578b"));y==x.ROLE&&T.getCell(0).setValue(I.get("role","\u89d2\u8272"));y==x.ALL&&(L.addColumn(2),L.getColumn(2).setWidth(300),T.getCell(2).setValue(I.get("source",
"\u6765\u6e90")))}u=$(L.getUI());ea.layoutCtrlWithLRTB(u,0,0,null,0,0,null);f.append(u)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.collaboration&&(com.kingdee.bos.qing.collaboration={});"undefined"==typeof com.kingdee.bos.qing.collaboration.common&&(com.kingdee.bos.qing.collaboration.common=
{});"undefined"==typeof com.kingdee.bos.qing.collaboration.common.ui&&(com.kingdee.bos.qing.collaboration.common.ui={});com.kingdee.bos.qing.collaboration.common.ui.ViewCollaborationMemberDialog=function(a,D){N.call(this);var y=this,f=this.protectedMethod,L;(function(){var u=D+I.get("collaborationMember","-\u534f\u4f5c\u6210\u5458");f.setTitle(u);y.setSize(600,600);f.setContentPaneCreator(function(){L=new p(a);return L.getJqUi()});f.setFooterClosingOnly(!0);f.setClosingChecker2(null,function(E){f.destroy();
return!0});f.setClosingAction(function(E){f.destroy()})})()};var t,x,Q,da,N,V,K,ea,fa,I;(function(){a=com.kingdee.bos.qing.framework.common;I=a.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.collaboration);a=com.kingdee.bos.qing.common;ea=a.DomUtil;var a=com.kingdee.bos.qing.common.ui;K=a.TableUtil;a=com.kingdee.bos.qing.ui.component;N=a.AbstractModalDialog;V=a.TabContainer;a=com.kingdee.bos.qing.collaboration.common;da=a.SpaceHelper;fa=a.Icons;a=com.kingdee.bos.qing.collaboration.model;
t=a.CollaborationMemberModel;x=a.MemberType;Q=a.CollaborationRoleType})()})();(function(){function p(){var e=this,v,h,d=!0,l=[],n=[],F=[],O=[],B,z,P,R,c,b=!0,A,g=[],w={},S,ha,Aa,Ba;this.setSpaceDefaultIconVisible=function(r){d=r};this.setBlockJqUi=function(r){A=r};this.setMessageCurtain=function(r){v=r};this.setFunRefreshCollaborationSpace=function(r){ha=r};this.setFunShowOrHideToolbar=function(r){Aa=r};this.setFunCloseSearchPane=function(r){Ba=r};this.block=function(r,M){(b=r)?(c&&c.remove(),c=la.block(M,""),c.children().css({height:"90px","background-color":"rgba(0,0,0,0.001)",
scale:"0.7"})):(b=r,c&&c.remove(),c=null)};this.createJqPopup=function(r,M,q,U,X){g=[];w={};e.block(!0,A);var ja=W.getFacadeInstance(function(ca){S=q;h=M;for(var qa=0;qa<ca.length;qa++){var ua=new Y;ua.fromJsonObject(ca[qa]);var va=ua;va&&va.getSpaceType()==xa.PRESET?va.setSpaceName(m.get("presetSpace","\u9884\u7f6e\u7a7a\u95f4")):va&&va.getSpaceType()==xa.PERSONAL&&va.setSpaceName(m.get("mySpace","\u6211\u7684\u7a7a\u95f4"));g.push(ua)}Ca(r);R?H():e.refresh(g);ua=M.getSpaceType();if($(".collaboration-space-switch-container").height()<
p.MAX_HEIGHT||ua==xa.PERSONAL)ca=0;else{ca=P&&P.height();va=$(".collaboration-space-mgmt-button").height();qa=(l.length+1)*p.SPACE_ITEM_HEIGHT;var za=(0<n.length?n.length+1:0)*p.SPACE_ITEM_HEIGHT,Da=(0<F.length?F.length+1:0)*p.SPACE_ITEM_HEIGHT,Ha=(0<O.length?O.length+1:0)*p.SPACE_ITEM_HEIGHT;if(ua==xa.PRESET)ca=ca+qa+za+Da+Ha+va;else{za=!1;for(Da=va=ua=0;Da<n.length;Da++)if(ua++,M.getSpaceID()==n[Da].getSpaceID()){za=!0;va=(ua+1)*p.SPACE_ITEM_HEIGHT;break}if(!za)for(ua++,za=0;za<F.length;za++)if(ua++,
M.getSpaceID()==F[za].getSpaceID()){va=(ua+1)*p.SPACE_ITEM_HEIGHT;break}ca=va+ca+qa+10}}qa=$(".collaboration-space-mgmt-button").height();qa=p.MAX_HEIGHT-qa;ca=ca>qa?ca-qa:0;if(qa=document.querySelector(".collaboration-space-container"))qa.scrollTop=0>ca?0:ca},function(ca,qa){return!1},function(){e.block(!1,A)});ja.setShowBlocking(!1);ja.loadCollaborationSpaces(U,X);return["unset","unset"]};var Ca=function(r){r.addClass("collaboration-space-switch-container");z||(z=new a,z.setSearchListenerDelay(1E3),
z.addSearchListener(H),z.setAlwaysShowCleanIcon(!0),z.setShowSearchIcon(!0),z.setPlaceholder(m.get("searchSpaceName","\u641c\u7d22\u7a7a\u95f4\u540d\u79f0")));P=z.getJqUi();P.addClass("collaboration-search-space-box");P.find(":input").on("keydown",function(U){13==(U.keyCode||U.which||U.charCode)&&H()});P.find(".sa-ctrl-searchbox-close").on("click",function(){R="";z.clear();e.refresh(g)});B=$("<div>");B.addClass("collaboration-space-container");var M=$("<div>");M.addClass("collaboration-space-mgmt-button");
var q=$("<div>");q.text(m.get("spaceManage","\u534f\u4f5c\u7a7a\u95f4\u7ba1\u7406"));q.addClass("collaboration-space-mgmt-text");q.appendTo(M);q.on("click",function(){r.hide();(new C).showDialog()});q=$("<span>");q.addClass("collaboration-space-mgmt-icon");q.attr("title",m.get("spaceManage","\u534f\u4f5c\u7a7a\u95f4\u7ba1\u7406"));E.background(q,"collaboration-mgmt");q.appendTo(M);q=$("<div class='collaboration-space-split-line'>");r.append(P);r.append(B);r.append(q);r.append(M)},H=function(){var r=
[];R=z.getText().trim();for(var M=0;M<g.length;M++){var q=g[M];-1!=q.getSpaceName().toUpperCase().indexOf(R.toUpperCase())&&r.push(q)}e.refresh(r)};this.refresh=function(r){B.find(".collaboration-space-list").remove();var M=$("<div>");M.addClass("collaboration-space-list");M.appendTo(B);var q=[];if(r&&0!==r.length){l=[];n=[];F=[];O=[];for(var U=0;U<r.length;U++){var X=r[U],ja=X.getSpaceType(),ca=X.getRoleType();switch(ja){case xa.PRESET:O.push(X);break;case xa.PERSONAL:l.push(X);break;case xa.COLLABORATION:ca===
ka.CREATOR?n.push(X):F.push(X)}}q.push(l);q.push(n);q.push(F);q.push(O)}r=q;for(q=0;q<r.length;q++)if(U=r[q],G(U,M),ja=U,U=M,ja&&0!==ja.length)for(X=$("<div>"),X.addClass("collaboration-group-space-list"),X.css("height",34*ja.length),ca=new I,ca.scrollSelectedToVisible(),ca.setBorderVisible(!1),ca.setCustomItemPainter(ma),ca.addSelectedChangedListener(Z),ca.setUserObject(ja),ca.setItemModels(ja),ja=ca,ca=ja.getJqUi(),X.data("oList",ja),ca.appendTo(X),X.appendTo(U),U=$(".collaboration-group-space-list"),
X=0;X<U.length;X++)U.eq(X).find(".sa-ctrl-list-owner").css({left:"0px",bottom:"0px",top:"0px",right:"0px"});M=w[h.getSpaceID()];r=$(".collaboration-group-item-selected");for(q=0;q<r.length;q++)r.eq(q).removeClass("collaboration-group-item-selected");M&&M.addClass("collaboration-group-item-selected")};var G=function(r,M){if(r&&0!==r.length){var q=$("<div>");q.addClass("collaboration-group-head");q.on("click",function(){var ja=q.next();"block"==$(ja).css("display")?(E.background(X,"arrow-down"),$(ja).hide()):
(E.background(X,"arrow-up"),$(ja).show())});var U=$("<div>");r=W.getSpaceGroupName(r[0]);U.text(r);U.addClass("collaboration-group-head-text");q.append(U);var X=$("<div>");X.addClass("collaboration-group-head-icon");E.background(X,"arrow-up");q.append(X);q.appendTo(M)}},Z=function(r,M,q){q&&0<q.length&&(r=q[0],S&&S(r),ha&&ha(r),Aa&&Aa(),Ba&&Ba())},ma=function(r,M){$(r.parentElement).css("overflow","hidden");r.addClass("collaboration-group-item");r.attr("id",M.getSpaceID());var q=$("<div>");q.addClass("qing-space-default-icon");
q.addClass("qing-space-default-icon-hide");q.prop("title",m.get("setDefaultSpace","\u8bbe\u4e3a\u9ed8\u8ba4\u7a7a\u95f4"));q.on("mousedown",function(ja){ja.stopPropagation();wa(M)});var U=$("<div>");U.addClass("collaboration-group-item-name");var X=W.getSpaceName(M);d&&M&&M.isDefault()?(X=m.get("defaultPrefix","(\u9ed8\u8ba4)")+X,U.css("font-weight","bold"),q.addClass("qing-space-default-icon-show"),E.background(q,"icon_default")):(q.addClass("qing-space-default-icon-show"),E.background(q,"icon_undefault"),
q.on("mouseover",function(){E.background(q,"icon_default")}),q.on("mouseout",function(){E.background(q,"icon_undefault")}));U.attr("title",X);r.append(U);d&&(r.append(q),r.on("mouseover",sa),r.on("mouseout",Ia));w[M.getSpaceID()]=r;W.highlightKeyWords(U,R,X)},wa=function(r){var M=W.getFacadeInstance(function(q){if(1==q){for(q=0;q<g.length;q++){var U=g[q];U.getSpaceID()!=r.getSpaceID()?U.setDefault(!1):U.setDefault(!0)}e.refresh(g);v.showSuccess(m.get("settingSuccess","\u8bbe\u7f6e\u6210\u529f\u3002"),
2E3)}},function(q,U){return!1});M.setShowBlocking(!1);M.updateUserDefaultSpace(r)},sa=function(r){r=r.currentTarget.childNodes;for(var M=0;M<r.length;M++){var q=$(r[M]);q.hasClass("qing-space-default-icon-hide")?q.removeClass("qing-space-default-icon-hide"):q.hasClass("collaboration-group-item-name")&&q.css("max-width","180px")}},Ia=function(r){r=r.currentTarget.childNodes;for(var M=0;M<r.length;M++){var q=$(r[M]);q.hasClass("qing-space-default-icon-show")?q.addClass("qing-space-default-icon-hide"):
q.hasClass("collaboration-group-item-name")&&q.css("max-width","200px")}}}function C(){y.call(this);var e=this,v=this.protectedMethod,h=!1,d;(function(){v.setTitle(m.get("spaceManage","\u534f\u4f5c\u7a7a\u95f4\u7ba1\u7406"));e.setSize(1E3,610);v.getDialogCtrl().setFullScreenEnabled();v.getDialogCtrl().addResizeListener(function(l,n){h=1E3<l||610<n;d&&d.setFullScreen(h)});v.setContentPaneCreator(function(){d=new k;d.setFullScreen(h);d.setMessageCurtain(v.getMessageCurtain());return d.getJqUi()});v.setFooterClosingOnly(!0);
v.setClosingChecker2(null,function(){v.destroy()});v.setClosingAction(function(l){})})()}function k(){var e,v,h,d,l,n,F=!1,O;this.setFullScreen=function(c){F!=c&&(F=c,!F&&h&&d&&h.isExpanded()&&d.isExpanded()&&d.setExpand(!1))};this.setMessageCurtain=function(c){n=c};this.getJqUi=function(){!e&&B();return e};var B=function(){e=$("<div>");e.addClass("qing-space-manage");var c=$("<div>");c.addClass("qing-space-manage-toolbar");R(c,m.get("create","\u65b0\u5efa"),!0,P);R(c,m.get("refresh","\u5237\u65b0"),
!1,function(){l.sort()});var b=D.createSortField(m.get("createTime","\u521b\u5efa\u65f6\u95f4"),"FCREATETIME"),A=D.createSortField(m.get("name","\u540d\u79f0"),"FNAME");l=new D;l.setSortField([b,A]);l.setSortListener(z);b=l.getJqUi();b.addClass("qing-space-manage-sort-selector");c.append(b);b=new a;b.setPlaceholder(m.get("searchSpaceNameOrDesc","\u641c\u7d22\u7a7a\u95f4\u540d\u79f0/\u63cf\u8ff0"));b.setSearchListenerDelay(1E3);b.setShowSearchIcon(!0);b.addSearchListener(function(g){O=g.getText().trim();
l.sort()});b=b.getJqUi();b.addClass("qing-space-manage-search-box");c.append(b);v=$("<div>");v.addClass("qing-space-manage-content");h=new t(!0);h.setMessageCurtain(n);h.setEditSuccessCallback(function(g){n.showSuccess(m.get("editSuccess","\u7f16\u8f91\u6210\u529f\u3002"));l.sort()});h.setExpandListener(function(){F||d.setExpand(!1)});b=h.getJqUi();v.append(b);d=new t(!1);d.setExpandListener(function(){F||h.setExpand(!1)});b=d.getJqUi();b.css("margin-top","20px");v.append(b);v.append(c);v.append(v);
e.append(c);e.append(v);l.sort()},z=function(c,b){W.getFacadeInstance(function(A){var g=[],w=[];if(A&&A.length)for(var S=0;S<A.length;S++){var ha=new Y;ha.fromJsonObject(A[S]);ha.getSpaceType()==xa.COLLABORATION&&(ha.getRoleType()==ka.CREATOR?g.push(ha):w.push(ha))}A=0==g.length&&0<w.length;h.setSearchText(O);h.setSpaceModels(g);h.setExpand(!A);d.setSearchText(O);d.setSpaceModels(w);d.setExpand(A)}).loadCollaborationSpaces(c.getPropertyName(),b,xa.COLLABORATION,O)},P=function(){var c=new Q(!0);c.setEditSuccessCallback(function(b){n.showSuccess(m.get("createSuccess",
"\u65b0\u5efa\u6210\u529f\u3002"));l.sort()});c.showDialog()},R=function(c,b,A,g){var w=$("<div>");w.text(b);w.on("click",g);w.addClass("qing-space-manage-toolbar-btn");c.append(w);A&&(b=$("<div>"),b.addClass("qing-vertical-separator"),c.append(b))}}function t(e){var v,h,d,l,n,F,O,B=!1,z,P;this.setMessageCurtain=function(g){P=g};this.setExpandListener=function(g){z=g};this.setSpaceModels=function(g){n=[];if(g&&0<g.length)for(var w=0;w<g.length;w++){var S=new x(g[w]);S.setSearchText(F);S.setMessageCurtain(P);
S.setDeleteSuccessCallback(A);S.setEditSuccessCallback(O);n.push(S)}v&&c()};this.isExpanded=function(){return B};this.setExpand=function(g){g!=B&&(B=g,v&&b())};this.setSearchText=function(g){F=g};this.setEditSuccessCallback=function(g){O=g};this.getJqUi=function(){!v&&R();return v};var R=function(){v=$("<div>");v.addClass("qing-space-card-panel");var g=$("<div>");g.on("click",function(){B=!B;b()});g.addClass("qing-space-card-panel-top");d=$("<div>");d.addClass("qing-space-card-panel-triangle");var w=
$("<div>");w.addClass("qing-space-card-panel-triangle-wrapper");w.append(d);g.append(w);w=$("<div>");var S=e?m.get("ownedSpace","\u6211\u62e5\u6709\u7684\u7a7a\u95f4"):m.get("involvedSpace","\u6211\u53c2\u4e0e\u534f\u4f5c\u7684\u7a7a\u95f4");w.text(S);w.addClass("qing-space-card-panel-title");g.append(w);h=$("<div>");h.addClass("qing-space-card-panel-search-count");g.append(h);l=$("<div>");l.addClass("qing-space-card-panel-content");v.append(g);v.append(l);c();b()},c=function(){if(F){var g=n?n.length:
0;h.text(m.get("searchCount","\uff08\u5171\u627e\u5230 #1 \u4e2a\u7ed3\u679c\uff09").replace("#1",g));h.show()}else h.hide();if(n&&0<n.length)for(l.empty(),g=0;g<n.length;g++){var w=n[g].getJqUi();l.append(w)}else{l.empty();g=$("<div>");g.addClass("qing-space-card-panel-no-data");w=$("<div>");w.addClass("qing-space-card-panel-no-data-icon");g.append(w);var S=$("<div>");S.addClass("qing-space-card-panel-no-data-text");g.append(S);if(F)S.text(m.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),
E.background(w,"icon-search-none"),w.css({width:"138px",height:"84px"});else{var ha=e?m.get("noOwnedSpace","\u6682\u672a\u521b\u5efa\u534f\u4f5c\u7a7a\u95f4"):m.get("noInvolvedSpace","\u6682\u65e0\u53c2\u4e0e\u534f\u4f5c\u7684\u7a7a\u95f4");S.text(ha);E.background(w,"icon-empty")}l.append(g)}},b=function(){B?(v.addClass("qing-space-card-panel-expand"),d.removeClass("qing-space-card-panel-triangle-right"),d.addClass("qing-space-card-panel-triangle"),l.show(),z&&z()):(v.removeClass("qing-space-card-panel-expand"),
d.removeClass("qing-space-card-panel-triangle"),d.addClass("qing-space-card-panel-triangle-right"),l.hide())},A=function(g){g=n.indexOf(g);-1!=g&&(n.splice(g,1),c())}}function x(e){var v=this,h=e,d,l,n,F,O,B;this.setMessageCurtain=function(c){B=c};this.getSpaceModel=function(){return h};this.setSearchText=function(c){n=c};this.setEditSuccessCallback=function(c){F=c};this.setDeleteSuccessCallback=function(c){O=c};this.getJqUi=function(){if(!d){d=$("<div>");d.addClass("qing-space-card-item");var c=
$("<div>");c.addClass("qing-space-card-head");d.append(c);var b=$("<div>");E.background(b,"collaboration-icon");b.addClass("qing-space-card-head-icon");c.append(b);l=$("<div>");W.highlightKeyWords(l,n,h.getSpaceName());l.addClass("qing-space-card-head-name");l.attr("title",h.getSpaceName());c.append(l);c=$("<div>");c.addClass("qing-space-card-create-time");b=$("<span>");b.text(m.get("cardCreateTime","\u521b\u5efa\u65f6\u95f4\uff1a"));c.append(b);b=$("<span>");b.text(h.getFormatCreateTime());c.append(b);
d.append(c);c=$("<div>");c.addClass("qing-space-card-description");d.append(c);if(b=h.getDescription()){var A=$("<span>");A.text(m.get("description","\u63cf\u8ff0\uff1a"));c.append(A)}else b=m.get("noDescription","\u6682\u65e0\u63cf\u8ff0");W.highlightKeyWords(c,n,b);c.attr("title",b);b=h.getRoleType();c=$("<div>");c.addClass("qing-space-card-toolbar");d.append(c);A=b!=ka.MEMBER?m.get("collaborationMemberManage","\u534f\u4f5c\u6210\u5458\u7ba1\u7406"):m.get("viewCollaborationMember","\u67e5\u770b\u534f\u4f5c\u6210\u5458");
var g=$("<div>");E.backgroundWithHover(g,"btn-member");g.attr("title",A);g.on("click",z);g.addClass("qing-space-card-toolbar-btn");c.append(g);b==ka.CREATOR&&(b=$("<div>"),E.backgroundWithHover(b,"btn-delete"),b.attr("title",m.get("delete","\u5220\u9664")),b.on("click",R),b.addClass("qing-space-card-toolbar-btn"),b.addClass("qing-space-card-toolbar-btn-right"),c.append(b),b=$("<div>"),E.backgroundWithHover(b,"btn-edit"),b.attr("title",m.get("edit","\u7f16\u8f91")),b.on("click",P),b.addClass("qing-space-card-toolbar-btn"),
b.addClass("qing-space-card-toolbar-btn-right"),c.append(b))}return d};var z=function(){(new da(h)).showDialog()},P=function(){var c=new Q(!1);c.setSpaceModel(h);c.setEditSuccessCallback(function(b){h=b;F&&F(b)});c.showDialog()},R=function(){var c=function(w){if(w&&0<w.length){for(var S="",ha=0;ha<w.length;ha++)w[ha]==Ea.RPT?S+=m.get("qingReportData","\u8f7b\u62a5\u8868\u6570\u636e\u5185\u5bb9\uff08\u6570\u636e\u96c6\u3001\u62a5\u8868\u6a21\u677f\u3001\u53d1\u5e03\u8bb0\u5f55\uff09"):w[ha]==Ea.QING&&
(S+=m.get("qingAnalysisData","\u8f7b\u5206\u6790\u6570\u636e\u5185\u5bb9\uff08\u4e1a\u52a1\u4e3b\u9898\u3001\u4eea\u8868\u677f\u3001\u53d1\u5e03\u8bb0\u5f55\u3001\u63a8\u9001\u8bb0\u5f55\uff09")),ha!=w.length-1&&(S+="\u3001");w=m.get("deleteSpaceTips","\u8bf7\u5148\u5220\u9664\u534f\u4f5c\u7a7a\u95f4\u5185\u7684#1\uff0c\u518d\u5220\u9664\u534f\u4f5c\u7a7a\u95f4\u3002").replace("#1",S);B.showPrompt(w)}else O&&F(v),B.showSuccess(m.get("deleteSuccess","\u5220\u9664\u6210\u529f\u3002"))},b=function(w,
S){return 23771005==w?(B.showPrompt(m.get("spaceNotExist","\u534f\u4f5c\u7a7a\u95f4\u4e0d\u5b58\u5728\u3002")),!0):23771006==w?(B.showPrompt(m.get("noSpacePermission","\u60a8\u6ca1\u6709\u8be5\u534f\u4f5c\u7a7a\u95f4\u7684\u5220\u9664\u6743\u9650\u3002")),!0):!1},A=aa.createFeedbackDialog();A.setOptionType(aa.OPTION_OK_CANCEL);A.setMsgImageType(aa.MSG_DELETE);var g=m.get("deleteSpaceConfirm","\u5220\u9664\u534f\u4f5c\u7a7a\u95f4\u201c#1\u201d\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f").replace("#1",
h.getSpaceName());A.setMessage(g);A.setClosingChecker(function(w){w==aa.RETURN_OK&&W.getFacadeInstance(c,b).deleteCollaborationSpace(h.getSpaceID());return!0});A.showDialog()}}function Q(e){y.call(this);var v=this,h=this.protectedMethod,d,l,n,F;(function(){var O=e?m.get("createSpace","\u65b0\u5efa\u534f\u4f5c\u7a7a\u95f4"):m.get("editSpace","\u7f16\u8f91\u534f\u4f5c\u7a7a\u95f4");h.setTitle(O);v.setSize(400,300);h.setContentPaneCreator(function(){var B=$("<div>"),z=new f(m.get("name","\u540d\u79f0"));
z.setRequired(!0);z=z.getJqUi();oa.layoutCtrl(z,10,null,null,null);d=new L;var P=d.getJqUi();oa.layoutCtrl(P,80,null,280,23);var R=(new f(m.get("descriptionLabel","\u63cf\u8ff0"))).getJqUi();oa.layoutCtrl(R,10,48,null,null);l=new u;var c=l.getJqUi();oa.layoutCtrl(c,80,48,280,100);!e&&n&&(d.setText(n.getSpaceName()),l.setText(n.getDescription()));B.append(z);B.append(P);B.append(R);B.append(c);return B});h.setClosingChecker(function(B){var z=d.getText()?d.getText().trim():"",P=l.getText()?l.getText().trim():
"",R=!1;z?ta.isValidString(z)?50<z.length?(h.getMessageCurtain().showPrompt(m.get("nameTooLong","\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002")),R=!0):P&&500<P.length&&(h.getMessageCurtain().showPrompt(m.get("descTooLong","\u63cf\u8ff0\u4e0d\u80fd\u8d85\u8fc7500\u4e2a\u5b57\u7b26\u3002")),R=!0):(R=m.get("nameInValid","\u540d\u79f0\u4e0d\u80fd\u4ee5\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u5f00\u5934\uff0c\u4e14\u4e0d\u80fd\u5305\u542b\u4ee5\u4e0b\u7279\u6b8a\u7b26\u53f7\uff1a#1\u3002").replace("#1",
"!@#$%^&*?~+-=()[]{}<>\\/|.,:;`'\""),h.getMessageCurtain().showPrompt(R),R=!0):(h.getMessageCurtain().showPrompt(m.get("nameEmptyWarning","\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002")),R=!0);R?B(!1):(n||(n=new Y,n.setRoleType(ka.CREATOR),n.setSpaceType(xa.COLLABORATION)),n.setSpaceName(z),n.setDescription(P),W.getFacadeInstance(function(c){n=new Y;n.fromJsonObject(c);B(!0);F&&F(n)},function(c,b){23771001==c?h.getMessageCurtain().showPrompt(m.get("nameExist","\u8be5\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002")):
h.getMessageCurtain().showPrompt(b);B(!1);return!0}).saveCollaborationSpace(n))},!0);h.setClosingAction(function(B){})})();this.setSpaceModel=function(O){n=O?O.copy():null};this.setEditSuccessCallback=function(O){F=O}}function da(e){y.call(this);var v=this,h=this.protectedMethod,d;(function(){var l=e.getSpaceName()+"-"+m.get("collaborationMemberManage","\u534f\u4f5c\u6210\u5458\u7ba1\u7406");h.setTitle(l);v.setSize(910,600);h.setFooterClosingOnly(!0);h.setContentPaneCreator(function(){d=new N(e);
d.setMessageCurtain(h.getMessageCurtain());return d.getJqUi()});h.setClosingChecker2(null,function(n){h.destroy();return!0});h.setClosingAction(function(n){})})()}function N(e){var v,h,d,l,n,F;this.setMessageCurtain=function(z){F=z};this.getMembers=function(){var z=[];d&&l&&(z=d.getMembers().concat(l.getMembers()));return z};this.getJqUi=function(){!v&&O();return v};var O=function(){v=$("<div>");var z=new a;z.setPlaceholder(m.get("searchPlaceholder","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));
z.setSearchListenerDelay(500);z.setShowSearchIcon(!0);z.addSearchListener(function(P){n=P.getText().trim();d.searchMember(n);l.searchMember(n)});z=z.getJqUi();z.addClass("qing-space-member-manage-search-box");v.append(z);h=new J;h.setTabLevel(J.SECOND_LEVEL);d=new V(pa.USER,e);d.setMessageCurtain(F);l=new V(pa.ROLE,e);l.setMessageCurtain(F);h.addTab(d);h.addTab(l);l.getJqUi();z=h.getJqUi();z.addClass("qing-space-member-manage-tab-container");v.append(z);B()},B=function(){var z=W.getFacadeInstance(function(P){var R=
[],c=[];if(P&&0<P.length)for(var b=0;b<P.length;b++){var A=new ya;A.fromJsonObject(P[b]);A.getMemberType()==pa.USER?R.push(A):A.getMemberType()==pa.ROLE&&c.push(A)}d.setMembers(R);l.setMembers(c);n&&(d.searchMember(n),l.searchMember(n));h.setCurrentTabPane(d)});z.setShowBlocking(!0);z.loadCollaborationMembers(e.getSpaceID(),null)}}function V(e,v){J.AbstractTabPane.call(this);var h,d,l;this.setMessageCurtain=function(n){l=n};this.setMembers=function(n){d=n;h&&h.setMembers(d)};this.getMembers=function(){return h?
h.getMembers():d};this.getTitle=function(){return e==pa.USER?m.get("systemUser","\u5f53\u524d\u7cfb\u7edf\u7528\u6237"):m.get("systemRole","\u5f53\u524d\u7cfb\u7edf\u89d2\u8272")};this.getJqUi=function(){h||(h=new K(e,v),h.setMessageCurtain(l),h.setMembers(d));return h.getJqUi()};this.searchMember=function(n){h.searchMember(n)};this.into=function(){}}function K(e,v){var h=v.getRoleType()!=ka.MEMBER,d,l,n,F,O,B,z,P,R={},c,b;this.setMessageCurtain=function(H){b=H};this.setMembers=function(H){A(H)};
var A=function(H){if(B&&0<B.length)for(var G=0;G<B.length;G++)B[G].getJqUi().remove();B=[];R={};if(H&&0<H.length)for(G=0;G<H.length;G++){var Z=new ea(H[G],h);Z.setDeleteSuccessCallback(S);Z.setMessageCurtain(b);B.push(Z);R[H[G].getMemberID()]=Z;H[G].getRoleType()==ka.CREATOR&&(c=Z)}d&&g()};this.searchMember=function(H){z=H;if(d){l&&(z?l.hide():l.show());for(var G=H=0;G<B.length;G++)B[G].matchSearchText(z)&&H++;0!=H||!z&&h?n&&n.hide():w()}};this.getMembers=function(){for(var H=[],G=0;G<B.length;G++){var Z=
B[G].getMemberModel();Z.isExists()&&H.push(Z)}return H};this.getJqUi=function(){if(!d){d=$("<div>");d.addClass("qing-space-member-manage-tab-content");if(h){l=$("<div>");l.addClass("qing-space-member-card");l.css("cursor","pointer");l.on("click",ha);var H=$("<div>");H.addClass("qing-space-member-card-add-icon");E.background(H,"add-user-image");var G=$("<div>");G.addClass("qing-space-member-card-add-text");e==pa.USER?(G.text(m.get("addUser","\u6dfb\u52a0\u7528\u6237")),P=new T):(G.text(m.get("addRole",
"\u6dfb\u52a0\u89d2\u8272")),P=new ia);P.setSelectedListener(Aa);l.append(H);l.append(G);d.append(l)}g()}return d};var g=function(){n&&n.hide();for(var H=0;H<B.length;H++)d.append(B[H].getJqUi());!z&&h||0!=B.length||w()},w=function(){n||(n=$("<div>"),n.addClass("qing-space-card-member-no-data"),F=$("<div>"),F.addClass("qing-space-card-member-no-data-icon"),n.append(F),O=$("<div>"),O.addClass("qing-space-card-member-no-data-text"),n.append(O),d.append(n));if(z){var H=m.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c");
E.background(F,"icon-search-none");F.css({width:"138px",height:"84px"})}else H=e==pa.USER?m.get("noUser","\u6682\u672a\u6dfb\u52a0\u5f53\u524d\u7cfb\u7edf\u7528\u6237"):m.get("noRole","\u6682\u672a\u6dfb\u52a0\u5f53\u524d\u7cfb\u7edf\u89d2\u8272"),E.background(F,"icon-no-data"),F.css({width:"164px",height:"94px"});O.text(H);n.show()},S=function(H){var G=B.indexOf(H);-1!=G&&(B.splice(G,1),H.getJqUi().remove());!z&&h||0!=B.length||w()},ha=function(){for(var H=[],G=0;G<B.length;G++){var Z=B[G].getMemberModel();
if(Z.getRoleType()!=ka.CREATOR){var ma=new na;ma.setText(Z.getMemberName());ma.setValue(Z.getMemberID());H.push(ma)}}P.setSelectedValue(H);P.protectedClickEvent()},Aa=function(H){var G=[];if(c){G.push(c.getMemberModel());var Z=c.getMemberModel().getMemberID()}for(var ma=0;ma<H.length;ma++){var wa=H[ma].getValue();if(!Z||Z!=wa){var sa=R[wa];sa?G.push(sa.getMemberModel()):(sa=new ya,sa.setSpaceID(v.getSpaceID()),sa.setMemberID(wa),sa.setMemberType(e),sa.setRoleType(ka.MEMBER),sa.setMemberName(H[ma].getText()),
G.push(sa))}}Ba(G)},Ba=function(H){W.getFacadeInstance(function(G){var Z=G.canNotDeleteMemberIds;G=G.newMemberNames;if(Z&&0<Z.length){for(var ma=[],wa=0;wa<Z.length;wa++){var sa=R[Z[wa]].getMemberModel();ma.push(sa)}Z=Ga(e,ma,G);Fa(Z,function(){W.getFacadeInstance(null,null,function(){Ca()}).deleteCollaborationMembers(ma,!0,v.getSpaceID())},function(){Ca()})}else Ca()},function(G,Z){return 23771002==G?(G=m.get("noSpacePermAfterSaveMembers","\u64cd\u4f5c\u5931\u8d25\u3002\u6b64\u6b21\u64cd\u4f5c\u4f1a\u5c06\u60a8\u79fb\u9664\u534f\u4f5c\u7a7a\u95f4\uff0c\u7531\u4e8e\u60a8\u4e0d\u80fd\u79fb\u9664\u81ea\u5df1\uff0c\u6240\u4ee5\u64cd\u4f5c\u5931\u8d25\u3002"),
b.showPrompt(G),!0):23771007==G?(b.showPrompt(m.get("noSpaceAdminPermission","\u60a8\u6ca1\u6709\u5f53\u524d\u534f\u4f5c\u7a7a\u95f4\u7684\u7ba1\u7406\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6388\u6743\u3002")),!0):!1}).saveCollaborationMembers(H,v.getSpaceID(),e)},Ca=function(){var H=W.getFacadeInstance(function(G){var Z=[];if(G&&0<G.length)for(var ma=0;ma<G.length;ma++){var wa=new ya;wa.fromJsonObject(G[ma]);Z.push(wa)}A(Z)});H.setShowBlocking(!0);H.loadCollaborationMembers(v.getSpaceID(),
e)}}function ea(e,v){var h=this,d,l,n,F,O,B;this.setDeleteSuccessCallback=function(c){O=c};this.setMessageCurtain=function(c){B=c};this.getMemberModel=function(){return e};this.getJqUi=function(){if(!d){d=$("<div>");d.addClass("qing-space-member-card");var c=e.getMemberName();if(e.isExists()){var b=$("<div>");b.addClass("qing-space-member-card-profile");b.css("background-color",e.getColor());b.text(c[0]);d.append(b);n=$("<div>");n.addClass("qing-space-member-card-name");n.text(c);d.append(n);e.getMemberType()==
pa.USER&&(F=$("<div>"),F.addClass("qing-space-member-card-account"),F.text(e.getUserAccount()),d.append(F));c=$("<div>");c.addClass("qing-space-member-card-bottom");d.append(c);b=$("<div>");b.addClass("qing-space-member-card-role");c.append(b);l=$("<div>");l.addClass("qing-space-member-card-role-icon");b.append(l);var A=e.getRoleType(),g=A==ka.MEMBER?"":A==ka.CREATOR?"#FF991C":"#1BA854";g?l.css("background-color",g):l.css("visibility","hidden");v?e.getRoleType()==ka.CREATOR?(l.css("background-color",
"#FF991C"),c.css("padding-left","50px"),c.css("bottom","12px"),c=$("<div>"),c.text(W.getRoleTypeName(ka.CREATOR)),c.addClass("qing-space-member-card-role-text"),b.append(c)):(c.css("padding-left","15px"),A=P(),A.addClass("qing-space-member-card-role-selector"),A.removeClass("sa-ctrl-common-singlelineborder"),A.removeClass("sa-ctrl-common-singlelineborder_disabled"),b.append(A),b=$("<div>"),b.text("|"),b.addClass("qing-space-member-card-bottom-line"),c.append(b),c.append(z(!0))):(c.css("padding-left",
"50px"),c=$("<div>"),c.text(W.getRoleTypeName(A)),c.addClass("qing-space-member-card-role-text"),b.append(c))}else b=$("<div>"),b.addClass("qing-space-member-card-profile"),E.background(b,"user-not-exist"),d.append(b),c=e.getMemberType()==pa.USER?m.get("userNotFound","\u627e\u4e0d\u5230\u8be5\u7528\u6237"):m.get("roleNotFound","\u627e\u4e0d\u5230\u8be5\u89d2\u8272"),b=$("<div>"),b.addClass("qing-space-member-card-no-exist"),A=ba.createWarning(),A.addClass("qing-space-warning-icon"),g=$("<div>"),g.addClass("qing-space-member-card-no-exist-text"),
g.text(c),b.append(A),b.append(g),d.append(b),v&&e.getRoleType()!=ka.CREATOR&&d.append(z(!1))}return d};this.matchSearchText=function(c){if(!e.isExists()||!n)return!1;var b=c?c.toUpperCase():c,A=e.getMemberName(),g=e.getUserAccount(),w=e.getMemberType();b=!b||A.toUpperCase().includes(b)||w==pa.USER&&g.toUpperCase().includes(b);n.empty();W.highlightKeyWords(n,c,A);F&&(F.empty(),W.highlightKeyWords(F,c,g));b?d.show():d.hide();return b};var z=function(c){var b=$("<div>");c?b.addClass("qing-space-member-card-remove-btn"):
b.addClass("qing-space-member-card-no-exists-remove-btn");b.text(m.get("remove","\u79fb\u9664"));b.on("click",function(){var A=m.get("removeConfirm","\u786e\u5b9a\u79fb\u9664\u201c#1\u201d\u5417\uff1f").replace("#1",e.getMemberName);Fa(A,function(){R(e,!1,function(g){g?(g=Ga(e.getMemberType(),[e],null),Fa(g,function(){R(e,!0,function(w){O&&O(h)})})):O&&O(h)})})});return b},P=function(){var c=[ka.ADMIN,ka.MEMBER],b=new ra;b.setCustomPainter(function(A,g,w){g.text(W.getRoleTypeName(w))});b.setItemModels(c);
b.setSelected(e.getRoleType());e.getRoleType()==ka.ADMIN?(l.css("visibility","visible"),l.css("background-color","#1BA854")):l.css("visibility","hidden");b.addSelectedChangedListener(function(A,g,w){W.getFacadeInstance(function(S){e.setRoleType(w);w==ka.ADMIN?(l.css("visibility","visible"),l.css("background-color","#1BA854")):l.css("visibility","hidden");S=m.get("roleTypeChangeTips","\u201c#1\u201d\u5df2\u4fee\u6539\u4e3a#2\u3002").replace("#1",e.getMemberName).replace("#2",W.getRoleTypeName(w));
B.showSuccess(S)},function(S,ha){A.setSelected(g);return 23771007==S?(B.showPrompt(m.get("noSpaceAdminPermission","\u60a8\u6ca1\u6709\u5f53\u524d\u534f\u4f5c\u7a7a\u95f4\u7684\u7ba1\u7406\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6388\u6743\u3002")),!0):!1}).updateCollaborationMemberRoleType(e.getSpaceID(),e.getMemberID(),w)});return b.getJqUi()},R=function(c,b,A){W.getFacadeInstance(function(g){A&&A(g)},function(g,w){if(23771002==g)return g=e.getMemberType()==pa.USER?m.get("noSpacePermAfterRemoveUser",
"\u79fb\u9664\u8be5\u4eba\u5458\u540e\uff0c\u60a8\u5c06\u4e0d\u518d\u662f\u534f\u4f5c\u6210\u5458\u3002\u7531\u4e8e\u60a8\u4e0d\u80fd\u79fb\u9664\u81ea\u5df1\uff0c\u6240\u4ee5\u79fb\u9664\u5931\u8d25\u3002"):m.get("noSpacePermAfterRemoveRole","\u79fb\u9664\u8be5\u89d2\u8272\u540e\uff0c\u60a8\u5c06\u4e0d\u518d\u662f\u534f\u4f5c\u6210\u5458\u3002\u7531\u4e8e\u60a8\u4e0d\u80fd\u79fb\u9664\u81ea\u5df1\uff0c\u6240\u4ee5\u79fb\u9664\u5931\u8d25\u3002"),B.showPrompt(g),!0}).deleteCollaborationMembers([c],
b,c.getSpaceID())}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.collaboration&&(com.kingdee.bos.qing.collaboration={});"undefined"==typeof com.kingdee.bos.qing.collaboration.ui&&(com.kingdee.bos.qing.collaboration.ui={});var fa=com.kingdee.bos.qing.collaboration.ui;fa.CollaborationSpaceResultPane=
p;fa.CollaborationSpaceManageDialog=C;var I,a,D,y,f,L,u,E,J,ra,ia,T,aa,m,la,oa,ba,na,ta,W,Y,ya,ka,Ea,pa,xa;(function(){var e=com.kingdee.bos.qing.ui.component;I=e.List;a=e.SearchBox;y=e.AbstractModalDialog;f=e.Label;L=e.TextField;u=e.TextArea;J=e.TabContainer;ra=e.ComboBox;aa=e.MessageDialog;e=com.kingdee.bos.qing.framework.common;m=e.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.collaboration);la=e.AbstractFacade;e=com.kingdee.bos.qing.collaboration.common;W=e.SpaceHelper;E=e.Icons;
e=com.kingdee.bos.qing.collaboration.model;Y=e.CollaborationSpaceModel;ya=e.CollaborationMemberModel;ka=e.CollaborationRoleType;Ea=e.AppType;pa=e.MemberType;xa=e.SpaceType;e=com.kingdee.bos.qing.biz.common;D=e.SortDropdownSelector;ia=e.RoleDialogSelector;T=e.UserDialogSelector;na=e.ValueTextPair;ta=e.StringUtil;e=com.kingdee.bos.qing.common;oa=e.DomUtil;e=com.kingdee.bos.qing.common.ui;ba=e.CommonIconUtil})();p.MAX_HEIGHT=500;p.SPACE_ITEM_HEIGHT=34;var Fa=function(e,v,h){var d=aa.createFeedbackDialog();
d.setExtendPainter(function(l,n){var F=$("<div>");F.addClass("qing-space-member-delete-tips");F.text(n);F.attr("title",n);F.appendTo(l);l.css("top","95px")});d.setOptionType(aa.OPTION_OK_CANCEL);d.setMsgImageType(aa.MSG_DELETE);d.setMessage(e);d.setClosingChecker(function(l){l==aa.RETURN_OK?v&&v():h&&h();return!0});d.showDialog()},Ga=function(e,v,h){var d="";if(!v||0==v.length)return d;if(h&&0<h.length){var l=e==pa.USER?m.get("user","\u7528\u6237"):m.get("role","\u89d2\u8272");d+=m.get("addMemberSuccess",
"\u5df2\u6210\u529f\u6dfb\u52a0\u201c#1\u201d\u7b49#2\u4e2a#3\u3002").replace("#1",h[0]).replace("#2",h.length).replace("#3",l)}1==v.length?(d=e==pa.USER?d+m.get("removeUserConfirm","\u786e\u5b9a\u79fb\u9664\u201c#1\u201d\u5417\uff1f\u79fb\u9664\u540e\uff0c\u8be5\u7528\u6237\u9501\u5b9a\u7684\u6570\u636e\u5185\u5bb9\u5c06\u81ea\u52a8\u89e3\u9664\u9501\u5b9a\u3002"):d+m.get("removeRoleConfirm","\u786e\u5b9a\u79fb\u9664\u201c#1\u201d\u5417\uff1f\u79fb\u9664\u540e\uff0c\u5c5e\u4e8e\u8be5\u89d2\u8272\u7684\u7528\u6237\u9501\u5b9a\u7684\u6570\u636e\u5185\u5bb9\u5c06\u81ea\u52a8\u89e3\u9664\u9501\u5b9a\u3002"),
d=d.replace("#1",v[0].getMemberName())):(d=e==pa.USER?d+m.get("removeUsersConfirm","\u786e\u5b9a\u79fb\u9664\u201c#1\u201d\u7b49#2\u4e2a\u7528\u6237\u5417\uff1f\u79fb\u9664\u540e\uff0c\u8fd9\u4e9b\u7528\u6237\u9501\u5b9a\u7684\u6570\u636e\u5185\u5bb9\u5c06\u81ea\u52a8\u89e3\u9664\u9501\u5b9a\u3002"):d+m.get("removeRolesConfirm","\u786e\u5b9a\u79fb\u9664\u201c#1\u201d\u7b49#2\u4e2a\u89d2\u8272\u5417\uff1f\u79fb\u9664\u540e\uff0c\u5c5e\u4e8e\u8fd9\u4e9b\u89d2\u8272\u7684\u7528\u6237\u9501\u5b9a\u7684\u6570\u636e\u5185\u5bb9\u5c06\u81ea\u52a8\u89e3\u9664\u9501\u5b9a\u3002"),
d=d.replace("#1",v[0].getMemberName()).replace("#2",v.length));return d}})();
//qingVersionTag: 20250324