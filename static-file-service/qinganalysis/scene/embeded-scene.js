(function(){function I(){da.call(this);var r=this,t=this.protectedMethod,N,S,Z,R,ea;this.setCurrentPublishSchema=function(a){ea=a};this.setUserOperatorPrevCheck=function(a){Z=a};this.setCloseResourceLock=function(a){};this.protectedHaveToCarryData=function(){return!1};this.protectedNeedToShowMessageBox=function(){return!0};this.protectedGetRemoteUrl=function(){var a=t.getUrlParamUtil().getParamPathPrefix();return(a?a:"/ierp")+"/qing/core.do"};this.protectedImportMoreCode=function(a){a.pushSkinJs("scene",
"skin");a.pushI18n("scene","scene")};this.protectedCustomInitEnv=function(a){a=$("<div>");a.css({position:"fixed",bottom:"3px",right:"1px",width:"180px",height:"18px",zIndex:"999"});ha(a);r.protectedNeedToShowMessageBox()&&ia(a);a.appendTo($(document.body));com.kingdee.bos.qing.integration.ImglibUrlParser.hookUrlParser()};var ha=function(a){n.setCallback(function(){var b=new com.kingdee.bos.qing.support.Main;b.setParamLanguage(t.getUrlParamUtil().getParamLanguage());b.creatSupportUi(a)});n.loadCss("support/support.css");
n.loadJs("support/support-ui.js");n.loadI18n("support","support")},ia=function(a){n.setCallback(function(){var b=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");b=b?b:"/ierp";com.kingdee.bos.qing.message.common.Integration.setRemoteUrl(b+"/qing/messageManage.do");la(b);var e=new com.kingdee.bos.qing.message.ui.Main;e.setFunOpenMessageDialog(function(){e.setViewSize(null,null,10,30)});e.setMessageWidth(80);e.getJqUi(25).appendTo(a)});n.loadSkinCss("message","message");
n.loadSkinJs("message","skin");n.loadJs("message/message-manage-ui.js");n.loadI18n("message","message")},la=function(a){var b=com.kingdee.bos.qing.message.common.Integration;b.setImportJSCodeForManager(function(){var f=com.kingdee.bos.qing.CodeLoader;f.setCallback(function(){var l=com.kingdee.bos.qing.theme.message.panel.common.Integration;l.setFunPublishRemoteImpl(function(){var d=new com.kingdee.bos.qing.theme.message.panel.common.RemoteImpl;d.setRemoteUrl(a+"/qing/publishTo.do");return d});l.setFunQingCenterAndMenuEntrance(function(d,
c,h,p){c=G.getUrlParamValue();var g=a+"/qing/publishEntrance.do";g=k.appendParamToUrl(g,"publishId",d);"extreport"==p?(g=k.appendParamToUrl(g,"appID","qing_rpt"),c&&(g=k.appendParamToUrl(g,"skin",c)),E.openNewTabInAppId(h,g,g,E.QING_RPT)):(c&&(g=k.appendParamToUrl(g,"skin",c)),E.openNewTabInAppId(h,g,g,E.QING_ANALYSIS))});l.setResourceRemoteUrl(a+"/qing/resource.do");l.setDataModelEntrance(function(d,c,h){var p=G.getUrlParamValue();c=A.get("dataModeling","\u6570\u636e\u51c6\u5907")+"-"+c;var g=a+
"/qing/dataModelingEntrance.do";g=k.appendParamToUrl(g,"themeID",d);g=k.appendParamToUrl(g,"isPreset",h);p&&(g=k.appendParamToUrl(g,"skin",p));E.openNewTabInAppId(c,g,g,E.QING_ANALYSIS)});l.setFunPublishContext(function(){var d=new com.kingdee.bos.qing.publish.common.PublishContext;d.setParamPathPrefix(a);d.setLappEntranceUrl(a+"/qing/lappEntrance.do");d.setSpaceID(H.getUrlParamValue("qingID"));return d});l.setFunPublishedEmailLoginViewUrl(function(){var d=G.getUrlParamValue(),c=H.getUrlParamValue("language"),
h=a+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";d&&(h=k.appendParamToUrl(h,"skin",d));c&&(h=k.appendParamToUrl(h,"language",c));return h});l.setFunPublishedEmailAnonymousViewUrl(function(){var d=G.getUrlParamValue(),c=H.getUrlParamValue("language"),h=a+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";d&&(h=k.appendParamToUrl(h,"skin",d));c&&(h=k.appendParamToUrl(h,
"language",c));return h});l.setFunPublishContentEditEntrance(function(){return function(d,c,h){var p=com.kingdee.bos.qing.publish.model.PublishTargetType;if(h&&p.MOBILE==h){p=d.getPublishId();var g=d.getId()}else p=d.getId();var m=G.getUrlParamValue(),O=H.getUrlParamValue("language");h=a+"/qing/publishContentEditEntrance.do";h=k.appendParamToUrl(h,"skin",m);h=k.appendParamToUrl(h,"language",O);h=k.appendParamToUrl(h,"publishId",p);g&&(h=k.appendParamToUrl(h,"lappId",g));g=h;c&&(p="editPublishedContent-"+
p,m=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,m.putSubscribe(p,c),h=k.appendParamToUrl(h,"subscribeKey",p),h=k.appendParamToUrl(h,"currentPageClientId",m.getCurrentPageClientId()));c=com.kingdee.bos.qing.framework.common.TabbedUiUtil;c.openNewTabInAppId(A.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+d.getName(),h,g,c.QING_ANALYSIS)}});l.setFunTimedPushContentEditEntrance(function(){return function(d){var c=a+"/qing/timedPushContentEditEntrance.do",h=A.get("editTimedPushContent",
"\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(d instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var p=d.getId(),g=d.getPublishSourceType();m=d.getSchemaSourceType();c=k.appendParamToUrl(c,"configId",p);c=k.appendParamToUrl(c,"publishSourceType",g);c=k.appendParamToUrl(c,"schemaType",m);c=k.appendParamToUrl(c,"pushTarget","email");h=h+"-"+d.getNameRule().getName();d.isSourceNameNotFound()&&(c=k.appendParamToUrl(c,"errorCode","2301001"))}else{p=d.getId();g=d.getPushTargetType();var m=d.getSchemaType();
c=k.appendParamToUrl(c,"configId",p);c=k.appendParamToUrl(c,"pushTargetType",g);c=k.appendParamToUrl(c,"schemaType",m);c=k.appendParamToUrl(c,"pushTarget","lapp");h=h+"-"+d.getName();d.getSourceName()||(c=k.appendParamToUrl(c,"errorCode","2301001"))}d=G.getUrlParamValue();m=H.getUrlParamValue("language");d&&(c=k.appendParamToUrl(c,"skin",d));m&&(c=k.appendParamToUrl(c,"language",m));d=com.kingdee.bos.qing.framework.common.TabbedUiUtil;d.openNewTabInAppId(h,c,c,d.QING_ANALYSIS)}});l=com.kingdee.bos.qing.modeler.message.panel.common.Integration;
l.setMessageRemoteUrl(a+"/qing_modeler/message.do");l.setFunOpenModelSetPage(function(d,c){var h=G.getUrlParamValue(),p=A.get("modelSet","\u6a21\u578b\u96c6-")+c,g=a+"/qing_modeler/modelSetMainPage.do";g=k.appendParamToUrl(g,"modelSetId",d);g=k.appendParamToUrl(g,"modelSetName",c);g=k.appendParamToUrl(g,"currentPageClientId",com.kingdee.bos.qing.framework.common.RemoteFramework.getClientID());h&&(g=k.appendParamToUrl(g,"skin",h));E.openNewTabInAppId(p,g,g,E.QING_MODELER)});l.setFunOpenModelDesign(function(d,
c,h,p,g){var m=com.kingdee.bos.qing.modeler.message.panel.common.ModelType,O=G.getUrlParamValue();g=(g=m.getModelTypeText(g))?g+"-"+h:h;m=a+"/qing_modeler/deployDesignerEntrance.do";m=k.appendParamToUrl(m,"modelSetId",d);m=k.appendParamToUrl(m,"modelId",c);m=k.appendParamToUrl(m,"modelName",h);m=k.appendParamToUrl(m,"modelDeployId",p);O&&(m=k.appendParamToUrl(m,"skin",O));E.openNewTabInAppId(g,m,m,E.QING_MODELER)})});f.loadSkinCss("message","messagepanel");f.loadSkinJs("message","skin");f.loadJs("message/message-content-panel-management.js");
f.loadI18n("message","messagepanel");f.loadSkinCss("qingmodeler/message","message-modeler-panel");f.loadSkinJs("qingmodeler/message","skin");f.loadJs("qingmodeler/message/message-content-panel-management.js");f.loadI18n("qingmodeler/message","message-modeler-panel")});var e=k.decodeParamFromUrl(location.search,"appID");b.setAppId(e)},ja=function(a){a=new com.kingdee.bos.qing.publish.permission.PermLabelManageDialog(J());a.setSpaceID(H.getUrlParamValue("qingID"));a.showDialog()},q=function(a,b,e,f,
l,d){var c=com.kingdee.bos.qing.publish.model.PublishSourceType,h=com.kingdee.bos.qing.publish.model.PublishTargetType;a!=c.EXTREPORT&&a!=c.DASHBOARD&&b!=h.GUIMENU?(a=new com.kingdee.bos.qing.publish.common.PublishFacade(J(),function(p){d&&d()},function(p,g){return 2301016==p?(aa().showPrompt(A.get("publishNoOperAuthExceptionCurtain","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),!0):!1}),b=e.getBizTag(),c=e.getDsbPublishId(),e.getRefToId()&&(b=e.getRefToId()),a.judgePublishOper(b,c,f,l)):d&&
d()},w=function(){com.kingdee.bos.qing.timedpush.LappIntegration.syncDatacenterInfo(J())},y=function(){var a=t.getUrlParamUtil().getParamPathPrefix();com.kingdee.bos.qing.timedpush.LappIntegration.setLappPrivateUrl(a+"/qing/lappPrivateInfo.do")},z=function(a,b,e,f,l,d){var c=t.getUrlParamUtil().getParamPathPrefix(),h=com.kingdee.bos.qing.publish.common,p=h.PublishContext;h=com.kingdee.bos.qing.schemamanage.model;var g=h.SchemaAttrModel;h=h.SchemaModel;var m=t.getUrlParamUtil().getUrlParam("bizTag"),
O=r.protectedHaveToCarryData(),u;com.kingdee.bos.qing&&com.kingdee.bos.qing.prepare&&com.kingdee.bos.qing.prepare.DataSourceInfoContext&&(u=com.kingdee.bos.qing.prepare.DataSourceInfoContext.getCurrentDataSourceInfo());var P=u&&u.hasDirectModeTable();u=new p;u.setSource(l);u.setBizTag(m);u.setCurrentSourceType(b);u.setHaveToCarryData(O);u.setHasDirectModeTable(P);u.setParamPathPrefix(c);u.setSchemaTag("Dashboard-Analysis"==d?t.getUrlParamUtil().getUrlParam("schemaTag"):null);u.setSpaceID(H.getUrlParamValue("qingID"));
b=new g;b.setSchemaType(g.SCHEMATYPE_SYSTEM);b.setIsDefault(!0);b.setSchemaName(B("sysPublishScheme","\u7cfb\u7edf\u9ed8\u8ba4\u65b9\u6848"));b.setSource(e);l=new h;l.setSchemaAttr(b);l.setSchemaContent(a.getJsonModelBook());a=l.toJsonObject();u.setCurrentContentModel(a);a=t.getUrlParamUtil().getParamTag();b=function(K){K+="/qinganalysis/lappPreviewEntrance.do";for(var v=window.location.search.substring(1).split("&"),F=0;F<v.length;F++){var C=v[F],Q=C.indexOf("=");if(-1!=Q){var Y=C.substring(0,Q);
"clientID"!=Y&&"safetyCode"!=Y&&(C=C.substring(Q+1),K+=0>K.indexOf("?")?"?":"&",K+=Y,K+="=",K+=C)}}return K};e==g.SCHEMASOURCE_SQUARE?(u.setScene(p.Scene.Square),e=b(c),e=k.appendParamToUrl(e,"view","10"),u.setMobilePreviewUrl(e),c=k.appendParamToUrl(c+"/qing/lappEntrance.do","tag",a),c=k.appendParamToUrl(c,"view","10"),u.setLappEntranceUrl(c)):e==g.SCHEMASOURCE_LONGER&&(u.setScene(p.Scene.Longer),u.setMobilePreviewUrl(b(c)),c=k.appendParamToUrl(c+"/qing/lappEntrance.do","tag",a),u.setLappEntranceUrl(c));
f&&(u.setRefToId(t.getUrlParamUtil().getUrlParam("publishId")),u.setDsbPublishId(f),u.setDashBoardAnalysis(!0));return u},T=function(a){var b=!1;if(a&&(a=a.tables)&&0<a.length)for(var e=0;e<a.length;e++)if(a[e].subViews){b=!0;break}return b},D=function(a,b){Z?Z(function(e){var f=new com.kingdee.bos.qing.schemamanage.common.SchemaManageFacade(L(),function(d){d.publishInfoPerCheck==I.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST?a&&a(b):d.publishInfoPerCheck==I.THEME_IS_DEL?M($(document.body),"msg-warning",
A.get("ThemeIsDel","\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u6765\u6e90\u88ab\u5220\u9664")):d.publishInfoPerCheck==I.PUBLISHINFO_NOEXIST?M($(document.body),"msg-warning",A.get("publishInfoExist","\u53d1\u5e03\u8bb0\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")):d.publishInfoPerCheck==I.PERMISSION_CANCEL?M($(document.body),"msg-jurisdiction",A.get("notAuthority","\u60a8\u6ca1\u6709\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u67e5\u770b\u6743\u9650, \u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba")+'"'+d.publishInfoUserName+
'"'+A.get("authority","\u6388\u6743")):d.publishInfoPerCheck==I.PUBLSIHPLAN_DELETE&&M($(document.body),"msg-warning",A.get("publishPlanExist","\u8be5\u5206\u6790\u65b9\u6848\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"))}),l=new com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel;l.setFId(ea.getCurrentSchemaId());l.setSchemaName(ea.getCurrentSchemaName());f.checkPublishInfoAndAuthority(e,l)}):a&&a(b)},L=function(){var a=t.getUrlParamUtil().getParamPathPrefix(),b=t.getUrlParamUtil().getParamTag();
a=(a?a:"/ierp")+"/qing/schemaManage.do";var e=new com.kingdee.bos.qing.RemoteImpl;e.setRemoteUrl(a);e.setTag(b);return e},M=function(a,b,e){a=new U;a.setOptionType(U.OPTION_OK);a.setButtonText(U.RETURN_OK,A.get("ISee","\u6211\u77e5\u9053\u4e86"));var f={};f.text=e;f.iconName=b;a.setMessage(f);a.setCustomPainter(function(l,d){var c=$("<div>");c.addClass("sa-ctrl-msgdlg-icon");ba.background(c,d.iconName);var h=$("<div>");h.addClass("sa-ctrl-msgdlg-content");h.text(d.text);l.append(c);l.append(h)});
a.showDialog(380,280)},ka=function(a,b,e){N?b(N):(new com.kingdee.bos.qing.core.Facade(a,function(f){N=f;b(f)},e)).getMeta()},oa=function(a){N=null;ka(r.getRemoteImpl(),a)},J=function(){var a=t.getUrlParamUtil().getParamPathPrefix(),b=t.getUrlParamUtil().getParamTag();a=(a?a:"/ierp")+"/qing/publishTo.do";var e=new com.kingdee.bos.qing.RemoteImpl;e.setRemoteUrl(a);e.setTag(b);return e},pa=function(){var a=t.getUrlParamUtil().getParamPathPrefix(),b=G.getUrlParamValue(),e=t.getUrlParamUtil().getParamLanguage();
a=(a?a:"/ierp")+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";b&&(a=k.appendParamToUrl(a,"skin",b));e&&(a=k.appendParamToUrl(a,"language",e));return a},qa=function(){var a=t.getUrlParamUtil().getParamPathPrefix(),b=G.getUrlParamValue(),e=t.getUrlParamUtil().getParamLanguage();a=(a?a:"/ierp")+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";b&&(a=k.appendParamToUrl(a,
"skin",b));e&&(a=k.appendParamToUrl(a,"language",e));return a},fa=function(){return function(a,b,e){var f=com.kingdee.bos.qing.publish.model.PublishTargetType;if(e&&f.MOBILE==e){e=a.getPublishId();var l=a.getId();var d=a.getLappUserType()}else e=a.getId();f=t.getUrlParamUtil().getParamPathPrefix();var c=G.getUrlParamValue(),h=t.getUrlParamUtil().getParamLanguage();f=k.appendParamToUrl((f?f:"/ierp")+"/qing/publishContentEditEntrance.do","skin",c);f=k.appendParamToUrl(f,"language",h);f=k.appendParamToUrl(f,
"publishId",e);l&&(f=k.appendParamToUrl(f,"lappId",l));d&&(f=k.appendParamToUrl(f,"lappUserType",d));l=f;b&&(d="editPublishedContent-"+e,e=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,e.putSubscribe(d,b),f=k.appendParamToUrl(f,"subscribeKey",d),f=k.appendParamToUrl(f,"currentPageClientId",e.getCurrentPageClientId()));E.openNewTab(A.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+a.getName(),f,l)}},ma=function(){return function(a){var b=t.getUrlParamUtil().getParamPathPrefix();
b=(b?b:"/ierp")+"/qing/timedPushContentEditEntrance.do";var e=A.get("editTimedPushContent","\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(a instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var f=a.getId(),l=a.getPublishSourceType();d=a.getSchemaSourceType();b=k.appendParamToUrl(b,"configId",f);b=k.appendParamToUrl(b,"publishSourceType",l);b=k.appendParamToUrl(b,"schemaType",d);b=k.appendParamToUrl(b,"pushTarget","email");e=e+"-"+a.getNameRule().getName();a.isSourceNameNotFound()&&(b=k.appendParamToUrl(b,
"errorCode","2301001"))}else{f=a.getId();l=a.getPushTargetType();var d=a.getSchemaType();b=k.appendParamToUrl(b,"configId",f);b=k.appendParamToUrl(b,"pushTargetType",l);b=k.appendParamToUrl(b,"schemaType",d);b=k.appendParamToUrl(b,"pushTarget","lapp");e=e+"-"+a.getName();a.getSourceName()||(b=k.appendParamToUrl(b,"errorCode","2301001"))}a=G.getUrlParamValue();d=t.getUrlParamUtil().getParamLanguage();a&&(b=k.appendParamToUrl(b,"skin",a));d&&(b=k.appendParamToUrl(b,"language",d));E.openNewTab(e,b)}},
B=function(a,b){return A.get(a,b)},aa=function(){S||(S=new com.kingdee.bos.qing.ui.component.MessageCurtain,S.getJqUi().appendTo($(document.body)));return S};t.getMLS=B;t.importLinkage=function(a){a.pushSkinJs("linkage","skin");a.pushJs("linkage/linkage.js");a.pushSkinCss("linkage","linkage")};t.importForSchema=function(a){a.pushSkinJs("schema-manage","skin-initialize");a.pushJs("schema-manage/schema-manage-initialize.js");a.pushI18n("schema-manage","schema-initialize");a.pushSkinCss("schema-manage",
"schema-manage");a.pushJs("schema-manage/schema-manage-ui.js");a.pushI18n("schema-manage","schema-ui")};t.importForPublish=function(a){a.pushJs("biz-common/qing-biz-common.js");a.pushSkinCss("biz-common","biz-common");a.pushSkinJs("biz-common","skin");a.pushI18n("biz-common","biz-common");a.pushSkinJs("imagelib","skin");a.pushSkinCss("imagelib","qing-imagelib");a.pushJs("imagelib/imagelib.js");a.pushI18n("imagelib","imagelib");a.pushJs("common/qing-schedule.js");a.pushI18n("common","qing-schedule");
a.pushSkinCss("publish","qing-publish");a.pushSkinJs("publish","skin");a.pushI18n("publish","publish");a.pushJs("publish/qing-publish.js");a.pushSkinCss("timedpush","qing-timedpush");a.pushSkinJs("timedpush","skin");a.pushI18n("timedpush","timedpush");a.pushJs("timedpush/qing-timedpush.js");a.pushJs("lightapp/common/qing-lapp-env.js");a.pushJs("timedpush/qing-timedpush-lapp.js");a.pushJs("timedpush/html2canvas.js")};t.importForMap=function(a){a.pushSkinJs("map-designer","integration-skin");a.pushJs("map-designer/map-integration.js");
a.pushSkinCss("map-designer","map-integration");a.pushI18n("map-designer","map-integration")};t.hookLongerPublishTo=function(a,b,e,f,l,d){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(u,P,K){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(u,P,0,K)});b=com.kingdee.bos.qing.publish.model;var c=b.PublishTargetType;b=com.kingdee.bos.qing.schemamanage.model;var h=b.SchemaAttrModel,p=function(u){var P=com.kingdee.bos.qing.publish.common.PublishFactory,
K=u.getUserObject(),v=u.getText().replace("...",""),F=z(a,e,h.SCHEMASOURCE_LONGER,f,l,d);q(e,K,F,"longer",x.ANALYSIS_PUBLISH,function(){var C=P.createPublishToDialog(v,J(),F,K,fa());C.setOuterMessageCurtain(aa());C.showDialog()})},g=com.kingdee.bos.qing.ui.component.MenuItemModel;b=new com.kingdee.bos.qing.ui.component.MenuModel;var m=new g(function(u){D(p,u)});m.setUserObject(c.APPMENU);m.setText(B("toAppMenu","\u5e94\u7528\u83dc\u5355..."));b.addItemModel(m);m=new g(function(u){D(p,u)});m.setUserObject(c.CENTER);
m.setText(B("toAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939..."));b.addItemModel(m);m=new g(function(u){D(p,u)});m.setUserObject(c.MOBILE);m.setText(B("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));b.addItemModel(m);w();y();b.addSeperator();var O=function(){var u=com.kingdee.bos.qing.publish.common.PublishManagerDialog,P=z(a,e,com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_LONGER);(new u(J(),P,fa())).showDialog()};m=new g(function(u){D(O,u)});m.setUserObject();
m.setText(B("publishManager","\u53d1\u5e03\u7ba1\u7406")+"...");b.addItemModel(m);c=new g(ja);c.setUserObject();c.setText(B("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");b.addItemModel(c);c=B("publishTo","\u53d1\u5e03\u5230");return a.getConductor().appendToolbarMenu(b,"publish_to",c)};t.hookSquarePublishTo=function(a,b,e){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(p,g,m){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(p,g,
0,m)});b=com.kingdee.bos.qing.publish.model;var f=b.PublishTargetType;b=com.kingdee.bos.qing.schemamanage.model;var l=b.SchemaAttrModel,d=function(p){var g=com.kingdee.bos.qing.publish.common.PublishFactory,m=p.getUserObject(),O=p.getText().replace("...",""),u=z(a,e,l.SCHEMASOURCE_SQUARE);q(e,m,u,"square",x.CARD_PUBLISH,function(){var P=g.createPublishToDialog(O,J(),u,m,fa());P.setOuterMessageCurtain(aa());P.showDialog()})},c=com.kingdee.bos.qing.ui.component.MenuItemModel;b=new com.kingdee.bos.qing.ui.component.MenuModel;
var h=new c(d);h.setUserObject(f.CARD_REPOSITORY);h.setText(B("toCardRepository","\u5361\u7247\u5e93..."));b.addItemModel(h);d=new c(d);d.setText(B("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));d.setUserObject(f.MOBILE);b.addItemModel(d);w();y();b.addSeperator();f=new c(function(){var p=com.kingdee.bos.qing.publish.common.PublishManagerDialog,g=z(a,e,com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_SQUARE);(new p(J(),g,fa())).showDialog()});f.setUserObject();f.setText(B("publishManager",
"\u53d1\u5e03\u7ba1\u7406")+"...");b.addItemModel(f);f=new c(ja);f.setUserObject();f.setText(B("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");b.addItemModel(f);f=B("publishTo","\u53d1\u5e03\u5230");return a.getConductor().appendToolbarMenu(b,"publish_to",f)};t.hookPublishManager=function(a,b,e){var f=B("publishManager","\u53d1\u5e03\u7ba1\u7406");return a.getConductor().appendToolbarButton(function(){var l=com.kingdee.bos.qing.publish.common.PublishManagerDialog,d=z(a,b,e);(new l(J(),
d,fa())).showDialog()},"publish_manager",f)};t.hookCloseTab=function(a){var b=B("closeTab","\u9000\u51fa");return a.getConductor().appendToolbarButton(function(){a.getConductor().isDirty()?ca.showConfirmExitDialog():E.closeCurrentTab()},"error_close",b)};t.hookShareTo=function(a,b,e,f,l){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(v,F,C){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(v,F,0,C)});var d=function(v){v=B("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a...").replace("...",
"");var F=z(a,f,b);v=com.kingdee.bos.qing.timedpush.PublishToYunzhijiaDialogFactory.createDialog(v,J(),F);v.setOuterMessageCurtain(aa());v.showDialog()},c=function(v){v=com.kingdee.bos.qing.CodeLoader.createSafety();v.pushJs("yzj-web/qingjs.js");v.pushJs("yzj-web/imcloud.js");v.pushJs("yzj-web/imsdkerp.js");v.pushJs("yzj-web/imShare.js");v.pushSkinCss("yzj-web","imcloud");v.pushSkinCss("yzj-web","imsdk");v.pushSkinCss("yzj-web","imsdkerp");v.load(function(){})};e=new V;(new W(function(v){window.beLoadedImCloud?
d(v):c(v)})).setText(B("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a..."));var h=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel,p=r.protectedHaveToCarryData(),g;com.kingdee.bos.qing&&com.kingdee.bos.qing.prepare&&com.kingdee.bos.qing.prepare.DataSourceInfoContext&&(g=com.kingdee.bos.qing.prepare.DataSourceInfoContext.getCurrentDataSourceInfo());g=g&&g.hasDirectModeTable();var m=com.kingdee.bos.qing.publish.model.PublishTargetType;if(!g&&!p&&b==h.SCHEMASOURCE_LONGER){var O=function(v){var F=
v.getText().replace("...",""),C=z(a,f,b,l);q(f,m.EMAIL,C,"longer",x.ANALYSIS_TIMEPUSH,function(){var Q=new com.kingdee.bos.qing.timedpush.EmailPublishConfigDialog(F,J(),C,pa(),qa(),ma(),a);Q.setOuterMessageCurtain(aa());Q.showDialog()})},u=new W(function(v){D(O,v)});u.setText(B("emailSchedulePush","\u90ae\u4ef6\u5b9a\u65f6\u63a8\u9001..."));e.addItemModel(u)}if(!g&&!p){var P=function(v){var F=z(a,f,b,l),C="longer",Q=x.ANALYSIS_TIMEPUSH;b==h.SCHEMASOURCE_SQUARE&&(C="square",Q=x.CARD_TIMEPUSH);q(f,
m.EMAIL,F,C,Q,function(){var Y=new com.kingdee.bos.qing.timedpush.LappSchedulePush,na=v.getText().replace("...","");Y.createDialog(na,J(),F,ma(),a)})};p=new W(function(v){D(P,v)});p.setText(B("mobileSchedulePush","\u79fb\u52a8\u7aef\u5b9a\u65f6\u63a8\u9001")+"...");e.addItemModel(p)}e.addSeperator();var K=function(){var v=com.kingdee.bos.qing.publish.common.PushManager,F=z(a,f,b);v=new v(ma());var C=com.kingdee.bos.qing.timedpush;v.registerEmailPushPanelConstructor(C.EmailConfigManagePanel);v.initEmailPushConfig(J(),
pa(),qa());v.registerLappPushPanelConstructor(C.LappPushManagePanel);v.initLappPushConfig(function(Q,Y,na){return com.kingdee.bos.qing.publish.common.PublishFactory.createPublishFacade(com.kingdee.bos.qing.publish.model.PublishTargetType.MOBILE,J(),Q,Y,na)},F);v.showDialog()};p=new W(function(v){D(K,v)});p.setUserObject();p.setText(B("pushManager","\u5b9a\u65f6\u63a8\u9001\u7ba1\u7406")+"...");e.addItemModel(p);e=a.getConductor().appendToolbarMenu(e,"btn_communicate",B("timedPush","\u5b9a\u65f6\u63a8\u9001"));
e.addActionListener(function(){window.beLoadedImCloud||(window.funCallback=d)});return e};t.initDesigntimeLinkage=function(){var a=t.getUrlParamUtil().getParamPathPrefix(),b=(a?a:"/ierp")+"/qing/linkage.do",e=com.kingdee.bos.qing.integration.LinkageJumper;a=new com.kingdee.bos.qing.linkage.LinkageManage;a.initDesigntime(b,e.jump);b=t.getUrlParamUtil().getParamTag();a.setCurrentLinkageTag(b)};t.loadMeta=ka;t.reloadMeta=oa;t.hookRefresh=function(a,b){var e=t.getMLS("refresh","\u6570\u636e\u66f4\u65b0"),
f=function(){b.restart();b.setExtractDataFinishedSuccessCallback(function(l){l||T(N)?oa(function(d){var c=a.getJsonModelBook();a.prepareMeta(d);a.setJsonModelBook(c)}):a.reExecute()})};return a.getConductor().appendToolbarButton(function(){D(f)},"btn_reset",e)};t.getMessageCurtain=aa;t.hookSetCurrentTabStatus=function(a){a.getConductor().setDirtyListener(function(b){ca.setTabStatus(b)})};t.loadPublishOperList=function(a,b,e,f,l){R?e(R):(new com.kingdee.bos.qing.publish.common.PublishFacade(J(),function(d){R=
d;e(R)},l)).loadPublishOperList(a,b,f)};t.loadPublishOperModel=function(a,b,e,f){R?e(R):(new com.kingdee.bos.qing.publish.common.PublishFacade(J(),function(l){R=l.noOperValueMap;e(R)},f)).loadPublishOperModel(a,b)};t.registMapMapLibrary=function(a){com.kingdee.bos.qing.map.common.Integration.setRemoteUrl(a+"/qing/mapManage.do");var b=new com.kingdee.bos.qing.map.integration.MapSelectorDialog;com.kingdee.bos.qing.core.MapLibraryRegister.registerTemplateSelector(function(e,f){b.setParamPathPrefix(a);
b.showDialog(e,f)})}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});"undefined"==typeof com.kingdee.bos.qing.scene.common&&(com.kingdee.bos.qing.scene.common={});"undefined"==typeof com.kingdee.bos.qing.scene.common.designer&&(com.kingdee.bos.qing.scene.common.designer=
{});var X=com.kingdee.bos.qing.scene.common.designer,G,da,n,U,ba,k,A,E,V,W,ca,H;(function(){var r=com.kingdee.bos.qing;G=r.SkinUtil;da=r.AbstractDesignerScene;n=r.CodeLoader;H=r.Seer;r=com.kingdee.bos.qing.common;k=r.Util;r=com.kingdee.bos.qing.framework.common;A=r.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.scene);E=r.TabbedUiUtil;r=com.kingdee.bos.qing.ui.component;V=r.MenuModel;W=r.MenuItemModel;U=r.MessageDialog;ba=r.Icons;r=com.kingdee.bos.qing.integration;ca=r.TabStatusHelper})();
X.AbstractDesignerSceneImpl=I;X.LongerDesignerOperationJudgerModel=function(r){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);r&&0!=r&&(this.protectedParseDesignable=function(){return 0==(r&x.ANALYSIS_EDITABLE)},this.protectedParseDataDetailReadable=function(){return 0==(r&x.ANALYSIS_DETAIL)},this.protectedParseExportable=function(){return 0==(r&x.ANALYSIS_EXPORT)},this.protectedParsePrintable=function(){return 0==(r&x.ANALYSIS_PRINT)},this.protectedParsePublishable=function(){return 0==
(r&x.ANALYSIS_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(r&x.ANALYSIS_TIMEPUSH)})};X.SquareDesignerOperationJudgerModel=function(r){com.kingdee.bos.qing.core.SquareDesignerOperationJudger.call(this);r&&0!=r&&(this.protectedParsePublishable=function(){return 0==(r&x.CARD_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(r&x.CARD_TIMEPUSH)})};X.LongerDesignerOperationJudger=function(){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);var r=this;
this.protectedParseDesignable=function(){return r.isDesignable()};this.protectedParseDataDetailReadable=function(){return r.isDataDetailReadable()};this.protectedParseExportable=function(){return r.isExportable()};this.protectedParsePrintable=function(){return r.isPrintable()};this.protectedParsePublishable=function(){return r.isPublishable()};this.protectedParseTimingPushable=function(){return r.isTimingPushable()}};var x={};X.OperCodeType=x;x.ANALYSIS_EDITABLE=2;x.ANALYSIS_EXPORT=4;x.ANALYSIS_PRINT=
8;x.ANALYSIS_PUBLISH=16;x.ANALYSIS_TIMEPUSH=32;x.ANALYSIS_DETAIL=64;x.CARD_PUBLISH=256;x.CARD_TIMEPUSH=512;x.ENTRY_ANALYSIS=1;x.ENTRY_SQUARE=128;I.THEME_IS_DEL="Theme is Delete";I.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST="success";I.PUBLISHINFO_NOEXIST="PublishInfo Not Exist";I.PERMISSION_CANCEL="Not Permission";I.PUBLSIHPLAN_DELETE="Publish Not Exist"})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});com.kingdee.bos.qing.scene.EmbededScene=function(){G.call(this);var n=this.protectedMethod,U,ba,k,A,E,V,W,ca=!1,H,x,r,t,N,S,Z,R=this.protectedImportMoreCode;this.protectedImportMoreCode=function(q){R(q);
n.importLinkage(q);n.importForSchema(q);n.importForPublish(q);n.importForMap(q);q.pushJs("qhf/qing-qhf.js")};var ea=this.protectedCustomInitEnv;this.protectedCustomInitEnv=function(q){var w=com.kingdee.bos.qing.prepare.DataExtractor;QingFacade.reExtractData=function(){ia(w)};n.setModuleWithLonger(!0,!0);n.setModuleWithSquare(!0,!1);ea(q);X.setFullScreenPadding(0,45,0,0);var y=la();U=n.getUrlParamUtil().getUrlParam("bizTag");ba=n.getUrlParamUtil().getUrlParam("schemaAdditionalTag");k=n.getUrlParamUtil().getUrlParam("formType");
A=n.getUrlParamUtil().getUrlParam("ctrKey");E=n.getUrlParamUtil().getUrlParam("tag");V=new I;V.setRemoteUrl(y+"/qing/schemaManage.do");V.setTag(n.getUrlParamUtil().getParamTag());W=new I;W.setRemoteUrl(y+"/qing/prepare.do");W.setTag(n.getUrlParamUtil().getParamTag());n.registMapMapLibrary(y);y=com.kingdee.bos.qing.behavior.BehaviorManager;y.interestInBehaviorEntrance(A?y.ENTRANCE_EMBEDDED_CTRL:y.ENTRANCE_EMBEDDED_VIEW);ja();Z=new da(null);q()};this.protectedInitDesignerForLonger=function(q){q.setDesignerOperationJudger(Z,
null);var w=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_LONGER,y=com.kingdee.bos.qing.publish.model.PublishSourceType,z=n.hookLongerPublishTo(q,r,y.BILL),T=n.hookShareTo(q,w,null,y.BILL);ha(q);n.hookCloseTab(q);n.hookSetCurrentTabStatus(q);w=function(D){T.setEnabled(D);z.setEnabled(D)};w(!1);q.setExhibitionContentChangedListener(w)};this.protectedInitDesignerForSquare=function(q){var w=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_SQUARE,y=com.kingdee.bos.qing.publish.model.PublishSourceType,
z=n.hookSquarePublishTo(q,t,y.BILL),T=n.hookShareTo(q,w,null,y.BILL,!1);ha(q);n.hookCloseTab(q);n.hookSetCurrentTabStatus(q);w=function(D){T.setEnabled(D);z.setEnabled(D)};w(!1);q.setExhibitionContentChangedListener(w);n.initDesigntimeLinkage()};var ha=function(q){var w=n.getMLS("refresh","\u6570\u636e\u66f4\u65b0"),y=com.kingdee.bos.qing.prepare.DataExtractor;return q.getConductor().appendToolbarButton(function(){ia(y)},"btn_reset",w)},ia=function(q){q||(q=com.kingdee.bos.qing.prepare.DataExtractor);
q.restart();q.setExtractDataFinishedSuccessCallback(function(w){w?n.reloadMeta(function(y){if(H){var z=H.getJsonModelBook();H.prepareMeta(y);H.setJsonModelBook(z)}x&&(z=x.getJsonModelBook(),x.prepareMeta(y),x.setJsonModelBook(z));(y=n.getCurrentVisibleDesigner())&&y.reExecute()}):(w=n.getCurrentVisibleDesigner())&&w.reExecute()})};this.protectedLoadingLonger=function(q,w,y){H=w;n.loadMeta(q,function(z){var T=com.kingdee.bos.qing.schemamanage.SchemaManage,D=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel;
w.prepareMeta(z);var L=new T(U,D.SCHEMASOURCE_LONGER,ba);L.setReloadMetaFun(function(M){n.reloadMeta(function(ka){w.prepareMeta(ka);M&&M()})});L.setIsBill(!0);A?L.initializeTemplate(V,w,function(M){N||(N=w.getJsonModelBook());y(M);M&&L.getSchemaContext().getCurrentSchemaType()==D.SCHEMATYPE_TEMPLATE&&L.getSchemaContext().setCurrentSchemaName(n.getMLS("customTemplateSchema","\u7528\u6237\u5b9a\u5236\u65b9\u6848"))},null,E,k,A):L.initialize(V,w,function(M){N||(N=w.getJsonModelBook());y(M)});r=L.getSchemaContext()})};
this.protectedLoadingSquare=function(q,w,y){x=w;n.loadMeta(q,function(z){var T=com.kingdee.bos.qing.schemamanage.SchemaManage,D=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel;w.prepareMeta(z);z=new T(U,D.SCHEMASOURCE_SQUARE,ba);z.setReloadMetaFun(function(L){n.reloadMeta(function(M){w.prepareMeta(M);L&&L()})});z.setIsBill(!0);z.initialize(V,w,function(L){S||(S=w.getJsonModelBook());y(L)});t=z.getSchemaContext()})};this.protectedIntoTab=function(q,w){ca&&!w&&(q&&q.reExecute(),ca=!1)};var la=
function(){var q=n.getUrlParamUtil().getParamPathPrefix();return q?q:"/ierp"},ja=function(){com.kingdee.bos.qing.qhf.QHFSceneExporterRegister.register(E,function(){var q=com.kingdee.bos.qing.qhf.QHFExporter.SCENE_TYPE_EMBEDDED_LONGER_SQUARE,w=H?H.getJsonModelBook():null,y=x?x.getJsonModelBook():null;return{bizTag:U,longerInitSchemaContext:N?JSON.stringify(N):null,squareInitSchemaContext:S?JSON.stringify(S):null,longerFinalSchemaContext:w?JSON.stringify(w):null,squareFinalSchemaContext:y?JSON.stringify(y):
null,formType:k,ctrlKey:A,sceneType:q}})}};var I,X,G,da;(function(){var n=com.kingdee.bos.qing;I=n.RemoteImpl;n=com.kingdee.bos.qing.ui.component;X=n.Dialog;n=com.kingdee.bos.qing.scene.common.designer;G=n.AbstractDesignerSceneImpl;da=n.LongerDesignerOperationJudgerModel})()})();
//qingVersionTag: 20250324