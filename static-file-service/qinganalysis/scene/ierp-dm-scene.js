var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(h){var v=0;return function(){return v<h.length?{done:!1,value:h[v++]}:{done:!0}}};$jscomp.arrayIterator=function(h){return{next:$jscomp.arrayIteratorImpl(h)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,v,L){if(h==Array.prototype||h==Object.prototype)return h;h[v]=L.value;return h};$jscomp.getGlobal=function(h){h=["object"==typeof globalThis&&globalThis,h,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var v=0;v<h.length;++v){var L=h[v];if(L&&L.Math==Math)return L}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(h,v){var L=$jscomp.propertyToPolyfillSymbol[v];if(null==L)return h[v];L=h[L];return void 0!==L?L:h[v]};
$jscomp.polyfill=function(h,v,L,W){v&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(h,v,L,W):$jscomp.polyfillUnisolated(h,v,L,W))};$jscomp.polyfillUnisolated=function(h,v,L,W){L=$jscomp.global;h=h.split(".");for(W=0;W<h.length-1;W++){var T=h[W];if(!(T in L))return;L=L[T]}h=h[h.length-1];W=L[h];v=v(W);v!=W&&null!=v&&$jscomp.defineProperty(L,h,{configurable:!0,writable:!0,value:v})};
$jscomp.polyfillIsolated=function(h,v,L,W){var T=h.split(".");h=1===T.length;W=T[0];W=!h&&W in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var fa=0;fa<T.length-1;fa++){var pa=T[fa];if(!(pa in W))return;W=W[pa]}T=T[T.length-1];L=$jscomp.IS_SYMBOL_NATIVE&&"es6"===L?W[T]:null;v=v(L);null!=v&&(h?$jscomp.defineProperty($jscomp.polyfills,T,{configurable:!0,writable:!0,value:v}):v!==L&&(void 0===$jscomp.propertyToPolyfillSymbol[T]&&(L=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[T]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(T):$jscomp.POLYFILL_PREFIX+L+"$"+T),$jscomp.defineProperty(W,$jscomp.propertyToPolyfillSymbol[T],{configurable:!0,writable:!0,value:v})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(h){if(h)return h;var v=function(fa,pa){this.$jscomp$symbol$id_=fa;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:pa})};v.prototype.toString=function(){return this.$jscomp$symbol$id_};var L="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",W=0,T=function(fa){if(this instanceof T)throw new TypeError("Symbol is not a constructor");return new v(L+(fa||"")+"_"+W++,fa)};return T},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(h){if(h)return h;h=Symbol("Symbol.iterator");for(var v="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),L=0;L<v.length;L++){var W=$jscomp.global[v[L]];"function"===typeof W&&"function"!=typeof W.prototype[h]&&$jscomp.defineProperty(W.prototype,h,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return h},"es6",
"es3");$jscomp.iteratorPrototype=function(h){h={next:h};h[Symbol.iterator]=function(){return this};return h};$jscomp.iteratorFromArray=function(h,v){h instanceof String&&(h+="");var L=0,W=!1,T={next:function(){if(!W&&L<h.length){var fa=L++;return{value:v(fa,h[fa]),done:!1}}W=!0;return{done:!0,value:void 0}}};T[Symbol.iterator]=function(){return T};return T};
$jscomp.polyfill("Array.prototype.keys",function(h){return h?h:function(){return $jscomp.iteratorFromArray(this,function(v){return v})}},"es6","es3");$jscomp.findInternal=function(h,v,L){h instanceof String&&(h=String(h));for(var W=h.length,T=0;T<W;T++){var fa=h[T];if(v.call(L,fa,T,h))return{i:T,v:fa}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(h){return h?h:function(v,L){return $jscomp.findInternal(this,v,L).v}},"es6","es3");
(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var h=com.kingdee.bos.qing.scene;h.SubjectModelingFacade=function(X,ma,ja,da){L.call(this,X,ma,ja,da);var O=this.protectedMethod;this.loadModel=function(aa){O.remote("loadModel",{themeID:aa})};this.saveModel=
function(aa,H){aa={model:JSON.stringify(H),themeID:aa};O.remote("saveModel",aa)}};var v,L,W,T,fa,pa;(function(){var X=com.kingdee.bos.qing;v=X.CodeLoader;X=com.kingdee.bos.qing.framework.common;L=X.AbstractFacade;W=X.IconsFile;T=X.MultilanguageManager.createPackageAccessor(h);X=com.kingdee.bos.qing.data;fa=X.Icons;pa=X.BizSourceTypeContext})();h.DataModellingContext=new function(){function X(){var U=v.getSkinName(),ba=new W;ba.setFilePath("scene/skin/"+U+"/res/dm-impl.png");ba.setStartPosition(1,
1);ba.setIconSize(16,16);U=ba.createDescription(0,2);fa.regist("f7",U)}var ma=[],ja={},da=[],O={},aa={},H=[],G=[],z,m={};this.addSourceType=function(U){ma.push(U)};var ha=function(){for(var U=0;U<ma.length;U++){var ba=ma[U];ba&&ba(ea)}},ea=function(U,ba,sa,ka,ta,y,N){da.push(U);G.push(ba);U=U.getName();O[U]=sa;aa[U]=y;ka&&(ja[U]=ka);ta&&H.push(ta);N&&(m[U]=N)};this.init=function(U){ha();z=U;for(var ba=0;ba<G.length;ba++)(U=G[ba])&&U();X();U=pa;U.setTitle(T.get("ERPCloudEntity","\u91d1\u8776\u4e91\u82cd\u7a79"));
U.setPermissionChecker(na);U.setSourceTypes(da);var sa=Object.keys(aa);for(ba=0;ba<sa.length;ba++){var ka=sa[ba],ta=aa[ka];U.addSourceFilterUIRender(ka,ta)}U.setStepProvider(function(y,N,r,q,J,f){var a=y.getExistSource();y=y.getName();var g=O[y];return g?g(z,y,a,N,r,q,J,f):[]});U.setMutexChecker(function(y,N,r){N=N.getName();for(var q=0;q<H.length;q++)if((0,H[q])(y,N,r))return!0;return!1});U.addSourceFilterUIRender(ka,ta);ta=Object.keys(m);for(ba=0;ba<ta.length;ba++)ka=ta[ba],U.addSourceModifyingEditor(ka,
m[ka])};var na=function(U,ba,sa,ka){(U=ja[U])?U(z,ba,sa,ka):sa()}}})();(function(){function h(){O.call(this);var z=this;this.getShortDisplay=function(){return X.get("bussinessEntity","\u4e1a\u52a1\u5b9e\u4f53")};this.protectedIsTheSame=function(m){return!0};this.isModifiable=function(){return!1};this.fissionFor=function(m){m=new h;m.setTypeName(z.getTypeName());return m};this.getMergeType=function(){return aa.BIZ_MERGE};this.supportMergeTable=function(){return!0};this.protectedToJsonObject=function(m){};this.protectedFromJsonObject=function(m){};this.isSupportFlexModel=
function(){return!0};this.getEntityIconName=function(m){return"entity"};this.isShowEntityMark=function(){return!0}}function v(){ma.call(this);this.getSubTitle=function(){return X.get("selectEntity","\u9009\u62e9\u5b9e\u4f53")};this.isScannable=function(){return!0}}function L(z,m,ha,ea,na){ha||(ha=new h,ha.setName("s"+(new Date).getTime()),ha.setTypeName(m));z=new v;z.setSource(ha);m=new ja;m.setSource(ha);return[z,m]}function W(){var z=fa.getSkinName(),m=new pa;m.setFilePath("scene/skin/"+z+"/res/dm-impl.png");
m.setStartPosition(1,1);m.setIconSize(16,16);da.regist("entity",m.createDescription(0,0));da.regist("entity_selected",m.createDescription(1,0));da.regist("entity-sub",m.createDescription(0,1));da.regist("entity-sub_selected",m.createDescription(1,1));da.regist("head-biz-union",m.createDescription(2,0));da.regist("head-biz-union_selected",m.createDescription(3,0));da.regist("entry-biz-union",m.createDescription(2,1));da.regist("entry-biz-union_selected",m.createDescription(3,1));da.regist("query_entity",
m.createDescription(0,3));da.regist("query_entity_selected",m.createDescription(0,4));da.regist("query_entity-sub",m.createDescription(0,7));da.regist("query_entity-sub_selected",m.createDescription(0,8));da.regist("with_post_processor_entity",m.createDescription(0,5));da.regist("with_post_processor_entity_selected",m.createDescription(0,6));da.regist("with_post_processor_entity-sub",m.createDescription(0,9));da.regist("with_post_processor_entity-sub_selected",m.createDescription(0,10));m.setStartPosition(1,
69);m.setIconSize(90,45);z=m.createDescription(1,0);da.regist("source_ERPCloud_blue",z)}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var T=com.kingdee.bos.qing.scene,fa,pa,X,ma,ja,da,O,aa,H,G;(function(){var z=com.kingdee.bos.qing;fa=z.CodeLoader;z=com.kingdee.bos.qing.framework.common;
pa=z.IconsFile;X=z.MultilanguageManager.createPackageAccessor(T);z=com.kingdee.bos.qing.data;ma=z.DbSelectTableStep;ja=z.DbSelectFieldStep;da=z.Icons;O=z.AbstractBizMetaSource;aa=z.AbstractSource;H=z.SourceType;G=T.DataModellingContext})();h.ENTITY="ERPCloudEntity";G.addSourceType(function(z){z(new H(h.ENTITY,X.get("bussinessEntity","\u4e1a\u52a1\u5b9e\u4f53"),"source_ERPCloud_blue",h),W,L,null,null,null)})})();(function(){function h(){G.call(this);var y=this,N={},r={},q,J,f,a,g,w=!1;this.isBasedOnDB=function(){return!0};this.isModifiable=function(){return!0};this.isShowChangeSourceTypeButtonInMenu=function(){return!1};this.supportMergeTable=function(){return!0};this.getMergeType=function(){return m.COMMON_MERGE};this.isSupportColumnToRow=function(){return!0};this.getShortDisplay=function(){return O.get("superQuery","\u8d85\u7ea7\u67e5\u8be2")};this.addUserSql=function(c){var d=c.getName();N[d]=c};this.setAllUserSql=
function(c){N=c};this.hasUserSql=function(){return N&&"{}"!==JSON.stringify(N)};this.isUserSql=function(c){return!!N[c]};this.getUserSql=function(c){return N[c]};this.getAllUserSqlName=function(){return Object.keys(N)};this.getAllUserSql=function(){return N};this.removeUserSql=function(c){delete N[c]};this.supportStoredProcedure=function(){return!1};this.addStoredProcedure=function(c){var d=c.getName();r[d]=c};this.setAllStoredProcedure=function(c){r=c};this.hasStoredProcedure=function(){return r&&
"{}"!==JSON.stringify(r)};this.isStoredProcedure=function(c){return!!r[c]};this.getStoredProcedure=function(c){return r[c]};this.getAllStoredProcedureName=function(){return Object.keys(r)};this.getAllStoredProcedure=function(){return r};this.removeStoredProcedure=function(c){delete r[c]};this.setSchemaName=function(c){q=c};this.getSchemaName=function(){return q};this.setDbAddress=function(c){f=c};this.getDbAddress=function(){return f};this.setDbName=function(c){J=c};this.getDbName=function(){return J};
this.setUserName=function(c){a=c};this.getUserName=function(){return a};this.setPassword=function(c){g=c};this.getPassword=function(){return g};this.setQueryEntries=function(c){w=c};this.isQueryEntries=function(){return w};this.protectedToJsonObject=function(c){for(var d=[],x=y.getAllUserSqlName(),p=0;p<x.length;p++){var e=x[p];if(y.isUserSql(e)){var C={},A=y.getUserSql(e);C.name=e;C.sqlType=A.getSqlType();C.content=A.getContent();d.push(C)}}c.userSqls=d;c.schemaName=q;c.dbName=J;c.dbAddress=f;c.userName=
a;g&&(c.password=ma.encode(g));c.isQueryEntries=w};this.protectedFromJsonObject=function(c){if(c.userSqls)for(var d=c.userSqls,x=0;x<d.length;x++){var p=new z,e=d[x];p.setName(e.name);p.setContent(e.content);p.setSqlType(e.sqlType);y.addUserSql(p)}q=c.schemaName;J=c.dbName;f=c.dbAddress;a=c.userName;c.password&&(g=ma.decode(c.password));w=c.isQueryEntries};this.isTheSame=function(c){return y.getTypeName()==c.getTypeName()&&y.getSchemaName()==c.getSchemaName()&&y.getDbAddress()==c.getDbAddress()&&
y.getDbName()==c.getDbName()};this.clone=function(){var c=new h;c.setName("s"+(new Date).getTime());c.setTypeName(y.getTypeName());for(var d={},x=y.getAllUserSqlName(),p=0;p<x.length;p++)d[x[p]]=N[x[p]];c.setAllUserSql(d);c.setSchemaName(q);c.setDbName(J);c.setDbAddress(f);c.setUserName(a);c.setPassword(g);return c};this.clear=function(){q=g=a=f=J=null};this.mergeFrom=function(c){for(var d=c.getAllUserSqlName(),x=0;x<d.length;x++){var p=d[x];c.isUserSql(p)&&(p=c.getUserSql(p),y.addUserSql(p))}y.setSchemaName(c.getSchemaName());
y.setDbName(c.getDbName());y.setDbAddress(c.getDbAddress());y.setUserName(c.getUserName());y.setPassword(c.getPassword())};this.fissionFor=function(c){var d=new h;d.setName("s"+(new Date).getTime());c=c.getName();if(y.isUserSql(c)){var x=y.getUserSql(c);d.addUserSql(x);y.removeUserSql(c)}return d};this.isShowEntityMark=function(){return!0};this.isPublic=function(){return!0};this.getConnectionType=function(){return m.DBCONNECTION_TYPE_SUPERQUERY}}function v(){var y,N;this.createStep=function(r,q,J,
f,a,g){y=r.clone();q?N=new sa:(N=new ea,N.setChangeSourceType(J),N.setMessageCurtain(g),N.setOldEntity(f),N.setDModel(a));N.setSource(y);return N}}function L(y,N,r,q,J,f,a,g){r||(r=new h,r.setName("s"+(new Date).getTime()),r.setTypeName(N));return[(new v).createStep(r,J,f,a,g,q)]}function W(){var y=pa.getSkinName(),N=new da;N.setFilePath("scene/skin/"+y+"/res/dm-impl.png");N.setStartPosition(1,1);N.setIconSize(16,16);N.setStartPosition(1,69);N.setIconSize(90,45);y=N.createDescription(1,0);H.regist("source_SuperQuery",
y)}function T(){na.call(this);var y=this,N=this.protectedMethod,r,q,J,f,a,g,w,c,d,x,p;this.propectedCreateJqUi=function(D,b,l,k,E){g=D;J=k;q=E;w=b;c=l;r||(r=$("<div>"),e());return r};var e=function(){var D=c.clone();D.setSchemaName(null);var b=c.getSchemaName();J.createFacade(function(l){f=[];for(var k=Object.keys(l),E=0;E<k.length;E++){var t=new ba;t.setName(k[E]);t.setAlias(l[k[E]]);b==k[E]&&(a=t);f.push(t)}0==f.length&&(l=O.get("noAuthentication","\u6ca1\u6709\u53ef\u7528\u7684\u6a21\u5f0f\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u6388\u6743\u6a21\u5f0f\u3002"),
N.getMessageCurtain().showPrompt(l));a||(l=new ba,l.setName(b),l.setAlias(b),a=l);C();return!0},function(l,k){f=[];C();N.getMessageCurtain().showPrompt(k);return!0}).getUsableSchemas(D.toJsonObject())},C=function(){var D=0;D="";null!=c.getDbAddress()?(p=new ta,p.setSchemas(f),p.setSelectedSchema(a),p.setSource(c),p.setCtxApi(J),p.setMessageCurtain(N.getMessageCurtain()),d=p,r.append(p.getJqUi()),D=O.get("superQuery","\u8d85\u7ea7\u67e5\u8be2")+"-"+O.get("otherSystem","\u5176\u5b83\u7cfb\u7edf"),p.setTitle(D),
D=324):(x=new ka,x.setSchemas(f),x.setSelectedSchema(a),d=x,r.append(x.getJqUi()),x.setTitle(O.get("superQuery","\u8d85\u7ea7\u67e5\u8be2")),D=108);var b=new U;b.setClosingAction(function(l){var k=y.getConfirmListener();k&&k(l)});b.setCloseCallerDialogCallback(function(){N.destroy()});b.setChangeDataSourceParameter(g,w,J,q,c);b=b.getJqUi();X.layoutCtrl(b,0,D,120,60)};this.protectedAccepted=function(D,b){var l=d.getErrorMessage();if(l)return N.getMessageCurtain().showPrompt(l),!1;var k=c.clone();a=
d.getSchema();if(null!=c.getDbAddress()){var E=a.getName(),t=d.getCloneSource();t.setSchemaName(E);J.createFacade(function(M){k.setSchemaName(E);k.setDbAddress(t.getDbAddress());k.setDbName(t.getDbName());k.setUserName(t.getUserName());k.setPassword(t.getPassword());A(D,b,k);return!0},function(M,P){3201001==M&&(P=O.get("noSchemaPerm","\u201c#1\u201d\u7528\u6237\u6ca1\u6709\u201c#2\u201d\u6a21\u5f0f\u7684\u6743\u9650\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u6a21\u5f0f\u6216\u8054\u7cfb\u7ba1\u7406\u5458\u6388\u6743\u3002").replace("#1",
t.getUserName()).replace("#2",t.getSchemaName()));N.getMessageCurtain().showPrompt(P);return!0}).getUsableSchemas(t.toJsonObject())}else k.setSchemaName(a.getName()),A(D,b,k)};var A=function(D,b,l){l.isTheSame(b)||(D.setSource(l),l=g.getSources(),D.mergeSource(l),g.funClearUserSqlsAndStoredProcedures(b));y.refreshDesigntimeDataObject(w,w.getSource(),J);if(d.isChecked()){D=g.getAllEntity();for(var k in D)b=D[k],!b.isUnion()&&c.isTheSame(b.getSource())&&w.getName()!==b.getName()&&(b.setSource(w.getSource()),
b.mergeSource(g.getSources()),y.refreshDesigntimeDataObject(b,b.getSource(),J))}};this.protectedIsValidToAccepted=function(D){D(!0)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var fa=com.kingdee.bos.qing.scene;fa.SuperQuerySource=h;fa.SuperQueryFacade=function(y,
N,r,q){ja.call(this,y,N,r,q);var J=this.protectedMethod;this.checkSuperQueryPermission=function(){J.remote("checkSuperQueryPermission",{})};this.loadUsableSchemas=function(f){f={source:JSON.stringify(f.toJsonObject())};J.remote("loadUsableSchemas",f)}};var pa,X,ma,ja,da,O,aa,H,G,z,m,ha,ea,na,U,ba,sa,ka,ta;(function(){var y=com.kingdee.bos.qing;pa=y.CodeLoader;y=com.kingdee.bos.qing.common;X=y.DomUtil;ma=y.Base64Util;y=com.kingdee.bos.qing.framework.common;ja=y.AbstractFacade;O=y.MultilanguageManager.createPackageAccessor(fa);
da=y.IconsFile;y=com.kingdee.bos.qing.data;aa=y.SourceType;H=y.Icons;G=y.AbstractBizMetaSource;m=y.AbstractSource;z=y.UserSqlObj;ea=y.SuperQueryConnectionStep;na=y.AbstractSourceModifyingEditor;U=y.AdvancedSettingPane;ba=y.SchemaInfo;sa=y.MergeSuperQueryStep;ka=y.ModifyDirectConnPanel;ta=y.ModifySqlConnPanel;ha=fa.DataModellingContext})();h.ENTITY="SuperQuery";ha.addSourceType(function(y){y(new aa(h.ENTITY,O.get("superQuery","\u8d85\u7ea7\u67e5\u8be2"),"source_SuperQuery",h),W,L,null,null,null,T)})})();(function(){function h(a,g,w,c){da.call(this,a,g,w,c);var d=this.protectedMethod;this.checkDBCenterPermission=function(){d.remote("checkDBCenterPermission",{})};this.loadAppNameByAppNumber=function(x){d.remote("loadAppNameByAppNumber",{appNumber:x})};this.getDBCenterAppDBType=function(x){d.remote("getDBCenterAppDBType",{appNumber:x})}}function v(){ea.call(this);var a=this,g,w,c={},d={},x=r.checkEnvironment(r.COSMIC),p=!x;this.isBasedOnDB=function(){return!0};this.isModifiable=function(){return x};
this.isShowChangeSourceTypeButtonInMenu=function(){return p};this.setShowChangeSourceTypeButtonInMenu=function(e){p=e};this.supportMergeTable=function(){return!0};this.getMergeType=function(){return sa.COMMON_MERGE};this.isSupportColumnToRow=function(){return!0};this.setAppNumber=function(e){g=e};this.getAppNumber=function(){return g};this.setAppName=function(e){w=e};this.getAppName=function(){return w};this.getShortDisplay=function(){return aa.get("dataCenter","\u5f53\u524d\u6570\u636e\u4e2d\u5fc3")};
this.isUserSql=function(e){return c[e]?!0:!1};this.protectedToJsonObject=function(e){e.appNumber=g;e.appName=w;for(var C=[],A=a.getAllUserSqlName(),D=0;D<A.length;D++){var b=A[D];if(a.isUserSql(b)){var l=a.getUserSql(b),k=l.getContent();l=l.getSqlType();var E={};E.name=b;E.content=k;E.sqlType=l;C.push(E)}}e.userSqls=C;C=[];A=a.getAllStoredProcedureName();for(D=0;D<A.length;D++)b=A[D],a.isStoredProcedure(b)&&(b=a.getStoredProcedure(b),C.push(b.toJsonObject()));e.storedProcedures=C};this.protectedFromJsonObject=
function(e){g=e.appNumber;w=e.appName;var C=e.userSqls;if(C)for(var A=0;A<C.length;A++){var D=C[A],b=new U;b.setName(D.name);b.setContent(D.content);b.setSqlType(D.sqlType);a.addUserSql(b)}if(e=e.storedProcedures)for(A=0;A<e.length;A++)C=e[A],D=new ba,D.fromJsonObject(C),a.addStoredProcedure(D)};this.isTheSame=function(e){return a.getTypeName()==e.getTypeName()&&a.getAppNumber()==e.getAppNumber()};this.clone=function(){var e=new v;e.setName("s"+(new Date).getTime());e.setTypeName(a.getTypeName());
e.setAppNumber(g);var C={},A;for(A in c)C[A]=c[A];e.setAllUserSql(C);C={};for(var D in d)C[D]=d[D];e.setAllStoredProcedure(C);return e};this.mergeFrom=function(e){g=e.getAppNumber();for(var C=e.getAllUserSqlName(),A=0;A<C.length;A++){var D=C[A];e.isUserSql(D)&&(D=e.getUserSql(D),a.addUserSql(D))}C=e.getAllStoredProcedureName();for(A=0;A<C.length;A++)D=C[A],e.isStoredProcedure(D)&&(D=e.getStoredProcedure(D),a.addStoredProcedure(D))};this.isUserSql=function(e){return c[e]?!0:!1};this.getUserSql=function(e){return c[e]};
this.removeUserSql=function(e){delete c[e]};this.addStoredProcedure=function(e){var C=e.getName();d[C]=e};this.removeStoredProcedure=function(e){delete d[e]};this.getStoredProcedure=function(e){return d[e]};this.getAllStoredProcedureName=function(){var e=[],C;for(C in d)e.push(C);return e};this.isStoredProcedure=function(e){return d[e]?!0:!1};this.supportStoredProcedure=function(){return!1};this.fissionFor=function(e){var C=new v;C.setName("s"+(new Date).getTime());e=e.getName();if(a.isUserSql(e)){var A=
a.getUserSql(e);C.addUserSql(A);a.removeUserSql(e)}a.isStoredProcedure(e)&&(A=a.getStoredProcedure(e),C.addStoredProcedure(A),a.removeStoredProcedure(e));return C};this.addUserSql=function(e){var C=e.getName();c[C]=e};this.getAllUserSqlName=function(){var e=[],C;for(C in c)e.push(C);return e};this.setAllUserSql=function(e){c=e};this.getAllUserSql=function(){return c};this.hasUserSql=function(){return c&&"{}"!==JSON.stringify(c)?!0:!1};this.hasStoredProcedure=function(){return d&&"{}"!==JSON.stringify(d)?
!0:!1};this.setAllStoredProcedure=function(e){d=e};this.getAllStoredProcedure=function(){return d};this.getConnectionType=function(){return sa.DBCONNECTION_TYPE_DBCENTER}}function L(a,g,w,c,d,x,p,e){w||(w=new v,w.setName("s"+(new Date).getTime()),w.setTypeName(g));return[(new fa(a)).createStep(w,d,x,p,e)]}function W(){var a=ma.getSkinName(),g=new O;g.setFilePath("scene/skin/"+a+"/res/dm-impl.png");g.setStartPosition(1,1);g.setIconSize(16,16);g.setStartPosition(1,69);g.setIconSize(90,45);a=g.createDescription(1,
0);ha.regist("source_ERPCloudDBCenter",a)}function T(){var a,g,w,c;this.getJqUi=function(){if(!g){g=$("<div>");w=new G;w.setText(aa.get("chooseApp","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5e94\u7528"));w.setReadonly("readonly");var p=w.getJqUi();p.attr("title",aa.get("chooseApp","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5e94\u7528"));p.children("input").css({width:"90%","text-overflow":"ellipsis"});p.on("click",x);var e=$("<div>");ha.background(e,"f7");e.css("z-index","1");e.css("cursor","pointer");e.on("click",
x);ja.layoutCtrl(p,0,0,180,23);ja.layoutCtrl(e,160,0,16,16);e.appendTo(g);p.appendTo(g)}return g};this.setFunSelectedChangeListener=function(p){c=p};this.setSelectedValue=function(p){a=p;w&&w.setText(d());c(a)};this.getSelectedValue=function(){return a};var d=function(){var p=aa.get("chooseApp","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5e94\u7528");a&&(p=a.text);return p},x=function(){var p=com.kingdee.bos.qing.integration.AppChooseForm;p.setCallBack(function(e){if(e&&e.content){e=e.content;var C=e.appNumber,
A={};A.text=e.appName;A.value=C;a=A;w&&w.setText(d());c(a)}});p.openAppChooseForm()}}function fa(a){var g,w=new T,c;this.createStep=function(C,A,D,b,l){g=C.clone();A?c=new ta:(c=new na,c.setChangeSourceType(D),c.setOldEntity(b),c.setDModel(l));c.isShowDataBase(!0);c.setDataBaseJqUiCreator(x);c.setDbChecker(d);c.setSource(g);return c};var d=function(C,A){var D=w.getSelectedValue();if(D)return C.setAppNumber(D.value),!0;A.showPrompt(aa.get("chooseAppCurtain","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5e94\u7528\u3002"));
return!1},x=function(C){var A=$("<div>"),D=(new H(aa.get("app","\u5e94\u7528"))).getJqUi();D.attr("title",aa.get("app","\u5e94\u7528"));var b=w.getJqUi();w.setFunSelectedChangeListener(e);ja.layoutCtrl(D,15,0,45,23);ja.layoutCtrl(b,60,0,200,23);A.append(D);A.append(b);p(C);return A},p=function(C){var A=g.getAppNumber();A&&(new h(a,function(D){D?w.setSelectedValue({text:D.appName,value:A}):C.showPrompt(aa.get("loadAppNameError","\u83b7\u53d6\u5e94\u7528\u540d\u79f0\u5931\u8d25\u3002"),2E3)},function(D,
b){b?C.showPrompt(b,2E3):C.showPrompt(aa.get("loadAppNameError","\u83b7\u53d6\u5e94\u7528\u540d\u79f0\u5931\u8d25\u3002"),2E3);return!0})).loadAppNameByAppNumber(A)},e=function(C){C=C.value;(new h(a,function(A){c.changeDBType(A)},function(A){return!1})).getDBCenterAppDBType(C)}}function pa(){y.call(this);var a=this,g=this.protectedMethod,w,c,d,x,p,e,C,A=new com.kingdee.bos.qing.data.RemoteImpl,D,b=new T;this.propectedCreateJqUi=function(t,M,P,n,Q){w=t;c=M;x=n;d=P;C=Q;p||l();return p};var l=function(){p=
$("<div>");var t=(new H(aa.get("dataCenter","\u5f53\u524d\u6570\u636e\u4e2d\u5fc3"))).getJqUi(),M=(new H(aa.get("app","\u5e94\u7528"))).getJqUi(),P=b.getJqUi();b.setFunSelectedChangeListener(function(){});var n=d.getAppNumber();n&&(A.setRemoteUrl(k()),E(A,n));e=new z;e.setText(aa.get("actOnTheSameDatabase","\u540c\u65f6\u4fee\u6539\u5f53\u524d\u4e3b\u9898\u4e2d\u5176\u4ed6\u540c\u6e90\u6570\u636e\u8868"));e.setChecked(!0);n=e.getJqUi();ja.layoutCtrl(t,0,0,120,23);ja.layoutCtrl(M,20,40,70,23);ja.layoutCtrl(P,
70,40,280,23);ja.layoutCtrl(n,20,80,250,23);p.append(t);p.append(M);p.append(P);p.append(n);t=new N;var Q=a.getConfirmListener();t.setClosingAction(function(F){Q&&Q(F)});t.setCloseCallerDialogCallback(function(){g.destroy()});t.setChangeDataSourceParameter(w,c,x,C,d);t=t.getJqUi();ja.layoutCtrl(t,0,120,120,60);p.append(t)},k=function(){var t=(new com.kingdee.bos.qing.data.DataModelingScene).getUrlParam("path");return(t?t:"/ierp")+"/qing/dataModeling.do"},E=function(t,M){(new com.kingdee.bos.qing.scene.DataCenterFacade(t,
function(P){P&&b.setSelectedValue({text:P.appName,value:M})},function(P,n){b.setSelectedValue({text:M,value:M});n&&(D||(D=q.createWarning(),P=(new J).measureWidth(aa.get("dataCenter","\u5f53\u524d\u6570\u636e\u4e2d\u5fc3"))+14,ja.layoutCtrl(D,P,5,12,12),D.appendTo(p)),D.attr("title",n),D.show());return!0})).loadAppNameByAppNumber(M)};this.protectedIsValidToAccepted=function(t){t(!0)};this.protectedAccepted=function(t,M){var P=!e.isChecked(),n=d.clone();n.setAppNumber(b.getSelectedValue().value);if(P){if(!n.isTheSame(M)){var Q=
t.getName();d.isUserSql(Q)?(Q=d.getUserSql(Q),n.addUserSql(Q)):d.isStoredProcedure(Q)&&(Q=d.getStoredProcedure(Q),n.addStoredProcedure(Q));Q=w.getSources();t.setSource(n);t.mergeSource(Q);w.funClearUserSqlsAndStoredProcedures(M)}a.refreshDesigntimeDataObject(c,c.getSource(),x)}else for(Q in M.setAppNumber(n.getAppNumber()),a.refreshDesigntimeDataObject(c,c.getSource(),x),t=w.getAllEntity(),t)M=t[Q],M.isUnion()||c.getSource().isTheSame(M.getSource())&&c.getName()!==M.getName()&&a.refreshDesigntimeDataObject(M,
c.getSource(),x)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var X=com.kingdee.bos.qing.scene;X.AppChooseDialogSelector=T;X.ERPCloudDBCenterSource=v;X.DataCenterFacade=h;var ma,ja,da,O,aa,H,G,z,m,ha,ea,na,U,ba,sa,ka,ta,y,N,r,q,J;(function(){var a=com.kingdee.bos.qing;
ma=a.CodeLoader;a=com.kingdee.bos.qing.common;ja=a.DomUtil;J=a.TextMeasurer;a=com.kingdee.bos.qing.common.ui;q=a.CommonIconUtil;a=com.kingdee.bos.qing.framework.common;da=a.AbstractFacade;O=a.IconsFile;aa=a.MultilanguageManager.createPackageAccessor(X);a=com.kingdee.bos.qing.ui.component;H=a.Label;G=a.TextField;z=a.CheckBox;a=com.kingdee.bos.qing.data;m=a.SourceType;ha=a.Icons;ea=a.AbstractBizMetaSource;sa=a.AbstractSource;na=a.MetaDBConnectionStep;ta=a.MergeDBCenterConnectionStep;U=a.UserSqlObj;
ba=a.StoredProcedureModel;N=a.AdvancedSettingPane;y=a.AbstractSourceModifyingEditor;r=a.ProductLineEnvironment;ka=X.DataModellingContext})();v.DBCENTER="ERPCloudDBCenter";var f=function(a,g,w,c){(new h(a,function(d){d?w():(g.showPrompt(aa.get("noDBCenterPermission","\u6ca1\u6709\u6570\u636e\u4e2d\u5fc3\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),2E3),c())},function(d){c();return!1})).checkDBCenterPermission()};ka.addSourceType(function(a){a(new m(v.DBCENTER,
aa.get("dataCenter","\u5f53\u524d\u6570\u636e\u4e2d\u5fc3"),"source_ERPCloudDBCenter",v),W,L,f,null,null,pa)})})();(function(){function h(){m.call(this);var r=this,q={},J,f;this.setModelId=function(a){J=a};this.getModelId=function(){return J};this.setModelType=function(a){f=a};this.getModelType=function(){return f};this.getAllModelType=function(){return q};this.setTotalModelType=function(a){q=a};this.addModelType=function(a,g){q[a]=g};this.isMetricModel=function(a){return q[a]==ka};this.isMetricModelSelected=function(a){a=Object.keys(a);for(var g=0;g<a.length;g++)if(r.isMetricModel(a[g]))return!0;return!1};this.getShortDisplay=
function(){return O.get("dppSourceName","\u8f7b\u5efa\u6a21")};this.protectedIsTheSame=function(a){return!0};this.isModifiable=function(){return!1};this.fissionFor=function(a){a=new h;a.setTypeName(r.getTypeName());a.setModelId(r.getModelId());a.setModelType(r.getModelType());return a};this.getMergeType=function(){return ha.BIZ_MERGE};this.supportMergeTable=function(){return!1};this.protectedToJsonObject=function(a){a.modelId=J;a.modelType=f;a.allModelType=q};this.protectedFromJsonObject=function(a){J=
a.modelId;f=a.modelType;q=a.allModelType};this.isSupportFlexModel=function(){return!0};this.getEntityIconName=function(a){var g=a;-1!==a.indexOf("_")&&(g=a.lastIndexOf("_"),g=a.slice(0,g));return q[g]};this.mergeFrom=function(a){a=a.getAllModelType();for(var g=Object.keys(a),w=0;w<g.length;w++)q[g[w]]||(q[g[w]]=a[g[w]])};this.isShowEntityMark=function(){return!0};this.isSupportCustomField=function(a){return!r.isMetricModel(a)};this.isSupportChangeFieldType=function(a){return!r.isMetricModel(a)};this.isSupportCreateRelation=
function(a){return!r.isMetricModel(a)};this.isSupportExtractData=function(a){return!r.isMetricModel(a)};this.getDisplayName=function(a){return r.isMetricModel(a)?O.get("metricModel","\u6307\u6807\u6a21\u578b"):O.get("dataTableModel","\u6570\u636e\u8868\u6a21\u578b")}}function v(){G.call(this);var r=this.protectedMethod,q=this,J,f;ea.DPP_SOURCES=[new ea("data_table_model",O.get("dataTableModel","\u6570\u636e\u8868\u6a21\u578b"),"source_data_table")];this.protectedCreateUi=function(){var d=$("<div class='dm-modeler'>"),
x=$("<div class='dm-source-type-typelist-title'>");x.text(O.get("type","\u7c7b\u578b"));x.on("mousedown",a);var p=new na;p.setItemModels(ea.DPP_SOURCES);p.setBorderVisible(!1);p.setCustomItemPainter(g);p.setCustomSelectedsPainter(w);p.addPressedListener(c);p=p.getJqUi();p.addClass("dm-source-type-typelist-list");d.append(x);d.append(p);return d};var a=function(d){d.ctrlKey&&20<=d.offsetX&&50>=d.offsetX&&(2===ea.DPP_SOURCES.length&&ea.DPP_SOURCES.pop(),ea.DPP_SOURCES.push(new ea(ka,O.get("metricModel",
"\u6307\u6807\u6a21\u578b"),"source_metric")),$(".dm-modeler .dm-source-type-typelist-list").remove(),d=new na,d.setItemModels(ea.DPP_SOURCES),d.setSelecteds([f]),d.setBorderVisible(!1),d.setCustomItemPainter(g),d.setCustomSelectedsPainter(w),d.addPressedListener(c),d=d.getJqUi(),d.addClass("dm-source-type-typelist-list"),$(".dm-modeler").append(d))},g=function(d,x){d.attr("title",x.getText());d.addClass("dm-source-type-typelist-item");var p=$("<div>");p.addClass("dm-source-type-typelist-item-icon");
z.background(p,x.getIconName());p.appendTo(d);p=$("<div>");p.addClass("dm-source-type-typelist-item-text");p.text(x.getText());p.appendTo(d)},w=function(d,x){for(var p=0;p<d.length;p++){var e=d[p];e.removeClass("dm-source-type-typelist-item_selected");e.find(".dm-source-type-typelist-item_selected-mark").remove();e.find(".dm-source-type-typelist-item_selected-icon").remove()}for(p=0;p<x.length;p++)e=x[p],e.addClass("dm-source-type-typelist-item_selected"),d=$("<div>"),d.addClass("dm-source-type-typelist-item_selected-mark"),
d.appendTo(e),d=$("<div>"),z.background(d,"checked"),d.addClass("dm-source-type-typelist-item_selected-icon"),d.appendTo(e)},c=function(d,x){f=d.getSelecteds()[0]};this.isLastStep=function(){return!1};this.getSubTitle=function(){return O.get("dppSourceName","\u8f7b\u5efa\u6a21")};this.setBox=function(d){J=d};this.intoThisStep=function(d,x){};this.outThisStep=function(d,x){if(d)x(null);else if(f){d=J.getAllEntity();if(0<d.length){d=y(d);if(f.getName()===ka&&!d){r.getMessageCurtain().showPrompt(O.get("unableSelectMetricModel",
"\u8f7b\u5efa\u6a21\u6307\u6807\u6a21\u578b\u4e0d\u5141\u8bb8\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u8868\u540c\u65f6\u5b58\u5728\uff0c\u5f53\u524d\u5df2\u5b58\u5728\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u8868\uff0c\u65e0\u6cd5\u6dfb\u52a0\u6307\u6807\u6a21\u578b\u3002"));return}if("data_table_model"===f.getName()&&d){r.getMessageCurtain().showPrompt(O.get("unableSelectOtherDataTable","\u8f7b\u5efa\u6a21\u6307\u6807\u6a21\u578b\u4e0d\u5141\u8bb8\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u8868\u540c\u65f6\u5b58\u5728\uff0c\u5f53\u524d\u5df2\u5b58\u5728\u6307\u6807\u6a21\u578b\uff0c\u65e0\u6cd5\u6dfb\u52a0\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u8868\u3002"));
return}}q.getSource().setModelType(f.getName());x(null)}else r.getMessageCurtain().showPrompt(O.get("selectADppModel","\u8bf7\u9009\u4e2d\u4e00\u9879\u6a21\u578b\u3002"))}}function L(){aa.call(this);var r=this;this.setBox=function(q){};this.getSubTitle=function(){return r.getSource().getModelType()===ka?O.get("selectMetricModel","\u9009\u62e9\u6307\u6807\u6a21\u578b"):O.get("selectDataTableModel","\u9009\u62e9\u6570\u636e\u8868\u6a21\u578b")};this.protectedCreateNoTableTipUi=function(){var q=$("<div>");
q.css("line-height","20px");q.css("color","#666");q.append(O.get("noAuthorizedModelTip","\u6682\u65e0\u53ef\u9009\u62e9\u7684\u6a21\u578b<br/>\u73b0\u5728\u53bb\u8f7b\u5efa\u6a21"));var J=$("<span class='dm-source-table-btn-link'>");J.text(O.get("gotoQingModeler","\u65b0\u5efa\u6a21\u578b"));J.on("click",function(){var f=ba.decodeParamFromUrl(window.location.search,"path")+"/qing_modeler/homepage.do";U.openNewTabInAppId(O.get("qing_modeler","\u8f7b\u5efa\u6a21"),f,f,U.QING_MODELER)});q.append(J);
return q}}function W(){H.call(this);var r=this;this.protectedHandleEntities=function(q){var J={},f=r.getSource(),a=f.getAllModelType(),g;for(g in q){var w=q[g],c=w.getAssociateName();w.setDirectModel(f.isMetricModel(c));J[c]=a[c]}r.getSource().setTotalModelType(J)}}function T(r,q,J,f,a,g,w,c){r=new v;r.setBox(c);f=new L;f.setBox(c);c=new W;J?(q=new h,q.setName("s"+(new Date).getTime()),q.setTypeName(J.getTypeName()),q.setTotalModelType(J.getAllModelType()),q.setModelType(J.getModelType()),r.setSource(q),
f.setSource(q),c.setSource(q)):(J=new h,J.setName("s"+(new Date).getTime()),J.setTypeName(q),r.setSource(J),f.setSource(J),c.setSource(J));return[r,f,c]}function fa(){var r=ma.getSkinName(),q=new da;q.setFilePath("scene/skin/"+r+"/res/dm-impl.png");q.setStartPosition(1,1);q.setIconSize(16,16);z.regist("data_table_model",q.createDescription(2,4));z.regist("data_table_model_selected",q.createDescription(2,3));z.regist("data_table_model-sub",q.createDescription(2,4));z.regist("data_table_model-sub_selected",
q.createDescription(2,4));z.regist("entity_model",q.createDescription(1,4));z.regist("entity_model_selected",q.createDescription(1,3));z.regist("entity_model-sub",q.createDescription(1,4));z.regist("entity_model-sub_selected",q.createDescription(1,4));z.regist("metric_model",q.createDescription(1,5));z.regist("metric_model_selected",q.createDescription(1,6));z.regist("relation_model",q.createDescription(3,4));z.regist("relation_model_selected",q.createDescription(3,3));z.regist("relation_model-sub",
q.createDescription(3,4));z.regist("relation_model-sub_selected",q.createDescription(3,4));z.regist("dpp_head-biz-union",q.createDescription(2,0));z.regist("dpp_head-biz-union_selected",q.createDescription(3,0));z.regist("dpp_entry-biz-union",q.createDescription(2,1));z.regist("dpp_entry-biz-union_selected",q.createDescription(3,1));q.setStartPosition(1,69);q.setIconSize(90,45);r=q.createDescription(1,0);z.regist("source_dpp_blue",r);z.regist("source_metric",q.createDescription(0,1));z.regist("source_data_table",
q.createDescription(1,1))}function pa(r,q,J,f){ja.call(this,r,q,J,f);var a=this.protectedMethod;this.checkDppPermission=function(){a.remote("checkDppPermission",{})}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var X=com.kingdee.bos.qing.scene,ma,ja,da,O,aa,
H,G,z,m,ha,ea,na,U,ba,sa;(function(){var r=com.kingdee.bos.qing;ma=r.CodeLoader;r=com.kingdee.bos.qing.framework.common;ja=r.AbstractFacade;da=r.IconsFile;O=r.MultilanguageManager.createPackageAccessor(X);U=r.TabbedUiUtil;r=com.kingdee.bos.qing.data;aa=r.DbSelectTableStep;H=r.DbSelectFieldStep;G=r.AbstractImportEntityStep;z=r.Icons;m=r.AbstractBizMetaSource;ha=r.AbstractSource;ea=r.SourceType;r=com.kingdee.bos.qing.ui.component;na=r.List;r=com.kingdee.bos.qing.common;ba=r.Util;sa=X.DataModellingContext})();
h.ENTITY="dpp";var ka="metric_model",ta=function(r,q,J,f){(new pa(r,function(a){a&&J()},function(a){if(3101021==a)return q.showPrompt(O.get("noModelerLicense","\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u3010\u8f7b\u5efa\u6a21\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002"),2E3),f(),!0;if(3010013==a)return q.showPrompt(O.get("nonSupportModeler","\u5f53\u524d\u7248\u672c\u4e0d\u652f\u6301\u3010\u8f7b\u5efa\u6a21\u3011\u6a21\u5757\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002"),
2E3),f(),!0;f();return!1})).checkDppPermission()},y=function(r){for(var q=0;q<r.length;q++){var J=r[q];if(J instanceof com.kingdee.bos.qing.data.Entity){var f=J.getSource();if(f instanceof h&&f.isMetricModel(J.getAssociateName()))return!0}}return!1},N=function(r,q,J){r=r.getAllEntity();if(q===h.ENTITY)return!1;(q=y(r))&&J.showPrompt(O.get("unableSelectOtherDataTable","\u8f7b\u5efa\u6a21\u6307\u6807\u6a21\u578b\u4e0d\u5141\u8bb8\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u8868\u540c\u65f6\u5b58\u5728\uff0c\u5f53\u524d\u5df2\u5b58\u5728\u6307\u6807\u6a21\u578b\uff0c\u65e0\u6cd5\u6dfb\u52a0\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u8868\u3002"));
return q};sa.addSourceType(function(r){r(new ea(h.ENTITY,O.get("dppSourceName","\u8f7b\u5efa\u6a21"),"source_dpp_blue",h),fa,T,ta,N,null)})})();(function(){function h(b,l,k,E){G.call(this,b,l,k,E);var t=this.protectedMethod;this.checkDmoPermission=function(){t.remote("checkDmoPermission",{})};this.getDmoProjectInfo=function(){t.remote("getDmoProjectInfo",{})};this.getDmoDatasourceInfo=function(M){t.remote("getDmoDatasourceInfo",{projectId:M})};this.getSchemas=function(M,P,n,Q){t.remote("getSchemas",{projectId:M,storageId:P,storageTypeName:n,name:Q})}}function v(){y.call(this);var b=this,l,k,E,t,M,P={};this.isBasedOnDB=function(){return!0};
this.isModifiable=function(){return!0};this.supportMergeTable=function(){return t!=A};this.getMergeType=function(){return w.COMMON_MERGE};this.isSupportColumnToRow=function(){return!0};this.setProjectId=function(n){l=n};this.getProjectId=function(){return l};this.setStorageId=function(n){k=n};this.getStorageId=function(){return k};this.setStorageTypeName=function(n){E=n};this.getStorageTypeName=function(){return E};this.setTableModelType=function(n){t=n};this.getTableModelType=function(){return t};
this.setSchema=function(n){M=n};this.getSchema=function(){return M};this.isUserSql=function(n){return P[n]?!0:!1};this.addUserSql=function(n){var Q=n.getName();P[Q]=n};this.getUserSql=function(n){return P[n]};this.supportStoredProcedure=function(){return!1};this.getAllStoredProcedureName=function(){return null};this.removeUserSql=function(n){delete P[n]};this.getAllUserSqlName=function(){var n=[],Q;for(Q in P)n.push(Q);return n};this.setAllUserSql=function(n){P=n};this.getAllUserSql=function(){return P};
this.hasUserSql=function(){return P&&"{}"!==JSON.stringify(P)?!0:!1};this.getShortDisplay=function(){return m.get("dmo","\u6570\u636e\u5f00\u53d1\u5e73\u53f0")};this.isTheSame=function(n){return b.getTypeName()==n.getTypeName()&&b.getProjectId()==n.getProjectId()&&b.getStorageId()==n.getStorageId()&&b.getTableModelType()==n.getTableModelType()&&b.getSchema()==n.getSchema()};this.clone=function(){var n=new v;n.setName("s"+(new Date).getTime());n.setTypeName(v.DMO);n.setProjectId(l);n.setStorageId(k);
n.setTableModelType(t);n.setStorageTypeName(E);n.setSchema(M);return n};this.protectedToJsonObject=function(n){n.projectId=l;n.storageId=k;n.storageTypeName=E;n.tableModelType=t;n.schema=M;for(var Q=[],F=b.getAllUserSqlName(),u=0;u<F.length;u++){var K=F[u];if(b.isUserSql(K)){var V=b.getUserSql(K),la=V.getContent();V=V.getSqlType();var qa={};qa.name=K;qa.content=la;qa.sqlType=V;Q.push(qa)}}n.userSqls=Q};this.protectedFromJsonObject=function(n){l=n.projectId;k=n.storageId;t=n.tableModelType;E=n.storageTypeName;
M=n.schema;if(n=n.userSqls)for(var Q=0;Q<n.length;Q++){var F=n[Q],u=new e;u.setName(F.name);u.setContent(F.content);u.setSqlType(F.sqlType);b.addUserSql(u)}};this.mergeFrom=function(n){l=n.getProjectId();k=n.getStorageId();t=n.getTableModelType();E=n.getStorageTypeName();M=n.getSchema();for(var Q=n.getAllUserSqlName(),F=0;F<Q.length;F++){var u=Q[F];n.isUserSql(u)&&(u=n.getUserSql(u),b.addUserSql(u))}}}function L(b,l,k,E,t,M,P,n){k||(k=new v,k.setName("s"+(new Date).getTime()),k.setTypeName(l));return[(new fa(b)).createStep(k,
t,M,P,n)]}function W(){var b=aa.getSkinName(),l=new z;l.setFilePath("scene/skin/"+b+"/res/dm-impl.png");l.setStartPosition(1,1);l.setIconSize(16,16);l.setStartPosition(1,69);l.setIconSize(90,45);b=l.createDescription(1,0);ta.regist("source_ERPCloudDmo",b)}function T(b,l){N.call(this);var k=this,E=this.protectedMethod,t,M,P,n,Q,F,u,K,V,la=[],qa=[],ua=[],za,xa,Aa,Da,wa="dw_model",Ba;this.getSubTitle=function(){return m.get("dmo","\u6570\u636e\u5f00\u53d1\u5e73\u53f0")};this.setSelectEntity=function(I){Da=
I};this.isLastStep=function(){return k.getChangeSourceType()};this.getNewMergedEntity=function(){return k.getArrEntity()[0]};this.protectedCreateUi=function(){return $("<div>")};this.getSelectedValue=function(){return u};this.getProjects=function(){return la};this.getDatasources=function(){return qa};this.getSelectedProject=function(){return u};this.getSelectedDatabaseSource=function(){return K};this.getSelectedEntity=function(){return wa};var Ja=function(){t=$("<div>");var I=$("<div>");I.addClass("left-selector-project");
var B=(new ea(m.get("ProjectName","\u9879\u76ee"))).getJqUi();H.layoutCtrl(B,15,0,70,23);I.append(B);za=new na;B=za.getJqUi();H.layoutCtrl(B,100,0,200,23);I.append(B);B=40;var R=new ea(m.get("type","\u7c7b\u578b")),ca=R.getJqUi();H.layoutCtrl(ca,15,B,70,23);I.append(ca);R=new U;P=new ba;P.setChecked(!0);P.setText(m.get("database","\u6570\u636e\u5e93"));var ia=P.getJqUi();H.layoutCtrl(ia,100,B,120,23);B+=40;I.append(ia);R.addElement(P);n=new ba;n.setText(m.get("labelModel","\u6807\u7b7e\u6a21\u578b"));
n.addCheckedListener(function(Ea,Fa){Fa&&(V=K=null,wa=A,M.hide())});ia=n.getJqUi();H.layoutCtrl(ia,100,B,120,23);l||k.getChangeSourceType()||I.append(ia);R.addElement(n);t.append(I);M=$("<div>");M.addClass("right-selector-datasource");var S=0;I=(new ea(m.get("database","\u6570\u636e\u5e93"))).getJqUi();H.layoutCtrl(I,15,0,70,23);M.append(I);xa=new na;I=xa.getJqUi();H.layoutCtrl(I,100,S,200,23);M.append(I);S+=40;var oa=(new ea(m.get("dbschema","\u6a21\u5f0f"))).getJqUi();H.layoutCtrl(oa,15,S,70,23);
M.append(oa);Aa=new na;Aa.addSelectedChangedListener(function(Ea,Fa,Ga){V=Ga});var va=Aa.getJqUi();H.layoutCtrl(va,100,S,200,23);M.append(va);oa.hide();va.hide();R=new ea(m.get("type","\u7c7b\u578b"));ca=R.getJqUi();H.layoutCtrl(ca,15,S,70,23);M.append(ca);Q=new ba;Q.setText(m.get("table","\u8868"));Q.setChecked(!0);var Ca=Q.getJqUi();H.layoutCtrl(Ca,100,S,120,23);M.append(Ca);S+=40;Ca=Q.getJqUi();F=new ba;F.setText(m.get("customSql","\u81ea\u5b9a\u4e49")+d.SQLTYPE_SQL);var ya=F.getJqUi();H.layoutCtrl(ya,
100,S,120,23);M.append(ya);R=new U;R.addElement(Q);R.addElement(F);t.append(M);xa.addSelectedChangedListener(function(Ea,Fa,Ga){V=null;Ia(Ga)});var Ia=function(Ea){K=Ea;wa==A&&(V=null);-1!=C.indexOf(K.getStorageTypeName().toUpperCase())?(S=40,oa.show(),va.show(),S+=40,H.layoutCtrl(ca,15,S,70,23),H.layoutCtrl(Ca,100,S,120,23),S+=40,H.layoutCtrl(ya,100,S,120,23),Y(u.getProjectId(),K.getStorageId(),K.getStorageTypeName(),k.getSource().getName())):(V=null,S=40,oa.hide(),va.hide(),H.layoutCtrl(ca,15,S,
70,23),H.layoutCtrl(Ca,100,S,120,23),S+=40,H.layoutCtrl(ya,100,S,120,23))};za.addSelectedChangedListener(function(Ea,Fa,Ga){u=Ga;Z(Ia)});P.addCheckedListener(function(Ea,Fa){Fa&&(wa="dw_model",M.show(),Z(Ia))});Ha(Ia);k.getJqUi().append(t)};this.intoThisStep=function(I,B){this.getChangeSourceType()?(Ba=new pa,Ba.setSource(k.getSource()),Ba.setChangeSourceType(k.getChangeSourceType()),k.getJqUi().append(Ba.getJqUi())):t||Ja()};this.outThisStep=function(I,B){I?B():(I=com.kingdee.bos.qing.data.BizSourceTypeContext.getPermissionChecker())&&
I(k.getSource().getTypeName(),E.getMessageCurtain(),function(){if(k.getChangeSourceType())B(null);else if(ra(k.getSource(),E.getMessageCurtain())){var R=k.getSource();R.setTableModelType(wa);K&&(R.setStorageId(K.getStorageId()),R.setStorageTypeName(K.getStorageTypeName()));V&&"dw_model"==wa?R.setSchema(V.getSchemaName()):R.setSchema(null);if(Q.isChecked()||wa==A){var ca=new J,ia=new f;l&&(ca=new g,ca.setSelectEntity(Da),ia=new a,ia.setSelectEntity(Da));ca.setCtxApi(k.getCtxApi());ca.setSource(R);
ia.setCtxApi(k.getCtxApi());ia.setSource(R);B([ca,ia])}else F.isChecked()&&(R=k.creatNextCustomSqlStep(),l&&(R=new x,R.setSqlType(d.SQLTYPE_SQL),R.setCtxApi(k.getCtxApi()),R.setSource(k.getSource()),R.setSelectEntity(Da)),B(R))}},function(){})};this.over=function(I,B){if(k.getOldEntity()&&k.getChangeSourceType()&&I){B=!Ba.getJustForSelf();var R=Ba.getSelectedProject(),ca=Ba.getSelectedDataBasesource(),ia=Ba.getSelectedSchema();I=k.getOldEntity().getSource();var S=k.getSource().clone();S.setProjectId(R.getProjectId());
S.setStorageId(ca.getStorageId());S.setStorageTypeName(ca.getStorageTypeName());S.setTableModelType("dw_model");ia?S.setSchema(ia.getSchemaName()):S.setSchema(null);B?(S.isTheSame(I)||(B=k.getOldEntity().getName(),I.isUserSql(B)&&(B=I.getUserSql(B),S.addUserSql(B)),B=k.getDModel().getSources(),k.getOldEntity().setSource(S),k.getOldEntity().mergeSource(B),(I.hasUserSql()||I.hasStoredProcedure())&&k.getDModel().funClearUserSqlsAndStoredProcedures(I)),E.refreshDesigntimeDataObject(k.getOldEntity(),S)):
(I.hasUserSql()&&S.setAllUserSql(I.getAllUserSql()),(new p).updateSameSource(k.getDModel(),I,S,function(oa){oa.setSource(S);oa.mergeSource(k.getDModel().getSources());E.refreshDesigntimeDataObject(oa,S)},k.getOldEntity()))}};var Ha=function(I){(new h(b,function(B){if(B&&0<B.length){for(var R=0;R<B.length;R++){var ca=new ma;ca.fromJsonObject(B[R]);la.push(ca)}za.setItemModels(la);u=la[0];za.setSelected(u);za.setCustomPainter(function(ia,S,oa){S.text(oa.getProjectName());S.attr("title",oa.getProjectName())});
Z(I)}else E.getMessageCurtain().showPrompt(m.get("noProjectPrompt","\u60a8\u8fd8\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u5e94\u7528\u7684\u9879\u76ee\u5173\u7cfb\uff0c\u8bf7\u5148\u8fdb\u5165[\u6570\u636e\u5f00\u53d1\u5e73\u53f0]\u914d\u7f6e\u76f8\u5173\u4fe1\u606f\u3002"))},function(B,R){return 2215E3==B?(E.getMessageCurtain().showError(R),!0):2215006==B?(E.getMessageCurtain().showPrompt(m.get("noProjectPrompt","\u60a8\u8fd8\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u5e94\u7528\u7684\u9879\u76ee\u5173\u7cfb\uff0c\u8bf7\u5148\u8fdb\u5165[\u6570\u636e\u5f00\u53d1\u5e73\u53f0]\u914d\u7f6e\u76f8\u5173\u4fe1\u606f\u3002")),
!0):302010029==B||302010030==B?(E.getMessageCurtain().showPrompt(m.get("noUserInDmo","\u60a8\u8fd8\u672a\u8fdb\u5165\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u8fdb\u884c\u540c\u6b65\u8d26\u53f7\uff0c\u8bf7\u5148\u8fdb\u5165[\u6570\u636e\u5f00\u53d1\u5e73\u53f0]\u8fdb\u884c\u521d\u59cb\u5316\u3002")),!0):382011002==B?(E.getMessageCurtain().showPrompt(m.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),
2E3),!0):!1})).getDmoProjectInfo()},Z=function(I){qa=[];K=null;xa.setSelected(K);xa.setItemModels(qa);"dw_model"==wa&&(new h(b,function(B){if(B&&0<B.length){for(var R=0;R<B.length;R++){var ca=new ja;ca.fromJsonObject(B[R]);qa.push(ca)}xa.setItemModels(qa);K=qa[0];xa.setSelected(K);xa.setCustomPainter(function(ia,S,oa){oa?(S.text(oa.getStorageName()),S.attr("title",oa.getStorageName())):S.text("")});I&&I(K)}else E.getMessageCurtain().showPrompt(m.get("noDataSourcePrompt","\u8be5\u9879\u76ee\u8fd8\u6ca1\u6709\u914d\u7f6e\u5bf9\u5e94\u7684\u6570\u636e\u6e90\uff0c\u8bf7\u5148\u8fdb\u5165\u3010\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u3011\u5e94\u7528\u8fdb\u884c\u914d\u7f6e\u3002"))},
function(B,R){return 2215E3==B?(E.getMessageCurtain().showError(R),!0):2215006==B?(E.getMessageCurtain().showPrompt(m.get("noDataSourcePrompt","\u8be5\u9879\u76ee\u8fd8\u6ca1\u6709\u914d\u7f6e\u5bf9\u5e94\u7684\u6570\u636e\u6e90\uff0c\u8bf7\u5148\u8fdb\u5165\u3010\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u3011\u5e94\u7528\u8fdb\u884c\u914d\u7f6e\u3002")),!0):382011002==B?(E.getMessageCurtain().showPrompt(m.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),
2E3),!0):!1})).getDmoDatasourceInfo(u.getProjectId(),wa)},Y=function(I,B,R,ca){ua=[];V=null;Aa.setSelected(V);Aa.setItemModels(ua);(new h(b,function(ia){if(ia&&0<ia.length){for(var S=0;S<ia.length;S++){var oa=new da;oa.fromJsonObject(ia[S]);ua.push(oa)}Aa.setItemModels(ua);V=ua[0];Aa.setSelected(V);Aa.setCustomPainter(function(va,Ca,ya){ya?Ca.text(ya.getSchemaName()):Ca.text("")})}})).getSchemas(I,B,R,ca)},ra=function(I,B){if(!u)return B.showPrompt(m.get("chooseProject","\u8bf7\u9009\u62e9\u4e00\u4e2a\u9879\u76ee\u3002")),
!1;if(!wa)return B.showPrompt(m.get("chooseEntityType","\u8bf7\u9009\u62e9\u9879\u76ee\u4e0b\u7c7b\u578b\u3002")),!1;if("dw_model"==wa&&!K)return B.showPrompt(m.get("chooseDatasource","\u6570\u636e\u6e90\u4e0d\u80fd\u4e3a\u7a7a\u3002")),!1;if("dw_model"==wa&&K&&-1!=C.indexOf(K.getStorageTypeName())&&!V)return B.showPrompt(m.get("chooseSchema","\u8bf7\u9009\u62e9\u6570\u636e\u6e90\u7684\u6a21\u5f0f\u3002")),!1;I.setProjectId(u.getProjectId());I.setTableModelType(wa);return!0}}function fa(b){var l,
k;this.createStep=function(E,t,M,P,n){l=E.clone();k=new T(b,t);k.isShowDataBase(!1);k.setSource(l);k.setChangeSourceType(M);k.setOldEntity(P);k.setDModel(n);return k}}function pa(){q.call(this);var b=this,l=this.protectedMethod,k,E,t,M,P,n,Q,F,u,K,V,la,qa,ua=[],za=[],xa=[],Aa;this.setChangeSourceType=function(Z){Aa=Z};this.setSource=function(Z){t=Z};this.getSource=function(){return t};this.getSelectedProject=function(){return Q};this.getSelectedDataBasesource=function(){return u};this.getSelectedSchema=
function(){return V};this.propectedCreateJqUi=function(Z,Y,ra,I,B){k=Z;E=Y;M=I;t=ra;qa=B;P||Da();return P};this.getJqUi=function(){P||Da();return P};this.getJustForSelf=function(){return la.isChecked()};var Da=function(){P=$("<div>");var Z=0,Y=(new ea(m.get("project","\u9879\u76ee"))).getJqUi();H.layoutCtrl(Y,20,Z,70,23);P.append(Y);n=new na;Y=n.getJqUi();H.layoutCtrl(Y,70,Z,200,23);P.append(Y);Z+=40;var ra=(new ea(m.get("database","\u6570\u636e\u5e93"))).getJqUi();F=new na;var I=F.getJqUi();H.layoutCtrl(ra,
20,Z,70,23);P.append(ra);H.layoutCtrl(I,70,Z,200,23);P.append(I);Z+=40;var B=(new ea(m.get("dbschema","\u6a21\u5f0f"))).getJqUi();K=new na;K.addSelectedChangedListener(function(va,Ca,ya){V=ya});var R=K.getJqUi();H.layoutCtrl(B,20,Z,70,23);P.append(B);H.layoutCtrl(R,70,Z,200,23);P.append(R);ra.hide();I.hide();B.hide();R.hide();Z+=40;la=new sa;la.setText(m.get("actOnTheSameDatabase","\u540c\u65f6\u4fee\u6539\u5f53\u524d\u4e3b\u9898\u4e2d\u5176\u4ed6\u540c\u6e90\u6570\u636e\u8868"));la.setChecked(!Aa);
var ca=la.getJqUi();H.layoutCtrl(ca,20,40,250,23);P.append(ca);Z=new c;var ia=b.getConfirmListener();Z.setClosingAction(function(va){ia&&ia(va)});Z.setCloseCallerDialogCallback(function(){l.destroy()});Z.setChangeDataSourceParameter(k,E,M,qa,t);var S=Z.getJqUi();H.layoutCtrl(S,0,80,120,60);Aa||"dw_model"!=t.getTableModelType()||P.append(S);var oa=function(va){u=va;t.getTableModelType()==A?(V=null,ra.hide(),I.hide(),B.hide(),R.hide(),H.layoutCtrl(ca,20,40,250,23),H.layoutCtrl(S,0,80,120,60)):(ra.show(),
I.show(),-1!=C.indexOf(u.getStorageTypeName().toUpperCase())?(B.show(),R.show(),H.layoutCtrl(ca,20,120,250,23),H.layoutCtrl(S,0,160,120,60),Ja(Q.getProjectId(),u.getStorageId(),u.getStorageTypeName(),t.getName())):(V=null,B.hide(),R.hide(),H.layoutCtrl(ca,20,80,250,23),H.layoutCtrl(S,0,120,120,60)))};n.addSelectedChangedListener(function(va,Ca,ya){Q=ya;Ba(oa)});F.addSelectedChangedListener(function(va,Ca,ya){V=null;oa(ya)});wa(oa)},wa=function(Z){(new h(Ha(),function(Y){if(Y&&0<Y.length){for(var ra,
I=0;I<Y.length;I++){var B=new ma;B.fromJsonObject(Y[I]);ua.push(B);B.getProjectId()==t.getProjectId()&&(ra=B)}n.setItemModels(ua);Q=ra?ra:ua[0];n.setSelected(Q);n.setCustomPainter(function(R,ca,ia){ca.text(ia.getProjectName());ca.attr("title",ia.getProjectName())});Ba(Z)}else l.getMessageCurtain().showPrompt(m.get("noProjectPrompt","\u60a8\u8fd8\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u5e94\u7528\u7684\u9879\u76ee\u5173\u7cfb\uff0c\u8bf7\u5148\u8fdb\u5165[\u6570\u636e\u5f00\u53d1\u5e73\u53f0]\u914d\u7f6e\u76f8\u5173\u4fe1\u606f\u3002"))},
function(Y,ra){return 2215E3==Y?(l.getMessageCurtain().showError(ra),!0):2215006==Y?(l.getMessageCurtain().showPrompt(m.get("noProjectPrompt","\u60a8\u8fd8\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u5e94\u7528\u7684\u9879\u76ee\u5173\u7cfb\uff0c\u8bf7\u5148\u8fdb\u5165[\u6570\u636e\u5f00\u53d1\u5e73\u53f0]\u914d\u7f6e\u76f8\u5173\u4fe1\u606f\u3002")),!0):382011002==Y?(l.getMessageCurtain().showPrompt(m.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),
2E3),!0):!1})).getDmoProjectInfo()},Ba=function(Z){za=[];u=null;F.setSelected(u);F.setItemModels(za);t.getTableModelType()==A?Z&&Z(null):(new h(Ha(),function(Y){if(Y&&0<Y.length){for(var ra,I=0;I<Y.length;I++){var B=new ja;B.fromJsonObject(Y[I]);za.push(B);t.getStorageId()==B.getStorageId()&&(ra=B)}F.setItemModels(za);u=ra?ra:za[0];F.setSelected(u);F.setCustomPainter(function(R,ca,ia){ia?(ca.text(ia.getStorageName()),ca.attr("title",ia.getStorageName())):ca.text("")});Z&&Z(u)}else l.getMessageCurtain().showPrompt(m.get("noDataSourcePrompt",
"\u8be5\u9879\u76ee\u8fd8\u6ca1\u6709\u914d\u7f6e\u5bf9\u5e94\u7684\u6570\u636e\u6e90\uff0c\u8bf7\u5148\u8fdb\u53bb\u3010\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u3011\u8fdb\u884c\u914d\u7f6e\u3002"))},function(Y,ra){return 2215E3==Y?(l.getMessageCurtain().showError(ra),!0):2215006==Y?(l.getMessageCurtain().showPrompt(m.get("noDataSourcePrompt","\u8be5\u9879\u76ee\u8fd8\u6ca1\u6709\u914d\u7f6e\u5bf9\u5e94\u7684\u6570\u636e\u6e90\uff0c\u8bf7\u5148\u8fdb\u53bb\u3010\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u3011\u8fdb\u884c\u914d\u7f6e\u3002")),
!0):382011002==Y?(l.getMessageCurtain().showPrompt(m.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),2E3),!0):!1})).getDmoDatasourceInfo(Q.getProjectId(),"dm_model")},Ja=function(Z,Y,ra,I){xa=[];V=null;K.setSelected(V);K.setItemModels(xa);(new h(Ha(),function(B){if(B&&0<B.length){for(var R,ca=0;ca<B.length;ca++){var ia=new da;ia.fromJsonObject(B[ca]);xa.push(ia);t.getSchema()==ia.getSchemaName()&&
(R=ia)}K.setItemModels(xa);V=R?R:xa[0];K.setSelected(V);K.setCustomPainter(function(S,oa,va){va?oa.text(va.getSchemaName()):oa.text("")})}})).getSchemas(Z,Y,ra,I)},Ha=function(){var Z=new X,Y=(new com.kingdee.bos.qing.data.DataModelingScene).getUrlParam("path");Z.setRemoteUrl((Y?Y:"/ierp")+"/qing/dataModeling.do");return Z};this.protectedIsValidToAccepted=function(Z){Z(!0)};this.protectedAccepted=function(Z,Y){var ra=!la.isChecked(),I=t.clone();I.setProjectId(Q.getProjectId());"dw_model"==t.getTableModelType()&&
(I.setStorageId(u.getStorageId()),I.setStorageTypeName(u.getStorageTypeName()));V&&"dw_model"==t.getTableModelType()?I.setSchema(V.getSchemaName()):I.setSchema(null);if(ra){if(!I.isTheSame(Y)){Z.getName();var B=k.getSources();Z.setSource(I);Z.mergeSource(B);k.funClearUserSqlsAndStoredProcedures(Y)}b.refreshDesigntimeDataObject(E,I,M)}else for(B in Y.setProjectId(Q.getProjectId()),"dw_model"==t.getTableModelType()&&(Y.setStorageId(u.getStorageId()),Y.setStorageTypeName(u.getStorageTypeName())),V&&
"dw_model"==t.getTableModelType()?Y.setSchema(V.getSchemaName()):Y.setSchema(null),b.refreshDesigntimeDataObject(E,E.getSource(),M),Z=k.getAllEntity(),Z)Y=Z[B],Y.isUnion()||E.getSource().isTheSame(Y.getSource())&&E.getName()!==Y.getName()&&b.refreshDesigntimeDataObject(Y,E.getSource(),M)}}function X(){ha.call(this);var b;this.getRemoteUrl=function(){return b};this.setRemoteUrl=function(l){b=l}}function ma(){var b,l;this.setProjectId=function(k){b=k};this.getProjectId=function(){return b};this.getProjectName=
function(){return l};this.setProjectName=function(k){l=k};this.fromJsonObject=function(k){b=k.projectId;l=k.projectName};this.toJsonObject=function(){var k={};k.projectId=b;k.projectName=l;return k}}function ja(){var b,l,k;this.setStorageId=function(E){b=E};this.getStorageId=function(){return b};this.getStorageTypeName=function(){return l};this.setStorageTypeName=function(E){l=E};this.getStorageName=function(){return k};this.setStorageName=function(E){k=E};this.fromJsonObject=function(E){b=E.storageId;
l=E.storageTypeName;k=E.storageName};this.toJsonObject=function(){var E={};E.storageId=b;E.storageTypeName=l;E.storageName=k;return E}}function da(){var b;this.setSchemaName=function(l){b=l};this.getSchemaName=function(){return b};this.fromJsonObject=function(l){b=l.schemaName};this.toJsonObject=function(){var l={};l.schemaName=b;return l}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&
(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var O=com.kingdee.bos.qing.scene;O.ERPCloudDmoSource=v;O.DmoFacade=h;var aa,H,G,z,m,ha,ea,na,U,ba,sa,ka,ta,y,N,r,q,J,f,a,g,w,c,d,x,p,e;(function(){var b=com.kingdee.bos.qing;aa=b.CodeLoader;b=com.kingdee.bos.qing.common;H=b.DomUtil;b=com.kingdee.bos.qing.framework.common;G=b.AbstractFacade;ha=b.AbstractRemoteCall;z=b.IconsFile;m=b.MultilanguageManager.createPackageAccessor(O);b=com.kingdee.bos.qing.ui.component;
ea=b.Label;na=b.ComboBox;U=b.RadioButtonGroup;ba=b.RadioButton;sa=b.CheckBox;b=com.kingdee.bos.qing.data;ka=b.SourceType;ta=b.Icons;y=b.AbstractBizMetaSource;c=b.AdvancedSettingPane;N=b.MetaDBConnectionStep;q=b.AbstractSourceModifyingEditor;J=b.DbSelectTableStep;f=b.DbSelectFieldStep;a=b.DataFieldRelationSetStep;g=b.DbSelectTable4MergeStep;w=b.AbstractSource;d=b.DBSource;x=b.DBMergeCustomSqlStep;p=b.SourceChangeHelper;e=b.UserSqlObj;c=b.AdvancedSettingPane;r=O.DataModellingContext})();var C=["POSTGRESQL",
"ORACLE"],A="tag_model";v.DMO="ERPCloudDmo";var D=function(b,l,k,E){(new h(b,function(t){t?k():(l.showPrompt(m.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),2E3),E())},function(t){if(2215013==t)return l.showPrompt(m.get("noDmoConfig","\u60a8\u5c1a\u672a\u914d\u7f6e\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u5e94\u7528\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u914d\u7f6e\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u5e94\u7528\u3002"),
2E3),!0;if(382011002==t)return l.showPrompt(m.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),2E3),!0;E();return!1})).checkDmoPermission()};r.addSourceType(function(b){b(new ka(v.DMO,m.get("dmo","\u6570\u636e\u5f00\u53d1\u5e73\u53f0"),"source_ERPCloudDmo",v),W,L,D,null,null,pa)})})();(function(){function h(f,a,g,w){O.call(this,f,a,g,w);var c=this.protectedMethod;this.checkERPCloudMDDPermission=function(){c.remote("checkERPCloudMDDPermission",{})}}function v(){sa.call(this);var f,a;this.getShortDisplay=function(){return H.get("ERPCloudMDD","\u91d1\u8776\u591a\u7ef4\u6570\u636e\u5e93")};this.isModifiable=function(){return!1};this.isSupportSelectField=function(){return!1};this.isSupportCustomField=function(){return!1};this.getEntityIconName=function(g){return"table"};this.setSourceId=
function(g){f=g};this.getSourceId=function(){return f};this.setSourceDisplayName=function(g){a=g};this.getSourceDisplayName=function(){return a};this.protectedToJsonObject=function(g){g.sourceId=f;g.sourceDisplayName=a};this.protectedFromJsonObject=function(g){f=g.sourceId;a=g.sourceDisplayName}}function L(f,a,g,w){(new h(f,function(c){c?g():(a.showPrompt(H.get("noERPCloudMDDPermission","\u6ca1\u6709\u91d1\u8776\u591a\u7ef4\u5e93\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002"),
2E3),w())},function(c){w();return!1})).checkERPCloudMDDPermission()}function W(){var f=da.getSkinName(),a=new aa;a.setFilePath("scene/skin/"+f+"/res/dm-impl.png");a.setStartPosition(1,1);a.setIconSize(16,16);a.setStartPosition(1,69);a.setIconSize(90,45);f=a.createDescription(1,0);ba.regist("source_ERPCloudMDD",f)}function T(f,a,g){if(0!=f.getEntityCount()){if(v.ERPCloudMDD==a)return g.showPrompt(H.get("ERPCloudMDDOneEntityLimit","\u5f53\u524d\u4e3b\u9898\u5b58\u5728\u5176\u4ed6\u7684\u6570\u636e\u8868\uff0c\u4e0d\u5141\u8bb8\u5f15\u5165\u91d1\u8776\u591a\u7ef4\u5e93\u6570\u636e\u8868\u3002")),
!0;f=f.getSources();for(a=0;a<f.length;a++)if(v.ERPCloudMDD==f[a].getTypeName())return g.showPrompt(H.get("ERPCloudMDDExistLimit","\u5f53\u524d\u4e3b\u9898\u5b58\u57281\u4e2a\u91d1\u8776\u591a\u7ef4\u5e93\u6570\u636e\u8868, \u4e0d\u5141\u8bb8\u5f15\u5165\u5176\u4ed6\u7684\u6570\u636e\u8868\u3002")),!0}return!1}function fa(f,a,g,w,c,d,x,p){g||(g=new v,g.setName("s"+(new Date).getTime()),g.setTypeName(a));f=new pa;f.setSource(g);return[f]}function pa(){ka.call(this);var f=this,a=this.protectedMethod,
g,w,c=null,d=null,x=null,p={},e=null,C,A;this.isLastStep=function(){return!0};this.getSubTitle=function(){return H.get("ERPCloudMDD","\u91d1\u8776\u591a\u7ef4\u6570\u636e\u5e93")};this.protectedCreateUi=function(){var F=$("<div>"),u=(new m(H.get("ERPCloudMDDApp","\u5e94\u7528"))).getJqUi();g=new z;g.addSelectedChangedListener(b);g.setCustomPainter(D);var K=g.getJqUi();G.layoutCtrl(u,15,0,75,23);G.layoutCtrl(K,75,0,200,23);F.append(u);F.append(K);u=(new m(H.get("ERPCloudMDDsystem","\u4f53\u7cfb"))).getJqUi();
_oCubeDropdownSelector=new ha;_oCubeDropdownSelector.setCustomPainter(k);_oCubeDropdownSelector.setDropdownCreator(E);_oCubeDropdownSelector.addSelectionListener(P);K=_oCubeDropdownSelector.getJqUi();G.layoutCtrl(u,420,0,75,23);G.layoutCtrl(K,480,0,200,23);F.append(u);F.append(K);u=new m(H.get("ERPCloudMDDMemberRange","\u6210\u5458\u8303\u56f4"));w=new X;w.setFunGetCurrentEntity(function(){return x});K=w.getJqUi();A=$("<div>");A.css("box-shadow","0px 0px 2px 0px #dbdbdb");C=u.getJqUi();G.layoutCtrl(C,
15,40,90,23);G.layoutCtrlWithLRTB(A,15,15,null,76,2,null);A.append(K);F.append(C);F.append(A);C.hide();A.hide();return F};var D=function(F,u,K){K?u.text(K.getDisplayName()):u.text(H.get("selectApp","\u8bf7\u9009\u62e9\u5e94\u7528"))},b=function(F,u,K){c=K;F=f.getSource();F.setSourceId(c.getName());F.setSourceDisplayName(c.getDisplayName());l()},l=function(){d=e=null;_oCubeDropdownSelector.setSelectedModel(null);var F=f.getSource().toJsonObject();f.getCtxApi().createFacade(function(u){var K=new r;
K.fromJsonObject(u);u=new na.BranchNode(K);u.setExpanded(!0);M(u,K);e=u},function(u,K){return!1}).getUsableEntities(F)},k=function(F,u){F?u.text(F.getDisplayName()):u.text(H.get("selectCube","\u8bf7\u9009\u62e9\u4f53\u7cfb"))},E=function(F,u,K){if(!e)return[-1,40];var V=0;e.visiting(function(){V++;return 10<V?!0:!1});u=new na;var la=u.getJqUi();la.css("background","#ffffff");var qa=u.getLineHeight()*(V-1)+3;G.layoutCtrlWithLRTB(la,0,0,null,0,0,null);u.addSelectedListener(function(ua){ua=ua.getSelecteds();
0<ua.length&&(d=ua[0],ua=d.getUserObject(),K(ua))});u.setNodePainter(t);u.setRootVisible(!1);u.setRoot(e);u.setSelecteds(d?[d]:null);la.appendTo(F);return[-1,qa]},t=function(F,u){F.css("padding-left","4px");F.css("padding-right","4px");F.text(u.getUserObject().getDisplayName())},M=function(F,u){if(u=u.getChildren())for(var K=0;K<u.length;K++){var V=u[K];if(V instanceof r){var la=new na.BranchNode(V);la.setExpanded(!0);la.setSelectable(!1);M(la,V)}else la=new na.LeafNode(V);F.addChild(la)}},P=function(F,
u){if(F=F.getSelectedModel()){u=c.getName();var K=p[u];K||(K={},p[u]=K);var V=F.getName();if(F=K[V])n(F);else{F=f.getSource();var la={};la[F.getName()]=F;F=F.toJsonObject();f.getCtxApi().createFacade(function(qa){var ua=new q;ua.fromJsonObject(qa,la);qa=ua.getEntityByAssociateName(V);K[V]=qa;n(qa)},function(qa,ua){return!1}).getDesigntimeDataObject(F,V)}}else n(null)},n=function(F){null!=F?(C.show(),A.show()):(C.hide(),A.hide());x=F;w.updateUi(x)};this.intoThisStep=function(F,u){u||Q()};var Q=function(){var F=
f.getSource().toJsonObject();f.getCtxApi().createFacade(function(u){var K=[];if(u)for(var V=0;V<u.length;V++){var la=u[V],qa=new N;qa.fromJson(la);K.push(qa)}g.setItemModels(K)},function(u,K){return!1}).getCatlog(F)};this.outThisStep=function(F,u){F?u(null):c?d?u(null):a.getMessageCurtain().showPrompt(H.get("selectCubeCurtain","\u8bf7\u9009\u62e9\u4f53\u7cfb\u3002"),2E3):a.getMessageCurtain().showPrompt(H.get("selectAppCurtain","\u8bf7\u9009\u62e9\u5e94\u7528\u3002"),2E3)};this.over=function(F){F&&
f.getCtxApi().finish([x],[])}}function X(){ta.call(this);var f=this.protectedMethod,a;this.protectedInit=function(){a=$("<div>");G.layoutCtrlWithLRTB(a,0,0,null,0,0,null);a.css("overflow","auto");return a};this.updateUi=function(g){a.empty();if(g){var w=g.getFilters(),c={};if(w)for(var d=0;d<w.length;d++){var x=w[d],p=x.getProperty().getName();c[p]=x}w=g.getParild();p=20;for(d=0;d<w.length;d++){var e=w[d];x=e.getIdFieldName();x=c[x];var C=g,A=new ma;A.setModel(C,e,x);A.setCheckError(f.checkError);
A.setFirePreviewRefreshWithOnlyRepaint(f.firePreviewRefreshWithOnlyRepaint);x=A.getJqUi();0==d%3?G.layoutCtrl(x,5,p,250,66):1==d%3?G.layoutCtrl(x,322,p,250,66):(G.layoutCtrl(x,639,p,250,66),p+=66);a.append(x)}}};this.afterResize=function(){};this.locateToErrorRow=function(g,w){}}function ma(){var f,a,g,w,c,d,x;this.getJqUi=function(){if(!f){f=$("<div>");a=new m;var b=a.getJqUi();G.layoutCtrl(b,15,0,230,23);f.append(b);g=new ea;g.setClearable(!0);g.setCustomPainter(e);g.addActionListener(C);g.addClearListener(A);
b=g.getJqUi();G.layoutCtrl(b,15,23,230,23);f.append(b)}p();return f};this.setModel=function(b,l,k){w=b;c=l;d=k;p()};this.setCheckError=function(b){x=b};this.setFirePreviewRefreshWithOnlyRepaint=function(b){_funFirePreviewRefreshWithOnlyRepaint=b};var p=function(){if(f){c&&a.setText(c.getAlias());var b=null;d&&(b=JSON.parse(d.getValue()));g.setModel(b)}},e=function(b,l){b=b?b.text:"";l&&l.text(b);return b},C=function(b){var l=w.getSource().getSourceId(),k=w.getAssociateName(),E=c.getAssociateName(),
t=null;(b=b.getModel())&&(t=b.value);b=com.kingdee.bos.qing.integration.ERPCloudMDDParildFilterChooseForm;b.setCallBack(D);b.openERPCloudMDDParildFilterChooseForm(l,k,E,t)},A=function(){for(var b=0,l=w.getFilters(),k=0;k<l.length;k++){var E=l[k];if(c.getIdField().getName()==E.getProperty().getName()){b=k;break}}b==l.length-1&&0<=b-1&&l[b-1].setLogicOp(null);l.splice(b,1);d=null;g.setModel(null);x&&x();_funFirePreviewRefreshWithOnlyRepaint&&_funFirePreviewRefreshWithOnlyRepaint(!1)},D=function(b){var l=
b.content;b=null;l&&l.text&&(b={},b.text=l.text,b.value=l.value);b?(d||(d=new y,d.setProperty(c.getIdField()),d.setCompareType(y.COMPARE_WITH_APPOINTED),d.setCompareOp(y.COMPARE_CUSTOM_VARIABALE),d.setValueMode(y.MODE_SYS_VAR),d.setRelativeDateRange(null),l=w.getFilters(),0<l.length&&l[l.length-1].setLogicOp(y.LOGIC_AND),l.push(d)),d.setValue(JSON.stringify(b)),g.setModel(b)):A();x&&x();_funFirePreviewRefreshWithOnlyRepaint&&_funFirePreviewRefreshWithOnlyRepaint(!1)}}"undefined"==typeof com&&(com=
{});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var ja=com.kingdee.bos.qing.scene,da,O,aa,H,G,z,m,ha,ea,na,U,ba,sa,ka,ta,y,N,r,q,J;(function(){var f=com.kingdee.bos.qing;da=f.CodeLoader;f=com.kingdee.bos.qing.framework.common;O=f.AbstractFacade;aa=f.IconsFile;H=f.MultilanguageManager.createPackageAccessor(ja);
f=com.kingdee.bos.qing.common;G=f.DomUtil;f=com.kingdee.bos.qing.ui.component;z=f.ComboBox;m=f.Label;ha=f.DropdownSelector;ea=f.F7Selector;na=f.Tree;f=com.kingdee.bos.qing.data;U=f.SourceType;ba=f.Icons;sa=f.AbstractBizMetaSource;ka=f.AbstractImportEntityStep;ta=f.AbstractFilterUIRender;y=f.FilterItem;N=f.NameVO;r=f.FolderNode;q=f.DesigntimeDataObject;J=ja.DataModellingContext})();v.ERPCloudMDD="ERPCloudMDD";J.addSourceType(function(f){f(new U(v.ERPCloudMDD,H.get("ERPCloudMDD","\u91d1\u8776\u591a\u7ef4\u6570\u636e\u5e93"),
"source_ERPCloudMDD",v,!1),W,fa,L,T,X)})})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var h=com.kingdee.bos.qing.scene,v,L,W,T,fa,pa;(function(){var X=com.kingdee.bos.qing.framework.common;v=X.MultilanguageManager.createPackageAccessor(h);L=X.TabbedUiUtil;X=com.kingdee.bos.qing.ui.component;
W=X.MessageCurtain;X=com.kingdee.bos.qing.data;T=X.DataModelingScene;fa=h.SubjectModelingFacade;pa=h.DataModellingContext})();h.ERPDataModelingScene=function(){T.call(this);var X=this,ma=X.getUrlParam("themeID"),ja=X.getUrlParam("path"),da="true"==X.getUrlParam("isPreset"),O;this.protectedGetRemoteUrl=function(){return(ja?ja:"/ierp")+"/qing/dataModeling.do"};this.protectedImportMoreCode=function(G){G.loadJs("env.js");G.loadJs("db-manage/qing-db-manage.js");G.loadJs("macro/qing-macro-runtime.js");
G.loadI18n("macro","macro");G.loadSkinCss("macro","qing-macro");G.loadSkinJs("macro","skin")};this.protectedCustomInitEnv=function(){com.kingdee.bos.qing.integration.TabStatusHelper.setMyI18n(v.get("confirmExit","\u68c0\u6d4b\u5230\u60a8\u6709\u66f4\u6539\u5185\u5bb9\uff0c\u662f\u5426\u4e0d\u4fdd\u5b58\u76f4\u63a5\u9000\u51fa\uff1f\u82e5\u4e0d\u4fdd\u5b58\uff0c\u5c06\u4e22\u5931\u8fd9\u4e9b\u66f4\u6539\u3002"),v.get("sureExit","\u76f4\u63a5\u9000\u51fa"),v.get("sureReturn","\u8fd4\u56de\u7f16\u8f91"));
pa.init(X.getRemoteImpl());var G=com.kingdee.bos.qing.behavior.BehaviorManager;G.interestInBehaviorEntrance(G.ENTRANCE_DATA_MODELING);H();G=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");var z=(G?G:"/ierp")+"/qing/macroManage.do";G=new com.kingdee.bos.qing.macro.RemoteImpl;G.setRemoteUrl(z);z=com.kingdee.bos.qing.macro.MacroVarHelper;z.setRemoteImpl(G);G=com.kingdee.bos.qing.data.VariateHelperFactory;G.registImpl(G.MACRO_VAR_HELPER,z);G=com.kingdee.bos.qing.data.ProductLineEnvironment;
G.setEnvironment(G.COSMIC)};this.protectedCustomInitDesigner=function(G){G.getConductor().setDirtyListener(function(m){com.kingdee.bos.qing.integration.TabStatusHelper.setTabStatus(m)});da?(O||(O=new W,O.getJqUi().appendTo($(document.body))),O.showPrompt(v.get("presetDMTips","\u9884\u7f6e\u7684\u4e3b\u9898\u4e0d\u5141\u8bb8\u4fdd\u5b58\uff0c\u5982\u6709\u9700\u8981\uff0c\u53ef\u590d\u5236\u540e\u518d\u8fdb\u884c\u64cd\u4f5c\u3002"),5E3)):G.getConductor().insertToolbarButton(function(m){(m=G.getJsonModel())&&
aa(G,m)},"btn_save",v.get("save","\u4fdd\u5b58"));var z=v.get("closeTab","\u9000\u51fa");G.getConductor().appendToolbarButton(function(){G.getConductor().isDirty()?com.kingdee.bos.qing.integration.TabStatusHelper.showConfirmExitDialog():L.closeCurrentTab()},"error_close",z)};this.protectedLoadingImpl=function(G,z,m){(new fa(G,function(ha){ha?(z.setJsonModel(ha),m(!0)):(z.setJsonModel(null),m(!1))},function(ha,ea){return 1030001==ha?(com.kingdee.bos.qing.framework.common.RemoteFramework.openErrorPage(ha,
com.kingdee.bos.qing.common.Base64Util.encode(encodeURIComponent(ea))),!0):!1})).loadModel(ma)};var aa=function(G,z){(new fa(X.getRemoteImpl(),function(m){G.saveAfterRefreshUploadTypeSource(m);G.getConductor().clearDirty();G.getConductor().getMessageCurtain().showSuccess(v.get("saveSuccess","\u4fdd\u5b58\u6210\u529f\u3002"))},function(m,ha){if(1000006==m)return G.getConductor().getMessageCurtain().showPrompt(ha,2E3),!0;if(2010001==m)return G.getConductor().getMessageCurtain().showPrompt(v.get("themeHasBeenDeletedCurtain",
"\u5bf9\u5e94\u4e3b\u9898\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),2E3),!0;if(2010002==m)return G.getConductor().getMessageCurtain().showPrompt(v.get("resourceFileLimit","\u4fdd\u5b58\u5931\u8d25\uff0c\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\u3002"),2E3),!0;if(2010003==m)return G.getConductor().getMessageCurtain().showPrompt(v.get("noOperationPermissionsCurtain","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),!0})).saveModel(ma,z)},H=function(){var G=com.kingdee.bos.qing.macro.MacroVarSelector;
com.kingdee.bos.qing.data.MacroVariateSelectorRegister.registerConstructor(com.kingdee.bos.qing.macro.MacroVarSelector);var z=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");z=(z?z:"/ierp")+"/qing/macroManage.do";var m=new com.kingdee.bos.qing.macro.RemoteImpl;m.setRemoteUrl(z);G.registerRemoteImpl(m);com.kingdee.bos.qing.dbmanage.BizMetaSourceCreatorRegister.setCreator(new function(){this.createBizMetaSource=function(ha){var ea=null;ha.bizMetaType==h.ERPCloudDBCenterSource.DBCENTER?
(ea=new h.ERPCloudDBCenterSource,ea.fromJsonObject(ha)):ha.bizMetaType==h.SuperQuerySource.ENTITY&&(ea=new h.SuperQuerySource,ea.fromJsonObject(ha));return ea}})}}})();
//qingVersionTag: 20250324