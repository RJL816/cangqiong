(function(){function aa(){D.call(this)}function D(){var a,d=this,e,f,g,k,h,c,b=com.kingdee.bos.qing.common.Util;this.show=function(n){p().appendTo(n);c||(c=$("<div>"),z.layoutCtrlWithLRTB(c,0,0,null,0,0,null),c.css({"z-index":"-1",background:"#fff"}));c.appendTo(n)};var p=function(){a||(a=$("<div class='sa-qing-publish-card-main'>"),g=$("<div class='sa-qing-publish-card-head'>"),(e=b.decodeParamFromUrl(location.search,"cardName"))||(e=" "),f=$("<div class='sa-qing-publish-card-title sa-qing-publish-fontfamily'>"),
e=com.kingdee.bos.qing.common.Base64Util.decode(e),f.text(e),f.attr("title",e),f.appendTo(g),k=$("<div>"),k.addClass("sa-qing-publish-card-content"),k.appendTo(a),d.protectedCustomContent(k),d.protectedCustomHead(g),g.appendTo(a));return a};this.protectedCustomHead=function(n){};this.protectedCustomContent=function(n){};var m=function(n,l,q){return b.appendParamToUrl(n,l,q)};this.protectedMethod={getTitleUi:function(){return f},getTitle:function(){return e},getContentUi:function(){return k},getUrlParam:function(n){return b.decodeParamFromUrl(location.search,
n)},appendUrlParam:m,appendAccountIdParam:function(n){var l=K.getUrlParamValue("kdcdc");l&&(n=m(n,"kdcdc",l));return n},getMainUi:p,appendOperateBtnUI:function(n){for(var l=5,q=0,t=n.length;q<t;q++)n[q].css({position:"absolute",top:"5px",right:l+"px"}),l+=35,g.append(n[q])},insertOperateBtnUI:function(n){for(var l=0,q=n.length;l<q;l++)n[l].css({position:"relative","margin-right":"10px",display:"inline-block"}),n[l].insertBefore(f)},insertExtraOperateBtn:function(n){if(!h){h=$("<div>");a.append(h);
var l=g.height();z.layoutCtrlWithLRTB(h,0,0,null,l,null,44);h.hide()}l=20;for(var q=0,t=n.length;q<t;q++){var v=n[q].getJqUi();z.layoutCtrlWithLRTB(v,null,l,80,0,null,16);z.layoutCtrlMiddleAlign(v,16);h.append(v);v=$("<div>");v.addClass("sa-qing-publish-card-extraicon-border");h.append(v);z.layoutCtrlWithLRTB(v,null,l,0,0,null,24);z.layoutCtrlMiddleAlign(v,24);l+=90}},showExtraOperateContainer:function(){if(h){h.show();var n=h[0].offsetTop,l=h.height();k.css("top",n+l+"px");$(window).trigger("resize")}},
hideExtraOperateContainer:function(){h&&(k.css("top",g.height()+"px"),h.hide(),$(window).trigger("resize"))}}}function E(a,d,e){var f=a,g=d,k,h,c;this.getJqUi=function(){k||(k=$("<div>"),h=$("<div>"),h.addClass("sa-qing-publish-card-icon"),r.Icons.background(h,g),c=$("<div>"),c.addClass("sa-qing-publish-card-extraicon-text"),c.text(f),z.layoutCtrl(h,0,0,16,16),z.layoutCtrl(c,21,0,60,16),k.append(h),k.append(c),k.on("click",e));return k};this.changeIcon=function(b){g=b;r.Icons.background(h,g)};this.changeName=
function(b){f=b;c.text(f)}}function L(){D.call(this);var a=this.protectedMethod,d=this,e,f=new M;this.protectedCustomContent=function(c){e=new A;e.setSchemaLoadCallback(k);e.show(c)};this.protectedCustomHead=function(c){g()};this.protectedOpenSquare=function(){throw Error("override me");};this.protectedOpenAnalysis=function(){throw Error("override me");};this.protectedGetRefreshUrl=function(){throw Error("override me");};var g=function(){var c=$("<div class='sa-qing-publish-card-icon'>"),b=$("<div class='sa-qing-publish-card-icon'>"),
p=$("<div class = 'sa-qing-publish-card-icon'>"),m=$("<div class= 'sa-qing-publish-card-icon'>");b.on("click",function(){var l=a.getMainUi();e.checkOperatePermAndPrompt(l,A.PERM_TYPE_ENTER_SQUARE)&&d.protectedOpenSquare()});r.Icons.background(b,"btn-edit");b.on("mouseover",function(l){r.Icons.background(b,"btn-edit-on")});b.on("mouseout",function(l){r.Icons.background(b,"btn-edit")});b.attr("title",y.get("squareIntoDesigner","\u8fdb\u5165\u8bbe\u8ba1\u5668\u4e2a\u6027\u5316\u4fee\u6539"));c.on("click",
function(){var l=a.getMainUi();e.checkOperatePermAndPrompt(l,A.PERM_TYPE_ENTER_ANALYSIS)&&d.protectedOpenAnalysis()});r.Icons.background(c,"btn-analysis");c.on("mouseover",function(l){r.Icons.background(c,"btn-analysis-on")});c.on("mouseout",function(l){r.Icons.background(c,"btn-analysis")});c.attr("title",y.get("squareOpenAnalysis","\u6253\u5f00\u201c\u6570\u636e\u5206\u6790\u201d\u5de5\u5177"));p.on("click",h);r.Icons.background(p,"btn-refresh");p.on("mouseover",function(l){r.Icons.background(p,
"btn-refresh-on")});p.on("mouseout",function(l){r.Icons.background(p,"btn-refresh")});p.attr("title",y.get("cardRefresh","\u5237\u65b0"));m.on("click",function(){e.showExtraFilter(a.getMainUi())});r.Icons.background(m,"btn-filter");m.on("mouseover",function(l){r.Icons.background(m,"btn-filter-on")});m.on("mouseout",function(l){r.Icons.background(m,"btn-filter")});m.attr("title",y.get("cardFilter","\u8fc7\u6ee4\u6761\u4ef6"));m.hide();f.addIconUi(b);f.addIconUi(c);f.addIconUi(p);var n=f.getJqUi();
f.hide();$(document.body).on("mouseenter",function(){m.show();f.show()});$(document.body).on("mouseleave",function(){m.hide();f.hide()});a.appendOperateBtnUI([n,m])},k=function(){var c=new N;c.setDesc(e.getDescription());c.show(a.getMainUi(),a.getTitleUi())},h=function(){var c=d.protectedGetRefreshUrl();window.location.href=c};this.protectedMethod.reExcuteCard=h;this.protectedMethod.applyExternalFilter=function(c){e&&e.applyExternalFilter(c.getExternalFilterItem())};this.protectedMethod.setFilteringListener=
function(c){e&&e.setFilteringListener(c)}}function O(){D.call(this);var a=this.protectedMethod,d;this.protectedCustomContent=function(g){d||(d=new ba,d.setSchemaLoadCallback(e),d.setDrawLegendCallback(function(){g.css("bottom","42px")}));d.show(g)};var e=function(){f()},f=function(){var g=new N;g.setDesc(d.getDescription());g.setShowOnlyMouseOn(!1);g.show(a.getMainUi(),a.getTitleUi());$(document.body).on("touchmove scroll",function(){g.hideTips()})};this.protectedMethod.getSquareExhibition=function(){return d}}
function ca(){L.call(this);var a=this.protectedMethod;this.protectedOpenSquare=function(){var d=a.getUrlParam("pageId");if(top.window.invokeCustomEvent){var e={tag:a.getUrlParam("tag"),cardName:a.getTitle()};top.window.invokeCustomEvent(d,"",["QingCard","openSquare",JSON.stringify(e)])}};this.protectedOpenAnalysis=function(){var d=a.getUrlParam("pageId");if(top.window.invokeCustomEvent){var e={tag:a.getUrlParam("tag"),cardName:a.getTitle()};top.window.invokeCustomEvent(d,"",["QingCard","openAnalysis",
JSON.stringify(e)])}};this.protectedGetRefreshUrl=function(){var d=a.getUrlParam("pageId"),e=a.getUrlParam("skin"),f=a.getUrlParam("language"),g=a.getTitle(),k=a.getUrlParam("schemaAdditionalTag"),h=a.getUrlParam("bizTag"),c=a.getUrlParam("path");c=a.appendAccountIdParam((c?c:"/ierp")+"/qing/cardEntrance.do");h&&(c=a.appendUrlParam(c,"publishId",h));k&&(c=a.appendUrlParam(c,"cardId",k));g&&(c=a.appendUrlParam(c,"cardName",g));d&&(c=a.appendUrlParam(c,"pageId",d));e&&(c=a.appendUrlParam(c,"skin",e));
f&&(c=a.appendUrlParam(c,"language",f));return c}}function G(a,d,e,f){P.call(this,a,d,e,f);var g=this.protectedMethod;this.loadSquareSchema=function(k,h,c){g.remote("loadSquareSchema",{publishId:k,bizTag:h,schemaAdditionalTag:c})};this.loadSquareSchemaWithOper=function(k,h,c){g.remote("loadSquareSchemaWithOper",{publishId:k,bizTag:h,schemaAdditionalTag:c})};this.loadNocodeCardSchema=function(k){g.remote("loadNocodeCardSchema",{cardId:k})}}function M(){var a,d=[],e,f,g;this.setParent=function(b){g=
b};this.getJqUi=function(){a=$("<div class='sa-qing-publish-card-showmoreicon'>");a.on("click",k);r.Icons.background(a,"btn-more");a.on("mouseover",function(b){r.Icons.background(a,"btn-more-on")});a.on("mouseout",function(b){r.Icons.background(a,"btn-more")});a.attr("title",y.get("cardMoreOperate","\u66f4\u591a"));return a};this.addIconUi=function(b){d.push(b)};this.show=function(){a&&a.show()};this.hide=function(){a&&a.hide();h()};var k=function(){if(e)e.is(":hidden")?e&&(e.show(),f.show()):h();
else{e=$("<div class='sa-qing-publish-card-iconcontainer'>");for(var b=0,p=d.length;b<p;b++){var m=d[b];m.addClass("sa-qing-public-card-iconimplicit");e.append(m)}b=a.position().top;p=a.height();e.css({top:p+b+12+"px",right:0});g?e.appendTo(g):e.appendTo($(document.body));c();$(document.body).on("click",function(n){$(n.target).hasClass("sa-qing-publish-card-showmoreicon")||h()})}},h=function(){e&&(e.hide(),f.hide())},c=function(){var b=11*Math.pow(2,.5),p=a.position().left+a.width()/2,m=e.position(),
n=m.left,l=m.top,q=e.width();m=b/2;p=Math.min(p-b/2,n+q-b);f=$("<div class='sa-qing-public-card-container'>");n=l-(parseInt(9/Math.pow(2,.5))+1);f.css({width:b+"px",height:m+"px",top:n+"px",left:p+"px"});b=$("<div class='sa-qing-public-card-arrow'>");b.css({width:"9px",height:"9px",top:m-4.5-1+"px",left:"50%","margin-left":"-4.5px"});b.appendTo(f);g?f.appendTo(g):f.appendTo($(document.body))}}function H(){Q.call(this);var a;this.getRemoteUrl=function(d){return a};this.setRemoteUrl=function(d){a=d}}
function R(){com.kingdee.bos.qing.AbstractSquareIframeScene.call(this);var a=this,d=this.protectedMethod,e,f,g;this.setSchemaContent=function(b){e=b};this.setSchemaLoadCallback=function(b){g=b};this.applyExternalFilter=function(b){var p=d.copyFilters();if(p&&b)for(var m=b.getFieldName(),n=0;n<p.length;n++){var l=p[n];if(l.getAssociatedField().getText()==m){k(p,l,b);break}}};this.hasShowFilter=function(){try{var b=d.copyFilters()}catch(n){return!1}if(0==b.length)return!1;for(var p=!1,m=0;m<b.length;m++)if(b[m].isOnShow()){p=
!0;break}return p};var k=function(b,p,m){p.getPreparedModel()?h(b,p,m):d.updateFilterPreparedValue(b,p,function(n){n&&h(b,p,m)})},h=function(b,p,m){S.applyFilter(p,m);d.filtering(b)};this.protectedLoadingImpl=function(b){e?(b(e),g&&g()):c(function(){b(e);g&&g()})};this.protectedGetRemoteUrl=function(){var b=a.getUrlParam("path");return(b?b:"/ierp")+"/qing/core.do"};this.protectedShowErrorImpl=function(b,p,m,n){f||(f=new com.kingdee.bos.qing.scene.common.square.exhibition.CardErrorUi(b),f.setShowDetail(!0));
f.show(p,m,n);return!0};var c=function(b){a.protectedGetSchemaContent(function(p){e=p.schemaContentVo.schemaContent;b()},function(p,m,n){a.displayError(p,m,n)})};this.protectedGetSchemaContent=function(b,p){}}function A(){R.call(this);var a=this,d,e,f,g;this.protectedImportMoreCode=function(k){k.loadSkinJs("linkage","skin");k.loadJs("linkage/linkage.js");k.loadSkinCss("linkage","linkage")};this.checkOperatePermAndPrompt=function(k,h){if(!g)return!0;var c=!0;if(h==A.PERM_TYPE_ENTER_ANALYSIS){if(0!=
(g&1)){c=!1;var b=y.get("enterAnalysis","\u8fdb\u5165\u201c\u6570\u636e\u5206\u6790\u201d")}}else if(h==A.PERM_TYPE_ENTER_SQUARE)0!=(g&128)&&(c=!1,b=y.get("enterEdit","\u8fdb\u5165\u8bbe\u8ba1\u5668"));else throw Error("unknown permType");c||(h=y.get("cardEditUnaccessable","\u60a8\u6ca1\u6709#1\u7684\u6743\u9650").replace("#1",b),a.displayActionPrompt(k,h));return c};this.protectedCustomInitEnv=function(){e=a.getUrlParam("bizTag");f=a.getUrlParam("schemaAdditionalTag");d=a.getUrlParam("publishId");
var k=a.getUrlParam("path");k=(k?k:"/ierp")+"/qing/linkage.do";var h=new com.kingdee.bos.qing.linkage.LinkageManage;h.setCurrentLinkageTag(a.getUrlParam("tag"));h.initRuntime(k,com.kingdee.bos.qing.integration.LinkageJumper.jump);k=com.kingdee.bos.qing.behavior.BehaviorManager;k.interestInBehaviorEntrance(k.ENTRANCE_CARD);com.kingdee.bos.qing.integration.ImglibUrlParser.hookUrlParser()};this.protectedGetSchemaContent=function(k,h){var c=new H,b=a.getUrlParam("path");c.setRemoteUrl((b?b:"/ierp")+"/qing/card.do");
(new G(c,function(p){g=p.operation["2"]|p.operation["1"];k(p)},h)).loadSquareSchemaWithOper(d,e,f)}}function ba(){com.kingdee.bos.qing.AbstractSquareIframeScene.call(this);var a=this,d=this.protectedMethod,e,f,g,k,h,c,b,p,m;this.protectedImportMoreCode=function(l){l.loadSkinJs("lightapp/common","skin");l.loadCss("lightapp/common/qing-lapp.css")};this.setDrawLegendCallback=function(l){b=l};this.setCloseFilterCallback=function(l){m&&m.setClosedListener(l)};this.hasFilter=function(){return m?m.hasFilters():
!1};this.getFilterUi=function(){return m&&m.hasFilters()?m.getJqUi():$("<div>")};this.updateFilterUi=function(){m&&m.updateUi()};this.protectedCustomInitEnv=function(){g=a.getUrlParam("path");k=a.getUrlParam("bizTag");h=a.getUrlParam("publishId");c=new H;c.setRemoteUrl((g?g:"/ierp")+"/qing/card.do");var l=com.kingdee.bos.qing.behavior.BehaviorManager;l.interestInBehaviorEntrance(l.ENTRANCE_CARD)};this.protectedDrawCustomLegend=function(l,q){com.kingdee.bos.qing.chart.SquareConfig.COMBO_LEGEND_MODE=
!1;l!=com.kingdee.bos.qing.square.model.SquareModel.ChartType_GIS&&(l=(new com.kingdee.bos.qing.lapp.ui.LappSquareLegendRender).createLegendUi(l,q))&&(l.appendTo($(document.body)),b())};this.setSchemaLoadCallback=function(l){p=l};this.protectedLoadingImpl=function(l){f?(l(f),p&&p()):n(function(){l(f);p&&p();m||(m=new com.kingdee.bos.qing.lapp.ui.LappFilter(d.copyFilters,d.updateFilterPreparedValue,d.filtering))})};this.protectedGetRemoteUrl=function(){return(g?g:"/ierp")+"/qing/core.do"};this.protectedShowErrorImpl=
function(l,q,t,v){e||(e=new com.kingdee.bos.qing.scene.common.square.exhibition.CardErrorUi(l),e.setShowDetail(!0));e.show(q,t,v);return!0};var n=function(l){(new G(c,function(q){f=q.schemaContent;l()},function(q,t,v){a.displayError(q,t,v)})).loadSquareSchema(h,k)}}function N(){var a,d,e,f,g,k=!0,h;this.setDesc=function(m){a=m};this.show=function(m,n){d=m;e=n;c()};this.hideTips=function(){f&&f.removeTips()};this.setShowOnlyMouseOn=function(m){k=m};var c=function(){b();h||(h=new com.kingdee.bos.qing.framework.common.WindowResizeObserver,
h.setDelay(100),h.setCallback(function(){b()}),h.observe())},b=function(){var m=function(){var n=e.width(),l=e.text();if(0==n)setTimeout(m,100);else{var q=e.height(),t=e.position(),v=t.top;t=t.left;l=p(l,e.css("font-size"));n=t+Math.min(n,l)+5;q=v+(q-16)/2;a&&(g||(f=new I,f.setIconType(I.ICON_TYPE_QUESTION),f.setContainer(d),f.setTipsText(a),g=f.getJqUi(),g.appendTo(d),k&&(g.hide(),$(document.body).on("mouseenter",function(){g.show()}),$(document.body).on("mouseleave",function(){g.hide()}))),g.css({position:"absolute",
left:n+"px",top:q+"px"}))}};m()},p=function(m,n){n||(n="12px");var l=$("<div>");l.css({position:"absolute","font-size":n,visibility:"hidden",height:"auto",width:"auto","white-space":"nowrap"});l.appendTo($(document.body));l.text(m);m=l.outerWidth();l.remove();return m}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&
(com.kingdee.bos.qing.scene={});"undefined"==typeof com.kingdee.bos.qing.scene.cardExhibition&&(com.kingdee.bos.qing.scene.cardExhibition={});var r=com.kingdee.bos.qing.scene.cardExhibition;r.DSBCardContainer=function(){D.call(this);var a=this.protectedMethod,d;this.protectedCustomContent=function(f){if(!d){var g=a.getUrlParam("pageId"),k=a.getUrlParam("skin"),h=a.getUrlParam("language"),c=a.getUrlParam("publishId"),b=a.getUrlParam("path");b=(b?b:"/ierp")+"/qing/publishEntrance.do";c&&(b=a.appendUrlParam(b,
"publishId",c));g&&(b=a.appendUrlParam(b,"pageId",g));k&&(b=a.appendUrlParam(b,"skin",k));h&&(b=a.appendUrlParam(b,"language",h));b=com.kingdee.bos.qing.integration.PageHelper.getIframeUrl(b);d=$("<iframe>");d.css({position:"absolute",left:0,top:0,height:"100%",width:"100%",border:"none"});d.attr("allowfullscreen","true");d.attr("src",b)}d.appendTo(f)};this.protectedCustomHead=function(f){var g=$("<div class = 'sa-qing-publish-card-icon'>");g.css({position:"absolute",right:0,top:"5px"});g.on("click",
e);r.Icons.background(g,"btn-refresh");g.on("mouseover",function(k){r.Icons.background(g,"btn-refresh-on")});g.on("mouseout",function(k){r.Icons.background(g,"btn-refresh")});g.attr("title",y.get("cardRefresh","\u5237\u65b0"));$(document.body).on("mouseenter",function(){g.show()});$(document.body).on("mouseleave",function(){g.hide()});g.appendTo(f);g.hide()};var e=function(){var f=a.getUrlParam("pageId"),g=a.getUrlParam("skin"),k=a.getUrlParam("language"),h=a.getTitle(),c=a.getUrlParam("publishId"),
b=a.getUrlParam("path");b=a.appendAccountIdParam((b?b:"/ierp")+"/qing/cardEntrance.do");c&&(b=a.appendUrlParam(b,"publishId",c));h&&(b=a.appendUrlParam(b,"cardName",h));f&&(b=a.appendUrlParam(b,"pageId",f));g&&(b=a.appendUrlParam(b,"skin",g));k&&(b=a.appendUrlParam(b,"language",k));window.location.href=b}};r.RemoteImpl=H;r.AbstractDesktopExhibition=R;r.IconContainer=M;r.CardFacade=G;var P,Q,y,z,T,I,K;(function(){var a=com.kingdee.bos.qing;K=a.Seer;a=com.kingdee.bos.qing.framework.common;P=a.AbstractFacade;
Q=a.AbstractRemoteCall;y=a.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.scene);T=a.AbstractIcons;a=com.kingdee.bos.qing.ui.component;I=a.HelpIcon;a=com.kingdee.bos.qing.common;z=a.DomUtil})();r.CardContainerFactory=new function(){var a={};this.getCardContainer=function(d){return(d=a[d])?new d:new ca};this.getCardErrContainer=function(){return new aa};this.regist=function(d,e){a[d]=e}};r.CardContainerFactory.regist("mobileCtrl_FullScreen",function(){O.call(this);var a=this.protectedMethod,
d,e,f,g,k;this.protectedCustomHead=function(t){d||(d=$("<div class='sa-qing-publish-card-icon'>"),d.on("click",h),r.Icons.background(d,"btn-back"),a.insertOperateBtnUI([d]));d.show();e||(e=$("<div class='sa-qing-publish-card-icon'>"),e.on("click",b),r.Icons.background(e,"btn-list"),a.appendOperateBtnUI([e]));e.show()};var h=function(){var t=a.getUrlParam("pageId");top.window.invokeCustomEvent&&top.window.invokeCustomEvent(t,"",["","closeView",JSON.stringify({})])},c=!1,b=function(){if(c)a.hideExtraOperateContainer(),
q(),c=!1;else{if(!f){var t=[];a.getSquareExhibition().hasFilter()&&(g=new E(y.get("lappFilter","\u8fc7\u6ee4"),"lapp-filter",l),t.push(g));f=new E(y.get("landscapeBtn","\u6a2a\u5c4f"),"btn-horizontal",m);t.push(f);a.insertExtraOperateBtn(t)}a.showExtraOperateContainer();c=!0}},p=!1,m=function(){if(p)try{var t=window.screen.orientation;t&&(t.lock("portrait-primary"),f&&(f.changeName(y.get("landscapeBtn","\u6a2a\u5c4f")),f.changeIcon("btn-horizontal")),$(window).trigger("resize"),p=!1)}catch(B){}else try{var v=
window.screen.orientation;v&&(v.lock("landscape-primary"),f.changeName(y.get("verticalScreenBtn"),"\u7ad6\u5c4f"),f.changeIcon("btn-vertical"),$(window).trigger("resize"),p=!0)}catch(B){}},n=!1,l=function(){if(n)q();else{g.changeIcon("lapp-filter-on");var t=a.getSquareExhibition().getFilterUi();k||(k=$("<div>"),k.append(t),k.appendTo(a.getContentUi()));t.show();z.layoutCtrlWithLRTB(k,0,0,null,0,44,null);a.getSquareExhibition().updateFilterUi();k.show();n=!0}},q=function(){k&&k.hide();g&&g.changeIcon("lapp-filter");
n=!1}});r.CardContainerFactory.regist("mobileCtrl",function(){O.call(this);var a=this.protectedMethod,d,e,f,g,k,h,c,b;this.protectedCustomHead=function(x){d=$("<div class = 'sa-qing-publish-card-icon'>");d.on("click",n);r.Icons.background(d,"btn-refresh");d.attr("title",y.get("cardRefresh","\u5237\u65b0"));e=$("<div class = 'sa-qing-publish-card-icon'>");e.on("click",p);r.Icons.background(e,"btn-fullscreen");e.attr("title",y.get("fullScreenBtn","\u5168\u5c4f"));a.appendOperateBtnUI([e,d])};var p=
function(){if(document.body.requestFullScreen||document.body.webkitRequestFullScreen||document.body.msRequestFullscreen||document.body.mozRequestFullScreen)b||(b=com.kingdee.bos.qing.common.FullScreenHelper,b.addChangedListener(m)),b.request(document.body);else{var x=a.getUrlParam("pageId");if(top.window.invokeCustomEvent){var C={tag:a.getUrlParam("tag"),ctrlName:a.getUrlParam("ctrlName"),ctrlRefId:a.getUrlParam("ctrlRefId"),hasCustomSchema:a.getUrlParam("hasCustomSchema")};top.window.invokeCustomEvent(x,
"",["","openFullScreenForm",JSON.stringify(C)])}}},m=function(x){null==x?l():x==document.body&&(a.getMainUi().css("top","44px"),d.hide(),e.hide(),f||(f=$("<div class='sa-qing-publish-card-icon'>"),f.on("click",l),r.Icons.background(f,"btn-back"),a.insertOperateBtnUI([f])),f.show(),g||(g=$("<div class='sa-qing-publish-card-icon'>"),g.on("click",t),r.Icons.background(g,"btn-list"),a.appendOperateBtnUI([g])),g.show())},n=function(){var x=a.getUrlParam("pageId"),C=a.getUrlParam("skin"),U=a.getUrlParam("language"),
V=a.getTitle(),W=a.getUrlParam("ctrlRefId"),X=a.getUrlParam("cardScene"),Y=a.getUrlParam("ctrlName"),Z=a.getUrlParam("hasCustomSchema"),w=a.getUrlParam("path");w=(w?w:"/ierp")+"/qing/devctrlCardEntrance.do";W&&(w=a.appendUrlParam(w,"ctrlRefId",W));V&&(w=a.appendUrlParam(w,"cardName",V));x&&(w=a.appendUrlParam(w,"pageId",x));C&&(w=a.appendUrlParam(w,"skin",C));U&&(w=a.appendUrlParam(w,"language",U));X&&(w=a.appendUrlParam(w,"cardScene",X));Y&&(w=a.appendUrlParam(w,"ctrlName",Y));Z&&(w=a.appendUrlParam(w,
"hasCustomSchema",Z));w=a.appendUrlParam(w,"mobileCtrl",!0);window.location.href=w},l=function(){d.show();e.show();g.hide();f.hide();a.hideExtraOperateContainer();J();b.exit();u();a.getMainUi().css("top","0px");q=v=F=!1},q=!1,t=function(){if(q)a.hideExtraOperateContainer(),J(),q=!1;else{if(!k){var x=[];a.getSquareExhibition().hasFilter()&&(h=new E(y.get("lappFilter","\u8fc7\u6ee4"),"lapp-filter",da),x.push(h));k=new E(y.get("landscapeBtn","\u6a2a\u5c4f"),"btn-horizontal",B);x.push(k);a.insertExtraOperateBtn(x)}a.showExtraOperateContainer();
q=!0}},v=!1,B=function(){if(v)u();else try{var x=window.screen.orientation;x&&(x.lock("landscape-primary"),k.changeName(y.get("verticalScreenBtn"),"\u7ad6\u5c4f"),k.changeIcon("btn-vertical"),$(window).trigger("resize"),v=!0)}catch(C){}},u=function(){try{var x=window.screen.orientation;x&&(x.lock("portrait-primary"),k&&(k.changeName(y.get("landscapeBtn","\u6a2a\u5c4f")),k.changeIcon("btn-horizontal")),$(window).trigger("resize"),v=!1)}catch(C){}},F=!1,da=function(){if(F)J();else{h.changeIcon("lapp-filter-on");
var x=a.getSquareExhibition().getFilterUi();c||(c=$("<div>"),c.append(x),c.appendTo(a.getContentUi()));x.show();z.layoutCtrlWithLRTB(c,0,0,null,0,44,null);a.getSquareExhibition().updateFilterUi();c.show();F=!0}},J=function(){c&&c.hide();h&&h.changeIcon("lapp-filter");F=!1}});r.CardContainerFactory.regist("devctrl",function(){L.call(this);var a=this.protectedMethod,d=this.protectedCustomContent;this.protectedCustomContent=function(h){d(h);com.kingdee.bos.qing.integration.CardCtrlMsgHandler.setCallback(k);
h=com.kingdee.bos.qing.msgbus.MsgBus;h.focus(h.MESSAGE_TYPE_FILTERACTION,e);h.focus(h.MESSAGE_TYPE_REFRESHACTION,f);a.setFilteringListener(g)};var e=function(h){a.applyExternalFilter(h)},f=function(h){a.reExcuteCard()},g=function(){var h=com.kingdee.bos.qing.msgbus.MsgBus,c=a.getUrlParam("parentPageId");h.sendMsg(c,"hello world",h.MESSAGE_TYPE_CUSTOMEVENT)};this.protectedOpenSquare=function(){var h=a.getUrlParam("pageId");if(top.window.invokeCustomEvent){var c={tag:a.getUrlParam("tag"),cardName:a.getUrlParam("cardName"),
formPageId:a.getUrlParam("formPageId"),publishId:a.getUrlParam("publishId"),schemaAdditionalTag:a.getUrlParam("schemaAdditionalTag"),bizTag:a.getUrlParam("bizTag"),hasMainView:a.getUrlParam("hasMainView")};top.window.invokeCustomEvent(h,"",["","openSquare",JSON.stringify(c)])}};this.protectedOpenAnalysis=function(){var h="true"==a.getUrlParam("hasMainView");var c=a.getUrlParam("path");c=(c?c:"/ierp")+"/qing/editAnalysisCardEntrance.do";var b=a.getUrlParam("skin"),p=a.getUrlParam("language"),m=a.getUrlParam("publishId"),
n=a.getUrlParam("bizTag"),l=a.getUrlParam("schemaAdditionalTag"),q=a.getUrlParam("cardScene"),t=a.getUrlParam("tag");m&&(c=a.appendUrlParam(c,"publishId",m));n&&(c=a.appendUrlParam(c,"bizTag",n));q&&(c=a.appendUrlParam(c,"cardScene",q));l&&(c=a.appendUrlParam(c,"schemaAdditionalTag",l));b&&(c=a.appendUrlParam(c,"skin",b));p&&(c=a.appendUrlParam(c,"language",p));t&&(c=a.appendUrlParam(c,"tag",t));top.window.invokeCustomEvent&&h?(h={tag:a.getUrlParam("tag"),cardName:a.getUrlParam("cardName"),bizTag:a.getUrlParam("bizTag"),
publishId:a.getUrlParam("publishId"),schemaAdditionalTag:a.getUrlParam("schemaAdditionalTag")},c=a.getUrlParam("pageId"),top.window.invokeCustomEvent(c,"",["","openAnalysis",JSON.stringify(h)])):window.open(c)};this.protectedGetRefreshUrl=function(){var h=a.getUrlParam("pageId"),c=a.getUrlParam("skin"),b=a.getUrlParam("language"),p=a.getTitle(),m=a.getUrlParam("schemaAdditionalTag"),n=a.getUrlParam("cardScene"),l=a.getUrlParam("hasMainView"),q=a.getUrlParam("ctrlRefId"),t=a.getUrlParam("ctrlName"),
v=a.getUrlParam("hasCustomSchema"),B=a.getUrlParam("parentPageId"),u=a.getUrlParam("path");u=(u?u:"/ierp")+"/qing/devctrlCardEntrance.do";q&&(u=a.appendUrlParam(u,"ctrlRefId",q));m&&(u=a.appendUrlParam(u,"schemaAdditionalTag",m));p&&(u=a.appendUrlParam(u,"cardName",p));h&&(u=a.appendUrlParam(u,"pageId",h));c&&(u=a.appendUrlParam(u,"skin",c));b&&(u=a.appendUrlParam(u,"language",b));n&&(u=a.appendUrlParam(u,"cardScene",n));l&&(u=a.appendUrlParam(u,"hasMainView",l));t&&(u=a.appendUrlParam(u,"ctrlName",
t));v&&(u=a.appendUrlParam(u,"hasCustomSchema",v));B&&(u=a.appendUrlParam(u,"parentPageId",B));return u};var k=function(h){(h=h.content)&&h.refreshCard&&a.reExcuteCard()}});A.PERM_TYPE_ENTER_ANALYSIS="enter_analysis";A.PERM_TYPE_ENTER_SQUARE="enter_square";r.Icons=new function(){T.call(this);var a=this.protectedMethod;this.protectedInit=function(e,f){e=com.kingdee.bos.qing.scene.cardExhibition.ComboIcon;if(!e)throw Error("com.kingdee.bos.qing.scene.cardExhibition.ComboIcon not found.");e.define(f,
"publish-resource-sprite");f.setStartPosition(1,1);f.setGap(1);f.setIconSize(16,16);d(0,0,"btn-analysis");d(1,0,"btn-analysis-on");d(0,1,"btn-edit");d(1,1,"btn-edit-on");d(0,2,"btn-filter");d(1,2,"btn-filter-on");d(0,3,"btn-refresh");d(1,3,"btn-refresh-on");d(0,4,"btn-more");d(1,4,"btn-more-on");d(2,0,"btn-list");d(3,0,"btn-list-on");d(2,1,"lapp-filter");d(3,1,"lapp-filter-on");d(2,2,"btn-horizontal");d(3,2,"btn-vertical");d(2,3,"btn-fullscreen");d(3,3,"btn-back")};var d=function(e,f,g){a.registIcon(e,
f,g)}};var S=new function(){this.applyFilter=function(a,d){var e=com.kingdee.bos.qing.msgbus.ExternalFilterItem,f=d.getFilterType();if(e.FILTER_TYPE_DISCRETE==f){if(a instanceof com.kingdee.bos.qing.core.model.DiscreteFilter)for(e=a.getPreparedModel().getItems(),d=d.getValues(),f=0;f<e.length;f++)for(var g=0;g<d.length;g++){var k=d[g],h=e[f];h.getValue()==k?a.addSelectedValue(k):a.removeSelectedValue(h.getValue())}}else e.FILTER_TYPE_DATERANGE==f?a instanceof com.kingdee.bos.qing.core.model.ContinuousDateFilter&&
(f=a.getPreparedModel(),e=f.getFromDateMs(),g=f.getToDateMs(),f=d.getStartDate(),d=d.getEndDate(),d=0==d&&g?g:d,a.setFromDateMs(0==f&&e?e:f),a.setToDateMs(d)):e.FILTER_TYPE_CONTINUOUS==f&&(f=a.getPreparedModel(),e=d.getFloor(),d=d.getCeiling(),g=f.getMin(),f=f.getMax(),a.setValue(e?e:g,d?d:f))}};r.ExternalFilterHelper=S})();
//qingVersionTag: 20250324