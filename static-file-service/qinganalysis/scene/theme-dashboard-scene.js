var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(D,K,F){if(D==Array.prototype||D==Object.prototype)return D;D[K]=F.value;return D};
$jscomp.getGlobal=function(D){D=["object"==typeof globalThis&&globalThis,D,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var K=0;K<D.length;++K){var F=D[K];if(F&&F.Math==Math)return F}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(D,K){var F=$jscomp.propertyToPolyfillSymbol[K];if(null==F)return D[K];F=D[F];return void 0!==F?F:D[K]};$jscomp.polyfill=function(D,K,F,H){K&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(D,K,F,H):$jscomp.polyfillUnisolated(D,K,F,H))};
$jscomp.polyfillUnisolated=function(D,K,F,H){F=$jscomp.global;D=D.split(".");for(H=0;H<D.length-1;H++){var J=D[H];if(!(J in F))return;F=F[J]}D=D[D.length-1];H=F[D];K=K(H);K!=H&&null!=K&&$jscomp.defineProperty(F,D,{configurable:!0,writable:!0,value:K})};
$jscomp.polyfillIsolated=function(D,K,F,H){var J=D.split(".");D=1===J.length;H=J[0];H=!D&&H in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Aa=0;Aa<J.length-1;Aa++){var p=J[Aa];if(!(p in H))return;H=H[p]}J=J[J.length-1];F=$jscomp.IS_SYMBOL_NATIVE&&"es6"===F?H[J]:null;K=K(F);null!=K&&(D?$jscomp.defineProperty($jscomp.polyfills,J,{configurable:!0,writable:!0,value:K}):K!==F&&(void 0===$jscomp.propertyToPolyfillSymbol[J]&&(F=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[J]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(J):$jscomp.POLYFILL_PREFIX+F+"$"+J),$jscomp.defineProperty(H,$jscomp.propertyToPolyfillSymbol[J],{configurable:!0,writable:!0,value:K})))};
$jscomp.polyfill("String.prototype.replaceAll",function(D){return D?D:function(K,F){if(K instanceof RegExp&&!K.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return K instanceof RegExp?this.replace(K,F):this.replace(new RegExp(String(K).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),F)}},"es_2021","es3");
$jscomp.findInternal=function(D,K,F){D instanceof String&&(D=String(D));for(var H=D.length,J=0;J<H;J++){var Aa=D[J];if(K.call(F,Aa,J,D))return{i:J,v:Aa}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(D){return D?D:function(K,F){return $jscomp.findInternal(this,K,F).v}},"es6","es3");
(function(){function D(N){var z,f,X,oa,ba,ua,Ba,L,Y,da,w,ka=!0,R=!1,ra=!1,qa,ia,ea="icon_nodata",sa="12px";this.setShowErrorDetailListener=function(b){qa=b};this.setIsQingreportDsbComponent=function(b){ra=b};this.setIsDsbComponent=function(b){R=b};this.show=function(b,t,q){z?C(b,t,q):ya(b,t,q)};this.setShowDetail=function(b){ka=b};this.getShowOperate=function(){return w};this.setBackgroundIcon=function(b){ea=b};this.setFontSize=function(b){sa=b};var ya=function(b,t,q){z=$("<div>");z.text("loading...");
z.appendTo(N);Ca.setCallback(function(){h();C(b,t,q)});Ca.loadSkinCss("scene","common-square-exhibition")},h=function(){z.empty();z.addClass("carderror-errorprompt");!R&&z.css("top","22px");f=$("<div>");f.css({position:"absolute",margin:"0px auto",width:"100%",height:"100%"});f.appendTo(z);var b=$("<iframe>");b.addClass("carderror-errorprompt-size-listener");b.appendTo(z);b[0].contentWindow&&b[0].contentWindow.addEventListener("resize",function(){G()});X=$("<div>");X.addClass("carderror-errorprompt-img");
J.Icons.background(X,ea);X.appendTo(f);ua=$("<div>");ua.addClass("carderror-errorprompt-errorinfo");ua.appendTo(f);oa=$("<span>");oa.addClass("carderror-errorprompt-text");oa.css("font-size",sa);oa.appendTo(ua);ba=$("<span>");ba.addClass("carderror-errorprompt-error-btn");ba.text(p.get("showErrorLog","\u663e\u793a\u9519\u8bef\u65e5\u5fd7"));ba.appendTo(ua)},C=function(b,t,q){var d;if(2101001==b){w=d=!1;var e=p.get("themeIsDeleted","\u5bf9\u5e94\u4e3b\u9898\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")}else if(2101002==
b||2101003==b||2101004==b||2101005==b)w=d=!1,e=p.get("themeHasNoData","\u5bf9\u5e94\u4e3b\u9898\u6ca1\u6709\u5b9a\u4e49\u6570\u636e");else if(2103001==b||2103002==b)w=d=!1,e=p.get("componentSourceHasNotFound","\u8be5\u7ec4\u4ef6\u6765\u6e90\u5df2\u88ab\u53d1\u5e03\u8005\u5220\u9664");else if(2101016==b)w=d=!1,e=p.get("subjectEntityMySQLMoreThan61Table","\u5f53\u524d\u5b9e\u4f53\u5173\u8054\u6570\u636e\u8868\u592a\u591a\uff0c\u8bf7\u51cf\u5c11\u5b9e\u4f53\u7684\u5206\u6790\u5b57\u6bb5\u6216\u5220\u9664\u4e0d\u9700\u8981\u7684\u5b9e\u4f53\u5206\u5f55\u3002");
else if(2101009==b)d=!0,w=!1,e=p.get("subjectDataSourceError","\u6570\u636e\u6e90\u53d1\u751f\u5f02\u5e38");else if(2101010==b)w=d=!1,e=p.get("qingStorageFileSizeLimit","\u8f7b\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3");else if(2100001==b)w=d=!1,e=p.get("qingStorageNoSpace","\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u4eba\u5458\u6dfb\u52a0\u78c1\u76d8");else if(2101011==b)d=!0,w=!1,e=p.get("subjectDBDataSourceError","\u6570\u636e\u6e90\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u8fde\u63a5\u5f02\u5e38");
else if(2101012==b)e=p.get("noDBCenterPermission","\u6ca1\u6709\u6570\u636e\u4e2d\u5fc3\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650");else if(2101023==b)e=p.get("noSuperQueryAuth","\u6ca1\u6709\u5f53\u524d\u8d85\u7ea7\u67e5\u8be2\u6a21\u5f0f\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650");else if(2101013==b||2101014==b)e=p.get("entityDestroyed","\u5bf9\u5e94\u4e3b\u9898\u7684\u6570\u636e\u8868\u88ab\u635f\u574f");else if(2101015==
b)e=p.get("noDBCenterOwnerPermission","\u53d1\u5e03\u4eba\u201c#1\u201d\u6ca1\u6709\u6570\u636e\u4e2d\u5fc3\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba\u68c0\u67e5\u6743\u9650").replace("#1",t);else if(2101021==b)e=p.get("notExistTable","\u65e0\u6cd5\u5728\u6a21\u5f0f\u201c#1\u201d\u4e2d\u627e\u5230\u8be5\u5b9e\u4f53\u6570\u636e\u8868").replaceAll("#1",t);else if(2101022==b)e=p.get("noSuperQueryPerm","\u53d1\u5e03\u4eba\u201c#1\u201d\u6ca1\u6709\u8d85\u7ea7\u67e5\u8be2\u76f8\u5173\u6a21\u5f0f\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba\u68c0\u67e5\u6743\u9650").replace("#1",
t);else if(2101024==b)e=p.get("ownerNotExistTable","\u6570\u636e\u6e90\u5f02\u5e38\uff0c\u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba\u68c0\u67e5\u6570\u636e\u6e90");else if(2106002==b)e=p.get("chartExpired","\u56fe\u8868\u4fe1\u606f\u5df2\u8fc7\u671f");else if(2215011==b)e=p.get("noDmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u5148\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650");else if(2215012==b)e=p.get("noDmoOwnerPermission","\u53d1\u5e03\u4eba\u201c#1\u201d\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba\u68c0\u67e5\u6743\u9650").replace("#1",
t);else if(2215020==b)e=p.get("dmoPermission","\u6ca1\u6709\u6570\u636e\u5f00\u53d1\u5e73\u53f0#1\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba\u68c0\u67e5\u6743\u9650").replace("#1",t);else if(2301001==b)w=d=!1,e=R||ra?p.get("componentSourceHasNotFound","\u8be5\u7ec4\u4ef6\u6765\u6e90\u5df2\u88ab\u53d1\u5e03\u8005\u5220\u9664"):p.get("cardHasNotFound","\u8be5\u5361\u7247\u5df2\u88ab\u53d1\u5e03\u8005\u5220\u9664");else if(2301005==b)w=d=!1,e=R?p.get("componentSourceNoAuthority","\u6ca1\u6709\u8be5\u7ec4\u4ef6\u6765\u6e90\u7684\u67e5\u770b\u6743\u9650"):
ra?p.get("extreportCardNoAuthority","\u6ca1\u6709\u8be5\u8f7b\u62a5\u8868\u7684\u67e5\u770b\u6743\u9650"):p.get("cardNoAuthority","\u6ca1\u6709\u8be5\u5361\u7247\u7684\u67e5\u770b\u6743\u9650");else if(2105E3==b)w=d=!1,e=p.get("cardHasNotFound","\u8be5\u5361\u7247\u5df2\u88ab\u5220\u9664");else if(2201003==b)w=d=!1,e=p.get("cardNoDefaultSchema","\u8be5\u5361\u7247\u6ca1\u6709\u5b9a\u4e49\u9ed8\u8ba4\u65b9\u6848");else if(909001==b)w=d=!1,e=p.get("unsupportedDsbRefSource","\u5f53\u524d\u7cfb\u7edf\u4e0d\u652f\u6301\u8be5\u7ec4\u4ef6\u6765\u6e90");
else if(3010002==b)w=d=!1,e=p.get("illegalLicense","\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u3010\u8f7b\u5206\u6790\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002");else if(3010003==b)w=d=!1,e=p.get("noQingModulePermission","\u60a8\u6240\u4f7f\u7528\u7684\u8d26\u6237\u6ca1\u6709\u88ab\u5206\u914d\u3010\u8f7b\u5206\u6790\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002");
else if(3010004==b)w=d=!1,e=p.get("replicatedLogin","\u60a8\u7684\u8d26\u53f7\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u5f53\u524d\u7cfb\u7edf\u3002");else if(3010005==b)w=d=!1,e=p.get("illegalQingReportLicense","\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u3010\u8f7b\u62a5\u8868\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002");else if(3010006==b)w=d=!1,e=p.get("noQingReportModulePermission","\u60a8\u6240\u4f7f\u7528\u7684\u8d26\u6237\u6ca1\u6709\u88ab\u5206\u914d\u3010\u8f7b\u62a5\u8868\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002");
else if(3099002==b)w=d=!1,e=p.get("qingRuntimeException","\u7a0b\u5e8f\u53d1\u751f\u9519\u8bef");else if(3001002==b)w=d=!0,e=p.get("qingRuntimeException","\u7a0b\u5e8f\u53d1\u751f\u9519\u8bef");else if(1030001==b)w=d=!1,e=t;else if("unsetCardSource"==b)w=d=!1,e=p.get("unsetCardSource","\u8bf7\u9009\u62e9\u5361\u7247\u6765\u6e90");else if(8099001==b)w=d=!1,e=p.get("extreportNotFound","\u8be5\u62a5\u8868\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664");else if(21000008==b)w=d=!1,e=p.get("noQingModelerLicense",
"\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u3010\u8f7b\u5efa\u6a21\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb");else if(2101006==b)w=!1,(e=t.match(/(\(|\uff08)([^(\)|\uff09)]+)(\)|\uff09)/))&&(t=e[2]),ia=$("<p>"),ia.addClass("carderror-errorprompt-support-qing-text"),ia.html(t.replace(/,/g,p.get("semicolon","\uff1b")+"<br>")),R?(d=!0,e=p.get("haveNotGetDataEntityAuthority","\u5c1a\u672a\u83b7\u5f97\u5b9e\u4f53\u6570\u636e\u8868\u7684\u67e5\u770b\u6743\u9650"),
ba.text(p.get("viewDetails","\u67e5\u770b\u8be6\u60c5"))):(d=!1,e=p.get("noAuthorityForTheseEntities","\u5c1a\u672a\u83b7\u5f97\u4ee5\u4e0b\u5b9e\u4f53\u6570\u636e\u8868\u7684\u67e5\u770b\u6743\u9650\uff1a")),oa.text(e),!d&&oa.append(ia);else if(2101018==b){w=!1;d=ca.getSupportQingAnalysisUrl();(e=/(?:\u3010\s)(.+)(?=\s\u3011)/.exec(t))&&(t=e[1]);var aa=$("<a onclick='javascript:window.open(\""+d+"\");' href='#'>");aa.css({cursor:"pointer",color:"#5582f3"});aa.text(p.get("viewDocument","\u67e5\u770b\u5e2e\u52a9\u6587\u6863"));
ia=$("<p>");ia.addClass("carderror-errorprompt-support-qing-text");ia.html(t.replace(/,/g,p.get("semicolon","\uff1b")+"<br>"));R?(d=!0,e=p.get("entityNotSupportQingAnalysis","\u4e1a\u52a1\u5b9e\u4f53\u672a\u5f00\u542f\u201c\u652f\u6301\u8f7b\u5206\u6790\u201d\u8bbe\u7f6e\u9879\uff0c\u8bf7\u5728\u5f00\u53d1\u5e73\u53f0\u7684\u5bf9\u5e94\u8868\u5355\u4e2d\u8fdb\u884c\u8bbe\u7f6e  "),ba.text(p.get("viewDetails","\u67e5\u770b\u8be6\u60c5"))):(d=!1,e=p.get("notSupportQingAnalysisTip","\u4ee5\u4e0b\u4e1a\u52a1\u5b9e\u4f53\u5c1a\u672a\u5f00\u542f\u201c\u652f\u6301\u8f7b\u5206\u6790\u201d\u8bbe\u7f6e\u9879\uff0c\u8bf7\u5728\u5f00\u53d1\u5e73\u53f0\u7684\u5bf9\u5e94\u8868\u5355\u4e2d\u8fdb\u884c\u8bbe\u7f6e  "),
z.css("overflow-y","auto"),ua.css("max-height","unset"));oa.text(e);oa.append(aa);!d&&oa.append(ia)}else 4040002==b||4040003==b||4040004==b?(w=d=!0,e=p.get("serverBusy","\u5f53\u524d\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")):4100001==b?(w=d=!0,e=p.get("extractDataFail","\u51c6\u5907\u6570\u636e\u5931\u8d25")):(w=d=!0,e=b+"",e=0==e.indexOf("21")&&7==e.length?p.get("extractDataFail","\u51c6\u5907\u6570\u636e\u5931\u8d25"):0==e.indexOf("30")&&6==e.length?p.get("extractDataFail",
"\u51c6\u5907\u6570\u636e\u5931\u8d25"):0==e.indexOf("40")&&6==e.length?p.get("executeFail","\u56fe\u8868\u6267\u884c\u5931\u8d25"):p.get("unknownException","\u53d1\u751f\u4e86\u672a\u77e5\u9519\u8bef"));d&&ka?(ba.show(),ba.on("click",function(la){E(b,t,q)})):ba.hide();2101018!=b&&2101006!=b&&oa.text(e);setTimeout(G,500)},G=function(){var b=z.height()-2;z.width();if(0!=b){var t=ua.height()+10,q=b-t;70>q?(X.hide(),q=0):(X.show(),200<q&&(q=200),X.css("height",q+"px"));ua.css("min-height","unset");f.css({"margin-top":-Math.floor((q+
t)/2)+"px",top:"50%",height:q+t+"px"});0>b-t&&(z.css("overflow-y","auto"),z.css("overflow-x","auto"))}},E=function(b,t,q){if(2101006==b){var d=new B($(document.body));d.setSize(440,330);d.setTitle(p.get("permissionTitle","\u6743\u9650\u63d0\u793a"));d.showDialog(U(p.get("noAuthorityForTheseEntities","\u5c1a\u672a\u83b7\u5f97\u4ee5\u4e0b\u5b9e\u4f53\u6570\u636e\u8868\u7684\u67e5\u770b\u6743\u9650\uff1a"),ia),!0)}else if(2101018==b)d=new B($(document.body)),d.setSize(440,330),d.setTitle(p.get("DetailInfo",
"\u8be6\u7ec6\u4fe1\u606f")),d.showDialog(U(p.get("notSupportQingAnalysis","\u4ee5\u4e0b\u4e1a\u52a1\u5b9e\u4f53\u5c1a\u672a\u5f00\u542f\u201c\u652f\u6301\u8f7b\u5206\u6790\u201d\u8bbe\u7f6e\u9879\uff1a"),ia),!0);else if(qa)qa(b,t,q);else{if(!Ba){Ba=$("<div>");Ba.addClass("carderror-errorprompt-logdetail-container");d=$("<div>");d.addClass("carderror-errorprompt-logdetail-container-title");var e=$("<div>");e.addClass("carderror-errorprompt-logdetail-titiletag");var aa=$("<div>");aa.addClass("carderror-errorprompt-logdetail-title-lable");
aa.text(p.get("errorLog","\u9519\u8bef\u65e5\u5fd7"));var la=$("<div>");la.addClass("carderror-errorprompt-logdetail-close");J.Icons.background(la,"icon_errorclose");la.on("click",O);d.append(e);d.append(aa);d.append(la);Y=$("<div>");Y.css("padding","10px");Y.text(p.get("errorCode","\u9519\u8bef\u7801\uff1a")+b);da=$("<pre>");da.addClass("carderror-errorprompt-logdetail-content-container-text");da.text("\u9519\u8bef\u4fe1\u606f\uff1a"+t+(null!=q?"\r\n\u9519\u8bef\u6808\uff1a"+q:""));var P=$("<div>");
P.addClass("carderror-errorprompt-logdetail-content-container");var V=$("<span>");V.text(p.get("copy","\u590d\u5236"));V.addClass("carderror-errorprompt-logdetail-content-copybutton");V.click(function(){var T=x("\u9519\u8bef\u7801\uff1a"+b+"\r\n\u9519\u8bef\u4fe1\u606f\uff1a"+t+"\r\n\u9519\u8bef\u6808\uff1a"+q),I=$("<span>");I.addClass("carderror-errorprompt-logdetail-content-copybutton-end");P.append(I);T?I.text(p.get("copy success!","\u590d\u5236\u6210\u529f\uff01")):I.text(p.get("copy error!",
"\u590d\u5236\u5931\u8d25\uff01"));setTimeout(function(){I.remove()},1500)});P.mouseover(function(){V.css("visibility","visible")});P.mouseout(function(){V.css("visibility","hidden")});P.append(Y);P.append(da);P.append(V);Ba.append(d);Ba.append(P);L=$("<div class='sa-ctrl-common-modallayer'>");Ba.appendTo(L)}d=$(document.body);L.appendTo(d)}},x=function(b){var t=document.createElement("textarea");document.body.appendChild(t);t.value=b;t.select();b=document.execCommand("copy");document.body.removeChild(t);
return b},U=function(b,t){var q=$("<div>");q.addClass("carderror-errorprompt-logdetail-content");var d=$("<p>");d.addClass("carderror-errorprompt-logdetail-contenxt-texttitle");d.text(b);b=$("<p>");b.addClass("carderror-errorprompt-logdetail-contenxt-text");b.html(t);q.append(d);q.append(b);return q},B=function(b){var t=$("<div class='sa-ctrl-common-modallayer'>"),q=new na(t),d=0,e=0,aa=320,la=240,P=b?b:$(document.body),V,T;this.setTitle=function(I){T=I};this.setClosingListener=function(I){V=I};this.setSize=
function(I,fa){aa=I;la=fa};this.showDialog=function(I,fa){t.appendTo(P);if(!d){var ha=P.prop("clientWidth"),Ea=P.prop("clientHeight");d=ha-aa>>1;e=(Ea-la)/3}q.setBounds(d,e,aa,la);q.setToolbarVisible(!1);q.setContent(I,fa);q.setTitle(T);q.addClosingListener(function(va,ma){if(ma)V(ma);else return va.destroy(),t.remove(),!0});q.addClosedListener(function(va){va.destroy();t.remove()});q.showFooterPane(this.createFooter);q.show()};this.setContent=function(I,fa){q.setContent(I,fa)};this.destroy=function(){q.destroy();
t.remove()};this.createFooter=function(I){var fa=new Da(p.get("iknow","\u6211\u77e5\u9053\u4e86"));fa.setHighlight(!0);var ha=fa.getJqUi();Ha.layoutCtrlWithLRTB(ha,"50%",0,100,null,13,28);ha.addClass("dialog-footer-close");ha.css("margin-left","-50px");ha.appendTo(I);fa.addActionListener(function(Ea){q.destroy();t.remove()})}},O=function(){L&&L.detach()}}function K(){var N,z,f;this.setIsSquare=function(X){N=X};this.getIsSquare=function(){return N};this.setLoadSchema=function(X){z=X};this.getLoadSchema=
function(){return z};this.setSaveSchema=function(X){f=X};this.getSaveSchema=function(){return f}}function F(){Ia.call(this);this.protectedShowErrorImpl=function(N,z,f,X){N=new D(N);N.setIsDsbComponent(!0);N.show(z,f,X);return!0}}function H(){Z.call(this);this.protectedShowErrorImpl=function(N,z,f,X){N=new D(N);N.setIsDsbComponent(!0);N.show(z,f,X);return!0}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});
"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});"undefined"==typeof com.kingdee.bos.qing.scene.common&&(com.kingdee.bos.qing.scene.common={});"undefined"==typeof com.kingdee.bos.qing.scene.common.square&&(com.kingdee.bos.qing.scene.common.square={});"undefined"==typeof com.kingdee.bos.qing.scene.common.square.exhibition&&(com.kingdee.bos.qing.scene.common.square.exhibition={});var J=com.kingdee.bos.qing.scene.common.square.exhibition,
Aa,p,Ca,Ia,Z,ja,ca,na,Da,Ha;(function(){var N=com.kingdee.bos.qing.framework.common;Aa=N.AbstractIcons;p=N.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.scene);ca=ca=N.OfficialArticleUtil;N=com.kingdee.bos.qing;Ca=N.CodeLoader;Ia=N.DashboardSquareScene;Z=N.DashboardLongerScene;N=com.kingdee.bos.qing.ui.component;ja=N.MessageDialog;na=N.Dialog;Da=N.Button;N=com.kingdee.bos.qing.common;Ha=N.DomUtil})();J.Icons=new function(){Aa.call(this);var N=this.protectedMethod,z;this.setComboIconImpl=
function(f){z=f};this.protectedInit=function(f,X){if(!z)throw Error("Please setComboIconImpl() first.");z.define(X,"scene-error-image-sprite");X.setStartPosition(1,1);X.setGap(1);X.setIconSize(20,20);N.registIcon(0,0,"icon_qhfInfo");N.registIcon(0,1,"icon_errorclose");z.define(X,"errorbackground");X.setStartPosition(0,0);X.setGap(0);X.setIconSize(200,200);N.registIcon(0,0,"icon_errorbackground");z.define(X,"nodata");N.registIcon(0,1,"icon_nodata")}};J.CardErrorUi=D;J.DsbIntegrationScene=function(){var N,
z,f,X,oa;this.setResetSquare=function(L){X=L};this.setFacade=function(L){f=L};this.setParamPathPrefix=function(L){};this.setMessageCurtain=function(L){z=L};this.setCoreRemoteUrl=function(L){N=L};this.setDesignerSceneCreator=function(L){oa=L};this.createSquareDesignerScene=function(L){var Y=new F;Y.setRemoteUrl(N);L(Y)};this.createLongerDesignerScene=function(L){var Y=new H;Y.setRemoteUrl(N);L(Y)};this.loadImage=function(L,Y,da){var w=L.refToId;w&&0!=$.trim(w).length?(L=f(function(ka){var R=ka.imageHeight;
ka=ka.imageWidth;if(R||ka){var ra=com.kingdee.bos.qing.framework.common.RemoteFramework.getLoadImgUrl(w,"image-library");Y(ra,ka,R)}else da&&da("")},function(ka,R){return!1}),L.setShowBlocking(!1),L.getImageSize(w)):(L=L.widgetSourcePath,da&&da(L))};this.createSquareDesigner=function(L,Y,da,w,ka,R,ra){var qa=new K;qa.setIsSquare(!0);qa.setLoadSchema(function(ia,ea){f(ia,ea).squareLoadSchema(da)});qa.setSaveSchema(function(ia,ea,sa){f(ea,sa).squareSaveSchema(da,ia)});ba(qa,L,Y,da,w,ka,R,ra,!0)};this.createLongerDesigner=
function(L,Y,da,w,ka,R,ra,qa){var ia=new K;ia.setIsSquare(!1);ia.setLoadSchema(function(ea,sa){f(ea,sa).longerLoadSchema(da,qa)});ia.setSaveSchema(function(ea,sa,ya){f(sa,ya).longerSaveSchema(da,ea)});ba(ia,L,Y,da,w,ka,R,ra,!1)};var ba=function(L,Y,da,w,ka,R,ra,qa,ia){var ea=oa(),sa=function(ya){ea.hide();qa(ya)};ea.setIsSquare(L.getIsSquare());ea.setRemoteUrl(N);ea.setRemoteTag(ka);ea.setDesignerOperationJudger(R);ea.setSquareOrLonger(ia);ea.setClosable(da);ea.setAdditionalFilterApi(ra);ea.setSchemaLoader(function(ya,
h){ua(L,w,ya,h,sa)});ea.setSchemaSaver(function(ya){Ba(L,w,ya,sa)});null!=X&&ea.setSchemaReseter(function(ya){X(w,ya,sa)});ea.show(Y,function(){sa(null)})},ua=function(L,Y,da,w,ka){Y.uid?L.getLoadSchema()(function(R){R.model?(da.setJsonModelBook(R.model),w(!0)):w(!1)},function(R,ra){ka();R=R.toString();return"9"==R.substr(0,1)&&6==R.length?(z&&z.showError(p.get("failToLoadSchema","\u52a0\u8f7d\u65b9\u6848\u5931\u8d25\u3002")),!0):!1}):w(!1)},Ba=function(L,Y,da,w){var ka=da.getJsonModelBook();L.getSaveSchema()(ka,
function(R){w(ka)},function(R,ra){if(909002==R)return R=ja.createFeedbackDialog(),R.setMessage(p.get("noSelectMapTemplate","\u8bf7\u9009\u62e9\u5730\u56fe\u6a21\u677f")),R.setMsgImageType(ja.MSG_WARNING),R.setOptionType(ja.OPTION_OK),R.setButtonText(ja.OPTION_OK,p.get("iknow","\u6211\u77e5\u9053\u4e86")),R.showDialog(),!0;w();R=R.toString();return"9"==R.substr(0,1)&&6==R.length?(z&&z.showError(p.get("failToTemporarySchema","\u6682\u5b58\u65b9\u6848\u5931\u8d25\u3002")),!0):!1})}}})();(function(){function D(){Da.call(this);var h,C,G,E,x,U;this.setIsSquare=function(B){G=B};this.protectedIsSquare=function(){return G};this.protectedInitDesigner=function(B){B.getConductor().insertToolbarButton(function(O){C(B)},null,f.get("finish","\u5b8c\u6210"));B.getConductor().insertToolbarSeperator();B.setDesignerOperationJudger(x?null:E,x?E:null);B.setAdditionalFilterApi(U)};this.protectedLoading=function(B,O){h(B,O)};this.setSchemaLoader=function(B){h=B};this.setSchemaSaver=function(B){C=B};
this.setDesignerOperationJudger=function(B){E=B};this.setSquareOrLonger=function(B){x=B};this.protectedIsSquare=function(){return x};this.setAdditionalFilterApi=function(B){U=B}}function K(){com.kingdee.bos.qing.dashboard.AbstractImportUi.call(this);this.protectedInitUi=function(){var h=new ua;h.setText(f.get("fromCardLibrary","\u4ece\u5361\u7247\u5e93\u590d\u5236\u65b9\u6848"));return h};this.doNext=function(h,C,G){C=h.getDsbRemoteImpl();var E=new F;E.setStepContentInfo(h);E.setDsbRemoteImpl(C);
G([E])}}function F(){com.kingdee.bos.qing.dashboard.AbstractImportStep.call(this);var h=this.protectedMethod,C,G,E,x,U,B,O;this.setDsbRemoteImpl=function(b){x=b};this.setStepContentInfo=function(b){U=b};this.over=function(b){b&&(b=U.getAllStepOverCallback())&&b(E,G,!1,B,O)};this.isLastStep=function(){return!0};this.getSubTitle=function(){return f.get("selectCard","\u9009\u62e9\u8981\u590d\u5236\u7684\u5361\u7247")};this.getSuggestedDialogSize=function(){return[810,580]};this.protectedCreateUi=function(){var b=
z.decodeParamFromUrl(location.search,"path"),t=(b?b:"/ierp")+"/qing/publishTo.do",q=new com.kingdee.bos.qing.RemoteImpl;q.setRemoteUrl(t);C=new com.kingdee.bos.qing.publish.CardSelector(q);C.setOuterMessageCurtain(h.getMessageCurtain());C.setParamPathPrefix(b);C.setSingleSelected(!0);return C.getJqUi()};this.intoThisStep=function(b,t){};this.outThisStep=function(b,t){if(b)t();else if(b=C.getSelectedPublishModels(),0<b.length){var q=b[0];b=q.getSchemeId();G=q.getName();q=q.getId();(new com.kingdee.bos.qing.dashboard.DsbFacade(x,
function(d){d.noModeling?h.getMessageCurtain().showPrompt(f.get("noModeling","\u8be5\u5361\u7247\u5bf9\u5e94\u7684\u4e3b\u9898\u6ca1\u6709\u8fdb\u884c\u6570\u636e\u51c6\u5907\uff0c\u5361\u7247\u65e0\u6cd5\u4f7f\u7528\u3002")):d.noTheme?h.getMessageCurtain().showPrompt(f.get("noTheme","\u8be5\u5361\u7247\u5bf9\u5e94\u7684\u4e3b\u9898\u5df2\u88ab\u5220\u9664\uff0c\u5361\u7247\u65e0\u6cd5\u4f7f\u7528\u3002")):(E=d.ref,B=d.model,O=d.operation,t())},function(d,e){return"900001"==d?(t(),h.getMessageCurtain().showError(f.get("failToloadCardContent",
"\u52a0\u8f7d\u5361\u7247\u65b9\u6848\u5931\u8d25\u3002")),!0):!1})).getCardReferenceMap(q,b)}else b=f.get("chooseImportCard","\u8bf7\u9009\u62e9\u8981\u5f15\u5165\u7684\u5361\u7247\u3002"),h.getMessageCurtain().showPrompt(b,2E3)}}function H(){com.kingdee.bos.qing.dashboard.AbstractImportUi.call(this);var h=H.LONGER_TYPE,C=com.kingdee.bos.qing.publish.env.PublishAppMenuFolderNode;this.protectedInitUi=function(){var E=new ua;h===H.EXTREPORT_TYPE?E.setText(f.get("fromAppMenuRef","\u4ece\u5e94\u7528\u83dc\u5355\u5f15\u7528")):
E.setText(f.get("fromAppMenu","\u4ece\u5e94\u7528\u83dc\u5355\u590d\u5236\u65b9\u6848"));return E};this.doNext=function(E,x,U){var B=E.getDsbRemoteImpl();B=new com.kingdee.bos.qing.dashboard.CommonDsbDesignerFacade(B,function(O){var b=O.appmenu;O=O.publish;var t=!1,q=!0,d=new C;d.fromJsonObject(b);d=d.getChildren();b=[];for(var e=0;e<d.length;e++)G(b,d[e]);for(e=0;e<O.length;e++)O[e].publishAppMenuBO.isPreset?t=!0:q=!1;if(0==b.length)x.showPrompt(f.get("noPublish","\u6682\u65e0\u53d1\u5e03\u3002"));
else{switch(h){case H.LONGER_TYPE:d=new Aa;break;case H.EXTREPORT_TYPE:d=new Z;break;default:throw Error("do not support this type!");}d.setAppmenu(b);d.setAppmenuPublish(O);d.setStepContentInfo(E);d.showPresetFilter(t,q);U([d]);d.refreshTable()}},function(O,b){O=b.toString();return"9"==O.substr(0,1)&&6==O.length?(x.showError(f.get("failToGetAppMenu","\u83b7\u53d6\u5e94\u7528\u83dc\u5355\u5931\u8d25\u3002")),!0):!1});h==H.LONGER_TYPE&&B.loadAppMenuTree();h==H.EXTREPORT_TYPE&&B.loadAppMenuTreeForExtreport()};
var G=function(E,x){E.push(x);if(x instanceof C&&(x=x.getChildren()))for(var U=0;U<x.length;U++)G(E,x[U])};this.protectedMethod={setImportType:function(E){h=E}}}function J(){function h(k){KTDefaultCellRender.call(this,k);var u=this,v=this.paintCellUI;this.paintCellUI=function(M,y){var A=u.getCurrentRow(),W=u.getCurrentColIdx();if(u.getCurrentRowIdx()<w.getHeadRowCount()||1==W||2==W)v(M,y);else if(0==W){y=A.getUserObject();A=new ua;Ka.addElement(A);O&&O.getPublishAppMenuBO().formParams.publishId==
y.getPublishAppMenuBO().formParams.publishId&&A.setChecked(!0);A.setUserObject(y);W=A.getJqUi();A=$("<div class='appmenu-publish-item-btn-name'>");if(ma){var S=y.getPublishAppMenuBO().qingMenuName;if(ma&&S){var pa=ma.toUpperCase(),ta=S.toUpperCase(),wa=ta.split(pa),Fa=pa.length;for(Ga in wa){var xa=ta.indexOf(wa[Ga]),Ma=S.substr(La,wa[Ga].length);xa+=wa[Ga].length;var Ja=ta.length-xa;ta=ta.substr(xa,Ja);S=S.substr(xa,Ja);xa=$("<span>");xa.text(Ma);xa.appendTo(A);if(Ga!=wa.length-1&&1<wa.length){var La=
ta.indexOf(pa);Ma=S.substr(La,Fa);xa=La+Fa;Ja=ta.length-xa;ta=ta.substr(xa,Ja);S=S.substr(xa,Ja);xa=$("<span>");xa.text(Ma);xa.css("color","red");xa.clone().appendTo(A)}}}else A.text(S)}else A.text(y.getPublishAppMenuBO().qingMenuName);W.addClass("appmenu-publish-item-btn");W.appendTo(M);if(y.getPublishAppMenuBO().isPreset){var Ga=$("<div>");Ga.text(f.get("preset","\u9884\u7f6e"));Ga.addClass("appmenu-publish-item-btn-preset-tag");Ga.appendTo(M)}A.appendTo(M)}}}com.kingdee.bos.qing.dashboard.AbstractImportStep.call(this);
var C=this,G=this.protectedMethod,E,x,U,B,O,b,t,q,d,e,aa,la=com.kingdee.bos.qing.publish.common.FilterModelType,P=com.kingdee.bos.qing.publish.common.CardFilterType,V,T,I=!1,fa=[new P(f.get("myLonger","\u6211\u7684\u5206\u6790"),!1),new P(f.get("presetLonger","\u9884\u7f6e\u5206\u6790"),!0)],ha=[void 0,void 0],Ea=!1,va,ma="",za,Ka=new L;Ka.addChangedListener(function(k,u){O=k.getUserObject()?k.getUserObject():O});var a=new da;a.setFormatString("yyyy-MM-dd HH:mm:ss");this.isLastStep=function(){return!1};
this.setStepContentInfo=function(k){E=k};this.setAppmenu=function(k){x=k};this.setAppmenuPublish=function(k){U=k};this.showPresetFilter=function(k,u){T=k;(I=u)&&fa.reverse()};this.refreshTable=function(){e&&w.refresh(e)};this.getSubTitle=function(){return f.get("selectAppmenu","\u9009\u62e9\u5df2\u53d1\u5e03\u9879")};this.protectedCreateUi=function(){var k=$("<div>"),u=$("<div>"),v=g,M=new la;M.setSearchType(fa);M.setSelectedChangedListener(v);V=M.getJqUi();V.css({top:"-4px",left:"6px"});V.appendTo(u);
!T&&V.hide();va?v=va.getJqUi():(va=new ka,va.addSearchListener(m),va.setSearchListenerDelay(100),va.setPlaceholder(f.get("searchBoxPlaceholder","\u641c\u7d22\u53d1\u5e03\u540d\u79f0")),va.setShowSearchIcon(!0),v=va.getJqUi(),v.addClass("import-longer-from-appmenu-search-box"),v.css({position:"relative",width:"175px",height:"23px"}));v.appendTo(u);u.appendTo(k);u=$("<div>");u.addClass("import-longer-from-appmenu");for(v=0;v<x.length;v++){M=x[v];var y=M;var A=[];for(var W=y.getAppId(),S=y.getAppMenuId(),
pa=y.getAppMenuId2(),ta=W?S?pa?pa:S:W:null,wa=0;wa<U.length;wa++)y=new Ca,y.fromJsonObject(U[wa]),W=y.getPublishAppMenuBO().appId,S=y.getPublishAppMenuBO().appMenuId,pa=y.getPublishAppMenuBO().appMenuId2,ta===(W?S?pa?pa:S:W:null)&&A.push(y);A&&0<A.length&&M.setPublishModels(A)}B=new p;za=b=l();B.setCurrentNode(za);B.setTreeItemSelectedListener(r);c();B.getJqUi(x).appendTo(u);d=$("<div>");d.addClass("appmenu-publish-table");e=w.createTable();w.bindTableListenerForCtrl(e);v=new h(e);v.setOutsideVisible(!1);
e.setCellRender(v);e.addColumns(3);e.getColumn(0).setWidth(220);e.getColumn(1).setWidth(90);e.getColumn(2).setWidth(150);v=w.createHeadRow(e);v.getCell(0).setValue(f.get("publishName","\u53d1\u5e03\u540d\u79f0"));v.getCell(1).setValue(f.get("publishPerson","\u53d1\u5e03\u4eba"));v.getCell(2).setValue(f.get("publishTime","\u53d1\u5e03\u65f6\u95f4"));v=b.getPublishModels();M=!1;for(A=0;A<v.length;A++)S=v[A],I==S.getPublishAppMenuBO().isPreset&&(M||(O=S,M=!0),W=w.createRow(e),W.setUserObject(S),W.getCell(0).setValue(S.getPublishAppMenuBO().name),
W.getCell(1).setValue(S.getPublishPersonName()),S=Number(S.getPublishAppMenuBO().formParams.publishTime),W.getCell(2).setValue(a.format(S)));w.refresh(e);t=$(e.getUI());t.appendTo(d);d.appendTo(u);u.appendTo(k);return k};var c=function(){for(var k=0;k<x.length;k++)x[k].setIsShow(!1);for(k=0;k<x.length;k++){var u;if(u=x[k].getPublishModels())a:{u=x[k].getPublishModels();for(var v=0;v<u.length;v++)if(u[v].getPublishAppMenuBO().isPreset==I){u=!0;break a}u=!1}if(u)for(u=x[k],u.setIsShow(!0);u.getParentNode()&&
u.getParentNode().getDisplayName();)u=u.getParentNode(),u.getIsShow()||u.setIsShow(!0)}},g=function(k,u,v){I=v.getTypeId();c();I?(ha[1]=B.getCurrentNode(),ha[0]||(k=l(),ha[0]=k),r(ha[0]),B.setCurrentNode(ha[0])):(ha[0]=B.getCurrentNode(),ha[1]||(k=l(),ha[1]=k),r(ha[1]),B.setCurrentNode(ha[1]));m()},l=function(){for(var k=0;k<x.length;k++){for(var u=x[k],v=u.getPublishModels(),M=[],y=0;v&&y<v.length;y++)v[y].getPublishAppMenuBO().isPreset==I&&M.push(v[y]);if(v&&0<M.length)return u}},m=function(){ma=
va.getText().trim();if(0<ma.length){Ea=!0;for(var k={},u=0;u<x.length;u++){var v=0,M=x[u],y=M.getPublishModels();if(y&&0<y.length)for(var A=0;A<y.length;A++){var W=y[A],S=-1<W.getPublishAppMenuBO().qingMenuName.toUpperCase().indexOf(ma.toUpperCase());I==W.getPublishAppMenuBO().isPreset&&S&&v++}A=M;M=A.getAppId();y=A.getAppMenuId();A=A.getAppMenuId2();k[M?y?A?M+y+A:M+y:M:null]=v}Q(za.getPublishModels(),!1);B.setSearchStatus(!0);B.updateTreeUi(x,k)}else Ea=!1,Q(za.getPublishModels(),!1),B.setSearchStatus(!1),
B.updateTreeUi(x)},r=function(k){za=k;(k=k.getPublishModels())&&0<k.length?Q(k,!0):n()},n=function(){t&&t.hide();if(q)q.show();else{q=$("<div>");q.css({position:"absolute",height:"82%",width:"100%",top:"33px"});aa=$("<div>");aa.text(f.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));Y.layoutCtrlCenterAlign(aa,444);aa.css({height:"20px","line-height":"20px","text-align":"center","font-size":"16px",color:"#BBBBBB",top:"50%","margin-top":"98.5px"});aa.appendTo(q);
var k=$("<div>");ja.Icons.background(k,"no-data");Y.layoutCtrlCenterAlign(k,187);k.css({"background-size":"contain",top:"50%",height:"187px","margin-top":"-113.5px"});k.appendTo(q);d.append(q)}k=ma?f.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"):f.get("noData","\u6682\u65e0\u53d1\u5e03\u8bb0\u5f55");aa.text(k)},Q=function(k,u){t&&t.show();q&&q.hide();w.clearWithoutHead(e);for(var v=0,M,y=0;k&&y<k.length;y++){var A=k[y];if(I==A.getPublishAppMenuBO().isPreset){u&&
!M&&(O=A,M=!0);var W=-1<A.getPublishAppMenuBO().qingMenuName.toUpperCase().indexOf(ma.toUpperCase());if(!Ea||W)W=w.createRow(e),W.setUserObject(A),W.getCell(0).setValue(A.getPublishAppMenuBO().qingMenuName),W.getCell(1).setValue(A.getPublishPersonName()),A=Number(A.getPublishAppMenuBO().formParams.publishTime),W.getCell(2).setValue(a.format(A)),v++}}0===v&&n();C.refreshTable()};this.intoThisStep=function(k,u){};this.outThisStep=function(k,u){k?u():null==O?G.getMessageCurtain().showPrompt(f.get("notSelectAppMenuPublish",
"\u672a\u9009\u4e2d\u53d1\u5e03\u4fe1\u606f\u3002")):(k=O.getPublishAppMenuBO(),C.protectedDoNext(k,E,u))};this.protectedDoNext=function(k,u,v){throw Error("overwrite me!");};this.protectedMethod.getStepContentInfo=function(){return E}}function Aa(){J.call(this);var h=this.protectedMethod;this.protectedDoNext=function(C,G,E){var x=C.formParams.publishId;C=G.getDsbRemoteImpl();(new com.kingdee.bos.qing.dashboard.CommonDsbDesignerFacade(C,function(U){if(U.noModeling)h.getMessageCurtain().showPrompt(f.get("publishOfSubjectNoModeling",
"\u8be5\u53d1\u5e03\u5bf9\u5e94\u7684\u4e3b\u9898\u6ca1\u6709\u8fdb\u884c\u6570\u636e\u51c6\u5907\uff0c\u65e0\u6cd5\u4f7f\u7528\u3002"));else if(U.noTheme)h.getMessageCurtain().showPrompt(f.get("publishOfSubjectBeDeleted","\u8be5\u53d1\u5e03\u5bf9\u5e94\u7684\u4e3b\u9898\u5df2\u88ab\u5220\u9664\uff0c\u65e0\u6cd5\u4f7f\u7528\u3002"));else{var B=new com.kingdee.bos.qing.dashboard.ImportLongerThirdStep;B.setPublishType("appmenu_qing");B.setPublishId(x);G.setSchema(U);G.setImportSourceIsPublish(!0);B.setStepContentInfo(G);
E([B])}},function(U,B){U=U.toString();return"9"==U.substr(0,1)&&6==U.length?(h.getMessageCurtain().showError(f.get("failToGetPublishSchemaList","\u83b7\u53d6\u53d1\u5e03\u65b9\u6848\u5217\u8868\u5931\u8d25\u3002")),!0):!1})).getPublishSchema(x)}}function p(){function h(d){KTDefaultCellRender.call(this,d);var e=this;this.paintCellUI=function(P,V){var T=e.getCell(),I=T.getValue();T=aa(I,T);V?(P=$(V),T.appendTo(P)):(P=$(P),T.appendTo(P))};var aa=function(P,V){V=P.getDisplayName();var T=$("<div>");T.addClass("appmenu-item ");
var I=$("<div>");I.css({overflow:"hidden","max-width":"96px","text-overflow":"ellipsis"});var fa=ya.createWarning();Y.layoutCtrl(fa,0,12);V==b.CLOUD_HAS_BEEN_DELETED?(V=f.get("cloudHasBeenDeleted","\u8be5\u670d\u52a1\u4e91\u5df2\u88ab\u5220\u9664"),I.css({"margin-left":"6px",overflow:"unset"}),T.append(fa)):V==b.APP_HAS_BEEN_DELETED?(V=f.get("appHasBeenDeleted","\u8be5\u5e94\u7528\u5df2\u88ab\u5220\u9664"),I.css({"margin-left":"6px",overflow:"unset"}),T.append(fa)):V==b.APP_MENU_HAS_BEEN_DELETED&&
(V=f.get("appMenuHasBeenDeleted","\u8be5\u5e94\u7528\u83dc\u5355\u5df2\u88ab\u5220\u9664"),I.css({"margin-left":"6px",overflow:"unset"}),T.append(fa));T.attr("title",V);fa.attr("title",V);I.text(V);0<P.getSubNodeLevel()&&(T.css("cursor","pointer"),q(O)===q(P)&&T.addClass("appmenu-item-selected"),T.on("mousedown",function(ha){q(O)!==q(P)&&(C.find(".appmenu-item-selected").removeClass("appmenu-item-selected"),T.addClass("appmenu-item-selected"),O=P,x&&x(P))}));T.append(I);Y.layoutCtrlWithLRTB(T,0,0,
null,0,0,null);U&&0<P.getSubNodeLevel()&&la(I,T,P,V);return T},la=function(P,V,T,I){T=B[q(T)];var fa="("+T+")",ha=$("<div>");ha.addClass(0<T?"appmenu-item-search-hits-number-with-color":"appmenu-item-search-hits-number");ha.text(fa);P.append(ha);V.attr("title",I+" "+fa)}}var C,G,E,x,U=!1,B,O,b=com.kingdee.bos.qing.publish.env.AbstractPublishAppMenuNode;this.setTreeItemSelectedListener=function(d){x=d};this.setCurrentNode=function(d){O=d};this.getCurrentNode=function(){return O};this.setSearchStatus=
function(d){U=d};this.getJqUi=function(d){C||(C=$("<div>"),C.append(t(d)));return C};var t=function(d){E=G=null;G=new KTable;E=$(G.getUI());E.children().css("overflow-x","hidden");G.setCellRender(new h(G));G.setSyncUIWhenModelChanged(!1);G.addColumn().setWidth(170);var e=new KTStyle;e.setVerticalAlign("middle");G.setStyle(e);e=G;for(var aa=0;aa<d.length;aa++){var la=d[aa];if(la.getIsShow()){var P=e.addRow();P.setHeight(36);P=P.getCell(0);P.setValue(la);la=la.getSubNodeLevel();la=new KTCellTreeModel(la);
P.setTreeModel(la)}}G.updateUI();E.addClass("appmenu-table");return E};this.updateTreeUi=function(d,e){C.empty();U&&(B=e);t(d).appendTo(C)};var q=function(d){var e=d.getAppId(),aa=d.getAppMenuId();d=d.getAppMenuId2();return e?aa?d?e+aa+d:e+aa:e:null}}function Ca(){var h,C;this.getPublishAppMenuBO=function(){return h};this.setPublishAppMenuBO=function(G){h=G};this.setPublishPersonName=function(G){C=G};this.getPublishPersonName=function(){return C};this.fromJsonObject=function(G){h=G.publishAppMenuBO;
C=G.publishPersonName}}function Ia(){H.call(this);this.protectedMethod.setImportType(H.EXTREPORT_TYPE)}function Z(){J.call(this);var h=this.protectedMethod,C,G,E;this.getSubTitle=function(){return f.get("selectPublishedQingreport","\u9009\u62e9\u5df2\u53d1\u5e03\u7684\u62a5\u8868")};this.isLastStep=function(){return!0};this.over=function(x){x&&((x=h.getStepContentInfo().getAllStepOverCallback())&&x(E,G),x=com.kingdee.bos.qing.dashboard.UserOperationReporter,x.occur(x.DSB_IMPORT_EXREPORT_TYPE,x.IMPORT_EXTREPORTAPP))};
this.protectedDoNext=function(x,U,B){x=x.formParams;C=x.publishId;G=x.caption;x=h.getStepContentInfo().getDsbRemoteImpl();(new com.kingdee.bos.qing.dashboard.CommonDsbDesignerFacade(x,function(O){E=O.ref;B()},function(O,b){})).getPublishReferenceMap(C,"appmenu_rpt")}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&
(com.kingdee.bos.qing.scene={});"undefined"==typeof com.kingdee.bos.qing.scene.common&&(com.kingdee.bos.qing.scene.common={});"undefined"==typeof com.kingdee.bos.qing.scene.common.designer&&(com.kingdee.bos.qing.scene.common.designer={});var ja=com.kingdee.bos.qing.scene.common.designer;ja.AbstractDashboardDesignerSceneImpl=function(){na.call(this);var h=this,C=this.protectedMethod,G,E,x=!0,U,B,O;this.protectedSetSourceDetail=function(a,c){throw Error("override me");};this.protectedGetSourceDetail=
function(){throw Error("override me");};this.protectedGetRemoteUrl=function(){throw Error("override me");};this.protectedLoading=function(a,c,g){throw Error("override me");};this.addDsbResourceLock=function(){throw Error("override me");};this.setCloseResourceLock=function(a){O=a};this.protectedSaveModel=function(a){throw Error("override me");};this.protectedOverrideDsbSource=function(a){throw Error("override me");};this.protectedCreateNewDsb=function(a,c,g){throw Error("override me");};this.protectedListUnpresetThemeGroup=
function(){throw Error("override me");};this.protectedInitBehaviorManager=function(){};this.protectedCreateFacade=function(a,c,g){return new com.kingdee.bos.qing.dashboard.DsbFacade(a,c,g)};this.protectedImportMoreCode=function(a){a.pushSkinJs("scene","skin");a.pushI18n("scene","scene");a.pushJs("biz-common/qing-biz-common.js");a.pushSkinCss("biz-common","biz-common");a.pushSkinJs("biz-common","skin");a.pushI18n("biz-common","biz-common");a.pushJs("common/qing-schedule.js");a.pushI18n("common","qing-schedule");
a.pushSkinCss("publish","qing-publish");a.pushSkinJs("publish","skin");a.pushI18n("publish","publish");a.pushJs("schema-manage/schema-manage-initialize.js");a.pushJs("schema-manage/schema-manage-ui.js");a.pushJs("publish/qing-publish.js");a.pushSkinCss("timedpush","qing-timedpush");a.pushSkinJs("timedpush","skin");a.pushI18n("timedpush","timedpush");a.pushJs("timedpush/qing-timedpush.js");a.pushJs("lightapp/common/qing-lapp-env.js");a.pushJs("timedpush/qing-timedpush-lapp.js");a.pushSkinJs("imagelib",
"skin");a.pushI18n("dashboard","dsb-integration");a.pushSkinCss("imagelib","qing-imagelib");a.pushJs("imagelib/imagelib.js");a.pushI18n("imagelib","imagelib");a.pushSkinJs("dashboard","skin-dsb-integration");a.pushJs("dashboard/dsb-integration.js");a.pushSkinCss("dashboard","dsb-integration");a.pushSkinJs("linkage","skin");a.pushJs("linkage/linkage.js");a.pushSkinCss("linkage","linkage");a.pushSkinJs("map-designer","integration-skin");a.pushJs("map-designer/map-integration.js");a.pushSkinCss("map-designer",
"map-integration");a.pushI18n("map-designer","map-integration");a.pushJs("qhf/qing-qhf.js");a.pushSkinJs("theme-manage","skin");a.pushJs("theme-manage/qing-theme-manage.js")};this.protectedCustomInitEnv=function(){com.kingdee.bos.qing.integration.TabStatusHelper.setMyI18n(f.get("confirmExit","\u68c0\u6d4b\u5230\u60a8\u6709\u66f4\u6539\u5185\u5bb9\uff0c\u662f\u5426\u4e0d\u4fdd\u5b58\u76f4\u63a5\u9000\u51fa\uff1f\u82e5\u4e0d\u4fdd\u5b58\uff0c\u5c06\u4e22\u5931\u8fd9\u4e9b\u66f4\u6539\u3002"),f.get("sureExit",
"\u76f4\u63a5\u9000\u51fa"),f.get("sureReturn","\u8fd4\u56de\u7f16\u8f91"));U=com.kingdee.bos.qing.theme.model.ThemeGroupModel;B=com.kingdee.bos.qing.theme.model.ThemeModel;var a=com.kingdee.bos.qing.map.common.Integration,c=z.decodeParamFromUrl(location.search,"path");c=c?c:"/ierp";a.setRemoteUrl(c+"/qing/mapManage.do");var g=new com.kingdee.bos.qing.map.integration.MapSelectorDialog;com.kingdee.bos.qing.core.MapLibraryRegister.registerTemplateSelector(function(l,m){g.setParamPathPrefix(c);g.showDialog(l,
m)});com.kingdee.bos.qing.integration.ImglibUrlParser.hookUrlParser();h.protectedInitBehaviorManager()};this.protectedRegisterImplements=function(a){var c=new com.kingdee.bos.qing.dashboard.WidgetSourceSelector;c.setDsbRemoteImpl(h.getRemoteImpl());c.setParamPathPrefix(za());c.setCustomLongerImportFuncTypes([H]);c.setCustomSquareImportFuncTypes([K]);c.setCustomQingReportImportFuncTypes([Ia]);var g=new com.kingdee.bos.qing.scene.common.square.exhibition.DsbIntegrationScene;a.registerBuiltinVisualWidgetEditableConfirmerParser(function(l){var m=
l.operation?l.operation:{};l=l.scene;var r=com.kingdee.bos.qing.publish.model.OperType,n=m[r.SQUARE];m=m[r.LONGER];return"square"==l?new com.kingdee.bos.qing.publish.model.RtSquareEditableConfirmerModel(n|m):"longer"==l?new com.kingdee.bos.qing.publish.model.RtLongerEditableConfirmerModel(m):null});g.setFacade(function(l,m){return h.protectedCreateFacade(h.getRemoteImpl(),l,m)});g.setParamPathPrefix(za());g.setMessageCurtain(ma());g.setCoreRemoteUrl(h.getCoreRemoteUrl());g.setDesignerSceneCreator(function(){return new D});
a.registerWidgetSourceSelector(c);a.registerPictrueLoader(function(l,m,r){g.loadImage(l,m,r)});a.registerSquareDesignerCreator(function(l,m,r,n,Q,k,u){E&&E.setCurrentLinkageTag(n);g.createSquareDesigner(l,m,r,n,Q,k,u)});a.registerSquareSceneCreator(function(l,m){g.createSquareDesignerScene(m)});a.registerLongerDesignerCreator(function(l,m,r,n,Q,k,u){E&&E.setCurrentLinkageTag(n);g.createLongerDesigner(l,m,r,n,Q,k,u)});a.registerLongerSceneCreator(function(l,m){g.createLongerDesignerScene(m)});c=new com.kingdee.bos.qing.dashboard.qingreport.QingReportExecutor;
c.setDsbRemoteImpl(h.getRemoteImpl());a.registerQingReportExecutor(c)};this.protectedInitDesigner=function(a){x&&Ka();a.getConductor().setDirtyListener(function(c){Ba.setTabStatus(c)});"true"!=C.getUrlParamUtil().getUrlParam("isPreset")?a.getConductor().insertToolbarButton(function(){h.protectedSaveModel(a)},"btn_save",f.get("save","\u4fdd\u5b58"),f.get("save","\u4fdd\u5b58")):ma().showPrompt(f.get("presetDsbTips","\u9884\u7f6e\u7684\u4eea\u8868\u677f\u4e0d\u5141\u8bb8\u4fdd\u5b58\u3001\u53d1\u5e03\u7b49\u64cd\u4f5c\uff0c\u5982\u6709\u9700\u8981\uff0c\u53ef\u590d\u5236\u540e\u518d\u8fdb\u884c\u64cd\u4f5c\u3002"),
-1)};var b=function(a){var c=f.get("publishSourceColons","\u53d1\u5e03\u6765\u6e90\uff1a");h.checkDsbIsOpened(function(){var g=f.get("SyncSchemaPublishConfirm","\u540c\u6b65\u540e\uff0c\u5f53\u524d\u4eea\u8868\u677f\u5185\u5bb9\u5c06\u4f1a\u8986\u76d6\u53d1\u5e03\u6765\u6e90\uff0c\u786e\u5b9a\u540c\u6b65\u5417\uff1f");h.showSyncConfirm(g,c,a.getUserObject())},function(){var g=f.get("SyncSchemaPublishRefuse","\u6b63\u5728\u7f16\u8f91\u8be5\u53d1\u5e03\u8bb0\u5f55\u5bf9\u5e94\u7684\u53d1\u5e03\u6765\u6e90\uff0c\u8bf7\u5148\u5173\u95ed\u53d1\u5e03\u6765\u6e90\u9875\u9762\u518d\u8fdb\u884c\u540c\u6b65\u64cd\u4f5c\u3002");
h.showSyncRefused(g,!0,c)})},t=function(a){var c=f.get("TPSourceColons","\u63a8\u9001\u6765\u6e90\uff1a");h.checkDsbIsOpened(function(){var g=f.get("SyncSchemaTPConfirm","\u540c\u6b65\u540e\uff0c\u5f53\u524d\u4eea\u8868\u677f\u5185\u5bb9\u5c06\u4f1a\u8986\u76d6\u63a8\u9001\u6765\u6e90\uff0c\u786e\u5b9a\u540c\u6b65\u5417\uff1f");h.showSyncConfirm(g,c,a.getUserObject())},function(){var g=f.get("SyncSchemaTPRefuse","\u6b63\u5728\u7f16\u8f91\u8be5\u63a8\u9001\u8bb0\u5f55\u5bf9\u5e94\u7684\u63a8\u9001\u6765\u6e90\uff0c\u8bf7\u5148\u5173\u95ed\u63a8\u9001\u6765\u6e90\u9875\u9762\u518d\u8fdb\u884c\u540c\u6b65\u64cd\u4f5c\u3002");
h.showSyncRefused(g,!0,c)})};this.checkDsbIsOpened=function(a,c){throw Error("override me");};this.protectedCheckPublishLogExist=function(a,c){throw Error("override me");};var q=function(a){h.protectedCheckPublishLogExist(function(){d&&d(a)},function(){console&&console.log("\u5f39\u7a97\u63d0\u793alog\u88ab\u5220\u9664")})},d=function(a){var c=[];h.protectedListUnpresetThemeGroup(function(g){if(g)for(var l=0;l<g.length;l++){var m=new U;m.fromJsonObject(g[l]);c.push(m)}g=a.getUserObject();l=new e;
l.setThemeGroupModel(c);l.addSuccessCallback(g);l.createDialog().show();return!0})};this.showSyncConfirm=function(a,c,g){var l=com.kingdee.bos.qing.ui.component.MessageDialog,m=l.createFeedbackDialog();m.setOptionType(l.OPTION_OK_CANCEL);m.setMessage(a);m.setClosingChecker(function(r){r==l.RETURN_OK&&g&&g();return!0});m.setBounds(380,330,0,0);m.setExtendPainter(function(r,n){var Q=h.protectedGetSourceDetail(),k=$("<div>");k.addClass("sa-ctrl-feedback-dialog-text");k.text(n);k.attr("title",n);k.appendTo(r);
n=$("<div>");n.addClass("sa-ctrl-feedback-dialog-text");n.css({color:"#999999",height:"60px",top:"53px"});n.text(c+Q);n.attr("title",c+Q);n.appendTo(r)});m.showDialog()};this.showSyncRefused=function(a,c,g){var l=function(n,Q){var k=h.protectedGetSourceDetail(),u=$("<div>");u.addClass("sa-ctrl-feedback-dialog-text");u.text(Q);u.attr("title",Q);u.appendTo(n);Q=$("<div>");Q.addClass("sa-ctrl-feedback-dialog-text");Q.css({top:"60px",height:"40px",color:"#999999"});Q.text(g+k);Q.attr("title",g+k);Q.appendTo(n)},
m=com.kingdee.bos.qing.ui.component.MessageDialog,r=m.createFeedbackDialog();r.setOptionType(m.OPTION_OK);r.setMsgImageType(m.MSG_WARNING);r.setButtonText(m.OPTION_OK,f.get("iknow","\u6211\u77e5\u9053\u4e86"));r.setMessage(a);c&&(r.setBounds(380,310,0,0),r.setExtendPainter(l));r.showDialog()};var e=function(){var a=new B,c=[400,380],g=[],l,m,r,n,Q=[];this.addSuccessCallback=function(v){g.push(v)};this.setThemeGroupModel=function(v){Q=v};this.createDialog=function(){var v=$(document.body),M=$("<div class='sa-ctrl-common-modallayer'>");
M.appendTo(v);var y=new ra(M);y.setSelectable(!0);y.setTitle(f.get("SyncSchemaToNewDSB","\u53e6\u5b58\u4e3a\u65b0\u4eea\u8868\u677f"));var A=c[0],W=c[1],S=v.prop("clientWidth"),pa=v.prop("clientHeight");y.setBounds(S-A>>1,pa-W>>1,A,W);y.setToolbarVisible(!1);y.setContent(u());y.showFooterPane();M.appendTo(v);var ta=function(){y.destroy();M.remove()};y.addClosingListener(function(wa,Fa){Fa?k(ta,wa.getMessageCurtain()):ta()});return y};var k=function(v,M){var y=$.trim(m.getText()),A=$.trim(r.getText()),
W=function(pa){1010003==pa?(pa=f.get("duplicateDSBNameInCategory","\u8be5\u5206\u7c7b\u4e0b\u5b58\u5728\u540c\u540d\u4eea\u8868\u677f\u3002"),M.showPrompt(pa,2E3)):null==pa&&v()},S;""!=y&&50<y.length?S=f.get("nameTooLong","\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):""==y&&(S=f.get("nameCannotBeEmpty","\u8bf7\u8f93\u5165#1\u540d\u79f0\u3002").replace("#1","\u4eea\u8868\u677f"));""!=A&&500<A.length&&(S=f.get("descriptionTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7500\u4e2a\u5b57\u7b26\u3002"));
if(S)M.showPrompt(S,2E3);else for(a.setThemeName(y),a.setThemeGroupID(l),a.setThemeDescription(A),a.setThemeType("1"),a.setIsPreset(!1),y=0;y<g.length;y++)(A=g[y])&&A(a,W)},u=function(){var v=$("<div>"),M=new qa;M.setRequired(!0);M.setText(f.get("category","\u5206\u7c7b"));M=M.getJqUi();var y=Q[0];l=y.getThemeGroupID();n=new ia;n.setItemModels(Q);n.setSelected(y);n.setCustomPainter(function(ta,wa,Fa){wa.text(Fa.getThemeGroupName())});n.addSelectedChangedListener(function(ta,wa,Fa){l=Fa.getThemeGroupID()});
y=n.getJqUi();var A=new qa;A.setRequired(!0);A.setText(f.get("themeName","\u540d\u79f0"));A=A.getJqUi();m=new ea;m.setText(a.getThemeName());var W=m.getJqUi(),S=new qa;S.setText(f.get("description","\u63cf\u8ff0"));S=S.getJqUi();r=new sa;r.setText(a.getThemeDescription());var pa=r.getJqUi();M.appendTo(v);y.appendTo(v);A.appendTo(v);W.appendTo(v);S.appendTo(v);pa.appendTo(v);Y.layoutCtrl(M,8,0,70,23);Y.layoutCtrl(y,76,0,280,23);Y.layoutCtrl(A,8,48,70,23);Y.layoutCtrl(W,76,48,280,23);Y.layoutCtrl(S,
8,96,70,23);Y.layoutCtrl(pa,76,100,280,120);return v}},aa=function(a){a=new com.kingdee.bos.qing.publish.permission.PermLabelManageDialog(I());a.setSpaceID(Ha.getUrlParamValue("qingID"));a.showDialog()},la=function(){var a=C.getUrlParamUtil().getParamPathPrefix();com.kingdee.bos.qing.timedpush.LappIntegration.setLappPrivateUrl(a+"/qing/lappPrivateInfo.do")},P=function(){return function(a,c,g){var l=com.kingdee.bos.qing.publish.model.PublishTargetType;if(g&&l.MOBILE==g){g=a.getPublishId();var m=a.getId()}else g=
a.getId();l=C.getUrlParamUtil().getParamPathPrefix();var r=ca.getUrlParamValue(),n=C.getUrlParamUtil().getParamLanguage();l=z.appendParamToUrl((l?l:"/ierp")+"/qing/publishContentEditEntrance.do","skin",r);l=z.appendParamToUrl(l,"language",n);l=z.appendParamToUrl(l,"publishId",g);m&&(l=z.appendParamToUrl(l,"lappId",m));m=l;c&&(g="editPublishedContent-"+g,n=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,n.putSubscribe(g,c),l=z.appendParamToUrl(l,"subscribeKey",g),l=z.appendParamToUrl(l,
"currentPageClientId",n.getCurrentPageClientId()));com.kingdee.bos.qing.framework.common.TabbedUiUtil.openNewTab(f.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+a.getName(),l,m)}},V=function(){return function(a){var c=C.getUrlParamUtil().getParamPathPrefix();c=(c?c:"/ierp")+"/qing/timedPushContentEditEntrance.do";var g=f.get("editTimedPushContent","\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(a instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var l=a.getId(),m=a.getPublishSourceType();
r=a.getSchemaSourceType();c=z.appendParamToUrl(c,"configId",l);c=z.appendParamToUrl(c,"publishSourceType",m);c=z.appendParamToUrl(c,"schemaType",r);c=z.appendParamToUrl(c,"pushTarget","email");g=g+"-"+a.getNameRule().getName();a.isSourceNameNotFound()&&(c=z.appendParamToUrl(c,"errorCode","2301001"))}else{l=a.getId();m=a.getPushTargetType();var r=a.getSchemaType();c=z.appendParamToUrl(c,"configId",l);c=z.appendParamToUrl(c,"pushTargetType",m);c=z.appendParamToUrl(c,"schemaType",r);c=z.appendParamToUrl(c,
"pushTarget","lapp");g=g+"-"+a.getName();a.getSourceName()||(c=z.appendParamToUrl(c,"errorCode","2301001"))}a=ca.getUrlParamValue();r=C.getUrlParamUtil().getParamLanguage();a&&(c=z.appendParamToUrl(c,"skin",a));r&&(c=z.appendParamToUrl(c,"language",r));com.kingdee.bos.qing.framework.common.TabbedUiUtil.openNewTab(g,c)}},T=function(a){var c=com.kingdee.bos.qing.publish.model,g=c.PublishSourceType;c=com.kingdee.bos.qing.publish.common;var l=c.PublishContext;c=new l;c.setBizTag(C.getUrlParamUtil().getUrlParam("dsbId"));
c.setCurrentSourceType(g.DASHBOARD);c.setCurrentContentModel(a);c.setScene(l.Scene.Dashboard);a=za();c.setParamPathPrefix(a);c.setLappEntranceUrl(a+"/qing/lappEntrance.do");c.setSpaceID(Ha.getUrlParamValue("qingID"));return c},I=function(){var a=za()+"/qing/publishTo.do",c=new com.kingdee.bos.qing.RemoteImpl;c.setRemoteUrl(a);return c},fa=function(a){return 0==a.page.widgets.length?!1:!0},ha=function(){var a=ca.getUrlParamValue(),c=C.getUrlParamUtil().getParamLanguage(),g=za()+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";
a&&(g=z.appendParamToUrl(g,"skin",a));c&&(g=z.appendParamToUrl(g,"language",c));return g},Ea=function(){var a=ca.getUrlParamValue(),c=C.getUrlParamUtil().getParamLanguage(),g=za()+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";a&&(g=z.appendParamToUrl(g,"skin",a));c&&(g=z.appendParamToUrl(g,"language",c));return g};this.getCoreRemoteUrl=function(){return za()+"/qing/core.do"};var va=function(a){a.getConductor().isDirty()?(Ba.showConfirmExitDialog(),O&&Ba.setClosingListener(O)):
O?O(function(){N.closeCurrentTab()}):N.closeCurrentTab()},ma=function(){G||(G=new X,G.getJqUi().appendTo($(document.body)));return G},za=function(){var a=C.getUrlParamUtil().getParamPathPrefix();return a?a:"/ierp"},Ka=function(){var a=za()+"/qing/linkage.do",c=com.kingdee.bos.qing.integration.LinkageJumper;E=new com.kingdee.bos.qing.linkage.LinkageManage;E.initDesigntime(a,c.jump)};this.protectedMethod.getMessageCurtain=ma;this.protectedMethod.hookCloseTab=function(a){a.getConductor().appendToolbarButton(function(){va(a)},
"error_close",f.get("closeTab","\u9000\u51fa"))};this.protectedMethod.hookSyncPublishToDsb=function(a){var c=f.get("SchemeSynced","\u540c\u6b65\u4e0e\u53e6\u5b58"),g=f.get("SyncSchemaToDSB","\u540c\u6b65\u56de\u539f\u4eea\u8868\u677f"),l=f.get("SyncSchemaToNewDSB","\u53e6\u5b58\u4e3a\u65b0\u4eea\u8868\u677f"),m=new oa,r=new ba(b);r.setText(g);r.setUserObject(function(){h.protectedOverrideDsbSource(a)});m.addItemModel(r);g=new ba(q);g.setText(l);g.setUserObject(function(n,Q){h.protectedCreateNewDsb(a,
n,Q)});m.addItemModel(g);a.getConductor().appendToolbarMenu(m,"sync_scheme_to_publish",c)};this.protectedMethod.hookSyncTimePushToDsb=function(a){var c=f.get("SchemeSynced","\u540c\u6b65\u4e0e\u53e6\u5b58"),g=f.get("SyncSchemaToDSB","\u540c\u6b65\u56de\u539f\u4eea\u8868\u677f"),l=f.get("SyncSchemaToNewDSB","\u53e6\u5b58\u4e3a\u65b0\u4eea\u8868\u677f"),m=new oa,r=new ba(t);r.setText(g);r.setUserObject(function(){h.protectedOverrideDsbSource(a)});m.addItemModel(r);g=new ba(q);g.setText(l);g.setUserObject(function(n,
Q){h.protectedCreateNewDsb(a,n,Q)});m.addItemModel(g);a.getConductor().appendToolbarMenu(m,"sync_scheme_to_push",c)};this.protectedMethod.hookPublishTo=function(a){var c=com.kingdee.bos.qing.publish.model,g=c.PublishTargetType;c=com.kingdee.bos.qing.publish.common;var l=c.PublishFactory,m=function(Q){if(fa(a.getJsonModel())){var k=Q.getUserObject();Q=Q.getText().replace("...","");var u=T(a.getJsonModel());u.setWidgetsExecutingTag(a.collectBuiltinWidgetsExecutingTag());k=l.createPublishToDialog(Q,
I(),u,k,P());k.setOuterMessageCurtain(ma());k.showDialog()}else ma().showPrompt(f.get("noWidgets","\u4eea\u8868\u677f\u6ca1\u6709\u5185\u5bb9\u3002"),2E3)};c=new oa;var r=new ba(m);r.setUserObject(g.APPMENU);r.setText(f.get("toAppMenu","\u5e94\u7528\u83dc\u5355..."));c.addItemModel(r);r=new ba(m);r.setUserObject(g.CENTER);r.setText(f.get("toAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939..."));c.addItemModel(r);r=new ba(m);r.setUserObject(g.CARD_REPOSITORY);r.setText(f.get("toCardRepository",
"\u5361\u7247\u5e93..."));c.addItemModel(r);m=new ba(m);m.setUserObject(g.MOBILE);m.setText(f.get("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));c.addItemModel(m);com.kingdee.bos.qing.timedpush.LappIntegration.syncDatacenterInfo(I());la();var n=T(a.getJsonModel());c.addSeperator();r=new ba(function(){(new com.kingdee.bos.qing.publish.common.PublishManagerDialog(I(),n,P())).showDialog()});r.setUserObject();r.setText(f.get("publishManager","\u53d1\u5e03\u7ba1\u7406")+"...");c.addItemModel(r);g=new ba(aa);
g.setUserObject();g.setText(f.get("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");c.addItemModel(g);g=f.get("publishTo","\u53d1\u5e03\u5230");a.getConductor().appendToolbarMenu(c,"publish_to",g)};this.protectedMethod.hookCommunicateTo=function(a){var c=function(n){n=f.get("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a...").replace("...","");var Q=T(a.getJsonModel());n=com.kingdee.bos.qing.timedpush.PublishToYunzhijiaDialogFactory.createDialog(n,I(),Q);n.setOuterMessageCurtain(ma());
n.showDialog()},g=function(n){fa(a.getJsonModel())?(n=com.kingdee.bos.qing.CodeLoader.createSafety(),n.pushJs("yzj-web/qingjs.js"),n.pushJs("yzj-web/imcloud.js"),n.pushJs("yzj-web/imsdkerp.js"),n.pushJs("yzj-web/imShare.js"),n.pushSkinCss("yzj-web","imcloud"),n.pushSkinCss("yzj-web","imsdk"),n.pushSkinCss("yzj-web","imsdkerp"),n.load(function(){})):ma().showPrompt(f.get("noWidgets","\u4eea\u8868\u677f\u6ca1\u6709\u5185\u5bb9\u3002"),2E3)},l=new oa;(new ba(function(n){window.beLoadedImCloud?c(n):g(n)})).setText(f.get("yzjCommunicate",
"\u4e91\u4e4b\u5bb6\u6c9f\u901a..."));var m=new ba(function(n){if(fa(a.getJsonModel())){n=n.getText().replace("...","");var Q=T(a.getJsonModel());n=new com.kingdee.bos.qing.timedpush.EmailPublishConfigDialog(n,I(),Q,ha(),Ea(),V());n.setOuterMessageCurtain(ma());n.showDialog()}else ma().showPrompt(f.get("noWidgets","\u4eea\u8868\u677f\u6ca1\u6709\u5185\u5bb9\u3002"),2E3)});m.setText(f.get("emailSchedulePush","\u90ae\u4ef6\u5b9a\u65f6\u63a8\u9001..."));l.addItemModel(m);m=new ba(function(n){if(fa(a.getJsonModel())){var Q=
T(a.getJsonModel()),k=new com.kingdee.bos.qing.timedpush.LappSchedulePush;n=n.getText().replace("...","");k.createDialog(n,I(),Q,V(),a)}else ma().showPrompt(f.get("noWidgets","\u4eea\u8868\u677f\u6ca1\u6709\u5185\u5bb9\u3002"),2E3)});m.setText(f.get("mobileSchedulePush","\u79fb\u52a8\u7aef\u5b9a\u65f6\u63a8\u9001")+"...");l.addItemModel(m);var r=T(a.getJsonModel());l.addSeperator();m=new ba(function(){var n=new com.kingdee.bos.qing.publish.common.PushManager(V()),Q=com.kingdee.bos.qing.timedpush;
n.registerEmailPushPanelConstructor(Q.EmailConfigManagePanel);n.initEmailPushConfig(I(),ha(),Ea());n.registerLappPushPanelConstructor(Q.LappPushManagePanel);n.initLappPushConfig(function(k,u,v){return com.kingdee.bos.qing.publish.common.PublishFactory.createPublishFacade(com.kingdee.bos.qing.publish.model.PublishTargetType.MOBILE,I(),k,u,v)},r);n.showDialog()});m.setUserObject();m.setText(f.get("pushManager","\u5b9a\u65f6\u63a8\u9001\u7ba1\u7406")+"...");l.addItemModel(m);l=a.getConductor().appendToolbarMenu(l,
"btn_communicate",f.get("timedPush","\u5b9a\u65f6\u63a8\u9001"));l.addActionListener(function(){window.beLoadedImCloud||(window.funCallback=c)});return l};this.protectedMethod.setNeedShowLinkage=function(a){x=a}};var ca,na,Da,Ha,N,z,f,X,oa,ba,ua,Ba,L,Y,da,w,ka,R,ra,qa,ia,ea,sa,ya;(function(){var h=com.kingdee.bos.qing;ca=h.SkinUtil;na=h.AbstractDashboardDesignerScene;Da=h.AbstractModalDesignerScene;Ha=h.Seer;h=com.kingdee.bos.qing.common;z=h.Util;Y=h.DomUtil;da=h.DateFormater;h=com.kingdee.bos.qing.common.ui;
w=h.TableUtil;ya=h.CommonIconUtil;h=com.kingdee.bos.qing.framework.common;N=h.TabbedUiUtil;R=h.AbstractIcons;h=com.kingdee.bos.qing.ui.component;X=h.MessageCurtain;oa=h.MenuModel;ba=h.MenuItemModel;ua=h.RadioButton;L=h.RadioButtonGroup;ka=h.SearchBox;ra=h.Dialog;qa=h.Label;ia=h.ComboBox;ea=h.TextField;sa=h.TextArea;h=com.kingdee.bos.qing.framework.common;f=h.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.scene);h=com.kingdee.bos.qing.integration;Ba=h.TabStatusHelper})();ja.Icons=
new function(){R.call(this);var h=this.protectedMethod,C;this.setComboIconImpl=function(G){C=G};this.protectedInit=function(G,E){if(!C)throw Error("Please setComboIconImpl() first.");C.define(E,"no-data");E.setStartPosition(0,0);E.setGap(0);E.setIconSize(220,220);h.registIcon(0,0,"no-data")}};H.SQUARE_TYPE=1;H.LONGER_TYPE=0;H.EXTREPORT_TYPE=2})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});var D=com.kingdee.bos.qing.scene;D.DashboardDesignerScene=function(){K.call(this);var H=this,J=this.protectedMethod;this.protectedInitBehaviorManager=function(){var Z=com.kingdee.bos.qing.behavior.BehaviorManager;
Z.interestInBehaviorEntrance(Z.ENTRANCE_THEME_DASHBOARD);var ja=com.kingdee.bos.qing.dashboard.UserOperationReporter;ja.hookCollector(function(ca,na){Z.interestInBehavior(ca,na)});ja=com.kingdee.bos.qing.publish.common.UserOperationReporter;ja.hookCollector(function(ca,na,Da){Z.interestInBehavior(ca,na,0,Da)})};this.protectedGetRemoteUrl=function(){var Z=J.getUrlParamUtil().getParamPathPrefix();return(Z?Z:"/ierp")+"/qing/dashboard.do"};this.protectedGetDashboardUniqueId=function(){return Ca()};this.protectedSaveModel=
function(Z){if(Z.getConductor().isDirty()){var ja=JSON.stringify(Z.getJsonModel());(new com.kingdee.bos.qing.dashboard.DsbFacade(H.getRemoteImpl(),function(ca){J.getMessageCurtain().showSuccess(F.get("saveDsbSuccess","\u4fdd\u5b58\u4eea\u8868\u677f\u6210\u529f\u3002"));Z.getConductor().clearDirty()},function(ca,na){return 900003==ca||900004==ca?(J.getMessageCurtain().showError(F.get("failToSaveDsb","\u4fdd\u5b58\u4eea\u8868\u677f\u5931\u8d25\u3002")),!0):2010001==ca?(J.getMessageCurtain().showPrompt(F.get("dsbIsDeletedCurtain",
"\u5bf9\u5e94\u4eea\u8868\u677f\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002")),!0):2010003==ca?(J.getMessageCurtain().showPrompt(F.get("noOperationPermissionsCurtain","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002")),!0):1030001==ca?(com.kingdee.bos.qing.framework.common.RemoteFramework.openErrorPage(ca,com.kingdee.bos.qing.common.Base64Util.encode(encodeURIComponent(na))),!0):!1})).saveModel(Ca(),ja)}else J.getMessageCurtain().showPrompt(F.get("noEditCurtain","\u4eea\u8868\u677f\u5185\u5bb9\u6ca1\u6709\u4fee\u6539\u3002"),
2E3)};this.addDsbResourceLock=function(){var Z=Ca();(new com.kingdee.bos.qing.dashboard.DsbFacade(H.getRemoteImpl(),function(ja){return!0},function(ja,ca){return!1})).tryAddResourceLock("theme-dashboard-design-scene",Z)};var Aa=function(Z){var ja=Ca();(new com.kingdee.bos.qing.dashboard.DsbFacade(H.getRemoteImpl(),function(ca){Z&&Z();return!0},function(ca,na){return!1})).closeResourceLock("theme-dashboard-design-scene",ja)},p=H.protectedInitDesigner;this.protectedInitDesigner=function(Z){p(Z);"true"!=
J.getUrlParamUtil().getUrlParam("isPreset")&&(J.hookPublishTo(Z),J.hookCommunicateTo(Z));J.hookCloseTab(Z);Ia(Z);H.setCloseResourceLock(Aa);H.addDsbResourceLock()};this.protectedLoading=function(Z,ja,ca){Z=Ca();(new com.kingdee.bos.qing.dashboard.DsbFacade(H.getRemoteImpl(),function(na){na?(ja.setJsonModel(na,function(Da){Da.isError()&&J.getMessageCurtain().showError(F.get("failToLoadDsbCurtain","\u52a0\u8f7d\u4eea\u8868\u677f\u5185\u5bb9\u5931\u8d25\u3002"))}),ca(!0)):ca(!1)},function(na,Da){return"900003"==
na||"900004"==na?(J.getMessageCurtain().showError(F.get("failToLoadDsbCurtain","\u52a0\u8f7d\u4eea\u8868\u677f\u5185\u5bb9\u5931\u8d25\u3002")),!0):1030001==na?(com.kingdee.bos.qing.framework.common.RemoteFramework.openErrorPage(na,com.kingdee.bos.qing.common.Base64Util.encode(encodeURIComponent(Da))),!0):!1})).loadModel(Z)};var Ca=function(){return J.getUrlParamUtil().getUrlParam("dsbId")},Ia=function(Z){var ja=Ca();com.kingdee.bos.qing.qhf.QHFSceneExporterRegister.register(ja,function(){return{dsbId:ja,
sceneType:com.kingdee.bos.qing.qhf.QHFExporter.SCENE_TYPE_DSB_DESIGNER}},function(){return Z.getConductor().isDirty()?(J.getMessageCurtain().showPrompt(F.get("dirtyTips","\u4eea\u8868\u677f\u5185\u5bb9\u5df2\u4fee\u6539\uff0c\u8bf7\u5148\u4fdd\u5b58\u540e\u518d\u5bfc\u51fa\u3002")),!0):!1})}};var K,F;(function(){var H=com.kingdee.bos.qing.scene.common.designer;K=H.AbstractDashboardDesignerSceneImpl;H=com.kingdee.bos.qing.framework.common;F=H.MultilanguageManager.createPackageAccessor(D)})()})();
//qingVersionTag: 20250324