(function(){function B(){Y.call(this);var m=this,l=this.protectedMethod,D,J,U,O,Q;this.setCurrentPublishSchema=function(a){Q=a};this.setUserOperatorPrevCheck=function(a){U=a};this.setCloseResourceLock=function(a){};this.protectedHaveToCarryData=function(){return!1};this.protectedNeedToShowMessageBox=function(){return!0};this.protectedGetRemoteUrl=function(){var a=l.getUrlParamUtil().getParamPathPrefix();return(a?a:"/ierp")+"/qing/core.do"};this.protectedImportMoreCode=function(a){a.pushSkinJs("scene",
"skin");a.pushI18n("scene","scene")};this.protectedCustomInitEnv=function(a){a=$("<div>");a.css({position:"fixed",bottom:"3px",right:"1px",width:"180px",height:"18px",zIndex:"999"});K(a);m.protectedNeedToShowMessageBox()&&Z(a);a.appendTo($(document.body));com.kingdee.bos.qing.integration.ImglibUrlParser.hookUrlParser()};var K=function(a){L.setCallback(function(){var b=new com.kingdee.bos.qing.support.Main;b.setParamLanguage(l.getUrlParamUtil().getParamLanguage());b.creatSupportUi(a)});L.loadCss("support/support.css");
L.loadJs("support/support-ui.js");L.loadI18n("support","support")},Z=function(a){L.setCallback(function(){var b=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");b=b?b:"/ierp";com.kingdee.bos.qing.message.common.Integration.setRemoteUrl(b+"/qing/messageManage.do");oa(b);var e=new com.kingdee.bos.qing.message.ui.Main;e.setFunOpenMessageDialog(function(){e.setViewSize(null,null,10,30)});e.setMessageWidth(80);e.getJqUi(25).appendTo(a)});L.loadSkinCss("message","message");
L.loadSkinJs("message","skin");L.loadJs("message/message-manage-ui.js");L.loadI18n("message","message")},oa=function(a){var b=com.kingdee.bos.qing.message.common.Integration;b.setImportJSCodeForManager(function(){var f=com.kingdee.bos.qing.CodeLoader;f.setCallback(function(){var n=com.kingdee.bos.qing.theme.message.panel.common.Integration;n.setFunPublishRemoteImpl(function(){var d=new com.kingdee.bos.qing.theme.message.panel.common.RemoteImpl;d.setRemoteUrl(a+"/qing/publishTo.do");return d});n.setFunQingCenterAndMenuEntrance(function(d,
c,k,q){c=E.getUrlParamValue();var g=a+"/qing/publishEntrance.do";g=h.appendParamToUrl(g,"publishId",d);"extreport"==q?(g=h.appendParamToUrl(g,"appID","qing_rpt"),c&&(g=h.appendParamToUrl(g,"skin",c)),A.openNewTabInAppId(k,g,g,A.QING_RPT)):(c&&(g=h.appendParamToUrl(g,"skin",c)),A.openNewTabInAppId(k,g,g,A.QING_ANALYSIS))});n.setResourceRemoteUrl(a+"/qing/resource.do");n.setDataModelEntrance(function(d,c,k){var q=E.getUrlParamValue();c=y.get("dataModeling","\u6570\u636e\u51c6\u5907")+"-"+c;var g=a+
"/qing/dataModelingEntrance.do";g=h.appendParamToUrl(g,"themeID",d);g=h.appendParamToUrl(g,"isPreset",k);q&&(g=h.appendParamToUrl(g,"skin",q));A.openNewTabInAppId(c,g,g,A.QING_ANALYSIS)});n.setFunPublishContext(function(){var d=new com.kingdee.bos.qing.publish.common.PublishContext;d.setParamPathPrefix(a);d.setLappEntranceUrl(a+"/qing/lappEntrance.do");d.setSpaceID(u.getUrlParamValue("qingID"));return d});n.setFunPublishedEmailLoginViewUrl(function(){var d=E.getUrlParamValue(),c=u.getUrlParamValue("language"),
k=a+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";d&&(k=h.appendParamToUrl(k,"skin",d));c&&(k=h.appendParamToUrl(k,"language",c));return k});n.setFunPublishedEmailAnonymousViewUrl(function(){var d=E.getUrlParamValue(),c=u.getUrlParamValue("language"),k=a+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";d&&(k=h.appendParamToUrl(k,"skin",d));c&&(k=h.appendParamToUrl(k,
"language",c));return k});n.setFunPublishContentEditEntrance(function(){return function(d,c,k){var q=com.kingdee.bos.qing.publish.model.PublishTargetType;if(k&&q.MOBILE==k){q=d.getPublishId();var g=d.getId()}else q=d.getId();var p=E.getUrlParamValue(),M=u.getUrlParamValue("language");k=a+"/qing/publishContentEditEntrance.do";k=h.appendParamToUrl(k,"skin",p);k=h.appendParamToUrl(k,"language",M);k=h.appendParamToUrl(k,"publishId",q);g&&(k=h.appendParamToUrl(k,"lappId",g));g=k;c&&(q="editPublishedContent-"+
q,p=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,p.putSubscribe(q,c),k=h.appendParamToUrl(k,"subscribeKey",q),k=h.appendParamToUrl(k,"currentPageClientId",p.getCurrentPageClientId()));c=com.kingdee.bos.qing.framework.common.TabbedUiUtil;c.openNewTabInAppId(y.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+d.getName(),k,g,c.QING_ANALYSIS)}});n.setFunTimedPushContentEditEntrance(function(){return function(d){var c=a+"/qing/timedPushContentEditEntrance.do",k=y.get("editTimedPushContent",
"\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(d instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var q=d.getId(),g=d.getPublishSourceType();p=d.getSchemaSourceType();c=h.appendParamToUrl(c,"configId",q);c=h.appendParamToUrl(c,"publishSourceType",g);c=h.appendParamToUrl(c,"schemaType",p);c=h.appendParamToUrl(c,"pushTarget","email");k=k+"-"+d.getNameRule().getName();d.isSourceNameNotFound()&&(c=h.appendParamToUrl(c,"errorCode","2301001"))}else{q=d.getId();g=d.getPushTargetType();var p=d.getSchemaType();
c=h.appendParamToUrl(c,"configId",q);c=h.appendParamToUrl(c,"pushTargetType",g);c=h.appendParamToUrl(c,"schemaType",p);c=h.appendParamToUrl(c,"pushTarget","lapp");k=k+"-"+d.getName();d.getSourceName()||(c=h.appendParamToUrl(c,"errorCode","2301001"))}d=E.getUrlParamValue();p=u.getUrlParamValue("language");d&&(c=h.appendParamToUrl(c,"skin",d));p&&(c=h.appendParamToUrl(c,"language",p));d=com.kingdee.bos.qing.framework.common.TabbedUiUtil;d.openNewTabInAppId(k,c,c,d.QING_ANALYSIS)}});n=com.kingdee.bos.qing.modeler.message.panel.common.Integration;
n.setMessageRemoteUrl(a+"/qing_modeler/message.do");n.setFunOpenModelSetPage(function(d,c){var k=E.getUrlParamValue(),q=y.get("modelSet","\u6a21\u578b\u96c6-")+c,g=a+"/qing_modeler/modelSetMainPage.do";g=h.appendParamToUrl(g,"modelSetId",d);g=h.appendParamToUrl(g,"modelSetName",c);g=h.appendParamToUrl(g,"currentPageClientId",com.kingdee.bos.qing.framework.common.RemoteFramework.getClientID());k&&(g=h.appendParamToUrl(g,"skin",k));A.openNewTabInAppId(q,g,g,A.QING_MODELER)});n.setFunOpenModelDesign(function(d,
c,k,q,g){var p=com.kingdee.bos.qing.modeler.message.panel.common.ModelType,M=E.getUrlParamValue();g=(g=p.getModelTypeText(g))?g+"-"+k:k;p=a+"/qing_modeler/deployDesignerEntrance.do";p=h.appendParamToUrl(p,"modelSetId",d);p=h.appendParamToUrl(p,"modelId",c);p=h.appendParamToUrl(p,"modelName",k);p=h.appendParamToUrl(p,"modelDeployId",q);M&&(p=h.appendParamToUrl(p,"skin",M));A.openNewTabInAppId(g,p,p,A.QING_MODELER)})});f.loadSkinCss("message","messagepanel");f.loadSkinJs("message","skin");f.loadJs("message/message-content-panel-management.js");
f.loadI18n("message","messagepanel");f.loadSkinCss("qingmodeler/message","message-modeler-panel");f.loadSkinJs("qingmodeler/message","skin");f.loadJs("qingmodeler/message/message-content-panel-management.js");f.loadI18n("qingmodeler/message","message-modeler-panel")});var e=h.decodeParamFromUrl(location.search,"appID");b.setAppId(e)},ha=function(a){a=new com.kingdee.bos.qing.publish.permission.PermLabelManageDialog(G());a.setSpaceID(u.getUrlParamValue("qingID"));a.showDialog()},ba=function(a,b,e,
f,n,d){var c=com.kingdee.bos.qing.publish.model.PublishSourceType,k=com.kingdee.bos.qing.publish.model.PublishTargetType;a!=c.EXTREPORT&&a!=c.DASHBOARD&&b!=k.GUIMENU?(a=new com.kingdee.bos.qing.publish.common.PublishFacade(G(),function(q){d&&d()},function(q,g){return 2301016==q?(X().showPrompt(y.get("publishNoOperAuthExceptionCurtain","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),!0):!1}),b=e.getBizTag(),c=e.getDsbPublishId(),e.getRefToId()&&(b=e.getRefToId()),a.judgePublishOper(b,c,f,n)):d&&
d()},ia=function(){com.kingdee.bos.qing.timedpush.LappIntegration.syncDatacenterInfo(G())},ja=function(){var a=l.getUrlParamUtil().getParamPathPrefix();com.kingdee.bos.qing.timedpush.LappIntegration.setLappPrivateUrl(a+"/qing/lappPrivateInfo.do")},R=function(a,b,e,f,n,d){var c=l.getUrlParamUtil().getParamPathPrefix(),k=com.kingdee.bos.qing.publish.common,q=k.PublishContext;k=com.kingdee.bos.qing.schemamanage.model;var g=k.SchemaAttrModel;k=k.SchemaModel;var p=l.getUrlParamUtil().getUrlParam("bizTag"),
M=m.protectedHaveToCarryData(),r;com.kingdee.bos.qing&&com.kingdee.bos.qing.prepare&&com.kingdee.bos.qing.prepare.DataSourceInfoContext&&(r=com.kingdee.bos.qing.prepare.DataSourceInfoContext.getCurrentDataSourceInfo());var N=r&&r.hasDirectModeTable();r=new q;r.setSource(n);r.setBizTag(p);r.setCurrentSourceType(b);r.setHaveToCarryData(M);r.setHasDirectModeTable(N);r.setParamPathPrefix(c);r.setSchemaTag("Dashboard-Analysis"==d?l.getUrlParamUtil().getUrlParam("schemaTag"):null);r.setSpaceID(u.getUrlParamValue("qingID"));
b=new g;b.setSchemaType(g.SCHEMATYPE_SYSTEM);b.setIsDefault(!0);b.setSchemaName(x("sysPublishScheme","\u7cfb\u7edf\u9ed8\u8ba4\u65b9\u6848"));b.setSource(e);n=new k;n.setSchemaAttr(b);n.setSchemaContent(a.getJsonModelBook());a=n.toJsonObject();r.setCurrentContentModel(a);a=l.getUrlParamUtil().getParamTag();b=function(H){H+="/qinganalysis/lappPreviewEntrance.do";for(var t=window.location.search.substring(1).split("&"),C=0;C<t.length;C++){var z=t[C],P=z.indexOf("=");if(-1!=P){var V=z.substring(0,P);
"clientID"!=V&&"safetyCode"!=V&&(z=z.substring(P+1),H+=0>H.indexOf("?")?"?":"&",H+=V,H+="=",H+=z)}}return H};e==g.SCHEMASOURCE_SQUARE?(r.setScene(q.Scene.Square),e=b(c),e=h.appendParamToUrl(e,"view","10"),r.setMobilePreviewUrl(e),c=h.appendParamToUrl(c+"/qing/lappEntrance.do","tag",a),c=h.appendParamToUrl(c,"view","10"),r.setLappEntranceUrl(c)):e==g.SCHEMASOURCE_LONGER&&(r.setScene(q.Scene.Longer),r.setMobilePreviewUrl(b(c)),c=h.appendParamToUrl(c+"/qing/lappEntrance.do","tag",a),r.setLappEntranceUrl(c));
f&&(r.setRefToId(l.getUrlParamUtil().getUrlParam("publishId")),r.setDsbPublishId(f),r.setDashBoardAnalysis(!0));return r},pa=function(a){var b=!1;if(a&&(a=a.tables)&&0<a.length)for(var e=0;e<a.length;e++)if(a[e].subViews){b=!0;break}return b},S=function(a,b){U?U(function(e){var f=new com.kingdee.bos.qing.schemamanage.common.SchemaManageFacade(qa(),function(d){d.publishInfoPerCheck==B.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST?a&&a(b):d.publishInfoPerCheck==B.THEME_IS_DEL?ca($(document.body),"msg-warning",
y.get("ThemeIsDel","\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u6765\u6e90\u88ab\u5220\u9664")):d.publishInfoPerCheck==B.PUBLISHINFO_NOEXIST?ca($(document.body),"msg-warning",y.get("publishInfoExist","\u53d1\u5e03\u8bb0\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")):d.publishInfoPerCheck==B.PERMISSION_CANCEL?ca($(document.body),"msg-jurisdiction",y.get("notAuthority","\u60a8\u6ca1\u6709\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u67e5\u770b\u6743\u9650, \u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba")+'"'+d.publishInfoUserName+
'"'+y.get("authority","\u6388\u6743")):d.publishInfoPerCheck==B.PUBLSIHPLAN_DELETE&&ca($(document.body),"msg-warning",y.get("publishPlanExist","\u8be5\u5206\u6790\u65b9\u6848\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"))}),n=new com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel;n.setFId(Q.getCurrentSchemaId());n.setSchemaName(Q.getCurrentSchemaName());f.checkPublishInfoAndAuthority(e,n)}):a&&a(b)},qa=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=l.getUrlParamUtil().getParamTag();
a=(a?a:"/ierp")+"/qing/schemaManage.do";var e=new com.kingdee.bos.qing.RemoteImpl;e.setRemoteUrl(a);e.setTag(b);return e},ca=function(a,b,e){a=new I;a.setOptionType(I.OPTION_OK);a.setButtonText(I.RETURN_OK,y.get("ISee","\u6211\u77e5\u9053\u4e86"));var f={};f.text=e;f.iconName=b;a.setMessage(f);a.setCustomPainter(function(n,d){var c=$("<div>");c.addClass("sa-ctrl-msgdlg-icon");F.background(c,d.iconName);var k=$("<div>");k.addClass("sa-ctrl-msgdlg-content");k.text(d.text);n.append(c);n.append(k)});
a.showDialog(380,280)},ka=function(a,b,e){D?b(D):(new com.kingdee.bos.qing.core.Facade(a,function(f){D=f;b(f)},e)).getMeta()},la=function(a){D=null;ka(m.getRemoteImpl(),a)},G=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=l.getUrlParamUtil().getParamTag();a=(a?a:"/ierp")+"/qing/publishTo.do";var e=new com.kingdee.bos.qing.RemoteImpl;e.setRemoteUrl(a);e.setTag(b);return e},ma=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=E.getUrlParamValue(),e=l.getUrlParamUtil().getParamLanguage();
a=(a?a:"/ierp")+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";b&&(a=h.appendParamToUrl(a,"skin",b));e&&(a=h.appendParamToUrl(a,"language",e));return a},na=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=E.getUrlParamValue(),e=l.getUrlParamUtil().getParamLanguage();a=(a?a:"/ierp")+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";b&&(a=h.appendParamToUrl(a,
"skin",b));e&&(a=h.appendParamToUrl(a,"language",e));return a},aa=function(){return function(a,b,e){var f=com.kingdee.bos.qing.publish.model.PublishTargetType;if(e&&f.MOBILE==e){e=a.getPublishId();var n=a.getId();var d=a.getLappUserType()}else e=a.getId();f=l.getUrlParamUtil().getParamPathPrefix();var c=E.getUrlParamValue(),k=l.getUrlParamUtil().getParamLanguage();f=h.appendParamToUrl((f?f:"/ierp")+"/qing/publishContentEditEntrance.do","skin",c);f=h.appendParamToUrl(f,"language",k);f=h.appendParamToUrl(f,
"publishId",e);n&&(f=h.appendParamToUrl(f,"lappId",n));d&&(f=h.appendParamToUrl(f,"lappUserType",d));n=f;b&&(d="editPublishedContent-"+e,e=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,e.putSubscribe(d,b),f=h.appendParamToUrl(f,"subscribeKey",d),f=h.appendParamToUrl(f,"currentPageClientId",e.getCurrentPageClientId()));A.openNewTab(y.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+a.getName(),f,n)}},ea=function(){return function(a){var b=l.getUrlParamUtil().getParamPathPrefix();
b=(b?b:"/ierp")+"/qing/timedPushContentEditEntrance.do";var e=y.get("editTimedPushContent","\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(a instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var f=a.getId(),n=a.getPublishSourceType();d=a.getSchemaSourceType();b=h.appendParamToUrl(b,"configId",f);b=h.appendParamToUrl(b,"publishSourceType",n);b=h.appendParamToUrl(b,"schemaType",d);b=h.appendParamToUrl(b,"pushTarget","email");e=e+"-"+a.getNameRule().getName();a.isSourceNameNotFound()&&(b=h.appendParamToUrl(b,
"errorCode","2301001"))}else{f=a.getId();n=a.getPushTargetType();var d=a.getSchemaType();b=h.appendParamToUrl(b,"configId",f);b=h.appendParamToUrl(b,"pushTargetType",n);b=h.appendParamToUrl(b,"schemaType",d);b=h.appendParamToUrl(b,"pushTarget","lapp");e=e+"-"+a.getName();a.getSourceName()||(b=h.appendParamToUrl(b,"errorCode","2301001"))}a=E.getUrlParamValue();d=l.getUrlParamUtil().getParamLanguage();a&&(b=h.appendParamToUrl(b,"skin",a));d&&(b=h.appendParamToUrl(b,"language",d));A.openNewTab(e,b)}},
x=function(a,b){return y.get(a,b)},X=function(){J||(J=new com.kingdee.bos.qing.ui.component.MessageCurtain,J.getJqUi().appendTo($(document.body)));return J};l.getMLS=x;l.importLinkage=function(a){a.pushSkinJs("linkage","skin");a.pushJs("linkage/linkage.js");a.pushSkinCss("linkage","linkage")};l.importForSchema=function(a){a.pushSkinJs("schema-manage","skin-initialize");a.pushJs("schema-manage/schema-manage-initialize.js");a.pushI18n("schema-manage","schema-initialize");a.pushSkinCss("schema-manage",
"schema-manage");a.pushJs("schema-manage/schema-manage-ui.js");a.pushI18n("schema-manage","schema-ui")};l.importForPublish=function(a){a.pushJs("biz-common/qing-biz-common.js");a.pushSkinCss("biz-common","biz-common");a.pushSkinJs("biz-common","skin");a.pushI18n("biz-common","biz-common");a.pushSkinJs("imagelib","skin");a.pushSkinCss("imagelib","qing-imagelib");a.pushJs("imagelib/imagelib.js");a.pushI18n("imagelib","imagelib");a.pushJs("common/qing-schedule.js");a.pushI18n("common","qing-schedule");
a.pushSkinCss("publish","qing-publish");a.pushSkinJs("publish","skin");a.pushI18n("publish","publish");a.pushJs("publish/qing-publish.js");a.pushSkinCss("timedpush","qing-timedpush");a.pushSkinJs("timedpush","skin");a.pushI18n("timedpush","timedpush");a.pushJs("timedpush/qing-timedpush.js");a.pushJs("lightapp/common/qing-lapp-env.js");a.pushJs("timedpush/qing-timedpush-lapp.js");a.pushJs("timedpush/html2canvas.js")};l.importForMap=function(a){a.pushSkinJs("map-designer","integration-skin");a.pushJs("map-designer/map-integration.js");
a.pushSkinCss("map-designer","map-integration");a.pushI18n("map-designer","map-integration")};l.hookLongerPublishTo=function(a,b,e,f,n,d){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(r,N,H){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(r,N,0,H)});b=com.kingdee.bos.qing.publish.model;var c=b.PublishTargetType;b=com.kingdee.bos.qing.schemamanage.model;var k=b.SchemaAttrModel,q=function(r){var N=com.kingdee.bos.qing.publish.common.PublishFactory,
H=r.getUserObject(),t=r.getText().replace("...",""),C=R(a,e,k.SCHEMASOURCE_LONGER,f,n,d);ba(e,H,C,"longer",v.ANALYSIS_PUBLISH,function(){var z=N.createPublishToDialog(t,G(),C,H,aa());z.setOuterMessageCurtain(X());z.showDialog()})},g=com.kingdee.bos.qing.ui.component.MenuItemModel;b=new com.kingdee.bos.qing.ui.component.MenuModel;var p=new g(function(r){S(q,r)});p.setUserObject(c.APPMENU);p.setText(x("toAppMenu","\u5e94\u7528\u83dc\u5355..."));b.addItemModel(p);p=new g(function(r){S(q,r)});p.setUserObject(c.CENTER);
p.setText(x("toAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939..."));b.addItemModel(p);p=new g(function(r){S(q,r)});p.setUserObject(c.MOBILE);p.setText(x("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));b.addItemModel(p);ia();ja();b.addSeperator();var M=function(){var r=com.kingdee.bos.qing.publish.common.PublishManagerDialog,N=R(a,e,com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_LONGER);(new r(G(),N,aa())).showDialog()};p=new g(function(r){S(M,r)});p.setUserObject();
p.setText(x("publishManager","\u53d1\u5e03\u7ba1\u7406")+"...");b.addItemModel(p);c=new g(ha);c.setUserObject();c.setText(x("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");b.addItemModel(c);c=x("publishTo","\u53d1\u5e03\u5230");return a.getConductor().appendToolbarMenu(b,"publish_to",c)};l.hookSquarePublishTo=function(a,b,e){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(q,g,p){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(q,g,
0,p)});b=com.kingdee.bos.qing.publish.model;var f=b.PublishTargetType;b=com.kingdee.bos.qing.schemamanage.model;var n=b.SchemaAttrModel,d=function(q){var g=com.kingdee.bos.qing.publish.common.PublishFactory,p=q.getUserObject(),M=q.getText().replace("...",""),r=R(a,e,n.SCHEMASOURCE_SQUARE);ba(e,p,r,"square",v.CARD_PUBLISH,function(){var N=g.createPublishToDialog(M,G(),r,p,aa());N.setOuterMessageCurtain(X());N.showDialog()})},c=com.kingdee.bos.qing.ui.component.MenuItemModel;b=new com.kingdee.bos.qing.ui.component.MenuModel;
var k=new c(d);k.setUserObject(f.CARD_REPOSITORY);k.setText(x("toCardRepository","\u5361\u7247\u5e93..."));b.addItemModel(k);d=new c(d);d.setText(x("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));d.setUserObject(f.MOBILE);b.addItemModel(d);ia();ja();b.addSeperator();f=new c(function(){var q=com.kingdee.bos.qing.publish.common.PublishManagerDialog,g=R(a,e,com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_SQUARE);(new q(G(),g,aa())).showDialog()});f.setUserObject();f.setText(x("publishManager",
"\u53d1\u5e03\u7ba1\u7406")+"...");b.addItemModel(f);f=new c(ha);f.setUserObject();f.setText(x("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");b.addItemModel(f);f=x("publishTo","\u53d1\u5e03\u5230");return a.getConductor().appendToolbarMenu(b,"publish_to",f)};l.hookPublishManager=function(a,b,e){var f=x("publishManager","\u53d1\u5e03\u7ba1\u7406");return a.getConductor().appendToolbarButton(function(){var n=com.kingdee.bos.qing.publish.common.PublishManagerDialog,d=R(a,b,e);(new n(G(),
d,aa())).showDialog()},"publish_manager",f)};l.hookCloseTab=function(a){var b=x("closeTab","\u9000\u51fa");return a.getConductor().appendToolbarButton(function(){a.getConductor().isDirty()?w.showConfirmExitDialog():A.closeCurrentTab()},"error_close",b)};l.hookShareTo=function(a,b,e,f,n){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(t,C,z){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(t,C,0,z)});var d=function(t){t=x("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a...").replace("...",
"");var C=R(a,f,b);t=com.kingdee.bos.qing.timedpush.PublishToYunzhijiaDialogFactory.createDialog(t,G(),C);t.setOuterMessageCurtain(X());t.showDialog()},c=function(t){t=com.kingdee.bos.qing.CodeLoader.createSafety();t.pushJs("yzj-web/qingjs.js");t.pushJs("yzj-web/imcloud.js");t.pushJs("yzj-web/imsdkerp.js");t.pushJs("yzj-web/imShare.js");t.pushSkinCss("yzj-web","imcloud");t.pushSkinCss("yzj-web","imsdk");t.pushSkinCss("yzj-web","imsdkerp");t.load(function(){})};e=new da;(new W(function(t){window.beLoadedImCloud?
d(t):c(t)})).setText(x("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a..."));var k=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel,q=m.protectedHaveToCarryData(),g;com.kingdee.bos.qing&&com.kingdee.bos.qing.prepare&&com.kingdee.bos.qing.prepare.DataSourceInfoContext&&(g=com.kingdee.bos.qing.prepare.DataSourceInfoContext.getCurrentDataSourceInfo());g=g&&g.hasDirectModeTable();var p=com.kingdee.bos.qing.publish.model.PublishTargetType;if(!g&&!q&&b==k.SCHEMASOURCE_LONGER){var M=function(t){var C=
t.getText().replace("...",""),z=R(a,f,b,n);ba(f,p.EMAIL,z,"longer",v.ANALYSIS_TIMEPUSH,function(){var P=new com.kingdee.bos.qing.timedpush.EmailPublishConfigDialog(C,G(),z,ma(),na(),ea(),a);P.setOuterMessageCurtain(X());P.showDialog()})},r=new W(function(t){S(M,t)});r.setText(x("emailSchedulePush","\u90ae\u4ef6\u5b9a\u65f6\u63a8\u9001..."));e.addItemModel(r)}if(!g&&!q){var N=function(t){var C=R(a,f,b,n),z="longer",P=v.ANALYSIS_TIMEPUSH;b==k.SCHEMASOURCE_SQUARE&&(z="square",P=v.CARD_TIMEPUSH);ba(f,
p.EMAIL,C,z,P,function(){var V=new com.kingdee.bos.qing.timedpush.LappSchedulePush,fa=t.getText().replace("...","");V.createDialog(fa,G(),C,ea(),a)})};q=new W(function(t){S(N,t)});q.setText(x("mobileSchedulePush","\u79fb\u52a8\u7aef\u5b9a\u65f6\u63a8\u9001")+"...");e.addItemModel(q)}e.addSeperator();var H=function(){var t=com.kingdee.bos.qing.publish.common.PushManager,C=R(a,f,b);t=new t(ea());var z=com.kingdee.bos.qing.timedpush;t.registerEmailPushPanelConstructor(z.EmailConfigManagePanel);t.initEmailPushConfig(G(),
ma(),na());t.registerLappPushPanelConstructor(z.LappPushManagePanel);t.initLappPushConfig(function(P,V,fa){return com.kingdee.bos.qing.publish.common.PublishFactory.createPublishFacade(com.kingdee.bos.qing.publish.model.PublishTargetType.MOBILE,G(),P,V,fa)},C);t.showDialog()};q=new W(function(t){S(H,t)});q.setUserObject();q.setText(x("pushManager","\u5b9a\u65f6\u63a8\u9001\u7ba1\u7406")+"...");e.addItemModel(q);e=a.getConductor().appendToolbarMenu(e,"btn_communicate",x("timedPush","\u5b9a\u65f6\u63a8\u9001"));
e.addActionListener(function(){window.beLoadedImCloud||(window.funCallback=d)});return e};l.initDesigntimeLinkage=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=(a?a:"/ierp")+"/qing/linkage.do",e=com.kingdee.bos.qing.integration.LinkageJumper;a=new com.kingdee.bos.qing.linkage.LinkageManage;a.initDesigntime(b,e.jump);b=l.getUrlParamUtil().getParamTag();a.setCurrentLinkageTag(b)};l.loadMeta=ka;l.reloadMeta=la;l.hookRefresh=function(a,b){var e=l.getMLS("refresh","\u6570\u636e\u66f4\u65b0"),
f=function(){b.restart();b.setExtractDataFinishedSuccessCallback(function(n){n||pa(D)?la(function(d){var c=a.getJsonModelBook();a.prepareMeta(d);a.setJsonModelBook(c)}):a.reExecute()})};return a.getConductor().appendToolbarButton(function(){S(f)},"btn_reset",e)};l.getMessageCurtain=X;l.hookSetCurrentTabStatus=function(a){a.getConductor().setDirtyListener(function(b){w.setTabStatus(b)})};l.loadPublishOperList=function(a,b,e,f,n){O?e(O):(new com.kingdee.bos.qing.publish.common.PublishFacade(G(),function(d){O=
d;e(O)},n)).loadPublishOperList(a,b,f)};l.loadPublishOperModel=function(a,b,e,f){O?e(O):(new com.kingdee.bos.qing.publish.common.PublishFacade(G(),function(n){O=n.noOperValueMap;e(O)},f)).loadPublishOperModel(a,b)};l.registMapMapLibrary=function(a){com.kingdee.bos.qing.map.common.Integration.setRemoteUrl(a+"/qing/mapManage.do");var b=new com.kingdee.bos.qing.map.integration.MapSelectorDialog;com.kingdee.bos.qing.core.MapLibraryRegister.registerTemplateSelector(function(e,f){b.setParamPathPrefix(a);
b.showDialog(e,f)})}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});"undefined"==typeof com.kingdee.bos.qing.scene.common&&(com.kingdee.bos.qing.scene.common={});"undefined"==typeof com.kingdee.bos.qing.scene.common.designer&&(com.kingdee.bos.qing.scene.common.designer=
{});var T=com.kingdee.bos.qing.scene.common.designer,E,Y,L,I,F,h,y,A,da,W,w,u;(function(){var m=com.kingdee.bos.qing;E=m.SkinUtil;Y=m.AbstractDesignerScene;L=m.CodeLoader;u=m.Seer;m=com.kingdee.bos.qing.common;h=m.Util;m=com.kingdee.bos.qing.framework.common;y=m.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.scene);A=m.TabbedUiUtil;m=com.kingdee.bos.qing.ui.component;da=m.MenuModel;W=m.MenuItemModel;I=m.MessageDialog;F=m.Icons;m=com.kingdee.bos.qing.integration;w=m.TabStatusHelper})();
T.AbstractDesignerSceneImpl=B;T.LongerDesignerOperationJudgerModel=function(m){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);m&&0!=m&&(this.protectedParseDesignable=function(){return 0==(m&v.ANALYSIS_EDITABLE)},this.protectedParseDataDetailReadable=function(){return 0==(m&v.ANALYSIS_DETAIL)},this.protectedParseExportable=function(){return 0==(m&v.ANALYSIS_EXPORT)},this.protectedParsePrintable=function(){return 0==(m&v.ANALYSIS_PRINT)},this.protectedParsePublishable=function(){return 0==
(m&v.ANALYSIS_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(m&v.ANALYSIS_TIMEPUSH)})};T.SquareDesignerOperationJudgerModel=function(m){com.kingdee.bos.qing.core.SquareDesignerOperationJudger.call(this);m&&0!=m&&(this.protectedParsePublishable=function(){return 0==(m&v.CARD_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(m&v.CARD_TIMEPUSH)})};T.LongerDesignerOperationJudger=function(){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);var m=this;
this.protectedParseDesignable=function(){return m.isDesignable()};this.protectedParseDataDetailReadable=function(){return m.isDataDetailReadable()};this.protectedParseExportable=function(){return m.isExportable()};this.protectedParsePrintable=function(){return m.isPrintable()};this.protectedParsePublishable=function(){return m.isPublishable()};this.protectedParseTimingPushable=function(){return m.isTimingPushable()}};var v={};T.OperCodeType=v;v.ANALYSIS_EDITABLE=2;v.ANALYSIS_EXPORT=4;v.ANALYSIS_PRINT=
8;v.ANALYSIS_PUBLISH=16;v.ANALYSIS_TIMEPUSH=32;v.ANALYSIS_DETAIL=64;v.CARD_PUBLISH=256;v.CARD_TIMEPUSH=512;v.ENTRY_ANALYSIS=1;v.ENTRY_SQUARE=128;B.THEME_IS_DEL="Theme is Delete";B.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST="success";B.PUBLISHINFO_NOEXIST="PublishInfo Not Exist";B.PERMISSION_CANCEL="Not Permission";B.PUBLSIHPLAN_DELETE="Publish Not Exist"})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});com.kingdee.bos.qing.scene.PublishAnalysisdScene=function(){function I(w){var u;this.show=function(m){if(!u){u=$("<div>");u.css("position","absolute");u.css("top","10px");u.css("right","150px");u.css("border-radius",
"5px");u.css("padding","5px 10px");u.css("color","#666");u.css("font-size","12px");u.css("line-height","16px");u.css("text-align","center");u.css("background","#fff");u.css("box-shadow","0 2px 6px 0 rgba(57, 75, 115, 0.15)");u.css("user-select","none");u.css("cursor","move");u.css("z-index","999");var l=$("<div>");l.css("position","absolute");l.css("top","50%");l.css("margin-top","-5px");l.css("width","10px");l.css("height","10px");l.css("background-color","yellow");l.css("color","#bc1118");l.css("border",
"solid 1px #bc1118");l.css("border-radius","5px");l.css("font-size","10px");l.css("font-weight","bold");l.css("text-align","center");l.css("line-height","10px");l.css("cursor","default");l.text("!");var D=$("<div>");D.css("padding-left","18px");D.css("color","red");D.text(m);l.appendTo(u);D.appendTo(u);u.appendTo(w);v()}};var v=function(){var m=!1,l,D,J,U=w.css("cursor"),O=function(K){if(m){var Z=B.getCurrentTargetPosition(K);Z=B.upwardCoordinate(K.target,Z,w[0]);K=l-(Z[0]-J[0])-D;K<=l-D&&0<K&&u.css("right",
K+"px")}else Q()},Q=function(K){m=!1;w.css("cursor",U);w.off("mousemove",O);w.off("mouseleave",Q);w.off("mouseup",Q)};u.on("mousedown",function(K){m=!0;J=B.getCurrentTargetPosition(K);J=B.upwardCoordinate(K.target,J,u[0]);l=w.width();D=u.outerWidth();w.on("mousemove",O);w.on("mouseleave",Q);w.on("mouseup",Q);w.css("cursor","move")});u.on("mouseup",function(K){m=!1;J=null})}}Y.call(this);var F=this.protectedMethod,h,y,A,da=this.protectedImportMoreCode;this.protectedImportMoreCode=function(w){da(w);
F.importForSchema(w);F.importForPublish(w)};var W=this.protectedCustomInitEnv;this.protectedCustomInitEnv=function(w){F.setModuleWithLonger(!0,!0);F.setModuleWithSquare(!1,!1);W(w);h=F.getUrlParamUtil().getUrlParam("bizTag");y=new E;var u=F.getUrlParamUtil().getParamPathPrefix();y.setRemoteUrl((u?u:"/ierp")+"/qing/schemaManage.do");y.setTag(F.getUrlParamUtil().getParamTag());"true"==F.getUrlParamUtil().getUrlParam("isAnonymousView")&&(new I($(document.body))).show(F.getMLS("anonymousViewTips","\u60a8\u6b63\u5728\u4ee5\u533f\u540d\u65b9\u5f0f\u67e5\u9605\u5f53\u524d\u8f7b\u5206\u6790\u5185\u5bb9"));
var v=com.kingdee.bos.qing.behavior.BehaviorManager;v.interestInBehaviorEntrance(v.ENTRANCE_PUBLISH_EMAIL_ANALYSIS);u=T.createUUID();v.initAccessRecordParams(h,u,v.SourceType.QING_PUBLISH,v.AppType.QING);v.recordResourceOperation(v.OperationType.QING_VISIT);window.addEventListener("unload",function(){v.recordResourceOperation(v.OperationType.QING_EXIT)});F.loadPublishOperList(h,null,function(m){var l=com.kingdee.bos.qing.publish.model.OperType;A=new L(m?m[l.LONGER]:null);w()},!0)};this.protectedInitDesignerForLonger=
function(w){w.setDesignerOperationJudger(A,null)};this.protectedHaveToCarryData=function(){return"true"==F.getUrlParamUtil().getUrlParam("haveToCarryData")};this.protectedLoadingLonger=function(w,u,v){F.loadMeta(w,function(m){var l=com.kingdee.bos.qing.schemamanage.SchemaManage,D=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel;u.prepareMeta(m);m=new l(h,D.SCHEMASOURCE_LONGER);m.setDesignerOperationJudger(A);m.setReloadMetaFun(function(J){F.reloadMeta(function(U){u.prepareMeta(U);J&&J()})});
m.initalizeParameter(y,u);m.loadDefaultSchema(v,null)})}};var B,T,E,Y,L;(function(){var I=com.kingdee.bos.qing;E=I.RemoteImpl;I=com.kingdee.bos.qing.common;B=I.DomUtil;T=I.Util;I=com.kingdee.bos.qing.scene.common.designer;Y=I.AbstractDesignerSceneImpl;L=I.LongerDesignerOperationJudgerModel})()})();
//qingVersionTag: 20250324