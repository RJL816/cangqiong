(function(){function E(){Z.call(this);var q=this,l=this.protectedMethod,x,X,T,J,aa;this.setCurrentPublishSchema=function(a){aa=a};this.setUserOperatorPrevCheck=function(a){T=a};this.setCloseResourceLock=function(a){};this.protectedHaveToCarryData=function(){return!1};this.protectedNeedToShowMessageBox=function(){return!0};this.protectedGetRemoteUrl=function(){var a=l.getUrlParamUtil().getParamPathPrefix();return(a?a:"/ierp")+"/qing/core.do"};this.protectedImportMoreCode=function(a){a.pushSkinJs("scene",
"skin");a.pushI18n("scene","scene")};this.protectedCustomInitEnv=function(a){a=$("<div>");a.css({position:"fixed",bottom:"3px",right:"1px",width:"180px",height:"18px",zIndex:"999"});ha(a);q.protectedNeedToShowMessageBox()&&da(a);a.appendTo($(document.body));com.kingdee.bos.qing.integration.ImglibUrlParser.hookUrlParser()};var ha=function(a){F.setCallback(function(){var b=new com.kingdee.bos.qing.support.Main;b.setParamLanguage(l.getUrlParamUtil().getParamLanguage());b.creatSupportUi(a)});F.loadCss("support/support.css");
F.loadJs("support/support-ui.js");F.loadI18n("support","support")},da=function(a){F.setCallback(function(){var b=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");b=b?b:"/ierp";com.kingdee.bos.qing.message.common.Integration.setRemoteUrl(b+"/qing/messageManage.do");L(b);var f=new com.kingdee.bos.qing.message.ui.Main;f.setFunOpenMessageDialog(function(){f.setViewSize(null,null,10,30)});f.setMessageWidth(80);f.getJqUi(25).appendTo(a)});F.loadSkinCss("message","message");
F.loadSkinJs("message","skin");F.loadJs("message/message-manage-ui.js");F.loadI18n("message","message")},L=function(a){var b=com.kingdee.bos.qing.message.common.Integration;b.setImportJSCodeForManager(function(){var g=com.kingdee.bos.qing.CodeLoader;g.setCallback(function(){var m=com.kingdee.bos.qing.theme.message.panel.common.Integration;m.setFunPublishRemoteImpl(function(){var e=new com.kingdee.bos.qing.theme.message.panel.common.RemoteImpl;e.setRemoteUrl(a+"/qing/publishTo.do");return e});m.setFunQingCenterAndMenuEntrance(function(e,
c,k,p){c=B.getUrlParamValue();var h=a+"/qing/publishEntrance.do";h=d.appendParamToUrl(h,"publishId",e);"extreport"==p?(h=d.appendParamToUrl(h,"appID","qing_rpt"),c&&(h=d.appendParamToUrl(h,"skin",c)),y.openNewTabInAppId(k,h,h,y.QING_RPT)):(c&&(h=d.appendParamToUrl(h,"skin",c)),y.openNewTabInAppId(k,h,h,y.QING_ANALYSIS))});m.setResourceRemoteUrl(a+"/qing/resource.do");m.setDataModelEntrance(function(e,c,k){var p=B.getUrlParamValue();c=v.get("dataModeling","\u6570\u636e\u51c6\u5907")+"-"+c;var h=a+
"/qing/dataModelingEntrance.do";h=d.appendParamToUrl(h,"themeID",e);h=d.appendParamToUrl(h,"isPreset",k);p&&(h=d.appendParamToUrl(h,"skin",p));y.openNewTabInAppId(c,h,h,y.QING_ANALYSIS)});m.setFunPublishContext(function(){var e=new com.kingdee.bos.qing.publish.common.PublishContext;e.setParamPathPrefix(a);e.setLappEntranceUrl(a+"/qing/lappEntrance.do");e.setSpaceID(G.getUrlParamValue("qingID"));return e});m.setFunPublishedEmailLoginViewUrl(function(){var e=B.getUrlParamValue(),c=G.getUrlParamValue("language"),
k=a+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";e&&(k=d.appendParamToUrl(k,"skin",e));c&&(k=d.appendParamToUrl(k,"language",c));return k});m.setFunPublishedEmailAnonymousViewUrl(function(){var e=B.getUrlParamValue(),c=G.getUrlParamValue("language"),k=a+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";e&&(k=d.appendParamToUrl(k,"skin",e));c&&(k=d.appendParamToUrl(k,
"language",c));return k});m.setFunPublishContentEditEntrance(function(){return function(e,c,k){var p=com.kingdee.bos.qing.publish.model.PublishTargetType;if(k&&p.MOBILE==k){p=e.getPublishId();var h=e.getId()}else p=e.getId();var n=B.getUrlParamValue(),H=G.getUrlParamValue("language");k=a+"/qing/publishContentEditEntrance.do";k=d.appendParamToUrl(k,"skin",n);k=d.appendParamToUrl(k,"language",H);k=d.appendParamToUrl(k,"publishId",p);h&&(k=d.appendParamToUrl(k,"lappId",h));h=k;c&&(p="editPublishedContent-"+
p,n=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,n.putSubscribe(p,c),k=d.appendParamToUrl(k,"subscribeKey",p),k=d.appendParamToUrl(k,"currentPageClientId",n.getCurrentPageClientId()));c=com.kingdee.bos.qing.framework.common.TabbedUiUtil;c.openNewTabInAppId(v.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+e.getName(),k,h,c.QING_ANALYSIS)}});m.setFunTimedPushContentEditEntrance(function(){return function(e){var c=a+"/qing/timedPushContentEditEntrance.do",k=v.get("editTimedPushContent",
"\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(e instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var p=e.getId(),h=e.getPublishSourceType();n=e.getSchemaSourceType();c=d.appendParamToUrl(c,"configId",p);c=d.appendParamToUrl(c,"publishSourceType",h);c=d.appendParamToUrl(c,"schemaType",n);c=d.appendParamToUrl(c,"pushTarget","email");k=k+"-"+e.getNameRule().getName();e.isSourceNameNotFound()&&(c=d.appendParamToUrl(c,"errorCode","2301001"))}else{p=e.getId();h=e.getPushTargetType();var n=e.getSchemaType();
c=d.appendParamToUrl(c,"configId",p);c=d.appendParamToUrl(c,"pushTargetType",h);c=d.appendParamToUrl(c,"schemaType",n);c=d.appendParamToUrl(c,"pushTarget","lapp");k=k+"-"+e.getName();e.getSourceName()||(c=d.appendParamToUrl(c,"errorCode","2301001"))}e=B.getUrlParamValue();n=G.getUrlParamValue("language");e&&(c=d.appendParamToUrl(c,"skin",e));n&&(c=d.appendParamToUrl(c,"language",n));e=com.kingdee.bos.qing.framework.common.TabbedUiUtil;e.openNewTabInAppId(k,c,c,e.QING_ANALYSIS)}});m=com.kingdee.bos.qing.modeler.message.panel.common.Integration;
m.setMessageRemoteUrl(a+"/qing_modeler/message.do");m.setFunOpenModelSetPage(function(e,c){var k=B.getUrlParamValue(),p=v.get("modelSet","\u6a21\u578b\u96c6-")+c,h=a+"/qing_modeler/modelSetMainPage.do";h=d.appendParamToUrl(h,"modelSetId",e);h=d.appendParamToUrl(h,"modelSetName",c);h=d.appendParamToUrl(h,"currentPageClientId",com.kingdee.bos.qing.framework.common.RemoteFramework.getClientID());k&&(h=d.appendParamToUrl(h,"skin",k));y.openNewTabInAppId(p,h,h,y.QING_MODELER)});m.setFunOpenModelDesign(function(e,
c,k,p,h){var n=com.kingdee.bos.qing.modeler.message.panel.common.ModelType,H=B.getUrlParamValue();h=(h=n.getModelTypeText(h))?h+"-"+k:k;n=a+"/qing_modeler/deployDesignerEntrance.do";n=d.appendParamToUrl(n,"modelSetId",e);n=d.appendParamToUrl(n,"modelId",c);n=d.appendParamToUrl(n,"modelName",k);n=d.appendParamToUrl(n,"modelDeployId",p);H&&(n=d.appendParamToUrl(n,"skin",H));y.openNewTabInAppId(h,n,n,y.QING_MODELER)})});g.loadSkinCss("message","messagepanel");g.loadSkinJs("message","skin");g.loadJs("message/message-content-panel-management.js");
g.loadI18n("message","messagepanel");g.loadSkinCss("qingmodeler/message","message-modeler-panel");g.loadSkinJs("qingmodeler/message","skin");g.loadJs("qingmodeler/message/message-content-panel-management.js");g.loadI18n("qingmodeler/message","message-modeler-panel")});var f=d.decodeParamFromUrl(location.search,"appID");b.setAppId(f)},Q=function(a){a=new com.kingdee.bos.qing.publish.permission.PermLabelManageDialog(C());a.setSpaceID(G.getUrlParamValue("qingID"));a.showDialog()},R=function(a,b,f,g,
m,e){var c=com.kingdee.bos.qing.publish.model.PublishSourceType,k=com.kingdee.bos.qing.publish.model.PublishTargetType;a!=c.EXTREPORT&&a!=c.DASHBOARD&&b!=k.GUIMENU?(a=new com.kingdee.bos.qing.publish.common.PublishFacade(C(),function(p){e&&e()},function(p,h){return 2301016==p?(Y().showPrompt(v.get("publishNoOperAuthExceptionCurtain","\u6ca1\u6709\u64cd\u4f5c\u6743\u9650\u3002"),2E3),!0):!1}),b=f.getBizTag(),c=f.getDsbPublishId(),f.getRefToId()&&(b=f.getRefToId()),a.judgePublishOper(b,c,g,m)):e&&e()},
ea=function(){com.kingdee.bos.qing.timedpush.LappIntegration.syncDatacenterInfo(C())},ka=function(){var a=l.getUrlParamUtil().getParamPathPrefix();com.kingdee.bos.qing.timedpush.LappIntegration.setLappPrivateUrl(a+"/qing/lappPrivateInfo.do")},N=function(a,b,f,g,m,e){var c=l.getUrlParamUtil().getParamPathPrefix(),k=com.kingdee.bos.qing.publish.common,p=k.PublishContext;k=com.kingdee.bos.qing.schemamanage.model;var h=k.SchemaAttrModel;k=k.SchemaModel;var n=l.getUrlParamUtil().getUrlParam("bizTag"),
H=q.protectedHaveToCarryData(),r;com.kingdee.bos.qing&&com.kingdee.bos.qing.prepare&&com.kingdee.bos.qing.prepare.DataSourceInfoContext&&(r=com.kingdee.bos.qing.prepare.DataSourceInfoContext.getCurrentDataSourceInfo());var I=r&&r.hasDirectModeTable();r=new p;r.setSource(m);r.setBizTag(n);r.setCurrentSourceType(b);r.setHaveToCarryData(H);r.setHasDirectModeTable(I);r.setParamPathPrefix(c);r.setSchemaTag("Dashboard-Analysis"==e?l.getUrlParamUtil().getUrlParam("schemaTag"):null);r.setSpaceID(G.getUrlParamValue("qingID"));
b=new h;b.setSchemaType(h.SCHEMATYPE_SYSTEM);b.setIsDefault(!0);b.setSchemaName(w("sysPublishScheme","\u7cfb\u7edf\u9ed8\u8ba4\u65b9\u6848"));b.setSource(f);m=new k;m.setSchemaAttr(b);m.setSchemaContent(a.getJsonModelBook());a=m.toJsonObject();r.setCurrentContentModel(a);a=l.getUrlParamUtil().getParamTag();b=function(D){D+="/qinganalysis/lappPreviewEntrance.do";for(var t=window.location.search.substring(1).split("&"),A=0;A<t.length;A++){var z=t[A],K=z.indexOf("=");if(-1!=K){var U=z.substring(0,K);
"clientID"!=U&&"safetyCode"!=U&&(z=z.substring(K+1),D+=0>D.indexOf("?")?"?":"&",D+=U,D+="=",D+=z)}}return D};f==h.SCHEMASOURCE_SQUARE?(r.setScene(p.Scene.Square),f=b(c),f=d.appendParamToUrl(f,"view","10"),r.setMobilePreviewUrl(f),c=d.appendParamToUrl(c+"/qing/lappEntrance.do","tag",a),c=d.appendParamToUrl(c,"view","10"),r.setLappEntranceUrl(c)):f==h.SCHEMASOURCE_LONGER&&(r.setScene(p.Scene.Longer),r.setMobilePreviewUrl(b(c)),c=d.appendParamToUrl(c+"/qing/lappEntrance.do","tag",a),r.setLappEntranceUrl(c));
g&&(r.setRefToId(l.getUrlParamUtil().getUrlParam("publishId")),r.setDsbPublishId(g),r.setDashBoardAnalysis(!0));return r},pa=function(a){var b=!1;if(a&&(a=a.tables)&&0<a.length)for(var f=0;f<a.length;f++)if(a[f].subViews){b=!0;break}return b},S=function(a,b){T?T(function(f){var g=new com.kingdee.bos.qing.schemamanage.common.SchemaManageFacade(qa(),function(e){e.publishInfoPerCheck==E.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST?a&&a(b):e.publishInfoPerCheck==E.THEME_IS_DEL?fa($(document.body),"msg-warning",
v.get("ThemeIsDel","\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u6765\u6e90\u88ab\u5220\u9664")):e.publishInfoPerCheck==E.PUBLISHINFO_NOEXIST?fa($(document.body),"msg-warning",v.get("publishInfoExist","\u53d1\u5e03\u8bb0\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664")):e.publishInfoPerCheck==E.PERMISSION_CANCEL?fa($(document.body),"msg-jurisdiction",v.get("notAuthority","\u60a8\u6ca1\u6709\u8be5\u53d1\u5e03\u8bb0\u5f55\u7684\u67e5\u770b\u6743\u9650, \u8bf7\u8054\u7cfb\u53d1\u5e03\u4eba")+'"'+e.publishInfoUserName+
'"'+v.get("authority","\u6388\u6743")):e.publishInfoPerCheck==E.PUBLSIHPLAN_DELETE&&fa($(document.body),"msg-warning",v.get("publishPlanExist","\u8be5\u5206\u6790\u65b9\u6848\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"))}),m=new com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel;m.setFId(aa.getCurrentSchemaId());m.setSchemaName(aa.getCurrentSchemaName());g.checkPublishInfoAndAuthority(f,m)}):a&&a(b)},qa=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=l.getUrlParamUtil().getParamTag();
a=(a?a:"/ierp")+"/qing/schemaManage.do";var f=new com.kingdee.bos.qing.RemoteImpl;f.setRemoteUrl(a);f.setTag(b);return f},fa=function(a,b,f){a=new V;a.setOptionType(V.OPTION_OK);a.setButtonText(V.RETURN_OK,v.get("ISee","\u6211\u77e5\u9053\u4e86"));var g={};g.text=f;g.iconName=b;a.setMessage(g);a.setCustomPainter(function(m,e){var c=$("<div>");c.addClass("sa-ctrl-msgdlg-icon");ba.background(c,e.iconName);var k=$("<div>");k.addClass("sa-ctrl-msgdlg-content");k.text(e.text);m.append(c);m.append(k)});
a.showDialog(380,280)},la=function(a,b,f){x?b(x):(new com.kingdee.bos.qing.core.Facade(a,function(g){x=g;b(g)},f)).getMeta()},ma=function(a){x=null;la(q.getRemoteImpl(),a)},C=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=l.getUrlParamUtil().getParamTag();a=(a?a:"/ierp")+"/qing/publishTo.do";var f=new com.kingdee.bos.qing.RemoteImpl;f.setRemoteUrl(a);f.setTag(b);return f},na=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=B.getUrlParamValue(),f=l.getUrlParamUtil().getParamLanguage();
a=(a?a:"/ierp")+"/index.html?userId=Guest&accountId=(accountId)&appNumber=qing&formId=qing_analysis_pub_email#/dform?appNumber=qing&formId=qing_analysis_pub_email&publishId=(publishId)";b&&(a=d.appendParamToUrl(a,"skin",b));f&&(a=d.appendParamToUrl(a,"language",f));return a},oa=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=B.getUrlParamValue(),f=l.getUrlParamUtil().getParamLanguage();a=(a?a:"/ierp")+"/qing/publishedEmailEntrance.do?publishId=(publishId)&kdcdc=(accountId)";b&&(a=d.appendParamToUrl(a,
"skin",b));f&&(a=d.appendParamToUrl(a,"language",f));return a},ca=function(){return function(a,b,f){var g=com.kingdee.bos.qing.publish.model.PublishTargetType;if(f&&g.MOBILE==f){f=a.getPublishId();var m=a.getId();var e=a.getLappUserType()}else f=a.getId();g=l.getUrlParamUtil().getParamPathPrefix();var c=B.getUrlParamValue(),k=l.getUrlParamUtil().getParamLanguage();g=d.appendParamToUrl((g?g:"/ierp")+"/qing/publishContentEditEntrance.do","skin",c);g=d.appendParamToUrl(g,"language",k);g=d.appendParamToUrl(g,
"publishId",f);m&&(g=d.appendParamToUrl(g,"lappId",m));e&&(g=d.appendParamToUrl(g,"lappUserType",e));m=g;b&&(e="editPublishedContent-"+f,f=com.kingdee.bos.qing.publish.common.PublishSubscribeHelper,f.putSubscribe(e,b),g=d.appendParamToUrl(g,"subscribeKey",e),g=d.appendParamToUrl(g,"currentPageClientId",f.getCurrentPageClientId()));y.openNewTab(v.get("editPublishedContent","\u7f16\u8f91\u53d1\u5e03\u65b9\u6848-")+a.getName(),g,m)}},ia=function(){return function(a){var b=l.getUrlParamUtil().getParamPathPrefix();
b=(b?b:"/ierp")+"/qing/timedPushContentEditEntrance.do";var f=v.get("editTimedPushContent","\u7f16\u8f91\u63a8\u9001\u65b9\u6848");if(a instanceof com.kingdee.bos.qing.timedpush.model.EmailConfig){var g=a.getId(),m=a.getPublishSourceType();e=a.getSchemaSourceType();b=d.appendParamToUrl(b,"configId",g);b=d.appendParamToUrl(b,"publishSourceType",m);b=d.appendParamToUrl(b,"schemaType",e);b=d.appendParamToUrl(b,"pushTarget","email");f=f+"-"+a.getNameRule().getName();a.isSourceNameNotFound()&&(b=d.appendParamToUrl(b,
"errorCode","2301001"))}else{g=a.getId();m=a.getPushTargetType();var e=a.getSchemaType();b=d.appendParamToUrl(b,"configId",g);b=d.appendParamToUrl(b,"pushTargetType",m);b=d.appendParamToUrl(b,"schemaType",e);b=d.appendParamToUrl(b,"pushTarget","lapp");f=f+"-"+a.getName();a.getSourceName()||(b=d.appendParamToUrl(b,"errorCode","2301001"))}a=B.getUrlParamValue();e=l.getUrlParamUtil().getParamLanguage();a&&(b=d.appendParamToUrl(b,"skin",a));e&&(b=d.appendParamToUrl(b,"language",e));y.openNewTab(f,b)}},
w=function(a,b){return v.get(a,b)},Y=function(){X||(X=new com.kingdee.bos.qing.ui.component.MessageCurtain,X.getJqUi().appendTo($(document.body)));return X};l.getMLS=w;l.importLinkage=function(a){a.pushSkinJs("linkage","skin");a.pushJs("linkage/linkage.js");a.pushSkinCss("linkage","linkage")};l.importForSchema=function(a){a.pushSkinJs("schema-manage","skin-initialize");a.pushJs("schema-manage/schema-manage-initialize.js");a.pushI18n("schema-manage","schema-initialize");a.pushSkinCss("schema-manage",
"schema-manage");a.pushJs("schema-manage/schema-manage-ui.js");a.pushI18n("schema-manage","schema-ui")};l.importForPublish=function(a){a.pushJs("biz-common/qing-biz-common.js");a.pushSkinCss("biz-common","biz-common");a.pushSkinJs("biz-common","skin");a.pushI18n("biz-common","biz-common");a.pushSkinJs("imagelib","skin");a.pushSkinCss("imagelib","qing-imagelib");a.pushJs("imagelib/imagelib.js");a.pushI18n("imagelib","imagelib");a.pushJs("common/qing-schedule.js");a.pushI18n("common","qing-schedule");
a.pushSkinCss("publish","qing-publish");a.pushSkinJs("publish","skin");a.pushI18n("publish","publish");a.pushJs("publish/qing-publish.js");a.pushSkinCss("timedpush","qing-timedpush");a.pushSkinJs("timedpush","skin");a.pushI18n("timedpush","timedpush");a.pushJs("timedpush/qing-timedpush.js");a.pushJs("lightapp/common/qing-lapp-env.js");a.pushJs("timedpush/qing-timedpush-lapp.js");a.pushJs("timedpush/html2canvas.js")};l.importForMap=function(a){a.pushSkinJs("map-designer","integration-skin");a.pushJs("map-designer/map-integration.js");
a.pushSkinCss("map-designer","map-integration");a.pushI18n("map-designer","map-integration")};l.hookLongerPublishTo=function(a,b,f,g,m,e){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(r,I,D){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(r,I,0,D)});b=com.kingdee.bos.qing.publish.model;var c=b.PublishTargetType;b=com.kingdee.bos.qing.schemamanage.model;var k=b.SchemaAttrModel,p=function(r){var I=com.kingdee.bos.qing.publish.common.PublishFactory,
D=r.getUserObject(),t=r.getText().replace("...",""),A=N(a,f,k.SCHEMASOURCE_LONGER,g,m,e);R(f,D,A,"longer",u.ANALYSIS_PUBLISH,function(){var z=I.createPublishToDialog(t,C(),A,D,ca());z.setOuterMessageCurtain(Y());z.showDialog()})},h=com.kingdee.bos.qing.ui.component.MenuItemModel;b=new com.kingdee.bos.qing.ui.component.MenuModel;var n=new h(function(r){S(p,r)});n.setUserObject(c.APPMENU);n.setText(w("toAppMenu","\u5e94\u7528\u83dc\u5355..."));b.addItemModel(n);n=new h(function(r){S(p,r)});n.setUserObject(c.CENTER);
n.setText(w("toAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939..."));b.addItemModel(n);n=new h(function(r){S(p,r)});n.setUserObject(c.MOBILE);n.setText(w("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));b.addItemModel(n);ea();ka();b.addSeperator();var H=function(){var r=com.kingdee.bos.qing.publish.common.PublishManagerDialog,I=N(a,f,com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_LONGER);(new r(C(),I,ca())).showDialog()};n=new h(function(r){S(H,r)});n.setUserObject();
n.setText(w("publishManager","\u53d1\u5e03\u7ba1\u7406")+"...");b.addItemModel(n);c=new h(Q);c.setUserObject();c.setText(w("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");b.addItemModel(c);c=w("publishTo","\u53d1\u5e03\u5230");return a.getConductor().appendToolbarMenu(b,"publish_to",c)};l.hookSquarePublishTo=function(a,b,f){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(p,h,n){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(p,h,0,
n)});b=com.kingdee.bos.qing.publish.model;var g=b.PublishTargetType;b=com.kingdee.bos.qing.schemamanage.model;var m=b.SchemaAttrModel,e=function(p){var h=com.kingdee.bos.qing.publish.common.PublishFactory,n=p.getUserObject(),H=p.getText().replace("...",""),r=N(a,f,m.SCHEMASOURCE_SQUARE);R(f,n,r,"square",u.CARD_PUBLISH,function(){var I=h.createPublishToDialog(H,C(),r,n,ca());I.setOuterMessageCurtain(Y());I.showDialog()})},c=com.kingdee.bos.qing.ui.component.MenuItemModel;b=new com.kingdee.bos.qing.ui.component.MenuModel;
var k=new c(e);k.setUserObject(g.CARD_REPOSITORY);k.setText(w("toCardRepository","\u5361\u7247\u5e93..."));b.addItemModel(k);e=new c(e);e.setText(w("toMobile","\u79fb\u52a8\u8f7b\u5e94\u7528..."));e.setUserObject(g.MOBILE);b.addItemModel(e);ea();ka();b.addSeperator();g=new c(function(){var p=com.kingdee.bos.qing.publish.common.PublishManagerDialog,h=N(a,f,com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel.SCHEMASOURCE_SQUARE);(new p(C(),h,ca())).showDialog()});g.setUserObject();g.setText(w("publishManager",
"\u53d1\u5e03\u7ba1\u7406")+"...");b.addItemModel(g);g=new c(Q);g.setUserObject();g.setText(w("permLabelManage","\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"...");b.addItemModel(g);g=w("publishTo","\u53d1\u5e03\u5230");return a.getConductor().appendToolbarMenu(b,"publish_to",g)};l.hookPublishManager=function(a,b,f){var g=w("publishManager","\u53d1\u5e03\u7ba1\u7406");return a.getConductor().appendToolbarButton(function(){var m=com.kingdee.bos.qing.publish.common.PublishManagerDialog,e=N(a,b,f);(new m(C(),
e,ca())).showDialog()},"publish_manager",g)};l.hookCloseTab=function(a){var b=w("closeTab","\u9000\u51fa");return a.getConductor().appendToolbarButton(function(){a.getConductor().isDirty()?O.showConfirmExitDialog():y.closeCurrentTab()},"error_close",b)};l.hookShareTo=function(a,b,f,g,m){com.kingdee.bos.qing.publish.common.UserOperationReporter.hookCollector(function(t,A,z){com.kingdee.bos.qing.behavior.BehaviorManager.interestInBehavior(t,A,0,z)});var e=function(t){t=w("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a...").replace("...",
"");var A=N(a,g,b);t=com.kingdee.bos.qing.timedpush.PublishToYunzhijiaDialogFactory.createDialog(t,C(),A);t.setOuterMessageCurtain(Y());t.showDialog()},c=function(t){t=com.kingdee.bos.qing.CodeLoader.createSafety();t.pushJs("yzj-web/qingjs.js");t.pushJs("yzj-web/imcloud.js");t.pushJs("yzj-web/imsdkerp.js");t.pushJs("yzj-web/imShare.js");t.pushSkinCss("yzj-web","imcloud");t.pushSkinCss("yzj-web","imsdk");t.pushSkinCss("yzj-web","imsdkerp");t.load(function(){})};f=new P;(new M(function(t){window.beLoadedImCloud?
e(t):c(t)})).setText(w("yzjCommunicate","\u4e91\u4e4b\u5bb6\u6c9f\u901a..."));var k=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel,p=q.protectedHaveToCarryData(),h;com.kingdee.bos.qing&&com.kingdee.bos.qing.prepare&&com.kingdee.bos.qing.prepare.DataSourceInfoContext&&(h=com.kingdee.bos.qing.prepare.DataSourceInfoContext.getCurrentDataSourceInfo());h=h&&h.hasDirectModeTable();var n=com.kingdee.bos.qing.publish.model.PublishTargetType;if(!h&&!p&&b==k.SCHEMASOURCE_LONGER){var H=function(t){var A=
t.getText().replace("...",""),z=N(a,g,b,m);R(g,n.EMAIL,z,"longer",u.ANALYSIS_TIMEPUSH,function(){var K=new com.kingdee.bos.qing.timedpush.EmailPublishConfigDialog(A,C(),z,na(),oa(),ia(),a);K.setOuterMessageCurtain(Y());K.showDialog()})},r=new M(function(t){S(H,t)});r.setText(w("emailSchedulePush","\u90ae\u4ef6\u5b9a\u65f6\u63a8\u9001..."));f.addItemModel(r)}if(!h&&!p){var I=function(t){var A=N(a,g,b,m),z="longer",K=u.ANALYSIS_TIMEPUSH;b==k.SCHEMASOURCE_SQUARE&&(z="square",K=u.CARD_TIMEPUSH);R(g,n.EMAIL,
A,z,K,function(){var U=new com.kingdee.bos.qing.timedpush.LappSchedulePush,ja=t.getText().replace("...","");U.createDialog(ja,C(),A,ia(),a)})};p=new M(function(t){S(I,t)});p.setText(w("mobileSchedulePush","\u79fb\u52a8\u7aef\u5b9a\u65f6\u63a8\u9001")+"...");f.addItemModel(p)}f.addSeperator();var D=function(){var t=com.kingdee.bos.qing.publish.common.PushManager,A=N(a,g,b);t=new t(ia());var z=com.kingdee.bos.qing.timedpush;t.registerEmailPushPanelConstructor(z.EmailConfigManagePanel);t.initEmailPushConfig(C(),
na(),oa());t.registerLappPushPanelConstructor(z.LappPushManagePanel);t.initLappPushConfig(function(K,U,ja){return com.kingdee.bos.qing.publish.common.PublishFactory.createPublishFacade(com.kingdee.bos.qing.publish.model.PublishTargetType.MOBILE,C(),K,U,ja)},A);t.showDialog()};p=new M(function(t){S(D,t)});p.setUserObject();p.setText(w("pushManager","\u5b9a\u65f6\u63a8\u9001\u7ba1\u7406")+"...");f.addItemModel(p);f=a.getConductor().appendToolbarMenu(f,"btn_communicate",w("timedPush","\u5b9a\u65f6\u63a8\u9001"));
f.addActionListener(function(){window.beLoadedImCloud||(window.funCallback=e)});return f};l.initDesigntimeLinkage=function(){var a=l.getUrlParamUtil().getParamPathPrefix(),b=(a?a:"/ierp")+"/qing/linkage.do",f=com.kingdee.bos.qing.integration.LinkageJumper;a=new com.kingdee.bos.qing.linkage.LinkageManage;a.initDesigntime(b,f.jump);b=l.getUrlParamUtil().getParamTag();a.setCurrentLinkageTag(b)};l.loadMeta=la;l.reloadMeta=ma;l.hookRefresh=function(a,b){var f=l.getMLS("refresh","\u6570\u636e\u66f4\u65b0"),
g=function(){b.restart();b.setExtractDataFinishedSuccessCallback(function(m){m||pa(x)?ma(function(e){var c=a.getJsonModelBook();a.prepareMeta(e);a.setJsonModelBook(c)}):a.reExecute()})};return a.getConductor().appendToolbarButton(function(){S(g)},"btn_reset",f)};l.getMessageCurtain=Y;l.hookSetCurrentTabStatus=function(a){a.getConductor().setDirtyListener(function(b){O.setTabStatus(b)})};l.loadPublishOperList=function(a,b,f,g,m){J?f(J):(new com.kingdee.bos.qing.publish.common.PublishFacade(C(),function(e){J=
e;f(J)},m)).loadPublishOperList(a,b,g)};l.loadPublishOperModel=function(a,b,f,g){J?f(J):(new com.kingdee.bos.qing.publish.common.PublishFacade(C(),function(m){J=m.noOperValueMap;f(J)},g)).loadPublishOperModel(a,b)};l.registMapMapLibrary=function(a){com.kingdee.bos.qing.map.common.Integration.setRemoteUrl(a+"/qing/mapManage.do");var b=new com.kingdee.bos.qing.map.integration.MapSelectorDialog;com.kingdee.bos.qing.core.MapLibraryRegister.registerTemplateSelector(function(f,g){b.setParamPathPrefix(a);
b.showDialog(f,g)})}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});"undefined"==typeof com.kingdee.bos.qing.scene.common&&(com.kingdee.bos.qing.scene.common={});"undefined"==typeof com.kingdee.bos.qing.scene.common.designer&&(com.kingdee.bos.qing.scene.common.designer=
{});var W=com.kingdee.bos.qing.scene.common.designer,B,Z,F,V,ba,d,v,y,P,M,O,G;(function(){var q=com.kingdee.bos.qing;B=q.SkinUtil;Z=q.AbstractDesignerScene;F=q.CodeLoader;G=q.Seer;q=com.kingdee.bos.qing.common;d=q.Util;q=com.kingdee.bos.qing.framework.common;v=q.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.scene);y=q.TabbedUiUtil;q=com.kingdee.bos.qing.ui.component;P=q.MenuModel;M=q.MenuItemModel;V=q.MessageDialog;ba=q.Icons;q=com.kingdee.bos.qing.integration;O=q.TabStatusHelper})();
W.AbstractDesignerSceneImpl=E;W.LongerDesignerOperationJudgerModel=function(q){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);q&&0!=q&&(this.protectedParseDesignable=function(){return 0==(q&u.ANALYSIS_EDITABLE)},this.protectedParseDataDetailReadable=function(){return 0==(q&u.ANALYSIS_DETAIL)},this.protectedParseExportable=function(){return 0==(q&u.ANALYSIS_EXPORT)},this.protectedParsePrintable=function(){return 0==(q&u.ANALYSIS_PRINT)},this.protectedParsePublishable=function(){return 0==
(q&u.ANALYSIS_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(q&u.ANALYSIS_TIMEPUSH)})};W.SquareDesignerOperationJudgerModel=function(q){com.kingdee.bos.qing.core.SquareDesignerOperationJudger.call(this);q&&0!=q&&(this.protectedParsePublishable=function(){return 0==(q&u.CARD_PUBLISH)},this.protectedParseTimingPushable=function(){return 0==(q&u.CARD_TIMEPUSH)})};W.LongerDesignerOperationJudger=function(){com.kingdee.bos.qing.core.LongerDesignerOperationJudger.call(this);var q=this;
this.protectedParseDesignable=function(){return q.isDesignable()};this.protectedParseDataDetailReadable=function(){return q.isDataDetailReadable()};this.protectedParseExportable=function(){return q.isExportable()};this.protectedParsePrintable=function(){return q.isPrintable()};this.protectedParsePublishable=function(){return q.isPublishable()};this.protectedParseTimingPushable=function(){return q.isTimingPushable()}};var u={};W.OperCodeType=u;u.ANALYSIS_EDITABLE=2;u.ANALYSIS_EXPORT=4;u.ANALYSIS_PRINT=
8;u.ANALYSIS_PUBLISH=16;u.ANALYSIS_TIMEPUSH=32;u.ANALYSIS_DETAIL=64;u.CARD_PUBLISH=256;u.CARD_TIMEPUSH=512;u.ENTRY_ANALYSIS=1;u.ENTRY_SQUARE=128;E.THEME_IS_DEL="Theme is Delete";E.PUBLISHINFO_PERMISSION_PUBLISHPLAN_EXIST="success";E.PUBLISHINFO_NOEXIST="PublishInfo Not Exist";E.PERMISSION_CANCEL="Not Permission";E.PUBLSIHPLAN_DELETE="Publish Not Exist"})();(function(){function E(d,v,y,P){Z.call(this,d,v,y,P);var M=this.protectedMethod;this.loadSquareSchema=function(O,G){O={ref:JSON.stringify(O),dashboardUniqueId:G};M.remote("squareLoadSchema",O)}}function W(){F.call(this);var d;this.getRemoteUrl=function(v){return d};this.setRemoteUrl=function(v){d=v}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing=
{});"undefined"==typeof com.kingdee.bos.qing.scene&&(com.kingdee.bos.qing.scene={});com.kingdee.bos.qing.scene.QHFPublishDsbAnalysisdScene=function(){V.call(this);var d=this.protectedMethod,v,y,P,M,O=this.protectedImportMoreCode;this.protectedImportMoreCode=function(l){O(l);d.importForSchema(l);d.importForPublish(l)};var G=this.protectedCustomInitEnv;this.protectedCustomInitEnv=function(l){d.setModuleWithLonger(!0,!0);d.setModuleWithSquare(!1,!1);G(l);y=d.getUrlParamUtil().getUrlParam("ref");v=d.getUrlParamUtil().getUrlParam("dashboardUniqueId");
P=new B;var x=q()+"/qing/qhfRuntimeDsb.do";P.setRemoteUrl(x);P.setTag(d.getUrlParamUtil().getParamTag());M=new ba(null);l()};this.protectedInitDesignerForLonger=function(l){l.setDesignerOperationJudger(M,null);var x=window.sessionStorage.getItem("qhf-oAdditionalFilterApi");x&&(window.sessionStorage.removeItem("qhf-oAdditionalFilterApi"),x=com.kingdee.bos.qing.core.shared.AdditionalFilterInfoParser.decodeAdditionalFilterApi(x),l.setAdditionalFilterApi(x));d.hookCloseTab(l)};this.protectedLoadingLonger=
function(l,x,X){d.loadMeta(l,function(T){var J=com.kingdee.bos.qing.schemamanage.SchemaManage,aa=com.kingdee.bos.qing.schemamanage.model.SchemaAttrModel,ha=com.kingdee.bos.qing.schemamanage.LoadSchemaError;x.prepareMeta(T);var da=new J(v,aa.SCHEMASOURCE_LONGER);da.setReloadMetaFun(function(L){d.reloadMeta(function(Q){x.prepareMeta(Q);L&&L()})});(new E(u(),function(L){var Q=L.model;if(L=window.sessionStorage.getItem("qhf-oJsonFilterSetForInstead"))window.sessionStorage.removeItem("qhf-oJsonFilterSetForInstead"),
L=JSON.parse(L),Q=com.kingdee.bos.qing.ModelHelper.mergeFilterState(Q,L);da.initialize(P,x,function(R){R||(R=d.createSquare2LongerModelTransformer(),x.setJsonModelBook(Q,function(ea){(new ha).showErrorMsg(ea)},R));X(!0)},null,!0)},function(){return!1})).loadSquareSchema(JSON.parse(y),v)},function(T,J){return 301201==T?(d.getMessageCurtain().showError(d.getMLS("extractDataFailToRefresh","\u51c6\u5907\u6570\u636e\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u51fa\u6570\u636e\u518d\u8fdb\u884c\u8be5\u64cd\u4f5c\u3002")),
!0):!1})};this.protectedGetRemoteUrl=function(){return q()+"/qing/qhfCore.do"};var u=function(){var l=new W,x=q()+"/qing/qhfRuntimeDsb.do";l.setRemoteUrl(x);return l},q=function(){var l=d.getUrlParamUtil().getParamPathPrefix();return l?l:"/ierp"}};var B,Z,F,V,ba;(function(){var d=com.kingdee.bos.qing;B=d.RemoteImpl;d=com.kingdee.bos.qing.framework.common;Z=d.AbstractFacade;F=d.AbstractRemoteCall;d=com.kingdee.bos.qing.scene.common.designer;V=d.AbstractDesignerSceneImpl;ba=d.LongerDesignerOperationJudgerModel})()})();
//qingVersionTag: 20250324