var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(p,q,C){p instanceof String&&(p=String(p));for(var M=p.length,P=0;P<M;P++){var da=p[P];if(q.call(C,da,P,p))return{i:P,v:da}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,q,C){if(p==Array.prototype||p==Object.prototype)return p;p[q]=C.value;return p};$jscomp.getGlobal=function(p){p=["object"==typeof globalThis&&globalThis,p,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var q=0;q<p.length;++q){var C=p[q];if(C&&C.Math==Math)return C}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(p,q){var C=$jscomp.propertyToPolyfillSymbol[q];if(null==C)return p[q];C=p[C];return void 0!==C?C:p[q]};
$jscomp.polyfill=function(p,q,C,M){q&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(p,q,C,M):$jscomp.polyfillUnisolated(p,q,C,M))};$jscomp.polyfillUnisolated=function(p,q,C,M){C=$jscomp.global;p=p.split(".");for(M=0;M<p.length-1;M++){var P=p[M];if(!(P in C))return;C=C[P]}p=p[p.length-1];M=C[p];q=q(M);q!=M&&null!=q&&$jscomp.defineProperty(C,p,{configurable:!0,writable:!0,value:q})};
$jscomp.polyfillIsolated=function(p,q,C,M){var P=p.split(".");p=1===P.length;M=P[0];M=!p&&M in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var da=0;da<P.length-1;da++){var U=P[da];if(!(U in M))return;M=M[U]}P=P[P.length-1];C=$jscomp.IS_SYMBOL_NATIVE&&"es6"===C?M[P]:null;q=q(C);null!=q&&(p?$jscomp.defineProperty($jscomp.polyfills,P,{configurable:!0,writable:!0,value:q}):q!==C&&(void 0===$jscomp.propertyToPolyfillSymbol[P]&&(C=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[P]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(P):$jscomp.POLYFILL_PREFIX+C+"$"+P),$jscomp.defineProperty(M,$jscomp.propertyToPolyfillSymbol[P],{configurable:!0,writable:!0,value:q})))};$jscomp.polyfill("Array.prototype.find",function(p){return p?p:function(q,C){return $jscomp.findInternal(this,q,C).v}},"es6","es3");
$jscomp.polyfill("String.prototype.replaceAll",function(p){return p?p:function(q,C){if(q instanceof RegExp&&!q.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return q instanceof RegExp?this.replace(q,C):this.replace(new RegExp(String(q).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),C)}},"es_2021","es3");$jscomp.arrayIteratorImpl=function(p){var q=0;return function(){return q<p.length?{done:!1,value:p[q++]}:{done:!0}}};
$jscomp.arrayIterator=function(p){return{next:$jscomp.arrayIteratorImpl(p)}};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(p){if(p)return p;var q=function(da,U){this.$jscomp$symbol$id_=da;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:U})};q.prototype.toString=function(){return this.$jscomp$symbol$id_};var C="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",M=0,P=function(da){if(this instanceof P)throw new TypeError("Symbol is not a constructor");return new q(C+(da||"")+"_"+M++,da)};return P},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(p){if(p)return p;p=Symbol("Symbol.iterator");for(var q="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),C=0;C<q.length;C++){var M=$jscomp.global[q[C]];"function"===typeof M&&"function"!=typeof M.prototype[p]&&$jscomp.defineProperty(M.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return p},"es6",
"es3");$jscomp.iteratorPrototype=function(p){p={next:p};p[Symbol.iterator]=function(){return this};return p};$jscomp.iteratorFromArray=function(p,q){p instanceof String&&(p+="");var C=0,M=!1,P={next:function(){if(!M&&C<p.length){var da=C++;return{value:q(da,p[da]),done:!1}}M=!0;return{done:!0,value:void 0}}};P[Symbol.iterator]=function(){return P};return P};
$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(q){return q})}},"es6","es3");$jscomp.owns=function(p,q){return Object.prototype.hasOwnProperty.call(p,q)};$jscomp.polyfill("Object.values",function(p){return p?p:function(q){var C=[],M;for(M in q)$jscomp.owns(q,M)&&C.push(q[M]);return C}},"es8","es3");$jscomp.polyfill("Object.is",function(p){return p?p:function(q,C){return q===C?0!==q||1/q===1/C:q!==q&&C!==C}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(p){return p?p:function(q,C){var M=this;M instanceof String&&(M=String(M));var P=M.length;C=C||0;for(0>C&&(C=Math.max(C+P,0));C<P;C++){var da=M[C];if(da===q||Object.is(da,q))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(p,q,C){if(null==p)throw new TypeError("The 'this' value for String.prototype."+C+" must not be null or undefined");if(q instanceof RegExp)throw new TypeError("First argument to String.prototype."+C+" must not be a regular expression");return p+""};$jscomp.polyfill("String.prototype.includes",function(p){return p?p:function(q,C){return-1!==$jscomp.checkStringArgs(this,q,"includes").indexOf(q,C||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(q,C){return C})}},"es8","es3");
var KEXTCommonUtil=new function(){var p=this,q=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;this.isDarkColor=function(C){if(!C)return!1;0==C.indexOf("#")&&(C=p.getRgbIntArr(C));return 128>=Math.round(.299*C[0]+.587*C[1]+.114*C[2])?!0:!1};this.getRgbaString=function(C){return"RGBA("+C.join(",")+")"};this.getRgbIntArr=function(C){if(!C)return C;if((C=C.toLowerCase())&&q.test(C)){if(4===C.length){for(var M="#",P=1;4>P;P++)M+=C.slice(P,P+1).concat(C.slice(P,P+1));C=M}M=[];for(P=1;7>P;P+=2)M.push(parseInt("0x"+
C.slice(P,P+2)));return M}return C}};var Constants={REPORT_EXT:"ext",CHANGE_SHEET:"changeSheet",TREE_ROW_COUNT:200},KReportUtil=function(){var p=function(q){var C=typeof q;if("string"==C)return'"'+q.replace(/["\\\x00-\x1f\x7f-\x9f]/g,function(U){U=U.charCodeAt();return"\\u00"+Math.floor(U/16).toString(16)+(U%16).toString(16)})+'"';if("number"==C){if(isNaN(q)||!isFinite(q))throw Error("SueError: Invalid JSON number type.");return""+q}if("boolean"==C||null===q)return""+q;if("undefined"==C)return"null";if(q instanceof Array){var M="";C=
0;for(var P=q.length;C<P;C++){var da=p(q[C]);M+=da;C<P-1&&(M+=",")}return"["+M+"]"}if("object"==C){C=[];for(M in q)C.push('"'+M+'":'+p(q[M]));return"{"+C.join(",")+"}"}if("function"!=C)throw Error("SueError: Invalid JSON type.");};return{toJson:function(q){try{return eval("("+q+")")}catch(C){return null}},toStr:p,toJsonEscapeString:function(q){q&&(q=q.replace(/"/g,'\\"'),q=q.replace(/\r/g,"\\r"),q=q.replace(/\n/g,"\\n"),q=q.replace(/\t/g,"\\t"));return q},fromJsonEscapeString:function(q){q&&(q=q.replace(/\\"/g,
'"'),q=q.replace(/\\r/g,"\r"),q=q.replace(/\\n/g,"\n"),q=q.replace(/\\t/g,"\t"));return q},getCssStyle:function(q){var C=new KTStyle;C.setFontName(q.fontName);C.setFontSize(q.fontSize);C.setBold(q.isBold);C.setItalic(q.isItalic);C.setUnderLine(q.isUnderLine);C.setLineThrough(q.isLineThrough);C.setColor(q.color);C.setBackgroundColor(q.backgroundColor);C.setTextAlign(q.textAlign);C.setVerticalAlign(q.verticalAlign);C.setWrapText(q.isWrapText);C.setVerticalText(q.isVerticalText);C.setIndent(q.indentation);
C.setRotation(q.rotation);C.setShrinkText(q.isShrinkText);return C},getCssBorder:function(q){var C=new KTBorderStyle;C.setTopBorderPen(q.top.pen);C.setRightBorderPen(q.right.pen);C.setBottomBorderPen(q.bottom.pen);C.setLeftBorderPen(q.left.pen);C.setTopBorderWidth(q.top.width);C.setRightBorderWidth(q.right.width);C.setBottomBorderWidth(q.bottom.width);C.setLeftBorderWidth(q.left.width);C.setTopBorderColor(q.top.color);C.setRightBorderColor(q.right.color);C.setBottomBorderColor(q.bottom.color);C.setLeftBorderColor(q.left.color);
return C},getCssDiagonal:function(q){var C=new KTBorderStyle;C.setLeftBorderPen(q.pen);C.setLeftBorderWidth(q.width);C.setLeftBorderColor(q.color);return C},getCssWidth:function(q,C){var M=$("<div/>");M.css({left:"-1000px",top:"-1000px",position:"absolute",overflow:"hidden",fontSize:C});M.text(q);$(document.body).append(M);q=M.width();M.remove();return q},getCssIntValue:function(q){return parseInt(q.substr(0,q.lastIndexOf("px")))},isNullString:function(q){return"string"==typeof q&&"null"==q?!0:!1},
stopPropagation:function(q){q&&q.stopPropagation?q.stopPropagation():window.event.cancelBubble=!0},preventDefault:function(q){q&&q.preventDefault?q.preventDefault():window.event.returnValue=!1;return!1}}}();
function StringUtil(){this.toJsonEscapeString=function(p){p&&(p=p.replace(/"/g,'\\"'),p=p.replace(/\r/g,"\\r"),p=p.replace(/\n/g,"\\n"),p=p.replace(/\t/g,"\\t"));return p};this.fromJsonEscapeString=function(p){p&&(p=p.replace(/\\"/g,'"'),p=p.replace(/\\r/g,"\r"),p=p.replace(/\\n/g,"\n"),p=p.replace(/\\t/g,"\t"));return p}}
function KRListenerProxy(){var p={};this.addListener=function(q,C){var M=p[q];M||(M=[],p[q]=M);for(q=0;q<M.length;q++)if(M[q]==C)return;M.push(C)};this.removeListener=function(q,C){if(q=p[q])for(var M=q.length-1;0<=M;M--)if(q[M]==C){q.splice(M,1);break}};this.fireEvent=function(q){var C=q.type||q.getType();if(C=p[C])for(var M=C.length-1;0<=M;M--)C[M](q)}}KRListenerProxy.Event=function(p){this.getType=function(){return p}};
var KReportToast=function(){var p,q,C;return{toast:function(M){p||(p=$("<div class='my-toast' style=\"top: 2px; z-index: 9999;margin-left: 30%;font-family: 'Microsoft YaHei'; position: absolute;width: 40%;background-color: #fff5cb; border: 1px solid #f7e492;color: #e37b00; font-size: 12px; font-weight: bold; padding:0px 10px;\"><div class='my-toast-text'  style=\"word-break: break-all;text-align: center\"></div></div>"),q=p.find(".my-toast-text"));p.hide();p.remove();clearTimeout(C);var P=M.delay||
6E3;q.html(M.text||"empty info...");M=$("body");p.appendTo(M).show();C=setTimeout(function(){clearTimeout(C);p.hide();p.remove()},P);return p}}}();function ValueTextModel(){var p,q;this.setValue=function(C){p=C};this.getValue=function(){return p};this.setText=function(C){q=C};this.getText=function(){return q};this.toJsonObject=function(){var C={};C.value=this.getValue();C.text=this.getText();return C};this.fromJsonObject=function(C){var M=C.value;M=(new StringUtil).fromJsonEscapeString(M);this.setValue("null"==M?null:M);C=C.text;C=(new StringUtil).fromJsonEscapeString(C);this.setText("null"==C?null:C)};this.toJsonString=function(){var C='{"value":',
M=this.getValue();M||""===M?(M=JSON.stringify(M),C+=M):C+="null";C+=',"text":';(M=this.getText())||""===M?(M=JSON.stringify(M),C+=M):C+="null";return C+"}"}}
function ParamValue(){var p,q,C=[];this.setParamName=function(P){p=P};this.getParamName=function(){return p};this.setDataType=function(P){q=P};this.getDataType=function(){return q};this.clearValues=function(){C=[]};this.addValue=function(P){if(!(P instanceof ValueTextModel||P instanceof ValueTextTreeNodeModel))throw Error("Illegal argument.");C.push(P)};this.getValuesCount=function(){return C.length};this.getValue=function(P){return C[P]};this.getValues=function(){for(var P=[],da=0;da<this.getValuesCount();da++)P.push(this.getValue(da));
return P};this.toJsonObject=function(){var P={};P.paramName=this.getParamName();P.dataType=this.getDataType();for(var da=[],U=0;U<this.getValuesCount();U++){var ka=this.getValue(U);da.push(ka.toJsonObject())}P.values=da;return P};this.fromJsonObject=function(P){this.setParamName(P.paramName);this.setDataType(P.dataType);this.clearValues();P=P.values;for(var da=0;da<P.length;da++){var U=P[da],ka=new ValueTextModel;ka.fromJsonObject(U);this.addValue(ka)}};var M=/\d{4}(-|\/)(0[1-9]|1[0-2])(-|\/)(0[1-9]|[12][0-9]|3[01])\s([01]\d|2[0-3])(:[0-5][0-9]){2}/g;
this.toJsonString=function(P){var da='{"paramName":"'+this.getParamName()+'",';da+='"dataType":"'+q+'",';da+='"paramVars":[';P||(P=/;/g);for(var U=0;U<this.getValuesCount();U++){0<U&&(da+=",");var ka=this.getValue(U),I=ka.getValue();P.lastIndex=0;if(I&&P.test(I)){var J=[];if(-1<P.toString().indexOf("s"))if(J=I.match(M),null!=J)for(var Z=0;Z<J.length;Z++)I=I.replace(J[Z]," ");else J=[];I=I.trim();P.lastIndex=0;I&&P.test(I)&&(J=J.concat(I.split(P)));for(I=0;I<J.length;I++)(Z=J[I])&&""!==Z.trim()&&(ka.setValue(Z),
ka.setText(Z),da+=ka.toJsonString(),da+=",");da=da.substring(0,da.length-1)}else da+=ka.toJsonString()}return da+"]}"}}
function ValueTextTreeNodeModel(){var p,q,C,M,P,da,U,ka;this.setEntry=function(I){U=I};this.getEntry=function(){return U};this.setEntryHeadMap=function(I){ka=I};this.getEntryHeadMap=function(){return ka};this.setLevel=function(I){da=I};this.getLevel=function(){return da};this.setValue=function(I){p=I};this.getValue=function(){return p};this.setText=function(I){q=I};this.getText=function(){return q};this.setId=function(I){C=I};this.getId=function(){return C};this.setParentId=function(I){M=I};this.getParentId=
function(){return M};this.setChildren=function(I){P=I};this.getChildren=function(){return P};this.addChild=function(I){if(!(I instanceof ValueTextTreeNodeModel))throw Error("Illegal argument. Argument should be instanceof ValueTextTreeNodeModel");null==P&&(P=[]);P.push(I)};this.addChildren=function(I){if(!(I instanceof Array))throw Error("Illegal argument.");null==P&&(P=[]);P.concat(I)};this.toJsonObject=function(){var I={};I.value=this.getValue();I.text=this.getText();I.id=this.getId();I.parentId=
this.getParentId();I.children=this.getChildren();return I};this.fromJsonObject=function(I){var J=I.value;J=(new StringUtil).fromJsonEscapeString(J);this.setValue("null"==J?null:J);J=I.text;J=(new StringUtil).fromJsonEscapeString(J);this.setText("null"==J?null:J);J=I.id;J=(new StringUtil).fromJsonEscapeString(J);this.setId("null"==J?null:J);J=I.parentId;J=(new StringUtil).fromJsonEscapeString(J);this.setparentId("null"==J?null:J);I=I.children;this.setChildren("null"==I?null:I)};this.toJsonString=function(){var I=
'{"value":',J=this.getValue();J||""===J?(J=(new StringUtil).toJsonEscapeString(J),I+='"'+J+'"'):I+="null";I+=',"text":';(J=this.getText())||""===J?(J=(new StringUtil).toJsonEscapeString(J),I+='"'+J+'"'):I+="null";return I+"}"}}
function ValueTextTreeModel(){var p;this.getRootArray=function(){return p};this.buildTree=function(q){if(!(q instanceof Array))throw Error("Illegal argument.");p=[];if(q&&0!=q.length){if(!(q[0]instanceof ValueTextTreeNodeModel))throw Error("Illegal argument. Elements in Array should be instance of ValueTextTreeNodeModel.");for(var C=q.length,M={},P,da,U=0;U<C;U++)P=q[U],da=P.getId(),da||(da="treeAutoId_"+U,P.setId(da)),M[da]=P;for(U=0;U<C;U++)P=q[U],da=null,P.getParentId()&&(da=M[P.getParentId()]),
da?da.addChild(P):p.push(P)}};this.clear=function(){p=[]}};function ReportParamDescription(){var p,q,C,M,P,da,U,ka,I,J,Z,oa,ta,ja,va,Fa,wa;this.setMaxRestrictNumber=function(fa){va="null"==fa?"":fa};this.getMaxRestrictNumber=function(){return va};this.setName=function(fa){p="null"==fa?"":fa};this.getName=function(){return p};this.setText=function(fa){q="null"==fa?"":fa};this.getText=function(){return q};this.getCaption=function(){return q?q:p};this.setRequired=function(fa){C=fa};this.isRequired=function(){return C};this.setDataType=function(fa){M=fa};this.getDataType=
function(){return M};this.setCtrlType=function(fa){P=fa};this.getCtrlType=function(){return P};this.setState=function(fa){da=fa};this.getState=function(){return da};this.setReadOnly=function(fa){U=fa};this.isReadOnly=function(){return U};this.setMultiSelectable=function(fa){ka=fa};this.isMultiSelectable=function(){return ka};this.setIsTree=function(fa){I=fa};this.isTree=function(){return I};this.setTreeExpandLevel=function(fa){J=fa};this.getTreeExpandLevel=function(){return J};this.setSuppliedValue=
function(fa){Z="null"==Z?"":fa};this.getSuppliedValue=function(){return Z};this.setDefaultValue=function(fa){"null"!=fa&&(oa=fa)};this.getDefaultValue=function(){return oa};this.setSuppliedValueDescription=function(fa){ja=fa};this.getSuppliedValueDescription=function(){return ja};this.setEditable=function(fa){ta=fa};this.isEditable=function(){return ta};this.setPattern=function(fa){Fa=fa};this.getPattern=function(){return Fa};this.setDescription=function(fa){wa=fa};this.getDescription=function(){return wa}}
ReportParamDescription.Y_M_D_PATTERN="yyyy-MM-dd";ReportParamDescription.Y_PATTERN="yyyy";ReportParamDescription.Y_M_PATTERN="yyyy-MM";ReportParamDescription.Y_Q_PATTERN="yyyy-'Q'q";
function KEXTParamsAssociateModel(){var p={},q={};this.addOneAffectAnother=function(M,P){var da=p[M];da||(da={},p[M]=da);da[P]=!0;da=q[P];da||(da={},q[P]=da);da[M]=!0};this.isOneAffectOthers=function(M){return p[M]?!0:!1};this.isOneAffectAnother=function(M,P){return C(p,M,P)};this.isOneAffectedByAnother=function(M,P){return C(q,M,P)};var C=function(M,P,da){return(M=M[P])?M[da]?!0:!1:!1}}
function SwitchButtonSuppliedValue(){var p,q;this.setChecked=function(C){if(!(C instanceof ValueTextModel))throw Error("Illegal argument.");p=C};this.getChecked=function(){return p};this.setUnchecked=function(C){if(!(C instanceof ValueTextModel))throw Error("Illegal argument.");q=C};this.getUnchecked=function(){return q}}
function NumberStepperSuppliedValue(){var p,q,C;this.setMin=function(M){p=M};this.getMin=function(){return p};this.setMax=function(M){q=M};this.getMax=function(){return q};this.setStep=function(M){C=M};this.getStep=function(){return C}}
function ListDelaySuppliedValueDescription(){var p,q,C,M,P;this.setValueField=function(da){p=da};this.getValueField=function(){return p};this.setTextField=function(da){q=da};this.getTextField=function(){return q};this.setDatasetPersistenceModel=function(da){C=da};this.getDatasetPersistenceModel=function(){return C};this.setDataSourceType=function(da){M=da};this.getDataSourceType=function(){return M};this.setReportId=function(da){P=da};this.getReportId=function(){return P}};function ReportFilter(p,q,C,M){var P=[],da=new FilterContext(this,q,p),U=null,ka=new KEXTParamsAssociateModel,I,J,Z,oa,ta,ja=!1,va=com.kingdee.bos.qing.framework.common.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.filter),Fa=function(H){var L=new ReportParamDescription;L.setName(H.name);L.setText(H.text);L.setDataType(H.dataType);L.setState(H.state);L.setReadOnly("ReadOnly"==H.state);L.setCtrlType(H.ctrlType);L.setRequired(1==H.required);L.setMultiSelectable(1==H.multiSelectable);
L.setIsTree(H.isTree);L.setTreeExpandLevel(H.treeExpandLevel);L.setMaxRestrictNumber(H.maxRestrictNumber);L.setEditable(1==H.editable);L.setPattern(H.pattern);L.setDescription(H.description);var A=fa(H.suppliedValue);L.setSuppliedValue(A);A=ea(H.defaultValue,L.getDataType());L.setDefaultValue(A);var B=H.suppliedValueDescription;if(B){H=B.reportId;A=B.dataSourceType;var b=B.persistenceModel,m=B.valueFieldName;B=B.textFieldName;if(b&&m&&B){var l=new ListDelaySuppliedValueDescription;l.setDatasetPersistenceModel(b);
l.setValueField(m);l.setTextField(B);l.setDataSourceType(A);l.setReportId(H);H=l}else H=null}else H=null;L.setSuppliedValueDescription(H);return L},wa=function(H){for(var L=[],A=0;A<H.length;A++){var B=H[A],b=new ValueTextModel;b.setText("");b.setValue("");B.text&&!KReportUtil.isNullString(B.text)&&b.setText(B.text);B.value&&!KReportUtil.isNullString(B.value)&&b.setValue(B.value);L.push(b)}return L},fa=function(H){if(!H)return null;var L=H.min,A=H.max,B=H.step;if(B)return H=new NumberStepperSuppliedValue,
H.setMin(L),H.setMax(A),H.setStep(B),H;B=H.checked;L=H.unChecked;return B&&L?(A=new ValueTextModel,A.setValue(B.value),A.setText(B.text),B=new ValueTextModel,B.setValue(L.value),B.setText(L.text),H=new SwitchButtonSuppliedValue,H.setChecked(A),H.setUnchecked(B),H):H&&!KReportUtil.isNullString(H)?wa(H):null},ea=function(H,L){if(null==H||KReportUtil.isNullString(H))return null;if(H instanceof Array)return wa(H);var A=H.selectedValue,B=H.valueField,b=H.textField;if(A&&B&&b){L=[];for(H=0;H<A.length;H++){for(var m=
A[H].columnDatas,l=new ValueTextModel,y=0;y<m.length;y++){var v=m[y];B==v.value&&l.setValue(v.text);b==v.value&&l.setText(v.text)}L.push(l)}return L}A=H.value;B=H.text;if(void 0!=A&&void 0!=B)return L=new ValueTextModel,KReportUtil.isNullString(A)&&(A=B=""),L.setValue(A),L.setText(B),[L];if(A=H.value)return b=new Date,b.setTime(A),H=b.getFullYear(),m=b.getMonth()+1,l=b.getDate(),A=b.getHours(),B=b.getMinutes(),b=b.getSeconds(),H=H+"-"+m+"-"+l,A=A+":"+B+":"+b,L="Date"==L?H:"Time"==L?A:H+" "+A,A=new ValueTextModel,
A.setValue(L),A.setText(L),[A];A=H instanceof Object?null:H.toString();L=new ValueTextModel;L.setValue(A);L.setText(A);return[L]},xa=function(H,L){J&&(J.children().detach(),J.append(L?L:Z),J.trigger("pagecreate"))};this.forRpcReduced=function(H,L,A){I=[];U={};H={};if(C)for(var B=0;B<C.length;B++){var b=C[B],m=new ParamValue;m.fromJsonObject(b);H[m.getParamName()]=m.getValues()}for(B=0;B<L.length;B++){var l=L[B];b=Fa(l);"Hidden"!=b.getState()&&(ta=!0);I.push(b.getName());m=(new FilterCtrlFactory).create(b,
da,M);U[b.getName()]=m;m.setSuppliedValue(b.getSuppliedValue());m.setSuppliedValueDescription(b.getSuppliedValueDescription());"numberstepper"==(b.getCtrlType()?b.getCtrlType().toLowerCase():null)&&m.setDefaultValue(l.defaultValue);l=H[b.getName()];m instanceof com.kingdee.bos.extreport.runtime.filter.FilterLabel||(l?m.setSelectedValue(l):m.setSelectedValue(b.getDefaultValue()),m.setSelectedValueChangedListener(ia))}if(A)for(var y in A)for(L=A[y],B=0;B<L.length;B++)ka.addOneAffectAnother(y,L[B]);
A=[];P=[];for(var v in U){L=U[v].getParamDescription();y=new ParamValue;y.setParamName(v);y.setDataType(L.getDataType());if(L=L.getDefaultValue())for(H=0;H<L.length;H++)y.addValue(L[H]);A.push(y.toJsonObject());P.push(y)}return A};this.isDispalay=function(){return ta};this.render=function(H,L){J=$(H);J.attr("data-role","page");L=J;H=$("<div>");H.appendTo(L);H.css("position","relative");L=$("<div>");L.attr("data-role","listview");L.appendTo(H);L.css({fontSize:"13px"});for(var A in U){var B=U[A],b=
B instanceof com.kingdee.bos.extreport.runtime.filter.FilterCheckBoxGroup?$("<div>").css({position:"relative",display:"inline-block",width:"100%","min-height":"24px"}):B instanceof com.kingdee.bos.extreport.runtime.filter.FilterLabel?$("<div>").css({position:"relative",display:"inline-block",width:"100%"}):$("<div>").css({position:"relative",display:"inline-block",margin:"8px 70px 8px 0"});b.attr("data-role","fieldcontain");b.appendTo(L);B.createUI(b)}Z=H;A=$(window).height()-270;160>=A&&(A=160);
J.css({padding:"0px 10px 0px 10px",maxHeight:A,overflowY:"auto",position:"relative"});xa()};this.execute=function(H,L){var A=!1,B="[";P=[];var b={};for(Q in U){var m=U[Q];if(!(m instanceof com.kingdee.bos.extreport.runtime.filter.FilterLabel)){var l=new ParamValue;l.setParamName(Q);l.setDataType(m.getParamDescription().getDataType());var y=m.getSelectedValue();!A&&m.getParamDescription().isRequired()&&(A=!y||0==y.length);if(y){m.getParamDescription().isRequired()&&(A=!0);for(var v=0;v<y.length;v++){var S=
y[v];l.addValue(S);m.getParamDescription().isRequired()&&S.getValue()&&(A=!1)}}if(A)return{success:!1,errMsg:m.getParamDescription().getText()+va.get("paramValEmptyError"," \u53c2\u6570\u503c\u4e0d\u80fd\u4e3a\u7a7a\u3002")};1<B.length&&(B+=",",B+="\r\n");B="TextField"==m.getParamDescription().getCtrlType()?B+l.toJsonString(/,|;|\uff0c|\uff1b|\s+/g):B+l.toJsonString();P.push(l)}}var Q={};Q.pageId=p;Q.schemeName=H;Q.isDefaultChange=L;Q.flag="1";Q.paramValues=B+"]";return A?{success:!1,errMsg:va.get("incompleteParamError",
"\u53c2\u6570\u503c\u4e0d\u5b8c\u6574\u3002")}:{success:!0,data:Q,selectAll:JSON.stringify(b)}};this.getCtrl=function(H){return U[H]};this.updateParamByName=function(H,L){H=U[H];for(var A=L.length,B=[],b=0;b<A;b++){var m=L[b],l=new ValueTextModel;l.setValue(m);l.setText(m);B.push(l)}H.setSelectedValue(B)};this.getDataSetParamValues=function(){var H=!1,L="[";P=[];for(var A in U){var B=U[A];if(!(B instanceof com.kingdee.bos.extreport.runtime.filter.FilterLabel)){var b=new ParamValue;b.setParamName(A);
b.setDataType(B.getParamDescription().getDataType());var m=B.getSelectedValue();!H&&B.getParamDescription().isRequired()&&(H=!m||0==m.length);if(m){B.getParamDescription().isRequired()&&(H=!0);for(var l=0;l<m.length;l++){var y=m[l];b.addValue(y);B.getParamDescription().isRequired()&&y.getValue()&&(H=!1)}}if(H)return{success:!1,errMsg:B.getParamDescription().getText()+va.get("paramValEmptyError"," \u53c2\u6570\u503c\u4e0d\u80fd\u4e3a\u7a7a\u3002")};1<L.length&&(L+=",",L+="\r\n");L="TextField"==B.getParamDescription().getCtrlType()?
L+b.toJsonString(/,|;|\uff0c|\uff1b|\s+/g):L+b.toJsonString();P.push(b)}}A={};A.paramValues=L+"]";return H?{success:!1,errMsg:va.get("incompleteParamError","\u53c2\u6570\u503c\u4e0d\u5b8c\u6574\u3002")}:{success:!0,data:A}};this.setSchemeParams=function(H,L,A){for(var B in U){for(var b="",m="",l=U[B].getSelectedValue(),y=0;y<l.length;y++){var v=l[y];b+=v.getValue();m+=v.getText();y!=l.length-1&&(b+="0xx1xx",m+="0xx1xx")}H.push([b]);L.push([m]);A.push([B])}};this.updateFilterByScheme=function(H,L){for(var A=
function(W,E,F){return function(){W.setSelectedValue(E);ra(W,F,L)}},B=function(){for(var W=0,E={};;){var F=H.match(new RegExp("N"+W+"=(.*?)\u0001"));if(!F||!F[1])break;F=F[1];var e=H.match(new RegExp("V"+W+"=(.*?)\u0001"))[1],k=H.match(new RegExp("C"+W+"=(.*?)\u0001"))[1];E[F]=[e,k];W++}for(var n in U){if(!E[n])break;var t=E[n][0];k=E[n][1];W=U[n];F=W.getParamDescription().getCtrlType();e="";F&&(e=F.toLowerCase());F=[];if("combobox"==e||"f7"==e||"checkboxgroup"==e){t=t.split("0xx1xx");k=k.split("0xx1xx");
for(var f=0,c=t.length;f<c;f++)e=new ValueTextModel,e.setText(k[f]),e.setValue(t[f]),F.push(e)}else"datetime"==e?t&&(e=new ValueTextModel,e.setText(k),e.setValue(t),F.push(e)):("textfield"==e&&(k=k.replaceAll("0xx1xx",";"),t=t.replaceAll("0xx1xx",";")),e=new ValueTextModel,e.setText(k),e.setValue(t),F.push(e));W.setSelectedValue(F)}xa()},b=0,m={};;){var l=H.match(new RegExp("N"+b+"=(.*?)\u0001"));if(!l||!l[1])break;l=l[1];var y=H.match(new RegExp("V"+b+"=(.*?)\u0001"))[1],v=H.match(new RegExp("C"+
b+"=(.*?)\u0001"))[1];m[l]=[y,v];b++}for(var S in U){if(!m[S])break;var Q=m[S][0];l=m[S][1];y=U[S];v=y.getParamDescription().getCtrlType();var X="";v&&(X=v.toLowerCase());v=[];if("combobox"==X||"f7"==X||"checkboxgroup"==X){Q=Q.split("0xx1xx");var T=l.split("0xx1xx");l="";X=0;for(var N=T.length;X<N;X++)l+=T[X]+";";l=l.substring(0,l.length-1);X=0;for(N=Q.length;X<N;X++)T=new ValueTextModel,T.setText(l),T.setValue(Q[X]),v.push(T)}else"datetime"==X?Q&&(T=new ValueTextModel,T.setText(l),T.setValue(Q),
v.push(T)):("textfield"==X&&(l=l.replaceAll("0xx1xx",";"),Q=Q.replaceAll("0xx1xx",";")),T=new ValueTextModel,T.setText(l),T.setValue(Q),v.push(T));B=A(y,v,B);b++}B()};this.getCurrentValueCaption=function(){for(var H="",L=0;L<P.length;L++){var A=P[L],B=A.getParamName();B=U[B].getParamDescription().getCaption();0<L&&(H+="    ");H+=B;H+=":";B=A.getValuesCount();if(0==B)H+="(\u65e0)";else for(var b=0;b<B;b++){0<b&&(H+=";");var m=A.getValue(b);H+=m.getText()}}return H};this.close=function(){};this.isEditable=
function(H){return U[H].getParamDescription().isEditable()};this.getSuppliedValue=function(H){return U[H].getParamDescription().getSuppliedValue()};this.getAssociatedFiltersJsonValue=function(H){var L="[",A;for(A in U)if(A!=H&&ka.isOneAffectedByAnother(H,A)){1<L.length&&(L+=",");var B=U[A];L+='{"paramName":"';L+=A;L+='","paramValues":[';if(B=B.getSelectedValue())for(var b=0;b<B.length;b++){0<b&&(L+=",");var m=B[b].getValue();a:{if("string"===typeof m)try{JSON.parse(m);var l=!0;break a}catch(y){l=
!1;break a}l=!1}m?l?L+=m:(L+='"',L+=m,L+='"'):L+="null"}L+="]}"}return L+"]"};this.setSchemeList=function(H){oa=H};this.getSchemeList=function(){return oa};var ia=function(H){ja?ja=!1:ra(H)},ra=function(H,L,A){var B=H.getParamDescription().getName();if(ka&&ka.isOneAffectOthers(B)){if(L){var b={};var m=function(y){ja=b[y]=!0;for(var v in b)if(!b[v]){ja=!1;break}ja&&(L(),A&&A())}}for(var l=0;l<I.length;l++)H=I[l],ka.isOneAffectAnother(B,H)&&(H=U[H],L?(b[l]=!1,H.resetSuppliedValue(m,l)):H.resetSuppliedValue())}else L&&
L()};this.setArrParamsName=function(H){I=H};this.pushArrParamsName=function(H){I.push(H)};this.setMapCtrls=function(H){U=H};this.getMapCtrls=function(){return U};this.pushMapCtrls=function(H,L){U[H]=L};this.setDisplay=function(H){ta=H};this.addOneAffectAnother=function(H,L){ka.addOneAffectAnother(H,L)};this.protectedMethod={decodeParamDesc:Fa,ctrlSelectedValueChanged:ia,updateUI:xa}}
function FilterContext(p,q,C){var M=this;this.objReportFilter=p;this.reportDiv=q.reportDiv;this.oGlobal=q.oGlobal;this.strReportId=C;this.constructParam=function(P,da){var U=da.getDatasetPersistenceModel(),ka=da.getValueField(),I=da.getTextField(),J=da.getDataSourceType();da=da.getReportId();U=(new StringUtil).toJsonEscapeString(U);var Z=this.objReportFilter.getAssociatedFiltersJsonValue(P);return{datasetXml:U,paramValues:Z,textName:I,valueName:ka,dataSourceType:J,reportId:da,paramName:P,pageId:this.strReportId}};
this.delaySuppliedValueRemoteGetter=function(P,da,U){this.oGlobal.createFacade(function(ka){U(ka)},function(ka,I){if(8099002===ka||8099007===ka||8099008===ka||8077016===ka||8099101===ka||8099010<=ka&&8099014>=ka){ka=com.kingdee.bos.qing.ui.component.MessageDialog;var J=new ka;J.setOptionType(ka.OPTION_OK);J.setMessage(I);J.showDialog();return!0}return!1}).getDelaySuppliedValue(M.constructParam(P,da))}}
function FilterCtrlFactory(){this.create=function(p,q,C){var M=com.kingdee.bos.extreport.runtime.filter;if(!(p instanceof ReportParamDescription))throw Error("Illegal argument.");var P=p.getCtrlType()?p.getCtrlType().toLowerCase():null;if(C)switch(P){case "checkbox":return new M.FilterSwitch(p,q);case "combobox":return new M.FilterComboBoxMobile(p,q);case "f7":return new M.FilterForwardSelectorMobile(p,q);case "numberstepper":return new M.FilterNumberInputMobile(p,q);case "checkboxgroup":return new M.FilterCheckBoxGroup(p,
q);case "datetime":if("Date"==p.getDataType())return q=new M.DateTimeSliderSelector(p,q),C=p.getPattern(),ReportParamDescription.Y_M_PATTERN===C?q.setSelectorType(M.DateTimeSliderSelector.DATE_YM):ReportParamDescription.Y_Q_PATTERN===C?q.setSelectorType(M.DateTimeSliderSelector.DATE_YQ):ReportParamDescription.Y_PATTERN===C?q.setSelectorType(M.DateTimeSliderSelector.DATE_Y):q.setSelectorType(M.DateTimeSliderSelector.DATE),q;if("DateTime"==p.getDataType())return q=new M.DateTimeSliderSelector(p,q),
q.setSelectorType(M.DateTimeSliderSelector.DATE_TIME),q;if("Time"==p.getDataType())return q=new M.DateTimeSliderSelector(p,q),q.setSelectorType(M.DateTimeSliderSelector.TIME),q;throw Error("Illegal datetime!");case "label":return new M.FilterLabel(p,q);default:return new M.FilterTextField(p,q)}else switch(P){case "checkbox":return new M.FilterSwitch(p,q);case "combobox":return new M.FilterComboBoxSearch(p,q);case "f7":return new M.FilterForwardSelector(p,q);case "numberstepper":return new M.FilterNumberInput(p,
q);case "checkboxgroup":return new M.FilterCheckBoxGroup(p,q);case "datetime":if("Date"==p.getDataType())return C=p.getPattern(),ReportParamDescription.Y_M_PATTERN===C||ReportParamDescription.Y_Q_PATTERN===C||ReportParamDescription.Y_PATTERN===C?new M.FilterSimilarDate(p,q):new M.FilterDate(p,q);if("DateTime"==p.getDataType())return new M.FilterDateAndTime(p,q);if("Time"==p.getDataType())return new M.FilterTime(p,q);throw Error("Illegal datetime!");case "label":return new M.FilterLabel(p,q);default:return new M.FilterTextField(p,
q)}}}ReportFilter.CONSTANTS={getDelaySuppliedValue:"getDelaySuppliedValue"};(function(){function p(f){C.call(this,f);var c=this.protectedMethod,d=new v;this.protectedCreateItemUi=function(u,w,a,g){var R=w.getValue();u=c.isSelected(R);a=new y;a.setText(w.getText());a.setChecked(u);a.addCheckedListener(function(D,h){h&&c.selectOnlyOne(R)});d.addElement(a);return a.getJqUi()}}function q(f){C.call(this,f);var c=this,d=this.protectedMethod,u=!0,w,a,g;this.protectedInitBar=function(h,G,O){g=new S;g.setText(e.get("includeSubs","\u9009\u62e9\u65f6\u5305\u542b\u4e0b\u7ea7\u8282\u70b9"));
g.setChecked(u);g.addCheckedListener(D);var aa=g.getJqUi(),Aa="en"==W.getUrlParamValue("language")?163:130;E.layoutCtrlWithLRTB(aa,null,0,Aa,30,null,21);aa.appendTo(h);w=new S;w.setText(e.get("selectAll","\u5168\u9009"));w.setChecked(G);w.addCheckedListener(function(la,Ba){if(Ba){la=la.isChecked();for(Ba=0;Ba<O.getRowsCount();Ba++){var ma=O.getRow(Ba);if(!ma.isHide()||g.isEnabled()&&g.isChecked())ma=ma.getCell(0).getValue(),d.select(ma.getValue(),la)}c.resetScrollStatus(O);O.updateUI(!0);R()}});aa=
w.getJqUi();G="en"==W.getUrlParamValue("language")?26:0;E.layoutCtrlWithLRTB(aa,0,null,50+G,30,null,21);aa.appendTo(h);a=new B;R();aa=a.getJqUi();E.layoutCtrlWithLRTB(aa,60+G,null,110,30,null,21);aa.find(".sa-ctrl-label-text").css({overflow:"visible"});aa.appendTo(h)};this.protectedGetBarHeight=function(){return 58};this.protectedAfterUpdateTree=function(h,G){w.setChecked(h);g.setEnabled(!G)};this.protectedIsIncludeSubs=function(){return u};this.protectedCreateItemUi=function(h,G,O,aa){var Aa=G.getValue();
Aa=d.isSelected(Aa);var la=new S;la.setUserObject(O);la.setText(G.getText());la.setChecked(Aa);la.addCheckedListener(function(Ba,ma){if(ma){ma=Ba.getUserObject();Ba=Ba.isChecked();var za=h.getRow(ma).getCell(0),Ca=za.getValue();d.select(Ca.getValue(),Ba);if(u&&!aa()){Ca=za.getTreeModel();var sa=Ca.getLevel();for(ma+=1;ma<h.getRowsCount();ma++){za=h.getRow(ma).getCell(0);Ca=za.getTreeModel();if(Ca.getLevel()<=sa)break;Ca=za.getValue();d.select(Ca.getValue(),Ba)}}h.updateUI(!0);ma=!0;Ba=!1;for(za=0;za<
h.getRowsCount();za++)if(sa=h.getRow(za),!sa.isHide()&&(Ba=!0,sa=sa.getCell(0).getValue(),!d.isSelected(sa.getValue()))){ma=!1;break}w.setChecked(Ba&&ma);R()}});return la.getJqUi()};var R=function(){var h=0;for(var G=c.getSelectableItems(),O=0;O<G.length;O++)d.isSelected(G[O].getValue())&&h++;h=e.get("selectedCount","(\u5df2\u9009\u62e9#1\u9879)").replace("#1",h);a.setText(h)},D=function(h,G){G&&(u=h.isChecked())}}function C(f){function c(na){KTDefaultTreeHandlerRender.call(this,na);var ha=this.create;
this.create=function(pa,ya,Y,ua,Ea,Ma,La){return za()?[]:ha(pa,ya,Y,ua,Ea,Ma,La)}}function d(na){KTDefaultCellRender.call(this,na);var ha=this;this.paintCellUI=function(pa,ya){var Y=ha.getCell().getValue(),ua=ha.getCurrentRowIdx();Y=w.protectedCreateItemUi(na,Y,ua,za);Y.css("overflow","visible");Y.children().css("overflow","visible");pa=$(pa);pa.css("overflow","visible");ya?(ya=$(ya),ya.css("overflow","visible"),Y.appendTo(ya),E.layoutCtrlWithLRTB(Y,4,0,null,0,null,"100%")):(Y.appendTo(pa),E.layoutCtrlWithLRTB(Y,
0,0,null,0,null,"100%"))}}var u=23,w=this,a,g,R,D=!1,h=[],G=[],O,aa=!1;this.getJqUi=function(){if(!a){a=$("<div>");for(var na={},ha=0,pa=G.length;ha<pa;ha++)G[ha].getValue()&&(na[G[ha].getValue()]=!0);g=na;D=!1;na=new KTable;na.setCellRender(new d(na));na.setTreeHandlerRender(new c(na));na.setSyncUIWhenModelChanged(!1);h&&1024<=h.length?na.setLargeDataMode(!0,!1):na.setLargeDataMode(!1);na.addColumn().setWidth(320);ha=new KTStyle;ha.setVerticalAlign("middle");na.setStyle(ha);var ya=h;if(0==ya.length)ha=
!1;else{ha=!0;var Y=sa(),ua=!Y;for(pa=0;pa<ya.length;pa++){var Ea=ya[pa],Ma=Ca(Ea.getValue()),La=na.addRow();La.setHeight(u);var Ja=La.getCell(0);Ja.setValue(Ea);Ea=Ea.getLevel();Ea=new KTCellTreeModel(Ea);ua&&la(La,Ea);Ja.setTreeModel(Ea);ha=ha&&Ma}if(Y){var Ga;ya={};for(pa=na.getRowsCount()-1;0<=pa;pa--){La=na.getRow(pa);Ja=La.getCell(0);Y=Ja.getTreeModel();ua=Y.getLevel();Ea=Ja.getValue();if(Ca(Ea.getValue())){La.setHide(!1);var Ka=Ea.getParentId();(Ja=ya[ua])&&0!=Ja.length||(Ja=[]);Ja.push(Ea);
ya[ua]=Ja}if(Ga&&Ga===ua+1)if((Ja=ya[Ga])&&0<Ja.length){Ma=!1;for(Ga=0;Ga<Ja.length;Ga++){var Qa=Ja[Ga];if(Ka===Ea.getId()||Qa&&Qa.getParentId()===Ea.getId()){Ma=!0;break}}if(Ma){var Ha=!0;Y.setExpanded(!0);La.setHide(!1);(Ja=ya[ua])&&0!=Ja.length||(Ja=[]);Ja.push(Ea);ya[ua]=Ja}else Y.setExpanded(!1)}else Y.setExpanded(!1);0===pa&&Ha&&(La.setHide(!1),Y.setExpanded(!0));Ga=ua}La=0;Ka=Object.values(ya);for(pa=0;pa<Ka.length;pa++)for(Ha=Ka[pa],Ga=0;Ga<Ha.length;Ga++)Ea=Ha[Ga],La=Ea.getLevel()>La?Ea.getLevel():
La;for(pa=na.getRowsCount()-1;0<=pa;pa--)if(La=na.getRow(pa),Ja=La.getCell(0),Y=Ja.getTreeModel(),Ea=Ja.getValue(),Ka=Y.getLevel(),(Ha=ya[Ka])&&0<Ha.length){Ja=!1;for(Ga=0;Ga<Ha.length;Ga++)if((ua=Ha[Ga])&&ua.getParentId()===Ea.getParentId()){Ja=!0;break}Ja?(La.setHide(!1),Ka<f-1&&Y.setExpanded(!0)):la(La,Y)}else la(La,Y)}}na.updateUI();pa=w.protectedGetBarHeight()+6;La=$(na.getUI());E.layoutCtrlWithLRTB(La,0,0,null,pa,0,null);a.append(La);na=[ha,na];Aa(na[0],na[1])}return a};this.setSelectableItems=
function(na){h=na};this.getSelectableItems=function(){return h};this.setSelected=function(na){G=na};this.getSelected=function(){var na=[];if(!g)return na;for(var ha=0,pa=h.length;ha<pa;ha++){var ya=h[ha].getValue();g[ya]&&na.push(h[ha])}return na};this.setItemHeight=function(na){u=na};this.protectedIsIncludeSubs=function(){return!1};this.resetScrollStatus=function(na){if(na&&na.isLargeDataMode()){var ha=na.keepScrollStatus();ha.v&&(ha.v=0);na.restoreScrollStatus(ha)}};this.setMobile=function(na){aa=
na};var Aa=function(na,ha){var pa=$("<div>");pa.css("border-bottom","1px solid #eee");var ya=w.protectedGetBarHeight();E.layoutCtrlWithLRTB(pa,0,0,null,0,null,ya);R=new ja(aa);R.setSearchingHandler(function(){var ua=Ba(ha);w.resetScrollStatus(ha);ha.updateUI(!0);ma(ua)});ya=R.getJqUi();E.layoutCtrlWithLRTB(ya,0,null,aa?"57%":"66%",0,null,23);ya.css({"min-width":"214px !important","max-width":"500px !important"});ya.appendTo(pa);ya=new S;ya.setText(e.get("showOnlySelected","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));
ya.setChecked(D);ya.addCheckedListener(function(ua,Ea){Ea&&(D=ua.isChecked(),ua=Ba(ha),w.resetScrollStatus(ha),ha.updateUI(!0),ma(ua))});ya=ya.getJqUi();if(aa){var Y="en"==W.getUrlParamValue("language")?128:94;E.layoutCtrlWithLRTB(ya,null,0,Y,0,null,21)}else Y="en"==W.getUrlParamValue("language")?140:106,E.layoutCtrlWithLRTB(ya,null,23,Y,0,null,21);ya.appendTo(pa);w.protectedInitBar(pa,na,ha);pa.appendTo(a)};this.protectedInitBar=function(na,ha,pa){};this.protectedGetBarHeight=function(){return 30};
var la=function(na,ha){ha.getLevel()<f-1?(ha.setExpanded(!0),na.setHide(!1)):ha.getLevel()===f-1?(ha.setExpanded(!1),na.setHide(!1)):(ha.setExpanded(!1),na.setHide(!0))},Ba=function(na){for(var ha=za(),pa=!0,ya=!1,Y=65535,ua=!1,Ea=0;Ea<na.getRowsCount();Ea++){var Ma=na.getRow(Ea),La=Ma.getCell(0),Ja=La.getTreeModel(),Ga=!0;Ja.getLevel()<=Y&&(Ga=!1);var Ka=La.getValue();La=Ca(Ka.getValue());Ka=D&&!La||R.isSearching()&&!R.check(Ka.getText());var Qa=Ga;Qa=ha?Ka:Qa;Ma.setHide(Qa);Qa||(ua=!0);Ka||(ya=
ya||La,pa=pa&&La);Ga||(Y=Ja.isExpanded()?65535:Ja.getLevel())}w.protectedAfterUpdateTree(ya?pa:!1,ha);return ua};this.protectedAfterUpdateTree=function(na,ha){};this.protectedCreateItemUi=function(na,ha,pa,ya){throw Error("Override");};var ma=function(na){na?(O&&O.remove(),O=null):O||(na=new B,na.setText(e.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c")),na.setEnabled(!1),O=na.getJqUi(),E.layoutCtrlWithLRTB(O,0,0,null,60,null,16),na.setAlign(B.ALIGN_CENTER),O.appendTo(a))},
za=function(){return D||R&&R.isSearching()},Ca=function(na){return 1==g[na]},sa=function(){if(g&&0<Object.keys(g).length){var na=h;if(0==na.length)return!1;for(var ha=0;ha<na.length;ha++)if(Ca(na[ha].getValue()))return!0}return!1};this.protectedMethod={isSelected:Ca,select:function(na,ha){ha?g[na]=!0:delete g[na]},selectOnlyOne:function(na){g={};g[na]=!0}}}function M(){U.call(this);var f=this.protectedMethod,c=[],d=[];this.setSelectableItems=function(u){c=u};this.setSelected=function(u){d=u};this.protectedGetSelectableItems=
function(){return c};this.protectedCloneSelectedValue=function(){var u={};if(d)for(var w=0,a=d.length;w<a;w++)u[d[w].getValue()]=!0;return u};this.getSelected=function(){var u=f.acceptSelectingResult(),w=[];if(!u)return w;for(var a=0,g=c.length;a<g;a++){var R=c[a].getValue();if(u[R]){w.push(c[a]);break}}return w}}function P(){da.call(this);var f=this.protectedMethod,c=[],d=[];this.setSelectableItems=function(u){c=u};this.setSelected=function(u){d=u};this.protectedGetSelectableItems=function(){return c};
this.protectedCloneSelectedValue=function(){var u={};if(d)for(var w=0,a=d.length;w<a;w++)u[d[w].getValue()]=!0;return u};this.getSelected=function(){var u=f.acceptSelectingResult(),w=[];if(!u)return w;for(var a=0,g=c.length;a<g;a++){var R=c[a].getValue();u[R]&&w.push(c[a])}return w}}function da(){ka.call(this);var f=this,c=this.protectedMethod,d,u;this.protectedInitBar=function(D){d=new S;d.setText(e.get("selectAll","\u5168\u9009"));d.addCheckedListener(R);var h=d.getJqUi();E.layoutCtrlWithLRTB(h,
0,null,80,30,null,21);h.appendTo(D);u=new B;h=u.getJqUi();E.layoutCtrlWithLRTB(h,80,0,null,30,null,21);h.find(".sa-ctrl-label-text").css({overflow:"visible"});h.appendTo(D);w();return 55};this.protectedItemCreator=function(D){var h=D.getValue();h=c.isSelected(h);var G=D.getText(),O=new S;O.addCheckedListener(g);O.setUserObject(D);O.setText(G);O.setChecked(h);f.protectedIsExcludeMode()&&O.setCustomStyle("text-decoration","line-through");D=O.getJqUi();E.layoutCtrlWithLRTB(D,0,0,null);return D};this.protectedIsExcludeMode=
function(){return!1};this.protectedAfterUpdateDynamicScroller=function(){a()};var w=function(){var D=0;for(var h=f.protectedGetSelectableItems(),G=0;G<h.length;G++)c.isSelected(h[G].getValue())&&D++;D=e.get("selectedCount","(\u5df2\u9009\u62e9#1\u9879)").replace("#1",D);u.setText(D)},a=function(){var D=!0,h=!1;c.visitAllVisibleSelectableItems(function(G){var O=!1;h=!0;c.isSelected(G.getValue())||(D=!1,O=!0);return O});d.setChecked(h&&D)},g=function(D,h){h&&(h=D.getUserObject(),D=D.isChecked(),c.select(h.getValue(),
D),a(),w())},R=function(D,h){if(h){var G=D.isChecked();c.visitAllVisibleSelectableItems(function(O){c.select(O.getValue(),G)});c.repaintWithScrollState();w()}}}function U(){ka.call(this);var f=this.protectedMethod;this.protectedItemCreator=function(d){var u=d.getValue();u=f.isSelected(u);var w=d.getText(),a=new y;a.addCheckedListener(c);a.setUserObject(d);a.setText(w);a.setChecked(u);d=a.getJqUi();E.layoutCtrlWithLRTB(d,0,0,null);return d};var c=function(d,u){u&&(d.isChecked()?(d=d.getUserObject(),
f.selectOnlyOne(d.getValue()),f.repaintWithScrollState()):d.setChecked(!0))}}function ka(){var f=21,c=this,d,u,w,a,g,R,D,h={},G=!1;this.getJqUi=function(){d||(d=$("<div>"),O(d));return d};this.protectedGetSelectableItems=function(){throw Error("Impl");};this.setMobile=function(Ca){G=Ca};var O=function(Ca){u=Ca;h=c.protectedCloneSelectedValue();R=!1;var sa=$("<div>");sa.appendTo(Ca);var na=aa(sa);E.layoutCtrlWithLRTB(sa,0,0,null,0,null,na);g=new m;g.setItemHeight(f);g.setItemUiCreator(function(ha){return c.protectedItemCreator(D[ha])});
g.getJqUi().appendTo(Ca);E.layoutCtrlWithLRTB(g.getJqUi(),0,0,null,na,0,null);Aa()};this.protectedCloneSelectedValue=function(){throw Error("Impl");};this.protectedItemCreator=function(Ca){throw Error("Impl");};var aa=function(Ca){a=new ja(G);a.setSearchingHandler(ma);var sa=a.getJqUi();E.layoutCtrlWithLRTB(sa,0,null,G?"57%":"66%",0,null,23);sa.css({"min-width":"214px !important","max-width":"500px !important"});sa.appendTo(Ca);sa=new S;sa.setText(e.get("showOnlySelected","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));
sa.setChecked(R);sa.addCheckedListener(za);sa=sa.getJqUi();var na="en"==W.getUrlParamValue("language")?140:106;G&&(na="en"==W.getUrlParamValue("language")?128:94);E.layoutCtrlWithLRTB(sa,null,0,na,0,null,21);sa.appendTo(Ca);return c.protectedInitBar(Ca)};this.protectedInitBar=function(Ca){return 28};var Aa=function(){var Ca=c.protectedGetSelectableItems();D=a.isSearching()||R?$.grep(Ca,function(sa){var na=a.check(sa.getText());sa=!R||Ba(sa.getValue());return na&&sa}):Ca;g.setItemCount(D.length);g.repaint();
c.protectedAfterUpdateDynamicScroller()};this.protectedAfterUpdateDynamicScroller=function(){};this.setItemHeight=function(Ca){f=Ca};var la=function(){if(0==D.length){if(!w){var Ca=new B;Ca.setText(e.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c"));Ca.setEnabled(!1);w=Ca.getJqUi();E.layoutCtrlWithLRTB(w,0,0,null,60,null,16);Ca.setAlign(B.ALIGN_CENTER);w.appendTo(u)}}else w&&w.remove(),w=null},Ba=function(Ca){return 1==h[Ca]},ma=function(){Aa();la()},za=function(Ca,sa){R=
Ca.isChecked();Aa();la()};this.protectedMethod={repaintWithScrollState:function(){g.keepState();g.repaint();g.restoreState()},visitAllVisibleSelectableItems:function(Ca){for(var sa=0;sa<D.length&&!Ca(D[sa]);sa++);},isSelected:Ba,select:function(Ca,sa){sa?h[Ca]=!0:delete h[Ca]},selectOnlyOne:function(Ca){h={};h[Ca]=!0},acceptSelectingResult:function(){return h}}}function I(){oa.call(this);var f=this.protectedMethod,c=[],d=[];this.setSelectableItems=function(u){c=u};this.setSelected=function(u){d=u};
this.protectedGetSelectableItems=function(){return c};this.protectedCloneSelectedValue=function(){var u={};if(d)for(var w=0,a=d.length;w<a;w++)u[d[w].getValue()]=!0;return u};this.getSelected=function(){var u=f.acceptSelectingResult(),w=[];if(!u)return w;for(var a=0,g=c.length;a<g;a++){var R=c[a].getValue();if(u[R]){w.push(c[a]);break}}return w}}function J(){Z.call(this);var f=this.protectedMethod,c=[],d=[];this.setSelectableItems=function(u){c=u};this.setSelected=function(u){d=u};this.protectedGetSelectableItems=
function(){return c};this.protectedCloneSelectedValue=function(){var u={};if(d)for(var w=0,a=d.length;w<a;w++)u[d[w].getValue()]=!0;return u};this.getSelected=function(){var u=f.acceptSelectingResult(),w=[];if(!u)return w;for(var a=0,g=c.length;a<g;a++){var R=c[a].getValue();u[R]&&w.push(c[a])}return w}}function Z(){ta.call(this);var f=this,c=this.protectedMethod,d,u=[],w;this.protectedInitBar=function(h){d=new S;d.setText(e.get("selectAll","\u5168\u9009"));d.addCheckedListener(D);var G=d.getJqUi();
E.layoutCtrlWithLRTB(G,0,null,80,30,null,21);G.appendTo(h);w=new B;G=w.getJqUi();E.layoutCtrlWithLRTB(G,80,0,null,30,null,21);G.find(".sa-ctrl-label-text").css({overflow:"visible"});G.appendTo(h);a();return 55};this.protectedItemCreator=function(h){var G=h.getValue();G=c.isSelected(G);var O=new S;O.addCheckedListener(R);O.setUserObject(h);O.setChecked(G);f.protectedIsExcludeMode()&&O.setCustomStyle("text-decoration","line-through");u.push(O);return O.getJqUi()};this.protectedIsExcludeMode=function(){return!1};
this.protectedAfterUpdateTable=function(){g()};var a=function(){var h=0;for(var G=f.protectedGetSelectableItems(),O=0;O<G.length;O++)c.isSelected(G[O].getValue())&&h++;h=e.get("selectedCount","(\u5df2\u9009\u62e9#1\u9879)").replace("#1",h);w.setText(h)},g=function(){var h=!0,G=!1;c.visitAllVisibleSelectableItems(function(O){var aa=!1;G=!0;c.isSelected(O.getValue())||(h=!1,aa=!0);return aa});d.setChecked(G&&h)},R=function(h,G){G&&(G=h.getUserObject(),h=h.isChecked(),c.select(G.getValue(),h),g(),a())},
D=function(h,G){if(G){var O=h.isChecked();for(h=0;h<u.length;h++)u[h]&&u[h].setChecked(O);c.visitAllVisibleSelectableItems(function(aa){c.select(aa.getValue(),O)});a()}}}function oa(){ta.call(this);var f=this.protectedMethod,c=new v;this.protectedItemCreator=function(u){var w=u.getValue();w=f.isSelected(w);var a=new y;a.addCheckedListener(d);a.setUserObject(u);a.setChecked(w);c.addElement(a);return a.getJqUi()};var d=function(u,w){w&&(u.isChecked()?(u=u.getUserObject(),f.selectOnlyOne(u.getValue())):
u.setChecked(!0))}}function ta(){function f(Y){KTDefaultCellRender.call(this,Y);var ua=this,Ea=this.paintCellUI;this.paintCellUI=function(Ma,La){var Ja=ua.getCurrentRowIdx(),Ga=ua.getCurrentRow(),Ka=ua.getCurrentColIdx(),Qa=Ga.getUserObject(),Ha=ma&&-1!=ma.indexOf(Ka-1);Ja<F.getHeadRowCount()?Ha&&1==Ja?(Ka=Ga.getCell(Ka).getValue(),Ha=new N,Ha.setIconType(N.ICON_TYPE_QUESTION),Ha.setTipsText(e.get("noFieldPermTips","\u60a8\u6ca1\u6709\u6743\u9650\u67e5\u770b\u8be5\u5b57\u6bb5\u6570\u636e\u3002")),
Ha=Ha.getJqUi(),Ha.css({display:"inline-block",margin:"5px 0 0 3px"}),La=$("<div>"),La.attr("title",Ka),La.text(Ka),La.css({"margin-top":"5px",display:"inline-block"}),La.appendTo(Ma),Ha.appendTo(Ma)):Ea(Ma,La):0==Ka?(Ka=d.protectedItemCreator(Qa),Ka.css({position:"absolute",left:"30%",top:"2px",width:"23px",height:"23px"}),Ka.appendTo(Ma)):(La=Qa.getEntry(),Ka=Ha?"***":La?La[G[Ka-1]]:"",Ha=$("<div>"),Ha.attr("title",Ka),Ha.text(Ka),Ha.css({"line-height":"28px","padding-left":"10px","padding-right":"10px",
"text-align":"left",overflow:"hidden","text-overflow":"ellipsis"}),Ha.appendTo(Ma))}}function c(){KTableUIDraggableAdjustingHandler.CustomExpendor.call(this);this.getTailBlankForDragging=function(){return 10}}var d=this,u,w,a,g,R,D,h,G,O=[],aa,Aa,la,Ba={},ma=[],za=!1;this.getJqUi=function(){if(!u){var Y=u=$("<div>");w=Y;Ba=d.protectedCloneSelectedValue();Aa=!1;var ua=$("<div>");ua.appendTo(Y);aa=new ja(za);aa.setSearchingHandler(pa);var Ea=aa.getJqUi();E.layoutCtrlWithLRTB(Ea,0,null,za?"57%":"66%",
0,null,23);Ea.css({"min-width":"214px !important","max-width":"500px !important"});Ea.appendTo(ua);Ea=new S;Ea.setText(e.get("showOnlySelected","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));Ea.setChecked(Aa);Ea.addCheckedListener(ya);Ea=Ea.getJqUi();var Ma="en"==W.getUrlParamValue("language")?140:106;za&&(Ma="en"==W.getUrlParamValue("language")?128:94);E.layoutCtrlWithLRTB(Ea,null,0,Ma,0,null,21);Ea.appendTo(ua);Ea=d.protectedInitBar(ua);E.layoutCtrlWithLRTB(ua,0,0,null,0,null,Ea);g=new KTable;g.setFrozenRows(F.getHeadRowCount());
g.setDraggableAdjusting(!0,F.getHeadRowCount(),0,new c);ua=new KTStyle;ua.setVerticalAlign("middle");ua.setFontSize(k.getFontSize());ua.setFontUnit("px");ua.setFontName(k.getFontName());ua.setColor(com.kingdee.bos.qing.common.CommonTableSkin.COLOR);g.setStyle(ua);ua=new f(g);ua.setOutsideVisible(!1);g.setCellRender(ua);g.setSyncUIWhenModelChanged(!1);ua=Ea+6;R=$(g.getUI());E.layoutCtrlWithLRTB(R,0,0,null,ua,0,null);R.appendTo(Y)}return u};this.setNoPermFieldIndex=function(Y){ma=Y};this.setMobile=
function(Y){za=Y};this.protectedGetSelectableItems=function(){throw Error("Impl");};var Ca=function(){la&&1024<=la.length?g.setLargeDataMode(!0,!1):g.setLargeDataMode(!1);var Y=la[0].getEntryHeadMap();h||(Y?(h=Object.values(Y),G=Object.keys(Y)):((Y=la[0].getEntry())||(Y=d.protectedGetSelectableItems()[0].getEntry()),h=Object.keys(Y),G=Object.keys(Y)));D=h.length+1;if(0==O.length){var ua=la,Ea,Ma;Y=[];for(Ea=0;Ea<h.length;Ea++)Y[Ea]=0;for(Ea=0;Ea<ua.length;Ea++){var La=ua[Ea].getEntry();for(Ma=0;Ma<
h.length;Ma++){var Ja=La[G[Ma]];20>Ea&&(Ja=Ja?Ja.toString().length:0,Ja=200<Ja?200:Ja,Ja=10>Ja?10:Ja,Y[Ma]+=Ja)}}if(0==ua.length)for(Ea=0;Ea<h.length;Ea++)Y[Ea]+=h[Ea].length+10;Ea=0;Ma=[];La=20<=la.length?20:la.length;La=0===La?1:La;for(ua=0;ua<h.length;ua++){Ja=Y[ua]/La;var Ga=h[ua]?h[ua].length:0;Ja=Ja<Ga?Ga:Ja;Ea+=Ja;Ma.push(Ja)}for(ua=0;ua<h.length;ua++)O.push(Ma[ua]/Ea)}g.addColumns(D);ua=F.createHeadRow(g);g.getColumn(0).setWidth(32);for(Y=1;Y<D;Y++)Ea=Y-1,Ma=556,La=140,Ja=h.length*La,Ma||
(Ma=Ja),Ga=Math.floor(Ma/Ja),2<=Ga&&(La*=Ga,Ja=h.length*La),Ea=Ja<Ma&&Ea===h.length-1?O[Ea]*La*h.length+(Ma-Ja):O[Ea]*La*h.length,g.getColumn(Y).setWidth(Ea),ua.getCell(Y).setValue(h[Y-1].toUpperCase());for(Y=0;Y<la.length;Y++)ua=la[Y],F.createRow(g).setUserObject(ua)},sa=function(){F.clear(g);var Y=d.protectedGetSelectableItems();if(aa.isSearching()||Aa){var ua=aa.getSelectedSearcherImplLogic();la=$.grep(Y,function(Ea){var Ma=!1,La=!Aa||ha(Ea.getValue());Ea=Ea.getEntry();for(var Ja=Object.keys(Ea).length,
Ga=0;Ga<Ja;Ga++)if(Ea[G[Ga]]&&(Ma=aa.check(""+Ea[G[Ga]])),ua){if(Ma)break}else if(!Ma)break;return Ma&&La})}else la=Y;0<la.length&&Ca();F.refresh(g);d.protectedAfterUpdateTable()};this.protectedAfterUpdateTable=function(){};this.updateTable=function(){sa()};this.protectedCloneSelectedValue=function(){throw Error("Impl");};this.protectedItemCreator=function(Y){throw Error("Impl");};this.protectedInitBar=function(Y){return 28};this.setItemHeight=function(Y){};var na=function(){if(0==la.length){if(!a){var Y=
new B;Y.setText(e.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c"));Y.setEnabled(!1);a=Y.getJqUi();E.layoutCtrlWithLRTB(a,0,0,null,60,null,16);Y.setAlign(B.ALIGN_CENTER);a.appendTo(w)}}else a&&a.remove(),a=null},ha=function(Y){return 1==Ba[Y]},pa=function(){sa();na()},ya=function(Y,ua){Aa=Y.isChecked();sa();na()};this.protectedMethod={visitAllVisibleSelectableItems:function(Y){for(var ua=0;ua<la.length&&!Y(la[ua]);ua++);},isSelected:ha,select:function(Y,ua){ua?Ba[Y]=!0:delete Ba[Y]},
selectOnlyOne:function(Y){Ba={};Ba[Y]=!0},acceptSelectingResult:function(){return Ba},protectedUpdateTable:sa}}function ja(f){va.call(this);var c=this.protectedMethod,d;this.protectedInitUi=function(u,w){var a=new B;a.setText(e.get("searcherTitle","\u641c\u7d22"));var g=c.createAllSearchImpl();d=g[0];c.changeSearchImpl(g[0],!1);var R=new ra;R.setItemModels(g);R.setSelected(g[0]);R.setCustomPainter(function(D,h,G){G&&h.text(G.getCaption())});R.addSelectedChangedListener(function(D,h,G){d=G;c.changeSearchImpl(G,
!0)});a=a.getJqUi();R=R.getJqUi();g="en"==W.getUrlParamValue("language")?10:0;E.layoutCtrlWithLRTB(a,0,null,40+g,0,null,23);E.layoutCtrlWithLRTB(R,33+g,null,74,0,null,23);E.layoutCtrlWithLRTB(w,114+g,null,f?"47%":"45%",0,null,23);w.css({"min-width":"100px !important","max-width":"278px !important","margin-right":"5px"});u.append(a);u.append(R);u.append(w)};this.getSelectedSearcherImplLogic=function(){return d.getLogic()}}function va(){var f=this,c,d,u,w;this.setSearchingHandler=function(g){w=g};this.isSearching=
function(){return d&&d.getText()?!0:!1};this.check=function(g){return!(d&&d.getText())||u.check(g.toLowerCase(),(d?d.getText():null).toLowerCase())};this.clear=function(){d&&d.clear()};this.getJqUi=function(){c||(c=$("<div>"),f.protectedInitUi(c,a().getJqUi()));return c};this.protectedInitUi=function(g,R){throw Error("Implement");};var a=function(){d=new b;d.setPlaceholder(e.get("searcherTips","\u641c\u7d22\u5185\u5bb9"));d.addSearchListener(function(g){w()});d.setSearchListenerDelay(1E3);return d};
this.protectedMethod={createAllSearchImpl:function(){return[new wa(!0),new wa(!1),new ea(!0),new ea(!1),new xa(!0),new xa(!1),new fa(!0),new fa(!1)]},changeSearchImpl:function(g,R){u=g;R&&w()}}}function Fa(f){var c=this;this.getLogic=function(){return f};this.getCaption=function(){return c.protectedGetCaption(!f)};this.protectedGetCaption=function(d){throw Error("Override");};this.check=function(d,u){d=c.protectedCheckImpl(d,u);return f?d:!d};this.protectedCheckImpl=function(d,u){throw Error("Override");
}}function wa(f){Fa.call(this,f);this.protectedGetCaption=function(c){return c?e.get("searchNotInclude","\u4e0d\u5305\u542b"):e.get("searchInclude","\u5305\u542b")};this.protectedCheckImpl=function(c,d){return 0<=c.indexOf(d)}}function fa(f){Fa.call(this,f);this.protectedGetCaption=function(c){return c?e.get("searchNotEqual","\u4e0d\u7b49\u4e8e"):e.get("searchEqual","\u7b49\u4e8e")};this.protectedCheckImpl=function(c,d){return c===d}}function ea(f){Fa.call(this,f);this.protectedGetCaption=function(c){return c?
e.get("searchNotStartOf","\u5f00\u5934\u4e0d\u662f"):e.get("searchStartOf","\u5f00\u5934\u662f")};this.protectedCheckImpl=function(c,d){return 0==c.indexOf(d)}}function xa(f){Fa.call(this,f);this.protectedGetCaption=function(c){return c?e.get("searchNotEndOf","\u7ed3\u5c3e\u4e0d\u662f"):e.get("searchEndOf","\u7ed3\u5c3e\u662f")};this.protectedCheckImpl=function(c,d){var u=c.lastIndexOf(d);return 0<=u&&u==c.length-d.length}}function ia(){var f=this,c,d=!0;this.setUserObject=function(a){c=a};this.getUserObject=
function(){return c};this.setEnabled=function(a){d=a;f.protectedUpdateEnabledState()};this.isEnabled=function(){return d};this.setTooltips=function(a){f.getJqUi().attr("title",a)};this.getJqUi=function(){throw Error("Override me.");};this.protectedUpdateEnabledState=function(){};var u=function(a,g){w(a,g,"sa-ctrl-common-singlelineborder","sa-ctrl-common-singlelineborder_disabled")},w=function(a,g,R,D){g?(a.addClass(R),a.removeClass(D)):(a.removeClass(R),a.addClass(D))};this.protectedMethod={superSetEnabled:function(a){d=
a;f.protectedUpdateEnabledState()},createBorder:function(a){var g=$("<div>");g.addClass("sa-ctrl-common-border");E.layoutCtrlWithLRTB(g,0,0,null,0,0,null);g.appendTo(a);return g},setUiBorderVisible:function(a,g){g?u(a,d):(a.removeClass("sa-ctrl-common-singlelineborder"),a.removeClass("sa-ctrl-common-singlelineborder_disabled"))},setUiBorderEnabled:u,setUiForegroundEnabled:function(a,g){w(a,g,"sa-ctrl-common-foreground_enabled","sa-ctrl-common-foreground_disabled")},setUiBackgroundEnabled:function(a,
g){w(a,g,"sa-ctrl-common-background_enabled","sa-ctrl-common-background_disabled")}}}function ra(){ia.call(this);var f=this.protectedMethod,c=this,d=[],u,w,a=$("<div>"),g,R,D,h,G,O=[],aa,Aa=!1,la=!1,Ba,ma,za;this.setItemModels=function(Ha,Pa){D=Pa;d=Ha;G=null};this.setEditable=function(Ha,Pa){Ba=(la=Ha)?Pa:null};this.setSelected=function(Ha){u=Ha;ua();G&&pa()};this.getSelected=function(){return u};this.setCustomPainter=function(Ha){R=Ha;ua();G&&ya()};this.setDropdownAsLongAsPossible=function(Ha){Aa=
Ha};this.setDropdownListener=function(Ha){aa=Ha};this.addSelectedChangedListener=function(Ha){O.push(Ha)};this.getJqUi=function(){w||Ca();return w};this.protectedUpdateEnabledState=function(){w&&(f.setUiBorderEnabled(w,c.isEnabled()),f.setUiBackgroundEnabled(w,c.isEnabled()),f.setUiForegroundEnabled(w,c.isEnabled()),c.isEnabled()?g.addClass("extreport-runtime-filter-combobox-arrow_enabled"):g.removeClass("extreport-runtime-filter-combobox-arrow_enabled"))};this.isChildOfPopup=function(Ha){return h?
E.isDescendent(Ha,h[0]):!1};var Ca=function(){w=$("<div>");w.addClass("extreport-runtime-filter-combobox");a.addClass("extreport-runtime-filter-combobox-text");a.appendTo(w);g=$("<div>");g.addClass("extreport-runtime-filter-combobox-arrow");g.appendTo(w);g.on("mouseenter",function(Ha){c.isEnabled()&&Y(!0)});g.on("mouseleave",function(Ha){c.isEnabled()&&Y(!1)});Y(!1);if(la)a.on("click",sa),g.on("click",Ea),ma=$("<input>"),ma.addClass("extreport-runtime-filter-textfield-input"),ma.on("blur",Ga),ma.on("keydown",
Ka),ma.appendTo(w),ma.hide();else w.on("click",Ea);c.protectedUpdateEnabledState()},sa=function(Ha){ma&&(a.hide(),ma.show(),ma.focus(),ma.val(a.text()))},na=function(){G=new l;G.setToggleSelectingEnabled(!1);G.setItemModels(d,D);pa();G.addSelectedChangedListener(function(Ha,Pa,Sa){if(!ha)for(Ha=u,Sa=0<Sa.length?Sa[0]:null,c.setSelected(Sa),Pa=0;Pa<O.length;Pa++)(0,O[Pa])(c,Ha,Sa)});G.addPressedListener(function(Ha,Pa){Ma()});ya()},ha=!1,pa=function(){ha=!0;G.setSelecteds(u||0===u||!1===u?[u]:[]);
ha=!1},ya=function(){R?G.setCustomItemPainter(function(Ha,Pa){R(!1,Ha,Pa)}):G.setCustomItemPainter(null)},Y=function(Ha){var Pa=h?"arrow-up":"arrow-down";Ha&&(Pa+="_hover");t.background(g,Pa)},ua=function(){a.empty();R?R(!0,a,u):a.text(u||0===u||!1===u?u:"");a.show();ma&&ma.hide()},Ea=function(Ha){if(c.isEnabled())if(h)Ma();else{G||na();Ha=$(document.body);var Pa=w.outerHeight(),Sa=w.outerWidth(),Ta=[0,Pa-1];Ta=E.upwardCoordinate(w[0],Ta,Ha[0]);Pa=Ta[0];var Ua=Ta[1];Ta=Ha.prop("clientHeight");var r=
Math.min(20*Math.max(1,Math.min(d.length,Aa?65535:10))+2,(Ta>>1)-10);Ua+r>Ta&&(Ta=[0,0],Ta=E.upwardCoordinate(w[0],Ta,Ha[0]),Ta=Ta[1]-r+1,0<=Ta&&(Ua=Ta));h=$("<div>");h.addClass("sa-ctrl-common-popup");h.addClass("sa-ctrl-common-unselectable");h.css("position","absolute");h.css("left",Pa+"px");h.css("top",Ua+"px");h.css("width",Sa+"px");h.css("height",r+"px");h.appendTo(Ha);Sa=G.getJqUi();Sa.appendTo(h);Sa.css("position","absolute");Sa.css("left","0px");Sa.css("top","0px");Sa.css("width","100%");
Sa.css("height","100%");G.scrollSelectedToVisible();Ha.on("mousedown",Ja);Ha.on("mousewheel",La);Y(!1);aa&&aa(c,!0)}},Ma=function(){if(h){var Ha=$(document.body);Ha.off("mousedown",Ja);Ha.off("mousewheel",La);h.detach();h=null;Y(!1);aa&&aa(c,!1)}},La=function(Ha){E.isDescendent(Ha.target,G.getJqUi()[0])||Ma()},Ja=function(Ha){w.is(":visible")&&(E.isDescendent(Ha.target,w[0])||E.isDescendent(Ha.target,h[0]))||Ma()},Ga=function(Ha){Qa()},Ka=function(Ha){za=!0;13==Ha.keyCode?(Qa(),Ha.preventDefault()):
27==Ha.keyCode&&(ua(),za=!1)},Qa=function(){if(za){var Ha=$.trim(ma.val());Ha=Ba?Ba(Ha):Ha;c.setSelected(Ha);za=!1}}}function H(){ia.call(this);var f=this.protectedMethod,c=this,d,u,w,a=$("<div>"),g,R,D,h,G=[],O=["arrow-down","arrow-up"],aa=!1,Aa,la,Ba;this.setEditable=function(Ga,Ka){Aa=(aa=Ga)?Ka:null};this.getSelectedModel=function(){return d};this.setSelectedModel=function(Ga){d=Ga;ha();ma(!1)};this.addSelectionListener=function(Ga){G.push(Ga)};this.removeSelectionListener=function(Ga){for(var Ka=
G.length-1;0<=Ka;Ka--)G[Ka]==Ga&&G.splice(Ka,1)};var ma=function(Ga){for(var Ka=0;Ka<G.length;Ka++)(0,G[Ka])(c,Ga)};this.setCustomPainter=function(Ga){h=Ga;ha()};this.setDropdownCreator=function(Ga){R=Ga};var za=function(Ga){return R(Ga,d,function(Ka){Y();d=Ka;ha();ma(!0)},function(){Y()},function(Ka){D=Ka})};this.getJqUi=function(){u||Ca();return u};this.setIconName=function(Ga,Ka){O=[Ga,Ka?Ka:Ga]};var Ca=function(){u=$("<div>");u.addClass("extreport-runtime-filter-combobox");a.addClass("extreport-runtime-filter-combobox-text");
a.appendTo(u);w=$("<div>");w.addClass("extreport-runtime-filter-combobox-arrow");w.appendTo(u);w.on("mouseenter",function(Ga){c.isEnabled()&&pa(!0)});w.on("mouseleave",function(Ga){c.isEnabled()&&pa(!1)});pa(!1);ha();if(aa)a.on("click",sa),w.on("click",ya),la=$("<input>"),la.addClass("extreport-runtime-filter-textfield-input"),la.on("blur",Ma),la.on("keydown",La),la.appendTo(u),la.hide();else u.on("click",ya);c.protectedUpdateEnabledState()},sa=function(Ga){la&&c.isEnabled()&&(a.hide(),la.show(),
la.focus(),la.val(a.text()))},na=function(Ga,Ka){Ka.text(Ga?Ga:"")},ha=function(){a&&(h?h:na)(d,a);a.show();la&&la.hide()},pa=function(Ga){var Ka=g?O[1]:O[0];Ga&&(Ka+="_hover");com.kingdee.bos.qing.ui.component.Icons.background(w,Ka)};this.protectedUpdateEnabledState=function(){u&&(f.setUiBorderEnabled(u,c.isEnabled()),f.setUiBackgroundEnabled(u,c.isEnabled()),f.setUiForegroundEnabled(u,c.isEnabled()),c.isEnabled()?(w.addClass("extreport-runtime-filter-combobox-arrow_enabled"),w.css({cursor:"pointer",
opacity:""}),aa&&la.removeAttr("disabled")):(w.removeClass("extreport-runtime-filter-combobox-arrow_enabled"),w.css({cursor:"",opacity:"0.4"}),aa&&la.attr("disabled","disabled")))};var ya=function(Ga){if(c.isEnabled())if(g)Y();else{Ga=$(document.body);g=$("<div>");g.addClass("sa-ctrl-common-popup");g.addClass("sa-ctrl-common-unselectable");g.appendTo(Ga);var Ka=za(g),Qa=Ka?Ka[0]:-1,Ha=Ka?Ka[1]:-1;Ka=Ga.prop("clientWidth");var Pa=Ga.prop("clientHeight"),Sa=Pa>>1,Ta=u.outerWidth(),Ua=u.outerHeight(),
r=Math.max(0,Sa-Ua-28),z=[0,Ua-1];z=E.upwardCoordinate(u[0],z,Ga[0]);var x=z[0],K=z[1];Qa=0>Qa?Ta:Qa;Ha=0>Ha?r:Ha;K+Ha>Pa&&(K>Sa+Ua?(z=[0,0],z=E.upwardCoordinate(u[0],z,Ga[0]),Pa=z[1]-Ha+1,0<=Pa?K=Pa:(K=2,Ha=z[1]-2)):Ha=Pa-K-2);x+Qa>Ka-10&&(x=Ka-Qa-10,0>x&&(x=0));E.layoutCtrl(g,x,K,Qa,Ha);Ga.on("mousedown",Ea);Ga.on("mousewheel",ua);pa(!1);D&&D()}},Y=function(){if(g){var Ga=$(document.body);Ga.off("mousedown",Ea);Ga.off("mousewheel",ua);g.remove();g=null;pa(!1)}},ua=function(Ga){E.isDescendent(Ga.target,
g[0])||Y()},Ea=function(Ga){u.is(":visible")&&(E.isDescendent(Ga.target,u[0])||E.isDescendent(Ga.target,g[0]))||Y()},Ma=function(Ga){Ja()},La=function(Ga){Ba=!0;13==Ga.keyCode?(Ja(),Ga.preventDefault()):27==Ga.keyCode&&(ha(),Ba=!1)},Ja=function(){if(Ba){var Ga=$.trim(la.val());Ga=Aa?Aa(Ga):Ga;c.setSelectedModel(Ga);Ba=!1}}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&
(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.filter&&(com.kingdee.bos.extreport.runtime.filter={});var L=com.kingdee.bos.extreport.runtime.filter;L.F7Selector=function(){ia.call(this);var f=this.protectedMethod,c=this,d,u,w,a,g,R=!1,D=!1,h=!1,G,O,aa=[],Aa=[];this.setClearable=function(Y){R=Y};this.setEditable=function(Y,ua){O=(D=Y)?ua:null};this.setEnabled=function(Y){d||
za();f.superSetEnabled(Y);var ua=d.parent();f.setUiBorderEnabled(ua,Y);Y?(w.css({color:"#666"}),w.removeAttr("disabled"),w.attr("title",D?w.val():w.text()),d.find(".extreport-runtime-filter-f7selector-btn").css("display",""),R=!0):(w.css({color:"#c0c0c0"}),w.attr("disabled","disabled"),w.removeAttr("title"),d.find(".extreport-runtime-filter-f7selector-btn").css("display","none"),R=!1)};this.setModel=function(Y){g=Y;na()};this.getModel=function(){return g};this.setCustomPainter=function(Y){G=Y;na()};
this.addActionListener=function(Y){aa.push(Y)};this.removeActionListener=function(Y){for(var ua=aa.length-1;0<=ua;ua--)aa[ua]==Y&&aa.splice(ua,1)};this.addClearListener=function(Y){Aa.push(Y)};this.removeClearListener=function(Y){for(var ua=Aa.length-1;0<=ua;ua--)Aa[ua]==Y&&Aa.splice(ua,1)};var la=function(){R&&g?a?a.show():(a=$("<div>"),a.addClass("extreport-runtime-filter-f7selector-btn"),a.addClass("extreport-runtime-filter-f7selector-btnclear"),a.on("click",ma),t.background(a,"delete"),u.append(a),
c.protectedUpdateEnabledState()):a&&a.hide()},Ba=function(){a&&a.hide()},ma=function(){if(c.isEnabled()&&R){c.setModel(null);a&&a.hide();for(var Y=Aa.length,ua=0;ua<Y;ua++)(0,Aa[ua])(c)}};this.getJqUi=function(){d||za();return d};var za=function(){u=$("<div>");u.on("mouseenter",la);u.on("mouseleave",Ba);u.addClass("extreport-runtime-filter-f7selector-textcontainer");D?(w=$("<input>"),w.addClass("extreport-runtime-filter-textfield-input"),w.on("blur",ha),w.on("keydown",pa)):(w=$("<div>"),w.addClass("extreport-runtime-filter-f7selector-text"));
w.appendTo(u);var Y=$("<div>");Y.addClass("extreport-runtime-filter-f7selector-btn");Y.addClass("extreport-runtime-filter-f7selector-btnedit");Y.on("click",Ca);t.background(Y,"search");d=$("<div>");d.addClass("extreport-runtime-filter-f7selector");d.append(u);d.append(Y);na();c.protectedUpdateEnabledState()},Ca=function(){if(c.isEnabled())for(var Y=aa.length,ua=0;ua<Y;ua++)(0,aa[ua])(c)},sa=function(Y){return Y?Y:""};this.protectedUpdateEnabledState=function(){if(d){f.setUiBorderEnabled(d,c.isEnabled());
f.setUiBackgroundEnabled(d,c.isEnabled());f.setUiForegroundEnabled(d,c.isEnabled());var Y=d.find(".extreport-runtime-filter-f7selector-btn");c.isEnabled()?Y.addClass("extreport-runtime-filter-f7selector-btn_enabled"):Y.removeClass("extreport-runtime-filter-f7selector-btn_enabled")}};var na=function(){if(w){var Y=(G?G:sa)(g);D?w.val(Y):w.text(Y);w.attr("title",Y)}},ha=function(Y){ya()},pa=function(Y){h=!0;13==Y.keyCode?(ya(),Y.preventDefault()):27==Y.keyCode&&(na(),h=!1)},ya=function(){if(h){var Y=
$.trim(w.val());Y=O?O(Y):Y;c.setModel(Y);h=!1}}};L.F7Dialog=function(){A.call(this);var f=this,c=this.protectedMethod,d,u=[],w=[],a=!1,g,R=!1,D,h,G=[];(function(){c.setTitle(e.get("f7dialog","\u5f39\u7a97\u9009\u62e9\u5668"));f.setSize(640,480);c.setSelectable(!0);c.setContentPaneCreator(function(){if(R)d=a?new q(D):new p(D);else{var O=u[0]?u[0].getEntry():null;a?O&&0<Object.keys(O).length?(d=new J,d.setNoPermFieldIndex(G)):d=new P:O&&0<Object.keys(O).length?(d=new I,d.setNoPermFieldIndex(G)):d=new M}d.setSelectableItems(u);
d.setSelected(w);return d.getJqUi()});c.setClosingChecker2(function(O){O=d.getSelected();if(h&&!isNaN(h)&&O.length>h)return O=e.get("exceedMaxSelect","\u9009\u62e9\u6570\u91cf\u8d85\u8fc7\u9650\u5236\uff0c\u6700\u591a\u53ef\u9009#1\u4e2a\u53c2\u6570\u3002").replace("#1",h),c.getMessageCurtain().showPrompt(O),!1;g&&g(O);c.destroy();return!0},function(O){c.destroy();return!0});c.setClosingAction(function(O){})})();this.setTreeNodeStyle=function(O){R=O};this.setTreeExpandLevel=function(O){D=O};this.setSelectabledItems=
function(O){u=O;d&&d.setSelectableItems(u)};this.getPanel=function(){return d};this.setConfirmCallback=function(O){g=O};this.setMultiSelect=function(O){a=O};this.setSelected=function(O){O||(O=[]);w=O};this.setMaxSelect=function(O){h=O};this.setNoPermFieldIndex=function(O){G=O}};L.ComboBox=ra;L.DropdownSelector=H;L.ChooseItemPane=function(){var f=[],c,d,u,w;this.setItemModel=function(a){f=a};this.setRawTypeSwitchListener=function(a){};this.setSearchListener=function(a){c=a};this.setListItemPainter=
function(a){d=a};this.createJqPopup=function(a,g,R){u=$("<div>");u.appendTo(a);w=$("<div>");u.addClass("extreport-runtime-filter-field-popup");a=e.get("search","\u641c\u7d22");var D=new b;D.setSearchListenerDelay(200);D.setPlaceholder(a);D.addSearchListener(function(){c(f,D.getText(),w,g,d)});a=D.getJqUi();a.addClass("extreport-runtime-filter-field-popup-search");a.appendTo(u);w.addClass("extreport-runtime-filter-field-popup-list-owner");w.on("click",function(G){var O=$(G.currentTarget);G=$(G.target);
if(G=E.upwardSearchHasClass(G,O,"extreport-runtime-filter-field-popup-list-item"))G.addClass("extreport-runtime-filter-list-item_selected_enabled"),O=G.data("model"),R(O)});w.appendTo(u);var h=u.find(".extreport-runtime-filter-search-textfield-input");h.css("top","0px");h.css("height","100%");for(h=0;h<f.length;h++)d(f[h],w,g,!1);return[-1,10<f.length?200+a.height():20*f.length+a.height()+3]}};L.DateSelector=function(){com.kingdee.bos.qing.ui.component.DateSelector.call(this);var f=this;this.protectedCreatePopupUi=
function(c,d,u,w){w.addSelectedChangedListener(function(g){g=new Date;g.setHours(0,0,0,0);g.setFullYear(w.getSelectedYear(),w.getSelectedMonth()-1,w.getSelectedDay());u(g)});d=w.suggestSize()[1];var a=$("<div>");a.addClass("sa-ctrl-date-foot");c.append(a);E.layoutCtrlWithLRTB(a,0,0,null,null,0,32);d+=32;f.isSelectedNullable()&&(c=new Q,c.setText(e.get("clean","\u6e05\u7a7a")),c.addActionListener(function(g){u(null)}),a.append(c.getJqUi()),E.layoutCtrlWithLRTB(c.getJqUi(),4,null,60,null,4,24));c=new Q;
c.setText(e.get("today","\u4eca\u5929"));c.addActionListener(function(g){g=new Date;g.setHours(0,0,0,0);u(g)});c.getJqUi().appendTo(a);E.layoutCtrlWithLRTB(c.getJqUi(),null,4,60,null,4,24);E.layoutCtrlWithLRTB(w.getJqUi(),0,0,null,0,32,null);return[230,d]}};L.DateTimeSelector=function(){com.kingdee.bos.qing.ui.component.DateTimeSelector.call(this);var f=this;this.protectedCreatePopupUi=function(c,d,u,w){w.setCurrentMonthNavigatorListener(function(la,Ba){R.css("display",Ba?"":"none")});w.addSelectedChangedListener(function(la){G.setEnabled(!0)});
var a=$("<div>"),g=$("<div>"),R=$([a[0],g[0]]);R.css("display","none");R.addClass("sa-ctrl-date-mask");var D=new X;D.getJqUi().addClass("sa-ctrl-date-separater");setTimeout(function(){d?D.setSelected(d.getHours(),d.getMinutes(),d.getSeconds()):D.setSelected(0,0,0)},0);var h=$("<div>");h.addClass("sa-ctrl-date-foot");var G=new Q;G.setText(e.get("ok","\u786e\u5b9a"));G.setEnabled(w.isSelected());G.addActionListener(function(la){la=T.createDateObject(w.getSelectedYear(),w.getSelectedMonth()-1,w.getSelectedDay());
la.setHours(D.getHour(),D.getMinute(),D.getSecond(),0);u(la)});G.getJqUi().appendTo(h);E.layoutCtrlWithLRTB(G.getJqUi(),null,4,60,null,4,24);if(f.isSelectedNullable()){var O=new Q;O.setText(e.get("clean","\u6e05\u7a7a"));O.addActionListener(function(la){u(null)});O.getJqUi().appendTo(h);E.layoutCtrlWithLRTB(O.getJqUi(),4,null,60,null,4,24)}O=new Q;O.setText(e.get("now","\u73b0\u5728"));O.addActionListener(function(la){la=new Date;la.setMilliseconds(0);u(la)});O.getJqUi().appendTo(h);E.layoutCtrlWithLRTB(O.getJqUi(),
null,D.suggestSize()[0],60,null,4,24);c.append(D.getJqUi());c.append(h);c.append(a);c.append(g);c=w.suggestSize();O=D.suggestSize();var aa=c[0]+O[0],Aa=Math.max(c[1],O[1])+32;E.layoutCtrlWithLRTB(w.getJqUi(),0,null,c[0],0,32,null);E.layoutCtrlWithLRTB(D.getJqUi(),null,0,O[0],0,32,null);E.layoutCtrlWithLRTB(a,null,0,O[0],0,32,null);E.layoutCtrlWithLRTB(h,0,0,null,null,0,32);E.layoutCtrlWithLRTB(g,0,0,null,null,0,32);return[aa,Aa]}};L.TimeSelector=function(){ia.call(this);var f=this,c=this.protectedMethod,
d,u=!1,w=[0,0,0];this.setEnabled=function(D){R().setEnabled(D)};this.isEnabled=function(){return R().isEnabled()};this.addSelectionListener=function(D){R().addSelectionListener(function(h,G){G&&(w=h.getSelectedModel(),D(f))})};this.getJqUi=function(){return R().getJqUi()};this.setSelectedNullable=function(D){u=D};this.setSelected=function(D,h,G){if(!u&&null===D)throw Error("Illegal argument");w=null===D?null:[D,h,G];R().setSelectedModel(w)};this.isSelectedNull=function(){return null===w};this.getHour=
function(){return w[0]};this.getMinute=function(){return w[1]};this.getSecond=function(){return w[2]};var a=function(D){return(10>D?"0":"")+D},g=function(D,h){var G="";D&&(G=a(D[0])+" : "+a(D[1])+" : "+a(D[2]));h.text(G)},R=function(){d||(d=new H,d.setIconName("time"),d.setCustomPainter(g),d.setDropdownCreator(function(D,h,G,O){O=$("<div>");O.addClass("sa-ctrl-date-foot");if(u){var aa=new Q;aa.setText(e.get("clean","\u6e05\u7a7a"));aa.addActionListener(function(la){G(null)});aa.getJqUi().appendTo(O);
E.layoutCtrlWithLRTB(aa.getJqUi(),4,null,60,null,5,22)}aa=new Q;aa.setText(e.get("ok","\u786e\u5b9a"));aa.addActionListener(function(la){G([Aa.getHour(),Aa.getMinute(),Aa.getSecond()])});aa.getJqUi().appendTo(O);E.layoutCtrlWithLRTB(aa.getJqUi(),null,4,60,null,5,22);var Aa=new X;setTimeout(function(){Aa.setSelected(h?h[0]:0,h?h[1]:0,h?h[2]:0)},0);D.append(Aa.getJqUi());D.append(O);E.layoutCtrlWithLRTB(Aa.getJqUi(),0,0,null,0,32,null);E.layoutCtrlWithLRTB(O,0,0,null,null,0,32);c.setUiBackgroundEnabled(D,
!0);Aa.suggestSize();D=new Q;D.setText(e.get("now","\u73b0\u5728"));D.addActionListener(function(la){la=new Date;G([la.getHours(),la.getMinutes(),la.getSeconds()])});D.getJqUi().appendTo(O);E.layoutCtrlWithLRTB(D.getJqUi(),85,null,60,null,5,22);return[230,300]}));return d}};L.SwitchButton=function(){ia.call(this);var f=this,c,d,u,w=!0,a=[],g,R,D=0,h,G=new n;this.setText=function(la,Ba){g=la;R=Ba;Aa(!1)};this.addStateChangeListener=function(la){a.push(la)};var O=function(la){for(var Ba=0;Ba<a.length;Ba++)(0,a[Ba])(f,
la,w)};this.setOn=function(la){w=la;Aa(!0);O(!1)};this.isOn=function(){return w};this.getJqUi=function(){if(!c){var la=$("<div>");c=$("<div>");c.on("click",aa);c.appendTo(la);d=$("<div>");d.addClass("sa-ctrl-switcher-thumb");d.appendTo(c);u=$("<div>");u.addClass("extreport-runtime-filter-switch-text");u.appendTo(c);Aa(!1);c.css("border-radius","10px");E.layoutCtrlMiddleAlign(c,19);E.layoutCtrlMiddleAlign(d,15);d.css("border-radius","8px");d.css("width",15);d.css("margin-top","-8px")}return c.parent()};
var aa=function(){f.isEnabled()&&(w=!w,Aa(!0),O(!0))};this.protectedUpdateEnabledState=function(){Aa(!1)};var Aa=function(la){var Ba=w?g:R;Ba?(G.setFontSize(12,"Microsoft YaHei"),D=G.measureWidth(Ba),h=15+D+12):(h=38,D=0);65<h&&(D-=h-65,h=65);if(c){c.css("width",h);u.css("width",D);f.isEnabled()?(c.css("cursor","pointer"),c.css("opacity","")):(c.css("cursor",""),c.css("opacity","0.5"));w?(c.addClass("sa-ctrl-switcher_on"),c.removeClass("sa-ctrl-switcher_off"),u.text(g),u.attr("title",g)):(c.removeClass("sa-ctrl-switcher_on"),
c.addClass("sa-ctrl-switcher_off"),u.text(R),u.attr("title",R));Ba=4;var ma=23;w&&(ma=4,Ba=0<D?D+8:h-4-15);la?(d.animate({left:Ba+"px"},"fast"),u.animate({left:ma+"px"},"fast")):(d.css("left",Ba+"px"),u.css("left",ma+"px"))}}};L.SingleValueDiscreteFilterPane=M;L.MultiValueDiscreteFilterPane=P;L.SingleValueTreeFilterPane=p;L.MultiValueTreeFilterPane=q;L.MultiValueDiscreteTableFilterPanel=J;L.SingleValueDiscreteTableFilterPanel=I;var A,B,b,m,l,y,v,S,Q,X,T,N,W,E,F,e,k,n,t;(function(){var f=com.kingdee.bos.qing.ui.component;
A=f.AbstractModalDialog;B=f.Label;b=f.SearchBox;m=f.DynamicScroller;l=f.List;y=f.RadioButton;v=f.RadioButtonGroup;S=f.CheckBox;Q=f.WorkButton;X=f.TimeList;T=f.AbstractMonthlyCalendar;N=f.HelpIcon;f=com.kingdee.bos.qing;W=f.Seer;f=com.kingdee.bos.qing.common;E=f.DomUtil;n=f.TextMeasurer;f=com.kingdee.bos.qing.common.ui;F=f.TableUtil;f=com.kingdee.bos.qing.framework.common;e=f.MultilanguageManager.createPackageAccessor(L);k=f.GlobalFont;f=com.kingdee.bos.extreport.runtime;t=f.MyIcons})()})();(function(){function p(b,m){var l=this,y;this.getParamDescription=function(){return b};this.getContext=function(){return m};this.createUI=function(Q){throw Error("Override me.");};this.setSuppliedValue=function(Q){throw Error("Override me.");};this.setSelectedValue=function(Q){throw Error("Override me.");};this.getSelectedValue=function(){throw Error("Override me.");};this.setSuppliedValueDescription=function(Q){};this.resetSuppliedValue=function(Q,X){};this.setSelectedValueChangedListener=function(Q){y=
Q};this.fireSelectedValueChanged=function(){y&&y(l)};var v=function(){var Q=$("<div>"),X=new A;X.setFontSize(B.getFontSize(),B.getFontName());var T=X.measureWidth(b.getCaption())+4,N=b.isRequired();N&&(T+=8);T=Math.min(T,97);Q.css({display:"inline-block",width:"108px",height:"24px",position:"relative",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"});var W=new com.kingdee.bos.qing.ui.component.Label;W.setRequired(N);W.setText(b.getCaption());W.setTooltips(b.getCaption());N=W.getJqUi();
N.css({position:"absolute",left:"6px",top:0,width:T+"px",height:"24px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",verticalAlign:"middle"});N.appendTo(Q);if(W=b.getDescription())N=new ra,N.setIconType(ra.ICON_TYPE_QUESTION),N.setTipsText(W),X=X.measureWidth(W),N.setTipsSize(300<X?300:X+40,20*(Math.ceil(X/300)+1)),X=N.getJqUi(),T+=10,X.css({"z-index":2}),L.layoutCtrlWithLRTB(X,T,null,16,4,null,16),X.appendTo(Q);return Q},S=function(Q,X){Q.prop(X,!0);Q.css("background-color","transparent")};
this.protectedMethod={createUiWithLabel:function(Q,X){var T="ctrl_"+b.getName();X.attr("id",T);var N=v();N.css("verticalAlign","middle");X.css({position:"relative",height:"24px",width:"230px",display:"inline-block",verticalAlign:"middle","font-size":"12px"});N.attr("for",T);Q.append(N);Q.append(X);"Hidden"==b.getState()?Q.css("display","none"):b.isReadOnly()?(X.addClass("r-filter-disable"),Q=X.find("input"),X.is("input")?S(X,"readonly"):Q.is("input")?S(Q,"readonly"):(Q=$(X[0]),S(Q,"disabled")),Q.addClass("r-filter-disable")):
X.addClass("extreport-runtime-filter-enabled")},createUiWithFieldset:function(Q,X){var T=$("<div>");T.attr("data-role","controlgroup");var N=v();N.css({"margin-top":"8px",verticalAlign:"top"});var W=$("<ul>");W.css({position:"relative",width:"85%",display:"inline-block"});T.append(N);T.append(W);if(X instanceof Array)for(N=0;N<X.length;N++){var E=$("<li>");E.css({margin:"8px 24px 8px 0px",display:"inline-block","font-size":"12px"});E.append(X[N]);W.append(E);b.isReadOnly()?X[N].prop("disabled",!0):
X[N].addClass("extreport-runtime-filter-enabled")}else N="ctrl_"+l.getParamDescription().getName(),X.attr("id",N),W.append(X);Q.append(T);"Hidden"==l.getParamDescription().getState()?Q.css("display","none"):b.isReadOnly()&&W.addClass("r-filter-disable")},createUiWithLabel2:function(Q,X){var T="ctrl_"+l.getParamDescription().getName();X.attr("id",T);Q.append(X);"Hidden"==l.getParamDescription().getState()&&Q.css("display","none")}}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&
(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.filter&&(com.kingdee.bos.extreport.runtime.filter={});var q=com.kingdee.bos.extreport.runtime.filter;q.FilterTextField=function(b,m){var l=this;p.call(this,b,m);var y,v,S=this.protectedMethod;this.createUI=
function(X){y||Q();var T=y.getJqUi();S.createUiWithLabel(X,T)};this.setSuppliedValue=function(X){};this.setSelectedValue=function(X){var T;X&&0<X.length&&(T=X[0].getValue());y||Q();y.setText(null==T?"":T);l.fireSelectedValueChanged()};this.getSelectedValue=function(){y||Q();var X=null==y.getText()?"":y.getText(),T=new ValueTextModel;T.setValue(X);T.setText(X);return[T]};var Q=function(){y=new C;y.addEditedListener(function(X){clearTimeout(v);v=setTimeout(function(){l.fireSelectedValueChanged()},1E3)})}};
q.FilterComboBox=function(b,m){var l=this;p.call(l,b,m);var y=this.protectedMethod,v,S,Q=[];this.createUI=function(T){v||X();var N=v.getJqUi();y.createUiWithLabel(T,N)};this.createUIWithoutLabel=function(T){X();v.setItemModels(Q,function(W,E){return W&&E?W.getValue()==E.getValue():!1});var N=v.getJqUi();y.createUiWithLabel2(T,N)};this.setEnabled=function(T){v&&v.setEnabled(T)};var X=function(){v=new wa;b.isEditable()&&v.setEditable(!0,function(T){if(!T||""==T&&b.isRequired())return null;for(var N=
0,W=Q.length;N<W;N++)if(Q[N].getText()==T)return Q[N];N=new ValueTextModel;N.setText(T);N.setValue(T);return N});b.isReadOnly()&&v.setEnabled(!1);v.setCustomPainter(function(T,N,W){W&&N.text(W.getText())});v.addSelectedChangedListener(l.fireSelectedValueChanged)};this.setSuppliedValue=function(T){v||X();if(T){var N=l.getParamDescription(),W=N.getCtrlType();N=N.isRequired();"combobox"!=W.toLowerCase()||N||(W=new ValueTextModel,W.setValue(""),W.setText(""),T.unshift(W));v.setItemModels(T,function(E,
F){return E&&F?E.getValue()==F.getValue():!1});Q=T}};this.setSelectedValue=function(T){var N;T&&0<T.length&&(N=T[0]);if(N){v||X();T=N;N=0;for(var W=Q.length;N<W;N++)if(Q[N].getValue()==T.getValue()){var E=Q[N];break}v.setSelected(E)}};this.getSelectedValue=function(){v||X();var T=v.getSelected();if(T){var N=new ValueTextModel;N.setValue(T.getValue());N.setText(T.getText());return[N]}return[]};this.setSuppliedValueDescription=function(T){S=T};this.resetSuppliedValue=function(T,N){var W=l.getParamDescription().getName();
l.getContext().delaySuppliedValueRemoteGetter(W,S,function(E){var F=[];if(E){E=E.entryList;for(var e=0;e<E.length;e++){var k=new ValueTextModel,n=E[e];k.setText(n.text);k.setValue(n.value);F.push(k)}}l.setSuppliedValue(F);l.setSelectedValue(null);l.fireSelectedValueChanged();T&&T(N)})}};q.FilterComboBoxSearch=function(b,m){var l=this;p.call(l,b,m);var y=this.protectedMethod,v,S,Q=[],X;this.createUI=function(e){v||T();var k=v.getJqUi();y.createUiWithLabel(e,k)};this.createUIWithoutLabel=function(e){T();
X.setItemModel(Q);var k=v.getJqUi();y.createUiWithLabel2(e,k)};this.setEnabled=function(e){v&&v.setEnabled(e)};var T=function(){X=new fa;X.setListItemPainter(W);X.setSearchListener(N);v=new ea;b.isEditable()&&v.setEditable(!0,function(e){if(!e||""==e&&b.isRequired())return null;for(var k=0,n=Q.length;k<n;k++)if(Q[k].getText()==e)return Q[k];k=new ValueTextModel;k.setText(e);k.setValue(e);return k});b.isReadOnly()&&v.setEnabled(!1);v.setDropdownCreator(function(e,k,n){return X.createJqPopup(e,k,n)});
v.addSelectionListener(l.fireSelectedValueChanged);v.setCustomPainter(function(e,k){k.text(e?e.getText():"")})},N=function(e,k,n,t,f){k=k.toLowerCase().trim();for(var c=[],d,u=0;u<e.length;u++)(d=-1!=e[u].getText().toLowerCase().indexOf(k)?!0:!1)&&c.push(e[u]);n.children().remove();if(0<c.length){for(u=0;u<c.length;u++)f(c[u],n,t);c.length=0}else e=new oa,e.setText(Z.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c")),e.setEnabled(!1),e.setAlign(oa.ALIGN_CENTER),e=e.getJqUi(),
e.addClass("extreport-runtime-filter-field-popup-search-result"),e.appendTo(n)},W=function(e,k,n){var t=$("<div>");t.addClass("extreport-runtime-filter-field-popup-list-item");t.data("model",e);var f=e?e.getText():"",c=$("<span>");c.text(f);c.attr("title",f);c.addClass("extreport-runtime-filter-field-popup-list-item-text");t.append(c);k.append(t);n&&n.getText()==e.getText()&&E(k,t)},E=function(e,k){var n=null;0<e.height()?(clearTimeout(n),k.addClass("extreport-runtime-filter-list-item_selected_enabled"),
e.prop("scrollTop",0)):n=setTimeout(function(){E(e,k)},0)};this.setSuppliedValue=function(e){v||T();if(e){var k=l.getParamDescription(),n=k.getCtrlType();k=k.isRequired();"combobox"!=n.toLowerCase()||k||(n=new ValueTextModel,n.setValue(""),n.setText(""),e.unshift(n));X.setItemModel(e);Q=e}};this.setSelectedValue=function(e){var k;e&&0<e.length&&(k=e[0]);v||T();k?F(k):(e=new ValueTextModel,e.setText(""),F(e))};this.getSelectedValue=function(){v||T();var e=v.getSelectedModel();if(e){var k=new ValueTextModel;
k.setValue(e.getValue());k.setText(e.getText());return[k]}return[]};this.setSuppliedValueDescription=function(e){S=e};this.resetSuppliedValue=function(e,k){var n=l.getParamDescription().getName();l.getContext().delaySuppliedValueRemoteGetter(n,S,function(t){var f=[];if(t){t=t.entryList;for(var c=0;c<t.length;c++){var d=new ValueTextModel,u=t[c];d.setText(u.text);d.setValue(u.value);f.push(d)}}l.setSuppliedValue(f);l.setSelectedValue(null);l.fireSelectedValueChanged();e&&e(k)})};var F=function(e){for(var k=
e,n=0,t=Q.length;n<t;n++)if(Q[n].getValue()==e.getValue()){k=Q[n];break}v.setSelectedModel(k)}};q.FilterForwardSelector=function(b,m){p.call(this,b,m);var l=this,y=this.protectedMethod,v,S=[],Q=[],X=!0,T;this.createUI=function(e){v||N();var k=v.getJqUi();y.createUiWithLabel(e,k)};this.createUIWithoutLabel=function(e){N();var k=v.getJqUi();y.createUiWithLabel2(e,k)};this.setEnabled=function(e){v&&v.setEnabled(e)};this.setSuppliedValueInner=function(e){X=!1;S=e};this.setSuppliedValue=function(e){};
this.setSelectedValue=function(e){v||N();e&&0==e.length?v.setModel(null):v.setModel(e);l.fireSelectedValueChanged()};this.getSelectedValue=function(){return v&&v.getModel()?v.getModel():[]};this.setSuppliedValueDescription=function(e){T=e};this.resetSuppliedValue=function(e,k){X=!0;v&&v.setModel(null);l.fireSelectedValueChanged();e&&e(k)};var N=function(){v=new Fa;v.setClearable(!0);b.isEditable()&&v.setEditable(!0,function(e){if(!e||""==e)return null;for(var k=[],n=0,t=S.length;n<t;n++)if(S[n].getText()==
e){k.push(S[n]);break}0==k.length&&(n=new ValueTextTreeNodeModel,n.setText(e),n.setValue(e),k.push(n));return k});b.isReadOnly()&&v.setEnabled(!1);v.addActionListener(F);v.setCustomPainter(function(e){var k="";if(!e)return k;for(var n=e.length,t=3>n?n:3,f=0;f<t;f++)k+=e[f].getText(),f<t-1&&(k+="; ");3<n&&(k=Z.get("selectNumInTotal","#1\u7b49#2\u9879").replace("#1",k),k=k.replace("#2",n));return k})},W=function(e){e=new va;e.setSelectabledItems(S);e.setSelected(v.getModel());e.setMultiSelect(l.getParamDescription().isMultiSelectable());
e.setConfirmCallback(function(k){v.setModel(k);l.fireSelectedValueChanged()});e.setTreeNodeStyle(l.getParamDescription().isTree());e.setTreeExpandLevel(l.getParamDescription().getTreeExpandLevel());e.setMaxSelect(l.getParamDescription().getMaxRestrictNumber());e.setNoPermFieldIndex(Q);e.showDialog();e=e.getPanel();(e instanceof com.kingdee.bos.extreport.runtime.filter.MultiValueDiscreteTableFilterPanel||e instanceof com.kingdee.bos.extreport.runtime.filter.SingleValueDiscreteTableFilterPanel)&&e.updateTable()},
E=function(e,k,n){for(var t=0;t<e.length;t++){var f=e[t];f.setLevel(k);n.push(f);(f=f.getChildren())&&E(f,k+1,n)}},F=function(e){X?(e=l.getParamDescription().getName(),l.getContext().delaySuppliedValueRemoteGetter(e,T,function(k){Q=k?k.noPermFieldIndex:[];if(k){var n=k.entryList;S=[];for(var t,f,c=0;c<n.length;c++)t=n[c],f=new ValueTextTreeNodeModel,f.setText(t.text),f.setValue(t.value),f.setId(t.id),f.setParentId(t.parentId),f.setEntry(t.rows),f.setEntryHeadMap(k.head),S.push(f);if(l.getParamDescription().isTree()){k=
S;if(!(k instanceof Array))throw Error("Illegal argument. Argument should be instance of Array.");if(k&&0!=k.length){if(!(k[0]instanceof ValueTextTreeNodeModel))throw Error("Illegal argument. Elements in Array should be instance of ValueTextTreeNodeModel.");n=new ValueTextTreeModel;n.buildTree(k);k=n.getRootArray();n=[];E(k,0,n);S=n}else S=void 0}}W()})):W()}};q.FilterNumberInput=function(b,m){var l=this;p.call(this,b,m);var y,v=this.protectedMethod;this.createUI=function(Q){y||S();var X=y.getJqUi(),
T=X.find(".sa-ctrl-spinner-text");T&&T.css("background-color","#fafafa");v.createUiWithLabel(Q,X)};var S=function(){y=new M;y.supportDecimal(2);b.isReadOnly()&&y.setEnabled(!1);y.addValueChangedListener(l.fireSelectedValueChanged)};this.setSuppliedValue=function(Q){y||S();var X=Q.getMin(),T=Q.getMax();Q=Q.getStep();y.setConstraint(X?Number(X):-Infinity,T?Number(T):Infinity,Q?Number(Q):1)};this.setDefaultValue=function(Q){};this.setSelectedValue=function(Q){Q&&0<Q.length&&(Q=Q[0],y||S(),y.setValue(Number(Q.getValue())))};
this.getSelectedValue=function(){y||S();var Q=new ValueTextModel;Q.setValue(y.getValue()+"");Q.setText(Q.getValue());return[Q]}};q.FilterDate=function(b,m){var l=this;p.call(this,b,m);var y,v,S=this.protectedMethod;this.createUI=function(N){y||Q();var W=y.getJqUi();S.createUiWithLabel(N,W)};var Q=function(){y=new P;y.setSelectedNullable(!0);y.addModelChangedListener(l.fireSelectedValueChanged);b.isReadOnly()&&y.setEnabled(!1)};this.setSuppliedValue=function(N){};this.setSelectedValue=function(N){N&&
0<N.length?(N=N[0],(N=N.getValue())&&"string"==typeof N&&X(N)):X("")};this.getSelectedValue=function(){var N=T(),W=new ValueTextModel;W.setValue(N);W.setText(W.getValue());return[W]};var X=function(N){y||Q();if(N){if(-1<N.indexOf("-")){var W=N.split("-");if(3>W.length)return;N=parseInt(W[0]);var E=parseInt(W[1]);W=parseInt(W[2]);var F=new Date;F.setYear(N);F.setMonth(E-1);F.setDate(W)}else F=new Date(Number(N));y.setDateObject(F)}else y.setDateObject(null)},T=function(){if(!y)return"";var N=y.getDateObject();
if(!N)return"";v||(v=new J,v.setFormatString("yyyy-MM-dd"));return v.format(N)}};q.FilterSimilarDate=function(b,m){function l(n,t,f){Q.call(this,Z.get("month","\u6708"),new ta,n,t,f);var c=this;c.setOkBtnListener(function(d){if(d instanceof ta){var u=d.getSelectedYear();d=d.getSelectedMonth();f(10>d?u+"-0"+d:u+"-"+d)}});setTimeout(function(){var d=c.getPanel();if(d instanceof ta){var u=t?t:F((new Date).getTime()+""),w=u?parseInt(u.substring(0,4)):(new Date).getFullYear();u=u?parseInt(u.substring(5)):
(new Date).getMonth()+1;d.setSelectedYear(w);d.setSelectedMonth(u);d.scrollSelectedToVisible()}},0);return[230,300]}function y(n,t,f){Q.call(this,Z.get("quarter","\u5b63"),new ja,n,t,f);var c=this;c.setOkBtnListener(function(d){if(d instanceof ja){var u=d.getSelectedYear();d=d.getSelectedQuarter();u=ja.toDateRange(u,d);f(F(u[0]+""))}});setTimeout(function(){var d=c.getPanel();if(d instanceof ja){var u=t?t:F((new Date).getTime()+""),w=parseInt(u.substring(0,4));u=parseInt(u.substring(6))-1;d.setSelectedYear(w);
d.setSelectedQuarter(u);d.scrollSelectedToVisible()}},0);return[230,300]}function v(n,t,f){Q.call(this,Z.get("year","\u5e74"),new S,n,t,f);var c=this;c.setOkBtnListener(function(d){d instanceof S&&(d=d.getDateRange(),f(F(d[0]+"")))});setTimeout(function(){var d=c.getPanel();if(d instanceof S){var u=t?t:F((new Date).getTime()+"");d.setDateRange(u);d.into()}},0);return[230,300]}function S(){var n;this.getJqUi=function(){return t().getJqUi()};this.setDateRange=function(f,c){f=(f?new Date(f):new Date).getFullYear();
t().setSelecteds([f])};this.getDateRange=function(){var f=t().getSelecteds()[0],c=new Date;c.setFullYear(f,0,1);c.setHours(0,0,0,0);var d=new Date;d.setFullYear(f,11,31);d.setHours(23,59,59,999);return[c.getTime(),d.getTime()]};this.into=function(){t().scrollSelectedToVisible()};var t=function(){if(!n){for(var f=[],c=1970;2099>=c;c++)f.push(c);n=new ia;n.setToggleSelectingEnabled(!1);n.setBorderVisible(!1);n.setItemModels(f)}return n}}function Q(n,t,f,c,d){var u=t.getJqUi();c=$("<div>");c.addClass("sa-ctrl-date-foot");
c.css({background:"#fff"});f.append(u);f.append(c);L.layoutCtrlWithLRTB(u,0,0,null,0,32,null);L.layoutCtrlWithLRTB(c,0,0,null,null,0,32);f=new xa;f.setText(Z.get("clean","\u6e05\u7a7a"));f.addActionListener(function(a){d(null)});f.getJqUi().appendTo(c);L.layoutCtrlWithLRTB(f.getJqUi(),6,null,40,null,5,22);f=new xa;"en"==I.getUrlParamValue("language")?f.setText("Now"):f.setText(Z.get("this","\u672c")+n);f.addActionListener(function(a){d(F((new Date).getTime()+""))});f.getJqUi().appendTo(c);L.layoutCtrlCenterAlign(f.getJqUi(),
40);L.layoutCtrlMiddleAlign(f.getJqUi(),22);var w=new xa;w.setText(Z.get("ok","\u786e\u5b9a"));w.getJqUi().appendTo(c);L.layoutCtrlWithLRTB(w.getJqUi(),null,6,40,null,5,22);this.setOkBtnListener=function(a){w.addActionListener(function(g){a(t)})};this.getPanel=function(){return t}}p.call(this,b,m);var X=this,T=this.protectedMethod,N,W;this.createUI=function(n){N||E();T.createUiWithLabel(n,N.getJqUi())};this.createUIWithoutLabel=function(n){E();T.createUiWithLabel2(n,N.getJqUi())};this.setEnabled=
function(n){N&&N.setEnabled(n)};var E=function(){N=new ea;b.isReadOnly()&&N.setEnabled(!1);N.setIconName("calendar");b.getDefaultValue();var n=N,t=n.setSelectedModel,f;(f=b.getDefaultValue())&&0<f.length?(f=f[0].getValue(),f=F(f)):f="";t.call(n,f);N.setCustomPainter(e);N.setDropdownCreator(k());N.addSelectionListener(X.fireSelectedValueChanged)};this.setSuppliedValue=function(n){};this.setSelectedValue=function(n){N||E();n&&0<n.length&&(n=n[0],n=n.getValue(),N.setSelectedModel(F(n)))};this.protectedGetFormatString=
function(){var n=b.getPattern();return ReportParamDescription.Y_M_PATTERN===n?ReportParamDescription.Y_M_PATTERN:ReportParamDescription.Y_Q_PATTERN===n?ReportParamDescription.Y_Q_PATTERN:ReportParamDescription.Y_PATTERN===n?ReportParamDescription.Y_PATTERN:ReportParamDescription.Y_M_D_PATTERN};var F=function(n){if(n&&"string"==typeof n){var t=new J;t.setFormatString(X.protectedGetFormatString());return 0>n.indexOf("-")?t.format(Number(n)):t.format(n)}return""},e=function(n,t){t.text(n);W=n};this.getSelectedValue=
function(){var n=b.getPattern(),t=new ValueTextModel;if(W&&4<=W.length){var f=W.substring(0,4);if(ReportParamDescription.Y_M_PATTERN===n)n=W.substring(5,7);else if(ReportParamDescription.Y_Q_PATTERN===n)n=W.substring(6),n=3*parseInt(n);else if(ReportParamDescription.Y_PATTERN===n)n=12;else throw Error(n+"type will be implemented");var c=parseInt(n);switch(c){case 1:case 3:case 5:case 7:case 8:case 10:case 12:10>c&&(n="0"+c);n+="-31";break;case 4:case 6:case 9:case 11:10>c&&(n="0"+c);n+="-30";break;
case 2:n="0"+c,n=0==parseInt(f)%4&&0!=parseInt(f)%400?n+"-29":n+"-28"}t.setValue(f+"-"+n);t.setText(t.getValue())}return[t]};var k=function(){var n=b.getPattern();if(ReportParamDescription.Y_M_PATTERN===n)return l;if(ReportParamDescription.Y_Q_PATTERN===n)return y;if(ReportParamDescription.Y_PATTERN===n)return v;throw Error(n+"type will be implemented");}};q.FilterDateAndTime=function(b,m){var l=this;p.call(this,b,m);var y,v,S=this.protectedMethod;this.createUI=function(N){y||Q();var W=y.getJqUi();
S.createUiWithLabel(N,W)};var Q=function(){y=new da;y.setSelectedNullable(!0);y.isSelectedNullable(!0);y.addModelChangedListener(l.fireSelectedValueChanged);b.isReadOnly()&&y.setEnabled(!1)};this.setSuppliedValue=function(N){};this.setSelectedValue=function(N){N&&0<N.length?(N=N[0],(N=N.getValue())&&"string"==typeof N&&X(N)):X("")};this.getSelectedValue=function(){var N=T(),W=new ValueTextModel;W.setValue(N);W.setText(W.getValue());return[W]};var X=function(N){y||Q();if(N){if(-1<N.indexOf("-")){var W=
N.split(" ");if(2>W.length)return;N=W[1];var E=W[0].split("-"),F=N.split(":");if(3>E.length||3>F.length)return;N=parseInt(E[0]);W=parseInt(E[1]);E=parseInt(E[2]);var e=parseInt(F[0]),k=parseInt(F[1]);F=parseInt(F[2]);var n=new Date;n.setYear(N);n.setMonth(W-1);n.setDate(E);n.setHours(e);n.setMinutes(k);n.setSeconds(F)}else n=new Date(Number(N));y.setDateObject(n)}else y.setDateObject(null)},T=function(){if(!y)return"";var N=y.getDateObject();if(!N)return"";v||(v=new J,v.setFormatString("yyyy-MM-dd HH:mm:ss"));
return v.format(N)}};q.FilterTime=function(b,m){var l=this;p.call(this,b,m);var y,v,S=this.protectedMethod;this.createUI=function(T){y||Q();var N=y.getJqUi();S.createUiWithLabel(T,N)};this.setSuppliedValue=function(T){};this.setSelectedValue=function(T){T&&0<T.length?(T=T[0],(T=T.getValue())&&"string"==typeof T&&X(T)):X("")};this.getSelectedValue=function(){var T=new ValueTextModel,N=T.setValue;if(!y||y.isSelectedNull())var W="";else v||(v=new J,v.setFormatString("HH:mm:ss")),W=new Date,W.setHours(y.getHour()),
W.setMinutes(y.getMinute()),W.setSeconds(y.getSecond()),W=v.format(W);N.call(T,W);T.setText(T.getValue());return[T]};var Q=function(){y=new ka;y.setSelectedNullable(!0);y.setSelected(null);y.addSelectionListener(l.fireSelectedValueChanged);b.isReadOnly()&&y.setEnabled(!1)},X=function(T){y||Q();if(T)if(-1<T.indexOf(":")){var N=T.split(":");if(!(3>N.length)){T=parseInt(N[0]);var W=parseInt(N[1]);N=parseInt(N[2]);y.setSelected(T,W,N)}}else T=new Date(Number(T)),y.setSelected(T.getHours(),T.getMinutes(),
T.getSeconds());else y.setSelected(null)}};q.FilterCheckBoxGroup=function(b,m){var l=this;p.call(l,b,m);var y=this.protectedMethod,v,S=[],Q={},X,T;this.createUI=function(F){T=F;v||N();var e=[];v.getJqUi().css({overflow:"hidden"});e.push(v.getJqUi());for(var k=0,n=S.length;k<n;k++)e.push(S[k].getJqUi());y.createUiWithFieldset(F,e)};this.setSuppliedValue=function(F){S=[];Q={};if(F)for(var e=0,k=F.length;e<k;e++){var n=E(F[e]);n&&S.push(n)}};this.setSelectedValue=function(F){W();for(var e=0,k=S.length,
n=0,t=F.length;n<t;n++)for(var f=F[n].getValue().split(";"),c=0;c<f.length;c++)for(var d=f[c],u=0;u<k;u++){var w=S[u];w.getUserObject().getValue()==d&&(e++,b.isReadOnly()&&w.getJqUi().addClass("rpt-filter-togglebutton-important-disabled"),w.setSelected(!0))}F=e==k;v||N();v.setSelected(F);F&&W();l.fireSelectedValueChanged()};this.getSelectedValue=function(){for(var F=[],e=v?v.isSelected():!1,k=0,n=S.length;k<n;k++){var t=S[k];if(e||t.isSelected()){t=t.getUserObject();var f=new ValueTextModel;f.setValue(t.getValue());
f.setText(t.getText());F.push(f)}}return F};this.setSuppliedValueDescription=function(F){X=F};this.resetSuppliedValue=function(F,e){var k=l.getParamDescription().getName();l.getContext().delaySuppliedValueRemoteGetter(k,X,function(n){var t=[];if(n){n=n.entryList;for(var f=0;f<n.length;f++){var c=new ValueTextModel,d=n[f];c.setText(d.text);c.setValue(d.value);t.push(c)}}l.setSuppliedValue(t);T&&(T.empty(),N(),l.createUI(T));l.setSelectedValue([]);l.fireSelectedValueChanged();F&&F(e)})};var N=function(){v=
new U;b.isReadOnly()&&v.setEnabled(!1);v.setText(Z.get("noLimit","\u4e0d\u9650"));v.setTooltips(Z.get("noLimit","\u4e0d\u9650"));v.addActionListener(function(F,e){e?W():F.setSelected(!0);l.fireSelectedValueChanged()})},W=function(){for(var F=0,e=S.length;F<e;F++)S[F].setSelected(!1)},E=function(F){var e=F.getValue();if(!Q[e]){Q[e]="1";e=F.getText();var k=new U;k.setUserObject(F);k.setText(""===e?Z.get("emptyText","\uff08\u7a7a\uff09"):e);k.setTooltips(""===e?Z.get("emptyText","\uff08\u7a7a\uff09"):
e);k.getJqUi().css({"max-width":"230px","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"});b.isReadOnly()&&k.setEnabled(!1);k.addActionListener(function(n,t){v&&(t&&v.setSelected(!1),l.fireSelectedValueChanged())});return k}}};q.FilterLabel=function(b,m){p.call(this,b,m);var l=this.protectedMethod,y=$(b.getDefaultValue()[0].getValue()).css({padding:"0 0.2em",fontSize:"12px",marginLeft:"0.2em",lineHeight:"1.7em",verticalAlign:"middle",color:"#666"});this.createUI=function(v){l.createUiWithLabel2(v,
y)};this.setSuppliedValue=function(v){};this.setSelectedValue=function(v){var S;v&&0<v.length&&(S=v[0].getValue());y.attr("value",S)};this.getSelectedValue=function(){var v=y.attr("value"),S=new ValueTextModel;S.setValue(v);S.setText(v);return[S]}};q.FilterSwitch=function(b,m){var l=this;p.call(this,b,m);var y=this.protectedMethod,v,S,Q;this.createUI=function(T){v||X();var N=v.getJqUi();y.createUiWithLabel(T,N)};this.createUIWithoutLabel=function(T){X();var N=S?S.getText():"",W=Q?Q.getText():"";v.setText(N,
W);N=v.getJqUi();y.createUiWithLabel2(T,N)};this.setEnabled=function(T){v&&v.setEnabled(T)};var X=function(){v=new H;b.isReadOnly()&&v.setEnabled(!1);v.addStateChangeListener(l.fireSelectedValueChanged)};this.setSuppliedValue=function(T){v||X();T?(S=T.getChecked(),Q=T.getUnchecked()):Q=S=void 0;T=S?S.getText():"";var N=Q?Q.getText():"";v.setText(T,N)};this.setSelectedValue=function(T){var N;T&&0<T.length&&(N=T[0]);N&&(v||X(),T=Q&&Q.getValue()==N.getValue(),v.setOn(!T))};this.getSelectedValue=function(){v||
X();var T=v.isOn()?S:Q;if(T){var N=new ValueTextModel;N.setValue(T.getValue());N.setText(T.getText());return[N]}return[]}};q.AbstractFilterCtrl=p;var C,M,P,da,U,ka,I,J,Z,oa,ta,ja,va,Fa,wa,fa,ea,xa,ia,ra,H,L,A,B;(function(){var b=com.kingdee.bos.qing.ui.component;C=b.TextField;M=b.Spinner;U=b.ToggleButton;xa=b.WorkButton;ia=b.List;ra=b.HelpIcon;b=com.kingdee.bos.qing;I=b.Seer;b=com.kingdee.bos.qing.common;J=b.DateFormater;L=b.DomUtil;A=b.TextMeasurer;b=com.kingdee.bos.qing.framework.common;Z=b.MultilanguageManager.createPackageAccessor(q);
B=b.GlobalFont;b=com.kingdee.bos.qing.ui.component;oa=b.Label;ta=b.DateOfYearMonthPanel;ja=b.DateOfYearQuarterPanel;va=q.F7Dialog;Fa=q.F7Selector;wa=q.ComboBox;ea=q.DropdownSelector;fa=q.ChooseItemPane;P=q.DateSelector;da=q.DateTimeSelector;ka=q.TimeSelector;H=q.SwitchButton})()})();(function(){function p(wa,fa){I.call(this,wa,fa);var ea=this,xa=this.protectedMethod,ia,ra,H,L,A,B,b="date",m=[],l=[],y=[],v,S,Q,X,T,N,W,E=[],F=[],e=[];this.createUI=function(a){var g=com.kingdee.bos.qing.CodeLoader;g.setCallback(function(){ia||k();xa.createUiWithLabel(a,ia)});g.loadCss("lightapp/common/qing-lapp.css")};this.setSuppliedValue=function(a){};this.setSelectedValue=function(a){ia||k();if(a&&0<a.length){a=a[0];a=a.getValue();if(b==p.DATE_Y||b==p.DATE_YQ||b==p.DATE_YM)if(a&&"string"==typeof a){var g=
new da;b==p.DATE_Y?g.setFormatString("yyyy"):b==p.DATE_YM?g.setFormatString("yyyy-MM"):b==p.DATE_YQ?g.setFormatString("yyyy-'Q'q"):g.setFormatString("yyyy-MM-dd");a=0>a.indexOf("-")?g.format(Number(a)):g.format(a)}else a="";a&&"string"==typeof a&&ra.setText(a)}else ra.setText("");ea.fireSelectedValueChanged()};this.getSelectedValue=function(){var a=ra.getText(),g=new ValueTextModel;if(b==p.DATE_Y||b==p.DATE_YQ||b==p.DATE_YM){if(a&&4<=a.length){var R=a.substring(0,4);b==p.DATE_YQ?(a=a.substring(6),
a=3*parseInt(a)):a=b==p.DATE_YM?a.substring(5):12;var D=parseInt(a);switch(D){case 1:case 3:case 5:case 7:case 8:case 10:case 12:10>D&&(a="0"+D);a+="-31";break;case 4:case 6:case 9:case 11:10>D&&(a="0"+D);a+="-30";break;case 2:a="0"+D,a=0==parseInt(R)%4&&0!=parseInt(R)%400?a+"-29":a+"-28"}a&&0<a.length?g.setValue(R+"-"+a):g.setValue(R);g.setText(g.getValue())}}else g.setValue(a),g.setText(g.getValue());return[g]};this.setSelectorType=function(a){b=a};var k=function(){ia=$("<div>");var a=$("<span>");
a.on("click",n);a.appendTo(ia);ra=new P;ra.setReadonly(!0);var g=ra.getJqUi();g.css({display:"inline-block",height:"24px","background-color":"unset",width:"189px"});g.appendTo(a);g=$("<span>");g.css({position:"absolute",width:"16px",height:"16px","margin-left":"-16px","margin-top":"3px"});b==p.TIME?M.background(g,"time"):M.background(g,"calendar");g.appendTo(a);a=$("<span>");a.css({position:"absolute",width:"16px",height:"16px","margin-left":"25px","margin-top":"3px"});Fa.background(a,"delete");a.on("click",
function(){ra.setText("")});a.appendTo(ia)},n=function(){H=$("<div>");H.addClass("extreport-card-mobile-filter-modallayer");H.css("bottom",-$(document).scrollTop());H.appendTo($("body"));L=$("<div>");L.addClass("extreport-card-mobile-sliderselector");L.appendTo(H);var a=$("<div>");a.addClass("extreport-card-mobile-sliderselector-head");a.appendTo(L);var g=$("<div>");g.addClass("extreport-card-mobile-sliderselector-head-ok");g.text(U.get("OK","\u786e\u5b9a"));g.on("click",d);g.appendTo(a);g=$("<div>");
g.addClass("extreport-card-mobile-sliderselector-head-cancel");g.text(U.get("cancel","\u53d6\u6d88"));g.on("click",u);g.appendTo(a);if(b==p.DATE_Y||b==p.DATE_YQ||b==p.DATE_YM)A||(A=$("<div>"),A.addClass("extreport-card-mobile-sliderselector-content"),A.appendTo(L)),v=t(),v.getJqUi().appendTo(A),v.setSelectedText(U.get("dateSliderSelectorYear","\u5e74")),v.setLoop(!1),b==p.DATE_YQ?(v.getJqUi().css("width","50%"),v.setSelectedTextLeftMargin(55),X=t(),X.setZeroFillBefore(!1),X.getJqUi().appendTo(A),
X.setSelectedText(U.get("dateSliderQuarter","\u5b63\u5ea6")),X.getJqUi().css("width","50%"),X.setSelectedTextLeftMargin(40)):b==p.DATE_YM?(v.getJqUi().css("width","50%"),v.setSelectedTextLeftMargin(55),S=t(),S.getJqUi().appendTo(A),S.setSelectedText(U.get("dateSliderSelectorMonth","\u6708")),S.getJqUi().css("width","50%"),S.setSelectedTextLeftMargin(40)):(v.getJqUi().css("width","100%"),v.setSelectedTextLeftMargin(55)),a=new Date,f(a),b==p.DATE_YQ?(X.setData([1,2,3,4]),X.selectDataIndex(Math.floor(a.getMonth()/
3))):b==p.DATE_YM&&c(a);else{if(b==p.DATE||b==p.DATE_TIME)A||(A=$("<div>"),A.addClass("extreport-card-mobile-sliderselector-content"),A.appendTo(L)),v=t(),S=t(),Q=t(),v.getJqUi().appendTo(A),S.getJqUi().appendTo(A),Q.getJqUi().appendTo(A),v.setSelectedText(U.get("dateSliderSelectorYear","\u5e74")),v.setChangeListener(w),v.setLoop(!1),S.setSelectedText(U.get("dateSliderSelectorMonth","\u6708")),S.setChangeListener(w),Q.setSelectedText(U.get("dateSliderSelectorDay","\u65e5")),Q.setChangeListener(w),
v.setSelectedTextLeftMargin(52),S.setSelectedTextLeftMargin(35),Q.setSelectedTextLeftMargin(35),a=new Date,f(a),c(a),y=[],w(),Q.setData(y),Q.selectDataIndex(a.getDate()-1);if(b==p.TIME||b==p.DATE_TIME){A||(A=$("<div>"),A.addClass("extreport-card-mobile-sliderselector-content"),A.appendTo(L));T=t();N=t();W=t();T.getJqUi().appendTo(A);N.getJqUi().appendTo(A);W.getJqUi().appendTo(A);T.setSelectedText(U.get("timeSliderSelectorHour","\u65f6"));N.setSelectedText(U.get("timeSliderSelectorMinute","\u5206"));
W.setSelectedText(U.get("timeSliderSelectorSecond","\u79d2"));T.setSelectedTextLeftMargin(35);N.setSelectedTextLeftMargin(35);W.setSelectedTextLeftMargin(35);E=[];F=[];e=[];a=new Date;for(g=0;60>g;g++)24>g&&E.push(g),F.push(g),e.push(g);T.setData(E);T.selectDataIndex(a.getHours());N.setData(F);N.selectDataIndex(a.getMinutes());W.setData(e);W.selectDataIndex(a.getSeconds())}}a:if(a=ra.getText(),b==p.DATE_Y||b==p.DATE_YQ||b==p.DATE_YM)b==p.DATE_Y?v&&v.selectDataIndex(parseInt(a)-1800):b==p.DATE_YQ?
(g=a.substring(0,4),a=a.split("Q"),a=a[1],v&&v.selectDataIndex(parseInt(g)-1800),X&&X.selectDataIndex(parseInt(a)-1)):b==p.DATE_YM&&(g=a.substring(0,4),a=a.split("-"),a=a[1],v&&v.selectDataIndex(parseInt(g)-1800),S&&S.selectDataIndex(parseInt(a)-1));else if(a){if(b==p.DATE_TIME){g=a.split(" ");if(2>g.length)break a;var R=g[0];g=g[1]}else g=R=a;if(-1==a.indexOf("-")&&-1==a.indexOf(":"))a=new Date(Number(a));else{a=new Date;var D=R;R=a;if(-1<D.indexOf("-")){var h=D.split("-");if(!(3>h.length)){D=parseInt(h[0]);
var G=parseInt(h[1]);h=parseInt(h[2]);R.setYear(D);R.setMonth(G-1);R.setDate(h)}}R=g;g=a;-1<R.indexOf(":")&&(G=R.split(":"),3>G.length||(R=parseInt(G[0]),D=parseInt(G[1]),G=parseInt(G[2]),g.setHours(R),g.setMinutes(D),g.setSeconds(G)))}v&&v.selectDataIndex(a.getFullYear()-1800);S&&S.selectDataIndex(a.getMonth());Q&&Q.selectDataIndex(a.getDate()-1);T&&T.selectDataIndex(a.getHours());N&&N.selectDataIndex(a.getMinutes());W&&W.selectDataIndex(a.getSeconds())}},t=function(){var a=com.kingdee.bos.qing.lapp.component.EventAction.isMobile()?
new com.kingdee.bos.qing.lapp.component.Slider:new com.kingdee.bos.qing.lapp.component.DeskSlider;b==p.DATE_TIME&&a.setWidth("16%");return a},f=function(a){m=[];for(var g=1800;2800>=g;g++)m.push(g);v.setData(m);v.selectDataIndex(a.getFullYear()-1800)},c=function(a){l=[];for(var g=1;12>=g;g++)l.push(g);S.setData(l);S.selectDataIndex(a.getMonth())},d=function(){var a=v?v.getValue():0,g=S?S.getValue():0,R=Q?Q.getValue():0,D=X?X.getValue():0,h=T?T.getValue():0,G=N?N.getValue():0,O=W?W.getValue():0;if(b==
p.DATE_Y||b==p.DATE_YQ||b==p.DATE_YM){if(b==p.DATE_Y){g=12;var aa="yyyy"}else b==p.DATE_YQ?(g=3*D,aa="yyyy-'Q'q"):aa=b==p.DATE_YM?"yyyy-MM":"yyyy-MM-dd";a=new Date(a,g,R,h,G,O)}else a=new Date(a,g-1,R,h,G,O);B||(B=new da,b==p.DATE?aa="yyyy-MM-dd":b==p.TIME?aa="HH:mm:ss":b==p.DATE_TIME&&(aa="yyyy-MM-dd HH:mm:ss"),B.setFormatString(aa));ra.setText(B.format(a));ea.fireSelectedValueChanged();H.remove();A=null},u=function(){H.remove();A=null},w=function(){var a=v.getValue(),g=S.getValue();a=(new Date(a,
g,0)).getDate();g=Q.getDataIdx();if(a!=y.length){y=[];for(var R=1;R<=a;R++)y.push(R);Q.setData(y);Q.selectDataIndex(g)}}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.filter&&(com.kingdee.bos.extreport.runtime.filter=
{});var q=com.kingdee.bos.extreport.runtime.filter;q.FilterComboBoxMobile=function(wa,fa){var ea=this;I.call(ea,wa,fa);var xa=this.protectedMethod,ia,ra,H=[];this.createUI=function(B){ia||L();var b=ia.getJqUi();xa.createUiWithLabel(B,b);b.css({height:"30px","line-height":"30px"});B.find(".extreport-runtime-filter-combobox-text").css("margin-top","-17px")};var L=function(){ia=new ka;wa.isEditable()&&ia.setEditable(!0,function(B){if(!B||""==B&&wa.isRequired())return null;for(var b=0,m=H.length;b<m;b++)if(H[b].getText()==
B)return H[b];b=new ValueTextModel;b.setText(B);b.setValue(B);return b});ia.setCustomPainter(function(B,b,m){b.css({height:"30px","line-height":"30px"});m&&b.text(m.getText())});ia.addSelectedChangedListener(ea.fireSelectedValueChanged)};this.setSuppliedValue=function(B){ia||L();if(B){var b=ea.getParamDescription(),m=b.getCtrlType();b=b.isRequired();"combobox"!=m.toLowerCase()||b||(m=new ValueTextModel,m.setValue(""),m.setText(""),B.unshift(m));ia.setItemModels(B,function(l,y){return l&&y?l.getValue()==
y.getValue():!1});H=B}};this.setSelectedValue=function(B){var b;B&&0<B.length&&(b=B[0]);ia||L();b?A(b):(B=new ValueTextModel,B.setText(""),A(B))};this.getSelectedValue=function(){ia||L();var B=ia.getSelected();if(B){var b=new ValueTextModel;b.setValue(B.getValue());b.setText(B.getText());return[b]}return[]};this.setSuppliedValueDescription=function(B){ra=B};this.resetSuppliedValue=function(B,b){var m=ea.getParamDescription().getName();ea.getContext().delaySuppliedValueRemoteGetter(m,ra,function(l){var y=
[];if(l){l=l.entryList;for(var v=0;v<l.length;v++){var S=new ValueTextModel,Q=l[v];S.setText(Q.text);S.setValue(Q.value);y.push(S)}}ea.setSuppliedValue(y);ea.setSelectedValue(null);ea.fireSelectedValueChanged();B&&B(b)})};var A=function(B){for(var b=B,m=0,l=H.length;m<l;m++)if(H[m].getValue()==B.getValue()){b=H[m];break}ia.setSelected(b)}};q.FilterForwardSelectorMobile=function(wa,fa){I.call(this,wa,fa);var ea=this,xa=this.protectedMethod,ia,ra,H,L,A,B,b=[],m,l=!0,y,v=ea.getParamDescription().getMaxRestrictNumber();
this.createUI=function(k){var n=com.kingdee.bos.qing.CodeLoader;n.setCallback(function(){ia||S();xa.createUiWithLabel(k,ia)});n.loadCss("lightapp/common/qing-lapp.css")};this.setSuppliedValue=function(k){};this.setSelectedValue=function(k){ia||S();k&&0==k.length?B=null:(B=k,ra.setText(N(B)));ea.fireSelectedValueChanged()};this.getSelectedValue=function(){return B?B:[]};this.setSuppliedValueDescription=function(k){y=k};this.resetSuppliedValue=function(k,n){l=!0;B=null;ra&&ra.setText(N(B));ea.fireSelectedValueChanged();
k&&k(n)};var S=function(){ia=$("<div>");var k=$("<span>");k.appendTo(ia);ra=new P;ra.setReadonly(!wa.isEditable());ra.addAcceptableListener(T);var n=ra.getJqUi();n.css({display:"inline-block",height:"24px","background-color":"unset",width:"189px"});n.find(".sa-ctrl-textfield-input").css({width:"173px","text-overflow":"ellipsis"});n.appendTo(k);n=$("<span>");n.css({position:"absolute",width:"16px",height:"16px","margin-left":"-16px","margin-top":"3px"});Fa.background(n,"search");n.on("click",F);n.appendTo(k);
k=$("<span>");k.css({position:"absolute",width:"16px",height:"16px","margin-left":"25px","margin-top":"3px"});Fa.background(k,"delete");k.on("click",function(){ra.setText("")});k.appendTo(ia)},Q=function(){H=$("<div>");H.addClass("extreport-card-mobile-filter-modallayer");H.css("bottom",-$(document).scrollTop());H.appendTo($("body"));L=$("<div>");L.addClass("extreport-card-mobile-sliderselector");L.css("max-height","480px");L.appendTo(H);var k=$("<div>");k.addClass("extreport-card-mobile-sliderselector-head");
k.appendTo(L);var n=$("<div>");n.addClass("extreport-card-mobile-sliderselector-head-ok");n.text(U.get("OK","\u786e\u5b9a"));n.on("click",X);n.appendTo(k);n=$("<div>");n.addClass("extreport-card-mobile-sliderselector-head-cancel");n.text(U.get("cancel","\u53d6\u6d88"));n.on("click",W);n.appendTo(k);A||(A=$("<div>"),A.addClass("extreport-card-mobile-sliderselector-content"),A.css({height:"300px",margin:"10px 15px",width:"unset"}),A.appendTo(L));ea.getParamDescription().isTree()?m=ea.getParamDescription().isMultiSelectable()?
new ta(ea.getParamDescription().getTreeExpandLevel()):new oa(ea.getParamDescription().getTreeExpandLevel()):(k=b[0]?b[0].getEntry():null,m=ea.getParamDescription().isMultiSelectable()?k&&0<Object.keys(k).length?new ja:new Z:k&&0<Object.keys(k).length?new va:new J);m.setSelectableItems(b);m.setSelected(B);m.setMobile&&m.setMobile(!0);m.getJqUi().appendTo(A);(m instanceof com.kingdee.bos.extreport.runtime.filter.MultiValueDiscreteTableFilterPanel||m instanceof com.kingdee.bos.extreport.runtime.filter.SingleValueDiscreteTableFilterPanel)&&
m.updateTable()},X=function(){var k=m.getSelected();if(v&&!isNaN(v)&&k.length>v)return k=U.get("exceedMaxSelect","\u9009\u62e9\u6570\u91cf\u8d85\u8fc7\u9650\u5236\uff0c\u6700\u591a\u53ef\u9009#1\u4e2a\u53c2\u6570\u3002").replace("#1",v),e(k),!1;B=k;ra.setText(N(B));ea.fireSelectedValueChanged();W()},T=function(){var k;if((k=$.trim(ra.getText()))&&""!=k){for(var n=[],t=0,f=b.length;t<f;t++)if(b[t].getText()==k){n.push(b[t]);break}0==n.length&&(t=new ValueTextTreeNodeModel,t.setText(k),t.setValue(k),
n.push(t));k=n}else k=null;B=k;ra.setText(N(B))},N=function(k){var n="";if(!k)return n;for(var t=k.length,f=3>t?t:3,c=0;c<f;c++)n+=k[c].getText(),c<f-1&&(n+="; ");3<t&&(n=U.get("selectNumInTotal","#1\u7b49#2\u9879").replace("#1",n),n=n.replace("#2",t));return n},W=function(){H.remove();L.remove();A=null},E=function(k,n,t){for(var f=0;f<k.length;f++){var c=k[f];c.setLevel(n);t.push(c);(c=c.getChildren())&&E(c,n+1,t)}},F=function(k){l?(k=ea.getParamDescription().getName(),ea.getContext().delaySuppliedValueRemoteGetter(k,
y,function(n){if(n){var t=n.entryList;b=[];for(var f,c,d=0;d<t.length;d++)f=t[d],c=new ValueTextTreeNodeModel,c.setText(f.text),c.setValue(f.value),c.setId(f.id),c.setParentId(f.parentId),c.setEntry(f.rows),c.setEntryHeadMap(n.head),b.push(c);if(ea.getParamDescription().isTree()){n=b;if(!(n instanceof Array))throw Error("Illegal argument. Argument should be instance of Array.");if(n&&0!=n.length){if(!(n[0]instanceof ValueTextTreeNodeModel))throw Error("Illegal argument. Elements in Array should be instance of ValueTextTreeNodeModel.");
t=new ValueTextTreeModel;t.buildTree(n);n=t.getRootArray();t=[];E(n,0,t);b=t}else b=void 0}}Q()})):Q()},e=function(k){var n=new com.kingdee.bos.qing.lapp.component.MobileDialog;n.setHeight(150);n.setTitle(U.get("remind","\u6d88\u606f\u63d0\u793a"));n.setContentCreator(function(){var t=$("<div>");t.addClass("extreport-card-mobile-msg-text");t.text(k);return t});n.showDialog()}};q.DateTimeSliderSelector=p;q.FilterNumberInputMobile=function(wa,fa){I.call(this,wa,fa);var ea=this,xa,ia=this.protectedMethod;
this.createUI=function(H){xa||ra();var L=xa.getJqUi(),A=L.find(".sa-ctrl-spinner-text");A&&A.css("background-color","#fafafa");ia.createUiWithLabel(H,L);L.css("height","30px")};var ra=function(){xa=new C;wa.isReadOnly()&&xa.setEnabled(!1);xa.addValueChangedListener(ea.fireSelectedValueChanged)};this.setSuppliedValue=function(H){xa||ra();var L=H.getMin(),A=H.getMax();H=H.getStep();xa.setConstraint(L?Number(L):-Infinity,A?Number(A):Infinity,H?Number(H):1)};this.setDefaultValue=function(H){};this.setSelectedValue=
function(H){H&&0<H.length&&(H=H[0],xa||ra(),xa.setValue(Number(H.getValue())))};this.getSelectedValue=function(){xa||ra();var H=new ValueTextModel;H.setValue(xa.getValue()+"");H.setText(H.getValue());return[H]}};var C,M,P,da,U,ka,I,J,Z,oa,ta,ja,va,Fa;(function(){var wa=com.kingdee.bos.qing.ui.component;P=wa.TextField;C=wa.Spinner;M=wa.Icons;P=wa.TextField;wa=com.kingdee.bos.qing.common;da=wa.DateFormater;wa=com.kingdee.bos.qing.framework.common;U=wa.MultilanguageManager.createPackageAccessor(q);ka=
q.ComboBox;wa=com.kingdee.bos.extreport.runtime.filter;I=wa.AbstractFilterCtrl;J=wa.SingleValueDiscreteFilterPane;Z=wa.MultiValueDiscreteFilterPane;oa=wa.SingleValueTreeFilterPane;ta=wa.MultiValueTreeFilterPane;ja=wa.MultiValueDiscreteTableFilterPanel;va=wa.SingleValueDiscreteTableFilterPanel;wa=com.kingdee.bos.extreport.runtime;Fa=wa.MyIcons})();p.TIME="time";p.DATE="date";p.DATE_TIME="datetime";p.DATE_YM="date_ym";p.DATE_YQ="date_yq";p.DATE_Y="date_y"})();function _Report(){var p,q,C,M,P,da;this.getSheet=function(U){return P[U]};this.getSheetByName=function(U){for(var ka=0;ka<P.length;ka++){var I=P[ka];if(I.getName()==U)return I}return null};this.setSheetIndex=function(U){q=U};this.getSheetIndex=function(){return q};this.setCurrentSheet=function(U){p=U};this.getCurrentSheet=function(){return p};this.setPageId=function(U){C=U};this.getPageId=function(){return C};this.setSheetNames=function(U){M=U};this.getSheetNames=function(){return M};this.setSheetColors=
function(U){da=U};this.getSheetColors=function(){return da};this.fillIn=function(U){P=[];this.setPageId(U.pageId);this.setSheetNames(U.sheetNameList);this.setSheetColors(U.sheetColorList);this.setSheetIndex(0);var ka=new Sheet;ka.setName(U.currentSheet.name);P.push(ka);ka.fillIn(U.currentSheet);for(var I=0;I<this.getSheetNames().length;I++){var J=this.getSheetNames();if(J[I]!=U.currentSheet.name){var Z=new Sheet;Z.setName(J[I]);P.push(Z)}}this.setCurrentSheet(ka)}}
function Sheet(){var p,q,C,M,P,da,U,ka,I=!1;this.setTableRowCount=function(J){p=J};this.getTableRowCount=function(){return p};this.setTableHiddenRowCount=function(J){da=J};this.getHiddenRowCount=function(){return da};this.setLoadedRowNum=function(J){q=J};this.getLoadedRowNum=function(){return q};this.setTable=function(J){M=J};this.getTable=function(){return M};this.setName=function(J){C=J};this.getName=function(){return C};this.setTree=function(J){P=J};this.isTree=function(){return P};this.getBorderStyle=
function(J){return U&&U[J]?KReportUtil.getCssBorder(U[J]):null};this.getStyle=function(J){return ka&&ka[J]?KReportUtil.getCssStyle(ka[J]):null};this.setLoadingFragment=function(J){I=J};this.getLoadingFragment=function(){return I};this.fillIn=function(J){this.setLoadedRowNum(J.tableInfo.currentLoadedRowNum);this.setTableRowCount(J.tableRowCount);this.setTableHiddenRowCount(J.tableHiddenRowCount);this.setName(J.name);this.setTree(J.isTree);U=J.tableInfo.borderStyleMap;ka=J.tableInfo.styleMap;var Z=
new KTable;Z.setUICustomStyleMap({"background-color":"transparent"});Z.setMergeBlockTextVisibleAlways(!1);"object"==typeof J.tableStyle&&Z.setStyle(KReportUtil.getCssStyle(J.tableStyle));"object"==typeof J.tableBorder&&Z.setBorder(KReportUtil.getCssBorder(J.tableBorder));"object"==typeof J.header&&(Z.setFrozenRows(J.header.row),Z.setFrozenColumns(J.header.col));Z.setAutoAdjustRowHeight(J.isResized);Z.setDraggableAdjusting(!0,-1,-1);this.setTable(Z)};this.fillInStyle=function(J){if(J.borderStyleMap){var Z=
J.borderStyleMap;for(var oa in Z)!U[oa]&&(U[oa]=Z[oa])}if(J.styleMap)for(oa in J=J.styleMap,J)!ka[oa]&&(ka[oa]=J[oa])};this.isNeedLoadTable=function(){return this.getLoadedRowNum()+1!=this.getTableRowCount()}};(function(){function p(){var C,M,P,da=!1;this.setShareStrategy=function(U){P=U};this.getShareStrategy=function(){return P};this.setCaption=function(U){C=U};this.getCaption=function(){return C};this.setValue=function(U){M=U};this.getValue=function(){return M};this.setCurrent=function(U){da=U};this.isCurrent=function(){return da};this.fromJsonObject=function(U){C=U.caption;M=U.value;P=U.shareStrategy}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&
(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.model&&(com.kingdee.bos.extreport.runtime.model={});var q=com.kingdee.bos.extreport.runtime.model;q.FilterInfo=function(){var C,M,P,da=[],U=[];this.setMapAssociate=function(ka){C=ka};this.getMapAssociate=function(){return C};this.setHasDefaultEnter=function(ka){M=
ka};this.getHasDefaultEnter=function(){return M};this.setDefaultSchemaName=function(ka){P=ka};this.getDefaultSchemaName=function(){return P};this.setSchemas=function(ka){da=ka};this.getSchemas=function(){return da};this.setParameters=function(ka){U=ka};this.getParameters=function(){return U};this.fromJsonObject=function(ka){C=ka.associate?ka.associate:null;M=ka.hasDefaultEnter;P=ka.defaultEnter;var I,J=ka.schemeList;if(J&&0<J.length)for(I=0;I<J.length;I++){var Z=new p;Z.fromJsonObject(J[I]);da.push(Z)}U=
ka.paramList}};q.SchemaInfo=p;q.ParameterInfo=function(){var C,M,P,da,U,ka;this.setName=function(I){C=I};this.getName=function(){return C};this.setText=function(I){M=I};this.getText=function(){return M};this.setRequired=function(I){P=I};this.isRequired=function(){return P};this.setState=function(I){da=I};this.isState=function(){return da};this.setDataType=function(I){U=I};this.isDataType=function(){return U};this.setDefaultValue=function(I){ka=I};this.isDefaultValue=function(){return ka};this.fromJsonObject=
function(I){C=I.name;M=I.text;P=I.required;da=I.state;U=I.dataType}};q.ExtreportWidgetInfo=function(){var C,M,P,da,U,ka,I,J,Z;this.getCardName=function(){return C};this.isDesignTime=function(){return M};this.getExhibitionScene=function(){return P};this.getIframeId=function(){return da};this.isRequireDecorateCard=function(){return U};this.isRequireOpacity=function(){return ka};this.isInWidgetPanel=function(){return I};this.getAffectedParams=function(){return J};this.getStyleMap=function(){return Z};
this.fromJsonObject=function(oa){C=oa.cardName;M=oa.isDesignTime;P=oa.exhibitionScene;da=oa.iFrameId;U=oa.isRequireDecorateCard;ka=oa.isRequireOpacity;I=oa.isInWidgetPanel;J=oa.affectedParams;Z=oa.styleMap}};q.RptRunTimeHelpInfoTip=function(C,M,P){this.getLabel=function(){return C};this.getValue=function(){return M};this.getParams=function(){return P}}})();(function(){function p(){var fa,ea=this,xa,ia;this.switchSchema=function(ra){throw Error("Override me!");};this.updateListUi=function(){throw Error("Override me!");};this.paint=function(ra){throw Error("Override me!");};this.getCurrentSchema=function(){return xa};this.setGlobal=function(ra){};this.setModels=function(ra){ia=ra};this.getJqUi=function(){if(!fa){if(!ia||0===ia.length)throw Error("no schema!");fa=$("<div>");xa=ia[0]}return fa};this.save=function(ra){for(var H=0;H<ia.length;H++)ia[H].getCaption()===
ra.getCaption()&&(xa=ia[H]=ra);ea.updateListUi()};this.saveAs=function(ra){ia.push(ra);xa=ra;ea.updateListUi()};this.remove=function(){var ra;for(ra=0;ra<ia.length&&xa.getCaption()!==ia[ra].getCaption();ra++);ia.splice(ra,1);xa=ia[0];ea.switchSchema(xa);ea.updateListUi()};this.protectedMethod={getSchemas:function(){return ia},updateCurrent:function(ra){xa=ra}}}function q(){I.call(this);var fa=this,ea=this.protectedMethod,xa,ia,ra,H,L,A;this.getJqUi=function(){xa||(xa=$("<div>"),fa.setSize(322,165),
ea.setTitle(ja.get("saveSchema","\u4fdd\u5b58\u8fc7\u6ee4\u65b9\u6848")),ea.setContentPaneCreator(B),ea.setClosingChecker(m,!0),ea.setClosingAction(b));return xa};this.setFunClosingCallBack=function(l){ra=l};this.setGlobal=function(l){};var B=function(){var l=$("<div>");H=new J;H.setRequired(!0);H.setText(ja.get("schemaName","\u65b9\u6848\u540d\u79f0"));var y=H.getJqUi();y.css({"float":"left","margin-left":"10px",width:"26%"});l.append(y);L=new Z;y=L.getJqUi();y.css({height:"20px",left:"0px",width:"66%"});
l.append(y);ia=$("<div>");ia.addClass("runtime-schema-save-as-message-tip");ia.appendTo(l);return l};this.showMessageTip=function(l){ia.text(l);A&&clearTimeout(A);A=setTimeout(function(){ia.text("")},5E3)};var b=function(){},m=function(l){var y=L.getText().trim();if(!y)return fa.showMessageTip(ja.get("nullSchemaName","\u8fc7\u6ee4\u65b9\u6848\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")),l(!1),!1;y=y.trim();y=y.replace(/(^\s*)|(\s*$)/g,"");y=y.replace(/</g,"&lt;");y=y.replace(/>/g,"&gt;");y=y.replace(/"/g,
"&quot;");y=y.replace(/'/g,"&#039;");if(20<y.length)return fa.showMessageTip(ja.get("limitSchemaNameLength","\u65b9\u6848\u540d\u79f0\u6700\u957f\u4e3a20\u4e2a\u5b57\u7b26")),l(!1),!1;if(!y)return fa.showMessageTip(ja.get("nullSchemaName","\u8fc7\u6ee4\u65b9\u6848\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")),l(!1),!1;y=ra(y);l(y)}}function C(){var fa=this,ea,xa,ia,ra,H,L,A;this.getJqUi=function(){if(!ea){ea=$("<div>");ea.addClass("runtime-schema-manage-filter");var B={},b=H.getSchemas(),m=H.getParameters(),
l=H.getMapAssociate();B.oGlobal=xa;ia=new ReportFilter(A?A:ra,B,null,L);ia.forRpcReduced(null,m,l);ia.setSchemeList(b);ia.isDispalay();B=ea;b=$("<div>");ia.render(b,fa);b.appendTo(B)}return ea};this.setGlobal=function(B){xa=B};this.setModels=function(B,b,m){ra=B;H=b;A=m};this.getParameByArr=function(B,b,m){ia.setSchemeParams(B,b,m)};this.getParameValues=function(){return ia.getDataSetParamValues()};this.updateFilterByValue=function(B,b){ia.updateFilterByScheme(B,b)};this.isDisplay=function(){return ia.isDispalay()};
this.getFilter=function(){return ia};this.isMobileScene=function(B){L=B}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.common&&(com.kingdee.bos.extreport.runtime.common={});"undefined"==
typeof com.kingdee.bos.extreport.runtime.common.ui&&(com.kingdee.bos.extreport.runtime.common.ui={});var M=com.kingdee.bos.extreport.runtime.common.ui,P={};M.FilterPanel=C;M.SchemaManagePanel=function(){var fa=this,ea,xa,ia,ra,H,L,A,B,b,m,l,y,v,S,Q=!1,X;this.getJqUi=function(){if(!ea){ea=$("<div>");ea.addClass("runtime-filter-can-hide-panel");var t={save:E,saveAs:F,remove:k};ia.getJqUi();ia.setOpFuns(t);ia.setSwitchCallBack(T);ia.paint(ea);t=ea;ra=new C;ra.isMobileScene(Q);ra.setGlobal(xa);ra.setModels(m,
y,X);ra.getJqUi().appendTo(t);t=ea;var f=$("<div>");f.addClass("runtime-schema-manage-footer");var c=$("<div>");c.addClass("runtime-schema-manage-footer-right");c.appendTo(f);L=new oa;var d=L.getJqUi();d.addClass("runtime-schema-manage-footer-right-check");d.appendTo(c);var u=da.decodeParamFromUrl(location.search,"isPreset");bIsPreset=null!=u?"false"===u?!1:!0:!1;u=$("<div>");u.text(ja.get("directEntry","\u4e0b\u6b21\u76f4\u63a5\u4ee5\u8be5\u65b9\u6848\u8fdb\u5165"));u.css({display:"inline-block"});
u.appendTo(c);if(xa.hasSchemeEditPerm&&!xa.hasSchemeEditPerm()||bIsPreset)d.hide(),u.hide();d=new ka;u=ja.get("query","\u67e5\u8be2");d.setTooltips(u);d.setText(u);d.addActionListener(A);d=d.getJqUi();d.addClass("runtime-schema-manage-footer-right-btn");d.css({"margin-left":"15px","margin-right":"10px"});d.appendTo(c);f.appendTo(t)}return ea};this.setGlobal=function(t){ia.setGlobal(t);xa=t};this.setModels=function(t,f,c,d){m=t;l=c;y=f;S=y.getSchemas();ia.setModels(y.getSchemas());v=S[0];X=d};this.getCurrentSchemaInfo=
function(){return ia.getCurrentSchema()};this.setSchemaListPanel=function(t){ia=t};this.setFunExecute=function(t){A=t};this.setFunSwitchSchemaCallBack=function(t){B=t};this.spreadOrPackUp=function(t,f){t?ea.show():ea.hide();f&&f()};this.executeWithSchema=function(t){var f=y.getMapAssociate();f&&0<Object.keys(f).length?fa.switchSchemaByName(t.getDefaultSchemaName(),function(){A()}):(fa.switchSchemaByName(t.getDefaultSchemaName()),A())};this.switchSchemaByName=function(t,f){if(S&&0<S.length)for(var c=
0;c<S.length;c++)if(t===S[c].getCaption()){var d=S[c];break}ia.switchSchema(d,f)};this.getParameValues=function(){return ra.getParameValues()};this.isDisplay=function(){return ra.isDisplay()};this.getFilter=function(){return ra.getFilter()};this.getJqFilterPanel=function(){return ra.getJqUi()};this.getDefaultCheckBoxStatus=function(){return L.isChecked()};this.setFunMobileMsgListener=function(t){b=t};this.setMobileMode=function(){Q=!0};this.getCurrentSelScheme=function(){return ia.getCurrentSchema()};
var T=function(t,f){ra.updateFilterByValue(t.getValue(),f);L&&L.setChecked(y.getHasDefaultEnter()&&t.getCaption()===y.getDefaultSchemaName());B(t.getCaption())},N=function(t,f){var c=[],d=[],u=[],w=L.isChecked(),a=y.getDefaultSchemaName()===t;ra.getParameByArr(u,d,c);c={nameParams:c,valParams:u,capParams:d};d={};d.sId=m;d.pageId=m;d.schemaBiztagId=l;d.schemeContent=JSON.stringify(c);d.isDefaultChange=w;d.schemeName=t;d.flag=1;d.cacheId=X;xa.createFacade(function(g){g.isInvalid&&n(ja.get("invalidInput",
"\u8f93\u5165\u5b57\u7b26\u542b\u6709\u975e\u6cd5\u5b57\u7b26\u3002"),"prompt");n(ja.get("opSuccess","#1\u6210\u529f\u3002").replace("#1",ja.get("save","\u4fdd\u5b58")),"success");var R=new va;R.fromJsonObject(g);f?ia.saveAs(R):ia.save(R);!a&&w&&(y.setHasDefaultEnter(!0),y.setDefaultSchemaName(R.getCaption()));a&&!w&&(y.setHasDefaultEnter(!1),y.setDefaultSchemaName(R.getCaption()))},function(g,R){return 8099001===g?(xa.getMessageCurtain().showPrompt(R),!0):8099002===g||8099007===g||8077016===g||8099008===
g||8099010<=g&&8099014>=g?(W(R),!0):!1}).saveFilterScheme(d)},W=function(t){var f=new ta;f.setOptionType(ta.OPTION_OK);f.setButtonText(ta.OPTION_OK,"\u5237\u65b0");f.setClosingChecker(function(c){c===ta.OPTION_OK&&location.replace(location.href);return!0});f.setMessage(t);f.showDialog()},E=function(t){if(t===v.getCaption())n(ja.get("cannotOpDefaultSchema","\u4e0d\u80fd#1\u9ed8\u8ba4\u65b9\u6848\u3002").replace("#1",ja.get("save","\u4fdd\u5b58")),"prompt");else{var f=y.getSchemas();if(f&&0<f.length)for(var c in f){var d=
f[c].getCaption();if(t==d&&0==f[c].getShareStrategy()){n(ja.get("cannotSaveSystemSchema","\u4e0d\u80fd\u4fdd\u5b58\u7cfb\u7edf\u9ed8\u8ba4\u65b9\u6848\u3002"),"prompt");return}}N(t,!1)}},F=function(){H=new q;H.setGlobal(xa);H.setFunClosingCallBack(e);H.getJqUi();H.showDialog()},e=function(t){if(S&&0<S.length)for(var f=S.length-1;0<=f;f--){var c=S[f];if(c&&t===c.getCaption())return H.showMessageTip(ja.get("dupSchemaName","\u8fc7\u6ee4\u65b9\u6848\u540d\u79f0\u5df2\u5b58\u5728")),!1}N(t,!0);return!0},
k=function(){var t=ia.getCurrentSchema().getCaption();if(t===v.getCaption())n(ja.get("cannotOpDefaultSchema","\u4e0d\u80fd#1\u9ed8\u8ba4\u65b9\u6848\u3002").replace("#1",ja.get("remove","\u5220\u9664")),"prompt");else{var f=y.getSchemas();if(f&&0<f.length)for(var c in f){var d=f[c].getCaption();if(t==d&&0==f[c].getShareStrategy()){n(ja.get("cannotDelSystemSchema","\u4e0d\u80fd\u5220\u9664\u7cfb\u7edf\u9ed8\u8ba4\u65b9\u6848\u3002"),"prompt");return}}f=ta.createFeedbackDialog();f.setOptionType(ta.OPTION_OK_CANCEL);
f.setMsgImageType(ta.MSG_DELETE);t=ja.get("determineToDeleteSchema","\u60a8\u786e\u8ba4\u8981\u5220\u9664\u8fc7\u6ee4\u65b9\u6848 [#1] \u5417\uff1f").replace("#1",t);var u=function(w){w&&(w={},w.dataSetId=m,w.pageId=m,w.schemaBiztagId=l,w.schemaName=ia.getCurrentSchema().getCaption(),w.flag="1",xa.createFacade(function(a){!0===a&&(n(ja.get("opSuccess","#1\u6210\u529f\u3002").replace("#1",ja.get("remove","\u5220\u9664")),"success"),ia.remove())},function(a,g){return 8099001===a?(xa.getMessageCurtain().showPrompt(g),
!0):8099002===a||8099007===a||8077016===a||8099008===a||8099010<=a&&8099014>=a?(W(g),!0):!1}).delFilterScheme(w))};b?b("CONFIRM",t,u):(f.setMessage(t),f.setClosingChecker(function(w){u(w===ta.RETURN_OK);return!0}),f.showDialog())}},n=function(t,f,c){if(b)b("MSG",t,null);else{var d=xa.getMessageCurtain();switch(f){case "success":d.showSuccess(t,c);break;case "prompt":d.showPrompt(t,c);break;case "error":d.showError(t,c);break;default:throw Error("no support this type");}}}};M.SaveAsSchemaDialog=q;
M.RuntimeSchemaListPanel=function(){p.call(this);var fa,ea=this,xa=ea.protectedMethod,ia,ra,H;this.setSwitchCallBack=function(b){H=b};this.setOpFuns=function(b){ra=b};this.paint=function(b){fa=$("<div>");fa.addClass("runtime-schema-manage-menu");ia=$("<div>");ia.addClass("runtime-schema-manage-menu-list");ia.css("float","left");var m=$("<div>");m.text(ja.get("commonUsedSchema","\u5e38\u7528\u65b9\u6848\uff1a"));m.css("display","inline-block");m.css("float","left");m.appendTo(fa);if((m=xa.getSchemas())&&
0<m.length)for(var l=0;l<m.length;l++)L(m[l],l);ia.appendTo(fa);m=$("<div>");m.css("float","right");l=da.decodeParamFromUrl(location.search,"isPreset");bIsPreset=null!=l?"false"===l?!1:!0:!1;0==bIsPreset&&(B(ja.get("remove","\u5220\u9664"),m,ra.remove),B(ja.get("saveAs","\u53e6\u5b58\u4e3a"),m,ra.saveAs),B(ja.get("save","\u4fdd\u5b58"),m,function(){ra.save(ea.getCurrentSchema().getCaption())}));m.appendTo(fa);fa.appendTo(b)};this.switchSchema=function(b,m){var l=ia.find(".runtime-schema-manage-menu-list-item-active"),
y=ia.find(".runtime-schema-manage-menu-list-item"),v=b.getCaption();xa.updateCurrent(b);l.removeClass("runtime-schema-manage-menu-list-item-active");for(l=0;l<y.length;l++){var S=$(y[l]);if(v===S.text()){S.addClass("runtime-schema-manage-menu-list-item-active");break}}H&&H(b,m)};this.updateListUi=function(){ia&&ia.remove();ia=$("<div>");ia.addClass("runtime-schema-manage-menu-list");ia.css("float","left");var b=xa.getSchemas();if(b&&0<b.length)for(var m=0;m<b.length;m++)L(b[m]);ia.appendTo(fa)};var L=
function(b){var m=$("<div>");m.text(b.getCaption());m.addClass("runtime-schema-manage-menu-list-item");m.css({"max-width":"230px","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap","margin-left":"35px","margin-bottom":"20px"});m.attr("title",b.getCaption());b.getCaption()===ea.getCurrentSchema().getCaption()&&m.addClass("runtime-schema-manage-menu-list-item-active");m.data("oSchemaInfo",b);m.on("click",A);m.appendTo(ia)},A=function(b){b=$(b.target).data("oSchemaInfo");ea.switchSchema(b)},
B=function(b,m,l){var y=$("<div>");y.addClass("runtime-schema-manage-menu-btn-op");y.text(b);y.on("click",l);y.appendTo(m)}};M.AbstractSchemaListPanel=p;M.RptHelpIconTipsUI=function(){var fa,ea,xa,ia=function(){ea||(ea=new wa,ea.setIconType(wa.ICON_TYPE_INFO),fa=ea.getJqUi(),fa.addClass("sa-rpt-helpinfo"),fa.css({position:"absolute",width:"16px",height:"16px",top:"15px",right:"12px","z-index":"999"}))};this.setRight=function(ra){fa||ia();fa.css("right",ra+"px")};this.getJqUi=function(){fa||ia();return fa};
this.setTips=function(ra){xa=ra;a:{if(xa&&0<xa.length){ia();var H="";for(ra=0;ra<xa.length;ra++){var L=xa[ra],A="";L&&L.getLabel()&&L.getValue()?A="<b>"+L.getLabel()+"</b>"+L.getValue()+"</br>":L&&L.getLabel()&&(A="<b>"+L.getLabel()+"</b></br>");H+=A}ea.setTipsHtml(H);if(H){fa.show();break a}}fa&&fa.hide()}}};M.SpaceType=P;P.COLLABORATION=0;P.USER=1;P.PRESET=2;var da,U,ka,I,J,Z,oa,ta,ja,va,Fa,wa;(function(){var fa=com.kingdee.bos.qing.common;da=fa.Util;U=fa.DomUtil;fa=com.kingdee.bos.qing.ui.component;
ka=fa.Button;I=fa.AbstractModalDialog;J=fa.Label;Z=fa.TextField;oa=fa.CheckBox;ta=fa.MessageDialog;wa=fa.HelpIcon;fa=com.kingdee.bos.qing.framework.common;ja=fa.MultilanguageManager.createPackageAccessor(M);fa=com.kingdee.bos.extreport.runtime.model;va=fa.SchemaInfo;Fa=com.kingdee.bos.extreport.runtime.MyIcons})();P=new function(){var fa=!1,ea=0,xa,ia,ra,H,L,A=1,B=0,b,m;this.view=function(E,F){E&&(l(),m.attr("src",E),b.appendTo(F?F:document.body))};var l=function(){b=$("<div>");b.addClass("image-preview-modallayer");
var E=$("<div>");U.layoutCtrlWithLRTB(E,10,10,null,10,10);E.appendTo(b);var F=$("<div>");U.layoutCtrlWithLRTB(F,10,10,null,10,10);F.appendTo(E);E.on("mousewheel DOMMouseScroll",function(t){A=0<(t.originalEvent.wheelDelta&&(0<t.originalEvent.wheelDelta?1:-1)||t.originalEvent.detail&&(0<t.originalEvent.detail?-1:1))?5<=A+.1?5:A+.1:.1>=A-.1?.1:A-.1;F.css("transform","scale("+A+") rotate("+B+"deg)");t.preventDefault()});var e=$("<div>");U.layoutCtrlWithLRTB(e,null,null,null,null,10,36);U.layoutCtrlCenterAlign(e,
112);e.css({"background-color":"#313232","border-radius":"5px"});e.appendTo(E);E=$("<div>");Fa.backgroundWithHover(E,"lessen");E.attr("title",ja.get("","\u7f29\u5c0f"));E.addClass("extreport-icon_enabled");U.layoutCtrlWithLRTB(E,10,null,24,6,null,24);E.click(function(){A=.1<A-.2?A-.2:.1;F.css("transform","scale("+A+") rotate("+B+"deg)")});var k=$("<div>");Fa.backgroundWithHover(k,"magnify");k.attr("title",ja.get("","\u653e\u5927"));k.addClass("extreport-icon_enabled");U.layoutCtrlWithLRTB(k,44,null,
24,6,null,24);k.click(function(){A=5<A+.2?5:A+.2;F.css("transform","scale("+A+") rotate("+B+"deg)")});var n=$("<div>");Fa.backgroundWithHover(n,"rotate");n.attr("title",ja.get("","\u65cb\u8f6c"));n.addClass("extreport-icon_enabled");U.layoutCtrlWithLRTB(n,78,null,24,6,null,24);n.click(function(){B=270==B?0:B+90;F.css("transform","scale("+A+") rotate("+B+"deg)")});E.appendTo(e);k.appendTo(e);n.appendTo(e);m=$("<img>");m.addClass("image-lib-align_margin_auto image-lib-max-size_top");m.appendTo(F);e=
$("<div>");e.addClass("image-preview-close-btn");e.attr("title",ja.get("exit","\u9000\u51fa"));e.on("click",function(){b&&b.remove()});e.appendTo(b);E=$("<div>");E.addClass("image-preview-close-btn-icon");E.appendTo(e);m.on("mousedown",y);m.on("touchstart",Q);m.on("touchmove",X);m.on("touchend",T)},y=function(E){fa=!0;xa=E.clientX;ia=E.clientY;m.css("cursor","grabbing");ra=Number(m.css("top").replace("px",""));H=Number(m.css("left").replace("px",""));document.addEventListener("mousemove",v);document.addEventListener("mouseup",
S);E.preventDefault()},v=function(E){if(fa&&m.css("top")&&m.css("left")){var F=E.clientX-xa,e=E.clientY-ia;5>Math.abs(F)&&5>Math.abs(e)||(F=W(ra,H,e,F,B),m.css("top",F[0]+"px"),m.css("left",F[1]+"px"),E.preventDefault())}},S=function(E){fa=!1;m.css("cursor","grab");document.removeEventListener("mousemove",v);document.removeEventListener("mouseup",S)},Q=function(E){var F=E.touches;ea=F.length;1===ea?(xa=F[0].clientX,ia=F[0].clientY,m.css("cursor","grabbing"),ra=Number(m.css("top").replace("px","")),
H=Number(m.css("left").replace("px",""))):2<=ea&&(L=N(F),E.preventDefault())},X=function(E){if(!(1>ea)){var F=E.touches;if(1===ea){if(!(m.css("top")&&m.css("left")&&xa&&ia)){ea=0;return}var e=F[0].clientX-xa;F=F[0].clientY-ia;if(5>Math.abs(e)&&5>Math.abs(F))return;F=W(ra,H,F,e,B);m.css("top",F[0]+"px");m.css("left",F[1]+"px")}else if(2<=ea){F=E.touches;if(!L||2>F)return;e=N(F);if(10>Math.abs(e-L))return;e=(e/L*A).toFixed(1);if(5>e||.1<e)L=N(F),jqImageContainer.css("transform","scale("+A+") rotate("+
B+"deg)"),A=e}E.preventDefault()}},T=function(E){ea=L=H=ra=ia=xa=0;m.css("cursor","grab")},N=function(E){return Math.sqrt(Math.pow(Math.abs(E[0].pageX-E[1].pageX),2)+Math.pow(Math.abs(E[0].pageY-E[1].pageY),2))},W=function(E,F,e,k,n){switch(n){case 90:E-=k;F+=e;break;case 180:E-=e;F-=k;break;case 270:E+=k;F-=e;break;default:E+=e,F+=k}return[E,F]}};M.ImageViewUtil=P})();(function(){function p(b,m,l){var y=m?m:B,v=oa.RUNTIME==b?285:245,S,Q,X,T=new wa,N,W,E,F,e,k,n;var t=A.get("publicCategory","\u516c\u5171\u76ee\u5f55");var f=A.get("personalCategory","\u4e2a\u4eba\u76ee\u5f55");this.setOuterMessageCurtain=function(D){n=D};this.getWidth=function(){return 392};this.getHeight=function(){return v};this.getJqUi=function(){if(!S){R();var D=function(){if(c())l.snapGroupTypeName="B"==l.snapGroupTypeId?f:t,X.setText(l.snapName),N.doAutoSelected(l.snapGroupTypeName,l.snapGroupTypeId),
E.doAutoSelected(l.snapGroupName,l.snapGroupId),N.setEnable(!1);else if(void 0!=l.snapGroupTypeId&&void 0!=l.snapGroupId&&void 0!=l.snapGroupName&&void 0!=l.isHyperLink)l.snapGroupTypeName="B"==l.snapGroupTypeId?f:t,e.setOn(l.isHyperLink),N.doAutoSelected(l.snapGroupTypeName,l.snapGroupTypeId),E.doAutoSelected(l.snapGroupName,l.snapGroupId),N.setEnable(!0);else{if(W&&1<=W.length){var h=W[0];N.doAutoSelected(h.getName(),h.getId());1==W.length&&N.setEnable(!1)}(h=E.getArrFolderNode())&&1<=h.length&&
(h=h[0],E.doAutoSelected(h.getName(),h.getId()))}};a(N,function(){g(E,D)})}return S};var c=function(){return l.snapName&&l.snapGroupTypeName&&l.snapGroupTypeId&&l.snapGroupId&&l.snapGroupName},d=function(D){D=new P(D,null);D.setPlaceholder(A.get("selectPathType","\u8bf7\u9009\u62e9\u4fdd\u5b58\u76ee\u5f55\u7c7b\u578b"));D.setMaxHeight(118);D.getJqUi().css("background","white");return D},u=function(D){D=new P(null,D);D.setPlaceholder(A.get("selectPath","\u8bf7\u9009\u62e9\u4fdd\u5b58\u76ee\u5f55"));
D.setMaxHeight(118);D.getJqUi().css("background","white");return D},w=function(D){var h=[],G=[];if(!D)return G;for(G=0;G<D.length;G++){var O=new C;O.fromJsonObject(D[G]);h.push(O)}return h},a=function(D,h){if(null==W){var G=y.createFacade(function(O){W=w(O);D.setArrFolderNode(W);h&&h()},function(O,aa){8099101==O?y.getMessageCurtain().showPrompt(A.get("querySnapCenterPermExp","\u67e5\u8be2\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u5f02\u5e38\u3002"),5E3):8099102==O?y.getMessageCurtain().showPrompt(A.get("noQuerySnapCenterPermExp",
"\u5f53\u524d\u7528\u6237\u6ca1\u6709\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u3002"),5E3):_super.getMessageCurtain().showPrompt(aa,5E3);return!0});oa.SNAP_SCHEDULE==b?G.setShowBlocking(!1):(G.setShowBlocking(!0),G.setBlockingJqUi(S));G.loadSnapGroupTypes(l.snapId)}else D.setArrFolderNode(W)},g=function(D,h){if(null==F){var G=y.createFacade(function(O){F=w(O);D.setArrFolderNode(F);h&&h()},function(O,aa){8099101==iErrorCode?y.getMessageCurtain().showPrompt(A.get("querySnapCenterPermExp","\u67e5\u8be2\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u5f02\u5e38\u3002"),
5E3):8099102==iErrorCode?y.getMessageCurtain().showPrompt(A.get("noQuerySnapCenterPermExp","\u5f53\u524d\u7528\u6237\u6ca1\u6709\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u3002"),5E3):_super.getMessageCurtain().showPrompt(aa,5E3);return!0});oa.SNAP_SCHEDULE==b?G.setShowBlocking(!1):(G.setShowBlocking(!0),G.setBlockingJqUi(S));G.loadSnapGroupInfo(l.snapId)}else D.setArrFolderNode(F)},R=function(){var D=0;S=$("<div>");Q=$("<div>");Q.addClass("publish-manage-left");if(oa.RUNTIME==b||oa.SNAP_CENTER==b){var h=
new ea,G=h.getJqUi();h.setRequired(!0);h.setText(A.get("snapName","\u5feb\u7167\u540d\u79f0"));G.attr("title",h.getText());X=new xa;var O=$("<div>");X.addEditedListener(function(la){clearTimeout(k);k=setTimeout(function(){var Ba=X.getText();if(""!=Ba){var ma=y.createFacade(function(za){O.empty();za=za[X.getText()];if(null!=za&&0<za.length){T.setCustomItemPainter(function(ha,pa){ha.on("mousedown",function(ya){X.setText(pa);O.remove();ya.stopPropagation()});ha.text(pa);ha.attr("title",pa)});T.setItemModels(za);
T.setSelecteds([za[0]]);za=T.getJqUi();var Ca=aa.width(),sa=aa.css("left"),na=aa.position().top+aa.height();ja.layoutCtrl(O,sa,na,Ca,122);O.css("z-index","9999");za.css({width:Ca+"px",height:"122px"});za.find(".sa-ctrl-list-owner").css("height","100px");Ca=$("<div>");Ca.css({position:"absolute","z-index":"9999",color:"#c5c5c5"});Ca.text(A.get("HistorySnapName","\u5386\u53f2\u5feb\u7167\u540d\u79f0"));Ca.css({right:"13px",top:"100px"});za.appendTo(O);Ca.appendTo(O);O.appendTo(Q)}else O.remove()});
ma.setShowBlocking(!1);ma.getSnapNameByInputText(Ba)}else O.remove()},1E3)});X.addBlurListener(function(){O.remove()});var aa=X.getJqUi();ja.layoutCtrl(G,15,D,115,23);ja.layoutCtrl(aa,130,D,215,23);G.appendTo(Q);aa.appendTo(Q);D+=45}else D+=15;G=new ea;h=G.getJqUi();c()||G.setRequired(!0);G.setText(A.get("snapSavePathType","\u76ee\u5f55\u7c7b\u578b"));h.attr("title",G.getText());N=d(function(la){if(la&&la!=N.getLastTimeSelectedTailPathId()){var Ba=[];$.extend(!0,Ba,F);if(Ba&&0<Ba.length)if(la&&0==
la.indexOf("A")){for(la=0;la<Ba.length;la++)"B"==Ba[la].getType()&&(Ba.splice(la,1),la--);Ba.sort(function(ma,za){return za.getOrder()-ma.getOrder()});E.setArrFolderNode(Ba);E.clearSelectedTreePath()}else if(la&&0==la.indexOf("B")){for(la=0;la<Ba.length;la++)"A"==Ba[la].getType()&&(Ba.splice(la,1),la--);Ba.sort(function(ma,za){return za.getOrder()-ma.getOrder()});E.setArrFolderNode(Ba);E.clearSelectedTreePath()}}});G=N.getJqUi();ja.layoutCtrl(h,15,D,115,23);ja.layoutCtrl(G,130,D,215,23);h.appendTo(Q);
G.appendTo(Q);G=new ea;h=G.getJqUi();G.setRequired(!0);G.setText(A.get("snapSavePath","\u76ee\u5f55"));h.attr("title",G.getText());E=u(function(la){!N||N.getSelectedTreePath()&&N.getSelectedTreePath().getText()||(la.clearSelectedTreePath(),n.showPrompt(A.get("selectPathType","\u8bf7\u9009\u62e9\u76ee\u5f55\u7c7b\u578b\u3002")))});G=E.getJqUi();D+=45;ja.layoutCtrl(h,15,D,115,23);ja.layoutCtrl(G,130,D,215,23);h.appendTo(Q);G.appendTo(Q);if(oa.RUNTIME==b||oa.SNAP_SCHEDULE==b){e=new fa;e.setOn(!1);h=
e.getJqUi();G=new ea(A.get("saveSnapHyperLink","\u4fdd\u5b58\u8054\u67e5/\u8054\u52a8\u8bbe\u7f6e"));var Aa=G.getJqUi();Aa.attr("title",G.getText());D+=45;ja.layoutCtrl(Aa,15,D,115,23);ja.layoutCtrl(h,130,D,31,23);Aa.appendTo(Q);h.appendTo(Q)}Q.appendTo(S)};this.getModelFromUI=function(){var D=new J;oa.SNAP_SCHEDULE!=b&&D.setSnapName($.trim(X.getText()));var h=E.getSelectedTreePath();D.setSaveSnapGroupPath(h.getValue());D.setSaveSnapGroupPathText(h.getText());D.setSaveSnapGroupName(E.getSelectedTailPathName());
D.setSaveSnapGroupId(E.getSelectedTailPathId());D.setSaveSnapGroupType(N.getSelectedTailPathId());oa.RUNTIME==b?(D.setPageId(l.pageId),D.setPublishId(l.urlParams.publishId),h=e.isOn(),D.setIsHyperLink(h),D.setOldSnapId(l.snapId),D.setReportId(l.extReportId)):oa.SNAP_CENTER==b?(D.setSnapId(l.snapId),D.setReportId(l.reportId)):oa.SNAP_SCHEDULE==b&&(h=e.isOn(),D.setIsHyperLink(h));return D};this.checkUIInput=function(D){if(oa.SNAP_SCHEDULE==b)if(N.getSelectedTreePath())if(E.getSelectedTreePath())D(!0);
else return A.get("selectPath","\u8bf7\u9009\u62e9\u76ee\u5f55\u3002");else return A.get("selectPathType","\u8bf7\u9009\u62e9\u76ee\u5f55\u7c7b\u578b\u3002");else{var h=$.trim(X.getText());if(null==h||0==$.trim(h).length)return A.get("snapNameNotEmpty","\u8bf7\u8f93\u5165\u5feb\u7167\u540d\u79f0\u3002");if(50<h.length)return A.get("snapNameTooLong","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(I.isValidString(h)){if(I.isKeywords(h))return A.get("isKeywords",'\u65e0\u6cd5\u4f7f\u7528"#1"\u4f5c\u4e3a\u540d\u79f0\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002').replace("#1",
h);if(N.getSelectedTreePath())if(E.getSelectedTreePath())D(!0);else return A.get("selectPathWithPeriod","\u8bf7\u9009\u62e9\u76ee\u5f55\u3002");else return A.get("selectPathType","\u8bf7\u9009\u62e9\u76ee\u5f55\u7c7b\u578b\u3002")}else return A.get("invalidName","\u540d\u79f0\u53ea\u80fd\u7531\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\u3002")}}}function q(){var b,m,l,y,v,S;this.setId=function(Q){b=Q};this.getId=
function(){return b};this.setName=function(Q){m=Q};this.getName=function(){return m};this.setType=function(Q){l=Q};this.getType=function(){return l};this.setParentId=function(Q){y=Q};this.getParentId=function(){return y};this.setParentNode=function(Q){v=Q};this.getParentNode=function(){return v};this.setOrder=function(Q){S=Q};this.getOrder=function(){return S}}function C(){q.call(this);var b=this,m=[],l,y;this.setChildren=function(v){m=v};this.getChildren=function(){return m};this.setIsOpenDir=function(v){l=
v};this.getIsOpenDir=function(){return l};this.getIsShow=function(){return y};this.setIsShow=function(v){y=v};this.toJsonObject=function(){var v={};v.children=m;return v};this.fromJsonObject=function(v){b.setName(v.name);b.setId(v.id);b.setType(v.type);b.setParentId(v.parentId);b.setOrder(v.order);b.setIsOpenDir(!0);if(v=v.children)for(var S=0;S<v.length;S++){var Q=v[S];if(!Q.children||Q.children&&0==Q.children.length){var X=new M;X.fromJsonObject(Q);X.setParentNode(b);m.push(X)}else X=new C,X.fromJsonObject(Q),
X.setParentNode(b),m.push(X)}}}function M(){q.call(this);var b=this;this.fromJsonObject=function(m){b.setName(m.name);b.setId(m.id);b.setParentId(m.parentId);b.setOrder(m.order)}}function P(b,m){da.call(this);var l=this,y=this.protectedMethod,v,S=[],Q,X,T,N;this.getDropDownContent=function(){l.updateArrFolderNode();l.initTreeSelector();return v.getJqUi()};this.updateArrFolderNode=function(c){b&&b(c)};this.checkClearSelectedTreePath=function(c){m&&m(c)};this.clearSelectedTreePath=function(){Q=null;
y.updateText(Q?Q.getText():"")};this.setSelectedTreePath=function(c){Q=c;y.updateText(Q?Q.getText():"")};this.getSelectedTreePath=function(){return Q};this.getSelectedTailPathName=function(){return X};this.getSelectedTailPathId=function(){return T};this.getLastTimeSelectedTailPathId=function(){return N};this.initTreeSelector=function(){if(S){v=new Fa;v.setRootVisible(!1);v.setNodePainter(n);var c=v,d=c.setRoot,u=S,w=new C;w.setParentId(" ");w.setName("\u65b0\u589e\u76ee\u5f55");w.setId(" ");w=W(w);
F(w,u);d.call(c,w);v.hookLoadingHandler(k);v.addSelectingListener(t);v.getRoot().setExpanded(!0);v.setLineHeight(30);ja.layoutCtrl(v.getJqUi(),0,1,"100%",4<S.length?120:30*S.length+2);v.getJqUi().css("border","1px solid rgba(138, 153, 170, 0.4)");v.getJqUi().css("background","white");v.getJqUi().appendTo($(document.body))}else return null};this.setArrFolderNode=function(c){S=c};this.getArrFolderNode=function(){return S};this.doAutoSelected=function(c,d){X=c;N=T;T=d;var u=new U;u.setValue(d);u.setText(c);
Q=u;y.updateText(Q?Q.getText():"");l.updateArrFolderNode(d);l.checkClearSelectedTreePath(l)};var W=function(c){var d=new Fa.BranchNode;d.setUserObject(c);return d},E=function(c){var d=new Fa.LeafNode;d.setUserObject(c);return d},F=function(c,d){if(d&&0<d.length)for(var u=0;u<d.length;u++){var w=d[u];w&&w instanceof C&&0<w.getChildren().length?e(c,w):c.addChild(E(w))}},e=function(c,d){var u=0<d.getChildren().length?W(d):E(d);c.addChild(u);c=d.getChildren();if(0!=c.length)for(d=0;d<c.length;d++)c[d]&&
c[d]instanceof C&&c[d].getChildren()?e(u,c[d]):u.addChild(E(c[d]))},k=function(c,d){setTimeout(function(){F(c);d()},500)},n=function(c,d){c.css("padding-left","4px");c.css("padding-right","4px");c.text(d.getUserObject().getName())},t=function(c,d){var u=d.getTreePath();d=c="";for(var w,a=1;a<u.length;a++)1<a&&(c+="/",d+="/"),w=u[a],c+=w.getUserObject().getName(),d+=w.getUserObject().getId();X=w.getUserObject().getName();N=T;T=w.getUserObject().getId();w=new U;w.setValue(d);w.setText(c);Q=w;y.updateText(Q?
Q.getText():"");y.doDropdown();l.updateArrFolderNode(d);l.checkClearSelectedTreePath(l)},f=200;this.setMaxHeight=function(c){f=c};this.getPopupHeight=function(){return null==S||0==S.length?22:Math.min(30*S.length+2,f+2)}}function da(){var b=this,m,l,y,v,S,Q=!0;this.setEnable=function(F){Q=F;Q||(y.hide(),l.css({color:"rgb(192, 192, 192)"}))};this.getDropDownContent=function(){throw Error("orrive me");};this.getPopupHeight=function(){throw Error("orrive me");};this.getJqUi=function(){m||X();return m};
this.setPlaceholder=function(F){X();"placeholder"in l[0]?l.attr("placeholder",F):(S&&S.remove(),S=$("<div>"),S.text(F),S.css({color:"#ccc","font-size":"12px"}),S.on("mousedown",function(e){l.focus()}),S.appendTo(b.getJqUi()),ja.layoutCtrlWithLRTB(S,4,4,null,2,2,null),E())};var X=function(){if(!m){m=$("<div>");m.addClass("sa-ctrl-combobox");if(Q)m.on("click",N);m.css("border-bottom","1px solid #ccc");l=$("<input readonly=readonly>");l.addClass("sa-ctrl-textfield-input");l.css({color:"#666","font-size":"12px",
"text-overflow":"ellipsis",padding:"0px 16px 0px 4px"});l.appendTo(m);y=$("<div>");y.addClass("sa-ctrl-combobox-arrow sa-ctrl-combobox-arrow_enabled");y.appendTo(m);y.on("mouseenter",function(F){T(!0)});y.on("mouseleave",function(F){T(!1)});T(!1)}},T=function(F){var e=v?"arrow-up":"arrow-down";F&&(e+="_hover");ia.background(y,e)},N=function(){if(Q){if(v)$(document.body).off("mousedown",W),v.detach(),v=null;else{var F=$(document.body),e=v=$("<div>"),k=$("<div>");k.addClass("sa-ctrl-common-border");
k.appendTo(e);v.addClass("sa-qing-publish-dropdown-selector");b.getDropDownContent().appendTo(v);var n=b.getPopupHeight();v.css("z-index",999999);v.appendTo(F);var t=F.prop("clientHeight"),f=m.outerHeight();e=m.outerWidth();var c=[0,f-1];c=ja.upwardCoordinate(m[0],c,F[0]);k=c[0];var d=c[1];n=0>n?Math.max(0,(t>>1)-f):n;d+n>t&&(c=[0,0],c=ja.upwardCoordinate(m[0],c,F[0]),F=c[1]-n+1,0<=F&&(d=F));ja.layoutCtrl(v,k,d,e,n);$(document.body).on("mousedown",W)}T(!1)}},W=function(F){for(var e=$(document.body),
k=$(F.target);k[0]!=e[0];){if(k[0]==m[0])return;k=k.parent()}for(k=$(F.target);k[0]!=e[0];){if(k[0]==v[0])return;k=k.parent()}N()},E=function(){S&&setTimeout(function(){S.css("display",l.val()?"none":"")},0)};this.protectedMethod={updateText:function(F){X();l.val(F?F:"");F&&l.attr("title",F);"placeholder"in l[0]||E()},doDropdown:N}}function U(){var b=this,m,l,y,v;this.getIsShow=function(){return v};this.setIsShow=function(S){v=S};this.getValue=function(){return m};this.setValue=function(S){m=S};this.getText=
function(){return l};this.setText=function(S){l=S};this.getUserObject=function(){return y};this.setUserObject=function(S){y=S};this.toJsonObject=function(){var S={};S.value=m;S.text=l;return S};this.fromJsonObject=function(S){S&&(S.value&&b.setValue(S.value),S.text&&b.setText(S.text))}}function ka(b,m,l,y){H.call(this,b,m,l,y);var v=this.protectedMethod;this.loadSnapGroupTypes=function(S){v.remote("loadSnapGroupTypes",{snapId:S})};this.loadSnapGroupInfo=function(S){v.remote("loadSnapGroupInfo",{snapId:S})};
this.getSnapNameByInputText=function(S){v.remote("getSnapNameByInputText",{inputText:S})};this.saveSnapInfo=function(S){v.remote("saveSnapInfo",S)}}function I(){}function J(){var b,m,l,y,v,S,Q,X,T,N,W,E,F;this.getSnapId=function(){return b};this.setSnapId=function(e){b=e};this.setOldSnapId=function(e){m=e};this.getOldSnapId=function(){return m};this.getReportId=function(){return l};this.setReportId=function(e){l=e};this.getPageId=function(){return y};this.setPageId=function(e){y=e};this.getPublishId=
function(){return v};this.setPublishId=function(e){v=e};this.getSnapName=function(){return S};this.setSnapName=function(e){S=e};this.isHyperLink=function(){return Q};this.setIsHyperLink=function(e){Q=e};this.getSaveSnapGroupName=function(){return X};this.setSaveSnapGroupName=function(e){X=e};this.getSaveSnapGroupType=function(){return N};this.setSaveSnapGroupType=function(e){N=e};this.getSaveSnapGroupId=function(){return T};this.setSaveSnapGroupId=function(e){T=e};this.getSaveSnapGroupPath=function(){return W};
this.setSaveSnapGroupPath=function(e){W=e};this.getSaveSnapGroupPathText=function(){return E};this.setSaveSnapGroupPathText=function(e){E=e};this.getForceOverwrite=function(){return F};this.setForceOverwrite=function(e){F=e};this.fromJsonObject=function(e){b=e.snapId;y=e.pageId;v=e.publishId;S=e.snapName;Q=e.isHyperLink;X=e.saveSnapGroupName;N=e.saveSnapGroupType;T=e.saveSnapGroupId;W=e.saveSnapGroupPath;E=e.saveSnapGroupPathText;l=e.reportId;F=e.forceOverwrite};this.toJsonObject=function(){var e=
{};e.snapId=b;e.oldSnapId=m;e.pageId=y;e.publishId=v;e.snapName=S;e.isHyperLink=Q;e.saveSnapGroupName=X;e.saveSnapGroupType=N;e.saveSnapGroupId=T;e.saveSnapGroupPath=W;e.saveSnapGroupPathText=E;e.reportId=l;e.forceOverwrite=F;return e}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.snapcenter&&
(com.kingdee.bos.extreport.snapcenter={});"undefined"==typeof com.kingdee.bos.extreport.snapcenter.common&&(com.kingdee.bos.extreport.snapcenter.common={});"undefined"==typeof com.kingdee.bos.extreport.snapcenter.common.ui&&(com.kingdee.bos.extreport.snapcenter.common.ui={});var Z=com.kingdee.bos.extreport.snapcenter.common.ui,oa={};Z.SaveSnapDialog=function(b,m,l){va.call(this);var y=this,v=this.protectedMethod,S=B,Q=[],X=new p(b,S,l),T;(function(){v.setTitle(m);y.setSize(X.getWidth(),X.getHeight());
T=v.getMessageCurtain();X.setOuterMessageCurtain(v.getMessageCurtain());v.setContentPaneCreator(function(){return X.getJqUi()});v.setClosingChecker(function(e){N(e)},!0);v.setClosingAction(function(){})})();this.addSuccessCallback=function(e){Q.push(e)};var N=function(e){var k=X.checkUIInput(function(n){n?E(e):e(n)});k&&(v.getMessageCurtain().showPrompt(k,5E3),e(!1))},W={8099101:A.get("querySnapCenterPermExp","\u67e5\u8be2\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u5f02\u5e38\u3002"),8099102:A.get("noQuerySnapCenterPermExp",
"\u5f53\u524d\u7528\u6237\u6ca1\u6709\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u3002"),8099103:A.get("snapNameNotEmpty","\u5feb\u7167\u540d\u79f0\u4e3a\u7a7a\u3002"),8099104:A.get("snapNameTooLong","\u5feb\u7167\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),8099105:A.get("invalidName","\u540d\u79f0\u53ea\u80fd\u7531\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\u3002"),8099106:A.get("selectPath",
"\u76ee\u5f55\u4e3a\u7a7a\u3002"),8099107:A.get("reportNotFound","\u8be5\u62a5\u8868\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),8099108:A.get("userNotFound","\u672a\u627e\u5230\u7528\u6237\u3002"),8099109:A.get("snapGroupNotFound","\u76ee\u5f55\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),8099110:A.get("sameSnapNameExist","\u76f8\u540c\u5feb\u7167\u540d\u79f0\u5df2\u5b58\u5728\u3002"),8099112:A.get("checkReportPermExp","\u68c0\u67e5\u7528\u6237\u662f\u5426\u62e5\u6709\u4fdd\u5b58\u5feb\u7167\u6743\u9650\u5f02\u5e38\u3002"),
8099113:A.get("noReportPerm","\u5f53\u524d\u7528\u6237\u6ca1\u6709\u4fdd\u5b58\u5feb\u7167\u6743\u9650\u3002"),8099115:A.get("checkSnapCenterModulePermExp","\u68c0\u6d4b\u5feb\u7167\u4e2d\u5fc3\u6a21\u5757\u8bb8\u53ef\u5f02\u5e38\u3002"),8099116:A.get("noSnapCenterModulePerm","\u5f53\u524d\u7528\u6237\u6ca1\u6709\u5feb\u7167\u4e2d\u5fc3\u6a21\u5757\u8bb8\u53ef\u3002"),8099117:A.get("isKeywords",'\u65e0\u6cd5\u4f7f\u7528"#1"\u4f5c\u4e3a\u540d\u79f0\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002')},E=function(e,
k){var n=X.getModelFromUI();k&&n.setForceOverwrite(!0);k=S.createFacade(function(t){n.setSnapId(t);if(n.getPublishId()||"A"==n.getSaveSnapGroupType()&&l.snapId){t=com.kingdee.bos.qing.behavior.BehaviorManager;var f=ta.createUUID();n.getPublishId()?t.initAccessRecordParams(n.getPublishId(),f,t.SourceType.QING_PUBLISH,t.AppType.QING_RPT):t.initAccessRecordParams(l.snapId,f,t.SourceType.QING_SNAPSHOT,t.AppType.QING_RPT);t.recordResourceOperation(t.OperationType.QING_SNAPSHOT_SAVE)}if(!Q||0==Q.length)T&&
T.showSuccess(A.get("saveSnapSuccess","\u4fdd\u5b58\u5feb\u7167\u6210\u529f\u3002"));else if(Q&&0<Q.length)for(t=0;t<Q.length;t++)(f=Q[t])&&f(n);e(!0)},function(t,f){if(t){if(oa.RUNTIME==b&&8099110==t)return f=A.get("sameSnapNameConfirmMessage","\u5feb\u7167\u540d\u79f0\u5df2\u5b58\u5728\uff0c\u786e\u5b9a\u8986\u76d6\u5417\uff1f"),F(f,e),!0;t=W[t];T.showPrompt(t?t:f,5E3);e(!1);return!0}e(!1);return!1});k.setShowBlocking(!1);k.saveSnapInfo(n.toJsonObject())},F=function(e,k){var n=$(document.body),
t=$("<div class='sa-ctrl-common-modallayer'>");t.appendTo(n);var f=new ra(t),c=A.get("operateConfirm","\u64cd\u4f5c\u786e\u8ba4");f.setTitle(c);c=n.prop("clientWidth");var d=n.prop("clientHeight");f.setBounds(c-300>>1,d-200>>1,300,200);f.setToolbarVisible(!1);c=$("<div>");d=$("<div>");var u=$("<span>");u.text(e);u.attr("title",e);u.css({"text-align":"center",display:"inline-block","margin-top":"5px","line-height":"23px","font-size":"14px","text-overflow":"ellipsis",overflow:"hidden"});ja.layoutCtrl(d,
null,null,300,200);ja.layoutCtrl(u,0,25,300,60);u.appendTo(d);d.appendTo(c);f.setContent(c);f.addClosingListener(function(w,a){a?E(k,!0):k(!1);w.destroy();t.remove();return!0});f.showFooterPane();f.show();t.appendTo(n)}};Z.SnapContentPanel=p;Z.SaveSnapSourceType=oa;Z.ExtReportSnapModel=J;Z.StringUtil=I;Z.ValueTextPair=U;oa.RUNTIME=1;oa.SNAP_CENTER=2;oa.SNAP_SCHEDULE=3;var ta,ja,va,Fa,wa,fa,ea,xa,ia,ra,H,L,A,B;(function(){var b=com.kingdee.bos.qing.common;ta=b.Util;ja=b.DomUtil;b=com.kingdee.bos.qing.ui.component;
va=b.AbstractModalDialog;Fa=b.Tree;wa=b.List;fa=b.SwitchButton;ea=b.Label;xa=b.TextField;ia=b.Icons;ra=b.Dialog;b=com.kingdee.bos.qing.framework.common;H=b.AbstractFacade;L=b.AbstractRemoteCall;A=b.MultilanguageManager.createPackageAccessor(Z);B=new function(){function m(){L.call(this);var v;this.getRemoteUrl=function(){return v};this.setRemoteUrl=function(S){v=S}}var l;this.createFacade=function(v,S,Q){var X=y();return new ka(X,v,function(T,N){return S?S(T,N):!1},Q)};var y=function(){if(!l){var v=
ta.decodeParamFromUrl(window.location.search,"path");v=(v?v:"/ierp")+"/qing_rpt/runtime.do";l=new m;l.setRemoteUrl(v)}return l}}})();I.isValidString=function(b){return/^([\u4E00-\u9FA5a-zA-Z_])[\u4E00-\u9FA5a-zA-Z0-9_]{0,}$/.test(b)};I.isKeywords=function(b){return/\b(null|true|false)\b/i.test(b)}})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.common&&(com.kingdee.bos.extreport.runtime.common={});var p=com.kingdee.bos.extreport.runtime.common;p.Facade=function(P,
da,U,ka){q.call(this,P,da,U,ka);var I=this.protectedMethod;this.loadExtReportInfo=function(J,Z,oa,ta,ja){I.remote("loadExtReportInfo",{extReportId:J,publishId:Z,isPreview:oa,isGuiPreview:ta,dataName:ja})};this.loadExtReportSnapInfo=function(J){I.remote("loadExtReportSnapInfo",{snapId:J})};this.getFilter=function(J){I.remote("getFilter",J)};this.getDelaySuppliedValue=function(J){I.remote("getDelaySuppliedValue",J)};this.getFilterSchemes=function(J,Z){I.remote("getFilterSchemes",{pageId:J,flag:Z})};
this.saveFilterScheme=function(J){I.remote("saveFilterScheme",J)};this.delFilterScheme=function(J){I.remote("delFilterScheme",J)};this.applyFilter=function(J){I.remote("applyFilter",J)};this.excuteExtReport=function(J,Z,oa){I.remote("excuteExtReport",{pageId:J,paramCacheId:Z,isPreview:oa})};this.loadFragment=function(J,Z,oa){I.remote("loadFragment",{pageId:J,currentSheetName:Z,pageIndex:oa})};this.switchSheet=function(J,Z,oa){I.remote("switchSheet",{pageId:J,sheetName:Z,switchOnly:oa})};this.getPager=
function(){I.remote("getPager",{type:"listPaperSize"})};this.exportToFile=function(J,Z){Z=Z?Z:{};Z.exportType=J;Z.OriginPermission=!0;I.remote("exportToFile",Z)};this.cacheParamValues=function(J){I.remote("cacheParamValues",{paramValues:J})};this.lazyLoadTree=function(J,Z,oa){I.remote("lazyLoadTree",{pageId:J,rowIdx:Z,treeLevel:oa})};this.cellInnerLink=function(J){I.remote("cellInnerLink",J)};this.executeExtReportFromSnapContent=function(J){I.remote("executeExtReportFromSnapContent",{pageId:J})};
this.checkSnapOperPermission=function(J,Z,oa,ta,ja){I.remote("checkSnapOperPermission",{snapCenterQueryPerm:J,snapExist:Z,snapSave:ta,snapEdit:ja,snapId:oa})}};p.DataSetFacade=function(P,da,U,ka){q.call(this,P,da,U,ka);var I=this.protectedMethod;this.loadDataSetInfo=function(J,Z){I.remote("loadDataSetInfo",{dataSetId:J,cacheId:Z})};this.getDataSetFilterAndSchemaList=function(J,Z){I.remote("getDataSetFilterAndSchemaList",{dataSetId:J,cacheId:Z})};this.applyDataSetFilter=function(J){I.remote("applyDataSetFilter",
J)};this.saveFilterScheme=function(J){J.dataSetId=J.sId;I.remote("saveDataSetFilterScheme",J)};this.delFilterScheme=function(J){I.remote("delDataSetScheme",J)};this.getDelaySuppliedValue=function(J){J.formDataSet=!0;I.remote("getDataSetDelaySuppliedValue",J)}};p.RemoteImpl=function(){C.call(this);var P;this.getRemoteUrl=function(){return P};this.setRemoteUrl=function(da){P=da}};var q,C;(function(){var P=com.kingdee.bos.qing.framework.common;q=P.AbstractFacade;C=P.AbstractRemoteCall})();var M=new function(){var P;
this.hookCollector=function(da){P=da};this.occur=function(da,U){try{P&&P(da,U)}catch(ka){window.console&&console.warn(ka)}};this.getPreviewSourceName=function(da){if(!da)return M.PREVIEW_SOURCE_MANAGE;if("0"===da)return M.PREVIEW_SOURCE_APPMENU;if("1"===da)return M.PREVIEW_SOURCE_CENTER}};M.EXPORT_TYPE="export-type";M.PREVIEW_SOURCE_MANAGE="Manege";M.PREVIEW_SOURCE_APPMENU="Appmenu";M.PREVIEW_SOURCE_CENTER="Center";p.UserOperationReporter=M})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.report&&(com.kingdee.bos.extreport.runtime.report={});"undefined"==typeof com.kingdee.bos.extreport.runtime.report.model&&
(com.kingdee.bos.extreport.runtime.report.model={});com.kingdee.bos.extreport.runtime.report.model.ExtReportRuntimeInfo=function(){var p,q,C,M,P,da,U,ka,I,J,Z,oa,ta,ja,va,Fa,wa,fa,ea,xa,ia,ra,H,L,A,B,b,m;this.getPageId=function(){return p};this.getExtReportName=function(){return q};this.isHasModel=function(){return C};this.isHasFilter=function(){return M};this.isNeedFill=function(){return P};this.isHideMenubarInReport=function(){return da};this.isPopFilter=function(){return U};this.isHasExportPermission=
function(){return ka};this.isHasPrintPermission=function(){return I};this.isHasSaveSnapshotPermission=function(){return J};this.isHasEditSnapshotPermission=function(){return Z};this.isAccredited=function(){return oa};this.isModifiedTemplate=function(){return ta};this.getSnapId=function(){return ja};this.getCreatorName=function(){return va};this.getCreateTime=function(){return Fa};this.getCurrentUserId=function(){return wa};this.getExportSetting=function(){return fa};this.getSpaceId=function(){return ea};
this.getSpaceName=function(){return xa};this.getSpaceType=function(){return ia};this.getSpaceCreatorName=function(){return ra};this.getPubModifier=function(){return H};this.getPubUpdateTime=function(){return L};this.getTemplateModifier=function(){return A};this.getTemplateUpdateTime=function(){return B};this.getSnapModifier=function(){return b};this.getSnapModifyDate=function(){return m};this.fromJson=function(l){p=l.pageId;q=l.extReportName;C=l.hasModel;M=l.hasFilter;P=l.isNeedFill;da=l.isHideMenubarInReport;
U=l.isPopFilter;ka=l.hasExportPermission;I=l.hasPrintPermission;J=l.hasSaveSnapshotPermission;Z=l.hasEditSnapshotPermission;oa=l.isAccredited;ta=l.isModifiedTemplate;ja=l.snapId;va=l.creatorName;Fa=l.createTime;wa=l.currentUserId;fa=JSON.stringify(l.setupModel);ea=l.spaceId;ia=l.spaceType;xa=l.spaceName;ra=l.spaceCreatorName;H=l.pubModifier;L=l.pubUpdateTime;A=l.templateModifier;B=l.templateUpdateTime;b=l.snapModifierName;m=l.snapModifyDate}}})();(function(){function p(){var P=[],da=[],U,ka,I=[],J=[],Z=[],oa=new C,ta=[];this.setCustomSingleColWidth=function(ja){};this.getItemByRow=function(ja){var va=[];va.push(I);va.push(da[ja]);return va};this.getItemValueByRow=function(ja){return da[ja]};this.getCellValue=function(ja,va){return da[ja][va]};this.getOrderedKeys=function(){return I};this.getColCount=function(){return ka};this.getRowCount=function(){return U};this.getAliasAt=function(ja){return P[ja]};this.isMarkAsExcluded=function(ja){return ta.includes(ja+
1)};this.getColWidthByCol=function(ja,va,Fa){return ja===ka-1?Math.max(Math.floor(va+50-Fa),70):Math.max(Math.max(Math.floor(J[ja]*va),Z[ja]),70)};this.fromJsonObject=function(ja){var va=ja.columnNames,Fa=ja.resultList;U=Fa.length;P=ja.columnAlias;ta=ja.excludedCols;if(!va||0===va.length)throw Error("no column!");for(ja=0;ja<va.length;ja++)I.push(va[ja].toLowerCase());ka=I.length;var wa;va=[];oa.setFontSize(M.getFontSize(),M.getFontName());for(ja=0;ja<ka;ja++)va[ja]=0;for(ja=0;ja<U;ja++){var fa=Fa[ja],
ea=[];for(wa=0;wa<ka;wa++){var xa=fa[I[wa]];if(ja<p.CALCULATE_ROW_COUNT){var ia=oa.measureWidth(xa);ia=ia>p.MAX_CELL_WIDTH?p.MAX_CELL_WIDTH:ia;ia=ia<p.MIN_CELL_WIDTH?p.MIN_CELL_WIDTH:ia;va[wa]+=ia}ea.push(xa)}da.push(ea)}if(0===U)for(ja=0;ja<ka;ja++)Fa=oa.measureWidth(I[ja]),va[ja]+=Fa+p.MIN_CELL_WIDTH;ja=0;wa=[];fa=U>=p.CALCULATE_ROW_COUNT?p.CALCULATE_ROW_COUNT:U;fa=0===fa?1:fa;for(Fa=0;Fa<ka;Fa++)ea=va[Fa]/fa,xa=I[Fa]?I[Fa].length:0,ea=ea<xa?xa:ea,ja+=ea,wa.push(ea);for(Fa=0;Fa<ka;Fa++)J.push(wa[Fa]/
ja),Z.push(wa[Fa])}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.dataset&&(com.kingdee.bos.extreport.runtime.dataset={});"undefined"==typeof com.kingdee.bos.extreport.runtime.dataset.model&&
(com.kingdee.bos.extreport.runtime.dataset.model={});var q=com.kingdee.bos.extreport.runtime.dataset.model;q.DataSetRuntimeInfo=function(){var P,da,U,ka,I,J;this.getDataSetType=function(){return P};this.setDataSetType=function(Z){P=Z};this.getCacheId=function(){return da};this.setCacheId=function(Z){da=Z};this.setDataSetId=function(Z){U=Z};this.getDataSetId=function(){return U};this.setDataSetName=function(Z){ka=Z};this.getDataSetName=function(){return ka};this.setHasFilter=function(Z){I=Z};this.hasFilter=
function(){return I};this.setHasModel=function(Z){J=Z};this.hasModel=function(){return J};this.fromJsonObject=function(Z){P=Z.dataSetType;da=Z.cacheId;U=Z.dataSetId;ka=Z.dataSetName;I=Z.hasFilter;J=Z.hasModel}};q.DataSetResult=p;var C,M;(function(){var P=com.kingdee.bos.qing.common;C=P.TextMeasurer;P=com.kingdee.bos.qing.framework.common;M=P.GlobalFont})();p.SINGLE_COL_WIDTH=140;p.CALCULATE_ROW_COUNT=20;p.MIN_CELL_WIDTH=10;p.MAX_CELL_WIDTH=200;p.MIN_COL_COUNT_THRESHOLD=13})();(function(){function p(){function L(W){KTDefaultCellRender.call(this,W);var E=this,F=this.paintCellUI;this.paintCellUI=function(e,k){var n=E.getCurrentRowIdx();var t=E.getCurrentColIdx(),f={"line-height":"28px","padding-left":"7px","padding-right":"7px"};E.getCurrentRowIdx()<P.getHeadRowCount()?0<t&&X.isMarkAsExcluded(t-1)?1===n&&(n=X.getAliasAt(t-1),k=va.get("excludeColumnTips","\u8be5\u5b57\u6bb5\u5728\u201c\u8f93\u51fa\u5b57\u6bb5\u201c\u4e2d\u5df2\u4e0d\u5b58\u5728\u3002"),f=$("<div>"),f.attr("title",
n),f.text(n),f.css({display:"inline-block","line-height":"20px",height:"20px"}),n=new oa,n.setIconType(oa.ICON_TYPE_INFO),n.setTipsText(k),k=n.getJqUi(),k.css({display:"inline-block",margin:"3px 0 0 3px"}),f.appendTo(e),k.appendTo(e)):F(e,k):(0===t?(k=$("<div>"),n=n-3+1):(k=$("<div>"),n=X.getCellValue(n-3,t-1)),k.attr("title",n),k.css(f),k.text(n),k.appendTo(e))}}var A=this,B,b,m,l,y,v,S,Q,X;this.getJqUi=function(){if(!B){B=$("<div>");B.addClass("dataset-table-container");v=$("<div>");v.css({background:"#fff"});
M.layoutCtrlWithLRTB(v,10,10,null,10,10,null);S=$("<div>");S.addClass("dataset-head-container");S.appendTo(v);var W=$("<div>");W.addClass("dataset-spinner-prompt");W.text(va.get("previewLimitSuffix","\u6761\u6570\u636e"));W.appendTo(S);y=new J;y.setItemModels([50,100,200,500,1E3]);y.setSelected(50);y.addSelectedChangedListener(T);W=y.getJqUi();W.addClass("dataset-combobox");W.appendTo(S);W=$("<div>");W.addClass("dataset-spinner-prompt");W.text(va.get("previewLimitPrefix","\u9884\u89c8\u524d"));W.appendTo(S);
S.hide();m=$("<div>");m.addClass("dataset-table");m.appendTo(v);v.appendTo(B)}return B};this.setFunExecute=function(W){Q=W};this.setModelsAndUpdateUi=function(W){X=W;A.updateUi()};this.getPreviewLimitCount=function(){return y?parseInt(y.getSelected()):p.PREVIEW_NUM_DEFAULT};this.updateUi=function(){S&&S.show();m&&m.remove();l&&l.remove();b=new KTable;b.setSyncUIWhenModelChanged(!1);b.setFrozenRows(3);b.setDraggableAdjusting(!0,3,0);b.setLargeDataMode(!0);var W=new L(b);W.setOutsideVisible(!1);b.setCellRender(W);
W=new KTStyle;W.setVerticalAlign("middle");b.setStyle(W);m=$(b.getUI());m.addClass("dataset-table");m.appendTo(v);N()};this.resize=function(){b&&N()};var T=function(W,E,F){W=parseInt(F);if("number"!=typeof W)throw Error("Unexpected error: not number.");Q(W)},N=function(){P.clear(b);var W,E=X.getRowCount(),F=X.getColCount(),e=P.createHeadRow(b),k=document.body.clientWidth;b.addColumns(F+1);b.getColumn(0).setWidth(50);e.getCell(0).setValue(va.get("orderNumber","\u5e8f\u53f7"));var n=50;for(W=0;W<F;W++){var t=
X.getColWidthByCol(W,k-70,n);b.getColumn(W+1).setWidth(t);e.getCell(W+1).setValue(X.getAliasAt(W));n+=t}if(0!==X.getRowCount())for(W=0;W<E;W++)P.createRow(b);else l=$("<div>"),M.layoutCtrlWithLRTB(l,10,10,null,40,10,null),l.css({"background-color":"white"}),W=$("<div>"),W.addClass("dataset-table-no-data-text"),W.text(va.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c")),W.appendTo(l),l.appendTo(B);b.updateUI()}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&
(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.dataset&&(com.kingdee.bos.extreport.runtime.dataset={});"undefined"==typeof com.kingdee.bos.extreport.runtime.dataset.ui&&(com.kingdee.bos.extreport.runtime.dataset.ui={});com.kingdee.bos.extreport.runtime.dataset.ui.Main=
function(){function L(){ka.call(this);var a=this.protectedMethod,g=this,R=this.showDialog;this.showDialog=function(){g.setSize(720,480);a.setTitle(va.get("previewQueryContent","\u67e5\u770b\u6267\u884c\u8bed\u53e5"));a.setFooterPaneCreator(null);a.setContentPaneCreator(function(){return D(T)});a.setClosingAction(function(h){});a.setSelectable(!0);R()};var D=function(h){var G=new da;G.setText(va.get("close","\u5173\u95ed"));G.addActionListener(function(aa){a.destroy()});var O=$("<div>");O.css({"box-sizing":"border-box",
overflow:"auto","white-space":"pre-wrap","line-height":"20px",padding:"6px",border:"1px solid #ddd"});O.text(h);h=$("<div>");h.append(O);h.append(G.getJqUi());M.layoutCtrlWithLRTB(O,0,0,null,0,40,374);M.layoutCtrlWithLRTB(G.getJqUi(),null,null,null,null,6,26);M.layoutCtrlCenterAlign(G.getJqUi(),80);return h}}var A,B,b,m,l,y,v,S,Q,X,T,N=new function(){var a,g;this.getMessageCurtain=function(){a||(a=new U,a.getJqUi().appendTo($("body")));return a};this.createFacade=function(D,h,G){var O=R();return new wa(O,
D,function(aa,Aa){return h?h(aa,Aa):!1},G)};this.showExecuteError=function(D){D=D.split("|||");var h=new Z;h.setOptionType(Z.RETURN_OK);h.setMessage(D[0]);h.setDetail(D[1]);h.showDialog()};this.showError=function(D){var h=$("<div>");h.css({position:"absolute",background:"white",top:"0",bottom:"0",left:"0",right:"0",font:"14px PingFangSC-Regular","letter-spacing":"0",color:"#666666","text-align":"center","z-index":"9"});var G=$("<div>");G.addClass("qing-welcome-sub-container");G.css({width:"740px",
height:"410px",position:"absolute",top:"50%",left:"50%","margin-left":"-370px","margin-top":"-205px",background:"white"});var O=$("<img>");O.css({widdisplayth:"block",height:"189px",width:"200px","background-size":"contain",margin:"0 auto"});O.prop("src","qingrpt/runtime/resource/errorBackground.png");var aa=$("<span>");aa.text(D);aa.css({display:"block","font-size":"20px","line-height":"26px",color:"#666666"});G.append(O);G.append(aa);h.append(G);h.appendTo($(document.body))};var R=function(){if(!g){var D=
C.decodeParamFromUrl(window.location.search,"path");D=(D?D:"/ierp")+"/qing_rpt/datasetRuntime.do";g=new fa;g.setRemoteUrl(D)}return g};this.showDialogError=function(D){var h=new Z;h.setOptionType(Z.OPTION_OK);h.setButtonText(Z.OPTION_OK,va.get("refresh","\u5237\u65b0"));h.setClosingChecker(function(G){G===Z.OPTION_OK&&E();return!0});h.setMessage(D);h.showDialog()}},W=function(){document.body.style.height=document.documentElement.clientHeight+"px"};this.start=function(){var a=$(document.body);A=$("<div class='dataset-web-main'>");
A.appendTo(a);ta.init();W();a=new ja;a.setCallbackImmediately(function(){W();var g=v&&v.getJqUi();g=g?!g.is(":hidden"):!1;k(g);y&&y.resize()});a.setDelay(250);a.observe();Q=q.getUrlParamValue("dataSetId");X=q.getUrlParamValue("cacheId");n()};var E=function(){location.replace(location.href)},F=function(){Fa.closeCurrentTab()},e=function(){(new L).showDialog()},k=function(a){var g=v&&v.getJqUi();g=g&&g[0].offsetHeight;var R=y&&y.getJqUi(),D=B&&B.getJqUi();v&&v.isDisplay()?a?(B&&D.css("top",45+g),y&&
R.css("top",91+g)):(B&&D.css("top",45),y&&R.css("top",91)):(B&&D.css("top",0),y&&R.css("top",45))},n=function(){N.createFacade(function(a){var g=new ia;g.fromJsonObject(a);S=g.getDataSetType();Q=g.getDataSetId();X=g.getCacheId();g.hasModel()?(g.hasFilter()?t():(a={},a.dataSetId=Q,a.cacheId=X,w(a)),a=A,B=new I,g=B.getJqUi(),M.layoutCtrlWithLRTB(g,0,0,null,0,null,null),g.css({"padding-right":"0",height:"45px","padding-left":"15px"}),B.createButton(g,!1,E,va.get("refresh","\u5237\u65b0"),va.get("refresh",
"\u5237\u65b0")),10!==S&&3!==S&&B.createButton(g,!1,e,va.get("queryContentBtn","\u67e5\u770b\u6267\u884c\u8bed\u53e5"),va.get("previewQueryContent","\u67e5\u770b\u6267\u884c\u8bed\u53e5")),"true"!==C.decodeParamFromUrl(window.location.search,"isInDialog")&&B.createButton(g,!1,F,va.get("close","\u9000\u51fa"),va.get("close","\u9000\u51fa")),g.hide(),g.appendTo(a),y=new p,y.setFunExecute(u),y.getJqUi().appendTo(A)):com.kingdee.bos.qing.framework.common.RemoteFramework.openErrorPage("noDataSetModel")},
function(a,g){return 8099002===a||8099007===a||8099008===a||8077016===a||8099009===a||8099010<=a&&8099014>=a?(N.showDialogError(g),!0):!1}).loadDataSetInfo(Q,X)},t=function(){N.createFacade(function(a){var g=new H;g.fromJsonObject(a);v=new xa;v.setSchemaListPanel(new ea);v.setGlobal(N);v.setModels(Q,g,"",X);v.setFunExecute(u);v.setFunSwitchSchemaCallBack(f);a=v.getJqUi();if(v&&v.isDisplay()){var R=$("<div>");R.addClass("runtime-filter-container");var D=$("<div>");D.addClass("runtime-filter-menu");
var h=$("<div>");h.addClass("runtime-filter-tips");h.appendTo(D);var G=$("<div>");G.addClass("runtime-filter-tips-main");G.text(va.get("filterCondition","\u7b5b\u9009\u6761\u4ef6"));G.appendTo(h);b=$("<div>");b.addClass("runtime-filter-tips-sub");b.appendTo(h);m=$("<div>");m.addClass("runtime-filter-btn-spread");m.appendTo(D);l=$("<div>");l.addClass("runtime-filter-btn-spread-icon");l.appendTo(m);f(v.getCurrentSchemaInfo().getCaption());h=$("<div>");h.addClass("runtime-filter-btn-spread-text");h.text(va.get("spreadFilter",
"\u5c55\u5f00\u8fc7\u6ee4"));h.appendTo(m);m.on("click",c);D.appendTo(R);a.appendTo(R);R.appendTo(A);g.getHasDefaultEnter()?(d(!1),v.executeWithSchema(g)):d(!0)}else g={},g.dataSetId=Q,g.cacheId=X,w(g)},function(a,g){return 8099002===a||8099007===a||8099008===a||8077016===a||8099009===a||8099010<=a&&8099014>=a?(N.showDialogError(g),!0):8099101===a?(N.showDialogError(va.get("noDataCenterPermission","\u6ca1\u6709\u6570\u636e\u4e2d\u5fc3\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002")),
!0):8099102===a?(N.showDialogError(va.get("noSuperQueryPermission","\u6ca1\u6709\u5f53\u524d\u8d85\u7ea7\u67e5\u8be2\u6a21\u5f0f\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002")),!0):!1}).getDataSetFilterAndSchemaList(Q,X)},f=function(a){b.text(va.get("currentSchema","\u5f53\u524d\u65b9\u6848\uff1a")+a)},c=function(){var a=0!==m.find(".runtime-filter-btn-spread-icon").length;d(a)},d=function(a){var g=m.find(".runtime-filter-btn-spread-text");if(a){m.removeClass("runtime-filter-btn-spread");
m.addClass("runtime-filter-btn-pack-up");l.removeClass("runtime-filter-btn-spread-icon");l.addClass("runtime-filter-btn-pack-up-icon");var R=va.get("packUpFilter","\u6536\u8d77\u8fc7\u6ee4")}else m.removeClass("runtime-filter-btn-pack-up"),m.addClass("runtime-filter-btn-spread"),l.removeClass("runtime-filter-btn-pack-up-icon"),l.addClass("runtime-filter-btn-spread-icon"),R=va.get("spreadFilter","\u5c55\u5f00\u8fc7\u6ee4");g.text(R);v&&v.spreadOrPackUp(a);k(a)},u=function(){var a={};if(v&&v.isDisplay()){var g=
v.getParameValues();if(g.success)a.paramValues=g.data.paramValues;else{d(!0);N.getMessageCurtain().showPrompt(g.errMsg);return}}a.dataSetId=Q;a.cacheId=X;w(a)},w=function(a){var g=y?y.getPreviewLimitCount():p.PREVIEW_NUM_DEFAULT;a.limit=g&&"number"===typeof g?g:50;N.createFacade(function(R){B&&B.getJqUi().show();v&&v.isDisplay()&&d(!1);k(!1);T=R.queryContent;var D=new ra;D.fromJsonObject(R);y.setModelsAndUpdateUi(D)},function(R,D){return 8099002===R||8099007===R||8077016===R||8099008===R||8099010<=
R&&8099014>=R?(N.showDialogError(D),!0):8099101===R?(N.showDialogError(va.get("noDataCenterPermission","\u6ca1\u6709\u6570\u636e\u4e2d\u5fc3\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002")),!0):8099102===R?(N.showDialogError(va.get("noSuperQueryPermission","\u6ca1\u6709\u5f53\u524d\u8d85\u7ea7\u67e5\u8be2\u6a21\u5f0f\u7684\u6743\u9650\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5206\u914d\u6743\u9650\u3002")),!0):8099005===R?(N.showExecuteError(D),!0):8099006===
R?(N.getMessageCurtain().showPrompt(D),!0):!1}).applyDataSetFilter(a)}};var q,C,M,P,da,U,ka,I,J,Z,oa,ta,ja,va,Fa,wa,fa,ea,xa,ia,ra,H;(function(){var L=com.kingdee.bos.qing;q=L.Seer;L=com.kingdee.bos.qing.common;C=L.Util;M=L.DomUtil;L=com.kingdee.bos.qing.common.ui;P=L.TableUtil;L=com.kingdee.bos.qing.ui.component;da=L.Button;U=L.MessageCurtain;ka=L.AbstractModalDialog;I=L.Toolbar;J=L.ComboBox;Z=L.MessageDialog;oa=L.HelpIcon;L=com.kingdee.bos.qing.framework.common;ta=L.WebPageInitializer;ja=L.WindowResizeObserver;
va=L.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.filter);Fa=L.TabbedUiUtil;L=com.kingdee.bos.extreport.runtime.common;wa=L.DataSetFacade;fa=L.RemoteImpl;L=com.kingdee.bos.extreport.runtime.common.ui;xa=L.SchemaManagePanel;ea=L.RuntimeSchemaListPanel;L=com.kingdee.bos.extreport.runtime.model;H=L.FilterInfo;L=com.kingdee.bos.extreport.runtime.dataset.model;ia=L.DataSetRuntimeInfo;ra=L.DataSetResult})();p.PREVIEW_NUM_DEFAULT=50})();function Webreport(p,q,C,M){function P(){var r,z,x,K,ba;this.getJqUi=function(){r||V();return r};var V=function(){z=$("<div>");z.addClass("sa-ctrl-msgct-icon");x=$("<div>");x.addClass("sa-ctrl-msgct-title");K=$("<div>");K.addClass("sa-ctrl-msgct-text");ba=$("<div>");ba.addClass("sa-ctrl-msgct-close");ba.on("click",function(ca){qa()});com.kingdee.bos.qing.ui.component.Icons.background(ba,"msg-close");r=$('<div id="previewLimitShowPrompt">');r.addClass("sa-ctrl-msgct");r.css({display:"none"});r.append(z);
r.append(x);r.append(K);r.append(ba)};this.show=function(ca,Da){"none"==r.css("display")&&(com.kingdee.bos.qing.ui.component.Icons.background(z,"msg-prompt"),x.text(ca),K.text(Da),K.attr("title",Da),r.addClass("sa-ctrl-msgct_prompt"),ca=$(".extreport-reportui-sheet-container-parent",ka).position().top,r.css({"z-index":"0",display:"block",height:"45px",top:ca}),ba.css("display","block"))};var qa=function(){r.animate({height:"0px"},100,function(){r.css({display:"none"})});var ca=$(".extreport-reportui-sheet-container-parent",
ka).first(),Da=ca.position().top;ca.animate({top:Da-45},100)}}function da(){sa.updateUI(!0)}var U=this,ka=q,I,J=C.snapId,Z,oa,ta,ja=!C.isHideMenubarInReport,va=[],Fa=[],wa=[],fa=[],ea,xa,ia,ra,H,L,A=!0,B=new _Report;q=com.kingdee.bos.extreport.runtime.ui.SheetSwitcher;var b=com.kingdee.bos.extreport.runtime.ui.ReportUiFactory.getReportUi(p.getExhibitScene(),B,ka,p,C,M);b.setSheetSwitcher(new q);b.initUi();var m=new KRListenerProxy,l=com.kingdee.bos.qing.framework.common.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.filter),
y=com.kingdee.bos.qing.framework.common.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.linkage),v=com.kingdee.bos.extreport.runtime.chart.change,S=com.kingdee.bos.extreport.runtime.ui.AbstractReportUI,Q=com.kingdee.bos.extreport.runtime.common.ui.ImageViewUtil;this.createPage=function(r){I=r.getPageId();ta=r.isNeedFill();oa=r.isHasFilter();m.fireEvent({type:"create-page"})};this.loadReport=function(r,z){t={};f=0;Z=r;z?(I=z.name,Sa(z.reportInfo),b.showToolBar&&b.showToolBar()):
(r=p.createFacade(function(x){Sa(x);b.showToolBar&&b.showToolBar()},function(x,K){window.parent.postMessage({operation:"showError",iErrorCode:x,sErrorMsg:K},"*");return 8099001===x||8099006===x?(Ua().showPrompt(K),!0):8099008===x||8099010<=x&&8099014>=x||8099999===x?(p.showDialogError(K),!0):!1}),J?r.executeExtReportFromSnapContent(I):r.excuteExtReport(I,Z,C.isPreview))};this.updateUI=function(r){r||"true"!=C.isPreview||(L||(L=new P,L.getJqUi().appendTo(ka)),L.show(l.get("msgPrompt","\u63d0\u793a"),
l.get("previewLimitPrompt","\u9884\u89c8\u6570\u636e\u4ec5\u53d6\u90e8\u5206\u6570\u636e\u8ba1\u7b97\uff0c\u53d1\u5e03\u62a5\u8868\u540e\u53ef\u67e5\u770b\u6b63\u786e\u7684\u7edf\u8ba1\u7ed3\u679c\u3002")));b.syncHeight();b.renderReport();T()};this.updataTableByHasQingChart=function(){b&&b.updataTableByHasQingChart()};var X,T=function(){M||!ra||0>=ra||(X=setTimeout(function(){clearTimeout(X);oa?Qa():U.loadReport(Z,null)},ra))};this.addReportLoadedListener=function(r){m.addListener("report-loaded",
r)};this.addCreatePageListener=function(r){m.addListener("create-page",r)};this.addFilterListener=function(r){m.addListener("filter-ready",r)};this.refresh=function(r){this.loadReport(r,null)};this.applyFilter=function(r){this.loadReport(r,null)};this.repaint=function(){C.dashboardChartId?repaintDashboardChart():this.updateUI()};this.resize=function(r){b.resize(r)};this.setScrollBarVisible=function(r,z){var x=B.getCurrentSheet().getTable().getUI().firstChild;x&&(x.style.overflowX=r?"auto":"hidden",
x.style.overflowY=z?"auto":"hidden")};var N=function(r){var z=B.getCurrentSheet(),x=z.getTable();z.isNeedLoadTable()&&(x.setLargeDataMode(!0),x.addScrollToBottomListener(k));z.isTree()&&z.getTableRowCount()>Constants.TREE_ROW_COUNT&&x.addTreeExpandListener(Ka);x.setEmbedObjectRender(new c);x.addCellClickListener(pa);x.setSyncUIWhenModelChanged(!1);x.setSyncMergeBlockWhenModelChanged(!1);if(z=r.colList)for(var K=0;K<z.length;K++){var ba=z[K],V=x.addColumn();V.setWidth(ba.width);V.setHide(ba.isHided);
0!=ba.styleID&&V.setStyle(B.getCurrentSheet().getStyle(ba.styleID));0!=ba.borderStyleID&&V.setBorder(B.getCurrentSheet().getBorderStyle(ba.borderStyleID))}W(r)};this.getSchemeDefaultEnter=function(){return ia};var W=function(r){var z=B.getCurrentSheet().getTable();wa[ea]=0;var x=B.getCurrentSheet().isTree(),K=r.rowList;fa[ea]=0;if(K)for(var ba=K.length,V=0;V<ba;V++){var qa=K[V],ca=z.addRow();ca.setHeight(qa.height);ca.setHide(qa.isHided);qa.height&&!qa.isHided&&(fa[ea]+=qa.height);0!=ca.styleID&&
ca.setStyle(B.getCurrentSheet().getStyle(ca.styleID));0!=ca.borderStyleID&&ca.setBorder(B.getCurrentSheet().getBorderStyle(ca.borderStyleID));qa.cellList&&"null"!=qa.cellList&&F(ca,qa);x&&ca.setUserObject(qa.index)}for(x=0;x<z.getFrozenRows();x++)z.getRow(x)&&(wa[ea]+=z.getRow(x).getHeight());if(r=r.embedChartList)if(ja){for(x=ba=0;Fa[ea]&&Fa[ea].length&&0>x;x++)ba+=Fa[ea][x];for(x=0;x<r.length;x++)K=r[x],ca=(K.name+Math.random()).replace(/\./g,"_"),Da=K.left,V=K.top-ba,Ia=K.width,qa=K.height,ca=
new KTEmbedObject(ca,Da,V,Ia,qa),qa=V+qa-fa[ea],ca.setType(K.embedType),Da="subReport"==K.embedType?{name:K.name,anchorMode:0,reportInfo:K.reportInfo}:{chartID:K.chartID,name:K.name,type:K.type,dataSource:K.dataSource,dataSrc:K.dataSrc,embedCellPosition:K.embedCellPosition,transformableChart:K.transformableChart,anchorMode:K.anchorMode,positionCellLT:K.positionCellLT,positionCellRB:K.positionCellRB,hasLinkage:K.hasLinkage},ca.setUserObject(Da),1<Math.ceil((B.getCurrentSheet().getTableRowCount()-B.getCurrentSheet().getHiddenRowCount())/
200)&&0<qa&&0<fa[ea]-V&&ca.setHeight(fa[ea]-V),K.frozenFixed&&ca.setFrozenFixed(K.frozenFixed),z.addEmbedObject(ca)}else for(x=0;x<r.length;x++){K=r[x];a:{ba=z;V=K;for(qa=0;qa<ba.getEmbedObjects().length;qa++)if((ca=ba.getEmbedObjects()[qa].getUserObject())&&V.name==ca.name){ba=!0;break a}ba=!1}if(!ba){ca=(K.name+Math.random()).replace(/\./g,"_");var Da=K.left;V=K.top;var Ia=K.width;qa=K.height;ca=new KTEmbedObject(ca,Da,V,Ia,qa);ca.setType(K.embedType);Da="subReport"==K.embedType?{name:K.name,anchorMode:0,
reportInfo:K.reportInfo}:{chartID:K.chartID,name:K.name,type:K.type,dataSource:K.dataSource,dataSrc:K.dataSrc,embedCellPosition:K.embedCellPosition,transformableChart:K.transformableChart,anchorMode:K.anchorMode,positionCellLT:K.positionCellLT,positionCellRB:K.positionCellRB,hasLinkage:K.hasLinkage};ca.setUserObject(Da);K.frozenFixed&&ca.setFrozenFixed(K.frozenFixed);z.addEmbedObject(ca)}}},E=function(r){var z=B.getCurrentSheet().getTable();if(r=r.mergeBlocks)for(var x=0;x<r.length;x++){var K=r[x];
K=new KTMergeBlock(K.rowFrom,K.rowTo,K.colFrom,K.colTo);z.addMergeBlock(K)}},F=function(r,z){z=z.cellList;for(var x=0;x<z.length;x++){var K=z[x],ba=r.getCell(K.col);if("object"==typeof K.diagonal){var V=new KTDiagonalModel;V.setCrossRows(K.diagonal.crossRowSum);V.setCrossColumns(K.diagonal.crossColSum);V.setLinkToRows(K.diagonal.linkToRows);V.setLinkToColumns(K.diagonal.linkToCols);for(var qa=K.diagonal.triangles,ca=0;ca<qa.length;ca++){var Da=qa[ca];V.setText(Da.text,ca);V.setLean(Da.lean,ca);Da.style&&
V.setStyle(KReportUtil.getCssStyle(Da.style),ca);if(Da=qa[ca].slashStyle)Da=KReportUtil.getCssDiagonal(Da),V.setSlashBorder(Da,ca)}ba.setValue(V)}else K.value&&"null"!=K.value&&ba.setValue(K.value);if(!KReportUtil.isNullString(K.hyperLinks)&&K.hyperLinks)ba.setUserObject(K.hyperLinks);else if(!KReportUtil.isNullString(K.linkModels)&&K.linkModels){ba.setUserObject(K.linkModels);var Ia=new KTStyle;Ia.setColor("#5582f3");Ia.setUnderLine(!0);Ia.setCursor("pointer")}else K.linkTo&&"null"!=K.linkTo&&ba.setUserObject(K.linkTo);
"object"==typeof K.cellTree&&(V=new KTCellTreeModel(K.cellTree.level,K.cellTree.horizontal),V.setExpanded(K.cellTree.isExpanded),V.setHaveHandlerAlways(K.cellTree.haveHandler),ba.setTreeModel(V));0!=K.styleID&&((V=B.getCurrentSheet().getStyle(K.styleID))?Ia&&(V.getColor()||V.setColor("#5582f3"),V.setUnderLine(!0)):V=Ia,ba.setStyle(V),Ia=null,ba.getUserObject()&&V&&V.setCursor("pointer"));0!=K.borderStyleID&&ba.setBorder(B.getCurrentSheet().getBorderStyle(K.borderStyleID))}};q=function(r){r=r.sheetName;
d&&null!=d.getOperatingMenu()&&d.getOperatingMenu().closePopMenu();e(r)};var e=function(r,z){var x=B.getSheetByName(r);if(null!=x){ea=r;var K=null;null==x.getTable()?(K=p.createFacade(function(ba){va[ea]||(va[ea]={});va[ea][0]=ba.tableInfo;B.setCurrentSheet(x);x.fillIn(ba);var V=ba.tableInfo;V.rowList&&N(V);E(ba);b.update(!0);z&&z(x,r)},function(ba,V){return!1}),K.switchSheet(I,x.getName(),"false")):(K=p.createFacade(function(ba){B.setCurrentSheet(x);b.update();z&&z(x,r)},function(ba,V){return!1}),
K.switchSheet(I,x.getName(),"true"))}},k=function(r,z){B.getCurrentSheet().getLoadingFragment()||n()},n=function(){var r=B.getCurrentSheet();r.setLoadingFragment(!0);var z=r.getTable();p.createFacade(function(x){r.fillInStyle(x);W(x);r.setLoadedRowNum(z.getRowsCount()-1);z.lazyAppendData(!1);r.isNeedLoadTable()||z.removeScrollToBottomListener(k);r.setLoadingFragment(!1)},function(x,K){r.setLoadingFragment(!1);return!1}).loadFragment(I);z.lazyAppendData(!0)},t={},f=0,c=function(){KTDefaultEmbedObjectRender.call(this);
this.paintEmbedObject=function(x,K){var ba=x.getUserObject(),V=x.getType();if("imageChart"===V){var qa='<img src="',ca=ba.dataSrc;var Da=0===ca.toLowerCase().indexOf("http:")||0===ca.toLowerCase().indexOf("https:")?ca:com.kingdee.bos.qing.framework.common.RemoteFramework.getLoadImgUrl(ca,"export");qa=qa+Da+'" alt="\u56fe\u7247\u4e0d\u5b58\u5728" width="'+(x.getWidth()+'"');qa+=' height="'+x.getHeight()+'"';$(qa+">").appendTo(K);if(ca=ba.embedCellPosition)if(qa=B.getCurrentSheet().getTable(),ca=ca.split("_"),
qa=qa.getRow(ca[0]).getCell(ca[1]))if(ca=qa.getUserObject(),!ca||M&&"string"==typeof ca)K.css("cursor","pointer"),K.click(function(){Q.view(Da)});else{K.css("pointer-events","none");var Ia=!1,Na=f;for(Ra in t)t[Ra]===Da&&(Na=Ra,Ia=!0);Ia||(Na=++f,t[f]=Da);"string"==typeof ca?qa.setUserObject(ca+"$imageCacheKey$"+Na):ca.imageCacheKey=Na}}else if("flashChart"===V)Ca(x,ba,K);else if("subReport"===V)na(x,ba,K);else if("ECHART"===V||"QINGCHART"===V){var Ra=K[0];if(qa=a(ba.transformableChart)){var $a=75,
Wa=[],Va=com.kingdee.bos.extreport.runtime.chart.change;for(ca=0;ca<qa.length;ca++)Wa[ca]=new Va.ChartItemModel(qa[ca],v.getChartAlias(qa[ca])),Ia=r(Wa[ca].getChartAlias()),Ia>$a&&($a=Ia);Ra=$(Ra);var Oa=x.getId();Ra.click(function(){0!==$(".chart-selected").length&&$(".chart-selected").removeClass("chart-selected");0!==$(".chart-change-menu").length&&$(".chart-change-menu").remove();for(var Xa=$("div[id$="+Oa+"]"),bb=[],ab=0;ab<Xa.length;ab++){var db=$(Xa[ab]);bb.push(db);db.addClass("chart-selected")}var eb=
b.getCurrentScenario()==S.CARD_MOBILE;Xa=1;eb&&(Xa=localStorage.getItem(C.urlParams.extReportId+"_"+B.getCurrentSheet().getName()));for(ab=0;ab<bb.length;ab++){var Za=new com.kingdee.bos.qing.ui.component.ComboBox;Za.setItemModels(Wa);Za.setCustomPainter(Va.CustomPainter);Za.setDropdownListener(function(){if(eb&&b.protectedGetFullscreenState&&b.protectedGetFullscreenState()){var Ya=$(".sa-ctrl-common-popup");Ya&&Ya.css("left")&&Ya.css("left",Number(Ya.css("left").slice(0,-2))-8)}});Za.addSelectedChangedListener(function(Ya,
hb,fb){Ya={};Ya.pageId=I;Ya.currentSheetName=B.getCurrentSheet().getName();Ya.chartID=ba.chartID;Ya.chartType=fb.getChartName();ba.type=Ya.chartType;(new com.kingdee.bos.extreport.runtime.chart.change.ChartChangeFacadeImpl).chartChangeLink(Ya,g(x,ba,bb,V))});Za.getJqUi().removeClass("sa-ctrl-common-singlelineborder");Za=Za.getJqUi();Za.addClass("chart-change-menu");var cb=Number(db.css("top").slice(0,-2))-25,gb=Number(db.css("left").slice(0,-2));Za.css({top:cb,left:gb,width:22+$a});eb&&Za.css({transform:"scale("+
Xa+")","transform-origin":"0"});cb=navigator.userAgent.toLowerCase();cb=-1<cb.indexOf("trident")&&-1<cb.indexOf("rv:11.0");Za.appendTo(cb?K.parent().parent():bb[ab].parent())}})}"ECHART"===V?w(x,ba,K):R(x,ba,K)}};var r=function(x){z||(z=document.createElement("canvas"));var K=z.getContext("2d");K.font="12px Microsoft YaHei";return K.measureText(x).width},z},d,u=function(r){try{var z=window.top.document}catch(K){z=window.parent.document}var x=0;z&&(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||
z.msFullscreenElement)&&(z.exitFullScreen?z.exitFullScreen():z.webkitCancelFullScreen?z.webkitCancelFullScreen():z.msExitFullscreen?z.msExitFullscreen():z.mozCancelFullScreen&&(z.mozCancelFullScreen(),x=300));setTimeout(function(){r&&r()},x)},w=function(r,z,x){r=x[0];x=echarts.init(r,null,{renderer:"svg"});var K={_chartId:z.chartID};x.on("click",function(V){if(z.hasLinkage){var qa=new com.kingdee.bos.extreport.runtime.linkage.LinkageFacadeImpl,ca={};ca.pageId=I;ca.currentSheetName=B.getCurrentSheet().getName();
K._categoryName=V.name;K._seriesName=V.seriesName;var Da=(Da=V.value)&&Da instanceof Array?Da[0]:Da;K._seriesValue=Da;ca.sLinkSrc=JSON.stringify(K);ca.chartType="EChart";ca.componentIndex=V.componentIndex;ca.dataIndex=V.dataIndex;qa.lookForLinkageTargets(ca,h(ca))}});var ba=(new KDBase64).decode(z.dataSource);(new Function("chartDiv, myChart",ba))(r,x)},a=function(r){return r?r&&r.split(";"):null},g=function(r,z,x,K){return function(ba){if(ba){var V=new KDBase64;z.dataSource=V.encode(ba);if("ECHART"==
K)for(ba=0;ba<x.length;ba++)"chart-selected"===$(x[ba]).prop("class")&&w(r,z,x[ba]);else if("QINGCHART"==K)for(ba=0;ba<x.length;ba++)"chart-selected"===$(x[ba]).prop("class")&&R(r,z,x[ba]);b.afterChangeSheetUI()}}},R=function(r,z,x){var K=(new KDBase64).decode(z.dataSource),ba={_chartId:z.chartID};x.empty();x.css({left:r.getX(),top:r.getY(),width:r.getWidth(),height:r.getHeight(),position:"absolute",border:"1px solid"});(new Function("jqWebReportOwner, funChartDoDraw",K))(x,D(x,function(V,qa){if(z.hasLinkage){var ca=
new com.kingdee.bos.extreport.runtime.linkage.LinkageFacadeImpl,Da={};Da.pageId=I;Da.currentSheetName=B.getCurrentSheet().getName();ba._categoryName=V.getName();ba._seriesName=V.getSeriesName();ba._seriesValue=V.getValue();Da.sLinkSrc=JSON.stringify(ba);ca.lookForLinkageTargets(Da,h(Da,qa))}}))},D=function(r,z){var x=p.getExhibitScene(),K=x?-1<x.indexOf("mobile"):!1;return function(ba,V,qa,ca){ba=(new com.kingdee.cosmic.ctrl.rpt.qingchart.agent.QingFactory).createChartAgent(ba);ba.markFromWeb();!0===
K&&ba.markFromMobile();ba.setWebContainer(r);z&&ba.registerClickListener(z);ba.draw(V,qa,ca)}},h=function(r,z){var x=B.getCurrentSheet().getTable().getUI(),K=event;return function(ba){if(ba&&0!==ba.length){for(var V=[],qa=0;qa<ba.length;qa++){var ca=ba[qa],Da=ca.hyperLinks;if("innerLink"===ca.linkType)ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.setLinkType("innerLink"),V.push(ca);else if("outterLink"===ca.linkType)for(var Ia=0;Ia<Da.length;Ia++)ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,
ca.fromJson(Da[Ia]),ca.setLinkType("outterLink"),V.push(ca)}1!==V.length||"outterLink"!==V[0].getLinkType()&&"EChart"===r.chartType?za().prepare(V,x,G(r,z),M,K):G(r,z)(V[0])}}},G=function(r,z){return function(x,K,ba){var V=!1;"outterLink"===x.getLinkType()?(ba=Ea(x.getArrParam()),Ma(ba,x.getReportId(),x.getReportName(),x.getReportAlias(),x.getSystemId(),x.getDomain(),function(){K&&K.abandon()}),z&&z(!1)):"innerLink"===x.getLinkType()&&(z&&!ba&&(V=z("undefined"==typeof K)),V||ba||ma(r)?la(r):(new com.kingdee.bos.extreport.runtime.linkage.LinkageFacadeImpl).chartInnerLink(r,
Ba(r)))}},O={},aa={},Aa,la=function(r){var z=JSON.parse(r.sLinkSrc)._chartId,x=B.getCurrentSheet().getTable().getEmbedObjects(),K=B.getCurrentSheet().getTable().isSyncUIWhenModelChanged();B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(!0);var ba=aa[z];try{if(!ba)return;for(var V=0;V<x.length;V++){var qa=x[V].getUserObject();if(!(0>ba.indexOf(qa.name))&&O&&O[qa.name]){var ca=JSON.parse(O[qa.name]);qa.reportInfo=ca.reportInfo;qa.dataSource=ca.dataSource;x[V].setUserObject(qa);delete O[qa.name]}}}catch(Da){console.error(Da)}finally{"EChart"===
r.chartType&&ba&&0<ba.length&&(Aa=""),delete aa[z]}B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(K);b.afterChangeSheetUI()},Ba=function(r){return function(z){if(z&&(z.errorMessage&&!KReportUtil.isNullString(z.errorMessage)&&("dsb-mobile"==p.getExhibitScene()?b.showMsg("TOAST",z.errorMessage):KReportToast.toast({text:z.errorMessage})),z.embedDatas&&"null"!=z.embedDatas)){var x=JSON.parse(r.sLinkSrc)._chartId,K=B.getCurrentSheet().getTable().getEmbedObjects(),ba=B.getCurrentSheet().getTable().isSyncUIWhenModelChanged();
B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(!0);for(var V=0;V<z.embedDatas.length;V++)for(var qa=0;qa<K.length;qa++){var ca=K[qa].getUserObject();if(z.embedDatas[V].linkTo===ca.name){aa[x]?aa[x].push(ca.name):aa[x]=[ca.name];var Da=r;if("EChart"===Da.chartType){var Ia=parseInt(Da.componentIndex);Da=parseInt(Da.dataIndex);Aa=Ia<<8|Da}O[ca.name]=JSON.stringify(ca);if("subReport"===K[qa].getType()){ca.reportInfo=z.embedDatas[V].embedData;if(!ca.reportInfo)return;K[qa].setUserObject(ca)}else if("flashChart"===
K[qa].getType()||"ECHART"===K[qa].getType()||"QINGCHART"===K[qa].getType())ca.dataSource=z.embedDatas[V].embedData,K[qa].setUserObject(ca)}}B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(ba);b.afterChangeSheetUI()}}},ma=function(r){if("EChart"===r.chartType){var z=parseInt(r.componentIndex);r=parseInt(r.dataIndex);return Aa===(z<<8|r)}return!1},za=function(){d||(d=new com.kingdee.bos.extreport.runtime.popmenu.ui.PopMenuJumpHelper(b));return d},Ca=function(r,z,x){var K="kext_chart_"+x.attr("id"),
ba=FusionCharts(K);ba?ba.setXMLData(z.dataSource):(K={id:K,swfUrl:z.dataSrc,dataSource:z.dataSource,dataFormat:"XML",width:r.getWidth(),height:r.getHeight()},document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect&&(K.type=z.type),ba=new FusionCharts(K),x.css({left:r.getX(),top:r.getY(),width:r.getWidth(),height:r.getHeight()}),x.data("events")&&x.data("events").mousedown||x.mousedown(function(V){xa=V}));ba.render(x.attr("id"));b.addFusionChart(ba)},sa,
na=function(r,z,x){x.empty();sa=new Webreport(p,x,C,!0);x.css({left:r.getX(),top:r.getY(),width:r.getWidth(),height:r.getHeight(),zIndex:129});sa.addReportLoadedListener(da);sa.loadReport(null,z);x=z.reportInfo.currentSheet.tableInfo.colList;var K=z.reportInfo.currentSheet.tableInfo.rowList,ba=-2;z=-2;for(var V=0;V<x.length;V++)ba+=x[V].width;for(V=0;V<K.length;V++)z+=K[V].height;x=ba!=r.getWidth();r=z!=r.getHeight();x&&r||sa.setScrollBarVisible(x,r)};this.ChartsLinkHandler=function(r){r.pageId=I;
r.sheetName=B.getCurrentSheet().getName();r.isPreview=C.isPreview;p.createFacade(function(z){if(z)if(z.errorMessage&&!KReportUtil.isNullString(z.errorMessage)&&("dsb-mobile"==p.getExhibitScene()?b.showMsg("TOAST",z.errorMessage):KReportToast.toast({text:z.errorMessage})),"innerLink"==z.linkType&&z.embedDatas&&"null"!=z.embedDatas){var x=B.getCurrentSheet().getTable().getEmbedObjects(),K=B.getCurrentSheet().getTable().isSyncUIWhenModelChanged();B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(!0);
for(var ba=0;ba<z.embedDatas.length;ba++)for(var V=0;V<x.length;V++){var qa=x[V].getUserObject();if(z.embedDatas[ba].linkTo==qa.name)if(O[qa.name]=JSON.stringify(qa),"subReport"==x[V].getType()){qa.reportInfo=z.embedDatas[ba].embedData;if(!qa.reportInfo)return;x[V].setUserObject(qa)}else if("flashChart"==x[V].getType()||"ECHART"==x[V].getType()||"QINGCHART"==x[V].getType())qa.dataSource=z.embedDatas[ba].embedData,x[V].setUserObject(qa)}B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(K);b.afterChangeSheetUI()}else if("outterLink"==
z.linkType)if(x=z.hyperLinks,1==x.length)V=Ea(z.hyperLinks[0].paramValues),Ma(V,z.hyperLinks[0].reportId,z.hyperLinks[0].reportName,z.hyperLinks[0].reportAlias,z.hyperLinks[0].systemId,z.hyperLinks[0].domain);else{z=[];K=B.getCurrentSheet().getTable();for(V=0;V<x.length;V++)ba=new KTPopupMenuItem(x[V].reportAlias),ba.setUserObject({type:"hyperLink",extReportId:x[V].reportId,name:x[V].reportName,alias:x[V].reportAlias,params:x[V].paramValues,systemId:x[V].systemId,domain:x[V].domain,idList:x[V].idList,
url:x[V].url,uiType:x[V].uiType,operateState:x[V].operateState,ingoreParam:!0}),z.push(ba);V=function(ca){ca=ca.getUserObject();if(!KReportUtil.isNullString(ca.extReportId)){var Da=Ea(ca.params);Ma(Da,ca.extReportId,ca.name,ca.alias,ca.systemId,ca.domain)}};xa?K.popupMenu(xa.pageX,xa.pageY-50,z,V):K.popupMenu(50,50,z,V)}},function(z,x){return!1}).cellInnerLink(r)};var ha=null,pa=function(r,z){r=B.getCurrentSheet().getTable();var x=z.getCell();if(x&&x.getUserObject()){var K=x.getUserObject();if(z.isLeftButton()){z=
[];if(M||"string"!=typeof K){x=t[K.imageCacheKey];for(var ba=0;ba<K.length;ba++){var V=K[ba].hyperLinks;if("outterLink"===K[ba].linkType||"billLink"===K[ba].linkType||"stringLink"===K[ba].linkType)for(var qa=0;qa<V.length;qa++)"CUSTOM_HYPER"===V[qa].type?(ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.fromJson(V[qa]),ca.setLinkType("customHyper"),z.push(ca)):"BILL_HYPER"===V[qa].type?(ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.fromJson(V[qa]),ca.setLinkType("billHyper"),
z.push(ca)):"subReport"===V[qa].type?Ga(V[qa].cellName):"STRING_LINK"===V[qa].type?M||(ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.fromJson(V[qa]),ca.setLinkType("stringLink"),z.push(ca)):(ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.fromJson(V[qa]),ca.setLinkType("outterLink"),z.push(ca));else"innerLink"==K[ba].linkType&&(K[ba].params="",ha=K[ba],ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.setLinkType("innerLink"),z.unshift(ca))}}else if(K=
K.split("$Alias$"),ba=K[1].split("$imageCacheKey$"),1<ba.length){x=t[ba[1]];var ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem;ca.setLinkType("stringLink");ca.setReportName(K[0]);ca.setReportAlias(ba[0]);z.push(ca)}else{ya(K[0]);return}0<z.length&&(x&&(ca=new com.kingdee.bos.extreport.runtime.linkage.LinkageItem,ca.setUrl(x),ca.setLinkType("imgView"),z.unshift(ca)),za().prepare(z,r.getUI(),ua(),M))}}},ya=function(r){var z=B.getCurrentSheet(),x=r.lastIndexOf("!");x=r.substring(0,x);z.getName()===
x?Y(z,r):M||e(x,function(ba){Y(ba,r)});z=B.getSheetNames();for(var K=0;K<z.length;K++)if(z[K]===x){b.getSheetSwitcher().generateTabShow(K);break}},Y=function(r,z){r=r.getTable();var x=z.lastIndexOf("!"),K=z.substring(x+1);x=K.lastIndexOf("_");z=parseInt(K.substring(0,x));K=parseInt(K.substring(x+1));0>z||0>K||!r||(x=$(r.getUI()),z=r.getColumn(0==r.getColumnsCount()||z<r.getColumnsCount()?z:r.getColumnsCount()-1),K=r.getRow(0==r.getRowsCount()||K<r.getRowsCount()?K:r.getRowsCount()-1),r="#"+KTableUIAbstractView.createCellId(K,
z),(r=x[0].querySelector(r))&&r.scrollIntoView({behavior:"smooth"}))},ua=function(){return function(r,z,x){if("outterLink"===r.getLinkType()){var K=Ea(r.getArrParam()),ba=r.getReportId();z=r.getReportName();x=r.getSystemId();var V=r.getDomain();r=r.getReportAlias();Ma(K,ba,z,r,x,V)}else if("customHyper"===r.getLinkType())La(r);else if("billHyper"===r.getLinkType())Ja(r);else if("innerLink"===r.getLinkType()){if(null!=ha)if(x){r=B.getCurrentSheet().getTable().getEmbedObjects();z=B.getCurrentSheet().getTable().isSyncUIWhenModelChanged();
B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(!0);try{for(x=0;x<r.length;x++)K=r[x].getUserObject(),O&&O[K.name]&&(ba=JSON.parse(O[K.name]),K.reportInfo=ba.reportInfo,K.dataSource=ba.dataSource,r[x].setUserObject(K),delete O[K.name])}catch(qa){console.error(qa)}B.getCurrentSheet().getTable().setSyncUIWhenModelChanged(z);b.afterChangeSheetUI()}else U.ChartsLinkHandler(ha)}else"stringLink"===r.getLinkType()?ya(r.getReportName()):"imgView"===r.getLinkType()&&Q.view(r.getUrl())}},Ea=function(r){for(var z,
x,K={},ba="[",V=r.length-1;0<=V;V--){var qa=new ParamValue,ca=r[V];K[ca.name]=ca.values;var Da=ca.name.indexOf("_text");0>Da&&(z=K[ca.name+"_text"]);qa.setParamName(ca.name);qa.setDataType(ca.dataType);if(ca.values){ca=ca.values.split(/\1/);z&&0>=Da&&(x=z.split(/\1/),z=null);Da=0;for(var Ia=ca.length;Da<Ia;Da++){var Na=new ValueTextModel;x&&x[Da]?Na.setText(x[Da]):Na.setText(ca[Da]);Na.setValue(ca[Da]);qa.addValue(Na)}}else if(z&&0>=Da){if(x=z.split(/\1/),z=null,x)for(Da=0;Da<x.length;Da++)Na=new ValueTextModel,
x[Da]&&(Na.setText(x[Da]),Na.setValue(x[Da])),qa.addValue(Na)}else Na=new ValueTextModel,Na.setText(""),Na.setValue(""),qa.addValue(Na);1<ba.length&&(ba+=",",ba+="\r\n");ba+=qa.toJsonString()}return ba+"]"},Ma=function(r,z,x,K,ba,V,qa){(ba=r)&&(ba="{"+z+"-"+r+"}");var ca=hex_md5(ba);p.createFacade(function(Da){var Ia=com.kingdee.bos.qing.common.Util,Na=com.kingdee.bos.qing.SkinUtil,Ra=com.kingdee.bos.qing.framework.common.TabbedUiUtil,$a=Ia.decodeParamFromUrl(location.search,"path");Na=Na.getUrlParamValue();
var Wa=p.getExhibitScene(),Va=Wa?-1<Wa.indexOf("mobile"):!1;if(Va){Wa=C.urlParams.hyperlinkLevel?parseInt(C.urlParams.hyperlinkLevel):0;var Oa=$a+"/qing/extreportEntrance.do?isHyperlink=true";Oa=Ia.appendParamToUrl(Oa,"extReportId",z);Oa=Ia.appendParamToUrl(Oa,"extReportName",x);Oa=Ia.appendParamToUrl(Oa,"paramCacheId",Da);Oa=Ia.appendParamToUrl(Oa,"exhibitionScene",p.getExhibitScene());Oa=Ia.appendParamToUrl(Oa,"hyperlinkLevel",Wa+1);(Da=C.urlParams.extreportTopWidgetId)&&(Oa=Ia.appendParamToUrl(Oa,
"extreportTopWidgetId",Da));(Da=com.kingdee.bos.qing.Seer.getUrlParamValue("appType"))&&(Oa=Ia.appendParamToUrl(Oa,"appType",Da));(Da=com.kingdee.bos.qing.Seer.getUrlParamValue("kdcdc"))&&(Oa=Ia.appendParamToUrl(Oa,"kdcdc",Da))}else Oa=$a+"/qing_rpt/extReportHyperLink.do",Oa=Ia.appendParamToUrl(Oa,"extReportId",z),Oa=Ia.appendParamToUrl(Oa,"extReportName",x),Oa=Ia.appendParamToUrl(Oa,"paramCacheId",Da),Oa=Ia.appendParamToUrl(Oa,"isPreset","100000"==V?!0:!1),Oa=Ia.appendParamToUrl(Oa,"isPreview",C.isPreview);
Na&&(Oa=Ia.appendParamToUrl(Oa,"skin",Na));u(function(){if(Va)b.showLinkReport(Oa,x);else{var Xa=window.com.kingdee.bos.qing.AnalysisSceneOuterApi;if("report-widget"==Ia.decodeParamFromUrl(location.search,"exhibitionScene"))try{Xa=window.parent.com.kingdee.bos.qing.AnalysisSceneOuterApi}catch(ab){}if(Xa&&Xa.getFunOpenNewTab()){Xa=Xa.getFunOpenNewTab();Oa=Ia.appendParamToUrl(Oa,"markId",ca);var bb=Ia.decodeParamFromUrl(location.search,"pageId");Oa=Ia.appendParamToUrl(Oa,"pageId",bb);Oa=com.kingdee.bos.qing.integration.PageHelper.getIframeUrl(Oa);
Xa&&Xa(K,Oa,ca,"QingReport")}else Ra.openNewTab(K,Oa,ca)}});qa&&qa()},function(Da,Ia){return!1}).cacheParamValues(r)},La=function(r){p.createFacade(function(z){var x=com.kingdee.bos.qing.common.Util,K=com.kingdee.bos.qing.Seer.getUrlParamValue("clientID"),ba=x.decodeParamFromUrl(location.search,"pageId");z={pageId:ba,cacheId:z,customTargetClass:r.getUrl()};var V={methodParams:JSON.stringify(z),methodName:"linkageJump"};u(function(){top.window.invokeCustomEvent?top.window.invokeCustomEvent(ba,"",[K,
"QING_ANALYSIS",JSON.stringify(V)]):Ua().showPrompt(y.get("unsupportedCustomLinkage","\u4e0d\u652f\u6301\u4ee3\u7801\u5b9a\u5236\u8054\u67e5"))})},function(z,x){Ua().showPrompt(y.get("customLinkageError","\u4ee3\u7801\u5b9a\u5236\u8054\u67e5\u9519\u8bef\uff1a#1").replace("#1",x))}).cacheParamValues(r.getParams())},Ja=function(r){p.createFacade(function(z){var x=com.kingdee.bos.qing.common.Util,K=com.kingdee.bos.qing.Seer.getUrlParamValue("clientID"),ba=x.decodeParamFromUrl(location.search,"pageId");
x={UI_APPID:r.getSystemId(),UI_ID:r.getReportId(),UI_DETAIL:"UI_DETAIL"===r.getUiType()?"true":"false",UI_READ_ONLY:"VIEW"===r.getOperateState()?"true":"false"};z={pageId:ba,cacheId:z,rptBillInfo:JSON.stringify(x)};var V={methodParams:JSON.stringify(z),methodName:"linkageJump"};u(function(){top.window.invokeCustomEvent?top.window.invokeCustomEvent(ba,"",[K,"QING_ANALYSIS",JSON.stringify(V)]):Ua().showPrompt(y.get("unsupportedBillLinkage","\u4e0d\u652f\u6301\u5355\u636e\u8054\u67e5"))})},function(z,
x){Ua().showPrompt(y.get("billLinkageError","\u5355\u636e\u8054\u67e5\u9519\u8bef\uff1a#1").replace("#1",x))}).cacheParamValues(r.getParams())},Ga=function(r){r={pageId:I,name:r};KRemoteCaller().setCallback(function(z){sa.loadReport(null,userObject.reportInfo)}).request(_globalUrl+Webreport.CONSTANTS.lazyLoadTree,KReportUtil.toStr(r))},Ka=function(r,z){var x=B.getCurrentSheet().getTable();if(z.isExpanded()){var K=z.getCell(),ba=K.getTreeModel();if(ba.isHaveHandlerAlways()){var V=K.getUserObject();
"undefined"==typeof V&&(V={});if(!V.bLoaded&&(x.lazyAppendDataByTree(!0,ba),!ba.isHorizontal())){var qa=z.getRowIdx(),ca=z.getColIdx();z=x.getRow(qa);r=z.getUserObject();K=z.getCell(ca);ba=K.getTreeModel();z=ba.getLevel();var Da=x.searchMergeBlock(qa,ca),Ia=1;Da&&(ca=Da.getRowIdxFrom(),Da=Da.getRowIdxTo(),Ia+=Da-ca);p.createFacade(function(Na){B.getCurrentSheet().fillInStyle(Na);var Ra=qa+Ia;if(Na=Na.rowList)for(var $a=B.getCurrentSheet().getTable(),Wa=0;Wa<Na.length;Wa++){var Va=Na[Wa],Oa=$a.insertRow(Ra+
Wa);Oa.setHide(!1);Oa.setHeight(Va.height);"object"==typeof Va.style&&Oa.setStyle(KReportUtil.getCssStyle(Va.style));"object"==typeof Va.border&&Oa.setBorder(KReportUtil.getCssBorder(Va.border));Va.cellList&&F(Oa,Va);Oa.setUserObject(Va.index)}V.bLoaded=!0;K.setUserObject(V);x.lazyAppendDataByTree(!1,ba)},function(Na,Ra){return!1}).lazyLoadTree(I,r+Ia,z+1)}}}};this.hasFilter=function(){return oa};this.needFill=function(){return ta};this.getReportUI=function(){return b};this.isAllParamsHided=function(){if(b.getFilter())return!b.getFilter().isDispalay()};
this.getParams=function(r){r={pageId:I,paramCacheId:r,schemaBiztagId:b.getSchemaBiztagId()};p.createFacade(function(z){if(z){var x=new com.kingdee.bos.extreport.runtime.model.FilterInfo;x.fromJsonObject(z);b.paintFilterPanel(I,x);x=C.affectedParams;z.hasDefaultEnter||x?(x=z.hasDefaultEnter?ia=z.defaultEnter:z.schemeList[0].caption,m.fireEvent({type:"filter-ready"}),z.associate&&0<Object.keys(z.associate).length?b.switchSchemaByName(z.shareStrategy,x,z.isHyperLink,function(){z.isHyperLink||Qa({type:"query-click",
filterHide:!0,hasDefaultEnter:!0})}):(b.switchSchemaByName(z.shareStrategy,x,z.isHyperLink),z.isHyperLink||Qa({type:"query-click",filterHide:!0,hasDefaultEnter:!0}))):m.fireEvent({type:"filter-ready"})}else m.fireEvent({type:"filter-ready"})},function(z,x){return 8099008===z||8099010<=z&&8099014>=z?(p.showDialogError(x),!0):!1}).getFilter(r)};this.popFilter=function(){b.showOrHideFilterPane(!0)};var Qa=function(r){var z=b.getSelectedSchemeName(),x=b.getDefaultCheckBoxStatus(),K=C.affectedParams;K&&
Ha(K);z=b.getFilter().execute(z,x);(x=C.urlParams)||(x={});if(z.success){r=$.extend({},x,z.data,{isPreview:C.isPreview});K=p.createFacade(function(V){b.showOrHideFilterPane(!1);Sa(V);b.showToolBar&&b.showToolBar()},function(V,qa){return 8099001===V?(Ua().showPrompt(qa),!0):8099006===V?(Ua().showPrompt(qa),U.popFilter(),!0):8099008===V||8099010<=V&&8099014>=V||8099999===V?(p.showDialogError(qa),!0):!1});try{var ba=window.parent.com.kingdee.bos.qing.workbench}catch(V){}ba&&window.parent.postMessage({messageFrom:"QingRpt",
targetWidgetId:x.extreportWidgetId,filterValues:z.data.paramValues},"*");K.applyFilter(r)}else r.hasDefaultEnter?U.popFilter():(r.filterHide=!1,(ba=p.getExhibitScene())&&-1<ba.indexOf("mobile")?b.showMsg("TOAST",z.errMsg):Ua().showPrompt(z.errMsg))},Ha=function(r){var z=b.getFilter();r=JSON.parse(r);for(var x in r){var K=r[x],ba=z.getCtrl(x);if(ba){ba=ba.getParamDescription().getDataType();var V=K;for(var qa=ba,ca=[],Da=V.length,Ia=0;Ia<Da;Ia++){var Na=V[Ia];Na=Pa(Na,qa);var Ra={};Ra.text=Na;Ra.value=
Na;ca.push(Ra)}V=ca;if("Date"==ba||"DateTime"==ba||"Time"==ba)K[0]=V[0].value;z.updateParamByName(x,K)}}},Pa=function(r,z){if(r){var x=0,K=r.substring(0,4);if(4===r.length)x=12;else if(5===r.length)x=r.substring(4),x=3*parseInt(x);else if(6===r.length)x=r.substring(4);else if(8===r.length){x=r.substring(4,6);var ba=r.substring(6)}var V=parseInt(x);switch(V){case 1:case 3:case 5:case 7:case 8:case 10:case 12:10>V&&(x="0"+V);x=ba?x+"-"+ba:x+"-31";break;case 4:case 6:case 9:case 11:10>V&&(x="0"+V);x=
ba?x+"-"+ba:x+"-30";break;case 2:x="0"+V,x=ba?x+"-"+ba:0==parseInt(K)%4&&0!=parseInt(K)%400?x+"-29":x+"-28"}if("Date"==z)return K+"-"+x;if("DateTime"==z)return K+"-"+x+" 00:00:00";if("Time"==z)return"00:00:00"}return r},Sa=function(r){A&&(A=!1);ja&&(ea=r.currentSheet.name,va[ea]={},Fa[ea]=[],fa[ea]=0,va[ea][0]=r.currentSheet.tableInfo);ra=r.refreshRate;B.fillIn(r);var z=r.currentSheet;N(z.tableInfo);E(z);z=r.sheetNameList;for(var x=0;x<z.length;x++)if(z[x]==r.currentSheet.name){b.getSheetSwitcher().setInitTab(x);
break}m.fireEvent({type:"report-loaded"})},Ta=function(r){p.createFacade(function(z){b.getFilter().setSchemeList(z);b.paintFilterPanel(I,b.getFilter())},function(z,x){return!1}).getFilterSchemes(I,r.flag)},Ua=function(){var r=com.kingdee.bos.qing.ui.component.MessageCurtain;H||(H=new r,H.getJqUi().appendTo(document.body));return H};b.addUpdateDataListener(function(){oa?Qa():U.loadReport(Z,null)});M||(b.addChangeSheetListener(q),b.addApplyFilterListener(Qa),b.addStrategyItemListener(Ta))}
Webreport.CONSTANTS={unifiedEntrance:"?webJson=",getFilter:"getFilter",loadReport:"loadReport",loadFragment:"loadFragment",lazyLoadTree:"lazyLoadTree",applyFilter:"applyFilter",switchSheet:"switchSheet",cacheParamValues:"cacheParamValues",getFilterSchemes:"getFilterSchemes",delFilterScheme:"delFilterScheme",saveFilterScheme:"saveFilterScheme",pingReport:"ping"};(function(){function p(E,F){v.call(this);var e,k,n=this,t=n.protectedMethod,f,c,d,u;this.setSwitchCallBack=function(a){c=a};this.setOpFuns=function(a){f=a};this.paint=function(a){e=$("<div>");e.css({height:"30px",width:"100%"});k=$("<div>");k.addClass("extreport-card-filter-allscheme");var g=$("<span>");g.addClass("extreport-card-filter-scheme-lable");g.text(m.get("commonUsedSchema","\u5e38\u7528\u65b9\u6848\uff1a"));var R=t.getSchemas();d=new ea;d.setItemModels(R);d.setSelected(R[0]);t.updateCurrent(R[0]);
d.setCustomPainter(function(D,h,G){1<R.length&&h.css("height","25px");h.text(G.getCaption())});d.setTooltips(d.getSelected().getCaption());d.addSelectedChangedListener(function(D,h,G){n.switchSchema(G)});u=d.getJqUi();u.addClass("extreport-card-filter-scheme-combobox");g.appendTo(k);u.appendTo(k);k.appendTo(e);F&&(g=$("<div>"),g.addClass("extreport-card-filter-all-toolbar"),w(m.get("remove","\u5220\u9664"),g,f.remove),w(m.get("saveAs","\u53e6\u5b58\u4e3a"),g,function(){f.saveAs();E&&$(".sa-ctrl-dialog").css("top",
"200px")}),w(m.get("save","\u4fdd\u5b58"),g,function(){f.save(n.getCurrentSchema().getCaption())}),g.appendTo(e));e.appendTo(a)};this.switchSchema=function(a,g){a||(a=n.getCurrentSchema());d.setSelected(a);d.setTooltips(d.getSelected().getCaption());t.updateCurrent(a);c&&c(a,g)};this.updateListUi=function(){var a=t.getSchemas();d.setItemModels(a);d.setSelected(n.getCurrentSchema());d.setTooltips(d.getSelected().getCaption())};var w=function(a,g,R){var D=$("<div>");D.addClass("extreport-card-filter-toolbar-common");
D.text(a);D.on("click",R);D.appendTo(g)}}function q(E,F,e,k,n){ta.call(this,E,k,n);var t=this,f,c=!1,d=new KRListenerProxy;this.initUi=function(){throw Error("Overwrite me!");};this.paintFilterPanel=function(){throw Error("Overwrite me!");};this.getSchemaBiztagId=function(){return null};this.showOrHideFilterPane=function(a){throw Error("Overwrite me!");};this.syncHeight=function(){};this.getFilter=function(){return f.getFilter()};this.getSelectedSchemeName=function(){return f.getCurrentSelScheme().getCaption()};
this.getDefaultCheckBoxStatus=function(){return f.getDefaultCheckBoxStatus()};this.switchSchemaByName=function(a,g,R,D){f.switchSchemaByName(g,D)};this.addApplyFilterListener=function(a){d.addListener("query-click",a)};this.addUpdateDataListener=function(a){d.addListener("update-click",a)};this.addStrategyItemListener=function(a){d.addListener("strategy-click",a)};this.protectedDoBeforeFullscreen=function(){return!0};this.protectedFullScreenChanged=function(a){throw Error("Implement me!");};this.getCurrentScenario=
function(){return q.WEB};this.getSchemaPanel=function(){return f};var u=function(a){if(a==F[0])c=!0,a=F.parent(),F.data("myParent",a),F.data("myZIndex",F.css("z-index")),F.detach(),F.appendTo($(document.body)),F.addClass("extreport-card-fullscreen"),F.css("z-index",128);else{c=!1;B.removeChangedListener(u);a=F.data("myParent");var g=F.data("myZIndex");F.removeData("myParent");F.detach();F.appendTo(a);F.removeClass("extreport-card-fullscreen");F.css("z-index",g)}t.protectedFullScreenChanged(c)},w=
function(a,g,R,D){var h=a.data("menu");if(h&&h.isShowing())a.data("menu",null),h.hide();else{h=new ra;h.setModel(R());h.setHideListener(function(){a.data("menu",null)});a.data("menu",h);R=a.prop("offsetLeft");var G=a.prop("offsetHeight")+a.prop("offsetTop");h.show(D,R,G,g,!0)}};this.protectedMethods.doRefresh=function(){var a=location.href;try{window.frameElement&&(a=window.frameElement.src)}catch(g){}location.replace(a)};this.protectedMethods.doFullScreen=function(){t.protectedDoBeforeFullscreen()&&
(B.removeChangedListener(u),B.addChangedListener(u),c?B.exit():B.request(F[0]))};this.protectedMethods.doExport=function(a){var g=com.kingdee.bos.extreport.runtime.exportmanage.ExportMenuCreator,R=com.kingdee.bos.qing.ui.component.ToolbarButton,D=com.kingdee.bos.extreport.manage.common.Icons,h={snapId:wa.getUrlParamValue("snapId"),publishId:wa.getUrlParamValue("publishId"),snapGroupType:wa.getUrlParamValue("snapGroupType"),extReportId:wa.getUrlParamValue("extReportId"),isPreview:wa.getUrlParamValue("isPreview"),
isHyperlink:wa.getUrlParamValue("isHyperlink"),currentUserId:k.currentUserId,exportSetting:k.exportSetting,exportConfig:"",isMegerExport:!0,createFacade:e.createFacade,createJsonModelWrapper:function(){var G={};G.pageId=k.pageId;G.exportSetting=this.exportSetting;G.exportConfig=this.exportConfig;G.isMegerExport=this.isMegerExport;return G},getExportSetting:function(){return this.exportSetting},setExportSetting:function(G){this.exportSetting=G},getExportConfig:function(){return this.exportConfig},
setExportConfig:function(G){this.exportConfig=G},getMegerExport:function(){return this.isMegerExport},setMegerExport:function(G){this.isMegerExport=G}};g=(new g).create(k.hasExportPermission,k.hasPrintPermission,h,function(G,O,aa){var Aa=new R;Aa.setIconSetter(function(la,Ba){D.background(la,Ba)});Aa.setIconName(O);Aa.setText(aa);Aa.setTooltips(aa);Aa.setShowDropdownArrow(!0);Aa.addActionListener(function(la,Ba){w(la.getJqUi(),Ba,function(){return G},a)});Aa.getJqUi().appendTo(a);return Aa},function(G,
O){return m.get(G,O)},k.rptName);for(h=0;h<g.length;h++)g[h].setEnabled(!0)};this.protectedMethods.queryData=function(a){d.fireEvent({type:"query-click",filterHide:!0});a()};this.protectedMethods.updateData=function(a){d.fireEvent({type:"update-click"});a()};this.protectedMethods.setSchemaManagePanel=function(a){f=a}}function C(E,F,e,k,n){q.call(this,E,F,e,k,n);var t=this.protectedMethods,f=this,c,d,u,w,a,g,R,D,h,G,O=k.isHasFilter;this.initUi=function(){c=$("<div>");c.appendTo(F);A.layoutCtrlWithLRTB(c,
0,0,null,0,0,null);!n&&c.addClass("extreport-reportui-container");t.addReportReadyListener(Ba);w=t.getSheetContainer(c);!n&&w.css("background","#e2e7ef");F.css("background-color","#ffffff")};this.paintFilterPanel=function(pa,ya){aa(pa,ya);O&&!n&&D&&f.getFilter().isDispalay()&&(d.appendTo(c),u&&(u.remove(),u=null),u=D.getJqUi(),sa(D.getCurrentSchemaInfo().getCaption()),u.appendTo(d),f.showOrHideFilterPane(!1))};this.resize=function(pa){F.height(pa);f.adjustSheetContainerSize();D&&D.getJqUi();f.syncHeight()};
this.getSchemaBiztagId=function(){var pa=wa.getUrlParamValue("publishId");return pa?pa:wa.getUrlParamValue("extReportId")};this.showOrHideFilterPane=function(pa){var ya=g.find(".runtime-filter-btn-spread-text");if(pa){g.removeClass("runtime-filter-btn-spread");g.addClass("runtime-filter-btn-pack-up");R.removeClass("runtime-filter-btn-spread-icon");R.addClass("runtime-filter-btn-pack-up-icon");var Y=m.get("packUpFilter","\u6536\u8d77\u8fc7\u6ee4")}else g.removeClass("runtime-filter-btn-pack-up"),g.addClass("runtime-filter-btn-spread"),
R.removeClass("runtime-filter-btn-pack-up-icon"),R.addClass("runtime-filter-btn-spread-icon"),Y=m.get("spreadFilter","\u5c55\u5f00\u8fc7\u6ee4");ya.text(Y);D&&D.spreadOrPackUp(pa);f.syncHeight();f.adjustSheetContainerSize()};this.syncHeight=function(){var pa=0;if(!n){var ya=u&&u[0].offsetHeight;pa=D?45:0;u&&D.isDisplay()?pa=pa+ya+45:k.isHasFilter||(pa+=45);ya=F.find("#previewLimitShowPrompt");ya.css("display")&&"none"!=ya.css("display")&&(ya.css("top",pa),pa+=45)}w.css("top",pa+"px")};this.protectedFullScreenChanged=
function(pa){console.log("do nothing")};this.showToolBar=function(){G&&G.getJqUi().show()};this.getCurrentScenario=function(){return q.WEB};var aa=function(pa,ya){h=new Q;D=new S;t.setSchemaManagePanel(D);D.setSchemaListPanel(h);D.setGlobal(e);D.setFunExecute(function(){t.queryData(ha)});D.setFunSwitchSchemaCallBack(sa);d=$("<div>");d.addClass("runtime-filter-container-rpt");D.setModels(pa,ya,f.getSchemaBiztagId());D.getJqUi();Aa(d)},Aa=function(pa){var ya=$("<div>");ya.addClass("runtime-filter-menu");
var Y=$("<div>");Y.addClass("runtime-filter-tips");Y.appendTo(ya);var ua=$("<div>");ua.addClass("runtime-filter-tips-main");ua.text(m.get("filterCondition","\u7b5b\u9009\u6761\u4ef6"));ua.appendTo(Y);a=$("<div>");a.addClass("runtime-filter-tips-sub");a.appendTo(Y);g=$("<div>");g.addClass("runtime-filter-btn-spread");g.appendTo(ya);R=$("<div>");R.addClass("runtime-filter-btn-spread-icon");R.appendTo(g);Y=$("<div>");Y.addClass("runtime-filter-btn-spread-text");Y.text(m.get("spreadFilter","\u5c55\u5f00\u8fc7\u6ee4"));
Y.appendTo(g);g.on("click",la);ya.appendTo(pa)},la=function(){var pa=0!==g.find(".runtime-filter-btn-spread-icon").length;f.showOrHideFilterPane(pa)},Ba=function(){if(!n&&!G){G=new ia;var pa=G.getJqUi();pa.addClass("runtime-toolbar");t.doExport(pa);if(k.hasEditSnapshotPermission&&k.snapId){var ya=m.get("edit","\u7f16\u8f91");G.createButton(pa,!1,Ca,ya,ya)}k.hasSaveSnapshotPermission&&(k.snapId?(ya=m.get("saveAs","\u53e6\u5b58\u4e3a"),G.createButton(pa,!1,za,ya,ya)):(ya=m.get("saveSnap","\u4fdd\u5b58\u5feb\u7167"),
G.createButton(pa,!1,za,ya,ya)));k.snapId?G.createButton(pa,!1,t.doRefresh,m.get("refresh","\u5237\u65b0"),m.get("refresh","\u5237\u65b0")):G.createButton(pa,!1,function(){t.updateData(ha)},m.get("refresh","\u5237\u65b0"),m.get("refresh","\u5237\u65b0"));G.createButton(pa,!1,na,m.get("close","\u9000\u51fa"),m.get("close","\u9000\u51fa"));ma(pa);pa.appendTo(c);f.syncHeight()}},ma=function(pa){var ya=new X,Y=[],ua=k.spaceType;if(k.snapId){ua=new T(m.get("lastModifier","\u6700\u540e\u4fee\u6539\u4eba\uff1a"),
k.sSnapModifier);var Ea=new T(m.get("lastModifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a"),k.sSnapModifyDate);Y.push(ua);Y.push(Ea)}else if(ua==N.USER&&k.creatorName&&k.createTime||ua==N.PRESET)k.isPreview?(ua=new T(m.get("creator","\u521b\u5efa\u4eba\uff1a"),k.creatorName),Ea=new T(m.get("createTime","\u521b\u5efa\u65f6\u95f4\uff1a"),k.createTime),Y.push(ua),Y.push(Ea)):(Ea=new T(m.get("publisherName","\u53d1\u5e03\u4eba\uff1a"),k.sPubModifier),ua=new T(m.get("lastModifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a"),
k.sPubUpdateTime),Y.push(Ea),Y.push(ua));else if(ua==N.COLLABORATION)if(k.isPreview)ua=new T(m.get("lastModifier","\u6700\u540e\u4fee\u6539\u4eba\uff1a"),k.sTemplateModifier),Ea=new T(m.get("lastModifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a"),k.sTemplateUpdateTime),Y.push(ua),Y.push(Ea);else{Ea=new T(m.get("spaceName","\u6240\u5c5e\u534f\u4f5c\u7a7a\u95f4\uff1a"),k.spaceName);var Ma=new T(m.get("spaceCreator","\u7a7a\u95f4\u521b\u5efa\u8005\uff1a"),k.spaceCreatorName);ua=new T(m.get("lastModifyTime",
"\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a"),k.sPubUpdateTime);Y.push(Ea);Y.push(Ma);Y.push(ua)}else ua=new T(m.get("extReportDeleted","\u8be5\u62a5\u8868\u5df2\u88ab\u5220\u9664"),null),Y.push(ua);ya.setTips(Y);ya.setRight(25);ya=ya.getJqUi();ya.css({top:"unset","margin-top":"15px"});ya.appendTo(pa)},za=function(){var pa=function(ya){e.getMessageCurtain().showSuccess("\u201c"+ya.getSnapName()+"\u201d"+m.get("saveSnapSuccess","\u4fdd\u5b58\u5feb\u7167\u6210\u529f\u3002"),2E3);com.kingdee.bos.extreport.manage.common.UserOperationReporter.occur(com.kingdee.bos.extreport.manage.common.UserOperationReporter.SAVE_SNAP_TO_TYPE,
ya.getSnapName())};e.createFacade(function(ya){ya=new SaveSnapDialog(SaveSnapSourceType.RUNTIME,m.get("saveSnap","\u4fdd\u5b58\u5feb\u7167"),k);ya.addSuccessCallback(pa);ya.showDialog()},function(ya,Y){8099101==ya?e.getMessageCurtain().showPrompt(m.get("querySnapCenterPermExp","\u67e5\u8be2\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u5f02\u5e38\u3002"),2E3):8099102==ya?e.getMessageCurtain().showPrompt(m.get("noQuerySnapCenterPermExp","\u5f53\u524d\u7528\u6237\u6ca1\u6709\u5feb\u7167\u4e2d\u5fc3\u6743\u9650\u3002"),
2E3):e.getMessageCurtain().showPrompt(Y,2E3);return!0}).checkSnapOperPermission(!0,!0,k.snapId,!0,!1)},Ca=function(){e.createFacade(function(pa){pa=com.kingdee.bos.extreport.launcher.Launcher;pa.addRefreshListener(function(){location.replace(location.href)});pa.sendLaunchxletCommandOpenExtReportSnapEditor(k.extReportId,k.snapId,k.snapName,function(){if("A"==wa.getUrlParamValue("snapGroupType")){var ya=com.kingdee.bos.qing.behavior.BehaviorManager,Y=l.createUUID();ya.initAccessRecordParams(k.snapId,
Y,ya.SourceType.QING_SNAPSHOT,ya.AppType.QING_RPT);ya.recordResourceOperation(ya.OperationType.QING_SNAPSHOT_EDIT)}})},function(pa,ya){e.getMessageCurtain().showPrompt(ya,2E3);return!0}).checkSnapOperPermission(!0,!0,k.snapId,!1,!0)},sa=function(pa){a.text(m.get("currentSchema","\u5f53\u524d\u65b9\u6848\uff1a")+pa)},na=function(){var pa=window.com.kingdee.bos.qing.AnalysisSceneOuterApi;pa&&(pa.inside.setDirtyChecker(function(){return!1}),pa.inside.setBeforeClosing(function(){return TabStatusHelper.setTabStatus(!1)}));
pa?pa.inside.requestClosing():com.kingdee.bos.qing.framework.common.TabbedUiUtil.closeCurrentTab()},ha=function(){f.syncHeight()}}function M(E,F,e,k,n){I.call(this,E,F,e,k,n);var t=this.protectedMethods,f;this.getSchemaBiztagId=function(){return wa.getUrlParamValue("publishId")};this.protectedCreateHeadbar=function(d,u){u=d;u.addClass("extreport-card-headbar");d=$("<div>");d.appendTo(u);d.addClass("extreport-card-headbar-title");t.createHeadbarIcon(u,"others",m.get("othersMore","\u66f4\u591a"),24,
t.doOthersClicked);t.createHeadbarIcon(u,"filter",m.get("filter","\u8fc7\u6ee4"),24,t.doClickFilterBtn)};this.protectedGetInnerPane=function(d,u){if(!f){f=$("<div>");f.addClass("extreport-card-headbar-otherbtn-pane");var w=$("<div>");w.addClass("extreport-card-headbar-inner-btn extreport-card-activebutton");y.background(w,"refresh");w.attr("title",m.get("refresh","\u5237\u65b0"));w.on("click",c);w.appendTo(f);d.push(w);f.appendTo(u)}return f};this.protectedFullScreenChanged=function(d){};this.protectedDoBeforeFullscreen=
function(){};var c=function(){}}function P(E,F,e,k,n){}function da(E,F,e,k,n){I.call(this,E,F,e,k,n);Z.call(this);var t=this.protectedMethods,f,c,d=this.getExtreportWidgetInfo();window.addEventListener("message",function(u){u=u.data;u.extreportCardMsg&&"filter"==u.extreportCardMsg&&t.doClickFilterBtn()});this.getSchemaBiztagId=function(){return t.getSchemaBiztagId()};this.protectedFullScreenChanged=function(u){};this.protectedDoBeforeFullscreen=function(){if(d.isDesignTime()){var u=new H;u.setText(m.get("canFullscreenAfterPub",
"\u5168\u5c4f\uff0c\u53d1\u5e03\u540e\u751f\u6548\u3002"));u.show(c,!0);return!1}return!0};this.protectedCreateHeadbar=function(u,w){};this.protectedGetInnerPane=function(u,w){f||(f=$("<div>"),f.addClass("extreport-card-headbar-otherbtn-pane"),c=$("<div>"),c.addClass("extreport-card-headbar-inner-btn extreport-card-activebutton"),y.background(c,"fullscreen"),c.attr("title",m.get("fullScreen","\u5168\u5c4f")),c.on("click",t.doFullScreen),c.appendTo(f),u.push(c),f.appendTo(w));d&&d.isInWidgetPanel()&&
f.css("right","0px");return f}}function U(E,F,e,k,n){J.call(this,E,F,e,k,n);Z.call(this,E,F,e,k,n);var t=this.protectedMethods,f=Fa.MobileFullscreenUtil.getFullscreenState()||e.islinkReport();window.addEventListener("message",function(c){c=c.data;c.extreportCardMsg&&(c=c.extreportCardMsg,"filter"==c?t.toggleFilterPanel():"closeFullScreen"==c?(f=!1,Fa.MobileFullscreenUtil.setFullscreenState(f),t.doCloseFullscreen()):"clickFullscreen"==c&&(f=!0,Fa.MobileFullscreenUtil.setFullscreenState(f),t.doClickFullscreen()))});
this.getSchemaBiztagId=function(){return t.getSchemaBiztagId()};this.protectedInitUi=function(c,d){};this.protectedGetFullscreenState=function(){return f};this.protectedRequestDoFullscreen=function(){t.postEvent("requestWidgetFullscreen")};this.resize=function(c){}}function ka(E,F,e,k,n){da.call(this,E,F,e,k,n);var t=this.protectedMethods,f=this,c,d,u,w,a,g,R=f.getExtreportWidgetInfo(),D,h,G,O="true"===wa.getUrlParamValue("isFullScreen"),aa=wa.getUrlParamValue("extReportName");window.addEventListener("message",
function(sa){sa=sa.data;if(sa.workbenchExtReportCardMsg)if("updateCardTitle"===sa.workbenchExtReportCardMsg)u.text(sa.param),Ca();else if("refreshCard"===sa.workbenchExtReportCardMsg&&(sa=wa.getUrlParamValue("extreportWidgetId"))){sa=$("body",parent.document).find("#"+sa);var na=sa.attr("src");na=na.replace("isFullScreen=false","isFullScreen="+O).replace("isFullScreen=true","isFullScreen="+O).replace("extReportName="+window.encodeURIComponent(aa),"extReportName="+window.encodeURIComponent(u.text()));
sa.attr("src",na);window.location.href=na}});this.protectedCreateHeadbar=function(sa,na){c=na;d=sa;c.addClass("extreport-card-headbar");d.addClass("extreport-workbench-card-content");sa=$("<div>");na=$("<div>");y.background(na,"extreport");na.addClass("extreport-workbench-card-icon");na.appendTo(sa);u=$("<div>");u.appendTo(sa);u.addClass("extreport-workbench-card-headbar-title");na=wa.getUrlParamValue("extReportName");u.text(na);g=$("<div/>");g.addClass("workbench-card-title-edit-icon");y.backgroundWithHover(g,
"card_edit");g.on("click",za);g.hide();sa.on("mouseover",function(ha){g.show()});sa.on("mouseout",function(ha){g.hide()});g.appendTo(sa);sa.appendTo(c);D=Aa(c,"btn-more",m.get("othersMore","\u66f4\u591a"),30,t.doOthersClicked);D.on("mouseover",function(ha){y.background(D,"btn-more-on")});D.on("mouseout",function(ha){y.background(D,"btn-more")});h=Aa(c,"icon_delete",m.get("remove","\u5220\u9664"),5,Ba);h.on("mouseover",function(ha){y.background(h,"icon_delete_hover")});h.on("mouseout",function(ha){y.background(h,
"icon_delete")});G=Aa(c,"btn-filter",m.get("filter","\u8fc7\u6ee4"),55,ma);G.on("mouseover",function(ha){y.background(G,"btn-filter-on")});G.on("mouseout",function(ha){y.background(G,"btn-filter")});if(F)$(F).on("mouseenter",function(ha){O&&h.hide()});$(document.body).on("mouseenter",function(ha){D.show();h.show();G.show();O&&h.hide()});$(document.body).on("mouseleave",function(){D.hide();h.hide();G.hide()});D.hide();h.hide();G.hide();t.decorateCard(F,u);Ca()};var Aa=function(sa,na,ha,pa,ya){var Y=
$("<div>");Y.addClass("workbench-extreport-card-headbar-btn");y.background(Y,na);Y.css("right",pa);Y.attr("title",ha);Y.on("click",ya);Y.appendTo(sa);f.getHeadbarBtn().push(Y);return Y};this.protectedGetInnerPane=function(sa,na){if(!w){w=$("<div>");w.addClass("extreport-workbench-card-headbar-otherbtn-pane");a=$("<div>");a.addClass("extreport-card-headbar-inner-btn extreport-card-activebutton");y.background(a,O?"quitFullscreen":"fullscreen");a.css("transform","scale(1.2)");a.attr("title",O?m.get("exitFullScreen",
"\u9000\u51fa\u5168\u5c4f"):m.get("fullScreen","\u5168\u5c4f"));a.on("click",t.doFullScreen);a.appendTo(w);var ha=$("<div>");ha.addClass("extreport-card-headbar-inner-btn extreport-card-activebutton");y.background(ha,"btn-refresh");ha.attr("title",m.get("refresh","\u5237\u65b0"));ha.on("click",la);ha.appendTo(w);sa.push(ha);sa.push(a);w.appendTo(na);O&&t.doFullScreen()}return w};this.protectedFullScreenChanged=function(sa){(O=sa)?(y.background(a,"quitFullscreen"),a.attr("title",m.get("exitFullScreen",
"\u9000\u51fa\u5168\u5c4f")),w.removeClass("extreport-workbench-card-headbar-otherbtn-pane"),w.addClass("extreport-workbench-card-headbar-otherbtn-pane-fullscreen")):(y.background(a,"fullscreen"),a.attr("title",m.get("fullScreen","\u5168\u5c4f")),w.removeClass("extreport-workbench-card-headbar-otherbtn-pane-fullscreen"),w.addClass("extreport-workbench-card-headbar-otherbtn-pane"));O?(h.hide(),D.css("right","5px"),G.css("right","30px")):(D.css("right","30px"),G.css("right","55px"))};var la=function(){window.parent.postMessage({operation:"refreshCardTitle",
targetWidgetId:R.getIframeId()},"*")},Ba=function(){window.parent.postMessage({operation:"remove",targetWidgetId:R.getIframeId()},"*")},ma=function(){t.doClickFilterBtn();O&&h.hide()},za=function(){window.parent.postMessage({operation:"showEditTitleDialog",targetWidgetId:R.getIframeId()},"*")},Ca=function(){var sa=u.offset().left+u.width();window.parent.postMessage({operation:"getCardEditIconPosition",targetWidgetId:R.getIframeId(),value:sa},"*")}}function I(E,F,e,k,n){q.call(this,E,F,e,k,n);var t=
this.protectedMethods,f=this,c,d,u,w,a,g=[],R=[],D=k.isHasFilter,h=!1;this.initUi=function(){t.setCardMode();F.css({width:"100%",height:"100%"});F.on("mouseenter",la);F.on("mouseleave",Ba);c=$("<div>");c.addClass("extreport-card-content");if(n)c.addClass("extreport-card-content-subreport");else{var ma=$("<div>");ma.prependTo(F);f.protectedCreateHeadbar(c,ma);ma=(ma=ma.css("height"))?parseInt(ma,10):0;c.css("top",ma+4);Ba()}c.appendTo(F);t.getSheetContainer(c);D&&G()};this.paintFilterPanel=function(ma,
za){u&&(u.remove(),u=null);w.setModels(ma,za,f.getSchemaBiztagId());u=w.getJqUi();a.switchSchema();u.appendTo(d);u.addClass("extreport-card-schema-manage-panel");w.getJqFilterPanel().css({"margin-bottom":"15px"});f.syncHeight()};this.resize=function(ma){F.height(ma);f.adjustSheetContainerSize()};this.showOrHideFilterPane=function(ma){d&&((h=ma)?(ma=d.css("height"),d.css({height:0}),d.show(),d.animate({height:ma},200),la()):d.hide())};this.getHeadbarBtn=function(){return g};this.protectedCreateHeadbar=
function(ma,za){throw Error("Implement me!");};this.protectedGetInnerPane=function(ma,za){throw Error("Implement me!");};this.getCurrentScenario=function(){return q.CARD};var G=function(){d=$("<div>");d.css({"z-index":999,"min-width":"330px"});d.appendTo(F);A.layoutCtrlWithLRTB(d,0,0,null,0,0,null);d.appendTo(c);d.hide();var ma=l.decodeParamFromUrl(window.location.search,"hasSchemeEditPerm");a=new p(!1,"false"===ma?!1:!0);w=new S;t.setSchemaManagePanel(w);w.setSchemaListPanel(a);w.setGlobal(e);w.setFunExecute(function(){t.queryData(O)});
w.setFunSwitchSchemaCallBack(function(){})},O=function(){},aa=function(){F.parent().off("click",Aa);f.protectedGetInnerPane(R,F).hide()},Aa=function(ma){ma.target!=g[0][0]&&aa()},la=function(ma){for(ma=0;ma<g.length;ma++)g[ma].show()},Ba=function(ma){if(!h){for(ma=0;ma<g.length;ma++)g[ma].hide();aa();f.showOrHideFilterPane(!1)}};this.protectedMethods.createHeadbarIcon=function(ma,za,Ca,sa,na){var ha=$("<div>");ha.addClass("extreport-card-headbar-btn");y.background(ha,za);ha.css("right",sa*g.length);
ha.attr("title",Ca);ha.on("click",na);ha.appendTo(ma);g.push(ha);return ha};this.protectedMethods.doOthersClicked=function(){if(f.protectedGetInnerPane(R,F).is(":visible"))aa();else{F.parent().on("click",Aa);for(var ma=g[0],za=ma.prop("offsetWidth"),Ca=ma.prop("offsetHeight"),sa=.5*za,na=.25*Ca,ha=R.length-1;0<=ha;ha--){var pa=R[ha];pa.css("top",na);pa.css("right",sa);sa+=1.5*za}za=sa;ma=ma.prop("offsetTop")+1.5*Ca;Ca*=1.5;sa=f.protectedGetInnerPane(R,F);A.layoutCtrlWithLRTB(sa,null,19,za,ma,null,
Ca);f.protectedGetInnerPane(R,F).show()}};this.protectedMethods.doClickFilterBtn=function(){D?(h=!h,f.showOrHideFilterPane(h)):e.getMessageCurtain().showPrompt(m.get("noFilterCurtain","\u672a\u8bbe\u7f6e\u8fc7\u6ee4\u5668\u3002"))}}function J(E,F,e,k,n){q.call(this,E,F,e,k,n);var t=this.protectedMethods,f=this,c,d,u,w,a,g,R,D=k.isHasFilter,h=!1,G=e.islinkReport(),O=l.decodeParamFromUrl(parent.location.href,"time"),aa=k.urlParams,Aa=aa.extReportId,la=!1,Ba=null,ma={},za=!0;this.initUi=function(){t.setCardMode();
t.setMobileMode();t.addReportReadyListener(function(){Ua("REPORT_READY");Qa()});F.css({width:"100%",height:"100%"});c=$("<div>");c.appendTo(F);c.addClass("extreport-card-content-mobile");a=t.getSheetContainer(c);n?c.addClass("extreport-card-content-mobile-subreport"):(f.protectedInitUi(F,c),O&&Ha(),Ga());G&&c.addClass("extreport-card-content-mobile-full-screen");setTimeout(function(){n?(new ResizeObserver(function(r){(r=ua())&&ya(r)})).observe(F[0]):(document.addEventListener("touchstart",Ca,!1),
document.addEventListener("touchmove",sa,!1),document.addEventListener("touchend",na,!1))})};this.afterChangeSheetUI=function(r){var z=f.protectedGetCurrentSheet().getTable();z.isLargeDataMode()&&z.setLargeDataMode(!1);n?(r=ua())&&ya(r):pa(r)};this.getCurrentScenario=function(){return q.CARD_MOBILE};var Ca=function(r){w||d&&d.is(":visible")||(r=r.touches,1<r.length&&(la=!0,Ba=ha(r)))},sa=function(r){if(!(w||d&&d.is(":visible"))){var z=f.protectedGetCurrentSheet().getName();z=ua(z);r=r.touches;la&&
1<r.length&&Ba?(r=ha(r),10>Math.abs(r-Ba)||(z*=r/Ba,Ba=r,pa(!1,4<z?4:.2>z?.2:z))):(la=!1,Ba=null)}},na=function(r){la=!1;Ba=null},ha=function(r){return Math.sqrt(Math.pow(Math.abs(r[0].pageX-r[1].pageX),2)+Math.pow(Math.abs(r[0].pageY-r[1].pageY),2))},pa=function(r,z){if(a&&t.isReportReady()){var x=f.protectedGetCurrentSheet(),K=x.getName();x=x.getTable();var ba=$(x.getUI());z||(z=ua(K));r&&(za=!0);r=ba.find('[ktableuimark="allCellLayer"]');r.css({transform:"scale("+z+")","transform-origin":"0 0"});
Y(z,r,x,!1);ya(z);0!==$(".chart-change-menu").length&&$(".chart-change-menu").remove();localStorage.setItem(Aa+"_"+K+"_scale",z+"")}},ya=function(r){var z=f.protectedGetCurrentSheet(),x=z.getName();z=z.getTable();var K=$(z.getUI()),ba=z.getEmbedObjects();r||(za=!0,r=ua(x));for(x=0;x<ba.length;x++){var V=ba[x],qa=V.getType(),ca=V.getId(),Da=K.find("div[id$='"+ca+"']");if("subReport"==qa){qa=z.getId()+"MainView_Embed_"+ca+"_scale";sessionStorage.setItem(qa,r+"");qa=Ea(z,V.getColFrom());var Ia=Ma(z,
V.getRowFrom());ca=Ea(z,V.getEndColFrom());var Na=Ma(z,V.getEndRowFrom());ca=r*(ca-qa);Na=r*(Na-Ia);Da.css({width:ca,height:Na});var Ra=Da.find('[ktableuimark="allCellLayer"]');Ra.css({transform:"scale("+r+")","transform-origin":"0 0"});$(Ra[0].parentElement).css({width:ca,height:Na});Y(r,Ra,V,!0)}else za&&(qa=Number(Da.css("left").slice(0,-2)),Ia=Number(Da.css("top").slice(0,-2)),Ia=[qa-Ea(z,V.getColFrom()),Ia-Ma(z,V.getRowFrom())],ma[ca]=Ia),(Ia=ma[ca])||(Ia=[0,0]),qa=Ea(z,V.getColFrom())+Number(Ia[0]),
Ia=Ma(z,V.getRowFrom())+Number(Ia[1]),Da.css("transform","scale("+r+")"),Da.css("transform-origin","0 0");Da.css({left:qa*r,top:Ia*r})}za=!1},Y=function(r,z,x,K){var ba=z.length;if(1!=ba){var V=$(z[0].parentElement);if(K){var qa=x.getUserObject().reportInfo.currentSheet;K=qa.header;if(!K)return;x=K.row;K=K.col;for(var ca=0,Da=qa.tableInfo.colList,Ia=0;Ia<K&&Ia<Da.length;Ia++)ca+=Da[Ia].width;K=ca;ca=0;qa=qa.tableInfo.rowList;for(Da=0;Da<x&&Da<qa.length;Da++)ca+=qa[Da].height;x=ca}else K=Ea(x,x.getFrozenColumns()),
x=Ma(x,x.getFrozenRows());ca=z[0].parentElement;qa=ca.scrollHeight>ca.clientHeight;ca=ca.scrollWidth>ca.clientWidth;if(2==ba){Da=$(z[1].parentElement);Ia=K;var Na=x;Ia=0>=Ia?ca?V.innerWidth()-8:V.innerWidth():(Ia+1)*r;Na=0>=Na?qa?V.innerHeight()-8:V.innerHeight():(Na+1)*r;Da.css({width:Ia,height:Na})}else if(!(4>ba))for(var Ra=1;Ra<ba;Ra++)Da=$(z[Ra].parentElement),Ia=K,Na=x,Ia=0>=Ia?ca?V.innerWidth()-8:V.innerWidth():(Ia+1)*r,Na=0>=Na?qa?V.innerHeight()-8:V.innerHeight():(Na+1)*r,1==Ra?Ia=ca?V.innerWidth()-
8:V.innerWidth():2==Ra&&(Na=qa?V.innerHeight()-8:V.innerHeight()),Da.css({width:Ia,height:Na})}},ua=function(r){if(n)return r=F.attr("id")+"_scale",null==sessionStorage.getItem(r)?1:Number(sessionStorage.getItem(r));r=Aa+"_"+r+"_scale";return null==localStorage.getItem(r)?1:Number(localStorage.getItem(r))},Ea=function(r,z){for(var x=0,K=0;K<z;K++)x+=r.getColumn(K).getWidth();return x},Ma=function(r,z){for(var x=0,K=0;K<z;K++)x+=r.getRow(K).getHeight();return x};this.paintFilterPanel=function(r,z){u&&
(u.remove(),u=null);g.setModels(r,z,f.getSchemaBiztagId());u=g.getJqUi();R.switchSchema();u.appendTo(d);u.addClass("extreport-card-schema-manage-panel");u.css({margin:"0px 0px 0px 0px","max-height":"500px"});r=g.getJqFilterPanel();r.css({"margin-bottom":"15px","max-height":"400px","overflow-x":"hidden"});r.find('*[data-role="page"]').css("max-height","350px")};this.showOrHideFilterPane=function(r){d&&(!r||f.protectedGetFullscreenState()||t.isReportReady()?r&&f.protectedGetFullscreenState()?La():Ja():
Ka())};var La=function(){h=!0;var r=d.css("height");d.css({height:0});d.show();d.animate({height:r},200,function(){d.css("height","unset")})},Ja=function(){h=!1;d.animate({height:0},200,function(){d.css("height","unset");d.hide()})};this.resize=function(r){F.height(r);f.adjustSheetContainerSize()};this.protectedInitUi=function(r,z){throw Error("Implement me!");};this.protectedRequestDoFullscreen=function(){throw Error("Implement me!");};this.protectedGetFullscreenState=function(){return!1};this.showLinkReport=
function(r,z){if(f.protectedGetFullscreenState())if(4<=parseInt(k.urlParams.hyperlinkLevel))Pa("TOAST",m.get("exceedLinkNum","\u8d85\u51fa\u79fb\u52a8\u7aef\u8fde\u7eed\u8054\u67e5\u7684\u6570\u91cf"));else{var x={from:"LAPP_MESSAGE_EXECUTION",type:"OPEN_LINK_REPORT"};x.extreportTopWidgetId=aa.extreportTopWidgetId;x.sUrl=r;x.sReportName=z;window.parent.postMessage(JSON.stringify(x),"*")}else Pa("TOAST",m.get("openLinkReportInfo","\u8bf7\u5148\u5168\u5c4f\uff0c\u518d\u8fdb\u884c\u8054\u67e5"))};this.showMsg=
function(r,z,x){w||Pa(r,z,x)};var Ga=function(){d=$("<div>");A.layoutCtrlWithLRTB(d,0,0,null,0,0,null);d.css("z-index",999);d.appendTo(c);d.hide();d.on("click",function(z){(z.target=u[0])?z.stopPropagation():f.showOrHideFilterPane(!1)});var r=l.decodeParamFromUrl(window.location.search,"hasSchemeEditPerm");R=new p(!0,"false"===r?!1:!0);g=new S;g.setMobileMode();t.setSchemaManagePanel(g);g.setSchemaListPanel(R);g.setGlobal(e);g.setFunExecute(function(){t.queryData(Sa)});g.setFunSwitchSchemaCallBack(function(){});
g.setFunMobileMsgListener(Pa)},Ka=function(){if(!t.isReportReady()){w=$("<div>");w.addClass("extreport-card-mask");var r=$("<span>");r.addClass("extreport-card-mask-text");r.text(m.get("setEnterScheme","\u8bf7\u70b9\u51fb\u6309\u94ae\u8bbe\u7f6e\u8fc7\u6ee4\u65b9\u6848"));r.appendTo(w);r=$("<span>");r.addClass("extreport-card-mask-btn");r.text(m.get("setScheme","\u8bbe\u7f6e\u8fc7\u6ee4\u65b9\u6848"));r.on("click",function(){f.protectedRequestDoFullscreen();Qa();f.showOrHideFilterPane(!0)});r.appendTo(w);
w.appendTo(F)}},Qa=function(){w&&w.remove();w=null},Ha=function(){window.addEventListener("message",function(r){try{JSON.parse(r.data)}catch(z){}})},Pa=function(r,z,x){var K=new com.kingdee.bos.qing.lapp.component.MobileDialog;K.setHeight(150);K.setContentCreator(function(){var ba=$("<div>");ba.addClass("extreport-card-mobile-msg-text");ba.text(z);return ba});"MSG"==r?(K.setTitle(m.get("remind","\u6d88\u606f\u63d0\u793a")),x&&K.setClosedListener(x),K.showDialog()):"CONFIRM"==r?(K.setTitle(m.get("confirmAgain",
"\u64cd\u4f5c\u786e\u8ba4")),K.creatNormalFooterWithTwoBtn(function(){x(!1)},function(){x(!0)}),K.showDialog()):"TOAST"==r&&(new com.kingdee.bos.qing.lapp.component.Toast).show(z,1E3)};this.getSelectedSchemeName=function(){return g.getCurrentSelScheme().getCaption()};this.resize=function(r){F.height(r);f.adjustSheetContainerSize();r=c.height()-0;a&&a.css("height",r+"px")};var Sa=function(){f.showOrHideFilterPane(!1);Qa()},Ta=function(r){!n&&c.toggleClass("extreport-card-content-mobile-full-screen",
r)},Ua=function(r){var z={from:"LAPP_MESSAGE_EXECUTION"};z.type=r;z.extreportTopWidgetId=aa.extreportTopWidgetId;window.parent.postMessage(JSON.stringify(z),"*")};this.protectedMethods.updateUiWhenFullscreen=Ta;this.protectedMethods.toggleFilterPanel=function(){D?(h=!h,f.showOrHideFilterPane(h)):Pa("TOAST",m.get("noFilter","\u672a\u8bbe\u7f6e\u8fc7\u6ee4\u5668"))};this.protectedMethods.createMobileCardMask=Ka;this.protectedMethods.doClickFullscreen=function(){Ta(!0);w&&(Qa(),f.showOrHideFilterPane(!0))};
this.protectedMethods.doCloseFullscreen=function(){Ta(!1);f.showOrHideFilterPane(!0);Ja();A.layoutCtrlWithLRTB(a,0,0,null,0,0,null)};this.protectedMethods.postEvent=Ua}function Z(){var E=this,F;this.getExtreportWidgetInfo=function(){if(!F){var e=new com.kingdee.bos.extreport.runtime.model.ExtreportWidgetInfo,k=wa.getUrlParamValue("extreportWidgetId");if(k){k=$("body",parent.document).find("#"+k);var n=window.parent.$;k=n(k).data("extreportWidgetInfo");e.fromJsonObject(k);F=e}}return F};this.protectedMethods.reportWidgetRefresh=
function(){var e=wa.getUrlParamValue("extreportWidgetId");e&&(e=$("body",parent.document).find("#"+e),e.removeClass(),window.location.href=e.attr("src"))};this.protectedMethods.decorateCard=function(e,k){!F&&E.getExtreportWidgetInfo();if(F&&F.isRequireDecorateCard()){var n=F.getStyleMap(),t=F.isRequireOpacity();if(!F.isInWidgetPanel()){if(e){var f=parseInt(n.borderRadius||0);e.css("border-radius",f+"px");f=n.backgroundColor||"#ffffff";t&&(t=parseFloat(n.backgroundOpacity||1),f=b.withOpacityToRgba(f,
t));e.css("background-color",f);(t=n.shadowColor||"")&&(t="0 1px 3px 0 "+t);e.css("box-shadow",t)}k&&(e=n.titleColor||"#5b6373",n=parseInt(n.titleFontSize||12),k.css("color",e),k.css("font-size",n+"px"))}}else e.css("background-color","#ffffff")};this.protectedMethods.getSchemaBiztagId=function(){var e=wa.getUrlParamValue("schemaBiztagId");return e?e:wa.getUrlParamValue("extReportId")};this.protectedMethods.getBackgroundColor=function(){var e="#ffffff";F&&F.isRequireDecorateCard()&&(e=F.getStyleMap().backgroundColor||
"#ffffff");return e};this.protectedMethods.undecorateCard=function(e){e.css({"background-color":"unset","border-radius":"unset","box-shadow":"unset"})}}function oa(E){this.protectedMethods={};Z.call(this);var F=this,e=this.protectedMethods,k,n,t,f,c,d="noData",u=!1,w=!1;this.show=function(h,G,O){k?D(h,G,O):a(h,G,O)};this.setMobileMode=function(){u=!0};this.setErrorCardTitle=function(h){n=h};this.getErrorCardTitle=function(){return n};this.getJqUi=function(){return k};this.setBackgroundIcon=function(h){d=
h};this.setShowHeadbar=function(h){w=h};var a=function(h,G,O){k=$("<div>");k.appendTo(E);E.on("mouseenter",function(){t&&t.show()});E.on("mouseleave",function(){t&&t.hide()});g();e.decorateCard(E);D(h,G,O)},g=function(){k.empty();k.addClass("extreport-carderror-errorprompt");var h=$("<div>");f=$("<div>");f.addClass("extreport-carderror-errorprompt-img");y.background(f,d);f.appendTo(h);var G=$("<div>");G.addClass("extreport-carderror-errorprompt-errorinfo");G.appendTo(h);c=$("<span>");c.addClass("extreport-carderror-errorprompt-errortext");
c.appendTo(G);var O=0;u?(w&&(O=$("<div>"),O.addClass("extreport-errorcard-headbar-title-mobile"),O.text(n),O.appendTo(k),O=35),A.layoutCtrlWithLRTB(h,20,20,null,O,10,null),O=$("<div>"),O.addClass("carderror-errorprompt-error-operation-btn"),O.text(m.get("reload","\u91cd\u65b0\u52a0\u8f7d")),O.on("click",R),O.appendTo(G)):(w&&(F.createCardHeadbar(),O=40),A.layoutCtrlWithLRTB(h,20,20,null,O,10,null));h.appendTo(k)};this.createCardHeadbar=function(){var h=$("<div>");h.addClass("extreport-errorcard-headbar-title");
h.text(n);h.attr("title",n);h.appendTo(k);t=$("<div>");t.addClass("extreport-errorcard-headbar-refresh-btn");y.background(t,"refresh");t.on("click",R);t.appendTo(k)};var R=function(){var h=wa.getUrlParamValue("extreportWidgetId");h&&(h=$("body",parent.document).find("#"+h),window.location.href=h.attr("src"))},D=function(h,G,O){2301005==h?G=m.get("noAuthorityToThisReport","\u6ca1\u6709\u8be5\u8f7b\u62a5\u8868\u7684\u67e5\u770b\u6743\u9650"):2301001==h||8099001==h?G=m.get("publishInfoExist","\u8be5\u7ec4\u4ef6\u6765\u6e90\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"):
3010006==h?G=m.get("notRegisteredUser","\u60a8\u6240\u4f7f\u7528\u7684\u8d26\u6237\u6ca1\u6709\u88ab\u5206\u914d\u3010\u8f7b\u62a5\u8868\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002"):3010005==h?G=m.get("illegalQingReportLicense","\u5f53\u524d\u7cfb\u7edf\u6ca1\u6709\u3010\u8f7b\u62a5\u8868\u3011\u6a21\u5757\u7684\u4f7f\u7528\u8bb8\u53ef\uff0c\u8bf7\u4e0e\u7cfb\u7edf\u7ba1\u7406\u5458\u8054\u7cfb\u3002"):2301012==h?G=m.get("noPresetAuthorityToThisReport",
"\u6ca1\u6709\u8be5\u9884\u7f6e\u62a5\u8868\u7684\u6743\u9650"):3010004==h&&(G=m.get("replicatedLogin","\u60a8\u7684\u8d26\u53f7\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\u5f53\u524d\u7cfb\u7edf\u3002"));c.text(G);c.attr("title",G)}}function ta(E,F,e){var k=this,n,t=F.urlParams.extReportId,f,c,d,u=!1,w=!1,a,g=[],R=!1,D,h;this.updataTableByHasQingChart=function(){var aa=E.getCurrentSheet();if(aa&&aa.getTable()){aa=aa.getTable();for(var Aa=aa.getEmbedObjects(),la=
!1,Ba=0;Ba<Aa.length;Ba++)if("QINGCHART"==Aa[Ba].getType()){la=!0;break}else if("subReport"==Aa[Ba].getType()){var ma=Aa[Ba].getUserObject();if(ma&&ma.reportInfo&&ma.reportInfo.currentSheet&&ma.reportInfo.currentSheet.tableInfo&&ma.reportInfo.currentSheet.tableInfo.embedChartList){ma=ma.reportInfo.currentSheet.tableInfo.embedChartList;for(var za=0;za<ma.length;za++)if("QINGCHART"==ma[za].embedType){la=!0;break}}}la&&aa.updateUI();this.afterChangeSheetUI()}};this.renderReport=function(){if(!e){var aa=
E.getSheetNames();if(null!=aa&&0<aa.length){var Aa=E.getSheetColors();a.init(aa,Aa,d);a.addTabClickListener(D)}}k.destroy();aa=E.getCurrentSheet().getTable();Aa=$(aa.getUI());Aa.attr("id",E.getCurrentSheet().getName());d.append(Aa);a&&a.getUI()&&d.append(a.getUI());k.adjustSheetContainerSize(!0);d.resize(G);aa.updateUI();h&&h();R=!0;this.afterChangeSheetUI(!0)};this.setSheetSwitcher=function(aa){a=aa};this.getSheetSwitcher=function(){return a};this.protectedGetCurrentSheet=function(){return E.getCurrentSheet()};
this.afterChangeSheetUI=function(aa){};var G=function(){E.getCurrentSheet().getTable();var aa=$(_oTable.getUI());a&&a.getUI()?aa.css("height",d.height()-32):aa.css("height",d.height())};this.adjustSheetContainerSize=function(aa){try{var Aa=E.getCurrentSheet().getTable()}catch(ma){return}if(Aa){aa||Aa.relayoutViews();aa=$(Aa.getUI());var la=0,Ba=0;a&&a.getUI()&&(0<d.width()&&a.setWidth(d.parent().width()),w?(Ba=32,la=0,a.getUI().css("top","0px")):(Ba=0,la=32,a.getUI().css("bottom","0px")));aa.css({top:Ba,
bottom:la,left:0,right:0,position:"absolute"});if(0!=document.body.clientHeight||0!=document.body.clientWidth)n!==ja()&&(aa=t+"_"+E.getCurrentSheet().getName()+"_unFrozen",O(aa,Aa)),n=ja()}};var O=function(aa,Aa){if(localStorage.getItem(aa))W(Aa),k.afterChangeSheetUI();else{n=ja();for(var la=$(Aa.getUI()),Ba=0,ma=0,za=0;za<Aa.getFrozenColumns();za++)Aa.getColumn(za)&&(Ba+=Aa.getColumn(za).getWidth());for(za=0;za<Aa.getFrozenRows();za++)Aa.getRow(za)&&(ma+=Aa.getRow(za).getHeight());(Ba>la.prop("clientWidth")||
ma>la.prop("clientHeight"))&&(new va(k,aa,Aa)).createDialog()}};this.update=function(aa){var Aa=E.getCurrentSheet();if(aa){aa=Aa.getTable();d.children().css("display","none");var la=$(aa.getUI());la.attr("id",E.getCurrentSheet().getName());a&&la.insertBefore(a.getUI())&&a.getUI().css("display","inline");k.adjustSheetContainerSize(!0);aa.updateUI();la=t+"_"+E.getCurrentSheet().getName()+"_unFrozen";O(la,aa);this.afterChangeSheetUI(!0)}else{if(!a.getUI())return;d.children().css("display","none");$.each(d.children(),
function(Ba,ma){$(ma).attr("id")===Aa.getName()&&$(ma).css("display","inline")});a&&a.getUI().css("display","inline");k.adjustSheetContainerSize()}h&&h();R=!0};this.destroy=function(){for(var aa=g.length-1;0<=aa;aa--)g[aa].dispose();g=[];d&&d.children().remove();$("body").find("._SmartLabel_Container").remove()};this.addFusionChart=function(aa){g.push(aa)};this.addChangeSheetListener=function(aa){D=aa};this.protectedMethods={setMobileMode:function(){w=!0},setCardMode:function(){u=!0},getSheetContainer:function(aa){f||
(f=$("<div>"),f.addClass("extreport-reportui-sheet-container-parent"),c=$("<div>"),w||u?c.addClass("extreport-card-sheet-container-content"):(c.addClass("extreport-reportui-sheet-container-content"),e&&A.layoutCtrlWithLRTB(c,0,0,null,0,0,null)),d=$("<div>"),d.addClass("extreport-card-sheet-container"),d.appendTo(c),c.appendTo(f));f.appendTo(aa);return f},isReportReady:function(){return R},addReportReadyListener:function(aa){h=aa}}}function ja(){return""+document.documentElement.clientWidth+document.documentElement.clientHeight}
function va(E,F,e){var k=this,n=[300,190],t;this.createDialog=function(){$(".sa-ctrl-common-modallayer").remove();var f=$(document.body),c=$("<div class='sa-ctrl-common-modallayer'>");c.appendTo(f);var d=new fa(c);d.setTitle(m.get("operateConfirm","\u64cd\u4f5c\u786e\u8ba4"));var u=n[0],w=n[1],a=f.prop("clientWidth"),g=f.prop("clientHeight");d.setBounds(a-u>>1,g-w>>1,u,w);d.setToolbarVisible(!1);d.setContent(k.createJqPanel());d.addClosingListener(function(R,D){D&&(t.isOn()&&localStorage.setItem(F,
"true"),W(e),E.afterChangeSheetUI());R.destroy();c.remove()});d.showFooterPane();c.appendTo(f);return d};this.createJqPanel=function(){var f=$("<div>"),c=$("<span>");c.text(m.get("undoTableFrozen","\u5f53\u524d\u9875\u9762\u89c6\u56fe\u5c0f\u4e8e\u7a97\u683c\u51bb\u7ed3\u533a\u57df\uff0c\u662f\u5426\u53d6\u6d88\u51bb\u7ed3\u7a97\u683c?"));c.attr("title",m.get("undoTableFrozen","\u5f53\u524d\u9875\u9762\u89c6\u56fe\u5c0f\u4e8e\u7a97\u683c\u51bb\u7ed3\u533a\u57df\uff0c\u662f\u5426\u53d6\u6d88\u51bb\u7ed3\u7a97\u683c?"));
c.css({"font-size":"14px",color:"#333"});c.appendTo(f);A.layoutCtrl(c,0,0,270,50);t=new L;t.setOn(!1);c=t.getJqUi();var d=(new xa(m.get("noTips","\u4e0b\u6b21\u4e0d\u518d\u63d0\u793a"))).getJqUi();A.layoutCtrlWithLRTB(c,80,null,31,55,null,19);A.layoutCtrl(d,0,53,80,23);f.append(c);f.append(d);return f}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport=
{});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.ui&&(com.kingdee.bos.extreport.runtime.ui={});var Fa=com.kingdee.bos.extreport.runtime.ui;Fa.AbstractReportUI=q;Fa.WebReportUI=C;Fa.ReportCardUI=M;Fa.ReportCardMobileUI=P;Fa.ReportDsbWidgetUI=da;Fa.ReportDsbWidgetMobileUI=U;Fa.ExtreportCardErrorUi=oa;Fa.WorkbenchExtReportCardErrorUi=function(E){oa.call(this,E);var F=this,e=this.protectedMethods,k=
F.getExtreportWidgetInfo();this.createCardHeadbar=function(){var t=$("<div>");y.background(t,"extreport");t.addClass("extreport-workbench-card-icon");t.appendTo(F.getJqUi());t=$("<div>");t.addClass("extreport-workbench-card-headbar-title");t.text(F.getErrorCardTitle());t.attr("title",F.getErrorCardTitle());t.appendTo(F.getJqUi());var f=$("<div>");f.addClass("extreport-workbench-errorcard-headbar-refresh-btn");y.background(f,"btn-refresh");f.on("click",e.reportWidgetRefresh);f.on("mouseover",function(d){y.background(f,
"btn-refresh-on")});f.on("mouseout",function(d){y.background(f,"btn-refresh")});f.appendTo(F.getJqUi());var c=$("<div>");c.addClass("extreport-workbench-errorcard-headbar-delete-btn");y.background(c,"icon_delete");c.on("mouseover",function(d){y.background(c,"icon_delete_hover")});c.on("mouseout",function(d){y.background(c,"icon_delete")});c.on("click",n);c.css("z-index","9999999");c.appendTo(F.getJqUi());$(F.getJqUi()).on("mouseenter",function(){f.show();c.show()});$(F.getJqUi()).on("mouseleave",
function(){f.hide();c.hide()});f.hide();c.hide();window.parent.postMessage({operation:"loadCompleted",targetWidgetId:k.getIframeId()},"*")};var n=function(){window.parent.postMessage({operation:"remove",targetWidgetId:k.getIframeId()},"*")}};Fa.SheetSwitcher=function(){function E(){var a=com.kingdee.bos.extreport.runtime.MyIcons,g=function(Aa){e.fireEvent({type:"switch-click",button:Aa.data.type,target:this})};var R=$("<div class='extreport-reportui-tab-switch-left' />");var D=$("<div/>");a.background(D,
"prev_page");var h=function(){0!=c?a.background(D,"prev_page_hover"):a.background(D,"prev_page")};D.bind("mouseover",h);D.bind("mouseout",function(){a.background(D,"prev_page")});D.css({"margin-top":"8px",height:"16px",width:"16px"});D.appendTo(R);R.bind("click",{type:"pre"},g);var G=$("<div class='extreport-reportui-tab-switch-right' />");var O=$("<div/>");a.background(O,"next_page");var aa=function(){u&&u-1!=d?a.background(O,"next_page_hover"):a.background(O,"next_page")};O.bind("mouseover",aa);
O.bind("mouseout",function(){a.background(O,"next_page")});O.css({"margin-top":"8px",height:"16px",width:"16px"});O.appendTo(G);G.bind("click",{type:"next"},g);this.getFunPrevImgChange=function(){return h};this.getFunNextImgChange=function(){return aa};this.getTabLeftUI=function(){return R};this.getTabRightUI=function(){return G}}function F(a,g,R){var D=this,h,G=R.width(),O=$("<div class='extreport-reportui-sheet-tab-all' />"),aa=[],Aa,la;this.setFunPrevImgChange=function(ma){Aa=ma};this.setFunNextImgChange=
function(ma){la=ma};var Ba=function(ma){D.changeTabShow(aa,$(this));ma={type:"tab-click",sheetName:$(this).text()};e.fireEvent(ma)};this.getUI=function(){return O};this.getTabDivs=function(){return aa};(function(ma){for(var za=0;za<ma;za++){var Ca=$("<div class='extreport-reportui-sheet-tab-sub' />");Ca.css("backgroundColor",g[za]);var sa=KEXTCommonUtil.getRgbIntArr(g[za]);KEXTCommonUtil.isDarkColor(sa)&&Ca.css("color","#fff");Ca.bind("click",Ba);za==f&&(sa&&"string"!=typeof sa&&(sa.push(.5),KEXTCommonUtil.getRgbaString(sa),
(sa=g[za])&&Ca.css("filter","alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#ffffff,endcolorstr="+sa+",gradientType=0)")),Ca.addClass("extreport-reportui-sheet-tab-sub-selected"));O.append(Ca);aa.push(Ca)}})(a.length);e.addListener("switch-click",function(ma){G=R.width()-42;if(!(0<=O.width()-h)){if("pre"==ma.button){if(0<=KReportUtil.getCssIntValue(aa[0].css("left")))return;for(var za=!0,Ca=null,sa=0<c?c-
1:c,na=0,ha=sa;0<=ha;ha--){var pa=aa[ha].width()+10;na+=pa;if(na>G){Ca=ha;za=!1;break}}var ya=aa.length;if(za&&null==Ca)for(Ca=0,ha=sa+1;ha<ya;ha++)if(pa=aa[ha].width()+10,na+=pa,na>G){sa=ha;break}za=0;for(ha=Ca;ha<=sa;ha++)pa=aa[ha].width()+10,aa[ha].css("left",za),za+=pa;za=KReportUtil.getCssIntValue(aa[Ca].css("left"));for(ha=Ca-1;0<=ha;ha--)za-=aa[ha].width()+10,aa[ha].css("left",za);za=KReportUtil.getCssIntValue(aa[sa].css("left"));for(ha=sa;ha<ya;ha++)aa[ha].css("left",za+1),za+=aa[ha].width()+
10;c=Ca;d=sa;Aa&&Aa()}if("next"==ma.button&&!(KReportUtil.getCssIntValue(aa[aa.length-1].css("left"))+aa[aa.length-1].width()<=O.width())){za=!0;Ca=d<aa.length?d+1:d;sa=null;na=0;ya=aa.length;for(ha=Ca;ha<ya;ha++)if(pa=aa[ha].width()+10,na+=pa,na>G){sa=ha;za=!1;break}if(za&&null==sa)for(sa=ya-1,ha=Ca-1;0<ha;ha--)if(pa=aa[ha].width()+10,na+=pa,na>G){Ca=ha+1;break}za=0;for(ha=Ca;ha<=sa;ha++)pa=aa[ha].width()+10,aa[ha].css("left",za),za+=pa;za=KReportUtil.getCssIntValue(aa[Ca].css("left"));for(ha=Ca-
1;0<=ha;ha--)za-=aa[ha].width()+10,aa[ha].css("left",za);za=KReportUtil.getCssIntValue(aa[sa].css("left"));for(ha=sa;ha<ya;ha++)aa[ha].css("left",za),za+=aa[ha].width()+10;c=Ca;d=sa;la&&la()}}});this.setTabLength=function(ma){h=ma};this.setPageShowTabLength=function(ma){G=ma};this.changeTabShow=function(ma,za){for(var Ca,sa=0;sa<ma.length;sa++){var na=ma[sa];na.css({filter:"",background:"",backgroundColor:g[sa]});na.removeClass("extreport-reportui-sheet-tab-sub-selected");KEXTCommonUtil.isDarkColor(g[sa])&&
na.css("color","#fff");za.html()==na.html()&&(Ca=sa)}(ma=KEXTCommonUtil.getRgbIntArr(g[Ca]))&&"string"!=typeof ma&&(ma.push(.5),KEXTCommonUtil.getRgbaString(ma),(Ca=g[Ca])&&za.css("filter","alpha(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.gradient(startcolorstr=#ffffff,endcolorstr="+Ca+",gradientType=0)"));za.addClass("extreport-reportui-sheet-tab-sub-selected")}}var e=new KRListenerProxy,k,n,t,f,c=0,d,u,w;this.init=function(a,g,
R){if(a&&1<a.length){w=a;u=a.length;var D=R.width();_tabSwitcher=new E;k=new F(a,g,R);k.setFunPrevImgChange(_tabSwitcher.getFunPrevImgChange());k.setFunNextImgChange(_tabSwitcher.getFunNextImgChange());n=$("<div class='extreport-reportui-sheet-tab-switcher' />");g=k.getUI();n.append(g);R=k.getTabDivs();for(var h=0,G=!0,O=0;O<R.length;O++){var aa=KReportUtil.getCssWidth(a[O],R[O].css("fontSize"));R[O].css("width",aa+2);R[O].attr("title",a[O]);R[O].css("left",h);R[O].text(a[O]);aa=R[O].width()+10;h+=
aa;h>D&&G&&(d=O,G=!1)}h>D?(n.append(_tabSwitcher.getTabLeftUI()),n.append(_tabSwitcher.getTabRightUI()),g.css("left","20px"),g.css("right","20px")):(g.css("left","0px"),g.css("right","0px"));k.setTabLength(h)}};this.updateUi=function(a){if(w&&1<w.length){for(var g=0,R=!0,D=k.getTabDivs(),h=0;h<D.length;h++){var G=KReportUtil.getCssWidth(w[h],D[h].css("fontSize"));D[h].css("width",G+2);D[h].css("left",g);G=D[h].width()+10;g+=G;g>a&&R&&(d=h,R=!1)}R=k.getUI();D=_tabSwitcher.getTabLeftUI();h=_tabSwitcher.getTabRightUI();
g>a?(a-=40,D.show(),h.show(),n.append(D),n.append(h),R.css("left","20px"),R.css("right","20px")):(R.css("left","0px"),R.css("right","0px"),D.hide(),h.hide());k.setTabLength(g);k.setPageShowTabLength(a)}};this.getUI=function(){return n};this.setWidth=function(a){t=a;a=k.getTabDivs()[0].width();t&&2===a&&t&&this.updateUi(t)};this.addTabClickListener=function(a){e.addListener("tab-click",a)};this.setInitTab=function(a){f=a};this.generateTabShow=function(a){if(k){var g=k.getTabDivs();k.changeTabShow(g,
g[a])}}};var wa,fa,ea,xa,ia,ra,H,L,A,B,b,m,l,y,v,S,Q,X,T,N;(function(){var E=com.kingdee.bos.qing;wa=E.Seer;E=com.kingdee.bos.qing.ui.component;fa=E.Dialog;ea=E.ComboBox;xa=E.Label;ia=E.Toolbar;ra=E.Menu;H=E.SimpleConfirmer;L=E.SwitchButton;E=com.kingdee.bos.qing.common;A=E.DomUtil;B=E.FullScreenHelper;b=E.ColorUtil;l=E.Util;E=com.kingdee.bos.qing.framework.common;m=E.MultilanguageManager.createPackageAccessor(Fa);E=com.kingdee.bos.extreport.runtime;y=E.MyIcons;E=com.kingdee.bos.extreport.runtime.common.ui;
v=E.AbstractSchemaListPanel;S=E.SchemaManagePanel;Q=E.RuntimeSchemaListPanel;N=E.SpaceType;E=com.kingdee.bos.extreport.snapcenter.common.ui;SaveSnapDialog=E.SaveSnapDialog;SaveSnapSourceType=E.SaveSnapSourceType;X=com.kingdee.bos.extreport.runtime.common.ui.RptHelpIconTipsUI;T=com.kingdee.bos.extreport.runtime.model.RptRunTimeHelpInfoTip})();Fa.MobileFullscreenUtil=new function(){var E;this.getFullscreenState=function(){return E?E:!1};this.setFullscreenState=function(F){E=F}};q.WEB="web";q.REPORT_WIDGET=
"report-widget";q.REPORT_WIDGET_MOBILE="report-widget-mobile";q.CARD="card";q.CARD_MOBILE="card-mobile";q.WORKBENCH_CARD="workbench-card";Fa.ReportUiFactory=new function(){this.getReportUi=function(E,F,e,k,n,t){switch(E){case q.REPORT_WIDGET:return new da(F,e,k,n,t);case q.REPORT_WIDGET_MOBILE:return new U(F,e,k,n,t);case q.CARD:return new M(F,e,k,n,t);case q.CARD_MOBILE:return new P(F,e,k,n,t);case q.WORKBENCH_CARD:return new ka(F,e,k,n,t);default:return new C(F,e,k,n,t)}}};var W=function(E){var F=
E.isSyncUIWhenModelChanged();E.setSyncUIWhenModelChanged(!0);E.setFrozenColumns(0);E.setFrozenRows(0);E.setSyncUIWhenModelChanged(F)}})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.report&&(com.kingdee.bos.extreport.runtime.report={});"undefined"==typeof com.kingdee.bos.extreport.runtime.report.ui&&(com.kingdee.bos.extreport.runtime.report.ui=
{});com.kingdee.bos.extreport.runtime.report.ui.Main=function(){var oa,ta,ja,va=new function(){var ea,xa;this.getMessageCurtain=function(){ea||(ea=new da,ea.getJqUi().appendTo($("body")));return ea};this.getExhibitScene=function(){return ia("exhibitionScene")};this.islinkReport=function(){return"true"==ia("isHyperlink")?!0:!1};this.hasSchemeEditPerm=function(){return"false"==ia("hasSchemeEditPerm")?!1:!0};this.createFacade=function(H,L,A){var B=ra();return new U(B,H,function(b,m){return L?L(b,m):
!1},A)};this.showError=function(H){var L=$("<div>");L.css({position:"absolute",background:"white",top:"0",bottom:"0",left:"0",right:"0",font:"14px PingFangSC-Regular","letter-spacing":"0",color:"#666666","text-align":"center"});var A=$("<div>");A.addClass("qing-welcome-sub-container");A.css({width:"740px",height:"410px",position:"absolute",top:"50%",left:"50%","margin-left":"-370px","margin-top":"-205px",background:"white"});var B=$("<img>");B.css({widdisplayth:"block",height:"189px",width:"200px",
"background-size":"contain",margin:"0 auto"});B.prop("src","qingrpt/runtime/resource/errorBackground.png");var b=$("<span>");b.text(H);b.css({display:"block","font-size":"20px","line-height":"26px",color:"#666666"});A.append(B);A.append(b);L.append(A);L.appendTo($(document.body))};var ia=function(H){return q.decodeParamFromUrl(window.location.search,H)},ra=function(){if(!xa){var H=ia("path");H=(H?H:"/ierp")+"/qing_rpt/runtime.do";xa=new ka;xa.setRemoteUrl(H)}return xa};this.showDialogError=function(H){var L=
com.kingdee.bos.qing.ui.component.MessageDialog,A=new L;A.setOptionType(L.OPTION_OK);A.setButtonText(L.OPTION_OK,"\u5237\u65b0");A.setClosingChecker(function(B){B===L.OPTION_OK&&location.replace(location.href);return!0});A.setMessage(H);A.showDialog()}};this.start=function(ea){I.hookCollector(function(xa,ia){Z.interestInBehavior(xa,ia)});ea=$(ea?ea:document.body);oa=$("<div class='extreport-web-main'>");oa.appendTo(ea);M.init();fa();ea=new P;ea.setCallbackImmediately(function(){fa()});ea.setDelay(250);
ea.setCallback(function(){ta&&ta.updataTableByHasQingChart()});ea.observe();wa();return oa};this.setExtreportWidgetInfo=function(ea){ja=ea};var Fa=function(){for(var ea={},xa=window.location.search.split("?")[1].split("&"),ia=0;ia<xa.length;ia++){var ra=xa[ia].split("=");2==ra.length&&(ea[ra[0]]=decodeURIComponent(ra[1]))}delete ea.appID;delete ea.skin;delete ea.language;delete ea.clientID;delete ea.cookieName;delete ea.path;delete ea.safetyCode;delete ea.pageId;return ea},wa=function(){var ea=p.getUrlParamValue("isPreview"),
xa=p.getUrlParamValue("extReportId"),ia=p.getUrlParamValue("publishId"),ra=p.getUrlParamValue("snapId"),H=p.getUrlParamValue("snapName"),L=p.getUrlParamValue("dataName"),A=p.getUrlParamValue("isGuiPreview"),B=va.createFacade(function(b){function m(S){ta.getSchemeDefaultEnter()||null!=v||ta.isAllParamsHided()||!y.isPopFilter&&!y.isNeedFill?(v||ta.isAllParamsHided()||!ta.getSchemeDefaultEnter()&&!y.isPopFilter)&&ta.loadReport(v,null):ta.popFilter()}if(ia&&null==p.getUrlParamValue("extreportWidgetId")){var l=
com.kingdee.bos.qing.common.Util.createUUID();Z.initAccessRecordParams(ia,l,Z.SourceType.QING_PUBLISH,Z.AppType.QING_RPT);Z.recordResourceOperation(Z.OperationType.QING_VISIT)}l=new J;l.fromJson(b);if(l.isHasModel()){b=Fa();switch(I.getPreviewSourceName(b.publishTargetType)){case I.PREVIEW_SOURCE_MANAGE:Z.interestInBehaviorEntrance(Z.ENTRANCE_EXTREPORT_MANAGER_PREVIEW);break;case I.PREVIEW_SOURCE_APPMENU:Z.interestInBehaviorEntrance(Z.ENTRANCE_EXTREPORT_APPMANU_PREVIEW);break;case I.PREVIEW_SOURCE_CENTER:Z.interestInBehaviorEntrance(Z.ENTRANCE_EXTREPORT_CENTER_PREVIEW)}var y=
{isPreview:ea,pageId:l.getPageId(),hasExportPermission:l.isHasExportPermission(),hasPrintPermission:l.isHasPrintPermission(),hasSaveSnapshotPermission:l.isHasSaveSnapshotPermission(),hasEditSnapshotPermission:l.isHasEditSnapshotPermission(),isAccredited:l.isAccredited(),isModifiedTemplate:l.isModifiedTemplate(),rptName:l.getExtReportName(),isHideMenubarInReport:l.isHideMenubarInReport(),bNeedFill:l.isNeedFill(),isHasFilter:l.isHasFilter(),isPopFilter:l.isHasFilter(),extReportId:xa,snapId:l.getSnapId(),
snapName:H,urlParams:b,affectedParams:ja?ja.getAffectedParams():null,creatorName:l.getCreatorName(),createTime:l.getCreateTime(),currentUserId:l.getCurrentUserId(),exportSetting:l.getExportSetting(),spaceId:l.getSpaceId(),spaceName:l.getSpaceName(),spaceType:l.getSpaceType(),spaceCreatorName:l.getSpaceCreatorName(),sPubModifier:l.getPubModifier(),sPubUpdateTime:l.getPubUpdateTime(),sTemplateModifier:l.getTemplateModifier(),sTemplateUpdateTime:l.getTemplateUpdateTime(),sSnapModifier:l.getSnapModifier(),
sSnapModifyDate:l.getSnapModifyDate()};ta=new Webreport(va,oa,y);var v=p.getUrlParamValue("paramCacheId");ta.addReportLoadedListener(function(){ta.updateUI()});ta.addCreatePageListener(function(){ta.hasFilter()?(ta.addFilterListener(m),ta.getParams(v)):ta.loadReport(v,null)});ta.createPage(l)}else com.kingdee.bos.qing.framework.common.RemoteFramework.openErrorPage("noModel")},function(b,m){if(8099001==b||8099002==b||8099007===b||8099008===b||8077016===b||8099101===b||8099004===b||8099010<=b&&8099014>=
b)return va.showDialogError(m),window.parent.postMessage({operation:"showError",iErrorCode:b,sErrorMsg:m},"*"),!0;if(8099111==b||2301001==b||2301005==b){p.getUrlParamValue("language");809111==b&&(m=C.get("snapNotFound","\u8be5\u5feb\u7167\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664"));var l=p.getUrlParamValue("appID"),y=com.kingdee.bos.qing.common.Base64Util,v={};v.appID=l;m=y.encode(encodeURIComponent(m));com.kingdee.bos.qing.framework.common.RemoteFramework.openErrorPage(b,m,v);window.parent.postMessage({operation:"showError",
iErrorCode:b,sErrorMsg:m},"*");return!0}return!1});ra?B.loadExtReportSnapInfo(ra):B.loadExtReportInfo(xa,ia,ea,A,L)},fa=function(){var ea=document.documentElement.clientHeight;document.body.style.height=ea+"px";ta&&ta.resize(ea)}};var p,q,C,M,P,da,U,ka,I,J,Z;(function(){var oa=com.kingdee.bos.qing;p=oa.Seer;oa=com.kingdee.bos.qing.common;q=oa.Util;oa=com.kingdee.bos.qing.framework.common;M=oa.WebPageInitializer;P=oa.WindowResizeObserver;C=oa.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.ui);
oa=com.kingdee.bos.extreport.runtime.common;U=oa.Facade;ka=oa.RemoteImpl;I=oa.UserOperationReporter;oa=com.kingdee.bos.extreport.runtime.report.model;J=oa.ExtReportRuntimeInfo;oa=com.kingdee.bos.qing.behavior;Z=oa.BehaviorManager;oa=com.kingdee.bos.qing.ui.component;da=oa.MessageCurtain})()})();(function(){function p(Z,oa,ta,ja){P.call(this,Z,oa,ta,ja);var va=this.protectedMethod;this.lookForLinkageTargets=function(Fa){va.remote("lookForLinkageTargets",Fa)};this.chartInnerLink=function(Fa){va.remote("chartInnerLink",Fa)}}function q(){this.getAlias=function(){};this.getDataType=function(){};this.getName=function(){};this.getValues=function(){}}function C(){da.call(this);var Z,oa;this.getRemoteUrl=function(ta){ta.tag=oa;return Z};this.setRemoteUrl=function(ta){Z=ta};this.setTag=function(ta){oa=
ta}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.linkage&&(com.kingdee.bos.extreport.runtime.linkage={});var M=com.kingdee.bos.extreport.runtime.linkage;M.LinkageFacadeImpl=function(){this.lookForLinkageTargets=
function(ta,ja,va){ta={linkSrc:ta.sLinkSrc,pageId:ta.pageId,currentSheetName:ta.currentSheetName};Z(ja,va).lookForLinkageTargets(ta)};this.chartInnerLink=function(ta,ja,va){ta={linkSrc:ta.sLinkSrc,pageId:ta.pageId,currentSheetName:ta.currentSheetName};Z(ja,va).chartInnerLink(ta)};var Z=function(ta,ja,va){return new p(oa(),ta,function(Fa,wa,fa){return!(!ja||!ja(Fa,wa,fa))},va)},oa=function(){var ta=new C;ta.setRemoteUrl((U?U:"/ierp")+"/qing_rpt/runtime.do");ta.setTag(ka);return ta}};M.LinkageItem=
function(){var Z,oa,ta,ja,va,Fa,wa,fa,ea,xa,ia,ra,H,L=J.get("operate","\u64cd\u4f5c");this.getDomain=function(){return Z};this.getDefaultLink=function(){return oa};this.getReportAlias=function(){return ta};this.setReportAlias=function(A){ta=A};this.getReportId=function(){return ja};this.getReportName=function(){return va};this.setReportName=function(A){va=A};this.getSystemId=function(){return Fa};this.getArrParam=function(){return wa};this.getLinkType=function(){return ea};this.setLinkType=function(A){ea=
A};this.getType=function(){return xa};this.getUrl=function(){return ra};this.setUrl=function(A){ra=A};this.getParams=function(){return ia};this.getUiType=function(){return fa};this.getOperateState=function(){return H};this.getMenuName=function(){return L};this.getWrapCallbackFun=function(A,B,b,m){return function(){var l="innerLink"===ea;if(l&&A){var y=A.data("selected");y?(A&&A.removeClass("pop-menu-item_selected"),A.data("selected",!1),A.text(J.get("affectionConfirm","\u8054\u52a8"))):(A&&A.addClass("pop-menu-item_selected"),
A.data("selected",!0),A.text(J.get("affectionCancel","\u53d6\u6d88\u8054\u52a8")));B(b,l,y)}else A&&A.addClass("pop-menu-item_selected"),m&&m(),B(b)}};this.getClickCallbackFun=function(A,B,b){return function(m,l,y){null!=m&&(m=A[m],l?B&&B(m,b,y):(b.closePopMenu(),B&&B(m)))}};this.getDisplayLabel=function(){if("innerLink"===ea)return J.get("affectionConfirm","\u8054\u52a8");if("stringLink"===ea){var A=J.get("hyperlinkTo","\u8d85\u94fe\u63a5\u5230");return A+'"'+ta+'"'}if("imgView"===ea)return J.get("viewImg",
"\u67e5\u770b\u56fe\u7247");A=J.get("linkTo","\u8054\u67e5\u5230");return A+'"'+ta+'"'};this.fromJson=function(A){Z=A.domain;oa=A.isDefaultLink;ta=A.reportAlias;ja=A.reportId;va=A.reportName?A.reportName.split("$Alias$")[0]:A.reportName;Fa=A.systemId;ra=A.url;ia=A.params;xa=A.type;fa=A.uiType;H=A.operateState;for(var B=[],b=0;A.paramValues&&b<A.paramValues.length;b++){var m=A.paramValues[b],l=new q;l.alias=m.alias;l.dataType=m.dataType;l.name=m.name;l.values=m.values;B.push(l)}wa=B}};M.ParamItem=
q;var P,da,U,ka,I,J;(function(){var Z=com.kingdee.bos.qing.framework.common;P=Z.AbstractFacade;da=Z.AbstractRemoteCall;J=Z.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.linkage);Z=com.kingdee.bos.qing.common;I=Z.Util;ka=I.decodeParamFromUrl(location.search,"tag");U=I.decodeParamFromUrl(location.search,"path")})()})();(function(){function p(Z,oa,ta,ja){M.call(this,Z,oa,ta,ja);var va=this.protectedMethod;this.chartChangeLink=function(Fa){va.remote("chartChangeLink",Fa)}}function q(){P.call(this);var Z,oa;this.getRemoteUrl=function(ta){ta.tag=oa;return Z};this.setRemoteUrl=function(ta){Z=ta};this.setTag=function(ta){oa=ta}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport=
{});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.chart&&(com.kingdee.bos.extreport.runtime.chart={});"undefined"==typeof com.kingdee.bos.extreport.runtime.chart.change&&(com.kingdee.bos.extreport.runtime.chart.change={});var C=com.kingdee.bos.extreport.runtime.chart.change;C.ChartChangeFacadeImpl=function(){this.chartChangeLink=function(ta,ja,va){ta={pageId:ta.pageId,chartID:ta.chartID,chartType:ta.chartType,
currentSheetName:ta.currentSheetName};Z(ja,va).chartChangeLink(ta)};var Z=function(ta,ja,va){return new p(oa(),ta,function(Fa,wa,fa){return!(!ja||!ja(Fa,wa,fa))},va)},oa=function(){var ta=new q;ta.setRemoteUrl((da?da:"/ierp")+"/qing_rpt/runtime.do");ta.setTag(U);return ta}};C.ChartItemModel=function(Z,oa){this.getChartAlias=function(){return oa};this.getChartName=function(){return Z}};C.CustomPainter=function(Z,oa,ta){Z?ta?oa.text(ta.getChartAlias()):oa.text(I.get("changeChart","\u5207\u6362\u56fe\u8868")):
oa.text(ta.getChartAlias())};var M,P,da,U,ka,I;(function(){var Z=com.kingdee.bos.qing.framework.common;M=Z.AbstractFacade;P=Z.AbstractRemoteCall;I=Z.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.linkage);Z=com.kingdee.bos.qing.common;ka=Z.Util;U=ka.decodeParamFromUrl(location.search,"tag");da=ka.decodeParamFromUrl(location.search,"path")})();var J={};J.QPie=I.get("QPie","\u997c\u56fe");J.QRosePie=I.get("QRosePie","\u73ab\u7470\u56fe");J.QColumn=I.get("QColumn","\u67f1\u5f62\u56fe");
J.QMSColumn=I.get("QMSColumn","\u591a\u7cfb\u5217\u67f1\u5f62\u56fe");J.QSTColumn=I.get("QSTColumn","\u5806\u79ef\u67f1\u5f62\u56fe");J.QPSTColumn=I.get("QPSTColumn","\u767e\u5206\u6bd4\u5806\u79ef\u67f1\u5f62\u56fe");J.QPColumn=I.get("QPColumn","\u67f1\u5f62\u8fdb\u5ea6\u56fe");J.QLine=I.get("QLine","\u6298\u7ebf\u56fe");J.QMSLine=I.get("QMSLine","\u591a\u7cfb\u5217\u6298\u7ebf\u56fe");J.QArea=I.get("QArea","\u9762\u79ef\u56fe");J.QSTArea=I.get("QSTArea","\u5806\u79ef\u9762\u79ef\u56fe");J.QPSTArea=
I.get("QPSTArea","\u767e\u5206\u6bd4\u5806\u79ef\u9762\u79ef\u56fe");J.QRingPie=I.get("QRingPie","\u73af\u5f62\u56fe");J.QBar=I.get("QBar","\u6761\u5f62\u56fe");J.QMSBar=I.get("QMSBar","\u591a\u7cfb\u5217\u6761\u5f62\u56fe");J.QSTBar=I.get("QSTBar","\u5806\u79ef\u6761\u5f62\u56fe");J.QPSTBar=I.get("QPSTBar","\u767e\u5206\u6bd4\u5806\u79ef\u6761\u5f62\u56fe");J.QPBar=I.get("QPBar","\u6761\u5f62\u8fdb\u5ea6\u56fe");J.QFunnel=I.get("QFunnel","\u6f0f\u6597\u56fe");J.QWaterFall=I.get("QWaterFall","\u7011\u5e03\u56fe");
J.QRadar=I.get("QRadar","\u96f7\u8fbe\u56fe");J.QMSRadar=I.get("QMSRadar","\u591a\u7cfb\u5217\u96f7\u8fbe\u56fe");J.QRectTree=I.get("QRectTree","\u5355\u5c42\u6811\u56fe");J.QMSRectTree=I.get("QMSRectTree","\u53cc\u5c42\u6811\u56fe");J.QMSSunburst=I.get("QMSSunburst","\u65ed\u65e5\u56fe");J.Pie2D=I.get("Pie2D","2D\u997c\u56fe");J.Pie3D=I.get("Pie3D","\u5b9e\u5fc3\u73ab\u7470\u56fe");J.Doughnut2D=I.get("Doughnut2D","2D\u751c\u751c\u5708\u56fe");J.Doughnut3D=I.get("Doughnut3D","\u7a7a\u5fc3\u73ab\u7470\u56fe");
J.Column2D=I.get("Column2D","2D\u67f1\u5f62\u56fe");J.Column3D=I.get("Column3D","3D\u67f1\u5f62\u56fe");J.MSColumn2D=I.get("MSColumn2D","\u591a\u7cfb\u52172D\u67f1\u5f62\u56fe");J.MSColumn3D=I.get("MSColumn3D","\u591a\u7cfb\u52173D\u67f1\u5f62\u56fe");J.StCol2D=I.get("StCol2D","\u5806\u79ef2D\u67f1\u5f62\u56fe");J.StCol3D=I.get("StCol3D","\u5806\u79ef3D\u67f1\u5f62\u56fe");J.ScrollColumn2D=I.get("ScrollColumn2D","\u5e26\u6eda\u52a8\u6761\u7684\u591a\u7cfb\u52172D\u67f1\u5f62\u56fe");J.ScrollStackedCol2D=
I.get("ScrollStackedCol2D","\u5e26\u6eda\u52a8\u6761\u7684\u5806\u79ef2D\u67f1\u5f62\u56fe");J.Bar2D=I.get("Bar2D","2D\u6761\u5f62\u56fe");J.MSBar2D=I.get("MSBar2D","\u591a\u7cfb\u52172D\u6761\u5f62\u56fe");J.MSBar3D=I.get("MSBar3D","\u591a\u7cfb\u52173D\u6761\u5f62\u56fe");J.StBar2D=I.get("StBar2D","\u5806\u79ef2D\u6761\u5f62\u56fe");J.StBar3D=I.get("StBar3D","\u5806\u79ef3D\u6761\u5f62\u56fe");J.Line2D=I.get("Line2D","2D\u6298\u7ebf\u56fe");J.MSLine=I.get("MSLine","\u591a\u7cfb\u52172D\u6298\u7ebf\u56fe");
J.ScrollLine2D=I.get("ScrollLine2D","\u5e26\u6eda\u52a8\u6761\u7684\u591a\u7cfb\u52172D\u6298\u7ebf\u56fe");J.Area2D=I.get("Area2D","2D\u9762\u79ef\u56fe");J.MSArea2D=I.get("MSArea2D","\u5e26\u6eda\u52a8\u6761\u7684\u591a\u7cfb\u52172D\u9762\u79ef\u56fe");J.StArea2D=I.get("StArea2D","\u5806\u79ef2D\u9762\u79ef\u56fe");J.ScrollArea2D=I.get("ScrollArea2D","\u591a\u7cfb\u52172D\u9762\u79ef\u56fe");J.Combi2D=I.get("Combi2D","2D\u7ec4\u5408\u56fe");J.Combi3D=I.get("Combi3D","3D\u7ec4\u5408\u56fe");J.Combi2DDY=
I.get("Combi2DDY","\u53ccY\u8f742D\u7ec4\u5408\u56fe");J.ScrollCombi2D=I.get("ScrollCombi2D","\u5e26\u6eda\u52a8\u6761\u76842D\u7ec4\u5408\u56fe");J.ScrollCombi2DDY=I.get("ScrollCombi2DDY","\u53ccY\u8f74\u5e26\u6eda\u52a8\u6761\u76842D\u7ec4\u5408\u56fe");J.Col3DLine=I.get("Col3DLine","3D\u67f1\u5f62\u7ec4\u5408\u56fe");J.Col3DLineDY=I.get("Col3DLineDY","\u53ccY\u8f743D\u7ec4\u5408\u56fe");J.Pyramid=I.get("Pyramid","\u91d1\u5b57\u5854\u56fe");J.Funnel=I.get("Funnel","\u6f0f\u6597\u56fe");J.Radar=
I.get("Radar","\u96f7\u8fbe\u56fe");C.getChartAlias=function(Z){return J[Z]}})();(function(){function p(){var M=this,P,da,U,ka,I,J,Z;this.setJqParent=function(va){P=va};this.setBeforeSlideListener=function(va){I=va};this.setAfterSlideListener=function(va){J=va};this.slide=function(va,Fa,wa,fa,ea,xa){I&&I();U&&oa(U);va=_jqCellCurrentUi=ja(va,Fa);Fa=xa.getCurrentScenario()==C.CARD;var ia=xa.getCurrentScenario()==C.CARD_MOBILE,ra=0<$("#previewLimitShowPrompt").length&&"none"!=$("#previewLimitShowPrompt").css("display");xa=xa.getSchemaPanel();q.layoutCtrl(va,0,0,240,0);va.appendTo(ta());
for(var H=0,L=0,A=ka.children(),B=0;B<A.length;B++){var b=$(A[B]),m=parseInt(b.css("width"));b=b.outerWidth(!0);H=Math.max(H,m);L=Math.max(L,b)}va.css("width",L);for(B=0;B<A.length;B++){b=$(A[B]);b.css("width",H);var l=b.prop("offsetTop")+b.prop("offsetHeight")}l=Math.min(200,ka.prop("offsetTop")+l+8);A=H=0;var y=ea||y||window.event;try{y instanceof TouchEvent&&y.changedTouches&&y.changedTouches[0]&&(y=y.changedTouches[0])}catch(v){}if(y.pageX||y.pageY)H=y.pageX,A=y.pageY;ea=window.innerHeight||document.documentElement.offsetHeight;
y=window.innerWidth||document.documentElement.offsetWidth;ea=0<l+A-ea+45?l+A-ea+45:0;y=0<L+H-y+15?L+H-y+15:0;Fa?(A-=40,H-=20):ia?(A-=74,H-=8):(xa&&(B=xa.getJqUi(),A-=B.parent().innerHeight()),ra&&(A-=45),H-=10,A=A-10-45);fa&&(fa=$(wa).offset().top,wa=$(wa).offset().left,Fa?(fa-=40,wa-=20):ia?(fa=A-74,wa=H-8):(xa&&(B=xa.getJqUi(),A-=B.parent().innerHeight()),ra&&(fa-=45),fa-=55,wa-=10),A-=fa,H-=wa);q.layoutCtrl(va,0<H-y?H-y:0,0<A-ea?A-ea:0,L,l);va.animate({left:0<H-y?H-y:0},250)};this.abandon=function(){da&&
da.remove();U=da=null};this.sayGoodbye=function(va,Fa){U&&oa(U);clearTimeout(Z);var wa=P.find(".pop-menu-bye");if(0==wa.length){var fa=P.prop("clientWidth");wa=$("<div>");wa.addClass("pop-menu-bye");q.layoutCtrl(wa,fa,"40%","100%",20);wa.appendTo(ta());wa.animate({left:0},500)}wa.text(va);Z=setTimeout(M.abandon,Fa?Fa:5E3)};this.closePopMenu=function(){U&&oa(U);clearTimeout(Z);Z=setTimeout(M.abandon,0)};var oa=function(va,Fa){var wa=0-va.prop("offsetWidth");va.animate({left:wa},250,function(){va.remove();
Fa&&Fa()})},ta=function(){da||(da=$("<div>"),da.css("background-color","rgba(0,0,0,0.001)"),da.appendTo(P),q.layoutCtrlWithLRTB(da,0,0,null,0,0,null));return da},ja=function(va,Fa){var wa=$("<div>");wa.css("z-index",8);wa.addClass("pop-menu");var fa=$("<div>");fa.text(va[0].getMenuName());fa.addClass("pop-menu-tips");fa.appendTo(wa);fa=$("<div>");fa.text("\u00d7");fa.addClass("pop-menu-close");fa.on("click",function(H){oa(wa,M.abandon);va[0].getWrapCallbackFun(null,Fa,null,J)()});fa.appendTo(wa);
q.layoutCtrlWithLRTB(fa,null,0,20,0,null,20);ka=$("<div>");ka.css("overflow","auto");ka.css("overflow-x","hidden");ka.appendTo(wa);q.layoutCtrlWithLRTB(ka,0,0,null,16,8,null);for(fa=0;fa<va.length;fa++){var ea=$("<div>");ea.css({position:"relative",display:"block"});ea.addClass("pop-menu-item");var xa=va[fa],ia=fa,ra=xa.getDisplayLabel();ea.on("click",xa.getWrapCallbackFun(ea,Fa,ia,J));ea.text(ra);ea.attr("title",ra);ea.appendTo(ka)}return wa}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&
(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.runtime&&(com.kingdee.bos.extreport.runtime={});"undefined"==typeof com.kingdee.bos.extreport.runtime.popmenu&&(com.kingdee.bos.extreport.runtime.popmenu={});"undefined"==typeof com.kingdee.bos.extreport.runtime.popmenu.ui&&(com.kingdee.bos.extreport.runtime.popmenu.ui={});com.kingdee.bos.extreport.runtime.popmenu.ui.PopMenuJumpHelper=
function(M){var P;this.prepare=function(da,U,ka,I,J){if(1===da.length&&"innerLink"!=da[0].getLinkType())ka&&ka(da[0]);else{P||(P=new p);var Z=P;Z.abandon();Z.setJqParent($(U));Z.slide(da,da[0].getClickCallbackFun(da,ka,Z),U,I,J,M)}};this.getOperatingMenu=function(){return P}};var q,C;(function(){var M=com.kingdee.bos.qing.framework.common;M.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.runtime.linkage);M=com.kingdee.bos.qing.common;q=M.DomUtil;M=com.kingdee.bos.extreport.runtime.ui;
C=M.AbstractReportUI})()})();
//qingVersionTag: 20250324