var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(pa,fa,Aa){pa instanceof String&&(pa=String(pa));for(var Oa=pa.length,Pa=0;Pa<Oa;Pa++){var xb=pa[Pa];if(fa.call(Aa,xb,Pa,pa))return{i:Pa,v:xb}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(pa,fa,Aa){if(pa==Array.prototype||pa==Object.prototype)return pa;pa[fa]=Aa.value;return pa};$jscomp.getGlobal=function(pa){pa=["object"==typeof globalThis&&globalThis,pa,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var fa=0;fa<pa.length;++fa){var Aa=pa[fa];if(Aa&&Aa.Math==Math)return Aa}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(pa,fa){var Aa=$jscomp.propertyToPolyfillSymbol[fa];if(null==Aa)return pa[fa];Aa=pa[Aa];return void 0!==Aa?Aa:pa[fa]};
$jscomp.polyfill=function(pa,fa,Aa,Oa){fa&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(pa,fa,Aa,Oa):$jscomp.polyfillUnisolated(pa,fa,Aa,Oa))};$jscomp.polyfillUnisolated=function(pa,fa,Aa,Oa){Aa=$jscomp.global;pa=pa.split(".");for(Oa=0;Oa<pa.length-1;Oa++){var Pa=pa[Oa];if(!(Pa in Aa))return;Aa=Aa[Pa]}pa=pa[pa.length-1];Oa=Aa[pa];fa=fa(Oa);fa!=Oa&&null!=fa&&$jscomp.defineProperty(Aa,pa,{configurable:!0,writable:!0,value:fa})};
$jscomp.polyfillIsolated=function(pa,fa,Aa,Oa){var Pa=pa.split(".");pa=1===Pa.length;Oa=Pa[0];Oa=!pa&&Oa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var xb=0;xb<Pa.length-1;xb++){var Xa=Pa[xb];if(!(Xa in Oa))return;Oa=Oa[Xa]}Pa=Pa[Pa.length-1];Aa=$jscomp.IS_SYMBOL_NATIVE&&"es6"===Aa?Oa[Pa]:null;fa=fa(Aa);null!=fa&&(pa?$jscomp.defineProperty($jscomp.polyfills,Pa,{configurable:!0,writable:!0,value:fa}):fa!==Aa&&(void 0===$jscomp.propertyToPolyfillSymbol[Pa]&&(Aa=1E9*Math.random()>>>0,
$jscomp.propertyToPolyfillSymbol[Pa]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(Pa):$jscomp.POLYFILL_PREFIX+Aa+"$"+Pa),$jscomp.defineProperty(Oa,$jscomp.propertyToPolyfillSymbol[Pa],{configurable:!0,writable:!0,value:fa})))};$jscomp.polyfill("Array.prototype.find",function(pa){return pa?pa:function(fa,Aa){return $jscomp.findInternal(this,fa,Aa).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(pa){var fa=0;return function(){return fa<pa.length?{done:!1,value:pa[fa++]}:{done:!0}}};
$jscomp.arrayIterator=function(pa){return{next:$jscomp.arrayIteratorImpl(pa)}};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(pa){if(pa)return pa;var fa=function(xb,Xa){this.$jscomp$symbol$id_=xb;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:Xa})};fa.prototype.toString=function(){return this.$jscomp$symbol$id_};var Aa="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",Oa=0,Pa=function(xb){if(this instanceof Pa)throw new TypeError("Symbol is not a constructor");return new fa(Aa+(xb||"")+"_"+Oa++,xb)};return Pa},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(pa){if(pa)return pa;pa=Symbol("Symbol.iterator");for(var fa="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Aa=0;Aa<fa.length;Aa++){var Oa=$jscomp.global[fa[Aa]];"function"===typeof Oa&&"function"!=typeof Oa.prototype[pa]&&$jscomp.defineProperty(Oa.prototype,pa,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return pa},
"es6","es3");$jscomp.iteratorPrototype=function(pa){pa={next:pa};pa[Symbol.iterator]=function(){return this};return pa};$jscomp.iteratorFromArray=function(pa,fa){pa instanceof String&&(pa+="");var Aa=0,Oa=!1,Pa={next:function(){if(!Oa&&Aa<pa.length){var xb=Aa++;return{value:fa(xb,pa[xb]),done:!1}}Oa=!0;return{done:!0,value:void 0}}};Pa[Symbol.iterator]=function(){return Pa};return Pa};
$jscomp.polyfill("Array.prototype.keys",function(pa){return pa?pa:function(){return $jscomp.iteratorFromArray(this,function(fa){return fa})}},"es6","es3");
(function(){function pa(){var Q=this,W,Z,da,g=[],w,L,wa=[];this.setUserObject=function(M){w=M};this.getUserObject=function(){return w};this.setParent=function(M){W=M};this.getParent=function(){return W};this.setChildren=function(M){if(!M)throw Error("Parameter 'arrChildren' must not be undefined.");g=M};this.getChildren=function(){return g};this.addChild=function(M){g||(g=[]);g.push(M)};this.setLevel=function(M){Z=M};this.getLevel=function(){return Z};this.setExpanded=function(M){da=M};this.isExpanded=
function(){return da};this.setName=function(M){L=M};this.getName=function(){return L};this.setTreeNodeList=function(M){wa=M};this.getTreeNodeList=function(){return wa};this.addTreeNode=function(M){wa||(wa=[]);wa.push(M)};this.fromJsonObject=function(M){if(M=M.children)for(var Da=0;Da<M.length;Da++){var Ya=M[Da],Ra=new pa;Ra.setLevel(Q.getLevel()+1);var G=new fa;G.fromJsonObject(Ya);Ra.fromJsonObject(Ya);Ra.setExpanded(!1);Ra.setParent(this);Ra.setUserObject(G);Ra.setName(G.getExtReportGroupName());
g.push(Ra)}}}function fa(){var Q=this,W,Z,da,g,w=!1,L,wa;this.setOrderID=function(M){da=M};this.getOrderID=function(){return da};this.setIsPreset=function(M){g=M};this.isPreset=function(){return g};this.setExtReportGroupID=function(M){W=M};this.getExtReportGroupID=function(){return W};this.setExtReportGroupName=function(M){Z=M};this.getExtReportGroupName=function(){return Z};this.setHasData=function(M){w=M};this.hasData=function(){return w};this.setParentID=function(M){L=M};this.getParentID=function(){return L};
this.setSpaceID=function(M){wa=M};this.getSpaceID=function(){return wa};this.fromJsonObject=function(M){Q.setExtReportGroupID(M.extreportGroupID);Q.setExtReportGroupName(M.extreportGroupName);Q.setIsPreset(M.isPreset);Q.setOrderID(M.orderID);Q.setParentID(M.parentID);Q.setSpaceID(M.spaceID)};this.toJsonObject=function(){var M={};M.extreportGroupID=W;M.extreportGroupName=Z;M.isPreset=g;M.orderID=da;M.parentID=L;M.spaceID=wa;return M}}function Aa(){var Q=this,W,Z,da,g,w,L,wa,M,Da,Ya,Ra,G,jb,La,Jb,sb;
this.copy=function(){var O=new Aa;O.setExtReportID(W);O.setExtReportGroupID(Z);O.setExtReportName(da);O.setExtRptType(wa);O.setDataSetType(M);O.setDescription(g);O.setCreateTime(w);O.setModifyTime(L);O.setTemplateType(Da);O.setFormatCreateTime(G);O.setFormatModifyTime(jb);O.setLockHolderName(La);O.setLockType(sb);O.setUserAcquiredLock(Jb);return O};this.equal=function(O){return Q.getExtReportID()===O.getExtReportID()&&Q.getExtReportGroupID()===O.getExtReportGroupID()};this.setDataSetType=function(O){M=
O};this.getDataSetType=function(){return M};this.setTemplateType=function(O){Da=O};this.getTemplateType=function(){return Da};this.setModifyTime=function(O){L=O};this.getModifyTime=function(){return L};this.setCreateTime=function(O){w=O};this.getCreateTime=function(){return w};this.setFormatCreateTime=function(O){G=O};this.getFormatCreateTime=function(){return G};this.setFormatModifyTime=function(O){jb=O};this.getFormatModifyTime=function(){return jb};this.setExtRptType=function(O){wa=O};this.getExtRptType=
function(){return wa};this.setExtReportID=function(O){W=O};this.getExtReportID=function(){return W};this.setExtReportGroupID=function(O){Z=O};this.getExtReportGroupID=function(){return Z};this.setExtReportName=function(O){da=O};this.getExtReportName=function(){return da};this.setDescription=function(O){g=O};this.getDescription=function(){return g};this.setBeforeMovedExtReportGroupId=function(O){Ya=O};this.getBeforeMovedExtReportGroupId=function(){return Ya};this.setIsPreset=function(O){Ra=O};this.isPreset=
function(){return Ra};this.getLockHolderName=function(){return La};this.setLockHolderName=function(O){La=O};this.isUserAcquiredLock=function(){return Jb};this.setUserAcquiredLock=function(O){Jb=O};this.getLockType=function(){return sb};this.setLockType=function(O){sb=O};this.fromJsonObject=function(O){Q.setExtReportID(O.extReportID);Q.setExtReportGroupID(O.extReportGroupID);Q.setExtReportName(O.extReportName);Q.setExtRptType(O.extRptType);Q.setDataSetType(O.dataSetType);Q.setDescription(O.description);
Q.setCreateTime(O.createTime);Q.setModifyTime(O.modifyTime);Q.setTemplateType(O.templateType);Q.setIsPreset(O.isPreset);Q.setFormatCreateTime(O.formatCreateTime);Q.setFormatModifyTime(O.formatModifyTime);Q.setUserAcquiredLock(O.isUserAcquiredLock);Q.setLockType(O.lockType);Q.setLockHolderName(O.lockHolderName)};this.toJsonObject=function(){var O={};O.extReportID=W;O.extReportGroupID=Z;O.extReportName=da;O.extRptType=wa;O.dataSetType=M;O.description=g;O.createTime=w;O.modifyTime=L;O.templateType=Da;
O.isPreset=Ra;O.formatCreateTime=G;O.formatModifyTime=jb;O.isUserAcquiredLock=Jb;O.lockType=sb;O.lockHolderName=La;return O};this.getDisplayTypeName=function(){if(wa==Aa.TYPE_EXTRPT)return Xa.get("commonReport","\u62a5\u8868");if(wa==Aa.TYPE_DATASET){a:{var O=M;var P=Pa.AllDataSetType,y;for(y in P){var ha=P[y];if(O==ha.getTypeID()){O=Xa.get(ha.getI18nKey(),ha.getDefaultDesc());break a}}O=void 0}return O}}}function Oa(){var Q=this,W,Z,da,g,w,L,wa,M;this.getId=function(){return W};this.setId=function(Da){W=
Da};this.getPublishTargetType=function(){return Z};this.setPublishTargetType=function(Da){Z=Da};this.getName=function(){return da};this.setName=function(Da){da=Da};this.getPathText=function(){return g};this.setPathText=function(Da){g=Da};this.getUsers=function(){return w};this.setUsers=function(Da){w=Da};this.getRoles=function(){return L};this.setRoles=function(Da){L=Da};this.getViewType=function(){return wa};this.setViewType=function(Da){wa=Da};this.getPermLabels=function(){return M};this.setPermLabels=
function(Da){M=Da};this.fromJsonObject=function(Da){if(Da){Q.setId(Da.id);Q.setPublishTargetType(Da.publishTargetType);Q.setName(Da.name);Q.setPathText(Da.pathText);if(Da.users){for(var Ya=[],Ra=Da.users,G=0;G<Ra.length;G++)Ya.push(Ra[G].text);Q.setUsers(Ya)}if(Da.roles){Ya=[];Ra=Da.roles;for(G=0;G<Ra.length;G++)Ya.push(Ra[G].text);Q.setRoles(Ya)}Ya=[];if(Da=Da.permLabels)for(G=0;G<Da.length;G++)Ra=new Sb,Ra.fromJsonObject(Da[G]),Ya.push(Ra.getName());Q.setPermLabels(Ya)}}}function Pa(Q,W,Z){this.getTypeID=
function(){return Q};this.getI18nKey=function(){return W};this.getDefaultDesc=function(){return Z}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.manage&&(com.kingdee.bos.extreport.manage={});"undefined"==typeof com.kingdee.bos.extreport.manage.model&&(com.kingdee.bos.extreport.manage.model=
{});var xb=com.kingdee.bos.extreport.manage.model;xb.ExtReportGroupModel=fa;xb.ExtReportModel=Aa;xb.ExtReportType=Pa;xb.TreeNode=pa;xb.ExtReportDetailModel=function(){var Q=this,W,Z,da,g,w;this.setCreateDate=function(L){W=L};this.getCreateDate=function(){return W};this.setModifyDate=function(L){Z=L};this.getModifyDate=function(){return Z};this.setCreator=function(L){da=L};this.getCreator=function(){return da};this.setLastModifier=function(L){g=L};this.getLastModifier=function(){return g};this.setPubDetail=
function(L){w=L};this.getPubDetail=function(){return w};this.fromJsonObject=function(L){if(L){Q.setCreateDate(L.createDate);Q.setModifyDate(L.modifyDate);Q.setPubDetail(L.publishVO);Q.setCreator(L.creator);Q.setLastModifier(L.modifier);var wa=[];L=L.publishVO;for(var M=0;M<L.length;M++){var Da=new Oa;Da.fromJsonObject(L[M]);wa.push(Da)}Q.setPubDetail(wa)}}};var Xa,Sb;(function(){var Q=com.kingdee.bos.qing.framework.common;Xa=Q.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.manage.model);
Q=com.kingdee.bos.qing.publish.model;Sb=Q.PermissionLabelModel})();Aa.TYPE_EXTRPT="0";Aa.TYPE_DATASET="1";Aa.DATASET_TYPE_GENERIC_QUERY_DATASET="10";Aa.DATASET_TYPE_SQL_DATASET="1";Aa.DATASET_TYPE_PROCEDURE_DATASET="2";Aa.DATASET_TYPE_JAVA_DATASET="3";Aa.DATASET_TYPE_OQL_DATASET="9";Pa.PERSONAL="PERSONAL";Pa.COLLABORATION="COLLABORATION";Pa.PRESET="PRESET";Aa.createInstance=function(Q){if(Q){var W=new Aa;W.fromJsonObject(Q);return W}};Aa.pushIfAbsent=function(Q,W){if(W){for(var Z=!0,da=0;da<W.length;da++)if(W[da].equal(Q)){Z=
!1;break}Z&&W.push(Q)}};Pa.AllDataSetType=[new Pa(Aa.DATASET_TYPE_GENERIC_QUERY_DATASET,"genericDataSet","\u901a\u7528\u67e5\u8be2\u6570\u636e\u96c6"),new Pa(Aa.DATASET_TYPE_OQL_DATASET,"oqlDataSet","\u5b9e\u4f53\u67e5\u8be2\u6570\u636e\u96c6"),new Pa(Aa.DATASET_TYPE_SQL_DATASET,"addSqlDataSet","SQL\u6570\u636e\u96c6"),new Pa(Aa.DATASET_TYPE_JAVA_DATASET,"javaDataSet","Java\u6570\u636e\u96c6")];Pa.AllFilterType=[new Pa("ALL_TYPE","allType","\u5168\u90e8\u7c7b\u578b"),new Pa("EXTREPORT","commonReport",
"\u62a5\u8868"),new Pa("DATASET","dataSet","\u6570\u636e\u96c6")];Pa.AllSpaceType=[new Pa(Pa.PERSONAL,"personalSpace","\u4e2a\u4eba\u7a7a\u95f4"),new Pa(Pa.COLLABORATION,"collaborationSpace","\u534f\u4f5c\u7a7a\u95f4")]})();(function(){function pa(){Pa.call(this);var Q;this.getRemoteUrl=function(){return Q};this.setRemoteUrl=function(W){Q=W}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.manage&&(com.kingdee.bos.extreport.manage={});"undefined"==typeof com.kingdee.bos.extreport.manage.common&&(com.kingdee.bos.extreport.manage.common=
{});var fa=com.kingdee.bos.extreport.manage.common;fa.Facade=function(Q,W,Z,da){Aa.call(this,Q,W,Z,da);var g=this.protectedMethod;this.getExtReportGroupList=function(w){g.remote("loadExtReportGroups",{spaceId:w})};this.checkPresetManagePerm=function(){g.remote("checkPresetManagePerm",{})};this.saveExtReportGroup=function(w,L){w={model:JSON.stringify(w.toJsonObject()),spaceId:L};g.remote("saveOrUpdateExtReportGroup",w)};this.editExtReportGroup=function(w,L){w={model:JSON.stringify(w.toJsonObject()),
spaceId:L};g.remote("saveOrUpdateExtReportGroup",w)};this.deleteExtReportGroupByGroupID=function(w){g.remote("deleteExtReportGroupByGroupID",{extreportGroupID:w})};this.existExtReport=function(w,L){g.remote("existExtReport",{extReportType:w,extReportID:L})};this.loadExtReportByGroupIDS=function(w){w={arrExtReportGroupID:JSON.stringify(w)};g.remote("loadExtReportByGroupIDS",w)};this.saveOrUpdateExtReport=function(w,L){w={model:JSON.stringify(w.toJsonObject()),spaceId:L};g.remote("saveOrUpdateExtReport",
w)};this.moveExtReport=function(w,L,wa,M,Da,Ya){w={extreportGroupID:w,extReportList:JSON.stringify({extReportList:L}),bMultiChoiceMove:wa,bFirstTimeMove:M,spaceId:Da,spaceType:Ya};g.remote("moveExtReport",w)};this.copyExtReport=function(w,L,wa,M,Da,Ya,Ra,G){g.remote("copyExtReport",{extReportID:w,extreportGroupID:L,copyName:wa,extRptType:M,dataSetType:Da,CopyExtReport:Ya,spaceId:Ra,toSpaceId:G})};this.batchDeleteExtReport=function(w,L,wa){w={extReportList:JSON.stringify({extReportList:w}),isDeletePublish:L,
spaceId:wa};g.remote("batchDeleteExtReport",w)};this.loadSortedExtReportByGroupId=function(w,L,wa,M){g.remote("loadSortedExtReportByGroupId",{extreportGroupID:w,sSortField:L,sSortOrder:wa,spaceId:M})};this.loadExceptionLog=function(w){g.remote("loadExceptionLog",{id:w})};this.getAllExtReportForExport=function(w){g.remote("getAllExtReportForExport",{sSpaceId:w})};this.confirmExportExtReport=function(w,L,wa){w={extReportList:JSON.stringify({exportExtReportList:w}),withPublish:L,spaceId:wa};g.remote("confirmExportExtReport",
w)};this.getExportedData=function(w){var L=Xa.formatDate("yyyyMMdd_HHmmss");xb.downloadFile("Qing-"+L+".qing-rpt",w)};this.getSelectableForImportExtReport=function(w,L,wa){g.remote("getSelectableForImportExtReport",{fileName:w,fileOrignalName:L,sCurrentExtReportGroupFullPath:wa})};this.importSelectedExtReport=function(w,L,wa,M,Da,Ya,Ra,G){w={sCurrentExtReportGroupFullPath:w,fileName:L,fileOrignalName:wa,extReportList:JSON.stringify({exportExtReportList:M}),sourceStrategy:Da,firstTimeImport:Ya,spaceId:Ra,
spaceType:G};g.remote("importSelectedExtReport",w)};this.saveOrderExtReportGroup=function(w){w={extReportGroupList:JSON.stringify({extReportGroupList:w})};g.remote("saveOrderExtReportGroup",w)};this.loadExtReportDetail=function(w,L,wa){g.remote("loadExtReportDetail",{extReportID:w,extReportType:L,sSpaceId:wa})}};fa.RemoteImpl=pa;fa.EventListenerMap=function(){var Q={};this.addListener=function(W,Z){var da=Q[W];da||(da=[],Q[W]=da);for(W=0;W<da.length;W++)if(da[W]==Z)return;da.push(Z)};this.removeListener=
function(W,Z){if(W=Q[W])for(var da=W.length-1;0<=da;da--)if(W[da]==Z){W.splice(da,1);break}};this.fireEvent=function(W,Z){if(W=Q[W])for(var da=W.length-1;0<=da;da--)W[da](Z)}};var Aa,Oa,Pa,xb,Xa;(function(){var Q=com.kingdee.bos.qing.framework.common;Aa=Q.AbstractFacade;Oa=Q.AbstractIcons;Pa=Q.AbstractRemoteCall;xb=Q.RemoteFramework;Q=com.kingdee.bos.qing.common;Xa=Q.Util})();fa.Icons=new function(){Oa.call(this);var Q=this.protectedMethod;this.protectedInit=function(da,g){da=com.kingdee.bos.extreport.manage.ComboIcon;
if(!da)throw Error("com.kingdee.bos.extreport.manage.ComboIcon not found.");da.define(g,"extreport");g.setGap(1);g.setStartPosition(1,1);g.setIconSize(16,16);W(0,0,"btn-add-classification");W(0,1,"btn-import");W(0,2,"btn-export");W(0,3,"btn-edit");W(0,4,"btn-delete");W(0,5,"btn-extreport");W(0,6,"btn-preview");W(0,7,"btn-publishto");W(0,8,"btn-dataset");W(0,9,"btn-moving");W(0,10,"btn-copy");W(0,11,"btn-program");W(0,14,"btn-dataset-gui");g.setStartPosition(1,120);g.setIconSize(36,36);Z(0,0,"icon-card-dataset");
Z(0,1,"icon-card-extreport");Z(0,2,"icon-preset-small");Z(0,3,"icon-card-programablecard");g.setStartPosition(1,69);g.setIconSize(50,50);Z(0,0,"icon-addcard");Z(0,1,"icon-preset-big");g.setStartPosition(207,78);g.setIconSize(65,78);Z(0,0,"icon-question");g.setGap(0);g.setStartPosition(0,0);da.define(g,"icon_search");g.setIconSize(17,17);Z(0,0,"icon_search");da.define(g,"icon_search_hover");g.setIconSize(17,17);Z(0,0,"icon_search_hover");da.define(g,"btn_orderup");g.setIconSize(17,17);Z(0,0,"btn_orderup");
da.define(g,"btn_orderup_hover");g.setIconSize(17,17);Z(0,0,"btn_orderup_hover");da.define(g,"btn-add-classification");g.setIconSize(17,17);Z(0,0,"btn-add-classification");da.define(g,"btn-add-classification_hover");g.setIconSize(17,17);Z(0,0,"btn-add-classification_hover");da.define(g,"no-data");Z(0,0,"no-data");da.define(g,"group-extreport-no-data");g.setStartPosition(0,0);g.setGap(0);g.setIconSize(264,191);Z(0,0,"group-extreport-no-data");da.define(g,"extreport-icons");g.setStartPosition(0,0);
g.setGap(1);g.setIconSize(16,16);Z(6,0,"menu");Z(7,0,"menu_hover");Z(8,14,"icon-order-up");Z(9,14,"icon-order-up_hover");da.define(g,"search_category");g.setIconSize(16,16);Z(0,0,"search_category");da.define(g,"search_category_hover");g.setIconSize(16,16);Z(0,0,"search_category_hover");da.define(g,"all_expand");g.setIconSize(16,16);Z(0,0,"all_expand");da.define(g,"all_expand_hover");g.setIconSize(16,16);Z(0,0,"all_expand_hover");da.define(g,"all_collapse");g.setIconSize(16,16);Z(0,0,"all_collapse");
da.define(g,"all_collapse_hover");g.setIconSize(16,16);Z(0,0,"all_collapse_hover");da.define(g,"extreport_search");g.setIconSize(16,16);g.setGap(1);g.setStartPosition(1,1);Z(0,2,"arrow-down");Z(0,3,"arrow-up");g.setStartPosition(0,0);g.setIconSize(16,16);da.define(g,"card-view.svg");Z(0,0,"card-view");da.define(g,"card-view-click.svg");Z(0,0,"card-view-on");da.define(g,"list-view.svg");Z(0,0,"list-view");da.define(g,"list-view-click.svg");Z(0,0,"list-view-on");da.define(g,"list_view_edit");Z(0,0,
"list_view_edit");da.define(g,"list_view_edit_hover");Z(0,0,"list_view_edit_hover");da.define(g,"qingrpt");g.setGap(1);g.setStartPosition(1,1);g.setIconSize(16,16);Z(1,12,"info");Z(1,13,"info_hover");da.define(g,"report_designer");Z(0,0,"btn_report_designer_larger");da.define(g,"report_designer_hover");Z(0,0,"btn_report_designer_larger_hover");da.define(g,"dataset_designer");Z(0,0,"btn_dataset_designer_larger");da.define(g,"dataset_designer_hover");Z(0,0,"btn_dataset_designer_larger_hover");da.define(g,
"extreport_preview");Z(0,0,"btn_report_preview_larger");da.define(g,"extreport_preview_hover");Z(0,0,"btn_report_preview_larger_hover");da.define(g,"dataset_preview");Z(0,0,"btn_dataset_preview_larger");da.define(g,"dataset_preview_hover");Z(0,0,"btn_dataset_preview_larger_hover")};var W=function(da,g,w){Z(da,g,w+"_hover");Z(da+1,g,w)},Z=function(da,g,w){Q.registIcon(da,g,w)}};fa.Integration=new function(){var Q,W,Z,da,g,w,L=new pa,wa,M,Da,Ya,Ra;this.setFunPublishContentEditEntrance=function(G){M=
G};this.getFunPublishContentEditEntrance=function(){return M};this.setFunPublishContext=function(G){wa=G};this.getFunPublishContext=function(){return wa};this.setParamPathPrefix=function(G){g=G};this.getParamPathPrefix=function(){return g};this.setFunPublishRemoteImpl=function(G){w=G};this.getFunPublishRemoteImpl=function(){return w};this.getRemoteImpl=function(){return L};this.setRemoteUrl=function(G){L.setRemoteUrl(G)};this.getExtReportDesignerEntrance=function(){return Q};this.setExtReportDesignerEntrance=
function(G){Q=G};this.getExtReportPreviewEntrance=function(){return W};this.setExtReportPreviewEntrance=function(G){W=G};this.getDataSetDesignerEntrance=function(){return Z};this.setDataSetDesignerEntrance=function(G){Z=G};this.getDataSetPreviewEntrance=function(){return da};this.setDataSetPreviewEntrance=function(G){da=G};this.getMessageRemoteUrl=function(){return Da};this.setMessageRemoteUrl=function(G){Da=G};this.setImportJSCodeForManager=function(G){Ya=G};this.getImportJSCodeForManager=function(){return Ya};
this.getAppId=function(){return Ra};this.setAppId=function(G){Ra=G}};fa.EventType={IS_SHOW_GUI_ENTER_ICON:"IS_SHOW_GUI_ENTER_ICON",UPDATE_EXTREPORT_GROUP_AFTER_MOVEED:"UPDATE_EXTREPORT_GROUP_AFTER_MOVEED",UPDATE_EXTREPORT_GROUP_AFTER_DELETED:"UPDATE_EXTREPORT_GROUP_AFTER_DELETED",UPDATE_EXTREPORT_GROUP_AFTER_COPIED:"UPDATE_EXTREPORT_GROUP_AFTER_COPIED",UPDATE_EXTREPORT_GROUP_AFTER_CREATED:"UPDATE_EXTREPORT_GROUP_AFTER_CREATED",UPDATE_CURRENT_CATEGORY:"UPDATE_CURRENT_CATEGORY",REFRESH_EXTREPORT_FUNCTION:"REFRESH_EXTREPORT_FUNCTION",
UPDATE_CARD_CONTAINER:"UPDATE_CARD_CONTAINER",UPDATE_LIST_CONTAINER:"UPDATE_LIST_CONTAINER",UPDATE_CURRENT_EXTREPORT_HAS_DATA:"UPDATE_CURRENT_EXTREPORT_HAS_DATA",UPDATE_UNLOAD_EXTREPORT_GROUPID:"UPDATE_UNLOAD_EXTREPORT_GROUPID",LOAD_EXTREPORT_BY_GROUP_IDS:"LOAD_EXTREPORT_BY_GROUP_IDS",OPEN_DESIGNER:"OPEN_DESIGNER"};var Sb=new function(){var Q;this.hookCollector=function(W){Q=W};this.occur=function(W,Z){try{Q&&Q(W,Z)}catch(da){window.console&&console.warn(da)}};this.getPublishTargetName=function(W){if(0==
W)return"Appmenu";if(1==W)return"Center"}};Sb.EXT_CREATE_EXTREPORT_TYPE="ext-create-extreport-type";Sb.EXT_EXTREPORT_ENTRANCE_TYPE="ext-extreport-entrance-type";Sb.PUBLISH_TO_TYPE="publish-to-type";Sb.SAVE_SNAP_TO_TYPE="save-snap-to-type";fa.UserOperationReporter=Sb;fa.DraggableAdjustingCustomExpandor=function(){KTableUIDraggableAdjustingHandler.CustomExpendor.call(this);this.getTailBlankForDragging=function(){return-1};this.isRowDraggable=function(Q,W){return!1};this.isColumnDraggable=function(Q,
W){return Q.getColumnsCount()==W+1||0==W?!1:!0};this.getMinRowHeightLimited=function(Q,W){return 3};this.getMinColumnWidthLimited=function(Q,W){return 50};this.rowDraggedAction=function(Q,W,Z){var da=Q.isSyncUIWhenModelChanged();Q.setSyncUIWhenModelChanged(!0);W=Q.getRow(W);W.setHeight(W.getHeight()+Z);Q.setSyncUIWhenModelChanged(da)};this.setMinColumnWidth=function(Q){};this.columnDraggedAction=function(Q,W,Z){var da=Q.isSyncUIWhenModelChanged();Q.setSyncUIWhenModelChanged(!0);W=Q.getColumn(W);W.setWidth(W.getWidth()+
Z);Q.setSyncUIWhenModelChanged(da)}}})();(function(){function pa(){}function fa(){}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.manage&&(com.kingdee.bos.extreport.manage={});"undefined"==typeof com.kingdee.bos.extreport.manage.common&&(com.kingdee.bos.extreport.manage.common={});"undefined"==typeof com.kingdee.bos.extreport.manage.common.ui&&
(com.kingdee.bos.extreport.manage.common.ui={});var Aa=com.kingdee.bos.extreport.manage.common.ui;Aa.StringUtil=pa;Aa.BlinkHelper=function(){var g=350,w=250,L=6,wa=!1,M,Da;this.setDuration=function(Ya,Ra){g=Ya;w=Ra};this.setTimes=function(Ya,Ra){L=2*Ya+(Ra?1:0);wa=Ra};this.setAction=function(Ya){M=Ya};this.blink=function(Ya,Ra,G){if(0>=L)throw Error("Illegal usage");clearTimeout(Da);var jb=function(){if(0==L)M&&M();else{if(L%2==(wa?0:1)){Ya.addClass(Ra);var La=g}else Ya.removeClass(Ra),Ya.addClass(G),
La=w;Da=setTimeout(jb,La);L--}};jb()}};Aa.SearchResultPanel=function(){var g=this,w,L,wa=[],M,Da,Ya=0,Ra,G,jb,La;this.block=function(y){y?(La&&La.remove(),La=Sb.block(w),La.children().css("background-color","rgba(0,0,0,0.001)")):(La&&La.remove(),La=null)};this.getJqUi=function(){w||Jb();return w};this.refresh=function(){var y=Da.find(".lists-dir-rptlist");y.remove();y.css("top","40px");M.text(Xa.get("searchInfoTotalRecords","\u5171\u627e\u5230 #1 \u4e2a\u7ed3\u679c\uff0c\u6309\u4e00\u7ea7\u76ee\u5f55\u540d\u79f0\u5206\u7ec4\u5c55\u793a").replace("#1",
Ya));if(wa||0!==wa.length)for(var ha=0;ha<wa.length;ha++){var t=wa[ha],T=$("<div>");T.addClass("lists-dir-rptlist");T.appendTo(Da);sb(t,T);var x=t;t=$("<div>");t.addClass("extreport-search-lists-dir-rptlist");t.css("height",90*x.length-3*(x.length-1));var r=x;x=new Oa;x.scrollSelectedToVisible();x.setBorderVisible(!1);x.setCustomItemPainter(jb?jb:P);x.addSelectedChangedListener(O);x.setUserObject(r);x.setItemModels(r);r=x.getJqUi();t.data("oList",x);r.appendTo(t);t.appendTo(T)}ha=$(document.createDocumentFragment());
T=jb?jb:P;for(t=0;t<wa.length;t++){x=wa[t];for(r=0;r<x.length;r++){var p=$("<div>");p.addClass("sa-ctrl-list-item");p.addClass("sa-ctrl-list-item_enabled");p.addClass("sa-ctrl-list-item-defaultlayout");p.css("left","0px");var v=x[r];p.data("model",v);T(p,v);ha.append(p)}y.append(ha)}0==wa.length&&(ha=y.append,T=$("<div>"),T.addClass("theme-search-no-result"),t=$("<div>"),Q.background(t,"no-data"),t.css("transform","scaleX(0.85) scaleY(0.85)"),xb.layoutCtrl(t,null,null,280,230),x=$("<div>"),x.text(Xa.get("nodata",
"\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")),xb.layoutCtrl(x,"19%","78%",null,null),t.appendTo(T),x.appendTo(T),xb.layoutCtrl(T,"14%","27%",280,270),ha.call(y,T))};var Jb=function(){w=$("<div>");w.addClass("search-result-lists");w.css({"float":"right",right:"0px",height:"97%",width:"324px",position:"absolute",top:"46px",background:"white","z-index":"99999",border:"1px solid #dbdbdb"});M||(M=$("<div>"),M.addClass("theme-search-total-records"),M.text(Xa.get("searchInfoTotalRecords",
"\u5171\u627e\u5230 #1 \u4e2a\u7ed3\u679c\uff0c\u6309\u4e00\u7ea7\u76ee\u5f55\u540d\u79f0\u5206\u7ec4\u5c55\u793a").replace("#1",Ya)),M.css({"margin-top":"16px","margin-left":"10px",height:"30px",width:"280px"}),w.append(M));var y=$("<div>");y.addClass("search-result-close");y.css({bottom:"20px",width:"100px",height:"28px",position:"absolute",left:"50%","margin-left":"-50px","font-size":"14px",color:"white","text-align":"center","line-height":"20px","border-radius":"2px","margin-bottom":"10px",cursor:"pointer"});
var ha=$("<div>");ha.text(Xa.get("closePanel","\u5173\u95ed"));ha.css("margin-top","3px");ha.appendTo(y);y.on("click",function(){G&&G()});w.append(y);Da=$("<div>");Da.addClass("extreport-category-lists-dir");Da.css({"float":"right",right:"0px",height:"calc(100% - 120px)",width:"324px",position:"absolute",top:"45px",background:"white","z-index":"99999","overflow-x":"hidden","overflow-y":"auto"});w.append(Da)},sb=function(y,ha){var t=$("<div>");t.addClass("extreport-search-lists-dir");t.addClass("extreport-search-lists-dir-head");
t.css("cursor","pointer");t.on("click",function(){var p=t.next();"block"==$(p).css("display")?(Q.background(r,"arrow-down"),$(p).hide()):(Q.background(r,"arrow-up"),$(p).show())});var T=$("<div>"),x=y[0].getGroupName();T.text(x.split(">")[0]);T.addClass("extreport-search-lists-dir-text");T.css("margin-right","74px");T.css("color","#666666");t.append(T);T=$("<div>");y=y.length;T.addClass("extreport-search-lists-dir-totalcount-text");T.text(Xa.get("searchInfoGroupCount","#1 \u4e2a\u7ed3\u679c").replace("#1",
y));T.css("color","#666666");t.append(T);var r=$("<div>");r.addClass("select-tree-menu-head-icon");r.css("position","absolute");Q.background(r,"arrow-up");t.append(r);t.appendTo(ha)},O=function(y,ha,t){t&&0<t.length&&(y=t[0],Ra&&Ra(y))},P=function(y,ha){y.addClass("search-result-item");y.css({width:"290px",height:"68px","border-bottom":"1px solid #E2E7EF",left:"6px",top:"6px"});var t=$("<div>");t.addClass("search-result-item-name");t.css({"font-size":"14px",color:"black",width:"160px",overflow:"hidden",
"white-space":"nowrap","text-overflow":"ellipsis","margin-left":"23px"});t.attr("title",ha.getName());var T=$("<div>");T.text(ha.getGroupName());T.addClass("search-result-item-group-name");T.css({width:"100px",position:"absolute",right:"0px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",top:"0px",padding:"0px, 10px, 0px, 10px"});T.attr("title",ha.getGroupName());var x=$("<div>"),r=ha.getDesc();r&&45<r.length&&(r=r.substring(0,45)+"...");x.addClass("search-result-item-desc");
x.css({width:"280px",position:"absolute","white-space":"normal",top:"22px",height:"40px","word-wrap":"break-word"});x.attr("title",ha.getDesc());y.append(t);y.append(T);y.append(x);L&&(g.doHighLightText(t,ha.getName(),L),g.doHighLightText(x,r,L));y.on("click",function(p){g.clearSelected()})};this.doHighLightText=function(y,ha,t){if(y&&ha&&t){t=t.toUpperCase();var T=ha.toUpperCase(),x=T.split(t),r=t.length,p;for(p in x){var v=T.indexOf(x[p]),ca=ha.substr(0,x[p].length);v+=x[p].length;var Ta=T.length-
v;T=T.substr(v,Ta);ha=ha.substr(v,Ta);v=$("<span>");v.text(ca);v.appendTo(y);p!=x.length-1&&1<x.length&&(v=T.indexOf(t),ca=ha.substr(v,r),v+=r,Ta=T.length-v,T=T.substr(v,Ta),ha=ha.substr(v,Ta),v=$("<span>"),v.text(ca),v.css("color","red"),v.clone().appendTo(y))}}};this.setFunCloseSearchResultPanel=function(y){G=y};this.setFunCustomPainter=function(y){jb=y};this.setSearchText=function(y){L=y};this.setFunItemSelectedListener=function(y){Ra=y};this.setArrSearchResultModel=function(y){wa=y};this.setTotalRecords=
function(y){Ya=y};this.clearSelected=function(){var y=$(".extreport-category-lists-dir").find(".extreport-search-lists-dir-rptlist");if(y&&0<y.length)for(var ha=0;ha<y.length;ha++)$(y[ha]).data("oList").setSelecteds([])}};Aa.DefaultSearchResultModel=function(){var g,w,L,wa,M,Da;this.setType=function(Ya){Da=Ya};this.getType=function(){return Da};this.setID=function(Ya){g=Ya};this.getID=function(){return g};this.setName=function(Ya){w=Ya};this.getName=function(){return w};this.setDesc=function(Ya){L=
Ya};this.getDesc=function(){return L};this.setGroupName=function(Ya){M=Ya};this.getGroupName=function(){return M};this.setGroupID=function(Ya){wa=Ya};this.getGroupID=function(){return wa}};Aa.CategoryUtil=fa;Aa.ExtReportDetailPanel=function(){var g=this,w,L,wa,M,Da,Ya,Ra,G,jb,La,Jb,sb,O,P,y,ha,t,T,x=!1;this.setExtReportModel=function(N){L=N};this.setIconFileName=function(N){wa=N};this.setGlobalDependence=function(N){M=N};this.isOpen=function(){return x};this.setIsOpen=function(N){x=N};this.setNullToJqUi=
function(){w&&w.remove();w=null};this.setFunAdjustContainerCallback=function(N){Da=N};this.setFunUpdateListViewCallback=function(N){Ra=N};this.setCollapseListener=function(N){Ya=N};this.getJqUi=function(){if(!w){w=$("<div>");w.addClass("extreport-detailpane");G=$("<div>");G.addClass("extreport-detail-panel");var N=$("<div>");N.addClass("extreport-detail-icontext");var X=$("<div>");X.addClass("extreport-detail-reporttext");X.text(L.getExtReportName());X.attr("title",L.getExtReportName());var aa=$("<div>");
aa.addClass("extreport-detail-reporticon");Q.background(aa,wa);aa.appendTo(N);X.appendTo(N);O=$("<div>");O.addClass("extreport-detail-jqdate");La=$("<div>");La.text(Xa.get("detailCreateTime","\u521b\u5efa\u65f6\u95f4\uff1a"));La.addClass("extreport-detail-item");Jb=$("<div>");Jb.text(Xa.get("detailCreatorName","\u521b\u5efa\u4eba\uff1a"));Jb.addClass("extreport-detail-item");jb=$("<div>");jb.text(Xa.get("detailLastModifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a"));jb.addClass("extreport-detail-item");
sb=$("<div>");sb.text(Xa.get("detailLastModifier","\u6700\u540e\u4fee\u6539\u4eba\uff1a"));sb.addClass("extreport-detail-item");O.append(La);O.append(Jb);O.append(jb);O.append(sb);O.appendTo(G);L.getExtRptType()==W.TYPE_EXTRPT&&(y=$("<div>"),y.addClass("extreport-detail-number"),ha=$("<div>"),ha.addClass("extreport-detail-Num"),ha.text(Xa.get("detailPublishNum","\u53d1\u5e03\u6b21\u6570\uff1a")),ha.appendTo(y),y.appendTo(G),P=$("<div>"),P.addClass("extreport-detail-jqDetails"),t=$("<div>"),v(t,null,
Xa.get("detailPubInfo","\u53d1\u5e03\u8be6\u60c5")),t.appendTo(P),P.appendTo(G));N.appendTo(w);G.appendTo(w);ya();tb(L.getExtReportID());document.body.addEventListener("mousedown",r,!0);document.body.addEventListener("mouseup",p,!0)}return w};var r=function(N){N=N.target;for(var X=$(document.body).find(".extreport-detailpane");N!=document.body;){if(X[0]&&N==X[0]||$(N).hasClass("extreport-info-icon")||$(N).hasClass("extreport-detail-splitPaneLine")||$(N).hasClass("extreport-card")||$(N).hasClass("list-cell-item"))return;
N=N.parentNode}g.closePanel();document.body.removeEventListener("mousedown",r,!0);document.body.removeEventListener("mouseup",p,!0)},p=function(N){N=N.target;if(!$(N).hasClass("extreport-info-icon")&&!$(N).hasClass("extreport-info-itemicon"))for(;N!=document.body;){if($(N).hasClass("extreport-card")||$(N).hasClass("list-cell-item")){g.closePanel();document.body.removeEventListener("mousedown",r,!0);document.body.removeEventListener("mouseup",p,!0);break}N=N.parentNode}},v=function(N,X,aa,ia){var Ua=
$("<div>");Ua.text("\u25b2");Ua.addClass("extreport-detail-arrowCollapsed");var qb=$("<div>");qb.addClass("extreport-detail-jqDiv");var gb=$("<div>"),Ga=0;gb.addClass("extreport-detail-Box");aa&&gb.text(aa);X&&(Ga=X.length);for(aa=0;aa<Ga;aa++)X[aa].appendTo(gb);0<Ga&&(N.on("click",function(Fa){Fa.stopPropagation();gb.children().toggle("fast");Ua.hasClass("extreport-detail-arrowCollapsed")?(Ua.removeClass("extreport-detail-arrowCollapsed"),Ua.addClass("extreport-detail-arrowExpanded")):(Ua.removeClass("extreport-detail-arrowExpanded"),
Ua.addClass("extreport-detail-arrowCollapsed"))}),gb.children().on("click",function(Fa){Fa.stopPropagation()}));gb.children().css("display","none");Ua.appendTo(qb);ia&&ia.appendTo(qb);gb.appendTo(qb);qb.appendTo(N)},ca={0:Xa.get("appMenu","\u5e94\u7528\u83dc\u5355"),1:Xa.get("qingAnalysisCenter","\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939")},Ta=function(N,X,aa,ia){if(N&&0!=N.length){var Ua=N[0],qb=N.length;ia=ia?aa+Ua:Xa.get("detailAuth","\u6388\u6743")+aa+Ua;1==qb?X.text(ia):X.text(ia+Xa.get("detailEtc",
"\u7b49")+qb+Xa.get("detailOne","\u4e2a")+aa.substring(0,aa.length-1));for(aa=1;aa<qb;aa++)Ua=Ua+"\u3001"+N[aa];X.attr("title",Ua)}else N=Xa.get("detailNotSelected","\u672a\u9009\u62e9")+aa.substring(0,aa.length-1),aa=ia?aa+N:Xa.get("detailAuth","\u6388\u6743")+aa+N,X.text(aa),X.attr("title",N)},tb=function(N){var X=M.createFacade(function(aa){var ia=new Z;ia.fromJsonObject(aa);aa=ia.getCreateDate();var Ua=ia.getModifyDate(),qb=ia.getCreator(),gb=ia.getLastModifier();aa&&La.text(Xa.get("detailCreateTime",
"\u521b\u5efa\u65f6\u95f4\uff1a")+aa.substring(0,19));Ua&&jb.text(Xa.get("detailLastModifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff1a")+Ua.substring(0,19));qb&&Jb.text(Xa.get("detailCreatorName","\u521b\u5efa\u4eba\uff1a")+qb);gb&&sb.text(Xa.get("detailLastModifier","\u6700\u540e\u4fee\u6539\u4eba\uff1a")+gb);ia=ia.getPubDetail();if(L.getExtRptType()==W.TYPE_EXTRPT)if(aa=ia.length,ha.text(Xa.get("detailPublishNum","\u53d1\u5e03\u6b21\u6570\uff1a")+aa),aa=ia.length,t.empty(),0<aa){Ua=[];qb=[];
T=[];for(gb=0;gb<aa;gb++){var Ga=ia[gb];qb[gb]=$("<div>");qb[gb].addClass("extreport-detail-pBox");var Fa=$("<span class='extreport-detail-schemaIcon'>");Ua[gb]=$("<div>");L.getExtRptType()==W.TYPE_EXTRPT&&Q.background(Fa,"btn-extreport");Ua[gb].addClass("extreport-detail-pBox");var vb=$("<li>");vb.addClass("extreport-detail-grandSon");var db=$("<li>");db.addClass("extreport-detail-grandSon");var ab=$("<li>");ab.addClass("extreport-detail-grandSon");var yb=$("<li>");yb.addClass("extreport-detail-grandSon");
var wb=$("<li>");wb.addClass("extreport-detail-grandSon");var lb=ca[Ga.getPublishTargetType()];vb.text(Xa.get("detailPubTo","\u53d1\u5e03\u5230\uff1a")+lb);vb.attr("title",lb);lb=Ga.getPathText();Ga.setPathText(lb);db.text(Xa.get("detailPubPath","\u53d1\u5e03\u8def\u5f84\uff1a")+Ga.getPathText().trim());db.attr("title",Ga.getPathText());lb=Ga.getRoles();var Db=Ga.getUsers(),V=Ga.getPermLabels();Ta(lb,ab,Xa.get("detailRole","\u89d2\u8272\uff1a"),!1);Ta(Db,yb,Xa.get("detailUser","\u7528\u6237\uff1a"),
!1);Ta(V,wb,Xa.get("detailPermLabel","\u6743\u9650\u6807\u7b7e\uff1a"),!0);Ua[gb].append(vb);Ua[gb].append(db);Ua[gb].append(ab);Ua[gb].append(yb);Ua[gb].append(wb);T[gb]=$("<div>");T[gb].addClass("extreport-detail-refDetail");T[gb].attr("title",Ga.getName());v(T[gb],[Ua[gb]],Ga.getName(),Fa)}v(t,T,Xa.get("detailPubInfo","\u53d1\u5e03\u8be6\u60c5"))}else ia=$("<div>"),ia.addClass("extreport-detail-notHaveContent"),L.getExtRptType()==W.TYPE_EXTRPT&&ia.text(Xa.get("detailRptNoPub","\u5f53\u524d\u62a5\u8868\u6682\u672a\u53d1\u5e03")),
v(t,[ia],Xa.get("detailPubInfo","\u53d1\u5e03\u8be6\u60c5"))},function(aa){if(1010004==aa){g.closePanel();aa=Pa.createFeedbackDialog();aa.setOptionType(Pa.OPTION_OK);aa.setMsgImageType(Pa.MSG_DELETE);if(L.getExtRptType()==W.TYPE_EXTRPT){var ia=Xa.get("detailNotExist","\u5bf9\u5e94#1\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");aa.setMessage(ia.replace("#1",Xa.get("detailRpt","\u62a5\u8868")))}aa.setClosingChecker(function(Ua){return!0});aa.showDialog();return!0}return!1});X.setShowBlocking(!0);
X.setBlockingJqUi(w);X.loadExtReportDetail(N,L.getExtRptType(),M.getCurrentSpaceID())};this.closePanel=function(){x&&(w&&w.remove(),x=!1,w=null,Ya&&Ya(),Da&&Da(this),Ra&&Ra())};var ya=function(){var N=$("<div>");N.addClass("extreport-detail-closeTab");var X=$("<div>");X.text(Xa.get("detailClose","\u5173\u95ed"));X.css("margin-top","4px");X.appendTo(N);N.on("click",function(){g.closePanel()});N.appendTo(w)}};Aa.ExtReportListPagination=function(){da.call(this);var g=this.protectedMethod;g.setTotalSelectedRowAndSelectedAllVisual(!1,
!1);g.setTotalRowVisual(!1)};var Oa,Pa,xb,Xa,Sb,Q,W,Z,da;(function(){var g=com.kingdee.bos.qing.ui.component;Oa=g.List;Pa=g.MessageDialog;g=com.kingdee.bos.qing.common;xb=g.DomUtil;g=com.kingdee.bos.qing.framework.common;Xa=g.MultilanguageManager.createPackageAccessor(Aa);Sb=g.AbstractFacade;g=com.kingdee.bos.qing.biz.common;da=g.ComplexPaginationBar;g=com.kingdee.bos.extreport.manage.common;Q=g.Icons;g=com.kingdee.bos.extreport.manage.model;W=g.ExtReportModel;Z=g.ExtReportDetailModel})();pa.isValidString=
function(g){return/^([\u4E00-\u9FA5a-zA-Z_])[\u4E00-\u9FA5a-zA-Z0-9_]{0,}$/.test(g)};pa.isKeywords=function(g){return/\b(null|true|false)\b/i.test(g)};pa.cutExceedCharacters=function(g,w){var L=0,wa=0;if(g.replace(/[^\x00-\xff]/g,"**").length>w)for(var M=0;M<g.length;M++)if(L<w)if(/^[\u0000-\u00ff]$/.test(g.charAt(M)))if(L+1.2<w)L+=1.2,wa++;else break;else if(L+1.8<w)L+=1.8,wa++;else break;return 0==wa?g:g.substring(0,wa)+"..."};pa.calcOptimumWidth=function(g,w,L){g=$(jqUi);var wa=g.textContent||
g.innerText,M=document.createElement("canvas").getContext("2d");M.font=window.getComputedStyle(g,null).getPropertyValue("font");g=M.measureText(wa).width;g>L?g=L:g<w&&(g=w);return g};fa.buildCategoryFullPath=function(g,w,L){if(!g.getParent())return g.getUserObject().getExtReportGroupName()+w;var wa=g.getParent();return wa?(w=g.getUserObject().getExtReportGroupName()+w,fa.buildCategoryFullPath(wa,L+w,L)):w};fa.findTreeNodeByFullPath=function(g,w){if(0===w.length)return g;for(var L=w.shift(),wa=0;wa<
g.getChildren().length;wa++){var M=g.getChildren()[wa];if(M.getName()===L)return fa.findTreeNodeByFullPath(M,w)}};fa.calcNodeChildrenSize=function(g){if(!Array.isArray(g.getChildren()))return 0;for(var w=0,L=0;L<g.getChildren().length;L++){var wa=g.getChildren()[L];0<wa.getChildren().length?(w++,w+=fa.calcNodeChildrenSize(wa)):w++}return w}})();(function(){function pa(){function P(V){KTDefaultTreeHandlerRender.call(this,V);var b=this;this.create=function(na,va,Ia,z,kb,bb,Ab){var Kb=20*na.getLevel()+15;var Pb=Kb+17;var ec=null;if(b.protectedMethod.isTreeNodeHasChildren(na,va,Ia)||na.isHaveHandlerAlways())ec=b.protectedMethod.createAbsoluteHtmlElement("div",Kb,kb,17,Ab),ec.style.cursor="pointer",va=$(ec),va.addClass("tree-handler-icon"),Ia=$("<div>"),Ia.addClass("tree-handler-triangle-icon"),va.append(Ia),na.isExpanded()?(Ia.css("top","8px"),
Ia.addClass("lower-triangle"),va.css("left",20*na.getLevel()+22+"px"),Ia.removeClass("right-triangle")):(Ia.css("top","5px"),Ia.addClass("right-triangle"),va.css("left",20*na.getLevel()+15+"px"),Ia.removeClass("lower-triangle"));va=[ec,Pb,kb,null];na=va[0];Pb=va[1];ec=va[2];va=va[3];z=b.protectedMethod.createAbsoluteHtmlElement("span",Pb,ec,z+bb-Pb,kb+Ab-ec);return[na,z,va]}}function y(V){KTDefaultCellRender.call(this,V);var b=this;this.paintCellUI=function(na,va){var Ia=b.getCell().getValue(),z=
Ia.getId(),kb=Ia.getName(),bb=$("<div>");bb.addClass("extreport-export-area-list-item");bb.attr("table-name",z);bb.attr("title",kb);var Ab=new w,Kb=Ab.getJqUi();Kb.attr("table-name-checkbox",z);Kb.addClass("extreport-export-area-list-item-checkbox");Kb.data("object",Ia);Kb.data("model",Ab);Ab.setChecked(Ia.isChecked());Ab.addCheckedListener(yb);z=$("<div>");z.addClass("extreport-export-area-list-item-text");bb.append(Kb);bb.append(z);if("0"==Ia.getSubNodeLevel())z.text(kb);else if(Ia instanceof Xa)z.text(kb);
else{z.css("left","66px");kb=Ia.getName();if(ya&&kb){Kb=ya.toUpperCase();Ab=kb.toUpperCase();var Pb=Ab.split(Kb),ec=Kb.length;for(Qb in Pb){var Rb=Ab.indexOf(Pb[Qb]),qc=kb.substr(fc,Pb[Qb].length);Rb+=Pb[Qb].length;var nc=Ab.length-Rb;Ab=Ab.substr(Rb,nc);kb=kb.substr(Rb,nc);Rb=$("<span>");Rb.text(qc);Rb.appendTo(z);if(Qb!=Pb.length-1&&1<Pb.length){var fc=Ab.indexOf(Kb);qc=kb.substr(fc,ec);Rb=fc+ec;nc=Ab.length-Rb;Ab=Ab.substr(Rb,nc);kb=kb.substr(Rb,nc);Rb=$("<span>");Rb.text(qc);Rb.css("color","red");
Rb.clone().appendTo(z)}}}else z.text(kb);z.addClass("extreport-export-theme-name-label");var Qb=$("<span>");Ra.layoutCtrl(Qb,45,3,16,16);fc="btn-dataset";Ia.getExtRptType()==Jb.TYPE_EXTRPT&&(fc="btn-extreport");da.background(Qb,fc);bb.append(Qb)}va?(na=$(va),na.css("overflow","visible"),bb.appendTo(na)):(na=$(na),bb.appendTo(na));com.kingdee.bos.qing.common.DomUtil.layoutCtrlWithLRTB(bb,0,0,null,0,0,null)}}var ha=this,t,T={},x=[],r=[],p=[],v,ca,Ta=!1,tb,ya,N,X,aa,ia,Ua;this.setShowOnlyChecked=function(V){Ta=
V};this.setShowAllChecked=function(V){tb=V;V=V.isChecked();if(0<p.length)for(var b=0;b<p.length;b++)p[b].isPreset()||p[b].check(V,wb,[],lb);ab()};this.createJqUi=function(V){p=V.getChildren();v=[];Ga(v,V);for(V=0;V<x.length;V++){var b=x[V];if(b.getExtRptType()===Jb.TYPE_EXTRPT){var na=b,va=na.getRelativeData();if(va&&0!=va.length&&va&&0<va.length){for(var Ia=[],z=Fa(x,r),kb=0;kb<va.length;kb++)for(var bb=va[kb],Ab=0;Ab<z.length;Ab++){var Kb=z[Ab];bb===Kb.getId()&&(Ia.push(Kb),Kb.getRelativeDataByExt().push(na))}na.setRelativeData(Ia)}na=
b;if((va=na.getRelativeExt())&&0!=va.length&&va&&0<va.length){Ia=[];z=Fa(x,r);for(kb=0;kb<va.length;kb++)for(bb=va[kb],Ab=0;Ab<z.length;Ab++)Kb=z[Ab],bb===Kb.getId()&&(Ia.push(Kb),Kb.getRelativeExtByExt().push(na));na.setRelativeExt(Ia)}}if(b.getExtRptType()===Jb.TYPE_DATASET&&(na=b.getRelativeDataSet())&&0!=na.length&&na&&0<na.length){va=[];Ia=Fa(x,r);for(z=0;z<na.length;z++)for(kb=na[z],bb=0;bb<Ia.length;bb++)Ab=Ia[bb],kb===Ab.getId()&&(va.push(Ab),Ab.getRelativeByDataSet().push(b));b.setRelativeDataSet(va)}}t=
$("<div>");t.addClass("extreport-export-area");t.addClass("extreport-export-tree-selection-area");N=$("<div>");N.addClass("extreport-export-tree-selection-area-checked-prompt");N.css("color","#666");Ra.layoutCtrlWithLRTB(N,100,null,200,0,null,23);N.prependTo(t);Ua=vb();t.append(Ua);db(v,ia);ia.updateUI();qb();return t};this.searchKey=function(V){var b;ya=V;for(b=0;b<x.length;b++){var na=x[b];var va=na.isChecked();if(V){var Ia=-1<na.getName().toUpperCase().indexOf(ya.toUpperCase());va=Ta?Ia&&va:Ia}else va=
Ta?na.isChecked():!0;na.setVisible(va)}for(V=0;V<p.length;V++)b=p[V],na=b.getChildren(),gb(na,b);Db();ha.updateUi()};this.updateUi=function(){for(var V=!1,b=0;b<x.length;b++)V=V||x[b].isVisible();V?(X&&X.hide(),Ua&&Ua.remove(),Ua=vb(),t.append(Ua),db(v,ia),ia.updateUI()):(X||(X=$("<div>"),X.css({position:"absolute",top:"26px",left:"0",right:"0",bottom:"0","z-index":"2",color:"rgb(102, 102, 102)"}),aa=$("<div>"),aa.text(G.get("noDataPrompt","\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c")),
Ra.layoutCtrlCenterAlign(aa,500),aa.css({height:"20px","line-height":"20px","text-align":"center","font-size":"16px",color:"#BBBBBB",top:"50%","margin-top":"98.5px"}),aa.appendTo(X),V=$("<div>"),da.background(V,"no-data"),Ra.layoutCtrlCenterAlign(V,187),V.css({"background-size":"contain",top:"50%",height:"187px","margin-top":"-113.5px"}),V.appendTo(X),t.append(X)),X.show(),Ua.hide())};var qb=function(){for(var V=0,b=0;b<x.length;b++)x[b].isChecked()&&V++;V=G.get("checkedNumberPrompt","(\u5df2\u9009\u62e9 #1 \u9879)").replace("#1",
V);N.text(V)},gb=function(V,b){for(var na=!0,va=!1,Ia=0;Ia<V.length;Ia++){var z=V[Ia];if(z instanceof Xa){var kb=z.getChildren();kb=gb(kb,z);z.isVisible()&&(na=na&&kb[1]);va=va||kb[0]}else z.isVisible()&&(na=na&&z.isChecked()),va=va||z.isVisible()}na=na&&va;b.setVisible(va);b.setChecked(na);return[va,na]};this.getSelectedExtReport=function(){return T};this.getSelectedExtReportNode=function(){for(var V=[],b=0;b<x.length;b++){var na=x[b];na.isChecked()&&V.push(na.toJsonObject())}return V};var Ga=function(V,
b){var na=function(z){V.push(z);if(z instanceof Q||z instanceof W)x.push(z);else if((z=z.getChildren())&&0<z.length)for(var kb=0;kb<z.length;kb++)na(z[kb])},va=function(z){if(z instanceof Q||z instanceof W)r.push(z);else if((z=z.getChildren())&&0<z.length)for(var kb=0;kb<z.length;kb++)va(z[kb])};if((b=b.getChildren())&&0<b.length)for(var Ia=0;Ia<b.length;Ia++)b[Ia].isPreset()?va(b[Ia]):na(b[Ia])},Fa=function(V,b){return b&&0<b.length?V.concat(b):V},vb=function(){ia=new KTable;var V=$(ia.getUI());
V.children().css("overflow-x","hidden");ia.setCellRender(new y(ia));ia.setTreeHandlerRender(new P(ia));ia.setSyncUIWhenModelChanged(!1);ia.addColumn().setWidth(400);Ra.layoutCtrlWithLRTB(V,0,0,null,23,0,null);return V},db=function(V,b){for(var na=0;na<V.length;na++){var va=V[na];if(va.isVisible()){var Ia=b.addRow();Ia.setHeight(23);var z=Ia.getCell(0);z.setValue(va);va=va.getSubNodeLevel();va=new KTCellTreeModel(va);va.setExpanded(!0);0<va.getLevel()&&Ia.setHide(!1);z.setTreeModel(va)}}},ab=function(){for(var V=
0;V<v.length;V++){var b=v[V];if(b.isVisible()){var na=b.getId();(na=t.find("[table-name-checkbox='"+na+"']").data("model"))&&na.setChecked(b.isChecked())}}qb()},yb=function(V,b){b&&(ca=[],V.getJqUi().data("object").check(V.isChecked(),wb,ca,lb),ab())},wb=function(V){for(var b=!0,na=V.getChildren(),va=0;va<na.length;va++){var Ia=na[va];Ia.isVisible()&&(b=b&&Ia.isChecked())}V.setChecked(b);lb(V.getParentNode());Db()},lb=function(V){var b=!0;if(V&&0<V.getChildren().length){for(var na=V.getChildren(),
va=0;va<na.length;va++){var Ia=na[va];Ia.isVisible()&&(b=b&&Ia.isChecked())}V.setChecked(b)}Db()},Db=function(){for(var V=!0,b=!1,na=0;na<p.length;na++){var va=p[na];!va.isPreset()&&va.isVisible()&&(V=V&&va.isChecked(),b=!0)}b?tb.setChecked(V):(V=tb.isChecked(),tb.setChecked(V))}}function fa(){function P(r){KTDefaultCellRender.call(this,r);var p=this,v=this.paintCellUI;this.paintCellUI=function(ya,N){p.getCurrentRowIdx()<jb.getHeadRowCount()?v(ya,N):($(ya),3==p.getCurrentColIdx()?tb(ya,p.getCellWidth(),
p.getCellHeight(),p.getCurrentRow()):4==p.getCurrentColIdx()?ca(ya,p.getCellWidth(),p.getCellHeight(),p.getCurrentRow()):v(ya,N))};var ca=function(ya,N,X,aa){"0"===aa.getUserObject().extRptType&&(ya=jb.createCtrlInCell(ya,N,X,g),aa.getCell(4).setUserObject(ya),N=aa.getUserObject().strategy==fa.ALL_CONFLICTTYPE[1]?!0:!1,ya.setEnabled(N),ya.setSelected(aa.getUserObject().publishStrategy),ya.setItemModels(fa.ALL_PUBLISHCONFLICTTYPE),ya.setUserObject(aa),ya.setCustomPainter(function(ia,Ua,qb){switch(qb){case fa.ALL_PUBLISHCONFLICTTYPE[0]:ia=
G.get("noDisposal","\u4e0d\u5904\u7406");break;case fa.ALL_PUBLISHCONFLICTTYPE[1]:ia=G.get("overwrite","\u8986\u76d6");break;default:ia=""}qb=$("<div>");qb.text(ia);qb.appendTo(Ua)}),ya.addSelectedChangedListener(Ta))},Ta=function(ya,N,X){ya.getUserObject().getUserObject().publishStrategy=X},tb=function(ya,N,X,aa){ya=jb.createCtrlInCell(ya,N,X,g);ya.setSelected(aa.getUserObject().strategy);ya.setItemModels(ha?fa.ALL_CONFLICTTYPE:[fa.ALL_CONFLICTTYPE[0],fa.ALL_CONFLICTTYPE[2]]);ya.setUserObject(aa);
ya.setCustomPainter(function(ia,Ua,qb){switch(qb){case fa.ALL_CONFLICTTYPE[0]:ia=G.get("ignore","\u5ffd\u7565");break;case fa.ALL_CONFLICTTYPE[1]:ia=G.get("overwrite","\u8986\u76d6");break;case fa.ALL_CONFLICTTYPE[2]:ia=G.get("rename","\u91cd\u547d\u540d");break;default:ia=""}qb=$("<div>");qb.text(ia);qb.appendTo(Ua)});ya.addSelectedChangedListener(function(ia,Ua,qb){if(qb==fa.ALL_CONFLICTTYPE[1]){var gb=ia.getUserObject().getUserObject();if(2==gb.lockStatus){ia.setSelected(Ua);ia="0"===aa.getUserObject().extRptType?
G.get("report","\u62a5\u8868"):G.get("dataSet","\u6570\u636e\u96c6");ia=G.get("canNotOverwriteOne","\u201c#1\u201d#2\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u4e0d\u80fd\u8986\u76d6\u3002").replace("#1",gb.extreportName).replace("#2",ia);x.showPrompt(ia);return}}"0"===aa.getUserObject().extRptType&&(gb=aa.getCell(4),Ua=qb==fa.ALL_CONFLICTTYPE[1]?!0:!1,gb.getUserObject().setEnabled(Ua),gb.getUserObject().setSelected(fa.ALL_PUBLISHCONFLICTTYPE[0]));ia.getUserObject().getUserObject().strategy=
qb})}}var y=this,ha=!1,t,T,x;this.setShowOverwriteBtn=function(r){ha=r};this.setMessageCurtain=function(r){x=r};this.getConflictExtReportList=function(){return T};this.getJqUi=function(r){t=jb.createTable();jb.bindTableListenerForCtrl(t);var p=new P(t);p.setOutsideVisible(!1);t.setCellRender(p);t.addColumns(5);t.getColumn(0).setWidth(120);t.getColumn(1).setWidth(80);t.getColumn(2).setWidth(180);t.getColumn(3).setWidth(80);t.getColumn(4).setWidth(80);p=jb.createHeadRow(t);p.getCell(0).setValue(G.get("groupName",
"\u76ee\u5f55\u540d\u79f0"));p.getCell(1).setValue(G.get("type","\u7c7b\u578b"));p.getCell(2).setValue(G.get("nameField","\u540d\u79f0"));p.getCell(3).setValue(G.get("strategy","\u5904\u7406\u7b56\u7565"));p.getCell(4).setValue(G.get("publishStrategy","\u53d1\u5e03\u4fe1\u606f\u5904\u7406"));y.updateUi(r,!0);jb.refresh(t);return $(t.getUI())};this.updateUi=function(r,p){if(p){T=r;for(var v in r)T[v].strategy=fa.ALL_CONFLICTTYPE[0],"0"===r[v].extRptType&&(T[v].publishStrategy=fa.ALL_PUBLISHCONFLICTTYPE[0])}jb.clearWithoutHead(t);
jb.refresh(t);for(v=0;v<r.length;v++){var ca=r[v];p=jb.createRow(t);p.setUserObject(ca);p.getCell(0).setValue(ca.extreportGroupName);0==ca.extRptType?p.getCell(1).setValue(G.get("report","\u62a5\u8868")):1==ca.extRptType&&p.getCell(1).setValue(G.get("dataSet","\u6570\u636e\u96c6"));p.getCell(2).setValue(ca.extreportName);p.getCell(3).setValue(ca.strategy);"0"===ca.extRptType&&p.getCell(4).setValue(ca.publishStrategy)}jb.refresh(t)};this.refresh=function(){jb.refresh(t)}}function Aa(){wa.call(this);
var P=this,y=this.protectedMethod,ha=[],t,T,x,r,p,v,ca,Ta;this.setCurrentExtReportGroupFullPath=function(Ga){p=Ga};this.setGlobal=function(Ga){t=Ga};this.setFunRefreshExtReportGroupList=function(Ga){x=Ga};this.addConfirmListener=function(Ga){ha.push(Ga)};this.createUi=function(Ga,Fa,vb){P.setSize(640,480);P.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);y.setTitle(G.get("importExtReportOrDataSet","\u5bfc\u5165\u8f7b\u62a5\u8868/\u6570\u636e\u96c6"));y.setContentPaneCreator(function(){var db=
$("<div>");db.append(tb());db.append(N());T=new pa;var ab=T.createJqUi(vb),yb=X();T.setShowAllChecked(Ta);var wb=G.get("sourceStrategy","\u8d44\u6e90\u51b2\u7a81\u5904\u7406\u7b56\u7565\uff08\u5730\u56fe\u3001\u56fe\u7247\uff09"),lb=(new M(wb)).getJqUi();lb.attr("title",wb);com.kingdee.bos.qing.common.DomUtil.layoutCtrl(lb,0,335,180,23);r=new g;r.setSelected(fa.ALL_CONFLICTTYPE[1]);r.setItemModels(fa.ALL_CONFLICTTYPE);r.setCustomPainter(function(Db,V,b){switch(b){case fa.ALL_CONFLICTTYPE[0]:Db=G.get("ignore",
"\u5ffd\u7565");break;case fa.ALL_CONFLICTTYPE[1]:Db=G.get("overwrite","\u8986\u76d6");break;case fa.ALL_CONFLICTTYPE[2]:Db=G.get("rename","\u91cd\u547d\u540d");break;default:Db=""}b=$("<div>");b.text(Db);b.appendTo(V)});wb=r.getJqUi();com.kingdee.bos.qing.common.DomUtil.layoutCtrl(wb,190,335,90,23);db.append(ab);db.append(yb);db.append(lb);db.append(wb);return db});y.setClosingChecker(P.isValidToAccepted,!0);y.setClosingAction(function(db){db&&(db=T.getSelectedExtReportNode(),0!=db.length&&Ua(Ga,
Fa,db))});P.showDialog()};var tb=function(){v=new Ya;v.addSearchListener(ya);v.setSearchListenerDelay(400);v.setPlaceholder(G.get("searchBoxPlaceholder","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));v.setShowSearchIcon(!0);var Ga=v.getJqUi();Ga.addClass("extreport-export-search-box");return Ga},ya=function(Ga){ca=v.getText().trim();T.searchKey(ca)},N=function(){var Ga=new w;Ga.setChecked(!1);Ga.addCheckedListener(aa);Ga.setText(G.get("showOnlyChecked","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));Ga=
Ga.getJqUi();Ga.addClass("extreport-export-show-only-checked-box");Ra.layoutCtrl(Ga,250,2,200,23);return Ga},X=function(){Ta=new w;Ta.setChecked(!1);Ta.addCheckedListener(ia);Ta.setText(G.get("showAllChecked","\u5168\u9009"));var Ga=Ta.getJqUi();Ga.addClass("extreport-export-show-all-checked-box");Ra.layoutCtrl(Ga,15,30,200,23);return Ga},aa=function(Ga,Fa){Fa&&(T.setShowOnlyChecked(Ga.isChecked()),T.searchKey(ca))},ia=function(Ga,Fa){Fa&&(T.setShowAllChecked(Ga),T.searchKey(ca))};this.isValidToAccepted=
function(Ga){0!=T.getSelectedExtReportNode().length?Ga(!0):(y.getMessageCurtain().showPrompt(G.get("selectNone","\u672a\u9009\u4e2d\u8f7b\u62a5\u8868/\u6570\u636e\u96c6\u3002")),Ga(!1))};var Ua=function(Ga,Fa,vb){t.createFacade(function(db){var ab=db.conflictExtreportList;db=db.conflictPublishList;if(ab&&0<ab.length){$("<div>");db=null;for(var yb=0;yb<vb.length;yb++){var wb=vb[yb].extreportName,lb=vb[yb].extreportGroupName;if(null==db)for(var Db=0;Db<ab.length;Db++)ab[Db].extreportName!=wb&&(db=lb)}yb=
vb.length-ab.length;wb=new Oa;wb.setSourceStrategy(r.getSelected());wb.setGlobal(t);wb.setCurrentExtReportGroupFullPath(p);wb.setFunRefreshExtReportGroupList(x);wb.createUi(Ga,Fa,ab,yb,db);wb.repaint()}else qb(vb,db)},function(db,ab){return 1020101==db||1100021==db?!0:!1}).importSelectedExtReport(p,Ga,Fa,vb,r.getSelected(),!0,t.getCurrentSpaceID(),t.getCurrentSpaceType())},qb=function(Ga,Fa){if(Fa&&0!=Fa.length){var vb=new Pa;vb.setClosedListener(function(){gb(Ga)});vb.showDialog(Fa)}else gb(Ga)},
gb=function(Ga){var Fa;for(Fa in Ga)var vb=Ga[Fa].extreportGroupName;x&&x(vb,null,t.getCurrentSpaceID())}}function Oa(){wa.call(this);var P=this,y=this.protectedMethod,ha=[],t,T,x,r,p,v=[],ca,Ta,tb,ya,N,X,aa,ia,Ua=!1;this.setCurrentExtReportGroupFullPath=function(ab){tb=ab};this.setSourceStrategy=function(ab){ia=ab};this.setGlobal=function(ab){t=ab};this.setFunRefreshExtReportGroupList=function(ab){aa=ab};this.addConfirmListener=function(ab){ha.push(ab)};this.createUi=function(ab,yb,wb,lb,Db){ca=
ab;Ta=yb;ya=wb;N=Db;P.setSize(640,480);P.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);y.setTitle(G.get("importExtReportOrDataSet","\u5bfc\u5165\u62a5\u8868/\u6570\u636e\u96c6"));y.setContentPaneCreator(function(){for(var V=!1,b=0;b<wb.length;b++)if(2!=wb[b].lockStatus){V=!0;break}b=$("<div>");var na=qb(lb,!V);T=new M(na);var va=T.getJqUi();va.attr("title",na);va.addClass("extreport-import-selection-prompt");b.append(va);va=0;na=30;x=new Da(G.get("allIgnore","\u5168\u90e8\u5ffd\u7565"));
x.addActionListener(gb);var Ia=x.getJqUi();Ia.addClass("extreport-import-selection-btn");b.append(Ia);Ra.layoutCtrl(Ia,va,na,80,23);va+=100;V&&(r=new Da(G.get("allOverwrite","\u5168\u90e8\u8986\u76d6")),r.addActionListener(Ga),Ia=r.getJqUi(),Ia.addClass("extreport-import-selection-btn"),b.append(Ia),Ra.layoutCtrl(Ia,va,na,80,23),va+=100);p=new Da(G.get("allRename","\u5168\u90e8\u91cd\u547d\u540d"));p.addActionListener(Fa);Ia=p.getJqUi();Ia.addClass("extreport-import-selection-btn");Ra.layoutCtrl(Ia,
va,na,80,23);b.append(Ia);na+=28;X=new fa;X.setShowOverwriteBtn(V);X.setMessageCurtain(y.getMessageCurtain());V=X.getJqUi(wb);Ra.layoutCtrlWithLRTB(V,0,0,null,na,0,null);b.append(V);return b});y.setClosingChecker2(P.isValidToAccepted,function(V){V(!0);Ua&&db(N)},!0);y.setClosingAction(function(V){});P.showDialog()};this.repaint=function(){X.refresh()};var qb=function(ab,yb){return(yb?G.get("importSuccessWithLocked","\u6210\u529f\u5bfc\u5165#1\u4e2a\u62a5\u8868/\u6570\u636e\u96c6\u3002\u4ee5\u4e0b\u62a5\u8868/\u6570\u636e\u96c6\u4e0e\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\u7684\u62a5\u8868/\u6570\u636e\u96c6\u540d\u79f0\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002"):
G.get("importSuccessPrompt","\u6210\u529f\u5bfc\u5165#1\u4e2a\u62a5\u8868/\u6570\u636e\u96c6\u3002\u4ee5\u4e0b\u62a5\u8868/\u6570\u636e\u96c6\u540d\u79f0\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002")).replace("#1",ab)},gb=function(){for(var ab in ya)ya[ab].strategy=fa.ALL_CONFLICTTYPE[0],"0"===ya[ab].extRptType&&(ya[ab].publishStrategy=fa.ALL_PUBLISHCONFLICTTYPE[0]);X.updateUi(ya)},Ga=function(){var ab=[],yb;for(yb in ya)2==ya[yb].lockStatus?ab.push(yb):ya[yb].strategy=fa.ALL_CONFLICTTYPE[1];X.updateUi(ya);
0<ab.length&&(ab=G.get("canNotOverwrite","\u201c#1\u201d\u7b49#2\u4e2a\u62a5\u8868/\u6570\u636e\u96c6\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u4e0d\u80fd\u8986\u76d6\u3002").replace("#1",ya[ab[0]].extreportName).replace("#2",ab.length),y.getMessageCurtain().showPrompt(ab))},Fa=function(){for(var ab in ya)ya[ab].strategy=fa.ALL_CONFLICTTYPE[2],"0"===ya[ab].extRptType&&(ya[ab].publishStrategy=fa.ALL_PUBLISHCONFLICTTYPE[0]);X.updateUi(ya)};this.isValidToAccepted=function(ab){vb(ca,
Ta,ya,ab)};var vb=function(ab,yb,wb,lb){var Db=[],V;for(V in wb)"ignore"!=wb[V].strategy&&(Db=Db.concat(wb[V]));0==Db.length?(lb(!0),db(N)):t.createFacade(function(b){N=Db[0].extreportGroupName;var na=b.conflictPublishList;na&&0<na.length&&(v=v.concat(na));(b=b.conflictExtreportList)&&0<b.length?(lb(!1),ya=b,Ua=!0,na=qb(Db.length-b.length,!0),T.setText(na),T.getJqUi().attr("title",na),r&&(r.getJqUi().remove(),p.getJqUi().css("left","100px")),X.setShowOverwriteBtn(!1),X.updateUi(b,!0)):(lb(!0),db(N))},
function(b,na){return 1020101==b||1100021==b?!0:!1}).importSelectedExtReport(tb,ab,yb,Db,ia,!1,t.getCurrentSpaceID(),t.getCurrentSpaceType())},db=function(ab){if(0==v.length)Ua=!1,aa&&aa(ab,null,t.getCurrentSpaceID());else{var yb=new Pa;yb.setClosedListener(function(){Ua=!1;aa&&aa(ab,null,t.getCurrentSpaceID())});yb.showDialog(v)}}}function Pa(){var P,y;this.setClosedListener=function(t){y=t};this.showDialog=function(t){var T=$(document.body),x=$("<div class='sa-ctrl-common-modallayer'>");x.appendTo(T);
var r=new L(x);r.setTitle(G.get("importExtReportOrDataSet","\u5bfc\u5165\u62a5\u8868/\u6570\u636e\u96c6"));var p=T.prop("clientWidth");T=T.prop("clientHeight");r.setBounds(p-640>>1,T-480>>1,640,480);r.setSelectable(!0);r.setToolbarVisible(!1);r.setContent(ha(t));r.showFooterPane();r.addClosingListener(function(v,ca){y&&y();x&&x.remove();v&&v.destroy()},!0);r.addClosedListener(function(v){});r.show();jb.refresh(P)};var ha=function(t){var T=$("<div>"),x=$("<div>");x.addClass("theme-publish-conflict-tips");
x.text(G.get("publishConflictTips","\u4ee5\u4e0b\u8bb0\u5f55\u56e0\u540d\u79f0\u91cd\u590d\u672a\u53d1\u5e03\u6210\u529f\uff0c\u53ef\u5230\u5bf9\u5e94\u7684\u8f7b\u62a5\u8868\u4e2d\u624b\u52a8\u53d1\u5e03"));x.appendTo(T);P=jb.createTable();jb.bindTableListenerForCtrl(P);P.addColumns(3);P.getColumn(0).setWidth(100);P.getColumn(1).setWidth(220);P.getColumn(2).setWidth(220);x=jb.createHeadRow(P);x.getCell(0).setValue(G.get("publishName","\u53d1\u5e03\u540d\u79f0"));x.getCell(1).setValue(G.get("publishType",
"\u6765\u6e90"));x.getCell(2).setValue(G.get("publishPath","\u53d1\u5e03\u8def\u5f84"));x=$(P.getUI());x.addClass("extreport-publish-conflict-table");x.appendTo(T);jb.clearWithoutHead(P);for(x=0;x<t.length;x++){var r=t[x],p=jb.createRow(P);p.setUserObject(r);p.getCell(0).setValue(r.extreportName);p.getCell(1).setValue(r.extreportGroupName+"/\u8f7b\u62a5\u8868 : "+r.extrptName);p.getCell(2).setValue(r.publishPath)}jb.refresh(P);return T}}function xb(){var P=this,y,ha,t,T=!1,x=!0,r=!1;this.setName=
function(p){y=p};this.getName=function(){return y};this.setId=function(p){ha=p};this.getId=function(){return ha};this.setParentNode=function(p){t=p};this.getParentNode=function(){return t};this.setChecked=function(p){T=p};this.isChecked=function(){return T};this.setVisible=function(p){x=p};this.isVisible=function(){return x};this.setPreset=function(p){r=p};this.isPreset=function(){return r};this.getSubNodeLevel=function(){for(var p=-1,v=t;v;)p++,v=v.getParentNode();return p};this.check=function(p){};
this.protectedMethod={fromJsonObject:function(p){P.setId(p.id);P.setName(p.name);P.setPreset(p.isPreset)},toJsonObject:function(){var p={};p.extreportID=ha;p.extreportName=y;return p}}}function Xa(){xb.call(this);var P=this,y=this.protectedMethod,ha=!0,t=[];this.setExpanded=function(x){ha=x};this.isExpanded=function(){return ha};this.setChildren=function(x){t=x};this.getChildren=function(){return t};this.fromJsonObject=function(x){y.fromJsonObject(x);if((x=x.children)&&0<x.length)for(var r=0;r<x.length;r++){var p=
x[r],v,ca=p.extRptType;ca?ca===Jb.TYPE_EXTRPT?v=new Q:ca===Jb.TYPE_DATASET&&(v=new W):v=new Xa;v.fromJsonObject(p);v.setParentNode(P);t.push(v)}};this.toJsonObject=function(){return y.toJsonObject()};this.check=function(x,r,p,v){if(0!==t.length){P.setChecked(x);for(var ca=0;ca<t.length;ca++){var Ta=t[ca];Ta instanceof Xa&&Ta.check(x,r,p,v);Ta.isVisible()&&Ta.check(x,r,p)}T(P.getParentNode(),v)}};var T=function(x,r){x&&(r&&r(x),T(x.getParentNode(),r))}}function Sb(){xb.call(this);var P=this,y=this.protectedMethod,
ha,t,T,x;this.setTemplateType=function(v){x=v};this.getTemplateType=function(){return x};this.setDesc=function(v){T=v};this.getDesc=function(){return T};this.setDataSetType=function(v){t=v};this.getDataSetType=function(){return t};this.setExtRptType=function(v){ha=v};this.getExtRptType=function(){return ha};var r=function(v,ca){if((v=v.getParentNode())&&v.getName()){ca=v.getName().concat(ca);var Ta=v.getParentNode();if(Ta&&Ta.getParentNode())return ca="/".concat(ca),r(v,ca)}return ca},p=function(v,
ca){if((v=v.getParentNode())&&v.getId()){ca=v.getId().concat(ca);var Ta=v.getParentNode();if(Ta&&Ta.getParentNode())return ca="/".concat(ca),p(v,ca)}return ca};this.protectedMethod={fromJsonObject:function(v){y.fromJsonObject(v);P.setExtRptType(v.extRptType);P.setDataSetType(v.dataSetType);P.setDesc(v.desc);P.setTemplateType(v.templateType)},toJsonObject:function(){var v=y.toJsonObject();var ca=r(P,"");var Ta=p(P,"");v.extRptType=ha;v.dataSetType=t;v.description=T;v.templateType=x;v.extreportGroupName=
ca;v.extreportGroupID=Ta;return v}}}function Q(){Sb.call(this);var P=this,y=this.protectedMethod,ha=[],t=[],T=[];this.setRelativeExt=function(r){ha=r};this.getRelativeExt=function(){return ha};this.setRelativeData=function(r){t=r};this.getRelativeData=function(){return t};this.setRelativeExtByExt=function(r){T=r};this.getRelativeExtByExt=function(){return T};this.fromJsonObject=function(r){y.fromJsonObject(r);P.setRelativeData(r.relativeIds);P.setRelativeExt(r.outLinkIds)};this.toJsonObject=function(){var r=
y.toJsonObject(),p=[],v=[];if(t&&0<t.length)for(var ca=0;ca<t.length;ca++)p.push(t[ca].getId());r.relativeIds=p;if(ha&&0<ha.length)for(ca=0;ca<ha.length;ca++)v.push(ha[ca].getId());r.outLinkIds=v;return r};this.check=function(r,p,v,ca){if(r!==P.isChecked()&&-1==v.indexOf(this.getId())){v.push(this.getId());P.setChecked(r);O(P,r,p,v,ca);var Ta=P,tb=Ta.getRelativeExt();if(tb&&0!=tb.length)for(var ya=0;ya<tb.length;ya++)if(Ta=tb[ya],!Ta.isPreset()){var N=r;if(!N){N=Ta.getRelativeExtByExt();var X=!1;
if(N&&0<N.length)for(var aa=0;aa<N.length;aa++)X=X||N[aa].isChecked();N=X}Ta.check(N,p,v,ca)}v.pop();p&&p(P.getParentNode());x(P.getParentNode(),ca)}};var x=function(r,p){r&&(p&&p(r),x(r.getParentNode(),p))}}function W(){Sb.call(this);var P=this,y=this.protectedMethod,ha=[],t=[],T=[];this.setRelativeDataSet=function(r){ha=r};this.getRelativeDataSet=function(){return ha};this.setRelativeByDataSet=function(r){t=r};this.getRelativeByDataSet=function(){return t};this.setRelativeDataByExt=function(r){T=
r};this.getRelativeDataByExt=function(){return T};this.fromJsonObject=function(r){y.fromJsonObject(r);P.setRelativeDataSet(r.relativeIds)};this.toJsonObject=function(){var r=y.toJsonObject(),p=[];if(ha&&0<ha.length)for(var v=0;v<ha.length;v++)p.push(ha[v].getId());r.relativeIds=p;return r};this.check=function(r,p,v,ca){r!==P.isChecked()&&-1==v.indexOf(this.getId())&&(v.push(this.getId()),P.setChecked(r),O(P,r,p,v,ca),v.pop(),p&&p(P.getParentNode()),x(P.getParentNode(),ca))};var x=function(r,p){r&&
(p&&p(r),x(r.getParentNode(),p))}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.manage&&(com.kingdee.bos.extreport.manage={});"undefined"==typeof com.kingdee.bos.extreport.manage.imexport&&(com.kingdee.bos.extreport.manage.imexport={});var Z=com.kingdee.bos.extreport.manage.imexport;
Z.ExportDialog=function(){wa.call(this);var P=this,y=this.protectedMethod,ha,t,T,x,r,p,v;this.setGlobal=function(X){ha=X};this.setFolderNode=function(X){T=X};this.asyncShowExportDialog=function(){La.setCallback(function(){ca()});La.loadJs("common/qing-table.js")};var ca=function(){P.setSize(640,480);P.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);y.setTitle(G.get("exportExtReportDataSet","\u5bfc\u51fa\u62a5\u8868/\u6570\u636e\u96c6"));y.setContentPaneCreator(function(){var X=$("<div>"),
aa=X.append;r=new Ya;r.addSearchListener(Ta);r.setSearchListenerDelay(400);r.setPlaceholder(G.get("searchBoxPlaceholder","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));r.setShowSearchIcon(!0);var ia=r.getJqUi();ia.addClass("extreport-export-search-box");aa.call(X,ia);aa=X.append;ia=new w;ia.setChecked(!1);ia.addCheckedListener(tb);ia.setText(G.get("showOnlyChecked","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));ia=ia.getJqUi();ia.addClass("extreport-export-show-only-checked-box");Ra.layoutCtrl(ia,250,2,
200,23);aa.call(X,ia);t=new pa;aa=t.createJqUi(T);v=new w;v.setChecked(!1);v.addCheckedListener(ya);v.setText(G.get("showAllChecked","\u5168\u9009"));ia=v.getJqUi();ia.addClass("extreport-export-show-all-checked-box");Ra.layoutCtrl(ia,15,30,200,23);t.setShowAllChecked(v);aa.addClass("extreport-export-tree-selection-area");X.append(aa);X.append(ia);x=new sb;x.setOn(!1);aa=x.getJqUi();aa.addClass("extreport-export-with-publish-switchbutton");ia=(new M(G.get("carryPublish","\u643a\u5e26\u53d1\u5e03\u4fe1\u606f"))).getJqUi();
ia.addClass("extreport-export-with-publish-text");X.append(aa);X.append(ia);return X});y.setClosingChecker(P.isValidToAccepted,!0);y.setClosingAction(function(X){X&&(X=t.getSelectedExtReportNode(),N(X))});P.showDialog()},Ta=function(X){p=r.getText().trim();t.searchKey(p)},tb=function(X,aa){aa&&(t.setShowOnlyChecked(X.isChecked()),t.searchKey(p))},ya=function(X,aa){aa&&(t.setShowAllChecked(X),t.searchKey(p))};this.isValidToAccepted=function(X){var aa=t.getSelectedExtReportNode();aa&&0<aa.length?X(!0):
(y.getMessageCurtain().showPrompt(G.get("selectNone","\u672a\u9009\u4e2d\u8f7b\u62a5\u8868/\u6570\u636e\u96c6\u3002")),X(!1))};var N=function(X){ha.createFacade(function(aa){ha.createFacade().getExportedData(aa)},function(aa,ia){return!1}).confirmExportExtReport(X,x.isOn(),ha.getCurrentSpaceID())}};Z.UploadPane=function(){var P,y,ha,t,T;this.setCurrentExtReportGroupFullPath=function(ca){T=ca};this.createJqUi=function(ca,Ta,tb){P=tb;tb=$("<div>");tb.addClass("extreport-importing-exporting-main");var ya=
$(document.body),N=$("<div class='sa-ctrl-modallayer'>");N.appendTo(ya);N.css("height",$(".extreport-manage").height());y=$("<progress value='0' max='100'>");y.addClass("extreport-importing-upload-progress");var X=$("<div>");X.addClass("extreport-importing-exporting-text");X.text(G.get("uploading","\u6b63\u5728\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u5019"));tb.append(y);tb.append(X);ya.append(tb);x(ca,Ta,tb,N)};this.setFunRefreshExtReportGroupList=function(ca){ha=ca};this.setFunErrorCallbackEvent=function(ca){t=
ca};var x=function(ca,Ta,tb,ya){var N=new FormData;N.append("filename",ca);var X=new XMLHttpRequest;X.upload.addEventListener("progress",r,!1);X.addEventListener("error",p,!1);var aa=com.kingdee.bos.qing.framework.common.RemoteFrameworkRegister.getUploadUrl();X.open("post",aa,!0);X.onload=function(ia){200==this.status&&(ia=JSON.parse(this.response),"number"==typeof ia.errorCode&&3099003==ia.errorCode?P.showError(ia.errorMessage):v(ia.data,ca.name,Ta),tb.remove(),ya.remove())};X.send(N)},r=function(ca){var Ta=
y.get(0);ca.lengthComputable&&(Ta.max=ca.total,Ta.value=ca.loaded)},p=function(ca){t&&t(G.get("uploadFail","\u4e0a\u4f20\u5931\u8d25"))},v=function(ca,Ta,tb){tb.createFacade(function(ya){var N=new Xa;N.fromJsonObject(ya);0!=N.getChildren().length?(ya=new Aa(P),ya.createUi(ca,Ta,N),ya.setGlobal(tb),ya.setFunRefreshExtReportGroupList(ha),ya.setCurrentExtReportGroupFullPath(T)):P.showPrompt(G.get("noExtReportAndGroup","\u672a\u627e\u5230\u8f7b\u62a5\u8868\u5206\u7c7b\u4e0e\u8f7b\u62a5\u8868\u3002"))},
function(ya,N){return!1}).getSelectableForImportExtReport(ca,Ta,T)}};Z.FolderNode=Xa;var da,g,w,L,wa,M,Da,Ya,Ra,G,jb,La,Jb,sb;(function(){var P=com.kingdee.bos.qing.ui.component;g=P.ComboBox;w=P.CheckBox;L=P.Dialog;wa=P.AbstractModalDialog;M=P.Label;Da=P.WorkButton;sb=P.SwitchButton;Ya=P.SearchBox;P=com.kingdee.bos.qing.framework.common;G=P.MultilanguageManager.createPackageAccessor(Z);P=com.kingdee.bos.qing.common;Ra=P.DomUtil;P=com.kingdee.bos.qing.common.ui;jb=P.TableUtil;P=com.kingdee.bos.qing;
La=P.CodeLoader;P=com.kingdee.bos.extreport.manage.common;da=P.Icons;P=com.kingdee.bos.extreport.manage.model;Jb=P.ExtReportModel})();fa.ALL_CONFLICTTYPE=["ignore","overwrite","rename"];fa.ALL_PUBLISHCONFLICTTYPE=["noDisposal","overwrite"];var O=function(P,y,ha,t,T){if((P=P.getExtRptType()==Jb.TYPE_EXTRPT?P.getRelativeData():P.getRelativeDataSet())&&0!=P.length)for(var x=0;x<P.length;x++){var r=P[x];if(!r.isPreset()){var p=y;if(!p){p=r.getRelativeByDataSet();p=r.getRelativeDataByExt().concat(p);var v=
!1;if(p&&0<p.length)for(var ca=0;ca<p.length;ca++)v=v||p[ca].isChecked();p=v}r.check(p,ha,t,T)}}}})();(function(){function pa(){var e,ka,qa;this.getType=function(){return e};this.getIconFileName=function(){return qa};this.getDisplayName=function(){return ka};this.createItem=function(E){throw Error("override me");};this.createExtReportModel=function(){throw Error("override me");};this.protectedMethod={setType:function(E){e=E},setDisplayName:function(E){ka=E},setIconFileName:function(E){qa=E}}}function fa(){pa.call(this);var e=this.protectedMethod,ka=this;e.setIconFileName("icon-card-extreport");e.setType(Fa.TYPE_EXTRPT);
e.setDisplayName(b.get("extreport","\u8f7b\u62a5\u8868"));var qa;this.createItem=function(E){E=new Oa(E);E.setIconFileName(ka.getIconFileName());E.setExtReportTypeName(ka.getDisplayName());E.setRefreshExtReportFunction(qa);E.setAllEntranceType(3);return E};this.createExtReportModel=function(){var E=new Fa;E.setExtRptType(Fa.TYPE_EXTRPT);return E};this.setRefreshExtReportFunction=function(E){qa=E}}function Aa(){pa.call(this);var e=this.protectedMethod,ka=this;e.setIconFileName("icon-card-dataset");
e.setType(Fa.TYPE_DATASET);e.setDisplayName(b.get("dataSet","\u6570\u636e\u96c6"));var qa;this.createItem=function(E){E=new Oa(E);E.setIconFileName(ka.getIconFileName());E.setExtReportTypeName(ka.getDisplayName());E.setRefreshExtReportFunction(qa);E.setAllEntranceType(12);return E};this.createExtReportModel=function(){var E=new Fa;E.setExtRptType(Fa.TYPE_DATASET);return E};this.setRefreshExtReportFunction=function(E){qa=E}}function Oa(e){xb.call(this,e);var ka=this,qa=this.protectedMethod,E,A,R,ma,
Y,oa,C,n=!0,m,l={};l[Oa.ENTRANCE_REPORT_DESIGNER]="btn_report_designer_larger";l[Oa.ENTRANCE_REPORT_PREVIEW]="btn_report_preview_larger";l[Oa.ENTRANCE_DATASET_DESIGNER]="btn_dataset_designer_larger";l[Oa.ENTRANCE_DATASET_PREVIEW]="btn_dataset_preview_larger";this.setAllEntranceType=function(D){m=D};this.setClickCardCallback=function(D){C=D};this.setSelectedCardSuccessCallBack=function(D){oa=D};this.setRefreshExtReportFunction=function(D){};this.setIconFileName=function(D){Y=D};this.setExtReportName=
function(D){A&&A.text(D)};this.setDescription=function(D){R&&R.text(D)};var f=function(D){C&&C(D)};this.getJqUi=function(){E||q();return E};var q=function(){E=$("<div>");E.addClass("extreport-card");E.on("click",f);E.attr("id",e.getExtReportID());E.attr("extrpttype",e.getExtRptType());E.on("mouseover",function(){E.find(".extreport-name").css("width","153px");A.css("color","var(--color-main, #5582f3)")});E.on("mouseleave",function(){E.find(".extreport-name").css("width","209px");A.css("color","#333333")});
var D=$("<div>");D.addClass("extreport-detail-container");var S=$("<span class='extreport-icon'>");La.background(S,Y);A=$("<span>");A.addClass("extreport-name");var Ma=e.getExtReportName();A.text(Ma);A.attr("title",Ma);A.on("click",fb);var eb=$("<span>"),mb=ka.getLockStatusDesc();mb&&(A.addClass("extreport-name-with-lock"),eb.addClass("extreport-lock-label"),e.getLockHolderName()&&(e.isUserAcquiredLock()?eb.addClass("extreport-lock-label-by-self"):eb.addClass("extreport-lock-label-by-other")),eb.text(mb));
R=$("<div>");R.addClass("extreport-description");Ma=$("<div>");Ma.addClass("manage-icon-container");mb&&Ma.css("top","12px");Ma.on("click",function(ac){ac.stopPropagation()});mb=$("<div>");mb.addClass("icon-container");mb.on("click",function(ac){ac.stopPropagation()});var Eb=e.isPreset();if(Eb){var Gb=$("<div>");Gb.addClass("extreport-preset-text");Gb.text(b.get("preset","\u9884 \u7f6e"));var Ob=$("<div>");Ob.addClass("extreport-preset-icon");La.background(Ob,"icon-preset-big");Gb.appendTo(Ma);Ob.appendTo(Ma)}ma=
$("<div>");ma.text(b.get("type","\u7c7b\u578b")+": "+e.getDisplayTypeName());ma.addClass("extreport-manage-type");Gb=e.getDescription();Ob=""==Gb||null==Gb?b.get("noDescription","\u6682\u65e0\u63cf\u8ff0"):b.get("description","\u63cf\u8ff0")+": "+Pb.cutExceedCharacters(Gb,68);R.text(Ob);R.attr("title",Gb);S.appendTo(D);A.appendTo(D);eb.appendTo(D);Ma.appendTo(D);ma.appendTo(D);R.appendTo(D);D.appendTo(E);mb.appendTo(E);D=new ia;D.setChecked(!1);D.addCheckedListener(function(){ka.protectedSelectedItem(ka.getJqUi());
var ac=ka.getJqUi().find(".selected-icon");$(ac[0]).css("display","block");oa&&oa(e)});D=D.getJqUi();D.addClass("selected-icon icon");D.appendTo(Ma);e.getExtRptType()==Fa.TYPE_DATASET?qa.addDataSetEntranceButton(mb):qa.addExtReportEntranceButton(mb,Eb);Ma=ka.getGlobalDependence().getCurrentSpaceType();Ka(mb,Ma===lb.COLLABORATION);ob(mb,Eb,Ma===lb.COLLABORATION)},H={opacity:"0"},F={opacity:"0.9"},ja={top:"65px",height:"45%",width:"18px"},ta={top:"16px",height:"55px",width:"150px"},ua={transform:"scale(0.75)",
transition:"transform 300ms ease"},U={transform:"scale(1)",transition:"transform 320ms ease"},Ja={fontSize:"4px",opacity:"0"},Ba={opacity:"1",fontSize:"14px"};document.onmousedown=function(D){var S=document.getElementsByClassName("extreport-card-selected")[0];void 0==S||$a(S,D.target)||(D=$(S).children(".extreport-zoom-container"),0<D.length&&za(D))};var Qa=function(){var D=E.parent().children(".pre-selected");D.removeClass("pre-selected");if(0<D.length){var S=D.children(".extreport-zoom-container");
if(0<S.length&&n&&(za(S),D.attr("id")===E.attr("id")))return!0}},za=function(D){n=!1;var S=D.children(".zoom-entrance-container").children(".zoom-icon-container");D.animate(H,400,"swing");if(0<S.length){var Ma=S.children(".zoom-entrance-icon"),eb=S.children(".zoom-entrance-des");0<eb.length&&0<Ma.length&&(Ma.css(ua),eb.animate(Ja,300,"swing"),S.animate(ja,320,"swing"),setTimeout(function(){E.children(".extreport-icon").show()},390))}setTimeout(function(){D.remove();n=!0},400)},$a=function(D,S){return void 0==
S||null==S?!1:D==S?!0:$a(D,S.offsetParent)},fb=function(){ka.protectedSelectedItem(ka.getJqUi());if(n&&!Qa()){n=!1;var D=$("<div>");D.addClass("extreport-zoom-container");D.css(H);var S=$("<div>");S.addClass("zoom-entrance-container");Ca(S);S.appendTo(D);D.appendTo(E);setTimeout(function(){E.children(".extreport-icon").hide();D.animate(F,360,"swing",function(){n=!0});var Ma=S.children(".zoom-icon-container");if(0<Ma.length){var eb=Ma.children(".zoom-entrance-icon"),mb=Ma.children(".zoom-entrance-des");
0<eb.length&&0<mb.length&&(eb.css(U),mb.animate(Ba,320,"swing"));Ma.animate(ta,300,"swing")}},40)}},Ca=function(D){if(m&Oa.ENTRANCE_REPORT_DESIGNER){var S=b.get("reportDesigner","\u62a5\u8868\u8bbe\u8ba1\u5668");Ib(S,Oa.ENTRANCE_REPORT_DESIGNER,D)}m&Oa.ENTRANCE_REPORT_PREVIEW&&(S=b.get("preview","\u9884\u89c8"),Ib(S,Oa.ENTRANCE_REPORT_PREVIEW,D));m&Oa.ENTRANCE_DATASET_DESIGNER&&(S=b.get("datasetDesigner","\u6570\u636e\u96c6\u8bbe\u8ba1\u5668"),Ib(S,Oa.ENTRANCE_DATASET_DESIGNER,D));m&Oa.ENTRANCE_DATASET_PREVIEW&&
(S=b.get("datasetpreview","\u9884\u89c8\u6570\u636e\u96c6"),Ib(S,Oa.ENTRANCE_DATASET_PREVIEW,D))},Ib=function(D,S,Ma){var eb=$("<div>");eb.addClass("zoom-icon-container");eb.css(ja);var mb=$("<div>");mb.addClass("zoom-entrance-icon");mb.css(ua);La.backgroundWithHover(mb,l[S]);mb.attr("title",D);mb.appendTo(eb);var Eb=$("<div>");Eb.text(D);Eb.addClass("zoom-entrance-des");Eb.css(Ja);Eb.attr("title",D);Eb.appendTo(eb);la(mb,Eb);ea(mb,Eb);I(eb,S);eb.appendTo(Ma)},la=function(D,S){D.on("mouseenter",function(){S.css("color",
"var(--color-main, #5582f3)")});D.on("mouseleave",function(){S.css("color","")})},ea=function(D,S){S.on("mouseenter",function(){S.css("color","var(--color-main, #5582f3)")});S.on("mouseleave",function(){S.css("color","")})},I=function(D,S){D.on("click",function(Ma){Ma.stopPropagation();qa.openDesigner(Sa(S))})},Sa=function(D){if(D&Oa.ENTRANCE_REPORT_DESIGNER){var S=sb.getExtReportDesignerEntrance();return D=function(Ma,eb,mb,Eb,Gb,Ob,ac,jc,gc,kc){qa.checkOpenedReportDesigner(S,Ma,eb,mb,Eb,Gb,Ob,ac,
!1,jc,gc,kc)}}if(D&Oa.ENTRANCE_REPORT_PREVIEW)return sb.getExtReportPreviewEntrance();if(D&Oa.ENTRANCE_DATASET_DESIGNER)return S=sb.getDataSetDesignerEntrance(),D=function(Ma,eb,mb,Eb,Gb,Ob,ac,jc,gc,kc){qa.checkOpenedDataSetDesigner(S,Ma,eb,mb,Eb,Gb,Ob,ac,!1,jc,gc,kc)};if(D&Oa.ENTRANCE_DATASET_PREVIEW)return sb.getDataSetPreviewEntrance()},Ka=function(D,S){S&&(S=$("<span>"),S.addClass("extreport-info-icon"),La.backgroundWithHover(S,"info"),e.getExtRptType()==Fa.TYPE_DATASET?S.attr("title",b.get("viewDatasetDetail",
"\u67e5\u770b\u6570\u636e\u96c6\u8be6\u60c5")):S.attr("title",b.get("viewReportDetail","\u67e5\u770b\u62a5\u8868\u8be6\u60c5")),S.on("click",rb),S.appendTo(D))},rb=function(){ka.fireOpenDetailPane(e,Y)},ob=function(D,S,Ma){S||(S=$("<span>"),S.addClass("extreport-icon edit-icon icon"),S.css({position:"absolute",right:"5px"}),Ma&&S.css({right:"35px"}),S.attr("title",b.get("edit","\u7f16\u8f91")),La.backgroundWithHover(S,"list_view_edit"),S.on("click",ka.protectedShowEditDialog),S.appendTo(D))};this.protectedShowEditDialog=
function(){ka.protectedSelectedItem(ka.getJqUi());var D=new Sb(e);D.setExtReportTypeName(ka.getExtReportTypeName());D.addSuccessCallback(function(S){var Ma=S.getExtReportName(),eb=S.getDescription();e.setExtReportName(Ma);e.setDescription(eb);e.setModifyTime(S.getModifyTime());A.text(Ma);A.attr("title",Ma);S=""==eb||null==eb?b.get("noDescription","\u6682\u65e0\u63cf\u8ff0"):b.get("description","\u63cf\u8ff0")+": "+Pb.cutExceedCharacters(eb,68);R.text(S);R.attr("title",eb);eb=b.get("editSuccess","\u7f16\u8f91\u6210\u529f\u3002");
ka.getGlobalDependence().getMessageCurtain().showSuccess(eb,2E3)});D.setGlobal(ka.getGlobalDependence());D.createDialog().show()};this.protectedSelectedItem=function(D){var S=E.parent().children(".extreport-card-selected");0<S.length&&(S.removeClass("extreport-card-selected"),S.addClass("pre-selected"));D.addClass("extreport-card-selected")};this.protectedPopPublishButton=function(D,S){return S.appendTo($(D.currentTarget).parent())}}function Pa(e){xb.call(this,e);var ka=this,qa=this.protectedMethod,
E,A,R,ma,Y;this.setFunUpdateUiCallback=function(m){Y=m};this.setFunOpenDetailCallback=function(m){ma=m};this.setIconFileName=function(m){A=m};this.setFunEditSuccessCallback=function(m){R=m};this.getExtReportModel=function(){return e};this.getJqUi=function(){E=$("<div class='extreport-list'>");var m=$("<div class='icon-container'>");E.append(m);E.on("click",function(f){f.stopPropagation()});e.getExtRptType()==Fa.TYPE_DATASET?qa.addDataSetEntranceButton(m):qa.addExtReportEntranceButton(m,e.isPreset());
n(m,e.isPreset());var l=ka.getGlobalDependence().getCurrentSpaceType();oa(m,l===lb.COLLABORATION);return E};var oa=function(m,l){l&&(l=$("<span>"),l.addClass("extreport-icon icon extreport-info-itemicon"),La.backgroundWithHover(l,"info"),e.getExtRptType()==Fa.TYPE_DATASET?l.attr("title",b.get("viewDatasetDetail","\u67e5\u770b\u6570\u636e\u96c6\u8be6\u60c5")):l.attr("title",b.get("viewReportDetail","\u67e5\u770b\u62a5\u8868\u8be6\u60c5")),l.on("click",C),l.appendTo(m))},C=function(){ma&&ma(e,A,Y);
Y&&Y()},n=function(m,l){l||(l=$("<span>"),l.addClass("extreport-icon icon"),l.attr("title",b.get("edit","\u7f16\u8f91")),La.backgroundWithHover(l,"list_view_edit"),l.on("click",ka.protectedShowEditDialog),l.appendTo(m))};this.openDesigner=function(m){qa.openDesigner(m)};this.protectedShowEditDialog=function(){ka.protectedSelectedItem(ka.getJqUi());var m=new Sb(e);m.setExtReportTypeName(ka.getExtReportTypeName());m.addSuccessCallback(function(l){var f=l.getExtReportName(),q=l.getDescription();e.setExtReportName(f);
e.setDescription(q);e.setModifyTime(l.getModifyTime());R&&R(e);l=b.get("editSuccess","\u7f16\u8f91\u6210\u529f\u3002");ka.getGlobalDependence().getMessageCurtain().showSuccess(l,2E3)});m.setGlobal(ka.getGlobalDependence());m.createDialog().show()};this.protectedSelectedItem=function(m){};this.protectedPopPublishButton=function(m,l){var f=[132,52],q=$(m.currentTarget),H=$(document.body);l.appendTo(H);l.css("margin-left","0px");l.css("margin-top","0px");m=H.prop("clientWidth");var F=H.prop("clientHeight"),
ja=F>>1,ta=q.outerHeight(),ua=[0,ta-1];ua=z.upwardCoordinate(q[0],ua,H[0]);var U=ua[0],Ja=ua[1],Ba=f[0];f=f[1];Ja+f>F&&(Ja>ja+ta?(ua=[0,0],ua=z.upwardCoordinate(q[0],ua,H[0]),q=ua[1]-f+1,0<=q?Ja=q:(Ja=2,f=ua[1]-2)):f=F-Ja-2);U+Ba>m-10&&(U=m-Ba-10,0>U&&(U=0));z.layoutCtrl(l,U,Ja,Ba,f)}}function xb(e){var ka=this,qa,E,A;this.setOpenDetailPaneCallback=function(n){A=n};this.fireOpenDetailPane=function(n,m){A&&A(n,m)};this.setExtReportTypeName=function(n){E=n};this.getExtReportTypeName=function(){return E};
this.setGlobalDependence=function(n){qa=n};this.getGlobalDependence=function(){return qa};var R=function(n,m,l,f,q,H,F,ja,ta,ua,U){var Ja=qa.createFacade(function(){n(m,l,f,q,H,F,ja,ta,ua,U)},function(Ba,Qa){return 8099001==Ba||8099002==Ba?(qa.getMessageCurtain().showPrompt(Qa,2E3),!0):!1});Ja.setShowBlocking(!1);Ja.existExtReport(Fa.TYPE_EXTRPT,m)},ma=function(n,m,l,f,q,H,F,ja,ta,ua,U,Ja){var Ba=qa.createFacade(function(){n(m,l,f,q,H,F,ja,ta,ua,U,Ja)},function(Qa,za){return 8099001==Qa||8099002==
Qa?(qa.getMessageCurtain().showPrompt(za,2E3),!0):!1});Ba.setShowBlocking(!1);Ba.existExtReport(Fa.TYPE_DATASET,m)},Y=function(n,m,l,f,q){var H=$("<span>");H.addClass("extreport-icon icon");La.backgroundWithHover(H,m);H.attr("title",n);H.on("click",function(F){ka.protectedSelectedItem(ka.getJqUi());F.stopPropagation();q?q(F):oa(l)});H.appendTo(f);return H},oa=function(n){var m=qa.createFacade(function(l){var f=e.getExtReportID(),q=e.getExtReportGroupID(),H=e.getExtReportName(),F=e.getTemplateType(),
ja=e.isPreset();l=l.presetManagePerm;var ta=qa.getCurrentSpaceID(),ua=qa.getCurrentSpaceType(),U=qa.getCurrentSpaceCreatorId();e.getExtRptType()==Fa.TYPE_DATASET&&(F=e.getDataSetType());n(f,H,q,F,ja,l,C,ta,ua,U)},function(l,f){return!1});m.setShowBlocking(!0);m.checkPresetManagePerm()},C=function(){var n=e.getDisplayTypeName();O.occur(O.EXT_EXTREPORT_ENTRANCE_TYPE,n)};this.protectedShowEditDialog=function(){throw Error("Override");};this.protectedSelectedItem=function(n){throw Error("Override");};
this.protectedPopPublishButton=function(n,m){throw Error("Override");};this.getLockStatusDesc=function(){if(qa.getCurrentSpaceType()!=lb.COLLABORATION)return"";if(e.getLockHolderName()){var n=0==e.getLockType()?b.get("lockStatus","\u88ab\u201c#1\u201d\u9501\u5b9a"):b.get("explicitLockStatus","\u88ab\u201c#1\u201d\u957f\u671f\u9501\u5b9a");n=e.isUserAcquiredLock()?n.replace("#1",b.get("me","\u6211")):n.replace("#1",e.getLockHolderName())}else n=b.get("unlockStatus","\u6682\u672a\u9501\u5b9a");return n};
this.protectedMethod={addExtReportEntranceButton:function(n,m){var l=sb.getExtReportDesignerEntrance();Y(b.get("reportDesigner","\u62a5\u8868\u8bbe\u8ba1\u5668"),"btn-extreport",function(f,q,H,F,ja,ta,ua,U,Ja,Ba){R(l,f,q,H,F,ja,ta,ua,U,Ja,Ba)},n);m=sb.getExtReportPreviewEntrance();Y(b.get("preview","\u9884\u89c8"),"btn-preview",m,n)},addDataSetEntranceButton:function(n){var m=sb.getDataSetDesignerEntrance();Y(b.get("datasetDesigner","\u6570\u636e\u96c6\u8bbe\u8ba1\u5668"),"btn-dataset",function(H,
F,ja,ta,ua,U,Ja,Ba,Qa,za){ma(m,H,F,ja,ta,ua,U,Ja,!1,Ba,Qa,za)},n);var l=sb.getDataSetPreviewEntrance();Y(b.get("datasetpreview","\u9884\u89c8\u6570\u636e\u96c6"),"btn-preview",l,n);var f=Y(b.get("guiDatasetDesigner","GUI\u6570\u636e\u96c6\u8bbe\u8ba1\u5668"),"btn-dataset-gui",function(H,F,ja,ta,ua,U,Ja){ma(m,H,F,ja,ta,ua,U,Ja,!0,sSpaceId,sSpaceType,sSpaceCreatorId)},n),q=function(){f&&(qa.isShowGUIEnterIcon()?f.show():f.hide())};q();qa.addListener(y.IS_SHOW_GUI_ENTER_ICON,function(){q()})},openDesigner:oa,
checkOpenedDataSetDesigner:ma,checkOpenedReportDesigner:R}}function Xa(){this.createDialog=function(){throw Error("override");}}function Sb(e){Xa.call(this);var ka,qa=[400,300],E=[],A,R,ma,Y,oa;this.setExtReportTypeName=function(m){oa=m};this.setGlobal=function(m){ka=m};this.addSuccessCallback=function(m){E.push(m)};this.createDialog=function(){var m=$(document.body),l=$("<div class='sa-ctrl-common-modallayer'>");l.appendTo(m);var f=new t(l);f.setSelectable(!0);var q=void 0!=e.getExtReportID()?oa===
b.get("extreport","\u8f7b\u62a5\u8868")?b.get("editSth","\u7f16\u8f91#1").replace("#1",b.get("report","\u62a5\u8868")):b.get("editSth","\u7f16\u8f91#1").replace("#1",oa):oa===b.get("extreport","\u8f7b\u62a5\u8868")?b.get("createSth","\u65b0\u5efa#1").replace("#1",b.get("report","\u62a5\u8868")):b.get("createSth","\u65b0\u5efa#1").replace("#1",oa);f.setTitle(q);q=qa[0];var H=qa[1],F=m.prop("clientWidth"),ja=m.prop("clientHeight");f.setBounds(F-q>>1,ja-H>>1,q,H);f.setToolbarVisible(!1);f.setContent(n());
f.showFooterPane();l.appendTo(m);var ta=function(){f.destroy();l.remove()};f.addClosingListener(function(ua,U){U?C(ta,ua.getMessageCurtain()):ta()});return f};var C=function(m,l){var f=$.trim(A.getText()),q=$.trim(R.getText()),H;""!=f&&50<f.length?H=b.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):""==f?H=oa===b.get("extreport","\u8f7b\u62a5\u8868")?b.get("nameCannotBeEmpty","\u8bf7\u8f93\u5165#1\u540d\u79f0\u3002").replace("#1",b.get("report","\u62a5\u8868")):
b.get("nameCannotBeEmpty","\u8bf7\u8f93\u5165#1\u540d\u79f0\u3002").replace("#1",oa):Pb.isValidString(f)?Pb.isKeywords(f)&&(H=b.get("isKeywords",'\u65e0\u6cd5\u4f7f\u7528"#1"\u4f5c\u4e3a\u540d\u79f0\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002').replace("#1",f)):H=b.get("invalidName","\u540d\u79f0\u53ea\u80fd\u7531\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210,\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\u3002");""!=q&&500<q.length&&(H=b.get("descriptionTooLong",
"\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7500\u4e2a\u5b57\u7b26\u3002"));if(H)l.showPrompt(H,2E3);else{var F=e.copy();F.setExtReportName(f);F.setDescription(q);F.setDataSetType(Y);f=ka.createFacade(function(ja){F.fromJsonObject(ja);ja=0;for(var ta=E.length;ja<ta;ja++){var ua=E[ja];ua&&ua(F)}m()},function(ja,ta){return 8010001==ja?(ja=oa===b.get("extReport","\u8f7b\u62a5\u8868")?b.get("nameExist","#1\u540d\u79f0\u5df2\u5b58\u5728\u3002").replace("#1",b.get("qReport","\u62a5\u8868")):b.get("nameExist",
"#1\u540d\u79f0\u5df2\u5b58\u5728\u3002").replace("#1",oa),l.showPrompt(ja,2E3),!0):8099001==ja||8099002==ja?(l.showPrompt(ta,2E3),!0):!1});f.setShowBlocking(!0);f.saveOrUpdateExtReport(F,ka.getCurrentSpaceID())}},n=function(){var m=$("<div>"),l=!1;if(e.getExtRptType()==Fa.TYPE_DATASET)if(e.getExtReportID())Y=e.getDataSetType();else{l=!0;var f=new p;f.setRequired(!0);f.setText(b.get("dataSetType","\u6570\u636e\u96c6\u7c7b\u578b"));f=f.getJqUi();var q=vb.AllDataSetType;ma=new r;ma.setItemModels(q);
ma.setSelected(q[0]);ma.setCustomPainter(function(ua,U,Ja){U.text(b.get(Ja.getI18nKey(),Ja.getDefaultDesc()))});ma.addSelectedChangedListener(function(ua,U,Ja){Y=Ja.getTypeID()});var H=ma.getJqUi();f.appendTo(m);H.appendTo(m);Y=q[0].getTypeID()}q=new p;q.setText(b.get("extreportName","\u540d\u79f0"));q.setRequired(!0);q=q.getJqUi();A=new ca;e&&A.setText(e.getExtReportName());A.setText(e.getExtReportName());var F=A.getJqUi(),ja=new p;ja.setText(b.get("description","\u63cf\u8ff0"));ja=ja.getJqUi();
R=new v;e&&R.setText(e.getExtReportName());R.setText(e.getDescription());var ta=R.getJqUi();q.appendTo(m);F.appendTo(m);ja.appendTo(m);ta.appendTo(m);l?(z.layoutCtrl(q,8,0,100,23),z.layoutCtrl(F,80,0,270,23),z.layoutCtrl(f,8,46,100,23),z.layoutCtrl(H,80,43,270,23),z.layoutCtrl(ja,8,96,100,23),z.layoutCtrl(ta,80,102,270,72)):(z.layoutCtrl(q,8,0,100,23),z.layoutCtrl(F,80,0,270,23),z.layoutCtrl(ja,8,48,100,23),z.layoutCtrl(ta,80,54,270,120));return m}}function Q(e){Xa.call(this);var ka=this,qa=[400,
300],E=[],A,R,ma,Y=!1;this.setExtReportTypeName=function(n){R=n};this.addSuccessCallback=function(n){E.push(n)};this.setGlobal=function(n){A=n};this.createDialog=function(){var n=$(document.body),m=$("<div class='sa-ctrl-common-modallayer'>");m.appendTo(n);var l=new t(m);l.setTitle(b.get("operateConfirm","\u64cd\u4f5c\u786e\u8ba4"));var f=qa[0],q=qa[1],H=n.prop("clientWidth"),F=n.prop("clientHeight");l.setBounds(H-f>>1,F-q>>1,f,q);l.setToolbarVisible(!1);l.setContent(ka.createJqPanel());l.addClosingListener(function(ja,
ta){ta&&C(ja.getMessageCurtain());ja.destroy();m.remove()});l.showFooterPane();m.appendTo(n);oa(m);return l};this.createJqPanel=function(){var n=$("<div>"),m=$("<span>");Jb.background(m,"msg-delete");var l=$("<span>");l.addClass("extreport-manage-deldialog-confirm-msg");var f=b.get("confirmToDeleteExtReport","\u5220\u9664#1\u201c#2\u201d\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u8be5#3\u5417\uff1f");1==e.length?R===b.get("report","\u62a5\u8868")?(f=f.replace("#1",b.get("report",
"\u62a5\u8868")),f=f.replace("#2",e[0].getExtReportName()),f=f.replace("#3",b.get("report","\u62a5\u8868"))):(f=f.replace("#1",b.get("datasetForConfirm","\u6570\u636e\u96c6")),f=f.replace("#2",e[0].getExtReportName()),f=f.replace("#3",b.get("datasetForConfirm","\u6570\u636e\u96c6"))):(f=b.get("multiSelectConfirmDelete","\u5c06\u5220\u9664#1\u9879\u6570\u636e\u5185\u5bb9\uff0c\u6570\u636e\u5185\u5bb9\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u5220\u9664\u5417\uff1f"),f=f.replace("#1",
e.length));l.text(f);l.attr("title",f);m.appendTo(n);l.appendTo(n);ka.protectedCustomLayout(n,m,l);return n};var oa=function(n){(n=n.children(".sa-ctrl-dialog"))&&0<n.length&&(n=n.children(".sa-ctrl-dialog-title"))&&0<n.length&&n.css("border-bottom","0px")},C=function(n){for(var m=function(H){var F=H.deletableList,ja=H.unDeletableList;H=[];for(var ta=[],ua=0;ua<F.length;ua++){var U=new Fa;U.fromJsonObject(F[ua]);H.push(U)}for(ua=0;ua<ja.length;ua++)U=new Fa,U.fromJsonObject(ja[ua]),ta.push(U);ua=
0;for(F=E.length;ua<F;ua++)(ja=E[ua])&&ja(H,ta)},l=function(H,F){return 8099001==H||8099002==H?(n.showPrompt(F,2E3),!0):!1},f=[],q=0;q<e.length;q++)f.push(e[q].toJsonObject());0<f.length&&(m=A.createFacade(m,l),m.setShowBlocking(!0),m.batchDeleteExtReport(f,Y?ma.isOn():!1,A.getCurrentSpaceID()))};this.protectedCustomLayout=function(n,m,l){z.layoutCtrl(m,140,10,98,80);z.layoutCtrl(l,0,100,370,70);for(m=0;m<e.length;m++)if(e[m].getExtRptType()==Fa.TYPE_EXTRPT){Y=!0;break}Y&&(m=(new p(b.get("deletePublishInfo",
"\u540c\u65f6\u5220\u9664\u53d1\u5e03\u4fe1\u606f"))).getJqUi(),ma=new N,l=ma.getJqUi(),z.layoutCtrl(m,105,163,125,23),z.layoutCtrlWithLRTB(l,230,null,31,165,null,19),"en"==G.getUrlParamValue("language")&&(z.layoutCtrl(m,75,163,175,23),z.layoutCtrlWithLRTB(l,255,null,31,165,null,19)),n.append(l),n.append(m))}}function W(e,ka){Xa.call(this);var qa=[],E=[400,300],A,R,ma,Y,oa,C,n;this.setExtReportTypeName=function(q){};this.setCurrentGroupName=function(q){n=q};this.addSuccessCallback=function(q){qa.push(q)};
this.setArrLoadedExtReport=function(q){C=q};this.setGlobal=function(q){A=q};this.createDialog=function(){var q=$(document.body),H=$("<div class='sa-ctrl-common-modallayer'>");H.appendTo(q);var F=new t(H),ja=b.get("moveTo","\u79fb\u52a8\u5230");F.setTitle(ja);ja=E[0];var ta=E[1],ua=q.prop("clientWidth");q=q.prop("clientHeight");var U=function(){F.destroy();H.remove()};F.setBounds(ua-ja>>1,q-ta>>1,ja,ta);F.setToolbarVisible(!1);F.setContent(m());F.addClosingListener(function(Ja,Ba){Ba?f(Ja.getMessageCurtain(),
U):U()});F.showFooterPane();return F};var m=function(){var q=$("<div>");q.addClass("move-subject-panel");var H=new p;H.setText(b.get("extReportCategory","\u76ee\u5f55"));Y=H.getJqUi();ma=l(ka,q);Y.appendTo(q);z.layoutCtrl(ma,100,50,240,23);z.layoutCtrl(Y,25,50,70,23);return q},l=function(q,H){var F=q.getChildren();R=new X;oa=new L(F);R.setSelectedModel(Qb.findTreeNodeByFullPath(q,n&&n.split("/")));R.setCustomPainter(function(ja,ta){ja=Qb.buildCategoryFullPath(ja,"","/");ta.text(ja);ta.attr("title",
ja)});R.setDropdownCreator(function(ja,ta,ua){return oa.createJqPopup(ja,ta,ua)});ma=R.getJqUi();ma.appendTo(H);return ma},f=function(q,H){var F=R.getSelectedModel(),ja=F.getUserObject().getExtReportGroupID(),ta=e[0].getExtReportGroupID();if(ja==ta)H();else{for(var ua=function(za){if(za&&0<za.length)for(var $a=0;$a<za.length;$a++){var fb=new Fa;fb.fromJsonObject(za[$a]);for(var Ca=0;Ca<C.length;Ca++){var Ib=C[Ca];fb.getExtReportGroupID()==Ib.getExtReportGroupID()&&Ib.getExtReportID()==fb.getExtReportID()&&
C.splice(Ca,1)}}},U=function(za,$a,fb){if(za&&0<za.length)for(var Ca=0,Ib=qa.length;Ca<Ib;Ca++)for(var la=0;la<za.length;la++){var ea=new Fa;ea.fromJsonObject(za[la]);var I=new Fa;I.setExtReportID(ea.getExtReportID());I.setExtReportGroupID($a.getUserObject().getExtReportGroupID());I.setExtReportName(ea.getExtReportName());I.setDescription(ea.getDescription());I.setDataSetType(ea.getDataSetType());I.setExtRptType(0==ea.getExtRptType()?Fa.TYPE_EXTRPT:Fa.TYPE_DATASET);I.setModifyTime(ea.getModifyTime());
I.setLockType(ea.getLockType());I.setLockHolderName(ea.getLockHolderName());I.setUserAcquiredLock(ea.isUserAcquiredLock());I.setBeforeMovedExtReportGroupId(fb);(ea=qa[Ca])&&ea(I)}},Ja=[],Ba=0;Ba<e.length;Ba++)Ja.push(e[Ba].toJsonObject());Ba=1==e.length?!1:!0;var Qa=A.createFacade(function(za){var $a=e.length;U(za.extreportList,F,ta);if((za=za.conflictExtreportList)&&0<za.length){$a-=za.length;var fb=new da;fb.setDestCategoryTreeNode(F);fb.setArrSuccessCallback(qa);fb.setHandlerExtReportSuccessMove(U);
fb.setUpdateLoadedExtReportCallback(ua);fb.setCloseCallback(H);fb.setGlobal(A);fb.createUi(za,$a,ta);fb.repaint()}H&&H()},function(za,$a){return 8010001==za||8099001==za||8099002==za?(q.showPrompt($a,2E3),!0):!1});Qa.setShowBlocking(!0);Qa.moveExtReport(ja,Ja,Ba,!0,A.getCurrentSpaceID(),A.getCurrentSpaceType())}}}function Z(){}function da(){qb.call(this);var e=this,ka=this.protectedMethod,qa,E,A,R,ma,Y,oa,C,n,m,l,f=[],q=[];this.setGlobal=function(U){qa=U};this.setDestCategoryTreeNode=function(U){n=
U};this.setArrSuccessCallback=function(U){};this.setHandlerExtReportSuccessMove=function(U){m=U};this.setUpdateLoadedExtReportCallback=function(U){l=U};this.setCloseCallback=function(U){};this.createUi=function(U,Ja,Ba){Y=U;oa=Ba;e.setSize(640,480);e.setPosition(window.innerWidth-640>>1,window.innerHeight-480>>1);ka.setTitle(b.get("moveReportOrDataset","\u6279\u91cf\u79fb\u52a8\u62a5\u8868/\u6570\u636e\u96c6"));ka.setContentPaneCreator(function(){for(var Qa=!1,za=0;za<U.length;za++)if(2!=U[za].lockStatus){Qa=
!0;break}za=$("<div>");var $a=H(Ja,!Qa);E=new p($a);var fb=E.getJqUi();fb.attr("title",$a);fb.addClass("extreport-import-selection-prompt");za.append(fb);fb=0;$a=30;A=new gb(b.get("allIgnore","\u5168\u90e8\u5ffd\u7565"));A.addActionListener(F);var Ca=A.getJqUi();Ca.addClass("extreport-import-selection-btn");za.append(Ca);z.layoutCtrl(Ca,fb,$a,80,23);fb+=100;Qa&&(R=new gb(b.get("allOverwrite","\u5168\u90e8\u8986\u76d6")),R.addActionListener(ja),Ca=R.getJqUi(),Ca.addClass("extreport-import-selection-btn"),
za.append(Ca),z.layoutCtrl(Ca,fb,$a,80,23),fb+=100);ma=new gb(b.get("allRename","\u5168\u90e8\u91cd\u547d\u540d"));ma.addActionListener(ta);Ca=ma.getJqUi();Ca.addClass("extreport-import-selection-btn");z.layoutCtrl(Ca,fb,$a,80,23);za.append(Ca);$a+=28;C=new g;C.setShowOverwriteBtn(Qa);C.setMessageCurtain(ka.getMessageCurtain());Qa=C.getJqUi(U);z.layoutCtrlWithLRTB(Qa,0,0,null,$a,0,null);za.append(Qa);return za});ka.setClosingChecker2(e.isValidToAccepted,function(Qa){Qa(!0);0<f.length&&m&&(m(f,n,oa),
f=[]);0<q.length&&l&&(l(q),q=[])},!0);ka.setClosingAction(function(Qa){});e.showDialog()};this.repaint=function(){C.refresh()};var H=function(U,Ja){return(Ja?b.get("moveSuccessWithLocked","\u6210\u529f\u5c06#1\u4e2a\u62a5\u8868/\u6570\u636e\u96c6\u79fb\u52a8\u5230\u201c#2\u201d\u3002\u4ee5\u4e0b\u62a5\u8868/\u6570\u636e\u96c6\u4e0e\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\u7684\u62a5\u8868/\u6570\u636e\u96c6\u540d\u79f0\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002"):b.get("moveSuccessWithConflict",
"\u6210\u529f\u5c06#1\u4e2a\u62a5\u8868/\u6570\u636e\u96c6\u79fb\u52a8\u5230\u201c#2\u201d\u3002\u4ee5\u4e0b\u6570\u636e\u5185\u5bb9\u540d\u79f0\u51b2\u7a81\uff0c\u8bf7\u5904\u7406\u3002")).replace("#1",U).replace("#2",n.getUserObject().getExtReportGroupName())},F=function(){for(var U in Y)Y[U].strategy=g.ALL_CONFLICTTYPE[0];C.updateUi(Y)},ja=function(){var U=[],Ja;for(Ja in Y)2==Y[Ja].lockStatus?U.push(Ja):Y[Ja].strategy=g.ALL_CONFLICTTYPE[1];C.updateUi(Y);0<U.length&&(U=b.get("canNotOverwrite",
"\u201c#1\u201d\u7b49#2\u4e2a\u62a5\u8868/\u6570\u636e\u96c6\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u4e0d\u80fd\u8986\u76d6\u3002").replace("#1",Y[U[0]].extReportName).replace("#2",U.length),ka.getMessageCurtain().showPrompt(U))},ta=function(){for(var U in Y)Y[U].strategy=g.ALL_CONFLICTTYPE[2];C.updateUi(Y)};this.isValidToAccepted=function(U){ua(Y,U)};var ua=function(U,Ja){var Ba=[];for(Qa in U)"ignore"!=U[Qa].strategy&&(Ba=Ba.concat(U[Qa]));if(0==Ba.length)Ja(!0);else{U=
1==Ba.length?!1:!0;var Qa=qa.createFacade(function(za){var $a=za.extreportList;$a&&0<$a.length&&(f=f.concat($a));var fb=za.deleteExtreportList;fb&&0<fb.length&&(q=q.concat(fb));(za=za.conflictExtreportList)&&0<za.length?(Ja(!1),Y=za,$a=H($a.length,!0),E.setText($a),R&&(R.getJqUi().remove(),ma.getJqUi().css("left","100px")),C.setShowOverwriteBtn(!1),C.updateUi(za,!0)):(Ja(!0),m&&m(f,n,oa),f=[],l&&l(q),q=[])},function(za,$a){return 1020101==za||1100021==za?!0:!1});Qa.setShowBlocking(!0);Qa.moveExtReport(n.getUserObject().getExtReportGroupID(),
Ba,U,!1,qa.getCurrentSpaceID(),qa.getCurrentSpaceType())}}}function g(){function e(ma){KTDefaultCellRender.call(this,ma);var Y=this,oa=this.paintCellUI;this.paintCellUI=function(n,m){Y.getCurrentRowIdx()<bb.getHeadRowCount()?oa(n,m):2==Y.getCurrentColIdx()?C(n,Y.getCellWidth(),Y.getCellHeight(),Y.getCurrentRow()):oa(n,m)};var C=function(n,m,l,f){n=bb.createCtrlInCell(n,m,l,r);n.setSelected(f.getUserObject().strategy);n.setItemModels(qa?g.ALL_CONFLICTTYPE:[g.ALL_CONFLICTTYPE[0],g.ALL_CONFLICTTYPE[2]]);
n.setUserObject(f);n.setCustomPainter(function(q,H,F){switch(F){case g.ALL_CONFLICTTYPE[0]:q=b.get("ignore","\u5ffd\u7565");break;case g.ALL_CONFLICTTYPE[1]:q=b.get("overwrite","\u8986\u76d6");break;case g.ALL_CONFLICTTYPE[2]:q=b.get("rename","\u91cd\u547d\u540d");break;default:q=""}F=$("<div>");F.text(q);F.appendTo(H)});n.addSelectedChangedListener(function(q,H,F){if(F==g.ALL_CONFLICTTYPE[1]){var ja=q.getUserObject().getUserObject();if(2==ja.lockStatus){q.setSelected(H);q="0"===f.getUserObject().extRptType?
b.get("report","\u62a5\u8868"):b.get("dataSet","\u6570\u636e\u96c6");ja=b.get("canNotOverwriteOne","\u201c#1\u201d#2\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u4e0d\u80fd\u8986\u76d6\u3002").replace("#1",ja.extReportName).replace("#2",q);R.showPrompt(ja);return}}q.getUserObject().getUserObject().strategy=F})}}var ka=this,qa=!1,E,A,R;this.setShowOverwriteBtn=function(ma){qa=ma};this.setMessageCurtain=function(ma){R=ma};this.getConflictExtReportList=function(){return A};this.getJqUi=
function(ma){E=bb.createTable();bb.bindTableListenerForCtrl(E);var Y=new e(E);Y.setOutsideVisible(!1);E.setCellRender(Y);E.addColumns(3);E.getColumn(0).setWidth(180);E.getColumn(1).setWidth(180);E.getColumn(2).setWidth(180);Y=bb.createHeadRow(E);Y.getCell(0).setValue(b.get("nameField","\u540d\u79f0"));Y.getCell(1).setValue(b.get("type","\u7c7b\u578b"));Y.getCell(2).setValue(b.get("strategy","\u5904\u7406\u7b56\u7565"));ka.updateUi(ma,!0);bb.refresh(E);return $(E.getUI())};this.updateUi=function(ma,
Y){if(Y){A=ma;for(var oa in ma)A[oa].strategy=g.ALL_CONFLICTTYPE[0]}bb.clearWithoutHead(E);bb.refresh(E);for(oa=0;oa<ma.length;oa++){var C=ma[oa];Y=bb.createRow(E);Y.setUserObject(C);Y.getCell(0).setValue(C.extReportName);0==C.extRptType?Y.getCell(1).setValue(b.get("report","\u62a5\u8868")):1==C.extRptType&&Y.getCell(1).setValue(b.get("dataSet","\u6570\u636e\u96c6"));Y.getCell(2).setValue(C.strategy)}bb.refresh(E)};this.refresh=function(){bb.refresh(E)}}function w(e,ka){Xa.call(this);var qa=this,
E=[400,300],A,R,ma,Y=[],oa,C,n,m,l,f,q=vb.PERSONAL,H,F,ja,ta,ua,U=!1;this.setExtReportTypeName=function(la){oa=la};this.setCurrentGroupName=function(la){C=la};this.addSuccessCallback=function(la){Y.push(la)};this.setGlobal=function(la){ma=la};this.createDialog=function(){var la=$(document.body),ea=$("<div class='sa-ctrl-common-modallayer'>");ea.appendTo(la);var I=new t(ea);oa===b.get("report","\u62a5\u8868")?I.setTitle(b.get("copySth","\u590d\u5236#1").replace("#1",b.get("report","\u62a5\u8868"))):
I.setTitle(b.get("copySth","\u590d\u5236#1").replace("#1",oa));var Sa=E[0],Ka=E[1],rb=la.prop("clientWidth");la=la.prop("clientHeight");var ob=function(){I.destroy();ea.remove()};I.setBounds(rb-Sa>>1,la-Ka>>1,Sa,Ka);I.setToolbarVisible(!1);I.setContent(Ja());I.addClosingListener(function(D,S){S?U?(S=b.get("selectSpace","\u8bf7\u9009\u62e9\u4e00\u4e2a\u534f\u4f5c\u7a7a\u95f4\u3002"),D.getMessageCurtain().showPrompt(S,2E3)):Ca(D.getMessageCurtain(),ob):ob()});I.showFooterPane();return I};var Ja=function(){var la=
$("<div>"),ea=new p;ea.setText(b.get("extreportName","\u540d\u79f0"));ea=ea.getJqUi();A=new ca;A.addEditedListener(function(){});var I=A.getJqUi(),Sa=new p;Sa.setText(b.get("copyTo","\u590d\u5236\u5230"));ua=Sa.getJqUi();ta=Qa(ka,la);if(ma.getCurrentSpaceType()!=lb.COLLABORATION){Sa=new p;Sa.setText(b.get("spaceType","\u7a7a\u95f4\u7c7b\u578b"));Sa=Sa.getJqUi();f=new r;f.setItemModels(vb.AllSpaceType);f.setSelected(vb.AllSpaceType[0]);f.setCustomPainter(function(rb,ob,D){ob.text(b.get(D.getI18nKey(),
D.getDefaultDesc()))});f.addSelectedChangedListener(function(rb,ob,D){q=D.getTypeID();q===vb.COLLABORATION?(za(la,q),z.layoutCtrl(ua,20,125,80,23),z.layoutCtrl(ta,110,125,240,23),qa.adjustPositionBySpaceType(!0)):(U=!1,H.hide(),ja.hide(),$a&&$a(ma.getCurrentSpaceID(),la,q,ka))});var Ka=f.getJqUi();Sa.appendTo(la);Ka.appendTo(la);z.layoutCtrl(Sa,20,45,80,23);z.layoutCtrl(Ka,110,45,240,23)}la.append(ea);la.append(I);la.append(ua);qa.protectedCustomLayout(la,ea,I,ua,ta);return la};this.protectedCustomLayout=
function(la,ea,I,Sa,Ka){z.layoutCtrl(ea,20,5,80,23);z.layoutCtrl(I,110,5,240,23);z.layoutCtrl(Sa,20,85,80,23);z.layoutCtrl(Ka,110,85,240,23);n=new N;n.setOn(!1);m=n.getJqUi();"0"==e.getExtRptType()?(ea=b.get("copyIncludedExtReports","\u540c\u65f6\u590d\u5236\u5f15\u7528\u7684\u62a5\u8868/\u6570\u636e\u96c6"),z.layoutCtrl(m,180,125,31,23)):(ea=b.get("copyOnlyIncludedDataSets","\u540c\u65f6\u590d\u5236\u5f15\u7528\u7684\u6570\u636e\u96c6"),z.layoutCtrl(m,150,125,31,23));l=(new p(ea)).getJqUi();ea=q===
vb.COLLABORATION;I=ma.getCurrentSpaceType()===vb.COLLABORATION;qa.adjustPositionBySpaceType(ea,I);I&&(z.layoutCtrl(ua,20,45,80,23),z.layoutCtrl(ta,110,45,240,23));l.appendTo(la);m.appendTo(la)};var Ba=function(la){var ea=ma.createFacade(function(I){var Sa=e.getExtReportName(),Ka=e.getExtRptType(),rb=[],ob=!1,D=I.extreportList;I=0;for(var S=D.length;I<S;I++){var Ma=Fa.createInstance(D[I]),eb=Ma.getExtReportName();Ma=Ma.getExtRptType();eb==Sa&&Ma==Ka?ob=!0:0==eb.indexOf(Sa)&&rb.push(eb)}if(ob){Ka=1;
for(I=!1;!I;){ob=!1;for(I=0;I<rb.length;I++)if(rb[I]==Sa+"_"+Ka){Ka++;ob=!0;break}I=!ob}Sa=Sa+"_"+Ka}A.setText(Sa)},function(I,Sa){return!1});ea.setShowBlocking(!0);ea.loadExtReportByGroupIDS([la])},Qa=function(la,ea){var I=la.getChildren();R=new X;var Sa=new L(I);(la=Qb.findTreeNodeByFullPath(la,C&&C.split("/")))||(la=ma.getAllGroupModel()[0]);R.setSelectedModel(la);R.setCustomPainter(function(Ka,rb){Ka=Qb.buildCategoryFullPath(Ka,"","/");rb.text(Ka);rb.attr("title",Ka)});R.setDropdownCreator(function(Ka,
rb,ob){return Sa.createJqPopup(Ka,rb,ob)});R.addSelectionListener(function(Ka,rb){rb&&Ba(Ka.getSelectedModel().getUserObject().getExtReportGroupID())});Ba(la.getUserObject().getExtReportGroupID());ta=R.getJqUi();ea.append(ta);return ta},za=function(la,ea){var I=V.getFacadeInstance(function(Sa){Sa=Z.buildSpaceTreeNode(Sa);var Ka=[];0<Sa.getChildren().length&&(0<Sa.getChildren()[0].getChildren().length&&(Ka=Sa.getChildren()[0].getChildren()),0==Ka.length&&0<Sa.getChildren()[1].getChildren().length&&
(Ka=Sa.getChildren()[1].getChildren()));var rb=new p;rb.setText(b.get("spaceName","\u7a7a\u95f4\u540d\u79f0"));H=rb.getJqUi();H.appendTo(la);if(0==Ka.length)U=!0,F=new ca,F.setEnabled(!1),F.setText(b.get("notJoinSpace","\u60a8\u6682\u672a\u52a0\u5165\u4efb\u4f55\u534f\u4f5c\u7a7a\u95f4")),ja=F.getJqUi(),ja.appendTo(la),z.layoutCtrl(H,20,85,80,23),z.layoutCtrl(ja,110,85,240,23),ta.remove(),R=Z.createEmptyBox(),ta=R.getJqUi(),ta.appendTo(la),z.layoutCtrl(ta,110,125,240,23);else{Ka=Ka[0];F=new X;var ob=
new wa(Sa.getChildren(),la);ob.setFunSelectedSpaceListener($a);F.setSelectedModel(Ka);F.setCustomPainter(function(D,S){D=D.getName();S.text(D);S.attr("title",D)});F.setDropdownCreator(function(D,S,Ma){return ob.createJqPopup(D,S,Ma)});ja=F.getJqUi();ja.appendTo(la);z.layoutCtrl(H,20,85,80,23);z.layoutCtrl(ja,110,85,240,23);Sa=Ka.getUserObject().getSpaceID();$a&&$a(Sa,la,ea)}},function(Sa,Ka){return!1});I.setShowBlocking(!0);I.loadCollaborationSpaces("FCREATETIME",!1,ea)},$a=function(la,ea,I,Sa){Sa?
fb(Sa,ea,I):(Sa=ma.createFacade(function(Ka){Ka=Ka.extreportGroupList;for(var rb=new db,ob=0;ob<Ka.length;ob++){var D=new db,S=new Ga;S.fromJsonObject(Ka[ob]);D.setExpanded(!1);D.setUserObject(S);D.setLevel(0);D.fromJsonObject(Ka[ob]);D.setName(S.getExtReportGroupName());rb.addChild(D)}fb(rb,ea,I)},function(Ka,rb){return!1}),Sa.setShowBlocking(!0),Sa.getExtReportGroupList(la))},fb=function(la,ea,I){ta.remove();C=la.getChildren()[0].getUserObject().getExtReportGroupName();ta=Qa(la,ea);I==vb.COLLABORATION?
z.layoutCtrl(ta,110,125,240,23):(z.layoutCtrl(ta,110,85,240,23),z.layoutCtrl(ua,20,85,80,23));qa.adjustPositionBySpaceType(I==vb.COLLABORATION)},Ca=function(la,ea){var I=R.getSelectedModel().getUserObject().getExtReportGroupID(),Sa=e.getExtRptType(),Ka=$.trim(A.getText()),rb=Ib(Ka);if(rb)la.showPrompt(rb,2E3);else{rb=ma.createFacade(function(eb){for(var mb=0,Eb=Y.length;mb<Eb;mb++){var Gb=Y[mb];Gb&&Gb(eb,ma.getCurrentSpaceType()===q)}ea()},function(eb,mb){var Eb=eb.toString();if(8099001==eb||8099002==
eb)return la.showPrompt(mb,2E3),!0;if("80"==Eb.substr(0,2)&&7==Eb.length){var Gb;8010001==eb&&"0"==Sa?Gb=b.get("duplicateNameExtReportInCategory","\u5b58\u5728\u540c\u540d\u62a5\u8868\u3002"):8010001==eb&&"1"==Sa?Gb=b.get("duplicateNameDataSetInCategory","\u5b58\u5728\u540c\u540d\u6570\u636e\u96c6\u3002"):8010005==eb&&(Gb=b.get("RefrenceCirCle","\u5b58\u5728\u5faa\u73af\u5f15\u7528\u3002"));la.showPrompt(Gb,2E3);return!0}return!1});rb.setShowBlocking(!0);var ob=e.getExtReportID(),D=n&&n.isOn(),S=
ma.getCurrentSpaceID(),Ma=F&&F.getSelectedModel().getUserObject().getSpaceID();Ma?rb.copyExtReport(ob,I,Ka,e.getExtRptType(),e.getDataSetType(),D,S,Ma):rb.copyExtReport(ob,I,Ka,e.getExtRptType(),e.getDataSetType(),D,S,S)}},Ib=function(la){var ea;""!=la&&50<la.length?ea=b.get("nameTooLong","\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):""==la?ea=oa===b.get("extreport","\u8f7b\u62a5\u8868")?b.get("nameCannotBeEmpty","\u8bf7\u8f93\u5165#1\u540d\u79f0\u3002").replace("#1",
b.get("report","\u62a5\u8868")):b.get("nameCannotBeEmpty","\u8bf7\u8f93\u5165#1\u540d\u79f0\u3002").replace("#1",oa):Pb.isValidString(la)?Pb.isKeywords(la)&&(ea=b.get("isKeywords",'\u65e0\u6cd5\u4f7f\u7528"#1"\u4f5c\u4e3a\u540d\u79f0\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u3002').replace("#1",la)):ea=b.get("invalidName","\u540d\u79f0\u53ea\u80fd\u7531\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210,\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\u3002");return ea};
this.adjustPositionBySpaceType=function(la,ea){ea=ea?85:la?162:125;"0"==e.getExtRptType()?z.layoutCtrl(m,180,ea,31,23):z.layoutCtrl(m,150,ea,31,23);la||ma.getCurrentSpaceType()==lb.PRESET?n.setOn(!0):n.setOn(!1);z.layoutCtrl(l,20,ea,150,23);"en"==G.getUrlParamValue("language")&&(z.layoutCtrl(l,20,ea,220,23),"0"==e.getExtRptType()?z.layoutCtrl(m,240,ea,31,23):z.layoutCtrl(m,180,ea,31,23))}}function L(e){var ka,qa;this.createJqPopup=function(n,m,l){ka=l;var f=new Ua;f.setRootVisible(!1);f.setNodePainter(A);
f.setRoot(ma(e));f.addSelectingListener(R);f.getRoot().setExpanded(!0);f.getRoot().setSelectable(!1);f.setLineHeight(30);f.getJqUi().addClass("extreport-move-copy-path-prompt");E(f,m,f.getRoot().getAllChildren());f.setSelecteds([qa]);setTimeout(function(){f.scrollSelectedToVisible()},0);f.getJqUi().appendTo(n);return[-1,Math.min(30*e.length,162)]};var E=function(n,m,l){for(var f=0;f<l.length;f++){var q=l[f];q instanceof Ua.BranchNode&&E(n,m,q.getAllChildren());if(m.getUserObject().getExtReportGroupID()===
q.getUserObject().getUserObject().getExtReportGroupID()){n.expandToNode(q,!0);qa=q;break}}},A=function(n,m){m=m.getUserObject().getUserObject().getExtReportGroupName();n.css("width","calc(100% - 30px)");n.css("padding-left","4px");n.css("padding-right","4px");n.text(m);n.attr("title",m)},R=function(n,m){ka(m.getUserObject())},ma=function(n){var m=new Ga,l=new db;l.setUserObject(m);m=Y(l);C(m,n);return m},Y=function(n){var m=new Ua.BranchNode;m.setUserObject(n);return m},oa=function(n){var m=new Ua.LeafNode;
m.setUserObject(n);return m},C=function(n,m){if(m&&0!==m.length)for(var l=0;l<m.length;l++){var f=m[l];if(f instanceof db){var q=f.getChildren();q&&0<q.length?(f=Y(f),C(f,q),n.addChild(f)):(q=oa(f),n.addChild(q))}else q=oa(f),n.addChild(q)}}}function wa(e,ka){var qa,E,A;this.setFunSelectedSpaceListener=function(l){A=l};this.createJqPopup=function(l,f,q){qa=q;var H=new Ua;H.setRootVisible(!1);H.setNodePainter(ma);H.setRoot(oa(e));H.addSelectingListener(Y);H.getRoot().setExpanded(!0);H.getRoot().setSelectable(!1);
H.setLineHeight(30);H.getJqUi().addClass("extreport-move-copy-path-prompt");R(H,f,H.getRoot().getAllChildren());H.setSelecteds([E]);setTimeout(function(){H.scrollSelectedToVisible()},0);H.getJqUi().appendTo(l);return[-1,Math.min(30*e.length,162)]};var R=function(l,f,q){for(var H=0;H<q.length;H++){var F=q[H];F instanceof Ua.BranchNode&&R(l,f,F.getAllChildren());if(f.getName()===F.getUserObject().getName()){l.expandToNode(F,!0);E=F;break}}},ma=function(l,f){f=f.getUserObject().getName();l.css("width",
"calc(100% - 30px)");l.css("padding-left","4px");l.css("padding-right","4px");l.text(f);l.attr("title",f)},Y=function(l,f){f.isLeafNode()?(qa(f.getUserObject()),l=f.getUserObject().getUserObject().getSpaceID(),f=f.getUserObject().getUserObject().getSpaceType(),A&&A(l,ka,f)):(f.setExpanded(!f.isExpanded()),l.refresh(f,!1))},oa=function(l){var f=new wb,q=new db;q.setUserObject(f);f=C(q);m(f,l);return f},C=function(l){var f=new Ua.BranchNode;f.setUserObject(l);return f},n=function(l){var f=new Ua.LeafNode;
f.setUserObject(l);return f},m=function(l,f){if(f&&0!==f.length)for(var q=0;q<f.length;q++){var H=f[q];if(H instanceof db){var F=H.getChildren();F&&0<F.length?(H=C(H),m(H,F),l.addChild(H)):(F=n(H),l.addChild(F))}else F=n(H),l.addChild(F)}}}function M(){var e,ka,qa=!0;this.getJqUi=function(){e||E();return e};this.setClickListener=function(A){ka=A};this.setCardView=function(A){qa=A};this.isCardView=function(){return qa};var E=function(){e=$("<div class='toolbar-extreport-view-switch'>");var A=$("<div class='extreport-card-view-icon'>");
La.background(A,"card-view-on");A.attr("title",b.get("cardView","\u5361\u7247\u89c6\u56fe"));A.appendTo(e);var R=$("<div class='extreport-list-view-icon'>");La.background(R,"list-view");R.attr("title",b.get("listView","\u5217\u8868\u89c6\u56fe"));R.appendTo(e);$("<div class='deploy-button-split-line'>").appendTo(e);R.on("click",function(){La.background(A,"card-view");La.background(R,"list-view-on");ka(!1)});A.on("click",function(){La.background(A,"card-view-on");La.background(R,"list-view");ka(!0)});
return e}}function Da(e){function ka(h){KTDefaultCellRender.call(this,h);var u=this,ba=new Ab;ba.setFontSize(12);var ra,Ha,Za;this.setFunMoveUpCategorySuccessCallback=function(J){ra=J};this.setFunDeleteCategorySuccessCallback=function(J){Ha=J};this.setFunAddCategorySuccessCallback=function(J){Za=J};this.paintCellUI=function(J,a){var c=u.getCurrentRowIdx(),d=u.getCell().getValue(),k=d.getUserObject().getExtReportGroupName(),B=d.getUserObject().getExtReportGroupID(),xa=$(J);xa.addClass("extreport-category-cell-item");
var sa=$("<span>");sa.addClass("extreport-category-list-item");sa.attr("title",k);var hb=$a;hb&&k?(ma||(ma=new Rb),ma.doHighLightText(sa,k,hb)):sa.text(k);$(J).on("click",{cellNode:d},Tb);l&&l.getExtReportGroupID()==B&&xa.addClass("extreport-category-cell-item-selected");d.getUserObject().isPreset()?(J=ba.measureWidth(b.get("preset","\u9884\u7f6e"))+5,z.layoutCtrl(sa,J,8,null,null)):z.layoutCtrl(sa,10,8,null,null);Ja[B]=xa;$(a).append(sa);$a||Ub(a,d,c)};var zb=function(J,a,c,d){var k=c.getUserObject(),
B=a.find(".extreport-category-list-item")[0],xa=$(B),sa=J.getText();sa=sa.trim();var hb=sa.length;if(sa)for(var Fb=RegExp("/"),Cb=0;Cb<hb;Cb++)if(Fb.test(sa.substr(Cb,1))){c=b.get("categoryNameCanNotDiagonalSymbol",'\u540d\u79f0\u4e0d\u80fd\u5305\u542b "/" \u5b57\u7b26\u3002');A.getMessageCurtain().showPrompt(c,2E3);Wb(a);return}k.getExtReportGroupID()&&(k.getExtReportGroupName()==sa||!sa||50<hb)?(J.getJqUi().hide(),xa.show(),50<hb&&(c=b.get("CategoryNameCanNotExceedLimit","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),
A.getMessageCurtain().showPrompt(c,2E3)),Wb(a)):sa?50<hb?(c=b.get("CategoryNameCanNotExceedLimit","\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"),A.getMessageCurtain().showPrompt(c,2E3),a=C.getRowIndex(za[k.getExtReportGroupID()]),C.removeRow(a),ea(d.getUserObject().getExtReportGroupName())):(Wb(a),l=k,Zb(J,B,k)):(a=C.getRowIndex(za[k.getExtReportGroupID()]),C.removeRow(a),delete za[k.getExtReportGroupID()],Ba.splice(Ba.indexOf(c),1),k=c.getParent()?c.getParent().getChildren():Y.getChildren(),
k.splice(k.indexOf(c),1),ea(d.getUserObject().getExtReportGroupName()))},Wb=function(J){$(".extreport-category-cell-item-selected").removeClass("extreport-category-cell-item-selected");J.addClass("extreport-category-cell-item-selected")},Zb=function(J,a,c){var d=new Ga;d.setExtReportGroupID(c.getExtReportGroupID());d.setExtReportGroupName(J.getText().trim());d.setOrderID(c.getOrderID());d.setParentID(c.getParentID());var k=A.createFacade(function(B){var xa=c.getExtReportGroupID();if(!xa){var sa=za[c.getExtReportGroupID()];
delete za[c.getExtReportGroupID()];za[B]=sa}Nb(B,J,a,c);xa||Za(c);B=xa?b.get("editCategorySuccess","\u4fee\u6539\u76ee\u5f55\u6210\u529f\u3002"):b.get("addCategorySuccess","\u65b0\u589e\u76ee\u5f55\u6210\u529f\u3002");A.getMessageCurtain().showSuccess(B,2E3)},function(B,xa){return 8010002==B?(B=b.get("extreportGroupNameHasExist","\u8be5\u76ee\u5f55\u540d\u79f0\u5df2\u5b58\u5728\u3002"),A.getMessageCurtain().showPrompt(B,2E3),J.requestFocus(),!0):!1});k.setShowBlocking(!0);c.getExtReportGroupID()?
k.saveExtReportGroup(d,A.getCurrentSpaceID()):k.editExtReportGroup(d,A.getCurrentSpaceID())},Nb=function(J,a,c,d){var k=a.getText();k=k.trim();c=$(c);c.text(k);c.attr("title",k);a.setText(k);a.getJqUi().hide();c.show();d.getExtReportGroupID()||d.setExtReportGroupID(J);d.setExtReportGroupName(a.getText().trim());Ba.filter(function(B){return B.getUserObject().getExtReportGroupID()==d.getExtReportGroupID()})[0].setName(d.getExtReportGroupName())},K=function(J,a){var c=$(J.currentTarget);if((J=c.data("menu"))&&
J.isShowing())c.data("menu",null),J.hide();else{var d=new ab;d.addItemModel(Ea(b.get("addSameLevelCategory","\u65b0\u5efa\u540c\u7ea7\u76ee\u5f55"),cb,a));d.addItemModel(Ea(b.get("addSubLevelCategory","\u65b0\u5efa\u5b50\u7ea7\u76ee\u5f55"),pb,a));d.addItemModel(Ea(b.get("editExtReportCategory","\u91cd\u547d\u540d"),ub,a));d.addItemModel(Ea(b.get("deleteExtReportCategory","\u5220\u9664"),Vb,a));J=new aa;J.setModel(d);J.setHideListener(function(){c.data("menu",null)});c.data("menu",J);a=c.outerHeight();
d=$(".extreport-manage");var k=[0,a];k=z.upwardCoordinate(c[0],k,d[0]);J.show(d,k[0],k[1],c,!0,[0,-a])}},Ea=function(J,a,c){J=aa.createActionMenuItem(J,a);J.setUserObject(c);return J},cb=function(J){J=J.getUserObject();var a=Va(J,"ADD_CURRENT");bb.refresh(C);var c=Ja[a.getUserObject().getExtReportGroupID()],d=c.children()[0];Lb(c,d,a,J)},Va=function(J,a){var c=J.getUserObject(),d=Y.getChildren();d=J.getParent()?J.getParent().getChildren():d;if("ADD_CURRENT"==a){var k=J.getParent();k?(k=Qb.calcNodeChildrenSize(k),
d=Ba.indexOf(d[0])+k):d=Ba.length}else"ADD_SUB"==a?(d=J.getChildren())&&0<d.length?(k=Qb.calcNodeChildrenSize(J),d=Ba.indexOf(J)+k+1):d=Ba.indexOf(J)+1:d=void 0;k=new db;var B=new Ga;"ADD_CURRENT"==a?(a=J.getParent(),B.setParentID(c.getParentID()?c.getParentID():""),k.setParent(a),a?a.addChild(k):Y.addChild(k),k.setLevel(J.getLevel())):"ADD_SUB"==a&&(B.setParentID(c.getExtReportGroupID()),k.setParent(J),J.addChild(k),k.setLevel(J.getLevel()+1));B.setSpaceID(c.getSpaceID());k.setExpanded(!1);k.setUserObject(B);
k.setName(B.getExtReportGroupName());J=C.insertRow(d);J.setHeight(35);c=J.getCell(0);c.setValue(k);a=new KTCellTreeModel(k.getLevel());a.setExpanded(k.isExpanded());c.setTreeModel(a);za[k.getUserObject().getExtReportGroupID()]||(za[k.getUserObject().getExtReportGroupID()]=J);Ba.splice(d,0,k);return k},pb=function(J){J=J.getUserObject();if(3==J.getLevel())J=b.get("theMaxCategoryLevel","\u6700\u591a\u53ef\u652f\u63014\u7ea7\u76ee\u5f55\uff0c\u5f53\u524d\u76ee\u5f55\u4e3a\u7b2c4\u7ea7\u76ee\u5f55\uff0c\u65e0\u6cd5\u65b0\u589e\u4e0b\u7ea7\u76ee\u5f55\u3002"),
A.getMessageCurtain().showPrompt(J,2E3);else{var a=Va(J,"ADD_SUB");l=a.getUserObject();bb.refresh(C);var c=$(".extreport-category-cell-item-selected");c.removeClass("extreport-category-cell-item-selected");var d=c.children()[0];Lb(c,d,a,J)}},ub=function(J){J=J.getUserObject();var a=$(".extreport-category-cell-item-selected");a.removeClass("extreport-category-cell-item-selected");var c=J.getChildren()&&0<J.getChildren().length?a.children()[1]:a.children()[0];var d=a.find(".extreport-category-list-item")[0];
$(d).hide();Lb(a,c,J)},Lb=function(J,a,c,d){var k=c.getUserObject(),B=new ca;B.setEnabled(!0);B.addBlurListener(function(){zb(B,J,c,d)});var xa=B.getJqUi();xa.addClass("extreport-category-name-editting");xa.show();xa.on("click",function(sa){sa.stopPropagation()});xa.on("keydown",function(sa){13==(sa.keyCode||sa.which||sa.charCode)&&zb(B,J,c,d)});xa.appendTo(a);B.setText(k?k.getExtReportGroupName():"");B.requestFocus()},Vb=function(J){J=J.getUserObject();J.getUserObject().getExtReportGroupID()&&Xb(J)},
Xb=function(J){var a=J.getUserObject().getExtReportGroupID(),c=A.createFacade(function(d){(d=d.extreportList)&&0<d.length?(d=b.get("deleteExtReportBeforeExtReportGroup","\u8bf7\u5148\u5220\u9664\u76ee\u5f55\u4e0b\u7684\u62a5\u8868\u3001\u6570\u636e\u96c6\u518d\u5220\u9664\u76ee\u5f55\u3002"),A.getMessageCurtain().showPrompt(d,2E3)):1==A.getAllGroupModel().length?(d=b.get("atLeastNeedOneUserExtReportGroup","\u81f3\u5c11\u9700\u8981\u4fdd\u7559\u4e00\u4e2a\u76ee\u5f55\u3002"),A.getMessageCurtain().showPrompt(d,
2E3)):cc(J)},function(d,k){return!1});c.setShowBlocking(!0);c.loadExtReportByGroupIDS([a])},cc=function(J){var a=x.createFeedbackDialog();a.setOptionType(x.OPTION_OK_CANCEL);a.setMsgImageType(x.MSG_DELETE);a.setMessage(b.get("confirmToDeleteCategory","\u786e\u5b9a\u8981\u5220\u9664\u76ee\u5f55'#1'\u5417\uff1f").replace("#1",J.getUserObject().getExtReportGroupName()));a.setClosingChecker(function(c){c==x.RETURN_OK&&dc(J);return!0});a.showDialog()},dc=function(J){var a=J.getUserObject().getExtReportGroupID();
if(J.getChildren()&&0<J.getChildren().length)a=b.get("deleteCategoryFirst","\u8bf7\u5148\u5220\u9664\u76ee\u5f55\u4e0b\u7684\u5b50\u76ee\u5f55\u518d\u5220\u9664\u76ee\u5f55\u3002"),A.getMessageCurtain().showPrompt(a,2E3);else{var c=A.createFacade(function(d){Ha(J);d=b.get("deleteExtReportGroupSuccess","\u5220\u9664\u76ee\u5f55\u6210\u529f\u3002");A.getMessageCurtain().showSuccess(d,2E3)},function(d,k){return 8010003==d?(d=b.get("deleteExtReportBeforeExtReportGroup","\u8bf7\u5148\u5220\u9664\u76ee\u5f55\u4e0b\u7684\u62a5\u8868\u518d\u5220\u9664\u76ee\u5f55\u3002"),
A.getMessageCurtain().showPrompt(d,2E3),!0):!1});c.setShowBlocking(!0);c.deleteExtReportGroupByGroupID(a)}},Ub=function(J,a,c){var d=$(J);if(a.getUserObject().isPreset())bc(d);else{c=0!=c;if(a.getParent()){var k=a.getParent().getChildren()[0].getUserObject().getExtReportGroupID();c=c&&a.getUserObject().getExtReportGroupID()!==k}var B=$("<span>");c&&(B.addClass("moveup-button"),B.attr("title",b.get("moveupCategory","\u4e0a\u79fb\u76ee\u5f55")),B.on("click",function(){ra(a,J)}),La.background(B,"icon-order-up"),
B.appendTo(d));var xa=$("<span>");xa.addClass("group-operation-button");xa.attr("title",b.get("moreOperations","\u66f4\u591a\u64cd\u4f5c"));xa.on("mousedown",function(sa){K(sa,a)});La.background(xa,"menu");xa.appendTo(d);d.on("mouseenter",function(){var sa=d.find(".extreport-category-list-item");sa&&0<sa.length&&$(sa[0]).css("right","50px");l.getExtReportGroupName()===a.getUserObject().getExtReportGroupName()?(La.background(B,"icon-order-up_hover"),La.background(xa,"menu_hover")):(La.background(B,
"icon-order-up"),La.background(xa,"menu"))});d.on("mouseleave",function(){var sa=d.find(".extreport-category-list-item");sa&&0<sa.length&&$(sa[0]).css("right","10px")});d.on("mouseup",function(){La.background(B,"icon-order-up_hover");La.background(xa,"menu_hover")})}},bc=function(J){var a=$("<div>");a.text(b.get("preset","\u9884\u7f6e"));a.addClass("extreport-category-dir-preset");a.appendTo(J)},Tb=function(J){for(var a=$(J.currentTarget),c=$(".extreport-category-cell-item-selected"),d=0;d<c.length;d++)c.eq(d).removeClass("extreport-category-cell-item-selected"),
c.eq(d).find(".extreport-category-lower-triangle").css("border-top-color","#bbbbbb"),c.eq(d).find(".extreport-category-right-triangle").css("border-left-color","#bbbbbb");a.addClass("extreport-category-cell-item-selected");(c=$(".extreport-category-dir-preset_selected"))&&c.removeClass("extreport-category-dir-preset_selected");(c=a.find(".extreport-category-dir-preset"))&&c.addClass("extreport-category-dir-preset_selected");a.find(".extreport-category-lower-triangle").css("border-top-color","#ffffff");
a.find(".extreport-category-right-triangle").css("border-left-color","#ffffff");l=J=J.data.cellNode.getUserObject();A.fireEvent(y.UPDATE_CURRENT_CATEGORY,J);Ca&&Ca(J);A.isCardView()?A.fireEvent(y.UPDATE_CARD_CONTAINER,{model:J,unloadGroupId:Qa}):A.fireEvent(y.UPDATE_LIST_CONTAINER,{model:J,unloadGroupId:Qa})}}function qa(h){KTDefaultTreeHandlerRender.call(this,h);var u=this;this.create=function(ba,ra,Ha,Za,zb,Wb,Zb){var Nb=20*ba.getLevel()+15;var K=Nb+17;var Ea=null;if(u.protectedMethod.isTreeNodeHasChildren(ba,
ra,Ha)||ba.isHaveHandlerAlways())Ea=u.protectedMethod.createAbsoluteHtmlElement("div",Nb,zb,17,Zb),Ea.style.cursor="pointer",Nb=$(Ea),Nb.addClass("tree-handler-icon"),Ha=$("<div>"),Ha.addClass("tree-handler-triangle-icon"),Nb.append(Ha),ba.isExpanded()?(Ha.addClass("extreport-category-lower-triangle"),Nb.css("left",20*ba.getLevel()+22+"px"),Ha.removeClass("extreport-category-right-triangle")):(Ha.addClass("extreport-category-right-triangle"),Nb.css("left",20*ba.getLevel()+15+"px"),Ha.removeClass("extreport-category-lower-triangle")),
Nb=za[l&&l.getExtReportGroupID()],Nb=h.getRowIndex(Nb),ra===Nb&&(ba.isExpanded()?Ha.css("border-top-color","#ffffff"):Ha.css("border-left-color","#ffffff"));Ea=[Ea,K,zb,null];ba=Ea[0];ra=Ea[1];K=Ea[2];Ea=Ea[3];Za=u.protectedMethod.createAbsoluteHtmlElement("span",ra,K,Za+Wb-ra,zb+Zb-K);return[ba,Za,Ea]}}var E=this,A=e,R,ma,Y,oa,C,n,m,l,f=!1,q,H,F,ja,ta,ua,U=[],Ja={},Ba=[],Qa=[],za={},$a,fb,Ca;this.setFunUpdateCurrentExtReportGroup=function(h){Ca=h};this.setFunRefreshData=function(h){fb=h};this.getCategoryRoot=
function(){return Y};this.getPersonalCategoryRoot=function(){return oa};this.getCurrentTreeNode=function(){var h=Ba.filter(function(u){return u.getUserObject().getExtReportGroupID()==l.getExtReportGroupID()});return h&&h[0]};this.updateUi=function(h){if(C&&0!=document.body.clientHeight&&0!=document.body.clientWidth&&!f){f=!0;var u=C,ba=Ba;bb.clear(u);u.addColumns(1);var ra=u.isSyncUIWhenModelChanged();u.setSyncUIWhenModelChanged(!1);for(var Ha=0;Ha<ba.length;Ha++){var Za=ba[Ha];Za.getParent()||la(Za,
u)}u.setSyncUIWhenModelChanged(ra);ea(h);h=C;u=h.getRowIndex(za[l.getExtReportGroupID()]);h.scrollCellVisible(u,0,!1);u=h.keepScrollStatus();u.h=0;h.restoreScrollStatus(u)}};this.refresh=function(){C&&bb.refresh(C)};this.getJqUi=function(){q||(q=$("<div>"),q.addClass("extreport-group-container"),Eb(),ja=$("<div class='extreport-group-all-list' />"),ja.appendTo(q),A.addListener(y.UPDATE_CURRENT_EXTREPORT_HAS_DATA,gc),A.addListener(y.UPDATE_UNLOAD_EXTREPORT_GROUPID,kc));return q};var Ib=function(h,
u){Ba.push(h);Qa.push(h.getUserObject().getExtReportGroupID());if((h=h.getChildren())&&0<h.length)for(var ba=0;ba<h.length;ba++)Ib(h[ba],u)};this.handlerSearchResult=function(h){var u=[];if(!h||0===h.length)return u;for(var ba=Y.getChildren(),ra=0;ra<ba.length;ra++){var Ha=ba[ra].getUserObject().getExtReportGroupName(),Za=h.filter(function(zb){return zb.getGroupName().split(">")[0]===Ha});Za&&0<Za.length&&u.push(Za)}return u};var la=function(h,u){var ba=u.addRow();ba.setHeight(35);var ra=ba.getCell(0);
ra.setValue(h);var Ha=h.getLevel();Ha=new KTCellTreeModel(Ha);Ha.setExpanded(h.isExpanded());var Za=h.getParent();Za&&(Za=Za.isExpanded(),ba.setHide(!Za));if((Za=h.getChildren())&&0<Za.length)for(var zb=0;zb<Za.length;zb++)la(Za[zb],u);ra.setTreeModel(Ha);za[h.getUserObject().getExtReportGroupID()]=ba},ea=function(h){bb.refresh(C);if($a&&F.is(":visible"))I();else if(l&&h&&l.getExtReportGroupName()==h){if(h=rb(l.getExtReportGroupID()))h.getParent()&&D(h.getParent()),bb.refresh(C),h=h.getUserObject().getExtReportGroupID(),
(h=Ja[h])&&h.click()}else{h=$("#myCategoryTreeTable").find(".extreport-category-cell-item-selected");var u=$("#myCategoryTreeTable").find(".extreport-category-cell-item");h&&0<h.length?(h.removeClass("extreport-category-cell-item-selected"),h.click()):u&&0<u.length&&(h=u[0],h.click())}},I=function(){U=[];$a=n.getText().trim();var h=C;if(h){for(var u=0;u<h.getRowsCount();u++){var ba=h.getRow(u),ra=ba.getCell(0),Ha=ra.getTreeModel();ra=ra.getValue();$a?Ka(ra.getUserObject())&&!Sa(ra.getChildren(),!1)?
(ba.setHide(!1),Ha.setExpanded(!1),U.push(ra)):Ka(ra.getUserObject())&&Sa(ra.getChildren(),!1)?(ba.setHide(!1),Ha.setExpanded(!0),U.push(ra)):Sa(ra.getChildren(),!1)?(ba.setHide(!1),Ha.setExpanded(!0),U.push(ra)):ba.setHide(!0):(ba.setHide(!1),Ha.setExpanded(!0))}bb.refresh(h);if(l&&!Ka(l)){for(h=0;h<U.length;h++)if(u=U[h],Ka(u.getUserObject())){var Za=u.getUserObject();Za=Ja[Za.getExtReportGroupID()];break}$(Za).click()}}},Sa=function(h,u){if(h&&0<h.length)for(var ba=0;ba<h.length;ba++){var ra=h[ba];
if(Ka(ra.getUserObject()))return!0;ra.getChildren()&&0<ra.getChildren().length&&(u=Sa(ra.getChildren(),u))}return u},Ka=function(h){return-1!=h.getExtReportGroupName().toUpperCase().indexOf($a.toUpperCase())};this.doSelectCategoryAndScrollToCard=function(h){var u=h.getGroupID();u=rb(u);D(u);bb.refresh(C);u=u.getUserObject().getExtReportGroupID();l.getExtReportGroupID()!=u&&(u=Ja[u])&&u.click();var ba=$("#"+h.getID());ob("extreport-card-container",ba);(h=$(".extreport-card-selected"))&&0<h.length&&
h.removeClass("extreport-card-selected");h=new ec;h.setTimes(2,!0);h.blink(ba,"extreport-twinkle-high-light","extreport-card-selected");h.setAction(function(){ba.parent().children(".extreport-card-selected").removeClass("extreport-card-selected");ba.addClass("extreport-card-selected")})};var rb=function(h){var u=Ba;if((!u||0!=u.length)&&h)for(var ba in u)if(h==u[ba].getUserObject().getExtReportGroupID())return u[ba]},ob=function(h,u){document.querySelector("."+h).scrollTop=u.prop("offsetTop")},D=
function(h){var u=h.getUserObject().getExtReportGroupID();u=za[u];var ba=u.getCell(0).getTreeModel();if(u&&u.isHide()){var ra=h.getParent();D(ra)}ba.isExpanded()?u.setHide(!1):S(h)},S=function(h){za[h.getUserObject().getExtReportGroupID()].getCell(0).getTreeModel().setExpanded(!0);for(var u=0;u<h.getChildren().length;u++){var ba=h.getChildren()[u];za[ba.getUserObject().getExtReportGroupID()].setHide(!1)}},Ma=function(){var h=$("<span>");h.addClass("search-extreport-category");h.attr("title",b.get("searchCategory",
"\u641c\u7d22\u76ee\u5f55"));h.on("click",function(){F.is(":hidden")?(F.show(),n.setFoucs(),h.css("box-shadow","0 0 0 1px #5582f3"),ja.css("top","85px"),La.background(h,"search_category_hover")):(n.clear(),I(),F.hide(),h.css("box-shadow",""),ja.css("top","48px"),La.background(h,"search_category"))});La.background(h,"search_category");return h},eb=function(){var h=$("<span>");h.addClass("all_expand_extreport_category");h.attr("title",b.get("expandAllCategory","\u76ee\u5f55\u5168\u90e8\u5c55\u5f00"));
h.on("mousedown",function(){h.css("box-shadow","0 0 0 1px #5582f3");La.background(h,"all_expand_hover");if($a)for(var u=0;u<U.length;u++){var ba=U[u].getUserObject().getExtReportGroupID();ba=za[ba];ba.setHide(!1);ba=ba.getCell(0).getTreeModel();ba.setExpanded(!0)}else for(u=0;u<C.getRowsCount();u++)ba=C.getRow(u),ba.setHide(!1),ba=ba.getCell(0).getTreeModel(),ba.setExpanded(!0);bb.refresh(C)});h.on("mouseup",function(){h.css("box-shadow","");La.background(h,"all_expand")});La.background(h,"all_expand");
return h},mb=function(){var h=$("<span>");h.addClass("all_collapse_extreport_category");h.attr("title",b.get("collapseAllCategory","\u76ee\u5f55\u5168\u90e8\u6536\u8d77"));h.on("mousedown",function(){h.css("box-shadow","0 0 0 1px #5582f3");La.background(h,"all_collapse_hover");for(var u=0;u<C.getRowsCount();u++){var ba=C.getRow(u),ra=ba.getCell(0),Ha=ra.getTreeModel();ra.getValue().getParent()&&ba.setHide(!0);Ha.setExpanded(!1)}bb.refresh(C)});h.on("mouseup",function(){h.css("box-shadow","");La.background(h,
"all_collapse")});La.background(h,"all_collapse");return h},Eb=function(){n?F.css("display","block"):(n=new tb,n.setSearchListenerDelay(1E3),n.addSearchListener(I),n.setAlwaysShowCleanIcon(!0),n.setShowSearchIcon(!0),n.setPlaceholder(b.get("searchCategory","\u641c\u7d22\u76ee\u5f55")),F=n.getJqUi(),F.addClass("extreport-search-category-box"),F.find(":input").on("keydown",function(h){13==(h.keyCode||h.which||h.charCode)&&I()}),F.find(".sa-ctrl-searchbox-close").on("click",function(){$a="";I();ta&&
ta.click()}),F.hide(),F.appendTo(q))},Gb=function(h,u){var ba=$(u),ra=ba.prev(),Ha=h.getUserObject();u=Y.getChildren();var Za=h.getParent()?h.getParent().getChildren():u;for(u=0;u<Za.length;u++)if(h.getName()===Za[u].getName()&&0!==u){var zb=Za[u];Za[u]=Za[u-1];Za[u-1]=zb;break}zb=[];u=0;for(var Wb=Za.length;u<Wb;u++){var Zb=Za[u].getUserObject();Zb.setOrderID(Wb-u);zb.push(Zb.toJsonObject())}0<zb.length&&Ob(zb,function(){1==Za.indexOf(h)&&(ra.children(".moveup-button").css("display",""),ba.children(".moveup-button").css("display",
"none"));Ha.getExtReportGroupName()!==l.getExtReportGroupName()&&(Ja[Ha.getExtReportGroupID()].removeClass("extreport-category-cell-item-selected"),l=Ha);fb&&fb(l.getExtReportGroupName(),l.getExtReportGroupID(),l.getSpaceID())})},Ob=function(h,u){u=A.createFacade(u,function(){});u.setShowBlocking(!1);u.saveOrderExtReportGroup(h)},ac=function(h){var u=h.getUserObject().getExtReportGroupID(),ba=Y.getChildren();ba=h.getParent()?h.getParent().getChildren():ba;for(var ra=0,Ha=0;Ha<ba.length;Ha++)if(u==
ba[Ha].getUserObject().getExtReportGroupID()){ba.splice(Ha,1);ra=Ha;h.getParent()?h.getParent().setChildren(ba):Y.setChildren(ba);break}l&&l.getExtReportGroupID()!=u||(u=h.getUserObject().getExtReportGroupID(),Ha=C.getRowIndex(za[u]),C.removeRow(Ha),delete za[u],Ba.splice(Ba.indexOf(h),1),delete Ja[u],ba&&0<ba.length?(h=ba[0>--ra?0:ra],h=Ja[h.getUserObject().getExtReportGroupID()],$(h).click()):h.getParent()?(h=h.getParent().getUserObject(),h=Ja[h.getExtReportGroupID()],$(h).click()):l=null,bb.refresh(C))},
jc=function(h){var u=rb(h.getExtReportGroupID());u.getParent()&&!u.isExpanded()&&(S(u.getParent()),bb.refresh(C));Ca&&Ca(h);A.fireEvent(y.UPDATE_CARD_CONTAINER,{model:h,unloadGroupId:Qa})};this.findGroupNameByGroupID=function(h,u){var ba=Ba;if(h&&ba)for(var ra in ba){var Ha=ba[ra];if(Ha.getUserObject().getExtReportGroupID()==h)return Qb.buildCategoryFullPath(Ha,"",u)}};var gc=function(h){h=h.groupId;for(var u=Ba,ba=0;ba<u.length;ba++)if(u[ba].getUserObject().getExtReportGroupID()==h){h=u[ba];h.getUserObject().setHasData(!0);
break}},kc=function(h){Qa=[]};this.filterVisibleCategoryModels=function(h){return $a?h.filter(function(u){u=u.getExtReportGroupID();return!za[u].isHide()}):h};this.updateExtReportGroupItemAfterCopied=function(h){A.fireEvent(y.UPDATE_EXTREPORT_GROUP_AFTER_COPIED,{model:h,treeData:Ba});A.isCardView()||A.fireEvent(y.UPDATE_LIST_CONTAINER,{model:l})};this.updateExtReportGroupItemAfterDeleted=function(h){A.fireEvent(y.UPDATE_EXTREPORT_GROUP_AFTER_DELETED,{deletableModel:h,categoryTreeData:Ba});A.isCardView()||
A.fireEvent(y.UPDATE_LIST_CONTAINER,{model:l})};this.updateExtReportGroupItemAfterCreated=function(h){A.fireEvent(y.UPDATE_EXTREPORT_GROUP_AFTER_CREATED,{model:h,treeData:Ba});A.isCardView()||A.fireEvent(y.UPDATE_LIST_CONTAINER,{model:l})};this.funUpdateExtReportGroupItemAfterMoved=function(h){A.fireEvent(y.UPDATE_EXTREPORT_GROUP_AFTER_MOVEED,{model:h,treeData:Ba});A.isCardView()||A.fireEvent(y.UPDATE_LIST_CONTAINER,{model:l})};this.loadExtReportByGroupIDS=function(h){A.fireEvent(y.LOAD_EXTREPORT_BY_GROUP_IDS,
{funHasData:lc,funUpdateSearch:h,unloadGroupId:Qa})};var lc=function(h){Ba.forEach(function(u){-1!=h.indexOf(u.getUserObject().getExtReportGroupID())&&u.getUserObject().setHasData(!0)})};this.getAllGroupModel=function(){for(var h=[],u=0;u<C.getRowsCount();u++){var ba=C.getRow(u).getCell(0).getValue();h.push(ba)}return h};this.loadExtReportGroupList=function(h,u,ba){Qa=[];f=!1;A.createFacade(function(ra){E.refresh();va.unsubscribeChannel("PresetSubject",oc);clearInterval(R);ua&&ua.remove();if(null==
ra)ra=b.get("createCategoryFirst","\u60a8\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u3002"),A.getMessageCurtain().showPrompt(ra,2E3);else{var Ha=ra.extreportGroupList;if(Ha&&0<Ha.length){Ba=[];za={};Ja={};Qa=[];Y=new db;for(ra=0;ra<Ha.length;ra++){var Za=new db,zb=new Ga;zb.fromJsonObject(Ha[ra]);Za.setExpanded(!1);Za.setUserObject(zb);Za.setLevel(0);Za.fromJsonObject(Ha[ra]);Za.setName(zb.getExtReportGroupName());Y.addChild(Za)}A.getCurrentSpaceType()==lb.PERSONAL&&(oa=Y);for(ra=0;ra<
Y.getChildren().length;ra++)Ha=Y.getChildren()[ra],Ib(Ha,!1);ra=$("<div>");ra.addClass("extreport-group-op");ta=Ma();ta.appendTo(ra);eb().appendTo(ra);mb().appendTo(ra);Ha=$("<span>");Ha.addClass("extreport-group-title");Ha.text(A.getCurrentSpaceCategoryDesc());H=Ha;H.appendTo(ra);ra.appendTo(q)}C||(C=new KTable,m=new ka(C),m.setFunMoveUpCategorySuccessCallback(Gb),m.setFunDeleteCategorySuccessCallback(ac),m.setFunAddCategorySuccessCallback(jc),C.setColumnFitVisibleWidth(!0),C.setSyncUIWhenModelChanged(!1),
C.setCellRender(m),C.setTreeHandlerRender(new qa(C)),C.setScrollerVisible("hidden"));ra=$(C.getUI());ra.attr("id","myCategoryTreeTable");z.layoutCtrlWithLRTB(ra,0,0,null,0,0,null);ra.appendTo(ja);h&&!u&&(ra=Qb.findTreeNodeByFullPath(Y,h.split("/")))&&(l=ra.getUserObject());h&&(ra=h.split("/"),h=ra[ra.length-1]);E.updateUi(h)}},function(ra,Ha){return!1}).getExtReportGroupList(ba);va.subscribeChannel("PresetSubject",oc)};var oc=function(h){if(1==JSON.parse(h)){$(document.body).find(".sa-common-loading-modallayer").remove();
ua=$("<div>");ua.addClass("sa-common-loading-modallayer");z.layoutCtrl(ua,0,0,"100%","100%");h=$("<div class='extreport-manage-preset-container'>");var u=$("<div class='extreport-manage-presete-sub-container'>"),ba=$("<div class='extreport-manage-preset-big-img'>");ba.css("background-image",Ia.getIconUrl("common","htmlLoad/loading.gif"));var ra=$("<div class='tm-preset-progress-img'>");ra.css("background-image",Ia.getIconUrl("common","htmlLoad/sway.gif"));var Ha=$("<span class='extreport-manage-preset-progress-text'>"),
Za=b.get("initializing","\u8f7b\u62a5\u8868\u6b63\u5728\u6267\u884c\u670d\u52a1\u521d\u59cb\u5316\uff0c\u6839\u636e\u60a8\u7684\u7f51\u7edc\u73af\u5883\uff0c\u8fc7\u7a0b\u53ef\u80fd\u6301\u7eed\u6570\u5341\u79d2\u5230\u51e0\u5206\u949f\uff0c\u8bf7\u7a0d\u4f5c\u7b49\u5f85\u3002");Ha.text(Za);var zb=(new Date).getTime();R=setInterval(function(){var Wb=parseInt(((new Date).getTime()-zb)/1E3),Zb=parseInt(Wb/60),Nb=b.get("waitTime","\u5df2\u7b49\u5f85\uff1a");Nb=0<Zb?Nb+Zb+b.get("minute","\u5206")+(Wb-
60*Zb)+b.get("second","\u79d2\u3002"):Nb+Wb+b.get("second","\u79d2\u3002");Ha.text(Za+Nb)},1E3);u.append(ba);u.append(ra);u.append(Ha);h.append(u);h.appendTo(ua);ua.appendTo($(document.body))}}}function Ya(e){function ka(K){var Ea=this,cb;this.getTotalRows=function(){return $(".extreport-card:visible").length};this.getSelectedVisibleLen=function(){return $(".extreport-card .sa-ctrl-checkbox-checked_enabled:visible").length};this.isShowDeselectAll=function(){return this.getTotalRows()===this.getSelectedVisibleLen()};
this.getJqUi=function(){cb||(cb=$("<div>"),cb.addClass("extreport-card-container"),cb.css("height",$(document).height()-55-40-8+"px"),K.addListener(y.UPDATE_EXTREPORT_GROUP_AFTER_COPIED,Ub),K.addListener(y.UPDATE_EXTREPORT_GROUP_AFTER_DELETED,bc),K.addListener(y.UPDATE_EXTREPORT_GROUP_AFTER_CREATED,J),K.addListener(y.UPDATE_EXTREPORT_GROUP_AFTER_MOVEED,Tb),K.addListener(y.UPDATE_CARD_CONTAINER,Va),K.addListener(y.REFRESH_EXTREPORT_FUNCTION,cc));return cb};this.hide=function(){cb&&cb.hide()};this.show=
function(){cb&&cb.show()};var Va=function(a){var c=a.model;I=a.unloadGroupId;oc();q=c;a=c.getExtReportGroupID();-1<I.indexOf(a)?Ob(c):(zb(c.hasData()),ja?(ea=ea.filter(function(d){return c.getExtReportGroupID()!==d.getExtReportGroupID()}),Ob(c),ja=!ja):Ea.updateUi())};this.updateUi=function(){pb()};var pb=function(){if(q){var a=q.getExtReportGroupID(),c=lc(a);oc();var d=Ca.map(function(sa){return sa.getExtReportID()});a=[];for(var k in c){var B=c[k],xa=Lb(B);xa.appendTo(U);d&&0<d.length&&-1<d.indexOf(B.getExtReportID())&&
a.push(xa)}Ca=[];Za();for(k=0;k<a.length;k++)c=$(a[k]).find(".selected-icon"),$(c[0]).click()}};this.update=function(a){a=lc(a);ub(a)};var ub=function(a){if(a){var c=$(".extreport-card-container").find(".extreport-card"),d={},k=C&&C.isChecked();a.forEach(function(hb){d[hb.getExtReportID()]=!0});for(var B=0;B<c.length;B++){var xa=$(c[B]),sa=xa.attr("id");d[sa]?k&&!$("#"+sa+" .sa-ctrl-checkbox-checked_enabled").length?xa.hide():xa.show():xa.hide()}k||a.forEach(function(hb){$("#"+hb.getExtReportID()).length||
Lb(hb).appendTo(U)});Za()}},Lb=function(a){var c=tc.getInstance(a.getExtRptType());c.setRefreshExtReportFunction(cc);a=c.createItem(a);a.setGlobalDependence(K);a.setSelectedCardSuccessCallBack(Xb);a.setClickCardCallback(Vb);a.setOpenDetailPaneCallback(Zb);return a.getJqUi()},Vb=function(a){a=$(a.currentTarget);if(f)a=$(a).find(".selected-icon"),$(a[0]).click();else{var c=a.parent().children(".extreport-card-selected");0<c.length&&c.removeClass("extreport-card-selected");a.addClass("extreport-card-selected")}},
Xb=function(a){-1<Ca.indexOf(a)?Ca.splice(Ca.indexOf(a),1):Ca.push(a);if(!f){f=!0;Ha();a=$(".extreport-card-container").find(".extreport-card");for(var c=0;c<a.length;c++){var d=$(a[c]).find(".selected-icon");$(d[0]).show()}}Za();Sa&&Sa(f,Ca.length)},cc=function(a){-1==I.indexOf(a)&&I.push(a);for(var c=ea.length-1;0<=c;c--)a==ea[c].getExtReportGroupID()&&ea.splice(c,1);q.getExtReportGroupID()==a&&(oc(),Ob(q))};this.fireShowOnlyListener=function(){if(Ca&&0<Ca.length&&q){R.text(b.get("selectInfoDeselectAll",
"\u53d6\u6d88\u5168\u9009"));var a=q.getExtReportGroupID();a=lc(a);for(var c=0;c<a.length;c++){var d=a[c],k=d.getExtReportID();k=$("#"+k);C&&C.isChecked()&&0>Ca.indexOf(d)?k.hide():k.show()}}Za()};this.fireSelectAllListener=function(){var a=U.find(".extreport-card");R.text()===b.get("selectInfoSelectAll","\u9009\u62e9\u5168\u90e8")?(R.text(b.get("selectInfoDeselectAll","\u53d6\u6d88\u5168\u9009")),dc(a,!0)):(C.setChecked(!1),R.text(b.get("selectInfoSelectAll","\u9009\u62e9\u5168\u90e8")),dc(a,!1))};
var dc=function(a,c){if(a&&0!=a.length)for(var d=0;d<a.length;d++){var k=a[d];k&&"none"!=$(k).css("display")&&(k=$(k).find(".selected-icon"),c?($(k[0]).show(),1>$(k).find(".sa-ctrl-checkbox-checked_enabled").length&&$(k[0]).click()):0<$(k).find(".sa-ctrl-checkbox-checked_enabled").length&&$(k[0]).click())}},Ub=function(a){var c=a.treeData;a=a.model.getExtReportGroupID();for(var d,k=0;k<c.length;k++)if(c[k].getUserObject().getExtReportGroupID()==a){d=c[k];break}d.getUserObject().setHasData(!0)},bc=
function(a){var c=a.deletableModel;a=a.categoryTreeData;for(var d=[],k=Ca.length-1;0<=k;k--){d=!1;for(var B=Ca[k],xa=B.getExtReportGroupID(),sa=0;sa<c.length;sa++)if(B.getExtReportID()==c[sa].getExtReportID()){d=!0;break}sa=ea.indexOf(B);-1<sa&&d&&(ea.splice(sa,1),Ca.splice(k,1),$("#"+B.getExtReportID()).remove());d=ea.filter(function(Fb){return Fb.getExtReportGroupID()==xa})}0==Ca.length&&ra();Za();for(k=0;k<a.length;k++)if(a[k].getUserObject().getExtReportGroupID()===xa){var hb=a[k];break}0==d.length&&
(hb.getUserObject().setHasData(!1),zb(!1))},Tb=function(a){var c=a.model;a=a.treeData;for(var d=0;d<Ca.length;d++){var k=Ca[d];if(c.getExtReportID()===k.getExtReportID()){var B=k;Ca.splice(d,1);break}}d=ea.indexOf(B);-1<d&&ea.splice(d,1);ea.push(c);$("#"+B.getExtReportID()).remove();Za();var xa=c.getBeforeMovedExtReportGroupId();B=c.getExtReportGroupID();c=ea.filter(function(hb){return hb.getExtReportGroupID()==xa});for(d=0;d<a.length;d++){k=a[d];var sa=k.getUserObject().getExtReportGroupID();sa==
B?k.getUserObject().setHasData(!0):sa==xa&&0==c.length&&(k.getUserObject().setHasData(!1),zb(!1))}},J=function(a){var c=a.model;a=a.treeData;ea=[c].concat(ea);var d=Lb(c),k=$(".extreport-card-container"),B=k.find(".extreport-card");B&&B[0]?d.insertBefore(B[0]):k.append(d);K.getMessageCurtain().showSuccess(b.get("createSuccess","\u65b0\u5efa\u6210\u529f\u3002"),2E3);zb(!0);Za();c=c.getExtReportGroupID();for(d=0;d<a.length;d++)if(a[d].getUserObject().getExtReportGroupID()===c){var xa=a[d];break}xa.getUserObject().setHasData(!0)}}
function qa(K){function Ea(Na){KTDefaultCellRender.call(this,Na);var ib=this,nb=this.paintCellUI;this.paintCellUI=function(Mb,hc){var Wa=ib.getCurrentRowIdx(),Bb=ib.getCurrentRow(),$b=ib.getCurrentColIdx(),mc=Bb.getUserObject(),uc=bb.getHeadRowCount();Bb=new Kb;Bb.setFormatString("yyyy-MM-dd HH:mm:ss");if(Wa<uc)nb(Mb,hc),0==$b&&1==Wa&&(Wa=pb&&pb.isChecked(),pb=new ia,pb.setChecked(Wa),pb.addCheckedListener(function(ic,rc){if(rc){if(ic=ic.isChecked())for(var pc in a)c[pc]=1,a[pc].setChecked(ic);else for(pc in a)delete c[pc],
a[pc].setChecked(ic);d()}}),Wa=pb.getJqUi(),z.layoutCtrlCenterAlign(Wa,14),z.layoutCtrlMiddleAlign(Wa,22),Wa.appendTo(Mb));else if(0==$b){var Yb=mc.getExtReportModel(),vc=Yb.getExtReportID();Bb=new ia;Bb.addCheckedListener(function(ic,rc){if(rc){(ic=ic.isChecked())?c[vc]=1:delete c[vc];d();for(var pc in a)if(!a[pc].isChecked()){pb.setChecked(!1);return}pb.setChecked(ic)}});Wa=!1;for($b=0;$b<Ca.length;$b++)if(Yb.getExtReportID()===Ca[$b].getExtReportID()){c[Yb.getExtReportID()]=1;Wa=!0;break}Bb.setChecked(Wa);
a[Yb.getExtReportID()]=Bb;Wa=Bb.getJqUi();z.layoutCtrlCenterAlign(Wa,14);z.layoutCtrlMiddleAlign(Wa,22);Wa.appendTo(Mb)}else if(1==$b)Bb=$("<div class='list-cell-item'>"),Bb.text(Wa-uc+1),Bb.attr("title",Wa),z.layoutCtrlCenterAlign(Bb,20),Bb.appendTo(Mb);else if(2==$b)Wa=$("<div class='list-cell-item-name'>"),Yb=mc.getExtReportModel(),Wa.text(Yb.getExtReportName()),Wa.attr("title",Yb.getExtReportName()),Wa.on("click",function(){var ic=Cb(Yb)===b.get("dataSet","\u6570\u636e\u96c6")?sb.getDataSetPreviewEntrance():
sb.getExtReportPreviewEntrance();mc.openDesigner(ic)}),Wa.appendTo(Mb);else if(3==$b){Wa=$("<div class='list-cell-item'>");if(Bb=mc.getLockStatusDesc())Wa.text(Bb),Wa.attr("title",Bb);Wa.css("margin-left","10px");Wa.appendTo(Mb)}else 4==$b?(Wa=$("<div class='list-cell-item'>"),Yb=mc.getExtReportModel(),Wa.text(Yb.getDisplayTypeName()),Wa.attr("title",Yb.getDisplayTypeName()),Wa.css("margin-left","10px"),Wa.appendTo(Mb)):5==$b?(Wa=$("<div class='list-cell-item-desc'>"),Yb=mc.getExtReportModel(),Bb=
Yb.getDescription(),$b=""==Bb||null==Bb?b.get("noDescription","\u6682\u65e0\u63cf\u8ff0"):Bb,Wa.text($b),Wa.attr("title",Bb),Wa.appendTo(Mb)):6==$b?(Wa=$("<div>"),Yb=mc.getExtReportModel(),Bb=Bb.format(Yb.getFormatCreateTime()),Wa.text(Bb),Wa.attr("title",Bb),z.layoutCtrlCenterAlign(Wa,120),z.layoutCtrlMiddleAlign(Wa,22),Wa.appendTo(Mb)):7==$b?(Wa=$("<div>"),Yb=mc.getExtReportModel(),Bb=Bb.format(Yb.getFormatModifyTime()),Wa.text(Bb),Wa.attr("title",Bb),z.layoutCtrlCenterAlign(Wa,120),z.layoutCtrlMiddleAlign(Wa,
22),Wa.appendTo(Mb)):8==$b&&(Wa=$("<div class='list-cell-item'>"),z.layoutCtrlCenterAlign(Wa,150),z.layoutCtrlMiddleAlign(Wa,22),Wa.append(mc.getJqUi()),Wa.appendTo(Mb));nb(Mb,hc)}}var cb=this,Va,pb,ub,Lb,Vb=new wc,Xb,cc=1,dc=Vb.getPageSize(),Ub=[],bc=[],Tb,J,a={},c={};this.setArrHeadRowMap=function(Na){J=Na};this.getTotalRows=function(){return Tb};this.isShowDeselectAll=function(){for(var Na=!0,ib=Object.keys(a),nb=0;nb<ib.length;nb++)Na=Na&&a[ib[nb]].isChecked();return Na&&Ca.length===Tb};this.fireShowOnlyListener=
function(){Ca&&0<Ca.length&&q&&(cc=1,dc=Vb.getPageSize(),C.isChecked()?(Tb=Ca.length,bc=sa(cc,dc,Ca)):(Ub=lc(q.getExtReportGroupID()),Tb=Ub.length,bc=sa(cc,dc,Ub)),Vb.resetPaginationAndJumpToFirstPage(Tb),hb())};this.fireSelectAllListener=function(){var Na=!0;if(R.text()===b.get("selectInfoSelectAll","\u9009\u62e9\u5168\u90e8")){R.text(b.get("selectInfoDeselectAll","\u53d6\u6d88\u5168\u9009"));for(var ib=0;ib<Ub.length;ib++)c[Ub[ib].getExtReportID()]=1}else for(Na=!1,C.setChecked(!1),R.text(b.get("selectInfoSelectAll",
"\u9009\u62e9\u5168\u90e8")),ib=0;ib<Ub.length;ib++)c={};pb.setChecked(Na);for(var nb in a)a[nb].setChecked(Na);d()};var d=function(){for(var Na=Object.keys(c),ib=0;ib<Ub.length;ib++){var nb=Ub[ib],Mb=Ca.indexOf(nb);-1<Na.indexOf(nb.getExtReportID())&&0>Mb?Ca.push(nb):0>Na.indexOf(nb.getExtReportID())&&-1<Mb&&Ca.splice(Mb,1)}Za();Sa&&Sa(0<Ca.length,Ca.length)};this.getJqUi=function(){Va||(Va=$("<div>"),Va.addClass("extreport-list-container"),Va.css("height",$(document).height()-45-40+"px"),Va.hide(),
k(),K.addListener(y.UPDATE_LIST_CONTAINER,B));return Va};this.hide=function(){Va&&Va.hide();Xb&&Xb.hide()};this.show=function(){Va&&Va.show();Xb&&Xb.show()};this.updateUi=function(){xa()};var k=function(){Vb.setJumpToPageListener(function(Na,ib,nb){cc=Na;dc=ib;bc=sa(cc,dc,Ub);C.isChecked()&&(bc=sa(cc,dc,Ca));hb();nb?nb(Tb):Vb.refreshPagination()});Vb.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);Xb=Vb.getJqUi();Xb.css({right:"75px",top:"4px",width:"55%"});Xb.hide();ua.append(Xb)},
B=function(Na){var ib=Na.model;I=Na.unloadGroupId;q=ib;Na=ib.getExtReportGroupID();I&&-1<I.indexOf(Na)?Ob(ib):(zb(ib.hasData()),cb.updateUi(),ra(),Za())},xa=function(){Ub=lc(q.getExtReportGroupID());Tb=Ub.length;0==Tb?Va.hide():(Va.show(),Vb.resetPaginationAndJumpToFirstPage(Tb),bc=sa(cc,dc,Ub),hb())},sa=function(Na,ib,nb){return nb&&0<nb.length?(Na=(Na-1)*ib,Na+ib>=nb.length?nb.slice(Na,nb.length):nb.slice(Na,Na+ib)):null},hb=function(){if(0!=document.body.clientHeight&&0!=document.body.clientWidth){if(!ub&&
Va){ub=bb.createTable();ub.setColumnFitVisibleWidth(!0);ub.setDraggableAdjusting(!0,bb.getHeadRowCount(),0,new ha);bb.setupSingleRowSelection(ub);var Na=new Ea(ub);Na.setOutsideVisible(!1);ub.setCellRender(Na);Na=J&&J.length;ub.addColumns(Na);var ib=bb.createHeadRow(ub);ib.setHeight(28);for(var nb=0;nb<Na;nb++)ub.getColumn(nb).setWidth(J[nb].width),J[nb].text&&ib.getCell(nb).setValue(J[nb].text);Lb=$(ub.getUI());z.layoutCtrlWithLRTB(Lb,5,5,null,5,5,null);Va.append(Lb)}bb.clearWithoutHead(ub);a={};
ib=new KTBorderStyle;ib.setBottomBorderWidth(1);ib.setBottomBorderPen("solid");ib.setBottomBorderColor("#e5e5e5");if(bc&&0<bc.length)for(Na=0,nb=bc.length;Na<nb;Na++){var Mb=bc[Na],hc=new Pa(Mb);hc.setExtReportTypeName(Cb(Mb));hc.setGlobalDependence(K);hc.setFunEditSuccessCallback(Fb);var Wa=hc,Bb=Wa.setIconFileName;Mb=Fa.TYPE_EXTRPT===Mb.getExtRptType()?"icon-card-extreport":Fa.TYPE_DATASET===Mb.getExtRptType()?"icon-card-dataset":"";Bb.call(Wa,Mb);hc.setFunOpenDetailCallback(Zb);hc.setFunUpdateUiCallback(xa);
Wa=bb.createRow(ub,!1);Wa.setBorder(ib);Wa.setUserObject(hc);Wa.setHeight(40)}Na=K.getCurrentSpaceType()!=lb.COLLABORATION;ub.getColumn(3).setHide(Na);bb.refresh(ub);ib=0;nb=Object.keys(a);for(Na=0;Na<nb.length;Na++)a[nb[Na]].isChecked()&&ib++;Na=0<ib&&ib===Object.keys(a).length;d();pb&&pb.setChecked(Na)}},Fb=function(){bb.refresh(ub)},Cb=function(Na){return Fa.TYPE_EXTRPT===Na.getExtRptType()?b.get("extreport","\u8f7b\u62a5\u8868"):Fa.TYPE_DATASET===Na.getExtRptType()?b.get("dataSet","\u6570\u636e\u96c6"):
""}}var E=this,A,R,ma,Y,oa,C,n=0,m=0,l=0,f=!1,q,H="createTime",F="DESC",ja=!1,ta,ua,U,Ja,Ba,Qa,za=vb.AllFilterType,$a=za[0],fb,Ca=[],Ib=!1,la=!1,ea=[],I=[],Sa,Ka,rb,ob,D,S,Ma,eb,mb;this.setFunSearchResultPaneCallback=function(K,Ea){Ka=K;rb=Ea};this.setExtReportSplitPane=function(K,Ea){D=K;ob=Ea};this.setJqExtReportDetailContainer=function(K){S=K};this.showExtReportView=function(K){K?(Qa&&Qa.hide(),Ba&&Ba.show(),Ba.updateUi()):(Ba&&Ba.hide(),Qa&&Qa.show(),Qa.updateUi())};var Eb=function(K){q=K};this.setSearchExtReportText=
function(K){fb=K};this.setFunUpdateToolbarStatus=function(K){Sa=K};this.setSelectedFilterType=function(K){$a=K};this.isSelectMode=function(){return f};this.getSelectedCard=function(){return Ca};this.getArrExtReportModel=function(){return ea};this.getJqUi=function(){if(!A){A=$("<div>");A.addClass("extreport-container");var K=A,Ea=K.append;ta=$("<div>");ta.hide();ta.addClass("extreport-no-data-bg-container");var cb=$("<div>");La.background(cb,"group-extreport-no-data");cb.css({height:"140px",marginTop:"210px",
backgroundSize:"contain",backgroundPosition:"center"});var Va=$("<div>");Va.css({marginTop:"21px",fontSize:"15px"});var pb=b.get("nodataTips","\u8bf7\u70b9\u51fb\u5de5\u5177\u680f\u3010\u65b0\u5efa\u3011\u6309\u94ae\uff0c\u65b0\u5efa\u62a5\u8868\u6216\u6570\u636e\u96c6");Va.text(pb);ta.append(cb);ta.append(Va);Ea.call(K,ta);A.append(ac());K=A;Ea=K.append;Ba=new ka(e);U=Ba.getJqUi();Ea.call(K,U);K=A;Ea=K.append;Qa=new qa(e);cb=[{width:40},{width:40,text:b.get("serial","#")},{width:150,text:b.get("listViewTableName",
"\u540d\u79f0")},{width:200,text:b.get("listViewLockStatus","\u9501\u5b9a\u72b6\u6001")},{width:150,text:b.get("listViewType","\u7c7b\u578b")},{width:400,text:b.get("listViewDesc","\u63cf\u8ff0")},{width:200,text:b.get("listViewCreateTime","\u521b\u5efa\u65f6\u95f4")},{width:200,text:b.get("listViewLastModifyTime","\u6700\u540e\u4fee\u6539\u65f6\u95f4")},{width:200,text:b.get("listViewOperation","\u64cd\u4f5c")}];Qa.setArrHeadRowMap(cb);Qa.hide();Ja=Qa.getJqUi();Ea.call(K,Ja);e.addListener(y.LOAD_EXTREPORT_BY_GROUP_IDS,
Gb);e.addListener(y.UPDATE_CURRENT_CATEGORY,Eb)}return A};this.update=function(K){e.isCardView()?Ba.update(K):Qa.updateUi()};var Gb=function(K){var Ea=K.funHasData,cb=K.funUpdateSearch;I=K.unloadGroupId;K=[];if(0<I.length){if(K=I,!Ib){Ib=!0;var Va=e.createFacade(function(pb){var ub=[],Lb=ea;I=[];e.fireEvent(y.UPDATE_UNLOAD_EXTREPORT_GROUPID);pb=pb.extreportList;for(var Vb=0;Vb<pb.length;Vb++){var Xb=Fa.createInstance(pb[Vb]);Fa.pushIfAbsent(Xb,Lb);ub.push(Xb.getExtReportGroupID())}Ea&&Ea(ub);cb&&
cb();Ib=!1},function(pb,ub){return Ib=!1});Va.setShowBlocking(!1);Va.loadExtReportByGroupIDS(K)}}else cb&&cb()},Ob=function(K){var Ea=K.getExtReportGroupID();if(!la){la=!0;var cb=e.createFacade(function(Va){var pb=ea,ub=I.indexOf(Ea);-1<ub&&I.splice(ub,1);if((Va=Va.extreportList)&&0<Va.length){for(ub=0;ub<Va.length;ub++){var Lb=Fa.createInstance(Va[ub]);Fa.pushIfAbsent(Lb,pb)}pb=Lb.getExtReportGroupID();e.fireEvent(y.UPDATE_CURRENT_EXTREPORT_HAS_DATA,{groupId:pb,model:K});zb(!0)}else zb(!1);e.isCardView()?
Ba.updateUi():(Qa.updateUi(),ra(),Za());la=!1},function(Va,pb){return la=!1});cb.setShowBlocking(!0);cb.loadSortedExtReportByGroupId(Ea,H,F,e.getCurrentSpaceID())}},ac=function(){ua=$("<div>");ua.addClass("extreport-selection-info");ma=$("<span>");ma.addClass("extreport-selection-info-count");ma.text(b.get("selectionInfoTotalCount","\u5171#1\u4e2a").replace("#1",m));e.isCardView()||ma.text(b.get("selectionInfoTotalCountList","\u5171#1\u6761").replace("#1",m));Y=$("<span>");Y.addClass("extreport-selection-info-count");
Y.hide();Y.text(b.get("selectInfoSelected","\u5df2\u9009#1\u4e2a\uff0c").replace("#1",n));oa=$("<span>");oa.addClass("extreport-selection-info-count");oa.hide();oa.text(b.get("selectInfoFilter","\u7b5b\u9009\u540e\u5c55\u793a#1\u4e2a").replace("#1",l));e.isCardView()||(Y.text(b.get("selectInfoSelectedList","\u5df2\u9009#1\u6761\uff0c").replace("#1",n)),oa.text(b.get("selectInfoFilterList","\u7b5b\u9009\u540e\u5c55\u793a#1\u6761").replace("#1",l)));R=$("<span>");R.addClass("extreport-selection-info-all");
R.text(b.get("selectInfoSelectAll","\u9009\u62e9\u5168\u90e8"));R.on("click",function(){e.isCardView()?Ba.fireSelectAllListener():Qa.fireSelectAllListener()});C=new ia;C.setChecked(!1);C.addCheckedListener(kc);C.setText(b.get("showOnlyChecked","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));var K=C.getJqUi();K.hide();K.addClass("extreport-selection-show-only-checked-box");var Ea=fc.createSortField(b.get("sortFieldCreateTime","\u521b\u5efa\u65f6\u95f4"),"createTime"),cb=fc.createSortField(b.get("sortFieldName",
"\u540d\u79f0"),"name"),Va=new fc;Va.setSortField([Ea,cb]);Va.setSortListener(jc);Ea=Va.getJqUi();z.layoutCtrlWithLRTB(Ea,null,20,53,7);ua.append(Y);ua.append(ma);ua.append(oa);ua.append(R);ua.append(K);ua.append(Ea);return ua},jc=function(K,Ea){H=K.getPropertyName();F=Ea?"ASC":"DESC";ja=!ja;gc()},gc=function(){var K=q.getExtReportGroupID(),Ea=ea;if(!la){la=!0;var cb=e.createFacade(function(Va){Va=Va.extreportList;for(var pb=0;pb<Va.length;pb++)for(var ub=Fa.createInstance(Va[pb]),Lb=0;Lb<Ea.length;Lb++)Ea[Lb].getExtReportID()===
ub.getExtReportID()&&(Ea.splice(Lb,1),Ea.push(ub));e.isCardView()?Ba.updateUi():Qa.updateUi();la=!1},function(Va,pb){return la=!1});cb.setShowBlocking(!0);cb.loadSortedExtReportByGroupId(K,H,F,e.getCurrentSpaceID())}};this.getExtReportTypeName=function(){if(1===Ca.length){var K=Ca[0];K=Fa.TYPE_EXTRPT===K.getExtRptType()?b.get("report","\u62a5\u8868"):Fa.TYPE_DATASET===K.getExtRptType()?b.get("dataSet","\u6570\u636e\u96c6"):""}return K};var kc=function(){e.isCardView()?Ba.fireShowOnlyListener():Qa.fireShowOnlyListener()},
lc=function(K){return h(ea,fb).filter(function(Ea){return Ea.getExtReportGroupID()==K})};this.collectSearchResultModel=function(){return h(ea,fb)};var oc=function(){U.find(".extreport-card").remove()},h=function(K,Ea){K=u(K);Ea&&Ea.trim()&&(K=K.filter(function(cb){return-1<cb.getExtReportName().toUpperCase().indexOf(Ea.toUpperCase())||cb.getDescription()&&-1<cb.getDescription().toUpperCase().indexOf(Ea.toUpperCase())}));return K},u=function(K){switch($a&&$a.getTypeID()){case "EXTREPORT":K=ba(Fa.TYPE_EXTRPT,
K);break;case "DATASET":K=ba(Fa.TYPE_DATASET,K)}return K},ba=function(K,Ea){for(var cb=[],Va=0;Va<Ea.length;Va++){var pb=Ea[Va];pb.getExtRptType()==K&&cb.push(pb)}return cb},ra=function(){Ca=[];Y.hide();C.setChecked(!1);C.getJqUi().hide();f=!1;R.text(b.get("selectInfoSelectAll","\u9009\u62e9\u5168\u90e8"));Sa&&Sa(f,Ca.length);for(var K=$(".extreport-card-container").find(".extreport-card"),Ea=0;Ea<K.length;Ea++)$(K[Ea]).find(".selected-icon")[0].style.display=null;Ha()},Ha=function(){for(var K=$(".extreport-card-container").find(".extreport-card"),
Ea=0;Ea<K.length;Ea++){var cb=$(K[Ea]),Va=cb.find(".extreport-name");f?(cb.off("mouseover"),cb.off("mouseleave"),Va.css("width","190px"),Va.css("color","#333333")):(Va.css("width","209px"),cb.on("mouseover",function(){$(this).find(".extreport-name").css("width","190px");$(this).find(".extreport-name").css("color","var(--color-main, #5582f3)")}),cb.on("mouseleave",function(){$(this).find(".extreport-name").css("width","209px");$(this).find(".extreport-name").css("color","#333333")}))}},Za=function(){if(q){var K=
q.getExtReportGroupID(),Ea=ea,cb=[],Va;for(Va in Ea){var pb=Ea[Va];pb.getExtReportGroupID()==K&&cb.push(pb)}m=cb.length;ma.text(b.get("selectionInfoTotalCountList","\u5171#1\u6761").replace("#1",m));e.isCardView()&&ma.text(b.get("selectionInfoTotalCount","\u5171#1\u4e2a").replace("#1",m));n=Ca.length;0==n?ra():(K=Ba.isShowDeselectAll(),e.isCardView()||(K=Qa.isShowDeselectAll()),R.text(b.get("selectInfoSelectAll","\u9009\u62e9\u5168\u90e8")),K&&R.text(b.get("selectInfoDeselectAll","\u53d6\u6d88\u5168\u9009")),
Y.text(b.get("selectInfoSelected","\u5df2\u9009#1\u4e2a\uff0c").replace("#1",n)),e.isCardView()||Y.text(b.get("selectInfoSelectedList","\u5df2\u9009#1\u6761\uff0c").replace("#1",n)),Y.show(),C.getJqUi().show());fb||$a!=za[0]?(l=Ba.getTotalRows(),e.isCardView()||(l=Qa.getTotalRows()),oa.text(b.get("selectInfoFilter","\u7b5b\u9009\u540e\u5c55\u793a#1\u4e2a").replace("#1",l)),ma.text(b.get("selectionInfoTotalCountWithComma","\u5171#1\u4e2a\uff0c").replace("#1",m)),e.isCardView()||(ma.text(b.get("selectionInfoTotalCountListWithComma",
"\u5171#1\u6761\uff0c").replace("#1",m)),oa.text(b.get("selectInfoFilterList","\u7b5b\u9009\u540e\u5c55\u793a#1\u6761").replace("#1",l))),oa.show(),0===l&&R.hide()):(l=0,oa.hide(),R.show())}},zb=function(K){K?(ua.show(),ta.hide()):(ua.hide(),ta.show())};this.clear=function(){ea=[];la=Ib=!1};this.syncContainerWidthAndHeight=function(K){U&&U.css({width:K+"px"});U&&U.css({height:document.documentElement.clientHeight-45-40+"px"});Ja&&Ja.css({width:K-15+"px"});Ja&&Ja.css({height:document.documentElement.clientHeight-
45-40+"px"});ua&&ua.css({width:K-25+"px"});ta&&ta.css({width:K+"px"})};var Wb=function(K){K&&K.isOpen()?(ob.getJqSplitLine().css("display","block"),K=document.documentElement.clientWidth-S.width()-D.getNonemptyFirstWide()+5):(ob.getJqSplitLine().css("display","none"),K=document.documentElement.clientWidth-D.getNonemptyFirstWide());E.syncContainerWidthAndHeight(K)},Zb=function(K,Ea,cb){var Va=rb&&rb();Ma||(Va&&Ka&&Ka(!1),Ma=new xc,Ma.setFunAdjustContainerCallback(Wb),Ma.setCollapseListener(Nb),ob.setFirstSize($(document).width()-
310,-1,-1),window.addEventListener("resize",function(){Ma.isOpen()?ob.collapseSecondHalf(!1):ob.hideSecondHalf(!0)}));e.isCardView()||Ma.setFunUpdateListViewCallback(cb);ob.clearState();ob.setSecondSize(325,325,500);if(Ma.isOpen()){if(K.getExtReportID()==mb){Ma.closePanel();return}Ma.setNullToJqUi()}else Va&&Ka&&Ka(!1);Ma.setExtReportModel(K);Ma.setIconFileName(Ea);Ma.setGlobalDependence(e);eb=Ma.getJqUi();S.append(eb);Ma.setIsOpen(!0);mb=K.getExtReportID();Wb(Ma);ob.collapseSecondHalf(!1)},Nb=function(){ob.collapseSecondHalf(!0)}}
"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.manage&&(com.kingdee.bos.extreport.manage={});"undefined"==typeof com.kingdee.bos.extreport.manage.ui&&(com.kingdee.bos.extreport.manage.ui={});var Ra=com.kingdee.bos.extreport.manage.ui;Ra.Main=function(){var e,ka,qa,E,A,R,ma=vb.AllFilterType,
Y=ma[0],oa,C,n,m,l,f,q,H,F,ja,ta,ua,U,Ja,Ba,Qa,za,$a,fb,Ca,Ib=!1,la,ea,I=new function(){var a,c=new P;this.addListener=function(d,k){c.addListener(d,k)};this.removeListener=function(d,k){c.removeListener(d,k)};this.fireEvent=function(d,k,B){c.fireEvent(d,k,B)};this.isShowGUIEnterIcon=function(){return Ib};this.getAllGroupModel=function(){return oa&&oa.getAllGroupModel()};this.getCurrentSpaceID=function(){return F&&F.getSpaceID()};this.getCurrentSpaceCreatorId=function(){return F&&F.getCreatorID()};
this.getCurrentSpaceType=function(){return F&&F.getSpaceType()};this.getCurrentSpaceCategoryDesc=function(){switch(ja){case lb.PRESET:return b.get("presetSpaceCategory","\u9884\u7f6e\u7a7a\u95f4\u76ee\u5f55");case lb.PERSONAL:return b.get("personalSpaceCategory","\u4e2a\u4eba\u7a7a\u95f4\u76ee\u5f55");default:return b.get("collSpaceCategory","\u534f\u4f5c\u7a7a\u95f4\u76ee\u5f55")}};this.isCardView=function(){return ta&&ta.isCardView()};this.getMessageCurtain=function(){a||(a=new T,a.getJqUi().appendTo($("body")));
return a};this.createFacade=function(d,k,B){var xa=sb.getRemoteImpl();return new jb(xa,d,function(sa,hb){return k?k(sa,hb):!1},B)}};this.getGlobal=function(){return I};this.createJqUi=function(){Hb.loadSkinCss("timedpush","qing-timedpush");Hb.loadSkinJs("timedpush","skin");Hb.loadI18n("timedpush","timedpush");Hb.loadJs("timedpush/qing-timedpush.js");Hb.loadJs("lightapp/common/qing-lapp-env.js");Hb.loadJs("timedpush/qing-timedpush-lapp.js");Hb.loadJs("timedpush/html2canvas.js");Hb.loadJs("core/qing-charts.js");
Hb.loadJs("core/qing-main.js");Hb.loadJs("dashboard/dsb-main.js");Hb.loadSkinJs("imagelib","skin");Hb.loadI18n("dashboard","dsb-integration");Hb.loadSkinCss("imagelib","qing-imagelib");Hb.loadJs("imagelib/imagelib.js");Hb.loadI18n("imagelib","imagelib");Hb.loadJs("dashboard/dsb-integration.js");Hb.loadSkinCss("dashboard","dsb-integration");Hb.loadSkinJs("linkage","skin");Hb.loadJs("linkage/linkage.js");Hb.loadSkinCss("linkage","linkage");e=$("<div>");e.addClass("extreport-manage");ka=$("<div>");ka.addClass("extreport-manage-toolbar");
ua=Ka(ka,!1,Za,"btn_newCard",b.get("create","\u65b0\u5efa"),b.get("create","\u65b0\u5efa"));ua.getJqUi().css("margin-left","12px");Qa=Ka(ka,!1,Wb,"",b.get("deleteExtReport","\u5220\u9664"),b.get("deleteExtReport","\u5220\u9664"));Qa.setEnabled(!1);za=Ka(ka,!1,Zb,"",b.get("move","\u79fb\u52a8"),b.get("move","\u79fb\u52a8"));za.setEnabled(!1);$a=Ka(ka,!1,Nb,"",b.get("copy","\u590d\u5236"),b.get("copy","\u590d\u5236"));$a.setEnabled(!1);fb=pb(ka);fb.setEnabled(!1);K(ka);Ja=Ka(ka,!1,cb,"btn_export",b.get("exportExtReport",
"\u5bfc\u51fa"),b.get("exportExtReport","\u5bfc\u51fa"));Ba=Vb(ka);Ka(ka,!1,bc,"",b.get("refresh","\u5237\u65b0"),b.get("refresh","\u5237\u65b0"));ka.appendTo(e);qa=$("<div>");qa.appendTo(ka);qa.addClass("extreport-manage-right-toolbar");S(qa);oc(qa);kc(qa);jc(qa);gc();var a=new na;a.setCallbackImmediately(function(){gc();if(m){var c=f&&"block"==f.getJqUi().css("display");c=Eb(c);C.syncContainerWidthAndHeight(c);Ca&&Ca.setMessageDialogBounds(null,5,10,null)}});a.setCallback(function(){oa.updateUi(n&&
n.getExtReportGroupName())});a.setDelay(250);a.observe();a=$("<div>");a.addClass("extreport-manage-container");Ha(a);ra(a);Sa();$(document.body).on("keydown",function(c){c.altKey&&c.shiftKey&&71==c.keyCode&&(Ib=!Ib,I.fireEvent(y.IS_SHOW_GUI_ENTER_ICON))});return e};var Sa=function(){V.getFacadeInstance(function(a){var c=new wb;c.fromJsonObject(a);F=c;ja=c.getSpaceType();c.getCreatorID();h(qa);oa.loadExtReportGroupList(null,null,F.getSpaceID())},function(a,c){return!1}).queryUserDefaultSpace()},Ka=
function(a,c,d,k,B,xa){var sa=new Ta;sa.setIconSetter(function(hb,Fb){La.background(hb,Fb)});sa.setIconName(k);sa.setText(B);sa.setTooltips(xa);c&&sa.setShowDropdownArrow(!0);sa.addActionListener(function(hb,Fb){c?rb(hb.getJqUi(),Fb,d,a):d(hb)});sa.getJqUi().appendTo(a);return sa},rb=function(a,c,d,k){var B=a.data("menu");if(B&&B.isShowing())a.data("menu",null),B.hide();else{B=new aa;B.setModel(d());B.setHideListener(function(){a.data("menu",null)});a.data("menu",B);d=a.prop("offsetLeft");var xa=
a.prop("offsetHeight")+a.prop("offsetTop");B.show(k,d,xa,c,!0)}},ob=function(){ja!=lb.PRESET?(ua.getJqUi().show(),U.getJqUi().show(),Ja.getJqUi().show(),Qa.getJqUi().show(),za.getJqUi().show(),fb.getJqUi().show(),Ba&&Ba.getJqUi().css("margin-left","0px"),$a.getJqUi().css("margin-left","0px")):(ua.getJqUi().hide(),U.getJqUi().hide(),Ja.getJqUi().hide(),Qa.getJqUi().hide(),za.getJqUi().hide(),fb.getJqUi().hide(),$a.getJqUi().css("margin-left","12px"))},D=function(a,c){Qa.setEnabled(a&&0<c);za.setEnabled(a&&
0<c);fb.setEnabled(a&&0<c);$a.setEnabled(a&&1==c)},S=function(a){var c=$("<div>"),d=480;"en"==G.getUrlParamValue("language")&&(d=500);c.addClass("extreport-search-icon");c.css("right",d+"px");c.attr("title",b.get("search","\u641c\u7d22"));La.backgroundWithHover(c,"icon_search");c.on("mouseenter",Ma);c.appendTo(a);return c},Ma=function(){if(R)R.show();else{R=$("<div>");l=new tb;l.setSearchListenerDelay(1E3);l.addSearchListener(u);l.setAlwaysShowCleanIcon(!0);l.setShowSearchIcon(!0);l.setPlaceholder(b.get("searchContent",
"\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));R=l.getJqUi();R.addClass("extreport-search-box");var a=473;"en"==G.getUrlParamValue("language")&&(a=493);z.layoutCtrlWithLRTB(R,null,a,180);z.layoutCtrlMiddleAlign(R,44);a=R.find(":input");a.on("keydown",function(c){13==(c.keyCode||c.which||c.charCode)&&u(!0)});R.find(".sa-ctrl-searchbox-close").on("click",function(){u(!0)});a.focus(function(){l.getText()&&mb(!0)});R.on("mouseleave",function(){l.getText()||R.hide()});R.appendTo(qa)}l.setFoucs()},eb=function(a,
c){$(a.parentElement).css("overflow","hidden");a.addClass("search-result-item");a.css({width:"285px",height:"80px","border-bottom":"1px solid #E2E7EF",left:"6px","padding-top":"6px",color:"#828282",cursor:"pointer"});var d=$("<div>");d.addClass("search-result-item-icon");c.getType()==Fa.TYPE_EXTRPT?La.background(d,"icon-card-extreport"):La.background(d,"icon-card-dataset");d.css({position:"absolute",height:"36px",width:"36px"});var k=$("<div>");k.addClass("search-result-item-name");k.css({"font-size":"14px",
color:"black",width:"160px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","margin-left":"45px"});k.attr("title",c.getName());var B=$("<div>");B.text(b.get("searchInfoPath","\u8def\u5f84\uff1a")+c.getGroupName());B.addClass("search-result-item-group-name");B.css({right:"0px","margin-left":"45px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",top:"0px",padding:"0px, 10px, 0px, 10px"});B.attr("title",c.getGroupName());var xa=$("<div>");xa.addClass("search-result-item-desc");
xa.css({width:"280px",position:"absolute","white-space":"normal",top:"45px",height:"40px","word-wrap":"break-word"});var sa=c.getDesc();sa||(sa=b.get("noDescription","\u6682\u65e0\u63cf\u8ff0"),xa.css("margin-top","10px"));sa&&45<sa.length&&(sa=sa.substring(0,45)+"...");xa.attr("title",c.getDesc());a.append(d);a.append(k);a.append(B);a.append(xa);(d=l.getText())&&d.trim()&&(d=d.trim(),f.doHighLightText(k,c.getName(),d),f.doHighLightText(xa,sa,d));a.on("click",function(){f.clearSelected()})},mb=function(a){a?
f.getJqUi().show():f.getJqUi().hide();a=Eb(a);C.syncContainerWidthAndHeight(a)},Eb=function(a){var c=document.documentElement.clientWidth-E.width()-15;f&&(a||"block"==f.getJqUi().css("display"))&&(c-=f.getJqUi().width());return c},Gb=function(){return f&&"block"==f.getJqUi().css("display")},Ob=function(){f&&mb(!1)},ac=function(a){if(n&&n.getExtReportGroupID()!==a.getGroupID()&&C.isSelectMode()){var c=x.createFeedbackDialog();c.setTitle(b.get("categoryJumpPrompt","\u76ee\u5f55\u8df3\u8f6c\u63d0\u793a"));
c.setOptionType(x.OPTION_OK_CANCEL);c.setButtonText(x.RETURN_OK,b.get("categoryJump","\u8df3\u8f6c"));c.setMsgImageType(x.MSG_CONFIRM);c.setMessage(b.get("categoryJumpContent","\u5373\u5c06\u8df3\u8f6c\u5230\u5176\u4ed6\u76ee\u5f55\u8fdb\u884c\u67e5\u770b\uff0c\u8df3\u8f6c\u540e\u4f1a\u6e05\u9664\u5f53\u524d\u76ee\u5f55\u5185\u5361\u7247\u7684\u9009\u62e9\u72b6\u6001\uff0c\u662f\u5426\u7ee7\u7eed\u8df3\u8f6c\uff1f"));c.setClosingChecker(function(d){d==x.RETURN_OK&&oa.doSelectCategoryAndScrollToCard(a);
f.clearSelected();return!0});c.showDialog()}else oa.doSelectCategoryAndScrollToCard(a)},jc=function(a){var c=35;"en"==G.getUrlParamValue("language")&&(c=65);Hb.setCallback(function(){var d=com.kingdee.bos.qing.message.common.Integration;d.setRemoteUrl(sb.getMessageRemoteUrl());d.setImportJSCodeForManager(sb.getImportJSCodeForManager());d.setAppId(sb.getAppId());Ca=new com.kingdee.bos.qing.message.ui.Main;Ca.setFunOpenMessageDialog(function(){Ca.setViewSize(null,5,10,null)});Ca.setMessageWidth(c);
d=Ca.getJqUi();d.css({position:"absolute","float":"right",top:"50%","margin-top":"-9px",right:"10px"});d.appendTo(a);d=kb.decodeParamFromUrl(window.location.search,"path");com.kingdee.bos.qing.timedpush.LappIntegration.setLappPrivateUrl((d?d:"/ierp")+"/qing/lappPrivateInfo.do")});Hb.loadSkinCss("message","message");Hb.loadSkinJs("message","skin");Hb.loadJs("message/message-manage-ui.js");Hb.loadI18n("message","message");return c},gc=function(){document.body.style.height=document.documentElement.clientHeight+
"px"},kc=function(a){ta=new M;ta.setClickListener(lc);a=385;"en"==G.getUrlParamValue("language")&&(a=405);var c=ta.getJqUi();z.layoutCtrlWithLRTB(c,null,a,60)},lc=function(a){var c=ta.isCardView();a!=c&&(ta.setCardView(a),C.showExtReportView(a))},oc=function(a){var c=380;"en"==G.getUrlParamValue("language")&&(c=403);q=new r;q.setItemModels(ma);q.setSelected(ma[0]);q.setCustomPainter(function(k,B,xa){k=b.get(xa.getI18nKey(),xa.getDefaultDesc());B.text(k);B.attr("title",k)});q.addSelectedChangedListener(function(k,
B,xa){Y=xa;u(f&&"block"==f.getJqUi().css("display"))});var d=q.getJqUi();d.addClass("extreport-searchtype-combobox");z.layoutCtrlWithLRTB(d,null,c,84);z.layoutCtrlMiddleAlign(d,44);d.appendTo(a);return d},h=function(a){var c=80;"en"==G.getUrlParamValue("language")&&(c=102);var d=$("<div>");d.addClass("extreport-swith-space");var k=$("<div>");k.addClass("extreport-swith-space-tip");k.text(b.get("currentSpace","\u5f53\u524d\u7a7a\u95f4 :"));H=new X;var B=new nc;B.setFunRefreshCollaborationSpace(J);
B.setFunShowOrHideToolbar(ob);B.setFunCloseSearchPane(Ob);B.setMessageCurtain(I.getMessageCurtain());H.setSelectedModel(F);H.setCustomPainter(function(hb,Fb){hb=V.getSpaceName(hb);Fb.text(hb);Fb.attr("title",hb)});H.setDropdownCreator(function(hb,Fb,Cb){return B.createJqPopup(hb,Fb,Cb,"FCREATETIME",!1)});var xa=H.getJqUi();xa.addClass("extreport-switch-space-combobox");B.setBlockJqUi(xa);var sa=$("<div class='deploy-button-split-line'>");k.appendTo(d);xa.appendTo(d);sa.appendTo(d);z.layoutCtrlWithLRTB(d,
null,c,280);d.appendTo(a);return d};Ob=function(){if(R){var a=R.find(".sa-ctrl-searchbox-close");a&&a.click();R&&R.hide()}};var u=function(a){C.setSelectedFilterType(Y);C.setSearchExtReportText(l&&l.getText());C.update(n.getExtReportGroupID());a&&(f||(f=new Rb,f.setFunCustomPainter(eb),f.setFunCloseSearchResultPanel(Ob),f.setFunItemSelectedListener(ac),f.getJqUi().appendTo(e)),mb(l&&l.getText()),f.block(!0),oa.loadExtReportByGroupIDS(ba))},ba=function(){var a=C.collectSearchResultModel();a=oa.filterVisibleCategoryModels(a);
var c=[],d;for(d in a){var k=a[d],B=new qc;B.setName(k.getExtReportName());B.setID(k.getExtReportID());B.setDesc(k.getDescription());B.setGroupName(oa.findGroupNameByGroupID(k.getExtReportGroupID(),">"));B.setGroupID(k.getExtReportGroupID());B.setType(k.getExtRptType());c.push(B)}f.setTotalRecords(c.length);f.setArrSearchResultModel(oa.handlerSearchResult(c));f.refresh();f.block(!1)},ra=function(a){m=new ya;m.setHorizontalSplit(!0);m.setEnabled(!0);m.setSplitLineWide(4);m.setResizeMode(ya.RESIZE_MODE_FIRST_FIXED);
m.setFirstSize(230,200,640);m.setSecondSize($(document).width()-234,0,-1);m.getJqUi().addClass("sa-qing-publish-manager");a.append(m.getJqUi());C=new Ya(I);C.setFunUpdateToolbarStatus(D);C.setExtReportSplitPane(m,la);C.setJqExtReportDetailContainer(ea);C.setFunSearchResultPaneCallback(mb,Gb);A=C.getJqUi();oa=new Da(I);oa.setFunUpdateCurrentExtReportGroup(Ub);oa.setFunRefreshData(Tb);E=oa.getJqUi();m.setFirstChild(ya.createChildWrapper(E,function(){E&&E.css({width:m.getNonemptyFirstWide()+"px"});var c=
f&&"block"==f.getJqUi().css("display");c=Eb(c);C.syncContainerWidthAndHeight(c);oa.refresh()}));m.setSecondChild(ya.createChildWrapper(A))},Ha=function(a){var c=$("<div>");c.addClass("extreport-detail-jqExtManageContainer");la=new ya;la.setHorizontalSplit(!0);la.setEnabled(!0);la.setSplitLineWide(4);la.setResizeMode(ya.RESIZE_MODE_SECOND_FIXED);c.append(la.getJqUi());c.appendTo(e);ea=$("<div>");la.setFirstChild(ya.createChildWrapper(a,function(){ea&&ea.css({width:document.documentElement.clientWidth-
la.getNonemptyFirstWide()+5+"px"});var d=document.documentElement.clientWidth-ea.width()-m.getNonemptyFirstWide()-5;C.syncContainerWidthAndHeight(d)}));la.setSecondChild(ya.createChildWrapper(ea));la.getJqSplitLine().addClass("extreport-detail-splitPaneLine")},Za=function(){var a=$("<div class='sa-ctrl-common-modallayer'>"),c=$(document.body);a.appendTo(c);for(var d=new t(a),k=function(){a.remove();d.destroy()},B=$("<div>"),xa=tc.getAllInstance(),sa=0,hb=xa.length;sa<hb;sa++){var Fb=xa[sa],Cb=$("<div>");
z.layoutCtrl(Cb,44+120*sa,35,100,66);Cb.css("cursor","pointer");Cb.data("model",Fb);Cb.on("click",function(nb){nb=$(nb.currentTarget).data("model");n?zb(nb):(nb=b.get("createCategoryFirst","\u60a8\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u3002"),I.getMessageCurtain().showPrompt(nb,2E3));k()});Cb.appendTo(B);var Na=$("<div>");Na.css("border-radius","4px");var ib=$("<div>");ib.addClass("extreport-card-displayname");z.layoutCtrl(Na,32,0,36,36);z.layoutCtrl(ib,0,50,100,16);Fb.getDisplayName()===
b.get("extreport","\u8f7b\u62a5\u8868")?ib.text(b.get("commonReport","\u62a5\u8868")):ib.text(Fb.getDisplayName());La.background(Na,Fb.getIconFileName());Na.appendTo(Cb);ib.appendTo(Cb)}xa=100+120*xa.length;sa=c.prop("clientWidth");c=c.prop("clientHeight");d.setBounds(sa-xa>>1,c-210>>1,xa,210);d.setToolbarVisible(!1);d.setContent(B);d.setTitle(b.get("create","\u65b0\u5efa"));d.addClosingListener(k);d.show()},zb=function(a){var c=new Fa;c.setExtReportGroupID(n.getExtReportGroupID());c.setExtRptType(a.getType());
c=new Sb(c);c.setExtReportTypeName(a.getDisplayName());c.setGlobal(I);c.addSuccessCallback(function(d){var k="1"==d.getExtRptType()?b.get("dataset","\u6570\u636e\u96c6"):b.get("extreport","\u8f7b\u62a5\u8868");oa.updateExtReportGroupItemAfterCreated(d);O.occur(O.EXT_CREATE_EXTREPORT_TYPE,k)});c.createDialog().show()},Wb=function(){var a=C.getSelectedCard();a=sc.getExtReportDelDialogCreator(a);a.setGlobal(I);a.setExtReportTypeName(C.getExtReportTypeName());a.addSuccessCallback(function(c,d){oa.updateExtReportGroupItemAfterDeleted(c);
var k=c.length,B=d.length;0==B?(B=b.get("deleteExtReportSuccess","\u5220\u9664\u6210\u529f\u3002"),I.getMessageCurtain().showSuccess(B,2E3)):(1==B&&0==k?(B=(0==d[0].getExtRptType()?b.get("tipReportTemplate","\u62a5\u8868\u6a21\u677f"):b.get("tipDataset","\u6570\u636e\u96c6"))+'"'+d[0].getExtReportName()+'"',B=b.get("lockedByOther","#1\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u5220\u9664\u3002").replace("#1",B)):0==c.length?(k=d[0].getExtReportName(),B=b.get("allLockedByOther",
"#1\u7b49#2\u4e2a\u6570\u636e\u5185\u5bb9\u5747\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u5220\u9664\u3002").replace("#1",k).replace("#2",B)):(c=c[0].getExtReportName(),d=d[0].getExtReportName(),B=b.get("partLockedByOther","\u5df2\u6210\u529f\u5220\u9664#1\u7b49#2\u4e2a\u6570\u636e\u5185\u5bb9\uff0c#3\u7b49#4\u4e2a\u6570\u636e\u5185\u5bb9\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u5220\u9664\u3002").replace("#1",
c).replace("#2",k).replace("#3",d).replace("#4",B)),I.getMessageCurtain().showPrompt(B,2E3))});a.createDialog().show()},Zb=function(){var a=C.getSelectedCard(),c=C.getArrExtReportModel();a=sc.getExtReportMoveDialogCreator(a,oa.getCategoryRoot());a.setGlobal(I);a.setExtReportTypeName(C.getExtReportTypeName());a.setCurrentGroupName(oa.findGroupNameByGroupID(n.getExtReportGroupID(),"/"));a.setArrLoadedExtReport(c);a.addSuccessCallback(function(d){oa.funUpdateExtReportGroupItemAfterMoved(d);d=b.get("moveSuccess",
"\u79fb\u52a8\u6210\u529f\u3002");I.getMessageCurtain().showSuccess(d,2E3)});a.createDialog().show()},Nb=function(){var a=C.getSelectedCard(),c=oa.getCategoryRoot();ja==lb.PRESET&&(c=oa.getPersonalCategoryRoot());a=sc.getExtReportCopyDialogCreator(a,c);a.setGlobal(I);a.setExtReportTypeName(C.getExtReportTypeName());a.setCurrentGroupName(oa.findGroupNameByGroupID(n.getExtReportGroupID(),"/"));ja==lb.PRESET&&a.setCurrentGroupName(c.getChildren()[0].getUserObject().getExtReportGroupName());a.addSuccessCallback(function(d,
k){d=Fa.createInstance(d);var B=d.getExtReportGroupID();I.fireEvent(y.REFRESH_EXTREPORT_FUNCTION,B);k&&oa.updateExtReportGroupItemAfterCopied(d);k=b.get("copyExtReportSuccess","\u590d\u5236#1\u6210\u529f\u3002");I.getMessageCurtain().showSuccess(k,2E3)});a.createDialog().show()},K=function(a){var c=$("<input type='file' id='uploadBtn'>");c.addClass("import-extreport-file");c.attr("accept",[".kds",".kdsql",".qing-rpt"]);c.on("change",function(d){if(d=e.find("#uploadBtn").get(0).files[0]){var k=d.name,
B=d.size,xa=k.lastIndexOf(".");k=k.substring(xa+1,k.length).toLowerCase();e.find("#uploadBtn").val("");"kds"!=k&&"qing-rpt"!=k&&"kdsql"!=k?I.getMessageCurtain().showPrompt(b.get("fileTypeIncorrect","\u6587\u4ef6\u7c7b\u578b\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3):0==B?I.getMessageCurtain().showPrompt(b.get("uploadFileIsNull","\u4e0a\u4f20\u7684\u6587\u4ef6\u4e3a\u7a7a\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3):104857600<=B?I.getMessageCurtain().showPrompt(b.get("fileTooLarge",
"\u6587\u4ef6\u592a\u5927\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20\u3002"),2E3):(B=new yc,n&&(k=oa.getCurrentTreeNode(),B.setCurrentExtReportGroupFullPath(Qb.buildCategoryFullPath(k,"","/"))),B.createJqUi(d,I,I.getMessageCurtain()),B.setFunRefreshExtReportGroupList(Tb),B.setFunErrorCallbackEvent(Ea))}c.val("")});c.appendTo(e);U=new Ta;U.setText(b.get("importExtReport","\u5bfc\u5165"));U.setIconSetter(function(d,k){La.background(d,k)});U.setIconName("btn_import");U.setTooltips(b.get("importExtReport","\u5bfc\u5165"));
U.getJqUi().on("click",function(){c.click()});U.getJqUi().appendTo(a);U.getJqUi().attr("accept",[".kds",".kdsql",".qing-rpt"])},Ea=function(){I.getMessageCurtain().showPrompt(b.get("uploadFailed","\u4e0a\u4f20\u6587\u4ef6\u5931\u8d25\u3002"),2E3)},cb=function(){I.getCurrentSpaceType()==lb.COLLABORATION?V.getFacadeInstance(function(a){var c=new wb;c.fromJsonObject(a);c.getRoleType()!=Db.MEMBER?Va():(a=b.get("noExportPerm","\u60a8\u6ca1\u6709\u5bfc\u51fa\u6570\u636e\u5185\u5bb9\u7684\u6743\u9650\u3002"),
I.getMessageCurtain().showPrompt(a,2E3))},function(a,c){return!1}).getCollaborationMemberRoleType(I.getCurrentSpaceID()):Va()},Va=function(){var a=I.createFacade(function(d){var k=new zc;k.fromJsonObject(d);0<k.getChildren().length?(d=new Ac,d.setFolderNode(k),d.setGlobal(I),d.asyncShowExportDialog()):I.getMessageCurtain().showPrompt(b.get("noExtReportForExport","\u6ca1\u6709\u53ef\u4f9b\u5bfc\u51fa\u7684\u62a5\u8868\u3002"),2E3)},function(d,k){I.getMessageCurtain().showPrompt(k)}),c=F.getSpaceID();
a.getAllExtReportForExport(c)},pb=function(a){var c=new ab,d=new yb(function(){var k=com.kingdee.bos.qing.publish.model.PublishTargetType;ub(b.get("publishToAppMenu","\u53d1\u5e03\u5230\u5e94\u7528\u83dc\u5355"),k.APPMENU)});d.setText(b.get("publishToAppMenu","\u53d1\u5e03\u5230\u5e94\u7528\u83dc\u5355"));c.addItemModel(d);d=new yb(function(){var k=com.kingdee.bos.qing.publish.model.PublishTargetType;ub(b.get("publishToCenter","\u53d1\u5e03\u5230\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939"),
k.CENTER)});d.setText(b.get("publishToCenter","\u53d1\u5e03\u5230\u6570\u636e\u5de5\u4f5c\u53f0\u9605\u89c8\u5939"));c.addItemModel(d);d=b.get("publish","\u53d1\u5e03");return Ka(a,!0,function(){return c},"manager",d,d)},ub=function(a,c){var d=C.getSelectedCard();if(d&&0!=d.length){for(var k=com.kingdee.bos.qing.publish.model.PublishSourceType,B=com.kingdee.bos.qing.publish.common.PublishContext,xa=[],sa=[],hb=[],Fb=0;Fb<d.length;Fb++){var Cb=d[Fb];if(Cb.getExtRptType()===Fa.TYPE_EXTRPT){var Na=new B;
Na.setBizTag(Cb.getExtReportID());Na.setCurrentSourceType(k.EXTREPORT);Na.setPublishSourceName(Cb.getExtReportName());Na.setScene(B.Scene.Report);Na.setSpaceID(I.getCurrentSpaceID());Na.setIsQingRpt(!0);xa.push(Na);sa.push(Cb.getExtReportID());I.getCurrentSpaceType()==lb.COLLABORATION&&Cb.getLockHolderName()&&!Cb.isUserAcquiredLock()&&hb.push(Cb.getExtReportID())}}0==xa.length&&I.getMessageCurtain().showPrompt(b.get("publishDatasetTips","\u6570\u636e\u96c6\u4e0d\u80fd\u53d1\u5e03\u3002"));Lb(a,c,
xa,hb,xa.length<d.length)}},Lb=function(a,c,d,k,B){var xa=com.kingdee.bos.qing.publish.common.PublishFactory,sa=com.kingdee.bos.qing.publish.common.PublishContext;if(1==d.length)if(-1!=k.indexOf(d[0].getBizTag()))k=b.get("canNotPublishOne","\u62a5\u8868\u6a21\u677f\u201c#1\u201d\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u53d1\u5e03\u3002").replace("#1",d[0].getPublishSourceName()),I.getMessageCurtain().showPrompt(k);else{var hb=xa.createPublishToDialog(a,
sb.getFunPublishRemoteImpl()(),d[0],c,sb.getFunPublishContentEditEntrance()());hb.addSuccessCallback(function(){var Na=d[0].getPublishSourceName();I.getMessageCurtain().showSuccess("\u201c"+Na+"\u201d"+b.get("publishSuccess","\u53d1\u5e03\u6210\u529f\u3002"),2E3);O.occur(O.PUBLISH_TO_TYPE,O.getPublishTargetName(c))})}else if(1<d.length){a=[];for(var Fb=[],Cb=0;Cb<d.length;Cb++)-1!=k.indexOf(d[Cb].getBizTag())?Fb.push(d[Cb].getPublishSourceName()):a.push(d[Cb]);0==a.length?(k=b.get("canNotPublish",
"\u201c#1\u201d\u7b49#2\u4e2a\u62a5\u8868\u6a21\u677f\u5747\u5df2\u88ab\u5176\u4ed6\u534f\u4f5c\u6210\u5458\u9501\u5b9a\uff0c\u60a8\u4e0d\u80fd\u53d1\u5e03\u3002").replace("#1",Fb[0]).replace("#2",Fb.length),I.getMessageCurtain().showPrompt(k)):(hb=xa.createBatchPublishToDialog(sb.getFunPublishRemoteImpl()(),a,c,sb.getFunPublishContentEditEntrance()(),sa.Scene.Report,I.getCurrentSpaceID(),Fb),hb.setSuccessCallback(function(){I.getMessageCurtain().showSuccess(b.get("publishSuccess","\u53d1\u5e03\u6210\u529f\u3002"),
2E3)}))}hb&&(hb.showDialog(),B&&(k=b.get("publishFilterDataset","\u6570\u636e\u96c6\u4e0d\u80fd\u53d1\u5e03\uff0c\u5df2\u81ea\u52a8\u8fc7\u6ee4\u3002"),hb.showPrompt(k,2E3)))},Vb=function(a){var c=b.get("manager","\u7ba1\u7406");return Ka(a,!0,Xb,"manager",c,c)},Xb=function(){var a=new ab,c=new yb(dc);c.setUserObject();c.setText(b.get("publishManager","\u53d1\u5e03\u7ba1\u7406")+"...");a.addItemModel(c);I.getCurrentSpaceType()!=lb.PRESET&&(c=new yb(cc),c.setUserObject(),c.setText(b.get("permLabelManage",
"\u6743\u9650\u6807\u7b7e\u7ba1\u7406")+"..."),a.addItemModel(c));return a},cc=function(){var a=new com.kingdee.bos.qing.publish.permission.PermLabelManageDialog(sb.getFunPublishRemoteImpl()());a.setSpaceID(I.getCurrentSpaceID());a.showDialog()},dc=function(){var a=sb.getFunPublishContext()();(new com.kingdee.bos.qing.publish.common.PublishManagerDialog(sb.getFunPublishRemoteImpl()(),a,sb.getFunPublishContentEditEntrance()(),!0,F.getSpaceType()==lb.PRESET)).showDialog()},Ub=function(a){n=a},bc=function(a){if(a&&
!a.getUserObject()&&n){var c=n.getExtReportGroupName();var d=n.getExtReportGroupID();var k=n.getSpaceID()}Tb(c,d,k)};this.funRefreshData=function(){if(n){var a=n.getExtReportGroupName();var c=n.getExtReportGroupID();var d=n.getSpaceID()}Tb(a,c,d)};var Tb=function(a,c,d){C.clear();oa.loadExtReportGroupList(a,c,d)},J=function(a){F=a;ja=a.getSpaceType();a.getCreatorID();C.clear();oa.loadExtReportGroupList(null,null,a.getSpaceID())}};var G,jb,La,Jb,sb,O,P,y,ha,t,T,x,r,p,v,ca,Ta,tb,ya,N,X,aa,ia,Ua,qb,
gb,Ga,Fa,vb,db,ab,yb,wb,lb,Db,V,b,na,va,Ia,z,kb,bb,Ab,Kb,Pb,ec,Rb,qc,nc,fc,Qb,xc,wc,zc,Ac,yc,Hb;(function(){var e=com.kingdee.bos.qing;Hb=e.CodeLoader;G=e.Seer;e=com.kingdee.bos.extreport.manage.common;jb=e.Facade;La=e.Icons;sb=e.Integration;O=e.UserOperationReporter;P=e.EventListenerMap;y=e.EventType;ha=e.DraggableAdjustingCustomExpandor;e=com.kingdee.bos.qing.ui.component;t=e.Dialog;T=e.MessageCurtain;x=e.MessageDialog;r=e.ComboBox;p=e.Label;v=e.TextArea;ca=e.TextField;Ta=e.ToolbarButton;tb=e.SearchBox;
ya=e.SplitPane;N=e.SwitchButton;X=e.DropdownSelector;aa=e.Menu;Jb=e.Icons;ab=e.MenuModel;yb=e.MenuItemModel;ia=e.CheckBox;Ua=e.Tree;qb=e.AbstractModalDialog;gb=e.WorkButton;e=com.kingdee.bos.extreport.manage.model;Ga=e.ExtReportGroupModel;Fa=e.ExtReportModel;vb=e.ExtReportType;db=e.TreeNode;e=com.kingdee.bos.qing.framework.common;b=e.MultilanguageManager.createPackageAccessor(Ra);na=e.WindowResizeObserver;va=e.RemoteFramework;Ia=e.Resource;e=com.kingdee.bos.qing.common;z=e.DomUtil;kb=e.Util;Ab=e.TextMeasurer;
Kb=e.DateFormater;e=com.kingdee.bos.qing.biz.common;fc=e.SortDropdownSelector;e=com.kingdee.bos.qing.collaboration.ui;nc=e.CollaborationSpaceResultPane;e=com.kingdee.bos.qing.collaboration.model;wb=e.CollaborationSpaceModel;lb=e.SpaceType;Db=e.CollaborationRoleType;e=com.kingdee.bos.qing.collaboration.common;V=e.SpaceHelper;e=com.kingdee.bos.qing.common.ui;bb=e.TableUtil;e=com.kingdee.bos.extreport.manage.common.ui;Pb=e.StringUtil;ec=e.BlinkHelper;Rb=e.SearchResultPanel;qc=e.DefaultSearchResultModel;
Qb=e.CategoryUtil;xc=e.ExtReportDetailPanel;wc=e.ExtReportListPagination;e=com.kingdee.bos.extreport.manage.imexport;zc=e.FolderNode;Ac=e.ExportDialog;yc=e.UploadPane})();var tc=new function(){var e,ka=[],qa=[fa,Aa],E=function(){e={};for(var A=0,R=qa.length;A<R;A++){var ma=new qa[A];ka.push(ma);e[ma.getType()]=ma}};this.getInstance=function(A){!e&&E();A=e[A];if(!A)throw Error("Unknown theme type");return A};this.getAllInstance=function(){!e&&E();return ka}};Oa.ENTRANCE_REPORT_DESIGNER=1;Oa.ENTRANCE_REPORT_PREVIEW=
2;Oa.ENTRANCE_DATASET_DESIGNER=4;Oa.ENTRANCE_DATASET_PREVIEW=8;var sc=new function(){this.getExtReportDelDialogCreator=function(e){return new Q(e)};this.getExtReportMoveDialogCreator=function(e,ka){return new W(e,ka)};this.getExtReportCopyDialogCreator=function(e,ka){return new w(e[0],ka)}};Z.createEmptyBox=function(){var e=new r;e.setItemModels([]);return e};Z.buildSpaceTreeNode=function(e){var ka=new db,qa=new db;qa.setExpanded(!1);qa.setName(b.get("collaborationSpace","\u534f\u4f5c\u7a7a\u95f4")+
b.get("myOwnerSpace"," (\u6211\u62e5\u6709\u7684)"));var E=new db;E.setExpanded(!1);E.setName(b.get("collaborationSpace","\u534f\u4f5c\u7a7a\u95f4")+b.get("participateSpace"," (\u6211\u53c2\u4e0e\u534f\u4f5c\u7684)"));for(var A=0;A<e.length;A++){var R=new db,ma=new wb;ma.fromJsonObject(e[A]);R.setUserObject(ma);R.setName(ma.getSpaceName());ma.getSpaceType()==lb.COLLABORATION&&(ma.getRoleType()===Db.CREATOR?qa.addChild(R):E.addChild(R))}0<qa.getChildren().length&&ka.addChild(qa);0<E.getChildren().length&&
ka.addChild(E);return ka};Z.isLockedByOther=function(e){return e.lockHolderName&&!e.isUserAcquiredLock};g.ALL_CONFLICTTYPE=["ignore","overwrite","rename"]})();
//qingVersionTag: 20250324