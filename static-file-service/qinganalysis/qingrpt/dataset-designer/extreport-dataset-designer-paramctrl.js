var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(D,ia){return Object.prototype.hasOwnProperty.call(D,ia)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(D,ia,ua){if(D==Array.prototype||D==Object.prototype)return D;D[ia]=ua.value;return D};$jscomp.getGlobal=function(D){D=["object"==typeof globalThis&&globalThis,D,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var ia=0;ia<D.length;++ia){var ua=D[ia];if(ua&&ua.Math==Math)return ua}throw Error("Cannot find global object");};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(D,ia){var ua=$jscomp.propertyToPolyfillSymbol[ia];if(null==ua)return D[ia];ua=D[ua];return void 0!==ua?ua:D[ia]};
$jscomp.polyfill=function(D,ia,ua,xa){ia&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(D,ia,ua,xa):$jscomp.polyfillUnisolated(D,ia,ua,xa))};$jscomp.polyfillUnisolated=function(D,ia,ua,xa){ua=$jscomp.global;D=D.split(".");for(xa=0;xa<D.length-1;xa++){var Pa=D[xa];if(!(Pa in ua))return;ua=ua[Pa]}D=D[D.length-1];xa=ua[D];ia=ia(xa);ia!=xa&&null!=ia&&$jscomp.defineProperty(ua,D,{configurable:!0,writable:!0,value:ia})};
$jscomp.polyfillIsolated=function(D,ia,ua,xa){var Pa=D.split(".");D=1===Pa.length;xa=Pa[0];xa=!D&&xa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var va=0;va<Pa.length-1;va++){var Qa=Pa[va];if(!(Qa in xa))return;xa=xa[Qa]}Pa=Pa[Pa.length-1];ua=$jscomp.IS_SYMBOL_NATIVE&&"es6"===ua?xa[Pa]:null;ia=ia(ua);null!=ia&&(D?$jscomp.defineProperty($jscomp.polyfills,Pa,{configurable:!0,writable:!0,value:ia}):ia!==ua&&(void 0===$jscomp.propertyToPolyfillSymbol[Pa]&&(ua=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[Pa]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(Pa):$jscomp.POLYFILL_PREFIX+ua+"$"+Pa),$jscomp.defineProperty(xa,$jscomp.propertyToPolyfillSymbol[Pa],{configurable:!0,writable:!0,value:ia})))};$jscomp.polyfill("Object.values",function(D){return D?D:function(ia){var ua=[],xa;for(xa in ia)$jscomp.owns(ia,xa)&&ua.push(ia[xa]);return ua}},"es8","es3");
$jscomp.checkStringArgs=function(D,ia,ua){if(null==D)throw new TypeError("The 'this' value for String.prototype."+ua+" must not be null or undefined");if(ia instanceof RegExp)throw new TypeError("First argument to String.prototype."+ua+" must not be a regular expression");return D+""};
$jscomp.polyfill("String.prototype.startsWith",function(D){return D?D:function(ia,ua){var xa=$jscomp.checkStringArgs(this,ia,"startsWith");ia+="";var Pa=xa.length,va=ia.length;ua=Math.max(0,Math.min(ua|0,xa.length));for(var Qa=0;Qa<va&&ua<Pa;)if(xa[ua++]!=ia[Qa++])return!1;return Qa>=va}},"es6","es3");$jscomp.arrayIteratorImpl=function(D){var ia=0;return function(){return ia<D.length?{done:!1,value:D[ia++]}:{done:!0}}};$jscomp.arrayIterator=function(D){return{next:$jscomp.arrayIteratorImpl(D)}};
$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(D){if(D)return D;var ia=function(va,Qa){this.$jscomp$symbol$id_=va;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:Qa})};ia.prototype.toString=function(){return this.$jscomp$symbol$id_};var ua="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",xa=0,Pa=function(va){if(this instanceof Pa)throw new TypeError("Symbol is not a constructor");return new ia(ua+(va||"")+"_"+xa++,va)};return Pa},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(D){if(D)return D;D=Symbol("Symbol.iterator");for(var ia="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),ua=0;ua<ia.length;ua++){var xa=$jscomp.global[ia[ua]];"function"===typeof xa&&"function"!=typeof xa.prototype[D]&&$jscomp.defineProperty(xa.prototype,D,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return D},
"es6","es3");$jscomp.iteratorPrototype=function(D){D={next:D};D[Symbol.iterator]=function(){return this};return D};$jscomp.iteratorFromArray=function(D,ia){D instanceof String&&(D+="");var ua=0,xa=!1,Pa={next:function(){if(!xa&&ua<D.length){var va=ua++;return{value:ia(va,D[va]),done:!1}}xa=!0;return{done:!0,value:void 0}}};Pa[Symbol.iterator]=function(){return Pa};return Pa};
$jscomp.polyfill("Array.prototype.keys",function(D){return D?D:function(){return $jscomp.iteratorFromArray(this,function(ia){return ia})}},"es6","es3");$jscomp.findInternal=function(D,ia,ua){D instanceof String&&(D=String(D));for(var xa=D.length,Pa=0;Pa<xa;Pa++){var va=D[Pa];if(ia.call(ua,va,Pa,D))return{i:Pa,v:va}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(D){return D?D:function(ia,ua){return $jscomp.findInternal(this,ia,ua).v}},"es6","es3");
$jscomp.polyfill("String.prototype.repeat",function(D){return D?D:function(ia){var ua=$jscomp.checkStringArgs(this,null,"repeat");if(0>ia||1342177279<ia)throw new RangeError("Invalid count value");ia|=0;for(var xa="";ia;)if(ia&1&&(xa+=ua),ia>>>=1)ua+=ua;return xa}},"es6","es3");$jscomp.stringPadding=function(D,ia){D=void 0!==D?String(D):" ";return 0<ia&&D?D.repeat(Math.ceil(ia/D.length)).substring(0,ia):""};
$jscomp.polyfill("String.prototype.padStart",function(D){return D?D:function(ia,ua){var xa=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(ua,ia-xa.length)+xa}},"es8","es3");$jscomp.polyfill("String.prototype.padEnd",function(D){return D?D:function(ia,ua){var xa=$jscomp.checkStringArgs(this,null,"padStart");return xa+$jscomp.stringPadding(ua,ia-xa.length)}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(D){return D?D:function(ia,ua,xa){var Pa=this.length||0;0>ua&&(ua=Math.max(0,Pa+ua));if(null==xa||xa>Pa)xa=Pa;xa=Number(xa);0>xa&&(xa=Math.max(0,Pa+xa));for(ua=Number(ua||0);ua<xa;ua++)this[ua]=ia;return this}},"es6","es3");$jscomp.typedArrayFill=function(D){return D?D:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
(function(){function D(b,d){var f=this,g,c,e;this.getJqUi=function(){if(!g){g=$("<div>");g.addClass("extreport-dataset-designer-param-detail-area");var q=g,w=$("<div>");w.css({position:"relative",width:"100%"});var C=a(w);w.css("height",C);q.append(w);f.protectedInit(g)}return g};this.protectedInit=function(q){throw Error("Override me");};this.refreshUi=function(){if(c){var q=b.getCtrlObject();c.setChecked(q.getIsRequired())}e.setItemModels(m(b.getDataType()));f.protectedRefreshUi(b)};this.protectedRefreshUi=
function(q){};this.getCtrlGap=function(){return 10};this.getCtrlHeight=function(){return 30};this.getParameter=function(){return b};this.funRefreshAreaByRequirdChanged=function(){};var a=function(q){var w=f.getCtrlHeight(),C=f.getCtrlGap(),I=0,ra=t.get("basicSetting","\u57fa\u7840\u8bbe\u7f6e"),V=t.get("type","\u7c7b\u578b"),K=t.get("status","\u72b6\u6001"),S=t.get("require","\u5fc5\u586b"),r=t.get("explain","\u8bf4\u660e");ra=f.createTitle(ra,I);I+=C+w;var l=b.getCtrlObject(),M=new rb;M.setText(V);
e=new vb;V=b.getDataType();e.setSelected(b.getCtrlType());e.setItemModels(m(V));e.setCustomPainter(function(y,N,W){y=$("<div>");y.text(O.ctrlTypeToName(W));N.append(y)});e.addSelectedChangedListener(n);V=M.getJqUi();M=e.getJqUi();f.decorateRow(V,M,I);I+=C+w;var ea=new rb;ea.setText(K);var P=new vb;P.setSelected(l.getCtrlState()?l.getCtrlState():Fa.STANDER);P.setItemModels(Fa.ALL_STATE_TYPE);P.setCustomPainter(function(y,N,W){y=$("<div>");W=W==Fa.STANDER?t.get("standard","\u6807\u51c6"):W==Fa.READONLY?
t.get("readOnly","\u53ea\u8bfb"):t.get("hide","\u9690\u85cf");y.text(W);N.append(y)});P.addSelectedChangedListener(function(y,N,W){N!==W&&l.setCtrlState(W)});K=ea.getJqUi();ea=P.getJqUi();f.decorateRow(K,ea,I);I+=C+w;if(b.getCtrlType()!==O.LABEL){var v=new rb;v.setText(S);c=new Db;c.setChecked(l.getIsRequired());v=v.getJqUi();var k=c.getJqUi();c.addCheckedListener(function(y,N){N&&l.setIsRequired(y.isChecked())});f.decorateRow(v,k,I);k.css("top",I+5);k.css("width",20);I+=C+w;var p=new rb;p.setText(r);
var z=new Kb;z.setTipsText(t.get("ctrlDesc","\u63a7\u4ef6\u7684\u8865\u5145\u8bf4\u660e\uff0c\u62a5\u8868\u67e5\u770b\u4eba\u5458\u53ef\u4ee5\u5728\u9884\u89c8\u62a5\u8868\u65f6\u67e5\u770b"));S=new fc;var G=S.getJqUi();S.setText(l.getDescription());S.addBlurListener(function(y){l.setDescription(y.getText());G.attr("title",y.getText())});S.addAcceptableListener(function(y,N){N&&(l.setDescription(y.getText()),G.attr("title",y.getText()))});z=z.getJqUi();p=p.getJqUi();G.attr("title",l.getDescription());
G.children().css({overflow:"hidden","text-overflow":"ellipsis"});f.decorateRow(p,G,I);S=new $b;S.setFontSize(12);r=S.measureWidth(r);wa.layoutCtrl(z,50<r?r+10:50,I+8);I+=C+w}q.append(ra);q.append(V);q.append(M);q.append(K);q.append(ea);q.append(v);q.append(k);q.append(p);q.append(z);q.append(G);q.css("height",I);return I},m=function(q){return q==B.NUMERICAL?[O.INPUT,O.LIST,O.CHECKBOX,O.F7,O.SWITCH,O.LABEL,O.SPINNER]:q==B.TXT||q==B.BOOLEAN?[O.INPUT,O.LIST,O.CHECKBOX,O.F7,O.SWITCH,O.LABEL]:[O.INPUT,
O.LIST,O.CHECKBOX,O.F7,O.DATE,O.LABEL]},n=function(q,w,C){if(w!==C)if(b.getCtrlObject().isConvertibleToOther())h(C);else{var I=Sb.createFeedbackDialog();I.setOptionType(Sb.OPTION_OK_CANCEL);I.setMessage(t.get("ctrlChangeDesc","\u6539\u53d8\u63a7\u4ef6\u7c7b\u578b\uff0c\u5c06\u4f1a\u6e05\u7a7a\u539f\u63a7\u4ef6\u7c7b\u578b\u7684\u6240\u6709\u5c5e\u6027\uff0c\u786e\u5b9a\u8981\u6539\u53d8\u5417\uff1f"));I.setClosingChecker(function(ra){ra==Sb.RETURN_OK&&h(C);return!0});I.showDialog();q.setSelected(w)}},
h=function(q){b.clearException(Ga.PARAM_CLIENT_ERROR);b.clearException(Ga.PARAM);b.setCtrlType(q);var w=b.getDataType();w=q==O.DATE&&w!=B.DATE&&w!=B.DATETIME&&w!=B.TIME?B.DATE:q==O.SPINNER?B.NUMERICAL:null;null!==w&&b.setDataType(w);q=x.createCtrl(q,b);q.setIsRequired(!1);q.setCtrlState(Fa.STANDER);q.setDefaultValueType(sa.CONSTANT);q.setBindSourceType&&q.setBindSourceType(ma.DATA_SET);b.setCtrlObject(q);yb.removeRender(b);Bb.removeLinkage(b);d();q.setBindSourceType&&b.addException(Ga.PARAM_CLIENT_ERROR,
b.getName(),t.get("ctrlPropRequiredTips","\u63a7\u4ef6\u5c5e\u6027\u5b58\u5728\u672a\u8bbe\u7f6e\u7684\u5fc5\u586b\u9879\u3002"));b.check()};this.decorateRow=function(q,w,C){q&&(wa.layoutCtrl(q,10,C),q.addClass("extreport-dataset-designer-param-ctrl-prop-detail-name"));w&&(wa.layoutCtrl(w,110,C),w.addClass("extreport-dataset-designer-param-ctrl-prop-detail-value"))};this.createTitle=function(q,w){return ua(q,w)}}function ia(b,d,f){var g,c,e;this.createAdvancedArea=function(a){e?e.empty():e=$("<div>");
e.css({position:"relative",width:"100%",height:"30px"});var m=ua(t.get("advancedSetting","\u9ad8\u7ea7\u8bbe\u7f6e"),0);g=new xa(b,d,f);c=g.getJqUi();c.css("top","40px");e.append(m);e.append(c);a&&a.append(e)};this.refreshLinkageUi=function(){g&&g.refreshUi()};this.getLinkageCtrl=function(){return g};this.getJqLinkage=function(){return c}}function ua(b,d){var f=$("<div>");f.text(b);f.addClass("extreport-dataset-designer-param-ctrl-prop-title");f.css("top",d);return f}function xa(b,d,f){function g(w,
C){Fb.call(this);var I=this,ra=this.protectedMethod,V,K,S=C.getModel().getParameters(),r=C.getCtrlObject(),l={},M,ea=[],P={},v=[];(function(){ra.setTitle(t.get("act","\u4f5c\u7528\u4e8e"));I.setSize(600,500);ra.setContentPaneCreator(function(){V||(V=$("<div>"),V.addClass("extreport-dataset-designer-linkage-to-index"),k(V));return V});ra.setClosingChecker(function(){for(var ja=0;ja<v.length;++ja){var Ia=v[ja];if(!Ia.getRelatedDSParamName()){if(Ia.getLinkageParamName())return ra.getMessageCurtain().showPrompt(t.get("selectParam",
"\u8bf7\u9009\u62e9\u4e00\u4e2a\u53c2\u6570")),!1;v.splice(ja,1);ja--}}Ia=Object.values(l);for(ja=0;ja<Ia.length;ja++)for(var Ua=Ia[ja],db=0;db<Ua.length;db++){var Ab=Ua[db];if("none"!=Ab.css("display")){var Cb=Ab.attr("title");break}}if(Cb)return ra.getMessageCurtain().showPrompt(Cb),!1;r.clearException(Ga.PARAM_CTRL_LINKAGE);r.setLinkageParams(v);return!0},!1);ra.setClosingAction(function(){K()});ra.setFooterClosingOnly(!1)})();this.setFunCloseCallBack=function(ja){K=ja};var k=function(ja){M=$("<div>");
var Ia=new Kb;Ia.setTipsText(t.get("ctrlParamTips","\u63a7\u4ef6\uff1a\u53c2\u6570\u5217\u8868\u4e2d\u53c2\u6570\u6240\u8bbe\u7f6e\u7684\u63a7\u4ef6\n\u53c2\u6570\uff1a\u63a7\u4ef6\u7684\u5907\u9009\u503c\u6765\u6e90\u4e8e\u6570\u636e\u96c6\u65f6\uff0c\u6570\u636e\u96c6\u6240\u5305\u542b\u7684\u53c2\u6570"));Ia=Ia.getJqUi();var Ua=$("<div>"),db=t.get("addTargetCtrl","\u6dfb\u52a0\u76ee\u6807\u63a7\u4ef6"),Ab=new $b;Ab.setFontSize(12);Ab=Ab.measureWidth(db);Ua.addClass("extreport-dataset-designer-linkage-to-ctrl-add-btn");
Ua.text(db);Ua.on("click",function(){var Cb=new pa;v.push(Cb);N(Cb);p();Cb=120*(v.length-1);$(ja).scrollTop(Cb)});Ua.css("width",Ab+15);M.append(Ia);M.append(Ua);ja.append(M);wa.layoutCtrl(Ia,Ab+15,2);wa.layoutCtrl(M,0,0,Ab+30,20);z()},p=function(){M.css({top:120*v.length+8})},z=function(){for(var ja=[],Ia=[],Ua=0;Ua<S.length;++Ua){var db=S[Ua],Ab=db.getCtrlObject();db!==C&&db.isLinkableParam()&&!Ab.getException(Ga.PARAM_CTRL_BIND_SOURCE)&&(Ab=Ab.getBindSource(),ja.push(Ab.toJsonObject()),Ia.push(db))}0<
ja.length?G(ja,Ia):y()},G=function(ja,Ia){var Ua=w.createParamCtrlFacade(function(db){if(db&&0<db.length){for(var Ab={},Cb=0;Cb<db.length;Cb++){for(var Tb=db[Cb],ec=[],Lb=Tb.parameters,Xb=0;Lb&&Xb<Lb.length;Xb++){var E=new ab;E.fromJsonObject(Lb[Xb]);ec.push(E)}Ab[Tb.datasetId]=ec}for(Cb=0;Cb<Ia.length;Cb++)E=Ia[Cb],db=E.getCtrlObject().getBindSource().getId(),(Tb=Ab[db])&&0<Tb.length&&ea.push(E),P[db]=Ab[db]}y()},function(){y()});Ua.setBlockingJqUi(V);Ua.queryBatchLinkageVO(ja)},y=function(){var ja=
r.getLinkageParams();if(ja)for(var Ia=0;Ia<ja.length;++Ia){var Ua=ja[Ia],db=new pa;db.setLinkageParamObject(Ua.getLinkageParamObject());db.setLinkageParamName(Ua.getLinkageParamName());db.setRelatedDSParamName(Ua.getRelatedDSParamName());v.push(db);N(db)}p()},N=function(ja){var Ia=$("<div>");Ia.addClass("extreport-dataset-designer-linkage-to-ctrl-row");var Ua=new rb;Ua.setText(t.get("targetCtrl","\u76ee\u6807\u63a7\u4ef6"));var db=new rb;db.setText(t.get("targetParam","\u76ee\u6807\u53c2\u6570"));
var Ab=Ua.getJqUi();Ab.addClass("extreport-dataset-designer-linkage-to-ctrl-label");var Cb=db.getJqUi();Cb.addClass("extreport-dataset-designer-linkage-to-ctrl-label");var Tb=new vb,ec=new vb,Lb=J.getErrorIcon(""),Xb=J.getErrorIcon("");Lb.hide();Xb.hide();Tb.setUserObject(Lb);ec.setUserObject(Xb);W(ja,Tb,ec,Ua,db);var E=ja.getLinkageParamName()+"^"+ja.getRelatedDSParamName();l[E]=[Lb,Xb];Ua=Tb.getJqUi();Ua.addClass("extreport-dataset-designer-linkage-to-ctrl-combobox");ec=ec.getJqUi();ec.addClass("extreport-dataset-designer-linkage-to-ctrl-combobox");
db=$("<div>");db.text("\u00d7");db.attr("title",t.get("clean","\u6e05\u9664"));db.addClass("extreport-dataset-designer-linkage-to-ctrl-close");db.on("click",function(){var Ba=v.indexOf(ja);v.splice(Ba,1);delete l[E];Ia.remove();p()});wa.layoutCtrl(Ab,10,17,null,null);wa.layoutCtrl(Lb,93,27,null,null);wa.layoutCtrl(Ua,null,15,null,null);wa.layoutCtrl(Cb,10,68,null,null);wa.layoutCtrl(Xb,93,78,null,null);wa.layoutCtrl(ec,null,65,null,null);Ia.append(Ab);Ia.append(Lb);Ia.append(Ua);Ia.append(Cb);Ia.append(Xb);
Ia.append(ec);Ia.append(db);V.append(Ia)},W=function(ja,Ia,Ua,db,Ab){var Cb=db=null,Tb=[];if(ja.getLinkageParamName())if(r.getException(Ga.PARAM_CTRL_LINKAGE,ta(ja)))H(Ia,t.get("cantfindParamCtrlName","\u627e\u4e0d\u5230\u539f\u63a7\u4ef6\u201c#1\u201d\u7684\u53c2\u6570\u540d\u79f0\u548c\u63a7\u4ef6\u540d\u79f0\u3002").replace("#1",ja.getLinkageParamName())),Ja(Ab,Ua);else if(db=ja.getLinkageParamObject(),Tb=P[ja.getLinkageParamObject().getCtrlObject().getBindSource().getId()],r.getException(Ga.PARAM_CTRL_LINKAGE,
fa(ja)))H(Ia,r.getException(Ga.PARAM_CTRL_LINKAGE,fa(ja))),Ja(Ab,Ua);else if(-1===ea.indexOf(db)&&!Tb)H(Ia,t.get("ctrlError","\u63a7\u4ef6\u201c#1\u201d\u5b58\u5728\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u8be5\u63a7\u4ef6\u7684\u6570\u636e\u6e90\u3002").replace("#1",ja.getLinkageParamName())),Ja(Ab,Ua);else if(Tb&&0===Tb.length)H(Ia,t.get("noParmInSource","\u63a7\u4ef6\u201c#1\u201d\u672a\u8bbe\u7f6e\u53c2\u6570\u3002").replace("#1",ja.getLinkageParamName())),Ja(Ab,Ua);else if(r.getException(Ga.PARAM_CTRL_LINKAGE,
A(ja))||!eb(Tb,ja.getRelatedDSParamName()))H(Ua,t.get("noFindParam","\u53c2\u6570\u201c#1\u201d\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664").replace("#1",ja.getRelatedDSParamName()));else if(Tb)for(var ec=0;ec<Tb.length;ec++)if(ja.getRelatedDSParamName()===Tb[ec].getName()){Cb=Tb[ec];break}db?Ia.setSelected(db):(Ab.setEnabled(!1),Ua.setEnabled(!1),Ia.setSelected(ja.getLinkageParamName()));Cb?Ua.setSelected(Cb):Ua.setSelected(ja.getRelatedDSParamName());Ia.setItemModels(ea);Ia.setCustomPainter(function(Lb,
Xb,E){if(E){Lb=$("<div>");var Ba=$("<div>");Ba.addClass("extreport-dataset-designer-linkage-to-ctrl-icon");Ma.background(Ba,O.ctrlTypeToMicroIconName(E.getCtrlType()));Xb.append(Ba);"string"===typeof E?Lb.text(E):Lb.text(E.getPatternText());wa.layoutCtrl(Lb,30,null,null,null);Xb.append(Lb)}});Ia.addSelectedChangedListener(function(Lb,Xb,E){Xb!==E&&(Lb=P[E.getCtrlObject().getBindSource().getId()],0===Lb.length?(Ab.setEnabled(!1),Ua.setEnabled(!1),H(Ia,t.get("ctrlNoSetParam","\u63a7\u4ef6\u201c#1\u201d\u672a\u8bbe\u7f6e\u53c2\u6570\u3002").replace("#1",
E.getName()))):(ja.setLinkageParamObject(E),ja.setRelatedDSParamName(""),Ua.setSelected(""),Y(Ia),Y(Ua),Ab.setEnabled(!0),Ua.setEnabled(!0)),Ua.setItemModels(Lb))});Tb&&Ua.setItemModels(Tb);Ua.setCustomPainter(function(Lb,Xb,E){if(E)if("string"===typeof E)Xb.text(E);else{Lb=$("<div>");var Ba=$("<div>");Ba.addClass("extreport-dataset-designer-linkage-to-param-icon");var qa=E.getDataType();qa=B.dataTypeToIconName(qa);la.background(Ba,qa);Xb.append(Ba);Lb.text(E.getPatternText());wa.layoutCtrl(Lb,30,
null,null,null);Xb.append(Lb)}});Ua.addSelectedChangedListener(function(Lb,Xb,E){if(Xb!=E){Lb=ja.getLinkageParamName()+"^"+E.getName();for(var Ba={},qa=0;qa<S.length;qa++){var aa=S[qa];if(aa!=C){var ha=aa.getCtrlObject();if(ha.getLinkageParams){ha=ha.getLinkageParams();for(var Wa=0;Wa<ha.length;Wa++){var Ka=ha[Wa];Ka=Ka.getLinkageParamName()+"^"+Ka.getRelatedDSParamName();Ba[Ka]=aa.getPatternText()}}}}for(qa=0;qa<v.length;qa++)aa=v[qa],aa.getLinkageParamName()&&aa.getRelatedDSParamName()&&(Ka=aa.getLinkageParamName()+
"^"+aa.getRelatedDSParamName(),Ba[Ka]=C.getPatternText());Ba[Lb]?(Ua.setSelected(Xb),Xb=t.get("actAlreadyExist","\u76ee\u6807\u53c2\u6570\u201c#1\u201d\u5df2\u5b58\u5728\u201c#2\u201d\u63a7\u4ef6\u7684\u4f5c\u7528\u4e8e\u5173\u7cfb\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002").replace("#1",E.getName()).replace("#2",Ba[Lb]),ra.getMessageCurtain().showPrompt(Xb)):(Y(Ua),ja.setRelatedDSParamName(E.getName()))}})},ta=function(ja){return C.getName()+"$"+ja.getLinkageParamName()+pb.LINKAGE_PARAM},fa=function(ja){return C.getName()+
"$"+ja.getLinkageParamName()+pb.LINKAGE_DS},A=function(ja){return C.getName()+"$"+ja.getLinkageParamName()+pb.LINKAGE_DS_PARAM},H=function(ja,Ia){ja=ja.getUserObject();ja.attr("title",Ia);ja.show()},Y=function(ja){ja=ja.getUserObject();ja.attr("title","");ja.hide()},Ja=function(ja,Ia){ja.setEnabled(!1);Ia.setEnabled(!1);Y(Ia)},eb=function(ja,Ia){for(var Ua,db=0;ja&&db<ja.length;db++)if(Ia===ja[db].getName()){Ua=ja[db];break}return Ua}}var c,e,a,m,n=d.getCtrlObject();this.getJqUi=function(){c||(c=
$("<div>"),h());return c};var h=function(){var w=new rb;w.setText(t.get("act","\u4f5c\u7528\u4e8e"));w=w.getJqUi();w.addClass("extreport-dataset-designer-param-ctrl-prop-detail-name");var C=new Kb;C.setTipsText(t.get("actTips","\u8bbe\u7f6e\u5b8c\u6210\u7684\u201c\u4f5c\u7528\u4e8e\u201d\u5173\u7cfb\u53ef\u4ee5\u5728\u201c\u63a7\u4ef6\u8054\u52a8\u89c6\u56fe\u201d\u4e2d\u67e5\u770b"));m=C.getJqUi();a=J.getErrorIcon(t.get("actConfigError","\u201c\u4f5c\u7528\u4e8e\u201d\u8bbe\u7f6e\u5b58\u5728\u9519\u8bef"));
n.getException(Ga.PARAM_CTRL_LINKAGE)||a.hide();e=new Eb;e.setClearable(!0);e.setCustomPainter(function(I){return I?t.get("haveSet","\u5df2\u8bbe\u7f6e"):""});e.addActionListener(q);e.addClearListener(function(){a.hide();n.setLinkageParams([]);n.clearException(Ga.PARAM_CTRL_LINKAGE);f();e.setModel(null)});C=e.getJqUi();C.addClass("extreport-dataset-designer-param-ctrl-prop-detail-value");0<n.getLinkageParams().length?e.setModel(!0):e.setModel(null);wa.layoutCtrl(w,10,1);wa.layoutCtrl(a,90,16);wa.layoutCtrl(m,
50,8);wa.layoutCtrl(C,110,0);c.append(w);c.append(a);c.append(m);c.append(C);c.css({width:"100%",height:"50px",position:"relative"})},q=function(){var w=new g(b,d);w.setFunCloseCallBack(function(){0<n.getLinkageParams().length?e.setModel(!0):e.setModel(!1);n.getException(Ga.PARAM_CTRL_LINKAGE)?a.show():a.hide();f()});w.showDialog()};this.refreshUi=function(){if(n.getLinkageParams()&&0<n.getLinkageParams().length){if(e.setModel(d),n.getException(Ga.PARAM_CTRL_LINKAGE)){this.showErrorMsg();return}}else e.setModel(null);
this.hideErrorMsg()};this.showErrorMsg=function(){a.show();m.hide()};this.hideErrorMsg=function(){a.hide();m.show()}}function Pa(){function b(V){KTDefaultCellRender.call(this,V);var K=this,S=this.paintCellUI;this.paintCellUI=function(r,l){var M=K.getCurrentRowIdx(),ea=K.getCurrentRow(),P=K.getCurrentColIdx(),v=ea.getUserObject();M<nb.getHeadRowCount()?S(r,l):0==P?(r=$(r),l=new ac,l.setChecked(v.getFid()==c?!0:!1),l.setUserObject(v),v=l.getJqUi(),v.addClass("extreport-dataset-designer-import-param-radio-btn"),
r.data("radio",l),r.addClass("import-dataset-table-radio-column"),r.append(v)):m&&m(M,ea,P,v,r)}}function d(){na.call(this);this.protectedMethod.setTotalSelectedRowAndSelectedAllVisual(!1,!1)}var f,g,c="",e,a,m,n=[],h,q,w=[];this.getJqUi=function(){f||(f=$("<div>"),C(f));return f};this.createHead=function(V,K){e=V;a=K};var C=function(V){q=new d;q.setJumpToPageListener(function(S,r,l){for(var M in n)(0,w[M])(S,r,l)});q.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);var K=q.getJqUi();
K.css({padding:"0px 0px",height:"30px"});V.append(K)};this.getPagination=function(){return q};this.setPageChangeListener=function(V){w.push(V)};this.setSelectedId=function(V){c=V};this.getSelectedId=function(){return c};var I=function(V){g=nb.createTable();g.setColumnFitVisibleWidth(!0);g.setSyncUIWhenModelChanged(!1);g.setDraggableAdjusting(!0,3,0,new X);nb.setupSingleRowSelection(g);g.getSelectionModel().addChangeListener(function(S,r){if(r=r[0]){var l=r.getRowIdx();r=g.getRow(l).getUserObject();
var M=g.searchJqCell(l,0).data("radio");if(M)if(S==KTSelectionModel.CHANGE_ADD)for(M.setChecked(!0),c=r.getFid(),h=l,S=0;S<n.length;S++)(0,n[S])(r);else S==KTSelectionModel.CHANGE_REMOVE&&M.setChecked(!1)}});var K=new b(g);K.setOutsideVisible(!1);g.setCellRender(K);ra();K=$(g.getUI());K.addClass("import-dataset-table");V.append(K)},ra=function(){g.setSyncUIWhenModelChanged(!1);var V=e&&e.length;g.addColumns(V);for(var K=nb.createHeadRow(g),S=0;S<V;S++)g.getColumn(S).setWidth(a[S]),K.getCell(S).setValue(e[S]);
g.setSyncUIWhenModelChanged(!0)};this.refreshTable=function(){nb.refresh(g);if(h){var V=KTSelectionModel.Target.createRow(h);g.getSelectionModel().addSelected(V)}};this.updateTable=function(V){g||I(f);g.getSelectionModel().removeAllSelecteds();nb.clear(g);ra();if(0===V.length)h=null,nb.refresh(g);else{g.setSyncUIWhenModelChanged(!1);var K=-1,S=new KTBorderStyle;S.setBottomBorderWidth(1);S.setBottomBorderPen("solid");S.setBottomBorderColor("#e5e5e5");for(var r=0;r<V.length;++r){var l=V[r];l.getFid()==
c&&(K=r);var M=nb.createRow(g,!1);M.setHeight(35);M.setBorder(S);M.setUserObject(l)}g.setSyncUIWhenModelChanged(!0);nb.refresh(g);-1!=K&&(h=nb.getHeadRowCount()+K,V=KTSelectionModel.Target.createRow(h),g.getSelectionModel().addSelected(V),g.scrollCellVisible(h,0,!0))}};this.setFuncCreateTableCell=function(V){m=V};this.addSingleClickListener=function(V){n.push(V)}}function va(){this.protectInit=function(){};this.getResult=function(){};this.repaint=function(b){};this.refreshUi=function(){}}function Qa(){var b,
d,f,g,c,e,a;this.getGroupId=function(){return c};this.setGroupId=function(m){c=m};this.getGroupPath=function(){return e};this.setGroupPath=function(m){e=m};this.getFid=function(){return b};this.getType=function(){return d};this.getName=function(){return f};this.getCreatorId=function(){return g};this.getSpaceId=function(){return a};this.fromJsonObject=function(m){b=m.dataSetID;d=parseInt(m.type);f=m.dataSetName;g=m.creatorId;a=m.spaceId}}function Mb(){var b=this,d,f=!1,g=0,c=[],e=!0,a,m,n;this.getParentNode=
function(){return a};this.setParentNode=function(h){a=h};this.getShowNode=function(){return this.getParentNode()?e&&this.getParentNode().getIsOpen():e};this.setShowNode=function(h){e=h};this.getIsOpen=function(){return f};this.setIsOpen=function(h){f=h};this.setLevel=function(h){g=h};this.getLevel=function(){return g};this.getChildren=function(){return c};this.addChild=function(h){c.push(h)};this.getIsPreset=function(){return d};this.getGroupName=function(){return n};this.getGroupID=function(){return m};
this.fromJsonObject=function(h,q,w){q.push(b);d=h.isPreset;m=h.extreportGroupID;n=h.extreportGroupName;f=w;h=h.children;for(var C=0;h&&C<h.length;C++){var I=new Mb;I.setParentNode(b);I.setLevel(g+1);I.fromJsonObject(h[C],q,w);b.addChild(I)}}}function Pb(b,d){Fb.call(this);var f=this,g=this.protectedMethod,c,e,a,m,n=!0;(function(){g.setTitle(t.get("selectMacro","\u9009\u62e9\u5b8f\u53d8\u91cf"));f.setSize(470,410);g.setSelectable(!0);g.setContentPaneCreator(function(){a||(a=$("<div>"));c=new w;b.addWindowResizeListener(q);
m=c.getJqUi();wa.layoutCtrl(m,0,0,"100%",260);m.appendTo(a);m&&m.show();return a});g.setClosingChecker2(function(C){b.removeWindowResizeListener(q);if(!n)return g.getMessageCurtain().showPrompt(t.get("loadingData1","\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019\u3002")),!1;if(C=c.getSelectedModel())return e(C.getUid()),!0;g.getMessageCurtain().showPrompt(t.get("noImportMacroSelected","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5b8f\u3002"));return!1},function(C){b.removeWindowResizeListener(q);g.destroy();return!0});
g.setClosingAction(function(C){})})();var h=function(C){n=C},q=function(){if(c){var C=c.getMacroTable();C&&nb.refresh(C)}};this.setFunSelectCallBack=function(C){e=C};var w=function(){da.call(this);var C=this.protectedMethod,I,ra=C.getPagination(),V=C.getSearchBox(),K,S;(function(){I=new Aa(b,!1,h);I.setPagination(ra);I.setSelectName(d);C.setTablePanel(I);C.setSelectListBoxValue([$a.ALLTYPE,$a.SINGLEMACRO,$a.MULTIMACRO]);C.setFunSelectListCustom(function(r,l,M){r=$("<div>");r.text($a.macroDialogTypeToName(M));
l.append(r)});C.setSearchDescription(t.get("searchTips","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));C.setSearchListener(function(r){K=V.getText().trim();I.updateMacroDataBySearch(K,S)});C.setSelectListBoxChangeListener(function(r,l,M){l!==M&&(S=M,K=V.getText().trim(),I.updateMacroDataBySearch(K,S))});C.setJumpToPageListener(function(r,l,M){K=V.getText().trim();I.updateMacroDataBySearch(K,S,r,l,M)})})();this.getMacroTable=function(){return I.getTable()}}}function Nb(b,d,f){Fb.call(this);var g=this,
c=this.protectedMethod,e,a,m,n,h=!0,q=sa.SPLIT,w=g.showDialog;this.showDialog=function(){c.setTitle(t.get("selectVar","\u9009\u62e9\u53d8\u91cf"));d?g.setSize(680,460):g.setSize(470,410);c.setSelectable(!0);c.setContentPaneCreator(function(){m||(m=$("<div>"));e=new ra;b.addWindowResizeListener(C);n=e.getJqUi();wa.layoutCtrl(n,0,0,"100%",260);n.appendTo(m);n&&n.show();return m});c.setClosingChecker2(function(V){b.removeWindowResizeListener(C);if(!h)return c.getMessageCurtain().showPrompt(t.get("loadingData1",
"\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019\u3002")),!1;if(V=e.getSelectedModel()){var K="",S="";if(d)for(var r=0;r<V.length;r++){var l=V[r];l.isSystemVar()?r===V.length-1?(K+=l.getText(),S+="@"+l.getName()):(K+=l.getText()+q,S+="@"+l.getName()+q):r===V.length-1?(K+=l.getName(),S+="$"+l.getUid()):(K+=l.getName()+q,S+="$"+l.getUid()+q)}else V.isSystemVar()?(K=V.getText(),S="@"+V.getName()):(K=V.getName(),S="$"+V.getUid());a(K,S)}else a("","");c.destroy();return!0},function(V){b.removeWindowResizeListener(C);
c.destroy();return!0});c.setClosingAction(function(V){});w();d&&e.updateSyncResultPane()};this.setFunSelectCallBack=function(V){a=V};var C=function(){if(e){var V=e.getMacroTable(),K=e.getSystemVarTable();V&&nb.refresh(V);K&&nb.refresh(K)}},I=function(V){h=V},ra=function(){function V(z){var G={},y,N,W,ta=[];this.getJqUi=function(){y||(y=$("<div>"),fa());return y};this.syncTableToMap=function(Y,Ja){if(Ja)for(Ja=0;Ja<Y.length;Ja++){var eb=Y[Ja];eb.isSystemVar()?G[eb.getName()]=eb:G[eb.getUid()]=eb}else for(Ja=
0;Ja<Y.length;Ja++)eb=Y[Ja],eb.isSystemVar()?delete G[eb.getName()]:delete G[eb.getUid()];H();ta=[];Y=Object.keys(G);for(Ja=0;Ja<Y.length;Ja++)ta.push(G[Y[Ja]]);W.setItemModels(ta)};this.containsModel=function(Y){return G[Y]?!0:!1};this.getSelectedModel=function(){return ta};var fa=function(){N=$("<div>");H();var Y=new bc(t.get("allClear","\u5168\u90e8\u6e05\u9664")),Ja=Y.getJqUi();Y.addActionListener(function(){ta.length=0;G={};W&&W.setItemModels([]);H();z()});W=new Yb;W.setBorderVisible(!1);W.setItemModels([]);
W.setCustomItemPainter(function(eb,ja){var Ia=$("<div>"),Ua=$("<div>"),db=180;Ma.background(Ua,"delete");if(ja.isSystemVar())Ia.text(ja.getText()),Ia.attr("title",ja.getText()),Ua.on("click",function(){var Cb=ja.getName();delete G[Cb];A(Cb)});else if(Ia.text(ja.getName()),Ia.attr("title",ja.getName()),Ua.on("click",function(){var Cb=ja.getUid();delete G[Cb];A(Cb)}),!ja.isUsable()){var Ab=J.getErrorIcon(t.get("macroAbnormalTips","\u5f53\u524d\u5b8f\u5b58\u5728\u5f02\u5e38\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4f7f\u7528\u3002"));
wa.layoutCtrlWithLRTB(Ab,0,0,null,10,null,null);Ia.css("padding-left","18px");db=160;Ia.append(Ab)}eb.on("mouseenter",function(){Ua.css("display","block");wa.layoutCtrl(Ia,null,null,db-13,null)});eb.on("mouseleave",function(){Ua.css("display","none");wa.layoutCtrl(Ia,null,null,db,null);wa.layoutCtrlWithLRTB(Ia,8,4,null,4,null,22)});Ia.css({"text-overflow":"ellipsis",overflow:"hidden"});Ua.css({display:"none",cursor:"pointer"});eb.css("height","30");wa.layoutCtrlWithLRTB(Ua,178,0,15,6,9,null);wa.layoutCtrlWithLRTB(Ia,
8,4,null,4,null,22);eb.append(Ia);eb.append(Ua)});Y=W.getJqUi();Y.children(":first-child").css("overflow-x","hidden");N.css({"line-height":"30px",color:"#404040"});Ja.css({"line-height":"20px",cursor:"pointer"});wa.layoutCtrl(N,5,5,120,30);wa.layoutCtrl(Ja,150,10,55,20);wa.layoutCtrl(Y,0,30,205,270);y.append(N);y.append(Ja);y.append(Y);wa.layoutCtrl(Y,0,30,205,275)},A=function(Y){ta=Object.values(G);W.setItemModels(ta);z(Y);H()},H=function(){var Y=t.get("seleVar","\u5df2\u9009\u53d8\u91cf (#)");Y=
Y.replace("#",Object.keys(G).length);N.text(Y);N.attr("title",Y)}}da.call(this,d);var K=this.protectedMethod,S=Sa.MACRO,r,l,M,ea=[],P=!1,v=K.getPagination(),k=K.getSearchBox(),p;(function(){if(tb.isNotEmptyStr(f)){var z=f.split(sa.SPLIT)[0];if(z.startsWith("@")&&!d){S=Sa.SYSTEM;var G=z}else{S=Sa.MACRO;var y=z}}d?(M=new V(function(N){if(N)for(var W=0;W<ea.length;W++){var ta=ea[W].getUserObject();ta&&(ta.isSystemVar()&&ta.getName()===N||ta.getUid&&ta.getUid()===N)&&(ea[W].setChecked(!1),S===Sa.SYSTEM?
l&&l.updateAllCheckBox():r&&r.updateAllCheckBox())}else{for(W=0;W<ea.length;W++)ea[W].setChecked(!1);P=!1;S===Sa.SYSTEM?l&&l.updateAllCheckBox():r&&r.updateAllCheckBox()}}),r=new Aa(b,d),l=new zb(b,d),r.setPagination(v),r.setResultPane(M),r.setArrCheckBox(ea),r.setContainAll(P),l.setPagination(v),l.setResultPane(M),l.setArrCheckBox(ea),l.setContainAll(P),K.setMulSelectTablePanel(M)):(r=new Aa(b,d,I),l=new zb(b,d,I),r.setPagination(v),l.setPagination(v));l.setSelectName(G);r.setSelectName(y);S===Sa.SYSTEM?
K.setTablePanel(l):K.setTablePanel(r);K.setSelectType(S);K.setSelectListBoxValue([Sa.MACRO,Sa.SYSTEM]);K.setFunSelectListCustom(function(N,W,ta){N=$("<div>");N.text(Sa.macroSysDialogTypeToName(ta));W.append(N)});K.setSearchDescription(t.get("searchTips","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));K.setSearchListener(function(N){p=k.getText().trim();S===Sa.MACRO?r.updateMacroDataBySearch(p,S):S===Sa.SYSTEM&&l.updateSystemDataBySearch(p)});K.setSelectListBoxChangeListener(function(N,W,ta){W!==ta&&
(S=ta,p=k.getText().trim(),d&&(P=!1),ta===Sa.MACRO?(K.setTablePanel(r),r.updateMacroDataBySearch(p)):ta===Sa.SYSTEM&&(K.setTablePanel(l),l.updateSystemDataBySearch(p)))});K.setJumpToPageListener(function(N,W,ta){p=k.getText().trim();S===Sa.MACRO?r.updateMacroDataBySearch(p,S,N,W,ta):S===Sa.SYSTEM&&l.updateSystemDataBySearch(p,N,W,ta)})})();this.updateSyncResultPane=function(){var z=[],G=[];if(tb.isNotEmptyStr(f)){for(var y=f.split(sa.SPLIT),N=0;N<y.length;N++){var W=y[N];W.startsWith("@")?z.push(W.substr(1)):
G.push(W.substr(1))}0<G.length&&(y=b.createMacroManageFacade(function(ta){if(ta)for(var fa=0,A=ta.length;fa<A;fa++){var H=new Ha;H.fromJsonObject(ta[fa]);M.syncTableToMap([H],!0);r&&r.updateTableByMul()}}),y.loadSelectMacros(G));0<z.length&&(y=b.createQueryFacade(function(ta){if(ta)for(var fa=0,A=ta.length;fa<A;fa++){var H=new ya;H.fromJsonObject(ta[fa]);M.syncTableToMap([H],!0)}}),y.loadSelectSysVars(z))}};this.getMacroTable=function(){return r.getTable()};this.getSystemVarTable=function(){return l.getTable()}}}
function Xa(b){var d=this,f,g,c;this.getJqUi=function(){f||(f=$("<div>"),wa.layoutCtrlWithLRTB(f,0,-10,null,70,-24,null),d.protectedInitTable());return f};this.protectedInitTable=function(){};this.protectedMethod={showNoDataUI:function(e){c||(c=$("<div>"),c.css({"text-align":"center","font-size":"16px","margin-top":b?"105px":"80px"}),f.append(c));g.hide();c.text(e);c.show()},setJqTableUI:function(e){g=e}}}function Aa(b,d,f){function g(k){KTDefaultCellRender.call(this,k);var p=this,z=this.paintCellUI;
this.paintCellUI=function(G,y){var N=p.getCurrentRowIdx(),W=p.getCurrentRow(),ta=p.getCurrentColIdx(),fa=W.getUserObject();W=fa&&fa.isUsable()?null:t.get("macroAbnormalTips","\u5f53\u524d\u5b8f\u5b58\u5728\u5f02\u5e38\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4f7f\u7528\u3002");N<nb.getHeadRowCount()?(z(G,y),m&&1===N&&0===ta&&(q=new Db,q.setChecked(C),q.addCheckedListener(function(A,H){if(H){C=A.isChecked();for(H=0;H<w.length;H++)A=w[H],A.setChecked(C);A=[];for(H=0;H<ra.length;H++){var Y=ra[H];Y.isUsable()&&
A.push(Y)}h.syncTableToMap(A,C)}}),W=q.getJqUi(),wa.layoutCtrlCenterAlign(W,14),wa.layoutCtrlWithLRTB(W,null,null,16,0,null,null),$(G).css({"z-index":"999",height:"25px"}),$(G).append(W))):(y=$("<div>"),y.css({"padding-left":"2px","padding-right":"2px","line-height":"28px",overflow:"hidden"}),W&&y.addClass("extreport-dataset-disable"),0==ta?m?(ta=new Db,ta.setUserObject(fa),ta.setChecked(h.containsModel(fa.getUid())),W&&ta.setEnabled(!1),ta.addCheckedListener(function(A,H){if(!fa.isUsable()&&(A.setChecked(!1),
H))return;H&&(A=A.isChecked(),h.syncTableToMap([fa],A),c.updateAllCheckBox())}),W=ta.getJqUi(),wa.layoutCtrlCenterAlign(W,14),wa.layoutCtrlWithLRTB(W,null,null,14,3,null,null),$(G).append(W),w.push(ta)):(l||M||(V=new dc,M=!0),nb.getHeadRowCount(),ta=new ac,ta.addCheckedListener(function(A,H){H&&(K=fa)}),W?ta.setEnabled(!1):K&&K.getUid()===fa.getUid()&&ta.setChecked(!0),V.addElement(ta),ta.setUserObject(fa),W=ta.getJqUi(),wa.layoutCtrlWithLRTB(W,14,0,null,0,0,null),W.appendTo(G)):1==ta?(Zb.highlightKeyWords(y,
S,fa.getUid()),W&&(y.css("padding-left","20px"),W=J.getErrorIcon(W),y.append(W)),y.appendTo(G)):2==ta?(Zb.highlightKeyWords(y,S,fa.getName()),y.appendTo(G)):3==ta?(W=fa.getDesc()?fa.getDesc():t.get("noDesc","\u6682\u65e0\u63cf\u8ff0"),Zb.highlightKeyWords(y,S,W),y.appendTo(G)):4==ta?(W=fa.isMultiValued()?t.get("multiValued","\u591a\u503c"):t.get("singleValued","\u5355\u503c"),y.text(W),y.appendTo(G)):5==ta&&(ta=new bc(t.get("preview","\u9884\u89c8")),W&&ta.setEnabled(!1),W=ta.getJqUi(),W.appendTo(G),
ta.addActionListener(function(){(new cc(b,fa,!0,v)).showDialog()}),wa.layoutCtrl(W,5,0,50,28),W.css("line-height","28px")))}}Xa.call(this,d);var c=this,e=c.protectedMethod,a,m=d,n,h,q,w,C,I,ra,V=new dc,K,S,r,l=!0,M=!1;this.getSelected=function(){return d?h.getSelectedModel():K};this.updateTableByMul=function(){ea();c.updateAllCheckBox()};this.updateMacroDataBySearch=function(k,p,z,G,y){var N=!z;S=k;r=(new Date).getTime()+"";k=b.createMacroManageFacade(function(W){W.timeStamp===r&&(N?P(W,p,n.resetPaginationAndJumpToFirstPage):
P(W,p,y),d&&c.updateAllCheckBox())},null,function(){setTimeout(function(){f&&f(!0)},0)});k.setBlockingJqUi($(I.getUI()));f&&f(!1);N?k.loadMacros(1,n.getPageSize(),S,p,r):k.loadMacros(z,G,S,p,r)};this.updateAllCheckBox=function(){for(var k,p=0;p<w.length;p++){var z=w[p].getUserObject();if(z&&(k=z.getUid(),void 0!=k&&z.isUsable()&&(C=h.containsModel(k),!C)))break}q&&q.setChecked(C)};this.protectedInitTable=function(){I=nb.createTable();I.setColumnFitVisibleWidth(!1);I.setDraggableAdjusting(!0,nb.getHeadRowCount(),
0,new X);var k=new g(I);k.setOutsideVisible(!0);I.setCellRender(k);I.setSyncUIWhenModelChanged(!1);I.addColumns(6);I.getColumn(0).setWidth(40);I.getColumn(1).setWidth(85);I.getColumn(2).setWidth(85);I.getColumn(3).setWidth(85);I.getColumn(4).setWidth(71);I.getColumn(5).setWidth(62);k=nb.createHeadRow(I);k.getCell(1).setValue(t.get("lowerCode","\u7f16\u7801"));k.getCell(2).setValue(t.get("lowerName","\u540d\u79f0"));k.getCell(3).setValue(t.get("desc","\u63cf\u8ff0"));k.getCell(4).setValue(t.get("returnValueType",
"\u8fd4\u56de\u503c"));k.getCell(5).setValue(t.get("operation","\u64cd\u4f5c"));I.setSyncUIWhenModelChanged(!0);k=$(I.getUI());wa.layoutCtrlWithLRTB(k,-1,12,null,0,0,null);k.appendTo(c.getJqUi());e.setJqTableUI(k);if(tb.isNotEmptyStr(a))if(m){var p=$a.ALLTYPE;r=(new Date).getTime()+"";k=b.createMacroManageFacade(function(z){z.timeStamp===r&&P(z,p,n.resetPaginationAndJumpToFirstPage)});k.setBlockingJqUi(null);k.loadMacros(1,n.getPageSize(),S,p,r)}else k=b.createMacroManageFacade(function(z){z&&(n.resetPaginationAndJumpToFirstPage(z.count),
n.jumpToPage(z.index))}),k.setBlockingJqUi($(I.getUI())),f&&f(!1),k.loadMacroPageIndexByUid(a.startsWith("$")?a.substr(1):a,n.getPageSize());else c.updateMacroDataBySearch(S,$a.ALLTYPE)};this.setPagination=function(k){n=k};this.setSelectName=function(k){a=k&&(k.startsWith("$")?k:"$"+k)};this.setArrCheckBox=function(k){w=k};this.setResultPane=function(k){h=k};this.setContainAll=function(k){C=k};this.getTable=function(){return I};var ea=function(k){I||c.protectedInitTable();nb.clearWithoutHead(I);V=
new dc;m?w.length=0:k||(K=null);if(ra&&0<ra.length){for(var p=!0,z,G=0,y=ra.length;G<y;G++){var N=ra[G],W=nb.createRow(I);m||(tb.isNotEmptyStr(a)?a==="$"+N.getUid()&&(z=W,K=N,a=null,p=!1):p&&!k&&N&&N.isUsable()&&(z=W,K=N,p=!1));W.setUserObject(N)}I.updateUI();M=l=!1;z&&I.scrollCellVisible(I.getRowIndex(z),0,!1)}},P=function(k,p,z){z(k.totalRow);k=k.macros;z=n.getJqUi();k&&0<k.length?z.show():z.hide();ra=[];z=0;for(var G=k.length;z<G;z++){var y=new Ha;y.fromJsonObject(k[z]);ra.push(y)}k&&0!==k.length?
I&&$(I.getUI()).show():tb.isNotEmptyStr(S)||void 0!==p&&p!==$a.ALLTYPE&&p!==Sa.MACRO?e.showNoDataUI(t.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):e.showNoDataUI(t.get("noMyOwnMacro","\u6682\u672a\u521b\u5efa\u5b8f"));n.refreshPagination();ea()},v=function(k,p){if(p){if(ra)for(var z=0,G=ra.length;z<G;z++){var y=ra[z];if(k&&k.getUid()===y.getUid()){k.setMacroStatus(fb.NOT_AVAILABLE);K&&K.getUid()==k.getUid()&&(K=null);break}}m&&h&&h.containsModel(k.getUid())&&
h&&h.syncTableToMap([k],!0);ea(p)}}}function zb(b,d,f){function g(P){KTDefaultCellRender.call(this,P);var v=this,k=this.paintCellUI;this.paintCellUI=function(p,z){var G=v.getCurrentRowIdx(),y=v.getCurrentRow(),N=v.getCurrentColIdx(),W=y.getUserObject();G<nb.getHeadRowCount()?(k(p,z),m&&1===G&&0===N&&(q=new Db,q.setChecked(C),q.addCheckedListener(function(ta,fa){if(fa){C=ta.isChecked();for(fa=0;fa<w.length;fa++)ta=w[fa],ta.setChecked(C);h.syncTableToMap(ra,C)}}),N=q.getJqUi(),wa.layoutCtrlCenterAlign(N,
14),wa.layoutCtrlWithLRTB(N,null,null,14,0,null,null),$(p).css({"z-index":"999",height:"25px"}),$(p).append(N))):(z=$("<div>"),z.css({"padding-left":"2px","padding-right":"2px","line-height":"28px",overflow:"hidden"}),0==N?m?(z=new Db,z.setUserObject(W),z.setChecked(h.containsModel(W.getName())),z.addCheckedListener(function(ta,fa){fa&&(ta=ta.isChecked(),h.syncTableToMap([W],ta),c.updateAllCheckBox())}),N=z.getJqUi(),wa.layoutCtrlCenterAlign(N,14),wa.layoutCtrlWithLRTB(N,null,null,14,3,null,null),
$(p).append(N),w.push(z)):(K||S||(r=new dc,S=!0),nb.getHeadRowCount(),N=new ac,N.addCheckedListener(function(ta,fa){fa&&(l=W)}),l&&l.getName()===W.getName()&&N.setChecked(!0),r.addElement(N),N.setUserObject(W),N=N.getJqUi(),wa.layoutCtrlWithLRTB(N,14,0,null,0,0,null),N.appendTo(p)):1==N?(Zb.highlightKeyWords(z,M,W.getName()),z.appendTo(p)):2==N?(Zb.highlightKeyWords(z,M,W.getText()),z.appendTo(p)):3==N&&(N=new bc(t.get("preview","\u9884\u89c8")),z=N.getJqUi(),z.appendTo(p),N.addActionListener(function(){(new cc(b,
W)).showDialog()}),wa.layoutCtrlWithLRTB(z,0,0,null,0,0,null),z.css("line-height","28px")))}}Xa.call(this,d);var c=this,e=c.protectedMethod,a,m=d,n,h,q,w,C,I,ra,V,K=!0,S=!1,r=new dc,l,M;this.getSelected=function(){return d?h.getSelectedModel():l};this.updateSystemDataBySearch=function(P,v,k,p){var z=!v;M=P;V=(new Date).getTime()+"";P=b.createQueryFacade(function(G){G.timeStamp===V&&(z?ea(G,n.resetPaginationAndJumpToFirstPage):ea(G,p),d&&c.updateAllCheckBox())},null,function(){setTimeout(function(){f&&
f(!0)},0)});P.setBlockingJqUi($(I.getUI()));f&&f(!1);z?P.loadSystemVar(M,1,n.getPageSize(),V):P.loadSystemVar(M,v,k,V)};this.updateAllCheckBox=function(P){var v;for(P=0;P<w.length;P++)if(v=w[P].getUserObject())if(v=v.getName(),void 0!=v&&(C=h.containsModel(v),!C))break;q&&q.setChecked(C)};this.protectedInitTable=function(){I=nb.createTable();I.setColumnFitVisibleWidth(!1);I.setDraggableAdjusting(!0,nb.getHeadRowCount(),0,new X);var P=new g(I);P.setOutsideVisible(!0);I.setCellRender(P);I.setSyncUIWhenModelChanged(!1);
I.addColumns(4);I.getColumn(0).setWidth(40);I.getColumn(1).setWidth(163);I.getColumn(2).setWidth(163);I.getColumn(3).setWidth(62);P=nb.createHeadRow(I);P.getCell(1).setValue(t.get("lowerCode","\u7f16\u7801"));P.getCell(2).setValue(t.get("lowerName","\u540d\u79f0"));P.getCell(3).setValue(t.get("operation","\u64cd\u4f5c"));I.setSyncUIWhenModelChanged(!0);P=$(I.getUI());wa.layoutCtrlWithLRTB(P,-1,12,null,0,0,null);P.appendTo(c.getJqUi());e.setJqTableUI(P);!d&&tb.isNotEmptyStr(a)?(P=b.createQueryFacade(function(v){v&&
(n.resetPaginationAndJumpToFirstPage(v.count),n.jumpToPage(v.index))}),P.setBlockingJqUi($(I.getUI())),f&&f(!1),P.loadSystemVarPageIndexByName(a.startsWith("$")?a.substr(1):a,n.getPageSize())):c.updateSystemDataBySearch("")};this.setPagination=function(P){n=P};this.setSelectName=function(P){a=P&&(P.startsWith("@")?P:"@"+P)};this.setArrCheckBox=function(P){w=P};this.setResultPane=function(P){h=P};this.setContainAll=function(P){C=P};this.getTable=function(){return I};var ea=function(P,v){v(P.totalRow);
P=P.systemVar;v=n.getJqUi();P&&0<P.length?v.show():v.hide();ra=[];v=0;for(var k=P.length;v<k;v++){var p=new ya;p.fromJsonObject(P[v]);ra.push(p)}P&&0!==P.length?I&&$(I.getUI()).show():e.showNoDataUI(t.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));n.refreshPagination();I||c.protectedInitTable();nb.clearWithoutHead(I);r=new dc;m?w.length=0:l=null;if(ra&&0<ra.length){P=!0;v=0;for(k=ra.length;v<k;v++){p=ra[v];var z=nb.createRow(I);if(!m)if(tb.isNotEmptyStr(a)){if(a===
"@"+p.getName()){var G=z;l=p;a=null;P=!1}}else P&&(G=z,l=p,P=!1);z.setUserObject(p)}I.updateUI();S=K=!1;G&&I.scrollCellVisible(I.getRowIndex(G),0,!1)}}}function ib(b,d){Fb.call(this);var f=this,g=this.protectedMethod,c,e,a,m,n,h,q;(new $b).setFontSize(12);var w=!1,C,I,ra,V=$("<div>"),K,S,r,l={},M,ea=new function(){var fa,A,H,Y,Ja,eb;this.hasPermission=function(){return w};this.getCurrentPath=function(){return M.getCurrentMenuPath()};this.getCurrentGroupId=function(){return Ja};this.setCurrentGroupId=
function(ja){Ja=ja};this.getGroupType=function(){return fa};this.setGroupType=function(ja){fa=ja};this.getDataSetType=function(){return A};this.setDataSetType=function(ja){A=ja};this.getSearchDataSetName=function(){return H};this.setSearchDataSetName=function(ja){H=ja};this.getSearchGroupName=function(){return Y};this.setSearchGroupName=function(ja){Y=ja};this.getTimeStamp=function(){return eb};this.newTimeStamp=function(){return eb=(new Date).getTime()};this.getDialogJqui=function(){return c}};(function(){g.setSelectable(!0);
f.setSize(810,570);g.getDialogCtrl().addResizeListener(function(){});g.setContentPaneCreator(function(){c=$("<div>");c.css({"border-bottom":"1px solid #E5E5E5","z-index":1});P();return c});g.setClosingAction(function(fa){});g.setFooterClosingOnly(!1)})();var P=function(){var fa=b.createParamCtrlFacade(function(A){f.setGroupTypeDispaly(A.bPermission);n=A.sCreatorId;m=A.sGroupId},function(){f.setGroupTypeDispaly(!1)},function(){v()});fa.setBlockingJqUi(c);d?fa.queryDataSourceInfo(d.getId(),d.getName(),
d.getGroupId(),d.getGroupName(),d.getSpaceId()):fa.queryDataSourceInfo()},v=function(){k(c);var fa=G();ra=I.protectInit();V.append(ra);var A,H=new bb;H.setHorizontalSplit(!0);H.setFirstSize(180,120,250);H.setSecondSize(590,-1,-1);H.setResizeMode(bb.RESIZE_MODE_FIRST_FIXED);H.setFirstChild(bb.createChildWrapper(fa,function(){clearTimeout(A);A=setTimeout(function(){I.refreshUi()},0)}));H.setSecondChild(bb.createChildWrapper(V));fa=H.getJqUi();fa.addClass("extreport-dataset-designer-import-param-split-left");
c.append(fa);g.setTitle(e);ta(m);a&&a.unobserve();a=new hb;a.setDelay(50);a.setCallback(function(){I.refreshUi()});a.observe()},k=function(fa){var A=0,H=$("<div>");H.addClass("extreport-dataset-designer-import-param-top");A=p(H,A);A=z(H,A);var Y=new Ib;Y.setSearchListenerDelay(500);Y.setPlaceholder(t.get("searchDataSetName","\u641c\u7d22\u6570\u636e\u96c6\u540d\u79f0"));Y.setShowSearchIcon(!0);var Ja=Y.getJqUi();Y.addSearchListener(function(){var eb=Y.getText().trim();ea.getSearchDataSetName()!=eb&&
(ea.setSearchDataSetName(eb),ta())});Y.addCloseListener(function(){ea.setSearchDataSetName("");ta()});wa.layoutCtrl(Ja,A,-3,200,24);H.append(Ja);fa.append(H)},p=function(fa,A){fa=0;var H=[T.USER,T.PRESET];if(w){fa="100000"===n?1:0;var Y=new vb;Y.setSelected(H[fa]);Y.setItemModels(H);Y.setCustomPainter(function(ja,Ia,Ua){ja=Ia.text;Ua=Ua==T.USER?t.get("myCategory","\u6211\u7684\u76ee\u5f55"):t.get("presetCategory","\u9884\u7f6e\u76ee\u5f55");ja.call(Ia,Ua)});Y.addSelectedChangedListener(function(ja,
Ia,Ua){if(Ia!==Ua){ea.setGroupType(Ua);ja=Object.keys(l);for(Ia=0;Ia<ja.length;Ia++){var db=l[ja[Ia]],Ab=db.getJqUi();db.getMenuType()==Ua?(M=db,Ab.css("display","block"),ea.setCurrentGroupId(M.getCurrentMenuId())):Ab.css("display","none")}ta()}});(new $b).setFontSize(12)}ea.setGroupType(H[fa]);for(Y=0;Y<H.length;++Y){var Ja=H[Y],eb=new jb(Ja,ea);eb.setFuncShowMatchMenuCountInfo(y);eb.setFuncShowContextArea(W);eb.setFuncHideContextArea(N);eb.appendSelectedChangedListener(h);l[Ja]=eb}M=l[H[fa]];return A},
z=function(fa,A){var H=[ub].concat(Q.ALL_DATASET_TYPE),Y=new vb;Y.setSelected(H[0]);ea.setDataSetType(H[0]);Y.setItemModels(H);Y.setCustomPainter(function(Ja,eb,ja){Ja=$("<div>");ja=ja==ub?t.get("allType","\u5168\u90e8\u7c7b\u578b"):Q.datesetTypeToName(ja);Ja.text(ja);eb.append(Ja)});Y.addSelectedChangedListener(function(Ja,eb,ja){eb!==ja&&(ea.setDataSetType(ja),ta())});H=Y.getJqUi();H.addClass("import-param-data-type-combo");H.css("left",A);A+=130;fa.append(H);return A},G=function(){var fa=$("<div>");
fa.css("border-right","1px solid #E5E5E5");C=new Ib;C.setPlaceholder(t.get("searchDirectoryname","\u641c\u7d22\u76ee\u5f55\u540d\u79f0"));C.setShowSearchIcon(!0);q=C.getJqUi();wa.layoutCtrl(q,null,null,"100%","27px");C.addEnterEventListener(function(){var eb=C.getText().trim();ea.getSearchGroupName()==eb?M.scrollToMenuBySearchText(eb):""==eb?(ea.setSearchGroupName(""),ta(),y(null)):(ea.setSearchGroupName(eb),M&&M.refreshMatchedNode())});C.addClearIconListener(function(){ea.setSearchGroupName("");
ta();y(null)});fa.append(q);fa.append(M.getJqUi());for(var A=Object.keys(l),H=0;H<A.length;H++){var Y=l[A[H]],Ja=Y.getJqUi();Y===M?Ja.css("display","block"):Ja.css("display","none");fa.append(Ja)}return fa},y=function(fa){fa&&ea.getSearchGroupName()?C.appendText(fa):C.hideText(fa)};this.buildContextArea=function(fa){I=fa};this.setTitle=function(fa){e=fa};this.setGroupTypeDispaly=function(fa){w=fa};this.setFuncBeforeCloseChecker=function(fa){g.setClosingChecker(function(){return fa(g)},!1)};this.closeDialog=
function(){g.destroy()};var N=function(){K||(K=$("<div>"),S=$("<div>"),S.addClass(),r=$("<div>"),Ma.background(r,"no_data"),K.addClass("extreport-dataset-designer-import-param-tip"),S.addClass("extreport-dataset-designer-import-param-tip-text"),r.addClass("extreport-dataset-designer-import-param-tip-background"),K.append(S),K.append(r),V.append(K));ea.getSearchDataSetName()||ea.getSearchGroupName()||ea.getDataSetType()!=ub?S.text(t.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):
ea.getGroupType()==T.PRESET?S.text(t.get("noPresetDataset","\u6682\u65e0\u9884\u7f6e\u6570\u636e\u96c6")):S.text(t.get("noDataSet","\u6682\u65e0\u6570\u636e\u96c6"));K&&K.show();ra&&ra.hide()},W=function(){K&&K.hide();ra&&ra.show()};this.updateMenu=function(fa,A,H){M.updateMenu(fa,H,A)};this.getDialogParam=function(){return ea};var ta=function(fa){var A=ea.getSearchDataSetName(),H=ea.getSearchGroupName(),Y=ea.getDataSetType();Y===ub&&(Y=null);var Ja=ea.getGroupType(),eb=ea.newTimeStamp(),ja=b.createParamCtrlFacade(function(Ia){if(ea.getTimeStamp()==
Ia[0]){var Ua=Ia[1];Ia=Ua.groups;Ua=Ua.countInMap;for(var db=[],Ab=null,Cb=0;Cb<Ia.length;Cb++)(new Mb).fromJsonObject(Ia[Cb],db,ea.getSearchDataSetName()&&0<ea.getSearchDataSetName().length);for(Cb=0;Cb<db.length;Cb++)if(fa&&fa===db[Cb].getGroupID()){Ab=db[Cb];break}f.updateMenu(db,Ua,Ab)}},function(){});ja.setBlockingJqUi(c);ja.loadDataSetMenu(A,H,Y,Ja,eb)};this.setFuncQueryRightAreaByMenu=function(fa){h=fa};this.getResult=function(){return I.getResult()}}function jb(b,d){var f=this,g,c,e,a=[],
m,n=[],h=0,q=[],w=[],C,I,ra,V,K=!0,S=new $b;S.setFontSize(12);this.getJqUi=function(){g||(g=r());return g};this.getMenuType=function(){return b};var r=function(){var A=$("<div>");m=$("<div>");m.text(t.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c"));m.addClass("extreport-dataset-designer-import-param-font");m.css("display","block");c=new Yb;c.setBorderVisible(!1);c.scrollSelectedToVisible();c.setCustomItemPainter(l);c.setCustomSelectedsPainter(ea);c.addSelectedChangedListener(G);
c.addSelectedChangedListener(P);var H=c.scrollSelectedToVisible;c.scrollSelectedToVisible=function(){K&&H()};e=c.getJqUi();e.addClass("extreport-dataset-designer-import-param-menu");A.append(m);A.append(e);return A},l=function(A,H){if(H.getShowNode()){A.addClass("extreport-dataset-designer-import-param-menu-node");if(0<H.getChildren().length)if(d.getSearchDataSetName()){a:{var Y=H.getChildren().concat();for(var Ja=0;Y&&Ja<Y.length;Ja++){var eb=Y[Ja];if(C&&C[eb.getGroupID()]){Y=!0;break a}if(eb.getChildren()&&
0<eb.getChildren().length)for(var ja=0;ja<eb.getChildren().length;ja++)Y.push(eb.getChildren()[ja])}Y=!1}Y&&M(A,H)}else M(A,H);Y=$("<div>");H.getIsPreset()&&(Ja=$("<div>"),Ja.addClass("extreport-dataset-designer-preset"),Ja.text(t.get("preset","\u9884\u7f6e")),Ja.css("margin-left","20px"),Y.css("padding-left",S.measureWidth(t.get("preset","\u9884\u7f6e"))+10),Ja.css("left",20*H.getLevel()+5+"px"),A.append(Ja));Y.addClass("extreport-dataset-designer-import-param-menu-text");Zb.highlightKeyWords(Y,
d.getSearchGroupName(),H.getGroupName());d.getSearchDataSetName()&&(Ja=$("<div>"),eb=C&&C[H.getGroupID()]?C[H.getGroupID()]:0,Ja.addClass("extreport-dataset-designer-import-param-count"),Ja.text("("+eb+")"),A.append(Ja));H.getGroupID()===f.getCurrentMenuId()&&A.addClass("sa-ctrl-list-item_selected_enabled");Y.css("left",20*H.getLevel()+20+"px");A.css("padding-left",20*H.getLevel()+"px");A.append(Y)}else A.hide()},M=function(A,H){var Y=$("<div>"),Ja=$("<div>");H.getIsOpen()?Ja.addClass("list-lower-triangle"):
Ja.addClass("list-right-triangle");Y.addClass("extreport-dataset-designer-import-param-icon");Y.append(Ja);Y.on("mousedown",function(eb){eb.preventDefault();eb.stopPropagation();H.getIsOpen()?(v(H),H.setIsOpen(!1),Ja.removeClass("list-lower-triangle"),Ja.addClass("list-right-triangle")):(k(H),H.setIsOpen(!0),Ja.addClass("list-lower-triangle"),Ja.removeClass("list-right-triangle"));K=!1;d.getSearchGroupName()||(q=n);p(q);setTimeout(function(){K=!0},0)});A.append(Y)},ea=function(A,H){(A=$(A[0]).find(".extreport-dataset-designer-preset"))&&
A.removeClass("preset-border-text-color");(H=$(H[0]).find(".extreport-dataset-designer-preset"))&&H.addClass("preset-border-text-color")},P=function(A,H,Y){q&&0<q.length&&(A=w.indexOf(q.indexOf(Y[0])),-1!==A&&(h=A,I(fa())))},v=function(A){A=A.getChildren();for(var H=0;H<A.length;H++)v(A[H]),A[H].setIsOpen(!1),A[H].setShowNode(!1)},k=function(A){A=A.getChildren();for(var H=0;H<A.length;H++)A[H].setShowNode(!0)},p=function(A){ra();m.css("display","none");e.css("display","block");c.setItemModels(A,function(H,
Y){return H.getGroupID()==Y.getGroupID()?!0:!1})},z=function(){d.setCurrentGroupId("");c.setSelecteds([]);q=[];w=[];I(null);V();e.css("display","none");m.css("display","block");d.getSearchDataSetName()||d.getSearchGroupName()||d.getDataSetType()!=ub?m.text(t.get("noSearchData","\u6ca1\u6709\u7b26\u5408\u641c\u7d22\u6761\u4ef6\u7684\u7ed3\u679c")):d.getGroupType()==T.PRESET?m.text(t.get("noPresetMenu","\u9884\u7f6e\u76ee\u5f55\u4e0b\u6ca1\u6709\u6570\u636e")):m.text(t.get("noMenu","\u6211\u7684\u76ee\u5f55\u4e0b\u6ca1\u6709\u6570\u636e"))};
this.setFuncShowMatchMenuCountInfo=function(A){I=A};this.setFuncShowContextArea=function(A){ra=A};this.setFuncHideContextArea=function(A){V=A};this.getCurrentMenuId=function(){var A=c.getSelecteds();return 0<A.length?A[0].getGroupID():""};this.getCurrentMenuPath=function(){var A=c.getSelecteds();if(0<A.length){var H="";for(A=A[0];A;)H=A.getGroupName()+H,(A=A.getParentNode())&&(H="/"+H);return H}return""};var G=function(A,H,Y){if(Y&&0<Y.length)for(A=Y[0].getGroupID(),d.setCurrentGroupId(A),H=0;H<a.length;H++)(Y=
a[H])&&Y(A)};this.appendSelectedChangedListener=function(A){a.push(A)};this.updateMenu=function(A,H,Y){C=Y;A&&(n=A);h=0;0>=n.length?z():d.getSearchGroupName()?f.refreshMatchedNode():y(n,n,H?H:n[0])};this.refreshMatchedNode=function(){q=[];w=[];for(var A=0;A<n.length;A++)if(!n[A].getParentNode()){var H={};W(n[A],H)&&N(n[A],H)}if(0>=q.length)z();else{A=[];for(H=0;H<w.length;H++)A.push(q[w[H]]);A=y(q,A,q[w[0]]);h=w.indexOf(q.indexOf(A));I(fa());h++}};var y=function(A,H,Y){var Ja;a:{if(Ja=f.getCurrentMenuId())for(var eb=
0;eb<H.length;eb++)if(Ja===H[eb].getGroupID()){Ja=eb;break a}Ja=-1}-1!==Ja?(H=H[Ja],G(null,null,c.getSelecteds())):H=Y;ta(H);p(A);return H},N=function(A,H){A.setShowNode(!0);q.push(A);if(-1!==A.getGroupName().toLowerCase().indexOf(d.getSearchGroupName().toLowerCase())&&(!d.getSearchDataSetName()||0<C[A.getGroupID()])){w.push(q.length-1);for(var Y=A.getParentNode();Y;)Y.setIsOpen(!0),Y=Y.getParentNode()}A=A.getChildren();for(Y=0;Y<A.length;Y++){var Ja=A[Y];H[Ja.getGroupID()]||N(Ja,H)}},W=function(A,
H){var Y=-1!==A.getGroupName().toLowerCase().indexOf(d.getSearchGroupName().toLowerCase())&&(!d.getSearchDataSetName()||0<C[A.getGroupID()]);if(!d.getSearchDataSetName()&&Y)return!0;A=A.getChildren();for(var Ja=!1,eb=0;eb<A.length;eb++)W(A[eb],H)?Ja=!0:(H[A[eb].getGroupID()]=A[eb],A[eb].setShowNode(!1));return Y||Ja};this.scrollToMenuBySearchText=function(A){0!==q.length&&A?(h===w.length&&(h=0),ta(q[w[h]]),p(q),h++):I(null)};var ta=function(A,H){A.setShowNode(!0);for(var Y=A;Y.getParentNode();)Y=
Y.getParentNode(),Y.setIsOpen(!0),Y.setShowNode(!0),H&&k(Y);c.setSelecteds([A]);c.scrollSelectedToVisible(A)},fa=function(){if(0!==w.length)return"("+(h+1)+"/"+w.length+")"}}function kb(b,d,f,g){va.call(this);var c=this,e,a,m=[],n,h,q,w=g,C=!0;this.protectInit=function(){e||(I(),e=a.getJqUi());return e};this.getResult=function(){return n};this.repaint=function(r){var l=c.getPagination(),M=l.getCurrentPage();l=l.getPageSize();h=(M-1)*l;r&&S(r)};this.refreshUi=function(){S()};this.getPagination=function(){return a.getPagination()};
this.IsInitializing=function(){return C};var I=function(r){r&&(n=r);a=new Pa;r=["","#",t.get("dataSetName","\u6570\u636e\u96c6\u540d\u79f0"),t.get("type","\u7c7b\u578b"),t.get("operation","\u64cd\u4f5c")];a.createHead(r,[10,10,80,50,20]);a.addSingleClickListener(function(l){w=l.getFid();n=l;n.setGroupId(d.getCurrentGroupId());n.setGroupPath(d.getCurrentPath())});a.setFuncCreateTableCell(K);a.setPageChangeListener(ra)};this.queryDataSetsByGroup=function(r){!w||q&&r!==q?(r=c.getPagination(),ra(1,r.getPageSize(),
r.resetPaginationAndJumpToFirstPage)):V()};var ra=function(r,l,M){var ea=b.createParamCtrlFacade(function(k){var p=[];if(k){var z=k.totalRow;k=k.arrDataSetVO;for(var G,y=0;y<k.length;y++){var N=new Qa;N.fromJsonObject(k[y]);w&&w===N.getFid()&&(G=N,w=null);p.push(N)}G?a.setSelectedId(G.getFid()):a.setSelectedId(p[0].getFid());M(z);c.repaint(p);C=!1}else c.repaint(p),M(0)},function(k,p){C=!1});q=d.getCurrentGroupId();var P=d.getSearchDataSetName(),v=d.getDataSetType();v===com.kingdee.bos.extreport.datasetdesigner.ctrl.DATA_SET_ALLTYPE&&
(v=null);ea.setBlockingJqUi(d.getDialogJqui());ea.loadDataSetByGroupId(r,l,q,P,v)},V=function(){var r=c.getPagination(),l=b.createParamCtrlFacade(function(v){v&&(r.resetPaginationAndJumpToFirstPage(v.totalRow),r.jumpToPage(v.targetPage))},function(v,k){});q=d.getCurrentGroupId();var M=r.getPageSize(),ea=d.getSearchDataSetName(),P=d.getDataSetType();P===com.kingdee.bos.extreport.datasetdesigner.ctrl.DATA_SET_ALLTYPE&&(P=null);l.setBlockingJqUi(d.getDialogJqui());l.loadDataSetByGroupId(1,M,q,ea,P,w)},
K=function(r,l,M,ea,P){l=$("<div>");l.addClass("import-dataset-table-row");var v="";2===M?d.getSearchDataSetName()?Zb.highlightKeyWords(l,d.getSearchDataSetName(),ea.getName()):(v=ea.getName(),l.text(v)):1===M?(r=h+r-nb.getHeadRowCount()+1,l.addClass("dataset-table-center-content"),l.text(r)):3===M?(r=ea.getType(),v=Q.datesetTypeToName(r),l.text(v)):4===M&&(l.text(t.get("preview","\u9884\u89c8")),l.css("color","#5582f3"),l.css("cursor","pointer"),l.addClass("dataset-table-center-content"),l.on("click",
function(){var k=ea.getFid(),p=ea.getName(),z=Qb.decodeParamFromUrl(window.location.search,"path"),G=Z.getUrlParamValue();k=Qb.appendParamToUrl(z+"/qing_rpt/dataSetPreview.do","dataSetId",k);k=Qb.appendParamToUrl(k,"dataSetName",p);k=Qb.appendParamToUrl(k,"isPreset",f);G&&(k=Qb.appendParamToUrl(k,"skin",G));Ya.openNewTab(p,k)}));$(P).append(l)},S=function(r){r&&(m=r);0!=document.body.clientHeight&&0!=document.body.clientWidth&&a.updateTable(m)}}function xb(){var b=[];this.createJqUi=function(g,c,
e){var a=new gc;a.setItemModel(b);a.setListItemPainter(d);a.setFunModelEqualsChecker(f);a.setShowName(!0);a.setEnableNameShow(!1);return a.createJqPopup(g,c,e)};this.setAllField=function(g){b=g};var d=function(g,c,e,a){c.hide();e.text(g.getPatternText());e.css("left","5px")},f=function(g,c){return g&&g.getAlias()==c.getAlias()?!0:!1}}function Gb(b,d,f){Fb.call(this);var g=this,c=this.protectedMethod,e,a=[],m=d.getCtrlObject(),n=!1,h=[],q=!0,w=!1,C=1,I,ra,V=[],K,S,r;(function(){c.setTitle(t.get("defaultValueSetting",
"\u9ed8\u8ba4\u503c\u8bbe\u7f6e"));g.setSize(640,480);c.setSelectable(!0);c.setContentPaneCreator(function(){K||(K=$("<div>"),S=$("<div>"),S.addClass("constant-value-dialog-shadow"),K.append(S),ea());return K});c.setClosingChecker2(function(){if(!n)return c.getMessageCurtain().showPrompt(t.get("loadingData1","\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019\u3002")),!1;if(!e)return!0;var k=e.getSelected();if(ra&&!isNaN(ra)&&k.length>ra)return k=t.get("exceedMaxSelect","\u9009\u62e9\u6570\u91cf\u8d85\u8fc7\u9650\u5236\uff0c\u6700\u591a\u53ef\u9009#1\u6761\u6570\u636e\u3002").replace("#1",
ra),c.getMessageCurtain().showPrompt(k),!1;I&&I(k);c.destroy();return!0});c.setClosingAction(function(k){})})();var l=function(){S.hide();q?w?e=new Oa(C):e=new ba(a,h):w?e=new wb(C):e=new R(a,h);e.setNoPermFieldIndex&&e.setNoPermFieldIndex(V);e.setSelectableItems(a);e.setSelected(h);K.append(e.getJqUi());e.updateTable&&e.updateTable()},M=function(k,p){S.hide();var z=$("<div>");La.background(z,"marco_error");z.addClass("constant-dialog-error-background");var G=$("<span>"),y=t.get("constantValueError",
"\u8be5\u5e38\u91cf\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u5e38\u91cf\u7684\u6570\u636e\u6e90\u4fe1\u606f\u662f\u5426\u6b63\u786e\uff0c\u70b9\u51fb");G.text(y);y=$("<span>");y.text(t.get("moreDetailBlank","\u67e5\u770b\u8be6\u7ec6"));y.addClass("extreport-error-darkmask-button");y.on("click",function(N){hc.showErrorDialog(k,p)});G.addClass("constant-dialog-error-tips");G.append(y);K.append(z);K.append(G)},ea=function(){var k=m.getBindSource();m.getTreeType&&m.getTreeType()!=
lb.NOT_TREE&&(w=!0,C=m.getTreeExpandLevel());m.getBindSourceType()===ma.SELF?(v(k),setTimeout(function(){n=!0;l()},0)):(r=(new Date).getTime()+"",k=b.createParamCtrlFacade(function(p){if(p&&r==p[0]){p=p[1];var z=p.entryList,G=p.head;V=p.noPermFieldIndex;for(p=0;p<z.length;p++){var y=z[p],N=new oa;N.setText(y.text);N.setValue(y.value);y.parentId&&N.setParentId(y.parentId);N.setId(y.id);N.setEntry(y.rows);N.setEntryHeadMap(G);a.push(N)}w&&((z=a)&&0!=z.length?(G=new Na,G.buildTree(z),z=G.getRootArray(),
G=[],P(z,0,G),a=G):a=void 0)}l();n=!0},function(p,z,G){n=!0;M(z,G);return!0}),k.setBlockingJqUi(S),k.getConstantValueFromSource(m.buildConstantQueryParams(r,f)))},P=function(k,p,z){for(var G=0;G<k.length;G++){var y=k[G];y.setLevel(p);z.push(y);(y=y.getChildren())&&P(y,p+1,z)}},v=function(k){var p={};p.FIELD_ALIAS=t.get("displayText","\u663e\u793a\u6587\u672c");p.FIELD_NAME=t.get("value","\u503c");k=k.getArrNameAliasPairs();for(var z={},G=0;G<k.length;G++){var y=k[G],N=y.getName();y=y.getAlias();var W=
{},ta=N+"_"+y;z[ta]||(z[ta]=!0,W.FIELD_NAME=N,W.FIELD_ALIAS=y,ta=new oa,ta.setText(y),ta.setValue(N),ta.setId(N),ta.setEntry(W),ta.setEntryHeadMap(p),a.push(ta))}};this.setMultiSelect=function(k){q=k};this.setSelectedModel=function(k){h=k};this.setConfirmCallback=function(k){I=k};this.setMaxSelect=function(k){ra=k};this.getDefaultValue=function(){for(var k="",p=e.getSelected(),z=0;z<p.length;z++)k=z===p.length-1?k+p[z].getValue():k+(p[z].getValue()+sa.SPLIT);return k};this.getDefaultAlias=function(){for(var k=
"",p=e.getSelected(),z=0;z<p.length;z++)k=z===p.length-1?k+p[z].getText():k+(p[z].getText()+sa.SPLIT);return k}}function wb(b){Ra.call(this,b);var d=this.protectedMethod,f=new dc;this.protectedCreateItemUi=function(g,c,e,a){var m=c.getValue();g=d.isSelected(m);e=new ac;e.setText(c.getText());e.setChecked(g);e.addCheckedListener(function(n,h){h&&d.selectOnlyOne(m)});f.addElement(e);return e.getJqUi()}}function Oa(b){Ra.call(this,b);var d=this,f=this.protectedMethod,g=!0,c,e,a;this.protectedInitBar=
function(h,q,w){a=new Db;a.setText(t.get("includeSubs","\u9009\u62e9\u65f6\u5305\u542b\u4e0b\u7ea7\u8282\u70b9"));a.setChecked(g);a.addCheckedListener(n);var C=a.getJqUi(),I=Vb.isEnglish()?161:130;wa.layoutCtrlWithLRTB(C,null,0,I,30,null,21);C.appendTo(h);c=new Db;c.setText(t.get("selectAll","\u5168\u9009"));c.setChecked(q);c.addCheckedListener(function(ra,V){if(V){ra=ra.isChecked();for(V=0;V<w.getRowsCount();V++){var K=w.getRow(V);if(!K.isHide()||a.isEnabled()&&a.isChecked())K=K.getCell(0).getValue(),
f.select(K.getValue(),ra)}d.resetScrollStatus(w);w.updateUI(!0);m()}});C=c.getJqUi();q=Vb.isEnglish()?26:0;wa.layoutCtrlWithLRTB(C,0,null,50+q,30,null,21);C.appendTo(h);e=new rb;m();C=e.getJqUi();wa.layoutCtrlWithLRTB(C,60+q,null,110,30,null,21);C.find(".sa-ctrl-label-text").css({overflow:"visible"});C.appendTo(h)};this.protectedGetBarHeight=function(){return 58};this.protectedAfterUpdateTree=function(h,q){c.setChecked(h);a.setEnabled(!q)};this.protectedIsIncludeSubs=function(){return g};this.protectedCreateItemUi=
function(h,q,w,C){var I=q.getValue();I=f.isSelected(I);var ra=new Db;ra.setUserObject(w);ra.setText(q.getText());ra.setChecked(I);ra.addCheckedListener(function(V,K){if(K){K=V.getUserObject();V=V.isChecked();var S=h.getRow(K).getCell(0),r=S.getValue();f.select(r.getValue(),V);if(g&&!C()){r=S.getTreeModel();var l=r.getLevel();for(K+=1;K<h.getRowsCount();K++){S=h.getRow(K).getCell(0);r=S.getTreeModel();if(r.getLevel()<=l)break;r=S.getValue();f.select(r.getValue(),V)}}h.updateUI(!0);K=!0;V=!1;for(S=
0;S<h.getRowsCount();S++)if(l=h.getRow(S),!l.isHide()&&(V=!0,l=l.getCell(0).getValue(),!f.isSelected(l.getValue()))){K=!1;break}c.setChecked(V&&K);m()}});return ra.getJqUi()};var m=function(){var h=0;for(var q=d.getSelectableItems(),w=0;w<q.length;w++)f.isSelected(q[w].getValue())&&h++;h=t.get("selectedCount","(\u5df2\u9009\u62e9#1\u9879)").replace("#1",h);e.setText(h)},n=function(h,q){q&&(g=h.isChecked())}}function Ra(b){function d(l){KTDefaultTreeHandlerRender.call(this,l);var M=this.create;this.create=
function(ea,P,v,k,p,z,G){return K()?[]:M(ea,P,v,k,p,z,G)}}function f(l){KTDefaultCellRender.call(this,l);var M=this;this.paintCellUI=function(ea,P){var v=M.getCell().getValue(),k=M.getCurrentRowIdx();v=c.protectedCreateItemUi(l,v,k,K);v.css("overflow","visible");v.children().css("overflow","visible");ea=$(ea);ea.css("overflow","visible");P?(P=$(P),P.css("overflow","visible"),v.appendTo(P),wa.layoutCtrlWithLRTB(v,4,0,null,0,null,"100%")):(v.appendTo(ea),wa.layoutCtrlWithLRTB(v,0,0,null,0,null,"100%"))}}
var g=23,c=this,e,a,m,n=!1,h=[],q=[],w;this.getJqUi=function(){if(!e){e=$("<div>");for(var l={},M=0,ea=q.length;M<ea;M++)q[M].getValue()&&(l[q[M].getValue()]=!0);a=l;n=!1;l=new KTable;l.setCellRender(new f(l));l.setTreeHandlerRender(new d(l));l.setSyncUIWhenModelChanged(!1);h&&1024<=h.length?l.setLargeDataMode(!0,!1):l.setLargeDataMode(!1);l.addColumn().setWidth(320);M=new KTStyle;M.setVerticalAlign("middle");l.setStyle(M);var P=h;if(0==P.length)M=!1;else{M=!0;var v=r(),k=!v;for(ea=0;ea<P.length;ea++){var p=
P[ea],z=S(p.getValue()),G=l.addRow();G.setHeight(g);var y=G.getCell(0);y.setValue(p);p=p.getLevel();p=new KTCellTreeModel(p);k&&I(G,p);y.setTreeModel(p);M=M&&z}if(v){var N;P={};for(ea=l.getRowsCount()-1;0<=ea;ea--){G=l.getRow(ea);y=G.getCell(0);v=y.getTreeModel();k=v.getLevel();p=y.getValue();if(S(p.getValue())){G.setHide(!1);var W=p.getParentId();(y=P[k])&&0!=y.length||(y=[]);y.push(p);P[k]=y}if(N&&N===k+1)if((y=P[N])&&0<y.length){z=!1;for(N=0;N<y.length;N++){var ta=y[N];if(W===p.getId()||ta&&ta.getParentId()===
p.getId()){z=!0;break}}if(z){var fa=!0;v.setExpanded(!0);G.setHide(!1);(y=P[k])&&0!=y.length||(y=[]);y.push(p);P[k]=y}else v.setExpanded(!1)}else v.setExpanded(!1);0===ea&&fa&&(G.setHide(!1),v.setExpanded(!0));N=k}G=0;W=Object.values(P);for(ea=0;ea<W.length;ea++)for(fa=W[ea],N=0;N<fa.length;N++)p=fa[N],G=p.getLevel()>G?p.getLevel():G;for(ea=l.getRowsCount()-1;0<=ea;ea--)if(G=l.getRow(ea),y=G.getCell(0),v=y.getTreeModel(),p=y.getValue(),W=v.getLevel(),(fa=P[W])&&0<fa.length){y=!1;for(N=0;N<fa.length;N++)if((k=
fa[N])&&k.getParentId()===p.getParentId()){y=!0;break}y?(G.setHide(!1),W<b-1&&v.setExpanded(!0)):I(G,v)}else I(G,v)}}l.updateUI();ea=c.protectedGetBarHeight()+6;G=$(l.getUI());wa.layoutCtrlWithLRTB(G,0,0,null,ea,0,null);e.append(G);l=[M,l];C(l[0],l[1])}return e};this.setSelectableItems=function(l){h=l};this.getSelectableItems=function(){return h};this.setSelected=function(l){q=l};this.getSelected=function(){var l=[];if(!a)return l;for(var M=0,ea=h.length;M<ea;M++){var P=h[M].getValue();a[P]&&l.push(h[M])}return l};
this.setItemHeight=function(l){g=l};this.protectedIsIncludeSubs=function(){return!1};this.resetScrollStatus=function(l){if(l&&l.isLargeDataMode()){var M=l.keepScrollStatus();M.v&&(M.v=0);l.restoreScrollStatus(M)}};var C=function(l,M){var ea=$("<div>");ea.css("border-bottom","1px solid #E5E5E5");var P=c.protectedGetBarHeight();wa.layoutCtrlWithLRTB(ea,0,0,null,0,null,P);m=new gb;m.setSearchingHandler(function(){var k=ra(M);c.resetScrollStatus(M);M.updateUI(!0);V(k)});P=m.getJqUi();wa.layoutCtrlWithLRTB(P,
0,null,"66%",0,null,23);P.css({"min-width":"214px !important","max-width":"500px !important"});P.appendTo(ea);P=new Db;P.setText(t.get("showOnlySelected","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));P.setChecked(n);P.addCheckedListener(function(k,p){p&&(n=k.isChecked(),k=ra(M),c.resetScrollStatus(M),M.updateUI(!0),V(k))});P=P.getJqUi();var v=Vb.isEnglish()?139:107;wa.layoutCtrlWithLRTB(P,null,23,v,0,null,21);P.appendTo(ea);c.protectedInitBar(ea,l,M);ea.appendTo(e)};this.protectedInitBar=function(l,M,
ea){};this.protectedGetBarHeight=function(){return 30};var I=function(l,M){M.getLevel()<b-1?(M.setExpanded(!0),l.setHide(!1)):M.getLevel()===b-1?(M.setExpanded(!1),l.setHide(!1)):(M.setExpanded(!1),l.setHide(!0))},ra=function(l){for(var M=K(),ea=!0,P=!1,v=65535,k=!1,p=0;p<l.getRowsCount();p++){var z=l.getRow(p),G=z.getCell(0),y=G.getTreeModel(),N=!0;y.getLevel()<=v&&(N=!1);var W=G.getValue();G=S(W.getValue());W=n&&!G||m.isSearching()&&!m.check(W.getText());var ta=N;ta=M?W:ta;z.setHide(ta);ta||(k=
!0);W||(P=P||G,ea=ea&&G);N||(v=y.isExpanded()?65535:y.getLevel())}c.protectedAfterUpdateTree(P?ea:!1,M);return k};this.protectedAfterUpdateTree=function(l,M){};this.protectedCreateItemUi=function(l,M,ea,P){throw Error("Override");};var V=function(l){l?(w&&w.remove(),w=null):w||(l=new rb,l.setText(t.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c")),l.setEnabled(!1),w=l.getJqUi(),wa.layoutCtrlWithLRTB(w,0,0,null,60,null,16),l.setAlign(rb.ALIGN_CENTER),w.appendTo(e))},K=function(){return n||
m&&m.isSearching()},S=function(l){return 1==a[l]},r=function(){if(a&&0<Object.keys(a).length){var l=h;if(0==l.length)return!1;for(var M=0;M<l.length;M++)if(S(l[M].getValue()))return!0}return!1};this.protectedMethod={isSelected:S,select:function(l,M){M?a[l]=!0:delete a[l]},selectOnlyOne:function(l){a={};a[l]=!0}}}function R(b,d){F.call(this);var f=this.protectedMethod,g=b,c=d;this.setSelectableItems=function(e){g=e};this.setSelected=function(e){c=e};this.protectedGetSelectableItems=function(){return g};
this.protectedCloneSelectedValue=function(){var e={};if(c)for(var a=0,m=c.length;a<m;a++)e[c[a].getValue()]=!0;return e};this.getSelected=function(){var e=f.acceptSelectingResult(),a=[];if(!e)return a;for(var m=0,n=g.length;m<n;m++){var h=g[m].getValue();if(e[h]){a.push(g[m]);break}}return a}}function F(){Da.call(this);var b=this.protectedMethod,d=new dc;this.protectedItemCreator=function(g){var c=g.getValue();c=b.isSelected(c);var e=new ac;e.addCheckedListener(f);e.setUserObject(g);e.setChecked(c);
d.addElement(e);return e.getJqUi()};var f=function(g,c){c&&(g.isChecked()?(g=g.getUserObject(),b.selectOnlyOne(g.getValue())):g.setChecked(!0))}}function ba(b,d){Ea.call(this);var f=this.protectedMethod,g=b,c=d;this.setSelectableItems=function(e){g=e};this.setSelected=function(e){c=e};this.protectedGetSelectableItems=function(){return g};this.protectedCloneSelectedValue=function(){var e={};if(c)for(var a=0,m=c.length;a<m;a++)e[c[a].getValue()]=!0;return e};this.getSelected=function(){var e=f.acceptSelectingResult(),
a=[];if(!e)return a;for(var m=0,n=g.length;m<n;m++){var h=g[m].getValue();e[h]&&a.push(g[m])}return a}}function Ea(){Da.call(this);var b=this,d=this.protectedMethod,f,g=[],c;this.protectedInitBar=function(h){f=new Db;f.setText(t.get("selectAll","\u5168\u9009"));f.addCheckedListener(n);var q=f.getJqUi();wa.layoutCtrlWithLRTB(q,0,null,80,30,null,21);q.appendTo(h);c=new rb;q=c.getJqUi();wa.layoutCtrlWithLRTB(q,80,0,null,30,null,21);q.find(".sa-ctrl-label-text").css({overflow:"visible"});q.appendTo(h);
e();return 55};this.protectedItemCreator=function(h){var q=h.getValue();q=d.isSelected(q);var w=new Db;w.addCheckedListener(m);w.setUserObject(h);w.setChecked(q);b.protectedIsExcludeMode()&&w.setCustomStyle("text-decoration","line-through");g.push(w);return w.getJqUi()};this.protectedIsExcludeMode=function(){return!1};this.protectedAfterUpdateTable=function(){a()};var e=function(){var h=0;for(var q=b.protectedGetSelectableItems(),w=0;w<q.length;w++)d.isSelected(q[w].getValue())&&h++;h=t.get("selectedCount",
"(\u5df2\u9009\u62e9#1\u9879)").replace("#1",h);c.setText(h)},a=function(){var h=!0,q=!1;d.visitAllVisibleSelectableItems(function(w){var C=!1;q=!0;d.isSelected(w.getValue())||(h=!1,C=!0);return C});f.setChecked(q&&h)},m=function(h,q){if(q){q=h.getUserObject();h=h.isChecked();for(var w=0;w<g.length;w++)g[w]&&g[w].getUserObject().getValue()===q.getValue()&&g[w].setChecked(h);d.select(q.getValue(),h);a();e()}},n=function(h,q){if(q){var w=h.isChecked();for(h=0;h<g.length;h++)g[h]&&g[h].setChecked(w);
d.visitAllVisibleSelectableItems(function(C){d.select(C.getValue(),w)});e()}}}function Da(){function b(v){KTDefaultCellRender.call(this,v);var k=this,p=this.paintCellUI;this.paintCellUI=function(z,G){var y=k.getCurrentRowIdx(),N=k.getCurrentRow(),W=k.getCurrentColIdx(),ta=N.getUserObject(),fa=K&&-1!=K.indexOf(W-1);y<nb.getHeadRowCount()?fa&&1==y?(W=N.getCell(W).getValue(),fa=new Kb,fa.setIconType(Kb.ICON_TYPE_QUESTION),fa.setTipsText(t.get("noFieldPermTips","\u60a8\u6ca1\u6709\u6743\u9650\u67e5\u770b\u8be5\u5b57\u6bb5\u6570\u636e\u3002")),
fa=fa.getJqUi(),fa.css({display:"inline-block",margin:"5px 0 0 3px"}),G=$("<div>"),G.attr("title",W),G.text(W),G.css({"margin-top":"5px",display:"inline-block"}),G.appendTo(z),fa.appendTo(z)):p(z,G):0==W?(W=f.protectedItemCreator(ta),W.css({position:"absolute",left:"30%",top:"2px",width:"23px",height:"23px"}),W.appendTo(z)):(G=ta.getEntry(),W=fa?"***":G?G[q[W-1]]:"",fa=$("<div>"),fa.attr("title",W),fa.text(W),fa.css({"line-height":"28px","padding-left":"10px","padding-right":"10px","text-align":"left",
overflow:"hidden","text-overflow":"ellipsis"}),fa.appendTo(z))}}function d(){KTableUIDraggableAdjustingHandler.CustomExpendor.call(this);this.getTailBlankForDragging=function(){return 10}}var f=this,g,c,e,a,m,n,h,q,w=[],C,I,ra,V={},K=[];this.getJqUi=function(){if(!g){var v=g=$("<div>");c=v;V=f.protectedCloneSelectedValue();I=!1;var k=$("<div>");k.appendTo(v);C=new gb;C.setSearchingHandler(ea);var p=C.getJqUi();wa.layoutCtrlWithLRTB(p,0,null,"66%",0,null,23);p.css({"min-width":"214px !important","max-width":"500px !important"});
p.appendTo(k);p=new Db;p.setText(t.get("showOnlySelected","\u4ec5\u663e\u793a\u9009\u4e2d\u9879"));p.setChecked(I);p.addCheckedListener(P);p=p.getJqUi();var z=Vb.isEnglish()?140:106;wa.layoutCtrlWithLRTB(p,null,0,z,0,null,21);p.appendTo(k);p=f.protectedInitBar(k);wa.layoutCtrlWithLRTB(k,0,0,null,0,null,p);a=new KTable;a.setFrozenRows(nb.getHeadRowCount());a.setDraggableAdjusting(!0,nb.getHeadRowCount(),0,new d);k=new KTStyle;k.setVerticalAlign("middle");k.setFontSize(Jb.getFontSize());k.setFontUnit("px");
k.setFontName(Jb.getFontName());k.setColor(com.kingdee.bos.qing.common.CommonTableSkin.COLOR);a.setStyle(k);k=new b(a);k.setOutsideVisible(!1);a.setCellRender(k);a.setSyncUIWhenModelChanged(!1);k=p+6;m=$(a.getUI());wa.layoutCtrlWithLRTB(m,0,0,null,k,0,null);m.appendTo(v)}return g};this.setNoPermFieldIndex=function(v){K=v};this.protectedGetSelectableItems=function(){throw Error("Impl");};var S=function(){ra&&1024<=ra.length?a.setLargeDataMode(!0,!1):a.setLargeDataMode(!1);var v=ra[0].getEntryHeadMap();
h||(v?(h=Object.values(v),q=Object.keys(v)):((v=ra[0].getEntry())||(v=f.protectedGetSelectableItems()[0].getEntry()),h=Object.keys(v),q=Object.keys(v)));n=h.length+1;if(0==w.length){var k=ra,p,z;v=[];for(p=0;p<h.length;p++)v[p]=0;for(p=0;p<k.length;p++){var G=k[p].getEntry();for(z=0;z<h.length;z++){var y=G[q[z]];20>p&&(y=y?y.toString().length:0,y=200<y?200:y,y=10>y?10:y,v[z]+=y)}}if(0==k.length)for(p=0;p<h.length;p++)v[p]+=h[p].length+10;p=0;z=[];G=20<=ra.length?20:ra.length;G=0===G?1:G;for(k=0;k<
h.length;k++){y=v[k]/G;var N=h[k]?h[k].length:0;y=y<N?N:y;p+=y;z.push(y)}for(k=0;k<h.length;k++)w.push(z[k]/p)}a.addColumns(n);k=nb.createHeadRow(a);a.getColumn(0).setWidth(32);for(v=1;v<n;v++)p=v-1,z=556,G=140,y=h.length*G,z||(z=y),N=Math.floor(z/y),2<=N&&(G*=N,y=h.length*G),p=y<z&&p===h.length-1?w[p]*G*h.length+(z-y):w[p]*G*h.length,a.getColumn(v).setWidth(p),k.getCell(v).setValue(h[v-1].toUpperCase());for(v=0;v<ra.length;v++)k=ra[v],nb.createRow(a).setUserObject(k)},r=function(){nb.clear(a);var v=
f.protectedGetSelectableItems();if(C.isSearching()||I){var k=C.getSelectedSearcherImplLogic();ra=$.grep(v,function(p){var z=!1,G=!I||M(p.getValue());p=p.getEntry();for(var y=Object.keys(p).length,N=0;N<y;N++)if(p[q[N]]&&(z=C.check(""+p[q[N]])),k){if(z)break}else if(!z)break;return z&&G})}else ra=v;0<ra.length&&S();1<a.getRowsCount()&&(v=new KTBorderStyle,v.setLeftBorderWidth(0),a.getRow(1).getCell(0).setBorder(v));a.updateUI();f.protectedAfterUpdateTable()};this.protectedAfterUpdateTable=function(){};
this.updateTable=function(){r()};this.protectedCloneSelectedValue=function(){throw Error("Impl");};this.protectedItemCreator=function(v){throw Error("Impl");};this.protectedInitBar=function(v){return 28};this.setItemHeight=function(v){};var l=function(){if(0==ra.length){if(!e){var v=new rb;v.setText(t.get("nothingSearched","\u627e\u4e0d\u5230\u7b26\u5408\u7684\u7ed3\u679c"));v.setEnabled(!1);e=v.getJqUi();wa.layoutCtrlWithLRTB(e,0,0,null,60,null,16);v.setAlign(rb.ALIGN_CENTER);e.appendTo(c)}}else e&&
e.remove(),e=null},M=function(v){return 1==V[v]},ea=function(){r();l()},P=function(v,k){I=v.isChecked();r();l()};this.protectedMethod={visitAllVisibleSelectableItems:function(v){for(var k=0;k<ra.length&&!v(ra[k]);k++);},isSelected:M,select:function(v,k){k?V[v]=!0:delete V[v]},selectOnlyOne:function(v){V={};V[v]=!0},acceptSelectingResult:function(){return V},protectedUpdateTable:r}}function gb(){Za.call(this);var b=this.protectedMethod,d;this.protectedInitUi=function(f,g){var c=new rb;c.setText(t.get("search",
"\u641c\u7d22"));var e=b.createAllSearchImpl();d=e[0];b.changeSearchImpl(e[0],!1);var a=new vb;a.setItemModels(e);a.setSelected(e[0]);a.setCustomPainter(function(m,n,h){h&&n.text(h.getCaption())});a.addSelectedChangedListener(function(m,n,h){d=h;b.changeSearchImpl(h,!0)});c=c.getJqUi();a=a.getJqUi();e=Vb.isEnglish()?10:0;wa.layoutCtrlWithLRTB(c,0,null,40+e,0,null,23);wa.layoutCtrlWithLRTB(a,33+e,null,74,0,null,23);wa.layoutCtrlWithLRTB(g,114+e,null,"45%",0,null,23);g.css({"min-width":"100px !important",
"max-width":"278px !important","margin-right":"5px"});f.append(c);f.append(a);f.append(g)};this.getSelectedSearcherImplLogic=function(){return d.getLogic()}}function Za(){var b=this,d,f,g,c;this.setSearchingHandler=function(a){c=a};this.isSearching=function(){return f&&f.getText()?!0:!1};this.check=function(a){return!(f&&f.getText())||g.check(a.toLowerCase(),(f?f.getText():null).toLowerCase())};this.clear=function(){f&&f.clear()};this.getJqUi=function(){d||(d=$("<div>"),b.protectedInitUi(d,e().getJqUi()));
return d};this.protectedInitUi=function(a,m){throw Error("Implement");};var e=function(){f=new Ib;f.setPlaceholder(t.get("searchTips","\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9"));f.addSearchListener(function(a){c()});f.setSearchListenerDelay(1E3);return f};this.protectedMethod={createAllSearchImpl:function(){return[new mb(!0),new mb(!1),new Va(!0),new Va(!1),new Ca(!0),new Ca(!1),new Ta(!0),new Ta(!1)]},changeSearchImpl:function(a,m){g=a;m&&c()}}}function ca(b){var d=this;this.getLogic=function(){return b};
this.getCaption=function(){return d.protectedGetCaption(!b)};this.protectedGetCaption=function(f){throw Error("Override");};this.check=function(f,g){f=d.protectedCheckImpl(f,g);return b?f:!f};this.protectedCheckImpl=function(f,g){throw Error("Override");}}function mb(b){ca.call(this,b);this.protectedGetCaption=function(d){return d?t.get("searchNotInclude","\u4e0d\u5305\u542b"):t.get("searchInclude","\u5305\u542b")};this.protectedCheckImpl=function(d,f){return 0<=d.indexOf(f)}}function Ta(b){ca.call(this,
b);this.protectedGetCaption=function(d){return d?t.get("searchNotEqual","\u4e0d\u7b49\u4e8e"):t.get("searchEqual","\u7b49\u4e8e")};this.protectedCheckImpl=function(d,f){return d===f}}function Va(b){ca.call(this,b);this.protectedGetCaption=function(d){return d?t.get("searchNotStartOf","\u5f00\u5934\u4e0d\u662f"):t.get("searchStartOf","\u5f00\u5934\u662f")};this.protectedCheckImpl=function(d,f){return 0==d.indexOf(f)}}function Ca(b){ca.call(this,b);this.protectedGetCaption=function(d){return d?t.get("searchNotEndOf",
"\u7ed3\u5c3e\u4e0d\u662f"):t.get("searchEndOf","\u7ed3\u5c3e\u662f")};this.protectedCheckImpl=function(d,f){var g=d.lastIndexOf(f);return 0<=g&&g==d.length-f.length}}function oa(){var b,d,f,g,c,e,a,m;this.setEntry=function(n){a=n};this.getEntry=function(){return a};this.setEntryHeadMap=function(n){m=n};this.getEntryHeadMap=function(){return m};this.setLevel=function(n){e=n};this.getLevel=function(){return e};this.setValue=function(n){b=n};this.getValue=function(){return b};this.setText=function(n){d=
n};this.getText=function(){return d};this.setId=function(n){f=n};this.getId=function(){return f};this.setParentId=function(n){g=n};this.getParentId=function(){return g};this.setChildren=function(n){c=n};this.getChildren=function(){return c};this.addChild=function(n){if(!(n instanceof oa))throw Error("Illegal argument. Argument should be instanceof ValueTextTreeNodeModel");null==c&&(c=[]);c.push(n)};this.addChildren=function(n){if(!(n instanceof Array))throw Error("Illegal argument.");null==c&&(c=
[]);c.concat(n)};this.toJsonObject=function(){var n={};n.value=this.getValue();n.text=this.getText();n.id=this.getId();n.parentId=this.getParentId();n.children=this.getChildren();return n};this.fromJsonObject=function(n){var h=n.value;h=(new tb).fromJsonEscapeString(h);this.setValue("null"==h?null:h);h=n.text;h=(new tb).fromJsonEscapeString(h);this.setText("null"==h?null:h);h=n.id;h=(new tb).fromJsonEscapeString(h);this.setId("null"==h?null:h);h=n.parentId;h=(new tb).fromJsonEscapeString(h);this.setparentId("null"==
h?null:h);n=n.children;this.setChildren("null"==n?null:n)};this.toJsonString=function(){var n='{"value":',h=this.getValue();h||""===h?(h=(new tb).toJsonEscapeString(h),n+='"'+h+'"'):n+="null";n+=',"text":';(h=this.getText())||""===h?(h=(new tb).toJsonEscapeString(h),n+='"'+h+'"'):n+="null";return n+"}"}}function za(){var b,d;this.setValue=function(f){b=f};this.getValue=function(){return b};this.setText=function(f){d=f};this.getText=function(){return d};this.toJsonObject=function(){var f={};f.value=
this.getValue();f.text=this.getText();return f};this.fromJsonObject=function(f){var g=f.value;g=(new tb).fromJsonEscapeString(g);this.setValue("null"==g?null:g);f=f.text;f=(new tb).fromJsonEscapeString(f);this.setText("null"==f?null:f)};this.toJsonString=function(){var f='{"value":',g=this.getValue();g||""===g?(g=JSON.stringify(g),f+=g):f+="null";f+=',"text":';(g=this.getText())||""===g?(g=JSON.stringify(g),f+=g):f+="null";return f+"}"}}function Na(){var b;this.getRootArray=function(){return b};this.buildTree=
function(d){if(!(d instanceof Array))throw Error("Illegal argument.");b=[];if(d&&0!=d.length){if(!(d[0]instanceof oa))throw Error("Illegal argument. Elements in Array should be instance of ValueTextTreeNodeModel.");for(var f=d.length,g={},c,e,a=0;a<f;a++)c=d[a],e=c.getId(),e||(e="treeAutoId_"+a,c.setId(e)),g[e]=c;for(a=0;a<f;a++)c=d[a],e=null,c.getParentId()&&(e=g[c.getParentId()]),e?e.addChild(c):b.push(c)}};this.clear=function(){b=[]}}function L(b,d,f){Rb.call(this);var g=this;(function(){g.setSelectedModel(b);
g.setCustomPainter(function(c,e){if(!c)return e.text(""),"";e.text(c.getPatternText())});g.setDropdownCreator(function(c,e,a){var m=new xb;m.setAllField(d);return m.createJqUi(c,e,a)});g.addSelectionListener(function(c,e,a){(c=c.getSelectedModel())&&f(c)})})()}function X(){var b;this.setSyncSearchingUI=function(d){b=d};this.getTailBlankForDragging=function(){return-1};this.isRowDraggable=function(d,f){return!1};this.isColumnDraggable=function(d,f){return 0===f||d.getColumnsCount()==f+1?!1:!0};this.getMinRowHeightLimited=
function(d,f){return 3};this.getMinColumnWidthLimited=function(d,f){return 4};this.rowDraggedAction=function(d,f,g){var c=d.isSyncUIWhenModelChanged();d.setSyncUIWhenModelChanged(!0);f=d.getRow(f);f.setHeight(f.getHeight()+g);d.setSyncUIWhenModelChanged(c)};this.setMinColumnWidth=function(d){};this.columnDraggedAction=function(d,f,g){var c=d.isSyncUIWhenModelChanged();d.setSyncUIWhenModelChanged(!0);f=d.getColumn(f);f.setWidth(f.getWidth()+g);d.setSyncUIWhenModelChanged(c);b&&b()}}"undefined"==typeof com&&
(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.ctrl&&(com.kingdee.bos.extreport.datasetdesigner.ctrl={});NS=com.kingdee.bos.extreport.datasetdesigner.ctrl;NS.AbstractTypeRender=D;NS.NormalAdvancedArea=
ia;NS.OptionalTable=Pa;NS.DialogMainTable=va;NS.LinkageRender=xa;NS.DataSetModel=Qa;NS.MacroSelectDialog=Pb;NS.MacroAndSysTemVarSelectDialog=Nb;NS.AbstractBindSourceRender=function(b,d,f,g){function c(){jc.call(this);var E=this;this.protectGetTableModelList=function(){return Y()};this.protectedGetTableColNumber=function(){return 4};this.protectedSetHeadWidthAndValue=function(aa,ha){var Wa=($(aa.getUI()).width()-80)/2;aa.getColumn(2).setWidth(Wa);aa.getColumn(3).setWidth(Wa);ha.getCell(2).setValue(t.get("displayText",
"\u663e\u793a\u6587\u672c"));ha.getCell(3).setValue(t.get("value","\u503c"))};this.protectedSetCellValue=function(aa,ha){var Wa=ha.getAlias();ha=ha.getName();aa.getCell(2).setValue(Wa?Wa:"");aa.getCell(3).setValue(ha?ha:"")};this.protectedDeleteRowsCallBack=function(aa){aa.forEach(function(ha){delete I[ha.getName()+"_"+ha.getAlias()]});0==Y().length&&(Tb(),g())};this.protectedAddBtnCallBack=function(){var aa=Y(),ha=new qb;ha.setAlias("");ha.setName("");aa.push(ha);g()};this.protectedPaintCell=function(aa,
ha,Wa,Ka){if(2===ha||3===ha)aa=$(Ka),ha=Wa.getCell(ha).getValue(),aa.text(ha),aa.css({"text-align":"center","line-height":"25px"}),Tb()};this.protectedSyncTableHeight=function(aa){m&&m.css("height",245+aa-130)};this.protectedInitTable=function(aa){nb.bindTextEditor(aa,Ba,qa)};this.protectedSetTitleStyle=function(aa){aa.setRequired(!0);aa.setText(t.get("supplyValue","\u5907\u9009\u503c"))};var Ba=function(aa,ha){return 2===ha||3===ha?!0:!1},qa=function(aa,ha,Wa,Ka,Ob){aa=aa.getUserObject();ha=E.getTable().getColumnIndex(ha);
3===ha?(ha=aa.getName(),ha!==Ka&&aa.setName(Ka)):2===ha&&(ha=aa.getAlias(),Ka!==ha&&aa.setAlias(Ka));Wa.setValue(Ka);return!0}}D.call(this,d,f);ia.call(this,b,d,g);var e=this,a=d.getCtrlObject(),m,n=[],h=cb.BINDSOURCE_ALIAS,q=cb.BINDSOURCE_NAME,w,C,I={},ra,V,K,S,r=sa.SPLIT,l;this.protectedInit=function(E){Ja()||a.getBindSourceType()===ma.SYSTEM&&A();e.protectedCreateSupplyArea(E);e.protectedCreateDefaultArea(E,!0);e.protectedCreateAdvancedArea(E);Ja()||(a.getBindSource()instanceof sb?(E=a.getBindSource(),
W(E.getId(),E.getGroupId(),E.getSpaceId(),E.getGroupName(),E.getName())):a.getBindSource()instanceof U&&ta(a.getBindSource().getMacroId()));a.getDefaultValueType()==sa.VARIABLE&&a.getDefaultValue()&&H();e.protectedUpdataDefaultUI()};this.protectedRefreshUi=function(){var E=a.getException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+pb.SOURCE_BIND);E&&(ra.attr("title",E),ra.show());if(E=eb("$VALUE_FIELD"))V.attr("title",E),V.show();if(E=eb("$DISPLAY_FIELD"))K.attr("title",E),K.show();if(E=Ia())S.attr("title",
E),S.show();a.getBindSourceType()===ma.SELF&&0<m.prop("offsetWidth")&&C&&C.updateTable();e.refreshLinkageUi()};this.protectedCreateSupplyArea=function(E){var Ba=e.getCtrlGap(),qa=e.getCtrlHeight();m||(m=$("<div>"));m.css({position:"relative",width:"100%"});var aa=e.createTitle(t.get("supplyValueSetting","\u5907\u9009\u503c\u8bbe\u7f6e"),0);m.append(aa);aa=0+(Ba+qa);var ha=new rb,Wa=t.get("sourceType","\u6765\u6e90\u7c7b\u578b");ha.setText(Wa);Wa=new vb;Wa.setItemModels(e.getArrBindType());Wa.setCustomPainter(function(Ka,
Ob,Ub){Ka=$("<div>");Ka.text(ma.sourceTypeToName(Ub));Ob.append(Ka)});Wa.addSelectedChangedListener(function(Ka,Ob,Ub){Ob!==Ub&&(a.setBindSourceType(Ub),a.clearDataSourcePropAndException(),n=[],Ub===ma.SYSTEM?(Ka=ob.createBindSource(ma.SYSTEM,d.getModel()),Ka.setSourceName(q[0]),Ka.setSourceAlias(h[0]),a.setBindSource(Ka),A(),fa()):(Ub===ma.SELF?(Ka=ob.createBindSource(ma.SELF,d.getModel()),Ka.setNameAliasPair([]),a.setBindSource(Ka)):a.setBindSource(null),d.addException(Ga.PARAM_CLIENT_ERROR,d.getName(),
t.get("ctrlPropRequiredTips","\u63a7\u4ef6\u5c5e\u6027\u5b58\u5728\u672a\u8bbe\u7f6e\u7684\u5fc5\u586b\u9879\u3002"))),Lb(),g())});Wa.setSelected(a.getBindSourceType());ha=ha.getJqUi();Wa=Wa.getJqUi();e.decorateRow(ha,Wa,aa);aa+=Ba+qa;m.append(ha);m.append(Wa);aa=p(E,m,aa);aa=z(E,m,aa);aa=e.funCustomizeSupplyArea(E,m,aa);m.css("height",aa);E&&E.append(m)};this.protectedCreateDefaultArea=function(E){var Ba=e.getCtrlGap(),qa=e.getCtrlHeight();w||(w=$("<div>"));w.css({position:"relative",width:"100%"});
var aa=0,ha=e.createTitle(t.get("defaultValueSetting","\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),aa);w.append(ha);aa+=Ba+qa;var Wa=new rb;Wa.setText(t.get("defaultValueType","\u9ed8\u8ba4\u503c\u7c7b\u578b"));ha=new vb;ha.setSelected(a.getDefaultValueType());ha.setItemModels(e.getArrDefaultType());ha.setCustomPainter(function(Ub,Hb,Wb){Ub=$("<div>");Ub.text(sa.defaultTypeToName(Wb));Hb.append(Ub)});ha.addSelectedChangedListener(function(Ub,Hb,Wb){Hb!==Wb&&(a.setDefaultValueType(Wb),a.clearDefaultRelativeChange(),
g(d),Tb())});Wa=Wa.getJqUi();var Ka=ha.getJqUi();e.decorateRow(Wa,Ka,aa);aa+=Ba+qa;w.append(Wa);w.append(Ka);Ua();wa.layoutCtrl(S,90,aa+15);w.append(S);Ka=t.get("defaultValue","\u9ed8\u8ba4\u503c");Wa=new rb;Wa.setText(Ka);Wa=Wa.getJqUi();Vb.isEnglish()&&Wa.attr("title",Ka);if(a.getDefaultValueType()===sa.CONSTANT){Ka=new Eb;M(Ka);var Ob=Ka.getJqUi();e.decorateRow(Wa,Ob,aa);aa+=Ba+qa;w.append(Wa);w.append(Ob)}else Ka=new Eb,v(Ka),Ob=Ka.getJqUi(),e.decorateRow(Wa,Ob,aa),aa+=Ba+qa,w.append(Wa),w.append(Ob);
k()&&(ha.setEnabled(!1),Ka.setEnabled(!1));w.css("height",aa);E&&E.append(w)};var M=function(E){var Ba=E.getJqUi();if(null!=a.getDefaultValue()){var qa=[];if(a.getBindSourceType()===ma.SELF){var aa=P();a.setDefaultValue(aa[0]);a.setDefaultAlias(aa[1])}aa=a.getDefaultValue()?a.getDefaultValue().split(r):[];for(var ha=a.getDefaultAlias()?a.getDefaultAlias().split(r):aa.concat(),Wa=0;Wa<Math.max(aa.length,ha.length);Wa++){var Ka=Wa<aa.length?aa[Wa]:"",Ob=Wa<ha.length?ha[Wa]:"",Ub=new za;Ub.setText(Ob);
Ub.setValue(Ka);qa.push(Ub)}}E.setClearable(!0);E.setCustomPainter(function(Hb){var Wb="";Hb&&0<Hb.length?(Wb=1<Hb.length?t.get("moreConstant","\u5df2\u9009\u62e9 #1 \u7b49N\u4e2a\u5e38\u91cf").replace("#1",Hb[0].getText()).replace("N",Hb.length):t.get("selectConstant","\u5df2\u9009\u62e9\u5e38\u91cf #1").replace("#1",Hb[0].getText()),Ba.attr("title",Wb)):Ba.attr("title","");return Wb});E.setModel(qa&&0<qa.length?qa:null);E.addActionListener(function(){if(!k()){var Hb=new Gb(b,d,n);Hb.setMultiSelect(e.IsMultiSelect());
Hb.setSelectedModel(qa?qa:[]);Hb.setMaxSelect(e.getMultiSelected());Hb.setConfirmCallback(function(Wb){qa=Wb;Wb=Hb.getDefaultValue(qa);var ic=Hb.getDefaultAlias(qa);a.setDefaultValue(Wb);a.setDefaultAlias(ic);E.setModel(qa);a.getBindSourceType()===ma.SELF&&ea();0<qa.length?E.setClearable(!0):E.setClearable(!1);db();S.hide()});Hb.showDialog()}});E.addClearListener(function(){Ab();qa=[];db();E.setModel(null);S.hide()})},ea=function(){I={};for(var E=a.getDefaultValue()?a.getDefaultValue().split(r):[],
Ba=a.getDefaultAlias()?a.getDefaultAlias().split(r):E.concat(),qa=Y(),aa={},ha=0;ha<qa.length;ha++){var Wa=qa[ha],Ka=Wa.getName()+"_"+Wa.getAlias();aa[Ka]=Wa}for(ha=0;ha<Math.max(E.length,Ba.length);ha++)Ka=(ha<E.length?E[ha]:"")+"_"+(ha<Ba.length?Ba[ha]:""),aa[Ka]&&(I[Ka]=aa[Ka])},P=function(){for(var E=Object.keys(I),Ba="",qa="",aa={},ha=0;ha<E.length;ha++){var Wa=I[E[ha]];if(Wa.getName()||Wa.getAlias())Ba+=Wa.getName()?Wa.getName():"",qa+=Wa.getAlias()?Wa.getAlias():"",aa[Wa.getName()+"_"+Wa.getAlias()]=
Wa,ha!=E.length-1&&(Ba+=r,qa+=r)}I=aa;return[Ba,qa]},v=function(E){var Ba=E.getJqUi();E.setClearable(!0);E.setCustomPainter(function(qa){var aa="";qa?(qa=qa.split(r),aa=1<qa.length?aa+t.get("moreVariable","\u5df2\u9009\u62e9 #1 \u7b49N\u4e2a\u53d8\u91cf").replace("#1",qa[0]).replace("N",qa.length):t.get("selectVariable","\u5df2\u9009\u62e9\u53d8\u91cf #1").replace("#1",qa[0]),Ba.attr("title",aa)):Ba.attr("title","");return aa});E.setModel(a.getDefaultAlias());E.addActionListener(function(){if(!k()){var qa=
new Nb(b,e.IsMultiSelect(),a.getDefaultValue());qa.setFunSelectCallBack(function(aa,ha){a.setDefaultAlias(aa);a.setDefaultValue(ha);E.setModel(aa);db();S.hide()});qa.showDialog()}});E.addClearListener(function(){Ab();db();E.setModel(a.getDefaultAlias());S.hide()})},k=function(){return Xb()||a.getBindSourceType()==ma.SELF&&a.getBindSource().getArrNameAliasPairs&&0==a.getBindSource().getArrNameAliasPairs().length};this.protectedCreateAdvancedArea=function(E){e.createAdvancedArea(E)};this.funCustomizeSupplyArea=
function(E,Ba,qa){return qa};this.getOutputColumnsInSource=function(){return n};this.getArrBindType=function(){return[ma.DATA_SET,ma.MACRO,ma.SYSTEM,ma.SELF]};this.getArrDefaultType=function(){return[sa.CONSTANT,sa.VARIABLE]};this.IsMultiSelect=function(){return!1};this.getMultiSelected=function(){return null};this.protectedInitDefaultField=function(){};var p=function(E,Ba,qa){E=e.getCtrlGap();var aa=e.getCtrlHeight(),ha=new rb;ha.setText(t.get("dataSource","\u6570\u636e\u6e90"));ha.setRequired(!0);
if(a.getBindSourceType()===ma.SELF){ha.setText(t.get("supplyValue","\u5907\u9009\u503c"));var Wa=new c;C=Wa;E=Wa.getJqUi();E.css("top","75px");Ba.append(E);ea();setTimeout(function(){Wa.updateTable()},0);return qa}if(a.getBindSourceType()===ma.SYSTEM){var Ka=new vb;Ka.setItemModels(h);var Ob=a.getBindSource();Ob&&Ob.getSourceAlias()&&Ka.setSelected(h[0]);Ka.setCustomPainter(function(Hb,Wb,ic){Wb.text(ic)});var Ub=Ka.getJqUi()}else a.getBindSourceType()===ma.MACRO?(Ka=new Eb,Ka.setModel(a.getBindSource()),
Ka.setCustomPainter(function(Hb){return Hb&&Hb.getMacroId()?Hb.getMacroId():""}),Ka.addActionListener(function(){G()}),Ub=Ka.getJqUi()):(Ka=new Eb,Ub=Ka.getJqUi(),Ka.setModel(a.getBindSource()),Ka.setCustomPainter(function(Hb){var Wb="";if(!Hb||!Hb.getId())return Wb;Hb instanceof sb&&(Wb=Hb.getGroupName(),Wb+="/"+Hb.getName(),Ub.attr("title",Wb));return Wb}),Ka.addActionListener(function(){y().showDialog()}));ha=ha.getJqUi();Ka=a.getException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+pb.SOURCE_BIND);
ra=J.getErrorIcon(Ka);Ka||ra.hide();wa.layoutCtrl(ra,90,qa+15);e.decorateRow(ha,Ub,qa);qa+=E+aa;Ba.append(ha);Ba.append(ra);Ba.append(Ub);return qa},z=function(E,Ba,qa){E=e.getCtrlGap();var aa=e.getCtrlHeight();if(a.getBindSourceType()!==ma.SELF){var ha=new qb;ha.setName(a.getValueFieldName());ha.setAlias(a.getValueFieldAlias());var Wa=new qb;Wa.setName(a.getDisplayFieldName());Wa.setAlias(a.getDisplayFieldAlias());var Ka=new rb;Ka.setText(t.get("valueField","\u53d6\u503c\u5b57\u6bb5"));var Ob=new rb;
Ob.setText(t.get("showField","\u663e\u793a\u5b57\u6bb5"));var Ub=new L(ha,n,function(ic){a.getValueFieldName()!==ic.getName()&&(Ub.getJqUi().attr("title",ic.getPatternText()),e.protectedChooseValueField(ic))}),Hb=new L(Wa,n,function(ic){a.getDisplayFieldName()!==ic.getName()&&(Hb.getJqUi().attr("title",ic.getPatternText()),e.protectedChooseDisplayField(ic))});0===n.length&&(Ub.setEnabled(!1),Hb.setEnabled(!1));V=ja("$VALUE_FIELD");K=ja("$DISPLAY_FIELD");Ka=Ka.getJqUi();var Wb=Ub.getJqUi();Wb.attr("title",
ha.getPatternText());ha=Ob.getJqUi();Ob=Hb.getJqUi();Ob.attr("title",Wa.getPatternText());e.decorateRow(Ka,Wb,qa);V&&(wa.layoutCtrl(V,90,qa+15),Ba.append(V));qa+=E+aa;e.decorateRow(ha,Ob,qa);K&&(wa.layoutCtrl(K,90,qa+15),Ba.append(K));qa+=E+aa;Ba.append(Ka);Ba.append(Wb);Ba.append(ha);Ba.append(Ob);return qa}};this.protectedChooseValueField=function(E){a.clearFieldRelativeChange("$VALUE_FIELD");V.hide();a.setValueFieldName(E.getName());a.setValueFieldAlias(E.getAlias());g(d);Tb()};this.protectedChooseDisplayField=
function(E){a.clearFieldRelativeChange("$DISPLAY_FIELD");K.hide();a.setDisplayFieldName(E.getName());a.setDisplayFieldAlias(E.getAlias());g(d);Tb()};var G=function(){var E=new Pb(b,a.getBindSource()&&a.getBindSource().getMacroId());E.setFunSelectCallBack(function(Ba){var qa=ob.createBindSource(ma.MACRO,d.getModel());qa.setMacroId(Ba);a.setBindSource(qa);a.clearDataSourcePropAndException();ta(Ba);g()});E.showDialog()},y=function(){var E=a.getBindSource();var Ba=E?new ib(b,E):new ib(b);Ba.setTitle(t.get("selectDataSet",
"\u9009\u62e9\u6570\u636e\u96c6"));var qa=new kb(b,Ba.getDialogParam(),!1,E&&E.getId());Ba.buildContextArea(qa);Ba.setFuncQueryRightAreaByMenu(qa.queryDataSetsByGroup);Ba.setFuncBeforeCloseChecker(function(aa){var ha=Ba.getResult();if(qa.IsInitializing())return aa.getMessageCurtain().showPrompt(t.get("loadingData1","\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019\u3002")),!1;if(!ha)return!0;if(ha.getFid()===ka.getUrlParamValue("dataSetId"))return aa.getMessageCurtain().showPrompt(t.get("selectSelfError",
"\u4e0d\u80fd\u5f15\u7528\u5f53\u524d\u6570\u636e\u96c6\u4f5c\u4e3a\u6570\u636e\u6e90\u3002")),!1;var Wa=Ba.getDialogParam(),Ka=ob.createBindSource(ma.SQL,d.getModel());Ka.setId(ha.getFid());Ka.setName(ha.getName());Ka.setGroupId(ha.getGroupId());Ka.setSpaceId(ha.getSpaceId());Ka.setGroupName(ha.getGroupPath());Wa.hasPermission();N(aa,Ka);return!1});return Ba},N=function(E,Ba){var qa=b.createParamCtrlFacade(function(aa){aa?(a.setBindSource(Ba),a.clearDataSourcePropAndException(),W(Ba.getId()),E.destroy()):
E.getMessageCurtain().showPrompt(t.get("errorDataSet","\u6570\u636e\u6e90\u201c#1\u201d\u5b58\u5728\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u8be5\u6570\u636e\u6e90\u3002").replace("#1",Ba.getName()))},function(){E.getMessageCurtain().showPrompt(t.get("errorDataSet","\u6570\u636e\u6e90\u201c#1\u201d\u5b58\u5728\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u8be5\u6570\u636e\u6e90\u3002").replace("#1",Ba.getName()));return!0});qa.setBlockingJqUi(m);qa.checkDataSetById(Ba.getId())},W=function(E,Ba,qa,aa,ha){var Wa=
a.getBindSource(),Ka=b.createParamCtrlFacade(function(Ob){n=[];if(Ob.error)a.addException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+pb.SOURCE_BIND,Ob.error),d.addException(Ga.PARAM_CLIENT_ERROR,d.getName(),t.get("ctrlPropSettingTips","\u63a7\u4ef6\u5c5e\u6027\u8bbe\u7f6e\u5b58\u5728\u9519\u8bef\u3002")),g(d);else{Ob.path&&Wa.repairSource(Ob.path,Ob.groupId,Ob.datasetId,Ob.datasetName);if(Ob=Ob.columns){for(var Ub=0;Ub<Ob.length;Ub++){var Hb=Ob[Ub],Wb=new qb;Wb.setName(Hb.name);Wb.setAlias(Hb.alias);n.push(Wb)}fa();
a.repairFieldAlias(n)}g()}Lb()},function(){n=[];Lb()});Ka.setBlockingJqUi(m);Ka.queryTableFieldsByDataSetId(E,Ba,qa,aa,ha)},ta=function(E){var Ba=b.createMacroManageFacade(function(qa){n=[];if(qa){for(var aa=0;aa<qa.length;aa++){var ha=new qb;ha.setName(qa[aa]);ha.setAlias(qa[aa]);n.push(ha)}fa()}Lb()},function(qa,aa){switch(qa){case 1200004:qa=t.get("noConnectionPerm","\u60a8\u6ca1\u6709\u9009\u62e9\u7684\u201c\u6570\u636e\u5e93\u8fde\u63a5\u201d\u7684\u6743\u9650\u3002");break;case 1200013:qa=t.get("noEntityPerm",
"\u60a8\u6ca1\u6709\u9009\u62e9\u7684\u57fa\u7840\u8d44\u6599\u7684\u6743\u9650\u3002");break;case 1200014:qa=t.get("entityNotExits","\u5b8f\u53d8\u91cf\u4f7f\u7528\u7684\u57fa\u7840\u8d44\u6599\u4e0d\u5b58\u5728\u3002");break;default:qa=t.get("macroCannotExe","\u8be5\u5b8f\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u5b8f\u4fe1\u606f\u662f\u5426\u6b63\u786e\u3002")}a.addException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+pb.SOURCE_BIND,qa);d.addException(Ga.PARAM_CLIENT_ERROR,d.getName(),
t.get("ctrlPropSettingTips","\u63a7\u4ef6\u5c5e\u6027\u8bbe\u7f6e\u5b58\u5728\u9519\u8bef\u3002"));n=[];g(d);Lb();return!0});Ba.setBlockingJqUi(m);Ba.loadMacroFieldsByUid(E)},fa=function(){if(0<n.length&&!a.getValueFieldName()){var E=n[0],Ba=E.getName();E=E.getAlias();a.setValueFieldName(Ba);a.setValueFieldAlias(E);a.setDisplayFieldName(Ba);a.setDisplayFieldAlias(E);e.protectedInitDefaultField()}},A=function(){for(var E=cb.BINDFIELD,Ba=0;Ba<E.length;Ba++){var qa=new qb;var aa=E[Ba];var ha=[];ha.push(aa.slice(0,
aa.indexOf(" ")));ha.push(aa.slice(aa.indexOf("[")+1,aa.indexOf("]")));aa=ha;qa.setName(aa[0]);qa.setAlias(aa[1]);n.push(qa)}},H=function(){var E=b.createParamCtrlFacade(function(Ba){Ba&&(a.repairDefaultAlias(Ba),Tb())},function(){return!0});E.setBlockingJqUi(w);E.repairVariableAlias(a.getDefaultValue(),a.getDefaultAlias())},Y=function(){var E=a.getBindSource();return E&&E.getArrNameAliasPairs&&E.getArrNameAliasPairs()},Ja=function(){return d.getException(Ga.PARAM_CLIENT_ERROR)?t.get("requireEmpty",
"\u5fc5\u586b\u9879\u4e3a\u7a7a"):a.getException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+pb.SOURCE_BIND)},eb=function(E){return a.getException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+E)},ja=function(E){E=eb(E);var Ba=J.getErrorIcon(E);!Ja()&&E||Ba.hide();return Ba},Ia=function(){return a.getException(Ga.PARAM_CTRL_DEFAULT_VALUE,d.getName())},Ua=function(){var E=Ia(),Ba=J.getErrorIcon(E);!Ja()&&E||Ba.hide();return S=Ba},db=function(){a.clearException(Ga.PARAM_CTRL_DEFAULT_VALUE);g(d);S&&S.hide()},Ab=function(){a.setDefaultValue(null);
a.setDefaultAlias(null)},Cb=function(){m&&m.empty();e.protectedCreateSupplyArea()},Tb=function(){w&&w.empty();e.protectedCreateDefaultArea()},ec=function(){e.protectedCreateAdvancedArea()},Lb=function(){Cb();Tb();ec()},Xb=function(){return!a.getBindSource()||a.getException(Ga.PARAM_CTRL_BIND_SOURCE,d.getName()+pb.SOURCE_BIND)||a.getBindSourceType()!=ma.SELF&&0===n.length};this.protectedUpdataDefaultUI=function(){var E=a.getDefaultValue();if(a.getBindSourceType()!=ma.SELF&&!Xb()&&tb.isNotEmptyStr(E)){l=
(new Date).getTime()+"";var Ba=b.createParamCtrlFacade(function(qa){if(qa&&l==qa[0]){qa=qa[1].entryList;for(var aa=0;aa<qa.length;aa++){var ha=qa[aa];tb.isNotEmptyStr(E)&&E==ha.value&&a.setDefaultAlias(ha.text,!0)}}Tb()},function(){var qa=a.getBindSourceType(),aa=a.getBindSource();switch(qa){case ma.SYSTEM:var ha=aa.getSourceAlias();break;case ma.MACRO:ha=aa.getMacroId();break;case ma.DATA_SET:ha=aa.getName()}a.addException(Ga.PARAM_CTRL_DEFAULT_VALUE,d.getName(),t.get("noDataSourceValue","\u6570\u636e\u6e90\u201c#1\u201d\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u8be5\u6570\u636e\u6e90\u3002").replace("#1",
ha));Tb();e.protectedRefreshUi();g();return!0});Ba.setBlockingJqUi(w);Ba.getConstantValueFromSource(a.buildConstantQueryParams(l))}};this.protectedMethod={refreshSupplyArea:Cb,refreshDefaultArea:Tb,getJqDisplayError:function(){return K},getJqDefaultError:function(){return S},getJqDefaultArea:function(){return w},initDefaultErrorIcon:Ua,getDefaultException:Ia,clearCtrlConstantValue:Ab,clearDefaultException:db,isNotValidDefaultCtrl:Xb,hasErrorInDefaultValue:k,refreshAdvanced:ec}};NS.SearchFieldSelector=
L;NS.ParamTableCustomExpandor=X;NS.ConstantValueSelectionPanel=Gb;NS.DataSetSelectorDialog=ib;NS.AppChooseDialogSelector=function(){var b,d,f,g,c,e;this.getJqUi=function(){d||(d=$("<div>"),c=new fc,c.setText(t.get("chooseApp","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5e94\u7528")),c.setReadonly("readonly"),g=c.getJqUi(),g.find(".sa-ctrl-textfield-input").css({"font-size":"12px"}),g.on("click",m),f=$("<div>"),Ma.background(f,"f7"),f.css("z-index","1"),f.css("cursor","pointer"),f.on("click",m),wa.layoutCtrl(g,
0,0,200,23),wa.layoutCtrl(f,180,5,16,16),f.appendTo(d),g.appendTo(d));return d};this.setEnabled=function(n){c&&c.setEnabled(n);g&&g.css({"pointer-events":"none"});f&&f.css({"pointer-events":"none"})};this.setFunSelectedChangeListener=function(n){e=n};this.setSelectedValue=function(n){b=n;a()};this.setDisplayText=function(n){c&&c.setText(n)};this.getSelectedValue=function(){return b};var a=function(){if(c){var n=c,h=n.setText,q=t.get("chooseApp","\u8bf7\u9009\u62e9\u4e00\u4e2a\u5e94\u7528");b&&(q=
b.text);h.call(n,q)}e&&e(b)},m=function(){var n=com.kingdee.bos.qing.integration.AppChooseForm;n.setCallBack(function(h){if(h&&h.content){h=h.content;var q=h.appNumber,w={};w.text=h.appName;w.value=q;b=w;a()}});n.openAppChooseForm(b?b.value:null)}};var O,Fa,B,x,Q,pa,ya,sa,ma,ab,Ga,sb,U,ob,qb,$a,Sa,fb,Ha,Bb,pb,lb,t,hb,Ya,Jb,rb,vb,Db,Kb,fc,Sb,ac,Fb,Eb,dc,bc,bb,Yb,Ib,Rb,wa,Qb,nb,$b,tb,Vb,Zb,cc,hc,gc,jc,na,Ma,Z,ka,la,La;(function(){var b=com.kingdee.bos.extreport.datasetdesigner.model;B=b.ParamDataType;
O=b.ParamCtrlType;Fa=b.ParamCtrlState;x=b.CtrlFactory;Q=b.DataSetType;pa=b.LinkageParamPair;ya=b.SystemVar;sa=b.ParamDefaultValueType;ma=b.ParamBindSourceType;ab=b.Parameter;Ga=b.DataSetModelCheckType;ob=b.BindSourceFactory;qb=b.NameAliasPair;$a=b.MacroDialogType;Sa=b.MacroOrSysDialogType;Ha=b.Macro;sb=b.DataSetSource;U=b.MacroVarSource;fb=b.MacroStatusEnum;Bb=b.LinkageRemover;pb=b.DataSetModelCheckCode;lb=b.ParamF7TreeType;b=com.kingdee.bos.qing.framework.common;t=b.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);
hb=b.WindowResizeObserver;Ya=b.TabbedUiUtil;Jb=b.GlobalFont;b=com.kingdee.bos.qing.ui.component;rb=b.Label;vb=b.ComboBox;Db=b.CheckBox;Kb=b.HelpIcon;fc=b.TextField;Sb=b.MessageDialog;ac=b.RadioButton;Fb=b.AbstractModalDialog;Eb=b.F7Selector;dc=b.RadioButtonGroup;bc=b.WorkButton;bb=b.SplitPane;Yb=b.List;Rb=b.DropdownSelector;b=com.kingdee.bos.qing.common;wa=b.DomUtil;Qb=b.Util;$b=b.TextMeasurer;b=com.kingdee.bos.extreport.datasetdesigner.common.ui;Zb=b.SearchHelper;cc=b.PreviewDialog;hc=b.DialogUtil;
gc=b.ChoosePropertyPane;jc=b.CheckBoxTable;b=com.kingdee.bos.extreport.datasetdesigner.common;tb=b.StringUtil;Vb=b.LanguageUtil;b=com.kingdee.bos.qing.common.ui;nb=b.TableUtil;b=com.kingdee.bos.qing.biz.common;na=b.ComplexPaginationBar;Ib=b.KeyBoardSearchBox;b=com.kingdee.bos.extreport.datasetdesigner;Ma=b.Icons;b=com.kingdee.bos.qing;Z=b.SkinUtil;ka=b.Seer;b=com.kingdee.bos.extreport.datasetdesigner;la=La=b.Icons})();var cb={BINDSOURCE_ALIAS:[t.get("curUserOrgScope","\u5f53\u524d\u7528\u6237\u4e1a\u52a1\u7ec4\u7ec7\u8303\u56f4")],
BINDSOURCE_NAME:[0],BINDFIELD:["id [ID]","number ["+t.get("code","\u7f16\u7801")+"]","name ["+t.get("name","\u540d\u79f0")+"]"]},yb=new function(){var b=[];this.clearRender=function(){b=[]};this.removeRender=function(d){for(var f=0;f<b.length;f++)b[f].getParameter()===d&&b.splice(f,1)};this.getRender=function(d){if(!d)return null;for(var f=0;f<b.length;f++){var g=b[f];if(g.getParameter()===d)return g}return null};this.cacheRender=function(d){b.push(d)}};NS.CtrlRenderCache=yb;var u=new function(){var b;
this.createRender=function(d,f,g,c,e){b||(b={},b[O.INPUT]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.InputCtrlRender,b[O.LIST]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.ListCtrlRender,b[O.DATE]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.DateRender,b[O.CHECKBOX]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.CheckBoxRender,b[O.F7]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.F7Render,b[O.SWITCH]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.SwitchCtrlRender,
b[O.SPINNER]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.SpinnerCtrlRender,b[O.LABEL]=com.kingdee.bos.extreport.datasetdesigner.paramctrl.LabelCtrlRender);return new b[d](f,g,c,e)}};NS.CtrlRenderFactory=u;var J=new function(){this.getErrorIcon=function(b){var d=$("<div>");d.text("!");d.addClass("extreport-dataset-designer-param-ctrl-fault-mark");d.attr("title",b);return d}};NS.ErrorIconFactory=J;var da=function(b){var d,f,g=Vb.isEnglish(),c=!!b,e,a,m,n=new na,h=new Ib,q,w,C,I,ra,V;this.getJqUi=
function(){if(!d){d||(d=$("<div>"));var r=new vb;r.setSelected(e?e:q[0]);r.setCustomPainter(w);r.setItemModels(q);r.addSelectedChangedListener(C);r=r.getJqUi();d.append(r);g?wa.layoutCtrl(r,0,0,120,20):wa.layoutCtrl(r,0,0,80,20);h.addSearchListener(ra);h.setSearchListenerDelay(500);h.setPlaceholder(I);h.setShowSearchIcon(!0);r=h.getJqUi();d.append(r);g?wa.layoutCtrl(r,140,0,190,20):wa.layoutCtrl(r,100,0,160,20);r=$("<div>");if(c){wa.layoutCtrl(r,0,32,647,310);f=$("<div>");wa.layoutCtrl(f,0,0,440,
308);S(f);K(f);var l=$("<div>");wa.layoutCtrlWithLRTB(l,440,0,null,0,0,null);l.css("border-left","1px solid #E5E5E5");var M=m.getJqUi();l.append(M);r.append(f);r.append(l)}else wa.layoutCtrl(r,0,32,440,254),f=$("<div>"),wa.layoutCtrl(f,0,0,440,252),K(f),S(f),r.append(f);d.append(r);r.css({"border-top":"1px solid #E5E5E5","border-bottom":"1px solid #E5E5E5"})}return d};this.getSelectedModel=function(){return a.getSelected()};var K=function(r){var l=a.getJqUi();wa.layoutCtrlWithLRTB(l,0,-10,null,36,
2,null);r.append(l)},S=function(r){n.setJumpToPageListener(V);n.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);var l=n.protectedMethod;l.setTotalSelectedRowAndSelectedAllVisual(!1,!1);l.setTotalPageVisual(!1);l.setFirstBtnAndEndBtnVisual(!1);l=n.getJqUi();wa.layoutCtrlWithLRTB(l,0,0,null,3,0,null);r.append(l)};this.protectedMethod={setSelectListBoxValue:function(r){q=r},setFunSelectListCustom:function(r){w=r},setSelectType:function(r){e=r},setTablePanel:function(r){a&&a.getJqUi().remove();
a=r;f&&K(f)},setSelectListBoxChangeListener:function(r){C=r},setJumpToPageListener:function(r){V=r},setSearchDescription:function(r){I=r},setSearchListener:function(r){ra=r;h&&h.addSearchListener(ra)},setMulSelectTablePanel:function(r){m=r},getSearchBox:function(){return h},getPagination:function(){return n}}},T={USER:1,PRESET:2};NS.TYPE_MENU=T;var ub=-1;NS.DATA_SET_ALLTYPE=ub})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.InputCtrlRender=
function(kb,xb,Gb,wb){Pa.call(this,xb,Gb);va.call(this,kb,xb,wb);var Oa=this,Ra=xb.getCtrlObject(),R=[D.CONSTANT,D.VARIABLE],F,ba;this.protectedInit=function(Ta){Ea(Ta);Oa.createAdvancedArea(Ta)};this.protectedRefreshUi=function(Ta){Oa.refreshLinkageUi()};var Ea=function(Ta){ba?ba.empty():ba=$("<div>");ba.css({position:"relative",width:"100%"});var Va=0,Ca=Oa.getCtrlHeight(),oa=Oa.getCtrlGap(),za=Oa.createTitle(Pb.get("defaultValueSetting","\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),Va);Va+=Ca+oa;var Na=Pb.get("defaultValueType",
"\u9ed8\u8ba4\u503c\u7c7b\u578b"),L=Pb.get("defaultValue","\u9ed8\u8ba4\u503c"),X=new Nb;X.setText(Na);Na=new Xa;Na.setSelected(Ra.getDefaultValueType());Na.setItemModels(R);Na.setCustomPainter(function(B,x,Q){B=$("<div>");var pa;Q==D.CONSTANT?pa=Pb.get("constant","\u5e38\u91cf"):Q==D.VARIABLE&&(pa=Pb.get("variant","\u53d8\u91cf"));B.text(pa);x.append(B)});Na.addSelectedChangedListener(function(B,x,Q){x!==Q&&(Ra.setDefaultValueType(Q),Ra.setDefaultAlias(""),Ra.setDefaultValue(""),ca(),Ea())});var O=
Ra.getException(ia.PARAM_CTRL_DEFAULT_VALUE,xb.getName());F=Mb.getErrorIcon(O);O||F.hide();ib.layoutCtrl(F,90,95);ba.append(F);O=new Nb;O.setText(L);if(Ra.getDefaultValueType()===D.CONSTANT){var Fa=new Aa;Fa.setText(Ra.getDefaultValue());Fa.addBlurListener(function(B){gb(Fa,B.getText().trim())});Fa.addAcceptableListener(function(B,x){x&&gb(Fa,B.getText().trim())});Fa.getJqUi().children().css({overflow:"hidden","text-overflow":"ellipsis"});Za(Ra.getDefaultValue())}else Fa=new zb,Fa.setClearable(!0),
Fa.setCustomPainter(function(B){var x="";B?(x=Pb.get("selectVariable","\u5df2\u9009\u62e9\u53d8\u91cf #1").replace("#1",B),Fa.getJqUi().attr("title",x)):Fa.getJqUi().attr("title","");return x}),Fa.setModel(Ra.getDefaultAlias()),Fa.addActionListener(function(){var B=new Qa(kb,!1,Ra.getDefaultValue());B.setFunSelectCallBack(function(x,Q){Ra.setDefaultAlias(x);Ra.setDefaultValue(Q);Fa.setModel(x)});B.showDialog()}),Fa.addClearListener(function(){Ra.setDefaultAlias("");Ra.setDefaultValue("");Fa.setModel("");
ca()}),Da(Fa,Ra.getDefaultAlias(),Ra.getDefaultValue());X=X.getJqUi();Na=Na.getJqUi();O=O.getJqUi();jb.isEnglish()&&O.attr("title",L);L=Fa.getJqUi();Oa.decorateRow(X,Na,Va);Va+=Ca+oa;Oa.decorateRow(O,L,Va);Va+=Ca+oa;ba.append(za);ba.append(X);ba.append(Na);ba.append(O);ba.append(L);Ta&&Ta.append(ba);ba.css("height",Va)},Da=function(Ta,Va,Ca){if(Ca){var oa=kb.createParamCtrlFacade(function(za){za.alias&&(Ra.repairDefaultAlias(za.alias),Ta.setModel(Ra.getDefaultAlias()));za.valid?ca():(za=ua.dataTypeToErrorMsg(xb.getDataType()).replace("#1",
Va),mb(za))},function(){(Ca+"").startsWith("@")?mb(Pb.get("sysVarCannotExe","\u8be5\u7cfb\u7edf\u53d8\u91cf\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u7cfb\u7edf\u53d8\u91cf\u662f\u5426\u6b63\u786e\u3002")):mb(Pb.get("macroCannotExe","\u8be5\u5b8f\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u5b8f\u4fe1\u606f\u662f\u5426\u6b63\u786e\u3002"));return!0});oa.setBlockingJqUi(ba);oa.loadVariableValue(Ca,xb.getDataType())}},gb=function(Ta,Va){Ra.setDefaultValue(Va);Ra.setDefaultAlias(Va);
Ta.getJqUi().attr("title",Va);Za(Va)},Za=function(Ta){if(Ta){var Va=!0;for(var Ca=xa.split(Ta,xb.getDataType()==ua.DATETIME),oa=0;oa<Ca.length&&Va;oa++){var za=Ca[oa];za.startsWith("$")||za.startsWith("@ExtRpt")||(Va=Va&&(!za||ua.defaultValueCheck(xb.getDataType(),za)))}}else Va=!Ta;Va?ca():(Ta=ua.dataTypeToErrorMsg(xb.getDataType()).replace("#1",Ta),mb(Ta))},ca=function(){Ra.getException(ia.PARAM_CTRL_DEFAULT_VALUE)&&(Ra.clearException(ia.PARAM_CTRL_DEFAULT_VALUE),F.attr("title",""),F.hide(),wb())},
mb=function(Ta){Ra.addException(ia.PARAM_CTRL_DEFAULT_VALUE,xb.getName(),Ta);F.attr("title",Ta);F.show();wb()}};var D,ia,ua,xa,Pa,va,Qa,Mb,Pb,Nb,Xa,Aa,zb,ib,jb;(function(){var kb=com.kingdee.bos.extreport.datasetdesigner.model;D=kb.ParamDefaultValueType;ua=kb.ParamDataType;ia=kb.DataSetModelCheckType;xa=kb.SplitHelper;kb=com.kingdee.bos.extreport.datasetdesigner.common;jb=kb.LanguageUtil;kb=com.kingdee.bos.qing.framework.common;Pb=kb.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);
kb=com.kingdee.bos.extreport.datasetdesigner.ctrl;Pa=kb.AbstractTypeRender;va=kb.NormalAdvancedArea;Qa=kb.MacroAndSysTemVarSelectDialog;Mb=kb.ErrorIconFactory;kb=com.kingdee.bos.qing.ui.component;Nb=kb.Label;Aa=kb.TextField;zb=kb.F7Selector;Xa=kb.ComboBox;kb=com.kingdee.bos.qing.common;ib=kb.DomUtil})()})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.ListCtrlRender=
function(ib,jb,kb,xb){zb.call(this,ib,jb,kb,xb);var Gb=this,wb=this.protectedMethod,Oa=jb.getCtrlObject(),Ra=[],R,F,ba,Ea=!1,Da;this.getArrDefaultType=function(){return[Nb.CONSTANT,Nb.FIRST_DATA,Nb.VARIABLE]};this.protectedUpdataDefaultUI=function(){};this.protectedCreateDefaultArea=function(mb,Ta){var Va=Gb.getCtrlGap()+Gb.getCtrlHeight();F||(F=$("<div>"));F&&F.empty();F.css({position:"relative",width:"100%"});var Ca=0,oa=Gb.createTitle(D.get("defaultValueSetting","\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),
Ca);F.append(oa);Ca+=Va;var za=new ua;za.setText(D.get("defaultValueType","\u9ed8\u8ba4\u503c\u7c7b\u578b"));oa=new ia;oa.setSelected(Oa.getDefaultValueType());oa.setItemModels(Gb.getArrDefaultType());oa.setCustomPainter(function(L,X,O){L=$("<div>");L.text(Nb.defaultTypeToName(O));X.append(L)});oa.addSelectedChangedListener(function(L,X,O){X!==O&&(Oa.setDefaultValueType(O),wb.clearCtrlConstantValue(),wb.clearDefaultException(),F&&F.empty(),Gb.protectedCreateDefaultArea())});za=za.getJqUi();var Na=
oa.getJqUi();Gb.decorateRow(za,Na,Ca);Ca+=Va;F.append(za);F.append(Na);za=wb.initDefaultErrorIcon();va.layoutCtrl(za,90,Ca+15);F.append(za);za=D.get("defaultValue","\u9ed8\u8ba4\u503c");Na=new ua;Na.setText(za);Na=Na.getJqUi();Pb.isEnglish()&&Na.attr("title",za);Oa.getDefaultValueType()==Nb.FIRST_DATA?(Oa.setDefaultValue(Nb.FIRST_DATA_SIGN),Oa.setDefaultAlias("\u7b2c\u4e00\u6761\u6570\u636e"),wb.hasErrorInDefaultValue()&&(oa.setEnabled(!1),R&&R.setEnabled(!1))):(gb(oa,Ta),Ta=R.getJqUi(),Gb.decorateRow(Na,
Ta,Ca),Ca+=Va,F.append(Na),F.append(Ta));F.css("height",Ca);mb&&mb.append(F)};var gb=function(mb,Ta){var Va=Oa.getDefaultValueType(),Ca=Oa.getBindSourceType(),oa=Oa.getBindSource();if(Va==Nb.VARIABLE){R=new xa;R.setModel(Oa.getDefaultAlias());R.setClearable(!0);R.addClearListener(function(){wb.clearCtrlConstantValue();wb.clearDefaultException()});var za=R.getJqUi();R.setCustomPainter(function(B){if(B)return B=D.get("selectVariable","\u5df2\u9009\u62e9\u53d8\u91cf #1").replace("#1",B),za.attr("title",
B),B;za.attr("title","");return""});R.addActionListener(function(){var B=new Aa(ib,!1,Oa.getDefaultValue());B.setFunSelectCallBack(function(x,Q){Oa.setDefaultAlias(x);Oa.setDefaultValue(Q);R.setModel(x);wb.clearDefaultException()});B.showDialog()})}else{Ra=[];R=new ia;var Na=Oa.getDefaultValue();if(wb.isNotValidDefaultCtrl())Za();else if(Ca==Xa.SELF)if(Va=oa.getArrNameAliasPairs(),0!=Va.length){Ra=[];for(var L=0;L<Va.length;L++){var X=!0,O=Va[L];if(Mb.isNotEmptyStr(O.getAlias())||Mb.isNotEmptyStr(O.getName())){for(var Fa=
0;Fa<Ra.length;Fa++)JSON.stringify(Ra[Fa].toJsonObject())==JSON.stringify(O.toJsonObject())&&(X=!1);X&&Ra.push(O)}}Za()}else wb.clearCtrlConstantValue();else Da=(new Date).getTime()+"",Va=ib.createParamCtrlFacade(function(B){if(B&&Da==B[0]){B=B[1].entryList;for(var x,Q=0;Q<B.length;Q++){var pa=B[Q];x=new Pa;x.setName(pa.value);x.setAlias(pa.text);Ta&&Mb.isNotEmptyStr(Na)&&Na==x.getName()&&Oa.setDefaultAlias(x.getAlias(),!0);Ra.push(x)}}Za()},function(){switch(Ca){case Xa.SYSTEM:var B=oa.getSourceAlias();
break;case Xa.MACRO:B=oa.getMacroId();break;case Xa.DATA_SET:B=oa.getName()}Oa.addException(Qa.PARAM_CTRL_DEFAULT_VALUE,jb.getName(),D.get("noDataSourceValue","\u6570\u636e\u6e90\u201c#1\u201d\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u8be5\u6570\u636e\u6e90\u3002").replace("#1",B));Za();Gb.protectedRefreshUi();xb();return!0}),Va.setBlockingJqUi(F),Va.getConstantValueFromSource(Oa.buildConstantQueryParams(Da))}wb.hasErrorInDefaultValue()&&(mb.setEnabled(!1),R&&R.setEnabled(!1))},
Za=function(){if(R){var mb=Oa.getDefaultAlias(),Ta=Oa.getDefaultValue(),Va=Oa.getBindSourceType();if(Ra&&0!=Ra.length){for(var Ca=[],oa=0;oa<Ra.length;oa++)Ca.push(Ra[oa]);Oa.getIsRequired()||(oa=new Pa,oa.setAlias(""),oa.setName(""),Ca.splice(0,0,oa));if(Mb.isNotEmptyStr(mb))if(Va==Xa.SELF)if(Ea)if(ba){mb=!0;for(oa=0;oa<Ca.length;oa++)ba==Ca[oa]&&(mb=!1);mb?(R.setSelected(""),wb.clearCtrlConstantValue()):(mb=ba.getAlias(),R.setSelected(mb),Oa.setDefaultAlias(mb),Oa.setDefaultValue(ba.getName()))}else R.setSelected(mb);
else ba=ca(Ca,mb,Ta),Ea=!0;else R.setSelected(mb);R.setItemModels(Ca);R.setCustomPainter(function(za,Na,L){(za=L&&L.getAlias?L.getAlias():L)?Na.attr("title",za):Na.attr("title","");Na.text(za)});R.addSelectedChangedListener(function(za,Na,L){Na!==L&&(ba=L,Ea=!0,Oa.setDefaultAlias(ba.getAlias()),Oa.setDefaultValue(ba.getName()),wb.clearDefaultException())})}else Mb.isNotEmptyStr(mb)?R.setSelected(mb):R.setSelected(""),Oa.getException(Qa.PARAM_CTRL_DEFAULT_VALUE)&&R.setEnabled(!1)}};this.funRefreshAreaByRequirdChanged=
function(){Oa.getDefaultValueType()==Nb.CONSTANT&&Za()};var ca=function(mb,Ta,Va){for(var Ca=0;Ca<mb.length;Ca++){var oa=mb[Ca];if(oa.getAlias()==Ta&&oa.getName()==Va)return oa}return null}};var D,ia,ua,xa,Pa,va,Qa,Mb,Pb,Nb,Xa,Aa,zb;(function(){var ib=com.kingdee.bos.qing.framework.common;D=ib.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);ib=com.kingdee.bos.qing.ui.component;ia=ib.ComboBox;ua=ib.Label;xa=ib.F7Selector;ib=com.kingdee.bos.qing.common;va=ib.DomUtil;
ib=com.kingdee.bos.extreport.datasetdesigner.common;Mb=ib.StringUtil;Pb=ib.LanguageUtil;ib=com.kingdee.bos.extreport.datasetdesigner.model;Nb=ib.ParamDefaultValueType;Xa=ib.ParamBindSourceType;Pa=ib.NameAliasPair;Qa=ib.DataSetModelCheckType;ib=com.kingdee.bos.extreport.datasetdesigner.ctrl;Aa=ib.MacroAndSysTemVarSelectDialog;zb=ib.AbstractBindSourceRender})()})();(function(){function D(){var L={},X=(L[kb.PERM]=ua,L[kb.EXPR]=Aa,L[kb.RELATIVE]=xa,L);this.getDateSetter=function(O,Fa,B,x){var Q;(O=X[O])&&(Q=new O(Fa,B,x));return Q};this.getDateTypeText=function(O,Fa){return(O=X[O])?O.getDateTypeText(Fa):""}}function ia(){var L=30,X=10;this.getHeight=function(){return L};this.getCtrlHeight=function(){return L};this.setCtrlHeight=function(O){L=O};this.getCtrlGap=function(){return X};this.setCtrlGap=function(O){X=O};this.supportDateValueSetting=function(){return!0};
this.supportGranTypeSetting=function(){return!0};this.getJqUi=function(){throw Error("Implement");};this.changeGranType=function(O){throw Error("Implement");}}function ua(L,X,O){ia.call(this);var Fa,B=this.getCtrlHeight(),x;this.supportGranTypeSetting=function(){return X==jb.DATE};this.getJqUi=function(){x||Q();return x};var Q=function(){x=$("<div>");Fa=new gb;Fa.setDateChangedListener(function(sa,ma){L.setDateValue(sa)});var ya=L.getDateGranType();Fa.setPatternType(pa(ya));(ya=L.getDateValue())&&
Fa.setDateValue(ya);ya=Fa.getJqUi();ya.css("height",B+"px");x.append(ya)};this.changeGranType=function(ya){Fa.changePatternType(pa(ya))};var pa=function(ya){if(X==jb.DATE)switch(ya){case za.YEAR_MONTH_DAY:return Za.YEAR_MONTH_DAY;case za.YEAR_MONTH:return Za.YEAR_MONTH;case za.YEAR_SEASON:return Za.YEAR_SEASON;case za.YEAR:return Za.YEAR}else{if(X==jb.DATETIME)return Za.DATETIME;if(X==jb.TIME)return Za.TIME}return null}}function xa(L,X,O){ia.call(this);var Fa=this,B,x=X!=jb.TIME,Q=X==jb.DATE,pa;this.getHeight=
function(){return pa?pa.getHeight():0};this.supportDateValueSetting=function(){return x};this.supportGranTypeSetting=function(){return Q};this.getJqUi=function(){B||(pa=ya(L.getDateGranType()),B=$("<div>"),B.append(pa.getJqUi()));return B};this.changeGranType=function(sa){pa=ya(sa);B.empty();B.append(pa.getJqUi())};var ya=function(sa){if(X==jb.DATETIME){var ma=new va(L);ma.setSupportDaySetting(!0)}else if(X==jb.DATE)switch(sa){case za.YEAR_MONTH_DAY:ma=new Qa(L);ma.setSupportDaySetting(!0);break;
case za.YEAR_MONTH:ma=new Mb(L);break;case za.YEAR_SEASON:ma=new Pb(L);break;case za.YEAR:ma=new Nb(L);break;default:return null}else X==jb.TIME&&(ma=new Xa(L));ma&&(ma.setCtrlHeight(Fa.getCtrlHeight()),ma.setCtrlGap(Fa.getCtrlGap()),ma.setDateValue(L.getDateValue()));return ma}}function Pa(){Da.call(this);var L=this,X=this.getJqUi,O;this.getJqUi=function(){O||(L.protectInit(),O=X());return O};this.protectInit=function(){throw Error("Implement");};this.setDateValue=function(Fa){throw Error("Implement");
};this.protectMethod={getSeparator:function(){return Na}}}function va(L){Pa.call(this);var X=this,O=X.getTimeSettingForSys(),Fa=this.protectMethod.getSeparator(),B=[F.DAY,F.WEEK,F.MONTH,F.SEASON,F.YEAR];this.protectInit=function(){X.setSupportUnitTypeSetting(!0);X.setSupportDaySetting(!0);X.setShowTimeSetting(!0);X.setSupportUnitType(B);X.setChangedListener(x)};this.setDateValue=function(Q){var pa=Q?Q.split(Fa):[],ya=ba.FRONT;1<=pa.length&&pa[0]==ba.BEHIND&&(ya=ba.BEHIND);var sa=0;2<=pa.length&&!isNaN(pa[1])&&
(sa=parseInt(pa[1]));var ma=F.DAY;3<=pa.length&&-1!=B.indexOf(pa[2])&&(ma=pa[2]);var ab=ma==F.DAY?null:Ea.FIRST_DAY;ma!=F.DAY&&4<=pa.length&&pa[3]==Ea.LAST_DAY&&(ab=Ea.LAST_DAY);var Ga=ab?4:3;pa=pa.length>Ga?pa[Ga]:"";if(!pa||!ca.isTimeString(pa)&&pa!=O)pa=O;ya=ya+Fa+sa+Fa+ma+Fa;ab&&(ya+=ab+Fa);ab=ya+pa;ab!=Q&&L.setDateValue(ab);Q=ab.split(Fa);Q[2]==F.DAY?(ab=null,ya=Q[3]):(ab=Q[3],ya=Q[4]);X.setDirection(Q[0]);X.setOffset(parseInt(Q[1]));X.setUnit(Q[2]);ab&&X.setDay(ab);X.setTime(ya)};var x=function(Q,
pa,ya,sa,ma){Q=Q+Fa+pa+Fa+ya+Fa;ya!=F.DAY&&sa&&(Q+=sa+Fa);L.setDateValue(Q+ma)}}function Qa(L){Pa.call(this);var X=this,O=this.protectMethod.getSeparator(),Fa=[F.DAY,F.WEEK,F.MONTH,F.SEASON,F.YEAR];this.protectInit=function(){X.setSupportUnitTypeSetting(!0);X.setSupportDaySetting(!0);X.setShowTimeSetting(!1);X.setSupportUnitType(Fa);X.setChangedListener(B)};this.setDateValue=function(x){var Q=x?x.split(O):[],pa=ba.FRONT;1<=Q.length&&Q[0]==ba.BEHIND&&(pa=ba.BEHIND);var ya=0;2<=Q.length&&!isNaN(Q[1])&&
(ya=parseInt(Q[1]));var sa=F.DAY;3<=Q.length&&-1!=Fa.indexOf(Q[2])&&(sa=Q[2]);var ma=sa==F.DAY?null:Ea.FIRST_DAY;sa!=F.DAY&&4<=Q.length&&Q[3]==Ea.LAST_DAY&&(ma=Ea.LAST_DAY);Q=pa+O+ya+O+sa;ma&&(Q+=O+ma);ma=Q;ma!=x&&L.setDateValue(ma);x=ma.split(O);ma=x[2]==F.DAY?null:x[3];x[2]!=F.DAY&&(ma=x[3]);X.setDirection(x[0]);X.setOffset(parseInt(x[1]));X.setUnit(x[2]);ma&&X.setDay(ma)};var B=function(x,Q,pa,ya,sa){x=x+O+Q+O+pa;pa!=F.DAY&&ya&&(x+=O+ya);L.setDateValue(x)}}function Mb(L){Pa.call(this);var X=this,
O=this.protectMethod.getSeparator(),Fa=[F.MONTH,F.SEASON,F.YEAR];this.protectInit=function(){X.setSupportUnitTypeSetting(!0);X.setSupportDaySetting(!1);X.setShowTimeSetting(!1);X.setSupportUnitType(Fa);X.setChangedListener(B)};this.setDateValue=function(x){var Q=x?x.split(O):[];var pa=ba.FRONT;1<=Q.length&&Q[0]==ba.BEHIND&&(pa=ba.BEHIND);var ya=0;2<=Q.length&&!isNaN(Q[1])&&(ya=parseInt(Q[1]));var sa=F.MONTH;3<=Q.length&&-1!=Fa.indexOf(Q[2])&&(sa=Q[2]);Q=pa+O+ya+O+sa;Q!=x&&L.setDateValue(Q);x=Q.split(O);
X.setDirection(x[0]);X.setOffset(parseInt(x[1]));X.setUnit(x[2])};var B=function(x,Q,pa,ya,sa){L.setDateValue(x+O+Q+O+pa)}}function Pb(L){Pa.call(this);var X=this,O=this.protectMethod.getSeparator(),Fa=[F.SEASON,F.YEAR];this.protectInit=function(){X.setSupportUnitTypeSetting(!0);X.setSupportDaySetting(!1);X.setShowTimeSetting(!1);X.setSupportUnitType(Fa);X.setChangedListener(B)};this.setDateValue=function(x){var Q=x?x.split(O):[];var pa=ba.FRONT;1<=Q.length&&Q[0]==ba.BEHIND&&(pa=ba.BEHIND);var ya=
0;2<=Q.length&&!isNaN(Q[1])&&(ya=parseInt(Q[1]));var sa=F.SEASON;3<=Q.length&&-1!=Fa.indexOf(Q[2])&&(sa=Q[2]);Q=pa+O+ya+O+sa;Q!=x&&L.setDateValue(Q);x=Q.split(O);X.setDirection(x[0]);X.setOffset(parseInt(x[1]));X.setUnit(x[2])};var B=function(x,Q,pa,ya,sa){L.setDateValue(x+O+Q+O+pa)}}function Nb(L){Pa.call(this);var X=this,O=this.protectMethod.getSeparator();this.protectInit=function(){X.setSupportUnitTypeSetting(!1);X.setSupportDaySetting(!1);X.setShowTimeSetting(!1);X.setChangedListener(Fa)};this.setDateValue=
function(B){var x=B?B.split(O):[];var Q=ba.FRONT;1<=x.length&&x[0]==ba.BEHIND&&(Q=ba.BEHIND);var pa=0;2<=x.length&&!isNaN(x[1])&&(pa=parseInt(x[1]));x=Q+O+pa+O+F.YEAR;x!=B&&L.setDateValue(x);B=x.split(O);X.setDirection(B[0]);X.setOffset(parseInt(B[1]));X.setUnit(B[2])};var Fa=function(B,x,Q,pa,ya){L.setDateValue(B+O+x+O+Q)}}function Xa(L){Pa.call(this);var X=$("<div>"),O=this.getTimeSettingForSys();this.getJqUi=function(){return X};this.getHeight=function(){return 0};this.protectInit=function(){L.setDateValue(O)};
this.setDateValue=function(Fa){Fa!=O&&L.setDateValue(O)}}function Aa(L,X,O){ia.call(this);var Fa=this,B,x,Q=[],pa=!1,ya=new Va;this.supportGranTypeSetting=function(){return X==jb.DATE};this.getJqUi=function(){B||sa();return B};this.changeGranType=function(Ga){};var sa=function(){B=$("<div>");x=new Oa;x.setCustomPainter(function(sb){return sb});x.addActionListener(function(){pa?ma():O.createParamCtrlFacade(function(sb){Q=[];if(sb&&0<sb.length)for(var U=0;U<sb.length;U++){var ob=new xb;ob.fromJsonObject(sb[U]);
Q.push(ob)}pa=!0;ma()},function(sb){}).loadDateTimeFunction()});x.setModel(L.getDateValue());var Ga=x.getJqUi();Ta.layoutCtrl(Ga,null,null,"100%",Fa.getCtrlHeight());B.append(Ga)},ma=function(){var Ga=new R;Ga.setFunction(Q);Ga.setFunClosingAction(ab);var sb=null,U=O.createParamCtrlFacade(function(qb){var $a=qb.errorPos,Sa=qb.errorMsg;qb=qb.executeValue;var fb=0>$a;if(fb&&qb){ya.setFormatString(X==jb.DATETIME?ca.DATETIME:ca.YEAR_MONTH_DAY);var Ha=ya.format(qb)}sb(fb,$a,Sa,Ha)});U.setShowBlocking(!1);
Ga.setSyntaxValidator(function(qb,$a){sb=$a;U.checkFormula(qb)});var ob=L.getDateValue();ob&&ob.startsWith("=")&&(ob=ob.slice(1),Ga.setFormula(ob));Ga.showDialog()},ab=function(Ga){Ga=Ga?"="+Ga:"";x.setModel(Ga);L.setDateValue(Ga)}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&
(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.DateRender=function(L,X,O,Fa){zb.call(this,X,O);ib.call(this,L,X,Fa);var B=this,x=X.getCtrlObject(),Q=parseInt(X.getDataType()),pa,ya,sa,ma,ab,Ga=!1,sb,U,ob,qb=new Ca,$a=B.getCtrlHeight(),Sa=B.getCtrlGap(),fb=new D;this.protectedInit=function(hb){pa=lb();ma=$("<div>");hb.append(ma);
pa.supportGranTypeSetting()&&(Ga||Ha(),ma.show());Bb(hb);B.createAdvancedArea(hb)};this.protectedRefreshUi=function(hb){B.refreshLinkageUi()};var Ha=function(){var hb=B.createTitle(mb.get("supplyValueSetting","\u5907\u9009\u503c\u8bbe\u7f6e"),0),Ya=new wb;Ya.setText(mb.get("dateGran","\u65f6\u95f4\u7c92\u5ea6"));Ya=Ya.getJqUi();sa=new Gb;sa.setItemModels([za.YEAR_MONTH_DAY,za.YEAR_MONTH,za.YEAR_SEASON,za.YEAR]);sa.setSelected(x.getDateGranType());sa.setCustomPainter(function(vb,Db,Kb){vb=za.getTypeText(Kb);
Db.text(vb)});sa.addSelectedChangedListener(function(vb,Db,Kb){Db!==Kb&&(x.setDateGranType(Kb),pa&&pa.changeGranType(Kb),pb())});var Jb=sa.getJqUi(),rb=Sa+$a;B.decorateRow(Ya,Jb,rb);rb+=Sa+$a;ma.css({position:"relative",width:"100%",height:rb+"px"});ma.append(hb);ma.append(Ya);ma.append(Jb);Ga=!0},Bb=function(hb){sb=$("<div>");var Ya=B.createTitle(mb.get("defaultValueSetting","\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),0),Jb=new wb;Jb.setText(mb.get("defaultValueType","\u9ed8\u8ba4\u503c\u7c7b\u578b"));Jb=
Jb.getJqUi();var rb=new Gb;rb.setSelected(x.getDefaultDateType());rb.setItemModels(t());rb.setCustomPainter(function(fc,Sb,ac){Sb.text(fb.getDateTypeText(ac,Q))});rb.addSelectedChangedListener(function(fc,Sb,ac){Sb!==ac&&(x.setDefaultDateType(ac),x.setDateValue(null),pa=lb(),ya.empty(),ya.append(pa.getJqUi()),pa.supportGranTypeSetting()?(Ga||Ha(),ma.show()):ma.hide(),pa.supportDateValueSetting()?ab&&ab.show():ab&&ab.hide(),sb&&(fc=2*($a+Sa),0!=pa.getHeight()&&(fc+=Sa+pa.getHeight()),sb.css("height",
fc+"px")),pb())});rb=rb.getJqUi();var vb=Sa+$a;B.decorateRow(Jb,rb,vb);ab=$("<div>");var Db=new wb,Kb=mb.get("defaultValue","\u9ed8\u8ba4\u503c");Db.setText(Kb);Db=Db.getJqUi();oa.isEnglish()&&Db.attr("title",Kb);ya=$("<div>");ya.append(pa.getJqUi());vb+=Sa+$a;B.decorateRow(Db,ya,vb);qb.setFontSize(12,"Microsoft YaHei");Kb=qb.measureWidth(Kb);Kb=10+Math.min(Kb,73);ob=$("<div>");Ta.layoutCtrl(ob,Kb,88);0!=pa.getHeight()&&(vb+=Sa+pa.getHeight());sb.css({position:"relative",width:"100%",height:vb+"px"});
ab.append(Db);ab.append(ob);ab.append(ya);sb.append(Ya);sb.append(Jb);sb.append(rb);sb.append(ab);hb.append(sb);pb()},pb=function(){if(x.getDefaultDateType()!=kb.EXPR||Q!=jb.DATE)ob&&ob.hide();else{U||(U=new Ra,ob.append(U.getJqUi()));ob.show();var hb=za.getTypeText(x.getDateGranType());hb=mb.get("exprDateSetterTips","\u53d6\u8868\u8fbe\u5f0f\u8fd4\u56de\u65e5\u671f\u503c\u7684#1\u90e8\u5206\u3002").replace("#1",hb);U.setTipsText(hb)}},lb=function(){var hb=X.getDataType(),Ya=x.getDefaultDateType(),
Jb=x.getDateGranType();Ya||(Ya=kb.PERM,x.setDefaultDateType(Ya));hb==jb.TIME?(Ya==kb.EXPR&&x.setDefaultDateType(kb.PERM),Jb&&(x.setDateGranType(null),x.setDateValue(null))):Jb?Jb!=za.YEAR_MONTH_DAY&&hb==jb.DATETIME&&x.setDateGranType(za.YEAR_MONTH_DAY):(x.setDateGranType(za.YEAR_MONTH_DAY),x.setDefaultDateType(Ya),x.setDateValue(null));if(hb=fb.getDateSetter(x.getDefaultDateType(),x,X.getDataType(),L))hb.setCtrlGap(Sa),hb.setCtrlHeight($a);return hb},t=function(){var hb=[kb.PERM,kb.RELATIVE];X.getDataType()!=
jb.TIME&&hb.push(kb.EXPR);return hb}};var zb,ib,jb,kb,xb,Gb,wb,Oa,Ra,R,F,ba,Ea,Da,gb,Za,ca,mb,Ta,Va,Ca,oa;(function(){var L=com.kingdee.bos.extreport.datasetdesigner.ctrl;zb=L.AbstractTypeRender;ib=L.NormalAdvancedArea;L=com.kingdee.bos.extreport.datasetdesigner.common;oa=L.LanguageUtil;L=com.kingdee.bos.extreport.datasetdesigner.model;jb=L.ParamDataType;kb=L.ParamDefaultDateType;L=com.kingdee.bos.qing.ui.component;Gb=L.ComboBox;wb=L.Label;Oa=L.F7Selector;Ra=L.HelpIcon;L=com.kingdee.bos.qing.framework.common;
mb=L.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);L=com.kingdee.bos.qing.common;Ta=L.DomUtil;Va=L.DateFormater;Ca=L.TextMeasurer;L=com.kingdee.bos.extreport.common;R=L.FormulaEditorDialog;xb=L.Function;F=L.DateUnitType;Ea=L.DateOffsetDayType;ba=L.DateDirectionType;Da=L.RelativeDateSelector;gb=L.DateDropdownSelector;Za=L.DatePatternType;ca=L.DatePattern})();var za={YEAR_MONTH_DAY:"Y_M_D",YEAR_MONTH:"Y_M",YEAR_SEASON:"Y_S",YEAR:"Y",getTypeText:function(L){switch(L){case za.YEAR_MONTH_DAY:return mb.get("yearMonthDay",
"\u5e74\u6708\u65e5");case za.YEAR_MONTH:return mb.get("yearMonth","\u5e74\u6708");case za.YEAR_SEASON:return mb.get("yearQuarter","\u5e74\u5b63");case za.YEAR:return mb.get("year","\u5e74");default:return""}}};ua.getDateTypeText=function(L){switch(L){case jb.DATE:return mb.get("fixedDate","\u56fa\u5b9a\u65e5\u671f");case jb.DATETIME:return mb.get("fixedDateTime","\u56fa\u5b9a\u65e5\u671f\u65f6\u95f4");case jb.TIME:return mb.get("fixedTime","\u56fa\u5b9a\u65f6\u95f4");default:return""}};xa.getDateTypeText=
function(L){switch(L){case jb.DATE:return mb.get("relativeDate","\u76f8\u5bf9\u4e8e\u670d\u52a1\u7aef\u7684\u65e5\u671f");case jb.DATETIME:return mb.get("relativeDateTime","\u76f8\u5bf9\u4e8e\u670d\u52a1\u7aef\u7684\u65e5\u671f\u65f6\u95f4");case jb.TIME:return mb.get("relativeTime","\u670d\u52a1\u7aef\u5f53\u524d\u65f6\u95f4");default:return""}};var Na="!@#ORANGE#@!";Aa.getDateTypeText=function(){return mb.get("expressionDefinition","\u8868\u8fbe\u5f0f\u5b9a\u4e49")}})();(function(){function D(Aa,zb){var ib,jb,kb;this.getValue=function(){return jb};this.getText=function(){return kb};this.setValue=function(xb){jb=xb;Aa?zb.setSwitchOnValue(jb):zb.setSwitchOffValue(jb)};this.setText=function(xb){kb=xb;Aa?zb.setSwitchOnText(kb):zb.setSwitchOffText(kb)};this.getStatusDesc=function(){return ib};this.setStatusDesc=function(xb){ib=xb}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos=
{});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.SwitchCtrlRender=function(Aa,zb,ib,jb){function kb(Ca){KTDefaultCellRender.call(this,Ca);var oa=this,za=this.paintCellUI,Na=xa.getHeadRowCount();
this.paintCellUI=function(L,X){var O=oa.getCurrentRowIdx(),Fa=oa.getCurrentColIdx();O>=Na&&1==Fa&&Gb.getDataType()==Xa.BOOLEAN?(X=oa.getCurrentRow().getUserObject(),O=oa.getCellWidth(),Fa=oa.getCellHeight(),Va(L,O,Fa,X)):za(L,X)}}va.call(this,zb,ib);Qa.call(this,Aa,zb,jb);var xb=this,Gb=zb,wb=Gb.getCtrlObject(),Oa=xb.getCtrlGap(),Ra=xb.getCtrlHeight(),R,F,ba,Ea,Da;this.protectedInit=function(Ca){var oa=wb.getDefaultValue()===wb.getSwitchOffValue();F=D.create(!0,Gb);ba=D.create(!1,Gb);Ea=oa?ba:F;wb.setDefaultValue(Ea.getValue());
oa=$("<div>");var za=xb.createTitle(ia.get("supplyValueSetting","\u5907\u9009\u503c\u8bbe\u7f6e"),0),Na=new Pb;Na.setText(ia.get("supplyValue","\u5907\u9009\u503c"));Na=Na.getJqUi();var L=Oa+Ra;ua.layoutCtrl(Na,10,L);L+=Oa+20;var X=$("<div>");ua.layoutCtrl(X,10,70,null,106);X.css({border:"1px solid #CCCCCC",width:"calc(100% - 23px)"});Za(X);L+=Oa+106;oa.css({position:"relative",width:"100%",height:L+"px"});oa.append(za);oa.append(Na);oa.append(X);Ca.append(oa);gb(Ca);xb.createAdvancedArea(Ca)};this.protectedRefreshUi=
function(Ca){xb.refreshLinkageUi()};var gb=function(Ca){var oa=$("<div>"),za=xb.createTitle(ia.get("defaultValueSetting","\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),0),Na=ia.get("defaultValue","\u9ed8\u8ba4\u503c"),L=new Pb;L.setText(Na);L=L.getJqUi();Pa.isEnglish()&&L.attr("title",Na);Da=new Nb;Da.setItemModels([F,ba]);Da.addSelectedChangedListener(function(O,Fa,B){Ea=B;wb.setDefaultValue(B.getValue())});Da.setSelected(Ea);Da.setCustomPainter(function(O,Fa,B){Fa.text(B.getText())});Na=Da.getJqUi();var X=Oa+
Ra;xb.decorateRow(L,Na,X);X+=Oa+Ra;oa.css({position:"relative",width:"100%",height:X+"px"});oa.append(za);oa.append(L);oa.append(Na);Ca.append(oa)},Za=function(Ca){if(R)xa.clearWithoutHead(R);else{R=xa.createTable();var oa=new kb(R);oa.setPaddingHV(5,1);R.setCellRender(oa);R.setColumnFitVisibleWidth(!0);R.setSyncUIWhenModelChanged(!0);R.setDraggableAdjusting(!0,3,0,new Mb);xa.bindTextEditor(R,Ta,mb);xa.bindTableListenerForCtrl(R);R.addColumns(3);R.getColumn(0).setWidth(80);R.getColumn(1).setWidth(120);
R.getColumn(2).setWidth(160);oa=xa.createHeadRow(R);oa.getCell(0).setValue(ia.get("switchStatus","\u542f\u7528\u72b6\u6001"));oa.getCell(1).setValue(ia.get("returnValue","\u8fd4\u56de\u503c"));oa.getCell(2).setValue(ia.get("displayText","\u663e\u793a\u6587\u672c"));oa=$(R.getUI());oa.addClass("extreport-dataset-designer-param-ctrl-switch-table");oa.appendTo(Ca)}setTimeout(function(){R.setSyncUIWhenModelChanged(!1);ca(R,F);ca(R,ba);R.setSyncUIWhenModelChanged(!0);xa.refresh(R)},0)},ca=function(Ca,
oa){Ca=xa.createRow(Ca);Ca.getCell(0).setValue(oa.getStatusDesc());Ca.getCell(1).setValue(oa.getValue());Ca.getCell(2).setValue(oa.getText());Ca.setUserObject(oa)},mb=function(Ca,oa,za,Na,L){Ca=Ca.getUserObject();oa=R.getColumnIndex(oa);if(1==oa){if(Gb.getDataType()==Xa.NUMERICAL&&!$.isNumeric(Na))return za=ia.get("valueTypeTips","\u53c2\u6570\u7684\u6570\u636e\u7c7b\u578b\u4e3a\u6570\u503c\u7c7b\u578b\uff0c\u8bf7\u8f93\u5165\u6570\u503c\u7c7b\u578b\u7684\u6570\u636e\u3002"),Aa.getMessageCurtain().showPrompt(za),
!1;Ca.setValue(Na);Ea==Ca&&wb.setDefaultValue(Na)}else if(2==oa){if(8<Na.length)return!1;Ca.setText(Na)}Da.setItemModels([F,ba]);Da.setSelected(Ea);za.setValue(Na);return!0},Ta=function(Ca,oa){return 2==oa||1==oa&&Gb.getDataType()!=Xa.BOOLEAN},Va=function(Ca,oa,za,Na){Ca=xa.createCtrlInCell(Ca,oa,za,Nb);Ca.setItemModels(["true","false"]);Ca.setSelected(Na.getValue());Ca.setUserObject(Na);Ca.addSelectedChangedListener(function(L,X,O){L.getUserObject().setValue(O)});Ca.setCustomPainter(function(L,X,
O){X.text(O)})}};var ia,ua,xa,Pa,va,Qa,Mb,Pb,Nb,Xa;(function(){var Aa=com.kingdee.bos.qing.framework.common;ia=Aa.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);Aa=com.kingdee.bos.extreport.datasetdesigner.ctrl;va=Aa.AbstractTypeRender;Qa=Aa.NormalAdvancedArea;Aa=com.kingdee.bos.qing.ui.component;Pb=Aa.Label;Nb=Aa.ComboBox;Aa=com.kingdee.bos.qing.common;ua=Aa.DomUtil;Aa=com.kingdee.bos.qing.common.ui;xa=Aa.TableUtil;Aa=com.kingdee.bos.extreport.datasetdesigner.model;
Xa=Aa.ParamDataType;Aa=com.kingdee.bos.extreport.datasetdesigner.common;Pa=Aa.LanguageUtil;Aa=com.kingdee.bos.extreport.datasetdesigner.common.ui;Mb=Aa.TableCustomExpandor})();D.create=function(Aa,zb){var ib=zb.getCtrlObject(),jb=new D(Aa,ib);zb=zb.getDataType();Aa?(jb.setStatusDesc(ia.get("switchOn","\u5f00\u542f")),jb.setText(ib.getSwitchOnText()),Aa=ib.getSwitchOnValue(),zb==Xa.BOOLEAN&&"true"!=Aa&&"false"!=Aa?Aa="true":zb!=Xa.NUMERICAL||$.isNumeric(Aa)||(Aa="1")):(jb.setStatusDesc(ia.get("switchOff",
"\u5173\u95ed")),jb.setText(ib.getSwitchOffText()),Aa=ib.getSwitchOffValue(),zb==Xa.BOOLEAN&&"true"!=Aa&&"false"!=Aa?Aa="false":zb!=Xa.NUMERICAL||$.isNumeric(Aa)||(Aa="0"));jb.setValue(Aa);return jb}})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.SpinnerCtrlRender=
function(Qa,Mb,Pb,Nb){ia.call(this,Mb,Pb);var Xa=this,Aa=Mb.getCtrlObject(),zb=Xa.getCtrlGap(),ib=Xa.getCtrlHeight(),jb,kb;this.protectedRefreshUi=function(R){kb.refreshUi()};this.protectedInit=function(R){Aa.getDefaultValue()||Aa.setDefaultValue("1");var F=$("<div>"),ba=Xa.createTitle(D.get("supplyValueSetting","\u5907\u9009\u503c\u8bbe\u7f6e"),0),Ea=new xa;Ea.setText(D.get("maxValue","\u6700\u5927\u503c"));Ea=Ea.getJqUi();var Da=new Pa,gb=Aa.getMaxValue();gb&&Da.setText(gb);Da.addBlurListener(xb);
Da.addAcceptableListener(xb);Da=Da.getJqUi();gb=zb+ib;Xa.decorateRow(Ea,Da,gb);var Za=new xa;Za.setText(D.get("minValue","\u6700\u5c0f\u503c"));Za=Za.getJqUi();var ca=new Pa,mb=Aa.getMinValue();mb&&ca.setText(mb);ca.addBlurListener(Gb);ca.addAcceptableListener(Gb);ca=ca.getJqUi();gb+=zb+ib;Xa.decorateRow(Za,ca,gb);gb+=zb+ib;F.css({position:"relative",width:"100%",height:gb+"px"});F.append(ba);F.append(Ea);F.append(Da);F.append(Za);F.append(ca);R.append(F);F=$("<div>");ba=Xa.createTitle(D.get("defaultValueSetting",
"\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),0);Da=D.get("defaultValue","\u9ed8\u8ba4\u503c");Ea=new xa;Ea.setRequired(!0);Ea.setText(Da);Ea=Ea.getJqUi();va.isEnglish()&&Ea.attr("title",Da);jb=new Pa;jb.setText(Aa.getDefaultValue());jb.addBlurListener(wb);jb.addAcceptableListener(wb);Da=jb.getJqUi();gb=zb+ib;Xa.decorateRow(Ea,Da,gb);gb+=zb+ib;F.css({position:"relative",width:"100%",height:gb+"px"});F.append(ba);F.append(Ea);F.append(Da);R.append(F);F=$("<div>");ba=Xa.createTitle(D.get("advancedSetting","\u9ad8\u7ea7\u8bbe\u7f6e"),
0);Ea=new xa;Ea.setText(D.get("stepSize","\u6b65\u957f"));Ea.setRequired(!0);Ea=Ea.getJqUi();Da=new Pa;Da.setText(Aa.getStepSize());Da.addBlurListener(Oa);Da.addAcceptableListener(Oa);Da=Da.getJqUi();gb=zb+ib;Xa.decorateRow(Ea,Da,gb);kb=new ua(Qa,Mb,Nb);Za=kb.getJqUi();gb+=zb+ib;Za.css("top",gb+"px");gb+=zb+ib;F.css({position:"relative",width:"100%",height:gb+"px"});F.append(Ea);F.append(Da);F.append(ba);F.append(Za);R.append(F)};var xb=function(R){var F=R.getText(),ba=!0,Ea=!1;if(F){ba=$.isNumeric(F);
var Da=Aa.getDefaultValue();ba&&$.isNumeric(Da)&&(Ea=1==Ra(Da,F));ba&&!Ea?Aa.setMaxValue(F):R.setText(Aa.getMaxValue())}else Aa.setMaxValue("");ba?Ea&&Qa.getMessageCurtain().showPrompt(D.get("outOfBounds","\u9ed8\u8ba4\u503c\u8d85\u51fa\u9650\u5236\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")):Qa.getMessageCurtain().showPrompt(D.get("inputNumber","\u8f93\u5165\u503c\u5fc5\u987b\u4e3a\u6570\u503c\u578b\u3002"))},Gb=function(R){var F=R.getText(),ba=!0,Ea=!1;if(F){ba=$.isNumeric(F);var Da=Aa.getDefaultValue();
ba&&$.isNumeric(Da)&&(Ea=1==Ra(F,Da));ba&&!Ea?Aa.setMinValue(F):R.setText(Aa.getMinValue())}else Aa.setMinValue("");ba?Ea&&Qa.getMessageCurtain().showPrompt(D.get("outOfBounds","\u9ed8\u8ba4\u503c\u8d85\u51fa\u9650\u5236\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")):Qa.getMessageCurtain().showPrompt(D.get("inputNumber","\u8f93\u5165\u503c\u5fc5\u987b\u4e3a\u6570\u503c\u578b\u3002"))},wb=function(R){var F=R.getText(),ba=$.isNumeric(F),Ea=!1;if(ba){Ea=Aa.getMaxValue();Ea=$.isNumeric(Ea)?1==Ra(F,Ea):
!1;var Da=Aa.getMinValue();!Ea&&$.isNumeric(Da)&&(Ea=1==Ra(Da,F));Ea?R.setText(Aa.getDefaultValue()):Aa.setDefaultValue(F)}else R.setText(Aa.getDefaultValue());ba?Ea&&Qa.getMessageCurtain().showPrompt(D.get("outOfBounds","\u9ed8\u8ba4\u503c\u8d85\u51fa\u9650\u5236\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")):Qa.getMessageCurtain().showPrompt(D.get("inputNumber","\u8f93\u5165\u503c\u5fc5\u987b\u4e3a\u6570\u503c\u578b\u3002"))},Oa=function(R){var F=R.getText(),ba=$.isNumeric(F),Ea=!0;ba&&0!=Number(F)?
(Ea=!1,Aa.setStepSize(F)):R.setText(Aa.getStepSize());ba?Ea&&Qa.getMessageCurtain().showPrompt(D.get("stepSizeIsZero","\u6b65\u957f\u4e0d\u80fd\u4e3a0\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e\u3002")):Qa.getMessageCurtain().showPrompt(D.get("inputNumber","\u8f93\u5165\u503c\u5fc5\u987b\u4e3a\u6570\u503c\u578b\u3002"))},Ra=function(R,F){if(R===F)return 0;if(!$.isNumeric(R)||!$.isNumeric(F))throw Error("Illegal argument");var ba=R.startsWith("-"),Ea=F.startsWith("-");if(ba==Ea){R=R.trim("-").trim("+");F=
F.trim("-").trim("+");var Da=R.indexOf("."),gb=F.indexOf(".");Ea=-1!=Da?R.slice(0,Da):R;var Za=-1!=gb?F.slice(0,gb):F;R=-1!=Da?R.slice(Da+1):"";F=-1!=gb?F.slice(gb+1):"";gb=Math.max(Ea.length,Za.length);Ea=Ea.padStart(gb,"0");Za=Za.padStart(gb,"0");gb=Math.max(R.length,F.length);R=R.padEnd(gb,"0");F=F.padEnd(gb,"0");R=Ea+R;F=Za+F;return R==F?0:(ba?-1:1)*(R>F?1:-1)}return ba?-1:1}};var D,ia,ua,xa,Pa,va;(function(){var Qa=com.kingdee.bos.qing.framework.common;D=Qa.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);
Qa=com.kingdee.bos.extreport.datasetdesigner.ctrl;ia=Qa.AbstractTypeRender;ua=Qa.LinkageRender;Qa=com.kingdee.bos.extreport.datasetdesigner.common;va=Qa.LanguageUtil;Qa=com.kingdee.bos.qing.ui.component;xa=Qa.Label;Pa=Qa.TextField})()})();(function(){function D(R,F){function ba(Ta){KTDefaultCellRender.call(this,Ta);var Va=this,Ca=this.paintCellUI;this.paintCellUI=function(oa,za){var Na=Va.getCurrentRowIdx(),L=Va.getCurrentRow(),X=Va.getCurrentColIdx(),O=L.getUserObject();if(Na<wb.getHeadRowCount())Ca(oa,za);else{za=$("<div>");if(0===X)Na=Na-wb.getHeadRowCount()+1,za.text(Na),za.attr("title",Na),za.css("text-align","center");else if(1===X)za.text(O.getName()),za.attr("title",O.getName());else if(2===X)za.text(O.getAlias()),za.attr("title",
O.getAlias());else if(3===X){var Fa=O.getName();Na=new kb;Na.setChecked(Za[Fa]);Fa===gb.getDisplayFieldName()&&(Na.setChecked(!0),Na.setEnabled(!1));Na.addCheckedListener(function(B,x){B.isChecked()?Za[Fa]=O:delete Za[Fa]});Na=Na.getJqUi();za.css({left:"40%",top:"18%"});za.append(Na)}za.addClass("f7-ctrl-more-field-table-row");$(oa).append(za)}}}xb.call(this);var Ea=this.protectedMethod,Da=this,gb=R,Za={},ca;(function(){for(var Ta=gb.getHiddenFields(),Va=0;Va<F.length;Va++){var Ca=F[Va],oa=Ca.getName();
-1===Ta.indexOf(oa)&&(Za[oa]=Ca)}Ea.setTitle(Xa.get("moreDisplayFields","\u66f4\u591a\u663e\u793a\u5b57\u6bb5"));Da.setSize(470,400);Ea.setSelectable(!0);Ea.setContentPaneCreator(function(){return mb()});Ea.setClosingAction(function(za){za&&ca(Za)})})();this.setFuncSetFieldCallBack=function(Ta){ca=Ta};var mb=function(){var Ta=wb.createTable(),Va=new ba(Ta);Va.setOutsideVisible(!1);Ta.setColumnFitVisibleWidth(!0);Ta.setSyncUIWhenModelChanged(!0);Ta.setCellRender(Va);Ta.addColumns(4);Ta.getColumn(0).setWidth(20);
Ta.getColumn(1).setWidth(100);Ta.getColumn(2).setWidth(100);Ta.getColumn(3).setWidth(60);Va=wb.createHeadRow(Ta);Va.getCell(0).setValue("#");Va.getCell(1).setValue(Xa.get("fieldName","\u5b57\u6bb5\u540d\u79f0"));Va.getCell(2).setValue(Xa.get("displayName","\u663e\u793a\u540d\u79f0"));Va.getCell(3).setValue(Xa.get("visible","\u662f\u5426\u5c55\u793a"));for(Va=0;Va<F.length;Va++){var Ca=F[Va];wb.createRow(Ta).setUserObject(Ca)}Va=$(Ta.getUI());Va.css({"border-bottom":"1px solid #ddd"});setTimeout(function(){wb.refresh(Ta)},
0);return Va}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.F7Render=
function(R,F,ba,Ea){ua.call(this,R,F,ba,Ea);var Da=this,gb=this.protectedMethod,Za,ca=F.getCtrlObject(),mb,Ta,Va=this.protectedRefreshUi;this.protectedRefreshUi=function(B){Va();mb.refreshUi();Ta&&ca.getTreeType()==Qa.PARENT_CHILD&&za("$PARENT_FIELD")&&(Ta.attr("title",za("$PARENT_FIELD")),Ta.show())};this.protectedInitDefaultField=function(){var B=Da.getOutputColumnsInSource();Fa(ca.getTreeType(),B);ca.getTreeType()===Qa.LONG_NUMBER?(ca.setLongNumberField(B[0].getName()),ca.setLongNumberFieldAlias(B[0].getAlias())):
ca.getTreeType()===Qa.PARENT_CHILD&&(ca.setCurrentField(B[0].getName()),ca.setCurrentFieldAlias(B[0].getAlias()),1<B.length&&(ca.setParentField(B[1].getName()),ca.setParentFieldAlias(B[1].getAlias())))};this.funCustomizeSupplyArea=function(B,x,Q){if(ca.getTreeType()!==Qa.NOT_TREE)return Q;B=Da.getCtrlGap();var pa=Da.getCtrlHeight(),ya=Da.getOutputColumnsInSource(),sa=new Aa,ma=Xa.get("moreDisplayFields","\u66f4\u591a\u663e\u793a\u5b57\u6bb5");sa.setText(ma);var ab=new ib,Ga=ab.getJqUi();ab.setCustomPainter(function(sb){if(sb&&
sb.length+1<ya.length){sb=[];for(var U=0;U<ya.length;U++){var ob=ya[U].getName();-1===ca.getHiddenFields().indexOf(ob)&&ob!==ca.getDisplayFieldName()&&sb.push(ob)}sb=1===sb.length?Xa.get("singleField","\u5df2\u9009\u62e9\u5b57\u6bb5#1").replace("#1",Ca(sb[0])):Xa.get("multiFields","\u5df2\u9009\u62e9#1\u7b49#2\u4e2a\u5b57\u6bb5").replace("#1",Ca(sb[0])).replace("#2",sb.length+"");Ga.attr("title",sb);return sb}return""});ab.setModel(ca.getHiddenFields());ca.getHiddenFields().length+1<ya.length?ab.setClearable(!0):
ab.setClearable(!1);ab.addActionListener(function(sb){var U=new D(ca,ya);U.setFuncSetFieldCallBack(function(ob){for(var qb=[],$a=0;$a<ya.length;$a++){var Sa=ya[$a].getName();ob[Sa]||qb.push(Sa)}ca.setHiddenFields(qb);qb.length+1<ya.length?ab.setClearable(!0):ab.setClearable(!1);sb.setModel(ca.getHiddenFields())});U.showDialog()});ab.addClearListener(function(){for(var sb=[],U=0;U<ya.length;U++){var ob=ya[U].getName();ob!==ca.getDisplayFieldName()&&sb.push(ob)}ca.setHiddenFields(sb);ab.setModel(ca.getHiddenFields());
ab.setClearable(!1)});sa=sa.getJqUi();Oa.isEnglish()&&sa.attr("title",ma);Da.decorateRow(sa,Ga,Q);Q+=B+pa;x.append(sa);x.append(Ga);return Q};var Ca=function(B){for(var x=Da.getOutputColumnsInSource(),Q=0;x&&Q<x.length;Q++)if(x[Q].getName()==B)return x[Q].getAlias();return B};this.protectedCreateAdvancedArea=function(B){var x=Da.getCtrlGap(),Q=Da.getCtrlHeight();Za?Za.empty():Za=$("<div>");Za.attr("id","advanced");Za.css({position:"relative",width:"100%"});var pa=0,ya=Da.createTitle(Xa.get("advancedSetting",
"\u9ad8\u7ea7\u8bbe\u7f6e"),pa);Za.append(ya);pa=L(Za,pa+(x+Q));pa=O(Za,pa);mb=new ia(R,F,Ea);ya=mb.getJqUi();ya.css("top",pa+"px");pa+=x+Q;Za.append(ya);Za.css("height",pa);B&&B.append(Za)};this.getArrBindType=function(){return[va.DATA_SET,va.MACRO,va.SYSTEM]};this.IsMultiSelect=function(){return ca.getIsAllowMultipleSelected()};var oa=this.protectedChooseDisplayField;this.protectedChooseDisplayField=function(B){ca.getTreeType()==Qa.NOT_TREE&&(ca.addHiddenField(ca.getDisplayFieldName()),ca.removeHiddenField(B.getName()));
oa(B)};var za=function(B){return ca.getException(Mb.PARAM_CTRL_BIND_SOURCE,F.getName()+B)},Na=function(B){ca.removeException(Mb.PARAM_CTRL_BIND_SOURCE,F.getName()+B)};this.getMultiSelected=function(){return ca.getRowLimit()?ca.getRowLimit():2E4};var L=function(B,x){var Q=Da.getCtrlGap(),pa=Da.getCtrlHeight();if(ca.getBindSourceType()!==va.SYSTEM){var ya=new Aa,sa=Xa.get("treeStruct","\u6811\u72b6\u7ed3\u6784");ya.setText(sa);var ma=new jb;ma.setSelected(ca.getTreeType());ma.setItemModels(Qa.ALL_TREE_TYPE);
ma.addSelectedChangedListener(function(Ha,Bb,pb){if(pb!==Bb){ca.setTreeType(pb);Fa(pb,Da.getOutputColumnsInSource());ca.clearAdvancedProp();switch(pb){case Qa.NOT_TREE:ca.getBindSource()&&(F.removeException(Mb.PARAM_CLIENT_ERROR,F.getName()),Ea(F));break;case Qa.LONG_NUMBER:F.addException(Mb.PARAM_CLIENT_ERROR,F.getName(),Xa.get("ctrlPropRequiredTips","\u63a7\u4ef6\u5c5e\u6027\u5b58\u5728\u672a\u8bbe\u7f6e\u7684\u5fc5\u586b\u9879\u3002"));break;default:1>=Da.getOutputColumnsInSource().length&&F.addException(Mb.PARAM_CLIENT_ERROR,
F.getName(),Xa.get("ctrlPropRequiredTips","\u63a7\u4ef6\u5c5e\u6027\u5b58\u5728\u672a\u8bbe\u7f6e\u7684\u5fc5\u586b\u9879\u3002"))}Da.protectedCreateAdvancedArea();gb.refreshSupplyArea()}});ma.setCustomPainter(function(Ha,Bb,pb){Ha=$("<div>");var lb;pb===Qa.NOT_TREE?lb=Xa.get("empty","\u65e0"):pb===Qa.LONG_NUMBER?lb=Xa.get("longField","\u957f\u7f16\u7801"):pb===Qa.PARENT_CHILD&&(lb=Xa.get("parentSonStruct","\u7236\u5b50\u7ed3\u6784"));Ha.text(lb);Bb.append(Ha)});ya=ya.getJqUi();Oa.isEnglish()&&ya.attr("title",
sa);sa=ma.getJqUi();Da.decorateRow(ya,sa,x);x+=pa+Q;B.append(ya);B.append(sa);if(ca.getTreeType()!==Qa.NOT_TREE){sa=Da.getOutputColumnsInSource();if(ca.getTreeType()===Qa.LONG_NUMBER){if(ca.getLongNumberField()){var ab=new Nb;ab.setName(ca.getLongNumberField());ab.setAlias(ca.getLongNumberFieldAlias())}else 0<sa.length&&(ab=sa[0],ca.setLongNumberField(sa[0].getName()),ca.setLongNumberFieldAlias(sa[0].getAlias()));var Ga=new Aa;ya=Xa.get("longFieldStr","\u957f\u7f16\u7801\u5b57\u6bb5");Ga.setText(ya);
var sb=new Pa(ab,sa,function(Ha){sb.getJqUi().attr("title",Ha.getPatternText());ca.setLongNumberField(Ha.getName());ca.setLongNumberFieldAlias(Ha.getAlias());ob&&ob.hide();Na("$LONGNUM_FIELD");Ea(F)});ma=new Aa;ma.setText(Xa.get("separators","\u5206\u9694\u7b26"));ma.setRequired(!0);var U=new zb;U.setText(ca.getSeparator()?ca.getSeparator():"");U.addAcceptableListener(function(Ha){X(Ha)});U.addBlurListener(function(Ha){X(Ha)});0===sa.length&&(sb.setEnabled(!1),U.setEnabled(!1));Ga=Ga.getJqUi();Oa.isEnglish()&&
Ga.attr("title",ya);sa=sb.getJqUi();ab&&sa.attr("title",ab.getPatternText());ab=ma.getJqUi();U=U.getJqUi();if(ma=za("$LONGNUM_FIELD")){var ob=xa.getErrorIcon(ma);Ra.layoutCtrl(ob,90,x+15);B.append(ob)}Da.decorateRow(Ga,sa,x);x+=pa+Q;Da.decorateRow(ab,U,x);x+=pa+Q;B.append(Ga);B.append(sa);B.append(ab);B.append(U)}else if(ca.getTreeType()===Qa.PARENT_CHILD){ca.getCurrentField()?(Ga=new Nb,Ga.setName(ca.getCurrentField()),Ga.setAlias(ca.getCurrentFieldAlias())):0<sa.length&&(Ga=sa[0],ca.setCurrentField(Ga.getName()),
ca.setCurrentFieldAlias(Ga.getAlias()));ca.getParentField()?(U=new Nb,U.setName(ca.getParentField()),U.setAlias(ca.getParentFieldAlias())):1<sa.length&&(U=sa[1],ca.setParentField(U.getName()),ca.setParentFieldAlias(U.getAlias()));ab=new Aa;ab.setText(Xa.get("sonField","\u8282\u70b9\u5b57\u6bb5"));var qb=new Pa(Ga,sa,function(Ha){qb.getJqUi().attr("title",Ha.getPatternText());var Bb=Ha.getName();Ha=Ha.getAlias();Bb===ca.getParentField()&&Ha===ca.getParentFieldAlias()?(R.getMessageCurtain().showPrompt(Xa.get("noSameField",
"\u8282\u70b9\u5b57\u6bb5\u548c\u7236\u8282\u70b9\u5b57\u6bb5\u4e0d\u80fd\u9009\u62e9\u76f8\u540c\u7684\u5b57\u6bb5")),qb.setSelectedModel(null)):(ca.setCurrentField(Bb),ca.setCurrentFieldAlias(Ha),Sa&&Sa.hide(),Na("$CURRENT_FIELD"),Ea(F))});ma=new Aa;ma.setText(Xa.get("parentField","\u7236\u8282\u70b9\u5b57\u6bb5"));var $a=new Pa(U,sa,function(Ha){$a.getJqUi().attr("title",Ha.getPatternText());var Bb=Ha.getName();Ha=Ha.getAlias();Bb===ca.getCurrentField()&&Ha===ca.getCurrentFieldAlias()?(R.getMessageCurtain().showPrompt(Xa.get("noSameField",
"\u8282\u70b9\u5b57\u6bb5\u548c\u7236\u8282\u70b9\u5b57\u6bb5\u4e0d\u80fd\u9009\u62e9\u76f8\u540c\u7684\u5b57\u6bb5")),$a.setSelectedModel(null)):(ca.setParentField(Bb),ca.setParentFieldAlias(Ha),Ta&&Ta.hide(),Na("$PARENT_FIELD"),Ea(F))});0===sa.length&&(qb.setEnabled(!1),$a.setEnabled(!1));ab=ab.getJqUi();sa=qb.getJqUi();Ga&&sa.attr("title",Ga.getPatternText());Ga=ma.getJqUi();ma=$a.getJqUi();U&&ma.attr("title",U.getPatternText());if(U=za("$CURRENT_FIELD")){var Sa=xa.getErrorIcon(U);Ra.layoutCtrl(Sa,
90,x+15);B.append(Sa)}Da.decorateRow(ab,sa,x);x+=pa+Q;U=za("$PARENT_FIELD");Ta=xa.getErrorIcon(U);Ta.hide();U&&Ta.show();Ra.layoutCtrl(Ta,90,x+15);B.append(Ta);Da.decorateRow(Ga,ma,x);x+=pa+Q;B.append(ab);B.append(sa);B.append(Ga);B.append(ma)}U=new Aa;ab=Xa.get("defualtLevel","\u9ed8\u8ba4\u5c55\u5f00\u7ea7\u522b");U.setText(ab);Ga=new Gb;var fb=Ga.getJqUi();ca.getTreeExpandLevel()||ca.setTreeExpandLevel(2);fb.attr("title",ca.getTreeExpandLevel());Ga.setValue(ca.getTreeExpandLevel());Ga.setConstraint(1,
100,1);Ga.addValueChangedListener(function(Ha,Bb,pb){ca.setTreeExpandLevel(pb);fb.attr("title",pb)});U=U.getJqUi();Oa.isEnglish()&&U.attr("title",ab);Da.decorateRow(U,fb,x);x+=Q+pa;B.append(U);B.append(fb)}}return x},X=function(B){var x=ca.getSeparator(),Q=B.getText();Q||(Q=x);ca.setSeparator(Q);B.setText(Q?Q:"");Ea(F)},O=function(B,x){var Q=Da.getCtrlGap(),pa=Da.getCtrlHeight(),ya=new Aa,sa=Xa.get("multiAllow","\u5141\u8bb8\u591a\u9009");ya.setText(sa);var ma=new kb;ma.setChecked(ca.getIsAllowMultipleSelected());
ma.addCheckedListener(function(ab,Ga){ca.setIsAllowMultipleSelected(ab.isChecked());ab.isChecked()?ca.setRowLimit(10<=ca.getRowLimit()?ca.getRowLimit():10):(ca.setRowLimit(1),(ab=ca.getDefaultValue())&&-1!==ab.indexOf(Pb.SPLIT)&&ca.setDefaultValue(ab.substring(0,ab.indexOf(Pb.SPLIT))));ca.getDefaultValueType()===Pb.CONSTANT&&gb.refreshDefaultArea();Da.protectedCreateAdvancedArea()});ya=ya.getJqUi();Oa.isEnglish()&&ya.attr("title",sa);sa=ma.getJqUi();Da.decorateRow(ya,sa,x);sa.css("top",x+5);sa.css("width",
20);x+=Q+pa;B.append(ya);B.append(sa);ca.getIsAllowMultipleSelected()&&(ya=new Aa,sa=Xa.get("multiUp","\u591a\u9009\u4e0a\u9650"),ya.setText(sa),ma=new Gb,ma.setValue(ca.getRowLimit()),ma.setConstraint(1,2E4,1),ma.addValueChangedListener(function(ab,Ga,sb,U){ca.setRowLimit(sb)}),ya=ya.getJqUi(),Oa.isEnglish()&&ya.attr("title",sa),sa=ma.getJqUi(),Da.decorateRow(ya,sa,x),x+=Q+pa,B.append(ya),B.append(sa));return x},Fa=function(B,x){var Q=[];if(B==Qa.NOT_TREE)for(B=0;x&&B<x.length;B++){var pa=x[B];pa.getName()!==
ca.getDisplayFieldName()&&Q.push(pa.getName())}ca.setHiddenFields(Q)}};var ia,ua,xa,Pa,va,Qa,Mb,Pb,Nb,Xa,Aa,zb,ib,jb,kb,xb,Gb,wb,Oa,Ra;(function(){var R=com.kingdee.bos.extreport.datasetdesigner.ctrl;ia=R.LinkageRender;ua=R.AbstractBindSourceRender;xa=R.ErrorIconFactory;Pa=R.SearchFieldSelector;R=com.kingdee.bos.extreport.datasetdesigner.common;Oa=R.LanguageUtil;R=com.kingdee.bos.extreport.datasetdesigner.model;va=R.ParamBindSourceType;Qa=R.ParamF7TreeType;Mb=R.DataSetModelCheckType;Pb=R.ParamDefaultValueType;
Nb=R.NameAliasPair;R=com.kingdee.bos.qing.framework.common;Xa=R.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);R=com.kingdee.bos.qing.ui.component;Aa=R.Label;zb=R.TextField;ib=R.F7Selector;jb=R.ComboBox;kb=R.CheckBox;xb=R.AbstractModalDialog;Gb=R.Spinner;R=com.kingdee.bos.qing.common.ui;wb=R.TableUtil;R=com.kingdee.bos.qing.common;Ra=R.DomUtil})()})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.CheckBoxRender=
function(ia,ua,xa,Pa){D.call(this,ia,ua,xa,Pa);this.IsMultiSelect=function(){return!0}};var D=com.kingdee.bos.extreport.datasetdesigner.ctrl.AbstractBindSourceRender})();(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner.paramctrl&&(com.kingdee.bos.extreport.datasetdesigner.paramctrl={});com.kingdee.bos.extreport.datasetdesigner.paramctrl.LabelCtrlRender=
function(Qa,Mb,Pb,Nb){ua.call(this,Mb,Pb);var Xa=this,Aa=Mb.getCtrlObject(),zb=Xa.getCtrlHeight(),ib=Xa.getCtrlGap();this.protectedInit=function(kb){jb(kb)};var jb=function(kb){var xb=$("<div>"),Gb=Xa.createTitle(D.get("defaultValueSetting","\u9ed8\u8ba4\u503c\u8bbe\u7f6e"),0),wb=new xa;wb.setText(D.get("labelText","\u663e\u793a\u6587\u5b57"));wb=wb.getJqUi();var Oa=zb+ib;ia.layoutCtrl(wb,10,Oa);var Ra=new Pa;Ra.setChapterModifyListener(function(F){var ba=F?F.getChapterHtml():"";Aa.setDefaultValue(ba);
F=Aa.setDefaultAlias;if(ba){ba=$(ba);var Ea=ba.children("p");if(Ea&&0<Ea.length)for(var Da=0;Da<Ea.length;Da++){var gb=$(Ea[Da]),Za=gb.text();Za&&0!=Za.length||gb.append($("<br>"))}ba=ba.prop("outerHTML")}F.call(Aa,ba);Aa.check(Nb)});var R=va.create();R.initFromHtml(Aa.getDefaultValue());Ra.setMaxCharacters(100);Ra.setBackgroundColor("rgb(226, 231, 239)");Ra.setModel(R);setTimeout(function(){Ra.requestFocus()},0);R=Ra.getJqUi();Oa+=22+ib;ia.layoutCtrl(R,10,Oa,"calc(100% - 20px)",340);Oa+=340+ib;xb.css({position:"relative",
width:"100%",height:Oa+"px"});xb.append(Gb);xb.append(wb);xb.append(R);kb.append(xb)}};var D,ia,ua,xa,Pa,va;(function(){var Qa=com.kingdee.bos.qing.framework.common;D=Qa.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);Qa=com.kingdee.bos.extreport.datasetdesigner.ctrl;ua=Qa.AbstractTypeRender;Qa=com.kingdee.bos.qing.ui.component;xa=Qa.Label;ColorChooser=Qa.ColorChooser;Qa=com.kingdee.bos.qing.common;ia=Qa.DomUtil;Qa=com.kingdee.bos.extreport.common;Pa=Qa.RichEditor;
va=Qa.Chapter})()})();(function(){function D(U){function ob(){KTableSelectionRender.call(this);var u=$("<div>"),J=this;this.show=function(ub,b,d,f,g){J.getTable().getUI().addEventListener("mouseup",da);Ra.layoutCtrl(u,b+1,d+2,f-b-1,g-d-3);T();u.css("z-index",0);ub.append(u)};var da=function(){for(var ub=J.getTable(),b=0,d=0;d<ub.getColumnsCount();d++){var f=Ya.getColumn(d);b+=f.getWidth()}u.css("width",b-1)};this.remove=function(){J.getTable().getUI().removeEventListener("mouseup",da);u.remove()};this.current=function(){T()};
this.letOthersOld=function(ub){};var T=function(ub){u.addClass("sa-common-table-selection");u.addClass("param-ctrl-table-selection-border")}}function qb(u){KTDefaultCellRender.call(this,u);var J=this,da=this.paintCellUI,T,ub=new R;ub.setFontSize(12);this.paintCellUI=function(c,e){var a=J.getCurrentRowIdx(),m=J.getCurrentRow(),n=J.getCurrentColIdx(),h=m.getUserObject();if(a<ba.getHeadRowCount())da(c,e),1==a&&(0==n?(m=Object.keys(fb).length,m=0<m&&m===Fb().length?!0:!1,T=new jb,T.setChecked(m),T.addCheckedListener(function(C,
I){if(I){if(C.isChecked())for(yb(),C=0;C<Fb().length;C++)fb[C]=Eb(C);else fb={},cb();$a.updateTable()}}),m=T.getJqUi(),Ra.layoutCtrlWithLRTB(m,($(c).outerWidth()>>1)-5,null,16,null,null),$(c).append(m)):4==n&&(m=new Gb,a=va.get("enablePrompt","\u4e0d\u542f\u7528\u65f6\uff0c\u82e5\u5f53\u524d\u53c2\u6570\u8bbe\u7f6e\u4e3a\u7a7a\u503c\uff0c\u5c06\u6309\u7a7a\u503c\u4f5c\u4e3a\u8fc7\u6ee4\u6761\u4ef6\u5bf9\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3002\n\u542f\u7528\u65f6\uff0c\u82e5\u5f53\u524d\u53c2\u6570\u8bbe\u7f6e\u4e3a\u7a7a\u503c\uff0c\u5c06\u5ffd\u7565\u8fc7\u6ee4\u6761\u4ef6\u3002 \n"),
Ha.hasContent()&&(a+=va.get("enableSqlPrompt","\u6b64\u65f6\uff0c\u4f7f\u7528\u8be5\u53c2\u6570\u7684SQL\u67e5\u8be2\u8bed\u53e5\u4e4b\u540e\u9700\u52a0\u4e0a\u201cor ? is null\u201d\u624d\u80fd\u751f\u6548\u3002\n\u4f8b\uff1awhere \u5730\u533a in ('@region') or ? is null")),m.setTipsText(a),m=m.getJqUi(),Ra.layoutCtrlWithLRTB(m,($(c).outerWidth()>>1)+(ub.measureWidth(va.get("ignoreFilterByNull","\u7a7a\u503c\u65f6\u5ffd\u7565\u8fc7\u6ee4\u6761\u4ef6"))>>1)+5,null,null,3,null,null),$(c).append(m)));
else if(0==n){c=$(c);var q;h.getException(Ca.PARAM_CLIENT_ERROR)?q=sa.getErrorIcon(va.get("ctrlPropRequiredTips","\u63a7\u4ef6\u5c5e\u6027\u5b58\u5728\u672a\u8bbe\u7f6e\u7684\u5fc5\u586b\u9879\u3002")):h.getException(Ca.PARAM)&&(q=sa.getErrorIcon(va.get("ctrlPropSettingTips","\u63a7\u4ef6\u5c5e\u6027\u8bbe\u7f6e\u5b58\u5728\u9519\u8bef\u3002")));q&&c.append(q);q&&Ra.layoutCtrl(q,2,21);var w=a-ba.getHeadRowCount();a=new jb;(m=T&&T.isChecked())?a.setChecked(m):fb[w]?a.setChecked(!0):a.setChecked(!1);
m=a.getJqUi();a.addCheckedListener(function(C,I){I&&(C.isChecked()?(yb(),fb[w]=h,Object.keys(fb).length==Fb().length&&T.setChecked(!0)):(delete fb[w],0==Object.keys(fb).length&&cb(),T.setChecked(!1)))});Ra.layoutCtrlWithLRTB(m,($(c).outerWidth()>>1)-5,null,16,10,null,null);c.append(m)}else 1==n?(b($(c)),m=$("<div>"),a=h.getCtrlType(),q=Za.ctrlTypeToIconName(a),m.attr("title",Za.ctrlTypeToName(a)),m.addClass("extreport-dataset-designer-param-ctrl-table-name-icon"),x.background(m,q),a!=Za.LABEL&&a!=
Za.DATE||m.css("scale","0.8"),$(c).append(m)):2==n?(c=$(c),m=J.getCell().getValue(),a=$("<div>"),a.text(m),a.attr("title",m),a.addClass("extreport-dataset-designer-param-ctrl-table-input"),a.css({overflow:"hidden","text-overflow":"ellipsis"}),c.empty(),c.append(a),c.css("cursor","pointer")):3==n?(a=h.getDataType(),c=ba.createCtrlInCell(c,J.getCellWidth(),J.getCellHeight(),kb),c.setSelected(a),c.setItemModels(gb.ALL_DATA_TYPE),c.setUserObject(m),c.showFeature(!0),c.setCustomPainter(function(C,I,ra){var V=
$("<div>"),K=gb.dataTypeToIconName(ra);ra!=h.getDataType()||C||(K+="_selected");sb.background(V,K);V.addClass("extreport-dataset-designer-param-ctrl-table-type-icon");I.append(V);C=$("<div>");C.text(gb.dataTypeToName(ra));C.css("margin-left","20px");I.append(C)}),c.addSelectedChangedListener(d),c.getJqUi().css("box-shadow","none")):4==n?(m=new xb,m.setOn(h.getIsIgnoreNull()),m.addStateChangeListener(f),m=m.getJqUi(),m.addClass("extreport-dataset-designer-param-ctrl-table-switch-btn"),$(c).append(m)):
5==n&&(c=$(c),m=J.getCell().getValue(),a=$("<div>"),a.text(m),a.attr("title",m),a.addClass("extreport-dataset-designer-param-ctrl-table-input"),a.css({overflow:"hidden","text-overflow":"ellipsis"}),c.empty(),c.append(a),c.css("cursor","pointer"))};var b=function(c){var e=J.getCell().getValue(),a=$("<span>");a.css({overflow:"hidden","text-overflow":"ellipsis"});a.text(e);a.attr("title",e);a.addClass("extreport-dataset-designer-param-ctrl-table-input");a.addClass("param-ctrl-table-name-text-adjust");
c.append(a);c.css("cursor","pointer")},d=function(c,e,a){if(e!==a){var m=$a.getCurrentParam();za.removeRender(m);var n=m.getCtrlType();if(g(n,a))c.setItemModels(gb.ALL_DATA_TYPE),c.setSelected(a),m.setDataType(a),ac.render(m);else{var h=va.get("changeContrlTips","#1\u4e0d\u652f\u6301#2\u6570\u636e\u7c7b\u578b\uff0c\u6539\u53d8\u6570\u636e\u7c7b\u578b\u5c06\u4f1a\u6e05\u7a7a\u5f53\u524d\u63a7\u4ef6\u5c5e\u6027\uff0c\u786e\u5b9a\u8981\u6539\u53d8\u5417\uff1f");h=h.replace("#1",Za.ctrlTypeToName(n));
h=h.replace("#2",gb.dataTypeToName(a));n=Oa.createFeedbackDialog();n.setOptionType(Oa.OPTION_OK_CANCEL);n.setMessage(h);n.setClosingChecker(function(q){q==Oa.RETURN_OK&&(c.setItemModels(gb.ALL_DATA_TYPE),c.setSelected(a),m.clearException(Ca.PARAM_CLIENT_ERROR),m.clearException(Ca.PARAM),L.removeLinkage(m),m.setCtrlType(Za.INPUT),m.setDataType(a),q=mb.createCtrl(Za.INPUT,m),q.setIsRequired(!1),q.setCtrlState(O.STANDER),q.setDefaultValueType(Fa.CONSTANT),q.setBindSourceType&&q.setBindSourceType(Ta.DATA_SET),
m.setCtrlObject(q),$a.funcShowErrorIcon(),$a.updateTable(),c.setBindSourceType&&q.addException(Ca.PARAM_CLIENT_ERROR,m.getName(),va.get("ctrlPropRequiredTips","\u63a7\u4ef6\u5c5e\u6027\u5b58\u5728\u672a\u8bbe\u7f6e\u7684\u5fc5\u586b\u9879\u3002")));return!0});n.showDialog();c.setSelected(e)}}},f=function(c,e){$a.getCurrentParam().setIsIgnoreNull(c.isOn())},g=function(c,e){if(e==gb.TXT||e==gb.BOOLEAN)switch(c){case Za.DATE:case Za.SPINNER:return!1}else if(e==gb.NUMERICAL)switch(c){case Za.DATE:return!1}else switch(c){case Za.SWITCH:case Za.SPINNER:return!1}return!0}}
var $a=this,Sa,fb={},Ha,Bb,pb,lb,t,hb,Ya,Jb,rb,vb=$("<div>"),Db,Kb,fc,Sb,ac;this.getJqUi=function(){if(!Sa){Sa=$("<div>");var u=new Pa(va.get("paramList","\u53c2\u6570\u5217\u8868")),J=$("<div>"),da=$("<div>");da.addClass("extreport-dataset-designer-toolbar-box");var T=Yb("extreport-dataset-designer-param-toolbar-btn-menu",va.get("append","\u65b0\u589e"),cc,!0);da.append(T);Ha.hasContent()?dc(da):T.addClass("extreport-dataset-designer-param-toolbar-btn-menu-right");da.append($("<div class='extreport-dataset-designer-param-toolbar-line'>"));
Bb=Yb("extreport-dataset-designer-param-toolbar-btn",va.get("del","\u5220\u9664"),hc);da.append(Bb);da.append($("<div class='extreport-dataset-designer-param-toolbar-line'>"));da.append(Yb("extreport-dataset-designer-param-toolbar-btn",va.get("importParam","\u5bfc\u5165\u53c2\u6570"),gc));da.append($("<div class='extreport-dataset-designer-param-toolbar-line'>"));pb=Yb("extreport-dataset-designer-param-toolbar-btn",va.get("up","\u4e0a\u79fb"),Ma);da.append(pb);da.append($("<div class='extreport-dataset-designer-param-toolbar-line'>"));
lb=Yb("extreport-dataset-designer-param-toolbar-btn",va.get("down","\u4e0b\u79fb"),Z);da.append(lb);da.append($("<div class='extreport-dataset-designer-param-toolbar-line'>"));da.append(Yb("extreport-dataset-designer-param-toolbar-btn",va.get("paramView","\u53c2\u6570\u8054\u52a8\u89c6\u56fe"),ka));cb();T=Ib();J.append(da);J.append(T);J.addClass("extreport-dataset-designer-param-border");Sa.append(u.getJqUi());Sa.append(J);Zb()}return Sa};this.setParamDetailArea=function(u){ac=u};this.setDataSetModel=
function(u){Ha=u;u={};for(var J=Object.keys(fb),da=0;da<J.length;da++){var T=Number(J[da]);u[T]=Eb(T)}fb=u};var Fb=function(){return Ha?Ha.getParameters():null},Eb=function(u){return Ha.getParameters()[u]},dc=function(u){var J=new zb;bb(J,Vb,va.get("addParamBySearch","\u6839\u636e\u67e5\u8be2\u8bed\u53e5\u65b0\u589e\u53c2\u6570"),!0);var da=$("<div>");da.addClass("extreport-dataset-designer-param-toolbar-arrow-icon");da.attr("id","arrow-up");x.background(da,"ArrowDown");da.on("click",function(T){bc(da,
u,function(){return J})});u.append(da)},bc=function(u,J,da){var T=u.data("menu");T&&T.isShowing()?(u.data("menu",null),T.hide()):(T=new Aa,T.setWidth(120),T.setModel(da()),T.setHideListener(function(){u.data("menu",null)}),u.data("menu",T),T.getJqUi().find(".sa-ctrl-menu-item-text").addClass("impor-menu-text-color"),T.show(Sa,15,60,J,!0))},bb=function(u,J,da,T){J=new ib(J);T?J.setText(da):J.setText(da+"...");u.addItemModel(J)},Yb=function(u,J,da){var T=$("<div>");T.addClass(u);T.on("click",da);T.text(J);
T.attr("title",J);return T},Ib=function(){Ya=new ba.createTable;var u=new qb(Ya);u.setOutsideVisible(!1);Ya.setCellRender(u);Ya.addColumns(6);Ya.getColumn(0).setWidth(30);Ya.getColumn(1).setWidth(120);Ya.getColumn(2).setWidth(140);Ya.getColumn(3).setWidth(100);Ya.getColumn(4).setWidth(Ha.isShowIgnoreFilterByNull()?140:0);Ya.getColumn(5).setWidth(200);u=ba.createHeadRow(Ya);u.getCell(1).setValue(va.get("name","\u540d\u79f0"));u.getCell(2).setValue(va.get("displayName","\u663e\u793a\u540d\u79f0"));
u.getCell(3).setValue(va.get("dataType","\u6570\u636e\u7c7b\u578b"));u.getCell(4).setValue(va.get("ignoreFilterByNull","\u7a7a\u503c\u65f6\u5ffd\u7565\u8fc7\u6ee4\u6761\u4ef6"));u.getCell(5).setValue(va.get("descr","\u5907\u6ce8"));Ya.setColumnFitVisibleWidth(!0);Ya.setDraggableAdjusting(!0,3,0,new Ga);la().setMode(KTSelectionModel.MODE_SINGLE);la().setPolicy(KTSelectionModel.POLICY_ROW);Ya.setSelectionRender(ob);la().addChangeListener(function(J,da){if(J==KTSelectionModel.CHANGE_ADD)if(J=da[0].getRowIdx(),
Ya.getRow(J,!1)){da=Eb(J-ba.getHeadRowCount());var T;0<Kb&&(T=Eb(Kb));T&&da!==T&&Rb(T);Kb=J-ba.getHeadRowCount();ac.render(da)}else ac.render(null)});Ya.addCellClickListener(function(J,da){da.getCell()?(J=da.getColIdx(),da=da.getRowIdx(),wa(da,J)&&Qb(da,J)):(t&&t.remove(),t=null)});ba.bindTableListenerForCtrl(Ya,function(J,da,T,ub){(da=J.data("my-ctrl"))&&da.showFeature&&da.showFeature(!0);ub?wa(T,ub)&&(hb=$("<div>"),hb.addClass("param-ctrl-table-mouse-move-line"),1===ub&&hb.addClass("param-ctrl-table-name-text-adjust"),
J.append(hb)):(hb&&$(hb).remove(),hb=null)});Jb=$(Ya.getUI());Jb.addClass("extreport-dataset-designer-param-ctrl-table");return Jb};this.funcShowErrorIcon=function(u){if(u)Rb(u);else for(u=0;u<Fb().length;u++)Rb(Eb(u))};var Rb=function(u){var J=Fb().indexOf(u);if(-1!==J){J=ba.getHeadRowCount()+J;J=Ya.searchJqCell(J,0);var da=J.find(".extreport-dataset-designer-param-ctrl-fault-mark");u.check();var T;u.getException(Ca.PARAM_CLIENT_ERROR)?T=u.getException(Ca.PARAM_CLIENT_ERROR):u.getException(Ca.PARAM)&&
(T=va.get("ctrlPropSettingTips","\u63a7\u4ef6\u5c5e\u6027\u8bbe\u7f6e\u5b58\u5728\u9519\u8bef\u3002"));T?0==da.length?(da=sa.getErrorIcon(T),Ra.layoutCtrl(da,2,21),J.append(da)):da.attr("title",T):da&&da.remove()}};this.checkAllParam=function(){for(var u=0;u<Fb().length;u++)Eb(u).check()};var wa=function(u,J){return u<ba.getHeadRowCount()||3===J||4===J?!1:!0},Qb=function(u,J,da){if(!t||Sb!==J||u!==fc){t&&t.remove();fc=u;Sb=J;for(var T=$a.getCurrentParam(),ub=Ya.searchJqCell(u,J),b=tb(T,J),d=new wb,
f=u-2,g="Param"+f,c=Ha.getParamNameSet();c[g.toLowerCase()];)f++,g="Param"+f;b?d.setText(b):1===J&&(T.setName(g),T.setAlias(g),d.setPlaceholder(g));t=d.getJqUi();t.addClass("param-table-textfield-background");1===J&&t.addClass("param-ctrl-table-name-text-adjust");d.addBlurListener(function(e){t.remove();t=null;!nb(e,T,u,J,g,da,!0)&&da&&$a.updateTable()});d.addAcceptableListener(function(e){nb(e,T,u,J,g,da,!1)&&(t.remove(),t=null)});ub.append(t);d.requestFocus()}},nb=function(u,J,da,T,ub,b,d){u=u.getText().trim();
ub=tb(J,T);if(1===T){if(!u)return u=U.getMessageCurtain(),d?b?(Ya.setSyncUIWhenModelChanged(!0),$b(J,da,T,J.getName(),b),$a.refreshTable(),Ya.setSyncUIWhenModelChanged(!1)):u.showPrompt(va.get("giveUpChangeByEmptyName","\u540d\u79f0\u4e0d\u53ef\u4e3a\u7a7a\uff0c\u5df2\u653e\u5f03\u4fee\u6539\u3002")):u.showPrompt(va.get("giveUpChangeByEmptyNameClick","\u540d\u79f0\u4e0d\u53ef\u4e3a\u7a7a\u3002")),!1;a:{for(var f=U.getMessageCurtain(),g=0;g<Fb().length;g++)if(J!==Eb(g)&&u.toUpperCase()===Eb(g).getName().toUpperCase()){d?
f.showPrompt(va.get("giveUpByRepetitionName","\u91cd\u590d\u7684\u540d\u79f0\uff1a# \uff0c\u5df2\u653e\u5f03\u4fee\u6539\u3002").replace("#",u)):f.showPrompt(va.get("repetitionName","\u91cd\u590d\u7684\u540d\u79f0\uff1a# \u3002").replace("#",u));d=!1;break a}oa.check(u)?d=!0:(d?f.showPrompt(va.get("nameErrorGiveUp","\u540d\u79f0\u53ea\u80fd\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u4e14\u4e0d\u80fd\u662f\u7eaf\u6570\u5b57\uff0c\u5df2\u653e\u5f03\u4fee\u6539")):
f.showPrompt(va.get("nameError","\u540d\u79f0\u53ea\u80fd\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\uff0c\u4e14\u4e0d\u80fd\u662f\u7eaf\u6570\u5b57\u3002")),d=!1)}if(!d)return!1}if(u===ub)return!1;Ya.setSyncUIWhenModelChanged(!0);$b(J,da,T,u,b);$a.refreshTable();1===T&&U.fireEvent(Ea.PARAM_NAME_CHANGE,{model:Ha});Ya.setSyncUIWhenModelChanged(!1);return!0},$b=function(u,J,da,T,ub){J=Ya.getRow(J);var b=J.getCellForDraw(da);1===da?(u.setName(T),ub&&(u.setAlias(T),J.getCellForDraw(da+
1).setValue(T))):2===da?(T||(T=u.getName()),u.setAlias(T)):5===da&&u.setRemark(T);b.setValue(T);return!0},tb=function(u,J){if(1===J)return u.getName();if(2===J)return u.getAlias();if(5===J)return u.getRemark()},Vb=function(){for(var u=Ha.getParamInSql(),J=Ha.getParamNameSet(),da=[],T="",ub=0;ub<u.length;ub++)!J[u[ub].toLowerCase()]&&oa.check(u[ub])&&(da.push(u[ub]),T+=u[ub]+va.get("dot","\u3001"));J=Oa.createFeedbackDialog();0<da.length?(u=va.get("addTips","\u68c0\u6d4b\u5230\u4ee5\u4e0b\u53c2\u6570\u672a\u65b0\u589e\uff0c\u662f\u5426\u65b0\u589e\uff1a#1;"),
T=T.slice(0,T.length-1),u=u.replace("#1",T),J.setOptionType(Oa.OPTION_OK_CANCEL),J.setClosingChecker(function(b){if(b==Oa.RETURN_OK){b=0===Fb().length;for(var d=0;d<da.length;d++){var f=Va.createDefault(Ha);f.setName(da[d]);f.setAlias(da[d]);Ha.pushParameter(f)}$a.updateTable();b&&Zb()}return!0})):(u=va.get("noAddParamBySearch","\u67e5\u8be2\u8bed\u53e5\u4e2d\u6682\u65e0\u672a\u65b0\u589e\u7684\u53c2\u6570\u3002"),J.setOptionType(Oa.OPTION_OK));J.setMessage(u);J.showDialog()},Zb=function(){if(0!==
Fb().length){la().removeAllSelecteds();var u=ba.getHeadRowCount();u=KTSelectionModel.Target.createRow(u);la().addSelected(u)}},cc=function(){var u=Va.createDefault(Ha);Ha.pushParameter(u);la().removeAllSelecteds();$a.updateTable();u=ba.getHeadRowCount()+Fb().length-1;var J=KTSelectionModel.Target.createRow(u);la().addSelected(J);t&&t.remove();Qb(u,1,!0)},hc=function(u){0===Object.keys(fb).length?u.preventDefault():(u=Oa.createFeedbackDialog(),u.setOptionType(Oa.OPTION_OK_CANCEL),u.setMessage(va.get("delTips",
"\u5220\u9664\u6240\u9009\u53c2\u6570\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f")),u.setClosingChecker(function(J){if(J==Oa.RETURN_OK){fb[Kb]&&(Kb=-1);J=Object.values(fb);for(var da=0;da<J.length;da++){var T=J[da];za.removeRender(T);L.removeLinkage(T);$a.funcShowErrorIcon();Ha.removeParamByObject(T)}fb={};0==Fb().length?(la().removeAllSelecteds(),ac.render(null)):(J=la().getSelected(),la().removeAllSelecteds(),J=J.getRowIdx(),J+1-ba.getHeadRowCount()>Fb().length&&
(J=ba.getHeadRowCount()+Fb().length-1),J=KTSelectionModel.Target.createRow(J),la().addSelected(J));cb();$a.updateTable()}return!0}),u.showDialog())},gc=function(){var u=new ab(U);u.setTitle(va.get("importParam","\u5bfc\u5165\u53c2\u6570"));var J=new xa(U,u.getDialogParam());u.buildContextArea(J);u.setFuncQueryRightAreaByMenu(J.loadDataSetByGroupId);u.setFuncBeforeCloseChecker(function(){var da=u.getResult();if(0===da.length)return!0;var T=0===Fb().length,ub=na(da);if(0<ub.length){var b=Oa.createFeedbackDialog();
b.setOptionType(Oa.OPTION_OK_CANCEL);for(var d=va.get("coverName","\u540d\u79f0#Param\u5df2\u7ecf\u5b58\u5728\uff0c\u786e\u5b9a\u8981\u8986\u76d6\u5417\uff1f"),f="",g=0;g<ub.length;++g){var c=ub[g].getName();f+='"'+c+'"'+va.get("dot","\u3001")}f=f.slice(0,f.length-1);d=d.replace("#Param",f);b.setMessage(d);b.setClosingChecker(function(e){if(e==Oa.RETURN_OK){e={};for(var a=0;a<ub.length;a++)e[ub[a].getName().toLowerCase()]=!0;for(a=0;a<Fb().length;++a){var m=Eb(a).getName().toLowerCase();if(e[m]){m=
a;var n=Eb(m);L.removeLinkage(n);$a.funcShowErrorIcon();Ha.removeParameterByIndex(m,1);a--}}jc(da);u.closeDialog();T&&Zb()}return!0});b.showDialog();return!1}jc(da);T&&Zb();return!0});u.showDialog()},jc=function(u){for(var J=0;J<u.length;++J){var da=u[J];da.setModel(Ha);var T=da.getCtrlObject();T.getBindSource&&T.getBindSource()&&T.getBindSource().setModel(Ha);da.check();Ha.pushParameter(da)}$a.updateTable()},na=function(u){for(var J=[],da=Ha.getParamNameSet(),T=0;T<u.length;++T){var ub=u[T],b=ub.getName();
da[b.toLowerCase()]&&J.push(ub)}return J},Ma=function(u){0===Object.keys(fb).length?u.preventDefault():(X.moveSelectedUp(Fb(),fb),$a.updateTable())},Z=function(u){0===Object.keys(fb).length?u.preventDefault():(X.moveSelectedDown(Fb(),fb),$a.updateTable())},ka=function(){(new ia(U,Fb())).showDialog()};this.getCurrentParam=function(){var u=la().getSelected();if(!u)return null;u=u.getRowIdx();return Ya.getRow(u)?Eb(u-ba.getHeadRowCount()):null};var la=function(){return Ya&&Ya.getSelectionModel()};this.updateTable=
function(){if(Fb()&&0<Fb().length){if(Jb.css("display","block"),vb.css("display","none"),0!=Sa.prop("offsetWidth")){ba.clear(Ya);Ya.addColumns(6);Ya.getColumn(0).setWidth(30);Ya.getColumn(1).setWidth(120);Ya.getColumn(2).setWidth(140);Ya.getColumn(3).setWidth(100);Ya.getColumn(4).setWidth(Ha.isShowIgnoreFilterByNull()?140:0);Ya.getColumn(5).setWidth(200);var u=ba.createHeadRow(Ya);u.getCell(1).setValue(va.get("name","\u540d\u79f0"));u.getCell(2).setValue(va.get("displayName","\u663e\u793a\u540d\u79f0"));
u.getCell(3).setValue(va.get("dataType","\u6570\u636e\u7c7b\u578b"));u.getCell(4).setValue(va.get("ignoreFilterByNull","\u7a7a\u503c\u65f6\u5ffd\u7565\u8fc7\u6ee4\u6761\u4ef6"));u.getCell(5).setValue(va.get("descr","\u5907\u6ce8"));Ya.setSyncUIWhenModelChanged(!1);u=new KTStyle;u.setBackgroundColor(com.kingdee.bos.qing.common.CommonTableSkin.ODD_ROW_BACKGROUND_COLOR);var J=new KTBorderStyle;J.setBottomBorderWidth(1);J.setBottomBorderPen("solid");J.setBottomBorderColor("#e5e5e5");for(var da=0;da<Fb().length;++da){var T=
Eb(da),ub=ba.createRow(Ya);ub.getCell(1).setValue(T.getName());ub.getCell(2).setValue(T.getAlias());ub.getCell(5).setValue(T.getRemark());ub.setBorder(J);ub.setStyle(u);ub.setHeight(40);ub.setUserObject(T)}Ya.setSyncUIWhenModelChanged(!0);ba.refresh(Ya);La()}}else rb||(vb.addClass("extreport-dataset-designer-param-ctrl-table-tip"),rb=$("<div>"),rb.addClass("extreport-dataset-designer-param-ctrl-tip-text"),rb.text(va.get("noParameter","\u6682\u65e0\u53c2\u6570")),Db=$("<div>"),Db.addClass("extreport-dataset-designer-param-ctrl-tip-background"),
x.background(Db,"NoParam"),vb.hide(),vb.append(rb),vb.append(Db),vb.appendTo(Sa)),Jb.css("display","none"),vb.css("display","block")};this.refreshTable=function(){ba.refresh(Ya);La()};var La=function(){if(la()&&la().hasSelected()){var u=la().getSelected();la().removeAllSelecteds();u&&la().addSelected(u)}},cb=function(){Bb&&Bb.addClass("extreport-dataset-designer-param-toolbar-btn-disable");pb&&pb.addClass("extreport-dataset-designer-param-toolbar-btn-disable");lb&&lb.addClass("extreport-dataset-designer-param-toolbar-btn-disable")},
yb=function(){Bb&&Bb.removeClass("extreport-dataset-designer-param-toolbar-btn-disable");pb&&pb.removeClass("extreport-dataset-designer-param-toolbar-btn-disable");lb&&lb.removeClass("extreport-dataset-designer-param-toolbar-btn-disable")}}function ia(U,ob){function qb(na){KTDefaultCellRender.call(this,na);var Ma=this;this.paintCellUI=function(Z,ka){ka=Ma.getCurrentRowIdx();var la=Ma.getCurrentRow().getUserObject();Z=$(Z);var La=$("<div>");La.addClass("extreport-dataset-designer-param-linkage-dialog-left-icon");
x.background(La,Za.ctrlTypeToMicroIconName(la.getCtrlType()));var cb=$("<div>");la=la.getAlias()?la.getAlias():la.getName();cb.text(la);Ra.layoutCtrlWithLRTB(cb,30,0,null,6);Ra.makeTextOmissible(cb);cb.attr("title",la);Z.append(La);Z.append(cb);Sb&&ka===Db[Sb]&&Z.addClass("linkage-dialog-selection-style")}}function $a(na){KTDefaultCellRender.call(this,na);var Ma=this;this.paintCellUI=function(Z,ka){var la=Ma.getCell().getValue(),La=Ma.getCell().getTreeModel(),cb=$("<div>"),yb=$("<div>"),u=la.getDisplay()?
la.getDisplay():la.getValue();yb.text(u);Ra.layoutCtrlWithLRTB(yb,30,0,null,6);Ra.makeTextOmissible(yb);yb.attr("title",u);Z=$(Z);la.getParent()?(cb.addClass("param-linkage-tree-leaf-icon"),u=la.getType(),u=gb.dataTypeToIconName(u),Sb&&Sb===jc(la)?(Z.addClass("linkage-dialog-selection-style"),u+="_selected"):Z.addClass("param-linkage-tree-leaf-font-color"),sb.background(cb,u)):(cb.addClass("param-linkage-tree-root-icon"),x.background(cb,Za.ctrlTypeToMicroIconName(la.getType())),Z.addClass("linkage-dialog-tree-root-pointer"),
Z.on("click",function(){la.setExpanded(!la.getExpanded());La.setExpanded(la.getExpanded());ba.refresh(hb);tb();cc()}),Sb&&!Kb[Sb]&&Sb.substring(0,Sb.indexOf("^"))===la.getValue()&&Z.addClass("linkage-dialog-selection-style"));Ra.layoutCtrl(yb,30,6,null,null);ka=$(ka);ka.append(cb);ka.append(yb)}}function Sa(na){KTDefaultTreeHandlerRender.call(this,na);var Ma=this;this.create=function(Z,ka,la,La,cb,yb,u){var J=20*Z.getLevel();var da=J+17;var T=null;if(Ma.protectedMethod.isTreeNodeHasChildren(Z,ka,
la)||Z.isHaveHandlerAlways())T=Ma.protectedMethod.createAbsoluteHtmlElement("div",J,cb,17,u),T.style.cursor="pointer",ka=$(T),ka.addClass("tree-handler-icon"),la=$("<div>"),ka.append(la),Z.isExpanded()?(la.addClass("lower-triangle"),la.removeClass("right-triangle")):(la.addClass("right-triangle"),la.removeClass("lower-triangle"));ka=[T,da,cb,null];Z=ka[0];da=ka[1];T=ka[2];ka=ka[3];La=Ma.protectedMethod.createAbsoluteHtmlElement("span",da,T,La+yb-da,cb+u-T);return[Z,La,ka]}}function fb(){var na,Ma,
Z,ka,la,La;this.getDisplay=function(){return la};this.setDisplay=function(cb){la=cb};this.getValue=function(){return La};this.setValue=function(cb){La=cb};this.setType=function(cb){ka=cb};this.getType=function(){return ka};this.getChildNum=function(){return Ma?Ma.length:0};this.getParent=function(){return Z};this.setParent=function(cb){Z=cb};this.getExpanded=function(){return na};this.setExpanded=function(cb){na=cb};this.getChildren=function(){return Ma};this.setChildren=function(cb){Ma=cb}}function Ha(na,
Ma){var Z=0,ka=na,la=224,La=Ma,cb=!1,yb,u=0,J,da;this.getSlope=function(){return(La-ka)/(la-Z)};this.setState=function(T){u=T};this.getState=function(){return u};this.setPairKey=function(T){da=T};this.getPairKey=function(){return da};this.setText=function(T){J=T};this.getText=function(){return J};this.getTextX=function(){return Z+la>>1};this.getTextY=function(){return ka+La>>1};this.getTailX=function(){return Z};this.setTailX=function(T){Z=T};this.setTailY=function(T){ka=T};this.getTailY=function(){return ka};
this.getHeadX=function(){return la};this.setHeadX=function(T){la=T};this.setHeadY=function(T){La=T};this.getHeadY=function(){return La};this.isSelected=function(){return cb};this.setSelected=function(T){cb=T};this.isSolid=function(){return yb};this.setSolid=function(T){yb=T}}Nb.call(this);var Bb=this,pb=this.protectedMethod,lb,t,hb,Ya,Jb,rb=[],vb=[],Db={},Kb={},fc={},Sb,ac=0,Fb=0,Eb,dc,bc=[],bb;(function(){pb.setTitle(va.get("ctrlInnerView","\u63a7\u4ef6\u8054\u52a8\u89c6\u56fe"));pb.setSelectable(!0);
Bb.setSize(700,500);pb.setContentPaneCreator(function(){lb=$("<div>");for(var na=[],Ma=[],Z=0;Z<ob.length;Z++){var ka=ob[Z],la=ka.getCtrlObject();if(la.getLinkageParams)for(var La=la.getLinkageParams(),cb=0;cb<La.length;cb++){var yb=La[cb];yb=yb.getLinkageParamName()+"^"+yb.getRelatedDSParamName();Db[yb]=Z}la.getBindSource&&la.getBindSource()&&la.getBindSourceType()===Ta.DATA_SET&&(la.getException(Ca.PARAM_CTRL_BIND_SOURCE,ka.getName()+B.SOURCE_BIND)&&(fc[ka.getName()]=!0),Ma.push(la.getBindSource().toJsonObject()),
na.push(ka));rb.push(ka)}Yb(Ma,na);return lb});pb.setClosingAction(function(na){});pb.setFooterPaneCreator(null)})();var Yb=function(na,Ma){var Z=U.createParamCtrlFacade(function(ka){var la={};if(ka&&0<ka.length)for(var La=0;La<ka.length;La++){var cb=ka[La];la[cb.datasetId]=cb.parameters}for(La=0;La<Ma.length;La++){var yb=Ma[La];cb=yb.getCtrlObject().getBindSource().getId();ka=new fb;ka.setDisplay(yb.getAlias()?yb.getAlias():yb.getName());ka.setValue(yb.getName());ka.setExpanded(!0);ka.setType(yb.getCtrlType());
cb=la[cb];if(!cb||0===cb.length){a:{for(var u=Object.keys(Db),J=0;J<u.length;J++)if(u[J].split("^")[0]===yb.getName()){yb=!0;break a}yb=!1}if(!yb)continue}vb.push(ka);yb=[];for(u=0;cb&&u<cb.length;u++){J=cb[u];var da=new fb;da.setDisplay(J.alias);da.setValue(J.name);da.setType(J.dataType);da.setParent(ka);yb.push(da);vb.push(da);J=ka.getValue()+"^"+da.getValue();0<=Db[J]&&(Kb[J]=vb.length-1)}ka.setChildren(yb)}Ib();hc();0<vb.length&&(wa(),bb=$("<div>"),bb.addClass("linkage-dialog-alter-pane"),Ra.layoutCtrlWithLRTB(bb,
null,null,null,null,20,20),bb.hide(),lb.append(bb),tb(),cc())},function(){Ib();hc()});Z.setBlockingJqUi(lb);Z.queryBatchLinkageVO(na)},Ib=function(){var na=$("<div>");na.text(va.get("innerSrcCtrl","\u8054\u52a8\u6e90\u63a7\u4ef6"));na.addClass("extreport-dataset-designer-param-linkage-dialog-title");na.attr("title",va.get("innerSrcCtrl","\u8054\u52a8\u6e90\u63a7\u4ef6"));Jb=$("<div>");Jb.addClass("extreport-dataset-designer-param-linkage-dialog-border");Jb.css({left:"0px"});t=ba.createTable();t.setColumnFitVisibleWidth(!0);
t.setSyncUIWhenModelChanged(!0);t.setDraggableAdjusting(!0,3,0,new Pb);t.setScrollerVisible("unset","unset");var Ma=new qb(t);t.setCellRender(Ma);t.addColumns(1);lb.append(na);Jb.append($(t.getUI()));lb.append(Jb);var Z=null;Jb.scroll(function(){window.clearTimeout(Z);Z=window.setTimeout(function(){if(0!=bc.length){var ka=Jb.scrollTop(),la=ka-ac;ac=ka;for(ka=0;ka<bc.length;ka++){var La=bc[ka],cb=La.getTailY()-la;La.setTailY(cb)}cc()}},0)});Rb(t)},Rb=function(na){na.setSyncUIWhenModelChanged(!1);var Ma=
new KTStyle;Ma.setBackgroundColor(com.kingdee.bos.qing.common.CommonTableSkin.ODD_ROW_BACKGROUND_COLOR);for(var Z=0;Z<rb.length;Z++){var ka=rb[Z],la=ba.createRow(na);la.setStyle(Ma);la.setHeight(30);la.setUserObject(ka)}na.setSyncUIWhenModelChanged(!0);ba.refresh(na)},wa=function(){Eb=$("<div>");var na=$(F.createCanvas());na.width=224;na.height=351;Eb.on("mousemove",function(Ma){a:{var Z=Ma.offsetX;Ma=Ma.offsetY;for(var ka=0;ka<bc.length;ka++){var la=bc[ka],La=la.getHeadX()-la.getTailX(),cb=la.getHeadY()-
la.getTailY(),yb=Math.sqrt(La*La+cb*cb);if(6>Math.abs(cb*(Z-la.getTailX())-La*(Ma-la.getTailY()))/yb){dc=la;Z=!0;break a}}dc=null;Z=!1}Z?Eb.css("cursor","pointer"):Eb.css("cursor","")});Eb.on("click",function(){if(dc){Sb=dc.getPairKey();var Ma=Db[Sb],Z=Kb[Sb];if(0<=Z){var ka=vb[Z].getParent();ka&&!ka.getExpanded()&&(ka.setExpanded(!0),gc())}else for(ka=0;ka<vb.length;ka++)if(vb[ka].getValue()===Sb.substring(0,Sb.indexOf("^"))){Z=ka;break}hb.updateUI();ba.refresh(t);$(Ya).animate({scrollTop:Qb(Z+1)});
$(Jb).animate({scrollTop:Qb(Ma+1)});ka=Sb;Z=dc.getState();var la=ka.split("^");Ma=new R;Ma.setFontSize(12);if(0==Z)Z=va.get("innerParam","\u201c#1\u201d\u8054\u52a8\u201c#2\u201d\u3002\u76ee\u6807\u53c2\u6570[#3]\u3002"),Z=Z.replace("#1",$b(ka)),ka=vb[Kb[ka]],ka=[ka.getDisplay(),ka.getParent().getDisplay()],Z=Z.replace("#2",ka[1]).replace("#3",ka[0]),Ma=Ma.measureWidth(Z);else{var La=la[0];Z=nb(La);-1!==Z&&(La=vb[Z].getDisplay());fc[la[0]]?(Z=va.get("sourceError","\u201d#1\u201d\u8054\u52a8\u201d#2\u201d\u3002\u76ee\u6807\u63a7\u4ef6\u6570\u636e\u6e90\u5b58\u5728\u9519\u8bef\u3002"),
Z=Z.replace("#1",$b(ka)),Z=Z.replace("#2",La)):(Z=va.get("innerNoParam","\u201d#1\u201d\u8054\u52a8\u201d#2\u201d\u3002\u53c2\u6570\u201d#3\u201d\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002"),Z=Z.replace("#1",$b(ka)).replace("#2",La).replace("#3",la[1]));La=sa.getErrorIcon(Z);Ma=Ma.measureWidth(Z)+10}bb.css("width",Ma+10);bb.text(Z);bb.attr("title",Z);La&&bb.append(La);bb.show();tb();cc()}else Sb&&(Sb=null,ba.refresh(t),hb.updateUI(),bb.empty(),bb.hide(),tb(),cc())});Ra.layoutCtrl(Eb,222,
30,224,352);Eb.append(na);lb.append(Eb)},Qb=function(na){na=30*na-350;return 0<na?na:0},nb=function(na){for(var Ma=0;Ma<vb.length;Ma++){var Z=vb[Ma];if(!Z.getParent()&&Z.getValue()===na)return Ma}return-1},$b=function(na){na=rb[Db[na]];return na.getAlias()?na.getAlias():na.getName()},tb=function(){bc=[];for(var na=Object.keys(Db),Ma=0;Ma<na.length;Ma++){var Z=na[Ma],ka=Z.split("^")[0],la=Db[Z],La=Kb[Z];if(void 0==La)La=nb(ka),0<=La&&(La=Vb(La),la=30*(la+.5)-ac,La=30*(La+.5)-Fb,bc.push(Zb(la,La,Z,
!0,2)));else{var cb=!0,yb=vb[La].getParent();yb.getExpanded()||(La=vb.indexOf(yb),cb=!1);La=Vb(La);la=30*(la+.5)-ac;La=30*(La+.5)-Fb;bc.push(Zb(la,La,Z,cb,fc[ka]?2:void 0))}}},Vb=function(na){for(var Ma=na-1;0<=Ma;Ma--){var Z=vb[Ma];Z.getParent()||Z.getExpanded()||(na-=Z.getChildNum())}return na},Zb=function(na,Ma,Z,ka,la){na=new Ha(na,Ma);na.setPairKey(Z);na.setSolid(ka);na.setSelected(Z===Sb);la&&(na.setState(la),na.setText("!"));return na},cc=function(){var na=Eb.children().first(),Ma=Eb.prop("offsetWidth"),
Z=Eb.prop("offsetHeight");na.css({width:Ma,height:Z});na=F.createContext2d(na[0],Ma,Z);for(Ma=0;Ma<bc.length;Ma++){na.beginPath();Z=bc[Ma];Z.isSolid()?na.setLineDash([]):na.setLineDash([5,5]);Z.isSelected()?(na.strokeStyle="#88a7f6",na.fillStyle="#88a7f6"):(na.strokeStyle="#666666",na.fillStyle="#666666");na.moveTo(Z.getTailX(),Z.getTailY());na.lineTo(Z.getHeadX(),Z.getHeadY());na.stroke();var ka=Z,la=na,La=ka.getSlope();La=Math.atan(La)/(Math.PI/180);La=Math.round(La);var cb=(La+20)*Math.PI/180,
yb=(La-20)*Math.PI/180;La=ka.getHeadX()-Math.round(10*Math.cos(cb));cb=ka.getHeadY()-Math.round(10*Math.sin(cb));var u=ka.getHeadX()-Math.round(10*Math.cos(yb));yb=ka.getHeadY()-Math.round(10*Math.sin(yb));la.beginPath();la.setLineDash([]);la.moveTo(ka.getHeadX(),ka.getHeadY());la.lineTo(La,cb);la.lineTo(u,yb);la.lineTo(ka.getHeadX(),ka.getHeadY());la.fill();la.closePath();la.stroke();Z.getState()&&(na.save(),na.lineWidth=.7,na.strokeStyle="rgb(188, 17, 24)",na.fillStyle="yellow",na.beginPath(),na.arc(Z.getTextX()+
3,Z.getTextY(),6.5,0,2*Math.PI),na.fill(),na.fillStyle="rgb(188, 17, 24)",na.lineWidth=1,na.font="normal normal bold 12px \u5fae\u8f6f\u96c5\u9ed1",na.fillText(Z.getText(),Z.getTextX()+1,Z.getTextY()+5),na.stroke(),na.restore())}},hc=function(){Ya=$("<div>");Ya.addClass("extreport-dataset-designer-param-linkage-dialog-border");var na=$("<div>");na.text(va.get("innerActCtrl","\u8054\u52a8\u201c\u4f5c\u7528\u4e8e\u201d\u76ee\u6807\u63a7\u4ef6"));na.addClass("extreport-dataset-designer-param-linkage-dialog-title");
na.attr("title",va.get("innerActCtrl","\u8054\u52a8\u201c\u4f5c\u7528\u4e8e\u201d\u76ee\u6807\u63a7\u4ef6"));na.css({left:"448px"});hb=new KTable;hb.setColumnFitVisibleWidth(!0);hb.setCellRender(new $a(hb));hb.setTreeHandlerRender(new Sa(hb));hb.setSyncUIWhenModelChanged(!1);hb.setScrollerVisible("unset","unset");var Ma=$(hb.getUI());lb.append(na);Ya.append(Ma);lb.append(Ya);hb.addColumns(1);gc();hb.updateUI();var Z=null;Ya.scroll(function(){window.clearTimeout(Z);Z=window.setTimeout(function(){if(0!=
bc.length){var ka=Ya.scrollTop(),la=ka-Fb;Fb=ka;for(ka=0;ka<bc.length;ka++){var La=bc[ka];La.setHeadY(La.getHeadY()-la)}cc()}},0)})},gc=function(){hb.removeAllRows();hb.setSyncUIWhenModelChanged(!1);for(var na=0;na<vb.length;na++){var Ma=vb[na],Z=hb.addRow();Z.setHeight(30);var ka=Z.getCell(0);ka.setValue(Ma);var la=Ma.getParent();if(la){var La=new KTCellTreeModel(1);Ma=la.getExpanded();Z.setHide(!Ma)}else La=new KTCellTreeModel(0),La.setExpanded(Ma.getExpanded());ka.setTreeModel(La)}hb.setSyncUIWhenModelChanged(!0)},
jc=function(na){return na.getParent()?na.getParent().getValue()+"^"+na.getValue():null}}function ua(U){var ob=this,qb,$a,Sa=$("<div>"),fb,Ha,Bb,pb;this.getJqUi=function(){if(!qb){qb=$("<div>");var lb=new Pa(va.get("ctrlProp","\u63a7\u4ef6\u5c5e\u6027"));qb.append(lb.getJqUi());Ha=$("<div>");Ha.addClass("extreport-dataset-designer-param-border");Ha.css({"overflow-x":"hidden","overflow-y":"auto"});qb.append(Ha)}return qb};this.render=function(lb){var t=$(Ha).find(".extreport-dataset-designer-param-detail-area");
t&&$(t).detach();lb?(Sa.css("display","none"),(t=za.getRender(lb))?(Ha.append(t.getJqUi()),t.refreshUi(lb)):(lb=Na.createRender(lb.getCtrlType(),U,lb,Bb,pb),za.cacheRender(lb),Ha.append(lb.getJqUi()))):($a||(Sa.addClass("extreport-dataset-designer-param-detail-tip"),$a=$("<div>"),$a.text(va.get("selParam","\u8bf7\u9009\u62e9\u53c2\u6570\u8fdb\u884c\u8bbe\u7f6e")),$a.addClass("extreport-dataset-designer-param-detail-text"),fb=$("<div>"),fb.addClass("extreport-dataset-designer-param-detail-background"),
x.background(fb,"ctrl_prop"),Sa.append(fb),Sa.append($a)),Sa.appendTo(Ha),Sa.css("display","block"))};this.updateUi=function(lb){lb&&lb.check();ob.render(lb)};this.setFuncRefreshTable=function(lb){Bb=lb};this.setFuncShowErrorIcon=function(lb){pb=lb}}function xa(U,ob){ya.call(this);var qb=this,$a,Sa,fb,Ha=[],Bb={},pb,lb={},t=[],hb,Ya,Jb,rb;this.protectInit=function(){$a||vb();return $a};this.getResult=function(){return Object.values(Bb)};this.repaint=function(bb){dc(bb)};this.refreshUi=function(){hb&&
hb.resize(!0)};this.getPagination=function(){return Sa.getPagination()};var vb=function(){Jb=Db();Ya=ac();var bb;hb=new Xa;hb.setHorizontalSplit(!1);hb.setFirstSize(261,-1,-1);hb.setSecondSize(155,80,350);hb.setResizeMode(Xa.RESIZE_MODE_FIRST_FIXED);hb.setFirstChild(Xa.createChildWrapper(Jb,function(){clearTimeout(bb);bb=setTimeout(function(){Sa&&dc();fb&&Eb(Ha)},10)}));hb.setSecondChild(Xa.createChildWrapper(Ya));$a=hb.getJqUi();rb&&rb.unobserve();rb=new Qa;rb.setDelay(50);rb.setCallback(function(){Sa&&
dc();fb&&Eb(Ha)});rb.observe()},Db=function(){Sa=new pa;var bb=["",va.get("dataSetName","\u6570\u636e\u96c6\u540d\u79f0"),va.get("type","\u7c7b\u578b")];Sa.createHead(bb,[10,100,100]);bb=Sa.getJqUi();Sa.addSingleClickListener(fc);Sa.setFuncCreateTableCell(Sb);Sa.setPageChangeListener(qb.loadDataSetByGroupId);return bb},Kb=function(bb){if(lb[bb])Eb(lb[bb]);else{var Yb=U.createParamCtrlFacade(function(Ib){var Rb=new Da;Rb.fromJsonObject(Ib);Ib=Rb.getParameters();lb[bb]=Ib;Eb(Ib)},function(Ib,Rb){});
Yb.setBlockingJqUi(Ya);Yb.loadParameterByDataSetId(bb)}};this.loadDataSetByGroupId=function(bb,Yb,Ib){var Rb=qb.getPagination();Ib||(bb=1,Yb=Rb.getPageSize());var wa=U.createParamCtrlFacade(function(tb){var Vb=[];if(tb){var Zb=tb.arrDataSetVO;tb=tb.totalRow;for(var cc=!1,hc=0;hc<Zb.length;hc++){var gc=new ma;gc.fromJsonObject(Zb[hc]);Sa.getSelectedId()===gc.getFid()&&(cc=!0);Vb.push(gc)}Ib?Ib(tb):Rb.resetPaginationAndJumpToFirstPage(tb);cc||Sa.setSelectedId(Vb[0].getFid())}else Rb.resetPaginationAndJumpToFirstPage(0),
Bb={},Eb([]);qb.repaint(Vb)},function(tb,Vb){}),Qb=ob.getCurrentGroupId(),nb=ob.getSearchDataSetName(),$b=ob.getDataSetType();$b===com.kingdee.bos.extreport.datasetdesigner.ctrl.DATA_SET_ALLTYPE&&($b=null);wa.setBlockingJqUi(Jb);wa.loadDataSetByGroupId(bb,Yb,Qb,nb,$b)};var fc=function(bb){pb&&pb===bb.getFid()||(Bb={},pb=bb.getFid(),Kb(bb.getFid()))},Sb=function(bb,Yb,Ib,Rb,wa){bb=$("<div>");bb.addClass("import-param-ctrl-table-dataset-cell-text");1==Ib?ob.getSearchDataSetName()?Q.highlightKeyWords(bb,
ob.getSearchDataSetName(),Rb.getName()):(Ib=Rb.getName(),bb.text(Ib),bb.attr("title",Ib)):2==Ib&&(Ib=Rb.getType(),Ib=ca.datesetTypeToName(Ib),bb.text(Ib),bb.attr("title",Ib));$(wa).append(bb)},ac=function(){fb=ba.createTable();fb.setColumnFitVisibleWidth(!0);fb.setSyncUIWhenModelChanged(!0);fb.setDraggableAdjusting(!0,3,0,new Ga);var bb=new bc(fb);bb.setOutsideVisible(!1);fb.setCellRender(bb);Fb();return $(fb.getUI())},Fb=function(){fb.setSyncUIWhenModelChanged(!1);fb.addColumns(5);fb.getColumn(0).setWidth(20);
fb.getColumn(1).setWidth(100);fb.getColumn(2).setWidth(100);fb.getColumn(3).setWidth(100);fb.getColumn(4).setWidth(100);var bb=ba.createHeadRow(fb);bb.getCell(1).setValue(va.get("paramName","\u53c2\u6570\u540d\u79f0"));bb.getCell(2).setValue(va.get("paramAlias","\u53c2\u6570\u522b\u540d"));bb.getCell(3).setValue(va.get("dataType","\u6570\u636e\u7c7b\u578b"));bb.getCell(4).setValue(va.get("ctrlType","\u63a7\u4ef6\u7c7b\u578b"));fb.setSyncUIWhenModelChanged(!0)},Eb=function(bb){Ha=bb;if(0!==document.body.clientHeight||
0!==document.body.clientWidth){ba.clear(fb);Fb();fb.setSyncUIWhenModelChanged(!1);for(var Yb=0;bb&&Yb<bb.length;Yb++){var Ib=bb[Yb],Rb=ba.createRow(fb);Rb.setHeight(30);Rb.setUserObject(Ib)}fb.setSyncUIWhenModelChanged(!0);ba.refresh(fb)}},dc=function(bb){bb&&(t=bb);0!==document.body.clientHeight&&0!==document.body.clientWidth&&Sa.updateTable(t)},bc=function(bb){KTDefaultCellRender.call(this,bb);var Yb=this,Ib=this.paintCellUI,Rb;this.paintCellUI=function(wa,Qb){var nb=Yb.getCurrentRowIdx(),$b=Yb.getCurrentRow(),
tb=Yb.getCurrentColIdx(),Vb=$b.getUserObject();nb<ba.getHeadRowCount()?(Ib(wa,Qb),0==tb&&1==nb&&(Qb=Ha&&Object.keys(Bb).length===Ha.length&&0<Ha.length,Rb=new jb,Rb.setChecked(Qb),Rb.addCheckedListener(function(Zb,cc){if(cc){if(Zb.isChecked())for(Zb=0;Zb<Ha.length;Zb++)cc=Ha[Zb],Bb[cc.getName()]=cc;else Bb=[];Eb(Ha)}}),Qb=Rb.getJqUi(),Qb.addClass("extreport-dataset-designer-import-param-check-box"),Qb.css("top","0px"),$(wa).append(Qb))):0==tb?(tb=new jb,tb.setUserObject(Vb),Qb=!!Bb[Vb.getName()],
nb=Rb&&Rb.isChecked(),tb.setChecked(Qb||nb),tb.addCheckedListener(function(Zb,cc){cc&&(Zb.isChecked()?(Bb[Vb.getName()]=Vb,Object.keys(Bb).length===Ha.length&&0<Ha.length&&Rb.setChecked(!0)):(delete Bb[Vb.getName()],Rb.setChecked(!1)))}),Qb=tb.getJqUi(),Qb.addClass("extreport-dataset-designer-import-param-check-box"),$(wa).append(Qb)):(Qb=$("<div>"),nb="",Qb.addClass("import-param-ctrl-table-cell-text"),1==tb?nb=Vb.getName():2==tb?nb=Vb.getAlias():3==tb?(tb=Vb.getDataType(),nb=gb.dataTypeToIconName(tb),
$b=$("<div>"),sb.background($b,nb),$b.addClass("extreport-dataset-designer-param-ctrl-table-type-icon"),$b.css("top","7px"),$(wa).append($b),nb=gb.dataTypeToName(tb),Qb.css("left","25px")):4==tb&&(tb=Vb.getCtrlType(),nb=Za.ctrlTypeToName(tb)),Qb.text(nb),Qb.attr("title",nb),$(wa).append(Qb))}}}function Pa(U){this.getJqUi=function(){var ob=$("<span>");ob.addClass("extreport-dataset-designer-param-title");ob.addClass("extreport-dataset-designer-param-title-text");ob.text(U);return ob}}"undefined"==
typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.extreport&&(com.kingdee.bos.extreport={});"undefined"==typeof com.kingdee.bos.extreport.datasetdesigner&&(com.kingdee.bos.extreport.datasetdesigner={});com.kingdee.bos.extreport.datasetdesigner.TabParamCtrlPane=function(U){Mb.call(this,va.get("param","\u53c2\u6570"),U);var ob=this,qb,$a,Sa;this.protectedInit=function(pb){var lb=$("<div>");
lb.addClass("extreport-dataset-designer-tab-panel");lb.addClass("extreport-dataset-designer-param-tab-index");Bb();lb.append(fb($a,Sa));lb.appendTo(pb)};var fb=function(pb,lb){if(!qb){qb=new Xa;qb.setHorizontalSplit(!0);qb.setFirstSize(1390,-1,-1);qb.setSecondSize(450,400,550);qb.setResizeMode(Xa.RESIZE_MODE_FIRST_FIXED);var t=null;qb.setFirstChild(Xa.createChildWrapper(pb.getJqUi(),function(){clearTimeout(t);t=setTimeout(function(){Ha()},0)}));qb.setSecondChild(Xa.createChildWrapper(lb.getJqUi()))}return qb.getJqUi()};
this.resize=function(){qb&&qb.resize(!0)};var Ha=function(){$a&&$a.updateTable();Sa&&Sa.updateUi($a.getCurrentParam())};this.fireTabChangeEvent=function(){ob.resize();$a.checkAllParam()};this.protectedUpdateUi=function(pb,lb){Bb();za.clearRender();if(pb.getDataSetModel()){lb=pb.getDataSetModel().getParameters();for(var t=0;t<lb.length;t++)lb[t].check()}$a.setDataSetModel(pb.getDataSetModel());U.isCurrentTab(this)&&Ha()};var Bb=function(){$a||($a=new D(U),Sa=new ua(U),$a.setParamDetailArea(Sa),Sa.setFuncRefreshTable($a.updateTable),
Sa.setFuncShowErrorIcon($a.funcShowErrorIcon))}};var va,Qa,Mb,Pb,Nb,Xa,Aa,zb,ib,jb,kb,xb,Gb,wb,Oa,Ra,R,F,ba,Ea,Da,gb,Za,ca,mb,Ta,Va,Ca,oa,za,Na,L,X,O,Fa,B,x,Q,pa,ya,sa,ma,ab,Ga,sb;(function(){var U=com.kingdee.bos.qing.framework.common;va=U.MultilanguageManager.createPackageAccessor(com.kingdee.bos.extreport.datasetdesigner);Qa=U.WindowResizeObserver;U=com.kingdee.bos.extreport.datasetdesigner.common.ui;Mb=U.AbstractDataSetTabPane;Pb=U.TableCustomExpandor;U=com.kingdee.bos.qing.ui.component;Nb=U.AbstractModalDialog;
Xa=U.SplitPane;Aa=U.Menu;zb=U.MenuModel;ib=U.MenuItemModel;jb=U.CheckBox;kb=U.ComboBox;Gb=U.HelpIcon;xb=U.SwitchButton;wb=U.TextField;Oa=U.MessageDialog;U=com.kingdee.bos.qing.common;Ra=U.DomUtil;R=U.TextMeasurer;F=U.CanvasUtil;U=com.kingdee.bos.qing.common.ui;ba=U.TableUtil;U=com.kingdee.bos.extreport.datasetdesigner.common;Ea=U.EventType;U=com.kingdee.bos.extreport.datasetdesigner.model;Da=U.ParameterModelVO;gb=U.ParamDataType;Za=U.ParamCtrlType;ca=U.DataSetType;mb=U.CtrlFactory;Ta=U.ParamBindSourceType;
Va=U.ParameterFactory;Ca=U.DataSetModelCheckType;oa=U.ParamNameChecker;L=U.LinkageRemover;X=U.ParamListUtils;O=U.ParamCtrlState;Fa=U.ParamDefaultValueType;B=U.DataSetModelCheckCode;U=com.kingdee.bos.extreport.datasetdesigner;x=U.Icons;U=com.kingdee.bos.extreport.datasetdesigner.common.ui;Q=U.SearchHelper;U=com.kingdee.bos.extreport.datasetdesigner.ctrl;pa=U.OptionalTable;ya=U.DialogMainTable;sa=U.ErrorIconFactory;ma=U.DataSetModel;za=U.CtrlRenderCache;Na=U.CtrlRenderFactory;ab=U.DataSetSelectorDialog;
Ga=U.ParamTableCustomExpandor;sb=com.kingdee.bos.extreport.datasetdesigner.Icons})()})();
//qingVersionTag: 20250324