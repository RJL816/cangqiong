(function(){"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.resourcestatistics&&(com.kingdee.bos.qing.resourcestatistics={});"undefined"==typeof com.kingdee.bos.qing.resourcestatistics.theme&&(com.kingdee.bos.qing.resourcestatistics.theme={});var K=com.kingdee.bos.qing.resourcestatistics.theme;K.RemoteImpl=
function(){O.call(this);var f;this.getRemoteUrl=function(){return f};this.setRemoteUrl=function(E){f=E}};K.Facade=function(f,E,w,m){P.call(this,f,E,w,m);var H=this.protectedMethod;this.queryResourceStatistics=function(d,u,y,x,z){d={userIds:JSON.stringify(d),targetPage:JSON.stringify(u),pageSize:JSON.stringify(y),field:JSON.stringify(x),order:JSON.stringify(z)};I(d);H.remote("queryResourceStatistics",d)};this.querySubOrDSB=function(d,u,y,x,z,F,Q){d={userId:d,type:u,targetPage:y,pageSize:x,total:z,
field:F,order:Q};I(d);H.remote("querySubOrDSB",d)};this.queryPublishDetail=function(d,u,y,x,z,F){d={userId:d,targetPage:u,pageSize:y,total:x,field:z,order:F};I(d);H.remote("queryPublishDetail",d)};this.queryPushDetail=function(d,u,y,x,z,F){d={userId:d,targetPage:u,pageSize:y,total:x,field:z,order:F};I(d);H.remote("queryPushDetail",d)};this.queryTotalModelDetail=function(d,u,y,x,z,F){d={userId:d,targetPage:u,pageSize:y,total:x,field:z,order:F};I(d);H.remote("queryTotalModelDetail",d)};this.exportExcel=
function(d,u,y,x,z){d={userIds:JSON.stringify(d),tableHead:JSON.stringify(u),headKeyMap:JSON.stringify(y),field:JSON.stringify(x),order:JSON.stringify(z)};I(d);H.remote("exportExcel",d)};this.exportDialogExcel=function(d,u,y,x,z,F){d={userId:d,total:u,type:y,field:x,order:z,tableHead:JSON.stringify(F)};I(d);H.remote("exportDialogExcel",d)};var I=function(d){var u=K.StatisticsAppendParams.getFunAppendMoreParams();u&&u(d)}};var R,O,P;(function(){var f=com.kingdee.bos.qing.framework.common;R=f.AbstractIcons;
O=f.AbstractRemoteCall;P=f.AbstractFacade})();K.Icons=new function(){R.call(this);var f=this.protectedMethod;this.protectedInit=function(E,w){E=com.kingdee.bos.qing.resourcestatistics.ComboIcon;if(!E)throw Error("com.kingdee.bos.qing.resourcestatistics.ComboIcon not found.");E.define(w,"tips-background");w.setStartPosition(0,0);w.setGap(0);w.setIconSize(264,191);f.registIcon(0,0,"tips-background");E.define(w,"nodata");w.setStartPosition(0,0);w.setGap(0);w.setIconSize(220,220);f.registIcon(0,0,"nodata")}};
K.StatisticsAppendParams=new function(){var f;this.addFunAppendMoreParams=function(E){f=E};this.getFunAppendMoreParams=function(){return f}}})();(function(){function K(){S.call(this);var a=this,p=this.protectedMethod,n,k,t;(new T).setFormatString("yyyy-MM-dd HH:mm:ss");a.setSize(1E3,570);var G=[m.get("dataContextName","\u6570\u636e\u5185\u5bb9\u540d\u79f0"),m.get("type","\u7c7b\u578b"),m.get("path","\u8def\u5f84"),m.get("createTime","\u521b\u5efa\u65f6\u95f4"),m.get("owner","\u62e5\u6709\u8005")];var v=["dataContextName","type","path","FCREATETIME","owner"];a.setHeadCellValueAndSize(v,G,[120,50,120,80,80],3);a.setUnSortIndex([0,1,2,4]);this.setParams=
function(e,b,l){n=l;k=b;t=e};this.cellShow=function(e,b,l,A,D){e=$(e);b=$("<div>");l=null;b.addClass("resource-statistics-dialog-content-center");b.addClass("resource-statistics-data-table-cell-left");0==A?l=D.getName():1==A?k==f.DIALOG_TYPE.subject?l=m.get("subject","\u4e1a\u52a1\u4e3b\u9898"):k==f.DIALOG_TYPE.dsb?l=m.get("dsb","\u4eea\u8868\u677f"):k==f.DIALOG_TYPE.publish?l=m.get("publish","\u53d1\u5e03\u8bb0\u5f55"):k==f.DIALOG_TYPE.pushConfig?l=m.get("pushConfig","\u63a8\u9001\u914d\u7f6e"):
k==f.DIALOG_TYPE.allType&&(l=m.get(D.getType(),"")):2==A?l=D.getPathName():3==A?l=D.getCreateTimeFormat():4==A&&(l=D.getUserName());b.text(l);b.attr("title",l);e.append(b)};this.queryDataTemplate=function(e,b,l,A,D){var B=f.StatisticsIntegration.getRemoteImpl();B=new w(B,function(L){var M=[];null==D?a.getPaginationBar().resetPaginationAndJumpToFirstPage(n):D(n);for(var h in L){var c=new P;c.fromJsonObject(L[h]);M.push(c)}a.updateTable(M)},function(L){p.getMessageCurtain().showPrompt(L)});B.setShowBlocking(!0);
k==f.DIALOG_TYPE.subject||k==f.DIALOG_TYPE.dsb?B.querySubOrDSB(t,k,l,A,n,e,b):k==f.DIALOG_TYPE.publish?B.queryPublishDetail(t,l,A,n,e,b):k==f.DIALOG_TYPE.pushConfig?B.queryPushDetail(t,l,A,n,e,b):k==f.DIALOG_TYPE.allType&&B.queryTotalModelDetail(t,l,A,n,e,b)};this.doExportExcel=function(e,b,l,A){for(var D={},B=0;B<v.length;B++)D[G[B]]=v[B];B=f.StatisticsIntegration.getRemoteImpl();(new w(B,l,A)).exportDialogExcel(t,n,k,e,b,D)};this.getTotalRow=function(){return n}}function R(){F.call(this);this.protectedMethod.setTotalSelectedRowAndSelectedAllVisual(!1,
!1)}function O(){var a=this,p,n,k,t,G,v,e;this.getUserId=function(){return p};this.setUserId=function(b){p=b};this.getUserAndName=function(){return n};this.setUserAndName=function(b){n=b};this.getSubjectNum=function(){return k};this.setSubjectNum=function(b){k=b};this.getDsbNum=function(){return t};this.setDsbNum=function(b){t=b};this.getPublishNum=function(){return G};this.setPublishNum=function(b){G=b};this.getPushConfigNum=function(){return v};this.setPushConfigNum=function(b){v=b};this.getTotalNum=
function(){return e};this.setTotalNum=function(b){e=b};this.fromJsonObject=function(b){b&&(a.setUserId(b.userId),a.setUserAndName(b.userAndName),a.setSubjectNum(b.subjectNum),a.setDsbNum(b.dsbNum),a.setPublishNum(b.publishNum),a.setPushConfigNum(b.pushConfigNum),a.setTotalNum(b.total))};this.toJsonObject=function(){var b={};b.userId=p;b.userAndName=n;b.subjectNum=k;b.dsbNum=t;b.publishNum=G;b.pushConfigNum=v;b.total=e;return b}}function P(){var a=this,p,n,k,t,G,v;this.getUserName=function(){return p};
this.getPathName=function(){return n};this.getCreateTime=function(){return k};this.getCreateTimeFormat=function(){return t};this.getType=function(){return G};this.getName=function(){return v};this.setUserName=function(e){p=e};this.setPathName=function(e){n=e};this.setCreateTime=function(e){k=e};this.setCreateTimeFormat=function(e){t=e};this.setType=function(e){G=e};this.setName=function(e){v=e};this.fromJsonObject=function(e){e&&(a.setUserName(e.userName),a.setPathName(e.pathName),a.setCreateTime(e.createTime),
a.setCreateTimeFormat(e.createTimeFormat),a.setType(e.type),a.setName(e.name))}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.resourcestatistics&&(com.kingdee.bos.qing.resourcestatistics={});"undefined"==typeof com.kingdee.bos.qing.resourcestatistics.theme&&(com.kingdee.bos.qing.resourcestatistics.theme=
{});var f=com.kingdee.bos.qing.resourcestatistics.theme;f.StatisticsCenter=function(){Q.call(this);var a=this,p=this.protectedMethod,n,k,t,G,v=new R;var e=[m.get("sourceCreator","\u62e5\u6709\u8005"),m.get("subject","\u4e1a\u52a1\u4e3b\u9898"),m.get("dsb","\u4eea\u8868\u677f"),m.get("publish","\u53d1\u5e03\u8bb0\u5f55"),m.get("pushConfig","\u63a8\u9001\u914d\u7f6e"),m.get("totalNum","\u603b\u8ba1")];var b="userAndName subjectNum dsbNum publishNum pushConfigNum total".split(" ");a.setHeadCellValueAndSize(e,
b,[100,80,80,80,80,80],1);a.setUnSortIndex([0]);this.cellShow=function(h,c,g,q,r){h=$(h);c=$("<div>");g=null;0==q?(c.addClass("resource-statistics-data-table-cell"),g=r.getUserAndName(),c.text(g)):(c.addClass("resource-statistics-data-table-cell-num"),1==q?(g=r.getSubjectNum(),l(c,g,r,q,f.DIALOG_TYPE.subject)):2==q?(g=r.getDsbNum(),l(c,g,r,q,f.DIALOG_TYPE.dsb)):3==q?(g=r.getPublishNum(),l(c,g,r,q,f.DIALOG_TYPE.publish)):4==q?(g=r.getPushConfigNum(),l(c,g,r,q,f.DIALOG_TYPE.pushConfig)):5==q&&(g=r.getTotalNum(),
l(c,g,r,q,f.DIALOG_TYPE.allType)));c.attr("title",g);h.append(c)};var l=function(h,c,g,q,r){var C=$("<span>");0!=q&&"0"!=c&&(C.addClass("resource-click-open-panel"),C.on("click",function(){var J=new K;J.setTitle(m.get("createDetail","\u521b\u5efa\u5185\u5bb9\u660e\u7ec6")+"-"+g.getUserAndName());J.setParams(g.getUserId(),r,c);J.showDialog()}));C.text(c);C.appendTo(h)};this.buildPagination=function(){v.setJumpToPageListener(function(h,c,g){var q=a.getArrUserIds(),r=f.StatisticsIntegration.getRemoteImpl();
r=new w(r,function(C){A(C,g)},function(C){return"1200001"==C?(D().showPrompt(m.get("noMenuPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002")),!0):!1});r.setShowBlocking(!0);r.queryResourceStatistics(q,h,c,p.getOrderFiled(),p.getOrder())});v.setComboBoxItemModelsAndSelectedItem([5,10,20,50,100,500,1E3],2);p.getPaginationLabel().append(v.getJqUi())};var A=function(h,c){c?c(h.totalRow):v.refreshPagination();c=h.statisticsVo;
G=h.totalRow;L(c)};this.funExportExcelListener=function(){var h=d.createFeedbackDialog();h.setOptionType(d.OPTION_OK_CANCEL);h.setMessage(m.get("confirmToExport","\u5f53\u524d\u64cd\u4f5c\u5c06\u5bfc\u51fa#1\u6761\u8bb0\u5f55\uff0c\u662f\u5426\u786e\u5b9a\u5bfc\u51fa\uff1f").replace("#1",G));h.setClosingChecker(function(c){c==d.RETURN_OK&&B();return!0});h.showDialog()};var D=function(){k||(k=new I,k.getJqUi().appendTo($(document.body)));return k},B=function(){var h=(new Date).getTime(),c="Qing-"+
y.formatDate("yyyyMMdd_HHmmss")+".xlsx",g=a.getArrUserIds(),q=f.StatisticsIntegration.getRemoteImpl();q=new w(q,function(J){z.downloadFile(c,J);x.interestInBehavior(x.EXPORT_TYPE,"EXCEL",(new Date).getTime()-h)},function(J){return!1});q.setShowBlocking(!0);q.setBlockingPrompt(m.get("loading","\u6b63\u5728\u5bfc\u51fa..."));for(var r={},C=0;C<e.length;C++)r[e[C]]=b[C];q.exportExcel(g,e,r,p.getOrderFiled(),p.getOrder)};this.funLoadDataListener=function(){var h=a.getArrUserIds(),c=f.StatisticsIntegration.getRemoteImpl();
c=new w(c,function(g){A(g,v.resetPaginationAndJumpToFirstPage)},function(g){return"1200001"==g?(D().showPrompt(m.get("noMenuPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002")),!0):!1});c.setShowBlocking(!0);c.queryResourceStatistics(h,1,v.getPageSize(),p.getOrderFiled(),p.getOrder())};this.funFreshListener=function(){var h=a.getArrUserIds(),c=f.StatisticsIntegration.getRemoteImpl();c=new w(c,function(g){A(g)},function(g){return"1200001"==
g?(D().showPrompt(m.get("noMenuPermission","\u60a8\u7684\u83dc\u5355\u6743\u9650\u5df2\u53d1\u751f\u53d8\u66f4\uff0c\u65e0\u6cd5\u7ee7\u7eed\u64cd\u4f5c\u3002")),!0):!1});c.setShowBlocking(!0);c.queryResourceStatistics(h,v.getCurrentPage(),v.getPageSize(),p.getOrderFiled(),p.getOrder())};var L=function(h){t=[];for(var c=0;c<h.length;c++){var g=new O;g.fromJsonObject(h[c]);t.push(g)}0==document.body.clientHeight||0==document.body.clientWidth?(n=new H,n.setDelay(250),n.setCallback(function(){M()}),
n.observe()):M()};this.relayoutTable=function(){t&&0<t.length&&M()};var M=function(){n&&n.unobserve();var h=p.getTable();u.clear(h);a.createTableHead();if(t&&0<t.length){a.noDataPage(!1);for(var c=0,g=0,q=0,r=0,C=0,J=0;J<t.length;J++){var N=t[J],U=u.createRow(h);U.setHeight(30);U.setUserObject(N);c+=N.getSubjectNum();g+=N.getDsbNum();q+=N.getPublishNum();r+=N.getPushConfigNum();C+=N.getTotalNum()}u.refresh(h);c=[m.get("total","\u5408\u8ba1"),c,g,q,r,C];p.getJqBottom().setArrTotalText(c);p.getJqBottom().updateTotalColumn(h)}else a.noDataPage(!0)}};
var E,w,m,H,I,d,u,y,x,z,F,Q,S,T;(function(){var a=com.kingdee.bos.qing.resourcestatistics.theme;E=a.RemoteImpl;w=a.Facade;a=com.kingdee.bos.qing.resourcestatistics;Q=a.AbstractResourceStatisticsPanel;S=a.AbstractResourceStatisticsDialog;a=com.kingdee.bos.qing.common;y=a.Util;T=a.DateFormater;a=com.kingdee.bos.qing.framework.common;m=a.MultilanguageManager.createPackageAccessor(f);H=a.WindowResizeObserver;z=a.RemoteFramework;a=com.kingdee.bos.qing.ui.component;I=a.MessageCurtain;d=a.MessageDialog;
a=com.kingdee.bos.qing.common.ui;u=a.TableUtil;a=com.kingdee.bos.qing.behavior;x=a.BehaviorManager;a=com.kingdee.bos.qing.biz.common;F=a.ComplexPaginationBar})();f.StatisticsIntegration=new function(){var a,p=new E,n=new E;this.getParamPathPrefix=function(){return a};this.setParamPathPrefix=function(k){a=k};this.getRemoteImpl=function(){return p};this.setRemoteUrl=function(k){p.setRemoteUrl(k)};this.getPublishRemoteImpl=function(){return n};this.setPublishRemoteImplUrl=function(k){n.setRemoteUrl(k)}};
f.DIALOG_TYPE={subject:"subject",dsb:"dsb",publish:"publish",pushConfig:"pushConfig",allType:"allType"}})();
//qingVersionTag: 20250324