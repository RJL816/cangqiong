var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(f,m,b){f instanceof String&&(f=String(f));for(var n=f.length,g=0;g<n;g++){var h=f[g];if(m.call(b,h,g,f))return{i:g,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,m,b){if(f==Array.prototype||f==Object.prototype)return f;f[m]=b.value;return f};$jscomp.getGlobal=function(f){f=["object"==typeof globalThis&&globalThis,f,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var m=0;m<f.length;++m){var b=f[m];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(f,m){var b=$jscomp.propertyToPolyfillSymbol[m];if(null==b)return f[m];b=f[b];return void 0!==b?b:f[m]};
$jscomp.polyfill=function(f,m,b,n){m&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(f,m,b,n):$jscomp.polyfillUnisolated(f,m,b,n))};$jscomp.polyfillUnisolated=function(f,m,b,n){b=$jscomp.global;f=f.split(".");for(n=0;n<f.length-1;n++){var g=f[n];if(!(g in b))return;b=b[g]}f=f[f.length-1];n=b[f];m=m(n);m!=n&&null!=m&&$jscomp.defineProperty(b,f,{configurable:!0,writable:!0,value:m})};
$jscomp.polyfillIsolated=function(f,m,b,n){var g=f.split(".");f=1===g.length;n=g[0];n=!f&&n in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<g.length-1;h++){var k=g[h];if(!(k in n))return;n=n[k]}g=g[g.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?n[g]:null;m=m(b);null!=m&&(f?$jscomp.defineProperty($jscomp.polyfills,g,{configurable:!0,writable:!0,value:m}):m!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[g]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[g]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(g):$jscomp.POLYFILL_PREFIX+b+"$"+g),$jscomp.defineProperty(n,$jscomp.propertyToPolyfillSymbol[g],{configurable:!0,writable:!0,value:m})))};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(m,b){return $jscomp.findInternal(this,m,b).v}},"es6","es3");
(function(){function f(){var g=0;this.setRefTimeInTotal=function(h){g=h};this.getRefTimeInTotal=function(){return g};this.fromJsonObject=function(h){(h=h.refTimeInTotal)&&!isNaN(h)&&(g=parseInt(h))};this.copy=function(){var h=new f;h.setRefTimeInTotal(g);return h}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.macro&&
(com.kingdee.bos.qing.macro={});"undefined"==typeof com.kingdee.bos.qing.macro.model&&(com.kingdee.bos.qing.macro.model={});var m=com.kingdee.bos.qing.macro.model;m.Macro=function(g){var h,k,K,Q,S,d=g,e,p,D,c,v,H,M,F,q,x;this.getMacroStatus=function(){return e};this.setMacroStatus=function(a){e=a};this.getUid=function(){return h};this.setUid=function(a){h=a};this.getFid=function(){return k};this.setFid=function(a){k=a};this.getName=function(){return K};this.setName=function(a){K=a};this.getCreatorId=
function(){return p};this.setCreatorId=function(a){p=a};this.getCreatorName=function(){return D};this.setCreatorName=function(a){D=a};this.getCreateTime=function(){return c};this.setCreateTime=function(a){c=a};this.setModifierId=function(a){v=a};this.getModifierId=function(){return v};this.setModifierName=function(a){H=a};this.getModifierName=function(){return H};this.setModifyTime=function(a){M=a};this.getModifyTime=function(){return M};this.getDesc=function(){return Q};this.setDesc=function(a){Q=
a};this.isMultiValued=function(){return S};this.setMultiValued=function(a){S=a};this.getType=function(){return d};this.setType=function(a){d=a};this.getReference=function(){return x};this.setReference=function(a){x=a};this.getRefTimeInTotal=function(){return x?x.getRefTimeInTotal():0};this.getRefTimeByOthers=function(){return x?x.getRefTimeByOthers():0};this.isUsable=function(){return e==b.AVAILABLE||e==b.PROPERTY_ABNORMAL};this.getCreateFormatTime=function(){return F};this.getModifyFormatTime=function(){return q};
this.toJsonObject=function(){var a={};a.uid=h;a.fid=k;a.name=K;a.creatorId=p;a.modifierId=v;a.desc=Q;a.multiValued=S;a.type=d;a.macroStatus=e;a.creatorName=D;a.modifierName=H;a.createTime=c&&c.getTime();a.modifyTime=M&&M.getTime();return a};this.fromJsonObject=function(a){h=a.uid;k=a.fid;K=a.name;Q=a.desc;S=a.multiValued;p=a.creatorId;v=a.modifierId;D=a.creatorName;d=a.type;e=a.macroStatus;c=new Date(a.createTime);M=new Date(a.modifyTime);F=a.createFormatTime;q=a.modifyFormatTime;H=a.modifierName;
if(a=a.reference)x=new f,x.fromJsonObject(a)};this.validateModel=function(){var a=RegExp("^[\\da-z_]+$","g");if(h){if(50<h.length)return n.get("uidTooLong","\u7f16\u7801\u4e0d\u53ef\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(0<h.indexOf(" "))return n.get("uidWithSpace","\u7f16\u7801\u4e0d\u80fd\u643a\u5e26\u7a7a\u683c\u3002");if(!a.test(h))return n.get("invalidUid","\u7f16\u7801\u5fc5\u987b\u7531\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\u3002")}else return n.get("emptyUid",
"\u8bf7\u8f93\u5165\u7f16\u7801\u3002");a=RegExp("^[\u4e00-\u9fa5A-Za-z0-9_]+$","g");if(K){if(50<K.length)return n.get("nameTooLong","\u540d\u79f0\u4e0d\u53ef\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002");if(0<K.indexOf(" "))return n.get("nameWithSpace","\u540d\u79f0\u4e0d\u80fd\u643a\u5e26\u7a7a\u683c\u3002");if(!a.test(K))return n.get("invalidName","\u540d\u79f0\u5fc5\u987b\u7531\u4e2d\u6587\u3001\u6570\u5b57\u6216\u5b57\u6bcd\u7ec4\u6210\u3002")}else return n.get("emptyName","\u8bf7\u8f93\u5165\u540d\u79f0\u3002");
return Q&&50<Q.length?n.get("descTooLong","\u63cf\u8ff0\u4e0d\u53ef\u8d85\u8fc750\u4e2a\u5b57\u7b26\u3002"):this.validateModelForType()};this.getTypeText=function(){throw Error("override me");};this.getContentText=function(){throw Error("override me");};this.getTipsText=function(){throw Error("override me");};this.getStatusWarning=function(){throw Error("override me");};this.validateModelForType=function(){throw Error("override me");}};m.PreviewData=function(){function g(){var d=[];this.getColumn=
function(e){return d[e]};this.fromJsonObject=function(e){if(e=e.columns)for(var p=0;p<e.length;p++){var D=new h;D.fromJsonObject(e[p]);d.push(D)}}}function h(){var d;this.getValue=function(){return d};this.fromJsonObject=function(e){d=e.value}}var k=0,K=[],Q=[],S=[];this.getNoPermFieldIndex=function(){return S};this.getFieldCount=function(){return K.length};this.getFieldTitle=function(d){return K[d]};this.getTotalRowCount=function(){return k};this.getActualRowCount=function(){return Q.length};this.getRow=
function(d){return Q[d]};this.fromJsonObject=function(d){var e=d.fields;e&&(K=e);(e=d.totalRowCount)&&(k=e);(e=d.noPermFieldIndex)&&(S=e);if(d=d.rows)for(e=0;e<d.length;e++){var p=new g;p.fromJsonObject(d[e]);Q.push(p)}}};m.Reference=f;var b={};m.MacroStatusEnum=b;m.MacroVarAdapter=function(g){var h=this,k;this.getId=function(){return g.getUid()};this.getDisplayName=function(){return g.getName()};this.getTextInUserSQL=function(){return k?k(h):h.getDisplayName()};this.getFilterMode=function(){return"MacroVar"};
this.getVariateType=function(){return"macro_var"};this.setUserSQLFormater=function(K){k=K};this.getRawModel=function(){return g};this.isUsable=function(){return g.isUsable()}};var n=com.kingdee.bos.qing.framework.common.MultilanguageManager.createPackageAccessor(com.kingdee.bos.qing.macro);b.AVAILABLE="AVAILABLE";b.NOT_EXIST="NOT_EXIST";b.DB_NOT_EXIST="DB_NOT_EXIST";b.ENTITY_NOT_EXIST="ENTITY_NOT_EXIST";b.WITHOUT_DB_PERMISSION="WITHOUT_DB_PERMISSION";b.WITHOUT_ENTITY_PERMISSION="WITHOUT_ENTITY_PERMISSION";
b.WITHOUT_DB_CENTER_PERMISSION="WITHOUT_DB_CENTER_PERMISSION";b.WITHOUT_SCHEMA_PERMISSION="WITHOUT_SCHEMA_PERMISSION";b.PROPERTY_ABNORMAL="PROPERTY_ABNORMAL";b.DB_CENTER_NO_APP_METADATA="DB_CENTER_NO_APP_METADATA";b.DB_CENTER_APP_CLOUD_DISABLED="DB_CENTER_APP_CLOUD_DISABLED";b.DB_CENTER_APP_DISABLED="DB_CENTER_APP_DISABLED";b.DB_CENTER_NO_APP="DB_CENTER_NO_APP"})();(function(){function f(d,e,p,D){n.call(this,d,e,p,D);var c=this.protectedMethod;this.loadAllMacros=function(){c.remote("loadAllMacros",{})};this.preview=function(v,H,M){v={model:JSON.stringify(v.toJsonObject()),macroType:H,bEditMacro:M};c.remote("preview",v)};this.loadMacroByDisplayNames=function(v){v={displayNames:JSON.stringify(v)};c.remote("loadMacroByDisplayNames",v)};this.loadMacroByUids=function(v){v={macroUids:JSON.stringify(v)};c.remote("loadMacroByUids",v)}}function m(){g.call(this);var d;
this.getRemoteUrl=function(){return d};this.setRemoteUrl=function(e){d=e}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.macro&&(com.kingdee.bos.qing.macro={});var b=com.kingdee.bos.qing.macro;b.MacroRuntimeFacade=f;b.RemoteImpl=m;b.DraggableAdjustingCustomExpandor=function(){KTableUIDraggableAdjustingHandler.CustomExpendor.call(this);
this.getTailBlankForDragging=function(){return 0}};var n,g,h,k,K;(function(){var d=com.kingdee.bos.qing.framework.common;n=d.AbstractFacade;g=d.AbstractRemoteCall;K=d.AbstractIcons;d=com.kingdee.bos.qing.macro.model;h=d.MacroVarAdapter;k=d.Macro})();b.MacroVarHelper=new function(){var d=this,e;this.createMacroAdapter=function(c){return c?(c=new h(c),c.setUserSQLFormater(d.getFormatText),c):null};this.setRemoteImpl=function(c){e=c};this.getFormatText=function(c){var v=c.getDisplayName();S.put(v,c.getId());
return p(v)};this.switchSQLToPersistentMode=function(c,v){var H=[],M=RegExp("\\'\\$(.+?)\\'","g");do{var F=M.exec(c);F&&H.push(F[1])}while(null!=F);M=[];F=0;for(var q=H.length;F<q;F++){var x=H[F],a=S.get(x);if(a)for(x=p(x),a=p(a);0<=c.indexOf(x)&&x!=a;)c=c.replace(x,a);else M.push(x)}0<M.length?(new f(D(),function(r){if(r)for(var w=0,N=r.length;w<N;w++){var G=new k;G.fromJsonObject(r[w]);var B=d.createMacroAdapter(G);G=p(B.getDisplayName());for(B=p(B.getId());0<=c.indexOf(G)&&G!=B;)c=c.replace(G,
B)}v(c)},function(r){v(c);return!0})).loadMacroByDisplayNames(M):v(c)};this.switchSQLToDisplayMode=function(c,v){var H=[],M=RegExp("\\'\\$(.+?)\\'","g");do{var F=M.exec(c);F&&H.push(F[1])}while(null!=F);(new f(D(),function(q){if(q)for(var x=0,a=q.length;x<a;x++){var r=new k;r.fromJsonObject(q[x]);var w=d.createMacroAdapter(r);r=w.getDisplayName();w=w.getId();for(var N=p(r),G=p(w);0<=c.indexOf(G)&&N!=G;)c=c.replace(G,N);S.put(r,w)}v(c)},function(q){v(c);return!0})).loadMacroByUids(H)};this.loadVarModelAdapter=
function(c,v){if(c){var H=Q.get(c);if(H)v(H);else{H=new f(D(),function(F){var q=new k;q.fromJsonObject(F[0]);F=d.createMacroAdapter(q);v(F);Q.put(c,F)},function(F){if(1200003==F)return v(null),!0});var M=[c];H.setShowBlocking(!1);H.loadMacroByUids(M)}}else v(c)};var p=function(c){return"'$%s'".replace("%s",c)},D=function(){if(!e){e=new m;var c=com.kingdee.bos.qing.common.Util.decodeParamFromUrl(window.location.search,"path");e.setRemoteUrl((c?c:"/ierp")+"/qing/macroManage.do")}return e}};var Q=new function(){var d=
{};this.put=function(e,p){d[e]=p};this.get=function(e){return d[e]};this.clear=function(){d={}}},S=new function(){var d={};this.put=function(e,p){d[e]=p};this.get=function(e){return d[e]}};b.Icons=new function(){K.call(this);var d=this.protectedMethod;this.protectedInit=function(p,D){p=com.kingdee.bos.qing.macro.ComboIcon;if(!p)throw Error("com.kingdee.bos.qing.macro.ComboIcon not found.");p.define(D,"nodata");d.registIcon(0,0,"nodata");p.define(D,"icon");e(0,0,"btn_create");e(0,1,"btn_edit");e(0,
2,"btn_preview");e(0,3,"btn_delete");e(0,4,"btn_refresh");e(0,5,"btn_import");e(0,6,"btn_export");p.define(D,"macro_error");d.registIcon(0,0,"macro_error")};var e=function(p,D,c){d.registIcon(p,D,c+"_hover");d.registIcon(p+1,D,c);d.registIcon(p+2,D,c+"_disabled")}}})();(function(){function f(q,x){e.call(this);var a=this,r=this.protectedMethod,w,N=!1,G;(function(){r.setTitle(k.get("preview","\u9884\u89c8"));a.setSize(700,500);r.setSelectable(!0);r.setContentPaneCreator(function(){if(w)var B=w.getJqUi();else w=new m(q),B=w.getJqUi(),(new H(q,function(T){var I=new v;I.fromJsonObject(T);w.setModel(I);G&&G(!0)},function(T,I){G&&G(!1);switch(T){case 1200004:var P=k.get("noConnectionPerm","\u60a8\u6ca1\u6709\u9009\u62e9\u7684\u201c\u6570\u636e\u5e93\u8fde\u63a5\u201d\u7684\u6743\u9650\u3002");
break;case 1200010:P=k.get("dbConnectionNotExist","\u60a8\u9009\u62e9\u7684\u201c\u6570\u636e\u5e93\u8fde\u63a5\u201d\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");break;case 1200013:P=k.get("noEntityPerm","\u60a8\u6ca1\u6709\u9009\u62e9\u7684\u57fa\u7840\u8d44\u6599\u7684\u6743\u9650\u3002");break;case 1200014:P=k.get("entityNotExits","\u5b8f\u53d8\u91cf\u4f7f\u7528\u7684\u57fa\u7840\u8d44\u6599\u4e0d\u5b58\u5728\u3002");break;case 1200015:P=k.get("macroMetadataNotExist","\u5b8f\u53d8\u91cf\u4f7f\u7528\u7684\u5e94\u7528\u7684\u5143\u6570\u636e\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002");
break;case 1200016:P=k.get("macroAppCloudDisabled","\u5b8f\u53d8\u91cf\u4f7f\u7528\u7684\u5e94\u7528\u7684\u6240\u5728\u4e91\u5df2\u88ab\u7981\u7528\u3002");break;case 1200017:P=k.get("macroAppDisabled","\u5b8f\u53d8\u91cf\u4f7f\u7528\u7684\u5e94\u7528\u5df2\u88ab\u7981\u7528\u3002");break;case 1200018:P=k.get("macroAppNotExist","\u5b8f\u53d8\u91cf\u4f7f\u7528\u7684\u5e94\u7528\u4e0d\u5b58\u5728\u6216\u5df2\u88ab\u5220\u9664\u3002")}P?w.showPreviewError(P):w.showPreviewError(k.get("macroCannotExe",
"\u8be5\u5b8f\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u5b8f\u4fe1\u606f\u662f\u5426\u6b63\u786e\u3002"),I);return!0})).preview(x,x.getType(),N);return B});r.setFooterClosingOnly(!0);r.setClosingChecker2(null,function(B){r.destroy();return!0});r.setClosingAction(function(B){})})();this.setEditMacro=function(B){N=B};this.setFunPreviewCallback=function(B){G=B}}function m(){function q(E){KTDefaultCellRender.call(this,E);var O=this,C=this.paintCellUI;this.paintCellUI=function(u,t){var z=
O.getCurrentRowIdx(),A=O.getCurrentRow(),L=O.getCurrentColIdx();A=A.getUserObject();var y=r.getNoPermFieldIndex();y=!y||-1==y.indexOf(L);O.getCurrentRowIdx()<h.getHeadRowCount()?y?0==L?($(u).css("background-color","#DFDFDF"),1==z&&(t=r.getFieldTitle(L),z=k.get("previewPkTips","\u8be5\u5b57\u6bb5\u4e3a\u5b8f\u7684\u53d6\u503c\u5b57\u6bb5\u3002"),W(z,u,t))):C(u,t):($(u).css("background-color","#DFDFDF"),1==z&&(t=r.getFieldTitle(L),z=k.get("noFieldPermTips","\u60a8\u6ca1\u6709\u6743\u9650\u67e5\u770b\u8be5\u5b57\u6bb5\u6570\u636e\u3002"),
W(z,u,t))):(t=A.getColumn(L).getValue(),y||(t="***"),z=$("<div>"),z.text(t),z.attr("title",t),z.css({"line-height":"28px","padding-left":"2px","padding-right":"2px",overflow:"hidden"}),z.appendTo(u))}}function x(E,O){var C=new p;C.setCustomPainter(function(u,t){var z=$("<div>");z.text(O);var A=$('<textarea readonly="true" ></textarea>');A.text(t);A.addClass("sa-ctrl-msgdlg-detail");A.on("click",function(){A.select()});A.addClass("extreport-dataset-designer-top-border");g.layoutCtrlWithLRTB(A,0,0,
268,35,0,160);z.appendTo(u);A.appendTo(u)});C.setOptionType(p.OPTION_OK);C.setButtonText(p.OPTION_OK,k.get("ok","\u786e\u5b9a"));C.setMessage(E);C.showDialog(300,300)}var a,r,w,N,G,B,T,I,P,R;this.setModel=function(E){if(r=E)B.hide(),T.hide();X()};this.showPreviewError=function(E,O){B.hide();T.show();I&&I.empty();I=$("<div>");var C=$("<div>");n.Icons.background(C,"macro_error");g.layoutCtrlWithLRTB(C,0,0,null,0,0,null);C.css({"background-position":"center"});T.append(C);P=$("<span>");P.text(E);P.appendTo(I);
if(O){var u=$("<span>");u.text(k.get("youCan","\u60a8\u53ef\u4ee5#1\u3002"));u.appendTo(I);u.html(function(){return u.html().replace("#1","<span id = 'view' style = 'cursor: pointer; color: var(--color-main, #5591f6)'> "+k.get("moreDetailBlank"," \u67e5\u770b\u8be6\u7ec6 ")+"</span>")});u.find("#view").on("click",function(){x(O,k.get("macroCannotExe","\u8be5\u5b8f\u65e0\u6cd5\u6b63\u5e38\u6267\u884c\uff0c\u8bf7\u68c0\u67e5\u5b8f\u4fe1\u606f\u662f\u5426\u6b63\u786e\u3002"))})}I.css({"line-height":"20px",
color:"#333","font-size":"14px","text-align":"center"});g.layoutCtrlWithLRTB(I,0,0,null,"68%",null,20);T.append(I)};this.setLoadingText=function(E){B.text(E)};this.getJqUi=function(){a||J();return a};var J=function(){a=$("<div>");Y();a.append(N);G=$("<div>");g.layoutCtrlWithLRTB(G,0,0,null,0,null,20);a.append(G);G.css({"line-height":"20px",color:"#333","font-size":"12px"});B=$("<div>");g.layoutCtrlWithLRTB(B,0,0,null,-5,null,35);a.append(B);B.css({"line-height":"35px",color:"#333","font-size":"14px"});
B.text(k.get("loading","\u52a0\u8f7d\u4e2d..."));r&&B.hide();T=$("<div>");a.append(T);T.hide();R&&R.unobserve();R=new K;R.setDelay(250);R.setCallback(function(){X()});R.observe()},Y=function(){w=h.createTable();w.setColumnFitVisibleWidth(!1);w.setDraggableAdjusting(!0,h.getHeadRowCount(),0,new F);var E=new q(w);E.setOutsideVisible(!0);w.setCellRender(E);w.setSyncUIWhenModelChanged(!0);N=$(w.getUI());g.layoutCtrlWithLRTB(N,0,0,null,20,0,null)},X=function(){w||Y();if(0!=document.body.clientHeight&&
0!=document.body.clientWidth){h.clear(w);if(r){var E=r.getActualRowCount();var O=r.getTotalRowCount();w.addColumns(r.getFieldCount());for(var C=h.createHeadRow(w),u=0;u<r.getFieldCount();u++)w.getColumn(u).setWidth(120),C.getCell(u).setValue(r.getFieldTitle(u));for(u=0;u<E;u++)C=r.getRow(u),h.createRow(w).setUserObject(C);u=k.get("previewRowNum","\u5171#1\u884c").replace("#1",O);E<O&&(u+=k.get("previewRowLimit","\uff0c\u4ec5\u663e\u793a\u524d#1\u884c").replace("#1",E));G.text(u)}h.refresh(w)}},W=
function(E,O,C){var u=$("<div>");u.attr("title",C);u.text(C);u.css({display:"inline-block","line-height":"20px",height:"20px"});C=new D;C.setIconType(D.ICON_TYPE_QUESTION);C.setTipsText(E);E=C.getJqUi();E.css({display:"inline-block",margin:"3px 0 0 3px"});u.appendTo(O);E.appendTo(O)}}function b(){function q(){function I(t){KTDefaultCellRender.call(this,t);var z=this,A=this.paintCellUI;this.paintCellUI=function(L,y){var U=z.getCurrentRowIdx(),l=z.getCurrentRow(),Z=z.getCurrentColIdx(),V=l.getUserObject();
l=V?V.isUsable():!1;U<h.getHeadRowCount()?A(L,y):0==Z?(y=U-h.getHeadRowCount(),U=new Q,U.addCheckedListener(u),l?(l=(l=W[y])&&l.isChecked(),(a&&a.getUid()==V.getUid()||l)&&U.setChecked(!0)):U.setEnabled(!1),W[y]=U,w.addElement(U),U.setUserObject(V),l=U.getJqUi(),g.layoutCtrl(l,12,4,23,23),l.appendTo(L)):1==Z?(y=$("<div>"),y.css({"padding-left":"2px","padding-right":"2px","line-height":"28px",overflow:"hidden"}),l||(l=$("<span class='macro-db-connection-warning'>"),l.text("!"),U=k.get("macroAbnormalTips",
"\u5f53\u524d\u5b8f\u5b58\u5728\u5f02\u5e38\uff0c\u65e0\u6cd5\u7ee7\u7eed\u4f7f\u7528\u3002"),l.attr("title",U),y.append(l)),l=$("<span>"),l.text(V.getUid()),l.attr("title",V.getUid()),y.append(l),y.appendTo(L)):2==Z?(l=$("<div>"),l.text(V.getName()),l.attr("title",V.getName()),l.css({"padding-left":"2px","padding-right":"2px","line-height":"28px",overflow:"hidden"}),l.appendTo(L)):3==Z?(l=$("<div>"),y=V.getDesc()?V.getDesc():k.get("noDesc","\u6682\u65e0\u63cf\u8ff0"),l.text(y),l.attr("title",y),
l.css({"padding-left":"2px","padding-right":"2px","line-height":"28px",overflow:"hidden"}),l.appendTo(L)):4==Z?(l=$("<div>"),y=V.isMultiValued()?k.get("multiValued","\u591a\u503c"):k.get("singleValued","\u5355\u503c"),l.text(y),l.attr("title",y),l.css({"padding-left":"2px","padding-right":"2px","line-height":"28px",overflow:"hidden"}),l.appendTo(L)):5==Z&&(y=new d(k.get("preview","\u9884\u89c8")),l||y.setEnabled(!1),l=y.getJqUi(),l.appendTo(L),y.addActionListener(function(){(new f(T(),V)).showDialog()}),
g.layoutCtrl(l,5,0,50,28),l.css("line-height","28px"))}}var P=this,R,J,Y,X,W=[],E;this.getJqUi=function(){R||(R=$("<div>"),g.layoutCtrlWithLRTB(R,0,0,null,0,0,null),C());return R};this.getSelected=function(){for(var t=0,z=W.length;t<z;t++){var A=W[t];if(A.isChecked())return t=A.getUserObject(),M.createMacroAdapter(t)}return null};this.setRadioButtonEnabled=function(t){if(0==W.length)E=t;else for(var z=0,A=W.length;z<A;z++){var L=W[z],y=L.getUserObject();y&&y.isUsable()?L.setEnabled(t):L.setEnabled(!1)}};
this.updateUi=function(){O()};var O=function(){J||C();if(0!=document.body.clientHeight||0!=document.body.clientWidth){h.clearWithoutHead(J);if(X)for(var t=0,z=X.length;t<z;t++){var A=X[t];h.createRow(J).setUserObject(A)}h.refresh(J)}},C=function(){J=h.createTable();J.setColumnFitVisibleWidth(!1);J.setDraggableAdjusting(!0,h.getHeadRowCount(),0,new F);var t=new I(J);t.setOutsideVisible(!0);J.setCellRender(t);J.setSyncUIWhenModelChanged(!0);J.addColumns(6);J.getColumn(0).setWidth(40);J.getColumn(1).setWidth(84);
J.getColumn(2).setWidth(90);J.getColumn(3).setWidth(100);J.getColumn(4).setWidth(80);J.getColumn(5).setWidth(60);t=h.createHeadRow(J);t.getCell(1).setValue(k.get("code","\u7f16\u7801"));t.getCell(2).setValue(k.get("name","\u540d\u79f0"));t.getCell(3).setValue(k.get("desc","\u63cf\u8ff0"));t.getCell(4).setValue(k.get("returnValueType","\u8fd4\u56de\u503c"));t.getCell(5).setValue(k.get("operation","\u64cd\u4f5c"));Y=$(J.getUI());g.layoutCtrlWithLRTB(Y,0,0,null,0,0,null);Y.appendTo(R);if(!X){var z=B(function(A){for(var L=
[],y=0,U=A.length;y<U;y++){var l=new c;l.fromJsonObject(A[y]);h.createRow(J).setUserObject(l);L.push(l)}X=L;0==X.length?(Y.remove(),A=$("<div>"),A.css({"text-align":"center",color:"#ccc","font-size":"16px"}),A.text(k.get("noMyOwnMacro","\u6682\u672a\u521b\u5efa\u5b8f")),g.layoutCtrlWithLRTB(A,0,0,null,20,0,null),A.appendTo(R)):O()},null,function(){null!=E&&P.setRadioButtonEnabled(E)});setTimeout(function(){z.loadAllMacros()},0)}},u=function(t,z){t.isChecked()&&(a=t.getUserObject())}}var x,a,r,w=new S,
N;this.getJqUi=function(){x||G();return x};this.setSelected=function(I){a=I&&I.getRawModel?I.getRawModel():null;x&&a&&r&&r.updateUi()};this.getSelectedModel=function(){return r.getSelected()};this.setEnabled=function(I){r.setRadioButtonEnabled(I)};var G=function(){x=$("<div>");x.css("border","1px solid #ccc");r=new q;r.getJqUi().appendTo(x);N&&N.unobserve();N=new K;N.setDelay(50);N.setCallback(function(){r&&r.updateUi()});N.observe()},B=function(I,P,R){return new H(T(),I,P,R)},T=function(){if(!b.oRemoteImpl)throw Error("remoteImpl unregister");
return b.oRemoteImpl}}"undefined"==typeof com&&(com={});"undefined"==typeof com.kingdee&&(com.kingdee={});"undefined"==typeof com.kingdee.bos&&(com.kingdee.bos={});"undefined"==typeof com.kingdee.bos.qing&&(com.kingdee.bos.qing={});"undefined"==typeof com.kingdee.bos.qing.macro&&(com.kingdee.bos.qing.macro={});var n=com.kingdee.bos.qing.macro;n.PreviewDialog=f;n.MacroVarSelector=b;var g,h,k,K,Q,S,d,e,p,D,c,v,H,M=n.MacroVarHelper,F=n.DraggableAdjustingCustomExpandor;(function(){var q=com.kingdee.bos.qing.common;
g=q.DomUtil;q=com.kingdee.bos.qing.ui.component;Q=q.RadioButton;S=q.RadioButtonGroup;d=q.WorkButton;e=q.AbstractModalDialog;p=q.MessageDialog;D=q.HelpIcon;q=com.kingdee.bos.qing.framework.common;k=q.MultilanguageManager.createPackageAccessor(n);K=q.WindowResizeObserver;q=com.kingdee.bos.qing.common.ui;h=q.TableUtil;q=com.kingdee.bos.qing.macro.model;c=q.Macro;v=q.PreviewData;q=com.kingdee.bos.qing.macro;H=q.MacroRuntimeFacade})();b.registerRemoteImpl=function(q){b.oRemoteImpl=q}})();
//qingVersionTag: 20250324