"use strict";(self.webpackChunkkd_login=self.webpackChunkkd_login||[]).push([[776],{41776:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});n(82320),n(9112),n(97060),n(60776),n(43924),n(5960),n(97336),n(46428),n(36368),n(8896),n(6200),n(70864),n(80920),n(87912),n(36887),n(78504),n(77864),n(86744);var i=n(85668),r=n(71252),o=n.n(r),a=n(39820),c=n.n(a),s="plaIu9HE",l="_32JHfyYA",u="_17p-Kdj6",f="_13rWaDeG",m="g9t-OR5i",y="_3JARbFEI",h="_2fhTl7QB",p="_3z-iPylz",v="zjy5BT16",d="-DylUzYB",b="_2VTENvVB",g="_1-cBYhDI",S="_1EW9Jrom",T="_17nZADid",k="_2ehBp9Kb",w=n(10428),E=n(82499),N=n(74800),O=n(57768),_=n(82784),j=n(10327);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},P.apply(this,arguments)}function C(e,t,n){return(t=D(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,D(i.key),i)}}function D(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=A(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==A(t)?t:String(t)}function I(e,t,n){return t=F(t),function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}(e,L()?Reflect.construct(t,n||[],F(e).constructor):t.apply(e,n))}function L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(L=function(){return!!e})()}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Y(e,t){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y(e,t)}var z=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=I(this,t,[e])).state={resetTime:60,loginStatus:""},n.videoId="#myCamera",n.token=(0,N.gV)(!1,32),n.onAnalysis=n.onAnalysis.bind(R(n)),n.onAnalysisFailed=n.onAnalysisFailed.bind(R(n)),n.checkLoginState=n.checkLoginState.bind(R(n)),n.showSuccess=n.showSuccess.bind(R(n)),n.handleClick=n.handleClick.bind(R(n)),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;c().attach(this.videoId),c().on("live",(function(){e.setState({loginStatus:O.gT}),e.onAnalysis()})),c().on("error",(function(e){}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.faceAnalyseTimer),clearTimeout(this.loginStateTimer),c().reset()}},{key:"onAnalysis",value:function(){var e=this.state.resetTime-1;e<=0?this.onAnalysisFailed():(this.setState({resetTime:e}),this.faceDetection(),this.faceAnalyseTimer=setTimeout(this.onAnalysis,1e3))}},{key:"onAnalysisFailed",value:function(){clearTimeout(this.faceAnalyseTimer),clearTimeout(this.loginStateTimer),this.setState({loginStatus:O.w$}),c().reset()}},{key:"faceDetection",value:function(){var e=this;c().snap((function(t){E.MF({token:e.token,img:t}).then((function(t){t.success&&e.checkLoginState()}))}))}},{key:"checkLoginState",value:function(){var e=this,t=this.state.resetTime;E.o1({token:this.token,pollType:"face"}).then((function(n){1===n.status?(c().reset(),e.showSuccess(n)):t>0&&(e.loginStateTimer=setTimeout(e.checkLoginState,1e3))})).catch((function(t){e.loginStateTimer=setTimeout(e.checkLoginState,1e3)}))}},{key:"showSuccess",value:function(e){clearTimeout(this.faceAnalyseTimer),clearTimeout(this.loginStateTimer),this.setState({loginStatus:O._Y}),j.q.setItem("ierp-login-username",e.username);var t={username:e.username||"",avatar:e.avatar||""},n=(0,j.iW)(O.Yl);j.q.setItem(n,JSON.stringify(t)),setTimeout((function(){window.location.href=e.URL}),1500)}},{key:"handleClick",value:function(){this.setState({resetTime:60,loginStatus:""}),c().attach(this.videoId)}},{key:"render",value:function(){var e=this.state,t=e.resetTime,n=e.loginStatus,r=o()(C(C({},m,!0),h,Number(n)===O.gT)),a=o()(C(C({},y,!0),h,Number(n)===O.w$)),c=o()(C(C({},v,!0),h,Number(n)===O.gT)),E=o()(C(C({},d,!0),h,Number(n)===O.w$)),N=o()(C(C({},g,!0),S,!0)),j=o()(C(C({},g,!0),T,!0));return i.createElement(w.c,P({selectType:"face",loginStatus:n},this.props),i.createElement("div",{className:s},i.createElement("div",{className:l},i.createElement("div",{className:u,id:"myCamera"}),i.createElement("div",{className:f}),i.createElement("div",{className:r}),i.createElement("div",{className:a},(0,_.yG)("login.key017"))),i.createElement("div",{className:p},i.createElement("div",{className:c},i.createElement("div",{className:b},i.createElement("div",{className:k},t),"s"),i.createElement("div",{className:g}),i.createElement("div",{className:N}),i.createElement("div",{className:j})),i.createElement("div",{className:E},i.createElement("div",{className:b,onClick:this.handleClick},(0,_.yG)("login.key019"))))))}}])&&B(n.prototype,r),a&&B(n,a),Object.defineProperty(n,"prototype",{writable:!1}),t}(i.Component)}}]);