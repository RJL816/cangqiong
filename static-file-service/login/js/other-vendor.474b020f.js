(self.webpackChunkkd_login=self.webpackChunkkd_login||[]).push([[794],{23264:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function r(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=a(t))){var e=0,i=function(){};return{s:i,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r,n=!0,o=!1;return{s:function(){s=t[Symbol.iterator]()},n:function(){var t=s.next();return n=t.done,t},e:function(t){o=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(o)throw r}}}}function n(t,e,i){return t*(1-i)+e*i}var o=n,h=function(){function e(i){t(this,e),this.ctrl=i.ctrl,this.definition=i.definition,this.ATT_FACTOR=4,this.GRAPH_X=2,this.AMPLITUDE_FACTOR=.6}return i(e,[{key:"globalAttFn",value:function(t){return Math.pow(this.ATT_FACTOR/(this.ATT_FACTOR+Math.pow(t,this.ATT_FACTOR)),this.ATT_FACTOR)}},{key:"_xpos",value:function(t){return this.ctrl.width*((t+this.GRAPH_X)/(2*this.GRAPH_X))}},{key:"_ypos",value:function(t){return this.AMPLITUDE_FACTOR*(this.globalAttFn(t)*(this.ctrl.heightMax*this.ctrl.amplitude)*(1/this.definition.attenuation)*Math.sin(this.ctrl.opt.frequency*t-this.ctrl.phase))}},{key:"draw",value:function(){var t=this.ctrl.ctx;t.moveTo(0,0),t.beginPath();var e=this.ctrl.color.replace(/rgb\(/g,"").replace(/\)/g,"");t.strokeStyle="rgba(".concat(e,",").concat(this.definition.opacity,")"),t.lineWidth=this.definition.lineWidth;for(var i=-this.GRAPH_X;i<=this.GRAPH_X;i+=this.ctrl.opt.pixelDepth)t.lineTo(this._xpos(i),this.ctrl.heightMax+this._ypos(i));t.stroke()}}],[{key:"getDefinition",value:function(){return[{attenuation:-2,lineWidth:1,opacity:.1},{attenuation:-6,lineWidth:1,opacity:.2},{attenuation:4,lineWidth:1,opacity:.4},{attenuation:2,lineWidth:1,opacity:.6},{attenuation:1,lineWidth:1.5,opacity:1}]}}]),e}(),l=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.ctrl=i.ctrl,this.definition=i.definition,this.GRAPH_X=25,this.AMPLITUDE_FACTOR=.8,this.SPEED_FACTOR=1,this.DEAD_PX=2,this.ATT_FACTOR=4,this.DESPAWN_FACTOR=.02,this.NOOFCURVES_RANGES=[2,5],this.AMPLITUDE_RANGES=[.3,1],this.OFFSET_RANGES=[-3,3],this.WIDTH_RANGES=[1,3],this.SPEED_RANGES=[.5,1],this.DESPAWN_TIMEOUT_RANGES=[500,2e3],this.respawn()}return i(e,[{key:"getRandomRange",value:function(t){return t[0]+Math.random()*(t[1]-t[0])}},{key:"respawnSingle",value:function(t){this.phases[t]=0,this.amplitudes[t]=0,this.despawnTimeouts[t]=this.getRandomRange(this.DESPAWN_TIMEOUT_RANGES),this.offsets[t]=this.getRandomRange(this.OFFSET_RANGES),this.speeds[t]=this.getRandomRange(this.SPEED_RANGES),this.finalAmplitudes[t]=this.getRandomRange(this.AMPLITUDE_RANGES),this.widths[t]=this.getRandomRange(this.WIDTH_RANGES),this.verses[t]=this.getRandomRange([-1,1])}},{key:"respawn",value:function(){this.spawnAt=Date.now(),this.noOfCurves=Math.floor(this.getRandomRange(this.NOOFCURVES_RANGES)),this.phases=new Array(this.noOfCurves),this.offsets=new Array(this.noOfCurves),this.speeds=new Array(this.noOfCurves),this.finalAmplitudes=new Array(this.noOfCurves),this.widths=new Array(this.noOfCurves),this.amplitudes=new Array(this.noOfCurves),this.despawnTimeouts=new Array(this.noOfCurves),this.verses=new Array(this.noOfCurves);for(var t=0;t<this.noOfCurves;t++)this.respawnSingle(t)}},{key:"globalAttFn",value:function(t){return Math.pow(this.ATT_FACTOR/(this.ATT_FACTOR+Math.pow(t,2)),this.ATT_FACTOR)}},{key:"sin",value:function(t,e){return Math.sin(t-e)}},{key:"_grad",value:function(t,e,i){return 1}},{key:"yRelativePos",value:function(t){for(var e=0,i=0;i<this.noOfCurves;i++){var a=4*(i/(this.noOfCurves-1)*2-1);a+=this.offsets[i];var s=t*(1/this.widths[i])-a;e+=Math.abs(this.amplitudes[i]*this.sin(this.verses[i]*s,this.phases[i])*this.globalAttFn(s))}return e/this.noOfCurves}},{key:"_ypos",value:function(t){return this.AMPLITUDE_FACTOR*this.ctrl.heightMax*this.ctrl.amplitude*this.yRelativePos(t)*this.globalAttFn(t/this.GRAPH_X*2)}},{key:"_xpos",value:function(t){return this.ctrl.width*((t+this.GRAPH_X)/(2*this.GRAPH_X))}},{key:"drawSupportLine",value:function(t){var e=[0,this.ctrl.heightMax,this.ctrl.width,1],i=t.createLinearGradient.apply(t,e);i.addColorStop(0,"transparent"),i.addColorStop(.1,"rgba(255,255,255,.5)"),i.addColorStop(.8,"rgba(255,255,255,.5)"),i.addColorStop(1,"transparent"),t.fillStyle=i,t.fillRect.apply(t,e)}},{key:"draw",value:function(){var t=this.ctrl.ctx;if(t.globalAlpha=.7,t.globalCompositeOperation="lighter",this.definition.supportLine)return this.drawSupportLine(t);for(var e=0;e<this.noOfCurves;e++)this.spawnAt+this.despawnTimeouts[e]<=Date.now()?this.amplitudes[e]-=this.DESPAWN_FACTOR:this.amplitudes[e]+=this.DESPAWN_FACTOR,this.amplitudes[e]=Math.min(Math.max(this.amplitudes[e],0),this.finalAmplitudes[e]),this.phases[e]=(this.phases[e]+this.ctrl.speed*this.speeds[e]*this.SPEED_FACTOR)%(2*Math.PI);for(var i=-1/0,a=0,s=[1,-1];a<s.length;a++){var r=s[a];t.beginPath();for(var n=-this.GRAPH_X;n<=this.GRAPH_X;n+=this.ctrl.opt.pixelDepth){var o=this._xpos(n),h=this._ypos(n);t.lineTo(o,this.ctrl.heightMax-r*h),i=Math.max(i,h)}t.closePath(),t.fillStyle="rgba(".concat(this.definition.color,", 1)"),t.strokeStyle="rgba(".concat(this.definition.color,", 1)"),t.fill()}return i<this.DEAD_PX&&this.prevMaxY>i&&this.respawn(),this.prevMaxY=i,null}}],[{key:"getDefinition",value:function(t){return Object.assign([{color:"255,255,255",supportLine:!0},{color:"15, 82, 169"},{color:"173, 57, 76"},{color:"48, 220, 155"}],t)}}]),e}(),c=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t(this,e),this.container=i.container||document.body,this.opt=Object.assign({style:"ios",ratio:window.devicePixelRatio||1,speed:.2,amplitude:1,frequency:6,color:"#fff",cover:!1,width:window.getComputedStyle(this.container).width.replace("px",""),height:window.getComputedStyle(this.container).height.replace("px",""),autostart:!1,pixelDepth:.02,lerpSpeed:.1},i),this.phase=0,this.run=!1,this.speed=Number(this.opt.speed),this.amplitude=Number(this.opt.amplitude),this.width=Number(this.opt.ratio*this.opt.width),this.height=Number(this.opt.ratio*this.opt.height),this.heightMax=Number(this.height/2)-6,this.color="rgb(".concat(this.hex2rgb(this.opt.color),")"),this.interpolation={speed:this.speed,amplitude:this.amplitude},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.width,this.canvas.height=this.height,!0===this.opt.cover?this.canvas.style.width=this.canvas.style.height="100%":(this.canvas.style.width="".concat(this.width/this.opt.ratio,"px"),this.canvas.style.height="".concat(this.height/this.opt.ratio,"px")),this.curves=[],"ios9"===this.opt.style){var a,s=r(l.getDefinition(this.opt.waveColors||[]));try{for(s.s();!(a=s.n()).done;){var n=a.value;this.curves.push(new l({ctrl:this,definition:n}))}}catch(t){s.e(t)}finally{s.f()}}else{var o,c=r(h.getDefinition());try{for(c.s();!(o=c.n()).done;){var d=o.value;this.curves.push(new h({ctrl:this,definition:d}))}}catch(t){c.e(t)}finally{c.f()}}this.container.appendChild(this.canvas),i.autostart&&this.start()}return i(e,[{key:"hex2rgb",value:function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,(function(t,e,i,a){return e+e+i+i+a+a}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?"".concat(parseInt(i[1],16).toString(),",").concat(parseInt(i[2],16).toString(),",").concat(parseInt(i[3],16).toString()):null}},{key:"lerp",value:function(t){return this[t]=o(this[t],this.interpolation[t],this.opt.lerpSpeed),this[t]-this.interpolation[t]==0&&(this.interpolation[t]=null),this[t]}},{key:"_clear",value:function(){this.ctx.globalCompositeOperation="destination-out",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.globalCompositeOperation="source-over"}},{key:"_draw",value:function(){var t,e=r(this.curves);try{for(e.s();!(t=e.n()).done;)t.value.draw()}catch(t){e.e(t)}finally{e.f()}}},{key:"startDrawCycle",value:function(){!1!==this.run&&(this._clear(),null!==this.interpolation.amplitude&&this.lerp("amplitude"),null!==this.interpolation.speed&&this.lerp("speed"),this._draw(),this.phase=(this.phase+Math.PI/2*this.speed)%(2*Math.PI),window.requestAnimationFrame?window.requestAnimationFrame(this.startDrawCycle.bind(this)):setTimeout(this.startDrawCycle.bind(this),20))}},{key:"start",value:function(){this.phase=0,this.run=!0,this.startDrawCycle()}},{key:"stop",value:function(){this.phase=0,this.run=!1}},{key:"set",value:function(t,e){this.interpolation[t]=Number(e)}},{key:"setSpeed",value:function(t){this.set("speed",t)}},{key:"setAmplitude",value:function(t){this.set("amplitude",t)}}]),e}();return c}()},39820:function(t,e,i){var a;!function(s){var r;function o(){var t=Error.apply(this,arguments);t.name=this.name="FlashError",this.stack=t.stack,this.message=t.message}function h(){var t=Error.apply(this,arguments);t.name=this.name="WebcamError",this.stack=t.stack,this.message=t.message}var l=function(){};l.prototype=Error.prototype,o.prototype=new l,h.prototype=new l;var c={version:"1.0.26",protocol:location.protocol.match(/https/i)?"https":"http",loaded:!1,live:!1,userMedia:!0,iOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!s.MSStream,params:{width:0,height:0,dest_width:0,dest_height:0,image_format:"jpeg",jpeg_quality:90,enable_flash:!0,force_flash:!1,flip_horiz:!1,fps:30,upload_name:"webcam",constraints:null,swfURL:"",flashNotDetectedText:"ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).",noInterfaceFoundText:"No supported webcam interface found.",unfreeze_snap:!0,iosPlaceholderText:"Click here to open camera.",user_callback:null,user_canvas:null},errors:{FlashError:o,WebcamError:h},hooks:{},init:function(){var t=this;this.mediaDevices=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices:navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function(t){return new Promise((function(e,i){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,t,e,i)}))}}:null,s.URL=s.URL||s.webkitURL||s.mozURL||s.msURL,this.userMedia=this.userMedia&&!!this.mediaDevices&&!!s.URL,navigator.userAgent.match(/Firefox\D+(\d+)/)&&parseInt(RegExp.$1,10)<21&&(this.userMedia=null),this.userMedia&&s.addEventListener("beforeunload",(function(e){t.reset()}))},exifOrientation:function(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return 0;for(var i=2;i<t.byteLength;){if(255!=e.getUint8(i))return 0;if(225==e.getUint8(i+1)){i+=4;var a="";for(n=0;n<4;n++)a+=String.fromCharCode(e.getUint8(i+n));if("Exif"!=a)return 0;i+=6;var s=null;if(18761==e.getUint16(i))s=!1;else{if(19789!=e.getUint16(i))return 0;s=!0}if(42!=e.getUint16(i+2,!s))return 0;var r=e.getUint32(i+4,!s);if(r<8)return 0;for(var o=i+r,h=e.getUint16(o,!s),l=0;l<h;l++){var c=o+12*l+2;if(274==e.getUint16(c,!s)){var d=e.getUint16(c+2,!s),p=e.getUint32(c+4,!s);if(3!=d&&1!=p)return 0;var u=e.getUint16(c+8,!s);return u<1||u>8?0:u}}}else i+=2+e.getUint16(i+2)}return 0},fixOrientation:function(t,e,i){var a=new Image;a.addEventListener("load",(function(t){var s=document.createElement("canvas"),r=s.getContext("2d");switch(e<5?(s.width=a.width,s.height=a.height):(s.width=a.height,s.height=a.width),e){case 2:r.transform(-1,0,0,1,a.width,0);break;case 3:r.transform(-1,0,0,-1,a.width,a.height);break;case 4:r.transform(1,0,0,-1,0,a.height);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,a.height,0);break;case 7:r.transform(0,-1,-1,0,a.height,a.width);break;case 8:r.transform(0,-1,1,0,0,a.width)}r.drawImage(a,0,0),i.src=s.toDataURL()}),!1),a.src=t},attach:function(t){if("string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!t)return this.dispatch("error",new h("Could not locate DOM element to attach to."));this.container=t,t.innerHTML="";var e=document.createElement("div");if(t.appendChild(e),this.peg=e,this.params.width||(this.params.width=t.offsetWidth),this.params.height||(this.params.height=t.offsetHeight),!this.params.width||!this.params.height)return this.dispatch("error",new h("No width and/or height for webcam.  Please call set() first, or attach to a visible element."));this.params.dest_width||(this.params.dest_width=this.params.width),this.params.dest_height||(this.params.dest_height=this.params.height),this.userMedia=void 0===r?this.userMedia:r,this.params.force_flash&&(r=this.userMedia,this.userMedia=null),"number"!=typeof this.params.fps&&(this.params.fps=30);var i=this.params.width/this.params.dest_width,a=this.params.height/this.params.dest_height;if(this.userMedia){var n=document.createElement("video");n.setAttribute("autoplay","autoplay"),n.setAttribute("playsinline","playsinline"),n.style.width=this.params.dest_width+"px",n.style.height=this.params.dest_height+"px",1==i&&1==a||(t.style.overflow="hidden",n.style.webkitTransformOrigin="0px 0px",n.style.mozTransformOrigin="0px 0px",n.style.msTransformOrigin="0px 0px",n.style.oTransformOrigin="0px 0px",n.style.transformOrigin="0px 0px",n.style.webkitTransform="scaleX("+i+") scaleY("+a+")",n.style.mozTransform="scaleX("+i+") scaleY("+a+")",n.style.msTransform="scaleX("+i+") scaleY("+a+")",n.style.oTransform="scaleX("+i+") scaleY("+a+")",n.style.transform="scaleX("+i+") scaleY("+a+")"),t.appendChild(n),this.video=n;var o=this;this.mediaDevices.getUserMedia({audio:!1,video:this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then((function(t){n.onloadedmetadata=function(e){o.stream=t,o.loaded=!0,o.live=!0,o.dispatch("load"),o.dispatch("live"),o.flip()},"srcObject"in n?n.srcObject=t:n.src=s.URL.createObjectURL(t)})).catch((function(e){o.params.enable_flash&&o.detectFlash()?setTimeout((function(){o.params.force_flash=1,o.attach(t)}),1):o.dispatch("error",e)}))}else if(this.iOS){(f=document.createElement("div")).id=this.container.id+"-ios_div",f.className="webcamjs-ios-placeholder",f.style.width=this.params.width+"px",f.style.height=this.params.height+"px",f.style.textAlign="center",f.style.display="table-cell",f.style.verticalAlign="middle",f.style.backgroundRepeat="no-repeat",f.style.backgroundSize="contain",f.style.backgroundPosition="center";var l=document.createElement("span");l.className="webcamjs-ios-text",l.innerHTML=this.params.iosPlaceholderText,f.appendChild(l);var d=document.createElement("img");d.id=this.container.id+"-ios_img",d.style.width=this.params.dest_width+"px",d.style.height=this.params.dest_height+"px",d.style.display="none",f.appendChild(d);var p=document.createElement("input");p.id=this.container.id+"-ios_input",p.setAttribute("type","file"),p.setAttribute("accept","image/*"),p.setAttribute("capture","camera");o=this;var u=this.params;p.addEventListener("change",(function(t){if(t.target.files.length>0&&0==t.target.files[0].type.indexOf("image/")){var e=URL.createObjectURL(t.target.files[0]),i=new Image;i.addEventListener("load",(function(t){var e=document.createElement("canvas");e.width=u.dest_width,e.height=u.dest_height;var a=e.getContext("2d");ratio=Math.min(i.width/u.dest_width,i.height/u.dest_height);var s=u.dest_width*ratio,r=u.dest_height*ratio,n=(i.width-s)/2,o=(i.height-r)/2;a.drawImage(i,n,o,s,r,0,0,u.dest_width,u.dest_height);var h=e.toDataURL();d.src=h,f.style.backgroundImage="url('"+h+"')"}),!1);var a=new FileReader;a.addEventListener("load",(function(t){var a=o.exifOrientation(t.target.result);a>1?o.fixOrientation(e,a,i):i.src=e}),!1);var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="blob",s.onload=function(t){200!=this.status&&0!==this.status||a.readAsArrayBuffer(this.response)},s.send()}}),!1),p.style.display="none",t.appendChild(p),f.addEventListener("click",(function(t){u.user_callback?o.snap(u.user_callback,u.user_canvas):(p.style.display="block",p.focus(),p.click(),p.style.display="none")}),!1),t.appendChild(f),this.loaded=!0,this.live=!0}else if(this.params.enable_flash&&this.detectFlash()){var f;s.Webcam=c,(f=document.createElement("div")).innerHTML=this.getSWFHTML(),t.appendChild(f)}else this.dispatch("error",new h(this.params.noInterfaceFoundText));if(this.params.crop_width&&this.params.crop_height){var m=Math.floor(this.params.crop_width*i),v=Math.floor(this.params.crop_height*a);t.style.width=m+"px",t.style.height=v+"px",t.style.overflow="hidden",t.scrollLeft=Math.floor(this.params.width/2-m/2),t.scrollTop=Math.floor(this.params.height/2-v/2)}else t.style.width=this.params.width+"px",t.style.height=this.params.height+"px"},reset:function(){if(this.preview_active&&this.unfreeze(),this.unflip(),this.userMedia){if(this.stream)if(this.stream.getVideoTracks){var t=this.stream.getVideoTracks();t&&t[0]&&t[0].stop&&t[0].stop()}else this.stream.stop&&this.stream.stop();delete this.stream,delete this.video}if(!0!==this.userMedia&&this.loaded&&!this.iOS){var e=this.getMovie();e&&e._releaseCamera&&e._releaseCamera()}this.container&&(this.container.innerHTML="",delete this.container),this.loaded=!1,this.live=!1},set:function(){if(1==arguments.length)for(var t in arguments[0])this.params[t]=arguments[0][t];else this.params[arguments[0]]=arguments[1]},on:function(t,e){t=t.replace(/^on/i,"").toLowerCase(),this.hooks[t]||(this.hooks[t]=[]),this.hooks[t].push(e)},off:function(t,e){if(t=t.replace(/^on/i,"").toLowerCase(),this.hooks[t])if(e){var i=this.hooks[t].indexOf(e);i>-1&&this.hooks[t].splice(i,1)}else this.hooks[t]=[]},dispatch:function(){var t,e=arguments[0].replace(/^on/i,"").toLowerCase(),i=Array.prototype.slice.call(arguments,1);if(this.hooks[e]&&this.hooks[e].length){for(var a=0,r=this.hooks[e].length;a<r;a++){var n=this.hooks[e][a];"function"==typeof n?n.apply(this,i):"object"==typeof n&&2==n.length?n[0][n[1]].apply(n[0],i):s[n]&&s[n].apply(s,i)}return!0}return"error"==e&&(t=i[0]instanceof o||i[0]instanceof h?i[0].message:"Could not access webcam: "+i[0].name+": "+i[0].message+" "+i[0].toString(),alert("Webcam.js Error: "+t)),!1},setSWFLocation:function(t){this.set("swfURL",t)},detectFlash:function(){var t="Shockwave Flash",e="application/x-shockwave-flash",i=s,a=navigator,r=!1;if(void 0!==a.plugins&&"object"==typeof a.plugins[t])a.plugins[t].description&&void 0!==a.mimeTypes&&a.mimeTypes[e]&&a.mimeTypes[e].enabledPlugin&&(r=!0);else if(void 0!==i.ActiveXObject)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(n)n.GetVariable("$version")&&(r=!0)}catch(t){}return r},getSWFHTML:function(){var t="",e=this.params.swfURL;if(location.protocol.match(/file/))return this.dispatch("error",new o("Flash does not work from local disk.  Please run from a web server.")),'<h3 style="color:red">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>';if(!this.detectFlash())return this.dispatch("error",new o("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again.")),'<h3 style="color:red">'+this.params.flashNotDetectedText+"</h3>";if(!e){for(var i="",a=document.getElementsByTagName("script"),r=0,n=a.length;r<n;r++){var h=a[r].getAttribute("src");h&&h.match(/\/webcam(\.min)?\.js/)&&(i=h.replace(/\/webcam(\.min)?\.js.*$/,""),r=n)}e=i?i+"/webcam.swf":"webcam.swf"}s.localStorage&&!localStorage.getItem("visited")&&(this.params.new_user=1,localStorage.setItem("visited",1));var l="";for(var c in this.params)l&&(l+="&"),l+=c+"="+escape(this.params[c]);return t+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" type="application/x-shockwave-flash" codebase="'+this.protocol+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this.params.width+'" height="'+this.params.height+'" id="webcam_movie_obj" align="middle"><param name="wmode" value="opaque" /><param name="allowScriptAccess" value="sameDomain " /><param name="allowFullScreen" value="false" /><param name="movie" value="'+e+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+l+'"/><embed id="webcam_movie_embed" src="'+e+'" wmode="opaque" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+this.params.width+'" height="'+this.params.height+'" name="webcam_movie_embed" align="middle" allowScriptAccess="sameDomain" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+l+'"></embed></object>'},getMovie:function(){if(!this.loaded)return this.dispatch("error",new o("Flash Movie is not loaded yet"));var t=document.getElementById("webcam_movie_obj");return t&&t._snap||(t=document.getElementById("webcam_movie_embed")),t||this.dispatch("error",new o("Cannot locate Flash movie in DOM")),t},freeze:function(){var t=this,e=this.params;this.preview_active&&this.unfreeze();var i=this.params.width/this.params.dest_width,a=this.params.height/this.params.dest_height;this.unflip();var s=e.crop_width||e.dest_width,r=e.crop_height||e.dest_height,n=document.createElement("canvas");n.width=s,n.height=r;var o=n.getContext("2d");this.preview_canvas=n,this.preview_context=o,1==i&&1==a||(n.style.webkitTransformOrigin="0px 0px",n.style.mozTransformOrigin="0px 0px",n.style.msTransformOrigin="0px 0px",n.style.oTransformOrigin="0px 0px",n.style.transformOrigin="0px 0px",n.style.webkitTransform="scaleX("+i+") scaleY("+a+")",n.style.mozTransform="scaleX("+i+") scaleY("+a+")",n.style.msTransform="scaleX("+i+") scaleY("+a+")",n.style.oTransform="scaleX("+i+") scaleY("+a+")",n.style.transform="scaleX("+i+") scaleY("+a+")"),this.snap((function(){n.style.position="relative",n.style.left=t.container.scrollLeft+"px",n.style.top=t.container.scrollTop+"px",t.container.insertBefore(n,t.peg),t.container.style.overflow="hidden",t.preview_active=!0}),n)},unfreeze:function(){this.preview_active&&(this.container.removeChild(this.preview_canvas),delete this.preview_context,delete this.preview_canvas,this.preview_active=!1,this.flip())},flip:function(){if(this.params.flip_horiz){var t=this.container.style;t.webkitTransform="scaleX(-1)",t.mozTransform="scaleX(-1)",t.msTransform="scaleX(-1)",t.oTransform="scaleX(-1)",t.transform="scaleX(-1)",t.filter="FlipH",t.msFilter="FlipH"}},unflip:function(){if(this.params.flip_horiz){var t=this.container.style;t.webkitTransform="scaleX(1)",t.mozTransform="scaleX(1)",t.msTransform="scaleX(1)",t.oTransform="scaleX(1)",t.transform="scaleX(1)",t.filter="",t.msFilter=""}},savePreview:function(t,e){var i=this.params,a=this.preview_canvas,s=this.preview_context;e&&e.getContext("2d").drawImage(a,0,0);t(e?null:a.toDataURL("image/"+i.image_format,i.jpeg_quality/100),a,s),this.params.unfreeze_snap&&this.unfreeze()},snap:function(t,e){t||(t=this.params.user_callback),e||(e=this.params.user_canvas);var i=this.params;if(!this.loaded)return this.dispatch("error",new h("Webcam is not loaded yet"));if(!t)return this.dispatch("error",new h("Please provide a callback function or canvas to snap()"));if(this.preview_active)return this.savePreview(t,e),null;var a=document.createElement("canvas");a.width=this.params.dest_width,a.height=this.params.dest_height;var s=a.getContext("2d");this.params.flip_horiz&&(s.translate(i.dest_width,0),s.scale(-1,1));var r=function(){if(this.src&&this.width&&this.height&&s.drawImage(this,0,0,i.dest_width,i.dest_height),i.crop_width&&i.crop_height){var r=document.createElement("canvas");r.width=i.crop_width,r.height=i.crop_height;var n=r.getContext("2d");n.drawImage(a,Math.floor(i.dest_width/2-i.crop_width/2),Math.floor(i.dest_height/2-i.crop_height/2),i.crop_width,i.crop_height,0,0,i.crop_width,i.crop_height),s=n,a=r}e&&e.getContext("2d").drawImage(a,0,0);t(e?null:a.toDataURL("image/"+i.image_format,i.jpeg_quality/100),a,s)};if(this.userMedia)s.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height),r();else if(this.iOS){var n=document.getElementById(this.container.id+"-ios_div"),o=document.getElementById(this.container.id+"-ios_img"),l=document.getElementById(this.container.id+"-ios_input");iFunc=function(t){r.call(o),o.removeEventListener("load",iFunc),n.style.backgroundImage="none",o.removeAttribute("src"),l.value=null},l.value?iFunc(null):(o.addEventListener("load",iFunc),l.style.display="block",l.focus(),l.click(),l.style.display="none")}else{var c=this.getMovie()._snap();(o=new Image).onload=r,o.src="data:image/"+this.params.image_format+";base64,"+c}return null},configure:function(t){t||(t="camera"),this.getMovie()._configure(t)},flashNotify:function(t,e){switch(t){case"flashLoadComplete":this.loaded=!0,this.dispatch("load");break;case"cameraLive":this.live=!0,this.dispatch("live");break;case"error":this.dispatch("error",new o(e))}},b64ToUint6:function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0},base64DecToArr:function(t,e){for(var i,a,s=t.replace(/[^A-Za-z0-9\+\/]/g,""),r=s.length,n=e?Math.ceil((3*r+1>>2)/e)*e:3*r+1>>2,o=new Uint8Array(n),h=0,l=0,c=0;c<r;c++)if(a=3&c,h|=this.b64ToUint6(s.charCodeAt(c))<<18-6*a,3===a||r-c==1){for(i=0;i<3&&l<n;i++,l++)o[l]=h>>>(16>>>i&24)&255;h=0}return o},upload:function(t,e,i){var a=this.params.upload_name||"webcam",s="";if(!t.match(/^data\:image\/(\w+)/))throw"Cannot locate image format in Data URI";s=RegExp.$1;var r=t.replace(/^data\:image\/\w+\;base64\,/,""),n=new XMLHttpRequest;n.open("POST",e,!0),n.upload&&n.upload.addEventListener&&n.upload.addEventListener("progress",(function(t){if(t.lengthComputable){var e=t.loaded/t.total;c.dispatch("uploadProgress",e,t)}}),!1);var o=this;n.onload=function(){i&&i.apply(o,[n.status,n.responseText,n.statusText]),c.dispatch("uploadComplete",n.status,n.responseText,n.statusText)};var h=new Blob([this.base64DecToArr(r)],{type:"image/"+s}),l=new FormData;l.append(a,h,a+"."+s.replace(/e/,"")),n.send(l)}};c.init(),void 0===(a=function(){return c}.call(e,i,e,t))||(t.exports=a)}(window)}}]);