(self.webpackChunkkd_login=self.webpackChunkkd_login||[]).push([[531,196],{1432:function(e,t,n){"use strict";n.r(t),n.d(t,{Form:function(){return I},PublicQrcode:function(){return j},RoleSelect:function(){return N},default:function(){return C},getRoleData:function(){return M}});n(82320),n(9112),n(97060),n(60776),n(9692),n(5092),n(5684),n(41872),n(23784),n(43924),n(35164),n(93917),n(4180),n(5960),n(76896),n(97336),n(21300),n(46428),n(36368),n(6200),n(87912),n(33768),n(90512),n(78504),n(77864);var r=n(85668),a=n(12356),o=n(71252),i=n.n(o),c=n(33588),u={formContainer:"_2x3JI3Z0",title:"oEXaHJ-t",content:"_35BgTiNG",dropdownList:"_3fNoOqTV",roleSelect:"_35-ocPkH",text:"_1YGH2lzT",off:"n4UxXJde",on:"_1YdOgtJj",panel:"_2eVB1Uvz",item:"_38nWtqfY",selected:"fuCP5mnS",hidden:"_2LWfeCYN",backLogin:"lFWH_LcN",hyperlink:"_2GQXSJgl",publicQrcode:"_1DT1SoGO",msg:"ElUQEyUP"},l=n(8288),d=n(25128),s=n(82499),f=n(74800),y=n(90923),m=n(82784),v=n(57768),p=n(94348),g=n(10327);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function h(e,t,n){var r;return r=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==b(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,c=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,a=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}function C(e){return(0,r.useEffect)((function(){e.dataPipeModel&&e.dataPipeModel.sendData({type:"FocusInput",name:"yzjAccount"})}),[]),r.createElement(c.c,w({selectType:"demo"},e),r.createElement("div",{className:u.formContainer},r.createElement(l.Y3,{dataPipeModel:e.dataPipeModel}),r.createElement(I,e)))}var M=function(){var e="1729999999";return[{text:(0,m.yG)("login.key068"),value:"administrator"},{text:(0,m.yG)("login.key069"),value:e+"9"},{text:(0,m.yG)("login.key070"),value:e+"4"},{text:(0,m.yG)("login.key071"),value:e+"1"},{text:(0,m.yG)("login.key072")+"1",value:e+"8"},{text:(0,m.yG)("login.key072")+"2",value:e+"7"},{text:(0,m.yG)("login.key072")+"3",value:e+"6"},{text:(0,m.yG)("login.key073"),value:e+"5"},{text:(0,m.yG)("login.key074"),value:"17299999986"}]};function I(e){var t=P((0,r.useState)(!1),2),n=t[0],a=t[1],o=P((0,r.useState)([]),2),i=o[0],c=o[1],b=P((0,r.useState)("17299999999"),2),h=b[0],S=b[1];(0,r.useEffect)((function(){var e=function(e){13===e.keyCode&&k()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]);var k=function(){return!n&&(!!function(){var t=d.c.yzjAccount,n=d.c.yzjPwd;if(f.q4.isEmpty(t)){var r=(0,m.yG)("login.key079");return e.dataPipeModel&&e.dataPipeModel.sendData({type:"yzjAccountError",data:r}),!1}if(f.q4.isEmpty(n)){var a=(0,m.yG)("login.key080");return e.dataPipeModel&&e.dataPipeModel.sendData({type:"yzjPwdError",data:a}),!1}return!0}()&&(a(!0),void w(C)))},w=function(t){var n=d.c.yzjAccount+(0,f.gV)(!1,16-d.c.yzjAccount.length);s.Mh({accessKey:n,language:d.c.lang,accountId:d.c.accountId}).then((function(r){if(!0!==r.success){var a={message:r.errorMessage,level:1};return e.dataPipeModel&&e.dataPipeModel.sendData({type:"ShowNotification",error:a}),!1}t({publicKey:r.publicKey,accessKey:n})})).catch((function(e){a(!1)}))},C=function(t){var n,r=d.c.yzjAccount,o=d.c.yzjPwd,i=d.c.accountId,c=d.c.lang,u=d.c.role,l=t.accessKey,f=t.publicKey,m=d.c.dataCenter.find((function(e,t){if(e.value===i)return!0}));n=m&&m.closeEncrypt?o:(0,y.U)(f,o),s.u4({type:"user",useraccount:r,accessKey:l,password:n,accountId:i,language:c,userSourceType:3,role:u}).then((function(t){var n=t.errorcode,o=t.needChangePwd,u=t.needActive,l=t.needChangeInitialPwd,s=t.message,f=t.description;if(u)window.location.hash="#activeUser";else{if(1===o||1===l){window.location.hash="#findPassword";var y={level:2,message:s};return e.dataPipeModel&&e.dataPipeModel.sendData({type:"ShowNotification",error:y}),e.dataPipeModel&&e.dataPipeModel.sendData({type:"FocusInput",name:"verifyCode"}),!1}if(0!==n){var m={level:1,message:f||t.description_cn};return e.dataPipeModel&&e.dataPipeModel.sendData({type:"ShowNotification",error:m}),a(!1),!1}g.Ej.setItem(v.EN,r),g.q.setItem("ierp-login-username",t.username);var p={username:t.username||"",avatar:t.avatar||""},b=(0,g.iW)(v.Yl);g.q.setItem(b,JSON.stringify(p));var h="language=".concat(c),E=t.RedirectURL;-1!==E.indexOf("?")?E+="&"+h:E+="?"+h,(0,g.Ub)(E,"",d.c.dataCenter,i)}})).catch((function(e){a(!1)}))},I=function(e){var t=e.data;i.some((function(e){return e.value===t.value}))||c((function(e){return[].concat(E(e),[t])}))},A=P((0,r.useState)(!0),2);A[0],A[1];(0,r.useEffect)((function(){if(!(!e.dataCenter.length>0)){var t="demoDataCenterList",n=e.dataPipeModel,r=e.dataCenter;n.registerCallback(t,I),(0,p.WG)(t,r,[0,6,4,5,2,7],n)}}),[e.dataCenter]);var x=e.currentAccountId,G=e.handleChangeDataCenter;return r.createElement("div",{className:u.content},r.createElement(l.k9,{name:"accountId",style:u.dropdownList,list:i,oldDataCenter:e.dataCenter,selectItem:x,onItemClick:G,dataPipeModel:e.dataPipeModel}),r.createElement(j,{currentAccountId:x,dataPipeModel:e.dataPipeModel,currentRole:h}),r.createElement(N,{name:"role",list:M(),setCurrentRole:function(e){S(e)},currentRole:h}),r.createElement("div",{className:u.msg},(0,m.yG)("login.key235")))}function j(e){var t=e.currentAccountId,n=e.dataPipeModel,a=e.currentRole,o=P((0,r.useState)(),2),i=o[0],c=o[1];(0,r.useEffect)((function(){l()}),[t,a]);var l=function(){var e=(0,f.gV)(!1,15),r=(0,g.Qn)(),o={accountId:t,token:e,language:d.c.lang,scantype:"demo",QRcodeRedirect:r,role:a};s.IN(o).then((function(e){if(e&&e.errorcode){var t={message:e.description||e.description_cn,level:e.level||1,time:e.time};n.sendData({type:"ShowNotification",error:t})}c(e.redirectUrl)}))};return r.createElement("div",{className:u.publicQrcode},r.createElement("iframe",{src:i,frameBorder:"0",scrolling:"no"}))}function N(e){var t=P((0,r.useState)(!1),2),n=t[0],o=t[1],c=(0,r.useRef)(null),l=e.currentRole,s=e.setCurrentRole,f=function(e){for(var t=e.target;t&&t!==document;){if(t===a.findDOMNode(c.current))return;t=t.parentNode}t&&o(!1)};(0,r.useEffect)((function(){return d.c.setValue("role","17299999999"),document.addEventListener("click",f),function(){return document.removeEventListener("click",f)}}),[]);var y=e.list,m=function(e){var t=e.target.getAttribute("value");o(!1),d.c.setValue("role",t),s(t)},v=y.map((function(e){var t=i()(h(h({},u.item,!0),u.selected,e.value===l));return r.createElement("div",{key:e.value,value:e.value,className:t,onClick:m},e.text)})),p=i()(h(h(h({},u.text,!0),u.off,!n),u.on,n)),g=i()(h(h({},u.panel,!0),u.hidden,!n)),b=y.find((function(e){return e.value===l})),E=b&&b.text;return r.createElement("div",{className:u.roleSelect,ref:c},r.createElement("div",{className:p,onClick:function(e){o(!n)}},E),r.createElement("div",{className:g},v))}},26952:function(){},72628:function(){},99560:function(){},67716:function(){},66756:function(){},87240:function(){},4712:function(){},27292:function(){}}]);