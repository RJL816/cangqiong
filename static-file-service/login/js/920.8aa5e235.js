(self.webpackChunkkd_login=self.webpackChunkkd_login||[]).push([[920,196],{73616:function(t,e,n){"use strict";n.r(e),n.d(e,{PublicQrcode:function(){return P}});n(82320),n(9112),n(97060),n(60776),n(5684),n(43616),n(23784),n(43924),n(93917),n(4180),n(5960),n(76896),n(97336),n(21300),n(46428),n(36368),n(8896),n(6200),n(70864),n(80920),n(87912),n(36887),n(33768),n(90512),n(60824),n(78504),n(77864);var r=n(85668),o=n(41316),a=n(33588),i=n(58952),c=n(82499),u=n(74800),l=n(94348),s=n(25128),f=n(57768),p=n(10327),d=n(81748),h=n(82784);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(){return v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v.apply(this,arguments)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function C(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==y(e)?e:String(e)}function w(t,e,n){return e=I(e),function(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}(t,k()?Reflect.construct(e,n||[],I(t).constructor):e.apply(t,n))}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}var D=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=(0,p.iW)(f.IH),o=p.q.getItem(r),a=(0,p.iW)(f.uW),i=p.q.getItem(a);return(n=w(this,e,[t])).state={accountId:o,lang:i,list:[]},n.handleChangeDataCenter=n.handleChangeDataCenter.bind(O(n)),n.changeLang=n.changeLang.bind(O(n)),n.showDropdownList=n.showDropdownList.bind(O(n)),n.ListenerFilterDataCenter=n.ListenerFilterDataCenter.bind(O(n)),n.include=!0,n}var n,c,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),n=e,(c=[{key:"showDropdownList",value:function(t){var e=t.data,n=this.state.list;n.some((function(t){return t.value===e.value}))||(this.include||0===n.length||(this.handleChangeDataCenter(n[0].value),this.include=!0),n.push(e),this.setState({list:n}))}},{key:"shouldComponentUpdate",value:function(t,e){var n=t.currentAccountId;return t.currentAccountId!==this.props.currentAccountId&&this.setState({accountId:n}),0!==t.dataCenter.length&&0===this.props.dataCenter.length&&this.ListenerFilterDataCenter(t.dataCenter,n),!0}},{key:"componentDidMount",value:function(){0!==this.props.dataCenter.length&&this.ListenerFilterDataCenter(this.props.dataCenter,this.props.currentAccountId)}},{key:"ListenerFilterDataCenter",value:function(t,e){var n,r=this;t.some((function(t,r){if(t.value===e)return n=r,!0})),(0,l.Q3)(e,t,n,this.props.dataPipeModel).then((function(e){var n;null!=e&&null!==(n=e.userSourceType)&&void 0!==n&&n.includes(6)||(r.include=!1);var o="weChatDataCenterList",a=r.props.dataPipeModel;a&&a.registerCallback(o,r.showDropdownList),(0,l.WG)(o,t,[6],a)}))}},{key:"componentWillMount",value:function(){var t=this.props.currentAccountId;t&&this.props.handleChangeDataCenter(t)}},{key:"handleChangeDataCenter",value:function(t){s.c.setValue("toggleDataCenter",!0),this.props.handleChangeDataCenter(t),this.setState({accountId:t})}},{key:"changeLang",value:function(t){this.setState({lang:t})}},{key:"render",value:function(){var t=this.props,e=t.dataCenter,n=t.QrCodeType,c=t.currentAccountId,u=p.q.getItem((0,p.iW)(f.EF))===f.Af?"<".concat((0,h.yG)("login.key218")):"<".concat((0,h.yG)("login.key217"));return r.createElement(a.c,v({selectType:"WeChat",changeLang:this.changeLang},this.props),r.createElement("div",{className:o.c.formContainer},r.createElement("div",{className:o.c.content},r.createElement(d.c,{dataPipeModel:this.props.dataPipeModel}),this.state.list&&r.createElement(i.k9,{name:"accountId",list:this.state.list,oldDataCenter:e,selectItem:c,style:o.c.dropdownList,onItemClick:this.handleChangeDataCenter,dataPipeModel:this.props.dataPipeModel}),r.createElement(P,{QrCodeType:n,accountId:this.state.accountId,dataPipeModel:this.props.dataPipeModel,lang:this.state.lang})),r.createElement("div",{className:o.c.backLogin},r.createElement("a",{className:o.c.hyperlink,href:"#kingdeeCloud",title:u.substring(1)},u," "))))}}])&&m(n.prototype,c),u&&m(n,u),Object.defineProperty(n,"prototype",{writable:!1}),e}(r.Component);function P(t){var e=g((0,r.useState)(""),2),n=e[0],a=e[1],i=t.lang,l=t.accountId,f=t.QrCodeType;(0,r.useEffect)((function(){(l||s.c.accountId)&&d()}),[i,l]);var d=function(){var e=(0,u.gV)(!1,15),n=(0,p.Qn)(),r={accountId:l||s.c.accountId,token:e,language:i||s.c.lang,QRcodeRedirect:n};"WeChat"===f?Object.assign(r,{scantype:"wxWork"}):Object.assign(r,{scantype:"cloudHub"}),c.YV(r).then((function(e){if(e&&e.errorcode){var n={message:e.description||e.description_cn,level:e.level||1,time:e.time};t.dataPipeModel&&t.dataPipeModel.sendData({type:"ShowNotification",error:n})}a(e.redirectUrl)}))};return r.createElement("div",{className:o.c.publicQrcode},n?r.createElement("iframe",{frameBorder:"0",scrolling:"no",style:{height:"400px"},src:n}):null)}e.default=D},26952:function(){},72628:function(){},99560:function(){},67716:function(){},66756:function(){},87240:function(){},4712:function(){},27292:function(){}}]);