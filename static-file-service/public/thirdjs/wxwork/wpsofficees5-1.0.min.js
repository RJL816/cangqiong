"use strict";var ADDON_VERSION="0.5",pathname=window.location.pathname.replace("index.html",""),pluginList=[{name:"KingdeeWps",addonType:"wps",online:!1,url:"".concat(window.location.origin).concat(pathname,"public/thirdjs/wps/KingdeeWps_").concat(ADDON_VERSION,".7z/"),version:ADDON_VERSION}];function find(n,e){for(var i=0;i<n.length;i++)if(e(n[i],i,n))return n[i]}function openUrl(n){function e(){n&&(new window.WpsClient(window.WpsInvoke.ClientType.wps).InvokeAsHttp("KingdeeWps","dispatcher",{funcs:[{openPanel:{url:n}}]},null,!0),setTimeout(function(){window.close()},300))}(document.getElementById("kd_wps")?installAddon:install)(e)}var install=function(n){installAddon(n)},installAddon=function(i){if(window.WpsAddonMgr)try{window.WpsAddonMgr.getAllConfig(function(n){if(0===n.status){var e;try{e=JSON.parse(n.response)}catch(n){return void installWpsAddinOne(i)}e?find(e,function(n){return"KingdeeWps"===n.name&&n.version===ADDON_VERSION})?null!=i&&i():installWpsAddinOne(i):installWpsAddinOne(i)}else displayErrMessage()})}catch(n){console.log(n,"installAddon")}},publishIndex=0,installWpsAddinOne=function(e){if(window.WpsAddonMgr)try{window.WpsAddonMgr.enable(pluginList[publishIndex],function(n){0!==n.status?displayErrMessage():null!=e&&e()})}catch(n){console.log(n,"installWpsAddinOne")}},displayErrMessage=function(){alert("请先安装或允许浏览器打开 WPS 客户端。")};function getParam(n,e,i){return!!e&&!!(i=new RegExp(i?n+"=([^&]+)":"[?&]"+n+"=(.*)").exec(e))&&!!i[1]&&decodeURI(i[1])}function openWps(n){n&&openUrl(n)}document.addEventListener("DOMContentLoaded",function(){window.focus();var n,e,i,t=getParam("wpsoffice",window.location.href);t&&(n=3,ADDON_VERSION=getParam("addonversion",window.location.href,!0),(i=document.querySelector("div")).innerHTML="倒计时".concat(n,"秒后自动打开"),e=setInterval(function(){0<n?(n-=1,i.innerHTML="倒计时".concat(n,"秒后自动打开")):(clearInterval(e),openWps(t))},1e3),document.querySelector(".tip").addEventListener("click",function(){clearInterval(e),openWps(t)}))});