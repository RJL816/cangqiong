(self.webpackChunkentity_designer=self.webpackChunkentity_designer||[]).push([[276,820,400],{76276:function(e,t,n){"use strict";n.r(t),n.d(t,{EntityDesigner:function(){return Qu}});n(19600);var r=n(47976),a=n.n(r),o=n(39448),l=n.n(o),i=n(18860),c=n.n(i),u=n(55748),s=n.n(u),d=n(7312),f=n.n(d),v=n(54120),p=n.n(v),g=n(63808),m=n.n(g),y=n(45040),h=n.n(y),C=n(2664),E=n(81043),b=n(30112),k=n(72048),x=n(82600),w=n.n(x),N=n(13760),I=n.n(N),A=n(81744),M=n.n(A),S=n(12388),T=n.n(S),L=n(43400),P=n.n(L),R=n(18040),D=n.n(R),V=n(54116),B=P().createContext({});B.displayName="DesignerContext";var F=(0,L.createContext)({});F.displayName="MainCardViewContext";var K=n(12640),O=n.n(K),_=n(75984),j=n.n(_),U=n(98752),H=n(47332),z=n.n(H),q=function(){return[{name:(0,R.getLangMsg)("entityd.nodeType.key0004"),type:"EntryEntity",fieldName:(0,R.getLangMsg)("entityd.nodeType.key0005")},{name:(0,R.getLangMsg)("entityd.nodeType.key0006"),type:"TreeEntryEntity",fieldName:(0,R.getLangMsg)("entityd.nodeType.key0007")}]},W=function(){return[{name:(0,R.getLangMsg)("entityd.nodeType.key0011"),type:"SubEntryEntity",fieldName:(0,R.getLangMsg)("entityd.nodeType.key0008")},{name:(0,R.getLangMsg)("entityd.nodeType.key0012"),type:"TreeSubEntryEntity",fieldName:(0,R.getLangMsg)("entityd.nodeType.key0013")}]},G=function(){return{BillEntity:{name:(0,R.getLangMsg)("entityd.nodeType.key0009"),icon:"danjutou",color:"#5582f3"},BaseEntity:{name:(0,R.getLangMsg)("entityd.nodeType.key0009"),icon:"danjutou",color:"#5582f3"},EntryEntity:{name:(0,R.getLangMsg)("entityd.nodeType.key0005"),icon:"danjuti2",color:"#8EA9E7"},SubEntryEntity:{name:(0,R.getLangMsg)("entityd.nodeType.key0008"),icon:"zidanjuti",color:"#B0BAD1"},TreeEntryEntity:{name:(0,R.getLangMsg)("entityd.nodeType.key0010"),icon:"shuxing",color:"#8EA9E7"},TreeSubEntryEntity:{name:(0,R.getLangMsg)("entityd.nodeType.key0008"),icon:"zidanjuti",color:"#B0BAD1"}}},Q=["BillEntity","EntryEntity","SubEntryEntity","BaseEntity","TreeEntryEntity","TreeSubEntryEntity"],Z=["SubEntryEntity","TreeSubEntryEntity"],Y=["BillEntity","BaseEntity"],X=["EntryEntity","SubEntryEntity","TreeEntryEntity","TreeSubEntryEntity"],J=["EntryEntity","TreeEntryEntity"],$="Id",ee="_Type_",te="Name",ne="ParentId",re="Items",ae="field-selection",oe="entity-selection",le=function(e){return(0,b.c)({},"data-control-id",e[$])},ie=function(e){var t=(0,(0,L.useContext)(B).getKdesignerApi)().selection.setSelect;return(0,L.useCallback)((function(n){n.stopPropagation(),t([e])}),[])},ce=n(45076),ue=n.n(ce),se={UndefinedControl:["Name","Id","FieldName","Key","_Type_"],BillStatusField:["Name","Id","FieldName","Key","_Type_"],BillNoField:["Name","Id","FieldName","Key","_Type_"],CreaterField:["Name","Id","FieldName","Key","_Type_"],ModifierField:["Name","Id","FieldName","Key","_Type_"]},de=n(65624),fe=n.n(de),ve=function(e){return!!e&&!!w()(Y).call(Y,e)},pe=function(e){return!!w()(J).call(J,e)},ge=function(e){var t;return w()(t=["EntryEntity","SubEntryEntity","TreeEntryEntity","TreeSubEntryEntity"]).call(t,e)},me=function(e){return z()(e).call(e,(function(e){return ve(e._Type_)}))},ye=function(e,t){if(!t)return me(e);var n=z()(e).call(e,(function(e){return e.Id===t})),r=null==n?void 0:n._Type_;if(ve(r)||ge(r))return n;var a=n.ParentId;return z()(e).call(e,(function(e){return e.Id===a}))},he=function(e,t){if(!t)return me(e).Id;var n=z()(e).call(e,(function(e){return e.Id===t})),r=null==n?void 0:n._Type_;return ve(r)||ge(r)?n.Id:n.ParentId};function Ce(e,t,n){var r=n.getAllSubControls(t);return!fe()(r).call(r,(function(t){return(null==t?void 0:t[ee])===e}))}var Ee=function(e){var t=e[ee],n=(0,L.useMemo)((function(){return(e=se[t]||se.UndefinedControl)?T()(e)?e:[e]:[];var e}),[t]),r=ue()(n).call(n,(function(t,n){var r=T()(n)?n:[n,n],a=(0,k.c)(r,2),o=a[0],l=a[1];return o in e&&(t[l]=e[o]),t}),{});return r.isDesigner=!0,r};function be(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=be(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=be(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var xe=function(e){var t=le(e),n=ie(e[$]),r=Ee(e);return ke(ke({},t),{},{onClick:n},r)},we=n(71252),Ne=n.n(we),Ie=(0,R.ErrorBoundaryWrap)((function(e){var t=e.id,n=e.code,r=e.name,a=e.typeName,o=e.properties,l=e.kdesignerApi,i=(0,L.useState)(!1),c=(0,k.c)(i,2),u=c[0],s=c[1],d=(0,L.useContext)(B),f=d.getPrefixCls,v=d.prefixCls,p=(0,L.useContext)(F).nodeContentVisibleConfig,g=(0,L.useRef)(null),m=l.data,y=f&&f(v,"controls-entity-node-field"),h=(0,L.useCallback)((function(){return(m.findControl(t)||{}).Inherit?P().createElement("div",{title:(0,R.getLangMsg)("entityd.fieldNode.key0001"),className:y+"-icon"}):P().createElement("div",{className:y+"-noicon"})}),[t]),E=l.selection,x=(0,L.useCallback)((function(e){var n=e.value,r=null==n?void 0:w()(n).call(n,t);s(r)}),[t]);(0,L.useEffect)((function(){var e=E.getSelection(),n=null==e?void 0:w()(e).call(e,t);s(n);var r=E.addSelectChangeListener(x);return function(){r()}}),[]),(0,L.useEffect)((function(){var e,t;u?null===(e=g.current)||void 0===e||e.setAttribute(ae,"true"):null===(t=g.current)||void 0===t||t.removeAttribute(ae)}),[u]);var N=xe(o),I=p.showKey,A=p.showType,M=Ne()((0,b.c)((0,b.c)({},y+"-name",!0),y+"-name-hidekey",!I));return P().createElement("div",(0,C.c)({className:y},N,{ref:g}),h(),P().createElement("div",{className:M,title:r},r),I&&P().createElement("div",{className:y+"-code",title:n},P().createElement("span",null,"（"),P().createElement("span",{className:y+"-code-content"},n),P().createElement("span",null,"）")),A&&P().createElement("div",{className:y+"-type"},a))}),"ed-field-node"),Ae="selectField",Me=27,Se=28,Te=5,Le=10,Pe=48,Re=function(e){var t=e.isHorizontal,n=e.rootClass+(t?"-target-handle-horizontal":"-target-handle-vertical");return P().createElement("div",{className:n},P().createElement("span",null),P().createElement("span",null),P().createElement("span",null),P().createElement("span",null))},De=function(e){var t=e.click,n=e.rootClass,r=(0,L.useCallback)((function(e,n){e.stopPropagation(),t&&t(n)}),[t]);return P().createElement("div",{className:n+"-add-field-buttonbox"},P().createElement("div",{className:n+"-add-field-buttonbox-leftitem",onClick:function(e){return r(e,!1)}},P().createElement(V.Icon,{prefix:"designericon",type:"tianjiaziji",className:n+"-add-field-buttonbox-leftitem-icon"}),P().createElement("span",{className:n+"-add-field-buttonbox-leftitem-title"},(0,R.getLangMsg)("entityd.entityNode.key0003"))))},Ve=function(e){var t=e.listData,n=e.close,r=e.isHorizontal,a=e.addEntityNode,o=e.entitylistRef,l=e.rootClass,i=Ne()((0,b.c)((0,b.c)((0,b.c)({},l+"-entity-type-list",!0),l+"-entity-type-list-lr",r),l+"-entity-type-list-tb",!r)),c=(0,L.useCallback)((function(e,t){e.stopPropagation(),a&&a(t),n&&n()}),[n,a]);return P().createElement("div",{className:i,ref:o},P().createElement("div",{className:l+"-entity-type-list-header"},P().createElement("span",{className:l+"-entity-type-list-header-name"},(0,R.getLangMsg)("entityd.entityNode.key0004")),P().createElement(V.Icon,{prefix:"designericon",type:"guanbi",className:l+"-entity-type-list-header-icon",onClick:n})),P().createElement("div",{className:l+"-entity-type-list-constent"},j()(t).call(t,(function(e,t){return P().createElement("div",{key:t,className:l+"-entity-type-list-constent-item",onClick:function(t){return c(t,e)}},e.name)}))))},Be=(0,R.ErrorBoundaryWrap)((function(e){var t,n=e.data,r=e.id,a=(0,L.useContext)(F),o=a.layoutDirection,l=a.onClickShowMoreBtn,i=a.nodeContentVisibleConfig,c=(0,L.useState)(!1),u=(0,k.c)(c,2),s=u[0],d=u[1],f=(0,L.useState)(!1),v=(0,k.c)(f,2),p=v[0],g=v[1],m=(0,L.useState)(n.showMore),y=(0,k.c)(m,2),h=y[0],E=y[1],x=(0,L.useContext)(R.GlobalConfigContext).showMessage,N="LR"===o,I=n.title,A=(n.entityName,n.entityIcon),M=n.items,S=n.properties,D=n.entityType,K=(0,L.useRef)(null),O=(0,L.useRef)(null),_=(0,L.useContext)(B),H=_.getKdesignerApi,G=_.invokeAction,Q=_.getPrefixCls,Y=_.prefixCls,X=(0,L.useMemo)((function(){return H()}),[]),te=X.meta,re=X.data,ae=X.selection,le=Q&&Q(Y,"controls-entity-node"),ie=X.uiModel,ce=ve(D),ue=pe(D),se=xe(S),de=(0,L.useCallback)((function(e){var t=e.value,n=null==t?void 0:w()(t).call(t,r);if(n)d(n);else{var a=z()(t).call(t,(function(e){var t=ie.getEntityFieldInfo(e)||{};return t[ne]===r&&!ge(t[ee])}));d(void 0!==a)}}),[r]);(0,L.useEffect)((function(){var e=ae.getSelection();de({value:e});var t=ae.addSelectChangeListener(de);return function(){t()}}),[]),(0,L.useEffect)((function(){var e,t,n,r;s?(null===(e=K.current)||void 0===e||e.setAttribute(oe,"true"),null!=K&&null!==(t=K.current)&&void 0!==t&&t.parentElement&&(K.current.parentElement.style.zIndex="4")):(null===(n=K.current)||void 0===n||n.removeAttribute(oe),null!=K&&null!==(r=K.current)&&void 0!==r&&r.parentElement&&(K.current.parentElement.style.zIndex="3"))}),[s]),(0,L.useEffect)((function(){E(n.showMore)}),[n.showMore]);var fe=Ne()((0,b.c)((0,b.c)((0,b.c)({},le+"-add-entity-button",!0),le+"-add-entity-button-lr",N),le+"-add-entity-button-tb",!N)),me=(0,L.useCallback)((function(){p&&g(!1)}),[p]);(0,R.useOnClickOutside)([O],(function(){me()}));var ye=(0,L.useCallback)((function(e){var t=e.type,n=e.fieldName;if(t){var a=r,o=re.findControl(a)[ee];if(te.canAdd(t,o)){var l={_Type_:t,ParentId:a,Name:n,Id:(0,R.createUUid)()};re.addControl((0,R.createAddAction)(l)).then((function(e){var t=e[0].value;ae.setSelect(T()(t)?[t[0][$]]:[t[$]])}))}else x((0,R.getLangMsg)("entityd.entityNode.key0002"))}else x((0,R.getLangMsg)("entityd.entityNode.key0001"))}),[r]),he=(0,L.useCallback)((function(e){p||(e.stopPropagation(),g(!0))}),[p]),Ce=(0,L.useCallback)((function(e){G&&G(Ae,[r,e])}),[r,G]),Ee=(0,L.useMemo)((function(){var e=[];return ce?e=q():ue&&(e=W()),e}),[ce,ue]),be=(0,C.c)({cursor:"auto",border:"0px",background:"none",borderRadius:"0px",opacity:n.hasParent?1:0},N?{height:"11px",width:"6px",left:"-10px"}:{height:"6px",width:"11px",top:"-10px"}),ke=(0,C.c)({cursor:"auto",border:"0px",background:"none",borderRadius:"0",backgroundColor:"#999",opacity:n.hasChildren?1:0},N?{height:"11px",width:"1px"}:{height:"1px",width:"11px"}),we=i.showFullRelationship,Se=Ne()((0,b.c)((0,b.c)((0,b.c)((0,b.c)({},le+"-header-icon",!0),le+"-header-icon-root",ce),le+"-header-icon-entity",w()(J).call(J,D)),le+"-header-icon-subentity",w()(Z).call(Z,D))),Pe=Ne()((0,b.c)((0,b.c)({},le+"-header",!0),le+"-header border-bottom",!we)),Be=M.length>5;return P().createElement("div",(0,C.c)({className:le},se,{ref:K,style:{width:null===(t=n.size)||void 0===t?void 0:t.width}}),P().createElement(U._2,{type:"target",position:N?U.JC.Left:U.JC.Top,id:"a",style:be},P().createElement(Re,{isHorizontal:N,rootClass:le})),P().createElement(U._2,{type:"source",position:N?U.JC.Right:U.JC.Bottom,id:"b",style:ke}),s&&P().createElement(De,{click:Ce,rootClass:le}),P().createElement("div",{className:Pe},P().createElement(V.Icon,{prefix:"designericon",type:A,className:Se}),P().createElement("div",{className:le+"-header-title",title:I},I)),!we&&P().createElement("div",{className:le+"-content",style:{maxHeight:h?Me*Le:Me*Te}},j()(M).call(M,(function(e){var t=e.id,n=e.key,r=e.name,a=e.properties,o=e.typeName;return P().createElement(Ie,{key:t,code:n,name:r,typeName:o,id:t,properties:a,kdesignerApi:X})}))),!we&&Be&&P().createElement("div",{className:le+"-foot",onClick:function(){E(!h),l(r,!h)}},P().createElement(V.Icon,{prefix:"designericon",type:h?"xialajiantoufanxiang":"xialajiantou"})),s&&!w()(Z).call(Z,D)&&P().createElement(V.Icon,{prefix:"designericon",type:"tianjiakapian",className:fe,onClick:he}),p&&P().createElement(Ve,{listData:Ee,close:me,isHorizontal:N,addEntityNode:ye,entitylistRef:O,rootClass:le}))}),"ed-entity-node"),Fe=n(84912),Ke=n.n(Fe),Oe=n(29636),_e=n.n(Oe),je=function(e,t){var n,r=t.getControlMeta,a={x:0,y:0},o=[],l=[],i=e.Items,c=[],u=[],s=z()(i).call(i,(function(e){return ve(e._Type_)}))[$];return f()(i).call(i,(function(e){var t,n,r,l=e.Id,i=e.Name,d=e._Type_,f=e.ParentId,v=e.showMore;w()(Q).call(Q,d)?(r=l===s?1:f===s?2:3,c.push(e),o.push({id:l,position:a,type:"entityNode",data:{title:i,entityName:null===(t=G()[d])||void 0===t?void 0:t.name,entityIcon:null===(n=G()[d])||void 0===n?void 0:n.icon,entityType:d,items:[],properties:e,hasParent:!!f,hasChildren:!1,parentId:f,level:r,showMore:v}})):u.push(e)})),f()(c).call(c,(function(e){var t=e.Id,n=e._Type_,r=e.ParentId;if(r){var a;l.push({id:M()(a="".concat(r,"-")).call(a,t),source:r,target:t,type:"step",style:{stroke:"#999"}});var i=_e()(o).call(o,(function(e){return e.id===r}));o[i].data.hasChildren=!0}else{var c;if(w()(Y).call(Y,n))return;l.push({id:M()(c="".concat(s,"-")).call(c,t),source:s,target:t,type:"step",style:{stroke:"#999"}});var u=_e()(o).call(o,(function(e){return e.id===r}));o[u].data.hasChildren=!0}})),f()(u).call(u,(function(e){var t=e.Id,n=e.Key,a=e.Name,l=e.ParentId,i=e._Type_,c=r(i)[te];if(l){var u=_e()(o).call(o,(function(e){return e.id===l}));u>-1&&o[u].data.items.push({id:t,key:n,name:a,properties:e,typeName:c})}else{var d=_e()(o).call(o,(function(e){return e.id===s}));d>-1&&o[d].data.items.push({id:t,key:n,name:a,properties:e,typeName:c})}})),M()(n=[]).call(n,o,l)},Ue=n(39568),He=n.n(Ue);function ze(){return"Win32"==window.navigator.platform||"Windows"==window.navigator.platform}function qe(){return"Mac68K"==window.navigator.platform||"MacPPC"==window.navigator.platform||"Macintosh"==window.navigator.platform||"MacIntel"==window.navigator.platform}var We;qe()||("X11"!=window.navigator.platform||ze()||qe())&&(He()(We=String(window.navigator.platform)).call(We,"Linux")>-1||ze());function Ge(e){return qe()?e.metaKey:e.ctrlKey}var Qe=n(39832),Ze=n.n(Qe),Ye="formdesigner.CopyContent",Xe=function(e){window.localStorage.setItem(Ye,Ze()(e))},Je=function(){var e=window.localStorage.getItem(Ye);return e&&(e=JSON.parse(e)),e},$e=function(){return{setCopyContent:Xe,getCopyContent:Je}};function et(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=et(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=et(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var nt=function(e,t,n,r,a,o){var l=n.getActiveSelectedId,i=t.getRootId(),c=l(),u=t.findControl(c),s=e,d=s.Id,f=s.Key,v=s._Type_,p=u.Id,g=u._Type_,m=s[ne]||i,y=u[ne]||i;if(w()(X).call(X,v)){var h=r.getControlMeta(g).IsContainer,C=void 0!==h&&h,E=r.getControlMeta(v).IsContainer,b=void 0!==E&&E;if(C){if(o){var k=(0,R.createUUid)();return{newControl:tt(tt({},s),{},{ParentId:y,Id:k,Key:f+"1",Inherit:!1}),index:t.findControlIndex(p)+1}}if(a(v,g,{Id:d,IsContainer:b,ParentId:m},{Id:p,IsContainer:C})){var x=(0,R.createUUid)();return{newControl:tt(tt({},s),{},{ParentId:p,Id:x,Key:f+"1",Inherit:!1}),index:-1}}return!1}return!1}if(w()(Q).call(Q,g)){var N=r.getControlMeta(g).IsContainer,I=void 0!==N&&N,A=r.getControlMeta(v).IsContainer;if(a(v,g,{Id:d,IsContainer:void 0!==A&&A,ParentId:m},{Id:p,IsContainer:I})){return{newControl:tt(tt({},s),{},{ParentId:p,Id:(0,R.createUUid)(),Key:f+"1",FieldName:f+"1",Inherit:!1}),index:-1}}return!1}var M=t.findControl(y),S=M.Id,T=M._Type_,L=r.getControlMeta(T).IsContainer;return!!a(v,T,{Id:d,IsContainer:!1,ParentId:m},{Id:S,IsContainer:void 0!==L&&L})&&{newControl:tt(tt({},s),{},{ParentId:y,Id:(0,R.createUUid)(),Key:f+"1",FieldName:f+"1",Inherit:!1}),index:t.findControlIndex(p)+1}},rt=function(e,t,n,r,a,o){if(w()(r).call(r,e)){var l=at(e,n);n.deleteControl((0,R.createDeleteAction)(e)).then((function(){t([l])}))}else{var i=n.findControl(e),c=i.Key,u=i._Type_;if(i.Inherit)return void o((0,R.getLangMsg)("entityd.toolbarUtil.key0001"));a("deleteConfirm",[c,e,ge(u)])}},at=function(e,t){for(var n,r,a=t.getAllSiblings(e),o=_e()(a).call(a,(function(t){return t[$]===e})),l=w()(X).call(X,a[o][ee]),i=o-1;i>=0;i--)if(w()(X).call(X,a[i][ee])===l){n=a[i];break}for(var c=o+1;c<a.length;c++)if(w()(X).call(X,a[c][ee])===l){r=a[c];break}var u=t.getParentControlId(e),s=e;return n?s=n[$]:r?s=r[$]:u&&(s=u),s},ot=function(e,t){var n=[];return f()(e).call(e,(function(e){var r=t.getAllSubControls(e)||[];n=M()(n).call(n,r)})),n};function lt(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=lt(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=lt(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var ct=qe(),ut="entity-designer-entity-node-nav-tool",st=(0,R.ErrorBoundaryWrap)((function(){var e,t,n,r,a=(0,L.useContext)(B),o=a.getKdesignerApi,l=a.invokeAction,i=(0,L.useState)(!1),u=(0,k.c)(i,2),s=u[0],d=u[1],v=(0,L.useState)(!1),p=(0,k.c)(v,2),g=p[0],m=p[1],y=o(),h=y.data,C=y.selection,E=(0,L.useContext)(R.GlobalConfigContext),x=E.showMessage,N=E.controlsAddedByForntEnd,I=E.canAddCallback,A=(0,L.useContext)(R.DataFactoryContext).metaApi,S=$e(),D=S.setCopyContent,F=S.getCopyContent,K=C.getSelection,O=(C.setSelect,h.canUndo()),_=h.canRedo(),j=h.getRootId(),U=(0,L.useCallback)((function(e){var t=e.value;if(t!==e.oldValue&&1===t.length)if(w()(t).call(t,j))d(!0),m(!1);else{var n=t[0],r=h.findControl(n)[ee];m(w()(X).call(X,r)),d(!1)}else d(!1),m(!1)}),[j]);(0,L.useEffect)((function(){var e=C.getSelection();if(1===e.length)if(w()(e).call(e,j))d(!0),m(!1);else{var t=e[0],n=h.findControl(t)[ee];m(w()(X).call(X,n)),d(!1)}else d(!1),m(!1);var r=C.addSelectChangeListener(U);return function(){r()}}),[]);var H=(0,L.useCallback)((function(e){var t=!1,n=!0;switch(e){case 1:t=!O,n=O;break;case 2:t=!_,n=_;break;case 3:t=s||g,n=!(s||g);break;case 4:t=s,n=!s;break;default:t=!1,n=!0}return{disable:t,command:n}}),[s,_,O,g]),z=(0,L.useCallback)((function(){H(2).disable||_&&h.redo()}),[_,H]),q=(0,L.useCallback)((function(){if(!H(1).disable&&O){h.undo();var e=h.getRootId();C.setSelect(e)}}),[O,H]),W=(0,L.useCallback)((function(){if(!H(3).disable){var e=K();1===e.length?h.moveControl(e[0],"forward"):x((0,R.getLangMsg)("entityd.listTree.key0002"))}}),[H]),G=(0,L.useCallback)((function(){if(!H(3).disable){var e=K();1===e.length?h.moveControl(e[0],"back"):x((0,R.getLangMsg)("entityd.listTree.key0002"))}}),[H]),Q=(0,L.useCallback)((function(){if(!H(4).disable){var e=C.getSelection,t=C.setSelect,n=h.getRootId(),r=e();r.length>0&&f()(r).call(r,(function(e){n!==e?rt(e,t,h,N,l,x):x((0,R.getLangMsg)("entityd.tips.key0001"))}))}}),[H]),Z=(0,L.useCallback)((function(){if(!H(4).disable){var e=K()||[],t=ot(e,h);D(t)}}),[H]),Y=(0,L.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F();if(!H(0).disable){var n=!0===e;if(T()(t)){var r=[],a=-1,o=c()(t).call(t,(function(e){var t=e[ee],n=A.getControlMeta(t).IsContainer;return void 0!==n&&n}));if(o.length>0){var l=nt(o[0],h,C,A,I,n);if(!1===l)x((0,R.getLangMsg)("entityd.listTree.key0003"));else{var i=l.newControl,u=l.index;r.push(i),a=u;var s=i.Id;s&&f()(t).call(t,(function(e){var t=e.Key,n=e._Type_;if((e[ne]||j)===o[0][$]&&!w()(X).call(X,n)){var a=it(it({},e),{},{ParentId:s,Id:(0,R.createUUid)(),Key:t+"1",FieldName:t+"1",Inherit:!1});r.push(a)}}))}}else f()(t).call(t,(function(e){var t=nt(e,h,C,A,I,n);if(!1===t)x((0,R.getLangMsg)("entityd.listTree.key0003"));else{var o=t.newControl,l=t.index;r.push(o),a=l}}));var d={index:a};h.addControl((0,R.createPasteAction)(r,d))}}}),[H]),J=(0,L.useCallback)((function(){if(!H(4).disable){var e=K()||[],t=ot(e,h);Y(!0,t)}}),[Z,Y,H]),te=(0,L.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=H(e),a=r.disable,o=r.command;return t?Ne()((0,b.c)((0,b.c)({},"".concat(ut,"-buttonbox-operation-disable-icon"),a),"".concat(ut,"-buttonbox-operation-btn-icon"),o)):n?Ne()((0,b.c)((0,b.c)((0,b.c)({},"".concat(ut,"-buttonbox-operation-disable"),a),"".concat(ut,"-buttonbox-last-operation"),!0),"".concat(ut,"-buttonbox-operation-btn"),o)):Ne()((0,b.c)((0,b.c)({},"".concat(ut,"-buttonbox-operation-disable"),a),"".concat(ut,"-buttonbox-operation-btn"),o))}),[H]);return P().createElement("div",{className:ut},P().createElement("div",{className:ut+"-buttonbox"},P().createElement("div",{title:M()(e="".concat((0,R.getLangMsg)("entityd.toolbarView.key0001"),"\n")).call(e,ct?"⌘+Z":"Ctrl+Z"),className:te(1),onClick:q},P().createElement(V.Icon,{prefix:"designericon",type:"chexiao",className:te(1,!0)})),P().createElement("div",{title:M()(t="".concat((0,R.getLangMsg)("entityd.navToolBar.key0001"),"\n")).call(t,ct?"⌘+Y":"Ctrl+Y"),className:te(2,!1,!0),onClick:z},P().createElement(V.Icon,{prefix:"designericon",type:"zhongzuo",className:te(2,!0)}))),P().createElement("div",{className:ut+"-buttonbox"},P().createElement("div",{title:(0,R.getLangMsg)("entityd.navToolBar.key0002"),onClick:W,className:te(3)},P().createElement(V.Icon,{prefix:"designericon",type:"zuiqian",className:te(3,!0)})),P().createElement("div",{title:(0,R.getLangMsg)("entityd.navToolBar.key0003"),onClick:G,className:te(3,!1,!0)},P().createElement(V.Icon,{prefix:"designericon",type:"zuihou",className:te(3,!0)}))),P().createElement("div",{className:ut+"-buttonbox"},P().createElement("div",{title:M()(n="".concat((0,R.getLangMsg)("entityd.navToolBar.key0004"),"\n")).call(n,ct?"⌘+C":"Ctrl+C"),onClick:Z,className:te(4)},P().createElement(V.Icon,{prefix:"designericon",type:"fuzhi",className:te(4,!0)})),P().createElement("div",{title:M()(r="".concat((0,R.getLangMsg)("entityd.navToolBar.key0005"),"\n")).call(r,ct?"⌘+V":"Ctrl+V"),onClick:Y,className:te(0,!1,!0)},P().createElement(V.Icon,{prefix:"designericon",type:"zhantie",className:te(0,!0)}))),P().createElement("div",{className:ut+"-buttonbox"},P().createElement("div",{title:(0,R.getLangMsg)("entityd.navToolBar.key0006"),onClick:J,className:te(4)},P().createElement(V.Icon,{prefix:"designericon",type:"zhongfu",className:te(4,!0)})),P().createElement("div",{title:"".concat((0,R.getLangMsg)("entityd.navToolBar.key0007"),"\nDelete"),onClick:Q,className:te(4,!1,!0)},P().createElement(V.Icon,{prefix:"designericon",type:"shanchu",className:te(4,!0)}))))}),"ed-nav-toolbar");var dt=(0,R.ErrorBoundaryWrap)((function(){var e=(0,L.useContext)(B),t=e.getPrefixCls,n=e.prefixCls,r=e.changeDesignerView,a=e.getKdesignerApi,o=t&&t(n,"top-view-right"),l=a().views;return P().createElement("div",{className:o},P().createElement("div",{title:(0,R.getLangMsg)("entityd.navToolBarRight.key0001"),className:o+"-change-view",onClick:function(){r(1),l.setViewHideState("top")(!0),l.setViewHideState("left")(!0)}},P().createElement(V.Icon,{prefix:"designericon",type:"guanxishitu",className:o+"-change-view-icon"})))}),"ed-nav-toolbar-right"),ft=function(){var e=(0,L.useContext)(R.ConfigContext),t=e.getPrefixCls,n=e.prefixCls,r=(0,L.useContext)(B),a=r.getPrefixCls,o=r.prefixCls,l=t&&t(n),i="".concat(l,"-top-view-main"),c=a&&a(o),u="".concat(c,"-top-view-main"),s=P().createElement("div",{className:u},P().createElement(st,null),P().createElement(dt,null));return P().createElement(R.ViewHeader,{content:s,portalId:i})};function vt(e,t){var n=function(e){var t=e.data.title,n=void 0===t?"":t,r=document.getElementById("_entityNodeTitle_");r||((r=document.createElement("div")).setAttribute("id","_entityNodeTitle_"),r.setAttribute("style","height:36px; border: 1px solid red; padding-left:32px; padding-right:12px; min-width:200px; max-width:320px; position:absolute; left:-9999px; top:0px; display:flex;"),document.body.appendChild(r));var a='<div style="margin:8px; font-size:14px;">'.concat(n,"</div>");r.innerHTML=(0,R.xssFilters)(a);var o=r.getBoundingClientRect(),l=o.width,i=o.height;return{width:l,height:i}}(e),r=function(e,t){var n=e.data,r=n.items,a=void 0===r?[]:r,o=n.showMore,l=t.showKey,i=t.showType,c=0;f()(a).call(a,(function(e){var t=e.name,n=e.key,r=e.typeName,a=document.getElementById("_fieldNode_");a||((a=document.createElement("div")).setAttribute("id","_fieldNode_"),a.setAttribute("style","height:27px; border: 1px solid red; padding-left:22px; padding-right:20px; min-width:200px; max-width:320px; position:absolute; left:-9999px; top:40px; font-size: 12px; display:flex;"),document.body.appendChild(a));var o="<div>".concat(t,"</div>");o+=i?"<div>（".concat(r,"）</div>"):"",o+=l?"<div>（".concat(n,"）</div>"):"",a.innerHTML=(0,R.xssFilters)(o);var u=a.getBoundingClientRect().width;c=Math.max(c,u)}));var u=0;u=a.length<=Te?Math.max(Me*a.length,Pe):a.length<=Le?o?Me*a.length+Se:Me*Te+Se:o?Me*Le+Se:Me*Te+Se;return{width:c,height:u}}(e,t);return{width:Math.max(n.width,r.width),height:n.height+r.height}}function pt(e,t,n,r){switch(n){case 2:case 3:var a=function(e,t){var n=c()(e).call(e,(function(e){return e.data.level===t})),r=[],a=[];return f()(n).call(n,(function(e){var t=e.data.size,n=t.height,o=t.width;r.push(n),a.push(o)})),{maxHeight:Math.max.apply(Math,r),maxWidth:Math.max.apply(Math,a)}}(e,n),o=a.maxHeight,l=a.maxWidth;return{x:t.x-(r?l:t.width)/2,y:t.y-(r?t.height:o)/2};default:return{x:t.x-t.width/2,y:t.y-t.height/2}}}var gt=n(71536),mt=n.n(gt);var yt=(0,R.ErrorBoundaryWrap)((function(e){var t=e.config,n=e.mousePosition,r=e.onContextItemClick,a=e.closeContextMenu,o=(0,L.useContext)(B),l=o.getPrefixCls,i=o.prefixCls,c=l&&l(i,"main-view"),u=(0,L.useState)([]),s=(0,k.c)(u,2),d=s[0],f=s[1],v=(0,L.useRef)(null),p="1",g="2";return(0,R.useOnClickOutside)([v],(function(){a()})),(0,L.useEffect)((function(){var e=[],n=t.showType,r=t.showKey;n&&e.push(p),r&&e.push(g),f(e)}),[t]),(0,gt.createPortal)(P().createElement("div",{className:c+"-context-menu",style:{left:n.x,top:n.y},ref:v},P().createElement(V.Checkbox.Group,{onChange:function(e){var t=!1,n=!1;w()(e).call(e,p)&&(t=!0),w()(e).call(e,g)&&(n=!0),r(t,n)},value:d,checkboxType:"default",className:c+"-context-menu-checkbox"},P().createElement(V.Checkbox,{className:c+"-context-menu-item",value:p},(0,R.getLangMsg)("entityd.contextMenu.key0001")),P().createElement(V.Checkbox,{className:c+"-context-menu-item",value:g},(0,R.getLangMsg)("entityd.contextMenu.key0002")))),document.body)}),"ed-context-menu"),ht=n(67928),Ct=n.n(ht),Et=["Key","Name","_Type_","Id","ParentId"],bt=(0,R.ErrorBoundaryWrap)((function(e){var t=e.kdesignerApi,n=e.tableData,r=e.allselectedArr,a=(0,L.useContext)(R.GlobalConfigContext),o=a.showMessage,l=a.controlsAddedByForntEnd,i=a.canAddCallback,u=(0,L.useContext)(B),s=u.changeDesignerView,d=u.getPrefixCls,v=u.prefixCls,p=u.invokeAction,g=t.selection,m=t.data,y=(0,L.useRef)(null),h=t.meta,C=t.views,E=g.setSelect,b=g.getActiveSelectedId,x=(0,L.useState)([]),N=(0,k.c)(x,2),I=N[0],A=N[1],M=(0,L.useState)([]),S=(0,k.c)(M,2),T=S[0],D=S[1],F=(0,L.useState)([]),K=(0,k.c)(F,2),O=K[0],_=K[1],j=(0,L.useState)(""),U=(0,k.c)(j,2),H=U[0],z=U[1],q=d&&d(v,"list-view-table");(0,L.useEffect)((function(){var e=function(e,t,n){var r=[];return f()(e).call(e,(function(e){var a=e.properties,o={};f()(t).call(t,(function(e){if("_Type_"===e){var t=n.getControlMeta(a[e])[te];o[e]=t}else o[e]=a[e]})),r.push(o)})),r}(n,Et,h);(0,ht.isEqual)(I,e)||(A(e),D(e),z(""))}),[n,I]),(0,L.useEffect)((function(){W(r)}),[r]);var W=(0,L.useCallback)((function(e){if(!(0,ht.isEqual)(e,O)){var t=[];f()(n).call(n,(function(n){null!=e&&w()(e).call(e,n.id)&&t.push(n.id)})),_(t)}}),[O,n]),G={type:"radio",value:O,onChange:function(e){E(e),_(e)},clickArea:"row"},Q=(0,L.useCallback)((function(){var e,t=b(),n=(null===(e=T[0])||void 0===e?void 0:e.ParentId)||t;p&&p(Ae,[n,!1])}),[T,p]),Z=(0,L.useCallback)((function(){0!==O.length?f()(O).call(O,(function(e){rt(e,E,m,l,p,o)})):o((0,R.getLangMsg)("entityd.listTable.key0004"))}),[O,p]),Y=(0,L.useCallback)((function(){if(0!==O.length){var e=ot(O,m),t=[],n=-1;f()(e).call(e,(function(e){var r=nt(e,m,g,h,i,!0);if(!1===r)o((0,R.getLangMsg)("entityd.listTable.key0005"));else{var a=r.newControl,l=r.index;t.push(a),n=l}}));var r={index:n};m.addControl((0,R.createPasteAction)(t,r))}else o((0,R.getLangMsg)("entityd.listTable.key0004"))}),[O,p]);return P().createElement("div",{className:q},P().createElement("div",{className:q+"-topbarbox"},P().createElement("div",{title:(0,R.getLangMsg)("entityd.listTable.key0006"),className:q+"-topbarbox-changeview",onClick:function(){s(0),C.setViewHideState("top")(!1),C.setViewHideState("left")(!1)}},P().createElement(V.Icon,{prefix:"designericon",type:"liebiaoshitu",className:q+"-topbarbox-changeview-icon"}))),P().createElement("div",{className:q+"-tabelbox"},P().createElement("div",{className:q+"-tabelbox-tabheader"},P().createElement("div",{className:q+"-tabelbox-tabheader-searchbox"},P().createElement(V.Icon,{prefix:"designericon",type:"sousuo",className:q+"-tabelbox-tabheader-searchbox-icon"}),P().createElement("input",{type:"text",ref:y,value:H,placeholder:(0,R.getLangMsg)("entityd.listTable.key0007"),onChange:function(){var e=y.current.value;z(e)},onKeyDown:function(e){if(13===e.keyCode){var t=[];t=""===H?I:function(e,t){var n=c()(t).call(t,(function(t){var n,r;return w()(n=t.Key).call(n,e)||w()(r=t[te]).call(r,e)}));return n||[]}(H,I),D(t),y.current.blur()}},className:q+"-tabelbox-tabheader-searchbox-input"}),H&&P().createElement(V.Icon,{prefix:"designericon",type:"shurukuangquanqing",className:q+"-tabelbox-tabheader-searchbox-icon",onClick:function(){z(""),D(I)}})),P().createElement("div",{className:q+"-tabelbox-tabheader-toolbarbox"},P().createElement("span",{className:q+"-tabelbox-tabheader-toolbarbox-button",onClick:Q},(0,R.getLangMsg)("entityd.listTable.key0008")),P().createElement("span",{className:q+"-tabelbox-tabheader-toolbarbox-button",onClick:Y},(0,R.getLangMsg)("entityd.listTable.key0009")),P().createElement("span",{className:q+"-tabelbox-tabheader-toolbarbox-button",onClick:Z},(0,R.getLangMsg)("entityd.listTable.key0010")))),P().createElement(V.Table,{dataSource:T,columns:[{code:"Key",name:(0,R.getLangMsg)("entityd.listTable.key0001"),width:200,features:{sortable:!0,filterable:!0}},{code:"Name",name:(0,R.getLangMsg)("entityd.listTable.key0002"),width:220,features:{sortable:!0,filterable:!0}},{code:"_Type_",name:(0,R.getLangMsg)("entityd.listTable.key0003"),width:150,features:{sortable:!0,filterable:!0}}],filter:{onChangeFilters:function(e){}},sort:{mode:"single",highlightColumnWhenActive:!0,sortIconHoverShow:!0,onChangeSorts:function(e){}},rowSelection:G,primaryKey:"Id",style:{flexShrink:1,minHeight:0}})))}),"ed-list-table"),kt=n(34984),xt=n(96432),wt=n.n(xt),Nt=n(49464),It=n.n(Nt),At=n(30479),Mt=n.n(At),St=n(89843),Tt=n.n(St),Lt=n(59312),Pt=n.n(Lt),Rt=n(11872),Dt=n.n(Rt),Vt=n(88836),Bt=n.n(Vt),Ft=n(5848),Kt=n.n(Ft),Ot=n(97440),_t=n.n(Ot),jt=n(64248),Ut=n.n(jt),Ht=["children","title","key"],zt=["title","key","icon","disabled","checkable","pos","level","hasChildNode","selectable"];function qt(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return Wt(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gt(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qt(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Gt(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Gt(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Zt=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0;return t&&f()(t).call(t,(function(t,o){var l,i=t.children,c=t.title,u=t.key,s=(0,kt.c)(t,Ht),d=a?M()(l="".concat(a,"-")).call(l,o):"".concat(o),f=i&&i instanceof Array&&i.length>0;n.push(Qt({title:c,key:u,pos:d,hasChildNode:f,level:r},s));var v=r;v++,e(i,n,v,d)})),n},Yt=function(e,t){return null==e?void 0:w()(e).call(e,t)},Xt=function(e){var t=[];return f()(e).call(e,(function(n){var r=n.pos,a=function(e,t){for(var n=!0;wt()(t).call(t,"-")>-1&&n;){t=t.substring(0,wt()(t).call(t,"-"));var r=z()(e).call(e,(function(e){return e.pos===t}));n=null==r?void 0:r.expand}return n}(e,r);a&&t.push(n)})),t},Jt=function(e,t,n){var r=He()(e).call(e,t),a=e.substr(r+t.length,1);return!(!It()(e).call(e,t)||"-"!==a||!n)},$t=function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=c()(e).call(e,(function(e){return Jt(e.pos,r,o?r!==e.pos:a===e.level-1)})),i=[],u=[];return f()(l).call(l,(function(e){i.push(Yt(n,e.key)),u.push(Yt(t,e.key))})),{checked:fe()(i).call(i,(function(e){return!0===e})),halfChecked:fe()(u).call(u,(function(e){return!0===e}))}},en=function(e,t,n,r,a){var o=c()(e).call(e,(function(e){return Jt(e.pos,n,a?n!==e.pos:r===e.level-1)})),l=[];return f()(o).call(o,(function(e){l.push(Yt(t,e.key))})),Mt()(l).call(l,(function(e){return!0===e}))},tn=function(e,t){var n=[];return f()(e).call(e,(function(e){var r=e.title,a=e.key,o=e.icon,l=e.disabled,i=e.checkable,c=e.pos,u=e.level,s=e.hasChildNode,d=e.selectable,f=(0,kt.c)(e,zt),v=function(e,t){return null==e?void 0:w()(e).call(e,t)}(t,a),p=v||!1;n.push(Qt({title:r,key:a,level:u,pos:c,hasChildNode:s,expand:p,icon:o,disabled:l,checkable:i,selectable:d},f))})),n},nn=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Tt()(new(Pt())(M()(e=[]).call(e,(0,E.c)(t),(0,E.c)(n))))},rn=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[];wt()(t).call(t,"-")>-1;)t=t.substring(0,wt()(t).call(t,"-")),f()(e).call(e,(function(e){e.pos===t&&n.push(e.key)}));return n},an=function(e,t){var n=z()(e).call(e,(function(e){return e.key===t}));return null==n?void 0:n.pos},on=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,E.c)(t),o=[],l=function(n){f()(e).call(e,(function(l){if(l.level===n){var i=Yt(a,l.key),c=l.hasChildNode&&$t(e,o,a,l.pos,l.level,r),u=l.hasChildNode&&en(e,a,l.pos,l.level,r),s=null==c?void 0:c.checked,d=null==c?void 0:c.halfChecked,f=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=!1;wt()(n).call(n,"-")>-1&&!r;){n=n.substring(0,wt()(n).call(n,"-"));var a=z()(e).call(e,(function(e){return e.pos===n}));r=Yt(t,a.key)}return r}(e,t,l.pos),v=i||f||u;v&&a.push(l.key),(s||d)&&!v&&o.push(l.key)}}))},i=n;i>=0;i--)l(i);return{checkedKeys:Tt()(new(Pt())(a)),halfCheckedKeys:Tt()(new(Pt())(o))}},ln=function(e){var t=(0,E.c)(e);return{checkedKeys:Tt()(new(Pt())(t)),halfCheckedKeys:[]}},cn=function(e,t){return Jt(t,e,e!==t)},un=function(e,t){return cn(t,e)},sn=function(e,t){var n=(0,C.c)([],e);return f()(t).call(t,(function(e){var t=He()(n).call(n,e);t>-1&&Dt()(n).call(n,t,1)})),n},dn=function(e,t,n,r,a,o){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=(null==t?void 0:M()(t).call(t,l))||(null==n?void 0:M()(n).call(n,l))||[];if(r)i=function(e){var t=[];return f()(e).call(e,(function(e){t.push(e.key)})),t}(e);else{if(a){var u=function(e){var t="";if(!(c()(e).call(e,(function(e){var t;return-1===(null===(t=e.pos)||void 0===t?void 0:He()(t).call(t,"-"))})).length>1))return f()(e).call(e,(function(e){"0"===e.pos&&(t=e.key)})),t}(e);u&&(i=M()(i).call(i,u))}if(o){var s=[];f()(i).call(i,(function(t){s.push.apply(s,(0,E.c)(rn(e,t)))})),i=M()(i).call(i,s)}}return Tt()(new(Pt())((0,E.c)(i)))},fn={Tree:{defaultExpandAll:!1,defaultExpandRoot:!1,checkable:!1,checkStrictly:!1,disabled:!1,draggable:!1,virtual:!0,switcherIcon:function(){return P().createElement(V.Icon,{type:"arrow-right-solid"})}},TreeNode:{}},vn=function(e,t,n){var r=fn[e],a=t&&t[e]||{};return(0,C.c)({},r,a,n||{})};function pn(e,t,n){var r,a,o=new(Bt()),l=function(e){if(o.has(e))return o.get(e);var t={id:e,parent:null,item:null,children:[]};return o.set(e,t),t},i=qt(n);try{for(i.s();!(a=i.n()).done;){var u=a.value,s=l(u[t]),d=l(u[e]);d.parent=s,s.children.push(d),d.item=u}}catch(e){i.e(e)}finally{i.f()}var v,p,g,m=(v=c()(r=Tt()(Kt()(o).call(o))).call(r,(function(e){return null==e.parent})),p=function(e){return e.children},g=[],f()(v).call(v,(function(e,t){g.push.apply(g,(0,E.c)(p(e,t,v)))})),g);return function e(t){var n,r=[],a=qt(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;0===o.children.length?r.push(o.item):r.push(Qt(Qt({},o.item),{},{children:e(o.children)}))}}catch(e){a.e(e)}finally{a.f()}return r}(m)}var gn=function(e,t,n,r,a,o,l,i){var c=[];if(l){var u=an(e,l);c=rn(e,u)}var s=P().useMemo((function(){return dn(e,t,n,r,a,o,c)}),[e,t,n,r,a,o,l]),d=P().useMemo((function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(null==e?void 0:M()(e).call(e,t))||[];return Tt()(new(Pt())((0,E.c)(n)))}(t,c)}),[t]),f=P().useState(s),v=(0,k.c)(f,2),p=v[0],g=v[1];return P().useEffect((function(){g(i?s:d)}),[d,s]),[p,g]},mn=["nodeKey","prefixCls","selectable","checkable","className","icon","switcherIcon","disabled","draggable","pos","checked","level","getDragNode","hasChildNode","expand","title","showLine","showIcon","selected","setDragNode","style","indeterminate","estimatedItemSize","onExpand","onCheck","onDragStart","onDragOver","onDragLeave","onDragEnter","onDragEnd","onDrop","onSelect","addEntityNode","deleteEntityNode"];function yn(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=yn(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=yn(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Cn=P().forwardRef((function(e,t){var n,r=vn("TreeNode",{},e),a=r.nodeKey,o=(r.prefixCls,r.selectable),l=r.checkable,i=r.className,c=r.icon,u=r.switcherIcon,s=r.disabled,d=r.draggable,f=r.pos,v=r.checked,p=r.level,g=(r.getDragNode,r.hasChildNode),m=r.expand,y=r.title,h=r.showLine,C=r.showIcon,E=r.selected,x=(r.setDragNode,r.style),N=r.indeterminate,I=r.estimatedItemSize,A=r.onExpand,S=r.onCheck,D=(r.onDragStart,r.onDragOver,r.onDragLeave,r.onDragEnter,r.onDragEnd,r.onDrop,r.onSelect),B=r.addEntityNode,F=r.deleteEntityNode,K=(0,kt.c)(r,mn),O=P().useMemo((function(){return hn({selectable:o,checkable:l,expand:m,key:a,level:p,title:y,disabled:s,draggable:d,checked:v,pos:f,hasChildNode:g,indeterminate:N,icon:c,switcherIcon:u,showIcon:C,selected:E},K)}),[o,l,m,a,p,y,s,d,v,f,g,N,c,u,C,E]),_=r[ee],j=ve(_),U=pe(_),H=(0,L.useState)(!1),z=(0,k.c)(H,2),G=z[0],Q=z[1],Y=(0,L.useRef)(null),X=P().useRef(null),J=function(e){var t=P().useState(e),n=(0,k.c)(t,2),r=n[0],a=n[1];return(0,L.useEffect)((function(){a(e)}),[e]),[r,function(e){return a(e)}]}(m),te=(0,k.c)(J,2),ne=te[0],re=te[1],ae="entity-designer-tree-node",oe=function(e){return"function"==typeof e?e(hn({},{selectable:o,checkable:l,disabled:s,title:y,draggable:d,checked:v,hasChildNode:g,expand:m,nodeKey:a,icon:e,switcherIcon:u,showIcon:C,selected:E,indeterminate:N})):e},le=P().useCallback((function(e){var t=e.target.checked;S&&S(a,t,O,e,f)}),[S,a,O,f]),ie=P().useCallback((function(e){o&&!s&&D&&D(e,O,a)}),[D,o,s,O,a]);P().useImperativeHandle(t,(function(){return{selectNode:ie}}));var ce=P().useCallback((function(e){e.stopPropagation(),ie(e)}),[re,ne,A,a,O,ie]),ue=P().useCallback((function(e){e.stopPropagation(),re(!ne),A&&A(a,!ne,O)}),[re,ne,A,a,O]),se=P().useCallback((function(e){e.stopPropagation(),Q(!0)}),[]),de=P().useCallback((function(e){e.stopPropagation(),F([r[$]])}),[r]),fe=(0,L.useCallback)((function(){G&&Q(!1)}),[G]);(0,R.useOnClickOutside)([Y],(function(){fe()}));var ge,me,ye=(0,L.useMemo)((function(){var e=[];return j?e=q():U&&(e=W()),e}),[j,U]);return P().createElement("div",{className:Ne()("".concat(ae,"-item"),(0,b.c)({},"".concat(ae,"-item-hover"),!s&&o),(0,b.c)({},"".concat(ae,"-selected"),E&&o&&!s),(0,b.c)({},"".concat(ae,"-disabled"),s),(0,b.c)({},"".concat(ae,"-opened"),ne),M()(n="".concat(ae,"-item-")).call(n,a),i),style:hn({height:"".concat(I)},x),onClick:ce},P().createElement(P().Fragment,null,P().createElement("div",{draggable:d&&!s,className:Ne()((0,b.c)((0,b.c)({},"".concat(ae,"-draggabled"),!0),"".concat(ae,"-root"),!0)),ref:X},function(){for(var e=[],t=Ne()((0,b.c)((0,b.c)({},"".concat(ae,"-indent"),!0),"".concat(ae,"-indent-line"),!!h)),n=0;n<p;n++)e.push(P().createElement("span",{className:t,key:n,style:{height:"".concat(I)}},"    "));return e}(),g?T()(u)&&2===u.length?P().createElement("span",{className:Ne()("".concat(ae,"-icon")),onClick:ue},oe(ne?u[1]:u[0])):P().createElement("span",{className:Ne()("".concat(ae,"-icon"),(0,b.c)((0,b.c)({},"".concat(ae,"-animation-expand"),ne),"".concat(ae,"-animation-collapse"),!ne)),onClick:ue},oe(u||P().createElement(V.Icon,{type:"arrow-right-solid"}))):P().createElement("span",{className:"".concat(ae,"-icon-hidden")}),C&&P().createElement("span",{className:"".concat(ae,"-leaf-icon")},oe(c)),l?P().createElement(V.Checkbox,{onChange:le,checked:v,indeterminate:!s&&N,disabled:s},P().createElement("span",{className:Ne()("".concat(ae,"-title"),(0,b.c)({},"".concat(ae,"-title-disabled"),s)),title:y},y)):P().createElement("span",{className:Ne()("".concat(ae,"-title"),(0,b.c)({},"".concat(ae,"-title-disabled"),s)),title:y},y),E&&(ge=Ne()((0,b.c)({},"".concat(ae,"-right-addIcon"),!0)),me=Ne()((0,b.c)({},"".concat(ae,"-right-deleteIcon"),!0)),P().createElement("span",{className:"".concat(ae,"-right-icon")},!w()(Z).call(Z,r[ee])&&P().createElement("span",{title:"".concat((0,R.getLangMsg)("entityd.treeNode.key0001")),className:ge,onClick:se},E&&P().createElement(V.Icon,{prefix:"designericon",type:"tianjia3"})),!ve(r[ee])&&P().createElement("span",{title:"".concat((0,R.getLangMsg)("entityd.treeNode.key0002")),className:me,onClick:de},E&&P().createElement(V.Icon,{prefix:"designericon",type:"shanchu"})))))),G&&P().createElement(bn,{listData:ye,close:fe,addEntityNode:B,entitylistRef:Y}))}));Cn.displayName="TreeNode";var En=Cn,bn=function(e){var t=e.listData,n=e.close,r=e.addEntityNode,a=e.entitylistRef,o="entity-designer-tree-node",l=Ne()((0,b.c)((0,b.c)({},o+"-entity-type-list",!0),o+"-entity-type-list-tb",!0)),i=(0,L.useCallback)((function(e,t){e.stopPropagation(),r&&r(t),n&&n()}),[n,r]);return P().createElement("div",{className:l,ref:a},P().createElement("div",{className:o+"-entity-type-list-constent"},j()(t).call(t,(function(e,t){return P().createElement("div",{key:t,className:o+"-entity-type-list-constent-item",onClick:function(t){return i(t,e)}},e.name)}))))},kn=n(45904),xn=n.n(kn),wn=P().forwardRef((function(e,t){var n=vn("Tree",{},e),r=n.treeData,a=n.virtual,o=n.showIcon,l=n.switcherIcon,i=n.icon,c=n.checkable,u=n.checkStrictly,s=n.disabled,d=n.draggable,v=n.scrollToKey,p=n.expandedKeys,g=n.checkedKeys,m=n.defaultExpandRoot,y=n.defaultExpandAll,h=n.defaultExpandParent,x=n.defaultExpandedKeys,N=n.defaultCheckedKeys,I=n.defaultSelectedKeys,A=n.onCheck,M=n.onExpand,S=n.onSelect,T=n.selectedKeys,R=n.setTreeNodeStyle,D=void 0===R?function(){return{}}:R,V=n.setTreeNodeClassName,B=void 0===V?function(){return""}:V,F=n.estimatedItemSize,K=void 0===F?28:F,O=n.addEntityNode,_=n.deleteEntityNode,U="entity-designer-tree",H=Ne()((0,b.c)({},"".concat(U),!0)),z="".concat(U,"-root"),q=K,W=P().useMemo((function(){return Zt(r,[])}),[r]),G=P().useMemo((function(){return function(e){var t=0;return f()(e).call(e,(function(e){t=e.level>t?e.level:t})),t}(W)}),[W]),Q=function(e,t,n,r,a,o){var l=P().useMemo((function(){return o?e?ln(t||n):on(r,t||n,a,!0):{checkedKeys:[],halfCheckedKeys:[]}}),[r,t,n,e,a,o]),i=P().useState(l.checkedKeys),c=(0,k.c)(i,2),u=c[0],s=c[1],d=P().useState(l.halfCheckedKeys),f=(0,k.c)(d,2),v=f[0],p=f[1],g=l.checkedKeys,m=l.halfCheckedKeys;return(0,L.useEffect)((function(){s(g)}),[g]),(0,L.useEffect)((function(){p(m)}),[m]),[u,v,s,p]}(u,g,N,W,G,c),Z=(0,k.c)(Q,4),Y=Z[0],X=Z[1],J=Z[2],$=Z[3],ee=P().useState(v),te=(0,k.c)(ee,2),ne=te[0],re=te[1],ae=function(e,t){var n=(0,L.useState)(e||t),r=(0,k.c)(n,2),a=r[0],o=r[1];return(0,L.useEffect)((function(){o(e)}),[e]),[a,o]}(T,I),oe=(0,k.c)(ae,2),le=oe[0],ie=oe[1],ce=P().useRef(null),ue=P().useRef(null),se=P().useRef(null),de=t||se,fe=P().useRef(null),ve=P().useState(!0),pe=(0,k.c)(ve,2),ge=pe[0],me=pe[1],ye=gn(W,p,x,y,m,h,ne,ge),he=(0,k.c)(ye,1)[0],Ce=P().useMemo((function(){return tn(W,he)}),[W,he]),Ee=P().useMemo((function(){return Xt(Ce)}),[Ce]),be=(0,L.useCallback)((function(){}),[ce,de,a,q]),ke=P().useCallback((function(e,t,n){var r=t?nn(he,[e]):sn(he,[e]);M&&M(r,{node:n,expanded:t}),re(""),me(!1)}),[he,M]),xe=P().useCallback((function(e,t,n,r,a){var o=t?nn(Y,[e]):sn(Y,[e]),l=u?ln(o):function(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,i=(0,E.c)(t),c=(0,E.c)(n),u=function(t){f()(e).call(e,(function(n){var r=Yt(i,n.key),u=Yt(c,n.key),s=n.hasChildNode&&en(e,i,n.pos,n.level,!1),d=n.hasChildNode&&$t(e,c,i,n.pos,n.level,a),f=null==d?void 0:d.checked,v=null==d?void 0:d.halfChecked;if(n.level===t){if(n.disabled)return;l?r||(un(n.pos,o)?(i.push(n.key),c=sn(c,[n.key])):cn(n.pos,o)&&(s?i.push(n.key):(f||v)&&c.push(n.key))):r?un(n.pos,o)?i=sn(i,[n.key]):cn(n.pos,o)&&(s||!f&&!v||c.push(n.key),i=sn(i,[n.key])):u&&(f||v||(c=sn(c,[n.key])))}}))},s=r;s>=0;s--)u(s);return{checkedKeys:Tt()(new(Pt())(i)),halfCheckedKeys:Tt()(new(Pt())(c))}}(Ce,o,X,G,!1,a,t);A&&A(l.checkedKeys,{event:r,node:n,checked:t,halfCheckedKeys:l.halfCheckedKeys})}),[Y,Ce,X,G,A,u,J,$]),we=P().useCallback((function(e,t,n){var r=Yt(Y,n);S&&S([n],{node:t,event:e,checked:r})}),[S,ie,Y]);return(0,L.useEffect)((function(){v?(ie([v]),re(v)):ie([])}),[v]),(0,L.useEffect)((function(){$(X)}),[X]),P().createElement("div",{className:H,ref:de,onScroll:be},P().createElement("div",{ref:ue,className:"".concat(U,"-plantom")}),P().createElement("div",{className:z,ref:ce},Ee&&j()(Ee).call(Ee,(function(e){var t,n,r,a,u,f=Yt(Y,e.key),v=function(e,t){return null==e?void 0:w()(e).call(e,t)}(X,e.key);return e.nodeKey=e.key,e.onExpand=ke,e.onCheck=xe,e.onSelect=we,e.checked=f,e.selected=function(e,t){return null==e?void 0:w()(e).call(e,t)}(le,e.key),e.indeterminate=v,e.disabled=(t=s,n=e.disabled,xn()(n)?n:t),e.showIcon=o||!1,e.checkable=(r=c,a=e.checkable,xn()(a)?a:r),e.selectable=(u=e.selectable,!xn()(u)||u),e.icon=e.icon||i,e.switcherIcon=e.switcherIcon||l,e.estimatedItemSize=q,e.draggable=d,e.className=B((0,C.c)({},e)),e.style=D((0,C.c)({},e)),e.addEntityNode=O,e.deleteEntityNode=_,P().createElement(En,(0,C.c)({},e,{key:e.key,ref:fe}))}))))})),Nn=wn;Nn.displayName="Tree";var In=Nn,An=(0,R.ErrorBoundaryWrap)((function(e){var t=e.kdesignerApi,n=e.listTreeData,r=e.invokeAction,a=t.meta,o=t.data,l=t.selection,i=(0,L.useContext)(R.GlobalConfigContext),u=i.showMessage,s=i.controlsAddedByForntEnd,d=l.setSelect,v=l.getSelection,p=l.addSelectChangeListener,g=(0,L.useState)([]),m=(0,k.c)(g,2),y=m[0],h=m[1],C=(0,L.useState)([]),E=(0,k.c)(C,2),b=E[0],x=E[1],w=(0,L.useState)([]),N=(0,k.c)(w,2),I=N[0],A=N[1],M=(0,L.useRef)([]);(0,L.useEffect)((function(){M.current=n}),[n]);var S=(0,L.useCallback)((function(e){var t=e.value,n=he(M.current,t[0]);A([n])}),[]);(0,L.useEffect)((function(){var e=v(),t=he(M.current,e[0]);A([t]);var n=p(S);return function(){n&&n()}}),[]);var D=(0,L.useMemo)((function(){return c()(n).call(n,(function(e){var t=e[ee];return ve(t)||ge(t)}))}),[n]),V=(0,L.useMemo)((function(){var e=function(e){return j()(e).call(e,(function(e,t){return Qt(Qt({},e),{},{key:null==e?void 0:e.Id,title:null==e?void 0:e.Name})}))}(D);return pn("Id","ParentId",e)}),[D]),B=(0,L.useCallback)((function(e){!function(e,t,n,r,a){var o=e.type,l=e.fieldName;if(o){var i=n.getActiveSelectedId(),c=t.findControl(i)[ee];if(a.canAdd(o,c)){var u={_Type_:o,ParentId:i,Name:l,Id:(0,R.createUUid)()};t.addControl((0,R.createAddAction)(u)).then((function(e){var t=e[0].value;n.setSelect(T()(t)?[t[0][$]]:[t[$]])}))}}else r((0,R.getLangMsg)("entityd.entityUtil.key0001"))}(e,o,l,u,a)}),[]),F=(0,L.useCallback)((function(){var e=o.getRootId(),t=v();t.length>0&&f()(t).call(t,(function(t){e!==t?rt(t,d,o,s,r,u):u((0,R.getLangMsg)("entityd.listTree.key0001"))}))}),[D]);return P().createElement("div",{style:{width:"300px",height:"100%",flexShrink:0}},P().createElement(In,{name:"Tree",treeData:V,expandedKeys:y,checkedKeys:b,selectedKeys:I,virtual:!1,onCheck:function(e){x(e)},onExpand:function(e){h(e)},onSelect:function(e){d(e)},defaultExpandAll:!0,addEntityNode:B,deleteEntityNode:F}))}),"ed-list-tree"),Mn=function(e){var t=e.style,n=e.showZoom,r=void 0===n||n,a=e.showFitView,o=void 0===a||a,l=e.showChangeDirection,i=void 0===l||l,c=e.showDisplayMode,u=void 0===c||c,s=e.fitViewParams,d=e.isHorizontal,f=e.showFullRelationship,v=e.onZoomIn,p=e.onZoomOut,g=e.onFitView,m=e.onChangeLayoutClick,y=e.onRelationalBtnClick,h=(0,U._s)(),C=h.zoomIn,E=h.zoomOut,b=h.fitView,k=(0,L.useContext)(B),x=k.getPrefixCls,w=k.prefixCls,N=x&&x(w,"controls"),I=(0,L.useCallback)((function(){null==C||C(),null==v||v()}),[C,v]),A=(0,L.useCallback)((function(){null==E||E(),null==p||p()}),[E,p]),M=(0,L.useCallback)((function(){null==b||b(s),null==g||g()}),[b,s,g]),S=(0,R.getLangMsg)("entityd.operationBtns.key0001"),T=(0,R.getLangMsg)("entityd.operationBtns.key0002"),D=(0,R.getLangMsg)("entityd.operationBtns.key0003"),F=d?(0,R.getLangMsg)("entityd.operationBtns.key0004"):(0,R.getLangMsg)("entityd.operationBtns.key0005"),K=f?(0,R.getLangMsg)("entityd.operationBtns.key0006"):(0,R.getLangMsg)("entityd.operationBtns.key0007");return P().createElement("div",{className:N+"-operation-box",style:t},r&&P().createElement(P().Fragment,null,P().createElement("div",{onClick:I,className:N+"-operation-box-button",title:S},P().createElement(V.Icon,{prefix:"designericon",type:"fangda",className:N+"-operation-box-button-icon"})),P().createElement("div",{onClick:A,className:N+"-operation-box-button",title:T},P().createElement(V.Icon,{prefix:"designericon",type:"suoxiao",className:N+"-operation-box-button-icon"}))),o&&P().createElement("div",{className:N+"-operation-box-button",onClick:M,title:D},P().createElement(V.Icon,{prefix:"designericon",type:"wanzhengshitu",className:N+"-operation-box-button-icon"})),i&&P().createElement("div",{className:N+"-operation-box-button",onClick:m,title:F},P().createElement(V.Icon,{prefix:"designericon",type:d?"zongxiangzhankai":"hengxiangzhankai",className:N+"-operation-box-button-icon"})),u&&P().createElement("div",{className:N+"-operation-box-button",onClick:y,title:K},P().createElement(V.Icon,{prefix:"designericon",type:f?"guanxishitu":"wanzhengguanxi",className:N+"-operation-box-button-icon"})))};Mn.displayName="OperationBtns";var Sn=(0,R.ErrorBoundaryWrap)((0,L.memo)(Mn),"ed-controls"),Tn=n(52360),Ln=n.n(Tn);function Pn(e,t){var n,r=null===(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).querySelectorAll("["+e+'="'+t+'"]'))||void 0===n?void 0:n[0];r&&r.scrollIntoView({block:"nearest",behavior:"smooth"})}function Rn(e){var t,n=null===(t=document.querySelectorAll('[data-control-id="'+e+'"]'))||void 0===t?void 0:t[0],r=null==n?void 0:n.parentElement,a=O()(Array.prototype).call((null==r?void 0:r.children)||[]),o=_e()(a).call(a,(function(t){return t.id===e}));if(r&&o>-1){var l,i,c=(null===(l=r.getBoundingClientRect())||void 0===l?void 0:l.height)||0,u=((null===(i=n.getBoundingClientRect())||void 0===i?void 0:i.height)||0)*o-r.scrollTop;(u>=c||u<0)&&(r.scrollTop=Me*o)}}function Dn(e){var t=e.results,n=void 0===t?[]:t,r=e.searchBoxRef,a=e.setShowResultPanel,o=e.keyWord,l=(0,L.useState)({left:-9999,top:-9999}),i=(0,k.c)(l,2),c=i[0],u=i[1],s=(0,L.useState)(-1),d=(0,k.c)(s,2),f=d[0],v=d[1],p=(0,L.useContext)(B),g=p.getPrefixCls,m=p.prefixCls,y=p.getKdesignerApi,h=g&&g(m,"controls"),C=y().selection,E=(0,L.useRef)();(0,L.useEffect)((function(){var e=r.current,t=null==e?void 0:e.getBoundingClientRect(),n=t.bottom,a=void 0===n?0:n,o=t.right;return u({left:(void 0===o?0:o)-230,top:a+10}),document.addEventListener("click",N),function(){document.removeEventListener("click",N)}}),[]),(0,L.useEffect)((function(){return document.addEventListener("keydown",A),function(){document.removeEventListener("keydown",A)}}),[f,n]),(0,L.useEffect)((function(){v(-1)}),[o]);var x,N=function(e){var t;w()(t=e.path).call(t,r.current)||a(!1)},I=ue()(n).call(n,(function(e,t){return M()(e).call(e,t.items)}),[]),A=function(e){var t,n=e.keyCode;switch(w()(t=[40,38,13]).call(t,n)&&e.preventDefault(),e.keyCode){case 40:var r,o=(f+1)%I.length;v(o),Pn("data-id",null===(r=I[o])||void 0===r?void 0:r.id,E.current);break;case 38:var l,i=-1===f?I.length-1:(f-1+I.length)%I.length;v(i),Pn("data-id",null===(l=I[i])||void 0===l?void 0:l.id,E.current);break;case 13:var c,u=null===(c=I[f])||void 0===c?void 0:c.id;C.setSelect(u),u&&a(!1),Rn(u)}},S=function(e){return j()(e).call(e,(function(e){var t,n=e.id,r=e.name,a=e.key,o=Ne()((0,b.c)((0,b.c)({},h+"-result-panel-group-field",!0),h+"-result-panel-group-field-preselected",(null===(t=I[f])||void 0===t?void 0:t.id)===n));return P().createElement("div",{key:n,className:o,onClick:function(e){return function(e){C.setSelect(e),Rn(e)}(n)},"data-id":n},P().createElement("div",{className:h+"-result-panel-group-field-name"},r),P().createElement("div",{className:h+"-result-panel-group-field-key"},a))}))};return P().createElement("div",{className:h+"-result-panel",style:c,ref:E},(x=n,j()(x).call(x,(function(e){var t=e.id,n=e.name,r=e.items;return P().createElement("div",{key:t,className:h+"-result-panel-group"},P().createElement("div",{className:h+"-result-panel-group-title"},n),P().createElement("div",null,S(r)))}))),0===n.length&&P().createElement("div",{className:h+"-result-panel-nodata"},(0,R.getLangMsg)("entityd.searchBox.key0002")))}var Vn=(0,R.ErrorBoundaryWrap)((function(e){var t=e.dataList,n=void 0===t?[]:t,r=(0,L.useState)(""),a=(0,k.c)(r,2),o=a[0],l=a[1],i=(0,L.useState)([]),c=(0,k.c)(i,2),u=c[0],s=c[1],d=(0,L.useState)(!1),v=(0,k.c)(d,2),p=v[0],g=v[1],m=(0,L.useContext)(B),y=m.getPrefixCls,h=m.prefixCls,C=m.getKdesignerApi,b=y&&y(h,"controls"),x=C().selection,N=(0,L.useRef)(null),I=(0,L.useRef)(null);return(0,L.useEffect)((function(){g(u.length>0||""!==o)}),[u]),P().createElement("div",{className:b+"-searchbox",ref:N},P().createElement("div",{className:b+"-searchbox-input-wrapper"},P().createElement(V.Icon,{prefix:"designericon",type:"sousuo",className:b+"-searchbox-search-icon"}),P().createElement("input",{ref:I,className:b+"-searchbox-input",placeholder:(0,R.getLangMsg)("entityd.searchBox.key0001"),value:o,onChange:function(e){var t=e.target.value;l(t);var r=x.getSelection(),a=(0,k.c)(r,1)[0],o=null==t?void 0:Ln()(t).call(t),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(""===t)return[];var r=[],a=[],o=[];f()(e).call(e,(function(e){var n=e._Type_,o=e.Key,l=e.Name;ve(n)||ge(n)?r.push(e):(w()(o).call(o,t)||w()(l).call(l,t))&&a.push(e)})),f()(a).call(a,(function(e){var t=e.ParentId,n=e.Key,a=e.Name,l={id:e.Id,key:n,name:a},i=_e()(o).call(o,(function(e){return e.id===t}));if(i>-1)o[i].items.push(l);else{var c=z()(r).call(r,(function(e){return e.Id===t}));o.push({id:t,key:c.Key,name:c.Name,items:[l]})}}));var l,i=ye(e,n).Id,c=_e()(o).call(o,(function(e){return e.id===i}));return c>0?M()(l=[o[c]]).call(l,(0,E.c)(O()(o).call(o,0,c)),(0,E.c)(O()(o).call(o,c+1))):o}(n,o,a);s(i)},onFocus:function(){g(u.length>0)}}),o&&P().createElement(V.Icon,{prefix:"designericon",type:"shurukuangquanqing",className:b+"-searchbox-clear-icon",onClick:function(){var e;l(""),s([]),null===(e=I.current)||void 0===e||e.focus()}})),p&&(0,gt.createPortal)(P().createElement(Dn,{results:u,searchBoxRef:N,setShowResultPanel:g,keyWord:o}),document.body))}),"ed-searchbox"),Bn={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,TAB:9,ENTER:13,SHIFT:16,CTRL:17,CONTROL:17,ALT:18,ESC:27,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,ARROWLEFT:37,UP:38,ARROWUP:38,RIGHT:39,ARROWRIGHT:39,DOWN:40,ARROWDOWN:40,DELETE:46,META:91,"*":106,"+":107,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"]":221};function Fn(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Fn(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Fn(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var On=function(e,t){var n=(0,L.useContext)(B),r=n.getKdesignerApi,a=n.invokeAction,o=(0,L.useMemo)((function(){return r()}),[]),l=o.data,i=o.selection,u=l.getRootId(),s=i.getSelection,d=i.setSelect,v=(0,L.useContext)(R.GlobalConfigContext),p=v.showMessage,g=v.controlsAddedByForntEnd,m=v.canAddCallback,y=$e(),h=y.setCopyContent,C=y.getCopyContent,E=(0,L.useContext)(R.DataFactoryContext).metaApi;(0,L.useEffect)((function(){var t=e.current;if(t){var n=function(e){if(e.target===t){e.stopPropagation();var n=s();switch(e.keyCode){case Bn.DELETE:if(n.length>0){var r=s();r.length>0&&f()(r).call(r,(function(e){u!==e?rt(e,d,l,g,a,p):p((0,R.getLangMsg)("entityd.useKeyBoardEvent.key0001"))}))}break;case Bn.C:if(Ge(e)){null==e||e.stopPropagation();var o=s()||[];if(w()(o).call(o,u))p((0,R.getLangMsg)("entityd.useKeyBoardEvent.key0003"));else{var v=ot(o,l);h(v)}}break;case Bn.V:if(Ge(e)){var y=C();if(T()(y)){var b=[],k=-1,x=c()(y).call(y,(function(e){var t=e[ee],n=E.getControlMeta(t).IsContainer;return void 0!==n&&n}));if(x.length>0){var N=nt(x[0],l,i,E,m,false);if(!1===N)p((0,R.getLangMsg)("entityd.useKeyBoardEvent.key0002"));else{var I=N.newControl,A=N.index;b.push(I),k=A;var M=I.Id;M&&f()(y).call(y,(function(e){var t=e.Key,n=e._Type_;if((e[ne]||u)===x[0][$]&&!w()(X).call(X,n)){var r=Kn(Kn({},e),{},{ParentId:M,Id:(0,R.createUUid)(),Key:t+"1",FieldName:t+"1",Inherit:!1});b.push(r)}}))}}else f()(y).call(y,(function(e){var t=nt(e,l,i,E,m,false);if(!1===t)p((0,R.getLangMsg)("entityd.useKeyBoardEvent.key0002"));else{var n=t.newControl,r=t.index;b.push(n),k=r}}));var S={index:k};l.addControl((0,R.createPasteAction)(b,S))}}break;case Bn.Z:var L=l.canUndo();Ge(e)&&L&&l.undo();break;case Bn.Y:var P=l.canRedo();Ge(e)&&P&&l.redo()}}};return t.addEventListener("keydown",n),function(){t.removeEventListener("keydown",n)}}}),[])};function _n(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=_n(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=_n(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Un=(0,L.memo)((function(e,t){var n=e.data,r=(0,L.useState)([]),a=(0,k.c)(r,2),o=a[0],l=a[1],i=(0,L.useState)("TB"),c=(0,k.c)(i,2),u=c[0],s=c[1],d=(0,L.useState)(!0),v=(0,k.c)(d,2),p=v[0],g=v[1],m=(0,L.useState)(!1),y=(0,k.c)(m,2),h=y[0],E=y[1],b=(0,L.useContext)(B),x=b.getKdesignerApi,w=b.userConfig,N=b.onUserConfigChange,I=b.getPrefixCls,A=b.prefixCls,M=I&&I(A,"card-view"),S=(0,L.useState)({showKey:w.showKey,showType:w.showType,showFullRelationship:w.showFullRelationship}),T=(0,k.c)(S,2),D=T[0],V=T[1],K=(0,L.useState)({x:0,y:0}),_=(0,k.c)(K,2),H=_[0],z=_[1],q=(0,L.useRef)(),W=(0,L.useRef)([]),G=(0,L.useRef)(!1),Q=x(),Z=Q.meta,Y=Q.data,X=Q.selection,J=(0,L.useRef)(null);On(J),(0,L.useEffect)((function(){W.current=je(n,{getControlMeta:Z.getControlMeta});var e=X.addSelectChangeListener(ee);return function(){e&&e()}}),[]);var $=(0,L.useCallback)((function(e){var t=e.value;W.current=je(t,{getControlMeta:Z.getControlMeta}),G.current=!1,te(u)}),[u,D]);(0,L.useEffect)((function(){G.current=!0,te(u);var e=Y.addDataChangeListener($);return function(){e()}}),[u,D]),(0,L.useEffect)((function(){if(o.length>0&&G.current){var e,t,n=null===(e=q.current.toObject())||void 0===e?void 0:e.zoom;null===(t=q.current)||void 0===t||t.fitView({minZoom:n,maxZoom:n})}}),[o]),(0,L.useEffect)((function(){te(u)}),[D]);var ee=function(e){var t=e.value[0];void 0!==t&&(void 0!==Y.findControl(t).FieldName&&Rn(t))},te=function(e){var t,n,r;s(e);var a="LR"===e,o=new(Ke().graphlib.Graph);o.setDefaultEdgeLabel((function(){return{}})),o.setGraph({rankdir:e,nodesep:30,ranksep:50});var i=D.showFullRelationship;f()(t=W.current).call(t,(function(e){(0,U.yW)(e)?(e.data.size=i?{width:200,height:36}:vt(e,D),o.setNode(e.id,e.data.size)):o.setEdge(e.source,e.target)})),Ke().layout(o);var c=O()(n=W.current).call(n,0,(W.current.length+1)/2),u=j()(r=W.current).call(r,(function(e){if((0,U.yW)(e)){var t=o.node(e.id);e.targetPosition=a?U.JC.Left:U.JC.Top,e.sourcePosition=a?U.JC.Right:U.JC.Bottom,e.position=pt(c,t,e.data.level,a)}return e}));l(u)},ne=function(e){e.preventDefault(),e.stopPropagation(),z({x:e.clientX,y:e.clientY}),E(!0)},re=function(e,t){var n;f()(n=W.current).call(n,(function(n){if(n.id===e){var r=[e,{showMore:t}];Y.batchUpdateControlPropertyValues((0,R.createUpdateAction)([r]))}})),G.current=!1},ae={style:{background:"#ECEEF2"},zoomOnScroll:!1,preventScrolling:!1,nodesConnectable:!1,nodesDraggable:!1,panOnScrollMode:U.WY.Free,defaultZoom:1,minZoom:1/1.2/1.2,maxZoom:1.44,zoomOnDoubleClick:!1},oe="LR"===u,le=D.showFullRelationship,ie=(0,L.useMemo)((function(){return{layoutDirection:u,nodeContentVisibleConfig:D,getData:function(){return n},onClickShowMoreBtn:re}}),[u,D]);return P().createElement(F.Provider,{value:ie},P().createElement(ft,null),P().createElement(U.Mt,null,P().createElement(U.cp,(0,C.c)({elements:o,nodeTypes:{entityNode:Be},onLoad:function(e){G.current=!0,te("TB"),q.current=e},panOnScroll:p,onNodeMouseEnter:function(){g(!1)},onNodeMouseLeave:function(){g(!0)},onPaneContextMenu:ne,onNodeContextMenu:ne,ref:J,tabIndex:-1},ae),P().createElement(Sn,{isHorizontal:oe,showFullRelationship:le,onChangeLayoutClick:function(){te("LR"===u?"TB":"LR")},onRelationalBtnClick:function(){V((function(e){var t=!e.showFullRelationship;return N({showFullRelationship:t}),jn(jn({},e),{},{showFullRelationship:t})}))}}),h&&P().createElement(yt,{config:D,mousePosition:H,onContextItemClick:function(e,t){V((function(n){return jn(jn({},n),{},{showType:e,showKey:t})})),N({showKey:t,showType:e})},closeContextMenu:function(){E(!1)}}),P().createElement("div",{className:M+"-searchbox-container"},P().createElement(Vn,{dataList:null==n?void 0:n.Items})))))})),Hn=Un,zn=(0,L.memo)((function(e,t){var n=e.data,r=(0,L.useState)([]),a=(0,k.c)(r,2),o=a[0],l=a[1],i=(0,L.useContext)(B),c=i.getKdesignerApi,u=(i.userConfig,i.onUserConfigChange,i.invokeAction),s=c(),d=s.data,f=s.selection,v=s.meta,p=(f.getActiveSelectedId,f.getSelection),g=(0,L.useCallback)((function(e){var t=e.value;l(t)}),[]);(0,L.useEffect)((function(){var e=p();l(e);var t=f.addSelectChangeListener(g);return function(){t()}}),[]);return P().createElement("div",{style:{height:"100%",display:"flex"}},P().createElement(An,{kdesignerApi:s,listTreeData:n.Items,invokeAction:u}),P().createElement(bt,{kdesignerApi:s,tableData:function(){var e,t=d.getRootId(),r=o[0]||t,a=d.findControl(r)||{},l=a._Type_,i=v.getControlMeta(l).IsContainer;if(!(void 0!==i&&i)){var c=a[ne]||t;r=c}var u=je(n,{getControlMeta:v.getControlMeta});return(null===(e=z()(u).call(u,(function(e){return e.id===r})).data)||void 0===e?void 0:e.items)||[]}(),allselectedArr:o}))})),qn=zn,Wn=(0,L.memo)((function(e,t){var n=e.data,r=void 0===n?{}:n,a=(0,L.useState)(r),o=(0,k.c)(a,2),l=o[0],i=o[1],c=(0,L.useContext)(B),u=c.getKdesignerApi,s=c.viewKey,d=u(),f=d.data,v=(0,L.useCallback)((function(e){var t=e.value;i(t)}),[]);return(0,L.useEffect)((function(){(0,d.selection.setSelect)(f.getRootId());var e=f.addDataChangeListener(v);return function(){e()}}),[]),P().createElement("div",{style:{height:"100%"}},0===s&&P().createElement(Hn,{data:l}),1===s&&P().createElement(qn,{data:l}))}));Wn.displayName="main-view";var Gn=Wn,Qn=(0,L.memo)((function(e,t){e.data,e.meta,e.onData;return P().createElement("div",null,"right-view")}));Qn.tabKey="rightView",Qn.displayName="right-view";var Zn=Qn,Yn=(0,L.memo)((function(e,t){return P().createElement("div",null,"left-view")}));Yn.tabKey="leftView",Yn.displayName="left-view";var Xn=Yn,Jn={BizappId:"bizappId",Name:"name",Id:"id",appNum:"formId",Key:"key",DevType:"devType",MasterId:"masterId",ExtElements:"extElements"};var $n=function(e){return{getEntityRootId:function(){return e.data.getRootId()},getEntityFieldInfo:function(t){return e.data.findControl(t)},getEntityPropertyValue:function(t,n){var r=e.data.findControl(t);if(r){var a=r[n];return(0,ht.isUndefined)(a)?e.meta.getControlPropertyDefaultValue(r._Type_,n):a}},getFormFieldInfo:function(t){return e.data.findControl(t)},getFieldInfo:function(t){return e.data.findControl(t)},getPropertyValue:function(t,n){return e.data.getPropertyValue(t,n)}}},er=n(58496);var tr=function(e,t,n){return function(t,r){var a=e(),o=r.Hide;if("formmeta"===n&&"FieldId"===r.Id)return!1;if(o&&"object"===(0,er.c)(o)){var l=o.Types,i=o.FieldTypes,c=(o.ParentTypes,o.Hide);if(l&&i){var u,s=t.ParentId||t.Id,d=a.getEntityFieldInfo(s)[ee],f=w()(u=["EntryEntity","SubEntryEntity","TreeEntryEntity"]).call(u,d)?["EntryFieldAp","CardEntryFieldAp"]:["FieldAp"],v=a.getEntityFieldInfo(t.Id)[ee];return null==c||!0===c?fe()(l).call(l,(function(e){return w()(f).call(f,e)}))&&w()(i).call(i,v):!(fe()(l).call(l,(function(e){return w()(f).call(f,e)}))&&w()(i).call(i,v))}if(i){var p=t[ee];return null==c||!0===c?(0,ht.includes)(i,p):!(0,ht.includes)(i,p)}return c}return!1}},nr=n(2992),rr=n.n(nr),ar=["type","value"],or=["type","value"];function lr(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ir(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=lr(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=lr(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var cr=function(e){return e?T()(e)?e:[e]:[]},ur=function(e,t,n){var r=e.globalConfig,a=e.dataContext,o=(e.selectionContext,e.action),l=e.dataFactory,i=(e.modelFactory,e.metaReader),u=o.type,s=o.value,d=(0,kt.c)(o,ar),f=[],v=s[ee],p=i.getControlMeta(v);if(p.IsUnique&&!Ce(v,s[ne],a)){var g=a.findControl(s[ne]),m=r.showMessage,y=g[te],h=p[te];return n("".concat((0,R.getLangMsg)({key:"entityd.preAddHandle.key0001",variables:{parentControlName:y,controlName:h}}))),m("".concat((0,R.getLangMsg)({key:"entityd.preAddHandle.key0001",variables:{parentControlName:y,controlName:h}})))}s.Key||r.controlsAddedByForntEnd.push(s.Id);var C=cr(s),E=j()(C).call(C,(function(e){var t,n=ir({},e),o=n,i=o.Id,u=o.ParentId,s=o._Type_,d=o.Name,v=(null===(t=(0,r.designerContextValue.getDataRef)().entitymeta)||void 0===t?void 0:t[re])||[],p=z()(v).call(v,(function(e){return e[$]===u}));if("RadioField"===s){var g=a.findControl(u)||p,m=c()(v).call(v,(function(e){return e[ne]===g[$]})),y=z()(m).call(m,(function(e){return"RadioGroupField"===e[ee]})),h=c()(v).call(v,(function(e){return"RadioField"===e[ee]})),C=h.length;if(y){var E;n=ir(ir({},n),{},{Group:y[$],Items:"".concat(C+1)});var b=y[re]||[],k=M()(b).call(b,[]),x={Caption:M()(E="".concat(d)).call(E,0===C?"":C),Value:"".concat(C+1),_Type_:"ComboItem"};k.push(x);var N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;return(0,R.createUpdateAction)(ir({Id:e},t))}(y[$],{Items:k}),I=N.type,A=N.value,S={type:I,value:[[A[$],{Items:A[re]}]]};f.push(S)}else{var T,L=[{Caption:M()(T="".concat(d)).call(T,0===C?"":C),Value:"".concat(C+1),_Type_:"ComboItem"}],P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,n=arguments.length>2?arguments[2]:void 0;return(0,R.createAddAction)(l({type:e,parentId:t,transferData:n}))}("RadioGroupField",g[$],{Items:L}),D=P.type,V=P.value,B=(0,kt.c)(P,or);if(f.push(ir({type:D,value:V},B)),n=ir(ir({},n),{},{Group:V[$],Items:"".concat(C+1)}),V.Id)r.controlsAddedByForntEnd.push(V.Id)}}else w()(Z).call(Z,s)?n.ParentEntryId=e.ParentId:"PrintCountField"===s&&(n.RecordModel="print");return n})),b=[ir({type:u,value:E},d)];return M()(b).call(b,f)},sr=function(e,t,n){var r=e.globalConfig,a=e.dataContext,o=(e.selectionContext,e.action),l=(e.dataFactory,e.modelFactory,e.metaReader),i=o.value,c=j()(i).call(i,(function(e){var t=e[ee],o=l.getControlMeta(t);if(o.IsUnique&&!Ce(t,e[ne],a)){var i=a.findControl(e[ne]),c=r.showMessage,u=i[te],s=o[te];return n("".concat((0,R.getLangMsg)({key:"entityd.prePasteHandle.key0001",variables:{parentControlName:u,controlName:s}}))),c("".concat((0,R.getLangMsg)({key:"entityd.prePasteHandle.key0001",variables:{parentControlName:u,controlName:s}})))}e.Key||r.controlsAddedByForntEnd.push(e.Id);return ge(t)&&e.TableName&&(e.TableName=""),e}));return o.value=c,[o]},dr=["type","value"];function fr(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function vr(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=fr(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=fr(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var pr=function(e){return e?T()(e)?e:[e]:[]},gr=function(e,t,n){var r=e.globalConfig,a=e.dataContext,o=(e.selectionContext,e.action),l=(e.dataFactory,e.modelFactory,e.metaReader,o.type),i=o.value,u=(0,kt.c)(o,dr),s=[],d=pr(i);f()(d).call(d,(function(e){var t=a.findControl(e)[ee],o=a.getAllSiblings(e),l=c()(o).call(o,(function(e){return"RadioField"===e[ee]}));if("RadioGroupField"===t){if(z()(l).call(l,(function(t){return t.Group===e}))){var i=r.showMessage;return n((0,R.getLangMsg)("entityd.preDeleteHandle.key0001")),i((0,R.getLangMsg)("entityd.preDeleteHandle.key0001"))}s.push(e)}else s.push(e)}));var v=[vr({type:l,value:s},u)];return M()(v).call(v,[])},mr=n(48560),yr=n.n(mr);function hr(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return Cr(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Er=function(e,t,n){var r,a=hr(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(yr()(o[t],n))return!0}}catch(e){a.e(e)}finally{a.f()}return!1},br=function(e,t,n,r){var o,l=e.globalConfig,i=e.dataContext,u=(e.selectionContext,e.action),s=(e.dataFactory,e.modelFactory,e.metaReader,u.type),d=u.value,v=[],p=l.showMessage;f()(d).call(d,(function(e){var t=null==e?void 0:e[0],n=(null==e?void 0:e[1])||{},r=a()(n)[0],o=n[r],l=i.findControl(t);if(l){var u=l._Type_,s=l.Name,d=l.Items;if("RadioField"===u){var g=l.Group,m=i.findControl(g);if(m){var y=m[re]||[],h=[];if(yr()(r,"Items")){var E=c()(y).call(y,(function(e){return e.Caption===s}))[0];if(Er(y,"Value",o)&&E.Value!==o)throw p("".concat((0,R.getLangMsg)({key:"entityd.preUpdateHandle.key0001",variables:{propVal:o}}))),{message:"".concat((0,R.getLangMsg)({key:"entityd.preUpdateHandle.key0001",variables:{propVal:o}})),type:"warning"};if(Er(y,"Caption",s)){var b=[];f()(y).call(y,(function(e){if(yr()(e.Caption,s)){var t=(0,C.c)({},e);t.Value=o,b.push(t)}else b.push(e)})),h=[g,{Items:b}]}else{var k=M()(y).call(y,[]);k.push({Caption:s,Value:o,_Type_:"ComboItem"}),h=[g,{Items:k}]}}else if(yr()(r,"Name")){if(Er(y,"Caption",o))throw p("".concat((0,R.getLangMsg)({key:"entityd.preUpdateHandle.key0002",variables:{propVal:o}}))),{message:"".concat((0,R.getLangMsg)({key:"entityd.preUpdateHandle.key0002",variables:{propVal:o}})),type:"warning"};if(Er(y,"Value",d)){var x=[];f()(y).call(y,(function(e){if(yr()(e.Value,d)){var t=(0,C.c)({},e);t.Caption=o,x.push(t)}else x.push(e)})),h=[g,{Items:x}]}else{var w=M()(y).call(y,[]);w.push({Caption:s,Value:o,_Type_:"ComboItem"}),h=[g,{Items:w}]}}else if(yr()(r,"Group")){var N=l.Items,I=c()(y).call(y,(function(e){return!yr()(e.Value,N)})),A=i.findControl(o);if(A){var S=A[re]||[];if(Er(S,"Value",N))throw p("".concat((0,R.getLangMsg)({key:"entityd.preUpdateHandle.key0001",variables:{propVal:o}}))),{message:"".concat((0,R.getLangMsg)({key:"entityd.preUpdateHandle.key0001",variables:{propVal:o}})),type:"warning"};var T=M()(S).call(S,[]);T.push({Caption:s,Value:N,_Type_:"ComboItem"});var L=[o,{Items:T}];v.push(L),h=[g,{Items:I}]}}v.push(h)}}}}));var g=d;return M()(o=[{type:s,value:g}]).call(o,[{type:s,value:v}])},kr=["type","value"],xr=(0,b.c)((0,b.c)((0,b.c)((0,b.c)({},R.ActionType.ADD,ur),R.ActionType.PASTE,sr),R.ActionType.UPDATE,br),R.ActionType.DELETE,gr),wr=function(e,t){var n=e.action,r=e.dataContext,a=e.selectionContext,o=e.globalConfig,l=e.dataFactory,i=e.modelFactory,c=e.metaReader,u=e.success,s=e.fail,d=(o.dataRef,o.keywordMapping),f=function(e){var n=[],a=t.getKdesignerApi,o=r.getData().Items,l=new(Pt())(j()(o).call(o,(function(e){return e[d.key]}))),i=t.getDataRef().isv;rr().all(j()(e).call(e,(function(e){var t=e.type,n=e.value,r=(0,kt.c)(e,kr),o=a();if(t===R.ActionType.ADD||t===R.ActionType.PASTE){var u=T()(n)?n:[n],s=rr().all(j()(u).call(u,(function(e){var n,a,u=e.FieldType||e._Type_||"";if(e[d.key]=e[d.key]||u.toLowerCase(),r.isInstrucAdd)e[d.key]=e[d.key].toLowerCase();else if(t===R.ActionType.ADD){var s,f=o.data.findControlByCondition((function(t){return e[d.type]===t[d.type]})).length;e[d.name]=M()(s="".concat(e[d.name])).call(s,0===f?"":f)}if(i){"kingdee"===i||/^[0-9]+[\w]*/i.test(i)||(0,ht.startsWith)(e[d.key],"".concat(i,"_"))||(e[d.key]="".concat(i,"_")+e[d.key])}var v=c.getControlMeta(e[d.type]),p=null==v?void 0:v.IsContainer,g=null==v?void 0:fe()(n=ue()(a=v.Properties).call(a,(function(e,t){return M()(e).call(e,t.Nodes)}),[])).call(n,(function(e){return"FieldName"===e.Id}));if(!p&&g){var m,y=0,h="f_";i&&"kingdee"!==i&&(h="fk_");var C=e[d.key],E=C;r.isInstrucAdd||(E=C||e[d.type]);for(var b=E=O()(E).call(E,0,25);l.has(E);){var k,x=25-"".concat(y+=1).length;E=M()(k="".concat(O()(b).call(b,0,x))).call(k,y)}l.add(E),e[d.fieldName]=M()(m="".concat(h)).call(m,E)}return e})));return s.then((function(t){return e.value=t,e}))}return rr().resolve(e)}))).then((function(e){return u(M()(e).call(e,n))}))},v=[],p=n.type,g=xr[p];if(g){var m=g({globalConfig:o,dataContext:r,selectionContext:a,action:n,dataFactory:l,modelFactory:i,metaReader:c},f,s);m&&v.push.apply(v,(0,E.c)(m))}else v.push(n);v.length&&f(v)},Nr=function(e){var t=(0,L.useContext)(B),n=t.getDataRef,r=t.getModel,a=t.getKdesignerApi;return(0,R.createEComboEditor)({getDataRef:n,getModel:r,getKdesignerApi:a,metaType:"entitymeta"})(e)},Ir=function(e){var t=(0,L.useContext)(R.GlobalConfigContext).keywordMapping,n=(0,L.useContext)(B),r=n.getDataRef,a=n.getModel,o=n.getKdesignerApi;return(0,R.createRefComboEditor)({getDataRef:r,getModel:a,getKdesignerApi:o,keywordMapping:t,metaType:"entitymeta"})(e)},Ar=function(e){var t=(0,L.useContext)(R.GlobalConfigContext).keywordMapping,n=(0,L.useContext)(B),r=n.getDataRef,a=n.getModel,o=n.getKdesignerApi;return(0,R.createRefComboEditor)({getDataRef:r,getModel:a,getKdesignerApi:o,keywordMapping:t,multiple:!0})(e)},Mr=function(e){var t=(0,L.useContext)(B).getKdesignerApi;return(0,R.createInputEditor)({editorComponent:V.Input,getKdesignerApi:t})(e)},Sr=function(e){return(0,R.createSelectEditor)({editorComponent:V.Select})(e)},Tr=(n(77856),n(41256)),Lr=n.n(Tr),Pr=n(3460),Rr=n(27688),Dr={locale:"zh-CN","global.selectholder":"请选择","global.placeholder":"请输入...","global.cancel":"取消","global.confirm":"确定"};function Vr(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return Br(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Br(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fr=function(){function e(t,n){(0,Pr.c)(this,e),(0,b.c)(this,"localesData",void 0),(0,b.c)(this,"locale",void 0),this.locale=n||Dr.locale,this.localesData=t}return(0,Rr.c)(e,[{key:"setLocalesData",value:function(e,t){var n=t||this.localesData[e];if(n)return this.locale=e,this.localesData[e]=n,t}},{key:"getLocalData",value:function(){return this.localesData[this.locale]}},{key:"getLocal",value:function(){return this.locale}},{key:"getLocalesData",value:function(){return this.localesData}}]),e}(),Kr=new Fr((0,b.c)({},Dr.locale,Dr)),Or=function(e,t,n){var r,a=Kr.getLocalData();return function(e,t){var n,r=/{[\w\W]*?}/g,a=e.match(r)||[],o=function(e){return"object"===(0,er.c)(e)||"function"==typeof e},l=function(e){var t=e.length;return O()(e).call(e,1,t-1)},i=[],c=[],u=Vr(a);try{for(u.s();!(n=u.n()).done;){var s=l(n.value),d=t[s];o(d)?c.push({k:s,v:d}):i.push({k:s,v:d})}}catch(e){u.e(e)}finally{u.f()}e=function(e,t){return f()(t).call(t,(function(t){var n=t.k,r=t.v,a=new RegExp("{"+n+"}","g");e=e.replace(a,r)})),e}(e,i);var v=[];c.length>0&&(v=function(e,t){var n=function(e){var t,n=[],r={t:0,v:""},a=e.length;return f()(t=e.split("")).call(t,(function(e,t){"{"===e?(n.push(r),r={t:1,v:""}):"}"===e?(n.push(r),r={t:0,v:""}):r.v=r.v+e,t===a-1&&n.push(r)})),n},r=[],a=n(e);return f()(a).call(a,(function(e,n){var a=e.t,o=e.v;0===a&&""!==o?r.push(P().createElement("span",{key:n},o)):1===a&&r.push(P().cloneElement(t[o],{key:n}))})),r}(e,t));return c.length>0?v:e}(a[M()(r="".concat(e,".")).call(r,t)]||a["global.".concat(t)]||"",n)};var _r={getPrefixCls:function(e,t,n){var r;return n||(e=e||"kdesigner",t?M()(r="".concat(e,"-")).call(r,t):e)},prefixCls:"kdesigner",locale:{getLangMsg:Or,getCompLangMsg:function(e,t,n){var r=e.componentName,a=e.labels,o=e.labelParams;if(o=o||{},n=n||Dr,!(a=a||[]).length)for(var l in n){var i=l.split(".");r===i[0]&&i[1]&&a.push(i[1])}var c={};return f()(a).call(a,(function(e){c[e]=t&&"function"==typeof t?t(r,e,o[e]||{}):Or(r,e,o[e]||{})})),c}}},jr=_r,Ur=(0,L.createContext)(jr),Hr={Kdesigner:{},Icon:{prefix:"designericon"}},zr=P().createContext({}),qr=n(55640),Wr=n.n(qr),Gr=n(6908),Qr=n.n(Gr),Zr=P().createContext({}),Yr=P().createContext({}),Xr="object"==("undefined"==typeof self?"undefined":(0,er.c)(self))&&self.self===self&&self||"object"==(void 0===n.g?"undefined":(0,er.c)(n.g))&&n.g.global===n.g&&n.g||{};function Jr(){var e;return Xr.allowkdesignerlog&&(Xr.__kdesigner_debug||!w()(e=["production","prodBuild"]).call(e,"production"))}Xr.allowkdesignerlog=!1,Xr.trace=!1;var $r={log:function(){var e;Jr()&&((e=console).log.apply(e,arguments),Xr.trace)},warn:function(){var e;Jr()&&((e=console).warn.apply(e,arguments),Xr.trace)},error:function(){var e;(e=console).error.apply(e,arguments),Xr.trace},time:function(e){var t,n;Jr()&&(null===(t=(n=console).time)||void 0===t||t.call(n,e))},timeEnd:function(e){var t,n;Jr()&&(null===(t=(n=console).timeEnd)||void 0===t||t.call(n,e))},table:function(e){var t,n;Jr()&&(null===(t=(n=console).table)||void 0===t||t.call(n,e),Xr.trace)},lazyLog:function(e){Jr()&&(e(console),Xr.trace)}};n(55648),n(28555);var ea=n(7224),ta=n.n(ea);n(1508);n(82504);function na(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return ra(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ra(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aa(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,L.useEffect)((function(){var r=function(n){var r,a=na(e);try{for(a.s();!(r=a.n()).done;){var o,l=r.value;if(null==l||!l.current||null!=l&&null!==(o=l.current)&&void 0!==o&&o.contains(n.target))return}}catch(e){a.e(e)}finally{a.f()}t(n)};return document.addEventListener("mousedown",r,n),document.addEventListener("touchstart",r),function(){document.removeEventListener("mousedown",r,n),document.removeEventListener("touchstart",r)}}),[e,t])}function oa(e){var t=(0,L.useRef)(e);return(0,L.useEffect)((function(){t.current=e}),[e]),t.current}var la,ia;n(46595);function ca(){return"Win32"==window.navigator.platform||"Windows"==window.navigator.platform}function ua(){return"Mac68K"==window.navigator.platform||"MacPPC"==window.navigator.platform||"Macintosh"==window.navigator.platform||"MacIntel"==window.navigator.platform}ua()||("X11"!=window.navigator.platform||ca()||ua())&&(function(){var e;return He()(e=String(window.navigator.platform)).call(e,"Linux")>-1}()||ca());navigator.userAgent.match(/Electron\/(\d+)/),navigator.userAgent.match(/Trident\/(\d+)/),navigator.userAgent.match(/Firefox\/(\d+)/),navigator.userAgent.match(/Chrome\/(\d+)/),navigator.userAgent.match(/Edge\/(\d+)/),w()(la=window.location.hash).call(la,"&preview=true"),w()(ia=window.location.hash).call(ia,"&noLoadYZJ=true");var sa=n(85640),da=n(85344),fa=n.n(da);function va(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return pa(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ga=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ma=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,Pr.c)(this,e),this.events={},this.eventsLength=0,this._maxListeners=e.defaultMaxListeners,this._maxEvents=e.defaultMaxEvents,this.isOnOfflineStack=t,this.offlineStack={}}var t,n,r,o,l;return(0,Rr.c)(e,[{key:"addEventListener",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.on.apply(this,t)}},{key:"addEventListenerAsync",value:(l=(0,sa.c)(fa().mark((function e(){var t,n,r,a=arguments;return fa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),r=0;r<t;r++)n[r]=a[r];return e.next=3,this.onAsync.apply(this,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"setMaxListeners",value:function(e){e="number"==typeof(e=e!=e?1:e)?e:1,this._maxListeners=e||1}},{key:"setMaxEvents",value:function(e){e="number"==typeof(e=e!=e?1:e)?e:1,this._maxEvents=e||1}},{key:"emit",value:function(e){for(var t=this.events[e],n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(t&&t.length>0){var o,l=va(t=O()(t).call(t,0));try{for(l.s();!(o=l.n()).done;){var i=o.value;"function"==typeof i&&i.apply(this,r)}}catch(e){l.e(e)}finally{l.f()}return t=[],!0}return this.isOnOfflineStack&&(this.offlineStack[e]=this.offlineStack[e]||[],this.offlineStack[e].push(r)),!1}},{key:"emitAsync",value:(o=(0,sa.c)(fa().mark((function e(t){var n,r,a,o,l,i,c,u=arguments;return fa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.events[t],r=u.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=u[o];if(!(n&&n.length>0)){e.next=26;break}n=O()(n).call(n,0),l=va(n),e.prev=5,l.s();case 7:if((i=l.n()).done){e.next=14;break}if("function"!=typeof(c=i.value)){e.next=12;break}return e.next=12,c.apply(this,a);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),l.e(e.t0);case 19:return e.prev=19,l.f(),e.finish(19);case 22:return n=[],e.abrupt("return",!0);case 26:return this.isOnOfflineStack&&(this.offlineStack[t]=this.offlineStack[t]||[],this.offlineStack[t].push(a)),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,this,[[5,16,19,22]])}))),function(e){return o.apply(this,arguments)})},{key:"eventNames",value:function(){for(var e=[],t=0,n=a()(this.events);t<n.length;t++){var r=n[t];e.push(r)}return e}},{key:"listenerCount",value:function(e){return ga(this.events,e)?this.events[e].length:0}},{key:"listeners",value:function(e){var t;return ga(this.events,e)?O()(t=this.events[e]).call(t,0):[]}},{key:"off",value:function(e,t){if(!ga(this.events,e))return!1;if("function"==typeof t){var n,r,a=He()(n=this.events[e]).call(n,t);return-1!==a&&(Dt()(r=this.events[e]).call(r,a,1),!0)}return void 0===t?(this.events[e]=[],delete this.events[e],this.eventsLength--,!0):void 0}},{key:"_realOn",value:function(e,t){if(e=String(e),ga(this.events,e)){if(this.events[e].length>=this._maxListeners)return!1}else{if(this.eventsLength>=this._maxEvents)return!1;this.events[e]=[],this.eventsLength++}return!(this.events[e].length>this._maxListeners)&&(this.events[e].push(t),!0)}},{key:"onAsync",value:(r=(0,sa.c)(fa().mark((function e(t,n){return fa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._realOn(t,n),e.next=3,this.callOfflineStackEventsAsync(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"on",value:function(e,t){var n=this._realOn(e,t);return this.callOfflineStackEvents(e,t),n}},{key:"callOfflineStackEvents",value:function(e,t){if(this.isOnOfflineStack&&this.offlineStack[e]){var n,r=va(this.offlineStack[e]);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.apply(this,a)}}catch(e){r.e(e)}finally{r.f()}this.offlineStack[e]=[]}}},{key:"callOfflineStackEventsAsync",value:(n=(0,sa.c)(fa().mark((function e(t,n){var r,a,o;return fa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isOnOfflineStack||!this.offlineStack[t]){e.next=19;break}r=va(this.offlineStack[t]),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return o=a.value,e.next=8,n.apply(this,o);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:this.offlineStack[t]=[];case 19:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return n.apply(this,arguments)})},{key:"createOnceFn",value:function(e,t){var n=this;return function r(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];var i=t.apply(this,o);return n.off(e,r),i}}},{key:"once",value:function(e,t){var n=this.createOnceFn(e,t);this._realOn(e,n),this.callOfflineStackEvents(e,t)}},{key:"onceAsync",value:(t=(0,sa.c)(fa().mark((function e(t,n){var r;return fa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.createOnceFn(t,n),this._realOn(t,r),e.next=4,this.callOfflineStackEventsAsync(t,n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"removeListener",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.off.apply(this,t)}},{key:"removeAllListeners",value:function(){return this.off.apply(this,arguments.length<=0?void 0:arguments[0])}}]),e}();new ma;ma.defaultMaxListeners=1e4,ma.defaultMaxEvents=1e4;var ya=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t};n(94608);ya("top","left","right","bottom","topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"),ya("hover","focus","click","contextMenu");var ha=function(e){var t=e.className;return P().createElement("svg",{className:Ne()(t,"icon"),width:"200",height:"200",viewBox:"0 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},P().createElement("title",null,"文本备份"),P().createElement("g",{id:"文本备份",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},P().createElement("path",{d:"M5.5,24 L22.5,24 L22.5,22.5 L23.999,22.5 L24,5.5 L22.5,5.5 L22.5,4 L5.5,4 L5.5,5.5 L4,5.5 L3.999,22.5 L5.5,22.5 L5.5,24 Z M4.5,23.5 L2.5,23.5 L2.5,25.5 L4.5,25.5 L4.5,23.5 Z M25.5,23.5 L23.5,23.5 L23.5,25.5 L25.5,25.5 L25.5,23.5 Z M4.5,2.5 L2.5,2.5 L2.5,4.5 L4.5,4.5 L4.5,2.5 Z M25.5,2.5 L23.5,2.5 L23.5,4.5 L25.5,4.5 L25.5,2.5 Z M5.5,26.5 L1.5,26.5 L1.5,22.5 L2.999,22.5 L3,5.5 L1.5,5.5 L1.5,1.5 L5.5,1.5 L5.5,3 L22.5,3 L22.5,1.5 L26.5,1.5 L26.5,5.5 L25,5.5 L24.999,22.5 L26.5,22.5 L26.5,26.5 L22.5,26.5 L22.5,25 L5.5,25 L5.5,26.5 Z",id:"形状结合",fill:"#404040","fill-rule":"nonzero"}),P().createElement("path",{d:"M20.5234375,19.924 C20.7995799,19.924 21.0234375,20.1478576 21.0234375,20.424 C21.0234375,20.6694599 20.8465623,20.8736084 20.6133131,20.9159443 L20.5234375,20.924 L7.55200195,20.924 C7.27585958,20.924 7.05200195,20.7001424 7.05200195,20.424 C7.05200195,20.1785401 7.22887711,19.9743916 7.46212632,19.9320557 L7.55200195,19.924 L20.5234375,19.924 Z M20.5,17.424 C20.7761424,17.424 21,17.6478576 21,17.924 C21,18.1694599 20.8231248,18.3736084 20.5898756,18.4159443 L20.5,18.424 L15.5,18.424 C15.2238576,18.424 15,18.2001424 15,17.924 C15,17.6785401 15.1768752,17.4743916 15.4101244,17.4320557 L15.5,17.424 L20.5,17.424 Z M20.5,14.424 C20.7761424,14.424 21,14.6478576 21,14.924 C21,15.1694599 20.8231248,15.3736084 20.5898756,15.4159443 L20.5,15.424 L15.5,15.424 C15.2238576,15.424 15,15.2001424 15,14.924 C15,14.6785401 15.1768752,14.4743916 15.4101244,14.4320557 L15.5,14.424 L20.5,14.424 Z",id:"形状结合",fill:"#979797","fill-rule":"nonzero"}),P().createElement("path",{d:"M12.6,17.6699621 L12.6,8.03204346 L12.6,8.03204346 L16.1159783,8.03204346 C16.4009692,8.03204346 16.632,7.80101266 16.632,7.51602173 C16.632,7.2310308 16.4009692,7 16.1159783,7 L7.78802173,7 C7.5030308,7 7.272,7.2310308 7.272,7.51602173 C7.272,7.80101266 7.5030308,8.03204346 7.78802173,8.03204346 L11.304,8.03204346 L11.304,8.03204346 L11.304,17.7739187 C11.304,18.1053028 11.57264,18.3739428 11.9040241,18.3739428 C11.9200353,18.3739428 11.9360401,18.3733019 11.952,18.3720217 C12.3179691,18.3426661 12.6,18.0371067 12.6,17.6699621 Z",id:"T",fill:"#404040","fill-rule":"nonzero"})))},Ca=function(e,t){var n=null;if("number"==typeof t){return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];null!==n&&clearTimeout(n),n=I()((function(){e&&e.apply(null,a)}),t)}}return e};var Ea={getLangMsg:function(){return""}};var ba=function(){return Ea.getLangMsg.apply(Ea,arguments)},ka=function(e){var t=e.dataContext;return e.selectionContext.getActiveSelectedId()||t.getRootId()},xa=function(e){var t=e.dataContext,n=e.selectionContext,r=e.solidId,a=e.timeout;if(r)return{activedSelectId:r};var o=(0,L.useState)((function(){return ka({dataContext:t,selectionContext:n})})),l=(0,k.c)(o,2),i=l[0],c=l[1],u=(0,L.useRef)(i);return(0,L.useEffect)((function(){var e=Ca((function(){var e=ka({dataContext:t,selectionContext:n});e!==u.current&&($r.log("setActivedSelectId(activedSelectedId)",e),u.current=e,c(e))}),a),r=n.addSelectChangeListener(e),o=t.addDataChangeListener(e);return function(){r&&r(),o&&o()}}),[]),{activedSelectId:i}},wa=V.Tabs.TabPane;function Na(e){var t,n=e.views,r=(e.meta,e.className),a=e.portalId,o=e.position,l=(0,L.useContext)(Yr),i=(0,L.useContext)(Zr),u=xa({dataContext:l,selectionContext:i}).activedSelectId,s=(0,L.useContext)(zr),d=s.activateTab,f=(s.keywordMapping,s.renderCustomTab),v=(s.getViews,s.viewCollapseState),p=s.viewsStateRef,g=s.onViewCollapseChange,m=s.onViewActiveKeyChange,y=(0,L.useState)((null==v?void 0:v[o])||!1),h=(0,k.c)(y,2),C=h[0],E=h[1],b=(0,L.useRef)(!1),x=(0,L.useRef)("");x.current=null===(t=Lr()(n)[0])||void 0===t||null===(t=t.props)||void 0===t?void 0:t.tabKey;var N=(0,L.useState)(n),I=(0,k.c)(N,2),A=I[0],M=I[1],S=(0,L.useState)((function(){var e;return null===(e=A[0])||void 0===e||null===(e=e.props)||void 0===e?void 0:e.tabKey})),R=(0,k.c)(S,2),D=R[0],V=R[1],B=z()(A).call(A,(function(e){return D===e.props.tabKey})),F=(0,L.useMemo)((function(){return j()(A).call(A,(function(e){var t,n;return P().createElement(wa,{key:null===(t=e.props)||void 0===t?void 0:t.tabKey,tab:(0,ht.isFunction)(f)?f(D,e.props):null===(n=e.props)||void 0===n?void 0:n.tabName},e)}))}),[A]),K=(0,L.useCallback)((function(e){e&&V(e)}),[]),O=(0,L.useCallback)((function(e){e!==D&&(V(e),b.current=!0,null==m||m({position:o,key:e})),C&&(E(!1),null==g||g({position:o,hide:!1}))}),[D,C,K,o]);return(0,L.useLayoutEffect)((function(){p.current[o]={hide:C,activeKey:D,setTabKey:function(e){e!==D&&(b.current=!0,V(e))},getViewKeys:function(){var e;return c()(e=j()(A).call(A,(function(e){var t;return null==e||null===(t=e.props)||void 0===t?void 0:t.tabKey}))).call(e,Boolean)},setViews:function(e){Wr()(e,o)&&T()(e[o])&&M((function(){var t,r=c()(t=Lr()(n)).call(t,(function(t,n){var r=function(t){var n,r=t.props.tabKey;return!!w()(n=e[o]).call(n,r)}(t);return r}));return Qr()(r).call(r,(function(t,n){var r,a,l=t.props.aTabKey,i=n.props.bTabKey;return He()(r=e[o]).call(r,l)-He()(a=e[o]).call(a,i)}))}))},setHide:E}}),[C,D,V,E,A]),(0,L.useLayoutEffect)((function(){var e=null==d?void 0:d({dataContext:l,selectionContext:i},o);d&&e?V(e):d||b.current||D!==x.current&&z()(A).call(A,(function(e){return x.current===e.props.tabKey}))&&V(x.current)}),[u]),(0,L.useEffect)((function(){var e;B||K(null===(e=A[0])||void 0===e||null===(e=e.props)||void 0===e?void 0:e.tabKey)}),[B,A]),(0,L.useEffect)((function(){(0,ht.isEqual)(A,n)||M(n)}),[n]),P().createElement("div",{className:Ne()([r,{hide:C}])},P().createElement(Ma,{content:P().createElement(Aa,{className:r,tabPanes:F,tabKey:D,handleChange:O,hide:C,setHide:E,onViewCollapseChange:g,position:o}),portalId:a}),P().createElement(Ia,{activeKey:D,views:A,className:"".concat(r,"-tabs")}))}var Ia=(0,L.memo)((function(e){var t=e.activeKey,n=e.views,r=e.className;return P().createElement("div",{className:r},j()(n).call(n,(function(e){var n,a;return P().createElement("div",{className:Ne()(["".concat(r,"-body"),{hidden:(null===(n=e.props)||void 0===n?void 0:n.tabKey)!==t}]),key:"".concat(null===(a=e.props)||void 0===a?void 0:a.tabKey,"-wrap")},e)})))}));function Aa(e){var t=e.className,n=e.tabPanes,r=e.tabKey,a=e.handleChange,o=e.hide,l=e.setHide,i=e.onViewCollapseChange,c=e.position,u="left"===c?o?"zuolanzhankai":"zuolanshouqi":o?"youlanzhankai":"youlanshouqi";return P().createElement(P().Fragment,null,P().createElement(V.Tabs,{position:"top",defaultActiveKey:r,onChange:a,className:Ne()(["".concat(t,"-tabs-title"),{hide:o}]),size:"small",noContainer:!0},n),P().createElement(V.Icon,{prefix:"designericon",type:u,onClick:function(){var e=!o;l(!o),null==i||i({position:c,hide:e})},title:ba(o?"designer.leftView.key0002":"designer.leftView.key0003")}))}function Ma(e){var t=e.content,n=e.portalId,r=(0,L.useState)(!1),a=(0,k.c)(r,2),o=a[0],l=a[1],i=(0,(0,L.useContext)(zr).getNode)(),c=i&&i.querySelector("[data-portalId=".concat(n,"]"));return(0,L.useEffect)((function(){l(!0)}),[]),o&&c&&(0,gt.createPortal)(t,c)}var Sa=n(11984),Ta=n.n(Sa),La=n(54895),Pa=n(77284),Ra=n(43840);function Da(e,t,n){return t=(0,Pa.c)(t),(0,La.c)(e,Va()?Ta()(t,n||[],(0,Pa.c)(e).constructor):t.apply(e,n))}function Va(){try{var e=!Boolean.prototype.valueOf.call(Ta()(Boolean,[],(function(){})))}catch(e){}return(Va=function(){return!!e})()}var Ba=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(n){function r(e){var t;return(0,Pr.c)(this,r),(t=Da(this,r,[e])).state={errorInfo:null},t}return(0,Ra.c)(r,n),(0,Rr.c)(r,[{key:"componentDidCatch",value:function(e,t){this.setState({errorInfo:[e,t]})}},{key:"render",value:function(){var n,r,a=this.state.errorInfo;return a?P().createElement("div",null,M()(n=M()(r="".concat(t," view has an error: ")).call(r,a[0],", ")).call(n,a[1])):P().createElement(e,this.props)}}]),r}(P().Component)},Fa=(0,L.memo)((function(e){var t=e.views,n=(0,L.useContext)(Ur),r=n.getPrefixCls,a=n.prefixCls,o=r(a,"top-view"),l=(0,L.useContext)(zr),i=l.controlViewSetting,c=l.dataPortalIdPrefix,u=void 0===c?o:c;if(!0===(null==i?void 0:i.hideItemView))return null;var s=r(a,"left-view"),d="".concat(u,"-left");return P().createElement(Na,{views:t,className:s,portalId:d,position:"left"})})),Ka=Ba(Fa,"kdesigner-left-view"),Oa=Ba((0,L.memo)((function(e){var t=e.views,n=(0,L.useContext)(Ur),r=(0,n.getPrefixCls)(n.prefixCls,"main-view");return P().createElement("div",{className:r},t.length<2?t:P().createElement(Na,{views:t,className:r}))})),"kdesigner-main-view"),_a=(0,L.memo)((function(e){var t=e.views,n=(0,L.useContext)(Ur),r=n.getPrefixCls,a=n.prefixCls,o=r(a,"top-view"),l=(0,L.useContext)(zr),i=l.propertyViewSetting,c=l.dataPortalIdPrefix,u=void 0===c?o:c;if(!0===(null==i?void 0:i.hideItemView))return null;var s=r(a,"right-view"),d="".concat(u,"-right");return P().createElement(Na,{views:t,className:s,portalId:d,position:"right"})})),ja=Ba(_a,"kdesigner-right-view");var Ua=Ba((function(){var e=(0,L.useContext)(Ur),t=(0,e.getPrefixCls)(e.prefixCls,"top-view"),n=(0,L.useContext)(zr),r=n.controlViewSetting,a=n.propertyViewSetting,o=n.viewsStateRef,l=n.dataPortalIdPrefix,i=void 0===l?t:l,c=(0,L.useState)(!1),u=(0,k.c)(c,2),s=u[0],d=u[1];(0,L.useEffect)((function(){o.current.top={hide:s,setHide:d}}),[s]);var f=void 0!==(null==r?void 0:r.hideItemView)&&!0===(null==r?void 0:r.hideItemView),v=void 0!==(null==a?void 0:a.hideItemView)&&!0===(null==a?void 0:a.hideItemView);return P().createElement("div",{className:Ne()([t,{hide:s}])},!f&&P().createElement("div",{className:"".concat(t,"-left"),"data-portalid":"".concat(i,"-left")}),P().createElement("div",{className:"".concat(t,"-main"),"data-portalid":"".concat(i,"-main")}),!v&&P().createElement("div",{className:"".concat(t,"-right"),"data-portalid":"".concat(i,"-right")}))}),"kdesigner-top-view"),Ha=n(83789),za=P().createContext({}),qa=function(e){return e.SelectChange="selectChange",e.Reset="reset",e}({}),Wa=function(e){return e.Set="set",e}({}),Ga=function(e){return e.Add="add",e.Delete="delete",e.Change="change",e.Reset="reset",e.BatchActions="BatchActions",e.Attr="Attr",e.Redo="redo",e.RedoAttr="RedoAttr",e.Undo="undo",e.UndoAttr="UndoAttr",e.MergeData="MergeData",e.Move="Move",e}({}),Qa=function(e){return e.ADD="ADD",e.UPDATE="UPDATE",e.DELETE="DELETE",e.PASTE="PASTE",e.Attr="Attr",e.CUSTOMUPDATE="CUSTOMUPDATE",e.REMOVEPROP="REMOVEPROP",e.DRAG="DRAG",e.INSERT="INSERT",e}({}),Za=function(e){return e.Replace="replace",e.ErrorChange="errorChange",e.Reset="reset",e.Delete="delete",e.Clear="clear",e}({});function Ya(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xa(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Ya(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Ya(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Ja=function(e){return function(t){return Xa(Xa({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{type:e,value:t})}},$a=(Ja(Qa.DELETE),Ja(Qa.ADD)),eo=Ja(Qa.UPDATE),to=(Ja(Qa.PASTE),Ja(Qa.Attr)),no=(Ja(Qa.CUSTOMUPDATE),Ja(Qa.REMOVEPROP)),ro=(Ja(Qa.DRAG),Ja(Qa.INSERT),{activeSelectedMode:"last",controlViewMode:"vertical",showMessage:function(){for(var e,t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];(e=console).log.apply(e,M()(t=["default showMessage:"]).call(t,r))},env:{},getOutlineItemIcon:function(e){return P().createElement(ha,null)},preHandle:function(e){var t=e.action;return(0,e.success)([t])},onCustomInputClick:function(){},keywordMapping:{id:"Id",type:"Type",name:"Name",key:"Key",parentId:"ParentId"},processPropertyName:function(e){return(0,ht.camelCase)(e)},enableSearch:!0,enableDiffDefaultData:!0,getEditorFormatValue:ht.noop,filterProperty:function(e,t){return!1},controlViewSetting:{hideHelpIcon:!1,hideAnchorIcon:!1,searchInputPlaceholder:ba("designer.leftView.key0001"),hideTitleTips:!1,onHelpIconClick:function(){},getEmptyView:function(){return null}},propertyViewSetting:{getEmptyView:function(){return null}},showTopView:!0,commonPropertyHandler:function(e){return e}}),ao=n(57280);function oo(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function lo(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=oo(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=oo(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var io=V.Collapse.Panel,co=V.Anchor.Link,uo=V.Dropdown.Item,so=V.Dropdown.Menu,fo=function(e){var t,n=e.meta,r=void 0===n?[]:n,a=e.controlSelectItemInfo,o=(0,L.useContext)(Ur),l=o.getPrefixCls,i=o.prefixCls,u=(0,L.useState)((function(){return r.Controls||[]})),s=(0,k.c)(u,2),d=s[0],f=s[1],v=(0,L.useContext)(Yr),p=(0,L.useContext)(Zr),g=(0,L.useContext)(za).metaApi,m=xa({dataContext:v,selectionContext:p,timeout:200}).activedSelectId,y=(0,L.useContext)(zr),h=y.enableSearch,C=y.keywordMapping,E=y.controlViewSetting,x=E.className,w=l(i,"left-view");(0,L.useEffect)((function(){var e=function(){return f((function(){var e,t=v.findControl(m);t=v.getContainerControl(t);var n=v.getRealControlType(t,C.type);return c()(e=r.Controls||[]).call(e,(function(e){if("HiddenControl"===e.Id||!1===e.Visible)return!1;var t=g.canAdd(e.Id,n);return!0===t||"object"===(0,er.c)(t)&&t.success}))}))};e();var t=v.addDataChangeListener((function(t){var n,r,a=t.actions,o=void 0===a?[]:a;"UPDATE"===(null===(n=o[0])||void 0===n?void 0:n.type)&&((null===(r=(o[0].value||[])[0])||void 0===r||null===(r=r[1])||void 0===r?void 0:r.ContainerType)&&(e(),p.setSelect([m])))}));return function(){t&&t()}}),[m,a]);var N=ho({meta:r,controls:d,enableSearch:h,leftViewPrefixCls:w,controlViewSetting:E}),I=N.filterControls,A=N.searchArea,M=N.controlRelationMap,S=Mt()(I).call(I,(function(e){return!1===e.Visible||!e.Controls||0===e.Controls.length})),T=P().createElement(P().Fragment,null,P().createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOAAAACACAMAAAAlB5WJAAAAVFBMVEUAAADX3ujZ3und3uTZ3OzX3+jW3OfY3erY3unW3OfX3ejV3ebZ2+rY3ejW3OfW3ejX3efX3OfX3efX3ejX3ejv9f/j6fTj6fTi6PPK0Nvg5vHu9P80Vk63AAAAGHRSTlMAHBcFCQ0gEyk1MCQQJj87LUM5RkqA6ab1lqPoAAACrUlEQVR42u3a7Y6iMBSA4X5SBKSIrjjd+7/P7a5mUndHsD1l6WHO2yb1449PjgmYyCiKoiiKoigKfXy63hL7wRDEPS+1nxiE0w0AxCC8QoAYhDcIEIMQBMQgBAExCEFADEIQEIMQBMQgBAExCEFADEIQEIMQBMQgBAExCEFADEIQEIMQBMQgBAExCEFADMLbo48gCJqVFgEJSMCoCEhAAhKQgEX1bYBhBCRgQRGQgASMioCACz0oAv6XVCeEljsFdkd7eWRbvTsg7y9P9XxXQNGf/8ma3QDlcP6yQe4DqOzpRQe1B6D3vcxq/Bd6NfYzjRI9sOlna7ADK7uQww3UdhHoUAPrcakVgUpUddPULVdsrdRhMefcKkB9tMF9U63ZKlVbAfXh8leHjq1Q8z7wY6EI4Itbp0Zm9+lmuRWAuj9/WZ9viFJprSQT87ahGYbG+fICxellPA/PtMOf2npYLjuQn2YSWX7Y1jHlBnb9bAbs43W9KXCcB1oF9R0jywx0dqEB5hPHbYHO2fEpO1q/P0+fgPhUG90dmCvnxqUaCJBX0WUFOucOixnAACsMwDod2PH4cgOb5WQyUGwMdO8BO9TAYRiahcWlEZwLI+OBCWUHRtRqhMA6qipuiiahbYF1q7ABj5G1MTPsEvK8rMA2tioCqBPyn2pbYNutC3SZgVV87wNVQmAVHKhQAXl85m2gTMj5NgaKlYE5J3hzIiH2fvKx7oeP+f25fI/3Hqd/kPkrmhlY2F+5ggkaYYx4Xr7wveBkQYUDnTPx4QJ2xnSm8/t+BoWvPT9nQeUDY0MF9FsnxILKBjq3c6AnqoRYUNlAt3eg3zIhFlQ08He7B7LSIiABCRgVAQn43YDXvL4rK60pL3BipcWvWQfIWXHx6ZqNNxXooyiKoiiKoqjIfgGBCmvD1S6nHAAAAABJRU5ErkJggg=="}),P().createElement("span",null,ba("designer.mainView.key0001")),P().createElement("span",null,ba("designer.mainView.key0002")));return P().createElement("div",{className:Ne()("".concat(w,"-control-tabs"),x||"")},A,P().createElement("div",{className:Ne()("".concat(w,"-control-collapse-container"),(0,b.c)({},"".concat(w,"-empty-control-collapse-container"),S))},S?(null==E||null===(t=E.getEmptyView)||void 0===t?void 0:t.call(E))||T:j()(I).call(I,(function(e){return P().createElement(vo,{category:e,controlRelationMap:M,leftViewPrefixCls:w,key:e.Id,activedSelectId:m,controls:d,controlViewSetting:E})}))))},vo=function(e){var t=e.category,n=e.controlRelationMap,r=e.leftViewPrefixCls,a=e.activedSelectId,o=e.controls,l=e.controlViewSetting,i=t.Id,c=t.Visible,u=t.Controls,s=t.Name,d=l.showCollapseTop,f=void 0===d||d,v=l.collapsable,p=void 0===v||v,g=l.hideItemView,m=(0,L.useState)(!1),y=(0,k.c)(m,2),h=y[0],C=y[1],E=((0,L.useCallback)((function(){C((function(e){return!e}))}),[h]),P().createElement(io,{header:s,panelKey:i},P().createElement("div",{className:"".concat(r,"-pane")},j()(u).call(u,(function(e){return P().createElement(po,{key:e.Id,controlRelationMap:n,control:e,activedSelectId:a,leftViewPrefixCls:r,controls:o})})))));return"HiddenControl"===i||!1===c||0===(null==u?void 0:u.length)||T()(g)&&w()(g).call(g,i)?null:p?P().createElement("div",{id:i,key:i,className:Ne()("".concat(r,"-group-pane"),{"hide-collapse-top":!f})},P().createElement(V.Collapse,{name:"Collapse",key:i,defaultActiveKey:i,expandIconPosition:"left",className:Ne()("".concat(r,"-collapse"),"".concat(i,"-collapse"))},E)):P().createElement("div",{id:i,key:i,className:Ne()("".concat(r,"-group-pane"),{"hide-collapse-top":!f})},P().createElement("div",{className:"".concat(r,"-control-group-title")},P().createElement("div",{className:"".concat(r,"-control-group-title-left")},s)),P().createElement("div",{className:"".concat(r,"-pane")},j()(u).call(u,(function(e){return P().createElement(po,{key:e.Id,controlRelationMap:n,control:e,activedSelectId:a,leftViewPrefixCls:r,controls:o})}))))},po=function(e){var t,n,r=e.controlRelationMap,a=e.control,o=e.activedSelectId,l=e.leftViewPrefixCls,i=e.controls,c=e.parentGroupType,u=a.Name||a.Id;return r[a.Id]&&c!==a.Id?P().createElement(go,{key:M()(t="group_".concat(c||"","_")).call(t,a.Id),Id:a.Id,Name:u,Tips:a.Tips,ExtendFontClass:a.ExtendFontClass,className:l,activedSelectId:o,controls:i,childControls:r[a.Id]||[],controlRelationMap:r}):P().createElement(yo,{key:M()(n="item_".concat(c||"","_")).call(n,a.Id),Id:a.Id,Name:u,Tips:a.Tips,disabled:a.Disable,ExtendFontClass:a.ExtendFontClass,className:l,activedSelectId:o,controlRelationMap:r})},go=function(e){var t,n,r=e.childControls,a=void 0===r?[]:r,o=e.controls,l=e.parentGroupType,i=e.controlRelationMap,c=e.control,u=e.Id,s=e.className,d=e.activedSelectId,f=e.Name,v=e.ExtendFontClass,p=(0,L.useContext)(zr).controlViewMode,g=(0,E.c)(a),m=(0,L.useRef)(null),y=(0,L.useState)(!1),h=(0,k.c)(y,2),C=h[0],b=h[1],x=(0,L.useRef)(null),w=(0,L.useCallback)((function(){x.current&&clearTimeout(x.current)}),[u]);(0,L.useEffect)((function(){var e=function(){x.current&&clearTimeout(x.current),x.current=I()((function(){return b(!1)}))};return document.body.addEventListener("mousedown",e,!0),document.body.addEventListener("touchstart",e,!0),function(){document.body.removeEventListener("mousedown",e,!0),document.body.removeEventListener("touchstart",e,!0)}}),[u]);var N=j()(g).call(g,(function(e){return[z()(o).call(o,(function(t){return t.Id===e}))]})),A=j()(g).call(g,(function(e,t){var n=(0,k.c)(N[t],1)[0],r=P().createElement(po,{control:n,childControls:i[e]||[],parentGroupType:u,leftViewPrefixCls:s,controls:o,activedSelectId:d,controlRelationMap:i});return P().createElement(uo,{key:e},r)})),S=P().createElement(so,null,A.length>1?A:A[0]),T=g.length>0&&u!==l,R=T&&P().createElement("div",{ref:m,className:"".concat(s,"-control-switch"),onClick:function(e){b(!C)}},P().createElement(V.Icon,{type:"xialajiantou",prefix:"designericon"})),D=T&&"".concat(s,"-control-content-dropdown"),B=P().createElement(yo,{Id:u,Name:f,key:u,controlRelationMap:i,control:c,ExtendFontClass:v,activedSelectId:d,className:s,dropdownClassName:D},R);return P().createElement("div",{onMouseDown:w,className:Ne()("".concat(s,"-control"),M()(t="".concat(s,"-")).call(t,p,"-control"))},T?P().createElement(V.Dropdown,{menu:S,scrollHidden:!0,visible:C,onVisibleChange:function(e){b(e)},getTriggerElement:function(){return m.current},placement:"bottomLeft",trigger:"click",popperClassName:M()(n="".concat(s,"-")).call(n,"control-view-dropdown")},B):B)},mo={current:!0},yo=(0,L.forwardRef)((function(e,t){var n,r,a,o,l,i=(0,L.useContext)(za),c=i.dataFactory,u=i.metaApi,s=e.Id,d=e.Name,f=e.Tips,v=e.ExtendFontClass,p=e.className,g=e.activedSelectId,m=e.children,y=e.dropdownClassName,h=e.onClick,E=e.disabled,x=(0,L.useContext)(zr),w=x.getOutlineItemIcon,N=x.env,I=x.keywordMapping,A=x.controlViewMode,S=x.controlViewSetting,R=S.handleItemClick,D=S.onDragStart,B=(0,L.useState)(!1),F=(0,k.c)(B,2),K=F[0],O=F[1],_=(0,L.useContext)(Yr),j=(0,L.useContext)(Zr),U=_.getRootId(),H=s,z=d,q=(0,L.useCallback)((function(){var e,t;if(!E){null==R||R(),mo.current=!1;var n=ka({dataContext:_,selectionContext:j}),r=_.findControl(n);r=_.getContainerControl(r);var a=_.getRealControlType(r,I.type),o=u.canAdd(H,a);if(!(!0===o||"object"===(0,er.c)(o)&&o.success))return rr().resolve();var l=null===(e=u.getControlMeta(null===(t=r)||void 0===t?void 0:t[I.type]))||void 0===e?void 0:e.IsContainer,i=c({type:H,parentId:l?r[I.id]:U}),s=r[I.id]===n?-1:_.findControlIndex(n)+1;return new(rr())((function(e,t){_.addControl($a(i,{index:s})).then((function(t){if(null!=t&&t.length){var n=t[0].value;j.setSelect(T()(n)?[n[0][I.id]]:[n[I.id]]),e()}else e()})).catch((function(e){return t(e)}))}))}}),[H,g]),W=(0,L.useCallback)((function(t){if(!E){var n={type:"control",data:(0,C.c)({},e,{Name:z,Id:H})};N.CONTROL_DRAG_DATA=n,O(!1),null==D||D(t,H,z)}}),[e,H,z]),G=(0,L.useCallback)((function(e){O(e)}),[]),Q=w(H),Z=v?Q&&P().createElement("i",{className:Ne()(v,null===(n=Q.props)||void 0===n?void 0:n.className,"".concat(p,"-control-icon"))}):Q&&P().cloneElement(Q,{className:Ne()(null===(r=Q.props)||void 0===r?void 0:r.className,"".concat(p,"-control-icon"))}),Y=null==S||null===(a=S.clickAddDisable)||void 0===a?void 0:a.call(S,H),X=P().createElement("div",{className:Ne()("".concat(p,"-control-content"),y),draggable:!E,onDragStart:W,onClick:function(e){mo.current&&!Y&&q().then((function(){mo.current=!0})).catch((function(){mo.current=!0}))}},Z,P().createElement("div",{title:!1!==(null==S?void 0:S.hideTitleTips)?z:"",className:"".concat(p,"-control-name")},P().createElement("span",null,z)));return P().createElement("div",{className:Ne()("".concat(p,"-control"),M()(o="".concat(p,"-")).call(o,A,"-control"),(0,b.c)({},M()(l="".concat(p,"-")).call(l,A,"-control-disabled"),E)),onClick:h,ref:t},f?P().createElement(V.Tooltip,{placement:"right",tip:f||"",visible:K,onVisibleChange:G},X):X,m)})),ho=function(e){var t,n=e.meta,r=e.leftViewPrefixCls,a=e.controls,o=e.controlViewSetting,l=e.enableSearch,i=o.hideHelpIcon,u=o.searchInputPlaceholder,s=o.hideAnchorIcon,d=o.onHelpIconClick,v=void 0===d?function(){}:d,p=o.filterCategories,g=void 0===p?function(e){return e}:p,m=(0,L.useState)(""),y=(0,k.c)(m,2),h=y[0],C=y[1],E=(0,L.useRef)(null),x=(0,L.useMemo)((function(){var e;return(0,ao.isSupported)()?ue()(e=n.Controls).call(e,(function(e,t){return t.Name&&(e[t.Id]=(0,ao.convertToPinyin)(t.Name,"",!0).toLowerCase()),e}),{}):{}}),[]),N=g(n.Categories),I=(0,L.useMemo)((function(){return h?(0,Ha.Ut)(a,(function(e){var t;return c()(t=j()(e).call(e,(function(e){var t,n;return e.Name&&(-1!==He()(t=e.Name).call(t,h)||-1!==He()(n=x[e.Id]).call(n,(0,ao.convertToPinyin)(h,"",!0).toLowerCase()))&&e}))).call(t,Boolean)})):a}),[h,a]),A=c()(t=j()(N).call(N,(function(e){var t=e.Id,n=e.Name;return fe()(I).call(I,(function(e){return e.CategoryId===t}))?{value:t,label:n}:null}))).call(t,Boolean),M={},S=[];!h&&f()(a).call(a,(function(e){var t=e.OwnerTypeId,n=e.Id;t&&(M[t]=M[t]||[],M[t].push(n),S.push(n))}));var T=h?[j()(N).call(N,(function(e){var t=e.Id;return lo(lo({},e),{},{Controls:c()(I).call(I,(function(e){return e.CategoryId===t}))})})),M]:[j()(N).call(N,(function(e){var t=e.Id;return lo(lo({},e),{},{Controls:c()(I).call(I,(function(e){return!w()(S).call(S,e.Id)&&e.CategoryId===t}))})})),M],R=(0,k.c)(T,2),D=R[0],B=R[1],F=(0,L.useCallback)((function(e){C(e)}),[]),K=(0,L.useCallback)((0,ht.debounce)(F,250),[]),O=(0,L.useCallback)((function(e){var t;K("string"==typeof e?e:null===(t=E.current)||void 0===t||null===(t=t.input)||void 0===t?void 0:t.value)}),[n,a]);return{filterControls:D,controlRelationMap:B,searchArea:l&&P().createElement("div",{className:"".concat(r,"-control-search")},P().createElement(V.Input,{className:Ne()("".concat(r,"-control-search-input")),ref:E,placeholder:u||ba("designer.leftView.key0001"),borderType:"bordered",onChange:function(e){return F(e.target.value)},allowClear:!0,prefix:P().createElement(V.Icon,{prefix:"designericon",type:"sousuo",onClick:O}),value:h}),!s&&P().createElement(Co,{options:A,disabled:0===A.length,className:r,handleClick:function(e){var t=document.getElementsByClassName("".concat(e,"-collapse"));null!=t&&t[0]&&t[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}},P().createElement("div",{title:ba("designer.leftView.key0004"),className:Ne()("".concat(r,"-control-search-icon"),(0,b.c)({},"".concat(r,"-control-search-icon-unclickable"),0===A.length))},P().createElement(Eo,{disabled:0===A.length}))),!i&&P().createElement("div",{title:ba("designer.leftView.key0005"),className:"".concat(r,"-control-search-icon"),onClick:function(){v()}},P().createElement(V.Icon,{type:"tips"})))}};var Co=function(e){var t,n=e.children,r=e.options,a=(e.handleClick,e.disabled),o=e.className,l=j()(r).call(r,(function(e){var t=e.value,n=e.label;return P().createElement(co,{href:"#".concat(t),title:n,key:t})})),i=(0,L.useState)(!1),c=(0,k.c)(i,2),u=c[0],s=c[1],d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,L.useRef)(null),r=(0,L.useCallback)((function(){n.current&&clearTimeout(n.current)}),[]);return(0,L.useEffect)((function(){var r=function(){n.current&&clearTimeout(n.current),n.current=I()((function(){e()}))};return document.addEventListener("click",r,t),function(){document.removeEventListener("click",r,t)}}),[e]),r}((0,L.useCallback)((function(){return s(!1)}),[]),!0);return P().createElement(P().Fragment,null,!!n&&P().cloneElement(n,{onClick:function(){!a&&s(!u),d()},className:Ne()(null==n||null===(t=n.props)||void 0===t?void 0:t.className,(0,b.c)({},"".concat(o,"-control-search-icon-focus"),u))},P().createElement(P().Fragment,null,n.props.children,P().createElement(V.Anchor,{type:"advanced",offsetTop:70,visible:!a&&u,lockedIcon:!1,onVisibleChange:function(e){},getCurrentAnchor:function(){var e="#".concat(r[0]&&r[0].value);return fe()(r).call(r,(function(t){var n,r,a,o=t.value,l="#".concat(o);try{var i=document.getElementById(o);if(i&&(n=i,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,(a=n.getBoundingClientRect()&&n.getBoundingClientRect().top)>=84&&a<=r))return e=l,!0}catch(e){$r.log("getCurrentAnchor error: ",e)}})),e},getContainer:function(){return document.getElementsByClassName("kdesigner-left-view-control-collapse-container")[0]||window}},l))))},Eo=function(e){var t=e.disabled;return P().createElement("svg",{class:"icon",fill:t?"#CCCCCC":"#212121",width:"200",height:"200",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},P().createElement("path",{d:"M500 562.5C430.964406 562.5 375 506.535594 375 437.5C375 368.464406 430.964406 312.5 500 312.5C569.035594 312.5 625 368.464406 625 437.5C625 506.535594 569.035594 562.5 500 562.5zM500 500C534.517797 500 562.5 472.017797 562.5 437.5C562.5 402.982203 534.517797 375 500 375C465.482203 375 437.5 402.982203 437.5 437.5C437.5 472.017797 465.482203 500 500 500zM516.777359 932.614422C506.540909 939.128525 493.459091 939.128525 483.222641 932.614422C245.934398 781.612813 125 616.702269 125 437.5C125 230.393219 292.893219 62.5 500 62.5C707.106781 62.5 875 230.393219 875 437.5C875 616.702269 754.065603 781.612813 516.777359 932.614422zM187.5 437.5C187.5 587.679863 290.254255 731.649213 500 869.053947C709.745744 731.649213 812.5 587.679863 812.5 437.5C812.5 264.911016 672.588984 125 500 125C327.411016 125 187.5 264.911016 187.5 437.5z"}))};fo.tabKey="ControlView",fo.getTabName=function(){return ba("designer.leftView.key0006")};var bo=fo,ko=P().createContext({}),xo=n(97552),wo=n.n(xo),No=function(e){var t=e.type,n=e.color,r=e.className,a=e.onClick,o=e.disabled,l=function(){a&&a()},i=(0,L.useMemo)((function(){if(!n)return"#ffffff";return/rgba?\((\d{1,3}),(\d{1,3}),(\d{1,3})(,([.\d]+))?\)/.test(n)||/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/.test(n)?n:"#ffffff"}),[n]);return P().createElement("div",{className:Ne()("".concat(r,"-prefix"),{disabled:o})},"foreColor"===t?P().createElement("svg",{className:"".concat(r,"-prefix-icon"),width:"200",height:"200",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg",onClick:l},P().createElement("title",null,ba("designer.editor.key0010")),P().createElement("g",{id:"文字颜色",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},P().createElement("g",{id:"编组",transform:"translate(3.000000, 1.225936)"},P().createElement("path",{d:"M7.10199875,0.000488183945 C7.39408208,-0.0100860974 7.67791213,0.151661551 7.80920279,0.433215284 L7.80920279,0.433215284 L13.7258585,13.1215243 C13.9009127,13.4969293 13.7384963,13.9431646 13.3630913,14.1182188 C12.9876863,14.2932731 12.541451,14.1308567 12.3663968,13.7554517 L12.3663968,13.7554517 L10.2754569,9.274 L3.87745688,9.274 L1.7883667,13.7554517 C1.61331249,14.1308567 1.16707714,14.2932731 0.791672168,14.1182188 C0.416267191,13.9431646 0.253850808,13.4969293 0.428905024,13.1215243 L6.34556069,0.433215284 C6.48061111,0.143598729 6.77706251,-0.0192517453 7.07787471,0.00182180938 Z M7.07645688,2.413 L4.57645688,7.774 L9.57645688,7.774 L7.07645688,2.413 Z",id:"形状结合",fill:"#212121"}),P().createElement("rect",{id:"矩形备份-2",stroke:"#ccc",strokeWidth:"0.5",fill:i,x:"-0.25",y:"15.5240643",width:"14.5",height:"2.5",rx:"1"})))):P().createElement("svg",{className:"".concat(r,"-prefix-icon"),width:"200",height:"200",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg",onClick:l},P().createElement("title",null,ba("designer.editor.key0011")),P().createElement("g",{id:"油漆桶",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},P().createElement("g",{id:"编组",transform:"translate(2.810513, 0.777902)"},P().createElement("path",{d:"M7.35237743,0.219669914 L8.05948421,0.926776695 L8.06299995,0.931 L12.8033719,5.58910098 C13.6474203,6.41866449 13.6988871,7.75029176 12.9455484,8.64490829 L12.82651,8.7757058 L7.52324583,14.07897 C6.68640806,14.9158077 5.35438522,14.9556572 4.47038697,14.1985182 L4.34126532,14.07897 L0.658927543,10.3966322 C-0.177910225,9.55979443 -0.217759275,8.22777195 0.539946158,7.34320727 L0.659583703,7.21399633 L6.45599995,1.445 L6.29171726,1.28033009 C5.99882404,0.987436867 5.99882404,0.512563133 6.29171726,0.219669914 C6.58461048,-0.0732233047 7.05948421,-0.0732233047 7.35237743,0.219669914 Z M12.7772674,11.2000162 C12.8448732,11.2253684 12.8982166,11.2787118 12.9235688,11.3463177 L13.6628014,13.3176044 C13.8643815,13.8551514 13.5920265,14.4543322 13.0544796,14.6559123 C12.9377675,14.6996794 12.8141351,14.7220982 12.6894865,14.7220982 C12.1153861,14.7220982 11.6499858,14.2566979 11.6499858,13.6825975 C11.6499858,13.557949 11.6724047,13.4343165 11.7161717,13.3176044 L12.4554042,11.3463177 C12.5038843,11.2170376 12.6479873,11.1515362 12.7772674,11.2000162 Z M7.52128565,2.50147715 L2.77699995,7.222 L11.9757231,7.22266041 C11.9821309,7.05395544 11.9319029,6.8835921 11.8253092,6.74250292 L11.751965,6.65901613 L7.52128565,2.50147715 Z",id:"形状结合",fill:"#212121"}),P().createElement("rect",{id:"矩形备份-3",stroke:"#ccc",strokeWidth:"0.5",fill:i,x:"-0.060513479",y:"15.9720982",width:"14.5",height:"2.5",rx:"1"})))))},Io=[["#45cdff","#3dccc0","#40bd6e","#99d92b","#ffd52e","#ffb44a","#ff854d","#ff5257","#ff3b72","#9a4dff","#3987ed","#5797ff"],["#16b0f1","#16b8b1","#1ba854","#77c404","#fdc200","#ff991c","#ff5f1f","#fb2323","#f90d58","#701df0","#0e5fd8","#276ff5"],["#ffffff","#fafafa","#f5f5f5","#f2f2f2","#e5e5e5","#d9d9d9","#cccccc","#999999","#666666","#404040","#212121","#000000"]],Ao=function(e){var t,n="",r=100;if(!e)return{color:n,alpha:r};if(/^themeColor/.test(e)){var a=e.split("|");return{color:n=a[0],alpha:r=Number(a[1])||100}}if(null!==(t=e=(0,ht.trim)(e).toLowerCase())&&void 0!==t&&It()(t).call(t,"#"))n=e;else{var o,l,i,c,u=e.replace(/\s+/g,"").match(/rgba?\((\d{1,3}),(\d{1,3}),(\d{1,3})(,([.\d]+))?\)/);u&&(o=1===(o=wo()(u[1]).toString(16)).length?"0"+o:o,l=1===(l=wo()(u[2]).toString(16)).length?"0"+l:l,i=1===(i=wo()(u[3]).toString(16)).length?"0"+i:i,c=ta()(u[5]),n="#"+o+l+i,r=isNaN(c)?100:wo()(100*c))}return{color:n,alpha:r}},Mo=function(e){var t=e.color,n=e.alpha;if("themeColor"===t&&100!==n)return"themeColor|".concat(n);if(100!==n){var r,a,o,l,i,c;t.match(/^#[0-9a-fA-F]{3}$/)?(l=wo()("0x"+(0,ht.repeat)(O()(t).call(t,1,2),2)),i=wo()("0x"+(0,ht.repeat)(O()(t).call(t,2,3),2)),c=wo()("0x"+(0,ht.repeat)(O()(t).call(t,3,4),2))):(l=wo()("0x"+O()(t).call(t,1,3)),i=wo()("0x"+O()(t).call(t,3,5)),c=wo()("0x"+O()(t).call(t,5,7))),t=M()(r=M()(a=M()(o="rgba(".concat(l,",")).call(o,i,",")).call(a,c,",")).call(r,n/100,")")}return t},So=function(e){var t,n,r=e.className,a=e.showPanel,o=e.hideThemeBtn,l=e.hideAlphaInput,i=e.colorValue,c=e.isCheck,u=e.onChange,s=e.onClosePanel,d=e.triggerDom,f=(e.disabled,(0,L.useState)(!!c)),v=(0,k.c)(f,2),p=v[0],g=v[1],m=(0,L.useState)((function(){var e=Ao(i).color;return It()(e).call(e,"#")?O()(e).call(e,1):e})),y=(0,k.c)(m,2),h=y[0],C=y[1],E=(0,L.useState)((function(){return Ao(i).alpha})),b=(0,k.c)(E,2),x=b[0],w=b[1],N=(0,L.useRef)(null),I=null==d?void 0:d.current,A=null!==(t=null==d||null===(n=d.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==t?t:{},M=A.right,S=void 0===M?0:M,T=A.top,R=void 0===T?0:T,D=A.height,B=(void 0===D?0:D)+4,F=p?40:156,K=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,_=R+B+F>(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)?R-F-4:R+B;aa([d,N],(function(){s()})),(0,L.useEffect)((function(){C((function(){var e=Ao(i).color;return It()(e).call(e,"#")?O()(e).call(e,1):e})),w((function(){return Ao(i).alpha})),g(null==i?void 0:It()(i).call(i,"themeColor"))}),[i]),(0,L.useEffect)((function(){a&&(C((function(){var e=Ao(i).color;return It()(e).call(e,"#")?O()(e).call(e,1):e})),w((function(){return Ao(i).alpha})),g(null==i?void 0:It()(i).call(i,"themeColor")))}),[a]),(0,L.useEffect)((function(){var e=function(e){var t,n=e.target;d.current&&null!==(t=d.current)&&void 0!==t&&t.contains(n)||s()};return document.addEventListener("scroll",e,!0),function(){document.removeEventListener("scroll",e,!0)}}),[]);var U=function(e){var t=e.color,n=e.alpha;C((function(){return It()(t).call(t,"#")?O()(t).call(t,1):t})),w(n);if(t.match(/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/)||/^themeColor/.test(t)){var r=Mo({color:t,alpha:n});u(r)}};return I?mt().createPortal(P().createElement("div",{ref:N,style:{position:"absolute",top:_,right:K-S,zIndex:1050},className:r},a?P().createElement("div",{className:Ne()("kdesigner-colorPanel","kd-cq-color-picker kd-cq-kdesigner-color-picker")},!o&&P().createElement("div",{className:"themeBtn"},P().createElement("label",null,ba("designer.editor.key0012")),P().createElement(V.Switch,{size:"large",checked:p,onClick:function(e){var t=!p,n=t?"themeColor":"",r=t?x:100;g(t),C(n);var a=Mo({color:n,alpha:r});u(a)}})),!p&&P().createElement(P().Fragment,null,P().createElement("div",{className:"textPanel"},P().createElement("div",{className:"textItme"},P().createElement("label",null,ba("designer.editor.key0013")),P().createElement(V.Input,{borderType:"bordered",value:h,prefix:"#",onChange:function(e){var t="#"+e.target.value;U({color:t,alpha:x})}})),!l&&P().createElement("div",{className:"textItme",title:"".concat(ba("designer.editor.key0014"),"[0, 100]")},P().createElement("label",null,ba("designer.editor.key0015")),P().createElement(V.InputNumber,{borderType:"bordered",value:String(x),min:0,max:100,onChange:function(e){var t=e.target.value;t<0||t>100||U({color:"#"+h,alpha:t})}}))),P().createElement("div",{className:"colors"},function(){if(a){var e=(0,ht.flatten)(Io);return j()(e).call(e,(function(e,t){var n={backgroundColor:e};return P().createElement("span",{key:t,className:Ne()("colorItem","kd-cq-color-picker-color-block"),title:e,style:n,onClick:function(t){return function(e){var t=e.color,n=e.alpha;p||U({color:t,alpha:n})}({color:e,alpha:x})}},P().createElement("span",{className:"colorItem-hover-box"}))}))}return null}()))):null),document.body):null};function To(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return Lo(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lo(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Lo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Po=function(e){var t=e.tips,n=e.name,r=e.className,a=e.nameHidden,o=e.required,l=e.onLinkClick,i=e.title,c=e.nameStyle,u=e.subTitle,s=(0,L.useState)(!1),d=(0,k.c)(s,2),f=d[0],v=d[1],p=(0,L.useContext)(zr),g=p.tipsVisibleByMouse,m=p.tipsPostion,y=void 0===m?{placement:"top"}:m,h=(0,L.useMemo)((function(){if("object"!==(0,er.c)(t))return t;var e=t.linkData,n=t.content,a=t.title,o=Bo(n),i=Ko(o),c=Ro(e,i,{handleLinkClick:l});return P().createElement("div",null,a&&P().createElement("div",{className:"".concat(r,"-Tooltip-title")},a),c)}),[t,r,l]);return P().createElement("div",{style:c,className:Ne()((0,b.c)((0,b.c)({},"".concat(r,"-title"),!0),"".concat(r,"-placeholder"),a)),onMouseEnter:function(){g&&v(!0)},onMouseLeave:function(){g&&v(!1)}},P().createElement("span",{className:Ne()((0,b.c)({},"".concat(r,"-title-text"),!0))},P().createElement("span",{title:i||n||""},n),u&&P().createElement("span",{className:"".concat(r,"-title-sub")},u),o&&P().createElement("span",{className:Ne()((0,b.c)({},"".concat(r,"-title-required-text"),o))},"*")),h&&P().createElement(V.Tooltip,{placement:y.placement,tip:h,style:{marginLeft:"5px"},scrollHidden:!0,popperStyle:y.tipsStyle},(!g||g&&f)&&P().createElement(V.Icon,{prefix:"designericon",type:"wenhao"})))},Ro=function e(t,n,r){var a;return(0,ht.isArray)(n)?j()(a=c()(n).call(n,(function(e){return!(0,ht.isEmpty)(e)}))).call(a,(function(n){return(0,ht.isArray)(n)?e(t,n,r):Do(t,n,r)})):Do(t,n,r)},Do=function(e,t,n){var r,a,o=n.handleLinkClick,l=new RegExp(/(#\{\d+\})/),i=new RegExp(/\d+/);return(0,ht.isString)(t)&&l.test(t)?j()(r=c()(a=t.split(/(#\{\d+\})/g)).call(a,(function(e){return!(0,ht.isEmpty)(e)}))).call(r,(function(t,n){if(l.test(t)){var r,a=wo()(t.match(i)),c=To(e);try{var u,s=function(){var e,t=r.value,l=t.index,i=t.name,c=t.code;if(l===a)return{v:P().createElement(Oo,{key:M()(e="link".concat(n,"_")).call(e,c),name:i,code:c,index:l,onClick:function(){o&&o(c)}})}};for(c.s();!(r=c.n()).done;)if(u=s())return u.v}catch(e){c.e(e)}finally{c.f()}}return t})):t},Vo=function(e){var t,n,r=new RegExp(/(\\r\\n)|(\\n)|(\\r)/g);return(0,ht.isString)(e)&&r.test(e)?j()(t=c()(n=e.split(r)).call(n,(function(e){return!(0,ht.isEmpty)(e)}))).call(t,(function(e,t){return r.test(e)?P().createElement("br",{key:"br_".concat(t)}):(0,ht.trimStart)(e)})):e},Bo=function e(t){var n;return(0,ht.isArray)(t)?j()(n=c()(t).call(t,(function(e){return!(0,ht.isEmpty)(e)}))).call(n,(function(t){return(0,ht.isArray)(t)?e(t):Vo(t)})):Vo(t)},Fo=function(e){var t,n=new RegExp(/(\\t)/g);return(0,ht.isString)(e)&&n.test(e)?j()(t=e.split(n)).call(t,(function(e,t){return n.test(e)?P().createElement("span",{style:{paddingLeft:"2em"},key:"span_".concat(t)}):e})):e},Ko=function e(t){var n;return(0,ht.isArray)(t)?j()(n=c()(t).call(t,(function(e){return!(0,ht.isEmpty)(e)}))).call(n,(function(t){return(0,ht.isArray)(t)?e(t):Fo(t)})):Fo(t)},Oo=function(e){var t=e.name,n=e.code,r=e.onClick,a={padding:" 0px 2px",color:"#5E80EB",cursor:" pointer"};return It()(n).call(n,"www")||It()(n).call(n,"http://")||It()(n).call(n,"https://")?P().createElement("a",{className:"link-color",style:a,href:It()(n).call(n,"www")?"http://".concat(n):n,target:"_blank",rel:"noreferrer"},t):P().createElement("a",{className:"link-color",style:a,href:"javascript:void(0);",onClick:r},t)},_o=function(e){var t=e.handleChange,n=e.value,r=e.className,a=e.editor,o=e.locked,l=e.Name,i=e.Tips,c=a.NameHidden,u=a.Prefix,s=void 0===u?{}:u,d=a.Required,f=a.Title,v=s.Type,p=void 0===v?"foreColor":v,g=(0,L.useState)(!1),m=(0,k.c)(g,2),y=m[0],h=m[1],C=(0,L.useState)(n||""),E=(0,k.c)(C,2),b=E[0],x=E[1],w=(0,L.useRef)(null),N=(0,L.useRef)(null);return(0,L.useEffect)((function(){n!==b&&x(n)}),[n]),P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:c,className:r,name:l,tips:i,required:d,title:f}),P().createElement("div",{className:"".concat(r,"-color-editor"),ref:N},P().createElement(No,{className:"".concat(r,"-color-editor"),type:p,color:n,onClick:function(){h(!0)}}),P().createElement(V.Input,{className:"".concat(r,"-color-editor-input"),ref:w,borderType:"bordered",value:b,onChange:function(e){var n=e.target.value;x(n),t(n)},disabled:o,onClick:function(){h(!0)}})),P().createElement(So,{triggerDom:N,showPanel:!o&&y,colorValue:n,onClosePanel:function(){h(!1)},onChange:function(e){t(e)}}))},jo=function(e){var t,n=e.handleChange,r=e.value,a=e.className,o=e.locked,l=e.Editor,i=e.Name,c=e.field,u=e.Id,s=e.Tips,d=e.InputTitle,f=e.dataContext,v=l.NameHidden,p=l.MaxLength,g=(l.Min,l.Max,l.Required),m=l.Type,y=l.Placeholder,h=l.AutoSize,C=l.Count,E=l.CountPosition,b=l.CanResize,x=l.Title,N=l.SubTitle,A=l.AllowClear,S=(0,L.useContext)(zr),T=S.showMessage,R=S.validateProps,D=S.lowerCaseProps,B=d||(p?M()(t="".concat(ba("designer.editor.key0007")||"最多输入字符数",":")).call(t,p):""),F=(0,L.useState)(r||""),K=(0,k.c)(F,2),O=K[0],_=K[1],j=(0,L.useState)(!1),U=(0,k.c)(j,2),H=U[0],z=U[1],q=(0,L.useRef)(null),W=(0,L.useRef)(null);(0,L.useEffect)((function(){H||r===O||_(r)}),[r,H]);var G=function(e){var t,a,o=(null===(t=e.target)||void 0===t?void 0:t.value)||"";D&&w()(D).call(D,u)&&(o=o.toLowerCase()),_(o),(a=o)!==r&&(W.current&&clearTimeout(W.current),W.current=I()((function(){W.current=null,n(a)}),300))},Q=function(e){13===e.nativeEvent.keyCode&&Y(e)},Z=function(){z(!0)},Y=function(e){var t,r,a=e.target.value;D&&w()(D).call(D,u)&&(a=a.toLowerCase()),R&&w()(R).call(R,u)&&(t=a,r=(null==f?void 0:f.getData().Items)||[],-1!==_e()(r).call(r,(function(e){return e.Id!==c.Id&&e[u]===t})))&&T(ba({key:"designer.msg.key0004",variables:{inputValue:a}}),"warn"),n(a),I()((function(){z(!1)}),300)};return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:v,className:a,name:i,tips:s,required:g,title:x,subTitle:N}),function(e){return"TextArea"===e}(m)?P().createElement(V.TextArea,{ref:q,value:O,disabled:o,title:B,maxLength:p,placeholder:y||ba("designer.editor.key0008"),borderType:"bordered",autoSize:null!=h?h:{minRows:3,maxRows:3},count:C,countPosition:E,canResize:b,allowClear:A,onKeyDown:Q,onFocus:Z,onBlur:Y,onChange:G}):P().createElement(V.Input,{ref:q,value:O,disabled:o,title:B,maxLength:p,placeholder:y||ba("designer.editor.key0008"),borderType:"bordered",allowClear:A,onKeyDown:Q,onFocus:Z,onBlur:Y,onChange:G}))},Uo=function(e){var t,n,r,a=e.handleChange,o=e.value,l=e.className,i=e.editor,u=e.locked,s=e.options,d=e.multiple,f=e.Name,v=e.Tips,p=e.scrollHidden,g=void 0===p||p,m=e.allowExistValueNotInOptions,y=void 0!==m&&m,h=e.dropdownClassName,C=i.Enum,E=i.Default,b=i.NameHidden,k=i.Required,x=i.AllowClear,w=void 0===x||x,N=i.Title,I=i.Placeholder,A=!!d,M=A?[]:E||C&&(null!==(t=null===(n=C[0])||void 0===n?void 0:n.Value)&&void 0!==t?t:null===(r=C[0])||void 0===r?void 0:r.Id);$r.log("selectValue",M);var S=s||j()(C).call(C,(function(e){var t;return{value:null!==(t=e.Value)&&void 0!==t?t:e.Id,label:e.Name,disabled:e.Locked||!1}})),L=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(n){if((0,ht.isEmpty)(t))return[];var o=null==t?void 0:t.split(","),l=!1;return a||(o=c()(o).call(o,(function(t){var n=fe()(e).call(e,(function(e){return e.value===t}));return!1===n&&(l=!0),n}))),l&&r(o.join(",")),o}if((0,ht.isEmpty)(t))return"";var i=t;return fe()(e).call(e,(function(e){return e.value===t}))||(i=""),i}(S,o,A,a,y);return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:b,className:l,name:f,tips:v,required:k,title:N}),P().createElement(V.Select,{scrollHidden:g,disabled:u,placeholder:I||ba("designer.editor.key0009"),borderType:"bordered",value:L,allowClear:w,onChange:function(e){if(!u){var t=e;T()(e)&&(t=e.join(",")),a(t)}},options:S,mode:A?"multiple":"single",notFoundContent:ba("designer.editor.key0021"),dropdownClassName:h}))};var Ho=Uo,zo=function(e){var t=e.handleChange,n=e.value,r=e.locked,a=e.className,o=e.editor,l=e.Name,i=e.Tips,c=e.onLinkClick,u=o.NameHidden,s=o.Required;return P().createElement(P().Fragment,null,P().createElement(V.Checkbox,{checked:n||!1,disabled:r,onChange:function(e){t(e.target.checked)}},P().createElement(Po,{nameHidden:u,className:a,name:l,tips:i,required:s,onLinkClick:c})))},qo=["1403","1404"],Wo=function(e){var t=e.handleChange,n=e.value,r=e.className,a=e.editor,o=e.locked,l=e.Name,i=e.Tips,u=e.LockType,s=e.field,d=(e.Id,e._originPropsValue_),f=a.NameHidden,v=a.Required,p=a.Title,g=a.Enum,m=(0,L.useState)((function(){return n?n.split(","):[]})),y=(0,k.c)(m,2),h=y[0],C=y[1];(0,L.useEffect)((function(){h.join(",")!==n&&C(n?n.split(","):[])}),[n]);var E=(0,L.useCallback)((function(e){C(e)}),[t]);(0,L.useEffect)((function(){var e=h.length?h.join(","):"";e!==n&&t(e)}),[h]);var b=s._Type_;return"date"===s.Type&&"CommonDateFilterColumnAp"===b&&(g=c()(g).call(g,(function(e){return!w()(qo).call(qo,null==e?void 0:e.Id)}))),P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:f,className:r,name:l,tips:i,required:v,title:p}),P().createElement(V.Checkbox.Group,{disabled:o,value:h,className:"".concat(r,"-checkbox-group"),onChange:E},j()(g).call(g,(function(e){var t=e.Disabled||!o&&"speciallock"===u&&(null==d?void 0:w()(d).call(d,e.Id))&&(null==h?void 0:w()(h).call(h,e.Id));return P().createElement(V.Checkbox,{key:e.Value||e.Id,value:e.Value||e.Id,disabled:t},e.Name)}))))},Go=function(e){var t=e.handleChange,n=e.value,r=e.className,a=e.editor,o=e.locked,l=e.Name,i=e.Tips,c=e.Id,u=e.field,s=e.readonly,d=a.NameHidden,f=a.Required,v=a.Title,p=a.SubTitle,g=n||!1;(0,L.useContext)(Zr).getSelection().length>1&&""===n&&(g=u[c]);var m=o||s;return P().createElement("div",{className:"".concat(r,"-switch")},P().createElement(Po,{nameHidden:d,className:r,name:l,tips:i,required:f,title:v,subTitle:p}),P().createElement(V.Switch,{checked:g,size:"large",disabled:m,onClick:function(){m||t(!n)}}))},Qo=V.Select.Option,Zo=function(e){var t=e.handleChange,n=e.value,r=e.className,a=e.editor,o=e.locked,l=e.Name,i=e.Tips,c=a.NameHidden,u=(a.Default,a.Min),s=a.Max,d=a.Prefix,f=void 0===d?{}:d,v=a.Required,p=a.Title,g=a.AllowClear,m=(f||{}).Value,y=(0,L.useRef)(null),h=(0,L.useState)((function(){return n?String(ta()(n)):""})),E=(0,k.c)(h,2),b=E[0],x=E[1],w=(0,L.useState)((function(){return(null==n?void 0:He()(n).call(n,"%"))>-1?"%":"px"})),N=(0,k.c)(w,2),A=N[0],M=N[1],S=(0,L.useState)(!1),T=(0,k.c)(S,2),R=T[0],D=T[1],B=(0,L.useRef)(null),F={borderType:"bordered",prefix:m||null,allowClear:g},K=(0,L.useMemo)((function(){var e={};return(0,ht.isUndefined)(u)||(e.min=u),(0,ht.isUndefined)(s)||(e.max=s),e}),[u,s]);(0,L.useEffect)((function(){if(!R){var e=n?String(ta()(n)):"",t=(null==n?void 0:He()(n).call(n,"%"))>-1?"%":"px";e!==b&&x(e),t!==A&&M(t)}}),[n]);var O=function(e){B.current&&clearTimeout(B.current),B.current=I()((function(){B.current=null,t(e)}),300)};return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:c,className:r,name:l,tips:i,required:v,title:p}),P().createElement("div",{className:"".concat(r,"-dimission-editor")},P().createElement(V.InputNumber,(0,C.c)({},F,{zeroShow:!0,className:"".concat(r,"-dimission-editor-input"),ref:y,value:b,onKeyPress:function(e){e.stopPropagation();var t=["-","+","e","E"];-1!==He()(t).call(t,e.key)&&e.preventDefault()},onChange:function(e){var t=e.target.value;if(x(t),""===t)O(void 0);else{var n=ta()(e.target.value)+A;O(n)}},onFocus:function(){D(!0)},onBlur:function(){D(!1)},disabled:o,mustInScope:!1},K)),P().createElement(V.Select,{scrollHidden:!0,className:"".concat(r,"-dimission-editor-unit"),borderType:"none",value:A,onChange:function(e){b?t(b+e):M(e)}},P().createElement(Qo,{value:"px"},"px"),P().createElement(Qo,{value:"%"},"%"))))},Yo=function(e){var t,n=e.handleChange,r=e.value,a=e.className,o=e.editor,l=e.Name,i=e.Tips,c=e.renderItem,u=o.Enum,s=o.NameHidden,d=o.Default,f=o.Required,v=o.Title,p=j()(u).call(u,(function(e){return(0,C.c)({},e,{Value:e.Value||e.Id})})),g=(0,ht.isUndefined)(r)?d||(null===(t=p[0])||void 0===t?void 0:t.Value):String(r);return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:s,className:a,name:l,tips:i,required:f,title:v}),P().createElement("div",{className:"".concat(a,"-tab-editor")},j()(p).call(p,(function(e){var t=e.IconClassName,r=e.IconTitle;return P().createElement("div",{key:e.Value,className:Ne()(["".concat(a,"-tab-editor-item"),{"is-active":String(g)===String(e.Value)}]),onClick:function(){return t=e.Value,void n(t);var t},title:t&&r},c?c(e):t?P().createElement("i",{className:t}):e.Name)}))))},Xo=V.Radio.Group,Jo=function(e){var t,n,r,a=e.handleChange,o=e.className,l=e.value,i=e.editor,c=e.locked,u=e.Name,s=e.Tips,d=i.Enum,f=i.Default,v=i.NameHidden,p=i.Required,g=i.Vertical,m=i.Title,y=f||d&&(null!==(t=null===(n=d[0])||void 0===n?void 0:n.Value)&&void 0!==t?t:null===(r=d[0])||void 0===r?void 0:r.Id),h=(0,ht.isUndefined)(l)?y:l,C=j()(d).call(d,(function(e){var t;return{label:e.Name,value:null!==(t=e.Value)&&void 0!==t?t:e.Id}}));return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:v,className:o,name:u,tips:s,required:p,title:m}),P().createElement(Xo,{className:Ne()((0,b.c)({},"".concat(o,"-radio-editor-vertical"),g)),disabled:c,value:h,onChange:function(e){a(e.target.value)},options:C}))},$o=function(e){var t=e.value,n=e.Name,r=e.className;return P().createElement("div",{className:"".concat(r,"-readonly")},P().createElement("span",{className:"".concat(r,"-readonly-title"),title:n},n,"："),P().createElement("span",{className:"".concat(r,"-readonly-content"),title:t},t))},el=n(89280),tl=function(){function e(){(0,Pr.c)(this,e),(0,b.c)(this,"listeners",[])}return(0,Rr.c)(e,[{key:"addDataChangeListener",value:function(e){var t=this;return this.listeners.push(e),function(){var n;t.listeners=c()(n=t.listeners).call(n,(function(t){return e!==t}))}}},{key:"fireEvent",value:function(e){var t;f()(t=this.listeners).call(t,(function(t){try{t(e)}catch(e){}}))}}]),e}();function nl(e,t,n){return t=(0,Pa.c)(t),(0,La.c)(e,rl()?Ta()(t,n||[],(0,Pa.c)(e).constructor):t.apply(e,n))}function rl(){try{var e=!Boolean.prototype.valueOf.call(Ta()(Boolean,[],(function(){})))}catch(e){}return(rl=function(){return!!e})()}var al=function(e){return void 0===e?null:e},ol=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,Pr.c)(this,t),e=nl(this,t),(0,b.c)((0,el.c)(e),"aliasData",{}),(0,b.c)((0,el.c)(e),"getAliasData",(function(){return e.aliasData})),(0,b.c)((0,el.c)(e),"getAliasDataPropValue",(function(t,n,r){return(0,ht.property)([t,n,Ze()(al(r))])(e.aliasData)})),(0,b.c)((0,el.c)(e),"hasAliasDataPropValue",(function(t,n,r){return(0,ht.has)(e.aliasData,[t,n,Ze()(al(r))])})),(0,b.c)((0,el.c)(e),"setAliasDataPropValue",(function(t){var n=e.aliasData,r=T()(t)?t:[t];if(e.aliasData=(0,Ha.Ut)(e.aliasData,(function(e){f()(r).call(r,(function(t){var n=t.type,r=t.propName,a=t.value,o=t.alias;(0,ht.set)(e,[n,r,Ze()(al(a))],o)}))})),n!==e.aliasData){var a={type:Wa.Set,value:e.aliasData,oldValue:n};e.fireEvent(a)}})),e.aliasData=n,e}return(0,Ra.c)(t,e),(0,Rr.c)(t,[{key:"addAliasDataChangeListener",value:function(e){return this.addDataChangeListener(e)}}]),t}(tl),ll=P().createContext({}),il=function(e){var t=e.value,n=e.className,r=e.editor,a=e.propName,o=e.field,l=e.handleChange,i=e.onCustomInputClick,c=e.handleClear,u=e.ReadOnly,s=e.locked,d=r.Default,f=r.NameHidden,v=r.BtnName,p=r.MaxLength,g=r.Editable,m=void 0!==g&&g,y=r.Alias,h=void 0!==y&&y,E=r.Required,b=void 0!==E&&E,k=r.Title,x=e.Name,w=e.Tips,N=e.LockType,I={style:{},borderType:"bordered"};!0===m&&(0,C.c)(I,{maxLength:p});var A=t;!0===h&&($r.log("alias",A),A=t&&"object"===(0,er.c)(t)?Ze()(t):t);var M=(0,L.useContext)(zr),S=M.onCustomInputClick,T=M.getEditorFormatValue,R=M.keywordMapping,D=function(){var e=(0,L.useState)(0)[1];return function(){e((function(e){return e+1}))}}(),B=(0,L.useContext)(ll),F=B.addAliasDataChangeListener,K=B.getAliasDataPropValue,O=A||d,_=T(a,o,r)||(O&&"object"===(0,er.c)(O)?Ze()(O):O);(0,L.useEffect)((function(){var e=F((function(){(0,ht.isEqual)(_,K(o[R.type],a,O))||D()}));return function(){e()}}),[_,o[R.type],a,O]);var j=(u||s)&&"speciallock"!==N,U=function(){j||(i?i&&i(a,o,r):S&&S(a,o,r))},H=!(!1!==m||b||!t||u||s||"speciallock"===N),z=void 0===_&&!1===m?"":_;if(v)return P().createElement("div",{className:"".concat(n,"-custom-editor")},P().createElement(Po,{nameHidden:f,className:n,name:x,tips:w,required:b,title:k}),P().createElement("div",null,P().createElement("span",{onClick:U,className:"".concat(n,"-custom-btn")},v)));var q=u||s||"speciallock"===N;return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:f,className:n,name:x,tips:w,required:b,title:k}),P().createElement("div",{className:"".concat(n,"-custom-input")},P().createElement(V.Input,(0,C.c)({},I,{value:z,readOnly:q,disabled:q,suffix:P().createElement(P().Fragment,null,H&&P().createElement("div",{title:"",className:"".concat(n,"-clear"),onClick:function(){c?c(d):l(d)}},P().createElement(V.Icon,{type:"close"})),P().createElement(V.Icon,{prefix:"designericon",type:"gengduo",style:{cursor:j?"not-allow":"pointer"},onClick:U}))}))))},cl=function(e){var t=e.handleChange,n=e.value,r=e.locked;return P().createElement(P().Fragment,null,P().createElement(V.Checkbox,{value:n||!1,disabled:r,onChange:function(e){t(e.target.value)}},P().createElement("div",null,V.Icons[e.Name])))};function ul(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function sl(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=ul(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=ul(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var dl=V.Select.Option,fl=function(e){if(!e)return{};var t=(0,ht.split)(e,"_"),n={};return n.Width=t[0],n.Style=t[1],n.Color=t[2],n},vl=function(e){if(null==e||!e.Width)return"";var t=["0px","solid","#000000"];return null!=e&&e.Style&&(t[1]=e.Style),null!=e&&e.Color&&(t[2]=e.Color),null!=e&&e.Width&&(t[0]=e.Width),t.join("_")},pl=function(e){var t=e.handleChange,n=e.value,r=void 0===n?{}:n,a=e.className,o=(e.editor,(0,L.useState)(!1)),l=(0,k.c)(o,2),i=l[0],c=l[1],u=(0,L.useRef)(null),s=(0,L.useRef)(null),d=function(){var e,t,n,a,o=sl({},r);if(null==o||!o.Border)return"";var l=null==o||null===(e=o.Border)||void 0===e?void 0:e.Top,i=null==o||null===(t=o.Border)||void 0===t?void 0:t.Right,c=null==o||null===(n=o.Border)||void 0===n?void 0:n.Bottom,u=null==o||null===(a=o.Border)||void 0===a?void 0:a.Left;return l=l?l.split("_")[2]:"",i=i?i.split("_")[2]:"",c=c?c.split("_")[2]:"",u=u?u.split("_")[2]:"",l===i&&l===c&&l===u?l:""},f=(0,L.useState)(d()),v=(0,k.c)(f,2),p=v[0],g=v[1];(0,L.useEffect)((function(){g((function(){return d()}))}),[r]);var m=function(e,t,n){var r="0";if("Border"==t){var a=null==e?void 0:e[n],o=fl(a);r=(null==o?void 0:o.Width)||""}else r=(null==e?void 0:e[n])||"";return(0,ht.endsWith)(r,"px")&&(r=(0,ht.replace)(r,"px","")),r},y=function(e){var t,n,a,o,l,i,c=[],u=null==r?void 0:r[e];return c[0]=m(u,e,"Top"),c[1]=m(u,e,"Right"),c[2]=m(u,e,"Bottom"),c[3]=m(u,e,"Left"),c[0]===c[1]&&c[0]===c[2]&&c[0]===c[3]?"0"===c[0]?"0":c[0]:c[0]===c[2]&&c[1]===c[3]?M()(o="".concat(c[0]||0," ")).call(o,c[1]||0):c[1]===c[3]?M()(l=M()(i="".concat(c[0]||0," ")).call(i,c[1]||0," ")).call(l,c[2]||0):M()(t=M()(n=M()(a="".concat(c[0]||0," ")).call(a,c[1]||0," ")).call(n,c[2]||0," ")).call(t,c[3]||0)},h=(0,L.useState)((function(){return y("Margin")})),C=(0,k.c)(h,2),E=C[0],x=C[1],w=(0,L.useState)((function(){return y("Border")})),N=(0,k.c)(w,2),I=N[0],A=N[1],S=(0,L.useState)((function(){return y("Padding")})),T=(0,k.c)(S,2),R=T[0],D=T[1];(0,L.useEffect)((function(){var e=y("Margin"),t=y("Border"),n=y("Padding");E!==e&&x(e),I!==t&&x(t),R!==n&&x(n)}),[r]);var B=function(e,t){var n,r,a,o,l=e.length;1===l?n=r=a=o=e[0]:2===l?(n=a=e[0],r=o=e[1]):3===l?(n=e[0],r=o=e[1],a=e[2]):4===l&&(n=e[0],r=e[1],a=e[2],o=e[3]);var i,c,u,s,d={Width:"".concat(n||"","px")},f={Width:"".concat(r||"","px")},v={Width:"".concat(a||"","px")},p={Width:"".concat(o||"","px")};null!=t&&t.Border&&(d=sl(sl({},fl(null==t||null===(i=t.Border)||void 0===i?void 0:i.Top)),{},{Width:"".concat(n,"px")}),f=sl(sl({},fl(null==t||null===(c=t.Border)||void 0===c?void 0:c.Right)),{},{Width:"".concat(r,"px")}),v=sl(sl({},fl(null==t||null===(u=t.Border)||void 0===u?void 0:u.Bottom)),{},{Width:"".concat(a,"px")}),p=sl(sl({},fl(null==t||null===(s=t.Border)||void 0===s?void 0:s.Left)),{},{Width:"".concat(o,"px")}));return{Top:vl(d),Right:vl(f),Bottom:vl(v),Left:vl(p)}},F=function(e,n,r){var a=e;a?t(sl(sl({},e),{},(0,b.c)({},n,r))):(a=(0,b.c)({},n,r),t(a))},K=function(e,t){var n,a;if(/^[\d\s]*$/.test(e)){var o=j()(n=O()(a=e.replace(/(^\s*)|(\s*$)/g,"").replace(/\s{2,}/g," ").split(" ")).call(a,0,4)).call(n,(function(e){return e})),l=4===o.length?o.join(" "):e;"Border"===t?A(l):"Padding"===t?D(l):"Margin"===t&&x(l);var i=sl({},r);if(1===o.length){var c=""===o[0];if("Border"===t){var u=c?{}:B(o,i);F(i,t,u)}else{var s=c?{}:{Top:"".concat(o[0],"px"),Right:"".concat(o[0],"px"),Bottom:"".concat(o[0],"px"),Left:"".concat(o[0],"px")};F(i,t,s)}}else if(2===o.length)if("Border"===t){var d=B(o,i);F(i,t,d)}else{var f={Top:"".concat(o[0],"px"),Right:"".concat(o[1],"px"),Bottom:"".concat(o[0],"px"),Left:"".concat(o[1],"px")};F(i,t,f)}else if(3===o.length)if("Border"===t){var v=B(o,i);F(i,t,v)}else{var p={Top:"".concat(o[0],"px"),Right:"".concat(o[1],"px"),Bottom:"".concat(o[2],"px"),Left:"".concat(o[1],"px")};F(i,t,p)}else if(4===o.length)if("Border"===t){var g=B(o,i);F(i,t,g)}else{var m={Top:"".concat(o[0],"px"),Right:"".concat(o[1],"px"),Bottom:"".concat(o[2],"px"),Left:"".concat(o[3],"px")};F(i,t,m)}}},_=function(e,t,n){var r,a=null==e||null===(r=e.Border)||void 0===r?void 0:r[n],o=fl(a);return o.Color=t,vl(o)},U=function(e){var n,a=sl({},r);a||(a={}),null!==(n=a)&&void 0!==n&&n.Border||(a.Border={},A("1"));var o=_(a,e,"Top"),l=_(a,e,"Right"),i=_(a,e,"Bottom"),c=_(a,e,"Left");a.Border=sl(sl({},a.Border),{},{Top:o,Right:l,Bottom:i,Left:c}),t(a)};return P().createElement("div",{className:"singleBorderpanel"},P().createElement("div",{className:"singlepanel-item"},P().createElement("label",null,ba("designer.editor.key0001")),P().createElement(V.Input,{borderType:"bordered",value:E,onChange:function(e){return K(e.target.value,"Margin")}})),P().createElement("div",{className:"singlepanel-item"},P().createElement("label",null,ba("designer.editor.key0002")),P().createElement(V.Input,{borderType:"bordered",value:R,onChange:function(e){return K(e.target.value,"Padding")}})),P().createElement("div",{className:"singlepanel-item"},P().createElement("label",null,ba("designer.editor.key0003")),P().createElement(V.Input,{borderType:"bordered",value:I,onChange:function(e){return K(e.target.value,"Border")}})),P().createElement("div",{className:"singlepanel-item"},P().createElement("label",null,ba("designer.editor.key0004")),P().createElement("div",{className:"".concat(a,"-color-editor"),ref:s},P().createElement(No,{className:"".concat(a,"-color-editor"),type:"backgroundColor",color:p,onClick:function(){c(!0)}}),P().createElement(V.Input,{className:"".concat(a,"-color-editor-input"),ref:u,borderType:"bordered",value:p,onChange:function(e){var t=e.target.value;g(t);(t.match(/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/)||/^themeColor/.test(t))&&U(t)},onClick:function(){c(!0)}})),P().createElement(So,{triggerDom:s,showPanel:i,colorValue:p,onClosePanel:function(){c(!1)},onChange:U})))},gl=function(e){var t=e.title,n=e.bgc,r=e.mold,a=e.children,o=e.value,l=e.onChange,i=e.onFocus,c=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",a="";if(e){if("Border"==r){var o=e[t];if(""===o)a="";else{var l=fl(o);a=(0,ht.isUndefined)(null==l?void 0:l.Width)?n:null==l?void 0:l.Width}}else a=(0,ht.isUndefined)(e[t])?n:e[t];(0,ht.endsWith)(a,"px")&&(a=(0,ht.replace)(a,"px",""))}return a},u=(0,L.useState)((function(){return c(o,"Top")})),s=(0,k.c)(u,2),d=s[0],f=s[1],v=(0,L.useState)((function(){return c(o,"Left")})),p=(0,k.c)(v,2),g=p[0],m=p[1],y=(0,L.useState)((function(){return c(o,"Right")})),h=(0,k.c)(y,2),C=h[0],E=h[1],b=(0,L.useState)((function(){return c(o,"Bottom")})),x=(0,k.c)(b,2),w=x[0],N=x[1],I=function(e,t,n){var r=new(Bt())([["Top",f],["Left",m],["Right",E],["Bottom",N]]).get(n);null==r||r(e),l&&l(e,t,n)},A=function(e,t){i&&i(e,t)};return(0,L.useEffect)((function(){var e=c(o,"Top"),t=c(o,"Left"),n=c(o,"Right"),r=c(o,"Bottom");e!==d&&f((function(){return c(o,"Top")})),t!==g&&m((function(){return c(o,"Left")})),n!==C&&E((function(){return c(o,"Right")})),r!==w&&N((function(){return c(o,"Bottom")}))}),[o]),P().createElement("div",{className:"".concat(n," marginbox"),tabIndex:-1},P().createElement("div",{className:"top"},P().createElement("span",{className:"title"},t),P().createElement("div",{className:"value"},P().createElement("input",{className:"ip",onChange:function(e){return I(e.target.value,r,"Top")},onFocus:function(e){return A(r,"Top")},value:d}))),P().createElement("div",{className:"center"},P().createElement("div",{className:"value"},P().createElement("input",{className:"ip",onChange:function(e){return I(e.target.value,r,"Left")},onFocus:function(e){return A(r,"Left")},value:g})),P().createElement("div",{className:"content"},a),P().createElement("div",{className:"value"},P().createElement("input",{className:"ip",onChange:function(e){return I(e.target.value,r,"Right")},onFocus:function(e){return A(r,"Right")},value:C}))),P().createElement("div",{className:"bottom"},P().createElement("div",{className:"value"},P().createElement("input",{className:"ip",onChange:function(e){return I(e.target.value,r,"Bottom")},onFocus:function(e){return A(r,"Bottom")},value:w}))))},ml=function(e){var t=e.handleChange,n=e.value,r=void 0===n?{}:n,a=e.className,o=e.editor,l=e.locked,i=e.Name,c=e.Tips,u=o.NameHidden,s=o.Required,d=o.Title,f=(0,L.useState)(!1),v=(0,k.c)(f,2),p=v[0],g=v[1],m=(0,L.useState)(!1),y=(0,k.c)(m,2),h=y[0],E=y[1],x=(0,L.useState)(""),w=(0,k.c)(x,2),N=w[0],I=w[1],A=(0,L.useState)(!1),M=(0,k.c)(A,2),S=M[0],T=M[1],R=(0,L.useRef)(null),D=(0,L.useRef)(null),B=(0,L.useRef)(null),F=(0,L.useState)(!1),K=(0,k.c)(F,2),O=K[0],_=K[1],U=["solid","dotted","dashed"],H=Ne()({borderpanel:!0,hidden:!p}),z=(null==r?void 0:r.Border)||{},q=fl(null==z?void 0:z[N]),W=null==q?void 0:q.Color,G=(0,L.useState)(W||""),Q=(0,k.c)(G,2),Z=Q[0],Y=Q[1],X=null==q?void 0:q.Style;(0,L.useEffect)((function(){Y(W||"")}),[W]);var J=function(e){return r&&r[e]||{}},$=function(e,t){_(!0),"Border"===e?(g(!0),I(t)):g(!1)},ee=function(e,n,a){var o=sl({},r),l=e?"".concat(e,"px"):"",i=(0,b.c)({},a,l);if(o)if("Border"===n)if(null!=o&&o[n]){var c,u=null==o||null===(c=o[n])||void 0===c?void 0:c[a],s=fl(u);s.Width=l;var d=vl(s);o[n]=sl(sl({},o[n]),{},(0,b.c)({},a,d)),t(sl(sl({},o),{},(0,b.c)({},n,sl(sl({},o[n]),{},(0,b.c)({},a,d)))))}else{var f={};f.Width=l;var v=vl(f);i=(0,b.c)({},a,v),t(sl(sl({},o),{},(0,b.c)({},n,i)))}else null!=o&&o[n]?(o[n]=sl(sl({},o[n]),{},(0,b.c)({},a,l)),t(o)):(o[n]=i,t(o));else if("Border"===n){var p={};p.Width=l;var g=vl(p);i[a]=g,t({Border:i})}else t((0,b.c)({},n,i))},te=function(e){var n,a,o=sl({},r);o||(o={}),null!==(n=o)&&void 0!==n&&n.Border||(o.Border={});var l=null===(a=o)||void 0===a||null===(a=a.Border)||void 0===a?void 0:a[N],i=fl(l);i.Color=e,null!=i&&i.Width||(i.Width="1px");var c=vl(i);o.Border=sl(sl({},o.Border),{},(0,b.c)({},N,c)),t(o)};return aa([B],(function(){_(!1)})),P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:u,className:a,name:i,tips:c,required:s,title:d}),P().createElement("div",{className:"".concat(a,"-border-editor")},P().createElement("div",{className:"editTab",onClick:function(e){E((function(e){return!e}))}},P().createElement("i",{className:"kdfont kdfont-yijiaoyingyonghuise"}),ba(h?"designer.editor.key0005":"designer.editor.key0006")),h?P().createElement(pl,(0,C.c)({},e,{onColorChange:te})):P().createElement("div",{ref:B},P().createElement("div",{className:Ne()(["edit-box-wrap",{"edit-box-wrap-focused":O}])},P().createElement(gl,{title:ba("designer.editor.key0001"),mold:"Margin",bgc:"marginbgc",onFocus:$,value:J("Margin"),onChange:ee},P().createElement(gl,{title:ba("designer.editor.key0003"),mold:"Border",bgc:"borderbgc",onFocus:$,value:J("Border"),onChange:ee},P().createElement(gl,{title:ba("designer.editor.key0002"),mold:"Padding",bgc:"paddingbgc",onFocus:$,value:J("Padding"),onChange:ee},P().createElement("div",{className:"whbox",onClick:function(){t(void 0)}},P().createElement("i",{className:"arrow kdfont kdfont-shuaxin","aria-hidden":"true"}))))),P().createElement("div",{className:"line-box top-left"}),P().createElement("div",{className:"line-box bottom-left"}),P().createElement("div",{className:"line-box top-right"}),P().createElement("div",{className:"line-box bottom-right"})),p&&P().createElement("div",{className:H},P().createElement("div",{className:"panel-edit-box"},P().createElement("div",{className:"".concat(a,"-color-editor"),ref:D},P().createElement(No,{className:"".concat(a,"-color-editor"),type:"backgroundColor",color:Z,onClick:function(){T(!0)}}),P().createElement(V.Input,{className:"".concat(a,"-color-editor-input"),ref:R,borderType:"bordered",value:Z,onChange:function(e){var t=e.target.value;Y(t);(t.match(/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/)||/^themeColor/.test(t))&&te(t)},disabled:l,onClick:function(){T(!0)}})),P().createElement(So,{triggerDom:D,showPanel:S,colorValue:Z,onClosePanel:function(){T(!1)},onChange:te})),P().createElement("div",{className:"panel-edit-box"},P().createElement(V.Select,{scrollHidden:!0,borderType:"bordered",placeholder:"",onChange:function(e){var n,a,o=sl({},r);o||(o={}),null!==(n=o)&&void 0!==n&&n.Border||(o.Border={});var l=null===(a=o)||void 0===a||null===(a=a.Border)||void 0===a?void 0:a[N],i=fl(l);i.Style=e,null!=i&&i.Width||(i.Width="1px");var c=vl(i);o.Border=sl(sl({},o.Border),{},(0,b.c)({},N,c)),t(o)},value:X,dropdownRender:function(e){var t;return P().cloneElement(e,{},null===(t=e.props.children)||void 0===t||null===(t=t.props.data)||void 0===t?void 0:j()(t).call(t,(function(e){var t=e.props.value;return P().cloneElement(e,{},[P().createElement("div",{style:{marginTop:"5px",border:"".concat(t," 1px #000"),flexGrow:1}})])})))}},j()(U).call(U,(function(e,t){return P().createElement(dl,{key:t,style:{display:"flex",alignItems:"center",height:"28px"},value:e},e)}))))))))},yl=function(e){var t=e.handleChange,n=e.value,r=e.className,a=e.editor,o=e.locked,l=e.Name,i=e.Tips,c=a.NameHidden,u=a.Required,s=a.Title,d=(0,L.useMemo)((function(){var e=n?n.split(","):[];return j()(e).call(e,(function(e){return e?new Date(e):null}))}),[n]);return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:c,className:r,name:l,tips:i,required:u,title:s}),P().createElement(V.RangePicker,{className:"".concat(r,"-daterange-editor"),defaultValue:d,borderType:"bordered",disabled:o,onChange:function(e,n){var r=n.join(",");","===r&&(r=""),t(r)}}))},hl=function(e){var t=(0,L.useRef)(null),n=e.handleChange,r=e.value,a=e.className,o=e.locked,l=e.Editor,i=e.Name,c=e.Tips,u=l.NameHidden,s=l.Min,d=l.Max,f=l.Required,v=l.DataType,p=l.Title,g=l.SubTitle,m=l.Placeholder,y=l.AllowClear,h=((0,L.useContext)(zr).showMessage,(0,L.useState)(String(r||""))),C=(0,k.c)(h,2),E=C[0],b=C[1],x=(0,L.useState)(!1),w=(0,k.c)(x,2),N=w[0],A=w[1],M=(0,L.useRef)(null);(0,L.useEffect)((function(){var e=(0,ht.isUndefined)(r)?"":String(r);N||e===E||b(e)}),[r,N]);var S=function(e){M.current&&clearTimeout(M.current),M.current=I()((function(){M.current=null,function(e){""!==e&&"Decimal"===v&&(e=ta()(e)),n(e)}(e)}),300)};return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:u,className:a,name:i,tips:c,required:f,title:p,subTitle:g}),P().createElement("div",{className:"".concat(a,"-stepper-editor"),onFocus:function(){A(!0)},onBlur:function(e){A(!1);var t=E;""!==t?(s||0==s)&&t<s&&(t=s,b(String(s)),n(s)):(0,ht.isUndefined)(s)||(t=s,b(String(s)),n(s))},tabIndex:-1},P().createElement(V.Stepper,{ref:t,type:"embed",value:E,allowClear:!!y,zeroShow:!0,onChange:function(e){if(!o){var t=e.target.value||"";if(isNaN(t)&&(t=""),""!==t){if(e.nativeEvent){if(!(0,ht.isUndefined)(s)&&t<Number(s))return b(t);!(0,ht.isUndefined)(d)&&t>Number(d)&&(t=d)}else!(0,ht.isUndefined)(s)&&t<Number(s)&&(t=s),!(0,ht.isUndefined)(d)&&t>Number(d)&&(t=d);"Integer"===v&&(t=wo()(t)),b(String(t))}else b("");S(t)}},onKeyPress:function(e){s>=0&&"-"===e.key&&e.preventDefault()},disabled:o,placeholder:m})))},Cl=function(e){var t=e.handleChange,n=(e.value,e.className),r=e.editor,a=e.locked,o=e.picker,l=e.Name,i=e.Tips,c=r.NameHidden,u=r.Required,s=r.AllowClear,d=r.BorderType,f=r.Placeholder,v=r.Title,p=r.Picker;return P().createElement(P().Fragment,null,P().createElement(Po,{nameHidden:c,className:n,name:l,tips:i,required:u,title:v}),P().createElement(V.DatePicker,{className:"".concat(n,"-datepicker-editor"),dropdownClassName:"".concat(n,"-datepickerpanel-editor"),disabled:a,borderType:d,allowClear:s,onOk:t,onChange:t,picker:p||o,placeholder:f}))},El={Input:jo,TextArea:jo,Checkbox:zo,Switch:Go,Radio:Jo,iconCheck:cl,Select:Ho,MultiSelect:function(e){return P().createElement(Uo,(0,C.c)({},e,{multiple:!0}))},CustomInput:il,CheckBoxGroup:Wo,Dimension:Zo,Tab:Yo,ReadOnly:$o,Color:_o,Border:ml,DateRange:yl,Stepper:hl,TimePicker:function(e){return P().createElement(Cl,(0,C.c)({},e,{picker:"time"}))},DatePicker:Cl};a()(El);var bl=P().createContext({}),kl=n.p+"images/b7faef5a0338c01e97e8b6d7d8f7511f.png",xl=n(5944);var wl={propertyActions:{ChangeEditorType:function(e){return[{key:e.Key,editorProp:{Type:e.Value}}]},ChangeDefaultValue:function(e){return[{key:e.Key,editorProp:{Default:e.Value}}]},HideProperty:function(e){var t,n=e.Key;return j()(t=n).call(t,(function(e){return{key:e,prop:{Visible:!1}}}))},ShowProperty:function(e){var t,n=e.Key;return j()(t=n).call(t,(function(e){return{key:e,prop:{Visible:!0}}}))},LockProperty:function(e){var t,n=e.Key;return j()(t=n).call(t,(function(e){return{key:e,prop:{Locked:!0}}}))},UnLockProperty:function(e){var t,n=e.Key;return j()(t=n).call(t,(function(e){return{key:e,prop:{Locked:!1}}}))}},dataActions:{SetValue:function(e){for(var t=e.Key,n=e.Value,r={},a=0;a<t.length;a++)r[Ct().camelCase(t[a])]=n[a];return r},ExchangeValue:function(e,t){for(var n=e.Key,r=e.Value,a={},o=0;o<n.length;o++)a[Ct().camelCase(n[o])]=t[Ct().camelCase(r[o])];return a},SetPropertyValue:function(e){for(var t=e.Key,n=e.Value,r={},a=0;a<t.length;a++)r[t[a]]=n[a];return r}}},Nl=wl,Il="property",Al="data";var Ml=function(){var e,t,n={},r={},o=function(e){return function(t,a,o){var l;(e===Il?n:r)[o?M()(l="".concat(o,"-")).call(l,t):t]=a}};return f()(e=a()(Nl.propertyActions)).call(e,(function(e){o(Il)(e,Nl.propertyActions[e])})),f()(t=a()(Nl.dataActions)).call(t,(function(e){o(Al)(e,Nl.dataActions[e])})),{rigistAction:o,getAction:function(e){return function(t,a){var o,l=e===Il?n:r;return l[M()(o="".concat(a,"-")).call(o,t)]||l[t]}}}}();const Sl="entitymeta";function Tl(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ll(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Tl(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Tl(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}function Pl(e,t){var n=void 0!==_t()&&Ut()(e)||e["@@iterator"];if(!n){if(T()(e)||(n=function(e,t){var n;if(!e)return;if("string"==typeof e)return Rl(e,t);var r=O()(n=Object.prototype.toString.call(e)).call(n,8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Tt()(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rl(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function Rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dl=function(e,t){return function(n){var r=e.Condition,a=e.Todo,o=e.ElseTodo,l=r&&xl.OE.parse(r.replace(/in\(/g,"has(").replace(/&&/g," and ").replace(/!/g," not ").replace(/\|\|/g," or ")),i=!r||l.evaluate(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=e.field,a=e.Items,o=void 0===a?[]:a,l=t[0]||{},i=l.ConditionTypes;return{is:function(e,a){var l=t[0]||{},c=l.AffectedByParent;if("HideProperty"===l.Name&&c&&(r=z()(o).call(o,(function(e){return e.Id===r.ParentId}))||r),e="Type"===e?"_Type_":e,null==a){var u=r[e]==a||""==r[e];if(u)return u;if(i){var s=Bl(r,i,e,n);return s==a||""==s}return!1}return r[e]==a||Bl(r,i,e,n)==a},eq:function(e,t){return e=Ct().camelCase(e),r[e]===t||Bl(r,i,e,n)===t},includes:function(e,t){var a,o;return(null===(a=r[e])||void 0===a?void 0:w()(a).call(a,t))||(null===(o=Bl(r,i,e,n))||void 0===o?void 0:w()(o).call(o,t))},has:function(e,t){return e=Ct().camelCase(e),(null==t?void 0:w()(t).call(t,r[e]))||(null==t?void 0:w()(t).call(t,Bl(r,i,e,n)))},isGlobal:function(t,n){return e[t]===n},Change:!0,null:null,empty:function(e){var t,a;return e=Ct().camelCase(e),!(null!==(t=r)&&void 0!==t&&null!==(t=t[e])&&void 0!==t&&t.length)||i&&n&&!(null!==(a=Bl(r,i,e,n))&&void 0!==a&&a.length)}}}(t,a,n));return i&&a?a:!i&&o?o:void 0}};function Vl(e,t,n,r){if(n)return n().getFieldPropertyInfo(e,r,t)}function Bl(e,t,n,r){if(e&&t&&T()(t)&&n&&r)for(var a=0;a<t.length;a++){var o=t[a],l=Vl(o===Sl?e.FieldId:e.Id,o,r,n);if(l)return l}}function Fl(e,t){var n=e.Name,r=e.Args,a=Ml.getAction(Il)(n,null==t?void 0:t.type);return a?a(r):[]}var Kl=function(e,t,n,r,a,o,l){var i=o.getData(),c=(0,b.c)({},t,n),u=Ll(Ll({},a),{},(0,b.c)({},t,r)),s=Ll(Ll({},i),{},{field:u});return f()(e).call(e,(function(e){var t=Dl(e,s)(l)||[];t.length&&f()(t).call(t,(function(e){var t=function(e,t){var n=e.Name,r=e.Args,a=Ml.getAction(Al)(n,null==t?void 0:t.type);return a?a(r,t):{}}(e,u);c=Ll(Ll({},c),t)}))})),c};var Ol=function(e){var t=e.DataType,n=e.Default,r=e.Enum;return _l(n,r,t)},_l=function(e,t,n){return(0,ht.isUndefined)(e)?(0,ht.isUndefined)(null==t?void 0:t[0].Value)?function(e){switch(e){case"String":return"";case"Integer":return 0;case"Boolean":return!1;default:return}}(n):null==t?void 0:t[0].Value:e},jl=function(e,t){var n="Nodes"in e?e.Nodes:[e];return ue()(n).call(n,(function(e,n){var r=t(n.Id);if(r){var a=n.Editor;a&&(e[r]=Ol(a))}return e}),{})},Ul=function(e){return function(t,n){var r,a=(n||{}).keywordMapping,o=e;return"object"===(0,er.c)(e)&&a&&(o=e[a.type]),z()(r=t.Controls).call(r,(function(e){return e.Id===o}))||{}}},Hl=function(e){return function(t){return"object"===(0,er.c)(e)?e:Ul(e)(t)}},zl=function(e){return function(t,n){var r=(n||{}).processPropertyName,a=void 0===r?function(e){return e}:r,o=ql(e)(t);return ue()(o).call(o,(function(e,t){var n=a(t.Id),r=t.Editor;return r&&(e[n]=Ol(r)),e}),{})}},ql=function(e){return function(t){var n;return(null===(n=Hl(e)(t).Properties)||void 0===n?void 0:ue()(n).call(n,(function(e,t){return t.Nodes?e.push.apply(e,(0,E.c)(t.Nodes)):e.push(t),e}),[]))||[]}},Wl=function(e,t){return function(n){for(var r=Hl(e)(n),a=0;a<(null==r||null===(o=r.Properties)||void 0===o?void 0:o.length);a++){var o,l=r.Properties[a],i=l.Nodes||[l],c=z()(i).call(i,(function(e){return e.Id===t}));if(c)return c}return{}}},Gl=function(e,t){var n=t.keywordMapping;return e&&"object"===(0,er.c)(e)?e[n.type]:e},Ql=function(e,t){return function(n,r){var a=function(t,n,a){return e(n,a)(t,r)};(0,ht.memoize)(a,t?t(r):function(e,t,n){return Ze()(n?{type:t,propName:n}:{type:t})});return function(e,t){return a(n,e,t)}}},Zl=Ql(Hl),Yl=Ql(zl),Xl=Ql(Wl),Jl=Ql((function(e,t){return function(n){return Wl(e,t)(n).Editor}})),$l=Ql((function(e,t){return function(n){return Wl(e,t)(n).Action}})),ei=Ql((function(e,t){return function(n,r){var a=Ul(e)(n,r),o=Ul(t)(n,r),l=Gl(e,r),i=(Gl(t,r),r.canAddCallback),c=o.IsContainer,u=o.Accept;o.NotAccept,o.BaseId,a.IsContainer,a.AcceptParent,a.BaseId;if(!c)return!1;if(u&&T()(u))return w()(u).call(u,l);if(i&&"function"==typeof i){var s=i(e,t,a,o);if("object"===(0,er.c)(s))return s;if(!(0,ht.isUndefined)(s))return!!s}return!0}}),(function(e){return function(t,n,r){var a=e.keywordMapping,o=function(e){return"object"===(0,er.c)(e)?e[a.type]:e};return Ze()(r?{childType:o(n),parentType:o(r)}:{childType:o(n)})}})),ti=Ql((function(e,t){return function(n){for(var r=Hl(e)(n),a=0;a<r.Properties.length;a++){var o=r.Properties[a],l="Nodes"in o?o.Nodes:[o],i=z()(l).call(l,(function(e){return e.Id===t}));if(i)return Ol(i.Editor)}}})),ni=function(e,t){var n=Zl(e,t),r=Yl(e,t),a=Xl(e,t),o=Jl(e,t),l=$l(e,t),i=ei(e,t),c=ti(e,t);return{getMeta:function(){return e},getDefaultData:function(e){return r(e)},getControlMeta:function(e){return n(e)},getControlMetaProperty:function(e,t){return a(e,t)},getControlMetaEditor:function(e,t){return o(e,t)},getControlMetaAction:function(e,t){return l(e,t)},canAdd:function(e,t){return i(e,t)},getControlDefaultDataByPropertyGroups:function(e){return function(e,t){var n=(t||{}).processPropertyName,r=void 0===n?function(e){return e}:n,a={};return f()(e).call(e,(function(e){(0,C.c)(a,jl(e,r))})),a}(e,t)},getControlMetaPropertyGroups:function(e){var t;return null===(t=n(e))||void 0===t?void 0:t.Properties},getControlPropertyDefaultValue:function(e,t){return c(e,t)}}},ri=["Id","Properties"];function ai(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function oi(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=ai(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=ai(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var li="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function ii(e){var t,n;for(t=[],n=0;n<e.length;n++)t.push(li[e[n]%62]);return t.join("")}var ci=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;if(void 0!==window.crypto)return ii(window.crypto.getRandomValues(new Uint8Array(e)));for(var t=new Array(e),n=0;n<e;n++)t[n]=Math.floor(256*Math.random());return ii(t)},ui={type:"type",name:"name",key:"key",parentId:"parentId",items:"items"},si=(Ct().memoize(jl,(function(e){return Ze()(e)})),Ct().memoize(jl,(function(e){return Ze()(e)})),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ui,r=new(Pt())(j()(t).call(t,(function(e){return e[n.key]}))),a=0;return j()(e).call(e,(function(e){for(var t,o=e[n.key]||e[n.type],l=o=null===(t=o)||void 0===t?void 0:O()(t).call(t,0,25);r.has(o);){var i,c=25-"".concat(a+=1).length;o=M()(i="".concat(null==l?void 0:O()(l).call(l,0,c))).call(i,a)}return r.add(o),oi(oi({},e),{},(0,b.c)({},n.key,o))}))}),di=function(e,t){var n=Zl(e);return function(e){var t=e.type,r=e.transferData,a={},o=n(t);return o&&(0,C.c)(a,o),r&&(0,C.c)(a,r),a}},fi=function(e,t){var n=t||ro,r=n.keywordMapping,a=n.processPropertyName,o=n.enableDiffDefaultData,l=n.enableEditorValue,i=void 0===l||l,c=Zl(e);return function(e){var t,n,l=e.type,u=e.transferData,s=e.parentId,d={},v=c(l);(s&&(d[r.parentId]=s),o)||f()(t=v.Properties).call(t,(function(e){(0,C.c)(d,jl(e,a))}));i&&f()(n=v.Properties).call(n,(function(e){(0,C.c)(d,function(e,t){var n="Nodes"in e?e.Nodes:[e];return ue()(n).call(n,(function(e,n){var r=t(n.Id);if(r){var a=n.Editor;(0,ht.isUndefined)(a.Value)||(e[r]=a.Value)}return e}),{})}(e,a))}));return d[r.id]=ci(),d[r.name]=v.Name,d[r.type]=v.Id,u&&(0,C.c)(d,u),d}};function vi(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function pi(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=vi(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=vi(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}function gi(e){var t,n,r=e.dataContext,a=e.selectionContext,o=e.solidId,l=e.meta,i=e.activedSelectId,u=(e.modelFactory,e.globalConfig),s=void 0===u?{}:u,d=s.keywordMapping,f=s.isRootPropertyEmpty,v=s.designerContextValue,p=void 0===v?{}:v,g=s.propertyViewSetting,m=void 0===g?{}:g,y=p.getModel,h=a.getSelection(),C=r.getRootId(),E=r.getData(),b=C===i,k=h.length>1,x=r.findControl(o||i||C)||r.findControl(C),N=c()(t=j()(h).call(h,(function(e){return r.findControl(e)}))).call(t,Boolean),I=j()(N).call(N,(function(e){return e[d.type]})),A=f&&!o&&b,M=r.getRealControlType(x,d.type),S=(0,L.useMemo)((function(){return Hl(M)(l)}),[M,l]),T=S.Id,P=(0,L.useMemo)((function(){return zl(M)(l,s)}),[M,l,s]),R=x,D=(0,L.useMemo)((function(){return pi(pi({},P),R)}),[P,R]),V=x[d.id],B=(0,L.useMemo)((function(){var e,t=pi(pi({},E),{},{field:D}),n=mi(S.Properties,t,{getModel:y});if(k&&!o){var r=(e=I,function(t,n){var r=t.MultiEdit,a=(void 0===r?{Disable:[]}:r).Disable,o=void 0===a?[]:a,l=n.commonPropertyHandler;return ue()(e).call(e,(function(e,n){var r,a,i=Hl(n)(t).Properties;return null!==(r=e)&&void 0!==r&&r.length||(e=i),e=c()(a=j()(e).call(e,(function(e){var t,n=e.Nodes,r=e.Id,a=z()(i).call(i,(function(e){return e.Id===r})),l=(null==a?void 0:a.Nodes)||[],u=j()(t=n).call(t,(function(e){return e.Id})),s=c()(l).call(l,(function(e){return!w()(o).call(o,e.Id)&&w()(u).call(u,e.Id)}));return s.length?oi(oi({},a),{},{Nodes:s}):null}))).call(a,Boolean),(null==l?void 0:l(e))||[]}),[])})(l,s);return null!=r&&r.length?mi(r,t,{getModel:y}):n}return n}),[S,k,D,o]),F=null===(n=m.showEmptyView)||void 0===n?void 0:n.call(m,i);return{modelData:B,emptySelect:A,activedSelectId:i,field:D,controlType:T,itemId:V,isEmptyView:F}}function mi(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).getModel,r=(0,Ha.cp)(e,(function(e){var r;f()(r=function(e,t,n){var r=[],a=t.field;if(void 0===e)return r;var o,l=Pl(e);try{for(l.s();!(o=l.n()).done;){var i=o.value.Nodes;if(i){var c,u=Pl(i);try{for(u.s();!(c=u.n()).done;){var s=c.value.Actions;s&&f()(s).call(s,(function(e){var o=Dl(e,t)(n)||[];o.length&&f()(o).call(o,(function(e){var t=Fl(e,a);r.push.apply(r,(0,E.c)(t))}))}))}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){l.e(e)}finally{l.f()}return r}(e,t,n)).call(r,(function(t){!function(e,t){var n,r=t.key,a=t.prop,o=t.editorProp,l=Pl(e);try{for(l.s();!(n=l.n()).done;){var i=n.value.Nodes;if(i){var c,u=Pl(i);try{for(u.s();!(c=u.n()).done;){var s=c.value;if(T()(r)){if(s.Id===r[0]){var d,f=Pl(s.Editor.Enum);try{for(f.s();!(d=f.n()).done;){var v=d.value;v.Value===r[1]&&(v.Visible=a.Visible)}}catch(e){f.e(e)}finally{f.f()}}}else s.Id===r&&(a&&(0,C.c)(s,a),o&&(s.Editor=Ll(Ll({},s.Editor||{}),o)))}}catch(e){u.e(e)}finally{u.f()}}}}catch(e){l.e(e)}finally{l.f()}}(e,t)}))}));return r}function yi(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function hi(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=yi(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=yi(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Ci=V.Collapse.Panel,Ei=function(e){var t=e.children,n=(e.field,e.className),r=(0,L.useContext)(Ur),a=r.getPrefixCls,o=r.prefixCls,l=((0,L.useContext)(zr).keywordMapping,a(o,"right-view"));return P().createElement("div",{className:Ne()("".concat(l,"-props-tabs"),n)},t)},bi=function(e){return e},ki=function(e){var t,n=e.className,r=e.PropertyViewItemRender,a=void 0===r?wi:r,o=e.PropertyViewItemGroupRender,l=void 0===o?xi:o,i=e.header,c=e.footer,u=e.children,s=e.meta,d=void 0===s?{}:s,f=(e.data,e.id),v=e.filterPropertyHandler,p=void 0===v?bi:v,g=e.include,m=void 0===g?[]:g,y=e.exclude,h=void 0===y?[]:y,C=e.solidSelectedId,E=(0,L.useContext)(Yr),b=(0,L.useContext)(Zr),k=(b.getSelection(),xa({dataContext:E,selectionContext:b,solidId:f||C}).activedSelectId),x=(0,L.useContext)(za).modelFactory,w=(0,L.useContext)(zr),N=w.keywordMapping,I=w.propertyViewSetting,A=I.className,M=gi({dataContext:E,selectionContext:b,solidId:f,meta:d,activedSelectId:k,modelFactory:x,globalConfig:w}),S=M.modelData,T=M.emptySelect,R=M.field,D=(M.controlType,M.itemId,M.isEmptyView),V=(0,L.useContext)(Ur),B=(0,V.getPrefixCls)(V.prefixCls,"right-view"),F=(0,L.useRef)("");F.current=k;var K=(0,L.useRef)(""),O=(0,L.useRef)({});K.current=oa(k),O.current=oa(R);var _=(0,L.useState)(0)[1];if((0,L.useEffect)((function(){var e=E.addDataChangeListener((function(e){var t=e.value,n=e.actions;if(K.current===F.current){var r,a=z()(r=t[N.items]).call(r,(function(e){return e[N.id]===F.current}));if(a&&a===O.current)return;_((function(e){return e+1}))}else n&&Mt()(n).call(n,(function(e){return"ADD"===e.type}))||_((function(e){return e+1}))}));return function(){e&&e()}}),[]),T)return P().createElement("div",{className:"".concat(B,"-props-empty")},P().createElement("img",{className:"".concat(B,"-props-empty-img"),src:kl,width:"168",height:"96",alt:ba("designer.propertyView.key0001")}),P().createElement("div",{className:"".concat(B,"-props-empty-desc")},ba("designer.propertyView.key0001")));var j=p(S),U=null==I||null===(t=I.getEmptyView)||void 0===t?void 0:t.call(I);return U&&!j.length||D?U:P().createElement(Ei,{field:R,className:Ne()(B,A||"",n)},i,u,P().createElement(l,{modelData:j,include:m,exclude:h,PropertyViewItemRender:a,className:B,field:R}),c)},xi=function(e){var t=(0,L.useContext)(zr),n=t.filterProperty,r=t.propertyViewSetting,a=r.collapsable,o=void 0===a||a,l=r.hideItemView,i=e.modelData,u=e.include,s=e.exclude,d=e.PropertyViewItemRender,f=void 0===d?wi:d,v=e.className,p=e.field;return P().createElement(P().Fragment,null,null==i?void 0:j()(i).call(i,(function(t){var r=t.Id;if(!1===t.Visible)return null;if(T()(l)&&w()(l).call(l,t.Key))return null;if(t.Nodes){var a,i,d=c()(a=Qr()(i=function(e,t,n){var r=function(e,t){return!T()(e)||0===e.length||t(e)};return c()(e).call(e,(function(e){return!!e.Editor&&!1!==e.Visible&&r(t,(function(t){return w()(t).call(t,e.Id)}))&&r(n,(function(t){return!w()(t).call(t,e.Id)}))}))}(t.Nodes,u,s)).call(i,(function(e,t){return(e.GroupSubSeq||0)-(t.GroupSubSeq||0)}))).call(a,(function(e){return!n(p,e)})),g=!!d.length,m=P().createElement("div",{className:"".concat(v,"-pane")},j()(d).call(d,(function(e){return P().createElement(f,(0,C.c)({},e,{key:"".concat(e.Id),field:p,className:v}))}))),y=P().createElement(Ci,{header:t.Name,panelKey:r},m,e.children);if(g){var h=Mt()(d).call(d,(function(e){return e.Editor&&!0===e.ReadOnly}));return o?P().createElement(V.Collapse,{key:r,name:"Collapse",className:"".concat(v,"-collapse"),expandIconPosition:"left",defaultActiveKey:!0===t.DefaultCollapse?"":r},y):P().createElement("div",{key:r,className:Ne()("".concat(v,"-collapse"),(0,b.c)({},"".concat(v,"-collapse-readonly"),h))},!h&&P().createElement("div",{className:"".concat(v,"-property-group-title")},t.Name),m)}return null}})))},wi=function(e){var t,n=e.Editor,r=e.field,a=e.Id,o=e.className,l=e.Locked,i=void 0!==l&&l,c=e.ReadOnly,u=e.onPropertyChange,s=e.Actions,d=void 0===s?[]:s,f=e.enableMutiSelect,v=void 0===f||f,p=e.renderCustomError,g=(0,L.useContext)(zr),m=g.keywordMapping,y=g.processPropertyName,h=g.processPropertyValue,E=g.enableError,x=g.globalHandleChange,N=g.designerContextValue,I=(void 0===N?{}:N).getModel,A=r[m.id],S=r[m.type],T=(0,L.useContext)(bl);if(!n)return null;var R=n.Type,D=(n.DataType,n.Enum,n.Span),V=y(a),B=T.getPropertyEditor(R,S)||T.getPropertyEditor("Input"),F=(0,L.useContext)(Yr),K=(0,L.useContext)(Zr),O=K.getSelection(),_=(0,L.useContext)(ko),U=(0,L.useState)((null===(t=_.getError(A))||void 0===t?void 0:t[V])||null),H=(0,k.c)(U,2),z=H[0],q=H[1],W=v&&O.length>1&&w()(O).call(O,A),G=T.getValue&&T.getValue({isMultiSelected:W,field:(0,C.c)({},(0,b.c)({},V,Ol(n)),r),dataContext:F,selectionContext:K,propName:V,editor:n}),Q=(0,ht.isUndefined)(G)?(0,ht.isUndefined)(r[V])?Ol(n):r[V]:G,Z=F.getRootId(),Y=(0,L.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(null==h?void 0:h(a,e,F))||e;if(!(0,ht.isEqual)(Q,e)){if((null==u?void 0:u(r,a,e,n,d))||!1)return;if((null==x?void 0:x(r,a,e,n,d))||!1)return;if(W){var l=j()(O).call(O,(function(t){return[t,(0,b.c)({},V,e)]}));F.batchUpdateControlPropertyValues(eo(l))}else{var i=hi(hi({},Kl(d,V,e,o,r,F,I)),t);F.batchUpdateControlPropertyValues(eo([[A,i]]))}}}),[A,Q,V,d,r,O,n,u]);(0,L.useEffect)((function(){var e;if(E){q(null===(e=_.getError(A))||void 0===e?void 0:e[V]);var t=_.addErrorChangeListener((function(e){var t,n=null===(t=_.getError(A))||void 0===t?void 0:t[V];q(n)}));return function(){t()}}}),[A,V]);var X,J=(0,L.useMemo)((function(){if(z&&E&&!((null==p?void 0:p(z))||!1))return P().createElement("span",{className:"".concat(o,"-editor-control-error-msg")},z.msg)}),[z,p,E]);return B?P().createElement("div",{className:Ne()("".concat(o,"-editor-control"),(0,b.c)((0,b.c)((0,b.c)({},M()(X="".concat(o,"-span-")).call(X,D),D),"".concat(o,"-no-span"),void 0===D),"".concat(o,"-editor-control-error"),!!J))},P().createElement(B,(0,C.c)({},e,{key:A,field:r,id:A,locked:i||c,handleChange:Y,value:Q,className:o,propName:V,editor:n,dataContext:F,selectionContext:K,rootId:Z,error:z})),J):null};function Ni(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Ni(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Ni(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}ki.tabKey="PropertyView",ki.getTabName=function(){return ba("designer.propertyView.key0002")};var Ai=function(e,t){return"function"==typeof e.value?Ii(Ii({},e),{},{value:e.value(t)}):e};function Mi(e,t){return function(n){var r,a=Ai(e,n),o=a.value,l=a.index,i=void 0===l?-1:l,c=a.isInstrucAdd,u=void 0!==c&&c,s=n[t.items],d=T()(o)?o:[o];(u||(d=si(d,s,t)),-1===i)?s.push.apply(s,(0,E.c)(d)):Dt()(s).apply(s,M()(r=[i,0]).call(r,(0,E.c)(d)));return n}}var Si=function(e,t,n){t.length&&n.length&&e.push([t,n])},Ti=function(e,t){var n;return null===(n=e[t.items])||void 0===n||null===(n=z()(n).call(n,(function(e){return!e[t.parentId]})))||void 0===n?void 0:n[t.id]};var Li=function(e,t,n,r){(0,Ha.GU)();var o=n.keywordMapping||{},l=[],i=e||{},u=t||{id:"",items:[]},s=Ti(t,o),d=[],v=[],p={getMeta:function(){return i},setMeta:function(e){i=e},getData:function(){return u},resetData:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u=(0,Ha.cp)(u,(function(t){return e}),(function(e,n){t&&Si(d,e,n)})),e[o.items]&&e[o.items].length&&(s=Ti(e,o)),p.fireEvent({type:Ga.Reset,value:e})},mergeData:function(e){Ct().isEqual(u,e)||(u=(0,Ha.cp)(u,(function(t){(0,C.c)(t,e)}),(function(e,t){Si(d,e,t)})),e[o.items]&&e[o.items].length&&(s=Ti(e,o)),p.fireEvent({type:Ga.MergeData,value:e}))},addDataChangeListener:function(e){return l.push(e),function(){l=c()(l).call(l,(function(t){return t!==e}))}},fireEvent:function(e){$r.log("dataCtx fireEvt",e,l),f()(l).call(l,(function(t){try{t(e)}catch(e){$r.error(e)}})),r&&r(u,e)},batchActions:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=u;u=(0,Ha.cp)(u,(function(t){var n=j()(e).call(e,(function(e){switch(e.type){case Qa.ADD:return Mi(e,o);case Qa.UPDATE:return function(e,t){return function(n){var r=Ai(e,n).value,o=n[t.items];return f()(r).call(r,(function(e){var r,l=(0,k.c)(e,2),i=l[0],c=l[1],u=z()(o).call(o,(function(e){return e[t.id]===i}));u&&f()(r=a()(c)).call(r,(function(e){if(e===t.key){var r=n[t.items];new(Pt())(j()(r).call(r,(function(e){return e[t.key]}))).has(c[e])||(u[e]=c[e])}else u[e]=c[e]}))})),n}}(e,o);case Qa.DELETE:return function(e,t){return function(n){var r=Ai(e,n).value,a=n[t.items],o=T()(r)?r:[r];return f()(o).call(o,(function(e){for(var n,r=c()(n=j()(a).call(a,(function(n){if(n[t.id]===e)return n}))).call(n,Boolean);r.length;)f()(r).call(r,(function(e){var n=_e()(a).call(a,(function(n){return n[t.id]===(null==e?void 0:e[t.id])}));-1!==n&&Dt()(a).call(a,n,1)})),r=ue()(r).call(r,(function(e,n){var r,o=c()(r=j()(a).call(a,(function(e){if(e[t.parentId]===(null==n?void 0:n[t.id]))return e}))).call(r,Boolean);return M()(e).call(e,o)}),[])})),n}}(e,o);case Qa.PASTE:return Mi(e,o);case Qa.Attr:return function(e,t){return function(t){var n=Ai(e,t).value;return t=ue()(n).call(n,(function(e,n){var r=n.attrName,a=n.value;return r?(t[r]=a,e):e}),t),t}}(e);case Qa.REMOVEPROP:return function(e,t){return function(n){var r,a=Ai(e,n).value,o=(0,k.c)(a,2),l=o[0],i=o[1],c=z()(r=n[t.items]).call(r,(function(e){return e[t.id]===l}));return f()(i).call(i,(function(e){e in c&&delete c[e]})),n}}(e,o);case Qa.DRAG:return function(e,t){return function(n){var r,a,o=Ai(e,n).value,l=o.origin,i=o.targetIndex,u=o.targetParentId,s=T()(l)?l:[l],d=n[t.items],f=[];return d=j()(d).call(d,(function(e){if(w()(s).call(s,e[t.id])){var n=Ii(Ii({},e),{},(0,b.c)({},t.parentId,u));return f.push(n),(0,Ha.cp)(e,(function(e){return e.__isToDelete=!0,e}))}return e})),Dt()(r=d).apply(r,M()(a=[i+1,0]).call(a,f)),d=c()(d).call(d,(function(e){return!e.__isToDelete})),n[t.items]=d,n}}(e,o);case Qa.CUSTOMUPDATE:return function(e,t){return function(t){return Ai(e,t),t}}(e);case Qa.INSERT:return function(e,t){return function(n){var r=Ai(e,n),a=r.value,o=r.isInstrucAdd,l=void 0!==o&&o,i=a.originId,u=a.targetId,s=a.isPre,d=Kt()(a),v=n[t.items],p=[];if(T()(d)){if(v=c()(v).call(v,(function(e){var n=null==d?void 0:z()(d).call(d,(function(n){return n.Id===e[t.id]}));return!n||(p.push(Ii(Ii({},e),n)),!1)})),0===p.length){var g=T()(d)?d:[d];g=j()(g).call(g,(function(e){return!e.Key&&e._Type_&&(e.Key=e._Type_.toLowerCase()),e})),l||(g=si(g,v,t)),p=M()(p).call(p,g)}}else v=c()(v).call(v,(function(e){return e[t.id]!==i&&e[t.parentId]!==i||(p.push(Ii({},e)),!1)}));var m,y=[];return u?f()(v).call(v,(function(e){var n,r,a,o;e[t.id]===u?s?(n=y).push.apply(n,M()(r=(0,E.c)(p)).call(r,[e])):(a=y).push.apply(a,M()(o=[e]).call(o,(0,E.c)(p))):y.push(e)})):y=M()(m=[]).call(m,(0,E.c)(v),(0,E.c)(p)),n[t.items]=y,n}}(e,o);default:return function(e){return e}}}));return ue()(n).call(n,(function(e,t){return t(e)}),t)}),(function(e,n){t&&Si(d,e,n)})),n!==u&&p.fireEvent({type:Ga.BatchActions,actions:e,value:u,oldValue:n})},findControl:function(e){var t,n;return T()(e)?c()(t=j()(e).call(e,(function(e){var t;return z()(t=u[o.items]).call(t,(function(t){return t[o.id]===e}))}))).call(t,Boolean):null===(n=u[o.items])||void 0===n?void 0:z()(n).call(n,(function(t){return t[o.id]===e}))},findControlIndex:function(e){var t,n;return T()(e)?c()(t=j()(e).call(e,(function(e){var t;return _e()(t=u[o.items]).call(t,(function(t){return t[o.id]===e}))}))).call(t,Boolean):_e()(n=u[o.items]).call(n,(function(t){return t[o.id]===e}))},findControlByCondition:function(e){var t;return c()(t=u[o.items]).call(t,(function(t){return e(t)}))},getRootId:function(){return s},resetPatches:function(){v=[],d=[]},canUndo:function(){return d.length>0},canRedo:function(){return v.length>0},undo:function(){var e=d.pop();e&&(v.push(e),$r.log("redoActions",v,e),u=(0,Ha.oz)(u,e[1]),s=Ti(u,o),p.fireEvent({type:Ga.Undo,value:u}))},redo:function(){var e=v.pop();e&&(d.push(e),$r.log("undoActions",d,e),u=(0,Ha.oz)(u,e[0]),s=Ti(u,o),p.fireEvent({type:Ga.Redo,value:u}))},getParentControlId:function(e){var t,n=z()(t=u[o.items]).call(t,(function(t){return t[o.id]===e}));return n?n[o.parentId]:""},getParentControl:function(e){var t,n,r=p.getParentControlId(e);r&&(t=z()(n=u[o.items]).call(n,(function(e){return e[o.id]===r})));return t},getAllSiblings:function(e){var t,n=p.getParentControlId(e),r=[];n&&(r=c()(t=u[o.items]).call(t,(function(e){return!e._Root_&&e[o.parentId]===n})));return(0,E.c)(r)},getPrevSibling:function(e){var t=p.getAllSiblings(e),n=_e()(t).call(t,(function(t){return t[o.id]===e}))-1;return{control:t[n],index:n}},getNextSibling:function(e){var t=p.getAllSiblings(e),n=_e()(t).call(t,(function(t){return t[o.id]===e}))+1;return{control:t[n],index:n}},moveControl:function(e,t){var n=u,r=p.getPrevSibling;"forward"===t||"back"===t&&(r=p.getNextSibling);var a=r(e).control;if(a){var l=u[o.items],i=a[o.id],c=_e()(l).call(l,(function(e){return e[o.id]===i})),s=_e()(l).call(l,(function(t){return t[o.id]===e}));n!==(u=(0,Ha.cp)(u,(function(e){var t=Ii({},a);e[o.items][c]=e[o.items][s],e[o.items][s]=t}),(function(e,t){Si(d,e,t)})))&&p.fireEvent({type:Ga.Move,value:u,oldValue:n})}},isSiblings:function(e,t){return p.getParentControlId(e)===p.getParentControlId(t)},getSubControls:function(e){var t;return c()(t=u[o.items]).call(t,(function(t){return t[o.parentId]===e}))},getAllSubControls:function(e){var t=[];t.push(p.findControl(e));var n=p.getSubControls(e);if(n.length>0){var r=ue()(n).call(n,(function(e,t){var n;return M()(n=[]).call(n,(0,E.c)(e),[t[o.id]])}),[]);t=ue()(r).call(r,(function(e,t){var n;return M()(n=[]).call(n,(0,E.c)(e),(0,E.c)(p.getAllSubControls(t)))}),t)}return t},getAllSubControlIds:function(e){var t=[e],n=p.getSubControls(e);if(n.length>0){var r=ue()(n).call(n,(function(e,t){var n;return M()(n=[]).call(n,(0,E.c)(e),[t[o.id]])}),[]);t=ue()(r).call(r,(function(e,t){var n;return M()(n=[]).call(n,(0,E.c)(e),(0,E.c)(p.getAllSubControlIds(t)))}),t)}return t},getContainerControl:function(e){var t;return(null===(t=Hl(Gl(e,n))(i))||void 0===t?void 0:t.IsContainer)||(e=p.findControlByCondition((function(t){var n;return t[o.id]===(null===(n=e)||void 0===n?void 0:n[o.parentId])}))[0]),e},getAllParentControls:function(e,t){for(var n=p.findControl(e),r=t?[n]:[],a=[n];a.length;){var l=a.pop();if(l[o.parentId]){var i=p.findControl(l[o.parentId]);i&&(a.push(i),r.push(i))}}return r},getAllParentControlIds:function(e,t){for(var n=p.findControl(e),r=t?[n[o.id]]:[],a=[n];a.length;){var l=a.pop();if(l[o.parentId]){var i=p.findControl(l[o.parentId]);i&&(a.push(i),r.push(i[o.id]))}}return r},getNextSelectedControlId:function(e){var t=p.getPrevSibling(e).control,n=p.getNextSibling(e).control,r=p.getParentControlId(e),a=e;return t?a=t[o.id]:n?a=n[o.id]:r&&(a=r),a},filterControls:function(e){var t;return c()(t=u[o.items]).call(t,e)},getRealControlType:function(e,t){var n;if(void 0===e)return"";var r=e.ContainerType,a=e._Type_,o=void 0===t?a:e[t]||a;return w()(n=["FlexPanelAp","FieldsetPanelAp"]).call(n,a)&&r||o}};return p},Pi=n(2704),Ri=n.n(Pi);function Di(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vi(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Di(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Di(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Bi=function(e){return P().createElement("div",null,P().createElement("span",null,"title"),P().createElement("input",{value:"please input"}))},Fi=function(e){return P().createElement("div",null,P().createElement("span",null,"title"),P().createElement("div",null,"prop text"))};function Ki(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oi(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=Ki(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=Ki(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var _i=function(e,t,n,r,a){var o=Lr()(t),l=n(a||e[t.type]);if(l){var i=[];for(var c in e)c in l&&!w()(o).call(o,c)&&(0,ht.isEqual)(l[c],e[c])&&i.push(c);return(0,ht.isEmpty)(i)||r.push(no([e[t.id],i])),r}return r},ji=function(e){var t=e.globalConfig,n=e.dataReader,r=e.selectionContext,a=e.controlAction,o=e.dataProvider,l=e.dataFactory,i=e.modelFactory,c=e.metaReader,u=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new(rr())((function(e,o){t.preHandle?t.preHandle({dataContext:n,selectionContext:r,globalConfig:t,action:a,dataFactory:l,modelFactory:i,metaReader:c,success:e,fail:o}):e(a)})).then((function(e){var r=t.keywordMapping,a=t.enableDiffDefaultData,l=[];return a&&f()(e).call(e,(function(e){var t,a;(function(e){return e.type===Qa.ADD}(e)||e.type===Qa.PASTE)&&f()(t=T()(e.value)?e.value:[e.value]).call(t,(function(e){l=_i(e,r,c.getDefaultData,l)}));e.type===Qa.UPDATE&&"function"!=typeof e.value&&f()(a=e.value).call(a,(function(e){var t=(0,k.c)(e,2),a=t[0],o=t[1],i=n.findControl(a);i&&(l=_i((0,C.c)({},o,(0,b.c)((0,b.c)({},r.type,i[r.type]),r.id,i[r.id])),r,c.getDefaultData,l))}));return e})),o.batchActions(M()(e).call(e,l),u),e})).catch((function(e){throw new Error(e)}))},Ui=function(e,t){return function(n,r,a,o,l){var i=function(e,t){var n=t.keywordMapping;return Oi(Oi({},e),{},{getData:function(){return e.getData()},getMeta:function(){return e.getMeta()},findControl:function(t){return e.findControl(t)},findControlByCondition:function(t){return e.findControlByCondition(t)},findControlType:function(t){var r=e.findControl(t);return T()(r)?j()(r).call(r,(function(e){return e[n.type]})):r[n.type]},getRootId:function(){return e.getRootId()}})}(e,n);return{getData:function(){return e.getData()},getMeta:function(){return e.getMeta()},resetData:function(t,n){return e.resetData(t,n)},resetPatches:function(){return e.resetPatches()},addControl:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t})},deleteControl:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t},!(arguments.length>1&&void 0!==arguments[1])||arguments[1])},batchUpdateControlPropertyValues:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t},!(arguments.length>1&&void 0!==arguments[1])||arguments[1])},attrActions:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t})},swapControl:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t})},insertControl:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t})},customUpdateState:function(l){return ji({globalConfig:n,dataReader:i,selectionContext:r,controlAction:l,dataProvider:e,dataFactory:a,modelFactory:o,metaReader:t})},findControl:function(t){return e.findControl(t)},findControlIndex:function(t){return e.findControlIndex(t)},findControlByCondition:function(t){return e.findControlByCondition(t)},getRootId:function(){return e.getRootId()},addDataChangeListener:function(t){return e.addDataChangeListener(t)},canUndo:function(){return e.canUndo()},canRedo:function(){return e.canRedo()},undo:function(){return e.undo()},redo:function(){return e.redo()},getParentControlId:function(t){return e.getParentControlId(t)},getParentControl:function(t){return e.getParentControl(t)},getAllSiblings:function(t){return e.getAllSiblings(t)},getPrevSibling:function(t){return e.getPrevSibling(t)},getNextSibling:function(t){return e.getNextSibling(t)},moveControl:function(t,n){return e.moveControl(t,n)},isSiblings:function(t,n){return e.isSiblings(t,n)},getSubControls:function(t){return e.getSubControls(t)},getPropertyValue:function(t,n){return(0,ht.property)(n)(e.findControl(t))},getAllSubControls:function(t){return e.getAllSubControls(t)},getAllSubControlIds:function(t){return e.getAllSubControlIds(t)},getContainerControl:function(t){return e.getContainerControl(t)},getAllParentControls:function(t,n){return e.getAllParentControls(t,n)},getAllParentControlIds:function(t,n){return e.getAllParentControlIds(t,n)},getNextSelectedControlId:function(t){return e.getNextSelectedControlId(t)},filterControls:function(t){return e.filterControls(t)},getRealControlType:function(t,n){return e.getRealControlType(t,n)}}}};var Hi=function(e){return{getViewActiveKey:function(t){var n,r,a;return t?null===(n=e.current)||void 0===n||null===(n=n[t])||void 0===n?void 0:n.activeKey:{left:null===(r=e.current)||void 0===r||null===(r=r.left)||void 0===r?void 0:r.activeKey,right:null===(a=e.current)||void 0===a||null===(a=a.right)||void 0===a?void 0:a.activeKey}},setViewActiveKey:function(t){return function(n){var r,a=null===(r=e.current)||void 0===r||null===(r=r[t])||void 0===r?void 0:r.setTabKey;null==a||a(n)}},getViewHideState:function(t){var n,r,a,o;return t?null===(n=e.current)||void 0===n||null===(n=n[t])||void 0===n?void 0:n.hide:{left:null===(r=e.current)||void 0===r||null===(r=r.left)||void 0===r?void 0:r.hide,right:null===(a=e.current)||void 0===a||null===(a=a.right)||void 0===a?void 0:a.hide,top:null===(o=e.current)||void 0===o||null===(o=o.top)||void 0===o?void 0:o.hide}},setViewHideState:function(t){return function(n){var r,a=null===(r=e.current)||void 0===r||null===(r=r[t])||void 0===r?void 0:r.setHide;a&&(null==a||a(n))}},getViewVisibleKeys:function(t){var n;return(null===(n=e.current)||void 0===n||null===(n=n[t])||void 0===n?void 0:n.getViewKeys())||[]},setViewsVisibleSetting:function(t){return function(n){var r,a=null===(r=e.current)||void 0===r||null===(r=r[t])||void 0===r?void 0:r.setViews;null==a||a((0,b.c)({},t,n))}}}};var zi=function(e){return e.Info="info",e.Warn="warn",e.Error="error",e.Validate="validate",e.Customer="customer",e}(zi||{}),qi=function(e){return e.Add="add",e.Remove="remove",e.Reset="reset",e}(qi||{}),Wi=function(){function e(){(0,Pr.c)(this,e),(0,b.c)(this,"listeners",void 0),(0,b.c)(this,"messageList",void 0),this.messageList=[],this.listeners=[]}return(0,Rr.c)(e,[{key:"addDataChangeListener",value:function(e){var t=this;return this.listeners.push(e),function(){var n;t.listeners=c()(n=t.listeners).call(n,(function(t){return e!==t}))}}},{key:"getMessage",value:function(e){var t;return e?c()(t=this.messageList).call(t,(function(t){return t.type===e})):this.messageList}},{key:"addMessage",value:function(e){var t;("string"==typeof e&&(e={type:zi.Info,content:e}),T()(e))?(t=this.messageList).push.apply(t,(0,E.c)(e)):this.messageList.push(e);this.fireEvent(qi.Add,e)}},{key:"removeMessage",value:function(e){var t,n=T()(e)?e:[e];this.messageList=c()(t=this.messageList).call(t,(function(e){return!w()(n).call(n,e)})),this.fireEvent(qi.Remove,e)}},{key:"reset",value:function(){this.messageList=[],this.fireEvent(qi.Reset,[])}},{key:"fireEvent",value:function(e,t){var n;f()(n=this.listeners).call(n,(function(n){try{n(e,t)}catch(e){}}))}}]),e}();navigator.userAgent.match(/Trident\/(\d+)/)&&((0,Ha.uG)(),(0,Ha.Gu)(!0));var Gi=(0,L.memo)((0,L.forwardRef)((function(e,t){var n=(0,L.useContext)(Ur),r=n.getPrefixCls,o=n.prefixCls,l=function(e,t,n){var r=Hr[e],a=t&&t[e]||{};return(0,C.c)({},r,a,n||{})}("Kdesigner",n.compDefaultProps,e),i=l.globalConfig,u=void 0===i?{}:i,s=l.prefixCls,d=l.data,v=void 0===d?{}:d,p=l.onData,g=l.onApi,m=l.dataFactory,y=l.modelFactory,h=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,C.c)({Controls:[]});return f()(e=a()(t)).call(e,(function(e){var r;"Categories"===e?(n[e]=[],f()(r=t[e]).call(r,(function(t){var r,o={};f()(r=a()(t)).call(r,(function(e){var r;"Controls"===e?f()(r=t[e]).call(r,(function(e){n.Controls.push((0,C.c)({},e,{CategoryId:t.Id}))})):o[e]=t[e]})),n[e].push(o)}))):n[e]=t[e]})),n}(l.meta),b=(0,L.useMemo)((function(){return function(e){var t=e.Controls,n=void 0===t?[]:t;return ue()(n).call(n,(function(e,t){var n=t.Id,r=(t.Properties,(0,kt.c)(t,ri)),a={};for(var o in r)a[Ct().camelCase(o)]=r[o];return e[n]=a,e}),{})}(h)}),[h]),x=r&&r(o,"kdesigner",s),N=(0,L.useMemo)((function(){return function(e){return(0,C.c)({},ro,e||{})}(u)}),[u]),I=(0,L.useRef)({}),A=(0,L.useState)((function(){return function(e){var t=[],n=[],r={setSelect:function(e){if(e){e=T()(e)?e:[e];var t=O()(n).call(n);n=e,r.fireEvent({type:qa.Reset,value:n,oldValue:t})}},getSelection:function(){return n},getActiveSelectedId:function(){return("first"===e.activeSelectedMode?Ct().first:Ct().last)(n)},appendSelect:function(e){var t=O()(n).call(n);f()(e).call(e,(function(e){w()(n).call(n,e)||n.push(e)})),r.fireEvent({type:qa.SelectChange,value:n,oldValue:t})},addSelectChangeListener:function(e){return t.push(e),function(){t=c()(t).call(t,(function(t){return t!==e}))}},fireEvent:function(e){$r.log("selectCtx fireEvt",e,t),f()(t).call(t,(function(t){try{t(e)}catch(e){$r.error(e)}}))}};return r}(N)})),S=(0,k.c)(A,1)[0],R=(0,L.useState)((function(){return function(e){var t=[],n={},r={replaceError:function(e){var t=Vi({},n);n=e,r.fireEvent({type:Za.Replace,value:n,oldValue:t})},setError:function(e){if(e){var t=Vi({},n);n=Vi(Vi({},n),e),r.fireEvent({type:Za.Reset,value:n,oldValue:t})}},deleteError:function(e){if(null!=e&&e.length){var t=Ri()(n);f()(e).call(e,(function(e){delete t[e]}));var a=n;n=t,r.fireEvent({type:Za.Delete,value:n,oldValue:a})}},clearError:function(){var e=Vi({},n);n={},r.fireEvent({type:Za.Clear,value:n,oldValue:e})},getError:function(e){return e?n[e]||null:n},addErrorChangeListener:function(e){return t.push(e),function(){t=c()(t).call(t,(function(t){return t!==e}))}},fireEvent:function(e){$r.log("error fireEvt",e,t),f()(t).call(t,(function(t){try{t(e)}catch(e){$r.error(e)}}))}};return r}()})),D=(0,k.c)(R,1)[0],V=(0,L.useState)((function(){return new Wi})),B=(0,k.c)(V,1)[0],F=(0,L.useMemo)((function(){return di(h)}),[h]),K=(0,L.useMemo)((function(){return fi(h,N)}),[h]),_=(0,L.useMemo)((function(){return ni(h,N)}),[h]),U=(0,L.useState)((function(){return Li(h,v,N,p)})),H=(0,k.c)(U,1)[0],z=(0,L.useMemo)((function(){return H.setMeta(h),Ui(H,_)(N,S,m||K,y||F,D)}),[h]),q=(0,L.useCallback)((function(){return Q.current}),[]),W=(0,L.useState)((function(){return e=new ol,{getAliasData:function(){return e.getAliasData()},hasAliasDataPropValue:function(t,n,r){return e.hasAliasDataPropValue(t,n,r)},getAliasDataPropValue:function(t,n,r){return e.getAliasDataPropValue(t,n,r)},addAliasDataChangeListener:function(t){return e.addAliasDataChangeListener(t)},setAliasDataPropValue:function(t){return e.setAliasDataPropValue(t)}};var e})),G=(0,k.c)(W,1)[0];(0,L.useEffect)((function(){"function"==typeof g&&g(function(e){var t=e.meta,n=e.data,r=e.selection,a=e.error;return{meta:t,data:n,selection:r,getNode:e.getNode,aliasData:e.aliasData,message:e.message,dataFactory:e.dataFactory,views:e.views,error:a}}({meta:_,data:z,selection:S,error:D,getNode:q,aliasData:G,message:B,dataFactory:K,views:Hi(I)}))}),[h]),(0,L.useLayoutEffect)((function(){var e=z.addDataChangeListener((function(){var e=S.getSelection(),t=c()(e).call(e,(function(e){return!!z.findControl(e)}));t.length!==e.length&&S.setSelect(t)}));return function(){e&&e()}}),[]);var Q=(0,L.useRef)(null),Z=t;(0,L.useImperativeHandle)(Z,(function(){return{attrActions:function(e){z.attrActions(to(T()(e)?e:[e]))},selectionContext:S,dataContext:z,errorContext:D,getNode:q}}),[]);var Y=(0,L.useState)((function(){var e=function(){var e,t={},n=function(e,n,r){var a;t[r?M()(a="".concat(r,"-")).call(a,e):e]=n};return f()(e=a()(El)).call(e,(function(e){n(e,El[e])})),{rigistPropertyEditor:n,getPropertyEditor:function(e,n){var r;return t[M()(r="".concat(n,"-")).call(r,e)]||t[e]}}}();if(e.rigistPropertyEditor("readonly",Fi),e.rigistPropertyEditor("text",Bi),N.getPropertyEditors){var t=N.getPropertyEditors();f()(t).call(t,(function(t){e.rigistPropertyEditor.apply(e,(0,E.c)(t))}))}return N.getValue&&(e.getValue=N.getValue),e})),X=(0,k.c)(Y,1)[0];(0,L.useEffect)((function(){var e=N.getCustomActions;if(e){var t=e(),n=t.dataActions,r=void 0===n?[]:n,a=t.propertyActions,o=void 0===a?[]:a,l=Ml.rigistAction;f()(r).call(r,(function(e){l(Al).apply(void 0,(0,E.c)(e))})),f()(o).call(o,(function(e){l(Il).apply(void 0,(0,E.c)(e))}))}}),[]);var J=(0,L.useMemo)((function(){var e,t={};return f()(e=a()(N)).call(e,(function(e){var n;w()(n=["getPropertyEditor","getValue","nodeRef","viewsStateRef"]).call(n,e)||(t[e]=N[e])})),t.getNode=q,t.message=B,t.viewsStateRef=I,t}),[q,B,I,N]),$=(0,L.useMemo)((function(){var e,t,n,r={control:bo},a={property:ki},o={};return N.getViews&&(N.getViews("left")&&(r=Zi((0,C.c)({},r,N.getViews("left")))),N.getViews("right")&&(a=Zi((0,C.c)({},a,N.getViews("right")))),N.getViews("main")&&(o=Zi((0,C.c)({},o,N.getViews("main"))))),{leftViews:j()(e=Lr()(r)).call(e,(function(e){var t;return P().createElement(e,{key:e.tabKey,data:v,meta:h,tabKey:e.tabKey,tabName:(null===(t=e.getTabName)||void 0===t?void 0:t.call(e))||e.tabName})})),mainViews:j()(t=Lr()(o)).call(t,(function(e){var t;return P().createElement(e,{key:e.tabKey,data:v,meta:h,tabKey:e.tabKey,tabName:(null===(t=e.getTabName)||void 0===t?void 0:t.call(e))||e.tabName})})),rightViews:j()(n=Lr()(a)).call(n,(function(e){var t;return P().createElement(e,{key:e.tabKey,data:v,meta:h,tabKey:e.tabKey,tabName:(null===(t=e.getTabName)||void 0===t?void 0:t.call(e))||e.tabName})}))}}),[v,h,N]),ee=(0,L.useMemo)((function(){return{dataFactory:m||K,modelFactory:y||F,metaApi:_,controlMetaInfo:b}}),[m,K,y,F,_,b]),te=(0,L.useState)(!0),ne=(0,k.c)(te,2),re=ne[0],ae=ne[1];return(0,L.useEffect)((function(){var e,t;ae(!1),N.getLangMsg&&(e="getLangMsg",t=N.getLangMsg,Ea[e]=t)}),[]),!re&&P().createElement(Qi,{className:x,ref:Q},P().createElement(zr.Provider,{value:J},P().createElement(za.Provider,{value:ee},P().createElement(Yr.Provider,{value:z},P().createElement(Zr.Provider,{value:S},P().createElement(ko.Provider,{value:D},P().createElement(bl.Provider,{value:X},P().createElement(ll.Provider,{value:G},P().createElement(Ua,null),P().createElement("div",{className:"".concat(x,"-root-main")},P().createElement(Ka,{views:$.leftViews}),P().createElement(Oa,{views:$.mainViews}),P().createElement(ja,{views:$.rightViews}))))))))))}))),Qi=(0,L.memo)((0,L.forwardRef)((function(e,t){return P().createElement("div",{className:"".concat(e.className,"-root"),ref:t,tabIndex:-1},e.children)})));function Zi(e){var t;return f()(t=a()(e)).call(t,(function(t){null==e[t]&&delete e[t]})),e}Gi.displayName="KDesigner";var Yi,Xi="Default",Ji=((0,b.c)({RadioGroupField:[-1,1,3]},Xi,[-1,0,1,2]),(0,b.c)({ComboField:[0,1,2],MulComboField:[0,2]},Xi,[0,2]),n(31408)),$i=n.n(Ji),ec="Type",tc="Categories",nc="ElementTypes",rc="Properties",ac="Editor",oc=["condition","action"];function lc(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function ic(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=lc(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=lc(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}(0,Ha.uG)();var cc,uc,sc=new Ha.uM({useProxies:!1,autoFreeze:!1}),dc=sc.produce,fc=(sc.setAutoFreeze,null),vc=["Container"],pc={},gc=new(Pt()),mc="",yc={},hc=(new(Pt()),new(Pt())),Cc=new(Pt()),Ec=new(Pt()),bc=new(Pt()),kc={text:"Input",refcombo:"RefCombo",checkbox:"Switch",btnedit:"CustomInput",integer:"Stepper",combo:"Select",date:"date",ecombo:"ECombo",daterange:"DateRange",refmcombo:"RefMCombo",decimal:"Stepper",color:"Color",mcombo:"CheckBoxGroup",dimension:"Dimension",border:"Border",cssedit:"CssEdit",position:"Position",editcombo:"EditCombo",slider:"slider",fontbold:"FontBold",tabselect:"Tab",radius:"Radius",radio:"Radio",refeditbtn:"RefEditBtn"},xc={lockproperty:"LockProperty",hideproperty:"HideProperty",resetproperty:"SetPropertyValue",setpropertyvalue:"SetPropertyValue"},wc=function(e){return e?e.replace(/EntityType/g,"FieldType").replace(/&&/g," and ").replace(/!/g," not ").replace(/\|\|/g," or ").replace(/isChange\(\S+\)/g,"Change"):e},Nc=function(e,t){var n=e.name,r=e.args,a=e.affectedByParent,o=e.conditionTypes;switch(n){case"lockproperty":case"hideproperty":return{Name:xc[n],Args:{Key:r},AffectedByParent:a,ConditionTypes:o};case"setpropertyvalue":return{Name:xc[n],Args:{Key:j()(r).call(r,(function(e){return e.property})),Value:j()(r).call(r,(function(e){return e.value}))}};case"resetproperty":return{Name:xc[n],Args:{Key:j()(r).call(r,(function(e){return e})),Value:j()(r).call(r,(function(e){}))}};default:return null}},Ic={Id:"anonyoumsMockId",Name:"anonyoumsMockName",DefaultCollapse:!1,Layout:"anonyoumsMockLayout"},Ac=function(e){return(0,C.c)({},Ic,{Nodes:e})},Mc=function(e,t){return(0,ht.isUndefined)(e)||f()(n=a()(e)).call(n,(function(n){var r=e[n];(0,ht.isUndefined)(r)||(t[n]=r)})),t;var n},Sc=(Yi={},(0,b.c)((0,b.c)((0,b.c)((0,b.c)((0,b.c)((0,b.c)((0,b.c)((0,b.c)((0,b.c)((0,b.c)(Yi,"_Type_",ec),nc,"Controls"),tc,[tc,function(e){var t=e.originProp,n=(e.path,e.keyMap),r=e.getLangMsg,a=j()(t).call(t,(function(e){var t=e.ElementTypes,n=void 0===t?[]:t,r=e.BaseType,a=e.Visible,o=(e.Id,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return ue()(t).call(t,(function(e,t){return t(e)}),e)}}((function(e){var t=["FormAp","BillFormAp","ListFormAp","BasedataFormAp","MobileBillFormAp","MobileListFormAp","MobileFormAp","MainEntity","BaseEntity","BillEntity","ReportEntity","ParameterEntity","PublicParameterEntity","BillEntity","EntryEntity","SubEntryEntity","TreeEntryEntity","TreeSubEntryEntity","ReportFormAp"],n=["NoCodeEntryEntity","NoCodeRefBillTable","NoCodeGridPanelAp","NoCodeGroupContainerAp","NoCodeGroupItemAp","BizBtnFlexPanelAp"];if(fc){var r,a=z()(r=fc.Items).call(r,(function(e){return!e.ParentId}));t.push(null==a?void 0:a._Type_)}return t.push("EntryAp"),w()(t).call(t,e.Id)||w()(n).call(n,e.Id)?Mc({IsContainer:!0},e):e}),(function(e){if((0,ht.isEmpty)(yc))return e;var t=e.ElementGroupId;return void 0!==t&&yc[t]?Mc({Visible:yc[t].Visible},e):e})));return r&&w()(vc).call(vc,r)?ic(ic({},e),{},{ElementTypes:j()(n).call(n,(function(e){return Mc({BaseId:r,Visible:a,IsContainer:!0},o(e))}))}):ic(ic({},e),{},{ElementTypes:j()(n).call(n,(function(e){return Mc({BaseId:r,Visible:a},o(e))}))})}));return Pc(Sc({keyMap:n,meta:a,getLangMsg:r}))}]),rc,[rc,function(e){var t=e.originProp,n=e.path,r=e.pathLength,a=(e.inputMeta,e.keyMap),o=e.getLangMsg;if(n[r-3]===nc){var l,i=c()(l=j()(t).call(t,(function(e){var t,n,r,a=e.PropertyName;if(!e.Editor)return bc.add(M()(n=M()(r="".concat(e.PropertyName,"^^")).call(r,e.Name,"^^")).call(n,Ze()(e))),(0,C.c)(e,{Editor:{Type:"Input",DataType:"String",Visible:!0}});"Width"===a&&(e.Name=(null==o?void 0:o("designer.editor.key0016"))||"尺寸设置",e.Description=(null==o?void 0:o("designer.editor.key0017"))||"设置控件的宽度与高度"),"ForeColor"===a&&(e.Name=(null==o?void 0:o("designer.editor.key0018"))||"颜色设置"),"FontSize"===a&&(e.Name=(null==o?void 0:o("designer.editor.key0019"))||"字体设置"),e.Tips=e.Description?M()(t="".concat(e.Description,"[")).call(t,a,"]"):"";var l=function(e){if(!(0,ht.isEmpty)(pc)){var t=e.GroupId;if(t&&pc[t])return pc[t].Visible}}(e);return e.Visible=(0,ht.isUndefined)(l)?!!(0,ht.isUndefined)(e.Visible)||!!e.Visible:l,e}))).call(l,Boolean);return function(e){var t;if((0,ht.isEmpty)(pc))return[Ac(e)];var n=(0,E.c)(gc),r=(0,ht.groupBy)(e,"GroupId"),a=c()(e).call(e,(function(e){var t=e.GroupId;return!(mc&&!t||w()(n).call(n,t))})),o=c()(t=j()(n).call(n,(function(e){var t,n,a=r[e];return mc&&e===mc&&(a=null!==(t=a)&&void 0!==t&&t.length?M()(n=[]).call(n,(0,E.c)(a),(0,E.c)(r.undefined)):r.undefined),a?ic(ic(ic({},Ic),pc[e]),{},{Id:e,Nodes:dc(a,(function(t){f()(t).call(t,(function(t){"style"===pc[e].Layout&&(t.TabGroup="style")}))}))}):null}))).call(t,Boolean);return a.length,o}(Pc(Sc({meta:i,keyPath:[rc],keyMap:a,getLangMsg:o})))}}]),"PropertyName","Id"),"Action",["Actions",function(e){var t=e.originProp,n=e.path,r=e.pathLength,a=(e.inputMeta,e.keyMap),o=e.getLangMsg;if(n[r-3]===rc){var l=t.items;return null==l?void 0:j()(l).call(l,(function(e){var t=e.condition,n=e.action,r=void 0===n?{}:n,l=(0,kt.c)(e,oc);Cc.add(t),(null==r?void 0:r.name)&&Ec.add(r.name);var i={};(0,ht.isEmpty)(l)||(0,C.c)(i,Pc(Sc({meta:l,keyPath:[],isDeep:!1,keyMap:a,getLangMsg:o})));var c=Nc(r);return(0,C.c)(i,{Condition:wc(t),Todo:c?[c]:[]})}))}}]),"type",[ec,function(e){var t=e.originProp,n=e.path,r=e.pathLength;e.inputMeta,e.keyMap;if(n[r-2]===ac)return hc.add(t),kc[t]||t}]),"value",["Value",function(e){var t=e.originProp,n=e.path,r=e.pathLength;e.inputMeta,e.keyMap;if(n[r-2]===ac)return t}]),ac,[ac,function(e){var t=e.originProp,n=e.path,r=e.pathLength,a=(e.inputMeta,e.keyMap),o=e.getLangMsg;if(n[r-3]===rc){var l=t.type,i=Pc(Sc({meta:t,keyPath:[ac],isDeep:!0,keyMap:a,getLangMsg:o}));if("integer"===l)return ic(ic({},i),{},{DataType:"Integer"});if("decimal"===l)return ic(ic({},i),{},{DataType:"Decimal"});if("checkbox"===l)return ic(ic({},i),{},{DataType:"Boolean"});if("border"===l)return ic(ic({},i),{},{DataType:"Object"});var c=["ecombo","dataFill","datascope","filter","orderby","calcSetting","expression","userSelect","requestBody","parameterSetting"];return w()(c).call(c,l)?ic({},i):ic(ic({},i),{},{DataType:"String"})}}]),"default",["Default",function(e){var t=e.originProp,n=e.path,r=e.pathLength;e.inputMeta,e.keyMap;if(n[r-2]===ac)return t}]),(0,b.c)((0,b.c)(Yi,"length",["MaxLength",(cc=ac,function(e){var t=e.originProp,n=e.path,r=e.pathLength;if(n[r-2]===cc)return uc&&uc({originProp:t,path:n,pathLength:r}),t})]),"items",["Enum",function(e){var t=e.originProp,n=e.path,r=e.pathLength;e.inputMeta,e.keyMap;if(n[r-3]===ac){var a=t.id,o=t.name;a&&o&&(0,C.c)({},{Value:a,Id:a,Name:o})}}]),function(e){var t=e.meta,n=e.keyMap,r=e.keyPath,a=void 0===r?[]:r,o=e.isDeep,l=void 0===o||o,i=e.inputMeta,c=e.getLangMsg;return Tc({meta:t,keyPath:a,isDeep:l,inputMeta:i,keyMap:n,getLangMsg:c})}),Tc=function e(t){var n=t.meta,r=t.keyPath,a=void 0===r?[]:r,o=t.isDeep,l=void 0===o||o,i=t.inputMeta,c=t.keyMap,u=t.getLangMsg,s=Lc({meta:n,keyPath:a,isReturnOriginVal:!1,inputMeta:i=i||n,keyMap:c,getLangMsg:u});if(!(0,ht.isUndefined)(s))return s;if(T()(n)){var d=j()(n).call(n,(function(t,n){return l?Pc(e({meta:t,keyPath:M()(a).call(a,"".concat(n)),isDeep:l,inputMeta:i,keyMap:c,getLangMsg:u})):t}));return[Rc((0,ht.last)(a),c),d]}if((0,ht.isObject)(n)){var f,v=ue()(f=$i()(n)).call(f,(function(t,n){var r=(0,k.c)(n,2),o=r[0],s=r[1],d=l?e({meta:s,keyPath:M()(a).call(a,o),isDeep:l,inputMeta:i,keyMap:c,getLangMsg:u}):[Rc(o,c),s],f=(0,k.c)(d,2),v=f[0],p=f[1];return t[v]=p,t}),{});return[Rc((0,ht.last)(a),c),v]}return Lc({meta:n,keyPath:a,isReturnOriginVal:!0,inputMeta:i,keyMap:c,getLangMsg:u})},Lc=function(e){var t=e.meta,n=e.keyPath,r=void 0===n?[]:n,a=e.isReturnOriginVal,o=e.inputMeta,l=e.keyMap,i=e.getLangMsg,c=(0,ht.last)(r);if(c){var u=T()(l[c])?l[c]:[Rc(c,l)],s=(0,k.c)(u,2),d=s[0],f=s[1];if((0,ht.isFunction)(f)){var v=f({originProp:t,path:r,pathLength:r.length,inputMeta:o,keyMap:l,getLangMsg:i});if(!(0,ht.isUndefined)(v))return[d,v]}return a?[d,t]:void 0}},Pc=function(e){return e[1]},Rc=function(e,t){return e?(T()(t[e])?t[e][0]:t[e])||(0,ht.upperFirst)(e):""};var Dc,Vc,Bc,Fc,Kc,Oc,_c,jc,Uc,Hc,zc,qc,Wc,Gc,Qc,Zc,Yc,Xc,Jc,$c,eu,tu,nu,ru,au,ou,lu,iu,cu,uu,su,du,fu,vu,pu,gu,mu,yu,hu,Cu,Eu,bu,ku,xu,wu,Nu,Iu,Au,Mu,Su,Tu,Lu=n(59e3);Dc||(Dc=(0,Lu.c)(["jichuziliaoleixing"])),Vc||(Vc=(0,Lu.c)(["danjuliebiao"])),Bc||(Bc=(0,Lu.c)(["kapianbujurongqi"])),Fc||(Fc=(0,Lu.c)(["liebiaodongtaiwenben"])),Kc||(Kc=(0,Lu.c)(["biaogeliebiaoziduan"])),Oc||(Oc=(0,Lu.c)(["liebiaocaozuolie"])),_c||(_c=(0,Lu.c)(["kapiantupianziduan"])),jc||(jc=(0,Lu.c)(["kapianshijianziduan"])),Uc||(Uc=(0,Lu.c)(["kapianxuanzebiaozhi"])),Hc||(Hc=(0,Lu.c)(["biaogeliebiaoziduan"])),zc||(zc=(0,Lu.c)(["biaogeliebiaoziduan"])),qc||(qc=(0,Lu.c)(["riqixuanze"])),Wc||(Wc=(0,Lu.c)(["biaogewenben"])),Gc||(Gc=(0,Lu.c)(["biaogezhengshu"])),Qc||(Qc=(0,Lu.c)(["biaogexiaoshu"])),Zc||(Zc=(0,Lu.c)(["biaogeriqi"])),Yc||(Yc=(0,Lu.c)(["biaogeshijian"])),Xc||(Xc=(0,Lu.c)(["biaogejine"])),Jc||(Jc=(0,Lu.c)(["gaojimianbangongjulan"])),$c||($c=(0,Lu.c)(["gongjulan"])),eu||(eu=(0,Lu.c)(["fudongcaidanmianban"])),tu||(tu=(0,Lu.c)(["fudongcaidanxiang"])),nu||(nu=(0,Lu.c)(["shouyedaohangkongjian"])),ru||(ru=(0,Lu.c)(["danxingyufanganguolvziduan"])),au||(au=(0,Lu.c)(["riqiguolvziduan"])),ou||(ou=(0,Lu.c)(["fuxuankuangguolvziduan"])),lu||(lu=(0,Lu.c)(["fuxuankuangzuziduan"])),iu||(iu=(0,Lu.c)(["tiaoxingtu"])),cu||(cu=(0,Lu.c)(["zhuzhuangtu"])),uu||(uu=(0,Lu.c)(["leidatu"])),su||(su=(0,Lu.c)(["tongyongtu"])),du||(du=(0,Lu.c)(["yibiaopan"])),fu||(fu=(0,Lu.c)(["yingyongdaohangcaidan"])),vu||(vu=(0,Lu.c)(["ziduanbujumianban"])),pu||(pu=(0,Lu.c)(["ziduanzuherongqi"])),gu||(gu=(0,Lu.c)(["lunbobujurongqi"])),mu||(mu=(0,Lu.c)(["yeqian"])),yu||(yu=(0,Lu.c)(["gaojimianbanzhaiyaorongqi"])),hu||(hu=(0,Lu.c)(["gaojimianbanzirongqi"])),Cu||(Cu=(0,Lu.c)(["biaogeshitu"])),Eu||(Eu=(0,Lu.c)(["kapianshitu"])),bu||(bu=(0,Lu.c)(["qingfenxishitu"])),ku||(ku=(0,Lu.c)(["kapian"])),xu||(xu=(0,Lu.c)(["kapianfenlushitu"])),wu||(wu=(0,Lu.c)(["kapian"])),Nu||(Nu=(0,Lu.c)(["gudingkapian"])),Iu||(Iu=(0,Lu.c)(["pingzhenghao"])),Au||(Au=(0,Lu.c)(["qingfenxikapian"])),Mu||(Mu=(0,Lu.c)(["kuaijiesousuoshitu"])),Su||(Su=(0,Lu.c)(["biaogetupian"])),Tu||(Tu=(0,Lu.c)(["biaogefujian"]));var Pu=["switchValue","onSwitchChange"],Ru=(0,L.memo)((function(e){var t=e.switchValue,n=e.onSwitchChange,r=(0,kt.c)(e,Pu),a=r.className;return P().createElement("div",{className:"".concat(a,"-title-switch")},P().createElement(Po,r),P().createElement(V.Switch,{checked:t,onChange:n}))}));Ru.displayName="NameTipSwitchWrapper";var Du=function(e){var t=e.handleChange,n=e.onCustomInputClick,r=e.value,a=e.className,o=e.locked,l=e.Editor,i=e.Name,c=e.field,u=(e.Id,e.Tips),s=(e.ReadOnly,e.dataContext),d=e.id,f=l.NameHidden,v=l.MaxLength,p=(l.Min,l.Max,l.Required),g=(l.Type,l.Placeholder,l.AutoSize,l.Count,l.CountPosition,l.CanResize,l.Apply),m=l.RefId,y=c._Type_,h=c.Inherit,C=void 0!==h&&h,E=g.Allowinheritref,x=void 0===E||E,N=(0,L.useContext)(R.GlobalConfigContext),A=(N.showMessage,N.onCustomInputClick),M=N.controlsAddedByForntEnd,S=(0,L.useContext)(B).config,T=v?"".concat((0,R.getLangMsg)({key:"entityd.refEditBtnEditor.key0001",variables:{MaxLength:v}})):"",D=(0,L.useState)(r||""),F=(0,k.c)(D,2),K=F[0],O=F[1],_=(0,L.useState)(!1),j=(0,k.c)(_,2),U=j[0],H=j[1],z=(0,L.useState)(),q=(0,k.c)(z,2),W=q[0],G=q[1],Q=(0,L.useState)((0,R.getLangMsg)("entityd.refEditBtnEditor.key0002")),Z=(0,k.c)(Q,2),Y=Z[0],X=Z[1],J=(0,L.useState)(!1),$=(0,k.c)(J,2),ee=$[0],te=$[1],ne=(0,L.useRef)((null==S?void 0:S.kdesignerRefType)||"1"),re=(0,L.useRef)(null),ae=(0,L.useRef)(null);(0,L.useEffect)((function(){if(x||!C){var e,t=!g||w()(e=g.Field).call(e,y),n="3"!==ne.current;te(t&&n)}else te(!1)}),[]),(0,L.useEffect)((function(){U||r===K||O(r)}),[r,U,K]),(0,L.useEffect)((function(){var e=c[m];if(e!==W)if(G(e),e){var t=JSON.parse(e);X("".concat((0,R.getLangMsg)({key:"entityd.refEditBtnEditor.key0003",variables:{Name:null==t?void 0:t.Name,Key:null==t?void 0:t.Key}})));var n=_e()(M).call(M,(function(e){return e===d}));Dt()(M).call(M,n,1)}else X((0,R.getLangMsg)("entityd.refEditBtnEditor.key0002"))}),[c[m]]);var oe=function(e){t(e.target.value),I()((function(){H(!1)}),300)},le=function(){return P().createElement(V.Tooltip,{placement:"top",tip:Y},W?P().createElement("span",{className:"".concat(a,"-quote")},(0,R.getLangMsg)("entityd.refEditBtnEditor.key0004")):P().createElement("span",{className:"".concat(a,"-no-quote")},(0,R.getLangMsg)("entityd.refEditBtnEditor.key0005")))};return P().createElement(P().Fragment,null,P().createElement("div",{className:"".concat(a,"-flex-center")},P().createElement(Po,{nameHidden:f,className:a,name:i,tips:u,required:p}),(ee||c[m])&&P().createElement(le,null)),P().createElement("div",{className:"".concat(a,"-ref-input")},P().createElement(V.Input,{ref:re,value:K,disabled:o&&!c[m],title:T,maxLength:v,placeholder:(0,R.getLangMsg)("entityd.refEditBtnEditor.key0006"),borderType:"bordered",readOnly:ee&&"2"===ne.current||c[m],onKeyDown:function(e){13===e.keyCode&&oe(e)},onFocus:function(){H(!0)},onBlur:oe,onChange:function(e){var n,a,o=(null===(n=e.target)||void 0===n?void 0:n.value)||"";O(o),(a=o)!==r&&(clearTimeout(ae.current),ae.current=I()((function(){t(a)}),300))},suffix:(ee||c[m])&&P().createElement("div",{className:"".concat(a,"-flex-icon")},W&&P().createElement("div",{className:"".concat(a,"-clear")},P().createElement(V.Icon,{type:"close",onClick:function(){A&&A(i,c,l,(0,b.c)({type:"del"},m,c[m])),function(e,t){s.batchUpdateControlPropertyValues((0,R.createUpdateAction)([[d,(0,b.c)({},e,t)]]))}(m,"")}})),P().createElement(V.Icon,{prefix:"designericon",style:{cursor:o&&!c[m]?"not-allowed":"pointer"},type:"gengduo",onClick:function(){o&&!c[m]||(n?n&&n(i,c,l):A&&A(i,c,l))}}))})))},Vu=function(){return[["ECombo",Nr,""],["RefCombo",Ir,""],["RefMCombo",Ar,""],["Input",Mr,""],["Select",Sr,""],["RefEditBtn",Du,""]]},Bu="entity-designer-entity-property",Fu=function(e){var t,n=(0,L.useContext)(B),r=n.getKdesignerApi,a=n.showLockBtn,o=n.lockPropsMap,l=void 0===o?{}:o,i=n.designerConfig,u=void 0===i?{}:i,s=r();(0,R.useSelectionChangeForceUpdateEffect)(r());var d=s.selection.getActiveSelectedId(),v=s.data.findControl(d||s.data.getRootId()),p=s.meta.getControlMeta(v.FieldType||v._Type_),g=s.data.getData(),m=g.Items,y=g.extElements,h=void 0===y?[]:y,E=u.enableExtLimits,b=void 0!==E&&E,k=(null===(t=z()(h).call(h,(function(e){return"Field"===e.Type})))||void 0===t?void 0:t.Items)||[];k=j()(k).call(k,(function(e){var t,n;e.Id===(null===(t=m[0])||void 0===t?void 0:t.PkId)&&(e.Id=null===(n=m[0])||void 0===n?void 0:n.Id);return e}));return P().createElement(R.PropertyView,(0,C.c)({},e,{filterPropertyHandler:function(e){var t;return t=e,(0,Ha.Ut)(t,(function(e){if(void 0===e)return[];f()(e).call(e,(function(e){var t,n;e.Nodes=c()(t=e.Nodes).call(t,(function(e){var t;if("style"!==e.TabGroup&&!w()(t=["Width","Height"]).call(t,e.Id))return!0})),e.Nodes=j()(n=e.Nodes).call(n,(function(e){if(!a){var t=v.Inherit,n=e.ReadOnly;b||(e.LockType="unlock"),t||"speciallock"!==e.LockType||(e.LockType="unlock"),!n&&"lock"===e.LockType&&t&&(e.ReadOnly=!0);var r,o=z()(k).call(k,(function(e){return e.Id===v.Id}));o&&(null===(r=o.Props)||void 0===r||f()(r).call(r,(function(t){var r=t.LockType||"lock";e.Id===t.Id&&(e.LockType=r,"lock"===r?e.ReadOnly=!0:n||"unlock"!==r||(e.ReadOnly=!1))})))}var i=l[d];return null!=i&&w()(i).call(i,e.Id)&&(e.ReadOnly=!0),e}))}))}))}}),P().createElement("div",{className:"".concat(Bu,"-readonly-container")},P().createElement("div",{className:"".concat(Bu,"-readonly-container-property")},P().createElement("div",{className:"".concat(Bu,"-readonly-container-property-title")},(0,R.getLangMsg)("entityd.propertyView.key0002")),P().createElement("div",{className:"".concat(Bu,"-readonly-container-property-name"),title:p.Name},p.Name))))};Fu.tabKey="property",Fu.getTabName=function(){return(0,R.getLangMsg)("entityd.propertyView.key0001")};var Ku=Fu,Ou=function(e){var t=e.kdesignerApi,n=e.keywordMapping;return function(e,r,a,o){var l=t.current,i=l.data,c=i.getRootId(),u=o.Id;if(!o.IsContainer)return!1;var s="string"==typeof r?r:r[n.type],d="string"==typeof e?e:e[n.type],f=a.IsContainer,v=a[n.parentId];if(v===u)return!0;if(v){var p=(i.findControl(v)||{})._Type_,g=w()(X).call(X,p)&&!f,m=w()(Y).call(Y,p)&&!f;if(g)return!!w()(X).call(X,s);if(m)return!!w()(Y).call(Y,s)}if(w()(Z).call(Z,d)&&u===c)return!1;if(w()(J).call(J,d)&&w()(X).call(X,s))return!1;if(w()(Z).call(Z,d)&&w()(Z).call(Z,s))return!1;var y=function(e){var t=l.meta.getControlMeta(e).NotAccept;if(t){var n=t.Ids;return null==n?void 0:w()(n).call(n,d)}}(s);if(y)return!1;if(!(y=function(e){var t=l.meta.getControlMeta(e).Accept;if(!t)return!0;if(t){var n=t.Ids;return null==n?void 0:w()(n).call(n,d)}}(s)))return!1;return!!(y=function(e){var t=l.meta.getControlMeta(e).AcceptParent;if(!t)return!0;if(t){var n=t.Ids;return null==n?void 0:w()(n).call(n,s)}}(d))}},_u="update",ju="alias",Uu=new R.DelayQueueUtil([_u,ju]),Hu=function(e){var t=e.dataRef,n=e.kdesignerApi,r=e.keywordMapping;return function(e){var a;if(e&&e[0]){var o=e[0];o=(0,ht.isArray)(o)?o:[o];var l=[],i=c()(a=j()(o).call(o,(function(e){var a,o=e.itemId,i=e.value,c=e.metaType,u=e.propertyName,s=e.alias,d=(0,ht.isUndefined)(s)?Ze()(i):s;if("formmeta"!==c){var f=z()(a=t.current[c].Items).call(a,(function(e){return e.Id===o}));if(f){var v=f[u];if((0,ht.isUndefined)(v)){var p=n.current.meta.getControlPropertyDefaultValue(f[ee],u);p&&(v=p)}if(!(0,ht.isEqual)(v,i))return[o,(0,b.c)({},u,i)];if(!(0,ht.isUndefined)(d)){var g=n.current.aliasData.getAliasDataPropValue(f[r.type],u,i);(0,ht.isEqual)(g,d)||l.push({type:f[r.type],propName:u,value:i,alias:d})}}}}))).call(a,Boolean);Uu.addQueueData(i,_u),Uu.addQueueData(l,ju),Uu.addTimer((function(){var e=Uu.getQueueData(_u),t=Uu.getQueueData(ju);e.length&&n.current.data.batchUpdateControlPropertyValues((0,R.createUpdateAction)(e)),t.length&&I()((function(){n.current.aliasData.setAliasDataPropValue(t)})),Uu.clearQueue()}))}}};n(10936);function zu(e,t){var n=a()(e);if(l()){var r=l()(e);t&&(r=c()(r).call(r,(function(t){return s()(e,t).enumerable}))),n.push.apply(n,r)}return n}function qu(e){for(var t=1;t<arguments.length;t++){var n,r,a=null!=arguments[t]?arguments[t]:{};t%2?f()(n=zu(Object(a),!0)).call(n,(function(t){(0,b.c)(e,t,a[t])})):p()?m()(e,p()(a)):f()(r=zu(Object(a))).call(r,(function(t){h()(e,t,s()(a,t))}))}return e}var Wu=(0,L.memo)((0,L.forwardRef)((function(e,t){var n=e.meta,r=void 0===n?{}:n,o=e.data,l=void 0===o?{}:o,i=e.onData,u=e.onApi,s=e.getPropertyAliasValue,d=void 0===s?function(){return null}:s,v=e.invokeAction,p=void 0===v?function(e,t){}:v,g=e.showMessage,m=void 0===g?function(e){}:g,y=e.handleCustomInputEditor,h=void 0===y?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]}:y,x=e.userConfig,N=void 0===x?{showLeftView:!1,showKey:!0,showType:!0,showFullRelationship:!1}:x,A=e.config,S=e.getLangMsg,D=e.lockPropsMap,F=e.designerConfig,K=(0,L.useRef)(null),O=(0,L.useRef)(l),_=(0,L.useRef)(null),U=(0,L.useRef)(N),H=(0,L.useState)(0),z=(0,k.c)(H,2),q=z[0],W=z[1],G=function(e,t){return(0,R.adaptorMeta)(e,R.transformKeyMap,t)}(r,l.entitymeta),Q=function(e){var t,n,r,o=e.entitymeta,l={};f()(t=a()(o)).call(t,(function(e){o[e]&&Jn[e]&&(l[Jn[e]]=o[e])}));var i=(o.Items&&c()(n=o.Items).call(n,(function(e){return ve(e[ee])})))[0][$],u=o.Items&&j()(r=o.Items).call(r,(function(e){return e[ne]||ve(e[ee])||(e[ne]=i),e}));return l.Items=u,l}(l),Z=(0,L.useCallback)((function(e){switch(e){case"main":return{main:Gn};case"left":return R.ControlView.tabName=S("entityd.index.key0001"),{rootProperty:Xn,control:R.ControlView};case"right":return{rootProperty:Zn,property:Ku};default:return{}}}),[]),Y=(0,L.useCallback)((function(e){return e}),[]),X=(0,L.useCallback)((function(e,t,n){var r=["KeyFieldId"];if(w()(r).call(r,e)){var a=n.findControl(t);return a?a._Type_:t}}),[]),J={id:"Id",type:"_Type_",name:"Name",key:"Key",parentId:"ParentId",items:"Items",fieldType:"FieldType",fieldName:"FieldName"},te=(0,L.useCallback)((function(e,t,n){var r=K.current.aliasData,a=t[J.type],o=t[e],l=t;if((0,ht.isUndefined)(o)){var i=K.current.meta.getControlPropertyDefaultValue(a,e);i&&(l=qu(qu({},t),{},(0,b.c)({},e,i)))}var c=I()((function(){var t,r=n.Alias,a=n.EmptyDisplay;!r||!a&&w()(t=[void 0,""]).call(t,l[e])||d(e,l,n)}));if(r.hasAliasDataPropValue(a,e,l[e])){var u=r.getAliasDataPropValue(a,e,l[e]);return u&&clearTimeout(c),u}}),[d]),re=(0,L.useCallback)((function(e,t,n,r){var a=t[e],o=t[J.type],l=t;if((0,ht.isUndefined)(a)){var i=K.current.meta.getControlPropertyDefaultValue(o,e);i&&(l=qu(qu({},t),{},(0,b.c)({},e,i)))}h(e,l,n,r)}),[h]),ae=(0,L.useRef)({getKdesignerApi:function(){return K.current},getDataRef:function(){return O.current},invokeAction:function(e,t){p(e,t)},prefixCls:"entity-designer",getPrefixCls:function(e,t,n){var r;return n||(e=e||"entity-designer",t?M()(r="".concat(e,"-")).call(r,t):e)},getModel:function(){return $n(K.current)},userConfig:N,showLockBtn:e.showLockBtn,config:A,onUserConfigChange:se,lockPropsMap:D,designerConfig:F}),oe=(0,L.useMemo)((function(){return qu({viewKey:q,changeDesignerView:function(e){W(e)}},ae.current)}),[q]),le=(0,L.useMemo)((function(){return{getViews:Z,processPropertyName:Y,processPropertyValue:X,keywordMapping:J,getEditorFormatValue:te,controlViewMode:"horizontal",showMessage:m,onCustomInputClick:re,designerContextValue:oe,filterProperty:function(e,t){return tr(oe.getModel,oe.getKdesignerApi)(e,t)},preHandle:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wr.apply(void 0,M()(t).call(t,[qu({invokeAction:p},oe)]))},viewCollapseState:{left:!N.showLeftView},onViewCollapseChange:function(e){var t=e.position,n=e.hide;"left"===t&&se({showLeftView:!n})},getPropertyEditors:Vu,controlViewSetting:{hideHelpIcon:!0,hideAnchorIcon:!0,searchInputPlaceholder:S("entityd.index.key0002")},controlsAddedByForntEnd:[],viewSetting:{leftView:function(){return!1},rightView:function(){return!1}},getOutlineItemIcon:function(e){return P().createElement(V.Icon,{prefix:"designericon",type:(0,R.getControlIconMap)(e),className:"".concat("kdesigner-entity-designer","-control-icon")})},canAddCallback:Ou({kdesignerApi:K,keywordMapping:J}),getLangMsg:S}}),[Z,Y,te,m,re,Vu]),ie=(0,L.useRef)({aliasActionQueue:[],dataActionQueue:[],clearQueue:function(){ie.current.aliasActionQueue=[],ie.current.dataActionQueue=[]},addAliasAction:function(e){var t;(t=ie.current.aliasActionQueue).push.apply(t,(0,E.c)(e))},addDataAction:function(e){var t;(t=ie.current.dataActionQueue).push.apply(t,(0,E.c)(e))},fireActionTimer:null}),ce=(0,L.useCallback)((function(e){var t,n;K.current=qu({attrActions:null===(t=_.current)||void 0===t?void 0:t.attrActions,resetPatches:null===(n=_.current)||void 0===n||null===(n=n.dataContext)||void 0===n?void 0:n.resetPatches,setProperty:Hu({dataRef:O,kdesignerApi:K,keywordMapping:J}),addField:function(t,n,r,a){if(t){var o=e.meta,l=e.data,i=e.selection,c=l.findControl(n)._Type_;if(o.canAdd(t,c)){var u={_Type_:t,ParentId:n,Id:(0,R.createUUid)(),Name:r,Key:a};l.addControl((0,R.createAddAction)(u,{isInstrucAdd:!0})).then((function(e){var t=e[0].value,n=T()(t)?[t[0].Id]:[t.Id];i.setSelect(n)}))}else m(S("entityd.index.key0004"))}else m(S("entityd.index.key0003"))},deleteControl:function(t){var n=e.data,r=n.getNextSelectedControlId(t);n.deleteControl((0,R.createDeleteAction)(t)).then((function(){e.selection.setSelect([r])}))},getUserConfig:function(){var e,t,n,r;return{showLeftView:null===(e=U.current)||void 0===e?void 0:e.showLeftView,showKey:null===(t=U.current)||void 0===t?void 0:t.showKey,showType:null===(n=U.current)||void 0===n?void 0:n.showType,showFullRelationship:null===(r=U.current)||void 0===r?void 0:r.showFullRelationship}},uiModel:$n(e)},e),u&&u(K.current)}),[u,le.controlsAddedByForntEnd]),ue=(0,L.useCallback)((function(e,t){(0,C.c)(O.current.entitymeta,e),i&&i(O.current,t)}),[i]);function se(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};U.current=(0,C.c)({},U.current,t),e.onUserConfigChange&&e.onUserConfigChange()}return P().createElement(V.ConfigProvider,{value:{prefixCls:"kdesigner"}},P().createElement(B.Provider,{value:oe},P().createElement(Gu,{ref:_,globalConfig:le,onData:ue,meta:G,data:Q,onApi:ce})))}))),Gu=P().memo(D(),(function(){return!0}));Wu.displayName="EntityDesigner";var Qu=Wu},19600:function(){},77856:function(){}}]);