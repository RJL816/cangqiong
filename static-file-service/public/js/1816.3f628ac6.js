(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[1816],{765792:function(e,t,r){"use strict";r.r(t),t.default={"image-viewer":"_24S4pHJb","image-wrapper":"_2OlQk2lY",normal:"IOAy1h1Y","button-container":"PYUFGp3_",btn:"_23NPXHRG","btn-disabled":"_2t5b6Umz",hidden:"_2aNYmhS9"}},816956:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(182320),r(909112),r(697060),r(360776),r(622676),r(233696),r(505684),r(743924),r(693917),r(205960),r(976896),r(721300),r(846428),r(969e3),r(606200),r(534440),r(76152),r(76124),r(387912),r(690512),r(78504),r(776512),r(997308),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(9692),r(323784),r(633768),r(513640),r(86744);var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}(r(795520)),o=c(r(671252)),i=c(r(765792)),l=r(331428),u=r(419008);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var a;return a=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(a)?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h={marginLeft:0,marginTop:0,transition:"transform 0.3s ease 0s",transform:"scale(1) rotate(0deg)"},v=a.default.memo((function(e){var t=e.url,r=e.showToolBar,n=void 0===r||r,c=e.type,f=e.onLoad,s=e.visible,y=e.onClose,v=m((0,a.useState)(!1),2),g=v[0],w=v[1],E=m((0,a.useState)(h),2),b=E[0],P=E[1],T=(0,a.useRef)(),A=(0,a.useRef)(),k=(0,a.useRef)(),O=(0,a.useRef)(100),S=(0,a.useRef)(0),I=(0,a.useRef)(!1);(0,a.useEffect)((function(){return s?(P(h),window.addEventListener("mouseup",C)):window.removeEventListener("mouseup",C),function(){window.removeEventListener("mouseup",C)}}),[s]);var N=function(e){e=Math.min(20,Math.max(-20,e));var t=O.current;(t+=e)<=25?t=25:t>=8e3&&(t=8e3),O.current=t,P((function(e){return d(d({},e),{},{transform:e.transform.replace(/scale\([^\)]*\)/,"scale(".concat(t/100,")"))})}))},_=function(e){e.preventDefault(),e.stopPropagation()},C=function(e){_(e),w(!1)},x="kdfont kdfont-suoxiao kdhover-color ".concat(i.default.btn," ").concat(O.current<=25?i.default["btn-disabled"]:""),L="kdfont kdfont-fangda kdhover-color ".concat(i.default.btn," ").concat(O.current>=8e3?i.default["btn-disabled"]:""),M="kdfont kdfont-xuanzhuan kdhover-color ".concat(i.default.btn);return a.default.createElement("div",{className:(0,o.default)(i.default["image-viewer"],p({},i.default.hidden,!s)),onMouseDown:function(e){_(e),e.target===T.current?null==y||y():e.target===A.current&&(k.current={x:e.clientX,y:e.clientY},w(!0))},onMouseMove:function(e){if(g&&k.current&&A&&A.current){var t=e.clientX,r=e.clientY,n=k.current,a=n.x,o=n.y;k.current={x:t,y:r};var i=t-a,l=r-o;P((function(e){return d(d({},e),{},{marginTop:e.marginTop+l,marginLeft:e.marginLeft+i})}))}},onWheel:function(e){e.stopPropagation();var t=e.deltaY;u.isWin?N(t<0?15:-15):I.current||(I.current=!0,N(t),setTimeout((function(){I.current=!1}),50))}},a.default.createElement("div",{className:(0,o.default)(i.default["image-wrapper"]),ref:T},a.default.createElement("img",{draggable:!1,className:(0,o.default)(i.default.normal),style:b,"data-image-src":t,"data-image-type":c,ref:A,onLoad:function(){f&&f()}})),n?a.default.createElement("div",{className:i.default["button-container"]},a.default.createElement("a",{href:"",onClick:function(e){_(e),N(-25)},className:x,title:(0,l.getLangMsg)({key:"attachmentpanel.key0062"})}),a.default.createElement("a",{href:"",onClick:function(e){_(e),N(25)},className:L,title:(0,l.getLangMsg)({key:"attachmentpanel.key0061"})}),a.default.createElement("a",{href:"",onClick:function(e){_(e);var t=S.current+90;S.current=t,P((function(e){return d(d({},e),{},{transform:e.transform.replace(/rotate\([^\)]*\)/,"rotate(".concat(t,"deg)"))})}))},className:M,title:(0,l.getLangMsg)({key:"attachmentpanel.key0063"})})):null)}));t.default=v},571092:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(201364),r(697060),r(360776),r(22588),r(622676),r(505684),r(323784),r(885612),r(693917),r(205960),r(976896),r(721300),r(431480),r(443896),r(846428),r(708896),r(969e3),r(606200),r(534440),r(76152),r(670864),r(76124),r(880920),r(633768),r(690512),r(776512),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(233696),r(443616),r(743924),r(835164),r(387912),r(497448),r(660824),r(78504),r(997308),r(977864);var a=S(r(795520)),o=k(r(671252)),i=r(790832),l=k(r(782504)),u=S(r(211152)),c=r(323968),f=r(439532),s=r(331428),d=k(r(250864)),p=k(r(153504)),m=k(r(353168)),y=k(r(816956)),h=k(r(267440)),v=r(248672),g=r(545072),w=r(580032),E=r(984844),b=k(r(127360)),P=k(r(937344)),T=r(24616),A=k(r(713564));function k(e){return e&&e.__esModule?e:{default:e}}function O(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(O=function(e){return e?r:t})(e)}function S(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=O(t);if(r&&r.has(e))return r.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}function I(){I=function(){return t};var e,t={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),l=new x(n||[]);return o(i,"_invoke",{value:S(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",y="executing",h="completed",v={};function g(){}function w(){}function E(){}var b={};f(b,l,(function(){return this}));var P=Object.getPrototypeOf,T=P&&P(P(L([])));T&&T!==r&&a.call(T,l)&&(b=T);var A=E.prototype=g.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,l,u){var c=d(e[o],e,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==n(s)&&a.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,l,u)}),(function(e){r("throw",e,l,u)})):t.resolve(s).then((function(e){f.value=e,l(f)}),(function(e){return r("throw",e,l,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function S(t,r,n){var a=p;return function(o,i){if(a===y)throw new Error("Generator is already running");if(a===h){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var l=n.delegate;if(l){var u=N(l,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var c=d(t,r,n);if("normal"===c.type){if(a=n.done?h:m,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=h,n.method="throw",n.arg=c.arg)}}}function N(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,N(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(a.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=E,o(A,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:w,configurable:!0}),w.displayName=f(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,f(e,c,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},k(O.prototype),f(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new O(s(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(A),f(A,c,"Generator"),f(A,l,(function(){return this})),f(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return l.type="throw",l.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],l=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function N(e,t,r,n,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,a)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t,r){var a;return a=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(a)?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=v.ATTACHMENT_PREVIEW_FILE_STATUS.INITIAL,R=v.ATTACHMENT_PREVIEW_FILE_STATUS.REQUEST_SUCCESS,B=v.ATTACHMENT_PREVIEW_FILE_STATUS.LOAD_SUCCESS,D=v.ATTACHMENT_PREVIEW_FILE_STATUS.FAILED,F=a.default.lazy((function(){return r.e(4260).then(r.bind(r,650336))})),Y=a.default.lazy((function(){return Promise.all([r.e(7016),r.e(1768)]).then(r.bind(r,761768))})),U=a.default.lazy((function(){return Promise.all([r.e(4074),r.e(7016),r.e(9168)]).then(r.bind(r,449168))})),W=a.default.lazy((function(){return Promise.all([r.e(2360),r.e(4260),r.e(312)]).then(r.bind(r,151400))}));function z(e,t){var r=L(L({},e),{},{loadStatus:R});return(0,i.isNil)(t.token)||(r.token=t.token),(0,i.isNil)(t.userAvatarUrl)||(r.userAvatarUrl=t.userAvatarUrl),(0,i.isNil)(t.userName)||(r.userName=t.userName),t.data&&(r.excelData=t.data),t.url&&(r.realPreviewUrl=t.url),(0,f.getAttachInfoFromRootConfig)().wpsAppId&&(r.wpsFileId=t.fileId),r}var H=a.default.forwardRef((function(e,t){var r=e.files,n=e.activedIndex,i=(e.onLoad,e.onClose),k=e.model,O=e.updateFile,S=e.hasPermission,C=e.previewLimitSize,x=e.showNotification,M=e.requestParams,H=void 0===M?{}:M,G=(0,a.useRef)(),K=(0,a.useRef)(),q=_((0,a.useState)(!0),2),Q=q[0],Z=q[1],V=function(e){e.forEach((function(e){var t=e.contentRect.width;G.current.style.cssText="transform: translateX(-".concat(t*n,"px);")}))},J=(0,f.getAttachInfoFromRootConfig)(),X=J.customPreviewUseDefaultType,$=J.previewType,ee=void 0===$?v.PreviewByDefault:$,te=J.allowFileSuffix,re=void 0===te?[]:te,ne=J.onlyofficeServerUrl,ae=J.wpsAppId,oe=(0,f.getRootFormConfig)().accountId,ie=ee===v.PreviewByYunZhiJia;(0,a.useEffect)((function(){var e=new l.default(V);return e.observe(G.current),function(){e.disconnect(G.current)}}),[V]),(0,a.useEffect)((function(){if(G.current){var e=G.current.getBoundingClientRect().width;G.current.style.cssText="transform: translateX(-".concat(e*n,"px);");var t;k&&((t=r[n])&&t.uid&&(0,w.savePreviewedAttamentIdToStorage)(k,t.uid))}}),[n,k]),(0,a.useEffect)((function(){if(r&&r[n]){var e=r[n];if(![D,R].includes(e.loadStatus))if(C>0&&e.size>C)O(L(L({},e),{},{loadStatus:R}),n);else{Z(!0);var t=e.type.toLowerCase(),a=[v.PreviewByPublicWps,v.PreviewByPrivateWps,v.PreviewByYozo].includes(ee),o=ee===v.PreviewByDefault&&v.ATTACHMENT_PREVIEW_EXCEL.includes(t)||X.includes(t),i=ee===v.PreviewByYunZhiJia&&v.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(t),l=ee===v.PreviewByCustom&&(0===re.length||re.includes(t)),u=function(){var r,a=(r=I().mark((function r(a,o,l){var u,c,f,s,d;return I().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(u=(0,w.isPreviewByOnlyOffice)(e.type),r.prev=1,!u){r.next=8;break}return r.next=5,P.default.postApi((0,E.appendParamsToUrl)(a,L({model:k},H)),{onlyOfficeData:(0,w.getOnlyOfficeData)(e)});case 5:r.t0=r.sent,r.next=11;break;case 8:return r.next=10,P.default.getApi((0,E.appendParamsToUrl)(a,L({model:k},H)));case 10:r.t0=r.sent;case 11:"success"===(null==(c=r.t0)?void 0:c.status)?(f=z(e,c),O(f,n)):(null!=c&&c.description&&(null==x||x(c.description)),O(L(L({},e),{},{loadStatus:D}),n)),r.next=21;break;case 15:r.prev=15,r.t1=r.catch(1),s=i&&["pdf","txt"].includes(t)?R:D,d=L(L({},e),{},{loadStatus:s}),v.ATTACHMENT_PREVIEW_IMG_TYPE.includes(t)&&(d.isShowImgPreview=!0),O(d,n);case 21:case"end":return r.stop()}}),r,null,[[1,15]])})),function(){var e=this,t=arguments;return new Promise((function(n,a){var o=r.apply(e,t);function i(e){N(o,n,a,i,l,"next",e)}function l(e){N(o,n,a,i,l,"throw",e)}i(void 0)}))});return function(e,t,r){return a.apply(this,arguments)}}();if(a||o||i||l||(0,w.isPreviewByKKFile)(t)||(0,w.isPreviewByOnlyOffice)(t))u((0,w.isCrossTenant)(null==k?void 0:k.pageId)?e.previewFilePath:e.previewurl);e.loadStatus===D&&Z(!1)}}}),[n,r,ee,k]),(0,a.useImperativeHandle)(t,(function(){return{getCurrentRef:function(){return K}}}),[]);var le=function(){if(S("download")){var e=r[n];if(k&&(0,u.doGlobalDispatch)((0,c.attachOperationCount)(k,[{operationType:"download",uid:[e.uid]}])),e){var t=(0,w.isCrossTenant)(null==k?void 0:k.pageId)?e.downloadFilePath:e.url;window.open((0,E.appendParamsToUrl)(t,L({model:k},H)))}}},ue=function(){var e=r[n];k&&(0,u.doGlobalDispatch)((0,c.attachOperationCount)(k,[{operationType:"preview",uid:[e.uid]}])),e&&window.open("".concat((0,w.appendParamsForUrl)(e.previewurl,k),"#toolbar=0"))};return a.default.createElement("ul",{className:A.default["list-container"],ref:G},r.map((function(e,t){var r=n===t,l=e.type,c=e.previewurl,f=e.url,P=(e.uid,e.loadStatus),O=e.visible,S=e.size,I=(e.onlyOfficeDownloadUrl,e.realPreviewUrl),N=e.previewFilePath;if(c=(0,w.isCrossTenant)(null==k?void 0:k.pageId)?N:c,O&&"1"!==O[0])return a.default.createElement(p.default,{key:e.uid});if(!c||C>0&&S>C)return a.default.createElement("li",{className:A.default["list-item"],key:e.uid},a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:!f||O&&"1"!==O[1]?null:(0,s.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:le}));var _=t===n?K:null,x=l.toLowerCase();if(ee===v.PreviewByYozo&&v.YozoFileType.includes(x))return a.default.createElement("li",{className:A.default["list-item"],key:e.uid},e.loadStatus===R?a.default.createElement("iframe",{ref:_,className:(0,o.default)(A.default["preview-content"]),style:{width:"100%",height:"100%"},src:I,topToolbarHeight:0}):e.loadStatus===D?a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:!f||O&&"1"!==O[1]?null:(0,s.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:le}):a.default.createElement(a.default.Fragment,null,a.default.createElement(m.default,null)));if((0,w.isPreviewByWps)(x)){var M=ae?U:Y,z=ae?e.wpsFileId:e.uid;return a.default.createElement("li",{className:A.default["list-item"],key:"attachment_".concat(t)},r&&a.default.createElement(M,{accountId:oe,appId:ae,className:(0,o.default)(A.default["preview-content"]),url:I,fileId:z,type:l,token:e.token||(0,T.getResponseHeader)(g.CSRF_TOKEN)}))}var G=r&&ee===v.PreviewByOnlyOffice;if(!(r&&P!==v.ATTACHMENT_PREVIEW_FILE_STATUS.INITIAL||G))return a.default.createElement("li",{className:A.default["list-item"],key:"attachment_".concat(t)},a.default.createElement(a.default.Fragment,null,a.default.createElement(b.default,null)));var q=function(){Z(!1)},V=a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:e.visible&&"1"!==e.visible[1]?null:(0,s.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:le});if((ie&&re.length>0||(0,w.isPreviewByCustom)(x))&&!X.includes(x)&&!e.isShowImgPreview&&re.map((function(e){return e.toLowerCase()})).includes(x))return a.default.createElement("li",{className:A.default["list-item"],key:e.uid},e.loadStatus===j?null:e.loadStatus===R||e.loadStatus===B?a.default.createElement("iframe",{ref:_,className:(0,o.default)(A.default["preview-content"]),style:{width:"100%",height:"100%"},src:e.realPreviewUrl||(0,E.appendParamsToUrl)(c,L({model:k},H)),topToolbarHeight:0,onLoad:q}):a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:e.visible&&"1"!==e.visible[1]?null:(0,s.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:le}));if((0,w.isPreviewByOnlyOffice)(x)&&(0,w.getDocumentTypeOfOnlyoffice)(x))return a.default.createElement("li",{className:A.default["list-item"],key:"attachment_".concat(t)},a.default.createElement("div",{style:{width:"100%",height:"100%",display:r?"block":"none"}},a.default.createElement(F,{file:e,documentServerUrl:ne,errorContent:V})));if(v.ATTACHMENT_PREVIEW_IMG_TYPE.includes(x)){var J=e.realPreviewUrl||(0,E.appendParamsToUrl)(c||f,L({model:k,getParentId:function(e){return"bos_entryattach_upload"===e}},H));return V=!ie||X.includes(x)||e.isShowImgPreview?a.default.createElement(y.default,{visible:t===n,ref:_,url:J,type:l,onLoad:q,onClose:function(){return i&&i()}}):v.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(l)&&e.loadStatus===j?null:a.default.createElement("iframe",{ref:_,className:(0,o.default)(A.default["preview-content"]),style:{width:"100%",height:"100%"},src:J,topToolbarHeight:0,onLoad:q}),a.default.createElement("li",{className:A.default["list-item"],key:e.uid},V,Q&&a.default.createElement(m.default,null))}return(v.ATTACHMENT_PREVIEW_OFFICE.includes(x)||v.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(x)||(0,w.isPreviewByKKFile)(x))&&(ie&&!X.includes(x)?e.loadStatus===R||e.loadStatus===B?v.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(x)&&(V=a.default.createElement(a.default.Fragment,null,a.default.createElement("iframe",{ref:_,className:(0,o.default)(A.default["preview-content"]),style:{width:"100%",height:"100%"},src:I||(0,E.appendParamsToUrl)(c,L({model:k},H)),topToolbarHeight:0,onLoad:q}),Q&&a.default.createElement("div",{className:(0,o.default)(A.default["kkfile-loading"])},a.default.createElement(b.default,null)))):V=v.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(x)&&e.loadStatus===j?null:a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0053"}),btnText:(0,s.getLangMsg)({key:"attachmentpanel.key0054"}),onClick:ue}):V=(0,w.isPreviewByKKFile)(x)&&e.loadStatus===R?a.default.createElement(a.default.Fragment,null,a.default.createElement("iframe",{ref:_,className:(0,o.default)(A.default["preview-content"]),style:{width:"100%",height:"100%"},src:"".concat((0,E.appendParamsToUrl)(I,L({model:k},H))),onLoad:q}),Q&&a.default.createElement("div",{className:(0,o.default)(A.default["kkfile-loading"])},a.default.createElement(b.default,null))):v.ATTACHMENT_PREVIEW_EXCEL.includes(x)?e.loadStatus===R||e.loadStatus===B?a.default.createElement(h.default,{file:e}):e.loadStatus===D?a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:e.visible&&"1"!==e.visible[1]?null:(0,s.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:le}):null:"error"===e.status?a.default.createElement(d.default,{title:(0,s.getLangMsg)({key:"attachmentpanel.key0058"})}):u.default[u.IS_IE]?a.default.createElement("iframe",{ref:_,className:(0,o.default)(A.default["preview-content"]),style:{width:"100%",height:"100%"},src:"".concat((0,E.appendParamsToUrl)(c,L({model:k},H)),"#toolbar=0"),onLoad:q}):a.default.createElement(W,{className:(0,o.default)(A.default["preview-pdf-content"]),url:"".concat((0,E.appendParamsToUrl)(c,L({model:k},H))),ref:_,onLoad:q})),a.default.createElement("li",{className:A.default["list-item"],key:"attachment_".concat(t)},V)})))}));t.default=H},811816:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(201364),r(697060),r(360776),r(22588),r(233696),r(505684),r(323784),r(743924),r(885612),r(205960),r(976896),r(431480),r(443896),r(846428),r(708896),r(969e3),r(606200),r(534440),r(76152),r(670864),r(76124),r(880920),r(497448),r(633768),r(690512),r(78504),r(776512),r(997308),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(9692),r(622676),r(443616),r(835164),r(693917),r(721300),r(387912),r(660824);var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=C(t);if(r&&r.has(e))return r.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}(r(795520)),o=_(r(369396)),i=_(r(671252)),l=r(790832),u=r(891052),c=r(211152),f=_(r(571092)),s=_(r(238807)),d=r(323968),p=_(r(937344)),m=r(439532),y=r(984844),h=r(608008),v=r(545072),g=r(248672),w=_(r(713564)),E=r(738704),b=r(674260),P=r(868256),T=r(703188),A=r(580032),k=r(218652),O=r(331428),S=r(576900),I=r(49480),N=r(747325);function _(e){return e&&e.__esModule?e:{default:e}}function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(C=function(e){return e?r:t})(e)}function x(){x=function(){return t};var e,t={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),l=new C(n||[]);return o(i,"_invoke",{value:S(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",m="suspendedYield",y="executing",h="completed",v={};function g(){}function w(){}function E(){}var b={};f(b,l,(function(){return this}));var P=Object.getPrototypeOf,T=P&&P(P(L([])));T&&T!==r&&a.call(T,l)&&(b=T);var A=E.prototype=g.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,l,u){var c=d(e[o],e,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==n(s)&&a.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,l,u)}),(function(e){r("throw",e,l,u)})):t.resolve(s).then((function(e){f.value=e,l(f)}),(function(e){return r("throw",e,l,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function S(t,r,n){var a=p;return function(o,i){if(a===y)throw new Error("Generator is already running");if(a===h){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var l=n.delegate;if(l){var u=I(l,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=y;var c=d(t,r,n);if("normal"===c.type){if(a=n.done?h:m,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=h,n.method="throw",n.arg=c.arg)}}}function I(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(a.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=E,o(A,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:w,configurable:!0}),w.displayName=f(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,f(e,c,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},k(O.prototype),f(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new O(s(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(A),f(A,c,"Generator"),f(A,l,(function(){return this})),f(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return l.type="throw",l.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],l=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;_(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function L(e,t,r,n,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,a)}function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t,r){var a;return a=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(a)?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||F(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(e,t):void 0}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var U=g.ATTACHMENT_PREVIEW_FILE_STATUS.INITIAL,W=g.ATTACHMENT_PREVIEW_FILE_STATUS.REQUEST_SUCCESS,z={download:"attachmentpanel.key0086",newTab:"attachmentpanel.key0097",printFile:"attachmentpanel.key0098"},H=!1,G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.model,n=e.childElement,a=e.requestParams,o=void 0===a?{}:a,i=document.getElementById(g.ATTACHMENT_PRINT_IFRAME);i||((i=document.createElement("iframe")).id=g.ATTACHMENT_PRINT_IFRAME,i.style.cssText="width:100%;height:100%;z-index:-1000000000;position:absolute;top:0"),n||(i.src=(0,y.appendParamsToUrl)(t,j({model:r},o))),i.onload=function(){n&&(n=n.cloneNode(),i.contentWindow.document.body.appendChild(n)),i.contentWindow.print()},document.body.appendChild(i)};t.default=function(e){var t=(0,a.useContext)(h.SystemUIContext),r=t.uiData,n=t.close,_=B((0,a.useState)(!0),2),C=_[0],M=(_[1],B((0,a.useState)(null),2)),F=M[0],Y=M[1],K=(0,a.useRef)(),q=(0,a.useRef)(),Q=(0,a.useRef)(),Z=(0,a.useRef)(),V=r.model,J=r.files,X=r.attachmentPermission,$=r.activedIndex,ee=r.pageId,te=r.isOpenInNewTabByDirective,re=r.curEntryRow,ne=r.fromPanel,ae=r.requestParams,oe=void 0===ae?{}:ae,ie=B((0,a.useState)($),2),le=ie[0],ue=ie[1],ce=(0,a.useState)(J.map((function(e){var t=function(e){var t=(0,m.getAttachInfoFromRootConfig)(),r=t.previewType,n=void 0===r?g.PreviewByDefault:r,a=t.allowFileSuffix,o=void 0===a?[]:a,i=e.toLowerCase(),l=o.length>0?o.map((function(e){return e.toLowerCase()})):[].concat(D(g.ATTACHMENT_PREVIEW_IMG_TYPE),D(g.ATTACHMENT_PREVIEW_OFFICE),["pdf","txt"]);return[g.PreviewByCustom,g.PreviewByYunZhiJia].includes(n)&&l.includes(i)||n===g.PreviewByDefault&&g.ATTACHMENT_PREVIEW_EXCEL.includes(i)||(0,A.isPreviewByWps)(i)||(0,A.isPreviewByYozo)(i)||(0,A.isPreviewByKKFile)(i)||(0,A.isPreviewByOnlyOffice)(i)?U:W}(e.type);return j(j({},e),{},{loadStatus:t})}))),fe=B(ce,2),se=fe[0],de=fe[1],pe=se[le];if(pe&&V&&(0,c.doGlobalDispatch)((0,d.attachOperationCount)(V,[{operationType:"preview",uid:[pe.uid]}])),!H&&V){var me=(0,m.getAttachInfoFromRootConfig)(),ye=me.previewType,he=me.wpsAppId,ve=R(R(R(R(R(R(R({},g.PreviewByDefault,"default"),g.PreviewByCustom,"custom"),g.PreviewByOnlyOffice,"onlyoffice"),g.PreviewByPrivateWps,"privateWps"),g.PreviewByPublicWps,"publicWps"),g.PreviewByYozo,"Yozo"),g.PreviewByYunZhiJia,"yunzhijia")[ye];H=!0,(0,S.sendCtrlPropsEventTracking)({pageId:(null==V?void 0:V.pageId)||ee,controlId:"attachment_previewer",controlType:"attachment_previewer",controlName:(0,O.getLangMsg)({key:"Preview.key001"}),controlProp:I.trackingExtendCtrlProps.ATTACHMENT_PREVIEWER_TYPE,controlValue:he?"new".concat(ve.charAt(0).toUpperCase()).concat(ve.slice(1)):ve})}(0,a.useEffect)((function(){document.addEventListener("click",we),document.addEventListener("keydown",Ee);var e=((0,b.getData)(P.KEY_FORBIDDEN_CODE)||(0,u.List)()).push(T.KEYS.ESC);return(0,b.setData)(P.KEY_FORBIDDEN_CODE,e),function(){document.removeEventListener("click",we),document.removeEventListener("keydown",Ee);var e=((0,b.getData)(P.KEY_FORBIDDEN_CODE)||(0,u.List)()).filter((function(e){return e!==T.KEYS.ESC}));(0,b.setData)(P.KEY_FORBIDDEN_CODE,e)}}),[]),(0,a.useEffect)((function(){if(r&&r.model){var e,t=r.model.pageId,n=(0,E.getPageData)(t,[v.HANDLE_SPLIT_SCREEN_FILE]);if(n)Y(null===(e=n.container)||void 0===e?void 0:e.querySelector("[data-container-key=renderContainer]"))}}),[r]),(0,a.useEffect)((function(){return function(){var e=document.getElementById(g.ATTACHMENT_PRINT_IFRAME);e&&document.body.removeChild(e)}}),[]),(0,a.useEffect)((function(){void 0===Z.current&&(Z.current=(0,A.getPreviewLimitSize)())}),[]);var ge=function(){F||te||n&&n()},we=function(e){(K.current&&e.target===K.current||q.current&&e.target===q.current)&&!te&&ge()},Ee=function(e){e.keyCode!==T.KEYS.ESC||te||ge()},be=(0,a.useCallback)((function(){n&&n()}),[]),Pe=function(){var e,t=(e=x().mark((function e(){var t,r,n,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe){e.next=2;break}return e.abrupt("return");case 2:if(!X||X.download){e.next=4;break}return e.abrupt("return",Ae("printFile"));case 4:if(!(0,A.isPreviewByYozo)(pe.type)||!pe.realPreviewUrl){e.next=8;break}return null==(t=document.querySelector('iframe[src="'.concat(pe.realPreviewUrl,'"]')))||t.contentWindow.print(),e.abrupt("return");case 8:if(r=pe.realPreviewUrl||pe.previewurl,n=(0,A.isCrossTenant)(null==V?void 0:V.pageId)?pe.previewFilePath:pe.previewurl,!((0,A.isUpperCaseTypePreviewByWps)(pe.type)||(0,A.isExcelPreviewByType)(pe.type,g.PreviewByOnlyOffice)||(0,A.isExcelPreviewByType)(pe.type,g.PreviewByDefault))){e.next=17;break}if(pe.realPreviewUrl){e.next=17;break}return e.next=14,p.default.getApi((0,y.appendParamsToUrl)(n,j({model:V},oe)));case 14:return"success"===(a=e.sent).status&&a.url?G({url:a.url,model:V,requestParams:oe}):(0,k.setDataMessages)((0,k.getRootPageId)()((0,c.getGlobalState)()),[{duration:3e3,content:a.description||(0,O.getLangMsg)({key:"attachmentpanel.key0102"}),type:v.AlertType.ERROR}]),e.abrupt("return");case 17:"tif"===pe.type&&(o=document.querySelector('[data-image-src="'.concat((0,y.appendParamsToUrl)(n,j({model:V},oe)),'"]'))),G({url:r,model:V,childElement:o,requestParams:oe});case 19:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){L(o,n,a,i,l,"next",e)}function l(e){L(o,n,a,i,l,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),Te=function(){if(X&&!X.download)return Ae("newTab");var e=se.map((function(e){return e.uid})),t=null;ne&&(t=se.map((function(e){return{uid:e.uid,previewurl:e.previewurl,size:e.size,name:e.name,url:e.url,status:e.status,attPkId:e.attPkId,type:e.type,onlyOfficeDownloadUrl:e.onlyOfficeDownloadUrl}})));var r=(0,y.getRequestParams)(V),a=(0,l.isNumber)(re)?[{curEntryRow:re,activedIndex:le,sortedUids:e,panelData:t,requestParams:r}]:[{activedIndex:le,sortedUids:e,panelData:t,requestParams:r}],o=null!=V?V:{pageId:(0,k.getRootPageId)()};(0,c.doGlobalDispatch)((0,d.previewInNewTab)(o,a)),null==n||n()},Ae=function(e){var t=(0,c.getGlobalState)();if("download"===e&&V){var r=V.key,n=V.pageId,a=(0,E.getPageData)(n,[r,g.ATTACHMENT_PERMISSION_MSG]);return(0,k.setDataMessages)((0,k.getRootPageId)()(t),[{duration:3e3,content:a.download,type:v.AlertType.ERROR}])}var o=(null==V?void 0:V.pageId)||ee;"bos_entryattach_upload"===(0,k.getFormId)(o)(t)&&(o=(0,k.getParentPage)(o)(t)),(0,k.setDataMessages)((0,k.getRootPageId)()(t),[{duration:3e3,content:(0,O.getLangMsg)({key:z[e],variables:{formCaption:(0,k.getFormCaption)(o)(t)}}),type:v.AlertType.ERROR}])},ke=(0,a.useCallback)((function(){if(X&&!X.download)return Ae("download");V&&(0,c.doGlobalDispatch)((0,d.attachOperationCount)(V,[{operationType:"download",uid:[pe.uid]}]));var e=(0,A.isCrossTenant)(null==V?void 0:V.pageId)?pe.downloadFilePath:pe.url,t=(0,y.appendParamsToUrl)(e,j({model:V},oe)),r=(0,y.getRequestParams)(V,j({fileName:pe.name},oe));pe&&(0,A.downloadFile)(t,r)}),[pe]),Oe=(0,i.default)(w.default["content-btn"],w.default["content-btn-left"],R(R(R({},w.default.hide,0===le),w.default["left-btn-hide-animation"],!C),w.default["left-btn-show-animation"],C)),Se=(0,i.default)(w.default["content-btn"],w.default["content-btn-right"],R(R(R({},w.default.hide,le===se.length-1),w.default["right-btn-hide-animation"],!C),w.default["right-btn-show-animation"],C)),Ie=(0,a.useMemo)((function(){var e=se[le];if(e){var t=e.type.toLowerCase(),r=(0,m.getAttachInfoFromRootConfig)(),n=r.previewType,a=r.allowFileSuffix,o=void 0===a?[]:a,i=r.wpsAppId,l=["txt","text/plain","pdf"].concat(D(g.ATTACHMENT_PREVIEW_OFFICE),D(g.ATTACHMENT_PREVIEW_IMG_TYPE)),u=n===g.PreviewByDefault&&!l.includes(t),c=[g.PreviewByYunZhiJia,g.PreviewByYozo,g.PreviewByCustom].includes(n),f=[g.PreviewByPublicWps,g.PreviewByPrivateWps].includes(n)&&!i&&g.WPS_FILE.includes(t),s=n===g.PreviewByPublicWps&&i&&!g.ATTACHMENT_PREVIEW_IMG_TYPE.includes(t),d=(0,A.isPreviewByKKFile)(t),p=u||c||f||s,y=e.visible&&"1"!==e.visible[1],h=y||p||"error"===e.status||e.excelData||(0,N.isDdWindowDesktop)()||d,v=y||"error"===e.status,w=te,E=y||te;if(o.length>0)E=!o.map((function(e){return e.toLowerCase()})).includes(t);else(!e.previewurl||Z.current>0&&e.size>Z.current||!l.includes(t))&&(E=!0);return{file:e,hideCloseBtn:w,hideDownloadBtn:v,hideNewTabBtn:E,hidePrintBtn:h,previewLimitSize:Z.current,close:be,download:ke,openNewTab:Te,print:Pe}}}),[se,le,te]);return o.default.createPortal(a.default.createElement("div",{className:(0,i.default)("kd-cq-popup kd-cq-attachment-previewer-popup",w.default.preview,R({},w.default["preview-splitScreen"],F)),id:"attachmentPreviewEle"},!F&&a.default.createElement(s.default,Ie),a.default.createElement("div",{className:(0,i.default)(w.default.container),ref:K},a.default.createElement("div",{className:Oe,onClick:function(e){le<=0||ue((function(e){return e-1}))}},a.default.createElement("i",{className:(0,i.default)(w.default["handle-icons"],"kdfont kdfont-qianfan")})),a.default.createElement("div",{className:w.default["inner-container"],ref:q},a.default.createElement(f.default,{ref:Q,model:V,files:se,activedIndex:le,pageId:ee,onLoad:function(e){var t=se[e];t.loadStatus!==g.ATTACHMENT_PREVIEW_FILE_STATUS.LOAD_SUCCESS&&de((function(r){return r[e]=j(j({},t),{},{loadStatus:g.ATTACHMENT_PREVIEW_FILE_STATUS.LOAD_SUCCESS}),r}))},onClose:function(){ge()},updateFile:function(e,t){de((function(r){var n=(0,l.cloneDeep)(r);return n[t]=e,n}))},hasPermission:function(e){return!(X&&!X[e])||(Ae("download"),!1)},previewLimitSize:Z.current,showNotification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,k.setDataMessages)((0,k.getRootPageId)()((0,c.getGlobalState)()),[{duration:3e3,content:e,type:v.AlertType.ERROR}])},requestParams:oe})),a.default.createElement("div",{className:Se,onClick:function(e){le!==se.length-1&&ue((function(e){return e+1}))}},a.default.createElement("i",{className:(0,i.default)(w.default["handle-icons"],"kdfont kdfont-houfan")})))),F||document.body)}},238807:function(e,t,r){"use strict";r(697060),r(743924),r(606200),r(78504),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(360776),r(205960),r(721300),r(846428),r(387912),r(633768),r(513640),r(137984);var n=c(r(795520)),a=c(r(671252)),o=r(331428),i=r(248672),l=r(786392),u=c(r(713564));function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function s(e,t,r){var n;return n=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==f(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=n.default.memo((function(e){var t,r=e.file,c=e.hideCloseBtn,f=e.hidePrintBtn,d=e.hideDownloadBtn,p=e.hideNewTabBtn,m=e.print,y=e.download,h=e.close,v=e.openNewTab,g=e.isSplitScreen;return n.default.createElement("div",{className:(0,a.default)("kd-cq-attachment-previewer-header",u.default.header,s({},u.default["header-splitScreen"],g))},n.default.createElement("div",{className:(0,a.default)(u.default["header-left"])},n.default.createElement("span",{className:(0,a.default)(u.default["header-text"]),dangerouslySetInnerHTML:{__html:null===(t=r&&r.name)||void 0===t?void 0:t.replaceAll(" ","&nbsp;")}}),n.default.createElement("span",{className:(0,a.default)(u.default["file-size"])},r&&(0,l.formatFileSize)(r.size))),n.default.createElement("div",{className:u.default["header-right"]},n.default.createElement("div",{id:i.ATTACHMENT_PREVIEW_BY_NEW_TAB,className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,p)),onClick:v},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-wangye")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0054"}))),n.default.createElement("div",{className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,f)),onClick:m},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-dayin")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0059"}))),n.default.createElement("div",{className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,d)),onClick:y},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-xiazai2")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0026"}))),n.default.createElement("div",{className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,c)),onClick:h},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-guanbi6")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0060"})))))}));t.default=d},353168:function(e,t,r){"use strict";r(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.default.createElement("li",{className:o.default["list-item"]},n.default.createElement(n.default.Fragment,null,n.default.createElement(a.default,null)))};var n=i(r(795520)),a=i(r(127360)),o=i(r(713564));function i(e){return e&&e.__esModule?e:{default:e}}},153504:function(e,t,r){"use strict";r(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.default.createElement("li",{className:i.default["list-item"]},n.default.createElement(a.default,{title:(0,o.getLangMsg)({key:"attachmentpanel.key0055"})}))};var n=l(r(795520)),a=l(r(250864)),o=r(331428),i=l(r(713564));function l(e){return e&&e.__esModule?e:{default:e}}},250864:function(e,t,r){"use strict";r(697060),r(743924),r(606200),r(78504),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(360776),r(205960),r(846428),r(387912);var n=l(r(795520)),a=l(r(671252)),o=l(r(713564)),i=l(r(272628));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t,r){var n;return n=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==u(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=function(e){var t=e.visible,r=void 0===t||t,l=e.title,u=e.btnText,f=e.onClick;return n.default.createElement("div",{className:(0,a.default)(o.default["alert-container"],c({},o.default.hide,!r))},n.default.createElement("img",{className:(0,a.default)(o.default["alert-img"]),src:i.default,alt:"预览"}),n.default.createElement("p",{className:(0,a.default)(o.default["alert-title"])},l||""),n.default.createElement("a",{className:(0,a.default)(o.default["alert-btn"]),onClick:function(){return f&&f()}},u||""))}},272628:function(e){e.exports="data:image/png;base64,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"}}]);