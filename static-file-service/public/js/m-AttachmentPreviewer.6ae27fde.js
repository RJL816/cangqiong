"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[4414],{786376:function(e,t,r){r.r(t),t.default={preview:"NPlUcDER",imgbox:"_1-1lDGSZ",gifbox:"_1w15n0z2",gif:"_2NSAbbhe",zipbox:"_3vCNBt-d",audiobox:"oU2NLrUo",videobox:"_1g5_sJbI",loading:"_2T6yHpMz",errmsg:"_3S36jpOi",loadinggif:"Sc4zBT3j",kkFileToolbar:"_3MKOK8R2"}},814140:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(182320),r(909112),r(201364),r(697060),r(360776),r(22588),r(622676),r(233696),r(505684),r(323784),r(885612),r(693917),r(205960),r(976896),r(431480),r(443896),r(846428),r(708896),r(969e3),r(606200),r(534440),r(76152),r(670864),r(76124),r(880920),r(836887),r(633768),r(690512),r(776512),r(997308),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PreviewItem=void 0,r(9692),r(443616),r(743924),r(686456),r(927184),r(297336),r(721300),r(387912),r(497448),r(125048),r(660824),r(78504),r(977864);var i=k(r(795520)),o=j(r(369396)),a=r(211152),l=k(r(720056)),s=j(r(154924)),c=k(r(732612)),u=j(r(937344)),f=r(331428),d=r(426904),h=r(248672),v=k(r(747325)),p=j(r(507904)),w=j(r(907160)),m=r(589200),y=r(439532),g=j(r(650336)),E=j(r(267440)),P=j(r(882976)),b=j(r(738464)),S=r(580032),T=r(323968),_=r(608008),x=r(674260),I=r(868256),L=j(r(786376)),O=j(r(380440)),F=r(790832);function j(e){return e&&e.__esModule?e:{default:e}}function Y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Y=function(e){return e?r:t})(e)}function k(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=Y(t);if(r&&r.has(e))return r.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=o?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,r&&r.set(e,i),i}function C(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t,r){return(t=z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(){R=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),l=new j(n||[]);return o(a,"_invoke",{value:I(e,r,l)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var h="suspendedStart",v="suspendedYield",p="executing",w="completed",m={};function y(){}function g(){}function E(){}var P={};u(P,l,(function(){return this}));var b=Object.getPrototypeOf,S=b&&b(b(Y([])));S&&S!==r&&i.call(S,l)&&(P=S);var T=E.prototype=y.prototype=Object.create(P);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,a,l,s){var c=d(e[o],e,a);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==n(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,l,s)}),(function(e){r("throw",e,l,s)})):t.resolve(f).then((function(e){u.value=e,l(u)}),(function(e){return r("throw",e,l,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return a=a?a.then(i,i):i()}})}function I(t,r,n){var i=h;return function(o,a){if(i===p)throw new Error("Generator is already running");if(i===w){if("throw"===o)throw a;return{value:e,done:!0}}for(n.method=o,n.arg=a;;){var l=n.delegate;if(l){var s=L(l,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=w,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var c=d(t,r,n);if("normal"===c.type){if(i=n.done?w:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=w,n.method="throw",n.arg=c.arg)}}}function L(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,L(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=d(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function Y(t){if(t||""===t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return g.prototype=E,o(T,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:g,configurable:!0}),g.displayName=u(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,u(e,c,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},_(x.prototype),u(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new x(f(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(T),u(T,c,"Generator"),u(T,l,(function(){return this})),u(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=Y,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(F),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,i){return l.type="throw",l.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],l=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),F(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;F(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:Y(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function M(e,t,r,n,i,o,a){try{var l=e[o](a),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,i)}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z(n.key),n)}}function A(e,t,r){return t&&V(e.prototype,t),r&&V(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}function X(e,t,r){return t=K(t),function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return H(e)}(e,G()?Reflect.construct(t,r||[],K(e).constructor):t.apply(e,r))}function G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(G=function(){return!!e})()}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}var q=i.default.lazy((function(){return Promise.all([r.e(4074),r.e(7016),r.e(9168)]).then(r.bind(r,449168))})),$=(v.default.isWxWork||v.default.isWx)&&!(0,v.isMobileDevice)(),Q=t.default=function(e){function t(e){var r;return N(this,t),(r=X(this,t,[e])).openNewTab=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.activedIndex,r=e.sortedUids,n=e.pageId,i=e.key,o=[{activedIndex:t,sortedUids:r,curEntryRow:e.curEntryRow,panelData:e.panelData,requestParams:e.requestParams}],l={pageId:n,key:i};(0,a.doGlobalDispatch)((0,T.previewInNewTab)(l,o))},r.showAttachmentPreviewer=function(e){var t=r.hasFileURL(e),n=t.previewUrl,i=t.downloadUrl,o=t.fileExt,a=t.urlList,s=void 0===a?[]:a,c=t.isDownloadOnly,u=void 0!==c&&c,f=(t.fileName,t.previewType),d=void 0===f?h.PreviewByDefault:f,p=t.localId,w=t.visible,m=void 0===w?"1111":w,g=t.appPreviewClose;o=o&&o.toLowerCase();var E=d===h.PreviewByYunZhiJia,b=d===h.PreviewByPublicWps||d===h.PreviewByPrivateWps,T=d===h.PreviewByYozo,_=d===h.PreviewByOnlyOffice,x=h.PREVIEW_FILE_TYPE.image.includes(o)&&(0,l.existAppFunction)("previewImage")&&!window.closeYzjPreview,I=(0,S.getIsCustomPreviewUseDefaultType)(d,o);if(r.isYzjEnv=v.default.isYzj&&!g&&!window.closeYzjPreview,(0,S.getIsOpenNewTab)()&&t.sortedUids)return r.openNewTab(t);if(x&&!$&&!u&&(!E&&!(0,S.isPreviewByCustom)(o)||I||v.default.isYzj)&&n&&"1"===m[0]){var L={current:(E||(0,S.isPreviewByCustom)(o))&&v.default.isYzj&&!I?i:n,urls:s};return P.default.log("云之家图片预览",L),void(0,l.default)("previewImage",{data:L})}if(v.default.isYzj&&h.PREVIEW_FILE_TYPE.video.includes(o)&&p&&"1"===m[0])r.showYzjVideoFile(t);else if(h.PREVIEW_FILE_TYPE.gif.includes(o)&&(!E&&!(0,S.isPreviewByCustom)(o)||I||v.default.isYzj)&&n&&"1"===m[0])r.setState({file:e,showPreviewPanel:!0,showLoading:!1,showErr:!1});else if(b&&h.WPS_FILE.includes(t.fileExt)){var O=(0,y.getAttachInfoFromRootConfig)(),F=O.previewType,j=O.wpsAppId;r.setState({showPreviewPanel:!0,showLoading:!0,showErr:!1},(function(){return r.getWpsUrl(n,e,{appId:j,previewType:F})}))}else if(((E||(0,S.isPreviewByCustom)(o))&&!I||(0,S.isPreviewByKKFile)(o)||_)&&!r.isYzjEnv||T)r.setState({showPreviewPanel:!0,showLoading:!0,showErr:!1},(function(){return r.getPreviewUrl(n,e,{previewType:d,fileData:t})}));else if(r.isYzjEnv)r.showYzjFile(t);else if(!v.default.isDesktop||!u&&r.canPreviewerTypes.includes(o))if(u){var Y=document.createElement("iframe");Y.style.display="none",document.body.appendChild(Y),Y.src=i}else{if(h.PREVIEW_FILE_TYPE.excel.includes(o)&&![h.PreviewByOnlyOffice].includes(d))return void r.setState({showPreviewPanel:!0,showLoading:!0,showErr:!1},(function(){return r.getXlsPreviewUrl(n,e)}));r.setState({file:e,showPreviewPanel:!0,showLoading:!1,showErr:!1})}else r.downloadFile(t)},r.getPreviewUrl=function(){var e,t=(e=R().mark((function e(t,n,i){var o,a,l;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.previewType,a=i.fileData,e.prev=1,e.next=4,(0,S.requestPreviewUrl)({previewUrl:t,previewType:o,fileData:a});case 4:"success"===(l=e.sent).status?(n.previewSrc=l.url,n.token=l.token,(0,F.isNil)(l.userAvatarUrl)||(n.userAvatarUrl=l.userAvatarUrl),(0,F.isNil)(l.userName)||(n.userName=l.userName),r.setState({file:n,showPreviewPanel:!0,showLoading:!1,showErr:!1})):(r.setState({showPreviewPanel:!0,showLoading:!1,showErr:!0}),P.default.error(JSON.stringify(l))),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),h.PREVIEW_FILE_TYPE.image.includes(n.fileExt.toLowerCase())&&(n.isShowImgPreview=!0),n.previewSrc=t,r.setState({file:n,showPreviewPanel:!0,showLoading:!1,showErr:!1});case 13:case"end":return e.stop()}}),e,null,[[1,8]])})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){M(o,n,i,a,l,"next",e)}function l(e){M(o,n,i,a,l,"throw",e)}a(void 0)}))});return function(e,r,n){return t.apply(this,arguments)}}(),r.getXlsPreviewUrl=function(e,t){u.default.getApi(e).then((function(e){"success"===e.status?(e.data?t.excelData=e.data:(t.previewSrc=(0,y.setAccountId)(e.url),t.xlsId=e.id),r.setState({file:t,showPreviewPanel:!0,showLoading:!1,showErr:!1})):(r.setState({showPreviewPanel:!0,showLoading:!1,showErr:!0}),P.default.error(JSON.stringify(e)))}))},r.getWpsUrl=function(e,t,n){var i=n.appId,o=n.previewType;u.default.getApi(e).then((function(e){"success"===e.status?i?r.setState({file:D(D({},t),{},{wpsFileId:e.fileId,wpsAppId:i}),showPreviewPanel:!0,showLoading:!1,showErr:!1}):r.setState({file:t,showPreviewPanel:!0,showLoading:!1,showErr:!1},(function(){r.wpsSDK=w.default.config({url:e.url,mount:document.getElementById("wpsContainer"),commonOptions:{isShowHeader:!1}}),o===h.PreviewByPrivateWps&&e.token&&r.wpsSDK.setToken({token:e.token,timeout:36e5}),r.wpsSDK.on("fileOpen",(function(e){P.default.log(e.success)})),r.wpsSDK.on("error",(function(e){P.default.log("发生错误：",e)}))})):(r.setState({showPreviewPanel:!0,showLoading:!1,showErr:!0}),P.default.error(JSON.stringify(e)))}))},r.editFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.previewType,r=void 0===t?h.PreviewByDefault:t,n=e.fileExt.toLowerCase(),i=r===h.PreviewByYunZhiJia||(0,S.isPreviewByCustom)(n),o=(0,S.getIsCustomPreviewUseDefaultType)(r,n),a=r===h.PreviewByPublicWps||r===h.PreviewByPrivateWps,l=r===h.PreviewByOnlyOffice||(0,S.isPreviewByKKFile)(n);delete e.fileId,h.YZJ_SHOWFILE_ALLOW_TYPE.includes(n)&&(!(0,m.getMobileOS)().includes("iOS")||i&&!o||a||l||h.PREVIEW_FILE_TYPE.excel.includes(e.fileExt.toLowerCase())?e.supportOnlinePreview=!0:e.filePreviewUrl=e.previewUrl);var s=e.fileName.split("."),c=s.splice(s.length-1,1)[0]||"";return e.name="".concat(s.join("."),".").concat(c.toLowerCase()),e},r.showYzjFile=function(e){e=r.editFile(e),P.default.log("云之家",e),(0,l.default)("showFile",{data:e})},r.downloadFile=function(e){e=r.editFile(e),v.default.isOldClient?window.open(e.downloadUrl):(0,l.default)("downloadFile",{data:e})},r.showYzjVideoFile=function(e){(0,l.default)("video_play",{data:{localId:e.localId},failCallback:function(){(0,l.default)("video_download",{data:{serverId:e.fileId},callback:function(e){P.default.log(JSON.stringify(e)),(0,l.default)("video_play",{data:{localId:e.localId}})}})}})},r.hasFileURL=function(e){return e.fileDownloadUrl||(e.fileDownloadUrl=e.downloadUrl),e},r.backEvent=function(e){var t,n;r.state.showPreviewPanel&&!document.location.href.endsWith("?"+c.customUrl)&&(null===(t=(n=r.context).close)||void 0===t||t.call(n))},r.closePreviewer=function(){var e,t;r.state.showPreviewPanel&&document.location.href.endsWith("?"+c.customUrl)&&window.history.go(-1),null===(e=(t=r.context).close)||void 0===e||e.call(t)},r.state={file:{},showPreviewPanel:!1,showLoading:!1,showErr:!1},r.editFile=r.editFile.bind(H(r)),r.isYzjEnv=v.default.isYzj,r.canPreviewerTypes=[].concat(C(h.PREVIEW_FILE_TYPE.excel),C(h.PREVIEW_FILE_TYPE.pdf),C(h.PREVIEW_FILE_TYPE.txt),C(h.PREVIEW_FILE_TYPE.word),C(h.PREVIEW_FILE_TYPE.ppt)),r}return J(t,e),A(t,[{key:"componentDidMount",value:function(){var e=this;this.showAttachmentPreviewer(this.context.uiData),this.removeGlobalDataChangeListener=(0,x.addDataChangeListener)(I.KEY_SHOW_ATTACHMENT_PREVIEWER,(function(t){var r=t&&t[1];e.showAttachmentPreviewer(r)})),window.addEventListener("popstate",this.backEvent)}},{key:"componentWillUnmount",value:function(){var e,t,r;null===(e=this.removeGlobalDataChangeListener)||void 0===e||e.call(this),window.removeEventListener("popstate",this.backEvent),null===(t=this.wpsSDK)||void 0===t||null===(r=t.destory)||void 0===r||r.call(t)}},{key:"render",value:function(){var e=this.state,t=e.file,r=e.showPreviewPanel,n=e.showLoading,o=e.showErr,a=t.fileExt,l=void 0===a?"":a,s=t.previewUrl,c=t.previewSrc,u=t.isDownloadOnly,f=void 0!==u&&u,d=t.previewType,v=l.toLowerCase(),p=(!this.isYzjEnv||h.PREVIEW_FILE_TYPE.gif.includes(v))&&!f,w=[h.PreviewByOnlyOffice,h.PreviewByPrivateWps,h.PreviewByPublicWps,h.PreviewByYozo,h.PreviewByCustom].includes(d);return p||w?i.default.createElement(ee,{showLoading:n,showErr:o,showPreviewPanel:r,src:(0,S.getAttSrc)(t,d,v),previewUrl:s,fileExt:l,previewSrc:c,close:this.closePreviewer,file:t,previewType:d}):null}}]),t}(i.Component);Q.contextType=_.SystemUIContext;var ee=t.PreviewItem=function(e){function t(e){var r;return N(this,t),(r=X(this,t,[e])).handleClose=function(){r.props.close&&r.props.close()},r.handleExcelDidMount=function(){r.ExcelZoom=new b.default(r.excelRef.current)},r.handleExcelWillUnmount=function(){r.ExcelZoom&&r.ExcelZoom.removeListener()},r.renderPreviewer=function(){var e=r.props,t=e.src,n=e.previewUrl,o=e.previewSrc,a=e.fileExt,l=void 0===a?"":a,s=e.previewType,c=e.file,u=void 0===c?{}:c,v=i.default.createElement("div",{className:L.default.zipbox},(0,f.getLangMsg)({key:"attachmentpanel.key0043",variables:{ext:l}})),p=u.wpsAppId,w=u.wpsFileId,m=u.fileId,P=l.toLowerCase(),b=h.PREVIEW_FILE_TYPE.pdf,T=h.PREVIEW_FILE_TYPE.txt,_=h.PREVIEW_FILE_TYPE.excel,x=h.PREVIEW_FILE_TYPE.word,I=h.PREVIEW_FILE_TYPE.ppt,F=h.PREVIEW_FILE_TYPE.image,j=h.PREVIEW_FILE_TYPE.gif,Y=s===h.PreviewByYunZhiJia,k=s===h.PreviewByOnlyOffice,B=s===h.PreviewByYozo,W=(0,S.getIsCustomPreviewUseDefaultType)(s,P),D=[h.PreviewByPublicWps,h.PreviewByPrivateWps].includes(s)&&h.WPS_FILE.includes(u.fileExt),U=!!p;if((0,S.isPreviewByKKFile)(P))return i.default.createElement(i.default.Fragment,null,i.default.createElement("iframe",{src:o}),i.default.createElement(O.default,{onHandleClose:r.handleClose,className:L.default.kkFileToolbar}));if(k&&[].concat(C(_),C(b),C(T),C(x),C(I)).includes(P)){var R=(0,y.getAttachInfoFromRootConfig)().onlyofficeServerUrl;return i.default.createElement(g.default,{url:t,documentServerUrl:R,file:(0,S.mobTransformFileData)(u)})}if(D){if(U){var M=(0,y.getRootFormConfig)().accountId;return i.default.createElement(i.default.Suspense,{fallback:i.default.createElement("div",null)},i.default.createElement(q,{accountId:M,appId:p,type:P,fileId:w,token:m}))}return i.default.createElement("div",{id:"wpsContainer",style:{width:"100%",height:"100%"}})}if((Y&&!r.isYzjEnv||(0,S.isPreviewByCustom)(P))&&!W||B)return i.default.createElement("iframe",{src:o});if([].concat(C(b),C(x),C(I),C(T)).includes(P))return i.default.createElement(te,{src:n||t,handleCloseViewer:r.props.close});if(F.includes(P))return i.default.createElement("img",{className:L.default.imgbox,src:n||t});if(j.includes(P)){var N=Y&&r.isYzjEnv&&!W?t:n||t;return i.default.createElement("div",{className:L.default.gifbox,onClick:r.handleClose},i.default.createElement("img",{className:L.default.gif,src:N}))}return _.includes(P)?i.default.createElement(E.default,{file:u,hasToolbar:!0,onExcelDidMount:r.handleExcelDidMount,onExcelWillUnmount:r.handleExcelWillUnmount,ref:r.excelRef,onHandleClose:r.handleClose}):(0,d.isRunOnPc)()?i.default.createElement("iframe",{src:t}):v},r.isImage=function(){var e=r.props,t=e.fileExt,n=void 0===t?"":t,i=e.previewType,o=void 0===i?h.PreviewByDefault:i,a=e.file,l=n.toLowerCase(),s=o===h.PreviewByYunZhiJia||(0,S.isPreviewByCustom)(l),c=(0,S.getIsCustomPreviewUseDefaultType)(o,l);return!(null==a||!a.isShowImgPreview)||h.PREVIEW_FILE_TYPE.image.includes(l)&&!$&&(!s||c)},r.container=document.body,r.excelRef=i.default.createRef(null),r.ExcelZoom=null,r}return J(t,e),A(t,[{key:"componentDidMount",value:function(){this.props.showPreviewPanel&&(0,c.default)()}},{key:"componentDidUpdate",value:function(e){var t=this.props.showPreviewPanel;!e.showPreviewPanel&&t&&(0,c.default)()}},{key:"render",value:function(){var e=this.props,t=e.showPreviewPanel,r=e.showLoading,n=e.showErr,a=e.file,l=e.src,c=e.previewUrl;if(!t)return null;var u=(0,S.getImageInfo)(a,l,c),d=u.imgUrls,h=u.curIndex;return o.default.createPortal(i.default.createElement("div",{className:L.default.preview},!r&&!n&&(this.isImage()?i.default.createElement(p.default,{key:"preview",onClose:this.handleClose,imgUrls:d,curIndex:h,imageTypes:a.imageTypes}):this.renderPreviewer()),r&&!n&&i.default.createElement(s.default,{text:(0,f.getLangMsg)("attachmentpanel.key0076")}),n&&!r&&i.default.createElement("div",{className:L.default.errmsg},(0,f.getLangMsg)("attachmentpanel.key0048"))),this.container)}}]),t}(i.default.Component),te=function(e){var t=e.src,n=e.handleCloseViewer,o=(0,i.lazy)((function(){return Promise.all([r.e(2360),r.e(4260),r.e(3684)]).then(r.bind(r,408336))})),a=i.default.createElement(s.default,{text:(0,f.getLangMsg)("attachmentpanel.key0074")});return i.default.createElement(i.Suspense,{fallback:a},i.default.createElement(o,{url:t,clientEnv:v.default,handleCloseViewer:n}))}},738464:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(182320),r(909112),r(697060),r(360776),r(743924),r(205960),r(846428),r(606200),r(387912),r(78504),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=r(411976))&&i.__esModule?i:{default:i},a=r(252040),l=r(674260),s=r(868256);function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function u(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var d=u((function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init=function(e){e&&(e.onload=function(){r.iframe=e.contentWindow.document.querySelector("frame")||e,r.iframe&&(r.removeGestureService=(0,a.addGestureService)(r.iframe.contentDocument),r.removeFingerTransForm=r.addFingerTransForm(r.iframe),r.iframe.onload=function(){r.removeListener(),r.removeGestureService=(0,a.addGestureService)(r.iframe.contentDocument),r.removeFingerTransForm=r.addFingerTransForm(r.iframe)})})},this.addFingerTransForm=function(e){r.fingerTransForm=new o.default({viewerBox:e.contentWindow,viewer:e.contentDocument.body,minScale:.3,maxScale:2,isShowScaleTip:!0}),r.startScale=r.fingerTransForm.getScale();var t=(0,l.addDataChangeListener)(s.KEY_GUESTURE_PINCH,r.handleTouchMove),n=(0,l.addDataChangeListener)(s.KEY_TOUCH_END,r.handleTouchEnd);return function(){t&&t(),n&&n()}},this.removeListener=function(){r.removeFingerTransForm&&r.removeFingerTransForm(),r.removeGestureService&&r.removeGestureService()},this.handleTouchMove=function(e){e.pinchScale=e.pinchScale*r.startScale,r.fingerTransForm.pinchMoveTransForm(e)},this.handleTouchEnd=function(){r.startScale=r.fingerTransForm.getScale(),r.fingerTransForm.pinchEndTransFTorm()},this.iframe=null,this.fingerTransForm=null,this.removeGestureService=null,this.removeFingerTransForm=null,this.init(t)}));t.default=d},411976:function(e,t,r){r(697060),r(743924),r(606200),r(78504),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(360776),r(9692),r(205960),r(846428),r(387912),r(23544),r(86744);var n=r(868256),i=r(674260),o=r(331428);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:String(t)}var c=function(){function e(t){var r=this,a=t.viewerBox,l=t.viewer,s=t.pdfViewer,c=t.minScale,u=t.maxScale,f=t.canSet,d=t.isShowScaleTip;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getRootStyle=function(){var e=window.getComputedStyle(r.viewer);return{marginLeft:parseFloat(e.marginLeft)||0,marginTop:parseFloat(e.marginTop)||0,width:parseFloat(e.width)||0,height:parseFloat(e.height)||0}},this.getScale=function(){return r.scale},this.getMoveY=function(e,t,n,i,o,a){return i>=0?(r.viewerBox.scrollTo(o,0),r.scrollY=0,(r.scale*r.rootHeight-r.rootHeight)/2):r.canSet?r.moveY-(e.y-i-t.y)*(n-1):r.moveY-(e.y-i-a-t.y)*(n-1)},this.getMoveX=function(e,t,n,i,o,a){return i>0?(r.viewerBox.scrollTo(0,a),r.scrollX=0,(r.scale*r.rootWidth-r.rootWidth)/2):r.canSet?r.moveX-(e.x-i-t.x)*(n-1):r.moveX-(e.x-i-o-t.x)*(n-1)},this.setScale=function(e,t){if(e!==r.scale){var n=e/r.scale;if(r.preScale=r.scale,r.scale=e,t){var i=r.viewer.getBoundingClientRect(),o=i.width,a=i.height,l=i.top,s=i.left,c=r.getScroll(),u=c.scrollX,f=c.scrollY,d={x:.5*o,y:.5*a};r.moveX=r.getMoveX(t,d,n,s,u,f),r.moveY=r.getMoveY(t,d,n,l,u,f)}}},this.getScroll=function(){var e,t,n,i;return{scrollX:(null===(e=r.viewerBox)||void 0===e?void 0:e.scrollX)||(null===(t=r.viewerBox)||void 0===t?void 0:t.scrollLeft)||0,scrollY:(null===(n=r.viewerBox)||void 0===n?void 0:n.scrollY)||(null===(i=r.viewerBox)||void 0===i?void 0:i.scrollTop)||0}},this.setScrollInfo=function(){var e=r.viewer.getBoundingClientRect(),t=e.left,n=e.top,i=r.getScroll(),o=i.scrollX,a=i.scrollY;if(t<0){var l=o- -1*t;r.moveX=r.moveX-l+r.rootStyle.marginLeft,r.scrollX=o-l+r.rootStyle.marginLeft}if(t>=0&&(r.moveX=r.moveX+-1*t-o+r.rootStyle.marginLeft,r.scrollX=0),n<0){var s=a- -1*n;r.moveY=r.moveY-s+r.rootStyle.marginTop,r.scrollY=a-s+r.rootStyle.marginTop}n>=0&&(r.moveY=r.moveY+-1*n-a+r.rootStyle.marginTop,r.scrollY=0)},this.getBoundaryZoom=function(e,t){return t*e<=r.minScale?(r.prefixMsg=(0,o.getLangMsg)({key:"attachmentpanel.key0109"}),r.minScale/t):r.maxScale&&t*e>r.maxScale?(r.prefixMsg=(0,o.getLangMsg)({key:"attachmentpanel.key0108"}),r.maxScale/t):(r.prefixMsg=(0,o.getLangMsg)({key:"attachmentpanel.key0107"}),e)},this._showScaleTip=function(){var e=Math.round(r.scale*r.currentScale*100),t={msg:"".concat(r.prefixMsg).concat(e,"%"),style:{"z-index":"999999","pointer-events":"none"},duration:500};(0,i.setData)(n.KEY_SHOW_CONFIRM_EVENT,t)},this.reset=function(){r.preScale=0,r.scale=1,r.pinchIng=!1,r.initTransform=r.viewer.style.transform,r.inintTransformOrigin=r.viewer.style.transformOrigin,r.scrollX=0,r.scrollY=0,r.rootStyle=r.getRootStyle(),r.rootHeight=r.rootStyle.height||0,r.rootWidth=r.rootStyle.width||0,r.moveX=r.rootStyle.marginLeft||0,r.moveY=r.rootStyle.marginTop||0,r.prefixMsg=(0,o.getLangMsg)({key:"attachmentpanel.key0107"})},this.pinchEndTransFTorm=this.debounce(this._pinchEndTransFTorm,300),this.pinchEndTransFTormRender=this.debounce(this._pinchEndTransFTormRender,300),this.viewerBox=a,this.viewer=l,this.minScale=c,this.maxScale=u,this.pdfViewer=s,this.preScale=0,this.scale=1,this.pinchIng=!1,this.initTransform=this.viewer.style.transform,this.inintTransformOrigin=this.viewer.style.transformOrigin,this.scrollX=0,this.scrollY=0,this.timer=null,this.rootStyle=this.getRootStyle(),this.rootHeight=this.rootStyle.height||0,this.rootWidth=this.rootStyle.width||0,this.moveX=this.rootStyle.marginLeft||0,this.moveY=this.rootStyle.marginTop||0,this.canSet=f,this.prefixMsg=(0,o.getLangMsg)({key:"attachmentpanel.key0107"}),this.currentScale=1,this.isShowScaleTip=d}var t,r,a;return t=e,r=[{key:"pinchMoveTransForm",value:function(e){if(isFinite(e.pinchScale)){this.timer&&(clearTimeout(this.timer),this.timer=null),this.currentScale=e.currentScale||1;var t=this.getBoundaryZoom(e.pinchScale,this.currentScale);if(t===this.scale)return this.isShowScaleTip&&this._showScaleTip();this.setScale(t,e.center),this.viewer.style.transform="matrix(".concat(this.scale,", 0, 0, ").concat(this.scale,", ").concat(this.moveX,", ").concat(this.moveY,")"),this.pinchIng=!0,this.isShowScaleTip&&this._showScaleTip()}}},{key:"_pinchEndTransFTormRender",value:function(){var e=this;if(isFinite(this.scale)&&this.pinchIng){var t=this.viewer.getBoundingClientRect(),r=t.top,n=t.left;if(this.viewer.style.transform=this.initTransform,this.viewer.style.transformOrigin=this.inintTransformOrigin,this.pdfViewer){var i=this.pdfViewer.currentScale*this.scale;i<=this.minScale&&(i=this.minScale),this.pdfViewer.currentScale=i}window.requestAnimationFrame((function(){e.viewerBox.scrollTo(-1*n,-1*r)})),this.pinchIng=!1,this.reset()}}},{key:"_pinchEndTransFTorm",value:function(){var e=this;isFinite(this.scale)&&this.pinchIng&&(this.pinchIng=!1,this.setScrollInfo(),this.viewer.style.transform="matrix(".concat(this.scale,", 0, 0, ").concat(this.scale,", ").concat(this.moveX,", ").concat(this.moveY,")"),window.requestAnimationFrame((function(){e.viewerBox.scrollTo(e.scrollX,e.scrollY)})))}},{key:"debounce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return this.timer=null,function(){var r=arguments,n=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.apply(n,r),n.timer=null}),t)}}}],r&&l(t.prototype,r),a&&l(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=c},426904:function(e,t,r){r(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.isRunOnPc=function(){if(i.default.isUnknown){var e=(0,o.getMobileOS)().toLocaleLowerCase();return!(e.includes("ios")||e.includes("android"))}return!1},r(443616),r(660824);var n,i=(n=r(747325))&&n.__esModule?n:{default:n},o=r(589200)}}]);