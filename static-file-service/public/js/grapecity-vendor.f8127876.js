(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[5848],{31040:function(t,e){var o,n,r="object"==typeof r?r:{};r.Spread=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){var n,r;if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(n=Object.create(null),o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s="./all.entry.js")}({"./all.entry.js":function(t,e,o){(r=r||{}).Spread=r.Spread||{},r.Spread=o("./node_modules_local/@grapecity/js-sheets-common/index.js"),r.Spread.CalcEngine=o("./node_modules_local/@grapecity/js-calc/index.js"),r.Spread.CalcEngine.BasicFunctions=o("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),r.Spread.CalcEngine.AdvancedFunctions=o("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),r.Spread.Sheets=o("./dist/core/core.entry.js"),r.Spread.Sheets.Bindings=o("./dist/plugins/data/data.entry.js"),r.Spread.Sheets.Outlines=o("./dist/plugins/group/group.entry.js"),r.Spread.Sheets.CalcEngine=o("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),r.Spread.Sheets.ConditionalFormatting=o("./dist/plugins/conditional/conditional.entry.js"),r.Spread.Sheets.DataValidation=o("./dist/plugins/validation/datavalidation.entry.js"),r.Spread.Sheets.Search=o("./dist/plugins/search/search.entry.js"),r.Spread.Sheets.Touch=o("./dist/plugins/touch/touch.entry.js"),r.Spread.Sheets.FloatingObjects=o("./dist/plugins/floatingObject/floatingobject.entry.js"),r.Spread.Sheets.Sparklines=o("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),r.Spread.Sheets.Comments=o("./dist/plugins/comment/comment.entry.js"),r.Spread.Sheets.CellState=o("./dist/plugins/cellState/cellstate.entry.js"),r.Spread.Sheets.CellTypes=o("./dist/plugins/celltype/celltypes.entry.js"),r.Spread.Sheets.Filter=o("./dist/plugins/filter/filter.entry.js"),r.Spread.Sheets.Tables=o("./dist/plugins/table/table.entry.js"),r.Spread.Sheets.Slicers=o("./dist/plugins/slicer/slicer.entry.js"),r.Spread.Sheets.Fill=o("./dist/plugins/fill/fill.entry.js"),r.Spread.Sheets.ContextMenu=o("./dist/plugins/contextMenu/context-menu.entry.js"),r.Spread.Sheets.FormulaTextBox=o("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),r.Spread.Sheets.OutlineColumn=o("./dist/plugins/outlineColumn/outlineColumn.entry.js"),r.Spread.Sheets.DragMerge=o("./dist/plugins/dragMerge/dragMerge.entry.js"),r.Spread.Sheets.StatusBar=o("./dist/plugins/statusBar/statusBar.entry.js"),r.Spread.Sheets.AutoMerge=o("./dist/plugins/autoMerge/autoMerge.js"),r.Spread.Sheets.Hyperlink=o("./dist/plugins/hyperlink/hyperlink.js"),t.exports=r.Spread},"./dist/core/celltype/basecelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K;function Q(t){var e=t.isPrinting,o=t.printZoomFactor;return e&&typeof o===E&&1!==o}function $(t){var e=Y[t.charCodeAt(0)];return e?String.fromCharCode(e):t}function tt(t,e,o){return g(t.x)||(t.x+=e.width),t.width=t.width-e.width-o.width,t}function et(t,e,o,n){var r,a=o.foreColor;a=i.Im._ob(e,a),n=g(o.opacity)?n:o.opacity,g(n)||((r=p.ec(a)).a=n,a=p.bc(r)),t.fillStyle!==a&&(t.fillStyle=a||"#000000")}function ot(t,e,o,n){var r,i,a=t.conditionalFormats;if(a)return r=t.getValue(e,o,n),i=a.oRa(t,e,o,r).iconSet,a.bp(e,o,n)&&i}function nt(t,e,o){var n,r,i=0;for(n=0;n<t.length;n++)void 0,r=t[n].style&&t[n].style.font?t[n].style.font:e,i=Math.max(y(r,P,v(t[n].text))/o,i),(t[n].style&&1===t[n].style.vertAlign||2===t[n].style.vertAlign)&&(i=Math.max(y(r,P,v(t[n].text))/o+2*a.To.No(r,W).fontSize*.218,i));return i}function rt(t,e,o,n,r){var s,l,u,c,f,h=i.Vn.bm();if(!h)return 0;for(s=0,l=0;l<t.length;l++)u=void 0,u=t[l].style&&t[l].style.font?t[l].style.font:e,t[l].style&&t[l].style.vertAlign&&(u=a.To.No(u,W).font),b(h,u),"",c=l===t.length-1&&r?i.Vn.Rvb(t[l].text):t[l].text,f=0,n?f=y(u)*c.length/o:g(t[l].text)||(f=S(h,u,t[l].text)/o),s+=f;return s}function it(t,e,o,n,r,i,s,l,u){var c,f,h,p=s.backColor,d=s.backgroundImage,g=s.textOrientation,m=s.isVerticalText,y=s.textIndent&&0!==s.textIndent,C=s.backgroundImageLayout,v=u.row,b=u.col,w=u.sheet&&u.sheet.getSpan(v,b),T=s&&(s.borderLeft||s.borderTop||s.borderRight||s.borderBottom),S=0,x=e;t.save(),g&&0!==g&&T&&l&&!w&&!m&&!y?(c=H(g*Math.PI/180),f=V(c),S=L(r/f),g>-90&&g<0&&(x=e-S),g>0&&g<90&&(x=e+S),h=function(){t.beginPath(),t.moveTo(x,o),t.lineTo(x+n,o),t.lineTo(e+n,o+r),t.lineTo(e,o+r),t.fill()}):h=function(){t.fillRect(e,o,n,r)},(p||d)&&(p&&a.To.setFillStyle(t,p,Math.min(x,e),o,n+S,r,h),Z.ap(t,e,o,n,r,d,C,i)),t.restore()}function at(t){return parseInt(D*t.zoom(),10)}function st(t,e,o,n){var r=t.cellPadding,i=0,a=t.labelOptions;return o&&(r=a?a.margin:"0"),r&&(i=parseInt(function(t){var e,o,n,r,i=["0","0","0","0"];return typeof t===F&&(e=t.split(" ",4),o=e.length,n=void 0,r=void 0,1===o?(n=e[0],i=[n,n,n,n]):2===o?(n=e[0],r=e[1],i=[n,r,n,r]):3===o?(r=e[1],i=[e[0],r,e[2],r]):4===o&&(i=[e[0],e[1],e[2],e[3]])),i}(r)[e],10),i=typeof i===E&&i>0?i:0),n===P?i:i*n}function lt(t,e,o,n){var i,a,s,l,u=n&&n.sheet;u&&o&&(i=n.canvasOffset||u.mm.bG(),a=u.Dr(),(s=e.backColor||"white").stops&&(s=(l=s.stops)[0]&&l[0].color),s.backgroundColor&&(s=s.backgroundColor),r.GC$(t).width(o.width).height(o.height).css({top:i.top+a.y+o.y-2,left:i.left+a.x+o.x-2,"background-color":s}))}function ut(t,e){var o,n=st(t,0),r=st(t,2),i=st(t,0,!0),a=st(t,2,!0);if(st(t,3,!0)+st(t,1,!0)>=e.width)return!1;if((o=t.labelOptions.alignment)===P&&(o=t.labelOptions.alignment=0),0===o||1===o||2===o){if(n>0&&i+a<n)return!0}else if((3===o||4===o||5===o)&&n<e.height&&r>0&&i+a<r)return!0;return!1}function ct(t){var e="left";return 1===t||4===t?e="center":2!==t&&5!==t||(e="right"),e}function ft(t,e,o,n){var r=new i.Point(t.x,t.y),a=parseInt(o.fontSize,10),s=st(e,0),l=st(e,2),u=st(e,3,!0),c=st(e,1,!0),f=t.width,h=t.height,p=a>8?1:2,d=n-(n/2-a/2+(a>8?Math.floor((a-8)/5+2):1)-1)+st(e,0,!0),g=d+1,m=s+l>h?s+d:h-l+d-1;switch(e.labelOptions.alignment){case 0:r.x+=u+p+1,r.y+=g;break;case 1:r.x+=u+(f-u-c)/2,r.y+=g;break;case 2:r.x+=f-c-2,r.y+=g;break;case 3:r.x+=u+p+1,r.y+=m;break;case 4:r.x+=u+(f-u-c)/2,r.y+=m;break;case 5:r.x+=f-c-2,r.y+=m}return r}function ht(t,e,o){var n,r,i;if(m(e,F))return n=0,q[t.font+e]?n=q[t.font+e]:(n=S(t,t.font,e),q[t.font+e]=n),n;if(o&&e&&e[0]&&e[0].value)return e[0].value.length*y(t.font);for(r=0,i=0;i<e.length;i++)"fillingChar"!==e[i].type&&(n=0,q[t.font+e[i].value]?n=q[t.font+e[i].value]:(n=S(t,t.font,e[i].value),q[t.font+e[i].value]=n),r+=n);return r}function pt(t,e,o,n,r){var i;return i=n?Math.floor(e/r):Math.floor(e/S(t,t.font,o)),Array(i+1).join(o)}function dt(t){var e=t.clone();return e.width--,e.height--,e}function gt(t,e,o,n){var r,i,s;for(r=0;r<t.length;r++)i=void 0,t[r].style=t[r].style||{},i=(s=t[r].style).font?a.To.No(s.font,o).font:e,g(n)||(i=a.To.No(i,n).font),s.font=i}function mt(t,e,o,n,r){var a=o*_(-n)+r*B(-n),s=o*_(-n)+r*B(-n),l=t-a/2,u=e-s/2;return new i.Rect(l,u,a,s)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/domUtil.js"),i=o("./dist/core/util/common.js"),a=o("./dist/core/worksheet/stylehelper.js"),s=o("./dist/core/core.enum.js"),l=o("./dist/core/celltype/celltype.ns.js"),u=o("@grapecity/js-calc"),n.Common.F,c=n.Common.CultureManager,f=n.Common.o,h=n.Common.l,p=n.Common.pc,d=n.Common.j,g=d.Fa,m=d.Ma,y=i.Ul.fp,C=i.Ul.ol,v=i.Ul.uWa,b=i.Ul.lZa,w=i.Ul.hZa,T=i.Ul.K_a,S=i.Ul.pL,x=i.Ul.Fxb,A=i.Ul.lHb,I=r.GC$.extend,R=i.Ul.Ml,M="left",k="right",N="center",O="alphabetic",D=16,F="string",E="number",j=null,P=void 0,L=Math.floor,G=Math.ceil,B=Math.sin,_=Math.cos,V=Math.tan,H=Math.abs,z="General",U=Math.max,W=.7,q={},J="...",function(t){t[t.top=0]="top",t[t.right=1]="right",t[t.bottom=2]="bottom",t[t.left=3]="left"}(X||(X={})),Z=function(){function t(){}return t.Gxb=function(t){var e,o,n=t.split("e")[1];if(n&&n.length>0&&("+"===n[0]?e=!0:"-"===n[0]&&(e=!1),o=n.slice(1)),void 0!==e)return{isAdd:e,length:o}},t.Apb=function(e,o,n){var r=t.Hxb,i=r[o+n];return i||(i=S(e,o,n),r[o+n]=i),i},t.Ixb=function(e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x=r.font;if(n=n-1-3*i,a=r.textIndent&&0!==r.textIndent,s=r.isVerticalText,typeof o===E&&!0!==r.shrinkToFit&&!s&&!a){if(l=o<0,o=H(o),u=l?t.Apb(e,x,"-"):0,c=""+o,f=t.Gxb(c),h=void 0,p=t.Jxb(r._autoFormatter,o),f)return h=(""+f.length).length,h=U(h,2),t.Kxb(e,n,r,h,u,f.isAdd,p);if(d=u,g=t.Apb(e,x,"0"),m=c.split("."),d+=y=g*(""+Math.round(o)).length,C=t.Apb(e,x,"."),v=void 0,y<=n){if(!m[1]||0===m[1].length)return r._autoFormatter;if((d=d+m[1].length*g+C)<=n)return r._autoFormatter;if(o<.001)return h=(""+m[1].length).length,h=U(h,2),t.Kxb(e,n,r,h,u,!1,p);for(b=n-u-y-C,w=Math.floor(b/g),v="0",(w=Math.min(w,m[1].length))>0&&(v+="."),T=0;T<w;T++)v+="0";return v}return S=Math.round(o),h=U(h=(""+(""+S).length).length,2),t.Kxb(e,n,r,h,u,!0,p)}return r._autoFormatter},t.Kxb=function(e,o,n,r,i,a,s){var l,u,c,f=n.font,h=t.Apb(e,f,"0"),p=t.Apb(e,f,"E"),d=t.Apb(e,f,"+"),g=t.Apb(e,f,"-"),m=o-i-r*h-p-(a?d:g)-h,y=m-t.Apb(e,f,".");if(y<=h)return a?"0E+00":m>0?"0E-00":"0";for(l=Math.floor(y/h),l=Math.min(l,s),u="0",c=0;c<l;c++)0===c&&(u+="."),u+="0";return u+(a?"E+00":"E-00")},t.Lxb=function(e,o,n,r,i){var a,s,l,u,c,f,h=r.font;if(n=n-1-3*i,a=r.textIndent||0,s=n,1!==r.hAlign&&a>0&&(s=n-8*a),s<S(e,r.font,o)){for(l=t.Apb(e,h,"#"),u=Math.floor(n/l),c="",f=0;f<u;f++)c+="#";return c}return o},t.ap=function(t,e,o,n,r,i,a,s){var l,u,c,f,h,p,d,g,m,y;if(i&&"none"!==i&&s)try{s.ko(i)?(l=s.lo(i),u=void 0,R.msie&&((u=document.createElement("div")).appendChild(l),document.body.appendChild(u)),c=l.width,f=l.height,R.msie&&(u.removeChild(l),document.body.removeChild(u)),0,0,h=c,p=f,d=n,g=r,m=e,y=o,1===a?(h=n>=c?c:n,p=r>=f?f:r,m=n>c&&c>0?G(e+n/2-c/2):e,y=r>f&&f>0?G(o+r/2-f/2):o,d=h,g=p):2===a?r>0&&f>0&&n/r>c/f?m=e+n/2-(d=c/f*r)/2:n>0&&c>0&&r/n>f/c&&(y=o+r/2-(g=f/c*n)/2):3===a&&(d=h=n>=c?c:n,g=p=r>=f?f:r),t.drawImage(l,0,0,h,p,m,y,d,g)):s.fo(i)}catch(t){}},t.cp=function(t,e,o,n,r){var a,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x,A,R,M,k=0,N=r&&r.sheet,O=o.textIndent,E=o.hAlign,j=o.isVerticalText,P=o.textOrientation,L=o.borderTop||o.borderBottom||o.borderLeft||o.borderRight,G=o.font,V=r.row,z=r.col;if(P&&-90<=P&&P<=90&&(u=H(P*Math.PI/180),s=B(u),l=_(u)),N&&typeof e===F&&e)if(c=[],f=void 0,t&&t.richText)if(h=o.formatter||o._autoFormatter,d=(p=N.getCellType(V,z)).T_a(h,t.text),gt(f=I(!0,[],p.U_a(t,e,d,G,o.foreColor)),G,n),j)if(o.wordWrap){if(g=r.sheetArea,m=N.Sl(V),(C=N.ITa.findSpan(V,z,g))&&C.row>=V&&C.col>=z&&C.rowCount>1)for(v=V+1;v<V+C.rowCount;v++)m+=N.Sl(v);for(b=0,O>0&&(b=8*O),(w=st(o,0))>0&&(m-=w),(T=st(o,2))>0&&(m-=T),m++,c=i.Vn.M_a(e,m-3-b,G,f,j),a=0;a<c.length;a++)k+=nt(c[a].textInfos,G,n)}else k=nt(f,G,n);else{if(o.wordWrap){for(S=e.split(/\r\n|\r|\n/),a=0;a<S.length;a++)(x=[]).push(S[a]),c.push(x);for(c=i.Vn.O_a(c,i.Vn.P_a(f)),a=0;a<c.length;a++)k=Math.max(k,rt(c[a],G,n,j,!0))}else k=rt(f,G,n);1!==E&&O>0&&(k+=8*O/n),ot(N,V,z,r.sheetArea)&&(k+=at(N))}else if(c=e.split(/\r\n|\r|\n/),A=o.font,R=y(A)/n,j)if(o.wordWrap)for(a=0;a<c.length;a++)k+=R;else k=R;else{if(o.wordWrap){if(P)return M=N.Sl(V),i.Vn.mHb(V,z,s,l,e,A,M);for(a=0;a<c.length;a++)k=Math.max(k,i.Vn.Xn(c[a],A,!0)/n)}else k=P?L?(R+4)/s:l*(N.dp(e,A)/n)+R*s:N.dp(e,A)/n;1!==E&&O>0&&(k+=8*O/n),ot(N,V,z,r.sheetArea)&&(k+=D)}return k},t.ep=function(t,e,o,n,r){var a,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,A,R,M,k,N,O,D,E,j,P,L=0,G=r&&r.sheet,V=o.font,z=o.isVerticalText,U=o.textIndent,W=o.vAlign,q=o.textOrientation,J=r.row,X=r.col;if(q&&-90<=q&&q<=90&&(w=H(q*Math.PI/180),v=B(w),b=_(w)),G&&typeof e===F&&e)if(T=[],S=void 0,t&&t.richText)if(A=o.formatter||o._autoFormatter,M=(R=G.getCellType(J,X)).T_a(A,t.text),gt(S=I(!0,[],R.U_a(t,e,M,V,o.foreColor)),V,n),z){if(o.wordWrap){for(k=e.split(/\r\n|\r|\n/),a=0;a<k.length;a++)(N=[]).push(k[a]),T.push(N);for(T=i.Vn.O_a(T,i.Vn.P_a(S)),a=0;a<T.length;a++)L=Math.max(L,rt(T[a],V,n,z,!0))}else L=rt(S,V,n,z);1!==W&&U>0&&(L+=8*U/n)}else if(o.wordWrap){if(s=r.sheetArea,l=G.Tl(X),(c=G.ITa.findSpan(J,X,s))&&c.row>=J&&c.col>=X&&c.colCount>1)for(f=X+1;f<X+c.colCount;f++)l+=G.Tl(f);for(p=0,U>0&&(p=8*U),d=st(o,1),(g=st(o,3))>0&&(l-=g),d>0&&(l-=d),l++,T=i.Vn.M_a(e,l-3-p,V,S),a=0;a<T.length;a++)L+=nt(T[a].textInfos,V,n)}else L=nt(S,V,n);else if(O=o.font,D=y(O)/n,z){if(o.wordWrap)for(T=e.split(/\r\n|\r|\n/),a=0;a<T.length;a++)E=T[a].length*D,L=Math.max(L,E);else L=e.length*D;1!==W&&U>0&&(L+=8*U/n)}else if(o.wordWrap){if(s=r.sheetArea,l=G.Tl(X),u=G.Sl(J),(c=G.ITa.findSpan(J,X,s))&&c.row>=J&&c.col>=X&&c.colCount>1){for(f=X+1;f<X+c.colCount;f++)l+=G.Tl(f);for(h=J+1;h<J+c.colCount;h++)u+=G.Sl(h)}if(p=0,U>0&&(p=8*U),d=st(o,1),(g=st(o,3))>0&&(l-=g),d>0&&(l-=d),(m=st(o,0))>0&&(u-=m),(C=st(o,2))>0&&(u-=C),1===s&&(!!((j=G.rowFilter&&G.rowFilter())&&j.Dl(J,X,s)&&j.filterButtonVisible(X))&&(l-=G.oK(new i.Rect(0,0,l,u),s).width)),q)return P=(u-D*b)/v,T=i.Vn.Wn(e,P,O),v*(G.dp(T[0],O)/n)+D*b;L=(T=x(t)?[e]:i.Vn.Wn(e,l-3-p,O)).length*D}else q?L=v*(G.dp(e,O)/n)+D*b:L=D;return L},t.gp=function(t,e,o,n,r,i,a,s,l,u,c){var f;1===l?(t.beginPath(),(f=t.createLinearGradient(e,o+1,e,o+r-2)).addColorStop(0,s.borderLeftColor),f.addColorStop(1,s.borderRightColor),t.strokeStyle!==f&&(t.strokeStyle=f),i.borderLeft||(t.moveTo(e+.5,o),t.lineTo(e+.5,o+r)),i.borderRight||(t.moveTo(e+n-.5,o),t.lineTo(e+n-.5,o+r)),u&&!i.borderTop&&(t.moveTo(e,o+.5),t.lineTo(e+n,o+.5)),t.stroke(),s.borderBottomWidth&&!i.borderBottom&&(t.beginPath(),t.strokeStyle!==s.borderBottomColor&&(t.strokeStyle=s.borderBottomColor),t.moveTo(e+1,o+r-.5),t.lineTo(e+n,o+r-.5),t.stroke())):(t.beginPath(),(f=t.createLinearGradient(e,o,e+n-2,o)).addColorStop(0,s.borderTopColor),f.addColorStop(1,s.borderBottomColor),t.strokeStyle!==f&&(t.strokeStyle=f),i.borderTop||(t.moveTo(e,o+.5),t.lineTo(e+n,o+.5)),i.borderBottom||(t.moveTo(e,o+r-.5),t.lineTo(e+n,o+r-.5)),c&&!i.borderLeft&&(t.moveTo(e+.5,o),t.lineTo(e+.5,o+r)),t.stroke(),s.borderRightWidth&&!i.borderRight&&(t.beginPath(),t.strokeStyle!==s.borderRightColor&&(t.strokeStyle=s.borderRightColor),t.moveTo(e+n-.5,o+1),t.lineTo(e+n-.5,o+r),t.stroke()))},t.hp=function(t,e){var o;o=2===e?"active":4===e?"inactive":0===e?"disabled":"auto",r.GC$(t).css("ime-mode",o)},t.bDc=function(t,e,o,n,r,i,a){var s,l,u,c;return!!(e&&"SparklineExValue"===e.typeName&&(s=a.sheet,l=s&&s.parent,l&&(u=l.getSparklineEx(e.name))))&&(c={zoomFactor:Q(a)?a.printZoomFactor:s.zoom(),sheet:s,rowIndex:a.row,columnIndex:a.col},u.paint(t,e.value,o,n,r,i,c),!0)},t.Hxb={},t.Jxb=function(t,e){var o,n,r,i,a;return t&&t.Ud&&((o=t.Ud(e).format(e))&&o[1]&&"decimalSeparator"===o[1].type)?(n=o[2])&&n.type===E?(r=n.value,a=(i=o[3])&&"exponent"===i.type&&i.value&&i.value.indexOf("E")>-1,!g(r)&&a?r.length:5):0:5},t.u5=st,t}(),e.Context=Z,Y={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092},K=function(){function t(){this.allowOverflow=!1,this.typeName="0"}return t.prototype.uxb=function(e,o,n,r){var i={ctx:e,options:{rect:o,context:n,value:r}};return t.ao(n.sheet,"paintCellPadding",i),i.options.rect},t.prototype.Mfc=function(e,o,n){var r={context:e,options:{dom:o,cellRect:n,contentRect:n.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return t.ao(e.sheet,"onCreateCellEditor",r),r.options.dom},t.prototype.TBb=function(e,o,n){var r={ctx:null,options:{rect:o.clone(),context:e,value:null,style:n}};return t.ao(e.sheet,"getCellButtonRect",r),r.options.rect},t.prototype.Nfc=function(e,o,n,r){var a={context:e,options:{dom:o,cellRect:n,cellStyle:r,contentRect:n.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return t.ao(e.sheet,"onActivateCellEditor",a),a},t.prototype.VBb=function(e,o,n,r){var a={context:e,contentContainer:o,editorBounds:n,cellStyle:r,contentRect:n.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)};return t.ao(e.sheet,"onUpdateContainer",a),a},t.prototype.Ofc=function(e,o,n){var r={context:e,options:{dom:o,cellRect:n,contentRect:n.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return t.ao(e.sheet,"onDeactivateCellEditor",r),r.options.dom},t.prototype.XBb=function(t,e,o){this.deactivateEditor(t,e),this.Ofc(e,t,o)},t.prototype.i5=function(t,e,o,n){var r,i,s,l,u,c,f,h,p,d,g=o.labelOptions;if(g&&(r=n.sheet,i=o.watermark)){if(s=g.visibility,l=r.getText(n.row,n.col,n.sheetArea),1===s||(2===s||s===P)&&""===l)return;u=r.zoom(),void 0,f=(c=g.font)?a.To.No(c,u):a.To.No(o.font,1),h=y(f.font),p=function(t,e){var o=st(e,0),n=st(e,3,!0),r=st(e,2,!0),i=t.clone(),a=e.labelOptions.alignment;return 0===a||1===a||2===a?o<t.height&&(i.height=o-r+1):3!==a&&4!==a&&5!==a||(i.height=t.height-r),i.x+=n,i.width-=n+st(e,1,!0),i}(e,o),d=void 0,ut(o,e)&&(d=ft(e,o,f,h)),d&&(t.save(),t.textAlign=ct(g.alignment),t.textBaseline="alphabetic",b(t,f.font),t.fillStyle=g.foreColor||o.foreColor||"grey",t.rect(p.x,p.y,p.width,p.height),t.clip(),t.beginPath(),t.fillText(i,d.x,d.y),t.restore())}},t.prototype.f5=function(t,e,o){var n=t.clone(),r=st(e,0,!1,o),i=st(e,1,!1,o),a=st(e,2,!1,o),s=st(e,3,!1,o);return r>0&&(n.y+=r,n.height-=r),a>0&&(n.height-=a),s>0&&(n.x+=s,n.width-=s),i>0&&(n.width-=i),i+s>=t.width&&(n.width=0),r+a>=t.height&&(n.height=0),n},t.prototype.Ama=function(e,o,n,r){var i,a=Q(r)?r.printZoomFactor:r.sheet.zoom();return i={ctx:e,options:{rect:o=this.f5(o,n,a),context:r}},t.ao(r.sheet,"getCellPaddingRect",i),i.options.rect},t.prototype.e5=function(t,e,o,n){var a,s,l,u,c,f,h,p,d,g,m,C,v=o.labelOptions;v&&(s=(a=n.sheet).getText(n.row,n.col,n.sheetArea),l=o.watermark,1!==(u=v.visibility)&&l&&(c=v.font||o.font||a.yl.Bl(),1!==a.zoom()&&(c=a.yl.Cl(c)),f=y(c),ut(o,e)&&(h=function(t,e){var o=st(e,3,!0),n=st(e,1,!0),r=st(e,0,!0),i=st(e,2,!0),a=t.clone(),s=e.labelOptions.alignment;return a.x=o+1,a.width-=o+n,0===s||1===s||2===s?(a.y=r,a.height=st(e,0)-r-i):3!==s&&4!==s&&5!==s||(a.y=t.height-st(e,2)+r,a.height=st(e,2)-r-i),2!==s&&5!==s||(a.width-=2),a}(e,o)),h&&((p=r.GC$(i.Ul.Nl("span"))).text(l),d=(2===u||u===P)&&""===s,g=h.height-f,m=h.y+(d&&g>0?g:0),p.css({display:"block",position:"absolute",left:h.x,top:m,width:h.width,height:h.height,font:w(c),color:v.foreColor||o.foreColor||"grey",textAlign:ct(v.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),r.GC$(t).append(p),d&&(C=setInterval((function(){m--,p.css("top",m),m<=h.y&&clearInterval(C)}),20)))))},t.prototype.a5=function(t){var e,o,n=i.Ul.Nl("div");return n.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(e=i.Ul.Nl("div")).style.cssText="position: absolute; outline: none; border: none",r.GC$(n).append(r.GC$(e)),(o=this.createEditorElement(t,n))&&r.GC$(e).append(r.GC$(o)),this.Mfc(t,n,t.sheet.getCellRect(t.row,t.col)),n},t.prototype.d5=function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d;t&&t.firstChild&&(i=this,lt(t,e,a=dt(o),n),l=(s=i.Nfc(n,t,a,e)).options.contentRect,u=s.options.cellRect,c=s.options.leftExternalRect,f=s.options.rightExternalRect,i.e5&&i.e5(t,l,e,n),h=n.sheet.zoom(),p=tt(l=i.f5?i.f5(l,e,h):l,c,f),d=t.firstChild,r.GC$(d).css({left:(+r.GC$(d).css("left").replace("px","")||0)+st(e,3,!1,h),top:(+r.GC$(d).css("top").replace("px","")||0)+st(e,0,!1,h)}),i.activateEditor(t.firstChild.firstChild,e,p,n,u,c,f))},t.prototype.updateEditorContainer=function(t,e,o,n,i,a,s){var l,u,c,f,h,p;t&&e&&((u=(l=t.parentNode)?l.parentNode:P)&&i&&(c=r.GC$(u),f=i.width,h=i.height,f>0&&(c.width(f),p=u.lastChild,o&&"gcEditorLabel"===p.getAttribute("gcUIElement")&&r.GC$(p).width(f-st(o,3,!0)-st(o,1,!0)-2)),h>0&&c.height(h),g(i.x)||c.css("left",i.x+"px"),g(i.y)||c.css("top",i.y+"px")))},t.prototype.g5=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g=this,m=t.firstChild,y=dt(o);lt(t,e,y,n),i=(r=g.VBb(n,m,y,e)).editorBounds,a=r.contentRect,s=r.leftExternalRect,l=r.rightExternalRect,u=m.firstChild,c=tt(a=g.f5?g.f5(a,e,n.sheet.zoom()):a,s,l),f=g.updateEditor(u,e,c,n,i,s,l),h={width:s.width,height:s.height},p={width:l.width,height:l.height},d={width:!isNaN(f&&f.width)&&f.width+h.width+p.width>i.width?f.width+h.width+p.width:i.width,height:!isNaN(f&&f.height)&&f.height+h.height+p.height>i.height?f.height+h.height+p.height:i.height},g.updateEditorContainer(u,f,e,n,d,h,p)},t.prototype.h5=function(t,e,o,n,r){return this.getCellAndPaddingHitInfo(t,e,o,n,r)},t.prototype.X4=function(t,e,o,n,r){var i=function(t,e){var o={context:t,value:0,cellStyle:e};return K.ao(t.sheet,"getCellButtonAutoWidth",o),o.value}(r,o)+function(t){var e={context:t,value:0};return K.ao(t.sheet,"getOutlineColumnOffset",e),e.value}(r)+function(t,e){var o={context:t,value:0,cellStyle:e};return K.ao(t.sheet,"getSpecialIconsAutoWidth",o),o.value}(r,o),a=this.getAutoFitWidth(t,e,o,n,r);return a>0&&(i+=a+st(o,3,!1)+st(o,1,!1)),i},t.prototype.Y4=function(t,e,o,n,r){var i=0,a=this.getAutoFitHeight(t,e,o,n,r);return a>0&&(i+=a+st(o,0,!1)+st(o,2,!1)),Math.max(function(t,e){var o={context:t,value:0,cellStyle:e};return K.ao(t.sheet,"getCellButtonAutoHeight",o),o.value}(r,o),i)},t.prototype.paintValue=function(t,e,o,n,r,a,s,l){var u,c,f,h={};l.quotePrefix=s.quotePrefix,(u=this.format(T(e),s.formatter||s._autoFormatter,h,l))&&(c=new i.Rect(o,n,r,a),this.adjustRectForIconSet(s.hAlign,l.sheet,l.row,l.col,l.sheetArea,c,h.content&&this.hasInfilling(h.content)),o=c.x,r=c.width,f=this.Pfc(t,u,s,l,o,n,r,a),this.paintText(t,e,o,n,r,a,s,l,u,h,P,f.externals))},t.prototype.S_a=function(t,e,o){var n=0;return t>0&&(n=8*t),e&&e.XQa(o)&&(n=0),n},t.prototype.T_a=function(t,e){return!!(!t||m(t,F)&&t===z||t&&t.formatString&&t.formatString()===z)||!(e&&(!isNaN(e)||"TRUE"===e.toUpperCase()||"FALSE"===e.toUpperCase())&&"@"!==t)},t.prototype.Qfc=function(t){var e,o=0;for(e=0;e<t.length;e++)o+=t[e].width;return o},t.prototype.Rfc=function(t){var e,o=0;for(e=0;e<t.length;e++)o+=t[e].height;return o},t.prototype.Sfc=function(e,o,n,r,i){var a={ctx:e,options:{rect:n,context:o,value:r,style:i}};t.ao(o.sheet,"beforePaintLabel",a)},t.prototype.Pfc=function(e,o,n,r,a,s,l,u){var c={ctx:e,text:o,rect:new i.Rect(a,s,l,u),style:n,context:r,externals:{left:[],right:[]}};return t.ao(r.sheet,"beforePaintText",c),c},t.prototype.Tfc=function(e,o,n,r,a,s,l,u,c){var f={ctx:e,style:o,context:n,textRect:new i.Rect(r,a,s,l),availRect:u};return t.ao(n.sheet,c,f),f},t.prototype.Ufc=function(t,e,o,n,r,i,a,s){return this.Tfc(t,e,o,n,r,i,a,s,"beforeFillTextArea")},t.prototype.Vfc=function(t,e,o,n,r,i,a,s){return this.Tfc(t,e,o,n,r,i,a,s,"afterFillTextArea")},t.prototype.paintText=function(t,e,o,n,r,i,a,s,l,u,c,f){var h,p,d,m=this;t.save(),t.beginPath(),h=a.textOrientation,p=a.textIndent&&0!==a.textIndent,d=a.isVerticalText,e&&e.richText&&e.richText.length>0||d?m.Fpb(t,e,o,n,r,i,a,s,l,u,c,f):0!==h&&!g(h)&&-90<=h&&h<=90&&!p&&!d?m.nHb(t,e,o,n,r,i,a,s,l,u,c,f):m.N$a(t,e,o,n,r,i,a,s,l,u,c,f),t.restore()},t.prototype.oHb=function(t,e,o,n,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,C,v,b,w,T=e.sheet,S=e.row,x=e.col,A=r.vAlign,I=e.sheetArea;for(c=0;c<o.length;c++)if(f=o[c].text,h=n[c].lineHeight,p=1===A?0:s,d=this.pHb(t,"0"),g="",(m=i)-1-2-p<f.length*h){if(m<3*d)u.push(0),g=J;else if(y=L((m-1-2-3*d-(1===A?0:s))/h),C=0,0===A){for(v=0;v<y;v++)g+=f[v];b=g.length,3*d+((g+=J).length-3)*h+s>m-1-2?(g=g.substring(0,g.length-4)+J,u.push(g.split(J)[0].length)):u.push(b)}else if(1===A){for(w=0;w<G(y/2);w++)g+=f.charAt(w),C=w;for(b=g.length,g+=J,w=G(f.length-y/2);w<f.length;w++)g+=f.charAt(w);3*d+(g.length-3)*h+s>m-1-2?(g=g.replace(f[C],""),u.push(g.split(J)[0].length)):u.push(b),l[c].y=a+(i-(3*d+(g.length-3)*h))/2}else{for(u.push(0),v=f.length-1;v>=f.length-y;v--)g=f[v]+g;3*d+((g=J+g).length-3)*h+s>m-1-2&&(g=g.replace(f[f.length-y],"")),l[c].y=a+i-s-(3*d+(g.length-3)*h)-2}o[c].textInfos[0].text=g,T.ITa.qHb(S,x,f,I)}else T.ITa.qHb(S,x,null,I)},t.prototype.Fpb=function(t,e,o,n,r,a,s,l,u,c,f,h){var p,d,g,m,y,b,w,T,S,x,A,R,M,O,D,F,E,P,L,G,B,_,V=this,H=new i.Rect(o,n,r,a),z=V.S_a(s.textIndent,l.sheet.outlineColumn,l.col),U=s.hAlign;if(3===U&&(U=C(U,e,s.formatter)),d=!!(p=s.isVerticalText)&&v(u),g=s.font,m=s.formatter||s._autoFormatter,y=V.T_a(m,e.text),b=I(!0,[],V.U_a(e,u,y,g,s.foreColor)),et(t,l.sheet,s,f),e&&e.richText&&e.richText.length>0&&(w=l.sheet?l.sheet.zoom():1,T=l.printZoomFactor,T=Q(l)?T:j,V.V_a(b,g,w,T)),S=0,x=0,h&&(S=V.Qfc(h.left),x=V.Qfc(h.right)),A=S+x,R={left:S,right:x},!s.wordWrap&&s.shrinkToFit&&V.W_a(b,r-A,a,s,g,1,p),M=V.X_a(t,u,s.font,p?a:r-A,z,p?s.vAlign:s.hAlign,s.wordWrap,p,b),O=V.Y_a(M,s,U,f),D=V.Z_a(t,s,o,n,r,a,s.wordWrap,l.cellOverflowLayout,U,z,p,M[0].textLength,O[0].lineHeight),F=!1,s.showEllipsis&&p&&!e.richText&&(F=!0),E=V.$_a(o,n,r,a,U,s.vAlign,z,p,d,M,O,R,F),P=M.length,L=[],F&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===M.length&&M[0].text)&&this.oHb(t,l,M,O,s,a,n,z,E,L),1===P&&c&&!y)V.__a(t,l.sheet,u,c,E[0].x,E[0].y,r,a,U,s,D.width,D.height,z,p,M[0].textLength,l,R,H);else{for(G=V.Wfc(M),B=E[0].x,t.textAlign===N?B-=G/2:t.textAlign===k&&(B-=G),V.Ufc(t,s,l,B,E[0].y,G,0,H),_=0;_<P;_++)V.a0a(t,l.sheet,E[_].x,E[_].y,O[_],U,M[_],L[_]);V.Ufc(t,s,l,B,E[0].x,G,0,H)}},t.prototype.Wfc=function(t){var e,o=t[0].textLength;for(e=0;e<t.length;e++)o=U(o,t[e].textLength);return o},t.prototype.pHb=function(t,e){var o=0,n=t.font+e;return q[n]?o=q[n]:(o=S(t,t.font,e),q[n]=o),o},t.prototype.rHb=function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g,m=t.sheetArea,y=o,C=this.pHb(n,y),v=t.sheet,b=t.row,w=t.col,T=r,S=0,x=this.pHb(n,"0");if(S=this.pHb(n,J),C>T-1-2-(1===i?0:a)){if(s="",2===i)for(l=y.length-1;l>=0;l--){if(S>T-1-2-a){u=s.length,s=J+s.substring(1,u);break}s=(c=y.charAt(l))+s,S+=this.pHb(n,c)}else if(1===i){for(f=G((T-S)/x),l=0;l<f/2;l++)s+=c=y.charAt(l);for(s+=J,l=L(y.length-f/2);l<y.length;l++)s+=c=y.charAt(l);for(h=this.pHb(n,s);h>T-1-2&&s!==J;)d=(p=s.split(J))[0],g=p[1],s=d.length>g.length?d.substring(0,d.length-1)+J+g:d+J+g.substring(1,g.length),h=this.pHb(n,s)}else for(l=0;l<y.length;l++){if(S>T-1-2-a){u=s.length,s=s.substring(0,u-1)+J;break}s+=c=y.charAt(l),S+=this.pHb(n,c)}e.content=[{value:s,type:"text"}],v.ITa.qHb(b,w,y,m)}},t.prototype.N$a=function(t,e,o,n,r,l,u,c,f,h,p,d){var m,w,T,x,A,I,R,M,D,F,E,j,P,G,B,_,V,H,z,W,q,J,X,Z,Y,K,$,tt,ot,nt,rt,it=this,at=0,lt=u.textIndent,ut=u.wordWrap,ct=u.hAlign,ft=u.vAlign,ht=u.shrinkToFit,pt=u.textDecoration,dt="left",gt=2,mt=2,yt=u.font,Ct=0,vt=[],bt=0,wt=c.sheet,Tt=new i.Rect(o,n,r,l);if(g(c.fontInfo)&&(c.fontInfo=a.To.No(u.font,wt.zoom()),Q(c)&&(c.fontInfo=a.To.No(c.fontInfo.font,c.printZoomFactor))),m=parseInt(c.fontInfo.fontSize,10),g(c.lineHeight)&&(c.lineHeight=y(a.To.No(u.font,wt.zoom()).font,!1,v(f))),w=c.lineHeight,et(t,wt,u,p),lt>0&&(at=8*lt),wt.outlineColumn&&wt.outlineColumn.XQa(c.col)&&(at=0),3===ct&&(ct=C(ct,e,u.formatter)),b(t,yt),T=0,x=0,d&&(T=it.Qfc(d.left),x=it.Qfc(d.right)),A=T+x,I={left:T,right:x},!ut&&ht)for(R=0,M={value:!1},D=0;D<3&&!1===M.value&&(F=t.measureText(f).width,(R=U(0,r-4-(1===ct?0:at)-A))<F);D++)yt=a.To.No(yt,R/F,M,!0).font,b(t,yt);if((E=wt.parent&&wt.parent.options.numbersFitMode===s.NumbersFitMode.overflow||!1)||(E=h&&h.content?!(!h.content||1!==h.content.length||"text"!==h.content[0].type):"string"==typeof e&&e===f),!ut&&!ht&&u.showEllipsis&&E&&this.rHb(c,h,f,t,r,ct,at),gt+=at+T,1===ct?(gt=(r+T-x)/2,dt=N):2===ct&&(gt=r-x-1-2,gt-=at,dt=k),t.textAlign!==dt&&(t.textAlign=dt),j=0,ut&&(j=r-A-3-at,j-=1,(bt=(vt=i.Vn.Wn(f,j,yt,!1,t)).length)>1&&0!==ft&&(Ct=(bt-1)*w)),mt+=w-(G=w/2-m/2+(P=m>8?L((m-8)/5+2):1)-1),1===ft?mt=(l-Ct)/2+w/2-G:2===ft&&(mt=l-Ct-2-G),t.textBaseline!==O&&(t.textBaseline=O),V={x:(_=(B=c.cellOverflowLayout)&&B.layout)?_.x:o+1,y:_?_.y:n+1,width:_?_.width:r-2,height:_?_.height:l-2},H=_&&_.width>r,z=V.x,W=V.y,q=V.width,J=V.height,ut)if(t.rect(z,W,q,J),t.clip(),t.beginPath(),X=n+mt,bt>1){for(Z=o+gt,t.textAlign===N?Z-=j/2:t.textAlign===k&&(Z-=j),it.Ufc(t,u,c,Z,X,j,w*bt,Tt),D=0;D<bt;D++)t.fillText(vt[D],o+gt,X),pt&&(F=t.measureText(vt[D]).width,it.ip(t,pt,o+gt,X,F,m,P)),X+=w;it.Ufc(t,u,c,Z,X,j,w*bt,Tt)}else it.Oja(t,f,h,o+gt,n+mt,ct,q,at,pt,P,m,c,u,I,Tt,H);else K=(Y=S(t,t.font,f)+A)>q-(o+1-z)||w>J,$=st(u,0),tt=st(u,1),ot=st(u,2),nt=st(u,3),K||(1===ct?B&&(((rt=Y/2)>B.backgroundLeftWidth||rt>B.backgroundRightWidth)&&(K=!0)):(Y+at+$+ot>q||Ct+nt+tt>J)&&(K=!0)),K&&(t.rect(z,W,q,J),t.clip(),t.beginPath()),it.Oja(t,f,h,o+gt,n+mt,ct,q,at,pt,P,m,c,u,I,Tt,H)},t.prototype.nHb=function(t,e,o,n,r,s,l,u,c,f,h,p){var d,g,m,y,v,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,G,z,W,q,J,X,Z,Y,K,Q,$,tt,ot=this,nt=l.wordWrap,rt=l.hAlign,it=l.vAlign,at=l.shrinkToFit,lt=l.textDecoration,ut=2,ct=2,ft=l.font,ht=[],pt=0,dt=parseInt(u.fontInfo.fontSize,10),gt=u.sheet,yt=new i.Rect(o,n,r,s),Ct=u.cellOverflowLayout,vt=Ct&&Ct.layout,bt=l&&(l.borderLeft||l.borderTop||l.borderRight||l.borderBottom)&&!gt.getSpan(u.row,u.col),wt=l.textOrientation,Tt=wt*Math.PI/180,St=H(Tt),xt=_(St),At=B(St),It=V(St),Rt=u.lineHeight,Mt=90===wt||-90===wt;if(bt&&(wt>-90&&wt<0&&(m=!1),wt>0&&wt<90&&(m=!0)),v=(y={x:vt?vt.x:o+1,y:vt?vt.y:n+1,width:vt?vt.width:r-2,height:vt?vt.height:s-2}).x,w=y.y,T=y.width,S=y.height,x=Rt/2*B(St),A=Rt/2*_(St),R=Rt/2-dt/2+(I=dt>8?L((dt-8)/5+2):1)-1,f&&f.content&&f.content.length>0&&!at&&(c=ot.sHb(t,f.content,s-4,ft)),M=gt.dp(c,ft),et(t,gt,l,h),3===rt&&(rt=C(rt,e,l.formatter,wt)),b(t,ft),k=0,N=0,p&&(k=ot.Qfc(p.left),N=ot.Qfc(p.right)),!nt&&at)for(O=0,D={value:!1},F=0;F<3&&!1===D.value&&(O=U(0,(s-4-2*A)/At))<M;F++)ft=a.To.No(ft,O/M,D,!0).font,b(t,ft),dt=parseInt(u.fontInfo.fontSize,10),M=gt.dp(c,ft),x=(Rt=i.Ul.fp(ft))/2*B(St),A=Rt/2*_(St);if(E=0,j=0,nt)for(j=(s-4-2*A)/At,pt=(ht=i.Vn.Wn(c,j,ft,!1,t)).length,M=gt.dp(ht[0],ft),P=0;P<pt;P++)(G=gt.dp(ht[P],ft))>E&&(E=G);switch(s<=(nt?E:M)*At+2*A&&(it=2),d=M/2*xt,g=(nt?E:M)/2*At,""+rt+it){case"00":ut+=d+x+k,ct+=g,Mt||(ct+=A),bt&&(ut=(s-ct)/It*(m?1:-1)+(Rt/2+2)/At);break;case"01":ut+=d+x+k,ct=s/2,bt&&(ut=(s-ct)/It*(m?1:-1)+(Rt/2+2)/At);break;case"02":ut+=d+x+k,ct+=g,Mt||(ct+=A),bt&&(ut=ct/It*(m?1:-1)+(Rt/2+2)/At),ct=s-ct;break;case"10":ut=(r+k-N)/2,ct+=g,Mt||(ct+=A),bt&&(ut+=(m?1:-1)*(s-ct)/It);break;case"11":ut=(r+k-N)/2,ct=s/2,bt&&(ut+=(m?1:-1)*(s-ct)/It);break;case"12":ut=(r+k-N)/2,ct+=g,Mt||(ct+=A),bt&&(ut+=(m?1:-1)*ct/It),ct=s-ct;break;case"20":ut=r-2-d-x-N,ct+=g,Mt||(ct+=A),bt&&(ut=r+(s-ct)/It*(m?1:-1)-(Rt/2+2)/At);break;case"21":ut=r-2-d-x-N,ct=s/2,bt&&(ut=r+(s-ct)/It*(m?1:-1)-(Rt/2+2)/At);break;case"22":ut=r-2-d-x-N,ct+=g,Mt||(ct+=A),bt&&(ut=r+ct/It*(m?1:-1)-(Rt/2+2)/At),ct=s-ct}if(nt)if(z=o+ut,W=Rt/At,q=void 0,pt>1){for(1===rt&&(z-=pt%2!=0?W*(pt-1)/2:W*(pt/2)-.5*W),X=(J=mt(z,n+ct,M,Tt,Rt)).width+W*(pt-1),Z=J.height,Y=2===rt?J.x-W*(pt-1):J.x+W*(pt-1),K=J.y,ot.Ufc(t,l,u,Y,K,X,Z,yt),F=0;F<pt;F++)q=F,(l.textOrientation>0&&2===rt||l.textOrientation<0&&(0===rt||1===rt))&&(q=pt-F-1),ot.tHb(t,Tt,ht[q],z,n+ct,lt,dt,I,R),z=2===rt?z-W:z+W;ot.Ufc(t,l,u,Y,K,X,Z,yt)}else ot.Xfc(t,c,o,n,ut,ct,u,l,M,Tt,lt,dt,I,Rt,R,yt);else Q=M*At+dt*At+2,$=st(l,0),tt=st(l,2),(Q>S-(n+1-w)||Rt>S||Q+$+tt>S)&&(t.rect(v,w,T,S),t.clip()),ot.Xfc(t,c,o,n,ut,ct,u,l,M,Tt,lt,dt,I,Rt,R,yt)},t.prototype.Xfc=function(t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,g){var m=this,y=mt(o,n,l,u,p),C=y.width,v=y.height,b=y.x,w=y.y;m.Ufc(t,s,a,b,w,C,v,g),m.tHb(t,u,e,o+r,n+i,c,f,h,d),m.Ufc(t,s,a,b,w,C,v,g)},t.prototype.V_a=function(t,e,o,n){gt(t,e,o,n)},t.prototype.W_a=function(t,e,o,n,r,i,s){var l,u,c,f=0,h={value:!1};for(l=0;l<3&&!1===h.value&&(u=rt(t,r,i,s),f=U(0,(s?o:e)-4),(s?n.vAlign:1!==n.hAlign&&n.textIndent)&&(f=U(0,f-8*n.textIndent)),f<u);l++)for(c=0;c<t.length;c++)t[c].style.font=a.To.No(t[c].style.font,f/u,h,!0).font},t.prototype.U_a=function(t,e,o,n,r){var i=t.richText;return!g(i)&&o||(i=[{style:{font:n,foreColor:r},text:e}]),i},t.prototype.Z_a=function(t,e,o,n,r,i,a,s,l,u,c,f,h){var p=s&&s.layout,d={x:p?p.x:o+1,y:p?p.y:n+1,width:p?p.width:r-2,height:p?p.height:i-2},g=d.x,m=d.y,y=d.width,C=d.height;return a?(t.rect(g,m,y,C),t.clip(),t.beginPath()):this.b0a(e,l,e.vAlign,o,n,C,y,g,m,f,h,u,c,s)&&(t.rect(g,m,y,C),t.clip(),t.beginPath()),d},t.prototype.b0a=function(t,e,o,n,r,i,a,s,l,u,c,f,h,p){var d,g,m=st(t,0),y=st(t,1),C=st(t,2),v=st(t,3);return h?(!(d=u>i-(r+1-l)||c>a)&&1!==o&&u+f+m+C>i||c+v+y>a)&&(d=!0):(d=u>a-(n+1-s)||c>i)||(1===e?p&&(((g=u/2)>p.backgroundLeftWidth||g>p.backgroundRightWidth)&&(d=!0)):(u+f+v+y>a||c+m+C>i)&&(d=!0)),d},t.prototype.X_a=function(t,e,o,n,r,s,l,u,c){var f,h,p,d,g;if(1!==s?n=n-3-r:n-=3,l)return i.Vn.M_a(e,n,o,c,u,t);for(f=0,h=0;h<c.length;h++)p=c[h].text,u?f+=y(c[h].style.font)*(p?p.length:0):(d=a.To.No(c[h].style.font,1),g=c[h].style.vertAlign?d.fontSize*W+"px "+d.fontFamily:c[h].style.font,f+=S(t,g,p));return[{textLength:f,text:e,textInfos:c}]},t.prototype.__a=function(t,e,o,n,r,i,s,l,u,c,f,h,p,d,g,m,y,C){var v,b=c.font,w=a.To.No(b,1).fontSize,T=w>8?L((w-8)/5+2):1;this.L$a(t,e,c),d?this.c0a(t,o,n,c,r,i,h,p,h,m,y,C):(v=f>s,this.Oja(t,o,n,r,i,u,f,p,c.textDecoration,T,w,m,c,y,C,v,g))},t.prototype.c0a=function(t,e,o,n,r,i,a,s,l,u,c,f){var h,p,d,g=o.content,m=i;if(this.Ufc(t,n,u,r,m,l,l*e.length,f),g&&g.length>0)for(p=(p=a-s-ht(t,g,!0)-2)>0?p:0,void 0,h=0;h<g.length;h++)"fillingChar"===g[h].type?(d=pt(t,p,g[h].value,!0),this.vWa(t,d,r,i),i+=p):"placeholder"===g[h].type?i+=g[h].value?g[h].value.length*l:0:"numberPlaceholder"===g[h].type?i+=l:(this.vWa(t,g[h].value,r,i),i+=g[h].value?g[h].value.length*l:0);else if(e)for(h=0;h<e.length;h++)i=this.vWa(t,e[h],r,i,l).y;this.Vfc(t,n,u,r,m,l,i-m,f)},t.prototype.d0a=function(t){var e=M;return 1===t?e=N:2===t&&(e=k),e},t.prototype.a0a=function(t,e,o,n,r,i,a,s){var l,u,c=[],f=a.textInfos;for(l=0;l<f.length;l++)c.push(I(!0,{},r,f[l].style));for(l=0;l<f.length;l++)o=(u=this.f0a(t,e,o,n,c[l],f[l].text,s)).x,n=u.y},t.prototype.Y_a=function(t,e,o,n){var r,i,a=[],s=t.length;for(r=0;r<s;r++)i=this.g0a(e,o,n,t[r].textInfos),a.push(i);return a},t.prototype.g0a=function(t,e,o,n){var r,i,s,l=0,u=0;for(r=0;r<n.length;r++)void 0,i=n[r].style&&n[r].style.font?n[r].style.font:t.font,l=Math.max(y(i,P,v(n[r].text)),l),u=Math.max(a.To.No(i,1).fontSize,u),(n[r].style&&1===n[r].style.vertAlign||2===n[r].style.vertAlign)&&(l=Math.max(y(i,P,v(n[r].text))+2*a.To.No(i,W).fontSize*.218,l));return{lineHeight:l,fontSize:u,baselineOffset:s=u>8?L((u-8)/5+2):1,lineOffset:l/2-u/2+s-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:this.d0a(e),textBaseline:O,opacity:o}},t.prototype.h0a=function(t,e,o){var n,r=0,i=0;for(n=0;n<t.length;n++)i+=e[n].lineHeight,r=Math.max(t[n].textLength,r);return{width:o?i:r,height:o?r:i}},t.prototype.$_a=function(t,e,o,n,r,i,a,s,l,u,c,f,h){var p,d=this.h0a(u,c,s),g=d.height,m=d.width,y=[];if(s)for(p=0;p<u.length;p++)y.push(this.i0a(t,e,o,n,r,i,a,m,u[p].textLength,c[p].lineHeight,c[p].lineOffset,l,f,u[p],h)),l?t-=c[p].lineHeight:t+=c[p].lineHeight;else for(p=0;p<u.length;p++)y.push(this.j0a(t,e,o,n,r,i,a,u[p].textLength,g,c[p].lineHeight,c[p].lineOffset,f)),e+=c[p].lineHeight;return y},t.prototype.j0a=function(t,e,o,n,r,i,a,s,l,u,c,f){var h=0,p=f.left,d=f.right;return 1===r?h=(o-s+p-d)/2:2===r?(h=o-1-2-s-d,h-=a):h=2+a+p,{x:t+h,y:e+(1===i?(n-l)/2+u-c:2===i?n-l-2+u-c:2+u-c)}},t.prototype.i0a=function(t,e,o,n,r,i,a,s,l,u,c,f,h,p,d){var g=0,m=h.left,y=h.right;return f?0===r?g=2+s+y-u/2:1===r?g=(o-m+y+s)/2-u/2:2===r&&(g=o-m-1-2-u/2):1===r?g=(o-s+m-y)/2+u/2:2===r?g=o-1-2-y-s+u/2:0===r&&(g=2+m+u/2),{x:t+g,y:e+(1===i?(n-l)/2:2===i?n-a-l-2:2+a)}},t.prototype.f0a=function(t,e,o,n,r,i,a){var s,l;return t.save(),this.L$a(t,e,r),s=r.vertAlign,l=r.isVerticalText?this.vWa(t,i,o,n,r.textDecoration,r.baselineOffset,a):this.k0a(t,o,n,r,i,s),t.restore(),l},t.prototype.L$a=function(t,e,o){et(t,e,o);var n=o.vertAlign?this.l0a(o.font):o.font;g(o.textBaseline)||t.textBaseline===o.textBaseline?g(t.textBaseline)&&t.textBaseline!==O&&(t.textBaseline=O):t.textBaseline=o.textBaseline,o.isVerticalText?t.textAlign!==N&&(t.textAlign=N):t.textAlign!==M&&(t.textAlign=M),b(t,n)},t.prototype.l0a=function(t){var e=a.To.Ko(t),o=parseFloat(e.fontSize)*W;return e.fontSize=o+"px",this.m0a(e)},t.prototype.m0a=function(t){var e="",o="normal",n=t.fontStyle,r=t.fontSize,i=t.fontWeight,a=t.fontFamily;return e=void 0!==n?n:o,e+=void 0!==i?(e?" ":"")+i:(e?" ":"")+o,(e+=(e?" ":"")+r)+(void 0!==a?(e?" ":"")+a:(e?" ":"")+"Calibri")},t.prototype.vWa=function(t,e,o,n,r,i,s){var l,u,c,f,h,p,d,g,m;if(e&&e.length>0)for(l=t.font,u=y(l,P,v(e)),c=function(t,e){return e/2-t/2+(t>8?L((t-8)/5+2):1)-1}(a.To.No(l,1).fontSize,u),h=(f=this.pHb(t,"0"))/2,p=0;p<e.length;p++)d=$(e[p]),n=n+((g=void 0!==s&&p>=s&&p<=s+2&&(s+3===e.length||0===s&&s+3<e.length||0!==s&&s+3<e.length))?f:u)-(m=g?h:c),t.fillText(d,o,n),this.Mxb(t,r,o,n,S(t,t.font,d),a.To.No(t.font,1).fontSize,i),n+=m;return{x:o,y:n}},t.prototype.Mxb=function(t,e,o,n,r,i,a){var s,l,u,c;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=0,u=.5,l=L(((i<=12?12:i)-12)/21+1),t.lineWidth!==l&&(t.lineWidth=l),0==(1&l)&&(u=0),(c=t.textAlign)===N?o-=r/2:c===k&&(o-=r),t.beginPath(),2==(2&e)&&(s=G(n+a-i/2)-u,t.moveTo(o,s),t.lineTo(o+r,s)),t.stroke()},t.prototype.k0a=function(t,e,o,n,r,i){var s,l,u,c,f;return g(r)?{x:e,y:o}:(l=(s=a.To.No(t.font,1).fontSize)>8?L((s-8)/5+2):1,u=0,i?(u=1===i?.74*s:.28*-s,t.fillText(r,e,o-u)):t.fillText(r,e,o),c=S(t,t.font,r),f=n.textDecoration,this.ip(t,f,e,o,c,s,l-u),{x:e+c,y:o})},t.prototype.jp=function(e,o,n,r,i,a,s,l){var u={row:l.row,col:l.col,sheet:l.sheet,sheetArea:l.sheetArea,style:s,underline:s.textDecoration,foreColor:s.foreColor};t.ao(l.sheet,"applyHyperlinkStyle",u),this.paint(e,o,n,r,i,a,s,l)},t.prototype.paint=function(t,e,o,n,r,a,s,l){var u,c,f;t&&(u=s.backColor,l.parentBackColor!==u&&it(t,o,n,r,a,l.imageLoader,s,e,l),c=this,f=new i.Rect(o,n,r,a),c.Sfc(t,l,f,e,s),c.i5&&(c.i5(t,f,s,l),f=c.f5(f,s,Q(l)?l.printZoomFactor:l.sheet.zoom())),l.cellOverflowLayout||c.uxb(t,f,l,T(e)),f.width>0&&f.height>0&&(s&&s.showEllipsis&&l.sheet.ITa.qHb(l.row,l.col,null,l.sheetArea),c.paintContent(t,e,f.x,f.y,f.width,f.height,s,l)))},t.prototype.paintContent=function(t,e,o,n,r,a,s,l){var u,c,f,h,p,d,g,m,y=l.sheetArea;2!==y&&1!==y||(u=l.visualState||0,c="columnHeader",2===y&&(c="rowHeader"),f=this.getThemeStyle(l.visualState,"gc-"+c+"-"+i.Im.Jm(u)),Z.gp(t,o,n,r,a,s,c,f,y)),(p=l.conditionalFormats)&&(h=p.jp(t,T(e),o,n,r,a,s,l)),l.showBarIconOnly=h,(d=l.sparkline)&&d.paintSparkline(t,o,n,r,a),g=Z.bDc(t,T(e),o,n,r,a,l),l.cellOverflowLayout||h||g||(m=new i.Rect(o,n,r,a),this.paintValue(t,e,m.x,m.y,m.width,m.height,s,l))},t.prototype.adjustRectForIconSet=function(t,e,o,n,r,i,a){!function(t,e,o,n,r,i,a){if((0===t||a)&&ot(e,o,n,r)){var s=at(e);i.x+=s,i.width-=s}}(t,e,o,n,r,i,a)},t.prototype.hasInfilling=function(t){for(var e=0;e<t.length;e++)if("fillingChar"===t[e].type)return!0;return!1},t.prototype.createEditorElement=function(t,e){return j},t.prototype.getEditorValue=function(t,e){return j},t.prototype.kp=function(t,e,o,n){return o},t.prototype.setEditorValue=function(t,e,o){},t.prototype.getEditingElement=function(){return j},t.prototype.parse=function(t,e,o){var r,i=g(e),a=g(t);try{if(r=n.Formatter&&n.Formatter.GeneralFormatter,!i&&!a&&r)return(typeof e===F?new r(e):e).parse(t)}catch(t){}return a?"":""+t},t.prototype.format=function(t,e,o,r){var a,s,l,p=A(e);if(r&&p&&(a=r.sheet.aHb(r.row,r.col,e),g(a)||(t=a)),g(t)||""===t)return"";if(r&&r.quotePrefix&&typeof t===F)return""+t;if(!p&&typeof e===F&&"object"!=typeof t)return i.mn.un(t,e,o);if(!e||"General"===e||p)return"boolean"==typeof t||t instanceof Boolean?(u&&(t=t?u.getBoolean().boolean_true:u.getBoolean().boolean_false),(""+t).toUpperCase()):t instanceof Date?(l=(s=c.q4(c.culture()).DateTimeFormat).shortDatePattern,0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(l=s.defaultDatePattern),h.Vb(t,l)):(typeof t===E&&(t=f.nb(""+t)),""+t);try{return n.Formatter&&n.Formatter.GeneralFormatter?(j,(typeof e===F?i.mn.tn(e):e).format(t,o)):""+t}catch(e){return""+t}},t.prototype.focus=function(t,e){t&&t.focus&&t.focus()},t.prototype.getThemeStyle=function(t,e){return i.Im.Km(t,e)},t.prototype.activateEditor=function(t,e,o,n,r,i,a){},t.prototype.deactivateEditor=function(t,e){},t.prototype.selectAll=function(t,e){t&&t.select&&t.select()},t.prototype.updateEditor=function(t,e,o,n,r,i,a){},t.prototype.setImeMode=function(t,e,o){this.isImeAware(o)?this.updateImeMode(t,e,o):t&&Z.hp(t,0)},t.prototype.updateImeMode=function(t,e,o){t&&Z.hp(t,e)},t.prototype.getHitInfo=function(t,e,o,n,r){return j},t.prototype.getCellAndPaddingHitInfo=function(e,o,n,r,i){var a,s;if(i){if(a={x:e,y:o,context:i,cellStyle:n,cellRect:r,paddingHitInfo:null},t.ao(i.sheet,"getCellButtonHitInfo",a,(function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo})),s=a.paddingHitInfo,a.paddingHitInfo&&!g(a.paddingHitInfo.cellButtonHitInfo)&&!g(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=this.f5?this.f5(a.cellRect,n,i.sheet.zoom()):a.cellRect,t.ao(i.sheet,"getCellTextHitInfo",a,(function(){return!g(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===i.sheetArea)return t.ao(i.sheet,"getCellPaddingHitInfo",a,(function(){return!g(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo?a.paddingHitInfo:s||this.getHitInfo(e,o,n,r,i)}return this.getHitInfo(e,o,n,r,i)},t.prototype.processCellAndPaddingMouseDown=function(e){return t.ao(e.sheet,"processMouseDownOnCellPadding",e),this.processMouseDown(e)},t.prototype.processMouseDown=function(t){return!1},t.prototype.YBb=function(e){return t.ao(e.sheet,"processMouseMoveOnCellPadding",e),this.processMouseMove(e)},t.prototype.processMouseMove=function(t){return!1},t.prototype.XGb=function(e){return t.ao(e.sheet,"processMouseUpOnCellPadding",e),this.processMouseUp(e)},t.prototype.processMouseUp=function(t){return!1},t.prototype.processMouseEnter=function(t){return!1},t.prototype.ZBb=function(e){return t.ao(e.sheet,"processMouseLeaveOnCellPadding",e),this.processMouseLeave(e)},t.prototype.processMouseLeave=function(t){return!1},t.prototype.isReservedKey=function(t,e){return!1},t.prototype.isEditingValueChanged=function(t,e,o){var n=o.sheet,r=o.row,i=o.col,a=n&&n.getValue(r,i,3,s.ValueType.richText);return a&&a.richText&&(t=t&&t.replace(/\r\n?/g,"\n")),t===j&&(t=P),e===j&&(e=P),t!==e},t.prototype.processCompositionStart=function(t,e){return!1},t.prototype.processKeyDown=function(t,e){return!1},t.prototype.processKeyUp=function(t,e){return!1},t.prototype.getAutoFitWidth=function(t,e,o,n,r){return Z.cp(t,e,o,n,r)},t.prototype.getAutoFitHeight=function(t,e,o,n,r){return Z.ep(t,e,o,n,r)},t.prototype.Oja=function(t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y){var C;o&&o.content&&o.content.length>0&&(y||!g)?this.Pja(t,o.content,n,r,i,a,s,l,u,c,f,h,p,d,m):(m=m||S(t,t.font,e),C=n,t.textAlign===N?C-=m/2:t.textAlign===k&&(C-=m),this.Ufc(t,h,f,C,r,m,f.lineHeight,d),t.fillText(e,n,r),l&&this.ip(t,l,n,r,m,c,u),this.Vfc(t,h,f,C,r,m,f.lineHeight,d))},t.prototype.tHb=function(t,e,o,n,r,i,a,s,l){if(t.save(),t.textAlign="center",t.textBaseline="middle",t.translate(n,r),t.rotate(-e),t.fillText(o,0,0),i){var u=t.measureText(o).width;this.ip(t,i,0,l,u,a,s)}t.restore()},t.prototype.sHb=function(t,e,o,n){var r,i,a;for(t.font||b(t,n),r=(r=o-ht(t,e))>0?r:0,i=[],a=0;a<e.length;a++)if("fillingChar"===e[a].type)i.push(pt(t,r,e[a].value));else{if("placeholder"===e[a].type||"numberPlaceholder"===e[a].type)continue;i.push(e[a].value)}return i.join("")},t.prototype.Pja=function(t,e,o,n,r,i,a,s,l,u,c,f,h,p,d){var m,y,C,v,b;t.save(),t.textAlign!==M&&(t.textAlign=M),v=(v=i-a-(m=ht(t,e))-((y=h?h.left:0)+(C=h?h.right:0))-2)>0?v:0,g(d)?this.hasInfilling(e)?1===r?(o-=(i+y-C)/2,o+=a+y):2===r&&(o=o-i+C+2,o+=a+y):g(m)||(1===r?o-=m/2:2===r&&(o-=m)):this.hasInfilling(e)?1===r?(o=o+(d||m)/2-(i+y-C)/2,o+=a+y):2===r&&(o=o+(d||m)-i+C+2,o+=a+y):g(m)||(1===r?o=o+d/2-m/2:2===r&&(o=o+d-m)),this.Ufc(t,f,c,o,n,m,c.lineHeight,p),b=this.Qja(t,e,o,n,v,s,l,u),this.Vfc(t,f,c,o,n,b-o,c.lineHeight,p),t.restore()},t.prototype.Qja=function(t,e,o,n,r,i,a,s,l){var u,c,f,h=0;for(q[t.font+"0"]?h=q[t.font+"0"]:(h=S(t,t.font,"0"),q[t.font+"0"]=h),u=0;u<e.length;u++)"fillingChar"===e[u].type?(t.fillText(pt(t,r,e[u].value),o,n),i&&this.ip(t,i,o,n,r,s,a),o+=r):"placeholder"===e[u].type?o+=S(t,t.font,e[u].value):"numberPlaceholder"===e[u].type?o+=h:((c=e[u].value)!==j&&t.fillText(c,o,n),f=S(t,t.font,c),i&&this.ip(t,i,o,n,f,s,a),o+=f);return o},t.prototype.ip=function(t,e,o,n,r,i,a){var s,l,u,c;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=t.textAlign,l=0,c=.5,u=L(((i<=12?12:i)-12)/21+1),t.lineWidth!==u&&(t.lineWidth=u),0==(1&u)&&(c=0),s===N?o-=r/2:s===k&&(o-=r),t.beginPath(),4==(4&e)&&(l=G(n+a-i-1)-c,t.moveTo(o,l),t.lineTo(o+r,l)),2==(2&e)&&(l=G(n+a-i/2)-c,t.moveTo(o,l),t.lineTo(o+r,l)),1==(1&e)&&(l=G(n+a-1)-c,t.moveTo(o,l),t.lineTo(o+r,l)),8==(8&e)&&(l=G(n+a-1)-c,t.moveTo(o,l-u),t.lineTo(o+r,l-u),t.moveTo(o,l+u),t.lineTo(o+r,l+u)),t.stroke()},t.prototype.lp=function(t,e){var o="";4==(4&e)&&(o="overline"),2==(2&e)&&(o+=" line-through"),1==(1&e)&&(o+=" underline"),t.css("text-decoration",o)},t.prototype.gQa=function(){return j},t.prototype.isImeAware=function(t){return!1},t.prototype.isEditting=function(){return!1},t.prototype.lJc=function(t){},t.prototype.toJSON=function(){var t,e={},o=this;for(t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)g(t[e])||(this[e]=t[e])},t}(),e.Base=K,i.Zn(K),l._o[0]=K},"./dist/core/celltype/cellType.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/core/celltype/celltype.ns.js")),n(o("./dist/core/celltype/basecelltype.js")),n(o("./dist/core/celltype/textcelltype.js")),n(o("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._o={}},"./dist/core/celltype/headercelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function I(t,e){return t=t||0,c.Km(t,"gc-"+e+"-"+c.Jm(t))}function R(t,e,o,n,r,i){var a=new Image,s=i;s=(s=s.replace('url("',"")).replace('")',""),a.src=s,t.drawImage(a,e,o,n,r)}function M(t,e,o,n,r,i,s,c,f){var p,d,m,y,v,b,w,T,S,x,A,I,M;function k(){t.fillRect(e+1,o+1,n-1,r-1)}if(!g(c)){if(t.save(),t.beginPath(),p=i.backColor,0===c&&p)a.To.setFillStyle(t,p,e,o,n,r,k);else try{if(p=f&&f.backgroundColor,d=f&&f.backgroundImage,m=s.sheet,y=s.row,v=s.col,b=s.sheetArea,w=void 0,T=!1,m.cellStates&&c===u.VisualState.hover&&((w=m.cellStates.getStyle(y,v,b))&&w.backColor&&(p=w.backColor,T=!0)),!T&&d&&-1!==d.indexOf("linear-gradient")){for(S=h(d),x={degree:90,stops:[]},A=0,I=S.length;A<I;A++)M=S[A],x.stops.push({position:M.point,color:M.color});a.To.setFillStyle_Gradient(t,x,e,o,n,r,k)}else p?(t.fillStyle=p,k()):d&&d!==C&&R(t,e+1,o+1,n-1,r-1,d)}catch(t){}l.Context.ap(t,e,o,n,r,i.backgroundImage,i.backgroundImageLayout,s.imageLoader),t.restore()}}function k(t,e,o,n,r,a,s,u,c,f,h,p){var d,g,m,y,C;e&&(M(e,n,r,a,s,u,c,d=c.visualState||0,g=I(d,f)),l.Context.gp(e,n,r,a,s,u,f,g,h,c.needTopGridline,c.needLeftGridline),m=new i.Rect(n,r,a,s),t.Sfc(e,c,m,o,u),t.i5&&(t.i5(e,m,u,c),y=c.printZoomFactor,C=c.isPrinting&&"number"==typeof y&&1!==y?y:c.sheet.zoom(),m=t.f5(m,u,C)),m.width>0&&m.height>0&&t.paintContent(e,o,m.x,m.y,m.width,m.height,u,c,p))}function N(t,e,o,n,r,i){var s,l={font:e,fillStyle:o},u=n.sheet;return 0!==n.visualState&&parseInt(i.zIndex,10)>2007&&u.vp(n.row,n.col,r)&&(void 0,s=u.wp(n.row,n.col,r)?t(n.visualState,"gc-columnHeader-selected"):t(n.visualState,"gc-columnHeader-highlight"),l.fillStyle=s.color,l.font=a.To.Ro(l.font,"bold")),l}function O(t,e,o,n,r,a,s,l,u,c,f,h){var p,d,g={},y=t.format(m(o),l.formatter,g),C=u.sheet;y&&(e.save(),e.beginPath(),(!!((p=C.rowFilter&&C.rowFilter())&&p.Dl(u.row,u.col,c)&&p.filterButtonVisible(u.col))||h)&&(a-=C.oK(new i.Rect(n,r,a,s),c).width),(d=l.foreColor)||(d=f.color),d&&e.fillStyle!==d&&(e.fillStyle=d),o&&o.richText&&o.richText.length>0||l.isVerticalText?D(t,C,e,o,n,r,a,s,l,y,g,u,c,f):F(t,e,o,n,r,a,s,l,y,g,u,c,f),e.restore())}function D(t,e,o,n,r,i,a,s,l,u,c,f,h,d){var g,C,b,T,S,x,A,I,R,M,k,O,D,F,E,j,P,L=new w(r,i,a,s),G=N(t.getThemeStyle,l.font||o.font,o.fillStyle,f,h,d),B=l.isVerticalText,_=l.hAlign,V=function(t){var e=0,o=t.textIndent;return o>0&&(e=8*o),e}(l),H=t.T_a(l.formatter||l._autoFormatter,n.text),z=y(!0,[],t.U_a(n,u,H,G.font,G.fillStyle));if(n&&n.richText&&n.richText.length>0&&(g=f.sheet?f.sheet.zoom():1,C=f.printZoomFactor,C=f.isPrinting&&"number"==typeof C&&1!==C?C:v,t.V_a(z,G,g,C)),b=t.Pfc(o,m(n),l,f,r,i,a,s),x=(T=t.Qfc(b.externals.left))+(S=t.Qfc(b.externals.right)),A={left:T,right:S},!l.wordWrap&&l.shrinkToFit&&t.W_a(z,a-x,s,l,G,1,B),I=t.X_a(o,u,l.font,B?s:a-x,V,B?l.vAlign:l.hAlign,l.wordWrap,B,z),R=t.Y_a(I,l,_),function(t,e,o,n,r,i,a,s,l){var u=!1;u=!!e.wordWrap||(e.isVerticalText?s+a>i||l>r:s+a>r||l>i),u&&(t.rect(o,n,r,i),t.clip(),t.beginPath())}(o,l,r,i,a,s,V,I[0].textLength,R[0].lineHeight),M=B?p(u):v,k=!1,l.wordWrap||l.shrinkToFit||!l.showEllipsis||!B||n.richText||(k=!0),O=t.$_a(L.x,L.y,L.width,L.height,_,l.vAlign,V,B,M,I,R,A,k),D=[],k&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===I.length&&I[0].text)&&t.oHb(o,f,I,R,l,s,i,V,O,D),1===(F=I.length)&&c.content&&!H)t.__a(o,e,u,c,O[0].x,O[0].y,a,s,_,l,L.width,L.height,V,B,I[0].textLength,f,A,L);else for(E=0;E<F;E++)j=t.Wfc(I),P=O[0].x,"center"===o.textAlign?P-=j/2:"right"===o.textAlign&&(P-=j),t.Ufc(o,l,f,P,O[0].y,j,0,L),t.a0a(o,e,O[E].x,O[E].y,R[E],_,I[E],D[E]),t.Ufc(o,l,f,P,O[0].x,j,0,L)}function F(t,e,o,n,r,i,s,l,u,c,h,p,g){var m,y,C,v,T,S,x,A,I,R,M,k,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$=new w(n,r,i,s),tt=N(t.getThemeStyle,l.font||e.font,e.fillStyle,h,p,g);if(d(e,tt.font),e.fillStyle=tt.fillStyle,m=0,(y=l.textIndent)>0&&(m=8*y),C=parseInt(h.fontInfo.fontSize,10),v=l.hAlign,T=l.vAlign,S="left",x=2,A=t.Pfc(e,u,l,h,n,r,i,s),M=(I=t.Qfc(A.externals.left))+(R=t.Qfc(A.externals.right)),k={left:I,right:R},x+=m+I,1===v?(x=(i+I-R)/2,S="center"):2===v&&(x=i-R-1,x-=m,S="right"),e.textAlign!==S&&(e.textAlign=S),O=0,D="alphabetic",F=2,E=l.wordWrap,j=l.shrinkToFit,P=l.font,L=h.lineHeight,G=[],B=0,!E&&j)for(_=0,V={value:!1},H=0;H<3&&!1===V.value&&(z=e.measureText(u).width,(_=Math.max(0,i-4-(1===v?0:m)))<z);H++)P=a.To.No(P,_/z,V,!0).font,d(e,P);if(U=0,E&&(U=i-M-3-m,U-=1,(B=(G=f.Wn(u,U,tt.font)).length)>1&&0!==T&&(O=(B-1)*L)),q=L/2-C/2+(W=C>8?b((C-8)/5+2):1)-1,!E&&l.showEllipsis&&t.rHb(h,c,u,e,i,v,m),F+=L-q,1===T?F=(s-O)/2+L/2-q:2===T&&(F=s-O-2-q),e.textBaseline!==D&&(e.textBaseline=D),J=l.textDecoration,X=$.x,Z=$.y,Y=$.width,K=$.height,l.wordWrap)if(e.rect(X,Z,Y,K),e.clip(),e.beginPath(),Q=r+F,B>1){for(t.Ufc(e,l,h,n+x,Q,U,L*B,$),H=0;H<B;H++)e.fillText(G[H],n+x,Q),J&&(z=e.measureText(G[H]).width,t.ip(e,J,n+x,Q,z,C,W)),Q+=L;t.Ufc(e,l,h,n+x,Q,U,L*B,$)}else t.Oja(e,u,c,n+x,r+F,v,Y,m,J,W,C,h,l,k,$);else(e.measureText(u).width>Y||L>K)&&(e.rect(X,Z,Y,K),e.clip(),e.beginPath()),t.Oja(e,u,c,n+x,r+F,v,Y,m,J,W,C,h,l,k,$,void 0,void 0,l.showEllipsis)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/domUtil.js"),i=o("./dist/core/util/common.js"),a=o("./dist/core/worksheet/stylehelper.js"),s=o("./dist/core/celltype/celltype.ns.js"),l=o("./dist/core/celltype/basecelltype.js"),u=o("./dist/core/core.enum.js"),c=i.Im,f=i.Vn,h=i.Ul.wl,p=i.Ul.uWa,d=i.Ul.lZa,g=n.Common.j.Fa,m=i.Ul.K_a,y=r.GC$.extend,C="none",v=void 0,b=Math.floor,w=i.Rect,T=function(t){function e(){var e=t.call(this)||this;return e.typeName="2",e}return A(e,t),e.prototype.paint=function(t,e,o,n,r,i,a,s,l){k(this,t,e,o,n,r,i,a,s,"columnHeader",1,l)},e.prototype.paintContent=function(t,e,o,n,r,i,a,s,u){l.Context.bDc(t,m(e),o,n,r,i,s)||O(this,t,e,o,n,r,i,a,s,1,I(s.visualState,"columnHeader"),u)},e}(l.Base),e.ColumnHeader=T,s._o[2]=T,S=function(t){function e(){var e=t.call(this)||this;return e.typeName="3",e}return A(e,t),e.prototype.paint=function(t,e,o,n,r,i,a,s){k(this,t,e,o,n,r,i,a,s,"rowHeader",2)},e.prototype.paintContent=function(t,e,o,n,r,i,a,s){l.Context.bDc(t,m(e),o,n,r,i,s)||O(this,t,e,o,n,r,i,a,s,2,I(s.visualState,"rowHeader"))},e}(l.Base),e.RowHeader=S,s._o[3]=S,x=function(t){function e(){var e=t.call(this)||this;return e.typeName="4",e}return A(e,t),e.prototype.paint=function(t,e,o,n,r,i,a,s){var l,u,f,p,d,g,m,y,v,b,w,T,S,x,A;if(t){t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),this,l=s.visualState||0;try{f=(u=this.getThemeStyle(s.visualState,"gc-corner-"+c.Jm(l)))&&u.backgroundColor,p=u&&u.backgroundImage,f?(t.fillStyle=f,t.fillRect(o,n,r,i)):p&&p!==C&&R(t,o,n,r,i,p)}catch(t){}if(g=(d=this.getThemeStyle(4,"gc-corner-triangle-"+c.Jm(l)))&&d.backgroundImage,m=d&&d.backgroundColor,y=t.createLinearGradient(o+r/2,n,o+r/2,n+i),g&&-1!==g.indexOf("linear-gradient")){for(b=0,w=(v=h(g)).length;b<w;b++)T=v[b],y.addColorStop(T.point,T.color);t.fillStyle=y}else m&&(y.addColorStop(.125,"#f6fafb"),y.addColorStop(1,m),t.fillStyle=y);(S=t.createLinearGradient(o+r,n+1,o+r,n+i-2)).addColorStop(0,d.borderLeftColor),S.addColorStop(1,d.borderRightColor),t.beginPath(),t.strokeStyle=S,t.moveTo(o+r-.5,n),t.lineTo(o+r-.5,n+i),t.stroke(),s.needLeftGridline&&(t.beginPath(),t.strokeStyle=d.borderLeftColor,t.moveTo(o+.5,n),t.lineTo(o+.5,n+i),t.stroke()),(x=t.createLinearGradient(o,n,o+r-2,n)).addColorStop(0,d.borderTopColor),x.addColorStop(1,d.borderBottomColor),t.beginPath(),t.strokeStyle=x,t.moveTo(o,n+i-.5),t.lineTo(o+r,n+i-.5),t.stroke(),s.needTopGridline&&(t.beginPath(),t.strokeStyle=d.borderTopColor,t.moveTo(o,n+.5),t.lineTo(o+r,n+.5),t.stroke()),t.beginPath(),3,A=i,r<i&&(A=r),t.moveTo(o+r-A+3,n+i-3),t.lineTo(o+r-3,n+i-3),t.lineTo(o+r-3,n+i-A+3),t.fill(),t.restore()}},e}(l.Base),e.Corner=x,s._o[4]=x},"./dist/core/celltype/textcelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function yt(t){return function(t){return rt||0===t}(t)?i.GC$(C("textarea")):i.GC$(C("div"))}function Ct(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function vt(t){return Ct(t)?b&&parseFloat(v.version)<10?g.Woa(t):t.innerText:t.value}function bt(t,e){Ct(t)?t.innerText=f(e)?"":e:t.value=e}function wt(t){var e;return Ct(t)?(e=et.getSelection()).rangeCount>0?e.getRangeAt(0).startOffset:0:t.selectionStart}function Tt(t){var e;return Ct(t)?(e=et.getSelection()).rangeCount>0?e.getRangeAt(0).endOffset:0:t.selectionEnd}function St(t){return t&&"BR"===t.tagName}function xt(t){return t&&"SPAN"===t.tagName}function At(t){return t&&"DIV"===t.tagName}function It(t){return t instanceof Text}function Rt(t,e,o,n){return t.substr(0,e)+n+t.substr(o,t.length-o)}function Mt(t,e,o,n,r,i){var a,s,l,u,c,f="",h=t.childNodes,p=h.length;for(a=0;a<p;a++)xt(s=h[a])?f+=Mt(s,e,o,n,r,i):It(s)?(l=e&&e.startContainer,u=e&&e.endContainer,c=s.textContent,s===l||s===u?l!==u?s===l?(f+=Rt(c,o,c.length,r),i=!0):(f+=Rt(c,0,n,""),i=!1):f+=Rt(c,o,n,r):i||(f+=c)):St(s)&&!i&&(f+="\n");return f}function kt(t,e,o,n,r){var i,a,s=String.fromCharCode(function(t){var e=t.keyCode,o=t.shiftKey,n={106:42,107:43,109:45,110:46,111:47,173:45},r={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},i={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},a=e;return e>=96&&e<=105?a=e-48:n[e]?a=n[e]:o&&i[e]?a=i[e]:!o&&r[e]?a=r[e]:!o&&e>=65&&e<=90&&(a=e+32),a}(r));return Ct(t)?(i=et.getSelection()).rangeCount>0&&It((a=i.getRangeAt(0)).startContainer)?Mt(t,a,o,n,s):a&&a.startOffset===a.endOffset?e+s:s:Rt(e,o,n,s)}function Nt(t){var e=function(t){var e,o=t;return o?(e=o.length,e>0&&"\n"===o[e-1]&&(o+=dt),o):o}(t);return e&&e.indexOf(" ")>=0&&(e=O(e," "," ")),e}function Ot(t,e,o,n,i,a){var s,l,u,c,f,h,p,g,m,y,C=t.srcElement||t.target;C&&"gcEditingInput"===C.getAttribute(B)&&13===t.keyCode&&(t.ctrlKey||t.altKey)&&((s=d.Xl())instanceof r.Worksheet&&((l=s.getCellType(s.Jl,s.Kl))&&(Ct(C)?(o&&(C.blur(),C.focus()),(u=et.getSelection()).rangeCount>0&&(c=u.getRangeAt(0),(f=ot.createElement("span")).innerHTML="<br/>"+dt,c.insertNode(f),(h=ot.createRange()).setStartAfter(f),h.setEndAfter(f),h.collapse(!1),u.removeAllRanges(),u.addRange(h))):(p=C.selectionStart,m=(g=C.value).substr(0,p),y=g.substr(p,g.length-p),C.value=m+"\n"+y,C.selectionStart=p+1,C.selectionEnd=p+1),l.$fc(s.BF,it,it,t,e,!0))),S(t))}function Dt(t){var e,o=t;return o?o.indexOf(dt)<0&&o.indexOf("\n")<0?o:((e=t.split("\n")).forEach((function(t,e,o){(function(t){return t===dt})(t[0])&&(o[e]=t.substr(1))})),e.join("\n")):o}function Ft(t){var e,o,n,r,i,a,s,l,u,c=et.getSelection(),f=!1,h=0,p=0,d="";if(c.rangeCount>0){if(e=c.getRangeAt(0),o=wt(t),n=Tt(t),r=e.startContainer,i=e.endContainer,At(r))f=!0,h=o;else if(l=void 0,(s=(a=r.childNodes).length)>0)for(l=0;l<s;l++){if(!(u=a[l]).tagName||"br"!==u.tagName.toLocaleLowerCase()){r=u;break}d+="\n"}return At(i)&&(p=n),d+Et(t,o,n,r,i,f,h,p).content}}function Et(t,e,o,n,r,i,a,s){var l,u,c,f,h,p,d;if(n===r&&!i)return{content:Dt(n.textContent.slice(e,o))};for(l="",u=a,h=t.childNodes,p=s||h.length;u<p;u++)if(xt(d=h[u])){if(l+=(c=Et(d,e,o,n,r,i,0,0)).content,c.startFlag&&(i=!0),c.endFlag){f=!0;break}}else if(It(d)&&d===n)l+=d.textContent.slice(e,d.textContent.length),i=!0;else{if(It(d)&&d===r){l+=d.textContent.slice(0,o),f=!0;break}i&&(l+=St(d)?"\n":d.innerText||d.textContent)}return{content:Dt(l),startFlag:i,endFlag:f}}function jt(t,e){var o,n=t.length,r=[];for(o=0;o<n;o++)r.push(k(t[o],e));return r}function Pt(t,e,o,n){var r,i=0,a=o;for(r=0;r<t.length;r++)T&&(a=n[r]),t[r]>e?i+=a*st(t[r]/e):i+=a;return i}function Lt(t){var e,o,n,r,i=["0","0","0","0"];return"string"==typeof t&&(n=void 0,r=void 0,1===(o=(e=t.split(" ",4)).length)?i=[n=e[0],n,n,n]:2===o?i=[n=e[0],r=e[1],n,r]:3===o?(r=e[1],i=[e[0],r,e[2],r]):4===o&&(i=[e[0],e[1],e[2],e[3]])),i}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/worksheet/worksheet.js"),i=o("./dist/core/util/domUtil.js"),a=o("./dist/core/util/common.js"),s=o("./dist/core/celltype/celltype.ns.js"),l=o("./dist/core/celltype/basecelltype.js"),u=o("./dist/core/core.enum.js"),c=o("./dist/core/util/common.js"),f=n.Common.j.Fa,h=a.Vn,p=a.Events.EditChange,d=a.Vl,g=a.Ul,m=a.uHb,y=g.lHb,C=g.Nl,v=g.Ml,b=v.msie,w=v.edge,T=v.chrome,S=g.nl,x=g.ol,A=g.Il,I=g.vl,R=g.rl(),M=g.fp,k=g.Voa,N=g.pL,O=g.Ika,D=g.hZa,F=g.K_a,E=g.Fxb,j="left",P="right",L="center",G="top",B="gcUIElement",_="none",V=".gcEditingInput",H="width",z="height",U="text-align",W="hidden",q="word-wrap",J="overflow",X="vertical-align",Z="normal",Y="break-word",K="overflow-y",Q="scroll",$="word-break",tt="float",et=window,ot=document,nt=R.ipad,rt=R.iphone||nt||R.android,it=null,at=void 0,st=Math.ceil,lt=Math.min,ut=Math.sin,ct=Math.cos,ft=Math.abs,ht=Math.max,pt=parseInt,dt="​",function(t){t[t.textarea=0]="textarea",t[t.editableDiv=1]="editableDiv"}(e.EditorType||(e.EditorType={})),gt=function(t){function e(e){var o=t.call(this)||this;return o.allowOverflow=!0,o.typeName="1",o.editorType=f(e)?1:e,o}return mt(e,t),e.prototype.getText=function(t,e){return t},e.prototype.paintValue=function(t,e,o,n,r,i,a,s){var f,h,p,d,g,m,C,v,b,w,S,A,I,R,M,k,N,O,D,j,P,L=this,G=s.sheet,B=G.zoom?G.zoom():1;if(e=L.getText(e,s),f={},s.quotePrefix=a.quotePrefix,d=(p=a.formatter)&&"General"!==p,g=y(p),"string"==typeof p&&(d=d&&!g),m=a.textOrientation,C=a.textIndent&&0!==a.textIndent,v=a.isVerticalText,b=r,m&&-90<=m&&m<=90&&!C&&!v&&(w=ft(m*Math.PI/180),b=(i-s.lineHeight*ct(w))/ut(w)),S=L.Pfc(t,h,a,s,o,n,r,i).externals,A=L.Qfc(S.left),I=L.Qfc(S.right),3===(R=a.hAlign)&&(R=x(R,e,a.formatter)),2===R?b-=I:0===R&&(b-=A),M=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,d?k=a.formatter:M?k=a._autoFormatter:G.parent&&G.parent.options.numbersFitMode===u.NumbersFitMode.mask?k=l.Context.Ixb(t,e,b,a,B):G.parent&&G.parent.options.numbersFitMode===u.NumbersFitMode.overflow&&(k=a._autoFormatter),h=g&&(e instanceof Date||"boolean"==typeof e||e instanceof Boolean||"number"==typeof e)?L.format(e,p,{}):L.format(F(e),k,f,s),N=new c.Rect(o,n,r,i),this.adjustRectForIconSet(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,N,f.content&&this.hasInfilling(f.content)),o=N.x,r=N.width,!0!==a.shrinkToFit&&!v)if(E(e)){if(G.parent){switch(O=h,G.parent.options.numbersFitMode){case u.NumbersFitMode.mask:O=this.Yfc(t,h,b,a,B,s,f,G);break;case u.NumbersFitMode.overflow:O=this.Klb(t,s,e,a,G,h,f)}h=O}}else void 0===G.ITa.uIb(s.row,s.col,s.sheetArea)||a.showEllipsis||G.ITa.qHb(s.row,s.col,void 0,s.sheetArea);return D=a.labelOptions,j=a.watermark,P=!D||0!==D.visibility,j&&!h&&P?void L.paintText(t,j,o,n,r,i,a,s,j,f,.337):void((h||f.content&&f.content.length)&&(1===a.vAlign&&T&&n--,L.paintText(t,e,o,n,r,i,a,s,h,f,at,S)))},e.prototype.Yfc=function(t,e,o,n,r,i,a,s){var u=l.Context.Lxb(t,e,o,n,r),c=i.row,f=i.col;return e!==u?(delete a.content,n.textIndent=0,s.ITa.qHb(c,f,s.getText(c,f,i.sheetArea),i.sheetArea)):s.ITa.qHb(c,f,void 0,i.sheetArea),u},e.prototype.Klb=function(t,e,o,n,r,i,a){var s,l,u,c,f=e.row,h=e.col;if(n.wordWrap&&(n.wordWrap=!1),s=N(t,n.font,i),l=r.ss._m(h),c=void 0,!(u=e.cellOverflowLayout)&&l<s)c=r.getText(f,h,e.sheetArea);else if(u&&l<s&&this.lDc(u.backgroundWidth)&&this.lDc(u.valueWidth)){if(!this.lDc(n.hAlign))return;void 0,c=(1!==n.hAlign?u.valueWidth>u.backgroundWidth:u.valueWidth/2>u.backgroundLeftWidth||u.valueWidth/2>u.backgroundRightWidth)?r.getText(f,h,e.sheetArea):void 0}return r.ITa.qHb(f,h,c,e.sheetArea),i},e.prototype.lDc=function(t){return null!=t},e.prototype.createEditorElement=function(t,e){var o,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.qo,r=I(n)+1e3;return i.GC$(e).css("z-index",r),o=yt(this.editorType),i.GC$(o).css({font:"normal 11pt calibri",outline:_,resize:_,border:_,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(q,Z).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(J,W).attr(B,"gcEditingInput"),v.safari&&i.GC$(o).css("-webkit-user-select","auto"),Ct(i.GC$(o)[0])&&(i.GC$(o).css("display","table-cell"),i.GC$(o).css($,Z)),i.GC$(o)[0]},e.prototype.getEditorValue=function(t,e){var o,n;return t&&(o=vt(t),!f(o)&&o.length>0)?(n=(n=Dt(o)).replace(/\r\n?/g,"\n")).indexOf(" ")<0?n:O(n," "," "):it},e.prototype.setEditorValue=function(t,e,o,n){var r,i;t&&(r=o&&o.sheet&&o.sheet.HF,i=Nt(e),b?r&&o.isImeInput||bt(t,f(i)?n?"%":"":i):bt(t,r?n?"%":"":i))},e.prototype.selectAll=function(t,e){t&&t.select?t.select():et.getSelection().selectAllChildren(t)},e.prototype.focus=function(t,e){this.isImeAware()&&t?(t.focus(),function(t){if(Ct(t)){var e=et.getSelection();e.selectAllChildren(t),e.rangeCount>0&&e.collapseToEnd()}else t.selectionStart=t.selectionEnd=t.value.length}(t)):t.parentNode.parentNode.focus()},e.prototype.kp=function(t,e,o,n){var r=t&&n&&n.sheet,i={},a=A(e,o,r,i);return t.oja=i.formatter||at,a},e.prototype.activateEditor=function(t,e,o,n,r,a,s){var l,u,c,h,d=n&&n.sheet;d&&(l=this,(u=t)&&(c=i.GC$(u),h=Ct(u),l._editingElement=u,R.android&&c.bind("input"+V,(function(t){try{l.$fc(u,e,o,t,n,!1,r,a,s)}catch(t){}})),c.bind("keydown"+V,(function(t){var i;try{i=t.keyCode,h&&(8===i?m.processBackspaceAndLeftArrowKeyEvent(t,!0):46===i?m.processDeleteAndRightArrowKeyEvent(t,!0):37===i?m.processBackspaceAndLeftArrowKeyEvent(t,!1):39===i&&m.processDeleteAndRightArrowKeyEvent(t,!1)),229===i||0===i||l.kK||l.$fc(u,e,o,t,n,!0,r,a,s),Ot(t,n,l.kK)}catch(t){}})),c.bind("keyup"+V,(function(t){var c=t.keyCode,f=t.ctrlKey,g=t.altKey;229===c||0===c||l.kK||(46!==c&&8!==c&&(90!==c&&89!==c||!f||g)||(h&&"\n"===u.innerText&&i.GC$(u).empty(),l.$fc(u,e,o,t,n,!1,r,a,s)),(13!==c&&9!==c&&27!==c&&16!==c||f||g)&&d.Wq(p,{sheet:d,sheetName:d.name(),row:d.Jl,col:d.Kl,editingText:l.getEditorValue(u,n)}))})),c.bind("mousedown"+V,(function(){1===d.Px&&(d.Px=2,d.Cu(1,2))})),c.bind("textInput"+V,(function(t){if(t.data&&(l.probabilityAddPercentSpec||l.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)){var e=document.createElement("span");e.innerText="%",e.id="updateEditorImpAddPercent","#text"===u.firstChild.nodeName?u.appendChild(e):u.firstChild.appendChild(e),delete l.probabilityAddPercentSpec,delete l.probabilityAddPercent}})),c.bind("compositionstart"+V,(function(){l.kK=!0,l.nK=vt(u)})),c.bind("compositionupdate"+V,(function(t){l.$fc(u,e,o,t||it,n,!0,r,a,s)})),c.bind("compositionend"+V,(function(t){var i,c,f,h;l.$fc(u,e,o,t||it,n,!1,r,a,s),l.kK=!1,i=t.keyCode,c=t.ctrlKey,f=t.altKey,h=l.getEditorValue(u,n)||"",l.nK!==h&&(i===at||13!==i&&9!==i||c||f)&&d.Wq(p,{sheet:d,sheetName:d.name(),row:d.Jl,col:d.Kl,editingText:h})})),h&&(c.bind("copy"+V,(function(t){var e=et.clipboardData,o=t.clipboardData,n=Ft(t.currentTarget);f(n)||(e&&e.setData?(e.setData("text",n),S(t)):o&&o.setData&&(o.setData("text/plain",n),S(t)))})),c.bind("paste"+V,(function(t){var i,c,f,p,d,g,m,y=!1;if(h)try{i=void 0,b&&!w&&et.clipboardData&&et.clipboardData.getData?i=et.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(i=t.clipboardData.getData("text/plain")),i=Nt(i=i.replace(/\r\n?/g,"\n")),(c=et.getSelection()).rangeCount>0&&((p=(f=c.getRangeAt(0)).startOffset)!==f.endOffset&&f.deleteContents(),function(t,e,o){var n=vt(t);return n&&"="===n[0]||""===n&&"="===e[0]||0===o&&"="===e[0]}(u,i,p)||(d=ot.createElement("span"),"\n"===(i=i.replace(/\u200B/g,""))[(g=i.length)-1]&&(i="\r"===i[g-2]?i.substr(0,g-2):i.substr(0,g-1)),d.innerText=i,f.insertNode(d),(m=document.createRange()).setStartAfter(d),m.setEndAfter(d),m.collapse(!1),c.removeAllRanges(),c.addRange(m),y=!0))}catch(t){}if(l.mK=et.setTimeout((function(){l.$fc(u,e,o,t,n,!1,r,a,s),l.mK&&(clearTimeout(l.mK),delete l.mK)}),10),y)return!1})))))},e.prototype.deactivateEditor=function(t,e){var o,n,r,a,s,l;if(t){if(o=t,this.kK&&nt&&e&&e.sheet&&e.sheet.CH)try{o&&i.GC$(o).trigger("compositionend"+V)}catch(t){}if(n=e.sheet.getActualStyle(e.row,e.col,e.sheetArea).cellPadding)for(r=[j,G],a=[3,0],s=0;s<r.length;s++)l="number"==typeof(l=parseInt(Lt(n)[a[s]],10))&&l>0?l:0,this.shiftPadding(o,r[s],l);i.GC$(t).unbind(V),e.sheet.mm.Qq()}this._editingElement=it},e.prototype.shiftPadding=function(t,e,o){var n=i.GC$(t).parent();n&&(e===j?n.css({left:(+i.GC$(n).css(j).replace("px","")||0)-o}):e===G&&n.css({top:(+i.GC$(n).css(G).replace("px","")||0)-o}))},e.prototype.getEditingElement=function(){return this._editingElement},e.prototype.lK=function(t,e,o,n,r,a,s,u,c){var p,d,g,m,y,C,v,w,S,A,I,R,k,N,O,F,E,G,B,V,et,ot,nt,rt,it,at,ut,ct,ft,dt,gt,mt,yt,bt,St,xt,At,It,Rt,Mt=r&&r.sheet,Nt=this,Ot=Mt.options.sheetAreaOffset,Dt=t;if(Dt&&Mt&&(p=i.GC$(Dt),d=Mt.yl,g=r.preventOverflow,m=vt(Dt),Mt.isEditing())){if(y=Ct(Dt),C=void 0,v=j,w=void 0,S=l.Context.u5,A=0,I=0,R=0,k=0,e&&(A=S(e,0,!1,N=Mt.zoom()),I=S(e,1,!1,N),R=S(e,2,!1,N),k=S(e,3,!1,N),1===(C=x(e.hAlign,t.LF))?v=L:2===C&&(v=P),p.css(U,v),e.foreColor&&p.css("color",e.foreColor),(w=e.font||d.Bl())&&(Mt.zoom()>1&&(w=d.Cl(w)),p.css("font",D(w))),e.textDecoration&&Nt.lp(p,e.textDecoration)),O=pt(p.css("padding-left"),10)||0+pt(p.css("padding-right"),10)||0,F=pt(p.css("padding-top"),10)||0+pt(p.css("padding-bottom"),10)||0,f(s)&&(s=o),s&&(E=Mt.am(),G=o.width,s.x+s.width-Ot.left>E.width&&(o.width=E.width-o.x,s.width=E.width-s.x),p.css(H,G-O).css(z,o.height-F),Dt.maxWidth=Ot.left+E.width-o.x-O-I,p.css("max-width",Dt.maxWidth+"px"),Dt.maxHeight=Ot.top+E.height-o.y-F-R,Dt.minWidth=pt(Dt.style.width,10),Dt.minHeight=pt(Dt.style.height,10)),B=wt(Dt),V=Tt(Dt),et=(a=(a=a&&n&&n.keyCode&&Mt.mm.LH(n)&&0===B&&V===m.length)||Mt.HF)?"":m,(w=Dt.style.font)||(w=d.Cl(d.Bl())),ot=M(w),n&&Nt.probabilityAddPercent&&((nt=n.keyCode)&&(nt>=96&&nt<=105||nt>=48&&nt<=57)&&(Mt.parent.options.enableFormulaTextbox?(it=Dt.innerText,/[a-z]/i.test(it)?Nt.probabilityAddPercent=!1:((rt=document.createElement("span")).innerText="%",rt.id="updateEditorImpAddPercent",Dt.appendChild(rt),delete Nt.probabilityAddPercent)):((rt=document.createElement("span")).innerText="%",rt.id="updateEditorImpAddPercent",Dt.firstChild.appendChild(rt),delete Nt.probabilityAddPercent))),!a&&n&&(Mt.mm.LH(n)&&8!==n.keyCode&&(et=kt(Dt,et,B,V,n)),Nt.kK&&(et=b?m:Nt.nK+n.data)),[],ut=void 0,ct=void 0,ft=(at=e&&e.wordWrap?h.Wn(et,pt(Dt.style.width)-O,w):et.split(/\r\n|\r|\n/)).length,Dt.minWidth=lt(Dt.minWidth,Dt.maxWidth),Dt.minHeight=lt(Dt.minHeight,Dt.maxHeight),e&&e.wordWrap||ft>0){if(dt=void 0,gt=void 0,T?dt=function(t){var e,o=t.length,n=0;for(e=0;e<o;e++)n+=t[e];return n}(gt=jt(at,w)):dt=ft*ot,e&&e.wordWrap)p.css(q,Y).css(J,W).css("max-width",Dt.style.width);else{for(mt=0,yt=[],ut=0;ut<ft;ut++)ct=st(Mt.rt(at[ut],w)),yt.push(ct),mt=ht(mt,ct);bt=p.css(q),St=pt(Dt.style.width),e||bt!==Y?mt<=Dt.minWidth?(p.css(H,Dt.minWidth).css(q,Z).css(J,W),y&&p.css($,Z)):mt>Dt.minWidth&&mt<=Dt.maxWidth&&!g?(p.css(H,mt).css(q,Z).css(J,W),y&&p.css($,Z)):mt>Dt.maxWidth&&!g&&(p.css(H,Dt.maxWidth-2).css(q,Y).css(J,W),dt=Pt(yt,Dt.maxWidth,ot,gt)):mt>St&&!g&&(dt=Pt(yt,St,ot,gt))}dt<=Dt.minHeight?p.css(z,Dt.minHeight).css(tt,_):dt>Dt.minHeight&&dt<=Dt.maxHeight?p.css(z,dt).css(tt,_):dt>Dt.maxHeight&&p.css(z,Dt.maxHeight-1).css(K,Q).css(tt,j)}return C=p.css(U),xt=p.width()-Dt.minWidth,f(C)||C===j||(C===L?p.css(j,Dt.originalLeft-xt/2):C===P&&p.css(j,Dt.originalLeft-xt)),e&&y&&(1===(At=e.vAlign)?p.css(X,"middle"):2===At&&p.css(X,"bottom")),It=pt(Dt.style.height)+F+A+R,Rt=O+k+I,p.css(K)===Q?{width:Dt.offsetWidth+Rt,height:a?0:It}:{width:pt(Dt.style.width)+Rt,height:It}}},e.prototype.updateEditor=function(t,e,o,n,r,a,s){var l,u,h;return o=this.lK(t,e,o,it,n,!1,r,a,s),b&&t&&(u=(l=i.GC$(t))[0].style.width,l.width(u+1).width(u)),!f(o)&&t&&(h=new c.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,o.width,o.height)),h},e.prototype.$fc=function(t,e,o,n,r,a,s,l,u){if(o=this.lK(t,e,o,n,r,a,s,l,u),b&&t){var c=i.GC$(t),h=c[0].style.width;c.width(h+1).width(h)}!f(o)&&t&&(f(s)?s=o:(s.x=at,s.y=at),this.updateEditorContainer(t,o,e,r,s,l,u))},e.prototype.updateEditorContainer=function(e,o,n,r,a,s,l){var u,c,f;r&&r.preventOverflow?(t.prototype.updateEditorContainer.call(this,e,o,n,r,a,s,l),(u=e.parentNode)&&o&&(c=i.GC$(u),(f=o.width)>0&&c.width(f))):(o&&o.width&&a&&a.width&&(a.width=o.width),o&&o.height&&a&&a.height&&(a.height=o.height),t.prototype.updateEditorContainer.call(this,e,o,n,r,a,s,l))},e.prototype.updateImeMode=function(t,e,o){this.isImeAware()&&t&&l.Context.hp(t,e)},e.prototype.isReservedKey=function(t,e){var o=t.srcElement||t.target,n=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.metaKey;return!!(o&&e&&e.isEditing&&"gcEditingInput"===o.getAttribute(B))&&(13===n&&(r&&!t.shiftKey||i)||90===n&&r&&!i||89===n&&r&&!i||67===n&&(r||a)&&!i||88===n&&(r||a)&&!i)},e.prototype.isImeAware=function(t){return!0},e.prototype.toJSON=function(){var t,e={},o=this;for(t in o)o.hasOwnProperty(t)&&"_editingElement"!==t&&(e[t]=o[t]);return e},e}(l.Base),e.Text=gt,s._o[1]=gt},"./dist/core/core.definition.js":function(t,e){},"./dist/core/core.entry.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u;function c(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/core/core.res.en.js"),c(o("./dist/core/core.ns.js")),c(o("./dist/core/core.enum.js")),c(o("./dist/core/util/common.js")),c(o("./dist/core/util/domUtil.js")),o("./dist/core/core.definition.js"),n=o("./dist/core/util/common.js"),Object.defineProperty(e,"getTypeFromString",{set:function(t){n.getTypeFromString=t},get:function(){return n.getTypeFromString}}),a=-1,1===(i=(r=o("./dist/core/lc/releaseLc.js")).Soa)&&(a=Math.floor(5*Math.random()),e["G".concat("C","$")]["s".concat("d")]=a),c(o("./dist/core/util/theme.js")),c(o("./dist/core/util/basedialog.js")),c(o("./dist/core/util/imageLoader.js")),c(o("./dist/core/util/tasks.js")),0===a&&o("./dist/core/lc/lcRegister.js"),c(o("./dist/core/worksheet/stylehelper.js")),1===a&&o("./dist/core/lc/lcRegister.js"),c(o("./dist/core/worksheet/style.js")),2===a&&o("./dist/core/lc/lcRegister.js"),c(o("./dist/core/worksheet/clipboardhelper.js")),3===a&&o("./dist/core/lc/lcRegister.js"),c(o("./dist/core/worksheet/worksheet-model.js")),4===a&&o("./dist/core/lc/lcRegister.js"),c(o("./dist/core/worksheet/worksheet.js")),o("./dist/core/worksheet/worksheet-formatter.js"),c(o("./dist/core/worksheet/worksheet-actions.js")),c(o("./dist/core/worksheet/worksheet-border.js")),o("./dist/core/worksheet/worksheet-edit.js"),c(o("./dist/core/worksheet/worksheet-event.js")),o("./dist/core/worksheet/worksheet-json.js"),c(o("./dist/core/worksheet/worksheet-render.js")),o("./dist/core/worksheet/worksheet-selection.js"),o("./dist/core/worksheet/worksheet-sort.js"),c(o("./dist/core/worksheet/worksheet-ui.js")),c(o("./dist/core/worksheet/worksheet-static.js")),c(o("./dist/core/workbook/workbook.js")),o("./dist/core/workbook/workbook-json.js"),c(o("./dist/core/workbook/sheettabbase.js")),c(o("./dist/core/workbook/sheettab.js")),c(o("./dist/core/workbook/sheettab2007.js")),c(o("./dist/core/workbook/workbookpanelex.js")),s=o("./dist/core/celltype/cellType.entry.js"),e.CellTypes=s,l=o("./dist/core/celltype/headercelltype.js"),Object.defineProperty(s,"Corner",{set:function(t){t!==l.Corner&&(l.Corner=t)},get:function(){return l.Corner}}),Object.defineProperty(s,"ColumnHeader",{set:function(t){t!==l.ColumnHeader&&(l.ColumnHeader=t)},get:function(){return l.ColumnHeader}}),Object.defineProperty(s,"RowHeader",{set:function(t){t!==l.RowHeader&&(l.RowHeader=t)},get:function(){return l.RowHeader}}),u=o("./dist/core/celltype/textcelltype.js"),Object.defineProperty(s,"Text",{set:function(t){t!==u.Text&&(u.Text=t)},get:function(){return u.Text}}),s.vHb=l,s.wHb=u,1!==i&&2!==i||r.Gb(e)},"./dist/core/core.enum.js":function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.pixels=0]="pixels",t[t.continuous=1]="continuous"}(e.ScrollType||(e.ScrollType={})),function(t){t[t.setRowCount=0]="setRowCount",t[t.setColumnCount=1]="setColumnCount",t[t.addRows=2]="addRows",t[t.deleteRows=3]="deleteRows",t[t.addColumns=4]="addColumns",t[t.deleteColumns=5]="deleteColumns",t[t.setRowHeight=6]="setRowHeight",t[t.setColumnWidth=7]="setColumnWidth",t[t.setRowVisible=8]="setRowVisible",t[t.setColumnVisible=9]="setColumnVisible",t[t.filterRows=10]="filterRows",t[t.outlineExpandRows=11]="outlineExpandRows",t[t.outlineExpandColumns=12]="outlineExpandColumns"}(e.AxisInfoChangeType||(e.AxisInfoChangeType={})),function(t){t[t.hide=0]="hide",t[t.show=1]="show",t[t.active=2]="active",t[t.inactive=3]="inactive"}(e.ScrollbarState||(e.ScrollbarState={})),function(t){t[t.none=0]="none",t[t.column=1]="column",t[t.row=2]="row",t[t.both=3]="both"}(e.ShowResizeTip||(e.ShowResizeTip={})),function(t){t[t.skin=0]="skin",t[t.mobile=1]="mobile"}(e.ScrollbarAppearance||(e.ScrollbarAppearance={})),function(t){t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.both=3]="both"}(e.ShowScrollTip||(e.ShowScrollTip={})),function(t){t[t.right=0]="right",t[t.down=1]="down"}(e.InsertShiftCell||(e.InsertShiftCell={})),function(t){t[t.normal=0]="normal",t[t.split=1]="split"}(e.ResizeMode||(e.ResizeMode={})),function(t){t[t.noHeaders=0]="noHeaders",t[t.rowHeaders=1]="rowHeaders",t[t.columnHeaders=2]="columnHeaders",t[t.allHeaders=3]="allHeaders"}(e.CopyPasteHeaderOptions||(e.CopyPasteHeaderOptions={})),function(t){t[t.noHeaders=0]="noHeaders",t[t.rowHeaders=1]="rowHeaders",t[t.columnHeaders=2]="columnHeaders",t[t.allHeaders=3]="allHeaders"}(e.HeaderOptions||(e.HeaderOptions={})),function(t){t[t.default=0]="default",t[t.enhanced=1]="enhanced"}(e.ResizeZeroIndicator||(e.ResizeZeroIndicator={})),function(t){t[t.setFormula=0]="setFormula",t[t.copyPaste=1]="copyPaste",t[t.dragFill=2]="dragFill",t[t.dragDrop=3]="dragDrop",t[t.changePartOfArrayFormula=4]="changePartOfArrayFormula",t[t.changeSheetName=5]="changeSheetName",t[t.table=6]="table",t[t.filter=7]="filter",t[t.hideSheet=8]="hideSheet",t[t.sort=9]="sort",t[t.pivotTable=10]="pivotTable",t[t.ptOverlapValue=11]="ptOverlapValue",t[t.groupProtected=12]="groupProtected"}(e.InvalidOperationType||(e.InvalidOperationType={})),function(t){t[t.cell=0]="cell",t[t.cellWithHeader=1]="cellWithHeader"}(e.AutoFitType||(e.AutoFitType={})),function(t){t[t.all=0]="all",t[t.values=1]="values",t[t.formatting=2]="formatting",t[t.formulas=3]="formulas",t[t.valuesAndFormatting=4]="valuesAndFormatting",t[t.formulasAndFormatting=5]="formulasAndFormatting"}(e.ClipboardPasteOptions||(e.ClipboardPasteOptions={})),function(t){t[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.bottomLeft=3]="bottomLeft",t[t.bottomCenter=4]="bottomCenter",t[t.bottomRight=5]="bottomRight"}(e.LabelAlignment||(e.LabelAlignment={})),function(t){t[t.visible=0]="visible",t[t.hidden=1]="hidden",t[t.auto=2]="auto"}(e.LabelVisibility||(e.LabelVisibility={})),function(t){t[t.underline=1]="underline",t[t.lineThrough=2]="lineThrough",t[t.overline=4]="overline",t[t.doubleUnderline=8]="doubleUnderline",t[t.none=0]="none"}(e.TextDecorationType||(e.TextDecorationType={})),function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.general=3]="general"}(e.HorizontalAlign||(e.HorizontalAlign={})),function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom"}(e.VerticalAlign||(e.VerticalAlign={})),function(t){t[t.normal=0]="normal",t[t.superscript=1]="superscript",t[t.subscript=2]="subscript"}(e.VertAlign||(e.VertAlign={})),function(t){t[t.smallDecrement=0]="smallDecrement",t[t.smallIncrement=1]="smallIncrement",t[t.largeDecrement=2]="largeDecrement",t[t.largeIncrement=3]="largeIncrement",t[t.thumbPosition=4]="thumbPosition",t[t.thumbTrack=5]="thumbTrack",t[t.endScroll=6]="endScroll"}(e.Nxb||(e.Nxb={})),function(t){t[t.normal=0]="normal",t[t.highlight=1]="highlight",t[t.selected=2]="selected",t[t.active=3]="active",t[t.hover=4]="hover",t[t.activeNotSelected=5]="activeNotSelected"}(e.VisualState||(e.VisualState={})),function(t){t[t.ready=0]="ready",t[t.enter=1]="enter",t[t.edit=2]="edit"}(e.EditorStatus||(e.EditorStatus={})),function(t){t[t.auto=1]="auto",t[t.active=2]="active",t[t.inactive=4]="inactive",t[t.disabled=0]="disabled"}(e.ImeMode||(e.ImeMode={})),function(t){t[t.single=0]="single",t[t.range=1]="range",t[t.multiRange=2]="multiRange"}(e.SelectionPolicy||(e.SelectionPolicy={})),function(t){t[t.cell=0]="cell",t[t.row=1]="row",t[t.column=2]="column"}(e.SelectionUnit||(e.SelectionUnit={})),function(t){t[t.data=1]="data",t[t.style=2]="style",t[t.comment=4]="comment",t[t.tag=8]="tag",t[t.sparkline=16]="sparkline",t[t.axis=32]="axis",t[t.bindingPath=64]="bindingPath",t[t.hyperlink=256]="hyperlink"}(e.StorageType||(e.StorageType={})),function(t){t[t.blank=0]="blank",t[t.numbers=1]="numbers",t[t.letters=2]="letters"}(e.HeaderAutoText||(e.HeaderAutoText={})),function(t){t[t.dragDrop=0]="dragDrop",t[t.dragFill=1]="dragFill",t[t.clear=2]="clear",t[t.paste=3]="paste",t[t.sort=4]="sort",t[t.setArrayFormula=5]="setArrayFormula",t[t.evaluateFormula=6]="evaluateFormula"}(e.RangeChangedAction||(e.RangeChangedAction={})),function(t){t[t.normal=0]="normal",t[t.richText=1]="richText"}(e.ValueType||(e.ValueType={})),function(t){t[t.stretch=0]="stretch",t[t.center=1]="center",t[t.zoom=2]="zoom",t[t.none=3]="none"}(e.ImageLayout||(e.ImageLayout={})),function(t){t.ThumbButton="thumbButton",t.TrackButton="trackButton",t.LeftButton="leftButton",t.RightButton="rightButton",t.UpButton="upButton",t.DownButton="downButton"}(e.Oxb||(e.Oxb={})),function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.nearest=3]="nearest"}(e.HorizontalPosition||(e.HorizontalPosition={})),function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom",t[t.nearest=3]="nearest"}(e.VerticalPosition||(e.VerticalPosition={})),function(t){t[t.corner=0]="corner",t[t.colHeader=1]="colHeader",t[t.rowHeader=2]="rowHeader",t[t.viewport=3]="viewport"}(e.SheetArea||(e.SheetArea={})),function(t){t[t.none=0]="none",t[t.ascending=1]="ascending",t[t.descending=2]="descending"}(e.SortState||(e.SortState={})),function(t){t[t.hover=1]="hover",t[t.invalid=2]="invalid",t[t.readonly=4]="readonly",t[t.edit=8]="edit",t[t.active=16]="active",t[t.selected=32]="selected",t[t.dirty=64]="dirty"}(e.CellStatesType||(e.CellStatesType={})),function(t){t[t.hover=1]="hover",t[t.invalid=2]="invalid",t[t.readonly=4]="readonly",t[t.edit=8]="edit",t[t.active=16]="active",t[t.selected=32]="selected",t[t.dirty=64]="dirty",t[t.inserted=128]="inserted",t[t.updated=256]="updated"}(e.StatesType||(e.StatesType={})),function(t){t[t.always=0]="always",t[t.onSelected=1]="onSelected",t[t.onEditing=2]="onEditing"}(e.ButtonVisibility||(e.ButtonVisibility={})),function(t){t[t.none=0]="none",t[t.custom=1]="custom",t[t.clear=2]="clear",t[t.cancel=3]="cancel",t[t.ok=4]="ok",t[t.dropdown=5]="dropdown",t[t.ellipsis=6]="ellipsis",t[t.left=7]="left",t[t.right=8]="right",t[t.plus=9]="plus",t[t.minus=10]="minus",t[t.undo=11]="undo",t[t.redo=12]="redo",t[t.search=13]="search",t[t.separator=14]="separator",t[t.spinLeft=15]="spinLeft",t[t.spinRight=16]="spinRight",t[t.collapse=17]="collapse",t[t.expand=18]="expand"}(n=e.ButtonImageType||(e.ButtonImageType={})),n.calcel=n.cancel,function(t){t[t.colorPicker=0]="colorPicker",t[t.dateTimePicker=1]="dateTimePicker",t[t.timePicker=2]="timePicker",t[t.monthPicker=3]="monthPicker",t[t.list=4]="list",t[t.slider=5]="slider",t[t.calculator=6]="calculator",t[t.workflowList=7]="workflowList",t[t.multiColumn=8]="multiColumn"}(e.DropDownType||(e.DropDownType={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.leftOfText=2]="leftOfText",t[t.rightOfText=3]="rightOfText"}(e.ButtonPosition||(e.ButtonPosition={})),function(t){t[t.left=0]="left",t[t.right=1]="right"}(e.CaptionAlignment||(e.CaptionAlignment={})),function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(e.LayoutDirection||(e.LayoutDirection={})),function(t){t[t.inline=0]="inline",t[t.popup=1]="popup",t[t.tree=2]="tree"}(e.LayoutDisplayAs||(e.LayoutDisplayAs={})),function(t){t[t.year=1]="year",t[t.month=2]="month",t[t.day=3]="day"}(e.CalendarPage||(e.CalendarPage={})),function(t){t[t.monday=1]="monday",t[t.tuesday=2]="tuesday",t[t.wednesday=3]="wednesday",t[t.thursday=4]="thursday",t[t.friday=5]="friday",t[t.saturday=6]="saturday",t[t.sunday=7]="sunday"}(e.CalendarStartDay||(e.CalendarStartDay={})),function(t){t[t.none=0]="none",t[t.group=1]="group",t[t.child=2]="child",t[t.full=3]="full"}(e.GroupSort||(e.GroupSort={})),function(t){t[t.string=0]="string",t[t.array=1]="array"}(e.DropdownListValue||(e.DropdownListValue={})),function(t){t[t.solid=1]="solid",t[t.darkGray=2]="darkGray",t[t.mediumGray=3]="mediumGray",t[t.lightGray=4]="lightGray",t[t.gray125=5]="gray125",t[t.gray0625=6]="gray0625",t[t.darkHorizontal=7]="darkHorizontal",t[t.darkVertical=8]="darkVertical",t[t.darkDown=9]="darkDown",t[t.darkUp=10]="darkUp",t[t.darkGrid=11]="darkGrid",t[t.darkTrellis=12]="darkTrellis",t[t.lightHorizontal=13]="lightHorizontal",t[t.lightVertical=14]="lightVertical",t[t.lightDown=15]="lightDown",t[t.lightUp=16]="lightUp",t[t.lightGrid=17]="lightGrid",t[t.lightTrellis=18]="lightTrellis"}(e.PatternType||(e.PatternType={})),function(t){t[t.mask=0]="mask",t[t.overflow=1]="overflow"}(e.NumbersFitMode||(e.NumbersFitMode={})),function(t){t[t.bottom=0]="bottom",t[t.top=1]="top",t[t.left=2]="left",t[t.right=3]="right"}(e.TabStripPosition||(e.TabStripPosition={})),function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(e.HyperlinkTargetType||(e.HyperlinkTargetType={})),function(t){t[t.tableSheet=0]="tableSheet"}(e.SheetType||(e.SheetType={}))},"./dist/core/core.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/core/core.res.en.js");e.SR={en:n}},"./dist/core/core.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_NotSupported="NotSupportException",e.Exp_PasteExtentIsNull="pasteExtent is null",e.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",e.Exp_MultipleSelections="This action won't work on multiple selections.",e.Exp_ChangePartOfArray="Cannot change part of an array.",e.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",e.Exp_SrcIsNull="The argument 'src' is null",e.Exp_DestIsNull="The argument 'dest' is null",e.Exp_InvalidCustomFunction="invalid custom function",e.Exp_InvalidCustomName="invalid custom name",e.Exp_IndexOutOfRange="Index is out of range!",e.Exp_InvalidRange="Invalid range",e.Exp_NotAFunction="Not A Function",e.Exp_ArgumentOutOfRange="ArgumentOutOfRange",e.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",e.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",e.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",e.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",e.Tip_Row="Row: ",e.Tip_Column="Column: ",e.Tip_Height="Height: {0} pixels",e.Tip_Width="Width: {0} pixels",e.NewTab="New...",e.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",e.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",e.Exp_SheetNameConflict="That name is already taken. Try a different one.",e.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",e.Exp_DestSheetIsNull="destSheet is null",e.Exp_SheetIsNull="sheet is null.",e.Exp_OverlappingSpans="This operation will cause overlapping spans.",e.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",e.ARIA_Resize="resize",e.ARIA_First="first",e.ARIA_PreviousArrow="previous arrow",e.ARIA_NextArrow="next arrow",e.ARIA_Last="last",e.ARIA_PreviousButton="previous button",e.ARIA_NextButton="next button",e.ARIA_SheetTab="sheet tab",e.ARIA_NewSheet="new sheet",e.ARIA_Blank="blank",e.ARIA_Scrollbar_Left_Button="scrollbar left button",e.ARIA_Scrollbar_Top_Button="scrollbar top button",e.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",e.ARIA_Scrollbar_Right_Button="scrollbar right button",e.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",e.ARIA_Scrollbar_TRACK_Button="scrollbar track button",e.ARIA_Cell="cell",e.ARIA_HasValue="has value {0}",e.ARIA_HasFormula="has formula {0}",e.ARIA_HasComment="has comment {0}",e.ARIA_RowHeader="row header",e.ARIA_ColumnHeader="column header",e.SHEET_NAME="Sheet",e.lsru=["","6465706c6f796d656e74"],e.lsde=["","64657369676e6572"],e.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],e.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],e.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],e.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],e.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],e.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],e.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",e.Exp_InsertCopiedCutCellsOnSpanTable="This won’t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",e.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",e.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",e.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",e.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist."},"./dist/core/lc/common.js":function(t,e,o){"use strict";(function(t){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D;function F(){return D}function E(t,e){var o,n,r,i,a="",s=0;for(o=0;o<t.length;o++)s=Math.max(s,t[o].length);for(o=0;o<s;o++){for(e&&(n=""),i=0;i<t.length;i++)e?n+=o>=t[i].length?"00":t[i].charAt(o)+t[i].charAt(o+1):o<t[i].length&&(a+=t[i].charAt(o));e&&(r=parseInt(n,16),a+=String.fromCharCode(r),o++)}return a}function j(t,e,o){var n,r=E(["Lcnee","iesKy"]),i=F()[r];return u(i,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},(function(r){(n=P(r,"VIEE")).hl=!!i,n.m=i?n.m:-1,e.call(t,n),G(n,t,i,o)}),(function(){(n=P()).hl=!!i,n.m=i?n.m:-1,e.call(t,n),G(n,t,i,o)})),n}function P(t,e){var o,n,r,i,a={isVd:function(t){var e=this;return t=1===F().Workbook.lm||t,e.s&&!e.e&&(!e.adr||!!e.adr.dsr==!!t)}},s=function(){var t=c(N);return function(t){var e=c("VdgJHc#wJb59"),o=c("Zdg3Ga#UHbw5");return t&&(function(t){var e=c("MlSZto#Z");return t&&t===e}(t[e])||function(t){var e=c("yXbog&w");return t&&t===e}(t[e])||function(t){var e=c("4LJITMx8UMcA"),o=c("jOxo"),n=c("JYw3Gb4NOb6x"),r=c("g1Jbww#Y"),i=RegExp("^[\\w\\-]+\\."+r+"$","i");return t&&(t===e||t===o||t===n||d.test(t)||i.test(t))}(t[o]))}(p[t])}();return a[C]=s,a.s=function(){var a,l,u,c,f,h,p;if(!t)return!1;if(!(a=t[S])||!a.length)return!1;for(c=0,f=a.length;c<f;c++)if(u=(l=a[c])&&l[A]===e){o=l[x];break}if(!u)return!1;if(t[k]&&(i=t[k]),t[M]){if(h=new Date,p=function(t){return new Date(L(t.substr(0,4))||0,L(t.substr(4,2))-1||0,L(t.substr(6,2))||0)}(t[M]),r=Math.ceil((p-h)/864e5),n=r<=0)return!1}else r=void 0;return!!(s||!t[I]&&!t[R]||_(t[I],t[R])||V(t[I],t[R]))}(),a[m]=t?t[T]?-1:1:0,a[y]=o,a[b]=n,n||(a[v]=r),a[w]=i,a}function L(t){return parseInt(t,10)}function G(t,e,o,n){var r,i,a,s,l;H(t)?(t&&t.adr&&!0!==t.adr.dsr&&(r=t.adr.flg||[],i={},a=t.m,s=t.d,F().Workbook.ao(e,"adlc",{flg:r,checkRs:i,m:a,d:s,fn:B}),void 0!==i.nwm&&(t.wm=i.wm,t.nwm=i.nwm,i.dis&&((l=t.disL||[]).push(E(["",i.dis],!0)),t.disL=l),i.state&&(t[i.state[0]]=i.state[1]))),o||(i={},a=t.m,s=t.d,1,1!==F().Workbook.lm&&F().Workbook.ao(e,"adlc",{flg:[],checkRs:i,m:a,d:s,nl:1}),void 0!==i.nwm&&(t.wm=i.wm,t.nwm=i.nwm)),n||e.repaint&&!e.Js&&e.repaint()):z(e,t)}function B(t,e,o){var n,r=["rs"];t&&(t[n=E(["",e],!0)]&&t[n][o+r]&&t[n][o+r]())}function _(t,e){var o,n,r,i;return!!(function(){var t=c(N),e=c("VdgJHc#wJb59"),o=c("Udg36Y#oUddV"),n=p[t];return n&&n[e]===o}()&&(o=c(N),n=c("1agFGc#UHbw5"),r=p[o]&&p[o][n],r&&(r=r.toLowerCase(),i=t.split(","),t&&function(t,e){var o,n,r,i;if(!t||0!==t.indexOf("//"))return!1;if((o=t.slice(2).split("/")).length<1)return!1;for(n=o[0],r=0,i=e.length;r<i;r++)if(e[r]===n)return!0;return!1}(r,i))))}function V(t,e){var o,n=c(N),r=c("Zdg3Ga#UHbw5"),i=p[n]&&p[n][r];return!i||(i=i.toLowerCase(),o=t.split(","),!(!t||!function(t,e){var o,n,r,i,a;for(o=0,n=e.length;o<n;o++){if(i=!1,(r=e[o])&&0===r.lastIndexOf("*.",0)&&(i=!0),(r=i?r.slice(2):r)===t)return!0;if(i&&(a=t.indexOf("."+r))>0&&a===t.length-r.length-1)return!0}return!1}(i,o))||!(!t||!function(t,e){var o,n,r,i;if(t&&4===t.split(".").length)for(o=0,n=e.length;o<n;o++)if((r=e[o])&&(i=r.length-2)>0&&(r===t||".*"===r.substr(i)&&t.substr(0,i)===r.substr(0,i)&&g.test(t)))return!0;return!1}(i,o)))}function H(t){return t&&(t.isVd(!1)||t.b&&!t.hl)}function z(t,e){var o,n;function r(){n.width=i.GC$(o).width(),n.height=i.GC$(o).height(),function(t,e,o,n){var r,i,a,l,u,c,f="16pt calibri";if(!n||!n.isVd(!1))for(r=n.hl?n.adr&&n.adr.dsr?"l4":n.e?"l5":"l4":"l3",i=W(r,O,n),s(t,f),t.fillStyle="black",t.fillRect(0,0,e,o),t.fillStyle="white",a=20,l=30,u=0;u<i.length;u++)c=i[u],t.fillText(c,a,l),l+=25}(n.getContext("2d"),n.width,n.height,e)}t.oJc||(t.oJc=!0,o=t.qo,t.sheets=[],t.pJc=[],t.no(),o&&(n=document.createElement("canvas"),o.appendChild(n),r(),i.GC$(window).bind("resize",(function(){setTimeout(r,100)}))))}function U(t){return new n.Common.ResourceManager(r.SR).getResource()[t]}function W(t,e,o){var n,r,i,a,s,l,u,c,f=U(E([t,"s"])),h=U(1===F().Workbook.lm?E(["ld","se"]):E(["lr","su"])),p=q(f,e);for(h=q(h,e),p=(p=p.replace("{0}",o.d)).replace("{1}",h).replace("{1}",h),n=[],r=0,i=0;i<p.length;i++)"\r"!==p[i]&&"\n"!==p[i]||(n.push(p.substring(r,i)),"\r"===p[i]&&i<p.length-1&&"\n"===p[i+1]&&i++,r=i+1);for(r<p.length&&n.push(p.substring(r,p.length)),s=[],l=0,u=(a=o.wm||[]).length;l<u;l++)c=a[l],s.push(""),c instanceof Array?s.push(E(c,!0)):s.push(E(["",c],!0));return 1===o.m&&o.nwm?[].concat(s):o.wm&&o.wm.length>0?n.concat(s):n}function q(t,e){var o,n,r,i=!0,a="";if(t)if("string"==typeof t)(t=t.trim())&&(o=[t]);else if(Array.isArray(t)){for(n=!0,o=[],r=0;r<t.length;r++)a=t[r].trim(),o.push(a),n&&a&&(n=!1);n&&(o=null)}return o||(i=!1,o=e),E(o,i)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/core.ns.js"),i=o("./dist/core/util/domUtil.js"),a=o("./dist/core/util/common.js"),s=a.Ul.lZa,l=o("./dist/core/lc/lcValidator.js"),u=l.mJc,c=l.nJc,f="object"==typeof t&&t&&t.Object===Object&&t,h="object"==typeof self&&self&&self.Object===Object&&self,p=f||h||Function("return this")(),d=/^[\w\-]+$/i,g=/^[0-9.]+$/,m="m",y="n",C="b",v="d",b="e",w="adr",T=c("XRsZ"),S=c("HUkJ"),x=c("T&g"),A=c("Q&w"),I=c("GRz1"),R=c("XSzB"),M=c("XRwh"),k=c("WQs5"),N="JYx3Gb#8Pb5R",O=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"],e.mJc=j,e.Gb=function(t,e){var o,n,r,i,a,s,l,u,c,f;D=e,n=e.Workbook.prototype,r=n.ad,n.ad=function(){var t=this;if(j(t,(function(e){t.ls=e,o=e,t.ul=function(){j(t,(function(e){t.ls=e,o=e}))}})),!o||H(o))return r.apply(t,arguments)},e.PivotTableManager&&(i=e.PivotTableManager.prototype,a=i.Lla,i.Lla=function(){a.apply(this,arguments),o||this.parent||j(this,(function(t){o=t}))}),s=e.Worksheet.prototype,l=s.ad,s.ad=function(){if(o||this.parent||j(this,(function(t){o=t})),!o||H(o))return l.apply(this,arguments)},u=e.oJ.prototype,c=u.Pw,u.Pw=function(e,n){c.apply(this,arguments),(o&&(-1===o.m||!o.hl&&o.b)||o&&o.m&&o.nwm&&(1===o.m||1===o.m&&void 0===o.d))&&t(this.kj,e,n,o)},f=u.RI,u.RI=function(e,n){f.apply(this,arguments),o&&(-1===o.m||!o.hl&&o.b)&&t(this.kj,e,n,o)}},e.Hhc=z,e.e6=W,e.qJc=function(t){return U(E([t,"sa"]))}}).call(this,o("./node_modules/webpack/buildin/global.js"))},"./dist/core/lc/lcRegister.js":function(t,e,o){"use strict";var n,r,i,a,s;function l(t){if(s=null,a[0])try{var e=a[0].tc;e&&e.qo&&n.mJc(e,(function(o){var r,i,a,s,l,u=e.getActiveSheet();if(u&&((r=u.l)&&(o=r),t||r||o.b||-1!==o.m||!o.d||(o.s=!1,n.Hhc(e,o)),o.nwm))for(i=0,a=o.disL||[];i<a.length;i++)(s=u[a[i]])&&((l=s.adrs)&&l.apply(s))}),!0)}finally{a=[]}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/lc/releaseLc.js"),i=(r=o("./dist/core/util/domUtil.js")).GC$.sd,a=[],r.GC$[i]=function(t,e){a.push(t),e?l(e):s||(s=setTimeout(l,5e3*Math.random()+3e3))}},"./dist/core/lc/lcValidator.js":function(t,e){var o=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}return o.m=t,o.c=e,o.p="dist",o(0)}([function(t,e){(function(t){"use strict";var o,n,r,i,a,s,l,u;function c(t,e,o,n){return 1==t.length||t.splice(o,1,n(t.splice(e,1,n(t[o]))[0])),t}function f(t){var e,o=t.split(""),n=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=t.charCodeAt(0);return o>=65&&o<=90?t.toLowerCase():o>=97&&o<=122?t.toUpperCase():o>=48&&o<=57?r(48+(o-48+10+e)%10):t}(t,-1)};for(e=o.length-5;e>=0;e--)c(o,e+1,e+3,n),c(o,e,e+2,n);return o.join("")}function h(t){var e,o,n,r,i,s,l=[],u="",c=a,f=t,h=f.length%3;if(h>0)for(;h++<3;)u+="=",f+="\0";for(h=0;h<f.length;h+=3)o=(e=f.charCodeAt(h)<<16|f.charCodeAt(h+1)<<8|f.charCodeAt(h+2))>>18&63,n=e>>12&63,r=e>>6&63,i=63&e,l[h/3]=c.charAt(o)+c.charAt(n)+c.charAt(r)+c.charAt(i);return(s=l.join("")).slice(0,s.length-u.length)+u}function p(t){var e,o,n,i,s,l,u,c=[],f=a,h=t;for(u=0;u<h.length;u+=4)e=(l=f.indexOf(h.charAt(u))<<18|f.indexOf(h.charAt(u+1))<<12|(i=f.indexOf(h.charAt(u+2)))<<6|(s=f.indexOf(h.charAt(u+3))))>>>16&255,o=l>>>8&255,n=255&l,c[u/4]=r(e,o,n),64==s&&(c[u/4]=r(e,o)),64==i&&(c[u/4]=r(e));return c.join("")}function d(t){return(n&&window.atob||p)(t)}function g(t){return(n&&window.btoa||h)(t)}function m(t){return g(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return r(parseInt(e,16))})))}function y(t){var e,o;return t?(e=function(t){return t.split("").reverse().join("")}(e=f(t)),o=Math.ceil(e.length/2),function(t){return decodeURIComponent(Array.prototype.map.call(d(t),(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(e=(e=(e=e.substr(o)+e.substr(0,o)).replace("#","=")).replace("&","=="))):""}function C(t){var e,o=d(t),n=o.length,r=new i(n);for(e=0;e<n;e++)r[e]=o.charCodeAt(e);return r.buffer}function v(t){var e,o,n=new ArrayBuffer(t.length),r=new i(n);for(e=0,o=t.length;e<o;e++)r[e]=t.charCodeAt(e);return n}function b(t){return r.apply(null,new i(t))}function w(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function T(t){return"oncomplete"in t&&(t.then=function(e,o){t.resolve=e,t.reject=o},t.oncomplete=function(e){t.resolve(t.result)},t.onerror=function(){t.reject()}),t}Object.defineProperty(e,"__esModule",{value:!0}),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n="undefined"!=typeof window,r=String.fromCharCode,i=n&&window.Uint8Array||function(t){var e,n;if("number"==typeof t)for(e=Array(t),n=0;n<t;++n)e[n]=0;else e=t.slice(0);return e.buffer=e,e.byteLength=e.length,"object"===(void 0===t?"undefined":o(t))&&t.buffer&&(e.buffer=t.buffer),e},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="object"==(void 0===t?"undefined":o(t))&&t&&t.Object===Object&&t,l="object"==("undefined"==typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,u=s||l||Function("return this")(),e.iDe=y,e.attorn=function(t,e,o,r){var i,a,s,l,c,f,h,p=n?window.msCrypto?window.msCrypto:window.crypto:void 0,d=function(t,e){try{e="#"+e;var o=t.indexOf(e);if(o>-1)return{prefix:t.substring(0,o),licData:JSON.parse(y(t.substr(o+e.length)))}}catch(t){}return!1}(t,e.aC);if(!d)return r();function g(){return function(t){var e,o,n,r=0,i=5381,a=0;for(e=t.length-1;e>=0;e--)r=(o=t.charCodeAt(e))+(r<<6)+(r<<16)-r,i=o+((i<<5)+i),a=o+((a<<5)-a),a&=a;return(n=r^i^a)<0&&(n=~n),n.toString(16).toUpperCase()}(a+JSON.stringify(i.D))===i.H?o(i.D):r()}return i=d.licData,a=d.prefix+"#"+e.aC,s=b(C(m(a+JSON.stringify(i.D)))),l=y("JYx3Gb#8Pb5R"),c=y("VdgJHc#wJb59"),u[l]&&u[l][c]&&!location.protocol.match(/^https/i)?g():p&&p.subtle?(f={alg:"RS256",e:"AQAB",kty:"RSA",n:w(e.pK)},f=window.msCrypto?v(JSON.stringify(f)):f,h={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},void T(p.subtle.importKey("jwk",f,h,!1,["verify"])).then((function(t){T(p.subtle.verify(h,t,C(i.S),v(s))).then((function(t){return t?o(i.D):r()}))}),(function(){return g()}))):g()}}).call(e,function(){return this}())}]);t.exports={mJc:o.attorn,nJc:o.iDe}},"./dist/core/lc/releaseLc.js":function(t,e,o){"use strict";var n,r,i,a,s;function l(t,e,o,r){var l,u,c,f,h,p,d,g,m=t.am(),y=t.parent,C="11pt calibri",v=r.hl&&r.isVd(!1)&&r.d,b=y&&y.jDc,w="";for(v?l="l2":r.e?l="l5":r.hl&&!r.d?l="l6":(l="l1",u=n.qJc(l)),m=m||t.am(),c=n.e6(l,a,r),f=0,u&&c.forEach((function(e){f=s(f,t.dp(e,C))})),t.l=c[0]?r:void 0,h=0;h<c.length&&(m.width>203||m.height>203)&&!b;h++)w=c[h],p=f||t.dp(w,C),10,20,d=m.width-p-10,g=m.height-10-20*(c.length-h),o&&!o.intersect(d,g,p,20)||(e.save(),e.fillStyle="rgba(0, 0, 0, 0.5)",i(e,C),o&&(e.rect(o.x,o.y,o.width,o.height),e.clip(),e.beginPath()),e.fillText(w,d,g+20),w&&(t.l=r),e.restore())}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/lc/common.js"),r=o("./dist/core/util/common.js"),i=r.Ul.lZa,a=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],s=Math.max,e.Gb=function(t){n.Gb(l,t)},e.Soa=1,e.mJc=n.mJc,e.Hhc=n.Hhc},"./dist/core/util/basedialog.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/common.js"),r=o("./dist/core/util/domUtil.js"),i=r.GC$,a=n.util.Nl,s=n.util.Ml,l=n.util.nl,u=document,c=window,f=c.Yl,h=function(){function t(t,e,o){this.c4="gc-popup",this.so="gc-overlay",this.AWa=null;var n=this;n.qo=t,n.zWa=o,e=e||0,n.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:e,backgroundColor:"rgba(0,0,0,0)"},n.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:e+1,outline:"none"},n.ad()}return t.prototype.ad=function(){var t=this;t.vo(t.Cj)?t.xo=i("#"+t.Cj):(t.Cj=t.wo(),t.xo=i(a("div")).addClass(t.c4+" ui-widget").attr({id:t.Cj,tabIndex:-1}).css(t.uo))},t.prototype.wo=function(){for(var t=0,e="gc-dialog";this.vo(e+""+t);)t++;return e+""+t},t.prototype.yo=function(){if(this.xo)return this.xo},t.prototype.zo=function(){return this.qo?this.qo:u.body},t.prototype.Ao=function(t){var e=this,o=e.xo;e.Bo()||e.Co(),f.Gm(),e.vo(e.Cj)||(i(e.zo()).append(o),e.Do(),o.css("display","none")),o.show(t)},t.prototype.cXa=function(){return"block"===this.xo.css("display")},t.prototype.close=function(){var t=this;t.vo(t.Cj)&&t.xo.remove(),i("."+t.c4).isVisible()||t.Eo(),f.Hm()},t.prototype.Eo=function(){i("."+this.so).remove(),this.AWa=null},t.prototype.Do=function(){var t,e,o,n,r,a,s,l,c,f,h,p=this.xo,d=this.zo();0!==p.length&&(t=i(d).offset(),e=parseInt(p.css("left"),10)+t.left,o=parseInt(p.css("top"),10)+t.top,n=p.width(),r=p.height(),isNaN(e)||isNaN(o)||isNaN(n)||isNaN(r)||(a=0,s=0,c=(l=u.documentElement).clientWidth,f=l.clientHeight,(h=p[0].getBoundingClientRect()).left+n>c&&(s=h.left+n-c),h.top+r>f&&(a=h.top+r-f),(e<0||o<0||a>0||s>0)&&((e-=s)<0&&(e=0),(o-=a)<0&&(o=0),p.css({left:e-t.left+"px",top:o-t.top+"px"}))))},t.prototype.vo=function(t){return i("#"+t).length>0},t.prototype.Co=function(){var t,e,o=this,n=i(a("div")).addClass(o.so),r=o.xo;this.AWa=n,n.css(o.to),i(o.qo).append(n),(t=s&&s.mozilla)&&(e=(new Date).valueOf()),n.bind("mousedown",(function(n){if(!o.zWa){if(t)if((new Date).valueOf()-e<100)return;o.close(),t&&o.Fo&&clearTimeout(o.Fo)}l(n)})),n.bind("contextmenu",(function(t){o.zWa&&l(t)})),r.bind("contextmenu",(function(t){l(t)})),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(e){n.bind(e,(function(e){o.zWa||(t?o.Fo=c.setTimeout((function(){o.close()}),100):o.close()),l(e)}))}))},t.prototype.Bo=function(){return i("."+this.so).length>0},t}(),e.Go=h},"./dist/core/util/common.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt;function it(t){return void 0!==t}function at(t){return v.createElement(t)}function st(t){v.body&&v.body.insertBefore(t,S)}function lt(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function ut(t){var e,o,n=!1;if(t)for(e=0;e<t.length;e++)if((o=t.charCodeAt(e))>=11904&&o<12032||o>=12288&&o<40960||o>=43360&&o<43392||o>=63744&&o<64256){n=!0;break}return n}function ct(t,e){var o=at("span");return o.className=t,e&&(o.id=e),o.style.display="none",st(o),o}function ft(t,e,o,n){t.addEventListener(e,o,n)}function ht(t){var e=t.currentStyle,o=v.defaultView;return o&&o.getComputedStyle&&(e=o.getComputedStyle(t,"")),e}function pt(t){var e,o,n,r,i,a,s=C.Yl;s.jm>0||(16!==t.keyCode&&(s.XCb=!0),(o=(e=H.Xl())&&e.lm)&&l(o).isVisible()||e&&e.mm&&e.mm.nm&&(e.mm.nm(t),e.isEditing()||(n=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.shiftKey,90!==n&&89!==n||!r||i?86!==n||!r||i||a||t.stopPropagation&&t.stopPropagation():lt(t))))}function dt(t){var e,o=C.Yl;o.jm>0||(o.XCb=!1,(e=H.Xl())&&e.mm&&e.mm.om&&e.mm.om(t))}function gt(t){var e;C.Yl.jm>0||(e=H.Xl())&&e.mm&&e.mm.pm&&e.mm.pm(t)}function mt(t){var e,o=C.Yl;o.jm>0||!0!==o.XCb&&((e=H.Xl())&&e.mm&&e.mm.pm&&e.mm.pm(t))}function yt(t){return v.all===T&&H.Xl()&&lt(t),!1}function Ct(t,e){var o=I(t.row,e.row),n=I(t.col,e.col),r=R(t.row+t.rowCount-1,e.row+e.rowCount-1),i=R(t.col+t.colCount-1,e.col+e.colCount-1);return o>=0&&n>=0?new X(o,n,r-o+1,i-n+1):o>=0?new X(o,-1,r-o+1,-1):n>=0?new X(-1,n,-1,i-n+1):new X(-1,-1,-1,-1)}function vt(t){var e=t.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.An=e,e}function bt(t,e){t&&(t.Gn=e)}function wt(t,e){t&&(t.Hn=e)}function Tt(){return ot.Yn||(ot.Yn=at("canvas").getContext("2d")),ot.Yn}function St(t){var e,o,n,r=[],i=0,a=F;for(e=0;e<t.length;e++)r[i]===T&&(r[i]=""),o=t.charAt(e),n="",e+1<t.length&&(n=t.charAt(e+1)),o===a&&n!==a||"-"===o&&"-"!==n?(r[i]+=o,i++):r[i]+=o;return r}function xt(t){for(var e=t.length-1;" "===t.charAt(e);)e--;return e!==t.length-1&&(t=t.substring(0,e+1)),t}function At(t){var e,o=t instanceof Array?[]:{};for(e in t)t.hasOwnProperty(e)&&(o[e]="object"==typeof t[e]&&t[e]!==S?At(t[e]):t[e]);return o}function It(t,e,o,n,r){var i,a,s,l,u,c,f,h,p=[],d=r||Tt();if(!d)return p;for(o?(s=t.length*n,a=A(e/n)):(i=(s=V(d,d.font,t))/t.length,a=A(e/i));s>e&&t;)for(l=!1,u=a;;){if(t.length<u){p.push(t),t="";break}if(c=t.substring(0,u),f=o?u*n:V(d,d.font,c),"-"===c.charAt(c.length-1)&&(f=o?u*n:V(d,d.font,c)-V(d,d.font,"-")),f===e||l&&f<e){p.push(c),t=t.substring(u),s-=f;break}if(f>e){if(1===c.length){t.substring(c.length).trim()?(p.push(c),t=t.substring(u),s-=f):(p.push(t),t="");break}u-=1,l=!0}else u+=h=(h=o?(e-f)/n:(e-f)/i)>=1?h:1}return t&&-1===t.search(/^[ ]*$/)&&p.push(t),p}function Rt(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m=i||Tt();if(!m)return[t];for(a=[],s=0,l=e,u=[],c=0;c<t.length;c++)if(f=t[c].style&&t[c].style.font||r,h=_.fp(f),t[c].text&&t[c].text.length>0?s+=n?h*t[c].text.length:V(m,f,t[c].text):s=0,s<l)u.push(t[c]);else for(s-=n?h*t[c].text.length:V(m,f,t[c].text),p=0;p<t[c].text.length;p++){if((d=n?h:V(m,f,t[c].text.charAt(p)))>o&&0===p){u.length>0&&(a.push(u),u=[]),u.push({style:t[c].style,text:t[c].text.substring(0,1)}),a.push(u),u=[],(g=t[c].text.substring(1,t[c].text.length)).length&&t.splice(c+1,0,{style:t[c].style,text:g}),s=0,l=o;break}if((s+=d)>l){u.push({style:t[c].style,text:t[c].text.substring(0,p)}),a.push(u),u=[],(g=t[c].text.substring(p,t[c].text.length)).length&&t.splice(c+1,0,{style:t[c].style,text:g}),s=0,l=o;break}}return u.length>0&&a.push(u),a}function Mt(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,C,v=[],b=St(t),w=r||Tt();if(!w)return v;for(i=V(w,w.font,t),a=o?n:i/t.length,s=k(e/a+"",10),l=0,u=0,c=0,f=0,h=[],p=!1;f<b.length;){if(!1===p){if(d=b[f],h.push(d),(u+=d.length)<s&&f<b.length-1){f++;continue}c=u,u=0}if(g=o?h.join("").length*n:ot.Xn(h.join(""),w.font,!0,w),"-"===h.join("").charAt(h.join("").length-1)&&(g=o?h.join("").length*n:V(w,w.font,h.join(""))-V(w,w.font,"-")),g>e)if(m=h.pop(),0===h.length){for(y=It(m,e,o,n,w),C=0;C<y.length-1;C++)v[l]=y[C],l++;1===y.length&&(v[l]=y[0],l++),y.length>=2?b[f]=y[y.length-1]:f++,p=!1}else p=!0,f--;else g<e&&!0===p||g===e?(p=!1,v[l]=xt(h.join("")),l++,h=[],f++):g<e&&(f++,u=c)}return 0!==h.length&&(v[l]=xt(h.join(""))),v}function kt(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,g,m=[],y=r||Tt();if(!y)return m;if(0===t.length)return m.push({textLength:0,text:"",textInfos:[{style:{font:o},text:""}]}),m;for(i=0,a=[],s=0;s<t.length;s++){for(l=t[s],u=0,0,c=0;c<l.length;c++)void 0,f=l[c].style&&l[c].style.font?l[c].style.font:o,n?u+=_.fp(f)*l[c].text.length:d(l[c].text)||(u+=V(y,f,l[c].text));if(u>e){for(a.length>0&&(m.push({textLength:i,text:xt(Ot(a)),textInfos:At(a)}),a=[],i=0),h=Rt(l,e-i,e,n,o,y),a=a.concat(h[0]),d(h[0])||m.push({textLength:i+Nt(h[0],o,n,y),text:xt(Ot(a)),textInfos:At(a)}),a=[],i=0,p=1;p<h.length-1;p++)d(h[p])||m.push({textLength:Nt(h[p],o,n,y),text:xt(Ot(h[p])),textInfos:At(h[p])});h.length>1&&(g=h[h.length-1],a=a.concat(g),d(g)||(i+=Nt(g,o,n,y)))}else i+u>e?(m.push({textLength:i,text:xt(Ot(a)),textInfos:At(a)}),a=(a=[]).concat(l),i=u):(a=a.concat(l),i+=u)}return a.length>0&&m.push({textLength:i,text:xt(Ot(a)),textInfos:At(a)}),m}function Nt(t,e,o,n){var r,i,a=0,s=n||Tt();for(r=0;r<t.length;r++)i=t[r].style&&t[r].style.font||e,a+=o?_.fp(i)*t[r].text.length:V(s,i,t[r].text);return a}function Ot(t){var e,o="";for(e=0;e<t.length;e++)o+=t[e].text;return o}function Dt(t){return t&&"SPAN"===t.tagName}function Ft(t){return t&&"BR"===t.tagName}function Et(t){return t instanceof Text}function jt(t){if(t){var e=t.childNodes;return Dt(t)&&2===e.length&&Ft(e[0])&&Pt(e[1])}return!1}function Pt(t){if(t&&Et(t)){var e=t.textContent;if(1===e.length&&Bt(e[0]))return!0}return!1}function Lt(t,e,o,n,r,i){var a,s,l,u,c,f="",h=t.childNodes,p=h.length;for(a=0;a<p;a++)Dt(s=h[a])?f+=Lt(s,e,o,n,r,i):Et(s)?(l=e&&e.startContainer,u=e&&e.endContainer,c=s.textContent,s===l||s===u?l!==u?s===l?(f+=Gt(c,o,c.length,r),i=!0):(f+=Gt(c,0,n,""),i=!1):f+=Gt(c,o,n,r):i||(f+=c)):Ft(s)&&!i&&(f+="\n");return f}function Gt(t,e,o,n){return t.substr(0,e)+n+t.substr(o,t.length-o)}function Bt(t){return t===B}function _t(t,e){for(var o=t&&t.previousSibling;o;){if(e(o))return o;o=o.lastChild}return S}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/domUtil.js"),i=o("./dist/core/core.ns.js"),a=o("./dist/core/core.enum.js"),s=o("@grapecity/js-calc"),l=r.GC$,u=l.extend,c=n.Common.o,f=n.Common.k.Uo,h=n.Formatter&&n.Formatter.GeneralFormatter,p=n.Formatter&&n.Formatter.lxb,d=n.Common.j.Fa,g=n.Common.u,m=new n.Common.ResourceManager(i.SR),y=m.getResource.bind(m),e.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',C=window,v=document,b="boolean",w="date",T=void 0,S=null,x=Math.floor,A=Math.ceil,I=Math.min,R=Math.max,M=Math.round,k=parseInt,N=parseFloat,O=isNaN,D="px",F=" ",E=".",j="string",P="number",L=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),G=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),B="​",e.productInfo={productVersion:"14.2.6"},e.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},e.getTypeFromString=function(t){var e,o,n,r=!1,i=C;if(typeof t===j){for(o=0,n=(e=t.split(E)).length;o<n&&i;o++)i=i[e[o]];i&&o===n&&n>0&&(r=!0)}return r?i:T},e.findControl=function(t){return typeof t===j&&(t=v.getElementById(t)),l(t).data("workbook")},_=function(){function t(){}return t.xq=function(t){for(var e,o="";t>0;t=parseInt((t-1)/26+"",10))e=(t-1)%26,o=String.fromCharCode(65+e)+o;return o},t.ol=function(e,o,n,r){if(3===e){var i=l.getType(o);e=n&&"@"===n?0:i===b?1:i===P||i===w||i===j&&t.YGb(o)?2:0,r&&0!==r&&(r>0?e=0:r<0&&(e=2),-90===r?e=0:90===r&&(e=2))}return e},t.YGb=function(e){return t.ZGb.test(e)},t.bc=function(e){var o,r=l.getType(e);return e===S||e===T?e="":r===b?e=(""+e).toUpperCase():r===w?(o=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds(),e=n.Common.l.Vb(e,o?"M/d/yyyy":"M/d/yyyy h:mm:ss")):e=e.richText?t.K_a(e):""+e,e},t.ql=function(t,e,o,n,r,i,a){var s,u,c,f,h,p,d=l(t),g=e,m=o,y="background-position",C="background-size",v="auto",b="0%",w="100%";switch(i){case 0:a?d.css(y,a.position).css(C,a.size):d.css(y,b+F+b).css(C,w+F+w);break;case 1:s="50%",u="50%",n>g&&(s=b),r>m&&(u=b),d.css(y,s+F+u).css(C,v+F+v);break;case 2:c=0,f=0,h=g,p=m,m>0&&r>0&&g/m>n/r?c=c+g/2-(h=n/r*m)/2:g>0&&n>0&&m/g>r/n&&(f=f+m/2-(p=r/n*g)/2),d.css(y,c+D+F+f+D).css(C,h+D+F+p+D);break;case 3:d.css(y,b+F+b).css(C,v+F+v)}},t.device=function(){var t,e,o,n,r=navigator.userAgent,i=r.match(/iPad/i);if(i)(t=i[0])&&(e="ipad"===t.toLowerCase());else if((i=r.match(/Macintosh/i))&&(t=i[0]))try{document.createEvent("TouchEvent"),e="macintosh"===t.toLowerCase()}catch(t){}return(i=r.match(/iPhone/i))&&((t=i[0])&&(o="iphone"===t.toLowerCase())),(i=r.match(/android/i))&&((t=i[0])&&(n="android"===t.toLowerCase())),{ipad:e,iphone:o,android:n}},t.sl=function(){var t=navigator.platform;return t&&t.indexOf("Mac")>-1},t.tl=function(t){if(t===T||t===S)return!1;var e=""+t;return e=c.Oa(e),!O(+(""===e.trim()?NaN:e))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(e)},t.ul=function(e,o,n,r,i){var a,s,l,u,c,f,p=S,d=!1;if(e&&((a=e.formatter)?(i?p=i:t.lHb(a)||(p=a,d=!0),typeof p===j&&h&&(p=new h(p))):p=e._autoFormatter),p&&!p.isAuto){s=S;try{if(s=p.parse(o),d&&s instanceof Date&&((l=(new h).getPreferredDisplayFormatter(o,i))&&(s=l.parse(o))),typeof s===P)return s}catch(t){}return s===T||s===S?o:s}if(n){if(u=void 0,u={},c=void 0,f=S,h)try{f=(new h).getPreferredDisplayFormatter(o,u)}catch(t){}return typeof(c=u.value)===P?o=c:t.tl(o)&&(c=u.value=o),r&&(r.value=f),c!==T&&c!==S?c:o}return o},t.vl=function(t){for(var e,o,n=v.body,r=t;r&&r.parentElement&&r.parentElement!==n;)r=r.parentElement;return e=1e3,r&&r.parentElement===n&&(o=k(l(r).css("z-index")),O(o)||(e+=o)),e},t.wl=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d,g;if(!t)return[];if(e=t.indexOf("("),o=t.lastIndexOf(")"),!(n=t.substring(e+1,o)))return[];for(r=[],i=0,a="",s=0,l=0;l<n.length;)s=n.indexOf("rgb",i),-1===(l=n.indexOf("rgb",i+1))&&(l=n.length),a=n.substring(s,l),r.push(a),i=l;for(u=[],c=0,f=r.length;c<f;c++)p=(h=r[c]).indexOf(")"),d=h.substring(0,p+1),g=N(h.substring(p+1,h.length)),O(g)&&(c===f-1?g=100:c<=1&&(g=0)),(d||0!==c)&&(g/=100,u.push({color:d,point:g}));return u},t.xl=function(e,o,n,r,i){var s,l,u,c,f,h,p,g,m,y,C,v,b,w,T,x,R,M,N,O,D,F,E=o.yl,j=0,P=[n],L=o.zoom();for(r===a.AutoFitType.cellWithHeader&&(n===a.SheetArea.viewport?P.push(1):n===a.SheetArea.rowHeader&&P.push(0)),s=0;s<P.length;s++)for(l=0,u=P[s],c=i||o.getRowCount(u);l>=0&&l<c;)if((f=o.ITa.findSpan(l,e,u))&&(f.col<e||f.colCount>1||f.row<l))l=f.row+f.rowCount;else{if(o.getRowHeight(l,u)>0){if(p=0,(g=(h=o.getActualStyle(l,e,u)).cellType||o.Al(u))&&(m=h.font||E.Bl(),h.font=E.Cl(m),(C=!(!(y=o.rowFilter&&o.rowFilter())||!y.Dl(l,e,u)))||3!==u||(v=o.tables?o.tables.find(l,e):S)&&v.showHeader()&&v.headerIndex()===l&&v.rowFilter()&&v.filterButtonVisible(e-v.range().col)&&(C=!0),b=h.formatter?h.formatter:h._autoFormatter,w={sheet:o,row:l,col:e,sheetArea:u,quotePrefix:h.quotePrefix},T={},x=o.getValue(l,e,u,a.ValueType.richText),R=o.xHb(l,e,n),"",M=x&&x.richText?o.getText(l,e,u):d(R)?g.format(x,b,T,w):R,p=g.X4(x,M,h,L,w),C&&(N=I(L,1),p+=k(""+o.defaults.rowHeight*N,10))),O=h.cellButtons,i&&O)for(D=0;D<O.length;D++)(F=O[D]).imageSize&&(p+=F.imageSize.width+7);p>j&&(j=p)}u===a.SheetArea.viewport?l=t.El(l,e,o,u):l++}return 0===j?j=o.defaults.colWidth:j+=A(3),A(j)},t.El=function(t,e,o,n){var r,i,a=-1,s=o.getRowCount(n);for(r=t+1;r<s;r++){if(o.getText(r,e,n)){a=r;break}if((i=o.getActualStyle(r,e,n))&&(i.cellType||i.cellButtons&&i.cellButtons.length>0)){a=r;break}}return a},t.Fl=function(e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m=o.yl,y=0,C=[n],v=o.zoom();for(1===r&&(3===n?C.push(2):1===n&&C.push(0)),i=0;i<C.length;i++)for(n=C[i],a=0,s=o.getColumnCount(n);a>=0&&a<s;)(l=o.ITa.findSpan(e,a,n))&&(l.row<e||l.rowCount>1||l.col<a)?a=l.col+l.colCount:(o.getColumnWidth(a,n)>0&&(c=(u=o.getActualStyle(e,a,n)).font||m.Bl(),u.font=m.Cl(c),f=0,(h=o.getCellType(e,a,n))&&(p=o.getText(e,a,n),d=o.getValue(e,a,n,1),g={sheet:o,row:e,col:a,sheetArea:n},f=h.Y4(d,p,u,v,g)),f>y&&(y=f)),3===n?a=t.Gl(e,a,o,n):a++);return 0===y?y=o.defaults.rowHeight:y+=A(3),A(y)},t.Gl=function(t,e,o,n){var r,i,a=-1,s=o.getColumnCount(n);for(r=e+1;r<s;r++){if(o.getText(t,r,n)){a=r;break}if((i=o.getActualStyle(t,r,n))&&i.cellType){a=r;break}}return a},t.Il=function(e,o,r,i){var a,l,u,f,d,g,m,y,C;if(r&&(a=r.Jl,l=r.Kl,u=e.formatter?e.formatter:e._autoFormatter,f=i||{},h&&o!==S&&o!==T))if(d=void 0,u&&u.isAuto)d=typeof o===P,g=t.tl(o),!d&&g&&(o=c.Oa(o)),o=u.getPreferredEditingFormatter?u.getPreferredEditingFormatter(o).format(o):o;else if(typeof u!==j||t.lHb(u)||(u=new h(u)),u)try{o instanceof Date?((m=s&&s.Convert.Wh(o))&&(o=m),y=n.Common.CultureManager.q4().DateTimeFormat,C=n.Common.l.Ra(o),u=new h(!p.Lc(u.formatString(),["d","y"])&&C>=0&&C<1?y.longTimePattern:0===o.getHours()&&0===o.getMinutes()&&0===o.getSeconds()&&0===o.getMilliseconds()?y.shortDatePattern:y.shortDatePattern+F+y.longTimePattern),r.Ll=!0,o=u.format(o),f.formatter=u):typeof o===P&&(o=c.nb(""+o))}catch(t){o=r.getText(a,l)}else o=r.getText(a,l,3);return o!==S&&o!==T&&(o=t.bc(o)),o},t.ZXc=function(e,o,r,i){var a,l,u,f,d,g,m;if(r&&(a=e.formatter?e.formatter:e._autoFormatter,l=i||{},h&&o!==S&&o!==T))if(u=void 0,a&&a.isAuto)u=typeof o===P,f=t.tl(o),!u&&f&&(o=c.Oa(o)),o=a.getPreferredEditingFormatter?a.getPreferredEditingFormatter(o).format(o):o;else if(typeof a!==j||t.lHb(a)||(a=new h(a)),a)try{o instanceof Date?((d=s&&s.Convert.Wh(o))&&(o=d),g=n.Common.CultureManager.q4().DateTimeFormat,m=n.Common.l.Ra(o),a=new h(!p.Lc(a.formatString(),["d","y"])&&m>=0&&m<1?g.longTimePattern:0===o.getHours()&&0===o.getMinutes()&&0===o.getSeconds()&&0===o.getMilliseconds()?g.shortDatePattern:g.shortDatePattern+F+g.longTimePattern),o=a.format(o),l.formatter=a):typeof o===P&&(o=c.nb(""+o))}catch(t){}return o!==S&&o!==T&&(o=t.bc(o)),o},t.$Xc=function(e,o,n){var r,i,a,s,l,u="";if(e)if(i=(r=e.parent)&&r.options,(a=e.getFormulaInformation(o,n))&&a.hasFormula){if(u="="+a.formulaWithCulture,a.isDynamicArray)return""}else s=e.getActualStyle(o,n),u="string"==typeof(l=e.getValue(o,n))&&s.quotePrefix||u.length>0&&"="===u[0]&&i&&i.allowUserEditFormula?"'"+l:t.ZXc(s,l,e)||"";return u},t.yIc=function(t,e){var o=t,r=n.Common.CultureManager.q4(e).NumberFormat;return!(!(r&&r.percentSymbol)||!t)&&("object"==typeof t&&t.formatCached&&(o=t.formatCached),"object"!=typeof o&&"string"==typeof o&&c.Hja(o).fb>0)},t._Va=function(e){var o,n=t.Ml.msie||t.Ml.edge,r=n&&C.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return e?r:(o=n&&C.PointerEvent&&(navigator.maxTouchPoints||0)>1,r||o)},t.K_a=function(e){return e&&e.richText&&e.richText.length>0?(e.text||(e=t.n0a(e)),e.text):e},t.n0a=function(t){var e,o,n;if(!t)return t;if((e=t.richText)&&e.length>0){for(o=[],n=0;n<e.length;n++)o.push(e[n].text?e[n].text:"");t.text=o.join("")}return t},t.lHb=function(t){return"string"==typeof t&&("="===t.charAt(0)||t.indexOf("{{")>=0&&t.indexOf("}}")>=0)},t.Pl=function(t,e,o,n){var r=t,i=e,a=function(t,e){var a,s,l=this;return l.hasOwnProperty("_ps")||(l._ps={}),a=l._ps,0===arguments.length?a[r]!==T?a[r]:i:(!1!==e&&n&&!n.call(l,t)||(s=a[r]!==T?a[r]:i)!==t&&(a[r]=t,!1!==e&&o&&o.call(l,t,s)),l)};return a.isDefault=function(t){return t===i},a},t.Ql=function(t,e){var o={_ps:{}};return n.Common.j.H(t,(function(t){!function(t,e,o){Object.defineProperty(t,e,{get:function(){return this._ps[e]},set:function(t){var n=this._ps[e];n!==t&&(this._ps[e]=t,o&&o(e,t,n))},enumerable:!0})}(o,t,e)})),o},t.Rl=function(t,e,o,n,r){var i,a=I(e,o),s=R(e,o),l=0;for(i=a;i<s&&(l+=n?t.Sl(i,3):t.Tl(i,3),!(r&&l>r));i++);return l},t.YIc=function(t,e,o,n,r){var i,a,s=I(e,o),l=R(e,o),u=0;for(i=s;i<l&&(n?(a=t.Er(i),t.getViewportTopRow(a)<=i&&t.getViewportBottomRow(a)>=i&&(u+=t.Sl(i,3))):(a=t.Fr(i),t.getViewportLeftColumn(a)<=i&&t.getViewportRightColumn(a)>=i&&(u+=t.Tl(i,3))),!(r&&u>r));i++);return u},t.Z3=function(t,e){var o,n,r=0,i=0;return t!==e&&(o=l(t).offset(),n=l(e).offset(),r=o.left-n.left,i=o.top-n.top),{FB:i,EB:r}},t.bq=function(t,e,o,n){var r,i,a,s,l=n||{};if(!t||"string"!=typeof t)return l.message=y().Exp_SheetNameInvalid,!1;for(i=0;i<t.length;i++)if("*"===(r=t.charAt(i))||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return l.message=y().Exp_SheetNameInvalid,!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return l.message=y().Exp_SheetNameInvalid,!1;if(!e)return!0;for(a=e.length,i=0;i<a;i++)if(o!==(s=e[i])&&t.toUpperCase()===s.name().toUpperCase())return l.message=y().Exp_SheetNameConflict,!1;return!0},t.Ika=function(t,e,o){var n,r,i;if(!t)return t;for(n=0,r=t.length,i=[];n<r;)t[n]===e?i[n]=o:i[n]=t[n],n++;return i.join("")},t.tt=function(){var e,o,n,r=t;return r.ct||(n="-10000px",(o=(e=at("span")).style).visibility="hidden",o.top=n,o.left=n,o.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),v.body.insertBefore(e,S),r.ct=e),r.ct},t.fp=function(e,o,n){var r,i,a,s=t,l=s.st;if(!o)if(l){if(n&&(l=l.CJKFontCache),r=l[e])return r}else l=s.st={CJKFontCache:{}},n&&(l=l.CJKFontCache);return(i=s.tt()).style.font=t.hZa(e),t.Ml&&t.Ml.safari&&(i.style.lineHeight="normal"),i.innerHTML=n?String.fromCharCode(20013):"H",a=i.offsetHeight,o||(l[e]=a),a},t.Pxb=function(e){var o,n,r=t,i=r.Qxb;if(i){if(i[e])return i[e]}else i=r.Qxb={};return(n=r.tt()).style.font=e,n.innerHTML="H",(o={}).fontFamily=n.style.fontFamily,o.fontSize=n.style.fontSize,o.fontStyle=n.style.fontStyle,o.fontWeight=n.style.fontWeight,i[e]=o,o},t.Voa=function(e,o){var n=t.tt();return n.style.font=t.hZa(o),t.Ml&&t.Ml.safari&&(n.style.lineHeight="normal"),n.innerHTML=g.Ob(e||"H"),n.offsetHeight},t.iZa=function(o){var n,r=t;return o.indexOf(e.FallbackFontFamily)>=0?o:(o=o.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(n=r.tt().style).font=o,n.fontFamily=[].concat(n.fontFamily.split(","),e.FallbackFontFamily.split(",")).join(","),n.font)},t.hZa=function(e){var o,n,r=t;return e&&r.jZa?((o=r.kZa)||(o=r.kZa={}),(n=o[e])||(n=o[e]=r.iZa(e)),n):e},t.lZa=function(e,o){o&&(o=t.hZa(o),e.font!==o&&(e.font=o))},t.pL=function(e,o,n){return!o||d(n)?0:(t.lZa(e,o),e.measureText(n).width)},t.no=function(){var e=t,o=e.ct;o&&(l(o).remove(),e.ct=T),e.st=T,e.Qxb=T,t._0&&(t._0=T),e.kZa=T},t.Woa=function(e){var o,n=t._0;return n||(n=t._0=at("div")),o=e.innerHTML,n.innerHTML=o,n.innerText},t.G$a=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||t.length>=255)},t.T$a=function(t){t&&(t.j_a(!0),t.initExpression(),t.k_a())},t.l_a=function(t){var e,o,n=0,r=0,i=t.length;for(i>0&&(n=t[0].row,r=t[0].col),e=1;e<i;e++)n>(o=t[e]).row&&(n=o.row),r>o.col&&(r=o.col);return{r:n=n<0?0:n,c:r=r<0?0:r}},t.w0a=function(t){var e,o;return typeof t===j&&"/"===t.charAt(0)?(o=void 0,G.test(t)?(o=t.match(G),e=n.Common.l.Xb(N(o[1]))):L.test(t)?(o=t.match(L),e=new Date(N(o[1]))):e=t):e=t,e},t.x0a=function(t){return!d(t)&&n.Common.l.Ska(t)?n.Common.l.Daa(t):t},t.yHb=function(t,e){var o,n,r=t.getImageData(e.x,e.y,e.width,e.height),i=r.data;for(o=0;o<i.length-4;o+=4)n=x((30*i[o]+59*i[o+1]+11*i[o+2]+50)/100),i[o]=n,i[o+1]=n,i[o+2]=n;t.putImageData(r,e.x,e.y)},t.rXc=function(t,e,o){t.rowCount>e&&(t.rowCount=e),t.colCount>o&&(t.colCount=o)},t.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,t.nl=lt,t.rl=t.device,t.Ml=function(){var t,e,o,n,r;return e=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(t=navigator.userAgent),o={version:T,chrome:T,webkit:T,safari:T,mozilla:T,msie:T,metroMode:T,edge:T},e.browser&&(o[e.browser]=!0,o.version=e.version),o.chrome?o.webkit=!0:o.webkit&&(o.safari=!0),t.indexOf("PhantomJS")>=0&&(o.safari=!1,o.chrome=!0),(n=t.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(n)!==S&&(o.mozilla=T,o.msie=!0),(r=/Edge\/\d+/.exec(t))!==S&&r.length>0&&(o.webkit=T,o.chrome=T,o.msie=!0,o.edge=!0,o.version=r[0].substr(r[0].indexOf("/")+1)),o.msie&&function(){var t=S,e=!1;try{new ActiveXObject("")}catch(e){t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return!(e="ReferenceError"===t||!1!==e)}()&&(o.metroMode=!0),o}(),t.browser=t.Ml,t.Nl=at,t.Ol=it,t.uWa=ut,t.jZa=t.sl(),t.Fxb=function(t){return!d(t)&&(typeof t===P||typeof t===b||t instanceof Date||s&&t instanceof s.CalcError)},t}(),e.util=_,e.Ul=_,V=_.pL,H=function(){function t(){}return t.Wl=function(e){return!(t.Xl()!==e||!e.mm||!e.mm.YH)},t.Xl=function(){return C&&C.Yl&&C.Yl.activeElement},t.kmb=function(e){var o,n,r,i,a,s,l;function u(t){var i,a;for(i=0;i<=2;i++)(a=t.call(o,i))&&0!==a.width&&0!==a.height&&(e.$l=!0,n._l(r,a))}if(e&&!t.Wl(e)&&e.parent&&e.parent.options.hideSelection){for(o=e.am(),n=e.yl,r=n.bm(),i=e.getSelections(),a=void 0,s=void 0,a=0;a<i.length;a++)l=i[a],(s=e.cm(l)).width>=0&&s.height>=0&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,n.dm(s));s=o.em(),e.$l=!0,n._l(r,s),u(o.fm),u(o.gm)}},t.Zl=function(e,o){var n=t.Xl();C.Yl.activeElement=e,e===n||o||(n&&(n.endEdit(),t.kmb(n),n.hm&&n.hm()),e&&e.yl.im())},t}(),e.Vl=H,z=function(){function t(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}return t.prototype.rm=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",e="span."+t.split(F).join(E);return U.vm?l(v).find(e).length<=0&&st(U.vm):U.vm=ct(t),U.vm},t.prototype.sm=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",e="span."+t.split(F).join(E);return U.wm?l(v).find(e).length<=0&&st(U.wm):U.wm=ct(t),U.wm},t.prototype.tm=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",e="span."+t.split(F).join(E);return U.xm?l(v).find(e).length<=0&&st(U.xm):U.xm=ct(t),U.xm},t.prototype.um=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",e="span."+t.split(F).join(E);return U.ym?l(v).find(e).length<=0&&st(U.ym):U.ym=ct(t),U.ym},t.prototype.zm=function(){var t="gcDummyElement";return U.Am?l(v).find("#"+t).length<=0&&st(U.Am):U.Am=ct("gc-theme-version",t),U.Am},t.prototype.qm=function(){U.rm(),U.sm(),U.tm(),U.um()},t.prototype.ad=function(){var t,e,o=this;function n(t){var n,r,i,a=H.Xl();if(a&&(n=U.Bm(t.target),r=a.Cw&&a.Cw.V4,o.km.forEach((function(t){t&&t(a,n)})),!n||function(t,e){for(var o=!1,n=t;n;){if("gcSpread"===l(n).attr("gcUIElement")){o=e.zo()!==n;break}n=n.parentElement}return o}(n,a)))if(a.gv(T,T,r))e&&((i=a.mm)&&i.Cm&&i.Cm()),H.Zl(S);else if(t.cancelable)return!1}function r(t){var e=t.pointerType;e!==t.MSPOINTER_TYPE_TOUCH&&"touch"!==e||n(t)}o.jm=0,ft(C,"keydown",pt,!0),ft(C,"keyup",dt,!0),ft(C,"compositionstart",gt,!0),ft(C,"selectstart",yt,!0),t=_.rl(),e=t.ipad||t.iphone,_.browser.safari&&!e&&ft(C,"textInput",mt,!0),_._Va()?(l(v).bind("MSPointerDown",r),l(v).bind("pointerdown",r)):l(v).bind("touchstart",n),ft(v,"mousedown",(function(t){!1===n(t)&&lt(t)}),!0),l(v).bind("DOMContentLoaded",(function(){U.qm()}))},t.prototype.Bm=function(t){for(var e,o=t;o&&"BODY"!==o.tagName&&"function"==typeof o.getAttribute;){if((e=o.getAttribute("gcUIElement"))||(e=o.gcUIElement),e)return o;o=o.parentNode}return S},t.prototype.Dm=function(t,e){var o,n,r,i,s=U.rm();return t===a.VisualState.highlight||t===a.VisualState.selected?s=U.um():t===a.VisualState.hover&&(s=U.tm()),o=s.className,l(s).removeClass(o).addClass(e),r={backgroundColor:(n=ht(s)).backgroundColor,backgroundImage:n.backgroundImage},l(s).addClass(o),(i={backgroundColor:(n=ht(s)).backgroundColor,backgroundImage:n.backgroundImage,color:n.color,zIndex:n.zIndex}).borderLeftColor=n.borderLeftColor,i.borderRightColor=n.borderRightColor,i.borderBottomColor=n.borderBottomColor,i.borderBottomWidth=n.borderBottomWidth,i.borderTopColor=n.borderTopColor,i.borderRightWidth=n.borderRightWidth,i.backgroundImage===r.backgroundImage&&i.backgroundColor!==r.backgroundColor&&(i.backgroundImage=T),l(s).removeClass(e),i},t.prototype.Em=function(t){var e,o=U.zm();return l(o).removeClass(o.className).addClass("gc-theme-version "+t),e=ht(o),u({},e)},t.prototype.Fm=function(t){var e,o=U.sm();return l(o).removeClass(o.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),e=ht(o),u({},e)},t.prototype.Gm=function(){C.Yl.jm++},t.prototype.Hm=function(){var t=C.Yl;t.jm--,t.jm<0&&(t.jm=0)},t}(),U=z.prototype,C.Yl||(C.Yl=new z),W=function(){function t(){}return t.Jm=function(t){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},t.Km=function(e,o){var n=t.Jm(e)+o,r=t.styleCache;return r[n]||(r[n]=U.Dm(e,o)),r[n]},t.Lm=function(e){var o=e,n=t.styleCache;return n[o]||(n[o]=U.Em(e)),n[o]},t.Mm=function(e){var o="content"+e,n=t.styleCache;return n[o]||(n[o]=U.Fm(e)),n[o]},t._ob=function(t,e){var o=t.Pm;return o&&o.getColor&&(e=o.getColor(e)),e},t.Nm=function(){t.styleCache={}},t.styleCache={},t}(),e.Im=W,q=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t}(),e.Point=q,J=function(){function t(t,e,o,n){var r=this;r.x=t,r.y=e,r.width=o,r.height=n}return t.prototype.intersect=function(t,e,o,n){var r=this;return t<r.x+r.width&&r.x<t+o&&e<r.y+r.height&&r.y<e+n},t.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},t.prototype.contains=function(t,e,o){var n=this;return o?n.x<=t&&t<=n.x+n.width&&n.y<=e&&e<=n.y+n.height:n.x<t&&t<n.x+n.width&&n.y<e&&e<n.y+n.height},t.prototype.containsRect=function(t,e){return this.contains(t.x,t.y,e)&&this.contains(t.x+t.width,t.y+t.height,e)},t.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},t.prototype.getIntersect=function(e,o,n,r){var i=this,a=i.x,s=i.y,l=i.x+i.width,u=i.y+i.height,c=o,f=e+n,h=o+r,p=R(a,e),d=R(s,c),g=I(l,f)-p,m=I(u,h)-d;return g>0&&m>0?new t(p,d,g,m):S},t.prototype.round=function(){var t=this;t.x=x(t.x),t.y=x(t.y),t.width=A(t.width),t.height=A(t.height)},t.prototype.clone=function(){var e=this;return new t(e.x,e.y,e.width,e.height)},t}(),e.Rect=J,X=function(){function t(t,e,o,n){var r=this;r.row=t,r.rowCount=o,r.col=e,r.colCount=n}return t.prototype.intersect=function(t,e,o,n){var r=this;return(-1===t||-1===r.row||r.row<t+o&&t<r.row+r.rowCount)&&(-1===e||-1===r.col||r.col<e+n&&e<r.col+r.colCount)},t.prototype.getIntersect=function(e,o,n){var r,i,a,s,l,u,c,f,h=this;return e&&h.intersect(e.row,e.col,e.rowCount,e.colCount)?(r=-1===h.col?n-1:h.col+h.colCount-1,i=-1===e.col?n-1:e.col+e.colCount-1,a=-1===h.row?o-1:h.row+h.rowCount-1,s=-1===e.row?o-1:e.row+e.rowCount-1,l=R(h.col,e.col),u=I(r,i),c=R(h.row,e.row),f=I(a,s),new t(c,l,-1===c?-1:f-c+1,-1===l?-1:u-l+1)):S},t.prototype.contains=function(t,e,o,n){var r=this,i=arguments.length,a=!1;return 2!==i&&4!==i||(2===i&&(o=1,n=1),a=(-1===r.row||r.row<=t&&t+o<=r.row+r.rowCount)&&(-1===r.col||r.col<=e&&e+n<=r.col+r.colCount)),a},t.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},t.prototype.offset=function(e,o){var n=this,r=n.col,i=n.row;return-1!==r&&(r+=e),-1!==i&&(i+=o),new t(i,r,n.rowCount,n.colCount)},t.prototype.union=function(t){return Ct(this,t)},t.prototype.equals=function(e){var o=this;return e instanceof t&&o.row===e.row&&o.col===e.col&&o.rowCount===e.rowCount&&o.colCount===e.colCount},t}(),e.Range=X,e.kf=function(t,e,o,n){return new X(t,e,o,n)},e.getUnionRange=Ct,Z=function(){function t(){}return t.Om=function(t,e){if(t&&e){var o=t.currentTheme();if(o)return o.getColor(e)}return e},t.Qm=function(t,e){if(t&&e){var o=t.currentTheme();return o?o.getFont(e):e}return S},t}(),e.Rm=Z,Y=function(){function t(){}return t.ValidationError="ValidationError",t.CellClick="CellClick",t.CellDoubleClick="CellDoubleClick",t.ColumnChanging="ColumnChanging",t.RowChanging="RowChanging",t.EnterCell="EnterCell",t.LeaveCell="LeaveCell",t.ValueChanged="ValueChanged",t.TopRowChanged="TopRowChanged",t.SheetChanging="SheetChanging",t.SheetChanged="SheetChanged",t.PivotTableChanged="PivotTableChanged",t.LeftColumnChanged="LeftColumnChanged",t.InvalidOperation="InvalidOperation",t.RangeFiltering="RangeFiltering",t.RangeFiltered="RangeFiltered",t.RangeFilterClearing="RangeFilterClearing",t.TableFilterClearing="TableFilterClearing",t.RangeFilterCleared="RangeFilterCleared",t.TableFilterCleared="TableFilterCleared",t.TableFiltering="TableFiltering",t.TableFiltered="TableFiltered",t.RangeSorting="RangeSorting",t.RangeSorted="RangeSorted",t.ClipboardChanging="ClipboardChanging",t.ClipboardChanged="ClipboardChanged",t.ClipboardPasting="ClipboardPasting",t.ClipboardPasted="ClipboardPasted",t.ColumnWidthChanging="ColumnWidthChanging",t.ColumnWidthChanged="ColumnWidthChanged",t.RowHeightChanging="RowHeightChanging",t.RowHeightChanged="RowHeightChanged",t.DragDropBlock="DragDropBlock",t.DragDropBlockCompleted="DragDropBlockCompleted",t.DragFillBlock="DragFillBlock",t.DragFillBlockCompleted="DragFillBlockCompleted",t.EditStarting="EditStarting",t.EditStarted="EditStarted",t.EditChange="EditChange",t.EditEnding="EditEnding",t.EditEnd="EditEnd",t.EditEnded="EditEnded",t.RangeGroupStateChanging="RangeGroupStateChanging",t.RangeGroupStateChanged="RangeGroupStateChanged",t.SelectionChanging="SelectionChanging",t.SelectionChanged="SelectionChanged",t.SheetTabClick="SheetTabClick",t.SheetTabDoubleClick="SheetTabDoubleClick",t.SheetNameChanging="SheetNameChanging",t.SheetNameChanged="SheetNameChanged",t.ViewZooming="ViewZooming",t.ViewZoomed="ViewZoomed",t.UserZooming="UserZooming",t.UserFormulaEntered="UserFormulaEntered",t.CellChanged="CellChanged",t.ColumnChanged="ColumnChanged",t.RowChanged="RowChanged",t.ActiveSheetChanging="ActiveSheetChanging",t.ActiveSheetChanged="ActiveSheetChanged",t.SparklineChanged="SparklineChanged",t.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",t.RangeChanged="RangeChanged",t.ButtonClicked="ButtonClicked",t.EditorStatusChanged="EditorStatusChanged",t.FloatingObjectChanged="FloatingObjectChanged",t.DrawingElementZIndexChanged="DrawingElementZIndexChanged",t.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",t.ShapeChanged="ShapeChanged",t.ShapeSelectionChanged="ShapeSelectionChanged",t.PictureChanged="PictureChanged",t.FloatingObjectRemoving="FloatingObjectRemoving",t.ShapeRemoving="ShapeRemoving",t.FloatingObjectRemoved="FloatingObjectRemoved",t.ShapeRemoved="ShapeRemoved",t.PictureSelectionChanged="PictureSelectionChanged",t.FloatingObjectLoaded="FloatingObjectLoaded",t.TouchToolStripOpening="TouchToolStripOpening",t.CommentChanged="CommentChanged",t.CommentRemoving="CommentRemoving",t.CommentRemoved="CommentRemoved",t.SlicerChanged="SlicerChanged",t.BeforeDragDrop="BeforeDragDrop",t.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",t.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",t.FormulatextboxEditStarted="FormulatextboxEditStarted",t.FormulatextboxEnterCell="FormulatextboxEnterCell",t.FormulatextboxEditEnded="FormulatextboxEditEnded",t.FormulatextboxRangeChanged="FormulatextboxRangeChanged",t.SheetMoving="SheetMoving",t.SheetMoved="SheetMoved",t.DragMerging="DragMerging",t.DragMerged="DragMerged",t.ChartClicked="ChartClicked",t.FloatingElementSelected="FloatingElementSelected",t.BeforePrint="BeforePrint",t.TableResizing="TableResizing",t.TableResized="TableResized",t.TableRowsChanged="TableRowsChanged",t.TableColumnsChanged="TableColumnsChanged",t.DropdownSpreadMouseClick="DropdownSpreadMouseClick",t.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",t.PasteEnd="PasteEnd",t}(),e.Events=Y,K=function(){function t(t){this.kj=t}return t.prototype.no=function(){this.kj=S},t.prototype.Sm=function(t,e,o){var n,r=this.Tm,i=t<<4+e;return r?((n=r[i])||(n=o(),r[i]=n),n):o()},t.prototype.Um=function(t,e){var o,n=this.Vm;return n&&(o=n[t])?o[e]:S},t.prototype.Wm=function(t,e,o,n){var r=this.Vm;r&&(r[t]||(r[t]={}),r[t][e]={d:o,i:n})},t.prototype.zHb=function(t,e,o,n,r){var i,a=this,s=a.kj;return o===T&&(o=3),i=s.xHb(t,e,o),d(i)?!d(r)&&_.lHb(r.formatter)?Q.vn(s,r,a.ge(t,e,o,0),{},{row:t,col:e,sheet:s}):a.ge(t,e,o,n):i},t.prototype.ge=function(t,e,o,n){var r,i,a,s=this.kj,l=this.Xm;return o===T&&(o=3),l?((r=l[o])||(r={},l[o]=r),(i=r[t])||(i={},r[t]=i),(a=i[e])===T&&(a=s.getValue(t,e,o,n),i[e]=a),a):s.getValue(t,e,o,n)},t.prototype.Ym=function(t,e,o){var n,r,i,a=this.kj,s=this.Zm;return o===T&&(o=3),s?((n=s[o])||(n={},s[o]=n),(r=n[t])||(r={},n[t]=r),(i=r[e])||(i=a.AHb(t,e,o,!1,!0),r[e]=i),i.clone(!0)):a.AHb(t,e,o,!1,!1)},t.prototype.Sl=function(t){var e,o=this.kj,n=this.$m;return n?((e=n[t])===T&&(e=n[t]=o.Sl(t)),e):o.Sl(t)},t.prototype._m=function(t){var e,o=this.kj,n=this.an;return n?((e=n[t])===T&&(e=n[t]=o.Tl(t)),e):o.Tl(t)},t.prototype.bn=function(t){var e=this;return e.Xm?(e.cn||(e.cn=t()),e.cn):t()},t.prototype.dn=function(t){var e=this;return e.Xm?(e.gn||(e.gn=t()),e.gn):t()},t.prototype.hn=function(){var t=this;t.in=!0,t.Tm={},t.Vm={},t.Xm={},t.Zm={},t.$m={},t.an={}},t.prototype.jn=function(){this.in=!1},t.prototype.kn=function(){var t=this;t.in=!1,t.Tm=S,t.Vm=S,t.Xm=S,t.Zm=S,t.an=S,t.$m=S,t.cn=S,t.gn=S},t}(),e.ln=K,Q=function(){function t(){}return t.qn=function(e,o,n,r,i){var a,s,l,u;if(t.nn=!0,(a=e.tables)&&a.rn(o,n,r-o+1,i-n+1))for(s=-1,l=t.sn=[],u=0;u<=r;u++)e.getRowVisible(u)?(s++,l[u]=s):l[u]=-1},t.Nm=function(){t.sn=S,t.nn=!1},t.tn=function(e){var o=t.on;return o[e]||(o[e]=h?new h(e):S),o[e]},t.un=function(e,o,n){var r,i,a,s,l,u,c=t.pn,p=e+"_"+typeof e;return h?(c[o]||(c[o]={}),(i=(r=c[o])[p])?(n&&(n.conditionalForeColor=n.value=i.color,n.content=f(i.content)),i.text):((a=t.on)[o]||(a[o]=new h(o)),s={},l=a[o].format(e,s),(u=r[p]={}).text=l,u.color=s.conditionalForeColor,u.content=s.content,n&&(n.conditionalForeColor=n.value=s.conditionalForeColor,n.content=f(s.content)),l)):""+e},t.vn=function(t,e,o,n,r){var i,a;return o&&"SparklineExValue"===o.typeName?"":(i=e.cellType||t.Al(),a=e.formatter||e._autoFormatter,i.format(o,a,n,r))},t.wn=function(){t.on={},t.pn={}},t.nn=!1,t.on={},t.pn={},t.sn=[],t}(),e.mn=Q,$=function(){function t(){}return t.Cn=function(t,e,o){var n=vt(t);n.scaleX=e,n.scaleY=o,n.translateX=n.orgTranslateX*e,n.translateY=n.orgTranslateY*o,t.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},t.Dn=function(t,e,o){var n=vt(t);n.orgTranslateX+=e,n.orgTranslateY+=o,n.translateX=n.orgTranslateX*n.scaleX,n.translateY=n.orgTranslateY*n.scaleY,t.setTransform(n.scaleX,n.skewX,n.skewY,n.scaleY,n.translateX,n.translateY)},t}(),e.Bn=$,tt=$,et=function(){function t(){}return t.npb=function(){var t=C.screen,e=t.deviceXDPI,o=C.devicePixelRatio||(e?e/t.logicalXDPI:1),n=20*o,r=M(n);return r-n>.82?r/20:M(100*o)/100},t.Kn=function(e,o,n){var r,i,a,s,l,u,c,f,h=t;if(bt(e,1),wt(e,1),(1!==(r=t.npb())||1!==h.dpr)&&(h.dpr=r,i=o||n&&n.parent)){for(a=h.Fn,s=void 0,l=0;l<a.length;l++)if(i===a[l].workbook){s=a[l];break}if(s||(s={workbook:i,sheets:[],canvases:[]},a.push(s)),o)s.canvases.push(e);else{for(u=void 0,c=s.sheets,f=0;f<c.length;f++)if(c[f].sheet===n){u=c[f];break}u||(u={sheet:n,canvases:[]},c.push(u)),u.canvases.push(e)}}},t.Ln=function(t){return t&&t.Gn||1},t.Mn=function(t){return t&&t.Hn||1},t.Nn=function(t){return t.In},t.On=function(t){return t.Jn},t.Pn=function(e,o,n){var r,i,a,s=t,l=s.dpr,u=s.Ln(e),c=s.Mn(e);(function(t,e){t.In=e})(e,o),function(t,e){t.Jn=e}(e,n),1===l&&1===u&&1===c?(e.width=o,e.height=n):(r=e.getContext("2d"),tt.Cn(r,1,1),_.Ml.mozilla?(e.width=A(o*l),e.height=A(n*l)):(e.width=M(o*l),e.height=M(n*l)),e.style.width=o+D,e.style.height=n+D,i=e.width/o,a=e.height/n,i===u&&a===c||(bt(e,i),wt(e,a)),tt.Cn(r,i,a))},t.Qn=function(e,o){var n,r,i,a,s,l=t.Fn,u=e.parent;for(i=0;i<l.length;i++)if(!u||l[i].workbook===u)for(n=l[i].sheets,a=0;a<n.length;a++)if(n[a].sheet===e){for(r=n[a].canvases,s=0;s<r.length;s++)if(r[s]===o){r.splice(s,1);break}break}},t.Rn=function(e,o){var n,r,i,a=t.Fn;for(r=0;r<a.length;r++)if(a[r].workbook===e)for(n=a[r].canvases,i=0;i<n.length;i++)if(n[i]===o){n.splice(i,1);break}},t.Sn=function(e){var o,n,r,i=t.Fn,a=e.parent;for(n=0;n<i.length;n++)if(!a||i[n].workbook===a){for(o=i[n].sheets,r=0;r<o.length;r++)o[r].sheet===e&&o.splice(r,1);return}},t.Tn=function(e){var o,n=t.Fn;for(o=0;o<n.length;o++)if(n[o].workbook===e)return void n.splice(o,1)},t.Un=function(){var e,o,n,r,i,a,s,l,u=t,c=u.npb();if(u.dpr!==c)for(e=u.Fn,o=void 0,n=void 0,r=void 0,i=void 0,u.dpr=c,a=0;a<e.length;a++){for(r=(n=e[a]).canvases,o=n.sheets,s=0;s<o.length;s++)r=r.concat(o[s].canvases);for(l=0;l<r.length;l++)i=r[l],u.Pn(i,u.Nn(i),u.On(i))}},t.dpr=1,t.Fn=[],t}(),e.En=et,ot=function(){function t(){}return t.Wn=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g=[];if(!t||0===t.length)return g;if(!(i=r||Tt()))return g;if(_.lZa(i,o),a=_.fp(o),e<=0){for(s=-1,l=!0,u=0;u<t.length;u++)(c=t.charAt(u))===F||l?c!==F&&l&&(s=n?a:V(i,i.font,c),l=!1):s=I(s,n?a:V(i,i.font,c));if((e=s)<=0)return[t]}for(f=t.split(/\r\n|\r|\n/),h=0;h<f.length;h++)if(p=Mt(f[h],e,n,a,i))if(0===p.length)g.push("");else for(d=0;d<p.length;d++)g.push(p[d]);return g},t.oV=function(e,o,n,r,i){var a,s,l,u,c=[];if(0===o.length)return c;if(r)c=t.Wn(o,i,n,!0);else for(a=o.split(/\r\n|\r|\n/),s=0;s<a.length;s++){for(l=[],u=0;u<a[s].length;u++)l.push(a[s][u]);c.push(l)}return c},t.M_a=function(e,o,n,r,i,a){var s,l,u,c,f,h,p,g=[];if(0===e.length)return g;if(!(s=a||Tt()))return g;if(o<=0&&(o=function(t,e,o,n){var r,i,a,s,l,u=-1,c=!0;for(r=0;r<e.length;r++)if(!d(e[r].text))for(i=0;i<e[r].text.length;i++)a=e[r].text.charAt(i),s=e[r].style?e[r].style.font:o,_.lZa(t,s),l=_.fp(s),a===F||c?a!==F&&c&&(u=n?l:V(t,o,a),c=!1):u=I(u,n?l:V(t,o,a));return u}(s,r,n,i),o<=0)){for(u=[],l=0;l<r.length;l++)d(r[l].text)||u.push({textLength:t.R_a([r[l]],n,1,i,!1,s),text:r[l].text,textInfos:[r[l]]});return u}for(c=t.N_a(e),f=t.O_a(c,t.P_a(r)),l=0;l<f.length;l++)if(h=kt(f[l],o,n,i,s))if(0===h.length)g.push("");else for(p=0;p<h.length;p++)g.push(h[p]);return g},t.N_a=function(t){var e,o=[],n=t.split(/\r\n|\r|\n/);for(e=0;e<n.length;e++)o.push(St(n[e]));return o},t.O_a=function(t,e){var o,n,r,i,a,s,l=[],u=0,c=0;for(o=0;o<t.length;o++){for(n=[],r=0;r<t[o].length&&u<e.length;r++)if((i=t[o][r]).length<=e[u].text.length-c)n.push([{style:e[u].style,text:i}]),c+=i.length;else{for((a=[]).push({style:e[u].style,text:e[u].text.substring(c)}),s=i.length-(e[u].text.length-c),u++;u<e.length;u++){if(s<e[u].text.length){a.push({style:e[u].style,text:i.substring(i.length-s)}),c=s;break}if(s===e[u].text.length){a.push({style:e[u].style,text:i.substring(i.length-s)}),u++,c=0;break}a.push({style:e[u].style,text:e[u].text}),s-=e[u].text.length}n.push(a)}l.push(n)}return l},t.Xn=function(t,e,o,n){var r,i=n||Tt();return i?(e&&_.lZa(i,e),r=o?xt(t):t,V(i,i.font,r)):0},t.P_a=function(t){var e,o=[];for(e=0;e<t.length;e++)o.push({style:t[e].style,text:t[e].text?t[e].text.replace(/\r\n|\r|\n/g,""):t[e].text});return o},t.R_a=function(t,e,o,n,r,i){var a,s,l,u,c,f=i||Tt();if(!f)return 0;for(a=0,s=0;s<t.length;s++)void 0,l=t[s].style&&t[s].style.font?t[s].style.font:e,_.lZa(f,l),"",u=s===t.length-1&&r?xt(t[s].text):t[s].text,c=0,n?c=_.fp(l)*u.length/o:d(t[s].text)||(c=V(f,f.font,t[s].text)/o),t[s].style&&t[s].style.vertAlign&&(c*=.7),a+=c;return a},t.mHb=function(e,o,n,r,i,a,s,l){var u=0,c=_.fp(a),f=(s-4-c*r)/n,h=t.Wn(i,f,a),p=h.length,d=c*n;return u=(p-1)*(c/n),(u+=t.Xn(h[0],a)/2*r+d)+(t.Xn(h[p-1],a)/2*r+d)},t.Rvb=function(t){return xt(t)},t.bm=function(){return Tt()},t}(),e.Vn=ot,e.Zn=function(t){t.$n=function(e,o){var n,r;for(t._n||(t._n=[]),t._fc={},n=t._n,o.name=e,o.priority=o.priority||5e3,r=0;;r++)if(r>=n.length||o.priority>n[r].priority){n.splice(r,0,o);break}},t.ao=function(e,o,n,r){var i,a,s,l=t._n;if(l){if(!(i=t._fc[o]))for(i=t._fc[o]=[],a=0;a<l.length;a++)(s=l[a][o])&&i.push(s);for(a=0;a<i.length&&(i[a].call(e,n),!r||!r());a++);}}},nt=function(){function t(){this.JTa={}}return t.prototype.get=function(t,e){var o=this.JTa[t];return o?o[e]:T},t.prototype.set=function(t,e,o){var n=this.JTa[t];n||(n=this.JTa[t]={}),n[e]=o},t}(),e.KTa=nt,rt=function(){function t(){}return t.processBackspaceAndLeftArrowKeyEvent=function(t,e){var o,n,r,i,a,s,l,u,c,f=C.getSelection();if(!(f.rangeCount<=0)){if(o=f.anchorNode,n=f.anchorOffset,r=t.target,_.browser.msie&&!_.browser.edge&&e&&function(t,e,o){if(1===e&&Dt(o.firstChild)&&Dt(o.firstChild.firstChild)){var n=o.firstChild.firstChild.lastChild,r=void 0;if(t===o)return 1===(r=n.textContent).length&&r[0]!==B&&Ft(n.previousSibling);if(n===t||Ft(n)&&t===n.previousSibling)return 1===(r=t.textContent).length&&r[0]!==B&&Ft(t.previousSibling)}return!1}(o,n,r))return i=(parseFloat(_.browser.version)<10?Lt(r):r.innerText).slice(0,-1),r.innerHTML=i.replace(/\r/g,"").replace(/\n/g,"<br>​"),f.selectAllChildren(r),f.rangeCount>0&&f.collapseToEnd(),void lt(t);if(a=function(t,e){var o,n,r,i,a,s=t.childNodes.length;if(!Bt(t.textContent[0])||0!==e&&1!==e)if(0===e)n=t,t===t.parentNode.firstChild&&(n=t.parentNode),r=_t(n,jt),o=r&&r.lastChild;else{if(function(t){return t&&"DIV"===t.tagName}(t))return 1===s&&1===e?o=t.firstChild.firstChild.lastChild:s>1&&e===s&&(o=t.lastChild),Pt(o)?{zeroWidthCharNode:o,previousTextNode:o.previousSibling.previousSibling}:jt(o)?{zeroWidthCharNode:o,previousTextNode:_t(n,Et)}:S;!Dt(t)||e!==s&&e!==s-1||(jt(t)?o=t:jt(t.lastChild)&&(o=t.lastChild))}else o=t;return o?(Dt(o)?n=o:Et(o)&&(i=o.previousSibling,a=o.parentNode,n=i===a.firstChild?a:i),{zeroWidthCharNode:o,previousTextNode:_t(n,Et)}):S}(o,n),a&&a.zeroWidthCharNode){if(s=a.zeroWidthCharNode,l=a.previousTextNode,e)if(Dt(s))s.parentNode.removeChild(s);else{if(s.parentNode.removeChild(s.previousSibling),Ft(l))return void lt(t);(u=f.getRangeAt(0)).setStart(s,0),u.setEnd(s,1),u.deleteContents()}(c=v.createRange()).setStartAfter(l),c.setEndAfter(l),c.collapse(!1),f.removeAllRanges(),f.addRange(c),lt(t)}}},t.processDeleteAndRightArrowKeyEvent=function(t,e){var o,n,r,i,a,s=C.getSelection();s.rangeCount<=0||(o=function(t){var e,o,n=t.anchorNode,r=t.anchorOffset,i=n.textContent,a=i.length;if(r===a){if(e=function(t){for(var e,o=t;o;){if(o!==(e=o.parentNode).lastChild)return o.nextSibling;o=e}return S}(n),o=void 0,!e)return S;if(Dt(e)&&Bt(e.textContent[0])){for(;Dt(e.firstChild);)e=e.firstChild;o=e.childNodes[1]}else Ft(e)&&Bt(e.nextSibling.textContent[0])&&(o=e.nextSibling);return{node:o,offset:1}}return S}(s),o&&o.node&&(n=o.node,r=o.offset,e?((i=s.getRangeAt(0)).setStart(n,0),i.setEnd(n,1),i.deleteContents(),n.parentNode.removeChild(n.previousSibling)):((a=v.createRange()).setStart(n,r),a.setEnd(n,r),a.collapse(!1),s.removeAllRanges(),s.addRange(a)),lt(t)))},t}(),e.uHb=rt,e.Rxb={touch:!1},e.sJc=function(t){var e,o;return t&&((e=t.getActiveSheet())||(o=t.getActiveSheetTab())&&(e=o.kj)),e},e.tJc=function(t,e){t&&(t.getSheetFromName(e)?t.setActiveSheet(e):t.getSheetTab(e)&&t.setActiveSheetTab(e))},e.uJc=function(t,e){var o,n=t.getSheetFromName(e);return n||(o=t.getSheetTab(e))&&(n=o.kj),n}},"./dist/core/util/domUtil.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E;function j(t,e){var o,n;for(Array.call(this),"string"==typeof t?o=(e||u).querySelectorAll(t):t&&(o=r.Ca(t)||t instanceof HTMLCollection?t:[t]),n=0;o&&n<o.length;n++)this.push(o[n])}function P(t){var e=getComputedStyle(t).zIndex;return"auto"===e||""===e?0:+e}function L(t){return D.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function G(t,e){var o=t.nodeName;return o&&o.toLowerCase()===e.toLowerCase()}function B(t,e){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)>=0&&isFinite(e)?("width height".split(" ").indexOf(t)>=0&&e<0&&(e=0),e+"px"):e}function _(t,e,o){var n,r,i=t.nodeType;if(t&&3!==i&&8!==i&&2!==i)return 1!==i&&(r=I[e=A[e]||e]),X(o)?r&&h in r&&(n=r.get(t,e))!==s?n:t[e]:r&&"set"in r&&!X(n=r.set(t,o,e))?n:(t[e]=o,o)}function V(t){var e,o,n,r=t.nodeType;return(!r||1===r||9===r)&&(e={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},!(n=(o=t.nodeName)&&e[o.toLowerCase()])||!0!==n&&t.getAttribute("classid")===n)}function H(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()}))}function z(t,e,o,n){if(V(t)){var r,i,l=k,u=q(e),c=t.nodeType,f=c?M:t,h=c?t[l]:t[l]&&l;if(h&&f[h]&&(n||f[h].data)||!u||!X(o))return h||(c?(t[l]=h=N,N++):h=l),f[h]||(f[h]={},c||(f[h].toJSON=function(){})),(J(e)||"function"==typeof e)&&(n?f[h]=D.extend(f[h],e):f[h].data=D.extend(f[h].data,e)),r=f[h],n||(r.data||(r.data={}),r=r.data),X(o)||(r[H(e)]=o),u?(i=r[e])!==s&&i!==a||(i=r[H(e)]):i=r,i}}function U(t){var e;for(e in t)if(("data"!==e||!D.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function W(t,e){for(var o,n,r,a,l,u,c,f,h,p=0,d=k,g=M,m=t[p];m!==s&&void 0!==m;){if((e||V(m))&&(n=(o=m[d])&&g[o])){if(r=n.events)for(a in r)if(i(r,a)&&(l=r[a]))for(u in l)if(i(l,u)&&(c=l[u]))for(f=0,h=c.length;f<h;f++)tt(m,a,c[f]);g[o]&&(delete g[o],delete m[d])}m=t[++p]}}function q(t){return"string"==typeof t}function J(t){return"object"==typeof t}function X(t){return typeof t==typeof a}function Z(t){var e=t;return function(t){var o,n=this,r="border-box"===n.css("box-sizing"),i=e?p:d,a=e?g:y,s=e?m:C;return 0===arguments.length?(o=Math.round(l(n.css(i)))||0,r&&(o-=l(n.css("padding-"+a))+l(n.css("padding-"+s))+l(n.css("border-"+a+"-"+p))+l(n.css("border-"+s+"-"+p))),o):(n.css(i,t),n)}}function Y(t){var e=t;return function(){var t=this,o=e?g:y,n=e?m:C;return e?t.width():t.height()+l(t.css("padding-"+o))+l(t.css("padding-"+n))}}function K(t){var e=t;return function(t){var o=e?g:y,n=e?m:C,r=this,i=e?r.innerWidth():r.innerHeight();return i+=l(r.css("border-"+o+"-"+p))+l(r.css("border-"+n+"-"+p)),t&&(i+=l(r.css("margin-"+o))+l(r.css("margin-"+n))),i}}function Q(t){var e=t;return function(t){return this.forEach((function(o){o.style[x]=e?b:w,t&&t.apply(o)})),this}}function $(t){var e=t;return function(t){var o="scrollLeft",n="scrollTop",r=e?o:n,i=e?"pageXOffset":"pageYOffset",a=this[0],s=L(a);return X(t)?s?i in s?s[i]:u.documentElement[r]:a[r]:(s?s.scrollTo(e?t:D(s)[o](),e?D(s)[n]():t):a[r]=t,this)}}function tt(t,e,o){t.removeEventListener(e,o)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=n.Common.j,i=n.Common.D,a=void 0,s=null,l=parseFloat,u=document,c="_nonamespace",f="events",h="get",p="width",d="height",g="left",m="right",y="top",C="bottom",v="hidden",b="block",w="none",T="position",S="visibility",x="display",A={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},I={tabIndex:{get:function(t){var e=t.getAttributeNode("tabindex"),o=t.nodeName;return e&&e.specified?parseInt(e.value,10):/^(?:input|select|textarea|button|object)$/i.test(o)||/^(?:a|area)$/i.test(o)&&t.href?0:a}}},R={option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,o,n=t.options,r=t.selectedIndex,i="select-one"===t.type||r<0,a=i?s:[],l=i?r+1:n.length,u=i?r:0;for(r<0&&(u=l);u<l;u++)if(((o=n[u]).selected||u===r)&&!o.disabled&&(!o.parentNode.disabled||!G(o.parentNode,"optgroup"))){if(e=D(o).val(),i)return e;a.push(e)}return a},set:function(t,e){var o=D.makeArray(e);return D(t).find("option").getAll().forEach((function(t){t.selected=D.inArray(D(t).val(),o)>=0})),o.length||(t.selectedIndex=-1),o}}},M={},k="$"+(""+Math.random()).replace(/\D/g,""),N=1,O={},[d,p].forEach((function(t){O[t]={get:function(e){var o,n,r,i=getComputedStyle(e),a=e.style,s=a[T],l=a[S],c=a[x],f=0===e.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(i[x]);if(f&&(a[T]="absolute",a[S]=v,a[x]=b),o=i&&i[t],f&&(a[T]=s,a[S]=l,a[x]=c),""===o){for(n=e.parentElement,r=u.body;n&&n!==r;)n=n.parentElement;n!==r&&(o=a[t])}return o}}})),D=function(t,e){return t instanceof j?t:new j(t,e)},e.GC$=D,F={get:function(t){return this[t]},getAll:function(){return this},bind:function(t,e,o){return X(o)&&(o=e,e=a),this.forEach((function(n){var r,i,s,l,u,h,p=z(n,f,a,!0);p||z(n,f,p={},!0),i=(r=t.split("."))[0],(l=p[s=r[1]||c])||(l=p[s]={}),u=function(t){X(e)||(t.data=e);var r=o.apply(n,arguments);t.result=r,!1===r&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))},u.original=o,(h=l[i])||(h=l[i]=[]),h.push(u),n.addEventListener(i,u)})),this},unbind:function(t,e){return this.forEach((function(o){var n,r,s,l,u=t.split("."),h=u[0],p=u[1]||c,d=z(o,f,a,!0),g=d&&d[p];if(e){if(g&&h&&(n=g[h]))for(s=n.length,r=0;r<s;r++)if(n[r].original===e){tt(o,h,n[r]),n.splice(r,1);break}}else if(g)if(h){if(n=g[h])for(s=n.length,r=0;r<s;r++)tt(o,h,n[r]);g[h]=a}else{for(l in g)if(i(g,l)&&(n=g[l]))for(s=n.length,r=0;r<s;r++)tt(o,l,n[r]);d[p]=a}})),this},trigger:function(t,e){var o,n,r,s,l,u,c,h,p,d,g=this;for(o=0,n=g.length;o<n;o++)if(s=z(r=g[o],f,a,!0))for(u in l=t.split(".")[0],s)if(i(s,u)&&(h=(c=s[u])&&c[l]))for(p=0,d=h.length;p<d;p++)h[p].apply(r,[{type:l},e]);return g},css:function(t,e){var o,n,r,a=this,s=a,l=arguments.length;function u(t,e){s.forEach((function(o){o.style[t]=B(t,e)}))}if(1===l){if(!J(t))return o=a[0],(n=O[t])&&h in n?n.get(o):(r=getComputedStyle(o))&&r[t];s.forEach((function(e){for(var o in t)i(t,o)&&(e.style[o]=B(o,t[o]))}))}else 2===l&&(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length?t.forEach((function(t,o){u(t,e[o])})):u(t,e));return a},width:Z(!0),height:Z(),innerWidth:Y(!0),innerHeight:Y(),outerWidth:K(!0),outerHeight:K(),append:function(t){var e,o=[t];return t instanceof D&&(o=t.getAll()),this,e=this[0],o.forEach((function(t){t&&e.appendChild(t)})),this},appendTo:function(t){var e=t;return t instanceof D&&(e=t[0]),this,this.forEach((function(t){e.appendChild(t)})),this},prepend:function(t){var e=this[0];return e.insertBefore(t,e.firstChild),this},insertBefore:function(t){var e=t.parentElement;return this.forEach((function(o){e.insertBefore(o,t)})),this},addClass:function(t){var e,o,n,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(e=(t||"").match(/\S+/g)||[];a<s;a++)if(n=1===(o=this[a]).nodeType&&(o.className?(" "+o.className+" ").replace(l," "):" ")){for(r=e[i=0];r;)n.indexOf(" "+r+" ")<0&&(n+=r+" "),r=e[++i];o.className=D.trim(n)}return this},removeClass:function(t){var e,o,n,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(e=(t||"").match(/\S+/g)||[];a<s;a++)if(n=1===(o=this[a]).nodeType&&(o.className?(" "+o.className+" ").replace(l," "):"")){for(r=e[i=0];r;){for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");r=e[++i]}o.className=t?D.trim(n):""}return this},hasClass:function(t){var e,o=0,n=this.length,r=/[\t\r\n]/g;for(t=" "+t+" ";o<n;o++)if(1===(e=this[o]).nodeType&&(" "+e.className+" ").replace(r," ").indexOf(t)>=0)return!0;return!1},toggle:function(){var t=this;return t[0].style[x]===w?t.show():t.hide(),t},show:Q(!0),hide:Q(),attr:function(t,e){var o=this,n=o,r=arguments.length;if(1===r){if(!J(t))return o[0].getAttribute(t);n.forEach((function(e){for(var o in t)i(t,o)&&e.setAttribute(o,t[o])}))}else 2===r&&n.forEach((function(o){o.setAttribute(t,e)}));return o},removeAttr:function(t){return this.forEach((function(e){e.removeAttribute(t)})),this},prop:function(t,e){var o=this,n=o,r=arguments.length;if(1===r){if(!J(t))return _(o[0],t);n.forEach((function(e){for(var o in t)i(t,o)&&_(e,o,t[o])}))}else 2===r&&n.forEach((function(o){_(o,t,e)}));return o},removeProp:function(t){t=A[t]||t;return this.forEach((function(e){try{e[t]=a,delete e[t]}catch(t){}})),this},text:function(t){var e=this,o=e;return 0===arguments.length?e[0].textContent:(o.forEach((function(e){e.textContent=t})),e)},val:function(t){var e,o,n,r,i=this;return arguments.length?(r=D.isFunction(t),i.forEach((function(o,n){var i;1===o.nodeType&&((i=r?t.call(o,n,D(o).val()):t)===s||i===a?i="":"number"==typeof i?i+="":D.isArray(i)&&(i=D.map(i,(function(t){return t===s||t===a?"":t+""}))),(e=R[o.type]||R[o.nodeName.toLowerCase()])&&"set"in e&&!X(e.set(o,i,"value"))||(o.value=i))})),i):(n=void 0,(o=i[0])?(e=R[o.type]||R[o.nodeName.toLowerCase()])&&h in e&&!X(n=e.get(o,"value"))?n:q(n=o.value)?n.replace(/\r/g,""):n===s||n===a?"":n:void 0)},position:function(){var t,e,o,n,r=this[0];if(r){if(t={top:0,left:0},e={top:0,left:0},"fixed"===D(r).css(T))try{t=r.getBoundingClientRect()}catch(t){}else o=this.offsetParent(),t=this.offset(),G(n=o[0],"html")||((e=o.offset()).left-=n.scrollLeft,e.top-=n.scrollTop),e.top+=l(D(n).css("borderTopWidth")),e.left+=l(D(n).css("borderLeftWidth"));return{top:t.top-e.top-l(D(r).css("marginTop")),left:t.left-e.left-l(D(r).css("marginLeft"))}}},offsetParent:function(){var t=D.map(this,(function(t){for(var e=u.documentElement,o=t.offsetParent||e;o&&!G(o,"html")&&"static"===D(o).css(T);)o=o.offsetParent;return o||e}));return D(t)},offset:function(){var t,e,o={top:0,left:0},n=this[0],r=n&&n.ownerDocument;if(r){if(t=r.documentElement,!X(n.getBoundingClientRect))try{o=n.getBoundingClientRect()}catch(t){}return e=L(r),{top:o.top+(e.pageYOffset||t.scrollTop)-(t.clientTop||0),left:o.left+(e.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:$(!0),scrollTop:$(),html:function(t){var e=this,o=e;return 0===arguments.length?e[0].innerHTML:(o.forEach((function(e){e.innerHTML=t})),e)},remove:function(){this.forEach((function(t){var e=t.parentElement;e&&(e.removeChild(t),W([t]))}))},empty:function(){return this.forEach((function(t){D(t.children).remove()})),this},find:function(t){var e=[];return q(t)&&this.forEach((function(o){var n=o.querySelectorAll(t);D.merge(e,n)})),D(e)},parent:function(){var t=[];return this.forEach((function(e){var o=e.parentElement;o&&t.push(o)})),D(t)},index:function(t){var e=this[0];return t?q(t)?D.inArray(e,D(t).getAll()):D.inArray(t,this):e&&e.parentElement?D.inArray(e,e.parentElement.children):-1},focus:function(){var t=this[0];return t!==u.activeElement&&t.focus&&t.focus(),this},isVisible:function(){var t=0;return this.forEach((function(e){var o=getComputedStyle(e);o[S]!==v&&o[x]!==w&&t++})),t>0},data:function(t,e){var o=this,n=X(e);return n&&(o=void 0),D.each(this,(function(r,i){var a=z(i,t,e);if(n)return o=a,!1})),o},removeData:function(t){return D.each(this,(function(e,o){!function(t,e,o){if(V(t)){var n,r,i,a=t.nodeType,l=a?M:t,u=a?t[k]:k;if(l[u]){if(e&&(i=o?l[u]:l[u].data)){D.isArray(e)?e=e.concat(D.map(e,H)):e in i?e=[e]:e=(e=H(e))in i?[e]:e.split(" "),r=e.length;for(n=0;n<r;n++)delete i[e[n]];if(!(o?U:D.isEmptyObject)(i))return}(o||(delete l[u].data,U(l[u])))&&(a?W([t],!0):l!==l.window?delete l[u]:l[u]=s)}}}(o,t)})),this}},E=j.prototype=[],r.Ia(E,F),D.prototype=E,D.each=r.H,D.isEmptyObject=r.za,D.isFunction=r.Aa,D.isArray=r.Ca,D.isNumeric=r.Da,D.getType=r.Ba,D.inArray=r.Ea,D.merge=r.Ga,D.map=r.Ha,D.extend=r.Ia,D.inherit=r.G,D.isPlainObject=r.Ja,D.isArraylike=r.ya,D.isWindow=r.Ka,D.makeArray=r.La,D.trim=function(t){if(t.trim)return t.trim();return t===s||t===a?"":(t+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},D.Nl=function(t,e,o,n,r){var i=D(u.createElement(t));return e&&o&&i.css(e,o),n&&i.addClass(n),r&&(r instanceof D?r.append(i):D(r).append(i)),i},e.getHostMaxZIndex=function(t){for(var e,o=P(t);t.parentElement;)(e=P(t=t.parentElement))>o&&(o=e);return o}},"./dist/core/util/imageLoader.js":function(t,e,o){"use strict";var n,r,i,a;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/domUtil.js"),r=n.GC$,i=".gcSheet",a=function(){function t(t){this.bo=0,this.co=0,this.eo={};this.do=t}return t.prototype.fo=function(t){var e,o,n=this;function a(){n.ho(t,!1)}(e=n.eo)[t]||((o=r(document.createElement("img"))).bind("load"+i,(function(){n.ho(t,!0)})),o.bind("error"+i,a),o.bind("abort"+i,a),n.bo++,e[t]={io:!1,jo:o[0],agc:!1},o[0].src=t)},t.prototype.ko=function(t){var e=this.eo[t];return!!e&&e.io},t.prototype.bgc=function(t){var e=this.eo[t];return!!e&&e.agc},t.prototype.lo=function(t){var e=this.eo[t];return e?e.jo:null},t.prototype.ho=function(t,e){var o=this;o.co++,o.eo[t].io=!0,o.eo[t].agc=e,o.mo()&&o.do&&o.do()},t.prototype.mo=function(){return this.co>=this.bo},t.prototype.no=function(){var t,e=this.eo;if(e)for(t in e)e[t]&&r(e[t].jo).unbind(i);this.do=null},t}(),e.oo=a},"./dist/core/util/tasks.js":function(t,e,o){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),n=function(){function t(t,e){this.fn=t,this.args=e}return t.prototype.run=function(){this.fn.apply(null,this.args)},t}(),e.Task=n,r=function(){function t(t,e){var o=this;o.tasks=[],o.nextTaskFunc=t.bind(o),o.isBusyFunc=e.bind(o)}return t.prototype.addTask=function(t,e){this.tasks.splice(0,0,new n(t,e))},t.prototype.pushTask=function(t,e){this.tasks.push(new n(t,e))},t.prototype.runNextTask=function(){var t=this,e=t.tasks;if(!t.isTerminated){if(e.length<1)return void(t.endingCallback&&t.endingCallback());if(t.isBusyFunc())return void setTimeout((function(){t.runNextTask()}),100);t.nextTaskFunc().run(),setTimeout((function(){t.runNextTask()}),10)}},t.prototype.start=function(){this.runNextTask()},t.prototype.terminate=function(){this.tasks=[],this.isTerminated=!0},t}(),e.Tasks=r},"./dist/core/util/theme.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C;function v(t){var e=t;return function(o){return 0===arguments.length?this.po[e]:(this.po[t]=s(o),this)}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/common.js"),i=n.Common.j.Fa,a=n.Common.pc,s=a.ec,l=parseInt,u=r.util.Pl,c="Gill Sans MT",f="Franklin Gothic Book",h="Trebuchet MS",p=function(){function t(t,e,o,n,r,i,a,l,u,c,f,h,p){this.background1=v(0),this.background2=v(1),this.textColor1=v(2),this.textColor2=v(3),this.accent1=v(4),this.accent2=v(5),this.accent3=v(6),this.accent4=v(7),this.accent5=v(8),this.accent6=v(9),this.hyperlink=v(10),this.followedHyperlink=v(11),this.Cj=t,this.po=[];for(var d=1;d<13;d++)this.po.push(s(arguments[d]))}return t.prototype.name=function(t){return 0===arguments.length?this.Cj:(this.Cj=t,this)},t.prototype.getColor=function(t){var e,o,n,r,i;if(t&&"string"==typeof t&&(o=void 0,e=t.split(" "))){if(n=-1,(r=e.length)>1){if(!e[0])return t;"background"===(o=e[0].toLowerCase())?n=l(e[1],10)-1:"text"===o?n=l(e[1],10)+1:"accent"===o&&(n=l(e[1],10)+3)}else 1===r&&("hyperlink"===(o=e[0].toLowerCase())?n=10:"followedhyperlink"===o&&(n=11));if(n>=0&&n<=11)return r>2?(i=l(e[2],10)/100,a.bc(a.jc(this.po[n],i))):a.bc(this.po[n])}return t},t.prototype.toJSON=function(){var t=this.po;return{name:this.Cj,background1:t[0],background2:t[1],text1:t[2],text2:t[3],accent1:t[4],accent2:t[5],accent3:t[6],accent4:t[7],accent5:t[8],accent6:t[9],hyperlink:t[10],followedHyperlink:t[11]}},t.prototype.fromJSON=function(t,e){var o,n,r,a,s,l,u,c,f,h,p,d,g,m,y;function C(t,e){i(e)||(o.po[t]={a:e.a,r:e.r,g:e.g,b:e.b})}t&&(o=this,"_colorList","_name",e?(m=t.name?t.name:t._name,i(m)||(o.Cj=m),n=(y=t.colorList?t.colorList:t._colorList)[0],r=y[1],a=y[2],s=y[3],l=y[4],u=y[5],c=y[6],f=y[7],h=y[8],p=y[9],d=y[10],g=y[11]):(i(t.name)||(o.Cj=t.name),n=t.background1,r=t.background2,a=t.text1,s=t.text2,l=t.accent1,u=t.accent2,c=t.accent3,f=t.accent4,h=t.accent5,p=t.accent6,d=t.hyperlink,g=t.followedHyperlink),C(0,n),C(1,r),C(2,a),C(3,s),C(4,l),C(5,u),C(6,c),C(7,f),C(8,h),C(9,p),C(10,d),C(11,g))},t.prototype.e4=function(t){var e,o,n,r;if(this.name()!==t.name())return!1;for(o=0,n=(e=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;o<n;o++)if(r=e[o],!a.Pka(this[r](),t[r]()))return!1;return!0},t}(),e.ColorScheme=p,d=function(){function t(t,e,o,n){this.name=u("name"),this.colors=u("colors"),this.headerFont=u("headerFont"),this.bodyFont=u("bodyFont");var r=this;r.name(t),r.colors(e||new p(t)),r.headerFont(o),r.bodyFont(n)}return t.prototype.getColor=function(t){return this.colors().getColor(t)},t.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headerFont():t},t.prototype.toJSON=function(){var e=this,o=e.name();return t.f4(e)?o:{name:o,themeColor:e.colors()?e.colors().toJSON():void 0,headingFont:e.headerFont(),bodyFont:e.bodyFont()}},t.f4=function(t){var e,o=t.name();return!!C[o]&&(e=C[o],t.bodyFont()===e.bodyFont()&&t.headerFont()===e.headerFont()&&t.colors().e4(e.colors()))},t}(),e.Theme=d,g="#000000",m="#FFFFFF",y=function(){function t(){}return t.Default=new p("Default",m,"#EEECE1",g,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),t.Office2007=new p("Office2007",m,"#EEECE1",g,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),t.Office=new p("Office",m,"#E7E6E6",g,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),t.Apex=new p("Apex",m,"#C9C2D1",g,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),t.Aspect=new p("Aspect",m,"#E3DED1",g,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),t.Concourse=new p("Concourse",m,"#DEF5FA",g,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),t.Civic=new p("Civic",m,"#C5D1D7",g,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),t.Oriel=new p("Oriel",m,"#FFF39D",g,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),t.Origin=new p("Origin",m,"#DDE9EC",g,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),t.Paper=new p("Paper",m,"#FEFAC9",g,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),t.Solstice=new p("Solstice",m,"#E7DEC9",g,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),t.Technic=new p("Technic",m,"#D4D2D0",g,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),t.Trek=new p("Trek",m,"#FBEEC9",g,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),t.Urban=new p("Urban",m,"#DEDEDE",g,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),t.Verve=new p("Verve",m,"#D2D2D2",g,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),t.Equity=new p("Equity",m,"#E9E5DC",g,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),t.Flow=new p("Flow",m,"#DBF5F9",g,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),t.Foundry=new p("Foundry",m,"#EAEBDE",g,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),t.Median=new p("Median",m,"#EBDDC3",g,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),t.Metro=new p("Metro",m,"#D6ECFF",g,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),t.Module=new p("Module",m,"#D4D4D6",g,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),t.Opulent=new p("Opulent",m,"#F4E7ED",g,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),t}(),e.ThemeColors=y,C=function(){function t(){}return t.Default=new d("Default",y.Default,"Cambria","Calibri"),t.Office=new d("Office",y.Office,"Calibri Light","Calibri"),t.Office2007=new d("Office2007",y.Office2007,"Cambria","Calibri"),t.Apex=new d("Apex",y.Apex,"Lucida Sans","Book Antiqua"),t.Aspect=new d("Aspect",y.Aspect,"Verdana","Verdana"),t.Concourse=new d("Concourse",y.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),t.Civic=new d("Civic",y.Civic,"Georgia","Georgia"),t.Oriel=new d("Oriel",y.Oriel,"Century Schoolbook","Century Schoolbook"),t.Origin=new d("Origin",y.Origin,"Bookman Old Style",c),t.Paper=new d("Paper",y.Paper,"Constantia","Constantia"),t.Solstice=new d("Solstice",y.Solstice,c,c),t.Technic=new d("Technic",y.Technic,f,"Arial"),t.Trek=new d("Trek",y.Trek,"Franklin Gothic Medium",f),t.Urban=new d("Urban",y.Urban,h,"Georgia"),t.Verve=new d("Verve",y.Verve,"Century Gothic","Century Gothic"),t.Equity=new d("Equity",y.Equity,f,"Perpetua"),t.Flow=new d("Flow",y.Flow,"Calibri","Constantia"),t.Foundry=new d("Foundry",y.Foundry,"Rockwell","Rockwell"),t.Median=new d("Median",y.Median,"Tw Cen MT","Tw Cen MT"),t.Metro=new d("Metro",y.Metro,"Consolas","Corbel"),t.Module=new d("Module",y.Module,"Corbel","Corbel"),t.Opulent=new d("Opulent",y.Opulent,h,h),t}(),e.Themes=C},"./dist/core/workbook/sheettab.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/common.js"),i=o("./dist/core/worksheet/stylehelper.js"),a=o("./dist/core/workbook/sheettabbase.js"),s=o("./dist/core/core.enum.js"),l=n.Common.pc,u=l.ic,c=l.ec,f=null,h=function(t){function e(e){var o,n=t.call(this,e)||this;return n.vJc=4,n.wJc="white",(o=n).EC=13,o.GC=12,o.HC=0,o.kw=30,o.IC=28,o.JC=28,o.KC=a.NEW_TAB_SIZE_ASIDE,o.LC=0,o._font="10pt Segoe UI",n}return p(e,t),e.prototype.NC=function(){var t=this.OC,e=t&&t.options;return e&&e.tabNavigationVisible?this.IC*(e.useTouchLayout?1.5:1):0},e.prototype.PC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?t.xJc():0},e.prototype.QC=function(){return this.JC},e.prototype.RC=function(){return this.SC?0:this.JC},e.prototype.TC=function(){return this.OC.options.newTabVisible?this.SC?0:this.KC:0},e.prototype.UC=function(){var t,e,o,n=this,r=n.OC.yJc(),i=n.VC(),a=n.WC,s=n.zJc(),l=n.Dr();for(t=s?l.x+l.width-n.AJc()-n.TC()-n.RC():l.y+l.height-n.PC(),e=n.gq,o=r.length;e<o;e++)if(r[e].visible()&&(i+=s?a[e]:n.BJc),i>t){i=t;break}return i},e.prototype.VC=function(){var t=this;return t.zJc()?2*t.NC()+t.QC()+t.XC():t.TC()},e.prototype.XC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?this.AJc()/2:0},e.prototype.getResizeBarBounds=function(){var t=this,e=t.Dr();return{x:e.x+e.width-t.AJc(),y:f,width:t.AJc(),height:f}},e.prototype.getNavButtonBounds=function(){var t,e,o,n,r,i,a,s=this;return s.zJc()?(t=s.AJc()/2,e=f,o=s.NC(),n=f):(r=s.Dr(),i=s.PC(),a=s.NC(),t=r.width/2-a,e=r.height-i,o=a,n=i),1,3,{x:t,y:e,width:o,height:n,startIndex:1,endIndex:3}},e.prototype.getSheetTabBounds=function(){var t=this,e=t.Dr(),o=t.RC();return{x:t.VC(),y:f,height:f,secondMoreTabWidth:t.RC(),moreTabPos:e.x+e.width-t.AJc()-t.TC()-o}},e.prototype.getPreMoreTabBounds=function(){var t=this;return{x:t.VC()-t.QC(),width:t.QC()}},e.prototype.YC=function(){var t=this;return t.zJc()?t.ZC+t.WC[t.$C]>t._C():t.ZC+2*t.BJc>t._C()},e.prototype._C=function(){var t=this;return t.zJc()?t.Dr().width-t.AJc()-t.TC()-t.RC():t.Dr().height-t.PC()},e.prototype.aD=function(){return 6},e.prototype.Via=function(){return["blank","nextButton"]},e.prototype.cD=function(){return this.VC()},e.prototype.CJc=function(t,e){var o;t.save(),t.beginPath(),o=r.Im.Km(0,"gc-tabStripBackground").backgroundColor,this.eD=c(o),t.fillStyle=o,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},e.prototype.DJc=function(t,e){var o,n,i,a,l=this.OC,u=l&&l.options.tabStripPosition,c=r.Im.Km(0,"gc-tabStripBackground").borderTopColor;t.save(),t.beginPath(),t.strokeStyle=c,u===s.TabStripPosition.bottom?(o=e.x,n=e.y,i=e.x+e.width,a=e.y+.5):u===s.TabStripPosition.top?(o=e.x,n=e.height-.5,i=e.x+e.width,a=e.y+e.height-.5):u===s.TabStripPosition.left?(o=e.x+e.width-.5,n=e.y,i=e.x+e.width-.5,a=e.y+e.height):u===s.TabStripPosition.right&&(o=e.x+.5,n=e.y,i=e.x+.5,a=e.y+e.height),t.moveTo(o,n),t.lineTo(i,a),t.stroke(),t.restore()},e.prototype.dD=function(t,e){this.CJc(t,e),this.DJc(t,e)},e.prototype.fD=function(t,e,o){var n,r,i,a,s=this,l=s.OC.options.newTabVisible,u=s.zJc(),c=s.VC(),f=s.IC,h=o,p=f;u?((h+=r=s.RC())>(i=e.x+e.width-s.AJc()-s.TC())&&(h=i,(a=i-r)<c&&(h=(a=c)+f),s.gD(t,a,0,r,e.height)),n=e.height):(h=(e.width-c)/2,p=n=c),l&&s.hD(t,h,0,p,n,-2===s.iD)},e.prototype.jD=function(t,e,o,n){var r=this.QC();this.gD(t,n-r,0,r,e.height)},e.prototype.kD=function(t,e){var o,n,r=this,i=r.zJc(),s=r.EJc,l=r.NC(),u=r.PC(),c=r.lD;i?(o=r.AJc()/2+l/2,n=u/2,r.mD(t,o,n,o+s,n+s,o+s,n-s,a.NavButtonDirection.left,f,1===c),o+=l,r.mD(t,o,n,o-s,n+s,o-s,n-s,a.NavButtonDirection.right,f,2===c)):(o=(e.width-l)/2,n=e.height-u/2,r.mD(t,o,n,o+s,n+s,o-s,n+s,a.NavButtonDirection.top,f,1===c),o+=l,r.mD(t,o,n,o-s,n+s,o-s,n-s,a.NavButtonDirection.bottom,f,2===c))},e.prototype.nD=function(t,e){var o,n,i=this.AJc(),a=r.Im.Km(0,"gc-tabStripResizeBarInner");this.OC.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(e.x+e.width-i,0,i,e.height),t.clip(),o=e.x+e.width-i/2,n=e.y+e.height/2,t.fillStyle=a.color,t.fillRect(o,n,2,2),t.fillRect(o,n-4,2,2),t.fillRect(o,n+4,2,2))},e.prototype.FJc=function(t,e,o,n,r,i,a,l){var u=this,c=u.OC.options.tabStripPosition,f=u.GJc,h=u.wJc,p=u.vJc,d=u.HJc,g=u.zJc();t.save(),l&&a&&(t.fillStyle=h,c===s.TabStripPosition.bottom?t.fillRect(e,o,n,r-p):c===s.TabStripPosition.top?t.fillRect(e,o+p,n,r):c===s.TabStripPosition.left?t.fillRect(e+f,o,n-f,r):t.fillRect(e,o,n-f,r)),a?(t.fillStyle=h,c===s.TabStripPosition.bottom?t.fillRect(e,o+1,n,r-p):c===s.TabStripPosition.top?t.fillRect(e,o+p-1,n,r):l?c===s.TabStripPosition.left?t.fillRect(e+f,o,n-f,r+1):t.fillRect(e,o,n-f,r+1):t.fillRect(e+f,o,n-2*f,r+1)):l&&(t.fillStyle=h,c===s.TabStripPosition.bottom?t.fillRect(e,o,n,1):c===s.TabStripPosition.top?t.fillRect(e,o+r,n,1):c===s.TabStripPosition.left?t.fillRect(e+f,o,n-f,r+1):t.fillRect(e,o,n-f,r+1)),t.fillStyle=i,g?t.fillRect(e+d,o+d,n-2*d+1,r-2*d):l?c===s.TabStripPosition.left?t.fillRect(e+f,o,n-f,r+1):t.fillRect(e,o,n-f,r+1):t.fillRect(e+f,o,n-2*f,r+1),t.restore()},e.prototype.IJc=function(t,e,o,n,r,i,a){var l=this,u=l.OC.options.tabStripPosition,c=l.vJc,f=l.GJc,h=l.zJc();t.save(),h?(t.beginPath(),t.lineWidth=1,t.strokeStyle=i&&i.borderLeftColor,a?u===s.TabStripPosition.bottom?(t.moveTo(e+.5,o),t.lineTo(e+.5,o+r-c),t.moveTo(e+n+.5,o),t.lineTo(e+n+.5,o+r-c)):u===s.TabStripPosition.top&&(t.moveTo(e+.5,o+c),t.lineTo(e+.5,o+r),t.moveTo(e+n+.5,o+c),t.lineTo(e+n+.5,o+r)):(t.moveTo(e+.5,o+c),t.lineTo(e+.5,o+r-c),t.moveTo(e+n+.5,o+c),t.lineTo(e+n+.5,o+r-c))):(t.beginPath(),t.lineWidth=1,t.strokeStyle=i&&i.borderLeftColor,a?u===s.TabStripPosition.left?(t.moveTo(e+f,o+.5),t.lineTo(e+f+n,o+.5),t.moveTo(e+f,o+r+.5),t.lineTo(e+f+n,o+r+.5)):(t.moveTo(e,o+.5),t.lineTo(e+n-f,o+.5),t.moveTo(e,o+r+.5),t.lineTo(e+n-f,o+r+.5)):(t.moveTo(e+f,o+.5),t.lineTo(e-f+n,o+.5),t.moveTo(e+f,o+r+.5),t.lineTo(e-f+n,o+r+.5))),t.stroke(),t.restore()},e.prototype.JJc=function(t,e,o,n,r,i,a){var l=this,u=l.OC.options.tabStripPosition,c=l.vJc,f=l.GJc;a&&(t.save(),t.beginPath(),t.strokeStyle=i&&i.borderBottomColor,t.lineWidth=2,u===s.TabStripPosition.bottom?(t.moveTo(e,o+r-c),t.lineTo(e+n+1,o+r-c)):u===s.TabStripPosition.top?(t.moveTo(e,o+c),t.lineTo(e+n+1,o+c)):u===s.TabStripPosition.left?(t.moveTo(e+f,o),t.lineTo(e+f,o+r+1)):(t.moveTo(n-f,o),t.lineTo(n-f,o+r+1)),t.stroke(),t.restore())},e.prototype.KJc=function(t,e,o,n,r,a,u,c,f,h,p){var d,g,m,y,C,v,b=this,w=b.OC.options.tabStripPosition,T=b.GJc,S=b.HJc,x=b.LJc,A=b.OC.MJc(a),I=A&&A.options.sheetTabColor;t.save(),t.textBaseline="top","string"==typeof c&&(d=c),g=b.qD(u,d),t.fillStyle=g,(p||h||f)&&(t.font=i.To.Ro(t.font,"bold")),m=b.EC,t.textBaseline="middle",w===s.TabStripPosition.bottom?t.fillText(a,e+m,o+r/2-1):w===s.TabStripPosition.top?t.fillText(a,e+m,o+r/2+1):(t.beginPath(),y=e+n-2*T-2*S-2-1,t.rect(e+T,o+.5,y+S,r+.5),t.clip(),t.fillText(a,e+T+S,o+r/2+2),C=t.measureText(x).width,t.measureText(a).width-C>y&&(t.beginPath(),void 0,v=I?c:h||f?b.wJc:l.bc(b.eD),t.fillStyle=v,t.fillRect(e+T+S+y-C,o+1.5,y,r-1.5),t.fillStyle=g,t.fillText(x,e+T+S+y-C,o+r/2+2))),t.restore()},e.prototype.oD=function(t,e,o,n,i,a,l,u,c,f){var h,p,d,g=this,m=s.VisualState.normal;u&&(m=s.VisualState.hover),f&&(m=s.VisualState.selected),l&&(m=s.VisualState.active),l&&!f&&(m=s.VisualState.activeNotSelected),h=r.Im.Km(m,"gc-tab-"+r.Im.Jm(m)),p=r.Im.Km(0,"gc-tab-"+r.Im.Jm(0)),d=g.pD(t,l,c,p,o),g.FJc(t,e,o,n,i,d,f,l),g.IJc(t,e,o,n,i,p,l),g.JJc(t,e,o,n,i,h,f),g.KJc(t,e,o,n,i,c,h,d,f,l,u)},e.prototype.mD=function(t,e,o,n,i,l,u,c,f,h){var p,d,g,m,y;t.save(),p=this,d=c===a.NavButtonDirection.left||c===a.NavButtonDirection.top,g=s.VisualState.highlight,h&&(g=s.VisualState.hover),d?(c===a.NavButtonDirection.left?(e-=2,2):(o-=2,2),-1===p.rw(p.gq)&&(g=s.VisualState.normal)):(c===a.NavButtonDirection.right?(e+=2,2):(o+=2,2),-1===p.rD(p.sD())&&(g=s.VisualState.normal)),m=r.Im.Km(g,"gc-navButton-"+r.Im.Jm(g)),t.strokeStyle=this.tD(m.borderTopColor),t.beginPath(),y=d?1:-1,c===a.NavButtonDirection.left||c===a.NavButtonDirection.right?(t.moveTo(e-.5,o),t.lineTo(e-.5,o+1),t.moveTo(e+y-.5,o-1),t.lineTo(e+y-.5,o+2),t.moveTo(e+2*y-.5,o-2),t.lineTo(e+2*y-.5,o+3),t.moveTo(e+3*y-.5,o-3),t.lineTo(e+3*y-.5,o+4)):c!==a.NavButtonDirection.top&&c!==a.NavButtonDirection.bottom||(t.moveTo(e,o-.5),t.lineTo(e+1,o-.5),t.moveTo(e-1,o+y-.5),t.lineTo(e+2,o+y-.5),t.moveTo(e-2,o+2*y-.5),t.lineTo(e+3,o+2*y-.5),t.moveTo(e-3,o+3*y-.5),t.lineTo(e+4,o+3*y-.5)),t.stroke(),t.restore()},e.prototype.hD=function(t,e,o,n,i,a){var l,u,c;t.save(),t.beginPath(),l=(i-2*this.NJc)/2,u=s.VisualState.highlight,a&&(u=s.VisualState.hover),c=r.Im.Km(u,"gc-tabStripNewTab-"+r.Im.Jm(u)),t.lineWidth=1.5,t.strokeStyle=this.tD(c.borderTopColor),t.arc(e+n/2,o+i/2,l,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+n/2-4,o+i/2),t.lineTo(e+n/2+4,o+i/2),t.moveTo(e+n/2,o+i/2-4),t.lineTo(e+n/2,o+i/2+4),t.stroke(),t.restore()},e.prototype.gD=function(t,e,o,n,i){var a,l,u;t.save(),t.beginPath(),a=s.VisualState.highlight,5!==(l=this.lD)&&6!==l||(a=s.VisualState.hover),u=r.Im.Km(a,"gc-navMoreButton-"+r.Im.Jm(a)),t.fillStyle=this.tD(u.borderTopColor),t.fillRect(e+n/2,o+i/2,2,2),t.fillRect(e+n/2-4,o+i/2,2,2),t.fillRect(e+n/2+4,o+i/2,2,2),t.restore()},e.prototype.tD=function(t){var e=c(t),o=this.eD;return e.a<=.01?u(o):l.hc(o,e)?u(e):t},e}(a.DC),e.iv=h},"./dist/core/workbook/sheettab2007.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("Common"),i=o("./dist/core/util/common.js"),a=o("./dist/core/workbook/sheettabbase.js"),s=o("./dist/core/worksheet/stylehelper.js"),l=o("./dist/core/core.enum.js"),u=i.Ul.wl,c=null,f=Math.min,h=Math.max,p="#92A5C7",d="linear-gradient",g=new r.Common.ResourceManager(n.SR),m=g.getResource.bind(g),y=function(t){function e(e){var o=t.call(this,e)||this,n=o;return n.EC=12,n.GC=8,n.HC=3,n.kw=12,n.KC=48,n.LC=5,n._font="10pt Arial",o}return C(e,t),e.prototype.NC=function(){var t=this.OC,e=t&&t.options;return e&&e.tabNavigationVisible?t.Wv()*(e.useTouchLayout?2:1):0},e.prototype.PC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?t.Wv():0},e.prototype.VC=function(){var t=this;return t.zJc()?4*t.NC()+t.lE():t.TC()},e.prototype.lE=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?2:0},e.prototype.getResizeBarBounds=function(){var t=this,e=t.Dr();return{x:e.x+e.width-t.AJc(),y:c,width:t.AJc(),height:c}},e.prototype.getNavButtonBounds=function(){var t,e,o,n,r,i,a,s=this;return s.zJc()?(t=0,e=c,o=s.NC(),n=c):(r=s.Dr(),i=s.PC(),a=s.NC(),t=r.width/2-2*a,e=r.height-i,o=a,n=i),0,4,{x:t,y:e,width:o,height:n,startIndex:0,endIndex:4}},e.prototype.getSheetTabBounds=function(){return{x:this.VC(),y:c,height:c,secondMoreTabWidth:0,moreTabPos:0}},e.prototype.getPreMoreTabBounds=function(){var t=this;return{x:t.VC(),width:t.HC+t.LC}},e.prototype.YC=function(){var t=this;return t.zJc()?t.ZC+t.WC[t.$C]+t.TC()>t._C():t.ZC+2*t.BJc>t._C()},e.prototype._C=function(){var t=this;return t.zJc()?t.Dr().width-t.AJc():t.Dr().height-t.PC()},e.prototype.aD=function(){return this.zJc()?1:4},e.prototype.Via=function(){return["newSheet"]},e.prototype.cD=function(){var t=this,e=t.zJc(),o=t.VC();return e&&(o+=t.Dr().height,t.OC.options.newTabVisible&&(o+=t.TC(),o+=t.HC)),o},e.prototype.dD=function(t,e){var o,n,r,a,s,l,c,f;if(t.save(),t.beginPath(),o=t.createLinearGradient(e.x,e.y,e.width,e.height),r=(n=i.Im.Km(0,"gc-tabStripBackground"))&&n.backgroundImage,a=n&&n.backgroundColor,r&&-1!==r.indexOf(d))for(l=0,c=(s=u(r)).length;l<c;l++)f=s[l],o.addColorStop(f.point,f.color);else a&&(o.addColorStop(0,"#DDDDDD"),o.addColorStop(1,a));t.fillStyle=o,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},e.prototype.fD=function(t,e,o){var n,r,i,s,l,u=this,c=u.OC,f=m().NewTab,h=u.zJc();c.options.newTabVisible&&(n=void 0,0,r=void 0,i=void 0,s=-2===u.iD,h?(u.KC=t.measureText(f).width+u.EC,n=o,r=u.TC(),i=e.height,u.oD(t,n,0,r,i,void 0,!1,s,f,!1)):(l=a.NEW_TAB_SIZE_ASIDE,u.KC=l,n=(e.width-l)/2,r=l,i=l,u.OJc(t,n,0,r,i,s)))},e.prototype.OJc=function(t,e,o,n,r,a){var s,c,f,h,p,g,m,y,C;if(t.save(),t.beginPath(),s=(r-2*this.NJc)/2,c=l.VisualState.normal,a&&(c=l.VisualState.hover),f=i.Im.Km(c,"gc-tab-"+i.Im.Jm(c)),(h=a?f.backgroundColor:f.backgroundImage)&&-1!==h.indexOf(d))for(p=t.createLinearGradient(e+.7*r,o+0,.7*r,r),m=0,y=(g=u(h)).length;m<y;m++)C=g[m],p.addColorStop(C.point,C.color);else p=h;t.lineWidth=1.5,t.strokeStyle=p,t.arc(e+n/2,o+r/2,s,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+n/2-4,o+r/2),t.lineTo(e+n/2+4,o+r/2),t.moveTo(e+n/2,o+r/2-4),t.lineTo(e+n/2,o+r/2+4),t.stroke(),t.restore()},e.prototype.jD=function(t,e,o,n){var r=this,i=o-1,a=r.WC[i];r.oD(t,n+r.LC-a-r.HC,0,a,e.height,i,r.$C===i,r.iD===i,"",!1)},e.prototype.kD=function(t,e){var o,n,r=this,i=r.zJc(),s=r.VC(),l=r.EJc,u=r.NC(),f=r.PC(),h=r.lD;t.fillStyle=p,i?t.fillRect(e.x,e.y,s-1,e.height):t.fillRect(e.x,e.height-f,e.width,f),i?(o=u/2,n=f/2,r.mD(t,o,n,o+l,n+l,o+l,n-l,a.NavButtonDirection.left,o-l,0===h),o+=u,r.mD(t,o,n,o+l,n+l,o+l,n-l,a.NavButtonDirection.left,c,1===h),o+=u,r.mD(t,o,n,o-l,n+l,o-l,n-l,a.NavButtonDirection.right,c,2===h),o+=u,r.mD(t,o,n,o-l,n+l,o-l,n-l,a.NavButtonDirection.right,o+4,3===h)):(o=e.width/2-1.5*u,n=e.height-f/2,r.mD(t,o,n,o+l,n+l,o-l,n+l,a.NavButtonDirection.top,n-l,0===h),o+=u,r.mD(t,o,n,o+l,n+l,o-l,n+l,a.NavButtonDirection.top,c,1===h),o+=u,r.mD(t,o,n,o+l,n-l,o-l,n-l,a.NavButtonDirection.bottom,c,2===h),o+=u,r.mD(t,o,n,o+l,n-l,o-l,n-l,a.NavButtonDirection.bottom,n+l,3===h))},e.prototype.nD=function(t,e){var o,n=this.OC,r=this.AJc(),a=i.Im.Km,s=a(4,"gc-tabStripResizeBarInner"),l=a(0,"gc-tabStripResizeBarOuter");n.options.showHorizontalScrollbar&&(o=e.x+e.width-r,t.fillStyle=l.backgroundColor,t.fillRect(o,e.y,r,e.height),t.fillStyle=s.backgroundColor,t.fillRect(o+1,e.y+1,r-2,e.height-2),t.fillStyle=s.color,t.fillRect(o+r/2-1,e.y+4,2,e.height-8))},e.prototype.oD=function(t,e,o,n,r,a,s,u,c,f){var h,p=this,d=p.zJc(),g=l.VisualState.normal;(u||f)&&(g=l.VisualState.hover),h=i.Im.Km(g,"gc-tab-"+i.Im.Jm(g)),d?p.PJc(t,e,o,n,r,c,h,f,s,u):p.QJc(t,e,o,n,r,a,c,h,f,s,u)},e.prototype.PJc=function(t,e,o,n,r,i,a,u,c,f){var h,d,g,m=this,y=m.OC.options.tabStripPosition,C=m.RJc;t.save(),t.beginPath(),y===l.TabStripPosition.bottom?(t.moveTo(e,o),t.lineTo(e,o+r-C),t.arcTo(e,o+r,e+n,o+r,C),t.lineTo(e+n,o+r),t.lineTo(e+n+r,o),c||t.lineTo(e,o)):(t.moveTo(e,o+r),t.lineTo(e,o-C),t.arcTo(e,o,e+n,o,C),t.lineTo(e+n,o),t.lineTo(e+n+r,o+r),c||t.lineTo(e,o+r)),h=m.pD(t,u||f,i,a),t.fillStyle=h,t.fill(),t.strokeStyle=p,t.stroke(),t.textBaseline="top","string"==typeof h&&(d=h),t.fillStyle=m.qD(a,d),c&&(t.font=s.To.Ro(t.font,"bold")),g=m.EC,t.textBaseline="middle",t.fillText(i,e+g,o+r/2),t.restore()},e.prototype.QJc=function(t,e,o,n,r,i,a,u,c,f,h){var d,g,m,y,C,v=this,b=v.OC.options.tabStripPosition,w=i===v.OC.sheets.length-1,T=v.RJc,S=v.GJc,x=v.EJc,A=v.HJc,I=v.LJc;t.save(),t.beginPath(),b===l.TabStripPosition.left?(e+=S,n-=S,t.moveTo(e+n,o),t.lineTo(e+T,o),t.arcTo(e,o,e,o+T,T),t.lineTo(e,o+r-T),t.arcTo(e,o+r,e+T,o+r,T),w?t.lineTo(e+n,o+r):(t.lineTo(e+n-x,o+r),t.lineTo(e+n,o+r+x)),f||t.lineTo(e+n,o)):(n-=S,t.moveTo(e,o),t.lineTo(e+n-T,o),t.arcTo(e+n,o,e+n,o+T,T),t.lineTo(e+n,o+r-T),t.arcTo(e+n,o+r,e+n-T,o+r,T),w?t.lineTo(e,o+r):(t.lineTo(e+x,o+r),t.lineTo(e,o+r+x)),f||t.lineTo(e,o)),d=v.pD(t,c||h,a,u,o),t.fillStyle=d,t.fill(),t.strokeStyle=p,t.stroke(),t.textBaseline="top","string"==typeof d&&(g=d),m=v.qD(u,g),t.fillStyle=m,f&&(t.font=s.To.Ro(t.font,"bold")),t.textBaseline="middle",t.beginPath(),y=n-2*S,t.rect(e,o,y,r),t.clip(),t.fillText(a,e+S+A,o+r/2+2),C=t.measureText(I).width,t.measureText(a).width-C>y&&(t.beginPath(),t.fillStyle=d,t.fillRect(e+y-C,o+1.5,y,r-2.5),t.fillStyle=m,t.fillText(I,e+y-C,o+r/2+2)),t.restore()},e.prototype.mD=function(t,e,o,n,r,s,l,p,g,m){var y,C,v,b,w,T,S,x,A,I,R,M,k,N,O;if(t.save(),C=(y=this).zJc(),v=p===a.NavButtonDirection.left||p===a.NavButtonDirection.top,b=y.Dr(),w=y.NC(),S=(T=i.Im.Km)(4,"gc-navButton-hover"),A=(x=T(0,"gc-navButton-normal"))&&x.backgroundColor,(I=x&&x.backgroundImage)&&-1!==I.indexOf(d))for(R=t.createLinearGradient(b.x+.7*b.height,b.y+0,.7*b.height,b.height),k=0,N=(M=u(I)).length;k<N;k++)O=M[k],R.addColorStop(O.point,O.color);C&&(m?(t.fillStyle=S.backgroundColor,t.fillRect(e-w/2+2,b.y+2,w-4,b.height-4)):(R?t.fillStyle=R:A&&(t.fillStyle=A),t.fillRect(e-w/2,b.y+1,w,b.height-2))),t.fillStyle=C?m?S.color:x.color:m?A:R||A,void 0!==g&&g!==c&&(p===a.NavButtonDirection.left||p===a.NavButtonDirection.right?t.fillRect(g,f(r,l),1,h(r,l)-f(r,l)):t.fillRect(f(n,s),g,h(n,s)-f(n,s),1)),v?p===a.NavButtonDirection.left?(e-=2,n-=2,s-=2):(o-=2,r-=2,l-=2):p===a.NavButtonDirection.right?(e+=2,n+=2,s+=2):(o+=2,r+=2,l+=2),t.beginPath(),t.moveTo(e,o),t.lineTo(n,r),t.lineTo(s,l),t.lineTo(e,o),t.fill(),t.restore()},e}(a.DC),e.jv=y},"./dist/core/workbook/sheettabbase.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K;function Q(t,e,o){t.Wq(a.Events.SheetTabClick,{sheet:e,sheetName:e?e.name():v,sheetTabIndex:h(o)?-1:o})}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("Common"),i=o("./dist/core/util/domUtil.js"),a=o("./dist/core/util/common.js"),s=o("./dist/core/worksheet/stylehelper.js"),l=o("./dist/core/core.enum.js"),u=r.Common.pc,c=a.Ul.wl,f=a.Ul.bq,h=r.Common.j.Fa,p=a.Ul.Nl,d=a.Ul.fp,g=a.Ul.lZa,m=parseInt,y=window,C=document,v=null,b=Math.max,w=Math.min,T=Math.pow,Math.round,S="px",x="none",I="mousedown"+(A=".gcTab"),R="mousemove"+A,M="mouseup"+A,k="mouseout"+A,N="dblclick"+A,O="mousewheel"+A,F="mousemove"+(D=".spliter"),E="mouseup"+D,P="keydown"+(j=".tabNameEditor"),L="focus"+j,G="blur"+j,B="canvas",_="2d",V="resize",H="navButton",z="tab",U="newSheet",W="blank",q="white",J="navButton",X="sheetTab",e.NEW_TAB_SIZE_ASIDE=28,Z=new r.Common.ResourceManager(n.SR),Y=Z.getResource.bind(Z),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.top=2]="top",t[t.bottom=3]="bottom"}(e.NavButtonDirection||(e.NavButtonDirection={})),K=function(){function t(t){this.Cj=t,this.SC=!1,this.LC=0,this.HC=0,this.GJc=6,this.SJc=3,this.RJc=5,this.EJc=5,this.HJc=3,this.NJc=7,this.LJc="...",this.buffer=null;var e=this;e.OC=v,e.$C=0,e.gq=0,e.ZC=70,e.lD=-1,e.iD=-1,e._font="",e.WC=[],e.BJc=0,e.uD=-1,e.vD=-1,e.wD=v,e.xD=0,e.Us(new a.Rect(0,0,200,28))}return t.prototype.getNewTabBounds=function(){var t,e,o,n,r=this,i=r.OC.options.useTouchLayout,a=r.Dr(),s=r.TC(),l=(s-2*r.NJc)/2;return i?(t=a.x,e=a.y,o=a.width,n=s):(t=(a.x+a.width-2*l)/2,e=(a.y+s-2*l)/2,o=2*l,n=2*l),{x:t,y:e,width:o,height:n}},t.prototype.zJc=function(){var t=this.OC.options.tabStripPosition;return t===l.TabStripPosition.bottom||t===l.TabStripPosition.top},t.prototype.ws=function(e){var o,n;e&&((o=this).Xs&&o.no(!0),n=p(B),a.En.Kn(n,o.OC),n.setAttribute("id",o.Cj),o.yD=o.zD(),o.TJc(),e.appendChild(o.yD[0]),e.appendChild(n),o.Xs=n,i.GC$(n).bind(I,(function(t){return o.AD(t)})).bind(R,(function(t){return o.BD(t)})).bind(M,(function(t){return o.CD(t)})).bind(k,(function(t){return o.DD(t)})).bind(N,(function(t){return o.ED(t)})).bind(O,(function(t){return o.Rw(t)})),o.fq(),t.ao(o,"setHost"))},t.prototype.Yv=function(t){var e,o=this;o.OC=t,t&&((e=t.options.font)&&e.length>0&&(o._font=e),o.TJc())},t.prototype.RIc=function(t){var e=this.OC;e.suspendPaint(),this.SIc(t),e.resumePaint()},t.prototype.SIc=function(t){var e,o,n,r=this,i=r.OC,a=r.zJc(),s=r.BJc,l=r._C(),u=0,c=r.WC,f=r.cD(),h=r.sD();if(r.TIc().tabsInfo[0].index>t)i.startSheetIndex(t);else{for(e=t-1;e>=0;e--)if(t=h[e],u+=a?c[t]:s,e!==h.length-1&&(u+=a?r.HC:0),n=f+u,0!==e&&(n+=a?r.LC:s),n>l){o=e=a?e+1:e;break}o&&i.startSheetIndex(o)}},t.prototype.Dr=function(){var t=this.Zs;return new a.Rect(t.x,t.y,t.width,t.height)},t.prototype.Us=function(t){var e=this.Zs=new a.Rect(0,0,0,0);e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},t.prototype.TC=function(){return this.OC.options.newTabVisible?this.KC:0},t.prototype.UC=function(){var t=this,e=t.Dr();return t.zJc()?e.x+e.width-t.AJc():e.y+e.height-t.PC()},t.prototype.VC=function(){return 0},t.prototype.AJc=function(){var t=l.TabStripPosition.bottom,e=this.OC;return e&&(t=e.options.tabStripPosition),t===l.TabStripPosition.bottom?this.kw:0},t.prototype.fq=function(){var t,e,o,n,r=this,s=r.Ws();s&&s.parentNode&&(0!==(t=i.GC$(s.parentNode)).width()&&0!==t.height()&&(e=b(t.width(),0),o=b(t.height(),0),s.style.display=x,s.width=e,s.height=o,s.style.display="",s.style.width=e+S,s.style.height=o+S,e=s.clientWidth||s.width,o=s.clientHeight||s.height,n=r.Dr(),r.Us(new a.Rect(n.x,n.y,e,o)),a.En.Pn(s,e,o),r.repaint()))},t.prototype.YC=function(){return!1},t.prototype.PC=function(){return 0},t.prototype._C=function(){return 0},t.prototype.aD=function(){return 0},t.prototype.Via=function(){return[]},t.prototype.cD=function(){return 0},t.prototype.zD=function(){return this.yD?this.yD:i.GC$(p("div"))},t.prototype.TJc=function(){var t,e,o,n=this.yD;n&&(o=void 0,(e=(t=this.OC)?t.options.tabStripPosition:l.TabStripPosition.bottom)===l.TabStripPosition.bottom?o="gc-tab-indicator-bottom":e===l.TabStripPosition.top?o="gc-tab-indicator-top":e===l.TabStripPosition.left?o="gc-tab-indicator-left":e===l.TabStripPosition.right&&(o="gc-tab-indicator-right"),n.removeClass(),n.addClass(o))},t.prototype.no=function(e){var o,n=this,r=n.Xs;r&&(o=r.parentNode,i.GC$(r).unbind(I).unbind(R).unbind(M).unbind(N).unbind(k),o&&o.removeChild(r)),i.GC$(n.yD).remove(),t.ao(n,"dispose"),e||(n.OC=v)},t.prototype.UJc=function(t,e){var o,n,r,i,a,s,u,c,f,h,p,d,g,m,y,C=this,v=C.OC,b=v.options.scrollbarAppearance===l.ScrollbarAppearance.mobile,w=v.options.showHorizontalScrollbar,T=C.Dr();if(w&&!b&&(o=C.getResizeBarBounds(),v.options.showHorizontalScrollbar&&!b&&t>o.x&&t<T.x+T.width))return{type:"resize",element:V};for(r=-1,i=(n=C.getNavButtonBounds()).startIndex,a=n.x,s=n.endIndex,u=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],c=i;c<s;c++){if(a<t&&t<a+n.width){r=c,H=u[c];break}a+=n.width}if(-1!==r)return{type:J,element:H,index:c};if(a=(f=C.getPreMoreTabBounds()).x,h=0,-1!==C.rw(C.gq)){if(a<=t&&t<a+f.width)return{type:J,element:H=u[5],index:5,position:a};h=C.LC}if(p=C.getSheetTabBounds(),d=v.yJc(),g=C.WC,m=C.HC,y=0,a=p.x+h,C.gq>-1)for(c=C.gq;c<d.length&&c<g.length;c++)if(d[c].visible()){if(y=g[c],a<t&&t<a+y+m){if(p.moreTabPos>0&&t<p.moreTabPos)return{type:X,element:z,index:c,position:a};if(0===p.moreTabPos)return{type:X,element:z,index:c,position:a}}a+=y+m}if(a>p.moreTabPos&&p.moreTabPos>0&&(a=p.moreTabPos),-1!==C.rD(C.sD())){if(a<t&&t<a+p.secondMoreTabWidth)return H=u[6],{type:J,element:u[6],index:6,position:a}}else if(a<t&&t<a+p.secondMoreTabWidth)return{element:W,position:a};return a+=p.secondMoreTabWidth,v.options.newTabVisible&&a<t&&t<a+C.TC()?{type:X,element:U,position:a,index:-1}:{element:W}},t.prototype.VJc=function(t,e){var o,n,r,i,a,s=this,l=s.OC,u=s.getNavButtonBounds(),c=-1,f=u.x,h=u.y,p=u.startIndex,d=u.endIndex,g=["first","prevArrow","nextArrow","last","","prevButton","nextButton"];for(o=p;o<d;o++){if(f<t&&t<f+u.width&&h<e&&e<h+u.height){c=o,H=g[o];break}f+=u.width}if(-1!==c)return{type:J,element:H,index:o};if(h=s.TC(),n=l.yJc(),r=s.WC,i=s.BJc,s.gq>-1)for(o=s.gq;o<n.length&&o<r.length;o++)if(n[o].visible()){if(h<e&&e<h+i)return{type:X,element:z,index:o,position:h};h+=i}return a=s.getNewTabBounds(),l.options.newTabVisible&&a.x<t&&t<a.x+a.width&&a.y<e&&e<a.y+a.height?{type:X,element:U,position:h,index:-1}:h<e&&e<h+u.y?-1!==s.rD(s.sD())?(H=g[6],{type:J,element:g[6],index:6,position:h}):{element:W,position:h}:{element:W}},t.prototype.hitTest=function(t,e){var o=this;return o.zJc()?o.UJc(t,e):o.VJc(t,e)},t.prototype.AD=function(e){var o,n,r,a,s,l,u,c=this,f={e:e,r:v};return t.ao(c,"preProcessMouseDown",f),h(o=f.r)?(n=i.GC$(c.Ws()).offset(),r=e.pageX-n.left,a=e.pageY-n.top,s=c.OC.WJc(),c.FD&&c.GD(s,!1),u=(l=c.hitTest(r,a)).element,0===e.button&&(u===V?(c.HD=!0,c.ID=e.pageX,c.tC()):u===H?c.JD(l.index):u===z?(c.KD(l.index,l.position,e),c.LD(e,l)):u===U&&c.MD(l.position),(s=c.OC.WJc())&&!s.isEditing()&&s.zt()),c.ND=!0,!1):o},t.prototype.BD=function(e){var o,n,r,a,s,l,u,c,f,p,d,g,m,y=this,C=y.OC,b={e:e,r:v};if(t.ao(y,"preProcessMouseMove",b),!h(o=b.r))return o;if(n=y.Xs.style,r="default",a="w-resize",y.OD&&!y.PD&&(Math.sqrt(T(y.OD.x-e.pageX,2)+T(y.OD.y-e.pageY,2))>10&&(y.PD=!0)),y.HD)n.cursor=a,s=e.pageX-y.ID,l=y.OC.xs.clientWidth,C.options.tabStripRatio=C.Iv()+s/l,u=y.AJc()/l,1,C.Iv()<u?(C.options.tabStripRatio=u,y.ID=y.AJc()):C.Iv()>=1?(C.options.tabStripRatio=1,y.ID=l):y.ID=e.pageX,C.aq();else if(y.PD)y.QD(e.pageX,e.pageY),y.RD(e);else{if(y.lD=-1,y.iD=-1,c=i.GC$(y.Ws()).offset(),f=e.pageX-c.left,p=e.pageY-c.top,g=(d=y.hitTest(f,p)).element,y.OC&&y.OC.options.enableAccessibility&&(m=y.cgc(d),y.OC.dgc(m)),""===g)return n.cursor=r,y.repaint(),!1;g===V?n.cursor=a:(n.cursor=r,g===H?y.lD=d.index:g===z?y.iD=d.index:g===U&&(y.iD=-2)),y.repaint()}return!1},t.prototype.cgc=function(t){var e,o=Y(),n="",r=t.element;return r===V?n=o.ARIA_Resize:r===H?n={first:o.ARIA_First,prevArrow:o.ARIA_PreviousArrow,nextArrow:o.ARIA_NextArrow,last:o.ARIA_Last,prevButton:o.ARIA_PreviousButton,nextButton:o.ARIA_NextButton}[H]||"":r===z?(e=this.OC.XJc(t.index).name(),n=o.ARIA_SheetTab+" "+e.replace(/([0-9]+)/," $1 ")):r===U?n=o.ARIA_NewSheet:r===W&&(n=o.ARIA_Blank),n},t.prototype.CD=function(e){var o,n=this,r={e:e,r:v};return t.ao(n,"preProcessMouseUp",r),h(o=r.r)?(n.HD&&(n.HD=!1,n.OC.aq()),n.SD(),n.PD&&(n.PD=!1,n.TD.remove(),n.UD(),n.yD.hide()),n.OD=v,n.VD(),n.uC(),!n.ND||(n.ND=!1,!1)):o},t.prototype.DD=function(e){var o,n,r,i=this,a={e:e,r:v};return t.ao(i,"preProcessMouseOut",a),h(o=a.r)?(i.VD(),n=i.lD,i.lD=-1,r=i.iD,i.iD=-1,i.lD===n&&i.iD===r||i.repaint(),!1):o},t.prototype.tC=function(){var t,e=this;e.WD||(i.GC$(C).bind(F,(function(t){e.BD(t)})).bind(E,(function(t){e.CD(t)})),(t=e.OC.getActiveSheet())&&(t.XD=!0),e.WD=!0)},t.prototype.uC=function(){if(this.WD){this.WD=!1,i.GC$(C).unbind(F).unbind(E);var t=this.OC.getActiveSheet();t&&delete t.XD}},t.prototype.JD=function(t,e){var o,n=this;n.VD(),(o=n.sD()).length<=0||(200,0===(t%=4)?n.YD(o):1===t?(e||(n.ZD=y.setTimeout((function(){n.JD(1)}),200)),n.$D(o)):2===t?(e||(n.ZD=y.setTimeout((function(){n.JD(2)}),200)),n._D(o)):3===t&&n.aE(o))},t.prototype.KD=function(t,e,o){var n,r,i,a=this,s=a.OC;a.$C=t,a.ZC=e,s.suspendPaint(),n=s.getActiveSheet(),(r=s.XJc(t))&&r.isEditing()&&r!==n&&(i=n&&n.Cw&&n.Cw.V4,!r.gv(void 0,void 0,i))||(Q(s,r,t),a.iw(t,o),s.resumePaint(),a.repaint())},t.prototype.BHb=function(t,e,o,n,r,i){var s={oldValue:o,newValue:n,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:i};t.Wq(a.Events.SheetChanging,s),s.cancel||(e.DHb(n),t&&t.YJc&&t.YJc.repaint(),delete s.cancel,t.Wq(a.Events.SheetChanged,s))},t.prototype.MD=function(t){var e,o,n,r,i,s=this,l=s.OC,u=s.zJc(),c=l.getActiveSheet();if((!s.bE||s.bE(c))&&(Q(l,v,v),e=l.yJc(),o=l.getSheetCount(),n=l.vv(l.wv(o)),e.forEach((function(t){t.DHb(!1,!0)})),i={sheetName:r=n.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:o},s.BHb(l,n,!1,!0,r,o),l.Wq(a.Events.SheetChanging,i),!i.cancel)){for(l.ow(o,1,n),l.Wq(a.Events.SheetChanged,{sheetName:n.name(),propertyName:"insertSheet",sheetIndex:o}),s.$C=o,s.ZC=t,l.ZJc(l.sheets.length-1,1,!1,!0);s.$C>s.gq&&(s.YC()||s.gq<s.jw(-1));)s.hE(s.gq)&&(s.ZC-=u?s.WC[s.gq]:s.BJc),s.gq++;s.repaint()}},t.prototype.iw=function(t,e){var o,n,r,i,s,l,u,c=this,f=c.OC,h=f.yJc(),p=c.zJc(),d=f.getActiveSheet(),g=!1;d&&d.Cw&&d.Cw.V4&&(g=!0),!!e&&(o=a.Ul.sl()?e.metaKey:e.ctrlKey,n=e.shiftKey),t!==f.eq?(o?(r=h[t]).DHb()?r.DHb(!1,!0):(r.DHb(!0,!0),d&&!d.DHb()&&d.DHb(!0,!0)):n?(i=h.slice(w(f.eq,t),b(f.eq,t)+1),h.forEach((function(t){t.visible()&&(-1!==i.indexOf(t)?t.DHb()||t.DHb(!0,!0):t.DHb()&&t.DHb(!1,!0))}))):(s=h.every((function(t){return!t.visible()||t.DHb()})),h[t].DHb()&&!s||h.forEach((function(t){t.DHb(!1,!0)})),(r=h[t]).DHb()||r.DHb(!0,!0),f.ZJc(t,1,g,!0)),l=c.jw(c.gq),!1,u=p?c.ZC+c.WC[c.$C]>c._C():c.ZC+c.BJc>=c._C(),c.$C>c.gq&&u&&-1!==l&&(c.gq=l)):n&&h.forEach((function(t){var e=t.name();f.getSheetIndex(e)!==f.eq&&t.DHb()&&t.visible()&&t.DHb(!1,!0)})),c.$C<c.gq&&(c.gq=c.rw(c.gq))},t.prototype.cE=function(t,e){var o,n,r,s,u,c,f,h,d,g,y,C,b,w,T,A=this,I=A.OC,R=A.zJc(),M=I.options.tabStripPosition,k=m(a.Im.Lm("").zIndex),N=A.hitTest(t,e);if(N.element===z){if(o=A.$C,n=I.XJc(o),N.index!==o)return;if(I.Wq(a.Events.SheetTabDoubleClick,{sheet:n,sheetName:n.name(),sheetTabIndex:o}),!I.options.tabEditable)return!1;if((r=a.Vl.Xl())&&r.endEdit&&!r.endEdit())return;a.Vl.Zl(v),s=i.GC$(A.Ws()).offset(),u=I.xv(),c=i.GC$(u).offset(),f=i.GC$(u).width(),d=(h=p("input")).style,h.type="text",h.value=n.name(),h.setAttribute("contentEditable","true"),h.setAttribute("autocomplete","off"),d.position="absolute",d.margin="0px",d.padding="0px",g=void 0,y=void 0,C=void 0,b=void 0,w=A.WC[o],R?(b=w-A.EC-A.GC+2,C=s.top-c.top+A.aD(),g=s.left-c.left+A.ZC+A.EC):(T=A.Dr(),b=w-A.EC-A.GC+2,C=s.top-c.top+A.ZC+A.aD(),g=s.left-c.left+T.x+A.GJc+A.HJc,M===l.TabStripPosition.left&&2007===k&&(g+=A.GJc),M===l.TabStripPosition.right&&g+b>f&&(y=s.left+T.width-f+A.GJc+A.HJc)),y?d.right=y+S:g&&(d.left=g+S),d.top=C+S,d.width=b+S,d.backgroundColor=q,d.borderWidth="0px",d.outline=x,d.zIndex="1",i.GC$(h).appendTo(u),A.FD=h,i.GC$(h).addClass("gc-sheetTabEditor").bind(P,(function(t){return 13===t.keyCode?(A.GD(n,!1),!1):27===t.keyCode?(A.GD(n,!0),!1):void 0})).bind(L,(function(){h.selectionStart=0,h.selectionEnd=h.value.length})).bind(G,(function(){A.GD(n,!1)})),h.focus()}return!1},t.prototype.ED=function(e){var o,n,r,a,s=this,l={e:e,r:v};return t.ao(s,"preProcessMouseDbClick",l),h(o=l.r)?(n=i.GC$(s.Ws()).offset(),r=e.pageX-n.left,a=e.pageY-n.top,s.cE(r,a)):o},t.prototype.Rw=function(t){var e,o,n=this,r=n.zJc(),i=!h(n.FD);return r||i||(h(t.wheelDelta)&&h(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta,o=n.sD(),e>0?n.$D(o):n._D(o)),!1},t.prototype.GD=function(t,e){var o,n,r,s=this,l=s.FD;l&&(i.GC$(l).unbind(P).unbind(L).unbind(G),o=l.value,!1===e&&(o!==(n=t.name())&&(r={message:""},f(o,s.OC.yJc(),t,r)&&!h(o)&&""!==o?t.getParent().commandManager().execute({cmd:"renameSheet",sheetName:n,name:o}):t.Wq(a.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:r.message}))),l.parentNode.removeChild(l),delete s.FD)},t.prototype.dE=function(){return this.OC.options.allowSheetReorder},t.prototype.LD=function(t,e){var o=this;o.dE()?(o.vD=e.index,o.TD=o.eE(o.vD),o.OD=new a.Point(t.pageX,t.pageY),o.tC()):o.PD=!1},t.prototype.eE=function(t){var e,o,n=this.OC.yJc();if(!(t>=n.length||t<0))return(e=n[t].name())||(e="sheet"),(o=i.GC$(p("span")).text(e).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),o},t.prototype.VD=function(){var t=this.ZD;t&&(clearTimeout(t),this.ZD=v)},t.prototype.QD=function(t,e){var o,n,r=this.TD;r&&0===i.GC$(".gc-tab-tip-span").length&&(r.appendTo(C.body),r.hide()),o=r.width(),n=r.height(),r.css({left:t-o/2,top:e-n/2}),r.show()},t.prototype.RD=function(t){var e,o,n,r,a,s,u=this,c=u.OC,f=i.GC$(u.Ws()),p=f.position(),d=f.offset(),g=t.pageX-d.left,m=t.pageY-d.top,C=u.hitTest(g,m),b=C.element,w=u.Dr(),T=u.VC(),S=u.OC.yJc().length,x=c.options.tabStripPosition,A=u.zJc(),I=u.TC(),R=u.yD,M=A?g:m;M>(A?w.x+u._C():w.y+u._C()+I)?u.wD===v&&u.uD<S&&(u.wD=y.setInterval((function(){u._D(u.sD()),u.uD===S?(u.SD(),x===l.TabStripPosition.bottom?(e=p.left+u.fE()-3.5,o=p.top-3.5):x===l.TabStripPosition.top?(e=p.left+u.fE()-3.5,o=p.top+w.height):x===l.TabStripPosition.left?(e=p.left+w.width,o=p.top+u.fE()-3.5):x===l.TabStripPosition.right&&(e=p.left-3.5,o=p.top+u.fE()-3.5),R.show()):(u.uD++,R.hide()),R.css({left:e,top:o})}),100)):M<T?u.wD===v&&u.uD>0&&(u.wD=y.setInterval((function(){u.$D(u.sD()),0===u.uD?(u.SD(),x===l.TabStripPosition.bottom?(e=p.left+T-3.5,o=p.top-3.5):x===l.TabStripPosition.top?(e=p.left+T-3.5,o=p.top+w.height):x===l.TabStripPosition.left?(e=p.left+w.width,o=p.top+I-3.5):x===l.TabStripPosition.right&&(e=p.left-7,o=p.top+I-3.5),R.show()):(u.uD--,R.hide()),R.css({left:e,top:o})}),100)):(u.SD(),b!==z&&-1===u.Via().indexOf(b)||(n=C.index,b===W&&(n=u.uD),(b!==z||h(n))&&(n=S),r=function(t,e,o,n,r){return(o<n&&t>n||o>=n&&t<n)&&(e=function(t,e,o,n){var r;if(e>o)for(r=o;r<e;r++)t-=n[r];else if(e<o)for(r=e;r<o;r++)t+=n[r];return t}(e,t,n,r),t=n),{index:t,position:e}}(n,C.position,u.vD,u.OC.getSheetCount(),u.WC),a=r.index,s=r.position,u.uD=a,x===l.TabStripPosition.bottom?(e=p.left+s-3.5,o=p.top-7):x===l.TabStripPosition.top?(e=p.left+s-3.5,o=p.top+w.height):x===l.TabStripPosition.left?(e=p.left+w.width,o=p.top+s-3.5):x===l.TabStripPosition.right&&(e=p.left-7,o=p.top+s-3.5),R.css({left:e,top:o}),R.show()))},t.prototype.fE=function(){var t,e=this,o=e.zJc(),n=e.WC,r=e.sD(),i=e.gE(e.gq,r),a=0,s=e.VC(),l=e.BJc,u=o?s+e.LC:s;for(t=i;t<r.length;t++)a=r[t],o?(u+=n[a],u+=e.HC):u+=l;return u},t.prototype.SD=function(){var t=this.wD;t&&(clearInterval(t),this.wD=v)},t.prototype.UD=function(){var t=this,e=t.OC,o=t.uD,n=t.vD,r=e.sheets[n];-1!==o&&-1!==n&&n!==o&&n!==o-1&&t.yD.isVisible()&&(n<o-1&&(o-=1),e.commandManager().execute({cmd:"moveSheet",sheetName:r.name(),targetIndex:o}))},t.prototype.DXc=function(t,e){var o=this,n=o.OC,r=o.sD();return e===n.getSheetCount()?(o.aE(r),void o.fq()):0===e?(o.YD(r),void o.fq()):void(o.EXc(t,e)&&o.RIc(e))},t.prototype.EXc=function(t,e){var o,n=this.TIc().tabsInfo,r=!1,i=!1;for(o=0;o<n.length;o++)if(t===n[o].index&&(r=!0),e===n[o].index&&(i=!0),r&&i)return this.fq(),!1;return!0},t.prototype.sD=function(){var t,e=[],o=this.OC.yJc();for(t=0;t<o.length;t++)this.hE(t)&&e.push(t);return e},t.prototype.YD=function(t){t.length>0&&this.gq!==t[0]&&this.OC.startSheetIndex(t[0])},t.prototype.$D=function(t){var e,o;t.length>0&&((e=this).gq>t[0]&&(-1!==(o=e.rw(e.gq))&&e.OC.startSheetIndex(o)))},t.prototype._D=function(t){var e;t.length>0&&((e=this).gq<t[t.length-1]&&(-1!==e.rD(t)&&e.OC.startSheetIndex(e.jw(e.gq))))},t.prototype.aE=function(t){if(t.length>0&&this.gq<t[t.length-1]){var e=this.rD(t);-1!==e&&this.OC.startSheetIndex(e)}},t.prototype.rD=function(t){var e,o,n,r,i,a,s,l,u,c,f,h;if(t.length>0)for(o=(e=this).zJc(),n=e.BJc,r=e._C(),i=0,a=e.WC,s=void 0,l=void 0,u=e.cD(),-1===(c=e.gE(e.gq,t))&&(c=0),s=t.length-1;s>=c;s--)if(l=t[s],i+=o?a[l]:n,s!==t.length-1&&(i+=o?e.HC:0),f=u+i,0!==s&&(f+=o?e.LC:n),f>r)return void 0,h=s+1<t.length?t[s+1]:t[t.length-1],e.gq<h?h:-1;return-1},t.prototype.rw=function(t){var e;for(e=t-1;e>=0;e--)if(this.hE(e))return e;return-1},t.prototype.jw=function(t){var e,o=this.OC.yJc().length;for(e=t+1;e<o;e++)if(this.hE(e))return e;return-1},t.prototype.gE=function(t,e){var o;for(o=0;o<=e.length-1;o++)if(t===e[o])return o;return-1},t.prototype.hE=function(t){var e=this.OC.XJc(t);return e&&e.visible()},t.prototype.fw=function(){this.xD++},t.prototype.gw=function(){var t=this;t.xD--,t.xD<=0&&(t.xD=0,t.repaint())},t.prototype.repaint=function(t){var e=this.Ws();e&&e.getContext&&this.jp(e.getContext(_),t)},t.prototype.jp=function(t,e){var o,n,r,i,s,l,u,c,f,h,d,g,m,y=this;if(!(y.xD>0)){if(o=y.Dr(),n=y.Xs,e){if(e.x>=o.x+o.width)return;if(e.y>=o.y+o.height)return;if(e.x+e.width>o.width&&(e.width=o.width-e.x,e.width<=0))return;if(e.y+e.height>o.height&&(e.height=o.height-e.y,e.height<=0))return;if(e.width<=0||e.height<=0)return}if((i=y.buffer)&&(!i||i.width===n.width&&i.height===n.height)&&(i||i.width===o.width&&i.height===o.height)||(i&&a.En.Rn(y.OC,i),y.buffer=i=p(B),a.En.Kn(i,y.OC),a.En.Pn(i,o.width,o.height)),!(o.width<=0||o.height<=0||e&&(e.width<=0||e.height<=0))){(r=y.buffer.getContext(_)).clearRect(0,0,o.width,o.height),a.Bn.Dn(r,-o.x,-o.y),y.iE(r,e),a.Bn.Dn(r,o.x,o.y),u=s=o.x>=0?0:-o.x,c=l=o.y>=0?0:-o.y,e&&(u=o.x+e.x,c=o.y+e.y,o=new a.Rect(u,c,e.width,e.height)),s=o.x>=0?o.x:0,l=o.y>=0?o.y:0,d=v,g=a.En.Ln(n),m=a.En.Mn(n),n&&1!==g&&(u*=g,c*=m,o.x*=g,o.y*=m,o.width*=g,o.height*=m);try{n?e?(f=b(o.width-u,0),h=b(o.height-c,0)):(f=w(o.width-u,b(n.width-o.x,3)),h=w(o.height-c,b(n.height-o.y,3))):(u=e.x,c=e.y,f=e.width,h=e.height),n?(a.Bn.Cn(t,1,1),t.clearRect(s,l,f,h),t.drawImage(y.buffer,u,c,f,h,s,l,f,h),a.Bn.Cn(t,g,m)):d=(r=y.buffer.getContext(_)).getImageData(u,c,f,h)}catch(t){return}!n&&d&&o.width>0&&o.height>0&&t.putImageData(d,s,l)}}},t.prototype._Jc=function(t,e){var o=this.Dr();e?t.rect(e.x,e.y,e.width,e.height):t.rect(o.x,o.y,o.width,o.height),t.clip()},t.prototype.aKc=function(t){var e,o,n,r=this,i=r.OC,a=r.zJc();for(t.save(),t.font=s.To.Ro(t.font,"bold"),r.WC=[],n=i.yJc(),o=0;o<n.length;o++)e=Math.round(t.measureText(n[o].name()).width)+r.GC+r.EC,r.WC.push(e);a||(r.BJc=d(t.font)+2*r.SJc),t.restore()},t.prototype.TIc=function(){var t,e,o,n=this,r=n.OC.yJc(),i=n.zJc(),a=n.Dr(),s=[],l=n.VC(),u=n.gq;for(i&&u>0&&n.rw(u)>=0&&(l+=n.LC),u<0&&(n.gq=0),e=n.gq;e<r.length;e++){if(o=r[e].visible(),t=n.WC[e],i){if(l>a.x+a.width)break}else if(l>a.y+a.height)break;s.push({index:e,position:l,width:t,text:r[e].name(),visible:o}),o&&(l+=i?t+n.HC:n.BJc)}return{tabsInfo:s,newTabStartPosition:l}},t.prototype.iE=function(t,e){var o,n,r,i,a=this,s=a.OC,u=s.options.scrollbarAppearance===l.ScrollbarAppearance.mobile,c=s.options.tabStripPosition,f=s.options.showHorizontalScrollbar;t&&s&&(o=a.Dr(),t.save(),g(t,a._font),a._Jc(t,e),t.beginPath(),a.aKc(t),r=(n=a.TIc()).tabsInfo,i=n.newTabStartPosition,a.dD(t,o),a.fD(t,o,i),a.jE(t,o,r),a.OC&&a.OC.options.tabNavigationVisible&&a.kD(t,o),f&&!u&&c===l.TabStripPosition.bottom&&a.nD(t,o),t.beginPath(),t.restore())},t.prototype.dD=function(t,e){},t.prototype.fD=function(t,e,o){},t.prototype.bKc=function(t,e){var o,n,r=this,i=r.zJc(),a=r.VC();i?(o=e.x+r._C(),t.rect(a,0,o-a,e.height)):(n=r.PC(),t.rect(0,a,e.width,e.height-a-n)),t.clip()},t.prototype.cKc=function(t,e,o){var n,r,i,a=this,s=a.OC,l=a.zJc(),u=a.$C,c=a.iD;for(n=o.length-1;n>=0;n--)(r=o[n]).index!==u&&r.visible&&(i=s.MJc(r.text).DHb(),l?a.oD(t,r.position,0,r.width,e.height,r.index,!1,r.index===c,r.text,i):a.oD(t,0,r.position,e.width,a.BJc,r.index,!1,r.index===c,r.text,i))},t.prototype.dKc=function(t,e,o){var n,r,i=this,a=i.OC,s=a.yJc(),l=i.zJc(),u=i.$C,c=i.gq,f=o[u-c];u>=c&&u<s.length&&f&&f.visible&&((n=a.WJc())&&(r=n.DHb(),l?i.oD(t,f.position,0,f.width,e.height,u,!0,!1,f.text,r):i.oD(t,0,f.position,e.width,i.BJc,u,!0,!1,f.text,r)))},t.prototype.eKc=function(t,e){var o=this,n=o.gq,r=o.zJc(),i=o.VC();n>0&&o.rw(n)>=0&&r&&o.jD(t,e,n,i)},t.prototype.jE=function(t,e,o){var n=this,r=n.OC,i=r.yJc();n.$C=r.fKc(),i.length>0&&(t.save(),t.beginPath(),n.bKc(t,e),n.cKc(t,e,o),n.dKc(t,e,o),t.restore(),t.save(),t.beginPath(),n.eKc(t,e),t.restore())},t.prototype.jD=function(t,e,o,n){},t.prototype.kD=function(t,e){},t.prototype.nD=function(t,e){},t.prototype.mD=function(t,e,o,n,r,i,a,s,l,u){},t.prototype.oD=function(t,e,o,n,r,i,a,s,l,u){},t.prototype.Ws=function(){return this.Xs},t.prototype.kE=function(t,e){var o,n,r,i,s=t.createLinearGradient(e.x,e.y,e.width,e.height),u=a.Im.Km(l.VisualState.normal,"gc-tabStripBackground"),f=u&&u.backgroundImage,h=u&&u.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(n=0,r=(o=c(f)).length;n<r;n++)i=o[n],s.addColorStop(i.point,i.color);else h&&(s.addColorStop(0,"#DDDDDD"),s.addColorStop(1,h));return s},t.prototype.pD=function(t,e,o,n,r){var i,s,l,u,f,h,p,d,g,m,y,C,v,b,w=this,T=w.zJc(),S=w.Dr();if(T?i=t.createLinearGradient(S.x+.7*S.height,S.y+0,.7*S.height,S.height):(s=S.y,l=0,r>0&&(s=r,l=w.BJc),i=t.createLinearGradient(S.x+.7*l,s,.7*l,s+l)),u=w.OC.MJc(o),""===o&&w.gq>0&&(u=w.OC.XJc(w.gq-1)),h=(f=u&&u.options)&&f.sheetTabColor)"rgba(0, 0, 0, 0)",t.fillStyle="rgba(0, 0, 0, 0)",p=t.fillStyle,t.fillStyle=a.Rm.Om(u,h),(d=t.fillStyle)!==p&&(e?(i.addColorStop(0,q),i.addColorStop(.45,"#F1F6FD"),i.addColorStop(.9,d),i.addColorStop(1,q)):i=d);else if(n)if(g=n.backgroundImage,m=n.backgroundColor,g&&-1!==g.indexOf("linear-gradient"))for(C=0,v=(y=c(g)).length;C<v;C++)b=y[C],i.addColorStop(b.point,b.color);else m&&i.addColorStop(0,m);return i},t.prototype.qD=function(t,e){var o="black";return t&&(o=t.color),e&&u.dc(u.ec(e))<127.5&&(o=q),o},t}(),e.DC=K,a.Zn(K)},"./dist/core/workbook/workbook-json.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function C(t,e){return t.hasOwnProperty(e)}function v(t){var e,o,n,r;if(!t||"string"!=typeof t)return 1;if((o=(e=t.split(".")).length)>3)return 3;if(n=y(e[0]),o<=2)return isNaN(n)?1:n;if(r=y(e[1]),n>=10)return n;if(n>=3){if(r>=20143)return 3;if(r>=20142)return 2}return 1}function b(t,e){var o,n,r,i,a=e&&e.frozenColumnsAsRowHeaders,s=e&&e.frozenRowsAsColumnHeaders,l=0,u=t.sheets;if(s||a)for(n in u)"string"==typeof n&&(r=u[n],i=m(r.index)?r.index:r.mi,o=this.sheets[m(i)?i:l],s&&m(r.frozenRowCount)&&(o.$Bb=!0,o.deleteRows(0,r.frozenRowCount)),a&&m(r.frozenColCount)&&o.deleteColumns(0,r.frozenColCount),l++)}function w(t,e){var o=e.sheetTabCount;m(o)&&t.gKc(o,0)}function T(t,e,o,n){var r,i,a=0,s=e.sheetTabs;if(s)for(r in s)"string"==typeof r&&(i=s[r],t.pJc[a].fromJSON(i,!1,o,n,!0),a++)}function S(t,e){var o,n=e.activeSheetTabIndex;m(n)&&(t.hKc(n,0),(o=t.pJc[n])&&o.DHb(!0,!1))}function x(t,e,o){n.Workbook._n&&g(n.Workbook._n,(function(n,r){var i=r[e];i&&i.call.apply(i,[t].concat(o))}))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/workbook/workbook.js"),r=o("./dist/core/worksheet/style.js"),i=o("./dist/core/util/domUtil.js"),a=o("./dist/core/util/tasks.js"),s=o("Common"),l=o("./dist/core/util/common.js"),u=o("@grapecity/js-calc"),c=!!u,f=r.Style.kxb,h=s.Commands.UndoManager,p=s.Common.CultureManager,d=s.Common.j.C4,s.Common.j.Fa,g=i.GC$.each,m=l.Ul.Ol,y=parseFloat,n.Workbook.prototype.toJSON=function(t){var e,o,r,a,s,f,h,p,m,y,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F=this,E={version:l.productInfo.productVersion},j=t&&t.rowHeadersAsFrozenColumns,P=t&&t.columnHeadersAsFrozenRows,L=j||P;if(L&&(t.Yec=!0),F.EHb&&(E.docProps=d(F.EHb)),c&&((e=u.Functions.setLanguagepackage)&&(o=e(),e("en"))),(r=F.getSheetCount())!==n.Workbook.nv&&(E.sheetCount=r),L)for(a=new n.Workbook,s=t&&t.includeAutoMergedCells,a.fromJSON(F.toJSON({includeBindingSource:!0,includeAutoMergedCells:s})),F=a,f=0;f<r;f++)p=(h=F.getSheet(f)).getRowCount(1),m=h.getColumnCount(2),v=P&&p>0,(y=j&&m>0)&&h.addColumns(0,m),v&&h.addRows(0,p,v),y&&h.Zec(m,v?p:0),v&&h.$ec(p,y?m:0);for(F.mv=!0,F.suspendPaint(),F.suspendEvent(),c&&((b=F.Wu).calcOnDemand&&(b.calcOnDemand=!1,F.FHb(),b.suspend(!0),b.resume(!0),b.calcOnDemand=!0),b.suspend(!0)),(w=F.startSheetIndex())&&(E.startSheetIndex=w),g(F.options,(function(t,e){"_ps"!==t&&n.Workbook.Qp[t]!==e&&(E[t]=e)})),(T=F.getActiveSheetIndex())!==n.Workbook.ov&&(E.activeSheetIndex=T),S={},x=0;x<r;x++)S[(h=F.getSheet(x)).name()]=h.toJSON(t),S[h.name()].index=x;for(i.GC$.isEmptyObject(S)||(E.sheets=S),0!==(A=F.getSheetTabCount())&&(E.sheetTabCount=A),-1!==(I=F.getActiveSheetTabIndex())&&(E.activeSheetTabIndex=I),R={},M=0;M<A;M++)R[(k=F.getSheetTab(M)).name()]=k.toJSON(t),R[k.name()].index=r+M;if(i.GC$.isEmptyObject(R)||(E.sheetTabs=R),N=[],O=F.Lq){for(D in O)C(O,D)&&N.push(O[D]);N.length>0&&(E.namedStyles=N)}return n.Workbook._n&&g(n.Workbook._n,(function(e,o){o.toJson&&o.toJson.call(F,E,t)})),c&&e&&e(o),F.mv=!1,c&&F.Wu.resume(!1),F.resumeEvent(),F.resumePaint(),L&&delete t.Yec,E},n.Workbook.prototype.fromJSON=function(t,e){var o,i,a,s,u,y,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X=this;if(X.vXc(),t){if(e&&e.incrementalLoading)return!0===e.incrementalLoading&&(e.incrementalLoading={}),X.egc(t,e);o=v(t.version),a={noSchema:i=o<3,version:o},s=l.Vl.Xl(),X.mv=!0,X.suspendPaint(),X.suspendEvent(),u=p.culture(),p.culture("");try{for(M in X.T3(),X.pv=new h(X,-1,X.options.allowUndo),c&&X.qv(!0),c&&X.Wu.suspendAdjust(),X.lv=-1,X.clearSheets(),X.clearSheetTabs(),y=X.options,A=t.canUserEditFormula,m(A)&&(y.allowUserEditFormula=A),I=t.allowDragDrop,m(I)&&(y.allowUserDragDrop=I),R=t.allowDragFill,m(R)&&(y.allowUserDragFill=R),y)C(y,M)&&(k=t[M],m(k)&&(y[M]=k));if(X.EHb=d(t.docProps),x(X,"preFromJson",[t,i,e]),N=t.sheetCount,m(N)||(N=n.Workbook.nv),X.sw(N,0),X.Lq={},X.dkc={},O=t.namedStyles)for(D=0,F=O;D<F.length;D++)E=F[D],j=new r.Style,f(E,X),j.fromJSON(E,i,X),X.Kq(j);if(P=0,void 0,L=t.sheets,G=void 0,B=void 0,_=!1,V=!0,L)for(H in L)"string"==typeof H&&(z=L[H],U=m(z.index)?z.index:z.mi,X.sheets[m(U)?U:P].fromJSON(z,!1,a,e,!0),P++,B=z.allowUndo,_?V=V&&B===G:(G=B,_=!0));m(G)&&V&&(y.allowUndo=G),W=t.activeSheetIndex,m(W)||(W=n.Workbook.ov),X.dq(W,0),(q=X.sheets[W])&&q.DHb(!0,!1),w(X,t),T(X,t,a,e),S(X,t),J=t.startSheetIndex,m(J)&&X.startSheetIndex(J),n.Workbook._n&&g(n.Workbook._n,(function(o,n){var r=n.fromJson;r&&r.call(X,t,i,e)})),c&&X.Wu.resumeAdjust(),b.call(X,t,e),n.Workbook.ao(X,"initCustomName")}finally{c&&X.Wu.resumeAdjust(),p.culture(u),X.mv=!1,q=X.getActiveSheet(),s&&q&&q.zt(),X.resumeEvent(),X.fq(),X.resumePaint(),q&&X.Wq(l.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:q})}}},n.Workbook.prototype.egc=function(t,e){var o,i,s,u,y,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y=this;Y.fgc&&Y.fgc.terminate(),Y.fgc=new a.Tasks((function(){var t,e,o,n=Y.getActiveSheet();if(!n.loaded)for(t=this.tasks.length-1;t>=0;t--)if((e=this.tasks[t].args[0])&&e.ITa&&e.name&&e.name()===n.name())return o=this.tasks[t],this.tasks.splice(t,1),o;return this.tasks.pop()}),(function(){var t=Y.getActiveSheet();return t&&(Y.ku.Gw||t.isEditing()||t.mm.OG||t.mm.xG||t.mm.eG)})),o=v(t.version),s={noSchema:i=o<3,version:o},u=l.Vl.Xl(),Y.mv=!0,Y.suspendPaint(),Y.suspendEvent(),y=p.culture(),p.culture("");try{for(k in Y.T3(),Y.pv=new h(Y,-1,Y.options.allowUndo),c&&Y.qv(!0),c&&Y.Wu.suspendAdjust(),Y.lv=-1,Y.clearSheets(),Y.clearSheetTabs(),A=Y.options,I=t.canUserEditFormula,m(I)&&(A.allowUserEditFormula=I),R=t.allowDragDrop,m(R)&&(A.allowUserDragDrop=R),M=t.allowDragFill,m(M)&&(A.allowUserDragFill=M),A)C(A,k)&&(N=t[k],m(N)&&(A[k]=N));if(Y.EHb=d(t.docProps),x(Y,"preFromJson",[t,i,e]),O=t.sheetCount,m(O)||(O=n.Workbook.nv),Y.sw(O,0),Y.Lq={},D=t.namedStyles)for(F=0;F<D.length;F++)E=D[F],j=new r.Style,f(E,Y),j.fromJSON(E,i,Y),Y.Kq(j);if(P=0,G=t.sheets,B=void 0,_=void 0,V=!1,H=!0,G)for(U in z={total:0,valuesLoad:0,formulaLoad:0},P=0,e.incrementLoadTask=Y.fgc,e.incrementalLoading.loadStatus=z,G)"string"==typeof U&&(W=G[U],q=m(W.index)?W.index:W.mi,(L=Y.sheets[m(q)?q:P]).loading=!0,L.cq(W.name+"",!0),L.DHb(W.isSelected),L.setRowCount(W.rowCount),L.setColumnCount(W.columnCount),m(W.visible)&&L.visible(W.visible),z.total+=L.getRowCount(),Y.fgc.addTask((function(t,o){t.egc(o,!1,s,e,!0)}),[L,W]),P++,_=W.allowUndo,V?H=H&&_===B:(B=_,V=!0));m(B)&&H&&(A.allowUndo=B),J=t.activeSheetIndex,m(J)||(J=n.Workbook.ov),Y.dq(J,0),(X=Y.sheets[J])&&X.DHb(!0,!1),w(Y,t),T(Y,t,s,e),S(Y,t),Z=t.startSheetIndex,m(Z)&&Y.startSheetIndex(Z),Y.fgc.endingCallback=function(){n.Workbook._n&&g(n.Workbook._n,(function(o,n){n.egc?Y.fgc.addTask((function(t,e,o,r){n.egc.call(t,e,o,r)}),[Y,t,i,e]):n.fromJson&&n.fromJson.call(Y,t,i,e)})),Y.fgc.endingCallback=function(){var o,r;for(c&&Y.Wu.resumeAdjust(),b.call(Y,t,e),n.Workbook.ao(Y,"initCustomName"),o=0;o<Y.sheets.length;o++)delete Y.sheets[o].loading;(L=Y.getActiveSheet())&&Y.Wq(l.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:L}),e&&e.incrementalLoading&&e.incrementalLoading.loading&&e.incrementalLoading.loading(1,{sheet:L}),(r=e&&e.incrementalLoading&&e.incrementalLoading.loaded)&&r(),L&&L.repaint(),Y.fgc.endingCallback=void 0},Y.fgc.start()},Y.fgc.start()}finally{p.culture(y),Y.mv=!1,X=Y.getActiveSheet(),u&&X&&X.zt(),Y.resumeEvent(),Y.fq(),Y.resumePaint()}}},"./dist/core/workbook/workbook.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St;function xt(t){return t.getActiveSheet()}function At(t,e){return s.En.npb()%1!=0||t.zoom()%1!=0||t.parent&&t.parent.options.scrollByPixel&&e&&t.mJb&&t.mJb.mgc(s.kf(t.lq,t.qq,1,1))}function It(t,e){return O.setTimeout((function(){t.invalidateLayout(),t.repaint(),e.GHb=F;var o=t.Dr();e.pWc(t,o.x,o.width),e.sWc(t,o.y,o.height)}),200)}function Rt(t,e,o){t.Wq(s.Events.ActiveSheetChanged,{oldSheet:e,newSheet:o})}function Mt(t,e){t.Wq(s.Events.ActiveSheetChanging,e)}function kt(t,e){t.Wq(s.Events.FormulatextboxActiveSheetChanging,e)}function Nt(t,e,o){t.Wq(s.Events.FormulatextboxActiveSheetChanged,{oldSheet:e,newSheet:o})}function Ot(t){var e=s.Im.Lm("gc-footer-corner"+at);a.GC$(t).css({border:ot,padding:0,margin:0,"background-color":e.backgroundColor})}function Dt(t){var e=a.GC$(t);return{top:Ft(e,"borderTopWidth"),right:Ft(e,"borderRightWidth"),bottom:Ft(e,"borderBottomWidth"),left:Ft(e,"borderLeftWidth")}}function Ft(t,e){var o=t.css(e);switch(o){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(o)}}function Et(t){var e=a.GC$(t);return{top:parseFloat(e.css("paddingTop")),right:parseFloat(e.css("paddingRight")),bottom:parseFloat(e.css("paddingBottom")),left:parseFloat(e.css("paddingLeft"))}}function jt(t){var e=t.getBoundingClientRect().width,o=Dt(t),n=o.left,r=o.right,i=Et(t);return e-n-r-i.left-i.right}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/workbook/workbookpanelex.js"),r=o("./dist/core/core.ns.js"),i=o("Common"),a=o("./dist/core/util/domUtil.js"),s=o("./dist/core/util/common.js"),l=o("./dist/core/util/imageLoader.js"),u=o("./dist/core/worksheet/worksheet-actions.js"),c=o("./dist/core/workbook/sheettab.js"),f=o("./dist/core/workbook/sheettab2007.js"),h=o("./dist/core/worksheet/stylehelper.js"),p=o("./dist/core/worksheet/clipboardhelper.js"),d=o("./dist/core/worksheet/worksheet.js"),g=o("@grapecity/js-calc"),m=!!g,y=o("./dist/core/core.enum.js"),C=i.Common.u,v=i.Commands.UndoManager,b=i.Commands.CommandManager,w=a.GC$.each,T=a.GC$.extend,S=m,x=i.Common.j.Fa,A=s.Ul.Nl,I=s.Ul.Pl,R=s.Ul.Ql,M=s.Ul.hZa,k=i.Common.CultureManager,N=parseInt,O=window,D=document,F=null,E=Math.round,j=Math.min,P=Math.floor,L=Math.abs,G="number",B="mousedown",_="mousemove",V="mouseup",H="mouseenter",z="mouseleave",U="scroll",W="resize",q="focus",J=".gcSpread",X=".gcSpreadInternal",Z=".gcScrollbar",Y="div",K="table",Q="px",$="100%",tt="gc-scroll-handle",et="gc-scroll-bar",ot="none",nt="absolute",rt="content-box",it="solid",at=" ui-widget-header ui-state-default btn btn-default",st="gc-scroll-mobile-container",lt="gc-scroll-mobile-container-horizontal",ut="gc-scroll-mobile-container-vertical",ct="gc-scroll-mobile-spread-hovering",ft="gc-scroll-mobile-state-hide",ht="gc-scroll-mobile-state-hover",pt=O.jQuery,dt="cultureChanged",gt="workbook",mt="gcUIElement",yt="gc-no-user-select",Ct="en-US",vt=new i.Common.ResourceManager(r.SR,"Sheets"),bt=vt.getResource.bind(vt),wt=function(){function t(t){this.yw=t}return t.Lv=function(t,e){var o,n=t.data,r=n.ku;r.HHb&&(O.clearTimeout(r.HHb),r.HHb=F),(o=n.WJc())&&e&&o.iKc(n,e)},t.Mv=function(t){var e=t.data,o=e.WJc();o&&o.jKc(e)},t.Nv=function(t){var e,o,n,r,i,s=t.data;s&&((e=xt(s))?((o=s.kKc.xR)&&o.mR&&(e.CH=!0),e.zt(),1!==(n=s.options.showScrollTip)&&3!==n||(i=(r=a.GC$(t.srcElement||t.target)).parent(),(r&&(r.hasClass(tt)||r.hasClass(et))||i&&(i.hasClass(tt)||i.hasClass(et)))&&s.ku.Dw(!1,t))):s.getActiveSheetTab().zt())},t.Dv=function(t,e){var o,n=t.data,r=n.ku;r.HHb&&(O.clearTimeout(r.HHb),r.HHb=F),(o=n.WJc())&&e&&o.lKc(n,e)},t.Ev=function(t){var e=t.data,o=e.WJc();o&&o.mKc(e)},t.Fv=function(t){var e,o,n,r,i,s,l=t.data;l&&((e=xt(l))?((o=l.nKc.xR)&&o.mR&&(e.CH=!0),e.zt(),2!==(n=l.options.showScrollTip)&&3!==n||(r=a.GC$(t.srcElement||t.target))&&(i=r.parent(),(r.hasClass(tt)||i&&i.hasClass(tt)||r.hasClass(et)||i&&i.hasClass(et))&&l.ku.Dw(!0,t))):(s=l.getActiveSheetTab())&&s.zt())},t.Gv=function(t){var e=t.data;e&&e.xw()},t.ggc=function(t){var e,o,n,r=bt(),i=t.data,s=t.scrollbar;i.options.enableAccessibility&&(e=a.GC$(s.Bv()).offset(),o=s.hitTest(t.x-e.left,t.y-e.top),n={thumbButton:r.ARIA_Scrollbar_Thumb_Button,trackButton:r.ARIA_Scrollbar_TRACK_Button,leftButton:r.ARIA_Scrollbar_Left_Button,rightButton:r.ARIA_Scrollbar_Right_Button,upButton:r.ARIA_Scrollbar_Top_Button,downButton:r.ARIA_Scrollbar_Bottom_Button}[o.element],i.dgc(n))},t.prototype.no=function(){this.yw=F},t.prototype.Bw=function(t,e,o,n){var r=this;t&&(r.Gw=!0,r.Hw=n?t.lq:e,r.bCb=n?t.cCb:o,r.Iw=n?e:t.qq,r.dCb=n?o:t.eCb,O.setTimeout((function(){r.Kw(t)}),0))},t.prototype.Kw=function(t){var e=this;t&&e.Gw&&(e.Gw=!1,e.Lw(t))},t.prototype.Lw=function(t){var e,o,n,r,i,a,s=this;s.Mw||(s.Mw=!0,e=s.yw,t&&(o=e.options.showScrollTip,n=s.Hw,r=s.bCb,i=s.Iw,a=s.dCb,n!==t.lq||r!==t.cCb?(s.ju(t,n,r),2!==o&&3!==o||e.ww(s.Nw(!0))):i===t.qq&&a===t.eCb||(s.lu(t,i,a),1!==o&&3!==o||e.ww(s.Nw(!1)))),s.Mw=!1)},t.prototype.ju=function(t,e,o,n){var r,i,a,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,A,I,R,M,k,N,D,E,P,G,B,_,V,H,z,U,W,q=this;if(q.GHb&&(O.clearTimeout(q.GHb),q.GHb=F),t){if(r=t.lq,i=t.cCb,!(a=!x(n))&&e===r&&o===i)return;if(a&&(r=n),t.lq=e,t.cCb=o,t.Xq>0)return void(r!==e&&t.Wq(s.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:r,newTopRow:e}));if(l=!1,f=(c=(u=t.options).sheetAreaOffset.top)+2,h=t.Zs,d=(p=t.am()).qt,g=t.oKc(p),m=p.pKc,y=p.ot,C=p.gs,v=p.width+u.sheetAreaOffset.left,b=void 0,w=void 0,T=void 0,A=(S=t.yl).bm(),I=t.qKc,t.tables&&0===t.frozenRowCount()&&((R=t.tables.KHb())&&(R.x=R.x-2,R.width=R.width+4,R.y=c,R.height=d,t.$l=!0,S._l(A,R))),e>r||e===r&&L(o)>L(i)){if(M=void 0,k=void 0,(N=t.Gr(1))&&N.length>0&&(M=N.findRow(e)),M){for(k=N[D=N.length-1];k&&k.y+k.height>d+g;)k=N[D-=1];k&&k.row>e&&(l=!0,w=h?h.x:p.x,T=M.y+L(o),b=k.y+k.height-T-f,S.Ow(w,T,v,b,w,d),u.colHeaderVisible||(t.invalidateLayout(),S._l(A,new s.Rect(w,0,v,c))),t.invalidateLayout(),E=I?g:g+C+m,S._l(A,new s.Rect(w,d+b,v,E-b)),E-=I?0:m,S.Pw(A,new s.Rect(w,d-2,v,E+2)),this.pWc(t,w,v))}}else{for(P=0,G=e;G<r&&P<g;G++)P+=t.Sl(G);(P+=L(i)-L(o))<g&&(l=!0,w=h?h.x:p.x,T=d,b=g-P,t.frozenTrailingRowCount()>0&&(b-=1),B=0,!I&&m>0&&(B=C,_=j(h.height-B-1,y-1+P),S.Ow(w,y-1,v,B+1,w,_)),V=I?0:j(P,m)-1,S.Ow(w,T,v,b+V,w,T+P),t.invalidateLayout(),H=t.rowOutlines&&!t.rowOutlines.iT()?t.rowOutlines.s0a()+c+1:0,S._l(A,new s.Rect(w,T-c,v,P+c+H+5)),z=g+V+B+2,S.Pw(A,new s.Rect(w,T-2,v,z)),this.pWc(t,w,v))}l||(t.invalidateLayout(),t.repaint()),r!==e&&t.Wq(s.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:r,newTopRow:e}),(U=t.mm)&&U.Qw(),W=r===t.lq&&i!==t.cCb,l&&At(t,W)&&(q.GHb=It(t,q))}},t.prototype.pWc=function(t,e,o){var n=t.yl,r=n.bm();this.qWc(t).concat(this.rWc(t)).forEach((function(t){var i=t.layout,a=new s.Rect(e,i.y,o,i.height);n.dm(a),n.Pw(r,a)}))},t.prototype.qWc=function(t){var e,o,n,r,i,a,s,l=t.getSelections();return 1===l.length?(e=this.yw.options.scrollByPixel,o=t.lq,n=t.cCb,r=l[0].row,i=l[0].row+l[0].rowCount-1,e&&i===o-1?[]:(a=[],(r===o+1||r<o&&o<=i||i===o-1||e&&r===o&&0!==n)&&((s=t.Gr(0))&&s.length>0&&a.push({layout:s[s.length-1]})),a)):[]},t.prototype.rWc=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p=t.getSelections();return 1===p.length?(e=this.yw.options.scrollByPixel,o=t.getViewportBottomRow(1),n=p[0].row,r=p[0].row+p[0].rowCount-1,i=[],l=(s=(a=t.Gr(2))&&a.length>0)?a[0]:F,f=(c=(u=t.Gr(1))&&u.length>0)?u.findRow(o):F,h=s&&c&&l.y!==f.y+f.height,(r===o-1||n<=o&&o<r||n===o+1||e&&r===o&&h)&&s&&i.push({layout:l}),i):[]},t.prototype.lu=function(t,e,o,n){var r,i,a,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,A,I,R,M,k,N,D,E,P,G,B,_,V,H,z,U,W=this;if(W.GHb&&(O.clearTimeout(W.GHb),W.GHb=F),t){if(r=t.qq,i=t.eCb,!(a=!x(n))&&e===r&&o===i)return;if(a&&(r=n),t.qq=e,t.eCb=o,t.Xq>0)return void(r!==e&&t.Wq(s.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:r,newLeftCol:e}));if(l=!1,f=(c=(u=t.options).sheetAreaOffset.left)+2,h=t.Zs,d=(p=t.am()).pt,g=t.rKc(p),m=p.sKc,y=p.lt,C=p.js,v=p.height+u.sheetAreaOffset.top,b=void 0,w=void 0,T=void 0,A=(S=t.yl).bm(),I=t.tKc,e>r||e===r&&L(o)>L(i)){if(R=void 0,M=void 0,(k=t.Hr(1))&&k.length>0&&(R=k.findCol(e)),R){for(M=k[N=k.length-1];M&&M.x+M.width>d+g;)M=k[N-=1];M&&M.col>e&&(l=!0,b=R.x+L(o),w=h?h.y:p.y,T=M.x+M.width-b-f,S.Ow(b,w,T,v,d,w),u.rowHeaderVisible||(t.invalidateLayout(),S._l(A,new s.Rect(0,w,c,v))),t.invalidateLayout(),D=I?g:g+C+m,S._l(A,new s.Rect(d+T,w,D-T,v)),D-=I?0:m,S.Pw(A,new s.Rect(d-2,w,D+2,v)),this.sWc(t,w,v))}}else{for(E=0,P=e;P<r&&E<g;P++)E+=t.Tl(P);(E+=L(i)-L(o))<g&&(l=!0,b=d,w=h?h.y:p.y,T=g-E,t.frozenTrailingColumnCount()>0&&(T-=1),G=0,!I&&m>0&&(G=C,B=j(h.width-G-1,y-1+E),S.Ow(y-1,w,G+1,v,B,w)),_=I?0:j(E,m)-1,S.Ow(b,w,T+_,v,b+E,w),t.invalidateLayout(),V=t.columnOutlines&&!t.columnOutlines.iT()?t.columnOutlines.s0a()+c+1:0,S._l(A,new s.Rect(b-c,w,E+c+V+5,v)),H=g+_+G+2,S.Pw(A,new s.Rect(d-2,w,H,v)),this.sWc(t,w,v))}l||(t.invalidateLayout(),t.repaint()),r!==e&&t.Wq(s.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:r,newLeftCol:e}),(z=t.mm)&&z.Qw(),U=r===t.qq&&i!==t.eCb,l&&At(t,U)&&(W.GHb=It(t,W))}},t.prototype.sWc=function(t,e,o){var n=t.yl,r=n.bm();this.tWc(t).concat(this.uWc(t)).forEach((function(t){var i=t.layout,a=new s.Rect(i.x,e,i.width,o);n.dm(a),n.Pw(r,a)}))},t.prototype.tWc=function(t){var e,o,n,r,i,a,s,l=t.getSelections();return 1===l.length?(e=this.yw.options.scrollByPixel,o=t.qq,n=t.eCb,r=l[0].col,i=l[0].col+l[0].colCount-1,e&&i===o-1?[]:(a=[],(r===o+1||r<o&&o<=i||i===o-1||e&&r===o&&0!==n)&&((s=t.Hr(0))&&s.length>0&&a.push({layout:s[s.length-1]})),a)):[]},t.prototype.uWc=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p=t.getSelections();return 1===p.length?(e=this.yw.options.scrollByPixel,o=t.getViewportRightColumn(1),n=p[0].col,r=p[0].col+p[0].colCount-1,i=[],l=(s=(a=t.Hr(2))&&a.length>0)?a[0]:F,f=(c=(u=t.Hr(1))&&u.length>0)?u.findCol(o):F,h=s&&c&&l.x!==f.x+f.width,(r===o-1||n<=o&&o<r||n===o+1||e&&r===o&&h)&&s&&i.push({layout:l}),i):[]},t.prototype.Rw=function(t,e,o,n){var r,i,a,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x,A,I=this,R=I.yw,M=!1,k=R.nKc,N=R.kKc,O=R.options.scrollbarShowMax,D=R.options.scrollbarAppearance===y.ScrollbarAppearance.mobile;if(t){if(r=t.name(),e.ctrlKey){if(!R.options.allowUserZoom)return!0;if(a=function(t,e){return void 0===e&&(e=12),+parseFloat(t.toPrecision(e))}((i=t.zoom())-.05*o),t.isEditing()&&!t.endEdit())return;if(l={sheet:t,sheetName:t.name(),oldZoomFactor:i,newZoomFactor:a,cancel:!1},t.Wq(s.Events.ViewZooming,l),l&&!0===l.cancel)return!1;u={cmd:"zoom",sheetName:r,oldZoomFactor:i,zoomFactor:l.newZoomFactor},t.wu().execute(u),i!==(a=t.zoom())&&(delete l.cancel,t.Wq(s.Events.ViewZoomed,l),t.Wq(s.Events.UserZooming,l))}else n=n||0,c=t.lq,f=t.cCb,p=(h=I.ms(t,o)).cj,d=h.UP,c!==p||f!==d?(D&&(k.Jwa(y.ScrollbarState.show),I.Rdc(!0)),I.ju(t,p,d),t.os(),O||t.es()):M=!0,g=t.qq,m=t.eCb,v=(C=I.Sw(t,n)).dj,b=C.UP,g===v&&m===b||(D&&(N.Jwa(y.ScrollbarState.show),I.Rdc(!1)),I.lu(t,v,b),t.qs(),O||t.ds());w=t.Vs(),T=t.hitTest(e.pageX-w.left,e.pageY-w.top),(x=(S=t.yt)&&S.cellTypeHitInfo)&&(x.cellRect=t.getCellRect(S.row,S.col)),(A=t.mm).Tw(T),A.Uw(T)}return M&&0===n},t.prototype.aCb=function(t,e){var o,n,r,i,a,s,l,u,c=t.lq,f=t.cCb,h=t.parent,p=t.zoom(),d=E(e*h.options.scrollPixel*p),g=0,m=t.am().qt,y=t.jt(1).findRow(c);if(y)if(d<0){for(o=t.Rt(-1),g=-(m-y.y);c>o&&g>=d;)c--,g-=t.Sl(c);f=g-d,c===o&&f>0&&(f=0)}else if(d>0){for(n=t.ns(),g=y.y+y.height-m;c<n&&g<=d;)c++,g+=t.Sl(c);f=g-d-(r=t.Sl(c)),h.options.scrollbarMaxAlign?(i=t.am(),a=t.frozenRowCount(),s=t.getRowCount()-t.frozenTrailingRowCount()-1,n=(l=t.LHb(t.oKc(i),a,s)).cj,u=l.UP,c>n?(c=n,f=u):c===n&&L(f)>L(u)&&(f=u)):c<n&&g-d==0?(c++,f=0):c===n&&g-d<0&&(f=-r)}return{cj:c,UP:f}},t.prototype.ms=function(t,e){var o,n,r,i,a=t.lq,s=t.cCb,l=t.parent;return l&&l.options.scrollByPixel?l.ku.aCb(t,e):((o=t.frozenRowCount())>0&&(0===a&&e>0?a=o:e<0&&a===o-e&&(a=0)),-1!==(n=t.Rt(a+e,e<0))?a=n:a+=e,r=t._t(),i=t.ns(),t.getRowCount()-o-t.frozenTrailingRowCount()<=0||r===F?a=t.lq:(a<r?a=r:a>i&&(a=i),a===F&&(a=-1)),{cj:a,UP:s})},t.prototype._Bb=function(t,e){var o,n,r,i,a,s,l,u,c=t.qq,f=t.eCb,h=t.parent,p=t.zoom(),d=E(e*h.options.scrollPixel*p),g=0,m=t.am().pt,y=t.it(1).findCol(c);if(y)if(d<0){for(o=t.Ot(-1),g=-(m-y.x);c>o&&g>=d;)c--,g-=t.Tl(c);f=g-d,c===o&&f>0&&(f=0)}else if(d>0){for(n=t.ps(),g=y.x+y.width-m;c<n&&g<=d;)c++,g+=t.Tl(c);f=g-d-(r=t.Tl(c)),h.options.scrollbarMaxAlign?(i=t.am(),a=t.frozenColumnCount(),s=t.getColumnCount()-t.frozenTrailingColumnCount()-1,n=(l=t.MHb(t.rKc(i),a,s)).dj,u=l.UP,c>n?(c=n,f=u):c===n&&L(f)>L(u)&&(f=u)):c<n&&g-d==0?(c++,f=0):c===n&&g-d<0&&(f=-r)}return{dj:c,UP:f}},t.prototype.Sw=function(t,e){var o,n,r,i,a=t.qq,s=t.eCb,l=t.parent;return l&&l.options.scrollByPixel?l.ku._Bb(t,e):((o=t.frozenColumnCount())>0&&(0===a&&e>0?a=o:e<0&&a===o-e&&(a=0)),-1!==(n=t.Ot(a+e,e<0))?a=n:a+=e,r=t.$t(),i=t.ps(),t.getColumnCount()-o-t.frozenTrailingColumnCount()<=0||r===F?a=t.qq:(a<r?a=r:a>i&&(a=i),a===F&&(a=-1)),{dj:a,UP:s})},t.prototype.Dw=function(t,e){var o,n,r=this.yw;xt(r)&&(t?(o=e.pageY,n=e.pageX-100):(o=e.pageY-40,n=e.pageX-30),r.uw(C.Ob(this.Nw(t)),n,o,!0))},t.prototype.Nw=function(t){var e,o=xt(this.yw),n=o.qq+1;return o&&(t?e=bt().Tip_Row+(o.lq+1):(1!==o.options.colHeaderAutoText&&(n=s.Ul.xq(n)),e=bt().Tip_Column+n)),e},t.prototype.Sdc=function(t){a.GC$(t).addClass(ft)},t.prototype.Tdc=function(t){a.GC$(t).removeClass(ft)},t.prototype.Udc=function(t){a.GC$(t).addClass(ht)},t.prototype.uKc=function(t){a.GC$(t).removeClass(ht)},t.prototype.Rdc=function(t,e){var o,n,r,i;void 0===e&&(e=1e3),n=(o=this).yw,r=t?n.vKc:n.wKc,i=function(){o.uKc(r),o.Sdc(r)},(n.options.scrollbarAppearance=y.ScrollbarAppearance.mobile)&&(o.Wdc(t),t?o.Xdc=setTimeout(i,e):o.Ydc=setTimeout(i,e))},t.prototype.Wdc=function(t){var e=this;t&&e.Xdc?(clearTimeout(e.Xdc),e.Xdc=null):!t&&e.Ydc&&(clearTimeout(e.Ydc),e.Ydc=null)},t}(),Tt={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:y.TabStripPosition.bottom,tabStripWidth:80,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:F,backgroundImageLayout:0,showResizeTip:y.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:y.ShowScrollTip.none,grayAreaBackColor:F,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:y.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,autoFitType:y.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:y.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:y.ResizeMode.normal,columnResizeMode:y.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:y.ScrollbarAppearance.skin,font:F,customList:[],numbersFitMode:y.NumbersFitMode.mask,pasteSkipInvisibleRange:!1},St=function(){function t(t,e){var o,n,r=this;r.name="",r.kv=!1,r.lv=-1,r.eq=0,r.xKc=-1,r.mv=!1,r.options=R(Tt,(function(t,e,o){r.Op(t,e,o)})),r.T3(e),e&&"white"===e.backColor?r.Sxb=!0:r.Sxb=!1,o=1,e&&(typeof(n=e.sheetCount)===G&&(o=n)),"string"==typeof t&&(t=D.getElementById(t)),r.qo=t,r.ad(o,t)}return t.prototype.commandManager=function(){return this.wu},t.prototype.undoManager=function(){return this.pv},t.prototype.Txb=function(){var t=this.Uxb(),e=this.Vxb;return e instanceof Array?e.concat(t):t},t.prototype.Uxb=function(){var t=k.culture(),e=[],o=[],n=k.q4(Ct).DateTimeFormat,r=k.q4(t).DateTimeFormat;return e=this.Wxb(n),t!==Ct&&(o=this.Wxb(r)),e.concat(o)},t.prototype.Wxb=function(t){var e,o,n=[];return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach((function(r){(e=t[r])instanceof Array&&e.length>0&&(o=r.indexOf("month")>-1||r.indexOf("Month")>-1,e=o?e.slice(0,12):e,n.push(e))})),n},t.prototype.FHb=function(){var t=S&&this.Cf();t&&t.NHb(),this.sheets.forEach((function(t){t.yj().OHb()}))},t.prototype.Op=function(t,e,o){var n,r=this,i=xt(r),a=S&&r.Cf();switch(t){case"allowUndo":r.pv&&(r.pv.zc=e);break;case"backColor":r.Sxb=!0,i&&i.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":i&&i.$p();break;case"backgroundImage":case"backgroundImageLayout":r.Ys(),i&&i.$p();break;case"newTabVisible":case"tabNavigationVisible":(n=r.YJc)&&n.repaint();break;case"tabStripPosition":e!==o&&r.yKc(e);break;case"tabStripWidth":e!==o&&r.zKc(e);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":r.fq();break;case"tabStripRatio":r.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":i&&(i.oq=!0,i.jq=!0,i.$p());break;case"scrollByPixel":i&&(i.oq=!0,i.jq=!0,i.cCb=0,i.eCb=0,i.$p());break;case"scrollPixel":e<=0&&(r.options.scrollPixel=o);break;case"scrollbarAppearance":r.ku&&e!==o&&r.Zdc(e);break;case"calcOnDemand":a&&(!e&&a.calcOnDemand&&r.FHb(),a.calcOnDemand=e);break;case"customList":r.Vxb=e;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":r.PHb(t,e),i&&i.$p()}},t.prototype.Zdc=function(t){var e,o;x(t)&&(t=y.ScrollbarAppearance.skin),e=this,o=t===y.ScrollbarAppearance.mobile,e.nKc.$dc(t),e.kKc.$dc(t),e.AKc(),o?e.BKc():e.CKc(),e.refresh()},t.prototype.yKc=function(t){var e=this;x(t)&&(t=y.TabStripPosition.bottom,e.options.tabStripPosition=t),e.sj&&(e.DKc(),e.v8a(),e.fq())},t.prototype.zKc=function(t){var e=this;x(t)?(t=80,e.options.tabStripWidth=t):t<80&&(e.options.tabStripWidth=80),e.sj&&(e.DKc(),e.v8a(),e.fq())},t.prototype.PHb=function(t,e){var o=S&&this.Cf();if(o)switch(t){case"referenceStyle":o.useR1C1=1===e;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":o[t]=e}},t.prototype.ad=function(e,o){var n,r,i,a,s=this;for(S&&s.qv(),s.rv=[],s.sv=A("input"),s.jm=0,s.xD=0,s.tv={fromSheet:F,isCutting:!1},s.mmb={fromSheet:F,isCutting:!1},s.Ks=F,s.sheets=[],s.pJc=[],s.Lq={},s.Vxb=s.options.customList,s.pv=new v(s,-1,s.options.allowUndo),(n=s.wu=new b(s)).EKc("beforeWorkbookExecute",(function(t){s.FKc(t)})),n.addListener("workbookUndo",(function(t){var e,o=t.command,n=u.Commands.aWa(o),r=s.wu[o.cmd];r&&r.canUndo()&&!n&&!o.yTa&&((e=s.getSheetFromName(o.sheetName))&&(o.sheetId=e._id),s.undoManager().Cc(o,t.s4)),1!==t.s4&&2!==t.s4||s.GKc(t)})),u.Commands.uv(n),t.ao(s,"init"),r=0;r<e;r++)i=s.vv(s.wv(r)),s.sheets.push(i),i.Ls(s);(a=s.sheets[s.eq])&&a.isSelected(!0),s.suspendPaint(),o&&s.ws(o),s.uu=new p.S4(s),s.resumePaint()},t.prototype.hitTest=function(t,e,o){var n,r,i,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,E,j=this,P=j.WJc(),L=j.YJc,G=j.kKc,B=j.nKc,_=a.GC$(j.getHost()).width(),V=a.GC$(j.getHost()).height();if(t<0||t>_||e<0||e>V)return F;if(n=j.oia(),j.options.scrollbarAppearance===y.ScrollbarAppearance.mobile){if(r=function(t,e,o,n,r){var i=t.pia(),a=e.left-o.left,s=e.top-o.top;if(n>a&&n<i.width+a&&r>s&&r<i.height+s)return{horizontalScrollBarHitInfo:{element:t.hitTest(n-a,r-s).element},x:n,y:r}}(G,a.GC$(j.wKc).offset(),n,t,e))return r;if(i=function(t,e,o,n,r){var i=t.pia(),a=e.left-o.left,s=e.top-o.top;if(n>a&&n<i.width+a&&r>s&&r<i.height+s)return{verticalScrollBarHitInfo:{element:t.hitTest(n-a,r-s).element},x:n,y:r}}(B,a.GC$(j.vKc).offset(),n,t,e))return i}if(P&&(s=P.Vs(),l=P.Dr(),u=s.left-n.left,c=s.top-n.top,t>u&&t<l.width+u&&e>c&&e<l.height+c))return{worksheetHitInfo:P.hitTest(t-u,e-c,!1,o),x:t,y:e};if(f=a.GC$(L.Ws()).offset(),h=L.Dr(),p=f.left-n.left,d=f.top-n.top,t>p&&t<h.width+p&&e>d&&e<h.height+d){switch(m={},C=(g=L.hitTest(t-p,e-d)).index,b=(v=j.XJc(C))&&v.name(),g.type){case"navButton":m={navButton:g.element};break;case"sheetTab":m={sheetTab:{sheetName:b||g.element,sheetIndex:C}};break;case"resize":m={resize:!0};break;default:m={blank:!0}}return{tabStripHitInfo:m,x:t,y:e}}return w=a.GC$(G.Bv()).offset(),T=G.pia(),S=w.left-n.left,x=w.top-n.top,t>S&&t<T.width+S&&e>x&&e<T.height+x?{horizontalScrollBarHitInfo:{element:G.hitTest(t-S,e-x).element},x:t,y:e}:(A=a.GC$(B.Bv()).offset(),I=B.pia(),R=A.left-n.left,M=A.top-n.top,t>R&&t<I.width+R&&e>M&&e<I.height+M?{verticalScrollBarHitInfo:{element:B.hitTest(t-R,e-M).element},x:t,y:e}:(k=a.GC$(j.HKc).offset(),N=parseInt(j.HKc.style.width.substr(0,j.HKc.style.width.indexOf("px")),10),O=parseInt(j.HKc.style.height.substr(0,j.HKc.style.height.indexOf("px")),10),D=k.left-n.left,E=k.top-n.top,t>D&&t<N+D&&e>E&&e<O+E?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:e}:void 0))},t.prototype.oia=function(){var t;return(t=pt?pt(this.qo).offset():a.GC$(this.qo).offset())?(t.top+=D.body.clientTop||0,t.left+=D.body.clientLeft||0):t={top:0,left:0},t},t.prototype.T3=function(t){var e=this.options,o=t||{};o=T(!0,{},Tt,o),w(o,(function(t,o){e.hasOwnProperty(t)&&(e[t]=o)}))},t.prototype.xv=function(){var t=this;return!t.Ks&&t.qo&&(t.Ks=A(Y),a.GC$(t.Ks).css({position:"relative",left:0,top:0,height:0}),a.GC$(t.qo).prepend(t.Ks)),t.Ks},t.prototype.wv=function(t){var e,o,n,r,i,a,s=this,l=s.getSheetCount();s.lv<l?s.lv=l:s.lv++,(x(t)||t<s.lv)&&(t=s.lv),e=!1,n=s.sheets;do{for(o=(bt().SHEET_NAME||"Sheet")+(t+1),r=n.length,i=0;i<r;i++)if(a=n[i]){if(a.name().toUpperCase()===o.toUpperCase()){t++,e=!0;break}e&&(e=!1)}}while(e);return o},t.prototype.vv=function(t){return new d.Worksheet(t)},t.prototype.setHost=function(t){this.ws(t)},t.prototype.ws=function(e){var o=this;e&&(o.qo=e,o.IKc(),o.qm(),o.JKc(),o.KKc(),o.LKc(),o.MKc(),o.NKc(),o.OKc(),o.PKc(),o.QKc(),o.RKc(),o.BKc(),o.SKc(),o.TKc(),o.UKc(),o.VKc(),o.v8a(),o.fq(),o.Rv(e),t.ao(o,"setHost",e))},t.prototype.IKc=function(){var t=this,e=t.qo;pt&&pt(e).data(gt,t),a.GC$(e).data(gt,t).attr(mt,"gcSpread").addClass(yt).css("overflow","visible")},t.prototype.qm=function(){O.Yl.qm()},t.prototype.JKc=function(){var t=this;t.cultureChangedHandler=function(){t.Av()},D.addEventListener(dt,t.cultureChangedHandler)},t.prototype.KKc=function(){var t=this;t.WKc(),t.XKc(),t.YKc()},t.prototype.XKc=function(){var t,e,o,n,r,i=this.qo,a=A(K),s=a.style;for(a.cellSpacing="0px",a.cellPadding="0px",a.border="0",s.width=$,s.height=$,s.border="0",s.margin="0",s.borderCollapse="collapse",s.tableLayout="fixed",s.float="left",t=0;t<3;t++){for(e=A("tr"),o=0;o<2;o++)(r=(n=A("td")).style).padding="0",r.border="0",e.appendChild(n);a.appendChild(e)}i.appendChild(a),this.sj=a},t.prototype.WKc=function(){var t=this.qo,e=A(Y),o=e.style;o.width="0",o.height="0",o.float="left",t.appendChild(e),this.ZKc=e},t.prototype.YKc=function(){var t=this.qo,e=A(Y),o=e.style;o.width="0",o.height="0",o.float="left",t.appendChild(e),this.$Kc=e},t.prototype.LKc=function(){var t=this,e=t.qo,o=t.sj.rows[1].cells[0],n=A(Y);n.id=e.id+"vp",a.GC$(o).append(n),t.xs=n},t.prototype.MKc=function(){var t=this,e=t.sj.rows[1].cells[1],o=t.options,r=o.scrollByPixel,i=o.scrollbarAppearance,s=r?y.ScrollType.pixels:y.ScrollType.continuous,l=new n.hv(!1,F,F,F,F,F,s,i,(function(){t.cec(!0)})),u=A(Y),c=l.Bv();a.GC$(u).append(c),t.nKc=l,t.vKc=u,t._Kc=e},t.prototype.aLc=function(){var t=this,e=t.nKc.Bv();a.GC$(e).bind(U+Z,(function(e,o){var r=o.scrollEventType;e.data=t,o.scrollOrientation===n.ScrollOrientation.verticalScroll&&(r===y.Nxb.smallDecrement||r===y.Nxb.smallIncrement||r===y.Nxb.largeDecrement||r===y.Nxb.largeIncrement||r===y.Nxb.thumbTrack?wt.Dv(e,o):r===y.Nxb.thumbPosition&&wt.Ev(e))})).bind(B+Z,(function(e){e.data=t,wt.Fv(e)})).bind(V+Z,(function(e){e.data=t,wt.Gv(e)})).bind(_+Z,(function(e){e.data=t,e.scrollbar=t.nKc,wt.ggc(e)}))},t.prototype.NKc=function(){var t,e,o,n,r=this.sj.rows[2].cells[0],i=A(K),s=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",s.border="0",s.margin="0",a.GC$(i).css("user-select",ot),t=A("tr"),e=0;e<2;e++)(n=(o=A("td")).style).padding="0",n.border="0",t.appendChild(o);i.appendChild(t),a.GC$(r).append(i),this.bLc=i},t.prototype.OKc=function(){var t=this,e=t.qo,o=A(Y),n=o.style;n.width=""+t.Iv()*a.GC$(e).width()+Q,n.height=""+t.xJc()+Q,n.fontSize="10pt",n.fontFamily="Arial",t.cLc=o},t.prototype.PKc=function(){var t=this,e=t.bLc.rows[0].cells[1],o=t.options,r=o.scrollByPixel,i=o.scrollbarAppearance,s=r?y.ScrollType.pixels:y.ScrollType.continuous,l=new n.hv(!0,F,F,F,F,F,s,i,(function(){t.cec(!1)})),u=l.Bv(),c=A(Y);a.GC$(c).append(u),t.kKc=l,t.wKc=c,t.dLc=e},t.prototype.eLc=function(){var t=this,e=t.kKc.Bv();a.GC$(e).bind(U+Z,(function(e,o){var r=o.scrollEventType;e.data=t,o.scrollOrientation===n.ScrollOrientation.horizontalScroll&&(r===y.Nxb.smallDecrement||r===y.Nxb.smallIncrement||r===y.Nxb.largeDecrement||r===y.Nxb.largeIncrement||r===y.Nxb.thumbTrack?wt.Lv(e,o):r===y.Nxb.thumbPosition&&wt.Mv(e))})).bind(B+Z,(function(e){e.data=t,wt.Nv(e)})).bind(V+Z,(function(e){e.data=t,wt.Gv(e)})).bind(_+Z,(function(e){e.data=t,e.scrollbar=t.kKc,wt.ggc(e)}))},t.prototype.QKc=function(){this.fLc(),this.gLc()},t.prototype.fLc=function(){var t=this.sj.rows[0].cells[1],e=A(Y);a.GC$(t).append(e),this.hLc=e},t.prototype.gLc=function(){var t=this.sj.rows[2].cells[1],e=A(Y);a.GC$(t).append(e),this.HKc=e},t.prototype.SKc=function(){this.ku=new wt(this)},t.prototype.RKc=function(){this.aLc(),this.eLc()},t.prototype.BKc=function(){var t,e,o,n=this;n.options.scrollbarAppearance===y.ScrollbarAppearance.mobile&&(t=n.qo,e=n.vKc,o=n.wKc,a.GC$(e).bind(H,(function(){n.nKc.Jwa(y.ScrollbarState.active)})).bind(z,(function(){n.nKc.Jwa(y.ScrollbarState.inactive)})),a.GC$(o).bind(H,(function(){n.kKc.Jwa(y.ScrollbarState.active)})).bind(z,(function(){n.kKc.Jwa(y.ScrollbarState.inactive)})),a.GC$(t).bind(H,n.fec).bind(z,n.gec))},t.prototype.CKc=function(){var t=this,e=t.vKc,o=t.wKc;e&&(a.GC$(e).unbind(H).unbind(z),t.ku.Wdc(!0)),o&&(a.GC$(o).unbind(H).unbind(z),t.ku.Wdc(!1)),a.GC$(t.qo).unbind(H,t.fec).bind(z,t.gec)},t.prototype.fec=function(){a.GC$(this).find("."+st).addClass(ct)},t.prototype.gec=function(){a.GC$(this).find("."+st).removeClass(ct)},t.prototype.TKc=function(){this.DKc(),this.AKc()},t.prototype.AKc=function(){var t,e,o,n,r,i=this,s=i.qo;i.ku&&(t=i.options.scrollbarAppearance===y.ScrollbarAppearance.mobile,e=i._Kc,o=i.dLc,n=i.vKc,r=i.wKc,a.GC$(n).removeAttr("style"),a.GC$(r).removeAttr("style"),t?(n.style.position="absolute",n.style.top="0px",n.style.left="0px",a.GC$(n).addClass(st+" "+ut),a.GC$(s).css("position","relative").append(n),r.style.position="absolute",r.style.top="0px",r.style.left="0px",a.GC$(r).addClass(st+" "+lt),a.GC$(s).append(r)):(a.GC$(e).append(n),a.GC$(o).append(r),a.GC$(n).removeClass(st+" "+ft+" "+ut+" "+ht),a.GC$(r).removeClass(st+" "+ft+" "+lt+" "+ht),a.GC$(s).css("position","auto")))},t.prototype.DKc=function(){var t,e=this,o=e.sj,n=e.bLc,r=e.cLc,i=e.options.tabStripPosition;i===y.TabStripPosition.bottom?t=n.rows[0].cells[0]:i===y.TabStripPosition.top?t=o.rows[0].cells[0]:i===y.TabStripPosition.left?t=e.ZKc:i===y.TabStripPosition.right&&(t=e.$Kc),a.GC$(t).append(r)},t.prototype.Rv=function(t){var e=this,o="tabindex",n=N(a.GC$(t).attr(o),10)||0,r=A(Y);a.GC$(r).css({position:nt,overflow:"hidden"}).attr(mt,"gcSheetFocusElementForTab").attr(o,n).bind(q,(function(){e.Sv||xt(e).zt(),e.Sv=!1})),t.insertBefore(r,F),e.Tv=r},t.prototype.UKc=function(){var t=this,e=function(){t.Pv()};a.GC$(O).bind(W+J,e),t.oTa=e},t.prototype.VKc=function(){var t=xt(this);t&&t.ws(this.xs)},t.prototype.Uv=function(){var t=this.Tv;t&&(this.Sv=!0,t.focus())},t.prototype.hgc=function(){var t,e,o,n,r,i=this.getActiveSheet();if(i)if(s.Vl.Wl(i)){if(e=this.qo)for(o=document.activeElement,n=document.body,r=o;r;){if(r===e){t=o;break}if(r===n)break;r=r.parentElement}}else i.Xs&&(t=i.Xs);return t},t.prototype.dgc=function(t){var e=this;e.igc&&(O.clearTimeout(e.igc),e.igc=F),e.igc=O.setTimeout((function(){var o=e.hgc();o&&o.setAttribute("aria-label",t),O.clearTimeout(e.igc),e.igc=F}),50)},t.prototype.no=function(){var e,o,n,r,i,l,u,c=this,f=c.kKc,p=c.nKc,d=c.sheets,g=c.options.scrollbarAppearance===y.ScrollbarAppearance.mobile;for(c.vXc(),s.En.Tn(c),s.Ul.no(),c.oTa&&a.GC$(O).unbind(W+J,c.oTa),c.oTa=F,c.Zv&&clearTimeout(c.Zv),f&&f.dispose(),p&&p.dispose(),c.mu(),c.xw(),s.Vl.Xl()===c.getActiveSheet()&&s.Vl.Zl(F),e=0;e<d.length;e++)d[e].no(!0);for(d.splice(0,d.length),o=c.pJc,e=0;e<o.length;e++)o[e].no(!0);o.splice(0,o.length),(n=c.uu)&&(n.no(),c.uu=F),l="class",u="unselectable",(r=c.qo)&&(i=a.GC$(r),D.removeEventListener(dt,c.cultureChangedHandler),i.html("").removeAttr(mt).removeClass(yt),i.attr(l)||i.removeAttr(l),i.attr(u)||i.removeAttr(u),i.data(gt)&&i.data(gt,F),pt&&pt(r).data(gt)&&pt(r).data(gt,F)),g&&c.CKc(),c.wKc=F,c.vKc=F,c.pv&&(c.pv.no(),c.pv=F),c.YJc&&(c.YJc.no(),c.YJc=F),t.ao(c,"dispose"),c.Tv&&(a.GC$(c.Tv).unbind(q),c.Tv=F),c.Wu&&(c.Wu.dispose(),c.Wu=F,c.yv=F,c.zv=F),c.bt&&(c.bt.no(),c.bt=F),h.To.no(),c.wu&&(c.wu.no(),c.wu=F),c.ku&&(c.ku.no(),c.ku=F)},t.prototype.mu=function(){var t,e=this.sheets;for(a.GC$(this.sv).unbind(J),t=0;t<e.length;t++)e[t].mu()},t.prototype.vXc=function(){var t,e,o,n=this.wXc;if(n)for(t=0,e=n;t<e.length;t++)(o=e[t]).close&&o.close();this.wXc=[]},t.prototype.v8a=function(){var t=this,e=N(s.Im.Lm("").zIndex),o=e!==t.Vv;o&&t.iLc(e),t.jLc(o),t.aZ(),t.kLc()},t.prototype.iLc=function(t){this.Vv=t},t.prototype.jLc=function(t){var e=this,o=e.qo,n=e.Vv,r=o.getAttribute("id")+"_tabStrip",i=e.YJc;i&&!t?(i.TJc(),i.repaint()):(i&&i.no(),i=n>2007?new c.iv(r):new f.jv(r),e.YJc=i,i.Yv(e),i.ws(e.cLc))},t.prototype.aZ=function(){var t=this,e=t.options.scrollbarAppearance===y.ScrollbarAppearance.mobile,o=t.xJc(),n=t.Wv(),r=t.Xv();e?t.hec():(function(t,e,o){var n,r,i=s.Im.Lm("gc-vertical-scrollbar"+at),l=N(i.zIndex)>2007?1:0,u=e-o;r=u%2==0?(n=u/2)-l:n=(u-l)/2,a.GC$(t).css({"box-sizing":rt,border:ot,"border-color":ot,"border-left-style":it,"border-left-width":l+Q,"border-left-color":i.borderLeftColor,"background-color":i.backgroundColor,width:o,padding:"0px "+n+"px 0px "+r+Q,margin:0})}(t.vKc,r,n),function(t,e,o){var n,r,i=s.Im.Lm("gc-horizontal-scrollbar"+at),l=N(i.zIndex)>2007?1:0,u=e-o;r=u%2==0?(n=u/2)-l:n=(u-l)/2,a.GC$(t).css({"box-sizing":rt,border:ot,"border-color":ot,"border-top-style":it,"border-top-width":l+Q,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:o,padding:r+"px 0px "+n+"px 0px",margin:0})}(t.wKc,o,n))},t.prototype.kLc=function(){Ot(this.HKc),Ot(this.hLc)},t.prototype.Pv=function(){var t=this,e=t.Zv;e&&clearTimeout(e),t.Zv=O.setTimeout((function(){s.En.Un(),t.fq(),t.Zv=F}),100)},t.prototype.fq=function(){var t=this;t.kv||(t.kv=!0,t.$v(),t.kv=!1)},t.prototype.$v=function(){var t=this;t.qo&&(t.lLc(),t.mLc(),t.nLc(),t.oLc(),t.pLc(),t.qLc(),t.rLc(),t.sLc(),t.tLc(),t.uLc(),t.vLc(),t.wLc())},t.prototype.lLc=function(){var t,e,o,n,r,i,s,l,u,c=this,f=c.ZKc;f&&(t=f.style,o=(e=c.options).tabStripVisible,n=e.tabStripPosition,r=o?e.tabStripWidth:0,i=c.qo,s=a.GC$(i).height(),n===y.TabStripPosition.left?(l=r,u=s):(l=0,u=0),t.width=""+l+Q,t.height=""+u+Q)},t.prototype.mLc=function(){var t,e,o,n,r,i,s,l=this,u=l.sj;u&&(t=u.style,o=(e=l.options).tabStripVisible,n=e.tabStripPosition,r=e.tabStripWidth,i=a.GC$(l.qo).width(),!o||n!==y.TabStripPosition.left&&n!==y.TabStripPosition.right?s=i+Q:s=P(jt(l.qo))-r+Q,t.width=s)},t.prototype.oLc=function(){var t,e,o,n,r,i,s,l,u,c=this,f=c.$Kc;f&&(t=f.style,o=(e=c.options).tabStripVisible,n=e.tabStripPosition,r=o?e.tabStripWidth:0,i=c.qo,s=a.GC$(i).height(),n===y.TabStripPosition.right?(l=r,u=s):(l=0,u=0),t.width=""+l+Q,t.height=""+u+Q)},t.prototype.nLc=function(){var t,e,o,n,r,i,s,l,u,c,f,h,p,d,g,m,C=this,v=C.qo,b=a.GC$(v),w=C.xs;w&&(t=w.style,e=b.width(),o=b.height(),n=C.Xv(),r=C.xJc(),s=(i=C.options).showVerticalScrollbar,l=i.showHorizontalScrollbar,u=i.scrollbarAppearance,c=i.tabStripVisible,f=i.tabStripPosition,h=c?i.tabStripWidth:0,p=u===y.ScrollbarAppearance.mobile,g=(d=f===y.TabStripPosition.left||f===y.TabStripPosition.right)?P(jt(v)):e,s&&!p&&(g-=n),d&&(g-=h),m=o,f===y.TabStripPosition.top?(l&&!p&&(m-=r),c&&(m-=r)):(l&&!p||c&&f===y.TabStripPosition.bottom)&&(m-=r),m<2&&(m=2),t.width=g+Q,t.height=m+Q)},t.prototype.pLc=function(){var t,e,o,n,r,i,s,l,u,c,f,h,p,d,g,m,C,v,b,w=this,T=w.qo,S=a.GC$(T),x=w.xs;x&&(t=S.width(),e=a.GC$(x).height(),o=w.kKc,n=w.nKc,i=(r=w.options).showVerticalScrollbar,s=r.showHorizontalScrollbar,l=r.scrollbarAppearance,u=r.tabStripVisible,c=r.tabStripPosition,f=u?r.tabStripWidth:0,h=l===y.ScrollbarAppearance.mobile,p=w.Wv(),d=w.Xv(),g=w.xLc(),i?(a.GC$(w.vKc).show(),a.GC$(n.Bv()).show()):(a.GC$(w.vKc).hide(),a.GC$(n.Bv()).hide()),s?(a.GC$(w.wKc).show(),a.GC$(o.Bv()).show()):(a.GC$(w.wKc).hide(),a.GC$(o.Bv()).hide()),m=p,C=e,n.Vo(m),n._v(C),v=t,c!==y.TabStripPosition.left&&c!==y.TabStripPosition.right||(v-=f),u&&!h&&c===y.TabStripPosition.bottom&&(v-=g),i&&!h&&(v-=d),v<=0&&(v=1),b=p,s||u||c!==y.TabStripPosition.bottom||(b=0),o.Vo(v),o._v(b))},t.prototype.xLc=function(){var t,e=this,o=e.xs,n=e.options,r=n.tabStripPosition,i=n.tabStripWidth,s=a.GC$(o).width();return r===y.TabStripPosition.bottom||r===y.TabStripPosition.top?(t=E(e.Iv()*s),r===y.TabStripPosition.bottom&&t===s&&(t=s-1)):t=i,t},t.prototype.qLc=function(){var t,e,o,n,r,i,s,l=this,u=l.qo,c=a.GC$(u).height(),f=l.cLc;f&&(t=f.style,o=(e=l.options).tabStripVisible,n=e.tabStripPosition,r=l.xJc(),i=l.xLc(),s=n===y.TabStripPosition.bottom||n===y.TabStripPosition.top?r:c,o||(s=0),t.width=""+i+Q,t.height=""+s+Q)},t.prototype.rLc=function(){var t,e,o,n,r=this,i=r.hLc,s=r.HKc,l=r.options,u=l.showVerticalScrollbar,c=l.showHorizontalScrollbar,f=l.tabStripVisible,h=l.tabStripPosition,p=l.scrollbarAppearance===y.ScrollbarAppearance.mobile,d=r.Xv(),g=r.xJc();h===y.TabStripPosition.top?(t=u&&!p?d:0,e=f?g:0):(t=0,e=0),a.GC$(i).css("width",t+Q),a.GC$(i).css("height",e+Q),o=u&&!p?d:0,c||f&&h===y.TabStripPosition.bottom?(n=g,p&&(f?f&&h!==y.TabStripPosition.bottom&&(n=0):n=0)):n=0,a.GC$(s).css("width",o+Q),a.GC$(s).css("height",n+Q)},t.prototype.sLc=function(){var t,e,o,n,r,i=this;i.xs&&(t=i.sj,o=(e=i.options).scrollbarAppearance===y.ScrollbarAppearance.mobile,n=e.showVerticalScrollbar,r=[a.GC$(i.xs).width(),i.Xv()],!o&&n||(r[1]=0),t.rows[0].cells[0].style.width=r[0]+Q,t.rows[0].cells[1].style.width=r[1]+Q)},t.prototype.uLc=function(){var t=this,e=t.options.scrollbarAppearance===y.ScrollbarAppearance.mobile;e&&t.hec(),t.Ut(),t.Xt(),e&&(t.nKc.Jwa(y.ScrollbarState.hide),t.kKc.Jwa(y.ScrollbarState.hide))},t.prototype.vLc=function(){var t=this;t.options.tabStripVisible?a.GC$(t.cLc).show():a.GC$(t.cLc).hide(),t.YJc&&t.YJc.fq()},t.prototype.tLc=function(t){var e;void 0===t&&(t=!0),(e=s.sJc(this))&&(0===e.lq&&(e.lq=e._t()),0===e.qq&&(e.qq=e.$t()),t&&e.fq())},t.prototype.wLc=function(){var t,e,o,n,r=this,i=s.sJc(r);i&&(i.invalidateLayout(),i.repaint()),t=r.qo,(o=(e=a.GC$(t)).width())!==(n=e.width())&&L(o-n)>2&&!r.aw&&(r.aw=!0,setTimeout((function(){delete r.aw,r.$v()}),1))},t.prototype.hec=function(){var t,e,o,n,r,i,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,A,I,R,M=this;x(M.qo)||(t=a.GC$(M.qo),(e=M.getActiveSheet())&&(o=a.GC$(M.vKc),n=a.GC$(M.wKc),r=e.am(),i=t.width(),s=t.height(),2,u=(l=M.options).tabStripVisible,c=l.showVerticalScrollbar,f=l.tabStripPosition,h=u?l.tabStripWidth:0,p=u?M.xJc():0,d=r.x+r.Br,g=r.y+r.Cr,m=c?o.width():0,C=s-g,f!==y.TabStripPosition.bottom&&f!==y.TabStripPosition.top||(C-=p),v=0,f===y.TabStripPosition.right&&(v+=h),b=g,f===y.TabStripPosition.top&&(b+=p),w=C-N(o.css("padding-top"))-N(o.css("padding-bottom")),T=i-m-d,f!==y.TabStripPosition.left&&f!==y.TabStripPosition.right||(T-=h),S=n.height(),A=0,f===y.TabStripPosition.bottom&&(A+=p),I=d,f===y.TabStripPosition.left&&(I+=h),R=T-N(n.css("padding-left"))-N(n.css("padding-right"))-2,M.nKc.Vo(m),M.nKc._v(w),M.kKc.Vo(R),M.kKc._v(S),o.css(["height","left","right","top"],[C,"auto",v,b]),n.css(["width","top","bottom","left"],[T,"auto",A,I])))},t.prototype.Ut=function(){var t=this,e=t.WJc(),o=t.options;e&&e.Ut(o.scrollbarMaxAlign,o.scrollbarShowMax,t.kKc)},t.prototype.Xt=function(){var t=this,e=t.WJc(),o=t.options;e&&e.Xt(o.scrollbarMaxAlign,o.scrollbarShowMax,t.nKc)},t.prototype.aq=function(){var t=this;t.qo&&(t.qLc(),t.pLc(),t.tLc(!1),t.uLc(),t.vLc())},t.prototype.suspendPaint=function(){var t,e,o,n,r=this,i=r.YJc,a=r.sheets,s=r.pJc;for(r.xD++,t=0,e=a;t<e.length;t++)e[t].suspendPaint();for(o=0,n=s;o<n.length;o++)n[o].suspendPaint();i&&i.fw()},t.prototype.resumePaint=function(){var t,e,o,n,r=this,i=r.YJc,a=r.sheets,s=r.pJc;for(r.xD-=r.xD>0?1:0,t=0,e=a;t<e.length;t++)e[t].resumePaint();for(o=0,n=s;o<n.length;o++)n[o].resumePaint();i&&i.gw()},t.prototype.isPaintSuspended=function(){return this.xD>0},t.prototype.Ys=function(){var t,e,o,n,r,i=this,u=i.options.backgroundImage,c=i.options.backgroundImageLayout,f=xt(i);if(f&&u&&(t=void 0,a.GC$(f.Ws()).css({"background-image":"url('"+u+"')","background-repeat":"no-repeat"}),!x(c))){(t=i.bt)||(t=i.bt=new l.oo((function(){i.bt&&i.Ys()})));try{t.ko(u)?(e=t.lo(u),n=(o=f.Dr()).width,r=o.height,s.Ul.ql(f.Ws(),n,r,e.width,e.height,c)):t.fo(u)}catch(t){}}},t.prototype.hw=function(t){var e=this,o=t.name(),n=e.getSheetIndex(o);x(n)&&(n=e.getSheetCount()+e.getSheetTabIndex(o)),e.YJc.iw(n)},t.prototype.startSheetIndex=function(t){var e=this,o=e.YJc;return 0===arguments.length?o?o.gq:0:(o&&(o.hE(t)||-1===(t=o.jw(t))&&(t=o.rw(t)),o.gq=t),e.aq(),e)},t.prototype.Iv=function(){var t,e,o,n,r,i=this,s=i.options,l=i.options.scrollbarAppearance===y.ScrollbarAppearance.mobile,u=s.tabStripPosition;return s.showHorizontalScrollbar&&!l&&u===y.TabStripPosition.bottom?(t=s.tabStripRatio,isNaN(t)?.5:(e=0,o=i.xs,n=i.YJc,o&&n&&(r=a.GC$(o).width(),e=n.AJc()/r),t<e?t=e:t>1&&(t=1),t)):1},t.prototype.destroy=function(){this.oTa&&a.GC$(O).unbind(W+J,this.oTa),this.no()},t.prototype.repaint=function(){var t,e=this.YJc;e&&e.repaint(),(t=s.sJc(this))&&t.repaint()},t.prototype.refresh=function(){var t=this;t.qo&&(s.Im.Nm(),t.v8a(),t.fq(),t.repaint())},t.prototype.getHost=function(){return this.qo},t.prototype.invalidateLayout=function(){var t=s.sJc(this);t&&t.invalidateLayout()},t.prototype.addNamedStyle=function(t){this.Kq(t);var e=s.sJc(this);e&&e.$p()},t.prototype.Kq=function(t){if(t){if(!t.name)throw Error(bt().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Lq[e]=t}},t.prototype.getNamedStyle=function(t){return this.Mq(t,!0)},t.prototype.Mq=function(t,e){var o,n=this.Lq;return n&&t?((o=n[t=t.toUpperCase()])&&e&&this.Jq(),o):F},t.prototype.Jq=function(){var t,e;for(t=0,e=this.sheets;t<e.length;t++)e[t].Jq()},t.prototype.removeNamedStyle=function(t){var e,o,n=this.Lq;n&&t&&(t=t.toUpperCase(),n.hasOwnProperty(t)&&((e=n[t].formatter)&&"string"==typeof e&&this.QHb[e]&&this.RHb(e),delete n[t],this.Jq(),(o=s.sJc(this))&&o.$p()))},t.prototype.getNamedStyles=function(){var t=[],e=this.Lq;return e&&w(e,(function(e,o){t.push(o)})),this.Jq(),t},t.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this.eq]:F},t.prototype.getActiveSheetTab=function(){return this.pJc&&this.pJc.length>0?this.pJc[this.xKc]:F},t.prototype.setActiveSheet=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();this.lw(t,2),this.SHb(e),this.yLc(o)},t.prototype.setActiveSheetTab=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();"number"==typeof t?this.hKc(t,2):"string"==typeof t&&this.zLc(t,2),this.SHb(e),this.yLc(o)},t.prototype.lw=function(t,e){var o,n=this.sheets;for(o=0;o<n.length;o++)if(n[o].name()===t){this.dq(o,e);break}},t.prototype.zLc=function(t,e){var o,n=this.pJc;for(o=0;o<n.length;o++)if(n[o].name()===t){this.hKc(o,e);break}},t.prototype.getActiveSheetIndex=function(){return this.eq},t.prototype.getActiveSheetTabIndex=function(){return this.xKc},t.prototype.setActiveSheetIndex=function(t){var e=this.getActiveSheet(),o=this.getActiveSheetTab();this.dq(t,2),this.SHb(e),this.yLc(o)},t.prototype.dq=function(t,e,o,n){var r,i,a,l,u,c,f,h,p,d;typeof t===G&&(t!==(r=this).eq&&((i=r.sheets[t])&&i.visible()&&(((a=s.Ul.rl()).ipad||a.iphone)&&((l=r.mw)&&(new Date).valueOf()-l<300)||((c=u=xt(r))||(c=(f=r.getActiveSheetTab())&&f.kj),kt(r,h={oldSheet:c,newSheet:i,needTriggerSheetChange:!0}),p={oldSheet:c,newSheet:i,cancel:!1},(d=h.needTriggerSheetChange&&n)&&Mt(r,p),!1===p.cancel&&(r.eq=t,r.ALc(),i!==u&&(u&&(u.no(!1),u.charts&&u.charts.all().forEach((function(t){t.clearflexDVs()}))),r.nw(i,e,!1,d,o)),r.fq(),Nt(r,c,i),d&&Rt(r,c,i)),(a.ipad||a.iphone)&&(r.mw=(new Date).valueOf())))))},t.prototype.hKc=function(t,e,o,n){var r,i,a,l,u,c,f,h,p,d;typeof t===G&&(t!==(r=this).xKc&&((i=r.pJc[t])&&i.visible()&&(a=i.kj,((l=s.Ul.rl()).ipad||l.iphone)&&((u=r.mw)&&(new Date).valueOf()-u<300)||(f=(c=r.getActiveSheetTab())?c.kj:r.getActiveSheet(),kt(r,h={oldSheet:f,newSheet:a,needTriggerSheetChange:!0}),p={oldSheet:f,newSheet:a,cancel:!1},(d=h.needTriggerSheetChange&&n)&&Mt(r,p),!1===p.cancel&&(r.xKc=t,r.BLc(),i!==c&&(c&&c.no(!1),r.CLc(i,e,!1,d,o)),r.fq(),Nt(r,f,a),d&&Rt(r,f,a)),(l.ipad||l.iphone)&&(r.mw=(new Date).valueOf())))))},t.prototype.nw=function(t,e,o,n,r){var i,a,l;o||t.ws(this.xs),a=(i=s.Vl.Xl())&&i.parent===this,l=2===e?a:1===e,s.Vl.Zl(F),!this.mv&&l&&t.zt(r),t.qs(),t.os()},t.prototype.CLc=function(t,e,o,n,r){var i,a,l;o||t.ws(this.xs),a=(i=s.Vl.Xl())&&i.parent===this,l=2===e?a:1===e,s.Vl.Zl(F),!this.mv&&l&&t.zt(r),t.qs(),t.os()},t.prototype.SHb=function(t){var e=this.getActiveSheet();t&&t.DHb(!1,!1),e&&e.DHb(!0,!1)},t.prototype.yLc=function(t){var e=this.getActiveSheetTab();t&&t.DHb(!1,!1),e&&e.DHb(!0,!1)},t.prototype.addSheet=function(t,e){var o=this.getActiveSheet(),n=this.getActiveSheetTab();this.ow(t,2,e),this.SHb(o),this.yLc(n)},t.prototype.addSheetTab=function(t,e,o){var n=this.getActiveSheet(),r=this.getActiveSheetTab(),i=this.DLc(e,o);if(i)return this.ELc(t,2,i),this.SHb(n),this.yLc(r),i},t.prototype.ow=function(t,e,o){var n,r,i,a,s,l,u,c,f=this;if(o||(o=f.vv(f.wv(t))),i=(r=f.sheets).length,o.name()){for(n=0;n<i;n++)if(r[n].name()===o.name())throw bt().Exp_NotSupported}else o.cq(f.wv(t));for(f.pw(o),a=xt(f),s=f.eq,l=i-t,u=[],n=0;n<l&&i>0;n++)u.push(r.pop());for(r.push(o),o.Ls(f);u.length>0;)r.push(u.pop());1===(i=r.length)?(f.xs&&o.ws(f.xs),f.eq=0):(s<0&&f.YJc&&(s=f.YJc.jw(s)),f.eq=s),f.ALc(),(c=xt(f))!==a&&(a&&a.no(!1),c&&f.nw(c,e,1===i,!0),f.fq()),f.YJc&&(f.YJc.gq<0&&(f.YJc.gq=f.eq),f.YJc.repaint())},t.prototype.ELc=function(t,e,o){var n,r,i,a,s,l,u,c,f;if(o){for(a=(i=(n=this).pJc).length,r=0;r<a;r++)if(i[r].name()===o.name())throw bt().Exp_NotSupported;for(n.pw(o),s=n.getActiveSheetTab(),l=n.xKc,u=a-t,c=[],r=0;r<u&&a>0;r++)c.push(i.pop());for(i.push(o),o.Ls(n);c.length>0;)i.push(c.pop());1===(a=i.length)?(n.xs&&o.ws(n.xs),n.xKc=0):(l<0&&n.YJc&&(l=n.YJc.jw(l)),n.xKc=l),n.BLc(),(f=n.getActiveSheetTab())!==s&&(s&&s.no(!1),f&&n.CLc(f,e,1===a,!0),n.fq()),n.YJc&&(n.YJc.gq<0&&(n.YJc.gq=n.xKc),n.YJc.repaint())}},t.prototype.removeSheet=function(t){this.qw(t,2)},t.prototype.removeSheetTab=function(t){"string"==typeof t&&(t=this.getSheetTabIndex(t)),this.FLc(t,2)},t.prototype.qw=function(t,e){var o,n,r,i,a,s,l,u,c,f,h=this,p=h.sheets,d=h.Wu,g=h.YJc,m=p.length;if(isNaN(t)||t<0||t>=m)throw Error(bt().Exp_IndexOutOfRange);if(o=t<=h.eq||t===m-1,n=xt(h),t<h.eq&&h.eq--,(r=p[t]).mu(),p.splice(t,1),0===(m=p.length))h.eq=-1;else if(h.eq>=m)h.eq=g.rw(m);else{for(i=void 0,i=h.eq;i<m;i++)if(p[i].visible()){h.eq=i;break}i>=m&&(h.eq=g.rw(m))}h.ALc(),o&&(n!==(a=p[h.eq])&&(n&&n.no(!1),a&&h.nw(a,e,!1,!0))),d&&((s=r.yj()).VDc=t,d.removeSource(s),l=r.fDc,d.removeSource(l),u=r.hDc,d.removeSource(u),c=r.Vva,x(c)||d.removeSource(c)),r.no(!0,-1!==h.eq),S&&!d.Dh&&h.sheets&&h.sheets.length>0&&(f=h.sheets[0],d.initParserContext(f.yj())),g&&(g.gq>=m?h.startSheetIndex(g.rw(m)):g.gq<0?h.startSheetIndex(g.jw(-1)):h.fq())},t.prototype.FLc=function(t,e){var o,n,r,i,a,s=this,l=s.pJc,u=s.YJc,c=l.length;if(isNaN(t)||t<0||t>=c)throw Error(bt().Exp_IndexOutOfRange);if(o=t<=s.xKc||t===c-1,n=s.getActiveSheetTab(),t<s.xKc&&s.xKc--,(r=l[t]).mu(),l.splice(t,1),0===(c=l.length))s.xKc=-1;else if(s.xKc>=c)s.xKc=u.rw(c);else{for(i=void 0,i=s.xKc;i<c;i++)if(l[i].visible()){s.xKc=i;break}i>=c&&(s.xKc=u.rw(c))}s.BLc(),o&&(n!==(a=l[s.xKc])&&(n&&n.no(!1),a&&s.CLc(a,e,!1,!0))),r.no(!0,-1!==s.xKc),u&&(u.gq>=c?s.startSheetIndex(u.rw(c)):u.gq<0?s.startSheetIndex(u.jw(-1)):s.fq())},t.prototype.clearSheets=function(){var t,e,o,n=this,r=n.sheets,i=n.Wu,a=n.YJc;for(t=0,e=r;t<e.length;t++)(o=e[t]).mu(),o.no(!0);r.splice(0,r.length),i&&i.clearSource(),n.eq=-1,a&&(a.gq=-1,a.repaint())},t.prototype.clearSheetTabs=function(){var t,e,o,n=this,r=n.pJc,i=n.YJc;for(t=0,e=r;t<e.length;t++)(o=e[t]).mu(),o.no(!0);r.splice(0,r.length),n.xKc=-1,i&&(i.gq=-1,i.repaint())},t.prototype.getSheet=function(t){var e=this.sheets;return t>=0&&t<e.length?e[t]:F},t.prototype.getSheetTab=function(t){var e,o,n,r=this.pJc;if("number"==typeof t)return t>=0&&t<r.length?r[t]:F;if("string"==typeof t)for(e=0,o=r;e<o.length;e++)if((n=o[e]).name()===t)return n;return F},t.prototype.getSheetFromName=function(t){var e,o,n;for(e=0,o=this.sheets;e<o.length;e++)if((n=o[e]).name()===t)return n;return F},t.prototype.getSheetIndex=function(t){var e,o=this.sheets;for(e=0;e<o.length;e++)if(o[e].name()===t)return e;return F},t.prototype.getSheetTabIndex=function(t){var e,o=this.pJc;for(e=0;e<o.length;e++)if(o[e].name()===t)return e;return F},t.prototype.getSheetCount=function(){return this.sheets.length},t.prototype.getSheetTabCount=function(){return this.pJc.length},t.prototype.setSheetCount=function(t){var e=this,o=e.getActiveSheet(),n=e.getActiveSheetTab();e.sw(t,2),e.SHb(o),e.yLc(n)},t.prototype.sw=function(t,e){var o,n,r=this;if(t<0)throw bt().Exp_ArgumentOutOfRange;if(0===t&&r.clearSheets(),t<(o=r.sheets.length))for(n=o-1;n>=t;n--)r.qw(n,e);else if(t>o)for(n=o;n<t;n++)r.ow(n,e)},t.prototype.gKc=function(t,e){var o,n,r,i,a,s=this;if(t<0)throw bt().Exp_ArgumentOutOfRange;if(0===t&&s.clearSheetTabs(),o=s.getActiveSheet(),n=s.getActiveSheetTab(),t<(r=s.pJc.length))for(i=r-1;i>=t;i--)s.FLc(i,e);else if(t>r)for(i=r;i<t;i++)a=s.DLc(F,y.SheetType.tableSheet),s.ELc(i,e,a);s.SHb(o),s.yLc(n)},t.prototype.DLc=function(t,e){return F},t.prototype.bind=function(t,e,o){var n,r,i,s,l=this,u=l.sheets;for(l.rv&&l.rv.push({type:t,data:e,fn:o}),a.GC$(l.sv).bind(t+J,e,o),n=0,r=u;n<r.length;n++)r[n].bind(t,e,o);for(i=0,s=l.pJc;i<s.length;i++)s[i].bind(t,e,o)},t.prototype.unbind=function(t,e){var o,n,r,i,s,l,u=this,c=u.sheets,f=u.rv;if(f)for(o=f.length-1;o>=0;o--)((n=f[o]).type===t||u.bJc(n.type,t))&&f.splice(o,1);for(a.GC$(u.sv).unbind(t+J,e),r=0,i=c;r<i.length;r++)i[r].unbind(t,e);for(s=0,l=u.pJc;s<l.length;s++)l[s].unbind(t,e)},t.prototype.bJc=function(t,e){return 0===e.indexOf(".")&&t.substring(t.length-e.length)===e},t.prototype.unbindAll=function(){var t,e,o,n,r=this,i=r.sheets;for(r.rv.length=0,a.GC$(r.sv).unbind(J),t=0,e=i;t<e.length;t++)e[t].unbindAll();for(o=0,n=r.pJc;o<n.length;o++)n[o].unbindAll()},t.prototype.Fu=function(t,e,o){var n,r,i,s,l=this,u=l.sheets;for(l.rv.push({type:t,data:e,fn:o}),a.GC$(l.sv).bind(t+X,e,o),n=0,r=u;n<r.length;n++)r[n].Fu(t,e,o);for(i=0,s=l.pJc;i<s.length;i++)s[i].Fu(t,e,o)},t.prototype.Gu=function(t,e){var o,n,r,i,s,l,u=this,c=u.sheets,f=u.rv;for(o=0;o<f.length;o++)((n=f[o]).type===t||u.bJc(n.type,t))&&f.splice(o,1);for(a.GC$(u.sv).unbind(t+X,e),r=0,i=c;r<i.length;r++)i[r].Gu(t,e);for(s=0,l=u.pJc;s<l.length;s++)l[s].Gu(t,e)},t.prototype.nu=function(){var t,e,o,n,r=this,i=r.sheets;for(r.rv.length=0,a.GC$(r.sv).unbind(X),t=0,e=i;t<e.length;t++)e[t].nu();for(o=0,n=r.pJc;o<n.length;o++)n[o].nu()},t.prototype.Wq=function(t,e){0===this.jm&&a.GC$(this.sv).trigger(t,e)},t.prototype.tw=function(t,e,o,n){this.Wq(s.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:e,col:o,sheetArea:n})},t.prototype.pw=function(t){var e,o,n;for(e=0,o=this.rv;e<o.length;e++)n=o[e],t.bind(n.type,n.data,n.fn)},t.prototype.suspendEvent=function(){var t,e,o,n,r=this,i=r.sheets;for(r.jm++,t=0,e=i;t<e.length;t++)e[t].suspendEvent();for(o=0,n=r.pJc;o<n.length;o++)n[o].suspendEvent()},t.prototype.resumeEvent=function(){var t,e,o,n,r=this,i=r.sheets;for(r.jm--,r.jm<0&&(r.jm=0),t=0,e=i;t<e.length;t++)e[t].resumeEvent();for(o=0,n=r.pJc;o<n.length;o++)n[o].resumeEvent()},t.prototype.focus=function(t){var e,o;!1===t?s.Vl.Zl(F):(e=xt(this))?e.zt():(o=this.getActiveSheetTab())&&o.zt()},t.prototype.Wv=function(){return this.Vv>2007?15:18},t.prototype.Xv=function(){return this.Vv>2007?22:this.Wv()},t.prototype.cec=function(t){var e,o=this,n=t?o.vKc:o.wKc,r=t?o.nKc:o.kKc,i=o.options.scrollbarAppearance===y.ScrollbarAppearance.mobile;if(n&&r&&i)switch(e=o.ku,r.iec){case y.ScrollbarState.hide:e.Rdc(t);break;case y.ScrollbarState.show:e.Tdc(n),e.Wdc(t);break;case y.ScrollbarState.active:e.Tdc(n),e.Wdc(t),e.Udc(n);break;case y.ScrollbarState.inactive:e.uKc(n),e.Rdc(t)}},t.prototype.xJc=function(){return this.Vv>2007?28:this.Wv()},t.prototype.uw=function(t,e,o,n,r){var i,s,l="auto",u=this;u.vw||(i=a.getHostMaxZIndex(u.qo)+1,s=A(Y),r?a.GC$(s).addClass("gc-spread-pivot-toolTip"):a.GC$(s).addClass("gc-spread-toolTip"),a.GC$(s).addClass("ui-state-default ui-widget-content btn-default").css({position:nt,padding:"0px 3px 0px 3px",font:M("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":i}).width(l).height(l).appendTo(D.body),u.vw=s),u.ww(t,e,o,n)},t.prototype.ww=function(t,e,o,n){var r,i,s,l,u,c,f=this.WJc();f&&((r=this.vw)&&(i=a.GC$(r),t?(i.html(t),i.show()):i.hide(),s=f.Vs(),n&&(o-=s.top,e-=s.left),u=(l=f.Dr()).x+l.width-i.outerWidth(),c=l.y+l.height-i.outerHeight(),u<0?e=0:c<0?o=0:(o=j(o,c),e=j(e,u)),x(o)||i.css("top",o+s.top),x(e)||i.css("left",e+s.left)))},t.prototype.xw=function(){var t=this.vw;t&&(a.GC$(t).remove(),this.vw=F)},t.prototype.Av=function(){var e,o,n=this,r=n.yJc();for(s.mn.wn(),n.invalidateLayout(),e=0,o=r.length;e<o;e++)r[e].Av();bt(),i.Common.FXc(),m&&g.sR(),n.repaint(),t.ao(n,"onCultureChanged")},t.prototype.getTab=function(){return this.YJc},t.prototype.changeSheetIndex=function(t,e){var o,n=this,r=n.getSheetIndex(t),i=n.getTab();return!("number"!=typeof e||-1===r||r===e||e<0||e>=n.sheets.length||e%1!=0||n.GXc(t)||(o=n.getActiveSheet().name(),o!==t?(n.suspendPaint(),n.setActiveSheet(t),n.UD(r,e),n.setActiveSheet(o),n.resumePaint()):(n.UD(r,e),i.DXc(r,e)),0))},t.prototype.GXc=function(t){var e,o;for(e=0,o=this.sheets;e<o.length;e++)if(o[e].name()===t)return!1;return!0},t.prototype.UD=function(t,e){var o,n,r=this,i=-1,a=r.yJc(),s=a[t];if(t>e){for(o=t;o>e;o--)a[o]=a[o-1];a[e]=s,i=e}else if(t<e-1){for(e+=1,o=t;o<e-1;o++)a[o]=a[o+1];a[e-1]=s,i=e-1}else t===e-1&&(a[t]=a[e],a[e]=s,i=e);r.$Jc(a),i<(n=r.sheets.length)?r.eq=i:r.xKc=i-n},t.prototype.clone=function(t,e,o,n){var r,i,a,s,l,u,c,f=this,h=f.getSheetFromName(t);if(x(n)&&(n=!0),!(x(h)||x(o)||f.getSheetFromName(o))){for(f.suspendPaint(),f.suspendCalcService(),r=JSON.stringify(h.toJSON({newWorkSheetName:o})),e<0&&(e=0),i=f.vv(o),f.addSheet(e,i),i.yj().q$a=!0,i.fromJSON(JSON.parse(r)),f.setActiveSheet(i.name()),a=h.tables.l$,s=i.tables.l$,c=0;c<a.length;c++)a[c].wq&&n&&(l=a[c].LZ(),s[c].p$(l)),u=s[c].range(),i.t4&&i.t4(u.row,u.col,u.rowCount,u.colCount,y.SheetArea.viewport);return(l=h.wq.Ou)&&n&&i.wq.bind(l),f.resumeCalcService(),f.resumePaint(),i}},t.prototype.FKc=function(t){var e,o,n,r,i=t.command;0!==t.s4&&i.yTa||(o=(e=i.sheetName?s.uJc(this,i.sheetName):s.sJc(this)).getActiveRowIndex(),n=e.getActiveColumnIndex(),r=e.getSelections(),i.xC={GLc:r,HLc:{row:o,col:n}})},t.prototype.GKc=function(e){var o,n,r,i,a,l,u,c,f,h,p=this,d=e.command,g=d.xC,m=s.sJc(p);if((m&&m.name())!==d.sheetName&&(s.tJc(p,d.sheetName),m=s.sJc(p)),!x(g)){if(m.suspendPaint(),o=g.HLc,n=g.GLc,r=g.ILc,i=g.JLc,x(o)||m.Sr(o.row,o.col),!x(n))if(1===(a=n.length))m.setSelection(n[0].row,n[0].col,n[0].rowCount,n[0].colCount);else for(l=0;l<a;l++)u=n[l].row,c=n[l].col,f=n[l].rowCount,h=n[l].colCount,m.addSelection(u,c,f,h);if(t.ao(p,"onCommandExecuting",m),!x(r)){for(l=0;l<r.length;l++)r[l].isSelected&&r[l].isSelected(!0);i||m.EJ()}m.showCell(o.row,o.col,3,3),m.resumePaint()}},t.prototype.changeSelectionInCommandExecuting=function(t,e,o,n,r){if(t&&t.xC){var i=t.xC,a=i.HLc;x(a)||(x(e)||(a.row=e),x(o)||(a.col=o)),x(n)||(i.GLc=n),x(r)||(i.ILc=r)}},t.prototype.BLc=function(){var t=this.getActiveSheet();t&&t.no(!1),this.eq=-1},t.prototype.ALc=function(){var t=this.getActiveSheetTab();t&&t.no(!1),this.xKc=-1},t.prototype.yJc=function(){return[].concat(this.sheets).concat(this.pJc)},t.prototype.$Jc=function(t){var e,o,n,r,i;for(this.sheets.length=0,this.pJc.length=0,e=this.sheets,o=this.pJc,n=0,r=t;n<r.length;n++)(i=r[n])instanceof d.Worksheet?e.push(i):o.push(i)},t.prototype.MJc=function(t){return this.getSheetFromName(t)||this.getSheetTab(t)},t.prototype.XJc=function(t){return this.yJc()[t]},t.prototype.WJc=function(){return this.getActiveSheet()||this.getActiveSheetTab()},t.prototype.ZJc=function(t,e,o,n){var r=this.sheets.length;t<r?this.dq(t,e,o,n):(t-=r,this.hKc(t,e,o,n))},t.prototype.fKc=function(){var t=this.eq;return t<0&&(t=this.sheets.length+this.xKc),t},t.Qp=Tt,t.nv=1,t.ov=0,t}(),e.Workbook=St,s.Zn(St),St.prototype.nextControl=I("nextControl",F),St.prototype.previousControl=I("previousControl",F)},"./dist/core/workbook/workbookpanelex.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt;function rt(t){t.preventDefault?t.preventDefault():t.returnValue=!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/domUtil.js"),r=o("./dist/core/util/common.js"),i=o("Common"),a=o("./dist/core/core.enum.js"),s=o("./dist/core/workbook/sheettabbase.js"),l=i.Common.j.Fa,u=null,c=r.Ul.Ml,f=r.Ul.nl,h=r.Ul.Nl,p=r.Ul.Pl,d=document,g=window,m=Math.round,y=Math.ceil,C="gc-scroll-arrow",v="gc-scrollbar-wrapper",b="gc-scroll-mobile-track",w="gc-scroll-mobile-thumb",T="gc-scroll-mobile-state-active",S="gc-no-user-select",x="width",A="height",I="gc-scrollbar-stateActive ui-state-active",R="left",M="right",k="top",N="bottom",O="position",D="border",F="padding",E="margin",j="overflow",P="display",L="100%",G="borderWidth",B="boxSizing",_="absolute",V="relative",z="mousedown"+(H=".gcScrollbar"),U="mouseup"+H,W="mousemove"+H,q="mouseover"+H,J="mouseout"+H,X="mousewheel",Z="inline-block",Y="content-box",K="DOMMouseScroll",Q="scroll"+H,function(t){t[t.horizontalScroll=0]="horizontalScroll",t[t.verticalScroll=1]="verticalScroll"}($=e.ScrollOrientation||(e.ScrollOrientation={})),tt=function(){function t(t,e,o,n,r,i,s,l,c){this.updateStateFn=c;var f=this;f.jec=l,f.JB=!1,f.KB=!1,f.LB=u,f.MB=u,f.NB=300,f.OB=70,f.PB=t,f.Jwa(a.ScrollbarState.show),f.Vo("number"==typeof e?e:0),f._v("number"==typeof o?o:0),f.dw("number"==typeof n?n:0),f.cw("number"==typeof r?r:0),f.bw("number"==typeof i?i:0),f.QB="number"==typeof s?s:1,f.RB=!1,f.SB=0,f.Qb=f.bw(),f.ew()}return t.prototype.Bv=function(){return this.TB},t.prototype.Jwa=function(t){t===a.ScrollbarState.inactive&&this.JB||(this.iec=t,this.updateStateFn&&this.updateStateFn())},t.prototype.value=function(t){var e,o=this;return 0===arguments.length?o.Qb:("number"==typeof t&&t<=o.cw()&&t>=o.bw()&&(o.Qb=t,e=(t-o.bw())*o.UB,o.scrollTo(e,!0)),o)},t.prototype.ew=function(){var t,e,o,r=this,i=0,s=0,l=!1,u=r.jec===a.ScrollbarAppearance.mobile,c=u?0:2,f=r._v(),p=r.Vo(),d=u?0:f,g=p-2*d,y=d,T=R,I=M,H="gc-scroll-arrowLeft",z="gc-scroll-arrowRight",U="gc-scrollbar-horizontal",W="margin-left",q="ui-button ui-state-default ui-corner-bl btn btn-default",J="ui-icon ui-icon-triangle-1-w",X="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",K="ui-icon ui-icon-grip-solid-vertical",Q="ui-button ui-state-default ui-corner-br btn btn-default",$="ui-icon ui-icon-triangle-1-e";r.VB=g,r.PB||(g=d=u?0:p,y=f-2*d,T=k,I=N,H="gc-scroll-arrowUp",z="gc-scroll-arrowDown",U="gc-scrollbar-vertical",W="margin-top",q="ui-button ui-state-default ui-corner-tr btn btn-default",J="ui-icon ui-icon-triangle-1-n",X="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",K="ui-icon ui-icon-grip-solid-horizontal",Q="ui-button ui-state-default ui-corner-br btn btn-default",$="ui-icon ui-icon-triangle-1-s",r.VB=y),t=r.VB,e=r.cw()-r.bw(),r.dC=r.dw()*t/(e+r.dw()),r.dC>t&&(r.dC=t),r.dC<10&&(r.dC=10),o=r.dC,r.UB=0===e?1:(t-o)/e,r.PB?(i=o,s=d):(i=d,s=o),r.WB||(l=!0,r.TB=h("div"),r.WB=n.GC$(r.TB),r.WB.css([O,R,k,j,"outline",F,E],[V,0,0,"hidden","none",0,0]).addClass("gc-scroll-container gc-scroll-corner-all ui-widget ui-corner-all ")),u?r.WB.addClass(b):r.WB.removeClass(b),r.XB||function(t){r.XB=n.GC$.Nl("div",[O,P,G,F,E,B],[_,Z,"1px",0,0,Y],C+" "+q,t),r.YB=n.GC$.Nl("span",[P,D,F,E],["block","none",0,0],H+" "+J,r.XB)}(r.WB),r.ZB||function(t){r.ZB=n.GC$.Nl("div",[O,P,B,D,F,E],[_,Z,Y,"none",0,0],v+" "+v,t)}(r.WB),r.$B?r.$B.removeAttr("style"):function(t){r.$B=n.GC$.Nl("div",[],[],S+" "+X+" gc-scroll-bar",t),r._B=n.GC$.Nl("span",[P,D,F,E],["block","none",0,0],U+" "+K,r.$B)}(r.ZB),u?r.$B.css(O,_).addClass(w):r.$B.css([O,G,F,E,B],[_,"1px",0,0,Y]).removeClass(w),r.aC||function(t){r.aC=n.GC$.Nl("div",[O,P,G,F,E,B],[_,Z,"1px",0,0,Y],C+" "+Q,t),r.bC=n.GC$.Nl("span",[P,D,F,E],["block","none",0,0],z+" "+$,r.aC)}(r.WB),u?(function(t,e){var o=t.get(0);o&&(o.style[e]="")}(r.WB,"border"),r.PB?(r.WB.css([x,A],[L,L]),r.ZB.css([T,x,A],[d,L,L]),r.$B.css([T,x,A],[r.SB,m(i-c),L])):(r.WB.css([x,A],[L,L]),r.ZB.css([T,x,A],[d,L,L]),r.$B.css([T,x,A],[r.SB,L,m(s-c)])),r._B.remove(),r.XB.remove(),r.aC.remove()):(r.WB.css([x,A,D],[p,f,"none"]),r.ZB.css([T,x,A],[d,g,y]),r.$B.css([T,x,A],[r.SB,m(i-c),m(s-c)]),r.XB.css([T,x,A],[0,d-c,d-c]),r.YB.css([x,A],[L,L]),r.aC.css([I,x,A],[0,d-c,d-c]),r.bC.css([x,A],[L,L]),r._B.css([x,A,W],[d-c,d-c,Math.floor((r.dC-d)/2)]),r.$B.append(r._B),r.WB.append(r.XB),r.WB.append(r.aC)),l&&r.eC()},t.prototype.eC=function(){var e=this;function o(t,o){t.bind(z,(function(t){e.fC(t,o)})).bind(U,(function(t){e.gC(t,o)})).bind(q,(function(t){e.hC(t,o)})).bind(J,(function(t){e.iC(t,o)}))}o(e.XB,!0),o(e.aC,!1),e.$B.bind(z,(function(t){e.jC(t)})).bind(W,(function(t){e.kC(t)})).bind(U,(function(t){e.lC(t)})).bind(q,(function(t){e.mC(t)})).bind(J,(function(t){e.nC(t)})),e.ZB.bind(z,(function(t){var o,n;c&&c.mozilla&&(o=(new Date).valueOf(),n=e.oC,e.oC=o,n&&o-n<100)||e.pC(t)})).bind(U,(function(t){e.qC(t)})),e.GB=function(t){e.sC(t)},e.WB.bind(X,e.GB),e.WB.bind(K,e.GB),t.ao(e,"initEvents",e.TB)},t.prototype.$dc=function(t){this.jec=t},t.prototype.dispose=function(){var e=this;function o(t){t&&t.unbind(H)}o(e.aC),o(e.$B),o(e.XB),o(e.ZB),e.WB&&(e.GB&&(e.WB.unbind(X,e.GB),e.WB.unbind(K,e.GB)),t.ao(e,"dispose",e.TB),e.WB.unbind(H).remove())},t.prototype.tC=function(){var t=this;t.RB||(n.GC$(d).bind(W,(function(e){t.kC(e)})).bind(U,(function(e){t.lC(e)})),t.RB=!0)},t.prototype.uC=function(){this.RB&&(this.RB=!1,n.GC$(d).unbind(W).unbind(U))},t.prototype.fC=function(t,e){var o,n=0,r=this,i=!0;r.KB=!0,null===r.LB&&(e?(r.XB.addClass(I),n=0-r.qB(),r.vC=a.Nxb.smallDecrement):(r.aC.addClass(I),n=r.qB(),r.vC=1),(o=function(){r.scrollTo(r.SB+n*r.UB,!1),r.LB=g.setTimeout(o,i?r.NB:r.OB),i=!1})(),rt(t))},t.prototype.gC=function(t,e){var o=this;(e?o.XB:o.aC).removeClass(I),o.wC(),rt(t)},t.prototype.hC=function(t,e){(e?this.XB:this.aC).addClass("gc-scroll-arrow-hover ui-state-hover"),rt(t)},t.prototype.iC=function(t,e){var o=this;(e?o.XB:o.aC).removeClass("gc-scroll-arrow-hover ui-state-hover "+I),o.wC(),rt(t)},t.prototype.jC=function(t){var e,o,n,r,i,s,l=this;0===t.button&&(l.JB=!0,l.xC={x:t.pageX,y:t.pageY},l.Jwa(a.ScrollbarState.show),l.tC(),l.WB.addClass(T),l.$B.addClass(I),e=l.$B.offset(),o=l.$B.outerWidth(!0),n=l.$B.outerHeight(!0),r=l.ZB.offset(),i=l.ZB.outerWidth(!0),s=l.ZB.outerHeight(!0),l.yC={isBeyondEdge:!1,startEdgePosition:{x:r.left+t.pageX-e.left,y:r.top+t.pageY-e.top},endEdgePosition:{x:r.left+i-(o-t.pageX+e.left),y:r.top+s-(n-t.pageY+e.top)}}),rt(t)},t.prototype.kC=function(t){var e=this;e.JB&&(e.Jwa(a.ScrollbarState.active),e.zC={x:t.pageX,y:t.pageY},e.AC(),e.xC=e.zC,n.GC$(d.body).attr("unselectable","on").addClass(S)),rt(t)},t.prototype.lC=function(t){var e,o,r,i,s=this;s.JB=!1,s.vC=a.Nxb.thumbPosition,s.yC=null,s.WB.trigger(Q,{newValue:s.Qb,oldValue:s.Qb,scrollOrientation:s.PB?$.horizontalScroll:$.verticalScroll,scrollEventType:s.vC}),e=(s.Qb-s.bw())*s.UB,o="left",i=(r=t.target.classList)&&r.contains(w),s.PB||(o="top"),i?s.Jwa(a.ScrollbarState.hide):s.Jwa(a.ScrollbarState.inactive),s.SB=e,s.$B.css(o,m(e)),s.uC(),n.GC$(d.body).removeClass(S),n.GC$(d.body).attr("unselectable")&&n.GC$(d.body).removeAttr("unselectable"),s.$B.removeClass(I),s.WB.removeClass(T),s.vC=6,s.WB.trigger(Q,{newValue:s.Qb,oldValue:s.Qb,scrollOrientation:s.PB?$.horizontalScroll:$.verticalScroll,scrollEventType:s.vC}),rt(t)},t.prototype.mC=function(t){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),rt(t)},t.prototype.nC=function(t){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),rt(t)},t.prototype.sC=function(t){var e,o,n=this;l(t.wheelDelta)&&l(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=(t.detail?t.detail:t.wheelDelta/-40)/3*n.qB()*n.UB,n.vC=e>=0?1:0,n.scrollTo(n.SB+e,!1),n.vC=6,o={newValue:n.Qb,oldValue:n.Qb,scrollOrientation:n.PB?$.horizontalScroll:$.verticalScroll,scrollEventType:n.vC},n.WB.trigger(Q,o),rt(t)},t.prototype.pC=function(t){var e,o=this,n=!0,r=t.pageX,i=t.pageY,s=0,l=o.ZB.offset(),u=o.rB();null===o.MB&&(s=o.PB?r-l.left-o.SB:i-l.top-o.SB,e=function(){var t,c=o.SB;if((t=o.PB?r-l.left-c:i-l.top-c)*s<0||t>=0&&t<o.dC)o.CC();else{if(s<0)o.vC=a.Nxb.largeDecrement,o.scrollTo(c-u*o.UB,!1);else{if(!(s>0))return void o.CC();o.vC=a.Nxb.largeIncrement,o.scrollTo(c+u*o.UB,!1)}o.MB=g.setTimeout(e,n?o.NB:o.OB),n=!1}},e(),rt(t))},t.prototype.qC=function(t){this.CC(),rt(t)},t.prototype.CC=function(){var t,e=this;e.MB&&clearTimeout(e.MB),e.MB=u,e.vC=a.Nxb.endScroll,t={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?$.horizontalScroll:$.verticalScroll,scrollEventType:e.vC},e.WB.trigger(Q,t)},t.prototype.wC=function(){var t,e=this;e.KB&&(e.KB=!1,e.LB&&clearTimeout(e.LB),e.LB=u,e.vC=6,t={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?$.horizontalScroll:$.verticalScroll,scrollEventType:e.vC},e.WB.trigger(Q,t))},t.prototype.AC=function(){var t,e,o,n,r,i=this,a=i.SB,s=i.zC,l=i.yC;function u(t){return i.PB?t.x:t.y}function c(t,e){i.PB?t.x=e:t.y=e}if(t=u(s),e=u(i.xC),l&&l.isBeyondEdge){if(o=u(l.startEdgePosition),n=u(l.endEdgePosition),t<o||t>n)return;e<o&&c(i.xC,o),e>n&&c(i.xC,n)}(r=a+(t-e))!==a&&(i.vC=5,i.scrollTo(r,!1))},t.prototype.scrollTo=function(t,e){var o,n,r,i,s,u,c,f,h=this,p=k,d=h.VB-h.dC;h.PB&&(p=R),o=!1,n=!1,r=!1,t>d&&(t=d,r=!0,n=!0),t<0&&(t=0,r=!0,o=!0),h.yC&&(h.yC.isBeyondEdge=r),i=h.QB===a.ScrollType.continuous?m(t/h.UB)+h.bw():t/h.UB+h.bw(),s=h.Qb,u=!1,e||(f={newValue:i,oldValue:s,scrollOrientation:h.PB?$.horizontalScroll:$.verticalScroll,scrollEventType:h.vC,isBeyondMaxEdge:n,isBeyondMinEdge:o},h.WB.trigger(Q,f),u=f.ignoreUpdatePosition,f.newValue>h.cw()&&(f.newValue=h.cw()),i=f.newValue,c=f.newValueWithOffset),l(c)&&(c=i),h.Qb=i,5!==h.vC&&(t=(c-h.bw())*h.UB),h.SB=t,u||h.$B.css(p,m(t))},t.prototype.hitTest=function(t,e){var o,r,i,s,l=this,u=l.$B.outerWidth(),c=l.XB.outerWidth(),f=l.ZB.outerWidth(),h=l.$B.offset(),p=n.GC$(l.Bv()).offset(),d=h.left-p.left-18;return l.PB?t<0+f+c&&t>0+c?t<0+d+u+c&&t>d?{element:a.Oxb.ThumbButton,x:t,y:e}:{element:a.Oxb.TrackButton}:t<=0+c&&t>0?{element:a.Oxb.LeftButton,x:t,y:e}:{element:a.Oxb.RightButton,x:t,y:e}:(o=l.$B.outerHeight(),r=l.XB.outerHeight(),i=l.ZB.outerHeight(),s=h.top-p.top-18,e<0+i+r&&e>0+r?e<0+s+o+r&&e>s?{element:a.Oxb.ThumbButton,x:t,y:e}:{element:a.Oxb.TrackButton}:e<=0+r&&e>0?{element:a.Oxb.UpButton,x:t,y:e}:{element:a.Oxb.DownButton,x:t,y:e})},t.prototype.pia=function(){return{x:0,y:0,width:this.Vo(),height:this._v()}},t.prototype.show=function(){this.ZB.show()},t.prototype.hide=function(){this.ZB.hide()},t.prototype.wDc=function(t){var e=this.WB.parent()&&this.WB.parent().parent();return e?t?e.height():e.width():u},t}(),e.hv=tt,r.Zn(tt),(et=tt.prototype).qB=p("smallChange",1),et.rB=p("largeChange",10),et.dw=p("pageValue",10,(function(t){t<=0&&this.dw(1)})),et.cw=p("maximum",100,(function(t){t<=0&&this.cw(0)})),et.bw=p("minimum",0,(function(t){t<=0&&this.bw(0)})),et.Vo=p("width",0),et._v=p("height",0),ot=function(){function t(t,e){var o=this;o.fB=!0,o.gB=!0,o.hB=18,o.iB=t&&n.GC$(t),o.jB=e&&n.GC$(e),o.ew(!0)}return t.prototype.ew=function(t){var e,o,r,i,a,s,l,f,h,p,d,g=this;function C(t){return t===_?n.GC$.Nl("div",[O,R,k,D,F,E],[_,0,0,"none",0,0]):t===V?n.GC$.Nl("div",[O,R,k,D,F,E],[V,0,0,"none",0,0]):u}function v(t,e){var o,r,i,a=e?g.mB:g.nB;return a||(o=new tt(e),r=n.GC$.Nl("div"),e?(g.oB=r,g.mB=o,r.css([O,R,N,D,F,E],[_,0,0,"none",0,0])):(g.pB=r,g.nB=o,r.css([O,M,k,D,F,E],[_,0,0,"none",0,0])),i=(e?g.mB:g.nB).Bv(),r.append(i),t.append(r),o)}function b(t,e,o,r,i,a){a?(g.oB.css([x,A],[e,r]),t.Vo(e),t._v(r)):(g.pB.css([x,A],[r,e]),t.Vo(r),t._v(e)),t.bw(0),t.cw(i-e),t.dw(e),t.qB(a?g.kB():g.lB()),t.rB(e),t.ew(),n.GC$(t.Bv()).bind(Q,(function(t,e){o.css(a?R:k,0-e.newValue)})),a?g.oB.show():g.pB.show()}g.iB&&g.jB&&(e=g.hB,o=g.jB.width(),r=g.jB.height(),s=(i=g.iB.width())-e,l=(a=g.iB.height())-e,f=!1,g.uB||(g.uB=C(V),g.uB.css([O,j],[V,"hidden"]),f=!0),g.uB.css(A,a),function(t){g.sB||(g.sB=C(V),g.sB.css([j,P,x],["hidden",Z,L]),t.append(g.sB))}(g.uB),function(t){g.tB||(g.tB=n.GC$.Nl("div",O,V,u,t))}(g.sB),t&&g.tB.append(g.jB).css([k,R],[0,0]),c.chrome&&(o=m(o),r=m(r),i=y(i),a=y(a)),p=(h=g.vB(o,r,i,a)).wB,(d=h.xB)?(p||(s+=e),b(v(g.uB,!0),s,g.tB,e,o,!0)):g.oB&&g.oB.hide(),p?(d||(l+=e),b(v(g.uB,!1),l,g.tB,e,r,!1)):g.pB&&g.pB.hide(),d||p||(s+=e,l+=e),g.fB=d,g.gB=p,g.yB=s,g.zB=l,g.sB.css(A,l),f&&(g.iB.append(g.uB),g.AB()))},t.prototype.BB=function(t){var e=this,o=e.CB(t),n=o.EB,r=o.FB;!l(n)&&e.mB&&e.lu(n),!l(r)&&e.nB&&e.ju(r)},t.prototype.lu=function(t){var e,o,n=this;n.mB.value(t),e=n.yB,o=n.jB.width(),t>=0&&t<=o-e&&n.tB.css(R,0-t)},t.prototype.ju=function(t){var e,o,n=this;n.nB.value(t),e=n.zB,o=n.jB.height(),t>=0&&t<=o-e&&n.tB.css(k,0-t)},t.prototype.vB=function(t,e,o,n){var r=o,i=n-this.hB,a={xB:!1,wB:!1};return t>o&&(a.xB=!0,a.wB=e>i),e>n&&(a.wB=!0,a.xB=t>r),a},t.prototype.CB=function(t){var e,o,r,i,a,s,l,c=n.GC$(t),f=this.sB,h=this.tB,p={EB:u,FB:u};return t?(e=c.offset(),o=h.offset(),r=f.offset(),e.leftWidth=e.left+c.outerWidth(),e.topHeight=e.top+c.outerHeight(),r.leftWidth=r.left+f.outerWidth(),r.topHeight=r.top+f.outerHeight(),i=e.left-o.left,e.left<r.left?p.EB=i:e.leftWidth>r.leftWidth&&(a=e.leftWidth-o.left-f.innerWidth(),p.EB=i<a?i:a),s=e.top-o.top,e.top<r.top?p.FB=s:e.topHeight>r.topHeight&&(l=e.topHeight-o.top-f.innerHeight(),p.FB=s<l?s:l),p):p},t.prototype.AB=function(){var t=this;this.tB&&(t.GB=function(e){t.HB(e)},t.tB.bind(X,t.GB),t.tB.bind(K,t.GB))},t.prototype.HB=function(t){var e,o,n,r,i,a,s=this;l(t.wheelDelta)&&l(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta/-40,o=s.nB,n=parseInt(s.tB.css(k),10),r=s.zB,(i=s.jB.height())<r&&(i=r),isNaN(n)&&(n=0),(a=n-e*s.lB())>=0&&(a=0),a<0&&0-a>i-r&&(a=0-(i-r)),a!==n&&(s.tB.css(k,a),s.gB&&o.value(0-a)),f(t)},t.prototype.dispose=function(){var t=this;t.uB&&(t.mB&&t.mB.dispose(),t.nB&&t.nB.dispose(),t.tB&&t.GB&&(t.tB.unbind(X,t.GB),t.tB.unbind(K,t.GB)),n.GC$(t.uB).remove())},t}(),e.IB=ot,(nt=ot.prototype).kB=p("horizontalSmallChange",10),nt.lB=p("verticalSmallChange",10),s.DC.$n("scrollbar",{preProcessMouseMove:function(t){var e=this.OC;(e.nKc.JB||e.kKc.JB)&&(t.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d;function g(t){return t&&t.options.allowCopyPasteExcelStyle}function m(t,e){var o,n;if(c.msie){for(o=[],n=0;n<t.length;n++)e&&""===t[n].trim()||o.push(t[n]);return o.join("")}return t.join("")}function y(t,e,o,n){var r,i,a=[];for(r=0,i=o;r<i;r++)a[r]=t.getRowHeight(e+r,n);return a}function C(t,e,o,n){var r,i,a=[];for(r=0,i=o;r<i;r++)a[r]=t.getColumnWidth(e+r,n);return a}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/common.js"),r=o("Common"),i=o("./dist/core/worksheet/stylehelper.js"),a=o("./dist/core/worksheet/style.js"),s=o("./dist/core/core.enum.js"),l=r.Common.u,u=/<img[^>]+>/g,c=n.Ul.Ml,f=r.Common.j.Fa,h=r.Common.k.Bb,p=null,d=function(){function t(t){var e=this;e.PA=p,e.n5=p,e.G4=!1,e.tc=t,e.Nl()}return t.prototype.Nl=function(){var e,o,r,i=this,a=document.createElement("div");a.style.position="fixed",a.style.top="0px",a.style.left="0px",a.style.width="0px",a.style.height="0px",a.style.overflow="hidden",(e=document.createElement("div")).setAttribute("contenteditable","true"),e.setAttribute("gcUIElement","gcSheetClipboard"),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",a.appendChild(e),i.KM=e,(o=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),i.tc&&i.tc.options.enableAccessibility&&o.setAttribute("aria-hidden","true"),o.setAttribute("tabindex","-1"),o.style.position="absolute",o.style.overflow="hidden",o.style.background="white",o.style.webkitUserSelect="text",a.appendChild(o),i.qka=o,(r=i.tc.getHost())&&r.appendChild(a),c.msie||c.edge||(i.H4=function(e){var o,r,a,s,l,c,f,h=n.sJc(i.tc),p=e.clipboardData;if(p)if(o=(o=p.getData("text/html")).replace(u,""),(r=i.I4()).innerHTML=o,a=o?i.EZa(r,!0):t.formatClipboardData(p.getData("text/plain")),r.innerHTML="",a||o&&o.indexOf("<table")>=0)h.J4(a,o);else{for(s=void 0,l=p.items,c=0;c<l.length&&(0!==l[c].type.indexOf("image")||!(s=l[c].getAsFile()));c++);s&&((f=new FileReader).onload=function(t){var e=new Image;e.src=t.target.result,e.onload=function(){h.J4(a,o,e.src)}},f.readAsDataURL(s))}e.preventDefault()},e.addEventListener("paste",i.H4),i.rka=function(e){var o,r,a,s=n.sJc(i.tc),l=e.clipboardData;l&&((o=t.formatClipboardData(l.getData("text/plain")))||(r=l.getData("text/html"))&&((a=i.I4()).innerHTML=r,o=i.EZa(a,!1),a.innerHTML=""),s.J4(o,"")),e.preventDefault()},o.addEventListener("paste",i.rka))},t.prototype.no=function(){var t,e,o,n,r,i,a=this,s=a.KM;s&&(c.msie||c.edge||(s.removeEventListener("paste",a.H4),a.qka.removeEventListener("paste",a.rka)),(t=s.parentElement)&&((e=t.parentElement)&&e.removeChild(t)),a.KM=p,a.qka=p),(o=a.K4)&&((n=o.parentElement)&&n.removeChild(o),a.K4=p),(r=a.FZa)&&((i=r.parentElement)&&i.removeChild(r),a.FZa=p),a.tc=p},t.prototype.ska=function(t){g(this.tc)?this.KM.innerHTML=t:this.qka.value=t},t.prototype.M4=function(){g(this.tc)?this.KM.focus():this.qka.focus()},t.prototype.N4=function(){g(this.tc)?document.execCommand("selectAll"):this.qka.select()},t.prototype.wx=function(){var e,o,n,r="",i="",a="";return g(this.tc)?((e=this.KM)&&((o=e.getElementsByTagName("table")).length>0?r=o[0].outerHTML:(n=e.getElementsByTagName("img")).length>0&&(a=n[0].src)),i=this.EZa(this.KM,!0)):i=t.formatClipboardData(this.qka.value),{html:r,text:i,image:a}},t.Q4=function(e,o,r,i,a,l,u,c,f,h,d,g,m,v){var b,w,T,S,x,A,I,R,M,k,N,O=e.Tq(n.kf(r,a,i,l),u),D=RegExp(String.fromCharCode(32),"g"),F="&nbsp;",E=!1,j=!1;return u===s.SheetArea.viewport&&(r<0&&2==(2&o)&&(E=!0),a<0&&1==(1&o)&&(j=!0)),r=O.row,a=O.col,i=O.rowCount,l=O.colCount,b=d?e.options.gridline:p,w=d?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:p,T=m?y(e,r,i,u):p,S=m?C(e,a,l,u):p,u===s.SheetArea.viewport?(x=void 0,A=void 0,I=p,R=p,M=t.Ema(e,r,i,a,l,3,f,h,c,O,D,F,b,g,T,S,v),j&&(x=m?C(e,a,l,2):p,k=e.getColumnCount(2),I=t.Ema(e,r,i,0,k,2,f,[],c,O,D,F,w,g,T,x,v)),E&&(A=m?y(e,r,i,1):p,N=e.getRowCount(1),R=t.Ema(e,0,N,a,l,1,[],h,c,O,D,F,w,g,A,S,v)),t.yb(M,I,R,v)):u===s.SheetArea.rowHeader?(I=t.Ema(e,r,i,a,l,2,f,h,c,O,D,F,w,g,T,S,v),t.yb(I,p,p,v)):u===s.SheetArea.colHeader?(R=t.Ema(e,r,i,a,l,1,f,h,c,O,D,F,w,g,T,S,v),t.yb(R,p,p,v)):void 0},t.yb=function(e,o,n,r){var i,a=e,s=0,l=function(t,e){var o,n=[],r=t.length;for(o=0;o<r;o++)n.push(t[o].concat(e[o]));return n};return o&&(s=o[0].length,a=l(o,e)),n&&(i=n.length,s&&(n=l(t.Ema(p,0,i,0,s,p,[],[],!1,p,p,p,p,!1,[],[],r),n)),a=n.concat(a)),t.Fma(a,r)},t.Fma=function(t,e){var o,n,r="",i=t.length;for(r+=e?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true">',o=0;o<i;o++){for(r+="<tr>",n=0;n<t[o].length;n++)r+=t[o][n];r+="</tr>"}return r+"</table>"},t.gYc=function(t){return t&&t.indexOf('gc-sjs-clipboard="true"')>=0},t.Ema=function(e,o,r,i,a,s,u,d,g,m,y,C,v,b,w,T,S){var x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it;for(v&&(x=v.color,A=v.showHorizontalGridline,I=v.showVerticalGridline),R=[],M=0;M<r;M++)if(!(h(u,k=o+M)||S&&w&&w[k]<=0)){for(N=[],O=0;O<a;O++)if(!(h(d,D=i+O)||S&&T&&T[D]<=0)){if(F="",E=void 0,j=void 0,P=1,L=1,g&&e&&((E=e.getSpan(k,D,s))&&t.isPartSpan(E,m,u,d)&&(E=p),E)){if(E.row!==k||E.col!==D)continue;j=e.getActualStyle(k,D,s),G=e.getActualStyle(E.row+E.rowCount-1,E.col+E.colCount-1,s),!j.borderRight&&G.borderRight&&(j.borderRight=G.borderRight),!j.borderBottom&&G.borderBottom&&(j.borderBottom=G.borderBottom)}F+="<td",B=e&&e.getValue(k,D,s),g&&e&&(E&&((P=E.rowCount)>1&&(F+=" rowSpan="+P),(L=E.colCount)>1&&(F+=" colSpan="+L)),j||(j=e.getActualStyle(k,D,s)),_=t.convertVAlign,V=t.convertHAlign,H=t.convertLineBorder,F+=S?' style="padding: 0; ':' style="',z=A,U=I,(W=j.backColor)&&(F+="background-color: "+W+";",z=!1,U=!1),(q=j.foreColor)&&(F+="color: "+q+";"),(J=j.font)&&(b&&(J=J+", "+n.FallbackFontFamily),F+="font: "+J.replace(/"/g,"'")+";"),X=j.vAlign,f(X)||(F+="vertical-align: "+_(X)+";"),Z=j.hAlign,f(Z)||(S&&(Z=n.Ul.ol(Z,B)),(Y=V(Z))&&(F+="text-align: "+Y+";")),(K=j.borderLeft)&&(F+="border-left: "+H(K)+";",U=!1),(Q=j.borderRight)&&(F+="border-right: "+H(Q)+";",U=!1),($=j.borderTop)&&(F+="border-top: "+H($)+";",z=!1),(tt=j.borderBottom)&&(F+="border-bottom: "+H(tt)+";",z=!1),z&&U?F+="border: 1px solid "+x+";":z?(F+="border-top: 1px solid "+x+";",F+="border-bottom: 1px solid "+x+";"):U&&(F+="border-left: 1px solid "+x+";",F+="border-right: 1px solid "+x+";"),et=J?n.Ul.fp(J):0,F+=t.dYc(M,O,P,L,w,T,et),F+='"'),F+=">",ot=void 0,nt=void 0,g&&e&&((nt=1==(1&(rt=j.textDecoration)))||(nt=8==(8&rt)),(ot=2==(2&rt))&&(F+="<s>"),nt&&(F+="<u>")),(it=e?e.getText(k,D,s):"")?(" "!==it[0]&&" "!==it[it.length-1]||"number"!=typeof B||(it=it.trim()),it=l.Ob(it).replace(y,C)):c.chrome?it=" ":c.safari&&(it="&nbsp;"),F+=it,g&&(nt&&(F+="</u>"),ot&&(F+="</s>")),F+="</td>",N.push(F)}R.push(N)}return R},t.dYc=function(t,e,o,n,r,i,a){var s,l="",u=function(t,e,o){var n,r=-1;if(o)for(r=0,n=0;n<e;n++)r+=o[t+n]||0;return r}(t,o,r);return u>0&&(u-=1),s=function(t,e,o){var n,r=-1;if(o)for(r=0,n=0;n<e;n++)r+=o[t+n]||0;return r}(e,n,i),s>0&&(s-=1),u>=0&&s>=0&&(l="overflow: hidden;white-space: nowrap;height: "+u+"px;line-height: "+Math.min(a,u)+"px; width: "+s+"px;max-width: "+s+"px;min-width: "+s+"px;"),l},t.prototype.I4=function(){var t,e,o=this;return o.K4||((t=document.createElement("div")).style.display="none",(e=o.tc.getHost())&&e.appendChild(t),o.K4=t),o.K4},t.prototype.GZa=function(){var t,e,o=this;return o.FZa||((t=document.createElement("div")).style.display="none",(e=o.tc.getHost())&&e.appendChild(t),o.FZa=t),o.FZa},t.prototype.R4=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m=this.I4();if(m.innerHTML=t,r=m.getElementsByTagName("table"),i=e.KLc(),r.length>0)for(a=this.HZa(r[0],!0),l=o+(s=0);s<a.length;s++,l++){if(u=a[s],i)for(;0===e.getRowHeight(l);)l++;for(f=n+(c=0);c<u.length;c++,f++)if(h=u[c]){if(i)for(;0===e.getColumnWidth(f);)f++;e.Pq(l,f,h.style),p=h.rowSpan,d=h.colSpan,(p>1||d>1)&&((g=e.getSpan(l,f))?(g.row=l,g.col=f,g.rowCount=p,g.colCount=d):e.addSpan(l,f,p,d))}}m.innerHTML=""},t.prototype.lgc=function(t,e,o,n){var r,i,a=e.pictures;a&&(r=function(t){for(var e="picture",o=1,n=e+""+o;t.get(n);)n=e+""+ ++o;return n}(a),(i=a.add(r,t,0,0)).startRow(o),i.startColumn(n))},t.prototype.HZa=function(e,o){var n,r,i,a,s,l,u,c,f,h,p,d=this.GZa(),g=[],m=/ +/g;for(n=0;n<e.rows.length;n++)for(r=e.rows[n],g[n]||(g[n]=[]),i=g[n],a=0,s=0;a<r.cells.length;a++){for(l=r.cells[a];i[s];)s++;for(u=i[s]={},c=void 0,o&&(c=t.getStyleFromDOM(l),u.style=c),d.innerHTML=l.innerHTML.replace(m," "),u.text=d.innerText,u.rowSpan=l.rowSpan,(f=l.getAttribute("style"))&&f.indexOf("mso-ignore:colspan;")>=0?u.colSpan=1:u.colSpan=l.colSpan,h=0;h<l.rowSpan;h++)for(p=0;p<l.colSpan;p++)0===h&&0===p||(g[n+h]||(g[n+h]=[]),g[n+h][s+p]={style:c,text:"",rowSpan:1,colSpan:1});s+=l.colSpan}return d.innerHTML="",g},t.prototype.EZa=function(t,e){var o,n,r,i,a,s,l,u,c,f,h=[];if(t)if((o=t.getElementsByTagName("table")).length>0)for(n=this.HZa(o[0],!1),r=RegExp(String.fromCharCode(160),"g"),i=String.fromCharCode(32),a=0,s=n.length;a<s;a++){for(u=0,c=(l=n[a]).length;u<c;u++)(f=l[u]?l[u].text:"").indexOf("\n")>=0&&(e?(f.indexOf("\r\n")>=0&&(f=m(f.split("\r\n"),!0)),f=m(f.split("\n"),!0)):f='"'+f+'"'),h.push(f.replace(r,i)),u<c-1&&h.push("\t");a<s-1&&h.push("\r\n")}else h.push(function(t){var e,o,n;if(!t)return t;for(e=0;e<t.length&&!((o=t.indexOf("\x3c!--",e))<0)&&(e=o,!((n=t.indexOf("--\x3e",e))<0));)e=n,t=t.substring(0,o)+t.substring(n+3);return t}(t.innerText).trim());return h.join("")},t.prototype.hZ=function(t){var e=this;e.PA=p,e.n5=p,e.G4=!1,e.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},t.isPartSpan=function(t,e,o,n){var r,i,a,s,l,u;if(!e.containsRange(t))return!0;for(r=0,i=o;r<i.length;r++)if(a=i[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(s=0,l=n;s<l.length;s++)if(u=l[s],t.col<=u&&u<t.col+t.colCount)return!0;return!1},t.formatClipboardData=function(t){var e,o,n,r,i=[];if(t){for('"',e=!1,o=0;o<t.length;o++)n=o>0?t[o-1]:"",'"'===(r=t[o])?(e=!e,i.push('"')):e||"\n"!==r||"\r"===n?i.push(r):i.push("\r\n");return i.join("")}return""},t.convertHAlign=function(t){return{0:"left",1:"center",2:"right"}[t]},t.convertVAlign=function(t){return{0:"top",1:"middle",2:"bottom"}[t]},t.convertLineBorder=function(t){return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[t.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[t.style]+" "+t.color},t.convertToHAlign=function(t){return{left:0,center:1,right:2}[t]},t.convertToVAlign=function(t){return{top:0,middle:1,bottom:2}[t]},t.convertToLineBorder=function(t,e,o){var n={none:0,solid:1,dashed:3,dotted:4,double:6};return(c.msie||c.edge)&&"2px"===o?n.solid=5:(o=Math.round(10*parseFloat(o)*3/4)/10)<=.8?n.solid=1:o<=1?(n.solid=2,n.dashed=8):o<=1.5&&(n.solid=5),new a.LineBorder(t,n[e])},t.convertToTextDecoration=function(t){return{underline:1,"line-through":2,none:0}[t]},t.isTransparent=function(t){return 0===r.Common.pc.ec(t).a},t.isBlack=function(t){var e=r.Common.pc.ec(t);return 0!==e.a&&0===e.r&&0===e.g&&0===e.b},t.getStyleFromDOM=function(e){var o,n,r,s,l,u,f,h,p,d,g,m,y,C,v=e.getElementsByTagName("font")[0],b=getComputedStyle(e),w=e.style,T=new a.Style,S=b.backgroundColor;return S&&!t.isTransparent(S)&&(T.backColor=S),o=b.color,v&&(o=v.color),o&&!t.isBlack(o)&&(T.foreColor=o),v?T.font=i.To.F4(getComputedStyle(v)):(n=i.To.F4(b))&&(T.font=n),r=b.verticalAlign,s=t.convertToVAlign,l=t.convertToHAlign,u=t.convertToLineBorder,f=t.convertToTextDecoration,r&&(T.vAlign=s(r)),h=w.textAlign,p=b.textAlign,c.msie||c.edge?T.hAlign=l(""!==h?h:"general"):p&&(T.hAlign=l(p)),"none"!==(d=b.borderLeftStyle)&&(T.borderLeft=u(b.borderLeftColor,d,b.borderLeftWidth)),"none"!==(g=b.borderRightStyle)&&(T.borderRight=u(b.borderRightColor,g,b.borderRightWidth)),"none"!==(m=b.borderTopStyle)&&(T.borderTop=u(b.borderTopColor,m,b.borderTopWidth)),"none"!==(y=b.borderBottomStyle)&&(T.borderBottom=u(b.borderBottomColor,y,b.borderBottomWidth)),C=f(b.textDecorationLine||b.textDecoration),e.getElementsByTagName("u").length>0&&(C|=f("underline")),e.getElementsByTagName("s").length>0&&(C|=f("line-through")),0!==C&&(T.textDecoration=C),T},t}(),e.S4=d},"./dist/core/worksheet/style.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R;function M(t){var e,o;return e={},t&&t.option&&t.option.dataSource?(o=t.option.dataSource,t.option.dataSource=p,e=h(t),o.fetchRows&&!o.LLc&&function(t){t.fetchRows().then((function(e){t.LLc=e}))}(o),e.option.dataSource=o,t.option.dataSource=o):e=h(t),e}function k(t){return t?new A(t.color,t.style&&x[t.style]||p):p}function N(t){var e,o,n,i,a,s,u=r.GC$.extend(!0,{},t),c=t.calendarPage;return c&&(u.calendarPage=l.CalendarPage[c]),(e=t.startDay)&&(u.startDay=l.CalendarStartDay[e]),(o=t.layout)&&((n=o.direction)&&(u.layout.direction=l.LayoutDirection[n]),(i=o.displayAs)&&(u.layout.displayAs=l.LayoutDisplayAs[i])),(a=t.valueType)&&(u.valueType=l.DropdownListValue[a]),(s=t.direction)&&(u.direction=l.LayoutDirection[s]),u}function O(t,e,o,n){var r,a,l,u=e;if(o&&e){if(e.gQa&&e.gQa())return void(t.cellType=u);e.toJSON&&(e=e.toJSON()),r=s._o,a=e.typeName,(l=r[e.type]||r[a]||i.getTypeFromString(a))?(u=new l).fromJSON(e,n):u=p}t.cellType=u}function D(t,e,o){var r,a,s,l,u=e;o&&e&&"object"==typeof e&&(e.toJSON&&(e=e.toJSON()),(a=(r=n.Formatter)&&r.GeneralFormatter)&&((s=e.typeName)?(l=i.getTypeFromString(s))&&(u=new l).fromJSON(e):u=new a(e.formatCached,e.customerCultureName))),t.formatter=u}function F(t,e,o){var r,i,a=e;o&&e&&(e.toJSON&&(e=e.toJSON()),(i=(r=n.Formatter)&&r.GeneralFormatter)&&((a=new i(e.formatCached,e.customerCultureName)).isAuto=!0)),t._autoFormatter=a}function E(t,e,o){e&&((e=t.getColor(e))&&o(e))}function j(t,e,o){return t===y?2===o||1===o?1===e:3===e:t===C?2===o||1===o?1===e:0===e:t===v?1===e:t===g?e===p:void 0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/domUtil.js"),i=o("./dist/core/util/common.js"),a=o("./dist/core/worksheet/stylehelper.js"),s=o("./dist/core/celltype/celltype.ns.js"),l=o("./dist/core/core.enum.js"),u=r.GC$.each,c=i.Ul,f=c.Ol,h=n.Common.j.C4,p=void 0,d=null,Math.sin,Math.cos,Math.abs,Math.max,g="autoFormatter",m="cellType",y="hAlign",C="vAlign",v="imeMode",b="labelOptions",w="cellButtons",T="dropDowns",S={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},function(t){t[t.empty=0]="empty",t[t.thin=1]="thin",t[t.medium=2]="medium",t[t.dashed=3]="dashed",t[t.dotted=4]="dotted",t[t.thick=5]="thick",t[t.double=6]="double",t[t.hair=7]="hair",t[t.mediumDashed=8]="mediumDashed",t[t.dashDot=9]="dashDot",t[t.mediumDashDot=10]="mediumDashDot",t[t.dashDotDot=11]="dashDotDot",t[t.mediumDashDotDot=12]="mediumDashDotDot",t[t.slantedDashDot=13]="slantedDashDot"}(x=e.LineStyle||(e.LineStyle={})),function(t){t[t.conditionalFormat=1]="conditionalFormat",t[t.cell=10]="cell",t[t.table=20]="table",t[t.row=30]="row",t[t.column=40]="column",t[t.sheet=50]="sheet"}(e.LineBorderComposeLevel||(e.LineBorderComposeLevel={})),A=function(){function t(t,e,o){this.color=t||"black",this.style=e||0,this.level=o}return t.prototype.Uo=function(){return new t(this.color,this.style,this.level)},t.prototype.toJSON=function(){var t={},e=this.color,o=this.style;return"black"!==e&&(t.color=e),0!==o&&(t.style=o),t},t.prototype.fromJSON=function(t,e){if(t){var o=t.color,n=t.style;f(o)&&(this.color=o),f(n)&&(this.style=n)}},t.Vo=function(t){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[t&&t.style]||0},t}(),e.LineBorder=A,I=["backColor","foreColor",y,C,"font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",m,"backgroundImageLayout","tabStop","textDecoration",v,"name","parentName","watermark","cellPadding",b,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",w,T,"textOrientation"],R=function(){function t(){var e,o,n,r,i=[];for(e=0;e<arguments.length;e++)i[e]=arguments[e];if((o=this)._id=t.Wo,t.Wo++,0!==i.length)if(n=i[0],1===i.length&&function(t){return!(!t||"object"!=typeof t||t.patternColor||t.stops)}(n))o.lJc(n);else for(r=0;r<I.length;r++)o[I[r]]=i[r]}return t.kxb=function(t,e){var o=t.parentName;o&&!e.getNamedStyle(o)&&delete t.parentName},t.prototype.Yo=function(t,e,o,n){var r,i,a,s,l,u,c,f,d,g=this,m=t.labelOptions,y=t.cellButtons;if(t.cellButtons&&t.cellButtons.length>0)for(y=[],c=0;c<t.cellButtons.length;c++)y.push(h(t.cellButtons[c]));if(f=t.dropDowns,t.dropDowns&&t.dropDowns.length>0)for(f=[],c=0;c<t.dropDowns.length;c++)f.push(M(t.dropDowns[c]));e?(g._autoFormatter=t._autoFormatter,g.backgroundImage=t.backgroundImage,g.backgroundImageLayout=t.backgroundImageLayout,g.backColor=t.backColor,g.foreColor=t.foreColor,g.hAlign=t.hAlign,g.vAlign=t.vAlign,g.font=t.font,g.themeFont=t.themeFont,g.formatter=t.formatter,g.showEllipsis=t.showEllipsis,g.THb=t.THb,r=t.borderLeft,g.borderLeft=r&&r.Uo()||r,g.borderLeft&&o&&(g.borderLeft.level=o),i=t.borderTop,g.borderTop=i&&i.Uo()||i,g.borderTop&&o&&(g.borderTop.level=o),a=t.borderRight,g.borderRight=a&&a.Uo()||a,g.borderRight&&o&&(g.borderRight.level=o),s=t.borderBottom,g.borderBottom=s&&s.Uo()||s,g.borderBottom&&o&&(g.borderBottom.level=o),l=t.diagonalDown,g.diagonalDown=l&&l.Uo()||l,g.diagonalDown&&o&&(g.diagonalDown.level=o),u=t.diagonalUp,g.diagonalUp=u&&u.Uo()||u,g.diagonalUp&&o&&(g.diagonalUp.level=o),g.locked=t.locked,g.textIndent=t.textIndent,g.wordWrap=t.wordWrap,g.shrinkToFit=t.shrinkToFit,g.cellType=t.cellType,g.name=t.name,g.parentName=t.parentName,g.tabStop=t.tabStop,g.textDecoration=t.textDecoration,g.imeMode=t.imeMode,g.watermark=t.watermark,g.cellPadding=t.cellPadding,g.isVerticalText=t.isVerticalText,g.textOrientation=t.textOrientation,m&&(g.labelOptions={alignment:m.alignment,font:m.font,foreColor:m.foreColor,visibility:m.visibility,margin:m.margin}),g.quotePrefix=t.quotePrefix,g.cellButtons=y,g.dropDowns=f):(g.backgroundImage===p&&(g.backgroundImage=t.backgroundImage),g.backgroundImageLayout===p&&(g.backgroundImageLayout=t.backgroundImageLayout),g.backColor===p&&(g.backColor=t.backColor),g.foreColor===p&&(g.foreColor=t.foreColor),g.hAlign===p&&(g.hAlign=t.hAlign),g.vAlign===p&&(g.vAlign=t.vAlign),g.themeFont===p&&g.font===p?(g.themeFont=t.themeFont,g.font=t.font):g.themeFont!==p&&g.font===p&&(g.font=t.font),g.formatter===p&&(g.formatter=t.formatter),g.showEllipsis===p&&(g.showEllipsis=t.showEllipsis),g.THb===p&&(g.THb=t.THb),g._autoFormatter===p&&(g._autoFormatter=t._autoFormatter),g.borderLeft===p&&(r=t.borderLeft,g.borderLeft=r&&r.Uo()||r,g.borderLeft&&o&&(g.borderLeft.level=o)),g.borderTop===p&&(i=t.borderTop,g.borderTop=i&&i.Uo()||i,g.borderTop&&o&&(g.borderTop.level=o)),g.borderRight===p&&(a=t.borderRight,g.borderRight=a&&a.Uo()||a,g.borderRight&&o&&(g.borderRight.level=o)),g.borderBottom===p&&(s=t.borderBottom,g.borderBottom=s&&s.Uo()||s,g.borderBottom&&o&&(g.borderBottom.level=o)),g.diagonalDown===p&&(l=t.diagonalDown,g.diagonalDown=l&&l.Uo()||l,g.diagonalDown&&o&&(g.diagonalDown.level=o)),g.diagonalUp===p&&(u=t.diagonalUp,g.diagonalUp=u&&u.Uo()||u,g.diagonalUp&&o&&(g.diagonalUp.level=o)),g.locked===p&&(g.locked=t.locked),g.textIndent===p&&(g.textIndent=t.textIndent),g.wordWrap===p&&(g.wordWrap=t.wordWrap),g.shrinkToFit===p&&(g.shrinkToFit=t.shrinkToFit),g.cellType===p&&(g.cellType=t.cellType),g.tabStop===p&&(g.tabStop=t.tabStop),g.textDecoration===p&&(g.textDecoration=t.textDecoration),g.imeMode===p&&(g.imeMode=t.imeMode),g.name===p&&(g.name=t.name),g.parentName===p&&(g.parentName=t.parentName),g.watermark===p&&(g.watermark=t.watermark),g.cellPadding===p&&(g.cellPadding=t.cellPadding),!g.labelOptions&&m&&(g.labelOptions={}),(d=g.labelOptions)&&m&&(d.alignment===p&&(d.alignment=m.alignment),d.font===p&&(d.font=m.font),d.foreColor===p&&(d.foreColor=m.foreColor),d.visibility===p&&(d.visibility=m.visibility),d.margin===p&&(d.margin=m.margin)),n||g.quotePrefix!==p||(g.quotePrefix=t.quotePrefix),g.isVerticalText===p&&(g.isVerticalText=t.isVerticalText),g.textOrientation===p&&(g.textOrientation=t.textOrientation),g.cellButtons===p&&(g.cellButtons=y),g.dropDowns===p&&(g.dropDowns=f))},t.prototype.$b=function(t){var e=this;0===arguments.length?u(I,(function(t,o){e[o]=p})):e[t]=p},t.prototype.clone=function(e){var o=this,n=o.borderLeft,r=o.borderTop,i=o.borderRight,a=o.borderBottom,s=o.diagonalDown,l=o.diagonalUp,u=new t;return u.backColor=o.backColor,u.foreColor=o.foreColor,u.hAlign=o.hAlign,u.vAlign=o.vAlign,u.font=o.font,u.themeFont=o.themeFont,u.formatter=p,u.borderLeft=n&&!e&&n.Uo()||n,u.borderTop=r&&!e&&r.Uo()||r,u.borderRight=i&&!e&&i.Uo()||i,u.borderBottom=a&&!e&&a.Uo()||a,u.locked=o.locked,u.textIndent=o.textIndent,u.wordWrap=o.wordWrap,u.shrinkToFit=o.shrinkToFit,u.backgroundImage=o.backgroundImage,u.cellType=p,u.backgroundImageLayout=o.backgroundImageLayout,u.tabStop=o.tabStop,u.textDecoration=o.textDecoration,u.imeMode=o.imeMode,u.name=o.name,u.parentName=o.parentName,u.watermark=o.watermark,u.cellPadding=o.cellPadding,u.labelOptions=o.labelOptions,u.quotePrefix=o.quotePrefix,u.diagonalDown=s&&!e&&s.Uo()||s,u.diagonalUp=l&&!e&&l.Uo()||l,u.isVerticalText=o.isVerticalText,u.showEllipsis=o.showEllipsis,u.THb=o.THb,u.textOrientation=o.textOrientation,D(u,o.formatter,!e),F(u,o._autoFormatter,!e),O(u,o.cellType,!e,!0),function(t,e,o,n){var r,i;if(e===d&&(t.cellButtons=e),e){if(r=e,o)for(r=[],i=0;i<e.length;i++)r.push(h(e[i]));t.cellButtons=r}}(u,o.cellButtons,!e),function(t,e,o,n){var r,i;if(e===d&&(t.dropDowns=e),e){if(r=e.slice(),o)for(r=[],i=0;i<e.length;i++)r.push(h(e[i]));t.dropDowns=r}}(u,o.dropDowns,!e),u},t.prototype.Zo=function(t){var e,o,n,r,i,s,l,u,c=this;if(t&&t.getColor){if(E(t,c.foreColor,(function(t){c.foreColor=t})),"string"==typeof(e=c.backColor))E(t,e,(function(t){c.backColor=t}));else if(e&&(e.backgroundColor&&E(t,e.backgroundColor,(function(t){e.backgroundColor=t})),e.patternColor&&E(t,e.patternColor,(function(t){e.patternColor=t})),e.stops))for(o=function(o){E(t,e.stops[o].color,(function(t){e.stops[o].color=t}))},n=0;n<e.stops.length;n++)o(n);for(i=function(e,o){var n=r[e];n&&n.color&&E(t,n.color,(function(t){n.color=t}))},n=0,s=(r=[c.borderLeft,c.borderTop,c.borderRight,c.borderBottom,c.diagonalDown,c.diagonalUp]).length;n<s;n++)i(n)}return l=c.themeFont,u=c.font,t&&t.getFont&&(l?c.font=a.To.Io(u,t.getFont(l)):u||(c.font=a.To.Io(u,t.bodyFont()))),c},t.prototype.$o=function(t){var e,o=this._autoFormatter;o&&t!==d&&((e=o.getPreferredEditingFormatter(t)).isAuto=!0,this._autoFormatter=e)},t.prototype.toJSON=function(t,e){var o,n,i={},a=this._autoFormatter;for(!f(a)||e&&j(g,a,t)||(a.toJSON&&(a=a.toJSON()),r.GC$.isEmptyObject(a)||(i[g]=a)),o=0;o<I.length;o++)a=this[n=I[o]],n!==b||r.GC$.isEmptyObject(a)?n!==T&&n!==w||r.GC$.isEmptyObject(a)?!f(a)||e&&j(n,a,t)||(i[n]=a&&a.toJSON?a.toJSON():a):i[n]=a:i[b]=a;return r.GC$.isEmptyObject(i)?p:i},t.prototype.fromJSON=function(e,o,n){var r,i,a,s,l;if(e)for(i in r=this,e)if(e.hasOwnProperty(i)){if(a=e[i],!f(a))continue;(s={p:i,v:a,r:!1}).noSchema=o,s.context=n,t.ao(r,"fromJson",s),s.r||("formatter"===i?D(r,a,!0):"autoFormatter"===i?F(r,a,!0):i===m?O(r,a,!0,o):S[i]?a===d?r[i]=null:((l=new A).fromJSON(a,o),r[i]=l):r[i]=a)}},t.prototype.lJc=function(t){var e=this;e.backColor=function(t){return t&&t.type?{type:t.type&&l.PatternType[t.type]||p,patternColor:t.patternColor,backgroundColor:t.backgroundColor}:t}(t.backColor),e.foreColor=t.foreColor,e.hAlign=t.hAlign&&l.HorizontalAlign[t.hAlign]||p,e.vAlign=t.vAlign&&l.VerticalAlign[t.vAlign]||p,e.font=t.font,e.themeFont=t.themeFont,e.formatter=t.formatter,e.borderLeft=k(t.borderLeft),e.borderTop=k(t.borderTop),e.borderRight=k(t.borderRight),e.borderBottom=k(t.borderBottom),e.diagonalDown=k(t.diagonalDown),e.diagonalUp=k(t.diagonalUp),e.locked=t.locked,e.textIndent=t.textIndent,e.wordWrap=t.wordWrap,e.shrinkToFit=t.shrinkToFit,e.backgroundImage=t.backgroundImage,e.cellType=function(t){var e,o,n;return t&&(e={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12"}[t.type])&&(o=s._o[e])?((n=new o).lJc(t),n):p}(t.cellType),e.backgroundImageLayout=t.backgroundImageLayout&&l.ImageLayout[t.backgroundImageLayout]||p,e.tabStop=t.tabStop,e.textDecoration=t.textDecoration&&l.TextDecorationType[t.textDecoration]||p,e.imeMode=t.imeMode&&l.ImeMode[t.imeMode]||p,e.name=t.name,e.parentName=t.parentName,e.watermark=t.watermark,e.cellPadding=t.cellPadding,e.labelOptions=function(t){return t?{alignment:t.alignment&&l.LabelAlignment[t.alignment]||p,visibility:t.visibility&&l.LabelVisibility[t.visibility]||p,font:t.font,foreColor:t.foreColor,margin:t.margin}:p}(t.labelOptions),e.isVerticalText=t.isVerticalText,e.textOrientation=t.textOrientation,e.showEllipsis=t.showEllipsis,e.cellButtons=function(t){return t?t.map((function(t){return{position:t.position&&l.ButtonPosition[t.position]||p,useButtonStyle:t.useButtonStyle,enabled:t.enabled,width:t.width,caption:t.caption,imageSrc:t.imageSrc,imageSize:t.imageSize,captionAlign:t.captionAlign&&l.CaptionAlignment[t.captionAlign]||p,command:t.command,imageType:t.imageType&&l.ButtonImageType[t.imageType]||p,visibility:t.visibility&&l.ButtonVisibility[t.visibility]||p,hoverBackColor:t.hoverBackColor,buttonBackColor:t.buttonBackColor}})):p}(t.cellButtons),e.dropDowns=function(t){return t?t.map((function(t){return{type:t.type&&l.DropDownType[t.type]||p,option:N(t.option),submitCommand:t.submitCommand}})):p}(t.dropDowns)},t}(),e.Style=R,i.Zn(R),R.Wo=0},"./dist/core/worksheet/stylehelper.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C;function v(t){return t=a(t=t||0,0),s(t,1)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/domUtil.js"),r=o("./dist/core/util/common.js"),i=document,a=Math.max,s=Math.min,l=void 0,u="#FFFFFF",c="#000000",f=Math.abs,h=Math.PI,p=Math.cos,d=Math.sin,g=Math.atan,m=Math.tan,e.Ho="11pt",y={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},C=function(){function t(){}return t.Io=function(e,o){return o?t.Jo(e,o):e},t.Ko=function(e){var o,n;return e?((o=t.Lo()).style.font=e,{fontFamily:(n=o.style).fontFamily,fontSize:n.fontSize,fontStyle:n.fontStyle,fontWeight:n.fontWeight}):{}},t.F4=function(t){var e,o,n,i,a,s;return r.Ul.Ml.safari?t.font:(e="",o="normal","400","11pt","Calibri",n=t.fontStyle,i=t.fontVariant,a=t.fontWeight,s=t.lineHeight,n&&n!==o&&(e=n),i&&i!==o&&(e+=(e?" ":"")+i),a&&a!==o&&"400"!==a&&(e+=(e?" ":"")+a),e+=(e?" ":"")+(t.fontSize||"11pt"),s&&s!==o&&(e+="/"+s),e+=" "+(t.fontFamily||"Calibri"))},t.Jo=function(o,r){var a,s,l,u,c;if(!o&&!r)return o;if(o){if(s=r?o+"+"+r:o,l=t.Mo[s])return l;a=t.Lo(),n.GC$(a).css("font",o)}else{if(s=r,l=t.Mo[s])return l;a=t.Lo(),n.GC$(a).css("fontSize",e.Ho)}return r&&n.GC$(a).css("fontFamily",r),u=a.currentStyle,(c=i.defaultView)&&c.getComputedStyle&&(u=c.getComputedStyle(a,"")),l=t.F4(u),t.Mo[s]=l,t.Mo[l]=l,l},t.No=function(e,o,n,r){var s,l,u,c,f,h,p,d,g,m=t.Oo[o];if(!r)if(m){if(s=m[e])return s}else m=t.Oo[o]={};return(l=t.Lo()).style.font=e,u=l.currentStyle,(c=i.defaultView)&&c.getComputedStyle&&(u=c.getComputedStyle(l,"")),h="px",-1!==(f=u.fontSize).indexOf(h)&&(p=a(1,parseFloat(f.replace(h,""))*o),n&&1===p&&(n.value=!0),f=p+h),-1!==(d=u.lineHeight).indexOf(h)&&(g=a(1,parseFloat(d.replace(h,""))*o),d=g+h),1===o?s={font:e,fontFamily:l.style.fontFamily,fontSize:p}:(l.style.fontSize=f,l.style.lineHeight=d,s={font:l.style.font,fontFamily:l.style.fontFamily,fontSize:p}),r||(m[e]=s),s},t.Lo=function(){var e,o,n;return t.Po?t.Po.style.cssText=t.Qo:(e="-10000px",(n=(o=r.Ul.Nl("span")).style).visibility="hidden",n.top=e,n.left=e,n.lineHeight="normal",n.position="absolute",n.fontWeight="normal",n.fontStretch="normal",n.fontVariant="normal",n.fontStyle="normal",i.body.insertBefore(o,null),t.Po=o,t.Qo=n.cssText),t.Po},t.no=function(){var e=t.Po;e&&(n.GC$(e).remove(),t.Po=l,t.Qo=l)},t.stringFontCatch={},t.Ro=function(e,o){var n,r=e+","+o,i=t.stringFontCatch,a=i[r];return a||((n=t.Lo()).style.font=e,o&&(n.style.fontWeight=o),a=i[r]=n.style.font),a},t.Mo={},t.Oo={},t.So=function(t){if(t<=0)return"none";var e="";return(1|t)===t&&(e+="underline "),(2|t)===t&&(e+="line-through "),(4|t)===t&&(e+="overline "),e.trim()},t.setFillStyle=function(e,o,n,r,i,a,s){"string"==typeof o?(e.fillStyle!==o&&(e.fillStyle=o),s()):"path"===o.type?t.setFillStyle_Path(e,o,n,r,i,a,s):o.stops?t.setFillStyle_Gradient(e,o,n,r,i,a,s):o.type&&t.setFillStyle_patternFill(e,o,n,r,i,a,s)},t.setFillStyle_patternFill=function(t,e,o,n,r,i,a){var s,l,f,h,p=y[e.type],d=p.length,g=p[0].length,m=document.createElement("canvas");for(m.width=g,m.height=d,(s=m.getContext("2d")).fillStyle=e.backgroundColor||u,s.fillRect(0,0,g,d),s.fillStyle=e.patternColor||c,l=0;l<d;l++)for(f=0;f<g;f++)p[l][f]&&s.fillRect(f,l,1,1);t.createPattern(m,"repeat"),h=t.createPattern(m,"repeat"),t.fillStyle=h,a()},t.processStops=function(t){var e,o;if(t.stops||"path"===t.type){if(e=t.stops)if(0===e.length)e=[{position:0,color:c},{position:1,color:c}];else{for(e=e.filter((function(t,e,o){return t.position<=1&&t.position>=0})),e.sort((function(t,e){return t.position-e.position})),o=0;o<e.length;o++)e[o].color=e[o].color||c;0!==e[0].position&&e.splice(0,0,{position:0,color:c}),1!==e[e.length-1].position&&e.push({position:1,color:c})}else e=[{position:0,color:u},{position:1,color:u}];t.stops=e}"path"===t.type?(t.left=v(t.left),t.right=v(t.right),t.top=v(t.top),t.bottom=v(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},t.setFillStyle_Gradient=function(t,e,o,n,r,i,a){var s,l,c,y,C,v,b,w=e.degree||0;for(w%90==0?(l=w/180*h,c=f(w%180/180*h)-g(i/r)):(l=g(r/i*m(w/180*h)),c=f(l)-g(i/r),l=Math.round(w/180)*h+l),y=Math.sqrt(r*r+i*i)/2,s=t.createLinearGradient(o+r/2-y*p(c)*p(l),n+i/2-y*p(c)*d(l),o+r/2+y*p(c)*p(l),n+i/2+y*p(c)*d(l)),v=0,b=(C=e.stops).length;v<b;v++)s.addColorStop(C[v].position,C[v].color||u);t.fillStyle=s,a()},t.setFillStyle_Path=function(t,e,o,n,r,i,a){var s,l,c,f=e.left||0,h=e.right||0,p=e.top||0,d=e.bottom||0,g=e.stops;if(f>h&&(h=f),p>d&&(d=p),f>0){for(t.save(),t.beginPath(),s=t.createLinearGradient(o+r*f,0,o,0),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(o,n-1),t.lineTo(o+r*f+1,n+i*p),t.lineTo(o+r*f+1,n+i*d),t.lineTo(o,n+i+1),t.clip(),a(),t.restore()}if(h<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(o+r*h,0,o+r,0),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(o+r,n-1),t.lineTo(o+r,n+i+1),t.lineTo(o+r*h-1,n+i*d),t.lineTo(o+r*h-1,n+i*p),t.clip(),a(),t.restore()}if(p>0){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,n+i*p,0,n),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(o,n),t.lineTo(o+r,n),t.lineTo(o+r*h,n+i*p+1),t.lineTo(o+r*f,n+i*p+1),t.clip(),a(),t.restore()}if(d<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,n+i*d,0,n+i),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(o+r,n+i),t.lineTo(o,n+i),t.lineTo(o+r*f,n+i*d-1),t.lineTo(o+r*h,n+i*d-1),t.clip(),a(),t.restore()}f<h&&p<d&&(t.save(),t.beginPath(),t.fillStyle=g[0].color,t.rect(o+r*f,n+i*p,r*(h-f),i*(d-p)),t.clip(),a(),t.restore())},t}(),e.To=C},"./dist/core/worksheet/worksheet-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt,Yt,Kt,Qt,$t,te,ee,oe,ne,re,ie,ae=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function se(t,e){return t.getRowCount(e)}function le(t,e){return t.getColumnCount(e)}function ue(t){return t.rowCount}function ce(t){return t.colCount}function fe(t){var e=t.parent;return e&&e.options.allowExtendPasteRange}function he(t){var e=t.parent;return e&&e.options.allowCopyPasteExcelStyle}function pe(t){var e=t.parent;return e&&e.options.copyPasteHeaderOptions}function de(t,e,o,n){throw Error(C.Kb(P().Exp_InvalidAndSpace,[t,e,o,n]))}function ge(t){t.suspendPaint()}function me(t){t.resumePaint()}function ye(t){t.suspendEvent()}function Ce(t){t.resumeEvent()}function ve(t,e){t&&g&&t.suspendCalcService(e)}function be(t,e){t&&g&&t.resumeCalcService(e)}function we(t,e,o,n,r){var i=t.getSpan(e,o,n);if(i&&r&&(i.row!==e||i.col!==o))return!0}function Te(t){var e=this;e.Vw=1==(1&t),e.Ww=2==(2&t),e.Xw=8==(8&t),e.Yw=g&&16==(16&t),e.Zw=!0,e.$w=!0}function Se(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,y,C,b,w;if(m(t)||""===t)return M;for((m(e)||""===e)&&(e="\r\n"),"\n",(m(o)||""===o)&&(o="\t"),(m(n)||""===n)&&(n='"'),v(t,e)||(t+=e),a=!r,s=[],l=[],u="",f=!1,h=n.length,p=e.length,1,d=o.length,g=t.length,y=0;y<g;y++)c=(u+=t[y]).length,a&&c>=h&&n===u.substr(c-h,h)?f&&g>=y+1+h&&n===t.substr(y+1,h)?y+=h:f?(u=u.substr(0,c-h),f=!1):0===u.indexOf(n)&&(u=u.substr(0,c-h),f=!0):!f&&c>=d&&o===u.substr(c-d,d)?(u=u.substr(0,c-d),l.push(""+u),u=""):!f&&c>=p&&e===u.substr(c-p,p)?(u=u.substr(0,c-p),l.push(""+u),s.push(l),l=[],u=""):!f&&c>=1&&"\n"===u.substr(c-1,1)?(u=u.substr(0,c-1),l.push(""+u),s.push(l),l=[],u=""):f&&g>=y+1+d&&o===t.substr(y+1,d)&&","!==o&&(y+=h);if(f){if(l.length>0){for(C=void 0,C=0;C<s.length&&s[C]!==l;C++);C>=s.length&&s.push(l)}(b=""+u)&&(b=b.replace(RegExp(o,"g"),""),v(b,e)&&(b=b.substr(0,b.length-p)),0===s.length&&s.push([b]))}return 0===s.length&&(w=t,v(t,e)&&(w=w.substr(0,w.length-p)),s.push([w])),i&&function(t){var e,o;if(t){for(e=0;e<t.length&&((o=t[e])&&1===o.length);e++);if(e===t.length)return!0}return!1}(s)&&/^(\s)*$/.test(t)&&"\n"===t.substr(t.length-1,1)&&s.push([""]),s}function xe(t,e,o,n,r,i,a,s){var l,u,c=le(t,i);for(l=0,u=n;l<e.length;l++,u++)r>0&&u<c&&(s&&(u=t.Zq(u-1,3)),Ae(t,i,o,u,e[l],a))}function Ae(t,e,o,n,r,a){var s,u,c,f,h,p,d,g=r,y=M;if(!1===a.Xw&&(s={value:M},g=l.Ul.ul(M,r,!a.Xw,s),y=s.value),m(g))t.setValue(o,n,g,e);else if(""!==r)if(a.Yw&&"="===r[0]&&r.length>1)try{t.setFormula(o,n,r.substr(1))}catch(i){t.setText(o,n,r,e)}else u=t.tq(o,n,"formatter",e),!1===a.Xw&&y?u?u&&("string"==typeof u&&i.Formatter&&(u=new i.Formatter.GeneralFormatter(u)),d=u.parse&&u.parse(r),g=m(d)?g:d):(y.isAuto=!0,t.getCell(o,n,e)._w("_autoFormatter",y),c=r,f=t.getCellType(o,n,e),h=y.formatString(),f&&"7"===f.typeName&&(p={sheet:t,row:o,col:n,sheetArea:e},c=f.parse(r,h,p),g=m(c)?r:c)):u&&t.getCell(o,n,e).formatter(M),t.setValue(o,n,g,e);else t.setValue(o,n,M,e)}function Ie(t){var e,o,n=0;for(e=0;e<(t&&t.length);e++)o=t[e],n=N(o.length,n);return n}function Re(t,e,o,n,r,i,a,s,l,u){if(!t)throw Error(P().Exp_SheetIsNull);if((e<-1||e>=se(t))&&de("row",e,"-1",se(t)-1),(o<-1||o>=le(t))&&de("column",o,"-1",le(t)-1),!m(n)&&""!==n){-1===e&&(e=0),-1===o&&(o=0);var c=Se(n,r,i,a,l,u);c&&c.length>0&&function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p=n.length,d=Ie(n);if(0!==p&&0!==d)for(i=new Te(r),t&&(le(t,2)<=0&&(i.Vw=!1),se(t,1)<=0&&(i.Ww=!1)),l=0,(d-=a=i.Vw?le(t,2):0)<=0&&(d=0),(p-=s=i.Ww?se(t,1):0)<=0&&(l=0),(p-=l)<=0&&(p=0),i.Zw&&e+p>se(t)&&t.setRowCount(e+p),i.$w&&o+d>le(t)&&t.setColumnCount(o+d),u=0,c=0;u<n.length;u++,c++)f=n[u],h=t.KLc(),f.length<=0||(s>0&&u<s?xe(t,f,c,o,d,1,i):p>0&&c<se(t)&&(u===s&&(c=e),xe(t,f,c,0,a,2,i),f.splice(0,a),h&&(c=t._q(c-1,3)),xe(t,f,c,o,d,3,i,h)))}(t,e,o,c,s)}}function Me(t,e,o,n,r,i,a,s,l,u,c,f,h,p){var d,g,y,C,v,b,w,T,S,x,A,I;if(!t)throw Error(P().Exp_SheetIsNull);return d=se(t),g=le(t),(e<-1||e>=d)&&de("row",e,"-1",d-1),(o<-1||e+o>d)&&de("rowCount",o,"-1",d-e),(n<-1||n>=g)&&de("column",n,"-1",g-1),(r<-1||n+r>g)&&de("columnCount",r,"-1",g-n),y=-1,C=-1,v=!1,b=!1,-1===e&&-1===n&&-1===o&&-1===r?(e=0,n=0,y=se(t)-1,C=le(t)-1):(-1===e&&(e=0,2==(2&pe(t))&&(v=!0)),-1===n&&(n=0,1==(1&pe(t))&&(b=!0)),-1===o&&(o=se(t)-e),-1===r&&(r=le(t)-n),y=e+o-1,C=n+r-1),(m(i)||""===i)&&(i="\r\n"),(m(a)||""===a)&&(a="\t"),(m(s)||""===s)&&(s='"'),T=null,S=null,x=ke(t,e,y,n,C,3,u,c,i,a,s,w=RegExp(s,"g"),l,f,h,p),b&&(A=t.getColumnCount(2),T=ke(t,e,y,0,A-1,2,u,c,i,a,s,w,l,f,h,p)),v&&(I=t.getRowCount(1),S=ke(t,0,I-1,n,C,1,u,c,i,a,s,w,l,f,h,p)),function(t,e,o,n,r){var i,a,s=t,l=0,u=function(t,e){var o,n=[],r=t.length;for(o=0;o<r;o++)n.push(t[o].concat(e[o]));return n};return e&&(l=e[0].length,s=u(e,t)),o&&(i=o.length,a=null,l&&(a=ke(null,0,i-1,0,l-1,null,[],[],n,r,null,null,null,!1,!1),o=u(a,o)),s=o.concat(s)),function(t,e,o){var n,r,i="",a=t.length;for(n=0;n<a;n++){for(r=0;r<t[n].length;r++)0!==r&&(i+=o),i+=t[n][r];i+=e}return i}(s,n,r)}(x,T,S,i,a)}function ke(t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,g){var m,C,v,b,w=[],T=t&&he(t);for(m=e;m<=o;m++)if(!a||!y(a,m)){for(v=[],C=n;C<=r;C++)s&&y(s,C)||(b="",t&&!we(t,m,C,i,p)&&(b=t.getText(m,C,i),g&&T&&b&&(b=" "!==b[0]&&" "!==b[b.length-1]||"number"!=typeof t.getValue(m,C,i)?b.replace(/[\r\n]+/g,"\n"):b.trim())),b=Ne(b,p,T,f,c,d,h,u,l),v.push(b));w.push(v)}return w}function Ne(t,e,o,n,r,i,a,s,l){var u="";return m(t)||(u=t,e||(u=u.replace(n,r+r))),i&&!u&&(u=" "),e&&o?u=u.replace(/\n/g," "):(a||-1!==u.indexOf(r)||-1!==u.indexOf(s)||-1!==u.indexOf(l)||-1!==u.indexOf("\n"))&&(u=r+u+r),u}function Oe(t,e){var o=[];return e.forEach((function(e){var n=function(t,e){var o,n,r,i,a=t.row,s=t.col,u=t.row+t.rowCount,c=t.col+t.colCount,f=e.row,h=e.col,p=e.row+e.rowCount,d=e.col+e.colCount,g=N(a,f)<=O(u,p)&&N(s,h)<=O(c,d);return!!g&&(o=N(a,f),n=N(s,h),r=O(u,p)-o,i=O(c,d)-n,new l.Range(o,n,r,i))}(t,e);n&&o.push(n)})),o}function De(t,e){if(t.sheets){var o=l.uJc(t,e.sheetName);if(o)return o}return t}function Fe(t,e,o,n){var r=De(t,o),i=new e(r,o,n);return n?i.undo(r):i.execute(r)}function Ee(t){var e=t;return function(t,o){var n=De(t,o);return L.Ox(n,e)}}function je(t,e){var o=t,n=e;return function(t,e){var r=De(t,e);return L.Rx(r,o,n)}}function Pe(t,e){var o,n,r,i,a=t.parent;a&&(o=a.getSheetCount(),void 0,r=void 0,n=r=a.getActiveSheetIndex(),e?r<o-1&&r++:r>0&&r--,n!==r&&(i=a.getActiveSheet(),a.dq(r,1),a.SHb(i),a.repaint()))}function Le(t,e){t.Tx=!0,t.Hx?t.Ex(e):t.yx(e,!0),t.Tx=!1}function Ge(t,e){var o,n,r,i;return!!t.endEdit()&&((o=t.mm).Ux(),o.Vx(),l.Vl.Zl(M),n=!1,(r=t.parent)&&((i=e.call(r))&&i.focus?(i.focus(),n=!0):r.Uv()),{ignoreCancelDefault:!n})}function Be(t,e){var o=[];return"string"==typeof e?o.push(t.getSheetFromName(e)):Array.isArray(e)&&e.forEach((function(e){o.push(t.getSheetFromName(e))})),o}function _e(t,e){ge(t),e||ye(t)}function Ve(t,e){e||Ce(t),me(t)}function He(t,e){m(t.lq)&&(t.lq=e.lq,t.qq=e.qq)}function ze(t,e){"value"===e.propertyName&&t.xu(e.row,e.col,e.oldValue,e.newValue)}function Ue(t){var e=t.parent,o=e&&e.YJc;o&&o.repaint()}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("Common"),i=o("Common"),a=o("./dist/core/worksheet/style.js"),s=o("./dist/core/worksheet/worksheet.js"),l=o("./dist/core/util/common.js"),u=o("./dist/core/worksheet/clipboardhelper.js"),c=o("./dist/core/util/domUtil.js"),f=o("./dist/core/core.enum.js"),h=c.GC$,p=o("./dist/core/worksheet/worksheet-static.js"),d=o("@grapecity/js-calc"),g=!!d,m=r.Common.j.Fa,y=r.Common.k.Bb,C=r.Common.u,v=C.jb,b=l.Events.CellChanged,w=l.Events.ColumnWidthChanging,T=l.Events.ColumnWidthChanged,S=l.Events.RowHeightChanging,x=l.Events.RowHeightChanged,A=l.Ul.Ml,I=l.Ul.Ol,R=h.extend,h.inherit,M=null,k=void 0,N=Math.max,O=Math.min,D=Math.floor,F=Math.ceil,Number.MAX_VALUE,isNaN,function(t){t[t.value=1]="value",t[t.formula=2]="formula",t[t.comment=4]="comment",t[t.outline=8]="outline",t[t.sparkline=16]="sparkline",t[t.span=32]="span",t[t.style=64]="style",t[t.tag=128]="tag",t[t.bindingPath=256]="bindingPath",t[t.conditionalFormat=512]="conditionalFormat",t[t.hyperlink=1024]="hyperlink",t[t.all=2047]="all"}(E=e.CopyToOptions||(e.CopyToOptions={})),j=new r.Common.ResourceManager(n.SR),P=j.getResource.bind(j),R(s.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<le(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<se(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,e,o,n,r,i,a,s){var l=this;ge(l),ye(l),Re(l,t,e,o,n,r,'"',i,a,s),Ce(l),me(l)},getCsv:function(t,e,o,n,r,i){return Me(this,t,o,e,n,r,i,'"',!0)},copyTo:function(t,e,o,n,r,i,a){this.ax(t,e,o,n,r,i,a)},ax:function(t,e,o,n,r,i,a,s,l){var u=this;ge(u),ye(u),p.staticMembers.copyTo(u,t,e,u,o,n,r,i,a,s,0,l),Ce(u),me(u)},moveTo:function(t,e,o,n,r,i,a,s){var l=this;if(!(g&&a&E.formula)||l.Vq(t,e,r,i,!0)&&l.Vq(o,n,r,i,!0))try{ge(l),ye(l),p.staticMembers.moveTo(l,t,e,l,o,n,r,i,a,s)}finally{Ce(l),me(l)}},bx:function(t,e,o){var n,r,i,a,s,c,h,p=this,d=p.o5(t);if(d){n=p.J5(t),"\t","\r\n",'"',r=p.mm,i=Me(p,d.row,ue(d),d.col,ce(d),"\r\n","\t",'"',!1,n.rows,n.cols,!0),(a=p.tu()).PA=p,a.n5=t,a.G4=e,p.tu().UHb=!0,s=pe(p),c=u.S4.Q4(p,s,d.row,ue(d),d.col,ce(d),f.SheetArea.viewport,he(p),n.rows,n.cols,!1,!1,!1,!1),p.ex&&p.ex(),p.Sob&&p.Sob();try{if(h={sheet:p,sheetName:p.name(),copyData:{text:i,html:c},cancel:!1},p.Wq(l.Events.ClipboardChanging,h),h&&!1===h.cancel)return r&&!o&&r.gx(he(p)?c:i),p.Wq(l.Events.ClipboardChanged,{sheet:p,sheetName:p.name(),copyData:{text:i,html:c}}),setTimeout((function(){!r||o||p.Js||r.hx()}),100),{copyText:i,copyHtml:c};a.hZ()}catch(t){}}},ix:function(t,e,o,n,r,i,a,s,l,c){var f,h,p,d,g=P().Exp_PasteSourceCellsLocked;if(a.pastedInternal=!1,a.pastedRange=M,f=!i&&!l,!t&&f)return!1;if(p=h=this,d=h.J5(e),h.jx(t,h.o5(e),p,i,d.rows,d.cols,c)||f){if(a.pastedInternal=!0,r&&t.options.isProtected&&t.p5(e))return h.Os(1,g),!1;a.pastedRange=h.kx(t,e,p,o,n,r)}else a.pastedRange=h.lx(p,o,i,u.S4.gYc(l));return h.mx(t,e,o,n,r,a,s)},mx:function(t,e,o,n,r,i,a){var s,u,c,f,h,p,d,g,m,y,C,v,b,w,T=P().Exp_InvalidCopyPasteSize,S=P().Exp_PasteDestinationCellsLocked,x=P().Exp_PasteChangeMergeCell,A=P().Exp_ChangePartOfArray,I=this,R=I,M=i.pastedRange,O=R.KLc();if(!M)return I.Os(1,T),!1;if(!R.Y3(M.row,M.col,ue(M),ce(M),S,A,k,a))return!1;if(i.pastedInternal){if(1===(s=e.length)){if(u=e[0],r&&!t.Y3(u.row,u.col,ue(u),ce(u),S,A))return!1;if(t.qu(u.row,u.col,ue(u),ce(u)))return I.Os(1,x),!1;if(c=M.row<0?se(R):ue(M),f=M.col<0?le(R):ce(M),h=u.row<0?se(t):ue(u),p=u.col<0?le(t):ce(u),O&&(c=(c-=R.MLc(o.row,N(c,h),!0))<1?1:c,f=(f-=R.MLc(o.col,N(f,p)))<1?1:f),(c>h||f>p)&&!(2===n)){for(d=o.row,g=o.col,o.row<0&&h<se(R)&&(d=0),o.col<0&&p<le(R)&&(g=0),c%h==0&&1===f?(f=p,M=i.pastedRange=new l.Range(d,g,c,f)):1===c&&f%p==0?(c=h,M=i.pastedRange=new l.Range(d,g,c,f)):c%h==0&&f%p==0||(c=h,f=p,M=i.pastedRange=new l.Range(d,g,c,f)),m=D(c/h),y=D(f/p),C=0;C<m;C++)for(v=0;v<y;v++)if(!I.nx(u,M)&&R.qu(d<0?-1:d+C*h,g<0?-1:g+v*p,d<0?-1:h,g<0?-1:p))return I.Os(1,x),!1}else if(a===k&&!I.nx(u,M)&&R.qu(M.row,M.col,ue(M),ce(M)))return I.Os(1,x),!1}else if(s>1){for(b=0;b<s;b++)if(w=e[b],t.qu(w.row,w.col,ue(w),ce(w)))return I.Os(1,x),!1;if(R.qu(M.row,M.col,ue(M),ce(M)))return I.Os(1,x),!1}}else{if(R.qu(M.row,M.col,ue(M),ce(M)))return I.Os(1,x),!1;if(!R.l5(M.row,M.col,ue(M),ce(M)))return I.Os(1,T),!1}return!0},nx:function(t,e){if(t&&1===ue(t)&&1===ce(t)){var o=this.getSpan(e.row,e.col);if(o&&o.equals(e))return!0}return!1},jx:function(t,e,o,n,r,i,a){var s,l;if(t&&e&&o)try{return(l=(s=Me(t,e.row,ue(e),e.col,ce(e),"\r\n","\t",'"',!1,r,i,!0,A.safari,!0))===n)||(!(l=s===n+"\r\n")&&A.chrome&&(l=s===n+"\t\r\n"),l||!(A.safari||A.mozilla||a)&&he(o)||(l=s.replace(/\s/g,"")===n.replace(/\s/g,"")),l||(l=s.replace(/\s+$/,"")===n.replace(/\s+$/,""))),l}catch(t){return!1}return!1},kx:function(t,e,o,n,r,i){var a,s,u,c,f,h,p,d,g,m,y,C,v=e.length,b=o.KLc();if(1===v){if(s=(a=e[0]).row<0?0:a.row,u=a.col<0?0:a.col,c=a.row<0?se(t):ue(a),f=a.col<0?le(t):ce(a),h=n.row<0?0:n.row,p=n.col<0?0:n.col,d=n.row<0?se(o):ue(n),g=n.col<0?le(o):ce(n),m=void 0,y=void 0,b&&(d=(d-=m=o.MLc(h,N(d,c),!0))<1?1:d,g=(g-=y=o.MLc(p,N(g,f)))<1?1:g),i||1===d&&1===g)d=c,g=f;else if(!(2===r)&&(d%c==0&&1===g?g=f:1===d&&g%f==0?d=c:d%c==0&&g%f==0||(d=c,g=f),!this.pu(s,u,c,f,se(t),le(t))))return M;if(C=new l.Range(h,p,d,g),!i&&t.name()===o.name())if(C.contains(s,u,c,f)){if((s-h)%c!=0||(u-p)%f!=0)return M}else if(C.intersect(s,u,c,f)&&(d>c||g>f))return M;return b&&(d+=m,g+=y),o.l5(h,p,d,g)?(-1===n.row&&(h=-1,d=-1),-1===n.col&&(p=-1,g=-1),new l.Range(h,p,d,g)):M}return v>1?this.q5(e,n):M},q5:function(t,e){var o,n,r,i,a,s,u,c,f=this,h=f.KLc();if(t.length>1){if(o=t[0],n=t[1],r=o.rowCount,i=o.colCount,o.row===n.row&&r===n.rowCount)return a=0,s=r,t.forEach((function(t){a+=t.colCount})),h&&(s+=f.MLc(e.row,s,!0),a+=f.MLc(e.col,a)),l.kf(e.row,e.col,s,a);if(o.col===n.col&&i===n.colCount)return u=0,c=i,t.forEach((function(t){u+=t.rowCount})),h&&(u+=f.MLc(e.row,u,!0),c+=f.MLc(e.col,c)),l.kf(e.row,e.col,u,c)}return M},lx:function(t,e,o,n){var r,i,a=e.row<0?0:e.row,s=e.col<0?0:e.col,u=new l.Range(a,s,1,1),c=function(t,e,o,n,r){var i,a,s,l,u,c=M,f=Se(t,e,o,n,!0,r);if(f){for(i=f.length,a=Ie(f),s=[],l=0;l<i;l++)for(s[l]=[],u=0;u<a;u++)u<f[l].length?s[l][u]=f[l][u]:s[l][u]=M;c=s}return c}(o,"\r\n","\t",'"',n);return c&&(r=c.length,i=Ie(c),r>0&&i>0&&(t.KLc()&&(r+=t.MLc(a,r,!0),i+=t.MLc(s,i)),u=new l.Range(a,s,r,i))),u},ox:function(){var t=this.tu();t&&t.hZ()},HXc:function(t,e,o,n,r,i,a,s,u,c){var f,h,d,g,m,y,C,v,b,w,T,S,x=re.qx(u),A=n.row<0?se(o):ue(n),I=n.col<0?le(o):ce(n),R=e.row<0?se(t):ue(e),M=e.col<0?le(t):ce(e),k=n.row,N=n.col;for(n.row<0&&R<se(o)&&(k=0),n.col<0&&M<le(o)&&(N=0),f=D(A/R),h=D(I/M),d=0;d<f&&f&&h;d++)for(g=0;g<h;g++)p.staticMembers.copyTo(t,e.row,e.col,o,k+R*d,N+M*g,R,M,x,c,pe(t));for(w=-33&x,m=k+R*f,y=N,C=A-R*f,v=M,b=Oe(new l.Range(e.row,e.col,C,v),t.getSpans(e)),T=function(n){b.forEach((function(t){o.addSpan(m+t.row-e.row,y+M*n+t.col-e.col,t.rowCount,t.colCount)})),p.staticMembers.copyTo(t,e.row<0?0:e.row,e.col<0?0:e.col,o,m,y+M*n,C,v,w,c,pe(t))},g=0;g<h&&C&&v;g++)T(g);for(m=k,y=N+M*h,C=R,v=I-M*h,b=Oe(new l.Range(e.row,e.col,C,v),t.getSpans(e)),S=function(n){b.forEach((function(t){o.addSpan(m+R*n+t.row-e.row,y+t.col-e.col,t.rowCount,t.colCount)})),p.staticMembers.copyTo(t,e.row<0?0:e.row,e.col<0?0:e.col,o,m+R*n,y,C,v,w,c,pe(t))},d=0;d<f&&C&&v;d++)S(d);m=k+R*f,y=N+M*h,C=A-R*f,v=I-M*h,b=Oe(new l.Range(e.row,e.col,C,v),t.getSpans(e)),C&&v&&(b.forEach((function(t){o.addSpan(m+t.row-e.row,y+t.col-e.col,t.rowCount,t.colCount)})),p.staticMembers.copyTo(t,e.row<0?0:e.row,e.col<0?0:e.col,o,m,y,C,v,w,c,pe(t)))},px:function(t,e,o,n,i,a,s,c,f,h){var d,C,v,b,w,T,S,x,A,I,R,k,O,F,E,j,L,G,B,_,V,H,z,U;if(!t||o.name()!==t.name()||!o.parent||t.xUc||y(o.parent.sheets,t)){d=o.KLc(),x=re.qx(f),ve(t),ve(o);try{if(t&&e){if(0!=(2&x)&&i&&g&&(t.Ns(e.row,e.col,ue(e),ce(e))||o.Ns(n.row,n.col,ue(n),ce(n))))throw P().Exp_ChangePartOfArray;if(A=2===f,i)p.staticMembers.moveTo(t,e.row,e.col,o,n.row,n.col,ue(e),ce(e),x,!0),t.ox();else if(A)this.HXc(t,e,o,n,i,a,s,c,f,h);else if(I=n.row<0?se(o):ue(n),R=n.col<0?le(o):ce(n),b=e.row<0?se(t):ue(e),w=e.col<0?le(t):ce(e),d&&(I-=o.MLc(n.row,N(I,b),!0),R-=o.MLc(n.col,N(R,w)),I=I<1?1:I,R=R<1?1:R),I>b||R>w)for(C=n.row,v=n.col,n.row<0&&b<se(o)&&(C=0),n.col<0&&w<le(o)&&(v=0),I%b==0&&1===R?R=w:1===I&&R%w==0?I=b:I%b==0&&R%w==0||(I=b,R=w),k=D(I/b),O=D(R/w),F=b,E=w,j=void 0,L=void 0,G=void 0,B=void 0,T=0;T<k;T++){for(j=m(G)?C<0?-1:C+T*b:G,S=0;S<O;S++)L=m(B)?v<0?-1:v+S*w:B,b=C<0?-1:F,w=v<0?-1:E,d&&(b=C<0?-1:b+o.MLc(j,F,!0),w=v<0?-1:w+o.MLc(L,E)),p.staticMembers.copyTo(t,e.row,e.col,o,j,L,F,E,x,h,pe(t)),B=L+(w<0?0:w);G=j+(b<0?0:b),B=null}else p.staticMembers.copyTo(t,e.row,e.col,o,n.row,n.col,ue(e),ce(e),x,h,pe(t))}else{if(C=n.row,v=n.col,b=ue(n),w=ce(n),a)for(H=(V=(_=o.ITa).getSpans(l.kf(C,v,b,w))).length-1;H>=0;H--)_.do("removeSpan",V[H]);if(g&&(1&x)>0&&o.clearFormula(C,v,b,w,(function(t,e){return!t.Ps||!t.Ps(e)})),z=o.tu(),U=0===f||2===f,a&&""!==a)o.parent&&o.parent.options.allowAutoCreateHyperlink&&1===b&&1===w&&(r.Common.q.qb("^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$").test(a)||r.Common.q.qb("^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$").test(a))&&o.setHyperlink&&o.setHyperlink(C,v,{url:a,tooltip:a}),o.setCsv(C,v,a,"\r\n","\t",16,!0,u.S4.gYc(s));else if(z&&U&&c)z.lgc(c,o,C,v);else for(T=0;T<b;T++)for(S=0;S<w;S++)o.setValue(C+T,v+S,M);z&&U&&s&&z.R4(s,o,C,v)}}finally{be(t,!1),be(o,!1)}}else t.ox()},sx:function(t){if(!this.isEditing()){var e=this.getSelections();if(e&&1===e.length)return this.bx(e,!0,t)}return M},r5:function(t,e){var o,n,r,i,a,s,l;if(t&&(o=t.length)>1){for(n=void 0,n=0;n<o;n++)for(r=t[n],i=n+1;i<o;i++)if(a=t[i],r.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(s=t[0],l=void 0,n=1;n<o&&(l=t[n],s.row===l.row&&s.rowCount===l.rowCount);n++);if(n>=o)return e&&(e.inSameRow=!0),!0;for(n=1;n<o&&(l=t[n],s.col===l.col&&s.colCount===l.colCount);n++);if(n>=o)return e&&(e.inSameCol=!0),!0}return!1},o5:function(t){var e,o,n,r,i;if(t){if(1===(e=t.length))return t[0];if(e>1){if(o=t[0],n=t[e-1],r=void 0,i=void 0,o.row===n.row&&o.rowCount===n.rowCount){for(r=0;r<e;r++)(i=t[r]).col<o.col&&(o=i),i.col>n.col&&(n=i);return l.kf(o.row,o.col,o.rowCount,n.col+n.colCount-o.col)}if(o.col===n.col&&o.colCount===n.colCount){for(r=0;r<e;r++)(i=t[r]).row<o.row&&(o=i),i.row>n.row&&(n=i);return l.kf(o.row,o.col,n.row+n.rowCount-o.row,o.colCount)}}}return M},J5:function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p=[],d=[];if(t&&((e=t.length)>1&&(o=t[0],n=t[e-1],r=o.row===n.row&&o.rowCount===n.rowCount,i=o.col===n.col&&o.colCount===n.colCount,r||i)))for(t.sort(r?function(t,e){return t.col-e.col}:function(t,e){return t.row-e.row}),a=1;a<e;a++)for(s=t[a-1],l=t[a],u=r?s.col+s.colCount:s.row+s.rowCount,c=r?l.col:l.row,f=r?d:p,h=u;h<c;h++)f.push(h);return{rows:p,cols:d}},ux:function(t){var e,o,n,r,i,a,s=this;if(!s.isEditing()){if((e=s.getSelections())&&1===e.length){if(s.tu().UHb=!0,-1!==(o=e[0]).row&&s.Nu&&s.Nu()){for(n=[],r=-1,i=0;i<o.rowCount;i++)a=o.row+i,s.Ps(a)?-1!==r&&(n.push(l.kf(r,o.col,a-r,o.colCount)),r=-1):-1===r&&(r=a);-1!==r&&n.push(l.kf(r,o.col,o.row+o.rowCount-r,o.colCount)),e=n}return s.bx(e,!1,t)}if(s.r5(e))return s.bx(e,!1,t);s.Os(1,P().Exp_MultipleSelections)}return M},vx:function(t){var e,o,n,r,i,a,s,u=this,c=u.mm;u.isEditing()||(t&&(e=t.pasteText,o=t.pasteHtml,n=void 0===t.pasteOption?u.options.clipBoardOptions:t.pasteOption,r=t.shiftCells,i=u.getSelections()[0],a=t.isFromDesigner),c&&!e&&c.gx(""),(s=u.tu())&&(s.VHb=!1),setTimeout((function(){var t,f,h,p,d,g;u.Js||(t=e||"",f=o||"",c&&!e&&(s&&(d=s.wx(),g=s.PA,t=d.text,f=d.html,p=d.image,h=s.n5&&s.n5[0],g&&l.Ul.rXc(h,g.getRowCount(),g.getColumnCount())),c.hx()),(A.msie||A.edge||e||!t&&!f&&!s.VHb)&&u.J4(t,f,p,n,r,i,h,a),u.mm.Qq(),u.Wq(l.Events.PasteEnd))}),100))},J4:function(t,e,o,n,r,i,a,s){var u,c=this,f=c.tu();if(f&&(f.VHb=!0),!(u=c.xx(t,n,r,e,s))){if(!o)return;u={pasteOption:void 0===n?c.options.clipBoardOptions:n,pastedRanges:[l.kf(c.getActiveRowIndex(),c.getActiveColumnIndex(),1,1)],clipboardText:""}}r!==k&&(u.WHb=r),i&&(u.XHb=i),a&&(u.YHb=a),u.cmd="clipboardPaste",u.sheetName=c.name(),he(c)&&(u.clipboardHtml=e,u.clipboardImage=o),c.wu().execute(u)},xx:function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g=this,m=P().Exp_InvalidPastedArea,y=g.tu(),C=y.PA,v=y.n5,b=y.G4;if(b&&C&&v&&C.options.isProtected&&C.p5(v)&&(b=!1),i={pastedRange:M,pastedInternal:!1},a=[],(s=g.getSelections()).length>1)for(u=2===e,c=0;c<s.length;c++){if(l=s[c],!g.ix(C,v,l,e,b,t,i,k,n,r))return;if(l.containsRange(i.pastedRange)&&!l.equals(i.pastedRange)&&!u)return void g.Os(1,m);a.push(i.pastedRange)}else{if(l=s.length>0?s[0]:g.ITa.getSpan(g.Jl,g.Kl),!g.ix(C,v,l,e,b,t,i,o,n,r))return;a.push(i.pastedRange)}if((f=g.at)&&f.jx(i.pastedInternal),i.pastedInternal||(C=M,v=M,b=!1),h=void 0===e?g.options.clipBoardOptions:e,b&&(h=0),v&&1===v.length)for(p=0;p<a.length;p++)d=a[p],g.nx(v[0],d)&&(d.rowCount=1,d.colCount=1);return(!v||v.length>1)&&a.length>1?void g.Os(1,P().Exp_MultipleSelections):{fromSheet:C,fromRanges:v,isCutting:b,pasteOption:h,pastedRanges:a,clipboardText:t}},l5:function(t,e,o,n,r){var i=this,a=se(i),s=le(i);return fe(i)?-1<=t&&(r||t<a)&&-1<=e&&(r||e<s):i.pu(t,e,o,n,a,s)},p5:function(t){for(var e=0;e<t.length;e++)if(this.ou(t[e]))return!0;return!1},yx:function(t,e,o,n){var r,i,a,s=this;s.endEdit&&!s.endEdit()||(r={sheet:s,sheetName:s.name(),row:s.Jl,col:s.Kl,cancel:!1},s.Wq(l.Events.LeaveCell,r),!0!==r.cancel&&(i=s.Jl,a=s.Kl,m(o)&&(o=s.Jl),m(n)&&(n=s.Kl),3===t?s.zx(o,n,e):4===t?s.Rs(o,n,e):1===t?s.Ax(o,n,e):2===t?s.Bx(o,n,e):5===t?s.Cx():6===t&&s.Dx(),s.Ss(t,i,a)))},Ex:function(t){var e,o,n,r=this;r.endEdit()&&(e={sheet:r,sheetName:r.name(),row:r.Jl,col:r.Kl,cancel:!1},r.Wq(l.Events.LeaveCell,e),!0!==e.cancel&&(o=r.Jl,n=r.Kl,3===t?r.Fx(r.Jl,r.Kl):4===t&&r.Gx(r.Jl,r.Kl),r.Ss(t,o,n)))},Ss:function(t,e,o){var n,r,i,a,s,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S=this,x=S.mm,A=S.ITa.getSelections(),I=!1;S.Hx||(n=S.Tq(S.Ix()),(A.length>1||ue(n)>1||ce(n)>1)&&(I=!0),!I&&S.mJb&&S.mJb.mgc(n)&&(I=!0),S.Tr()),r=S.Jl,i=S.Kl,a=S.ITa.getSpan(r,i),S.Lr=ue(a),S.Mr=ce(a),S.Hx||(s=S.Jx(r,i),u=S.selectionPolicy(),c=S.selectionUnit(),(0===u||1===u)&&S.ITa.do("clearSelection"),1===c?(s.col=-1,s.colCount=-1):2===c&&(s.row=-1,s.rowCount=-1),S.Kx(s.row,s.col,ue(s),ce(s),!1),f=S.ITa.getSelections(),x.zu(A,f)&&(S.yu(A,f),S.Au(A))),S.Yq(r,i),e!==r&&((h=S.wq)&&h.Lx()),p=S.yl,I?(g=(d=S.am()).zr,m=d.Ar,y=d.width-g,C=d.height-m,p.Mx(g,m,y,C),p.repaint(new l.Rect(g,m,y,d.Cr)),p.repaint(new l.Rect(g,m,d.Br,C)),p.Pw(p.bm())):(b=ue(v=S.ITa.getSpan(e,o)),w=ce(v),p.im(new l.Range(r,i,S.Lr,S.Mr).union(new l.Range(e,o,b,w)))),T={sheet:S,sheetName:S.name(),row:r,col:i},S.Wq(l.Events.EnterCell,T),S.Wq(l.Events.FormulatextboxEnterCell,T),x.cs&&x.cs(r,i)},Nx:function(t,e){var o=this,n=o.getDataValidator&&o.getDataValidator(t,e),r={sheet:o,sheetName:o.name(),row:t,col:e,validator:n,validationResult:0};return o.Wq(l.Events.ValidationError,r),r.validationResult}}),L={},e.Commands=L,L.Ox=function(t,e){return!!t&&2!==t.Px&&(t.yx(e,!1),!0)},L.Qx=function(t,e,o,n){return!!t&&2!==t.Px&&(t.yx(e,!1,o,n),!0)},L.Rx=function(t,e,o){return!(!t||2===t.Px||t.endEdit&&!t.endEdit()||(t.Sx(e,o),0))},G="navigationLeft",B="navigationRight",_="navigationUp",V="navigationDown",H="navigationHome2",z="navigationEnd2",U="navigationTop",W="navigationBottom",q="navigationHome",J="navigationFirst",X="navigationEnd",Z="navigationLast",Y="moveToNextCell",K="moveToPreviousCell",Q="navigationPageUp",$="navigationPageDown",tt="navigationPreviousSheet",et="navigationNextSheet",ot="clear",nt="clearAndEditing",rt="commitInputNavigationDown",it="commitInputNavigationUp",at="cancelInput",st="commitArrayFormula",lt="selectionLeft",ut="selectionRight",ct="selectionUp",ft="selectionDown",ht="selectionHome",pt="selectionEnd",dt="selectionPageUp",gt="selectionPageDown",mt="selectionTop",yt="selectionBottom",Ct="selectionFirst",vt="selectionLast",bt="copy",wt="cut",Tt="paste",St="undo",xt="redo",At="resizeColumn",It="resizeRow",Rt="splitResizeRow",Mt="splitResizeColumn",kt="autoFitColumn",Nt="autoFitRow",Ot="editCell",Dt="renameSheet",Ft="zoom",Et="clearValues",jt="clipboardPaste",Pt="selectNextControl",Lt="selectPreviousControl",Gt="moveToNextCellThenControl",Bt="moveToPreviousCellThenControl",_t="changeFormulaReference",Vt="moveSheet",Ht="copySheet",L.bT=De,L.h4=Fe,L.uv=function(t){var e=l.Ul.sl(),o=!e,n=e;t.register(G,L[G],37,!1,!1,!1,!1),t.register(B,L[B],39,!1,!1,!1,!1),t.register(_,L[_],38,!1,!1,!1,!1),t.register(V,L[V],40,!1,!1,!1,!1),t.register(H,L[H],37,o,!1,!1,n),t.register(z,L[z],39,o,!1,!1,n),t.register(U,L[U],38,o,!1,!1,n),t.register(W,L[W],40,o,!1,!1,n),t.register(q,L[q],36,!1,!1,!1,!1),t.register(J,L[J],36,!0,!1,!1,!1),t.register(X,L[X],35,!1,!1,!1,!1),t.register(Z,L[Z],35,!0,!1,!1,!1),t.register(Y,L[Y],9,!1,!1,!1,!1),t.register(K,L[K],9,!1,!0,!1,!1),t.register(Q,L[Q],33,!1,!1,!1,!1),t.register($,L[$],34,!1,!1,!1,!1),t.register(tt,L[tt],33,o,!1,!1,n),t.register(et,L[et],34,o,!1,!1,n),t.register(ot,L[ot],46,!1,!1,!1,!1),t.register(nt,L[nt],8,!1,!1,!1,!1),t.register(rt,L[rt],13,!1,!1,!1,!1),t.register(it,L[it],13,!1,!0,!1,!1),t.register(at,L[at],27,!1,!1,!1,!1),t.register(st,L[st],13,!0,!0,!1,!1),t.register(lt,L[lt],37,!1,!0,!1,!1),t.register(ut,L[ut],39,!1,!0,!1,!1),t.register(ct,L[ct],38,!1,!0,!1,!1),t.register(ft,L[ft],40,!1,!0,!1,!1),t.register(ht,L[ht],36,!1,!0,!1,!1),t.register(pt,L[pt],35,!1,!0,!1,!1),t.register(dt,L[dt],33,!1,!0,!1,!1),t.register(gt,L[gt],34,!1,!0,!1,!1),t.register(ht,L[ht],37,o,!0,!1,n),t.register(pt,L[pt],39,o,!0,!1,n),t.register(mt,L[mt],38,o,!0,!1,n),t.register(yt,L[yt],40,o,!0,!1,n),t.register(Ct,L[Ct],36,!0,!0,!1,!1),t.register(vt,L[vt],35,!0,!0,!1,!1),t.register(bt,L[bt],67,o,!1,!1,n),t.register(wt,L[wt],88,o,!1,!1,n),t.register(Tt,L[Tt],86,o,!1,!1,n),t.register(St,L[St],90,o,!1,!1,n),t.register(xt,L[xt],89,o,!1,!1,n),e&&t.register(xt,L[xt],90,o,!0,!1,n),t.register(Pt,L[Pt]),t.register(Lt,L[Lt]),t.register(Gt,L[Gt]),t.register(Bt,L[Bt]),t.register(_t,L[_t]),t.register(At,L[At]),t.register(It,L[It]),t.register(Mt,L[Mt]),t.register(Rt,L[Rt]),t.register(kt,L[kt]),t.register(Nt,L[Nt]),t.register(Ot,L[Ot]),t.register(Dt,L[Dt]),t.register(Ft,L[Ft]),t.register(Et,L[Et]),t.register(jt,L[jt]),t.register(Vt,L[Vt]),t.register(Ht,L[Ht])},zt={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Ut=".cellEditAction",L[G]={canUndo:!1,execute:Ee(3)},L[B]={canUndo:!1,execute:Ee(4)},L[_]={canUndo:!1,execute:Ee(1)},L[V]={canUndo:!1,execute:Ee(2)},L[st]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=L.Wx;return n&&(o=n.fv(o)),o.fv&&o.fv(),!0}},L[rt]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=L.Wx;return n&&(o=n.Xx(o)),o.yx(2,!1),!0}},L[it]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=L.Wx;return n&&(o=n.Yx(o)),o.yx(1,!1),!0}},L[q]={canUndo:!1,execute:function(t,e){var o=De(t,e);return L.Qx(o,4,M,o.frozenColumnCount()-1)}},L[H]={canUndo:!1,execute:function(t,e){var o=De(t,e);return L.Qx(o,4,M,-1)}},L[X]={canUndo:!1,execute:function(t,e){var o=De(t,e);return L.Qx(o,3,M,le(o)-o.frozenTrailingColumnCount())}},L[z]={canUndo:!1,execute:function(t,e){var o=De(t,e);return L.Qx(o,3,M,le(o))}},L[U]={canUndo:!1,execute:function(t,e){var o=De(t,e);return L.Qx(o,2,-1,M)}},L[W]={canUndo:!1,execute:function(t,e){var o=De(t,e);return L.Qx(o,1,se(o),M)}},L[Q]={canUndo:!1,execute:function(t,e){var o,n,r,i,a,s=De(t,e);if(!s||2===s.Px)return!1;if((o=s.Ew())===M||o===s.lq)return!0;if(n=s.Gr(1,3),(r=s._q(s.Jl-n.length))<o&&(r=o),i=L.Wx){if((a=i.Zx(s,r,o)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,M),s.Qr=r,s.yx()),s.mq(o,0),!0)}},L[$]={canUndo:!1,execute:function(t,e){var o,n,r,i,a,s=De(t,e);if(!s||2===s.Px)return!1;if((o=s.$x())===M||o===s.lq)return!0;if(n=s.Gr(1,3),(r=s.gr(s.Jl+n.length))<o&&(r=o),i=L.Wx){if((a=i._x(s,r,o)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,M),s.Qr=r,s.yx()),s.mq(o,0),!0)}},L[et]={canUndo:!1,execute:function(t,e){Pe(De(t,e),!0)}},L[tt]={canUndo:!1,execute:function(t,e){Pe(De(t,e),!1)}},L[J]={canUndo:!1,execute:function(t,e){var o,n,r=De(t,e);if(!r||2===r.Px)return!1;if(o=L.Wx){if((n=o.ay(r)).r)return!0;r=n.sheet}return r.yx(5,!1,r.Jl,r.Kl),!0}},L[Z]={canUndo:!1,execute:function(t,e){var o,n,r=De(t,e);if(!r||2===r.Px)return!1;if(o=L.Wx){if((n=o.by(r)).r)return!0;r=n.sheet}return r.yx(6,!1,r.Jl,r.Kl),!0}},L[Pt]={canUndo:!1,execute:function(t,e){var o=De(t,e);return!!o.parent&&Ge(o,o.parent.nextControl)}},L[Lt]={canUndo:!1,execute:function(t,e){var o=De(t,e);return!!o.parent&&Ge(o,o.parent.previousControl)}},L[Y]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=L.Wx;return n&&(o=n.ey(o)),Le(o,4),!0}},L[K]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=L.Wx;return n&&(o=n.gy(o)),Le(o,3),!0}},L[Gt]={canUndo:!1,execute:function(t,e){var o,n=De(t,e),r=n.Qr,i=n.getActiveColumnIndex();return n.Tx=!0,o=n.hy(n.getActiveRowIndex(),i,!0,r),n.Tx=!1,!o||o.leadingCellRow<r||o.leadingCellRow===r&&i>o.col?L[Pt].execute(t,e):L[Y].execute(t,e)}},L[Bt]={canUndo:!1,execute:function(t,e){var o,n=De(t,e),r=n.Qr,i=n.getActiveColumnIndex();return n.Tx=!0,o=n.iy(n.getActiveRowIndex(),i,!0,r),n.Tx=!1,!o||o.leadingCellRow>r||o.leadingCellRow===r&&i<o.col?L[Lt].execute(t,e):L[K].execute(t,e)}},L[at]={canUndo:!1,execute:function(t,e){var o,n,r,i,a,s,l,u,c,f=De(t,e),h=L.Wx;return h&&(o=h.jy(f)),f.isEditing()?(n=f.Jl,r=f.Kl,i=f.getValue(n,r,3,1),s=(a=f.getCellType(n,r)).getEditorValue(f.BF,t),!!f.endEdit(!0)&&((u=(l=f.ITa)&&l.ZHb)&&u.getAnchorCell(n,r)||a.isEditingValueChanged(i,s,t)&&f.setValue(n,r,i,3,!0),!0)):m(o)?(L.Yxb(f.parent),f.uu=M,f.parent.uu.hZ(),(c=f).ex&&c.ex(),void(c.Sob&&c.Sob())):o}},L.Yxb=function(t){var e,o,n,r=t&&t.sheets;if(r)for(e=0,o=r.length;e<o;e++)(n=r[e])&&n.at&&n.at.ky()},L[ot]={canUndo:!1,execute:function(t,e){var o,n=De(t,e);return!n.isEditing()&&(o=n.getSelections(),n.wu().execute({cmd:Et,sheetName:n.name(),ranges:o}),!0)}},L[nt]={canUndo:!1,execute:function(t,e){var o=De(t,e);return!o.isEditing()&&(l.Ul.sl()?(L[ot].execute(t,e),!0):(o.HF=!0,o.startEdit(!0,""),o.HF=!1,!0))}},L[bt]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=e.copyData=o.ux(e.ignoreClipboard);return e.callback&&e.callback(),!n||k}},L[wt]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=e.cutData=o.sx(e.ignoreClipboard);return e.callback&&e.callback(),!n||k}},L[Tt]={canUndo:!1,execute:function(t,e){De(t,e).vx(e)}},L[lt]={canUndo:!1,execute:je(37)},L[ut]={canUndo:!1,execute:je(39)},L[ct]={canUndo:!1,execute:je(38)},L[ft]={canUndo:!1,execute:je(40)},L[ht]={canUndo:!1,execute:je(37,!0)},L[pt]={canUndo:!1,execute:je(39,!0)},L[dt]={canUndo:!1,execute:je(33)},L[gt]={canUndo:!1,execute:je(34)},L[mt]={canUndo:!1,execute:je(38,!0)},L[yt]={canUndo:!1,execute:je(40,!0)},L[Ct]={canUndo:!1,execute:je(36,!0)},L[vt]={canUndo:!1,execute:je(35,!0)},L[_t]={canUndo:!1,execute:function(t,e){var o=De(t,e),n=o&&o.mm;if(n){ge(o);try{n.ly&&n.ly()}finally{me(o)}}}},L[St]={canUndo:!1,execute:function(t){var e;t&&((e=t.undoManager())&&e.canUndo()&&e.undo())}},L[xt]={canUndo:!1,execute:function(t){var e;t&&((e=t.undoManager())&&e.canRedo()&&e.redo())}},L[At]={canUndo:!0,execute:function(t,e,o){return Fe(t,Jt,e,o)}},L[It]={canUndo:!0,execute:function(t,e,o){return Fe(t,Xt,e,o)}},L[Mt]={canUndo:!0,execute:function(t,e,o){return Fe(t,Zt,e,o)}},L[Rt]={canUndo:!0,execute:function(t,e,o){return Fe(t,Yt,e,o)}},L[kt]={canUndo:!0,execute:function(t,e,o){return Fe(t,Kt,e,o)}},L[Nt]={canUndo:!0,execute:function(t,e,o){return Fe(t,Qt,e,o)}},L[Ot]={canUndo:!0,execute:function(t,e,o){return Fe(t,$t,e,o)}},L[Dt]={canUndo:!0,execute:function(t,e,o){return Fe(t,te,e,o)}},L[Ft]={canUndo:!0,execute:function(t,e,o){return Fe(t,ee,e,o)}},L[Et]={canUndo:!0,execute:function(t,e,o){return Fe(t,ne,e,o)}},L[jt]={canUndo:!0,execute:function(t,e,o){return Fe(t,ie,e,o)}},L[Vt]={canUndo:!1,execute:function(t,e){var o,n=e.sheetName,r=e.targetIndex,i=t.getSheetIndex(n),a=t.WJc(),s=i,u=r,c={sheet:a,sheetName:a.name(),oldIndex:s,newIndex:u,cancel:!1};return t.Wq(l.Events.SheetMoving,c),!c.cancel&&(o=t.changeSheetIndex(n,r),t.Wq(l.Events.SheetMoved,{sheet:a,sheetName:a?a.name():M,oldIndex:s,newIndex:u}),o)}},L[Ht]={canUndo:!1,execute:function(t,e){var o,n=e.sheetName,r=e.targetIndex,i=e.newName,a=e.includeBindingSource,s=t.getSheetFromName(n);return t.Wq(l.Events.SheetChanging,{sheetName:i,propertyName:"insertSheet",cancel:!1,sheetIndex:r}),t.Wq(l.Events.ActiveSheetChanging,{oldSheet:s,newSheet:o,cancel:!1}),o=t.clone(n,r,i,a),!m(o)&&(t.Wq(l.Events.SheetChanged,{sheetName:o.name(),propertyName:"insertSheet",sheetIndex:r}),t.Wq(l.Events.ActiveSheetChanged,{oldSheet:s,newSheet:o}),!0)}},Wt=function(){function t(t,e,o){var n=this;n.kj=t,n.my=e,n.ny=o,n.oy=[],n.Iu=[],n.py()}return t.prototype.py=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,m,y,C,v,b,w,T,S,x,A,I,R=this,N=R.my,O=R.kj;if(O&&N){if(t=R.ny,e=N.row,o=N.col,n=ue(N),r=ce(N),i=R.oy,a=!1,-1===e&&(a=!0,e=0,n=se(O)),-1===o&&(a=!0,o=0,r=le(O)),l=[],(64&t)>0)for(c=0;c<r;c++)l[c]=O.Aj(-1,c)||M;for(f=0;f<n;f++)for(h=e+f,(64&t)>0&&(s=O.Aj(h,-1)||M),p=0;p<r;p++){if(d=void 0,m=o+p,g&&(2&t)>0&&O.getFormulaInformation&&(d=O.getFormulaInformation(h,m)).hasFormula)if(d.isArrayFormula){if((y=d.baseRange).row===h&&y.col===m)for(C=y.row,v=y.row+ue(y);C<v;C++)for(b=y.col,w=y.col+ce(y);b<w;b++)R.qy(i,C-e,b-o,d,2)}else R.qy(i,f,p,d.formula,2);!((1&t)>0)||d&&d.hasFormula||R.qy(i,f,p,O.getValue(h,m,3),1),(16&t)>0&&O.getSparkline&&(T=O.getSparkline(h,m),S=M,T&&(S=T.data()),T&&S&&R.qy(i,f,p,T,16)),(64&t)>0&&(x=void 0,a?x=O.getActualStyle(h,m,3):(u=O.Aj(h,m)||M,x=O.getCompositeStyle(h,m,3,u,s,l[p])),A=k,x&&x.toJSON&&(A=JSON.stringify(x.toJSON(3,!0))),R.qy(i,f,p,A,64)),I=O.ITa.Ky,(4&t)>0&&I&&R.qy(i,f,p,I.get(h,m),4),(128&t)>0&&R.qy(i,f,p,O.getTag(h,m,3),128),(256&t)>0&&R.qy(i,f,p,O.getBindingPath&&O.getBindingPath(h,m,3),256),(1024&t)>0&&R.qy(i,f,p,O.getHyperlink&&O.getHyperlink(f,p,3),1024)}}},t.prototype.sy=function(){return this.oy},t.prototype.qy=function(t,e,o,n,r){!m(n)&&t&&(t[e]===k&&(t[e]=[]),t[e][o]===k&&(t[e][o]={}),t[e][o][zt[r]]=n)},t.prototype.uy=function(t){var e,o,n,r,i,a,s,l;if(t)for(this,e=this.oy,o=0,n=t.length;o<n;o++)if(r=t[o])for(i=0,a=r.length;i<a;i++)(s=r[i])&&(e[o]||(e[o]=[]),(l=e[o][i])?this.vy(s,l)&&(e[o][i]=k):e[o][i]=s)},t.prototype.vy=function(t,e){var o,n,r,i=this.ny,a=[];for(256&i&&a.push(zt[256]),4&i&&a.push(zt[4]),2&i&&a.push(zt[2]),16&i&&a.push(zt[16]),64&i&&a.push(zt[64]),128&i&&a.push(zt[128]),1024&i&&a.push(zt[1024]),1&i&&a.push(zt[1]),o=0,n=a.length;o<n;o++)if(t[r=a[o]]!==e[r])return!1;return!0},t.prototype.wy=function(){var t,e,o,n,r,i=this,a=i.my.row,s=i.my.col,l=i.oy,u=i.Iu;if(u&&u.length>0)return u;for(u=[],a=-1===a?0:a,s=-1===s?0:s,t=0,e=l.length;t<e;t++)if(o=l[t])for(n=0,r=o.length;n<r;n++)o[n]&&u.push({row:t+a,col:n+s});return i.Iu=u,u},t}(),L.xy=Wt,L.Bu=function(t,e,o,n,r,i,a,s,l){t&&(e<0&&(e=0,n=se(t)),o<0&&(o=0,r=le(t)),t.Bu(e,o,n,r,i,a,k,k,s,l))},L.bWa=function(t){return"changes"+t},L.cWa=function(t){return t&&(0!==t.length||!h.isEmptyObject(t))},L.aWa=function(t){var e,o=t.sheetName;return"string"==typeof o?e=[o]:Array.isArray(o)&&(e=o),!!e&&e.every((function(e){var o=L.bWa(e),n=t[o];return n&&0===n.length&&h.isEmptyObject(n)}))},L.startTransaction=function(t,e){Be(t,e.sheetName).forEach((function(t){t.ITa.startTransaction()}))},L.endTransaction=function(t,e){Be(t,e.sheetName).forEach((function(t){var o=L.bWa(t.name());e[o]=t.ITa.endTransaction()}))},L.undoTransaction=function(t,e){Be(t,e.sheetName).forEach((function(t){var o=L.bWa(t.name());t.ITa.undo(e[o]),t.$p()}))},L.Zxb=function(t){t.forEach((function(t){t.ITa.startTransaction()}))},L.$xb=function(t,e){t.forEach((function(t){var o=L.bWa(t.name());e[o]=t.ITa.endTransaction()}))},L._xb=function(t,e){t.forEach((function(t){var o=L.bWa(t.name());t.ITa.undo(e[o])}))},qt=function(){function t(t,e){this.Lz=_e,this.Mz=Ve;this.kj=t,this.VQ=e}return t.prototype.execute=function(){},t.prototype.canExecute=function(){return!0},t.prototype.canUndo=function(){return!0},t.prototype.undo=function(){return!0},t}(),L.ActionBase=qt,Jt=function(t){function e(e,o){var n=t.call(this,e,o)||this;return He(o,e),n}return ae(e,t),e.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,f,p,d,g=this,m=!1;if(g.canExecute()&&(t=g.VQ,e=g.kj,o=t.columns,n=t.rowHeader,r=o&&o.length,e&&r>0)){if(i=g.Sz(o),a={sheet:e,sheetName:e.name(),colList:i,header:n,cancel:!1},e.Wq(w,a),a&&!0===a.cancel)return m;t.Tz=!0,e.ITa.startTransaction(),_e(e);try{for(2,3,s=le(e,n?2:3),e.qq=t.qq,l=t.size,u=0;u<r;u++)for(f=(c=o[u]).firstCol,p=c.lastCol,d=f;d<=p;d++)0<=d&&d<s&&(n&&e.getColumnResizable(d,2)&&l!==e.$r(d,2)?(e.setColumnWidth(d,l,2),m=!0):!n&&e.getColumnResizable(d,3)&&l!==e.$r(d,3)&&(e.setColumnWidth(d,l,3),m=!0))}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:i,header:t.rowHeader}),me(e),t[L.bWa(e.name())]=e.ITa.endTransaction()}e.qs()}return m},e.prototype.undo=function(){var t,e,o,n,r,i,a,s,l=this,u=!1;if(l.canUndo()&&(t=l.VQ,e=l.kj,o=t.columns,n=t.rowHeader,r=o&&o.length,e&&r>0)){if(i=l.Sz(o),a={sheet:e,sheetName:e.name(),colList:i,header:n,cancel:!1},e.Wq(w,a),a&&!0===a.cancel)return u;_e(e);try{s=L.bWa(e.name()),e.ITa.undo(t[s]),e.oq=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),u=!0}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:i,header:t.rowHeader}),me(e)}}return u},e.prototype.Sz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstCol,i=n.lastCol,a=r;a<=i;a++)s.push(a);return s},e.prototype.canUndo=function(){return this.VQ.Tz},e}(qt),Xt=function(t){function e(e,o){var n=t.call(this,e,o)||this;return He(o,e),n}return ae(e,t),e.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,f,p,d,g=this,m=!1;if(g.canExecute()&&(t=g.kj,n=(o=(e=g.VQ).rows)&&o.length,t&&n>0)){if(r=g.Vz(o),i={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.Wq(S,i),i&&!0===i.cancel)return m;e.Tz=!0,t.ITa.startTransaction(),_e(t);try{for(3,1,s=se(t,(a=e.columnHeader)?1:3),t.lq=e.lq,l=e.size,u=0;u<n;u++)for(f=(c=o[u]).firstRow,p=c.lastRow,d=f;d<=p;d++)0<=d&&d<s&&(a&&t.getRowResizable(d,1)&&l!==t.Yr(d,1)?(t.setRowHeight(d,l,1),m=!0):!a&&t.getRowResizable(d,3)&&l!==t.Yr(d,3)&&(t.setRowHeight(d,l,3),m=!0))}finally{Ce(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),me(t),e[L.bWa(t.name())]=t.ITa.endTransaction()}t.os()}return m},e.prototype.undo=function(){var t,e,o,n,r,i,a,s=this,l=!1;if(s.canUndo()&&(t=s.kj,n=(o=(e=s.VQ).rows)&&o.length,t&&n>0)){if(r=s.Vz(o),i={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.Wq(S,i),i&&!0===i.cancel)return l;_e(t);try{a=L.bWa(t.name()),t.ITa.undo(e[a]),t.jq=!0,t.showCell(t.getActiveRowIndex(),t.getActiveColumnIndex(),1,1),l=!0}finally{Ce(t),h[h.sd]({tc:t.parent}),t.Wq(x,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),me(t)}}return l},e.prototype.Vz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstRow,i=n.lastRow,a=r;a<=i;a++)s.push(a);return s},e.prototype.canUndo=function(){return this.VQ.Tz},e}(qt),Zt=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.kj=e,r.VQ=o,n}return ae(e,t),e.prototype.execute=function(){var t,e,o,n,r,i,a,s=this,l=!1,u=s.VQ,c=s.kj,f=u.columns,p=u.rowHeader,d=s.Sz(f);if(c&&f&&f.length>0){if(t={sheet:c,sheetName:c.Cj,colList:d,header:p,cancel:!1},c.Wq(w,t),t&&!0===t.cancel)return l;c.ITa.startTransaction(),s.Lz(c);try{e=F(u.size),o=p?2:3,n=f[0].firstCol,void 0,i=void 0,a=void 0,e!==(r=c.$r(n,o))&&(i=e-r,a=c.Zq(n,o),c.setColumnWidth(n,e,o),c.setColumnWidth(a,c.$r(a,o)-i,o)),l=!0}finally{Ce(c),h[h.sd]({tc:c.parent}),c.Wq(T,{sheet:c,sheetName:c.Cj,colList:d,header:u.rowHeader}),me(c),u[L.bWa(c.name())]=c.ITa.endTransaction()}}return l},e.prototype.undo=function(){var t,e=this.kj,o=this.VQ.columns,n=!1,r=this.VQ,i=this.VQ.rowHeader,a=this.Sz(o),s={sheet:e,sheetName:e.Cj,colList:a,header:i,cancel:!1};if(e.Wq(w,s),s&&!0===s.cancel)return n;_e(e);try{t=L.bWa(e.name()),e.ITa.undo(r[t]),n=!0}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.Cj,colList:a,header:r.rowHeader}),me(e)}return n},e.prototype.Sz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstCol,i=n.lastCol,a=r;a<=i;a++)s.push(a);return s},e}(qt),Yt=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.kj=e,r.VQ=o,n}return ae(e,t),e.prototype.execute=function(){var t,e,o,n,r,i,a,s=this,l=!1,u=s.VQ,c=s.kj,f=u.rows,p=u.columnHeader,d=s.Vz(f);if(c&&f&&f.length>0){if(t={sheet:c,sheetName:c.Cj,rowList:d,header:p,cancel:!1},c.Wq(S,t),t&&!0===t.cancel)return l;c.ITa.startTransaction(),s.Lz(c);try{e=F(u.size),o=p?1:3,n=f[0].firstRow,void 0,i=void 0,a=void 0,e!==(r=c.Yr(n,o))&&(i=e-r,a=c._q(n,o),c.setRowHeight(n,e,o),c.setRowHeight(a,c.Yr(a,o)-i,o)),l=!0}finally{Ce(c),h[h.sd]({tc:c.parent}),c.Wq(x,{sheet:c,sheetName:c.Cj,rowList:d,header:u.columnHeader}),me(c),u[L.bWa(c.name())]=c.ITa.endTransaction()}}return l},e.prototype.undo=function(){var t,e=this.kj,o=this.VQ.rows,n=!1,r=this.VQ,i=this.VQ.columnHeader,a=this.Vz(o),s={sheet:e,sheetName:e.Cj,rowList:a,header:i,cancel:!1};if(e.Wq(S,s),s&&!0===s.cancel)return n;_e(e);try{t=L.bWa(e.name()),e.ITa.undo(r[t]),n=!0}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(x,{sheet:e,sheetName:e.Cj,rowList:a,header:r.columnHeader}),me(e)}return n},e.prototype.Vz=function(t){var e,o,n,r,i,a,s=[];for(e=0,o=t.length;e<o;e++)for(r=(n=t[e]).firstRow,i=n.lastRow,a=r;a<=i;a++)s.push(a);return s},e}(qt),Kt=function(t){function e(e,o){var n=t.call(this,e,o)||this,r=n,i=e.parent;return r.Wz=o.rowHeader?2:3,I(o.autoFitType)||(o.autoFitType=i?i.options.autoFitType:0),n}return ae(e,t),e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.columns&&t.columns.length>0},e.prototype.execute=function(){var t,e,o,n,r,i,a,s,u,c,f,p,d,g,y=this,C=!1;if(y.canExecute()){if(t=y.VQ,e=y.kj,o=y.Wz,n=y.Sz(t.columns),r=2===o,i={sheet:e,sheetName:e.name(),colList:n,header:r,cancel:!1},e.Wq(w,i),i&&!0===i.cancel)return C;for(t.Tz=!0,s=(a=le(e,o))-1,u=0,c=void 0,f=0,p=t.columns.length;f<p;f++)s=s>(c=t.columns[f].col)?c:s,u=u<c?c:u;l.mn.qn(e,0,s,se(e)-1,u),e.ITa.startTransaction(),_e(e);try{for(d=void 0,f=0,p=t.columns.length;f<p;f++)0<=(g=t.columns[f].col)&&g<a&&e.getColumnResizable(g,o)&&((d=y.xl(g))===e.getColumnWidth(g,o)&&m(e.getColumnWidth(g,o,!0))||(e.setColumnWidth(g,d,o),C=!0))}finally{l.mn.Nm(),Ce(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:n,header:r}),me(e),t[L.bWa(e.name())]=e.ITa.endTransaction()}}return C},e.prototype.undo=function(){var t,e,o,n,r,i,a,s=this,l=!1;if(s.canUndo()){if(t=s.VQ,e=s.kj,o=s.Wz,n=s.Sz(t.columns),r=2===o,i={sheet:e,sheetName:e.name(),colList:n,header:r,cancel:!1},e.Wq(w,i),i&&!0===i.cancel)return l;_e(e);try{a=L.bWa(e.name()),e.ITa.undo(t[a]),l=!0}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:n,header:r}),me(e)}}return l},e.prototype.Sz=function(t){var e,o,n=[];for(e=0;e<t.length;e++)o=t[e],n.push(o.col);return n},e.prototype.xl=function(t){return l.Ul.xl(t,this.kj,this.Wz,this.VQ.autoFitType)},e.prototype.canUndo=function(){return this.VQ.Tz},e}(qt),Qt=function(t){function e(e,o){var n=t.call(this,e,o)||this,r=n,i=e.parent;return r.Wz=o.columnHeader?1:3,I(o.autoFitType)||(o.autoFitType=i?i.options.autoFitType:0),n}return ae(e,t),e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.rows&&t.rows.length>0},e.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c,f=this,p=!1;if(f.canExecute()){if(t=f.VQ,e=f.kj,o=f.Vz(t.rows),n=f.Wz,r=1===f.Wz,i={sheet:e,sheetName:e.name(),rowList:o,header:r,cancel:!1},e.Wq(S,i),i&&!0===i.cancel)return p;t.Tz=!0,e.ITa.startTransaction(),_e(e);try{for(a=se(e,n),s=void 0,l=0,u=t.rows.length;l<u;l++)0<=(c=t.rows[l].row)&&c<a&&e.getRowResizable(c,n)&&((s=f.Fl(c))===e.getRowHeight(c,n)&&m(e.getRowHeight(c,n,!0))||(e.setRowHeight(c,s,n),p=!0))}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(x,{sheet:e,sheetName:e.name(),rowList:o,header:r}),me(e),t[L.bWa(e.name())]=e.ITa.endTransaction()}}return p},e.prototype.undo=function(){var t,e,o,n,r,i,a=this,s=!1;if(a.canUndo()){if(t=a.VQ,e=a.kj,o=a.Vz(t.rows),n=1===a.Wz,r={sheet:e,sheetName:e.name(),rowList:o,header:n,cancel:!1},e.Wq(S,r),r&&!0===r.cancel)return s;_e(e);try{i=L.bWa(e.name()),e.ITa.undo(t[i]),s=!0}finally{Ce(e),h[h.sd]({tc:e.parent}),e.Wq(x,{sheet:e,sheetName:e.name(),rowList:o,header:n}),me(e)}}return s},e.prototype.Vz=function(t){var e,o,n,r=[];for(e=0,o=t.length;e<o;e++)n=t[e],r.push(n.row);return r},e.prototype.Fl=function(t){return l.Ul.Fl(t,this.kj,this.Wz,this.VQ.autoFitType)},e.prototype.canUndo=function(){return this.VQ.Tz},e}(qt),$t=function(t){function e(e,o){var n,r,i=t.call(this,e,o)||this;return g&&o.ranges&&1===o.endEditType&&(n=e.Tq(o.ranges[0]),o.ranges[0]=n,1===ue(n)&&1===ce(n)&&((r=e.Ms(n.row,n.col,1,1))&&r.ranges&&r.ranges.length>0&&(o.ranges=[r.ranges[0]]))),i}return ae(e,t),e.prototype.canExecute=function(){var t,e,o=this.kj,n=this.VQ,r=n.ranges,i=n.row,a=n.col;if(r){for(t=0;t<r.length;t++)if(e=r[t],!o.Y3(e.row,e.col,ue(e),ce(e)))return!1}else if(!o.Y3(i,a,1,1))return!1;return!0},e.prototype.yA=function(t){var e,o,n,r,i=this.VQ,a=i.ranges;if(a)for(e=0;e<a.length;e++)for(n=(o=a[e]).row;n<o.row+ue(o);n++)for(r=o.col;r<o.col+ce(o);r++)t(n,r);else t(i.row,i.col)},e.prototype.undo=function(){var t,e,o,n=this;if(n.canUndo()){t=n.kj,e=n.VQ,_e(t,!0);try{t.Fu(b+Ut,(function(e,o){ze(t,o)})),o=L.bWa(t.name()),t.ITa.undo(e[o])}catch(t){return!1}finally{t.Gu(b+Ut),Ve(t,!0)}return!0}return!1},e.prototype.execute=function(){var t,e,o=this,n=!1;if(o.canExecute()){(t=o.kj).ITa.startTransaction(),_e(t,!0);try{t.Fu(b+Ut,(function(e,o){ze(t,o)})),o.VQ.applyResult=o.AA(),n=!0}catch(t){n=!1}finally{t.Gu(b+Ut),e=L.bWa(t.name()),o.VQ[e]=t.ITa.endTransaction(),Ve(t,!0)}}return n},e.prototype.zA=function(t,e){return t+"_"+e},e.prototype.BA=function(t){var e,o,n,r,i,a=this,s=0,l=a.kj,u=a.VQ,c=u.row,f=u.col,h=u.newValue,p=!u.hasOwnProperty("autoFormat")||u.autoFormat;return g&&h&&h.length>0&&"="===h[0]?l.getDataValidator&&l.getDataValidator(c,f)&&(""!==(e=h.substring(1))&&e!==l.getFormula(c,f)&&((o=l.Cf())&&((n=o.parse(l.yj(),e,c>=0?c:0,f>=0?f:0,!0))&&(r=o.Hg(l.yj(),n,{row:c,col:f}),l.isValid&&!l.isValid(c,f,r)&&(s=l.Nx(c,f)))))):(i=a.CA(c,f,h,p,t),!l.isValid||l.isValid(c,f,i)||(s=l.Nx(c,f),l.mm.DA=!0)),s},e.prototype.AA=function(){var t,e,o,n,r,i,u,c,f,h,p,m,y,C,v=this,b=v.kj,w=v.VQ,T=w.newValue,S=w.ignoreValidate,x={tka:!1,uka:!1,_autoFormatter:k,quotePrefix:k},A=0;if(!0!==S&&(1===(A=v.BA(x))||2===A))return A;if(e=!w.hasOwnProperty("autoFormat")||w.autoFormat,o=(o=w.row)>=0?o:0,n=(n=w.col)>=0?n:0,g&&d&&d.Parser)if(u=b.Cf(),f=(c=b.parent)&&c.options.allowUserEditFormula,"@"!==b.getFormatter(o,n)&&f&&u&&T&&T.length>0&&"="===T[0])try{if(w.ranges&&1===w.endEditType)return i=w.ranges[0],b.setArrayFormula(i.row,i.col,ue(i),ce(i),T.substring(1)),A;r=u.parse(b.yj(),T.substring(1),o,n,!0)}catch(t){throw b.Os(0,"string"==typeof t?t:t.message),t}else w.ranges&&1===w.endEditType&&(i=w.ranges[0],b.getRange(i.row,i.col,ue(i),ce(i),3).clear(1));return r||(T&&"'"===T[0]?v.Uia(o,n,!0,x):v.Uia(o,n,k,x),t=v.CA(o,n,T,e,x)),v.yA((function(e,o){if(r)try{b._u(e,o,u.unparse(b.yj(),r,e,o),r),b.Wq(l.Events.UserFormulaEntered,{sheet:b,sheetName:b.name(),row:e,col:o,isCircularReference:b.ngc(e,o),formula:T.substring(1).toUpperCase()})}catch(t){throw b.Os(0,"string"==typeof t?t:t.message),t}else{try{b.hasFormula&&b.hasFormula(e,o)&&b.setFormula(e,o,M)}catch(t){throw b.Os(0,"string"==typeof t?t:t.message),t}try{b.uq(e,o,t,w.sheetArea),"string"!=typeof t&&null!==t||s.Worksheet.ao(b,"setHyperlinkWhenEditing",{url:t,row:e,col:o,sheetArea:w.sheetArea})}catch(t){b.setValue(e,o,T)}}})),p=x.uka,((h=x.tka)||p)&&(y="string"==typeof(m=b.Aj(o,n)),m&&!y||(C=new a.Style,y&&(C.parentName=m),m=C),h&&(m._autoFormatter=x._autoFormatter),p&&(m.quotePrefix=x.quotePrefix),b.setStyle(o,n,m)),A},e.prototype.canUndo=function(){return 0===this.VQ.applyResult},e.prototype.CA=function(t,e,o,n,r){var i,a,s,u=this.kj,c=this.VQ,f=c.ignoreFormatting,h=u.getActualStyle(t,e),p={};return i="string"!=typeof o||f?o:o&&"'"===o[0]?o.substring(1):l.Ul.ul(h,o,n,p,c.editingFormatter),r.quotePrefix?(r._autoFormatter=k,r.tka=!0):(a=p.value,n&&a&&(s=M,(i!==M&&"General"!==a.formatString()||!h._autoFormatter)&&(a.isAuto=!0,s=a),s&&(r.tka=!0,r._autoFormatter=s))),i},e.prototype.Uia=function(t,e,o,n){var r,i=this.kj.Aj(t,e),s="string"==typeof i;i&&!s||(r=new a.Style,s&&(r.parentName=i),i=r),i.quotePrefix!==o&&(n.uka=!0,n.quotePrefix=o)},e}(qt),te=function(t){function e(e,o){return t.call(this,e,o)||this}return ae(e,t),e.prototype.canUndo=function(){return!!this.VQ.FA},e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.name&&t.name!==t.FA},e.prototype.execute=function(){var t,e,o,n,r=this,i=r.kj,a=r.VQ,s=a.name,u=!1;return r.canExecute()&&(t=i.name(),o={sheet:i,oldValue:t,newValue:e=s,cancel:!1},i.Wq(l.Events.SheetNameChanging,o),!1===o.cancel&&(a.FA=t,i.ITa.startTransaction(),_e(i,!0),ve(i),i.cq(s),Ue(i),a[L.bWa(i.name())]=i.ITa.endTransaction(),u=!0,a.sheetName=s,be(i,!1),Ve(i,!0),n={sheet:i,oldValue:t,newValue:e},i.Wq(l.Events.SheetNameChanged,n))),u},e.prototype.undo=function(){var t,e,o,n,r,i,a,s=this;return!(!s.canUndo()||(t=s.kj,e=s.VQ,o=e.name,n=e.FA,r={sheet:t,oldValue:o,newValue:n,cancel:!1},t.Wq(l.Events.SheetNameChanging,r),!1!==r.cancel)||(_e(t,!0),ve(t),i=L.bWa(t.name()),t.ITa.undo(e[i]),Ue(t),e.sheetName=e.FA,be(t,!1),Ve(t,!0),a={sheet:t,oldValue:o,newValue:n},t.Wq(l.Events.SheetNameChanged,a),0))},e}(qt),ee=function(t){function e(e,o){return t.call(this,e,o)||this}return ae(e,t),e.prototype.canExecute=function(){var t=this;return t.kj&&t.kj.parent.options.allowUserZoom&&t.kj.zoom()!==t.VQ.zoomFactor},e.prototype.execute=function(){var t,e,o,n=this,r=n.VQ,i=!1;return n.canExecute()&&(e=(t=n.kj).ITa,o=r.zoomFactor,e.startTransaction(),i=function(t,e){return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),t.zoom(e),t.resumePaint(),0))}(t,o),e.ZVa(["zoomChanged",o,r.oldZoomFactor]),r[L.bWa(t.name())]=t.ITa.endTransaction()),i},e.prototype.undo=function(){var t,e=this.kj;if(this.canUndo())return!(!0===e.isEditing()&&!e.endEdit()||(e.suspendPaint(),t=L.bWa(e.name()),e.ITa.undo(this.VQ[t]),e.resumePaint(),0))},e}(qt),oe=function(t){function e(e,o){return t.call(this,e,o)||this}return ae(e,t),e.prototype.execute=function(){var t,e,o,n,r,i,a,s,l,u,c=this;c.canExecute()&&(t=c.kj,e=c.VQ.clearRange,o=t.tables&&t.tables.$Hb&&t.tables.$Hb(e.row,e.col,e.rowCount,e.colCount),t.isDirtySuspended()||(c.VQ.Iu=new Wt(t,t.Tq(e),3)),o&&o.length>0&&(c.VQ.tableNames=o),r=(n=t.Tq(e)).row,i=n.col,a=ue(n),(s=ce(n))>0&&a>0&&(t.ITa.startTransaction(),_e(t),t.vxb=!0,t.cg(r,i,a,s,3,1,!0),Ve(t),t.vxb=!1,l=L.bWa(t.name()),c.VQ[l]=t.ITa.endTransaction(),u=c.VQ.Iu,L.Bu(t,r,i,a,s,u?u.wy():[],2,o)))},e.prototype.canExecute=function(){var t=this.VQ.clearRange;return this.kj.Y3(t.row,t.col,ue(t),ce(t))},e.prototype.canUndo=function(){var t=L.bWa(this.kj.name()),e=this.VQ[t];return L.cWa(e)},e.prototype.undo=function(){var t,e,o,n=this,r=n.kj;if(n.canUndo()&&r&&(ce(t=r.Tq(n.VQ.clearRange))>0&&ue(t)>0)){_e(r);try{e=L.bWa(r.name()),r.ITa.undo(n.VQ[e])}finally{Ve(r)}return o=n.VQ.Iu,L.Bu(r,t.row,t.col,ue(t),ce(t),o?o.wy():[],2,n.VQ.tableNames,!0),!0}return!1},e}(qt),ne=function(t){function e(e,o,n){var r,i,a=t.call(this,e,o)||this;if(!n&&(o.MA=[],(r=o.ranges)&&r.length>0))for(i=0;i<r.length;i++)o.MA[i]=new oe(e,{clearRange:r[i]});return a}return ae(e,t),e.prototype.canExecute=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canExecute())return!1;return!0}return!1},e.prototype.execute=function(){var t,e,o,n=this;if(n.canExecute()&&(t=n.VQ.MA,e=n.kj,t)){for(_e(e,!0),o=0;o<t.length;o++)t[o].execute();return Ve(e,!0),!0}return!1},e.prototype.canUndo=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canUndo())return!1;return!0}return!1},e.prototype.undo=function(){var t,e,o,n,r=this,i=r.VQ.MA;if(r.canUndo()){for(t=r.kj,e=i.length-1;e>=0;e--)if(o=i[e],_e(t,!0),n=o.undo(),Ve(t,!0),!n)return!1;return!0}return!1},e}(qt),L.OA=ne,re=function(t){function e(e,o){return t.call(this,e,o)||this}return ae(e,t),e.qx=function(t){var e=0;return 0!==t&&1!==t||(e|=1),0!==t&&2!==t||(e|=64,e|=32,e|=512),0!==t&&3!==t||(e|=2),0!==t&&4!==t||(e|=1,e|=64,e|=32),0!==t&&5!==t||(e|=64,e|=32,e|=2),0===t&&(e|=32,e|=16,e|=256,e|=4,e|=512,e|=128,e|=1024),e},e.prototype.canExecute=function(){var t=this.VQ,e=t.pasteExtent,o=e.targetRange,n=e.sourceRange;return t.toSheet.Y3(o.row,o.col,ue(o),ce(o))&&(!e.isCutting||t.fromSheet.Y3(n.row,n.col,ue(n),ce(n)))},e.prototype.oUa=function(){var t=this,o=t.VQ.pasteExtent,n=t.VQ.io={},r=o.isCutting,i=e.qx(t.VQ.pasteOption),a=o.sourceRange,s=o.targetRange,l=t.VQ.fromSheet,u=t.VQ.toSheet;l&&a&&r&&!l.isDirtySuspended()&&(n.cA=new Wt(l,a,i)),u.isDirtySuspended()||(n.fA=new Wt(u,s,i))},e.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},e.prototype._Hb=function(t,e,o,n,r){var i,a,s,l,u,c,h,p,d,g,m,y,C,v=!1,b=e.row,w=e.col,T=e.rowCount,S=e.colCount,x=!1,A=!1,I=!1,R=!1,M=fe(r),k=!1,N=!1,O=r.KLc(),D=r.getRowCount(),F=r.getColumnCount(),E=T,j=S,L=0,G=0,B=0,_=0;if(O&&(E-=r.NLc(b,E,!0),j-=r.NLc(w,j)),t||E%o.rowCount!=0&&j%o.colCount!=0){if(n===f.InsertShiftCell.right){if(p=o.rowCount,d=void 0,i=b,s=o.rowCount,O&&(p+=d=r.MLc(b,p),s+=d),b!==o.row&&o.intersect(b,w,p,r.getColumnCount()-w))return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(w>o.col&&w<=o.col+o.colCount-1&&b>o.row&&b<=o.row+o.rowCount-1)return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(this.aIb(r,b,w,p,r.getColumnCount()-w))return r.Os(1,P().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:N=!0};if(b===o.row&&w<=o.col&&(O?(o.col+=o.colCount,o.col=r.Zq(o.col-1),G=r.MLc(o.col,o.colCount),o.colCount+=G):o.col=o.col+o.colCount,x=!0),a=r.getColumnCount()-o.colCount,l=o.colCount,O&&(_=r.MLc(w,o.colCount),a=F-(l=(g=o.colCount+_)+r.OLc(F-1,g)),x&&(o.col+=_)),(k=this.bIb(r,i,a,s,l))&&!M)return r.Os(1,P().Exp_InsertCopiedCutCellsNoRange),{returnFunc:N=!0}}else if(n===f.InsertShiftCell.down){if(m=o.colCount,y=void 0,a=w,l=o.colCount,O&&(m+=y=r.MLc(w,m),l+=y),w!==o.col&&o.intersect(b,w,r.getRowCount()-b,m))return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(b>o.row&&b<=o.row+o.rowCount-1&&w>o.col&&w<=o.col+o.colCount-1)return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(this.cIb(r,b,w,r.getRowCount()-b,m))return r.Os(1,P().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:N=!0};if(w===o.col&&b<=o.row&&(O?(o.row=o.row+o.rowCount,o.row=r._q(o.row-1),L=r.MLc(o.row,o.rowCount,!0),o.rowCount+=L):o.row=o.row+o.rowCount,A=!0),i=D-o.rowCount,s=o.rowCount,O&&(B=r.MLc(b,o.rowCount,!0),i=D-(s=(C=o.rowCount+B)+r.OLc(D-1,C,!0)),A&&(o.row+=B)),(k=this.bIb(r,i,a,s,l))&&!M)return r.Os(1,P().Exp_InsertCopiedCutCellsNoRange),{returnFunc:N=!0}}}else if(u=0,c=0,E%o.rowCount==0&&j%o.colCount!=0?(S=e.colCount=o.colCount,O&&(S+=u=r.MLc(w,S),e.colCount=S)):E%o.rowCount!=0&&j%o.colCount==0&&(T=e.rowCount=o.rowCount,O&&(T+=c=r.MLc(b,T,!0),e.rowCount=T)),v=!0,n===f.InsertShiftCell.right){if(h=!1,b<=o.row&&b+T>=o.row+o.rowCount&&(h=!0),w>o.col&&w<=o.col+o.colCount-1&&b>o.row&&b<=o.row+o.rowCount-1)return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(!h&&o.intersect(b,w,T,r.getColumnCount()-w))return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(this.aIb(r,b,w,T,r.getColumnCount()-w))return r.Os(1,P().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:N=!0};if(h&&w<=o.col&&(O?(o.col+=S,o.col=r.Zq(o.col-1),G=r.MLc(o.col,S),o.colCount+=G):o.col+=S,I=!0),i=b,s=T,a=r.getColumnCount()-S,l=S,O&&(a=F-(l=S+(_=r.OLc(F-1,S))+u)),(k=this.bIb(r,i,a,s,l))&&!M)return r.Os(1,P().Exp_InsertCopiedCutCellsNoRange),{returnFunc:N=!0}}else if(n===f.InsertShiftCell.down){if(h=!1,w<=o.col&&w+S>=o.col+o.colCount&&(h=!0),b>o.row&&b<=o.row+o.rowCount-1&&w>o.col&&w<=o.col+o.colCount-1)return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(!h&&o.intersect(b,w,r.getRowCount()-b,S))return r.Os(1,P().Exp_InsertCopiedCutCells),{returnFunc:N=!0};if(this.cIb(r,b,w,r.getRowCount()-b,S))return r.Os(1,P().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:N=!0};if(h&&b<=o.row&&(O?(o.row+=T,o.row=r._q(o.row-1),L=r.MLc(o.row,T,!0),o.rowCount+=L):o.row+=T,R=!0),i=r.getRowCount()-T,s=T,a=w,l=S,O&&(i=D-(s=T+(B=r.OLc(D-1,T,!0))+c)),(k=this.bIb(r,i,a,s,l))&&!M)return r.Os(1,P().Exp_InsertCopiedCutCellsNoRange),{returnFunc:N=!0}}return{changePasteDataRangeCol:x,changePasteDataRangeRow:A,changePasteDataRangeCols:I,changePasteDataRangeRows:R,moveRangeHaveValue:k,returnFunc:N,selectRange:v,changePasteDataRangeRowInvisibleCount:L,changePasteDataRangeColInvisibleCount:G,invisibleRowCountInAcRange:B,invisibleColCountInAcRange:_}},e.prototype.dIb=function(t,e,o,n,r,i,a,s,l){var u,c,h,p,d,g,m,y,C,v,b,w,T=!1,S=!1,x=o.KLc();if(t){if(e===f.InsertShiftCell.right)if(o.Vq(i,a+l,s,o.getColumnCount()-a-l,!0))if(a+l<o.getColumnCount()){if(x)if(u=s,c=l+o.OLc(o.getColumnCount()-1,l),i<0)o.moveTo(i,a,i,a+l,s,o.getColumnCount()-a-l,1023,!0);else for(h=i;h<i+u&&h<o.getRowCount();h++)0!==o.getRowHeight(h)&&o.moveTo(h,a,h,a+l,1,o.getColumnCount()-a-c,1023,!0);else o.moveTo(i,a,i,a+l,s,o.getColumnCount()-a-l,1023,!0);(d=(p=o.rowFilter())&&p.range)&&-1===i&&d.colCount>1&&a>d.col&&a<=d.col+d.colCount-1&&(d.colCount=d.colCount+r.colCount)}else a+l>o.getColumnCount()&&(T=!0,S=!0);else T=!0,S=!0;else if(e===f.InsertShiftCell.down)if(o.Vq(i+s,a,o.getRowCount()-i-s,l,!0))if(i+s<o.getRowCount())if(x)if(g=l,m=s+o.OLc(o.getRowCount()-1,s,!0),a<0)o.moveTo(i,a,i+s,a,o.getRowCount()-i-m,r.colCount,1023,!0);else for(y=a;y<a+g&&y<o.getColumnCount();y++)0!==o.getColumnWidth(y)&&o.moveTo(i,y,i+s,y,o.getRowCount()-i-m,1,1023,!0);else o.moveTo(i,a,i+s,a,o.getRowCount()-i-s,l,1023,!0);else i+s>o.getRowCount()&&(T=!0,S=!0);else T=!0,S=!0}else if(e===f.InsertShiftCell.right)if(o.Vq(i,a+r.colCount,r.rowCount,o.getColumnCount()-a-r.colCount,!0))if(a+r.colCount<o.getColumnCount()){if(x)if(C=r.rowCount,c=(v=r.colCount+o.MLc(a,r.colCount))+o.OLc(o.getColumnCount()-1,v),i<0)o.moveTo(i,a,i,a+v,r.rowCount,o.getColumnCount()-a-c,1023,!0);else for(h=i;h<i+C&&h<o.getRowCount();h++)0!==o.getRowHeight(h)?o.moveTo(h,a,h,a+v,1,o.getColumnCount()-a-c,1023,!0):C++;else o.moveTo(i,a,i,a+r.colCount,r.rowCount,o.getColumnCount()-a-r.colCount,1023,!0);(d=(p=o.rowFilter())&&p.range)&&-1===i&&d.colCount>1&&a>d.col&&a<=d.col+d.colCount-1&&(d.colCount=d.colCount+r.colCount)}else a+r.colCount>o.getColumnCount()&&(T=!0,S=!0);else T=!0,S=!0;else if(e===f.InsertShiftCell.down)if(o.Vq(i+r.rowCount,a,o.getRowCount()-i-r.rowCount,r.colCount,!0))if(i+r.rowCount<o.getRowCount())if(x)if(b=r.colCount,m=(w=r.rowCount+o.MLc(i,r.rowCount,!0))+o.OLc(o.getRowCount()-1,w,!0),a<0)o.moveTo(i,a,i+w,a,o.getRowCount()-i-m,r.colCount,1023,!0);else for(y=a;y<a+b&&y<o.getColumnCount();y++)0!==o.getColumnWidth(y)?o.moveTo(i,y,i+w,y,o.getRowCount()-i-m,1,1023,!0):b++;else o.moveTo(i,a,i+r.rowCount,a,o.getRowCount()-i-r.rowCount,r.colCount,1023,!0);else i+r.rowCount>o.getRowCount()&&(T=!0,S=!0);else T=!0,S=!0;return{raiseInvalidOperation:T,returnFunc:S}},e.prototype.ogc=function(t,e,o,n,r,i,a,s){var l=s.changePasteDataRangeRowInvisibleCount,u=s.changePasteDataRangeColInvisibleCount,c=s.invisibleRowCountInAcRange,f=s.invisibleColCountInAcRange,h=this.VQ.pasteExtent.targetRange;t&&(e.colCount-=u,e.col-=e.colCount,e.col-=f,h.colCount-=u),o&&(e.rowCount-=l,e.row-=e.rowCount,e.row-=c,h.rowCount-=l),n&&(e.colCount-=u,e.col-=i,e.col-=f,h.colCount-=u),r&&(e.rowCount-=l,e.row-=a,e.row-=c,h.rowCount-=l),s.changePasteDataRangeRowInvisibleCount=0,s.changePasteDataRangeColInvisibleCount=0,s.invisibleRowCountInAcRange=0,s.invisibleColCountInAcRange=0},e.prototype.PLc=function(t,e){var o=[].concat(e.parent.sheets);return t&&t.xUc&&o.push(t),e&&e!==t&&e.xUc&&o.push(e),o},e.prototype.execute=function(){var t,o,n,r,i,a,s,u,c,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,N,O,D,F,E,j,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt=this;if(rt.canExecute()){if(t=rt.VQ.fromSheet,o=rt.VQ.toSheet,n=rt.VQ.pasteExtent,r=rt.VQ.pasteOption,i=n.sourceRange,a=n.targetRange,s=n.isCutting,t&&i&&!t.pu(i.row,i.col,ue(i),ce(i),se(t),le(t)))return;if(!(o&&a&&o.l5(a.row,a.col,ue(a),ce(a),!0)))return;if(o.tables&&o.tables.zxb(t,i,o,a,s))return;if(o.pivotTables&&o.pivotTables.OOc(i,a,o))return;if(u=void 0,c=void 0,h=void 0,p=void 0,t&&(h=t.tu(),u=rt.WHb,p=(c=rt.YHb)&&new l.Range(c.row,c.col,c.rowCount,c.colCount)),d=void 0,g=void 0,m=void 0,y=void 0,C=void 0,rt.XHb&&(d=rt.XHb.row,g=rt.XHb.col,m=rt.XHb.rowCount,y=rt.XHb.colCount),v=!1,b=!1,w=!1,T=!1,S=fe(o),x=!1,A=0,I=0,R=0,M=0,u!==k&&c){if((N=this._Hb(s,rt.XHb,c,u,o)).returnFunc)return;v=N.changePasteDataRangeCol,b=N.changePasteDataRangeRow,A=N.changePasteDataRangeRowInvisibleCount,I=N.changePasteDataRangeColInvisibleCount,R=N.invisibleRowCountInAcRange,M=N.invisibleColCountInAcRange,w=N.changePasteDataRangeCols,T=N.changePasteDataRangeRows,x=N.moveRangeHaveValue,C=N.selectRange,m=rt.XHb.rowCount,y=rt.XHb.colCount,a.rowCount+=A,a.colCount+=I}rt.oUa(),O=rt.PLc(t,o),L.Zxb(O),ge(o),ye(o),o.vxb=!0,D=!1,t&&(ye(t),t.vxb=!0);try{if(S&&(F=-1,E=-1,-1!==a.row?F=a.row+ue(a):-1===i.row&&(F=se(t)),G=F-(j=se(o)),F>j&&rt.vTa(i,a)?u===f.InsertShiftCell.down&&x?o.addRows(j,G+(j-d)):o.addRows(j,G):x||d+a.rowCount!==se(o)||u!==f.InsertShiftCell.down?x&&u===f.InsertShiftCell.down&&o.addRows(j,G+(j-d)):o.addRows(j,G+(j-d)-p.rowCount),-1!==a.col?E=a.col+ce(a):-1===i.col&&(E=le(t)),E>le(o)&&rt.vTa(i,a)?u===f.InsertShiftCell.right&&x?o.setColumnCount(E+o.getColumnCount()-g):o.setColumnCount(E):x||g+a.colCount!==le(o)||u!==f.InsertShiftCell.right?x&&u===f.InsertShiftCell.right&&o.setColumnCount(E+o.getColumnCount()-g):o.setColumnCount(E+o.getColumnCount()-g-p.colCount)),D=(B=u!==k&&this.dIb(C,u,o,rt.XHb,p,d,g,m,y)).raiseInvalidOperation,B.returnFunc)return;i&&l.mn.qn(t,i.row,i.col,i.row+ue(i)-1,i.col+ce(i)-1);try{if(_=!1,t)for(V=i.row;V<i.row+i.rowCount&&!_;V++)for(H=i.col;H<i.col+i.colCount;H++)if(t.getValue(V,H)){_=!0;break}o.tables&&(_||n.clipboardText.replace(/[\r\n\t]/gi,""))&&o.tables.fIb(a,i)}catch(t){return o.Os(6,t.message),void o.resumePaint()}o.px(t,i,o,a,s,n.clipboardText,n.clipboardHtml,n.clipboardImage,r,!n.includeFilteredOutRow),s&&u!==k&&(z=i.row,U=i.col,W=i.rowCount,q=i.colCount,J=a.row,X=a.col,a.rowCount,a.colCount,u===f.InsertShiftCell.right&&i.row===a.row&&t.moveTo(z,U+q,J,U,W,o.getColumnCount()-U-q,1023,!0),u===f.InsertShiftCell.down&&i.col===a.col&&t.moveTo(z+W,U,z,X,o.getRowCount()-z-W,q,1023,!0))}finally{i&&l.mn.Nm(),Ce(o),o.vxb=!1,t&&(Ce(t),t.vxb=!1),me(o),L.$xb(O,rt.VQ),Z=rt.VQ.io,Y=e.qx(r),n.isCutting&&t&&(K=[],t.isDirtySuspended()||((Q=new Wt(t,i,Y)).uy(Z.cA.sy()),Z._z=Q,K=Q.wy()),L.Bu(t,i.row,i.col,ue(i),ce(i),K,3)),o&&($=[],o.isDirtySuspended()||((tt=new Wt(o,a,Y)).uy(Z.fA.sy()),Z.dA=tt,$=tt.wy()),et=o.tables&&o.tables.$Hb&&o.tables.$Hb(a.row,a.col,a.rowCount,a.colCount),ot=ue(a),nt=ce(a),L.Bu(o,a.row,a.col,ot,nt,$,3,et),rt.tableNamesObj={r:a.row,c:a.col,rc:ot,cc:nt,tableNames:et}),rt.pgc={changePasteDataRangeCol:v,changePasteDataRangeRow:b,changePasteDataRangeCols:w,changePasteDataRangeRows:T,acColCount:y,acRowCount:m,changePasteDataRangeRowInvisibleCount:A,changePasteDataRangeColInvisibleCount:I,invisibleRowCountInAcRange:R,invisibleColCountInAcRange:M},h&&delete h.UHb,D&&o.Os(1,P().Exp_InsertCopiedCutCellsNoRange)}}},e.prototype.aIb=function(t,e,o,n,r){var i,a,s,l=t.ITa.getSpans(),u=t.tables.l$;for(i=0;i<l.length;i++)if(!(e<=(a=l[i]).row&&o<=a.col&&e+n>=a.row+a.rowCount&&o+r>=a.col+a.colCount||a.row>e+n||a.row+a.rowCount-1<e||a.row>e+n-1||a.row+a.rowCount-1<e||a.col+a.colCount-1<o))return!0;for(i=0;i<u.length;i++)if(!(e<=(s=u[i]).cj&&o<=s.dj&&e+n>=s.cj+s.Xj&&o+r>=s.dj+s.OZ||s.cj>e+n||s.cj+s.Xj-1<e||s.cj>e+n-1||s.cj+s.Xj-1<e||s.dj+s.OZ-1<o))return!0;return!1},e.prototype.cIb=function(t,e,o,n,r){var i,a,s,l=t.ITa.getSpans(),u=t.tables.l$;for(i=0;i<l.length;i++)if(!(e<=(a=l[i]).row&&o<=a.col&&e+n>=a.row+a.rowCount&&o+r>=a.col+a.colCount||a.col>o+r||a.col+a.colCount-1<o||a.col>o+r-1||a.col+a.colCount-1<o||a.row+a.rowCount-1<e))return!0;for(i=0;i<u.length;i++)if(!(e<=(s=u[i]).cj&&o<=s.dj&&e+n>=s.cj+s.Xj&&o+r>=s.dj+s.OZ||s.dj>o+r||s.dj+s.OZ-1<o||s.dj>o+r-1||s.dj+s.OZ-1<o||s.cj+s.Xj-1<e))return!0;return!1},e.prototype.bIb=function(t,e,o,n,r){var i,a,s,l,u,c,f,h=t.ITa.getSpans(),p=t.tables.l$;for(i=e;i<e+n;i++)for(a=o;a<o+r;a++){if(s=t.getCell(i,a),!m(s.value())||s.backColor()||s.comment()||s.tag())return!0;for(l=0;l<h.length;l++)if(i>=(u=h[l]).row&&i<=u.row+u.rowCount-1&&a>=u.col&&a<=u.col+u.colCount-1)return!0;for(c=0;c<p.length;c++)if(i>=(f=p[c]).cj&&i<=f.cj+f.Xj-1&&a>=f.dj&&a<=f.dj+f.OZ-1)return!0}return!1},e.prototype.vTa=function(t,e){var o,n,r,i;return!t||(o=t.row,n=t.col,r=e.row,i=e.col,-1!==o&&-1!==n||-1===o&&-1!==n&&r<=0||-1===n&&-1!==o&&i<=0||-1===o&&-1===n&&r<=0&&i<=0)},e.prototype.undo=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x=this;if(x.canUndo()){if(t=x.VQ.fromSheet,e=x.VQ.toSheet,n=(o=x.VQ.pasteExtent).sourceRange,r=o.targetRange,!e||!r)return!1;if(x.pgc&&(i=x.pgc,this.ogc(i.changePasteDataRangeCol,n,i.changePasteDataRangeRow,i.changePasteDataRangeCols,i.changePasteDataRangeRows,i.acColCount,i.acRowCount,i)),!e.pu(r.row,r.col,ue(r),ce(r),se(e),le(e)))return!1;if(t&&n){if(!t.pu(n.row,n.col,ue(n),ce(n),se(t),le(t)))return!1;if(t&&t.name()===e.name()&&e.parent&&!t.xUc&&!y(e.parent.sheets,t))return!1}a=x.VQ.io,ge(e);try{s=r.row<0?0:r.row,l=r.col<0?0:r.col,u=r.row<0?se(e):ue(r),c=r.col<0?le(e):ce(r),f=x.PLc(t,e),L._xb(f,x.VQ),(p=(h=e.rowFilter())&&h.range)&&-1===r.row&&p.col<r.col&&p.col+p.colCount>=r.col+r.colCount&&(p.colCount=p.colCount-r.colCount),d=0,g=0,m=0,C=0,t&&n&&(d=n.row<0?0:n.row,g=n.col<0?0:n.col,m=n.row<0?se(t):ue(n),C=n.col<0?le(t):ce(n)),v=[],b=[],(w=x.tableNamesObj)&&(e&&w.r===s&&w.c===l&&w.rc===u&&w.cc===c&&(b=w.tableNames),t&&w.r===d&&w.c===g&&w.rc===m&&w.cc===C&&(v=w.tableNames)),e&&(T=a.dA,L.Bu(e,s,l,u,c,T?T.wy():[],3,v,!0)),t&&(S=a._z,L.Bu(t,d,g,m,C,S?S.wy():[],3,b,!0))}finally{me(e)}}return!0},e}(qt),ie=function(t){function e(e,o,n){var r,i,a,s,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=t.call(this,e,o)||this;if(!n){if(r=e,i=o.fromSheet,!r)throw Error(P().Exp_DestSheetIsNull);if(s=(a=o).pastedRanges,u=r.KLc(),s&&s.length>0)if(o.MA=[],f=(c=a.fromRanges||[a.fromRange]).length,h=a.isCutting,p=a.clipboardText,d=a.clipboardHtml,g=a.clipboardImage,m=a.pasteOption,y={},C=s[0],!h&&i&&i.r5(c,y)&&C.equals(i.q5(c,C))){for(b=y.inSameCol,(v=y.inSameRow)?c.sort((function(t,e){return t.col-e.col})):b&&c.sort((function(t,e){return t.row-e.row})),w=C.row,T=C.col,S=0;S<f;S++)A=(x=c[S]).rowCount,I=x.colCount,u&&(A+=e.MLc(w,A,!0),I+=e.MLc(T,I)),R={sourceRange:x,targetRange:l.kf(w,T,A,I),isCutting:h,clipboardText:p,clipboardHtml:d,clipboardImage:g,includeFilteredOutRow:!0},o.MA[S]=new re(e,{fromSheet:i,toSheet:r,pasteExtent:R,pasteOption:m}),v?T+=I:b&&(w+=A);o.s5=!0}else for(M=0;M<s.length;M++)k={sourceRange:c[0],targetRange:s[M],isCutting:h,clipboardText:p,clipboardHtml:d,clipboardImage:g},o.MA[M]=new re(e,{fromSheet:i,toSheet:r,pasteExtent:k,pasteOption:m})}return N}return ae(e,t),e.prototype.execute=function(){var t,e,o,n,r,i,a,s,u=this,c=u.VQ,f=c.MA,h=!1;if(u.canExecute()&&f){_e(e=(t=u.kj).parent.WJc(),!0);try{for(o=!1,n=0;n<f.length;n++)(r=f[n]).WHb=c.WHb,r.XHb=c.XHb,r.YHb=c.YHb,t?(i=r.VQ.pasteExtent,a={sheet:t,sheetName:t.name(),cellRange:r.VA(),pasteOption:r.VQ.pasteOption,pasteData:{text:i.clipboardText,html:i.clipboardHtml},shiftCells:c.WHb,cancel:!1},(s=i.clipboardImage)&&(a.pasteData.image=s),t.Wq(l.Events.ClipboardPasting,a),a.cancel||(h=r.execute(),delete a.cancel,o=!0,t.Wq(l.Events.ClipboardPasted,a))):h=r.execute();o&&u.WA()}finally{Ve(e,!0)}}return h},e.prototype.WA=function(){var t,e,o,n,r,i,a,s=this.VQ,l=s.MA,u=this.kj;if(u&&l){if(t=u.getSelections(),[],o=u.parent,u.Tr(),s.s5)n=s.pastedRanges[0],u.addSelection(n.row,n.col,ue(n),ce(n));else if(l.length>1)for(r=0;r<l.length;r++)i=l[r].VA(),u.addSelection(i.row,i.col,ue(i),ce(i));else l.length>0&&(a=l[0].VA(),u.addSelection(a.row,a.col,ue(a),ce(a)),a.contains(u.Jl,u.Kl)||u.Jr(a.row,a.col));e=u.getSelections(),u.yu(t,e)&&u.Au(t),o&&s.xC&&o.changeSelectionInCommandExecuting(s,null,null,e)}},e.prototype.canExecute=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canExecute())return!1;return!0}return!1},e.prototype.canUndo=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canUndo())return!1;return!0}return!1},e.prototype.undo=function(){var t,e,o,n,r=this,i=r.VQ.MA;if(r.canUndo()&&i){t=!0,_e(e=r.kj.parent.WJc(),!0);try{for(o=i.length-1;o>=0;o--)n=i[o],t=t&&n.undo()}finally{Ve(e,!0)}return t}return!1},e}(qt)},"./dist/core/worksheet/worksheet-border.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function A(t,e,o,n,r,s,l){switch(s!==i&&s!==a||(s=1),s){case 1:return new y(t,e,o,n,r,1,l);case 2:return new y(t,e,o,n,r,2,l);case 5:return new y(t,e,o,n,r,3,l);case 3:return new C(t,e,o,n,r,1,[3,1],l);case 9:return new C(t,e,o,n,r,1,[8,2,2,2],l);case 4:return new C(t,e,o,n,r,1,[2,2],l);case 11:return new C(t,e,o,n,r,1,[9,3,3,3,3,3],l);case 13:return new v(t,e,o,n,r,t!==o,[11,1,5,1],[10,2,4,2],l);case 10:return new C(t,e,o,n,r,2,[9,3,3,3],l);case 12:return new C(t,e,o,n,r,2,[9,3,3,3,3,3],l);case 8:return new C(t,e,o,n,r,2,[9,3],l);case 7:return new C(t,e,o,n,r,1,[1],l);case 6:return new w(t,e,o,n,r,l)}return a}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/worksheet/style.js"),r=o("./dist/core/util/domUtil.js"),i=void 0,a=null,s=Math.sqrt,l=Math.pow,u=Math.min,c=Math.abs,f=Math.tan,Math.floor,h=Math.PI,r.GC$.inherit,p=r.GC$.isEmptyObject,d={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},g={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},m=function(){function t(){}return t.prototype.mE=function(t){var e=this;0===t._orientation?(t.nE&&(e.oE+=t.nE),t.pE&&(e.qE+=t.pE)):(t.nE&&(e.rE+=t.nE),t.pE&&(e.sE+=t.pE))},t.prototype.jp=function(t){var e=this.tE||"#9eb6ce",o=this.uE,n=t.lineWidth,r=t.strokeStyle;n===o&&r===e||(n!==o&&(t.lineWidth=o),r!==e&&(t.strokeStyle=e)),this.hWa(t)},t.prototype.hWa=function(t){var e,o,n=this,r=n.qE===n.oE,i=n.sE===n.rE;r&&i||(r||i?(t.beginPath(),n.vE(t),t.stroke()):(t.save(),e=Math.min(n.qE,n.oE),o=Math.min(n.sE,n.rE),t.rect(e,o,Math.abs(n.oE-n.qE),Math.abs(n.rE-n.sE)),t.clip(),t.beginPath(),n.vE(t),t.stroke(),t.beginPath(),t.restore()))},t.prototype.vE=function(t){var e=this;t.moveTo(e.qE,e.sE),t.lineTo(e.oE,e.rE)},t}(),y=function(t){function e(e,o,n,r,i,a,s){var l,u=t.call(this)||this;return a%2||(e!==n?(o-=.5,r-=.5):(e-=.5,n-=.5)),(l=u).qE=e,l.sE=o,l.oE=n,l.rE=r,l.tE=i,l.uE=a,l.gIb=s,u}return x(e,t),e}(m),C=function(t){function e(e,o,n,r,i,a,s,l){var u,c=t.call(this)||this;return a%2||(e!==n?(o-=.5,r-=.5):(e-=.5,n-=.5)),(u=c).qE=e,u.sE=o,u.oE=n,u.rE=r,u.tE=i,u.uE=a,u.wE=s,u.gIb=l,c}return x(e,t),e.prototype.vE=function(t){var o=this;e.yl(t,o.qE,o.sE,o.oE,o.rE,o.wE)},e.yl=function(t,e,o,n,r,i){var a,c,f=s(l(n-e,2)+l(r-o,2)),h=(n-e)/f,p=(r-o)/f,d=0,g=0;for(i=i&&i.length?i:[4,4];d<f;)d+=a=u(i[g%i.length],f-d),(c=++g%2)&&t.moveTo(e,o),e+=a*h,o+=a*p,c&&t.lineTo(e,o)},e}(m),v=function(t){function e(e,o,n,r,i,a,s,l,u){var c,f=t.call(this)||this;return a?(e-=1,n-=1):(o-=1,r-=1),(c=f).qE=e,c.sE=o,c.oE=n,c.rE=r,c.tE=i,c.xE=a,c.uE=1,c.yE=s,c.zE=l,c.gIb=u,f}return x(e,t),e.prototype.vE=function(t){var e=this,o=e.xE?0:1,n=e.xE?1:0;C.yl(t,e.qE-o,e.sE-n,e.oE-o,e.rE-n,e.yE),C.yl(t,e.qE,e.sE,e.oE,e.rE,e.zE)},e}(m),b=function(t){function e(e,o,n,r,i,a,s){var l=t.call(this)||this,u=l;return u.qE=e,u.sE=o,u.oE=n,u.rE=r,u.tE=i,u.iWa=a,u.gIb=s,u.AE=new y(u.qE,u.sE,u.oE,u.rE,i,1,s),u.BE=null,l}return x(e,t),e.prototype.hWa=function(t){this.AE&&this.AE.hWa(t),this.BE&&this.BE.hWa(t)},e.prototype.mE=function(t){var e=this;e.BE?(t.pE&&e.AE&&e.AE.mE(t),t.nE&&e.BE.mE(t)):e.AE&&e.AE.mE(t)},e.prototype.jWa=function(t){var e,o,n,r,i,a,s,l,u=this;t&&t.severX&&t.severY?(e=t.severX||0,o=t.severY||0,e=u.iWa?e:-e,i=(n=parseInt(u.qE+(u.oE-u.qE)/2,10))-e,a=(r=parseInt(u.sE+(u.rE-u.sE)/2,10))-o,s=n+e,l=r+o,u.AE=new y(u.qE,u.sE,i,a,u.tE,1,u.gIb),u.BE=new y(s,l,u.oE,u.rE,u.tE,1,u.gIb)):(u.AE=new y(u.qE,u.sE,u.oE,u.rE,u.tE,1,u.gIb),u.BE=null)},e}(m),w=function(t){function e(e,o,n,r,i,a){var s=t.call(this)||this,l=s,u=0,c=0;return e===n&&(u=1),o===r&&(c=1),e!==n&&o!==r?a?(u=2,l.AE=new y(e-u,o,n-u,r,i,1,a),l.BE=new y(e+u,o,n+u,r,i,1,a)):(u=2,c=2,e>n?(l.AE=new b(e-u,o,n,r-c,i,!1,a),l.BE=new b(e,o+c,n+u,r,i,!1,a)):(l.AE=new b(e,o+c,n-u,r,i,!0,a),l.BE=new b(e+u,o,n,r-c,i,!0,a))):(l.AE=new y(e-u,o-c,n-u,r-c,i,1,a),l.BE=new y(e+u,o+c,n+u,r+c,i,1,a)),l.gIb=a,l.tE=i,l.uE=1,s}return x(e,t),e.prototype.hWa=function(t){this.AE.hWa(t),this.BE.hWa(t)},e.prototype.mE=function(t){var e=this;t.CE?1===t.CE?e.AE.mE(t):2===t.CE&&e.BE.mE(t):(e.AE.mE(t),e.BE.mE(t))},e.prototype.jWa=function(){var t={severX:1,severY:1},e=this.AE,o=this.BE;e.jWa(t),o.jWa(t)},e}(m),e.zF=A,T=function(){function t(){}return t.DE=function(e,o,n){var r,i;return e?o?0!==(i=(r=t.EE)[e.style]-r[o.style])||n?i:o.level-e.level:1:o?-1:0},t.FE=function(t){if(t){if(t.isGridLine)return 1;if(t.style)return n.LineBorder.Vo(t.style)}return 0},t.GE=function(t){return t&&6===t.style},t.HE=function(t){return t&&13===t.style},t.IE=function(e,o){return e?o?t.DE(e.style,o.style)>=0?e:o:e:o},t.JE=function(t,e){t&&t.line&&t.line.mE(e)},t.KE=function(e,o,n){return e===o?0:e?o?e.isGridLine?o.isGridLine?0:-1:o.isGridLine?1:t.DE(e.style,o.style,n):1:-1},t.LE=function(t){return t&&t.style&&6===t.style.style},t.ME=function(t,e,o,n){if(t.style&&6===t.style.style)return!0;var r=0;return r+=e&&e.style&&6===e.style.style?1:0,r+=o&&o.style&&6===o.style.style?1:0,(r+=n&&n.style&&6===n.style.style?1:0)<2},t.NE=function(t,e,o,n,r,i){var a={_orientation:i?1:0,pE:0,nE:0},s=this.KE(t,o),l=this.KE(t,n);s>=0&&l>=0?0===s&&0===l?-1!==r&&1===r&&(a.nE-=r):-1===r?a.pE-=r:1===r&&(a.nE-=2*r):l>=0?(a.CE=2,a.pE+=r):s>=0&&(a.CE=1,a.pE+=r),this.JE(t,a)},t.OE=function(e,o,n,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,C={_orientation:l?1:0,CE:u?2:1,pE:0,nE:0},v={_orientation:l?1:0,CE:u?1:2,pE:0,nE:0},b=1===a?r:i,w=1===s?n:o;this.LE(w)?0===(c=this.KE(e,b))?0===(f=this.KE(e,w))?1===s&&(v.nE-=s):f>0&&(-1===s?v.pE-=2*s:1===s&&(v.nE-=2*s)):c>0?0===(h=this.KE(e,w))?1===s&&(v.nE-=s):h>0&&(-1===s?v.pE-=2*s:1===s&&(v.nE-=2*s)):0===(p=this.KE(e,w))?-1===s?C.pE+=2*s:1===s&&(C.nE+=2*s):p>0&&(-1===s?C.pE-=3*s:1===s&&(C.nE-=3*s)):this.KE(e,b)>=0?-1===s?v.pE-=2*s:1===s&&(v.nE-=2*s):-1===s?C.pE+=2*s:1===s&&(C.nE+=2*s),d=1===(1===a?2:1)?r:i,g=!1,m=0,this.LE(d)&&this.KE(d,e)>0&&(g=!0,y=t.FE(d),this.KE(d,b)>0?y>0&&(m=1===s&&this.LE(n)?y>=2?2:1:-1===s&&this.LE(o)?y>=3?2:1:3===y?3:2):m=3===y?3:2),g||this.LE(w)||!(w&&!w.isGridLine||d&&!d.isGridLine)||(g=!0,m=-1===s?2:1),g&&(-1===s?(C.pE+=s*m,v.pE+=s*m):1===s&&(C.nE+=s*m,v.nE+=s*m)),(C.pE||C.nE)&&this.JE(e,C),(v.pE||v.nE)&&this.JE(e,v)},t.PE=function(t,e,o,n,r,i){if(this.KE(t,o)>=0&&this.KE(t,n)>=0){var a={_orientation:i?1:0,pE:0,nE:0};-1===r?(a.pE-=2*r,this.LE(t)&&this.KE(e,t)>0&&(a.pE-=1)):1===r&&(a.nE-=2*r,this.LE(t)&&this.KE(e,t)>0&&(a.nE+=1)),this.JE(t,a)}},t.QE=function(e,o,n,r,i,a){var s,l,u;this.LE(e)&&((s=this.IE(n,r))&&!s.isGridLine&&((l=t.FE(s))>0&&(u={_orientation:a?1:0,pE:0,nE:0},-1===i?u.pE+=l*i:u.nE+=l*i,(u.pE||u.nE)&&this.JE(e,u))))},t.RE=function(e,o,n,r,i,a,s){var l,u,c,f,h=t;(o||n||r)&&(c=h.IE(n,r),h.ME(e,o,n,r)?(u=h.KE(c,e,!0))>0?(l=h.FE(c),h.LE(e)&&(h.LE(n)||h.LE(r)||h.LE(o))||3===l&&h.JE(e,{_orientation:0,pE:1})):c&&u<0?(u=h.KE(e,o,!0))>0?3===(l=h.FE(c))||2===l?h.JE(e,{_orientation:0,pE:-2}):1===l&&h.JE(e,{_orientation:0,pE:-1}):0!==u&&h.KE(o,c,!0)>0&&(3===(l=h.FE(c))&&h.JE(e,{_orientation:0,pE:1})):0===u&&(!o||h.KE(e,o,!0)>0)&&(3===(l=h.FE(c))||2===l?h.JE(e,{_orientation:0,pE:-2}):1===l&&h.JE(e,{_orientation:0,pE:-1})):h.JE(e,{_orientation:0,pE:1})),(i||a||s)&&(f=h.IE(a,s),h.ME(e,i,a,s)?(u=h.KE(f,e,!0))>0?(l=h.FE(f),h.LE(e)&&(h.LE(a)||h.LE(s)||h.LE(i))||(3===l?h.JE(e,{_orientation:0,nE:-2}):2!==l&&1!==l||h.JE(e,{_orientation:0,nE:-1}))):u<=0&&((u=h.KE(e,i,!0))>0?3===(l=h.FE(f))&&h.JE(e,{_orientation:0,nE:1}):0!==u&&h.JE(e,{_orientation:0,nE:-1})):h.JE(e,{_orientation:0,nE:-2}))},t.SE=function(e,o,n,r,i,s,l){var u,c,f,h,p=t;(o||n||r)&&(f=p.IE(n,r),c=p.KE(f,e,!0),p.ME(e,o,n,r)?c>0?(u=p.FE(f),p.LE(e)&&(p.LE(n)||p.LE(r)||p.LE(o))||3===u&&p.JE(e,{_orientation:1,pE:1})):c<0?(c=p.KE(e,o,!0))>0?3===(u=p.FE(f))||2===u?p.JE(e,{_orientation:1,pE:-2}):1===u&&p.JE(e,{_orientation:1,pE:-1}):0!==c&&p.KE(o,f,!0)>0&&(3===(u=p.FE(f))&&p.JE(e,{_orientation:1,pE:1})):0===c&&p.KE(e,o,!0)>0&&(3===(u=p.FE(f))||2===u?p.JE(e,{_orientation:1,pE:-2}):1===u&&p.JE(e,{_orientation:1,pE:-1})):p.JE(e,{_orientation:1,pE:1})),(i||s||l)&&(h=p.IE(s,l),c=p.KE(e,h,!0),p.ME(e,i,s,l)?c<0?(u=p.FE(h),p.LE(e)&&(p.LE(s)||p.LE(l)||p.LE(i))||(3===u||2===u?p.JE(e,{_orientation:1,nE:-2}):1===u&&p.JE(e,{_orientation:1,nE:-1}))):h!==a&&c>=0&&((c=p.KE(e,i,!0))>0?3===(u=p.FE(h))&&p.JE(e,{_orientation:1,nE:1}):0!==c&&p.JE(e,{_orientation:1,nE:-1})):p.JE(e,{_orientation:1,nE:-2}))},t.TE=function(e,o,n,r,i,a,s,l){var u,c,f,h,p=t;l?this.SE(e,o,n,r,i,a,s):this.RE(e,o,n,r,i,a,s),u=p.LE(n),c=p.LE(r),f=p.LE(o),u&&c&&f?p.NE(e,o,n,r,-1,l):u&&!c?p.OE(e,o,i,n,r,1,-1,l,!0):!u&&c?p.OE(e,o,i,n,r,2,-1,l,!1):u&&c&&!f?p.PE(e,o,n,r,-1,l):f&&p.QE(e,o,n,r,-1,l),u=p.LE(a),c=p.LE(s),h=p.LE(i),u&&c&&h?p.NE(e,i,a,s,1,l):u&&!c?p.OE(e,o,i,a,s,1,1,l,!0):!u&&c?p.OE(e,o,i,a,s,2,1,l,!1):u&&c&&!h?p.PE(e,i,a,s,1,l):h&&p.QE(e,i,a,s,1,l)},t.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],t.kWa=function(t,e){return!(!t||!e||t.color!==e.color||t.level!==e.level||t.style!==e.style)},t}(),S=function(){function t(t,e,o,n){var r=this;r.UE=!1,r.VE=!1,r.kj=t,r.Wz=n,r.hIb=e,r.pJ=o}return t.prototype.YE=function(){var t,e,o,n,r,i,a,s,l,u,c=this;if(c.ZE=[],c.$E=[],c._E=[],c.aF=[],c.bF=[],c.cF={},c.dF={},c.eF={},c.fF={},c.lWa={},c.mWa={},c.C$a={},t=c.hIb,e=c.pJ,t&&t.length>0&&e&&e.length>0){for(o=c.$E,n=t.length,r=void 0,i=0;i<n;i++)(r=t[i]).height>0&&o.push(r.row);for(o.push(o[o.length-1]+1),a=c._E,s=e.length,l=void 0,u=0;u<s;u++)(l=e[u]).width>0&&a.push(l.col);a.push(a[a.length-1]+1)}c.UE=!0},t.prototype.gF=function(t,e,o,n,r,i,a,s){if(o){var l={cj:t,dj:e,hF:o.startColumn,iF:o.endColumn,Wqa:n,XHa:r,YHa:i,Vo:a,_v:s};this.aF.push(l)}},t.prototype.jF=function(t,e,o,n,r,i,a,s,l,u,c){var f,h,p,d,g,m,y,C,v,b,w=this;w.UE||w.YE(),s?w.ZE.push(s):(f=void 0,h=void 0,p=void 0,d=void 0,g=void 0,m=void 0,y=void 0,C=void 0,v=void 0,b=void 0,a&&(f=a.borderLeft,h=a.borderTop,p=a.borderRight,d=a.borderBottom,b=a.backColor,g=a.diagonalDown,m=a.diagonalUp,y=a.textOrientation,C=a.isVerticalText,v=a.textIndent),!b||f||p||h||d||w.bF.push({r:t,c:e,rc:1,cc:1}),w.kF(t,e,o,n,r,i,f,h,p,d,g,m,b,!1,!1,l,u,y,C,v&&0!==v,c))},t.prototype.kF=function(t,e,o,n,r,a,s,l,u,p,d,g,m,y,C,v,b,w,T,S,x){var A,I,R,M,k,N,O=this,D=!1,F=!1,E=!1,j=!1,P=w!==i&&w&&-90<=w&&w<=90,L=o;P&&(s||l||u||p)&&!T&&!S&&x&&(A=c(w*h/180),I=f(A),R=Math.floor(a/I),w>-90&&w<0&&(L=o-R),w>0&&w<90&&(L=o+R)),d&&!P&&O.lF(t,e,o-1,n-1,o+r,n+a,d,O.lWa),g&&!P&&O.lF(t,e,o+r,n-1,o-1,n+a,g,O.mWa),l&&a>0&&(D=O.lF(t,e,L,n-.5,L+r,n-.5,l,O.eF,P)),s&&r>0&&(F=O.lF(t,e,L-.5,n,o-.5,n+a,s,O.fF,P)),u&&r>0&&(j=O.lF(t,e+1,L+r-.5,n,o+r-.5,n+a,u,O.fF,P)),p&&a>0&&(E=O.lF(t+1,e,o,n+a-.5,o+r,n+a-.5,p,O.eF,P)),M=O.kj,m&&0!==M.ss.Sl(t)&&0!==M.ss._m(e)||(N=!j&&!C,((k=!E&&!y)||N||!D&&!y||!F&&!C)&&O.mF(t,e,o,n,r,a,k,N,v,b)),!D&&!m||P||O.nF(t-1,e,O.cF),(F||m)&&O.nF(t,e-1,O.dF),!m||s||u||l||p||(O.oF(t-1,e-1,O.dF,!1),O.oF(t-1,e-1,O.cF,!0))},t.prototype.lF=function(t,e,o,n,r,i,s,l,u){var c,f;return!!s&&((c=this.pF(t,e,l,!0))?(u||6!==c.style.style&&(6===s.style||T.DE(s,c.style)>0))&&(c.line=A(o,n,r,i,s.color,s.style,u),c.style=s):(f=A(o,n,r,i,s.color,s.style,u))&&((c=this.pF(t,e,l)).line=f,c.style=s),c&&c.line!==a)},t.prototype.mF=function(t,e,o,n,r,i,a,s,l,u){var c,f,h,p,d,g=this,m=3===g.Wz,y=g.kj.options.gridline;m&&y&&(c=y.color,y.showHorizontalGridline&&(a&&((f=g.pF(t,e,g.cF)).isGridLine=!0,f.line=A(o,n+i-.5,o+r,n+i-.5,c)),l&&((h=g.pF(-1,e,g.cF,!1,!0)).isGridLine=!0,h.line=A(o,n-.5,o+r,n-.5,c))),y.showVerticalGridline&&(s&&((p=g.pF(t,e,g.dF)).isGridLine=!0,p.line=A(o+r-.5,n,o+r-.5,n+i,c)),u&&((d=g.pF(t,-1,g.dF,!1,!0)).isGridLine=!0,d.line=A(o-.5,n,o-.5,n+i,c))))},t.prototype.oF=function(t,e,o,n){var r,i=this.pF(t,e,o,!0);i&&((r=i).line&&r.line.mE({_orientation:n?0:1,nE:-1}))},t.prototype.nF=function(t,e,o){var n;(t>=0&&e>=0||0===t&&-1===e||-1===t&&0===e)&&((n=o[t])&&(n[e]&&delete n[e]))},t.prototype.pF=function(t,e,o,n,r){var i,s;if(!r&&(-1===t||-1===e))return a;if(!(i=o[t])){if(n)return a;o[t]=i={}}if(!(s=i[e])){if(n)return a;i[e]=s={}}return s},t.prototype.qF=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,I,R,M=this,k=M.aF,N=k.length,O=M.fF,D=M.eF,F=M.dF,E=M.cF;for(t=0;t<N;t++)if(o=(e=k[t]).cj,n=e.dj,r=e.hF,i=e.Wqa,a=e.iF,void 0,s=e.XHa,l=e.Vo,u=e._v,c=s,f=void 0,h=i.textOrientation,p=i.borderTop,!(d=k[t-1])||d.cj!==o||d.hF!==r||d.iF!==a){for(g=r;g<a;g++)M.pF(o,g+1,O,!0)&&!h?M.nF(o,g+1,O):M.pF(o,g,F,!0)&&M.nF(o,g,F);if(m=M.pF(o,n,D,!0),h&&p&&!m)for(void 0,y=u/Math.tan(Math.abs(h*Math.PI/180)),h>-90&&h<0&&(c=s-y),h>0&&h<90&&(c=s+y),f=c+l,C=r;C<a+1;C++)if(b=(v=M.pF(o-1,C,E,!0))&&v.line)for(v.splitLines||(v.splitLines=[],v.splitLines.push(b)),w=0;w<v.splitLines.length;w++)if(S=(T=v.splitLines[w]).qE,x=T.oE,I=T.sE,R=T.rE,c>S&&f>x&&x>c)T.oE=c;else if(c<S&&f>x)M.nF(o-1,C,M.cF);else if(c<S&&f<x&&S<f)T.qE=f;else if(c>S&&f<x){v.splitLines.splice(w,1,A(S,I,c,I,T.color),A(f,R,x,R,T.color));break}}},t.prototype.rF=function(){var t,e,o=this.ZE,n=o.length;if(n>0)for(e=0;e<n;e++)t=o[e],this.sF(t)},t.prototype.D$a=function(){var t,e,o,n,r,i,a,s;if(this.C$a={},(e=(t=this.ZE).length)>0)for(n=0;n<e;n++)for(o=t[n],r=0;r<o.rowCount;r++)for(i=r+o.row,this.C$a[i]=this.C$a[i]||{},a=0;a<o.colCount;a++)s=a+o.col,this.C$a[i][s]=o},t.prototype.sF=function(t){var e,o,n,r,i,s,l,u,c,f,h,p,d,g,m,y,C=this,v=t.row,b=t.col,w=t.x,S=t.y,x=t.spanSizeInfo,A=x.styleList[0][0],I=A?A.backColor:a,R=w,M=S,k=null,N=!0,O=null,D=!0;if(1===t.rowCount){for(s=v,u=x.rowSizes[0],i=0;i<t.colCount;i++)f=0===i,p=i===t.colCount-1,l=b+i,c=x.colSizes[i],g=x.styleList[0][i],s===t.row&&l===t.col&&(k=(m=g)&&m.diagonalDown,O=m&&m.diagonalUp),g?(e=g.borderLeft,o=g.borderTop,n=g.borderRight,r=g.borderBottom,N&&(N=T.kWa(k,g.diagonalDown)),D&&(D=T.kWa(O,g.diagonalUp))):e=o=n=r=a,f?C.kF(s,l,R,M,c,u,e,o,a,r,a,a,I,!1,!0):p?C.kF(s,l,R,M,c,u,a,o,n,r,a,a,I,!1,!1):C.kF(s,l,R,M,c,u,a,o,a,r,a,a,I,!1,!0),R+=c;k=N?k:null,O=D?O:null,C.kF(t.row,t.col,t.x,t.y,t.width,t.height,a,a,a,a,k,O,a,!0,!0)}else if(1===t.colCount){for(l=b,c=x.colSizes[0],i=0;i<t.rowCount;i++)h=0===i,d=i===t.rowCount-1,s=v+i,u=x.rowSizes[i],g=x.styleList[i][0],s===t.row&&l===t.col&&(k=(m=g)&&m.diagonalDown,O=m&&m.diagonalUp),g?(e=g.borderLeft,o=g.borderTop,n=g.borderRight,r=g.borderBottom,N&&(N=T.kWa(k,g.diagonalDown)),D&&(D=T.kWa(O,g.diagonalUp))):e=o=n=r=a,h?C.kF(s,l,R,M,c,u,e,o,n,a,a,a,I,!0,!1):d?C.kF(s,l,R,M,c,u,e,a,n,r,a,a,I,!1,!1):C.kF(s,l,R,M,c,u,e,a,n,a,a,a,I,!0,!1),M+=u;k=N?k:null,O=D?O:null,C.kF(t.row,t.col,t.x,t.y,t.width,t.height,a,a,a,a,k,O,a,!0,!0)}else{for(i=0;i<t.rowCount;i++){for(s=v+i,h=0===i,d=i===t.rowCount-1,u=x.rowSizes[i],y=0;y<t.colCount;y++)l=b+y,f=0===y,p=y===t.colCount-1,c=x.colSizes[y],g=x.styleList[i][y],s===t.row&&l===t.col&&(k=(m=g)&&m.diagonalDown,O=m&&m.diagonalUp),g?(e=g.borderLeft,o=g.borderTop,n=g.borderRight,r=g.borderBottom,N&&(N=T.kWa(k,g.diagonalDown)),D&&(D=T.kWa(O,g.diagonalUp))):e=o=n=r=a,h?f?C.kF(s,l,R,M,c,u,e,o,a,a,a,a,I,!0,!0):p?C.kF(s,l,R,M,c,u,a,o,n,a,a,a,I,!0,!1):C.kF(s,l,R,M,c,u,a,o,a,a,a,a,I,!0,!0):d?f?C.kF(s,l,R,M,c,u,e,a,a,r,a,a,I,!1,!0):p?C.kF(s,l,R,M,c,u,a,a,n,r,a,a,I,!1,!1):C.kF(s,l,R,M,c,u,a,a,a,r,a,a,I,!1,!0):f?C.kF(s,l,R,M,c,u,e,a,a,a,a,a,I,!0,!0):p&&C.kF(s,l,R,M,c,u,a,a,n,a,a,a,I,!0,!1),R+=c;R=w,M+=u}k=N?k:null,O=D?O:null,C.kF(t.row,t.col,t.x,t.y,t.width,t.height,a,a,a,a,k,O,a,!0,!0)}!I||e||n||o||r||C.bF.push({r:v,c:b,rc:t.rowCount,cc:t.colCount})},t.prototype.mE=function(){var t=this,e=!1,o=!1,n=!1,r=!1;p(t.fF)||(e=!0),p(t.eF)||(o=!0),(e||o)&&(t.tF(),t.tWa()),p(t.lWa)||(n=!0),p(t.mWa)||(r=!0),(n||r)&&t.oWa(),t.bF.length>0&&t.uF()},t.prototype.E$a=function(t,e,o,n,r){var i=this,a=this.C$a[t]?this.C$a[t][e]:null;if(a)switch(r){case g.H_TOP_LEFT:return i.vF(t,e,o,n);case g.H_TOP_Right:case g.V_RIGHT_TOP:return i.vF(t,e+a.colCount-1,o,n);case g.V_RIGHT_BOTTOM:case g.H_BOTTOM_RIGHT:return i.vF(t+a.rowCount-1,e+a.colCount-1,o,n);case g.H_BOTTOM_LEFT:case g.V_LEFT_BOTTOM:return i.vF(t+a.rowCount-1,e,o,n);case g.V_LEFT_TOP:return i.vF(t,e,o,n)}return i.vF(t,e,o,n)},t.prototype.oWa=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,m=this,y=m.$E,C=m._E,v=y.length,b=C.length,w={},S={};for(t=0;t<v;t++)for(o=y[t],e=0;e<b;e++)n=C[e],h=m.pF(o,n,m.lWa,!1),p=m.pF(o,n,m.mWa,!1),(h||p)&&(T.LE(h)&&T.LE(p)&&(h.line.jWa(),p.line.jWa()),d=[],(r=m.E$a(o,n,!1,w,g.H_TOP_LEFT))&&r.line&&!r.isGridLine&&(d=[1,1,2],m.pWa(d,r,h,!0,1)),(l=m.E$a(o,n,!1,w,g.H_TOP_Right))&&l.line&&!l.isGridLine&&(d=[1,1,2],m.pWa(d,l,p,!0,1)),(i=m.E$a(o,n,!0,S,g.V_LEFT_TOP))&&i.line&&!i.isGridLine&&(d=[1,1,2],m.pWa(d,i,h,!0,0)),(u=m.E$a(o,n,!0,S,g.V_LEFT_BOTTOM))&&u.line&&!u.isGridLine&&(d=[1,1,2],m.pWa(d,u,p,!1,0)),(a=m.E$a(o+1,n,!1,w,g.H_BOTTOM_LEFT))&&a.line&&!a.isGridLine&&(d=[-1,-2,-2],m.pWa(d,a,p,!1,1)),(c=m.E$a(o+1,n,!1,w,g.H_BOTTOM_RIGHT))&&c.line&&!c.isGridLine&&(d=[-1,-2,-2],m.pWa(d,c,h,!1,1)),(s=m.E$a(o,n+1,!0,S,g.V_RIGHT_TOP))&&s.line&&!s.isGridLine&&(d=[-1,-2,-2],m.pWa(d,s,p,!0,0)),(f=m.E$a(o,n+1,!0,S,g.V_RIGHT_BOTTOM))&&f.line&&!f.isGridLine&&(d=[-1,-2,-2],m.pWa(d,f,h,!1,0)))},t.prototype.pWa=function(t,e,o,n,r){var i,a,s=T.LE(e),l=T.HE(e),u=e.line.uE;s&&(u=3),l&&(u=2),i=t[u-1],o&&o.line&&(a={_orientation:r},n?a.pE=i:a.nE=i,o.line.mE(a))},t.prototype.uF=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h=this,p=h.bF,d=p.length;for(t=0;t<d;t++){for(r=o=(e=p[t]).r,i=o-1,a=(n=e.c)-1,s=n,e.rc>1&&(r+=e.rc-1),e.cc>1&&(s+=e.cc-1),l=!1,u=!1,c=t+1;c<d&&((f=p[c]).c===s+1&&f.r===o&&(u=!0),f.r===r+1&&f.c===n&&(l=!0),!l||!u)&&!(f.r>o+1&&f.c>n+1);c++);l||h.oF(r,a,h.cF,!0),u||h.oF(i,s,h.dF,!1)}},t.prototype.tF=function(){var t,e,o,n,r,i,s,l,u,c,f,h,p,d,g,m,y,C,v=this,b=v.$E,w=v._E,S=b.length,x=w.length,A={},I={};for(t=0;t<S;t++)for(o=b[t],e=0;e<x;e++){if(n=w[e],g=0,m=0,y=v.pF(o,n,v.fF,!0)){if(y.line&&y.line.gIb)continue;g++}else y=v.pF(o,n-1,v.dF,!0);(C=v.pF(o,n,v.eF,!0))?m++:C=v.pF(o-1,n,v.cF,!0),(y||C)&&((r=0===t?a:v.vF(b[t-1],n,!0,I))&&r.line&&!r.isGridLine&&(g++,m++),(i=0===e?a:v.vF(o,w[e-1],!1,A))&&i.line&&!i.isGridLine&&(g++,m++),y&&((s=v.vF(o,n,!1,A))&&s.line&&!s.isGridLine&&g++,t!==S-1&&((u=v.vF(b[t+1],n,!0,I))&&u.line&&!u.isGridLine&&g++),0!==e&&t!==S-1&&((c=v.vF(b[t+1],w[e-1],!1,A))&&c.line&&!c.isGridLine&&g++),t!==S-1&&((f=v.vF(b[t+1],n,!1,A))&&f.line&&!f.isGridLine&&g++),g>0&&(T.GE(y.style)?T.TE(y,r,i,s,u,c,f,!0):T.HE(y.style)||T.SE(y,r,i,s,u,c,f))),C&&((l=v.vF(o,n,!0,I))&&l.line&&!l.isGridLine&&m++,e!==x-1&&((h=v.vF(o,w[e+1],!1,A))&&h.line&&!h.isGridLine&&m++),0!==t&&e!==x-1&&((p=v.vF(b[t-1],w[e+1],!0,I))&&p.line&&!p.isGridLine&&m++),e!==x-1&&((d=v.vF(o,w[e+1],!0,I))&&d.line&&!d.isGridLine&&m++),m>0&&(T.GE(C.style)?T.TE(C,i,r,l,h,p,d,!1):T.HE(C.style)||T.RE(C,i,r,l,h,p,d))))}},t.prototype.F$a=function(t,e,o,n){var r=this,i=this.C$a[t]?this.C$a[t][e]:null,a=o?r.mWa:r.lWa;return i?t===i.row&&e===i.col&&n===d.LEFT_TOP||t===i.row&&e===i.col+i.colCount-1&&n===d.RIGHT_TOP||t===i.row+i.rowCount-1&&e===i.col+i.colCount-1&&n===d.RIGHT_BOTTOM||t===i.row+i.rowCount-1&&e===i.col&&n===d.LEFT_BOTTOM?r.pF(i.row,i.col,a,!1):void 0:r.pF(t,e,a,!1)},t.prototype.tWa=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h,p,g,m=this,y=m.$E,C=m._E,v=y.length,b=C.length;for(t=0;t<v;t++)for(o=y[t],e=0;e<b;e++)n=C[e],(p=m.pF(o,n,m.fF,!0))&&p.line&&p.line._noNeedAdjust||(p&&p.line&&T.LE(p)&&(r=m.F$a(o,n,!1,d.LEFT_TOP),i=m.F$a(o,n,!0,d.LEFT_BOTTOM),a=T.LE(r),s=T.LE(i),l=m.F$a(o,n-1,!1,d.RIGHT_BOTTOM),u=m.F$a(o,n-1,!0,d.RIGHT_TOP),c=T.LE(l),f=T.LE(u),r&&a&&(h={CE:2,_orientation:1,pE:2},p.line.mE(h)),i&&s&&(h={CE:2,_orientation:1,nE:-2},p.line.mE(h)),l&&c&&(h={CE:1,_orientation:1,nE:-2},p.line.mE(h)),u&&f&&(h={CE:1,_orientation:1,pE:2},p.line.mE(h))),(g=m.pF(o,n,m.eF,!0))&&g.line&&T.LE(g)&&(r=m.F$a(o,n,!1,d.LEFT_TOP),i=m.F$a(o,n,!0,d.RIGHT_TOP),a=T.LE(r),s=T.LE(i),l=m.F$a(o-1,n,!1,d.RIGHT_BOTTOM),u=m.F$a(o-1,n,!0,d.LEFT_BOTTOM),c=T.LE(l),f=T.LE(u),r&&a&&(h={CE:2,_orientation:0,pE:2},g.line.mE(h)),i&&s&&(h={CE:2,_orientation:0,nE:-2},g.line.mE(h)),l&&c&&(h={CE:1,_orientation:0,nE:-2},g.line.mE(h)),u&&f&&(h={CE:1,_orientation:0,pE:2},g.line.mE(h))))},t.prototype.vF=function(t,e,o,n){var r,a=n[t];return a||(a=n[t]={}),(r=a[e])===i&&(r=a[e]=this.wF(t,e,o)),r},t.prototype.wF=function(t,e,o){var n,r,s;if(t===i||t<0||e===i||e<0)return a;if(n=this,r=o?n.fF:n.eF,s=n.pF(t,e,r,!0))return s;if(r=o?n.dF:n.cF,o){if(--e<0)return a}else if(--t<0)return a;return(s=n.pF(t,e,r,!0))||a},t.prototype.paint=function(t){var e=this;e.UE&&(e.VE||(e.D$a(),e.rF(),e.qF(),e.mE(),e.VE=!0),t.save(),e.jp(t),t.restore())},t.prototype.jp=function(t){this.xF(t),this.yF(t)},t.prototype.xF=function(t){var e=this;e._d(t,e.cF),e._d(t,e.dF)},t.prototype.yF=function(t){var e=this;e._d(t,e.eF),e._d(t,e.fF),e._d(t,e.lWa),e._d(t,e.mWa)},t.prototype._d=function(t,e){var o,n,r,i,a,s;for(o in e)if(e[o])for(n in r=e[o])if(r[n])if(i=r[n].line,(a=r[n].splitLines)&&a.length>0)for(s=0;s<a.length;s++)a[s]&&a[s].jp(t);else i&&i.jp(t)},t}(),e.AF=S},"./dist/core/worksheet/worksheet-edit.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("./dist/core/worksheet/worksheet.js"),i=o("./dist/core/util/common.js"),a=o("./dist/core/util/domUtil.js"),s=a.GC$,l=o("Common"),u=o("./dist/core/core.enum.js"),c=o("@grapecity/js-calc"),f=!!c,h=i.Ul.Ml,p=i.Ul.rl(),d=l.Common.j.Fa,l.Common.u,g=l.Common.CultureManager,m=null,y=void 0,C="string",v=i.Ul.K_a,(b=new l.Common.ResourceManager(n.SR)).getResource.bind(b),w={startEdit:function(t,e){var o=this;o.EF(o.Ws(),o.Jl,o.Kl,m,m,t,e)},editorStatus:function(){return this.Px||0},isEditing:function(){var t=this.Px;return 1===t||2===t},endEdit:function(t){return this.gv(t)},gv:function(t,e,o,n){var r=this;if(!r.isEditing())return!0;r.suspendPaint();try{return r.Yoa(t,e,o,n)}finally{r.resumePaint()}},Yoa:function(t,e,o,n){var a,l,c,f,p,g,y,C,v,b,w,T,S,x,A=this,I=A.mm,R=A.BF,M=A.name(),k=A.Jl,N=A.Kl,O=A.getCellType(k,N),D={sheet:A,row:k,col:N,sheetArea:3};if(O.isImeAware(D)||I.Qq(),R&&R.parentNode){if(c={sheet:A,sheetName:M,row:k,col:N,editor:R,editingText:l=O.getEditorValue(R,D),cancel:!1},A.Wq(i.Events.EditEnd,c),c.cancel&&!n)return;if(A.Wq(i.Events.EditEnding,c),c.cancel&&!n)return;if(p=(f=A.parent)&&f.CF,document.activeElement===(p&&p.qo)&&I.Qq(),k>=0&&N>=0&&(g=R.Ep,y=A.getFormulaInformation&&A.getFormulaInformation(k,N),O.isEditingValueChanged(g,l,D)||1===e||y&&y.isArrayFormula&&1!==e))if(t)O.setEditorValue(R,g,D),O.selectAll(R,D);else if(C=O.DF,d(C)&&(C=!0),v={cmd:"editCell",sheetName:M,row:k,col:N,newValue:l,autoFormat:C,editingFormatter:R.oja},1===e&&(v.ranges=[A.Ix()],v.endEditType=e),null===l||t||A.tables&&A.tables.find&&(A.tables.find(k-1,N)||A.tables.find(k,N-1))&&A.tables.fIb(new i.Range(k,N,1,1),null,l,!0),A.wu().execute(v),2===(a=v.applyResult)&&(O.focus(R,D),!n))return!1;if(A.$l=!0,O.XBb(R,D,A.getCellRect(k,N)),O.isImeAware(D))h.msie&&9===parseFloat(h.version)?I.Qq():s(R.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(b=A.zo(),w=R;w;)w.parentNode===b?b.removeChild(w):w=w.parentNode}return A.Ll=!1,T={sheet:A,sheetName:M,row:k,col:N,editingText:l},S=s.extend({},T),A.Wq(i.Events.EditEnded,T),A.Wq(i.Events.FormulatextboxEditEnded,S),!(!0!==o&&S.ignore&&!n)&&(0!==A.Px&&(x=A.Px,A.Px=0,A.Cu(x,0)),A.ITa.setCellState(k,N,u.CellStatesType.edit,!1,u.SheetArea.viewport),r.Worksheet.ao(A,"endEdit"),A.BF=m,1!==a)},FF:function(t,e,o){var n,r,i,a,s,l,u,c,f=this,h=f.hitTest(e,o);!h||h.cellTypeHitInfo&&(h.cellTypeHitInfo.outlineColumnHitInfo||h.cellTypeHitInfo.cellButtonHitInfo)||(n=h.row,r=h.col,n>=0&&r>=0&&h.rowViewportIndex>=0&&h.colViewportIndex>=0&&!h.resizeInfo&&!h.dragInfo&&n===f.Jl&&r===f.Kl&&(i=f.isEditing(),f.EF(t,n,r),!i&&f.isEditing()&&(a=h.hitTestType,(s=f.getCellType(n,r)).tw&&(l=f.getCellRect(n,r,1===a?-1:y,2===a?-1:y),u=f.getActualStyle(n,r,a),(c=s.h5(e,o,u,l,{sheet:f,row:n,col:r,sheetArea:a}))&&c.isReservedLocation&&s.tw(f,n,r,3)))))},inputFormulaAndSelectFormulaRange:function(t,e,o,n){var a,s,l,u,c,f=this,h=f.options,p=f.getCellRect(t,e),d=f.getActualStyle(t,e),g=f.getCellType(t,e),m=f.mm;m.zt(),a={sheet:f,row:t,col:e,sheetArea:3},(s=m.GF)&&s.firstChild&&(l=s.firstChild.firstChild),l&&(f.BF=l,u=f.am(),g.isImeAware(a)&&m.JF(),g.d5(s,d,p,a),f.KF(g,l,t,e,d,void 0,void 0),g.g5(s,d,p,a),h.allowCellOverflow&&((c=p.clone()).y-=2,c.height+=4,c.x=u.kt,c.width=f.rKc(u),f.repaint(c)),r.Worksheet.ao(f,"startEdit",{element:g.getEditingElement()}),f.Px=2,f.Cw.text(n),f.Cw.caret(n.length-1),o&&f.Cw.iIb(3,4),f.Cw.S1(),i.Vl.Zl(f))},EF:function(t,e,o,n,a,l,c,y,C){var v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt;if(s[s.sd]({tc:this.parent}),!(e<0||o<0||(v=this,b=v.name(),w=v.options,v.isEditing()))){if((T=v.ITa).setCellState(e,o,u.CellStatesType.edit,!0,u.SheetArea.viewport),S=v.getActualStyle(e,o),w.isProtected&&!1!==S.locked)return void T.setCellState(e,o,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(!(x=v.getCellType(e,o)))return void T.setCellState(e,o,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(v.pivotTables)for(A=v.pivotTables.all(),I=0;I<A.length;I++)if(M=(R=A[I].getRange()).page,k=R.content,M&&M.contains(e,o)||k&&k.contains(e,o))return void T.setCellState(e,o,u.CellStatesType.edit,!1,u.SheetArea.viewport);if((N=v.mm).zt(),O={sheet:v,row:e,col:o,sheetArea:3},(D=x.isImeAware(O)?N.GF:x.a5(O))&&D.firstChild&&(F=D.firstChild.firstChild),!F)return void T.setCellState(e,o,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(E=v.getActualStyle(e,o),j=!1,L=g.culture(),(E.formatter&&i.util.yIc(E.formatter,L)||E._autoFormatter&&E._autoFormatter.formatCached&&i.util.yIc(E._autoFormatter,L))&&(G=C&&C.keyCode,B=C&&C.code,C&&G&&!C.shiftKey&&(G>=96&&G<=105||G>=48&&G<=57)&&(j=!0),(109===G||107===G||C&&(!C.shiftKey&&189===G||C.shiftKey&&187===G))&&(x.probabilityAddPercent=!0),229===G&&!C.shiftKey&&B.length-B.replace(/[0-9]/,"").length>0&&(j=!0),229===G&&!C.shiftKey&&(B.length-B.replace("Minus","").length>0||B.length-B.replace("Subtract","").length>0||B.length-B.replace("Add","").length>0)&&(x.probabilityAddPercentSpec=!0),229===G&&C.shiftKey&&B.length-B.replace("Equal","").length>0&&(x.probabilityAddPercentSpec=!0),_=D.innerText,h.msie&&(_=_.replace("\r\n","")),V=g.q4(g.culture()).NumberFormat.numberDecimalSeparator,H=RegExp("^[-]?[0-9]+(\\"+V+"[0-9]+)?$"),!C&&_&&H.test(_)&&(P=!0)),v.BF=F,z={sheet:v,sheetName:b,row:e,col:o,cancel:!1},v.Wq(i.Events.EditStarting,z),z.cancel)return p.ipad&&N.Qq(),void T.setCellState(e,o,u.CellStatesType.edit,!1,u.SheetArea.viewport);v.showCell(v.Jl,v.Kl,3,3),v.jIb=!0,U=v.getValue(e,o),W=f&&v.getFormula(e,o),q=v.Px,v.HF||d(U)&&d(W)?v.Px=1:v.Px=2,v.Cu(q,v.Px),J=v.am(),!(X=v.getCellRect(e,o,n,a))||d(X.width)||d(X.height)||d(X.x)||d(X.y)||X.width<=0||X.height<=0||(x.isImeAware(O)&&N.JF(),x.d5(D,S,X,O),v.KF(x,F,e,o,S,c,y,j,P),Z=v.zo(),x.isImeAware(O)||Z.insertBefore(D,m),delete v.jIb,x.g5(D,S,X,O),x.isImeAware(O)&&l||x.focus(F,O),w.allowCellOverflow&&((Y=X.clone()).y-=2,Y.height+=4,v.QLc&&v.QLc.isEnable(u.StatesType.edit,!1)&&(Y.y=J.nt,Y.height=J.jr),Y.x=J.kt,Y.width=v.rKc(J),v.repaint(Y)),r.Worksheet.ao(v,"startEdit",{element:x.getEditingElement()}),!j&&l&&x.selectAll(F,O),j&&(K=window.getSelection(),(Q=document.createRange()).setStart(F,0),K.removeAllRanges(),K.addRange(Q)),P&&(K=window.getSelection(),($=document.createElement("span")).innerText="%",Q=document.createRange(),v.parent.options.enableFormulaTextbox&&v.parent.options.allowUserEditFormula?(F.firstChild.appendChild($),Q.setStart(F.firstChild,1),v.Cw&&v.Cw.BXc()):(F.appendChild($),Q.setStart(F,1)),K.removeAllRanges(),K.addRange(Q)),i.Vl.Zl(v),tt={sheet:v,sheetName:b,row:e,col:o},v.Wq(i.Events.EditStarted,tt),v.Wq(i.Events.FormulatextboxEditStarted,tt))}},KF:function(t,e,o,n,r,i,a,s,l){var u,c,h,p,g,m,y,b,w,T=this,S=f&&T.getFormula(o,n,3,!0);S&&(S="="+S),u=S,c={sheet:T,row:o,col:n,sheetArea:3,isImeInput:a},S&&0!==S.length||((S=T.getValue(o,n,3,1))&&S.richText&&(S=v(S)),h=T.parent,p=f&&h&&h.options.allowUserEditFormula,typeof S===C&&r.quotePrefix||S&&S.length>0&&"="===S[0]&&p?u=S="'"+S:(u=S,S=t.kp(e,r,S,c))),e.Ep=S,d(i)||(S=i),l&&S&&(S=this.dJc(S,r)),t.setEditorValue(e,S,c,s),T.parent&&T.parent.options.enableAccessibility&&(m=(g=S&&"="===S[0])?T.getText(o,n):S,y=g?S:T.getFormula(o,n),b=T.comments&&T.comments.get(o,n),w=T.fYc(o,n,m,y,b&&b.text()),e.setAttribute("aria-label",w)),e.LF=u},eYc:function(t){var e="",o=t&&(t.formatter||t._autoFormatter);return o&&(e=typeof o===C?o:o.formatCached),e},dJc:function(t,e){var o,n,r,i,a,s,l,u,c=g.q4(g.culture()).NumberFormat,f=c.negativeSign,h=c.numberDecimalSeparator,p=this.eYc(e),d="%"===p[0],m=p.split(";");if(d?o=m[0].split("%")[1].split(".")[1]:m[0].indexOf("%")>-1&&(o="00"),void 0===o&&(o=""),t.split("e").length>1)return n=t.split("e")[0],r=t.split("e")[1],n+"e+"+(parseInt(r.split("+")[1],10)+2);if(t.split(h).length>1){for(i=!1,t.charAt(0)===f&&(t=t.substr(1,t.length-1),i=!0),a=(t+=o).indexOf(h),l=(s=(t=(t=t.split(h).join("")).substr(0,a+2)+h+t.substr(a+2,t.length-1)).split(h))[0],u=s[1];l&&"0"===l.charAt(0);)l=l.substr(1,l.length-1);for(;u&&"0"===u.charAt(u.length-1);)u=u.substr(0,u.length-1);return i&&l&&(l=f+l),l&&u?l+h+u:!l&&u?(i?f+"0"+h:"0"+h)+u:l&&!u?l:"0"}return"0"===t?t:t+o}},s.extend(r.Worksheet.prototype,w)},"./dist/core/worksheet/worksheet-event.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt;function ut(t,e,o){var n,r,i,a,s,u,c,f=!1,h=t.am();return e&&(n=mt(e),r=yt(e),(n<0||r<0)&&((i=t.getCellRect(e.row,e.col,n,r))&&i.width>0&&i.height>0&&(a=h.x,s=h.y,(i.x<h.Br+a||i.y<h.Cr+s||i.y>=h.height-h.Bt)&&(u=new l.Rect(i.x-2,i.y-2,i.width+4,i.height+4),void 0,c=n<0&&r<0?h.em():n<0?h.gm(r):h.fm(n),u=u.getIntersectRect(c),o.VF(u.x,u.y,u.width,u.height),f=function(t,e){var o=3;return mt(e)<0&&(o=1),yt(e)<0&&(o=2),!(3===o||!t.vp(e.row,e.col,o,!0))}(t,e))))),f}function ct(t){return t.isEditing()}function ft(t){return t.endEdit()}function ht(t){return t.frozenRowCount()}function pt(t){return t.frozenColumnCount()}function dt(t,e){return t.getRowCount(e)}function gt(t,e){return t.getColumnCount(e)}function mt(t){return t.rowViewportIndex}function yt(t){return t.colViewportIndex}function Ct(t){return t.hitTestType}function vt(t){return t.getActiveRowIndex()}function bt(t){return t.getActiveColumnIndex()}function wt(t){return t.keyCode}function Tt(t){return t.ctrlKey}function St(t){return t.shiftKey}function xt(t){return t.altKey}function At(t){return t.metaKey}function It(t){return t.colCount}function Rt(t){return t.rowCount}function Mt(t,e,o){return{action:t,index:e,sheetArea:o}}function kt(t,e,o,n,r,i){var a={sheet:t,sheetName:e,sheetArea:r,row:o,col:n};return i&&(a.cancel=!1),a}function Nt(t,e,o,n,r,i){var a=t.kj,s=kt(a,a.name(),a.Jl,a.Kl,O,!0);return a.Wq(l.Events.LeaveCell,s),!(!s||!0!==s.cancel)||(a.Kr(e,o,n,r,i),a.Wq(l.Events.EnterCell,kt(a,a.name(),e,o)),a.Wq(l.Events.FormulatextboxEnterCell,kt(a,a.name(),e,o)),void(t.cs&&t.cs(e,o)))}function Ot(t,e,o,n,r,i,a){var s,l=t.kj,u=e.call(l,i.sheetArea);return(a&&!l.getRowVisible(i.index,i.sheetArea)||!a&&!l.getColumnVisible(i.index,i.sheetArea))&&(i.index=o.call(t,i.index,i.sheetArea)),(s=n.call(u,i.index))||(s=n.call(u,r)),s}function Dt(t,e,o,n,r){var i,a=n?"movingY":"movingX",s=n?"startY":"startX";t[a]=e,t[a]<t[s]&&(t[a]=t[s]),i=n?o.y+o.height:o.x+o.width,t[a]>i&&(t[a]=i),r!==N&&t[a]>t[s]+r&&(t[a]=t[s]+r)}function Ft(t,e){var o=e.row,n=e.rowCount,r=e.col,i=e.colCount,a=t.getColumnCount(),s=t.getRowCount();return i+r>a&&(i=a-r),n+o>s&&(n=s-o),{row:o,col:r,rowCount:n,colCount:i}}function Et(t,e,o){var n=t.parent.options.rowResizeMode;return o&&0===n&&(n=1),e.action!==$&&1===n&&!function(t,e){var o,n=t.getViewportBottomRow(t.Er(e));if(-1===n&&(n=t.ir()),e<n)for(o=n;o>e;o--)if(0!==t.getRowHeight(o))return!1;return!0}(t,e.index)&&!(!t.getRowResizable(e.index,e.sheetArea)||!t.getRowResizable(e.index+1,e.sheetArea))&&function(t){var e,o,n=t.ITa.getSelections();if(n.length>0)return e=0,o=t.getRowCount(),n.every((function(n){var r,i=Ft(t,n),a=!1;return 1===i.rowCount&&(a=(e+=1)<=1),r=i.row<o,-1!==i.col||a&&r}))}(t)}function jt(t,e,o){var n=t.parent.options.columnResizeMode;return o&&0===n&&(n=1),e.action!==ot&&1===n&&!function(t,e){var o,n=t.getViewportRightColumn(t.Fr(e));if(-1===n&&(n=t.dr()),e<n)for(o=n;o>e;o--)if(0!==t.getColumnWidth(o))return!1;return!0}(t,e.index)&&!(!t.getColumnResizable(e.index,e.sheetArea)||!t.getColumnResizable(e.index+1,e.sheetArea))&&function(t){var e,o,n=t.ITa.getSelections();if(n.length>0)return e=0,o=t.getColumnCount(),n.every((function(n){var r,i=Ft(t,n),a=!1;return 1===i.colCount&&(a=(e+=1)<=1),r=i.col<o,-1!==i.row||a&&r}))}(t)}function Pt(t,e,o){var n,r,i,a=o?t.frozenRowCount():t.frozenColumnCount(),s=o?t.lq:t.qq,l=!1,u=s-1;if(a>0&&a<s)for(n=s-1;n>=a;){if(o?t.getRowVisible(n):t.getColumnVisible(n)){if(r=o?t.getRowHeight(n):t.getColumnWidth(n),n===u&&0===r)break;if(r>0){l=!0;break}}else u--;n--}for(i=l?a:e,i--;i>=0;){if(o?t.getRowVisible(i):t.getColumnVisible(i))return i;i--}return-1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("./dist/core/worksheet/worksheet.js"),i=o("Common"),a=o("./dist/core/worksheet/worksheet-model.js"),s=o("./dist/core/util/domUtil.js"),l=o("./dist/core/util/common.js"),u=o("./dist/core/core.enum.js"),c=window,f=document,h=s.GC$.each,p=l.Ul.Ml,d=l.Ul.rl(),g=l.Ul.nl,m=l.Ul.Nl,y=i.Common.u,C=i.Common.u.Kb,v=l.kf,b=i.Common.j.Fa,T="mousedown"+(w={lIb:".handler"}).lIb,S="mouseup"+w.lIb,x="mousemove"+w.lIb,A="mousewheel"+w.lIb,I="DOMMouseScroll"+w.lIb,R="wheel"+w.lIb,M="mouseout"+w.lIb,k="dblclick"+w.lIb,N=null,O=void 0,D=isNaN,F=parseInt,E=Math.max,j=Math.floor,P=Math.min,L=Math.abs,G=Math.ceil,B="function",_="position",V="absolute",H="border",z="overflow",U="top",W="left",q="width",J="height",X="hidden",Z="none",Y="tabindex",K="gcUIElement",Q="corner",$="sizeHiddenRow",tt="sizeRow",et="sizeCol",ot="sizeHiddenCol",nt="default",rt=d.iphone||d.ipad||d.android,it=new i.Common.ResourceManager(n.SR),at=it.getResource.bind(it),st=function(){function t(t){var e=this;e.qo=t,e.jI=N,e.kI=N,e.lI=N,e.Fi=N,e.mI=!1,e.nI=!1}return t.prototype.tG=function(t){typeof t===B&&(this.kI=t)},t.prototype.PG=function(t){var e,o=this;D(t)||0===t?o.SG():(o.nI=t>0,t=L(t),e=o.jI,o.jI=t,e!==t&&o.oI())},t.prototype.oI=function(){var t=this;t.$b(),D(t.jI)||(t.lI=c.setInterval((function(){t.pI()}),t.jI))},t.prototype.pI=function(){var t=this,e=t.kI;t.mI=!0,typeof e===B&&(t.Fi=e.call(t.qo,t.nI))},t.prototype.SG=function(){var t=this;t.$b(),t.jI=N,t.lI=N,t.Fi=N,t.mI=!1},t.prototype.$b=function(){var t=this.lI;t&&clearInterval(t)},t.prototype.no=function(){this.SG()},t}(),lt=function(){function t(t){this.mIb=0;var e=this;e.WF=0,e.XF=!1,e.Gma=!1,e.gA={},e.kj=t,e.nIb="gcEvent"+t._id}return t.prototype.no=function(){var t=this;t.YF&&t.YF.no(),t.ZF&&t.ZF.no(),t.$F=N},t.prototype._F=function(){var t=this;return t.YF||(t.YF=new st(t)),t.YF},t.prototype.aG=function(){var t=this;return t.ZF||(t.ZF=new st(t)),t.ZF},t.prototype.Vs=function(){return this.kj.Vs()},t.prototype.bG=function(){var t=s.GC$(this.kj.Ws()).position();return t||(t={top:0,left:0}),t},t.prototype.AD=function(t){var e,o,n,r,i,a,s,u,c,f,h=l.Ul.sl(),d=Tt(t),g=h&&!0===d&&0===t.button;return!(2!==t.button&&!g&&(e=this,o=e.kj,e.tC(),p&&p.msie&&t.offsetX!==O&&t.offsetY!==O&&(n=0,r=0,i=o.Xs,t.target!==i&&(a=l.Ul.Z3(t.target,i),n=a.EB,r=a.FB),i&&(s=t.pageX-(t.offsetX+n),u=t.pageY-(t.offsetY+r),i.canvasOffset={top:u,left:s})),c=o.Vs(),f=e.cG(t,t.pageX-c.left,t.pageY-c.top),ct(o)||f||e.zt(),o.dG=!0,1))},t.prototype.tC=function(){var t=this;t.RB||(s.GC$(f).bind("mousemove.gcSheet."+t.nIb,(function(e){t.BD(e)})).bind("mouseup.gcSheet."+t.nIb,(function(e){t.CD(e)})),t.RB=!0)},t.prototype.uC=function(){this.RB&&(this.RB=!1,s.GC$(f).unbind("mousemove.gcSheet."+this.nIb).unbind("mouseup.gcSheet."+this.nIb))},t.prototype.cG=function(t,e,o){var n,i,a,s,u,c,f,h,p,d,g,m=this,y=m.kj,C=y.hitTest(e,o),v=C.row,w=C.col,T=C.dragInfo,S=C.formulaRangeHitInfo,x=C.cellTypeHitInfo,A=C.resizeTableHitInfo,I={hitInfo:C,e:t,r:N};if(r.Worksheet.ao(y,"processMouseDown",I),e>=(n=y.am()).x&&o>=n.y){if(y.yt=C,I.r)return;if(m.eG=!0,C.tableSelectInfo&&!y.Cw)this.oIb(C,y);else if(C.resizeInfo){if(!ft(y))return;m.fG(C)}else if(C.dragMergeInfo){if(!ft(y))return;m.Zia&&m.Zia(C)}else if(T&&T.side&&T.side!==Q){if(!ft(y))return;m.gG&&m.gG(C),m.lG(t)}else if(T&&T.side===Q){if(!ft(y))return;m.hG&&m.hG(C)}else if(C.filterButtonHitInfo)ft(y);else if(S)S.inBorder?m.iG(C):(S.inTopLeft||S.inTopRight||S.inBottomLeft||S.inBottomRight)&&m.jG(C);else if(A)m.pIb&&m.pIb(C);else if(y.Qs(mt(C)<0?-1:v,yt(C)<0?-1:w)){if(C.tableSelectInfo&&y.Cw&&(i=y.Cw,a=this.qgc(C,y),C.tableSelectInfo.tableSelection=a,i.rgc(a)),m.kG&&m.kG(y,C))return;if(s=vt(y),u=bt(y),x){if(c=y.getCellType(x.row,x.col,Ct(C)),x.sheet||(x.sheet=y),m.Sia(c,x)&&(f=x.sheetArea,(b(f)||3===f)&&(v!==s||w!==u))){y.suspendPaint();try{if(!ft(y))return;if(h=kt(y,y.name(),s,u,O,!0),y.Wq(l.Events.LeaveCell,h),h&&!0===h.cancel)return;p=y.ITa.getSelections(),d=y.ITa.getSpan(v,w),g=[new l.Range(d.row,d.col,d.rowCount,d.colCount)],y.Wq(l.Events.FloatingElementSelected,{type:"worksheet"}),y.yu(p,g),y.Sr(v,w,O,O,1),y.Wq(l.Events.EnterCell,kt(y,y.name(),v,w)),y.Au(p),y.Uja=!0,m.cs&&m.cs(v,w)}finally{y.resumePaint()}}c.processCellAndPaddingMouseDown(x)}if(x&&x.isReservedLocation)return!0;m.lG(t),m.Ala(y,C,v,w)}}},t.prototype.Ala=function(t,e,o,n){var r,i,a=this;try{if(a.mG=e,ct(t)&&!ft(t))return}finally{a.mG=N}b(o)||b(n)||(3===Ct(e)&&a.cs&&a.cs(o,n),t.Wq(l.Events.FloatingElementSelected,{type:"worksheet"}),r=t.ITa.getSelections(),a.nG(e,r),i=t.ITa.getSelections(),t.yu(r,i))},t.prototype.Sia=function(t,e){return t&&e&&e.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},t.prototype.oG=function(t){var e,o=this.kj;return!o||(e=o.am(),b(t.x)||b(t.y)||b(t.width)||b(t.height)||t.x+t.width>e.pt+o.rKc(e)+e.js||t.y+t.height>e.qt+o.oKc(e)+e.gs)},t.prototype.pG=function(t,e,o,n,r){var i,a,l,u,c,f,h,p=this.kj;for(a=0,u=(l=t.options).length;a<u;a++)if(l[a].selected){i=n[a].value;break}c=!1,p.options.isProtected&&((f=p.getActualStyle(e,o))&&(c=f.locked)),i===O||c||(h={cmd:"editCell",sheetName:p.name(),row:e,col:o,newValue:i,autoFormat:!0,ignoreFormatting:r},p.wu().execute(h)),s.GC$(t).hide()},t.prototype.qG=function(){var t,e=this;e.rG&&(3!==(t=e.rG.sG)&&2!==t||e.aG().tG(e.uG),3!==t&&1!==t||e._F().tG(e.vG))},t.prototype.wG=function(){var t=this;t.xG&&t.yG(),t.$ia&&t._ia&&t._ia(),t.zG&&t.AG&&t.AG(),t.BG&&t.CG&&t.CG(),t.DG&&t.EG(),t.FG&&t.GG(),t.HG&&t.IG(),t.qIb&&t.rIb&&t.rIb()},t.prototype.uG=function(t){var e,o,n,r,i,a,s,l,u=this;u.JG()||(e=u.rG,o=u.kj,n=e.KG,r=o.getViewportTopRow(n),i=o.getViewportBottomRow(n),t?i<dt(o)-o.frozenTrailingRowCount()-1?o.mq(o._q(r)):(a=o.Gr(n))&&a.length>0&&(s=o.am(),(l=a[a.length-1]).y+l.height>=s.qt+o.oKc(s)&&o.mq(o._q(r))):r>ht(o)&&o.mq(o.gr(r))),u.wG()},t.prototype.vG=function(t){var e,o,n,r,i,a,s,l=this;l.LG()||(e=l.kj,o=l.rG.MG,n=e.getViewportLeftColumn(o),r=e.getViewportRightColumn(o),t?r<gt(e)-e.frozenTrailingColumnCount()-1?e.rq(e.Zq(n)):(i=e.Hr(o))&&i.length>0&&(a=e.am(),(s=i[i.length-1]).x+s.width>=a.pt+e.rKc(a)&&e.rq(e.Zq(n))):n>pt(e)&&e.rq(e.br(n))),l.wG()},t.prototype.JG=function(){var t,e,o,n,r,i,a=this.kj,s=a.am(),l=ht(a),u=a.frozenTrailingRowCount(),c=this.$F,f=this.rG,h=f.KG;if(0===h){if(c.y>s.qt)return a.mq(a._t()),f.KG=1,!0}else if(1===h){if((t=a.Gr(1))&&t.length>0){if(e=t[0],l>0&&c.y<s.qt&&e.row<=a._t())return f.KG=0,!0;if(e=t[t.length-1],u>0&&c.y>s.ot&&e.row>=a.ir()&&e.y+e.height<=s.ot)return f.KG=2,!0}}else if(2===h&&((t=a.Gr(1))&&t.length>0&&c.y<s.ot)){if((e=t[t.length-1]).y+e.height>s.ot){for(o=a.oKc(s),r=0,i=n=dt(a)-u-1;i>=l;i--)if((r+=a.Sl(i))>o){n=P(i+1,n);break}a.mq(a._q(n-1))}return f.KG=1,!0}return!1},t.prototype.LG=function(){var t,e,o,n,r,i,a=this.kj,s=a.frozenTrailingColumnCount(),l=pt(a),u=a.am(),c=this.$F,f=this.rG,h=f.MG;if(0===h){if(c.x>u.pt)return a.rq(a.$t()),f.MG=1,!0}else if(1===h){if((t=a.Hr(1))&&t.length>0){if(e=t[0],l>0&&c.x<u.pt&&e.col<=a.$t())return f.MG=0,!0;if(e=t[t.length-1],s>0&&c.x>u.lt&&e.col>=a.dr()&&e.x+e.width<=u.lt)return f.MG=2,!0}}else if(2===h&&((t=a.Hr(1))&&t.length>0&&c.x<u.lt)){if((e=t[t.length-1]).x+e.width>u.lt){for(o=a.rKc(u),r=0,i=n=gt(a)-s-1;i>=l;i--)if((r+=a.Tl(i))>o){n=P(i+1,n);break}a.rq(a.Zq(n-1))}return f.MG=1,!0}return!1},t.prototype.NG=function(){var t,e,o,n,r,i,a,s,l,c,f,h,p,d,g=this;(g.OG||g.O3||g.lV)&&(e=(t=g.kj).am(),o=g.rG,b(o)||(n=o.KG,r=o.MG,i=g.$F,a=N,n>=0&&r>=0?(a=e.Ft(n,r),0===n&&t.lq===t.frozenRowCount()&&(s=e.Ft(1,r),a.height+=s.height),0===r&&t.qq===t.frozenColumnCount()&&(s=e.Ft(n,1),a.width+=s.width)):n>=0?a=e.fm(n):r>=0&&(a=e.gm(r)),a&&(c=(l=t.parent)&&l.options.scrollbarAppearance===u.ScrollbarAppearance.mobile,f=0,h=0,p=!1,d=!1,i.x<=a.x?(f=i.x-a.x,c&&(d=!0)):i.x>=a.x+a.width?(0===(f=i.x-(a.x+a.width))&&(f=50),c&&(d=!0)):c&&i.x===a.x+a.width-1&&(f=50,d=!0),i.y<=a.y?(h=i.y-a.y,c&&(p=!0)):i.y>=a.y+a.height&&(h=i.y-(a.y+a.height),c&&(p=!0)),l&&c&&(p&&(l.nKc.Jwa(u.ScrollbarState.show),l.ku.Rdc(!0)),d&&(l.kKc.Jwa(u.ScrollbarState.show),l.ku.Rdc(!1))),g._F().PG(g.QG(f)),g.aG().PG(g.QG(h)))))},t.prototype.RG=function(){this._F().SG(),this.aG().SG()},t.prototype.fG=function(t){var e,o,n,r,i,s,l=this,u=a.yp.prototype,c=l.kj,f=t.resizeInfo;f.action===tt||f.action===$?(e=Ot(l,c.Jt,l.TG,u.findRow,t.row,f,!0),f.startY=e.y):(o=Ot(l,c.Kt,l.UG,u.findCol,t.col,f,!1),f.startX=o.x),n=c.parent,r=t.x,i=t.y,n&&((1!==(s=n.options.showResizeTip)||f.action!==et&&f.action!==ot)&&(2!==s||f.action!==tt&&f.action!==$)&&3!==s||(i-30<0?i+=15:i-=30,n.uw(y.Ob(l.VG()),r,i))),l.isResizing=!0,l.OG=!0,l.ctrl&&(l.fCb=!0)},t.prototype.WG=function(){var t,e,o,n=this,r=n.kj,i=r.yt,a=i.resizeInfo,s=n.$F,l=s.x,u=s.y,c=r.am(),f=r.parent,h=a.sheetArea;a&&n.OG&&n.isResizing&&(i.x===l&&i.y===u||(a.action===tt||a.action===$?function(t,e,o,n,r){var i,a=e.index,s=t.am();Et(t,e,r)?(i=t._q(a,o),Dt(e,n,s,!0,t.Sl(a,o)+t.Sl(i,o))):Dt(e,n,s,!0)}(r,a,h,u,n.fCb):function(t,e,o,n,r){var i,a=e.index,s=t.am();jt(t,e,r)?(i=t.Zq(a,o),Dt(e,n,s,!1,t.Tl(a,o)+t.Tl(i,o))):Dt(e,n,s,!1)}(r,a,h,l,n.fCb),e=(t=r.yl).bm(),t.Mx(c.x,c.y,c.width,c.height),t.Pw(e),f&&((1!==(o=f.options.showResizeTip)||a.action!==et&&a.action!==ot)&&(2!==o||a.action!==tt&&a.action!==$)&&3!==o||f.ww(n.XG(a)))))},t.prototype.YG=function(){var t,e,o,n,r,i,a,l,u,c,f,h,p=this;p.isResizing=!1,p.OG=!1,t=!0,o=(e=p.kj).yt,(n=o.resizeInfo)&&(p.xw(),n.action===tt||n.action===$?b(n.movingY)?t=!1:(r=E(0,(n.movingY-n.startY)/e.zoom()),i=[],a="resizeRow",e.tp(n.index)?s.GC$.each(e.ITa.getSelections(),(function(t,o){if(-1===o.col)if(1===n.sheetArea)i.push({firstRow:n.index,lastRow:n.index});else{var r=e.Tq(o);i.push({firstRow:r.row,lastRow:r.row+Rt(r)-1})}})):i.push({firstRow:n.index,lastRow:n.index}),function(t,e,o,n){return Et(t,e,n)&&1===o.length&&o[0].firstRow===o[0].lastRow}(e,n,i,p.fCb)&&(a="splitResizeRow"),l=1===n.sheetArea,e.wu().execute({cmd:a,sheetName:e.name(),rows:i,size:r,columnHeader:l})):b(n.movingX)?t=!1:(r=E(0,(n.movingX-n.startX)/e.zoom()),u=[],c="resizeColumn",e.sp(n.index)?s.GC$.each(e.ITa.getSelections(),(function(t,o){if(-1===o.row){var r=e.Tq(o);2===n.sheetArea?u.push({firstCol:n.index,lastCol:n.index}):u.push({firstCol:r.col,lastCol:r.col+It(r)-1})}})):u.push({firstCol:n.index,lastCol:n.index}),function(t,e,o,n){return jt(t,e,n)&&1===o.length&&o[0].firstColumn===o[0].lastColumn}(e,n,u,p.fCb)&&(c="splitResizeColumn"),f=2===n.sheetArea,e.wu().execute({cmd:c,sheetName:e.name(),columns:u,size:r,rowHeader:f})),(h=e.hitTest(p.$F.x,p.$F.y))&&p.Tw(h),t||e.repaint(),p.fCb=!1)},t.prototype.ZG=function(t,e){var o,n,r,i,a,s,l=0,u=0,c=0,f=0,h=this,p=h.kj,d=p.wq,g=ht(p),m=pt(p),y=Ct(t);if(h.o4=h.$G=p.ITa.getSelections(),p.isCtrlPressed(y)||h.shift||p.Tr(),0===y){if(!h.shift&&Nt(h,o=g?p.ar():p.lq,m?p.$q():p.qq,1,1,e))return;p.isCtrlPressed(y)||p.Tr(),p.Ur(-1,-1,dt(p),gt(p),!0)}else if(1===y){if(!h.shift&&(o=g?p.ar():p.lq,n=h._G(o,t.col,!1),Nt(h,n.row,n.col,1,yt(t),e)))return;h.shift||p.n_a?(l=P(p.Kl,t.col),f=L(p.Kl-t.col)+1,p.Kx(-1,l,dt(p),f,!0)):p.Ur(-1,p.Kl,dt(p),1,!0)}else if(2===y){if(!h.shift){if(i=m?p.$q():p.qq,n=h._G(t.row,i,!0),r=p.Jl!==n.row,Nt(h,n.row,n.col,mt(t),1,e))return;r&&d&&d.Lx()}h.shift||p.n_a?(u=P(p.Jl,t.row),c=L(p.Jl-t.row)+1,p.Kx(u,-1,c,gt(p),!0)):p.Ur(p.Jl,-1,1,gt(p),!0)}else if(3===y)if(D(t.row)||D(t.col))ct(p)&&(s=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p.yl.VF(s.x,s.y,s.width,s.height));else{if(!h.shift&&(p.Jl!==t.row||p.Kl!==t.col)){if(r=p.Jl!==t.row,Nt(h,t.row,t.col,mt(t),yt(t),e))return;r&&d&&d.Lx()}h.shift?p.aH(t.row,t.col,!0):(a=p.ITa.getSpan(t.row,t.col),p.n_a||p.Ur(a.row,a.col,Rt(a),It(a),!0))}},t.prototype.bH=function(t){if(t&&(3!==Ct(t)||!D(t.row)&&!D(t.col))){var e=this;e.OG=!0,e.xG=!0,e.rG={KG:mt(t),MG:yt(t),sG:Ct(t)},e.qG()}},t.prototype.ayb=function(t,e){var o=this.kj,n=o.getSpan(t,e),r=t,i=e,a=1,s=1,u=o.selectionUnit(),c=!1;return 1===u?(i=-1,s=-1,r=n?n.row:r,a=n?n.rowCount:a):2===u?(r=-1,a=-1,i=n?n.col:i,s=n?n.colCount:s):c=!0,n&&c?n:new l.Range(r,i,a,s)},t.prototype.nG=function(t,e){var o=this,n=o.kj,r=t.row,i=t.col;n.n_a=o.I0a(r,i,e,Ct(t))&&n.parent.options.allowUserDeselect,n.n_a&&(n.s_a=n.Jl,n.t_a=n.Kl,n.p_a=o.ayb(r,i)),o.ZG(t),o.bH(t)},t.prototype.I0a=function(t,e,o,n){var r=this.kj;return this.o_a(t,e,o,n)&&2===r.selectionPolicy()},t.prototype.o_a=function(t,e,o,n){var r,i,a,s=this.kj,l=s.getRowCount(),u=s.getColumnCount();if(!s.isCtrlPressed(n))return!1;for(r=!1,i=o.length,a=0;a<i;a++)if(3===n){if(o[a].contains(t,e,1,1)){r=!0;break}}else if(2===n){if(o[a].contains(t,-1,1,u)||o[a].contains(t,0,1,u)){r=!0;break}}else if(1===n&&(o[a].contains(-1,e,l,1)||o[a].contains(0,e,l,1))){r=!0;break}return r},t.prototype.yG=function(){var t,e=this;e.rG&&e.OG&&!0!==e.DA&&(3===(t=e.rG.sG)?e.cH():2===t?e.dH():1===t&&e.eH())},t.prototype.cH=function(){var t,e,o,n,r=this,i=r.kj,a=r.fH(),s=r.gH();if(a>=0&&s>=0&&i.Qs(a,s)){if(r.NG(),1===(t=i.ITa.getSelections()).length&&(e=i.Jx(a,s,i.Jl,i.Kl),o=t[0],!i.n_a&&e.equals(o)))return;i.aH(a,s,!0),n=i.ITa.getSelections(),i.yu(t,n)}},t.prototype.dH=function(){var t,e,o,n,r,i=this,a=i.kj,s=i.fH(!0);if(s>=0&&a.Qs(s,-1)){if(t=P(a.Jl,s),e=E(a.Jl,s)-t+1,-1,o=gt(a),0===a.selectionPolicy())return;2===a.selectionUnit()&&(t=-1,e=-1),n=a.ITa.getSelections(),a.Kx(t,-1,e,o,!0),r=a.ITa.getSelections(),a.yu(n,r)}i.NG()},t.prototype.eH=function(){var t,e,o,n,r,i=this,a=i.kj,s=i.gH(!0);if(s>=0&&a.Qs(-1,s)){if(t=P(a.Kl,s),e=E(a.Kl,s)-t+1,-1,o=dt(a),0===a.selectionPolicy())return;1===a.selectionUnit()&&(t=-1,e=-1),n=a.ITa.getSelections(),a.Kx(-1,t,o,e,!0),r=a.ITa.getSelections(),a.yu(n,r)}i.NG()},t.prototype.hH=function(){var t,e,o,n,r=this;r.rG=N,r.RG(),r.DA=N,r.OG=!1,r.xG=!1,0!==(t=r.kj).ITa.getSelections().length&&(t.n_a&&(t.n_a=!1,e=t.p_a,t.p_a=null,t.u_a(t.ITa.getSelections(),e),delete t.s_a,delete t.t_a),t.Uja?delete t.Uja:((o=!r.$G)||(n=t.ITa.getSelections(),o=r.zu(r.$G,n)),o&&t.Au(r.o4)),r.$G=t.ITa.getSelections())},t.prototype.iH=function(){var t=this.kj,e=function(t,e){var o=t.am();return ht(t)>0&&e<o.nt+o.fs?0:t.frozenTrailingRowCount()>0&&e>o.ot?2:1}(t,this.$F.y),o=this.rG.KG,n=t.Gr(1);return(0===e&&o>0&&n.length>0&&n[0].row>t._t()||2===e&&o<2&&n.length>0&&n[n.length-1].row<t.ir())&&(e=1),e},t.prototype.jH=function(){var t=this.kj,e=function(t,e){var o=t.am();return pt(t)>0&&e<o.kt+o.hs?0:t.frozenTrailingColumnCount()>0&&e>o.lt?2:1}(t,this.$F.x),o=this.rG.MG,n=t.Hr(1);return(0===e&&o>0&&n.length>0&&n[0].col>t.$t()||2===e&&o<2&&n.length>0&&n[n.length-1].col<t.dr())&&(e=1),e},t.prototype.fH=function(t){var e,o,n,r=this.kj,i=this.$F.y,a=this.iH(),s=function(t,e,o){var n=t.Gr(e);return n?n.findNearY(o):N}(r,a,i);if(s){if(e=r.am(),o=s.row,1===a&&i<e.qt){if(o>(n=r._t()))return r._q(o-1)||o;if(o===n&&t)return 0}else if(0===a&&i<e.nt&&t)return 0;return 1===a&&i>e.ot&&o>r.hr()&&r.gr(o)||o}return-1},t.prototype.gH=function(t){var e,o,n,r=this.kj,i=this.$F.x,a=this.jH(),s=function(t,e,o){var n=t.Hr(e);return n?n.findNearX(o):N}(r,a,i);if(s){if(e=r.am(),o=s.col,1===a&&i<e.pt){if(o>(n=r.$t()))return r.Zq(o-1)||o;if(o===n&&t)return 0}else if(0===a&&i<e.kt&&t)return 0;return 1===a&&i>e.lt&&o>r.cr()&&r.br(o)||o}return-1},t.prototype.QG=function(t){var e,o=0;return D(t)||0===t||(e=t<0,o=G(500/L(t)),(o=E(20,10*o))>200&&(o=200),e&&(o=-o)),o},t.prototype.TG=function(t,e){var o=this.kj.gr(t,e);return o!==N?o:t},t.prototype.UG=function(t,e){var o=this.kj.br(t,e);return o!==N?o:t},t.prototype.kH=function(t,e,o){for(var n=this.kj;t>e;)if(t--,n.getRowVisible(t,o))return t;return t},t.prototype.lH=function(t,e,o){for(var n=this.kj;t>e;)if(t--,n.getColumnVisible(t,o))return t;return t},t.prototype.mH=function(t,e,o,n,r){var a,s,l,u,c,f,h,p=N;return function(t){return!t.options.isProtected||t.options.protectionOptions.allowResizeRows}(t)?(a=this,!(s=t.Gr(mt(e),n))||D(e.row)||D(e.col)||(t.getRowVisible(e.row,n)||(e.row=this.TG(e.row,n)),(l=s.findRow(e.row))&&(l.y+l.height-o<=r&&r<=l.y+l.height+o?(p=Mt(tt,e.row,n),(u=s[s.length-1].row)>=0&&(c=t.ir(n),p.index===c&&p.index!==u&&l.y+l.height-o/2<=r&&(p=Mt(a.nH(t,u,n),u,n)))):l.y-o<=r&&r<=l.y+o&&i.Common.k.Cb(s,l)>0&&(f=a.kH(e.row,0,n),p=Mt(a.nH(t,f,n),f,n))),!p&&1===mt(e)&&s.length>0&&(l=s[0],E(0,l.y-o)<=r&&r<=l.y+o&&((h=Pt(t,e.row,!0))>=0&&(p=Mt(a.nH(t,h,n),h,n))))),p&&!t.getRowResizable(p.index,n)&&(p=N),p):p},t.prototype.nH=function(t,e,o){var n=t.parent;return n&&1===n.options.resizeZeroIndicator&&t.getRowVisible(e)&&0===t.Yr(e,o)?$:tt},t.prototype.oH=function(t,e,o,n,r){var a,s,l,u,c,f,h,p=N;return function(t){return!t.options.isProtected||t.options.protectionOptions.allowResizeColumns}(t)?(a=this,!(s=t.Hr(yt(e),n))||D(e.col)||D(e.row)||(t.getColumnVisible(e.col,n)||(e.col=this.UG(e.col,n)),(l=s.findCol(e.col))&&(l.x+l.width-o<=r&&r<=l.x+l.width+o?(p=Mt(et,e.col,n),(u=s[s.length-1].col)>=0&&(c=t.dr(n),p.index===c&&p.index!==u&&l.x+l.width-o/2<=r&&(p=Mt(a.pH(t,u,n),u,n)))):l.x-o<=r&&r<=l.x+o&&i.Common.k.Cb(s,l)>0&&(f=a.lH(e.col,0,n),p=Mt(a.pH(t,f,n),f,n))),!p&&1===yt(e)&&s.length>0&&(l=s[0],E(0,l.x-o)<=r&&r<=l.x+o&&((h=Pt(t,e.col,!1))>=0&&(p=Mt(a.pH(t,h,n),h,n))))),p&&!t.getColumnResizable(p.index,n)&&(p=N),p):p},t.prototype.pH=function(t,e,o){var n=t.parent;return n&&1===n.options.resizeZeroIndicator&&t.getColumnVisible(e)&&0===t.$r(e,o)?ot:et},t.prototype.ur=function(t,e,o,n){var r,i,a,s,l,u,c,f=this,h=f.kj,p=h.parent,d=h.options,g=d.colHeaderVisible,m=d.rowHeaderVisible,y=N;return p&&!p.options.allowUserResize||(a=h.am(),mt(t)<0&&yt(t)>=0&&g?(y=f.oH(h,t,n,1,e))||(y=f.mH(h,t,n,1,o)):mt(t)>=0&&yt(t)<0&&m?(y=f.mH(h,t,n,2,o))||(y=f.oH(h,t,n,2,e)):mt(t)<0&&yt(t)<0?h.ir(2)===N&&L(o-a.Cr)<=n?(s=h.Gr(1))&&s.length>0&&((r=s[s.length-1].row)>=0&&h.getRowResizable(r,2)&&(y=Mt(f.nH(h,r,2),r,2))):h.dr(1)===N&&L(e-a.Br)<=n&&((l=h.Hr(1))&&l.length>0&&((i=l[l.length-1].col)>=0&&h.getColumnResizable(i,1)&&(y=Mt(f.pH(h,i,1),i,1)))):mt(t)>=0&&yt(t)>=0&&(r=dt(h,1)-1,i=gt(h,2)-1,u=h.options.sheetAreaOffset.top,c=h.options.sheetAreaOffset.left,r>=0&&0===a.Cr&&u<=o&&o<=n+u&&g?y=Mt(f.nH(h,r,1),r,1):i>=0&&0===a.Br&&c<=e&&e<=n+c&&m&&(y=Mt(f.pH(h,i,2),i,2)))),y},t.prototype.qH=function(t,e,o,n){var r,i,a,s,l=this.kj,u=l.am().Ft(1,1);if(1===e)if((r=l.Hr(e))&&r.length>0){if((i=r[r.length-1]).x+i.width<=o&&o<u.x+u.width)return!0}else if(u.contains(o,n))return!0;if(1===t)if((a=l.Gr(t))&&a.length>0){if((s=a[a.length-1]).y+s.height<=n&&n<u.y+u.height)return!0}else if(u.contains(o,n))return!0;return!1},t.prototype.BD=function(t){var e=this.Vs();this.sH(t,t.pageX-e.left,t.pageY-e.top)},t.prototype.DD=function(){var t,e,o,n,r,i=this.kj,a=i.yt;a&&((t=a.cellTypeHitInfo)&&i.getCellType(t.row,t.col,Ct(a)).ZBb(t)),this.OG||(e={x:-1e4,y:-1e4,rowViewportIndex:N,colViewportIndex:N,row:-1,col:-1,resizeInfo:N,hitTestType:N},this.Uw(e),a&&(o=a.row,n=a.col,r=i.getActualStyle(o,n),i.RLc&&(clearTimeout(i.RLc),delete i.RLc),i.parent&&r&&r.showEllipsis&&i.parent.xw()))},t.prototype.sH=function(t,e,o){var n,r,i,a,s,u,c,f,h,p,d,g,m,C=this;return C.$F={e:t,x:e,y:o},n=C.kj,C.eG&&!l.Vl.Wl(n)&&l.Vl.Zl(n),C.eG&&C.OG?void(C.isResizing?C.WG():C.$ia?C._ia&&C._ia():C.zG?C.AG&&C.AG():C.BG?C.CG&&C.CG():C.DG?C.EG():C.FG?C.GG():C.HG?C.IG():C.qIb?C.rIb&&C.rIb():C.xG&&C.yG()):(r=n.hitTest(e,o),C.sIb(n,r,C),void(r&&(0===C.mIb&&r.tableSelectInfo&&C.eG&&C.tIb(n,C,r),i=n.parent,a=r.row,s=r.col,u=n.sr(r.rowViewportIndex,r.colViewportIndex),h=r.pivotTableInfo,p=!b(h)&&h.options.showToolTip,i?(f=n.getActualStyle(a,s,u),d=n.getCellRect(a,s,r.rowViewportIndex,r.colViewportIndex),!p||n.isEditing&&n.isEditing()?(clearTimeout(n.RLc),delete n.RLc,c=n.ITa.uIb(a,s,u),c&&!1!==f.THb&&u?i.uw(y.Ob(c),d.x+d.width+5,d.y+d.height+5,!1):(g=i.options.showScrollTip&&(i.nKc.JB||i.kKc.JB),g||i.xw())):(c=h.UOc(a,s),"gc-spread-pivot-toolTip",clearTimeout(n.RLc),delete n.RLc,i.xw(),c&&!1!==f.THb&&(n.RLc=setTimeout(function(t,e){i.uw(c,t,e+15,!1,"gc-spread-pivot-toolTip")}.bind(void 0,r.x,r.y),700)))):(clearTimeout(n.RLc),delete n.RLc),C.Tw(r),i&&i.options.enableAccessibility&&(m=n.cgc(r),i.dgc(m)),C.Uw(r))))},t.prototype.sIb=function(t,e,o){var n,r,i,a,s;1===o.mIb?(n=o.vIb.row,r=o.vIb.col,i=e.col,a=t.getSelections()[0],t.Kx(n,r>i?i:r,a.rowCount,r-i>0?r-i+1:i-r+1,!0)):2===o.mIb&&(n=o.vIb.row,r=o.vIb.col,s=e.row,a=t.getSelections()[0],t.Kx(n>s?s:n,r,n-s>0?n-s+1:s-n+1,a.colCount,!0))},t.prototype.tIb=function(t,e,o){var n,r=t.getActiveRowIndex(),i=t.getActiveColumnIndex();e.vIb={row:r,col:i},"tableColSelect"===(n=o.tableSelectInfo.action)?e.mIb=1:"tableRowSelect"===n&&(e.mIb=2)},t.prototype.Tw=function(t){var e,o,n,r,i,a,s,u,c,f,h,p,d,g,m,y,C=this,v=C.kj,b=v.Ws();b&&(n=!(e=v.yt)||t.row!==e.row||t.col!==e.col||Ct(t)!==Ct(e)||t.resizeInfo&&!e.resizeInfo||!t.resizeInfo&&e.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==e.resizeInfo.action||t.dragInfo&&!e.dragInfo||!t.dragInfo&&e.dragInfo||t.dragInfo&&t.dragInfo.action!==e.dragInfo.action||t.resizeTableHitInfo&&!e.resizeTableHitInfo||!t.cellTypeHitInfo&&e.cellTypeHitInfo,e&&n&&((r=e.cellTypeHitInfo)&&(o=v.getCellType(r.row,r.col,Ct(e))).ZBb(r)),i=t.resizeInfo,a=t.dragMergeInfo,s=t.dragInfo,u=t.formulaRangeHitInfo,c=t.cellTypeHitInfo,f=v.yl,h=t.resizeTableHitInfo,(p=t.tableSelectInfo)?"tableRowSelect"===p.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===p.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===p.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===p.action?b.style.cursor="move":"default"===p.action&&(b.style.cursor=""):i?i.action===et?b.style.cursor=l.CursorResource.ResizeCol:i.action===tt?b.style.cursor=l.CursorResource.ResizeRow:i.action===ot?b.style.cursor=l.CursorResource.ResizeHiddenCol:i.action===$?b.style.cursor=l.CursorResource.ResizeHiddenRow:b.style.cursor=nt:a?a.left||a.right?b.style.cursor="w-resize":(a.top||a.bottom)&&(b.style.cursor="n-resize"):s&&"drag"===s.action?s.side===Q?b.style.cursor="crosshair":s.side?b.style.cursor="move":b.style.cursor=nt:u?(u.inBorder?b.style.cursor="move":u.inTopLeft?b.style.cursor="nw-resize":u.inTopRight?b.style.cursor="ne-resize":u.inBottomLeft?b.style.cursor="sw-resize":u.inBottomRight&&(b.style.cursor="se-resize"),d=C.isFormulaRangeHoving,m=(g=C.tH)&&g.paramRange,y=u.paramRange,C.isFormulaRangeHoving=!0,C.tH={paramRange:y},d&&y.index===m.index||f.uH()):h?b.style.cursor="se-resize":(c&&(o=v.getCellType(c.row,c.col,Ct(t)),c.sheet=v,n&&o.processMouseEnter(c),o.YBb(c)),!n&&c&&c.isReservedLocation||(b.style.cursor=nt),C.isFormulaRangeHoving&&(C.isFormulaRangeHoving=!1,C.tH=N,f.uH())))},t.prototype.CD=function(t){var e=this,o=e.kj;return e.uC(),!o.dG||(o.dG=!1,e.vH(t),!1)},t.prototype.vH=function(t){var e,o,n,r=this,i=r.kj,a=l.Vl.Xl();r.eG=!1,r.mIb=0,a&&a!==i&&a.endEdit&&(a.Cw&&a.Cw.V4||(a.endEdit(),a.repaint())),l.Vl.Zl(i),r.isResizing?r.YG():r.$ia?r.aja&&r.aja():r.zG?r.wH&&r.wH():r.BG?r.xH&&r.xH():r.DG?r.yH():r.FG?r.zH():r.HG?r.AH():r.qIb?r.wIb&&r.wIb():i.yt&&(o=(e=i.yt).cellTypeHitInfo,!e.filterButtonHitInfo&&!e.resizeInfo&&e.row>=0&&e.col>=0&&(o&&(n=i.getCellType(o.row,o.col,Ct(e)),o.sheet||(o.sheet=i),n.XGb(o)),o&&o.isReservedLocation||i.Wq(l.Events.CellClick,kt(i,i.name(),e.row,e.col,Ct(e))),r.hH(),i.sgc&&i.tgc&&i.tgc())),r.SLc=!1,r.lG(t)},t.prototype.UF=function(t,e,o){var n,r=this.kj;r.isEditing&&r===l.Vl.Xl()&&(n=r.Ws(),St(t)||Tt(t)||r.FF(n,e,o))},t.prototype.nm=function(t){var e,o,n,r,i,a,s,u,c,f,h,p,d=this,m=d.kj;if(m){if(e=vt(m),o=bt(m),n=m.getCellType(e,o),r={isEditing:ct(m),sheet:m,row:e,col:o,sheetArea:3},i={sheet:m,row:e,col:o,sheetArea:3},n&&n.isReservedKey(t,r))return void(ct(m)||n.processKeyDown(t,i));if((a=m.Cw)&&a.BH(t))return;if((s=m.parent&&m.parent.CF)&&s.BH(t,r))return}if(u=!(ct(m)||Tt(t)||At(t)||34!==wt(t)&&33!==wt(t)&&37!==wt(t)&&39!==wt(t)&&9!==wt(t)&&13!==wt(t)&&38!==wt(t)&&40!==wt(t)),m.CH&&(m.CH=!1,m.yl.DH()),h=13===(f=wt(t)),p=27===f,m.sgc&&m.ugc&&(h||p)?m.ugc(p):c=d.EH(t),u&&c&&l.Vl.Wl(m)){if(d.Uoa=new Date,d.FH)return d.GH<25&&d.GH++,void g(t);d.FH=!0,d.GH=1,d.HH(t,!0)}},t.prototype.VG=function(){var t,e,o=this.kj,n=o.yt.resizeInfo;return n.action===tt||n.action===$?(t=o.getRowHeight(n.index),C(at().Tip_Height,[t])):(e=o.getColumnWidth(n.index),C(at().Tip_Width,[e]))},t.prototype.XG=function(t){var e=this.kj;return t.action===tt||t.action===$?C(at().Tip_Height,[E(0,j((t.movingY-t.startY)/e.zoom()))]):C(at().Tip_Width,[E(0,j((t.movingX-t.startX)/e.zoom()))])},t.prototype.HH=function(t,e){var o=this;if(o.FH){if(new Date-o.Uoa>100)return void o.Ux();e||o.EH(t),o.FH&&(o.WF=c.setTimeout((function(){o.HH(t)}),500/o.GH))}},t.prototype.IH=function(t,e){var o,n,r,i=this.kj,a=i.Ws();if(a){i.HF=!0;try{o=ct(i),i.EF&&i.EF(a,i.Jl,i.Kl,N,N,!0,N,e,t),!o&&ct(i)&&(!(n=i.getCellType(i.Jl,i.Kl)).tw||32!==wt(t)||Tt(t)||St(t)||xt(t)||n.tw(i,i.Jl,i.Kl,3),n.JH&&n.JH(t))}finally{i.HF=!1,(r=i.tu()).UHb&&delete r.UHb}}},t.prototype.EH=function(t){var e,o,n,i,a,l,u,f,h,p,d=this,m=d.kj;if(d.lG(t),ct(m)||27!==wt(t)||xt(t)||Tt(t)||St(t)||!m.KH||(s.GC$(m.KH).remove(),m.KH=N),e=m.tu(),ct(m)||27!==wt(t)||xt(t)||Tt(t)||St(t)||!e.UHb||delete e.UHb,ct(m)||34!==wt(t)&&33!==wt(t)&&35!==wt(t)&&36!==wt(t)&&38!==wt(t)&&40!==wt(t)||g(t),ct(m)||37!==wt(t)&&39!==wt(t)||g(t),ct(m)&&Tt(t)&&(89===wt(t)||90===wt(t)))return g(t),!1;if(n=(o=m.wu()).getShortcutKey(wt(t),Tt(t),St(t),xt(t),At(t)),i=o.getCommands(n))for(a=0;a<i.length;a++)if(l={sheetName:m.name()},(u=i[a].execute(m.parent,l))||l.vgc)return u.ignoreCancelDefault||g(t),!0;return f={e:t,r:N},r.Worksheet.ao(m,"processKeyDown",f),!!f.r||(d.LH(t)&&((h=m.Cw)&&h.MH&&h.NH(),ct(m)||((p=c.Yl.Bm(t.target))&&"gcAttachedFormulaTextBox"===p.getAttribute(K)||d.IH(t))),!1)},t.prototype.Ux=function(){var t=this;t.FH=!1,t.WF>0&&(clearTimeout(t.WF),t.WF=0)},t.prototype.om=function(t){var e,o,n,r,i,a,s,l,u=this;if(u.Ux(),e=u.kj){if(o=vt(e),n=bt(e),r=e.getCellType(o,n),i={isEditing:ct(e),sheet:e,row:o,col:n,sheetArea:3},a={sheet:e,row:o,col:n,sheetArea:3},r&&r.isReservedKey(t,i))return void(ct(e)||r.processKeyUp(t,a));if((s=e.Cw)&&s.BH(t))return;if((l=e.parent&&e.parent.CF)&&l.BH(t))return}u.lG(t)},t.prototype.pm=function(t){var e=this.kj,o={e:t,r:N};r.Worksheet.ao(e,"processCompositionStart",o),o.r||this.IH(t,!0)},t.prototype.LH=function(t){return!(Tt(t)||xt(t)||At(t))&&(wt(t)>=65&&wt(t)<=90||wt(t)>=48&&wt(t)<=59||wt(t)>=96&&wt(t)<=105||wt(t)>=186&&wt(t)<=192||wt(t)>=220&&wt(t)<=222||219===wt(t)||wt(t)>=106&&wt(t)<=111||32===wt(t)||61===wt(t)||173===wt(t)||229===wt(t)||0===wt(t)||8===wt(t))},t.prototype.lG=function(t){var e,o,n,r,i,a=this,s=a.kj,u=l.Ul.sl()?At(t):Tt(t);a.ctrl=u&&!St(t),a.shift=St(t)&&!u,s.Hx=!1,9===wt(t)&&((e=s.ITa.getSelections().length)>1?s.Hx=!0:(o=s.Ix())&&e>0&&(s.Hx=!(s.Jl===o.row&&s.Kl===o.col&&s.Lr>=Rt(o)&&s.Mr>=It(o)))),!0===a.zG&&(n=s.Ix(),r=a.OH,i=a.PH,-1===n.row||-1===n.col?a.OH=St(t):a.OH=!1,a.PH=u,r===a.OH&&i===a.PH||s.yl.QH&&s.yl.QH()),a.RH=u},t.prototype.Vx=function(){var t=this;t.shift=!1,t.ctrl=!1,t.kj.Hx=!1,t.zG=!1,t.OH=!1,t.PH=!1,t.RH=!1},t.prototype.Qw=function(t){var e,o,n,r,i,a,l,u,c,f,h,p;t&&t.sheet?(e=t.sheet,o=t.editor,n=t.canvasOffset):o=(e=this.kj).BF,ct(e)&&(r=e.Jl,i=e.Kl,a=e.getCellType(r,i),l=e.am(),u=e.getActualStyle(r,i),c=e.getCellRect(r,i),o&&o.parentNode&&(f=o.parentNode.parentNode,c&&c.width>0&&c.height>0&&c.x>=l.kt&&c.y>=l.nt&&c.x+c.width<=l.lt+l.js&&c.y+c.height<=l.ot+l.gs?(h={sheet:e,row:r,col:i,sheetArea:3,canvasOffset:n},a.g5(f,u,c,h)):s.GC$(f).css({top:-1e4,left:-1e4})),(p=e.Cw)&&p.SH())},t.prototype.TH=function(t,e){var o,n;if(!t)return N;for(o=t.firstChild;o;){if(o.id===e||o.name===e)return o;if(n=this.TH(o,e))return n;o=o.nextSibling}return N},t.prototype.zu=function(t,e){var o,n,r,i=!0;if(t.length===e.length)for(o=0;o<t.length;o++){if(n=t[o],r=e[o],n.row!==r.row||n.col!==r.col||Rt(n)!==Rt(r)||It(n)!==It(r)){i=!0;break}i=!1}return i},t.prototype.UH=function(t,e,o,n){var r,i,a,l,u,f,h,d,g=this,y=g.kj,C={sheet:y,row:e,col:o,sheetArea:3},v=y.zo(),w=t.isImeAware(C),T=rt?V:"fixed";return n&&g.VH(),w&&!g.GF&&(i=(r=t.a5(C)).style,g.WH||(g.WH={overflow:"visible",border:Z,position:V}),g.WH.overflow=i.overflow,g.WH.border=i.border,g.WH.position=i.position,s.GC$(r).css([_,z,U,W,q,J,H],[T,X,"0px","0px","0px","0px",Z]),y.KF&&r.firstChild&&(a=r.firstChild.firstChild,y.KF(t,a,e,o,y.getActualStyle(e,o)),l=t.getEditorValue(a,C),p.safari&&(""===l||b(l))&&t.setEditorValue(a," ",C)),v&&v.insertBefore(r,N),g.GF=r),g.XH||(r=m("div"),s.GC$(r).css([_,z,U,W,q,J],[T,X,"0px","0px","0px","0px"]),g.XH=r,u=m("textarea"),s.GC$(u).attr(K,"gcSheetFocusInput").attr(Y,-1).css([_,z,H,"resize"],[V,X,Z,Z]),u.value=" ",r.insertBefore(u,N),g.YH=u,f=m("div"),s.GC$(f).css(_,V).css(z,X).attr(K,"gcSheetFocusInput").attr(Y,-1),r.insertBefore(f,N),g.ZH=f,v&&v.insertBefore(r,N)),h=c.location!==c.parent.location,d=c.scrollX>0||c.scrollY>0,(rt||p.mozilla&&h||d)&&(g.GF&&g.$H(y,g.GF),g.$H(y,g.XH)),w?g.GF:g.YH},t.prototype.JF=function(){var t=this;t.GF&&t.WH&&s.GC$(t.GF).css(z,t.WH.overflow).css(H,t.WH.border).css(_,t.WH.position)},t.prototype.VH=function(){var t=this;t.GF&&(t.GF.parentElement&&t.GF.parentElement.removeChild(t.GF),t.GF.comboBox&&(t.GF.comboBox=N),t.GF=N)},t.prototype.zt=function(t){l.Vl.Wl(this.kj)||this._H(!0,!0,t)},t.prototype.Cm=function(){var t=this.ZH;t&&t.focus()},t.prototype.Qq=function(){this._H(!0,!0)},t.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=N)},t.prototype._H=function(t,e,o){var n,r,i,a,s,u,h,g,m,y,C,v;0===arguments.length&&(t=!0),(n=this).Gma||(n.XF=!1,n.aI(),r=n.kj,i=vt(r),a=bt(r),s=r.getCellType(i,a),n.UH(s,i,a,e),u={sheet:r,row:i,col:a,sheetArea:3},h=s.isImeAware(u)&&n.GF.firstChild?n.GF.firstChild.firstChild:n.YH,g=h,e&&!p.msie&&s.setImeMode(g,r.getActualStyle(i,a).imeMode,u),f.body.focus(),m=function(){e&&p.msie&&s.setImeMode(g,r.getActualStyle(i,a).imeMode,u),function(){try{s.isImeAware(u)?(s.focus(g,u),s.selectAll(g,u)):(h.focus(),h.select())}catch(t){}}()},y=d,C=p.metroMode||y.ipad||y.iphone||y.android,!r.CH&&!C||!t&&s.isImeAware(u)?!1===r._enhanceIme||o||n.TLc(r)||m():!ct(r)&&C?e&&(v=n.GF&&n.GF.firstChild&&n.GF.firstChild.firstChild,s.setImeMode(v,r.getActualStyle(i,a).imeMode,u)):n.bI=c.setTimeout((function(){n.TLc(r)||(n.aI(),ct(r)||!1===r._enhanceIme||o||m())}),200),l.Vl.Wl(r)||n.TLc(r)||l.Vl.Zl(r),n.byb(r)||n.cs&&n.cs(r.Jl,r.Kl))},t.prototype.$H=function(t,e){var o,n,r,i,a,l,u,f=vt(t),h=bt(t),p=t.Nr,d=t.Pr,g=t.getCellRect(f,h,p,d),m=this,y=t.Vs(),C=m.bG(),v=m.GF,b=0,w=0,T=0,S=0;v&&(r=s.GC$(v),b=parseInt(r.css(U),10),w=parseInt(r.css(W),10),T=parseInt(r.css(J),10),S=parseInt(r.css(q),10)),m.oG(g)?(o=b,n=w):(o=g.y+C.top-2,n=g.x+C.left-2),i=c.pageYOffset-y.top+C.top,a=c.innerHeight+i-T,l=c.pageXOffset-y.left+C.left,u=c.innerWidth+l-S,(D(o)||o<i||o>a)&&(o=i),(D(n)||n<l||n>u)&&(n=l),s.GC$(e).css(U,o).css(W,n)},t.prototype.cI=function(t){var e,o,n,r,i=this;i.aI(),ct(i.kj)||i.XF&&f.activeElement===i.ZH||(e=i.kj,t?(o=t.row,n=t.col):(o=e.Jl,n=e.Kl),r=e.getCellType(o,n),i.UH(r,o,n,!1),i.ZH.focus(),i.XF=!0)},t.prototype.dI=function(t,e){var o=this;o.XF&&(o.XF=!1,!e&&o._H(t))},t.prototype.gx=function(t){var e=this.kj.tu();e&&(e.ska(t),e.M4(),this.Gma=!0,t&&e.N4())},t.prototype.hx=function(){var t=this,e=t.kj.tu();e&&e.ska(""),t.Gma=!1,t._H(!0,!1)},t.prototype.MF=function(){var t,e=this;e.aI(),(t=e.GF)&&(s.GC$(t).remove(),e.GF=O),(t=e.XH)&&(s.GC$(t).remove(),e.YH=O,e.XH=N,e.ZH=N)},t.prototype.uw=function(t,e,o,n){var r=this.kj.parent;r&&r.uw(y.Ob(t),e,o,n)},t.prototype.ww=function(t,e,o,n){var r=this.kj.parent;r&&r.ww(t,e,o,n)},t.prototype.xw=function(){var t=this.kj.parent;t&&t.xw()},t.prototype.Uw=function(t){var e,o,n,r,i,a,s,l,c,f,h;o=(e=this.kj).hCb,n=e.iCb,i=!1,(r=e.yt)||(i=!0),i||t||(i=!0),i||(i=t.col!==r.col||t.row!==r.row||yt(t)!==yt(r)||mt(t)!==mt(r)||Ct(t)!==Ct(r)||!function(t,e){var o=!1;return t||e?t&&e&&(o=t.action===e.action&&t.index===e.index&&t.sheetArea===e.sheetArea):o=!0,o}(t.resizeInfo,r.resizeInfo)),e.yt=t,i&&(s=(a=e.QLc)&&a.isEnable(u.StatesType.hover,!0),l=a&&a.isEnable(u.StatesType.hover,!1),r&&!b(r.hitTestType)&&(e.hCb=null,e.iCb=null,e.ITa.setCellState(o,n,u.CellStatesType.hover,!1,r.hitTestType),s&&e.ULc(o),l&&e.VLc(n),s||l||e.xIb&&e.xIb(u.CellStatesType.hover,o,n,r.hitTestType,r.rowViewportIndex,r.colViewportIndex)),t&&!b(t.hitTestType)&&(e.hCb=t.row,e.iCb=t.col,t.resizeInfo||(e.ITa.setCellState(t.row,t.col,u.CellStatesType.hover,!0,t.hitTestType),s&&e.ULc(t.row),l&&e.VLc(t.col),s||l||e.xIb&&e.xIb(u.CellStatesType.hover,t.row,t.col,t.hitTestType,t.rowViewportIndex,t.colViewportIndex))),e.fI=!0,f=ut(e,r,c=e.yl),h=ut(e,t,c),f=f||h,e.fI=!1,f&&c.im())},t.prototype._G=function(t,e,o){var n=this.gI(t,e,o);return this.hI(n)},t.prototype.gI=function(t,e,o){var n=this.kj.ITa.getSpan(t,e),r=Rt(n),i=It(n);return 1===r&&1===i||o&&1===r||!o&&1===i?n:(o?e++:t++,this.gI(t,e,o))},t.prototype.hI=function(t){var e,o,n,r=this.kj,i=t.row,a=dt(r);for(e=i;e<a&&!0!==r.getRowVisible(e);e++);for(e<a&&(i=e),o=t.col,n=gt(r),e=o;e<n&&!0!==r.getColumnVisible(e);e++);return e<n&&(o=e),v(i,o,Rt(t),It(t))},t.prototype.byb=function(t){var e,o,n=t.floatingObjects&&t.floatingObjects.all(),r=t.shapes&&t.shapes.all();if(!b(n))for(e=0;e<n.length;e++)if(n[e].isSelected())return!0;if(!b(r))for(o=0;o<r.length;o++)if(r[o].isSelected())return!0},t.prototype.TLc=function(t){return"function"==typeof t.isShapeTextEditorOpened&&t.isShapeTextEditorOpened()},t}(),e.iI=lt,r.Worksheet.$n("eventHandler",{beforeSetHost:function(){this.mm=new lt(this)},dispose:function(t){var e,o,n,r,i=this,a=i.mm;a&&(a.uC(),e=a.nIb,s.GC$(i.Ws()).unbind(T+"."+e).unbind(S+"."+e).unbind(x+"."+e).unbind(A+"."+e).unbind(M+"."+e).unbind(k+"."+e),p.mozilla&&(o="onwheel"in document?R:I,s.GC$(i.Ws()).unbind(o+"."+e)),a.no(),a.MF()),(n=i.BF)&&s.GC$(n).remove(),(r=i.NF)&&(r.close(),i.NF=null),!1!==t.clearCache&&(i.OF=N,i.PF=N,i.QF=N,i.RF=N,i.SF=N,i.TF=N,i.mm=N)},setHost:function(t){var e,o,n,i;t&&(o=(e=this).mm,e.OF=function(t){var n={e:t,r:N};if(r.Worksheet.ao(e,"preProcessMouseDown",n),!n.r)return o.AD(t)},e.PF=function(t){var n={e:t,r:N};r.Worksheet.ao(e,"preProcessMouseMove",n),n.r||o.RB||o.BD(t)},e.QF=function(t){var n={e:t,r:N};if(r.Worksheet.ao(e,"preProcessMouseUp",n),!n.r&&!e.XD){if(o.RB)return;return o.CD(t)}},e.RF=function(t){var o,n,i,a,s,l,u,f,h,d,g;if(o={e:t=t||c.event,r:N},r.Worksheet.ao(e,"preProcessMouseWheel",o),!o.r)return i=(n=e.parent)&&n.options.scrollByPixel,a=t.detail?t.detail:t.wheelDelta/-40,s=0,"wheel"===t.type?(17,l=p.mozilla&&+p.version>=88?17:1,a=t.deltaY/l,s=t.deltaX/l,i||(L(a)>=L(s)?s=0:a=0)):(u=(new Date).valueOf(),f=t.wheelDeltaY,h=t.wheelDeltaX,i||(L(f)>=L(h)?h=0:f=0),d=!e.nka||u-e.nka>200,(p.safari||p.chrome)&&(l=p.safari?-4:-40,b(f)||(d?(a=((a=f/l)>=0?1:-1)*j(L(a)),e.oka=0):(a=f/l,e.oka+=a,a=(a>=0?1:-1)*j(L(e.oka)),e.oka-=a)),b(h)||(d?(s=((s=h/l)>=0?1:-1)*j(L(s)),e.pka=0):(s=h/l,e.pka+=s,s=(s>=0?1:-1)*j(L(e.pka)),e.pka-=s))),e.nka=u),(0!==a||0!==s)&&(g=e.parent.ku.Rw(e,t,F(a,10)||0,F(s,10)||0),n.xw(),!!g&&void 0)},e.SF=function(t){var n={e:t,r:N};if(r.Worksheet.ao(e,"preProcessMouseOut",n),!n.r)return o.DD(t)},e.TF=function(t){var n,i,a={e:t,r:N};r.Worksheet.ao(e,"preProcessMouseDbClick",a),a.r||(n=e.yt)&&(i=!1,3===Ct(n)?function(t,o){var n=e.Vs(),r=o.pageX-n.left,i=o.pageY-n.top,a=e.hitTest(r,i),s=a.dragInfo;a.tableSelectInfo||(s&&t.cyb&&"corner"===s.side?t.cyb():t.UF(o,r,i))}(o,t):i=function(t,e){var o,n,r=t.kj,i=e.resizeInfo;return!!i&&(i.action===tt||i.action===$?(o=[],r.tp(i.index)?h(r.ITa.getSelections(),(function(t,e){var n,i;if(-1===e.col)for(n=r.Tq(e),i=0;i<Rt(n);i++)o.push({row:n.row+i})})):o.push({row:i.index}),r.wu().execute({cmd:"autoFitRow",sheetName:r.name(),rows:o,columnHeader:1===i.sheetArea})):(n=[],r.sp(i.index)?h(r.ITa.getSelections(),(function(t,e){var o,i;if(-1===e.row)for(o=r.Tq(e),i=0;i<It(o);i++)n.push({col:o.col+i})})):n.push({col:i.index}),r.wu().execute({cmd:"autoFitColumn",sheetName:r.name(),columns:n,rowHeader:2===i.sheetArea})),!0)}(o,n),i||e.Wq(l.Events.CellDoubleClick,kt(e,e.name(),n.row,n.col,Ct(n))))},n=o.nIb,t.bind(T+"."+n,(function(t){return e.OF(t)})).bind(S+"."+n,(function(t){return e.QF(t)})).bind(x+"."+n,(function(t){return e.PF(t)})).bind(A+"."+n,(function(t){return e.RF(t)})).bind(M+"."+n,(function(t){return e.SF(t)})).bind(k+"."+n,(function(t){return e.TF(t)})),p.mozilla&&(i="onwheel"in document?R:I,t.bind(i+"."+n,(function(t){return e.RF(t)}))))}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,e,o){"use strict";var n,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/util/domUtil.js"),r=o("./dist/core/worksheet/worksheet.js"),i=o("./dist/core/worksheet/style.js"),a=o("./dist/core/util/common.js"),s=o("Common"),n.GC$.extend(r.Worksheet.prototype,{getFormatter:function(t,e,o){return this.tq(t,e,"formatter",o)},setFormatter:function(t,e,o,n){var r=this.Iq(t,e,n);r||(r=new i.Style),r.formatter=o,this.setStyle(t,e,r,n)}}),r.Worksheet.$n("formatter",{settingText:function(t){var e,o=a.util.tl(t.value),n=s.Formatter&&s.Formatter.GeneralFormatter;n&&o&&(e={},(new n).getPreferredDisplayFormatter(t.value,e),"number"==typeof e.value&&(t.value=e.value))}})},"./dist/core/worksheet/worksheet-json.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x;function A(t,e,o,n){var r,i;if(t.dataTable&&(e.dataTable||(e.dataTable={}),r=t.dataTable[o])){if(e.dataTable[o]||(e.dataTable[o]={}),!(i=r[n]))return;e.dataTable[o][n]||(e.dataTable[o][n]={}),i.formula&&(e.dataTable[o][n].formula=i.formula)}}function I(t,e,o,n){var r,i,a=t.ITa,l=a.XTa(),u=a.XTa(f.SheetArea.colHeader),c=a.YTa(!0),h=a.YTa(!0,f.SheetArea.colHeader),p=a.zl(),d=a.zl(f.SheetArea.colHeader),g=l.getColumnCount();for(b(e.colHeaderData)&&(e.colHeaderData={}),u.setRowCount(o),r=0;r<o;r++)for(u.setNode(r,-1,l.RTa(r,-1)),h.Kp(r,c.Jp(r)),i=n;i<g;i++)u.setNode(r,i,l.RTa(r,i)),A(e.data,e.colHeaderData,r,i);p.getSpans(s.kf(0,0,o,g)).forEach((function(t){d.add(t)})),t.frozenRowCount(0)}function R(t,e,o,n){var r,i,a=t.ITa,l=a.XTa(),u=a.XTa(f.SheetArea.rowHeader),c=a.YTa(!1),h=a.YTa(!1,f.SheetArea.rowHeader),p=a.zl(),d=a.zl(f.SheetArea.rowHeader),g=l.getRowCount();for(b(e.rowHeaderData)&&(e.rowHeaderData={}),u.setColumnCount(o),r=0;r<o;r++)for(u.setNode(-1,r,l.RTa(-1,r)),h.Kp(r,c.Jp(r)),i=n;i<g;i++)u.setNode(i,r,l.RTa(i,r)),A(e.data,e.rowHeaderData,i,r);p.getSpans(s.kf(0,0,g,o)).forEach((function(t){d.add(t)})),t.frozenColumnCount(0)}function M(t,e){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===e;case"rowCount":return 200===e;case"columnCount":return 20===e;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===e;case"visible":return!0===e}return!1}function k(t,e){return m(t)?t:e}function N(t,e,o){m(o)&&e.call(t,o,!1)}function O(t,e,o,n,r,i){g&&y(g,(function(a,s){var l=s.fromJson;l&&l.call(t,e,o,n,!m(r)||r,i)}))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/worksheet/worksheet.js"),i=o("./dist/core/worksheet/style.js"),a=i.Style.kxb,s=o("./dist/core/util/common.js"),l=o("./dist/core/util/theme.js"),u=o("./dist/core/util/domUtil.js"),c=o("./dist/core/worksheet/stylehelper.js"),f=o("./dist/core/core.enum.js"),h=o("@grapecity/js-calc"),p=!!h,d=n.Common.CultureManager,g=r.Worksheet._n,m=s.util.Ol,y=u.GC$.each,C=u.GC$.isEmptyObject,v=n.Common.D,b=n.Common.j.Fa,w="string",T=parseInt,S=isNaN,x=void 0,u.GC$.extend(r.Worksheet.prototype,{qI:function(t,e,o,n){var r;t[e]||(t[e]={}),(r=t[e])[o]||(r[o]={}),r[o].value=n},$ec:function(t,e){var o,n,i,a,s=this,l=s.ITa,u=l.XTa(),c=l.XTa(f.SheetArea.colHeader),h=l.YTa(!0),p=l.YTa(!0,f.SheetArea.colHeader),d=l.zl(),g=l.zl(f.SheetArea.colHeader),m=s.rowFilter(),y=u.getColumnCount();for(o=0;o<t;o++)for(u.setNode(o,-1,c.RTa(o,-1)),h.Kp(o,p.Jp(o)),n=e;n<y;n++)(i=c.RTa(o,n))||(i={}),i.style=s.getActualStyle(o,n,f.SheetArea.colHeader),u.setNode(o,n,i),(a=s.getFormula(o,n,f.SheetArea.colHeader))&&s.setFormula(o,n,a,f.SheetArea.viewport);g.getSpans().forEach((function(t){d.add(t)})),m&&m.range&&-1===m.range.row&&(m.jXc=!0),s.frozenRowCount(t),l.dWa(r.Worksheet.Vp,y,f.SheetArea.colHeader),l.fWa(!1,f.SheetArea.colHeader),l.eWa(f.SheetArea.colHeader),s.Bj(f.SheetArea.colHeader).clearAll()},Zec:function(t,e){var o,n,i,a,s=this,l=s.ITa,u=l.XTa(),c=l.XTa(f.SheetArea.rowHeader),h=l.YTa(!1),p=l.YTa(!1,f.SheetArea.rowHeader),d=l.zl(),g=l.zl(f.SheetArea.rowHeader),m=u.getRowCount();for(o=0;o<t;o++)for(u.setNode(-1,o,c.RTa(-1,o)),h.Kp(o,p.Jp(o)),n=e;n<m;n++)(i=c.RTa(n,o))||(i={}),i.style=s.getActualStyle(n,o,f.SheetArea.rowHeader),u.setNode(n,o,i),(a=s.getFormula(n,o,f.SheetArea.rowHeader))&&s.setFormula(n,o,a,f.SheetArea.viewport);g.getSpans().forEach((function(t){d.add(t)})),s.frozenColumnCount(t),l.dWa(m,r.Worksheet.Tp,f.SheetArea.rowHeader),l.fWa(!1,f.SheetArea.rowHeader),l.eWa(f.SheetArea.rowHeader),s.Bj(f.SheetArea.rowHeader).clearAll()},toJSON:function(t){var e,o,n,i,a,l,u,h,p,d,m,w,T,S,x,A,I,R,k,N,O,D=this,F=t&&t.ignoreStyle;for(w in t&&!t.Yec&&(e=D.getRowCount(f.SheetArea.colHeader),o=D.getColumnCount(f.SheetArea.rowHeader),n=t.rowHeadersAsFrozenColumns,a=t.columnHeadersAsFrozenRows&&e>0,(i=n&&o>0)&&D.addColumns(0,o),a&&D.addRows(0,e,a),i&&D.Zec(o,a?e:0),a&&D.$ec(e,i?o:0)),l=D.getRowCount(),u=D.getColumnCount(),h=D.getRowCount(f.SheetArea.colHeader),p=D.getColumnCount(f.SheetArea.rowHeader),d={name:t&&t.newWorkSheetName||D.name(),isSelected:D.DHb(),rowCount:l,columnCount:u,activeRow:D.Jl,activeCol:D.Kl,zoomFactor:D.zoom(),rowHeaderColCount:p,colHeaderRowCount:h,visible:D.visible()},F||(d.frozenRowCount=D.frozenRowCount(),d.frozenColCount=D.frozenColumnCount(),d.frozenTrailingRowCount=D.frozenTrailingRowCount(),d.frozenTrailingColCount=D.frozenTrailingColumnCount(),d.frozenTrailingRowStickToEdge=D.qKc,d.frozenTrailingColumnStickToEdge=D.tKc,d.theme=D.Pm.toJSON()),m=D.ITa.toJSON(t))d[w]=m[w];for(S in g&&y(g,(function(e,o){o.toJson&&o.toJson.call(D,d,t)})),T={},d)v(d,S)&&(x=d[S],b(x)||M(S,x)||(T[S]=x));if(function(t,e){var o,n,r,i,a,s,l,u,c,f=t.ITa.ZHb.anchors;for(o in f)if(n=+o,r=f[o],i=e[n],r&&i)for(a in r)s=+a,(l=r[a])&&(u=i[s])&&(c={row:l.row,rowCount:l.rowCount,col:l.col,colCount:l.colCount,isDynamicArray:!0},l.isValid||(c.isInvalid=!0),u.arrayInfo=c)}(D,d.data.dataTable),y(D.options,(function(t,e){var o,n,i,a=e;"gridline"===t&&(a={},o=e.color,n=e.showHorizontalGridline,i=e.showVerticalGridline,o&&o!==s.Im.Lm("gc-gridlineColor").borderTopColor&&(a.color=o),!1===n&&(a.showHorizontalGridline=n),!1===i&&(a.showVerticalGridline=i)),"sheetAreaOffset"===t&&(a={},e.left&&(a.left=e.left),e.top&&(a.top=e.top)),"_ps"===t||b(a)||r.Worksheet.Qp[t]===a||"object"==typeof a&&C(a)||(T[t]=a)})),A=[],I=D.Lq){for(R in I)v(I,R)&&((k=I[R])&&(N=k.toJSON(),O=k.font,C(N)||(O&&(N.font=c.To.Jo(O)),A.push(N))));A.length>0&&(T.namedStyles=A)}return T},fromJSON:function(t,e,o,n,s){var u,c,h,g,y,C,b,A,M,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt;if(o&&(u=o.noSchema,c=o.version),t){g=(h=this).ITa,y=n&&n.ignoreStyle,h.T3(),r.Worksheet.ao(h,"preFromJson"),h.suspendPaint(),g.wgc(),g.xgc(),C=d.culture(),d.culture(""),b=k(t.rowCount,r.Worksheet.Rp),A=k(t.columnCount,r.Worksheet.Sp);try{if(h.cq(t.name+"",!0),h.DHb(t.isSelected),h.setRowCount(b),h.setColumnCount(A),h.Lq={},M=t.namedStyles)for(D=0;D<M.length;D++)F=M[D],E=new i.Style,a(F,h),E.fromJSON(F,u,h),h.Kq(E);for(P in j=h.options)if(v(j,P)&&(L=t[P],"protectionOptions"===P?L=L||t.protectionOption:"allowCellOverflow"===P&&(L=m(t[P])?t[P]:!c||c>=11),m(L)))if("object"==typeof L)for(G in L)v(L,G)&&(j[P][G]=L[G]);else"borderWidth"===P?(j.sheetAreaOffset.left=L,j.sheetAreaOffset.top=L):j[P]=L;if(B=k(t.activeRow,h.Jl),_=k(t.activeCol,h.Kl),h.Kr(B,_,x,x,!0),y||(N(h,h.frozenRowCount,t.frozenRowCount),N(h,h.frozenColumnCount,t.frozenColCount),N(h,h.frozenTrailingRowCount,t.frozenTrailingRowCount),N(h,h.frozenTrailingColumnCount,t.frozenTrailingColCount),h.qKc=!m(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,h.tKc=!m(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!y){if(V=t.colStyles)for(H in V)S(H)||h.setStyle(-1,T(H,10),V[H],f.SheetArea.viewport);if(z=t.rowStyles)for(U in z)S(U)||h.setStyle(T(U,10),-1,z[U],f.SheetArea.viewport)}W=k(t.rowHeaderColCount,r.Worksheet.Tp),q=k(t.colHeaderRowCount,r.Worksheet.Vp),h.setColumnCount(W,f.SheetArea.rowHeader),h.setRowCount(q,f.SheetArea.colHeader),h.XSa(k(t._zoomFactor||t.zoomFactor,h.zoom())),N(h,h.visible,t.visible),J=h.uja,X={sheet:h,setValidator:function(t,e,o){J&&J.vja(t,e,o)},ignoreStyle:y},g.fromJSON(t,u,X),h.defaults=g.defaults,J&&J.QV(!0),(Z=t.theme)&&!y&&(typeof(Y=Z)!==w&&m(Y)&&("_themeColor","_name",K=Y.themeColor||Y._themeColor,(Q=new l.ColorScheme(K.name||K._name)).fromJSON(K,u),Y=new l.Theme(Y.name||Y.Cj,Q,Y.headingFont||Y.Vaa,Y.bodyFont||Y.Waa)),h.currentTheme(Y)),O(h,t,u,n,e,s),$=n&&n.frozenColumnsAsRowHeaders,et=(tt=n&&n.frozenRowsAsColumnHeaders)&&t.frozenRowCount||0,ot=$&&t.frozenColCount||0,tt&&et>0&&I(h,t,et,ot),$&&ot>0&&R(h,t,ot,et),p&&(nt=h.yj(),et>0&&(nt.cDc=et),ot>0&&(nt.dDc=ot)),s||(et>0&&h.deleteRows(0,et),ot>0&&h.deleteColumns(0,ot)),h.clearPendingChanges()}finally{d.culture(C),g.ygc(),h.resumePaint()}}},egc:function(t,e,o,n,s){var u,c,h,g,y,C,b,A,M,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q;if(o&&(u=o.noSchema,c=o.version),t){g=(h=this).ITa,y=n.ignoreStyle,h.T3(),r.Worksheet.ao(h,"preFromJson"),g.wgc(),g.xgc(),C=d.culture(),d.culture(""),k(t.rowCount,r.Worksheet.Rp),k(t.columnCount,r.Worksheet.Sp);try{if(h.Lq={},b=t.namedStyles)for(A=0;A<b.length;A++)M=b[A],D=new i.Style,a(M,h),D.fromJSON(M,u,h),h.Kq(D);for(E in F=h.options)if(v(F,E)&&(j=t[E],"protectionOptions"===E?j=j||t.protectionOption:"allowCellOverflow"===E&&(j=m(t[E])?t[E]:!c||c>=11),m(j)))if("object"==typeof j)for(P in j)v(j,P)&&(F[E][P]=j[P]);else"borderWidth"===E?(F.sheetAreaOffset.left=j,F.sheetAreaOffset.top=j):F[E]=j;if(L=k(t.activeRow,h.Jl),G=k(t.activeCol,h.Kl),h.Kr(L,G,x,x,!0),y||(N(h,h.frozenRowCount,t.frozenRowCount),N(h,h.frozenColumnCount,t.frozenColCount),N(h,h.frozenTrailingRowCount,t.frozenTrailingRowCount),N(h,h.frozenTrailingColumnCount,t.frozenTrailingColCount),h.qKc=!m(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,h.tKc=!m(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!y){if(B=t.colStyles)for(_ in B)S(_)||h.setStyle(-1,T(_,10),B[_],f.SheetArea.viewport);if(V=t.rowStyles)for(H in V)S(H)||h.setStyle(T(H,10),-1,V[H],f.SheetArea.viewport)}z=k(t.rowHeaderColCount,r.Worksheet.Tp),U=k(t.colHeaderRowCount,r.Worksheet.Vp),h.setColumnCount(z,f.SheetArea.rowHeader),h.setRowCount(U,f.SheetArea.colHeader),h.XSa(k(t._zoomFactor||t.zoomFactor,h.zoom())),W=h.uja,q={sheet:h,setValidator:function(t,e,o){W&&W.vja(t,e,o)},ignoreStyle:y,incrementalLoading:n.incrementalLoading,incrementLoadTask:n.incrementLoadTask},g.fromJSON(t,u,q,(function(){var o,r,i,a,c,f,v,b,T;h.defaults=g.defaults,W&&W.QV(!0),(o=t.theme)&&!y&&(typeof(r=o)!==w&&m(r)&&("_themeColor","_name",i=r.themeColor||r._themeColor,(a=new l.ColorScheme(i.name||i._name)).fromJSON(i,u),r=new l.Theme(r.name||r.Cj,a,r.headingFont||r.Vaa,r.bodyFont||r.Waa)),h.currentTheme(r)),O(h,t,u,n,e,s),c=n&&n.frozenColumnsAsRowHeaders,v=(f=n&&n.frozenRowsAsColumnHeaders)&&t.frozenRowCount||0,b=c&&t.frozenColCount||0,f&&v>0&&I(h,t,v,b),c&&b>0&&R(h,t,b,v),p&&(T=h.yj(),v>0&&(T.cDc=v),b>0&&(T.dDc=b)),s||(v>0&&h.deleteRows(0,v),b>0&&h.deleteColumns(0,b)),h.clearPendingChanges(),d.culture(C),g.ygc(),h.loaded=!0}))}finally{}}}})},"./dist/core/worksheet/worksheet-model.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Q=this&&this.__rest||function(t,e){var o,n,r={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&(r[o[n]]=t[o[n]]);return r};function $(t,e){return D(t)?e:t}function tt(t,e){return t.hasOwnProperty(e)}function et(t){return t.rowCount}function ot(t){return t.colCount}function nt(t,e,o,n){var r=o;Object.defineProperty(t,e,{get:function(){return r},set:function(t){var o=r;r=t,n(this,t,e,o)}})}function rt(t,e){t.cache={},e&&e.forEach((function(e){it(t,e)}))}function it(t,e){var o,n;if(t.Ef=S(t.Ef,e.row+et(e)-1),t.Ff=S(t.Ff,e.col+ot(e)-1),!t.suspendUpdatingCache)for(o=0;o<e.rowCount;o++)for(n=0;n<e.colCount;n++)t.cache[e.row+o+"_"+(e.col+n)]=e}function at(t,e){var o,n;if(!t.suspendUpdatingCache)for(o=0;o<e.rowCount;o++)for(n=0;n<e.colCount;n++)t.cache[e.row+o+"_"+(e.col+n)]=v}function st(t,e,o){var n,r,i,a,l=s.kf(-1,-1,-1,-1);return t&&(n=t.col,i=-1===(r=t.row),a=-1===n,l.row=i?0:r,l.rowCount=i?e:et(t),l.col=a?0:n,l.colCount=a?o:ot(t)),l}function lt(t,e,o,n,r){var i,a,s=t.length;for(a=0;a<s;a++)if(i=t[a],D(e)||D(o)?D(e)?D(o)?D(n)?i.containsY(r):i.containsX(n):i.col===o:i.row===e:i.contains(e,o))return i;return C}function ut(t,e,o){var n=C,r=t.length,i=!D(e);return r>0&&((n=i?t.findX(e):t.findY(o))||(n=i&&e<t[0].x||!i&&o<t[0].y?t[0]:t[r-1])),n}function ct(t,e,o,n,r,i,a,s){var l,u,c,f,h,p,d,g,m,y,C,v=r&&r.incrementLoadTask;if(v&&!v.isTerminated){for(l=v.isBusyFunc,u=a=a||0,c=!1,30,f=new Date;u<o;){if(h=e[u])for(p=0;p<n;p++)(d=h[p])&&(c=!0,pt(d,t.RTa(u,p,!0),i,u,p,r));if(u++,l&&l())break;if(new Date-f>30)break}if(c){if(g=r&&r.sheet,0!==a&&g.parent.getActiveSheet()===g)for(m=a;m<u;m++)if(g.as.viewport[1].findRow(m)){g.repaint();break}(y=r&&r.incrementalLoading)&&y.loading&&(y.loadStatus.valuesLoad+=u-a,C=function(t,e){var o=t.valuesLoad/t.total;return e?.4*o+.1:.3*o+.1}(y.loadStatus,r.doNotRecalculateAfterLoad),y.loading(C,{sheet:g}))}u<o?r.incrementLoadTask.pushTask(ct,[t,e,o,n,r,i,u,s]):s&&r.incrementLoadTask.pushTask(s,[])}}function ft(t,e,o,n,r,i,a,s){o>=0&&n>=0?(i[o]||(i[o]={}),i[o][n]=r):o>=0&&-1===n&&t>=0&&-1===e?a[o]=r:n>=0&&-1===o&&e>=0&&-1===t&&(s[n]=r)}function ht(t,e,o,n,r,i,a){if(o>=0&&n>=0){i[o]||(i[o]={}),i[o].rs="e";var s=i[o];s.originalItem=a,s[n]=r}}function pt(t,e,o,n,i,s){var u,c,f,h,d,g,m,y,w,T,S;t&&((u=t.value)!==v&&(u!==C&&(u._calcError||u._error&&!D(u._code))&&((c=p&&a.CalcError.parse(u._calcError||u._error))!==v&&(u=c=E(c))),e.value=u),f=t.style,h=s&&s.sheet,f===v||s.ignoreStyle||(d=C,typeof f===b?(e.style=f,d=h&&(h.Mq(f,!1)||h.parent&&h.parent.Mq(f,!1))):f&&((d=new r.Style).fromJSON(f,o),d.name=v,e.style=d),d&&d.validator&&s&&s.setValidator&&s.setValidator(n,i,d.validator)),(g=t.visualState)!==v&&(e.visualState=g),(m=t.bindingPath)!==v&&(e.bindingPath=m),(y=t.tag)!==v&&(typeof(w=y.typeName)===b&&((T=l.getTypeFromString(w))&&((y=new T).fromJSON&&y.fromJSON(t.tag))),e.tag=y),(S=t.hyperlink)!==v&&(e.hyperlink=P(S)))}function dt(t,e){for(var o,n,r,i,a,s=e[0],l=t,u=0;u<s.length-1;u++)(o=s[u])===A?l=l.Ap:(l[o]||(l[o]={}),l=l[o]);l[s[u]]=e[1],n=s[s.length-1],i=s[s.length-2],a=s[1],"size"===n?r=s[0]===R?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth:"visible"===n&&(r=s[0]===R?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible),D(r)||t.zgc({type:r,index:i,sheetArea:a})}function gt(t,e,o){var n=t.WTa>0?[["selectionModel"],v]:v;t.selectionModel.setProperty(e,o,n),n&&t.zTa.push(n)}function mt(t,e,o,n,r){void 0===r&&(r=!1);var i=t[e];return r?void(i&&delete i[o]):(i||(i=t[e]={}),void(i[o]=n))}function yt(t,e,o,n){mt(t,e,o,{value:n})}function Ct(t,e,o,n,r,i){mt(t,e,o,{value:n,oldValue:r,isAnchorCell:i})}function vt(t,e,o,n){var r,i=t[e],a=i&&i[o];return a?a.value:(yt(t,e,o,r=n.getValue(e,o)),r)}function bt(t,e){return[t,e].join(",")}function wt(t,e){-1===t.indexOf(e)&&t.push(e)}function Tt(t,e){var o,n=Array(e);for(o=0;o<e;o++)n[o]=t;return n}function St(t,e,o){var n=t[e];return n&&n[o]}function xt(t,e){var o=e.split(",").map((function(t){return+t})),n=o[0],r=o[1],i=t[n];return i&&i[r]}function At(t,e,o,n){var r=t[e];r&&delete r[o],n&&g(r)&&delete t[e]}function It(t,e,o,n,r){var i,s,l,u,c,f,h,p,d=t.XTa(3),g=t.ZHb,m=g.anchors,y=[];for(i in m)if(m.hasOwnProperty(i)&&(s=m[i]))for(l in s)s.hasOwnProperty(l)&&((u=s[l])&&(c=u.row,f=u.col,h=u.rowCount,p=u.colCount,(r?c+h:f+p)>=e&&(u.isValid&&d.yIb(u),(r?c:f)<e&&y.push(u))));y.length&&a.markAnchorCellDirty(y,t.kj.Bj(),g)}function Rt(t){return t?t.filter((function(t){return!t.isAutoMerge})):t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("./dist/core/worksheet/style.js"),i=o("Common"),a=o("@grapecity/js-calc"),s=o("./dist/core/util/common.js"),l=o("./dist/core/util/common.js"),u=o("./dist/core/util/domUtil.js"),c=o("./dist/core/core.enum.js"),f=o("@grapecity/js-calc"),h=o("./dist/core/celltype/celltype.ns.js"),p=!!f,d=u.GC$.each,g=u.GC$.isEmptyObject,m=u.GC$.extend,y=RegExp("^\\d*(\\.\\d+)?\\*$"),C=null,v=void 0,b="string",w=Math.min,T=Math.floor,S=Math.max,x=Math.ceil,A="dirtyNodes",I="undo",R="rowInfos",M="colInfos",k="default_size",N=i.Common.A,O=i.Common.B,D=i.Common.j.Fa,F=s.util.K_a,E=s.util.n0a,j=s.util.lHb,P=i.Common.j.C4,L=new i.Common.ResourceManager(n.SR),G=L.getResource.bind(L),B=function(){function t(){nt(this,"spans",[],rt),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}return t.prototype.find=function(t,e){return this.cache[t+"_"+e]||C},t.prototype.get=function(t,e){return this.find(t,e)||s.kf(t,e,1,1)},t.prototype.remove=function(t,e){var o=this.spans.indexOf(t);o>=0?(e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),this.removeSpan(o,1)):e&&(e.length=0)},t.prototype.removeSpan=function(t,e){for(var o=0;o<e;o++)at(this,this.spans[t+o]);this.spans.splice(t,e)},t.prototype.update=function(t,e){var o=this;at(o,o.spans[t]),o.spans[t]=e,it(o,e)},t.prototype.add=function(t,e){e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),it(this,t),this.spans.push(t)},t.prototype.Zz=function(t,e,o,n,r,i,a){var l,u,c,f,h,p,d,g=this,m=!1;for(a&&(l=[].concat(g.spans)),u=g.spans.length,d=[],p=0;p<u;p++)h=(c=g.spans[p]).col,f=c.row,(-1===t||t<=f&&f<t+r)&&(-1===e||e<=h&&h<e+i)?(d.push(s.kf(-1===t?f:o+f-t,-1===e?h:n+h-e,et(c),ot(c))),m=!0):(-1===t||o<=f&&f<o+r)&&(-1===e||n<=h&&h<n+i)&&(g.removeSpan(p,1),p--,u--,m=!0);for(p=0;p<d.length;p++){if(c=d[p],!g.LTa(g.spans,0,g.spans.length,c))throw Error(G().Exp_OverlappingSpans);g.add(c)}a&&(m?(a[0].push("spans"),a[1]=l):a.length=0)},t.prototype.LTa=function(t,e,o,n){for(var r=e;r<o&&r<t.length;r++)if(t[r].intersect(n.row,n.col,et(n),ot(n)))return!1;return!0},t.prototype.getSpans=function(t){var e,o,n,r=this.spans;if(!t)return[].concat(r);for(e=[],o=0;o<r.length;o++)(n=r[o]).intersect(t.row,t.col,et(t),ot(t))&&e.push(n);return e},t.prototype.qu=function(t,e,o,n){var r,i,a=this.spans;for(r=0;r<a.length;r++)if((i=a[r]).intersect(t,e,o,n)&&(-1!==t&&(i.row<t||i.row+et(i)>t+o)||-1!==e&&(i.col<e||i.col+ot(i)>e+n)))return!0;return!1},t.prototype.MTa=function(t,e,o,n){var r,i,a=!1,s=this.spans;for(r=0,i=s.length;r<i;r++){if(t>=0||e>=0)for(;r<i&&!s[r].intersect(t,e,o,n);)r++;if(r<i){a=!0;break}}return a},t.prototype.$b=function(t,e,o,n,r){var i,a,s,l,u,c=this.spans,f=!1;for(r&&(i=[].concat(c)),a=0;a<c.length;a++)l=(s=c[a]).row,u=s.col,(-1===t||t<=l&&l<t+o)&&(-1===e||e<=u&&u<e+n)&&(this.removeSpan(a,1),a--,f=!0);r&&(f?(r[0].push("spans"),r[1]=i):r.length=0)},t.prototype.aB=function(t,e,o,n,r,i,a){var l,u,c,f,h,p,d,g,m,y=this,C=!1;for(a&&(l=[].concat(y.spans)),u=[],c=[],f=y.spans.length,g=0;g<f;g++)p=(h=y.spans[g]).row,d=h.col,(-1===t||t<=p&&p<t+r)&&(-1===e||e<=d&&d<e+i)?(m=s.kf(-1===t?p:o+p-t,-1===e?d:n+d-e,et(h),ot(h)),c.push(m),C=!0):(-1===t||o<=p&&p<o+r)&&(-1===e||n<=d&&d<n+i)?C=!0:u.push(h);if(C){if(c.length>0)for(g=0;g<c.length;g++){if(m=c[g],!y.LTa(u,0,u.length,m))throw Error(G().Exp_OverlappingSpans);u.push(m)}for(y.spans.length=0,y.cache={},g=0;g<u.length;g++)y.add(u[g]);a&&(a[0].push("spans"),a[1]=l)}else a&&(a.length=0)},t.prototype.NTa=function(t,e,o){var n,r,i,a,l,u,c,f,h,p=this,d=p.spans;for(p.suspendUpdatingCache=!0,n=!1,o&&(r=[].concat(d)),i=d.length,a=0;a<i;a++)u=(l=d[a]).row,c=l.col,f=et(l),h=ot(l),u>=t?(p.update(a,s.kf(u+e,c,f,h)),n=!0):t<u+f&&(p.update(a,s.kf(u,c,f+e,h)),n=!0);p.suspendUpdatingCache=!1,n&&rt(p,d),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},t.prototype.OTa=function(t,e,o){var n,r,i,a,l,u,c,f,h,p=this,d=p.spans;for(p.suspendUpdatingCache=!0,n=!1,o&&(r=[].concat(d)),i=d.length,a=0;a<i;a++)u=(l=d[a]).row,c=l.col,f=et(l),h=ot(l),c>=t?(p.update(a,s.kf(u,c+e,f,h)),n=!0):t<c+h&&(p.update(a,s.kf(u,c,f,h+e)),n=!0);p.suspendUpdatingCache=!1,n&&rt(p,d),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},t.prototype.PTa=function(t,e,o){var n,r,i,a,l,u,c,f,h,p,d,g,m=this,y=m.spans;for(m.suspendUpdatingCache=!0,n=!1,o&&(r=[].concat(y)),i=[],a=y.length,l=0;l<a;l++)c=(u=y[l]).row,f=u.col,h=et(u),p=ot(u),c>=t?c<t+e?c+h<=t+e?(i.push(l),n=!0):(m.update(l,s.kf(t,f,c+h-(t+e),p)),n=!0):(m.update(l,s.kf(c-e,f,h,p)),n=!0):t<c+h&&(d=s.kf(c,f,h-w(c+h-t,e),p),m.update(l,d),1===d.rowCount&&1===d.colCount&&i.push(l),n=!0);for(l=i.length-1;l>=0;l--)g=i[l],m.removeSpan(g,1);m.suspendUpdatingCache=!1,n&&rt(m,y),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},t.prototype.QTa=function(t,e,o){var n,r,i,a,l,u,c,f,h,p,d,g,m=this,y=m.spans;for(m.suspendUpdatingCache=!0,n=!1,o&&(r=[].concat(y)),i=[],a=y.length,l=0;l<a;l++)c=(u=y[l]).row,f=u.col,h=et(u),p=ot(u),f>=t?f<t+e?f+p<=t+e?(i.push(l),n=!0):(m.update(l,s.kf(c,t,h,f+p-(t+e))),n=!0):(m.update(l,s.kf(c,f-e,h,p)),n=!0):t<f+p&&(d=s.kf(c,f,h,p-w(f+p-t,e)),m.update(l,d),1===d.rowCount&&1===d.colCount&&i.push(l),n=!0);for(l=i.length-1;l>=0;l--)g=i[l],m.removeSpan(g,1);m.suspendUpdatingCache=!1,n&&rt(m,y),o&&(n?(o[0].push("spans"),o[1]=r):o.length=0)},t.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?v:t},t.prototype.fromJSON=function(t){var e,o,n;if(t)for(this.spans=[],e=t,o=0;o<e.length;o++)n=e[o],this.add(s.kf(n.row,n.col,et(n),ot(n)))},t}(),_=function(){function t(){Array.apply(this,arguments)}return t.prototype.pop=function(){return C},t.prototype.push=function(t){return 0},t.prototype.splice=function(t,e){var o,n=[];for(o=2;o<arguments.length;o++)n[o-2]=arguments[o];return C},t.prototype.slice=function(t,e){return null},t}(),_.prototype=[],V=function(t){function e(){var e=t.call(this)||this;return e.headingOverflowlayouts=C,e.trailingOverflowLayouts=C,e}return K(e,t),e.prototype.find=function(t){var e,o,n=this.length,r=[];for(o=0;o<n;o++)(e=this[o]).contains(t)&&r.push(e);return r},e}(_),e.np=V,H=function(){function t(t,e,o,n,r,i,a,s){var l=this;l.column=t,l.startColumn=e,l.endColumn=o,l.valueWidth=n,l.columnWidth=r,l.backgroundWidth=i,l.backgroundLeftWidth=a,l.backgroundRightWidth=s}return t.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},t}(),e.op=H,z=function(){function t(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return t.prototype.getProperty=function(t){return this[t]},t.prototype.setProperty=function(t,e,o){o&&(o[0].push(t),o[1]=this[t]),this[t]=e},t.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},t.prototype.add=function(t,e,o,n,r){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var i=this,a=i.selectionPolicy,l=i.selectionUnit;0===a?(o=w(o,1),n=w(n,1),i.clear()):1===a&&i.clear(),1===l?(e=-1,n=-1):2===l&&(t=-1,o=-1),i.selections.push(s.kf(t,e,o,n)),i.activeSelectedRangeIndex=i.selections.length-1},t.prototype.get=function(){return[].concat(this.selections)},t.prototype.set=function(t,e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},t.prototype.toJSON=function(){var t,e=this,o={},n=e.selectionPolicy,r=e.selectionUnit,i=e.activeSelectedRangeIndex,a=e.selections.length;for(2!==n&&(o.selectionPolicy=n),0!==r&&(o.selectionUnit=r),0!==i&&(o.activeSelectedRangeIndex=i),o.length=a,t=0;t<a;t++)o[t]=e.selections[t];return g(o)?v:o},t.prototype.fromJSON=function(t,e,o){var n,r,i,a,l,u,c,f,h=e||200,p=o||20;if(t){for((i=this).clear(),a=t.selectionPolicy,l=t.selectionUnit,u=t.length,D(u)&&(u=1),c=0;c<u;c++)f=t[c],n=w(f?et(f):1,h),r=w(f?ot(f):1,p),i.selections.push(s.kf(f?f.row:0,f?f.col:0,n,r));i.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,D(a)||(i.selectionPolicy=a),D(l)||(i.selectionUnit=l)}},t.prototype.sp=function(t){var e,o,n,r=this.selections;for(e=0;e<r.length;e++)if(n=-1===(o=r[e]).col?0:o.col,-1===o.row&&t>=n&&t<n+ot(o))return!0;return!1},t.prototype.tp=function(t){var e,o,n,r=this.selections;for(e=0;e<r.length;e++)if(n=-1===(o=r[e]).row?0:o.row,-1===o.col&&t>=n&&t<n+et(o))return!0;return!1},t.prototype.vp=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d=!1,g=this.selections,m=i?1:0;for(a=0,s=g.length;a<s&&(c=(u=st(l=g[a],n,r)).row,f=u.col,h=c-m<=t&&t<c+et(u)+m,p=f-m<=e&&e<f+ot(u)+m,3===o||D(o)?d=h&&p:2===o?d=h:1===o?d=p:0===o&&(d=-1===l.row&&-1===l.col),!d);a++);return d},t.prototype.wp=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g=this.selections,m=!1;for(i=0;i<g.length&&(s=(a=g[i]).row,l=a.col,u=et(a),c=ot(a),f=-1===l,h=-1===s,D(o)||3===o||(2===o?(p=h?0:s,m=f&&t>=p&&t<p+u):1===o?(d=f?0:l,m=h&&e>=d&&e<d+c):0===o&&(m=h&&f&&u===n&&c===r),!m));i++);return m},t}(),U=function(t){function e(){return t.call(this)||this}return K(e,t),e.prototype.findCell=function(t,e){var o,n,r=this.length;for(n=0;n<r;n++)if((o=this[n]).contains(t,e))return o;return C},e.prototype.findRow=function(t){var e,o,n=this.length;for(o=0;o<n;o++)if((e=this[o]).row===t)return e;return C},e.prototype.findCol=function(t){var e,o,n=this.length;for(o=0;o<n;o++)if((e=this[o]).col===t)return e;return C},e.prototype.findX=function(t){return lt(this,v,v,t)},e.prototype.findY=function(t){return lt(this,v,v,v,t)},e.prototype.findNearX=function(t){return ut(this,t)},e.prototype.findNearY=function(t){return ut(this,v,t)},e}(_),e.yp=U,W=function(){function t(t,e,o,n,r,i,a,s,l){var u=this;u.rowCount=a,u.colCount=s,u.row=t,u.col=e,u.x=o,u.y=n,u.width=r,u.height=i,u.isAutoMerge=l}return t.prototype.contains=function(t,e){var o=this;return t<o.row+et(o)&&o.row<=t&&e<o.col+ot(o)&&o.col<=e},t.prototype.intersect=function(t){var e=this;return(e.x<0||t.x<e.x+e.width&&e.x<t.x+t.width)&&(e.y<0||t.y<e.y+e.height&&e.y<t.y+t.height)},t.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},t.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},t}(),e.zp=W,q=function(){function t(t,e){var o=this;o.Xj=t,o.OZ=e,o.ad()}return t.prototype.ad=function(){var t=this;t.dataTable={},t.rowDataArray=[],t.columnDataArray=[],t.defaultDataNode=C,t.Ap={},t.gga=0,t.Ff=-1,t.Ef=-1},t.prototype.getRowCount=function(){return this.Xj},t.prototype.getColumnCount=function(){return this.OZ},t.prototype.setRowCount=function(t){this.Xj=t},t.prototype.setColumnCount=function(t){this.OZ=t},t.prototype.Cp=function(t,e,o,n){var r,i,a,s,l=this.Ap;this.gga>0||t>=0&&e>=0&&(n&&(n.type="updateDirty",n.row=t,n.col=e,l[t]?l[t][e]||(n.isEmptyCol=!0):n.isEmptyRow=!0),l[t]||(l[t]={}),(r=l[t])[e]||(r[e]={}),i=r[e],"n"!==r.rs&&(r.rs="e"),a=o.Dp,s=o.Ep,D(a)||(n&&(n.originalItem=r.originalItem),r.originalItem=a),D(s)||(n&&(n.oldValue=i.oldValue),i.oldValue=s))},t.prototype.gWa=function(t){var e=this.Ap,o=t.row,n=t.col;t.isEmptyRow&&e?delete e[o]:t.isEmptyCol&&e[o]?delete e[o][n]:(t.hasOwnProperty("originalItem")&&(D(t.originalItem)&&!D(e[o].originalItem)?delete e[o].originalItem:e[o].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&e[o]&&(D(t.oldValue)&&!D(e[o][n].oldValue)?delete e[o][n].oldValue:e[o][n].oldValue=t.oldValue))},t.prototype.getValue=function(t,e,o){var n=this.RTa(t,e);return n&&!D(n.value)?1!==o?F(n.value):D(n.value.richText)?n.value:m(!0,{},n.value):C},t.prototype.setValue=function(t,e,o,n,r){var i,a=this.RTa(t,e,!0,n?n[0]:v);!a||D(a.value)&&D(o)||a.value===o?n&&(n.length=0):(i=a.value,a.value=o,this.Cp(t,e,{Ep:i},r),n&&(n[0].push("value"),n[1]=i))},t.prototype.getStyle=function(t,e,o){var n=this.RTa(t,e),r=n&&n.style;return r&&o&&r.clone&&(r=r.clone(!0)),r},t.prototype.setStyle=function(t,e,o,n){var r,i=this.RTa(t,e,!0,n?n[0]:v);i&&i.style!==o?(r=i.style,i.style=o,n&&(n[0].push("style"),n[1]=r)):n&&(n.length=0)},t.prototype.getCellState=function(t,e){var o=this.RTa(t,e);return o?o.cellState:C},t.prototype.setCellState=function(t,e,o,n){var r,i,a=this.getCellState(t,e)||0;0!==(r=n?a|o:a&~o)?(i=this.RTa(t,e,!0,v,!0))&&(i.cellState=r):((i=this.RTa(t,e))&&delete i.cellState,g(i)&&(At(this.dataTable,t,e),g(this.dataTable[t])&&delete this.dataTable[t]))},t.prototype.getValueForKey=function(t,e,o){var n=this.RTa(t,e);return n&&n[o]},t.prototype.setValueForKey=function(t,e,o,n,r){var i,a=this.RTa(t,e,!0,r?r[0]:v);a&&a[o]!==n?(i=a[o],a[o]=n,r&&(r[0].push(o),r[1]=i)):r&&(r.length=0)},t.prototype.NTa=function(t,e,o){var n,r=this,i=r.Xj,a=r.dataTable,s=r.Ap;if(0<=t&&t<=i&&e>=0&&(N(a,i,t,e),N(r.rowDataArray,i,t,e),N(s,i,t,e),r.Xj+=e,!o))for(n=0;n<e;n++)a[t+n]={rs:"n"},s[t+n]={rs:"n"}},t.prototype.STa=function(t,e,o){var n,r,i=this,a=i.Xj;if(0<=t&&t<a&&e>0){if(t+e>a&&(e=a-t),o)for(n=0;n<e;n++)r=t+n,o.push([["dataTable",r],i.dataTable[r]]),o.push([["rowDataArray",r],i.rowDataArray[r]]),o.push([[A,r],i.Ap[r]]);O(i.dataTable,a,t,e),O(i.rowDataArray,a,t,e),O(i.Ap,a,t,e),i.Xj-=e}},t.prototype.OTa=function(t,e){var o,n,r=this,i=r.OZ;if(0<=t&&t<=i&&e>=0){for(o=0;o<r.Xj;o++)(n=r.dataTable[o])&&t<i&&N(n,i,t,e);N(r.columnDataArray,i,t,e),r.OZ+=e}},t.prototype.TTa=function(t,e,o){var n,r,i,a,s,l,u=this,c=u.OZ;if(0<=t&&t<c&&e>0){for(n=0;n<u.Xj;n++)if(r=u.dataTable[n]){if(o)for(i=0;i<e;i++)a=t+i,o.push([["dataTable",n,a],r[a]]);O(r,c,t,e)}if(o)for(s=0;s<e;s++)l=t+s,o.push([["columnDataArray",l],u.columnDataArray[l]]);O(u.columnDataArray,c,t,e),t+e>c&&(e=c-t),u.OZ-=e}},t.prototype.RTa=function(t,e,o,n,r){var i,a=this,s=a.dataTable,l=a.columnDataArray,u=a.rowDataArray,c=C;return t<a.Xj&&e<a.OZ&&(t>=0&&e>=0?(i=s[t],o&&(i||(i=s[t]={}),!r&&t>a.Ef&&(a.Ef=t)),i&&(c=i[e],o&&(c||(c=i[e]={}),!r&&a.Ff<e&&(a.Ff=e))),n&&n.push("dataTable",t,e)):-1===t&&e>=0?(c=l[e],o&&(c||(c=l[e]={}),!r&&a.Ff<e&&(a.Ff=e)),n&&n.push("columnDataArray",e)):t>=0&&-1===e?(c=u[t],o&&(c||(c=u[t]={}),!r&&a.Ef<t&&(a.Ef=t)),n&&n.push("rowDataArray",t)):-1===t&&-1===e&&(c=a.defaultDataNode,o&&!c&&(c=a.defaultDataNode={}),n&&n.push("defaultDataNode"))),c},t.prototype.setNode=function(t,e,o){var n,r=this,i=r.dataTable,a=r.columnDataArray,s=r.rowDataArray;t<r.Xj&&e<r.OZ&&(t>=0&&e>=0?((n=i[t])||(n=i[t]={}),n[e]=o):-1===t&&e>=0?a[e]=o:-1===e&&t>=0&&(s[t]=o))},t.prototype._f=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y;r&&(i=[],a=[]),l=(s=this).dataTable,u=s.rowDataArray,c=s.columnDataArray,f=s.Ap,h=s.RTa(t,e,v,i),p=f[t]&&f[t][e],d=f[t]&&f[t].originalItem,g=s.RTa(o,n,v,a),m=f[o]&&f[o][n],y=f[o]&&f[o].originalItem,r&&(r.push([i,h]),r.push([a,g])),h?ft(t,e,o,n,h,l,u,c):g&&ft(t,e,o,n,C,l,u,c),g?ft(o,n,t,e,g,l,u,c):h&&ft(o,n,t,e,C,l,u,c),p?ht(0,0,o,n,p,f,d):m&&ht(0,0,o,n,C,f,d),m?ht(0,0,t,e,m,f,y):p&&ht(0,0,t,e,C,f,y)},t.prototype.Yea=function(t){t++;for(var e=this.Xj,o=this.dataTable;t>=0&&t<e&&!o[t];)t++;return t<e?t:-1},t.prototype.Hl=function(t,e){var o=this,n=C,r=o.OZ;if(t>=0&&t<o.Xj&&(n=o.dataTable[t]),n){for(e++;e>=0&&e<r&&!n[e];)e++;if(e<r)return e}return-1},t.prototype.yIb=function(t){var e,o,n,r,i,a=t.row,s=t.col,l=t.rowCount,u=t.colCount;for(e=a,o=0;o<l;o++,e++)for(n=s,r=0;r<u;r++,n++)(i=this.RTa(e,n))&&(i.value=C)},t.prototype._Sb=function(t,e,o){var n=o&&o.getFormatter(t,e);return!!j(n)&&n},t.prototype.clear=function(t,e,o,n,r,a,s){var l,u,c,f,h,p,d,g=this,m=g.Xj,y=g.OZ,b=[],T=!!s,S=[];if(t>=0&&e>=0){if(o=w(o,m-t),n=w(n,y-e),o>0&&n>0)for(c=t;c<t+o;c++)if(!a||i.Common.k.Cb(a,c)<0)for(u=e;u<e+n;u++)T&&(f=[]),(l=g.RTa(c,u,v,f))&&(b.push(l),T&&S.push(f),(1&r)>0&&!D(l.value)&&(h=void 0,T&&(h={}),g.Cp(c,u,{Ep:l.value},h),h&&s.push(h)))}else if(t>=0&&-1===e){if((o=w(o,m-t))>0)for(c=t;c<t+o;c++)T&&(f=[]),(l=g.RTa(c,-1,v,f))&&(b.push(l),T&&S.push(f))}else if(-1===t&&e>=0){if((n=w(n,y-e))>0)for(u=e;u<e+n;u++)T&&(f=[]),(l=g.RTa(-1,u,v,f))&&(b.push(l),T&&S.push(f))}else-1===t&&-1===e&&(T&&(f=[]),(l=g.RTa(-1,-1,v,f))&&(b.push(l),T&&S.push(f)));for(p=function(t){if(l=b[t]){var e=T?[]:v;(8&r)>0&&(e&&e.push(["tag",l.tag]),l.tag=C),(2&r)>0&&(e&&e.push(["style",l.style]),l.style=C),(1&r)>0&&(e&&e.push(["value",l.value]),l.value=C),(16&r)>0&&(e&&e.push(["sparkline",l.sparkline]),l.sparkline=C),(64&r)>0&&(e&&e.push(["bindingPath",l.bindingPath]),l.bindingPath=C),(256&r)>0&&(e&&e.push(["hyperlink",l.hyperlink]),l.hyperlink=C),(4&r)>0&&(e&&e.push(["comment",l.comment]),l.comment=C),T&&e.forEach((function(e){var o=[].concat(S[t]);o.push(e[0]),e[0]=o,s.push(e)}))}},d=0;d<b.length;d++)p(d)},t.prototype.toJSON=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,m,y,b,w,T,S,x,A,I,R,M,k=o&&o.parent&&!g(o.parent.QHb);function N(t,n,r,i,a,s){var l,u,c,f,h,p,d,g,m;return r?(l={},u=r.value,D(u)||(l.value=u),e&&e.saveAsView&&(c=void 0,s?c=s:k&&(c=o&&o.getFormatter(t,n)),j(c)&&(f=o.aHb(t,n,c,u),D(f)||(l.value=f))),e&&e.ignoreStyle||("string"==typeof(h=r.style)?l.style=h:h&&((p=h.toJSON(i,a))&&(p.name=v,p.fontForColumnWidth=h.fontForColumnWidth,l.style=p))),d=r.bindingPath,D(d)||(l.bindingPath=d),g=r.tag,D(g)||(l.tag=g),m=r.hyperlink,D(m)||(l.hyperlink=P(m),delete l.hyperlink.isVisited),l):C}if(r={},i={},a=(n=this).Xj,s=n.OZ,l=n.dataTable,u=n.rowDataArray,c=n.columnDataArray,e&&e.saveAsView)for(p=0;p<a;){for(d={},m=!1,y=l[p],b=0;b<s;)w={},y&&y[b]||c[b]?w=N(p,b,n.RTa(p,b,!0)):3===t&&k&&((T=this._Sb(p,b,o))&&(w=N(p,b,n.RTa(p,b,!0),3,!1,T))),g(w)||(d[b]=w,m=!0),b++;m&&(i[p]=d),p++}else for(f=n.Yea(-1);f>=0;){for(d={},m=!1,h=n.Hl(f,-1);h>=0;)(S=n.RTa(f,h))&&(w=N(f,h,S),g(w)||(d[h]=w,m=!0)),h=n.Hl(f,h);m&&(i[f]=d),f=n.Yea(f)}for(g(i)||(r.dataTable=i),x=[],f=0;f<a;f++)tt(u,f)&&u[f]&&(A=N(f,-1,u[f]),g(A)||(x[f]=A));for(x.length>0&&(r.rowDataArray=x),I=[],h=0;h<s;h++)tt(c,h)&&c[h]&&(R=N(-1,h,c[h]),g(R)||(I[h]=R));return I.length>0&&(r.columnDataArray=I),M=N(-1,-1,n.defaultDataNode,t,!0),g(M)||(r.defaultDataNode=M),r},t.prototype.fromJSON=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d=o&&o.incrementalLoading;if(t){if((i=this).ad(),i.gga++,a=t.dataTable,u=i.Xj,c=i.OZ,a?d&&3===n?ct(i,a,u,c,o,e,v,r):function(t,e,o,n,r,i){var a,s,l,u;for(a=0;a<o;a++)if(s=e[a])for(l=0;l<n;l++)(u=s[l])&&pt(u,t.RTa(a,l,!0),i,a,l,r)}(i,a,u,c,o,e):d&&r&&setTimeout(r,0),f=t.rowDataArray||t.Hf)for(s=0;s<u;s++)tt(f,s)&&f[s]&&pt(f[s],i.RTa(s,-1,!0),e,s,-1,o);if(h=t.columnDataArray||t.If)for(l=0;l<c;l++)tt(h,l)&&h[l]&&pt(h[l],i.RTa(-1,l,!0),e,-1,l,o);(p=t.defaultDataNode||t.Jf)&&pt(p,i.RTa(-1,-1,!0),e,-1,-1,o),i.gga--}else d&&r&&setTimeout(r,0)},t}(),J=function(){function t(){this.infos=[]}return t.prototype.WLc=function(t,e){var o=this.infos,n=o[t];return!n&&e&&(n=o[t]={}),n},t.prototype.uL=function(t,e){var o=this.infos,n=o.length;0<=t&&t<=n&&e>0&&N(o,n,t,e)},t.prototype.UTa=function(t,e,o){var n,r,i=this.infos,a=i.length;if(0<=t&&t<a&&e>0){if(e=w(e,a-t),o)for(n=0;n<e;n++)r=t+n,o.push([["infos",r],i[r]]);O(i,a,t,e)}},t.prototype.VTa=function(){return this.infos.length},t.prototype.Hp=function(){return this.infos},t.prototype.Jp=function(t){return this.infos[t]},t.prototype.Kp=function(t,e,o){var n=this.infos[t];this.infos[t]=e,o&&(o[0].push("infos",t),o[1]=n)},t.prototype.getSize=function(t){var e=this.infos[t],o=C;return e&&(!1===e.visible?o=0:"number"==typeof e.size&&(o=T(e.size))),o},t.prototype.getActualSize=function(t){var e=this.infos[t];return e?T(e.size):C},t.prototype.setSize=function(t,e,o){var n=this.WLc(t,!0),r=n.size;r!==e&&(n.size=e),o&&(o[0].push("infos",t,"size"),o[1]=r)},t.prototype.getStarSize=function(t){var e=this.infos[t];return e?e.starSize:v},t.prototype.setStarSize=function(t,e,o){var n=this.WLc(t,!0),r=n.starSize;D(e)&&D(r)||(r!==e&&(D(e)?delete n.starSize:n.starSize=e),o&&(o[0].push("infos",t,"starSize"),o[1]=r))},t.prototype.toJSON=function(t){var e,o,n,r,i,a,s,u,c=this.infos,f=[];if(t&&t.ignoreStarSize)for(e=0;e<c.length;e++)D(c[e])||(n=(o=c[e]).cellType,r=Q(o,["cellType"]),f[e]=P(r),n&&(n.toJSON&&(n=n.toJSON()),i=h._o,a=n.typeName,(s=i[n.type]||i[a]||l.getTypeFromString(a))&&((u=new s).fromJSON(n,t),f[e].cellType=u)),delete f[e].starSize);else for(e=0;e<c.length;e++)D(c[e])||(f[e]=c[e]);return f.length>0?f:v},t.prototype.fromJSON=function(t){t&&(this.infos=t)},t}(),X=J.prototype,d({visible:!0,resizable:!0,pageBreak:!1},(function(t,e){var o=t[0].toUpperCase()+t.substr(1);X["get"+o]=function(o){var n=e,r=this.infos[o];return r&&!D(r[t])&&(n=r[t]),n},X["set"+o]=function(e,o,n){var r=this.WLc(e,!0),i=r[t];i!==o&&(r[t]=o),n&&(n[0].push("infos",e,t),n[1]=i)}})),Z=function(){function t(t){this.modelManager=t,this.anchors={},this.cells={},this.invalidAnchors={}}return t.prototype.no=function(){this.modelManager=C},t.prototype.getAnchorCell=function(t,e){return St(this.anchors,t,e)},t.prototype.getAnchorItem=function(t,e){return St(this.cells,t,e)},t.prototype.getAnchorInfo=function(t,e,o){var n,r,i,a,s=this,l=s.anchors,u=s.getAnchorCell(t,e);if(u)return u;if(n=s.getAnchorItem(t,e))for(i in r=n.anchorRefs)if(r[i]&&(a=xt(l,i),o||a.isValid))return a},t.prototype.isCellHasItsOwnValue=function(t,e,o){var n,r,i,a,s=this.getAnchorItem(t,e);if(s){if(!D(s.value)||s.AIb)return!0;for(i in n=s.anchorRefs,r=this.anchors,n)if(o!==i&&n[i]&&((a=xt(r,i))&&a.isValid))return!0}return!1},t.prototype.removeRef=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,m,y,v=this.cells,b=e.isValid,w=e.row,T=e.col,S=e.rowCount,x=e.colCount,A=1;for(a=0,s=w;a<S;a++,s++){for(l=T+A;A<x;A++,l++){if(c=(u=St(v,s,l))&&u.anchorRefs,f=!0,b){if(h=t.getValue(s,l),p=u&&u.value,D(p)){if(m=!(d=u&&u.AIb)||d===o,c)for(y in c)if(y!==o&&c[y]){f=!1;break}m?Ct(n,s,l,C,h,e.row===s&&e.col===l):p=h}r&&yt(r,s,l,p)}c&&(delete c[o],f&&i&&g(c)&&At(v,s,l,!0))}A=0}},t.prototype.BIb=function(t,e,o,n,r){var i,a,l,u=t.getRowCount(),c=t.getColumnCount();return!(e+n>u||o+r>c||n*r>5e5||(i=t.getSheet(),a=s.kf(e,o,n,r),i.ITa.getSpans(a).length||(l=i.tables,l&&l.rn&&l.rn(e,o,n,r))))},t.prototype.setArray=function(t,e,o,n,r,i,s){var l,u,c,f,h,d,g,m,y,v,b,w,T,S,x,A,I,R,M=this,k=bt(e,o),N=M.anchors,O=St(N,e,o),F=M.cells;if(O&&!i)return[O,(l=M.updateItem(t,e,o))[0],l[1]];if(u={},c={},f=!1,O&&O.isValid&&(f=!0,M.removeRef(t,O,k,u,c,!0)),h=O,mt(N,e,o,O={row:e,col:o,rowCount:n,colCount:r,values:i,isValid:!1}),d=t.getCalcService().CIb,O.CIb=d,g=h&&h.CIb===d&&(n!==h.rowCount||r!==h.colCount),(m=t.q$a)&&St(M.invalidAnchors,e,o))Ct(u,e,o,p&&a.Errors.Spill,C,O.row===e&&O.col===o),M.DIb(e,o,n,r,F,m,c,t,k,!0);else if(i){if(y=vt(c,e,o,t),(v=!g&&M.BIb(t,e,o,n,r))&&(M.DIb(e,o,n,r,F,m,c,t,k),!m&&!s))for(b=1,w=0,T=e;w<n;w++,T++){for(S=o+b;b<r;b++,S++)if(x=vt(c,T,S,t),!D(x)&&M.isCellHasItsOwnValue(T,S,k)){if(v=!1,!f)break;mt(u,T,S,x,!0)}if(!f&&!v)break;b=0}if(v)for(w=0,T=e;w<n;w++,T++)for(A=i[w],b=0,S=o;b<r;b++,S++)x=vt(c,T,S,t),R=I=A&&A[b],D(I)?R=0:p&&(a.Convert.Ca(I)||a.Convert.Fh(I))&&(R=1===I.getRowCount()&&1===I.getColumnCount()?a.Convert.Ca(I)?I.getValue(0,0):I.getValue(0,0,0):a.Errors.Calc),Ct(u,T,S,R,x,O.row===T&&O.col===S),(w||b)&&(St(F,T,S).AIb=k);else Ct(u,e,o,p&&a.Errors.Spill,y,O.row===e&&O.col===o);O.isValid=v,h&&v!==h.isValid&&M.modelManager.EIb(e,o,!v)}return[O,u,[h]]},t.prototype.DIb=function(t,e,o,n,r,i,a,s,l,u){var c,f,h,p,d=1;for(c=0;c<o;c++){for(f=t+c;d<n;d++)h=e+d,(p=!u&&St(r,f,h))||(p={anchorRefs:{}},i&&!u||(p.value=vt(a,f,h,s)),mt(r,f,h,p)),p.anchorRefs[l]=!0;d=0}},t.prototype.updateItem=function(t,e,o,n,r,i){var a,s,l,u,c,f,h;if(void 0===r&&(r={}),void 0===i&&(i=[]),a=bt(e,o),(u=St(l=(s=this).anchors,e,o))&&(s.removeRef(t,u,a,r,v,!0),At(r,e,o),At(l,e,o,!0)),c=St(s.cells,e,o))for(h in s.modelManager.FIb(e,o,c.value),c.value=n,delete c.AIb,f=c.anchorRefs)f[h]&&wt(i,xt(l,h));if(u||c)return[u&&r,i]},t.prototype.GIb=function(t,e){mt(this.invalidAnchors,t,e,!0)},t.prototype.HIb=function(){this.invalidAnchors={}},t.prototype.IIb=function(t,e,o){var n,r,i,a,s,l,u,c=this,f=c.anchors,h=[];for(n in f)if(f.hasOwnProperty(n))for(s in i=(r=+n)>=e,a=f[n])a.hasOwnProperty(s)&&(l=+s,i||(i=(u=a[s])&&u.rowCount+r>=e),i&&h.push([r,l]));h.length&&h.forEach((function(e){c.updateItem(t,e[0],e[1],v)}))},t.prototype.NTa=function(t,e,o){this.IIb(t,e,o)},t.prototype.PTa=function(t,e,o){this.IIb(t,e,o)},t.prototype.JIb=function(t,e){var o,n,r,i,a,s,l,u=this,c=u.anchors,f=[];for(o in c)if(c.hasOwnProperty(o))for(i in n=+o,r=c[o])r.hasOwnProperty(i)&&((s=(a=+i)>=e)||(s=(l=r[i])&&l.colCount+a>=e),s&&f.push([n,a]));f.length&&f.forEach((function(e){u.updateItem(t,e[0],e[1],v)}))},t.prototype.OTa=function(t,e,o){this.JIb(t,e)},t.prototype.QTa=function(t,e,o){this.JIb(t,e)},t}(),e.KIb=Z,e.clearSpillValuesOnAddRemove=It,Y=function(){function t(e,o,n,r,i,a){var s,l,u,c;function f(t,e,o,n){s.WTa>0&&s.zTa.push([["defaults",o],n]),s.kj.$p()}this.LIb=[],(s=this).kj=e,s.sheetModels=[v,new q(r,n),new q(o,i),new q(o,n)],(l=s.rowInfos=[])[0]=l[1]=new J,l[2]=l[3]=new J,(u=s.colInfos=[])[0]=u[2]=new J,u[1]=u[3]=new J,s.spanModels=[v,new B,new B,new B],s.selectionModel=new z,s.ZHb=new Z(s),s.name=a||"",s.isSelected=!1,s.zoomFactor=1,nt(c=s.defaults={},"rowHeight",20,f),nt(c,"colWidth",62,f),nt(c,"rowHeaderColWidth",40,f),nt(c,"colHeaderRowHeight",20,f),nt(c,"_isExcelDefaultColumnWidth",!1,f),s.WTa=0,t.ao(this,"init"),s.Agc(o,n)}return t.prototype.Agc=function(t,e){this.zgc({type:c.AxisInfoChangeType.setRowCount,count:t}),this.zgc({type:c.AxisInfoChangeType.setColumnCount,count:e})},t.prototype.zgc=function(t){var e,o,n,r,i,a,s,l,u,f,h,p,d,g=this,m=g.kj,y=t.type,C=t.sheetArea;if((void 0===C?c.SheetArea.viewport:C)===c.SheetArea.viewport){if(D(g.Bgc)&&(g.Bgc=[]),D(g.Cgc)&&(g.Cgc=[]),g.Dgc)return void g.Egc(t);switch(e=g.Bgc,o=g.Cgc,y){case c.AxisInfoChangeType.setRowCount:if((i=(n=t.count)-(r=e.length))>0)for(a=Tt(k,i),s=0;s<a.length;s++)e.splice(r+s,0,a[s]);else e.length=n;break;case c.AxisInfoChangeType.setColumnCount:if((i=(n=t.count)-(r=o.length))>0)for(a=Tt(k,i),s=0;s<a.length;s++)o.splice(r+s,0,a[s]);else o.length=n;break;case c.AxisInfoChangeType.addRows:for(l=t.index,n=t.count,u=Tt(k,n),s=0;s<u.length;s++)e.splice(l+s,0,u[s]);break;case c.AxisInfoChangeType.deleteRows:l=t.index,n=t.count,e.splice(l,n);break;case c.AxisInfoChangeType.addColumns:for(l=t.index,n=t.count,u=Tt(k,n),s=0;s<u.length;s++)o.splice(l+s,0,u[s]);break;case c.AxisInfoChangeType.deleteColumns:l=t.index,n=t.count,o.splice(l,n);break;case c.AxisInfoChangeType.setRowHeight:case c.AxisInfoChangeType.setRowVisible:l=t.index,f=t.value,e[l]=f;break;case c.AxisInfoChangeType.setColumnWidth:case c.AxisInfoChangeType.setColumnVisible:l=t.index,f=t.value,o[l]=f;break;case c.AxisInfoChangeType.filterRows:for(p=0,d=h=t.index;p<d.length;p++)l=d[p],f=m.getRowHeight(l),e[l]=f;break;case c.AxisInfoChangeType.outlineExpandRows:for(h=t.index,s=0;s<h.length;s++)l=h[s],f=m.getRowHeight(l),e[l]=f;break;case c.AxisInfoChangeType.outlineExpandColumns:for(h=t.index,s=0;s<h.length;s++)l=h[s],f=m.getColumnWidth(l),o[l]=f}}},t.prototype.Fgc=function(t){if(this.Bgc){var e=this.Bgc[t];return e===k?this.defaults.rowHeight:e}},t.prototype.Ggc=function(t){if(this.Cgc){var e=this.Cgc[t];return e===k?this.defaults.colWidth:e}},t.prototype.wgc=function(){this.Dgc=[]},t.prototype.ygc=function(){var t,e,o,n=this,r=n.Dgc;if(n.Dgc=C,r)for(t=0,e=r;t<e.length;t++)o=e[t],n.zgc(o)},t.prototype.Egc=function(t){this.Dgc&&this.Dgc.push(t)},t.prototype.xgc=function(){this.Bgc=C,this.Cgc=C},t.prototype.no=function(e){if(!1!==e){var o=this;o.kj=C,o.sheetModels=C,o.ZHb&&(o.ZHb.no(),o.ZHb=C),o.xgc()}t.ao(this,"dispose",{clearCache:e})},t.prototype.addRows=function(e,o,n,r){var i,a=this;a.WTa>0&&(i={row:e,rowCount:o,type:"addRows"},a.zTa.push(i)),a.XTa(3).NTa(e,o,r),a.XTa(2).NTa(e,o,r),a.zl(3).NTa(e,o),a.zl(2).NTa(e,o),a.YTa(!0,3).uL(e,o),p&&a.ZHb.NTa(a.kj.yj(),e,o),n||t.ao(a,"addRows",{row:e,rowCount:o,changes:a.zTa}),a.zgc({type:c.AxisInfoChangeType.addRows,index:e,count:o})},t.prototype.ZTa=function(e){var o=this,n=e.row,r=e.rowCount;It(o,n,0,0,!0),o.deleteRows(n,r,!0),t.ao(o,"undoAddRows",{row:n,rowCount:r})},t.prototype.deleteRows=function(e,o,n){var r,i,a,s,l,u,f,h,d,g=this;if(g.WTa>0&&(i=[],a=[],s=[["spanModels",3],v],l=[["spanModels",2],v],u=[],r={row:e,rowCount:o,type:"deleteRows"},g.zTa.push(r)),g.XTa(3).STa(e,o,i),g.XTa(2).STa(e,o,a),g.zl(3).PTa(e,o,s),g.zl(2).PTa(e,o,l),g.YTa(!0,3).UTa(e,o,u),p&&g.ZHb.PTa(g.kj.yj(),e,o),n||t.ao(g,"deleteRows",{row:e,rowCount:o,changes:g.zTa}),r){for(f=r.changes=[],h=["sheetModels",3],d=0;d<i.length;d++)i[d][0]=h.concat(i[d][0]),f.push(i[d]);for(h=["sheetModels",2],d=0;d<a.length;d++)a[d][0]=h.concat(a[d][0]),f.push(a[d]);for(s.length>0&&f.push(s),l.length>0&&f.push(l),h=[R,3],d=0;d<u.length;d++)u[d][0]=h.concat(u[d][0]),f.push(u[d])}g.zgc({type:c.AxisInfoChangeType.deleteRows,index:e,count:o})},t.prototype.$Ta=function(t){var e,o,n,r=this,i=t.row,a=t.rowCount;for(It(r,i,0,0,!0),r.addRows(i,a,!0,!0),o=(e=t.changes).length-1;o>=0;o--)dt(r,e[o]);(n=r.kj&&r.kj.Ts)&&n.splice(n.length-a,a)},t.prototype.addColumns=function(e,o,n){var r,i=this;i.WTa>0&&(r={col:e,colCount:o,type:"addColumns"},i.zTa.push(r)),i.XTa(3).OTa(e,o),i.XTa(1).OTa(e,o),i.zl(3).OTa(e,o),i.zl(1).OTa(e,o),i.YTa(!1,3).uL(e,o),p&&i.ZHb.OTa(i.kj.yj(),e,o),n||t.ao(i,"addColumns",{col:e,colCount:o,changes:i.zTa}),i.zgc({type:c.AxisInfoChangeType.addColumns,index:e,count:o})},t.prototype._Ta=function(t){var e=t.col,o=t.colCount;It(this,e,0,0,!1),this.deleteColumns(e,o,!0)},t.prototype.deleteColumns=function(e,o,n){var r,i,a,s,l,u,f,h,d,g=this;if(g.WTa>0&&(i=[],a=[],s=[["spanModels",3],v],l=[["spanModels",1],v],u=[],r={col:e,colCount:o,type:"deleteColumns"},g.zTa.push(r)),g.XTa(3).TTa(e,o,i),g.XTa(1).TTa(e,o,a),g.zl(3).QTa(e,o,s),g.zl(1).QTa(e,o,l),g.YTa(!1,3).UTa(e,o,u),p&&g.ZHb.QTa(g.kj.yj(),e,o),n||t.ao(g,"deleteColumns",{col:e,colCount:o,changes:g.zTa}),r){for(f=r.changes=[],h=["sheetModels",3],d=0;d<i.length;d++)i[d][0]=h.concat(i[d][0]),f.push(i[d]);for(h=["sheetModels",1],d=0;d<a.length;d++)a[d][0]=h.concat(a[d][0]),f.push(a[d]);for(s.length>0&&f.push(s),l.length>0&&f.push(l),h=[M,3],d=0;d<u.length;d++)u[d][0]=h.concat(u[d][0]),f.push(u[d])}g.zgc({type:c.AxisInfoChangeType.deleteColumns,index:e,count:o})},t.prototype.aUa=function(t){var e,o,n=this,r=t.col,i=t.colCount;for(It(n,r,0,0,!1),n.addColumns(r,i,!0),o=(e=t.changes).length-1;o>=0;o--)dt(n,e[o])},t.prototype.getRowCount=function(t){return this.XTa(t).getRowCount()},t.prototype.setRowCount=function(t,e,o){var n=this,r=n.getRowCount(e);n.WTa>0&&n.zTa.push({oldRowCount:r,sheetArea:e,type:"setRowCount"}),3===e||2===e?(r>t&&n.deleteRows(t,r-t,o),n.XTa(3).setRowCount(t),n.XTa(2).setRowCount(t)):1===e&&(r>t&&n.YTa(!0,e).UTa(t,r-t),n.XTa(e).setRowCount(t)),n.zgc({type:c.AxisInfoChangeType.setRowCount,count:t,sheetArea:e})},t.prototype.bUa=function(t){this.setRowCount(t.oldRowCount,t.sheetArea,!0)},t.prototype.getColumnCount=function(t){return this.XTa(t).getColumnCount()},t.prototype.setColumnCount=function(t,e,o){var n=this,r=n.getColumnCount(e);n.WTa>0&&n.zTa.push({oldColCount:r,sheetArea:e,type:"setColumnCount"}),3===e||1===e?(r>t&&n.deleteColumns(t,r-t,o),n.XTa(3).setColumnCount(t),n.XTa(1).setColumnCount(t)):2===e&&(r>t&&n.YTa(!1,e).UTa(t,r-t),n.XTa(e).setColumnCount(t)),n.zgc({type:c.AxisInfoChangeType.setColumnCount,count:t,sheetArea:e})},t.prototype.cUa=function(t){this.setColumnCount(t.oldColCount,t.sheetArea,!0)},t.prototype.getLastNonNullRow=function(t,e){var o=e?0:this.YTa(!0,t).VTa()-1;return S(this.XTa(t).Ef,this.zl(t).Ef,o)},t.prototype.getLastNonNullCol=function(t,e){var o=e?0:this.YTa(!1,t).VTa()-1;return S(this.XTa(t).Ff,this.zl(t).Ff,o)},t.prototype.$Gb=function(){var t=this,e=t.kj,o=0!==e.Dr().height&&t._Gb(!0,e.defaults.rowHeight),n=0!==e.Dr().width&&t._Gb(!1,e.defaults.colWidth);function r(t,o){var n,r,i,a,s=o.length;for(n=0;n<s;n++)r=o[n][0],i=o[n][1],(a=o[n][2])!==i&&(t?e.kq(r,3,"height",i,a):e.pq(r,3,"width",i,a))}o&&r(!0,o),n&&r(!1,n)},t.prototype._Gb=function(t,e){var o,n,r,i,a,s,l,u,f,h,p,d,g,m,C,v,b,w,S=this,A=S.kj,I=[],R=A.zoom(),M=t?A.getRowCount():A.getColumnCount(),k=S.YTa(t,3),N=0,O=0;if(A.Gt&&(O=t?A.Gt().height:A.Gt().width),t){if(A.options.colHeaderVisible)for(n=0;n<A.getRowCount(1);n++)N+=x(R*A.getRowHeight(n,1));o=A.Dr().height-A.options.sheetAreaOffset.top-O-N}else{if(A.options.rowHeaderVisible)for(n=0;n<A.getColumnCount(2);n++)N+=x(R*A.getColumnWidth(n,2));o=A.Dr().width-A.options.sheetAreaOffset.left-O-N}for(r=[],i=[],a=[],s=0,l=t?A.getRowVisible:A.getColumnVisible,n=0;n<M;n++)if(u=l.call(A,n),f=A.ITa.getSize(t,3,n),h=A.ITa.getStarSize(t,3,n),y.test(h))p="*"===h?1:parseFloat(h.replace("*","")),u&&p>0?(s+=p,r.push(n),i.push(p),a.push(f)):I.push([n,0,f]);else if(f="number"==typeof f?Math.floor(f):e,u&&(o-=x(R*f))<1)return;if(!(s+I.length===0||o<1)){for(d=r.length,n=0;n<d-1;n++)if(g=o/s/R,p=i[n],f=T(g*p),m=x(R*f),I.push([r[n],f,a[n]]),o-=m,s-=p,m<1||o<1)return;for(C=x((o-1e-4)/R),I.push([r[d-1],C,a[d-1]]),n=0;n<I.length;n++)v=I[n][0],b=I[n][1],k.setSize(v,b),w=t?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,S.zgc({type:w,index:v});return I}},t.prototype.setCellState=function(t,e,o,n,r){var i=this.XTa(r);i&&i.setCellState(t,e,o,n)},t.prototype.toJSON=function(t){var e,o,n,r=this,i={};return i.data=r.XTa(3).toJSON(3,t,r.kj),i.rowHeaderData=r.XTa(2).toJSON(2,t),i.colHeaderData=r.XTa(1).toJSON(1,t),i.rows=r.YTa(!0,3).toJSON(t),i.columns=r.YTa(!1,3).toJSON(t),i.rowHeaderColInfos=r.YTa(!1,2).toJSON(t),i.colHeaderRowInfos=r.YTa(!0,1).toJSON(t),e=r.kj,i.leftCellIndex=e.getViewportLeftColumn(1),i.topCellIndex=e.getViewportTopRow(1),t&&t.ignoreStyle||(i.spans=Rt(r.zl(3).toJSON()),i.rowHeaderSpan=Rt(r.zl(2).toJSON()),i.colHeaderSpan=Rt(r.zl(1).toJSON())),i.selections=r.selectionModel.toJSON(),20===(n={colHeaderRowHeight:(o=r.defaults).colHeaderRowHeight,colWidth:o.colWidth,rowHeaderColWidth:o.rowHeaderColWidth,rowHeight:o.rowHeight,_isExcelDefaultColumnWidth:o._isExcelDefaultColumnWidth}).rowHeight&&62===n.colWidth&&40===n.rowHeaderColWidth&&20===n.colHeaderRowHeight||(i.defaults=n),i},t.prototype.fromJSON=function(t,e,o,n){var r,i,a,s,u,f,h,p,d,g,m,y=this;if(y.XTa(3).fromJSON(t.data,e,o,3,n),y.XTa(2).fromJSON(t.rowHeaderData,e,o),y.XTa(1).fromJSON(t.colHeaderData,e,o),y.kj.showCell(t.topCellIndex||0,t.leftCellIndex||0,c.VerticalPosition.top,c.HorizontalPosition.left),y.YTa(!0,3).fromJSON(t.rows),y.YTa(!1,3).fromJSON(t.columns),y.YTa(!1,2).fromJSON(t.rowHeaderColInfos),y.YTa(!0,1).fromJSON(t.colHeaderRowInfos),t&&t.rows)for(r=0,i=Object.keys(t.rows);r<i.length;r++)a=i[r],s=t.rows[a],D(s)||y.zgc({type:c.AxisInfoChangeType.setRowHeight,index:+a});if(t&&t.columns)for(u=0,f=Object.keys(t.columns);u<f.length;u++)a=f[u],s=t.columns[a],D(s)||y.zgc({type:c.AxisInfoChangeType.setColumnWidth,index:+a});o&&o.ignoreStyle||(y.zl(3).fromJSON(t.spans),y.zl(2).fromJSON(t.rowHeaderSpan),y.zl(1).fromJSON(t.colHeaderSpan)),y.selectionModel.fromJSON(t.selections,t.rowCount,t.columnCount),(h=t.tag)!==v&&(typeof(p=h.typeName)===b&&((d=l.getTypeFromString(p))&&((h=new d).fromJSON&&h.fromJSON(t.tag))),y.do("setValueForKey",-1,-1,"tag",h,3)),(g=t.defaults)!==v&&((m=y.defaults).colHeaderRowHeight=$(g.colHeaderRowHeight,20),m.colWidth=$(g.colWidth,62),m.rowHeaderColWidth=$(g.rowHeaderColWidth,40),m.rowHeight=$(g.rowHeight,20),m._isExcelDefaultColumnWidth=g._isExcelDefaultColumnWidth)},t.prototype.startTransaction=function(){0===this.WTa&&(this.zTa=[],!this.kj.isEventSuspended()&&(this.zTa.events=[]),t.ao(this,"startTransaction"));this.WTa++},t.prototype.endTransaction=function(){var e,o;return this.WTa--,0===this.WTa?(t.ao(this,"endTransaction"),e=this.zTa,this.zTa=v,(o=e.events)&&0===o.length&&delete e.events,e):[]},t.prototype.dUa=function(){var t=this.zTa;if(t)return t.calc||(t.calc=[]),t.calc},t.prototype.EIb=function(t,e,o){var n=this.zTa;n&&n.push({type:"setIsValid",value:[t,e,o]})},t.prototype.FIb=function(t,e,o){var n=this.zTa;n&&n.push({type:"dirtyItem",value:[t,e,o]})},t.prototype.MIb=function(t){var e,o,n=t.value;n&&((e=this.ZHb.getAnchorCell(n[0],n[1]))&&(o=n[2],e.isValid=o))},t.prototype.NIb=function(t){var e,o,n,r,i=t.value;i&&(e=i[0],o=i[1],n=i[2],(r=this.ZHb.getAnchorItem(e,o))&&(r.value=n))},t.prototype.undo=function(e){var o,n,r,i,a,s,l,u,c=[],f=e&&e.events;if(f&&this.YVa(f,!0),e)for(o=e.length-1;o>=0;o--)(r=(n=e[o]).type)?"addRows"===r?this.ZTa(n):"addColumns"===r?this._Ta(n):"deleteRows"===r?this.$Ta(n):"deleteColumns"===r?this.aUa(n):"setRowCount"===r?this.bUa(n):"setColumnCount"===r?this.cUa(n):"setZoomFactor"===r?this.fUa(n.value):"updateDirty"===r?(this.gWa(n),c.push(n)):"setName"===r?this.pZa(n.value):"sortRange"===r?this.yxb(n):"setIsValid"===r?this.MIb(n):"dirtyItem"===r&&this.NIb(n):dt(this,n);(i=this.kj).Oq={},i.Jq(),(a=c.length>0)&&((s=i.Wu)&&s.suspend(),c.forEach((function(t){i.eyb(t.row,t.col,3,!1)}))),(l=e&&e.uVa)&&l.length>0&&(t.ao(this,I,{uVa:l}),delete e.uVa),(u=e&&e.calc)&&u.length&&i.gUa(u),a&&(s&&s.resume(!1),i.fyb()),e&&t.ao(this,I,e),f&&this.YVa(f,!1)},t.prototype.do=function(t){var e,o,n=[];for(e=1;e<arguments.length;e++)n[e-1]=arguments[e];t&&((o=this[t])&&o.apply(this,n))},t.prototype.XTa=function(t){return D(t)&&(t=3),this.sheetModels[t]},t.prototype.dWa=function(t,e,o){D(o)&&(o=3),this.sheetModels[o]=new q(t,e)},t.prototype.ZVa=function(t){var e=this.zTa,o=e&&e.events;o&&o.push(t)},t.prototype.YVa=function(t,e){var o,n,r,i,a=this.kj;for(a.OIb=!0,o=t.length-1;o>=0;o--)i=void 0,"cellChanged"!==(r=(n=t[o])[0])||e?"rowChanged"!==r||e?"columnChanged"!==r||e?"zoomChanged"!==r||e?"rowChanging"===r&&e?i=a.pCb:"columnChanging"===r&&e?i=a.qCb:"tableRowsChanged"!==r||e?"tableColumnsChanged"!==r||e?"rangeChanged"!==r||e||(i=a.RIb):i=a.QIb:i=a.PIb:i=a.gyb:i=a.pq:i=a.kq:i=a.Bq,i&&([].splice.call(t,o,1),i.apply(a,[].slice.call(n,1)));a.OIb=!1},t.prototype.getValue=function(e,o,n,r,i){var a,s,l,u,c;if(D(n)&&(n=3),s=!1,l=!!this.kj.xUc,!r&&(u={row:e,col:o,sheetArea:n,isValueGet:!1,value:v},t.ao(this,"getValue",u,(function(){return u.isValueGet})),u.isValueGet)){if(!l)return u.value;a=u.value,s=!0}return c=this.XTa(n).getValue(e,o,i),l&&s&&!this.XLc(e,o,n)&&(c=a),c},t.prototype.setValue=function(e,o,n,r,i,a,l){var u,c,f,h,d,g,m,y,C,w,T,S;D(r)&&(r=3),f=(c=this).kj,(h=!a&&!f.isEventSuspended())&&(u=f.getValue(e,o,r,1)),d=!1,p&&f.getCalcService().allowDynamicArray&&!c.SIb&&3===r&&(c.LIb.push(c.ZHb.updateItem(f.yj(),e,o,n)),d=!0),g=!1,i||(m={row:e,col:o,value:n,sheetArea:r,isValueSet:!1,changes:c.zTa},t.ao(c,"setValue",m,(function(){return m.isValueSet})),g=m.isValueSet),g||(y=void 0,C=void 0,c.WTa>0&&!l&&(y=[["sheetModels",r],v],C={sheetArea:r}),c.XTa(r).setValue(e,o,n,y,C),y&&y.length>0&&c.zTa.push(y),C&&C.type&&c.zTa.push(C),f.fyb()),h?(w=u!==n,T=!1,S=void 0,typeof n===b&&((S=s.util.w0a(n))instanceof Date&&(T=!0),u instanceof Date&&(w=u.valueOf()!==S.valueOf())),w&&f.Bq("value",e,o,r,u,T&&S?S:n)):f.WXc(f,[{row:e,col:o}],0),d&&c.applyDynamicChanges()},t.prototype.applyDynamicChanges=function(){var t,e,o,n,r,i=this,s=i.LIb,l=i.kj;if(!i.SIb&&s.length){for(i.SIb=!0,t=l.yj(),e=l.Bj(),o=0,n=s;o<n.length;o++)(r=n[o])&&(a.setSpillValues(r[0],t),a.markAnchorCellDirty(r[1],e,i.ZHb));s.length=0,i.SIb=!1}},t.prototype.getDynamicArrayInfo=function(t,e){return this.ZHb.getAnchorInfo(t,e)},t.prototype.getStyle=function(t,e,o){return this.XTa(o).getStyle(t,e,this.WTa>0)},t.prototype.setStyle=function(t,e,o,n){D(n)&&(n=3);var r=this.WTa>0?[["sheetModels",n],v]:v;this.XTa(n).setStyle(t,e,o,r),r&&r.length>0&&this.zTa.push(r)},t.prototype.getValueForKey=function(t,e,o,n){return this.XTa(n).getValueForKey(t,e,o)},t.prototype.setValueForKey=function(t,e,o,n,r){D(r)&&(r=3);var i=this.WTa>0?[["sheetModels",r],v]:v;this.XTa(r).setValueForKey(t,e,o,n,i),i&&i.length>0&&this.zTa.push(i)},t.prototype.clear=function(e,o,n,r,i,a,s){var l,u,c,f,h,d,g,m,y,b,w,T,S,x;if(D(s)&&(s=3),l=this.WTa>0?[]:v,u=this,c=!1,p&&!u.SIb&&3===s){for(f=u.kj.yj(),h=u.LIb,d=u.ZHb,g={},m=[],y=0;y<n;y++)for(b=0;b<r;b++)d.updateItem(f,e+y,o+b,C,g,m);h.push([g,m]),c=!0}if(this.XTa(s).clear(e,o,n,r,i,a,l),t.ao(this,"clear",{row:e,col:o,rowCount:n,colCount:r,type:i,ignoredRowList:a,sheetArea:s,changes:this.zTa}),l)for(w=["sheetModels",s],T=0,S=l.length;T<S;T++)(x=l[T])[0]=w.concat(x[0]),this.zTa.push(x);c&&this.applyDynamicChanges()},t.prototype.swapNode=function(t,e,o,n,r){var i,a,s,l,u;if(D(r)&&(r=3),i=this.WTa>0?[]:v,this.XTa(r)._f(t,e,o,n,i),i)for(a=["sheetModels",r],s=0,l=i.length;s<l;s++)(u=i[s])[0]=a.concat(u[0]),this.zTa.push(u)},t.prototype.Cp=function(t,e,o,n){var r;this.WTa>0&&(r={sheetArea:n},D(n)&&(r.sheetArea=3)),this.XTa(n).Cp(t,e,o,r),r&&this.zTa.push(r)},t.prototype.gWa=function(t){this.XTa(t.sheetArea).gWa(t)},t.prototype.hUa=function(t){return this.XTa(t).Ap},t.prototype.XLc=function(t,e,o){var n=this.hUa(o)[t];return!(!n||!n[e])},t.prototype.YLc=function(t,e,o){var n,r,i=this.XTa(o).Ap;for(n=0;n<e;n++)(r=t+n)in i&&delete i[r]},t.prototype.ZLc=function(t,e){var o,n,r=this.kj.Ts;if(r)for(o=r.length-1;o>=0;o--)t<=(n=r[o].row)&&n<t+e&&r.splice(o)},t.prototype.iUa=function(t){this.XTa(t).Ap={}},t.prototype.Lec=function(t,e,o,n){var r,i,a,s=this.hUa();if(s)for(r in s)tt(s,r)&&(i=s[r],a=parseInt(r,10),i&&"n"===i.rs&&(t||e&&o<=a&&a<o+n)&&(s[r]={}))},t.prototype.Mec=function(e,o,n,r,i){var a,s,l,u,c,f,h=this.hUa(),p=this.kj,m=p.tables;if(!g(h)){if(a=[],o>=0)for(s=o;s<o+r;s++)a.push(s);else for(l in h)tt(h,l)&&a.push(parseInt(l,10));u=[],c=[],m&&(u=m.Nec(o,n,r,i),c=m.Oec(o,n,r,i),u.length>0&&t.ao(this,"clearPendingChanges",{tableList:u})),d(a,(function(t,o){var r,a,s;if((f=h[o])&&"e"===f.rs)if(r=c.length,e)if(m&&0!==r&&m.Pec(c,o,-1))for(a=p.getColumnCount(),s=0;s<a;s++)m&&0!==r&&m.Pec(c,o,s)||f[s]&&delete f[s];else h[o]={};else for(s=n;s<n+i;s++)m&&0!==r&&m.Pec(c,o,s)||f[s]&&delete f[s]}))}},t.prototype.Qec=function(){var t,e=this.hUa();for(t in e)tt(e,t)&&"e"===e[t].rs&&(e[t]={})},t.prototype.jUa=function(t){this.XTa(t).gga++},t.prototype.kUa=function(t){var e=this.XTa(t);e.gga--,e.gga<0&&(e.gga=0)},t.prototype.getName=function(){return this.name||""},t.prototype.setName=function(t){var e=this;e.WTa>0&&e.zTa.push({type:"setName",value:e.name}),e.name=t},t.prototype.TIb=function(){return this.isSelected},t.prototype.CHb=function(t){this.isSelected=t},t.prototype.pZa=function(t){this.kj.name(t)},t.prototype.yxb=function(t){var e,o=[];e=t.byRows?t.row:t.column,t.array.map((function(t,n){o[t-e]=n+e})),this.kj.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,C,o)},t.prototype.getZoomFactor=function(){return this.zoomFactor},t.prototype.setZoomFactor=function(t){var e=this;e.WTa>0&&e.zTa.push({type:"setZoomFactor",value:e.zoomFactor}),e.zoomFactor=t},t.prototype.fUa=function(t){this.kj.zoom(t)},t.prototype.zl=function(t){return D(t)&&(t=3),this.spanModels[t]},t.prototype.eWa=function(t){D(t)&&(t=3),this.spanModels[t]=new B},t.prototype.getSpans=function(t,e,o){var n=this.zl(e).getSpans(t);return o&&(n=n.filter((function(t){return!t.isAutoMerge}))),n},t.prototype.getSpan=function(t,e,o){return this.zl(o).get(t,e)},t.prototype.uIb=function(t,e,o){var n,r;return D(o)&&(o=3),(n=this.XTa(o))&&n.RTa?(r=n.RTa(t,e))&&r.tipContent?r.tipContent:null:null},t.prototype.qHb=function(t,e,o,n){D(n)&&(n=3);var r=this.XTa(n).RTa(t,e);!o&&r?delete r.tipContent:o&&r?r.tipContent=o:o&&!r&&((r=this.XTa(n).RTa(t,e,!0)).tipContent=o)},t.prototype.MTa=function(t,e,o,n,r){return this.zl(r).MTa(t,e,o,n)},t.prototype.qu=function(t,e,o,n,r){return this.zl(r).qu(t,e,o,n)},t.prototype.findSpan=function(t,e,o){return this.zl(o).find(t,e)},t.prototype.removeSpan=function(t,e){D(e)&&(e=3);var o=this.WTa>0?[["spanModels",e],v]:v;this.zl(e).remove(t,o),o&&o.length>0&&this.zTa.push(o)},t.prototype.addSpan=function(t,e){D(e)&&(e=3);var o=this.WTa>0?[["spanModels",e],v]:v;this.zl(e).add(t,o),o&&o.length>0&&this.zTa.push(o)},t.prototype.clearSpan=function(t,e,o,n,r){D(r)&&(r=3);var i=this.WTa>0?[["spanModels",r],v]:v;this.zl(r).$b(t,e,o,n,i),i&&i.length>0&&this.zTa.push(i)},t.prototype.moveSpan=function(t,e,o,n,r,i,a){D(a)&&(a=3);var s=this.WTa>0?[["spanModels",a],v]:v;this.zl(a).aB(t,e,o,n,r,i,s),s&&s.length>0&&this.zTa.push(s)},t.prototype.copySpan=function(t,e,o,n,r,i,a){D(a)&&(a=3);var s=this.WTa>0?[["spanModels",a],v]:v;this.zl(a).Zz(t,e,o,n,r,i,s),s&&s.length>0&&this.zTa.push(s)},t.prototype.addSelection=function(t,e,o,n){var r,i,a=this.WTa>0?[]:v;if(this.selectionModel.add(t,e,o,n,a),a)for(r=0;r<a.length;r++)(i=a[r])[0]=["selectionModel"].concat(i[0]),this.zTa.push(i)},t.prototype.getSelections=function(){return this.selectionModel.get()},t.prototype.setSelections=function(t){var e,o,n=this.WTa>0?[]:v;if(this.selectionModel.set(t,n),n)for(e=0;e<n.length;e++)(o=n[e])[0]=["selectionModel"].concat(o[0]),this.zTa.push(o)},t.prototype.clearSelection=function(){var t,e,o=this.WTa>0?[]:v;if(this.selectionModel.clear(o),o)for(t=0;t<o.length;t++)(e=o[t])[0]=["selectionModel"].concat(e[0]),this.zTa.push(e)},t.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},t.prototype.setActiveSelectedRangeIndex=function(t){var e=this.WTa>0?[["selectionModel"],v]:v;this.selectionModel.setProperty("activeSelectedRangeIndex",t,e),e&&this.zTa.push(e)},t.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},t.prototype.setSelectionPolicy=function(t){gt(this,"selectionPolicy",t)},t.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},t.prototype.setSelectionUnit=function(t){gt(this,"selectionUnit",t)},t.prototype.sp=function(t){return this.selectionModel.sp(t)},t.prototype.tp=function(t){return this.selectionModel.tp(t)},t.prototype.vp=function(t,e,o,n,r,i){return this.selectionModel.vp(t,e,o,n,r,i)},t.prototype.wp=function(t,e,o,n,r){return this.selectionModel.wp(t,e,o,n,r)},t.prototype.YTa=function(t,e){return D(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]},t.prototype.fWa=function(t,e){D(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]=new J},t.prototype.getPageBreak=function(t,e,o){return this.YTa(t,e).getPageBreak(o)},t.prototype.setPageBreak=function(t,e,o,n){var r;D(e)&&(e=3),r=this.WTa>0?[[t?R:M,e],v]:v,this.YTa(t,e).setPageBreak(o,n,r),r&&this.zTa.push(r)},t.prototype.getVisible=function(t,e,o){return this.YTa(t,e).getVisible(o)},t.prototype.setVisible=function(t,e,o,n){var r,i,a=this;D(e)&&(e=3),r=a.WTa>0?[[t?R:M,e],v]:v,a.YTa(t,e).setVisible(o,n,r),r&&a.zTa.push(r),i=t?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible,a.zgc({type:i,index:o,sheetArea:e})},t.prototype.getResizable=function(t,e,o){return this.YTa(t,e).getResizable(o)},t.prototype.setResizable=function(t,e,o,n){var r;D(e)&&(e=3),r=this.WTa>0?[[t?R:M,e],v]:v,this.YTa(t,e).setResizable(o,n,r),r&&this.zTa.push(r)},t.prototype.getSize=function(t,e,o){return this.YTa(t,e).getSize(o)},t.prototype.getStarSize=function(t,e,o){return this.YTa(t,e).getStarSize(o)},t.prototype.getActualSize=function(t,e,o){return this.YTa(t,e).getActualSize(o)},t.prototype.setSize=function(t,e,o,n){var r,i,a=this;D(e)&&(e=3),r=a.WTa>0?[[t?R:M,e],v]:v,a.YTa(t,e).setSize(o,n,r),r&&a.zTa.push(r),a.setStarSize(t,e,o,C),i=t?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,a.zgc({type:i,index:o,value:n,sheetArea:e})},t.prototype.setStarSize=function(t,e,o,n){var r;D(e)&&(e=3),r=this.WTa>0?[[t?R:M,e],v]:v,this.YTa(t,e).setStarSize(o,n,r),r&&!D(r[1])&&this.zTa.push(r)},t.prototype.VTa=function(t,e){return this.YTa(t,e).VTa()},t.prototype.Hp=function(t,e){return this.YTa(t,e).Hp()},t.prototype.Jp=function(t,e,o){return this.YTa(t,e).Jp(o)},t.prototype.setItem=function(t,e,o,n){var r,i,a=this;D(e)&&(e=3),r=a.WTa>0?[[t?R:M,e],v]:v,a.YTa(t,e).Kp(o,n,r),n&&(D(n.size)||(i=t?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,a.zgc({type:i,index:o,value:n.size,sheetArea:e})),D(n.visible)||(i=t?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible,a.zgc({type:i,index:o,sheetArea:e}))),r&&a.zTa.push(r)},t}(),e.lUa=Y,s.Zn(Y)},"./dist/core/worksheet/worksheet-render.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z;function Y(t){return t.height}function K(t){return t.width}function Q(t,e,o,n,r,i,a){t.beginPath(),t.lineWidth=e,t.strokeStyle=o,t.moveTo(n,r),t.lineTo(i,a),t.stroke()}function $(t,e){var o,n,r=0;return"string"==typeof t&&(1===(n=(o=t.split(" ",4)).length)?r=2*k(o[0]):2===n||3===n?r=2*k(o[1]):4===n&&(r=k(o[1])+k(o[3]))),r*e}function tt(t,e,o,n,r,a,s,l){var u,c,f,h,d,g,y,C=r.zoom(),b=o.font,w=o.textIndent,T=o.textOrientation,I=o.isVerticalText,R=o.textIndent&&0!==o.textIndent,M=0!==T&&!m(T);return b=b?v(b,C).font:n,typeof l===E&&1!==l&&(b=v(b,l).font),h=0,d=t,t&&d.richText?h=function(t,e,o){return function(t,e,o){var n,r,i,a,s;for(n=0,r=t;n<r.length;n++)i=r[n],a=void 0,i.style=i.style||{},s=i.style,a=s.font?v(s.font,o).font:e,s.font=a}(t,e,o),i.Vn.R_a(t,e,1)}(d.richText,b,C):t&&M&&!I&&!R?(u=S(T*Math.PI/180),c=x(u),f=A(u),o.wordWrap?(g=r.ss.Sl(a),h=i.Vn.mHb(a,s,c,f,e,b,g)):(y=p(b),h=i.Vn.Xn(e,b)*f+y*c)):h=i.Vn.Xn(e,b),h+=function(t,e,o,n){if(!m(o)&&!m(n)&&t.outlineColumn){var r=t.outlineColumn.LRa(o,n);if(r)return r}return e?8*e:0}(r,w,a,s)+j,h+$(o.cellPadding,C)}function et(t,e,o){if(t&&-90<=t&&t<=90)return R(o/I(S(t*Math.PI/180)))+e+4}function ot(t,e,o,n,r,i,a,l,c){var f,h,p,d,g,C,v,w,T,S,x,A,I,R,M,k;if(y(r.data)&&t.parent&&t.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(f=t.ss,h=K(r),p=K(r),g=r.style,v=r.text,w=r.printZoomFactor,T=g.watermark,S=g.wordWrap,x=g.textOrientation,R=t.options.allowCellOverflow,e.findCell(i,a))return b;if(g.cellButtons&&g.cellButtons.length>0)return b;if(!(g.cellType||o).allowOverflow||!v&&!T||!x&&S&&t.parent&&t.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(v||(v=T),!R&&!x)return b;if((A=tt(r.data,v,g,n,t,i,a,w))<=p)return b;for(M=a,k=a,C=a+(c?1:-1);(c?C<=l:C>=l)&&!e.findCell(i,C)&&(I=f.Ym(i,C),d=f.zHb(i,C,3,1,I),I.textOrientation||m(d))&&!I.watermark&&!(I.cellType&&"1"!==I.cellType.typeName||I.cellButtons&&I.cellButtons.length>0)&&(c?k=C:M=C,!(A<=(p+=f._m(C))));C+=c?1:-1);return c&&k===a||!c&&M===a?b:new s.op(a,M,k,A,h,p,c?-1:p,c?p:-1)}function nt(t){var e=t.parent,o={nps:!0};return r.Worksheet.ao(t,"needPaintSelection",o),(i.Vl.Wl(t)||e&&!e.options.hideSelection)&&o.nps}function rt(t){var e=t.parent;return e&&e.options.backColor||"white"}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/worksheet/worksheet.js"),i=o("./dist/core/util/common.js"),a=o("./dist/core/worksheet/stylehelper.js"),s=o("./dist/core/worksheet/worksheet-model.js"),l=o("./dist/core/worksheet/worksheet-border.js"),u=o("./dist/core/core.enum.js"),c=function(t){return t.getSparkline},f=n.Common.k,h=i.Ul.ol,p=i.Ul.fp,d=i.Ul.lZa,g=i.Ul.lHb,m=n.Common.j.Fa,y=i.Ul.Fxb,C=a.Ho,v=a.To.No,b=null,w=Math.min,T=Math.max,S=Math.abs,x=Math.sin,A=Math.cos,I=Math.tan,R=Math.floor,M=Math.round,k=parseInt,N="black",O="transparent",D="rowHeader",F="columnHeader",E="number",j=2,P=function(){function t(t,e,o){var n=this;n.kj=t,n.pJ=t.Hr(o),n.qJ=t.Ir(e,o,u.SheetArea.viewport,!0),n.yI=v(t.yl.Bl(),t.zoom()).font,n.Rq=t.Al(),n.rJ={}}return t.prototype.nJ=function(t,e,o){var n,r,a,l,c,f,p,d,g,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j=this,P=j.rJ[t];if(P)return P;if(r=(n=j.kj).ss,l=(a=j.pJ).length,S=new s.np,e||(e=i.Vn.bm()),l>0){for(S.headingOverflowlayouts=j.sJ(t,e),A=a[0].col,I=a[l-1].col,R=0;R<l;R++)K(d=a[R])<=0||(g=d.col,y=r.Ym(t,g),C=r.zHb(t,g,3,1),c=y.textOrientation,f=y.isVerticalText,p=y.textIndent&&0!==y.textIndent,M=y&&(y.borderLeft||y.borderTop||y.borderRight||y.borderBottom),m(C)&&!y.watermark||y.shrinkToFit||!c&&y.wordWrap&&n.parent&&n.parent.options.numbersFitMode===u.NumbersFitMode.mask||f||((k=n.conditionalFormats)&&(O=(N=k.oRa(n,t,g,C)).dataBar,D=N.iconSet,O&&O.showBarOnly||D&&D.showIconOnly)||(v=r._m(g),b=r.Sl(t),F=y.cellType||j.Rq,E={},T=i.mn.vn(n,y,C,E,{row:t,col:g,sheet:n}),E&&E.content&&E.content.length>0&&!y.shrinkToFit&&c&&(T=F.sHb(e,E.content,b-4,y.font)),3===(w=y.hAlign)&&(w=h(w,C,y.formatter,c)),M&&c&&!f&&!p?0>c&&c>-90?(x=j.UIb({data:C,style:y,width:v,text:T,printZoomFactor:o},t,g,A))&&S.push(x):0<c&&c<90&&((x=j.UIb({data:C,style:y,width:v,text:T,printZoomFactor:o},t,g,I,!0))&&S.push(x)):0===w?(x=j.tJ({data:C,style:y,width:v,text:T,printZoomFactor:o},t,g,I))&&S.push(x):2===w?(x=j.uJ({data:C,style:y,width:v,text:T,printZoomFactor:o},t,g,A))&&S.push(x):1===w&&((x=j.vJ({data:C,style:y,width:v,text:T,printZoomFactor:o},t,g,A,I))&&S.push(x)))));S.trailingOverflowLayouts=j.wJ(t,e)}return j.rJ[t]=S,S},t.prototype.tJ=function(t,e,o,n){var r=this;return ot(r.kj,r.qJ,r.Rq,r.yI,t,e,o,n,!0)},t.prototype.uJ=function(t,e,o,n){var r=this;return ot(r.kj,r.qJ,r.Rq,r.yI,t,e,o,n)},t.prototype.UIb=function(t,e,o,n,r){var i,a,l,u,c,f=this,h=f.kj,p=f.qJ,d=f.Rq,g=f.yI,m=h.ss,y=K(t),C=K(t),v=t.style,w=t.text,T=t.printZoomFactor,S=v.watermark,x=v.wordWrap,A=v.textOrientation,I=v&&(v.borderLeft||v.borderTop||v.borderRight||v.borderBottom),R=v.isVerticalText,M=v.textIndent&&0!==v.textIndent,k=h.options.allowCellOverflow;if(p.findCell(e,o))return b;if(v.cellButtons&&v.cellButtons.length>0)return b;if(!(v.cellType||d).allowOverflow||!w&&!S||!A&&x)return b;if(w||(w=S),!k&&!A)return b;if((a=!I||R||M?tt(t.data,w,v,g,h,e,o,T):et(A,m._m(o),m.Sl(e)))<=C)return b;for(u=o,c=o,i=o+(r?1:-1);!(!(r?i<=n:i>=n)||p.findCell(e,i)||(l=m.Ym(e,i),l.watermark)||l.cellType&&"1"!==l.cellType.typeName||l.cellButtons&&l.cellButtons.length>0||(r?c=i:u=i,C+=m._m(i),a<=C));i+=r?1:-1);return r&&c===o||!r&&u===o?b:new s.op(o,u,c,a,y,C,r?-1:C,r?C:-1)},t.prototype.vJ=function(t,e,o,n,r){var i,a,l,c,f,h,p,d,g,C,v,w,T,S,x,A,I,R,M,k,N;if(y(t.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(l=(a=(i=this).kj).ss,c=i.qJ,f=K(t),h=K(t),d=t.style,C=t.text,v=t.printZoomFactor,w=d.textOrientation,T=d.watermark,S=d.wordWrap,I=a.options.allowCellOverflow,c.findCell(e,o))return b;if(d.cellButtons&&d.cellButtons.length>0)return b;if(!(d.cellType||i.Rq).allowOverflow||!C&&!T||!w&&S&&a.parent&&a.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(C||(C=T),!I&&!w)return b;if((x=tt(t.data,C,d,i.yI,a,e,o,v))<=h)return b;for(R=o,M=h/2,g=o-1;g>=n&&!c.findCell(e,g)&&(A=l.Ym(e,g),p=l.zHb(e,g,3,1,A),A.textOrientation||m(p))&&!A.watermark&&!(A.cellType&&"1"!==A.cellType.typeName||A.cellButtons&&A.cellButtons.length>0)&&(R=g,!(x/2<=(M+=l._m(g))));g--);for(k=o,N=h/2,g=o+1;g<=r&&!c.findCell(e,g)&&(A=l.Ym(e,g),p=l.zHb(e,g,3,1,A),A.textOrientation||m(p))&&!A.watermark&&!(A.cellType&&"1"!==A.cellType.typeName||A.cellButtons&&A.cellButtons.length>0)&&(k=g,!(x/2<=(N+=l._m(g))));g++);return R===k?b:new s.op(o,R,k,x,f,M+N,M,N)},t.prototype.sJ=function(t,e){var o,n,r,a,s,l,c,f,p,d,g,y,C=this,v=C.kj,b=v.ss,w=C.pJ,T=w[0].col,S=w[w.length-1].col,x=v.ITa,A=[];for(y=1;y<100;y++){if((l=T-y)<0)return A;if(x.findSpan(t,l)||v.mJb&&v.mJb.oJb(t,l,u.SheetArea.viewport))return A;n=b.zHb(t,l,3,1),(r=b._m(l))>0&&!m(n)&&(3===(s=(o=b.Ym(t,l)).hAlign)&&(s=h(s,n,void 0,o.textOrientation)),a=b.Sl(t),d=o.cellType||C.Rq,g={},f=i.mn.vn(v,o,n,g,{row:t,col:l,sheet:v}),g&&g.content&&g.content.length>0&&!o.shrinkToFit&&o.textOrientation&&(f=d.sHb(e,g.content,a-4,o.font)),p={data:n,style:o,width:r,text:f},0<o.textOrientation&&o.textOrientation<90?c=C.UIb(p,t,l,S,!0):0===s?c=C.tJ(p,t,l,S):1===s&&(c=C.vJ(p,t,l,T,S)),c&&c.endColumn>=T&&A.push(c))}return A},t.prototype.wJ=function(t,e){var o,n,r,a,s,l,c,f,p,d,g,y,C=this,v=C.kj,b=v.ss,w=C.pJ,T=w[0].col,S=w[w.length-1].col,x=v.ITa,A=v.getColumnCount(),I=[];for(y=1;y<100;y++){if((f=S+y)>=A)return I;if(x.findSpan(t,f)||v.mJb&&v.mJb.oJb(t,f,u.SheetArea.viewport))return I;n=b.zHb(t,f,3,1),(r=b._m(f))>0&&!m(n)&&(3===(s=(o=b.Ym(t,f)).hAlign)&&(s=h(s,n,void 0,o.textOrientation)),a=b.Sl(t),l=o.cellType||C.Rq,c={},d=i.mn.vn(v,o,n,c,{row:t,col:f,sheet:v}),c&&c.content&&c.content.length>0&&!o.shrinkToFit&&o.textOrientation&&(d=l.sHb(e,c.content,a-4,o.font)),g={data:n,style:o,width:r,text:d},0>o.textOrientation&&o.textOrientation>-90?p=C.UIb(g,t,f,T,!1):2===s?p=C.uJ(g,t,f,T):1===s&&(p=C.vJ(g,t,f,T,S)),p&&p.startColumn<=S&&I.push(p))}return I},t}(),e.xJ=P,e.needPaintSelection=nt,L=function(){function t(t){this.kj=t}return t.prototype.bm=function(){var t=this.kj,e=b,o=t.Ws();return o&&o.getContext&&(e=o.getContext("2d")),e},t.prototype.vI=function(){var t,e=this,o=e.kj,n=o.Dr(),r=o.Xs,a=K(r),s=Y(r),l=e.wI;return l&&K(l)===a&&Y(l)===s||(l&&i.En.Qn(o,l),e.wI=l=i.Ul.Nl("canvas"),l.getContext&&(e.xI=l.getContext("2d"),i.En.Kn(l,b,o),i.En.Pn(l,K(n),Y(n)))),(t=e.xI)&&(t.beginPath(),d(t,e.Cl(e.Bl())),t.name="bufferContext"),t},t.prototype.Bl=function(){return this.yI||(this.yI=C+" "+this.kj.currentTheme().bodyFont()),this.yI},t.prototype.us=function(){this.yI=b},t.prototype.zI=function(t){var e=this.kj,o=e.parent,n=o?o.options.grayAreaBackColor||i.Im.Mm("gc-grayArea").backgroundColor:"gray",r=i.Rm.Om(e,n);return t?((o?o.options.backgroundImage:b)&&(r=O),r):r},t.prototype.Cl=function(t){var e=this.kj.zoom();return 1===e?t:v(t,e).font},t.prototype.Mx=function(t,e,o,n,r){var a,s,l,u,c,f=this,h=f.wI,p=f.bm();o<=0||n<=0||!h||!p||(r||(r=f.kj.Dr()),a=i.En.Ln(h),s=i.En.Mn(h),1!==a&&(t*=a,e*=s,o*=a,n*=s,r=new i.Rect(r.x*a,r.y*s,K(r)*a,Y(r)*s)),(l=r.getIntersect(t,e,o,n))&&(l.round(),t=l.x,e=l.y,o=K(l),n=Y(l),(u=K(h))&&t+o>u&&((t=u-o)<0&&(o+=t,t=0)),(c=Y(h))&&e+n>c&&((e=c-n)<0&&(n+=e,e=0)),i.Bn.Cn(p,1,1),p.clearRect(t,e,o,n),p.drawImage(h,t,e,o,n,t,e,o,n),i.Bn.Cn(p,a,s)))},t.prototype.dm=function(t,e){t&&this.Mx(t.x,t.y,K(t),Y(t),e)},t.prototype.Ow=function(t,e,o,n,r,a){var s,l,u,c,f,h,p,d,g,m,y,C,v,b;if(o>0&&n>0)try{l=(s=this).kj,u=s.bm(),c=l.Ws(),f=s.vI(),h=s.wI,p=r,d=a,g=o,m=n,y=i.En.Ln(c),C=i.En.Mn(c),t=M(t*y),e=M(e*C),o=M(o*y),n=M(n*C),p=M(p*y),d=M(d*C),g=M(g*y),m=M(m*C),v=K(h),b=Y(h),v&&t+o>v&&((t=v-o)<0&&(o+=t,t=0)),b&&e+n>b&&((e=b-n)<0&&(n+=e,e=0)),v&&p+g>v&&((p=v-g)<0&&(g+=p,p=0)),b&&d+m>b&&((d=b-m)<0&&(m+=d,d=0)),i.Bn.Cn(u,1,1),i.Bn.Cn(f,1,1),u.clearRect(p,d,g,m),u.drawImage(h,t,e,o,n,p,d,g,m),f.clearRect(p,d,g,m),f.drawImage(c,p,d,g,m,p,d,g,m),i.Bn.Cn(u,y,C),i.Bn.Cn(f,y,C)}catch(t){}},t.prototype.im=function(t,e,o,n){var r,a,s,l,c,f,h,p,d,g,m,y,C,v,b,S,x,A,I,R,M,k,N,O,D=this;if(o||(o=D.bm()),r=!1,a=D.kj,s=i.kf(-1,-1,-1,-1),l=a.Hx,c=a.ITa,t&&(s=a.options.allowCellOverflow?i.kf(t.row,0,t.rowCount,a.getColumnCount()):i.kf(t.row,t.col,t.rowCount,t.colCount),!l)){if(s.col>=0){for(h=s.col,p=s.col+s.colCount-1,d=a.getRowCount(1),g=0;g<d;g++)(f=c.findSpan(g,s.col,1))?h=w(f.col,h):a.p_a&&(h=w(a.p_a.col,h)),(f=c.findSpan(g,s.col+s.colCount-1,1))?p=T(f.col+f.colCount-1,p):a.p_a&&(p=T(a.p_a.col+a.p_a.colCount-1,p));s.col=h,s.colCount=p-h+1}if(s.row>=0){for(m=s.row,y=s.row+s.rowCount-1,C=a.getColumnCount(2),v=0;v<C;v++)(f=c.findSpan(s.row,v,2))?m=w(f.row,m):a.p_a&&(m=w(a.p_a.row,m)),(f=c.findSpan(s.row+s.rowCount-1,v,2))?y=T(f.row+f.rowCount-1,y):a.p_a&&(y=T(a.p_a.row+a.p_a.rowCount-1,y));s.row=m,s.rowCount=y-m+1}}if(b=a.cm(s),a.cellStates&&a.cellStates.hasIntersectInSeletionState(s.row,s.col,s.rowCount,s.colCount)&&a.repaint(b),x=(S=a.QLc)&&S.isEnable(u.StatesType.selected,!0),A=S&&S.isEnable(u.StatesType.selected,!1),t&&(x&&(b=a.cm(i.kf(t.row,-1,t.rowCount,-1))),A&&(I=a.cm(i.kf(-1,t.col,-1,t.colCount)),b.x=w(b.x,I.x),b.y=w(b.y,I.y),b.width=T(b.width,I.width),b.height=T(b.height,I.height))),R=K(b),M=Y(b),k=b.x,N=b.y,R>=0||M>=0){if(-9,-9,18,30,b.x+=-9,b.y+=-9,b.width+=18,b.height+=30,e&&!(b=b.getIntersectRect(e)))return;O=a.am(),M>0&&!l&&(a.$l=!0,D.jp(o,new i.Rect(O.x,T(O.nt,N),O.Br,M),n)),R>0&&!l&&(a.$l=!0,D.jp(o,new i.Rect(T(O.kt,k),O.y,R,O.Cr),n)),-1!==s.row||-1!==s.col||l||(a.$l=!0,D.jp(o,O.em(),n)),R>0&&M>0&&((x||A)&&(a.$l=!0),D.jp(o,b,n)),r=!0}return r},t.prototype.VF=function(t,e,o,n,r){var a,s=this,l=s.kj;l.Xq<=0&&((a=s.bm())&&(r||(l.$l=!0),s.jp(a,new i.Rect(t,e,o,n))))},t.prototype.repaint=function(t){var e,o=this,n=o.kj;n.Xq>0||(e=o.bm())&&(n.$l=!0,o.jp(e,t))},t.prototype.jp=function(t,e,o){var n=this;t&&n.kj.Xq<=0&&(o||n._l(t,e),n.Pw(t,e))},t.prototype._l=function(t,e,o){var n,r,a,s=this,l=s.kj;t&&l.Xq<=0&&(r=(n=s.vI())||t,a=l.Dr(),e||(e=a),e&&e.round(),o&&o.round(),l.$l&&(l.$l=!1,n&&(n.clearRect(e.x,e.y,K(e),Y(e)),o&&n.clearRect(o.x,o.y,K(o),Y(o)),i.Bn.Dn(n,-a.x,-a.y)),s.AI(r,e),o&&s.AI(r,o),n&&i.Bn.Dn(n,a.x,a.y)),n&&(s.dm(e),o&&s.dm(o)))},t.prototype.Pw=function(t,e){var o,n,i,a,s,l=this,u=l.kj,c=u.CH;if(t&&!(u.Xq>0)&&(e&&e.round(),o=u.am(),r.Worksheet.ao(u,"beforePaintAdornment",{ctx:t,clipRect:e}),!u.fI)){if(c){for(n=o.em(),l.dm(n),a=0;a<=2;a++)(n=o.fm(a))&&0!==K(n)&&0!==Y(n)&&l.dm(n);for(s=0;s<=2;s++)(n=o.gm(s))&&0!==K(n)&&0!==Y(n)&&l.dm(n)}for(a=0;a<=2;a++)for(s=0;s<=2;s++)(n=o.Ft(a,s))&&0!==K(n)&&0!==Y(n)&&(i=e,(c&&(1!==a||1!==s)||u.parent&&u.parent.options.allowUserDragMerge)&&(l.dm(n),i=n),i&&!n.intersectRect(i)||l.BI(t,a,s,i));l.CI(t),r.Worksheet.ao(u,"paintAdornment",{ctx:t,clipRect:e})}},t.prototype.dD=function(t,e){var o=this.kj,n=o.parent,r=n?n.options:{},a=rt(o),s=i.Rm.Om(o,a);r.backgroundImage&&(s=O),t.save(),t.fillStyle=s,t.fillRect(e.x,e.y,K(e),Y(e)),t.restore()},t.prototype.z0a=function(t){var e=this.kj;return 0===e.am().Cr&&t===e.ar(3)},t.prototype.A0a=function(t){var e=this.kj;return 0===e.am().Br&&t===e.$q(3)},t.prototype.DI=function(t,e,o,n){var r,i,a,s,l,u,c,f=this,h=f.kj,p=h.options,d=h.am(),g=p.sheetAreaOffset.top,m=p.sheetAreaOffset.left,y=0!==d.Cr,C=0!==d.Br,v=h.Gt&&h.Gt()||{x:p.sheetAreaOffset.left,y:p.sheetAreaOffset.top,width:0,height:0},b=0===v.width,w=0===v.height;for(i=0;i<=2;i++)(s=d.gm(i))&&(y&&w&&(s.y=s.y-g,s.height=s.height+g,!C&&b&&(s.x=s.x-m,s.width=s.width+m)),(a=e?s.getIntersectRect(e):s)&&f.EI(t,i,a,o,n));for(r=0;r<=2;r++)for((l=d.fm(r))&&(C&&b&&(l.x=l.x-m,l.width=l.width+m,!y&&w&&(l.y=l.y-g,l.height=l.height+g)),(a=e?l.getIntersectRect(e):l)&&f.FI(t,r,a,o,n)),i=0;i<=2;i++)u=d.Ft(r,i),f.z0a(h.jCb(r))&&w&&(u.y=u.y-g,u.height=u.height+g),f.A0a(h.kCb(i))&&b&&(u.x=u.x-m,u.width=u.width+m),u&&((a=e?u.getIntersectRect(e):u)&&f.GI(t,r,i,a,o,n));(c=d.em())&&((a=e?c.getIntersectRect(e):c)&&f.HI(t,a,o,n))},t.prototype.II=function(t){var e=this,o=e.kj,n=o.am(),r=n.zr,i=n.Ar,a=K(n),s=n.ot,l=n.gs,u=n.$Lc,c=n.sKc,f=n._Lc,h=n.pKc;h>0&&(t.fillStyle=e.zI(!1),t.fillRect(r,f,a,h)),c>0&&(t.fillStyle=e.zI(!1),t.fillRect(u,i,c,f),o.qKc&&t.fillRect(u,s,c,l))},t.prototype.B0a=function(t,e){var o=this,n=o.kj,r=o.zI(!1),i=n.options,a=i.sheetAreaOffset.left,s=i.sheetAreaOffset.top,l=e.x,u=e.y,c=K(e),f=Y(e);t.save(),a>0&&Q(t,a,r,l+a/2,s>0?u+s:u,l+a/2,u+T(0,f)),s>0&&Q(t,s,r,a>0?l+a:l,u+s/2,l+T(0,c),u+s/2),a>0&&s>0&&(t.fillStyle=o.zI(!1),t.fillRect(l,u,a,s)),t.beginPath(),t.restore()},t.prototype.AI=function(t,e){var o,n=this,i=n.kj;!t||i.Xq>0||(o=i.Dr(),t.save(),e?t.rect(e.x,e.y,K(e),Y(e)):t.rect(o.x,o.y,K(o),Y(o)),t.clip(),t.beginPath(),n.dD(t,o),r.Worksheet.ao(i,"paint",{ctx:t,clipRect:e}),n.B0a(t,o),n.DI(t,e,!1),n.II(t),n.KI(t),r.Worksheet.ao(i,"paintSheetEnd",{ctx:t,clipRect:e}),t.beginPath(),t.restore())},t.prototype.LI=function(t,e,o){var n,r,a=this,s=a.kj;t&&(n=s.Dr(),t.save(),r=e||new i.Rect(n.x,n.y,K(n),Y(n)),t.rect(r.x,r.y,K(r),Y(r)),t.clip(),t.beginPath(),a.dD(t,n),a.DI(t,r,!0,o),t.beginPath(),t.restore())},t.prototype.CI=function(t){var e,o,n,r,i,a,s,l,u,c=this.kj,f=c.mm,h=c.yt;if(f&&f.isResizing&&h&&(s=h.resizeInfo)){if(l=c.am(),u=N,t.save(),t.strokeStyle!==u&&(t.strokeStyle=u),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(o=T(0,s.startY-.5),r=s.movingY-.5,i=l.x+K(l),e=l.x;e<i;e+=2)t.moveTo(e,o),t.lineTo(e+1,o),t.moveTo(e,r),t.lineTo(e+1,r);else for(e=T(0,s.startX-.5),n=s.movingX-.5,a=l.y+Y(l),o=l.y;o<a;o+=2)t.moveTo(e,o),t.lineTo(e,o+1),t.moveTo(n,o),t.lineTo(n,o+1);t.stroke(),t.beginPath(),t.restore()}},t.prototype.HI=function(t,e,o,n){var r,i,a,s,u,c,f,h=this.kj;t.beginPath(),i=(r=h.am().em()).x,a=r.y,s=K(r),u=Y(r),c=h.getActualStyle(-1,-1,0),this.SI(t,[{data:b,row:-1,col:-1,x:i,y:a,width:s,height:u,style:c.clone()}],0,o,n),(f=new l.AF(h,h.Gr(0,0),h.Hr(0,0),0)).jF(0,0,i,a,s,u),f.paint(t)},t.prototype.KI=function(t){var e,o,n,r,a,s,l,u,c,f=this.kj,h=f.frozenRowCount(),p=f.frozenColumnCount(),d=f.frozenTrailingRowCount(),g=f.frozenTrailingColumnCount();(h||p||d||g)&&(o=(e=f.am()).pt,n=e.qt,r=e.lt,a=e.ot,s=e.x,l=e.y,u=K(e),c=Y(e),t.save(),t.strokeStyle=i.Rm.Om(f,f.options.frozenlineColor),t.lineWidth=1,t.beginPath(),p&&(t.moveTo(o-.5,l),t.lineTo(o-.5,l+c)),h&&(t.moveTo(s,n-.5),t.lineTo(s+u,n-.5)),g&&(t.moveTo(r-.5,l),t.lineTo(r-.5,l+c)),d&&(t.moveTo(s,a-.5),t.lineTo(s+u,a-.5)),t.stroke(),t.restore())},t.prototype.EI=function(t,e,o,n,r){this.TI(t,-1,e,1,o,n,r)},t.prototype.FI=function(t,e,o,n,r){this.TI(t,e,-1,2,o,n,r)},t.prototype.GI=function(t,e,o,n,r,i){var a,s,l,u=this.kj.et;u&&((a=u.getCalcService())&&a.calcOnDemand&&((s=u.xf).clearValueCache&&s.clearValueCache())),this.TI(t,e,o,3,n,r,i),(l=this.kj.at)&&l.UI(t,n,e,o)},t.prototype.VIb=function(t,e,o,n,r){var a,s,l,u=this.kj,c=u.getRangeRect(e,o,i.kf(r.row,r.col,r.rowCount,r.colCount));(c=c.getIntersectRect(u.am().Ft(e,o)))&&(c.round(),a=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",a||t.setLineDash([6,2]),s=c.x+.5,l=c.y+.5,t.strokeRect(s,l,K(c),Y(c)),t.beginPath(),t.restore())},t.prototype.BI=function(t,e,o,n){var r,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,O,D,F,E=this,j=E.kj;if(nt(j)){if(!j.addSelection)return;if(l=j.ITa,u=j.mm,f=(c=l.getSelections()).length,!(n=E.VI(e,o,n)))return;if(h=i.Im.Lm("gc-selection"),(p=k(h.zIndex))>2007&&E.WI(t,e,o,n),(d=l.WIb=l.ZHb.getAnchorInfo(j.getActiveRowIndex(),j.getActiveColumnIndex()))&&E.VIb(t,e,o,n,d),y=void 0,(m=(g=E.XI(e,o,c,n)).length)<=0)return;for(C=E.XI(e,o,[j.p_a],n)[0],v=!1,b=void 0,b=0;b<m;b++)if(y=g[b],!n.containsRect(y)){v=!0;break}if(C&&!n.containsRect(C)&&(v=!0),t.save(),v&&(t.rect(n.x,n.y,K(n),Y(n)),t.clip()),t.beginPath(),m>0)for(s=i.Rm.Om(j,j.getSelectionBackColor()),t.fillStyle!==s&&(t.fillStyle=s),r=0,a=0,p>2007&&(r=1,a=-3),b=0;b<m;b++)y=g[b],t.fillRect(y.x+r,y.y+r,K(y)+a,Y(y)+a);j.sgc||(w=j.Jl,T=j.Kl,C&&(w=j.s_a,T=j.t_a),x=void 0,A=void 0,I=void 0,R=void 0,(S=j.getCellRect(w,T,e,o))&&S.intersectRect(n)&&(x=S.x,A=S.y,I=K(S),R=Y(S),r=1,a=-2,p>2007&&(r=0,a=0),E.Mx(x+r,A+r,I+a,R+a),f>1&&(t.strokeStyle=N,t.lineWidth=1,t.strokeRect(x+1.5,A+1.5,I-4,R-4)))),t.restore(),t.save(),t.beginPath(),1===f&&(u&&u.BG&&u.ZI&&u.ZI()&&!u.$I&&(M=u._I&&u._I(),D=K(O=j.getRangeRect(e,o,M)),F=Y(O),O&&D>0&&F>0&&(t.fillStyle=h&&h.color,t.fillRect(O.x,O.y,D,F))),y&&K(y)>=0&&Y(y)>=0&&(E.YI(n,j,e,o,p),E.aJ(t,e,o,y,n,c[0]))),C&&(t.save(),v&&(t.rect(n.x,n.y,K(n),Y(n)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(C.x+r,C.y+r,K(C)+a,Y(C)+a),t.fillStyle=s,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(C.x-.5,C.y-.5,K(C),Y(C)),t.restore()),t.beginPath(),t.restore()}},t.prototype.YI=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m=e.frozenTrailingRowCount(),y=e.frozenTrailingColumnCount(),C=e.getSelections(),v=e.am(),b=e.getRowCount()-m-1,w=e.getColumnCount()-y-1,T=e.Hr(1,3),S=e.Gr(1,3);1===C.length&&r>2007&&(i=e.frozenRowCount(),a=e.frozenColumnCount(),l=(s=C[0]).row,u=s.col,c=s.rowCount,f=s.colCount,i>0&&(l>=i&&e.gr(l)<i?(t.y-=2,t.height+=2):l+c<=i&&e._q(l+c-1)===e.lq&&(t.height+=2)),a>0&&(u>=a&&e.br(u)<a?(t.x-=2,t.width+=2):u+f<=a&&e.Zq(u+f-1)===e.qq&&(t.width+=2)),0===l&&0===u&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===l&&(l=0,c=e.getRowCount()),-1===u&&(u=0,f=e.getColumnCount()),h=!1,p=!1,d=S.findRow(b),g=T.findCol(w),d&&d.y+Y(d)<v.qt+e.oKc(v)&&(h=!0),g&&g.x+K(g)<v.pt+e.rKc(v)&&(p=!0),h&&l+c-1===b&&(t.height+=2),p&&u+f-1===w&&(t.width+=2))},t.prototype.WI=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O=this,D=O.kj,F=D.ITa.getSelections(),E=D.am(),j=E.kt,P=E.nt,L=F.length,G=0!==E.Cr,B=0!==E.Br;if(!(L<=0)){if(i=(r=F[0]).row,a=r.rowCount,s=r.col,l=r.colCount,-1===i&&(i=0),-1===s&&(s=0),-1===a&&(a=D.getRowCount()),-1===l&&(l=D.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=D.getSelectionBorderColor(),u=n.x,c=n.y,f=K(n),h=Y(n),p=D.frozenRowCount(),G&&(1!==L||0!==p||D.lq<=i||D.lq>=i+a))for(g=0,m=(d=O.bJ(o)).length;g<m;g++)C=0,v=0,b=(y=d[g]).x,w=y.x+K(y),y.x<u+f&&u<y.x+K(y)&&(1===L&&(0===p&&D.lq===i||p>0&&0===i)&&(C=-1,v=1),y.x<u&&(C=0,b=u),y.x+K(y)>u+f&&(v=0,w=u+f),t.moveTo(b+C-1,P-1),t.lineTo(w+v,P-1),t.stroke());if(T=D.frozenColumnCount(),B&&(1!==L||0!==T||D.qq<=s||D.qq>=s+l))for(x=0,A=(S=O.cJ(e)).length;x<A;x++)R=0,M=0,k=(I=S[x]).y,N=I.y+Y(I),I.y<c+h&&c<I.y+Y(I)&&(1===L&&(0===T&&D.qq===s||T>0&&0===s)&&(R=-1,M=1),I.y<c&&(R=0,k=c),I.y+Y(I)>c+h&&(M=0,N=c+h),t.moveTo(j-1,k+R-1),t.lineTo(j-1,N+M),t.stroke());t.beginPath(),t.restore()}},t.prototype.bJ=function(t){var e,o,n,r,a,s,l,u,c,f,h,p,d=this.kj,g=d.ITa.getSelections(),m=g.length,y=d.Hr(t),C=[],v={};for(o=0;o<m;o++)if(n=g[o])if(-1===(r=n.col))a=d.Hr(0,3),s=d.Hr(1,3),l=d.Hr(2,3),u=-1,c=-1,a.length>0&&(u=a[0].x,c=a[a.length-1].x+a[a.length-1].width-u,C.push(new i.Rect(u,-1,c,-1))),s.length>0&&(u=s[0].x,c=s[s.length-1].x+s[s.length-1].width-u,C.push(new i.Rect(u,-1,c,-1))),l.length>0&&(u=l[0].x,c=l[l.length-1].x+l[l.length-1].width-u,C.push(new i.Rect(u,-1,c,-1)));else if(y&&(f=y.findCol(r),h=y.findCol(r+n.colCount-1),f||h)){if((p=new i.Rect(-1,-1,-1,-1)).x=f?f.x:y[0].x,p.width=h?h.x+K(h)-p.x:y[y.length-1].x+y[y.length-1].width-p.x,v[e=[p.x,p.width].join("_")])continue;v[e]=!0,C.push(p)}return C},t.prototype.cJ=function(t){var e,o,n,r,a,s,l,u,c,f,h,p,d=this.kj,g=d.ITa.getSelections(),m=g.length,y=d.Gr(t),C=[],v={};for(o=0;o<m;o++)if(n=g[o])if(-1===(r=n.row))a=d.Gr(0,3),s=d.Gr(1,3),l=d.Gr(2,3),u=-1,c=-1,a.length>0&&(u=a[0].y,c=a[a.length-1].y+a[a.length-1].height-u,C.push(new i.Rect(-1,u,-1,c))),s.length>0&&(u=s[0].y,c=s[s.length-1].y+s[s.length-1].height-u,C.push(new i.Rect(-1,u,-1,c))),l.length>0&&(u=l[0].y,c=l[l.length-1].y+l[l.length-1].height-u,C.push(new i.Rect(-1,u,-1,c)));else if(y&&(f=y.findRow(r),h=y.findRow(r+n.rowCount-1),f||h)){if((p=new i.Rect(-1,-1,-1,-1)).y=f?f.y:y[0].y,p.height=h?h.y+Y(h)-p.y:y[y.length-1].y+y[y.length-1].height-p.y,v[e=[p.y,p.height].join("_")])continue;v[e]=!0,C.push(p)}return C},t.prototype.aJ=function(t,e,o,n,r,a){var s,l=this,u=l.kj,c=u.parent,f=u.mm,h=n.x,p=n.y,d=K(n),g=Y(n),m=u.getViewportTopRow(e),y=u.getViewportLeftColumn(o),C=u.getViewportBottomRow(e),v=u.getViewportRightColumn(o),b=0,w=0,T=u.am(),S=0!==T.Cr;0!==T.Br||a.col!==y&&-1!==a.col||(b=2),S||a.row!==m&&-1!==a.row||(w=2),a.row+a.rowCount===C+1&&(r.height=r.height+1),a.col+a.colCount===v+1&&(r.width=r.width+1),d>=0&&g>=0&&(!r||n.intersect(r.x-1,r.y-1,K(r)+2,Y(r)+2))&&(t.save(),r&&!r.containsRect(n)&&(t.rect(r.x-b,r.y-w,K(r),Y(r)),t.clip()),t.beginPath(),t.strokeStyle=i.Rm.Om(u,u.getSelectionBorderColor()),t.lineWidth=2,d>0&&g>0?(f&&f.BG?2===(s=f.dJ)?(t.moveTo(h+.5,p-.5),t.lineTo(h+d-1,p-.5)):3===s?(t.moveTo(h+.5,p+g-.5),t.lineTo(h+d-1,p+g-.5)):0===s?(t.moveTo(h-.5,p+.5),t.lineTo(h-.5,p+g-1)):1===s&&(t.moveTo(h+d-.5,p+.5),t.lineTo(h+d-.5,p+g-1)):(c&&c.Vv)>2007?t.rect(h-1,p-1,d+1,g+1):t.rect(h-.5,p-.5,d,g),t.stroke(),c&&c.options.allowUserDragFill&&l.eJ&&l.eJ(t,e,o,n,r)):0!==d&&0!==g||t.strokeRect(h-1,p-1,d+1,g+1),t.beginPath(),t.restore())},t.prototype.VI=function(t,e,o){var n,r,i,a,s=this.kj,l=s.am(),u=l.Ft(t,e);return 1===e&&((r=(n=s.Hr(e)).length>0?n[n.length-1]:b)&&(u.width=w(K(u),r.x+K(r)-l.pt))),1===t&&((a=(i=s.Gr(t)).length>0?i[i.length-1]:b)&&(u.height=w(Y(u),a.y+Y(a)-l.qt))),o?o.getIntersect(u.x,u.y,K(u),Y(u)):u},t.prototype.XI=function(t,e,o,n){var r,i,a,s,l=this.kj,u=l.ITa,c=o.length,f=[];for(s=0;s<c;s++)(i=o[s])&&((r=u.findSpan(i.row,i.col))&&r.containsRange(i)&&(i=r),(a=l.getRangeRect(t,e,i))&&a.x<=n.x+K(n)&&a.y<=n.y+Y(n)&&n.x<=a.x+K(a)&&n.y<=a.y+Y(a)&&f.push(a));return f},t.prototype.fJ=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p;if(t.save(),n=e.x,r=e.y,i=K(e),a=Y(e),s=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.setLineDash(s),t.rect(n,r,i-1,a-1),t.stroke();else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=o,l=s[0],u=s[1],c=void 0,f=void 0,h=void 0,p=void 0,c=n,f=r,h=i;h>0;)if(h>=l+u)t.moveTo(c,f),t.lineTo(c+l,f),c=c+l+u,h=h-l-u;else{if(h>=l){t.moveTo(c,f),t.lineTo(c+l,f),h=h-l-u;break}if(h>0){t.moveTo(c,f),t.lineTo(c+h,f),h=h-l-u;break}}for(c=n+i-1,f=r+1,p=a-1,h<0&&((h=S(h))>u&&(t.moveTo(c,f-2),t.lineTo(c,f+(h-u))),f+=h,p-=h);p>0;)p>=l+u?(t.moveTo(c,f),t.lineTo(c,f+l),f=f+l+u,p=p-l-u):p>=l?(t.moveTo(c,f),t.lineTo(c,f+l),p=p-l-u):p>0&&(t.moveTo(c,f),t.lineTo(c,f+p),p=p-l-u);for(c=n+i-2,f=r+a-1,h=i-1,p<0&&((p=S(p))>u&&(t.moveTo(c+2,f),t.lineTo(c-(p-u),f)),c-=p,h-=p);h>0;)if(h>=l+u)t.moveTo(c,f),t.lineTo(c-l,f),c=c-l-u,h=h-l-u;else{if(h>=l){t.moveTo(c,f),t.lineTo(c-l,f),h=h-l-u;break}if(h>0){t.moveTo(c,f),t.lineTo(c-h,f),h=h-l-u;break}}for(c=n,f=r+a-2,p=a-1,h<0&&((h=S(h))>u&&(t.moveTo(c,f+2),t.lineTo(c,f-(h-u))),f-=h,p-=h);p>0;)p>=l+u?(t.moveTo(c,f),t.lineTo(c,f-l),f=f-l-u,p=p-l-u):p>=l?(t.moveTo(c,f),f-l===r?t.lineTo(c,f-l-1):t.lineTo(c,f-l),p=p-l-u):p>0&&(f>r&&(t.moveTo(c,f),t.lineTo(c,f-p)),p=p-l-u);t.stroke()}t.beginPath(),t.restore()},t.prototype.XIb=function(t,e,o,n,r,i,a){var s,l,u,c,f;0!==e.length&&(s=e[0].col-1,l=e[e.length-1].col+1,u=o.zHb(n.row,s,a,1),r&&s>=0&&i.isValid&&!i.isValid(n.row,s,u)&&t.push({style:i.getDataValidator(n.row,s).highlightStyle(),x:e[0].x-i.getColumnWidth(s),y:n.y,width:i.getColumnWidth(s),height:n.height}),c=o.zHb(n.row,l,a,1),r&&i.isValid&&!i.isValid(n.row,l,c)&&(f=e[e.length-1],t.push({style:i.getDataValidator(n.row,l).highlightStyle(),x:f.x+f.width,y:n.y,width:i.getColumnWidth(l),height:n.height})))},t.prototype.YIb=function(t,e,o){var n,r,i,a,s=e.ss,l=t.row,u=t.col,c={},f={},h=[],p=t.rowCount,d=t.colCount;for(n=0;n<d;n++)f[n]=e.Tl(n+u,o);for(r=0;r<p;r++){for(c[r]=e.Sl(r+l,o),i=[],a=0;a<d;a++)i.push(s.Ym(l+r,u+a,o));h.push(i)}return{rowSizes:c,colSizes:f,styleList:h}},t.prototype.TI=function(t,e,n,i,a,s,u){var h,p,d,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,L,G,B,_,V,H,z,U,W,q,J,X,Z,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt;if(m(i)&&(i=3),d=(p=(h=this).kj).parent,y=p.am().Ft(e,n),C=d&&d.options.resizeZeroIndicator,v=p.Gr(e,i),b=p.Hr(n,i),w=p.options.sheetAreaOffset,T=p.Gt&&p.Gt()||{x:w.left,y:w.top,width:0,height:0},S=v.length,x=b.length,!(S<0||x<0)){for(I=(A=p.Ir(e,n,i,!0)).length>0,N=p.ss,F=0,E=0,j=0,L=0,_=new l.AF(p,v,b,i),V=[],H=[],z=[],U=[],W=!s&&3===i&&d&&d.options.highlightInvalidData,t.save(),t.beginPath(),q=[],J=-1,X=-1,Z=p.ar(3),Q=p.$q(3),tt=0===($=p.am()).Cr&&0===T.height,et=0===$.Br&&0===T.width,ot=!!c(this.kj),nt=o("SheetsCalc"),rt=p.getActiveRowIndex(),it=p.getActiveColumnIndex(),at=this.ZIb(i,p,rt,it),st=0;st<S;st++)for(R=v[st],h.XIb(U,b,N,R,W,p,i),lt=0;lt<x;lt++)if(M=b[lt],(k=I&&A.findCell(R.row,M.col))?(O=k.row,D=k.col,F=k.x,E=k.y,j=K(k),L=Y(k),k.isAutoMerge&&(F=(ut=h.$Ib(k,e,n,i)).x,E=ut.y,j=ut.width,L=ut.height),k.spanSizeInfo||(k.spanSizeInfo=h.YIb(k,p,i))):(O=R.row,D=M.col,F=M.x,E=R.y,j=K(M),L=Y(R)),1===C&&(-1===e&&p.getColumnVisible(D)&&0===p.$r(D)&&((X<0||X!==D-1)&&q.push({x1:F,y1:E,x2:F,y2:E+L,horizontal:!1}),X=D),-1===n&&p.getRowVisible(O)&&0===p.Yr(O)&&((J<0||J!==O-1)&&q.push({x1:F,y1:E,x2:F+j,y2:E,horizontal:!0}),J=O)),!(a&&(F+j<=a.x||F>=a.x+K(a)||E+L<=a.y||E>=a.y+Y(a))||0===j||0===L||(ct=!1,k&&f.Bb(V,k)))){if(ft=!1,G=N.zHb(O,D,i,1),ht=p.jZ&&p.jZ(),at&&0===O&&D>=at.dj&&at.cj+at.Xj>p.lq&&D<at.dj+at.OZ){if(G=p.getCell(at.cj,D).text()+"",ct=!0,ft=at.filterButtonVisible(),ht)for(pt=0;pt<ht.length;pt++)if(ht[pt].col===D&&ht[pt].rowFilter.sj===at){this._Ib(ht[pt],1,0,!0);break}}else if(ht&&ht.length>0)for(dt=ht[0].rowFilter&&ht[0].rowFilter.sj,pt=ht.length-1;pt>=0;pt--)if(ht[pt].tableColumnHeaderFilter&&ht[pt].col===D){this._Ib(ht[pt],3,dt.cj,!1);break}B=N.Ym(O,D,i),W&&p.isValid&&!p.isValid(O,D,G)&&U.push({style:p.getDataValidator(O,D).highlightStyle(),x:F,y:E,width:j,height:L}),3===i&&(gt=B.formatter,nt&&!s&&gt&&g(gt)&&((mt=p.parent&&p.parent.aJb(gt))&&(yt=mt.getExpression(),G=nt.evaluateExpression(p,yt,O,D)))),_.jF(O,D,F,E,j,L,B,k,O===Z&&tt,D===Q&&et,G),ct&&(B.hAlign=0),H.push({data:G,row:O,col:D,x:F,y:E,width:j,sparkline:ot&&p.getSparkline(O,D),height:L,style:B,cellLayout:k,tableFilter:ft}),k&&V.push(k)}if(H.length>0){if(3===i&&p.options.allowCellOverflow&&(Ct=N.Sm(e,n,(function(){return new P(p,e,n)})),(z=h.hJ(t,Ct,H,_,u)).length>0)){for(vt=a.x,bt=a.x+a.width,st=0;st<z.length;st++)(wt=z[st])&&(Tt=wt.row,St=wt.col,(xt=wt.cellOverflowLayout&&wt.cellOverflowLayout.layout)&&((At=xt.x)<vt&&(vt=At),(It=At+xt.width)>bt&&(bt=It)),_.jF(Tt,St,wt.x,wt.y,wt.width,wt.height,wt.style,wt.cellLayout,Tt===Z&&tt,St===Q&&et,wt.data));H=H.concat(z),s||(a.x=vt,a.width=bt-vt,y&&(a=a?y.getIntersectRect(a):y))}a&&(Rt=p.printInfo&&p.printInfo(),s&&Rt&&(Rt.columnStart()>0||Rt.rowStart()>0)&&!Rt.showBorder()?t.rect(a.x-(Rt.columnStart()>0?2:0),a.y-(Rt.rowStart()>0?2:0),K(a)+(Rt.columnStart()>0?4:0),Y(a)+(Rt.rowStart()>0?4:0)):t.rect(a.x,a.y,K(a),Y(a)),t.clip()),h.SI(t,H,i,s,u)}r.Worksheet.ao(p,"paintViewport",{ctx:t,rowViewportIndex:e,colViewportIndex:n,sheetArea:i,clipRect:a,isPrinting:s}),_.paint(t),q.length>0&&h.iJ(t,q,1,3),U.length>0&&(Mt=y.getIntersectRect(a),t.rect(Mt.x,Mt.y,K(Mt),Y(Mt)),t.clip(),h.jJ(t,U)),t.restore()}},t.prototype._Ib=function(t,e,o,n){t.sheetArea=e,t.row=o,t.tableColumnHeaderFilter=n},t.prototype.ZIb=function(t,e,o,n){if(e.tables&&1===t&&0===e.frozenRowCount()&&0===e.frozenColumnCount()){var r=e.tables.find(o,n);if(r&&r.MZ&&r.cj<e.lq)return r}return null},t.prototype.$Ib=function(t,e,o,n){var r,a,s,l,u,c,f,h,p,d=t.row,g=t.col,m=t.x,y=t.y,C=t.width,v=t.height,b=this.kj,w=b.am();return 1!==e||3!==n&&2!==n||(r=w.fm(e),a=b.frozenRowCount(),s=b.getRowCount(n)-b.frozenTrailingRowCount()-1,y<(l=r.y)&&a<=d&&d<=s&&(v-=l-y,y=l),y+v>l+(u=r.height)&&a<=d+t.rowCount-1&&d+t.rowCount-1<=s&&(v-=y+v-(l+u))),1!==o||3!==n&&1!==n||(r=w.gm(o),c=b.frozenColumnCount(),f=b.getColumnCount(n)-b.frozenTrailingColumnCount()-1,m<(h=r.x)&&c<=g&&g<=f&&(C-=h-m,m=h),m+C>h+(p=r.width)&&c<=g+t.colCount-1&&g+t.colCount-1<=f&&(C-=m+C-(h+p))),new i.Rect(m,y,C,v)},t.prototype.iJ=function(t,e,o,n){var r,i,a,s,l,u,c,f;if(0!==e.length)for(r=0,i=e.length;r<i;r++)s=(a=e[r]).x1,l=a.y1,u=a.x2,c=a.y2,f=a.horizontal,t.beginPath(),t.save(),t.lineWidth=o,t.strokeStyle=this.kJ(t,f,s,l,u,c),t.fillStyle=this.lJ(t,f,s,l,u,c),f?(-3,1,-1,-2,t.fillRect(s,l+-3,u-s-1,n+2*o),l+=.5,c+=.5,t.moveTo(s+-1,l+-3),t.lineTo(u+-2,c+-3),t.moveTo(s+-1,l+1),t.lineTo(u+-2,c+1)):(-3,1,0,-1,t.fillRect(s+-3,l+0,n+2*o,c-l-1),s+=.5,u+=.5,t.moveTo(s+-3,l+0),t.lineTo(u+-3,c+-1),t.moveTo(s+1,l+0),t.lineTo(u+1,c+-1)),t.stroke(),t.restore()},t.prototype.lJ=function(t,e,o,n,r,a){var s,l,u,c,f,h=e?D:F,p=i.Im.Km(0,"gc-"+h+"-normal"),d=p&&p.backgroundColor,g=p&&p.backgroundImage;if(!e&&g&&-1!==g.indexOf("linear-gradient"))for(l=i.Ul.wl(g),s=t.createLinearGradient(o,n,r,a),u=0,c=l.length;u<c;u++)f=l[u],s.addColorStop(f.point,f.color);else d&&(s=d);return s},t.prototype.kJ=function(t,e,o,n,r,a){var s=t.createLinearGradient(o,n,r,a),l=e?D:F,u=i.Im.Km(0,"gc-"+l+"-normal");return e?(s.addColorStop(0,u.borderTopColor),s.addColorStop(1,u.borderBottomColor)):(s.addColorStop(0,u.borderLeftColor),s.addColorStop(1,u.borderRightColor)),s},t.prototype.jJ=function(t,e){var o,n,r,i,a,s,l,u,c,f=this.kj.vu();if(e)for(o=e.length,n=0;n<o;n++)i=(r=e[n]).x,a=r.y,s=r.width,l=r.height,0===(c=(u=r.style).type)&&this.hyb(t,i,a,s,l,u),1===c&&this.iyb(t,i,a,s,l,u),2===c&&this.jyb(t,i,a,s,l,u,f)},t.prototype.hyb=function(t,e,o,n,r,i){var a=i.color,s=e-4,l=o-4,u=n+8,c=r+8,f=.5522848,h=u/2*f,p=c/2*f,d=s+u,g=l+c,m=s+u/2,y=l+c/2;t.save(),t.lineWidth=2,t.strokeStyle=a,t.beginPath(),t.moveTo(s,y),t.bezierCurveTo(s,y-p,m-h,l,m,l),t.bezierCurveTo(m+h,l,d,y-p,d,y),t.bezierCurveTo(d,y+p,m+h,g,m,g),t.bezierCurveTo(m-h,g,s,y+p,s,y),t.closePath(),t.stroke(),t.restore()},t.prototype.iyb=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d;e-=.5,o-=.5,h=Math.min(n/2,r/2),p=i.color,d=i.position,t.save(),t.lineWidth=2,t.strokeStyle=p,t.beginPath(),t.rect(e,o,n,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===d?(l=e,u=(s=o)+h,c=(a=e)+h,f=s):2===d?(l=a=e+n,u=(s=o+r)-h,c=a-h,f=s):3===d?(l=e,u=(s=o+r)-h,c=(a=e)+h,f=s):1===d&&(l=a=e+n,u=(s=o)+h,c=a-h,f=s),t.moveTo(a,s),t.lineTo(l,u),t.lineTo(c,f),t.fillStyle=p,t.fill(),t.closePath(),t.restore()},t.prototype.jyb=function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p;if(e-=.5,o-=.5,s=this.kj.zoom(),15,15,c=i.image,f=i.position,3,h=i.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=h,t.rect(e,o,n,r),t.stroke(),c&&"none"!==c&&a){4===f?l=e-18:5===f&&(l=e+n+3);try{a.ko(c)?(p=a.lo(c),u=o+r/2-7.5,t.drawImage(p,l,u,15,15)):a.fo(c)}catch(t){}}else 4===f?l=e-18*s:5===f&&(l=e+n+3*s),u=o+r/2-15*s/2,t.translate(l,u),t.scale(.015*s,.015*s),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=h,t.fill(),t.stroke();t.restore()},t.prototype.SI=function(t,e,o,n,a,s,l,u,f){var h,g,m,y,C,w,T,S,x,A,I,R,M,k,O,D,F,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Q,$,tt,et,ot,nt;for(void 0===l&&(l=0),void 0===u&&(u=0),void 0===f&&(f=1),g=(h=this).kj,m=3===o,y=(s?s.zoom():g.zoom())*f,C=v(h.Bl(),y),w=g.getDefaultStyle(o),T=g.Al(o),S=h.kj.conditionalFormats,x=rt(g),A=g.$q(2),I=g.ar(1),R=s?s.vu():g.vu(),t.save(),t.beginPath(),t.fillStyle=w&&w.foreColor||N,d(t,C.font),t.textAlign=m?"right":"center",O=e.length,X=[],Q={sheet:g,row:-1,col:-1,fontInfo:b,lineHeight:-1,imageLoader:R,conditionalFormats:S,sheetArea:o,parentBackColor:x},M=0;M<O;M++)j=(D=e[M]).data,z=D.tableFilter,P=D.row,L=D.col,G=D.x,B=D.y,_=K(D),V=Y(D),H=D.style,U=D.cellOverflowLayout,q=H.font?v(H.font,y):C,n&&typeof a===E&&1!==a&&(q=v(q.font,a)),H.font=q.font,_>0&&V>0&&(F=H.cellType||T,G--,B--,_++,V++,m?Q.sparkline=D.sparkline:(W=n?0:h.mJ(P,L,o),Q.visualState=W),J=p(q.font),Q.lineHeight=J,Q.row=P+l,Q.col=L+u,Q.fontInfo=q,Q.cellOverflowLayout=U,Q.needTopGridline=1===o&&P===I||0===o,Q.needLeftGridline=2===o&&L===A||0===o,Q.isPrinting=n,Q.printZoomFactor=a,F.jp(t,j,G,B,_,V,H,Q,z),U&&!Q.showBarIconOnly&&($=new i.Rect(G,B,_,V),tt=F.Ama?F.Ama(t,$,H,Q):$,X.push({cellType:F,data:j,x:tt.x,y:tt.y,width:tt.width,height:tt.height,style:H,richText:undefined,options:{sheet:g,row:P,col:L,fontInfo:q,lineHeight:J,cellOverflowLayout:U,parentBackColor:x,imageLoader:R}})));if((O=X.length)>0)for(et=g.isEditing(),ot=g.Jl,nt=g.Kl,k=0;k<O;k++)j=(Z=X[k]).data,Q=Z.options,et&&Q.row===ot&&Q.col===nt||(c(this.kj)&&j&&"SparklineExValue"===j.typeName||h.BWa(t,Z));for(t.restore(),O=e.length,M=0;M<O;M++)D=e[M],r.Worksheet.ao(g,"paintCell",{ctx:t,sheetArea:o,cell:D,isPrinting:n})},t.prototype.BWa=function(t,e){var o,n,r=e.cellType,a=e.data,s=e.x,l=e.y,u=K(e),c=Y(e),f=e.style,h=e.options,p=h.cellOverflowLayout;p&&r.uxb&&(o=p.layout,n=new i.Rect(o?o.x:s,o?o.y:l,o?o.width:u,o?o.height:c),r.uxb(t,n,h,a)),r.paintValue&&r.paintValue(t,a,s,l,u,c,f,h)},t.prototype.mJ=function(t,e,o){var n=this.kj,r=0;return nt(n)&&(3===o||m(o)?!n.isEditing()&&n.wt(t,e)?r=3:n.vp(t,e,o)&&(r=2):(n.vp(t,e,o)&&(r=1,n.wp(t,e,o)&&(r=2)),n.xt(t,e,o)&&(r=4))),r},t.prototype.hJ=function(t,e,o,n,r){var a,s,l,u,c,f,h,p,d,g,m,y,C,v,w,T,S,x,A=this.kj,I=A.ss,R=o.length,M=[],k={},N=[],O=function(S){var x,R,O,D,F,E,j,P,L,G,B,_,V,H,z;if(a=o[S],u=a.row,c=a.col,f=a.y,p=Y(a),C=e.nJ(u,t,r),v=C.headingOverflowlayouts,w=C.trailingOverflowLayouts,!k[u]){for(x={},R=0,O=C;R<O.length;R++)D=O[R],x[D.column]=!1;v&&v.forEach((function(t){x[t.column]=!1})),w&&w.forEach((function(t){x[t.column]=!1})),k[u]=x}for(F=k[u],T=C.find(c),E=0;E<T.length;E++)if(j=T[E]){if(P=A.getCellRect(u,j.column,b,b,!0),!F[j.column]){if(L=j.column,(l=I.Ym(u,L)).showEllipsis)continue;s=I.zHb(u,L,3,1,l),h=j.columnWidth,d=j.backgroundWidth,g=j.backgroundLeftWidth<0?P.x:j.backgroundRightWidth<0?P.x+K(P)-d:P.x+K(P)/2-j.backgroundLeftWidth,y={data:s,row:u,col:L,x:P.x,y:f,width:h,height:p,cellOverflowLayout:j,style:l},M.push(y),j.layout=new i.Rect(g,f,d,p),l=I.Ym(u,L),n.gF(u,L,j,l,P.x,f,h,p),F[j.column]=!0}j.column===c&&F[j.column]&&N.push(S)}if(v)for(G=0;G<v.length;G++)if((B=v[G])&&!F[B.column]&&B.contains(a.col)){if(c=B.column,(l=I.Ym(u,c)).showEllipsis)continue;s=I.zHb(u,c,3,1,l),h=B.columnWidth,d=B.backgroundWidth,_=A.getCellRect(u,B.endColumn,b,b,!0),g=_.x+K(_)-d,y={data:s,row:u,col:c,x:g,y:f,width:h,height:p,style:l,cellOverflowLayout:B},M.push(y),B.layout=new i.Rect(g,f,d,p),F[B.column]=!0,n.gF(u,c,B,l,g,f,h,p)}if(w)for(V=0;V<w.length;V++)if((H=w[V])&&!F[H.column]&&H.contains(a.col)){if(c=H.column,(l=I.Ym(u,c)).showEllipsis)continue;s=I.zHb(u,c,3,1,l),h=H.columnWidth,d=H.backgroundWidth,z=A.getCellRect(u,H.startColumn,b,b,!0),g=z.x,m=z.x+d-h,y={data:s,row:u,col:c,x:m,y:f,width:h,height:p,style:l,cellOverflowLayout:H},M.push(y),H.layout=new i.Rect(g,f,d,p),n.gF(u,c,H,l,g,f,h,p),F[H.column]=!0}};for(S=0;S<R;S++)O(S);if(N.length>0)for(x=N.length-1;x>=0;x--)o.splice(N[x],1);return M.length>0&&M.sort((function(t,e){var o=t.row,n=e.row,r=t.col,i=e.col;return o!==n?o-n:r!==i?r-i:void 0})),M},t}(),e.oJ=L,G=".cutCopyIndicator",B=i.Events.CellChanged,_=i.Events.ClipboardChanged,V=i.Events.ValueChanged,H=i.Events.ColumnChanged,z=i.Events.RowChanged,U=i.Events.RangeChanged,W=i.Events.ClipboardPasting,q=i.Events.ClipboardPasted,J=i.Events.DragMerging,X=i.Events.FloatingElementSelected,Z=function(){function t(t){var e=this;e.yJ=!1,e.zJ=!1,e.kj=t,e.AJ()}return t.prototype.jx=function(t){return 0===arguments.length?this.zJ:void(this.zJ=t)},t.prototype.BJ=function(t,e){var o,n=this;return 0===arguments.length?n.yJ:void((n.yJ!==t||t||e)&&(n.yJ=t,o=n.kj,o&&(o.$p(),m(n.Lfc)||clearTimeout(n.Lfc),n.Lfc=setTimeout((function(){if(!n.yJ){var t=o.tu();t&&t.hZ(e)}n.Lfc=b})))))},t.prototype.AJ=function(){var t=this,e=t.kj,o=!1;function n(){t.yJ&&t.BJ(!1)}function r(t,e){"resizable"!==t&&t!==e&&"isVisible"!==t&&n()}e.Fu(_+G,(function(){t.BJ(!0)})),e.Fu(V+G,n),e.Fu(B+G,n),e.Fu(H+G,(function(t,e){r(e.propertyName,"width")})),e.Fu(z+G,(function(t,e){r(e.propertyName,"height")})),e.Fu(U+G,(function(t,o){6===o.action&&e.Wu&&e.Wu.calcOnDemand||n()})),e.Fu(W+G,(function(){o=t.BJ()})),e.Fu(q+G,(function(e,n){var r,i,a,s=n.cellRange,l=n.sheet.tu(),u=l.n5,c=o;if(s&&u&&l.PA){if(t.jx()){for(i=0,a=u;i<a.length;i++)if(a[i].intersect(s.row,s.col,s.rowCount,s.colCount)){c=!1;break}}else c=!1,r=!0;t.BJ(c,r)}})),e.Fu(J+G,n),e.Fu(X+G,(function(t,o){"worksheet"!==o.type&&(e.endEdit(),i.Vl.kmb(e))}))},t.prototype.UI=function(t,e,o,n){var r,a,s,l,u,c,f,h,p,d,g,y,C;if(this.yJ&&(a=(r=this.kj).yl,l=(s=r.parent)?s.options:{},c=(u=r.tu()).n5,f=l.cutCopyIndicatorVisible,m(f)&&(f=!0),h=i.Rm.Om(r,l.cutCopyIndicatorBorderColor||"blue"),f&&u.PA===r&&c&&(p=a.VI(o,n,b),(d=a.XI(o,n,c,e))&&p))){for(t.save(),t.rect(p.x,p.y,K(p),Y(p)),t.clip(),g=0,y=d;g<y.length;g++)C=y[g],a.fJ(t,C,h);t.beginPath(),t.restore()}},t.prototype.rI=function(){this.BJ(!1)},t.prototype.sI=function(){this.BJ(!1)},t.prototype.tI=function(){this.BJ(!1)},t.prototype.uI=function(){this.BJ(!1)},t.prototype.ky=function(){this.BJ(!1)},t.prototype.no=function(){var t=this.kj;t.Gu(B+G),t.Gu(_+G),t.Gu(V+G),t.Gu(H+G),t.Gu(z+G),t.Gu(U+G),t.Gu(W+G),t.Gu(q+G),t.Gu(J+G),t.Gu(X+G)},t}(),e.CJ=Z,r.Worksheet.$n("render",{init:function(){var t=this;t.yl=new L(t),t.at=new Z(t)},dispose:function(t){var e,o=this;!1!==t.clearCache&&(o.yl&&(o.yl.kj=b,o.yl=b),(e=o.at)&&(e.no(),o.at=b))},onLayoutChanged:function(t){var e,o=this.at;o&&("addRows"===(e=t.changeType)?o.rI():"deleteRows"===e?o.sI():"addColumns"===e?o.tI():"deleteColumns"===e&&o.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p;function d(t,e){return t.getColumnCount(e)}function g(t,e){return t.getRowCount(e)}function m(t){return t.rowCount}function y(t){return t.colCount}function C(t,e,o){var n,r,i=[],a=t.length;for(r=0;r<a;r++)n=t[r],r===e?i=i.concat(o):i.push(n);return i}function v(t,e,o){for(var n=o-1;n>=0;n--)if(t.getColumnVisible(e+n))return e+n;return e+o-1}function b(t,e,o){for(var n=o-1;n>=0;n--)if(t.getRowVisible(e+n))return e+n;return e+o-1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/worksheet/worksheet.js"),r=o("./dist/core/util/common.js"),i=o("Common"),a=o("./dist/core/util/domUtil.js"),s=o("./dist/core/core.enum.js"),l=i.Common.j.Fa,u=i.Common.k.ac,c=null,f=Math.max,h=Math.min,p="gc-selection",a.GC$.extend(n.Worksheet.prototype,{addSelection:function(t,e,o,n){var i,a,s=this,l=t,c=e,f=o,h=n;-1!==l&&-1!==c&&((i=s.ITa.getSpans())&&u(i)>0&&(l=(a=s.su(i,r.kf(t,e,o,n))).row,c=a.col,f=m(a),h=y(a))),s.ITa.do("addSelection",l,c,f,h),s.$p()},setSelection:function(t,e,o,n){this.DJ(t,e,o,n,2)},DJ:function(t,e,o,n,i){var a,s,l,u=this,c=g(u),h=d(u);t>=c&&(t=c-1),e>=h&&(e=h-1),a=f(0,t),s=f(0,e),u.Tr(),l=2===i?r.Vl.Wl(u):1===i,u.Kr(a,s,u.Er(a),u.Fr(s),!l),u.addSelection(t,e,o,n)},getSelections:function(){return this.ITa.getSelections()},clearSelection:function(){var t=this;t.Tr(),t.Kr(0,0),n.Worksheet.ao(t,"clearSelection"),t.$p()},Tr:function(){this.ITa.do("clearSelection")},Qs:function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=this,m=p.options,y=m.protectionOptions,C=!1!==y.allowSelectLockedCells,v=!1!==y.allowSelectUnlockedCells;if(!m.isProtected||C&&v)return!0;if(!C&&!v)return!1;if(r=e<0,i=t<0,C===(n=o?o.locked:p.tq(t,e,"locked"))&&(i||r)){for(a=i?g(p):1,t=i?0:t,s=r?d(p):1,e=r?0:e,l=p.ITa,u=t+a-1,c=e+s-1,f=void 0,h=void 0,f=t;f<=u;f++)for(h=e;h<=c;h++)if((o=l.getStyle(f,h))&&C!==o.locked)return!1;if(i)for(f=t;f<=u;f++)if((o=l.getStyle(f,-1))&&C!==o.locked)return!1;if(r)for(h=e;h<=c;h++)if((o=l.getStyle(-1,h))&&C!==o.locked)return!1}return C===n},SZa:function(t,e,o,n){var r,i;for(e=e<0?0:e,r=t=t<0?0:t;r<t+o;r++)for(i=e;i<e+n;i++)if(this.tq(r,i,"locked"))return!0},ZZa:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].col)return!1;return!0},$Za:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].row)return!1;return!0},selectionPolicy:function(t){var e=this.ITa;return 0===arguments.length?e.getSelectionPolicy():(e.do("setSelectionPolicy",t),this)},selectionUnit:function(t){var e=this.ITa;return 0===arguments.length?e.getSelectionUnit():(e.do("setSelectionUnit",t),this)},getSelectionBackColor:function(){return this.options.selectionBackColor||r.Im.Lm(p).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||r.Im.Lm(p).borderTopColor},m_a:function(t){return t?void(this.options.m_a=t):this.options.m_a},EJ:function(){var t,e,o=this,n=o.ITa.getSelections();u(n)>0&&(t={selections:n},0!==(e=o.ITa.getActiveSelectedRangeIndex())&&(t.activeSelectedRangeIndex=e),o.FJ=t,o.Tr(),o.yl.im())},GJ:function(){var t=this,e=t.FJ,o=e&&e.selections;o&&(t.ITa.do("setSelections",o),t.ITa.do("setActiveSelectedRangeIndex",e.activeSelectedRangeIndex||0))},Ax:function(t,e,o){var n,r,i,a=this,s=a.HJ(t,e,o,a.Rr||0);s&&(n=s.row,r=s.col,i=s.leadingCellCol,a.IJ(n,r)&&(a.Qr=n,a.Rr=i,a.Jr(n,r)))},HJ:function(t,e,o,n){var r,i,a=this,s=g(a),u=d(a),f=t;return 0===f&&!o||0===s||0===u?c:(i=a.JJ(f,n),o||a.KJ(i),f=i.r,r=i.c,f<0&&o&&(((r=a.br(r))<0||l(r))&&(r=a.br(u)),n=r,f=(i=a.JJ(s,r)).r,(r=i.c)===e&&f<=t)?c:{row:f,col:r,leadingCellCol:n})},Bx:function(t,e,o){var n,r,i,a=this,s=a.LJ(t,e,o,a.Rr||0);!s||s.row===t&&s.col===e||(n=s.row,r=s.col,i=s.leadingCellCol,a.IJ(n,r)&&(a.Qr=n,a.Rr=i,a.Jr(n,r)))},LJ:function(t,e,o,n){var r,i,a=this,s=g(a),u=d(a),c=t;if((c!==s-1||o)&&0!==s&&0!==u&&(i=a.MJ(c,n),o||a.KJ(i),c=i.r,r=i.c,!(c===s&&o&&(r=a.Zq(r),(r>=u||l(r))&&(r=a.Zq(-1)),n=r,i=a.MJ(-1,r),c=i.r,r=i.c,r===e&&c>=t))))return{row:c,col:r,leadingCellCol:n}},Dx:function(){var t,e,o=this,n=o.NJ();n&&(t=n.row,e=n.col,o.Qr=t,o.Rr=e,o.Jr(t,e))},NJ:function(){var t,e,o,n,r=this,i=r.ir(),a=r.dr(),s=a;if(!i&&!s)return c;if(o=!1!==(e=(t=r.options).protectionOptions).allowSelectLockedCells,n=!1!==e.allowSelectUnlockedCells,!t.isProtected||o&&n)return{row:i,col:s};if(!o&&!n)return c;for(;i!==c&&i>=0;i=r.gr(i))for(s=a;s!==c&&s>=0;s=r.br(s))if(o===r.tq(i,s,"locked"))return{row:i,col:s};return c},Cx:function(){var t,e,o=this,n=o.OJ();n&&(t=n.row,e=n.col,o.Qr=t,o.Rr=e,o.Jr(t,e))},OJ:function(){var t,e,o,n,r=this,i=r._q(r.frozenRowCount()-1),a=r.Zq(r.frozenColumnCount()-1),s=a,l=r.ir(),u=r.dr();if(i===c||s===c)return c;if(o=!1!==(e=(t=r.options).protectionOptions).allowSelectLockedCells,n=!1!==e.allowSelectUnlockedCells,!t.isProtected||o&&n)return{row:i,col:s};if(!o&&!n)return c;for(;i!==c&&i<=l;i=r._q(i))for(s=a;s!==c&&s<=u;s=r.Zq(s))if(o===r.tq(i,s,"locked"))return{row:i,col:s};return c},zx:function(t,e,o){var n,r,i,a,s=this,l=s.tables;o?(n=l&&l.bJb(t,e))||(n=s.iy(t,e,o,s.Qr||0)):n=s.iy(t,e,o,s.Qr||0),n&&(r=n.row,i=n.col,a=n.leadingCellRow,s.IJ(r,i)&&(s.Qr=a,s.Rr=i,s.Jr(r,i)))},iy:function(t,e,o,n){var r,i,a,s=this,u=g(s),f=d(s),h=e;if(0===h&&!o||0===u||0===f)return c;for(i=s.PJ(n,h),a=n,o||s.KJ(i),r=i.r,h=i.c;h<0&&o;){if(((r=s.gr(r,3,!0))<0||l(r))&&(r=s.gr(u,3,!0)),n=r,r=(i=s.PJ(n,f)).r,h=i.c,r===t&&h<e)return c;if(r===t&&h===e){if(n===a)return c;r=(i=s.PJ(n,h)).r,h=i.c}}return{row:r,col:h,leadingCellRow:n}},KJ:function(t){var e,o=this,n=!1;t.r<0?t.r=o.ar():t.r>=g(o)&&(t.r=o.ir(),n=!0),t.c<0?t.c=o.$q():t.c>=d(o)&&(t.c=o.dr(),n=!0),n&&((e=o.ITa.getSpan(t.r,t.c)).row!==t.r&&(t.r=e.row),e.col!==t.c&&(t.c=e.col))},Fx:function(t,e){for(var o,n,r=this,i=r.ITa,a=i.getActiveSelectedRangeIndex(),s=-1,l=r.Tq(r.Ix()),u=l.row,c=l.col,f=l.col+y(l)-1,h=t,p=e;h=(o=r.QJ(h,p)).r,!((p=o.c)>=c);){if(s===a&&h===t&&p<=e)return;--h>=u?p=f+1:(n=r.Tq(r.Ix(3)),s=i.getActiveSelectedRangeIndex(),u=n.row,c=n.col,f=n.col+y(n)-1,h=n.row+m(n)-1,p=n.col+y(n))}h>=0&&(r.Jr(h,p),r.Qr=h,r.Rr=p)},Gx:function(t,e){for(var o,n,r=this,i=r.ITa,a=i.getActiveSelectedRangeIndex(),s=-1,l=r.Tq(r.Ix()),u=l.col,c=l.row+m(l)-1,f=l.col+y(l)-1,h=t,p=e;h=(o=r.RJ(h,p)).r,!((p=o.c)<=f);){if(s===a&&h===t&&p>=e)return;++h<=c?p=u-1:(n=r.Tq(r.Ix(4)),s=i.getActiveSelectedRangeIndex(),u=n.col,c=n.row+m(n)-1,f=n.col+y(n)-1,h=n.row,p=n.col-1)}h>=0&&(r.Jr(h,p),r.Qr=h,r.Rr=p)},Rs:function(t,e,o){var n,r,i,a,s=this,l=s.tables;o?(n=l&&l.cJb(t,e))||(n=s.hy(t,e,o,s.Qr||0)):n=s.hy(t,e,o,s.Qr||0),!n||n.row===t&&n.col===e||(r=n.row,i=n.col,a=n.leadingCellRow,s.IJ(r,i)&&(s.Qr=a,s.Rr=i,s.Jr(r,i)))},hy:function(t,e,o,n){var r,i,a,s=this,u=g(s),f=d(s),h=e;if(h===f-1&&!o||0===u||0===f)return c;for(i=s.SJ(n,h),a=n,o||s.KJ(i),r=i.r,h=i.c;h===f&&o;){if(!(t!==u-1||t!==r||s.getRowVisible(r,3)&&s.Sl(r,3)>0))return c;if(((r=s._q(r,3,!0))>=u||l(r))&&(r=s._q(-1,3,!0)),n=r,r=(i=s.SJ(n,-1)).r,h=i.c,r===t&&h>e)return c;if(r===t&&h===e){if(n===a)return c;r=(i=s.SJ(n,h)).r,h=i.c}}return{row:r,col:h,leadingCellRow:n}},PJ:function(t,e){for(var o,n,i,a=e;a>=0&&(o=t,!(--a<0));)if((n=this.ITa.getSpans(r.kf(o,a,1,1)))&&u(n)>0&&(a>=(i=n[0]).col&&(a=i.col,o=i.row)),this.IJ(o,a))return{r:o,c:a};return{r:o,c:a}},QJ:function(t,e){for(var o,n,r=this;e>=0&&!(--e<0);){if(o=r.ITa.findSpan(t,e)){if(!((n=r.Ix()).row<=o.row&&o.row+m(o)<=n.row+m(n)&&n.col<=o.col&&o.col+y(o)<=n.col+y(n)))continue;if(o.row!==t||o.col!==e)continue;e>=o.col&&(e=o.col,t=o.row)}if(r.IJ(t,e))return{r:t,c:e}}return{r:t,c:e}},SJ:function(t,e){for(var o,n,i,a,s=this,l=d(s),c=e;c<l&&(o=t,!((c=(n=s.ITa.getSpan(o,c)).col+y(n))>=l));)if((i=s.ITa.getSpans(r.kf(o,c,1,1)))&&u(i)>0&&(c>(a=i[0]).col?c=f(c,a.col+y(a)):o=a.row),s.IJ(o,c))return{r:o,c:c};return{r:o,c:c}},RJ:function(t,e){for(var o,n,r,i=this,a=i.ITa,s=d(i);e<s&&!((e=(o=a.getSpan(t,e)).col+y(o))>=s);){if(n=a.findSpan(t,e)){if(!((r=i.Ix()).row<=n.row&&n.row+m(n)<=r.row+m(r)&&r.col<=n.col&&n.col+y(n)<=r.col+y(r)))continue;if(n.row!==t||n.col!==e)continue;e>n.col?e=f(e,n.col+y(n)):t=n.row}if(i.IJ(t,e))return{r:t,c:e}}return{r:t,c:e}},IJ:function(t,e){var o,n,r=this;return!!r.Qs(t,e)&&(o=t>=0&&t<g(r)&&e>=0&&e<d(r)&&r.getRowVisible(t)&&r.getColumnVisible(e)&&r.Sl(t)>0&&r.Tl(e)>0,n=!!r.Tx,!0===o&&!0===n&&(!1===r.tq(t,e,"tabStop")&&(o=!1)),o)},JJ:function(t,e){for(var o,n;t>=0&&!(--t<0);)if((o=this.ITa.getSpans(r.kf(t,e,1,1)))&&u(o)>0&&(t>=(n=o[0]).row&&(t=n.row,e=n.col)),this.IJ(t,e))return{r:t,c:e};return{r:t,c:e}},MJ:function(t,e){for(var o,n,i,a=this,s=g(a);t<s&&!((t=(o=a.ITa.getSpan(t,e)).row+m(o))>=s);)if((n=a.ITa.getSpans(r.kf(t,e,1,1)))&&u(n)>0&&(t>(i=n[0]).row?t=f(t,i.row+m(i)):e=i.col),a.IJ(t,e))return{r:t,c:e};return{r:t,c:e}},Ur:function(t,e,o,n,r){var i=this;i.ITa.do("addSelection",t,e,o,n),r&&i.Xq<=0&&i.yl.im()},aH:function(t,e,o){var n=this,r=n.Jx(t,e,n.Jl,n.Kl),i=r.row,a=r.col,s=m(r),l=y(r),u=n.selectionPolicy(),c=n.selectionUnit();0!==u&&(1===u&&n.ITa.do("clearSelection"),1===c?(a=-1,l=-1):2===c&&(i=-1,s=-1),n.Kx(i,a,s,l,o))},Jx:function(t,e,o,n,i){var a,s,c,f,h,p=this;return l(o)&&(o=p.Jl),l(n)&&(n=p.Kl),s=(a=p.ITa).getSpan(o,n),c=a.getSpan(t,e),i&&s.equals(c)?new r.Range(s.row,s.col,1,1):(f=s.union(c),(h=p.ITa.getSpans())&&u(h)>0&&(f=p.TJ(h,f)),f)},Kx:function(t,e,o,n,i){var a,s,l,c,f,h,p=this,d=p.ITa,g=p.Ix();if(u(d.getSelections())>0?(s=r.kf(t,e,o,n),p.n_a?(a=p.p_a,p.p_a=s):((l=d.getSelections())[d.getActiveSelectedRangeIndex()]=s,d.do("setSelections",l))):p.n_a||d.do("addSelection",t,e,o,n),i&&p.Xq<=0){if(c=p.Ix(),!p.n_a&&c.row===g.row&&c.col===g.col&&m(c)===m(g)&&y(c)===y(g))return;f=p.yl,p.n_a&&(h=p.p_a,a&&a.containsRange(h)?h=a:a&&(h=a.union(h)),g=(h=h.union(r.kf(p.getActiveRowIndex(),p.getActiveColumnIndex(),1,1))).union(g),c=h.union(c)),g.containsRange(c)?f.im(g):c.containsRange(g)?f.im(c):(f.im(g),f.im(c),f.im(p.p_a))}},kyb:function(t){var e=[];return t&&(e=this.ITa.getSpans(t)),e},lyb:function(t,e){var o,n=t.row,r=t.col,i=t.rowCount,a=t.colCount,s=e.row,l=e.col,u=e.rowCount,c=e.colCount,f=n+i,h=r+a,p=s+u,d=l+c,g=!1,m=!1;return t.intersect(s,l,u,c)&&(g=o=n>s||r>l||f<p||h<d,m=!o),e.myb=e.myb||m,g},nyb:function(t,e,o,n){var r,i=[],a=[];for(r=0;r<t.length;r++)a=this.oyb(t[r],e,o,n),i=i.concat(a);return i},oyb:function(t,e,o,n){var r,i,a,s,l,u=[],c=e.length;for(u.push(t),s=c-1;s>=0;s--)for(i=e[s],l=0;l<u.length;)r=u[l],this.lyb(r,i)?(u=C(u,l,a=this.v_a(r,i,o,n)),l+=a.length):l++;return u},pyb:function(t,e){var o=e.row,n=e.col,r=e.rowCount,i=e.colCount;return t.intersect(o,n,r,i)},qyb:function(t,e){var o,n,r=[];for(n=t.length-1;n>=0;n--)o=t[n],this.pyb(o,e)||r.push(o);return r},ryb:function(t){var e=!1,o=this.ITa.getSpans(t);return 1===o.length&&(e=t.equals(o[0])),e},syb:function(t,e){var o,n,r,i=t,a=e.length,s=i.length,l=!0;for(n=a-1;n>=0;n--){for(o=e[n],r=s-1;r>=0;r--)if(i[r].equals(o)){l=!1;break}l&&i.push(o)}return i},tyb:function(t){var e,o,n,r,i=[];for(o=t.length-1;o>=0;o--)(e=t[o]).myb&&(delete e.myb,i.push(o));for(n=i.length,r=0;r<n;r++)t.splice(i[r],1)},v_a:function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g,m,y;return e=this.Tq(e),i=[],a=t.getIntersect(e,o,n),t&&a?(s=t.row>=0?t.row:0,l=t.col>=0?t.col:0,u=t.rowCount,c=t.colCount,f=a.row,h=a.col,p=a.rowCount,g=l+c,y=h+a.colCount,(d=s+u)-(m=f+p)>0&&i.push(r.kf(m,l,d-m,c)),g-y>0&&i.push(r.kf(f,y,p,g-y)),h-l>0&&i.push(r.kf(f,l,p,h-l)),f-s>0&&i.push(r.kf(s,l,f-s,c))):i.push(t),i},u_a:function(t,e){var o,n,r,i,a,s,l,c,f,h,p=[],d=this.getRowCount(3),g=this.getColumnCount(3),m=this.deselectIgnoreSpan();if(t&&t.length>0){for(n=[],r=[],i=[],a=void 0,s=void 0,o=!1,l=t.length-1;l>=0;l--)a=t[l],m||!this.ryb(a)||this.pyb(a,e)?(n=this.v_a(a,e,d,g),m||(s=this.kyb(a)).length>0&&(n=this.nyb(n,s,d,g),i=this.qyb(s,e),r=this.syb(r,i),this.tyb(r)),c=u(n),!o&&c>0&&(this.setSelection(n[c-1].row,n[c-1].col,1,1),o=!0),p=n.concat(p)):r=this.syb(r,[a]);m||(p=r.concat(p))}for(this.Tr(),f=p.length,this.suspendPaint(),h=0;h<f;h++)this.addSelection(p[h].row,p[h].col,p[h].rowCount,p[h].colCount);o||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(t,e){var o,n,r,i,a,s,l,c,f,h=this,p=h.ITa.getSelections();if(!(u(p)<=0)&&(o=h.Ix(),n=h.UJ(o,t,e))){if(r=n.row,i=n.col,a=m(n),s=y(n),l=h.selectionPolicy(),c=h.selectionUnit(),0===l)return;1===l&&h.ITa.do("clearSelection"),1===c?(i=-1,s=-1):2===c&&(r=-1,a=-1),h.Kx(r,i,a,s,!0),f=h.ITa.getSelections(),h.mm.zu(p,f)&&(h.yu(p,f),h.Au(p))}},UJ:function(t,e,o,n,r){var i=this,a=i.Tq(t),s=c;return 37===e?s=o?i.VJ(a,!1,n,r):i.WJ(a,n,r):39===e?s=o?i.XJ(a,!1,n,r):i.YJ(a,n,r):38===e?s=o?i.ZJ(a,!1,n,r):i.$J(a,n,r):40===e?s=o?i._J(a,!1,n,r):i.aK(a,n,r):36===e?s=o?i.bK(a,n,r):i.cK(a,n,r):35===e?s=o?i.dK(a,n,r):i.eK(a,n,r):33===e?s=i.fK(a,n,r):34===e&&(s=i.gK(a,n,r)),s&&(t.row<0&&(s.row=-1,s.rowCount=i.getRowCount()),t.col<0&&(s.col=-1,s.colCount=i.getColumnCount())),s},WJ:function(t,e,o){for(var n,i,a,s,l,u,p,d,g=this,C=t.row,v=t.col,w=m(t),T=y(t),S=v+T-1,x=b(g,C,w);S>0;)if(S--,g.IJ(x,S)&&(n=g.Jx(x,S,e,o),i=h(C,n.row),a=h(v,n.col),l=f(C+w-1,n.row+m(n)-1)-i+1,u=(s=h(v+T-1,n.col+y(n)-1))-a+1,i!==C||a!==v||l!==w||u!==T))return p=g.qq,v<(d=g.Kl)?a<=p&&g.rq(a):v===d&&s<=p&&g.rq(s),g.parent&&g.parent.options.scrollByPixel&&a===p&&0!==g.eCb&&g.rq(a,0),r.kf(i,a,l,u);return c},VJ:function(t,e,o,n){var i,a,s,u,c,p=this,d=t.row,g=t.col,C=p.frozenColumnCount(),v=C?p.Zq(C-1):p.$q(),b=e?v:p.$q();if(!l(b))return(C<=0||e)&&p.rq(b),i=p.Jx(d,b,o,n),a=h(d,i.row),s=h(g,i.col),u=f(d+m(t)-1,i.row+m(i)-1)-a+1,c=h(g+y(t)-1,i.col+y(i)-1)-s+1,r.kf(a,s,u,c)},lCb:function(t){var e,o,n,r,i,a=this;if(a.parent&&a.parent.options.scrollByPixel){for(n=a.ss,r=a.Fr(t),i=a.getViewportWidth(r);0<=t&&!((i-=n._m(t))<0);t--);e=t,o=i}else e=a.gXc(t,2).col,o=0;return{dj:e,UP:o}},YJ:function(t,e,o){for(var n,i,a,s,l,u,p,g,C,v=this,w=t.row,T=t.col,S=m(t),x=y(t),A=T,I=d(v)-1,R=b(v,w,S);A<I;)if(A++,v.IJ(R,A)&&(n=v.Jx(R,A,e,o),i=h(w,n.row),a=f(T,n.col),l=f(w+S-1,n.row+m(n)-1)-i+1,u=(s=f(T+x-1,n.col+y(n)-1))-a+1,i!==w||a!==T||l!==S||u!==x))return p=v.Aw(),T<(g=v.Kl)?a>=p&&(C=v.lCb(a),v.rq(C.dj,C.UP)):T===g&&s>=p&&(C=v.lCb(s),v.rq(C.dj,C.UP)),r.kf(i,a,l,u);return c},XJ:function(t,e,o,n){var i,a,s,u,c,p,d=this,g=t.row,C=t.col,v=d.lr();if(!l(v))return d.rq(v),i=d.dr(),e||(i+=d.frozenTrailingColumnCount()),a=d.Jx(g,i,o,n),s=h(g,a.row),u=f(C,a.col),c=f(g+m(t)-1,a.row+m(a)-1)-s+1,p=f(C+y(t)-1,a.col+y(a)-1)-u+1,r.kf(s,u,c,p)},$J:function(t,e,o){for(var n,i,a,s,l,u,p,d,g=this,C=t.row,b=t.col,w=m(t),T=y(t),S=C+w-1,x=v(g,b,T);S>0;)if(S--,g.IJ(S,x)&&(n=g.Jx(S,x,e,o),i=h(C,n.row),a=h(b,n.col),l=(s=h(C+w-1,n.row+m(n)-1))-i+1,u=f(b+T-1,n.col+y(n)-1)-a+1,i!==C||a!==b||l!==w||u!==T))return p=g.lq,C<(d=g.Jl)?i<=p&&g.mq(i):C===d&&s<=p&&g.mq(s),g.parent&&g.parent.options.scrollByPixel&&i===p&&0!==g.cCb&&g.mq(i,0),r.kf(i,a,l,u);return c},ZJ:function(t,e,o,n){var i,a,s,u,c,p=this,d=t.row,g=t.col,C=p.frozenRowCount(),v=C?p._q(C-1):p.ar(),b=e?v:p.ar();if(!l(b))return(C<=0||e)&&p.mq(b),i=p.Jx(b,g,o,n),a=h(d,i.row),s=h(g,i.col),u=h(d+m(t)-1,i.row+m(i)-1)-a+1,c=f(g+y(t)-1,i.col+y(i)-1)-s+1,r.kf(a,s,u,c)},mCb:function(t){var e,o,n,r,i,a=this;if(a.parent&&a.parent.options.scrollByPixel){for(n=a.ss,r=a.Er(t),i=a.getViewportHeight(r);0<=t&&!((i-=n.Sl(t))<0);t--);e=t,o=i}else e=a.ms(t,2),o=0;return{cj:e,UP:o}},aK:function(t,e,o){for(var n,i,a,s,l,u,p,d,C,b=this,w=t.row,T=t.col,S=m(t),x=y(t),A=w,I=g(b)-1,R=v(b,T,x);A<I;)if(A++,b.IJ(A,R)&&(n=b.Jx(A,R,e,o),i=f(w,n.row),a=h(T,n.col),l=(s=f(w+S-1,n.row+m(n)-1))-i+1,u=f(T+x-1,n.col+y(n)-1)-a+1,i!==w||a!==T||l!==S||u!==x))return p=b.Fw(),w<(d=b.Jl)?i>=p&&(C=b.mCb(i),b.mq(C.cj,C.UP)):w===d&&s>=p&&(C=b.mCb(s),b.mq(C.cj,C.UP)),r.kf(i,a,l,u);return c},_J:function(t,e,o,n){var i,a,s,u,c,p,d=this,g=t.row,C=t.col,v=d.kr();if(!l(v))return d.mq(v),i=d.ir(),e||(i+=d.frozenTrailingRowCount()),a=d.Jx(i,C,o,n),s=f(g,a.row),u=h(C,a.col),c=f(g+m(t)-1,a.row+m(a)-1)-s+1,p=f(C+y(t)-1,a.col+y(a)-1)-u+1,r.kf(s,u,c,p)},cK:function(t,e,o){for(var n,i,a,s,l,u=this,p=t.row,d=t.col,g=m(t),C=y(t),v=u.frozenColumnCount()-1,b=u.Kl,w=p+g-1;v<b;)if(v++,u.IJ(w,v)){if(d<=v&&d+C-1===u.Kl)break;return n=u.Jx(w,v,e,o),i=h(p,n.row),a=h(d,n.col),s=f(p+g-1,n.row+m(n)-1)-i+1,l=h(d+C-1,n.col+y(n)-1)-a+1,u.rq(u.$q()),r.kf(i,a,s,l)}return c},bK:function(t,e,o){return t=this.VJ(t,!0,e,o),this.ZJ(t,!0,e,o)},eK:function(t,e,o){for(var n,i,a,s,l,u=this,p=t.row,g=t.col,C=m(t),v=y(t),b=d(u),w=u.Kl,T=p+C-1;b>w;)if(b--,u.IJ(T,b)){if(g+v-1>=b&&g===u.Kl)break;return n=u.Jx(T,b,e,o),i=h(p,n.row),a=f(g,n.col),s=f(p+C-1,n.row+m(n)-1)-i+1,l=f(g+v-1,n.col+y(n)-1)-a+1,u.rq(u.lr()),r.kf(i,a,s,l)}return c},dK:function(t,e,o){return t=this.XJ(t,!0,e,o),this._J(t,!0,e,o)},fK:function(t,e,o){var n,i,a,s,p,d,g,C=this,v=t.row,b=t.col,w=m(t),T=C.Ew();return l(T)?c:(n=C.Gr(1),i=-1,C.mq(T)?i=C._q(v+w-1-u(n)):C.frozenRowCount()<=0&&(i=C.ar()),i<C.lq?i=C.lq:i>=C.Fw()&&(i=C.gr(C.Fw())),a=C.Jx(i,b,e,o),s=h(v,a.row),p=h(b,a.col),d=h(v+w-1,a.row+m(a)-1)-s+1,g=f(b+y(t)-1,a.col+y(a)-1)-p+1,r.kf(s,p,d,g))},gK:function(t,e,o){var n,i,a,s,p,d,g,C=this,v=t.row,b=t.col,w=m(t),T=C.$x();return l(T)?c:(n=C.Gr(1),C.mq(T),(i=C.gr(v+w-1+u(n)))<C.lq?i=C.lq:i>=C.Fw()&&(i=C.lq>=C.kr()?C.Fw():C.gr(C.Fw())),a=C.Jx(i,b,e,o),s=f(v,a.row),p=h(b,a.col),d=f(v+w-1,a.row+m(a)-1)-s+1,g=f(b+y(t)-1,a.col+y(a)-1)-p+1,r.kf(s,p,d,g))},Ew:function(){var t,e,o,n,r,i=this,a=i.Gr(1);if(!a||u(a)<=0)return c;for(e=(t=i.frozenRowCount())?i._q(t-1):i.ar(),o=0,n=i.lq,r=i.am();n>e&&(n--,!((o+=i.Sl(n))>i.oKc(r))););return n},zw:function(){var t,e,o,n,r,i=this,a=i.Hr(1);if(!a||u(a)<=0)return c;for(e=(t=i.frozenColumnCount())?i.Zq(t-1):i.$q(),o=0,n=i.qq,r=i.am();n>e&&(n--,!((o+=i.Tl(n))>i.rKc(r))););return n},$x:function(){var t,e=this.Gr(1),o=u(e);return e&&o>0?(t=e[o-1].row,this.ir()<=t?this.lq:t):c},kr:function(){var t,e,o,n,r,i,a=this;if(a.ir()===a.Fw()&&(t=a.am(),e=a.Gr(1),o=u(e),e&&o>=1&&(n=e[o-1]).y+n.height<=t.qt+a.oKc(t)))return a.lq;r=a.lq;try{return a.lq=a.ir(),i=a.Ew(),i=a._q(i)}catch(t){}finally{a.lq=r}},lr:function(){var t,e,o,n,r,i,a=this;if(a.dr()===a.Aw()&&(t=a.am(),e=a.Hr(1),o=u(e),e&&o>=1&&(n=e[o-1]).x+n.width<=t.pt+t.width))return a.qq;for(t=a.am(),r=0,i=a.dr();i>0&&!((r+=a.Tl(i))>a.rKc(t));)i--;return i>0&&(i=a.Zq(i)),i},Fw:function(){var t=this.Gr(1),e=u(t);return t&&e>0?t[e-1].row:c},Aw:function(){var t=this.Hr(1),e=u(t);return t&&e>0?t[e-1].col:c},hr:function(){var t,e,o=this,n=o.Gr(1),r=u(n);return n&&r>0?(t=o.am(),n[e=r-1].y+n[e].height<=t.qt+o.oKc(t)?n[e].row:n[f(e-1,0)].row):c},cr:function(){var t,e,o=this,n=o.Hr(1),r=u(n);return n&&r>0?(t=o.am(),n[e=r-1].x+n[e].width<=t.pt+o.rKc(t)?n[e].col:n[f(e-1,0)].col):c},ir:function(t){l(t)&&(t=3);var e=g(this,t);return 3!==t&&2!==t||(e-=this.frozenTrailingRowCount()),this.gr(e,t)},dr:function(t){l(t)&&(t=3);var e=d(this,t);return 3!==t&&1!==t||(e-=this.frozenTrailingColumnCount()),this.br(e,t)},TJ:function(t,e){var o,n,r;if(t)for(o=0,n=u(t);o<n;o++)if(r=t[o],e.intersect(r.row,r.col,m(r),y(r)))return t.splice(o,1),o--,this.TJ(t,e.union(r));return e},Ix:function(t){var e,o=this.ITa,n=u(o.getSelections()),i=r.kf(-1,-1,0,0);return n<=0||(e=o.getActiveSelectedRangeIndex(),3===t?(--e<0&&(e=n-1),o.do("setActiveSelectedRangeIndex",e)):4===t&&(++e>=n&&(e=0),o.do("setActiveSelectedRangeIndex",e)),(e=o.getActiveSelectedRangeIndex())>=0&&(i=o.getSelections()[e])),i}}),n.Worksheet.$n("selection",{init:function(){this.ITa.do("addSelection",0,0,1,1),this.ITa.setCellState(0,0,s.CellStatesType.active,!0,s.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C;function v(t,e,o){for(var n=t[o-e];n<o;)n=t[n-e];return n}function b(t,e){return"object"==typeof t?JSON.stringify(t):(t=e.getColor(t),n.Common.pc.bc(n.Common.pc.ec(t)))}function w(t,e){return t instanceof Date&&e instanceof Date?h(t)===h(e):typeof t===m&&typeof e===m?t.toLowerCase()===e.toLowerCase():t===e}function T(t,e,o,n,r){var i,a,s=t.currentTheme();return d(e)||(i=r?e.backColor:e.foreColor,d(i)||(i=b(i,s))),d(o)||(a=r?o.backColor:o.foreColor,d(a)||(a=b(a,s))),(i=i||"")===(a=a||"")?0:i===n?1:a===n?-1:0}function S(t,e){var o,n,r,i,a;return t instanceof Date&&(t=h(t)),e instanceof Date&&(e=h(e)),r=(o=typeof t)===m,i=(n=typeof e)===m,a=n===y,o===n||o!==y&&!a?!(o!==g||!i)||(!r||n!==g)&&(r&&i?t.toLowerCase()>e.toLowerCase():t>e):a}function x(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,g,m,C,v,b,x,A=r,I=t,R=e;if(A)for(s=0;s<A.length&&(A[s]&&(l=A[s].ascending,0<=(u=A[s].index)&&(c=void 0,f=void 0,h=n?I:u,p=n?u:I,g=n?R:u,m=n?u:R,i?(c=i[h][p],f=i[g][m]):(c=o.getValue(h,p),f=o.getValue(g,m)),A[s].compareFunction?(a=A[s].compareFunction(c,f),l||(a*=-1)):d(A[s].color)?(b=d(c)||""===c||typeof c===y&&isNaN(c),x=d(f)||""===f||typeof f===y&&isNaN(f),b||x?b&&x?a=0:b&&!x?a=1:!b&&x&&(a=-1):a=w(c,f)?0:S(c,f)?l?1:-1:l?-1:1):(void 0,void 0,C=o.getActualStyle(h,p,3,!1,!1,!0),v=o.getActualStyle(g,m,3,!1,!1,!0),a=T(o,C,v,A[s].color,A[s].isBackColor),l||(a*=-1)))),0===a);s++);return a}function A(t,e,o,n,r){var i,a,s,l,u,c,f,h=t.length;if(h<=1)return t;for(a=t[i=Math.floor(h/2)],s=[],l=[],u=[],c=0;c<h;c++)i!==c?(f=x(t[c],a,e,o,n,r))<0?s.push(t[c]):f>0?l.push(t[c]):u.push(t[c]):u.push(t[c]);return A(s,e,o,n,r).concat(u,A(l,e,o,n,r))}function I(t,e,o,n,r,i,a){var s,l,u=e?t.rowOutlines:t.columnOutlines,c=[],f=[];if(e){for(s=i;s<i+a;s++)t.Ps(s)||t.rowOutlines&&t.rowOutlines.isCollapsed(s)||(t.getRowVisible(s,3,!0)?0===t.getRowHeight(s)&&(c.push(s),t.setRowHeight(s,t.defaults.rowHeight)):(f.push(s),t.setRowVisible(s,!0)));for(u.nec(o.groupSwap,o.array,r.start),s=0;s<f.length;s++)l=p.Cb(n,f[s])+i,t.setRowVisible(l,!1);for(s=0;s<c.length;s++)l=p.Cb(n,c[s])+i,t.setRowHeight(l,0)}else{for(s=i;s<i+a;s++)t.columnOutlines&&t.columnOutlines.isCollapsed(s)||(t.getColumnVisible(s,3)?0===t.getColumnWidth(s)&&(c.push(s),t.setColumnWidth(s,t.defaults.colWidth)):(f.push(s),t.setColumnVisible(s,!0)));for(u.nec(o.groupSwap,o.array,r.start),s=0;s<f.length;s++)l=p.Cb(n,f[s])+i,t.setColumnVisible(l,!1);for(s=0;s<c.length;s++)l=p.Cb(n,c[s])+i,t.setColumnWidth(l,0)}}function R(t,e,o){var n=t.qg(e,o,!1);n&&n.hasListeners()&&n.Yg()}function M(t,e,n,r){var i,a,s=o("SheetsCalc");s&&(i=s.CalcOperatorAdjustor.zj(t.xf,t.xf,t.Kf(e,n),e,n,0,0),t.Rf(e,n,i,r),(a=t.qg(e,n,!!i))&&a.og())}function k(t,e,o,n,r,i,a,s,l,u,c,f){var h,p,d,g,m,y,C,b,w,T,S,x=t.ITa,A=x.Ky,I=A&&A.sV.length>0,k=i?e:o,N=i?e+n:o+r,O=i?o:e,D=i?o+r:e+n;for(T=k;T<N;T++)if(T!==(w=v(s,k,T)))for(i?(h=T,d=w):(p=T,g=w),S=O;S<D;S++)i?(p=S,g=S):(h=S,d=S),a&&(m=l[h][p],y=l[d][g]),I&&(C=A.get(h,p),b=A.get(d,g)),c&&f&&(R(c,h,p),R(c,d,g),c._f(h,p,d,g),M(c,h,p),M(c,d,g)),x.do("swapNode",h,p,d,g),t.uja&&t.wja(h,p,d,g),I&&A.qUa(C,h,p,b,d,g),a&&(l[h][p]=y,l[d][g]=m),u.push({row:h,col:p}),u.push({row:d,col:g})}function N(t,e,o,n,r,i,s,u,c,f,h){var p,d,g,m,y,v,b,w=[],T=t.ITa.WTa;if(T>0&&e&&(t.ITa.WTa=0,[].push.apply(t.ITa.zTa,[{row:o,column:n,rowCount:r,columnCount:i,byRows:s,sortInfo:u,type:"sortRange",array:f.concat([])}])),p=l&&t.Bj(),d=l&&t.yj(),k(t,o,n,r,i,s,c,f,h,w,p,d),c)for(g=o;g<o+r;g++)for(m=n;m<n+i;m++)t.setValue(g,m,h[g][m]);if(p){for(y=o;y<o+r;y++)for(v=n;v<n+i;v++)(b=p.Kf(y,v))&&p.fg(y,v,b,C);t.getCalcService().recalcRange(d,o,n,r,i)}return a.Worksheet.ao(t,"sortRangeChanged",{column:n,columnCount:i}),T>0&&(t.ITa.WTa=T),w}function O(t,e,o,n,r,i,a,s,u,c){var f,h,p,d,g,m;t.suspendPaint(),t.suspendEvent(),l&&t.suspendCalcService();try{if(c)for(h=[],p=e;p<e+n;p++)for(h[p]=[],d=o;d<o+r;d++)h[p][d]=t.getValue(p,d);return g=void 0,m=void 0,u?g=u:0===s.groupSort?(m=function(t,e,o,n,r,i,a,s,l){var u,c,f,h,p,d=i?n:r,g=i?e:o,m=[];for(u=0;u<d;u++)m[u]=g+u;for(c=s.ignoreHidden?function(t,e,o){var n,r,i=[];if(e)for(n=o.length-1;n>=0;n--)r=o[n],0===t.getRowHeight(r)&&(o.splice(n,1),i.push({mi:n,Qb:r}));else for(n=o.length-1;n>=0;n--)r=o[n],0===t.getColumnWidth(r)&&(o.splice(n,1),i.push({mi:n,Qb:r}));return i}(t,i,m):[],f=m.concat([]),h=!1,m=A(m,t,i,a,l),p=0;p<m.length;p++)if(m[p]!==f[p]){h=!0;break}return function(t,e){var o,n;for(o=t.length-1;o>=0;o--)n=t[o],e.splice(n.mi,0,n.Qb)}(c,m),{array:m,isChanged:h}}(t,e,o,n,r,i,a,s,h),g=m.array):(m=function(t,e,o,n,r,i,a,s,l){var u,c,f,h,p=i?n:r,d=i?e:o,g=i?t.rowOutlines:t.columnOutlines,m=g.kec(d,p),y=g.lec(m,s.groupSort);if(!y){for(u=[],c=0;c<p;c++)u.push(d+c);y=[u]}for(c=0;c<y.length;c++)y[c]=A(y[c],t,i,a,l);return h=(f=g.mec(y,m,s.groupSort)).array,f.isChanged&&I(t,i,f,h,m,d,p),{array:h,isChanged:f.isChanged}}(t,e,o,n,r,i,a,s,h),g=m.array),!!g&&(f=N(t,m&&m.isChanged,e,o,n,r,i,a,c,g,h),!0)}finally{l&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.Bu(e,o,n,r,f,4,C,C,C,!!u)}}function D(t,e){var o,n,r,i,a,s,l=[];for(o=0,n=e;o<n.length;o++)(r=n[o]).compareFunction?(i=r,l.push({index:i.index,ascending:i.ascending,compareFunction:i.compareFunction})):r.order&&r.hasOwnProperty("backColor")?(a="top"!==(i=r).order,s=d(i.backColor)?"":b(i.backColor,t.currentTheme()),l.push({index:i.index,ascending:a,color:s,isBackColor:!0})):r.order&&r.hasOwnProperty("fontColor")?(a="top"!==(i=r).order,s=d(i.fontColor)?"":b(i.fontColor,t.currentTheme()),l.push({index:i.index,ascending:a,color:s,isBackColor:!1})):(r.color&&(r.color=b(r.color,t.currentTheme())),l.push(r));return l}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/core/util/domUtil.js"),i=o("./dist/core/util/common.js"),a=o("./dist/core/worksheet/worksheet.js"),s=o("@grapecity/js-calc"),l=!!s,u=o("./dist/core/core.ns.js"),c=new n.Common.ResourceManager(u.SR),f=c.getResource.bind(c),h=n.Common.l.Ra,p=n.Common.k,d=n.Common.j.Fa,g="boolean",m="string",y="number",C=void 0,r.GC$.extend(a.Worksheet.prototype,{sortRange:function(t,e,o,n,r,a,s,u,c){var h,p,d,g,m,y,C,v,b,w,T,S=this,x=S.getRowCount(),A=S.getColumnCount();if(-1===t&&(t=0),-1===o&&(o=x),-1===e&&(e=0),-1===n&&(n=A),t<0||t>=x||e<0||e>=A||o<0||t+o>x||n<0||e+n>A||!a)return!1;if(s=S.oec(i.kf(t,e,o,n),r,s),h=r?o:n,p=r?t:e,d=r?S.rowOutlines:S.columnOutlines,!u&&s.groupSort>0){if(!d)return!1;g=d.kec(p,h),r?(o=g.count,t=g.start):(n=g.count,e=g.start)}return l&&!S.Vq(t,e,o,n,!1)?(c&&S.Os(7,f().Exp_InvalidSortArrayFormulaInRange),!1):(m=S.ITa.getSpans(i.kf(t,e,o,n)))&&m.length>0?(c&&S.Os(7,f().Exp_InvalidSortSpanInRange),!1):!(y=S.tables)||(v=1===(C=y.s$(t,e,o,n)).length&&C[0].dataRange().equals(i.kf(t,e,o,n)),C.length<=0||v)?(w=(b=S.wq)&&b.Ou||v&&C[0]&&C[0].LZ(),(T=O(S,t,e,o,n,r,D(S,a),s,u,w))&&0!==s.groupSort&&S.xr&&S.xr.reFilter(),T):(c&&S.Os(7,f().Exp_InvalidSortPartTableOrMultiTableInRange),!1)},oec:function(t,e,o){var n,r=this,i=r.Tq(t),a=e?i.rowCount:i.colCount,s=e?i.row:i.col,l=e?r.rowOutlines:r.columnOutlines;return d(o)&&(o={}),r.outlineColumn&&r.outlineColumn.ZQa()&&e&&(n=r.outlineColumn.YQa.columnIndex,i.col<=n&&n<=i.col+i.colCount||(o.groupSort=0)),d(o.groupSort)&&(d(o.ignoreHidden)?o.groupSort=l&&l.pec(s,a)?1:0:o.groupSort=0),0===o.groupSort?o.ignoreHidden=!!d(o.ignoreHidden)||o.ignoreHidden:o.ignoreHidden=!1,o},hK:function(){var t=this.options;return!t.isProtected||t.protectionOptions.allowSort},wja:function(t,e,o,n){var r=this,i=r.getDataValidator(t,e),a=r.getDataValidator(o,n);r.setDataValidator(t,e,a),r.setDataValidator(o,n,i)}})},"./dist/core/worksheet/worksheet-static.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m;function y(t,e){return t.getRowCount(e)}function C(t,e){return t.getColumnCount(e)}function v(t,e,o){return t.$r(e,o)}function b(t,e,o){return t.Yr(e,o)}function w(t,e,o,n){t.setColumnWidth(e,o,n)}function T(t,e,o,n){t.setRowHeight(e,o,n)}function S(t,e,o,n,r){return t.getActualStyle(e,o,n,h,h,h,r)}function x(t,e){return t.getDefaultStyle(e)}function A(t,e,o){t.setDefaultStyle(e,o)}function I(t,e,o,n,r){t.Pq(e,o,n,r)}function R(t,e,o,n){throw Error(i.Common.u.Kb(m().Exp_InvalidAndSpace,[t,e,o,n]))}function M(t,e,o){return e&&o.Ps&&o.Ps(t)}function k(t,e,o,n,r,i,a,s,l){var u,c,f,h,d,g,v,b;if(!t)throw Error(m().Exp_SrcIsNull);if(!n)throw Error(m().Exp_DestIsNull);u=y(t),c=C(t),f=y(n),h=C(n),(e<-1||e>=u)&&R("from row index",e,"-1",u-1),(o<-1||o>=c)&&R("from column index",o,"-1",c-1),(r<-1||r>=f)&&R("to row index",r,"-1",f-1),(i<-1||i>=h)&&R("to column index",i,"-1",h-1),d=o,o<0&&(d=0,s=c),g=i<0?0:i,(s<1||d+s>c||g+s>h)&&R("column count",s,"1",p(c-d,h-g)),v=e,e<0&&(v=0,a=u),b=r<0?0:r,(a<1||v+a>u||b+a>f)&&R("row count",a,"1",p(u-v,f-b))}function N(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||u(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,o,n;for(o in e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(o)&&(n=t[o],t.hasOwnProperty(o)&&e[o]!==n&&(e[o]="object"==typeof n?N(n):n));return e.toString=t.toString,e.valueOf=t.valueOf,e}function O(t,e,o,n,i,a,s,l,u){var c,f,p,d,g,m,y,C,v,b=t.getSpans(h,u),w=n.getSpans(h,u),T=[];if(b)for(c=0;c<b.length;c++)p=(f=b[c]).row,d=f.col,g=f.rowCount,m=f.colCount,-1===e?o<=d&&d+m<=o+l&&T.push(r.kf(p,a+d-o,g,m)):-1===o?e<=p&&p+g<=e+s&&T.push(r.kf(i+p-e,d,g,m)):e<=p&&p<e+s&&o<=d&&d<o+l&&T.push(r.kf(i+p-e,a+d-o,g,m));if(w)for(c=0;c<w.length;c++)p=(f=w[c]).row,void 0,y=(d=f.col)>=a&&d<a+l,C=p>=i&&p<i+s,(-1===e?y:-1===o?C:C&&y)&&((v=n.findSpan(p,d,u))&&v.row===p&&v.col===d&&n.do("removeSpan",v,u));for(c=0;c<T.length;c++)n.do("addSpan",T[c],u)}function D(t,e,o,n,r,i,a,s,l,u){var c,f=t.conditionalFormats,h=n.conditionalFormats,p=U(t,n);f&&h&&!t.dJb&&(c=f.XA(e,o,h,r,i,a,s,p,u),l&&f.YA(e,o,a,s,c,p))}function F(t,e,o,n,r,i,a,s,l,u){var c;e<0&&(e=0,a=p(y(t),y(n))),r<0&&(r=0),o<0&&(o=0,s=p(C(t),C(n))),i<0&&(i=0),!(t===n&&t.name()===n.name())?(c=n.ZA)&&(l?t.ZA.count()>0&&c.$A(t,e,o,r,i,a,s):c._A(t,e,o,r,i,a,s,h,u)):(c=t.ZA)&&(l?c.count()>0&&c.aB(e,o,r,i,a,s):c.Zz(e,o,r,i,a,s,h,u))}function E(t,e,o,n,r,i,a,s,l,u){var c=!(t===n&&t.name()===n.name()),f=t.ITa,h=f.zl(u);c?(O(f,e,o,n.ITa,r,i,a,s,u),l&&h&&f.do("clearSpan",e,o,a,s,u)):l?f.do("moveSpan",e,o,r,i,a,s,u):f.do("copySpan",e,o,r,i,a,s,u)}function j(t,e,o,n,r,i,a,s,l){var u=e,c=o;u<0&&(u=0,a=p(y(t),y(n))),r<0&&(r=0),c<0&&(c=0,s=p(C(t),C(n))),i<0&&(i=0),e<0&&E(t,-1,c,n,-1,i,-1,s,l,1),o<0&&E(t,u,-1,n,r,-1,a,-1,l,2),E(t,u,c,n,r,i,a,s,l)}function P(t,e,o,n,r,i,a,s,l){var c,d,g,m,x,A,R,M,k,N,O,D,F,E;for(e<0&&(e=0,r=p(C(t),C(o))),n<0&&(n=0),c=!s&&o.KLc(),1,d=[],g=0,m=0;g<r&&g<C(o,1);g++)c&&0===o.getColumnWidth(n+g)?r++:(x={},(64&i)>0&&(A=v(t,m+e),u(A)||(x.size=A,a&&w(t,g+e,t.defaults.colWidth)),R=t.getColumnVisible(m+e),u(R)||(x.visible=R,a&&t.setColumnVisible(g+e,!0)),M=S(t,-1,m+e,h,l),x.style=M,a&&I(t,-1,g+e,f),M=S(t,-1,m+e,1,l),x.headerStyle=M,a&&I(t,-1,g+e,f,1)),(128&i)>0&&(k=t.getTag(-1,m+e),u(k)||(x.tag=k,a&&t.setTag(-1,g+e,h))),d[m+e]=x,m++);for(g=0,m=0;g<r&&g<C(o,1);g++)c&&0===o.getColumnWidth(n+g)?r++:(x=d[m+e],(64&i)>0&&(A=x.size,u(A)||w(o,g+n,A),R=x.visible,u(R)||o.setColumnVisible(g+n,R),I(o,-1,g+n,(M=x.style)?M.clone():f),I(o,-1,g+n,(M=x.headerStyle)?M.clone():f,1)),(128&i)>0&&(k=x.tag,u(k)||o.setTag(-1,g+n,k)),m++);for(N=y(o,1),O=p(y(t,1),N),D=0,F=0;D<O&&D<N;D++)c&&0===o.getRowHeight(D,1)?O++:(E=b(t,F,1),u(E)||(a&&T(t,D,t.defaults.colHeaderRowHeight,1),T(o,D,E,1)),F++)}function L(t,e,o,n,r,i,a,s,l,c){var d,g,m,x,A,R,k,N,O,D,F,E,j,P;for(e<0&&(e=0,r=p(y(t),y(o))),n<0&&(n=0),d=!l&&o.KLc(),2,g=[],m=0,x=0;m<r&&n+m<y(o,2);m++)d&&0===o.getRowHeight(n+m)?r++:s||!M(n+m,a,o)?(A={},(64&i)>0&&(R=b(t,x+e),u(R)||(A.size=R,s&&T(t,m+e,t.defaults.rowHeight)),k=t.getRowVisible(x+e),u(k)||(A.visible=k,s&&t.setRowVisible(m+e,!0)),N=S(t,x+e,-1,h,c),A.style=N,s&&I(t,m+e,-1,f),N=S(t,x+e,-1,2,c),A.headerStyle=N,s&&I(t,m+e,-1,f,2)),(128&i)>0&&(O=t.getTag(x+e,-1),u(O)||(A.tag=O,s&&t.setTag(m+e,-1,h))),g[x+e]=A,x++):x++;for(m=0,x=0;m<r&&n+m<y(o,2);m++)d&&0===o.getRowHeight(n+m)?r++:s||!M(n+m,a,o)?(A=g[x+e],(64&i)>0&&(R=A.size,u(R)||T(o,m+n,R),k=A.visible,u(k)||o.setRowVisible(m+n,k),I(o,m+n,-1,(N=A.style)?N.clone():f),I(o,m+n,-1,(N=A.headerStyle)?N.clone():f,2)),(128&i)>0&&(O=A.tag,u(O)||o.setTag(m+n,-1,O)),x++):x++;for(D=C(o,2),F=p(C(t,2),D),E=0,j=0;E<F&&E<D;E++)d&&0===o.getColumnWidth(E,2)?F++:(P=v(t,j,2),u(P)||(s&&w(t,E,t.defaults.rowHeaderColWidth,2),w(o,E,P,2)),j++)}function G(t,e,o,n){var r,i,a;t===e&&t.name()===e.name()||((64&o)>0&&(r=x(t),A(e,n?r:r.clone()),r=x(t,1),A(e,n?r:r.clone(),1),r=x(t,2),A(e,n?r:r.clone(),2),n&&(A(t,f),A(t,f,1),A(t,f,2))),i=e.defaults,a=t.defaults,i.colWidth=a.colWidth,i.rowHeight=a.rowHeight,i.rowHeaderColWidth=a.rowHeaderColWidth,i.colHeaderRowHeight=a.colHeaderRowHeight,n&&(a.colWidth=62,a.rowHeight=20,a.rowHeaderColWidth=40,a.colHeaderRowHeight=20))}function B(t,e,o,n,i,a,s,l,c,f,h,d,g){var m,v,b,w,T,S,x,A,I,R,k,O,D,F,E,j,P,L,G,B,_,V,H=!(t===n&&t.name()===n.name()),z=!g&&n.KLc();if(2==(2&f)&&e<0)if(I=o,R=a,m=p(y(t,1),y(n,1)),v=l,o<0&&(I=0,v=C(t)),a<0&&(R=0),k=v,H)for(b=0,x=0;b<m&&b<y(n,1);b++)if(z&&0===n.getRowHeight(b,1))m++;else{for(w=0,A=0,v=k;w<v&&w<C(n,1);w++)z&&0===n.getColumnWidth(R+w,1)?v++:(d(n,b,R+w,N(S=h(t,x,I+A,1)),1),A++);x++}else{for(T=new r.KTa,b=0;b<m;b++)for(w=0;w<v;w++)S=h(t,b,I+w,1),u(S)||T.set(b,w,N(S));for(b=0,x=0;b<m&&b<y(n,1);b++)if(z&&0===n.getRowHeight(b,1))m++;else{for(w=0,A=0,v=k;w<v&&w<C(n,1);w++)z&&0===n.getColumnWidth(R+w,1)?v++:(d(n,b,R+w,T.get(x,A),1),A++);x++}}if(1==(1&f)&&o<0)if(O=e,D=i,m=s,v=p(C(t,2),C(n,2)),e<0&&(O=0,m=y(t)),i<0&&(D=0),k=v,H)for(b=0,x=0;b<m&&b<y(n,2);b++)if(z&&0===n.getRowHeight(D+b,2))m++;else{for(w=0,A=0,v=k;w<v&&w<C(n,2);w++)z&&0===n.getColumnWidth(w,2)?v++:(d(n,D+b,w,N(S=h(t,O+x,A,2)),2),A++);x++}else{for(T=new r.KTa,b=0;b<m;b++)for(w=0;w<v;w++)S=h(t,O+b,w,2),u(S)||T.set(b,w,N(S));for(b=0,x=0;b<m&&b<y(n,2);b++)if(z&&0===n.getRowHeight(D+b,2))m++;else{for(w=0,A=0,v=k;w<v&&w<C(n,2);w++)z&&0===n.getColumnWidth(w,2)?v++:(d(n,D+b,w,T.get(x,A),2),A++);x++}}if(F=e,E=o,j=i,P=a,L=s,G=l,B=y(n),_=C(n),e<0&&(F=0,L=p(y(t),B)),o<0&&(E=0,G=p(C(t),_)),i<0&&(j=0),a<0&&(P=0),V=G,H)for(x=0,b=0;b<L&&j+b<B;b++)if(z&&0===n.getRowHeight(j+b))L++;else if(M(j+b,c,n))x++;else{for(A=0,w=0,G=V;w<G&&P+w<_;w++)z&&0===n.getColumnWidth(P+w)?G++:(d(n,j+b,P+w,N(S=h(t,F+x,E+A,3)),3),A++);x++}else{T=new r.KTa;try{for(b=0;b<L;b++)for(w=0;w<G;w++)S=h(t,F+b,E+w,3),u(S)||T.set(b,w,N(S));for(x=0,b=0;b<L&&j+b<B;b++)if(z&&0===n.getRowHeight(j+b))L++;else if(M(j+b,c,n))x++;else{for(A=0,w=0,G=V;w<G&&P+w<_;w++)z&&0===n.getColumnWidth(P+w)?G++:(d(n,j+b,P+w,T.get(x,A),3),A++);x++}}catch(t){}}}function _(t,e,o,n,i,a,s,l,c,h,p,d,g){var m;p&&(m=r.kf(e,o,s,l)),B(t,e,o,n,i,a,s,l,c,h,(function(t,e,o,n){var r,i,a,s,l,c,h,g,C=3===n,v=t.ITa,b={};return C?(i=(p||d)&&v.getDynamicArrayInfo(e,o))&&i.isValid?(r=f,p&&(a=function(t){return[t.row,t.col].join(",")}(i),b[a]||(b[a]=i,s=i.row,l=i.col,m.contains(s,l,1,1)&&v.XTa(3).yIb(i)))):r=t.getValue(e,o,n,1):(r=v.getValue(e,o,n,!0,1),1===n&&u(r)&&((c=t.wq)&&c.Ou&&(h=v.Jp(!1,3,o),g=t.options.colHeaderAutoTextIndex,h&&(g>=0&&e===g||-1===g&&e===y(t,n)-1)&&(r=h.displayName||h.name)))),p&&(C?t.uq(e,o,f,n,!1):t.ITa.do("setValue",e,o,f,n,!0,!0)),r}),(function(t,e,o,n,r){u(n)?t.uq(e,o,f,r,!1):t.uq(e,o,n,r,!1)}),g)}function V(t,e,o){var n,r,i,a=t.Tq(e),s=a.row,l=a.col,u=a.rowCount,c=a.colCount;for(n=0;n<u;n++)for(r=o[s+n]=o[s+n]||{},i=0;i<c;i++)r[l+i]=!0}function H(t,e,o,n,i,a,s,l,c,p,d,g,m){var y,C,v,b,w,T,S={};if(t.tables)for(y=r.kf(e,o,s,l),C=r.kf(i,a,s,l),b=void 0,w=0,T=(v=t.tables.all()).length;w<T;w++)b=v[w].range(),y.containsRange(b)?V(t,b,S):b.containsRange(y)&&b.containsRange(C)?V(t,y,S):b.intersect(y.row,y.col,y.rowCount,y.colCount)&&b.containsRange(C)&&V(t,b.getIntersect(y),S);B(t,e,o,n,i,a,s,l,c,p,(function(t,e,o,n){var r=(3===n||u(n))&&S[e]&&S[e][o],i=t.getCompositeStyle(e,o,n,h,h,h,h,r,h,h,g);return d&&I(t,e,o,f,n),i}),(function(t,e,o,n,r){I(t,e,o,n,r)}),m)}function z(t,e,o,n,r,i,a,s,l,u,c){var h,p,d,g=t.uja.Dja;for(h in g)(p=g[h])&&((d=p.condition())&&d.initExpression());B(t,e,o,n,r,i,a,s,l,0,(function(e,o,r){var i=e.getDataValidator(o,r,3);return i&&(u&&e.setDataValidator(o,r,f),U(t,n)&&(i.Nja=!0)),i}),(function(e,o,r,i){e.setDataValidator(o,r,i),U(t,n)&&i&&delete i.Nja}),c)}function U(t,e){return t===e&&t.name()===e.name()}function W(t,e,o,n,r,i,a,s,l,u,c){B(t,e,o,n,r,i,a,s,l,0,(function(t,e,o){var n=t.ITa.Ky,r=n&&n.get(e,o);return r&&u&&n.remove(e,o),r}),(function(t,e,o,n){var r=t.ITa.Ky;r&&r.Cz(e,o,n)}),c)}function q(t,e,o,n,r,i,a,s,l,c,f,p){B(t,e,o,n,r,i,a,s,l,c,(function(t,e,o,n){var r=t.getTag(e,o,n);return!u(r)&&f&&t.setTag(e,o,h),r}),(function(t,e,o,r,i){n.setTag(e,o,r,i)}),p)}function J(t,e,o,n,r,i,a,s,l,u,c){var h,p,g,m,y,C,v,b,w=[],T=[],S={},x={},A=!c&&n.KLc();if(A){for(h=a,p=s,h+=n.MLc(r,h,!0),p+=n.MLc(i,p),g=n.getRowCount(),m=n.getColumnCount(),y=0,C=0;y<h&&y+r<g;y++)0!==n.getRowHeight(r+y)&&(S[C]=y,C++);for(v=0,b=0;v<p&&v+i<m;v++)0!==n.getColumnWidth(i+v)&&(x[b]=v,b++)}return B(t,e,o,n,r,i,a,s,l,0,(function(n,r,i){var a,s,l=n.getBindingPath&&n.getBindingPath(r,i);return l&&(a=r-d(0,e),s=i-d(0,o),A&&(a=S[a],s=x[s]),w.push({row:a,col:s,value:n.getValue(r,i)})),u&&t.setBindingPath&&t.setBindingPath(r,i,f),l}),(function(t,e,o,n){T.push({sheet:t,r:e,c:o,value:n})}),c),{savedValues:w,bindingPathInfos:T}}function X(t){t.forEach((function(t){var e=t.sheet,o=t.r,n=t.c,r=t.value;e.setBindingPath&&e.setBindingPath(o,n,r)}))}function Z(t,e,o,n,r,i,a,s,l,c,f,p){B(t,e,o,n,r,i,a,s,l,c,(function(t,e,o,n){var r=t.getHyperlink&&t.getHyperlink(e,o,n);return!u(r)&&f&&t.setHyperlink&&t.setHyperlink(e,o,h),r}),(function(t,e,o,r,i){n.setHyperlink&&n.setHyperlink(e,o,r,i)}),p)}function Y(t,e,n,r,i,a,s,l){var u,f,h,p,d,g,m,y,C,v=o("SheetsCalc");if(v){if(u=v.uyb,p=t.ITa.dUa(),!t.parent||!t.parent.sheets)return void((d=t.getCustomNames())&&c(d,(function(o,c){f=c.getExpression(),(h=u(t,t,e,n,r,i,a,s,l,f))!==f&&c.fg(h,p)})));for(g=t.parent.sheets,(m=t.parent.getCustomNames())&&c(m,(function(o,c){f=c.getExpression(),(h=u(null,t,e,n,r,i,a,s,l,f))!==f&&c.fg(h,p)})),y=function(o){var d=g[o].getCustomNames();d&&c(d,(function(c,d){f=d.getExpression(),(h=u(g[o],t,e,n,r,i,a,s,l,f))!==f&&d.fg(h,p)}))},C=0;C<g.length;C++)y(C)}}function K(t,e,n,i,a,u,c,h,g,m,v,b,w,T){var S,x,A,I,R,N,O,E,B,V,U,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct;if(k(t,e,n,i,a,u,c,h),(1&g)>0&&(2&g)>0&&((R=t.pivotTables)&&(I=R.dB(r.kf(d(0,e),d(0,n),e<0?p(y(t),y(i)):c,n<0?p(C(t),C(i)):h),b))),b&&e<0)for(x=n,A=h,n<0&&(x=0,A=p(C(t),C(i))),N=u,u<0&&(N=0),S=!0,O=0;O<A;O++)E=t.ITa.Jp(!1,3,x+O),B=t.ITa.Jp(!1,3,N+O),V=E&&E.name,U=B&&B.name,E&&B&&V&&U||(S=!1),(B=l.GC$.extend(!0,{},i.ITa.Jp(!1,3,N+O)||{})).displayName=E&&E.displayName,B.name=E&&E.name,i.ITa.do("setItem",!1,3,N+O,B);(64&g)>0&&(H(t,e,n,i,a,u,c,h,m,v,b,w,T),t.dJb||t.uja&&z(t,e,n,i,a,u,c,h,m,b,T)),(512&g)>0&&D(t,e,n,i,a,u,c,h,b,T),(1&g)>0&&(2&g)>0&&((Q=t.tables)&&(K=Q.dB(r.kf(d(0,e),d(0,n),e<0?p(y(t),y(i)):c,n<0?p(C(t),C(i)):h),b))),($=s)&&(t.suspendCalcService(),i.suspendCalcService()),tt=[],et=f,ot=[],(256&g)>0&&(tt=(et=J(t,e,n,i,a,u,c,h,m,b,T)).savedValues,ot=et.bindingPathInfos);try{if(nt=i.pivotTables,(1&g)>0&&(2&g)>0&&nt&&nt.eB(I,t,d(0,e),d(0,n),i,d(0,a),d(0,u),c,h,b),(1&g)>0&&!S){if(_(t,e,n,i,a,u,c,h,m,v,b,(2&g)>0,T),b&&i.Wq("shiftCellsDown",{row:a,col:u,changedRowCount:a-e,changedColCount:u-n},!0),X(ot),s&&0==(2&g)&&i.clearFormula(a,u,c,h,(function(t,e){return!m||!t.Ps||!t.Ps(e)})),(256&g)>0)for(rt=tt.length,it=a<0?0:a,at=u<0?0:u,st=0;st<rt;st++)lt=tt[st],!b&&M(it+lt.row,m,i)||i.setValue(it+lt.row,at+lt.col,lt.value)}else X(ot);ut=i.tables,(1&g)>0&&(2&g)>0&&ut&&ut.eB(K,d(0,e),d(0,n),d(0,a),d(0,u),b),s&&(b?(Y(t,e,n,i,a,u,c,h),(2&g)>0&&function(t,e,n,r,i,a,s,l){var u=o("SheetsCalc");u&&u.CalcOperatorAdjustor.moveFormula(t,e,n,r,i,a,s,l)}(t,e,n,i,a,u,c,h)):(2&g)>0&&((ct=o("SheetsCalc"))&&ct.vyb(t,e,n,i,a,u,c,h,m,T)),(1&g)>0&&(2&g)>0&&ut&&ut.R3(K))}finally{$&&(t.resumeCalcService(!1),i.resumeCalcService(!1))}if((4&g)>0&&W(t,e,n,i,a,u,c,h,m,b,T),(128&g)>0&&q(t,e,n,i,a,u,c,h,m,v,b,T),(1024&g)>0&&Z(t,e,n,i,a,u,c,h,m,v,b,T),(16&g)>0&&F(t,e,n,i,a,u,c,h,b,T),(8&g)>0&&(e<0&&function(t,e,o,n,r,i){var a,s;e<0&&(e=0,r=p(C(t),C(o))),n<0&&(n=0),a=t.columnOutlines,s=o.columnOutlines,t!==o||t.name()!==o.name()?a&&s&&s.bB(a,e,n,r,i):a&&a.cB(e,n,r,i)}(t,n,i,u,h,b),n<0&&function(t,e,o,n,r,i){var a,s,l;e<0&&(e=0,r=p(y(t),y(o))),n<0&&(n=0),a=!(t===o&&t.name()===o.name()),s=t.rowOutlines,l=o.rowOutlines,a?s&&l&&l.bB(s,e,n,r,i):s&&s.cB(e,n,r,i)}(t,e,i,a,c,b)),(32&g)>0&&(b||1!==c||1!==h)&&j(t,e,n,i,a,u,c,h,b),e<0&&a<=0&&P(t,n,i,u,h,g,b,T,w),n<0&&u<=0&&L(t,e,i,a,c,g,m,b,T,w),e<0&&a<=0&&n<0&&u<=0&&G(t,i,g,b),b&&e<0)for(x=n,A=h,n<0&&(x=0,A=p(C(t),C(i))),O=0;O<A;O++)t.getDataColumnName&&t.getDataColumnName(x+O)&&t.ITa.do("setItem",!1,3,x+O,f)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("./dist/core/util/common.js"),i=o("Common"),a=o("@grapecity/js-calc"),s=!!a,l=o("./dist/core/util/domUtil.js"),u=i.Common.j.Fa,c=l.GC$.each,f=null,h=void 0,p=Math.min,d=Math.max,g=new i.Common.ResourceManager(n.SR),m=g.getResource.bind(g),e.staticMembers={copyTo:function(t,e,o,n,r,i,a,s,l,u,c,f){K(t,e,o,n,r,i,a,s,l,u,c,!1,h,f)},moveTo:function(t,e,o,n,r,i,a,s,l,u){K(t,e,o,n,r,i,a,s,l,h,3,!0,u)}}},"./dist/core/worksheet/worksheet-ui.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function C(t){return Math.abs(t)}function v(t,e){var o=t,n=e;return function(t){var e,r,i=this,a=i.sheet,s=i.row,l=i.col,u=i.sheetArea;if(0===arguments.length)return o.call(a,s,l,u);if(s>=0&&l>=0)for(e=s;e<s+i.rowCount;e++)for(r=l;r<l+i.colCount;r++)b(a,e,r,u)&&n.call(a,e,r,t,u);return i}}function b(t,e,o,n){var r=t.getRowCount(n),i=t.getColumnCount(n);return o<0&&0<=e&&e<r||e<0&&0<=o&&o<i||0<=e&&e<r&&0<=o&&o<i||-1===e&&-1===o}function w(t,e,o,n,i,a){var s,l;b(t,e,o,a)&&((s=t.Aj(e,o,a))||(s=new r.Style),"string"==typeof s&&(l=s,(s=new r.Style).parentName=l),"font"===n&&function(t,e,o){var n,r,i,a,s;g(e.themeFont)||(n=h(),r=n.style,i=e.font,r.font=i,a=i&&r.fontFamily,r.font=o,s=o&&r.fontFamily,s!==a&&(e.themeFont=p))}(0,s,i),s[n]=i,t.setStyle(e,o,s,a))}function T(t){var e,o,n,r,i,a,s,l,u,c,f,h,p=t.split(":"),g=p[0],m=p[1],y=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+g)){if((n=g.match(y))[3])return d;e=n[1],o=n[2]}else o=g;if(g&&!m){if(e&&o)return[r=S(o),x(e),1,1]}else if(g&&m){if(i=void 0,a=void 0,isNaN(+m)){if((s=m.match(y))[3])return d;i=s[1],a=s[2]}else a=m;if(!e&&o&&!i&&a)return l=S(o),u=S(a),[r=Math.min(l,u),-1,c=C(l-u)+1,-1];if(e&&!o&&i&&!a)return f=x(e),h=x(i),[-1,Math.min(f,h),-1,C(f-h)+1];if(e&&o&&i&&a)return l=S(o),u=S(a),f=x(e),h=x(i),r=Math.min(l,u),c=C(l-u)+1,[r,Math.min(f,h),c,C(f-h)+1]}return d}function S(t){return function(t){return parseInt(t,10)}(t)-1}function x(t){var e,o,n=0,r=t.length;for(e=0;e<r;e++)o=t[e].charCodeAt(0)-64,n+=Math.pow(26,r-e-1)*o;return n-1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/worksheet/worksheet.js"),r=o("./dist/core/worksheet/style.js"),i=o("./dist/core/util/domUtil.js"),a=o("./dist/core/util/common.js"),s=o("Common"),l=o("./dist/core/core.enum.js"),u=o("@grapecity/js-calc"),c=o("./dist/core/worksheet/clipboardhelper.js"),f=!!u,h=a.util.tt,p=void 0,d=null,g=s.Common.j.Fa,m=n.Worksheet.prototype,y=function(){function t(t,e,o,n,r,i){var a=this;e<0&&(e=n=-1),o<0&&(o=r=-1),a.sheet=t,a.row=e,a.rowCount=g(n)?1:n,a.col=o,a.colCount=g(r)?1:r,a.sheetArea=g(i)?3:i}return t.prototype.tag=function(t){var e,o,n=this,r=n.sheet,i=n.row,a=n.col,s=n.rowCount,l=n.colCount,u=n.sheetArea;if(0===arguments.length)return r.getTag(i,a,u);if(i>=0&&a>=0)for(e=i;e<i+s;e++)for(o=a;o<a+l;o++)r.setTag(e,o,t,u);else if(i>=0)for(e=i;e<i+s;e++)r.setTag(e,-1,t,u);else if(a>=0)for(o=a;o<a+l;o++)r.setTag(-1,o,t,u);return n},t.prototype.width=function(t){var e,o=this,n=o.sheet,r=o.row,i=o.col,a=o.sheetArea;if(0!==arguments.length){if(r<0)for(e=0;e<o.colCount;e++)n.setColumnWidth(e+i,t,a);return o}if(r<0)return n.getColumnWidth(i,a)},t.prototype.height=function(t){var e,o=this,n=o.sheet,r=o.row,i=o.col,a=o.sheetArea;if(0!==arguments.length){if(i<0)for(e=0;e<o.rowCount;e++)n.setRowHeight(e+r,t,a);return o}if(i<0)return n.getRowHeight(r,a)},t.prototype.visible=function(t){var e,o,n=this,r=n.sheet,i=n.row,a=n.col,s=n.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(e=0;e<n.rowCount;e++)r.setRowVisible(e+i,t,s);else if(a>=0&&i<0)for(o=0;o<n.colCount;o++)r.setColumnVisible(o+a,t,s);return n}return a<0&&i>=0?r.getRowVisible(i,s):a>=0&&i<0?r.getColumnVisible(a,s):void 0},t.prototype.resizable=function(t){var e,o,n=this,r=n.sheet,i=n.row,a=n.col,s=n.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(e=0;e<n.rowCount;e++)r.setRowResizable(e+i,t,s);else if(a>=0&&i<0)for(o=0;o<n.colCount;o++)r.setColumnResizable(o+a,t,s);return n}return a<0&&i>=0?r.getRowResizable(i,s):a>=0&&i<0?r.getColumnResizable(a,s):void 0},t.prototype.tq=function(t){var e=this;return e.sheet.tq(e.row,e.col,t,e.sheetArea)},t.prototype._w=function(t,e){var o,n,r=this,i=r.sheet,a=r.row,s=r.col,l=r.rowCount,u=r.colCount,c=r.sheetArea;if(i.suspendPaint(),a>=0&&s>=0)for(o=a;o<a+l;o++)for(n=s;n<s+u;n++)w(i,o,n,t,e,c);else if(a>=0)for(n=-1,o=a;o<a+l;o++)w(i,o,n,t,e,c);else if(s>=0)for(o=-1,n=s;n<s+u;n++)w(i,o,n,t,e,c);else-1===a&&-1===s&&-1===l&&-1===u&&w(i,o=-1,n=-1,t,e,c);return i.resumePaint(),r},t.prototype.clear=function(t){var e=this;e.sheet.clear(e.row,e.col,e.rowCount,e.colCount,e.sheetArea,t)},t.prototype.setBorder=function(t,e){var o,n,r,i,s,l,u,c,f,h,p,d=this,g=d.sheet,m=d.sheetArea;g.suspendPaint();try{if(o=new a.Range(d.row,d.col,d.rowCount,d.colCount),r=(n=g.Tq(o,m)).row,i=n.col,s=n.rowCount,l=n.colCount,u=void 0,c=void 0,f=e.all,h=e.outline,p=e.inside,e.left||f||h)for(u=0;u<s;u++)g.getCell(r+u,i,m).borderLeft(t);if(e.top||f||h)for(c=0;c<l;c++)g.getCell(r,i+c,m).borderTop(t);if(e.right||f||h)for(u=0;u<s;u++)g.getCell(r+u,i+l-1,m).borderRight(t);if(e.bottom||f||h)for(c=0;c<l;c++)g.getCell(r+s-1,i+c,m).borderBottom(t);if(e.diagonalUp)for(u=0;u<s;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).diagonalUp(t);if(e.diagonalDown)for(u=0;u<s;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).diagonalDown(t);if(e.innerHorizontal||f||p)for(u=0;u<s-1;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).borderBottom(t),g.getCell(r+u+1,i+c,m).borderTop(t);if(e.innerVertical||f||p)for(c=0;c<l-1;c++)for(u=0;u<s;u++)g.getCell(r+u,i+c,m).borderRight(t),g.getCell(r+u,i+c+1,m).borderLeft(t)}finally{g.resumePaint()}},t.prototype.toHtml=function(t,e){void 0===t&&(t=l.HeaderOptions.noHeaders),void 0===e&&(e=!0);var o=this;return o.sheetArea===l.SheetArea.corner?"":c.S4.Q4(o.sheet,t,o.row,o.rowCount,o.col,o.colCount,o.sheetArea,e,[],[],!0,!0,e,!0)},t.Pl=v,t}(),e.CellRange=y,y.prototype.value=v(m.getValue,m.setValue),y.prototype.text=v(m.getText,m.setText),y.prototype.formula=v((function(t,e){return f&&this.getFormula(t,e)}),(function(t,e,o,n){f&&this.setFormula(t,e,o,n)})),y.prototype.styleName=v(m.getStyleName,m.setStyleName),i.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],(function(t,e){y.prototype[e]=function(t){return 0===arguments.length?this.tq(e):this._w(e,t)}})),e.Hgc=T,e.Igc=x,i.GC$.extend(m,{getRange:function(){var t,e,n,r,i,a,s,l,u=arguments[0];if(function(t){return"string"==typeof t}(u)){if(a=u.toUpperCase(),this.parent&&1===this.parent.options.referenceStyle)return d;if(i=arguments[1],a=function(t){return(t=t.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}(a),a.split(",").length>1)return d;if(f){if(!(s=o("SheetsCalc").formulaToRange(this,a,p,p,i)))return d;t=s.row,e=s.col,n=s.rowCount,r=s.colCount}else{if(!(l=T(a)))return d;t=l[0],e=l[1],n=l[2],r=l[3]}}else(function(t){return"number"==typeof t})(u)&&(t=u,e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[4]);return new y(this,t,e,n,r,i)},getCell:function(t,e,o){return g(e)&&(e=-1),new y(this,t,e,1,1,o)}})},"./dist/core/worksheet/worksheet.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct;function ft(t,e){var o,n,r,i,a=[],s=t.ITa.hUa();if(s)for(o in s)if(k(s,o)&&((n=s[o])&&(e||"n"!==n.rs||(r={row:+o,item:t.getDataItem&&t.getDataItem(+o)},a.push(r)),e&&"e"===n.rs)))for(i in n)if(!L(i)&&n[i]){(r={row:+o,item:t.getDataItem&&t.getDataItem(+o)}).originalItem=n.originalItem,a.push(r);break}return a}function ht(t,e,o){var n,r=0;for(n=e;n<=o;n++)r+=t._m(n);return r}function pt(t,e,o){var n,r=0;for(n=e;n<=o;n++)r+=t.Sl(n);return r}function dt(t){return t.getColumnCount()}function gt(t){return t.getRowCount()}function mt(t){return t.frozenTrailingColumnCount()}function yt(t){return t.frozenTrailingRowCount()}function Ct(t){return t.qKc}function vt(t){return t.tKc}function bt(t){return t.frozenColumnCount()}function wt(t){return t.frozenRowCount()}function Tt(t,e,o){Object.defineProperty(t,e,{get:function(){return this["_"+e]},set:function(t){var n=this["_"+e];n!==t&&(this["_"+e]=t,o&&o(e,t,n))}})}function St(t,e,o,n){return{row:e,col:o,newValue:t.getValue(e,o),oldValue:n}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/core/core.ns.js"),r=o("./dist/core/util/common.js"),i=o("./dist/core/util/imageLoader.js"),a=o("./dist/core/util/tasks.js"),s=o("./dist/core/worksheet/style.js"),l=o("./dist/core/worksheet/worksheet-model.js"),u=o("./dist/core/util/domUtil.js"),c=o("./dist/core/celltype/textcelltype.js"),f=o("@grapecity/js-calc"),h=o("./dist/core/celltype/headercelltype.js"),p=o("./dist/core/core.enum.js"),d=o("Common"),g=o("@grapecity/js-calc"),m=!!g,C=o("./dist/core/util/theme.js"),v=o("./dist/core/worksheet/stylehelper.js"),b=r.util.n0a,w=r.util.lHb,T=d.Common.j.Fa,S=r.util.Nl,x=r.util.Pl,A=r.util.Ql,I=r.util.bq,R=u.GC$.each,M=u.GC$.isEmptyObject,k=d.Common.D,N=r.util.x0a,O=r.util.w0a,D=RegExp("^\\d*(\\.\\d+)?\\*$"),F=d.Common.u,E=document,j=parseInt,P=parseFloat,L=isNaN,G=null,B=void 0,_=Math.min,V=Math.max,H=Math.floor,z=Math.ceil,U=Math.abs,W=Math.round,q="undefined",J="string",X="width",Z="height",Y="tag",K="onLayoutChanged",Q="onPaintSuspend",$="isVisible",tt="starSize",et="resizable",ot=".gcSheet",nt=".gcSheetInternal",rt={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},it=new d.Common.ResourceManager(n.SR),at=it.getResource.bind(it),function(t){t[t.dirty=1]="dirty",t[t.insert=2]="insert",t[t.delete=4]="delete"}(st=e.ClearPendingChangeType||(e.ClearPendingChangeType={})),function(t){t[t.setFormula=0]="setFormula",t[t.copyPaste=1]="copyPaste",t[t.dragFill=2]="dragFill",t[t.dragDrop=3]="dragDrop",t[t.changePartOfArrayFormula=4]="changePartOfArrayFormula",t[t.changeSheetName=5]="changeSheetName",t[t.table=6]="table",t[t.hideSheet=7]="hideSheet",t[t.pivotTable=8]="pivotTable",t[t.PTOverlapPT=9]="PTOverlapPT"}(e.InvalidType||(e.InvalidType={})),lt={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:"black",rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:G,selectionBackColor:G,selectionBorderColor:G,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},sheetAreaOffset:{left:0,top:0}},ut=function(){function t(e){var o=this;o._id=t.Np,t.Np++,o.options=A(lt,(function(t,e,n){o.Op(t,e,n)})),o.ad(e),o.fgc=new a.Tasks((function(){return this.tasks.pop()}),(function(){var t=o.parent;return t&&t.ku.Gw||o.mm.OG||o.mm.xG||o.mm.eG}))}return t.prototype.sortRange=function(t,e,o,n,r,i,a,s,l){return!1},t.prototype.Op=function(e,o,n){var r,i,a,s,l=this,u=l.parent;switch(e){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":l.$p();break;case"sheetAreaOffset":r=function(t,e){e<0&&(l.options.sheetAreaOffset[t]=0),l.$p()},i=l.options.sheetAreaOffset,["left","top"].forEach((function(t){var e=o[t];Tt(i,t,r),i[t]=e}));break;case"gridline":a=function(){l.$p()},s=l.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach((function(t){var e=o[t];Tt(s,t,a),s[t]=e}));break;case"isProtected":o&&u&&u.undoManager().PY((function(t){return t.sheetId!==l._id})),l._p(),t.ao(l,"onProtectChanged"),l.$p();break;case"protectionOptions":l._p(),t.ao(l,"onProtectChanged");break;case"sheetTabColor":u&&u.aq()}},t.prototype.name=function(t){var e=this,o=e.parent;if(0===arguments.length)return e.ITa?e.ITa.getName():"";if(!I(t,o?o.sheets:null,e))throw at().Exp_NotSupported;return e.cq(t),o&&o.aq(),e},t.prototype.isSelected=function(t){return this.DHb(t)},t.prototype.DHb=function(t,e){var o,n,i,a=this,s=a.parent,l=!!a.ITa&&a.ITa.TIb();return T(t)?l:(t!==l&&(o=a.name(),n=s&&s.getSheetIndex(o),i=void 0,e&&(i={oldValue:l,newValue:t,sheetName:o,propertyName:"isSelected",cancel:!1,sheetIndex:n},s&&s.Wq(r.Events.SheetChanging,i)),(!e||i&&!1===i.cancel)&&(a.ITa.CHb(t),s&&s.YJc&&s.YJc.repaint(),e&&s&&s.Wq(r.Events.SheetChanged,{oldValue:l,newValue:t,sheetName:o,propertyName:"isSelected",sheetIndex:n}))),a)},t.prototype.cq=function(e,o){var n=this,r=n.name();o||t.ao(n,"beforeSetName",{oldName:r,newName:e}),this.ITa.do("setName",e),o||t.ao(n,"setName",{oldName:r,newName:e})},t.prototype.addRows=function(e,o,n){var r,i,a,s;if(!(o<=0)){i=gt(r=this),(e<0||e>i)&&(e=i),0===r.ITa.WTa&&r.parent&&r.parent.pv.clear(),r.suspendPaint();try{if(r.eJb(!1),a={changeType:"addingRows",row:e,rowCount:o,canAdd:!0},t.ao(r,K,a),!a.canAdd)return;if(T(a.newRow)||(e=a.newRow),s="addRows",!r.pCb(e,3,s,o,i))return;this.ITa.do("addRows",e,o),r.jq=!0,t.ao(r,K,{changeType:s,row:e,oldValue:i,rowCount:o,rowExpand:n}),t.ao(r,K,{changeType:"addRows2",row:e,oldValue:i,rowCount:o}),r.tables&&r.tables.Cec(!0,e),r.kq(e,3,s,o,i)}finally{r.eJb(!0),r.resumePaint()}}},t.prototype.eJb=function(t){var e=this,o=e.Jl,n=e.Kl;e.ITa.setCellState(o,n,p.CellStatesType.active,t,p.SheetArea.viewport)},t.prototype.deleteRows=function(e,o){var n,r,i,a,s,l,u,c=this,f=gt(c);if(!(0>e||e>=f||o<=0)){0===c.ITa.WTa&&c.parent&&c.parent.pv.clear(),c.suspendPaint();try{if(c.eJb(!1),n={changeType:"deletingRows",row:e,rowCount:o,canDelete:!0},t.ao(c,K,n),!n.canDelete)return;if(r="deleteRows",!c.pCb(e,3,r,o,f))return;if(c.RIb(e,o,0,this.getColumnCount()),c.ITa.do("deleteRows",e,o),(i=c.lq)>=0){for(a=-1,s=wt(c),l=i;l>=s;l--)if(c.getRowVisible(l)&&c.Sl(l)>0){a=l;break}-1===a&&(a=0),i!==a&&c.mq(a)}u=f,c.getActiveRowIndex()>=u&&c.setActiveCell(u-1,c.getActiveColumnIndex()),c.jq=!0,t.ao(c,K,{changeType:r,row:e,oldValue:f,rowCount:o}),c.tables&&c.tables.Cec(!0,e),c.kq(e,3,r,o,f)}finally{c.eJb(!0),c.resumePaint()}}},t.prototype.addColumns=function(e,o){var n,r,i,a;o<=0||(r=dt(n=this),(e<0||e>r)&&(e=r),0===n.ITa.WTa&&n.parent&&n.parent.pv.clear(),i={changeType:"addingColumns",col:e,colCount:o,canAdd:!0},t.ao(n,K,i),i.canAdd&&(n.eJb(!1),a="addColumns",n.qCb(e,3,a,o,r)&&(n.ITa.do("addColumns",e,o),n.oq=!0,t.ao(n,K,{changeType:a,col:e,oldValue:r,colCount:o}),t.ao(n,K,{changeType:"addColumns2",col:e,oldValue:r,colCount:o}),n.tables&&n.tables.Cec(!1,e),n.pq(e,3,a,o,r),n.eJb(!0),n.$p())))},t.prototype.deleteColumns=function(e,o){var n,r,i,a,s,l,u,c=this,f=dt(c);if(!(0>e||e>=f||o<=0)&&(0===c.ITa.WTa&&c.parent&&c.parent.pv.clear(),n={changeType:"deletingColumns",col:e,colCount:o,canDelete:!0},t.ao(c,K,n),n.canDelete&&(c.eJb(!1),r="deleteColumns",c.RIb(0,this.getRowCount(),e,o),c.qCb(e,3,r,o,f)))){if(c.ITa.do("deleteColumns",e,o),(i=c.qq)>=0){for(a=-1,s=bt(c),l=i;l>=s;l--)if(c.getColumnVisible(l)&&c.Tl(l)>0){a=l;break}-1===a&&(a=0),i!==a&&c.rq(a)}u=f,c.getActiveColumnIndex()>=u&&c.setActiveCell(c.getActiveRowIndex(),u-1),c.oq=!0,t.ao(c,K,{changeType:r,col:e,oldValue:f,colCount:o}),t.ao(c,K,{changeType:"deleteColumns2",col:e,oldValue:f,colCount:o}),c.tables&&c.tables.Cec(!1,e),c.pq(e,3,r,o,f),c.eJb(!0),c.$p()}},t.prototype.frozenTrailingRowCount=function(t,e){var o=this;return 0===arguments.length?o.aMc:(t>=0&&(T(e)&&(e=!0),o.aMc=t,o.qKc=e,o.jq=!0,o.$p()),o)},t.prototype.frozenTrailingColumnCount=function(t,e){var o=this;return 0===arguments.length?o.bMc:(t>=0&&(T(e)&&(e=!0),o.bMc=t,o.tKc=e,o.oq=!0,o.$p()),o)},t.prototype.getFrozenTrailingState=function(t){return t?this.qKc:this.tKc},t.prototype.rKc=function(t){var e=vt(this),o=t.er;return e?o+t.sKc:o},t.prototype.oKc=function(t){var e=Ct(this),o=t.jr;return e?o+t.pKc:o},t.prototype.getRowCount=function(t){return 0===t?0:this.ITa.getRowCount(t)},t.prototype.getColumnCount=function(t){return 0===t?0:this.ITa.getColumnCount(t)},t.prototype.setRowCount=function(e,o){var n;T(o)&&(o=3),n={changeType:"settingRowCount",rowCount:e,sheetArea:o,canSet:!0},t.ao(this,K,n),n.canSet&&this.setRowCountCore(e,o)},t.prototype.setRowCountCore=function(e,o){var n,r;e=j(e,10),L(e)||(T(o)&&(o=3),r=(n=this).getRowCount(o),e<0||e===r||(3===o||2===o?(n.ITa.do("setRowCount",e,o),wt(n)>e&&n.frozenRowCount(e)):1===o&&n.ITa.do("setRowCount",e,o),t.ao(n,K,{changeType:"setRowCount",rowCount:e,sheetArea:o}),n.jq=!0,n.Jl>=e&&(3===o||2===o)&&n.setActiveCell(e-1,n.getActiveColumnIndex()),n.$p(),n.clearPendingChanges()))},t.prototype.setColumnCount=function(e,o){var n,r;e=j(e,10),L(e)||(r=(n=this).getColumnCount(o),e<0||e===r||(T(o)&&(o=3),3===o||1===o?(n.ITa.do("setColumnCount",e,o),bt(n)>e&&n.frozenColumnCount(e)):2===o&&n.ITa.do("setColumnCount",e,o),t.ao(n,K,{changeType:"setColumnCount",colCount:e,sheetArea:o}),n.oq=!0,n.Kl>=e&&(3===o||1===o)&&n.setActiveCell(n.getActiveRowIndex(),e-1),n.$p(),n.clearPendingChanges()))},t.prototype.aHb=function(t,e,n){var r,i,a=this;return y||(y=o("SheetsCalc")),y&&((r="string"==typeof n&&a.parent&&a.parent.aJb(n))&&-1!==t&&-1!==e)?(i=r.getExpression(),y.evaluateExpression(a,i,t,e)):B},t.prototype.xHb=function(t,e,o){var n,r=this;if(r.options.showFormulas&&3===o){if(n=r.getFormula(t,e))return"="!==n[0]&&(n="="+n),n;if(r.ITa&&r.ITa.ZHb&&r.ITa.ZHb.getAnchorInfo(t,e))return""}},t.prototype.getText=function(t,e,o){var n,r,i,a,s,l,u;return T(o)&&(o=3),r=(n=this).xHb(t,e,o),T(r)?(i=n.getCellType(t,e,o),a=n.getValue(t,e,o),(s=n.tq(t,e,"formatter",o))||(s=n.tq(t,e,"_autoFormatter",o)),l={},u=n.tq(t,e,"quotePrefix",o),(a=i.format(a,s,l,{sheet:n,row:t,col:e,sheetArea:o,quotePrefix:u}))&&"string"==typeof a&&(a=a.replace(/\r\n?/g,"\n")),a):r},t.prototype.setText=function(e,o,n,r){var i,a,s,l,u,c,f=this;T(r)&&(r=3),i=n,a={value:n},t.ao(f,"settingText",a),s=n=a.value,l=f.getCellType(e,o,r),u=f.getFormatter&&f.getFormatter(e,o,r),l&&u&&!w(u)&&(c={sheet:f,row:e,col:o,sheetArea:r},s=l.parse(i,u,c),s=T(s)?n:s),f.uq(e,o,s,r),f.$p()},t.prototype.getValue=function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g,m;return 0===o?G:(T(o)&&(o=3),a=(i=this).options,l=(s=i.ITa).getRowCount(o),u=s.getColumnCount(o),c=i.vq(s,t,e,o,n),1===o?T(c)&&((h=i.wq)&&h.Ou&&(p=i.ITa.Jp(!1,3,e),d=a.colHeaderAutoTextIndex,p&&(d>=0&&t===d||-1===d&&t===l-1)&&(c=p.displayName||p.name)),T(c)&&(((f=a.colHeaderAutoTextIndex)<0||f>=l)&&(f=l-1),t===f&&(2===(g=a.colHeaderAutoText)?c=r.util.xq(e+1):1===g&&(c=e+1)))):2===o&&T(c)&&(((f=a.rowHeaderAutoTextIndex)<0||f>=u)&&(f=u-1),e===f&&(2===(m=a.rowHeaderAutoText)?c=r.util.xq(t+1):1===m&&(c=t+1))),c)},t.prototype.setValue=function(t,e,o,n,r){this.uq(t,e,o,n,r);var i=this.parent,a=i&&i.getActiveSheet();a&&!0===a.cJc?a.$p():this.$p(),function(t){var e,o,n,r;if(t)for(o=(e=t.sheets).length,r=0;r<o;r++)!0===(n=e[r]).cJc&&delete n.cJc}(i)},t.prototype.eyb=function(t,e,o,n){var r=this;!n&&m&&r.zq(t,e,o),r.t4&&r.t4(t,e,1,1,o)},t.prototype.fyb=function(){var t=this.conditionalFormats;t&&t.Nm()},t.prototype.WXc=function(t,e,o){if(t&&t.parent&&t.parent.sheets){var n=t.parent.sheets,r=t.name();n.forEach((function(t){var n=t.cameraShapes;n&&n.length>0&&n.forEach((function(n){var i,a,s,l;if(n.cameraImageCache&&((a=(i=n.Fmb).znb.kWc)&&(t.name()===r||a.sheet&&a.sheet.name()===r)))for(s=0;s<e.length;s++){if(l=a.cellRange,void 0!==e[s].row&&void 0===e[s].col&&2===o&&e[s].row>=l.row&&e[s].row<l.row+l.rowCount){n.cameraImageCache=null,i.znb.nWc&&i.qnb();break}if(void 0===e[s].row&&void 0!==e[s].col&&1===o&&e[s].col>=l.col&&e[s].col<l.col+l.colCount){n.cameraImageCache=null,i.znb.nWc&&i.qnb();break}if(0===o){if(void 0===e[s].rowCount&&void 0===e[s].colCount&&l.contains(e[s].row,e[s].col)){n.cameraImageCache=null;break}if(void 0!==e[s].rowCount&&void 0!==e[s].colCount&&l.intersect(e[s].row,e[s].col,e[s].rowCount,e[s].colCount)){n.cameraImageCache=null;break}}}}))}))}},t.prototype.uq=function(t,e,o,n,r){var i,a,s,l;0!==n&&(T(n)&&(n=3),s=(a=(i=this).ITa).getRowCount(n),l=a.getColumnCount(n),t<0||t>=s||e<0||e>=l||(o=N(o),o=b(o),a.do("setValue",t,e,o,n),i.eyb(t,e,n,r),i.fyb()))},t.prototype.AHb=function(t,e,o,n,r,i){var a;return function(t,e,o,n,r){if((-1!==e||-1!==o)&&(T(r)&&(r=3),3===r)){var i=t.tables&&t.tables.find(e,o);i&&i.NZ&&e===i.footerIndex()&&ut.ao(t,"composeTableFooterList",{table:i,row:e,col:o,style:n})}}(this,t,e,a=this.getActualStyle(t,e,o,n,r,i),o),a},t.prototype.getActualStyle=function(t,e,o,n,i,a,l){var u,c,f,h,p,g,m,y,C,v,b,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,_,V;if(T(o)&&(o=3),0===o)return new s.Style;if(-1===t&&-1===e)return this.getDefaultStyle(o);if(m=(u=this).Cq,R="__spreadJSDefault",M="__undefined",k=this.ITa,3===o&&u.pivotTables&&(O=(N=u.pivotTables.findPivotTable(t,e)||G)&&N.HPc(t,e)),h=k.getStyle(t,e,o),p=k.getStyle(t,-1,o),g=k.getStyle(-1,e,o),h=h||G,p=p||G,g=g||G,l&&(-1===t&&(p=G),-1===e&&(g=G)),x=M,D=u.parent&&u.parent.GBb,h&&(x=h.charAt?h:R+h._id),A=M,p&&(A=p.charAt?p:R+p._id),I=M,g&&(I=g.charAt?g:R+g._id),y=(S=m[o])[x],F=u.tables,(E=3===o&&F&&!a?F.find(t,e):G)||N||(y||(y=S[x]={}),(v=y[A])?b=v[I]:v=y[A]={}),b||(f=u.getCompositeStyle(t,e,o,h,p,g,E,B,a,O,l,N)),3===o&&!n&&((j=u.conditionalFormats)&&(c=j.Eq(c,t,e,o)),(T(c)||T(c.foreColor))&&((P=c&&c.formatter||b&&b.formatter||f&&f.formatter)&&!a&&!w(P)))){try{d.Formatter&&d.Formatter.GeneralFormatter&&typeof P===J&&(P=r.mn.tn(P))}catch(t){}(P.hasFormatedColor&&P.hasFormatedColor()||d.Formatter&&P instanceof d.Formatter.FormatterBase)&&(L={conditionalForeColor:G},P.format(u.getValue(t,e),L),L.conditionalForeColor&&(T(c)&&(c=new s.Style),c.foreColor=L.conditionalForeColor))}if(c)C=b||f,c.Yo(C),c&&c.font&&C&&C.font&&c.font!==C.font&&(c.font=function(t,e){var o=r.util.Pxb(t.font),n=r.util.Pxb(e.font);return o.fontStyle+" "+o.fontWeight+" "+n.fontSize+" "+n.fontFamily}(c,C)),f=c;else if(b)return!u.cellStates||n||D||(_=u.cellStates.getStyle(t,e,o,G,b.locked))&&(_.Yo(b),(b=_).Zo(u.Pm)),i?b:b.clone(!0);return l||(T(f.locked)&&(f.locked=!0),f=f.Zo(u.Pm)),c||E||N||(v[I]=f.clone(!0)),!u.cellStates||n||D||(V=u.cellStates.getStyle(t,e,o,G,f.locked))&&(V.Yo(f),f=(f=V).Zo(u.Pm)),f},t.prototype.tq=function(t,e,o,n){var i,a,l,u,c,f,h,p,g,m,y,C,v,b,w;if(0===n)return B;if(T(n)&&(n=3),c=(i=this).ITa,h=!1,3===n){if("foreColor"===o){g=i.tq(t,e,"formatter",n);try{d.Formatter&&d.Formatter.GeneralFormatter&&typeof g===J&&(g=r.mn.tn(g))}catch(t){}g&&(g.hasFormatedColor&&g.hasFormatedColor()||d.Formatter&&g instanceof d.Formatter.FormatterBase)&&(m={conditionalForeColor:G},g.format(i.getValue(t,e),m),m.conditionalForeColor&&(f=m.conditionalForeColor,h=!0))}(y=i.conditionalFormats)&&y.count()>0&&(h=(C=y.Fq(t,e,o,n)).v5,f=C.Fi)}for(v=0;!h&&v<=4;)if(0===v?a=c.getStyle(t,e,n):1===v?(b=i.tables,(w=3===n&&b?b.find(t,e):G)&&rt[o]&&(a=w.Gq(t,e,o))):a=2===v?c.getStyle(t,-1,n):3===v?c.getStyle(-1,e,n):i.getDefaultStyle(n),v++,a&&a.charAt&&typeof a===J&&(a=i.Hq(a)),a){if("font"===o&&a.themeFont&&!p&&(p=a.themeFont),a[o]!==B){f=a[o],h=!0;break}for(l=a.parentName;l&&(u=i.Hq(l));){if(u[o]!==B){f=u[o],h=!0;break}l=u.parentName}}return"locked"===o?!!T(f)||f:h||p?("foreColor"!==o&&"backColor"!==o&&"font"!==o&&"borderLeft"!==o&&"borderTop"!==o&&"borderRight"!==o&&"borderBottom"!==o||((a=new s.Style)[o]=f,"font"===o&&p&&(a.themeFont=p),a.Zo(i.Pm),f=a[o]),f):B},t.prototype.getStyle=function(t,e,o){return this.Iq(t,e,o,!0)},t.prototype.Iq=function(t,e,o,n){var r,i,a;if(T(o)&&(o=3),0!==o){if((r=this.ITa.getStyle(t,e,o))instanceof s.Style)return n&&this.Jq(),r;if(typeof r===J&&((i=this.Hq(r))!==G&&i!==B))return(a=new s.Style).Yo(i,!1),n&&this.Jq(),a}return G},t.prototype.addNamedStyle=function(t){this.Kq(t),this.$p()},t.prototype.Kq=function(t){if(t){if(!t.name)throw Error(at().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Lq[e]=t}},t.prototype.getNamedStyle=function(t){return this.Mq(t,!0)},t.prototype.Mq=function(t,e){var o,n=this.Lq;return n&&t?((o=n[t=t.toUpperCase()])&&e&&this.Jq(),o):G},t.prototype.Jq=function(){this.Cq=[{},{},{},{}]},t.prototype.removeNamedStyle=function(t){var e,o=this.Lq;o&&t&&(t=t.toUpperCase(),k(o,t)&&((e=o[t].formatter)&&"string"==typeof e&&this.parent.QHb[e]&&this.parent.RHb(e),delete o[t],this.Jq(),this.$p()))},t.prototype.getNamedStyles=function(){var t=[],e=this.Lq;return e&&R(e,(function(e,o){t.push(o)})),this.Jq(),t},t.prototype.setStyle=function(t,e,o,n){var r,i;T(n)&&(n=3),o&&o.backColor&&"object"==typeof o.backColor&&v.To.processStops(o.backColor),(r=this).Nq(t,e,o,n),-1===t&&-1===e&&(r.Oq[n]=G),-1!==t&&-1!==e||(i=o&&o.validator)&&i.condition()&&4===i.condition().conType()&&i.condition().getExpected(this,t<0?0:t,e<0?0:e),r.Jq(),r.$p()},t.prototype.Pq=function(t,e,o,n){var r,i,a=this;a.options.isProtected?(r=a.getStyle(t,e,n),i=void 0,o?(i=r?r.locked:B,o.locked!==i&&(o.locked=i),a.setStyle(t,e,o,n)):r&&((i=r.locked)!==B&&((o=new s.Style).locked=i),a.setStyle(t,e,o,n))):a.setStyle(t,e,o,n)},t.prototype.getStyleName=function(t,e,o){var n=this.Aj(t,e,o);return n instanceof s.Style?n.name:n},t.prototype.setStyleName=function(t,e,o,n){typeof o===J&&(this.Nq(t,e,o,n),this.$p())},t.prototype.Aj=function(t,e,o){var n;return T(o)&&(o=3),0!==o&&(n=this.ITa.getStyle(t,e,o)),n||G},t.prototype.getNamedStyleName=function(t,e,o){var n=this.Aj(t,e,o);return"string"==typeof n?n:B},t.prototype.Nq=function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g;if(T(n)&&(n=3),0!==n){if(a=(i=this).Aj(t,e,n),l=(s=i.ITa).getRowCount(n),u=s.getColumnCount(n),t<-1||t>=l||e<-1||e>=u)return;c=o,f=s.getStyle(t,e,n),typeof c===J&&(c=i.Hq(c)),(h=c&&c.formatter)&&w(h)&&i.fJb(t,e,h),s.do("setStyle",t,e,o,n),p=a&&a.cellType&&a.cellType.typeName||G,d=o&&o.cellType&&o.cellType.typeName||G,t===i.Jl&&e===i.Kl&&p!==d&&r.Vl.Wl(i)&&i.mm.Qq(),g="[styleinfo]",-1!==t&&-1!==e?i.Bq(g,t,e,n,f,o):-1!==t&&-1===e?i.kq(t,n,g,o,f):-1===t&&-1!==e&&i.pq(e,n,g,o,f)}},t.prototype.fJb=function(t,e,n){var r,i,a,s,l,u,c,h=this;if(y||(y=o("SheetsCalc")),y){if(-1===t&&(t=0),-1===e&&(e=0),r=h.getCell(t,e,3),i=y.rangeToFormula(r,t,e,3),"="===(a=n.trim()).charAt(0)&&a.indexOf("@")>=0&&(a=a.replace(/@/g,i)),a.indexOf("{{")>=0&&a.indexOf("}}")>=0){for(""===(s=a.split(/{{|}}/))[0]&&s.shift(),""===s[s.length-1]&&s.pop(),l=0;l<s.length;l++)-1===s[l].indexOf("=")?s[l]='"'+s[l]+'"':(s[l].indexOf("@")>=0&&(s[l]=s[l].replace(/@/g,i)),(u=y.evaluateFormula(h,s[l]))instanceof f.CalcError?s[l]='"'+u+'"':s[l]=s[l].replace(/=/g,""));a="=CONCAT("+s.join(",")+")"}(c=h.parent).aJb(n)||c.Yu(c.QHb,n,a,t,e,!0,"")}},t.prototype.getDefaultStyle=function(t){var e,o,n,r,i,a,l;return T(t)&&(t=3),(n=(o=(e=this).Oq)[t])?n:0!==t?(typeof(i=(r=e.ITa).getStyle(-1,-1,t))===J&&(i=e.Hq(i)),i||(i=new s.Style,r.do("setStyle",-1,-1,i,t)),a=1===t||2===t,typeof i.hAlign===q&&(i.hAlign=a?1:3),typeof i.vAlign===q&&(i.vAlign=a?1:0),typeof i.imeMode===q&&(i.imeMode=1),i.font||typeof i.themeFont!==q||(i.themeFont="Body"),o[t]=i,i):((l=new s.Style).locked=!0,o[t]=l,l)},t.prototype.setDefaultStyle=function(t,e){T(e)&&(e=3);var o=this;0!==e&&o.ITa.do("setStyle",-1,-1,t,e),o.Oq[e]=G,o.Jq(),o.$p()},t.prototype.Hq=function(t){var e,o=this.Mq(t,!1);return o||((e=this.parent)?e.Mq(t,!1):G)},t.prototype.getCompositeStyle=function(t,e,o,n,r,i,a,l,u,c,f,h){var p,d,g,m,y,C,v,b,w,S,x,A,I;if(T(o)&&(o=3),p=this,d=new s.Style,g=!1,0!==o){if(C=p.ITa,v=p.tables,b=p.pivotTables,w=C.getRowCount(o),S=C.getColumnCount(o),x=void 0,0<=t&&t<w&&0<=e&&e<S&&((x=n!==B?n:C.getStyle(t,e,o))&&x.charAt&&(x=p.Hq(x)),x))for(d.Yo(x,!0,10),g=!0,y=x.parentName;y&&(m=p.Hq(y));)d.Yo(m,!1,10,!0),y=m.parentName;if(l)return d;if(a!==B||u||(a=3===o&&v?v.find(t,e):G),a&&!u&&(a.Yo(t,e,d),g=!0),h!==B||u||(c=(h=3===o&&b?b.findPivotTable(t,e):G)&&h.HPc(t,e)),c&&(c&&c.parentName&&((A=p.Hq(c.parentName))&&c.Yo(A)),c.Yo(d),d=c,g=!0),h&&(h.MPc(t,e,d),g=!0),0<=t&&t<w&&((x=r!==B?r:C.getStyle(t,-1,o))&&x.charAt&&(x=p.Hq(x)),x))for(d.Yo(x,!g,30),g=!0,y=x.parentName;y&&(m=p.Hq(y));)d.Yo(m,!1,30,!0),y=m.parentName;if(0<=e&&e<S&&((x=i!==B?i:C.getStyle(-1,e,o))&&x.charAt&&(x=p.Hq(x)),x))for(d.Yo(x,!g,40),g=!0,y=x.parentName;y&&(m=p.Hq(y));)d.Yo(m,!1,40,!0),y=m.parentName}if((I=p.getDefaultStyle(o))&&I.charAt&&(I=p.Hq(I)),I&&!f)for(d.Yo(I,!g,50),y=I.parentName;y&&(m=p.Hq(y));)d.Yo(m,!1,50,!0),y=m.parentName;return d},t.prototype.getCellType=function(t,e,o){return this.tq(t,e,"cellType",o)||this.Al(o)},t.prototype.Al=function(t){T(t)&&(t=3);var e=this.Rq;return e||(e=this.Rq=new c.Text),3===t?e:1===t?new h.ColumnHeader:2===t?new h.RowHeader:0===t?new h.Corner:e},t.prototype.setCellType=function(t,e,o,n){var r=this.Iq(t,e,n);r||(r=new s.Style),r.cellType=o,this.setStyle(t,e,r,n)},t.prototype.Sq=function(t,e,o,n,i){var a,s,l,u,c,f,h=this;if(T(i)&&(i=3),(a=h.ITa).do("clearSpan",t,e,o,n,i),s=r.kf(t,e,o,n),l=h.Tq(s,i),u=h.Fia(l,i),a.do("addSpan",u,i),3===i){for(c=h.getSelections(),f=0;f<c.length;f++)c[f].intersect(t,e,o,n)&&(c[f]=c[f].union(s));a.do("setSelections",c)}h.$p()},t.prototype.Fia=function(t,e){var o=this.getRowCount(e),n=this.getColumnCount(e),i=t.row,a=t.col,s=t.rowCount,l=t.colCount;return i+s>o&&(s=o-i),a+l>n&&(l=n-a),r.kf(i,a,s,l)},t.prototype.addSpan=function(e,o,n,r,i){var a,s,l,u,c=this;if((1!==n||1!==r)&&0!==i&&(a=c.getRowCount(i),s=c.getColumnCount(i),!(e>=a||o>=s||e<-1||o<-1)&&(l=!0,m&&(3===i||T(i))&&(l=c.Vq(e,o,n,r,!1),c.pivotTables&&(l=l&&c.pivotTables.MOc(e,o,n,r))),l))){if(c.ITa.qu(e,o,n,r,i))throw Error(at().Exp_InvalidRange);c.wyb&&c.wyb(e,o,n,r),c.Sq(e,o,n,r,i),u={sheet:c,row:e,col:o,rowCount:n,colCount:r,sheetArea:i,changeType:"addSpan"},t.ao(c,K,u),c.Wq("spanChanged",u)}},t.prototype.removeSpan=function(e,o,n){var r,i,a,s=this;T(n)&&(n=3),(i=(r=s.ITa).findSpan(e,o,n))&&i.row===e&&i.col===o&&r.do("removeSpan",i,n),a={sheet:s,row:e,col:o,sheetArea:n,changeType:"removeSpan"},t.ao(s,K,a),s.Wq("spanChanged",a),s.$p()},t.prototype.getSpans=function(t,e){return 0===e?[]:this.ITa.getSpans(t,e,!0)},t.prototype.getSpan=function(t,e,o){return 0===o?G:this.ITa.findSpan(t,e,o)},t.prototype.repaint=function(t){this.Xq<=0&&this.yl&&this.yl.repaint(t)},t.prototype.ULc=function(t,e){void 0===e&&(e=1);var o=this.cm(new r.Range(t,-1,e,-1));o.y-=1,o.height+=1,this.repaint(o)},t.prototype.VLc=function(t,e){void 0===e&&(e=1);var o=this.cm(new r.Range(-1,t,-1,e));o.x-=1,o.width+=1,this.repaint(o)},t.prototype.Yq=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,d,g,m,y,C,v,b=this,w=b.parent,T=w&&w.options.scrollbarAppearance===p.ScrollbarAppearance.mobile,S=!1,x=!1,A=w&&w.options.scrollByPixel,I=wt(b),R=bt(b),M=R?b.Zq(R-1):b.$q(),k=I?b._q(I-1):b.ar();if(e<b.qq&&e>=M?(S=!0,b.rq(b.br(e+1),0)):A&&e===b.qq&&0!==b.eCb&&(S=!0,b.rq(e,0)),e>b.cr()&&e<=b.dr()){for(o=0,n=e,r=b.am(),i=b.rKc(r),(a=b.ITa.findSpan(t,n))&&(n=a.col+a.colCount-1);n>b.qq&&!((o+=b.Tl(n))>i);)n--;s=void 0,l=void 0,A?(n===b.qq&&o<i&&(o+=b.Tl(n)),s=n,l=i-o):(s=b.Zq(n),l=0),S=!0,b.rq(s,l)}if(t<b.lq&&t>=k?(x=!0,b.mq(b.gr(t+1),0)):A&&t===b.lq&&0!==b.cCb&&(x=!0,b.mq(t,0)),t>b.hr()&&t<=b.ir()){for(u=0,c=t,(f=b.ITa.findSpan(c,e))&&(c=f.row+f.rowCount-1),h=b.am(),d=b.oKc(h);c>b.lq&&!((u+=b.Sl(c))>d);)c--;g=void 0,m=void 0,A?(c===b.lq&&u<d&&(u+=b.Sl(c)),g=c,m=d-u):(g=b._q(c),m=0),x=!0,b.mq(g,m)}A||e!==b.dr()||b.rq(b.lr(),0),T&&(y=w.nKc,C=w.kKc,v=w.ku,x&&(y.Jwa(p.ScrollbarState.show),v.Rdc(!0)),S&&(C.Jwa(p.ScrollbarState.show),v.Rdc(!1)))},t.prototype.hitTest=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,S,x,A,I,R,M,k,N=this;if(N.am(),r={x:t,y:e},i=N.rowOutlines,a=N.columnOutlines,i&&(s=i.hitTest(N,t,e)),!s&&a&&(s=a.hitTest(N,t,e)),s)r.outlineHitInfo=s;else{if(l=N.nr(e),u=N.or(t),r.rowViewportIndex=l,r.colViewportIndex=u,r.row=N.pr(e,l),r.col=N.qr(t,u),l>=0&&l<=2&&u>=0&&((c=N.rr(l,u,B,r.row,r.col))&&!0!==o&&(r.row=c.row,r.col=c.col)),r.hitTestType=N.sr(l,u),f=N.mm,p=(h=N.xr)&&h.hitTest(r,t,e),g=void 0,(d=N.tables)&&(g=-1===r.rowViewportIndex?d&&d.find(N.getActiveRowIndex(),N.getActiveColumnIndex()):d.find(r.row,r.col)),p||(p=(m=g&&g.xr)&&m.hitTest(r,t,e)),y=d&&!p&&d.gJb(t,e,r))return r.tableSelectInfo=y,y.table&&y.table.xr&&(r.filterButtonHitInfo=p),r;(C=f.Yia&&f.Yia(r,t,e))?r.dragMergeInfo=C:(v=f.tr&&f.tr(r,t,e))?r.dragInfo=v:(b=f.ur(r,t,e,5))?r.resizeInfo=b:(w=f.vr?f.vr(r,t,e):G)?r.formulaRangeHitInfo=w:(x=(S=N.ITa.Ky)&&S.hitTest(t,e))?r.commentHitInfo=x:(I=(A=N.wr)&&A.hitTest(t,e,n),R=void 0,N.shapes&&(R=N.shapes.hitTest(t,e)),R?r.shapeHitInfo=R:I?r.floatingObjectHitInfo=I:p?r.filterButtonHitInfo=p:(M=g&&!g.hJb()&&f.iJb&&f.iJb(r,g))?r.resizeTableHitInfo=M:r.cellTypeHitInfo=N.yr(r,t,e))}return k=N.pivotTables&&N.pivotTables.findPivotTable(r.row,r.col),T(k)||(r.pivotTableInfo=k),r},t.prototype.getCellRect=function(t,e,o,n,i){var a,s,l,u,c,f,h=3;return-1===o?h=1:-1===n&&(h=2),s=(a=this).am(),-1===o&&-1===n?new r.Rect(s.zr,s.Ar,s.Br,s.Cr):(l=a.Dr(),T(o)&&(o=a.Er(t)),T(n)&&(n=a.Fr(e)),u=a.Gr(o,h).findRow(t),c=a.Hr(n,h).findCol(e),(f=a.Ir(o,n,h,i).findCell(t,e))?new r.Rect(f.x-l.x,f.y-l.y,f.width,f.height):u&&c?new r.Rect(c.x-l.x,u.y-l.y,c.width,u.height):new r.Rect)},t.prototype.Jr=function(t,e,o){var n,i,a,s,l,u,c,f=this,h=f.mm,d=!1,g=f.Jl,m=f.Kl;T(t)||(f.Jl=t,d=!0),T(e)||(f.Kl=e,d=!0),i=(n=f.QLc)&&n.isEnable(p.StatesType.active,!0),a=n&&n.isEnable(p.StatesType.active,!1),i&&(f.ULc(g),f.ULc(t)),a&&(f.VLc(m),f.VLc(e)),f.ITa.setCellState(g,m,p.CellStatesType.active,!1,p.SheetArea.viewport),i||a||f.xIb&&f.xIb(p.CellStatesType.active,g,m,p.SheetArea.viewport),f.ITa.setCellState(t,e,p.CellStatesType.active,!0,p.SheetArea.viewport),i||a||f.xIb&&f.xIb(p.CellStatesType.active,t,e,p.SheetArea.viewport),!o&&h&&d&&(h.Qq(),(l=(s=f.ITa).getDynamicArrayInfo(t,e))!==(u=s.WIb)&&(s.WIb=l,f.Xq<=0&&(c=void 0,l&&u?c=r.getUnionRange(l,u):(l=l||u,c=r.kf(l.row,l.col,l.rowCount,l.colCount)),f.yl.im(c))))},t.prototype.gCb=function(t,e,o,n,r){var i=t.getCellRect(e,o,n,r),a=i.x,s=i.y,l=i.width,u=i.height;return i.x=a-2,i.y=s-2,i.width=l+4,i.height=u+4,i},t.prototype.Kr=function(t,e,o,n,i){var a,s=this,l=s.Jl,u=s.Kl,c=s.ITa,f=c.getSpan(t,e);s.Lr=f.rowCount,s.Mr=f.colCount,s.Xq<=0&&(a=c.getSpan(l,u),s.yl.im(r.kf(l,u,a.rowCount,a.colCount))),s.Nr=o,s.Pr=n,s.Jr(t,e,i),s.Qr=t,s.Rr=e},t.prototype.setActiveCell=function(t,e,o,n){this.Sr(t,e,o,n,2)},t.prototype.Sr=function(t,e,o,n,i){var a,s,l,u=this,c=gt(u),f=dt(u);t<0?t=0:t>=c&&(t=V(0,c-1)),e<0?e=0:e>=f&&(e=V(0,f-1)),u.Tr(),a=2===i?r.Vl.Wl(u):1===i,u.Kr(t,e,o,n,!a),s={sheet:u,sheetName:u.name(),row:t,col:e},u.Wq(r.Events.FormulatextboxEnterCell,s),l=u.ITa.getSpan(t,e),u.Ur(l.row,l.col,l.rowCount,l.colCount),u.$p()},t.prototype.getActiveRowIndex=function(){return this.Jl},t.prototype.getActiveColumnIndex=function(){return this.Kl},t.prototype.getRowResizable=function(t,e){return this.ITa.getResizable(!0,e,t)},t.prototype.setRowResizable=function(t,e,o){this.Vr(t,e,et,!0,o)},t.prototype.Vr=function(t,e,o,n,r){var i,a,s,l;switch(T(r)&&(r=3),o!==Z&&o!==X||!D.test(e)||(o=tt),a=(i=this).ITa,o){case et:s=a.getResizable(n,r,t);break;case"pageBreak":s=a.getPageBreak(n,r,t);break;case $:s=a.getVisible(n,r,t);break;case Z:case X:s=a.getSize(n,r,t)}if(!0,!(l=n?i.pCb(t,r,o,e,s):i.qCb(t,r,o,e,s)))return l;switch(o){case et:a.do("setResizable",n,r,t,e);break;case"pageBreak":a.do("setPageBreak",n,r,t,e);break;case $:a.do("setVisible",n,r,t,e),n&&m&&3===r&&s!==e&&i.recalcRows([t]);break;case Z:a.do("setSize",n,r,t,e),!m||3!==r||s===e||0!==s&&0!==e||i.recalcRows([t]);break;case X:a.do("setSize",n,r,t,e),!m||3!==r||s===e||0!==s&&0!==e||i.recalcCols([t]);break;case tt:a.do("setStarSize",n,r,t,e)}return n?i.kq(t,r,o,e,s):i.pq(t,r,o,e,s),!0},t.prototype.getColumnResizable=function(t,e){return this.ITa.getResizable(!1,e,t)},t.prototype.setColumnResizable=function(t,e,o){this.Vr(t,e,et,!1,o)},t.prototype.getRowHeight=function(t,e,o){var n,r,i,a,s,l,u=this;if(T(e)&&(e=3),o)return u.ITa.getStarSize(!0,e,t);if(3===e||2===e){if(n=u.getRowCount(e),t<0||t>=n)return 0;for(r=u.Wr,i=0;i<r.length;i++)if(!r[i].Xr(t))return 0}return s=(a=u.defaults).rowHeight,1===e&&(s=a.colHeaderRowHeight),(l=u.ITa.getSize(!0,e,t))||0===l?l:H(s)},t.prototype.Yr=function(t,e){var o,n,r;return T(e)&&(e=3),this,n=(o=this.defaults).rowHeight,1===e&&(n=o.colHeaderRowHeight),(r=this.ITa.getActualSize(!0,e,t))||0===r?r:H(n)},t.prototype.setRowHeight=function(t,e,o){this.Vr(t,e,Z,!0,o)&&(this.jq=!0,this.$p())},t.prototype.getRowVisible=function(t,e,o){var n,r;if(T(e)&&(e=3),!o&&(3===e||2===e))for(n=this.Wr,r=0;r<n.length;r++)if(!n[r].Xr(t))return!1;return this.ITa.getVisible(!0,e,t)},t.prototype.setRowVisible=function(t,e,o){var n=this;n.Vr(t,e,$,!0,o)&&(n.jq=!0,n.$p())},t.prototype.getColumnWidth=function(t,e,o){var n,r,i,a,s,l,u=this;if(T(e)&&(e=3),o)return u.ITa.getStarSize(!1,e,t);if(r=(n=u.defaults).colWidth,2===e&&(r=n.rowHeaderColWidth),3===e||1===e){if(i=u.getColumnCount(e),t<0||t>=i)return 0;for(a=u.Zr,s=0;s<a.length;s++)if(!a[s].Xr(t))return 0}return(l=this.ITa.getSize(!1,e,t))||0===l?l:H(r)},t.prototype.$r=function(t,e){var o,n,r;return T(e)&&(e=3),this,n=(o=this.defaults).colWidth,2===e&&(n=o.rowHeaderColWidth),(r=this.ITa.getActualSize(!1,e,t))||0===r?r:H(n)},t.prototype.setColumnWidth=function(t,e,o){this.Vr(t,e,X,!1,o)&&(this.oq=!0,this.$p())},t.prototype.getColumnVisible=function(t,e){var o,n;if(T(e)&&(e=3),3===e||1===e)for(o=this.Zr,n=0;n<o.length;n++)if(!o[n].Xr(t))return!1;return this.ITa.getVisible(!1,e,t)},t.prototype.setColumnVisible=function(t,e,o){var n=this;n.Vr(t,e,$,!1,o)&&(n.oq=!0,n.$p())},t.prototype.zoom=function(t){var e,o=this;return 0===arguments.length?o.ITa.getZoomFactor():(t=P(t),!L(t)&&isFinite(t)&&(t>4?t=4:t<.25&&(t=.25),e=o.ITa.getZoomFactor(),o.XSa(t),o.eCb=o.eCb/e*t,o.cCb=o.cCb/e*t,o.oq=!0,o.jq=!0,o.$p()),o)},t.prototype.XSa=function(e){this.ITa.do("setZoomFactor",e),t.ao(this,K,{changeType:"zoomSheet"})},t.prototype.x6a=function(){var t=this;t._r=G,t.as={colHeader:G,viewport:G},t.bs={rowHeader:G,viewport:G}},t.prototype.invalidateLayout=function(){var e,o,n=this,i=n.mm;n.ITa.$Gb(),n.x6a(),t.ao(n,"beforeLayoutChanged",{changeType:"invalidateLayout"}),n.oq&&(n.ds(),n.oq=!1),n.jq&&(n.es(),n.jq=!1),n.x6a(),t.ao(n,K,{changeType:"invalidateLayout"}),i&&i.cs&&r.Vl.Wl(n)&&!i.byb(n)&&i.cs(n.Jl,n.Kl),n.$l=!0,(e=n.parent)&&e.options.enableAccessibility&&(o=n.cgc(),e.dgc(o))},t.prototype.$p=function(){var t=this;t.Xq<=0&&(t.invalidateLayout(),t.repaint())},t.prototype.getViewportHeight=function(t){var e=this.am();return 0===t?e.fs:1===t?this.oKc(e):2===t?e.gs:0},t.prototype.getViewportWidth=function(t){var e=this.am();return 0===t?e.hs:1===t?this.rKc(e):2===t?e.js:0},t.prototype.getViewportTopRow=function(t){var e=this,o=wt(e);return 0===t?0:1===t?V(o,e.lq):2===t?V(o,gt(e)-yt(e)):-1},t.prototype.getViewportTopRowOffset=function(){return this.cCb},t.prototype.getViewportBottomRow=function(t){var e,o,n,r,i,a,s=this;if(2===t)return gt(s)-1;for(e=s.getViewportTopRow(t),o=s.getViewportHeight(t),n=1===t?s.cCb:0,r=0,i=gt(s)-yt(s),0===t&&(i=_(wt(s),i)),a=e;a<i&&n<o;a++,r++)n+=s.Sl(a);return e+r-1},t.prototype.jCb=function(t){var e,o=this,n=o.getViewportTopRow(t),r=o.getViewportBottomRow(t);for(e=n;e<r+1;e++)if(e>-1&&o.getRowVisible(e,3)&&o.Sl(e,3)>0)return e;return-1},t.prototype.getViewportLeftColumn=function(t){var e=this,o=bt(e);return 0===t?0:1===t?V(o,e.qq):2===t?V(o,dt(e)-mt(e)):-1},t.prototype.getViewportLeftColumnOffset=function(){return this.eCb},t.prototype.getViewportRightColumn=function(t){var e,o,n,r,i,a,s=this;if(2===t)return dt(s)-1;for(e=s.getViewportLeftColumn(t),o=s.getViewportWidth(t),n=0,r=1===t?s.eCb:0,i=dt(s)-mt(s),0===t&&(i=_(bt(s),i)),a=e;a<i&&r<o;a++,n++)r+=s.Tl(a);return e+n-1},t.prototype.kCb=function(t){var e,o=this,n=o.getViewportLeftColumn(t),r=o.getViewportRightColumn(t);for(e=n;e<r+1;e++)if(e>-1&&o.getColumnVisible(e,3)&&o.Tl(e,3)>0)return e;return-1},t.prototype.showCell=function(t,e,o,n){this.iXc(t,e,o,n)},t.prototype.iXc=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,C=this;t<0||t>=gt(C)||e<0||e>=dt(C)||(l=C.parent&&C.parent.options.scrollByPixel,u=C.parent&&C.parent.options.scrollbarMaxAlign,c=C.Fr(e),f=C.Er(t),h=C.getViewportTopRow(f),p=C.cCb,d=C.getViewportLeftColumn(c),g=C.eCb,1===c&&T(i)&&(e=(a=C.gXc(e,n,l,u)).col,i=a.offset),1===f&&T(r)&&(t=(s=C.hXc(t,o,l,u)).row,r=s.offset),m=!1,1!==f||t===h&&r===p||(t=_(t,C.ns()),C.lq=t,C.cCb=r,C.os(),m=!0),1!==c||e===d&&i===g||(e=_(e,C.ps()),C.qq=e,C.eCb=i,C.qs(),m=!0),m&&((y=C.parent)&&!y.options.scrollbarShowMax&&(C.oq=!0,C.jq=!0),C.$p()))},t.prototype.Er=function(t){var e=this,o=1;return t<wt(e)?o=0:t>=gt(e)-yt(e)&&(o=2),o},t.prototype.Fr=function(t){var e=this,o=1;return t<bt(e)?o=0:t>=dt(e)-mt(e)&&(o=2),o},t.prototype.hXc=function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g,m=this,y=m.ss,C=m.Er(t),v=m.getViewportTopRow(C),b=m.cCb,w=wt(m),T=m.ir();if(0===e)if(n){for(a=T,i=m.getViewportHeight(C);w<=a;a--)if((i-=y.Sl(a))<0){t<=a?b=0:(t=a,b=i);break}}else b=0;else if(1===e){if(s=!1,l=!1,n){for(a=T,i=u=H(m.getViewportHeight(C)/2);w<=a;a--)if((i-=y.Sl(a))<0){t>=a&&(a--,i+=u,l=!0);break}if(l)for(;w<=a;a--)if((i-=y.Sl(a))<0){t=a,b=i,s=!0;break}}if(!s){for(i=H((m.getViewportHeight(C)-y.Sl(t))/2);w<t;t--)if((i-=y.Sl(t-1))<0){t-=1,b=i;break}i>0&&t===w&&(b=0)}}else if(2===e){for(i=m.getViewportHeight(C)-y.Sl(t);w<t;t--)if((i-=y.Sl(t-1))<0){t-=1,b=i;break}i>0&&t===w&&(b=0)}else if(3===e)if(t>v){if(f=(c=m.am()).pt,h=c.qt,p=c.er,d=c.jr,g=m.getCellRect(t,m.Kl),new r.Rect(f,h,p,d).containsRect(g,!0))t=v;else for(i=m.getViewportHeight(C)-y.Sl(t);v<t;t--)if((i-=y.Sl(t-1))<0){t-=1,b=i;break}}else b=0;return!o&&b<0&&(b=0,t<T&&(t+=1)),{row:t,offset:b}},t.prototype.gXc=function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g,m=this,y=m.ss,C=m.Fr(t),v=m.getViewportLeftColumn(C),b=m.eCb,w=bt(m),T=m.dr();if(0===e)if(n){for(i=m.getViewportWidth(C),a=T;w<=a;a--)if((i-=y._m(a))<0){t<=a?b=0:(t=a,b=i);break}}else b=0;else if(1===e){if(s=!1,l=!1,n){for(i=u=H(m.getViewportWidth(C)/2),a=T;w<=a;a--)if((i-=y._m(a))<0){t>=a&&(a--,i+=u,l=!0);break}if(l)for(;w<=a;a--)if((i-=y._m(a))<0){t=a,b=i,s=!0;break}}if(!s){for(i=H((m.getViewportWidth(C)-y._m(t))/2);w<t;t--)if((i-=y._m(t-1))<0){t-=1,b=i;break}i>0&&t===w&&(b=0)}}else if(2===e){for(i=m.getViewportWidth(C)-y._m(t);w<t;t--)if((i-=y._m(t-1))<0){t-=1,b=i;break}i>0&&t===w&&(b=0)}else if(3===e)if(t>v){if(f=(c=m.am()).pt,h=c.qt,p=c.er,d=c.jr,g=m.getCellRect(m.Jl,t),new r.Rect(f,h,p,d).containsRect(g,!0))t=v;else for(i=m.getViewportWidth(C)-y._m(t);v<t;t--)if((i-=y._m(t-1))<0){t-=1,b=i;break}}else b=0;return!o&&b<0&&(b=0,t<T&&(t+=1)),{col:t,offset:b}},t.prototype.ms=function(t,e){var o,n=this,r=n.ss,i=n.Er(t),a=n.getViewportTopRow(i);if(0!==e)if(1===e)for(o=H((n.getViewportHeight(i)-r.Sl(t))/2);0<t&&!((o-=r.Sl(t-1))<0);t--);else if(2===e)for(o=n.getViewportHeight(i)-r.Sl(t);0<t&&!((o-=r.Sl(t-1))<0);t--);else if(3===e&&!(t<a||-1===a))for(o=n.getViewportHeight(i)-r.Sl(t);a<t&&!((o-=r.Sl(t-1))<0);t--);return t},t.prototype.showColumn=function(t,e){this.showCell(this.lq,t,0,e)},t.prototype.showRow=function(t,e){this.showCell(t,this.qq,e,0)},t.prototype.suspendEvent=function(){this.jm++},t.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},t.prototype.isEventSuspended=function(){return this.jm>0},t.prototype.currentTheme=function(t){var e=this;return 0===arguments.length?(e.Pm||e.ts(),e.Pm):(typeof t===J&&(t=C.Themes[t]?C.Themes[t]:new C.Theme(t)),e.Pm=t,e.yl.us(),e.Jq(),e.$p(),e)},t.prototype.P3=function(){var t=r.Im.Lm(""),e=j(t.zIndex),o=C.Themes.Office2007;return e>2007&&(o=C.Themes.Office),o},t.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},t.prototype.reset=function(){this.vs(),this.$p()},t.prototype.vs=function(){var e,o,n=this,i=n.DHb();n.Pp(),n.Nr=0,n.Pr=0,n.T3(),n._r=G,n.as={colHeader:G,viewport:G},n.bs={rowHeader:G,viewport:G},n.lq=0,n.cCb=0,n.qq=0,n.eCb=0,n.frozenRowCount(0),n.frozenColumnCount(0),n.frozenTrailingRowCount(0),n.frozenTrailingColumnCount(0),t.ao(n,"beforeSetHost"),(e=n.parent)&&((o=e.getActiveSheet())&&n.name()===o.name()&&n.ws(e.xs)),n.Cq=[{},{},{},{}],n.ss=new r.ln(n),n.Oq={},m&&n.resetCalc(),n.ITa=new l.lUa(n,t.Rp,t.Sp,t.Vp,t.Tp,n.name()),n.defaults=n.ITa.defaults,n.DHb(i),n.ts(),n.Lq={},n.oq=!0,n.jq=!0,n.parent&&n.parent.xD?n.Xq=n.parent.xD:n.Xq=0,n.parent&&n.parent.jm?n.jm=n.parent.jm:n.jm=0,n.gga=0,n.Js=!1,n.Ks=G,n.Wr=[],n.Zr=[],n.OIb=!1,t.ao(n,"init")},t.prototype.T3=function(){var t=this;R(lt,(function(e,o){if(!T(o)){var n=o;"gridline"===e?n={color:r.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof n&&(n=u.GC$.extend({},o)),t.options[e]=n}}))},t.prototype.Ls=function(e){var o,n=this;for(n.parent=e,o=n.Xq;o<e.xD;o++)n.suspendPaint();n.jm=e.jm,t.ao(n,"attach",e)},t.prototype.jJb=function(t,e){return t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount},t.prototype.kJb=function(t,e,o,n,r){var i,a,s=this.Ms(e,o,n,r).ranges;for(i=0;i<s.length;i++)for(a=0;a<t.length;a++)if(this.jJb(t[i],s[a]))return!0;return!1},t.prototype.lJb=function(t,e,o,n,r){var i,a=!1;return void 0!==r?0===r?(i=this.Ms(t,e,o,this.getColumnCount()-e).ranges).length>0&&(t-1>0&&(a=this.kJb(i,t-1,e,1,this.getColumnCount()-e)),a||(a=this.kJb(i,t+o,e,1,this.getColumnCount()-e)),a||(a=this.kJb(i,t,e,o,1))):(i=this.Ms(t,e,this.getRowCount()-t,n).ranges).length>0&&(t-1>0&&(a=this.kJb(i,t-1,e,this.getRowCount()-t,1)),a||(a=this.kJb(i,t+o,e,this.getRowCount()-t,1)),a||(a=this.kJb(i,t,e,1,n))):a=!0,a},t.prototype.Y3=function(t,e,o,n,i,a,s,l,u){var c,f=this;return!s&&f.options.isProtected&&f.ou(r.kf(t,e,o,n),u)?(i&&f.Os(1,i),!1):(c=this.lJb(t,e,o,n,l),!(m&&c&&!f.Vq(t,e,o,n)&&(a&&f.Os(1,a),1)))},t.prototype.clear=function(t,e,o,n,r,i,a,s,l){0!==r&&this.cg(t,e,o,n,r,i,a,s,l)},t.prototype.cg=function(e,o,n,r,i,a,s,l,u){var c,f,h,p,d,g,y,C,v,b,w,S,x,A,I=this,R=m;try{if(R&&I.suspendCalcService(),I.suspendPaint(),c=I.defaults,f=void 0,h=void 0,p=void 0,d=void 0,3,g={changeType:"clear",row:e,col:o,rowCount:n,colCount:r,sheetArea:i,type:a,ignoreTable:l,ignorePivotTable:u,canClear:!0},t.ao(I,K,g),!g.canClear)return;if(T(i)||3===i){if(R&&!I.Vq(e,o,n,r))return!1;if(1&a&&I.getDataSource&&I.getDataSource()){for(I.suspendEvent(),f=e;f<e+n;f++)if(!(s&&I.Ps&&I.Ps(f)))for(h=o;h<o+r;h++)I.setValue(f,h,G,i);I.resumeEvent()}}for(y=I.ITa,C=R&&I.Bj(),f=-1===e?0:e,v=-1===e?y.getRowCount(i):n,h=-1===o?0:o,b=-1===o?y.getColumnCount(i):r,w=[],S=f;S<v+f;S++)s&&I.Ps&&I.Ps(S)&&w.push(S);if(y.do("clear",f,h,v,b,a,w,i),C&&1&a&&(C.Sg(f,h,v,b),C.clear(f,h,v,b,y.dUa())),8&a&&!(e>=0&&o>=0))if(o>=0)for(d=0;d<b;d++)I.setTag(-1,h+d,G,i);else if(e>=0)for(p=0;p<v;p++)s&&I.Ps&&I.Ps(f+p)||I.setTag(f+p,-1,G,i);else I.setTag(-1,-1,G,i);if(256&a&&!(e>=0&&o>=0))if(o>=0)for(d=0;d<b;d++)I.setHyperlink(-1,h+d,G,i);else if(e>=0)for(p=0;p<v;p++)s&&I.Ps&&I.Ps(f+p)||I.setHyperlink(-1,-1,G);if(2&a&&!(e>=0&&o>=0))if(o>=0)for(d=0;d<b;d++)I.setStyle(-1,h+d,G,i);else if(e>=0)for(p=0;p<v;p++)s&&I.Ps&&I.Ps(f+p)||I.setStyle(f+p,-1,G,i);else I.setStyle(-1,-1,G,i);if(32&a){if(e<0)for(d=0;d<b;d++)I.setColumnVisible(h+d,!0,i),I.setColumnResizable(h+d,!0,i),I.setColumnWidth(h+d,2===i?c.rowHeaderColWidth:c.colWidth,i);if(o<0)for(p=0;p<v;p++)s&&I.Ps&&I.Ps(f+p)||(I.setRowVisible(f+p,!0,i),I.setRowResizable(f+p,!0,i),I.setRowHeight(f+p,1===i?c.colHeaderRowHeight:c.rowHeight,i))}for((T(i)||3===i)&&R&&1==(1&a)&&((x=I.Bj())&&x.Ag(e,o,n,r)),A=[],p=0;p<v;p++)for(d=0;d<b;d++)A.push({row:f+p,col:h+d});I.Bu(e,o,v,b,A,2,i)}finally{I.resumePaint(),R&&I.resumeCalcService(!1)}},t.prototype._p=function(){var t,e,o,n,r=this,i=r.options,a=i.protectionOptions;i.isProtected&&a&&(t=a.allowSelectLockedCells,e=a.allowSelectUnlockedCells,(!1===t&&!1!==e||!1!==t&&!1===e)&&(o=r.Jl,n=r.Kl,r.Qs(o,n)||(r.Tr(),r.Rs(o,n,!0),r.Ss(4,o,n))))},t.prototype.setArray=function(t,e,o,n){var r,i,a,s,l=this,c=m;if(n=c&&n,r=gt(l),i=dt(l),o&&0<=t&&t<r&&0<=e&&e<i){c&&l.suspendCalcService(),l.suspendPaint();try{R(o,(function(o,c){u.GC$.isArray(c)?R(c,(function(u,c){s=e+u,(a=t+o)<r&&s<i&&(n?l.setFormula(a,s,c):l.setValue(a,s,c,3,!0))})):(s=e,(a=t+o)<r&&s<i&&(n?l.setFormula(a,s,c):l.setValue(a,s,c,3,!0)))}))}finally{c&&l.resumeCalcService(),l.resumePaint()}}},t.prototype.getArray=function(t,e,o,n,r){var i,a,s=this,l=[],u=gt(s),c=dt(s);if(r=r&&m,0<=t&&t<u&&0<=e&&e<c)for(t+o>u&&(o=u-t),e+n>c&&(n=c-e),i=0;i<o;i++)for(l[i]=[],a=0;a<n;a++)l[i][a]=r?s.getFormula(t+i,e+a):s.getValue(t+i,e+a);return l},t.prototype.setTag=function(t,e,o,n){var r,i,a,s,l,u;if(T(n)&&(n=3),r=this,0!==n){if(a=(i=r.ITa).getRowCount(n),s=i.getColumnCount(n),t<-1||t>=a||e<-1||e>=s)return;o=N(o),l=void 0,(u=r.jm>0)||(l=r.getTag(t,e,n)),i.do("setValueForKey",t,e,Y,o,n),l!==o&&(-1!==t&&-1!==e?u?r.WXc(r,[{row:t,col:e}],0):r.Bq(Y,t,e,n,l,o):-1!==t&&-1===e?r.kq(t,n,Y,o,l):-1===t&&-1!==e&&r.pq(e,n,Y,o,l))}},t.prototype.getTag=function(t,e,o){var n;return T(o)&&(o=3),0!==o?(n=this.ITa.getValueForKey(t,e,Y,o),O(n)):G},t.prototype.tag=function(t){var e,o=this;return 0===arguments.length?(e=o.ITa.getValueForKey(-1,-1,Y,3),O(e)):(o.ITa.do("setValueForKey",-1,-1,Y,N(t),3),o)},t.prototype.getParent=function(){return this.parent},t.prototype.getDirtyRows=function(){return ft(this,!0)},t.prototype.getInsertRows=function(){return ft(this,!1)},t.prototype.getDeletedRows=function(){var t=[],e=this.Ts;return e&&R(e,(function(e,o){o&&!u.GC$.isFunction(o)&&t.push({row:o.row,originalItem:o.data})})),t},t.prototype.hasPendingChanges=function(){var t,e=this.Ts;return!!(e&&e.length>0)||(t=this.ITa.hUa(),!M(t))},t.prototype.clearPendingChanges=function(e){var o,n,r,i,a,s=this;return T(e)||M(e)?(s.ITa.iUa(),s.Ts=[],void t.ao(s,"clearPendingChanges")):(o=e.row,n=e.col,r=e.rowCount,i=e.colCount,(1&(a=(a=e.clearType)||st.dirty))===st.dirty&&s.Rec(o,n,r,i),(2&a)===st.insert&&s.Sec(o,n,r,i),void((4&a)===st.delete&&s.Tec(o,n,r,i)))},t.prototype.Rec=function(e,o,n,r){var i=this,a=i.ITa,s=i.Uec(e,o,n,r),l=i.Vec(o,r);s?(a.Qec(),t.ao(i,"clearPendingChanges")):a.Mec(l,e,o,n,r)},t.prototype.Sec=function(t,e,o,n){var r=this,i=r.ITa,a=r.Uec(t,e,o,n),s=r.Vec(e,n);i.Lec(a,s,t,o)},t.prototype.Tec=function(t,e,o,n){var r,i,a,s=this;if(s.Uec(t,e,o,n))s.Ts=[];else if(s.Vec(e,n)&&(r=s.Ts))for(i=[],R(r,(function(e,n){if(n){var r=n.row;t<=r&&r<t+o&&i.push(e)}})),a=i.length-1;a>=0;a--)s.Ts.splice(i[a],1)},t.prototype.Vec=function(t,e){return T(t)||-1===t||0===t&&this.getColumnCount()===e},t.prototype.Wec=function(t,e){return T(t)||-1===t||0===t&&e===this.getRowCount()},t.prototype.Uec=function(t,e,o,n){return this.Vec(t,o)&&this.Vec(e,n)},t.prototype.getDirtyCells=function(t,e,o,n){var r,i,a,s,l,u,c,f=this;if(T(t)&&(t=-1),T(e)&&(e=-1),(T(o)||o<=0)&&(o=1),(T(n)||n<=0)&&(n=1),r=[],i=f.ITa.hUa(),!M(i)){if(a=[],t>=0)for(s=t;s<t+o;s++)a.push(s);else for(l in i)k(i,l)&&a.push(j(l));R(a,(function(t,o){var a,s;if((u=i[o])&&"e"===u.rs)if(e>=0)for(a=e;a<e+n;a++)(c=u[a])&&r.push(St(f,o,a,c.oldValue));else for(s in u)L(s)||(c=u[s])&&r.push(St(f,o,j(s),c.oldValue))}))}return r},t.prototype.suspendDirty=function(){this.gga++,this.ITa.jUa()},t.prototype.resumeDirty=function(){var t=this;t.gga--,t.gga<0&&(t.gga=0),t.ITa.kUa()},t.prototype.isDirtySuspended=function(){return this.gga>0},t.prototype.ad=function(t){this.Us(new r.Rect(0,0,0,0)),this.vs(),this.cq(t)},t.prototype.Vs=function(){var t,e=this.Ws(),o={top:0,left:0};return e&&e.parentElement&&((o=u.GC$(e).offset())&&(o.top+=E.body.clientTop||0,o.left+=E.body.clientLeft||0)),(t=e&&e.canvasOffset)&&(o=t),o},t.prototype.ws=function(e){var o,n,i;e&&((o=this).Js=!1,o.Xs&&o.no(!1),n=S("canvas"),i=o.parent&&o.parent.options.enableAccessibility?"":at().NeedCanvasSupport,u.GC$(n).attr("id",e.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(i).appendTo(e),r.En.Kn(n,G,o),o.Xs=n,o.fq(),o.repaint(),o.parent&&o.parent.Ys(),t.ao(o,"setHost",u.GC$(n)))},t.prototype.Jgc=function(t,e,o,n,r,i,a,s,l){var u,c,f=this;for(u=o;u<n;u++)c=f.getText(e,u,l),t.push('"'+c+'"');for(u=r;u<i;u++)c=f.getText(e,u,l),t.push('"'+c+'"');for(u=a;u<s;u++)c=f.getText(e,u,l),t.push('"'+c+'"')},t.prototype.Kgc=function(){var t,e,o,n,r,i=this,a=i.getViewportTopRow(1),s=i.getViewportBottomRow(1),l=i.getViewportLeftColumn(1),u=s-a+1,c=i.getViewportRightColumn(1)-l+1,f=i.getRowCount(p.SheetArea.colHeader),h=i.getColumnCount(p.SheetArea.rowHeader),d=i.frozenColumnCount(),g=mt(i),m=i.getColumnCount(),y=i.frozenRowCount(),C=yt(i),v=i.getRowCount(),b=[];for(t=0;t<f;t++)e=[],i.Jgc(e,t,0,d,l,l+c,m-g,m,p.SheetArea.colHeader),b.push(e.join(","));for(t=0;t<y;t++){for(o=[],n=0;n<h;n++)r=i.getText(t,n,p.SheetArea.rowHeader),o.push('"'+r+'"');i.Jgc(o,t,0,d,l,l+c,m-g,m),b.push(o.join(","))}for(t=a;t<a+u;t++){for(o=[],n=0;n<h;n++)r=i.getText(t,n,p.SheetArea.rowHeader),o.push('"'+r+'"');i.Jgc(o,t,0,d,l,l+c,m-g,m),b.push(o.join(","))}for(t=v-C;t<v;t++){for(o=[],n=0;n<h;n++)r=i.getText(t,n,p.SheetArea.rowHeader),o.push('"'+r+'"');i.Jgc(o,t,0,d,l,l+c,m-g,m),b.push(o.join(","))}return b.join(";")},t.prototype.cgc=function(t){var e,o,n,i,a,s,l,u,c=this;return r.util.sl()?c.Kgc():(e=c.Jl,o=c.Kl,n=p.SheetArea.viewport,!t||T(t.row)||T(t.col)||(e=t.row,o=t.col,n=t.hitTestType),i=at(),a="",s=c.getText(e,o,n),n===p.SheetArea.rowHeader?a=i.ARIA_RowHeader+" ":n===p.SheetArea.colHeader?a=i.ARIA_ColumnHeader+" ":(T(n)||n===p.SheetArea.viewport)&&(l=c.getFormula(e,o),u=c.comments&&c.comments.get(e,o)),a+c.fYc(e,o,s,l,u&&u.text()))},t.prototype.fYc=function(t,e,o,n,i){var a=at(),s=a.ARIA_Cell+" "+r.util.xq(e+1)+(t+1)+" ";return T(o)||""===o||(s+=F.Kb(a.ARIA_HasValue,[o])+", "),T(n)||(s+=F.Kb(a.ARIA_HasFormula,[n])+", "),T(i)||(s+=F.Kb(a.ARIA_HasComment,[i])),s},t.prototype.fq=function(){var t,e,o,n,i,a,s,l,c=this,f=c.Ws();f&&f.parentNode&&(e=(t=getComputedStyle(f.parentNode)).width,o=t.height,(n=e.indexOf("px"))>0&&(e=e.substring(0,n)),(n=o.indexOf("px"))>0&&(o=o.substring(0,n)),i=j(e),a=j(o),L(i)&&(i=u.GC$(f.parentNode).width()),L(a)&&(a=u.GC$(f.parentNode).height()),0!==i&&0!==a&&(s=V(i,0),l=V(a,0),f.style.display="none",f.style.display="",f.width=s,f.height=l,f.style.width=s+"px",f.style.height=l+"px",s=f.clientWidth||f.width,l=f.clientHeight||f.height,c.Zs.width=s,c.Zs.height=l,r.En.Pn(f,s,l),c.invalidateLayout()))},t.prototype.no=function(e,o){var n,i,a,s=this;!0!==s.Js&&(r.En.Sn(s),s.isEditing&&s.isEditing()&&s.Yoa(),t.ao(s,"dispose",{clearCache:e,isSheetDestroy:!0,hasActiveSheet:o}),(n=s.Xs)&&((i=n.parentNode)&&i.removeChild(n),s.Xs=G),s.$s(),s.ITa&&s.ITa.no(e),!1!==e&&(s.Js=!0,(a=s.at)&&a.no(),s.parent=G,s.ITa=G,s.ss&&(s.ss.no(),s.ss=G),s.bt&&(s.bt.no(),s.bt=G),r.Vl.Wl(s)&&r.Vl.Zl(G,!0),s.uu&&(s.uu=G),s.Wr=G,s.Zr=G))},t.prototype.$s=function(){var t=this.dt;t&&(u.GC$(t).remove(),this.dt=B)},t.prototype.vq=function(t,e,o,n,r){var i,a,s,l,u;return T(n)&&(n=3),3===n&&this.jIb&&((i=t.getDynamicArrayInfo(e,o))&&i.isValid&&(e!==i.row||o!==i.col))?G:(a=this.et,!this.loading&&a&&((s=a.getCalcService()).calcOnDemand&&3===n&&!s.IsSuspended()&&((l=a.qg(e,o))&&!0===l.$l&&(l.$l=!1,delete l.dh,delete l.eh,a.recalculateCell(e,o),this.yj().ZIc()))),u=t.getValue(e,o,n,this.loading,r),u=O(u))},t.prototype.Tq=function(t,e){var o,n,i,a,s;return T(e)&&(e=3),o=r.kf(-1,-1,-1,-1),t&&(this,n=t.row,i=t.col,a=t.rowCount,s=t.colCount,-1===i&&(i=0,s=this.getColumnCount(e)),-1===n&&(n=0,a=this.getRowCount(e)),o.col=i,o.row=n,o.colCount=s,o.rowCount=a),o},t.prototype.getRangeRect=function(t,e,o){var n,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b=new r.Rect(-1,-1,-1,-1),w=this,T=w.am();if(0===T.width||0===T.height)return b;if(n=w.it(e),i=w.jt(t),!n||0===n.length||!i||0===i.length)return b;return a=w.Tq(o),s=w.ss,l=a.row,u=a.row+a.rowCount-1,c=a.col,f=a.col+a.colCount-1,h=wt(w),p=gt(w)-yt(w)-1,d=bt(w),g=dt(w)-mt(w)-1,m=n[0].col,y=n[n.length-1].col,C=i[0].row,v=i[i.length-1].row,c<m&&(c=function(t,e){for(;t>e;)if(t--,w.getColumnVisible(t))return t;return t}(m,c)),f>y&&(f=function(t,e){for(;t<e;)if(t++,w.getColumnVisible(t))return t;return t}(y,f)),l<C&&(l=function(t,e){for(;t>e;)if(t--,w.getRowVisible(t))return t;return t}(C,l)),u>v&&(u=function(t,e){for(;t<e;)if(t++,w.getRowVisible(t))return t;return t}(v,u)),f<c||u<l||(0===e?c<d&&(b.x=T.kt+ht(s,0,c-1),b.width=ht(s,c,f)):1===e?c<=g&&f>=d&&(b.x=c<m?n[0].x-ht(s,c,m-1):n[0].x+ht(s,m,c-1),b.width=ht(s,c,f)):2===e&&f>g&&(b.x=c<m?T.lt-ht(s,c,m-1):T.lt+ht(s,m,c-1),b.width=ht(s,c,f)),0===t?l<h&&(b.y=T.nt+pt(s,0,l-1),b.height=pt(s,l,u)):1===t?l<=p&&u>=h&&(b.y=l<C?i[0].y-pt(s,l,C-1):i[0].y+pt(s,C,l-1),b.height=pt(s,l,u)):2===t&&u>p&&(b.y=l<C?T.ot-pt(s,l,C-1):T.ot+pt(s,C,l-1),b.height=pt(s,l,u))),b},t.prototype.isintersectWithArrayFormula=function(t){var e,o,n=this.Bj();if(n)for(e=t.row;e<t.row+t.rowCount;e++)for(o=t.col;o<t.col+t.colCount;o++)if(n.dg(e,o,1,1))return!0;return!1},t.prototype.cm=function(t){var e,o,n,i,a,s,l,u,c,f,h,p,d,g,m=this,y=new r.Rect(-1,-1,-1,-1),C=m.am();if(0===C.width||0===C.height)return y;if(e=m.Tq(t),o=bt(m),n=wt(m),i=mt(m),a=yt(m),s=m.ss,l=e.row,u=e.row+e.rowCount-1,c=e.col,f=e.col+e.colCount-1,h=gt(m),p=dt(m),c<o)y.x=C.kt+ht(s,0,c-1),y.width=ht(s,c,_(f,o-1)),o<=f&&f<p-i?(d=m.it(1))&&d.length>0&&(y.width+=ht(s,d[0].col,_(f,d[d.length-1].col))+m.eCb):f>=p-i&&((d=m.it(2))&&d.length>0&&(y.width=d[0].x-y.x,y.width+=ht(s,p-i,_(f,p-1))));else if(c<p-i){if(!(d=m.it(1))||0===d.length||c>d[d.length-1].col||f<d[0].col)return y;y.x=C.pt+ht(s,d[0].col,c-1)+m.eCb,o<=f&&f<p-i?y.width=ht(s,V(c,d[0].col),_(f,d[d.length-1].col)):f>=p-i&&((d=m.it(2))&&d.length>0&&(y.width=d[0].x-y.x,y.width+=ht(s,p-i,_(f,p-1))))}else c<p&&((d=m.it(2))&&d.length>0&&(y.x=C.lt+ht(s,d[0].col,c-1),y.width=ht(s,c,_(f,p-1))));if(l<n)y.y=C.nt+pt(s,0,l-1),y.height=pt(s,l,_(u,n-1)),n<=u&&u<h-a?(g=m.jt(1))&&g.length>0&&(y.height+=pt(s,g[0].row,_(u,g[g.length-1].row))+m.cCb):u>=h-a&&((g=m.jt(2))&&g.length>0&&(y.height=g[0].y-y.y,y.height+=pt(s,h-a,_(u,h-1))));else if(l<h-a){if(!(g=m.jt(1))||0===g.length||l>g[g.length-1].row||u<g[0].row)return y;y.y=C.qt+pt(s,g[0].row,l-1)+m.cCb,n<=u&&u<h-a?y.height=pt(s,V(l,g[0].row),_(u,g[g.length-1].row)):u>=h-a&&((g=m.jt(2))&&g.length>0&&(y.height=g[0].y-y.y,y.height+=pt(s,h-a,_(u,h-1))))}else l<h&&((g=m.jt(2))&&g.length>0&&(y.y=C.ot+pt(s,g[0].row,l-1),y.height+=pt(s,l,_(u,h-1))));return y},t.prototype.Ws=function(){return this.Xs},t.prototype.rt=function(t,e){return this.dp(t,e)+1},t.prototype.dp=function(t,e){var o,n=this.yl;return o=e||n.Cl(n.Bl()),r.Vn.Xn(t,o)},t.prototype.or=function(t){var e=this.am(),o=G,n=e.pt,r=this.rKc(e),i=e.lt,a=e.js;return e.zr<t&&t<e.zr+e.Br?o=-1:e.kt<t&&t<e.kt+e.hs?o=0:n<t&&t<n+r?o=1:i<t&&t<i+a&&(o=2),o},t.prototype.nr=function(t){var e=this.am(),o=G,n=e.qt,r=this.oKc(e),i=e.ot,a=e.gs;return e.Ar<t&&t<e.Ar+e.Cr?o=-1:e.nt<t&&t<e.nt+e.fs?o=0:n<t&&t<n+r?o=1:i<t&&t<i+a&&(o=2),o},t.prototype.pr=function(t,e){var o,n;if((o=-1===e?this.ut():this.jt(e))&&(n=o.findY(t)))return n.row},t.prototype.qr=function(t,e){var o,n;if((o=-1===e?this.vt():this.it(e))&&(n=o.findX(t)))return n.col},t.prototype.wt=function(t,e){var o=this;return o.Jl<=t&&t<o.Jl+o.Lr&&o.Kl<=e&&e<o.Kl+o.Mr},t.prototype.sp=function(t){return this.ITa.sp(t)},t.prototype.tp=function(t){return this.ITa.tp(t)},t.prototype.vp=function(t,e,o,n){var r=gt(this),i=dt(this);return this.ITa.vp(t,e,o,r,i,n)},t.prototype.wp=function(t,e,o){var n=gt(this),r=dt(this);return this.ITa.wp(t,e,o,n,r)},t.prototype.xt=function(t,e,o){var n,r,i,a,s,l,u=this,c=u.yt;if(c&&!c.resizeInfo&&!T(o)){if(a=c.hitTestType,s=c.row,l=c.col,1===o)return n=!1,(r=u.ITa.findSpan(s,l,1))&&(n=r.contains(t,e,1,1)),i=t===s&&e===l||n,a===o&&i;if(2===o)return n=!1,(r=u.ITa.findSpan(s,l,2))&&(n=r.contains(t,e,1,1)),i=t===s&&e===l||n,a===o&&i;if(3===o)return a===o&&t===s&&e===l;if(0===o)return a===o}return!1},t.prototype.sr=function(t,e){return t>=0&&t<=2&&e>=0?3:t>=0&&t<=2&&e<0?2:t<0&&e>=0?1:t<0&&e<0?0:G},t.prototype.zt=function(t){var e=this.mm;e&&e.zt(t)},t.prototype.zo=function(){var t,e=this.parent,o=e&&e.qo;return o||(o=(t=this.Xs)&&t.parentElement),o},t.prototype.Pp=function(){var t=this;t.Jl=0,t.Kl=0,t.Lr=1,t.Mr=1,t.Qr=0,t.Rr=0},t.prototype.Sl=function(t,e,o){var n=this.getRowHeight(t,e),r=this.zoom();return 1!==r&&(n*=r),o?n:z(n)},t.prototype.Tl=function(t,e,o){var n=this.getColumnWidth(t,e),r=this.zoom();return 1!==r&&(n*=r),o?n:z(n)},t.prototype.At=function(){var t,e,o,n,i,a,s,l,u,c,f,h,p,d,g,m=this,y=m.Dr(),C=m.options,v=C.sheetAreaOffset.left,b=C.sheetAreaOffset.top,w=new r.Rect(y.x+v,y.y+b,V(0,y.width-v),V(0,y.height-b)),T=w.width,S=w.height,x=Ct(m),A=vt(m),I={x:w.x,y:w.y,width:w.width,height:w.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,$Lc:0,_Lc:0,pKc:0,sKc:0,zr:0,Ar:0,em:function(){var t=this;return new r.Rect(t.x,t.y,t.Br,t.Cr)},gm:function(t){var e=this;return 0===t?new r.Rect(e.kt,e.y,e.hs,e.Cr):1===t?new r.Rect(e.pt,e.y,m.rKc(e),e.Cr):2===t?new r.Rect(e.lt,e.y,e.js,e.Cr):G},fm:function(t){var e=this;return 0===t?new r.Rect(e.x,e.nt,e.Br,e.fs):1===t?new r.Rect(e.x,e.qt,e.Br,m.oKc(e)):2===t?new r.Rect(e.x,e.ot,e.Br,e.gs):G},Ft:function(t,e){var o=this;if(0===t){if(0===e)return new r.Rect(o.kt,o.nt,o.hs,o.fs);if(1===e)return new r.Rect(o.pt,o.nt,m.rKc(o),o.fs);if(2===e)return new r.Rect(o.lt,o.nt,o.js,o.fs)}else if(1===t){if(0===e)return new r.Rect(o.kt,o.qt,o.hs,m.oKc(o));if(1===e)return new r.Rect(o.pt,o.qt,m.rKc(o),m.oKc(o));if(2===e)return new r.Rect(o.lt,o.qt,o.js,m.oKc(o))}else if(2===t){if(0===e)return new r.Rect(o.kt,o.ot,o.hs,o.gs);if(1===e)return new r.Rect(o.pt,o.ot,m.rKc(o),o.gs);if(2===e)return new r.Rect(o.lt,o.ot,o.js,o.gs)}return G}};if(m.Gt&&(0,(t=m.Gt()).width>0&&(I.x+=t.width+0,T-=t.width+0),t.height>0&&(I.y+=t.height+0,S-=t.height+0)),C.rowHeaderVisible)for(i=m.getColumnCount(2),n=0;n<i;n++)I.Br+=m.Tl(n,2);if(C.colHeaderVisible)for(o=m.getRowCount(1),e=0;e<o;e++)I.Cr+=m.Sl(e,1);if((a=bt(m))>0)for(i=dt(m),n=0;n<a&&n<i;n++)m.getColumnVisible(n)&&(I.hs+=m.Tl(n));if((s=wt(m))>0)for(o=gt(m),e=0;e<s&&e<o;e++)m.getRowVisible(e)&&(I.fs+=m.Sl(e));if((l=mt(m))>0)for(i=dt(m),n=V(a,i-l);n<i;n++)I.js+=m.Tl(n);if((u=yt(m))>0)for(o=gt(m),e=V(s,o-u);e<o;e++)I.gs+=m.Sl(e);if(I.zr=I.x,I.Ar=I.y,I.kt=I.zr+I.Br,I.nt=I.Ar+I.Cr,I.pt=I.kt+I.hs,I.qt=I.nt+I.fs,T-=I.Br,S-=I.Cr,T-=I.hs,S-=I.fs,T-=I.js,S-=I.gs,T-=I.sKc,S-=I.pKc,S-=I.Bt,o=gt(m),c=0,(f=(i=dt(m))-l)>0)for(c+=m.eCb,n=V(a,m.qq);n<f&&c<T;n++)c+=m.Tl(n);if(c<(h=V(0,T))?(I.sKc=h-c,I.er=c,h=c):I.er=h,p=0,(d=o-u)>0)for(p+=m.cCb,e=V(s,m.lq);e<d&&p<S;e++)p+=m.Sl(e);return p<(g=V(0,S))?(I.pKc=g-p,I.jr=p,g=p):I.jr=g,I.lt=I.pt+h,I.ot=I.qt+g,A?(I.$Lc=I.pt+I.er,I.lt+=I.sKc):I.$Lc=I.lt+I.js,x?(I._Lc=I.qt+I.jr,I.ot+=I.pKc):I._Lc=I.ot+I.gs,I.Dt=I.zr,I.Et=I.y+I.height-I.Bt,I},t.prototype.am=function(){var t=this;return t._r||(t._r=t.At()),t._r},t.prototype.Hr=function(t,e){return T(e)||3===e||1===e?this.it(t):2===e?this.vt():G},t.prototype.vt=function(){var t=this;return t.bs.rowHeader||(t.bs.rowHeader=t.Ht()),t.bs.rowHeader},t.prototype.it=function(t){var e=this;return e.bs.viewport||(e.bs.viewport={}),e.bs.viewport[t]||(e.bs.viewport[t]=e.It(t)),e.bs.viewport[t]},t.prototype.Ht=function(){var t,e,o=new l.yp,n=this.am().zr,r=this.getColumnCount(2);for(e=0;e<r;e++)t=this.Tl(e,2),o.push(new l.zp(-1,e,n,-1,t,-1)),n+=t;return o},t.prototype.It=function(t){var e,o,n,r,i,a,s=this,u=new l.yp,c=s.am(),f=dt(s),h=s.ss,p=bt(s),d=mt(s);if(0===t)for(o=c.kt,f=_(p,f),e=0;e<f;e++)n=h._m(e),u.push(new l.zp(-1,e,o,-1,n,-1)),o+=n;else if(1===t)for(r=vt(s),i=s.eCb,o=c.pt+i,f=r?f-d:f+d,a=s.rKc(c)-i,e=V(p,s.qq);a>0&&e<f;e++)n=h._m(e),u.push(new l.zp(-1,e,o,-1,n,-1)),o+=n,a-=n;else if(2===t)for(o=c.lt,e=V(p,f-d);e<f;e++)n=h._m(e),u.push(new l.zp(-1,e,o,-1,n,-1)),o+=n;return u},t.prototype.Gr=function(t,e){return T(e)||3===e||2===e?this.jt(t):1===e?this.ut():G},t.prototype.Jt=function(t){var e,o,n=new l.yp;for(e=0;e<3;e++)(o=this.Gr(e,t))&&o.length>0&&(n=u.GC$.merge(n,o));return n},t.prototype.Kt=function(t){var e,o,n=new l.yp;for(e=0;e<3;e++)(o=this.Hr(e,t))&&o.length>0&&(n=u.GC$.merge(n,o));return n},t.prototype.ut=function(){var t=this;return t.as.colHeader||(t.as.colHeader=t.Lt()),t.as.colHeader},t.prototype.jt=function(t){var e=this;return e.as.viewport||(e.as.viewport={}),e.as.viewport[t]||(e.as.viewport[t]=e.Mt(t)),e.as.viewport[t]},t.prototype.Lt=function(){var t,e,o=new l.yp,n=this.am().Ar,r=this.getRowCount(1);for(e=0;e<r;e++)t=this.Sl(e,1),o.push(new l.zp(e,-1,-1,n,-1,t)),n+=t;return o},t.prototype.Mt=function(t){var e,o,n,r,i,a,s=this,u=new l.yp,c=wt(s),f=yt(s),h=s.am(),p=gt(s),d=s.ss;if(0===t)for(o=h.nt,p=_(c,p),e=0;e<p;e++)n=d.Sl(e),u.push(new l.zp(e,-1,-1,o,-1,n)),o+=n;else if(1===t)for(r=Ct(s),i=s.cCb,o=h.qt+i,p=r?p-f:p+f,a=s.oKc(h)-i,e=V(c,s.lq);a>0&&e<p;e++)n=d.Sl(e),u.push(new l.zp(e,-1,-1,o,-1,n)),o+=n,a-=n;else if(2===t)for(o=h.ot,e=V(c,p-f);e<p;e++)n=d.Sl(e),u.push(new l.zp(e,-1,-1,o,-1,n)),o+=n;return u},t.prototype.Ir=function(t,e,o,n){var i,a,s,u,c,f,h=this,p=h.getRowCount(o),d=h.getColumnCount(o),g=h.Gr(t,o),m=h.Hr(e,o),y=new l.yp;return g&&g.length>0&&m&&m.length>0&&(i=g[0].row,a=m[0].col,s=g[g.length-1].row,u=m[m.length-1].col,c=h.ITa.getSpans(r.kf(i,a,s-i+1,u-a+1),o),n&&h.mJb&&(f=h.mJb.nJb(o),c=c.concat(f)),c.length>0&&h.Nt(c,i,a,s,u,y,p,d,o,g,m)),y},t.prototype.rr=function(t,e,o,n,r){var i,a,s,u,c=this,f=c.getRowCount(o),h=c.getColumnCount(o),p=c.Gr(t,o),d=c.Hr(e,o),g=new l.yp;return p&&p.length>0&&d&&d.length>0?(i=p[0].row,a=d[0].col,(s=c.getSpan(n,r,o))&&((u=[]).push(s),c.Nt(u,i,a,s.row+s.rowCount,s.col+s.colCount,g,f,h,o,p,d)),g.length>0?g[0]:G):G},t.prototype.Nt=function(t,e,o,n,r,i,a,s,u,c,f){var h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D=t.length;if(!(D<=0)){for(h=this,d=n+1,g=r+1,m=[],y=[],C=[],v=[],b=0,w=0,p=e-1;p>=0;p--)m[p]=h.Sl(p,u),w-=m[p],v[p]=w;for(w=0,p=e;p<d;p++)v[p]=w,m[p]=h.Sl(p,u),w+=m[p];for(p=o-1;p>=0;p--)y[p]=h.Tl(p,u),b-=y[p],C[p]=b;for(b=0,p=o;p<g;p++)C[p]=b,y[p]=h.Tl(p,u),b+=y[p];for(T=0;T<D;T++)if((S=t[T]).intersect(e,o,n-e+1,r-o+1)){if((x=S.row+S.rowCount)>d){for(p=d;p<x;p++)m.push(h.Sl(p,u)),v.push(v[p-1]+m[p]);d=x}if((A=S.col+S.colCount)>g){for(p=g;p<A;p++)y.push(h.Tl(p,u)),C.push(C[p-1]+y[p]);g=A}for(I=C[S.col],R=v[S.row],M=0,k=0,N=void 0,O=void 0,O=S.col;O<S.col+S.colCount&&O<s;O++)M+=y[O];for(N=S.row;N<S.row+S.rowCount&&N<a;N++)k+=m[N];i.push(new l.zp(S.row,S.col,f[0].x+I,c[0].y+R,M,k,S.rowCount,S.colCount,S.isAutoMerge))}}},t.prototype.qs=function(){var t,e,o=this,n=o.parent,r=o.Ot(o.qq),i=o.eCb;-1!==r&&r!==o.qq&&(o.qq=r),(t=n&&n.kKc)&&(e=t.QB===p.ScrollType.pixels?o.jgc(r)-i:o.Qt(r),t.value(e))},t.prototype.os=function(){var t,e,o=this,n=o.parent,r=o.Rt(o.lq),i=o.cCb;-1!==r&&r!==o.lq&&(o.lq=r),(t=n&&n.nKc)&&(e=t.QB===p.ScrollType.pixels?o.kgc(r)-i:o.Tt(r),t.value(e))},t.prototype.ds=function(){var t,e=this,o=e.parent;o&&o.kKc&&(t=o.options.scrollByPixel,o.kKc.QB=t?p.ScrollType.pixels:p.ScrollType.continuous),o&&o.Ut&&(o.options.scrollbarAppearance===p.ScrollbarAppearance.mobile&&o.hec(),o.options.scrollIgnoreHidden&&(e.Vt=e.Wt(!0)),o.Ut())},t.prototype.es=function(){var t,e=this,o=e.parent;o&&o.nKc&&(t=o.options.scrollByPixel,o.nKc.QB=t?p.ScrollType.pixels:p.ScrollType.continuous),o&&o.Xt&&(o.options.scrollbarAppearance===p.ScrollbarAppearance.mobile&&o.hec(),o.options.scrollIgnoreHidden&&(e.Yt=e.Zt(!0)),o.Xt())},t.prototype.$t=function(){var t=this,e=bt(t);return e>0?t.Zq(e-1):t.$q()},t.prototype._t=function(){var t=this,e=wt(t);return e>0?t._q(e-1):t.ar()},t.prototype.$q=function(t){return this.Zq(-1,t)},t.prototype.Zq=function(t,e,o){for(var n=this,r=n.getColumnCount(e),i=o?r-1:r-1-mt(n);t<i;)if(t++,n.getColumnVisible(t,e)&&n.Tl(t,e)>0)return t;return G},t.prototype.br=function(t,e,o){for(var n=this,r=o?0:bt(n);t>r;)if(t--,n.getColumnVisible(t,e)&&n.Tl(t,e)>0)return t;return G},t.prototype.ar=function(t){return this._q(-1,t)},t.prototype._q=function(t,e,o){for(var n=this,r=n.getRowCount(e),i=o?r-1:r-1-yt(n);t<i;)if(t++,n.getRowVisible(t,e)&&n.Sl(t,e)>0)return t;return G},t.prototype.gr=function(t,e,o){for(var n=this,r=o?0:wt(n);t>r;)if(t--,n.getRowVisible(t,e)&&n.Sl(t,e)>0)return t;return G},t.prototype.au=function(){this.jq=!0,this.os()},t.prototype.bu=function(){this.oq=!0,this.qs()},t.prototype.kgc=function(t){var e,o=this,n=wt(o),r=n+(gt(o)-yt(o)-n)-1,i=0;if(t<=n)return i;for(t>r&&(t=r),e=n;e<t;e++)i+=o.Sl(e);return i},t.prototype.jgc=function(t){var e,o=this,n=bt(o),r=n+(dt(o)-mt(o)-n)-1,i=0;if(t<=n)return i;for(t>r&&(t=r),e=n;e<t;e++)i+=o.Tl(e);return i},t.prototype.Tt=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Zt().visibleIndex[t]:t},t.prototype.cu=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Zt().originalIndex[t]:t},t.prototype.Qt=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Wt().visibleIndex[t]:t},t.prototype.du=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Wt().originalIndex[t]:t},t.prototype.Wt=function(t){var e,o,n,r,i,a,s,l=this;if(l.Vt&&!t)return l.Vt;if(n=(o=e=bt(l))+(dt(l)-mt(l)-e)-1,r=l.ss,i={visibleIndex:{},originalIndex:{}},n-o+1<=0)return i;for(a=0,s=o;s<=n;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,r._m(s)>0&&a++;for(s--,a--;r._m(s)<=0&&s>=o;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},t.prototype.Zt=function(t){var e,o,n,r,i,a,s,l=this;if(l.Yt&&!t)return l.Yt;if(n=(o=e=wt(l))+(gt(l)-yt(l)-e)-1,r=l.ss,i={visibleIndex:{},originalIndex:{}},n-o+1<=0)return i;for(a=0,s=o;s<=n;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,r.Sl(s)>0&&a++;for(s--,a--;r.Sl(s)<=0&&s>=o;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},t.prototype.Rt=function(t,e){var o,n=this,r=wt(n),i=gt(n)-yt(n)-1;if(e){if(t>i&&(t=i),(o=n.gr(t+1))!==G&&o>=r)return o}else if(t<r&&(t=r),(o=n._q(t-1))!==G&&o<=i)return o;return-1},t.prototype.Ot=function(t,e){var o,n=this,r=bt(n),i=dt(n)-mt(n)-1;if(e){if(t>i&&(t=i),(o=n.br(t+1))!==G&&o>=r)return o}else if(t<r&&(t=r),(o=n.Zq(t-1))!==G&&o<=i)return o;return-1},t.prototype.eu=function(t,e,o){var n,r,i,a,s;if(o<e)return o;for(n=0,r=this.ss,i=o,a=o;a>=e;a--)if(!((s=r.Sl(a))<=0)){if((n+=s)>t)break;i=a}return i},t.prototype.LHb=function(t,e,o){var n,r,i=0,a=o,s=0;for(n=o;n>=e;n--)if(!((r=this.Sl(n))<=0)&&(a=n,(i+=r)>=t)){s=t-i;break}return{cj:a,UP:s}},t.prototype.fu=function(t,e,o){var n,r,i,a,s;if(o<e)return o;for(n=0,r=this.ss,i=o,a=o;a>=e;a--)if(!((s=r._m(a))<=0)){if((n+=s)>t)break;i=a}return i},t.prototype.MHb=function(t,e,o){var n,r,i=0,a=o,s=0;for(n=o;n>=e;n--)if(!((r=this.Tl(n))<=0)&&(a=n,(i+=r)>=t)){s=t-i;break}return{dj:a,UP:s}},t.prototype.gu=function(){var t,e,o,n=this,r=n.am(),i=n.Hr(1,3),a=0,s=0;if(i)for(t=0;t<i.length;t++)a+=e=i[t].width,e>0&&s++;return 0===(o=a/(s=0===s?1:s))?1:H(n.rKc(r)/o)},t.prototype.hu=function(){var t,e,o,n=this,r=n.am(),i=n.Gr(1,3),a=0,s=0;if(i)for(t=0;t<i.length;t++)a+=e=i[t].height,e>0&&s++;return 0===(o=a/(s=0===s?1:s))?1:H(n.oKc(r)/o)},t.prototype.ns=function(t){var e,o,n,r,i,a,s;return T(t)&&(t=3),o=(e=this).parent,n=wt(e),r=yt(e),o&&o.options.scrollbarMaxAlign?(i=e.am(),e.eu(e.oKc(i),n,gt(e)-r-1)):(a=e.getRowCount(t),3!==t&&2!==t||(a-=r),(s=e.gr(a,t))===G&&(s=n),s)},t.prototype.ps=function(t){var e,o,n,r,i,a;return T(t)&&(t=3),o=(e=this).parent,n=bt(e),o&&o.options.scrollbarMaxAlign?(r=e.am(),e.fu(e.rKc(r),n,dt(e)-mt(e)-1)):(i=e.getColumnCount(t),3!==t&&1!==t||(i-=mt(e)),(a=e.br(i,t))===G&&(a=n),a)},t.prototype.iu=function(){var e,o,n,r,i=this,a=wt(i),s=bt(i),l=gt(i)-yt(i)-1,u=dt(i)-mt(i)-1,c=i.ITa,f=c.getLastNonNullRow(3);return f>a&&(a=f),(e=c.getLastNonNullCol(3))>s&&(s=e),(o=c.getLastNonNullRow(2))>a&&(a=o),(n=c.getLastNonNullCol(1))>s&&(s=n),(r=t._n)&&R(r,(function(t,e){var o,n=e.lastNonNullRowAndCol;n&&(o=n.call(i),a=V(a,o.lastNonNullRow),s=V(s,o.lastNonNullCol))})),a>l&&(a=l),s>u&&(s=u),{lastNonNullRow:a,lastNonNullCol:s}},t.prototype.getLastNonNullRow=function(){return this.iu().lastNonNullRow},t.prototype.getLastNonNullColumn=function(){return this.iu().lastNonNullCol},t.prototype.mq=function(t,e,o){var n,r=this,i=r.lq,a=r.cCb,s=r.ns(),l=!T(o);i>=r.getRowCount()&&t>s&&(t=s),t>=r._t()&&t<=s&&(l||t!==i||e!==a)&&((n=r.parent)&&(n.ku&&n.ku.ju(r,t,e||0,o),r.os()),n&&!n.options.scrollbarShowMax&&r.es())},t.prototype.rq=function(t,e,o){var n,r=this,i=r.qq,a=r.eCb,s=r.ps(),l=!T(o);i>=r.getColumnCount()&&t>s&&(t=s),t>=r.$t()&&t<=s&&(l||t!==i||e!==a)&&((n=r.parent)&&(n.ku&&n.ku.lu(r,t,e||0,o),r.qs()),n&&!n.options.scrollbarShowMax&&r.ds())},t.prototype.yr=function(t,e,o){var n,r,i,a,s,l,u,c=this,f=t.row,h=t.col,p=t.hitTestType;return T(f)||T(h)?G:((n=c.getSpan(f,h,p))&&(f=n.row,h=n.col),c.mJb&&((r=c.mJb.oJb(f,h,p))&&(f=r.row,h=r.col)),i=c.AHb(f,h,p),a=1===p?-1:B,s=2===p?-1:B,l=c.getCellRect(f,h,a,s,!0),u={sheet:c,row:f,col:h,sheetArea:p},(i.cellType||c.Al(p)).h5(e,o,i,l,u))},t.prototype.mu=function(){this.unbindAll(),this.nu()},t.prototype.ou=function(t,e){var o,n,r,i,a,s,l,u=this.Tq(t),c=u.row,f=u.col,h=c+u.rowCount,p=f+u.colCount;for(n=c;n<h;n++)for(r=f;r<p;r++)if(a=(i=this.getSpan(n,r))?i.row:n,s=i?i.col:r,o=this.getActualStyle(a,s),l=e&&this.Ps(n),!0===o.locked&&!l)return!0;return!1},t.prototype.pu=function(t,e,o,n,r,i){if(-1<=t&&t<r&&-1<=e&&e<i){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==n&&e+n<=i)return!0}else if(-1===e){if(0!==o&&t+o<=r)return!0}else if(0!==n&&e+n<=i&&0!==o&&t+o<=r)return!0}return!1},t.prototype.qu=function(t,e,o,n){var r,i,a,s=this;return!(t<0&&e<0)&&(t<0&&((r=s.ITa.zl(1))&&r.spans&&r.spans.length>0)?s.ITa.qu(-1,e,-1,n,1):e<0&&((i=s.ITa.zl(2))&&i.spans&&i.spans.length>0)?s.ITa.qu(t,-1,o,-1,2):!!((a=s.ITa.zl(3))&&a.spans&&a.spans.length>0)&&s.ITa.qu(t,e,o,n,3))},t.prototype.suspendPaint=function(){var e=this,o=e.Xq;e.Xq++,0===o&&t.ao(e,Q,{suspend:!0})},t.prototype.resumePaint=function(){var e=this;e.Xq--,e.Xq<=0&&(e.Xq=0,t.ao(e,Q,{suspend:!1}),e.cMc()&&e.$p())},t.prototype.cMc=function(){var t=this.parent;return!t||t.getActiveSheet()===this},t.prototype.isPaintSuspended=function(){return this.Xq>0},t.prototype.su=function(t,e){var o,n,r=t&&t.length;for(o=0;o<r;o++)if(n=t[o],e.intersect(n.row,n.col,n.rowCount,n.colCount))return t.splice(o,1),this.su(t,e.union(n));return e},t.prototype.getClipboardHelperObj=function(){var t=this.tu();return{isCutting:t.G4,ranges:t.n5,showInsertCopyPasteCells:t.UHb}},t.prototype.tu=function(){var t=this,e=t.parent;return t.uu||(t.uu=e&&e.uu),t.uu},t.prototype.vu=function(){if(!this.bt){var t=this;t.bt=new i.oo((function(){t.bt&&(t.parent&&t.parent.fgc&&t.parent.fgc.endingCallback||t.repaint())}))}return this.bt},t.prototype.wu=function(){var t=this.parent;if(t)return t.commandManager()},t.prototype.Os=function(t,e){this.Wq(r.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:t,message:e})},t.prototype.Bq=function(t,e,o,n,i,a){var s;0===this.jm&&(s={sheet:this,sheetName:this.name(),row:e,col:o,sheetArea:n,propertyName:t,oldValue:i,newValue:a,isUndo:this.OIb},this.Wq(r.Events.CellChanged,s),this.ITa.ZVa(["cellChanged",t,e,o,n,a,i]))},t.prototype.xu=function(t,e,o,n){this.Wq(r.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:e,oldValue:o,newValue:n})},t.prototype.qCb=function(t,e,o,n,i){var a;if(0===this.jm){if(a={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:o,newValue:n,oldValue:i,cancel:!1},"addColumns"!==o&&"deleteColums"!==o||(a.count=n),this.Wq(r.Events.ColumnChanging,a),!0===a.cancel)return!1;this.ITa.ZVa(["columnChanging",t,e,o,i,n])}return!0},t.prototype.pq=function(t,e,o,n,i){var a;0===this.jm?(a={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:o,newValue:n,oldValue:i,isUndo:this.OIb},"addColumns"!==o&&"deleteColumns"!==o||(a.count=n),this.Wq(r.Events.ColumnChanged,a),this.ITa.ZVa(["columnChanged",t,e,o,i,n])):this.WXc(this,[{col:t}],1)},t.prototype.RIb=function(t,e,o,n){var i,a,s,l=[];if(this.tables){for(i=this.tables.pJb(t,e,o,n),a=0;a<i.length;a++)l.push(i[a].name());l.length>0&&(s={isUndo:this.OIb,sheet:this,sheetName:this.name(),row:t,col:o,rowCount:e,colCount:n,tableNames:l,action:2},this.Wq(r.Events.RangeChanged,s),this.ITa.ZVa(["rangeChanged",t,e,o,n]))}},t.prototype.pCb=function(t,e,o,n,i){var a;if(0===this.jm){if(a={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:o,newValue:n,oldValue:i,cancel:!1},"addRows"!==o&&"deleteRows"!==o||(a.count=n),this.Wq(r.Events.RowChanging,a),!0===a.cancel)return!1;this.ITa.ZVa(["rowChanging",t,e,o,i,n])}return!0},t.prototype.kq=function(t,e,o,n,i){var a;0===this.jm?(a={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:o,newValue:n,oldValue:i,isUndo:this.OIb},"addRows"!==o&&"deleteRows"!==o||(a.count=n),this.Wq(r.Events.RowChanged,a),this.ITa.ZVa(["rowChanged",t,e,o,i,n])):this.WXc(this,[{row:t}],2)},t.prototype.gyb=function(t,e){e!==t&&(this.Wq(r.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:e}),this.Wq(r.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:e}))},t.prototype.yu=function(t,e){return!(this.n_a||!this.mm.zu(t,e)||(this.Wq(r.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:e}),0))},t.prototype.Au=function(t){this.Wq(r.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections()})},t.prototype.Bu=function(t,e,o,n,i,a,s,l,u,c){var f={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:o,colCount:n,changedCells:i,action:a},h={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:o,colCount:n,changedCells:i,isUndo:!!c,action:a};s&&(f.sheetArea=s,h.sheetArea=s),l&&(f.value=l),i&&i.length>0&&(u&&u.length>0&&(h.tableNames=u),this.Wq(r.Events.RangeChanged,h),this.Wq(r.Events.FormulatextboxRangeChanged,f))},t.prototype.Cu=function(t,e){var o={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:e};this.Wq(r.Events.EditorStatusChanged,o)},t.prototype.Du=function(){return this.b4||(this.b4=u.GC$(S("input"))),this.b4},t.prototype.KLc=function(){return this.parent&&this.parent.options.pasteSkipInvisibleRange},t.prototype.MLc=function(t,e,o){var n,r=this,i=0,a=r.getColumnWidth,s=r.getColumnCount();for(o&&(a=r.getRowHeight,s=r.getRowCount()),n=t=t<0?0:t;n<t+e;n++)n<s&&0===a.call(r,n)&&(i++,e++);return i},t.prototype.OLc=function(t,e,o){var n,r=this,i=0,a=r.getColumnWidth;for(o&&(a=r.getRowHeight),n=t=t<0?0:t;n>t-e&&n>0;n--)0===a.call(r,n)&&(i++,e++);return i},t.prototype.NLc=function(t,e,o){var n,r=this,i=0,a=r.getColumnWidth;for(o&&(a=r.getRowHeight),n=t=t<0?0:t;n<t+e;n++)0===a.call(r,n)&&i++;return i},t.prototype.bind=function(t,e,o){this.Du().bind(t+ot,e,o)},t.prototype.unbind=function(t,e){this.Du().unbind(t+ot,e)},t.prototype.Wq=function(t,e,o){this.updateEventsData&&this.updateEventsData(t,e),(0===this.jm||o)&&this.Du().trigger(t,e)},t.prototype.unbindAll=function(){this.unbind(ot)},t.prototype.Fu=function(t,e,o){t.indexOf(".")>=0?this.bind(t,e,o):this.bind(t+nt,e,o)},t.prototype.Gu=function(t,e){t.indexOf(".")>=0?this.unbind(t,e):this.unbind(t+nt,e)},t.prototype.nu=function(){this.unbind(nt)},t.prototype.Dr=function(){var t=this.Zs;return new r.Rect(t.x,t.y,t.width,t.height)},t.prototype.Us=function(t){this.Zs=new r.Rect(t.x,t.y,t.width,t.height)},t.prototype.scroll=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p=this,d=p.parent;d&&(n=(o=d.options).scrollByPixel,r=o.scrollPixel,i=d.ku,a=o.scrollbarShowMax,s=o.showHorizontalScrollbar,l=o.showVerticalScrollbar,0!==e&&(c=(u=i._Bb(p,Math.round(e)/r)).dj,f=n?u.UP:0,c===p.qq&&f===p.eCb||(i.lu(p,c,f),s&&(p.qs(),a||(p.oq=!0)))),0!==t&&(c=(h=i.aCb(p,Math.round(t)/r)).cj,f=n?h.UP:0,c===p.lq&&f===p.cCb||(i.ju(p,c,f),l&&(p.os(),a||(p.jq=!0)))))},t.prototype.isCtrlPressed=function(t){return this.mm&&this.mm.ctrl},t.prototype.deselectIgnoreSpan=function(){return!1},t.prototype.lKc=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,d,g,m,y,C,v=this,b=v.zoom(),w=e.newValue,S=e.oldValue,x=e.scrollEventType,A=t.options.scrollByPixel,I=t.options.scrollPixel;if(S=e.oldValue=T(S)?0:A?W(S):j(S+"",10),v.jq=!1,r=v._t(),i=v.ns(),a=t.options.scrollbarShowMax,s=0,A){for(l=(w=W(w))-S,x!==p.Nxb.thumbTrack&&((w=S+(l*=I*b))<0&&(w=0)),a||(v.jq=!0,x===p.Nxb.smallIncrement&&w===S?w+=I*b:e.ignoreUpdatePosition=!0),f=(c=u=v.frozenRowCount())+(v.getRowCount()-v.frozenTrailingRowCount()-u)-1,h=0,d=0,g=c;g<=f;g++)if((h+=d=v.Sl(g))>=w){s=h-w-d,o=g;break}T(o)&&(o=f,s=-v.Sl(f),w=h)}else o=j(w+"",10),o=v.cu(o),x===p.Nxb.largeDecrement||x===p.Nxb.smallDecrement?(x===p.Nxb.largeDecrement&&(o=v.Ew()),-1!==(n=v.Rt(o,!0))&&n!==o&&(o=n),a||(v.jq=!0,e.ignoreUpdatePosition=!0)):x!==p.Nxb.largeIncrement&&x!==p.Nxb.smallIncrement||(x===p.Nxb.largeIncrement&&((o=v.Fw())===v.lq&&o++),a||(v.jq=!0,x===p.Nxb.smallIncrement&&w===S&&o++),-1!==(n=v.Rt(o))&&n!==o&&(o=n)),o<r&&(o=r),o>i&&(o=i);m=A?W(w):v.Tt(o),e.newValue!==m&&(e.newValue=m),y=m,0!==(C=v.Sl(o))&&(y+=U(s)/C),e.newValueWithOffset=A?m:y,(S!==m||A)&&t.ku.Bw(v,o,s)},t.prototype.mKc=function(t){var e,o,n,r=this,i=t.nKc;i.QB===p.ScrollType.pixels||(e=r.cu(i.value()),o=r._t(),n=r.ns(),e<o?i.value(r.Tt(o)):e>n&&i.value(r.Tt(n))),t.xw(),t.options.scrollbarShowMax||(t.ku.scrolling?r.jq=!0:t.Xt())},t.prototype.iKc=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,d,g,m,y,C,v=this,b=v.zoom(),w=e.newValue,S=e.oldValue,x=e.scrollEventType,A=t.options.scrollByPixel,I=t.options.scrollPixel;if(S=e.oldValue=T(S)?0:A?W(S):j(S+"",10),v.oq=!1,r=v.$t(),i=v.ps(),a=t.options.scrollbarShowMax,s=0,A){for(l=(w=W(w))-S,x!==p.Nxb.thumbTrack&&((w=S+(l*=I*b))<0&&(w=0)),a||(v.oq=!0,x===p.Nxb.smallIncrement&&w===S?w+=I*b:e.ignoreUpdatePosition=!0),f=(c=u=v.frozenColumnCount())+(v.getColumnCount()-v.frozenTrailingColumnCount()-u)-1,h=0,d=0,g=c;g<=f;g++)if((h+=d=v.Tl(g))>=w){s=h-w-d,o=g;break}T(o)&&(o=f,s=-v.Tl(f),w=h)}else o=j(w+"",10),o=v.du(o),x===p.Nxb.largeDecrement||x===p.Nxb.smallDecrement?(x===p.Nxb.largeDecrement&&(o=v.zw()),-1!==(n=v.Ot(o,!0))&&n!==o&&(o=n),a||(v.oq=!0,e.ignoreUpdatePosition=!0)):x!==p.Nxb.largeIncrement&&x!==p.Nxb.smallIncrement||(x===p.Nxb.largeIncrement&&((o=v.Aw())===v.qq&&o++),a||(v.oq=!0,x===p.Nxb.smallIncrement&&w===S&&o++),-1!==(n=v.Ot(o))&&n!==o&&(o=n)),o<r&&(o=r),o>i&&(o=i);m=A?W(w):v.Qt(o),e.newValue!==m&&(e.newValue=m),y=m,0!==(C=v.Tl(o))&&(y+=U(s)/C),e.newValueWithOffset=A?m:y,(S!==m||A)&&t.ku.Bw(v,o,s,!0)},t.prototype.jKc=function(t){var e,o,n,r=this,i=t.kKc;r&&i&&(i.QB===p.ScrollType.pixels||(e=r.du(i.value()),o=r.$t(),n=r.ps(),e<o?i.value(r.Qt(o)):e>n&&i.value(r.Qt(n))),t.xw(),t.options.scrollbarShowMax||(t.ku.scrolling?r.oq=!0:t.Ut()))},t.prototype.Ut=function(t,e,o){var n,r,i,a,s,l,u,c,f,h=this,d=o&&o.QB===p.ScrollType.pixels,g=h.frozenColumnCount(),m=h.getColumnCount()-h.frozenTrailingColumnCount()-g,y=g,C=h.am(),v=h.rKc(C),b=0===m?y:y+m-1,w=h.qq,T=h.eCb,S=0;t?(d?(n=(r=h.MHb(v,y,b)).dj,S=r.UP):n=h.fu(v,y,b),b=n):d&&(S=-h.Tl(b)),e?d&&!t&&(S=-h.Tl(b)):(i=h.iu().lastNonNullCol,(a=h.fu(v,y,i))===y&&(++a>b&&(a=b)),b=w>a?w<b?w:b:a,S=T),w>b?(h.qq=b,h.eCb=d?S:0):w===b&&S>T&&(h.eCb=d?S:0),-1!==(s=h.Ot(h.qq))&&s!==h.qq&&(h.qq=s),o&&(l=0,u=0,c=0,f=0,d?(l=h.jgc(y),u=h.jgc(b)-S,c=v,f=h.jgc(h.qq)-h.eCb):(l=h.Qt(y),u=h.Qt(b),c=h.gu(),f=h.Qt(h.qq),c<1&&(c=1)),o.bw(l),o.cw(u),o.dw(c),o.ew(),o.value(f))},t.prototype.Xt=function(t,e,o){var n,r,i,a,s,l,u,c,f,h=this,d=o&&o.QB===p.ScrollType.pixels,g=h.frozenRowCount(),m=h.getRowCount()-h.frozenTrailingRowCount()-g,y=g,C=h.am(),v=0===m?y:y+m-1,b=h.lq,w=h.cCb,T=0,S=h.oKc(C);t?(d?(n=(r=h.LHb(S,y,v)).cj,T=r.UP):n=h.eu(S,y,v),v=n):d&&(T=-h.Sl(v)),e?d&&!t&&(T=-h.Sl(v)):(i=h.iu().lastNonNullRow,(a=h.eu(S,y,i))===y&&(++a>v&&(a=v)),v=b>a?b<v?b:v:a,T=w),b>v?(h.lq=v,h.cCb=d?T:0):b===v&&T>w&&(h.cCb=d?T:0),-1!==(s=h.Rt(h.lq))&&s!==h.lq&&(h.lq=s),o&&(l=0,u=0,c=0,f=0,d?(l=h.kgc(y),u=h.kgc(v)-T,c=S,f=h.kgc(h.lq)-h.cCb):(l=h.Tt(y),u=h.Tt(v),c=h.hu(),f=h.Tt(h.lq),c<1&&(c=1)),o.bw(l),o.cw(u),o.dw(c),o.ew(),o.value(f))},t.prototype.Av=function(){var t,e,o,n,r=this,i=r.getRowCount(),a=r.getColumnCount();for(t=0;t<i;t++)for(e=0;e<a;e++)(o=r.getValue(t,e))instanceof Date&&((n=r.getStyle(t,e))&&n.$o(o),r.Nq(t,e,n))},t.Np=1,t.Qp=lt,t.Rp=200,t.Sp=20,t.Tp=1,t.Vp=1,t}(),e.Worksheet=ut,r.Zn(ut),(ct=ut.prototype).visible=x("visible",!0,(function(t){var e,o=this,n=o.parent,r=n.sheets,i=r.length,a=u.GC$.inArray(o,r),s=n.getActiveSheetIndex();if(t)s<0?(n.dq(a,1),n.YJc&&n.YJc.gq<0&&(n.YJc.gq=a)):n.aq();else if(a===s){for(e=a+1;e<i&&!r[e].visible();)e++;if(e>=i)for(e=a-1;e>=0&&!r[e].visible();)e--;n.YJc&&e<n.YJc.gq&&(n.YJc.gq=e),e<0?(o.no(!1),n.eq=e,n.fq()):n.dq(e,1)}else n.aq()})),ct.frozenColumnCount=x("frozenColumnCount",0,(function(t){var e=this;e.qq<t?e.qq=t:""!==t&&0!==t&&null!==t||(e.qq=0),e.oq=!0,e.$p()}),(function(t){return t>=0})),ct.frozenRowCount=x("frozenRowCount",0,(function(t){var e=this;e.lq<t?e.lq=t:""!==t&&0!==t&&null!==t||(e.lq=0),e.jq=!0,e.$p()}),(function(t){return t>=0}))},"./dist/plugins/autoMerge/autoMerge.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function y(t,e,o){return o+"_"+t+"_"+e}function C(t,e,o){return e===t||(e===n.SheetArea.viewport?o&&t===n.SheetArea.rowHeader||!o&&t===n.SheetArea.colHeader:e===n.SheetArea.rowHeader?o&&t===n.SheetArea.viewport:e===n.SheetArea.colHeader&&!o&&t===n.SheetArea.viewport)}function v(t,e,o){t.clearSpan(e.row,e.col,e.rowCount,e.colCount,o)}function b(t,e,o,r){var i,a,s,u,c,d,g,m={},y=[],C=o.row,v=o.row+o.rowCount-1,b=o.col,T=o.col+o.colCount-1;for(i=b;i<=T;i++)if(t.getColumnVisible(i,r)&&!(t.getColumnWidth(i,r)<=0)){for(a=e===l.restricted&&i>b,s=void 0,u=C;u<=v;)if(!t.getRowVisible(u,r)||t.getRowHeight(u,r)<=0)u++;else{if((c=t._q(u,r,!0))===p||c>v)break;if(x(t,u,i,c,i,r)){if(a&&!w(t,m,u,i,c,i,r)){s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h),u=c;continue}g=c-u+1,s?s.rowCount+=g-1:s=n.kf(u,i,g,1)}else s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h);u=c}s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h)}return{cache:m,spans:y}}function w(t,e,o,n,r,i,a){var s=e[y(o,t.br(n,a,!0),a)];return s&&s.sheetArea===a&&s.row<=o&&r<=s.row+s.rowCount-1}function T(t,e,o,r){var i,a,s,u,c,d,g,m={},y=[],C=o.row,v=o.row+o.rowCount-1,b=o.col,w=o.col+o.colCount-1;for(i=C;i<=v;i++)if(t.getRowVisible(i,r)&&!(t.getRowHeight(i,r)<=0)){for(a=e===l.restricted&&i>C,s=void 0,u=b;u<=w;)if(!t.getColumnVisible(u,r)||t.getColumnWidth(u,r)<=0)u++;else{if((c=t.Zq(u,r,!0))===p||c>w)break;if(x(t,i,u,i,c,r)){if(a&&!S(t,m,i,u,i,c,r)){s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h),u=c;continue}g=c-u+1,s?s.colCount+=g-1:s=n.kf(i,u,1,g)}else s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h);u=c}s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h)}return{cache:m,spans:y}}function S(t,e,o,n,r,i,a){var s=e[y(t.gr(o,a,!0),n,a)];return s&&s.sheetArea===a&&s.col<=n&&i<=s.col+s.colCount-1}function x(t,e,o,n,r,i){var a=t.ITa,s=t.getText(e,o,i),l=t.getText(n,r,i),u="[object Object]";return""!==s&&""!==l&&s!==u&&l!==u&&s===l&&!a.findSpan(e,o,i)&&!a.findSpan(n,r,i)}function A(t,e,o,r){var i,a,s,l,u,c,h,d=b(t,e,o,r),g=d.cache,m=d.spans,C=o.row,v=o.row+o.rowCount-1,w=o.col,T=o.col+o.colCount-1;for(i=C;i<=v;i++)if(t.getRowVisible(i,r)&&!(t.getRowHeight(i,r)<=0))for(a=w;a<=T;a++)if(t.getColumnVisible(a,r)&&!(t.getColumnWidth(a,r)<=0)){if((s=t.Zq(a,r,!0))===p||s>T)break;x(t,i,a,i,s,r)&&(l=g[y(i,a,r)],u=g[y(i,s,r)],l&&u?l.row===i&&u.row===i&&l.rowCount===u.rowCount&&(l.colCount+=s-a,I(m,u),R(g,u,l)):l?1===l.rowCount&&(l.colCount+=s-a,R(g,new n.Range(i,s,1,1),l)):u?1===u.rowCount&&(u.col=a,u.colCount+=s-a,R(g,new n.Range(i,a,1,1),u)):(c=new n.Range(i,a,1,s-a+1),h=new f(c,r),m.push(h),R(g,c,h)))}return{cache:g,spans:m}}function I(t,e){var o,n;for(o=0;o<t.length;o++)if((n=t[o]).sheetArea===e.sheetArea&&n.equals(e)){t.splice(o,1);break}}function R(t,e,o){var n,r,i=o.sheetArea;for(n=0;n<e.rowCount;n++)for(r=0;r<e.colCount;r++)t[y(e.row+n,e.col+r,i)]=o}function M(t,e,o,r){var i,a,s,l,u,c,h,d=T(t,e,o,r),g=d.cache,m=d.spans,C=o.row,v=o.row+o.rowCount-1,b=o.col,w=o.col+o.colCount-1;for(i=b;i<=w;i++)if(t.getColumnVisible(i,r)&&!(t.getColumnWidth(i,r)<=0))for(a=C;a<=v;a++)if(t.getRowVisible(a,r)&&!(t.getRowHeight(a,r)<=0)){if((s=t._q(a,r,!0))===p||s>v)break;x(t,a,i,s,i,r)&&(l=g[y(a,i,r)],u=g[y(s,i,r)],l&&u?l.col===i&&u.col===i&&l.colCount===u.colCount&&(l.rowCount+=s-a,I(m,u),R(g,u,l)):l?1===l.colCount&&(l.rowCount+=s-a,R(g,new n.Range(s,i,1,1),l)):u?1===u.colCount&&(u.row=a,u.rowCount+=s-a,R(g,new n.Range(a,i,1,1),u)):(c=new n.Range(a,i,s-a+1,1),h=new f(c,r),m.push(h),R(g,c,h)))}return{cache:g,spans:m}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/autoMerge/autoMerge.res.en.js"),e.SR={en:i},a=new r.Common.ResourceManager(e.SR,"AutoMerge"),s=a.getResource.bind(a),function(t){t[t.free=0]="free",t[t.restricted=1]="restricted"}(l=e.AutoMergeMode||(e.AutoMergeMode={})),function(t){t[t.none=0]="none",t[t.column=1]="column",t[t.row=2]="row",t[t.columnRow=3]="columnRow",t[t.rowColumn=4]="rowColumn"}(u=e.AutoMergeDirection||(e.AutoMergeDirection={})),function(t){t[t.source=0]="source",t[t.merged=1]="merged"}(c=e.SelectionMode||(e.SelectionMode={})),f=function(t){function e(e,o){var n=t.call(this,e.row,e.col,e.rowCount,e.colCount)||this;return n.sheetArea=o,n.isAutoMerge=!0,n}return m(e,t),e}(n.Range),h=void 0,p=null,d=function(){function t(t){this.kj=t,this.qJb=[],this.xn={},this.Ny=[]}return t.prototype.no=function(){this.kj=p},t.prototype.add=function(t,e,o,r,i){var a,l,u;for(void 0===r&&(r=n.SheetArea.viewport),void 0===i&&(i=c.source),a=0,l=this.all();a<l.length;a++)if((u=l[a]).sheetArea===r&&u.range.intersect(t.row,t.col,t.rowCount,t.colCount))throw Error(s().Exp_RangeIsIntersected);this.qJb.push({range:t,direction:e,mode:o,sheetArea:r,selectionMode:i})},t.prototype.remove=function(t,e){var o,r,i,a;for(void 0===e&&(e=n.SheetArea.viewport),o=this.qJb,r=this.kj.ITa,i=0;i<o.length;i++)if((a=o[i]).sheetArea===e&&a.range.equals(t)){v(r,t,e),o.splice(i,1);break}},t.prototype.clear=function(){var t,e,o=this.qJb,n=this.kj.ITa;for(t=0;t<o.length;t++)v(n,(e=o[t]).range,e.sheetArea);this.qJb=[],this.xn={},this.Ny=[]},t.prototype.all=function(){return this.qJb},t.prototype.mgc=function(t){return this.qJb.some((function(e){return e.range.containsRange(t)}))},t.prototype.RUa=function(t){this.qJb=t,this.rJb()},t.prototype.oJb=function(t,e,o){void 0===o&&(o=n.SheetArea.viewport);var r=this.xn[y(t,e,o)];return r?n.kf(r.row,r.col,r.rowCount,r.colCount):p},t.prototype.nJb=function(t){return void 0===t&&(t=n.SheetArea.viewport),this.Ny.filter((function(e){return e.sheetArea===t}))},t.prototype.rJb=function(){var t,e,o,r,i,a,s;for(this.xn={},this.Ny=[],t=this.qJb,e=this.kj,o=e.ITa,r=function(t){var r,a=t.direction,s=t.mode,l=t.sheetArea,f=function(t,e,o){var r,i,a,s,l,u,c,f,h,p;return o===n.SheetArea.viewport&&!t.options.allowCellOverflow&&(r=e.row,i=e.col,a=e.rowCount,s=e.colCount,l=t.frozenRowCount(),u=t.frozenColumnCount(),c=t.frozenTrailingRowCount(),f=t.frozenTrailingColumnCount(),h=t.getRowCount(),p=t.getColumnCount(),(0===l||-1!==r&&l<=r)&&(0===u||-1!==i&&u<=i)&&(0===c||-1!==r&&r+a<=h-c)&&(0===f||-1!==i&&i+s<=p-f))?((-1===i||0===i&&s===p)&&(i=t.getViewportLeftColumn(1),s=t.getViewportRightColumn(1)-i+1),(-1===r||0===r&&a===h)&&(r=t.getViewportTopRow(1),a=t.getViewportBottomRow(1)-r+1),n.kf(r,i,a,s)):t.Tq(e,o)}(e,t.range,l),h=t.selectionMode===c.merged;h&&v(o,f,l),r=void 0,a===u.column?r=b(e,s,f,l):a===u.row?r=T(e,s,f,l):a===u.columnRow?r=A(e,s,f,l):a===u.rowColumn&&(r=M(e,s,f,l)),r&&(n.GC$.extend(i.xn,r.cache),i.Ny=i.Ny.concat(r.spans),h&&r.spans.forEach((function(t){o.addSpan(t,l)})))},i=this,a=0,s=t;a<s.length;a++)r(s[a])},t.prototype.rI=function(t,e,o){var r,i,a,s,l;if(void 0===o&&(o=n.SheetArea.viewport),!(t<0||e<=0))for(r=0,i=this.qJb;r<i.length;r++)C((a=i[r]).sheetArea,o,!0)&&(t<=(l=(s=a.range).row)?s.row+=e:l<t&&t<l+s.rowCount&&(s.rowCount+=e))},t.prototype.tI=function(t,e,o){var r,i,a,s,l;if(void 0===o&&(o=n.SheetArea.viewport),!(t<0||e<=0))for(r=0,i=this.qJb;r<i.length;r++)C((a=i[r]).sheetArea,o,!1)&&(t<=(l=(s=a.range).col)?s.col+=e:l<t&&t<l+s.colCount&&(s.colCount+=e))},t.prototype.GR=function(t,e,o){var r,i,a,s,l,u,c,f,h;if(void 0===o&&(o=n.SheetArea.viewport),!(t<0||e<=0)){for(r=this.qJb,i=[],a=0;a<r.length;a++)C((s=r[a]).sheetArea,o,!0)&&(u=(l=s.range).row,c=l.rowCount,t<u?((f=t+e-u)<=0?u-=e:(u-=f,l.rowCount-=f),u<0&&(l.rowCount+=u,u=0),l.row=u):u<=t&&t<u+c&&(l.rowCount-=Math.min(e,u+c-t)),0===l.rowCount&&i.push(a));for(h=i.length-1;h>=0;h--)r.splice(i[h],1)}},t.prototype.HR=function(t,e,o){var r,i,a,s,l,u,c,f,h;if(void 0===o&&(o=n.SheetArea.viewport),!(t<0||e<=0)){for(r=this.qJb,i=[],a=0;a<r.length;a++)C((s=r[a]).sheetArea,o,!1)&&(u=(l=s.range).col,c=l.colCount,t<u?((f=t+e-u)<=0?u-=e:(u-=f,l.colCount-=f),u<0&&(l.colCount+=u,u=0),l.col=u):u<=t&&t<u+c&&(l.colCount-=Math.min(e,u+c-t)),0===l.colCount&&i.push(a));for(h=i.length-1;h>=0;h--)r.splice(i[h],1)}},t.prototype.sJb=function(t,e){var o,r,i;for(void 0===e&&(e=n.SheetArea.viewport),r=(o=this.qJb).length-1;r>=0;r--)-1!==(i=o[r].range).row&&C(o[r].sheetArea,e,!0)&&(i.row>t-1?o.splice(r,1):i.row+i.rowCount-1>t-1&&(i.rowCount=t-1-i.row+1))},t.prototype.tJb=function(t,e){var o,r,i;for(void 0===e&&(e=n.SheetArea.viewport),r=(o=this.qJb).length-1;r>=0;r--)-1!==(i=o[r].range).col&&C(o[r].sheetArea,e,!1)&&(i.col>t-1?o.splice(r,1):i.col+i.colCount-1>t-1&&(i.colCount=t-1-i.col+1))},t.prototype.toJSON=function(){return this.qJb.map((function(t){var e=t.range;return{range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}}))},t.prototype.fromJSON=function(t){var e,o,r,i,a,s;if(t)for(e=this.qJb,o=0,r=t;o<r.length;o++)a=(i=r[o]).range,(s=i.selectionMode)===h&&(s=c.source),e.push({range:n.kf(a.row,a.col,a.rowCount,a.colCount),direction:i.direction,mode:i.mode,sheetArea:i.sheetArea,selectionMode:s})},t}(),n.GC$.extend(n.lUa.prototype,{uJb:function(){var t=this.zTa;t&&!t.vJb&&(t.vJb=this.mJb.all().map((function(t){var e=t.range;return{range:n.kf(e.row,e.col,e.rowCount,e.colCount),direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}})))},wJb:function(t){t&&this.mJb.RUa(t)},xJb:function(t,e){this.uJb(),this.mJb.rI(t,e)},yJb:function(t,e){this.uJb(),this.mJb.GR(t,e)},zJb:function(t,e){this.uJb(),this.mJb.tI(t,e)},AJb:function(t,e){this.uJb(),this.mJb.HR(t,e)},BJb:function(t,e){this.uJb(),this.mJb.sJb(t,e)},CJb:function(t,e){this.uJb(),this.mJb.tJb(t,e)}}),g="autoMerge",n.lUa.$n(g,{init:function(){this.mJb=new d(this.kj)},undo:function(t){var e=t.vJb;e&&this.wJb(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.mJb&&(e.mJb.no(),e.mJb=p)}}),n.Worksheet.$n(g,{init:function(){var t=this,e=t.mJb=t.ITa.mJb;t.unbind(n.Events.TopRowChanged+"."+g),t.unbind(n.Events.LeftColumnChanged+"."+g),t.bind(n.Events.TopRowChanged+"."+g,(function(){var o,r,i,a,s,l,u,c,f=e.all();if(f.length>0)for(o=t.frozenColumnCount(),r=t.getColumnCount()-t.frozenTrailingColumnCount()-1,i=0,a=f;i<a.length;i++)l=(s=a[i]).sheetArea,u=s.range,l===n.SheetArea.viewport?((-1===u.col||u.col<o)&&t.repaint(t.getRangeRect(1,0,u)),(-1===u.col||u.col<=r&&u.col+u.colCount>=o)&&t.repaint(t.getRangeRect(1,1,u)),(-1===u.col||u.col+u.colCount>r)&&t.repaint(t.getRangeRect(1,2,u))):l===n.SheetArea.rowHeader&&(c=t.am(),t.repaint(c.fm(1)))})),t.bind(n.Events.LeftColumnChanged+"."+g,(function(){var o,r,i,a,s,l,u,c,f=e.all();if(f.length>0)for(o=t.frozenRowCount(),r=t.getRowCount()-t.frozenTrailingRowCount()-1,i=0,a=f;i<a.length;i++)l=(s=a[i]).sheetArea,u=s.range,l===n.SheetArea.viewport?((-1===u.row||u.row<o)&&t.repaint(t.getRangeRect(0,1,u)),(-1===u.row||u.row<=r&&u.row+u.rowCount>=o)&&t.repaint(t.getRangeRect(1,1,u)),(-1===u.row||u.row+u.rowCount>r)&&t.repaint(t.getRangeRect(2,1,u))):l===n.SheetArea.colHeader&&(c=t.am(),t.repaint(c.gm(1)))}))},dispose:function(t){!1!==t.clearCache&&(this.mJb=p,this.unbind(n.Events.TopRowChanged+"."+g),this.unbind(n.Events.LeftColumnChanged+"."+g))},onLayoutChanged:function(t){var e=t.changeType,o=t.row,n=t.rowCount,r=t.col,i=t.colCount,a=t.sheetArea,s=this.ITa;"addRows"===e?s.xJb(o,n):"deleteRows"===e?s.yJb(o,n):"addColumns"===e?s.zJb(r,i):"deleteColumns"===e?s.AJb(r,i):"setRowCount"===e?s.BJb(n,a):"setColumnCount"===e&&s.CJb(i,a),"invalidateLayout"===e&&this.Xq<=0&&this.mJb.rJb()},toJson:function(t,e){var o,r,i;e&&e.ignoreStyle||(t.autoMergeRangeInfos=this.mJb.toJSON(),e&&e.includeAutoMergedCells&&((o=this.mJb.nJb(n.SheetArea.viewport)).length>0&&(t.spans?t.spans=t.spans.concat(o):t.spans=o),(r=this.mJb.nJb(n.SheetArea.rowHeader)).length>0&&(t.rowHeaderSpan?t.rowHeaderSpan=t.rowHeaderSpan.concat(r):t.rowHeaderSpan=r),(i=this.mJb.nJb(n.SheetArea.colHeader)).length>0&&(t.colHeaderSpan?t.colHeaderSpan=t.colHeaderSpan.concat(i):t.colHeaderSpan=i)))},fromJson:function(t,e,o){o&&o.ignoreStyle||this.mJb.fromJSON(t.autoMergeRangeInfos)}}),n.Workbook.$n(g,{onCultureChanged:function(){s()}}),n.GC$.extend(n.Worksheet.prototype,{autoMerge:function(t,e,o,r,i){void 0===e&&(e=u.column),void 0===o&&(o=l.free),void 0===r&&(r=n.SheetArea.viewport),void 0===i&&(i=c.source);var a=this.mJb;return 0===arguments.length?a.all():void(t&&(this.ITa.uJb(),e===u.none?a.remove(t,r):a.add(t,e,o,r,i),this.$p()))}})},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},"./dist/plugins/cellState/cellStateManager.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d=this&&this.__assign||function(){return d=Object.assign||function(t){var e,o,n,r;for(o=1,n=arguments.length;o<n;o++)for(r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},d.apply(this,arguments)},g=this&&this.__rest||function(t,e){var o,n,r={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&(r[o[n]]=t[o[n]]);return r};function m(t){var e=t.row,o=t.col,n=t.rowCount,i=t.colCount;return new r.Range(e,o,n,i)}function y(t){var e,o,n,r,i,a,s=[];for(o=0,n=t.length;o<n;o++)r=(e=t[o]).style,a={range:{row:(i=e.range).row,col:i.col,colCount:i.colCount,rowCount:i.rowCount},style:r.toJSON()},s.push(a);return s}function C(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g;for(s=0,l=e.length;s<l;s++)c=(u=(a=e[s]).range).row,f=u.col,h=u.rowCount,p=u.colCount,d=a.style,(g=new r.Style).fromJSON(d,o,n),i={style:g,range:new r.Range(c,f,h,p)},t.push(i)}function v(t,e,o){return o.contains(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=n.Common.j.Fa,a=r.GC$.extend,s=void 0,l="cellState",u=[r.CellStatesType.readonly,r.CellStatesType.invalid,r.CellStatesType.dirty,r.CellStatesType.selected,r.CellStatesType.active,r.CellStatesType.hover,r.CellStatesType.edit],c=function(){function t(t,e){this.kj=t,this.io=e,this.xn=[];for(var o=1;o<=3;o++)this.sCb(o)}return t.prototype.sCb=function(t){this.xn[t]=[]},t.prototype.tCb=function(t){return this.xn[t]},t.prototype.uCb=function(t,e){this.xn[e]=t},t.prototype.DJb=function(t,e){var o,n;for(o=0,n=t.length;o<n;o++)if(t[o].range.equals(e))return o;return-1},t.prototype.Fb=function(t,e){var o,n=this.tCb(e),r=this.DJb(n,t);r>-1&&(o=n[r],this.EJb(r,o.range,o.style,n),n.splice(r,1))},t.prototype.Sb=function(t,e,o){var n=this,r=n.tCb(o),i=n.DJb(r,t),a={range:t,style:e};n.vCb({index:i,cache:r,range:t,style:e}),-1===i?r.push(a):r[i]=a},t.prototype.zR=function(t){var e=this.tCb(t),o=this.io;return e.map((function(t){var e=t.range,n=t.style;return{range:m(e),style:n.clone(),state:o}}))},t.prototype.Gq=function(t,e,o){var n,r,i,a=this.tCb(o),s=[];for(r=a.length,i=0;i<r;i++)v(t,e,(n=a[i]).range)&&s.push(n);return s.length>0?s:null},t.prototype.FJb=function(t,e,o){var n,r,i=this.tCb(o);if(i&&i.length>0)for(n=0,r=i;n<r.length;n++)if(v(t,e,r[n].range))return!0;return!1},t.prototype.wCb=function(t,e,o,n,a,s){var l,u,c=this,f=c.kj,h=c.tCb(a);if(h&&0===h.length)return!1;if(c.io===r.CellStatesType.dirty&&(i(n)||(n&c.io)>0))return f.GJb(e,o,a);if(c.io===r.CellStatesType.selected&&(i(n)||(n&c.io)>0)){for(l=0,u=c.kj.getSelections();l<u.length;l++)if(v(e,o,u[l]))return!0;return!1}return c.io===r.CellStatesType.invalid?!(!f.isValid||!(i(n)||(n&c.io)>0)||f.isValid(e,o,f.getValue(e,o,a))):c.io===r.CellStatesType.readonly?s&&c.kj.options.isProtected:(c.io&t)>0},t.prototype.xCb=function(t,e){var o=this.tCb(e);this.yCb({cache:o,sheetArea:e,collection:this}),this.uCb(function(t,e,o){var n=[],r=t.getRowCount(3),i=t.getColumnCount(3);return e.forEach((function(e){n=n.concat(function(t,e,o,n,r,i){var a=t.v_a(o,n,r,i);return a.map((function(t){return{range:t,style:e}}))}(t,e.style,e.range,o,r,i))})),n}(this.kj,o,t),e)},t.prototype.toJSON=function(){var t,e,o={};for(e=0;e<=3;e++)(t=this.tCb(e))&&t.length>0&&(o[e]=y(t));return o},t.prototype.fromJSON=function(t,e,o){var n,r,i=this;for(i.xn=[],n=1;n<=3;n++)i.sCb(n);for(r in t)t.hasOwnProperty(r)&&C(i.tCb(r),t[r],e,o)},t.prototype.zCb=function(t){var e=g(t,[]);this.kj.ITa.ACb(d({type:"rangeChange"},e))},t.prototype.vCb=function(t){var e=t.index,o=t.cache,n=t.range,r=t.style,i=this.kj.ITa;-1!==e&&(r=o[e].style),i.ACb({type:"add",index:e,cache:o,range:n,style:r})},t.prototype.EJb=function(t,e,o,n){this.kj.ITa.ACb({type:"remove",index:t,range:e,style:o,cache:n})},t.prototype.yCb=function(t){var e=g(t,[]);this.kj.ITa.ACb(d({type:"clear"},e))},t.prototype.rI=function(t,e){var o,n,r=this;for(n=0;n<=3;n++)(o=r.tCb(n))&&o.length>0&&o.forEach((function(o){var n=o.range,i=n.row,a=n.rowCount;t<=i?(n.row=i+e,r.zCb({range:n,row:i})):i<t&&t<i+a&&(n.rowCount=n.rowCount+e,r.zCb({range:n,rowCount:a}))}))},t.prototype.GR=function(t,e){var o,n,r=this;for(n=0;n<=3;n++)(o=r.tCb(n))&&o.length>0&&o.forEach((function(o){var n,i=o.range,a=i.row,s=i.rowCount;t<a?((n=t+e-a)<=0?a-=e:(a-=n,i.rowCount-=n),a<0&&(i.rowCount=s+a,a=0),i.row=a,r.zCb({range:i,row:a,rowCount:s})):a<=t&&t<a+s&&(i.rowCount=i.rowCount-Math.min(e,a+s-t),r.zCb({range:i,rowCount:s}))}))},t.prototype.tI=function(t,e){var o,n,r=this;for(n=0;n<=3;n++)(o=r.tCb(n))&&o.length>0&&o.forEach((function(o){var n=o.range,i=n.col,a=n.colCount;t<=i?(n.col=i+e,r.zCb({range:n,col:i})):i<t&&t<i+n.colCount&&(n.colCount=a+e,r.zCb({range:n,colCount:a}))}))},t.prototype.HR=function(t,e){var o,n,r=this;for(n=0;n<=3;n++)(o=r.tCb(n))&&o.length>0&&o.forEach((function(o){var n,i=o.range,a=i.col,s=i.colCount;t<a?((n=t+e-a)<=0?a-=e:(a-=n,i.colCount-=n),a<0&&(i.colCount+=a,a=0),i.col=a,r.zCb({range:i,col:a,colCount:s})):a<=t&&t<a+s&&(i.colCount-=Math.min(e,a+s-t),r.zCb({range:i,colCount:s}))}))},t.prototype.BCb=function(){this.xn=[],this.kj=null},t}(),f=function(){function t(t){this.kj=t,this.CCb={}}return t.prototype.getCollection=function(t,e){var o=this;return!o.CCb[t]&&e&&(o.CCb[t]=new c(o.kj,t)),o.CCb[t]},t.prototype.hasIntersectInSeletionState=function(t,e,o,n){var i,a,s,l=this.CCb[r.CellStatesType.selected];if(l&&((i=l.tCb(r.SheetArea.viewport))&&i.length>0))for(a=0,s=i;a<s.length;a++)if(s[a].range.intersect(t,e,o,n))return!0;return!1},t.prototype.getState=function(t,e,o){return this.kj.ITa.XTa(o).getCellState(t,e)||0},t.prototype.remove=function(t,e,o){void 0===o&&(o=r.SheetArea.viewport),this.CCb[e].Fb(t,o)},t.prototype.all=function(t,e){var o,n;if(void 0===e&&(e=r.SheetArea.viewport),o=[],i(t))for(n in this.CCb)this.CCb.hasOwnProperty(n)&&(o=o.concat(this.CCb[n].zR(e)));else o=this.CCb[t].zR(e);return o},t.prototype.add=function(t,e,o,n){var a,l;if(r.CellStatesType[e]===s)throw Error("Unmatched Cell State Type");i(n)&&(n=3),this.getCollection(e,!0).Sb(m(t),o,n),a=this.kj,n===r.SheetArea.viewport?a.repaint(a.cm(t)):(l=a.am(),n===r.SheetArea.colHeader&&a.repaint(new r.Rect(l.pt,l.Ar,a.rKc(l),l.Cr)),n===r.SheetArea.rowHeader&&a.repaint(new r.Rect(l.zr,l.qt,l.Br,a.oKc(l))))},t.prototype.clear=function(t,e){this.DCb(t,e)},t.prototype.DCb=function(t,e){for(var o in this.CCb)this.CCb.hasOwnProperty(o)&&this.CCb[o].xCb(t,e)},t.prototype.HJb=function(t,e,o,n,r,i){var a=this.kj,s=this.CCb[t];s&&s.FJb(e,o,n)&&-1!==r&&-1!==i&&a.repaint(a.gCb(a,e,o,r,i))},t.prototype.getStyle=function(t,e,o,n,a){var l,c,f,h,p,d,g,m,y,C,v;if(i(o)&&(o=3),l=new r.Style,c=[],d=(p=this).kj.ITa.getSpan(t,e,o),i(d)||(t=d.row,e=d.col),(g=i(n)?p.getState(t,e,o):p.getState(t,e,o)&n)!==s&&null!==g){for(m=0,y=u;m<y.length;m++)C=y[m],(h=p.CCb[C])&&h.wCb(g,t,e,n,o,a)&&((f=h.Gq(t,e,o))&&f.length>0&&(c=c.concat(f)));if(c.length>0){for(v=c.length-1;v>=0;v--)l.Yo(c[v].style);return l}}return null},t.prototype.destory=function(){for(var t in this.CCb)this.CCb.hasOwnProperty(t)&&this.CCb[t].BCb();delete this.CCb,delete this.kj},t.prototype.toJSON=function(){var t,e,o={};for(e in this.CCb)this.CCb.hasOwnProperty(e)&&(t=this.CCb[e],o[e]=t.toJSON());return o},t.prototype.fromJSON=function(t,e,o){var n,r;for(n in t)t.hasOwnProperty(n)&&(r=parseInt(n,10),this.getCollection(r,!0).fromJSON(t[r],e,o))},t.prototype.rI=function(t,e){for(var o in this.CCb)this.CCb.hasOwnProperty(o)&&this.CCb[o].rI(t,e)},t.prototype.GR=function(t,e){for(var o in this.CCb)this.CCb.hasOwnProperty(o)&&this.CCb[o].GR(t,e)},t.prototype.tI=function(t,e){for(var o in this.CCb)this.CCb.hasOwnProperty(o)&&this.CCb[o].tI(t,e)},t.prototype.HR=function(t,e){for(var o in this.CCb)this.CCb.hasOwnProperty(o)&&this.CCb[o].HR(t,e)},t}(),e.CellStateManager=f,h={init:function(){this.cellStates=new f(this)},dispose:function(t){var e=this;e.cellStates&&!1!==t.clearCache&&(e.cellStates.destory(),e.cellStates=null)},onLayoutChanged:function(t){var e,o,n=t.changeType,i=t.row,a=t.rowCount,s=t.col,l=t.colCount,u=t.sheetArea,c=this.cellStates;if("addRows"===n)c.rI(i,a);else if("deleteRows"===n)c.GR(i,a);else if("addColumns"===n)c.tI(s,l);else if("deleteColumns"===n)c.HR(s,l);else if("clear"===n&&(3===u&&2==(2&t.type)&&c.DCb(new r.Range(i,s,a,l),u),3===u&&1==(1&t.type)))for(e=i;e<i+a;e++)for(o=s;o<s+l;o++)this.ITa.XTa(u).setCellState(e,o,r.CellStatesType.invalid,!1)},toJson:function(t,e){(!e||e&&!e.ignoreStyle)&&(t.cellStates=this.cellStates.toJSON())},fromJson:function(t,e,o){var n=this,r=o&&!o.ignoreStyle||!o;t&&t.cellStates&&r&&(n.cellStates=new f(n),n.cellStates.fromJSON(t.cellStates,e,o))}},p={xIb:function(t,e,o,n,r,i){n&&n<=3&&n>0&&this.cellStates.HJb(t,e,o,n,r,i)},GJb:function(t,e,o){var n=this.ITa.hUa(o);return n&&n[t]&&n[t][e]}},a(r.Worksheet.prototype,p),r.Worksheet.$n(l,h),a(r.lUa.prototype,{ACb:function(t){var e,o=this.zTa;o&&(e=void 0,(e=o.ECb?o.ECb:[]).push(t),o.ECb=e)},FCb:function(t){var e=this;t&&t.length>0&&t.forEach((function(t){var o=t.type,n=g(t,["type"]);switch(o){case"rangeChange":e.GCb(d({},n));break;case"add":e.HCb(d({},n));break;case"clear":e.ICb(d({},n));break;case"remove":e.IJb(d({},n))}}))},ICb:function(t){var e=t.cache,o=t.sheetArea;t.collection.uCb(e,o)},IJb:function(t){var e=t.cache,o=t.range,n=t.style,r=t.index;e.splice(r,0,{range:o,style:n})},HCb:function(t){var e,o=t.cache,n=t.range,r=t.style,i=t.index;-1===i?(o.forEach((function(t,o){var i=t.range,a=t.style;i===n&&a===r&&(e=o)})),o.splice(e,1)):o[i].style=r},GCb:function(t){var e=t.range,o=t.row,n=t.col,r=t.rowCount,i=t.colCount;o!==s&&(e.row=o),n!==s&&(e.col=n),r!==s&&(e.rowCount=r),i!==s&&(e.colCount=i)}}),r.lUa.$n(l,{undo:function(t){var e=t.ECb;e&&this.FCb(e)}})},"./dist/plugins/cellState/cellstate.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/cellState/cellStateManager.js")),n(o("./dist/plugins/cellState/stateManager.js"))},"./dist/plugins/cellState/stateManager.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c;Object.defineProperty(e,"__esModule",{value:!0}),r=o("Common"),i=o("Core"),a=r.Common.j.Fa,s=i.GC$.extend,(n={})[i.StatesType.hover]=function(t,e,o){return o?t===this.hCb:e===this.iCb},n[i.StatesType.active]=function(t,e,o){return o?t===this.Jl:e===this.Kl},n[i.StatesType.selected]=function(t,e,o){var n,r,i,a,s,l,u,c=this,f=!1;for(n=0,r=c.getSelections();n<r.length;n++)a=-1===(i=r[n]).row?0:i.row,s=-1===i.rowCount?c.getRowCount():i.rowCount,l=-1===i.col?0:i.col,u=-1===i.colCount?c.getColumnCount():i.colCount,(o&&t>=a&&t<a+s||!o&&e>=l&&e<l+u)&&(f=!0);return f},n[i.StatesType.readonly]=function(t,e,o){var n;return!(o&&a(t)||!o&&a(e))&&(this,!!this.options.isProtected&&(o?e=-1:t=-1,void 0===(n=this.ITa.getStyle(t,e))||n.locked))},n[i.StatesType.edit]=function(t,e,o){var n=this;return!!n.isEditing()&&(o?t===n.Jl:e===n.Kl)},n[i.StatesType.invalid]=function(t,e,o){var n,r,a,s,l,u=this,c=t,f=e;for(o?e=-1:t=-1,n=0,r=u.dMc(t,e);n<r.length;n++)if(c=-1===(s=(a=r[n]).l1()[0]).row?c:s.row,f=-1===s.col?f:s.col,l=u.getValue(c,f,i.SheetArea.viewport),!a.isValid(u,t,e,l))return!0;return!1},n[i.StatesType.dirty]=function(t,e,o){var n,r,i=this.ITa.hUa();if(i){if(o)return i[t];for(n=0,r=Object.keys(i);n<r.length;n++)if(i[r[n]][e])return!0;return!1}return!1},n[i.StatesType.inserted]=function(t){var e,o;for(e=0,o=this.getInsertRows();e<o.length;e++)if(o[e].row===t)return!0},n[i.StatesType.updated]=function(t){var e,o;for(e=0,o=this.getDirtyRows();e<o.length;e++)if(o[e].row===t)return!0},l=n,u=function(){function t(t){this.eMc={},this.getStateMethods={},this.context=t,s(this.getStateMethods,l)}return t.prototype.enableState=function(t,e){var o=this.eMc;a(o[t])&&(o[t]={row:!1,column:!1}),e?o[t].row=!0:o[t].column=!0},t.prototype.disableState=function(t,e){var o=this.eMc;a(o[t])||(e?o[t].row=!1:o[t].column=!1)},t.prototype.isEnable=function(t,e){var o=this.eMc;return!a(o[t])&&(e?o[t].row:o[t].column)},t.prototype.getState=function(t,e,o,n){var r=this.context,i=this.getStateMethods[o];if("function"==typeof i)return i.call(r,t,e,n)?o:0},t.prototype.destory=function(){delete this.context,delete this.eMc},t.prototype.fromJSON=function(t){this.eMc=s({},t)},t.prototype.toJSON=function(){return s({},this.eMc)},t}(),e.fMc=u,c={init:function(){this.QLc=new u(this)},dispose:function(t){var e=this;e.QLc&&!1!==t.clearCache&&(e.QLc.destory(),e.QLc=null)},toJson:function(t){t.states=this.QLc.toJSON()},fromJson:function(t){var e=this;t&&t.states&&(e.QLc=new u(e),e.QLc.fromJSON(t.states))}},i.Worksheet.$n("states",c)},"./dist/plugins/celltype/buttoncelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function b(t,e,o,n){var r,i=t.ITa;i&&(i.do("setValueForKey",e,o,d,p,n),(r=i.getValueForKey(e,o,g,n))&&(clearTimeout(r),i.do("setValueForKey",e,o,g,p,n)))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=r.Events.SelectionChanged,a=n.Common.j.Fa,s=r.Ul.nl,l=r.CellTypes.Context,u=r.CellTypes.Text,c=r.CellTypes.Base,f=r.GC$,h=f.each,p=void 0,d="_isFirstMouseUp",g="_mouseupToken",m=".buttonCellType",y={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:null,buttonState:0},C=function(t){function e(){var e,o=t.call(this)||this;return o.typeName="6",e=o,h(y,(function(t,o){e["_"+t]=o})),o}return v(e,t),e.prototype.paintValue=function(t,e,o,n,i,a,s,l){var c,f,h,p,d,g,m,y,C,v,b;t&&(f=(c=this)._marginLeft,h=c._marginTop,p=o+f,d=n+h,g=i-f-c._marginRight,m=a-h-c._marginBottom,g-2>0&&m-2>0&&(p+g>o&&p<o+i&&d+m>n&&d<n+a)&&(t.save(),(p<o||p+g>o+i||d<n||d+m>n+a)&&(t.rect(o,n,i,a),t.clip()),t.beginPath(),(y="#707070")&&t.strokeStyle!==y&&(t.strokeStyle=y),t.strokeRect(p+.5,d+.5,g-1,m-1),C=void 0,v=c._buttonState,b=c._text,2===v?C="#34B4E3":(C=c._buttonBackColor)||(C={degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]}),t.fillStyle!==C&&(t.fillStyle=C),r.To.setFillStyle(t,C,o,n,i,a,(function(){t.fillRect(p+1,d+1,g-2,m-2)})),t.restore(),b&&u.prototype.paintValue.call(c,t,b,p,d,g,m,s,l)))},e.prototype.getText=function(t,e){return t},e.prototype.tw=function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)},e.prototype.getHitInfo=function(t,e,o,n,r){var i,s,l,u,c,f,h=this;return r&&(i=r.sheetArea,(a(i)||3===i)&&n)?(s=n.x+h._marginLeft,l=n.x+n.width-h._marginRight,u=n.y+h._marginTop,c=n.y+n.height-h._marginBottom,f={x:t,y:e,row:r.row,col:r.col,cellRect:n,sheetArea:i,sheet:r.sheet,cellStyle:o},s<=t&&t<=l&&u<=e&&e<=c&&(f.isReservedLocation=!0),f):null},e.prototype.processMouseDown=function(t){var e=this,o=t&&t.sheet;return!(!o||!t.isReservedLocation||e.uK||(e.uK=!0,e._buttonState=2,o.repaint(t.cellRect),0))},e.prototype.processMouseUp=function(t){var e,o,n,r,i=this,a=t&&t.sheet;if(i.uK&&a&&t.isReservedLocation){if(i._buttonState=0,a.repaint(t.cellRect),i.uK=!1,e=t.row,o=t.col,n=t.sheetArea,!a.ITa.getValueForKey(e,o,d,n))return i.tw(a,e,o,n),a.ITa.do("setValueForKey",e,o,d,!0,n),r=setTimeout((function(){b(a,e,o,n)}),250),a.ITa.do("setValueForKey",e,o,g,r,n),!0;b(a,e,o,n)}return!1},e.prototype.processMouseLeave=function(t){var e=this,o=t&&t.sheet;o&&e.uK&&(e._buttonState=0,o.repaint(t.cellRect),e.uK=!1)},e.prototype.processKeyDown=function(t,e){var o,n=e.sheet,r=this;return!(!n||r.vK||(o=n.getCellRect(e.row,e.col),r._buttonState=2,n.repaint(o),n.Fu(i+m,(function(){n.Gu(i+m),r.vK=!1,r._buttonState=0,n.repaint(o)})),r.vK=!0,0))},e.prototype.processKeyUp=function(t,e){var o,n,r,a=e.sheet,s=this;return!(!a||!s.vK||(o=e.row,n=e.col,r=a.getCellRect(o,n),s._buttonState=0,a.repaint(r),a.Gu(i+m),s.tw(a,o,n,e.sheetArea),s.vK=!1,0))},e.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},e.prototype.getAutoFitWidth=function(t,e,o,n,r){var i=this;return l.cp(t,i._text,o,n,r)+i._marginLeft+i._marginRight},e.prototype.getAutoFitHeight=function(t,e,o,n,r){var i=this;return l.ep(t,i._text,o,n,r)+i._marginTop+i._marginBottom},e.prototype.JH=function(t){this.isReservedKey(t)&&s(t)},e.prototype.isImeAware=function(t){return!1},e.prototype.toJSON=function(){var t,e=this,o={typeName:e.typeName};return h(y,(function(n,r){"buttonState"!==n&&((t=e["_"+n])!==r&&(o[n]=t))})),o},e.prototype.fromJSON=function(t){var e=this;h(y,(function(o){var n=t[o];a(n)||(e["_"+o]=n)}))},e.prototype.a5=function(t){},e.prototype.gQa=function(){},e}(c),e.Button=C,h(y,(function(t){C.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[6]=C},"./dist/plugins/celltype/cellbuttons.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z;function U(t){switch(t){case F:return n.ButtonPosition.left;case E:return n.ButtonPosition.right;case j:return n.ButtonPosition.leftOfText;case P:return n.ButtonPosition.rightOfText}}function W(t){switch(t){case n.ButtonPosition.left:return F;case n.ButtonPosition.right:return E;case n.ButtonPosition.leftOfText:return j;case n.ButtonPosition.rightOfText:return P}}function q(t){var e,o,n=t.split(" ");for(o=0;o<n.length;o++)if(n[o].indexOf(M)>=0){e=n[o];break}switch(e){case k:return F;case N:return E;case O:return j;case D:return P}}function J(t){switch(t){case F:return k;case E:return N;case j:return O;case P:return D}}function X(t,e,o,n){var r,i=t.ITa;i&&(i.do("setValueForKey",e,o,y,l,n),(r=i.getValueForKey(e,o,C,n))&&(clearTimeout(r),i.do("setValueForKey",e,o,C,l,n)))}function Z(t,e,o){var r,i;switch(o){case H.topLeft:return new n.Rect(t.x,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.topCenter:return r=(t.width-e.width)/2,r=Math.max(0,r),new n.Rect(t.x+r,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.topRight:return r=t.width-e.width,r=Math.max(0,r),new n.Rect(t.x+r,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.MiddleLeft:return i=(t.height-e.height)/2,i=Math.max(0,i),new n.Rect(t.x,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.MiddleCenter:return r=(t.width-e.width)/2,r=Math.max(0,r),i=(t.height-e.height)/2,i=Math.max(0,i),new n.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.MiddleRight:return r=t.width-e.width,r=Math.max(0,r),i=(t.height-e.height)/2,i=Math.max(0,i),new n.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.bottomLeft:return i=t.height-e.height,i=Math.max(0,i),new n.Rect(t.x,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.bottomCenter:return r=(t.width-e.width)/2,r=Math.max(0,r),i=t.height-e.height,i=Math.max(0,i),new n.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case H.bottomRight:return r=t.width-e.width,r=Math.max(0,r),i=t.height-e.height,i=Math.max(0,i),new n.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height))}}function Y(t,e,o){var n,r=[];for(n=0;n<t.length;n++)r.push({width:ft(t[n].button,e,o),height:ht(t[n].button,o)});return r}function K(t,e,o,n,r,i){var s,l,u,c,f=[],h=[];for(s=0;s<t.length;s++)l=e[t[s].index],a(l)?h.push(t[s]):f.push(l);for(u=$(f),s=0;s<h.length;s++)c=ft(h[s].button,o,n),(!i||u.width+c<=i.width)&&(u.width+=c);return u.height=u.height?u.height:i?i.height:0,u}function Q(t,e,o,r,i,l,u,c,f,h,p,d){var g,m,y,C,v,b,w,T,S,x=pt(e,o,u,c,!0,[t]);if(x.length>0){switch(it(x,e,u),t){case n.ButtonPosition.left:g=k;break;case n.ButtonPosition.right:g=N;break;case n.ButtonPosition.leftOfText:g=O;break;case n.ButtonPosition.rightOfText:g=D;break;default:return}switch(m=K(x,h,i,r,0,l),y="0",C=s(),(n.Ul.Ml.mozilla||C>1)&&(y="1px"),v=m.width,b=m.height,w=W(t),a(f.canvasSizes)&&(f.canvasSizes={}),(T=f.canvasSizes)[w]={width:v,height:b},S=function(t,e,o,n){var r,i=document.createElement("canvas");for(r in i.className=t+" "+R,n)n.hasOwnProperty(r)&&(i.style[r]=n[r]);return i.width=e,i.height=o,i}(g,v,b,{width:v+"px",height:b+"px",display:"block",position:"absolute",bottom:y,overflow:"hidden",paddingTop:"0"}),t){case n.ButtonPosition.left:S.style.left="0";break;case n.ButtonPosition.right:S.style.right="0";break;case n.ButtonPosition.leftOfText:S.style.left=T[j].width+"px";break;case n.ButtonPosition.rightOfText:S.style.right=T[P].width+"px";break;default:return}p.appendChild(S)}}function $(t){var e,o,r,i,a;if(t.length<=0)return new n.Rect(0,0,0,0);for(e=t[0].x,o=t[0].y,r=t[0].x+t[0].width,i=t[0].y+t[0].height,a=1;a<t.length;a++)e=Math.min(e,t[a].x),o=Math.min(o,t[a].y),r=Math.max(r,t[a].x+t[a].width),i=Math.max(i,t[a].y+t[a].height);return new n.Rect(e,o,r-e,i-o)}function tt(t,e,o,r,i,s,l,u){var c,f,h,p,d,g;if(!a(t))for(a(u[o])&&(u[o]={}),it(e,r.sheet,r.row),c=t.getContext("2d"),f=K(e,l,i,r),c.setTransform(parseFloat(t.style.width)/f.width,0,0,parseFloat(t.style.height)/f.height,0,0),h=0,0,p=new n.Rect(0,0,parseFloat(t.style.width),parseFloat(t.style.height)),d=0;d<e.length&&(g=lt(c,h,0,ft(e[d].button,i,r),r.sheet.getRowHeight(r.row),e[d].button,i,r,s,u[o],e[d].index,p),!a(g));d++)h+=g.width}function et(t,e,o,r,i,s,l,u,c,f,h,p){var d,g,m,y,C,v,b,w=pt(e,o,l,u,!0,[t]);if(w.length>0){switch(d=void 0,g=void 0,t){case n.ButtonPosition.left:d=k,g=F;break;case n.ButtonPosition.right:d=N,g=E;break;case n.ButtonPosition.leftOfText:d=O,g=j;break;case n.ButtonPosition.rightOfText:d=D,g=P;break;default:return}if(m=p.querySelector("."+d),a(m))return;switch(y=parseFloat(m.style.width),C=s.options.contentRect,v=s.options.leftExternalRect,b=s.options.rightExternalRect,t){case n.ButtonPosition.left:C.x+=y,C.width-=y;break;case n.ButtonPosition.right:C.width-=y;break;case n.ButtonPosition.leftOfText:v.width+=y;break;case n.ButtonPosition.rightOfText:b.width+=y}tt(m,w,g,r,i,c,f,h),function(t,e,o,n,r,i){var s,l,u,c,f;a(i.eventListeners)&&(i.eventListeners={}),a(i.eventListeners[e])&&(i.eventListeners[e]={}),l=(s=i.eventListeners[e]).mouseDownListener=function(i){Ct(yt({x:i.offsetX,y:i.offsetY,context:o,cellRect:r,cellStyle:n,buttonArea:e},!0),!0,t)},t.addEventListener("mousedown",l),u=s.mouseUpListener=function(i){vt(yt({x:i.offsetX,y:i.offsetY,context:o,cellRect:r,cellStyle:n,buttonArea:e},!0),!0,t)},t.addEventListener("mouseup",u),c=s.mouseMoveListener=function(i){bt(yt({x:i.offsetX,y:i.offsetY,context:o,cellRect:r,cellStyle:n,buttonArea:e},!0),!0,t)},t.addEventListener("mousemove",c),f=s.mouseLeaveListener=function(i){var a={x:i.offsetX,y:i.offsetY,context:o,cellRect:r,cellStyle:n,buttonArea:e};a.x<0&&(a.x=0),a.x>=parseFloat(t.style.width)&&(a.x=parseFloat(t.style.width)-1),wt(yt(a,!0),!0,t)},t.addEventListener("mouseleave",f)}(m,g,r,i,s.options.cellRect,c)}}function ot(t,e,o,r,i,a,s){var l,u,c,f,h,p,d=pt(e,o,r,i,!0,[t]);if(d&&d.length>0)switch(l=W(t),u=a[l]&&a[l].width||0,c=s.contentContainer,f=s.contentRect,h=s.leftExternalRect,p=s.rightExternalRect,t){case n.ButtonPosition.left:nt(c,"left",u),f.x+=u,f.width-=u;break;case n.ButtonPosition.leftOfText:nt(c,"left",u),h.width+=u;break;case n.ButtonPosition.right:f.width-=u;break;case n.ButtonPosition.rightOfText:p.width+=u;break;default:return}}function nt(t,e,o){var n=0;t.style[e]&&(n=function(t){return+t.replace("px","")||0}(t.style[e])),n+=o,t.style[e]=n-1+"px"}function rt(t,e){a(e.mouseDownListener)||t.removeEventListener("mousedown",e.mouseDownListener),a(e.mouseUpListener)||t.removeEventListener("mouseup",e.mouseUpListener),a(e.mouseMoveListener)||t.removeEventListener("mousemove",e.mouseMoveListener),a(e.mouseLeaveListener)||t.removeEventListener("mouseleave",e.mouseLeaveListener)}function it(t,e,o){var n,r,i=e.vu();for(n=0;n<t.length;n++)(r=At(t[n].button,o))&&i.fo(r)}function at(t){var e=t.isPrinting,o=t.printZoomFactor;return e&&"number"==typeof o&&1!==o}function st(t,e,o,r,i,s,l){var u,c,f,h,p,d,g;if(t&&!(e.length<=0)){if(i=St(i),it(e,u=s.sheet,s.row),c=function(t,e,o){switch(o){case n.ButtonPosition.leftOfText:return new n.Rect(t.x,t.y,e.x-t.x,t.height);case n.ButtonPosition.rightOfText:return new n.Rect(e.x+e.width,t.y,t.x+t.width-e.x-e.width,t.height)}}(o,r,l?n.ButtonPosition.leftOfText:n.ButtonPosition.rightOfText),t.save(),t.rect(c.x,c.y,c.width,c.height),t.clip(),t.beginPath(),f=mt(u,s.row,s.col,s.sheetArea),h=St(i),a(f.layout)&&(f.layout={}),l)for(p=c.x+c.width,d=e.length-1;d>=0&&(g=lt(t,p-=ft(e[d].button,h,s),o.y,ft(e[d].button,h,s),c.height,e[d].button,h,s,f,f.layout,e[d].index,o),!a(g));d--);else for(p=c.x,d=0;d<e.length&&(g=lt(t,p,o.y,ft(e[d].button,h,s),c.height,e[d].button,h,s,f,f.layout,e[d].index,o),!a(g));d++)p+=g.width;t.restore()}}function lt(t,e,o,r,i,s,l,u,c,f,h,p){var d,g=T;if(c.buttonDownIndex===h?g=S:c.buttonHoverIndex===h&&(g=x),d=function(t,e,o,r,i){if(!(t+o<i.x||t>i.x+i.width||e+r<i.y||e>i.y+i.height))return t+o>i.x+i.width&&(o=i.x+i.width-t),e+r>i.y+i.height&&(r=i.y+i.height-e),t<i.x&&(t=i.x),e<i.y&&(e=i.y),new n.Rect(t,e,o,r)}(e,o,r,i,p),!a(d))return ut(t,d.x,d.y,d.width,d.height,s,l,u,g,p),f[h]=new n.Rect(d.x,d.y,d.width,d.height),f[h].offsetX=d.x-p.x,f[h].offsetY=d.y-p.y,f[h]}function ut(t,e,o,r,i,s,c,f,y,C){var v,T,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,z,U,W,q,J,X,Y;t.save(),t.beginPath(),v=s.useButtonStyle,T=at(f),R=f.printZoomFactor,M=T?R:f.sheet.zoom(),e+=k=v?w*M:0,o+=k,r-=2*k,i-=2*k,N=h,O=s.hoverBackColor||g,N&&t.strokeStyle!==N&&(t.strokeStyle=N),v&&t.strokeRect(e+.5,o+.5,r-1,i-1),D=It(s.enabled,f.row),v?!1===s.enabled?F=s.buttonBackColor||d:y===S?F=p:y===x||f.visualState===n.VisualState.hover?F=O:((E=t.createLinearGradient(e+r/2,o,e+r/2,o+i)).addColorStop(.125,"#F6FAFB"),E.addColorStop(1,"#D2DBEB"),F=s.buttonBackColor||E):(F=s.buttonBackColor||"white",y===x&&(s.enabled||a(s.enabled))&&(F=O)),(j=c.font)&&t.font!==j&&(t.font=j),t.fillStyle!==F&&(t.fillStyle=F),e+=1,o+=1,r-=2,i-=2,t.rect(e,o,r,i),t.clip(),t.beginPath(),t.fillRect(e,o,r,i),P=new n.Rect(e,o,r,i),L=new n.Rect(e,o,r,i),G=b*M,B=At(s,f.row),s.caption&&B&&(_=(I.cp(u,s.caption,c,M,f)+2*w)*M,V=dt(s)*M,z=new n.Rect(0,0,_+V+G,i),U=Z(new n.Rect(e,o,r,i),z,H.MiddleCenter),s.captionAlign===n.CaptionAlignment.left?(L=new n.Rect(U.x,o,_,i),P=U.x+_+G<e+r-2?new n.Rect(U.x+_+G,o,Math.max(0,V),i):new n.Rect(0,0,0,0)):(P=new n.Rect(U.x,o,Math.min(V,r),i),L=U.x+V+G<e+r-2?new n.Rect(U.x+V+G,o,Math.min(r-2-V-G,_),i):new n.Rect(0,0,0,0))),s.caption&&(W=(I.cp(u,s.caption,c,M,f)+2*w)*M,q=(I.ep(u,s.caption,c,M,f)+2*w)*M,J=Z(L,new n.Rect(0,0,W,q),H.MiddleCenter),X=new A,c=c.clone(),!1===D&&(c.foreColor=m),c.cellButtons=l,Y=T?0:2,X.paintValue(t,s.caption,J.x,J.y-Y,J.width,J.height,c,f)),B&&ct(t,s,P.x,P.y,P.width,P.height,B,f,C),t.restore()}function ct(t,e,o,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,C,v,b,w;t.save(),t.rect(o+2,r+2,i-4,a-4),t.clip(),t.beginPath(),(f=(c=l.sheet).vu()).ko(s)?f.bgc(s)&&(h=at(l)?l.printZoomFactor:c.zoom(),p=new n.Rect(o,r,i,a),d=dt(e)-2,g=gt(e)-2,m=Z(p,new n.Rect(0,0,d*h,g*h),H.MiddleCenter),C=(y=f.lo(s)).width,v=y.height,n.Ul.Ml.msie&&e.imageType&&(e.imageType===n.ButtonImageType.custom?(G[s]||(y.style.position="absolute",y.style.left="-10000px",y.style.top="-100000px",document.body.appendChild(y),G[s]={width:y.width,height:y.height},document.body.removeChild(y)),C=G[s].width,v=G[s].height):(C=12,v=12)),u&&n.Ul.Ml.msie&&m.x+m.width>u.x+u.width?(b=u.x+u.width-m.x)>0&&(w=C/(d*h),t.drawImage(y,0,0,b*w,v,m.x,m.y,b,g*h)):t.drawImage(y,0,0,C,v,m.x,m.y,d*h,g*h)):f.fo(s),t.restore()}function ft(t,e,o,n){var r,i,s,l,f;return void 0===n&&(n=!0),r=at(o)?o.printZoomFactor:o.sheet.zoom(),i=2*w+3,a(t.width)?(s=I.cp(u,t.caption,e,r,o),l=t.useButtonStyle,At(t,o.row)&&(s=dt(t)+s,i=(l?i:0)+b),n?(s+i+7)*r:s+i+7):(f=c(1,t.width),isNaN(f)&&(f=1),n?f*r:f)}function ht(t,e,o){var n,r,i,a,s;return void 0===o&&(o=!0),n=e.sheet,r=at(e)?e.printZoomFactor:n.zoom(),i=n.getRowHeight(e.row),a=t.imageSize?t.imageSize.height:u,s=c(1,a||i),isNaN(s)&&(s=1),o?s*r:s}function pt(t,e,o,r,i,s){var l,u,c,f,h,p=[];if(!e||0===e.length)return[];for(l=!1,u=t.ITa.getValueForKey(o,r,v),t.getActiveRowIndex()===o&&t.getActiveColumnIndex()===r&&!0!==u&&(l=!0),c=0;c<e.length;c++)for(f=e[c].visible,h=0;h<s.length;h++)(e[c].position===s[h]||a(e[c].position)&&s[h]===n.ButtonPosition.right)&&(f&&"function"==typeof f?f(o)&&p.push({index:c,button:e[c]}):(e[c].visibility===n.ButtonVisibility.onEditing&&i||e[c].visibility!==n.ButtonVisibility.onEditing&&l||e[c].visibility===n.ButtonVisibility.always||a(e[c].visibility))&&p.push({index:c,button:e[c]}));return p}function dt(t){var e;return t.imageSize&&("string"==typeof t.imageSize.width&&(e=f(t.imageSize.width)),"number"==typeof t.imageSize.width&&(e=t.imageSize.width)),(e===u||isNaN(e)||e<0)&&(e=16),e}function gt(t){var e;return t.imageSize&&("string"==typeof t.imageSize.height&&(e=f(t.imageSize.height)),"number"==typeof t.imageSize.height&&(e=t.imageSize.height)),(e===u||isNaN(e)||e<0)&&(e=16),e}function mt(t,e,o,r,i){var a,s={isMouseDownReservedLocation:!1};return r===n.SheetArea.corner?s:((a=t.ITa.getValueForKey(e,o,L,r))||i||function(t,e,o,n,r){t.ITa.setValueForKey(e,o,L,r,n)}(t,e,o,r,a=s),a)}function yt(t,e){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S;if(void 0===e&&(e=!1),o=t.context.row,r=t.context.col,i=t.cellRect,a=t.cellStyle,s=t.context,u=(l={x:t.x,y:t.y,row:o,col:r,cellRect:i,cellStyle:a,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:s}).sheet,!1!==t.cellStyle.locked&&u.options.isProtected)return null;if(c=mt(u,l.row,l.col,l.sheetArea,!0),f=t.cellStyle.cellButtons,!c||!f||f.length<=0)return null;if(h=c.layout,e&&(h=c.editorLayout[t.buttonArea]),!h)return null;for(m in p=-1,d=l.x,g=l.y,h)if(h.hasOwnProperty(m)&&(y=void 0,C=h[m],(y=e?new n.Rect(C.x,C.y,C.width,C.height):new n.Rect(i.x+C.offsetX,i.y+C.offsetY,C.width,C.height))&&y.contains(d,g))){p=+m;break}return-1!==p?l.cellButtonHitInfo={hitButtonIndex:p,buttonConfig:f[p],buttonArea:t.buttonArea}:(v=u.getCellType(l.row,l.col))&&(b=K(pt(u,f,o,r,e,[n.ButtonPosition.left]),h,a,s),w=K(pt(u,f,o,r,e,[n.ButtonPosition.right]),h,a,s),T=new n.Rect(i.x+b.width,i.y,i.width-b.width-w.width,i.height),(S=v.getHitInfo(l.x,l.y,a,T,s))&&S.isReservedLocation&&(l.isReservedLocation=!0)),l}function Ct(t,e,o){var r,i,s,l,u,c,f,h,p,d,g,m,y,C,v;return void 0===e&&(e=!1),!(!t||!t.cellButtonHitInfo)&&(r=t.sheet,s=t.row,l=t.col,u=t.sheetArea,s===r.Jl&&l===r.Kl||u!==n.SheetArea.viewport||r.endEdit()?(t.cellButtonHitInfo.buttonConfig&&(i=t.cellButtonHitInfo.buttonConfig.hasOverLay),c=mt(r,s,l,t.sheetArea),t.cellButtonHitInfo&&(h=t.cellButtonHitInfo.hitButtonIndex,f=t.cellButtonHitInfo.buttonConfig),p=It(f.enabled,t.row),!!(r&&(!c.isMouseDownReservedLocation||i)&&f&&(p||a(p))&&h>=0)&&(c.buttonDownIndex=h,c.isMouseDownReservedLocation=!0,e&&o?(d=t.cellStyle,g=c.layout,m=t.context,y=c.editorLayout,C=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,v=d.cellButtons,C&&tt(o,pt(r,v,s,l,!0,[U(C)]),C,m,d,c,g,y)):r.repaint(t.cellRect),!0)):void 0)}function vt(t,e,o){var n,r,i,a,s,l,c,f,h,p,d,g,m,v;if(void 0===e&&(e=!1),t){if(n=t&&t.sheet,r=t.row,i=t.col,a=mt(n,t.row,t.col,t.sheetArea),s=t.cellButtonHitInfo,a.isMouseDownReservedLocation&&n){if(s&&s.hitButtonIndex>=0&&s.buttonConfig.command&&(l=s.buttonConfig.command,e||n.getActiveRowIndex()===r&&n.getActiveColumnIndex()===i||n.DJ(r,i,1,1,2),"string"==typeof l?n.getParent().commandManager().execute({cmd:l,row:r,col:i,sheetName:n.name(),sheetArea:t.sheetArea}):"function"==typeof l&&l.call(u,n,r,i,t.sheetArea)),e&&a.buttonDownIndex>=0&&o&&(a.buttonDownIndex=-1,c=t.cellStyle,f=a.layout,h=t.context,p=a.editorLayout,d=s&&s.buttonArea,g=c.cellButtons,d&&tt(o,pt(n,g,r,i,!0,[U(d)]),d,h,c,a,f,p)),a.buttonDownIndex=-1,e||n.repaint(t.cellRect),a.isMouseDownReservedLocation=!1,m=t.sheetArea,!n.ITa.getValueForKey(r,i,y,m))return function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)}(n,r,i,m),n.ITa.do("setValueForKey",r,i,y,!0,m),v=setTimeout((function(){X(n,r,i,m)}),250),n.ITa.do("setValueForKey",r,i,C,v,m),!0;X(n,r,i,m)}return!1}}function bt(t,e,o){var n,r,i,s,l,u,c,f,h,p;if(void 0===e&&(e=!1),t)return r=mt(n=t&&t.sheet,t.row,t.col,t.sheetArea),i=-1,t.cellButtonHitInfo&&(i=t.cellButtonHitInfo.hitButtonIndex),i!==(a(r.buttonHoverIndex)?-1:r.buttonHoverIndex)?(r.buttonHoverIndex=i,e?(s=t.cellStyle,l=r.layout,u=t.context,c=r.editorLayout,f=s.cellButtons,h=t.row,p=t.col,o&&Tt(f,n,h,p,o.parentElement,u,s,r,l,c)):n.repaint(t.cellRect),!0):void 0}function wt(t,e,o){var n,r,i,a,s,l,u,c,f;void 0===e&&(e=!1),t&&t.cellButtonHitInfo&&(r=mt(n=t&&t.sheet,t.row,t.col,t.sheetArea),e?(r.buttonHoverIndex=-1,t.cellButtonHitInfo.hitButtonIndex>=0&&(i=t.cellStyle,a=r.layout,s=t.context,l=r.editorLayout,u=i.cellButtons,c=t.row,f=t.col,o&&Tt(u,n,c,f,o.parentElement,s,i,r,a,l))):(n&&(r.buttonHoverIndex=-1,r.buttonDownIndex=-1,r.isMouseDownReservedLocation=!1),n.repaint(t.cellRect)))}function Tt(t,e,o,n,r,i,a,s,l,u){var c,f;for(c=0;c<B.length;c++)f=W(B[c]),tt(r.querySelector("."+J(f)),pt(e,t,o,n,!0,[U(f)]),f,i,a,s,l,u)}function St(t){var e=t.clone(!0);return e.hAlign=n.HorizontalAlign.left,e.vAlign=n.VerticalAlign.center,e.wordWrap=!1,e.isVerticalText=!1,e.shrinkToFit=!1,e.formatter="General",e.textIndent=0,e}function xt(t,e,o,n,r){var i,a,s=t.AHb(e,o,r);if(s&&s.cellButtons&&s.cellButtons.length>0&&(i=s.cellButtons.filter((function(t){return 1===t.visibility})),i.length>0)){n&&t.ITa.do("setValueForKey",e,o,v,!0,r);try{a=t.getCellRect(e,o,1===r?-1:void 0,2===r?-1:void 0),t.repaint(a)}finally{n&&t.ITa.do("setValueForKey",e,o,v,l,r)}}}function At(t,e){var o,r,i=null,s=t.imageType;if(a(t.imageType))return null;switch(r=(o=It(t.enabled,e))||a(o),s){case n.ButtonImageType.dropdown:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case n.ButtonImageType.left:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case n.ButtonImageType.right:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case n.ButtonImageType.clear:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case n.ButtonImageType.ok:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case n.ButtonImageType.plus:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case n.ButtonImageType.minus:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case n.ButtonImageType.redo:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case n.ButtonImageType.undo:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case n.ButtonImageType.search:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case n.ButtonImageType.separator:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case n.ButtonImageType.spinLeft:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case n.ButtonImageType.spinRight:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case n.ButtonImageType.ellipsis:i=r?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case n.ButtonImageType.expand:i=r?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case n.ButtonImageType.collapse:i=r?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case n.ButtonImageType.custom:i=t.imageSrc}return i}function It(t,e){return"function"==typeof t?t(e):t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/celltype/celltypes.ns.js"),a=r.Common.j.Fa,n.To.No,n.Ul.fp,s=n.En.npb,l=void 0,u=null,c=Math.max,f=parseInt,h="#707070",p="#34B4E3",d="#e6e6e6",g="lightgray",m="#CACACA",y="_isFirstMouseUp",C="_mouseupToken",v="_leaveCell",b=0,w=2,T=0,S=2,x=3,A=n.CellTypes.Base,I=n.CellTypes.Context,R="gc-cell-button-canvas",k=(M="gc-editor-")+"left-cellbuttons",N=M+"right-cellbuttons",O=M+"left-of-text-cellbuttons",D=M+"right-of-text-cellbuttons",F="leftButtonArea",E="rightButtonArea",j="leftOfTextButtonArea",P="rightOfTextButtonArea",L="_cellButtonParam",G={},n.GC$,B=[n.ButtonPosition.left,n.ButtonPosition.right,n.ButtonPosition.leftOfText,n.ButtonPosition.rightOfText],_=new r.Common.ResourceManager(i.SR,"CellTypes"),V=_.getResource.bind(_),function(t){t[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight"}(H||(H={})),n.CellTypes.Base.$n("cellButton",{beforePaintLabel:function(t){var e,o,r,i,s,l,u,c,f,h,p,d,g,m,y,C,v,b=t.options.context,w=t.options.style;if(!b.cellOverflowLayout&&w.cellButtons&&w.cellButtons.length>0&&(e=t.options.context.sheet,o=b.row,r=b.col,(i=pt(e,w.cellButtons,o,r,!1,[n.ButtonPosition.left,n.ButtonPosition.right]))&&i.length>0)){if(s=St(w),it(i,e,t.options.context.row),!(l=t.ctx))return;for(u=t.options.rect,l.save(),l.rect(u.x,u.y,u.width,u.height),l.clip(),l.beginPath(),c=u.x,f=u.x+u.width,h=mt(e,b.row,b.col,b.sheetArea),a(h.layout)&&(h.layout={}),p=h.layout,d=pt(e,w.cellButtons,o,r,!1,[n.ButtonPosition.left]),g=0;g<d.length&&(m=lt(l,c,u.y,ft(d[g].button,s,b),u.height,d[g].button,s,b,h,p,d[g].index,u),!a(m));g++)c+=m.width;for(y=c,c=f,g=(C=pt(e,w.cellButtons,o,r,!1,[n.ButtonPosition.right])).length-1;g>=0&&(m=lt(l,c-=v=ft(C[g].button,s,b),u.y,v,u.height,C[g].button,s,b,h,p,C[g].index,u),!a(m));g--);l.restore(),u.x=y,u.width=c-y}},beforePaintText:function(t){var e,o,r,i,a=t.context,s=t.style;!a.cellOverflowLayout&&s.cellButtons&&s.cellButtons.length>0&&(e=t.context.sheet,o=a.row,r=a.col,(i=t.externals).left=i.left.concat(Y(pt(e,s.cellButtons,o,r,!1,[n.ButtonPosition.leftOfText]),s,a)),i.right=i.right.concat(Y(pt(e,s.cellButtons,o,r,!1,[n.ButtonPosition.rightOfText]),s,a)))},beforeFillTextArea:function(t){var e,o,r,i,a=t.style,s=a.cellButtons;a.cellButtons&&a.cellButtons.length>0&&(e=t.ctx,o=t.availRect,r=t.textRect,st(e,pt((i=t.context).sheet,s,i.row,i.col,!1,[n.ButtonPosition.leftOfText]),o,r,a,i,!0))},afterFillTextArea:function(t){var e,o,r,i,a=t.style,s=a.cellButtons;a.cellButtons&&a.cellButtons.length>0&&(e=t.ctx,o=t.availRect,r=t.textRect,st(e,pt((i=t.context).sheet,s,i.row,i.col,!1,[n.ButtonPosition.rightOfText]),o,r,a,i,!1))},onCreateCellEditor:function(t){var e,o,r,i,s,l,u,c,f,h,p,d,g,m=t.options.dom;if(m&&m.children&&((e=m.children[0])&&e.children&&e.children[0])){if(r=(o=t.context).sheet,i=o.row,s=o.col,l=t.options.cellStyle,a(l)&&(l=r.getActualStyle(i,s)),u=l.cellButtons,a(u)||u&&u.length<=0)return;for(c=t.options.cellRect,f=new n.Rect(c.x,c.y,c.width,c.height),h=mt(r,i,s,o.sheetArea),a(h.layout)&&(h.layout={}),p=h.layout,d=!1,g=0;g<u.length;g++)u[g].position!==n.ButtonPosition.leftOfText&&u[g].position!==n.ButtonPosition.rightOfText||(d=!0);for(d&&(e.style.overflow="hidden"),g=0;g<B.length;g++)Q(B[g],r,u,o,l,f,i,s,h,p,m)}},onActivateCellEditor:function(t){var e,o,n,r,i,s,l=t.context,u=l.sheet,c=l.row,f=l.col,h=t.options.cellStyle,p=h.cellButtons;if(!(a(p)||p.length<=0))for(e=mt(u,c,f,l.sheetArea),a(e.editorLayout)&&(e.editorLayout={}),o=e.layout,n=e.editorLayout,r=St(h),i=t.options.dom,s=0;s<B.length;s++)et(B[s],u,p,l,r,t,c,f,e,o,n,i)},onDeactivateCellEditor:function(t){var e,o,n,r,i,s,l=t.context,u=l.sheet,c=l.row,f=l.col,h=u.getActualStyle(c,f,l.sheetArea).cellButtons;if(h&&h.length>0)for(o=(e=mt(l.sheet,c,f,l.sheetArea)).eventListeners,n=t.options.dom.querySelectorAll("."+R),r=0;r<n.length;r++)s=q((i=n[r]).className),a(s)||a(o)||a(o[s])||(rt(i,o[s]),delete e.eventListeners[s])},onUpdateContainer:function(t){var e,o=t.context,n=o.sheet,r=o.row,i=o.col,s=mt(o.sheet,r,i,o.sheetArea).canvasSizes,l=t.cellStyle.cellButtons;if(!(a(l)||l.length<=0))for(t.context.preventOverflow=!0,e=0;e<B.length;e++)ot(B[e],n,l,r,i,s,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=yt(t)},processMouseDownOnCellPadding:function(t){Ct(t)},processMouseUpOnCellPadding:function(t){vt(t)},processMouseMoveOnCellPadding:function(t){bt(t)},processMouseLeaveOnCellPadding:function(t){wt(t)},getCellButtonAutoHeight:function(t){var e,o,r=t.context.sheet,i=t.context.row,a=t.context.col,s=t.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(e=pt(r,s.cellButtons,i,a,!1,[n.ButtonPosition.left,n.ButtonPosition.right]),o=0,e.forEach((function(e){var n=I.ep(u,e.button.caption,s,r.zoom(),t.context)-2;At(e.button,i)&&(n=c(n,dt(e.button))),o=c(n,o)})),t.value=o+1*w)},getCellButtonAutoWidth:function(t){var e,o,r=t.context.sheet,i=t.context.row,a=t.context.col,s=t.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(e=pt(r,s.cellButtons,i,a,!1,[n.ButtonPosition.left,n.ButtonPosition.right]),o=0,e.forEach((function(e){o+=ft(e.button,s,t.context,!1)})),t.value=o)}}),z="cellButtons",n.Worksheet.$n(z,{setHost:function(){var t=this;t.bind(n.Events.EnterCell+"."+z,(function(e,o){xt(t,o.row,o.col,!1,o.sheetArea)})),t.bind(n.Events.LeaveCell+"."+z,(function(e,o){xt(t,o.row,o.col,!0,o.sheetArea)})),t.bind(n.Events.TopRowChanged+"."+z,(function(e,o){xt(t,o.row,o.col,!0,o.sheetArea)}))},dispose:function(t){var e=this;e.unbind(n.Events.EnterCell+"."+z),e.unbind(n.Events.LeaveCell+"."+z),e.unbind(n.Events.TopRowChanged+"."+z)},processMouseDown:function(t){var e=t.hitInfo.cellTypeHitInfo;e&&e.cellButtonHitInfo&&Ct(e)&&(t.r=!0)}}),n.Workbook.$n(z,{onCultureChanged:function(){V()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,e,o){"use strict";var n,r,i,a,s;function l(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),r=(n=o("Core")).CellTypes.Base,i=n.CellTypes.Context,a=n.CellTypes.EditorType,s=n.CellTypes._o,e.Base=r,e.Context=i,e.EditorType=a,e._o=s,e.vHb=n.CellTypes.vHb,e.wHb=n.CellTypes.wHb,Object.defineProperty(e,"Corner",{set:function(t){t!==e.vHb.Corner&&(e.vHb.Corner=t)},get:function(){return e.vHb.Corner}}),Object.defineProperty(e,"ColumnHeader",{set:function(t){t!==e.vHb.ColumnHeader&&(e.vHb.ColumnHeader=t)},get:function(){return e.vHb.ColumnHeader}}),Object.defineProperty(e,"RowHeader",{set:function(t){t!==e.vHb.RowHeader&&(e.vHb.RowHeader=t)},get:function(){return e.vHb.RowHeader}}),Object.defineProperty(e,"Text",{set:function(t){t!==e.wHb.Text&&(e.wHb.Text=t)},get:function(){return e.wHb.Text}}),l(o("./dist/plugins/celltype/checkboxcelltype.js")),l(o("./dist/plugins/celltype/buttoncelltype.js")),l(o("./dist/plugins/celltype/hyperlinkcelltype.js")),l(o("./dist/plugins/celltype/comboboxcelltype.js")),o("./dist/plugins/celltype/cellbuttons.js"),l(o("./dist/plugins/celltype/editor/colorpicker.js")),l(o("./dist/plugins/celltype/editor/timepicker.js")),l(o("./dist/plugins/celltype/editor/calendar.js")),l(o("./dist/plugins/celltype/editor/calculator.js")),l(o("./dist/plugins/celltype/editor/monthPicker.js")),l(o("./dist/plugins/celltype/editor/listControl.js")),l(o("./dist/plugins/celltype/dropdown-action.js")),l(o("./dist/plugins/celltype/radiochecklistcelltype.js")),l(o("./dist/plugins/celltype/celltypes.ns.js")),l(o("./dist/plugins/celltype/rangecelltype.js"))},"./dist/plugins/celltype/celltypes.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/celltype/celltypes.res.en.js");e.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OK="OK",e.Cancel="Cancel",e.Calendar_ShortWeeks_1="MON",e.Calendar_ShortWeeks_2="TUE",e.Calendar_ShortWeeks_3="WED",e.Calendar_ShortWeeks_4="THU",e.Calendar_ShortWeeks_5="FRI",e.Calendar_ShortWeeks_6="SAT",e.Calendar_ShortWeeks_7="SUN",e.Calendar_Weeks_1="Monday",e.Calendar_Weeks_2="Tuesday",e.Calendar_Weeks_3="Wednesday",e.Calendar_Weeks_4="Thursday",e.Calendar_Weeks_5="Friday",e.Calendar_Weeks_6="Saturday",e.Calendar_Weeks_7="Sunday",e.Calendar_ShortMonths_1="JAN",e.Calendar_ShortMonths_2="FEB",e.Calendar_ShortMonths_3="MAR",e.Calendar_ShortMonths_4="APR",e.Calendar_ShortMonths_5="MAY",e.Calendar_ShortMonths_6="JUN",e.Calendar_ShortMonths_7="JUL",e.Calendar_ShortMonths_8="AUG",e.Calendar_ShortMonths_9="SEP",e.Calendar_ShortMonths_10="OCT",e.Calendar_ShortMonths_11="NOV",e.Calendar_ShortMonths_12="DEC",e.Calendar_Months_1="JANUARY",e.Calendar_Months_2="FEBRUARY",e.Calendar_Months_3="MARCH",e.Calendar_Months_4="APRIL",e.Calendar_Months_5="MAY",e.Calendar_Months_6="JUNE",e.Calendar_Months_7="JULY",e.Calendar_Months_8="AUGUST",e.Calendar_Months_9="SEPTEMBER",e.Calendar_Months_10="OCTOBER",e.Calendar_Months_11="NOVEMBER",e.Calendar_Months_12="DECEMBER",e.Calendar_Time_AM="AM",e.Calendar_Time_PM="PM",e.Calendar_EraName_1="M",e.Calendar_EraName_2="T",e.Calendar_EraName_3="S",e.Calendar_EraName_4="H",e.Calendar_FirstYear="1",e.Calendar_Today="Today",e.Calendar_LastMonth="Go to previous month",e.Calendar_NextMonth="Go to next month",e.Calendar_LastYear="Go to previous year",e.Calendar_NextYear="Go to next year",e.Calendar_LastTenYear="Go to previous ten years",e.Calendar_NextTenYear="Go to next ten years",e.Quarter_Format_1="Q1",e.Quarter_Format_2="Q2",e.Quarter_Format_3="Q3",e.Quarter_Format_4="Q4",e.ThemeColor="Theme Colors",e.StandardColor="Standard Colors",e.Calculator_DivideByZeroInfo="Cannot divide by zero.",e.Calculator_InvalidInputInfo="Invalid Input.",e.Calculator_SqrtParameterException="Invalid input for function.",e.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",e.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array."},"./dist/plugins/celltype/checkboxcelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function E(t,e,o,n){var r,i=t.ITa;i&&(i.do("setValueForKey",e,o,R,g,n),(r=i.getValueForKey(e,o,M,n))&&(clearTimeout(r),i.do("setValueForKey",e,o,M,g,n)))}function j(t){return 5*t}function P(t,e,o,n,r){var i=j(r),a=e.hAlign,s=o.x-1,l=o.width+1,u=0,c=0;return 0===t||1===t?(c=s+i,1===a?c=s+l/2-N*r/2:2===a&&(c=s+l-i-N*r)):2===t?(u=N*r+n,c=s+i+n,1===a?c=s+l/2-u/2+n:2===a&&(c=s+l-i-u+n)):(u=N*r+n,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)),c-s}function L(t,e,o,n,r){var i=j(r),a=e.vAlign,s=o.y-1,l=o.height+1,u=0,c=0;return 0===t?(u=N*r+n,c=s+i+n,1===a?c=s+l/2-u/2+n:2===a&&(c=s+l-i-u+n)):1===t?(u=N*r+n,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)):(c=s+i,1===a?c=s+l/2-N*r/2:2===a&&(c=s+l-i-N*r)),c-s}function G(t,e,o,n,r){var i=e.getValue(o,n,r),a=t.rK(i),s={cmd:"editCell",sheetName:e.name(),row:o,col:n,newValue:a,autoFormat:!0};e.wu().execute(s),t.tw(e,o,n,r)}function B(t,e,o,n,r){var i=r&&r.sheet,a=t.getEditorValue(e,r);t.setEditorValue(e,a,r),t.updateEditor(e,o,n,r),t.tw(i,i.Jl,i.Kl,r.sheetArea)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=r.Ul.Nl,a=n.Common.j.Fa,s=r.Ul.fp,l=r.Ul.nl,u=r.CellTypes.Context,c=r.CellTypes.Base,f=r.GC$,h=f.each,p=r.Ul.hZa,d=null,g=void 0,m=Math.max,y=parseInt,C="position",v="absolute",b="font",w="left",T="right",S="alphabetic",x=".gcEditingInput",A="green",I="normal 11pt calibri",R="_isFirstMouseUp",M="_mouseupToken",function(t){t[t.top=0]="top",t[t.bottom=1]="bottom",t[t.left=2]="left",t[t.right=3]="right"}(k=e.CheckBoxTextAlign||(e.CheckBoxTextAlign={})),O={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1,boxSize:N=12},D=function(t){function e(){var e,o=t.call(this)||this;return o.typeName="5",o._boxSize=N,e=o,h(O,(function(t,o){e["_"+t]=o})),o}return F(e,t),e.prototype.paintValue=function(t,e,o,n,i,l,u,c){var f,h,p,d,g,m,C,v,b,x,I,R,M,k,N,O,D,F,E,j,G,B,_,V,H,z;t&&(t.save(),t.rect(o,n,i,l),t.clip(),t.beginPath(),f=u.hAlign,h=u.font,p=u.foreColor,g=(d=this)._textAlign,m=d.getText(e,c),C=0,v=0,(b=c.sheet)&&(C=b.dp(m,h),v=s(h),m&&(v*=m.split(/\r\n|\r|\n/).length)),x=b.zoom(),I=c.isPrinting,R=c.printZoomFactor,I&&"number"==typeof R&&1!==R&&(x=R),++o,++n,--i,--l,k=(M=this.iWc(v,x)).radius,N=M.scaleFactor,D=P(g,u,O=new r.Rect(o,n,i,l),C,x*N),F=L(g,u,O,v,x*N),E=y(""+(o+D)),j=y(""+(n+F)),G=w,B=E+1,1===f?(G="center",B+=k):2===f&&(G=T,B+=2*k),h&&t.font!==h&&r.Ul.lZa(t,h),p&&(t.fillStyle=p),_=u.textDecoration,z=v/2-(V=parseInt(c.fontInfo.fontSize,10))/2+(H=V>8?Math.floor((V-8)/5+2):1)-1,t.textBaseline!==S&&(t.textBaseline=S),2===g?(t.textAlign=T,t.fillText(m,E+1-2,j+k+v/2-z),_&&d.ip(t,_,E+1-2,j+k+v/2-z,C,V,H)):0===g&&(t.textAlign=G,t.fillText(m,B,j-2-z),_&&d.ip(t,_,B,j-2-z,C,v)),t.save(),t.strokeStyle="black",t.strokeRect(E+.5,j+.5,2*k+.05,2*k+.05),t.fillStyle="white",t.fillRect(E+1,j+1,2*k-1,2*k-1),d._isThreeState&&a(e)?(t.beginPath(),t.fillStyle=A,t.rect(E+3*x,j+3*x,2*(k-2.5*x),2*(k-2.5*x)),t.fill()):1==!!e&&(t.beginPath(),t.lineWidth=2.5*x,t.moveTo(E+3*x,j+k),t.lineTo(E+k,j+2*k-3.5*x),t.lineTo(E+2*k-1.5*x,j+3*x),t.stroke()),t.restore(),p&&(t.fillStyle=p),3===g?(t.textAlign=w,t.fillText(m,E+1+2*k+2,j+k+v/2-z),_&&d.ip(t,_,E+1+2*k+2,j+k+v/2-z,C,V,H)):1===g&&(t.textAlign=G,t.fillText(m,B,j+2*k+2+v-z),_&&d.ip(t,_,B,j+2*k+2+v-z,C,V,H)),t.restore())},e.prototype.iWc=function(t,e){var o=this._boxSize,n=6,r=1;return"auto"===o&&(n=t/4,r=t/2/N),"number"==typeof o&&o>0&&(n=e*o/2,r=o/N),{radius:n,scaleFactor:r}},e.prototype.Voa=function(t,e,o){var n=e.font,r=this.getText(t,o),i=0;return o.sheet&&(i=s(n),r&&(i*=r.split(/\r\n|\r|\n/).length)),i},e.prototype.getText=function(t,e){return this.sK(t)},e.prototype.focus=function(t,e){t&&t.parentNode.focus()},e.prototype.createEditorElement=function(t,e){var o,n,a,s,l,u,c=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.qo,h=r.Ul.vl(c)+1e3;return f(e).css("z-index",h).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(o=f(e.firstChild)).css("overflow","hidden"),(n=f(i("input"))).attr("type","checkbox"),n.attr("class","gc-checkbox-cell-type-input"),s=(a=this.gMc(t))/N,n.css("transform","scale("+s+")"),o.append(n),(l=f(i("span"))).css(C,v).css(b,p(I)).css("cursor","default").css("white-space","nowrap"),o.append(l),(u=f(i("div"))).css(C,v).css("background-color",A).css("width",2*(a/2-2.5)).css("height",2*(a/2-2.5)),o.append(u),d},e.prototype.gMc=function(t){var e,o,n=t.sheet,r=n.zoom();return"number"==typeof this._boxSize&&this._boxSize>0?this._boxSize*r:"auto"===this._boxSize?("",o=(e=n.getStyle(t.row,t.col))&&e.font?e.font:I,r*s(o)/2):6},e.prototype.rK=function(t){return this._isThreeState?!a(t)&&(1!=!!t||d):!t},e.prototype.setEditorValue=function(t,e,o){var n,r,i,s,l,u,c,h;t&&(r=(n=t.parentNode.children)[0],i=n[1],s=n[2],r&&i&&s&&(l=this,c=void 0,h=void 0,(u=o&&o.sheet)&&u.HF||(h=l.rK(e)),l._isThreeState?a(h)?(c=!1,f(s).show()):(c=!!h,f(s).hide()):c=!!h,r.checked=c,f(i).text(l.sK(h))))},e.prototype.getEditorValue=function(t,e){if(t){var o=t.parentNode.children,n=o[0],r=o[1],i=o[2];if(n&&r&&i&&(!this._isThreeState||!f(i).isVisible()))return n.checked}return d},e.prototype.tw=function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)},e.prototype.activateEditor=function(t,e,o,n){var r,i,a=n&&n.sheet;t&&a&&(r=f(t.parentNode.parentNode),i=this,r.bind("mousedown"+x,(function(t){l(t)})),r.bind("mouseup"+x,(function(){B(i,t,e,o,n)})),r.bind("keydown"+x,(function(t){var e=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===e)return i.tK=!0,l(t),!1;8===e&&l(t)}})),r.bind("keyup"+x,(function(r){!i.tK||32!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey||(i.tK=!1,B(i,t,e,o,n))})),f(t).bind("click",(function(t){l(t)})))},e.prototype.updateEditor=function(t,e,o,n){var r,i,a,l,u,c,h,d,g,m,y,C,v,T,S,x,A,I,R,M,k,O,D,F,E,j,G,B,_,V,H=n&&n.sheet;t&&H&&(r=H.yl,l=(a=(i=t.parentNode).children)[0],u=a[1],c=a[2],l&&u&&c&&(f(i).width(o.width).height(o.height),d=(h=f(u)).text(),g=e.foreColor,m=e.font,y=e.hAlign,C=e.textDecoration,g&&h.css("color",g),v=void 0,v=m||r.Bl(),(T=H.zoom())>1&&(v=r.Cl(v)),h.css(b,p(v)),S=H.rt(d,v),x=s(v),d&&(x*=d.split(/\r\n|\r|\n/).length),k=P(I=(A=this)._textAlign,e,o,S,T*(M=(R=this.gMc(n))/N)),O=L(I,e,o,x,T*M),f(l).css("margin-left",k).css("margin-top",O),D=l.offsetLeft,F=l.offsetTop,E=l.offsetWidth,j=l.offsetHeight,G=0,B=0,0===I?(G=D,1===y?G=D+R/2-S/2:2===y&&(G=D+R-S),B=F-x,G-=(M-1)*N/2,B-=(M-1)*N/2):1===I?(G=D,1===y?G=D+R/2-S/2:2===y&&(G=D+R-S),B=F+j,G-=(M-1)*N/2,B+=(M-1)*N/2):2===I?(G=D-S-2,B=F+R/2-x/2,G-=(M-1)*N/2,B-=(M-1)*N/2):(G=D+E+2,B=F+R/2-x/2,G+=(M-1)*N/2,B-=(M-1)*N/2),h.css(w,G).css("top",B),A._isThreeState?(_=D+(E-c.offsetWidth)/2,V=F+(j-c.offsetHeight)/2,f(c).css(w,_).css("top",V).toggle().toggle()):f(c).hide(),C&&A.lp(h,C)))},e.prototype.sK=function(t){var e=this,o=e._caption;return e._isThreeState&&a(t)?e._textIndeterminate||o:1==!!t?e._textTrue||o:e._textFalse||o},e.prototype.getHitInfo=function(t,e,o,n,r){if(r){var i=r.sheetArea;if(a(i)||3===i)return{x:t,y:e,row:r.row,col:r.col,cellRect:n,sheetArea:3,isReservedLocation:!0,sheet:r.sheet,cellStyle:o}}return d},e.prototype.processMouseDown=function(t){return!!t&&void(t.isReservedLocation&&(this.uK=!0))},e.prototype.processMouseUp=function(t){var e,o,n,r,i=this,a=t&&t.sheet;if(a&&i.uK&&t.isReservedLocation){if(i.uK=!1,e=t.row,o=t.col,n=t.sheetArea,!a.ITa.getValueForKey(e,o,R,n))return G(i,a,e,o,n),a.ITa.do("setValueForKey",e,o,R,!0,n),r=setTimeout((function(){E(a,e,o,n)}),250),a.ITa.do("setValueForKey",e,o,M,r,n),!0;E(a,e,o,n)}return!1},e.prototype.processMouseLeave=function(t){return!!t&&void(this.uK=!1)},e.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},e.prototype.processKeyUp=function(t,e){return G(this,e.sheet,e.row,e.col,e.sheetArea),!0},e.prototype.getAutoFitWidth=function(t,e,o,n,r){var i=this,a=i._textAlign,s=u.cp(t,i.sK(t),o,n,r),l=i.Voa(t,o,r),c=2*i.iWc(l,n).radius;return 0===a||1===a?s=m(s,c):s+=c,s+5+2},e.prototype.getAutoFitHeight=function(t,e,o,n,r){var i=this,a=i._textAlign,s=u.ep(t,i.sK(t),o,n,r),l=i.Voa(t,o,r),c=2*i.iWc(l,n).radius;return 0===a||1===a?s+=c:s=m(s,c),s+5},e.prototype.JH=function(t){this.isReservedKey(t)&&l(t)},e.prototype.isImeAware=function(t){return!1},e.prototype.gQa=function(){},e.prototype.lJc=function(t){var e={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&k[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(e)},e.prototype.toJSON=function(){var t,e=this,o={typeName:e.typeName};return h(O,(function(n,r){(t=e["_"+n])!==r&&(o[n]=t)})),o},e.prototype.fromJSON=function(t){var e=this;h(O,(function(o){var n=t[o];a(n)||(e["_"+o]=n)}))},e}(c),e.CheckBox=D,h(O,(function(t){D.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:("boxSize"===t?("number"==typeof e&&e>0&&(this["_"+t]=e),"auto"===e&&(this["_"+t]=e)):this["_"+t]=e,this)}})),r.CellTypes._o[5]=D},"./dist/plugins/celltype/comboboxcelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function st(t,e){t.appendChild(e)}function lt(t,e){t.removeChild(e)}function ut(t){return t&&t.parentNode.parentNode.comboBox}function ct(t){f(t).css(["margin","overflow","resize",A,"padding",j,G,"white-space",P,Z],[0,"hidden",D,I,"1px 0px 0px 1px",D,H,"nowrap",V,D]).attr(N,"gcComboBoxEditor").attr(O,-1)}function ft(t){var e,o,n,r,i=["0","0","0","0"];return"string"==typeof t&&(n=void 0,r=void 0,1===(o=(e=t.split(" ",4)).length)?i=[n=e[0],n,n,n]:2===o?i=[n=e[0],r=e[1],n,r]:3===o?(r=e[1],i=[e[0],r,e[2],r]):4===o&&(i=[e[0],e[1],e[2],e[3]])),i}function ht(t,e){return t.hasOwnProperty(e)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=r.CellTypes.Base,a=r.Ul.Nl,s=n.Common.j.Fa,l=n.Common.pc,u=r.Ul,c=u.nl,f=r.GC$,h=f.each,p=u.hZa,d=u.Fxb,g=u.YIc,m=document,y=null,C=void 0,v=Math.max,b=parseInt,w="click",T="keydown",S="mouseover",x="mouseout",A="position",I="absolute",R="font",M="left",k="top",N="gcUIElement",O="tabindex",D="none",F="width",E="height",j="outline",P="box-sizing",L="color",G="background-color",B="z-index",_="display",V="content-box",H="white",z="black",U="title",W="div",q="span",J="text",X="value",Z="border",Y="min-width",K=u.K_a,function(t){t[t.text=0]="text",t[t.index=1]="index",t[t.value=2]="value"}(Q=e.EditorValueType||(e.EditorValueType={})),$=17,tt="EndEdit.gcEditingInput",et="lightgrey",ot="#1E90FF",nt={editorValueType:0,items:y,itemHeight:22,editable:!1,maxDropDownItems:20},rt=function(){function t(t,e,o,n,i,l,u){var c,h,p,d,g,m,y,b,R=this;R.KK=t,c=t.firstChild,f(t).bind(T,(function(t){R.LK(t)})).css([B,M,k,F,E,"overflow"],[l||0,e,o,n,i,"visible"]).attr([N],["gcComboBox"]),h=v(0,n-$),R._editable=!1,R.MK=p=a(W),R.NK=d=a("textarea"),R.PK=p,st(c,p),ct(p),ct(d),f(d).bind("keyup",(function(){var t,e=R.PK.value;R._text=e,t=R.QK(e),R.editorValue(t),R.RK(e),R.SK()})).bind(S,(function(){R.TK()})).bind(x,(function(){R.SK()})),f(p).bind(w,(function(){R.IK?R.Wq(tt,{isMouse:!0}):R.UK()})).bind(S,(function(){R.TK()})).bind(x,(function(){R.SK()})),R.VK(0,0,h,i),st(c,g=R.WK=a(W)),f(g).css([Z,A,G,P],[D,I,H,V]).attr(N,"gcDropDownButton").bind(w,(function(){var t;!s(R.JK)&&(t=R.JK,R.JK=C,(new Date).valueOf()-t<100)||(R.IK?R.Wq(tt,{isMouse:!0}):R.UK())})),m=a("canvas"),R.Xs=m,R.XK(h,0,n-h,i),st(g,m),st(c,y=R.YK=a(W)),R.ZK=!1,R.XIc=u||n,f(y).css([A,Z,G,B,j,_,"cursor",P,E,Y],[I,"1px solid",H,l||0,D,D,"default",V,i,R.XIc+"px"]),f(y).attr(N,"gcDropDownWindow").attr(O,-1),R.$K(0,i-0),R._K=0,st(y,b=R.aL=a(W)),R.bL=new r.IB(y,b),R._itemHeight=22,R.cL=20,R.dL=-1,R._editorValueType=0,R._items=[],R.e$a=et}return t.prototype.getComboBox=function(){return this.KK},t.prototype.dispose=function(){var t=this;f(t.KK).unbind(T),f(t.NK).unbind("keyup").unbind(S).unbind(x),f(t.MK).unbind(w).unbind(S).unbind(x),f(t.WK).unbind(w),f(t.aL).find("div").forEach((function(t){f(t).unbind(S).unbind(x).unbind(w)})),t.bL.dispose()},t.prototype.updateLocationAndSize=function(t,e,o,n){var r=this,i=v(0,o-$);r.VK(0,0,i,n),r.XK(i,0,o-i,n),r.$K(0,n-0)},t.prototype.updateStyle=function(t,e,o){var n=this;o=p(o),t=t||C,f(n.PK).css(G,t).css(L,e).css(R,o),f(n.WK).css(G,t).css(L,e).css(R,o),f(n.YK).css(G,t).css(L,e).css(R,o),f(n.KK).css(G,"transparent"),n.e$a=l.Pka(l.ec(t),l.ec(et))?H:et},t.prototype.updateImeMode=function(t){f(this.PK).css("ime-mode",t)},t.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},t.prototype.editorValue=function(t){var e,o=this;return 0===arguments.length?o.fL:(t!==o.fL&&(o.fL=t,e=o.gL(t),o.text(e),o.RK(e,!0)),o)},t.prototype.gL=function(t){var e,o,n,r,i=this,a=i._items,l=a.length,u=i._editorValueType;if(i.HK=!0,1===u)(e=(o=a[t])&&ht(o,J)?o.text:o)===C&&(e=t,i.HK=!1);else if(0===u){for(e=t,r=0;r<l&&!((o=a[r])&&ht(o,J)&&o.text===t||o===t);r++);r>=l&&(i.HK=!1)}else if(2===u){for(n=0;n<l;n++)if((o=a[n])&&ht(o,X)&&o.value===t){e=o.text;break}n>=l&&(e=t,i.HK=!1)}return s(t)&&(e=""),e},t.prototype.QK=function(t){var e,o,n,r=this._items,i=r.length,a=this._editorValueType,s=t;if(1===a)for(o=0;o<i;o++)((e=r[o])&&ht(e,J)&&e.text===t||e===t)&&(s=o);else if(2===a)for(n=0;n<i;n++)(e=r[n])&&ht(e,J)&&e.text===t?s=e.value:e===t&&(s=C);return s},t.prototype.RK=function(t,e){var o,n,r,i,a;if(t){for(r=(n=this._items).length,o=0;o<r&&(void 0,a=ht(i=n[o],J)?i.text:i,(e?a:(""+a).substr(0,t.length))!==t);o++);o>=r&&(o=-1)}else o=-1;this.hL(o)},t.prototype.SK=function(){f(this.PK).removeAttr(U)},t.prototype.TK=function(){var t=this,e=t.Xn(t._text),o=f(t.PK);e>o.width()+1?o.attr(U,t._text):o.removeAttr(U)},t.prototype.VK=function(t,e,o,n){o-=0,n-=0,f(this.PK).css(M,t).css(k,e).css(F,o-1).css(E,n-1)},t.prototype.editable=function(t){var e,o,n,r,i,a=this;return 0===arguments.length?a._editable:a._editable!==t?(a._editable=t,e=a.KK.firstChild,o=a.PK,n=f(o),r={left:b(n.css(M)),top:b(n.css(k)),width:b(n.css(F)),height:b(n.css(E))},i={backColor:n.css(G),foreColor:n.css(L),font:o.style.font},lt(e,o),a.PK=t?a.NK:a.MK,st(e,a.PK),f(a.PK).css(G,i.backColor).css(L,i.foreColor).css(R,i.font),a.VK(r.left,r.top,r.width,r.height),a):void 0},t.prototype.text=function(t){var e=this,o=e.PK;return 0===arguments.length?e._text:void(t!==e._text&&(e._text=t,e._editable?o.value=t:o.textContent=t))},t.prototype.focus=function(){var t=this.PK;t.focus(),this._editable&&(t.selectionStart=t.value.length)},t.prototype.selectAll=function(){this._editable&&this.PK.select()},t.prototype.XK=function(t,e,o,n){var r,i,a,s;o-=0,n-=0,r=this.Xs,f(this.WK).css(M,t).css(k,e).css(F,o).css(E,n),f(r).attr(F,o).attr(E,n),i=r.width,a=r.height,(s=r.getContext("2d")).beginPath(),s.lineWidth=2,s.fillStyle=z,s.moveTo(i-$+4,(a-2)/2-2.5),s.lineTo(i-$+7,(a-2)/2+3.5),s.lineTo(i-$+10,(a-2)/2-2.5),s.fill()},t.prototype.showDropDownList=function(){var t=this,e=t.bL;t.ZK=!0,f(t.YK).bind(T,(function(e){t.LK(e)})).show(),t.iL=!1,t.jL(),this.adjustPosition(),t.iL&&e.lB(f(t.aL.children).height()),e.ew(!1),t.kL(ot),t.lL(t.dL),t.focus()},t.prototype.adjustPosition=function(){var t,e,o,n,r,i,a,s,l,u,c=f(this.YK);if(c){if(t=parseInt(c.css("left"),10),e=parseInt(c.css("top"),10),o=c.width(),n=c.height(),isNaN(t)||isNaN(e)||isNaN(o)||isNaN(n))return;r=0,i=0,s=(a=m.documentElement).clientWidth,l=a.clientHeight,u=c[0].getBoundingClientRect(),n>l&&(c.css("max-height",Math.round(.8*l)+"px"),n=Math.round(.8*l)),o>s&&(c.css("max-width",Math.round(.8*s)+"px"),o=Math.round(.8*s)),u.left+o>s&&(i=u.left+o-s),u.top+n>l&&(r=u.top+n-l),(t<0||e<0||r>0||i>0)&&(e-=r,(t-=i)<0&&(t-=22),c.css({left:t+"px",top:e+"px"}))}},t.prototype.shiftPadding=function(t,e){var o=this.KK.firstChild;t===M?f(o).css({left:(+f(o).css(M).replace("px","")||0)-e}):t===k&&f(o).css({top:(+f(o).css(k).replace("px","")||0)-e})},t.prototype.closeDropDownList=function(){var t=this;t.ZK=!1,f(t.YK).unbind(T).hide(),t.kL(""),t.focus()},t.prototype.UK=function(){this.ZK?this.closeDropDownList():this.showDropDownList()},t.prototype.listHeight=function(t){var e=f(this.YK);return 0===arguments.length?e.height():void(t>0&&(e.height(t),this.bL.ew(!1)))},t.prototype.$K=function(t,e){f(this.YK).css(M,t).css(k,e)},t.prototype.items=function(t){var e,o,n,r,i,a=this;if(0===arguments.length)return a._items;if(t){for(a._items=t,e=a.aL,o=void 0,f(e).find("div").forEach((function(t){f(t).unbind(S).unbind(x).unbind(w)})),o=e.firstChild;o;)lt(e,o),o=e.firstChild;for(a._K=0,n=0,r=t.length;n<r;n++)i=t[n],a.mL(ht(i,J)?i.text:i);return a}},t.prototype.mL=function(t){var e=this,o=a(W),n=a(q);n.textContent=""+t,n.style.padding="0 18px 0 1px",n.style.textOverflow="ellipsis",n.style.whiteSpace="nowrap",st(o,n),st(e.aL,o),e._K++,f(o).bind(w,(function(){var t=f(o).index();e.selectedIndex(t),e.closeDropDownList(),e.Wq(tt,{isMouse:!0})})).bind(S,(function(){var t=f(o);o.oldBackColor=t.css(G),t.css(G,e.e$a)})).bind(x,(function(){f(o).css(G,o.oldBackColor||"")})).css(Y,e.XIc+"px")},t.prototype.nL=function(){var t=this;t.Po=a(q),f(t.Po).css([_,R],[D,t.YK.style.font]).appendTo(m.body)},t.prototype.oL=function(){lt(m.body,this.Po)},t.prototype.pL=function(t){return this.Po.textContent=t,f(this.Po).width()+2+1},t.prototype.kL=function(t){var e=this,o=e.dL;0<=o&&o<e._K&&f(e.aL.children[o]).css(G,t)},t.prototype.LK=function(t){var e,o,n,r=this,i=t.keyCode,a=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===a||39===a)&&9!==a&&r.editable()||(e=r._K,o=r.dL,n=0,38===a||40===a?(o>=0&&o<e&&(n=o+(38===a?-1:1)),n>=0&&n<e&&r.selectedIndex(n),r.ZK&&r.lL(n),c(t)):13===a||37===a||39===a||9===a?(r.selectedIndex(r.dL),r.closeDropDownList(),r.Wq(tt,{keyCode:i,shiftKey:t.shiftKey}),c(t)):27===a?(r.closeDropDownList(),r.Wq(tt,{keyCode:i}),c(t)):r.editable()||32!==a||c(t))},t.prototype.getSelectedValue=function(t,e,o){var n,r=e[t];return s(r)||(1===o?n=t:0===o?n=ht(r,J)?r.text:r:2===o&&ht(r,X)&&(n=r.value)),n},t.prototype.hL=function(t){var e=this;e.kL(""),e.dL=t,e.kL(ot),e.lL(t)},t.prototype.selectedIndex=function(t){var e,o=this;return 0===arguments.length?o.dL:void(0<=t&&t<o._K&&(o.hL(t),e=o.getSelectedValue(o.dL,o._items,o._editorValueType),s(e)||o.editorValue(e)))},t.prototype.itemCountPerPage=function(t){return 0===arguments.length?this.cL:void(t>0&&(this.cL=t))},t.prototype.Xn=function(t){this.nL();var e=this.pL(t);return this.oL(),e},t.prototype.itemHeight=function(t){return 0===arguments.length?this._itemHeight:void(t>0&&(this._itemHeight=t))},t.prototype.jL=function(){var t,e,o,n,r,i=this;i.nL(),t=i._items[0],e=v(i._itemHeight,f(i.Po).text(s(t)?"":t).height()),f(i.aL.children).css(E,e),(n=i._K)<=(r=i.cL)?o=n*e:(o=r*e,i.iL=!0),i.listHeight(o),i.oL()},t.prototype.lL=function(t){if(t>=0&&t<this._K){var e=this.aL.children[t];this.bL.BB(e)}},t.prototype.bind=function(t,e,o){f(this.KK).bind(t,e,o)},t.prototype.unbind=function(t,e){f(this.KK).unbind(t,e)},t.prototype.Wq=function(t,e){f(this.KK).trigger(t,e)},t}(),it=function(t){function e(){var e,o=t.call(this)||this;return o.typeName="7",o.DF=!1,o.GK=!1,e=o,h(nt,(function(t,o){"items"===t&&(o=[]),e["_"+t]=o})),o}return at(e,t),e.prototype.isReservedKey=function(t,e){return this.GK},e.prototype.paintValue=function(e,o,n,i,a,s,l,u){var c,f,h,p,g,m,y,C,b,w,T,S=u.sheet,x=S.zoom?S.zoom():1,A=$,I=v(0,a-A-1);3===l.hAlign&&(l.hAlign=0),l.wordWrap&&(l.wordWrap=!1),c=u.isPrinting,f=u.printZoomFactor,c&&"number"==typeof f&&1!==f&&(x=f),I>0&&s>0&&(h={},p=void 0,u.quotePrefix=l.quotePrefix,g=l.formatter&&"General"!==l.formatter,m=l._autoFormatter&&l._autoFormatter.formatCached&&"General"!==l._autoFormatter.formatCached,void 0,C=this.getItemValue(o),y=g?l.formatter:m?l._autoFormatter:r.CellTypes.Context.Ixb(e,C,I+1,l,x),(p=this.format(K(o),y,h,u))&&(b=new r.Rect(n,i,a,s),t.prototype.adjustRectForIconSet.call(this,l.hAlign,u.sheet,u.row,u.col,u.sheetArea,b,h.content&&t.prototype.hasInfilling.call(this,h.content)),n=b.x,a=b.width,w=l.isVerticalText,d(C)&&!w&&!0!==l.shrinkToFit&&(p!==(T=r.CellTypes.Context.Lxb(e,p,I+1,l,x))&&(delete h.content,l.textIndent=0),p=T),this.paintText(e,this.getText(o,u),n,i,I,s,l,u,p,h))),e.save(),(A>a||A>s)&&(e.rect(n,i,a,s),e.clip()),e.beginPath(),e.lineWidth=2,e.fillStyle=z,e.moveTo(n+a-A+3,i+(s-2)/2-2.5),e.lineTo(n+a-A+6,i+(s-2)/2+3.5),e.lineTo(n+a-A+9,i+(s-2)/2-2.5),e.fill(),e.restore()},e.prototype.getText=function(t,e){return t},e.prototype.createEditorElement=function(t,e){var o,n,r,i,a=t&&t.sheet,s=a&&a.parent,l=s&&s.qo,c=u.vl(l)+1e3,f=a.defaults,h=this,p=a.getActualStyle(t.row,t.col).cellPadding,d=0;return p&&(d=parseFloat(p.split(" ")[3])||0),0,o=(n=a.getSpan(t.row,t.col))?g(a,n.col,n.col+n.colCount,!1):a.Tl(t.col)-d,(r=new rt(e,0,0,f.colWidth,f.rowHeight,c,o)).editorValueType(h._editorValueType),r.items(h._items),r.itemHeight(h._itemHeight),r.itemCountPerPage(h._maxDropDownItems),r.editable(h._editable),i=r.getComboBox(),Object.defineProperty(i,"comboBox",{get:function(){return this.ixb},set:function(t){this.ixb!==t&&(this.ixb&&this.ixb.dispose(),this.ixb=t)}}),i.comboBox=r,y},e.prototype.getEditorValue=function(t,e){var o=ut(t);return o&&(this.DF=!o.HK),o&&o.editorValue()},e.prototype.setEditorValue=function(t,e,o){var n=ut(t);n&&n.editorValue(e)},e.prototype.focus=function(t,e){var o=ut(t);o&&o.focus()},e.prototype.selectAll=function(t,e){var o=ut(t);o&&o.selectAll()},e.prototype.activateEditor=function(t,e,o,n){var r=this,i=n.sheet,a=ut(t);a&&(a.editorValueType(r._editorValueType),a.items(r._items),a.itemHeight(r._itemHeight),a.itemCountPerPage(r._maxDropDownItems),a.editable(r._editable),a.bind(tt,(function(t,e){var o,n,r,s,l,u=e.keyCode,c=e.shiftKey;if(u){if(n=(o=i.wu()).getShortcutKey(u,!1,c||!1,!1,!1),r=o.getCommands(n))for(s=0,l=r.length;s<l;s++)if("navigationLeft"!==r[s].Cj&&"navigationRight"!==r[s].Cj||(i.Px=1),r[s].execute(i.parent,{sheetName:i.name()}))return!0}else e.isMouse&&a.IK&&i.endEdit()}))),r.GK=!0},e.prototype.deactivateEditor=function(t,e){var o,n,r,i,a,s;if(t&&(o=ut(t))){if(n=e.sheet.getActualStyle(e.row,e.col,e.sheetArea).cellPadding)for(r=[M,k],i=[3,0],a=0;a<r.length;a++)s="number"==typeof(s=parseInt(ft(n)[i[a]],10))&&s>0?s:0,o.shiftPadding(r[a],s);o.unbind(tt),o.closeDropDownList(),o.IK=!1}this.GK=!1},e.prototype.updateImeMode=function(t,e){if(this.isImeAware()){var o=ut(t);o&&o.updateImeMode(e)}},e.prototype.updateEditor=function(t,e,o,n){var r,i,a=t&&n&&n.sheet;a&&(r=ut(t),e&&r&&(i=a.yl,r.updateStyle(e.backColor,e.foreColor,i.Cl(e.font||i.Bl()))),o&&r&&r.updateLocationAndSize(o.x,o.y,o.width,o.height))},e.prototype.format=function(t,e,o,n){var r;return s(t)?"":(this,r=this.getItemValue(t),i.prototype.format.call(this,r,e,o))},e.prototype.getItemValue=function(t){var e,o,n,r,i=this._editorValueType,a=this._items;if(a)if(o=a.length,1===i){if(0<=(n=b(t))&&n<o&&((e=a[n])!==C&&e!==y))return ht(e,J)?e.text:e}else if(2===i)for(r=0;r<o;r++)if((e=a[r])&&ht(e,X)&&e.value===t)return e.text;return t},e.prototype.parse=function(t,e,o){var n,r,a,s=this,l=s._editorValueType,u=s._items,c=i.prototype.parse.call(s,t,e);if(u){if(a=u.length,0===l)return c;if(1===l){for(r=0;r<a;r++)if((n=u[r])&&ht(n,J)&&n.text===c||n===c)return r}else if(2===l)for(r=0;r<a;r++)if((n=u[r])&&ht(n,J)&&n.text===c)return n.value}return c},e.prototype.getHitInfo=function(t,e,o,n,r){var i,a,l,u,c,f;return r?(i=r.sheetArea,a=r.sheet,(s(i)||3===i)&&n&&(l=ft(o.cellPadding),u=parseInt(l[1],10)||0,c=n.x+n.width-u,f={x:t,y:e,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,sheet:a},c-$<=t&&t<c)?(f.isReservedLocation=!0,f):y):y},e.prototype.processMouseDown=function(t){var e,o=t.sheet,n=t.sheetArea;(s(n)||3===n)&&t.isReservedLocation&&o&&(t.row===o.Jl&&t.col===o.Kl||o.setActiveCell(t.row,t.col),o.startEdit(),(e=ut(o.BF))&&(u.Ml.mozilla&&(e.JK=(new Date).valueOf()),e.showDropDownList(),e.IK=!0))},e.prototype.getAutoFitWidth=function(t,e,o,n,i){return o&&o.wordWrap&&(o.wordWrap=!1),r.CellTypes.Context.cp(t,e,o,n,i)+$},e.prototype.getAutoFitHeight=function(t,e,o,n,i){return o&&o.wordWrap&&(o.wordWrap=!1),r.CellTypes.Context.ep(t,e,o,n,i)},e.prototype.isImeAware=function(t){return!0},e.prototype.gQa=function(){},e.prototype.lJc=function(t){var e={editorValueType:t.editorValueType&&Q[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(e)},e.prototype.toJSON=function(){var t,e=this,o={typeName:e.typeName};return h(nt,(function(n,r){t=e["_"+n],("items"===n?t&&t.length>0:t!==r)&&(o[n]=t)})),o},e.prototype.fromJSON=function(t){var e=this;h(nt,(function(o){var n=t[o];s(n)||(e["_"+o]=n)}))},e}(i),e.ComboBox=it,h(nt,(function(t){it.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[7]=it},"./dist/plugins/celltype/dropdown-action.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E;function j(t,e){return O.createElement(t,e)}function P(t){return{canUndo:!1,execute:function(e,o,c){var h,p,y,C,b,w,O,D,F,E=n.uJc(e,o.sheetName);if(!E||e.WJc().name()!==o.sheetName)return!1;if(h=o.row,p=o.col,(m.isNullOrUndefined(h)||m.isNullOrUndefined(p))&&(h=E.getActiveRowIndex(),p=E.getActiveColumnIndex()),y=o.sheetArea,m.isNullOrUndefined(y)&&(y=3),h<0||h>=E.getRowCount(y)||p<0||p>=E.getColumnCount(y))return!1;switch(E.showCell(h,p,n.VerticalPosition.nearest,n.HorizontalPosition.nearest),C=1===y?-1:void 0,b=2===y?-1:void 0,w=E.getCellRect(h,p,C,b),O=j("div"),D=function(t,e,o,n){var r,i;return t.isEditing()?(r=t.getCellType(e,o),i={sheet:t,row:e,col:o,sheetArea:n},r.getEditorValue(t.BF,i)):t.getValue(e,o,n)}(E,h,p,y),(m.isNullOrUndefined(o.row)||m.isNullOrUndefined(o.col))&&(o.row=E.getActiveRowIndex(),o.col=E.getActiveColumnIndex()),t){case T:F=new u.ColorPicker(O);break;case S:D=L(D,"date"),F=new f.Calendar(O);break;case x:D=L(D,"date"),F=new s.TimePicker(O);break;case A:D=""+(D=L(D,"number")),F=new r.Calculator(O);break;case I:D=L(D,"date"),F=new l.MonthPicker(O);break;case R:(F=new i.List(O)).formula=E.getFormula(o.row,o.col);break;case M:D=L(D,"number"),F=new a.Slider(O);break;case k:F=new d.WorkFlow(O),"string"!=typeof D&&D!==v&&(D=""+D);break;case N:F=new g.MultiColumn(O,v,E)}return _(F,t,D,w,E,o),!0}}}function L(t,e){return"date"===e?"string"==typeof t?(t=C.Qa(t))===v&&(t=new Date):t instanceof Date||(t=new Date):"number"===e&&("string"==typeof t?t=y.Qa(t):"number"!=typeof t&&(t=0)),t}function G(t,e,o,r){var i,a,s,l,u,c,f=o.row,h=o.col;(m.isNullOrUndefined(f)||m.isNullOrUndefined(h))&&(f=t.getActiveRowIndex(),h=t.getActiveColumnIndex()),i=o.sheetArea,m.isNullOrUndefined(i)&&(i=3),e&&e.submitCommand?"string"==typeof e.submitCommand?t.getParent().commandManager().execute({cmd:e.submitCommand,sheetName:t.name(),row:f,col:h,newValue:r.value}):"function"==typeof e.submitCommand&&((a={}).row=o.row,a.col=o.col,a.sheetArea=i,e.submitCommand.call(null,t,r.value,a)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:f,col:h,newValue:r.text,autoFormat:!r.noAutoFormat,sheetArea:i,isUndo:!1}),t.isEditing()&&t.Kl===h&&t.Jl===f&&(s=t.getCellType(f,h),l={sheet:t,row:f,col:h,sheetArea:n.SheetArea.viewport},u=t.AHb(f,h,i),c=t.getCellRect(f,h),t.BF.LF=r.value,s.updateEditor(t.BF,u,c,l),s.setEditorValue(t.BF,r.text,l)))}function B(t){var e=-1;switch(t){case T:e=n.DropDownType.colorPicker;break;case S:e=n.DropDownType.dateTimePicker;break;case x:e=n.DropDownType.timePicker;break;case A:e=n.DropDownType.calculator;break;case I:e=n.DropDownType.monthPicker;break;case R:e=n.DropDownType.list;break;case M:e=n.DropDownType.slider;break;case k:e=n.DropDownType.workflowList;break;case N:e=n.DropDownType.multiColumn}return e}function _(t,e,o,n,r,i){var a,s,l,u,f,h,d,g,m,y,C,v,b,T,S;w.Gm(),a=r.zo(),l=i.row,u=i.col,f=i.sheetArea,h=r.AHb(l,u,f),d=B(e),(y=(g=h.dropDowns)&&g.length>0)&&(C=g.filter((function(t){return t.type===d}))[0],C&&(void 0!==C.option&&null!==C.option&&(s=C.option),m=C)),t.setOptions(s),t.setValue(o),v=a.getBoundingClientRect(),b=new c.Rectangle(n.x+v.left,n.y+v.top,n.width,n.height),T=new c.PopupControl(t.getContainer(),b,{align:c.DropDownAlignment.Far,hostElement:a}),F+=1,y&&t.SDc(),T.open(),t.scrollToSelect(),y&&t.refresh(),t.on(p.BaseDropdown.Event_ValueChanged,(function(t){t.notCloseDropDown||T.close(),function(t,e){return!0!==e.notSubmit&&(3===t.sheetArea||t.cmd!==A||!isNaN(e.value))}(i,t)&&G(r,m,i,t)})),(S=r.parent)&&(S.wXc=S.wXc||[],S.wXc.push(T)),t.getContainer().addEventListener("contextmenu",(function(t){t.stopPropagation(),t.preventDefault()})),T.on("close",(function(){(function(t,e,o,n,r){var i,a=e.cellButtons;t&&a&&a.length>0&&(i=t.ITa.getValueForKey(o,n,D,r))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(o,n)))})(r,h,l,u,f),t&&t.dispose(),F-=1,T=null;var e=S.wXc.indexOf(T);S.wXc.splice(e,1),w.Hm()}))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),e.commands=n.Commands,r=o("./dist/plugins/celltype/editor/calculator.js"),i=o("./dist/plugins/celltype/editor/listControl.js"),a=o("./dist/plugins/celltype/editor/slider.js"),s=o("./dist/plugins/celltype/editor/timepicker.js"),l=o("./dist/plugins/celltype/editor/monthPicker.js"),u=o("./dist/plugins/celltype/editor/colorpicker.js"),c=o("./dist/plugins/celltype/editor/popupControl.js"),f=o("./dist/plugins/celltype/editor/calendar.js"),h=o("Common"),p=o("./dist/plugins/celltype/editor/baseControl.js"),d=o("./dist/plugins/celltype/editor/workflowPicker.js"),g=o("./dist/plugins/celltype/editor/multiColumnPicker.js"),m=o("./node_modules/util/util.js"),y=h.Common.o,C=h.Common.l,v=null,b=window,w=b.Yl,T="openColorPicker",S="openDateTimePicker",x="openTimePicker",A="openCalculator",I="openMonthPicker",R="openList",M="openSlider",k="openWorkflowList",N="openMultiColumn",O=document,D="_cellButtonParam",n.Commands[T]=P(T),n.Commands[S]=P(S),n.Commands[x]=P(x),n.Commands[A]=P(A),n.Commands[I]=P(I),n.Commands[R]=P(R),n.Commands[M]=P(M),n.Commands[k]=P(k),n.Commands[N]=P(N),F=0,E={init:function(){this.commandManager().register(T,n.Commands[T]),this.commandManager().register(S,n.Commands[S]),this.commandManager().register(x,n.Commands[x]),this.commandManager().register(A,n.Commands[A]),this.commandManager().register(I,n.Commands[I]),this.commandManager().register(R,n.Commands[R]),this.commandManager().register(M,n.Commands[M]),this.commandManager().register(k,n.Commands[k]),this.commandManager().register(N,n.Commands[N])}},n.Workbook.$n("registerOpendropdownCommand",E),n.Worksheet.$n("registerOpendropdownCommand",{preProcessMouseWheel:function(t){F>0&&!this.sgc&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,e,o){"use strict";var n,r,i,a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),r=function(t){function e(e){var o=t.call(this)||this;return o.xo=e,o}return a(e,t),e.prototype.init=function(t,e,o){this.qo=this.xo.querySelector("."+e),this.qo?this.RemoveChilds(this.qo):(this.qo=this.CreateElement(t,e,o),this.xo.appendChild(this.qo))},e.prototype.GetContainer=function(){return this.xo},e.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},e.prototype.CreateElement=function(t,e,o,n){var r,i=document.createElement(t);if(e&&(i.className=e),o)for(r in o)o[r]&&i.setAttribute(r,o[r]);return n&&n.appendChild(i),i},e}((n=o("./dist/plugins/celltype/editor/eventbase.js")).EventBase),e.BaseControl=r,i=function(t){function e(e){var o=t.call(this)||this;return o.qo=e,o}return a(e,t),e.prototype.updateStyle=function(t,e,o){},e.prototype.scrollToSelect=function(){},e.prototype.getContainer=function(){return this.qo},e.prototype.refresh=function(){},e.prototype.SDc=function(){},e.prototype.dispose=function(){},e.Event_ValueChanged="ValueChangedEvent",e}(n.EventBase),e.BaseDropdown=i},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function h(t,e,o){var n={sheet:t};i.isNullOrUndefined(o)||(n.isEsc=o),t.Wq(e,n)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),r=o("Core"),i=o("./node_modules/util/util.js"),a=Math.min,s=Math.max,l=null,u=".baseSpreadNS",c=function(t){function e(e,o,n){var r=t.call(this,e)||this;return r.setOptions(o),r.Lgc=n,r}return f(e,t),e.prototype.setOptions=function(t){var e,o;this.$z=t,t&&(e=this.qo,(o=document.createElement("div")).setAttribute("class","gc-base-spread-div"),e.appendChild(o),this.Mgc=o,this.Ngc=this.Ogc(o))},e.prototype.setValue=function(t){var e;this.$z&&(e=this.Ngc,setTimeout((function(){window.Yl.Hm(),e&&e.focus(!0)}),1e3))},e.prototype.SDc=function(){var t,e,o,n,a,s=this;s.Mgc&&(t=s.qo,(e=s.$z)&&(o=e.width,n=e.height),a=s.mAa(o,n),i.isNullOrUndefined(o)&&(o=a.width),i.isNullOrUndefined(n)&&(n=a.height),r.GC$(t).width(o).height(n))},e.prototype.refresh=function(){this.Ngc&&this.Ngc.refresh()},e.prototype.dispose=function(){var t=this;t.Lgc&&(t.Lgc.zt(),t.Lgc=l),t.Mgc&&(t.Mgc=l),t.Ngc&&(t.Ngc.unbind(r.Events.DropdownSpreadMouseClick+u),t.Ngc.unbind(r.Events.DropdownSpreadKeyboardEnter+u),t.Ngc.no(),t.Ngc=l)},e.prototype.mAa=function(t,e){var o,n,r,l,u,c,f,h=this.Ngc,p=h.getActiveSheet(),d=p.getColumnCount(),g=0;for(o=0;o<d;o++)g+=p.getColumnWidth(o,3);return n=g,r=p.getRowCount(3)+p.getRowCount(1),l=p.getRowHeight(0,3)*r,n<800&&i.isNullOrUndefined(t)||n<=t?h.options.showHorizontalScrollbar=!1:(u=0,h.kKc&&(u=h.kKc._v()),l+=u),l<400&&i.isNullOrUndefined(e)||l<e?h.options.showVerticalScrollbar=!1:(c=0,(f=h.nKc)&&(c=f.wDc(!1)||f.Vo()),n+=c),{width:a(n,800),height:a(s(l,100),400)}},e.prototype.Ogc=function(t){var e,o,n=new r.Workbook(t,{sheetCount:1});return n.jDc=!0,(e=n.options).allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserResize=!1,e.allowUserZoom=!1,e.tabStripVisible=!1,e.allowContextMenu=!1,e.allowUserDeselect=!1,e.scrollbarMaxAlign=!0,n.getActiveSheet().sgc=!0,o=this,n.bind(r.Events.DropdownSpreadMouseClick+u,(function(t,e){o.submitData(e)})),n.bind(r.Events.DropdownSpreadKeyboardEnter+u,(function(t,e){o.submitData(e)})),n},e.prototype.submitData=function(t){},e}(n.BaseDropdown),e.BaseSpreadPicker=c,r.GC$.extend(r.Worksheet.prototype,{tgc:function(){h(this,r.Events.DropdownSpreadMouseClick)},ugc:function(t){h(this,r.Events.DropdownSpreadKeyboardEnter,t)}})},"./dist/plugins/celltype/editor/calculator.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),r=o("./dist/plugins/celltype/celltypes.ns.js"),i=o("Common"),a=o("Core"),s=new i.Common.ResourceManager(r.SR),l=s.getResource.bind(s),u=Math.floor,c=Math.abs,f=Math.pow,h=Math.round,p=Math.sqrt,d=Math.max,g=["0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"],m=function(){function t(){}return t.Init=function(){t.GetBrowserType();var e=void 0!==t.edge;t.IsIE=void 0!==t.ie||e},t.GetBrowserType=function(){try{var e=navigator.userAgent.toLowerCase();window.ActiveXObject?t.ie=e.match(/msie ([\d.]+)/)[1]:-1!==e.indexOf("edge")?t.edge=e.match(/edge\/([\d.]+)/)[1]:-1!==e.indexOf("firefox")&&(t.firefox=e.match(/firefox\/([\d.]+)/)[1]),-1!==e.indexOf("rv:")&&-1===e.indexOf("firefox")&&(t.ie=e.match(/rv:([\d.]+)/)[1])}catch(t){}},t}(),m.Init(),y=function(){function t(){}return t.IsErrorText=function(t){return t===l().Calculator_DivideByZeroInfo||t===l().Calculator_InvalidInputInfo||t===l().Calculator_SqrtParameterException||t===l().Calculator_OverFlowInfo},t}(),e.CalculatorErrorInfo=y,C=function(){function t(){}return t.IsDotContained=function(t){return-1!==(t+"").indexOf(".")},t.GetDotPosition=function(t){var e=t+"",o=0,n=0;for(n=e.length;n>0;n--){if("."===e.substring(n-1,n))return o;o++}return 0===n?0:o},t.FormatOutput=function(e){var o,n;if(null==e)return null;if(0,n=(o=e+"").length,t.IsDotContained(o))for(;"0"===o.substring(n-1,n)&&""!==o&&-1===o.indexOf("e");)o=o.substring(0,n-1),n--;return o},t.FormatResult=function(e){var o,n,r,i,a,s,u;return isNaN(e)&&(e=0),o=e+"",n="",e<0&&(n="-",o=o.substring(1,o.length)),r=o.length,i="",-1!==(a=o.indexOf("e"))&&(i=o.substring(a,r),r=(o=o.substring(0,a)).length),t.IsDotContained(o)&&r>16&&(s=0,parseFloat(o)>1?(s=t.GetDotPosition(o)-(r-16),o=(""+o).substring(0,17)):(s=t.GetDotPosition(o)-(r-17),o=(""+o).substring(0,18)),o=s>0?""+h(parseFloat(o)*f(10,s))/f(10,s):""+h(parseFloat(o))),r=o.length,!t.IsDotContained(o)&&r>15&&(s=r-15,o=""+h(parseFloat(o)/f(10,s))*f(10,s)),o=n+o+i,u=parseFloat(o),t.IsOverFlow(""+u)?l().Calculator_OverFlowInfo:u},t.SingleMathOperation=function(e,o){var n,r=parseFloat(e);if(isNaN(r)&&(r=0),"SQRT"===o){if(r<0)return l().Calculator_InvalidInputInfo;r=p(r)}if("POW"===o&&(r=f(r,2)),"1/x"===o){if(0===r)return l().Calculator_DivideByZeroInfo;n=t.GetDotPosition(""+r),r=f(10,n)/(f(10,n)*r)}return t.FormatResult(r)},t.DoubleMathOperation=function(e,o,n){var r,i,a,s,u=parseFloat(e),c=parseFloat(o);if(t.IsDotContained(""+u)||t.IsDotContained(""+c)){if(i=0,a=0,t.IsDotContained(""+u)&&(i=t.GetDotPosition(""+u)),t.IsDotContained(""+c)&&(a=t.GetDotPosition(""+c)),s=d(i,a),"+"===n&&(r=((u*=f(10,s))+(c*=f(10,s)))/f(10,s)),"-"===n&&(r=((u*=f(10,s))-(c*=f(10,s)))/f(10,s)),"*"===n&&(r=(u*=f(10,i))*(c*=f(10,a))/f(10,i+a)),"/"===n){if(u*=f(10,s),0===(c*=f(10,s)))return l().Calculator_DivideByZeroInfo;r=u/c}"%"===n&&(r=(u*=f(10,i))*(c*=f(10,a))/f(10,i+a+2))}else{if("+"===n&&(r=u+c),"-"===n&&(r=u-c),"*"===n&&(r=u*c),"/"===n){if(0===c)return l().Calculator_DivideByZeroInfo;r=u/c}"%"===n&&(r=u*c/100)}return t.FormatResult(r)},t.IsOverFlow=function(t){var e=parseFloat(t);if(0!==e){if(e>79e27)return!0;if(e<1e-28&&e>-1e-28)return!0;if(e<-79e27)return!0}return!1},t}(),v=function(){function t(t,e,o,n,r,i,a,s,l,u,c){var f=this;f.Fi=t,f.XHa=e,f.YHa=o,f.JCb=n,f.KCb=r,f.Jb=i,f.LCb=a,f.MCb=s,f.NCb=l,f.OCb=u,f.PCb=c,f.QCb=g}return t.prototype.RCb=function(){var t=this;t.Fi="",t.XHa=null,t.YHa=null,t.JCb=null,t.KCb=0,t.MCb=!1,t.NCb=!1},t.prototype.Click=function(t){var e,o=this;return t>=0&&t<=11&&(o.OCb&&(o.SCb(t),o.OCb=!1),o.TCb(t),10!==t&&(o.PCb="ClickNumericButton")),(t>=12&&t<=19||27===t)&&(o.OCb?(o.SCb(t),o.OCb=!1):(o.UCb(t),o.PCb="ClickMathButton")),24===t&&(o.OCb&&(o.SCb(t),o.OCb=!1),o.VCb()),25!==t&&26!==t||(o.SCb(t),o.OCb=!1),o.OCb?null:((e={}).outputText=o.WCb(),y.IsErrorText(o.Fi)&&(o.OCb=!0),e.result=void 0===o.Fi||null===o.Fi?"":o.Fi,e.x=o.XHa,e.y=o.YHa,e.operation=o.JCb,e.token=o.KCb,e.count=o.Jb,e.memoryNumber=o.LCb,e.isBSCanUse=o.MCb,e.isEqualClicked=o.NCb,e.isOperationInvalid=o.OCb,e.lastOperation=o.PCb,e)},t.prototype.TCb=function(t){var e=this;if(null!==e.Fi&&void 0!==e.Fi||(e.Fi=""),!(e.Jb>14&&10!==t))switch(11!==t&&10!==t&&(0!==t||e.Fi+""!="0"&&""!==e.Fi)&&e.Jb++,10!==t&&(e.MCb=!0),e.KCb){case 0:t>=0&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0!==t?e.Fi=""+t:"0"!==e.Fi&&(e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):e.Fi-0>0?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0."),""===e.Fi||C.IsDotContained(e.Fi)?""!==e.Fi&&C.IsDotContained(e.Fi)||(e.Fi="0."):e.Fi=e.Fi+"."),e.KCb=1;break;case 1:t>=0&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0===t||("0"===e.Fi&&0!==t?e.Fi=""+t:e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):e.Fi-0>0?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb?e.Fi="0.":C.IsDotContained(e.Fi)||(""===e.Fi?e.Fi="0.":e.Fi=e.Fi+".")),e.NCb||(e.YHa=e.Fi);break;case 2:t>=0&&t<=9&&(e.Fi="",e.Fi=e.Fi+t),11===t&&(e.Fi="0."),10===t&&(e.Fi="0"),e.KCb=3,e.YHa=e.Fi;break;case 3:t>=0&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0===t||("0"===e.Fi&&0!==t?e.Fi=""+t:e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):e.Fi-0>0?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&null!==e.PCb?e.Fi="0.":C.IsDotContained(e.Fi)||(""===e.Fi?e.Fi="0.":e.Fi=e.Fi+".")),e.YHa=e.Fi}},t.prototype.UCb=function(t){var e=this;switch(e.Jb=0,e.MCb=!1,e.NCb&&(e.NCb=!1),e.Fi=C.FormatOutput(e.Fi),e.KCb){case 0:""===e.Fi&&(e.Fi=0),(t>=16&&t<=18&&17!==t||27===t)&&(e.Fi=""+C.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi),e.KCb=1),t>=12&&t<=15&&(e.JCb=t,e.XHa=e.Fi,e.KCb=2),17===t&&e.RCb();break;case 1:(t>=16&&t<=18&&17!==t||27===t)&&(e.Fi=""+C.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(null!==e.JCb&&void 0!==e.JCb&&null!==e.YHa&&void 0!==e.YHa?e.YHa=e.Fi:e.XHa=e.Fi)),19===t&&(null!==e.JCb&&void 0!==e.JCb&&null!==e.YHa&&void 0!==e.YHa?(e.Fi=""+C.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi)):"-0."===e.Fi&&(e.Fi="0."),e.NCb=!0,e.MCb=!1),t>=12&&t<=15&&(e.JCb=t,e.XHa=e.Fi,e.KCb=2),17===t&&(null!==e.JCb&&void 0!==e.JCb?(e.YHa=e.Fi,e.Fi=""+C.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[17]),e.YHa=e.Fi):e.RCb());break;case 2:(t>=16&&t<=18&&17!==t||27===t)&&(e.Fi=""+C.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.KCb=3,e.YHa=e.Fi)),19===t&&(e.YHa=e.XHa,e.Fi=""+C.DoubleMathOperation(""+e.XHa,""+e.XHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.KCb=1,e.MCb=!1),e.NCb=!0),t>=12&&t<=15&&(e.JCb=t,e.YHa=e.Fi),17===t&&(e.Fi=C.DoubleMathOperation(""+e.XHa,""+e.XHa,e.QCb[17]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi,e.KCb=3));break;case 3:t>=16&&t<=18&&17!==t&&(e.Fi=""+C.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi)),t>=12&&t<=15&&(e.YHa=e.Fi,e.Fi=""+C.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.YHa=null,e.JCb=t,e.KCb=2)),17===t&&(e.Fi=C.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[17]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi)),19===t&&(e.YHa=e.Fi,e.Fi=""+C.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.KCb=1,e.MCb=!1),e.NCb=!0)}e.Fi+=""},t.prototype.VCb=function(){var t,e=this;if(e.Jb>0&&e.Jb--,(0===e.KCb||1===e.KCb||3===e.KCb)&&!0===e.MCb)switch(e.Fi+="",0,t=e.Fi.length,t>0&&(e.Fi=e.Fi.substring(0,t-1)),"-0"===e.Fi&&(e.Fi="0"),"-"===e.Fi&&(e.Fi=""),""===e.Fi&&(e.MCb=!1),e.KCb){case 0:case 1:e.XHa=e.Fi;break;case 3:e.YHa=e.Fi}},t.prototype.SCb=function(t){var e=this;e.Jb=0,e.MCb=!1,e.Fi="",25===t&&(1===e.KCb&&(null===e.JCb||void 0===e.JCb||e.NCb||(e.YHa=0)),2===e.KCb&&(e.KCb=3)),26===t&&e.RCb()},t.prototype.WCb=function(){var t=this;return""===t.Fi||null===t.Fi||void 0===t.Fi?"0":t.Fi},t.prototype.XCb=function(t){var e=t.keyCode;switch(t.shiftKey&&(e|=65536),t.ctrlKey&&(e|=131072),t.altKey&&(e|=262144),e){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!m.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===e&&m.firefox||187===e&&!m.firefox?19:-1}},t}(),b=function(t){function e(e){var o=t.call(this,e)||this,n=o;return n.qo=document.createElement("div"),n.qo.classList.add("gc-calculator-container"),n.qo.innerHTML='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',n.qo.querySelector(".okbtn").textContent=l().OK,e.appendChild(o.qo),n.YCb(),n.ZCb(),n.$Cb(),n._Cb(),n.aDb("0"),o}return w(e,t),e.prototype.setValue=function(t){var e,o=this;t=o.bDb(t);try{if(!o.Na(t))throw Error(l().Calculator_InvalidInputInfo);t=""===t?"0":t,o.Fi=o.cDb(t),o._text=o.dDb(t),o.XHa=parseFloat(o.Fi),o.YHa=null,o.JCb=null,o.KCb=0,o.Jb=o.eDb(parseFloat(o.Fi)),o.Jb>0?o.MCb=!0:o.MCb=!1,o.NCb=!1,o.OCb=!1,o.PCb=null}catch(t){o._text=l().Calculator_InvalidInputInfo,o.Fi="",o.XHa=null,o.YHa=null,o.OCb=!0}return o.fDb(o.OCb),o.aDb(o._text),(e={}).outputText=o._text,e.result=o.Fi,e.x=o.XHa,e.y=o.YHa,e.operation=o.JCb,e.token=o.KCb,e.count=o.Jb,e.memoryNumber=o.LCb,e.isBSCanUse=o.MCb,e.isEqualClicked=o.NCb,e.isOperationInvalid=o.OCb,e.lastOperation=o.PCb,o.gDb=new v(o.Fi,o.XHa,o.YHa,o.JCb,o.KCb,o.Jb,o.LCb,o.MCb,o.NCb,o.OCb,o.PCb),o},e.prototype.setOptions=function(){},e.prototype.scrollToSelect=function(){var t=this.qo.querySelector(".gc-main-screen .gc-main");this.kDb(t)},e.prototype.YCb=function(){var t=this;t.hDb="0",t._text=t.hDb,t.Fi="",t.XHa=0,t.YHa=0,t.JCb=null,t.KCb=0,t.Jb=0,t.LCb=null,t.MCb=!1,t.NCb=!1,t.OCb=!1,t.PCb=null},e.prototype.ZCb=function(){var t=this;t.gDb=new v(this.Fi,t.XHa,t.YHa,t.JCb,t.KCb,t.Jb,t.LCb,t.MCb,t.NCb,t.OCb,t.PCb)},e.prototype.$Cb=function(){this.fDb(this.OCb)},e.prototype._Cb=function(){var t=this,o=this,r=o.qo;r.addEventListener("click",(function(i){for(var a,s,l=i.srcElement||i.target;l&&!l.classList.contains("button");)l=l.parentElement;l&&(l.getAttribute("data-value")?(a=l.getAttribute("data-value"),s=e.iDb(a),r.focus(),-1!==s&&o.jDb(s)):l.classList.contains("okbtn")&&("ClickNumericButton"===o.PCb&&o.jDb(19),t.fire(n.BaseDropdown.Event_ValueChanged,{value:o._text,text:o._text})))})),r.addEventListener("keydown",(function(t){!0!==o.XCb(t)&&(t.preventDefault(),t.stopPropagation())})),r.addEventListener("contextmenu",(function(t){t.preventDefault(),t.stopPropagation()}))},e.prototype.aDb=function(t){var e=this.qo.querySelector(".gc-main-screen .gc-main"),o=e.value;null!=o&&(""+o).replace(/\r\n/g,"\n")!==(""+t).replace(/\r\n/g,"\n")&&(e.value=t,this.kDb(e))},e.prototype.kDb=function(t){var e=this;if(null!==e.lDb&&void 0!==e.lDb||(e.lDb=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0)),e.mDb(t))for(;e.mDb(t);)e.nDb(t);else e.oDb(t)},e.prototype.mDb=function(t){var e,o;return t.scrollWidth>t.clientWidth||!(!a.Ul.Ml.edge&&!a.Ul.Ml.msie)&&!(t.clientWidth<=0)&&(o=(e=window.getComputedStyle(t)).fontWeight+" "+e.fontSize+" "+e.fontFamily,a.Vn.Xn(t.value,o)+40>t.clientWidth)},e.prototype.nDb=function(t){var e=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);t.style.fontSize=e-1+"px"},e.prototype.oDb=function(t){for(var e=this,o=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);!e.mDb(t)&&o<e.lDb;)if(++o,t.style.fontSize=o+"px",e.mDb(t)){for(;e.mDb(t);)e.nDb(t);break}},e.prototype.bDb=function(t){if(void 0===t||"string"!=typeof t&&!(t instanceof String))throw Error(t+" type is not a string.");return null!=t||(t=""),""+t},e.prototype.pDb=function(t,e){var o,n,r,i;if(0===e.length)return"";for(o="",n=0,r=0,n=0;n<e.length;n++){for(i=!1,r=0;r<t.length;r++)e.substring(n,n+1)===t.substring(r,r+1)&&(i=!0);!0===i&&(o+=e.substring(n,n+1))}return o},e.prototype.Na=function(t){if(this.pDb("-.0123456789",t)!==t)return!1;var e=t.indexOf("-");return(-1===e||0===e)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},e.prototype.cDb=function(t){var e,o,n,r,i,a=parseFloat(t),s=!1;if(a<0&&(s=!0),e=c(a),o=u(e),n=C.GetDotPosition(""+e),r=(e*f(10,n)-o*f(10,n))/f(10,n),o>999999999999999)throw Error(l().Calculator_InvalidInputInfo);if(999999999999999===o){if(0===r)return o;throw Error(l().Calculator_InvalidInputInfo)}return r=h(r*f(10,i=0===o?15:15-(""+o).length))/f(10,i),n=C.GetDotPosition(""+r),e=(o*f(10,n)+r*f(10,n))/f(10,n),o=u(e),n=C.GetDotPosition(""+e),0===(r=(e*f(10,n)-o*f(10,n))/f(10,n))&&(e=o),s?"-"+e:""+e},e.prototype.dDb=function(t){var e=""+t;return""===e&&(e="0"),e},e.prototype.eDb=function(t){var e=c(t),o=u(e),n=C.GetDotPosition(""+e),r=(e*f(10,n)-o*f(10,n))/f(10,n);return(0===o?0:(""+o).length)+(0===r?0:n)},e.prototype.fDb=function(t){for(var e=10;e<=18;e++)this.qDb(e,t);this.qDb(27,t)},e.prototype.qDb=function(t,e){var o=g[t],n=this.qo.querySelector('[data-value="'+o.toLowerCase()+'"]');n&&(e?n.classList.add("disabled"):n.classList.remove("disabled"))},e.iDb=function(t){var e=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e=parseInt(t,10);break;case"+/-":e=10;break;case".":e=11;break;case"+":e=12;break;case"-":e=13;break;case"*":e=14;break;case"/":e=15;break;case"sqrt":e=16;break;case"%":e=17;break;case"1/x":e=18;break;case"=":e=19;break;case"MC":e=20;break;case"MR":e=21;break;case"MS":e=22;break;case"M+":e=23;break;case"BS":e=24;break;case"CE":e=25;break;case"C":e=26;break;case"pow":e=27;break;default:e=-1}return e},e.prototype.jDb=function(t){var e=this,o=e.gDb.Click(t);null!=o&&(null!==o.result&&void 0!==o.result&&(e.Fi=o.result),null!==o.outputText&&void 0!==o.outputText&&(e.hDb=o.outputText,e._text=e.hDb,e.aDb(e.hDb)),null!==o.isOperationInvalid&&void 0!==o.isOperationInvalid&&o.isOperationInvalid!==e.OCb&&(e.OCb=o.isOperationInvalid,e.fDb(e.OCb)),o.memoryNumber!==e.LCb&&(e.LCb=o.memoryNumber),o.lastOperation!==e.PCb&&(e.PCb=o.lastOperation))},e.prototype.XCb=function(t){var e=this.gDb.XCb(t);return null==e||-1!==e&&void this.jDb(e)},e}(n.BaseDropdown),e.Calculator=b},"./dist/plugins/celltype/editor/calendar.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function et(t){return f.createElement(t)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/eventbase.js"),r=o("./dist/plugins/celltype/editor/timepicker.js"),i=o("./dist/plugins/celltype/editor/baseControl.js"),a=o("./dist/plugins/celltype/celltypes.ns.js"),s=o("Common"),l=o("Core"),u=new s.Common.ResourceManager(a.SR),c=u.getResource.bind(u),f=document,h="gc-content-container",p="gc-header-container",d="gc-header-title",g="gc-year-page",m="gc-month-page",y="gc-day-page",C="gc-left-arrow",v="gc-right-arrow",b="gc-is-focused",w="gc-cl-is-selected",T="gc-cl-disabled-text",S="gc-cl-select-container",x="gc-focus-part-indicator",A="gc-cl-datepicker",I="gc-cl-dropdown",R="gc-cl-datepicker-filter",M="gc-cl-datepicker-filter-month",k="gc-cl-grid-align-spread",N="gc-cl-align-middle",O="gc-cl-button-icon-container",D="gc-cl-datepicker-month",F="gc-cl-day",E="gc-cl-grow",j="gc-cl-grid",P="gc-cl-button",L="year-index",G="month-index",B="week-index",_="day-index",function(t){t[t.Date=1]="Date",t[t.Time=2]="Time"}(V||(V={})),H=function(){function t(){}return t.initResource=function(){t.resource={shortWeeks:[c().Calendar_ShortWeeks_1,c().Calendar_ShortWeeks_2,c().Calendar_ShortWeeks_3,c().Calendar_ShortWeeks_4,c().Calendar_ShortWeeks_5,c().Calendar_ShortWeeks_6,c().Calendar_ShortWeeks_7],shortMonths:[c().Calendar_ShortMonths_1,c().Calendar_ShortMonths_2,c().Calendar_ShortMonths_3,c().Calendar_ShortMonths_4,c().Calendar_ShortMonths_5,c().Calendar_ShortMonths_6,c().Calendar_ShortMonths_7,c().Calendar_ShortMonths_8,c().Calendar_ShortMonths_9,c().Calendar_ShortMonths_10,c().Calendar_ShortMonths_11,c().Calendar_ShortMonths_12],weeks:[c().Calendar_Weeks_7,c().Calendar_Weeks_1,c().Calendar_Weeks_2,c().Calendar_Weeks_3,c().Calendar_Weeks_4,c().Calendar_Weeks_5,c().Calendar_Weeks_6],months:[c().Calendar_Months_1,c().Calendar_Months_2,c().Calendar_Months_3,c().Calendar_Months_4,c().Calendar_Months_5,c().Calendar_Months_6,c().Calendar_Months_7,c().Calendar_Months_8,c().Calendar_Months_9,c().Calendar_Months_10,c().Calendar_Months_11,c().Calendar_Months_12],timePrefix:[c().Calendar_Time_AM,c().Calendar_Time_PM],eraNames:[c().Calendar_EraName_1,c().Calendar_EraName_2,c().Calendar_EraName_3,c().Calendar_EraName_4],earFirstYear:c().Calendar_FirstYear,today:c().Calendar_Today,lastMonth:c().Calendar_LastMonth,nextMonth:c().Calendar_NextMonth,lastYear:c().Calendar_LastYear,nextYear:c().Calendar_NextYear,lastTenYears:c().Calendar_LastTenYear,nextTenYears:c().Calendar_NextTenYear}},t.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},t}(),z=function(){this.yearTds=[]},U=function(){this.monthTds=[]},W=function(){this.weekThs=[],this.dayTds=[]},q=function(){this.calendarYearSection=new z,this.calendarMonthSection=new U,this.calendarDaySection=new W,this.timeItemLIs=[]},J=function(){function t(){}return t.dateEqual=function(t,e,o){if(!t&&!e)return!0;if(!t)return!1;if(!e)return!1;try{return o?t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()&&t.getSeconds()===e.getSeconds():t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}catch(t){return!1}},t.getMonthMaxDay=function(t,e){return-1!==[1,3,5,7,8,10,12].indexOf(e)?31:-1!==[4,6,9,11].indexOf(e)?30:t%4==0&&t%100!=0?29:28},t.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},t.addMilliseconds=function(t,e){var o=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return o.setMilliseconds(o.getMilliseconds()+e),new Date(o.valueOf())},t.getEraDate=function(e){var o,n={era:-1,eraYear:-1};if(!t.isValidEraDate(e))return n;for(o=0;o<t.eraCount;o++)if(e<(o+1!==t.eraCount?t.eraDates[o+1]:t.addMilliseconds(t.eraMax,1))){n.era=o,n.eraYear=e.getFullYear()-t.eraDates[o].getFullYear()+1;break}return n},t.getEraYearString=function(e){var o=new Date(e,5,30),n=t.getEraDate(o);return-1===n.era||-1===n.eraYear?""+e:e+"年"},t.getShortEraYearString=function(e){var o,n=new Date(e,11,31),r=t.getEraDate(n);return-1===r.era||-1===r.eraYear?"":(o=1===r.eraYear?H.resource.earFirstYear:r.eraYear,H.resource.eraNames[r.era]+o+"年")},t.getDateLocaleLabel=function(t){var e=t.getHours(),o=t.getMinutes();return(e<12?H.resource.timePrefix[0]:H.resource.timePrefix[1])+" "+(0===e||12===e?"12":""+e%12)+":"+(o<10?"0"+o:""+o)},t.eraCount=4,t.eraMax=new Date(2087,11,31,23,59,59),t.eraMin=new Date(1868,8,8),t.eraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],t}(),X=function(){function t(t,e,o,n){this.year=t,this.selected=!!e,this.disabled=!!o,this.focused=!!n}return t.prototype.getLabel=function(){return""+this.year},t}(),Z=function(){function t(t,e,o,n){this.month=t,this.selected=!!e,this.disabled=!!o,this.focused=!!n}return t.prototype.getLabel=function(){return H.resource.shortMonths[this.month]},t}(),Y=function(){function t(t,e,o,n){this.date=t,this.selected=!!e,this.disabled=!!o,this.focused=!!n}return t.prototype.getLabel=function(){return""+this.date.getDate()},t}(),K=function(){function t(t){this.owner=t,this.calendarPage=l.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,H.initResource()}return t.getMonthName=function(t){return H.resource.months[t]},t.getShortMonthName=function(t){return H.resource.shortMonths[t]},t.prototype.updateDayItems=function(){var t,e,o,n,r,i,a;for(this.dayItems=[],t=this.focusDate.getFullYear(),e=this.focusDate.getMonth(),r=n=((o=new Date(t,e,1).getDay()-this.owner.rDb)<0?o+7:o)%7;r>0;r--)(i=new Date(t,e,1)).setDate(i.getDate()-r),a=new Y(i,!1,!0,!1),this.dayItems.push(a);for(r=1;r<=42-n;r++)i=new Date(t,e,r),a=new Y(i),i.getMonth()!==e&&(a.disabled=!0),J.dateEqual(i,this.selectedDate)&&(a.selected=!0),J.dateEqual(i,this.selectedDate)&&(a.selected=!0),J.dateEqual(i,this.focusDate)&&(a.focused=!0),this.dayItems.push(a)},t.prototype.updateMonthItems=function(){var t,e,o=this.selectedDate,n=this.focusDate;for(this.monthItems=[],t=0;t<12;t++)(e=new Z(t)).selected=o&&o.getMonth()===t&&o.getFullYear()===n.getFullYear(),e.focused=n&&n.getMonth()===t,this.monthItems.push(e)},t.prototype.updateYearItems=function(){var t,e;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)(e=new X(t)).selected=this.selectedDate&&this.selectedDate.getFullYear()===t,e.focused=this.focusDate&&this.focusDate.getFullYear()===t,e.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd,this.yearItems.push(e)},t.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},t.prototype.getShortWeekName=function(t){return H.resource.shortWeeks[t=(this.owner.rDb+t-1)%7]},t.prototype.getCurrentMonthName=function(){var e=this.focusDate.getMonth();return t.getMonthName(e)},t}(),Q=function(t){function e(e){var o=t.call(this)||this;return o.sDb=40,o.tDb=100,o.uDb=!1,o.tc=e,o}return tt(e,t),Object.defineProperty(e.prototype,"host",{get:function(){return this.tc.getContainer()},enumerable:!0,configurable:!0}),e.prototype.createCalendarDom=function(){var t,e,o,n,r,i,a,s=this.tc;this.vDb=new q,(t=et("div")).tabIndex=0,t.classList.add("gc-calendar-container"),s.JK?t.classList.add("gc-date-time-container"):t.classList.add("gc-date-container"),e=et("table"),o=et("tr"),(n=et("td")).classList.add("gc-content-td-date"),s.JK&&n.classList.add("gc-content-td-time"),n.appendChild(this.wDb()),o.appendChild(n),e.appendChild(o),t.appendChild(e),s.JK&&(r=et("tr"),i=et("td"),n.appendChild(this.xDb()),n.appendChild(this.yDb()),i.appendChild(this.zDb()),i.appendChild(this.ADb()),r.appendChild(i),e.appendChild(r)),this.vDb.outterContainerDiv=t,(a=this.host)&&(a.innerHTML="",a.appendChild(t))},e.prototype.ADb=function(){var t,e=et("div");return e.classList.add("gc-ok-button-container"),(t=et("button")).textContent="OK",t.className=P+" gc-cl-button-brand gc-uiButton",e.appendChild(t),this.vDb.okButton=t,e},e.prototype.xDb=function(){var t=et("div");return t.classList.add("gc-date-time-vertical-partline"),t},e.prototype.zDb=function(){var t=et("div");return t.classList.add("gc-date-time-horizontal-partline"),t},e.prototype.wDb=function(){var t=et("div");return t.className="gc-date-part-container "+A+" "+I,t.tabIndex=0,t.appendChild(this.BDb()),t.appendChild(this.CDb()),t.appendChild(this.DDb()),this.vDb.dateContainerDiv=t,t},e.prototype.BDb=function(){var t=et("div");return t.classList.add(g),t.appendChild(this.EDb()),t.appendChild(this.FDb()),t},e.prototype.EDb=function(){var t,e,o,n,r,i,a,s=et("div");return s.className=p+" "+R+" "+j,(t=et("div")).className=M+" "+j+" "+k+" "+E,et("div").classList.add(N),(e=et("button")).className=P+" "+O,e.title=c().Calendar_LastTenYear,e.setAttribute("type","button"),(o=et("div")).classList.add(C),e.appendChild(o),(n=et("span")).classList.add(N),(r=et("button")).className=P+" "+O,r.title=c().Calendar_NextTenYear,r.setAttribute("type","button"),(i=et("div")).classList.add(v),r.appendChild(i),t.appendChild(e),t.appendChild(n),t.appendChild(r),(a=this.vDb.calendarYearSection).headerDiv=s,a.lastYearRangeButton=e,a.focusDateYearRangeName=n,a.nextYearRangeButton=r,s.appendChild(t),s},e.prototype.FDb=function(){var t,e=et("table");return e.className=h+" "+D,(t=et("div")).appendChild(e),this.vDb.calendarYearSection.currentYearRangeTable=e,this.GDb(),t},e.prototype.GDb=function(){var t,e,o,n,r,i=this.vDb.calendarYearSection,a=et("tbody");for(t=0;t<3;t++){for(e=et("tr"),o=0;o<4;o++)(n=et("td")).setAttribute(L,""+(4*t+o)),(r=et("span")).classList.add(F),r.setAttribute(L,""+(4*t+o)),r.innerText=""+(4*t+o+1),n.appendChild(r),e.appendChild(n),i.yearTds.push(n);a.appendChild(e)}i.currentYearRangeTable.appendChild(a)},e.prototype.CDb=function(){var t=et("div");return t.classList.add(m),t.appendChild(this.HDb()),t.appendChild(this.IDb()),t},e.prototype.HDb=function(){var t,e,o,n,r,i,a,s=et("div");return s.className=p+" "+R+" "+j,(t=et("div")).className=M+" "+j+" "+k+" "+E,et("div").classList.add(N),(e=et("button")).className=P+" "+O,e.title=c().Calendar_LastYear,e.setAttribute("type","button"),(o=et("div")).classList.add(C),e.appendChild(o),(n=et("span")).className=d+" "+N,(r=et("button")).className=P+" "+O,r.title=c().Calendar_NextYear,r.setAttribute("type","button"),(i=et("div")).classList.add(v),r.appendChild(i),t.appendChild(e),t.appendChild(n),t.appendChild(r),(a=this.vDb.calendarMonthSection).headerDiv=s,a.lastYearButton=e,a.currentYearName=n,a.nextYearButton=r,s.appendChild(t),s},e.prototype.IDb=function(){var t,e=et("table");return e.className=h+" "+D,(t=et("div")).appendChild(e),this.vDb.calendarMonthSection.currentYearTable=e,this.JDb(),t},e.prototype.JDb=function(){var t,e,o,n,r,i=this.vDb.calendarMonthSection,a=et("tbody");for(t=0;t<3;t++){for(e=et("tr"),o=0;o<4;o++)(n=et("td")).setAttribute(G,""+(4*t+o+1)),(r=et("span")).classList.add(F),r.setAttribute(G,""+(4*t+o+1)),r.innerText=""+(4*t+o+1),n.appendChild(r),e.appendChild(n),i.monthTds.push(n);a.appendChild(e)}i.currentYearTable.appendChild(a)},e.prototype.DDb=function(){var t=et("div");return t.classList.add(y),t.appendChild(this.KDb()),t.appendChild(this.LDb()),t.appendChild(this.MDb()),t.appendChild(this.NDb()),t},e.prototype.KDb=function(){var t,e,o,n,r,i,a,s,l,u,f,h,g,m,y,b=et("div");for(b.className=p+" "+R+" "+j,(t=et("div")).className=M+" "+j+" "+k+" "+E,et("div").classList.add(N),(e=et("button")).className=P+" "+O,e.title=c().Calendar_LastMonth,e.setAttribute("type","button"),(o=et("div")).classList.add(C),e.appendChild(o),(n=et("span")).className=d+" "+N,(r=et("button")).className=P+" "+O,r.title=c().Calendar_NextMonth,r.setAttribute("type","button"),(i=et("div")).classList.add(v),r.appendChild(i),t.appendChild(e),t.appendChild(n),t.appendChild(r),(a=et("div")).className="gc-year-select-div gc-cl-shrink-none",(s=et("div")).classList.add(S),(l=et("select")).classList.add("gc-cl-select"),f=(u=new Date).getFullYear()-this.tDb,h=u.getFullYear()+this.sDb,g=f;g<=h;g++)(m=et("option")).text=""+g,m.value=""+g,l.options.add(m);return et("div").classList.add(S),s.appendChild(l),a.appendChild(s),b.appendChild(a),b.appendChild(t),(y=this.vDb.calendarDaySection).headerDiv=b,y.lastMonthButton=e,y.currentMonthName=n,y.nextMonthButton=r,y.yearSelect=l,b},e.prototype.LDb=function(){var t,e,o,n,r,i,a=et("div");for(a.className="gc-week-container "+R+" "+j,(t=et("table")).className=h+" "+D,e=et("thead"),o=et("tr"),n=0;n<7;n++)(r=et("th")).setAttribute(B,""+n),(i=et("span")).classList.add("gc-cl-week"),i.setAttribute(B,""+n),i.innerText=this.tc.aT.getShortWeekName(n),r.appendChild(i),o.appendChild(r),this.vDb.calendarDaySection.weekThs.push(r);return e.appendChild(o),t.appendChild(e),a.appendChild(t),a},e.prototype.MDb=function(){var t,e,o,n,r,i,a=this.vDb.calendarDaySection,s=et("div"),l=et("div"),u=et("table");for(u.className=h+" "+D,t=et("tbody"),e=0;e<6;e++){for(o=et("tr"),n=0;n<7;n++)(r=et("td")).setAttribute(_,""+(7*e+n)),(i=et("span")).classList.add(F),i.setAttribute(_,""+(7*e+n)),r.appendChild(i),o.appendChild(r),a.dayTds.push(r);t.appendChild(o)}return u.appendChild(t),l.appendChild(u),s.appendChild(l),a.dayContentTable=u,s},e.prototype.NDb=function(){var t,e,o,n,r,i=et("div");return i.classList.add("gc-today-container"),(t=et("table")).classList.add(h),e=et("tbody"),o=et("tr"),n=et("td"),(r=et("a")).href="javascript:void(0);",r.className="gc-cl-show-inline-block gc-cl-p-bottom-x-small",r.innerText=H.resource.today,n.appendChild(r),o.appendChild(n),e.appendChild(o),t.appendChild(e),i.appendChild(t),this.vDb.calendarDaySection.todayTd=n,this.vDb.calendarDaySection.todayTable=t,i},e.prototype.yDb=function(){var t=this,e=et("div");return e.className="gc-time-part-container "+A+" "+I,e.tabIndex=0,this.vDb.timeContainerDiv=e,this.ODb=new r.TimePicker(e),this.ODb.setOptions({step:{minute:30},height:260}),this.ODb.on(i.BaseDropdown.Event_ValueChanged,(function(e){t.PDb(e)})),e},e.prototype.updateCalendarDom=function(){this.QDb(),this.tc.JK&&this.RDb()},e.prototype.QDb=function(){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.SDb();break;case l.CalendarPage.month:this.TDb();break;case l.CalendarPage.day:this.UDb()}},e.prototype.VDb=function(){var t,e,o,n,r,i=this.tc.aT,a=this.vDb.calendarDaySection,s=!1;for(a.currentMonthName.innerText=i.getCurrentMonthName(),t=i.focusDate.getFullYear(),e=a.yearSelect,o=0;o<e.options.length;o++)if(""+t===e.options[o].value){e.selectedIndex=o,s=!0;break}n=this.sDb+this.tDb+1,s?e.options[n]&&e.selectedIndex<=n-1&&e.options[n].remove():((r=et("option")).text=""+t,r.value=""+t,e.options[n]=r,e.selectedIndex=n)},e.prototype.SDb=function(){var t,e,o,n,r,i,a,s,l=this.tc.aT,u=this.vDb.calendarYearSection;for(l.updateYearItems(),u.focusDateYearRangeName.innerText=l.focusDateYearRangeStart+" - "+l.focusDateYearRangeEnd,t=u.yearTds,e=l.yearItems,o=0;o<3;o++)for(n=0;n<4;n++)i=e[r=4*o+n],(s=(a=t[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(T):a.classList.remove(T),i.selected?a.classList.add(w):a.classList.remove(w),i.focused?s.classList.add(b):s.classList.remove(b)},e.prototype.TDb=function(){var t,e,o,n,r,i,a,s,l,u=this.tc.aT,c=this.vDb.calendarMonthSection;for(u.updateMonthItems(),t=u.focusDate.getFullYear(),e=u.monthItems,o=c.monthTds,c.currentYearName.innerText=""+t,n=0;n<3;n++)for(r=0;r<4;r++)a=e[i=4*n+r],(l=(s=o[i]).querySelector("span")).innerText=a.getLabel(),a.selected?s.classList.add(w):s.classList.remove(w),a.focused?l.classList.add(b):l.classList.remove(b)},e.prototype.UDb=function(){this.VDb(),this.WDb()},e.prototype.WDb=function(){var t,e,o,n,r,i,a,s,l=this.tc.aT;for(l.updateDayItems(),t=l.dayItems,e=this.vDb.calendarDaySection.dayTds,o=0;o<6;o++)for(n=0;n<7;n++)i=t[r=7*o+n],(s=(a=e[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(T):a.classList.remove(T),i.focused?s.classList.add(b):s.classList.remove(b),i.selected?a.classList.add(w):a.classList.remove(w)},e.prototype.RDb=function(){this.ODb.setValue(this.tc.aT.selectedDate)},e.prototype.attachEvent=function(){this.XDb(),this.attachDateEvent(),this.tc.JK&&this.attachTimeEvent()},e.prototype.XDb=function(){var t=this;this.vDb.outterContainerDiv.addEventListener("keydown",(function(e){t.YDb(e)}))},e.prototype.YDb=function(t){return 9===t.keyCode?(this.tc.JK&&(this.tc.aT.calendarActivePart===V.Date?this.setCalendarActivePart(V.Time):this.setCalendarActivePart(V.Date)),void t.preventDefault()):void(this.tc.aT.calendarActivePart===V.Date&&this.ZDb(t))},e.prototype.ZDb=function(t){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.$Db(t);break;case l.CalendarPage.month:this._Db(t);break;case l.CalendarPage.day:this.aEb(t)}},e.prototype.$Db=function(t){var e=this.tc.aT,o=e.focusDate;switch(t.keyCode){case 13:e.selectedDate=new Date(o.valueOf()),this.showCalendarPage(l.CalendarPage.month);break;case 32:e.selectedDate=new Date(o.valueOf());break;case 37:this.bEb();break;case 39:this.cEb();break;case 38:this.bEb(4);break;case 40:t.ctrlKey||t.metaKey?this.dEb():this.cEb(4);break;case 36:o.setFullYear(e.focusDateYearRangeStart);break;case 35:o.setFullYear(e.focusDateYearRangeEnd);break;case 33:this.eEb();break;case 34:this.fEb()}e.updateYearRange(),this.QDb()},e.prototype._Db=function(t){var e=this.tc.aT,o=e.focusDate;switch(t.keyCode){case 13:e.selectedDate=new Date(o.valueOf()),this.showCalendarPage(l.CalendarPage.day);break;case 32:e.selectedDate=new Date(o.valueOf());break;case 37:this.gEb();break;case 39:this.hEb();break;case 38:t.ctrlKey||t.metaKey?this.iEb():this.gEb(4);break;case 40:t.ctrlKey||t.metaKey?this.jEb():this.hEb(4);break;case 36:o.setMonth(0);break;case 35:o.setMonth(11);break;case 33:this.bEb();break;case 34:this.cEb()}this.QDb()},e.prototype.aEb=function(t){var e=this.tc.aT,o=e.focusDate,n=o.getFullYear(),r=o.getMonth(),i=o.getDate(),a=J.getMonthMaxDay(n,r+1);switch(t.keyCode){case 13:return e.selectedDate=new Date(o.valueOf()),void this.lEb();case 32:e.selectedDate=new Date(o.valueOf());break;case 37:o.setDate(i-1);break;case 39:o.setDate(i+1);break;case 38:o.setDate(i-7);break;case 40:o.setDate(i+7);break;case 36:o.setDate(1);break;case 35:o.setDate(a);break;case 33:t.shiftKey?this.gEb(12):this.gEb();break;case 34:t.shiftKey?this.hEb(12):this.hEb()}e.selectedDate=new Date(o.valueOf()),this.QDb()},e.prototype.attachDateEvent=function(){var t=this;this.vDb.dateContainerDiv.addEventListener("click",(function(e){var o=e.target;(!o||o!==t.vDb.calendarDaySection.yearSelect&&o.parentElement!==t.vDb.calendarDaySection.yearSelect)&&t.setCalendarActivePart(V.Date)})),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},e.prototype.attachYearEvent=function(){var t=this;this.vDb.calendarYearSection.lastYearRangeButton.addEventListener("click",(function(e){t.eEb(),t.QDb()})),this.vDb.calendarYearSection.nextYearRangeButton.addEventListener("click",(function(e){t.fEb(),t.QDb()})),this.vDb.calendarYearSection.currentYearRangeTable.addEventListener("click",(function(e){t.mEb(e)}))},e.prototype.eEb=function(){var t=this.tc.aT;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},e.prototype.fEb=function(){var t=this.tc.aT;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},e.prototype.dEb=function(){this.showCalendarPage(l.CalendarPage.month)},e.prototype.mEb=function(t){var e,o,n=t.srcElement||t.target;n&&(e=+n.getAttribute(L),o=this.tc.aT.yearItems[e],this.tc.aT.focusDate.setFullYear(o.year),this.dEb())},e.prototype.attachMonthEvent=function(){var t=this;this.vDb.calendarMonthSection.lastYearButton.addEventListener("click",(function(e){t.bEb(),t.QDb()})),this.vDb.calendarMonthSection.nextYearButton.addEventListener("click",(function(e){t.cEb(),t.QDb()})),this.vDb.calendarMonthSection.currentYearName.addEventListener("click",(function(e){t.iEb()})),this.vDb.calendarMonthSection.currentYearTable.addEventListener("click",(function(e){t.nEb(e)}))},e.prototype.bEb=function(t){var e=t||1,o=Math.max(this.tc.aT.focusDate.getFullYear()-e,0);this.tc.aT.focusDate.setFullYear(o)},e.prototype.cEb=function(t){var e=t||1,o=Math.min(this.tc.aT.focusDate.getFullYear()+e,9999);this.tc.aT.focusDate.setFullYear(o)},e.prototype.iEb=function(){this.tc.aT.updateYearRange(),this.showCalendarPage(l.CalendarPage.year)},e.prototype.jEb=function(){this.showCalendarPage(l.CalendarPage.day)},e.prototype.nEb=function(t){var e,o=t.srcElement||t.target;o&&(e=+o.getAttribute(G),this.tc.aT.focusDate.setMonth(e-1),this.jEb())},e.prototype.attachDayEvent=function(){var t=this,e=this.vDb.calendarDaySection;e.lastMonthButton.addEventListener("click",(function(e){t.gEb(),t.uDb||t.QDb()})),e.nextMonthButton.addEventListener("click",(function(e){t.hEb(),t.uDb||t.QDb()})),e.currentMonthName.addEventListener("click",(function(e){t.oEb()})),e.todayTable.addEventListener("click",(function(e){t.pEb()})),e.dayContentTable.addEventListener("click",(function(e){t.qEb(e)})),e.yearSelect.addEventListener("change",(function(e){t.rEb(e)})),this.vDb.calendarDaySection.yearSelect.addEventListener("keydown",(function(t){t.stopPropagation()}))},e.prototype.gEb=function(t){var e,o,n=this.tc.aT,r=t||1,i=n.focusDate.getFullYear(),a=n.focusDate.getMonth()-r,s=n.focusDate.getDate();a<0&&(a+=12,i-=1),e=J.getMonthMaxDay(i,a+1),o=new Date(i,a,Math.min(s,e)),n.focusDate=o},e.prototype.hEb=function(t){var e,o,n=this.tc.aT,r=t||1,i=n.focusDate.getFullYear(),a=n.focusDate.getMonth()+r,s=n.focusDate.getDate();a>11&&(a-=12,i+=1),e=J.getMonthMaxDay(i,a+1),o=new Date(i,a,Math.min(s,e),n.focusDate.getHours(),n.focusDate.getMinutes(),n.focusDate.getSeconds()),n.focusDate=o},e.prototype.oEb=function(){this.showCalendarPage(l.CalendarPage.month)},e.prototype.qEb=function(t){var e,o,n,r,i=this.tc.aT,a=t.srcElement||t.target;a&&(e=a.getAttribute(_),o=i.dayItems[+e].date,r=(n=i.selectedDate)?new Date(n.valueOf()):new Date,i.selectedDate=new Date(o.getFullYear(),o.getMonth(),o.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.QDb(),this.tc.JK||this.lEb()),this.vDb.dateContainerDiv.focus()},e.prototype.pEb=function(){var t=this.tc,e=t.aT.selectedDate,o=e?new Date(e.valueOf()):null,n=new Date;o&&(n.setHours(o.getHours()),n.setMinutes(o.getMinutes()),n.setSeconds(0)),t.aT.selectedDate=n,t.aT.focusDate=new Date(n.valueOf()),this.QDb(),t.JK||this.lEb()},e.prototype.rEb=function(t){var e=t.srcElement||t.target;e&&(this.tc.aT.focusDate.setFullYear(+e.value),this.updateCalendarDom())},e.prototype.attachTimeEvent=function(){var t=this;this.vDb.timeContainerDiv.addEventListener("click",(function(e){t.setCalendarActivePart(V.Time)})),this.vDb.okButton.addEventListener("click",(function(e){t.lEb()}))},e.prototype.PDb=function(t){var e=this.tc.aT,o=e.selectedDate?new Date(e.selectedDate.valueOf()):new Date,n=t.value;o.setHours(n.getHours()),o.setMinutes(n.getMinutes()),o.setSeconds(n.getSeconds()),e.selectedDate=o,e.focusDate=new Date(o.valueOf())},e.prototype.lEb=function(){var t=this.tc.aT;this.fire(i.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},e.prototype.showCalendarPage=function(t){var e=this.host.querySelector("."+g),o=this.host.querySelector("."+m),n=this.host.querySelector("."+y);switch(e.style.display="none",o.style.display="none",n.style.display="none",t){case l.CalendarPage.year:e.style.display="";break;case l.CalendarPage.month:o.style.display="";break;case l.CalendarPage.day:n.style.display=""}this.tc.aT.calendarPage=t,this.updateCalendarDom()},e.prototype.setCalendarActivePart=function(t){switch(this.tc.aT.calendarActivePart=t,this.vDb.dateContainerDiv.classList.remove(x),this.tc.JK&&this.vDb.timeContainerDiv.classList.remove(x),t){case V.Date:this.tc.JK&&this.vDb.dateContainerDiv.classList.add(x),this.vDb.outterContainerDiv.focus();break;case V.Time:this.tc.JK&&this.vDb.timeContainerDiv.classList.add(x),this.vDb.outterContainerDiv.focus()}},e.Event_GetHost="GetHost",e}(n.EventBase),$=function(t){function e(e,o){var n=t.call(this,e)||this;return n.rDb=7,n.JK=!0,n.aT=new K(n),n.yl=new Q(n),n.yl.on(i.BaseDropdown.Event_ValueChanged,(function(t){var e=(new s.Common.CultureInfo).DateTimeFormat,o=new s.Formatter.GeneralFormatter(e.defaultDatePattern).format(t.newValue);n.fire(i.BaseDropdown.Event_ValueChanged,{text:o,value:t.newValue})})),n.yl.on(Q.Event_GetHost,(function(t){t.host=n.qo})),n.yl.createCalendarDom(),n.yl.attachEvent(),n.setValue(new Date),n.yl.showCalendarPage(l.CalendarPage.day),n.yl.setCalendarActivePart(V.Date),o&&n.setOptions(o),n}return tt(e,t),e.prototype.setOptions=function(t){var e,o;t&&(t.showTime||(this.JK=t.showTime,this.yl.createCalendarDom(),this.yl.attachEvent()),e=t&&t.calendarPage?t.calendarPage:l.CalendarPage.day,(o=t&&t.startDay?t.startDay:l.CalendarStartDay.saturday)!==this.rDb&&(this.rDb=o,this.qo.innerHTML="",this.yl.createCalendarDom(),this.yl.attachEvent()),this.yl.showCalendarPage(e),this.yl.setCalendarActivePart(V.Date))},e.prototype.setValue=function(t){var e=this.aT;e.selectedDate=t,e.oldSelectedData=new Date(t.valueOf()),e.focusDate=new Date(t.valueOf()),e.updateYearRange()},e.prototype.scrollToSelect=function(){this.yl.updateCalendarDom()},e}(i.BaseDropdown),e.Calendar=$},"./dist/plugins/celltype/editor/colorpicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/listControl.js"),r=o("Core"),i=o("./dist/plugins/celltype/editor/baseControl.js"),a=o("./dist/plugins/celltype/celltypes.ns.js"),s=o("Common"),l=s.Common.j.Fa,u="group-name",c=new s.Common.ResourceManager(a.SR),f=c.getResource.bind(c),h=function(t){function e(e,o){var n=t.call(this,e)||this;return n.ad(),n.setOptions(o),n}return p(e,t),e.prototype.setOptions=function(t){if(t){if(this.options=this.options||{},!l(t.colorBlockSize)){var e=parseInt(t.colorBlockSize,10);!isNaN(e)&&e>=0&&(this.options.colorBlockSize=t.colorBlockSize)}l(t.groups)||(this.options.groups=t.groups),this.VF()}else this.VF()},e.prototype.setValue=function(t){l(t)||(this.BYa=t,this.sEb=null,this.VF())},e.prototype.ad=function(){var t,o=this,n=e.DefaultColorGroup(),r=[];for(t=0;t<n.length;t++)r.push({name:n[t].name,colors:n[t].colors,needScaleColor:n[t].needScaleColor});this.options={colorBlockSize:e.DefaultCellWidth,groups:r},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-color-picker-outer-div"),this.tEb.addEventListener("click",(function(t){o.uEb(t)})),this.qo.appendChild(this.tEb)},e.prototype.VF=function(){this.tEb.innerHTML="",new n.List(this.tEb,this.vEb()),this.wEb()},e.prototype.wEb=function(){var t,e,o,n=this.tEb.querySelectorAll(".gc-color-picker-color-cell");if(n.length>0)for(t=0;t<n.length;t++)n[t].classList.remove("selected"),e=n[t].getAttribute("color"),o=n[t].getAttribute(u),this.BYa===e&&(!this.sEb||this.sEb&&this.sEb===o)&&n[t].classList.add("selected")},e.prototype.xEb=function(){var t,e,o,n,r=0,i=this.options.groups;for(t=0;t<i.length;t++)for(e=i[t],o=0;o<e.colors.length;o++)n=e.colors[o],r=Math.max(r,n.length);return r},e.prototype.vEb=function(){var t,o,n,r=[],i=this.options.colorBlockSize||e.DefaultCellWidth,a=this.xEb(),s=this.options.groups;for(t=0;t<s.length;t++)o=this.yEb(s[t],i,a),r.push(o),s[t].needScaleColor&&(n=this.zEb(s[t].colors[0]),r.push(this.yEb(n,i,a)));return{items:r}},e.prototype.zEb=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d={},g=[];g.length=5,e=[-5,-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],n=[80,60,40,-25,-50],r=document.createElement("span"),i=t.length,r.style.display="none",document.body.appendChild(r);try{for(a=0;a<i;a++)for(l=(s=this.AEb(t[a],r))[0],u=s[1],c=s[2],f=this.BEb(l,u,c),h=0;h<5;h++)g[h]||((p=[]).length=i,g[h]=p),g[h][a]=1===f?this.CEb(l,u,c,e[h]):f>=.8?this.CEb(l,u,c,o[h]):0===f?this.CEb(l,u,c,Math.abs(e[5-h-1])):f<=.2?this.CEb(l,u,c,Math.abs(o[5-h-1])):this.CEb(l,u,c,n[h]);d.colors=g}finally{document.body.removeChild(r)}return d},e.prototype.AEb=function(t,e){var o;return e.style.color=t,o=window.getComputedStyle(e).color.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)]},e.prototype.CEb=function(t,e,o,n){var r,i,a;return n/=100,r=this.DEb(t,e,o),i=parseInt(""+(n>0?(240-r.luminosity)*n:r.luminosity*n),10),a=this.EEb(r.hue,r.luminosity+i,r.saturation),this.FEb(a.r,a.g,a.b)},e.prototype.GEb=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},e.prototype.FEb=function(t,e,o){return"#"+this.GEb(t)+this.GEb(e)+this.GEb(o)},e.prototype.EEb=function(t,e,o){var n,r,i,a,s;return 0===o?n=r=i=parseInt(""+255*e/240,10):(void 0,void 0,a=2*e-(s=e<=120?(e*(240+o)+120)/240:e+o-(e*o+120)/240),n=parseInt(""+(255*this.fc(a,s,t+80)+120)/240,10),r=parseInt(""+(255*this.fc(a,s,t)+120)/240,10),i=parseInt(""+(255*this.fc(a,s,t-80)+120)/240,10)),{a:255,r:n,g:r,b:i}},e.prototype.fc=function(t,e,o){return o<0&&(o+=240),o>240&&(o-=240),o<40?t+((e-t)*o+20)/40:o<120?e:o<160?t+((e-t)*(160-o)+20)/40:t},e.prototype.BEb=function(t,e,o){return this.DEb(t,e,o).luminosity/240},e.prototype.DEb=function(t,e,o){var n,r,i,a,s,l=Math.max(Math.max(t,e),o),u=Math.min(Math.min(t,e),o),c=l+u,f=parseInt(""+(240*c+255)/510,10),h=l-u;return 0===h?(n=0,r=160):(n=f<=120?parseInt(""+(240*h+c/2)/c,10):parseInt(""+(240*h+(510-c)/2)/(510-c),10),i=(40*(l-t)+h/2)/h,a=(40*(l-e)+h/2)/h,s=(40*(l-o)+h/2)/h,(r=t===l?parseInt(""+(s-a),10):e===l?parseInt(""+(80+i-s),10):parseInt(""+(160+a-i),10))<0&&(r+=240),r>240&&(r-=240)),{luminosity:f,saturation:n,hue:r}},e.prototype.yEb=function(t,e,o){var n=this,i={items:function(){var r,i,a,s,l,c=document.createElement("div");for(c.classList.add("gc-color-picker-group-row"),c.style.width=(e+7)*o+"px",r=0;r<t.colors.length;r++){for((i=document.createElement("div")).classList.add("gc-color-picker-color-row"),a=t.colors[r],s=0;s<a.length;s++)(l=document.createElement("div")).setAttribute(u,t.name),l.setAttribute("color",a[s]),l.style.backgroundColor=a[s],l.style.width=e+"px",l.style.height=e+"px",l.classList.add("gc-color-picker-color-cell"),n.BYa===a[s]&&n.sEb===t.name&&l.classList.add("selected"),i.appendChild(l);c.appendChild(i)}return c},layout:{direction:r.LayoutDirection.horizontal,displayAs:r.LayoutDisplayAs.inline}};return t.name&&(i.text=t.name),i},e.prototype.uEb=function(t){var e,o,n=t.srcElement||t.target;n&&(e=n.getAttribute("color"),o=n.getAttribute(u),e&&o&&(this.BYa=e,this.sEb=o,this.HEb(e),this.wEb()))},e.prototype.HEb=function(t){this.fire(i.BaseDropdown.Event_ValueChanged,{value:t,text:t})},e.DefaultCellWidth=10,e.DefaultColorGroup=function(){return[{name:f().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:f().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},e}(i.BaseDropdown),e.ColorPicker=h},"./dist/plugins/celltype/editor/eventbase.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.IEb={}}return t.prototype.on=function(t,e){var o=this.IEb[t];null!=o||(o=this.IEb[t]=[]),o.push(e)},t.prototype.off=function(t,e){var o,n;if(t){if(null==(o=this.IEb[t]))return;e?(n=o.indexOf(e),o.splice(n,1)):o=[],this.IEb[t]=o}else this.IEb={}},t.prototype.fire=function(t,e){var o=this,n=this.IEb[t];null!=n&&n.forEach((function(t){try{t.call(o,e)}catch(t){}}))},t}();e.EventBase=n},"./dist/plugins/celltype/editor/listControl.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function b(t){return u.createElement(t)}function w(t,e){return t.substring(0,e)+t.substring(e+1,t.length)}function T(t,e){if(i.Common.k.Bb(t,e))return!0;if(i.Common.l.Ska(e))for(var o=0;o<t.length;o++)if(t[o]-e==0)return!0;return!1}function S(t){if(t.hasOwnProperty("items"))S(t.items);else if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].hasOwnProperty("items")?S(t[e]):t[e].hasOwnProperty("text")&&!t[e].hasOwnProperty("value")&&(t[e].value=t[e].text);return t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/popupControl.js"),r=o("./dist/plugins/celltype/editor/baseControl.js"),i=o("Common"),a=o("Core"),s=i.Common.j.Fa,l=i.Common.k.Cb,u=document,c=function(){function t(){this.JEb=new WeakMap}return t.prototype.set=function(t,e,o){var n=this.JEb.get(t);n||this.JEb.set(t,n={}),n[e]=o},t.prototype.get=function(t,e){var o=this.JEb.get(t);return o&&o[e]},t.prototype.clear=function(){this.JEb=new WeakMap},t}(),f="gc-list-control-container",h="gc-list-control-item",p="gc-list-control-hassubitem",d="gc-list-control-selected-item",g="gc-list-control-subitem",m="hide-children",y="gc-list-control-tree-content",C=function(t){function e(e,o,n){var r=t.call(this,e)||this;return r.qo=b("div"),r.qo.classList.add("gc-list-control"),e.appendChild(r.qo),r.xn=new c,r.JJb=n&&n.JJb||{Qb:void 0},r.bHb={items:[],doms:[]},r.setOptions(o),r}return v(e,t),e.prototype.setOptions=function(t){s(t)||(this.$z=S(t),this.qo.innerHTML="",this.yl())},e.prototype.setValue=function(t){if(this.$z&&this.$z.multiSelect)if("string"==typeof t)t=function(t){var e,o,n,r,i;if(s(t)||0===t.length)return[];for(e=[],o=0,n=0;n<t.length;n++)"\\"===(r=t.charAt(n))?","!==(i=t.charAt(n+1))&&"\\"!==i||(t=w(t,n)):","===r&&(e.push(t.substring(o,n)),o=n+1);return e.push(t.substring(o,t.length)),e}(t);else if(s(t))t=[];else if(i.Common.j.Ca(t)){if(1!==this.$z.valueType){t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=""+t[e]}}else t=[t];this.JJb.Qb=t,this.KEb()},e.prototype.scrollToSelect=function(){},e.prototype.updateStyle=function(t,e,o){this.qo.style.font=o},e.prototype.yl=function(){var t=b("div");t.classList.add(f),this.SXa(t,this.$z),this.qo.appendChild(t),this.LXa()},e.prototype.SXa=function(t,e){if(e&&(this.LEb(t,e.layout),e.items))if(Array.isArray(e.items))this.MEb(t,e.items);else{var o=e.items();o instanceof HTMLElement&&(t.appendChild(o),t.classList.add(h),this.LEb(o,e.layout))}},e.prototype.LEb=function(t,e){e&&e.direction===a.LayoutDirection.horizontal?t.classList.add("gc-list-alignment-horizontal"):t.classList.add("gc-list-alignment-vertical")},e.prototype.MEb=function(t,e){var o,n,r,i,l,u,c,f,d,C,v=e.some((function(t){return!!t.icon}));for(o=0;o<e.length;o++)e[o].items?(n=e[o]).layout&&n.layout.displayAs===a.LayoutDisplayAs.inline?((r=b("div")).classList.add("gc-list-control-group"),(i=b("span")).innerText=n.text,(s(n.text)||""===n.text)&&i.classList.add(m),i.classList.add("gc-list-control-group-text"),r.appendChild(i),Array.isArray(n.items)?this.SXa(r,n):(l=n.items())instanceof HTMLElement&&((u=b("div")).classList.add(h),this.LEb(l,n.layout),u.appendChild(l),r.appendChild(u)),t.appendChild(r)):n.layout&&n.layout.displayAs===a.LayoutDisplayAs.tree?((c=b("div")).classList.add("gc-list-control-tree"),(f=b("div")).classList.add(h),f.classList.add(p),(i=b("span")).innerText=n.text,i.classList.add("gc-list-control-tree-text"),f.appendChild(i),n.layout.collapsible&&((d=b("span")).classList.add(g),f.appendChild(d),this.NEb(f)),c.appendChild(f),(C=b("div")).classList.add(y),Array.isArray(n.items)?this.SXa(C,n):(l=n.items())instanceof HTMLElement&&((u=b("div")).classList.add(h),this.LEb(l,n.layout),u.appendChild(l),C.appendChild(u)),c.appendChild(C),t.appendChild(c)):this.OEb(t,e[o],!1,!0):this.OEb(t,e[o],v)},e.prototype.OEb=function(t,e,o,n){var r,i,a,u,c,f,d;void 0===n&&(n=!1),(r=b("div")).classList.add(h),"-"===e.text?(r.classList.add("gc-list-control-noitem"),(i=b("div")).classList.add("gc-list-control-listseparator"),r.appendChild(i)):(o&&((a=b("div")).classList.add("gc-list-control-item-icon"),e.icon?a.style.backgroundImage="url("+e.icon+")":a.classList.add("gc-list-control-emptyicon"),r.appendChild(a)),(u=b("span")).classList.add("gc-list-control-item-text"),u.innerText=e.text,s(e.text)&&(u.innerText=s(e.value)?"":e.value),r.appendChild(u),c=s(e.value)?null:e.value,(f=l(this.bHb.items,c))<0&&(f=this.bHb.items.length,this.bHb.doms.push([]),this.bHb.items.push(c)),this.bHb.doms[f].push(r),this.xn.set(r,"items",e),n&&((d=b("span")).classList.add(g),r.classList.add(p),this.xn.set(r,"sub-items",e),r.appendChild(d),this.PEb(r))),t.appendChild(r)},e.prototype.CHb=function(t,e){var o,n=this.bHb.doms[t];if(e)for(o=0;o<n.length;o++)n[o].classList.contains(p)||n[o].classList.add(d);else for(o=0;o<n.length;o++)n[o].classList.contains(d)&&n[o].classList.remove(d)},e.prototype.KEb=function(){var t,e,o,n=this,r=n.$z;for(s(n.formula)?r&&r.multiSelect?t=n.JJb.Qb:t=[n.JJb.Qb]:t=["="+n.formula],e=0;e<n.bHb.items.length;e++)o=n.bHb.items[e],r&&r.multiSelect&&1!==r.valueType&&(o=""+o),T(t,o)?n.CHb(e,!0):n.CHb(e,!1)},e.prototype.LXa=function(){var t=this;this.qo.querySelector("."+f).addEventListener("click",(function(e){var o,n,a,l,u=t.QEb(e.target,"."+h);if(u){if(u.classList.contains(p))return void t.KJb(e);o=t.xn.get(u,"items"),n=t.$z,!o&&i.Common.j.Aa(n&&n.onItemSelected)&&(o={value:n.onItemSelected(e)}),s(o)||(a=o.value,n&&n.multiSelect&&(l=(l=t.JJb.Qb).slice(0),n.multiSelect&&1!==n.valueType&&(a=""+a),T(l,a)?function(t,e){var o,n=i.Common.l.Ska(e);for(o=t.length-1;o>=0;o--)(t[o]===e||n&&t[o]-e==0)&&t.splice(o,1)}(l,a):i.Common.k.Sb(l,a),t.JJb.Qb=a=l,t.KEb(),1!==n.valueType&&(a=function(t){var e,o,n=[];for(e=0;e<t.length;e++)(o=t[e])&&"string"==typeof o&&(o=o.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),n[e]=o;return n.join(",")}(a))),t.fire(r.BaseDropdown.Event_ValueChanged,{value:a,text:a,notCloseDropDown:n&&n.multiSelect,noAutoFormat:!0}))}}))},e.prototype.QEb=function(t,e){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),o=e.length;o>=0&&e.item(o)!==this;)--o;return o>-1});for(var o=t;o&&!o.matches(e);)o=o.parentElement;return o},e.prototype.KJb=function(t){var o,i,a,s,l,u=this,c=this.QEb(t.target,"."+h);c.classList.contains(p)&&((o=this.xn.get(c,"sub-items"))&&o.items&&(i=b("div"),a=this.$z,o.multiSelect=a&&a.multiSelect,o.valueType=a&&a.valueType,o.onItemSelected=a&&a.onItemSelected,(s=new e(i,o,this)).KEb(),(l=new n.PopupControl(i,c,{align:n.DropDownAlignment.Near,hostElement:c,direction:n.DropDownDirection.Right})).open(),i.parentElement.style.top="0",s.on(r.BaseDropdown.Event_ValueChanged,(function(t){u.fire(r.BaseDropdown.Event_ValueChanged,t),u.$z&&u.$z.multiSelect?u.KEb():l.close()})),this.xn.set(c,"sub-items-popup",l),t.stopPropagation(),t.preventDefault()))},e.prototype.PEb=function(t){var e=this;t.addEventListener("mouseenter",(function(t){e.KJb(t)})),t.addEventListener("mouseleave",(function(t){var o,n=t.target;n.classList.contains(p)&&((o=e.xn.get(n,"sub-items-popup"))&&(o.close(),e.xn.set(n,"sub-items-pop",void 0)))}))},e.prototype.NEb=function(t){var e=this;t.addEventListener("click",(function(t){var o=t.target,n=e.QEb(o,"."+p);n&&(n.parentElement.querySelector("."+y)&&(n.parentElement.classList.contains(m)?n.parentElement.classList.remove(m):n.parentElement.classList.add(m),t.stopPropagation(),t.preventDefault()))}))},e}(r.BaseDropdown),e.List=C},"./dist/plugins/celltype/editor/monthPicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function y(t){return u.createElement(t)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),r=o("./dist/plugins/celltype/celltypes.ns.js"),i=o("Common"),a=i.Common.j.Fa,s=new i.Common.ResourceManager(r.SR),l=s.getResource.bind(s),u=document,c="gc-month-picker-month-item",f="gc-month-picker-qtr-item",h="selected",p="data-month",d="data-qtr",g=function(t){function e(e,o){var n=t.call(this,e)||this;return n.setOptions(o),n.LXa(),n}return m(e,t),e.prototype.setOptions=function(t){var e,o,n,r=this,i=new Date,s={startYear:i.getFullYear()-10,stopYear:i.getFullYear(),height:300};t&&(a(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e)||(s.startYear=e)),!a(t.stopYear)&&t.stopYear>0&&(o=parseInt(t.stopYear,10),isNaN(o)||(s.stopYear=o)),s.stopYear<s.startYear&&(s.stopYear=t.startYear),a(t.height)||(n=parseInt(t.height,10),isNaN(n)||(s.height=n))),s.height=Math.max(1,s.height),r.$z=s,r.qo.innerHTML="",r.REb()},e.prototype.setValue=function(t){var e,o,n,r=this;t&&(e=t.getMonth()+1,o=t.getFullYear()),"number"==typeof e&&((n=r.qo.querySelector("["+p+"='"+o+"-"+e+"']"))&&(n.classList.add(h),r.SEb&&r.SEb.classList.remove(h),r.SEb=n))},e.prototype.scrollToSelect=function(){var t,e=this.SEb;e&&(t=e.offsetTop,this.qo.scrollTop=t)},e.prototype.TEb=function(t,e){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),o=e.length;o>=0&&e.item(o)!==this;)--o;return o>-1});for(var o=t;o&&!o.matches(e);)o=o.parentElement;return o},e.prototype.LXa=function(){var t=this;this.qo.addEventListener("click",(function(e){var o,r,a,s,l,u,g=t,m=g.TEb(e.target,"."+c+",."+f);m&&(m.getAttribute(d)||(m.classList.add(h),g.SEb&&g.SEb.classList.remove(h),g.SEb=m,o=null,null,r=null,m.getAttribute(p)&&(o=+(a=m.getAttribute(p).split("-"))[1],r=+a[0]),s=new Date(r,o-1,1,0,0,0,0),l=i.Common.CultureManager.q4().DateTimeFormat,u=new i.Formatter.GeneralFormatter(l.shortDatePattern).format(s),g.fire(n.BaseDropdown.Event_ValueChanged,{text:u,value:s})))}))},e.prototype.REb=function(){var t,e,o,n,r=this;for(this.$z.height>=0?r.qo.style.maxHeight=this.$z.height+"px":r.qo.style.height="auto",r.qo.classList.add("gc-month-picker-container"),t=r.$z.startYear;t<=r.$z.stopYear;t++)e=document.createElement("div"),r.UEb(e),(o=document.createElement("div")).classList.add("gc-month-picker-year-container"),r.VEb(t,o),(n=document.createElement("div")).classList.add("gc-month-picker-month-container"),r.WEb(t,1,n),r.WEb(t,2,n),r.WEb(t,3,n),r.WEb(t,4,n),e.appendChild(o),e.appendChild(n),this.qo.appendChild(e)},e.prototype.UEb=function(t){var e=y("div");e.classList.add("gc-month-picker-separator"),t.appendChild(e)},e.prototype.VEb=function(t,e){var o=y("div");o.classList.add("gc-month-picker-year-item"),o.innerText=""+t,e.appendChild(o)},e.prototype.WEb=function(t,e,o){var n=document.createElement("div"),r=y("div"),i=y("div"),a=y("div"),s=y("div");switch(r.classList.add(c),i.classList.add(c),a.classList.add(c),s.classList.add(f),e){case 1:r.innerText=l().Calendar_ShortMonths_1,r.setAttribute(p,t+"-1"),i.innerText=l().Calendar_ShortMonths_2,i.setAttribute(p,t+"-2"),a.innerText=l().Calendar_ShortMonths_3,a.setAttribute(p,t+"-3"),s.innerText=l().Quarter_Format_1,s.setAttribute(d,t+"-1");break;case 2:r.innerText=l().Calendar_ShortMonths_4,r.setAttribute(p,t+"-4"),i.innerText=l().Calendar_ShortMonths_5,i.setAttribute(p,t+"-5"),a.innerText=l().Calendar_ShortMonths_6,a.setAttribute(p,t+"-6"),s.innerText=l().Quarter_Format_2,s.setAttribute(d,t+"-2");break;case 3:r.innerText=l().Calendar_ShortMonths_7,r.setAttribute(p,t+"-7"),i.innerText=l().Calendar_ShortMonths_8,i.setAttribute(p,t+"-8"),a.innerText=l().Calendar_ShortMonths_9,a.setAttribute(p,t+"-9"),s.innerText=l().Quarter_Format_3,s.setAttribute(d,t+"-3");break;case 4:r.innerText=l().Calendar_ShortMonths_10,r.setAttribute(p,t+"-10"),i.innerText=l().Calendar_ShortMonths_11,i.setAttribute(p,t+"-11"),a.innerText=l().Calendar_ShortMonths_12,a.setAttribute(p,t+"-12"),s.innerText=l().Quarter_Format_4,s.setAttribute(d,t+"-4")}n.appendChild(r),n.appendChild(i),n.appendChild(a),n.appendChild(s),o.appendChild(n),e<4&&this.UEb(o)},e}(n.BaseDropdown),e.MonthPicker=g},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("SheetsCalc"),i=o("@grapecity/js-calc"),a=o("@grapecity/js-calc"),s=o("Common"),l=o("./dist/plugins/celltype/editor/baseControl.js"),u=o("./dist/plugins/celltype/editor/baseSpreadPicker.js"),c=o("./node_modules/util/util.js"),f=o("./dist/plugins/celltype/celltypes.ns.js"),h=new s.Common.ResourceManager(f.SR),p=h.getResource.bind(h),d=!!i,g=function(t){function e(e,o,n){return t.call(this,e,o,n)||this}return m(e,t),e.prototype.setOptions=function(e){var o,r,i,a,s,l,u;if(t.prototype.setOptions.call(this,e),(o=this).$z=e,e&&(r=o.Ngc,i=e.dataSource,a=e.bindingInfos,s=r.getActiveSheet(),i)){l=!0,function(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}(s),s.options.isProtected=!0,s.options.rowHeaderVisible=!1,s.selectionPolicy(n.SelectionPolicy.single),s.selectionUnit(n.SelectionUnit.row);try{o.Rgc(s,i,a)}catch(t){l=!1,o.dispose()}finally{l&&s&&((u=new n.Style).THb=!1,s.setStyle(-1,-1,u,n.SheetArea.viewport),function(t){t.resumeCalcService(),t.resumeEvent(),t.resumePaint()}(s))}}},e.prototype.setValue=function(e){var o,n,r=this;r.$z&&(t.prototype.setValue.call(this,e),o=r.Ngc.getActiveSheet(),n=r.Sgc(e),o.setSelection(n,-1,1,-1))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.Rgc=function(t,e,o){if(e){var n=this.Ugc(e);n&&(t.setDataSource(function(t,e){var o,n,r,i,a,s=t[0],l=[];if(c.isArray(s))for(o=t,n=function(t,e){var o=[];return e&&e.length>0?e.forEach((function(t){o.push(t.name)})):o=t.shift(),o}(t,e),r=function(t,e){var r=o[t],i={};n.forEach((function(t,e){i[t]=r[e]})),l.push(i)},i=0,a=o.length;i<a;i++)r(i);else l=t;return l}(n,o)),o&&t.bindColumns(o))}},e.prototype.Ugc=function(t){var e,o,i,s,l,u=t,f=this.Lgc;if(c.isString(u)){if(d){if(o=r.formulaToExpression(f,u),i=f.getCalcService().Hg(f.yj(),o,a.pf(0,0),!0),s=!1,l=void 0,(a.Convert.Fh(i)||a.Convert.Ca(i))&&((l=a.Convert.Ph(i,0,!1,!1,!1)).isError||l.isConvertError||(s=!0)),!s)throw Error(p().MultiColumn_InvalidDataSource);e=l}}else u instanceof n.Range?e=f.getArray(u.row,u.col,u.rowCount,u.colCount):c.isArray(u)?e=u:u.LLc&&(e=u.LLc);return e},e.prototype.Sgc=function(t){var e,o,n,r,i,a,s,l,u,f,h=0;if(t)if(e=this.Ngc.getActiveSheet(),n=(o=Object.keys(t)).length,i=(r=e.getDataSource()).length,a=!1,s=this.$z.key,c.isNullOrUndefined(s))for(l=0;l<i;l++){for(u=r[l],a=!0,f=0;f<n;f++)if(u[s=o[f]]!==t[s]&&void 0!==u[s]){a=!1;break}if(a){h=l;break}}else for(l=0;l<i;l++)if((u=r[l])[s]===t){h=l;break}return h},e.prototype.submitData=function(t){var e,o,n,r,i=t.sheet;t.isEsc?e={notSubmit:!0}:(o=i.getSelections()[0].row)>-1&&(n=i.getDataItem(o),r=this.$z.key,c.isNullOrUndefined(r)||(n=n[r]),e={value:n,text:n}),c.isNullOrUndefined(e)||this.fire(l.BaseDropdown.Event_ValueChanged,e)},e}(u.BaseSpreadPicker),e.MultiColumn=g},"./dist/plugins/celltype/editor/popupControl.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Left=2]="Left",t[t.Right=3]="Right"}(r=e.DropDownDirection||(e.DropDownDirection={})),function(t){t[t.Near=0]="Near",t[t.Center=1]="Center",t[t.Far=2]="Far"}(i=e.DropDownAlignment||(e.DropDownAlignment={})),function(t){t[t.None=0]="None",t[t.Flip=1]="Flip",t[t.Slide=2]="Slide"}(a=e.DropDownAdjustment||(e.DropDownAdjustment={})),s=function(){function t(t,e,o,n){this.XHa=t,this.YHa=e,this.Vo=o,this._v=n}return t.CreateFromDom=function(e){return new t(e.left,e.top,e.width,e.height)},Object.defineProperty(t.prototype,"x",{get:function(){return this.XHa},set:function(t){this.XHa=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.YHa},set:function(t){this.YHa=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._v},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.XHa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.XHa+this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.YHa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.YHa+this._v},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Location",{get:function(){return{X:this.XHa,Y:this.YHa}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return{width:this.Vo,height:this._v}},enumerable:!0,configurable:!0}),t.prototype.Offset=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];1===e.length&&"number"==typeof e[0].X&&"number"==typeof e[0].X?(this.XHa+=e[0].X,this.YHa+=e[0].Y):2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&(this.XHa+=e[0],this.YHa+=e[1])},t}(),e.Rectangle=s,l="ribbon-dropdowngroup-popup",u=function(t){function e(e,o,n){var s=t.call(this,null)||this;return s.sourceElement=e,s.target=o,s.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:r.Down,align:i.Near,horAdj:a.Flip|a.Slide,verAdj:a.Flip|a.Slide},s.globalMousedownEventHandler=function(t){var e;if(s.cXa){for(e=t.target;e&&e!==s.sourceElement;)e=e.parentElement;e||(s.close(),t.stopPropagation(),t.preventDefault())}},s.windowResizeEventHandler=function(){s.cXa&&s.close()},s.$z=s.defaultOption,s.cXa=!1,n&&s.mergeOption(n),s.XEb=null===s.$z.hostElement||void 0===s.$z.hostElement||!(s.$z.hostElement instanceof HTMLElement),s}return c(e,t),e.prototype.open=function(){this.cXa||(this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.cXa=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},e.prototype.beforeOpen=function(){this.bindEvent()},e.prototype.dispose=function(){var t=this;this.$z.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.$z.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(e){document.removeEventListener(e,t.globalMousedownEventHandler,!0)}))),this.XEb?(this.sourceElement.classList.remove(l),this.sourceElement.style.display=this.YEb,this.sourceElement.style.position=this.xC):this.ZEb&&this.ZEb.parentNode&&(this.$z.hostElement.removeChild(this.ZEb),this.ZEb=null)},e.prototype.close=function(){this.cXa&&(this.cXa=!1,this.dispose(),this.fire("close"))},e.prototype.mergeOption=function(t){for(var e in t)void 0!==t[e]&&(this.$z[e]=t[e])},e.prototype.clearPosition=function(){this.$Eb.style.top=this.$Eb.style.bottom=this.$Eb.style.left=this.$Eb.style.right=""},e.prototype.calcPosition=function(){var t,e,o,n,r,i,a,l,u;t=this.target instanceof s?this.target:s.CreateFromDom(this.target.getBoundingClientRect()),e=new s(0,0,window.innerWidth,window.innerHeight),o=this.calculateDropDownLocation(e,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.$z.direction,this.$z.align,this.$z.horAdj,this.$z.verAdj),r=(n=this.$Eb.offsetParent).getBoundingClientRect(),i=n===document.body,a=document.documentElement,l=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),u=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),this.$Eb.style.left=o.X-(i?-l:r.left)+"px",this.$Eb.style.top=o.Y-(i?-u:r.top)+"px"},e.prototype.calculateDropDownLocation=function(t,e,o,n,l,u,c){var f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I={X:t.x,Y:t.y};switch(t.Offset(-I.X,-I.Y),e.Offset(-I.X,-I.Y),f=e.left,h=e.right,p=e.top,d=e.bottom,g=p,m=t.height-d,y=f,C=t.width-h,v=(c&a.Flip)===a.Flip,b=(u&a.Flip)===a.Flip,w=(c&a.Slide)===a.Slide,T=(u&a.Slide)===a.Slide,n){case r.Up:o.height>g&&v&&(n=r.Down);break;case r.Down:o.height>m&&v&&(n=r.Up);break;case r.Left:o.width>y&&b&&(n=r.Right);break;case r.Right:o.width>C&&b&&(n=r.Left)}switch(S=0,x=0,n){case r.Up:x=p-o.height;break;case r.Down:x=d;break;case r.Left:S=f-o.width;break;case r.Right:S=h}return n===r.Up||n===r.Down?l===i.Near?S=f:l===i.Center?S=f-(o.width-e.width)/2:l===i.Far&&(S=h-o.width):n!==r.Right&&n!==r.Left||(l===i.Near?x=p:l===i.Center?x=p-(o.height-e.height)/2:l===i.Far&&(x=d-o.height)),A=new s(S,x,o.width,o.height),T&&(A.width>t.width?A.x=0:(A.x=Math.max(A.x,0),A.x=Math.min(A.x,t.width-A.width))),w&&(A.height>t.height?A.y=0:(A.y=Math.max(A.y,0),A.y=Math.min(A.y,t.height-A.height))),A.Offset(I),A.Location},e.prototype.render=function(){this.XEb?(this.xC=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.YEb=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(l),this.$Eb=this.sourceElement):(this.ZEb=document.createElement("div"),this.ZEb.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.ZEb.classList.add(l),this.ZEb.appendChild(this.sourceElement),this.$z.hostElement.appendChild(this.ZEb),this.$Eb=this.ZEb)},e.prototype.bindEvent=function(){var t=this;this.$z.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(e){document.addEventListener(e,t.globalMousedownEventHandler,!0)}))),this.$z.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},e}(n.BaseControl),e.PopupControl=u},"./dist/plugins/celltype/editor/slider.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function C(t){var e=function(t){var e=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(Math.max(0,(e[1]||"").length-parseInt(e[2],10)))}(t||0),o=0;return e.indexOf(".")>=0&&(o=e.length-e.indexOf(".")-1),o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),r=o("Common"),i=o("Core"),a=r.Common.j.Fa,s=r.Common.u.Ob,l=null,u=function(){function t(){}return t.isEmpty=function(t){return void 0===t||t===l||""===t||Array.isArray(t)&&0===t.length},t.isEmptyObject=function(t){var e,o=!0;for(e in t)if(e){o=!1;break}return o},t.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},t.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},t.allKeys=function(e){var o,n=[];if(!t.isObject(e))return[];for(o in e)e.hasOwnProperty(o)&&n.push(o);return n},t.parseStyleObject=function(e){var o,n,r,i,a,s;if(!t.isObject(e))return"";for(o="",r=0,i=(n=t.allKeys(e)).length;r<i;r++)s=e[a=n[r]],o+=a.replace(/([A-Z])/g,"-$1").toLowerCase()+": "+s+"; ";return o.trim()},t.extend=function(e,o,n){var r,i,a,s,l;for(void 0===n&&(n={}),r=t.allKeys(e),a=0,s=(i=t.allKeys(o)).length;a<s;a++)n[l=i[a]]=o[l];for(a=0,s=r.length;a<s;a++)void 0===n[l=r[a]]&&(n[l]=e[l]);return n},t.noop=function(){},t.measureWidth=function(t,e){var o=0,n=document.createElement("span");n.classList.add(e);try{n.innerText=t,n.style.display="none",document.body.appendChild(n),o=i.GC$(n).width()}finally{document.body.removeChild(n)}return o},t}(),c=function(){function t(t,e){this.xo=e,this.vFb={},this.vFb=u.extend(this.vFb,t)}return t.prototype.render=function(){var t,e;return this.vFb.included?(t=this.wFb(),(e=this.xo.querySelector("."+this.vFb.className))===l&&((e=document.createElement("div")).classList.add(""+this.vFb.className),this.xo.appendChild(e)),void e.setAttribute("style",u.parseStyleObject(t))):l},t.prototype.setLength=function(t){this.vFb.length=t,this.render()},t.prototype.wFb=function(){return this.vFb.direction===i.LayoutDirection.vertical?{bottom:this.vFb.offset+"%",height:this.vFb.length+"%"}:{left:this.vFb.offset+"%",width:this.vFb.length+"%"}},t}(),f=function(){function t(t,e){this.xo=e,this.xFb={},this.xFb=u.extend(this.xFb,t)}return t.prototype.render=function(){var t,e,o,n,r=this.xo.querySelector("."+this.xFb.className);if(r===l){for((r=document.createElement("div")).className=""+this.xFb.className,e=0,o=(t=this.yFb()).length;e<o;e++)n=this.zFb(t[e]),r.appendChild(n);this.xo.appendChild(r)}},t.prototype.zFb=function(t){var e=document.createElement("span"),o=this.xFb.max-this.xFb.min,n=Math.abs(t-this.xFb.min)/o*100+"%",r=this.xFb.direction===i.LayoutDirection.vertical?{bottom:n}:{left:n};return e.classList.add(this.xFb.prefixCls+"-dot"),e.setAttribute("style",u.parseStyleObject(r)),e.setAttribute("key",""+t),e},t.prototype.yFb=function(){var t,e,o=Object.keys(this.xFb.marks).map((function(t){return+t}));if(o.sort((function(t,e){return t-e})),t=o,this.xFb.dots)for(e=this.xFb.min;e<=this.xFb.max;e+=this.xFb.step)-1===t.indexOf(e)&&t.push(e);return t},t}(),h=function(){function t(t,e){this.xo=t,this.AFb={},this.exb="",this.AFb=u.extend(this.AFb,e),this.exb='\n        <div class="'+this.AFb.prefixCls+"-tooltip "+this.AFb.prefixCls+'-tooltip-placement-top">\n            <div class="'+this.AFb.prefixCls+'-tooltip-content">\n                <div class="'+this.AFb.prefixCls+'-tooltip-arrow"></div>\n                <div class="'+this.AFb.prefixCls+'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        '}return t.prototype.render=function(t,e){var o,n,i,a,l;this.AFb.offset=t,o=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip"),n=new r.Formatter.GeneralFormatter(this.AFb.formatString).format(e),u.isEmpty(o)&&(i=s(n),this.exb=this.exb.replace(/{{value}}/,i),(a=document.createElement("div")).innerHTML=this.exb,this.xo.appendChild(a.firstElementChild),o=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip")),o.querySelector("."+this.AFb.prefixCls+"-tooltip-inner").textContent=n,l=this.BFb(n),o.setAttribute("style",u.parseStyleObject(l)),this.AFb.tooltipVisible?this.show():this.hide()},t.prototype.show=function(){var t=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");u.isEmpty(t)||(t.style.display="inline-block")},t.prototype.hide=function(){var t=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");u.isEmpty(t)||(t.style.display="none")},t.prototype.BFb=function(t){var e=u.measureWidth(t,this.AFb.prefixCls+"-tooltip");return e=0===e?12:e/2+4,this.AFb.direction===i.LayoutDirection.vertical?{left:"-"+e+"px",bottom:"calc("+this.AFb.offset+"% + 10px)"}:{top:"-28px",left:"calc("+this.AFb.offset+"% - "+(e+4)+"px)"}},t}(),p=function(){function t(t,e){this.xo=e,this.CFb={},this.DFb=!1,this.EFb=l,this.CFb=u.extend(this.CFb,t),this.EFb=new h(this.xo,this.FFb())}return t.prototype.render=function(){var t,e=this,o=this.GFb(),n=this.BFb(),r=this.CFb.tabIndex||0;(this.CFb.disabled||r===l)&&(r=l),(t=this.xo.querySelector("."+this.CFb.className))===l&&((t=document.createElement("div")).className=o,this.xo.appendChild(t),t.setAttribute("role","slider"),t.setAttribute("aria-valuemin",""+this.CFb.min),t.setAttribute("aria-valuemax",""+this.CFb.max),t.setAttribute("aria-valuenow",""+this.CFb.value),t.setAttribute("aria-disabled",this.CFb.disabled+""),t.addEventListener("blur",(function(){e.HFb(!1)})),t.addEventListener("mouseenter",(function(){e.EFb.show()})),t.addEventListener("keydown",(function(){e.HFb(!1)})),t.addEventListener("mousedown",(function(){t.focus(),e.EFb.show()})),document.addEventListener("mouseup",(function(){document.activeElement===t&&(e.HFb(!0),e.EFb.hide())}))),t.tabIndex=r,t.setAttribute("style",u.parseStyleObject(n))},t.prototype.setOffset=function(t,e){this.CFb.offset=t,this.render(),this.EFb.render(t,e)},t.prototype.HFb=function(t){this.DFb=t},t.prototype.GFb=function(){return this.DFb?this.CFb.className+" "+this.CFb.prefixCls+"-handle-click-focused":""+this.CFb.className},t.prototype.BFb=function(){return this.CFb.direction===i.LayoutDirection.vertical?{bottom:this.CFb.offset+"%"}:{left:this.CFb.offset+"%"}},t.prototype.FFb=function(){return{prefixCls:"gc-slider",tooltipVisible:this.CFb.tooltipVisible,direction:this.CFb.direction,offset:this.CFb.offset,formatString:this.CFb.formatString}},t}(),d=function(){function t(t,e){this.xo=e,this.IFb={},this.IFb=u.extend(this.IFb,t)}return t.prototype.render=function(){var t,e,o,n,r,i=this.xo.querySelector("."+this.IFb.className);if(i===l){for((i=document.createElement("div")).className=""+this.IFb.className,t=this.JFb(),this.LJb(t),e=0,o=t.length;e<o;e++)n=t[e],(r=this.KFb(n))!==l&&i.appendChild(r);this.xo.appendChild(i)}},t.prototype.LJb=function(t){var e,o,n,r;for(this.MJb=0,e=1,o=t.length;e<o;e++)(n=this.IFb.marks[t[0]])&&(r=u.measureWidth(n.label,this.IFb.className+"-text"),(!this.MJb||this.MJb<r)&&(this.MJb=r))},Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.MJb},enumerable:!0,configurable:!0}),t.prototype.JFb=function(){return u.allKeys(this.IFb.marks).sort((function(t,e){return t-e}))},t.prototype.KFb=function(t){var e,o,n,r,i=this,a=this.IFb.marks[t],c=u.isObject(a)?a.label:a;return u.isEmptyObject(c)?l:(e=this.IFb.className+"-text",o=this.LFb(t),n=u.extend(o,a.style),(r=document.createElement("span")).classList.add(e),r.setAttribute("style",u.parseStyleObject(n)),r.setAttribute("key",""+t),r.addEventListener("mousedown",(function(e){i.IFb.onClickLabel(e,t)})),r.innerHTML=s(c),r)},t.prototype.LFb=function(t){var e=this.IFb.max-this.IFb.min;return this.IFb.direction===i.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.IFb.min)/e*100+"%"}:{left:(t-this.IFb.min)/e*100+"%",transform:"translateX(-50%)"}},t}(),g=function(){function t(t,e,o,n){this.xo=t,this.MFb=e,this.NFb=o,this.$z=n,this.Tyb=l,this.OFb=l,this.Tyb=new f(this.PFb(),this.xo),this.OFb=new d(this.QFb(),this.xo)}return t.prototype.render=function(){var t=document.createElement("div");t.className=this.$z.prefixCls+"-rail",this.xo.appendChild(t),this.MFb.render(),this.Tyb.render(),this.NFb.render(),this.OFb.render(),this.OFb.maxWidth&&this.$z.direction===i.LayoutDirection.vertical&&(this.xo.style.paddingRight=this.OFb.maxWidth+"px")},t.prototype.calcValueByPosition=function(t){var e=t-this.RFb();return this.trimAlignValue(this.SFb(e))},t.prototype.trimAlignValue=function(t){return u.isEmpty(t)?l:this.TFb(t)},t.prototype.calcOffset=function(){return 100*(Math.max(this.$z.value-this.$z.min,0)/(this.$z.max-this.$z.min))},t.prototype.getKeyboardValueMutator=function(t){var e=this;switch(t.keyCode){case 38:case 39:return function(t){return e.calculateNextValue("increase",t)};case 40:case 37:return function(t){return e.calculateNextValue("decrease",t)};case 35:return function(t){return e.$z.max};case 36:return function(t){return e.$z.min}}},t.prototype.calculateNextValue=function(t,e){var o={increase:function(t,e){return t+e},decrease:function(t,e){return t-e}},n=Object.keys(this.$z.marks).indexOf(e+""),r=o[t](n,1),i=Object.keys(this.$z.marks)[r];return this.$z.step?o[t](e,this.$z.step):!u.isEmptyObject(this.$z.marks)&&this.$z.marks[i]?this.$z.marks[i]:e},t.prototype.TFb=function(t){var e=isFinite(this.UFb(t))?this.UFb(t):0;return this.$z.step===l?e:parseFloat(e.toFixed(this.Yrb()))},t.prototype.Yrb=function(){var t,e;if(a(this.$z.precision)){for(e in t=Math.max(C(this.$z.max),C(this.$z.min),C(this.$z.step)),this.$z.marks)t=Math.max(C(parseFloat(e)),t);this.$z.precision=t}return this.$z.precision},t.prototype.UFb=function(t){var e,o,n,r,i=Object.keys(this.$z.marks).map(parseFloat);return this.$z.step!==l&&(e=Math.ceil((this.$z.max-this.$z.min)/this.$z.step),o=Math.min((t-this.$z.min)/this.$z.step,e),n=Math.round(o)*this.$z.step+this.$z.min,i.push(Math.min(n,this.$z.max))),r=i.map((function(e){return Math.abs(t-e)})),i[r.indexOf(Math.min.apply(Math,r))]},t.prototype.PFb=function(){return{prefixCls:this.$z.prefixCls,className:this.$z.prefixCls+"-step",direction:this.$z.direction,marks:this.$z.marks,dots:this.$z.dots,step:this.$z.step,included:this.$z.included,max:this.$z.max,min:this.$z.min}},t.prototype.QFb=function(){var t=this;return{className:this.$z.prefixCls+"-mark",onClickLabel:this.$z.disabled?u.noop:function(e,o){t.VFb(e,o)},direction:this.$z.direction,marks:this.$z.marks,included:this.$z.included,max:this.$z.max,min:this.$z.min}},t.prototype.VFb=function(t,e){},t.prototype.RFb=function(){var t=this.xo.getBoundingClientRect();return this.$z.direction===i.LayoutDirection.vertical?t.top:t.left},t.prototype.WFb=function(){var t=this.xo.getBoundingClientRect();return this.$z.direction===i.LayoutDirection.vertical?t.height:t.width},t.prototype.SFb=function(t){var e=this.$z.min,o=this.$z.max,n=Math.abs(Math.max(t,0)/this.WFb());return this.$z.direction===i.LayoutDirection.vertical&&(n=Math.max(1-n,0)),n*(o-e)+e},t}(),m=function(t){function e(e,o){var r=t.call(this,e)||this;return r.MFb=l,r.NFb=l,r.XFb=l,r.YFb=function(t){u.pauseEvent(t),0===t.button&&(document.addEventListener("mouseup",r.ZFb,!1),document.addEventListener("pointerup",r.ZFb,!1),document.addEventListener("MSPointerUp",r.ZFb,!1),document.addEventListener("mousemove",r._Fb,!1),document.addEventListener("pointermove",r._Fb,!1),document.addEventListener("MSPointerMove",r._Fb,!1),r._Fb(t))},r._Fb=function(t){u.pauseEvent(t);var e=r.aGb(t);r.bGb!==e&&(r.setValue(e),r.$Fb.onChange(e))},r.ZFb=function(t){r._Fb(t),document.removeEventListener("mousemove",r._Fb),document.removeEventListener("mouseup",r.ZFb),document.removeEventListener("pointermove",r._Fb),document.removeEventListener("pointerup",r.ZFb),document.removeEventListener("MSPointerMove",r._Fb),document.removeEventListener("MSPointerUp",r.ZFb);var e=r.aGb(t);r.bGb=e,r.$Fb.onAfterChange(r.$Fb.value),r.fire(n.BaseDropdown.Event_ValueChanged,{value:e,text:""+e,notCloseDropDown:!0}),u.pauseEvent(t)},r.cGb=function(t){u.pauseEvent(t);var e=t.target||t.srcElement;document.addEventListener("touchend",r.dGb,!1),e.classList.contains(r.$Fb.prefixCls+"-handle")?document.addEventListener("touchmove",r.eGb,!1):r.eGb(t)},r.eGb=function(t){var e,o;u.pauseEvent(t),e=t.targetTouches[0],o=r.aGb(e),r.bGb!==o&&(r.setValue(o),r.$Fb.onChange(o))},r.dGb=function(t){var e,o;document.removeEventListener("touchmove",r.eGb),document.removeEventListener("touchend",r.dGb),e=t.changedTouches[0],o=r.aGb(e),r.bGb=o,r.$Fb.onAfterChange(r.$Fb.value),r.fire(n.BaseDropdown.Event_ValueChanged,{value:o,text:""+o,notCloseDropDown:!0}),u.pauseEvent(t)},r.init(o),r}return y(e,t),e.prototype.setValue=function(t){if(!this.$Fb.disabled){var e=parseFloat(t);isNaN(e)?e=this.$Fb.min:(e=Math.max(this.$Fb.min,e),e=Math.min(this.$Fb.max,e)),this.$Fb.value=e,this.bGb=this.$Fb.value,this.MFb.setLength(this.calcOffset()),this.NFb.setOffset(this.calcOffset(),e)}},e.prototype.calcOffset=function(){var t=Math.max(this.$Fb.value-this.$Fb.min,0)/(this.$Fb.max-this.$Fb.min);return 100*(t=Math.min(t,1))},e.prototype.setOptions=function(t){this.init(t)},e.prototype.init=function(t){var e,o;this.fGb(t),this.gGb(),this.qo.innerHTML="",(e=document.createElement("div")).className="gc-slider-container",this.qo.appendChild(e),this.$Fb.direction===i.LayoutDirection.vertical?(e.classList.add(this.$Fb.prefixCls+"-vertical"),e.style.height=this.$Fb.height+"px"):e.style.width=this.$Fb.width+"px",(o=document.createElement("div")).className=this.GFb(),e.appendChild(o),this.MFb=new c(this.hGb(),o),this.NFb=new p(this.iGb(),o),this.XFb=new g(o,this.MFb,this.NFb,this.jGb()),this.XFb.render(),this.QQ(o)},e.prototype.QQ=function(t){var e=this;this.$Fb.disabled||(t.addEventListener("mousedown",this.YFb),t.addEventListener("pointerdown",this.YFb),t.addEventListener("MSPointerDown",this.YFb),t.addEventListener("touchstart",this.cGb),t.addEventListener("keyup",(function(t){var o,r,i;if(u.pauseEvent(t),o=e.XFb.getKeyboardValueMutator(t),!u.isEmpty(o)){if(r=o(e.$Fb.value),(i=e.XFb.trimAlignValue(r))===e.$Fb.value)return;e.setValue(i),e.$Fb.onChange(i),e.$Fb.onAfterChange(i),e.fire(n.BaseDropdown.Event_ValueChanged,{value:i,text:""+i,notCloseDropDown:!0})}})))},e.prototype.aGb=function(t){return this.$Fb.direction===i.LayoutDirection.vertical?this.XFb.calcValueByPosition(t.clientY):this.XFb.calcValueByPosition(t.clientX)},e.prototype.sYa=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:i.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General"}},e.prototype.gGb=function(){(u.isEmpty(this.$Fb)||u.isEmptyObject(this.$Fb))&&(this.$Fb={}),this.$Fb=u.extend(this.sYa(),this.$Fb)},e.prototype.fGb=function(t){var e=this;t&&(a(t.scaleVisible)||(this.$Fb.dots=t.scaleVisible),a(t.direction)||(this.$Fb.direction=t.direction),a(t.formatString)||(this.$Fb.formatString=t.formatString),this.kGb(t.min,"min"),this.kGb(t.max,"max"),this.kGb(t.step,"step"),this.kGb(t.width,"width"),this.kGb(t.height,"height"),this.$Fb.step<=0&&(this.$Fb.step=1),this.$Fb.min>this.$Fb.max&&(this.$Fb.max=this.$Fb.min),a(t.tooltipVisible)||(this.$Fb.tooltipVisible=t.tooltipVisible),this.$Fb.marks={},t.marks&&t.marks.forEach((function(t){var o,n=parseFloat(t);isNaN(n)||n>=e.$Fb.min&&n<=e.$Fb.max&&(o=new r.Formatter.GeneralFormatter(e.$Fb.formatString),e.$Fb.marks[n]={label:o.format(n)})})))},e.prototype.kGb=function(t,e){if(!a(t)){var o=parseFloat(t);isNaN(o)||(this.$Fb[e]=o)}},e.prototype.hGb=function(){return{className:this.$Fb.prefixCls+"-track",included:this.$Fb.included,direction:this.$Fb.direction,offset:0,length:0}},e.prototype.iGb=function(){return{prefixCls:this.$Fb.prefixCls,className:this.$Fb.prefixCls+"-handle",direction:this.$Fb.direction,disabled:this.$Fb.disabled,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,offset:0,tabIndex:0,tooltipVisible:this.$Fb.tooltipVisible,formatString:this.$Fb.formatString}},e.prototype.jGb=function(){return{prefixCls:this.$Fb.prefixCls,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,disabled:this.$Fb.disabled,direction:this.$Fb.direction,dots:this.$Fb.dots,step:this.$Fb.step,included:this.$Fb.included,marks:this.$Fb.marks}},e.prototype.GFb=function(){var t=""+this.$Fb.prefixCls;return this.$Fb.direction===i.LayoutDirection.vertical&&(t+="  "+this.$Fb.prefixCls+"-vertical"),u.isEmptyObject(this.$Fb.marks)||(t+=" "+this.$Fb.prefixCls+"-with-marks"),this.$Fb.disabled&&(t+=" "+this.$Fb.prefixCls+"-disabled"),t},e}(n.BaseDropdown),e.Slider=m},"./dist/plugins/celltype/editor/timepicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/listControl.js"),r=o("./dist/plugins/celltype/editor/baseControl.js"),i="undefined",a=o("Common"),s=a.Common.j.Fa,l=function(t){function e(e,o){var n=t.call(this,e)||this;return n.ad(),n.setOptions(o),n}return u(e,t),e.prototype.setOptions=function(t){var e,o,n,r;return t?(null!==(e=this.pGb(t.min))&&(this.$z.min=e),null!==(o=this.pGb(t.max))&&(this.$z.max=o),null!==(n=this.pGb(t.step))&&(this.$z.step=n),s(t.formatString)||(this.$z.formatString=t.formatString),s(t.height)||(r=parseInt(t.height,10),isNaN(r)||(this.$z.height=r)),this.$z.height=Math.max(1,this.$z.height),void this.VF()):void this.VF()},e.prototype.setValue=function(t){void 0!==t&&(this.KEb={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.cHb=t,this.wEb(),this.scrollToSelect())},e.prototype.scrollToSelect=function(){var t,e=this.tEb.querySelector(".selected");null!==e&&(t=e.offsetTop,this.xo.scrollTop=t)},e.prototype.ad=function(){var t=this;this.$z={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-time-picker-outer-div"),this.tEb.addEventListener("click",(function(e){t.uEb(e)})),this.qo.appendChild(this.tEb)},e.prototype.pGb=function(t){var e,o,n,r=null;return s(t)||(r={},s(t.hour)||(e=parseInt(t.hour,10),isNaN(e)||(r.hour=e)),s(t.minute)||(o=parseInt(t.minute,10),isNaN(o)||(r.minute=o)),s(t.second)||(n=parseInt(t.second,10),isNaN(n)||(r.second=n))),r},e.prototype.VF=function(){this.tEb.innerHTML="",new n.List(this.tEb,this.qGb()),this.wEb()},e.prototype.wEb=function(){var t,e,o,n,r=this.tEb.querySelectorAll(".gc-time-picker-li");if(r.length>0)for(t=0;t<r.length;t++)r[t].classList.remove("selected"),e=+r[t].getAttribute("hour"),o=+r[t].getAttribute("minute"),n=+r[t].getAttribute("second"),this.rGb(this.KEb,{hour:e,minute:o,second:n})&&r[t].classList.add("selected")},e.prototype.qGb=function(){var t=this;return{items:function(){var e,o,n=t.sGb(),r=document.createElement("div");for(r.classList.add("gc-time-picker-container"),t.xo=r,t.$z.height<0?r.style.height="auto":r.style.maxHeight=t.$z.height+"px",(e=document.createElement("ul")).classList.add("gc-time-picker-ul"),o=0;o<n.length;o++)e.appendChild(t.tGb(n[o]));return 24*n.length>t.$z.height&&t.$z.height>=0?r.style.overflowY="scroll":r.style.overflowY="hidden",r.appendChild(e),r}}},e.prototype.tGb=function(t){var e=document.createElement("li");return e.classList.add("gc-time-picker-li"),e.setAttribute("hour",""+t.hour),e.setAttribute("minute",""+t.minute),e.setAttribute("second",""+t.second),e.innerText=this.uGb(t),e},e.prototype.sGb=function(){for(var t=this.vGb(this.$z.min),e=this.vGb(this.$z.max),o=[];t<=e;)o.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.wGb(t,this.$z.step);return o},e.prototype.wGb=function(t,e){return typeof e.hour!==i&&t.setHours(t.getHours()+e.hour),typeof e.minute!==i&&t.setMinutes(t.getMinutes()+e.minute),typeof e.second!==i&&t.setSeconds(t.getSeconds()+e.second),t},e.prototype.uGb=function(t){var e,o=new Date;return o.setHours(t.hour),o.setMinutes(t.minute),o.setSeconds(t.second),(e=new a.Formatter.GeneralFormatter(this.$z.formatString).format(o))&&""!==e&&null!==e?e:this.xGb(o)},e.prototype.xGb=function(t){var e=t.getHours(),o=t.getMinutes();return(e<12?"AM":"PM")+" "+(0===e||12===e?"12":""+e%12)+":"+(o<10?"0"+o:""+o)},e.prototype.vGb=function(t){var e=new Date;return e.setHours(t.hour||0),e.setMinutes(t.minute||0),e.setSeconds(t.second||0),e},e.prototype.rGb=function(t,e){return!(!t||!e)&&(t=this.yGb(t),e=this.yGb(e),t.hour===e.hour&&t.minute===e.minute&&t.second===e.second)},e.prototype.yGb=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},e.prototype.uEb=function(t){var e,o,n,i,s,l,u=t.target;u&&(e=+u.getAttribute("hour"),o=+u.getAttribute("minute"),n=+u.getAttribute("second"),(i=this.cHb||new Date).setHours(e),i.setMinutes(o),i.setSeconds(n),i.setMilliseconds(0),s=(new a.Common.CultureInfo).DateTimeFormat,l=new a.Formatter.GeneralFormatter(s.defaultDatePattern).format(i),this.fire(r.BaseDropdown.Event_ValueChanged,{value:i,text:l}),this.KEb={hour:e,minute:o,second:n},this.wEb())},e}(r.BaseDropdown),e.TimePicker=l},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,e,o){"use strict";var n,r,i,a,s,l=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/celltype/editor/baseControl.js"),r=o("./dist/plugins/celltype/editor/listControl.js"),i=o("Common"),a=i.Common.j.Fa,s=function(t){function e(e,o){var i=t.call(this,e)||this;return i.FP=new r.List(e),i.FP.on(n.BaseDropdown.Event_ValueChanged,(function(t){i.fire(n.BaseDropdown.Event_ValueChanged,t)})),i.setOptions(o),i}return l(e,t),e.prototype.setOptions=function(t){this.$z=t},e.prototype.setValue=function(t){if(this.$z){var e=function(t,e){var o,n,r,i={items:[]},s=t.items,l=s.filter((function(t){return t.value===e}))[0];if(a(l)&&s&&s.length>0)o=i.items,o.push({text:s[0].value,value:s[0].value});else if(l&&l.transitions&&l.transitions.length>0)for(n=function(t){var e,o=l.transitions[t];"number"==typeof o&&s[o]&&(o=s[o].value),e=s.filter((function(t){return t.value===o}))[0],e&&i.items.push({text:e.value,value:e.value})},r=0;r<l.transitions.length;r++)n(r);return i}(this.$z,t);this.FP.setOptions(e)}},e.prototype.updateStyle=function(t,e,o){this.FP.updateStyle(t,e,o)},e}(n.BaseDropdown),e.WorkFlow=s},"./dist/plugins/celltype/hyperlinkcelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function M(t,e,o,n,r,i){var a=0,s=0,l=t.width,u=t.height;return a=i=i||0,1===n?a=(l-e)/2:2===n&&(a=l-e-i),1===r?s=(u-o)/2:2===r&&(s=u-o),{x:a,y:s}}function k(t,e,o,n){var r=O(t,o),i=r.width;return i+=1==(1!==e&&!u(n))?n:0,r.width=i,r}function N(t,e,o,n,r,i){var a=O(t,n),s=M(r,a.width,a.height,e,o,i);return a.x=s.x,a.y=s.y,a}function O(t,e){var o=f(e);return{x:0,y:0,width:Math.max(0,r.Vn.Xn(t,e,!0)),height:t.split(/\r\n|\r|\n/).length*o}}function D(t,e,o,n,i,a){var s,l,c,f,h,p,d,g,m,y,v,b=i.sheet,w=b.yl;if(u(o))return!1;if(a||(s=b.getValue(i.row,i.col,i.sheetArea),u(s)||(a=s+"")),!a)return!1;for(n=o.cellType.f5(n,o,b.zoom()),a=a.replace(/\s+/g," "),l=o&&o.font?o.font:w.Bl(),l=w.Cl(l),c=[a],f=F(o),o.wordWrap&&(a=(c=r.Vn.Wn(a,n.width-3-f,l)).join("\r\n")),h=N(a,o.hAlign,o.vAlign,l,n,f),p=n.y+h.y,d=0;d<c.length;d++)if(g=N(c[d],o.hAlign,o.vAlign,l,n,f),m=n.x+g.x,y=C(m+g.width,n.x+n.width),p=C((v=p)+g.height,n.y+n.height),m<=t&&t<y&&v<=e&&e<p)return!0;return!1}function F(t){return 8*(t.textIndent||0)}function E(t,e,o,n,i){var s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T=n&&n.sheet;if(T){if(u=T.yl,c=e.font||u.Bl(),o>1&&(c=u.Cl(c)),f=F(e),e.wordWrap||i){if(e.wordWrap){if(h=n.row,p=n.col,d=n.sheetArea,g=0,m=T.ITa.findSpan(h,p,d)){if(m.row>=h&&m.rowCount<=1&&m.col>=p&&p===m.col&&(g=T.Tl(p),m.colCount>1))for(y=p+1;y<p+m.colCount;y++)g+=T.Tl(y)}else g=T.Tl(p);if(s=a(e,1),(l=a(e,3))>0&&(g-=l),s>0&&(g-=s),C=r.Vn.Wn(t,g-3-f,c),i&&t.split(/\r\n|\r|\n/).length>1){for(v=0,b=0;b<C.length;b++)v=Math.max(v,k(C[b],e.hAlign,c,F(e)).width);return v}i||(t=C.join("\r\n"))}}else t=t.replace(/\s+/g," ");return w=k(t,e.hAlign,c,F(e)),i?w.width:w.height}return 0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),i=(r=o("Core")).CellTypes.Context,a=i.u5,s=r.CellTypes.Base,l=r.Ul.Nl,u=n.Common.j.Fa,c=n.Common.u.BIc,f=r.Ul.fp,h=r.Ul.Ml,p=h.mozilla,d=r.GC$,g=d.each,m=null,y=Math.max,C=Math.min,v=Math.floor,b=window.open,w="left",T="default",S="hyperlinkInfo",function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(x=e.HyperLinkTargetType||(e.HyperLinkTargetType={})),A={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},I=function(t){function e(){var e,o=t.call(this)||this;return o.typeName="8",e=o,o._id=o.wK(),g(A,(function(t,o){e["_"+t]=o})),o._onAction=function(t){var e=t&&t.sheet,o=t.row,n=t.col,r=t.sheetArea,i=e.getValue(o,n,r),a=function(t){return["_blank","_self","_parent","_top"][t]}(this._target);i&&b(c(i),a)},o}return R(e,t),e.prototype.wK=function(){var t,e;return u(this._id)&&(this._id="0"),e="id_"+(t=parseInt(this._id,10)),t++,this._id=t+"",e},e.prototype.Eka=function(t,e,o,n,r,i,a,s,l,u){var c,f,d,g,m,y,C,b,T,S=1,x=w,A=a.hAlign,I=a.vAlign,R=s.lineHeight,M=l.length;for(S+=e,1===A?(S=r/2,x="center"):2===A&&(S=r-1,S-=e,x="right"),t.textAlign!==x&&(t.textAlign=x),c=1,f="alphabetic",c+=R-(m=R/2-(d=parseInt(s.fontInfo.fontSize,10))/2+(g=d>8?v((d-8)/5+2):1)-1),1===I?R<i&&(c=p?(i-u)/2+1:h.msie?(i-u)/2+.5:(i-u)/2,v(c)!==c&&(c+=.5),c+=R/2-m):2===I&&(c=i-u-2.5-m),t.textBaseline!==f&&(t.textBaseline=f),y=n+c,C=0;C<M;C++)t.fillText(l[C],o+S,y),b=t.measureText(l[C]).width,(T=a.textDecoration)&&this.ip(t,T,o+S,y,b,d,g),y+=R},e.prototype.Fka=function(t,e,o,n,i,a,s,l,u){var c,f,h,p,d,g,m,C=s.hAlign,b=s.vAlign,w=l.lineHeight,T=u.length,S=0,x=0,A=0,I=0;for(2!==C&&(A=1),2===s.vAlign&&(I=-2.5),I-=y(0,Math.round(w/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),d=l.fontInfo.fontSize,g=v((d-12)/21+1),t.lineWidth=g,t.beginPath(),m=0;m<T;m++)c=t.measureText(u[m]).width,h=(f=A+o+(p=M(new r.Rect(o,n,i,a),c,w*T,C,b,e)).x)+c,S=I+n+p.y+w,v(S)===S&&(S+=.5),x=S,t.moveTo(f,S),t.lineTo(h,x),t.stroke(),I+=w},e.prototype.paintValue=function(t,e,o,n,i,a,s,l){var c,f,h,p,d,g,m,y,C,v,b,w,T,x,A,I,R=this;if(t&&(c=R.getText(e,l),!u(c))){for(f=(c+="").split(/\r\n|\r|\n/),h=0;h<f.length;)f[h]=f[h].replace(/\s+/g," "),h++;c=f.join("\r\n"),p=!1,d=l.sheet.ITa,g=l.row,m=l.col,y=l.sheetArea,(C=d.getValueForKey(g,m,S,y))&&(R._id===C.id?p=C.visited:d.do("setValueForKey",g,m,S,void 0,y)),t.save(),t.beginPath(),(v=p?R._visitedLinkColor:R._linkColor)&&t.fillStyle!==v&&(t.fillStyle=v),(b=s.font)&&t.font!==b&&r.Ul.lZa(t,b),w=F(s),l.sheet.outlineColumn&&l.sheet.outlineColumn.XQa(l.col)&&(w=0),T=[],x=0,A=0,s.wordWrap?(I=i-3-w,I-=1,(x=(T=r.Vn.Wn(c,I,b)).length)>1&&0!==s.vAlign&&(A=(x-1)*l.lineHeight)):T.push(c),t.rect(o,n,i,a),t.clip(),t.beginPath(),R.Eka(t,w,o,n,i,a,s,l,T,A),R.Fka(t,w,o,n,i,a,s,l,T),t.restore()}},e.prototype.getText=function(t,e){return this._text||t},e.prototype.tw=function(t,e,o,n){if(!t.HF){var r=t.parent;r&&r.tw(t,e,o,n)}},e.prototype.getHitInfo=function(t,e,o,n,r){var i;return r&&(i=r.sheetArea,(u(i)||3===i)&&o&&n)?{x:t,y:e,row:r.row,col:r.col,cellStyle:o,cellRect:n,sheetArea:i,isFocusAware:!0,sheet:r.sheet,isReservedLocation:D(t,e,o,n,r,this._text)}:m},e.prototype.processMouseDown=function(t){var e=t&&t.sheet;e&&!e.isEditing()&&t.isReservedLocation&&(this.AK=!0)},e.prototype.processMouseUp=function(t){var e,o=t&&t.sheet;o&&!o.isEditing()&&(e=this,t.isReservedLocation&&e.AK&&e.Eia(t),e.AK=!1)},e.prototype.processMouseMove=function(t){var e,o=t.row,n=t.col,r=t.sheet;!r||r.isEditing()&&r.getActiveRowIndex()===o&&r.getActiveColumnIndex()===n||(e=r.Ws(),t.isReservedLocation?e&&(this.BK(r,t),e.style.cursor="pointer"):(this.CK(r),e&&(e.style.cursor=T)))},e.prototype.processMouseLeave=function(t){var e,o=t.sheet;this.AK=!1,this.CK(o),o&&((e=o.Ws())&&(e.style.cursor=T))},e.prototype.BK=function(t,e){var o,n,r,i,a,s,l=this;l._linkToolTip&&(o=l.DK(),(n=d(o)).text(l._linkToolTip),i=(r=t.mm.bG()).left+e.x,a=r.top+e.y+20,0===n.parent().length&&((s=t&&t.zo())&&s.insertBefore(o,m),n.css("top",a).css(w,i)))},e.prototype.CK=function(t){var e,o=this;o.EK&&((e=t&&t.zo())&&o.EK.parentElement===e&&function(t,e){t.removeChild(e)}(e,o.EK),o.EK=m)},e.prototype.DK=function(){var t,e=this;return e.EK||(t=l("div"),d(t).css("position","absolute").css("margin",0).css("padding",2).css("border","1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("box-sizing","content-box").css("background-color","white").css("font","9pt Arial"),e.EK=t),e.EK},e.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},e.prototype.processKeyUp=function(t,e){return!!e.sheet&&(this.Eia(e),!0)},e.prototype.getAutoFitWidth=function(t,e,o,n,r){return E(this._text||t,o,n,r,!0)},e.prototype.getAutoFitHeight=function(t,e,o,n,r){return E(this._text||t,o,n,r)},e.prototype.isImeAware=function(t){return!1},e.prototype.Eia=function(t){var e=t&&t.sheet,o=this,n=t.row,r=t.col,i=t.sheetArea;o.onClickAction().call(this,t),e.ITa.do("setValueForKey",n,r,S,{id:o._id,visited:!0},i),e.repaint(e.getCellRect(n,r)),o.tw(e,n,r,i)},e.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},e.prototype.lJc=function(t){var e={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&x[t.target],activeOnClick:t.activeOnClick};this.fromJSON(e)},e.prototype.toJSON=function(){var t,e=this,o={typeName:e.typeName};return g(A,(function(n,r){(t=e["_"+n])!==r&&(o[n]=t)})),o},e.prototype.fromJSON=function(t){var e=this;g(A,(function(o){var n=t[o];u(n)||(e["_"+o]=n)}))},e.prototype.a5=function(t){},e.prototype.gQa=function(){var t,o=this,n=new e;return g(A,(function(e,r){(t=o["_"+e])!==r&&(n["_"+e]=t)})),n._onAction=o._onAction,n},e}(s),e.HyperLink=I,g(A,(function(t){I.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[8]=I},"./dist/plugins/celltype/radiochecklistcelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function F(t,e){return t.hasOwnProperty(e)}function E(t,e){return t instanceof Date&&e instanceof Date?a(t)===a(e):!p(t)&&!p(e)&&t.toString&&e.toString?""+t==""+e:t===e}function j(t,e,o,n,r){var i=e.zoom(),a=G(t._boxSize,o.font,i),s=B(t,o),u=l(s,a),c=n;return t._items.length<n&&(c=t._items.length),u*c+t._itemSpacing.vertical*i*(c-1)}function P(t,e,o,n,r){var i=e.zoom(),a=G(t._boxSize,o.font,i),s=t.defaultPadding*i,l=L(t,e,o,n,r),u=0;return l.forEach((function(t){u+=t})),u+=r*(a+s)+(r-1)*t._itemSpacing.horizontal*i}function L(t,e,o,n,r){var i,a,l,u,c,f=[];for(i=0;i<t._items.length;i++)a=F(t._items[i],v)?t._items[i].text:t._items[i],l=e.dp(a,o.font),(u=t.dHb()).hasMagin&&(l=l+u.paddingLeft+u.paddingRight),c=s(i%r),t._direction===S.vertical&&(c=s(i/n)),f[c]===h?f[c]=l:f[c]=Math.max(f[c],l);return f}function G(t,e,o){var n=T*o;return"number"==typeof t&&t>=0?n=t*o:"auto"===t&&(n=C(e)/2),n}function B(t,e){var o=C(e.font),n=t.dHb();return n.hasMagin&&(o=o+n.paddingTop+n.paddingBottom),o}function _(t,e,o,n){var r=z(t)*o,i=r;return 1===t.hAlign?i=(e.width-n)/2:2===t.hAlign&&(i=e.width-r-n),i}function V(t,e,o,n){var r=2*o,i=r;return 1===t.vAlign?e.height-r>n&&(i=(e.height-n-r)/2+r):2===t.vAlign&&(i=e.height-n-r),i}function H(t,e,o,n,r){var i,a;if(t._direction===S.vertical){if(t._isFlowLayout){if(r!==h)for(i=t._items.length;i>0;){if(!(j(t,e,o,i,u(t._items.length/i))>r))return[i=l(i,1),u(t._items.length/i)];i-=1}return[t._items.length,1]}return[i=l(1,t._maxRowCount),u(t._items.length/i)]}if(t._isFlowLayout){if(n!==h)for(a=t._items.length;a>0;){if(!(P(t,e,o,u(t._items.length/a),a)>n))return a=l(a,1),[u(t._items.length/a),a];a-=1}return[1,t._items.length]}return a=l(1,t._maxColumnCount),[u(t._items.length/a),a]}function z(t){var e=t.textIndent;return 1===t.hAlign||0===e||e===f||e===h?2:8*e}function U(t,e){var o,r,i=e.cellRect.width,a=e.cellRect.height,u=e.sheet,c=u.zoom(),f=u.getStyle(e.row,e.col),h=f&&f.font,p=H(t,e.sheet,e.cellStyle,i-1,a),d=p[0],g=p[1],m=L(t,e.sheet,e.cellStyle,d,g),y=G(t._boxSize,h,c),C=t.defaultPadding*c,w=l(B(t,e.cellStyle),y),T=P(t,u,e.cellStyle,d,g),A=j(t,u,e.cellStyle,d),I=_(e.cellStyle,e.cellRect,c,T),R=V(e.cellStyle,e.cellRect,c,A),M=function(o){var r,i,a,l,f,h,p=F(t._items[o],v)?t._items[o].text:t._items[o],T=u.dp(p,e.cellStyle.font),A=s(o/g),M=o%g;if(t._direction===S.vertical&&(A=o%d,M=s(o/d)),r=new n.Rect,i=0,a=m.filter((function(t,e){return e<M})),a.forEach((function(t){i+=t})),r.x=I+i+M*(y+C+t._itemSpacing.horizontal*c),r.y=R+A*w+t._itemSpacing.vertical*c*A,l=t.dHb(),r.width=(t._textAlign!==x.right||l.hasMagin?m[M]:T)+y+C,r.height=w,f=e.x-e.cellRect.x,h=e.y-e.cellRect.y,r&&r.contains(f,h))return{value:{value:F(t._items[o],b)?t._items[o].value:t._items[o]}}};for(o=0;o<t._items.length;o++)if("object"==typeof(r=M(o)))return r.value}function W(t,e){var o,n=!1,r=F(t,b)?t.value:t;if(e!==f)if(Array.isArray(e)){for(o=0;o<e.length;o++)if(E(e[o],r)){n=!0;break}}else n=E(e,r);return n}function q(t,e,o,n){var r,i,a,s;if(n)return e;for(t===f&&(t=[]),Array.isArray(t)||(t=[t]),r={},o.forEach((function(t){r[F(t,b)?t.value:t]=!0})),i=t.length-1;i>=0;i--)r[t[i]]||t.splice(i,1);if(-1===(a=t.slice()).indexOf(e))a.push(e);else for(i=a.length-1;i>=0;i--)E(a[i],e)&&a.splice(i,1);return s=[],o.forEach((function(t){-1!==a.indexOf(t.value)&&s.push(t.value)})),s}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=r.Common.j.C4,a=r.Common.l.Ra,s=Math.floor,l=Math.max,u=Math.ceil,c="alphabetic",f=null,h=void 0,p=r.Common.j.Fa,d=n.Ul.lZa,g=n.CellTypes.Base,m=n.GC$,y=m.each,C=n.Ul.fp,v="text",b="value",w="number",T=12,function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(S=e.Direction||(e.Direction={})),function(t){t[t.left=2]="left",t[t.right=3]="right"}(x=e.TextAlign||(e.TextAlign={})),A={items:f,direction:S.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:x.right,boxSize:T},I=function(t){function e(){var e,o=t.call(this)||this;return o.typeName="11",o.defaultPadding=5,e=o,y(A,(function(t,o){"items"===t&&(o=[]),e["_"+t]=o})),o}return D(e,t),e.prototype.paintValue=function(t,e,o,r,i,a,u,c){var f,h,p,g,m,y,b,w,A,I,R,M,k,N,O,D,E,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it=this;if(t){for(t.save(),t.rect(o+1,r+1,i-2,a-2),t.clip(),t.beginPath(),f=0,0,p=(h=c.sheet).zoom(),g=u.font,m=c.isPrinting,y=c.printZoomFactor,m&&"number"==typeof y&&1!==y&&(p=y),b=G(it._boxSize,g,p),w=it.defaultPadding*p,A=b/2,I=new n.Rect(o+1,r+1,i-2,a-2),N=P(it,h,u,M=(R=H(it,h,u,i-2,a-2))[0],k=R[1]),O=j(it,h,u,M,k),D=L(it,h,u,M,k),E=B(it,u),z=o+_(u,I,p,N),U=r+V(u,I,p,O),(W=u.font)&&t.font!==W&&d(t,c.fontInfo.font),u.foreColor&&(t.fillStyle=u.foreColor),q=u.textDecoration,X=(J=c.fontInfo.fontSize)>8?s((J-8)/5+2):1,0,Z=C(u.font)/2-J/2+X-1,Y=z,K=U,Q=0,$=0,J>b&&(Q=it.hMc(b),$=(E-Z-T)/2+1),tt=0;tt<it._items.length;tt++)z>o+i||U>r+a||(et=F(it._items[tt],v)?it._items[tt].text:it._items[tt],f=h.dp(et,u.font),t.textAlign="left",ot=it._direction===S.vertical?D[s(tt/M)]:D[tt%k],nt=0,it._textAlign===x.left?(it.zGb(t,it._items[tt],e,f,z,U+Q,ot,E,Z),z=z+ot+w,t.save(),it.AGb(t,e,it._items[tt],z,U+$,A),t.restore(),nt=b):(t.save(),it.AGb(t,e,it._items[tt],z,U+$,A),z=z+b+w,t.restore(),it.zGb(t,it._items[tt],e,f,z,U+Q,ot,E,Z),nt=ot),q&&(rt=this.dHb(),it.ip(t,q,z-(it._textAlign===x.right?0:ot+w)+rt.paddingLeft,U+E-Z-rt.paddingBottom,f,J,X)),it._direction===S.vertical?(U+=l(E,b)+it._itemSpacing.vertical*p,(tt+1)%M==0&&(Y=Y+ot+b+w+it._itemSpacing.horizontal*p,U=r+V(u,I,p,O)),z=Y):(z=z+nt+it._itemSpacing.horizontal*p,(tt+1)%k==0&&(z=o+_(u,I,p,N),K=K+l(E,b)+it._itemSpacing.vertical*p),U=K));t.restore()}},e.prototype.hMc=function(t){return(t-T)/2},e.prototype.getText=function(t,e){return t},e.prototype.zGb=function(t,e,o,n,r,i,a,s,l){var u=F(e,v)?e.text:e;t.textBaseline!==c&&(t.textBaseline=c),t.fillText(u,r,i+s-l)},e.prototype.getItemsBound=function(t,e,o,r){var i,a,u,c,f,h,p,d,g,m,y,C,b,w,T,A,I,R,M,k=this,N=t.zoom(),O=t.getActualStyle(e,o,r),D=n.To.No("11pt "+t.currentTheme().bodyFont(),N);for(O.font&&(D=n.To.No(O.font,N)),O.font=D.font,i=1===r?-1:void 0,a=2===r?-1:void 0,c=(u=t.getCellRect(e,o,i,a)).width,f=u.height,h=H(k,t,O,c-1,f),p=h[0],d=h[1],g=L(k,t,O,p,d),m=G(k._boxSize,D.font,N),y=k.defaultPadding*N,C=l(B(k,O),m),b=P(k,t,O,p,d),w=j(k,t,O,p,d),T=_(O,u,N,b),A=V(O,u,N,w),I=[],R=function(e){var o,r,i,a,l=F(k._items[e],v)?k._items[e].text:k._items[e],c=t.dp(l,O.font),f=s(e/d),h=e%d;k._direction===S.vertical&&(f=e%p,h=s(e/p)),o=new n.Rect,r=0,i=g.filter((function(t,e){return e<h})),i.forEach((function(t){r+=t})),o.x=T+r+h*(m+y+k._itemSpacing.horizontal*N)+u.x,o.y=A+f*C+k._itemSpacing.vertical*N*f+u.y,a=k.dHb(),o.width=(k._textAlign!==x.right||a.hasMagin?g[h]:c)+m+y,o.height=C,o.x>u.x+u.width||o.y>u.y+u.height?I[e]=null:I[e]=o},M=0;M<k._items.length;M++)R(M);return I},e.prototype.AGb=function(t,e,o,n,r,i){},e.prototype.dHb=function(){return{hasMagin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},e.prototype.getAutoFitWidth=function(t,e,o,n,r){var i=r&&r.sheet,a=z(o),s=H(this,i,o);return(P(this,i,o,s[0],s[1])+a)/i.zoom()},e.prototype.getAutoFitHeight=function(t,e,o,n,r){var i=r&&r.sheet,a=H(this,i,o);return j(this,i,o,a[0],a[1])/i.zoom()},e.prototype.getHitInfo=function(t,e,o,r,i){var a,s,l,u,c,h,d,g,m,y,C,v=this;return i?(a=i.sheetArea,s=i.sheet,r=o.cellType.f5(r,o,s.zoom()),(p(a)||3===a)&&r?(l={x:t,y:e,row:i.row,col:i.col,cellStyle:o,cellRect:r,sheetArea:a,sheet:s},u=s.zoom(),o.font&&(o.font=n.To.No(o.font,u).font),g=P(v,s,o,h=(c=H(v,s,o,r.width-1,r.height-2))[0],d=c[1]),m=j(v,s,o,h,d),y=r.x+_(o,r,u,g),C=r.y+V(o,r,u,m),new n.Rect(y,C,g,m).contains(l.x,l.y)&&(l.isReservedLocation=!0),l):f):f},e.prototype.processMouseDown=function(t){return!!t&&void(t.isReservedLocation&&(this.uK=!0))},e.prototype.processMouseLeave=function(e){return t.prototype.processMouseLeave.call(this,e),!!e&&void(this.uK=!1)},e.prototype.processMouseUp=function(t){var e,o,n,r,i,a;return!!t&&(e=this,o=t.sheet,!!(e.uK&&o&&t.isReservedLocation&&(e.uK=!1,n=t.row,r=t.col,i=t.sheetArea,a=U(e,t)))&&(function(t,e,o,n,r,i){var a=e.getValue(o,n,i),s=t.rK(a,r),l={cmd:"editCell",sheetName:e.name(),row:o,col:n,newValue:s,autoFormat:!0};e.wu().execute(l),t.triggerButtonClicked(e,o,n,i)}(e,o,n,r,a.value,i),!0))},e.prototype.rK=function(t,e){return q(t,e,this._items,!0)},e.prototype.triggerButtonClicked=function(t,e,o,n){var r=t.parent;r&&r.tw(t,e,o,n)},e.prototype.lJc=function(t){var e={items:t.items,direction:t.direction&&S[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&x[t.textAlign],boxSize:t.boxSize};this.fromJSON(e)},e.prototype.toJSON=function(){var t,e=this,o={typeName:e.typeName};return y(A,(function(n,r){t=e["_"+n],("items"===n?t&&t.length>0:t!==r)&&(o[n]="object"==typeof t?i(t):t)})),o},e.prototype.fromJSON=function(t){var e=this;y(A,(function(o){var n=t[o];p(n)||(e["_"+o]=n)}))},e}(g),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return D(e,t),e.prototype.AGb=function(t,e,o,n,r,i){var a=F(o,b)?o.value:o;t.beginPath(),t.fillStyle="white",t.arc(n+i,r+i,i,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(n+i,r+i,i,0,2*Math.PI),t.stroke(),e!==f&&E(e,a)&&(t.beginPath(),t.strokeStyle="black",t.arc(n+i,r+i,.5*i,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},e}(I),e.RadioButtonList=R,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.typeName="12",e}return D(e,t),e.prototype.AGb=function(t,e,o,n,r,i){t.strokeStyle="black",t.strokeRect(n+.5,r+.5,2*i+.05,2*i+.05),t.fillStyle="white",t.fillRect(n+1,r+1,2*i-1,2*i-1);var a=W(o,e);e!==f&&a&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(n+3,r+i),t.lineTo(n+i,r+2*i-3.5),t.lineTo(n+2*i-1.5,r+3),t.stroke())},e.prototype.rK=function(t,e){return q(t,e,this._items,!1)},e}(I),e.CheckBoxList=M,function(t){t[t.single=0]="single",t[t.multiple=1]="multiple"}(k=e.SelectionMode||(e.SelectionMode={})),N={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:f,itemSpacing:{horizontal:5,vertical:5},selectionMode:k.multiple},O=function(t){function e(){var e,o=t.call(this)||this;return o.typeName="13",o.defaultPadding=0,e=o,y(N,(function(t,o){"items"===t&&(o=[]),e["_"+t]=o})),e._boxSize=0,delete e.boxSize,o}return D(e,t),e.prototype.zGb=function(t,e,o,n,r,i,a,s,l){var u,f,h,p,d;t.save(),t.beginPath(),u=W(e,o),f=F(e,v)?e.text:e,h=this._selectedBackColor,p=this._selectedForeColor,u&&(t.fillStyle=h,t.fillRect(r+1,i+1,a-1,s-1),t.fillStyle=p),t.textAlign="center",t.textBaseline!==c&&(t.textBaseline=c),d=this.dHb(),t.fillText(f,r+d.paddingLeft+(a-d.paddingLeft-d.paddingRight)/2,i+d.paddingTop+s-d.paddingTop-d.paddingBottom-l),t.restore()},e.prototype.rK=function(t,e){return q(t,e,this._items,this._selectionMode===k.single)},e.prototype.dHb=function(){var t,e=0,o=0,n=0,r=0;return this._padding&&(t=function(t){var e,o,n,r,i=["0","0","0","0"];return"string"==typeof t&&(n=void 0,r=void 0,1===(o=(e=t.split(" ",4)).length)?i=[n=e[0],n,n,n]:2===o?i=[n=e[0],r=e[1],n,r]:3===o?(r=e[1],i=[e[0],r,e[2],r]):4===o&&(i=[e[0],e[1],e[2],e[3]])),i}(this._padding),e=typeof(e=parseInt(t[0],10))===w&&e>0?e:0,r=typeof(r=parseInt(t[1],10))===w&&r>0?r:0,o=typeof(o=parseInt(t[2],10))===w&&o>0?o:0,n=typeof(n=parseInt(t[3],10))===w&&n>0?n:0),{hasMagin:!0,paddingTop:e,paddingBottom:o,paddingLeft:n,paddingRight:r}},e.prototype.hMc=function(t){return 0},e.prototype.toJSON=function(){var e,o=this,n=t.prototype.toJSON.call(this);return y(N,(function(t,r){e=o["_"+t],("items"===t?e&&e.length>0:e!==r)&&(n[t]="object"==typeof e?i(e):e)})),n},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e);var o=this;y(N,(function(t){var n=e[t];p(n)||(o["_"+t]=n)}))},e}(I),e.ButtonList=O,y(A,(function(t){I.prototype[t]=function(e){var o,n,r,i,a,s,l="_"+t,u=this;if(0===arguments.length)return u[l];if("items"===t){for(o=[],n=0;n<e.length;n++)r=e[n],p(r.text)||p(r.value)?p(r.text)?p(r.value)?p(r)||"object"==typeof r||o.push({text:r,value:r}):(r.text=r.value,o.push(r)):(r.value=r.text,o.push(r)):o.push(r);e=o}if("itemSpacing"===t)i=u[l],u[l]={horizontal:i.horizontal,vertical:i.vertical},p(e.horizontal)||(a=parseInt(e.horizontal,10),isNaN(a)||(u[l].horizontal=a)),p(e.vertical)||(s=parseInt(e.vertical,10),isNaN(s)||(u[l].vertical=s));else if("boxSize"===t){if(p(e))return u[l];"number"==typeof e&&e>=0&&(u[l]=e),"auto"===e&&(u[l]=e)}else u[l]=e;return u}})),n.CellTypes._o[11]=R,n.CellTypes._o[12]=M,y(N,(function(t){O.prototype[t]=function(e){var o,n,r,i,a,s,l="_"+t,u=this;if(0===arguments.length)return u[l];if("items"===t){for(o=[],n=0;n<e.length;n++)r=e[n],p(r.text)||p(r.value)?p(r.text)?p(r.value)?p(r)||"object"==typeof r||o.push({text:r,value:r}):(r.text=r.value,o.push(r)):(r.value=r.text,o.push(r)):o.push(r);e=o}return"itemSpacing"===t?(i=u[l],u[l]={horizontal:i.horizontal,vertical:i.vertical},p(e.horizontal)||(a=parseInt(e.horizontal,10),isNaN(a)||(u[l].horizontal=a)),p(e.vertical)||(s=parseInt(e.vertical,10),isNaN(s)||(u[l].vertical=s))):u[l]=e,u}})),n.CellTypes._o[13]=O},"./dist/plugins/celltype/rangecelltype.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function g(t){return t.map((function(t){return{start:t.start,size:t.size}}))}function m(t,e,o,r,i,l,f){var h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It;for(void 0===f&&(f=1),h=e.x,p=e.y,d=e.width,g=e.height,m=r.sheet,y=r.sheetArea,C=r.isPrinting,v=r.needTopGridline,b=r.needLeftGridline,w=[],T=[],!0,S=[],x=m.vu(),A=l.rowCount,I=l.colCount,R=l.rowSize,M=l.colSize,k=l.cellStyleList,N=l.sparklines,i.$Jb(o),D=(O=i.cKb()).baseRow,F=O.baseCol,j=(E=i.UJb).Pm,E.Us(new n.Rect(0,0,d,g)),P=new n.AF(E,E.Gr(1,3),E.Hr(1,3),3),L=i.dKb(true),p+=1,g-=1,h+=1,d-=1,G=0,B=0,R=R.map((function(t){var e=t.size*g,o=c(e);return(B+=e-o)>=1&&(o++,B--),{start:c(t.start*g),size:o}})),M=M.map((function(t){var e=t.size*d,o=c(e);return(G+=e-o)>=1&&(o++,G--),{start:c(t.start*d),size:o}})),_=E.conditionalFormats,V=0;V<A;V++)for(H=0;H<I;H++)if(k[V][H]){if(U=(z=k[V][H]).style,W=z.isSpan,q=z.span,J=!1,X=L[V][H],W&&!q)continue;if(U=U.clone(!0),Z=c(h+M[H].start),Y=c(p+R[V].start),void 0,void 0,$=W?q.colCount:1,tt=W?q.rowCount:1,K=M[H+$]?M[H+$].start:d,et=c(K-M[H].start),Q=R[V+tt]?R[V+tt].start:g,ot=c(Q-R[V].start),X.formatStyle&&(X.formatStyle.Yo(U),U=X.formatStyle),U.Zo(j),nt=null,W){for(nt={row:V,col:H,x:c(Z),y:c(Y),width:c(et),height:c(ot),rowCount:tt,colCount:$},rt={},it={},at=[],st=void 0,lt=void 0,ut=0,ct=0,st=0;st<$-1;st++)ht=(ft=M[H+st])?ft.size:0,it[st]=ht,ut+=ht;for(it[st]=c(et)-ut,lt=0;lt<tt-1;lt++)ht=(pt=R[V+lt])?pt.size:0,rt[lt]=ht,ct+=ht;for(rt[lt]=c(ot)-ct,lt=0;lt<tt;lt++){for(dt=[],gt=0;gt<$;gt++)k[lt+V]&&k[lt+V][H+gt]&&dt.push(k[lt+V][H+gt].style);at.push(dt)}nt.spanSizeInfo={styleList:at,rowSizes:rt,colSizes:it}}P.jF(V,H,c(Z),c(Y),c(et),c(ot),U,nt,v&&0===V,b&&0===H),(mt=U.formatter)&&n.util.lHb(mt)&&((yt=m.parent&&m.parent.aJb(mt))&&(yt.getExpression()&&((Ct=s.evaluateFormula(m,mt.replace("@",JSON.stringify(X.value))))instanceof a.CalcError||(X.value=Ct)))),vt=null,N[V][H]&&((vt=N[V][H].clone())&&(vt.oZa=E.name(),vt.hKb=vt.iKb(E),vt.jKb=vt.kKb(E),vt.lKb=E)),X&&X.value&&"SparklineExValue"===X.value.typeName&&(S.push({value:X.value,x:Z,y:Y,width:et,height:ot,option:r}),J=!0),X.validStyle&&T.push({style:X.validStyle,x:Z,y:Y,width:et,height:ot}),w.push({data:J?null:X.value,row:V,col:H,x:Z,y:Y,width:et,height:ot,style:U,sparkline:vt,baseRow:V+D,baseCol:H+F,conditionalFormats:_,imageLoader:x,cellLayout:{row:V,col:H,x:Z,y:Y,width:et,height:ot}})}for(t.save(),v&&(p-=2,g+=4),b&&(h-=2,d+=4),t.rect(h,p,d,g),t.clip(),w.length>0&&E.yl.SI(t,w,y,C,1,m,D,F,f),P.paint(t),T.length>0&&E.yl.jJ(t,T),t.restore(),V=0;V<S.length;V++)wt=(bt=S[V]).value,Tt=bt.x,St=bt.y,xt=bt.width,At=bt.height,It=bt.option,u.bDc(t,wt,Tt,St,xt,At,It)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Bindings"),i=o("Sparkline"),a=o("@grapecity/js-calc"),s=o("SheetsCalc"),l=n.CellTypes.Base,u=n.CellTypes.Context,c=Math.floor,f=function(){function t(){this.Uu=0,this.SV=0,this.Xj=0,this.OZ=0}return t.prototype.YE=function(t,e){var o=this,n=e.row,r=e.col,i=e.rowCount,a=e.colCount;return o.Uu=n,o.SV=r,o.Xj=i,o.OZ=a,o.Ny=o.nJb(t,e),o.NJb=o.OJb(t,e),o},t.prototype.PJb=function(){return this.NJb},t.prototype.OJb=function(t,e){var o,n,r,i,a,s=this,l=e.row,u=e.col,c=e.rowCount,f=e.colCount,h=0,p=[],d=0,g=[],m=0,y=l+c,C=u+f;for(o=l;o<y;o++)m=t.getRowHeight(o),d+=m,g.push(m);for(n=u;n<C;n++)m=t.getColumnWidth(n),h+=m,p.push(m);return m=0,r=g.map((function(t){var e=m/d;return m+=t,{start:e,size:t/d}})),m=0,i=p.map((function(t){var e=m/h;return m+=t,{start:e,size:t/h}})),a=s.nJb(t,e),{rowCount:c,colCount:f,rowSize:r,colSize:i,cellStyleList:s.QJb(t,e,a,r,i),sparklines:s.RJb(t,e),totalHeight:d,totalWidth:h}},t.prototype.SJb=function(t,e,o,r,i){var a,s,l,u,c,f,h,p=null;for(a=0,s=i;a<s.length;a++)if(u=(l=s[a]).rowOffset,c=l.colOffset,f=l.rowCount,h=l.colCount,new n.Range(u+o,c+r,f,h).contains(t,e)){p=l;break}return p},t.prototype.TJb=function(t,e,o){var n,r=[0,0],i=r[0],a=r[1],s=t.rowOffset,l=t.colOffset,u=s+t.rowCount,c=l+t.colCount;for(n=s;n<u;n++)a+=e[n]?e[n].size:0;for(n=l;n<c;n++)i+=o[n]?o[n].size:0;return{width:i,height:a}},t.prototype.QJb=function(t,e,o,n,r){var i,a,s,l,u,c=e.row,f=e.col,h=e.rowCount,p=e.colCount,d=[];for(i=c;i<c+h;i++){for(a=[],s=f;s<f+p;s++)(l=this.SJb(i,s,c,f,o))&&l.rowOffset+c===i&&l.colOffset+f===s?(u=this.TJb(l,n,r),a.push({style:t.getActualStyle(i,s,3,!0),spanWidth:u.width,spanHeight:u.height,isSpan:!0,span:l})):l?a.push({style:t.getActualStyle(i,s,3,!0),isSpan:!0}):a.push({style:t.getActualStyle(i,s,3,!0)});d.push(a)}return d},t.prototype.nJb=function(t,e){var o,n,r,i=t.ITa.getSpans(),a=[],s=e.row,l=e.col,u=e.rowCount,c=e.colCount;for(o=0,n=i;o<n.length;o++)(r=n[o]).intersect(s,l,u,c)&&a.push({rowOffset:r.row-s,colOffset:r.col-l,rowCount:r.rowCount,colCount:r.colCount});return a},t.prototype.RJb=function(t,e){var o,n,r,i,a=e.row,s=e.col,l=e.colCount,u=e.rowCount,c=[];for(o=a;o<a+u;o++){for(n=[],r=s;r<s+l;r++)(i=t.getSparkline(o,r))?n.push(i.clone()):n.push(null);c.push(n)}return c},t.prototype.toJSON=function(){var t=this.PJb(),e=t.rowCount,o=t.colCount,n=t.rowSize,r=t.colSize,i=t.cellStyleList,a=t.sparklines,s=t.totalWidth,l=t.totalHeight,u=g(n),c=g(r),f=i.map((function(t){return t.map((function(t){if(t){var e=t.style,o=t.spanWidth,n=t.spanHeight,r=t.isSpan,i=t.span;return{style:e.toJSON(),spanWidth:o,spanHeight:n,isSpan:r,span:i}}return null}))})),h=a.map((function(t){return t.map((function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}}))}));return{rowCount:e,colCount:o,rowSize:u,colSize:c,cellStyleList:f,sparklines:h,totalWidth:s,totalHeight:l}},t.prototype.fromJSON=function(t){var e,o,r,a,s,l,u,c,f,h,p,d;t&&(e=t.rowCount,o=t.colCount,r=t.rowSize,a=t.colSize,s=t.cellStyleList,l=t.sparklines,u=t.totalWidth,c=t.totalHeight,f=g(r),h=g(a),p=s.map((function(t){return t.map((function(t){var e,o,r,i,a,s;return t?(e=t.style,o=t.spanWidth,r=t.spanHeight,i=t.isSpan,a=t.span,s=null,e&&(s=new n.Style).fromJSON(e),{style:s,spanWidth:o,spanHeight:r,span:a,isSpan:i}):null}))})),d=l.map((function(t){return t.map((function(t){if(t){var e=new i.Sparkline,o=new i.SparklineSetting(t.setting);return e.fromJSON(t.sp),e.setting(o),e.sparklineType(t.sparklineType),e}}))})),this.NJb={rowCount:e,colCount:o,rowSize:f,colSize:h,cellStyleList:p,sparklines:d,totalWidth:u,totalHeight:c})},t.prototype.no=function(){this.NJb=null},t}(),e.Wgc=f,h=function(){function t(){}return t.prototype.YE=function(t,e,o){var r=this;return r.my=e,r.UJb=new n.Worksheet,r.VJb=t.parent&&t.parent.options.allowDynamicArray,r.UJb.getCalcService&&(r.UJb.getCalcService().allowDynamicArray=r.VJb,r.WJb=r.XJb(t)),r.iMc(t,o),r},t.prototype.XJb=function(t){var e,o,n,r,i,a,s,l=this.my,u=l.row,c=l.col,f=l.colCount,h=l.rowCount,p=[],d=t.Bj&&t.Bj();for(e=u;e<u+h;e++)for(o=c;o<c+f;o++)t.getFormula(e,o)&&((n=d&&d.Qf(e,o))&&n.isDynamicArray&&(r=n.row,i=n.col,a=n.rowCount,s=n.colCount,a>1&&p.push({row:r+1,col:i,rowCount:a-1,colCount:s}),s>1&&p.push({row:r,col:i+1,rowCount:1,colCount:s-1})));return p},t.prototype.ZJb=function(){var t,e,o,n,r,i,a,s=this.WJb,l=this.UJb;for(t=0,e=s;t<e.length;t++)n=(o=e[t]).row,r=o.col,i=o.rowCount,a=o.colCount,l.clear(n,r,i,a,3,1)},t.prototype.$Jb=function(t){var e,o=this.UJb;o.suspendEvent(),e=new r.CellBindingSource(t),this.ZJb(),o.setDataSource(e),o.resumeEvent()},t.prototype.iMc=function(t,e){var o=this.UJb,n=t.toJSON({includeBindingSource:!0,ignoreFormula:!!e});delete n.charts,delete n.shapes,o.fromJSON(JSON.parse(JSON.stringify(n))),this._Jb()},t.prototype._Jb=function(){var t,e,o=this.my,n=o.row,r=o.col,i=o.colCount,a=o.rowCount,s=[],l=[];for(t=n;t<n+a;t++){for(l=[],e=r;e<r+i;e++)l.push(this.aKb(t,e,3));s.push(l)}this.bKb=s},t.prototype.cKb=function(){var t=this.my;return{baseRow:t.row,baseCol:t.col}},t.prototype.dKb=function(t){var e,o,n,r,i,a,s,l,u=this.UJb,c=this.my,f=c.row,h=c.col,p=c.colCount,d=c.rowCount,g=[];for(e=f;e<f+d;e++){for(o=[],n=void 0,r=void 0,i=h;i<h+p;i++)a=u.getText(e,i),s=u.getValue(e,i,3,1),l=u.getBindingPath(e,i),n=this.eKb(e,i,3),r=this.fKb(u,e,i,s,t),o.push({value:s,formatStyle:n,text:a,validStyle:r,bindingPath:l});g.push(o)}return g},t.prototype.aKb=function(t,e,o){var n;return this.UJb.uja&&(n=this.UJb.getDataValidator(t,e,o))?n.highlightStyle():null},t.prototype.fKb=function(t,e,o,n,r){if(r&&t.isValid&&!t.isValid(e,o,n)){var i=this.my,a=i.row,s=i.col;return this.bKb[e-a][o-s]}return null},t.prototype.eKb=function(t,e,o){var r=this.UJb.conditionalFormats;return r?r.Eq(new n.Style,t,e,o):null},t.prototype.getCellValueInfo=function(t){var e,o,n,r=this.my,i=r.row,a=r.col,s=r.colCount,l=r.rowCount,u=[],c=t.ITa;for(e=i;e<i+l;e++){for(o=[],n=a;n<a+s;n++)o.push({bindPath:t.getBindingPath(e,n),formula:t.getFormula(e,n),value:c.getValue(e,n,3,null,1)});u.push(o)}return u},t.prototype.setValueToDataStruct=function(t,e,o,n){n[t]||(n[t]={}),n[t][e]=o},t.prototype.toJSON=function(){var t=this.UJb,e=this.VJb,o=this.WJb.map((function(t){return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}})),n=this.my;return{spillRangs:o,allowDynamicArray:e,range:{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},t.prototype.fromJSON=function(t){var e,o,r,i,a,s,l;t&&((o=(e=this).UJb=new n.Worksheet).suspendCalcService&&o.suspendCalcService(),e.WJb=t.spillRangs,e.VJb=t.allowDynamicArray,o.getCalcService&&(o.getCalcService().allowDynamicArray=e.VJb),o.fromJSON(JSON.parse(t.templatejson)),e.ZJb(),i=(r=t.range).row,a=r.col,s=r.rowCount,l=r.colCount,e.my=new n.Range(i,a,s,l),this._Jb(),o.resumeCalcService&&o.resumeCalcService())},t.prototype.no=function(){this.UJb.no(),this.UJb=null,this.my=null},t}(),e.Xgc=h,p=function(t){function e(e,o,r,i,a){var s,l=t.call(this)||this;return l.allowOverflow=!1,l.typeName="16",s=1===arguments.length?new n.Range(0,0,e.getRowCount(),e.getColumnCount()):new n.Range(o,r,i,a),e&&s&&(l._R=(new f).YE(e,s),l.gKb=(new h).YE(e,s)),l}return d(e,t),e.prototype.getAutoFitWidth=function(){return this._R.NJb.totalWidth},e.prototype.getAutoFitHeight=function(){return this._R.NJb.totalHeight},e.prototype.updateTemplate=function(t,e){t&&e&&(this._R.YE(t,e),this.gKb.YE(t,e))},e.prototype.paintContent=function(t,e,o,n,r,i,a,s){var l,u=this.gKb,c=this._R;u&&c&&(l=this._R.PJb(),a.cellPadding&&(s.needTopGridline=!0,s.needLeftGridline=!0),m(t,{x:o,y:n,width:r,height:i},e,s,u,l))},e.prototype.toJSON=function(){return{typeName:this.typeName,layout:this._R.toJSON(),resolvor:this.gKb.toJSON()}},e.prototype.fromJSON=function(t){t.layout&&(this._R=new f,this._R.fromJSON(t.layout)),t.resolvor&&(this.gKb=new h,this.gKb.fromJSON(t.resolvor))},e}(l),e.RangeTemplate=p,n.CellTypes._o[16]=p,e.paintRangeTemplate=m},"./dist/plugins/comment/comment-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function A(t,e,o){var n,i=t.ITa.Ky.JU();return!!i&&(n=i.location(),t.wu().execute({cmd:h,sheetName:t.name(),row:i.nT,col:i.oT,oldValue:n.clone(),newValue:new r.Point(n.x+e,n.y+o),propertyName:"location"}))}function I(t){var e=t.comment;e&&(s(t.row)||s(t.col))&&(t.row=e.nT,t.col=e.oT)}function R(t,e){var o,n,r;if((e?t.canUndo():t.canExecute())&&(o=t.KV)){for(n=0;n<o.length;n++)(r=o[n])&&(e?r.undo():r.execute());return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("Core"),r.GC$,a=r.Events,s=n.Common.j.Fa,l=i.Commands.ActionBase,u="deleteComment",c="deleteCommentByKey",f="deactivateComment",h="moveComment",p="moveCommentUp",d="moveCommentDown",g="moveCommentLeft",m="moveCommentRight",y="changeComment",C="changeCommentTransaction",v=i.Commands.h4,b=function(t){function e(e,o){var n=t.call(this)||this;return I(o),n.kj=e,n.VQ=o,n}return x(e,t),e.prototype.execute=function(){var t,e,o,n,r,s,l=this;return!!l.canExecute()&&(t=l.kj,l.Lz(t,!0),e=t.comments.get(l.VQ.row,l.VQ.col),n=(o=t.ITa).Ky,r={sheet:t,sheetName:t.name(),comment:e,cancel:!1},t.Wq(a.CommentRemoving,r),r.cancel||(o.startTransaction(),n.remove(e.nT,e.oT),n.rV=null,t.GJ(),t.Wq(a.CommentRemoved,{sheet:t,sheetName:t.name(),comment:e}),s=i.Commands.bWa(t.name()),l.VQ[s]=o.endTransaction()),l.Mz(t,!0),!0)},e.prototype.undo=function(){var t,e=this,o=e.kj;return e.Lz(o,!0),t=i.Commands.bWa(o.name()),o.ITa.undo(e.VQ[t]),o.EJ(),e.Mz(o,!0),!0},e}(l),e.CommentDeleteUndoAction=b,w=function(t){function e(e,o){var n=t.call(this)||this;return I(o),n.kj=e,n.VQ=o,n}return x(e,t),e.prototype.execute=function(){var t,e=this,o=e.VQ,n=e.kj,r=n.comments.get(o.row,o.col);return!(!e.canExecute()||!r||(e.Lz(n,!0),t=o.propertyName,r[t](o.newValue),"location"===t&&(o.displayMode?r.displayMode(o.displayMode):o.displayMode=r.displayMode()),e.Mz(n,!0),0))},e.prototype.undo=function(){var t,e=this,o=e.VQ,n=e.kj;return e.Lz(n,!0),!!(t=n.comments.get(o.row,o.col))&&(t[o.propertyName](o.oldValue),e.Mz(n,!0),!0)},e}(l),e.CommentPropertyUndoAction=w,i.Commands.ChangeComment=w,T=function(t){function e(e,o){var n,r,i=t.call(this)||this,a=i;if(a.KV=[],a.kj=e,a.VQ=o,n=o.commands)for(r=0;r<n.length;r++)a.add(n[r]);return i}return x(e,t),e.prototype.execute=function(){return R(this,!1)},e.prototype.undo=function(){return R(this,!0)},e.prototype.add=function(t){this.KV.push(t)},e}(l),i.Commands[c]={canUndo:!1,execute:function(t,e){var o=i.Commands.bT(t,e),n=o.ITa.Ky.JU();return!!n&&o.wu().execute({cmd:u,sheetName:o.name(),row:n.nT,col:n.oT})}},i.Commands[f]={canUndo:!1,execute:function(t,e){var o=i.Commands.bT(t,e),n=o.ITa.Ky;return!!n.JU()&&(n.vQ(),o.GJ(),o.repaint(),!0)}},i.Commands[p]={canUndo:!1,execute:function(t,e){return A(i.Commands.bT(t,e),0,-1)}},i.Commands[d]={canUndo:!1,execute:function(t,e){return A(i.Commands.bT(t,e),0,1)}},i.Commands[g]={canUndo:!1,execute:function(t,e){return A(i.Commands.bT(t,e),-1,0)}},i.Commands[m]={canUndo:!1,execute:function(t,e){return A(i.Commands.bT(t,e),1,0)}},i.Commands[u]={canUndo:!0,execute:function(t,e,o){return v(t,b,e,o)}},i.Commands[h]={canUndo:!0,execute:function(t,e,o){return v(t,w,e,o)}},i.Commands[y]={canUndo:!0,execute:function(t,e,o){return v(t,w,e,o)}},i.Commands[C]={canUndo:!0,execute:function(t,e,o){return v(t,T,e,o)}},S=function(t){var e=r.Ul.sl();t.register(c,i.Commands[c],e?8:46,!1,!1,!1,!1),t.register(f,i.Commands[f],27,!1,!1,!1,!1),t.register(p,i.Commands[p],38,!1,!1,!1,!1),t.register(d,i.Commands[d],40,!1,!1,!1,!1),t.register(g,i.Commands[g],37,!1,!1,!1,!1),t.register(m,i.Commands[m],39,!1,!1,!1,!1),t.register(u,i.Commands[u]),t.register(y,i.Commands[y]),t.register(C,i.Commands[C]),t.register(h,i.Commands[h])},i.Commands.uT=S},"./dist/plugins/comment/comment-touch.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("./dist/plugins/comment/comment.js"),i=o("Touch"),n.Rxb.touch&&(a=n.GC$,s=n.Ul.nl,l=function(){function t(t,e){var o=this;o.NS=t,o.LV=e,o.kT=e.kT,o.kj=o.kT.kj,o.hQ=new i.TP(o.kj)}return t.prototype.OS=function(t){var e,o=new i.oP(t.X,t.Y),n=a(this.NS).offset();return n&&(e=document.body,o.X+=n.left+e.clientLeft||0,o.Y+=n.top+e.clientTop||0),o},t.prototype.jQ=function(t){t.DO=35},t.prototype.lQ=function(t){var e=this,o=e.OS(t.rN);e.LV.iV({target:t.GP,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),e.hQ.OP()},t.prototype.pQ=function(t){var e,o,n=this,r=t.dP.rO,i=n.kj,s=i.parent;1!==r&&s&&s.options.allowUserZoom?(i.mm.lV=!1,e=n.LV,a(e.TU).remove(),n.hQ.PP(r)):(o=n.OS(t.rN),n.LV.BD({target:t.GP,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}))},t.prototype.qQ=function(t){var e,o=this,n=t.dP.rO,r=o.kj.parent;1!==n&&r&&r.options.allowUserZoom?o.hQ.SP(n):(e=o.OS(t.rN),o.LV.CD({target:t.GP,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}))},t.prototype.sQ=function(t){var e=this.kT,o=this.kj;try{o.suspendPaint(),3===e.commentState()?e.commentState(1):1===e.commentState()&&e.commentState(2)}finally{o.resumePaint()}},t}(),u=function(){function t(t,e,o,n){var r,a=this,s=a.kT=e.kT;a.yM=new i.jR(a),a.DQ=new i.kR(t,"Comment"+s.nT+s.oT,a.yM,2,200),a.BQ=o,a.CQ=n,(r=a.DQ)._M=function(){return 3!==s.commentState()},r.bN=function(){return!0},r.dN=function(t){return n.jQ(t)},r.eN=function(t){return n.lQ(t)},r.fN=function(t){return n.pQ(t)},r.hN=function(t){return n.qQ(t)},r.iN=function(t){return n.sQ(t)}}return t.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},t.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),c=function(t){function e(e,o,n){return t.call(this,e,o,n,new l(e,o))||this}return p(e,t),e}(u),f=function(t){function e(e,o,n){return t.call(this,e,o,n,new h(e,o))||this}return p(e,t),e}(u),h=function(t){function e(e,o){return t.call(this,e,o)||this}return p(e,t),e.prototype.lQ=function(t){var e=this,o=e.OS(t.rN);e.LV.hV({target:t.GP,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),e.hQ.OP()},e}(l),r.GV.$n("touch",{init:function(t){var e=this,o=e.kT.kj.parent.BQ;e.wR=new c(t[0],e,o),e.wR.EQ(),e.MV=new f(t[1],e,o),e.MV.EQ()},detachEditor:function(t){var e=this,o=e.kT.kj;e.MV=new f(t,e,o.parent.BQ),e.MV.EQ()},preProcessMouseDownEdit:function(t){var e=t.e,o=this.MV;o&&!e.isTouch&&o.GQ(e)&&(s(e),t.r=!0)},preProcessMouseDownDragResize:function(t){var e=t.e,o=this.wR;o&&!e.isTouch&&o.GQ(e)&&(s(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,o=e.isTouch,n=this.wR,r=this.MV;n&&!o&&n.IQ(e)&&(s(e),t.r=!0),r&&!o&&r.IQ(e)&&(s(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,o=e.isTouch,n=this.wR,r=this.MV;n&&!o&&n.HQ(e)&&(s(e),t.r=!0),r&&!o&&r.HQ(e)&&(s(e),t.r=!0)}}))},"./dist/plugins/comment/comment.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/comment/comment.js")),n(o("./dist/plugins/comment/comment-actions.js")),o("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X;function Z(t,e){return new i.Point(t,e)}function Y(t,e,o,n){return new i.Rect(t,e,o,n)}function K(t){return t.height}function Q(t){return t.width}function $(t,e){var o=t.options;return!o.isProtected||o.protectionOptions.allowEditObjects||e&&!e.locked()}function tt(t,e,o,n,r){var i,a,s,l,u,c,f=this.ITa.Ky;if(t&&f)for(a=f.all(),s=0;s<a.length;s++)l=(i=a[s]).nT,u=i.oT,l===e&&u===o||l>=e&&l<e+n&&u>=o&&u<o+r&&f.remove(l,u);(i=f.get(e,o))&&((c=f.pT(i))&&c.qT())}function et(){var t=this,e=t.nQ&&t.nQ();e&&e.rT(t)}function ot(t,e,o){var n=this.nQ&&this.nQ();n&&n.sT(t,e,o)}function nt(t,e){return t&&t.getRowHeight(e)}function rt(t,e){return t&&t.getColumnWidth(e)}function it(t,e){return t&&t.getViewportLeftColumn(e)}function at(t,e){return t&&t.getViewportTopRow(e)}function st(t,e,o){return _.push(t),r.Ul.Pl(t,e,function(t){var e=t;return function(t,o){var n=this,r=n.kj;r&&(r.ITa.UUa({type:"property",comment:n,name:e,value:o}),r.Xq<=0&&(r.RP(),"indicatorColor"!==e&&"indicatorSize"!==e||r.repaint(r.getCellRect(n.nT,n.oT))),r.Wq(T.CommentChanged,{sheet:r,sheetName:r.name(),comment:n,propertyName:e}))}}(t),o)}function lt(t,e,o,n,r){var i=Y(e,o,n,n);i.cursor=r,t.push(i)}function ut(t,e,o,n){i.GC$(t.DT).css(e,o),i.GC$(t.ET).css(e,n)}function ct(t,e){var o,n=t.length,r=0;for(o=0;o<n;o++)r+=I(t[o],e);return r}function ft(t,e){t&&t.RF(e)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("Core"),a=r.Commands,s=r.Worksheet,l=null,u=void 0,c=Math.max,f=Math.min,h=Math.floor,p=Math.atan2,d=Math.abs,g="default",m=r.GC$.extend,y=r.Ul.Nl,C=n.Common.k,v=r.Vl,b=r.En,w=r.Ul,T=r.Events,S=w.nl,x=w.Rl,A=w.YIc,I=w.Voa,R=parseFloat,M=n.Common.u,k=r.Bn,N=document,O=window,D={cGc:"mouse",dGc:"move",eGc:"DOMMouseScroll",fGc:"left",OLb:"top",gGc:"right",hGc:"bottom",iGc:"width",jGc:"height",kGc:"position",lGc:"absolute",mGc:"overflow",nGc:"visible",oGc:"z-index",pGc:"hidden",qGc:"box-sizing",rGc:"content-box",sGc:"padding",tGc:"px",uGc:"div",vGc:".comment",wGc:".floatBlockCanvas",xGc:".hostContainer",yGc:".lineCanvasContainer",zGc:".host",AGc:".editor",BGc:"gc-spread-",CGc:"className",DGc:"cursor",EGc:"text",FGc:701,GGc:898,HGc:"gc-no-user-select",IGc:" ",JGc:"unselectable",KGc:"on",LGc:"comment_editor",MGc:"comment_indicator",NGc:"font-family",OGc:"font-style",PGc:"font-size",QGc:"font-weight",RGc:"color",SGc:"textArea",TGc:".lineCanvas",UGc:".commentDocument",VGc:"-resize",WGc:"line-height",XGc:"background-color",YGc:"text-align",ZGc:"mousedown",$Gc:"mousemove",_Gc:"mouseup",aHc:"mousewheel",bHc:"text-decoration"},r.GC$.extend(s.prototype,{RP:function(t){var e,o,n,r,i,a=this,s=a.nQ&&a.nQ();if(!a.fI)for(e=a.am(),o=void 0,n=0;n<=2;n++)for(r=0;r<=2;r++)(o=e.Ft(n,r))&&0!==Q(o)&&0!==K(o)&&(t&&!o.intersectRect(t)||(i=a.ITa.Ky,s&&i&&s.fT(i)))}}),r.CellRange.prototype.comment=function(t){var e=this,o=e.sheet,n=e.row,r=e.col;return 0===arguments.length?o.ITa.Ky.get(n,r):(t instanceof G&&o.ITa.Ky.Cz(n,r,t),e)},F=function(t,e){var o=t.Vs(),n=t.hitTest(e.pageX-o.left,e.pageY-o.top);n&&function(t,e){var o,n=-1,r=-1;if(e&&e.rowViewportIndex>=0&&e.colViewportIndex>=0&&(n=e.row,r=e.col),t.parent){if(n<0||r<0)return;o=t.ITa.Ky.get(n,r),t.ITa.Ky.tT(o)}}(t,n)},E=function(t,e){e.bind(T.TopRowChanged+D.vGc,(function(){e.ITa.Ky.cQ()})),e.bind(T.LeftColumnChanged+D.vGc,(function(){e.ITa.Ky.cQ()})),e.bind(T.FloatingElementSelected+D.vGc,(function(t,o){if("comments"!==o.type){var n=e.ITa.Ky;n.vQ(),n.tT(l)}})),t.bind(D.ZGc+D.vGc,(function(t){e.ITa.Ky.vQ(),F(e,t)})).bind(D.aHc+D.vGc,(function(t){F(e,t)})).bind(D.$Gc+D.vGc,(function(t){F(e,t)}))},j=function(t,e){e.unbind(D.vGc),t.unbind(D.vGc)},T.CommentChanged="CommentChanged",function(t){t[t.active=1]="active",t[t.edit=2]="edit",t[t.normal=3]="normal"}(P=e.CommentState||(e.CommentState={})),function(t){t[t.alwaysShown=1]="alwaysShown",t[t.hoverShown=2]="hoverShown"}(e.DisplayMode||(e.DisplayMode={})),L=function(){function t(t,e,o,n){var r=this;arguments.length<=1?r.top=r.right=r.bottom=r.left=t||0:(r.top=t,r.right=e,r.bottom=o,r.left=n)}return t.prototype.clone=function(){var e=this;return new t(e.top,e.right,e.bottom,e.left)},t.prototype.toString=function(){var t=this,e="";return[D.OLb,D.gGc,D.hGc,D.fGc].forEach((function(o){e+=t[o]+D.tGc+D.IGc})),e.trim()},t}(),e.Padding=L,G=function(){function t(t){var e=this;e.nT=-1,e.oT=-1,e.text(t||""),e.zIndex(D.GGc)}return t.prototype.clone=function(){var e=this,o=new t;return _.forEach((function(t){var n=e[t]();e[t].isDefault&&e[t].isDefault(n)||o[t](n&&n.clone?n.clone():n)})),o.kj=e.kj,o.nT=e.nT,o.oT=e.oT,o},t.prototype.toJSON=function(){var t=this,e={rowIndex:t.nT,colIndex:t.oT};return _.forEach((function(o){var n=t[o]();t[o].isDefault&&t[o].isDefault(n)||(e[o]=n&&n.clone?n.clone():n)})),e},t.prototype.fromJSON=function(t,e){if(t){var o=this;_.forEach((function(e){var n=t[e];n!==u&&("location"===e?o.location(new i.Point(n.x,n.y),!1):"padding"===e?o.padding(new L(n.top,n.right,n.bottom,n.left),!1):o[e](n,!1))})),t.rowIndex!==u&&(o.nT=t.rowIndex),t.colIndex!==u&&(o.oT=t.colIndex)}},t}(),e.Comment=G,B={},_=[],V=[[D.EGc,""],["location",Z(9,-18)],[D.iGc,160,function(t){return t>0}],[D.jGc,100,function(t){return t>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(t){return/^\d+pt$/.test(t)&&parseInt(t,10)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(t){return"boolean"==typeof t&&this.dynamicMove()}],["dynamicMove",!0,function(t){return t||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(t){return t>=0&&t<=1}],["borderWidth",1,function(t){return t>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(t){return"string"==typeof t}],["indicatorSize",6,function(t){return"number"==typeof t&&t>1}]],V.forEach((function(t){B[t[0]]=st(t[0],t[1],t[2])})),H=B.zIndex,B.zIndex=function(){var t,e,o=H.apply(this,arguments);return 0===arguments.length&&o===D.GGc&&(t=this.kj.comments.wTa,e=this.mi,o=D.GGc-(t-1-e)),o},m(G.prototype,B),z=function(){function t(t,e){var o,n=this,r=t&&t.kj;n.WE=1,n.aS=1,n.kT=t,n.vT(),n._zoomFactor=r.zoom(),n.wT=e,n.BF=e.xT,n.ad(),o=n.yT(n.zT(),t.width(),t.height()),n.AT=Z(o.x,o.y),n.BT(),n.CT()}return t.prototype.ad=function(){var e=this,o=e.kT.kj;e.FT=D.BGc+"floatBlockCanvas",e.GT=D.BGc+"host-container",e.HT=D.BGc+"host",e.IT=D.BGc+"lineCanvas",e.JT=y(D.uGc),i.GC$(e.JT).addClass(D.BGc+"floatBlockCanvas-container").css([D.kGc,D.mGc,D.qGc],[D.lGc,D.pGc,D.rGc]),e.DT=y("canvas"),b.Kn(e.DT,null,o),i.GC$(e.DT).addClass(e.FT).css([D.fGc,D.OLb,D.kGc],[0,0,D.lGc]),e.ET=y(D.uGc),i.GC$(e.ET).addClass(e.GT).css([D.kGc,D.qGc,D.mGc],[D.lGc,D.rGc,D.pGc]),e.qo=y(D.uGc),i.GC$(e.qo).addClass(e.HT+D.IGc+D.HGc).css([D.fGc,D.OLb,D.iGc,D.jGc,D.kGc,"word-wrap","word-break","white-space",D.mGc,D.qGc,D.JGc,D.WGc],[0,0,"100%","100%",D.lGc,"break-word","normal","pre-wrap",D.pGc,D.rGc,D.KGc,"normal"]),i.GC$(e.ET).append(e.qo),i.GC$(e.JT).append(e.DT).append(e.ET),e.KT=y(D.uGc),i.GC$(e.KT).addClass(D.BGc+"lineCanvas-container").css([D.kGc,D.mGc,"pointer-events"],[D.lGc,D.pGc,"none"]),e.LT=y("canvas"),b.Kn(e.LT,l,o),i.GC$(e.LT).addClass(e.IT).css([D.fGc,D.gGc,D.kGc],[0,0,D.lGc]),i.GC$(e.KT).append(e.LT),e.MT=[],e.NT=7,e.qS=!1,e.kv=!1,t.ao(e,"init",[e.DT,e.qo])},t.prototype.OT=function(){var t=this,e=t.kT.kj;!t.PT&&e&&e.nQ&&(t.PT=e.nQ().PT),t.PT&&(t.PT.appendChild(t.KT),t.QT(),t.PT.appendChild(t.JT),t.RT(t.DT,D.wGc),t.RT(t.ET,D.xGc),t.ST()?t.TT():t.UT(),t.AT=t.zT(),t.VT())},t.prototype.WT=function(){var t=this;t.JT&&t.KT&&t.PT&&(t.XT(t.DT,D.wGc),t.XT(t.ET,D.xGc),t.YT(),t.ZT(),t.$T(),i.GC$(t.JT).remove(),i.GC$(t.KT).remove())},t.prototype._T=function(){return this.kT.width()*this._zoomFactor},t.prototype.aU=function(){return this.kT.height()*this._zoomFactor},t.prototype.zT=function(){var t=this,e=t.kT;return e!==t.wT.bU||e.commentState()!==P.normal||e.ignoreDefaultLocation()?t.cU(e.location()):(e._3=t.cU(Z(9,-18)),e._3)},t.prototype.cU=function(t){var e,o,n=this,r=n.kT,i=r&&r.kj,a=n._zoomFactor,s=Z(0,0);return i&&((e=n.dU(i,r.nT,r.oT,n.WE,n.aS)).x!==l&&void 0!==e.x&&e.y!==l&&void 0!==e.y&&Q(e)&&K(e)&&(o=i.am(),s.x=e.x+Q(e)+t.x*a-o.Br,s.y=e.y+t.y*a-o.Cr)),s},t.prototype.dU=function(t,e,o,n,r){var i,a,s,c,f=Y(0,0,0,0),h=t.am(),p=at(t,n),d=it(t,r),g=this._zoomFactor,m=x(t,d,o,!1);return d===t.qq&&(m+=t.eCb),i=x(t,p,e,!0),p===t.lq&&(i+=t.cCb),f.y=e>=p?i:-i,f.x=o>=d?m:-m,(a=t.getSpan(e,o))!==u&&a!==l?(f.height=0===n&&A(t,e,e+a.rowCount,!0)||x(t,e,e+a.rowCount,!0),f.width=0===r&&A(t,o,o+a.colCount,!1)||x(t,o,o+a.colCount,!1)):(f[D.jGc]=nt(t,e)*g,f[D.iGc]=rt(t,o)*g),f.x+=h.Br,f.y+=h.Cr,s=h.hs,c=h.fs,1===n?f.y+=c:2===n&&(f.y+=c+t.oKc(h)),1===r?f.x+=s:2===r&&(f.x+=s+t.rKc(h)),f},t.prototype.eU=function(t){var e,o,n=this,r=n.kT,i=r&&r.kj,a=n._zoomFactor,s=Z(0,0);return i&&((e=n.dU(i,r.nT,r.oT,n.WE,n.aS)).x!==l&&e.x!==u&&e.y!==l&&e.y!==u&&Q(e)&&K(e)&&(o=i.am(),s.x=(t.x-(e.x+Q(e)-o.Br))/a,s.y=(t.y-(e.y-o.Cr))/a)),s},t.prototype.fU=function(){var t=this;t.AT=t.zT(),t.BT(),t.CT(),t.VT()},t.prototype.gU=function(){var t=this,e=t.yT(t.zT(),t.kT.width(),t.kT.height());t.AT=Z(e.x,e.y),t.CT()},t.prototype.hU=function(){var t,e=this,o=e.kT;o.dynamicMove()?o.dynamicSize()?e.iU():(e.jU(),e.CT()):(e.BT(),e.CT(),t=e.eU(e.AT===o._3?e.zT():e.AT),o.location(t))},t.prototype.qT=function(){var t=this;t.AT=t.zT(),t.VT()},t.prototype.jU=function(){var t=this,e=t.kT,o=t.kU();t.AT=o,e.location(t.eU(o),!1),t.VT()},t.prototype.kU=function(){var t,e,o,n,r,i,a,s=this,l=s.kT,u=l&&l.kj,c=s._zoomFactor,f=it(u,s.aS),h=at(u,s.WE),p=0;for(t=0;t<s.aS;t++)p+=u.getViewportWidth(t);for(e=x(u,f,s.lU,!1),f<s.lU?p+=e:p-=e,(o=rt(u,s.lU))<s.mU&&(s.mU=o),p+=s.mU*c,n=0,r=0;r<s.aS;r++)n+=u.getViewportHeight(r);return i=x(u,h,s.nU,!0),h<s.nU?n+=i:n-=i,(a=nt(u,s.nU))<s.oU&&(s.oU=a),Z(p,n+=s.oU*c)},t.prototype.pU=function(){var t,e,o,n,r=this,i=r.kT,a=i&&i.kj,s=x(a,r.lU,r.mT,!1),l=rt(a,r.lU);l<r.mU&&(r.mU=l),(t=rt(a,r.mT))<r.qU&&(r.qU=t),s=s-r.mU+r.qU,e=x(a,r.nU,r.lT,!0),(o=nt(a,r.nU))<r.oU&&(r.oU=o),(n=nt(a,r.lT))<r.rU&&(r.rU=n),e=e-r.oU+r.rU,i.width(s),i.height(e)},t.prototype.iU=function(){this.pU(),this.jU()},t.prototype.BT=function(){var t,e,o,n,r,i,a,s,l,u,c,f=this,h=f.kT,p=h&&h.kj,d=f._zoomFactor;if(f.AT){for(t=it(p,f.aS),e=at(p,f.WE),0===f.aS?o=f.AT.x:1===f.aS?o=f.AT.x-p.getViewportWidth(0):2===f.aS&&(o=f.AT.x-(p.getViewportWidth(0)+p.getViewportWidth(1))),0===f.WE?n=f.AT.y:1===f.WE?n=f.AT.y-p.getViewportHeight(0):2===f.WE&&(n=f.AT.y-(p.getViewportHeight(0)+p.getViewportHeight(1))),r=Z(o,n),i=0,a=0,s=t;s<p.getColumnCount();s++){if(!(i+(l=rt(p,s)*d)<r.x)){f.lU=s,f.mU=(r.x-i)/d;break}i+=l}for(u=e;u<p.getRowCount();u++){if(!(a+(c=nt(p,u)*d)<r.y)){f.nU=u,f.oU=(r.y-a)/d;break}a+=c}}},t.prototype.CT=function(){var t,e,o,n,r,i,a,s,l,u,c,f=this,h=f.kT,p=h&&h.kj,d=f._zoomFactor;if(f.AT){for(t=it(p,f.aS),e=at(p,f.WE),0===f.aS?o=f.AT.x+f._T():1===f.aS?o=f.AT.x+f._T()-p.getViewportWidth(0):2===f.aS&&(o=f.AT.x+f._T()-(p.getViewportWidth(0)+p.getViewportWidth(1))),0===f.WE?n=f.AT.y+f.aU():1===f.WE?n=f.AT.y+f.aU()-p.getViewportHeight(0):2===f.WE&&(n=f.AT.y+f.aU()-(p.getViewportHeight(0)+p.getViewportHeight(1))),r=Z(o,n),i=0,a=0,s=t;s<p.getColumnCount();s++){if(!(i+(l=rt(p,s)*d)<r.x)){f.mT=s,f.qU=(r.x-i)/d;break}i+=l}for(u=e;u<p.getRowCount();u++){if(!(a+(c=nt(p,u)*d)<r.y)){f.lT=u,f.rU=(r.y-a)/d;break}a+=c}}},t.prototype.rI=function(t,e){var o=this,n=o.kT;t<=o.nU?n.dynamicMove()&&(o.nU+=e,o.lT+=e):t>o.nU&&t<=o.lT&&n.dynamicSize()&&(o.lT+=e),o.iU()},t.prototype.tI=function(t,e){var o=this,n=o.kT;t<=o.lU?n.dynamicMove()&&(o.lU+=e,o.mT+=e):t>o.lU&&t<=o.mT&&n.dynamicSize()&&(o.mT+=e),o.iU()},t.prototype.GR=function(t,e){var o=this,n=o.kT,r=t+e-1;t<o.nU?r<o.nU?n.dynamicMove()&&(o.nU-=e,o.lT-=e):r<o.lT&&n.dynamicMove()&&(n.dynamicSize()?o.lT-=e:o.lT-=o.nU-t+1,o.nU=t,o.oU=0):t<=o.lT&&(r<o.lT?n.dynamicSize()&&(o.lT-=e):n.dynamicSize()&&(o.lT=t,o.rU=0)),o.iU()},t.prototype.HR=function(t,e){var o=this,n=o.kT,r=t+e-1;t<o.lU?r<o.lU?n.dynamicMove()&&(o.lU-=e,o.mT-=e):r<o.mT&&n.dynamicMove()&&(n.dynamicSize()?o.mT-=e:o.mT-=o.lU-t+1,o.lU=t,o.mU=0):t<=o.mT&&(r<o.mT?n.dynamicSize()&&(o.mT-=e):n.dynamicSize()&&(o.mT=t,o.qU=0)),o.iU()},t.prototype.VT=function(){var t,e=this,o=e.kT,n=o.kj;e.sU()&&(t=n.zoom(),e._zoomFactor!==t?(e._zoomFactor=t,e.AT=e.kU()):(e._zoomFactor=t,e.AT!==o._3||1!==o.displayMode()&&2!==o.commentState()||(e.AT=e.zT())),e.vT(),e.tU(),e.uU(),e.vU(),e.wU(),w.Ml.chrome&&e.xU())},t.prototype.tU=function(){var t=this,e=t.kT.kj,o=e.parent&&e.parent.options.useTouchLayout;t.NT=o?11:7},t.prototype.vT=function(){var t=this,e=t.kT,o=e.kj;t.WE=o.Er(e.nT),t.aS=o.Fr(e.oT)},t.prototype.uU=function(){var t=this,e=2===t.kT.commentState()?t.BF:t.qo;t.yU(),t.zU(e),t.AU(e),t.BU(e),t.CU()},t.prototype.AU=function(t){var e=this.kT;t===this.qo&&(t.innerHTML=M.Ob(e.text()))},t.prototype.BU=function(t){var e,o,n,r,a,s,l,u,h,p,d,g,m,y,C,v,w=this,T=w.kT,S=2===T.commentState()||1===T.displayMode()?w.zT():w.AT,x=w._zoomFactor;S&&(w.fJc&&w.pV(),e=w.kv?w.yT(S,T.width(),T.height()):w.yT(S),w.DU(e),o=Q(e)*x,n=K(e)*x,s=(r=e.x)+o,l=(a=e.y)+n,u=w.NT,r<(h=w.EU(w.WE,w.aS)).x?(ut(w,D.fGc,r-h.x,r+u-h.x),o+=r-h.x,r=h.x):(ut(w,D.fGc,0,u),s>h.x+Q(h)&&(o+=h.x+Q(h)-1-s)),o=f(Q(h)-1,o),a<h.y?(ut(w,D.OLb,a-h.y,a+u-h.y),n+=a-h.y,a=h.y):(ut(w,D.OLb,0,u),l>h.y+K(h)&&(n+=h.y+K(h)-1-l)),n=f(K(h)-1,n),i.GC$(w.JT).css({left:r,top:a,width:o,height:n}),p=o,d=n,b.Pn(w.DT,p,d),g=c(0,p-2*(u+T.borderWidth())),m=c(0,d-2*(u+T.borderWidth())),i.GC$(w.ET).css({width:g,height:m}),y=g,C=m,(v=T.padding())&&(y-=Math.ceil(R(v.left)+R(v.right)),C-=Math.ceil(R(v.top)+R(v.bottom))),i.GC$(t).css({width:c(0,y),height:c(0,C)}))},t.prototype.DU=function(t){var e,o,n,r,i=this,a=i.kT,s=i.AT;t.x===s.x&&t.y===s.y&&Q(t)===a.width()&&K(t)===a.height()||(e=i.eU(Z(t.x,t.y)),o=Q(t),n=K(t),r=a.location(),e.x===r.x&&e.y===r.y||a.location(e,!1),o!==a.width()&&a.width(o,!1),n!==a.height()&&a.height(n,!1),a.dynamicMove()&&(i.AT=Z(t.x,t.y)))},t.prototype.CU=function(){var t=this,e=t.kT;$(e&&e.kj)?(t.RT(t.DT,D.wGc),t.RT(t.ET,D.xGc),t.QT(),t.UT(),t.TT()):(e.locked()?(t.XT(t.DT,D.wGc),t.FU(t.DT),t.XT(t.ET,D.xGc),t.FU(t.ET),t.DT.style.cursor=g,t.ET.style.cursor=g):(t.RT(t.DT,D.wGc),t.RT(t.ET,D.xGc)),e.lockText()?(t.YT(),t.FU(t.qo),t.$T(),t.FU(t.BF),(e.locked()||e.commentState()!==P.active)&&e.commentState(3),t.qo.style.cursor=e.locked()?g:D.dGc):(t.UT(),t.TT()),t.QT())},t.prototype.yU=function(){var t=this,e=t.kT,o=t.wT,n=e&&e.kj;switch(e.commentState()){case P.active:o.GU(e),t.ST()&&t.HU(),n.getSelections().length>0&&n.EJ(),v.Zl(n);break;case P.edit:o.GU(e),t.ST()||t.IU(),n.getSelections().length>0&&n.EJ(),v.Zl(l);break;case P.normal:e===o.JU()&&(o.vQ(),0===n.getSelections().length&&n.GJ())}},t.prototype.zU=function(t){var e,o,a,s,l;o=(e=this).kT,(a=i.GC$(t)).css("font-family",o.fontFamily()).css("font-style",o.fontStyle()).css("font-size",parseInt(o.fontSize(),10)*e._zoomFactor+"pt").css("font-weight",o.fontWeight()),a.css("text-decoration",r.To.So(o.textDecoration())),s={0:"left",1:"center",2:"right",3:"general"},a.css("text-align",s[o.horizontalAlign()]),o.padding()?a.css(D.sGc,""+o.padding()):a.css(D.sGc,"0px"),a.css("background-color",function(t,e,o){var r,i;return o?((i=(r=n.Common.pc).ec(t)).a=e,r.bc(i)):t}(o.backColor(),o.opacity(),t===e.qo)).css("color",o.foreColor()),i.GC$(e.ET).css("border-width",o.borderWidth()).css("border-style",o.borderStyle()).css("border-color",o.borderColor()),l=e.wT.KU(o),i.GC$(e.KT).css(D.oGc,l),i.GC$(e.JT).css(D.oGc,l)},t.prototype.xU=function(){var t,e,o,n=this.kT.kj,r=i.GC$(this.ET);n&&r&&(e=(t=n.Vs()).left-Math.floor(t.left)>=.5?.5:0,o=t.top-Math.floor(t.top)>=.5?.5:0,r.css(D.fGc,R(r.css(D.fGc))+e),r.css(D.OLb,R(r.css(D.OLb))+o))},t.prototype.vU=function(){var t,e,o,n,r,a,s,l,u,c=this,h=c.kT,p=h.kj,g=c.dU(p,h.nT,h.oT,c.WE,c.aS),m=p.am(),y=Z(g.x+Q(g)-m.Br,g.y-m.Cr),C=i.GC$(c.JT).position(),v=i.GC$(c.ET).position(),w=i.GC$(c.ET);t=C.left+v.left>y.x?Z(C.left+v.left,C.top+v.top):C.top+v.top+w.height()<y.y?Z(C.left+v.left+w.width(),C.top+v.top+w.height()):Z(C.left+v.left+w.width(),C.top+v.top),e=c.NT,o=d(y.x-t.x)+2*e,n=d(y.y-t.y)+2*e,s=(r=f(y.x,t.x)-e)+o,l=(a=f(y.y,t.y)-e)+n,r<(u=c.EU(c.WE,c.aS)).x&&(o-=u.x-r,r=u.x),s>u.x+Q(u)&&(o-=s-(u.x+Q(u))),o=f(Q(u),o),a<u.y&&(n-=u.y-a,a=u.y),l>u.y+K(u)&&(n-=l-(u.y+K(u))),n=f(K(u),n),i.GC$(c.KT).css(D.fGc,r).css(D.OLb,a).css(D.iGc,o).css(D.jGc,n),b.Pn(c.LT,o,n),y.x=y.x-r,y.y=y.y-a,t.x=t.x-r,t.y=t.y-a,c.LU(y,t)},t.prototype.LU=function(t,e){var o,n,r,i=this;i.MU||(i.MU=i.LT.getContext("2d")),o=i.MU,n=i.kT.borderColor(),o.strokeStyle=n,o.clearRect(0,0,b.Nn(i.LT),b.On(i.LT)),o.beginPath(),o.moveTo(t.x,t.y),o.lineTo(e.x,e.y),o.stroke(),o.save(),k.Dn(o,t.x,t.y),o.fillStyle=n,o.beginPath(),r=p(e.y-t.y,e.x-t.x),o.rotate(r),o.moveTo(0,0),o.lineTo(7,-4),o.lineTo(7,4),o.lineTo(0,0),o.fill(),k.Dn(o,-t.x,-t.y),o.closePath(),o.restore()},t.prototype.wU=function(){var t,e,o,n,r,a,s,l=this,u=l.kT,c=u.kj;l.NU=l.kT.commentState(),l.OU||(l.OU=l.DT.getContext("2d")),t=l.OU,e=b.Nn(l.DT),o=b.On(l.DT),n=i.GC$(l.ET).outerWidth(),r=i.GC$(l.ET).outerHeight(),a=l.NT,t.clearRect(0,0,e,o),l.kT.showShadow()&&(l.QU(t,e,o),s=2*(a+2),t.clearRect(a,a,e-s,o-s),l.PU(t,a,n,r)),$(c,u)&&l.RU(t,a,e,o,n,r),t.restore()},t.prototype.PU=function(t,e,o,n){t.fillRect(e+2,n+e,o,2),t.fillRect(o+e,e+2,2,n)},t.prototype.QU=function(t,e,o){var n,r;switch(this.NU){case P.active:for(t.beginPath(),r=0;r<o;r++)for(n=r%2==0?1:3;n<e;)t.moveTo(n,r),t.lineTo(n+1,r+1),n+=4;t.stroke(),t.closePath();break;case P.edit:for(t.beginPath(),n=0,r=0,4;n<e+o;)t.moveTo(n+4,0),t.lineTo(0,r+4),n+=4,r+=4;t.stroke(),t.closePath()}},t.prototype.RU=function(t,e,o,n,r,a){var s=this,u=s.MT;s.NU!==P.active&&s.NU!==P.edit||(u.splice(0,u.length),lt(u,0,0,e,"nw"+D.VGc),lt(u,o-e,0,e,"ne"+D.VGc),lt(u,0,n-e,e,"sw"+D.VGc),lt(u,o-e,n-e,e,"se"+D.VGc),a>=3*e?(lt(u,0,h(n/2-e/2),e,"w"+D.VGc),lt(u,o-e,h(n/2-e/2),e,"e"+D.VGc)):(u.push(l),u.push(l)),r>=3*e?(lt(u,h(o/2-e/2),0,e,"n"+D.VGc),lt(u,h(o/2-e/2),n-e,e,"s"+D.VGc)):(u.push(l),u.push(l)),t.restore(),t.fillStyle="white",t.strokeStyle="#939393",t.lineWidth=1,k.Dn(t,.5,.5),i.GC$.each(u,(function(e,o){if(o){var n=o.x,r=o.y,i=Q(o),a=K(o);t.beginPath(),t.fillRect(n,r,i-1,a-1),t.strokeRect(n,r,i-1,a-1),t.stroke(),t.closePath()}})),k.Dn(t,-.5,-.5))},t.prototype.SU=function(){var t,e,o,n=this,r=n.EU(n.WE,n.aS);n.TU?i.GC$(n.TU).remove():n.TU=y(D.uGc),t=i.GC$(n.TU),e=i.GC$(n.ET),t.addClass("gc-spread-moveResizeContainer").css([D.kGc,D.fGc,D.OLb,D.iGc,D.jGc,"border"],[D.lGc,n.AT.x+n.NT-r.x,n.AT.y+n.NT-r.y,e.outerWidth()-2,e.outerHeight()-2,"gray solid thin"]),n.UU?i.GC$(n.UU).remove():n.UU=y(D.uGc),(o=i.GC$(n.UU)).bind("mousemove",(function(t){n.BD(t)})).bind(D._Gc,(function(t){n.CD(t)})).css([D.kGc,D.mGc,D.OLb,D.fGc,D.iGc,D.jGc,"background",D.oGc],[D.lGc,D.pGc,r.y,r.x,Q(r),K(r),"rgba(255,255,255,0.01)",901]),o.append(n.TU),n.PT&&n.PT.appendChild(n.UU)},t.prototype.VU=function(t){var e,o,n,r,a,s,l,u,c,f=this,h=f.NT,p=f._zoomFactor,d=f.wT.WU;if(d.XU){if(e=f.YU(),o=t.pageX/p-d.x+e.x,n=t.pageY/p-d.y+e.y,0===o&&0===n)return;r=f.EU(f.WE,f.aS),s=i.GC$(f.TU),d.ZU<0?(l=d.$U.x+o,u=d.$U.y+n,a=f.cU(Z(l,u)),s.css([D.fGc,D.OLb],[a.x+h-r.x,a.y+h-r.y])):(c=f._U(o,n,d.ZU),a=f.cU(Z(c.x,c.y)),s.css([D.fGc,D.OLb,D.iGc,D.jGc],[a.x+h-r.x,a.y+h-r.y,Q(c)*p-2*h-2,K(c)*p-2*h-2]))}},t.prototype.IU=function(){var t,e=this,o=e.kT;e.ST()||(t=e.wT.xT,i.GC$(e.qo).remove(),e.YT(),i.GC$(t).remove(),i.GC$(e.ET).append(t),e.aV(t),e.BU(t),i.GC$(t).focus(),t.selectionStart=t.value.length,e.TT(),2!==o.commentState()&&o.commentState(2))},t.prototype.HU=function(){var e,o=this,n=o.kT,r=n.kj;o.ST()&&(e=o.wT.xT,o.$T(),i.GC$(e).remove(),i.GC$(o.ET).append(o.qo),o.aV(o.qo),o.UT(),t.ao(o,"detachEditor",o.qo),2===n.commentState()&&n.commentState(3),i.GC$(e).val()!==n.text()&&r.wu().execute({cmd:"changeComment",sheetName:r.name(),row:n.nT,col:n.oT,oldValue:n.text(),newValue:i.GC$(e).val(),propertyName:D.EGc}))},t.prototype.bV=function(t){var e=this.kT.kj,o=-1;return 0===t||2===t?o=e.getViewportHeight(t):1===t&&(o=x(e,e.getViewportBottomRow(0)+1,at(e,2)+1,!0)),o},t.prototype.cV=function(t){var e=this.kT.kj,o=-1;return 0===t||2===t?o=e.getViewportWidth(t):1===t&&(o=x(e,e.getViewportRightColumn(0)+1,it(e,2)+1,!1)),o},t.prototype.EU=function(t,e){var o=this.kT.kj,n=o.am(),r=n.Ft(t,e),i=o.rKc(n),a=o.oKc(n);return 0===t&&0===e||0===t&&2===e||2===t&&0===e||2===t&&2===e?r=Y(0,0,n.hs+i+n.js,n.fs+a+n.gs):0===t&&1===e||2===t&&1===e?r=Y(n.hs,0,i,n.fs+a+n.gs):1===t&&0===e||1===t&&2===e?r=Y(0,n.fs,n.hs+i+n.js,a):1===t&&1===e&&(r=Y(n.hs,n.fs,i,a)),r},t.prototype.aV=function(t){var e=this,o=e.kT,n=i.GC$(t);t!==e.BF&&t!==e.qo||(t===e.BF?t.value=o.text():t.innerHTML=M.Ob(o.text()),n.css([D.NGc,D.OGc,D.PGc,D.QGc,D.RGc,D.XGc,D.YGc,D.bHc],[o.fontFamily(),o.fontStyle(),o.fontSize(),o.fontWeight(),o.foreColor(),o.backColor(),o.horizontalAlign(),o.textDecoration()]),o.padding()?n.css(D.sGc,""+o.padding()):n.css(D.sGc,"0px"))},t.prototype.sU=function(){return!(!this.JT||!this.JT.parentNode)},t.prototype.ST=function(){var t=this;return t.sU()&&t.kT===t.wT.JU()&&i.GC$(t.ET).find(D.SGc).length>0},t.prototype.dV=function(){var t,e=this,o=e.kT.kj,n=l;return e.sU()&&(t=o.am(),n=Y(e.AT.x+t.zr+t.Br,e.AT.y+t.Ar+t.Cr,e._T(),e.aU())),n},t.prototype.eV=function(){var t,e,o,n=this,r=n.kT,i=n._zoomFactor;return n.sU()&&(t=n.dV())?(void 0,void 0,void 0,void 0,o=e=(n.NT+r.borderWidth())*i,Y(t.x+e,t.y+o,Q(t)-2*e,K(t)-2*o)):l},t.prototype.fV=function(t){var e,o=this,n=o.kT,r=n.kj,i=t.target,a=o.wT.WU,s=i.style,l=g;a.XU?i[D.CGc]!==o.HT&&i[D.CGc]!==o.FT&&i[D.CGc]!==o.IT&&i[D.CGc]!==D.BGc+"floatPanel"||(l=a.ZU>=0?"crosshair":D.dGc):i[D.CGc]===o.HT?!$(r)&&n.lockText()?n.locked()||(l=D.dGc):l=D.EGc:i[D.CGc]!==o.FT&&i[D.CGc]!==o.GT||$(r,n)&&(l=(e=o.gV(t))>=0&&e<o.MT.length?o.MT[e].cursor:D.dGc),s[D.DGc]=l},t.prototype.hV=function(e){var o,n=this,r=n.kT,i=r&&r.kj;if(i.endEdit()&&(o={e:e,r:l},t.ao(n,"preProcessMouseDownEdit",o),!o.r))return i.Wq(T.FloatingElementSelected,{type:"comments"}),n.wT.GU(r),r.commentState(2),n.CD(e),S(e)},t.prototype.iV=function(e){var o,n,r,i,a,s=this,u=s.kT,c=u&&u.kj,f=s._zoomFactor,h=s.wT,p=h.WU;c.endEdit()&&(o={e:e,r:l},t.ao(s,"preProcessMouseDownDragResize",o),o.r||(c.Wq(T.FloatingElementSelected,{type:"comments"}),p.x=e.pageX/f,p.y=e.pageY/f,p.$U=Y(u.location().x,u.location().y,u.width(),u.height()),p.ZU=s.gV(e),s.tC(),p.XU=!0,s.fV(e),h.GU(u),u.commentState(P.active),$(c,u)&&(s.eS={},s.eS.jV=at(c,s.WE),s.eS.kV=it(c,s.aS),s.SU(),p.ZU<0?s.qS=!0:s.kv=!0),n=c.mm,r=c.Vs(),i=Z(e.pageX-r.left,e.pageY-r.top),a=c.hitTest(i.x,i.y),n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.$F=i,n.qG(),n.lV=!0,e.stopPropagation()))},t.prototype.yT=function(t,e,o){var n,r,i,a,s,l,u=this,c=u.kT,f=c&&c.kj,h=u.NT,p=u._zoomFactor,g=u.aS,m=u.WE,y=u.EU(m,g),C=void 0!==e?e*p:u._T(),v=void 0!==o?o*p:u.aU(),b=t.x,w=t.y,T=f.am(),S=u.dU(f,0,0,m,g),A=t.x+(0-(S.x-T.Br))+C-h,I=t.y+(0-(S.y-T.Cr))+v-h,R=0,M=0,k=0,N=0;return 0===g?(R=0-h,k=Q(T)-T.Br):1===g?(n=x(f,f.getViewportRightColumn(0)+1,it(f,1),!1),R=y.x-h-n,k=u.cV(2)):2===g&&(R=0-h,k=0),b<R&&(u.kv?C-=R-b:A+=R-b,b=R),1!==g&&2!==g||(k+=x(f,0,f.getColumnCount(),!1,A)),A>k&&(u.kv?C-=A-k:u.qS?b-=A-k:(r=u.wT.bU&&!c.ignoreDefaultLocation()?9:c.location().x,(a=b-(i=2*d(r)+rt(f,c.oT)+c.width()))>R?b=a:b<k?C-=A-k:(a=b-i,A-i>R||(a=b-(A-k)),a<R?(C-=R-a,b=R):b=a))),0===m?(M=0-h,N=K(T)-T.Cr):1===m?(s=x(f,f.getViewportBottomRow(0)+1,at(f,1),!0),M=y.y-h-s,N=u.bV(2)):(M=0-h,N=0),w<M&&(u.kv?v-=M-w:I+=M-w,w=M),1!==m&&2!==m||(N+=x(f,0,f.getRowCount(),!0,I)),I>N&&(u.kv?v-=I-N:u.qS?w-=I-N:I>N&&((l=w-(I-N))<M?(v-=M-l,w=M):w=l)),Y(b,w,C/p,v/p)},t.prototype.YU=function(){var t=this,e=t.kT.kj,o=t.eS,n=o.jV,r=o.kV,i=at(e,t.WE),a=it(e,t.aS),s=x(e,n,i,!0),l=x(e,r,a,!1);return Z(r<a?l:-l,n<i?s:-s)},t.prototype.mV=function(t){var e,o,n,r,i,s,l,u,c,f,h=this,p=h.kT,d=p&&p.kj,g=h._zoomFactor,m=h.wT.WU,y=a.ChangeComment;if(m.XU){if(e=h.YU(),o=t.pageX/g-m.x+e.x,n=t.pageY/g-m.y+e.y,0===o&&0===n)return;r=void 0,i=void 0,m.ZU<0?(l=m.$U.x+o,u=m.$U.y+n,r=h.cU(Z(l,u)),i=h.yT(r),(s=h.eU(Z(i.x,i.y))).x===p.location().x&&s.x===p.location().y||d.wu().execute({cmd:"moveComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.location().clone(),newValue:s,propertyName:"location"})):(p.autoSize(!1),c=h._U(o,n,m.ZU),r=h.cU(Z(c.x,c.y)),i=h.yT(r,Q(c),K(c)),f=[],(s=h.eU(Z(i.x,i.y))).x===p.location().x&&s.y===p.location().y||f.push(new y(d,{cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.location().clone(),newValue:s,propertyName:"location"})),Q(i)!==p.width()&&f.push(new y(d,{cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.width(),newValue:i.width,propertyName:D.iGc})),K(i)!==p.height()&&f.push(new y(d,{cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.height(),newValue:i.height,propertyName:D.jGc})),f.length>0&&d.wu().execute({cmd:"changeCommentTransaction",sheetName:d.name(),commands:f}))}},t.prototype.BD=function(e){var o,n,r,i,a,s=this,u=s.kT.kj,c={e:e,r:l};if(t.ao(s,"preProcessMouseMove",c),!(c.r||(this.fV(e),u.getSelections()&&u.getSelections().length>0)))return o=s.wT,n=e.target,r=u.mm,i=u.Vs(),a=Z(e.pageX-i.left,e.pageY-i.top),n&&o.WU.XU&&(s.TU&&s.VU(e),1===s.WE&&(r.$F.y=a.y),1===s.aS&&(r.$F.x=a.x),r.NG()),S(e)},t.prototype.CD=function(e){var o,n,r,a=this,s=a.kT.kj,u={e:e,r:l};if(t.ao(a,"preProcessMouseUp",u),!(u.r||s.getSelections()&&s.getSelections().length>0))return o=e.target,n=a.wT,(r=s.mm).lV=!1,r.RG(),o&&(a.mV(e),a.UU&&(i.GC$(a.UU).remove(),a.UU=null,a.qS=!1,a.kv=!1),a.uC(),n.WU.XU=!1,a.fV(e)),S(e)},t.prototype.gV=function(t){var e,o,n,r,a,s=this,l=s.MT;if(l.length>0&&(s.NU===P.active||s.NU===P.edit))for(e=s.DT,o=t.pageX-i.GC$(e).offset().left,n=t.pageY-i.GC$(e).offset().top,r=0;r<l.length;r++)if((a=l[r])&&a.contains(o,n))return r;return-1},t.prototype._U=function(t,e,o){var n,r,i=-1,a=-1;switch(o){case 0:i=0,a=0;break;case 1:i=2,a=0;break;case 2:i=0,a=2;break;case 3:i=2,a=2;break;case 4:i=0,a=1;break;case 5:i=2,a=1;break;case 6:i=1,a=0;break;case 7:i=1,a=2}return n=this.nV(t,i),r=this.oV(e,a),Y(n.x,r.y,n.w,r.h)},t.prototype.nV=function(t,e){var o,n,r=2*this.NT,i=this.wT.WU,a=Q(i.$U)-r;return 0===e?a-=t:2===e&&(a+=t),o=i.$U.x,a>=0?0===e&&(o+=t):0===e?o+=Q(i.$U)-r:2===e&&(o+=a),n=Q(i.$U),1!==e&&(n=d(a)+r),{x:o,w:n}},t.prototype.oV=function(t,e){var o,n,r=2*this.NT,i=this.wT.WU,a=K(i.$U)-r;return 0===e?a-=t:2===e&&(a+=t),o=i.$U.y,a>=0?0===e&&(o+=t):0===e?o=K(i.$U)-r:2===e&&(o+=a),n=K(i.$U),1!==e&&(n=d(a)+r),{y:o,h:n}},t.prototype.FU=function(t){var e,o,n=this,r=n.kT.kj;if(t){switch(e=u,t){case n.DT:e=D.wGc;break;case n.ET:e=D.xGc;break;case n.KT:e=D.yGc;break;case n.qo:e=D.zGc;break;case n.BF:e=D.AGc}e&&(i.GC$(t).unbind(D.aHc+e).unbind(D.eGc+e),o=function(t){r.RF(t),S(t)},i.GC$(t).bind(D.aHc+e,o).bind(D.eGc+e,o))}},t.prototype.RT=function(t,e){var o,n=this,r=n.kT,a=r&&r.kj;n.XT(t,e),o=function(t){ft(a,t)},i.GC$(t).bind(D.ZGc+e,(function(t){n.iV(t)})).bind(D.$Gc+e,(function(t){n.BD(t)})).bind(D._Gc+e,(function(t){n.CD(t)})).bind(D.aHc+e,o).bind(D.eGc+e,o)},t.prototype.XT=function(t,e){i.GC$(t).unbind(e)},t.prototype.QT=function(){var t,e,o=this,n=o.kT,r=n&&n.kj,a=o.wT;o.ZT(),r&&(t=r.Vs(),e=function(t){r.RF(t)},i.GC$(o.LT).bind(D.ZGc+D.TGc,(function(e){var n,s,l=r.ITa.Ky.hitTest(e.pageX-t.left,e.pageY-t.top);l?(n=l.comment,s=a.pT(n),l.area===D.LGc?s.hV(e):l.area===D.MGc&&s.iV(e),i.GC$(s.JT).css(D.oGc,parseInt(i.GC$(o.KT).css(D.oGc)+1,10))):r.OF(e)})).bind(D.$Gc+D.TGc,(function(e){var n,i,s=r.ITa.Ky.hitTest(e.pageX-t.left,e.pageY-t.top),u=o.LT.style;s?(n=s.comment,a.pT(n).BD(e),s.area===D.LGc?u.cursor=D.EGc:s.area===D.MGc&&(u.cursor=D.dGc)):(r.PF(e),o.wT.tT(l),(i=r.Ws())&&(u.cursor=i.style.cursor))})).bind(D._Gc+D.TGc,(function(e){var o,n=r.ITa.Ky.hitTest(e.pageX-t.left,e.pageY-t.top);n?(o=n.comment,a.pT(o).CD(e)):r.QF(e)})).bind("dblclick"+D.TGc,(function(t){r.TF(t)})).bind(D.aHc+D.TGc,e).bind(D.eGc+D.TGc,e))},t.prototype.ZT=function(){i.GC$(this.LT).unbind(D.TGc)},t.prototype.UT=function(){var t,e=this,o=e.kT,n=o&&o.kj;o.commentState()!==P.edit&&e.qo&&(e.YT(),t=function(t){ft(n,t)},i.GC$(e.qo).bind(D.ZGc+D.zGc,(function(t){e.hV(t)})).bind(D.$Gc+D.zGc,(function(t){e.BD(t)})).bind(D._Gc+D.zGc,(function(t){e.CD(t)})).bind(D.aHc+D.zGc,t).bind(D.eGc+D.zGc,t))},t.prototype.YT=function(){var t=this;t.kT.commentState()!==P.edit&&t.qo&&i.GC$(t.qo).unbind(D.zGc)},t.prototype.TT=function(){var t,e=this,o=e.kT,n=o&&o.kj,r=e.BF;o.commentState()===P.edit&&r&&(this.$T(),t=function(t){n&&(n.RF(t),w.nl(t))},i.GC$(r).bind(D.ZGc+D.AGc,(function(t){t.stopPropagation()})).bind(D.$Gc+D.AGc,(function(t){t.stopPropagation()})).bind(D._Gc+D.AGc,(function(t){t.stopPropagation()})).bind(D.aHc+D.AGc,t).bind(D.eGc+D.AGc,t).bind("input"+D.AGc,(function(){o.autoSize()&&e.pV()})).bind("keydown"+D.AGc,(function(t){27!==t.keyCode&&9!==t.keyCode||(o.commentState(P.active),S(t),v.Zl(n))})).bind("focusout"+D.AGc,(function(){i.GC$(r).val()!==o.text()&&n.wu().execute({cmd:"changeComment",sheetName:n.name(),row:o.nT,col:o.oT,oldValue:o.text(),newValue:i.GC$(r).val(),propertyName:D.EGc})})))},t.prototype.pV=function(){var t,e,o,n,r,a,s,l,u,f,h,p,d,g,m,y,C,v,b,w=this,T=w.kT,S=T&&T.kj;if(T.commentState()===P.edit?e=(t=w.BF).value.split("\n"):(t=w.qo,e=M.Pb(t.innerHTML).split("\n")),o=i.GC$(t).height(),n=i.GC$(t).width(),s=0,u="",(l=t.style).font?(s=ct(e,u),u+=l.font):(T.fontStyle()&&(u+=D.IGc+T.fontStyle()),T.fontWeight()&&(u+=D.IGc+T.fontWeight()),T.fontSize()&&(u+=D.IGc+T.fontSize()),T.fontFamily()&&(u+=D.IGc+T.fontFamily()),s=ct(e,u)),f=s,5,e&&e.length>0){for(r=f,h=0,p=0;p<e.length;p++)h<(d=S.rt(e[p],u))&&(h=d);a=c(h,5)}else r=f,a=5;i.GC$(t).css(D.jGc,r).css(D.iGc,a),2===T.commentState()&&T.text(t.value),w.qV=!0,g=S.am(),m=w.zT(),y=r-o,C=T.height()+y,0!==y&&(m.y+C<=g.y+g.height?(w.fJc=!1,T.height(C)):w.fJc=!0),v=a-n,b=T.width()+v,0!==v&&(m.x+b<=g.x+g.width?(w.fJc=!1,T.width(b)):w.fJc=!0),w.qV=!1},t.prototype.$T=function(){var t=this.BF;t&&i.GC$(t).unbind(D.AGc)},t.prototype.tC=function(){var t=this,e=t.wT.WU;e.XU||(i.GC$(N).bind(D.$Gc+D.UGc,(function(e){t.BD(e)})).bind(D._Gc+D.UGc,(function(e){t.CD(e)})),e.XU=!0)},t.prototype.uC=function(){var t=this.wT.WU;t.XU&&(t.XU=!1,i.GC$(N).unbind(D.UGc))},t}(),e.GV=z,r.Zn(z),U=function(){function t(t){var e=this;e.kj=t,e.WU={XU:!1,x:0,y:0,$U:l,ZU:-1},e.xT=l,e.bU=l,e.rV=l,e.sV=[],e.wTa=0,e.jT=[],e.tV(),e.uV(),e.xn={}}return t.prototype.dispose=function(t){var e=this;e.all().forEach((function(t){e.hT(t)})),e.Uka(),!1!==t&&(e.kj=l)},t.prototype.add=function(t,e,o){var n,r,a=this,s=a.kj,u=s.getSpan(t,e);return!u||u.row===t&&u.col===e?(n=a.get(t,e),r="string"==typeof o?new G(o):o,a.Cz(t,e,r),s.Bq("comment",t,e,i.SheetArea.viewport,n,r),r):l},t.prototype.Cz=function(t,e,o,n){var r=this,i=r.kj,a=r.sV;r.vV(t,e),o&&(i.ITa.UUa({type:"add",row:t,col:e}),o.nT=t,o.oT=e,o.kj=i,a.push(o),o.mi=r.wTa,r.wTa++,r.JUa(t,e,o),n||i.$p())},t.prototype.get=function(t,e){return this.xn[t+"_"+e]||l},t.prototype.JUa=function(t,e,o){this.xn[t+"_"+e]=o},t.prototype.VUa=function(t,e,o){var n=t.nT,r=t.oT;this.get(n,r)===t&&this.JUa(n,r,u),this.kj.ITa.UUa({type:"rowcol",comment:t,row:n,col:r}),t.nT=e,t.oT=o,this.JUa(e,o,t)},t.prototype.remove=function(t,e){var o=this.vV(t,e),n=this.kj;o&&(n.Bq("comment",t,e,i.SheetArea.viewport,o,u),n.$p())},t.prototype.vV=function(t,e){var o=this,n=o.kj,r=o.get(t,e);return r&&(n.ITa.UUa({type:"remove",row:t,col:e,comment:r}),o.hT(r),C.Fb(o.sV,r),C.Fb(o.jT,o.pT(r)),o.JUa(t,e,u)),r},t.prototype.clear=function(t){var e,o,n,r,i=this,a=i.kj,s=i.sV;for(a.suspendPaint(),e=s.length-1;e>=0;e--)n=(o=s[e]).nT,r=o.oT,(!t||n>=t.row&&n<t.row+t.rowCount&&r>=t.col&&r<t.col+t.colCount)&&i.remove(n,r);a.resumePaint()},t.prototype.all=function(){return this.sV.concat()},t.prototype.qUa=function(t,e,o,n,r,i){(t||n)&&(t&&this.VUa(t,r,i),n&&this.VUa(n,e,o))},t.prototype.getOuterContainer=function(t){var e=this.pT(t);return e?e.JT:l},t.prototype.tV=function(){var t=y(D.SGc);i.GC$(t).addClass("gc-comment-editor").css(D.fGc,0).css(D.OLb,0).css(D.kGc,D.lGc).css("margin",0).css(D.sGc,0).css("word-wrap","break-word").css("word-break","normal").css(D.mGc,D.pGc).css("resize","none").css("outline","none").css("border","0px").css(D.qGc,D.rGc).css(D.WGc,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.xT=t},t.prototype.uV=function(){var t=this,e=t.kj;e&&(e.Fu(T.ColumnChanged+D.vGc,(function(e,o){var n=o.propertyName;n!==D.iGc&&"isVisible"!==n||t.wV()})),e.Fu(T.RowChanged+D.vGc,(function(e,o){var n=o.propertyName;n!==D.jGc&&"isVisible"!==n||t.wV()})),e.Fu(T.ColumnWidthChanged+D.vGc,(function(){t.wV()})),e.Fu(T.RowHeightChanged+D.vGc,(function(){t.wV()})),e.Fu(T.CommentChanged+D.vGc,(function(e,o){var n,r,i,a;o&&(n=o.propertyName,r=o.comment,(i=t.pT(r))&&(a=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"],"location"===n?i.fU():n===D.iGc||n===D.jGc?i.gU():a.indexOf(n)>=0&&r.autoSize()&&!i.qV&&i.pV()))})))},t.prototype.Uka=function(){var t=this.kj;t&&t.Gu(D.vGc)},t.prototype.pT=function(t){var e,o,n=this.jT;if(t)for(e=0;e<n.length;e++)if((o=n[e]).kT===t)return o;return l},t.prototype.iT=function(){return 0===this.sV.length},t.prototype.xV=function(){var t,e,o,n=this.sV;if(n.length>0){for(t=n[0].zIndex(),e=1;e<n.length;e++)t<(o=n[e]).zIndex()&&(t=o.zIndex());return t}return 0},t.prototype.rI=function(t,e){var o,n,r,i,a=this,s=a.sV,l=a.jT;for(o=0;o<s.length;o++)t<=(n=s[o]).nT&&a.VUa(n,n.nT+e,n.oT);for(r=0;r<l.length;r++)(i=l[r]).sU()&&i.rI(t,e)},t.prototype.tI=function(t,e){var o,n,r,i,a=this,s=a.sV,l=a.jT;for(o=0;o<s.length;o++)t<=(n=s[o]).oT&&a.VUa(n,n.nT,n.oT+e);for(r=0;r<l.length;r++)(i=l[r]).sU()&&i.tI(t,e)},t.prototype.GR=function(t,e){var o,n,r,i,a,s=this,l=s.sV,u=s.jT;for(o=l.length-1;o>=0;o--)r=(n=l[o]).nT,i=n.oT,r>=t&&r<t+e&&s.remove(r,i);for(o=0;o<l.length;o++)t<(n=l[o]).nT&&s.VUa(n,n.nT-e,n.oT);for(o=0;o<u.length;o++)(a=u[o]).sU()&&a.GR(t,e)},t.prototype.HR=function(t,e){var o,n,r,i,a,s=this,l=s.sV,u=s.jT;for(o=l.length-1;o>=0;o--)r=(n=l[o]).nT,(i=n.oT)>=t&&i<t+e&&s.remove(r,i);for(o=0;o<l.length;o++)t<(n=l[o]).oT&&s.VUa(n,n.nT,n.oT-e);for(o=0;o<u.length;o++)(a=u[o]).sU()&&a.HR(t,e)},t.prototype.JU=function(){return this.rV},t.prototype.GU=function(t){var e=this;t&&t!==e.rV&&(e.vQ(),e.rV=t)},t.prototype.vQ=function(){var t,e=this,o=e.rV;o&&(!(t=e.pT(o))||t.qS||t.kv||(t.ST()&&t.HU(),o.commentState(P.normal),e.rV=l))},t.prototype.Ao=function(t){var e=this,o=e.pT(t),n=!1;o||(n=!0,o=new z(t,e),e.jT.push(o)),o.OT(),(n&&t.autoSize()&&!o.qV||t.autoSize()&&o.fJc)&&o.pV()},t.prototype.tT=function(t){var e=this,o=e.rV;if(o)if(1===o.displayMode()){if(o.commentState()===P.edit)return}else if(o.commentState()===P.edit||o.commentState()===P.active)return;t!==e.bU&&(e.bU&&e.hT(e.bU),t&&2===t.displayMode()?e.WU.XU||t.yV||(e.bU=t,t.yV=O.setTimeout((function(){e.Ao(t)}),200)):e.bU=l)},t.prototype.hT=function(t){var e=this,o=e.pT(t);o&&o.sU()&&(o.WT(),t===e.rV&&e.kj.GJ()),clearTimeout(t.yV),delete t.yV},t.prototype.zV=function(){var t=this.kj.nQ&&this.kj.nQ();t&&i.GC$(t.PT).show()},t.prototype.AV=function(){var t=this.kj.nQ&&this.kj.nQ();t&&i.GC$(t.PT).hide()},t.prototype.BV=function(t,e,o){var n,r=this.pT(t);return!(!r||!(n=r.dV()))&&n.contains(e,o)},t.prototype.CV=function(t,e,o){var n,r=this.pT(t);return!(!r||!(n=r.eV()))&&n.contains(e,o)},t.prototype.hitTest=function(t,e){var o,n,r=this,i=l;for(o=0;o<r.sV.length;o++)n=r.sV[o],$(r.kj,n)&&r.BV(n,t,e)&&(i?n.zIndex()>i.zIndex()&&(i=n):i=n);return i?{x:t,y:e,comment:i,area:r.CV(i,t,e)?D.LGc:D.MGc}:l},t.prototype.KU=function(t){var e=this,o=e.xV();return t===e.bU?o+2:t===e.rV?o+1:t.zIndex()},t.prototype.wV=function(){this.jT.forEach((function(t){t.hU()}))},t.prototype.cQ=function(){this.jT.forEach((function(t){t.qT()}))},t.prototype.fromJSON=function(t,e){var o,n,r,i=this;if(t&&0!==t.length){for(i.wTa=0,o=0;o<t.length;o++)n=t[o],(r=new G).fromJSON(n,e),3!==r.commentState()&&(i.rV=r),i.kj.ITa.Ky.Cz(r.nT,r.oT,r,!0);i.kj.$p()}},t.prototype.toJSON=function(){var t,e,o=this.sV;if(!o||0===o.length)return u;for(t=[],e=0;e<o.length;e++)t.push(o[e].toJSON());return 0===t.length?u:t},t}(),W=function(){function t(t){var e=this;e.kj=l,e.oQ=!0,e.PT=e.DV(),t.appendChild(e.PT)}return t.prototype.no=function(){this.kj=l},t.prototype.DV=function(){var t=y(D.uGc);return i.GC$(t).addClass("gc-comment-layoutPanel"+D.IGc+D.HGc).css([D.kGc,D.fGc,D.OLb,D.jGc,D.iGc,D.mGc,D.oGc,D.JGc],[D.lGc,0,0,0,0,D.nGc,D.FGc,D.KGc]),t},t.prototype.rT=function(t){var e,o,n=this;t.ITa.Ky.iT()||(e=t.am(),i.GC$(n.PT).css(D.fGc,e.x+e.Br).css(D.OLb,e.y+e.Cr),n.kj!==t&&(n.kj&&((o=n.kj.ITa.Ky.JU())&&o.commentState()===P.edit&&o.commentState(P.active)),n.kj=t))},t.prototype.sT=function(t,e,o){var n,r,a,s=o.row,l=o.col,u=o.x,c=o.y,f=Q(o),h=K(o);e===i.SheetArea.viewport&&this.kj&&((n=this.kj.ITa.Ky.get(s,l))&&(r=this.kj,a=(n.indicatorSize()||6)*(r?r.zoom():1),t&&f>0&&h>0&&(t.save(),t.rect(u,c,f,h),t.clip(),t.fillStyle=n.indicatorColor()||"red",t.beginPath(),t.moveTo(u+f-a,c),t.lineTo(u+f,c),t.lineTo(u+f,c+a),t.lineTo(u+f-a,c),t.fill(),t.restore())))},t.prototype.fT=function(t){var e,o,n,r,i,a,s;if(this.oQ){for(t.zV(),e=this.kj,o=t.all(),n=0;n<o.length;n++)r=o[n],i=t.pT(r),this.EV(t,r)?(1===r.displayMode()&&r===t.bU&&(t.bU=l),i&&i.sU()?i.VT():t.Ao(r)):i&&i.sU()&&t.hT(r);(a=t.JU())&&((s=t.pT(a))&&s.sU()&&e.getSelections().length>0&&e.ITa.do("clearSelection"))}else t.AV()},t.prototype.EV=function(t,e){var o=t.kj;if(o&&rt(o,e.oT)&&nt(o,e.nT))switch(e.displayMode()){case 1:return!0;case 2:if(3!==e.commentState())return t&&e!==t.bU&&(t.bU=e),!0;if(e===t.bU)return!0}return!1},t}(),q=r.lUa,r.GC$.extend(q.prototype,{UUa:function(t){var e,o=this.zTa;o&&((e=o.WUa)||(e=o.WUa=[]),e.push(t))},XUa:function(t){var e,o,n,r,i,a;if(t)for(this,e=this.Ky,o=t.length-1;o>=0;o--)r=(n=t[o]).comment,"add"===n.type?e.vV(n.row,n.col):"remove"===n.type?e.Cz(n.row,n.col,n.comment):"property"===n.type?(i=n.name,a=n.value,r[i](a)):"rowcol"===n.type&&e.VUa(r,n.row,n.col)},wyb:function(t,e,o,n){var r,i;for(r=0;r<o;r++)for(i=0;i<n;i++)0===r&&0===i||this.getCell(t+r,e+i).comment()&&this.comments.remove(t+r,e+i)}}),q.$n("comments",{init:function(){this.Ky=new U(this.kj)},undo:function(t){var e=t.WUa;e&&this.XUa(e)},dispose:function(t){var e=this,o=t&&t.clearCache;e.Ky&&e.Ky.dispose(o),!1!==o&&(e.Ky=l)}}),J={init:function(){var t=this;t.comments=t.ITa.Ky,t.nQ=function(){var e=t.parent;if(e)return e.gT||(e.gT=new W(e.xv())),e.gT.kj=t,t.parent.gT}},dispose:function(t){!1!==t.clearCache&&(this.nQ=l,this.comments=l),j(this,i.GC$(this.Ws()))},setHost:function(t){if(t){var e=this.ITa.Ky;e&&e.uV(),E(t,this)}},onLayoutChanged:function(t){var e=this,o=e.ITa.Ky,n=t.changeType,a=t.row,s=t.rowCount,l=t.col,u=t.colCount;"addRows"===n?o.rI(a,s):"deletingRows"===n?o.GR(a,s):"addColumns"===n?o.tI(l,u):"deletingColumns"===n?o.HR(l,u):t.sheetArea===i.SheetArea.viewport&&("clear"===n?4==(4&t.type)&&o.clear(new r.Range(a,l,s,u)):"addSpan"===n?tt.call(e,!0,a,l,s,u):"removeSpan"===n&&tt.call(e,!1,a,l))},paint:function(t){this.ITa.Ky.iT()||(et.call(this),this.RP(t.clipRect))},paintCell:function(t){t.isPrinting||t.sheetArea!==i.SheetArea.viewport||ot.call(this,t.ctx,t.sheetArea,t.cell)},toJson:function(t,e){e&&e.ignoreStyle||(t.comments=this.ITa.Ky.toJSON())},fromJson:function(t,e,o){var n;o&&o.ignoreStyle||t&&((n=e?t.commentManager:t.comments)&&this.ITa.Ky.fromJSON(n,e))},lastNonNullRowAndCol:function(){var t,e,o,n,r=0,i=0,a=this.ITa.Ky;if(a&&((t=a.jT)&&t.length>0))for(e=0,o=t.length;e<o;e++)(n=t[e])&&n.kT&&(n.lT>r&&(r=n.lT),n.mT>i&&(i=n.mT));return{lastNonNullRow:r,lastNonNullCol:i}},clearSelection:function(){this.ITa.Ky.vQ()},processKeyDown:function(t){var e=this.ITa.Ky.JU();e&&this.mm.LH(t.e)&&(e.commentState(2),t.r=!0)}},s.$n("comments",J),X={init:function(){a.uT(this.commandManager())},dispose:function(){this.gT&&(this.gT.no(),this.gT=l)}},r.Workbook.$n("comments",X)},"./dist/plugins/conditional/conditional.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/conditional/conditional.js")),n(o("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt,Yt,Kt,Qt,$t,te,ee,oe,ne,re,ie=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function ae(t){return t.rowCount}function se(t){return t.colCount}function le(t,e,o,n){switch(n&&"string"==typeof e&&"string"==typeof o&&(e=e.toLowerCase(),o=o.toLowerCase()),t){case lt.equalsTo:return e===o;case lt.notEqualsTo:return e!==o;case lt.greaterThan:return e>o;case lt.greaterThanOrEqualsTo:return e>=o;case lt.lessThan:return e<o;case lt.lessThanOrEqualsTo:return e<=o;default:return!1}}function ue(t,e,o,n,r,i,a,s,l){var u=Math.round;switch(t.lineWidth=1,t.rect(i,a,s,l),o=u(++o),n=u(n),t.clip(),e.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:c.drawArrows(t,e.iconSetType,e.iconIndex,o,n,r);break;case 2:c.drawIconTypeIsTwo(t,e.iconSetType,e.iconIndex,o,n,r);break;case 3:c.drawStar(t,e.iconSetType,e.iconIndex,o,n,r);break;case 14:case 12:case 5:c.drawCircle(t,e.iconSetType,e.iconIndex,o,n,r);break;case 4:c.drawFlag(t,e.iconSetType,e.iconIndex,o,n,r);break;case 6:c.drawTrafficLight(t,e.iconSetType,e.iconIndex,o,n,r);break;case 7:c.drawIconTypeIsSen(t,e.iconSetType,e.iconIndex,o,n,r);break;case 8:c.drawIconTypeIsEight(t,e.iconSetType,e.iconIndex,o,n,r);break;case 9:c.drawIconTypeIsNine(t,e.iconSetType,e.iconIndex,o,n,r);break;case 18:c.drawSector(t,e.iconSetType,e.iconIndex,o,n,r);break;case 17:case 13:c.drawSignal(t,e.iconSetType,e.iconIndex,o,n,r);break;case 19:c.drawMagicCube(t,e.iconSetType,e.iconIndex,o,n,r)}}function ce(t,e,o){var n=[],r=t.row,i=t.rowCount,a=t.col,s=t.col+t.colCount-1;return a<e?e<=s&&s<=o?(n[0]=H(r,a,i,e-a),n[1]=H(r,e,i,s-e+1)):s>o&&(n[0]=H(r,a,i,e-a),n[1]=H(r,e,i,o-e+1),n[2]=H(r,o+1,i,s-o)):a<=o&&(e<=s&&s<=o?n[1]=t:s>o&&(n[1]=H(r,a,i,o-a+1),n[2]=H(r,o+1,i,s-o))),n}function fe(t,e,o){var n=[],r=t.col,i=t.colCount,a=t.row,s=t.row+t.rowCount-1;return a<e?e<=s&&s<=o?(n[0]=H(a,r,e-a,i),n[1]=H(e,r,s-e+1,i)):s>o&&(n[0]=H(a,r,e-a,i),n[1]=H(e,r,o-e+1,i),n[2]=H(o+1,r,s-o,i)):a<=o&&(e<=s&&s<=o?n[1]=t:s>o&&(n[1]=H(a,r,o-a+1,i),n[2]=H(o+1,r,s-o,i))),n}function he(t,e,o,n){var r=e.ranges(),i=L(r),a=u.formulaToExpression(t,o,i.r,i.c,n);return u.expressionToFormula(t,a,i.r,i.c,!n)}function pe(t){return"string"==typeof t&&("="!==(t=f.trim(t))[0]&&(t='="'+h.Gb(t,'"','""')+'"')),t}function de(t,e){if(e)for(var o=0;o<e.length;o++)t.push(e[o])}function ge(t){var e,o,n=[],r=X(t);for(o=0;o<r;o++)e=t[o],n.push(H(e.row,e.col,ae(e),se(e)));return n}function me(t,e){var o,n;for(o=0;o<t.length;o++)if((n=t[o])&&n.equals(e))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("@grapecity/js-calc"),a=o("./dist/plugins/conditional/conditional.ns.js"),s=o("@grapecity/js-calc"),l=o("Core"),u=o("SheetsCalc"),c=o("./dist/plugins/conditional/conditionalFormatIcon.js"),f=r.GC$,h=n.Common.u,p=null,d=void 0,g="undefined",m="string",y=Math.min,C=Math.max,v=Math.abs,b=Math.floor,w=Math.ceil,T=i.Convert,S=T.Na,x=T.Pa,A=T.Th,I=n.Common.u,R=I.Db,M=I.kb,k=I.jb,N=I.Bb,O=n.Common.j.Fa,D=n.Common.q,F=n.Common.F,E=r.Ul,j=r.Zn,P=E.T$a,L=E.l_a,G=!!i,B=r.Style,n.Common.k,_=n.Common.pc,V=_.bc,H=r.kf,z=r.Range,U=n.Common.l,W=n.Common.k,q=W.Fb,J=W.Cb,X=W.ac,Z=i.Functions,Y=i.evaluateOperator,K=r.Rm,Q=new n.Common.ResourceManager(a.SR,"ConditionalFormatting"),$=Q.getResource.bind(Q),tt=function(t){return/[\f\n\r\t\v]/.test(t)},et=function(t){var e=t.row<0?u.BAND_INDEX_CONST:t.row,o=t.col<0?u.BAND_INDEX_CONST:t.col;return s.uf(p,p,e,o,e+t.rowCount-1,o+t.colCount-1)},ot=function(t){var e;if(t instanceof i.Expression)e=t;else if(t instanceof z)e=et(t);else{if(!S(t))throw $().Exp_NotSupport;t=x(t),isNaN(t)||((e=new i.Expression(2)).value=t)}return e},nt=function(t,e,o,n){var r=t,i=e,a=function(t,e){var a,s,l=this;return l.hasOwnProperty("_ps")||(l._ps={}),a=l._ps,0===arguments.length?a[r]!==d?n?n.call(l,a[r]):a[r]:i:(a[r]!==t&&(s=a[r]!==d?a[r]:i,a[r]=t,!1!==e&&o&&o.call(l,t,s)),l)};return a.isDefault=function(t){return t===i},a},rt=function(t,e,o){var n=this;return o||(o={}),e||(e=n),O(n.pivotTableName)||(o.pivot=!0),f.each(e,(function(e,r){var i,a=n[r];O(a)||(i=a.call(n),"formula"===r?(n.getFormulaString?i=n.getFormulaString(t,d,d,!0):n.condition()&&n.condition().getFormulaString&&(i=n.condition().getFormulaString(t,d,d,!0)),i&&(o[r]=i)):"iconCriteria"===r||"icons"===r?o[r]=i:U.Ska(i)?o[r]=U.Daa(i):i&&i.toJSON?o[r]=i.toJSON(t):O(i)||a.isDefault(i)||(o[r]=i))})),o},it=function(t,o,n,r){if(n){var i,a=this;o||(o=a),f.each(o,(function(o,s){var l,u,c,h,p,d,g,y,C,v;if(i=n[s],!O(i))if("ranges"===s){for(l=[],u=0;u<i.length;u++)c=i[u],l.push(H(c.row,c.col,ae(c),se(c)));a.ranges(l,!1)}else if("style"===s)a.style(new B,!1),a.style().fromJSON(i,r);else if("iconCriteria"===s)for(h=i.length,p=0;p<h;p++)d=i[p],a.NV[p]=new Qt(d.isGreaterThanOrEqualTo,d.iconValueType,d.iconValue);else if("icons"===s)for(g=i.length,y=0;y<g;y++)C=i[y],a.CZa[y]={iconSetType:C.iconSetType,iconIndex:C.iconIndex};else"iconSetType"===s?a[s](i,!0):"item1"===s||"item2"===s?(a[s](e.$V(),!1),a[s]().fromJSON(i,t)):"expected"===s?f.getType(i)!==m||5!==n.conType&&13!==n.conType?a[s](i,!1):"/OADate("===i.substr(0,8)?a[s](U.Rka(i),!1):a[s](new Date(i)):"condition"===s?((v=new Bt).fromJSON(i,t),a.condition(v,!1)):f.getType(i)===m&&"/OADate("===i.substr(0,8)?a[s](U.Rka(i),!1):a[s](i,!1)}))}},at=r.lUa,f.extend(at.prototype,{YUa:function(){var t=this.zTa;t&&!t.pXc&&(t.pXc=this.U5.AW.map((function(t){return{rule:t,ranges:t.ranges().slice()}})))},$Ua:function(t){var e=this.U5,o=this.kj;o.suspendPaint(),t&&(0===t.length&&e.AW&&1===e.AW.length&&e.constructor.ao(o,"onRuleUpdated",{ranges:e.AW[0].ranges()}),e.AW=t.map((function(t){var n=t.rule;return n.ranges(t.ranges),e.constructor.ao(o,"onRuleUpdated",{ranges:n.ranges()}),n})),e.QV()),o.resumePaint()},_Ua:function(t,e,o,n){this.YUa(),this.U5.rI(t,e,o,n)},aVa:function(t,e,o,n){this.YUa(),this.U5.GR(t,e,o,n)},bVa:function(t,e,o,n){this.YUa(),this.U5.tI(t,e,o,n)},cVa:function(t,e,o,n){this.YUa(),this.U5.HR(t,e,o,n)},dVa:function(){this.YUa(),this.U5.Nm()},eVa:function(){this.YUa(),this.U5.QV()}}),at.$n("conditionalFormat",{init:function(){this.U5=new re(this.kj)},undo:function(t){var e=t.pXc;e&&this.$Ua(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.U5&&(e.U5.no(),e.U5=p)}}),st={init:function(){this.conditionalFormats=this.ITa.U5},dispose:function(t){if(!1!==t.clearCache){var e=this.conditionalFormats;e&&e.OV()}},onLayoutChanged:function(t){var e=t.changeType,o=t.row,n=ae(t),r=t.col,i=se(t),a=t.sheetArea,s=this.ITa,l=this.tables;"addRows"===e?s._Ua(o,n,l&&l.KFc(o,-1,n,-1,!0),!1):"deleteRows"===e?s.aVa(o,n):"addColumns"===e?s.bVa(r,i):"deleteColumns"===e?s.cVa(r,i):"clear"===e?s.dVa():"setColumnCount"!==e&&"setRowCount"!==e||3!==a&&1!==a||s.eVa()},toJson:function(t,e){var o=this.conditionalFormats,n=e&&e.ignoreStyle;o&&!n&&(t.conditionalFormats=o.toJSON(this))},fromJson:function(t,e,o){var n=o&&o.ignoreStyle;t&&t.conditionalFormats&&!n&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,e,!0)}},r.Worksheet.$n("conditionalFormat",st),r.Workbook.$n("conditionalFormat",{fromJson:function(t,e,o){this.sheets.forEach((function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach((function(t){t.S$a()}))}))},onCultureChanged:function(){$()}}),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(lt=e.GeneralComparisonOperators||(e.GeneralComparisonOperators={})),ut=[9,10,13,14,11,12],function(t){t[t.or=0]="or",t[t.and=1]="and"}(ct=e.LogicalOperators||(e.LogicalOperators={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",t[t.between=6]="between",t[t.notBetween=7]="notBetween"}(ft=e.ComparisonOperators||(e.ComparisonOperators={})),function(t){t[t.contains=0]="contains",t[t.doesNotContain=1]="doesNotContain",t[t.beginsWith=2]="beginsWith",t[t.endsWith=3]="endsWith"}(e.TextComparisonOperators||(e.TextComparisonOperators={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.beginsWith=2]="beginsWith",t[t.doesNotBeginWith=3]="doesNotBeginWith",t[t.endsWith=4]="endsWith",t[t.doesNotEndWith=5]="doesNotEndWith",t[t.contains=6]="contains",t[t.doesNotContain=7]="doesNotContain"}(ht=e.TextCompareType||(e.TextCompareType={})),function(t){t[t.backgroundColor=0]="backgroundColor",t[t.foregroundColor=1]="foregroundColor"}(pt=e.ColorCompareType||(e.ColorCompareType={})),function(t){t[t.empty=0]="empty",t[t.nonEmpty=1]="nonEmpty",t[t.error=2]="error",t[t.nonError=3]="nonError",t[t.formula=4]="formula"}(dt=e.CustomValueType||(e.CustomValueType={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.before=2]="before",t[t.beforeEqualsTo=3]="beforeEqualsTo",t[t.after=4]="after",t[t.afterEqualsTo=5]="afterEqualsTo"}(gt=e.DateCompareType||(e.DateCompareType={})),function(t){t[t.dateOccurring=0]="dateOccurring",t[t.yearOccurring=1]="yearOccurring",t[t.quarterOccurring=2]="quarterOccurring",t[t.monthOccurring=3]="monthOccurring",t[t.weekOccurring=4]="weekOccurring",t[t.dayOccurring=5]="dayOccurring",t[t.yearTodate=6]="yearTodate"}(mt=e.DateExConditionExpectType||(e.DateExConditionExpectType={})),function(t){t[t.top=0]="top",t[t.bottom=1]="bottom"}(e.Top10ConditionType||(e.Top10ConditionType={})),function(t){t[t.today=0]="today",t[t.yesterday=1]="yesterday",t[t.tomorrow=2]="tomorrow",t[t.last7Days=3]="last7Days",t[t.thisMonth=4]="thisMonth",t[t.lastMonth=5]="lastMonth",t[t.nextMonth=6]="nextMonth",t[t.thisWeek=7]="thisWeek",t[t.lastWeek=8]="lastWeek",t[t.nextWeek=9]="nextWeek",t[t.nextQuarter=10]="nextQuarter",t[t.thisQuarter=11]="thisQuarter",t[t.lastQuarter=12]="lastQuarter",t[t.nextYear=13]="nextYear",t[t.thisYear=14]="thisYear",t[t.lastYear=15]="lastYear"}(yt=e.DateOccurringType||(e.DateOccurringType={})),function(t){t[t.quarter1=0]="quarter1",t[t.quarter2=1]="quarter2",t[t.quarter3=2]="quarter3",t[t.quarter4=3]="quarter4"}(Ct=e.QuarterType||(e.QuarterType={})),function(t){t[t.above=0]="above",t[t.below=1]="below",t[t.equalOrAbove=2]="equalOrAbove",t[t.equalOrBelow=3]="equalOrBelow",t[t.above1StdDev=4]="above1StdDev",t[t.below1StdDev=5]="below1StdDev",t[t.above2StdDev=6]="above2StdDev",t[t.below2StdDev=7]="below2StdDev",t[t.above3StdDev=8]="above3StdDev",t[t.below3StdDev=9]="below3StdDev"}(vt=e.AverageConditionType||(e.AverageConditionType={})),function(t){t[t.number=0]="number",t[t.lowestValue=1]="lowestValue",t[t.highestValue=2]="highestValue",t[t.percent=3]="percent",t[t.percentile=4]="percentile",t[t.automin=5]="automin",t[t.formula=6]="formula",t[t.automax=7]="automax"}(bt=e.ScaleValueType||(e.ScaleValueType={})),function(t){t[t.leftToRight=0]="leftToRight",t[t.rightToLeft=1]="rightToLeft"}(e.BarDirection||(e.BarDirection={})),function(t){t[t.automatic=0]="automatic",t[t.cellMidPoint=1]="cellMidPoint",t[t.none=2]="none"}(e.DataBarAxisPosition||(e.DataBarAxisPosition={})),function(t){t[t.threeArrowsColored=0]="threeArrowsColored",t[t.threeArrowsGray=1]="threeArrowsGray",t[t.threeTriangles=2]="threeTriangles",t[t.threeStars=3]="threeStars",t[t.threeFlags=4]="threeFlags",t[t.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",t[t.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",t[t.threeSigns=7]="threeSigns",t[t.threeSymbolsCircled=8]="threeSymbolsCircled",t[t.threeSymbolsUncircled=9]="threeSymbolsUncircled",t[t.fourArrowsColored=10]="fourArrowsColored",t[t.fourArrowsGray=11]="fourArrowsGray",t[t.fourRedToBlack=12]="fourRedToBlack",t[t.fourRatings=13]="fourRatings",t[t.fourTrafficLights=14]="fourTrafficLights",t[t.fiveArrowsColored=15]="fiveArrowsColored",t[t.fiveArrowsGray=16]="fiveArrowsGray",t[t.fiveRatings=17]="fiveRatings",t[t.fiveQuarters=18]="fiveQuarters",t[t.fiveBoxes=19]="fiveBoxes",t[t.noIcons=20]="noIcons"}(wt=e.IconSetType||(e.IconSetType={})),function(t){t[t.number=1]="number",t[t.percent=4]="percent",t[t.formula=7]="formula",t[t.percentile=5]="percentile"}(Tt=e.IconValueType||(e.IconValueType={})),function(t){t[t.contains=0]="contains"}(St||(St={})),function(t){t[t.relationCondition=0]="relationCondition",t[t.numberCondition=1]="numberCondition",t[t.textCondition=2]="textCondition",t[t.colorCondition=3]="colorCondition",t[t.formulaCondition=4]="formulaCondition",t[t.dateCondition=5]="dateCondition",t[t.dateExCondition=6]="dateExCondition",t[t.textLengthCondition=7]="textLengthCondition",t[t.top10Condition=8]="top10Condition",t[t.uniqueCondition=9]="uniqueCondition",t[t.averageCondition=10]="averageCondition",t[t.cellValueCondition=11]="cellValueCondition",t[t.areaCondition=12]="areaCondition",t[t.timeCondition=13]="timeCondition",t[t.stateCondition=14]="stateCondition"}(xt=e.ConditionType||(e.ConditionType={})),function(t){t[t.conditionRuleBase=0]="conditionRuleBase",t[t.cellValueRule=1]="cellValueRule",t[t.specificTextRule=2]="specificTextRule",t[t.formulaRule=3]="formulaRule",t[t.dateOccurringRule=4]="dateOccurringRule",t[t.top10Rule=5]="top10Rule",t[t.uniqueRule=6]="uniqueRule",t[t.duplicateRule=7]="duplicateRule",t[t.averageRule=8]="averageRule",t[t.twoScaleRule=10]="twoScaleRule",t[t.threeScaleRule=11]="threeScaleRule",t[t.dataBarRule=12]="dataBarRule",t[t.iconSetRule=13]="iconSetRule",t[t.rowStateRule=14]="rowStateRule",t[t.columnStateRule=15]="columnStateRule"}(At=e.RuleType||(e.RuleType={})),It=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},Rt=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},Mt=function(t,e){t.setDate(e)},kt=function(t){return t.getDate()},Nt=function(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()},Ot=function(t,e){return e>Rt(t)},Dt=function(t,e){return e>t},Ft=function(t,e){return e<It(t)},Et=function(t,e){return e<t},jt=function(t,e){return t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()&&t.getSeconds()===e.getSeconds()&&t.getMilliseconds()===e.getMilliseconds()},Pt=function(t,e){var o=new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());return new Date(1899,11,30,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())>o},Lt=function(t,e){return!Pt(t,e)&&!jt(t,e)},e.$V=function(t,e,o,n,r,i,a,s,l){return new Bt(t,{compareType:e,expected:o,formula:n,customValueType:r,type:i,ranges:a,item1:s,item2:l})},e.Cxb=new B,Gt=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],Bt=function(){function t(t,e){var o,n;e||(e={}),o=e.formula,(n=this).offsetRow=0,n.offsetCol=0,n.conType("string"==typeof t?xt[t]:t),O(e.compareType)||n.RV(e.compareType),O(e.expected)||n.expected(e.expected),O(o)||n.formula("string"==typeof o?R(f.trim(o),"="):o),O(e.item1)||n.item1(e.item1),O(e.item2)||n.item2(e.item2),O(e.customValueType)||n.customValueType(e.customValueType),O(e.type)||n.type(e.type),n.ranges(e.ranges),n.Lf=p,n.TV=p}return t.prototype.context=function(t){if(1===arguments.length){this.xc=t;var e=this.item1(),o=this.item2();e&&e.context&&e.context(t),o&&o.context&&o.context(t)}return this.xc},t.prototype.j_a=function(t){var e=this,o=e.item1(),n=e.item2();t?e.q$a=!0:e.p$a=!0,o&&o.j_a(t),n&&n.j_a(t)},t.prototype.k_a=function(){var t=this,e=t.item1(),o=t.item2();delete t.q$a,delete t.p$a,e&&e.k_a(),o&&o.k_a()},t.prototype.initExpression=function(t,e,o){var n,r,i,a,s,l=this.item1(),u=this.item2();l&&l.initExpression&&l.initExpression(),u&&u.initExpression&&u.initExpression(),t=t||this.xc,n=this.Yw,t&&n&&!this.Lf&&(this.ranges()?(e=(r=L(this.ranges())).r,o=r.c):(e=e||0,o=o||0),i=t.getCalcService(),a=t.yj(),i&&a&&(s=!1,this.q$a&&(s=!this.p$a),this.Lf=i.parse(a,n,e,o,!1,!0,s)))},t.prototype.expression=function(t,e,o,n){var r,i,a;return 1===arguments.length?(this.Lf=t,e=e||this.xc,t?e&&(this.ranges()?(o=(r=L(this.ranges())).r,n=r.c):(o=o||0,n=n||0),i=e.getCalcService(),a=e.yj(),i&&a&&(this.Yw=i.unparse(a,t,o,n))):this.Yw=t,this.Lf):(this.Lf||this.initExpression(e,o,n),this.Lf)},t.prototype.getFormulaString=function(t,e,o,n){var r,i,a;return t=t||this.xc,r=this.Lf,i=this.Yw,t&&i?(r||(this.initExpression(t,e,o),r=this.Lf),i&&(r.value&&14===r.value.type||r.value2&&14===r.value2.type)?i:(a=L(this.ranges()),e=O(e)?a.r:e,o=O(o)?a.c:o,t.getCalcService().unparse(t.yj(),r,e,o,d,!!n))):i},t.prototype.formula=function(t,e,o){if("string"!=typeof t){var n=this.item1(),r=this.item2();return 0===o&&n&&n.formula?n.formula(t,e,o):1===o&&r&&r.formula?r.formula(t,e,o):this.getFormulaString(d,t,e)}this.Yw=t,this.Lf=p},t.prototype.adjustOffset=function(t,e){var o=this,n=o.item1();n&&n.adjustOffset&&n.adjustOffset(t,e),(n=o.item2())&&n.adjustOffset&&n.adjustOffset(t,e),o.offsetRow=t,o.offsetCol=e},t.prototype.relationConditionEvaluate=function(t,e,o,n,r){var i,a,s=this;function l(n,r){if(t&&n&&3===n.conType()){var i=t.getActualStyle(e,o,3,!0);i&&(0===n.RV()?r=i.backColor:1===n.RV()&&(r=i.foreColor))}return r}function u(t,e){if(t)return t.ignoreBlank(s.ignoreBlank()),arguments.length<5?l(t,n):e}function c(n,r){return!O(n)&&n.evaluate(t,e,o,r)}return i=u(s.item1(),n),a=u(s.item2(),r),(c(s.item1(),i)?1:0)+(c(s.item2(),a)?1:0)>s.RV()},t.prototype.cellValueConditionEvaluate=function(t,e,o,n){var r=this.getExpected(t,e,o);return!(r!==p||!t||!t.lRa)||this.cellValueConditionCheckCondition(r,n)},t.prototype.cellValueConditionCheckCondition=function(t,e){var o,n,r,i,a=0,s=!1,l=this.RV();if(O(e)&&O(t))switch(l){case lt.equalsTo:case lt.greaterThanOrEqualsTo:case lt.lessThanOrEqualsTo:return!0;case lt.notEqualsTo:case lt.greaterThan:case lt.lessThan:default:return!1}if("boolean"==typeof t||"boolean"==typeof e)return le(l,e,t);if(o={},O(e))this.treatNullValueAsZero()?s=!0:a=e;else{if(typeof e===m&&"number"==typeof t)return le(l,1,0);"boolean"!=typeof e&&A(e,o)&&(a=o.value,s=!isNaN(a))}return n=0,r=!1,("number"==typeof t||t)&&A(t,o)&&(n=o.value,r=!0),i=ut[l],s?r?le(l,a,n):Y(i,e,t):"string"==typeof e?r?Y(i,e,n):"string"==typeof t?Y(i,e,t):1===l:!!O(e)&&l===lt.notEqualsTo},t.prototype.numberConditionEvaluate=function(t,e,o,n){var r=this.numberConditionGetExpected(t,e,o);return!(r!==p||!t||!t.lRa)||(this.integerValue()&&(r=isNaN(r)?p:r>0?b(r):w(r)),this.numberConditionCheckCondition(r,n))},t.prototype.numberConditionCheckCondition=function(t,e){var o,n,r=this;if((O(e)||""===e)&&r.ignoreBlank())return!0;if(isNaN(e))return!1;if(O(t)){if(r.ignoreBlank())return!0;t=0}try{o=O(e)?0:parseFloat(e)}catch(t){return!1}return!(r.integerValue()&&(n=o-b(o)==0,!n))&&le(r.RV(),o,t)},t.prototype.numberConditionGetExpected=function(t,e,o){var n,r=this;return r.Yw&&r.Yw.length>0?(n=t.Cf())?n.evaluate(t.yj(),r.expression(p,t),e,o):r.expected():r.expected()},t.prototype.textConditionEvaluate=function(t,e,o,n){var r,i,a,s=this,l=s.compareType(),u=s.ignoreCase();function c(t,e){return s.testTextByCondition(e,t,"^","$",(function(){return u?t.toLowerCase()===e.toLowerCase():t===e}))}function f(t,e){return s.testTextByCondition(e,t,"^","",(function(){return M(e,t,u)}))}function h(t,e){return s.testTextByCondition(e,t,"","$",(function(){return k(e,t,u)}))}function g(t,e){return s.testTextByCondition(e,t,"","",(function(){return N(e,t===d||t===p?"":t,u)}))}if(!s.forceValue2Text()&&F(n,Date))return l!==ht.beginsWith&&l!==ht.endsWith&&l!==ht.contains&&(l===ht.doesNotBeginWith||l===ht.doesNotEndWith||l===ht.doesNotContain);if(r=O(n)?"":""+n,s.ignoreBlank()&&""===r)return!0;if(i=this.getExpected(t,e,o),a=O(i)?"":""+i,s.hasWildcard(a)&&"number"==typeof n)return l===ht.doesNotBeginWith||l===ht.doesNotContain||l===ht.doesNotEndWith||l===ht.notEqualsTo;switch(l){case ht.equalsTo:return c(a,r);case ht.notEqualsTo:return!c(a,r);case ht.beginsWith:return f(a,r);case ht.doesNotBeginWith:return!f(a,r);case ht.endsWith:return h(a,r);case ht.doesNotEndWith:return!h(a,r);case ht.contains:return g(a,r);case ht.doesNotContain:return!g(a,r);default:return!1}},t.prototype.hasWildcard=function(t){return t.indexOf("*")>-1||t.indexOf("?")>-1},t.prototype.testTextByCondition=function(t,e,o,n,r){var i;return this.useWildCards()?this.regex()?D.qb(this.regex()).test(t):(i=D.ub(e))?(i=o+i+n,this.ignoreCase()?D.sb(i).test(t):D.qb(i).test(t)):r():r()},t.prototype.colorConditionEvaluate=function(t,e,o,r){var i,a,s,l;function u(t){return O(t)||""===t?p:_.ec(t)}if(a=u((i=this).expected()),O(a)||""===a){if(i.ignoreBlank()||O(a)&&O(r))return!0}else if(s=u(r),(O(s)||""===s)&&t&&t.getDefaultStyle&&(l=t.getDefaultStyle(),i.RV()===pt.backgroundColor?s=l.backColor:i.RV()===pt.foregroundColor&&(s=l.foreColor)),!O(s)&&""!==s)return n.Common.pc.Pka(s,a);return!1},t.prototype.formulaConditionEvaluate=function(t,e,o,n){var r,i,a,s;if(!G)return!1;if((r=this).customValueType()===dt.formula)return t.yj().xc=e,i=r.getExpected(t,e,o),!(!r.ignoreBlank()||!O(i)&&""!==i)||(a={},!!T.Uh(i,a)&&a.value);switch(s=T.vf,r.customValueType()){case dt.empty:return O(n)||""===n;case dt.nonEmpty:return!O(n)&&""!==n;case dt.error:return s(n);case dt.nonError:return!s(n);default:return!1}},t.prototype.formulaConditionGetExpected=function(t,e,o){var n,r,i,a,l,u,c,f=this;if(f.Yw&&f.Yw.length>0){if(!(n=t.Cf()))return f.expected();if(r=n.Hg(t.yj(),f.expression(d,t),s.pf(e,o),!0),i=void 0,a=void 0,l=void 0,u=void 0,c=void 0,T.Fh(r)){for(i=r.getRowCount(0),a=r.getColumnCount(0),l=[],u=0;u<i;u++)for(l[u]=[],c=0;c<a;c++)l[u][c]=r.getValue(0,u,c);r=l}else if(T.Ca(r)){for(i=r.getRowCount(),a=r.getColumnCount(),l=[],u=0;u<i;u++)for(l[u]=[],c=0;c<a;c++)l[u][c]=r.getValue(u,c);r=l}return F(r,Array)?r[0][0]:r}return f.expected()},t.prototype.dateOrTimeEvaluate=function(t,e,o,n,r,i,a){var s,l,u,c=this;if((O(n)||""===n)&&c.ignoreBlank())return!0;if(s=n,!F(n,Date)){if(c.RV()===gt.notEqualsTo)return!0;if(!O(n))return!1;s=U.Xb(0)}if(l=p,u=this.getExpected(t,e,o),F(u,Date)?l=u:"string"==typeof u?l=U.Qa(u):"number"==typeof u&&(l=U.Xb(u)),O(l))return!!c.ignoreBlank();switch(c.RV()){case gt.equalsTo:return r(l,s);case gt.notEqualsTo:return!r(l,s);case gt.after:return a(l,s);case gt.afterEqualsTo:return a(l,s)||r(l,s);case gt.before:return i(l,s);case gt.beforeEqualsTo:return i(l,s)||r(l,s);default:return!1}},t.prototype.dateConditionEvaluate=function(t,e,o,n){var r=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,e,o,n,Nt,r?Et:Ft,r?Dt:Ot)},t.prototype.timeConditionEvaluate=function(t,e,o,n){return this.dateOrTimeEvaluate(t,e,o,n,jt,Lt,Pt)},t.prototype.dateExConditionEvaluate=function(t,e,o,n){var r=this.A4(t,e,o);return!O(r)&&this.dateExConditionCheckCondition(r,n)},t.prototype.getExConditionDateScope=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j=p,P=p,L=new Date,G=new Date(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds());switch(t){case yt.last7Days:Mt(G,kt(G)-6),j=It(G),P=Rt(L);break;case yt.yesterday:Mt(G,kt(G)-1),j=It(G),P=Rt(G);break;case yt.today:j=It(L),P=Rt(L);break;case yt.tomorrow:Mt(G,kt(G)+1),j=It(G),P=Rt(G);break;case yt.lastWeek:Mt(e=L,kt(L)-L.getDay()-7),(o=G).setDate(kt(G)-G.getDay()-1),j=It(e),P=Rt(o);break;case yt.thisWeek:Mt(n=L,kt(L)-L.getDay()),Mt(r=G,kt(G)-G.getDay()+6),j=It(n),P=Rt(r);break;case yt.nextWeek:Mt(i=L,kt(L)-L.getDay()+7),Mt(a=G,kt(G)-G.getDay()+13),j=It(i),P=Rt(a);break;case yt.lastMonth:Mt(s=L,1),s.setMonth(L.getMonth()-1),Mt(l=G,0),j=It(s),P=Rt(l);break;case yt.thisMonth:Mt(u=L,1),Mt(c=G,1),c.setMonth(G.getMonth()+1),Mt(c,0),j=It(u),P=Rt(c);break;case yt.nextMonth:Mt(f=L,1),f.setMonth(L.getMonth()+1),Mt(h=G,1),h.setMonth(G.getMonth()+2),Mt(h,0),j=It(f),P=Rt(h);break;case yt.nextQuarter:m=(g=(d=L).getMonth())%3,d.setDate(1),d.setMonth(g-m+3),void 0,(y=G).setDate(1),y.setMonth(g-m+3+2),C=2===y.getMonth()||11===y.getMonth()?31:30,y.setDate(C),j=It(d),P=Rt(y);break;case yt.thisQuarter:w=(b=(v=L).getMonth())%3,v.setDate(1),v.setMonth(b-w),void 0,(T=G).setDate(1),T.setMonth(b-w+2),S=2===T.getMonth()||11===T.getMonth()?31:30,T.setDate(S),j=It(v),P=Rt(T);break;case yt.lastQuarter:I=(A=(x=L).getMonth())%3,x.setDate(1),x.setMonth(A-I-3),void 0,(R=G).setDate(1),R.setMonth(A-I-3+2),M=2===R.getMonth()||11===R.getMonth()?31:30,R.setDate(M),j=It(x),P=Rt(R);break;case yt.nextYear:(k=L).setDate(1),k.setFullYear(k.getFullYear()+1),k.setMonth(0),(N=G).setFullYear(N.getFullYear()+1),N.setMonth(11),N.setDate(31),j=It(k),P=Rt(N);break;case yt.thisYear:(O=L).setDate(1),O.setMonth(0),(D=G).setMonth(11),D.setDate(31),j=It(O),P=Rt(D);break;case yt.lastYear:(F=L).setFullYear(F.getFullYear()-1),F.setDate(1),F.setMonth(0),(E=G).setFullYear(E.getFullYear()-1),E.setMonth(11),E.setDate(31),j=It(F),P=Rt(E)}return{from:j,to:P}},t.prototype.dateExConditionCheckCondition=function(t,o){var n,r,i,a,s,l,u,c,f,h,d;if(r=o,(n=this).ignoreBlank()&&(O(r)||""===r))return!0;try{r=T.Wh(r)}catch(t){return!1}if((a=n.expectTypeId())===mt.dateOccurring){if(l=(s=this.getExConditionDateScope(t)).from,u=s.to,!O(l)&&!O(u))return c=e.$V(xt.dateCondition,gt.afterEqualsTo,l,p),f=e.$V(xt.dateCondition,gt.beforeEqualsTo,u,p),e.$V(xt.relationCondition,ct.and,p,p,p,p,p,c,f).evaluate(p,0,0,r)}else if(i=n.A4(p,0,0),!O(i)){if(a===mt.yearOccurring)return i===r.getFullYear();if(a===mt.quarterOccurring)return function(t,e){switch(t){case Ct.quarter1:return e.getMonth()>=0&&e.getMonth()<=2;case Ct.quarter2:return e.getMonth()>=3&&e.getMonth()<=5;case Ct.quarter3:return e.getMonth()>=6&&e.getMonth()<=8;case Ct.quarter4:return e.getMonth()>=9&&e.getMonth()<=11;default:return!1}}(i,r);if(a===mt.monthOccurring)return i===r.getMonth();if(a===mt.weekOccurring)return i===r.getDay();if(a===mt.dayOccurring)return i===kt(r);if(a===mt.yearTodate)return h=new Date,d=new Date,h.setMonth(0,1),h.setHours(0,0,0,0),d.setHours(23,59,59,59),h<=r&&r<=d}return!1},t.prototype.textLengthConditionEvaluate=function(t,e,o,n){var r,i;return!(!O(n)&&""!==n||!this.ignoreBlank())||(r=O(n)?0:(""+n).length,"number"==typeof(i=this.A4(t,e,o))&&le(this.RV(),r,i))},t.prototype.top10ConditionEvaluate=function(t,e,o,n){var r,i,a,s=this;if(O(n)||""===n)return s.ignoreBlank();if(r=s.A4(t,e,o),!O(r)&&(i=void 0,s.k$a?(O(s.mxb)&&(s.mxb=s.getTopValues(t,r,s.ranges())),i=s.mxb):i=s.getTopValues(t,r,s.ranges()),i)){a=0;try{a=s.Pa(n)}catch(t){return!1}if(W.Bb(i,a))return!0}return!1},t.prototype.A4=function(t,e,o){var n=this.getExpected(t,e,o);return n=parseInt(n,10),isNaN(n)||!isFinite(n)?p:n},t.prototype.adjustRange=function(t,e){return H(t.row,t.col,Math.min(ae(t),e.getRowCount()),Math.min(se(t),e.getColumnCount()))},t.prototype.getTopValues=function(t,e,o){var n,r,i,a,s,l,u,c,f,h=0===this.type()?1:-1,p=[];if(!o)return p;for(n=this.UV(t,o),r=X(n),u=0;u<r;u++)for(i=this.adjustRange(n[u],t),c=0;c<ae(i);c++)for(a=c+i.row,f=0;f<se(i);f++)s=f+i.col,l=this.Pa(t.getValue(a,s)),O(l)||p.push(l);return p.sort((function(t,e){return(e-t)*h})),X(p)>e&&(p=p.slice(0,e)),p},t.prototype.Pa=function(t){return("number"==typeof t||F(t,Date))&&G?x(t):p},t.prototype.uniqueConditionEvaluate=function(t,e,o,n){var r,i,a,s,l=this,u=n;return O(u)||""===u?l.ignoreBlank():(G&&S(u)&&!tt(u)&&(u=x(u)),r=this.getExpected(t,e,o),i={},T.Uh(r,i),!O(a=i.value)&&(s=l.duplicatedArrayCached||l.getDuplicated(t,l.ranges()),!O(s)&&W.Bb(s,u)?!0===a:!0!==a))},t.prototype.getDuplicated=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p=[],d={},g=this.UV(t,e);if(g)for(o=X(g),n=0;n<o;n++)for(r=g[n],i=ae(r=this.adjustRange(r,t)),a=se(r),s=0;s<i;s++)for(l=s+r.row,u=0;u<a;u++)c=u+r.col,f=t.getValue(l,c,3),!O(f)&&G&&S(f)&&!tt(f)&&(f=x(f)),(h=d[f])?1===h&&p.push(f):d[f]=1;return p},t.prototype.VV=function(t,e){var o,n=t.length;for(o=0;o<n;o++)if(t[o].key===e)return!0;return!1},t.prototype.averageConditionEvaluate=function(t,e,o,n){var r,i,a,s,l,u,c,f;if(!G)return!1;if((r=this).ignoreBlank()&&(O(n)||""===n))return!0;if(r.WV(),r.k$a?(O(r.mxb)&&(r.mxb=r.getExpected(t,e,o)),i=r.mxb):i=r.getExpected(t,e,o),s=A(i,a={})?a.value:NaN,l=p,u=r.TV?r.XV(t,r.TV,e,o):p,O(u)||(l=A(u,a={})?a.value:NaN),S(n)&&(c=x(n),!isNaN(s)))switch(f=isNaN(l),r.type()){case vt.above:return c>s;case vt.below:return c<s;case vt.equalOrAbove:return c>=s;case vt.equalOrBelow:return c<=s;case vt.above1StdDev:return!f&&c>s+l;case vt.below1StdDev:return!f&&c<s-l;case vt.above2StdDev:return!f&&c>s+2*l;case vt.below2StdDev:return!f&&c<s-2*l;case vt.above3StdDev:return!f&&c>s+3*l;case vt.below3StdDev:return!f&&c<s-3*l;default:return!1}return!1},t.prototype.WV=function(){var t=this;t.ranges()&&(t.Lf=t.YV("AVERAGE",t.ranges()),t.type()>=4&&t.type()<=9&&(t.TV=t.YV("STDEV",t.ranges())))},t.prototype.YV=function(t,e){var o,n,r,a;if(!G)return p;if(o=Z.findGlobalFunction(t)){for(n=[],r=X(e),a=0;a<r;a++)n[a]=ot(e[a]);return i.Jh(o,n)}return p},t.prototype.averageConditionGetExpected=function(t,e,o){var n=t.Cf();return n?n.Hg(t.yj(),this.expression(d,t),s.pf(e,o),!1):p},t.prototype.nxb=function(){var t=this.conType();t!==xt.averageCondition&&t!==xt.top10Condition||(this.k$a=!0)},t.prototype.oxb=function(){this.k$a=!1,this.mxb=d},t.prototype.XV=function(t,e,o,n){var r=t.Cf();return r?r.Hg(t.yj(),e,s.pf(o,n),!1):p},t.prototype.ZV=function(t,e){var o,n;for(n=0;n<X(e);n++)o=e[n],F(o,Array)&&X(o)>0?X(e)>1?t.push(o[0]):t.push.apply(t,o):t.push(o)},t.prototype.getValidList=function(t,e,o){var n,r,i=[],a=this.getValidListImp(t,e,o);for(n=0,r=X(a);n<r;n++)i.push(a[n].value);return i},t.prototype.CIc=function(){return this.Yw&&this.Yw.length>0},t.prototype.getValidListImp=function(t,e,o){var n,r,i,a,s,l,u=this,c=[];if(u.Yw&&u.Yw.length>0)n=u.getExpected(t,e,o),F(n,Array)?u.ZV(c,n):c.push(n);else if(u.expected()&&u.expected().length>0&&(r=u.expected().replace(/\\,/g,String.fromCharCode(206)).split(",")))for(i=0;i<X(r);i++)a=r[i],O(a)||(s=RegExp(String.fromCharCode(206),"g"),""!==(l=f.trim(a).replace(s,","))&&c.push({text:l,value:l}));return c},t.prototype.areaConditionEvaluate=function(t,e,o,n){var r,i,a,s,l;function u(t,e,o){return F(t,Date)&&F(e,Date)?t.valueOf()===e.valueOf():o||"string"!=typeof t||"string"!=typeof e?t===e:t.toLowerCase()===e.toLowerCase()}if(r=this,O(n)||""===n)return!0===r.ignoreBlank();for(i=r.getValidList(t,e,o),a=0;a<X(i);a++){if(s=i[a],O(s)&&O(n))return!0;if(r.Yw){if(u(s,n,!1))return!0}else if(l=t.getActualStyle(e,o,3,!0),u(E.ul(l,s,!0),n,!0))return!0}return!1},t.prototype.areaConditionGetExpected=function(t,e,o){var n,r,i,a,l,u,c,f,h,p,g,m,y,v=this,b=[];if(v.Yw){if(n=void 0,r=void 0,i=void 0,a=void 0,l=void 0,u=void 0,!(c=t.Cf()))return b;if(f=c.Hg(t.yj(),v.expression(d,t),s.pf(e,o),!0),T.Fh(f))for(n=f.getRowCount(0),r=f.getColumnCount(0),h=f.getRow(0),p=f.getColumn(0),(g=f.xf&&f.xf.kj)&&(m=g.getRowCount(),y=g.getColumnCount(),n=n>m?C(m-h,0):n,r=r>y?C(y-p,0):r),i=0;i<n;i++)for(b[i]=[],a=0;a<r;a++)l=f.getValue(0,i,a),u=g?g.getText(h+i,p+a):l,b[i][a]={value:l,text:u};else if(T.Ca(f))for(n=f.getRowCount(),r=f.getColumnCount(),i=0;i<n;i++)for(b[i]=[],a=0;a<r;a++)l=f.getValue(i,a),b[i][a]={value:l,text:l}}else b.push({value:v.expected(),text:v.expected()});return b},t.prototype.stateConditionEvaluate=function(t,e,o,n){var r=this.expected();return!(O(n)||O(r)||isNaN(n)||isNaN(n))&&(n&r)>0},t.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.RV(1),t.item1(p),t.item2(p),t.value1=p,t.value2=p,t.expected(p),t.RV(0),t.integerValue(!1),t.operator=0,t.text="",t.RV(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.Lf=p,t.type(0),this.expectTypeId(0),t.ranges(p),t.isPercent(!1),t.regex(p),t.conType()){case xt.relationCondition:t.ignoreBlank(!1),t.RV(1);break;case xt.numberCondition:t.RV(0),t.integerValue(!1);break;case xt.textCondition:t.RV(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case xt.colorCondition:t.RV(0);break;case xt.formulaCondition:t.customValueType(0),t.TV=p;break;case xt.dateCondition:case xt.timeCondition:t.RV(0);break;case xt.dateExCondition:t.expectTypeId(0);break;case xt.textLengthCondition:t.RV(0);break;case xt.top10Condition:case xt.averageCondition:t.type(0);break;case xt.cellValueCondition:t.operator=6;case xt.areaCondition:}},t.prototype.evaluate=function(t,e,o,n){var r=this.conType();return!O(r)&&this[xt[r]+"Evaluate"](t,e,o,n)},t.prototype.getExpectedNormal=function(t,e,o,n,r,i){var a,l=this,u=l.Yw,c=l.expected();return u?(a=t.Cf())?a.Hg(t.yj(),l.expression(d,t),s.pf(e,o),!1,i):c:c},t.prototype.getExpected=function(t,e,o){var n=this;switch(n.conType()){case 2:case 5:case 6:case 7:case 9:case 11:case 13:return n.getExpectedNormal(t,e,o,e-n.offsetRow,o-n.offsetCol,!1);case 8:return n.getExpectedNormal(t,e,o,e,o);case 0:case 3:default:return p;case 1:return n.numberConditionGetExpected(t,e,o);case 4:return n.formulaConditionGetExpected(t,e,o);case 10:return n.averageConditionGetExpected(t,e,o);case 12:return n.areaConditionGetExpected(t,e,o)}},t.prototype.UV=function(t,e){var o,n,r,i=[];for(o=0,n=X(e);o<n;o++)r=t.Tq(e[o]),i.push(r);return i},t.prototype.getExpressions=function(){var t=[],e=this;return 0===e.conType()?(e.item1()&&e.item1().getExpressions&&(t=e.item1().getExpressions()),e.item2()&&e.item2().getExpressions&&(t=t.concat(e.item2().getExpressions())),t):(e.Lf||e.initExpression(),e.Lf?[e.Lf]:[])},t.prototype.setExpressions=function(t,e){var o,n=this;return e&&e.push({type:"condition",condition:this,expressions:n.getExpressions()}),0===n.conType()?(n.item1()&&n.item1().setExpressions&&(o=n.item1().getExpressions().length,n.item1().setExpressions(t.slice(0,o))),void(n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(t.slice(o)))):void n.expression(t[0])},t.prototype.toJSON=function(t){return rt.call(this,t,Gt)},t.prototype.fromJSON=function(t,e,o){var n;t&&(it.call(n=this,e,Gt,t,o),e&&e.Wu&&e.Wu.useR1C1&&e instanceof l.Worksheet&&(n.context(e),P(n)),n.j_a(!0),n.initExpression(),n.k_a())},t.fromSource=function(t){return e.$V(12,p,t,p)},t.fromFormula=function(t){return e.$V(12,p,"",t)},t.fromDay=function(t){var o=e.$V(6,p,t);return o.expectTypeId(5),o},t.fromMonth=function(t){var o=e.$V(6,p,t);return o.expectTypeId(3),o},t.fromQuarter=function(t){var o=e.$V(6,p,t);return o.expectTypeId(2),o},t.fromWeek=function(t){var o=e.$V(6,p,t);return o.expectTypeId(4),o},t.fromYear=function(t){var o=e.$V(6,p,t);return o.expectTypeId(1),o},t}(),e.Condition=Bt,Bt.prototype.conType=nt("conType",p),Bt.prototype.ranges=nt("ranges",p,(function(t){var e=this.item1(),o=this.item2();e&&e.ranges&&e.ranges(t),o&&o.ranges&&o.ranges(t)})),Bt.prototype.ignoreBlank=nt("ignoreBlank",!1),Bt.prototype.preciseCompareDate=nt("preciseCompareDate",!1),Bt.prototype.compareType=nt("compareType",d),Bt.prototype.RV=Bt.prototype.compareType,Bt.prototype.expected=nt("expected",d),Bt.prototype.item1=nt("item1",p),Bt.prototype.item2=nt("item2",p),Bt.prototype.treatNullValueAsZero=nt("treatNullValueAsZero",!1),Bt.prototype.integerValue=nt("integerValue",!1),Bt.prototype.forceValue2Text=nt("forceValue2Text",!1),Bt.prototype.useWildCards=nt("useWildCards",!0),Bt.prototype.regex=nt("regex",p),Bt.prototype.ignoreCase=nt("ignoreCase",!1),Bt.prototype.customValueType=nt("customValueType",d),Bt.prototype.expectTypeId=nt("expectTypeId",0),Bt.prototype.type=nt("type",p),Bt.prototype.isPercent=nt("isPercent",!1),_t=function(){function t(t,e,o){var n=this;n.xyb=!0,n.ruleType(t),n.style(e),n.ranges(o)}return t.prototype.stopIfTrue=function(t){},t.prototype.evaluate=function(t,o,n,r){var i,a,s,l,u=this;return u.contains(o,n)?(u.initCondition(),i={baseRow:0,baseCol:0},u.getBaseCoordinate(i),u.condition().adjustOffset(o-i.baseRow,n-i.baseCol),a=p,s=T.vf,(l=u.condition().evaluate(t,o,n,r))&&!s(l)&&(a=u.getExpected()||e.Cxb),u.condition().adjustOffset(0,0),a):p},t.prototype.contains=function(t,e){var o,n,r=this.ranges();if(r)for(o=X(r),void 0,n=0;n<o;n++)if(r[n].contains(t,e))return!0;return!1},t.prototype.createCondition=function(){return this.xyb=!1,null},t.prototype.initCondition=function(t){var e=this.condition();e||((e=this.createCondition())&&(e.ranges(this.ranges()),this.condition(e)),t&&this.context(t),this.context()&&e&&e.context(this.context()))},t.prototype.yyb=function(){var t,e=this;e.xyb&&((t=e.condition())||(e.initCondition(),t=e.condition()),t&&!t.Lf&&t.initExpression())},t.prototype.context=function(t){return 1===arguments.length&&(this.xc=t,this.condition()&&this.condition().context(t)),this.xc},t.prototype.getExpected=function(){return this.style()},t.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.stopIfTrue(!1),t.priority(1)},t.prototype.intersects=function(t,e,o,n){var r,i,a=this.ranges();if(a)for(r=X(a),void 0,i=0;i<r;i++)if(a[i].intersect(t,e,o,n))return!0;return!1},t.prototype.isScaleRule=function(){return!1},t.prototype.isStateRule=function(){return!1},t.prototype.getBaseCoordinate=function(t){var e,o,n,r,i;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,(e=this).ranges()&&X(e.ranges())>0)for(o=0;o<X(e.ranges());o++)r=-1===(r=(n=e.ranges()[o]).row)?0:r,i=-1===(i=n.col)?0:i,t.baseRow=y(r,t.baseRow),t.baseCol=y(i,t.baseCol);else t.baseRow=0,t.baseCol=0},t.prototype.XXc=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=!1;if(this.yyb(),n=this.ranges())for(r=X(n),i=0;i<r;i++)s=(a=n[i]).row,l=ae(a),u=a.col,c=se(a),f=s===t.row&&l===t.rowCount&&t.col<=u&&c<=t.colCount,h=s===e.row&&l===e.rowCount&&e.col<=u&&c<=e.colCount,(f||h)&&(n[i]=H(s,u,l+o,c),p=!0);return p},t.prototype._V=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A=o?e:0,I=o?0:e;if(this.yyb(),i=this.ranges()){for(a=[],s=X(i),l=0;l<s;l++)if(u=i[l],c=o?u.row:u.col,f=o?ae(u):se(u),-1!==c){if(n&&n.length>0){for(h=!1,p=0,d=n.length;p<d;p++)if((g=n[p])&&(m=!o&&g.col===t&&g.col===u.col&&g.colCount-e===u.colCount,y=!o&&g.col===t&&g.row===u.row&&g.rowCount===u.rowCount&&u.col>=g.col&&u.col+u.colCount<=g.col+g.colCount,C=o&&g.row===t&&g.row===u.row&&g.rowCount-e===u.rowCount,m||y||C)){i[l]=H(u.row,u.col,ae(u)+A,se(u)+I),h=!0;break}if(h)break}if(v=u,b=r&&n&&n[0]){if((w=o?ce(u,b.col,b.col+b.colCount-1):fe(u,b.row,b.row+b.rowCount-1))[0]&&a.push(w[0]),w[2]&&a.push(w[2]),!w[1])continue;v=w[1]}c>=t?i[l]=H(v.row+A,v.col+I,ae(v),se(v)):t<=c+f&&(i[l]=H(v.row,v.col,ae(v)+A,se(v)+I))}for(T=0,S=a;T<S.length;T++)x=S[T],i.push(x)}},t.prototype.rI=function(t,e,o,n){this._V(t,e,!0,o,n)},t.prototype.tI=function(t,e,o,n){this._V(t,e,!1,o,n)},t.prototype.aW=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x=o?t:0,A=o?0:t,I=o?e:0,R=o?0:e;if(this.yyb(),i=this.ranges()){for(a=[],s=[],l=X(i),u=0;u<l;u++)if(c=i[u],f=o?c.row:c.col,h=o?ae(c):se(c),-1!==f){if(p=c,d=r&&n&&n[0]){if((g=o?ce(c,d.col,d.col+d.colCount-1):fe(c,d.row,d.row+d.rowCount-1))[0]&&a.push(g[0]),g[2]&&a.push(g[2]),!g[1])continue;p=g[1]}f>t?f+h<=t+e?s.push(p):i[u]=H(p.row-I,p.col-R,ae(p),se(p)):t<f+h&&(m=H(p.row,p.col,ae(p)-y(p.row+ae(p)-x,I),se(p)-y(p.col+se(p)-A,R)),0===se(m)||0===ae(m)?s.push(p):i[u]=m)}for(C=0,v=a;C<v.length;C++)b=v[C],i.push(b);for(w=X(s),T=0;T<w;T++)S=s[T],q(i,S)}},t.prototype.GR=function(t,e,o,n){this.aW(t,e,!0,o,n)},t.prototype.HR=function(t,e,o,n){this.aW(t,e,!1,o,n)},t.prototype.toJSON=function(t){return rt.call(this,t)},t.prototype.fromJSON=function(t,e,o){t&&(it.call(this,e,p,t,o),this.initCondition(e))},t.prototype.S$a=function(){var t=this.condition();t&&P(t)},t.prototype.iW=function(){var t,e,o=this.cW,n=this.ranges();if(!o)return this.cW=ge(n),!1;if(X(o)!==(t=X(n)))return!0;for(e=0;e<t;e++)if(!o[e].equals(n[e]))return!0;return!1},t}(),e.ConditionRuleBase=_t,(Vt=_t.prototype).ruleType=nt("ruleType",p),Vt.ranges=nt("ranges",p,(function(t){var e,o=this.condition();o&&o.ranges()&&((e=o.xc)&&e.ITa.YUa(),o.ranges(t))})),Vt.condition=nt("condition",p),Vt.style=nt("style",p),Vt.priority=nt("priority",1),Vt.stopIfTrue=nt("stopIfTrue",!1),Ht=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],zt=function(t){function o(e,o,n,r,i,a,s,l,u,c){var h=t.call(this,e,n)||this,d=h;return d.ranges(o),d.operator(r),d.value1("string"==typeof i?f.trim(i):i),d.value2("string"==typeof a?f.trim(a):a),d.text(s),d.formula(l),d.type(u),d.rank(c),d.cached=!1,d.cW=p,h}return ie(o,t),o.prototype.value1=function(t,e){var o,n;return 1!==arguments.length?(o=this.condition())&&((n=o.formula(t,e,0))&&n.length>0)?"="+R(f.trim(""+n),"="):this._Qa:void(this._Qa=t)},o.prototype.value2=function(t,e){var o,n;return 1!==arguments.length?(o=this.condition())&&((n=o.formula(t,e,1))&&n.length>0)?"="+R(f.trim(""+n),"="):this.aRa:void(this.aRa=t)},o.prototype.formula=function(t,e){var o=this,n=o.condition();return"string"!=typeof t?n&&n.formula(t,e)||o.Yw:(o.Yw=t,void(n&&n.formula(t)))},o.prototype.cellValueRuleCreateCondition=function(){var t,o,n,r,i,a,s,l,u=this,c=u.value1(),f=u.value2(),h=u.ranges(),g=u.bW(c)?R(c,"="):p,m=u.bW(f)?R(f,"="):p,y=u.operator();return y===ft.between?((t=e.$V(xt.cellValueCondition,3,c,g,d,d,h)).treatNullValueAsZero(!0),(o=e.$V(xt.cellValueCondition,5,f,m,d,d,h)).treatNullValueAsZero(!0),i=e.$V(xt.relationCondition,1,p,p,p,p,h,t,o),(n=e.$V(xt.cellValueCondition,5,c,g,d,d,h)).treatNullValueAsZero(!0),(r=e.$V(xt.cellValueCondition,3,f,m,d,d,h)).treatNullValueAsZero(!0),a=e.$V(xt.relationCondition,1,p,p,p,p,h,n,r),e.$V(xt.relationCondition,0,p,p,p,p,h,i,a)):y===ft.notBetween?((t=e.$V(xt.cellValueCondition,4,c,g,d,d,h)).treatNullValueAsZero(!0),o=e.$V(xt.cellValueCondition,2,f,m,d,d,h),t.treatNullValueAsZero(!0),i=e.$V(xt.relationCondition,0,p,p,p,p,h,t,o),(n=e.$V(xt.cellValueCondition,2,c,g,d,d,h)).treatNullValueAsZero(!0),(r=e.$V(xt.cellValueCondition,4,f,m,d,d,h)).treatNullValueAsZero(!0),a=e.$V(xt.relationCondition,0,p,p,p,p,h,n,r),e.$V(xt.relationCondition,1,p,p,p,p,h,i,a)):(s=y,(l=e.$V(11,s,c,g,d,d,h)).treatNullValueAsZero(!0),l)},o.prototype.bW=function(t){return!O(t)&&"="===t[0]},o.prototype.specificTextRuleCreateCondition=function(){var t,o,n,r,i=this.operator();switch(i){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return o=this.text(),n=p,o&&"="===o[0]&&(n=o),(r=e.$V(2,t,o,n,d,d,this.ranges())).ignoreCase(!0),r.useWildCards(2!==i&&3!==i),r},o.prototype.formulaRuleCreateCondition=function(){var t=this.ranges();return e.$V(4,p,p,this.Yw,4,p,t)},o.prototype.dateOccurringRuleCreateCondition=function(){return e.$V(6,p,this.type(),p,p,d,this.ranges())},o.prototype.top10RuleCreateCondition=function(){return e.$V(8,p,this.rank(),p,p,this.type(),this.ranges())},o.prototype.uniqueRuleCreateCondition=function(){return e.$V(9,p,!1,p,p,p,this.ranges())},o.prototype.duplicateRuleCreateCondition=function(){return e.$V(9,p,!0,p,p,p,this.ranges())},o.prototype.averageRuleCreateCondition=function(){return e.$V(10,p,p,p,p,this.type(),this.ranges())},o.prototype.createCondition=function(){return this[At[this.ruleType()]+"CreateCondition"]()},o.prototype.reset=function(){var t=this;switch(t.ranges(p),t.condition(p),t.style(p),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(p),t.value2(p),t.text(""),t.formula(p),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(p);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},o.prototype.evaluate=function(e,o,n,r){return this.jW(e),t.prototype.evaluate.call(this,e,o,n,r)},o.prototype.jW=function(t){var e,o=this;o.initCondition(),9===(e=o.condition()).conType()&&(o.iW()&&(o.Nm(),o.cW=ge(o.ranges())),!1===o.cached&&(e.duplicatedArrayCached=e.getDuplicated(t,o.ranges()),o.cached=!0))},o.prototype.Nm=function(){this.cached=!1},o.prototype.rI=function(e,o,n,r){t.prototype.rI.call(this,e,o,n,r),this.Nm()},o.prototype.tI=function(e,o,n,r){t.prototype.tI.call(this,e,o,n,r),this.Nm()},o.prototype.GR=function(e,o,n,r){t.prototype.GR.call(this,e,o,n,r),this.Nm()},o.prototype.HR=function(e,o,n,r){t.prototype.HR.call(this,e,o,n,r),this.Nm()},o.prototype.toJSON=function(t){var e,o,n,r,i=this;return O(i.condition())&&this.initCondition(),e=rt.call(i,t,Ht),o=i.value1(),function(t,e){return t===At.cellValueRule&&(e===ft.between||e===ft.notBetween)}(e.ruleType,e.operator)&&(n=i.value2()),r=t&&t.parent&&1===t.parent.options.referenceStyle,O(o)||(i.bW(o)&&r&&(o=he(t,i,o,r)),e.value1=o),O(n)||(i.bW(n)&&r&&(n=he(t,i,n,r)),e.value2=n),i.ruleType()===At.conditionRuleBase&&(e.condition=i.condition().toJSON()),e},o.prototype.fromJSON=function(t,e,o){var n=Ht;O(t.condition)||(n=Ht.concat(["condition"])),it.call(this,e,n,t,o),O(t.value1)||this.value1(t.value1),O(t.value2)||this.value2(t.value2),this.initCondition(e)},o}(_t),e.NormalConditionRule=zt,Ut={operator:nt("operator",p),text:nt("text",p),type:nt("type",p),rank:nt("rank",p),priority:nt("priority",1)},f.extend(zt.prototype,Ut),Wt=function(t,e){this.type=t,this.value=e},e.ScaleValue=Wt,qt=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],Jt=function(t){function o(e,o,n,r,i,a,s,l,u,c,f){var h,d,g,m,y,C,v,b,w,T=t.call(this,e,p,f)||this,S=T;return S.xyb=!1,S.lowestValueCached=p,S.highestValueCached=p,S.zyb={},S.cached=!1,S.cW=p,h=o,d=n,g=r,m=i,y=a,C=s,v=l,b=u,w=c,arguments.length<=1&&(h=1,d=p,g=V(255,248,105,107),m=4,y=50,C=V(255,255,235,132),v=2,b=p,w=V(255,99,190,123)),S.minColor(g),S.minValue(d),S.minType(h),S.midColor(C),S.midValue(y),S.midType(m),S.maxColor(w),S.maxValue(b),S.maxType(v),T}return ie(o,t),o.prototype.stopIfTrue=function(t){return!1},o.prototype.isScaleRule=function(){return!0},o.prototype.createCondition=function(){return p},o.prototype.fW=function(t){var o=e.$V(8,p,p,p,p,1).getTopValues(t,1,this.ranges());return X(o)>0?o[0]:p},o.prototype.gW=function(t){var o=e.$V(8,p,p,p,p,0).getTopValues(t,1,this.ranges());return X(o)>0?o[0]:p},o.prototype.jW=function(t){var e=this;e.iW()&&(e.Nm(),e.cW=ge(e.ranges())),!1===e.cached&&(e.lowestValueCached=e.fW(t),e.highestValueCached=e.gW(t),e.cached=!0)},o.prototype.Nm=function(){this.lowestValueCached=p,this.highestValueCached=p,this.zyb={},this.cached=!1},o.prototype.kW=function(t,e,o,n){var r,i;return n&&(r=t.Cf())?(i=r.parse(t.yj(),n,e,o),r.Hg(t.yj(),i,s.pf(e,o),!1)):p},o.prototype.bW=function(t){return t&&"="===t[0]},o.prototype.lW=function(t){return O(t)||""===t?p:"="===t[0]?t.substr(1):t},o.prototype.mW=function(t,e,o,n){if(this.bW(n))return this.kW(t,e,o,this.lW(""+n));var r={};return A(n,r)?r.value:NaN},o.prototype.dW=function(t){return this.jW(t),this.highestValueCached},o.prototype.eW=function(t){return this.jW(t),this.lowestValueCached},o.prototype.nW=function(t,e,o,n){var r,i,a=this.mW(t,e,o,n);return!isNaN(a)&&0<=a&&a<=100&&(r=this.eW(t),i=this.dW(t),typeof r!==g&&r!==p&&typeof i!==g&&i!==p)?r+(i-r)*a/100:p},o.prototype.oW=function(t,e,o,n){var r,i,a,l,u,c,f,h,d,g,m,y,C=this.zyb;if(void 0!==C[n])return C[n];if(r=this.mW(t,e,o,n),!isNaN(r)&&0<=r&&r<=100){for(i=0,a=this.ranges(),l=X(a),u=0;u<l;u++)c=this.YV("PERCENTILE",[t.Tq(a[u]),r/100]),f=t.Cf(),h=t.yj(),d=f.unparse(h,c,e,o),g=f.parse(h,d,e,o),m=f.Hg(h,g,s.pf(e,o),!1),i+=A(m,y={})?y.value:0;return C[n]=i/l,C[n]}return C[n]=p,C[n]},o.prototype.pW=function(t,e,o,n,r){var i,a,s=this;switch(n){case bt.formula:return s.bW(r)||(r="="+r),s.mW(t,e,o,r);case bt.highestValue:return s.dW(t);case bt.lowestValue:return s.eW(t);case bt.number:return s.mW(t,e,o,r);case bt.percent:return s.nW(t,e,o,r);case bt.percentile:return s.oW(t,e,o,r);case bt.automax:return(i=s.dW(t))<0?0:i;case bt.automin:return(a=s.eW(t))>0?0:a;default:return p}},o.prototype.qW=function(t,e,o){return t===e&&t===o?1:t<=e?0:t>=o?1:(t-e)/(o-e)},o.prototype.rW=function(t,e,o){var n,r,i,a,s,l;return 0<=t&&t<=1?(n=_.ec(e),r=_.ec(o),i=n.a*(1-t)+r.a*t,a=n.r*(1-t)+r.r*t,s=n.g*(1-t)+r.g*t,l=n.b*(1-t)+r.b*t,V(parseFloat(i/255+""),parseInt(a+"",10),parseInt(s+"",10),parseInt(l+"",10))):p},o.prototype.YV=function(t,e){var o,n,r,a;if(!G)return p;if(o=Z.findGlobalFunction(t)){for(n=[],r=X(e),a=0;a<r;a++)n[a]=ot(e[a]);return i.Jh(o,n)}return p},o.prototype.rI=function(e,o,n,r){t.prototype.rI.call(this,e,o,n,r),this.Nm()},o.prototype.tI=function(e,o,n,r){t.prototype.tI.call(this,e,o,n,r),this.Nm()},o.prototype.GR=function(e,o,n,r){t.prototype.GR.call(this,e,o,n,r),this.Nm()},o.prototype.HR=function(e,o,n,r){t.prototype.HR.call(this,e,o,n,r),this.Nm()},o.prototype.scaleEvaluate=function(t,e,o,n){var r,i,a,s,l=this;if(l.jW(t),l.contains(e,o)){if(O(n))return p;try{if(r=x(n),i=l.pW(t,e,o,l.minType(),l.minValue()),a=l.pW(t,e,o,l.midType(),l.midValue()),i>(s=l.pW(t,e,o,l.maxType(),l.maxValue())))return p;if(isNaN(a)){if(!isNaN(i)&&!isNaN(s))return l.qW(r,i,s)}else if(!isNaN(i)&&!isNaN(s))return r<i?0:r>=s?2:i<=r&&r<=a?l.qW(r,i,a):1+l.qW(r,i,s)}catch(t){return p}}return p},o.prototype.twoScaleRuleEvaluate=function(t,e,o,n){var r,i,a,s,l,u;if(!O(n)){if(r={},i=S(n)&&A(n,r)?r.value:NaN,isNaN(i))return p;if(s=(a=this).pW(t,e,o,a.minType(),a.minValue()),l=a.pW(t,e,o,a.maxType(),a.maxValue()),!O(s)&&!O(l))return u=a.qW(i,s,l),a.rW(u,a.minColor(),a.maxColor())}return p},o.prototype.threeScaleRuleEvaluate=function(t,e,o,n){var r,i,a,s,l,u,c=this;if(c.lh=t,!O(n)){if(r={},i=S(n)&&A(n,r)?r.value:NaN,isNaN(i))return p;if(a=c.pW(t,e,o,c.minType(),c.minValue()),s=c.pW(t,e,o,c.midType(),c.midValue()),l=c.pW(t,e,o,c.maxType(),c.maxValue()),!O(a)&&!O(l)&&!O(s))return u=void 0,a>l?p:i<=a||a===l?i>=l?c.maxColor():c.minColor():i>=l?c.maxColor():i<=s?(u=c.qW(i,a,s),c.rW(u,c.minColor(),c.midColor())):(u=c.qW(i,s,l),c.rW(u,c.midColor(),c.maxColor()))}return p},o.prototype.evaluate=function(t,e,o,n){return this[At[this.ruleType()]+"Evaluate"](t,e,o,n)},o.prototype.ad=function(){var t=this;t.minValue(p),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(p),t.maxType(2),10===t.ruleType()&&(t.minColor(V(0,255,255,255)),t.maxColor(V(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(V(255,248,105,107)),t.midColor(V(255,255,235,132)),t.maxColor(V(255,99,190,123)))},o.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.ad(),t.lh=p,t.stopIfTrue(!1),t.priority(1)},o.prototype.toJSON=function(t){return rt.call(this,t,qt)},o.prototype.fromJSON=function(t,e,o){it.call(this,e,qt,t,o),this.initCondition(e)},o}(_t),e.ScaleRule=Jt,Xt={minValue:nt("minValue",p),minType:nt("minType",5),minColor:nt("minColor",p),midValue:nt("midValue",50,p,(function(t){var e=this;if(e.lh){if(2===e.midType())return e.dW(e.lh);if(1===e.midType())return e.eW(e.lh)}return t})),midType:nt("midType",p),midColor:nt("midColor",p),maxType:nt("maxType",7),maxValue:nt("maxValue",p),maxColor:nt("maxColor",p)},f.extend(Jt.prototype,Xt),Zt=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],Yt=function(t){function e(e,o,n,r,i,a){var s=this,l=e,u=o,c=n,f=r,h=i;return 0===arguments.length&&(l=5,u=p,c=7,f=p,h=V(255,99,142,198)),(s=t.call(this,12,l,u,p,p,p,p,c,f,p,a)||this).xyb=!1,s.ad(h),s}return ie(e,t),e.prototype.ad=function(t){var e=this;e.gradient(!0),e.color(t),e.showBorder(!1),e.borderColor("black"),e.dataBarDirection(0),e.negativeFillColor("red"),e.useNegativeFillColor(!0),e.negativeBorderColor("black"),e.useNegativeBorderColor(!1),e.axisPosition(0),e.axisColor("black"),e.showBarOnly(!1)},e.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.ad(V(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(p),t.minType(5),t.midValue(p),t.midType(p),t.maxValue(p),t.maxType(7),t.minColor(p),t.midColor(p),t.maxColor(p)},e.prototype.qXc=function(t,e,o,n){var r,i,a,s,l=this,u=n?l.maxType():l.minType(),c=n?l.maxValue():l.minValue();if(6!==u&&4!==u)return l.pW(t,e,o,u,c);for(i=0;i<X(l.ranges());i++)if(l.ranges()[i].intersect(e,-1,1,-1)&&(r=l.ranges()[i]))return a=-1===(a=r.row)?0:a,s=-1===(s=r.col)?0:s,l.pW(t,a,s,u,c)},e.prototype.tW=function(t,e,o){return t>=o&&t>e?[1,0]:t<=e&&t<o?[0,0]:o===e?[.5,0]:[(t-e)/(o-e),0]},e.prototype.uW=function(t,e,o){var n,r,i=.5,a=v(o-e);return o>0&&e>=0?o===e||t>=o?[.5,i]:t<=e?[e/o*.5,i]:[.5*v(t/o),i]:o>0&&e<0?(n=o>v(e)?.5:o/a,r=o>v(e)?e/a:-.5,t>0?t>=o?[n,i]:[t/o*n,i]:t<0?t<=e?[r,i]:[t/e*r,i]:[0,i]):o<=0&&e<0?o===e?[-.5,i]:t>=o?[-o/e*.5,i]:t<=e?[-.5,i]:[-t/e*.5,i]:0===o&&0===e?[0,i]:[-1,i=-1]},e.prototype.vW=function(t,e,o){var n,r,i,a=-1,s=v(e),l=v(o),u=v(o-e),c=e<0?-1:1;return o>0&&e>=0||o<=0&&e<0?(n=C(s,l),r=y(s,l),a=e<0?1:0,(i=v(t))<=r&&i<n?[0,a]:i>=n&&i>r?[c,a]:r===n?[.5*c,a]:[c*(v(t)-r)/u,a]):o>0&&e<0?(a=v(e)/u,0===t?[0,a]:t>=o?[1-a,a]:[C(t,e)/u,a]):0===o&&0===e?(a=.5,0===t?[0,a]:[.5*c,a]):[-1,a]},e.prototype.wW=function(t,e,o){var n=this;return 0===n.axisPosition()?n.vW(t,e,o):1===n.axisPosition()?n.uW(t,e,o):n.tW(t,e,o)},e.prototype.evaluate=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,d,g,m;if(!O(n)){if(r={},i=S(n,!0)&&A(n,r)?r.value:NaN,isNaN(i))return p;if(s=(a=this).qXc(t,e,o,!1),l=a.qXc(t,e,o,!0),F(s,Date)&&(s=U.Ra(s)),F(l,Date)&&(l=U.Ra(l)),!O(s)&&!O(l))return s>l&&(u=l,l=s,s=u),c=void 0,!(f=a.wW(i,s,l))||X(f)<2?p:(h=f[0],c=f[1],d=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),g=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),m=a.axisColor(),d=K.Om(t,d),g=K.Om(t,g),m=K.Om(t,m),{fillColor:d,borderColor:g,showBorder:a.showBorder(),axisColor:m,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:h,showBarOnly:a.showBarOnly()})}return p},e.prototype.toJSON=function(t){return rt.call(this,t,Zt)},e.prototype.fromJSON=function(t,e,o){it.call(this,e,Zt,t,o),this.initCondition(e)},e.paintDataBar=function(t,e,o,n,i,a){var s,l,u,c,f,h,p,d,g,m,y,C,w,T=new r.Rect(o+2,n+2,i-4,a-4),S=T.x,x=T.y,A=b(v(T.width*e.scale)),I=T.height;if(0===e.axisLocation)e.scale<=0&&(A=0);else if(1===e.axisLocation)e.scale<0?S=S+T.width-A:A=0;else{for(s=b(T.width*e.axisLocation+S)+.5,l=T.y,1,u=a-2,t.lineWidth=1,t.strokeStyle=e.axisColor,t.beginPath(),c=0;c<=u;c+=2)1===e.direction?(t.moveTo(2*o+i-s,l+c),t.lineTo(2*o+i-s,l+c+1)):(t.moveTo(s,l+c),t.lineTo(s,l+c+1));t.stroke(),e.scale>0?S=s+1:e.scale<0?S=s-A:A=0}e.showBorder&&(S=b(S)+.5,A-=1,x+=.5,I-=1),f=S,h=S+A,1===e.direction&&(f=2*o+i-S-A,h=2*o+i-S),A>=0&&I>=0&&(p=e.fillColor,e.isGradient&&(d=.9,p=t.createLinearGradient(f,x,h,x),g=_.ec(e.fillColor),m=V(g.a,b(229.5+g.r*(1-d)),b(229.5+g.g*(1-d)),b(229.5+g.b*(1-d))),y=e.scale<0?1-d:d,C=e.fillColor,w=e.scale<0?1:0,1===e.direction?(p.addColorStop(y,C),p.addColorStop(w,m)):(p.addColorStop(y,m),p.addColorStop(w,C))),t.fillStyle=p,t.fillRect(f,x,A,I),e.showBorder&&A>0&&I>0&&(t.strokeStyle=e.borderColor,t.strokeRect(f,x,A,I)))},e}(Jt),e.DataBarRule=Yt,Kt={gradient:nt("gradient",!0),color:nt("color",p),showBorder:nt("showBorder",!1),borderColor:nt("borderColor","black"),dataBarDirection:nt("dataBarDirection",0),negativeFillColor:nt("negativeFillColor","red"),useNegativeFillColor:nt("useNegativeFillColor",!0),negativeBorderColor:nt("negativeBorderColor","black"),useNegativeBorderColor:nt("useNegativeBorderColor",!1),axisPosition:nt("axisPosition",0),axisColor:nt("axisColor","black"),showBarOnly:nt("showBarOnly",!1)},f.extend(Yt.prototype,Kt),Qt=function(t,e,o){this.isGreaterThanOrEqualTo=t,this.iconValueType=e,this.iconValue=o},e.IconCriterion=Qt,$t=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],te=function(t){function e(e,o){var n=this,r=e;return 0===arguments.length&&(r=0),(n=t.call(this,13,p,p,p)||this).xyb=!1,n.ranges(o),n.ad(r),n}return ie(e,t),e.prototype.xW=function(t){var e=this;e.iconSetType(t,!1),e.iconSetType()>=wt.threeArrowsColored&&e.iconSetType()<=wt.threeSymbolsUncircled?(e.NV=[],e.NV[0]=new Qt(!0,Tt.percent,33),e.NV[1]=new Qt(!0,Tt.percent,67),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2}):e.iconSetType()>=wt.fourArrowsColored&&e.iconSetType()<=wt.fourTrafficLights?(e.NV=[],e.NV[0]=new Qt(!0,Tt.percent,25),e.NV[1]=new Qt(!0,Tt.percent,50),e.NV[2]=new Qt(!0,Tt.percent,75),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2},e.CZa[3]={iconSetType:t,iconIndex:3}):e.iconSetType()>=wt.fiveArrowsColored&&e.iconSetType()<=wt.fiveBoxes?(e.NV=[],e.NV[0]=new Qt(!0,Tt.percent,20),e.NV[1]=new Qt(!0,Tt.percent,40),e.NV[2]=new Qt(!0,Tt.percent,60),e.NV[3]=new Qt(!0,Tt.percent,80),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2},e.CZa[3]={iconSetType:t,iconIndex:3},e.CZa[4]={iconSetType:t,iconIndex:4}):e.iconSetType()>wt.fiveBoxes&&(e.NV=[],e.CZa=[])},e.prototype.ad=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(t)},e.prototype.yW=function(t){var e=X(this.NV)+1;return this.reverseIconOrder()&&e>2?e-1-t:t},e.prototype.pW=function(t,e,o,n){var r=this,i=r.NV[n];if(i)switch(i.iconValueType){case Tt.formula:case Tt.number:return r.mW(t,e,o,i.iconValue);case Tt.percent:return r.nW(t,e,o,i.iconValue);case Tt.percentile:return r.oW(t,e,o,i.iconValue);default:return p}},e.prototype.evaluate=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,d,g,m,y=this,C=n;if(O(C))return p;if(r={},i=S(n,!0)&&"boolean"!=typeof C&&A(n,r)?r.value:NaN,isNaN(i))return p;if(a=0,s=y.iconSetType(),l=y.NV,s>=wt.fiveArrowsColored?a=5:s>=wt.fourArrowsColored?a=4:s>=wt.threeArrowsColored&&(a=3),!l)return 0;for(c=0,f=a-1;f>0;f--)if(f<X(l)+1&&(u=l[f-1],!O(u&&u.iconValue)&&(h=y.pW(t,e,o,f-1),!O(h)&&(d=u.isGreaterThanOrEqualTo?i>=h:i>h,i<Number.MAX_VALUE&&d)))){c=f;break}return g=y.yW(c),(m=y.CZa)?{iconSetType:m[g]?m[g].iconSetType:wt.noIcons,iconIndex:m[g]?m[g].iconIndex:0,showIconOnly:y.showIconOnly()}:{iconSetType:wt.noIcons,iconIndex:0,showIconOnly:y.showIconOnly()}},e.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,p),t.NV=p,t.stopIfTrue(!1),t.priority(1),t.minColor(p),t.minValue(p),t.minType(5),t.midColor(p),t.midValue(p),t.midType(p),t.maxColor(p),t.maxValue(p),t.maxType(7),t.CZa=p},e.prototype.icons=function(t){return 1===arguments.length&&(this.CZa=t),this.CZa},e.prototype.iconCriteria=function(){return this.NV},e.prototype.toJSON=function(t){return rt.call(this,t,$t)},e.prototype.fromJSON=function(t,e,o){it.call(this,e,$t,t,o),this.initCondition(e)},e.getIcon=function(t,e){return p},e.Pdc=function(t,e,o,n,r,i,a){if(a.ko(e)){var s=a.lo(e);t.drawImage(s,o,n,r,i)}else a.fo(e)},e.paintIconSet=function(t,o,n,r,i,a,s,u,c,h){var p,d,g=l.To.No(s.font,1).fontSize,m=n+2;if(o.showIconOnly&&(1===s.hAlign?m=n+i/2-g/2:2===s.hAlign&&(m=n+i-2-g-2)),p=1===s.vAlign?r+a/2-g/2:2===s.vAlign?r+a-2-u/2-g/2:r+2+u/2-g/2,o.iconSetType!==wt.noIcons)if((d=e.getIcon(o.iconSetType,o.iconIndex))&&"string"===f.getType(d)&&h)try{e.Pdc(t,d,m,p,g,g,h)}catch(t){}else ue(t,o,m,p,g,n,r,i,a)},e}(Jt),e.IconSetRule=te,ee={iconSetType:nt("iconSetType",wt.threeArrowsColored,(function(t){this.xW(t)})),reverseIconOrder:nt("reverseIconOrder",!1),showIconOnly:nt("showIconOnly",!1)},f.extend(te.prototype,ee),oe=["ruleType","state","style","priority","stopIfTrue","ranges"],ne=function(t){function o(e,o,n,r){var i=t.call(this,e,n,r)||this;return i.state(o),i}return ie(o,t),o.prototype.isRow=function(){var t=this,e=t.ruleType();return O(t.hj)&&(e===At.rowStateRule?t.hj=!0:e===At.columnStateRule&&(t.hj=!1)),this.hj},o.prototype.isStateRule=function(){return!0},o.prototype.jMc=function(){var t=this.state(),o=this.ranges();return e.$V(xt.stateCondition,St.contains,t,d,d,d,o)},o.prototype.rowStateRuleCreateCondition=function(){return this.jMc()},o.prototype.columnStateRuleCreateCondition=function(){return this.jMc()},o.prototype.createCondition=function(){return this[At[this.ruleType()]+"CreateCondition"]()},o.prototype.evaluate=function(e,o,n,r){return this.isRow()?n=-1:o=-1,t.prototype.evaluate.call(this,e,o,n,r)},o.prototype.kMc=function(t){return o.StatesPriority.indexOf(this.state())<o.StatesPriority.indexOf(t.state())},o.prototype.fromJSON=function(t,e,o){var n=oe;O(t.condition)||(n=oe.concat(["condition"])),it.call(this,e,n,t,o),this.initCondition(e)},o.prototype.toJSON=function(t){var e,o=this;return O(o.condition())&&this.initCondition(),e=rt.call(o,t,oe),o.ruleType()===At.conditionRuleBase&&(e.condition=o.condition().toJSON()),e},o.StatesPriority=[l.StatesType.readonly,l.StatesType.invalid,l.StatesType.dirty,l.StatesType.inserted,l.StatesType.updated,l.StatesType.selected,l.StatesType.active,l.StatesType.hover,l.StatesType.edit],o}(_t),e.StateRule=ne,ne.prototype.state=nt("state",p),re=function(){function t(t){this.AW=[],this.BW=p,this.DW={},this.Kfc=!0,this.WS=t}return t.prototype.no=function(){this.WS=p},t.prototype.getRule=function(t){return this.AW[t]},t.prototype.count=function(){return X(this.AW)},t.prototype.w4=function(){return this.AW},t.prototype.UV=function(t){var e,o,n=[],r=this.WS,i=X(t);for(e=0;e<i;e++)o=r.Tq(t[e]),n.push(o);return n},t.prototype.EW=function(t){var e,o,n,r,i=[],a=this.WS;for(e=0,o=X(t);e<o;e++)n=t[e],r=new z(n.row,n.col,ae(n),se(n)),0===n.row&&ae(n)===a.getRowCount()&&(r.row=-1),0===n.col&&se(n)===a.getColumnCount()&&(r.col=-1),i.push(r);return i},t.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var t=0;t<X(this.AW);t++)this.FW(this.AW[t])},t.prototype.OV=function(){this.Kfc&&(this.DW={})},t.prototype.FW=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C;if(this.Kfc)for(o=(e=this).DW,s=e.UV(t.ranges()),u=(l=e.WS).getRowCount(),c=l.getColumnCount(),f=0;f<X(s);f++)for(p=(h=s[f]).row,d=h.col,p+(g=ae(h))-1>=u&&(g=u-p),d+(m=se(h))-1>=c&&(m=c-d),y=0;y<g;y++)for((n=o[i=y+p])||(o[i]=n=[]),C=0;C<m;C++)(r=n[a=C+d])||(n[a]=r=[]),r.push(t)},t.prototype.GW=function(t){var e,o,n,r,i,a,s,l,u,c,f;if(this.Kfc)for(e=this.DW,i=this.UV(t.ranges()),a=0;a<X(i);a++)for(s=i[a],l=0;l<ae(s);l++)if(o=e[l+s.row])for(u=0;u<se(s);u++)if(n=o[r=u+s.col]){for(c=[],f=0;f<X(n);f++)n[f]!==t&&c.push(n[f]);0===X(c)&&(c=d),o[r]=c}},t.prototype.HW=function(t,e,o,n){var r,i,a,s;if(this.Kfc)for(r=this.DW,a=0;a<o;a++)if(i=r[a+t])for(s=0;s<n;s++)i[s+e]=d},t.prototype.Ayb=function(t,e){var o,n,r=[];for(o=0;o<X(this.AW);o++)(n=this.AW[o]).contains(t,e)&&r.push(n);return r},t.prototype.addSpecificTextRule=function(t,e,o,n){var r=new zt(2,n,o,t,p,p,e);return this.addRule(r)},t.prototype.addCellValueRule=function(t,e,o,n,r){var i=new zt(1,r,n,t,pe(e),pe(o));return this.addRule(i)},t.prototype.addDateOccurringRule=function(t,e,o){var n=new zt(4,o,e,p,p,p,p,p,t);return this.addRule(n)},t.prototype.addFormulaRule=function(t,e,o){var n=new zt(3,o,e,p,p,p,p,t);return this.addRule(n)},t.prototype.addTop10Rule=function(t,e,o,n){var r=new zt(5,n,o,p,p,p,p,p,t,e);return this.addRule(r)},t.prototype.addUniqueRule=function(t,e){var o=new zt(6,e,t);return this.addRule(o)},t.prototype.addDuplicateRule=function(t,e){var o=new zt(7,e,t);return this.addRule(o)},t.prototype.addAverageRule=function(t,e,o){var n=new zt(8,o,e,p,p,p,p,p,t);return this.addRule(n)},t.prototype.add3ScaleRule=function(t,e,o,n,r,i,a,s,l,u){var c;return c=0===arguments.length?new Jt(11):new Jt(11,t,e,o,n,r,i,a,s,l,u),this.addRule(c)},t.prototype.add2ScaleRule=function(t,e,o,n,r,i,a){var s;return s=0===arguments.length?new Jt(10):new Jt(10,t,e,o,p,p,p,n,r,i,a),this.addRule(s)},t.prototype.addDataBarRule=function(t,e,o,n,r,i){var a;return a=0===arguments.length?new Yt:new Yt(t,e,o,n,r,i),this.addRule(a)},t.prototype.addIconSetRule=function(t,e){var o=new te(t,e);return this.addRule(o)},t.prototype.addRowStateRule=function(t,e,o,n){var r,i,a=this.WS;return O(o)&&(o=0),O(n)&&(n=a.getRowCount()-o),r=[new z(o,-1,n,-1)],i=new ne(At.rowStateRule,t,e,r),a.QLc.enableState(t,!0),this.addRule(i)},t.prototype.addColumnStateRule=function(t,e,o,n){var r,i,a=this.WS;return O(o)&&(o=0),O(n)&&(n=a.getRowCount()-o),r=[new z(-1,o,-1,n)],i=new ne(At.columnStateRule,t,e,r),a.QLc.enableState(t,!1),this.addRule(i)},t.prototype.addRule=function(e){var o,n,r,i,a,s,l,u,c,f,h,p,d=this,g=d.WS;if(g){if(!e)throw Error($().Exp_RuleIsNull);for(n=void 0,r=void 0,(o=e.ranges())&&(n=(i=L(o)).r,r=i.c,e.ranges(o.slice(0))),(s=(a=e.getExpected())&&a.formatter)&&"string"==typeof s&&g.fJb(n||0,r||0,s),g.ITa.YUa(),l=1,u=void 0,c=X(d.AW),u=0;u<c;u++)p=(h=(f=d.AW[u])._ps).priority||1,h.priority=p+1,e.isStateRule()&&f.isStateRule()&&e.kMc(f)&&(l=C(l,h.priority),h.priority-=1);return e.priority(l),d.AW.push(e),t.ao(g,"onRuleAdded",{ranges:o}),e.context(g),d.FW(e),g.$p(),e}},t.prototype.removeRule=function(e){var o,n,r,i,a,s,l,u,c=this,f=c.WS,h=f.parent;if(f){if(e&&((n=(o=e.getExpected())&&o.formatter)&&"string"==typeof n&&h.QHb[n]&&h.RHb(n),f.ITa.YUa(),c.GW(e),q(c.AW,e),t.ao(f,"onRuleRemoved",{priority:e.priority(),ranges:e.ranges()}),e.isStateRule())){for(r=e.state(),i=e.isRow(),a=!1,s=0,l=c.AW;s<l.length;s++)if((u=l[s]).isStateRule()&&u.state()===r){a=!0;break}a||f.QLc.disableState(r,i)}f.$p()}},t.prototype.IW=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,d,g,m,v,b;return t.intersect(e,o,n,r)?(i=t.row,a=t.row+ae(t)-1,s=t.col,l=t.col+se(t)-1,u=e,c=e+n-1,f=o,h=o+r-1,d=[],-1!==i&&-1!==s&&-1!==u&&-1!==f&&(f-s>0&&(g=H(i,s,ae(t),f-s),d.push(g)),l-h>0&&(m=H(i,h+1,ae(t),l-h),d.push(m)),u-i>0&&(v=H(i,C(f,s),u-i,y(h,l)-C(f,s)+1),d.push(v)),a-c>0&&(b=H(c+1,C(f,s),a-c,y(h,l)-C(f,s)+1),d.push(b))),X(d)>0?d:p):[t]},t.prototype.removeRuleByRange=function(e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m=this,y=m.WS;if(y){if(i=[],m.AW)for(y.ITa.YUa(),m.HW(e,o,n,r),a=0,s=X(m.AW);a<s;a++)if(l=m.AW[a],t.ao(y,"onRuleRemoved",{ranges:[new z(e,o,n,r)]}),l&&l.ranges()&&l.intersects(e,o,n,r))if(y.pivotTables&&l.pivotTableName)y.pivotTables.get(l.pivotTableName).nPc(l,e,o,n,r);else{for(u=[],c=m.UV(l.ranges()),f=0,h=X(c);f<h;f++)(p=m.IW(c[f],e,o,n,r))&&(u=u.concat(p));X(u)>0?l.ranges(m.EW(u)):i.push(l)}for(d=0,g=X(i);d<g;d++)q(m.AW,i[d]);y.$p()}},t.prototype.clearRule=function(){var e,o,n,r,i,a,s=this,l=s.WS,u=l.parent;if(l){for(e=s.AW,l.ITa.YUa(),o=0;o<e.length;o++)i=(r=(n=e[o]).getExpected())&&r.formatter,t.ao(l,"onRuleRemoved",{ranges:n.ranges()}),i&&"string"==typeof i&&u.QHb[i]&&u.RHb(i);if(l.pivotTables)for(a=l.pivotTables.all(),o=0;o<a.length;o++)a[o].oPc();s.AW.length=0,s.QV(),l.$p()}},t.prototype.getRules=function(t,e){var o,n,r,i,a,s,l,u,c=this,h=c.AW;if(0===arguments.length||0===X(h))return h;if(t=t===d?-1:t,e=e===d?-1:e,o=[],c.Kfc)n=c.DW,i=void 0,-1!==t&&-1!==e?(i=n[t])&&(r=i[e],de(o,r)):-1===t?f.each(n,(function(t,n){r=n[e],de(o,r)})):(i=n[t])&&f.each(i,(function(t,e){de(o,e)}));else if(s=(a=c.WS).getRowCount(),l=a.getColumnCount(),u=void 0,-1!==t&&-1!==e)de(o,c.Ayb(t,e));else if(-1===t)for(u=0;u<s;u++)de(o,c.Ayb(u,e));else for(u=0;u<l;u++)de(o,c.Ayb(t,u));return o},t.prototype.containsRule=function(t,e,o){return!(!t||!W.Bb(this.AW,t))&&t.contains(e,o)},t.prototype.lMc=function(t,e){var o,n,r,i,a,s,l,u,c,f,h=this,p=h.WS;if(p){if(!t)throw Error($().Exp_RuleIsNull);for(n=void 0,r=void 0,(o=t.ranges())&&(n=(i=L(o)).r,r=i.c),(s=(a=t.getExpected())&&a.formatter)&&"string"==typeof s&&p.fJb(n||0,r||0,s),p.ITa.YUa(),l=0,u=X(h.AW);l<u;l++)e<=(f=(c=h.AW[l]._ps).priority||1)&&(c.priority=f+1);return t.priority(e),h.AW[e]=t,t.context(p),h.FW(t),p.$p(),t}},t.prototype.XXc=function(t,e,o){var n,r,i=this,a=i.WS.ITa,s=i.AW,l=X(s),u=!1;for(a.YUa(),n=0;n<l;n++)(r=s[n])&&r.XXc(t,e,o)&&(u=!0);u&&i.QV()},t.prototype._V=function(t,e,o,n,r){var i,a,s,l=this;if(l.AW&&l.WS)for(i=X(l.AW),a=0;a<i;a++)(s=l.AW[a])&&(o?s.rI(t,e,n,r):s.tI(t,e,n,r));l.QV()},t.prototype.rI=function(t,e,o,n){this._V(t,e,!0,o,n)},t.prototype.tI=function(t,e,o,n){this._V(t,e,!1,o,n)},t.prototype.aW=function(t,e,o,n,r){var i,a,s=this;if(s.AW&&s.WS)for(i=X(s.AW)-1;i>=0;i--)(a=s.AW[i])&&(o?a.GR(t,e,n,r):a.HR(t,e,n,r),a.ranges().length<=0&&(s.GW(a),s.AW.splice(i,1)));s.QV()},t.prototype.GR=function(t,e,o,n){this.aW(t,e,!0,o,n)},t.prototype.HR=function(t,e,o,n){this.aW(t,e,!1,o,n)},t.prototype.Nm=function(){var t,e,o,n=this.AW;if(n!==p&&X(n)>0)for(e=0,o=X(n);e<o;e++)(t=n[e]).Nm&&t.Nm()},t.prototype.XA=function(t,e,o,n,r,i,a,s,l){var c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,G,B,_,V,z,U,W=[],q=[],Z=[],Y=[],K=[],Q=this,$=Q.WS,tt=!l&&$.KLc();for(-1===t&&(t=0,n=0,i=$.getRowCount()),-1===e&&(e=0,r=0,a=$.getColumnCount()),c=0;c<i;c++)for(f=0;f<a;f++)for(h=Q.getRules(t+c,e+f),p=0;p<X(h);p++)if(g=(d=h[p]).ranges(),!d.isStateRule()){for(m=[],y=0;y<X(g);y++)C=g[y],b=(v=$.Tq(C)).row,w=v.col,T=ae(v),S=se(v),(J(Z,C)<=-1||J(Z,C)>-1&&J(Y,d)<=-1)&&C.contains(t+c,e+f)&&(Z.push(C),Y.push(d),(x=H(n+c,r+f,-1,-1)).rowCount=b+T>=i+t?i-c:t<b?T:b+T-t,x.colCount=w+S>=a+e?a-f:e<w?S:w+S-e,Q===o&&C.containsRange(x)||m.push(x),s&&!me(K,x)&&K.push(x));m.length>0&&((A=W.indexOf(d))<0?(tt&&(m=Q.mMc(m)),W.push(d),q.push(m)):(tt&&(void 0,void 0,void 0,void 0,N=q[A][0].row,O=q[A][0].col,I=(D=m[0]).row-N,R=D.col-O,M=$.MLc(N,I,!0),k=$.MLc(O,R),D.row+=M,D.col+=k,m=Q.mMc(m)),q[A]=q[A].concat(m)))}for(F=0,E=W.length;F<E;F++)P=(j=Q.iga(W[F].toJSON(),W[F].context())).ranges(),j.ranges(q[F]),(G=j.Yw)&&(B=1===$.parent.options.referenceStyle,_=L(P),V=u.formulaToExpression($,G,_.r,_.c,B),z=L(q[F]),U=u.expressionToFormula($,V,z.r,z.c,B),j.formula(U)),o.addRule(j);return Q.QV(),K},t.prototype.mMc=function(t){var e,o,n,r,i,a,s,l,u,c,f=this.WS,h=[];if(t.length>0){for(o=(e=t[0]).row,n=e.col,r=e.rowCount,i=e.colCount,r+=f.MLc(o,r,!0),i+=f.MLc(n,i),a=[],s=void 0,l=0;l<i;l++)0!==l?0!==f.getColumnWidth(n+l)?s.colCount++:(a.push(s),l=f.Zq(n+l-1)-1-n,s=new z(o,n+l+1,1,0)):s=new z(o,n,1,1);for(a.push(s),u=0;u<r;u++)if(0!==u)if(0!==f.getRowHeight(o+u))for(c=0;c<a.length;c++)a[c].rowCount++;else for(h=h.concat(ge(a)),u=f._q(o+u-1)-1-o,c=0;c<a.length;c++)a[c].rowCount=0,a[c].row=o+u+1;h=h.concat(a)}return h},t.prototype.YA=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,v,b,w,T,S=[],x=this,A=x.WS,I=A.getRowCount(3),R=A.getColumnCount(3);for(-1===t&&(t=0,o=A.getRowCount()),-1===e&&(e=0,n=A.getColumnCount()),a=0;a<o;a++)for(s=0;s<n;s++)for(l=x.getRules(t+a,e+s),u=0;u<X(l);u++)if(f=(c=l[u]).ranges(),!c.isStateRule()){for(h=[],p=0;p<X(f);p++)d=f[p],m=(g=A.Tq(d)).row,v=g.col,b=ae(g),w=se(g),me(r,d)||J(S,d)<=-1&&d.contains(t+a,e+s)&&(S.push(d),t>m&&h.push(H(m,v,t-m,w)),e>v&&h.push(H(C(t,m),v,y(t+o,m+b)-C(t,m),e-v)),e+n<v+w&&h.push(H(C(t,m),e+n,y(t+o,m+b)-C(t,m),v+w-(e+n))),t+o<m+b&&h.push(H(t+o,v,m+b-(t+o),w)));A&&A.ITa.YUa(),x.Byb(A,S,r,f,I,R,i),(T=f.concat(h)).length>0?(c.yyb(),c.ranges(T)):x.removeRule(c)}x.QV()},t.prototype.Byb=function(t,e,o,n,r,i,a){var s,l,u,c,f,h;for(s=0;s<X(e);s++){if(u=[l=e[s]],a)for(c=0;c<X(o);c++)f=o[c],l.intersect(f.row,f.col,f.rowCount,f.colCount)&&(u=u.concat(t.v_a(l,f,r,i)));for(h=0;h<X(u);h++)q(n,u[h])}},t.prototype.jp=function(t,e,o,n,r,i,a,s){var l=16,u=!1,c=!1,f=s.sheet,h=s.row,p=s.col,d=f.zoom(),g=this.oRa(f,h,p,e),m=g.iconSet,y=g.dataBar;return(y||m)&&(t.save(),t.beginPath(),y&&(Yt.paintDataBar(t,y,o,n,r,i),u=y.showBarOnly),m&&((r<(l=parseInt(l*d+"",10))||i<l)&&(t.rect(o,n,r,i),t.clip(),t.beginPath()),te.paintIconSet(t,m,o,n,r,i,a,s.lineHeight,d,s.imageLoader),c=m.showIconOnly),t.restore()),u||c},t.prototype.oRa=function(t,e,o,n){var r,i,a,s,l,u,c,f,h=t.ss,d=h.Um(e,o);if(d)r=d.i,i=d.d;else{if(a=this.getRules(e,o),(s=X(a))>0){for(a.sort((function(t,e){return t.priority()-e.priority()})),l=p,u=p,c=void 0,void 0,f=void 0,f=0;f<s&&(!l||!u);f++)(c=a[f])&&(F(c,Yt)&&(l=c),F(c,te)&&(u=c));if(l||u)for(l=u=p,f=0;!(!(f<s)||l&&u||(c=a[f],c&&(!l&&F(c,Yt)&&(l=c),!u&&F(c,te)&&(u=c),c.stopIfTrue()&&c.evaluate(t,e,o,n))));f++);l&&(i=l.evaluate(t,e,o,n)),u&&(r=u.evaluate(t,e,o,n))}h.Wm(e,o,i,r)}return{dataBar:i,iconSet:r}},t.prototype.bp=function(t,e,o){var n,r,i;if(O(o)||3===o)for(n=this.getRules(t,e),r=0,i=X(n);r<i;r++)if(n[r]instanceof te)return!0;return!1},t.prototype.toJSON=function(t){var e,o,n=[];for(e=0;e<X(this.AW);e++)o=this.AW[e],n.push(o?o.toJSON(t):p);return 0===X(n)?d:{rules:n}},t.prototype.fromJSON=function(t,e,o,n){var r,i,a,s,l;if(t&&(r=t.rules)){for(this.AW=[],i=X(r),a=0;a<i;a++)(s=r[a]).pivot&&n||(l=this.iga(s,e,o))&&this.AW.push(l);this.Kfc=!function(t){var e,o,n,r,i=X(t);for(e=0;e<i;e++)if(o=t[e],n=o.ranges)for(r=0;r<n.length;r++)if(n[r].rowCount>1e3)return!0;return!1}(r),this.QV()}},t.prototype.iga=function(t,e,o){var n,r=p;return t&&((n=this.JW()[t.ruleType])&&(r=new n).fromJSON(t,e,o)),r},t.prototype.JW=function(){if(!this.BW){var t={};t[0]=zt,t[1]=zt,t[2]=zt,t[3]=zt,t[4]=zt,t[5]=zt,t[6]=zt,t[7]=zt,t[8]=zt,t[9]=Jt,t[10]=Jt,t[11]=Jt,t[12]=Yt,t[13]=te,t[14]=ne,t[15]=ne,this.BW=t}return this.BW},t.prototype.Eq=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,g=this;if(g&&g.count()>0&&(r=g.getRules(e,o),i=X(r),a=void 0,s=p,i>0))for(r.sort((function(t,e){return t.priority()-e.priority()})),l=0;l<i&&!((a=r[l])&&(u=g.WS,a.isScaleRule()?10!==a.ruleType()&&11!==a.ruleType()||(s=a.evaluate(u,e,o,u.getValue(e,o,n)),s&&(t||(t=new B),t.backColor===d&&(t.backColor=s))):a.isStateRule()?(c=a.state(),f=a.isRow(),h=u.QLc.getState(e,o,c,f),s=a.evaluate(u,e,o,h),s&&(t||(t=new B),t.Yo(s,!1,1))):(s=a.evaluate(u,e,o,u.getValue(e,o,n)),s&&(t||(t=new B),t.Yo(s,!1,1))),a.stopIfTrue()&&s));l++);return t},t.prototype.Fq=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,g,m,y={v5:!1},C=this;if(C&&C.count()>0&&(r=C.getRules(t,e),i=X(r),a=void 0,s=p,i>0))for(r.sort((function(t,e){return t.priority()-e.priority()})),l=0;l<i;l++)if(a=r[l]){if(u=C.WS,a.isScaleRule()){if(c=a.ruleType(),"backColor"===o&&(10===c||11===c)&&(s=a.evaluate(u,t,e,u.getValue(t,e,n)))){y.Fi=s,y.v5=!0;break}}else if(a.isStateRule()){if(f=a.state(),h=a.isRow(),g=u.QLc.getState(t,e,f,h),!((m=a.style())&&void 0!==m[o]||a.stopIfTrue()))continue;if((s=a.evaluate(u,t,e,g))&&s[o]!==d){y.Fi=s[o],y.v5=!0;break}}else{if(!((m=a.style())&&void 0!==m[o]||a.stopIfTrue()))continue;if((s=a.evaluate(u,t,e,u.getValue(t,e,n)))&&s[o]!==d){y.Fi=s[o],y.v5=!0;break}}if(a.stopIfTrue()&&s)break}return y},t}(),e.ConditionalFormats=re,j(re)},"./dist/plugins/conditional/conditional.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/conditional/conditional.res.en.js");e.SR={en:n}},"./dist/plugins/conditional/conditional.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_RuleIsNull="The argument 'rule' is null",e.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b;function w(t,e,o,n,r){t.beginPath(),t.moveTo(e,o),t.lineTo(e+n,o),t.lineTo(e+n,o+r),t.lineTo(e,o+r),t.lineTo(e,o),t.closePath(),t.fill(),t.stroke()}function T(t,e,o){t.moveTo(i(.1*n)*e,-a(.1*n)*e),t.lineTo(i(.3*n)*o,-a(.3*n)*o),t.lineTo(0*e,-a(.5*n)*e),t.lineTo(i(.7*n)*o,-a(.7*n)*o),t.lineTo(i(.9*n)*e,-a(.9*n)*e),t.lineTo(i(1.1*n)*o,-a(1.1*n)*o),t.lineTo(i(1.3*n)*e,-a(1.3*n)*e),t.lineTo(0*o,-a(1.5*n)*o),t.lineTo(i(1.7*n)*e,-a(1.7*n)*e),t.lineTo(i(1.9*n)*o,-a(1.9*n)*o),t.lineTo(i(.1*n)*e,-a(.1*n)*e)}function S(t,e,o,i,a,s){var l=s,u=r(l/2);t.translate(i+u,a+u),t.strokeStyle=b[e][o].strokeStyle,t.rotate(b[e][o].rotate),t.beginPath(),t.arc(0,0,u,0,2*n),t.closePath(),t.fillStyle=b[e][o].fillColor,t.fill(),t.beginPath(),t.arc(0,0,u,0,2*n),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=b[e][o].fillColor2,t.fillRect(.375*-l,.1*-l,.75*l,.2*l),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[e][o].fillColor2,t.fillRect(.1*-l,.375*-l,.2*l,.75*l),t.closePath(),t.fill(),t.stroke()}function x(t,e,o,r,i,a){var s=a;t.translate(r,i),t.strokeStyle=b[e][o].strokeStyle,t.beginPath(),t.arc(.5*s,.5*s,.5*s,0,2*n),t.closePath(),t.fillStyle=b[e][o].fillColor,t.fill(),t.beginPath(),t.arc(.5*s,.5*s,.5*s,0,2*n),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(s/3,.1*s),t.lineTo(s/1.5,.1*s),t.lineTo(.625*s,.6*s),t.lineTo(.375*s,.6*s),t.lineTo(s/3,.1*s),t.moveTo(.625*s,.85*s),t.arc(.5*s,.8*s,.15*s,0,2*n),t.fillStyle=b[e][o].fillColor2,t.fill(),t.closePath()}function A(t,e,o,i,a,s){var l=s;t.translate(r(i+l/2),r(l/2+a)),t.strokeStyle=b[e][o].strokeStyle,t.rotate(b[e][o].rotate),t.beginPath(),t.arc(0,0,l/2,0,2*n),t.closePath(),t.fillStyle=b[e][o].fillColor,t.fill(),t.beginPath(),t.arc(0,0,l/2,0,2*n),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=b[e][o].fillColor2,t.fillRect(.325*-l,.25*-l,.2*l,.5*l),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[e][o].fillColor2,t.fillRect(.325*-l,.05*l,.65*l,.2*l),t.closePath(),t.fill(),t.stroke()}function I(t,e,o,r,i,a){var s=a;t.translate(r,i),t.beginPath(),t.strokeStyle=b[e][o].strokeStyle,t.moveTo(s/3,.5),t.lineTo(s/1.5,.5),t.lineTo(.625*s,.65*s),t.lineTo(.375*s,.65*s),t.lineTo(s/3,.5),t.moveTo(.65*s,.85*s),t.arc(.5*s,.85*s,.15*s,0,2*n),t.fillStyle=b[e][o].fillColor,t.fill(),t.stroke()}function R(t,e,o,n,i,a){var s,l,u=a;t.translate(r(n+u/2),r(i+u/2)),t.strokeStyle=b[e][o].strokeStyle,t.rotate(b[e][o].rotate),t.beginPath(),P(t,-(s=.5*u),-(l=.075*u)),j(t,-s,l),j(t,-l,l),j(t,-l,s),j(t,l,s),j(t,l,l),j(t,s,l),j(t,s,-l),j(t,l,-l),j(t,l,-s),j(t,-l,-s),j(t,-l,-l),j(t,-s,-l),t.fillStyle=b[e][o].fillColor,t.fill(),t.stroke()}function M(t,e,o,n,i,a){var s=a;t.translate(r(n+s/2),r(i+s/2)),t.strokeStyle=b[e][o].strokeStyle,t.rotate(b[e][o].rotate),t.beginPath(),t.fillStyle=b[e][o].fillColor,t.fillRect(.375*-s,.25*-s,.2*s,.5*s),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[e][o].fillColor,t.fillRect(.375*-s,.05*s,.75*s,.2*s),t.closePath(),t.fill(),t.stroke()}function k(t,e,o,r,i,a){var s=a;t.strokeStyle=b[e][o].strokeStyle,t.beginPath(),t.arc(s/2+r,s/2+i,s/2,0,2*n),t.fillStyle=b[e][o].fillColor,t.closePath(),t.fill(),t.stroke()}function N(t,e,o,n,i,a){var s=a;t.strokeStyle=b[e][o].strokeStyle,t.beginPath(),t.translate(n+r(s/2),i+r(s/2)),t.beginPath(),P(t,0,-s/2),j(t,s/2,0),j(t,0,s/2),j(t,-s/2,0),j(t,0,-s/2),t.fillStyle=b[e][o].fillColor,t.closePath(),t.fill(),t.stroke()}function O(t,e,o,n,i,a){var s=r(a);t.translate(n,i),t.strokeStyle=b[e][o].strokeStyle,t.beginPath(),P(t,0,s),j(t,s/2,s-s/2*Math.sqrt(3)),j(t,s,s),j(t,0,s),t.fillStyle=b[e][o].fillColor,t.closePath(),t.fill(),t.stroke()}function D(t,e,o,n,i,a){var s=a;t.strokeStyle=b[e][o].strokeStyle,t.translate(r(s/2+n),r(s/2+i)),t.beginPath(),t.rotate(b[e][o].rotate),P(t,-s/2,-s/5.4),j(t,s/2,-s/5.4),j(t,s/2,s/5.4),j(t,-s/2,s/5.4),j(t,-s/2,-s/5.4),t.fillStyle=b[e][o].fillColor,t.fill(),t.stroke()}function F(t,e,o,n,i,a){t.strokeStyle=b[e][o].strokeStyle;var s=a;t.translate(r(s/2+n),r(s/2+i)),t.beginPath(),P(t,-s/2,-s/3),j(t,s/2,-s/3),j(t,0,s/3),j(t,-s/2,-s/3),t.fillStyle=b[e][o].fillColor,t.fill(),t.stroke()}function E(t,e,o,n,i,a){t.strokeStyle=b[e][o].strokeStyle;var s=a;t.translate(r(s/2+n),r(s/2+i)),t.beginPath(),P(t,-s/2,s/3),j(t,s/2,s/3),j(t,0,-s/3),j(t,-s/2,s/3),t.fillStyle=b[e][o].fillColor,t.fill(),t.stroke()}function j(t,e,o){t.lineTo(r(e)+.5,r(o)+.5)}function P(t,e,o){t.moveTo(r(e)+.5,r(o)+.5)}Object.defineProperty(e,"__esModule",{value:!0}),n=Math.PI,r=Math.round,i=Math.cos,a=Math.sin,b=[[{strokeStyle:l="#326f5b",fillColor:u="#76a797",fillColor2:"",rotate:n},{strokeStyle:c="#A4802b",fillColor:f="#EAC282",fillColor2:"",rotate:-.5*n},{strokeStyle:h="#9E381C",fillColor:p="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:d="#646262",fillColor:g="#808080",fillColor2:"",rotate:n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.5*n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:n}],[{strokeStyle:c,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:y="#303030",fillColor:C="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:y,fillColor:C,fillColor2:"#eac282",rotate:0},{strokeStyle:y,fillColor:C,fillColor2:u,rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"white",rotate:.25*n},{strokeStyle:c,fillColor:f,fillColor2:"white",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"white",rotate:-.25*n}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:.25*n},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:-.25*n}],[{strokeStyle:l,fillColor:u,fillColor2:"",rotate:n},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.75*n},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.25*n},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:g,fillColor2:"",rotate:n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.75*n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.25*n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:m="#353535",fillColor:C,fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:v="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:s="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:C,fillColor2:"",rotate:0},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:u,fillColor2:"",rotate:n},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.75*n},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.5*n},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.25*n},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:g,fillColor2:"",rotate:n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.75*n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.5*n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.25*n},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:s,fillColor2:"",rotate:0}],[{strokeStyle:C,fillColor:C,fillColor2:"",rotate:2*n},{strokeStyle:C,fillColor:C,fillColor2:"",rotate:.5*n},{strokeStyle:C,fillColor:C,fillColor2:"",rotate:.5*n},{strokeStyle:C,fillColor:C,fillColor2:"",rotate:1*n},{strokeStyle:C,fillColor:C,fillColor2:"",rotate:2*n}],[{strokeStyle:v,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:v,fillColor:s,fillColor2:"",rotate:0}]],e.drawSignal=function(t,e,o,n,i,a){var s,l;t.translate(n,i),t.strokeStyle=b[e][o].strokeStyle,s=b[e][o].fillColor.split(" "),l=r(.2*a),t.fillStyle=s[0],w(t,l+.5,3*l+.5,l,2*l),t.fillStyle=s[1],w(t,2*l+.5,2*l+.5,l,3*l),t.fillStyle=s[2],w(t,3*l+.5,l+.5,l,4*l),t.fillStyle=s[3],w(t,4*l+.5,.5,l,5*l)},e.drawMagicCube=function(t,e,o,n,i,a){var s,l;t.translate(n,i),t.strokeStyle=b[e][o].strokeStyle,s=b[e][o].fillColor.split(" "),t.fillStyle=b[e][o].strokeStyle,l=r(a/2),t.fillStyle=s[0],w(t,.5,.5,l,l),t.fillStyle=s[1],w(t,l+.5,.5,l,l),t.fillStyle=s[2],w(t,.5,l+.5,l,l),t.fillStyle=s[3],w(t,l+.5,l+.5,l,l)},e.drawSector=function(t,e,o,r,i,a){t.translate(r+a/2,i+a/2),t.strokeStyle=b[e][o].strokeStyle,4===o?(t.beginPath(),t.arc(0,0,a/2,0,b[e][o].rotate),t.closePath(),t.fillStyle=b[e][o].fillColor,t.fill(),t.beginPath(),t.arc(0,0,a/2,0,b[e][o].rotate),t.closePath(),t.stroke()):0===o?(t.beginPath(),t.arc(0,0,a/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,a/2,0,b[e][o].rotate),t.stroke(),t.closePath()):1===o?(t.beginPath(),t.arc(0,0,a/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-a/2),t.arc(0,0,a/2,.5*-n,0),t.lineTo(0,0),t.closePath(),t.fillStyle=b[e][o].fillColor,t.fill(),t.arc(0,0,a/2,0,2*n),t.stroke()):2===o?(t.beginPath(),t.arc(0,0,a/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-a/2),t.arc(0,0,a/2,.5*-n,.5*n),t.moveTo(0,0),t.closePath(),t.fillStyle=b[e][o].fillColor,t.fill(),t.arc(0,0,a/2,0,2*n),t.stroke()):3===o&&(t.beginPath(),t.arc(0,0,a/2,0,2*n),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-a/2),t.arc(0,0,a/2,.5*-n,n),t.lineTo(0,0),t.fillStyle=b[e][o].fillColor,t.fill(),t.arc(0,0,a/2,0,2*n),t.stroke(),t.closePath())},e.drawStar=function(t,e,o,r,s,l){var u=l/1.8,c=u/2.5;t.translate(u+r,u+s),t.strokeStyle="#727272",t.fillStyle=b[e][o].fillColor,t.beginPath(),2===o&&(t.strokeStyle="#727272",T(t,u,c),t.fill(),t.stroke(),t.strokeStyle=b[e][o].strokeStyle,T(t,u,c),t.stroke(),t.closePath()),0===o&&(t.fillStyle="white",T(t,u,c),t.fill(),t.stroke(),t.strokeStyle="#727272",T(t,u,c),t.stroke(),t.closePath()),1===o&&(t.strokeStyle=b[e][o].fillColor,t.moveTo(0*u,-a(.5*n)*u),t.lineTo(i(.7*n)*c,-a(.7*n)*c),t.lineTo(i(.9*n)*u,-a(.9*n)*u),t.lineTo(i(1.1*n)*c,-a(1.1*n)*c),t.lineTo(i(1.3*n)*u,-a(1.3*n)*u),t.lineTo(0*c,-a(1.5*n)*c),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*u,-a(.5*n)*u),t.lineTo(-i(.7*n)*c,-a(.7*n)*c),t.lineTo(-i(.9*n)*u,-a(.9*n)*u),t.lineTo(-i(1.1*n)*c,-a(1.1*n)*c),t.lineTo(-i(1.3*n)*u,-a(1.3*n)*u),t.lineTo(0*c,-a(1.5*n)*c),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",T(t,u,c),t.stroke(),t.closePath())},e.drawIconTypeIsEight=function(t,e,o,n,r,i){2===o?A(t,e,o,n,r,i):0===o?S(t,e,o,n,r,i):1===o&&x(t,e,o,n,r,i)},e.drawIconTypeIsNine=function(t,e,o,n,r,i){2===o?M(t,e,o,n,r,i):0===o?R(t,e,o,n,r,i):1===o&&I(t,e,o,n,r,i)},e.drawFlag=function(t,e,o,n,i,a){var s=1.2*a;t.translate(n,i),t.strokeStyle=g,t.fillStyle=g,w(t,r(.2*s)+.5,.5,r(.06*s),r(.8*s)),t.strokeStyle=b[e][o].strokeStyle,t.beginPath(),P(t,.4*s,.5),j(t,.4*s,.5*s),j(t,.9*s,.25*s),j(t,.4*s,.5),t.fillStyle=b[e][o].fillColor,t.fill(),t.stroke()},e.drawIconTypeIsSen=function(t,e,o,n,r,i){2===o?k(t,e,o,n,r,i):1===o?O(t,e,o,n,r,i):N(t,e,o,n,r,i)},e.drawTrafficLight=function(t,e,o,i,a,s){var l=r(s);t.strokeStyle=b[e][o].strokeStyle,t.fillStyle=b[e][o].fillColor,w(t,i+.5,a+.5,l,l),t.beginPath(),t.arc(l/2+i+.5,l/2+a+.5,.375*l,0,2*n),t.fillStyle=b[e][o].fillColor2,t.fill(),t.stroke()},e.drawCircle=k,e.drawIconTypeIsTwo=function(t,e,o,n,r,i){1===o?D(t,e,o,n,r,i):0===o?F(t,e,o,n,r,i):2===o&&E(t,e,o,n,r,i)},e.drawArrows=function(t,e,o,n,i,a){var s,l,u,c,f=a/3.5,h=b[e].length-1;t.strokeStyle=b[e][h-o].strokeStyle,t.translate(r(1.75*f+n),r(1.75*f+i)),t.rotate(b[e][h-o].rotate),t.beginPath(),s=.25*f,l=1.25*f,P(t,-(u=.75*f),-(c=1.75*f)),j(t,s,-c),j(t,s,s),j(t,l,-u),j(t,l,s),j(t,-s,c),j(t,-c,s),j(t,-c,-u),j(t,-u,s),j(t,-u,-c),t.fillStyle=b[e][h-o].fillColor,t.fill(),t.stroke()}},"./dist/plugins/contextMenu/context-menu-dialog.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=n.Ul.vl,i=n.Go,a=n.GC$,s="gc.command.executed",l=function(t){function e(e,o){var n=t.call(this,e,r(e))||this;return n.Eu=o,n}return u(e,t),e.prototype.Qla=function(t,e,o){var n=this,r=t[0];n.kma&&n.kma.ai&&n.kma.ai(r,e,o,n.Eu)},e.prototype.OT=function(t,e,o,n,r){var i=this,a=i.Sla(o,n);i.kma=t,i.Qla(a,e,r)},e.prototype.Sla=function(e,o){var n=this.yo();return n.css(["left","top"],[e,o]),n.empty(),t.prototype.Ao.call(this),this.QQ(),n},e.prototype.Loa=function(t){var e,o,n,r=this.yo();return"block"!==r.css("display")||((e=r.offset()).top+=document.body.clientTop||0,e.left+=document.body.clientLeft||0,o=t.x,n=t.y,o<e.left||o>r.width()+e.left||n<e.top||n>r.height()+e.top)},e.prototype.QQ=function(){var t=this;t.Eu.bind(s,(function(){t.close()}))},e.prototype.Tla=function(){this.Eu.unbind(s)},e.prototype.close=function(){var e=this;e.kma&&e.kma.no(),e.Tla(),e.vo(e.Cj)&&a("#"+e.Cj).remove(),t.prototype.close.call(this)},e}(i),e.ContextMenuViewDialog=l},"./dist/plugins/contextMenu/context-menu.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/contextMenu/context-menu.js")),n(o("./dist/plugins/contextMenu/menu-view.js")),n(o("./dist/plugins/contextMenu/context-menu.ns.js"));var r=o("./dist/plugins/contextMenu/context-menu-dialog.js");e.Cyb=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt,Yt,Kt,Qt,$t,te,ee,oe;function ne(t){var e,o;if(t.slicers){if(!(e=t.slicers.all())||c(e))return null;for(o in e)if(e[o].isSelected())return!0;return!1}}function re(t,e,o){var n,r,i,a,s=e===Yt?"rowCount":"colCount";for(n=0;n<t.length;n++)for(i=-1===(r=t[n])[e]?0:r[e],a=0;a<r[s];a++)o(i+a)}function ie(t,e){var o,n=[],r=-1;for(o=t.row;o<t.row+t.rowCount;o++)!1!==e[o]&&-1===r&&(r=o),!1===e[o]&&-1!==r&&(n.push([r,o-r]),r=-1);return-1!==r&&n.push([r,o-r]),n}function ae(t,e){var o,n,r,i;if(1===e.colCount&&-1===e.row){if((o=e.col)===t.$q()&&((n=o-1)>=0&&!t.getColumnVisible(n)))return!0}else if(1===e.rowCount&&-1===e.col&&((r=e.row)===t.ar()&&((i=r-1)>=0&&!t.getRowVisible(i))))return!0}function se(t,e){var o=e.name,n=e.group;return[p+Ot,p+Nt,p+At].indexOf(o)<0&&p+At!==n||(!a.sJc(t).xUc||p+At!==o&&p+At!==n)}function le(t,e){return[p+St].indexOf(e.name)<0||!a.sJc(t).xUc}function ue(t,e){return[p+bt,p+Tt,p+vt,p+wt].indexOf(e.name)<0||!a.sJc(t).xUc}function ce(t,e){var o=e.name;return[p+ft,p+st,p+lt,p+at].indexOf(o)<0||(!a.sJc(t).xUc||o!==p+lt&&o!==p+at)}function fe(t,e){var o,n,r,i,s,l=[p+mt,p+nt,p+et,p+ot],u=e.name;if(l.indexOf(u)<0)return!0;if(n=(o=a.sJc(t)).getActiveRowIndex(),r=o.getActiveColumnIndex(),o.comments){if(o.comments.get(n,r))return u!==p+mt;if(u===p+nt||u===p+et)return!1;if(u===p+mt)return!0;for(i=o.getSelections(),s=0;s<i.length;s++)if(pe(i[s],o))return!0;return!1}}function he(t,e){var o,n,r,i,a,s;if(e.comments)for(o=e.comments.all(),n=void 0,r=void 0,i=0;i<t.length;i++)for(a=t[i],s=0;s<o.length;s++)if(!o[s].locked()&&(r=o[s].nT,n=o[s].oT,r>=a.row&&r<a.row+a.rowCount&&n>=a.col&&n<a.col+a.colCount))return!0;return!1}function pe(t,e){var o,n,r,i;if(e.comments)for(o=e.comments.all(),n=void 0,r=void 0,i=0;i<o.length;i++)if(r=o[i].nT,n=o[i].oT,r>=t.row&&r<t.row+t.rowCount&&n>=t.col&&n<t.col+t.colCount)return!0;return!1}function de(t,e){var o,n,r,i,s;return[p+dt,p+gt].indexOf(e.name)<0||!((o=a.sJc(t)).xUc||(n=o.getSelections(),!n||1!==n.length||(r=n[0],i=me(o,r),i&&(s=i.range(),r.row<s.row||r.col<s.col||r.row+r.rowCount>s.row+s.rowCount||r.col+r.colCount>s.col+s.colCount))))}function ge(t){var e,o,n,r,i;if(t.xUc)return!1;if(e=t.getActiveRowIndex(),o=t.getActiveColumnIndex(),!t.tu().UHb)return!1;if(t.tables&&t.tables.find(e,o))return!1;for(n=t.ITa.getSpans(),r=0;r<n.length;r++)if(e>=(i=n[r]).row&&e<i.row+i.rowCount&&o>=i.col&&o<i.col+i.colCount)return!1;return!0}function me(t,e){var o,n,r;if(!e)return null;for(a.Ul.rXc(e,t.getRowCount(),t.getColumnCount()),o=e.row;o<e.row+e.rowCount;o++)for(n=e.col;n<e.col+e.colCount;n++)if(t.tables&&(r=t.tables.find(o,n)))return r;return null}function ye(t,e,o,n){var r,i;for(r=0;r<e.length;r++)(i=e[r]).PIb(o,n,!0,Kt,i.nKb())}function Ce(t){var e,o,n,r=t;for(e=0;e<r.length-1;e++)for(o=e+1;o<r.length;o++)r[e].row<r[o].row&&(n=r[e],r[e]=r[o],r[o]=n);return r}function ve(t){var e,o,n,r=t;for(e=0;e<r.length-1;e++)for(o=e+1;o<r.length;o++)r[e].col<r[o].col&&(n=r[e],r[e]=r[o],r[o]=n);return r}function be(t,e,o,n){var r=t.ITa.getSpans(Kt,3);e>=0?(Te(t,r,e,n,3),Te(t,t.ITa.getSpans(Kt,2),e,n,2)):o>=0&&(we(t,r,o,n,3),we(t,t.ITa.getSpans(Kt,1),o,n,1))}function we(t,e,o,n,r){var i,a,s,l,u,c,f;for(i=0,a=e.length;i<a;i++)if(o>(s=e[i]).col&&o<s.col+s.colCount)for(l=t.getStyle(s.row,s.col,r),u=o;u<o+n;u++)for(c=s.row;c<s.row+s.rowCount;c++)t.setStyle(c,u,l,r),c===s.row+s.rowCount-1&&((f=t.getCell(s.row+s.rowCount-1,s.col).borderBottom())&&t.getCell(c,u).borderBottom(f))}function Te(t,e,o,n,r){var i,a,s,l,u,c,f;for(i=0,a=e.length;i<a;i++)if(o>=(s=e[i]).row&&o<=s.row+s.rowCount)for(l=t.getStyle(s.row,s.col,r),u=o;u<o+n;u++)for(c=s.col;c<s.col+s.colCount;c++)t.setStyle(u,c,l,r),c===s.col+s.colCount-1&&((f=t.getCell(s.row,s.col+s.colCount-1).borderRight())&&t.getCell(u,c).borderRight(f))}function Se(t,e,o,n,r){var i,s,l,u,c,f=a.uJc(t,e.sheetName);return!!f&&(i=e.considerAllSheets,s=t.yJc(),f.suspendPaint(),l=a.Commands.bWa(f.name()),o?(r&&r(f,e),i?a.Commands._xb(s,e):f.ITa.undo(e[l])):(i?a.Commands.Zxb(s):f.ITa.startTransaction(),u=n(f,e),i?a.Commands.$xb(s,e):e[l]=f.ITa.endTransaction()),f.resumePaint(),i&&((c=a.sJc(t))&&f!==c&&c.repaint()),u)}function xe(t,e,o){var n;if(o>0){for(n=e+1;n<t.getRowCount();n++)if((o-=t.getRowHeight(n))<=0)return n-e}else if(o<0)for(n=e-1;n>=0;n--)if((o+=t.getRowHeight(n))>=0)return n-e;return 0}function Ae(t,e,o,n){var r=a.uJc(t,e.sheetName);r&&o.execute({cmd:xt,sheetName:r.name(),pasteOption:n})}function Ie(t,e,o,n){return Se(t,e,o,(function(o){var r,i=function(t){var e,o,n;if(t.slicers){if(!(e=t.slicers.all())||c(e))return null;for(n in o=[],e)e[n].isSelected()&&o.push(e[n]);return o}}(o);if(i&&0!==i.length){for(r in i)i.hasOwnProperty(r)&&i[r].sortState(n);t.changeSelectionInCommandExecuting(e,null,null,[],i)}}))}function Re(t){t.Os(8,$t().hideSheetFailureInfo)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/plugins/contextMenu/context-menu-dialog.js"),i=o("./dist/plugins/contextMenu/menu-view.js"),a=o("Core"),s=o("./dist/plugins/contextMenu/context-menu.ns.js"),l=a.GC$,u=n.Common.j.Fa,c=n.Common.j.za,f=a.Ul.nl,h="gc.spread.contextMenu.",p="gc.spread.",d="gc-spread-",g="gc.spread.pivot",m="gc-spread-pivot-selected",y="viewport",C="colHeader",v="rowHeader",b="slicer",w="sheetTab",T="corner",S="pivotPageFilter",x="pivotTopLeft",A="pivotHeader",I="pivotContent",R="pivotGrandTotal",M="FieldName",k="SortType",N="pivotSummarizeValuesBy",O="pivotExpandOrCollapse",D="pivotTableGroup",F="pivotTableUnGroup",E="pivotShowValueAs",j="pivotShowDetails",P="pivotRefresh",L="removeField",G="removePivotGrandTotal",B="openValueFieldSettingDialogCmd",_="UpdatePivotValueFieldCmd",V="pivotFilter",H="pivotClearFilterFrom",z="pivotKeepOnlySelectedItems",U="pivotHideSelectedItems",W="pivotLabelFilters",q="pivotExpand",J="pivotCollapse",X="pivotExpandEntireField",Z="pivotCollapseEntireField",Y="createDialogForValueFilter",K="OpenPivotShowValueAsDialog",Q="filterFieldLabelValue",$="pivotSort",tt="removeSlicer",et="toggleComment",ot="deleteComment",nt="editComment",rt="unhideSheet",it="hideSheet",at="unhideRows",st="unhideColumns",lt="hideRows",ut="pinRows",ct="pinColumns",ft="hideColumns",ht="sortAscend",pt="sortDescend",dt="sort",gt="filter",mt="insertComment",yt="deleteSheet",Ct="insertSheet",vt="insertRows",bt="insertColumns",wt="deleteRows",Tt="deleteColumns",St="clearContents",xt="paste",At="pasteOptions",It="pasteFormatting",Rt="pasteValues",Mt="pasteFormula",kt="pasteAll",Nt="cut",Ot="copy",Dt="pasteValuesFormatting",Ft="pasteFormulaFormatting",Et="separator",jt="slicerSortAscend",Pt="slicerSortDescend",Lt="table",Gt="tableInsert",Bt="tableDelete",_t="tableInsertRowsAbove",Vt="tableInsertRowsBelow",Ht="tableInsertColumnsLeft",zt="tableInsertColumnsRight",Ut="tableDeleteRows",Wt="tableDeleteColumns",qt="insertCopiedCells",Jt="insertCutCells",Xt="shiftCellsDown",Zt="shiftCellsRight",Yt="row",Kt=void 0,Qt=new n.Common.ResourceManager(s.SR,"ContextMenu"),$t=Qt.getResource.bind(Qt),te={sheetTab:function(t,e,o){return RegExp("sheetTab","i").test(o.workArea)&&t.tabStripHitInfo&&t.tabStripHitInfo.sheetTab&&"newSheet"!==t.tabStripHitInfo.sheetTab.sheetName},outline:function(t,e,o){return!!(RegExp("outline","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.outlineHitInfo)},viewport:function(t,e,o){if(RegExp("viewport","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo)return se(e,o)&&le(e,o)&&fe(e,o)&&de(e,o)&&function(t,e){var o,n;return[p+qt].indexOf(e.name)<0||(o=a.sJc(t),n=o.tu(),n&&!n.G4&&n.n5&&1===n.n5.length&&1===o.getSelections().length&&ge(o))}(e,o)&&function(t,e){var o,n;return[p+Jt].indexOf(e.name)<0||(o=a.sJc(t),n=o.tu(),n&&n.G4&&n.n5&&1===n.n5.length&&1===o.getSelections().length&&ge(o))}(e,o)},rowHeader:function(t,e,o){if(RegExp("rowHeader","i").test(o.workArea)&&t.worksheetHitInfo&&2===t.worksheetHitInfo.hitTestType)return se(e,o)&&le(e,o)&&ue(e,o)&&ce(e,o)&&function(t,e){var o,n,r,i,s,l,u,c;if([p+v+qt,p+v+Jt].indexOf(e.name)<0)return!0;if(o=a.sJc(t),o.xUc)return!1;if(n=o.tu(),r=o.getActiveRowIndex(),o.tables)for(i=o.tables.all(),s=0;s<i.length;s++)if(l=i[s],r>l.cj&&r<l.cj+l.Xj)return!1;for(u=o.ITa.getSpans(),s=0;s<u.length;s++)if(c=u[s],r>c.row&&r<c.row+c.rowCount)return!1;if(!n.UHb||n.n5&&1!==n.n5.length||1!==o.getSelections().length)return!1;if(e.name===p+v+Jt){if(n.G4&&n.n5&&o.getColumnCount()%n.n5[0].colCount==0)return!0}else if(e.name===p+v+qt&&!n.G4&&n.n5&&o.getColumnCount()%n.n5[0].colCount==0)return!0;return!1}(e,o)},colHeader:function(t,e,o){if(RegExp("colHeader","i").test(o.workArea)&&t.worksheetHitInfo&&1===t.worksheetHitInfo.hitTestType)return se(e,o)&&le(e,o)&&ue(e,o)&&ce(e,o)&&function(t,e){var o,n,r,i,s,l,u,c;if([p+C+qt,p+C+Jt].indexOf(e.name)<0)return!0;if(o=a.sJc(t),o.xUc)return!1;if(n=o.tu(),r=o.getActiveColumnIndex(),o.tables)for(i=o.tables.all(),s=0;s<i.length;s++)if(l=i[s],r>l.dj&&r<l.dj+l.OZ)return!1;for(u=o.ITa.getSpans(),s=0;s<u.length;s++)if(c=u[s],r>c.col&&r<c.col+c.colCount)return!1;if(!n.UHb||n.n5&&1!==n.n5.length||1!==o.getSelections().length)return!1;if(e.name===p+C+qt){if(!n.G4&&n.n5&&o.getRowCount()%n.n5[0].rowCount==0)return!0}else if(e.name===p+C+Jt&&n.G4&&n.n5&&o.getRowCount()%n.n5[0].rowCount==0)return!0;return!1}(e,o)},corner:function(t,e,o){if(RegExp("corner","i").test(o.workArea)&&t.worksheetHitInfo&&0===t.worksheetHitInfo.hitTestType)return se(e,o)&&le(e,o)&&fe(e,o)&&de(e,o)},slicer:function(t,e,o){return RegExp("slicer","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"Slicer"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},chart:function(t,e,o){return RegExp("chart","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(t,e,o){return RegExp("shape","i").test(o.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo},table:function(t,e,o){var n=a.sJc(e).tables;return RegExp("table","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo&&n&&n.mKb()},vpWithoutTb:function(t,e,o){if(RegExp("vpWithoutTb","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.pivotTableInfo&&!t.worksheetHitInfo.commentHitInfo){var n=a.sJc(e).tables;return!(n&&n.mKb())&&se(e,o)&&le(e,o)&&fe(e,o)&&de(e,o)}},pivotTablePageFilterArea:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotPageFilter","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&0===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotTopLeft","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&1===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotEmptyLabel","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&3===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotHeader","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&2===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotGrandTotal","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&5===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotContent","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo&&4===t.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(t,e,o){var n=a.sJc(e).pivotTables;return RegExp("pivotTable","i").test(o.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&n&&t.worksheetHitInfo.pivotTableCellInfo}},ee=[],oe=function(){function t(){var t=this;t.menuView=new i.MenuView,t.menuData=t.bYc()}return t.prototype.bYc=function(){return[{text:$t().copy,name:p+Ot,command:h+Ot,iconClass:d+Ot,workArea:y+C+v+b+T+"pivotTable"},{text:$t().cut,name:p+Nt,command:h+Nt,iconClass:d+Nt,workArea:y+C+v+b+T},{text:$t().pasteOptions,name:p+At,iconClass:d+At,type:"groupHeader",workArea:y+C+v+b+T},{command:h+kt,name:p+kt,iconClass:d+kt,group:p+At,text:$t().pasteAll,workArea:y+C+v+b+T},{command:h+Mt,name:p+Mt,iconClass:d+Mt,group:p+At,text:$t().pasteFormula,workArea:y+C+v+T},{command:h+Rt,name:p+Rt,iconClass:d+Rt,group:p+At,text:$t().pasteValues,workArea:y+C+v+T},{command:h+It,name:p+It,iconClass:d+It,group:p+At,text:$t().pasteFormatting,workArea:y+C+v+T},{command:h+Dt,name:p+Dt,iconClass:d+Dt,group:p+At,text:$t().pasteValuesFormatting,workArea:y+C+v+T},{command:h+Ft,name:p+Ft,iconClass:d+Ft,group:p+At,text:$t().pasteFormulaFormatting,workArea:y+C+v+T},{text:$t().paste,name:p+xt,command:h+Rt,iconClass:d+At,workArea:y+C+v+T},{type:Et},{text:$t().pinRows,name:p+ut,command:h+ut,workArea:v},{text:$t().pinColumns,name:p+ct,command:h+ct,workArea:C},{type:Et},{text:$t().clearContents,command:h+St,name:p+St,workArea:y+C+v+T},{type:Et},{text:$t().headerInsertCopiedCells,name:p+v+qt,command:h+v+qt,workArea:v},{text:$t().headerInsertCutCells,name:p+v+Jt,command:h+v+Jt,workArea:v},{text:$t().headerInsertCopiedCells,name:p+C+qt,command:h+C+qt,workArea:C},{text:$t().headerInsertCutCells,name:p+C+Jt,command:h+C+Jt,workArea:C},{text:$t().insertCopiedCells,name:p+qt,subMenu:[{text:$t().shiftCellsRight,name:p+qt+Zt,command:h+qt+Zt,iconClass:d+Zt},{text:$t().shiftCellsDown,name:p+qt+Xt,command:h+qt+Xt,iconClass:d+Xt}],workArea:y},{text:$t().insertCutCells,name:p+Jt,subMenu:[{text:$t().shiftCellsRight,name:p+Jt+Zt,command:h+Jt+Zt,iconClass:d+Zt},{text:$t().shiftCellsDown,name:p+Jt+Xt,command:h+Jt+Xt,iconClass:d+Xt}],workArea:y},{text:$t().insertRows,name:p+vt,command:h+vt,workArea:v},{text:$t().insertColumns,name:p+bt,command:h+bt,workArea:C},{text:$t().deleteRows,name:p+wt,command:h+wt,workArea:v},{text:$t().deleteColumns,name:p+Tt,command:h+Tt,workArea:C},{type:Et},{text:$t().tableInsert,name:p+Gt,subMenu:[{text:$t().tableInsertColumnsLeft,name:p+Ht,command:"tableInsertColumnsLeftForContextMenu",iconClass:d+Ht},{text:$t().tableInsertColumnsRight,name:p+zt,command:"tableInsertColumnsRightForContextMenu",iconClass:d+zt},{text:$t().tableInsertRowsAbove,name:p+_t,command:"tableInsertRowsAboveForContextMenu",iconClass:d+_t},{text:$t().tableInsertRowsBelow,name:p+Vt,command:"tableInsertRowsBelowForContextMenu",iconClass:d+Vt}],workArea:Lt},{text:$t().tableDelete,name:p+Bt,subMenu:[{text:$t().tableDeleteColumns,name:p+Wt,command:"tableDeleteColumnsForContextMenu",iconClass:d+Wt},{text:$t().tableDeleteRows,name:p+Ut,command:"tableDeleteRowsForContextMenu",iconClass:d+Ut}],workArea:Lt},{type:Et},{text:$t().insertSheet,name:p+Ct,command:h+Ct,workArea:w},{text:$t().deleteSheet,name:p+yt,command:h+yt,workArea:w},{type:Et},{text:$t().filter,name:p+gt,command:h+gt,workArea:y+T},{text:$t().sort,name:p+dt,subMenu:[{text:$t().sortAscend,name:p+ht,command:h+ht,iconClass:d+ht},{text:$t().sortDescend,name:p+pt,command:h+pt,iconClass:d+pt}],workArea:y+T},{text:$t().slicerSortAscend,name:p+jt,command:h+jt,iconClass:d+ht,workArea:b},{text:$t().slicerSortDescend,name:p+Pt,command:h+Pt,iconClass:d+pt,workArea:b},{type:Et},{text:$t().insertComment,name:p+mt,command:h+mt,iconClass:d+mt,workArea:y+T},{text:$t().editComment,name:p+nt,command:h+nt,iconClass:d+nt,workArea:y+T},{text:$t().deleteComment,name:p+ot,command:h+ot,iconClass:d+ot,workArea:y+T},{text:$t().toggleComment,name:p+et,command:h+et,workArea:y+T},{type:Et},{text:$t().hideRows,name:p+lt,command:h+lt,workArea:v},{text:$t().unhideRows,name:p+at,command:h+at,workArea:v},{text:$t().hideColumns,name:p+ft,command:h+ft,workArea:C},{text:$t().unhideColumns,name:p+st,command:h+st,workArea:C},{type:Et},{text:$t().hideSheet,name:p+it,command:h+it,workArea:w},{text:$t().unhideSheet,name:p+rt,command:h+rt,workArea:w},{type:Et},{text:$t().removeSlicer,name:p+tt,command:h+tt,workArea:b},{type:Et},{text:$t().sort,name:p+dt,subMenu:[{text:$t().sortAscend,name:p+ht,command:$,iconClass:d+ht,commandOptions:{subType:0},placeholder:k},{text:$t().sortDescend,name:p+pt,command:$,iconClass:d+pt,commandOptions:{subType:1},placeholder:k}],workArea:A},{text:$t().pivotTableRefresh,name:g+P,command:P,iconClass:d+P,workArea:S+x+I+A+R+"pivotEmptyLabel"},{text:$t().pivotTableRemove_,name:g+L,command:L,iconClass:d+L,workArea:S+x+I+A,placeholder:M},{text:$t().pivotTableRemoveGrandTotal,name:g+G,command:G,workArea:R},{text:$t().pivotTableSummarizeValuesBy,name:g+N,subMenu:[{text:$t().pivotTableSum,name:p+"pivotSum",command:_,commandOptions:{subTotalType:8}},{text:$t().pivotTableCount,name:p+"pivotCount",command:_,commandOptions:{subTotalType:1}},{text:$t().pivotTableAverage,name:p+"pivotAverage",command:_,commandOptions:{subTotalType:0}},{text:$t().pivotTableMax,name:p+"pivotMax",command:_,commandOptions:{subTotalType:3}},{text:$t().pivotTableMin,name:p+"pivotMin",command:_,commandOptions:{subTotalType:4}},{text:$t().pivotTableProduct,name:p+"pivotProduct",command:_,commandOptions:{subTotalType:5}}],workArea:x+I+R},{text:$t().pivotTableShowValueAs,name:g+E,subMenu:[{text:$t().pivotTableNoCalculation,name:p+"pivotNoCalculation",command:_,commandOptions:{showValueAsType:0}},{text:$t().pivotTableGrandTotal,name:p+"pivotGrandtotal",command:_,commandOptions:{showValueAsType:1}},{text:$t().pivotTableColumnTotal,name:p+"pivotColumnTotal",command:_,commandOptions:{showValueAsType:3}},{text:$t().pivotTableRowTotal,name:p+"pivotRowTotal",command:_,commandOptions:{showValueAsType:2}},{text:$t().pivotTableOf,name:p+"pivotOf",command:K,commandOptions:{showValueAsType:4}},{text:$t().pivotTableParentRowTotal,name:p+"pivotParentRowTotal",command:_,commandOptions:{showValueAsType:5}},{text:$t().pivotTableParentColumnTotal,name:p+"pivotParentColumnTotal",command:_,commandOptions:{showValueAsType:6}},{text:$t().pivotTableOfParentTotal,name:p+"pivotOfParentTotal",command:K,commandOptions:{showValueAsType:7}},{text:$t().pivotTableDifferenceFrom,name:p+"pivotDifferenceFrom",command:K,commandOptions:{showValueAsType:8}},{text:$t().pivotTablePercentDifferenceFrom,name:p+"pivotPercentDifferenceFro",command:K,commandOptions:{showValueAsType:9}},{text:$t().pivotTableRunningTotalIN,name:p+"pivotRunningTotalIn",command:K,commandOptions:{showValueAsType:10}},{text:$t().pivotTablePercentRunningTotalIn,name:p+"pivotPercentRunningTotalIn",command:K,commandOptions:{showValueAsType:11}},{text:$t().pivotTableRankSmallestToLargest,name:p+"pivotRankSmallestToLargest",command:K,commandOptions:{showValueAsType:12}},{text:$t().pivotTableRankLargestToSmallest,name:p+"pivotRankLargestToSmallest",command:K,commandOptions:{showValueAsType:13}},{text:$t().pivotTableIndex,name:p+"pivotIndex",command:_,commandOptions:{showValueAsType:14}}],workArea:x+I},{text:$t().pivotTableFilter,name:g+V,iconClass:d+V,subMenu:[{text:$t().pivotTableClearFilterFrom_,name:p+H,command:"ClearCommand",iconClass:d+H,placeholder:M,commandOptions:{clearType:0}},{text:$t().pivotTableKeepOnlySelectedItems,name:p+z,command:Q,commandOptions:{subType:1}},{text:$t().pivotTableHideSelectedItems,name:p+U,command:Q,commandOptions:{subType:2}},{text:$t().pivotTableTop10,name:p+"pivotTop10",command:Y,commandOptions:{isTop10:!0}},{text:$t().pivotTableLabelFilters,name:p+W,command:"createDialogForLabelFilter"},{text:$t().pivotTableValueFilters,name:p+"pivotValueFilters",command:Y}],workArea:A},{text:$t().pivotTableExpandOrCollapse,name:g+O,subMenu:[{text:$t().pivotTableExpand,name:p+q,command:q,iconClass:d+q},{text:$t().pivotTableCollapse,name:p+J,command:J,iconClass:d+J},{text:$t().pivotTableExpandEntireField,name:p+X,command:X,iconClass:d+X},{text:$t().pivotTableCollapseEntireField,name:p+Z,command:Z,iconClass:d+Z}],workArea:A},{text:$t().pivotTableGroup,name:g+D,command:"OpenPivotGroupDialog",iconClass:d+D,workArea:A},{text:$t().pivotTableUnGroup,name:g+F,command:F,iconClass:d+F,workArea:A},{text:$t().pivotTableShowDetails,name:g+j,command:j,iconClass:d+j,workArea:I},{text:$t().pivotTableValueFieldSettings,name:g+B,command:B,iconClass:d+B,workArea:x+I+R}]},t.prototype.ad=function(t){var e=this;e.Mma||(e.wu=t.commandManager(),u(e.Ela)&&(e.Ela=new r.ContextMenuViewDialog(t.xv(),l(t.sv))),e.nla(t),e.kTa={filter:{menuDataDict:[p+gt],checkFunction:function(t){if(t.rowFilter)return!0}},comments:{menuDataDict:[p+mt,p+nt,p+ot,p+et],checkFunction:function(t){if(t.comments)return!0}},slicer:{menuDataDict:[p+jt,p+Pt,p+tt],checkFunction:function(t){if(t.slicers)return!0}},floatingObject:{menuDataDict:[p+Rt,p+It,p+Mt],checkFunction:function(t){var e;return!t.BR||(!((e=t.BR().fromSheet)&&e.CR)||void 0)}},table:{menuDataDict:[p+Gt,p+Bt],checkFunction:function(t){if(t.tables)return!0}},tableSheet:{menuDataDict:[p+xt,p+ut,p+ct],checkFunction:function(t){if(t.xUc)return!0}}},e.Mma=!0)},t.prototype.ola=function(t,e){var o,n,r,i,s,l,c,h,p=this;return e.focus(),o=p.pla(t,e),n=a.sJc(e),u(o)||u(n)?void f(t):(r={row:n.getActiveRowIndex(),col:n.getActiveColumnIndex()},void(n.isEditing()&&o.worksheetHitInfo&&o.worksheetHitInfo.col===r.col&&o.worksheetHitInfo.row===r.row||e.getTab()&&e.getTab().FD||(p.ad(e),p.qla(o,e),i=n.getSelections()[0],u(i)||u(n.pivotTables)||(s=n.pivotTables.findPivotTable(i.row,i.col),!u(s)&&o.worksheetHitInfo&&(o.worksheetHitInfo.pivotTableInfo=s,l=s.getPivotInfoImp(i.row,i.col,!1,!1,!0),u(l)||(o.worksheetHitInfo.pivotTableCellInfo=l))),c=p.Fla(p.menuData,o,e),h=p.onOpenMenu(p.menuData,c,o,e),h||(f(t),c.length&&p.jla(c,o,e)))))},t.prototype.qla=function(t,e){this.Ela.Loa(t)&&this.sla(t,e)},t.prototype.sla=function(t,e){var o=this,n=a.sJc(e);n.isEditing()&&n.endEdit(),o.tla(t)?o.ula(t,e):o.vla(t)&&o.wla(t,e)},t.prototype.vla=function(t){return!!t.worksheetHitInfo},t.prototype.xla=function(t,e,o,n){var r,i,a=!0;if(1===n){for(r=0;r<t.length;r++)-1===(i=t[r]).row&&o>=i.col&&o<i.col+i.colCount&&(a=!1);return a}if(2===n){for(r=0;r<t.length;r++)-1===(i=t[r]).col&&e>=i.row&&e<i.row+i.rowCount&&(a=!1);return a}for(r=0;r<t.length;r++)if((i=t[r]).contains(e,o))return!1;return!0},t.prototype.tla=function(t){return!(!t.tabStripHitInfo||!t.tabStripHitInfo.sheetTab)},t.prototype.yla=function(t){return t.tabStripHitInfo.sheetTab.sheetName},t.prototype.nMc=function(t){return t.tabStripHitInfo.sheetTab.sheetIndex},t.prototype.wla=function(t,e){var o=a.sJc(e),n=t.worksheetHitInfo;n.floatingObjectHitInfo||n.commentHitInfo||n.shapeHitInfo||(this.Ala(o,n),this.aPa(o))},t.prototype.aPa=function(t){var e,o=t.getActiveRowIndex(),n=t.getActiveColumnIndex(),r=t.comments;r&&((e=r.get(o,n))&&r.bU===e&&r.hT(e))},t.prototype.zla=function(t){return 3===t.hitTestType},t.prototype.cs=function(t,e,o){t.cs&&t.cs(e,o)},t.prototype.Ala=function(t,e){var o,n,r=t.ITa.getSelections(),i=e.row,a=e.col;t.Qs(e.rowViewportIndex<0?-1:e.row,e.colViewportIndex<0?-1:e.col)&&(o=!1,this.xla(r,i,a,e.hitTestType)?o=!0:(n=(t.shapes&&t.shapes.all()||[]).filter((function(t){return t.isSelected()})),n.length>0&&(n.forEach((function(t){return t.isSelected(!1)})),o=!0)),o&&(t.mm.Ala(t,e,i,a),t.mm.hH()))},t.prototype.ula=function(t,e){var o=this.nMc(t),n=e.XJc(o);n&&(n.DHb()||(e.yJc().forEach((function(t){t.DHb()&&t.DHb(!1,!0)})),n.DHb(!0,!0)),e.ZJc(o,2,!1,!0),this.$Oa(this.menuData,t,e))},t.prototype.pla=function(t,e){var o=e.oia(),n=t.pageX-o.left,r=t.pageY-o.top;return e.hitTest(n,r,!0)},t.prototype.onOpenMenu=function(t,e,o,n){},t.prototype.jla=function(t,e,o){var n=this;n.Ela.Loa(e)&&(n.Cla(),o.xw(),n.Dla(t,e,o))},t.prototype.Cla=function(){this.Ela.close()},t.prototype.Dla=function(t,e,o){this.Ela.OT(this.menuView,t,e.x,e.y,o)},t.prototype.Fla=function(t,e,o){var n,r=this,i={};return l.extend(!0,i,t),n=r.oMc(i,e,o),r.J$a(n,e),r.lTa(n,o),r.oKb(n,o),r.UZa(n,o),r.RZa(n),n=r.Bma(n),r.pKb(n),n},t.prototype.oMc=function(t,e,o){var n=this,r=[];return l.each(t,(function(t,i){u(i)||(i.type===Et&&r.push(i),l.each(te,(function(t,a){a(e,o,i)&&(n.pMc(i,e)&&r.push(i))})))})),r},t.prototype.qMc=function(t,e,o){var n,r,i,a,s,l=o.placeholder,c=o.name,f=e.area,h=e.value,d=e.menuArea,g=e.colHeadFieldInfo,m=e.rowInfos,y=e.colInfos,C=e.cornerFieldInfo,v=e.activeRowFieldInfo,b=e.activeColFieldInfo;if(u(l))c===p+W&&(a=v&&v.name||b&&b.name||g&&g.fieldName||C&&C.fieldName,s=t.vic,a&&s.getFieldInfoByName(a)&&2===s.getFieldInfoByName(a).ny&&(o.text=$t().pivotTableLabelFilters_Date));else if(l===M){if(n=void 0,0===d)n=e.pageFieldInfo.fieldName;else if(2===f&&2===d){if(g)n=g.fieldName;else if(n=b&&b.name,u(n)){for(r=b.index;r>=0&&y[r]&&u(y[r].itemName);)r-=1;n=y[r].fieldName}}else if(3===f&&2===d){if(n=v&&v.name,u(n)){for(r=v.index;r>=0&&m[r]&&u(m[r].itemName);)r-=1;n=m[r].fieldName}}else 1===f?1===d?n=e.value:2===d&&C&&(n=C.fieldName):4===d&&(n=e.valueFieldName,2===f?n=b&&b.name||h:3===f&&(n=v&&v.name||h));o.text=o.text.replace("{0}",'"'+n+'"')}else l===k&&4===d&&(n=void 0,0===(i=o.commandOptions.subType)?n=$t().pivotTableSortAscend:1===i&&(n=$t().pivotTableSortDescend),o.text=n);u(o.commandOptions)&&(o.commandOptions={}),o.commandOptions.pivotTableName=t.name(),o.commandOptions.pivotTableCellInfo=e},t.prototype.pKb=function(t){var e,o,n=0,r=!1;for(e=0;e<t.length&&((o=t[e].name)!==p+v+qt&&o!==p+v+Jt&&o!==p+C+qt&&o!==p+C+Jt||(r=!0),o!==p+vt&&o!==p+bt||(n=e,!r));e++);r&&t.splice(n,1)},t.prototype.J$a=function(t,e){var o=e.worksheetHitInfo;o&&(o.row===Kt||o.col===Kt)&&t.splice(0,t.length)},t.prototype.lTa=function(t,e){var o=this,n=a.sJc(e),r=o.kTa;return l.each(r,(function(e,r){var i,a,s;if(!r.checkFunction(n))for(a=0,s=(i=r.menuDataDict).length;a<s;a++)o.hma(t,i[a],(function(t,e){t[e]=null}))})),t},t.prototype.pMc=function(t,e){var o,n,r,i,a,s,l,c,f,h,p,d,m=this,y=e.worksheetHitInfo&&e.worksheetHitInfo.pivotTableInfo;if(y&&(o=e.worksheetHitInfo&&e.worksheetHitInfo.pivotTableCellInfo)){if(n=y.options.subtotalsPosition,r=o.value,i=o.area,a=o.menuArea,s=o.cornerFieldInfo,l=o.colHeadFieldInfo,c=o.activeRowFieldInfo,f=o.activeColFieldInfo,h=o.rowInfos,p=o.colInfos,d=o.valueFieldName,[g+O,g+V,g+j].indexOf(t.name)>-1&&((2===i||3===i)&&4===a||(!u(s)||!u(l))&&r===$t().sigmaValueTemp||3===i&&c&&h[c.index].isSubtotal&&void 0===h[c.index].collapseIndex&&1!==n||2===i&&f&&p[f.index].isSubtotal&&void 0===p[f.index].collapseIndex&&1!==n))return!1;if([g+D,g+F].indexOf(t.name)>-1&&(!u(s)||!u(l)))return!1;if([g+B,g+L,g+N,g+E].indexOf(t.name)>-1&&u(d)&&4===a&&4===i)return!1;t&&t.subMenu?t.subMenu.forEach((function(t){m.qMc(y,o,t),m.rMc(y,o,t)})):m.qMc(y,o,t)}return!0},t.prototype.rMc=function(t,e,o){var n,r,i,a,s,l=e.activeRowFieldInfo,c=e.activeColFieldInfo,f=e.cornerFieldInfo,h=e.colHeadFieldInfo,d=e.valueFieldName,g=l&&l.name||c&&c.name||h&&h.fieldName||f&&f.fieldName||d,y=t.vic,C=g&&y.getFieldInfoByName(g);switch(o.commandOptions&&C&&(n=o.commandOptions.showValueAsType,r=o.commandOptions.subTotalType,u(n)||(C.pNc&&C.pNc.showDataAs||0)===n&&(o.iconClass=m),u(r)||C.getSubTotalType()===r&&(o.iconClass=m)),o.name){case p+H:a=!1,(i=C&&C.Dhc)&&i.labelFilter&&i.Bhc()&&(a=!0),s=!!i&&i.Chc(),a||s||(o.disable=!0);break;case p+z:case p+U:u(f)&&u(h)||(o.disable=!0)}},t.prototype.oKb=function(t,e){var o,n,r,i=a.sJc(e),s=i.getSelections();s&&s.length>0&&(o=me(i,s[0]),n=i.getActiveRowIndex(),r=i.getActiveColumnIndex(),o&&l.each(t,(function(t,e){if(!u(e)&&e.name===p+Gt){var i=e.subMenu;o.checkTableLastRow(n)&&i.splice(3,1),o.checkTableLastCol(r)&&i.splice(1,1)}})))},t.prototype.RZa=function(t){var e;for(e=t.length-1;e>=0;e--)t[e]?t[e].subMenu&&this.RZa(t[e].subMenu):t.splice(e,1);return t},t.prototype.Bma=function(t){var e,o,n,r,i,a=[],s=t.length;for(e=0;e<s;e++)t[e]&&t[e].type===Et&&t[e+1]&&t[e+1].type===Et||a.push(t[e]);for(s=a.length,o=0,n=0,r=!0,i=!0,e=0;e<s&&(r&&a[e].type===Et?o++:r=!1,i&&a[s-1-e].type===Et?n++:i=!1,r||i);e++);return a.splice(s-n,n),a.splice(0,o),a},t.prototype.UZa=function(t,e){this.VZa(t,e),this.QZa(t,e)},t.prototype.VZa=function(t,e){var o,n=a.sJc(e),r=n.tables;for(o=0;o<t.length;o++)if(t[o]){switch(t[o].name){case p+vt:n.ZZa()||(t[o].disable=!0);break;case p+wt:(!n.ZZa()||r&&r.containTableHeaderTotalRowForSheet())&&(t[o].disable=!0);break;case p+bt:case p+Tt:n.$Za()||(t[o].disable=!0);break;case p+_t:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(t[o].disable=!0);break;case p+Vt:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(t[o].disable=!0);break;case p+Ut:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(t[o].disable=!0);break;case p+Ht:case p+zt:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(t[o].disable=!0);break;case p+Wt:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(t[o].disable=!0)}t[o]&&t[o].subMenu&&this.VZa(t[o].subMenu,e)}},t.prototype.QZa=function(t,e){var o,n,r,i,s=a.sJc(e),l=s.options.isProtected,u=s.options.protectionOptions;if(l&&u)for(o=void 0,n=0;n<t.length;n++)if(t[n]){switch(t[n].name){case p+vt:u.allowInsertRows||(t[n].disable=!0);break;case p+bt:u.allowInsertColumns||(t[n].disable=!0);break;case p+wt:u.allowDeleteRows||(t[n].disable=!0);break;case p+Tt:u.allowDeleteColumns||(t[n].disable=!0);break;case p+gt:u.allowFilter||(t[n].disable=!0);break;case p+ht:case p+pt:u.allowSort||(t[n].disable=!0);break;case p+lt:case p+at:case p+ft:case p+st:s.xUc||(t[n].disable=!0);break;case p+jt:case p+Pt:u.allowEditObjects||t.splice(0,t.length);break;case p+mt:u.allowEditObjects||(t[n]=null);break;case p+nt:r=void 0,s.comments&&(r=(o=s.comments.get(s.getActiveRowIndex(),s.getActiveColumnIndex()))&&o.lockText()),!u.allowEditObjects&&r&&(t[n]=null);break;case p+ot:i=void 0,s.comments&&(i=!he(s.getSelections(),s)),!u.allowEditObjects&&i&&(t[n]=null);break;case p+_t:case p+Vt:case p+Ht:case p+zt:case p+Ut:case p+Wt:t[n].disable=!0}t[n]&&t[n].subMenu&&this.QZa(t[n].subMenu,e)}},t.prototype.$Oa=function(t,e,o){var n,r,i;if(e.tabStripHitInfo&&(this,n=o.yJc(),r=this.RS(p+rt))){for(i=0;i<n.length;i++)if(!n[i].visible())return void(r.disable=!1);r.disable=!0}},t.prototype.RS=function(t){return this.gma(this.menuData,t)},t.prototype.gma=function(t,e){var o;return this.hma(t,e,(function(t,e){o=t[e]})),o},t.prototype.hma=function(t,e,o){for(var n=t.length,r=0;r<n;r++)if(!u(t[r])){if(e===t[r].name)return void o(t,r);t[r].subMenu&&this.hma(t[r].subMenu,e,o)}},t.prototype.cYc=function(t,e){for(var o,n=t.length,r=0;r<n;r++)o=t[r],u(o)||(e(o),o.subMenu&&this.cYc(o.subMenu,e))},t.prototype.nla=function(t){var e,o,n,r,i,s,l,f,p,d,g,m,y,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V=t.commandManager(),H={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&(ne(o)?V.execute({cmd:"copyFloatingObjects",sheetName:o.name()}):V.execute({cmd:Ot,sheetName:o.name(),ignoreClipboard:!0}))}};function z(t,e,o){var n,r;for(n=0;n<o;n++)r=e+n,-1===t.indexOf(r)&&t.push(r);return t}V.register(h+Ot,H,null,!1,!1,!1,!1),e={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&(ne(o)?V.execute({cmd:"cutFloatingObjects",sheetName:o.name()}):V.execute({cmd:Nt,sheetName:o.name(),ignoreClipboard:!0}))}},V.register(h+Nt,e,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&(o.isPasteFloatingObject&&o.isPasteFloatingObject()?V.execute({cmd:"pasteFloatingObjects",sheetName:o.name()}):o.isPasteShapes&&o.isPasteShapes()?V.execute({cmd:"pasteShapes",sheetName:o.name()}):V.execute({cmd:xt,sheetName:o.name(),pasteOption:0}))}},V.register(h+kt,o,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&V.execute({cmd:xt,sheetName:o.name(),pasteOption:0,shiftCells:a.InsertShiftCell.right})}},V.register(h+qt+Zt,n,null,!1,!1,!1,!1),V.register(h+Jt+Zt,n,null,!1,!1,!1,!1),V.register(h+C+qt,n,null,!1,!1,!1,!1),V.register(h+C+Jt,n,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&V.execute({cmd:xt,sheetName:o.name(),pasteOption:0,shiftCells:a.InsertShiftCell.down})}},V.register(h+qt+Xt,r,null,!1,!1,!1,!1),V.register(h+Jt+Xt,r,null,!1,!1,!1,!1),V.register(h+v+qt,r,null,!1,!1,!1,!1),V.register(h+v+Jt,r,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(t,e){Ae(t,e,V,3)}},V.register(h+Mt,i,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(t,e){Ae(t,e,V,1)}},V.register(h+Rt,s,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&V.execute({cmd:xt,sheetName:o.name(),pasteOption:2})}},V.register(h+It,l,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(t,e){Ae(t,e,V,4)}},V.register(h+Dt,f,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(t,e){Ae(t,e,V,5)}},V.register(h+Ft,p,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(t,e){var o=a.uJc(t,e.sheetName);o&&V.execute({cmd:"clear",sheetName:o.name()})}},V.register(h+St,d,null,!1,!1,!1,!1),g={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g=o.commentState||2,m=o.displayMode,y=o.activeRow,C=o.activeCol,v=e.comments.add(y,C,"");v&&(v.commentState(g),m&&v.displayMode(m),n=e.Er(y),r=e.Fr(C),i=e.getCellRect(y,C,n,r),a=e.am().Ft(n,r),s=v.location(),l=v.width(),u=v.height(),c=void 0,f=void 0,h=void 0,p=void 0,d=t.ku,i.y+s.y<a.y?(h=xe(e,y,i.y+s.y-a.y),c=d.ms(e,h),d.ju(e,c.cj,0),e.os()):i.y+s.y+u>a.y+a.height&&(h=xe(e,y,i.y+s.y+u-(a.y+a.height)),c=d.ms(e,h),d.ju(e,c.cj,0),e.os()),i.x+s.x+l>a.x+a.width&&(p=function(t,e,o){var n;if(o>0){for(n=e+1;n<t.getColumnCount();n++)if((o-=t.getColumnWidth(n))<=0)return n-e}else if(o<0)for(n=e-1;n>=0;n--)if((o+=t.getColumnWidth(n))>=0)return n-e;return 0}(e,C,i.x+s.x+l-(a.x+a.width)),f=d.Sw(e,p),d.lu(e,f.dj,0),e.qs()))}),(function(t,e){var o=e.activeRow,n=e.activeCol,r=t.comments.get(o,n);r&&(e.displayMode=r.displayMode(),e.commentState=r.commentState())}))}},V.register(h+mt,g,null,!1,!1,!1,!1),m={canUndo:!1,execute:function(t,e){var o,n,r,i=a.uJc(t,e.sheetName);i&&(o=e.activeRow,n=e.activeCol,(r=i.comments.get(o,n))&&r.commentState(2))}},V.register(h+nt,m,null,!1,!1,!1,!1),y={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(t){var o,n,r,i,a,s=e.selections,l=s.length;if(!(l<=0))for(o=0;o<l;o++)for(r=(n=s[o]).row;r<n.row+n.rowCount;r++)for(i=n.col;i<n.col+n.colCount;i++)!(a=t.comments.get(r,i))||t.options.isProtected&&!t.options.protectionOptions.allowEditObjects&&a.locked()||V.execute({cmd:ot,sheetName:t.name(),row:a.nT,col:a.oT})}))}},V.register(h+ot,y,null,!1,!1,!1,!1),b={canUndo:!1,execute:function(t,e){var o,n,r,i=a.uJc(t,e.sheetName);i&&(o=e.activeRow,n=e.activeCol,(r=i.comments.get(o,n))&&(2===r.displayMode()?r.displayMode(1):r.displayMode(2)))}},V.register(h+et,b,null,!1,!1,!1,!1),w={canUndo:!0,execute:function(t,e,o){return e.considerAllSheets=!0,Se(t,e,o,(function(t){var o,n,r,i,a,s,l,u,c,f,h,p=Ce(e.selections);for(n=0;n<p.length;n++){for(o=p[n],r=t.getRange(o.row-1,0,1,o.colCount),i=[],a=0;a<r.colCount;a++)t.getCell(r.row,a).locked()||i.push(a);for(s=o.row,l=o.rowCount,t.addRows(s,l),u=0;u<i.length;u++)for(c=p[n].row;c<p[n].row+p[n].rowCount;c++)t.getCell(c,i[u]).locked(!1);if(t.tables&&l>0)for(f=t.tables.s$(s,-1,l,-1),h=0;h<f.length;h++)f[h].PIb(s,l,!1,!1);be(t,s,-1,l)}}))}},V.register(h+vt,w,null,!1,!1,!1,!1),T={canUndo:!0,execute:function(t,e,o){return e.considerAllSheets=!0,Se(t,e,o,(function(t){var o,n,r,i,a,s,l,u,c,f,h,p=ve(e.selections);for(n=0;n<p.length;n++){for(o=p[n],r=t.getRange(0,o.col-1,o.rowCount,1),i=[],a=0;a<r.rowCount;a++)t.getCell(a,r.col).locked()||i.push(a);for(s=o.col,l=o.colCount,t.addColumns(s,l),u=0;u<i.length;u++)for(c=s;c<s+l;c++)t.getCell(i[u],c).locked(!1);if(t.tables&&l>0)for(f=t.tables.s$(-1,s,-1,l),h=0;h<f.length;h++)f[h].QIb(s,l,!1,!1);be(t,-1,s,l)}}))}},V.register(h+bt,T,null,!1,!1,!1,!1),S={canUndo:!0,execute:function(t,e,o){return e.considerAllSheets=!0,Se(t,e,o,(function(t){var o,n,r,i,a,s,l,u,c=Ce(e.selections),f=t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.rowsVisibleInfo,h=f&&Object.keys(f).length>0;for(o=0;o<c.length;o++)if(r=(n=c[o]).row,i=n.rowCount,a=t.getRowCount(),h)for(l=(s=ie(n,f)).length-1;l>=0;l--)r=s[l][0],i=s[l][1],u=t.tables&&t.tables.s$(r,-1,i,-1),t.deleteRows(r,i),u.length>0&&a-t.getRowCount()>0&&(a=t.getRowCount(),ye(0,u,r,i));else u=t.tables&&t.tables.s$(r,-1,i,-1),t.deleteRows(r,i),u.length>0&&a-t.getRowCount()>0&&ye(0,u,r,i)}))}},V.register(h+wt,S,null,!1,!1,!1,!1),x={canUndo:!0,execute:function(t,e,o){return e.considerAllSheets=!0,Se(t,e,o,(function(t){var o,n,r,i,a,s,l=ve(e.selections);for(o=0;o<l.length;o++)if(n=t.getColumnCount(),r=l[o].col,i=l[o].colCount,a=void 0,t.tables&&(a=t.tables.s$(-1,r,-1,i)),t.deleteColumns(r,i),t.tables&&n-t.getColumnCount()>0)for(s=0;s<a.length;s++)a[s].QIb(r,i,!0)}))}},V.register(h+Tt,x,null,!1,!1,!1,!1),A={canUndo:!1,execute:function(t){var e,o,n=t.getActiveSheetIndex(),r=[],i=a.sJc(t),s=t.vv(t.wv(n));t.yJc().forEach((function(t){t.DHb()&&r.push(t)})),r.forEach((function(t){t.DHb(!1,!0)})),e={sheetName:s.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:n},t.Wq(a.Events.SheetChanging,e),e.cancel||(o={oldSheet:i,newSheet:s},t.Wq(a.Events.ActiveSheetChanging,o),t.ow(Math.max(0,n),2,s),s.DHb(!0,!0),t.Wq(a.Events.SheetChanged,{sheetName:s.name(),propertyName:"insertSheet",sheetIndex:n}),t.Wq(a.Events.ActiveSheetChanged,{oldSheet:i,newSheet:s}))}},V.register(h+Ct,A,null,!1,!1,!1,!1),I={canUndo:!1,execute:function(t){var e,o,n,r,i=a.sJc(t),s=t.yJc();s.length>1?(e=[],o=[],s.forEach((function(t,n){if(t.DHb()){var r=t.name();e.push(r),o.push(n)}})),e.length!==s.length?e.length>=1&&(n={oldSheet:i,cancel:!1},e.forEach((function(e,r){var s,l,c=o[r],f=a.uJc(t,e),h={sheetName:e,propertyName:"deleteSheet",cancel:!1,sheetIndex:c};f===i&&t.Wq(a.Events.ActiveSheetChanging,n),t.Wq(a.Events.SheetChanging,h),n.cancel||h.cancel||(s=t.getSheetIndex(e),!u(s)&&s>=0?(t.removeSheet(s),-1===t.getActiveSheetIndex()&&t.setActiveSheetTab(0)):(s=t.getSheetTabIndex(e),!u(s)&&s>=0&&(t.removeSheetTab(s),-1===t.getActiveSheetTabIndex()&&t.setActiveSheetIndex(0))),t.Wq(a.Events.SheetChanged,{sheetName:e,propertyName:"deleteSheet",sheetIndex:c}),l=a.sJc(t),f===i&&t.Wq(a.Events.ActiveSheetChanged,{oldSheet:f,newSheet:l}))})),(r=a.sJc(t)).isSelected()||r.DHb(!0,!0)):Re(i)):Re(i),t.undoManager().clear()}},V.register(h+yt,I,null,!1,!1,!1,!1),R={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(t){var o,n=e.selections[0],r=me(t,n),i=e.activeRow,a=e.activeCol;r?r.range().contains(i,a,1,1)&&(o=r.name(),V.execute({cmd:"contextmenuFilterForTable",sheetName:t.name(),cmdOption:{tableName:o,activeRow:i,activeCol:a,expectedText:t.getText(i,a)}})):t.rowFilter&&V.execute({cmd:"contextmenuFilterForSheet",sheetName:t.name(),cmdOption:{activeRow:i,activeCol:a,selection:n,expectedText:t.getText(i,a)}})}))}},V.register(h+gt,R,null,!1,!1,!1,!1),M={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(t){var o=e.activeCol,n=e.selections,r=me(t,n[0]),i=r?r.dataRange():n[0],s=t.oec(i,!0,null),l={sheet:t,sheetName:t.name(),col:o,ascending:!0,range:i,compareFunction:Kt,groupSort:s.groupSort,ignoreHidden:s.ignoreHidden,cancel:!1};t.Wq(a.Events.RangeSorting,l),!1===l.cancel&&(t.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:o,ascending:!0,compareFunction:l.compareFunction}],{groupSort:l.groupSort,ignoreHidden:l.ignoreHidden},Kt,!!r),t.Wq(a.Events.RangeSorted,l))}))}},V.register(h+ht,M,null,!1,!1,!1,!1),k={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(t){var o=e.activeCol,n=e.selections,r=me(t,n[0]),i=r?r.dataRange():n[0],s=t.oec(i,!0,null),l={sheet:t,sheetName:t.name(),col:o,ascending:!1,range:i,compareFunction:Kt,groupSort:s.groupSort,ignoreHidden:s.ignoreHidden,cancel:!1};t.Wq(a.Events.RangeSorting,l),!1===l.cancel&&(t.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:o,ascending:!1,compareFunction:l.compareFunction}],{groupSort:l.groupSort,ignoreHidden:l.ignoreHidden},Kt,!!r),t.Wq(a.Events.RangeSorted,l))}))}},V.register(h+pt,k,null,!1,!1,!1,!1),N={canUndo:!0,execute:function(t,e,o){return Ie(t,e,o,1)}},V.register(h+jt,N,null,!1,!1,!1,!1),O={canUndo:!0,execute:function(t,e,o){return Ie(t,e,o,2)}},V.register(h+Pt,O,null,!1,!1,!1,!1),D={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(t){var o,n,r,i,a=e.selections;if(a.length>0){for(o=[],n=0,r=a;n<r.length;n++)z(o,(i=r[n]).row,i.rowCount);try{t.xUc.togglePinnedRows(o)}catch(t){return!1}}}))}},V.register(h+ut,D,null,!1,!1,!1,!1),F={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(t){var o,n,r,i,a=e.selections;if(a.length>0){for(o=[],n=0,r=a;n<r.length;n++)z(o,(i=r[n]).col,i.colCount);try{t.xUc.togglePinnedColumns(o)}catch(t){return!1}}}))}},V.register(h+ct,F,null,!1,!1,!1,!1),E={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(o){t.suspendCalcService(),re(e.selections,Yt,(function(t){o.setRowVisible(t,!1)})),t.resumeCalcService()}))}},V.register(h+lt,E,null,!1,!1,!1,!1),j={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(o){t.suspendCalcService(),re(e.selections,"col",(function(t){o.setColumnVisible(t,!1)})),t.resumeCalcService()}))}},V.register(h+ft,j,null,!1,!1,!1,!1),P={canUndo:!1,execute:function(t){var e,o,n,r,i,s,l,u,c,f,h,p,d,g,m=0,y=t.yJc();if(y.forEach((function(t){t.visible()&&(m+=1)})),e=a.sJc(t),m<=1)Re(e);else{if(n=[],y.forEach((function(t){t.DHb()&&n.push(t)})),m!==n.length){for(r=0;r<n.length;r++)u={sheetName:s=(i=n[r]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:l=t.getSheetIndex(s),oldValue:!0,newValue:!1},t.Wq(a.Events.SheetChanging,u),c={cancel:!1,oldSheet:i},s===e.name()&&t.Wq(a.Events.ActiveSheetChanging,c),u.cancel||c.cancel||(i.DHb(!1,!0),ee.push(i),i.visible(!1),f=a.sJc(t),r!==n.length-1||f.isSelected()||(o={oldValue:!1,newValue:!0,sheetName:h=f.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t.getSheetIndex(h)},t.Wq(a.Events.SheetChanging,o)),t.Wq(a.Events.SheetChanged,{sheetName:s,propertyName:"isVisible",sheetIndex:l,oldValue:!0,newValue:!1}));d=(p=a.sJc(t)).name(),o&&(o.cancel?p.ITa.CHb(!1):(p.ITa.CHb(!0),t&&t.YJc&&t.YJc.repaint(),g={oldValue:!1,newValue:!0,sheetName:d,propertyName:"isSelected",sheetIndex:t.getSheetIndex(d)},t.Wq(a.Events.SheetChanged,g))),e!==p&&t.Wq(a.Events.ActiveSheetChanged,{oldSheet:e,newSheet:p})}else Re(e);t.undoManager().clear()}}},V.register(h+it,P,null,!1,!1,!1,!1),L={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(o){var n=e.selections,r=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;u(r)&&(r=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=ae(o,n[0])),1===n.length&&r?(o.setRowVisible(n[0].row-1,!0),o.mq(n[0].row-1)):(t.suspendCalcService(),re(n,Yt,(function(t){o.setRowVisible(t,!0),t===o._t()&&(o.lq=0,o.os())})),t.resumeCalcService())}))}},V.register(h+at,L,null,!1,!1,!1,!1),G={canUndo:!0,execute:function(t,e,o){return Se(t,e,o,(function(o){var n=e.selections,r=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;u(r)&&(r=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=ae(o,n[0])),1===n.length&&r?(o.setColumnVisible(n[0].col-1,!0),o.rq(n[0].col-1)):(t.suspendCalcService(),re(n,"col",(function(t){o.setColumnVisible(t,!0),t===o.$t()&&(o.qq=0,o.qs())})),t.resumeCalcService())}))}},V.register(h+st,G,null,!1,!1,!1,!1),B={canUndo:!1,execute:function(t){var e,o,n,r,i,s,l=t.yJc();if(0===ee.length)for(e=0;e<l.length;e++)l[e].visible()||(ee.push(l[e]),l[e].DHb(!1));if(o=a.sJc(t),ee.length>0){if(l.forEach((function(t){t!==o&&t.DHb(!1,!0)})),i={sheetName:r=(n=ee.pop()).name(),propertyName:"isVisible",cancel:!1,sheetIndex:t.getSheetIndex(r),oldValue:!1,newValue:!0},t.Wq(a.Events.SheetChanging,i),i.cancel)return;if(n.visible(!0),t.Wq(a.Events.SheetChanged,{sheetName:r,propertyName:"isVisible",sheetIndex:t.getSheetIndex(r),oldValue:!1,newValue:!0}),s={oldSheet:o,newSheet:n,cancel:!1},t.Wq(a.Events.ActiveSheetChanging,s),s.cancel)return;t.setActiveSheet(n.name())}a.sJc(t)!==o&&(t.focus(!0),t.Wq(a.Events.ActiveSheetChanged,{oldSheet:o,newSheet:a.sJc(t)}))}},V.register(h+rt,B,null,!1,!1,!1,!1),_={canUndo:!1,execute:function(t,e){var o,n,r,i=a.uJc(t,e.sheetName);if(i&&(t.suspendPaint(),o=[],(n=i.slicers.all())&&!c(n))){for(r in n)n[r].isSelected()&&o.push(n[r].name());o.length>0&&V.execute({cmd:"deleteFloatingObjects",sheetName:i.name(),floatingObjects:o}),t.resumePaint()}}},V.register(h+tt,_,null,!1,!1,!1,!1)},t}(),e.ContextMenu=oe,a.Workbook.$n("contextmenu",{setHost:function(){var t=this,e=t.qo;t.contextMenu||(t.contextMenu=new oe),l(e).bind("contextmenu.gcSheet",(function(e){if(t.options.allowContextMenu)return t.contextMenu.ola(e,t)}))},dispose:function(){l(this.qo).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var t,e,o,n=this.contextMenu;n&&(t=n.menuData,e=n.bYc(),o={},n.cYc(e,(function(t){u(t.name)||(o[t.name]=t.text)})),n.cYc(t,(function(t){u(t.name)||u(o[t.name])||(t.text=o[t.name])})))}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/contextMenu/context-menu.res.en.js");e.SR={en:n}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.copy="Copy",e.cut="Cut",e.pasteOptions="Paste Options:",e.pasteAll="All",e.pasteFormula="Formulas",e.pasteValues="Values",e.pasteFormatting="Formatting",e.pasteValuesFormatting="Values&Formatting",e.pasteFormulaFormatting="Formula&Formatting",e.clearContents="Clear Contents",e.insertRows="Insert",e.insertColumns="Insert",e.deleteRows="Delete",e.deleteColumns="Delete",e.insertSheet="Insert",e.deleteSheet="Delete",e.insertComment="Insert Comment",e.filter="Filter",e.sort="Sort",e.insertCopiedCells="Insert Copied Cells...",e.insertCutCells="Insert Cut Cells...",e.shiftCellsRight="Shift Cells Right",e.shiftCellsDown="Shift Cells Down",e.headerInsertCopiedCells="Insert Copied Cells",e.headerInsertCutCells="Insert Cut Cells",e.slicerSortAscend="Sort A to Z",e.slicerSortDescend="Sort Z to A",e.sortAscend="Sort A to Z",e.sortDescend="Sort Z to A",e.hideRows="Hide",e.hideColumns="Hide",e.hideSheet="Hide",e.unhideSheet="Unhide",e.unhideColumns="Unhide",e.unhideRows="Unhide",e.editComment="Edit Comment",e.deleteComment="Delete Comment",e.toggleComment="Show/Hide Comment",e.removeSlicer="Remove",e.removeFloatingObject="Remove",e.tableInsert="Insert",e.tableInsertRowsAbove="Table Rows Above",e.tableInsertRowsBelow="Table Row Below",e.tableInsertColumnsLeft="Table Columns to the Left",e.tableInsertColumnsRight="Table Columns to the Right",e.tableDelete="Delete",e.tableDeleteRows="Table Rows",e.tableDeleteColumns="Table Columns",e.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",e.pivotTableRefresh="Refresh",e.pivotTableMove="Move",e.pivotTableRemove_="Remove {0}",e.pivotTableRemoveGrandTotal="Remove GrandTotal",e.pivotTableValueFieldSettings="Value Field Settings...",e.pivotTableOptions="PivotTable Options...",e.pivotTableNumberFormat="Number Format...",e.pivotTableSort="Sort",e.pivotTableSummarizeValuesBy="Summarize Values By",e.pivotTableSum="Sum",e.pivotTableCount="Count",e.pivotTableAverage="Average",e.pivotTableMax="Max",e.pivotTableMin="Min",e.pivotTableProduct="Product",e.pivotTableDistinctCount="Distinct Count",e.pivotTableMoreOptions="More Options",e.pivotTableShowValueAs="Show Value As",e.pivotTableNoCalculation="No Calculation",e.pivotTableGrandTotal="% of Grand Total",e.pivotTableColumnTotal="% of Column Total",e.pivotTableRowTotal="% of Row Total",e.pivotTableOf="% Of...",e.pivotTableParentRowTotal="% of Parent Row Total",e.pivotTableParentColumnTotal="% of Parent Column Total",e.pivotTableOfParentTotal="% of Parent Total...",e.pivotTableDifferenceFrom="Difference From...",e.pivotTablePercentDifferenceFrom="% Difference From...",e.pivotTableRunningTotalIN="Running Total In...",e.pivotTablePercentRunningTotalIn="% Running Total In...",e.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",e.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",e.pivotTableIndex="Index",e.pivotTableShowDetails="Show Details",e.pivotTableGroup="Group...",e.pivotTableUnGroup="Ungroup...",e.pivotTableExpandOrCollapse="Expand/Collapse",e.pivotTableFilter="Filter",e.pivotTableSubtotal_="Subtotal {0}",e.pivotTableHideFieldList="Hide Field List",e.pivotTableFieldSettings="Field Settings...",e.pivotTableClearFilterFrom_="Clear Filter From {0}",e.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",e.pivotTableHideSelectedItems="Hide Selected Items",e.pivotTableTop10="Top 10...",e.pivotTableLabelFilters="Label Filters...",e.pivotTableLabelFilters_Date="Date Filters...",e.pivotTableValueFilters="Value Filters...",e.pivotTableExpand="Expand",e.pivotTableCollapse="Collapse",e.pivotTableExpandEntireField="Expand Entire Field",e.pivotTableCollapseEntireField="Collapse Entire Field",e.pivotTableCollapseTo_="Collapse to {0}",e.pivotTableExpandTo_="Expand to {0}",e.pivotTableMove_ToBeginning="Move {0} to Beginning",e.pivotTableMove_Up="Move {0} Up",e.pivotTableMove_Down="Move {0} Down",e.pivotTableMove_ToEnd="Move {0} to end",e.pivotTableMove_ToLeft="Move {0} to left",e.pivotTableMove_ToRight="Move {0} to Right",e.pivotTableMove_ToColumns="Move {0} to columns",e.sigmaValue="∑ Values",e.sigmaValueTemp="Values",e.pivotTableSortAscend="Sort Smallest to Largest",e.pivotTableSortDescend="Sort Largest to Smallest",e.pinRows="Pin/Unpin Rows",e.pinColumns="Pin/Unpin Columns",e.paste="Paste"},"./dist/plugins/contextMenu/menu-view.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=r.GC$,a=r.Ul.Nl,s=n.Common.j,l=s.Fa,u=s.Aa,c=s.C4,f=void 0,h=document,d=(p={qKb:"mouseenter",rKb:"mouseleave",sKb:"click",tKb:"gc.command.executed",uKb:".",vKb:"gc-ui-contextmenu",wKb:"-",xKb:"container",yKb:"hover",zKb:"disable-hover",AKb:"text",BKb:"icon",CKb:"menuitem",DKb:"nonselective-menuitem",EKb:"menuitem-content",FKb:"sup-container",GKb:"separator",HKb:"sup-indicator",IKb:"subitems-container",JKb:"group-container",KKb:"title",LKb:"group-header",MKb:"groupitems-container",NKb:"groupitem",OKb:"nonexecutable",PKb:"executable",QKb:"disable",sXc:"gcUIElement",tXc:"gcContextMenu",RKb:"gc-statusbar-contextmenu",SKb:" ui-widget",TKb:" ui-state-hover",UKb:" ui-icon ui-icon-triangle-1-e",VKb:"DIV",WKb:"SPAN",XKb:"keydown.ctx.gcSheet",YKb:"none",ZKb:"inline-block",$Kb:"visible",_Kb:"hidden"}).vKb+p.wKb+p.yKb,g=p.vKb+p.wKb+p.CKb,m=p.vKb+p.wKb+p.DKb,y=p.vKb+p.wKb+p.EKb,C=p.vKb+p.wKb+p.PKb,v=p.vKb+p.wKb+p.FKb,b=p.vKb+p.wKb+p.IKb,w=p.RKb+p.wKb+"check",T=p.RKb+p.wKb+"check-container",S=p.RKb+p.wKb+"content",x=p.RKb+p.wKb+"status",A=function(){function t(){}return t.prototype.ai=function(t,e,o,n){var r=this;r.qo=i(t),r.lla=c(e),r.wu=o.commandManager(),r.xc=o,r.Eu=n,r.LQ=[],r.YPa={},r.rQa=[],r.ZPa=null,r.lma()},t.prototype.mma=function(){var t,e,o,n,r,a,s,u=this,c=parseInt(u.qo.css("left"),10),f=parseInt(u.qo.css("top"),10),d=u.qo.width(),g=u.qo.height(),m=i(u.xc.getHost()),y=m.width(),C=u.hostInfo;l(C)?(n=m.height(),c+d>y&&(c=c-d>0?c-d:c,u.qo.css("left",c)),f+g>n&&(f>g?f-=g:n>=g?f=n-g:(r=u.qo.css("display"),u.qo.css("display",p.YKb),(a=h.documentElement.scrollHeight)-(s=m.offset().top)>f+g||a>g&&(f=n+(a-s-n)-g),u.qo.css("display",r)),u.qo.css("top",f))):(t=C.top,e=C.width,o=C.height,c+d>e&&(c=c-d>0?c-d:c,u.qo.css("left",c)),window.innerHeight-t-o<t&&(f-=g,u.qo.css("top",f)))},t.prototype.lma=function(){var t,e,o,n=this,r=n.lla;l(r)||!function(t){if(t instanceof Object)return!0}(r)||r.length<1||(r instanceof Array||(r=[r]),t="menuView",e=n.nma(t,r),n.YPa.menuView=e,(o=n.oma(n.lla)).appendTo(n.qo),n.mma(),n.QQ(),n.rQa.push({name:t,menuView:o}))},t.prototype.nma=function(t,e){for(var o,n=this,r=e.length,i=0,a=[];i<r;i++)o=e[i],l(o)||"separator"===o.type||(o.subMenu?n.YPa[o.name]=n.nma(o.name,o.subMenu):"groupHeader"===o.type&&(n.pma(o,e),n.YPa[o.name]=n.nma(t,o.groups)),a.push(n.qma(t,o)));return a},t.prototype.qma=function(t,e){var o,n,r,a=this;if(o="groupHeader"===e.type?a.$Pa():a.rma(),n=a.createMenuItemElement(e),!l(n))return n instanceof HTMLElement&&(n=i(n)),n.appendTo(o),r={name:e.name,host:o,menuItemData:e,menuName:t},a.LQ.push(r),r},t.prototype.rma=function(){var t=i(a(p.VKb));return t.addClass(g),t},t.prototype.$Pa=function(){var t=i(a(p.VKb));return t.addClass(m),t},t.prototype.createMenuItemElement=function(t){var e=this,o=t.type;return"groupHeader"===o?e.tma(t):"groupItem"===o?e.uma(t):"statusBar"===o?e.Eyb(t):t.subMenu?e.vma(t):e.wma(t)},t.prototype.wma=function(t){var e,o,n=i(a(p.VKb)).addClass(y);return t.command?t.disable?n.addClass(p.vKb+p.wKb+p.QKb):n.addClass(C):n.addClass(p.vKb+p.wKb+p.OKb),e=i(a(p.WKb)).addClass(p.vKb+p.wKb+p.BKb),t.iconClass&&e.addClass(t.iconClass),e.appendTo(n),t.text&&((o=i(a(p.WKb)).addClass(p.vKb+p.wKb+p.AKb))[0].innerHTML=t.text,o.appendTo(n)),n},t.prototype.sma=function(t){return i(a(p.VKb)).addClass(p.vKb+p.wKb+p.GKb)},t.prototype.tma=function(t){var e,o,n,r,s,l,u=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.JKb);if(t.groups.length<=0)return u;for((e=this.wma(t)).addClass(p.vKb+p.wKb+p.LKb),e.appendTo(u),o=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.MKb),r=(n=t.groups).length,s=0;s<r;s++)(l=this.xma("name",n[s].name).host).addClass(p.vKb+p.wKb+p.NKb),l.appendTo(o);return o.appendTo(u),u},t.prototype.uma=function(t){var e=this.wma(t);return e.find(p.uKb+p.vKb+p.wKb+p.AKb).remove(),e.attr(p.KKb,t.text),e},t.prototype.Eyb=function(t){var e,o,n,r=a("div"),s=i(r).addClass(y),l=t.visible,u=t.menuContent,c=t.status,f=a("div");return i(f).addClass(w),e=a("div"),i(e).addClass(T),e.appendChild(f),e.style.visibility=l?p.$Kb:p._Kb,(o=a("div")).innerText=u,i(o).addClass(S),n=a("div"),i(n).addClass(x),c?(n.innerText=c,n.style.display=p.ZKb):n.style.display=p.YKb,r.appendChild(e),r.appendChild(o),r.appendChild(n),s},t.prototype.vma=function(t){var e,o=i(a(p.VKb)).addClass(v),n=this.wma(t);return t.subMenu.length>0&&(i(a(p.WKb)).addClass(p.vKb+p.wKb+p.HKb+p.UKb).appendTo(n),(e=this.oma(t.subMenu)).addClass(b),e.appendTo(o)),n.appendTo(o),o},t.prototype.oma=function(t){for(var e,o,n,r=this,s=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.xKb+p.SKb),u=t.length,c=0;c<u;c++)l(t[c])||(e=t[c].name,l(e)?"separator"===t[c].type&&(n=r.$Pa(),r.sma(t[c]).appendTo(n),n.appendTo(s)):(o=r.xma("name",e),l(o)||o.host.appendTo(s)));return s},t.prototype.xma=function(t,e){for(var o=this.LQ,n=o.length,r=0;r<n;r++)if(e instanceof i?e[0]===o[r][t][0]:o[r][t]===e)return o[r]},t.prototype.pma=function(t,e){var o,n,r;for(t.groups=[],o=e.length,n=0;n<o;n++)(r=e[n])&&r.group&&r.group===t.name&&(r.type="groupItem",t.groups.push(r),e.splice(n,1),n--)},t.prototype.QQ=function(){var t=this;i(p.uKb+g).bind(p.qKb,(function(){var e,o,n=i(this),r=t.xma("host",n);for(t.ZPa=r,e=0,o=t.rQa.length;e<o&&r.menuName!==t.rQa[o-e-1].name;e++)t.Ooa();t._Pa(),t.cQa(!1)})).bind(p.rKb,(function(){t.ZPa=null,t._Pa()})).bind(p.sKb,(function(e){var o=i(this),n=t.xma("host",o);t.ZPa=n,t.aQa(!1,e)&&t.WT()})),i(h).bind(p.XKb,(function(e){var o,n;if(!e.target||i(e.target).attr(p.sXc)!==p.tXc){switch(e.keyCode){case 27:t.Ooa()||t.WT();break;case 32:case 13:t.aQa(!0,e)&&t.WT();break;case 9:e.shiftKey?t.bQa(!1,!0):t.bQa(!0,!0);break;case 37:o=t.Ooa(),(n=t.xma("name",o))&&(t.ZPa=n),t.ZPa&&t.ZPa.menuItemData.group&&t.bQa(!1,!0);break;case 38:t.bQa(!1,!1);break;case 39:t.ZPa&&t.ZPa.menuItemData.group&&t.bQa(!0,!0),t.cQa(!0);break;case 40:t.bQa(!0,!1)}e.preventDefault?e.preventDefault():e.returnValue=!1}}))},t.prototype.Noa=function(t){var e,o,n,r,i=t.offset().left,a=t.width();i+a>(window.scrollX||window.pageXOffset)+window.innerWidth&&t.css("left",-a),e=t.offset().top,o=t.height(),n=t.position().top,e+o>(r=window.scrollY||window.pageYOffset)+window.innerHeight&&t.css("top",n-(e+o-(r+window.innerHeight)))},t.prototype.zma=function(t){return t.command},t.prototype.getCommandOptions=function(t,e,o){},t.prototype.aQa=function(t,e){var o,n=this,r=n.ZPa;if(r&&!r.menuItemData.disable)return(o=r.menuItemData).subMenu?void(o.subMenu.length>0&&n.cQa(t)):(n.h4(e),!0)},t.prototype.h4=function(t){var e,o,n,i,a,s,c,f,h=this,p=h.ZPa,d=h.zma(p.menuItemData);l(d)||(e=h.getCommandOptions(p.menuItemData,p.host[0],t),o=h.wu,u(d)?d(h.xc,e):(i=(n=r.sJc(h.xc)).getActiveColumnIndex(),a=n.getActiveRowIndex(),s=n.tables&&n.tables.find(a,i),c=n.pivotTables&&n.pivotTables.findPivotTable(a,i),l(c)?o.execute({cmd:d,sheetName:n.name(),selections:n.getSelections(),activeRow:a,activeCol:i,commandOptions:e,tableName:s?s.name():""}):(f=p.menuItemData.commandOptions,l(f)&&(f={}),l(f.pivotTableName)&&(f.pivotTableName=c.name()),l(f.pivotTableCellInfo)&&(f.pivotTableCellInfo=c.getPivotInfoImp(a,i,!1,!1,!0)),o.execute({cmd:d,sheetName:n.name(),selections:n.getSelections(),activeRow:a,activeCol:i,commandOptions:f}))))},t.prototype.Tla=function(){i(p.uKb+g).unbind(p.qKb).unbind(p.rKb).unbind(p.sKb),i(h).unbind(p.XKb)},t.prototype.no=function(){var t=this;t.qo=null,t.lla=null,t.wu=null,t.xc=null,t.Eu=null,t.LQ=null,t.YPa=null,t.ZPa=null,t.Tla()},t.prototype.Ooa=function(){var t;if(this.rQa.length>1)return(t=this.rQa.pop()).menuView.find(p.uKb+g).removeClass(d+p.TKb),t.menuView.hide(),t.name},t.prototype._Pa=function(){var t,e,o=this,n=o.dQa(!0);if(n){for(t=0,e=n.length;t<e;t++)n[t].host.removeClass(d+p.TKb);o.ZPa&&(o.ZPa.menuItemData.disable?o.ZPa.host.addClass(p.vKb+p.wKb+p.zKb+p.TKb):o.ZPa.host.addClass(d+p.TKb))}},t.prototype.WT=function(){this.Eu.trigger(p.tKb),this.no()},t.prototype.bQa=function(t,e){var o,n,r,i=this,a=i.dQa(e);i.ZPa&&((o=i.eQa(i.ZPa,a))||(n=i.YPa[i.ZPa.menuItemData.group])&&(r=n[0],o=i.eQa(r,a))),t?(o!==f&&o!==a.length-1||(o=-1),o="number"==typeof o?o+1:0):(o!==f&&0!==o||(o=a.length),o="number"==typeof o?o-1:0),i.ZPa=a[o],i._Pa()},t.prototype.dQa=function(t){for(var e,o,n,r=this,i=r.rQa[r.rQa.length-1].name,a=r.YPa[i],s=0,l=a.length,u=[];s<l;s++)if("groupHeader"!==a[s].menuItemData.type)u.push(a[s]);else if(e=r.YPa[a[s].menuItemData.name],t)for(o=0,n=e.length;o<n;o++)u.push(e[o]);else u.push(e[0]);return u},t.prototype.eQa=function(t,e){var o,n=e.length;for(o=0;o<n;o++)if(t.name===e[o].name)return o},t.prototype.cQa=function(t){var e,o,n=this,r=n.ZPa;r&&((e=r.menuItemData).subMenu&&e.subMenu.length>0&&(e.name!==n.rQa[n.rQa.length-1].name&&((o=i(r.host.find(p.uKb+b)[0])).show(),n.Noa(o),n.rQa.push({name:e.name,menuView:o})),n.ZPa=null,t&&n.bQa(!0,!1)))},t}(),e.MenuView=A},"./dist/plugins/data/binding.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b;function w(t,e){var o=t&&t.wq;return!(!o||!o.xL(e)||(t.clearPendingChanges(),n.Worksheet.ao(t,"initBinding",{sheet:t,data:e}),0))}function T(t,e,o){var n,r,i,a,s,l,u,f,h,p=t,m=p.Ou,y={value:c,hasBinding:!1};if(!m)return y;if(n=p.kj,(r=p.CL)===g){if(s=n?n.getBindingPath(e,o):c)return{value:m.getValue(s),hasBinding:!0}}else{if(e<0||t.getRowCount()<=e)return y;if(l=n?n.getColumnCount():t.getColumnCount(),o<0||l<=o)return y;if(n?(p.qia||(p.qia=n.ITa.Hp(!1,3)),(i=p.qia[o])&&(a=i.name)):t.HL&&(p.qia?(i=p.qia[o])&&(a=i.dataField):a=t.HL[o]),r)return u=d[r],h=A(f=i&&i.value)?f:c,u.getValue(m,h,a,e,o)}return y}function S(t,e){return t&&e&&e!==g?d[e].getProperties(t):c}function x(t){return C&&t instanceof C}function A(t){return t instanceof Function}function I(t,e,o){var n,r,i,a,s;if(t&&e){if(n=t[e],!u(n))return void(A(n)?t[e](o):t[e]=o);for(i=(r=e.split(".")).length,a=0;a<i&&(s=r[a],t);a++)a===i-1?A(t[s])?t[s](o):t[s]=o:A(t[s])?(u(t[s]())&&t[s]({}),t=t[s]()):(u(t[s])&&(t[s]={}),t=t[s])}}function R(t,e,o){var n,r,i,a,s;if(!t||!e)return c;if(n=t[e],!u(n))return A(n)?n():n;r=null,o?(r=o[e])||(r=e.split("."),o[e]=r):r=e.split("."),i=r.length,a=0;do{if(t=A(t[s=r[a]])?t[s]():t[s],u(t))return c;++a}while(a<i);return t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Core"),i=r.GC$,a=o("Common"),s=o("./dist/plugins/data/data.ns.js"),l=i.isNumeric,u=a.Common.j.Fa,c=null,f=void 0,h="string",e.yL=p,d=e.yL=p={},g="cellBinding",m=new a.Common.ResourceManager(s.SR,"Bindings"),y=m.getResource.bind(m),n.Workbook.$n("binding",{onCultureChanged:function(){y()}}),C=function(){function t(t){this.xf=t}return t.prototype.setValue=function(t,e){I(this.xf,t,e)},t.prototype.getValue=function(t){return R(this.xf,t)},t.prototype.getSource=function(){return this.xf},t}(),e.CellBindingSource=C,v=function(){function t(t){this.ad(t)}return t.prototype.bind=function(t,e){var o,n,r,a,s=this,l=s.kj,u=s.Ou;if(e&&s.tUa(e,{type:"bind",oldDataSource:u}),u&&(u.lka&&(u.subscribe=u.lka,delete u.mka,delete u.lka),A(u.dispose)&&u.dispose()),s.zL(s.AL),s.zL(s.BL),s.ad(l),s.Ou=t,t){if(o=s.CL=function(t){var e=c;return t&&(x(t)?e=g:i.each(d,(function(o,n){if(n.isDataSource(t))return e=o,!1}))),e}(t),!o)throw Error(y().Exp_NotSupportedDataSource);s.DL=s.EL(),l&&i[i.sd]({tc:l.parent}),l&&(n=s.AL,r=t.currentPosition,t.subscribe&&n.push(t.subscribe(s.FL,s)),r&&r.subscribe&&n.push(r.subscribe(s.GL,s)),A(t.subscribe)&&!t.lka&&(a=t.lka=t.subscribe,t.mka=!1,t.subscribe=function(e,o){var n=[].concat.apply([],arguments);return n[0]=function(){if(!t.mka&&A(e))return e.apply(o,arguments)},a.apply(t,n)}),s.Lx()),s.HL=S(t,o)}return w(l,t)},t.prototype.Lx=function(){var t,e,o,n,r,i=this,a=i.kj,s=i.Ou;if(a&&s&&(t=i.CL,i.zL(i.BL),e=c,t!==g&&(o=a.getActiveRowIndex(),s.currentPosition?(-1<=o&&o<s.count()&&s.currentPosition(o),e=s.currentItem()):e=i.ru(o)),e))for(r in n=function(){a&&a.repaint()},e)e[r]&&A(e[r].subscribe)&&i.BL.push(e[r].subscribe(n,c,c))},t.prototype.zL=function(t){var e,o;if(t)for(e=0;e<t.length;e++)(o=t[e])&&A(o.dispose)&&o.dispose()},t.prototype.getRowCount=function(){var t=this.Ou,e=this.CL,o=0;return t&&e&&e!==g&&(o=d[e].getDataLength(t)),o},t.prototype.getColumnCount=function(){var t,e,o,n=this.HL;return n?n.length:(t=this.Ou)&&(e=t[0],"null"===(o=i.getType(e))||o===h||"number"===o)?1:0},t.prototype.getSource=function(){return this.Ou},t.prototype.rL=function(){return this.HL},t.prototype.Nka=function(t){this.HL=t},t.prototype.ru=function(t){var e=this.Ou,o=this.CL,n=c;return e&&o&&o!==g&&(n=d[o].getDataItem(e,t)),n},t.prototype.EL=function(){var t,e,o,n=this;if(!n.DL)for(t=n.getRowCount(),e=0;e<t;e++)if(o=n.ru(e)){n.DL=o.entityAspect&&o.entityType||o.constructor;break}return n.DL},t.prototype.getValue=function(t,e){return T(this,t,e)},t.prototype.setValue=function(t,e,o,n){var r,i=this;return n&&(r=T(i,t,e).value,i.tUa(n,{type:"setValue",row:t,col:e,oldValue:r})),function(t,e,o,n){var r,i,a,s,l,u,h,p,m,y,C=t,v=C.Ou,b=!1;if(!v)return b;if(r=C.kj,i=C.CL,i===g)l=r?r.getBindingPath(e,o):c,l&&(v.setValue(l,n),b=!0);else{if(e<0||t.getRowCount()<=e)return b;if(u=r?r.getColumnCount():t.getColumnCount(),o<0||u<=o)return b;r?(C.qia||(C.qia=r.ITa.Hp(!1,3)),(a=C.qia[o])&&(s=a.name)):t.HL&&(C.qia?(a=C.qia[o])&&(s=a.dataField):s=t.HL[o]),i&&(h=d[i],m=A(p=a&&a.value)?p:c,y=r&&r.onItemUpdated?r.onItemUpdated.bind(r):f,b=h.setValue(v,m,s,e,o,n,y))}return b}(i,t,e,o)},t.prototype.sL=function(){var t=d[this.CL];return t&&t.canAdd&&t.canAdd()},t.prototype.tL=function(){var t=d[this.CL];return t&&t.canInsert&&t.canInsert()},t.prototype.vL=function(){var t=d[this.CL];return t&&t.canRemove&&t.canRemove()},t.prototype.allowSetCount=function(){var t,e=this.CL;return e===g||(t=d[e])&&t.allowSetCount&&t.allowSetCount()},t.prototype.uL=function(t,e,o){var n,r,i,a,s=this,l=s.Ou;!l||t>s.getRowCount()||(n=s.CL,r=s.EL(),n&&n!==g&&!s.IL&&(s.JL=!0,o&&s.tUa(o,{type:"addItems",row:t,rowCount:e}),a=(i=s.kj)&&i.onItemAdded?i.onItemAdded.bind(i):f,d[n].addItems(l,t,e,r,a),s.JL=!1))},t.prototype.wL=function(t,e,o){var n,r,i,a=this,s=a.CL,l=a.getRowCount(),u=a.Ou;!u||t>=l||s&&s!==g&&!a.IL&&(a.JL=!0,r=(n=a.kj)&&n.onItemRemoved?n.onItemRemoved.bind(n):f,i=d[s].removeItems(u,t,e,r),o&&i&&i.length>0&&a.tUa(o,{type:"removeItems",row:t,removedItems:i}),a.JL=!1)},t.prototype.uUa=function(t,e){var o=this.Ou,n=this.CL;d[n].undoRemoveItems(o,t,e)},t.prototype.xL=function(t){return x(t||this.Ou)},t.prototype.ad=function(t){var e=this;e.Ou=c,e.CL="",e.DL=c,e.HL=c,e.AL=[],e.BL=[],e.qia=c,e.kj=t,function(t){var e=t&&t.wq;e&&e.xL()&&n.Worksheet.ao(t,"resetBinding",{sheet:t})}(t)},t.prototype.FL=function(t){var e,o,n,r,i=this,a=i.kj;if(a&&!i.JL){if(t){if(i.IL=!0,!isNaN(t.length)&&(a.setRowCountCore(t.length),e=a.ITa,u(i.HL)&&0===e.VTa(!1,3)&&(i.HL=S(i.Ou),a.setColumnCount(i.getColumnCount()),o=i.rL())))for(n=0,r=o.length;n<r;n++)e.do("setItem",!1,3,n,{name:o[n]});i.IL=!1}a.$p()}},t.prototype.GL=function(){var t,e=this.kj,o=this.Ou;e&&o&&o.currentPosition&&(t=o.currentPosition(),e.Jl!==t&&(e.Sr(t,e.Kl,f,f,2),e.$p()))},t.prototype.tUa=function(t,e){if(!(this.kj&&this.kj.ITa&&!u(this.kj.ITa.WTa)&&this.kj.ITa.WTa<=0)){var o=t.rUa;o||(o=t.rUa=[]),e.bindingManager=this,o.push(e)}},t.prototype.sUa=function(t){var e=this,o=t.type,n=t.row;"bind"===o?e.bind(t.oldDataSource):"setValue"===o?e.setValue(n,t.col,t.oldValue):"addItems"===o?e.wL(n,t.rowCount):"removeItems"===o&&e.uUa(n,t.removedItems)},t.prototype.toJSON=function(){var t,e=this.Ou;return e?{type:t=this.CL,source:e=t===g?e.getSource():d[t].toJSON(e)}:c},t.prototype.fromJSON=function(t){var e,o,n=t&&t.source;n&&(void 0,(o=(e=t.type)===g?new C(n):d[e].fromJSON(n))&&this.bind(o))},t}(),e.qL=v,e.setValueByPath=I,e.LL=R,b=function(){function t(){this.pathCache={}}return t.prototype.isDataSource=function(t){return i.isArray(t)},t.prototype.getDataLength=function(t){return t.length},t.prototype.getDataItem=function(t,e){return t[e]},t.prototype.addItems=function(t,e,o,n){var r,i;for(r=0;r<o;r++)i={},n&&(i=n.createEntity?n.createEntity():new n),t.splice(e,0,i)},t.prototype.removeItems=function(t,e,o){var n=this.getDataLength(t);if(e<n)return t.splice(e,Math.min(o,n-e))},t.prototype.undoRemoveItems=function(t,e,o){for(var n=0,r=o.length;n<r;n++)t.splice(e+n,0,o[n])},t.prototype.getProperties=function(t){var e,o,n=t.length,r=c;if(n>0)for(o in r=[],e=t[0])A(e[o])||r.push(o);return r},t.prototype.getValue=function(t,e,o,n,r){var i=c,a=!1,s=this.getDataItem(t,n);return u(s)||(e?(i=e(s),a=!0):o?(i=R(s,o,this.pathCache),a=!0):(typeof s===h||l(s))&&0===r&&(i=s,a=!0)),{value:i,hasBinding:a}},t.prototype.setValue=function(t,e,o,n,r,i){var a=!1,s=this.getDataItem(t,n);return u(s)||(e?(e(s,i),a=!0):o?(I(s,o,i),a=!0):(typeof s===h||l(s))&&0===r&&(t[n]=i,a=!0)),a},t.prototype.fromJSON=function(t){return t},t.prototype.toJSON=function(t){return t},t}(),d.defaultBindingSource=new b},"./dist/plugins/data/data.dataview.js":function(t,e,o){"use strict";var n,r,i,a;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/plugins/data/binding.js"),e.yL=r.yL,i=n.Common.j.Fa,a=function(){function t(){}return t.prototype.isDataSource=function(t){var e=window.wijmo;return e&&e.data&&e.data.isDataView&&e.data.isDataView(t)},t.prototype.getDataLength=function(t){return t.count()},t.prototype.getDataItem=function(t,e){return t.item(e)},t.prototype.addItems=function(t,e,o,n){if(n)for(var r=0;r<o;r++)t.mka=!0,t.add(n.createEntity?n.createEntity():new n),t.mka=!1,t.commitEdit()},t.prototype.removeItems=function(t,e,o){var n,r,i,a,s=this.getDataLength(t);if(e<s){for(n=[],r=Math.min(o,s-e),i=0;i<r;i++)a=t.item(e),t.remove(a),n.push(a);return n}},t.prototype.undoRemoveItems=function(t,e,o){var n,r,i=t.getSource();for(n=0,r=o.length;n<r;n++)i.splice(e+n,0,o[n]);t.refresh()},t.prototype.getProperties=function(t){var e,o=0,n=null,r=t.getProperties();if(r&&r.length>0)for(o=r.length,n=[],e=0;e<o;e++)n.push(r[e].name);return n},t.prototype.canInsert=function(){return!1},t.prototype.getValue=function(t,e,o,n,r){var a=null,s=!1,l=this.getDataItem(t,n);return i(l)||(e?(a=e(l),s=!0):o&&(a=t.getProperty(l,o),s=!0)),{value:a,hasBinding:s}},t.prototype.setValue=function(t,e,o,n,r,a){var s=!1,l=this.getDataItem(t,n);return i(l)||(e?(e(l,a),s=!0):o&&(t.setProperty(l,o,a),s=!0)),s},t.prototype.fromJSON=function(t){return t},t.prototype.toJSON=function(t){return t.local},t}(),r.yL.dataViewBinding=new a},"./dist/plugins/data/data.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/plugins/data/worksheet-databind.js");var r=o("./dist/plugins/data/binding.js");e.CellBindingSource=r.CellBindingSource,e.qL=r.qL,e.setValueByPath=r.setValueByPath,e.LL=r.LL,n(o("./dist/plugins/data/data.ko.js")),n(o("./dist/plugins/data/data.dataview.js")),n(o("./dist/plugins/data/data.ns.js"))},"./dist/plugins/data/data.ko.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/data/binding.js"),e.yL=i.yL,a=r.Common.j.Fa,s=n.GC$,l=s.isFunction,u=s.getType,c=s.isNumeric,f="string",h=window.ko,p=function(){function t(){}return t.prototype.isDataSource=function(t){return h&&h.isObservable(t)},t.prototype.getDataLength=function(t){return t().length},t.prototype.getDataItem=function(t,e){return t()[e]},t.prototype.addItems=function(t,e,o,n){var r,i;for(r=0;r<o;r++)i={},n&&(i=n.createEntity?n.createEntity():new n),t.splice(e,0,i)},t.prototype.removeItems=function(t,e,o){var n=this.getDataLength(t);if(e<n)return t.splice(e,Math.min(o,n-e))},t.prototype.undoRemoveItems=function(t,e,o){for(var n=0,r=o.length;n<r;n++)t.splice(e+n,0,o[n])},t.prototype.getProperties=function(t){var e,o,n=t(),r=[];if(n.length>0)for(o in e=n[0])l(e[o])?h&&h.isObservable(e[o])&&r.push(o):r.push(o);return r},t.prototype.getValue=function(t,e,o,n,r){var s=null,l=!1,h=this.getDataItem(t,n);return a(h)||(e?(s=e(h),l=!0):o?(s=i.LL(h,o),l=!0):(u(h)===f||c(h))&&0===r&&(s=h,l=!0)),{value:s,hasBinding:l}},t.prototype.setValue=function(t,e,o,n,r,s){var l=!1,h=this.getDataItem(t,n);return a(h)||(e?(e(h,s),l=!0):o?(i.setValueByPath(h,o,s),l=!0):(u(h)===f||c(h))&&0===r&&(t()[n]=s,l=!0)),l},t.prototype.fromJSON=function(t){return h?h.observableArray(t):null},t.prototype.toJSON=function(t){return t()},t}(),i.yL.koBinding=new p,h&&((d=h.bindingHandlers)["gc-spread-sheets"]=d["gcspread-sheets"]=d.wijspread={init:function(t,e,o,r){var i,a,l,u,c,h,p,d,g,m,y,C;if(!s(t).data("workbook")&&(a=(i=e())&&i.sheets,l=new n.Workbook(s("#"+t.id)[0],i),a)){for(u=void 0,c=void 0,h=a.length,p=l.getSheetCount();p<h;)u=l.vv(l.wv(p)),l.ow(p,0,u),p=l.getSheetCount();for(d=0;d<h;d++)u=l.getSheet(d),g=(c=a[d]).name,m=c.autoGenerateColumns,y=c.data,C=c.columns,typeof g===f&&g.length>0&&u.cq(g),"boolean"==typeof m&&(u.autoGenerateColumns=m),y&&u.setDataSource(y),C&&C.length>0&&(u.autoGenerateColumns=!1,u.bindColumns(C))}},update:function(t,e,o,n){}})},"./dist/plugins/data/data.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/data/data.res.en.js");e.SR={en:n}},"./dist/plugins/data/data.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d;function g(t,e,o){"string"==typeof o&&(o={name:o}),t.ITa.do("setItem",!1,3,e,o);var n=o&&o.formatter,r=o&&o.cellType;n&&t.setFormatter&&t.setFormatter(-1,e,n),r&&t.setCellType(-1,e,r),o&&!a(o.width)&&t.setColumnWidth(e,o.width)}function m(t,e,o,n){var r,i,s,l,u=t.wq;for(r=0;r<o;r++)for(i=0;i<n;i++)s=u.getValue(r,i).value,a(s)||(l=s,p.Ska(s)&&(l=p.Daa(s)),t.qI(e,r,i,l))}function y(t,e,o,n){var r,i,s,l,u,c=t.options.colHeaderAutoTextIndex;for(r=0;r<o;r++)if(c>=0&&r===c||-1===c&&r===o-1)for(i=0;i<n;i++)s=e[r]&&e[r][i]&&e[r][i].value,l=t.ITa.Jp(!1,3,i),a(s)&&l&&((u=l.displayName||l.name)&&t.qI(e,r,i,u))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/data/binding.js"),a=r.Common.j.Fa,s=n.GC$.isEmptyObject,l=n.GC$.extend,u=n.Worksheet.prototype,c=null,f="bindingPath",h=RegExp("^\\d*(\\.\\d+)?\\*$"),p=r.Common.l,d={getDataSource:function(){var t=this.wq;return t?t.getSource():c},setDataSource:function(t,e){var o,n,r,a,s,l=this,u=l.wq;if(u&&u.getSource()!==t){if(l.suspendPaint(),e&&l.vs(),t){if((u=l.wq).aLb=!0,!u.bind(t,l.ITa.zTa)&&(l.setRowCountCore(u.getRowCount()),l.autoGenerateColumns&&(l.setColumnCount(u.getColumnCount()),o=u.rL())))for(n=0,r=o.length;n<r;n++)l.ITa.do("setItem",!1,3,n,{name:o[n]})}else l.wq=new i.qL(l);l.clearPendingChanges(),a=!1,u&&u.aLb&&(a=u.bLb,delete u.bLb,delete u.aLb),l.recalcAll&&l.recalcAll(a),(s=l.tu())&&s.PA===l&&s.hZ(),l.resumePaint()}},bindColumn:function(t,e){var o=this;o.suspendPaint();try{g(o,t,e)}finally{o.resumePaint()}},bindColumns:function(t){var e,o,n,r,i=this;i.suspendPaint();try{if(t)for(e=t.length,isNaN(e)||i.setColumnCount(e),o=0;o<e;o++)r=(n=t[o]).size,h.test(r)&&(n.starSize=r),g(i,o,n)}finally{i.resumePaint()}},getDataItem:function(t){var e,o,n,r,i,s,l=this,u=l.wq;if(!u||0===u.getRowCount())return c;if(e=l.getColumnCount(),o={},n=u.ru(t))for(r in n)n.hasOwnProperty(r)&&"function"!=typeof r&&(o[r]=n[r]);for(i=0;i<e;i++)(s=l.ITa.Jp(!1,3,i))&&s.name&&s.name.length>0&&a(o[s.name])&&(o[s.name]=l.getValue(t,i));return o},getDataColumnName:function(t){var e,o=this;return 0<=t&&t<o.getColumnCount()&&o.getDataSource()?(e=o.ITa.Jp(!1,3,t))&&(e.displayName||e.name):c},getBindingPath:function(t,e){return this.ITa.getValueForKey(t,e,f)},setBindingPath:function(t,e,o){var n=this;return n.ITa.do("setValueForKey",t,e,f,o),n.$p(),n}},l(u,d),n.CellRange.prototype.bindingPath=n.CellRange.Pl(u.getBindingPath,u.setBindingPath),n.Worksheet.$n("binding",{init:function(){var t=this;t.autoGenerateColumns=!0,t.wq=new i.qL(t)},dispose:function(t){!1!==t.clearCache&&(this.wq=c)},onLayoutChanged:function(t){var e,o,n,r,i,a=this,s=t.changeType,l=t.row,u=t.rowCount,f=t.sheetArea,h=a.wq;if("addingRows"===s)h&&!1===h.sL()?t.canAdd=!1:h&&!1===h.tL()&&(t.newRow=a.getRowCount());else if("addRows"===s)h&&h.uL(l,u,a.ITa.zTa);else if("deletingRows"===s){if(h)if(!1===h.vL())t.canDelete=!1;else for(a.Ts||(a.Ts=[]),e=a.Ts,o=a.ITa,n=h.getRowCount(),r=0;r<u&&l+r<o.getRowCount();r++)i=c,l+r<n&&(i=h.ru(l+r)),e.push({row:l+r,data:i})}else"deleteRows"===s?h&&h.wL(l,u,a.ITa.zTa):"settingRowCount"===s&&(!h.getSource()||h.allowSetCount()||3!==f&&2!==f||(t.canSet=!1))},toJson:function(t,e){var o,n,r=this,i=r.getColumnCount(),a=r.getDataSource();e&&e.includeBindingSource&&a&&(m(r,o=t.data.dataTable||{},r.getRowCount(),i),s(o)||(t.data.dataTable=o),y(r,n=t.colHeaderData.dataTable||{},r.getRowCount(1),i),s(n)||(t.colHeaderData.dataTable=n)),!0!==r.autoGenerateColumns&&(t.autoGenerateColumns=r.autoGenerateColumns)},fromJson:function(t,e){var o,n,r,s,l=this;l.wq=new i.qL(l),e&&(o=l.wq,n=t.dataSource,r=t.dataBinding,n&&o.bind(n),r&&o.fromJSON(r,e)),s=t.autoGenerateColumns,a(s)||(l.autoGenerateColumns=s)},preFromJson:function(){this.wq=new i.qL(this)}}),n.lUa.$n("binding",{priority:6e3,getValue:function(t){var e,o=t.row,n=t.col,r=t.sheetArea,i=this.kj.wq;3===r&&i&&i.Ou&&(e=i.getValue(o,n),t.isValueGet=e.hasBinding,t.value=e.value)},setValue:function(t){var e,o,n,r=t.row,i=t.col,a=t.value,s=t.sheetArea,l=this.kj,u=l.wq;3===s&&u&&u.Ou&&((e=u.getValue(r,i)).hasBinding&&(a!==(o=e.value)?(l.isDirtySuspended()||(n=l.getDataItem(r),this.Cp(r,i,{Dp:n,Ep:o},s)),t.isValueSet=u.setValue(r,i,a,l.ITa.zTa)):t.isValueSet="dataManagerBindingSource"!==u.CL))},undo:function(t){var e,o,n=t.rUa;if(n)for(e=n.length-1;e>=0;e--)(o=n[e]).bindingManager.sUa(o)}})},"./dist/plugins/dragMerge/dragMerge-action.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function c(t,e){return t.Tq(e)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),e.Commands=n.Commands,r=n.Commands.ActionBase,i=n.Commands.h4,a="dragMerge",s=Math.max,l=function(t){function e(e,o){return t.call(this,e,o)||this}return u(e,t),e.prototype.canExecute=function(){var t,e=this.kj,o=this.VQ,n=c(e,o.oldSelection),r=c(e,o.newSelection);if(n.equals(r)){if((t=e.getSpan(n.row,n.col))&&n.equals(t))return!1;if(1===n.rowCount&&1===n.colCount)return!1}return!0},e.prototype.canUndo=function(){var t=n.Commands.bWa(this.kj.name()),e=this.VQ[t];return n.Commands.cWa(e)},e.prototype.undo=function(){var t,e,o=this;return!!o.canUndo()&&(t=o.kj,o.Lz(t,!0),e=n.Commands.bWa(t.name()),t.ITa.undo(o.VQ[e]),void o.Mz(t,!0))},e.prototype.execute=function(){var t,e,o,r,i=this,a=i.kj,l=i.VQ,u=l.oldSelection,c=l.newSelection;return!!i.canExecute()&&(a.ITa.startTransaction(),i.Lz(a,!0),a.ITa.do("clearSpan",u.row,u.col,u.rowCount,u.colCount),t=c.row,e=c.col,o=c.rowCount,r=c.colCount,a.addSpan(t,e,o,r),a.setSelection(t,e,s(o,1),s(r,1)),i.Mz(a,!0),void(l[n.Commands.bWa(a.name())]=a.ITa.endTransaction()))},e}(r),n.Commands[a]={canUndo:!0,execute:function(t,e,o){return i(t,l,e,o)}},n.Commands.dja=function(t){t.register(a,n.Commands[a])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(t,e,o){"use strict";var n,r,i,a,s;function l(t,e){t.Wq(n.Events.DragMerging,e)}function u(t,e){t.Wq(n.Events.DragMerged,e)}Object.defineProperty(e,"__esModule",{value:!0}),r=(n=o("Core")).GC$,i=void 0,a=Math.abs,s=n.kf,r.extend(n.iI.prototype,{gka:function(t){var e=t,o=this.kj.ITa.findSpan(t.row,t.col);return o&&o.containsRange(t)&&(e=o),e},Yia:function(t,e,o){var n,r,i,s,l,u=this.kj,c=u.parent,f=u.Ix(),h=u.yl;if(c&&c.options.allowUserDragMerge&&f&&!u.CH&&h.Xja){if(r=(n=h.Xja).x,i=n.y,s=n.width,l=n.height,a(r+s-e)<=2&&a(i+l/2-o)<=4)return{right:!0};if(a(r+s/2-e)<=4&&a(i+l-o)<=2)return{bottom:!0}}return null},Zia:function(t){var e,o,n,r,i,a,s,l,u=this;return u.eG=!0,u.OG=!0,u.$ia=!0,u.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},u.fja=t.dragMergeInfo,o=(e=u.kj).ITa,n=e.Ix(),u.ika=u.gka(n),i=(r=e.Tq(u.ika)).row,a=r.col,s=r.rowCount,l=r.colCount,o.qu(i,a,s,l)?(u.OG=!1,void(u.$ia=!1)):(u._ja=e.ITa.getSpans(r),e.suspendPaint(),o.do("clearSpan",i,a,s,l),e.resumePaint(),u.aka=r,u.bka(),u.jka(r),void u.qG())},_ia:function(){var t,e,o,n,r,i,a,s,l=this,u=l.kj,c=u.parent;return c&&!c.options.allowUserDragMerge?void l.aja():(t=l.fH(),e=l.gH(),o=l.aka||l.ika,n=u.Tq(o),void(t>=0&&e>=0&&(r=l.fja,i=l.qja(n,t,e,r),l.kka=i,a=i.rowCount,s=i.colCount,a>0&&s>0&&(l.bka(),l.jka(i),l.aka=i,l.NG()))))},bka:function(){var t,e=this.kj,o=this.aka;o&&((t=e.cm(o)).x-=2,t.y-=2,t.width+=4,t.height+=4,e.yl.dm(t))},qja:function(t,e,o,n){var r,i,a,l,u,c,f,h,p=this.kj,d=t.row,g=t.col,m=t.rowCount,y=t.colCount;return n.right?(i=g,l=o-g+1,u=r=d,c=g+y,f=a=m,h=o-g-y+1):n.bottom&&(r=d,a=e-d+1,u=d+m,c=i=g,f=e-d-m+1,h=l=y),p.ITa.MTa(u,c,f,h)&&(r=d,i=g,a=m,l=y),s(r,i,a,l)},aja:function(){var t,e,o,n=this,r=n.kj,a=r.parent,s=n._ja,c=n.ika,f=n.kka||c;n.eG=!1,n.OG=!1,n.$ia=!1,n.kka=i,n._ja=i,n.aka=i,n.ika=i,n.RG(),a&&a.options.allowUserDragMerge&&(t=r.ITa,r.suspendPaint(),s.length>0&&s.forEach((function(e){t.do("addSpan",e)})),r.resumePaint(),e={sheetName:r.name(),sheet:r,mergeRange:f,cancel:!1},l(r,e),e.cancel||(o={cmd:"dragMerge",sheetName:r.name(),oldSelection:c,newSelection:f},r.wu().execute(o),u(r,{sheetName:r.name(),sheet:r,mergeRange:f})))},jka:function(t){var e=this.kj.yl;(0,e.hka)(e,t)}})},"./dist/plugins/dragMerge/dragMerge.entry.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/plugins/dragMerge/dragMerge-action.js"),o("./dist/plugins/dragMerge/dragMerge.js"),o("./dist/plugins/dragMerge/dragMerge-event.js")},"./dist/plugins/dragMerge/dragMerge.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u;function c(t){var e=t.parent;return e&&e.options.backColor||"white"}function f(t,e,o){var r=t.am(),i=t.rKc(r),a=t.oKc(r),s=function(t,e,o){var n,r,i,a,s=t.Er(o.row);if((1===s||s!==t.Er(o.row+o.rowCount-1))&&(n=t.jt(1)).length>0){if(r=e.y+e.height/2,i=n[0],a=n[n.length-1],i.y<=r&&r<=i.y+i.height)return 1;if(a.y<=r&&r<=a.y+a.height)return 1}}(t,e,o),l=function(t,e,o){var n,r,i,a,s=t.Fr(o.col);if((1===s||s!==t.Fr(o.col+o.colCount-1))&&(n=t.it(1)).length>0){if(r=e.x+e.width/2,i=n[0],a=n[n.length-1],i.x<=r&&r<=i.x+i.width)return 1;if(a.x<=r&&r<=a.x+a.width)return 1}}(t,e,o);return 1===s&&1===l?r.Ft(s,l):1===s?new n.Rect(r.kt,r.qt,r.hs+i+r.js,a):1===l?new n.Rect(r.pt,r.nt,i,r.fs+a+r.gs):new n.Rect(r.kt,r.nt,r.hs+i+r.js,r.fs+a+r.gs)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/dragMerge/dragMerge-action.js"),a=r.Common.pc,s=n.GC$,s.extend(n.oJ.prototype,{cja:function(t,e){var o,r,i,a,s,l,u,c,h,p,d,g,m,y=this,C=y.kj,v=C.mm;n.needPaintSelection(C)&&(4,8,2,4,r=(o=C.cm(v.gka(e))).x,i=o.y,l=r+(a=o.width)-2,u=i+(s=o.height)/2-4,c=4,h=8,d=f(C,p=new n.Rect(l,u,c,h),e),l=r+a/2-4,u=i+s-2,c=8,h=4,m=f(C,g=new n.Rect(l,u,c,h),e),y.Xja=o,y.Wja(t,p,g,d,m))},Wja:function(t,e,o,r,i){var a=this.kj,s=n.Rm.Om(a,a.getSelectionBorderColor());t.save(),t.fillStyle=s,r&&(t.rect(r.x,r.y,r.width,r.height),t.clip()),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.fill(),t.restore(),t.save(),t.fillStyle=s,i&&(t.rect(i.x,i.y,i.width,i.height),t.clip()),t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.fill(),t.restore()},hka:function(t,e){var o,r,i,s,l,u,f,h,p,d,g,m,y=t,C=y.kj,v=C.parent,b=C.mm,w=t.bm();v&&v.options.allowUserDragMerge&&b.$ia&&(o=C.getActiveRowIndex(),r=C.getActiveColumnIndex(),s=(i=C.getActualStyle(o,r))&&i.backColor,l=c(C),(u=a.ec(n.Rm.Om(C,s||l))).a*=.6/255,w.fillStyle=a.bc(u),w.strokeStyle=n.Rm.Om(C,C.getSelectionBorderColor()),w.lineWidth=2,w.beginPath(),f=v.Vv,p=(h=C.cm(e)).x,d=h.y,g=h.width,m=h.height,f>2007?(w.rect(p,d,g-1,m-1),w.strokeRect(p-1,d-1,g+1,m+1)):(w.rect(p+1,d+1,g-2-.5,m-2-.5),w.strokeRect(p-.5,d-.5,g,m)),w.fill(),w.restore(),y.cja(w,e))}}),l={init:function(){i.Commands.dja(this.commandManager())}},n.Workbook.$n("dragMerge",l),u={paintAdornment:function(t){var e,o=t.ctx,n=this,r=n.yl,i=n.ITa.getSelections();n.parent&&n.parent.options.allowUserDragMerge&&1===i.length&&!n.CH&&(e=n.Ix(),r.cja(o,e))}},n.Worksheet.$n("dragMerge",u)},"./dist/plugins/fill/drag-fill.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function j(t){return t.rowCount}function P(t){return t.colCount}function L(t,e){return t.getRowCount(e)}function G(t,e){return t.getColumnCount(e)}function B(t,e,o,n,r,i){var a,s,l,u=t.getSelections();t.Tr(),t.addSelection(e,o,n,r),a=t.getSelections(),t.Au(u),s=e>0?e:t.ar(),l=o>0?o:t.$q(),t.Kr(s,l,t.Nr,t.Pr),t.parent&&i.xC&&t.parent.changeSelectionInCommandExecuting(i,null,null,a)}function _(t){var e=t.parent.getActiveSheet();e&&t!==e&&e.repaint()}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("./dist/plugins/fill/fill.js"),a=o("./dist/plugins/fill/fill.ns.js"),s=o("@grapecity/js-calc"),l=!!s,u=n.Common.j.Fa,c=null,f=void 0,h=r.kf,p=r.GC$,d=Math.max,g=Math.floor,m=r.Commands.ActionBase,y=r.Commands.xy,C=r.Commands.Bu,v=2047,b="startRange",w="fillRange",T="autoFillType",S="fillDirection",x="cancel",A="fill",I="dragDrop",R=p.isEmptyObject,M=new n.Common.ResourceManager(a.SR,"Fill"),k=M.getResource.bind(M),N={fillAuto:function(t,e,o){if(!e)throw Error(k().Exp_RangeIsNull);var r=this,a=o.fillType,s=o.series,l=o.direction,f=o.step,h=o.stop,p=new i.z$(r),d=o.lYc;if(function(t,e,o,n){return!!(t&&e&&e.containsRange(t))&&(!u(o)&&(1===o&&t.row===e.row&&j(t)===j(e)||0===o&&t.col===e.col&&P(t)===P(e))||!(u(n)||(2!==n&&3!==n||t.col!==e.col||P(t)!==P(e))&&(0!==n&&1!==n||t.row!==e.row||j(t)!==j(e))))}(t,e,l?c:s,l)){r.suspendPaint(),t&&(r.mm.A$=t);try{4===a?p.B$(e,s,!1,o.withTag,o.withoutStyle,d):0===a?p.C$(e,l):1===a||2===a?p.D$(1===a,e,s,f,h):3===a&&p.E$(e,s,3,f,u(h)?c:n.Common.l.Ra(h),o.unit)}finally{r.resumePaint()}}}},p.extend(r.Worksheet.prototype,N),r.Worksheet.$n(A,{init:function(){this.Fyb=new i.Gyb(this)},setHost:function(t){if(t){var e=this.wu();e[A]||e.register(A,r.Commands[A]),e[I]||e.register(I,r.Commands[I])}},dispose:function(t){if(!1!==t.clearCache){var e=this;e.Fyb&&(e.Fyb.no(),e.Fyb=c)}}}),r.Workbook.$n(A,{onCultureChanged:function(){k()}}),O=function(t){function e(e,o){var n=t.call(this)||this,i=n,a=o[S],s=0===a,l=s||1===a,u=o[w],c=o[b],f=c.row,p=c.col,d=j(c),g=P(c);return i.kj=e,i.G$=o,4===o[T]?i.H$=new r.Commands.OA(e,{ranges:[o[w]]}):i.I$=l?h(f,s?u.col:p,d,g+P(u)):h(2===a?u.row:f,p,d+j(u),g),i.J$=l?1:0,n}return E(e,t),e.prototype.canExecute=function(){var t=this.kj,e=this.G$,o=e[b],n=e[w];return!(!t.Y3(n.row,n.col,j(n),P(n),void 0,void 0,void 0,void 0,!0)||4!==e[T]&&n.intersect(o.row,o.col,j(o),P(o)))},e.prototype.execute=function(){var t,e,o,n,i,a=this;if(a.canExecute()){e=(t=a.G$)[w],(o=a.kj).ITa.startTransaction(),a.Lz(o,!0);try{l&&o.suspendCalcService(),n=o.getSelections(),o.isDirtySuspended()||(a.N$=new y(o,t[w],v)),4===t[T]?a.K$(o):a.L$(o),o.yu(n,o.getSelections())&&o.Au(n)}finally{a.Mz(o,!0),t[r.Commands.bWa(o.name())]=o.ITa.endTransaction(),l&&o.resumeCalcService(!1),o.t4&&o.t4(e.row,e.col,j(e),P(e)),i=[],o.isDirtySuspended()||(a.M$=new y(o,e,v),a.M$.uy(a.N$.sy()),i=a.M$.wy()),C(o,e.row,e.col,j(e),P(e),i,1)}}},e.prototype.K$=function(t){var e,o,n,r,i,a,s,l,u,c=this;c.H$.execute(t),o=(e=c.G$)[b],n=e[w],r=0===c.J$,a=j(o),s=P(o),l=r?d(1,a-j(n)):a,u=r?s:d(1,s-P(n)),o.equals(n)||(i=h(o.row,o.col,l,u),t.Kr(d(t.ar(),i.row),d(t.$q(),i.col),t.Nr,t.Pr),t.Tr(),t.addSelection(i.row,i.col,j(i),P(i)))},e.prototype.L$=function(t){var e,o,n,r,i=this,a=i.kj,s=i.G$[b],l=i.G$[w],u=i.G$[T],c=i.I$,h={fillType:4,series:i.J$,withTag:!0},p=a.tables;if(p)try{n=[],p.fIb(c,f,f,f,n),n.length>0&&(h.lYc=n)}catch(t){return a.Os(6,t.message),void a.resumePaint()}if(1===u){if(a.fillAuto(s,c,h),a.ITa.MTa(s.row,s.col,s.rowCount,s.colCount))for(e=0;e<l.rowCount;e++)for(o=0;o<l.colCount;o++)(r=a.Aj(s.row+g(e%s.rowCount),s.col+g(o%s.colCount)))&&r.clone&&(r=r.clone()),a.Nq(l.row+e,l.col+o,r)}else 0===u?(4^v,i.O$(s,l,2043)):2===u?i.O$(s,l,192):3===u&&(!(1!==j(s)||1!==P(s)||-1===s.row&&-1!==s.col||-1===s.col&&-1!==s.row)?(187,i.O$(s,l,187)):(h.withoutStyle=!0,a.fillAuto(s,c,h)));a.Kr(d(t.ar(),c.row),d(t.$q(),c.col),t.Nr,t.Pr),t.Tr&&t.Tr(),a.addSelection(c.row,c.col,j(c),P(c))},e.prototype.O$=function(t,e,o){var n,r,i,a,s,l=this,u=l.kj,c=u.Tq(t),f=u.Tq(e),h=c.row,p=c.col,d=j(c),m=P(c),y=f.row,C=f.col,v=j(f),b=P(f),w=l.G$[S],T=3===w,x=1===w,A=g(v/d),I=v%d,R=g(b/m),M=b%m;if(0===l.J$){for(n=0;n<A;n++)a=T?y+n*d:y+v-(n+1)*d,u.ax(h,p,a,C,d,m,o,!0,!0);0!==I&&(r=T?h:h+(A+1)*d-v,a=T?y+d*A:y+v-A*d-I,u.ax(r,p,a,C,I,m,o,!0,!0))}else{for(n=0;n<R;n++)s=x?C+n*m:C+b-(n+1)*m,u.ax(h,p,y,s,d,m,o,!0,!0);0!==M&&(i=x?p:p+(R+1)*m-b,s=x?C+m*R:C+b-R*m-M,u.ax(h,i,y,s,d,M,o,!0,!0))}},e.prototype.undo=function(){var t,e,o,n,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{l&&i.suspendCalcService(),t=i.getSelections(),e=r.G$,o=i.NF,n=e[w],a=4===e[T]?r.S$(i):r.T$(i),!i.U$&&o&&o.close(),C(i,n.row,n.col,j(n),P(n),r.M$?r.M$.wy():[],1,f,!0),i.yu(t,i.getSelections())&&i.Au(t)}finally{r.Mz(i,!0),l&&i.resumeCalcService(!1)}}return a},e.prototype.S$=function(t){var e=this.G$[b],o=e.row,n=e.col,i=r.Commands.bWa(t.name());return t.ITa.undo(this.G$[i]),t.Kr(d(t.ar(),o),d(t.$q(),n),t.Nr,t.Pr),!0},e.prototype.T$=function(t){var e,o=this.G$,n=o[b],i=n.row,a=n.col;l&&t.suspendCalcService();try{e=r.Commands.bWa(t.name()),t.ITa.undo(o[e]),t.Kr(d(t.ar(),i),d(t.$q(),a),t.Nr,t.Pr)}finally{l&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},e}(m),D=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.kj=e,r.i4=o,r.W$=o[b],r.X$=o[w],r.Y$=o[T],r.Z$=o[S],n}return E(e,t),e.prototype.execute=function(){var t,e,o,n,i,a,s,l,u,c=this,f=!1;if(c.canExecute()){e=(t=c.kj).parent,o=c.X$,n=c.i4,t.ITa.startTransaction(),c.oUa(),c.Lz(t,!0),t.vxb=!0;try{i=t.getSelections(),void 0,s=t.mm,(l={sheet:t,sheetName:t.name()})[x]=!1,l[w]=o,l[T]=c.Y$,l[S]=c.Z$,t.Wq(r.Events.DragFillBlock,l),s.$$=l[T],s._$=l[x],l[x]||(c.a_(l),t.Wq(r.Events.DragFillBlockCompleted,l)),f=!0,a=t.getSelections(),t.yu(i,a)&&t.Au(i),e&&n.xC&&e.changeSelectionInCommandExecuting(n,null,null,a)}finally{c.Mz(t,!0),t.vxb=!1,c.IVa(t,o),u=r.Commands.bWa(t.name()),c.i4[u]=t.ITa.endTransaction()}}return f},e.prototype.a_=function(t){var e,o,n=this,r=n.kj,i=r.mm,a=n.X$,s=n.Y$;i.$$=s,i._$||((e={})[b]=n.W$,e[w]=a,e[T]=5===t[T]?s:t[T],e[S]=n.Z$,o=new O(r,e),r.suspendEvent(),o.execute(),r.resumeEvent(),n.i4.d_=o)},e.prototype.oUa=function(){var t=this;t.kj.isDirtySuspended()||(t.N$=new y(t.kj,t.X$,v))},e.prototype.undo=function(){var t,e,o,n,i,a,s,l=this;if(l.canUndo()){t=l.kj,e=l.X$,o=t.parent,n=l.i4,l.oUa(),l.Lz(t,!0);try{i=t.getSelections(),t.suspendEvent(),a=r.Commands.bWa(t.name()),t.ITa.undo(l.i4[a]),t.resumeEvent(),s=n[b],t.yu(i,[s])&&t.Au(i),o&&n.xC&&o.changeSelectionInCommandExecuting(n,null,null,[s])}finally{l.Mz(t,!0),l.IVa(t,e,!0)}}return!0},e.prototype.IVa=function(t,e,o){var n,r=[];t.isDirtySuspended()||((n=new y(t,e,v)).uy(this.N$.sy()),r=n.wy()),C(t,e.row,e.col,j(e),P(e),r,1,f,o)},e}(m),F=function(t){function e(e,o){return t.call(this,e,o)||this}return E(e,t),e.prototype.canExecute=function(){var t,e,o,n=this,r=n.kj,i=n.VQ,a=i.fromRow,s=i.fromColumn,l=j(i),u=i.columnCount,f=i.toRow,h=i.toColumn,p=!i.copy,d={row:a,col:s,rowCount:l,colCount:u},g={row:f,col:h,rowCount:l,colCount:u};return(!r.tables||!r.tables.zxb(r,d,r,g,p))&&!!r.pu(a,s,l,u,L(r),G(r))&&!(!i.insert&&!r.pu(f,h,l,u,L(r),G(r)))&&(t=f>=0&&h<0&&a>=0&&s<0&&l>0&&u<0,e=f<0&&h>=0&&a<0&&s>=0&&l<0&&u>0,o=n.KZa(t,e),r.Y3(f,h,l,u,c,c,o)&&r.Y3(a,s,l,u,c,c,o))},e.prototype.KZa=function(t,e){var o,n,r=this.VQ,i=this.kj,a=r.insert,s=i.options.isProtected,l=i.options.protectionOptions;return!(!s||R(l)||(o=l.allowDragInsertRows,n=l.allowDragInsertColumns,!a||!(o&&t||n&&e)))},e.prototype.PLc=function(t){var e=[].concat(t.parent.sheets);return t&&t.xUc&&e.push(t),e},e.prototype.execute=function(){var t,e,o,n,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v=this,b=!1;if(v.canExecute()){t=v.kj,e=v.VQ,v.oUa(),o=void 0,n=void 0,i=void 0,a=e.fromRow,s=e.fromColumn,l=e.toRow,u=e.toColumn,c=j(e),f=e.columnCount,h=e.option,p=c,d=f,g=v.PLc(t),t.KLc()&&(p+=t.MLc(l,c,!0),d+=t.MLc(u,f)),r.Commands.Zxb(g),v.Lz(t,!0),t.vxb=!0;try{try{t.tables&&t.tables.fIb(new r.Range(l,u,p,d),new r.Range(a,s,c,f))}catch(e){return t.Os(6,e.message),void t.resumePaint()}e.insert?s>=0&&a<0?(o=s,n=u,i=f,m=u,t.addColumns(n,i),e.copy?t.copyTo(-1,n<=o?o+i:o,-1,n,-1,i,h):(t.moveTo(-1,n<=o?o+i:o,-1,n,-1,i,h),t.deleteColumns(n<=o?o+i:o,i),o<n&&(m=n-i)),B(t,-1,m,L(t),i,e)):a>=0&&s<0&&(o=a,n=l,i=c,y=l,t.addRows(n,i),e.copy?t.copyTo(n<=o?o+i:o,-1,n,-1,i,-1,h):(t.moveTo(n<=o?o+i:o,-1,n,-1,i,-1,h),t.deleteRows(n<=o?o+i:o,i),o<n&&(y=n-i)),B(t,y,-1,i,G(t),e)):(e.copy?t.copyTo(a,s,l,u,c,f,h):t.moveTo(a,s,l,u,c,f,h),t&&(B(t,l,u,p,d,e),C=e.io,e.copy||t.isDirtySuspended()||(C._z=v.aA(t,C.cA,a,s,c,f)),t.isDirtySuspended()||(C.dA=v.aA(t,C.fA,l,u,c,f)))),b=!0}finally{t.mm.gA={},v.Mz(t,!0),t.vxb=!1,r.Commands.$xb(g,e)}_(t)}return b},e.prototype.aA=function(t,e,o,n,r,i){var a=new y(t,h(o,n,r,i),this.VQ.option),s=t.tables&&t.tables.$Hb&&t.tables.$Hb(o,n,r,i);return s&&s.length>0&&(this.VQ.tableNamesObj={r:o,c:n,rc:r,cc:i,tableNames:s}),a.uy(e.sy()),C(t,o,n,r,i,a.wy(),0,s),a},e.prototype.oUa=function(){var t=this.kj,e=this.VQ,o=e.io={},n=e.fromRow,r=e.fromColumn,i=e.toRow,a=e.toColumn,s=e.option,l=n<0?0:n,u=r<0?0:r,c=i<0?0:i,f=a<0?0:a,p=n<0?L(t):j(e),d=r<0?G(t):e.columnCount;e.insert||t.isDirtySuspended()||(e.copy||(o.cA=new y(t,h(l,u,p,d),s)),o.fA=new y(t,h(c,f,p,d),s)),o.rA=t.Nr,o.sA=t.Pr,o.tA=t.Jl,o.uA=t.Kl},e.prototype.undo=function(){var t,e,o,n,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,w,T,S=this;if(S.canUndo()){if(t=S.kj,o=(e=S.VQ).fromRow,n=e.fromColumn,i=e.toRow,a=e.toColumn,s=j(e),l=e.columnCount,!t.pu(o,n,s,l,L(t),G(t)))return!1;if(!e.insert&&!t.pu(i,a,s,l,L(t),G(t)))return!1;u=void 0,c=e.io,S.Lz(t,!0),f=S.PLc(t),r.Commands._xb(f,e);try{e.insert?n>=0&&o>=0||(n>=0?(u=l,t&&B(t,-1,n,L(t),u,e)):o>=0&&(u=s,t&&B(t,o,-1,u,G(t),e))):(h=o<0?0:o,p=n<0?0:n,d=i<0?0:i,g=a<0?0:a,m=o<0?L(t):s,y=n<0?G(t):l,t&&(B(t,o,n,s,l,e),v=e.tableNamesObj,b=[],w=[],v&&(v.r===d&&v.c===g&&v.rc===m&&v.cc===y?w=v.tableNames:b=v.tableNames),C(t,d,g,m,y,c.dA?c.dA.wy():[],0,b,!0),C(t,h,p,m,y,c._z?c._z.wy():[],0,w,!0))),t&&(-1!==c.tA&&-1!==c.uA&&((T=t.getSelections()[0]).contains(c.tA,c.uA)?t.Jr(c.tA,c.uA):t.Jr(T.row,T.col)),-2!==c.rA&&-2!==c.sA&&-1!==c.tA&&-1!==c.uA&&t.showCell(c.tA,c.uA,3,3))}finally{S.Mz(t,!0)}_(t)}return!0},e}(m),r.Commands[A]={canUndo:!0,execute:function(t,e,o){return r.Commands.h4(t,D,e,o)}},r.Commands[I]={canUndo:!0,execute:function(t,e,o){return r.Commands.h4(t,F,e,o)}}},"./dist/plugins/fill/fill-event.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A;function I(t){return t.rowViewportIndex}function R(t){return t.colViewportIndex}function M(t){return t.hitTestType}function k(t,e){return t.getRowCount(e)}function N(t,e){return t.getColumnCount(e)}function O(t){return t.colCount}function D(t){return t.rowCount}function F(t){return t.height}function E(t){return t.width}function j(t,e,o,n,i){var a,s,l;t.save(),e===n?(t.rect(e-2,o,7,y(i-o)),t.clip(),t.beginPath(),o<i?(o-=3,i+=3):(o+=3,i-=3),a=r.zF(e-1,o-1,n-1,i+1,w,7),s=r.zF(e,o,n,i,w,7),l=r.zF(e+1,o-1,n+1,i+1,w,7)):o===i&&(t.rect(e,o-2,y(n-e),7),t.clip(),t.beginPath(),e<n?(e-=3,n+=3):(e+=3,n-=3),a=r.zF(e-1,o-1,n+1,i-1,w,7),s=r.zF(e,o,n,i,w,7),l=r.zF(e-1,o+1,n+1,i+1,w,7)),a&&a.vE(t),s&&s.vE(t),l&&l.vE(t),t.stroke(),t.beginPath(),t.restore()}function P(t,e,o,n,i,a,s,l,u,c,f){var h=e?r.Events.DragDropBlock:r.Events.DragDropBlockCompleted,p={sheet:t,sheetName:t.name(),fromRow:o,fromCol:n,toRow:i,toCol:a,rowCount:s,colCount:l,copy:u,insert:c,copyOption:f};return e&&(p.cancel=!1),t.Wq(h,p),p.cancel}function L(t,e,o,n,r){var i,a,s;for(i=0;i<o.rowCount;i++){for(a=0;a<o.colCount;a++){if(!(s=t.getSpan(o.row+i,o.col+a))||s.rowCount!==e.rowCount||s.colCount!==e.colCount)return!1;n&&(a+=e.colCount)}r&&(i+=e.rowCount)}return!0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("SheetsCalc"),a=o("./dist/plugins/fill/fill-ui.js"),s=o("./dist/plugins/fill/fill.js"),l=o("./dist/plugins/fill/fill.ns.js"),u=o("@grapecity/js-calc"),c=!!u,f=r.GC$,h=r.kf,p=n.Common.j.Fa,d=null,g=void 0,m=Math.min,y=Math.abs,C=Math.max,v="drag",b="corner",w="black",T=2047,S=n.Common.u,x=new n.Common.ResourceManager(l.SR),A=x.getResource.bind(x),f.extend(r.iI.prototype,{gG:function(t){var e,o,n,r,i,a,s,l,u=this;u.zG||(e=u.kj,o=d,1===(n=e.ITa.getSelections()).length?o=n[0]:n.length<1&&(o=e.ITa.getSpan(e.Jl,e.Kl)),o&&(u.zG=!0,u.OG=!0,u.L_=o,r=e.getRangeRect(I(t),R(t),o),(i=u.gA).x=r.x,i.y=r.y,i.width=r.width-1,i.height=r.height-1,i.row=o.row,i.col=o.col,i.rowCount=D(o),i.colCount=O(o),a=e.Tq(o),s=t.row,l=t.col,s<a.row&&(s=a.row),s>=a.row+D(a)&&(s=a.row+D(a)-1),l<a.col&&(l=a.col),l>=a.col+O(a)&&(l=a.col+O(a)-1),i.hitRow=s,i.hitCol=l,i.rowOffset=s-a.row,i.colOffset=l-a.col,u.rG={KG:I(t),MG:R(t),sG:M(t)},u.qG()))},AG:function(){var t,e,o,n,r,i,a,s,l,u,c=this;c.rG&&c.OG&&c.zG&&c.L_&&(t=c.$F,e=c.gA,n=(o=c.kj.getCellRect(e.hitRow,e.hitCol)).width/2,r=o.x+n,i=o.height/2,a=o.y+i,e.hitTarget={x:t.x,y:t.y},s=c.fH(),l=c.gH(),u=!1,(y(r-t.x)>n+5||y(a-t.y)>i+5)&&(u=!0),s>=0&&l>=0&&u&&c.M_(s,l),c.NG())},M_:function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p,d,g,y,v=this;v.zG&&v.L_&&(o=v.kj,n=v.gA,r=o.KLc(),i=o.Ix(),a=k(o),s=N(o),l=m(s-O(n),e-n.colOffset),u=m(a-D(n),t-n.rowOffset),r&&(l-=o.OLc(e,n.colOffset+1),u-=o.OLc(t,n.rowOffset+1,!0),0===o.getColumnWidth(l)&&(l=o.br(l)),0===o.getRowHeight(u)&&(u=o.gr(u))),-1===i.row&&-1!==i.col?(n.row=-1,n.col=C(0,l)):-1!==i.row&&-1===i.col?(n.row=C(0,u),n.col=-1):(n.row=n.row<0?-1:C(0,u),n.col=n.col<0?-1:C(0,l)),n.hitRow=t,n.hitCol=e,c=o.Tq(n),r&&(f=o.MLc(c.row,c.rowCount,!0),h=o.MLc(c.col,c.colCount),c.rowCount+=f,c.colCount+=h,c.rowCount=m(a,c.rowCount),c.colCount=m(s,c.colCount),c.row+c.rowCount>a&&(c.row=a-c.rowCount,n.row=c.row),c.col+c.colCount>s&&(c.col=s-c.colCount,n.col=c.col)),(p=v.N_)&&c.row===p.row&&c.col===p.col&&D(c)===D(p)&&O(c)===O(p)&&c.row>o.ar()&&c.col>o.$q()&&c.row+D(c)-1<o.ir()&&c.col+O(c)-1<o.dr()||(v.MI=c,o.yl.QH(),v.N_=c,(d=o.parent)&&d.options.showDragDropTip&&(g=n.x+n.width+5,y=n.y+n.height+5,d.uw(S.Ob(v.O_(c)),g,y))))},O_:function(t){var e,o,n,r,a,s,l,f,h,p,m,y,C,v;return t&&c?(n=D(o=(e=this.kj).Ix()),r=O(o),a=e.getActiveRowIndex(),s=e.getActiveColumnIndex(),l=void 0,f=e.KLc(),a=a<0?0:a,s=s<0?0:s,1===n&&1===r?l=u.rf(d,d,t.row-a,t.col-s,!0,!0):(h=void 0,p=void 0,m=void 0,y=void 0,C=0,v=0,-1===o.row&&o.col>=0?(h=m=i.BAND_INDEX_CONST,p=t.col-s,y=t.col-s+r-1,v=r):-1===o.col&&o.row>=0?(p=y=i.BAND_INDEX_CONST,h=t.row-a,m=t.row-a+n-1,C=n):o.row>=0&&o.col>=0&&(h=t.row-a,m=t.row-a+n-1,p=t.col-s,y=t.col-s+r-1,C=n,v=r),f&&(m+=e.MLc(t.row,C,!0),y+=e.MLc(t.col,v)),l=u.uf(d,d,h,p,m,y,!0,!0,!0,!0,a,s)),e.Cf().unparse(e.yj(),l,a,s)):g},wH:function(){var t,e,o,n,i,a,s,l,u,f,p,g,m=this,y=!1,C="",v=!1,b=m.kj;m.rG=d,m.RG(),t=(e=b.Ix())&&(D(e)>0||O(e)>0)?{r:e.row,c:e.col,rc:D(e),cc:O(e)}:{r:b.Jl,c:b.Kl,rc:1,cc:1},!0===m.zG&&!0===m.OG&&(o=t.r,n=t.c,i=t.rc,a=t.cc,s=m.gA.row,l=m.gA.col,u=b.options.protectionOptions,void 0,f={fromRow:o,fromColumn:n,rowCount:i,columnCount:a,toRow:s,toColumn:l,isDragInsert:m.OH,isDragCopy:m.PH},b.Wq(r.Events.BeforeDragDrop,f),(C=f.invalidMessage)&&0!==C.length||(!m.OH||-1!==o&&-1!==n?s===o&&l===n||((b.qu(o,n,i,a)||b.qu(s,l,i,a))&&(y=!0,C=A().Exp_ChangeMergedCell),y||c&&(b.Ns(o,n,i,a)||b.Ns(s,l,i,a))&&(y=!0,C=A().Exp_ChangePartOfArray),!y&&b.options.isProtected&&(!m.PH&&b.ou(h(o,n,i,a),!0)||b.ou(h(s,l,i,a),!0))&&(y=!0,C=A().Exp_CellReadOnly),y||(P(b,!0,o,n,s,l,i,a,m.PH,!1,T)||(v=b.wu().execute({cmd:"dragDrop",sheetName:b.name(),fromRow:o,fromColumn:n,toRow:s,toColumn:l,rowCount:i,columnCount:a,copy:m.PH,insert:!1,option:T}),P(b,!1,o,n,s,l,i,a,m.PH,!1,T)))):n>=0?(m.PH&&(l<=n||l>=n+a)||!m.PH&&(l<n||l>n+a))&&((b.qu(-1,n,-1,a)||b.qu(-1,l,-1,0))&&(y=!0,C=A().Exp_ChangeMergedCell),p=u&&u.allowDragInsertColumns,!y&&b.options.isProtected&&!0!==p&&(y=!0,C=A().Exp_ColumnReadOnly),y||(P(b,!0,-1,n,-1,l,-1,a,m.PH,!0,T)||(v=b.wu().execute({cmd:"dragDrop",sheetName:b.name(),fromRow:-1,fromColumn:n,toRow:-1,toColumn:l,rowCount:-1,columnCount:a,copy:m.PH,insert:!0,option:T}),P(b,!1,-1,n,-1,l,-1,a,m.PH,!0,T)))):o>=0&&n<0&&(m.PH&&(s<=o||s>=o+i)||!m.PH&&(s<o||s>o+i))&&((b.qu(o,-1,i,-1)||b.qu(s,-1,0,-1))&&(y=!0,C=A().Exp_ChangeMergedCell),y||c&&(b.Ns(o,-1,i,-1)||b.Ns(s,-1,0,-1))&&(y=!0,C=A().Exp_ChangePartOfArray),g=u&&u.allowDragInsertRows,!y&&b.options.isProtected&&!0!==g&&(y=!0,C=A().Exp_RowReadOnly),y||(P(b,!0,o,-1,s,-1,i,-1,m.PH,!0,T)||(v=b.wu().execute({cmd:"dragDrop",sheetName:b.name(),fromRow:o,fromColumn:-1,toRow:s,toColumn:-1,rowCount:i,columnCount:-1,copy:m.PH,insert:!0,option:T}),P(b,!1,o,-1,s,-1,i,-1,m.PH,!0,T)))))),m.OG=!1,m.zG=!1,m.L_=d,m.OH=!1,m.PH=!1,m.N_=d,m.xw(),v||(m.gA={},b.repaint()),y&&b.Os(3,C)},hG:function(t){var e=this;!0!==e.BG&&!0!==e.OG&&(e.P_(),e.A$&&(e.OG=!0,e.BG=!0,e.$I=!0,e.Q_=t,e.R_=R(t),e.S_=I(t),e.T_=R(t),e.U_(),e.rG={KG:I(t),MG:R(t),sG:M(t)},e.qG()))},U_:function(){var t,e=this,o=function(t){return t.frozenRowCount()}(e.kj),n=function(t){return t.frozenColumnCount()}(e.kj),r=e.V_();r>=0&&r<o?e.W_=0:r>=o&&r<=k(e.kj)&&(e.W_=1),e.X_()?e.Y_=1:e.Y_=e.Q_,(t=e.Z_())>=0&&t<n?e.__=0:t>=n&&t<=N(e.kj)&&(e.__=1),e.a0()?e.b0=1:e.b0=e.R_},CG:function(){var t,e,o=this;o.rG&&o.BG&&o.OG&&o.A$&&(o.S_=o.iH(),o.T_=o.jH(),o.c0=o.fH(),o.d0=o.gH(),o.c0>=0&&o.d0>=0&&(o.e0(),o.f0(),t=o.kj.parent,e=!1,o.g0()&&(e=o.h0(o.A$,o.A_,!0)),t&&t.options.showDragFillTip&&e&&o.i0(),o.j0()),o.NG())},k0:function(){var t,e,o,r,i,a,l,u,c,f,h,p=this,g=p.kj,m=p.A$,y=p.A_,C=g.parent.options.defaultDragFillType,v=p.l0(3===C?5:C,3===C),b=p.m0(),w=p.g0();return 1===v?(t=0===b||1===b?1:0,o=new s.z$(g).B$(w,t,!0),e=p.n0(b,y,m),i=(r=g.getActualStyle(e.row,e.col)).cellType||g.Al(),a=r.formatter?r.formatter:r._autoFormatter,l=n.Formatter&&n.Formatter.GeneralFormatter,o instanceof Date&&l&&(a=new l(n.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),c=3,(u=p.rG)&&(c=u.sG),f={sheet:g,row:e.row,col:e.col,sheetArea:c,quotePrefix:r.quotePrefix},h={},i.format(o,a,h,f)):0===v?(e=p.n0(b,y,m),g.getFormula(e.row,e.col)?d:g.getText(e.row,e.col)):d},n0:function(t,e,o){var n,r=o.row,i=o.col,a=D(o),s=O(o),l=h(r,i,1,1);return 3===t?(n=0===(n=D(e)%a)?r+a-1:r+n-1,l.row=n,l.col=i):1===t?(n=0===(n=O(e)%s)?i+s-1:i+n-1,l.row=r,l.col=n):0===t?(n=0===(n=O(e)%s)?i:i+s-n,l.row=r,l.col=n):2===t&&(n=0===(n=D(e)%a)?r:r+a-n,l.row=n,l.col=i),l},i0:function(){var t,e,o,n,r,i,a=this,s=a.kj;return 4===a.l0()||a.a0()||a.X_()?(a.xw(),d):(n=a.m0(),r=a.g0(),i=s.cm(r),o=a.k0(),3===n||1===n?(t=i.x+i.width+3,e=i.y+i.height+3):0===n?(t=i.x+3,e=i.y+i.height+3):2===n&&(t=i.x+i.width+3,e=i.y+3),void a.uw(o,t,e))},j0:function(){var t=this;t.o0(),t.p0(),t.q0(),t.r0=t.g0()},o0:function(){var t,e=this.kj;this.r0&&((t=e.cm(this.r0)).x-=2,t.y-=2,t.width+=4,t.height+=4,e.yl.dm(t))},p0:function(t){this.kj.yl.im(this.A$,d,t)},q0:function(){var t,e,o=this.kj,n=o.yl,r=this.g0();r&&(t=n.bm(),e=o.cm(r),t.save(),t.beginPath(),n.RI(t,e),t.restore())},f0:function(){this.A_=this._I()},a0:function(){return-1===this.A$.col&&-1!==this.A$.row},X_:function(){return-1===this.A$.row&&-1!==this.A$.col},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var t=this,e=-1,o=-1,n=-1,r=-1;switch(t.dJ){case 0:t.X_()?(e=-1,n=-1):(e=t.V_(),n=D(t.A$)),o=t.d0,r=t.Z_()-o;break;case 1:t.X_()?(e=-1,n=-1):(e=t.V_(),n=D(t.A$)),o=t.s0()+1,r=t.d0-o+1;break;case 2:e=t.c0,n=t.V_()-e,t.a0()?(o=-1,r=-1):(o=t.Z_(),r=O(t.A$));break;case 3:e=t.t0()+1,n=t.c0-e+1,t.a0()?(o=-1,r=-1):(o=t.Z_(),r=O(t.A$));break;case 5:e=t.c0,n=t.t0()-e+1,t.a0()?(o=-1,r=-1):(o=t.Z_(),r=O(t.A$));break;case 4:t.X_()?(e=-1,n=-1):(e=t.A$.row,n=D(t.A$)),o=t.d0,r=t.s0()-o+1}return h(e,o,n,r)},u0:function(){var t=this.t0();return-1!==t?this.kj.Gr(this.Y_).findRow(t):d},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var t=this.s0();return-1!==t?this.kj.Hr(this.b0).findCol(t):d},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var t,e,o,n,r,i,a,s,l,u,c,h,p,d,g,C,v,b,w,T=this,S=T.a0(),x=T.X_(),A=f(T.kj.Ws()).offset(),I=T.$F.e,R=T.$F.x,M=T.$F.y,k=I.pageX-A.left,N=I.pageY-A.top,O=!1;S||x?x?T.d0>=T.Z_()&&T.d0<=T.s0()?T.dJ=4:T.d0<T.Z_()?T.dJ=0:T.d0>T.s0()&&(T.dJ=1):S&&(T.c0>=T.V_()&&T.c0<=T.t0()?T.dJ=5:T.c0<T.V_()?T.dJ=2:T.c0>T.t0()&&(T.dJ=3)):T.c0>=T.V_()&&T.c0<=T.t0()?T.d0>=T.Z_()&&T.d0<=T.s0()?(t=y(T.d0-T.s0()),(e=y(T.c0-T.t0()))>t?T.dJ=5:e<t?T.dJ=4:((o=T.u0())||(o=T.v0()),M>o.y+o.height?T.dJ=3:((n=T.x0())||(n=T.y0()),r=n.x+n.width-R,i=o.y+o.height-M,k>=n.x&&k<=n.x+n.width&&N>=o.y&&N<=o.y+o.height?T.dJ=r>=i?4:5:O=!0))):T.d0<T.Z_()?T.dJ=0:T.d0>T.s0()&&(T.dJ=1):T.c0<T.V_()?T.d0>=T.Z_()&&T.d0<=T.s0()?T.dJ=2:T.d0<T.Z_()?(t=y(T.d0-T.Z_()),e=y(T.c0-T.V_()),T.dJ=e>=t?2:0):T.d0>T.s0()&&(t=y(T.d0-T.s0()),e=y(T.c0-T.V_()),T.dJ=e>=t?2:1):T.c0>T.t0()&&(T.d0>=T.Z_()&&T.d0<=T.s0()?T.dJ=3:T.d0<T.Z_()?(t=y(T.d0-T.Z_()),e=y(T.c0-T.t0()),T.dJ=e>=t?3:0):T.d0>T.s0()&&(t=y(T.d0-T.s0()),e=y(T.c0-T.t0()),T.dJ=e>=t?3:1)),(a=T.kj.yl.rH)&&(u=(s=T.t0())+1,c=(l=T.s0())+1,h=T.kj.getRowHeight(s,3),p=T.kj.getColumnWidth(l,3),d=T.kj.getRowHeight(u,3),g=T.kj.getColumnWidth(c,3),C=a.x+a.width/2-m(10,p/2),v=a.x+a.width/2+m(10,g/2),b=a.y+a.height/2-m(10,h/2),w=a.y+a.height/2+m(10,d/2),!1,(S||x?x?C<=k&&k<=v:b<=N&&N<=w:C<=k&&k<=v&&b<=N&&N<=w)||O?(T.$I=!0,T.dJ=4):T.$I=!1)},V_:function(){return this.A$?-1===this.A$.row?0:this.A$.row:-1},t0:function(){var t=this;return t.A$?-1===t.A$.row?k(t.kj)-1:t.A$.row+D(t.A$)-1:-1},Z_:function(){return this.A$?-1===this.A$.col?0:this.A$.col:-1},s0:function(){var t=this;return t.A$?-1===t.A$.col?N(t.kj)-1:t.A$.col+O(t.A$)-1:-1},hla:function(t,e){var o,n,r,i,a,s,l=h(e.row,e.col,e.rowCount,e.colCount),u=this.kj;return u.ITa.findSpan(t.row,t.col)&&(o=t.rowCount,n=l.rowCount,0!==Math.floor(n%o)&&(r=Math.ceil(n/o)*o,l.row+r<=u.getRowCount()&&(l.rowCount=r)),i=t.colCount,a=l.colCount,0!==Math.floor(a%i)&&(s=Math.ceil(a/i)*i,l.col+s<=u.getColumnCount()&&(l.colCount=s))),l},xH:function(){var t,e,o,n,r,i,a=this,s=a.kj;return a.rG=d,a.RG(),a.xw(),a.BG&&a.OG?(a.BG=!1,a.OG=!1,void((t=a.g0())&&(e=a.h0(a.A$,a.A_),!e||a.$I?(a.A0(),a.WA(t)):(o=s.mm.A$,n=a.hla(o,a.A_),r=a.l0(),s.wu().execute({cmd:"fill",sheetName:s.name(),startRange:o,fillRange:n,autoFillType:r,fillDirection:s.mm.m0()}),i=a._$,!i&&a.B0()&&s.parent.options.showDragFillSmartTag&&4!==a.$$?a.C0(a.$$):a.WA(t),a.A0())))):void a.A0()},C0:function(t){var e=this.kj,o=e.yl.rH,n={x:o.x+o.width,y:o.y+o.height,fillType:t};e.NF=new a.K_(e.parent.xv(),e,n),e.NF.OT()},P_:function(){var t=this.kj,e=t.ITa.getSelections();1===e.length?this.A$=e[0]:t.Jl>=0&&t.Kl>=0&&(this.A$=h(t.Jl,t.Kl,1,1))},A0:function(){this.OG=!1,this.BG=!1},WA:function(t){this.kj.yl.im(t)},l0:function(t,e){var o=this,n=o.kj,r=t!==g?t:n.parent.options.defaultDragFillType;return o.ZI()?4:5!==r?r:1===D(o.A$)&&1===O(o.A$)&&!o.X_()&&!o.a0()?o.RH&&!e?1:0:o.RH&&!e?0:1},g0:function(){var t,e,o,n,r=this;return r.A$?r.ZI()?r.A$:r.A_?(t=0,e=0,o=0,n=0,r.D0()?(t=2===r.dJ?r.A_.row:r.A$.row,e=D(r.A$)+D(r.A_),o=r.A$.col,n=O(r.A$)):(t=r.A$.row,e=D(r.A$),o=0===r.dJ?r.A_.col:r.A$.col,n=O(r.A$)+O(r.A_)),h(t,o,e,n)):d:d},h0:function(t,e,o){var n=this.kj,r=!0,i="";return n.ITa.MTa(e.row,e.col,D(e),O(e))&&!function(t,e,o){var n,r=e.row,i=e.rowCount,a=e.col,s=e.colCount,l=o.row,u=o.rowCount,c=o.col,f=o.colCount,h=r===l&&i===u,p=a===c&&s===f;return!(!h&&!p)&&!(!(n=t.getSpan(r,a))||!L(t,n,e,h,p))&&!t.ITa.qu(l,c,u,f)&&L(t,n,o,h,p)}(n,t,e)&&(r=!1,i=A().Exp_FillRangeContainsMergedCell),r&&n.options.isProtected&&n.ou(e,!0)&&(r=!1,i=A().Exp_FillCellsReadOnly),r||o||n.Os(2,i),r},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var t=this.dJ;return t>=0&&t<=3?t:4===t?0:5===t?2:3},tr:function(t,e,o){var n,r,i,a=this,s=d,l=I(t),u=R(t),c=a.kj,f=c.parent;if(p(l)||p(u)||!f.options.allowUserDragDrop&&!f.options.allowUserDragFill)return s;if(-1===(n=c.Ix()).row&&-1===n.col)return s;if(l>=0&&u>=0&&1===c.ITa.getSelections().length){if(a.qH(l,u,e,o))return s;(r=c.getRangeRect(l,u,n)).x-4<e&&e<r.x+4&&r.y<=o&&o<r.y+r.height&&(s={action:v,side:"left"}),s||(i=a.kj.yl.rH)&&i.x<=e&&e<=i.x+i.width&&i.y<=o&&o<=i.y+i.height&&(s={action:v,side:b}),s||r.x+r.width-4<e&&e<r.x+r.width+4&&r.y<=o&&o<r.y+r.height&&(s={action:v,side:"right"}),s||r.y-4<o&&o<r.y+4&&r.x<=e&&e<r.x+r.width&&(s={action:v,side:"top"}),s||r.y+r.height-4<o&&o<r.y+r.height+4&&r.x<=e&&e<r.x+r.width&&(s={action:v,side:"bottom"}),s&&(e<r.x||e>r.x+r.width||o<r.y||o>r.y+r.height)&&(s.outside=!0)}return f&&f.options.allowUserDragDrop||s&&s.side!==b&&(s.side=d),f&&f.options.allowUserDragFill||s&&s.side===b&&(s.side=d),s},Hyb:function(t,e){var o=this,n=o.kj.getSpan(t,e,3);return n?!p(o.kj.getValue(n.row,n.col,3,0)):!p(o.kj.getValue(t,e,3,0))},Iyb:function(t,e,o,n){var r;for(r=e;r<e+n;r++)if(!this.Hyb(t,r))return!1;return!0},Jyb:function(t,e,o,n){var r;for(r=e;r<e+n;r++)if(this.Hyb(t,r))return!1;return!0},Kyb:function(t,e,o,n){var r,i,a,s,l,u,c,f=this,h=f.kj;if("left"===n){for(r=0;r<e;r++)f.Hyb(t,r)&&(o.searchArray[r]=!0);for(i=e-1,a=1;o.searchArray[i];)i--,a++;o.searchLength=a}if("right"===n){for(s=h.getColumnCount(),l=e;l<s;l++)f.Hyb(t,l)&&(o.searchArray[l-e]=!0);for(u=0,c=1;o.searchArray[u];)u++,c++;o.searchLength=c}return o},Lyb:function(t,e,o,n,r){var i,a,s,l,u,c=this,f=c.kj,h=0,p={searchArray:Array(n),searchLength:1},d={searchArray:Array(f.getColumnCount()-r),searchLength:1};for(i=e;i<o;i++)p=c.Kyb(i,t.col,p,"left"),d=c.Kyb(i,t.col+t.colCount-1,d,"right");for(;c.Jyb(o+h,t.col,1,t.colCount);){for(a=!0,s=!1,p=c.Kyb(o+h,n,p,"left"),d=c.Kyb(o+h,r,d,"right"),l=n-1;l>=n-p.searchLength;l--)if(c.Hyb(o+h,l)){h++,a=!1;break}if(a){for(u=r+1;u<=r+d.searchLength;u++)if(c.Hyb(o+h,u)){h++,s=!0;break}if(!s)return h}}return h},Myb:function(t){for(var e=0;this.Iyb(t.row+t.rowCount+e,t.col,1,t.colCount);)e++;return e},Nyb:function(t){var e,o,n,r,i=this;return i.Iyb(t.row+t.rowCount,t.col,1,t.colCount)?i.Myb(t):(n=t.row-2,r=t.row+t.rowCount,1===t.colCount?o=e=t.col:(e=t.col,o=t.col+t.colCount-1),i.Lyb(t,n,r,e,o))},cyb:function(){var t,e,o,n=this,r=n.kj,i=r.mm.A$,a=n.Nyb(i);0!==a&&(t=h(i.row+i.rowCount,i.col,a,i.colCount),n.dJ=3,n.A_=t,e=n.l0(),o=n._$,r.wu().execute({cmd:"fill",sheetName:r.name(),startRange:i,fillRange:t,autoFillType:e,fillDirection:n.dJ}),!o&&r.parent.options.showDragFillSmartTag&&4!==n.$$&&n.C0(n.$$))}}),f.extend(r.oJ.prototype,{gJ:function(t,e){var o,n=this.kj,i=t.x,a=t.y,s=E(t),l=F(t),u=n.Ix(),c=n.am(),f=4,h=-2.5;return e>2007&&(f=5,h=-3),o=new r.Rect(-4,-4,f,f),-1===u.col?(o.x=c.kt,o.y=a+l+h):-1===u.row?(o.x=i+s+h,o.y=c.nt):(o.x=i+s+h,o.y=a+l+h),o},eJ:function(t,e,o,n,i){var a,s,l=this,u=l.kj,c=u.am(),f=u.parent,h=f&&f.Vv,p=l.gJ(n,h),d=p.x,g=p.y,m=E(p),y=F(p),v=c.Ft(e,o);i&&!p.intersectRect(i)||p.intersectRect(v)&&(a=-1.5,h>2007&&(a=-1),(s=new r.Rect(d+a,g+a,m+2,y+2)).x=C(s.x,v.x),s.y=C(s.y,v.y),l.dm(s),t.save(),i&&!i.containsRect(p)&&(t.rect(i.x,i.y,E(i),F(i)),t.clip()),t.beginPath(),t.fillStyle=r.Rm.Om(u,u.getSelectionBorderColor()),t.fillRect(d,g,m,y),l.rH=new r.Rect(p.x,p.y,4,4),t.beginPath(),t.restore())},RI:function(t,e){var o=e.x,n=e.y,r=o+E(e),i=n+F(e);j(t,o,n,r,n),j(t,o,i,r,i),j(t,o,n,o,i),j(t,r,n,r,i)},NI:function(t,e){var o,n,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=g.mm.gA,y=m.hitTarget;m&&y&&(o=m.hitCol,n=m.hitRow,i=g.mm.OH,a=g.OI,t.save(),!0!==i||-1!==m.row&&-1!==m.col?(a&&(s=new r.Rect(a.x-2,a.y-2,E(a)+4,F(a)+4),d.dm(s,e),d.im(g.Ix(),e)),t.rect(e.x,e.y,E(e),F(e)),t.clip(),t.beginPath(),d.RI(t,m)):-1===m.row&&-1!==m.col?((l=g.Hr(0).findCol(o))||(l=g.Hr(1).findCol(o)),l||(l=g.Hr(2).findCol(o)),l&&(u=l.x,c=E(l),m.col=o,y.x>u+c/2&&(m.col<g.cr()||m.col===g.dr())&&(u=l.x+E(l),m.col++),a&&0===E(a)||(a=g.mm.gA),a&&(s=new r.Rect(a.x-2,a.y-2,E(a)+4,F(a)+4),d.dm(s,e),d.im(g.Ix(),e)),g.QI=new r.Rect(u,m.y,0,F(m)),t.rect(e.x,e.y,E(e),F(e)),t.clip(),t.beginPath(),j(t,u,m.y,u,m.y+F(m)))):-1!==m.row&&-1===m.col&&((f=g.Gr(0).findRow(n))||(f=g.Gr(1).findRow(n)),f||(f=g.Gr(2).findRow(n)),f&&(h=f.y,p=F(f),m.row=n,y.y>h+p/2&&(m.row<g.hr()||m.row===g.ir())&&(h=f.y+F(f),m.row++),a&&0===F(a)||(a=g.mm.gA),a&&(s=new r.Rect(a.x-2,a.y-2,E(a)+4,F(a)+4),d.dm(s,e),d.im(g.Ix(),e)),g.QI=new r.Rect(m.x,h,E(m),0),t.rect(e.x,e.y,E(e),F(e)),t.clip(),t.beginPath(),j(t,m.x,h,m.x+E(m),h))),t.beginPath(),t.restore())},QH:function(){var t,e,o,n,i,a,s,l,u,c,f,h=this,p=h.kj,d=p.yt,g=p.mm.MI;d&&d.dragInfo&&g&&(t=h.bm(),e=p.am(),o=p.mm.gA,n=p.cm(g),i=p.frozenTrailingColumnCount(),a=p.frozenTrailingRowCount(),s=p.getColumnCount()-i,l=p.getRowCount()-a,u=e.Ft(1,1),i>0&&g.col+g.colCount<=s&&n.x+E(n)>u.x+E(u)&&n.intersectRect(u)&&(n=n.getIntersectRect(u)),a>0&&g.row+g.rowCount<=l&&n.y+F(n)>u.y+F(u)&&n.intersectRect(u)&&(n=n.getIntersectRect(u)),c=new r.Rect(e.kt,e.nt,e.lt+e.js,e.ot+e.gs),E(n)>0&&F(n)>0?(o.x=n.x,o.y=n.y,o.width=E(n)-1,o.height=F(n)-1,h.NI(t,c)):0!==E(n)&&0!==F(n)||(o.x=n.x,o.y=n.y,o.width=E(n),o.height=F(n),h.NI(t,c)),f=p.mm.OH,p.OI=!0===f?p.QI:new r.Rect(o.x,o.y,E(o),F(o)))}})},"./dist/plugins/fill/fill-ui.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function G(t,e,o,n,r,i){var l=t.CH,u=l?"160px":"150px",f=l?"25px":"20px",h=a(s("div")).css([S,"min-width",x,"padding",A],["block",u,f,0,0]).addClass("gc-smartMenu-item-default "+o+" ui-state-default"+c),p=a(s("div")).addClass(y).appendTo(h),d=a(s("div")).addClass("gc-menu-item-text").appendTo(h),g=a(s("input")).attr({id:e,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(p);return a(s("span")).text(n).appendTo(d),i?(p.addClass(m),g.prop("checked","checked")):g.prop("checked",""),h}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("./dist/plugins/fill/fill.ns.js"),a=r.GC$,s=r.Ul.Nl,l=r.Ul.vl,u=a(document),c=" btn btn-default",h="gc-fill-type-item",p="gc-fill-menu-container",d=(f="ui-state-hover ")+"gc-smartMenu-item-hover",g=f+"gc-smart-tag-hover",m="ui-icon ui-icon-check gc-check-image",y="gc-menu-item-input",C="ui-state-active gc-smart-tag-active",v="gc-tag-container",b="float",w="left",T="top",S="display",x="height",A="margin",I="change",R="input[type=radio]",M="mouseover",k="mouseout",N="click",O="fillTypeChanged",D="keydown.ui-fill",F=new n.Common.ResourceManager(i.SR),E=F.getResource.bind(F),j=function(t){function e(e,o){var n,r=t.call(this,e,l(o.parent.qo))||this;return r.kj=o,r.v_=a("."+v),(n=r.w_=r.yo()).addClass(p),G(o,"smartMenuCopyCells",h,E().CopyCells,"0",!0).appendTo(n),G(o,"smartMenuFillSeries",h,E().FillSeries,"1").appendTo(n),o.xUc||(G(o,"smartMenuFillFormattingOnly",h,E().FillFormattingOnly,"2").appendTo(n),G(o,"smartMenuFillWithoutFormatting",h,E().FillWithoutFormatting,"3").appendTo(n)),r}return L(e,t),e.prototype.Ao=function(){t.prototype.Ao.call(this)},e.prototype.QQ=function(){var t=this;a("."+h).bind(M,(function(){a(this).addClass(d)})).bind(k,(function(){a(this).removeClass(d)})).bind(N,(function(){var e,o=a(this),n=t.v_,r=o.find(R),i=r[0];i.checked=!0,r.trigger(I),n.trigger(N),n.trigger(k),o.removeClass(d),e=parseInt(a(i).attr("value"),10),t.x_(e)})),t.w_.find(R).bind(I,(function(){a("."+y).removeClass(m),a(this).parent().addClass(m)}))},e.prototype.y_=function(){a("."+h).unbind(M).unbind(k).unbind(N),this.w_.find(R).unbind(I)},e.prototype.x_=function(t){var e=this,o=e.kj,n=o.mm;if(e.z_!==t){e.z_=t,o.U$=!0,o.suspendEvent();try{r.Commands.undo.execute(o.parent,{sheetName:o.name()})}finally{o.resumeEvent()}o.U$=!1,o.wu().execute({cmd:"fill",sheetName:o.name(),startRange:n.A$,fillRange:n.A_,autoFillType:t,fillDirection:n.dJ}),e.v_.trigger(O,t)}},e.prototype.MQ=function(){return!!a("."+p).length},e}(r.Go),P=function(t){function e(e,o,n){var r,i=t.call(this,e,l(o.parent.qo))||this;return i.kj=o,i.B_=n,r=i.C_=i.yo().addClass("gc-smart-tag-default "+v+" gc-no-user-select ui-widget-header"+c),i.D_=a(s("div")).attr("class","fillSmartTag").css(b,w).appendTo(r),i.E_=a(s("div")).attr("class","fillSmartTagDown").css([b,S],[w,"none"]).appendTo(r),i}return L(e,t),e.prototype.F_=function(t,e,o){var n=this,r=n.kj.CH,i=a(e),s=n.G_,l=n.E_,u=r?"38px":"32px",c=r?"24px":"18px";s&&s.MQ()||(t?i.addClass(g):i.removeClass(g),i.css(["width",x],[t?u:c,c]),o||(t?l.show():l.hide()))},e.prototype.H_=function(){var t=this,e=t.C_,o=r.Ul.rl(),n=r.Ul.Ml.safari&&(o.ipad||o.iphone);e.bind(M,(function(){t.F_(!0,this,n)})).bind(k,(function(){t.F_(!1,this,n)})),e.bind(N,(function(){var e,o,r=a(this),i=t.G_,s=t.E_;i&&i.MQ()?(n&&s.hide(),r.removeClass(C),t.I_()):(n&&s.show(),r.addClass(C),t.J_(),(o=(e=t.w_)&&e.find(R)[t.B_.fillType])&&!o.checked&&(o.checked=!0,a(o).trigger(I)))})),u.bind(D,(function(e){27===e.keyCode&&(t.G_&&t.G_.MQ()?t.I_():t.close(),r.Ul.nl(e))}))},e.prototype.OT=function(){var t=this,e=t.C_,o=t.B_,n=t.kj.CH,r=n?"3px":"0px",i=n?"24px":"18px";e&&(e.css([w,T],[o.x,o.y]),t.Ao(),t.H_(),t.D_.css(A,r),t.E_.css(x,i),t.hZ())},e.prototype.J_=function(){var t,e,o,n,r,i,a,s=this,l=s.kj;s.G_||(s.G_=new j(l.parent.xv(),l),s.w_=s.G_.yo()),e=(t=s.C_).css(w),o=t.css(T),n=parseFloat(o),i=s.G_,a=s.B_,i.z_=a.fillType,isNaN(n)||(r=n+t.height()+2),s.w_.css([w,T],[e,r]),i.Ao(),i.QQ(),i.v_.unbind(O).bind(O,(function(t,e){a.fillType=e}))},e.prototype.I_=function(){var t=this.G_;t&&(t.y_(),t.close())},e.prototype.hZ=function(){var t=this.G_,e=this.C_;t&&(t.MQ()&&e.trigger(N),e.trigger(k))},e.prototype.close=function(){var e,o=this.kj;this.hZ(),u.unbind(D),t.prototype.close.call(this),(e=o.Xs)&&(e.style.cursor="default"),o&&o.zt()},e}(r.Go),e.K_=P},"./dist/plugins/fill/fill.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/plugins/fill/drag-fill.js"),o("./dist/plugins/fill/fill-event.js"),n(o("./dist/plugins/fill/fill-ui.js")),n(o("./dist/plugins/fill/fill.js")),n(o("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function Z(t){return!Y(t)&&u.Na(t)}function Y(t){return"string"==typeof t}function K(t,e){return-1!==t.lastIndexOf(e)}function Q(t){var e=[t];return e.rowCount=1,e.colCount=C(t),e}function $(t){return t}function tt(t,e,o,r){var i=Q(e),a=Q(o),s=Q([r]),l=t?n.Common.qc(i,a,s,!0,$,c,c,c):n.Common.sc(i,a,s,!0,c,c,c),u=l&&l[0][0];return typeof u===T?n.Common.o.Lma(u,13):u}function et(t){return t.toLowerCase()}function ot(t){var e,o=t.length,n=1;if(o>1)for(n=t[1]-t[0],e=2;e<o;e++)if(n!==t[e]-t[e-1]){n=0;break}return n}function nt(t,e){return t>0?(t-1)%e:e-Math.abs(t)%e-1}function rt(t){for(var e="",o=0;o<t;)e+="0",o++;return e}function it(t,e){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())}function at(t,e){var o,n=t.length,r=!0;for(o=2;o<n&&(r=e===it(t[o-1],t[o]));o++);return r}function st(t){return"0"===t[0]}function lt(t,e,o){var n,r,i,a,s,l=o?1:2,u=o?2:1;return e.every((function(e){return!!(n=e.match(t.Yyb))&&(r=n[l],(s=r.length)>t.Zyb&&st(r)&&(t.Zyb=s),i=parseInt(r,10),a=n[u],d(t.Qyb)&&(t.Qyb=a),a!==t.Qyb?(t.$yb=!0,t.Qyb=c,t.Pyb=[]):t.Pyb.push(i),!0)}))}function ut(t){t.forEach((function(t){t&&t.dispose()}))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("@grapecity/js-calc"),a=o("SheetsCalc"),s=o("./dist/plugins/fill/fill.ns.js"),l=!!i,u=n.Common.j,c=null,f=void 0,h=Math.floor,p=r.kf,d=u.Fa,g=u.Pa,m=n.Common.k,y=m.Eb,C=m.ac,v=n.Common.l,b=v.Ra,w=v.Xb,T="number",S="date",x="string",A=new n.Common.ResourceManager(s.SR),I=A.getResource.bind(A),R=n.Common.CultureManager,function(t){t[t.copyCells=0]="copyCells",t[t.fillSeries=1]="fillSeries",t[t.fillFormattingOnly=2]="fillFormattingOnly",t[t.fillWithoutFormatting=3]="fillWithoutFormatting",t[t.clearValues=4]="clearValues",t[t.auto=5]="auto"}(e.AutoFillType||(e.AutoFillType={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.up=2]="up",t[t.down=3]="down"}(e.FillDirection||(e.FillDirection={})),function(t){t[t.column=0]="column",t[t.row=1]="row"}(e.FillSeries||(e.FillSeries={})),function(t){t[t.direction=0]="direction",t[t.linear=1]="linear",t[t.growth=2]="growth",t[t.date=3]="date",t[t.auto=4]="auto"}(e.FillType||(e.FillType={})),function(t){t[t.day=0]="day",t[t.weekday=1]="weekday",t[t.month=2]="month",t[t.year=3]="year"}(e.FillDateUnit||(e.FillDateUnit={})),M=function(){function t(t){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=c,this.Pyb=[],this.Qyb=c,this.g_=d(t)?-1:t}return t.prototype.h_=function(){return C(this.e_)},t.prototype.Ey=function(){var t,e,o=this,n=[],r=o.f_;for(t=0;t<C(r);t++)e=r[t],n.push("object"===o.Nc?o.Wh(e):e);return n},t.prototype.i_=function(){var t,e,o,n=this.e_;if(C(n)>0){for(e=[],o=void 0,-1===(t=this.g_)&&(t=n[0]),o=0;o<C(n);o++)e[o]=n[o]-t+1;return e}return c},t.prototype.j_=function(){var t=this.f_;return C(t)?t:c},t.prototype.Eb=function(t,e,o){if(!Z(o))throw Error(I().Exp_NumberOnly);var n=this;d(n.Nc)&&(n.Nc=o instanceof Date?S:T),y(n.e_,t,e),y(n.f_,t,g(o))},t.prototype.Sb=function(t,e){var o=this,n=d(o.Nc);Z(e)?(n&&(e instanceof Date?o.Nc=S:o.Nc=T),o.f_.push(g(e))):n&&(o.Nc=Y(e)?x:"default"),o.e_.push(t),o.Oyb.push(e)},t.prototype.k_=function(t){return this.Nc===S?this.Wh(t):t},t.prototype.Wh=function(t){var e=c;if(t instanceof Date)e=t;else if(i)try{e=i.Convert.Wh(t)}catch(o){e=t}return e},t}(),k=function(){function t(t){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=t}return t.prototype.no=function(){this.kj=c},t.prototype.Uyb=function(){var t=this.kj;return t.parent&&t.parent.Txb()||[]},t.prototype.Vyb=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d,g=t.length,m=!1;if(t&&g>0)for(e=et(t[0]),o=this.Uyb(),n=void 0,r=void 0,i=void 0,a=void 0,s=void 0,l=void 0,n=0;n<o.length;n++)if(i=(r=o[n]).map((function(t){return et(t)})),(a=i.indexOf(e))>=0){for(s=a,u=i.length,c=void 0,f=void 0,h=void 0,p=1;p<g;p++){if(f=et(t[p]),!((c=i.indexOf(f))>=0)){m=!1;break}if(h=c-s+u,l){if(l!==h){m=!1;break}}else m=!0,l=h,s=c}if(d=1===g,m||d){m=!0,this.Ryb=a,this.Syb=r,this.Tyb=d?1:l;break}}return m},t.prototype.ge=function(t){var e=this.Syb,o=this.Ryb,n=this.Tyb,r=e.length;return e[(o+n*nt(t,r))%r]},t}(),N=function(){function t(){this.Uk="",this.kja="",this.Tyb=0,this.Xyb=1,this._padding=""}return t.prototype.ge=function(t){var e=this.Tyb*(t-1)+this.Xyb,o=this._padding.length,n=""+Math.abs(e),r=n.length,i=this._padding+n,a=i.length;return n=r>o?n:i.substr(a-o),this.Uk+n+this.kja},t}(),O=function(){function t(){}return t.prototype.match=function(t){return!1},t.prototype.getTargetValue=function(t,e,o,n,r){},t.prototype.resetProp=function(){},t.prototype._yb=function(t,e){return t.indexOf(e+1)},t.prototype.dispose=function(){},t}(),D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.azb=0,e.Nc=S,e}return X(e,t),e}(O),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return X(e,t),e.prototype.match=function(t){var e=this.azb=it(t[0],t[1]),o=function(t){return t.every((function(t){return 1===t.getDate()}))}(t),n=t.length,r=!0;return o&&n>2&&(r=at(t,e)),o&&r},e.prototype.getTargetValue=function(t,e){var o=t.Oyb[0],n=o.getFullYear(),r=e-1,i=o.getMonth()+this.azb*r;return new Date(n+parseInt(i/12,10),i%12,1)},e}(D),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return X(e,t),e.prototype.match=function(t){var e=this.azb=it(t[0],t[1]),o=function(t){return t.every((function(t){var e=t.getFullYear(),o=t.getMonth();return t.getDate()===new Date(e,o+1,0).getDate()}))}(t),n=t.length,r=!0;return o&&n>2&&(r=at(t,e)),o&&r},e.prototype.getTargetValue=function(t,e){var o=t.Oyb[0],n=o.getFullYear(),r=e-1,i=o.getMonth()+this.azb*r,a=n+parseInt(i/12,10),s=i%12;return new Date(a,s,function(t,e){return new Date(t,e+1,0).getDate()}(a,s))},e}(D),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return X(e,t),e.prototype.match=function(t){var e,o,n,r,i,a=!1;return function(t){return t.every((function(t){var e=t.getHours(),o=t.getMinutes(),n=t.getSeconds();return 0!==e||0!==o||0!==n}))}(t)||(e=this.azb=it(t[0],t[1]),o=function(t){var e=0,o=t.every((function(t){var o=t.getDate();return e||(e=o),e===o}));return o?e:0}(t),n=o>0,r=t.length,i=!0,this.bzb=o,n&&r>2&&(i=at(t,e)),a=n&&i),a},e.prototype.getTargetValue=function(t,e){var o=t.Oyb[0],n=o.getFullYear(),r=e-1,i=o.getMonth()+this.azb*r,a=n+parseInt(i/12,10);return new Date(a,i%12,this.bzb)},e}(D),P=function(t){function e(){var e=t.call(this)||this;return e.Yyb=c,e.Pyb=[],e.Qyb=c,e.$yb=!1,e.Zyb=0,e.Nc=x,e.t_=!1,e.czb=!1,e.dzb=new N,e}return X(e,t),e.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=c,this.$yb=!1,this.t_=!1,this.czb=!1},e.prototype.getInternal=function(t){var e,o,n=!1,r=t[0];for(o=1;o<t.length;o++)if(e=t[o],1!==Math.abs(e-r)){n=!0;break}return n},e}(O),L=function(t){function e(e){var o=t.call(this)||this;return o.ezb=new k(e),o}return X(e,t),e.prototype.dispose=function(){var t=this;t.ezb&&(t.ezb.no(),t.ezb=c)},e.prototype.match=function(t){return this.ezb.Vyb(t)},e.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb.length,s=this._yb(o,n),l=c;return-1!==s&&(i=a*r+s+1,l=this.ezb.ge(i)),l},e}(P),G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^\d+$/,e}return X(e,t),e.prototype.match=function(t){var e,o,n=this;return t.every((function(t){return!!t.match(n.Yyb)&&((o=t.length)>n.Zyb&&st(t)&&(n.Zyb=o),e=parseInt(t,10),n.Pyb.push(e),!0)}))},e.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb,s=this.dzb,l=ot(this.Pyb),u=a.length,f=0!==l,h=f?0:nt(e,u),p=this._yb(o,n),d=c;return this.t_=f,this.czb=this.getInternal(t.e_),-1!==p&&(s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=rt(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},e}(P),B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^(.*\D+)(\d+)$/,e}return X(e,t),e.prototype.match=function(t){return lt(this,t,!1)},e.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb,s=this.dzb,l=ot(this.Pyb),u=a.length,f=0!==l,h=f?0:nt(e,u),p=this._yb(o,n),d=c;return this.t_=f,this.czb=this.getInternal(t.e_),-1!==p&&(s.Uk=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=rt(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},e}(P),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^(\d+)(\D+.*)$/,e}return X(e,t),e.prototype.match=function(t){return lt(this,t,!0)},e.prototype.getTargetValue=function(t,e,o,n,r){var i,a=t.Oyb,s=this.dzb,l=ot(this.Pyb),u=a.length,f=0!==l,h=f?0:nt(e,u),p=this._yb(o,n),d=c;return this.t_=f,this.czb=this.getInternal(t.e_),-1!==p&&(s.kja=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=rt(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},e}(P),V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^(.*\D+)(\d+)(\D+.*)$/,e}return X(e,t),e.prototype.resetProp=function(){t.prototype.resetProp.call(this),this.iJc=c},e.prototype.match=function(t){var e,o,n,r,i,a,s=this;return t.every((function(t){return!!(e=t.match(s.Yyb))&&(o=e[2],(a=o.length)>s.Zyb&&st(o)&&(s.Zyb=a),n=parseInt(o,10),r=e[1],d(s.Qyb)&&(s.Qyb=r),i=e[3],d(s.iJc)&&(s.iJc=i),r!==s.Qyb||i!==s.iJc?(s.$yb=!0,s.Qyb=c,s.iJc=c,s.Pyb=[]):s.Pyb.push(n),!0)}))},e.prototype.getTargetValue=function(t,e,o,n,r){var i,a=this,s=t.Oyb,l=a.dzb,u=ot(a.Pyb),f=s.length,h=0!==u,p=h?0:nt(e,f),d=a._yb(o,n),g=c;return a.t_=h,a.czb=a.getInternal(t.e_),-1!==d&&(l.Uk=a.Qyb,l.kja=a.iJc,l.Tyb=u,l.Xyb=a.Pyb[p],l._padding=rt(a.Zyb),i=f*r+d+1,g=l.ge(i)),g},e}(P),H=["-","_",":",".",","],z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return X(e,t),e.prototype.resetProp=function(){t.prototype.resetProp.call(this),this.jJc=c},e.prototype.match=function(t){var e,o,n,r,i,a,s=this;return t.every((function(t){var l,u,f,h=s.jJc;if(d(h)?H.some((function(e){if(K(t,e))return s.jJc=e,!0})):K(t,h)){if(h=s.jJc,l=t.lastIndexOf(h),r=t.substring(0,l+1),d(s.Qyb))s.Qyb=r;else if(s.Qyb!==r)return!1;if(u=t.substr(l+1),f=/^(\d+)(\D+.*)$/,e=u.match(f))return o=e[1],(a=o.length)>s.Zyb&&st(o)&&(s.Zyb=a),n=parseInt(o,10),i=e[2],d(s.iJc)&&(s.iJc=i),i!==s.iJc?(s.Qyb=c,s.iJc=c,s.Pyb=[],!1):(s.Pyb.push(n),!0)}return!1}))},e}(V),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return X(e,t),e.prototype.getTargetValue=function(t,e,o){return tt(!0,t.j_(),o,e)},e}(O),W=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.t_=!0,e}return X(e,t),e.prototype.getTargetValue=function(t,e,o,n){var r=t.Oyb;return r[nt(e,r.length)]},e}(O),q=function(){function t(t){var e,o,n,r,i,a,s=this;s.fzb=[new F,new E,new j],s.hzb=new U,s.izb=new W,e=R.culture(),o=R.q4(e).isJCKCulture,n=new L(t),r=new G,i=new B,a=new _,s.gzb=o?[n,r,new z,i,a,new V]:[n,r,i,a]}return t.prototype.getRule=function(t,e){var o,n,r,i=[],a=this.izb;for(t===S?(i=this.fzb,a=this.hzb):t===x?i=this.gzb:t===T&&(a=this.hzb),o=0;o<i.length;o++)if(r=void 0,(n=i[o]).resetProp(),n.match(e)){if(r=n.$yb,d(r)||!1===r)return n;if(!0===r)return a}return a},t.prototype.no=function(){var t=this;t.fzb&&(ut(t.fzb),t.fzb=c),t.gzb&&(ut(t.gzb),t.gzb=c),t.hzb&&(t.hzb.dispose(),t.hzb=c),t.izb&&(t.izb.dispose(),t.izb=c)},t}(),e.Gyb=q,J=function(){function t(t){this.kj=t,this.AX=!1,this.cLb=[]}return t.prototype.D$=function(t,e,o,n,r){var i=t?1:2;d(n)&&d(r)?this.E$(e,o,i):this.E$(e,o,i,n,r,c)},t.prototype.E$=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,v,b,w,T,S,x,A=this,R=A.kj,M=R.Tq(t),k=M.row,N=M.col,O=M.rowCount,D=M.colCount;if(R.ITa.MTa(k,N,O,D))throw Error(I().Exp_RangeContainsMergedCell);for(h=0,d=(p=1===e)?D:O,g=p?k:N,m=p?k+O:N+D,y=(f=arguments.length>3)?1:d,b=(v=this.kj.mm.A$).row===k&&v.rowCount===O&&v.col>N||v.col===N&&v.colCount===D&&v.row>k,a=g;a<m;a++)if(w=b&&f?N+D-1:N,T=b&&f?k+O-1:k,(S=p?A.l_(a,w,1,y,e):A.l_(T,a,y,1,e))&&S.h_())for(u=S.e_[0],f?(c=b?S.f_[C(S.f_)-1]:S.f_[0],s=A.m_(b,c,d,o,n,r,i),b&&(h=d-C(s),u=S.e_[C(S.e_)-1])):s=A.n_(S,d,o),l=0;l<C(s);l++)x=S.k_(s[l]),p?A.o_(R,a,u,a,N+h+l,x,o):A.o_(R,u,a,k+h+l,a,x,o)},t.prototype.l_=function(t,e,o,n,r){for(var i,a=c,s=this.kj,l=1===r,u=l?e+n-1:t+o-1,f=l?e:t;u>=f;)Z(i=l?s.getValue(t,u):s.getValue(u,e))&&(a||(a=new M(f)),a.Eb(0,u,i)),u--;return a},t.prototype.m_=function(t,e,o,n,r,i,a){var s,l,u,c=[],f=e,h=r>=0,p=d(i);for(s=0;s<o;s++)l=f>=i,u=f<=i,t&&(p||h&&l||!h&&u)?(c.unshift(f),1===n?f-=r:2===n?f/=r:3!==n||d(a)||(f=this.p_(!0,a,e,f,r,s+1))):!t&&(p||h&&u||!h&&l)&&(c.push(f),1===n?f+=r:2===n?f*=r:3!==n||d(a)||(f=this.p_(!1,a,e,f,r,s+1)));return c},t.prototype.n_=function(t,e,o){var n,r=[],i=1===o;if(i||2===o){for(1===t.h_()&&t.Sb(t.e_[0]+1,i?t.k_(t.f_[0]+1):t.Ey()[0]),n=0;n<e;n++)r.push(tt(!!i,t.j_(),t.i_(),n+1));return r}return c},t.prototype.B$=function(t,e,o,n,r,i){var a,s=this,l=s.kj,u=l.ITa,c=l.Tq(t),f=c.row,h=c.col,p=c.rowCount,d=c.colCount,g=l.Tq(l.mm.A$),m=g.row,y=g.col;if(u.qu(m,y,g.rowCount,g.colCount)||u.qu(f,h,p,d))throw Error(I().Exp_ChangeMergedCell);return a=s.q_(g,p,d,e,o,!(f<m||h<y),n,r,i),s.mYc&&s.mYc.xr&&(s.mYc.xr.reFilter(),delete s.mYc),a},t.prototype.q_=function(t,e,o,n,r,i,a,s,l){var u,d,g,m,y=this,C=i?1:-1,v=t.row,b=t.col,w=t.rowCount,T=t.colCount;if(1===n){if(u=h(o/T),d=o%T,!r)for(m=1;m<u;m++)g=p(v,b+m*C*T,w,T),y.r_(t,g,n,4,r,i,f,f,f,a,s);if(r&&u>1&&0===d&&(u-=1,d=T),u>0&&d>0)return g=p(v,i?b+u*T:b-u*T+T-d,w,d),y.r_(t,g,n,4,r,i,c,i?0:T-d,f,a,s)}else{if(u=h(e/w),d=e%w,y.AX||(g=p(v+C*w,b,e-w,o),y.dLb(t,g,C,l)),!r)for(m=1;m<u;m++)g=p(v+m*C*w,b,w,T),y.r_(t,g,n,4,r,i,c,c,!0,a,s);if(r&&u>1&&0===d&&(u-=1,d=w),u>0&&d>0)return g=p(i?v+u*w:v-u*w+w-d,b,d,T),y.r_(t,g,n,4,r,i,i?0:w-d,c,!0,a,s)}},t.prototype.r_=function(t,e,o,n,r,i,a,s,l,u,f){var h,p,g,m,y,C,v,b,w,A,I,R,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,K,Q=this,$=Q.kj,tt=1===o,et=tt?t.row:t.col,ot=tt?t.col:t.row,nt=tt?e.row:e.col,rt=tt?e.col:e.row,it=tt?t.rowCount:t.colCount,at=tt?t.colCount:t.rowCount,st=tt?e.colCount:e.rowCount;for(m=0;m<it;m++){for(C=c,v=c,b=0,I=w=et+m,R=A=nt+m,k=(tt?s:a)||0,N=tt?0:k,O=tt?c:l,D=c;b<at;)if(j=c,P=F=ot+b,L=E=rt+b-k,tt||(w=F,F=I,A=E,E=R),g=$.ITa.findSpan(w,F),(h=$.getFormula&&$.getFormula(w,F))&&""!==h||(j=$.getValue(w,F)),(G=Q.AX)&&d(D)&&(D=!1===i?$.getValue(ot+at-1,F):$.getValue(w,F)),G||4!==n||!Z(j)&&!Y(j)||(C||(C=new M),p=Z(j)?j instanceof Date?S:T:x,v||(v=p),v!==p))if(!G&&j&&C&&C.h_()){if(y=Q.s_(tt,t,e,I,R,C,r,i,N,O,u,f),r&&y)return y;C=c,v=c}else{if(G||!g||g&&(tt?g.row:g.col)===I)if(B=L===rt+st-1,_=G?D:j,r){if(G)return _;if(g&&B||!g&&(B&&i||!i&&L===rt))return j}else L<rt+st&&L>=rt&&(G||tt||!tt&&!(l&&$.Ps&&$.Ps(L)))&&(G&&-1!==Q.cLb.indexOf(A)||Q.o_($,w,F,A,E,_,n,u,f));g?b+=tt?g.colCount:g.rowCount:b++}else C.Sb(P,j),g?b+=tt?g.colCount:g.rowCount:b++;if(Q.AX)for(V=t.row,H=t.col,z=t.rowCount,U=t.colCount,W=void 0,q=void 0,J=!1===i?-1:1,X=1;X<z;X++)for(W=V+J*X,K=0;K<U;)q=H+K,-1===Q.cLb.indexOf(W)&&Q.o_($,V,H,W,q,D,n,u,f),K++;if(C&&C.h_()&&(y=Q.s_(tt,t,e,I,R,C,r,i,N,O,u,f),r&&!d(y)))return y}return c},t.prototype.dLb=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,C=this,v=C.kj,b=v.tables,w=t.union(e),T=w.row,S=w.rowCount,x=t.row,A=t.col,I=t.rowCount,R=t.colCount;if(b)for(r=0,i=b.s$(x,A,I,R);r<i.length;r++){if(s=(a=i[r]).cj,l=a.dj,u=S,n)for(c=0,f=n;c<f.length;c++)if((h=f[c]).row===s&&h.col===l){u=h.rowCount,C.mYc=a;break}if(p=a.xr,d=C.cLb,g=void 0,p&&p.isFiltered&&p.isFiltered()){for(m=0;m<u;m++)g=T+o*m,p.isRowFilteredOut(g)&&C.cLb.push(g);if(d.length>0){C.AX=!0;break}}}if(y=v.xr,!0!==C.AX&&y&&y.isFiltered&&y.isFiltered()){for(d=C.cLb,g=void 0,m=0;m<S;m++)g=T+o*m,y.isRowFilteredOut(g)&&C.cLb.push(g);d.length>0&&(C.AX=!0)}},t.prototype.o_=function(t,e,o,n,r,i,s,u,h){var p,d,g,m=t.ITa;l&&(t.hasFormula(e,o)||t.hasFormula(n,r))&&(t.setFormula(n,r,c),0!==s&&4!==s||(p=t.Bj(),t.getFormula(e,o)&&a.CalcOperatorAdjustor.copyFormula(p,e,o,p,n,r,1,1,f,!0))),t.setValue(n,r,i),g=h?0:64,u&&(g|=128),g|=1024,t.ax(e,o,n,r,1,1,g,f,!0),t.removeSpan(n,r,3),(d=m.findSpan(e,o))&&e===d.row&&o===d.col&&t.Sq(n,r,d.rowCount,d.colCount,3)},t.prototype.s_=function(t,e,o,n,r,i,a,s,l,u,f,h){var p,d,g,m,y,C,v,b,w,T,A,I,R,M,k,N,O=this,D=O.kj,F=t?o.col:o.row,E=t?e.col:e.row,j=t?o.colCount:o.rowCount,P=t?e.colCount:e.rowCount;if(l=l||0,y=i.h_(),C=(F-E-l)/P,v=O.t_(i.e_,i.f_),b=i.Nc,v){for(g=[],d=0;d<y;d++)g[d]=d+1;p=y}else m=i.e_[0],p=i.e_[y-1]-m+1,1===y&&b!==x&&i.Sb(i.e_[0]+1,i.k_(i.f_[0]+1)),g=i.i_();for(d=0;d<p;d++)if(w=i.Oyb,T=void 0,A=void 0,I=void 0,b!==S&&b!==x||(T=D.Fyb&&D.Fyb.getRule(b,w)),T?(A=T.getTargetValue(i,p*C+d+1,g,d,C),v=T.t_?T.t_:v,R=!!T.czb&&T.czb,I=v&&!R):(A=tt(!0,i.j_(),g,p*C+d+1),I=v),M=F+j-1,N=(k=I?i.e_[d]:m+d)+C*P,a){if(v&&(s&&N===M||!s&&N===F)||!v&&N+l===M)return i.k_(A)}else N<F+j&&N>=F&&(t?O.o_(D,n,k,r,N,i.k_(A),4,f,h):u&&D.Ps&&D.Ps(N)||O.o_(D,k,n,N,r,i.k_(A),4,f,h));return c},t.prototype.t_=function(t,e){var o,n,r,i=C(e);if(i<=1||C(t)!==i)return!1;for(o=t[1]-t[0],n=e[1]-e[0],r=2;r<i;r++)if(t[r]-t[r-1]!==o||e[r]-e[r-1]!==n)return!1;return!0},t.prototype.C$=function(t,e){var o,n=this.kj,r=n.ITa.getSpans(),i=n.Tq(t),a=i.row,s=i.col,l=i.rowCount,u=i.colCount;o=0===e?p(a,s+u-1,l,1):1===e?p(a,s,l,1):p(2===e?a+l-1:a,s,1,u),(o=n.su(r,o))&&this.u_(o,a,s,l,u,e)},t.prototype.u_=function(t,e,o,n,r,i){var a,s,l,u,c,f,d,g,m=t.row,y=t.col,C=t.rowCount,v=t.colCount,b=this.kj.ITa;if(0===i?(g=b.MTa(e,o,n,r-v),f=0,d=-1*v,l=r,u=v,c=1):1===i?(g=b.MTa(e,o+v,n,r-v),f=0,d=v,l=r,u=v,c=1):2===i?(g=b.MTa(e,o,n-C,r),f=-1*C,d=0,l=n,u=C,c=0):(g=b.MTa(e+C,o,n-C,r),f=C,d=0,l=n,u=C,c=0),g)throw Error(I().Exp_TargetContainsMergedCells);if(l%u!=0)throw Error(I().Exp_MergedCellsIdentical);for(a=h(l/u),s=1;s<a;s++)this.r_(t,p(m+s*f,y+s*d,C,v),c,0)},t.prototype.p_=function(t,e,o,n,r,i){var a=t?-1:1,s=h(i*r),l=Math.abs(r),u=w(e>1?o:n);if(0===e)u.setDate(u.getDate()+a*r);else if(1===e)for(;l>0;)u.setDate(u.getDate()+a*(r>0?1:-1)),6!==u.getDay()&&0!==u.getDay()&&l--;else 2===e?u.setMonth(u.getMonth()+a*s):u.setFullYear(u.getFullYear()+a*s);return b(u)},t}(),e.z$=J},"./dist/plugins/fill/fill.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/fill/fill.res.en.js");e.SR={en:n}},"./dist/plugins/fill/fill.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CopyCells="Copy Cells",e.FillSeries="Fill Series",e.FillFormattingOnly="Fill Formatting Only",e.FillWithoutFormatting="Fill Without Formatting",e.Exp_NumberOnly="Only works for Numbers",e.Exp_RangeContainsMergedCell="Range should not have merged cells.",e.Exp_TargetContainsMergedCells="Target range should not have merged cells.",e.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",e.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",e.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",e.Exp_ChangeMergedCell="Cannot change part of merged cell.",e.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",e.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",e.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",e.Exp_RangeIsNull="range is null",e.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/filter/filter-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function k(t,e){var o,n;return t?(n=e.tables.findByName(t))&&(o=n.rowFilter()):o=e.rowFilter(),o}function N(t,e,o,n,r){return{sheet:t,sheetName:t.name(),table:e,tableCol:o,filterValues:n,conditionInfo:0===y(n)&&r?r.toJSON():C}}function O(t,e,o,n){return{sheet:t,sheetName:t.name(),col:e,filterValues:o,conditionInfo:0===y(o)&&n?n.toJSON():C}}function D(t,e,o,n,i){var a=o?t-o.range().col:-1;o?e.Wq(r.Events.TableFiltering,N(e,o,a,n,i)):e.Wq(r.Events.RangeFiltering,O(e,t,n,i))}function F(t,e,o,n,i,a){var s=n?e-n.range().col:-1;t.filter(e),n?o.Wq(r.Events.TableFiltered,N(o,n,s,i,a)):o.Wq(r.Events.RangeFiltered,O(o,e,i,a))}function E(t,e){t.suspendPaint();var o=r.Commands.bWa(t.name());return t.ITa.undo(e[o]),t.resumePaint(),!0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/filter/filter-ns.js"),r=o("Core"),i=o("Common"),a=o("./dist/plugins/filter/filter.js"),s=o("ConditionalFormatting"),l=i.Common.j.Fa,i.Common.j.Ba,u=r.Commands.ActionBase,c="sortFilter",f="filterTextSelectAction",h="filterByCondition",p="clearFilter",d="contextmenuFilterForSheet",g="contextmenuFilterForTable",m=r.Commands.h4,y=i.Common.k.ac,C=void 0,v=null,b=new i.Common.ResourceManager(n.SR),w=b.getResource.bind(b),T=function(t){function e(e,o){var n=t.call(this,e,o)||this,r=n;return r.zZ=r.VQ.cmdOption,r.zZ.rowFilter=k(r.zZ.tableName,r.kj),n}return M(e,t),e.prototype.execute=function(){var t,e=this,o=e.zZ.rowFilter,n=e.zZ.colIndex,i=e.zZ.compareFunction,a=e.zZ.isAsc,s=!l(e.zZ.tableName),u=e.zZ.color,c=e.zZ.isBackColor,f={groupSort:e.zZ.groupSort,ignoreHidden:e.zZ.ignoreHidden};e.kj.suspendPaint(),e.kj.ITa.startTransaction();try{u!==C?o.sortColumnByColor(n,a,u,c,f,s):o.eLb(n,a,i,f,s)}finally{t=r.Commands.bWa(e.kj.name()),e.VQ[t]=e.kj.ITa.endTransaction(),e.kj.resumePaint()}},e.prototype.undo=function(){return E(this.kj,this.VQ)},e}(u),r.Commands[c]={canUndo:!0,execute:function(t,e,o){return m(t,T,e,o)}},S=function(t){function e(e,o){var n=t.call(this,e,o)||this,r=n;return r.zZ=r.VQ.cmdOption,n}return M(e,t),e.prototype.execute=function(){var t,e,o=this,n=o.zZ.colIndex,i=o.VQ.cmdOption.tableName,a=k(i,o.kj);a&&(i&&(t=o.kj.tables.findByName(i)),o.kj.suspendPaint(),o.kj.ITa.startTransaction(),function(t,e,o){var n,i;o?(i=t-o.range().col,n={sheet:e,sheetName:e.name(),table:o,tableCol:i},e.Wq(r.Events.TableFilterClearing,n)):(n={sheet:e,sheetName:e.name(),col:t},e.Wq(r.Events.RangeFilterClearing,n))}(n,o.kj,t),a.removeFilterItems(n),function(t,e,o){var n,i;o?(i=t-o.range().col,n={sheet:e,sheetName:e.name(),table:o,tableCol:i},e.Wq(r.Events.TableFilterCleared,n)):(n={sheet:e,sheetName:e.name(),col:t},e.Wq(r.Events.RangeFilterCleared,n))}(n,o.kj,t),e=r.Commands.bWa(o.kj.name()),o.VQ[e]=o.kj.ITa.endTransaction(),o.kj.resumePaint())},e.prototype.undo=function(){return E(this.kj,this.VQ)},e}(u),r.Commands[p]={canUndo:!0,execute:function(t,e,o){return m(t,S,e,o)}},x=function(t){function e(e,o){return t.call(this,e,o)||this}return M(e,t),e.prototype.execute=function(){var t,e,o,n,i,a,l,u,c,f=this,h=f.VQ.cmdOption.colIndex,p=f.VQ.cmdOption.checkedValues,d=f.VQ.cmdOption.allValuesLength,g=y(p),m=w().Blanks,C=f.VQ.cmdOption.tableName,b=f.kj,T=k(C,b);if(T){if(C&&(t=b.tables.findByName(C)),b.suspendPaint(),b.ITa.startTransaction(),D(h,b,t,p,v),T.removeFilterItems(h),g!==d){for(e=[],o=0;o<g;o++)i=void 0,a=(n=p[o]).text,l=n.value,u=n.type,a===m&&(a=""),(i=new s.Condition(2))._ps.expected=a,i._ps.compareType=0,i._ps.useWildCards=!1,"date"===u&&(i.jzb=!0,i.Ygc=l),e.push(i);T.addFilterItem(h,e)}F(T,h,b,t,p,v),c=r.Commands.bWa(b.name()),f.VQ[c]=b.ITa.endTransaction(),b.resumePaint()}},e.prototype.undo=function(){return E(this.kj,this.VQ)},e}(u),r.Commands[f]={canUndo:!0,execute:function(t,e,o){return m(t,x,e,o)}},A=function(t){function e(e,o){return t.call(this,e,o)||this}return M(e,t),e.prototype.execute=function(){var t,e,o=this,n=o.VQ.cmdOption.colIndex,i=o.VQ.cmdOption.condition,a=o.VQ.cmdOption.tableName,s=o.kj,u=k(a,o.kj);return l(i)?(s.Os(7,w().invalidCondition),!1):void(u&&(a&&(t=o.kj.tables.findByName(a)),o.kj.suspendPaint(),o.kj.ITa.startTransaction(),D(n,o.kj,t,[],i),u.removeFilterItems(n),u.addFilterItem(n,i),F(u,n,o.kj,t,[],i),e=r.Commands.bWa(o.kj.name()),o.VQ[e]=o.kj.ITa.endTransaction(),o.kj.resumePaint()))},e.prototype.undo=function(){return E(this.kj,this.VQ)},e}(u),r.Commands[h]={canUndo:!0,execute:function(t,e,o){return m(t,A,e,o)}},I=function(t){function e(e,o){return t.call(this,e,o)||this}return M(e,t),e.prototype.execute=function(){var t,e,o,n,i,u=this.kj,c=this.VQ.cmdOption,f=c.selection,h=c.activeRow,p=c.activeCol,d=c.expectedText;u.ITa.startTransaction(),u.rowFilter()?(t=void 0,(o=(e=u.rowFilter()).range).contains(h,p,1,1)?(D(p,u,C,[d],v),t=new s.Condition(s.ConditionType.textCondition,{compareType:0,expected:d}),e.addFilterItem(p,t),F(e,p,u,C,[d],v)):o.row-1!==h||l(e.qZ[p])?(u.rowFilter().unfilter(),u.rowFilter(new a.HideRowFilter(f))):(n=u.getText(o.row,p),D(p,u,C,[d],v),t=new s.Condition(s.ConditionType.textCondition,{compareType:0,expected:n}),e.addFilterItem(p,t),F(e,p,u,C,[d],v))):u.rowFilter(new a.HideRowFilter(f)),i=r.Commands.bWa(u.name()),this.VQ[i]=u.ITa.endTransaction()},e.prototype.undo=function(){return E(this.kj,this.VQ)},e}(u),r.Commands[d]={canUndo:!0,execute:function(t,e,o){return m(t,I,e,o)}},R=function(t){function e(e,o){return t.call(this,e,o)||this}return M(e,t),e.prototype.execute=function(){var t,e,o,n,i,a=this.kj,u=this.VQ.cmdOption,c=u.tableName,f=u.expectedText,h=u.activeCol,p=u.activeRow;a.ITa.startTransaction(),t=k(c,a),e=a.tables.findByName(c),t&&e&&(o=e.range(),e.showHeader()&&o.row===p&&!l(t.qZ[h-o.col])&&(f=a.getText(p+1,h)),D(h,a,C,[f],v),n=new s.Condition(s.ConditionType.textCondition,{compareType:0,expected:f}),t.removeFilterItems(h),t.addFilterItem(h,n),F(t,h,a,C,[f],v),i=r.Commands.bWa(a.name()),this.VQ[i]=a.ITa.endTransaction())},e.prototype.undo=function(){return E(this.kj,this.VQ)},e}(u),r.Commands[g]={canUndo:!0,execute:function(t,e,o){return m(t,R,e,o)}},r.Commands.fVa=function(t){t.register(c,r.Commands[c]),t.register(f,r.Commands[f]),t.register(h,r.Commands[h]),t.register(p,r.Commands[p]),t.register(d,r.Commands[d]),t.register(g,r.Commands[g])}},"./dist/plugins/filter/filter-button-images.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";e.getFilterButtonImageSrc=function(t){return 0===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===t?n+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===t?n+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===t?n+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===t?n+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}},"./dist/plugins/filter/filter-dialog.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt,Yt,Kt,Qt,$t,te,ee,oe,ne,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function Ce(t){return typeof t===It?JSON.stringify(t):r.Common.pc.bc(r.Common.pc.ec(t))}function ve(t,e,o,n){var r;try{if(o.suspendPaint(),!n)return;r={tableName:n.sj?n.sj.name():y,colIndex:t,condition:e},a.h4("filterByCondition",r,o)}finally{o.resumePaint()}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("ConditionalFormatting"),a=o("./dist/plugins/filter/filter.js"),s=o("CellTypes"),l=o("./dist/plugins/filter/filter-button-images.js"),u=o("./dist/plugins/filter/filter-ns.js"),c=r.Formatter.GeneralFormatter,f=r.Common.CultureManager,h=r.Common.l,p=r.Common.j.Ba,d=r.Common.u.Ob,g=r.Common.u.Pb,m=null,y=void 0,C=n.Ul.Nl,v=n.Ul,b=r.Common.k.ac,w=v.nl,T="left",S="top",x="float",A="relative",I="gc-no-user-select",R="gc-filter-dialog-style",M="position",k="gc-ui-filter-subitem-item",N="gc-ui-filter-allDate-item",O="gc-filter-alldates-arrow",E="gc-filter-hover form-control well "+((F="ui-state-hover ")+(D="gc-filter-item-hover")),j="gc-filter-button-hover "+F,P="gc-filter-submenu-check",L="gc-filter-submenu-check-img",G="gc-filter-allDate-check-img",B="gc-filter-alldates-list",_="gc-filter-addDates-container",V="gc-filter-subMenu-wrap",H="top10_dialog",z="custom_dialog",U="gc-sub-color-sort",W="gc-sub-color-filter",q="automatic",J="gc-filter-dialog-color-title",X="gc-color-item",Z="color-checked-wrap",Y="gc-color-item-list",K="gc-filter-sort",Q="#86BFA0",$="#000000",tt="#FFFFFF",et="transparent",ot="border-box",nt="data-isCheck",rt="inline-block",it="content-box",at="#top10-item",st="#gc-color-dialog-selected",lt="#gc-color-dialog-noFill",ut="thin solid rgb(160,160,160)",ct="data-checked",ft="gc-filter-dialog-close",ht="1px solid #c2c2c2",pt="gc-filter-top10-rank-illegal",dt="1px solid #e0e0e0",gt="data-isNeedDialog",mt="data-isCustom",yt="data-conditionType",Ct="data-operatorType",vt="data-colIndex",bt="data-colorType",wt="data-color",Tt="<div class=",St="<span class=",xt="<img class=",At="<li class=",It="object",Rt="</span><span>",Mt="</div></div>",kt="display",Nt="box-sizing",Ot="none",Dt="width",Ft="height",Et="padding",jt="border",Pt="click",Lt="mouseover",Gt="mouseout",Bt="inherit",_t="backgroundColor",Vt="#f0f0f0",zt=(Ht="margin")+"Left",Ut=Ht+"Top",Wt=Ht+"Right",qt="font-size",Jt=[[1,"Equal","E",1,0],[1,"NotEqual","N",1,1],[1,"GreaterThan","G",1,2],[1,"GreaterOrEquals","O",1,3],[1,"LessThan","L",1,4],[1,"LessThanOrEquals","Q",1,5],[1,"Between","W",0,1],[1,"Top10","T",8,0],[0,"AboveAverage","A",10,0],[0,"BelowAverage","O",10,1],[1,"Custom","F",1,0]],Xt=[[1,"Equal","E",2,0],[1,"NotEqual","N",2,1],[1,"Begin","I",2,2],[1,"End","T",2,4],[1,"Contain","A",2,6],[1,"NotContain","D",2,7],[1,"Custom","F",2,0]],Zt=[[1,"Equal","E",5,0],[1,"Before","B",5,2],[1,"After","A",5,4],[1,"Between","W",0,1],[0,"Tomorrow","T",6,2],[0,"Today","O",6,0],[0,"Yesterday","D",6,1],[0,"NextWeek","K",6,9],[0,"ThisWeek","H",6,7],[0,"LastWeek","L",6,8],[0,"NextMonth","M",6,6],[0,"ThisMonth","S",6,4],[0,"LastMonth","N",6,5],[0,"NextQuarter","N",6,10],[0,"ThisQuarter","N",6,11],[0,"LastQuarter","N",6,12],[0,"NextYear","N",6,13],[0,"ThisYear","N",6,14],[0,"LastYear","N",6,15],[0,"YearToDate","A",6,0,6],[0,"AllDates","P",6,1],[1,"Custom","F",6,0]],ee=[["Q1","1",6,0,2],["Q2","B",6,1,2],["Q3","A",6,2,2],["Q4","4",6,3,2],["Jan","J",6,0,3],["Feb","F",6,1,3],["Mar","M",6,2,3],["Apr","A",6,3,3],["May","Y",6,4,3],["Jun","U",6,5,3],["Jul","L",6,6,3],["Aug","T",6,7,3],["Sep","S",6,8,3],["Oct","O",6,9,3],["Nov","N",6,10,3],["Dec","D",6,11,3]],oe=["IsEquals-0-1","NotEquals-1-11","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",Yt="IsBeginWith-2-2","NotBeginWith-3-2",Kt="IsEndWith-4-2",Qt="NotEndWith-5-2",$t="IsContain-6-2",te="NotContains-7-2"],ne=["IsEquals-0-2","NotEquals-1-11","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",Yt,"NotBeginWith-3-2",Kt,Qt,$t,te],re=["IsEquals-0-5","NotEquals-1-5","IsAfter-4-5","AfterOrEqual-5-5","IsBefore-2-5","BeforeOrEqual-3-5",Yt,"NotBeginWith-4-2",Kt,Qt,$t,te],ie=new r.Common.ResourceManager(u.SR),ae=ie.getResource.bind(ie),se=function(){function t(t,e,o,r,i,a){var s=this;s.Nc=y,s.EXa=a,s.FXa=t,s.kj=r,s.GXa=n.GC$(t),s.xo=e,s.P$a=!1,s.HXa=o,s.xr=o.rowFilter,s.IXa=i,s.JXa=m}return t.prototype.ad=function(){this.yl(this.KXa()),this.LXa()},t.prototype.zW=function(t){return l.getFilterButtonImageSrc(t)},t.prototype.KXa=function(){var t=n.GC$(C("div")).attr("id","gc-ui-filter-subitems-container_"+this.EXa);return t.addClass(R+" "+I+" "+V),t.css([M,kt,Nt],["absolute",Ot,ot]),this.JXa=t,n.GC$(this.FXa).append(this.JXa),t},t.prototype.cXa=function(){return"none"!==this.JXa[0].style.display},t.prototype.Ao=function(){n.GC$("."+V).hide(),this.JXa.show(),this.MXa()},t.prototype.hT=function(){this.JXa.hide(),this.JXa.find("."+E).removeClass(E)},t.prototype.OWa=function(t){return this.Nc=t,this},t.prototype.MXa=function(t){var e,o,n,r,i=this.GXa.offset(),a=this.IXa.AWa.offset(),s=document.documentElement,l=a.left,u=a.top,c=s.clientWidth,f=s.clientHeight,h=this.JXa.width(),p=this.JXa.height(),d=this.GXa.parent().parent().offset(),g=d.top,m=this.xo.offset();m.left+this.xo.width()+h-l>c?(e=-1*(h+2)+"px",n=!1):(e=this.xo.width()+"px",n=!0),o=g+(r=i.top-m.top)+p-u>f?u+f-p-d.top-6:r,o+="px",this.JXa.css([T,S],[e,o]),t&&t.call(this,n)},t.prototype.NXa=function(t,e){ve(t,e,this.kj,this.xr),this.IXa.close()},t.prototype.oXa=function(){n.GC$("."+D,this.JXa[0]).trigger(Pt)},t.prototype.WW=function(){var t,e=this.HXa,o=this.kj,n=e.col,r=e.rowFilter;r&&(t={rowFilter:r,colIndex:n},o.wu().execute({cmd:"clearFilter",sheetName:o.name(),cmdOption:t}))},t.prototype.tXa=function(){return this.hT(),m},t.prototype.uXa=function(){this.cXa()||(this.Ao(),this.mXa())},t.prototype.yl=function(t){},t.prototype.LXa=function(){},t.prototype.mXa=function(){},t.prototype.wXa=function(){},t.prototype.vXa=function(){},t}(),le=function(t){function e(e,o,n,r,i,a){return t.call(this,e,o,n,r,i,a)||this}return ye(e,t),e.prototype.yl=function(t){this.OXa()},e.prototype.LXa=function(){var t=this;t.JXa.bind(Lt,(function(t){w(t)})).bind(Gt,(function(t){w(t)})),n.GC$("."+k,t.JXa[0]).bind(Lt,(function(t){n.GC$("."+k).removeClass(E),n.GC$(this).addClass(E),w(t)})).bind(Gt,(function(t){n.GC$(this).removeClass(E),w(t)})).bind(Pt,(function(e){n.GC$(this).attr("id")!==_&&t.PXa(n.GC$(this)),w(e)})),this.QXa&&this.QXa()},e.prototype.r$a=function(t){return t!==y&&"TRUE"===t||"FALSE"===t},e.prototype.RXa=function(){var t,e,o,r,i,a,s,l,u,c,f,h,p=this.xr.rZ[this.HXa.col],d=this.SXa,g=!1;if(p&&p.length>0)for(a=(p=p[0]).compareType(),s=p.expected(),r=p.expectTypeId(),10===(i=p.conType())&&(a=p.type()),8===i&&(a=0),this.r$a(s)&&(i=11),0===i&&(l=p.item1().compareType(),u=p.item2().compareType(),5===Math.max(l,u)&&3===Math.min(l,u)&&(g=!0)),c=0,f=b(d);c<f;c++){if((e=0===i&&d[c][3]===i&&g||d[c][3]===i&&0!==i||11===i&&(1===d[c][3]||2===d[c][3]))&&8===i){t=c;break}if(o=d[c][4]===a&&!g||6===d[c][3]&&s===d[c][4]||g,e&&o&&(isNaN(r)||0===r)){t=c;break}}isNaN(r)||6!==r||(t=19),isNaN(r)||2!==r&&3!==r||(t=20,this.TXa&&this.TXa(ee,s,r)),t!==y&&0!==t?h=n.GC$("."+k)[t]:!p||3===i||t!==y||2===i&&0===a?0===t&&5===i&&(h=n.GC$("."+k)[t]):h=n.GC$("."+k)[b(d)-1],n.GC$(h).attr(nt,1),n.GC$(h).find("."+L).css([kt],[rt])},e.prototype.mXa=function(){var t=n.GC$("."+k).removeClass(E)[0];n.GC$(t).addClass(E)},e.prototype.UXa=function(t){var e;if(0!==t)e=t;else switch(this.Nc){case"NumberFilter":e=1;break;case"TextFilter":e=2;break;case"DateFilter":e=5}return e},e.prototype.VXa=function(t,e,o,n){var r,i=this.kj;switch(t){case H:r=new de(i.parent.xv(),i,this.HXa,H);break;case z:r=new me(i.parent.xv(),i,this.HXa,z,this.IXa.fY,n,e,o,this.UXa(e))}r&&r.OT()},e.prototype.PXa=function(t){var e,o,n=this.HXa.col,r=parseInt(t.attr(gt),10),a=parseInt(t.attr(yt),10),s=parseInt(t.attr(Ct),10),l=parseInt(t.attr("data-expectTypeId"),10),u=parseInt(t.attr(mt),10),c=parseInt(t.attr(nt),10);return isNaN(l)||(r=0,u=0),0===r&&1===c?(this.WW(),void this.IXa.close()):1===r?(this.IXa.close(),e=8===a&&0===s?H:z,void this.VXa(e,a,s,u)):(o=new i.Condition(a),10===a?o.type(s):o.compareType(s),6!==a||isNaN(l)?6===a&&(o=new i.Condition(a)).expected(s):((o=new i.Condition(a)).expectTypeId(l),o.expected(s)),void this.NXa(n,o))},e.prototype.OXa=function(){},e.prototype.WXa=function(t){var e,o,r="";for(e=0,o=t.length;e<o;e++)r+=e===o-1?this.XXa(t[e],1):this.XXa(t[e],0);this.JXa.html(r),n.GC$(this.FXa).append(this.JXa),this.YXa(),this.RXa()},e.prototype.YXa=function(){var t=this.FXa.offsetHeight-2,e=this.FXa.offsetTop;n.GC$("."+k+",."+N).css([Et,Ft,"line-height","white-space","clear",jt,Dt,Ft,qt,Ht],["0 10px 0 0",t,t,"nowrap","both",Ot,"auto","auto","12px",0]),this.JXa.css([T,S],["100%",e]),n.GC$(".gc-filter-hotkey").css(["text-decoration"],["underline"]),n.GC$("."+P).css([kt,Dt,"textAlign"],[rt,"24px","center"]),n.GC$("."+P+" img").css([kt,"verticalAlign"],[rt,"text-bottom"]),n.GC$("."+L+",."+G).hide(),n.GC$("#"+_).css([M],[A]),n.GC$("."+O).css([zt,Dt,Ft,"background-position"],["5px","16px","16px","center bottom"]),n.GC$("#"+B).css([M,kt,Dt],["absolute","none","auto"])},e.prototype.XXa=function(t,e){var o=t[0],n=ae()[t[1]],r=t[3],i=t[4];return Tt+'"'+k+'" '+mt+'="'+e+'" '+gt+' ="'+o+'" '+yt+'="'+r+'" '+Ct+'="'+i+'">'+Tt+'"'+K+'">'+St+'"'+P+'">'+xt+'"'+L+'" src="'+this.zW(11)+'">'+Rt+n+"</span>"+Mt},e.prototype.vXa=function(){var t=n.GC$("."+D,this.JXa[0]).removeClass(E),e=n.GC$("."+k);0===t.index()?n.GC$(e[e.length-1]).addClass(E):n.GC$(e[t.index()-1]).addClass(E)},e.prototype.wXa=function(){var t=n.GC$("."+D,this.JXa[0]);t.length>0&&t[0].nextSibling?(t.removeClass(E),n.GC$(t[0].nextSibling).addClass(E)):this.mXa()},e}(se),ue=function(t){function e(e,o,n,r,i,a){var s=t.call(this,e,o,n,r,i,a)||this,l=Jt;return r.yUc&&(l=l.slice(0,7).concat(l.slice(l.length-1))),s.SXa=l,s}return ye(e,t),e.prototype.OXa=function(){this.WXa(this.SXa)},e}(le),e.WWa=ue,ce=function(t){function e(e,o,n,r,i,a){var s=t.call(this,e,o,n,r,i,a)||this;return s.SXa=Xt,s}return ye(e,t),e.prototype.OXa=function(){this.WXa(Xt)},e}(le),e.XWa=ce,fe=function(t){function e(e,o,n,r,i,a){var s=t.call(this,e,o,n,r,i,a)||this,l=Zt;return r.yUc&&(l=l.slice(0,4).concat(l.slice(l.length-1))),s.SXa=l,s}return ye(e,t),e.prototype.OXa=function(){this.WXa(this.SXa)},e.prototype.XXa=function(t,e){var o=t[0],n=ae()[t[1]],r=t[3],i=t[4];return"AllDates"===t[1]?'<div id="'+_+'" class="'+k+'" '+mt+'="'+e+'" '+gt+' ="'+o+'" '+yt+'="'+r+'" '+Ct+'="'+i+'">'+Tt+'"'+K+'">'+St+'"'+P+'">'+xt+'"'+L+'" src="'+this.zW(11)+'">'+Rt+n+"</span>"+St+'"'+O+' gc-filterDialog-rightArrow"></span></div>'+this.ZXa()+"</div>":"YearToDate"===t[1]?Tt+'"'+k+'" data-expectTypeId="'+t[5]+'" '+mt+'="'+e+'" '+gt+' ="'+o+'" '+yt+'="'+r+'" '+Ct+'="'+i+'">'+Tt+'"'+K+'">'+St+'"'+P+'">'+xt+'"'+L+'" src="'+this.zW(11)+'">'+Rt+n+"</span>"+Mt:Tt+'"'+k+'" '+mt+'="'+e+'" '+gt+' ="'+o+'" '+yt+'="'+r+'" '+Ct+'="'+i+'">'+Tt+'"'+K+'">'+St+'"'+P+'">'+xt+'"'+L+'" src="'+this.zW(11)+'">'+Rt+n+"</span>"+Mt},e.prototype.Ao=function(){n.GC$("."+V).hide(),this.JXa.show(),this.MXa(this.$Xa)},e.prototype.$Xa=function(t){var e,o,r,i,a,s,l,u,c;this.JXa.show(),e=n.GC$("#"+B),o=n.GC$("#"+_),r=this.JXa,e.length<=0||(l=(s=document.documentElement).clientWidth,u=s.clientHeight,c=this.IXa.AWa.offset().top,i=r.offset().left+r.width()+e.width()>l?-1*e.width()+"px":t?r.width()+"px":-1*e.width()+"px",a=o.offset().top+e.height()-c>u?c+u-e.height()-o.offset().top-5:0,a+="px",e.css([T,S],[i,a]))},e.prototype.ZXa=function(){var t,e='<div id="'+B+'" class="'+R+'">';for(t=0;t<b(ee);t++)e+=Tt+'"'+N+'" data-expectTypeId="'+ee[t][4]+'" '+yt+'="6"  '+Ct+'="'+ee[t][3]+'">'+Tt+'"'+K+'">'+St+'"'+P+'">'+xt+'"'+G+'" src="'+this.zW(11)+'">'+Rt+ae()[ee[t][0]]+"</span>"+Mt;return e+"</div>"},e.prototype.mXa=function(){var t,e;this._Xa()?(t=n.GC$("."+N).removeClass(E),n.GC$(t[0]).addClass(E)):(e=n.GC$("."+k).removeClass(E)[0],n.GC$(e).addClass(E))},e.prototype._Xa=function(){var t=n.GC$("#"+B);return 0!==t.length&&t.css(kt)!==Ot},e.prototype.aYa=function(){n.GC$("#"+B).hide(),n.GC$("."+N).removeClass(E)},e.prototype.QXa=function(){var t=this;n.GC$("."+N,t.JXa[0]).bind(Lt,(function(){n.GC$(this).addClass(E),n.GC$("#"+_).addClass(E)})).bind(Gt,(function(){n.GC$(this).removeClass(E)})).bind(Pt,(function(e){t.PXa(n.GC$(this)),w(e)})),n.GC$("#"+_,t.JXa[0]).bind(Lt,(function(){n.GC$("#"+B).show()})).bind(Gt,(function(){t.aYa()})).bind(Pt,(function(e){n.GC$("#"+B).show(),t.mXa(),w(e)}))},e.prototype.bYa=function(){var t=n.GC$("#"+_);return 0!==t.length&&t.hasClass(E)},e.prototype.TXa=function(t,e,o){var r,i,a;for(i=0;i<b(t);i++)if(t[i][3]===e&&t[i][4]===o){r=i;break}a=n.GC$("."+N)[r],n.GC$(a).attr(nt,1),n.GC$(a).find("."+G).css([kt],[rt]).attr(nt,1)},e.prototype.oXa=function(){(this._Xa()?n.GC$("."+D,n.GC$("#"+B)[0]):n.GC$("."+D,this.JXa[0])).trigger(Pt)},e.prototype.tXa=function(){var t=m;return this._Xa()?(this.aYa(),t=this):this.hT(),t},e.prototype.uXa=function(){var t=this.cXa(),e=this._Xa();t?!e&&this.bYa()&&(n.GC$("#"+B).show(),this.mXa()):(this.Ao(),this.mXa())},e.prototype.vXa=function(){var t,e,o,r;this._Xa()?(t=n.GC$("."+D,n.GC$("#"+B)[0]).removeClass(E),e=n.GC$("."+N),0===t.index()?n.GC$(e[e.length-1]).addClass(E):n.GC$(e[t.index()-1]).addClass(E)):(o=n.GC$("."+D,this.JXa[0]).removeClass(E),r=n.GC$("."+k),0===o.index()?n.GC$(r[r.length-1]).addClass(E):n.GC$(r[o.index()-1]).addClass(E))},e.prototype.wXa=function(){var t,e,o;this._Xa()?(t=n.GC$("."+D,n.GC$("#"+B)[0]).removeClass(E),e=n.GC$("."+N),t.index()===e.length-1?n.GC$(e[0]).addClass(E):n.GC$(e[t.index()+1]).addClass(E)):(o=n.GC$("."+D,this.JXa[0])).length>0&&o[0].nextSibling?(o.removeClass(E),n.GC$(o[0].nextSibling).addClass(E)):this.mXa()},e}(le),e.YWa=fe,he=function(t){function e(e,o,n,r,i,a){return t.call(this,e,o,n,r,i,a)||this}return ye(e,t),e.prototype.yl=function(){this.cYa(this.IXa._Wa,this.IXa.aXa)},e.prototype.dYa=function(){var t,e,o,n,r,i=this.xr.zZ;if(i&&i.color!==y){if(e=i.isBackColor?0:1,o=i.color,n=this.IXa._Wa,r=this.IXa.aXa,"{"===o[0]?o=JSON.parse(o):""!==o&&(o=Ce(o)),""===o&&0===e&&n[q]===y)return y;if(""===o&&0!==e&&r[q]===y)return y;t={colorType:e,color:o}}return t},e.prototype.eYa=function(){var t,e=this.xr.rZ[this.HXa.col];return e&&e.length>0&&3===e[0].conType()&&(t={colorType:e[0].compareType(),color:e[0].expected()}),t},e.prototype.cYa=function(t,e){this.fYa(t,e),this.gYa()},e.prototype.hYa=function(t,e){this.IXa.DXa(t,e),this.IXa.close()},e.prototype.iYa=function(t){var e,o,n;this.IXa.close(),e=this.kj,n=t?this.IXa._Wa:this.IXa.aXa,this.d$a&&(o=this.d$a.color),new ge(e.parent.xv(),e,this.HXa,this.EXa,n,t,o).OT()},e.prototype.jYa=function(t,e){var o=new i.Condition(3),n=this.HXa.col,r=e?0:1,a=this.eYa();return a&&a.colorType===r&&a.color===t?(this.WW(),void this.IXa.close()):(o.compareType(r),o.expected(t),void this.NXa(n,o))},e.prototype.gYa=function(){n.GC$("."+J,this.JXa[0]).css([Ft,"line-height","textIndent","whiteSpace"],["32px","32px","8px","nowrap"]),n.GC$("."+Y,this.JXa[0]).css(["listStyle","padding",Ft,"lineHeight",jt,"whiteSpace",Dt,Ht,qt,Nt],[Ot,"2px 0","23px","23px","1px solid transparent","nowrap","140px",0,"12px","content-box"]),n.GC$("."+X,this.JXa[0]).css([Dt,jt,Wt,Ft,Nt,"whiteSpace",x],["75px","1px solid rgb(130,130,130)","24px","22px",ot,"nowrap",T]),n.GC$("."+Z,this.JXa[0]).css([kt,Dt,Ft,"verticalAlign",Ht,"textAlign",x],[rt,"22px","22px","middle","0 3px 0 2px","center",T]),n.GC$("."+Z+" img",this.JXa[0]).css([Ut,kt],["3px",Ot]),n.GC$(".gc-color-dialog-more-color",this.JXa[0]).css([Et],["0 5px 0 0"]),n.GC$("."+Z+" img.checked",this.JXa[0]).css([Ut,kt],["3px","block"])},e.prototype.fYa=function(t,e){var o,r,i,a;this.EXa===U?(o=ae().SortCellTitle,r=ae().SortFontTitle,i=this.dYa()):this.EXa===W&&(o=ae().FilterCellTitle,r=ae().FilterFontTitle,i=this.eYa()),this.d$a=i,a=this.kYa(o,t[q],t.data,0,i),""!==(a+=this.kYa(r,e[q],e.data,1,i))?this.JXa.html(a):this.P$a=!0,n.GC$(this.FXa).append(this.JXa),this.JXa.find("canvas").forEach((function(t,e,o){var r,i,a,s=t;r="{"===s.textContent[0]?JSON.parse(s.textContent):s.textContent,s.width=73,s.height=20,i=s.getContext("2d"),a=function(){i.fillRect(0,0,73,20)},n.To.setFillStyle(i,r,0,0,73,20,a)}))},e.prototype.kYa=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d=!1,g="checked";for(l in r&&n===r.colorType&&""!==r.color?i=Ce(r.color):r&&""===r.color&&n===r.colorType&&(i=r.color),a=Tt+"'"+J+"'>"+t+"</div><ul class='"+(0===n?"gc-filter-color-dialog-background":"gc-filter-color-dialog-font")+"' style='padding: 7px 0 0 0;margin:0'>",s=0,o)o.hasOwnProperty(l)&&s<5&&(u="",i!==y&&i===l&&(u=g,d=!0),a+=At+'"'+Y+'" '+vt+'="'+o[l]+'" '+bt+'="'+n+'">'+St+'"'+Z+'">'+xt+'"'+u+'" src="'+this.zW(11)+'"></span>'+Tt+'"'+X+'"><canvas>'+l+"</canvas></div></li>",s++);return 0===s&&i===y||e===y&&1===s?a="":(e!==y&&(c=0===n?ae().NoFill:ae().Automatic,f="",i!==y&&""===i&&(f=g,d=!0),a+=At+'"'+Y+'" '+vt+'="'+q+'" '+bt+'="'+n+'" '+wt+' = "">'+St+'"'+Z+'"><img  class="'+f+'" src="'+this.zW(11)+'"></span>'+Tt+'"'+K+'">'+c+"</div></li>"),5===s&&(h="",d||i===y||(h=g),p=0===n?ae().CellColor:ae().FontColor,a+=At+'"'+Y+'" '+vt+'="more_color" '+bt+'="'+n+'" >'+St+'"'+Z+'">'+xt+'"'+h+'" src="'+this.zW(11)+'"></span>'+Tt+'"'+K+' gc-color-dialog-more-color">'+p+"</div></li>"),a+="</ul>")},e.prototype.mXa=function(){var t=n.GC$("."+Y,this.JXa[0]).removeClass(E)[0];n.GC$(t).addClass(E)},e.prototype.LXa=function(){var t=this;t.JXa.bind(Lt,(function(t){w(t)})).bind(Gt,(function(t){w(t)})),n.GC$("."+Y,t.JXa[0]).bind(Pt,(function(){var e,o=n.GC$(this).find("canvas"),r=n.GC$(this).attr(vt),i=n.GC$(this).attr(bt),a=!1;return o&&o.length>0?"{"===(e=o.text())[0]&&(e=JSON.parse(e)):e=n.GC$(this).attr(wt),0===(i=parseInt(i,10))&&(a=!0),"more_color"===r?void t.iYa(a):void(t.EXa===U?t.hYa(e,a):t.EXa===W&&t.jYa(e,a))})).bind(Lt,(function(e){n.GC$("."+Y,t.JXa[0]).removeClass(E),n.GC$(this).addClass(E),w(e)})).bind(Gt,(function(t){n.GC$(this).removeClass(E),w(t)}))},e.prototype.kzb=function(t){var e=0;return t.forEach((function(t,o){n.GC$(t).hasClass(D)&&(e=o)})),e},e.prototype.vXa=function(){var t,e=n.GC$("."+Y,this.JXa[0]),o=this.kzb(e);0===o?n.GC$(e.removeClass(E)[e.length-1]).addClass(E):(t=e.removeClass(E)[o-1],n.GC$(t).addClass(E))},e.prototype.wXa=function(){var t,e=n.GC$("."+Y,this.JXa[0]),o=this.kzb(e);o===e.length-1?this.mXa():(t=e.removeClass(E)[o+1],n.GC$(t).addClass(E))},e}(se),e.ZWa=he,pe=function(t){function e(e,o,n,r){var i,a,s=o.parent;return(i=a=t.call(this,e,v.vl(s&&s.qo),!0)||this).kj=o,i.lYa=i.Cj+"_OK",i.mYa=i.Cj+"_Cancel",i.nYa=i.Cj+"_Close",i.HXa=n,i.xr=n.rowFilter,i.EXa=r,i.xo=i.yo(),a}return ye(e,t),e.prototype.OT=function(){},e.prototype.Fva=function(){this.Ao(),this.yl(),this.oYa(),this.BPa()},e.prototype.yl=function(){},e.prototype.BPa=function(){var t=this,e=t.xo.width(),o=t.xo.height(),n=t.AWa.width(),r=t.AWa.height();this.xo.css([M,T,S],["fixed",(n-e)/2+"px",(r-o)/2+"px"])},e.prototype.oYa=function(){var t=this;n.GC$("#"+t.lYa).bind(Pt,(function(){t.pYa()&&t.close()})),n.GC$("#"+t.mYa).bind(Pt,(function(){t.qYa(),t.close()})),n.GC$("#"+t.nYa).bind(Pt,(function(){t.qYa(),t.close()})).bind(Lt,(function(){this.style.backgroundColor="#E81123",this.style.color="white"})).bind(Gt,(function(){this.style.backgroundColor=Bt,this.style.color=Bt})),n.GC$("#"+t.lYa+", #"+t.mYa).bind(Lt,(function(){n.GC$(this).addClass(j)})).bind(Gt,(function(){n.GC$(this).removeClass(j)})),n.GC$(document).bind("resize",(function(){t.BPa()}))},e.prototype.PXa=function(t){var e=this.HXa;ve(e.col,t,this.kj,e.rowFilter)},e.prototype.pYa=function(){return!0},e.prototype.qYa=function(){},e}(n.Go),e.rYa=pe,de=function(t){function e(e,o,n,r){var i=t.call(this,e,o,n,r)||this,a=i;return a.Vo=230,a._v=140,a.HXa=n,a.xr=a.HXa.rowFilter,a.EXa=r,a.sYa=a.tYa(),a.Fva(),i}return ye(e,t),e.prototype.tYa=function(){var t={rank:0,item:10},e=this.xr.rZ[this.HXa.col];return e&&e.length>0&&8===e[0].conType()&&(t={rank:e[0].type(),item:e[0].expected()}),t},e.prototype.yl=function(){var t=this.uYa();this.yo().html(t),this.setStyle(),this.LXa()},e.prototype.vYa=function(t){1===t.value.length?t.value=t.value.replace(/[^1-9]/g,""):t.value=t.value.replace(/\D/g,"")},e.prototype.LXa=function(){var t=this;n.GC$(at).bind("keyup",(function(){n.GC$(this).removeClass(pt),t.vYa(this)})).bind("paste",(function(){n.GC$(this).removeClass(pt),t.vYa(this)}))},e.prototype.pYa=function(){var t=parseInt(n.GC$("#top10-rank").val(),10),e=parseInt(n.GC$(at).val(),10),o=new i.Condition(8),r=!1;return e?(r=!0,o.type(t),o.expected(e),this.PXa(o)):n.GC$(at).addClass(pt).focus(),r},e.prototype.uYa=function(){var t,e="";return t=1===this.sYa.rank?'<select id="top10-rank"><option value="0">'+ae().top+'</option><option value="1" selected = "selected">'+ae().bottom+"</option></select>":'<select id="top10-rank"><option value="0" selected="selected">'+ae().top+'</option><option value="1">'+ae().bottom+"</option></select>",e+'<div class="gc-popup ui-widget '+R+'"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span class="gc-filter-dialog-title">'+ae().Top10Filter+'</span><span id="'+this.nYa+'" class="gc-filter-dialog-close">×</span></div><div id="top10-desc"><div class="top10-show-text">'+ae().Show+'</div><div class="ui-dialog-hr"></div></div><div class="top10-wrap">'+t+'<input id="top10-item" class="gc-filter-top10-rank" type="text"  value="'+this.sYa.item+'" /></div><div class="top10-footer top10-wrap"><input type="button" id="'+this.lYa+'" value="'+ae().OK+'"><input id="'+this.mYa+'" type="button" class="gc-filter-dialog-close" value="'+ae().Cancel+'"/></div></div>'},e.prototype.setStyle=function(){n.GC$(".gc-popup",this.xo[0]).css([_t,Dt,Ft],[Vt,this.Vo,this._v]),n.GC$(".ui-dialog-titlebar",this.xo[0]).css({height:"34px",background:"white",fontSize:"12px",fontWeight:"normal",color:"#222",border:"none",borderRadius:"0"}),n.GC$(".gc-filter-dialog-title",this.xo[0]).css({float:"left",height:"34px",lineHeight:"34px",display:rt,marginLeft:"15px"}),n.GC$(".top10-show-text",this.xo[0]).css({float:"left"}),n.GC$(".ui-dialog-hr",this.xo[0]).css({position:"absolute",left:"24px",right:"0",margin:"0 5px",height:"12px",borderBottom:dt,borderWidth:"thin"}),n.GC$("#top10-desc",this.xo[0]).css({height:"24px",lineHeight:"24px",marginLeft:"15px",position:A,fontSize:"10px"}),n.GC$("#"+this.nYa,this.xo[0]).css({float:"right",fontSize:"18px",width:"36px",height:"34px",lineHeight:"34px",textAlign:"center"}),n.GC$("#top10-rank",this.xo[0]).css({width:"120px",marginRight:"20px",height:"21px",textIndent:"5px",fontSize:"inherit",padding:"0",marginBottom:0}),n.GC$(at,this.xo[0]).css({width:"60px",textIndent:"5px",padding:0,height:"21px",margin:0,fontSize:"inherit",display:rt}),n.GC$(".top10-wrap",this.xo[0]).css({padding:"0px 12px",textAlign:"right",color:"#9B9C9C",fontSize:"13px"}),n.GC$(".top10-footer",this.xo[0]).css({padding:"20px 12px 12px"}),n.GC$("#"+this.lYa+", #"+this.mYa).css({width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:ht,padding:0,display:rt}),n.GC$("#"+this.lYa,this.xo[0]).css({marginRight:"12px"})},e}(pe),ge=function(t){function e(e,o,n,r,i,a,s){var l=t.call(this,e,o,n,r)||this,u=l;return u.Vo=416,u._v=100,u.wYa=36,u.xYa=24,u.yYa=8,u.zYa=7,u.EXa=r,u.AYa=i,u.Xba=a?0:1,u.BYa=typeof s!==It&&s?Ce(s):s,u.CYa=m,u.DYa=m,u.Fva(),l}return ye(e,t),e.prototype.yl=function(){var t,e,o=this.EYa();this.xo.append(o),t=n.GC$("#color-spread-wrap",this.xo[0])[0],this.e$a=this.f$a(),e=this.FYa(t),this.GYa(t,e),this.LXa(this.CYa,this.DYa)},e.prototype.f$a=function(){return"#D3F0E0"},e.prototype.FYa=function(t){var e,o,r=this.AYa.colorNumber,i=!1;return o=this.wYa*this.zYa+4,Math.ceil(r/this.zYa)>this.yYa?(e=this.xYa*this.zYa,i=!0,o+=20):e=this.xYa*Math.ceil(r/this.zYa),n.GC$(t).height(e),n.GC$(t).width(o),i},e.prototype.HYa=function(t,e,o){var n,r,i;t.suspendPaint(),n=t.options,r=e.options,n.showHorizontalScrollbar=!1,n.allowContextMenu=!1,n.showVerticalScrollbar=o,n.scrollbarMaxAlign=!0,n.tabStripVisible=!1,n.allowUserResize=!1,n.allowUserDragDrop=!1,n.allowUserDragFill=!1,n.allowUserZoom=!1,n.grayAreaBackColor="#fff",r.colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor=et,r.selectionBorderColor=et,r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.isProtected=!0,e.setColumnCount(this.zYa+2),i=this.AYa.colorNumber,e.setRowCount(Math.ceil(i/this.zYa)+1),e.defaults.rowHeight=21,e.defaults.colWidth=36,e.setColumnWidth(0,2),e.setColumnWidth(this.zYa+1,2),e.setRowHeight(0,2),t.resumePaint()},e.prototype.IYa=function(t,e){var o,n,r,i,a;for(a in e.suspendPaint(),o=(this.zYa-this.AYa.colorNumber)*this.wYa/2,e.setColumnWidth(0,o),this.AYa.data)this.AYa.data.hasOwnProperty(a)&&(n=(i=this.JYa(n,r)).row,r=i.col,this.Bba(n,r,a,e));e.resumePaint()},e.prototype.Bba=function(t,e,o,n){var r=new s.Button;r.buttonBackColor("{"===o[0]?JSON.parse(o):o),r.marginLeft(3),r.marginTop(3),r.marginRight(3),r.marginBottom(3),n.setCellType(t,e,r,3),o===this.BYa&&this.g$a(n,t,e,this.e$a)},e.prototype.JYa=function(t,e){return t===y&&e===y?(t=1,e=1):e<this.zYa?e+=1:(t+=1,e=1),{row:t,col:e}},e.prototype.KYa=function(t,e){var o,n,r,i;for(i in e.suspendPaint(),o=y,n=y,this.AYa.data)this.AYa.data.hasOwnProperty(i)&&(o=(r=this.JYa(o,n)).row,n=r.col,this.Bba(o,n,i,e));e.resumePaint()},e.prototype.g$a=function(t,e,o,r){var i,a;t.suspendPaint(),this.h$a&&((i=t.getStyle(this.h$a.row,this.h$a.col,3)).backColor="#ffffff",i.borderLeft=new n.LineBorder(Q,n.LineStyle.empty),i.borderTop=new n.LineBorder(Q,n.LineStyle.empty),i.borderRight=new n.LineBorder(Q,n.LineStyle.empty),i.borderBottom=new n.LineBorder(Q,n.LineStyle.empty),t.setStyle(this.h$a.row,this.h$a.col,i,3)),this.h$a={row:e,col:o},(a=t.getStyle(e,o,3)).backColor=r,a.borderLeft=new n.LineBorder(Q,n.LineStyle.thin),a.borderTop=new n.LineBorder(Q,n.LineStyle.thin),a.borderRight=new n.LineBorder(Q,n.LineStyle.thin),a.borderBottom=new n.LineBorder(Q,n.LineStyle.thin),t.setStyle(e,o,a,3),t.resumePaint()},e.prototype.GYa=function(t,e){var o,r=new n.Workbook(t);r.jDc=!0,o=r.getActiveSheet(),this.CYa=r,this.DYa=o,this.HYa(r,o,e),this.AYa.colorNumber<this.zYa?this.IYa(r,o):this.KYa(r,o)},e.prototype.B_a=function(){var t,e=y;for(t in this.AYa.data)if(this.AYa.data.hasOwnProperty(t)){e=t;break}return"{"===e[0]?JSON.parse(e):e},e.prototype.EYa=function(){var t,e,o,r,i,a,s=n.GC$(C("div")).addClass("gc-popup ui-widget gc-filter-color-dialog-style "+R+" "+I);return s.css({backgroundColor:"#f0f0f0"}),t=this.LYa(),s.append(t),e=this.MYa(),s.append(e),o=n.GC$(C("div")).css([Et],["0 12px"]),(r=this.NYa())!==y&&o.append(r),i=this.OYa(),o.append(i),a=this.PYa(),o.append(a),s.append(o),s.append(this.QYa()),s},e.prototype.LYa=function(){var t=n.GC$(C("div")),e=n.GC$(C("span")),o=n.GC$(C("span")).attr("id",this.nYa);return t.css([Dt,Ft,_t,Et,Nt],["100%","34px","#fff","0 0 0 12px",ot]),e.css(["float",Ft,"lineHeight",kt],[T,"34px","34px",rt]).html(ae().ColorTitle),o.css(["float",Ft,"lineHeight",kt,qt,Dt,"textAlign"],["right","34px","34px",rt,"18px","36px","center"]).html("×").addClass(ft),t.append(e),t.append(o),t},e.prototype.MYa=function(){var t,e=n.GC$(C("div")),o=n.GC$(C("div"));return 0===this.Xba&&this.EXa===U?t=ae().SortCell:0===this.Xba&&this.EXa===W?t=ae().FilterCell:1===this.Xba&&this.EXa===U?t=ae().SortFont:1===this.Xba&&this.EXa===W&&(t=ae().FilterFont),e.css(Et,"0 12px"),o.css([Ft,"lineHeight"],["24px","24px"]).html(t),e.append(o),e},e.prototype.NYa=function(){var t,e,o,r=y;return this.AYa[q]!==y&&(t=""===this.BYa,e=1===this.Xba?ae().Automatic:ae().NoFill,(o=n.GC$(C("div")).html(e)).attr("id","gc-color-dialog-noFill"),t?(o.attr(ct,"checked"),o.css([_t,Et,jt,"textAlign","margin"],["rgb(134,191,160)","0 12px",ut,"center","5px 0"])):o.css([_t,Et,jt,"textAlign","margin"],[et,"0 12px",ut,"center","5px 0"]),r=o),r},e.prototype.OYa=function(){var t=n.GC$(C("div")).attr("id","color-spread-wrap");return t.css([_t,Et,jt,Dt,"box-sizing"],["#fff","6px","1px solid rgb(160,160,160)","288px",it]),t},e.prototype.PYa=function(){var t,e=this,o=n.GC$(C("div")),r=n.GC$(C("div")).html(ae().Selected),i=C("canvas"),a=n.GC$(i).attr("id","gc-color-dialog-selected");return o.css([M,Et,Nt,Ht,Ft],[A,"0 12px",it,"12px 0","16px"]),r.css([x,Dt,"text-align"],[T,"60px","center"]),t=1===e.Xba?$:tt,e.BYa===y&&(e.BYa=e.B_a()),""!==e.BYa&&(t=e.BYa),a.css([M,T,jt],["absolute","70px",ut]),i.width=188,i.height=16,e.Zgc(a,t),o.append(r),o.append(a),o},e.prototype.Zgc=function(t,e){var o,r,i=typeof e===It?JSON.stringify(e):e;t.text(i),o=t[0].getContext("2d"),r=function(){o.fillRect(0,0,188,16)},n.To.setFillStyle(o,"{"===i[0]?JSON.parse(i):i,0,0,188,16,r)},e.prototype.pYa=function(){var t,e=n.GC$(lt);return t=1===e.length&&"checked"===e.attr(ct)?"":this.BYa,this.RYa(t),!0},e.prototype.RYa=function(t){var e=0===this.Xba;this.EXa===U?this.SYa(t,e):this.EXa===W&&this.TYa(t,e)},e.prototype.SYa=function(t,e,o){var r,i,a=this.HXa,s=a.rowFilter,l=this.kj;s&&l&&l.hK()&&(o=o!==y&&o,r=a.col,i={sheet:l,sheetName:l.Cj,col:r,ascending:o,color:t,isBackColor:e,cancel:!1},l.Wq(n.Events.RangeSorting,i),!1===i.cancel&&(l.suspendPaint(),s.sortColumnByColor(r,o,t,e),l.resumePaint(),l.Wq(n.Events.RangeSorted,i)))},e.prototype.TYa=function(t,e){var o=new i.Condition(3),n=e?0:1;o.compareType(n),o.expected(t),this.PXa(o)},e.prototype.LXa=function(t,e){var o=this;n.GC$(lt).bind(Pt,(function(){var t=1===o.Xba?$:tt;o.Zgc(n.GC$(st),t),n.GC$(this).css(_t,"rgb(134,191,160)"),n.GC$(this).attr(ct,"checked")})),t.bind(n.Events.ButtonClicked,(function(t,r){var i,a=r.row,s=r.col,l=e.getCellType(a,s);o.g$a(e,a,s,o.e$a),i=l.buttonBackColor(),o.Zgc(n.GC$(st),i),n.GC$(lt).css(_t,et).attr(ct,""),o.BYa=i})),t.bind(n.Events.TouchToolStripOpening,(function(t,e){e.handled=!0}))},e.prototype.QYa=function(){var t=n.GC$(C("div")),e=n.GC$(C("input")).attr({type:"button",value:ae().OK,id:this.lYa}),o=n.GC$(C("input")).attr({type:"button",value:ae().Cancel,id:this.mYa}).addClass(ft),r={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:ht,padding:"0",display:rt,margin:"0"};return t.addClass("color-custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),e.css(r).css({marginRight:"12px"}),o.css(r),t.append(e[0]),t.append(o[0]),t},e}(pe),me=function(t){function e(e,o,n,r,i,a,s,l,u){var c=t.call(this,e,o,n,r)||this,f=c;return f.Vo=840,f._v=260,f.HXa=n,f.xr=f.HXa.rowFilter,f.EXa=r,f.UYa=a,f.fY=i,f.VYa=s,f.WYa=u,f.XYa=l,f.YYa(a),f.Fva(),c}return ye(e,t),e.prototype.yl=function(){var t=this,e=t.ZYa(this.sYa);t.xo.append(e),n.GC$(".gc-popup",this.xo[0]).css([_t,Dt,Ft,qt],[Vt,this.Vo,this._v,"12px"]),t.LXa()},e.prototype.LXa=function(){var t=this;n.GC$(".filter-custom-select-input").bind("change",(function(){var t=n.GC$(this).find("option")[this.selectedIndex];n.GC$(this).parent().find("input").val(n.GC$(t).text()).attr("gc-data",n.GC$(this).val())})),n.GC$(".filter-custom-select-first-option").bind("click",(function(t){t.stopPropagation(),t.preventDefault(),n.GC$(this).parent().trigger("change")})),n.GC$("#first-condition-expected input, #sec-condition-expected input").bind("change",(function(){var e=n.GC$(this).val(),o=-1;t.fY.forEach((function(t,n){t.text===e&&(o=n)})),""===e&&(n.GC$(this).parent().find("select")[0].value=""),n.GC$(this).attr("gc-data",o)}))},e.prototype.F_a=function(t,e,o){var n,r,i,a,s=t.val();return 0===o&&2===e?s:(r=t.attr("gc-data"),(i=this.fY[r])?n=i.value:11!==e||isNaN(+s)?(a={},(new c).getPreferredDisplayFormatter(s,a),n=a.value):n=parseFloat(s),n)},e.prototype.pYa=function(){var t=parseInt(n.GC$("#filter-logical-wrap input:checked").val(),10),e=this.$Ya(t),o=!1;return this.PXa(e),e?o=!0:n.GC$("#first-condition-type").focus(),o},e.prototype.$V=function(t,e){var o,n,r,a,s=t.val().trim();return s?(n=parseInt(s.split("-")[0],10),o=parseInt(s.split("-")[1],10),r=this.F_a(e,o,n),a=new i.Condition(o),this.r$a(r)&&a.conType(2),a.compareType(n),"string"===p(r)&&(r=g(r)),a.expected(r),a.treatNullValueAsZero(!1),a.ignoreCase(!0),"string"===p(r)&&-1===r.indexOf("*")&&-1===r.indexOf("?")?a.useWildCards(!1):"string"!==p(r)||-1===r.indexOf("*")&&-1===r.indexOf("?")||(a.conType(2),a.useWildCards(!0)),a):m},e.prototype.$Ya=function(t){var e,o=this.$V(n.GC$("#first-condition-type"),n.GC$("#first-condition-expected input")),r=this.$V(n.GC$("#sec-condition-type"),n.GC$("#sec-condition-expected input"));return o?(r?((e=new i.Condition(0)).compareType(t),e.item1(o),e.item2(r)):e=o,e):null},e.prototype.b$a=function(){var t=this.HXa,e=t.rowFilter,o=this.kj.getText(t.row,t.col);return e&&e.range.row<=0&&(o=this.kj.getText(t.row,t.col,t.sheetArea)),o},e.prototype.ZYa=function(t){var e,o,r,i,a,s=this.b$a(),l=n.GC$(C("div")).addClass("gc-popup ui-widget "+R);return l.css({backgroundColor:"#f0f0f0"}),l.append(this._Ya()),l.append(this.aZa(s)),e=this.bZa("first-condition-type","first-condition-expected",t.compareType1||0,t.expected1,t.conType1,!0),l.append(e),l.append(this.cZa(t.logic)),o=this.bZa("sec-condition-type","sec-condition-expected",t.compareType2,t.expected2,t.conType2),l.append(o),o.css([M,Et],[A,"0 0 12px 35px"]),r=n.GC$(C("div")),i=n.GC$(C("p")).html(ae().Explain1).css({margin:"0",lineHeight:"initial",backgroundColor:et}),a=n.GC$(C("p")).html(ae().Explain2).css({margin:"0",lineHeight:"initial",backgroundColor:et}),r.append(i),r.append(a),r.css({fontSize:"10px",textIndent:"12px"}),l.append(r),l.append(this.dZa()),l},e.prototype.bZa=function(t,e,o,r,i,a){var s=n.GC$(C("div"));return s.css([M,Et],[A,"0 0 12px 35px"]),s.append(this.eZa(o,i,a).attr("id",t)),s.append(this.fZa(this.fY,r).attr("id",e)),s},e.prototype._Ya=function(){var t=n.GC$(C("div")),e=n.GC$(C("span")),o=n.GC$(C("span")).attr("id",this.nYa);return t.css([Dt,Ft,_t,Et,Nt],["100%","34px","#fff","0 0 0 12px",ot]),e.css(["float",Ft,"lineHeight",kt],[T,"34px","34px",rt]).html(ae().CustomTitle),o.css(["float",Ft,"lineHeight",kt,qt,Dt,"textAlign"],["right","34px","34px",rt,"18px","36px","center"]).html("×").addClass(ft),t.append(e),t.append(o),t},e.prototype.cZa=function(t){var e=n.GC$(C("div")),o=n.GC$(C("input")).attr({name:"filter-logical",id:"filter-dialog-and",type:"radio"}).val(1).css([Dt,kt],["unset",rt]),r=n.GC$(C("input")).attr({name:"filter-logical",id:"filter-dialog-or",type:"radio"}).val(0).css([Dt,kt],["unset",rt]),i=n.GC$(C("label")).attr({for:"filter-dialog-and"}).html(ae().And).css([Wt,"font-weight",qt,kt,"margin-bottom",Et],["10px","inherit","13px",rt,"0","0"]),a=n.GC$(C("label")).attr({for:"filter-dialog-or"}).html(ae().Or).css([Wt,"font-weight",qt,kt,"margin-bottom",Et],["10px","inherit","13px",rt,"0","0"]);return e.attr("id","filter-logical-wrap"),e.css({padding:"0 0 0 40px",height:"30px"}),0===t?(r.prop("checked",!0),o.prop("checked",!1)):(r.prop("checked",!1),o.prop("checked",!0)),e.append(o),e.append(i),e.append(r),e.append(a),e},e.prototype.aZa=function(t){var e,o,r,i=n.GC$(C("div")),a=n.GC$(C("div")).html(ae().ShowRows);return i.css(Et,"0 12px"),a.css([Ft,"lineHeight"],["24px","24px"]),i.append(a),e=n.GC$(C("div")),o=n.GC$(C("div")),t?((r=n.GC$(C("div")).html(d(t))).css([x,"maxWidth","textOverflow","whiteSpace","overflow"],[T,"300px","ellipsis","nowrap","hidden"]),e.css({height:"24px",lineHeight:"24px",marginLeft:"15px",fontSize:"10px"}),o.css({overflow:"hidden",margin:"0 5px",height:"12px",borderBottom:dt,borderWidth:"thin"}),e.append(r)):(e.css({height:"12px",lineHeight:"2px",marginLeft:"15px",fontSize:"10px"}),o.css({margin:"0 5px",height:"2px",borderBottom:dt,borderWidth:"thin"})),e.append(o),i.append(e),i},e.prototype.eZa=function(t,e,o){var r,i,a,s,l,u,c,f=[],h=!1;for(f=6===this.VYa||5===this.VYa?re:1===this.VYa?oe:ne,i={height:"25px",width:"230px",marginBottom:0,marginRight:"12px",fontSize:"inherit",padding:0,boxSizing:"border-box"},(r=n.GC$(C("select"))).css(i),a="<option>&nbsp;</option>",u=!1,t===y&&(a='<option selected="selected" >&nbsp;</option>'),c=0;c<f.length;c++)l=!1,(s=f[c].split("-"))[2]&&(u=!1,(e===parseInt(s[2],10)||6===this.WYa&&5===parseInt(s[2],10)||11===parseInt(s[2],10))&&(u=!0),u&&t===parseInt(s[1],10)&&(l=!0)),l?(h=!0,a+='<option selected="selected" value="'+s[1]+"-"+s[2]+'">'+ae()[s[0]]+"</option>"):a+='<option value="'+s[1]+"-"+s[2]+'">'+ae()[s[0]]+"</option>";return r[0].innerHTML=a,n.GC$("option",r[0]).css({height:"20px"}),!h&&o&&n.GC$(n.GC$("option",r[0])[1]).attr("selected","selected"),r},e.prototype.I$a=function(t){var e=d(t);return e&&e.length>100&&(e=e.substr(0,100)+"..."),e},e.prototype.fZa=function(t,e){var o,r,i,a,s,l=-1,u=e,c=n.GC$(C("div")),d=n.GC$(C("select")).addClass("filter-custom-select-input"),g=n.GC$(C("input")),y=ae().Blanks;for(c.css([M,T,"top"],["absolute","278px","0"]),g.css([M,T,S,Dt,"textIndent",jt,Ft,Nt,"outline",Et,Ht],["absolute","2px","2px","518px","5px",0,"21px",ot,Ot,0,0]),d.css({height:"25px",width:"540px",margin:0,padding:0}),r="",i=!0,a=0;a<t.length;a++)t[a].text===y&&t[a].value===m||(s=this.I$a(t[a].text),"date"===p(t[a].value)&&(o||(o=f.q4(f.culture()).DateTimeFormat),s=h.Vb(t[a].value,o.shortDatePattern)),t[a].value+""==e+""&&(l=a,u=s),s=s.replace(/\s/g,"&nbsp;"),i?(r+='<option class="filter-custom-select-first-option" value="'+a+'">'+s+"</option>",i=!i):r+='<option value="'+a+'">'+s+"</option>");return d[0].innerHTML=r,d[0].selectedIndex=-1,"date"===p(u)&&(o||(o=f.q4(f.culture()).DateTimeFormat),u=h.Vb(u,o.shortDatePattern)),g.attr("gc-data",l).val(u),c.append(d),c.append(g),c},e.prototype.dZa=function(){var t=n.GC$(C("div")),e=n.GC$(C("input")).attr({type:"button",value:ae().OK,id:this.lYa}),o=n.GC$(C("input")).attr({type:"button",value:ae().Cancel,id:this.mYa}).addClass(ft),r={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:ht,padding:0,display:rt};return t.addClass("custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),e.css(r).css({marginRight:"12px"}),o.css(r),t.append(e[0]),t.append(o[0]),t},e.prototype.YYa=function(t){var e=this,o=e.xr.rZ[e.HXa.col],n={conType1:2,conType2:y,compareType1:0,compareType2:y,expected1:y,expected2:y,logic:1};o=o&&o.length?o[0]:m,e.sYa=e.gZa(n,t,o)},e.prototype._Za=function(t,e){var o,n,r=f.q4(f.culture()).DateTimeFormat,i={},a=t.expectTypeId();if(0===a)i=t.getExConditionDateScope(t.expected());else if(6===a)o=new Date,n=new Date,o.setMonth(0,1),o.setHours(0,0,0,0),n.setHours(23,59,59,59),i={from:o,to:n};else if(3===a)return e.conType1=this.WYa,e.compareType1=this.XYa,e.expected1=y,e;return e.conType1=5,e.conType2=5,e.compareType1=5,e.compareType2=2,e.expected1=h.Vb(i.from,r.shortDatePattern),e.expected2=h.Vb(i.to,r.shortDatePattern),e},e.prototype.gZa=function(t,e,o){var n,r,i,a,s,l=o&&(o.conType()===this.VYa||11===o.conType()&&(1===this.VYa||2===this.VYa)),u=o&&(o.compareType()===this.XYa||0===o.conType());return!o||1!==e||6!==o.conType()||0!==o.expectTypeId()&&6!==o.expectTypeId()&&3!==o.expectTypeId()?(n=!0,1===this.WYa&&o&&0===o.conType()&&(r=o.item1().compareType(),i=o.item2().compareType(),5===Math.max(r,i)&&3===Math.min(r,i)||(n=!1)),1===e||l&&u&&n?o&&0===o.conType()?(this.VYa=this.WYa,t.conType1=o.item1().conType(),t.conType2=o.item2().conType(),t.compareType1=o.item1().compareType(),t.compareType2=o.item2().compareType(),t.expected1=o.item1().expected(),t.expected2=o.item2().expected(),t.logic=o.compareType()):o&&0!==o.conType()&&3!==o.conType()&&(a=o.compareType(),s=o.conType(),t.conType1=s,t.expected1=o.expected(),t.compareType1=a):0===this.VYa?(this.VYa=this.WYa,1===this.WYa?(t.conType1=1,t.conType2=1,t.compareType1=3,t.compareType2=5):5===this.WYa&&(t.conType1=5,t.compareType1=5,t.conType2=5,t.compareType2=3)):1===this.VYa&&this.s$a(o)?(t.conType1=this.WYa,t.compareType1=this.XYa,t.expected1=o.expected()):(t.conType1=this.WYa,t.compareType1=this.XYa,t.expected1=y),t):this._Za(o,t)},e.prototype.r$a=function(t){return t!==y&&"TRUE"===t||"FALSE"===t},e.prototype.s$a=function(t){if(!t)return!1;var e=!1,o=t.expected();return 1===t.conType()&&this.r$a(o)&&(e=!0),e},e}(pe)},"./dist/plugins/filter/filter-ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/filter/filter.res.en.js");e.SR={en:n}},"./dist/plugins/filter/filter-ui.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function qt(t,e){r.GC$(t).addClass(e)}function Jt(t,e){return"object"==typeof t?JSON.stringify(t):(t=e.getColor(t),n.Common.pc.bc(n.Common.pc.ec(t)))}function Xt(t,e){var o,n,r={date:0,number:1,string:2,boolean:3,blank:4},i=t.value,a=e.value,s=t.type,l=e.type;if(s!==l)return r[s]<r[l]?-1:1;if("date"===s&&"date"===l){if((o=i.getFullYear())<(n=a.getFullYear()))return 1;if(o>n)return-1}return i>a?1:i<a?-1:0}function Zt(t,e,o,n,r){if(t){var i=void 0;"string"==typeof t?(i=r[t])===Nt&&(i=r[t]=Jt(t,o)):i=JSON.stringify(t),e.data[i]===Nt&&e.colorNumber++,e.data[i]=n}else e[Ot]=Ot}function Yt(t,e){r.GC$(t).removeClass(e)}function Kt(t,e,o){t.css([dt,gt],[e+q,o+q])}function Qt(t){r.GC$(t).css(["border",st,ct,"outline"],[0,0,0,pt])}function $t(t){return t.concat([])}function te(t,e){var o,r,i,a,s,l,u;if(C(t)||""===t||"number"==typeof t&&isNaN(t))return"blank";if(o=wt(t),r="number"==typeof t,"General"===e||C(e)){if(o)return"date"}else if(!c(e)&&(o||r))return i=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|zzz|zz|z|ggg|gg|g|ee|e/,a=/AM|PM/,l=(s=e instanceof n.Formatter.FormatterBase)?e:new n.Formatter.GeneralFormatter(e),u=s?e.formatString():e,i.test(u)&&!(l.hasFormatedColor&&l.hasFormatedColor())&&!a.test(e)&&!("General"===u||""===u||void 0===u)?"date":"number";return vt(t)}function ee(t,e,o,n,r){var i,a,s,l,u,c;if(e&&t)return u=[],(i=t.format(o))&&(a=(c=i.split("/"))[0]||"",s=c[1]||"",l=c[2]||""),u.push({value:a,level:0,status:n}),u.push({value:s,level:1,status:n}),u.push({value:l,level:2,status:n}),{key:e,value:o,children:u,status:n,type:r}}function oe(t,e,o,n,r,i,a){if(e){var s=[];return s.push({value:e,level:t.outlineColumn&&t.outlineColumn.XQa(r)?t.getCell(n,r).textIndent():0,status:i}),{key:e,value:o,children:s,status:i,type:a}}}function ne(t){var e,o,r,i,a,s,l,u,c,f;if(C(t)&&(t=""),(e=new n.Formatter.GeneralFormatter(t).formatters)&&!(e.length<=0)&&(o=e[0]))return i=(r=n.Common.CultureManager.getCultureInfo())&&r.id,a=o.localeIDFormatPart,s=o.dbNumberFormatPart,l=a&&a.Wc||i,u=n.Common.CultureManager.LZa(l,function(t){var e,o,n,r="",i=!1;for(e=0,o=t.length;e<o;e++)'"'===(n=t[e])&&(i=!i),"E"===n||i||(r+=n.toLowerCase());return r}(t)),c=a&&a.Kc||"",f=s&&s.Kc||"",new n.Formatter.GeneralFormatter(f+c+u)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("./dist/plugins/filter/filter-dialog.js"),a=o("./dist/plugins/filter/filter.js"),s=o("./dist/plugins/filter/filter-button-images.js"),l=o("./dist/plugins/filter/filter-ns.js"),u=n.Common.q,c=r.Ul.lHb,f=n.Common.u.Ob,h=n.Formatter.lxb,p=r.Ul.Nl,d=r.Ul,g=d.nl,m=n.Common.k.ac,y=null,C=n.Common.j.Fa,v=parseFloat,b=r.GC$.inArray,w="gc-filterOK",T="gc-filterCancel",S="gc-filterSearch",x="gc-filterCheckAll",A="gc-filterUnCheckAll",R="gc-filter-button",M="gc-filter-item-link ",k="gc-filter-sort",O="gc-filter-button-hover "+(N="ui-state-hover "),E=(I="gc-filter-hover")+" form-control well "+(F=N+(D="gc-filter-item-hover")),j=" ui-corner-all ",P="ui-button-disabled",L=" ui-state-disabled",G="gc-filter-button-disable",B="gc-sub-color-filter",_="gc-sub-content-flter",V="gc-sub-color-sort",H=" gc-filter-check",z="gc-filter-check-outerDiv",U="gc-filter-button-active",W=".ui-filter-dialog",q="px",J="font-size",X="string",Z="javascript:void(0)",Y="mouseout",K="click",Q="keydown",$="keyup",tt="search",et="span",ot="div",nt="button",rt="mousedown",it="mouseover",at="mouseup",lt=(st="margin")+"Left",ut=st+"Top",ft=(ct="padding")+"Top",ht="display",pt="none",dt="width",gt="height",mt="left",yt="box-sizing",Ct="content-box",vt=n.Common.j.Ba,bt=n.Common.l.Xb,wt=n.Common.l.Ska,Tt="gc-sortASC-tr",St="gc-sortDEC-tr",xt="gc-sort-color-tr",At="clear_filter",It="gc-color-filter",Rt="gc-major_filter",Mt="gc-search-tr",kt="gc-filter-function-tr",Nt=void 0,Ot="automatic",Dt="TextFilter",Ft="NumberFilter",Et="DateFilter",jt="gc-filter-choose-area",Pt="filter-button-tr",Lt="gc-majorFilter",Gt="gc-filterDialog-rightArrow",Bt="gc-filter-disable-item",function(t){t[t.true=1]="true",t[t.false=2]="false",t[t.undefined=2]="undefined",t[t.null=3]="null"}(_t||(_t={})),Vt=new n.Common.ResourceManager(l.SR),Ht=Vt.getResource.bind(Vt),zt=function(){function t(t,e,o,n,r,i,a,s){var l=this;l.rowFilter=t,l.row=e,l.col=o,l.sheetArea=n,l.x=r,l.y=i,l.width=a,l.height=s}return t.prototype.ko=function(){var t=this.rowFilter,e=this.col,o=t.getSortState(e);return t?t.isFiltered(e)?[3,4,5][o]:o:0},t}(),e.eY=zt,Ut=function(t){function e(e,o,n,r){var i,a,s=o.parent;return(i=a=t.call(this,e,d.vl(s&&s.qo))||this).pxb={},i.fY=[],i.hY=[],i.gY=[],i.CWa=[],i.a$a=[],i.fLb=[],i.gLb=[],i.hLb=!1,i.iLb=!1,i.DWa={Number:0,Text:0,Date:0},i.EWa="",i.FWa=y,i.sheet=o,i.filterButtonInfo=n,i.lY=237,i.mY=410,i.U$a=26,i.nY=191,i.oY=150,i.lzb=1.2,i.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,i.elementList=[],i.activeItemIndex=y,i.xo=i.yo(),i.GWa=i.HWa(),i.IWa=i.JWa(),i.V$a=r,i.W$a=i.X$a(),i.wY(),i.xY(),a}return Wt(e,t),e.prototype.X$a=function(){var t=this,e=[],o=this.V$a,n=t.mY,r=t.U$a;return o.sortByValue?e=e.concat([1,1]):(e=e.concat([0,0]),n-=2*r),o.sortByColor?e=e.concat([1]):(e=e.concat([0]),n-=r),!0===o.filterByValue||!0===o.filterByColor?e=e.concat([1]):(e=e.concat([0]),n-=r),!0===o.filterByColor?e=e.concat([1]):(e=e.concat([0]),n-=r),!0===o.filterByValue?e=e.concat([1]):(e=e.concat([0]),n-=r),!0===o.listFilterArea?e=e.concat([1,1,1]):(e=e.concat([0,0,0]),n-=254),t.mY=n,e},e.prototype.OT=function(){var t,e=this,o=e.sheet.parent,n=e.filterButtonInfo,i=e.xo;e.yY=!!o&&o.options.useTouchLayout,e.zY(n.col),e.itemList&&e.itemList.length>0?e.AY(e.dataSource):e.sheet.endEdit(),e.KWa(),e.LWa(),1===r.GC$("#"+Rt).length&&(e.MWa=e.NWa(r.GC$("#"+Rt)[0].children[2]),e.MWa.OWa(e.EWa).ad()),1===r.GC$("#"+It).length&&(e.PWa=e.QWa(r.GC$("#"+It)[0].children[2],B),e.PWa.ad()),1===r.GC$("#"+xt).length&&(e.RWa=e.QWa(r.GC$("#"+xt)[0].children[2],V),e.RWa.ad()),i.hide(),e.Ao((function(){e.elementList.length>0&&r.GC$(e.elementList[0]).focus()})),e.BY(e.yY),(t=n.x+n.width-i.width()-6)<5&&(t=5),i.css([mt,"top"],[t,n.y+n.height]),e.Do(),e.QQ(),e.MY(),setTimeout((function(){e.xo.focus()})),e.sheet.mm.uC()},e.prototype.BY=function(t){var e,o,n,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b,T=this;t&&(e=T.lY*T.lzb,o=T.mY*T.lzb,n=e-T.lY,i=o-T.mY,Kt(T.xo,e,o),a=r.GC$("."+k),s=v(a.css(ft))+i/30,l=r.GC$("."+R),u=v(l.css(dt))+n/4,c=v(l.css(gt))+i/8,f=r.GC$("#"+w),h=v(f.css(lt))+n/2,p=r.GC$("#"+S),d=v(p.css(dt))+n,g=v(p.css(gt))+i/8,m=r.GC$("."+z),y=v(m.css(ut))+i/10,C=r.GC$("#"+A),b=v(C.css(lt))+n,a.css(ct,s+q+" 6px"),Kt(l,u,c),f.css(lt,h+q),Kt(p,d,g),m.css(ut,y+q),C.css(lt,b+q))},e.prototype.close=function(){var e=this,o=e.sheet;e.xo.hide(),e.hXa&&(e.hXa.no(),e.hXa=null),t.prototype.close.call(e),r.GC$(e.CY).remove(),r.GC$(e.DY).remove(),o.GZ=null,o&&o.zt()},e.prototype.Y$a=function(){1===r.GC$("#"+Tt).length&&this.Z$a(),1===r.GC$("#"+xt).length&&this.$$a()},e.prototype.Z$a=function(){var t=this,e=t.elementList,o=t.EY("gc-sortASC",Ht().SortAscending),n=t.EY("gc-sortDES",Ht().SortDescending),i=r.GC$("#"+Tt)[0],a=r.GC$("#"+St)[0];r.GC$(i.children[0]).append(r.GC$(p("img")).attr("src",s.getFilterButtonImageSrc(6))),r.GC$(a.children[0]).append(r.GC$(p("img")).attr("src",s.getFilterButtonImageSrc(7))),r.GC$(i.children[1]).append(o),r.GC$(a.children[1]).append(n),e.push(i),e.push(a)},e.prototype.$$a=function(){var t=this,e=t.elementList,o=t.EY("gc-sortColor",Ht().SortColor),n=r.GC$("#"+xt)[0],i=t.SWa(),a=this.TWa(i),s=r.GC$(p("span"));s.addClass(Gt),r.GC$(n.children[0]).append(a),r.GC$(n.children[1]).append(o),r.GC$(n.children[2]).append(s),e.push(n)},e.prototype._$a=function(t){var e,o=this.elementList,n=this.EY("gc-filter-color",Ht().FilterColor),i=r.GC$("#"+It)[0],a=r.GC$(p("span"));a.addClass(Gt),e=this.TWa(t.isShowColorFilterSelect),r.GC$(i.children[0]).append(e),r.GC$(i.children[1]).append(n),r.GC$(i.children[2]).append(a),o.push(i)},e.prototype.a_a=function(t){var e,o=this,n=o.sheet,i=o.filterButtonInfo.col,a=o.TWa(t.isShowMajorCheck),s=r.GC$("#"+Rt)[0];n.outlineColumn&&n.outlineColumn.XQa(i)&&r.GC$(s).addClass(Bt+L),r.GC$(s.children[0]).append(a),o.EY(Lt,"").appendTo(s.children[1]),(e=r.GC$(p("span"))).addClass(Gt),r.GC$(s.children[2]).append(e),o.elementList.push(s)},e.prototype.b_a=function(){var t,e,o,n,i=1===r.GC$("#"+It).length,a=1===r.GC$("#"+Rt).length;(i||a)&&(e=(t=this).elementList,o=r.GC$("#"+At)[0],t.UWa(o),e.push(o),n=t.VWa(),i&&t._$a(n),a&&t.a_a(n))},e.prototype.c_a=function(){var t=this;t.V$a.listFilterArea&&(t.d_a(),t.e_a(),t.f_a())},e.prototype.f_a=function(){var t=R+" gc-filter-button-default ui-button ui-state-default"+j+"btn btn-default",e=r.GC$("#"+Pt)[0],o=p(nt),n=p(nt),i=r.GC$(o).text(Ht().OK).css(J,"1em").attr("id",w),a=r.GC$(n).text(Ht().Cancel).css(J,"1em").attr("id",T);qt(o,t),qt(n,t),r.GC$(e.children[1]).append(i).append(a),this.elementList.push(o),this.elementList.push(n)},e.prototype.e_a=function(){var t,e=this,o=e.VWa(),n=r.GC$("#"+jt)[0],i=r.GC$(p("img")).attr("src",s.getFilterButtonImageSrc(11)).addClass("gc-filter-checked");i.css(["verticalAlign","margin-top"],["top","4px"]),o.isShowSelectCheck||i.css([ht],[pt]),qt((t=e.itemList=r.GC$(p(ot)).css([dt,gt,yt],[e.nY,e.oY,Ct]))[0],"gc-filter-item-container"),r.GC$(n.children[0]).append(i).css([ht],["inline-block"]),r.GC$(n.children[1]).append(t)},e.prototype.d_a=function(){var t,e,o,n=this,i=r.GC$(p(ot)).css([st,ct],[0,0]),a=r.GC$(p(ot)).appendTo(i),s=r.GC$("#"+Mt)[0],l=r.GC$(p("input")).attr({type:tt,placeholder:Ht().Search,id:S}).appendTo(a);qt(i[0],"gc-search-outer-div ui-widget-header"+j+"ui-multiselect-header ui-helper-clearfix"),n.elementList.push(l[0]),t=r.GC$(p(ot)).appendTo(i),e=n.FY(x,Ht().CheckAll,"gc-check-image ui-icon ui-icon-check"),o=n.FY(A,Ht().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick"),qt(t[0],z),t.append(e).append(o),r.GC$(s.children[1]).append(i),n.elementList.push(e[0]),n.elementList.push(o[0])},e.prototype.xY=function(){var t=this;t.Y$a(),t.b_a(),t.c_a()},e.prototype.NWa=function(t){var e=this,o=y;switch(this.EWa){case Ft:o=new i.WWa(t,e.xo,e.filterButtonInfo,e.sheet,e,_);break;case Dt:o=new i.XWa(t,e.xo,e.filterButtonInfo,e.sheet,e,_);break;case Et:o=new i.YWa(t,e.xo,e.filterButtonInfo,e.sheet,e,_)}return o},e.prototype.QWa=function(t,e){var o=this,n=y;return e===B?n=new i.ZWa(t,o.xo,o.filterButtonInfo,o.sheet,o,B):e===V&&(n=new i.ZWa(t,o.xo,o.filterButtonInfo,o.sheet,o,V)),n},e.prototype.SWa=function(){var t=this.filterButtonInfo,e=!1,o=t.rowFilter.zZ;return o!==y&&o.color!==Nt&&t.col===o.index&&(e=!0),e},e.prototype.TWa=function(t){var e=r.GC$(p("div")),o=r.GC$(p("img")).attr("src",s.getFilterButtonImageSrc(11)).addClass("gc-filter-checked");return t||o.css([ht],[pt]),e.append(o),e},e.prototype.HWa=function(){var t=this,e=t.filterButtonInfo,o=e.rowFilter,n=e.col,r=t.sheet.getText(t.filterButtonInfo.row,n,e.sheetArea);return o&&o.range.row<=0?r=t.sheet.getText(e.row,n,e.sheetArea):r||(r=t.sheet.getText(0,n,1)),""===r&&1===t.sheet.options.colHeaderAutoText?r="(Column "+(n+1)+")":""===r&&(r="(Column "+d.xq(n+1)+")"),'"'+r},e.prototype.UWa=function(t){var e,o=this;o.IWa?(e=s.getFilterButtonImageSrc(12),r.GC$(t).addClass("gc-filter-item")):(e=s.getFilterButtonImageSrc(13),r.GC$(t).addClass(Bt+L)),r.GC$(t.children[0]).append(r.GC$(p("img")).attr("src",e).css([dt],["18px"])),o.v$a("gc-clearFilter",o.GWa,r.GC$(t.children[1]))},e.prototype.i$a=function(t){return 0===t.conType()&&0===t.item1().compareType()&&0===t.item2().compareType()&&5===t.item1().conType()&&5===t.item2().conType()},e.prototype.VWa=function(){var t,e,o,n=this,r=!1,i=!1,a=!1,s=n.filterButtonInfo,l=s.col,u=s.rowFilter.rZ[l];return u&&u.length>0&&(t=(u=u[0]).conType(),0===(e=u.compareType())&&3!==t&&n.V$a.listFilterArea?a=!0:0!==e||3===t||n.V$a.listFilterArea?0!==e&&3!==t?r=!0:3===t&&(i=!0):r=!0,o=this.i$a(u),(5===t&&0===e||o)&&(a=!1,r=!0)),{isShowColorFilterSelect:i,isShowMajorCheck:r,isShowSelectCheck:a}},e.prototype.JWa=function(){var t=!1,e=this.filterButtonInfo,o=e.col,n=e.rowFilter.rZ[o];return n&&n.length>0&&(t=!0),t},e.prototype.$Wa=function(){var t=Math.max(this.DWa.Date,this.DWa.Number,this.DWa.Text);return t===this.DWa.Text?Dt:t===this.DWa.Number?Ft:t===this.DWa.Date?Et:void 0},e.prototype.KWa=function(){var t,e=this.$Wa();this.EWa=e,t=Ht()[e],r.GC$("#"+Lt).text(t)},e.prototype.WW=function(){var t,e=this.filterButtonInfo,o=this.sheet,n=e.col,r=e.rowFilter;r&&(t={tableName:r.sj?r.sj.name():Nt,colIndex:n},o.wu().execute({cmd:"clearFilter",sheetName:o.name(),cmdOption:t}),this.close())},e.prototype.LWa=function(){var t,e=!1,o=this._Wa,n=this.aXa,r=o.colorNumber,i=n.colorNumber;o.automatic&&r++,n.automatic&&i++,(r!==Nt&&r>1||i!==Nt&&i>1)&&(e=!0),t=this.VWa(),e||(!t.isShowColorFilterSelect&&this.bXa(It),!this.SWa()&&this.bXa(xt))},e.prototype.bXa=function(t){r.GC$("#"+t).addClass(Bt+L).find("."+Gt)},e.prototype.wY=function(){var t,e,o,n,i,a,s,l=this,u=l.xo,c=" gc-sort-container ui-menu-item",f=l.table=r.GC$(p("table")).css([ct,ht],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(qt(f[0],"gc-layout-table"),o=[Tt,St,xt,At,It,Rt,Mt],n=l.W$a,t=0;t<9;t++)if(1===n[t])for(i=p("tr"),a=r.GC$(i).appendTo(f),t<6&&(r.GC$(i).attr("id",o[t]).css([ht,gt,J],["table-row","26px","9pt"]),r.GC$(i).addClass(kt)),6===t&&r.GC$(i).attr("id",o[t]),7===t&&r.GC$(i).attr("tabindex",0).attr("id",jt),8===t&&r.GC$(i).attr("id",Pt),Qt(i),e=0;e<3;e++)s=p("td"),r.GC$(s).appendTo(a),Qt(s),0===e?qt(s,"gc-layout-table-first-column"):2===e?qt(s,"gc-layout-table-last-column"):1===e&&(0===t?qt(s,"gc-filter-sort-asc-container"+c+"gc-layout-table-middle-column"):1===t&&qt(s,"gc-filter-sort-desc-container"+c+"gc-layout-table-middle-column"));l.table.appendTo(u),u.css(["box-shadow",dt,gt,yt],["rgba(0, 0, 0, 0.15) 2px 4px 5px",l.lY+q,l.mY+q,Ct]),qt(u[0],"gc-filter-dialog-style gc-no-user-select"),u.appendTo(l.zo())},e.prototype.QQ=function(){var t,e,o,n=this,i=!1,a=!1,s=r.GC$("."+R);r.GC$("#"+Tt).bind(at,(function(t){i&&(i=!1,n.JY(!0),n.close(),g(t))})).bind(rt,(function(t){g(t),i=!0})),r.GC$("#"+St).bind(at,(function(t){a&&(a=!1,n.JY(!1),n.close(),g(t))})).bind(rt,(function(t){g(t),a=!0})),r.GC$("."+kt).bind(it,(function(){n.MWa&&r.GC$(this).attr("id")!==Rt&&n.MWa.cXa()&&(n.MWa.hT(),n.FWa=y,Yt(r.GC$("#"+Rt)[0],E)),n.PWa&&r.GC$(this).attr("id")!==It&&n.PWa.cXa()&&(n.PWa.hT(),n.FWa=y,Yt(r.GC$("#"+It)[0],E)),n.RWa&&r.GC$(this).attr("id")!==xt&&n.RWa.cXa()&&(n.RWa.hT(),n.FWa=y,Yt(r.GC$("#"+xt)[0],E)),!r.GC$(this).hasClass(L.trim())&&r.GC$(this).index()<6&&qt(this,E)})).bind(Y,(function(){n.MWa&&r.GC$(this).attr("id")===Rt&&(clearTimeout(t),n.MWa.cXa())||n.PWa&&r.GC$(this).attr("id")===It&&(clearTimeout(e),n.PWa.cXa())||n.RWa&&r.GC$(this).attr("id")===xt&&(clearTimeout(o),n.RWa.cXa())||Yt(this,E)})),r.GC$("#"+At).bind(K,(function(){n.IWa&&n.WW()})),r.GC$("#"+Rt).bind(it,(function(){r.GC$(this).hasClass(Bt)||(t=setTimeout((function(){n.FWa=n.MWa,n.FWa.Ao()}),500))})),r.GC$("#"+It).bind(it,(function(){r.GC$(this).hasClass(Bt)||(e=setTimeout((function(){n.FWa=n.PWa,n.FWa.Ao()}),500))})),r.GC$("#"+xt).bind(it,(function(){r.GC$(this).hasClass(Bt)||(o=setTimeout((function(){n.FWa=n.RWa,n.FWa.Ao()}),500))})),r.GC$("#"+x).bind(rt,(function(t){g(t)})).bind(at,(function(t){n.KY(t,!0)})),r.GC$("#"+A).bind(rt,(function(t){g(t)})).bind(at,(function(t){n.KY(t,!1)})),r.GC$("#"+S).bind(Q,(function(t){13===(t.which||t.keyCode)&&t.preventDefault()})).bind($,(function(t){b(t.keyCode,[9,37,38,39,40])<0&&(n.NY(),n.MY())})).bind(tt,(function(t){n.NY(),n.MY()})),s.bind(it,(function(){qt(this,O)})).bind(Y,(function(){Yt(this,O)})),s.bind(rt,(function(){Yt(this,O),qt(this,U)})).bind(Y,(function(){Yt(this,U)})),r.GC$("#"+w).bind(K,(function(){var t,e,o,r,i,a,s;if(n.dXa(),t=n.fLb,e=[],o=n.hY,r=t.length,i=o.length,n.hLb=1===n.eXa.outlineColumn.getCheckStatus()[0],n.hLb){for(a=0;a<(r>i?r:i);a++)o[a]&&e.push(o[a]),!t[a]||t[a].repeat||t[a].noCheck||e.push(t[a]);n.hY=e}s=n.hY,n.sheet.suspendPaint(),n.PY(s),n.sheet.resumePaint(),n.close()})),r.GC$("#"+T).bind(K,(function(){n.close()})),n.xo.bind("mousewheel",(function(t){g(t)})).bind("DOMMouseScroll",(function(t){g(t)})).bind(Q+W,(function(t){n.QY(t)})).bind($+W,(function(t){g(t)})),n.itemList&&n.itemList.length>0&&(n.hXa.bind(r.Events.TopRowChanged,(function(t,e){n.fXa(e)})),n.hXa.bind(r.Events.CellClick,(function(t,e){n.gXa(e)})),n.hXa.bind(r.Events.TouchToolStripOpening,(function(t,e){e.handled=!0})))},e.prototype.fXa=function(t){var e,o,n,r,i,a,s,l,u;t.oldTopRow>t.newTopRow||(e=this,n=(o=t.sheet).parent,r=t.newTopRow,i=o.jt(1).length,a=e.itemList.width(),s=e.iXa,l=o.getColumnWidth(s),n.options.showVerticalScrollbar&&(a-=22),u=Math.max(o.getColumnCount()*l,a),e.PZa(o,u,l,r,i))},e.prototype.PZa=function(t,e,o,n,i,a){var s,l,u,c=0,f=0,h=t.parent,p=this.iXa,d=n+i,g=t.outlineColumn.WZa(),m=Math.min(d,t.getRowCount());for(s=n;s<m;s++)l=a&&a[s].name||t.getText(s,p),u=g[s].cellContent.left,(f=r.Vn.Xn(l)+u-e)>0&&f>c&&(c=f);c>0&&(t.addColumns(t.getColumnCount(),Math.ceil(c/o)),h.options.showHorizontalScrollbar=!0)},e.prototype.gXa=function(t){var e,o,n,i,a,s,l,u,c,f=this,h=t.sheet,d=t.row,g=t.sheetArea,y=f.iXa;f.activeItemIndex=d,e=f.eXa.outlineColumn.getCheckStatus(),"add_current"===f.dataSource[0].key&&0===d&&(f.hLb=1===e[0]),h.suspendPaint(),!t.ignoreClick&&h.yt&&((n=(o=h.yt.cellTypeHitInfo)&&o.outlineColumnHitInfo)&&n.indicator||(h.outlineColumn.getCheckStatus(d,y)===f.dataSource[d].status&&h.outlineColumn.setCheckStatus(d,f.MZa(f.dataSource[d].status)),f.DZa())),h.CH&&h.m_a("transparent"),i=r.GC$("."+D,this.xo[0]),m(i)>0?Yt(i,F):f.jXa(h),s=(a=h.getStyle(d,y,g))&&a.clone()||new r.Style,qt(l=r.GC$(p(ot)),E),this.xo.append(l),u=l.css("backgroundColor"),c=l.css("color"),l.remove(),s.backColor=u,s.foreColor=c,h.setStyle(d,-1,s),h.resumePaint(),f.dXa(),f.MY()},e.prototype.DZa=function(){for(var t=this.eXa.outlineColumn.getCheckStatus(),e=0;e<t.length;)this.dataSource[e].status=t[e],e++},e.prototype.MZa=function(t){return 1===t?2:1},e.prototype.jXa=function(t){var e,o,n=t.getRowCount(),r=this.iXa;for(e=0;e<n;e++)if((o=t.getActualStyle(e,r)).backColor||o.foreColor){o.foreColor=o.backColor=void 0,t.setStyle(e,-1,o);break}},e.prototype.dXa=function(){var t,e,o,n,r,i,a,s,l,u=this,c=u.eXa.outlineColumn.getCheckStatus(),f=0,h=u.gY||u.hY,p=u.CWa,d=0;for("add_current"===u.dataSource[0].key&&(f=1),u.hY=[],e=0;e<p.length&&(t=p[e],!(d>=h.length));e++)if(t.key===h[d].text){for(d++,o=t.children,n=Nt,r=0;r<o.length;r++)i=o[r],a=c[f],!1!==i.show&&(f+=1),n=a||n,3!==a&&(i.status=a);if(2!==n)u.hY.push({text:t.key,value:t.value,type:t.type});else if((s=u.gLb)[e])if(s[e].value===t.value)u.gLb[e]=null;else for(l=e+1;l<s.length;){if(s[l]&&s[l].value===t.value){u.gLb[l]=null;break}l++}}},e.prototype.KY=function(t,e){var o,n=this,r=n.eXa,i=_t[e];r.suspendPaint(),r.outlineColumn.Wlb(i),r.resumePaint(),n.DZa(),n.hY=e?$t(n.gY):[],!e&&n.hLb&&(n.hLb=!1),e&&n.iLb&&((o=r.outlineColumn.Kia.QR[0])&&o.checkBox&&(r.outlineColumn.Kia.QR[0].checkBox.checkStatus=0),r.outlineColumn.refresh()),n.MY(),g(t)},e.prototype.kXa=function(t){switch(t){case Rt:this.FWa=this.MWa;break;case It:this.FWa=this.PWa;break;case xt:this.FWa=this.RWa}},e.prototype.lXa=function(t){var e=this;e.FWa=t,e.FWa.Ao(),e.FWa.mXa()},e.prototype.nXa=function(t){var e,o,n,i=m(t);0!==i&&(e=this,n=(o=t.attr("id"))===Tt,1===i?n||o===St?(e.JY(n),e.close()):o===T?e.close():o===Rt?e.FWa!==y?e.FWa.oXa():e.lXa(e.MWa):o===It?e.lXa(e.PWa):o===xt?e.lXa(e.RWa):o===At?e.WW():r.GC$("#"+w).trigger(K):2===m(t)||3===m(t)?e.FWa&&e.FWa.oXa():r.GC$("#"+w).trigger(K))},e.prototype.iYc=function(t,e){var o,n,r,i=this;return!(t[0]&&"INPUT"===t[0].nodeName||(m(t)?(i.FWa===y&&i.kXa(e),i.FWa===y||i.FWa.P$a||i.FWa.uXa(),t.trigger(rt),t.trigger(at),t.trigger(K)):C(this.activeItemIndex)||(o=i.eXa,n=this.activeItemIndex,0,o.outlineColumn.getCheckStatus(n,0)===i.dataSource[n].status&&(r=o.outlineColumn,r.setCheckStatus(n,i.MZa(i.dataSource[n].status))),i.DZa()),0))},e.prototype.pXa=function(){var t,e,o,n,r=this.CWa,i=this.gY,a=0,s=[];for(t=0;t<r.length;t++)if(r[t].key===i[a].text)for(a++,e=r[t].children,o=0;o<e.length;o++)!1!==(n=e[o]).show&&s.push(n.value||r[t].key);return s},e.prototype.qXa=function(t,e,o){var n,r,i=this,a=i.elementList;return!m(e)&&C(i.activeItemIndex)?n=a[0]:(m(e)?Yt(e,F):i.jXa(i.eXa),r=i.pXa(),n=4===t?i.rXa(r,e,o):i.sXa(r,e,t)),n},e.prototype.sXa=function(t,e,o){var n,r,i,a,s=this,l=s.elementList,u=e[0],c=l.length-2,f=$t(l),h=s.activeItemIndex||0,p=0;for(r=0;r<m(t);r++)f.splice(-2,0,t[r]);if(a=3===o,(i=u?b(u,f):c+h)>=0){for(n=a?f[i+1]:f[i-1],h=h||0,p=a?i+1:i-1,b(n,t)>=0&&m(e)>0&&(i=a?i+h:h+(l.length-2),n=a?f[i+1]:f[i],p=a?i+1:i);a&&i<m(f)&&s.RY(n);)p=i+1,n=f[(i+=1)+1];if(!a){for(;i>0&&s.RY(n);)p=i-1,n=f[(i-=1)-1];n||(n=f[m(f)-1])}n||(n=f[0])}return typeof n===X?p-c:n},e.prototype.rXa=function(t,e,o){var n,r,i=this,a=i.elementList,s=e[0],l=$t(a),u=i.activeItemIndex||0;if(l.splice(-2,0,t[u]),m(e)){if((r=b(s,l))>=0){for(n=o?l[r-1]||l[m(l)-1]:l[r+1];o&&r>0&&i.RY(n);)n=l[(r-=1)-1];for(;!o&&i.RY(n)&&r<m(l);)n=l[(r+=1)+1]}}else n=o?a[a.length-3]:i.RY(a[a.length-2])?a[a.length-1]:a[a.length-2];return n||(n=l[0]),typeof n===X?u:n},e.prototype.QY=function(t){var e,o,n,i=this,a=r.GC$("."+D,i.xo[0]),s=t.which||t.keyCode,l=b(s,[27,13,38,40,9,37,39,32]);if(a.length>0&&(e=a.attr("id")),0===l)i.close(),g(t);else if(1===l)this.nXa(a);else if(l>4){if(5===l)i.FWa===y&&i.kXa(e),i.FWa!==y&&(i.FWa=i.FWa.tXa());else if(6===l)i.FWa===y&&i.kXa(e),i.FWa===y||i.FWa.P$a||i.FWa.uXa();else if(7===l&&!this.iYc(a,e))return;g(t)}else l>1&&i.FWa!==y&&i.FWa.cXa()?(2===l||4===l&&t.shiftKey?i.FWa.vXa():(3===l||4===l&&!t.shiftKey)&&i.FWa.wXa(),g(t)):l>1&&("number"==typeof(o=i.qXa(l,a,t.shiftKey))?(a=o,i.gXa({sheet:i.eXa,row:a,sheetArea:3,ignoreClick:!0}),i.eXa.Yq(a,i.iXa),r.GC$("#"+jt).focus(),g(t)):((n=(a=r.GC$(o)).attr("id"))!==S&&n!==w&&n!==T&&n!==x&&n!==A?a.find("a").focus():a.focus(),qt(a,I+" "+F),g(t)))},e.prototype.RY=function(t){return typeof t!==X&&(t=r.GC$(t),0!==m(t)&&!!(t.hasClass(P)||t.hasClass(L)||t.hasClass(G)))},e.prototype.PY=function(t){var e,o,n,r,i=this,a=i.sheet;if(a)try{if(a.suspendPaint(),!(o=(e=i.filterButtonInfo).rowFilter))return;n=e.col,r={tableName:o.sj?o.sj.name():Nt,colIndex:n,checkedValues:t,allValuesLength:m(i.fY)},a.wu().execute({cmd:"filterTextSelectAction",sheetName:a.name(),cmdOption:r})}finally{a.resumePaint()}},e.prototype.NY=function(){var t,e,o,n,i,a,s,l,c,f,h,p,d,g,y,C=this,v=r.GC$.trim(r.GC$("#"+S).val().toLowerCase()),b=C.CWa,w=C.a$a,T={},x=C.gLb;if(x.forEach((function(t){t&&t.repeat&&delete t.repeat})),v){for(o=[],n=void 0,(e=u.ub(v))||(n=RegExp(v.replace(C.rEscape,"\\$&"),"gi")),t=0;t<b.length;t++)for(a=(i=b[t]).children,s=0;s<a.length;s++){if(l=a[s],c=i.key,f=i.type,h=l.value||c,(p=e&&u.sb(e).exec(h))&&0===p.index||!e&&-1!==h.search(n)){if(o.push({text:c,value:i.value,type:f}),(d=x[t])&&d.value===i.value)d.repeat=!0;else for(g=t+1;g<x.length;){if((y=x[g]).value===i.value){y.repeat=!0;break}g++}T[c]=!0;break}x[t]&&x[t].repeat&&delete x[t].repeat}C.jLb=!0,C.gY=$t(o),C.fLb=x,C.hY=$t(o),C.HY(T)}else if(m(w)){for(this.iLb=!1,t=0;t<w.length;t++)1!==w[t].status&&(w[t].status=1);C.gY=$t(C.fY),C.hY=$t(C.fY),C.AXa(w),C.dataSource=w}else this.iLb=!1,C.a$a=$t(C.dataSource)},e.prototype.EY=function(t,e){var o=r.GC$(p("a"));return o.attr({id:t,href:Z}).text(e).css([ht,ct,"cursor",st,"text-decoration","text-align",J,"outline",gt],["block","0 6px","default","0px 0 1px 2px",pt,mt,"12px",pt,"inherit"]),qt(o[0],M+k+j),o},e.prototype.v$a=function(t,e,o){var n,i,a,s=Ht().Clear,l=r.GC$(p("a")).html(s.replace("{0}",'"'));l.attr({id:t,href:Z}).css([ht,ct,"cursor",st,"text-decoration","text-align",J,"outline",gt,"white-space"],["inline","0 6px","default","0px 0 1px 2px",pt,mt,"12px",pt,"inherit","nowrap"]),o.append(l),n=o.width()-l[0].offsetWidth,a='<span class="filterName">'+f(e)+'</span><span style="vertical-align: top">"</span>',i=s.replace("{0}",a),l.html(i),r.GC$(".filterName",l[0]).css(["max-width","overflow","text-overflow",ht,"vertical-align"],[n+"px","hidden","ellipsis","inline-block","text-bottom"]),qt(l[0],M+k+j)},e.prototype.FY=function(t,e,o){var n=p(et),i=r.GC$(p(et)).text(e),a=p("a"),s=r.GC$(a);return qt(n,"gc-check-uncheck-all "+o),s.attr({href:Z,id:t}).css(["float",lt,ct,J,gt],[mt,"7px","0","12px","16px"]).append(r.GC$(n)).append(i),qt(a,H+H+"-style"),s},e.prototype.xXa=function(t){return"date"===t?void this.DWa.Date++:"number"===t||"boolean"===t?void this.DWa.Number++:"string"===t?void this.DWa.Text++:void 0},e.prototype.yXa=function(){var t=this.DWa.Date,e=this.DWa.Number,o=this.DWa.Text,n=t+e+o;return n>t&&n>e&&n>o?"mix":n===t?"type":n===e?"number":n===o?"text":void 0},e.prototype.YZa=function(t){var e,o=!0,n=t.rZ[this.filterButtonInfo.col];return n&&n.length>0&&(n=n[0],e=this.i$a(n),(0!==n.compareType()||e||0===n.compareType()&&5===n.conType())&&(o=!1)),o},e.prototype.qxb=function(t){var e,o=this.pxb[t];return C(o)&&(e=t.replace(/(\[[^h^m^s]+\])|(General)/gi,""),o=h.Lc(e),this.pxb[t]=o),o},e.prototype.T0=function(t,e){return"number"===vt(e)&&"string"===vt(t)&&this.qxb(t)?bt(e):e},e.prototype.Q$a=function(t,e,o,n,r,i){Zt(t!==y&&t.backColor,o,n,r,i),Zt(t!==y&&t.foreColor,e,n,r,i)},e.prototype.zY=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C=this,v=C.filterButtonInfo.rowFilter;if(v){if(n=(o=(e=C.sheet).Tq(v.range)).col,r={},i=[],a={},s=[],u=e.currentTheme(),c={},f={data:{},colorNumber:0},h={data:{},colorNumber:0},p=e.outlineColumn&&e.outlineColumn.XQa(t),d=C.V$a.sortByColor||C.V$a.filterByColor,C.hasBlank=!1,t>=n&&t<n+o.colCount)for(g=o.rowCount,e.yUc&&(g=Math.min(g,100)),m=0;m<g;m++)y=o.row+m,(e.getRowHeight(y)>0||!v.isFiltered()||v.ima(y,t))&&d&&(l=e.getActualStyle(y,t,3,!1,!1,!0),this.Q$a(l,h,f,u,y,c)),C.u$a(r,a,i,y,t,s);C._Wa=f,C.aXa=h,p||(i.sort(Xt),s.sort(Xt)),C.fY=i,C.gLb=s,C.gY=$t(i),C.CWa=C.zXa(t,a,i),C.a$a=C.dataSource}},e.prototype.$gc=function(t,e,o){var n,r=this.sheet;return o||((n=r.getActualStyle(t,e))&&n._autoFormatter&&n._autoFormatter.formatCached?n._autoFormatter.formatCached:void 0)},e.prototype.u$a=function(t,e,o,n,r,i){var a,s,l,u,f,h,p,d,g,m=this,y=m.sheet,C=m.filterButtonInfo.rowFilter,v=y.getText(n,r),b=y.getValue(n,r);a=v=v?v.trim():v,s=Ht().Blanks,l=y.getRowHeight(n)>0,u=m.YZa(C),f=y.outlineColumn&&y.outlineColumn.XQa(r),(h=y.getFormatter(n,r))&&!c(h)&&(b=m.T0(h,b)),d="date"===(p=te(b,m.$gc(n,r,h))),m.xXa(p),1===m.DWa.Date&&(m.XZa=ne(h)),d&&(a=C.mzb.format(b)),g=u&&(l||!C.isFiltered(r)||f&&y.getRowVisible(n,3,!0)&&!C.WY(n,r)),""!==v||!l&&C.isFiltered()&&!C.ima(n,r)?t[a]||y.getRowVisible(n,3,!0)&&y.Yr(n)&&(g?(e[v]=!0,m.hY.push({text:v,value:b,type:p}),i.push({text:v,value:b,type:p})):i.push({text:v,value:b,noCheck:!0,type:p}),(l||!C.isFiltered()||C.ima(n,r))&&(o.push({text:v,value:b,type:p}),t[a]=!0)):m.hasBlank||(m.hasBlank=!0,o.push({text:s,value:b,type:p}),g?(e[s]=!0,m.hY.push({text:s,value:b,type:p}),i.push({text:s,value:b,type:p})):i.push({text:s,value:b,noCheck:!0,type:p}))},e.prototype.zXa=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g,m=this,y=[],C=[],v=m.sheet,b=v.Tq(m.filterButtonInfo.rowFilter.range),w=v.outlineColumn;if(w&&w.XQa(t))for(l=0;l<o.length;l++)h=o[l].text,p=o[l].value,d=o[l].type,s=_t[!!e[h]],u=oe(v,h,p,b.row+l,t,s,d),y.push(u),(f=u.children[0])&&!1!==f.show&&C.push({name:f.value||u.key,level:f.level,status:f.status});else for(l=0;l<o.length;l++)switch(h=o[l].text,p=o[l].value,d=o[l].type){case"date":for(s=_t[!!e[h]],n=(c=(u=ee(m.XZa,h,p,s,d)).children)[0].value,r=c[1].value||c[0].value,c[0].show=c[1].show=!0,n===i&&(c[0].show=!1,r===a&&(c[1].show=!1)),i=n,a=r,y.push(u),f=u.children,g=0;g<3;g++)f[g]&&!1!==f[g].show&&C.push({name:f[g].value||u.key,level:f[g].level,status:f[g].status});break;case"number":case"string":case"boolean":case"blank":case"array":case"object":s=_t[!!e[h]],u=oe(v,h,p,b.row+l,t,s,d),y.push(u),(f=u.children[0])&&!1!==f.show&&C.push({name:f.value||u.key,level:f.level,status:f.status})}return m.dataSource=C,y},e.prototype.AY=function(t){var e=this,o=e.itemList,n=new r.Workbook(o[0]);n.jDc=!0,e.hXa=n,e.eXa=n.getActiveSheet(),e.iXa=0,e.AXa(t),e.DZa()},e.prototype.AXa=function(t){var e,o,n,i,a,s,l=this,u=l.hXa,c=l.itemList,f=c.width(),h=c.height();l.hXa.sheets.length>0&&(l.hXa.removeSheet(0),l.eXa=Nt),u.addSheet(0,new r.Worksheet("sheet1")),e=l.eXa=u.sheets[0],u.suspendEvent(),e.suspendPaint(),o=u.options,n=e.options,o.allowContextMenu=!1,o.showHorizontalScrollbar=!1,o.showVerticalScrollbar=!1,o.scrollbarMaxAlign=!0,o.tabStripVisible=!1,o.allowUserResize=!1,o.allowUserDragDrop=!1,o.allowUserDragFill=!1,o.allowUserZoom=!1,o.grayAreaBackColor="white",n.colHeaderVisible=!1,n.rowHeaderVisible=!1,n.selectionBackColor="transparent",n.selectionBorderColor="transparent",n.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},n.protectionOptions.allowOutlineRows=!0,n.isProtected=!0,e.defaults.rowHeight=20,e.defaults.colWidth=10,e.setRowCount(0===t.length?0:t.length+1),(i=new r.Style).font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',e.setDefaultStyle(i),e.outlineColumn.options({columnIndex:l.iXa,showIndicator:!0,showCheckBox:!0}),e.showRowOutline(!1),e.setColumnCount(1),t.length>0&&l.jLb?(l.jLb=!1,t.unshift({name:Ht().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),l.iLb=!0):0===t.length&&(l.jLb=!1),l.BXa(e,t),20*t.length>h&&(u.options.showVerticalScrollbar=!0,f-=22),a=e.jt(1).length,l.PZa(e,f,10,0,a,t),!u.options.showVerticalScrollbar&&u.options.showHorizontalScrollbar&&(h-=22,20*t.length>h&&(u.options.showVerticalScrollbar=!0,f-=22)),s=Math.ceil(f/10),e.addColumns(e.getColumnCount(),s-1),e.outlineColumn.refresh(),e.resumePaint(),u.resumeEvent()},e.prototype.BXa=function(t,e){var o,n,r,i,a,s,l;if(0!==e.length){if(o=this,n=0,i=0,a=t.outlineColumn,s=o.iXa,t.suspendPaint(),t.autoGenerateColumns=!1,t.bindColumn(0,"name"),t.setDataSource(e),"text"!==(l=o.yXa())&&"number"!==l||o.sheet.outlineColumn&&o.sheet.outlineColumn.XQa(o.filterButtonInfo.col))for(i=0;i<e.length;i++)n=e[i].level,t.getCell(i,s).textIndent(n);else t.getCell(-1,s).textIndent(n);for(a.refresh(),i=0;i<e.length;i++)r=e[i].status,a.CXa(i,r);t.resumePaint()}},e.prototype.HY=function(t){var e=this;e.zXa(e.filterButtonInfo.col,t,e.gY),e.AXa(e.dataSource)},e.prototype.JY=function(t){var e,o,n,i,s=this,l=s.filterButtonInfo,u=l.rowFilter,c=s.sheet,f=c.Tq(s.filterButtonInfo.rowFilter.range);u&&c&&c.hK()&&(e=c.oec(f,!0,null),o=l.col,n={sheet:c,sheetName:c.name(),col:o,ascending:t,range:f,compareFunction:Nt,groupSort:e.groupSort,ignoreHidden:e.ignoreHidden,cancel:!1},c.Wq(r.Events.RangeSorting,n),!1===n.cancel&&(i={tableName:u.sj?u.sj.name():Nt,colIndex:o,compareFunction:n.compareFunction,groupSort:n.groupSort,ignoreHidden:n.ignoreHidden,isAsc:t},a.h4("sortFilter",i,c),c.Wq(r.Events.RangeSorted,n)))},e.prototype.DXa=function(t,e,o){var n,i,s,l=this.filterButtonInfo,u=l.rowFilter,c=this.sheet;u&&c&&c.hK()&&(o=o!==Nt&&o,n=l.col,i={sheet:c,sheetName:c.Cj,col:n,ascending:o,color:t,isBackColor:e,cancel:!1},c.Wq(r.Events.RangeSorting,i),!1===i.cancel&&(s={tableName:u.sj?u.sj.name():Nt,colIndex:n,isAsc:o,color:t,isBackColor:e},a.h4("sortFilter",s,c),c.Wq(r.Events.RangeSorted,i)))},e.prototype.MY=function(){var t=r.GC$("#"+w),e=P+L+" "+G;this.hLb||m(this.hY)>0?(t.prop("disabled",!1),Yt(t[0],e)):(t.prop("disabled",!0),qt(t[0],e))},e}(r.Go),e.gZ=Ut},"./dist/plugins/filter/filter.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/filter/filter-ns.js")),o("./dist/plugins/filter/filter-actions.js"),n(o("./dist/plugins/filter/filter-ui.js")),n(o("./dist/plugins/filter/filter.js"))},"./dist/plugins/filter/filter.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function E(t,e,o,n){var r,i;for(i=0;i<b(t);i++)if((r=t[i])&&r.row===e&&r.col===o&&r.sheetArea===n)return r;return u}function j(t,e){var o,n=G(t),r=t.compareType();2===n||7===n?(o=t.jzb,-1!==y(e,"T")||o?-1===y(e,"DT")&&o&&e.push("DT"):e.push("T")):3===n?0===r&&-1===y(e,"BC")?e.push("BC"):1===r&&-1===y(e,"FC")&&e.push("FC"):-1===y(e,"V")&&e.push("V")}function P(t){return t.getColumnCount()}function L(t,e){return t.getRowCount(e)}function G(t){return t.conType()}function B(t,e,o){var r,i,a=t.typeName;a&&a!==w?(r=n.getTypeFromString(a))&&(i=new r):i=new k,i&&(e.xr=i,i.kj=e,i.fromJSON(t,o),i.reFilter())}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("ConditionalFormatting"),a=o("./dist/plugins/filter/filter-ui.js"),s=o("./dist/plugins/filter/filter-ns.js"),l=o("./dist/plugins/filter/filter-button-images.js"),u=null,c=void 0,f=i.$V,h=n.kf,p=r.Common.j.Fa,d=r.Common.j.Ca,g=parseInt,m=r.Common.k,y=m.Cb,C=m.Bb,v=m.Fb,b=m.ac,w="HideRowFilter",T=n.GC$,S=T.each,x=new r.Common.ResourceManager(s.SR,"Filter"),A=x.getResource.bind(x),e.h4=function(t,e,o){var r,i={cmd:t,sheetName:o.name(),cmdOption:e};o.yUc?(r=n.Commands[i.cmd])&&r.execute(o.parent,i,0):o.wu().execute(i)},I={rowFilter:function(t){var e=this,o=e.xr;return b(arguments)?(e.ITa.gVa(o,0),o&&o.reset(),(o=e.xr=t)&&(e.xr.kj=e),e.$p(),e):o},iZ:function(){var t,e,o,n,r,i,s,l,u,c,f=this,p=[],d=f.rowFilter(),g=d&&d.range,m=f.tables;if(g&&(n=g.row,i=void 0,s=(r=g.col)<0?P(f):r+g.colCount,e=r<0?0:r,n<1?(t=L(f,1)-1,i=1):(t=n-1,i=3),t>=0))for(;e<s;)d.filterButtonVisible(e)?(l=f.ITa.getSpans(h(t,e,1,1),i),u=void 0,(o=new a.eY(d)).sheetArea=i,o.row=t,b(l)?(u=l[0],o.row=u.row,o.col=u.col,e+=u.colCount):(o.col=e,e++),p.push(o)):e++;return m&&(c=m.all(),S(c,(function(n,r){if(t=r.headerIndex(),r&&r.showHeader()&&t>=0){var i=r.range(),s=void 0;for(s=0;s<i.colCount;s++)e=i.col+s,r.filterButtonVisible(s)&&(o=new a.eY(r.rowFilter(),t,e,3),p.push(o))}}))),p},jZ:function(){var t=this,e=t.kZ;return e||(e=t.kZ=t.iZ()),e},Ps:function(t,e){var o=this.filterRowsVisibleInfo;return p(e)&&(e=3),!(3!==e&&2!==e||!o||o.lZ(t))},Nu:function(){return this.filterRowsVisibleInfo.mZ()},oK:function(t,e){var o=this,n=o.zoom(),r=o.parent,i=n>1?1:n,a=3===e||e===c?o.defaults.rowHeight:o.defaults.colHeaderRowHeight,s=g(""+Math.min(20,a)*i);return r&&r.options.useTouchLayout&&(s=g(""+a*n)),{x:t.x+t.width-s,y:t.y+t.height-s,width:s,height:s}}},T.extend(n.Worksheet.prototype,I),function(t){t[t.filter=0]="filter",t[t.unfilter=1]="unfilter"}(e.FilterActionType||(e.FilterActionType={})),R={sortByValue:!0,sortByColor:!0,filterByColor:!0,filterByValue:!0,listFilterArea:!0},M=function(){function t(t){var e=this;e.range=t,e.reset(),e.typeName="",e.filterHandler=u}return t.prototype.no=function(){this.kj=u,this.sj=u},t.prototype.filterButtonVisible=function(t,e){var o,n,r,i,a,s,l,u,f,h,d,g=this,m=g.range;if(!p(m)){if(o=g.kj,n=g.oZ(m),r=g.pZ(m,o),i=arguments,a=g.qZ,s=t>=n&&t<r,l=b(i),f=typeof(u=i[0]),0===l){for(h=n;h<r;h++)if(a[h]||a[h]===c)return!0;return!1}if(d=t,1===l){if("number"===f)return s&&a[d]===c&&(a[d]=!0),a[d];if("boolean"===f)for(o&&o.ITa.gVa(g,3),h=n;h<r;h++)a[h]=u}else 2===l&&s&&(o&&o.ITa.gVa(g,4,t),a[d]=e);return o&&o.$p(),g}},t.prototype.oZ=function(t){return t.col<0?0:t.col},t.prototype.pZ=function(t,e){return e&&t.col<0?P(e):t.col+t.colCount},t.prototype.addFilterItem=function(t,e){var o,n=this,r=n.kj,a=n.range,s=n.rZ,l=s[t];if(p(e))throw Error(A().Exp_FilterItemIsNull);if(t<-1||t>=P(r))throw Error(A().Exp_InvalidColumnIndex);if(a){if(r.ITa.gVa(n,5),t<(a=r.Tq(a)).col||t>=a.col+a.colCount)return;if(l||(l=[]),e instanceof i.Condition)l.push(e);else if(d(e))for(o=0;o<e.length;o++)l.push(e[o]);s[t]=l}},t.prototype.removeFilterItems=function(t,e){this.kj.ITa.gVa(this,6),this.NX(t),this.unfilter(t,e)},t.prototype.NX=function(t){var e=this.rZ;this.sZ(t),e[t]&&e.splice(t,1,u)},t.prototype.unfilter=function(t,e){var o,n,r,i=this,a=i.kj;if(a){if(a.ITa.gVa(i,2),o=[],n=i.Je,r=void 0,p(t))for(r=b(n)-1;r>=0;r--)o.push(n[r]),i.OX(n[r]);else o.push(t),i.OX(t),i.reFilter(e);e||i.tZ(a,1,o)}},t.prototype.uZ=function(t){var e,o,n,r,i,a,s=this,l=s.range;if(s.OX(t),s.rZ[t]&&l){if(-1!==(e=l.col)&&(t<e||t>=e+l.colCount))return;for(o=(l=s.kj.Tq(l)).row,n=l.rowCount,r=s.vZ(t,o,n),i=void 0,(a=s.wZ(o,n,t,r)).forEach((function(t){t.nxb()})),i=o;i<o+n;i++)s.isRowFilteredOut(i)||s.xZ(a,i,t,r);a.forEach((function(t){t.oxb()})),s.RX(t,!0)}},t.prototype.vZ=function(t,e,o){var n,r,i,a,s,l,u,c,f=this,h=f.kj,p=function(t){var e,o,n,r,i=[];for(e=0;e<b(t);e++)0===G(o=t[e])?(n=o.item1(),r=o.item2(),n&&j(n,i),r&&j(r,i)):j(o,i);return i}(f.rZ[t]),d={},g=b(p);for(n=e;n<e+o;n++){for(s={},r=0;r<g;r++)"T"===(i=p[r])?(l=h.getText(n,t),s[i]=l?l.trim():l):"DT"===i?(u=h.getValue(n,t),c=f.mzb,s[i]=c.format(u)):"BC"===i?(a=h.getActualStyle(n,t,3,!1,!1,!0))&&(s[i]=a.backColor):"FC"===i?(a=h.getActualStyle(n,t,3,!1,!1,!0))&&(s[i]=a.foreColor):"V"===i&&(s[i]=h.getValue(n,t));d[n]=s}return d},t.prototype.filter=function(t,e){var o,n,r=this,i=r.kj,a=r.rZ;if(i){if(i.ITa.gVa(r,7),n=[],p(t))for(o=0;o<b(a);o++)a[o]&&(n.push(o),r.uZ(o));else{if(!a[t])return;n.push(t),r.uZ(t)}e||r.tZ(i,0,n)}},t.prototype.tZ=function(t,e,o){var n,r=this;t.AR&&t.AR(),n=r.SX(e,o),r.filterHandler&&r.filterHandler(n),r.onFilter(n),t.$p()},t.prototype.SX=function(t,e){var o,n,r,i=this,a=i.kj,s=i.range,l=[],u=[];if(s)for(r=void 0,r=n=(o=a.Tq(s)).row;r<n+o.rowCount;r++)i.isRowFilteredOut(r)?u.push(r):l.push(r);return{action:t,sheet:a,range:s,filteredRows:l,filteredOutRows:u,columns:e}},t.prototype.onFilter=function(t){},t.prototype.isFiltered=function(t){var e=this.Je;return arguments.length?C(e,t):e.length>0},t.prototype.isRowFilteredOut=function(t){var e,o,n=this,r=n.range;return!(!n.isFiltered()||!r||(e=r.row,o=n.LX[t],-1!==e&&(t<e||t>=e+r.rowCount)||b(o)>=b(n.Je)))},t.prototype.reset=function(){var t=this,e=t.kj;e&&e.ITa.gVa(t,8),t.zZ=u,t.unfilter(),t.rZ=[],t.Je=[],t.yZ=[],t.LX={},t.qZ={}},t.prototype.Dl=function(t,e,o){var n,r,i,a=!1,s=this.kj,l=this.range;return l&&(n=(l=s.Tq(l,o)).row,i=e>=(r=l.col)&&e<r+l.colCount,(1===o&&t===L(s,o)-1&&n-1<0&&i||3===o&&t===n-1&&i)&&(a=!0)),a},t.prototype.getFilterItems=function(t){return this.rZ[t]||[]},t.prototype.getFilteredItems=function(){return this.yZ},t.prototype.sortColumn=function(t,e){this.eLb(t,e,null)},t.prototype.eLb=function(t,e,o,n,r){var i,a,s=this,l=s.kj;if(l){i=l.Tq(s.range),l.suspendPaint();try{l.ITa.gVa(s,1),a={index:t,ascending:e,compareFunction:o},l.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[a],n,u,r)&&(s.zZ=a,s.isFiltered(t)&&s.reFilter())}finally{l.resumePaint()}}},t.prototype.sortColumnByColor=function(t,e,o,n,r,i){var a,s,l=this,c=l.kj;c&&(a=c.Tq(l.range),c.suspendPaint(),c.ITa.gVa(l,1),s={index:t,ascending:e,color:o,isBackColor:n},c.sortRange(a.row,a.col,a.rowCount,a.colCount,!0,[s],r,u,i)&&(l.zZ=s,l.isFiltered(t)&&l.reFilter()),c.resumePaint())},t.prototype.getSortState=function(t){var e=this.zZ,o=0;return e&&e.index===t&&(o=e.ascending?1:2),o},t.prototype.reFilter=function(t){var e,o=this,n=o.Je,r=b(n);for(o.kj.ITa.gVa(o,13),o.LX={},o.yZ=[],o.Je=[],e=0;e<r;e++)o.filter(n[e],t)},t.prototype.openFilterDialog=function(){},t.prototype.QX=function(t,e){var o=this.LX,n=o[t];p(n)?n=[e]:(C(n,e)&&v(n,e),n.push(e)),o[t]=n},t.prototype.PX=function(t){var e=this.yZ;C(e,t)||e.push(t)},t.prototype.OX=function(t){var e,o,n=this,r=n.LX;if(n.range&&n.isFiltered(t)){for(o in n.RX(t,!1),r)o&&((e=r[o])&&C(e,t)&&(v(e,t),b(e)||(r[o]=c)));n.sZ(t)}},t.prototype.RX=function(t,e){var o=this.Je;if(e){if(b(o)){if(o[b(o)-1]===t)return;v(o,t)}o.push(t)}else v(o,t)},t.prototype.sZ=function(t){var e,o,n=this.rZ,r=n.length,i=[],a=[];for(e=0;e<r;e++)e===t?i=i.concat(n[e]):a=a.concat(n[e]);for(o=i.length,e=0;e<o;e++)C(a,i[e])||v(this.yZ,i[e])},t.prototype.wZ=function(t,e,o,n){var r,i,a,s=this,l=s.rZ[o],u={},f=[];for(r=0;r<b(l);r++)2!==G(i=l[r])||0!==i.compareType()||i.forceValue2Text()||i.useWildCards()||i.ignoreCase()||i.ignoreBlank()?f.push(i):i.jzb?u[s.mzb.format(i.Ygc)]=i:u[i.expected()]=i;for(r=t;r<t+e;r++)a=s.isRowFilteredOut(r),u[n[r].T]===c&&u[n[r].DT]===c||(s.QX(r,o),a||s.PX(i));return f},t.prototype.xZ=function(t,e,o,n){var r,i,a,s,l,u,c=this,f=c.range;for(r=0;r<b(t);r++)if(a=(i=t[r]).item1(),s=i.item2(),l=void 0,u=void 0,0===G(i)?(a&&(l=c.AZ(a,e,o,f,n)),s&&(u=c.AZ(s,e,o,f,n))):l=c.AZ(i,e,o,f,n),i.evaluate(c.kj,e,o,l,u)){c.QX(e,o),c.PX(i);break}},t.prototype.AZ=function(t,e,o,n,r){var i,a,s,l=u,c=G(t),f=t.compareType(),p=r[e];return 8!==c&&10!==c||(i=[],(s=(a=this.kj.Tq(n)).col)<=o&&o<s+a.colCount&&i.push(h(a.row,o,a.rowCount,1)),t.ranges(i)),2===c||7===c?l=p.T:3===c?0===f?l=p.BC:1===f&&(l=p.FC):l=p.V,l},t.prototype.E0a=function(t,e){var o,n,r,i=this.Je;return!!b(i)&&(n=this.LX[t],r=b(n),p(n)||r<0?o=!0:o=y(n,e)<0,o)},t.prototype.WY=function(t,e){var o,n,r,i,a=this.Je;return!!b(a)&&(o=-1,n=y(a,e),r=this.LX[t],i=b(r),n>0&&(o=a[n-1]),o>-1?!!i&&o===r[i-1]:!i)},t.prototype.ima=function(t,e){var o,n,r,i=this.Je;return!b(i)||(o=y(i,e),n=this.LX[t],(r=b(n)||0)>=b(i)||!(o<0||r<b(i)-1)&&(!n||y(n,e)<0))},t.prototype.rI=function(t,e,o){var n,r,i,a,s,l,u,f,p,d=this,g=d.range;if(g&&(n=L(d.kj)-e-1,r=g.row,i=g.col,a=g.rowCount,s=g.colCount,r>-1&&(n=r+a-1,t<r||o&&t===r&&0===t?d.BZ(h(r+e,i,a,s)):t<r+a&&d.BZ(h(r,i,a+e,s))),l=d.LX,d.isFiltered()&&l)){for(u=[],f=void 0,f=0;f<b(l);f++)u.push(f);for(u.sort(),f=0;f<b(u);f++)(p=u[f])>=t&&p<=n&&(l[p+e]=l[p],l[p]=c)}},t.prototype.tI=function(t,e){var o,n,r,i,a,s,l,u,c,f,p,d=this,g=d.sj?d.sj.dataRange():d.range;if(g){if(o=g.row,n=g.col,r=g.rowCount,i=g.colCount,a=0,s=-1,l=0,t>=0&&d.CZ()){for(u=0;u<e;u++)u+t<=d.DZ()&&a++;d.DZ(d.DZ()+a)}for(n>-1&&(t<=n?(s=n,l=i,d.BZ(h(o,n+e,r,i))):t<n+i&&(s=t,l=i-(t-n),d.BZ(h(o,n,r,i+e)))),s<0&&(s=0,l=P(d.kj)-e),u=s+l-1;u>=s;u--)u>=t&&(c=u+e,(f=y(d.Je,u))>=0&&(d.Je[f]=c),p=d.rZ[u],b(p)&&(v(d.rZ,u),d.rZ[c]=p));d.reFilter()}},t.prototype.GR=function(t,e){var o,n,r,i,a,s,l,f,p,d,g=this,m=g.range,y=g.kj;if(m&&(o=0,n=L(y)+e-1,r=m.row,i=m.col,a=m.rowCount,s=m.colCount,r>-1&&(o=r,n=r+a-1,t<=r?y.$Bb?(g.BZ(h(t,i,a,s)),delete y.$Bb):r===t+1||r+a<=t+e?g.BZ(u):r<t+e?g.BZ(h(t,i,r+a-(t+e),s)):g.BZ(h(r-e,i,a,s)):t<r+a&&g.BZ(h(r,i,a-Math.min(r+a-t,e),s))),l=g.LX,g.isFiltered()&&l))for(f=o;f<=n;f++)f>=t&&f<t+e?l[f]=c:f>=t+e&&((d=l[p=f])&&(l[p-e]=d,l[p]=c))},t.prototype.BZ=function(t){this.kj.ITa.gVa(this,14),this.range=t},t.prototype.EZ=function(t){var e,o,n,r,i,a,s,l,f,h,p,d,g=this,m=g.kj,y=g.range;if(y)if(t){if(!t.equals(y)){if(n=y.col,r=y.colCount,i=t.col,a=t.colCount,s=P(m),g.isFiltered()&&!(n<0&&i<0))for(n<0&&(n=0,r=s),i<0&&(i=0,a=s),e=0;e<r;e++)(i>(o=n+e)||o>=i+a)&&g.removeFilterItems(o);if(l=y.row,f=y.rowCount,h=t.row,p=t.rowCount,d=L(m),g.isFiltered()&&g.LX&&!(l<0&&h<0))for(l<0&&(l=0,f=d),h<0&&(h=0,p=d),e=0;e<f;e++)(h>(o=l+e)||o>=h+p)&&(g.LX[o]=c)}}else g.reset();!g.CZ()||t&&t.contains(-1,g.DZ())||(g.zZ=u),g.BZ(t)},t.prototype.HR=function(t,e){var o,n,r,i,a,s,l,c,f=this,p=f.range,d=f.DZ(),g=t+e;if(p){for(t>=0&&f.CZ()&&(d>=t&&d<g?f.DZ(-1):d>=g&&f.DZ(d-e)),o=p.row,n=p.col,r=p.rowCount,n<0?(n=0,i=P(f.kj)+e):i=p.colCount,a=n;a<n+i;a++)a>=t&&(a<g?f.removeFilterItems(a):(s=a-e,l=y(f.Je,a),c=f.rZ[a],l>=0&&(f.Je[l]=s),b(c)&&(v(f.rZ,a),f.rZ[s]=c)));n>=0&&(t<n?g<=n?f.BZ(h(o,n-e,r,i)):g<=n+i?f.BZ(h(o,t,r,n+i-g)):f.BZ(u):t<n+i&&(g<=n+i?f.BZ(h(o,n,r,i-e)):f.BZ(h(o,n,r,t-n)))),f.reFilter()}},t.prototype.CZ=function(){var t=this.zZ;return!!t&&t.index>-1&&0!==this.getSortState(t.index)},t.prototype.DZ=function(t){var e,o=this,n=o.zZ;return b(arguments)?(n?n.index=t:o.zZ={index:t,ascending:!1},e=o):e=n?n.index:-1,e},t.prototype.$b=function(t,e,o,n){var r,i,a,s=this,l=s.range;l&&(r=h(t,e,o,n),s.filterButtonVisible()?(i=l.row-1,a=l.rowCount+1,i<0&&(i=-1,a=-1),r.containsRange(h(i,l.col,a,l.colCount))&&s.unfilter()):r.containsRange(l)&&s.unfilter())},t.prototype.fromJSON=function(t,e){var o,n,r,i,a,s,l,u,d,g,m,y,C,v,w,S,x;if(t){for(o=this,n=t.range,r=t.filterItemMap,i=o.rZ,a=t.sortInfo,s=t.showFilterButton,l=t.filterButtonVisibleInfo,n&&(o.range=h(n.row,n.col,n.rowCount,n.colCount)),t.dialogVisibleInfo&&(o.g_a=T.extend({},R,t.dialogVisibleInfo)),u=0;u<b(r);u++)for(y=(m=r[u]).conditions,d=0;d<b(y);d++)(C=y[d])&&(v=f(),S=i[w=m.index],v.fromJSON(C,e),S||(S=i[w]=[]),S.push(v));for(g=t.filteredColumns||t.filteredColMap,u=0;u<b(g);u++)p(g[u])||o.Je.push(g[u]);if(a&&a.color===c?o.zZ={index:a.index,ascending:a.ascending}:a&&a.color!==c&&(o.zZ={index:a.index,ascending:a.ascending,color:a.color,isBackColor:a.isBackColor}),s!==c)if(x=o.range,l)o.qZ=l;else if(x)for(u=o.oZ(x);u<o.pZ(x,o.kj);u++)o.qZ[u]=s}},t.prototype.toJSON=function(){var t,e,o,n,r,i,a,s,l,c,f=this,h={},p=f.range,d=f.qZ,g=f.rZ,m=f.Je,y=f.zZ,C=[],v=0,w=f.typeName,S=f.jXc;if(S&&(h.adjustRangeForFrozen=S),p&&(h.range=p),w&&(h.typeName=w),f.g_a){for(o in e={},f.g_a)f.g_a.hasOwnProperty(o)&&!1===f.g_a[o]&&(e[o]=!1);h.dialogVisibleInfo=e}for(t=0;t<b(g);t++)if(n=g[t]){for(r=[],i=void 0,i=0;i<b(n);i++)r.push(n[i]?n[i].toJSON():u);C[v]={index:t,conditions:r},v++}if(b(C)&&(h.filterItemMap=C),b(m)&&(h.filteredColumns=m),y&&(h.sortInfo=y),d)if(T.isEmptyObject(d))h.showFilterButton=!0;else{for(t in h.filterButtonVisibleInfo=T.extend({},d),a=!1,d)if(d[t]){a=!0;break}h.showFilterButton=a}for(s=[],c=f.kj.getRowCount(),l=0;l<c;l++)f.isRowFilteredOut(l)&&s.push(l);return s.length>0&&(h.filteredOutRows=s),h},t.prototype.TX=function(t){var e=t.options;return!e.isProtected||e.protectionOptions.allowFilter},t.prototype.hitTest=function(t,e,o){var n,r,i,s,l,c,f,h,p,d,g,m,y,C,v,b,w=this.kj;if(w){if(n=t.rowViewportIndex,r=t.colViewportIndex,i=t.hitTestType,s=w.it(r),1===i?(l=w.ut().findY(o),c=s.findX(e),f=1):3===i&&(l=w.jt(n).findY(o),c=s.findX(e),f=3),!l||!c)return u;if(h=l.row,p=c.col,d=w.getSpan(h,p,f),g=w.jZ(),d){if(m=d.row,y=d.col,h!==m+d.rowCount-1||p!==y+d.colCount-1)return u;h=m,p=y}return g&&((C=E(g,h,p,f))&&(v=w.getCellRect(h,p,n,r),(b=w.oK(v,f)).x<=e&&e<=b.x+b.width&&b.y<=o&&o<=b.y+b.height))?new a.eY(C.rowFilter,C.row,C.col,C.sheetArea,b.x,b.y,b.width,b.height):u}},t}(),e.RowFilterBase=M,k=function(t){function e(e){var o=t.call(this,e)||this;return o.typeName=w,o.g_a=T.extend({},R),o.mzb=new r.Formatter.GeneralFormatter("yyyy/mm/dd"),o}return F(e,t),e.prototype.onFilter=function(t){var e=this.kj;e&&(this.FZ(e,t.filteredRows,t.filteredOutRows),e.au())},e.prototype.filterDialogVisibleInfo=function(t){if(0===arguments.length)return this.g_a||(this.g_a=T.extend({},R)),this.g_a;if(t){var e={};return t.sortByValue!==c&&(e.sortByValue=!!t.sortByValue),t.sortByColor!==c&&(e.sortByColor=!!t.sortByColor),t.filterByColor!==c&&(e.filterByColor=!!t.filterByColor),t.filterByValue!==c&&(e.filterByValue=!!t.filterByValue),t.listFilterArea!==c&&(e.listFilterArea=!!t.listFilterArea),T.extend(this.g_a,e),this}},e.prototype.FZ=function(t,e,o){var n,r=t.filterRowsVisibleInfo;r&&(n=r.D4(e,o),t.recalcRows&&t.recalcRows(n))},e.prototype.openFilterDialog=function(t){var e,o=this,n=o.kj;o.TX(n)&&(e=new a.gZ(n.parent.xv(),n,t,o.filterDialogVisibleInfo()),n.GZ=e,e.OT())},e}(M),e.HideRowFilter=k,N=function(){function t(){this.hZ()}return t.prototype.lZ=function(t){if(this.empty)return!0;var e=this.rowsVisibleInfo[t];return!!p(e)||e},t.prototype.D4=function(t,e){var o,n,r,i,a,s,l,f,h=[],p=this.rowsVisibleInfo;for(o=0,n=t.length;o<n;o++)(i=p[r=t[o]])!==c&&i!==u&&h.push(r),delete p[r];for(a=0,s=e.length;a<s;a++)(f=p[l=e[a]])!==c&&f!==u||h.push(l),p[l]=!1;return this.empty=!1,h},t.prototype.hZ=function(){this.rowsVisibleInfo={},this.empty=!0},t.prototype.C_a=function(t,e){var o,n,r=this.rowsVisibleInfo;for(n=0;n<e;n++)o=r[n+t],p(o)||delete r[n+t]},t.prototype.NTa=function(t,e){var o,n,r,i=this.rowsVisibleInfo,a={};for(n=0,r=Object.keys(i);n<r.length;n++)(o=+r[n])>=t?a[o+e]=i[o]:a[o]=i[o];this.rowsVisibleInfo=a},t.prototype.PTa=function(t,e){var o,n,r,i=this.rowsVisibleInfo,a={},s=t+e;for(n=0,r=Object.keys(i);n<r.length;n++)(o=+r[n])>=t&&o<s?delete i[o]:o>=s?a[o-e]=i[o]:a[o]=i[o];this.rowsVisibleInfo=a},t.prototype.mZ=function(){return!this.empty},t.prototype.clone=function(){var e=new t;return e.rowsVisibleInfo=T.extend({},this.rowsVisibleInfo),e.empty=this.empty,e},t}(),O={init:function(){var t=this;t.xr=u,t.filterRowsVisibleInfo=new N,t.Wr.push({Xr:function(e){return t.filterRowsVisibleInfo.lZ(e)}}),function(t){t&&t.bind("shiftCellsDown",(function(e,o){var n,r,i,a,s=t.rowFilter();s&&(n=o.row,r=o.col,i=o.changedRowCount,a=o.changedColCount,s.range.row+s.range.rowCount===n&&(n-=1),s.range.col+s.range.colCount===r&&(r-=1),s.range.contains(n,r,1,1)&&(i>0?s.rI(n,i):i<0&&s.GR(n,i),a>0?s.tI(r,a):a<0&&s.HR(r,a)))}))}(t)},processMouseDown:function(t){var e=t.hitInfo.filterButtonHitInfo;e&&(e.rowFilter.openFilterDialog(e),t.r=!0)},onLayoutChanged:function(t){var e,o=this,n=t.changeType,r=t.row,i=t.rowCount,a=t.col,s=t.colCount,l=o.xr;return"invalidateLayout"===n?void(o.kZ=u):void(l&&(e=o.ITa,"addRows"===n?e.hVa(r,i,t.rowExpand):"deleteRows"===n?e.iVa(r,i):"addColumns"===n?e.jVa(a,s):"deleteColumns"===n?e.kVa(a,s):"clear"===n&&l.range&&e.lVa(r,a,i,s)))},dispose:function(){var t=this.GZ;t&&t.close(),function(t){t&&t.unbind("shiftCellsDown")}(this)},toJson:function(t,e){var o=this.xr,n=e&&e.ignoreStyle;o&&!n&&(t.rowFilter=o.toJSON())},fromJson:function(t,e,o){var n=t.rowFilter,r=o&&o.ignoreStyle;n&&!r&&B(n,this,e)},paintCell:function(t){var e,o,r,i,s,u,c,f,h=this,p=t.cell,d=p.width,g=p.height,m=p.cellLayout,y=h.vu(),v=h.jZ(),b=t.ctx;if((!m||!C([],m))&&v&&d>0&&g>0&&(e=E(v,p.row,p.col,t.sheetArea))){o=new a.eY(e.rowFilter,e.row,e.col,e.sheetArea,p.x,p.y,d,g),i=(r=h.oK(new n.Rect(o.x,o.y,o.width,o.height),o.sheetArea)).width,s=r.height,u=r.x,c=r.y,f=l.getFilterButtonImageSrc(o.ko()),b.save(),b.rect(o.x,o.y,o.width,o.height),b.clip(),b.beginPath(),b.lineWidth=1,b.fillStyle="#FFFFFF",b.strokeStyle="#CCCCCC",b.fillRect(u+1,c+1,i-3,s-3),b.strokeRect(u+1-.5,c+2-.5,i-3,s-4);try{y.ko(f)?b.drawImage(y.lo(f),u,c+1,i-3,s-3):y.fo(f)}catch(t){}b.beginPath(),b.restore()}}},n.Worksheet.$n("filter",O),D={init:function(){n.Commands.fVa(this.commandManager())},onCultureChanged:function(){A()}},n.Workbook.$n("filter",D),T.extend(n.lUa.prototype,{gVa:function(t,e){var o,n,r,i,a=this,s=a.zTa;if(s){switch(s.mVa||(s.mVa=[]),o={type:e,rowFilter:t},e){case 0:void 0,n=t?{range:t.range,typeName:t.typeName,Je:t.Je.concat([]),yZ:t.yZ.concat([]),rZ:t.rZ.concat([]),LX:T.extend({},t.LX),qZ:T.extend({},t.qZ),zZ:T.extend({},t.zZ)}:u,r=a.kj.filterRowsVisibleInfo.clone(),o.HUa={rowFilter:n,filterRowsVisibleInfo:r};break;case 2:case 7:o.HUa={Je:t.Je.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 1:o.HUa=t.zZ;break;case 3:o.HUa=T.extend({},t.qZ);break;case 4:i=arguments[2],o.HUa={col:i,val:t.qZ[i]};break;case 5:case 6:o.HUa={rZ:t.rZ.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone(),Je:t.Je.concat([])};break;case 8:o.HUa={range:t.range,Je:t.Je.concat([]),yZ:t.yZ.concat([]),LX:T.extend({},t.LX),qZ:T.extend({},t.qZ),zZ:T.extend({},t.zZ),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 9:case 10:o.HUa={range:t.range,LX:T.extend({},t.LX),Je:t.Je.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 11:case 12:o.HUa={range:t.range,zZ:T.extend({},t.zZ),rZ:t.rZ.concat([]),Je:t.Je.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 13:o.HUa={filteredInRowsWithColIndexs:T.extend({},t.LX),filteredItems:t.yZ.concat([]),filteredColumns:t.Je.concat([])};break;case 14:o.HUa={range:t.range}}s.mVa.push(o)}},nVa:function(t){var e=this.kj,o=t.rowFilter,n=t.HUa;if(o||0===t.type)switch(t.type){case 0:n.rowFilter?e.xr=T.extend(o,n.rowFilter):e.xr=n.rowFilter,e.filterRowsVisibleInfo=n.filterRowsVisibleInfo;break;case 1:o.zZ=n;break;case 3:o.qZ=n;break;case 4:o.qZ[n.col]=n.val;break;case 5:case 6:o.rZ=n.rZ,o.Je=n.Je,e.filterRowsVisibleInfo=n.filterRowsVisibleInfo;break;case 2:case 7:o.Je=n.Je,e.filterRowsVisibleInfo=n.filterRowsVisibleInfo;break;case 8:T.extend(o,n),e.filterRowsVisibleInfo=n.filterRowsVisibleInfo;break;case 9:case 10:o.range=n.range,o.LX=n.LX,o.Je=n.Je,e.filterRowsVisibleInfo=n.filterRowsVisibleInfo;break;case 11:case 12:o.range=n.range,o.zZ=n.zZ,o.rZ=n.rZ,o.Je=n.Je,e.filterRowsVisibleInfo=n.filterRowsVisibleInfo;break;case 13:o.LX=n.filteredInRowsWithColIndexs,o.yZ=n.filteredItems,o.Je=n.filteredColumns;break;case 14:o.range=n.range}},oVa:function(t){var e;for(e=b(t)-1;e>=0;e--)this.nVa(t[e])},hVa:function(t,e,o){var n=this.kj.xr;n&&(this.gVa(n,9),n.rI(t,e,o))},iVa:function(t,e){var o=this.kj.xr;o&&(this.gVa(o,10),o.GR(t,e))},jVa:function(t,e){var o=this.kj.xr;o&&(this.gVa(o,11),o.tI(t,e))},kVa:function(t,e){var o=this.kj.xr;o&&(this.gVa(o,12),o.HR(t,e))},lVa:function(t,e,o,n){var r=this.kj.xr;r&&r.$b(t,e,o,n)}}),n.lUa.$n("filter",{undo:function(t){var e=t.mVa;b(e)&&this.oVa(e)}})},"./dist/plugins/filter/filter.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidColumnIndex="Invalid column index.",e.SortAscending="Sort Ascending",e.SortDescending="Sort Descending",e.OK="OK",e.Cancel="Cancel",e.Search="Search",e.CheckAll="Check all",e.UncheckAll="Uncheck all",e.Blanks="(Blanks)",e.Exp_FilterItemIsNull="FilterItem is null.",e.Show="Show",e.ShowRows="Show rows where:",e.And="And",e.Or="Or",e.SortColor="Sort By Color",e.FilterColor="Filter By Color",e.FilterCellTitle="Filter By Cell Color",e.FilterFontTitle="Filter By Font Color",e.SortCellTitle="Sort By Cell Color",e.SortFontTitle="Sort By Font Color",e.FontColor="More Font Colors...",e.CellColor="More Cell Colors...",e.NoFill="No Fill",e.Automatic="Automatic",e.Clear="Clear Filter From {0}",e.TextFilter="Text Filters",e.DateFilter="Date Filters",e.NumberFilter="Number Filters",e.Custom="Custom Filter...",e.Equal="Equals...",e.NotEqual="Does Not Equal...",e.GreaterThan="Greater Than...",e.GreaterOrEquals="Greater Than Or Equal To...",e.LessThan="Less Than...",e.LessThanOrEquals="Less Than Or Equal To...",e.Between="Between...",e.Top10="Top 10...",e.AboveAverage="Above Average",e.BelowAverage="Below Average",e.Begin="Begins With...",e.End="Ends With...",e.Contain="Contains...",e.NotContain="Does Not Contain...",e.Before="Before...",e.After="After...",e.Tomorrow="Tomorrow",e.Today="Today",e.Yesterday="Yesterday",e.NextWeek="Next Week",e.ThisWeek="This Week",e.LastWeek="Last Week",e.NextMonth="Next Month",e.ThisMonth="This Month",e.LastMonth="Last Month",e.NextQuarter="Next Quarter",e.ThisQuarter="This Quarter",e.LastQuarter="Last Quarter",e.NextYear="Next Year",e.ThisYear="This Year",e.LastYear="Last Year",e.YearToDate="Year To Date",e.AllDates="All Dates in Period",e.Top10Filter="Top 10 Auto Filter",e.CustomTitle="Custom AutoFilter",e.ColorTitle="Available Cell Colors",e.top="top",e.bottom="bottom",e.SortCell="Select a cell color to sort by:",e.SortFont="Select a font color to sort by:",e.FilterCell="Select a cell color to filter by:",e.FilterFont="Select a font color to filter by:",e.Selected="Selected:",e.IsEquals="equals",e.NotEquals="does not equal",e.IsGreaterThan="is greater than",e.IsGreaterOrEqual="is greater than or equal to",e.IsLess="is less than",e.LessOrEqual="is less than or equal to",e.IsBeginWith="begins with",e.NotBeginWith="does not begin with",e.IsEndWith="ends with",e.NotEndWith="does not end with",e.IsContain="contains",e.NotContains="does not contain",e.IsAfter="is after",e.AfterOrEqual="is after or equal to",e.IsBefore="is before",e.BeforeOrEqual="is before or equal to",e.Q1="Quarter 1",e.Q2="Quarter 2",e.Q3="Quarter 3",e.Q4="Quarter 4",e.Jan="January",e.Feb="February",e.Mar="March",e.Apr="April",e.May="May",e.Jun="June",e.Jul="July",e.Aug="August",e.Sep="September",e.Oct="October",e.Nov="November",e.Dec="December",e.Explain1="Use ? to represent any single character",e.Explain2="Use * to represent any series of characters",e.Year="",e.Day="",e.add_current_filter="Add current selection to filter",e.invalidCondition="Error in parse line"},"./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js":function(t,e,o){"use strict";var n,r,i,a,s=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/stateful.js"),r=o("./dist/plugins/floatingObject/drawing/common.js"),i=null,a=function(t){function e(e){return t.call(this,e)||this}return s(e,t),Object.defineProperty(e.prototype,"ChartFormat",{get:function(){var t=this;return r.UnitHelper.isNullOrUndefined(t.Kb)&&(t.Kb=t.GetDefaultFormat()),t.Kb},set:function(t){var e,o=this;r.UnitHelper.isNullOrUndefined(o.Kb)||o.Kb.SetParentForChildren(t),e=o.Kb,o.Kb=t,r.UnitHelper.isNullOrUndefined(e)||(o.Kb.ParentStateful=e.ParentStateful)},enumerable:!0,configurable:!0}),e.prototype.CreateFormat=function(){return i},e.prototype.GetDefaultFormat=function(){return this.CreateFormat()},e.prototype.GetFormatInternal=function(){return this.Kb},e.prototype.FromShapeProperties=function(t){var e=this;r.UnitHelper.isNullOrUndefined(t)?e.ClearFormat():(r.UnitHelper.isNullOrUndefined(e.Kb)&&(e.Kb=e.CreateFormat()),e.Kb.FromOOModel(t))},e.prototype.ToShapeProperties=function(){return r.UnitHelper.isNullOrUndefined(this.Kb)?i:this.Kb.ToOOModel()},e.prototype.Delete=function(){r.UnitHelper.isNullOrUndefined(this.Kb)||(this.Kb.ParentStateful=i)},e.prototype.ClearFormat=function(){var t=this;r.UnitHelper.isNullOrUndefined(t.Kb)||(t.Kb.SetParentForChildren(i),t.Kb.ParentStateful=i,t.Kb=i)},e}(n.StatefullBase),e.StatefulChartElementBase=a},"./dist/plugins/floatingObject/drawing/chart.ns.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/floatingObject/drawing/drawingInterface.js")),n(o("./dist/plugins/floatingObject/drawing/stateful.js")),n(o("./dist/plugins/floatingObject/drawing/common.js")),n(o("./dist/plugins/floatingObject/drawing/color.js")),n(o("./dist/plugins/floatingObject/drawing/colorData.js")),n(o("./dist/plugins/floatingObject/drawing/colorFormat.js")),n(o("./dist/plugins/floatingObject/drawing/effects.js")),n(o("./dist/plugins/floatingObject/drawing/fillFormat.js")),n(o("./dist/plugins/floatingObject/drawing/fontData.js")),n(o("./dist/plugins/floatingObject/drawing/fontFormat.js")),n(o("./dist/plugins/floatingObject/drawing/gradient.js")),n(o("./dist/plugins/floatingObject/drawing/lineFormat.js")),n(o("./dist/plugins/floatingObject/drawing/picture.js")),n(o("./dist/plugins/floatingObject/drawing/threeDFormat.js")),n(o("./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js"))},"./dist/plugins/floatingObject/drawing/color.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/plugins/floatingObject/drawing/common.js"),i=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=n.Common.pc,s=r.UnitHelper.isNullOrUndefined,l=null,u=function(){function t(t,e,o,n){var r=this;r.value=t,r.state=e,r.name=o,r.knownColor=n}return t.FromKnownColor=function(e){return new t(0,t.StateKnownColorValid,l,e)},t.FromIndexedColor=function(e,o){var n=t.IndexedColors;return n||(n=t.IndexedColors=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,t.FromKnownColor(c.WindowText).ToArgb(),t.FromKnownColor(c.Window).ToArgb()]),t.FromArgb(n[e]).GetTintColor(o)},t.FromArgb=function(e){return new t(e,t.StateARGBValueValid,l,0)},t.FromArgbs=function(e,o,n,r){return t.CheckByte(e,"alpha"),t.CheckByte(o,"red"),t.CheckByte(n,"green"),t.CheckByte(r,"blue"),new t(t.MakeArgb(e,o,n,r),t.StateARGBValueValid,l,0)},t.FromBaseColor=function(e,o){return t.CheckByte(e,"alpha"),new t(t.MakeArgb(e,o.R,o.G,o.B),t.StateARGBValueValid,l,0)},t.FromRgb=function(e,o,n){return t.FromArgbs(255,e,o,n)},t.CheckByte=function(t,e){if(t<0||t>255)throw Error("InvalidEx2BoundArgument")},t.MakeArgb=function(t,e,o,n){return Math.pow(2,24)*t+(e<<16|o<<8|n)},Object.defineProperty(t.prototype,"Transparent",{get:function(){return t.FromKnownColor(c.Transparent)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"R",{get:function(){return this.Value>>16&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"G",{get:function(){return this.Value>>8&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"B",{get:function(){return 255&this.Value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"A",{get:function(){return this.Value>>24&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsKnownColor",{get:function(){return 0!=(this.state&t.StateKnownColorValid)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsEmpty",{get:function(){return 0===this.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsNamedColor",{get:function(){return 0!=(this.state&t.StateNameValid)||this.IsKnownColor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsSystemColor",{get:function(){return!!this.IsKnownColor&&(!(this.knownColor>26)||this.knownColor>167)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){var e,o=this;return 0!=(o.state&t.StateNameValid)?o.name:o.IsKnownColor?(e=h.KnownColorToName(o.knownColor),s(e)?"":e):o.value.toString(16)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Value",{get:function(){var e=this;return 0!=(e.state&t.StateValueMask)?e.value:e.IsKnownColor?h.KnownColorToArgb(e.knownColor):t.NotDefinedValue},enumerable:!0,configurable:!0}),t.prototype.Equals=function(e){return e instanceof t&&this.Value===e.Value},t.prototype.GetTintColor=function(e){var o,n=this;return 0===e?n:(o=a.jc({r:n.R,g:n.G,b:n.B},e),t.FromArgbs(o.a,o.r,o.g,o.b))},t.prototype.GetBrightness=function(){var t=this.R/255,e=this.G/255,o=this.B/255,n=t,r=t;return e>n&&(n=e),o>n&&(n=o),e<r&&(r=e),o<r&&(r=o),(n+r)/2},t.prototype.GetHue=function(){var t,e,o,n,r,i,a,s=this;return s.R===s.G&&s.G===s.B?0:(t=s.R/255,n=0,(e=s.G/255)>(r=t)&&(r=e),(o=s.B/255)>r&&(r=o),e<(i=t)&&(i=e),o<i&&(i=o),a=r-i,t===r?n=(e-o)/a:e===r?n=2+(o-t)/a:o===r&&(n=4+(t-e)/a),(n*=60)<0&&(n+=360),n)},t.prototype.GetSaturation=function(){var t=this.R/255,e=this.G/255,o=this.B/255,n=t,r=t;return e>n&&(n=e),o>n&&(n=o),e<r&&(r=e),o<r&&(r=o),n===r?0:(n+r)/2<=.5?(n-r)/(n+r):(n-r)/(2-n-r)},t.prototype.ToArgb=function(){return this.Value},t.prototype.ToKnownColor=function(){return this.knownColor},t.prototype.ToString=function(){var e=this,o="ARGBColor";return o+=" [",0!=(e.state&t.StateNameValid)||0!=(e.state&t.StateKnownColorValid)?o+=e.Name:0!=(e.state&t.StateValueMask)?(o+="A=",o+=e.A,o+=", R=",o+=e.R,o+=", G=",o+=e.G,o+=", B=",o+=e.B):o+="Empty",o+"]"},t.StateKnownColorValid=1,t.StateARGBValueValid=2,t.StateValueMask=2,t.StateNameValid=8,t.NotDefinedValue=0,t}(),e.ARGBColor=u,r.ChartUtility.Kqa=function(t,e){var o,n,s=e.ColorType;return s===i.ColorType.Index?u.FromIndexedColor(e.Value,e.Tint):s===i.ColorType.Theme?(o=r.ChartUtility.toThemeColorString(e.Value,e.Tint),n=a.ec(t.getColor(o)),e.Transparency&&(n.a=parseInt(255*(1-e.Transparency)+"",10)),u.FromArgbs(n.a,n.r,n.g,n.b)):s===i.ColorType.Auto?u.FromKnownColor(c.WindowText):s===i.ColorType.None?new u:u.FromArgb(e.Value).GetTintColor(e.Tint)},function(t){t[t.ActiveBorder=1]="ActiveBorder",t[t.ActiveCaption=2]="ActiveCaption",t[t.ActiveCaptionText=3]="ActiveCaptionText",t[t.AliceBlue=28]="AliceBlue",t[t.AntiqueWhite=29]="AntiqueWhite",t[t.AppWorkspace=4]="AppWorkspace",t[t.Aqua=30]="Aqua",t[t.Aquamarine=31]="Aquamarine",t[t.Azure=32]="Azure",t[t.Beige=33]="Beige",t[t.Bisque=34]="Bisque",t[t.Black=35]="Black",t[t.BlanchedAlmond=36]="BlanchedAlmond",t[t.Blue=37]="Blue",t[t.BlueViolet=38]="BlueViolet",t[t.Brown=39]="Brown",t[t.BurlyWood=40]="BurlyWood",t[t.ButtonFace=168]="ButtonFace",t[t.ButtonHighlight=169]="ButtonHighlight",t[t.ButtonShadow=170]="ButtonShadow",t[t.CadetBlue=41]="CadetBlue",t[t.Chartreuse=42]="Chartreuse",t[t.Chocolate=43]="Chocolate",t[t.Control=5]="Control",t[t.ControlDark=6]="ControlDark",t[t.ControlDarkDark=7]="ControlDarkDark",t[t.ControlLight=8]="ControlLight",t[t.ControlLightLight=9]="ControlLightLight",t[t.ControlText=10]="ControlText",t[t.Coral=44]="Coral",t[t.CornflowerBlue=45]="CornflowerBlue",t[t.Cornsilk=46]="Cornsilk",t[t.Crimson=47]="Crimson",t[t.Cyan=48]="Cyan",t[t.DarkBlue=49]="DarkBlue",t[t.DarkCyan=50]="DarkCyan",t[t.DarkGoldenrod=51]="DarkGoldenrod",t[t.DarkGray=52]="DarkGray",t[t.DarkGreen=53]="DarkGreen",t[t.DarkKhaki=54]="DarkKhaki",t[t.DarkMagenta=55]="DarkMagenta",t[t.DarkOliveGreen=56]="DarkOliveGreen",t[t.DarkOrange=57]="DarkOrange",t[t.DarkOrchid=58]="DarkOrchid",t[t.DarkRed=59]="DarkRed",t[t.DarkSalmon=60]="DarkSalmon",t[t.DarkSeaGreen=61]="DarkSeaGreen",t[t.DarkSlateBlue=62]="DarkSlateBlue",t[t.DarkSlateGray=63]="DarkSlateGray",t[t.DarkTurquoise=64]="DarkTurquoise",t[t.DarkViolet=65]="DarkViolet",t[t.DeepPink=66]="DeepPink",t[t.DeepSkyBlue=67]="DeepSkyBlue",t[t.Desktop=11]="Desktop",t[t.DimGray=68]="DimGray",t[t.DodgerBlue=69]="DodgerBlue",t[t.Firebrick=70]="Firebrick",t[t.FloralWhite=71]="FloralWhite",t[t.ForestGreen=72]="ForestGreen",t[t.Fuchsia=73]="Fuchsia",t[t.Gainsboro=74]="Gainsboro",t[t.GhostWhite=75]="GhostWhite",t[t.Gold=76]="Gold",t[t.Goldenrod=77]="Goldenrod",t[t.GradientActiveCaption=171]="GradientActiveCaption",t[t.GradientInactiveCaption=172]="GradientInactiveCaption",t[t.Gray=78]="Gray",t[t.GrayText=12]="GrayText",t[t.Green=79]="Green",t[t.GreenYellow=80]="GreenYellow",t[t.Highlight=13]="Highlight",t[t.HighlightText=14]="HighlightText",t[t.Honeydew=81]="Honeydew",t[t.HotPink=82]="HotPink",t[t.HotTrack=15]="HotTrack",t[t.InactiveBorder=16]="InactiveBorder",t[t.InactiveCaption=17]="InactiveCaption",t[t.InactiveCaptionText=18]="InactiveCaptionText",t[t.IndianRed=83]="IndianRed",t[t.Indigo=84]="Indigo",t[t.Info=19]="Info",t[t.InfoText=20]="InfoText",t[t.Ivory=85]="Ivory",t[t.Khaki=86]="Khaki",t[t.Lavender=87]="Lavender",t[t.LavenderBlush=88]="LavenderBlush",t[t.LawnGreen=89]="LawnGreen",t[t.LemonChiffon=90]="LemonChiffon",t[t.LightBlue=91]="LightBlue",t[t.LightCoral=92]="LightCoral",t[t.LightCyan=93]="LightCyan",t[t.LightGoldenrodYellow=94]="LightGoldenrodYellow",t[t.LightGray=95]="LightGray",t[t.LightGreen=96]="LightGreen",t[t.LightPink=97]="LightPink",t[t.LightSalmon=98]="LightSalmon",t[t.LightSeaGreen=99]="LightSeaGreen",t[t.LightSkyBlue=100]="LightSkyBlue",t[t.LightSlateGray=101]="LightSlateGray",t[t.LightSteelBlue=102]="LightSteelBlue",t[t.LightYellow=103]="LightYellow",t[t.Lime=104]="Lime",t[t.LimeGreen=105]="LimeGreen",t[t.Linen=106]="Linen",t[t.Magenta=107]="Magenta",t[t.Maroon=108]="Maroon",t[t.MediumAquamarine=109]="MediumAquamarine",t[t.MediumBlue=110]="MediumBlue",t[t.MediumOrchid=111]="MediumOrchid",t[t.MediumPurple=112]="MediumPurple",t[t.MediumSeaGreen=113]="MediumSeaGreen",t[t.MediumSlateBlue=114]="MediumSlateBlue",t[t.MediumSpringGreen=115]="MediumSpringGreen",t[t.MediumTurquoise=116]="MediumTurquoise",t[t.MediumVioletRed=117]="MediumVioletRed",t[t.Menu=21]="Menu",t[t.MenuBar=173]="MenuBar",t[t.MenuHighlight=174]="MenuHighlight",t[t.MenuText=22]="MenuText",t[t.MidnightBlue=118]="MidnightBlue",t[t.MintCream=119]="MintCream",t[t.MistyRose=120]="MistyRose",t[t.Moccasin=121]="Moccasin",t[t.NavajoWhite=122]="NavajoWhite",t[t.Navy=123]="Navy",t[t.OldLace=124]="OldLace",t[t.Olive=125]="Olive",t[t.OliveDrab=126]="OliveDrab",t[t.Orange=127]="Orange",t[t.OrangeRed=128]="OrangeRed",t[t.Orchid=129]="Orchid",t[t.PaleGoldenrod=130]="PaleGoldenrod",t[t.PaleGreen=131]="PaleGreen",t[t.PaleTurquoise=132]="PaleTurquoise",t[t.PaleVioletRed=133]="PaleVioletRed",t[t.PapayaWhip=134]="PapayaWhip",t[t.PeachPuff=135]="PeachPuff",t[t.Peru=136]="Peru",t[t.Pink=137]="Pink",t[t.Plum=138]="Plum",t[t.PowderBlue=139]="PowderBlue",t[t.Purple=140]="Purple",t[t.Red=141]="Red",t[t.RosyBrown=142]="RosyBrown",t[t.RoyalBlue=143]="RoyalBlue",t[t.SaddleBrown=144]="SaddleBrown",t[t.Salmon=145]="Salmon",t[t.SandyBrown=146]="SandyBrown",t[t.ScrollBar=23]="ScrollBar",t[t.SeaGreen=147]="SeaGreen",t[t.SeaShell=148]="SeaShell",t[t.Sienna=149]="Sienna",t[t.Silver=150]="Silver",t[t.SkyBlue=151]="SkyBlue",t[t.SlateBlue=152]="SlateBlue",t[t.SlateGray=153]="SlateGray",t[t.Snow=154]="Snow",t[t.SpringGreen=155]="SpringGreen",t[t.SteelBlue=156]="SteelBlue",t[t.Tan=157]="Tan",t[t.Teal=158]="Teal",t[t.Thistle=159]="Thistle",t[t.Tomato=160]="Tomato",t[t.Transparent=27]="Transparent",t[t.Turquoise=161]="Turquoise",t[t.Violet=162]="Violet",t[t.Wheat=163]="Wheat",t[t.White=164]="White",t[t.WhiteSmoke=165]="WhiteSmoke",t[t.Window=24]="Window",t[t.WindowFrame=25]="WindowFrame",t[t.WindowText=26]="WindowText",t[t.Yellow=166]="Yellow",t[t.YellowGreen=167]="YellowGreen"}(c=e.KnownColor||(e.KnownColor={})),f=function(t){t[1]=4290032820,t[2]=4288263377,t[3]=4278190080,t[4]=4289440683,t[5]=4293980400,t[6]=4288716960,t[7]=4285098345,t[8]=4293125091,t[9]=4294967295,t[10]=4278190080,t[11]=4278190080,t[12]=4285361517,t[13]=4281571839,t[14]=4294967295,t[15]=4278216396,t[16]=4294244348,t[17]=4290760155,t[18]=4278190080,t[19]=4294967265,t[20]=4278190080,t[21]=4293980400,t[22]=4278190080,t[23]=4291348680,t[24]=4294967295,t[25]=4284769380,t[26]=4278190080,t[168]=4293980400,t[169]=4294967295,t[170]=4288716960,t[171]=4290367978,t[172]=4292338930,t[173]=4293980400,t[174]=4281571839},h=function(){function t(){}return t.ArgbToKnownColor=function(e){var o,n;for(this.EnsureColorTable(),o=0;o<t.colorTable.length;o++)if(t.colorTable[o]===e&&!(n=u.FromArgb(o)).IsSystemColor)return n;return u.FromArgb(e)},t.Encode=function(t,e,o,n){return e<<16|o<<8|n|t<<24},t.EnsureColorNameTable=function(){s(t.colorNameTable)&&t.InitColorNameTable()},t.EnsureColorTable=function(){s(t.colorTable)&&this.InitColorTable()},t.InitColorNameTable=function(){var e,o=[];for(e in c)c.hasOwnProperty(e)&&(o[c[e]]=e);t.colorNameTable=o},t.InitColorTable=function(){var e=[];f(e),e[27]=16777215,e[28]=-984833,e[29]=-332841,e[30]=-16711681,e[31]=-8388652,e[32]=-983041,e[33]=-657956,e[34]=-6972,e[35]=-16777216,e[36]=-5171,e[37]=-16776961,e[38]=-7722014,e[39]=-5952982,e[40]=-2180985,e[41]=-10510688,e[42]=-8388864,e[43]=-2987746,e[44]=-32944,e[45]=-10185235,e[46]=-1828,e[47]=-2354116,e[48]=-16711681,e[49]=-16777077,e[50]=-16741493,e[51]=-4684277,e[52]=-5658199,e[53]=-16751616,e[54]=-4343957,e[55]=-7667573,e[56]=-11179217,e[57]=-29696,e[58]=-6737204,e[59]=-7667712,e[60]=-1468806,e[61]=-7357301,e[62]=-12042869,e[63]=-13676721,e[64]=-16724271,e[65]=-7077677,e[66]=-60269,e[67]=-16728065,e[68]=-9868951,e[69]=-14774017,e[70]=-5103070,e[71]=-1296,e[72]=-14513374,e[73]=-65281,e[74]=-2302756,e[75]=-460545,e[76]=-10496,e[77]=-2448096,e[78]=-8355712,e[79]=-16744448,e[80]=-5374161,e[81]=-983056,e[82]=-38476,e[83]=-3318692,e[84]=-11861886,e[85]=-16,e[86]=-989556,e[87]=-1644806,e[88]=-3851,e[89]=-8586240,e[90]=-1331,e[91]=-5383962,e[92]=-1015680,e[93]=-2031617,e[94]=-329006,e[95]=-2894893,e[96]=-7278960,e[97]=-18751,e[98]=-24454,e[99]=-14634326,e[100]=-7876870,e[101]=-8943463,e[102]=-5192482,e[103]=-32,e[104]=-16711936,e[105]=-13447886,e[106]=-331546,e[107]=-65281,e[108]=-8388608,e[109]=-10039894,e[110]=-16777011,e[111]=-4565549,e[112]=-7114533,e[113]=-12799119,e[114]=-8689426,e[115]=-16713062,e[116]=-12004916,e[117]=-3730043,e[118]=-15132304,e[119]=-655366,e[120]=-6943,e[121]=-6987,e[122]=-8531,e[123]=-16777088,e[124]=-133658,e[125]=-8355840,e[126]=-9728477,e[127]=-23296,e[128]=-47872,e[129]=-2461482,e[130]=-1120086,e[131]=-6751336,e[132]=-5247250,e[133]=-2396013,e[134]=-4139,e[135]=-9543,e[136]=-3308225,e[137]=-16181,e[138]=-2252579,e[139]=-5185306,e[140]=-8388480,e[141]=-65536,e[142]=-4419697,e[143]=-12490271,e[144]=-7650029,e[145]=-360334,e[146]=-744352,e[147]=-13726889,e[148]=-2578,e[149]=-6270419,e[150]=-4144960,e[151]=-7876885,e[152]=-9807155,e[153]=-9404272,e[154]=-1286,e[155]=-16711809,e[156]=-12156236,e[157]=-2968436,e[158]=-16744320,e[159]=-2572328,e[160]=-40121,e[161]=-12525360,e[162]=-1146130,e[163]=-663885,e[164]=-1,e[165]=-657931,e[166]=-256,e[167]=-6632142,t.colorTable=e},t.KnownColorToArgb=function(t){return this.EnsureColorTable(),t<=c.MenuHighlight?this.colorTable[t]:0},t.KnownColorToName=function(e){return this.EnsureColorNameTable(),e<=c.MenuHighlight?t.colorNameTable[e]:l},t.IsKnowColor=function(e){return t.EnsureColorTable(),-1!==t.colorTable.indexOf(e)},t}(),e.KnownColorTable=h},"./dist/plugins/floatingObject/drawing/colorData.js":function(t,e,o){"use strict";var n,r,i;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),function(t){t[t.None=0]="None",t[t.ColorType=1]="ColorType",t[t.Value=2]="Value",t[t.Tint=4]="Tint",t[t.All=7]="All"}(r=e.ColorDataFlag||(e.ColorDataFlag={})),i=function(){function t(){}return t.ConvertHexStringToInt=function(t){return parseInt(t,16)},t.prototype.Equals=function(t){return this.ColorType===t.ColorType&&this.Value===t.Value&&this.Tint===t.Tint},t.prototype.Clone=function(){return this},t.prototype.Compose=function(t,e){void 0===e&&(e=!0),t.Flag!==r.None&&(e?this.ConflictCompose(t):this.NonConflictCompose(t))},t.prototype.ConflictCompose=function(t){var e=this;(t.Flag&r.ColorType)===r.ColorType&&e.ColorType!==t.ColorType&&(e.ColorType=t.ColorType,e.Value=0,e.Tint=0),(t.Flag&r.Value)===r.Value&&(e.Value=t.Value),(t.Flag&r.Tint)===r.Tint&&(e.Tint=t.Tint),e.Flag|=t.Flag},t.prototype.NonConflictCompose=function(t){var e=this;(e.Flag&r.ColorType)!==r.ColorType&&(t.Flag&r.ColorType)===r.ColorType&&(e.ColorType=t.ColorType,e.Value=t.Value,e.Tint=t.Tint,e.Flag=t.Flag)},t.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},t.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},t.prototype.Compare=function(t,e){var o,n=this,i=!1;return(n.Flag&r.ColorType)===r.ColorType&&(o=(t.Flag&r.ColorType)!==r.ColorType||n.ColorType!==t.ColorType,e?o?(n.Flag=r.None,i=!0):((n.Flag&r.Value)===r.Value&&(((t.Flag&r.Value)!==r.Value||n.Value!==t.Value)&&(n.Flag=r.None,i=!0)),(n.Flag&r.Tint)===r.Tint&&(((t.Flag&r.Tint)!==r.Tint||n.Tint!==t.Tint)&&(n.Flag=r.None,i=!0))):o||((n.Flag&r.Value)===r.Value&&((t.Flag&r.Value)!==r.Value||n.Value!==t.Value||(n.Flag&=~r.Value,i=!0)),(n.Flag&r.Tint)===r.Tint&&((t.Flag&r.Tint)!==r.Tint||n.Tint!==t.Tint||(n.Flag&=~r.Tint,i=!0)),n.Flag===r.ColorType&&(n.Flag=r.None,i=!0))),i},t.prototype.UpdateDefaultValueFlag=function(){this.ColorType===n.ColorType.None?this.Flag=r.None:this.Flag=r.All},t.prototype.UpdateFlagFromBottom=function(){},t.prototype.ClearFlag=function(){this.Flag=r.None},t.prototype.SetFullFlag=function(){this.Flag=r.All},t.prototype.IsFullFlag=function(){return this.Flag===r.All},t}(),e.ColorData=i},"./dist/plugins/floatingObject/drawing/colorFormat.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function C(t){delete t.hslClr,delete t.prstClr,delete t.scrgbClr,delete t.srgbClr,delete t.sysClr}function v(t,e,o){e.length>0&&(t.lumMod=e),o.length>0&&(t.lumOff=o)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/plugins/floatingObject/drawing/colorData.js"),i=o("./dist/plugins/floatingObject/drawing/color.js"),a=o("./dist/plugins/floatingObject/drawing/common.js"),s=o("./dist/plugins/floatingObject/drawing/stateful.js"),l=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=n.Common.pc,c=a.UnitHelper.isNullOrUndefined,f=a.ShapeConstants.DefaultTransparent,h=a.ShapeConstants.PositionConver,p=null,d=Math.abs,g=Math.floor,e.createColorFormatFromRGB=function(t,e,o){var n=new m(t);return n.ColorType=e,n.RGB=o,n},e.createColorFormat=function(t,e,o,n){var r=new m(t);return r.ColorType=e,r.ObjectThemeColor=o,n&&(r.TintAndShade=n),r},m=function(t){function e(e,o){var n,r,i=t.call(this,o)||this;return void 0===o&&(o=p),(n=i).Hqa=l.ColorSchemeIndex.None,n.Iqa=p,n.Yba=0,n.Jqa=0,n.Gqa=f,n.xc=e,n.hqa=o,(r=n.xc.DrawingType)===l.DrawingType.Shape?n.Xba=l.SolidColorType.Theme:r===l.DrawingType.Chart?n.Xba=l.SolidColorType.Automatic:r===l.DrawingType.Picture&&(n.Xba=l.SolidColorType.None),n}return y(e,t),e.prototype.setColor=function(t,e){var o,n,r=this;t&&function(t,e){return t.getColor(e)!==e}(t.currentTheme(),e)?(o=a.ChartUtility.fromThemeColorString(e))&&(r.ObjectThemeColor=o.index,void 0!==o.tint&&(r.Brightness=o.tint)):(n=u.ec(e),r.RGB=i.ARGBColor.FromArgbs(n.a,n.r,n.g,n.b))},e.prototype.GetColorData=function(){var t,e,o,n,a=this,s=new r.ColorData;if(s.ColorType=l.ColorType.RGB,(t=a.Xba)===l.SolidColorType.None)s.ColorType=l.ColorType.None;else if(t===l.SolidColorType.Automatic){if(s.ColorType=l.ColorType.Auto,e=a.GetAutoColorFormat(),!c(e))return e.GetColorData()}else t===l.SolidColorType.RGB?c(a.Iqa)||(s.ColorType=l.ColorType.RGB,o=this.Iqa,1!==(n=1-a.Gqa)&&(o=i.ARGBColor.FromArgbs(parseInt(255*n,10),o.R,o.G,o.B)),s.Value=o.ToArgb(),s.Tint=a.Yba||a.Jqa):t===l.SolidColorType.Theme&&(s.ColorType=l.ColorType.Theme,s.Value=a.Hqa,s.Tint=a.Yba||a.Jqa,s.Transparency=a.Gqa);return s},e.prototype.HasOwnColor=function(){return this.GetState(l.ColorFormatStates.ObjectThemeColor)||this.GetState(l.ColorFormatStates.RGB)||this.GetAutoColorFormat()!==p},e.prototype.GetAutoColorFormat=function(){if(this.ColorType===l.SolidColorType.Automatic&&!c(this.AutoColorFormat)){var t=this.AutoColorFormat();if(!c(t)&&t.ColorType!==l.SolidColorType.Automatic)return t}return p},e.prototype.OnParentChanged=function(t){this.hqa=t},e.prototype.ClearModel=function(){var t,e;for(this.Lqa=p,t=0,e=this.Children;t<e.length;t++)e[t].ClearModel()},e.prototype.CalcBrightness=function(t,e){return t&&t.length>0&&e&&e.length>0?e[0]/h:t&&t.length>0?t[0]/h-1:0},e.prototype.CalcLumModeOff=function(t,e){var o=this;o.Brightness>0?(t.push(g((1-o.Brightness)*h)),e.push(g(o.Brightness*h))):o.Brightness<0&&t.push(g((1+o.Brightness)*h))},e.prototype.FromCT_ColorProperties=function(t){var e,o,n,r,s,u,f,h,p=this;p.Lqa=t,c(t)?p.ColorType=l.SolidColorType.None:c(t.schemeClr)?c(t.srgbClr)||c(t.srgbClr.val)||3!==t.srgbClr.val.length?c(t.scrgbClr)?c(t.sysClr)?c(t.prstClr)||(f=t.prstClr,h=a.ChartUtility.GetPresetColorRGB(f.val),p.RGB=i.ARGBColor.FromRgb(h[0],h[1],h[2]),p.Brightness=p.CalcBrightness(f.lumMod,f.lumOff),!c(f.alpha)&&f.alpha.length>0&&p.FromTransparency(f.alpha[0])):(u=(s=t.sysClr).val,c(u)?c(s.lastClr)||3!==s.lastClr.length||(p.RGB=i.ARGBColor.FromRgb(s.lastClr[0],s.lastClr[1],s.lastClr[2])):p.RGB=i.ARGBColor.FromKnownColor(u),p.Brightness=p.CalcBrightness(s.lumMod,s.lumOff),!c(s.alpha)&&s.alpha.length>0&&p.FromTransparency(s.alpha[0])):(r=t.scrgbClr,p.RGB=i.ARGBColor.FromRgb(r.r,r.g,r.b)):(n=t.srgbClr,p.RGB=i.ARGBColor.FromRgb(n.val[0],n.val[1],n.val[2]),p.Brightness=p.CalcBrightness(n.lumMod,n.lumOff),!c(n.alpha)&&n.alpha.length>0&&p.FromTransparency(n.alpha[0]),!c(n.tint)&&n.tint.length>0&&p.FromTint(n.tint[0])):(e=t.schemeClr,p.ObjectThemeColor=e.val,p.Brightness=p.CalcBrightness(e.lumMod,e.lumOff),p.Yba=0,!c(e.tint)&&e.tint.length>0&&p.FromTint(e.tint[0]),!c(e.alpha)&&e.alpha.length>0&&p.FromTransparency(e.alpha[0]),(o=e.shade)&&o.length&&p.FromShade(o[0]))},e.prototype.ToCT_ColorProperties=function(t){var e,o,n,r,i=this,s=i.Lqa||t,u=[],h=[],d=s.schemeClr;return d&&a.ChartUtility.removeEmptyArrayProperties(d),i.ColorType===l.SolidColorType.Theme?(C(s),d||(d=s.schemeClr={}),d.val=i.ObjectThemeColor,i.CalcLumModeOff(u,h),v(d,u,h),i.TintAndShade>0?d.tint=[i.ToTint()]:i.TintAndShade<0&&(d.shade=[i.ToShade()]),i.Transparency!==f&&(d.alpha=[i.ToTransparency()])):i.ColorType===l.SolidColorType.RGB&&(C(s),delete s.schemeClr,e=p,i.Iqa&&i.Iqa.IsKnownColor&&(e=i.Iqa.ToKnownColor()),c(e)?((n=s.srgbClr={}).val=[i.RGB.R,i.RGB.G,i.RGB.B],i.CalcLumModeOff(u,h),v(n,u,h),i.Transparency!==f&&(n.alpha=[i.ToTransparency()]),i.TintAndShade>0?n.tint=[i.ToTint()]:i.TintAndShade<0&&(n.shade=[i.ToShade()])):((o=s.sysClr={}).val=e,o.lastClr=[i.RGB.R,i.RGB.G,i.RGB.B],i.CalcLumModeOff(u,h),v(o,u,h),i.Transparency!==f&&(o.alpha=[i.ToTransparency()]))),r=t&&t.colorFillType,c(r)||(s.colorFillType=r),s},e.prototype.FromTint=function(t){this.TintAndShade=1-t/h},e.prototype.FromShade=function(t){this.TintAndShade=t/h-1},e.prototype.ToTint=function(){return g(d((1-this.TintAndShade)*h))},e.prototype.ToShade=function(){return g(d((1+this.TintAndShade)*h))},e.prototype.FromTransparency=function(t){this.Transparency=1-t/h},e.prototype.ToTransparency=function(){return g((1-this.Transparency)*h)},e.prototype.Clone=function(){var t=this,o=new e(t.xc);return o.Jqa=t.Jqa,o.Xba=t.Xba,o.xc=t.xc,o.Iqa=t.Iqa,o.Hqa=t.Hqa,o.Yba=t.Yba,o.AutoColorFormat=t.AutoColorFormat,o},e.prototype.FromOOModel=function(t){this.FromCT_ColorProperties(t)},e.prototype.ToOOModel=function(){var t=this.ColorType;return t===l.SolidColorType.Automatic?{}:t===l.SolidColorType.None?{colorFillType:l.ColorFillType.NoFillProperties}:this.ToCT_ColorProperties({colorFillType:0})},e.prototype.Color_FromOOModel=function(t){this.FromCT_ColorProperties(t)},e.prototype.Color_ToOOModel=function(){return this.ToCT_ColorProperties({})},e.prototype.GradientStop_FromOOModel=function(t){this.FromCT_ColorProperties(t)},e.prototype.GradientStop_ToOOModel=function(){return this.ToCT_ColorProperties({})},e.prototype.ColorData_FromOOModel=function(t){t.ColorType===l.ColorType.Index?this.RGB=i.ARGBColor.FromArgb(t.Value):t.ColorType===l.ColorType.Theme&&(this.ObjectThemeColor=t.Value,this.TintAndShade=t.Tint)},e.prototype.ColorData_ToOOModel=function(){var t=this,e=new r.ColorData;return t.ColorType===l.SolidColorType.RGB?(e.Value=t.RGB.Value,e.ColorType=l.ColorType.RGB):t.ColorType===l.SolidColorType.Theme&&(e.Value=t.ObjectThemeColor,e.Tint=t.TintAndShade,e.ColorType=l.ColorType.Theme),e},Object.defineProperty(e.prototype,"Brightness",{get:function(){return this.GetState(l.ColorFormatStates.Brightness)||c(this.hqa)?this.Jqa:this.hqa.Brightness},set:function(t){if(t<-1||t>1)throw Error();this.Jqa=t,this.Dirty(l.ColorFormatStates.Brightness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ObjectThemeColor",{get:function(){return this.GetState(l.ColorFormatStates.ObjectThemeColor)||c(this.hqa)?this.Hqa:this.hqa.ObjectThemeColor},set:function(t){var e=this,o={13:1,14:0,15:3,16:2};c(o[t])||(t=o[t]),e.Hqa=t,e.Dirty(l.ColorFormatStates.ObjectThemeColor),e.ColorType=l.SolidColorType.Theme,e.Iqa=p,e.UnDirty(l.ColorFormatStates.RGB),e.Jqa=0,e.Dirty(l.ColorFormatStates.Brightness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RGB",{get:function(){var t=this;return t.HasOwnColor()||c(t.hqa)?t.xc.Kqa(t.GetColorData()):t.hqa.RGB},set:function(t){var e=this;e.Iqa=t,e.Transparency=1-t.A/255,e.Dirty(l.ColorFormatStates.RGB),e.ColorType=l.SolidColorType.RGB,e.Hqa=l.ColorSchemeIndex.None,e.Dirty(l.ColorFormatStates.ObjectThemeColor),e.Jqa=0,e.Yba=0,e.Dirty(l.ColorFormatStates.Brightness),e.Dirty(l.ColorFormatStates.TintAndShade)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TintAndShade",{get:function(){var t=this;return t.GetState(l.ColorFormatStates.TintAndShade)||c(t.hqa)?t.Yba:t.hqa.TintAndShade},set:function(t){this.Yba=t,this.Dirty(l.ColorFormatStates.TintAndShade)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(l.ColorFormatStates.Transparency)||c(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){t=Math.max(0,Math.min(1,t)),this.Gqa=t,this.Dirty(l.ColorFormatStates.Transparency)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorType",{get:function(){var t=this;return t.GetState(l.ColorFormatStates.ColorType)||c(t.hqa)?t.Xba:t.hqa.ColorType},set:function(t){this.Xba=t,this.Dirty(l.ColorFormatStates.ColorType)},enumerable:!0,configurable:!0}),e}(s.StatefullBase),e.ColorFormat=m},"./dist/plugins/floatingObject/drawing/common.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O;function D(t){return"number"==typeof t||t instanceof Date}function F(t,e,o){o.configurable=!0,o.enumerable=!0,Object.defineProperty(t,e,o)}function E(t){if(null==t)return!0;if(Array.isArray(t))return 0===t.length;if(t instanceof Date)return!1;if("object"!=typeof t)return!1;for(var e in t)return!1;return!0}function j(t,e){var o,n;if(E(t))return null;for(o in t)e.indexOf(o)>=0||(n=t[o],Array.isArray(n)?0!==n.length&&null!==P(n,e)||delete t[o]:"object"==typeof n&&(null===(n=j(n,e))&&delete t[o]));return E(t)?null:t}function P(t,e){var o=[],n=t.length;return t.forEach((function(t){var n=j(t,e);null!==n&&o.push(n)})),o.length<n&&[].splice.apply(t,[].concat(0,n,o)),o.length?t:null}function L(t){delete t.solidFill,delete t.pattFill,delete t.blipFill,delete t.gradFill,delete t.noFill,delete t.grpFill,delete t.uFill,delete t.uFillTx}function G(t){return 8===t||!R.Is3DChart(t)&&(R.IsBarChart(t)||R.IsColumnChart(t)||R.IsLineChart(t))}function B(t){var e,o,n,r=t.ChartType;if(0!==r)return G(r);for(o=0,n=(e=t.SeriesCollection.AllSers).length;o<n;o++)if(G(e[o].ChartType))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),i=o("SheetsCalc"),a=o("./node_modules/util/util.js"),s=o("@grapecity/js-calc"),l=n.Common.l,u=null,c=void 0,f=Math.max,h=Math.min,p=Math.floor,d=Math.log,g=Math.pow,m=Math.ceil,y=Math.abs,C=function(){function t(){}return t.FromOADate=l.Xb,t.ToOADate=l.Ra,t.OADateMinAsDouble=-657435,t.OADateMaxAsDouble=2958466,t}(),e.DateTimeExtension=C,v=function(){function t(){}return t.log=function(t,e){return d(t)/d(e)},t.round=function(t,e){var o=g(10,e);return Math.round(t*o)/o},t.isNaNOrInfinite=function(t){return isNaN(t)||!isFinite(t)},t.GetTriangleAngle=function(t,e,o){var n,r;return 0===t&&0===e?0:(n=(t*t+o*o-e*e)/y(2*t*o),r=0,t<0&&e>0?r=90:t<0&&e<0?r=180:t>0&&e<0&&(r=270),180*Math.acos(n)/Math.PI+r)},t.INT32_MAX_VALUE=2147483647,t.DOUBLE_MAX_VALUE=Number.MAX_VALUE,t.DOUBLE_MIN_VALUE=-Number.MAX_VALUE,t}(),e.NumberExtension=v,b=function(){function t(){}return t.pointToPixel=function(t){return function(t,e){var o=Math.pow(10,e);return Math.round(t*o)/o}(96*t/72,2)},t.IsNullOrEmpty=function(e){return t.isNullOrUndefined(e)||""===e},t.IsNegativeInfinity=function(t){return t===Number.NEGATIVE_INFINITY},t.IsPositiveInfinity=function(t){return t===Number.POSITIVE_INFINITY},t.isNullOrUndefined=function(t){return t===c||t===u},t}(),e.UnitHelper=b,w=function(){function t(t,e,o,n){var r=this;r.Row=t,r.Column=e,r.RowCount=o,r.ColumnCount=n}return Object.defineProperty(t.prototype,"Left",{get:function(){return this.Column},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.Row},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){return this.Column+this.ColumnCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bottom",{get:function(){return this.Row+this.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFullColumn",{get:function(){return 0===this.Row&&this.RowCount===v.INT32_MAX_VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFullRow",{get:function(){return 0===this.Column&&this.ColumnCount===v.INT32_MAX_VALUE},enumerable:!0,configurable:!0}),t.prototype.Intersect=function(t){var e=this,o=t,n=f(e.Column,o.Column),r=f(e.Row,o.Row),i=h(e.Right,o.Right),a=h(e.Bottom,o.Bottom);n>=i||r>=a?(e.Column=0,e.Row=0,e.ColumnCount=0,e.RowCount=0):(e.Column=n,e.Row=r,e.ColumnCount=i-n,e.RowCount=a-r)},t.prototype.IntersectsWith=function(t){var e=this,o=t;return!(e.Left>=o.Right||e.Right<=o.Left||e.Top>=o.Bottom||e.Bottom<=o.Top)},t}(),e.CellRect=w,T=function(){function t(t,e){this.Worksheet=t,this.tpa=e,this.UpdateRects()}return t.prototype.UpdateRects=function(){var t,e,o,n,r,i,a,s,l,u,c,f=this;for(f.upa=[],r=(n=f.Worksheet).getRowCount(),i=n.getColumnCount(),a=0;a<f.tpa.length;a++){if(s=(o=f.tpa[a]).Row,l=o.Column,t=o.RowCount,e=o.ColumnCount,(s<0||t<0||l<0||e<0)&&((s<0||t<0)&&(s=0,t=v.INT32_MAX_VALUE),(l<0||e<0)&&(l=0,e=v.INT32_MAX_VALUE),f.tpa[a]=new w(s,l,t,e)),(0!==s||t!==v.INT32_MAX_VALUE)&&(s<0||t<=0||s+t>1048576))throw Error();if((0!==l||e!==v.INT32_MAX_VALUE)&&(l<0||e<=0||l+e>16384))throw Error()}for(u=0,c=f.tpa;u<c.length;u++)o=c[u],t=h(o.Bottom,r+1)-o.Top,e=h(o.Right,i+1)-o.Left,f.upa.push(new w(o.Row,o.Column,t,e))},Object.defineProperty(t.prototype,"Row",{get:function(){var t=this.upa[0].Row;return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Column",{get:function(){var t=this.upa[0].Column;return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RowCount",{get:function(){var t=this,e=t.upa[0].RowCount,o=t.upa[0].Row;return e<0||o<0?t.Worksheet.getRowCount():e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ColumnCount",{get:function(){var t=this.upa[0].ColumnCount,e=this.upa[0].Column,o=this.Worksheet.getColumnCount();return t<0||e<0?o:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EntireRow",{get:function(){var e,o,n=[];for(e=0;e<this.upa.length;e++)(o=this.upa[e]).Column=-1,o.ColumnCount=-1,n.push(o);return new t(this.Worksheet,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EntireColumn",{get:function(){var e,o,n=[];for(e=0;e<this.upa.length;e++)(o=this.upa[e]).Row=-1,o.RowCount=-1,n.push(o);return new t(this.Worksheet,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){var t=this;return t.Worksheet.vpa(t.Row,t.Column,t.RowCount,t.ColumnCount)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Areas",{get:function(){var e,o,n,r=[];for(e=0,o=this.upa;e<o.length;e++)n=o[e],r.push(new t(this.Worksheet,[n]));return r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Hidden",{get:function(){return this.Worksheet.wpa(this.tpa)},enumerable:!0,configurable:!0}),t}(),e.Range=T,function(t){t[t.Row=1]="Row",t[t.Column=2]="Column",t[t.RowIsRelative=4]="RowIsRelative",t[t.ColumnIsRelative=8]="ColumnIsRelative",t[t.LastRowIsRelative=16]="LastRowIsRelative",t[t.LastColumnIsRelative=32]="LastColumnIsRelative",t[t.Range=64]="Range",t[t.Error=128]="Error"}(S||(S={})),x=function(){function t(t,e,o,n,r){var i=this;i.WorksheetName=t,i.Row=e,i.Column=o,void 0!==n&&(i.LastRow=n),void 0!==r&&(i.LastColumn=r)}return Object.defineProperty(t.prototype,"Row",{get:function(){return(this.Kind&S.Row)===S.Row?this.cj:0},set:function(t){this.cj=t,this.Kind|=S.Row},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Column",{get:function(){return(this.Kind&S.Column)===S.Column?this.Lk:0},set:function(t){this.Lk=t,this.Kind|=S.Column},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RowCount",{get:function(){var t=this;return t.IsRange?(t.Kind&S.Row)===S.Row?t.RowIsRelative&&t.LastRowIsRelative||!t.RowIsRelative&&!t.LastRowIsRelative?t.LastRow-t.Row+1:-1:t.Worksheet.getRowCount():1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ColumnCount",{get:function(){var t=this;return t.IsRange?(t.Kind&S.Column)===S.Column?t.ColumnIsRelative&&t.LastColumnIsRelative||!t.ColumnIsRelative&&!t.LastColumnIsRelative?t.LastColumn-t.Column+1:-1:t.Worksheet.getColumnCount():1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastColumn",{get:function(){var t=this;return t.IsRange?(t.Kind&S.Column)===S.Column?t.xpa:t.Worksheet.getColumnCount()-1:t.Column},set:function(t){this.xpa=t,this.Kind|=S.Column|S.Range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastRow",{get:function(){var t=this;return t.IsRange?(t.Kind&S.Row)===S.Row?t.ypa:t.Worksheet.getRowCount()-1:t.Row},set:function(t){this.ypa=t,this.Kind|=S.Row|S.Range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RowIsRelative",{get:function(){return(this.Kind&(S.Row|S.RowIsRelative))==(S.Row|S.RowIsRelative)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ColumnIsRelative",{get:function(){return(this.Kind&(S.Column|S.ColumnIsRelative))==(S.Column|S.ColumnIsRelative)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastRowIsRelative",{get:function(){return this.IsRange?(this.Kind&(S.Row|S.LastRowIsRelative))==(S.Row|S.LastRowIsRelative):this.RowIsRelative},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastColumnIsRelative",{get:function(){return this.IsRange?(this.Kind&(S.Column|S.LastColumnIsRelative))==(S.Column|S.LastColumnIsRelative):this.ColumnIsRelative},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsRange",{get:function(){return(this.Kind&S.Range)===S.Range},set:function(t){t?this.Kind|=S.Range:this.Kind&=~S.Range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsError",{get:function(){return"#REF"===this.WorksheetName},enumerable:!0,configurable:!0}),t.prototype.GetSourceRange=function(t,e){var o=this,n=o.Row,r=o.Column,i=o.LastRow,a=o.LastColumn;return new w(n,r,i-n+1,a-r+1)},t.prototype.ToR1C1Text=function(t){var e,o,n,r,i,s;return t===c&&(t=u),o=(e=this).Yw,a.isNullOrUndefined(o)?(e.Kind&S.Error)===S.Error?e.GetPrevText(t)+"#REF!":(n="",(e.Kind&S.Row)===S.Row&&(r=e.Row,n+=e.RowIsRelative?0===r?"R":"R["+r+"]":"R"+(r+1)),(e.Kind&S.Column)===S.Column&&(i=e.Column,n+=e.ColumnIsRelative?0===i?"C":"C["+i+"]":"C"+(i+1)),e.IsRange&&(s=!1,(e.Kind&(S.Row|S.Column))!=(S.Row|S.Column)&&((e.Kind&S.Row)===S.Row?e.RowIsRelative===e.LastRowIsRelative&&e.Row===e.LastRow&&(s=!0):e.ColumnIsRelative===e.LastColumnIsRelative&&e.Column===e.LastColumn&&(s=!0)),s||(n+=":",(e.Kind&S.Row)===S.Row&&(r=e.LastRow,n+=e.LastRowIsRelative?0===r?"R":"R["+r+"]":"R"+(r+1)),(e.Kind&S.Column)===S.Column&&(i=e.LastColumn,n+=e.LastColumnIsRelative?0===i?"C":"C["+i+"]":"C"+(i+1)))),e.GetPrevText(t)+n):o},t.prototype.ToA1Text=function(t,e,o){var n,r,i,s,l;return o===c&&(o=u),r=(n=this).Yw,a.isNullOrUndefined(r)?(n.Kind&S.Error)===S.Error?n.GetPrevText(o)+"#REF!":(i="",(n.Kind&S.Column)===S.Column&&(l=n.Column,n.ColumnIsRelative?l+=e:i+="$",isNaN(l)||(i+=n.GetColumnIndexInA1Letter(l))),(n.Kind&S.Row)===S.Row&&(s=n.Row,n.RowIsRelative?s+=t:i+="$",i+=""+(s+1)),n.IsRange&&(i+=":",(n.Kind&S.Column)===S.Column&&(l=n.LastColumn,n.LastColumnIsRelative?l+=e:i+="$",isNaN(l)||(i+=n.GetColumnIndexInA1Letter(l))),(n.Kind&S.Row)===S.Row&&(s=n.LastRow,n.LastRowIsRelative?s+=t:i+="$",i+=""+(s+1))),n.GetPrevText(o)+i):r},t.prototype.GetPrevText=function(t){var e,o=this,n="";return o.Workbook>0&&(n="["+o.Workbook+"]"),e=o.WorksheetName,b.isNullOrUndefined(e)&&(e=t),e&&(n+=b.isNullOrUndefined(o.LastWorksheetName)?e:e+":"+o.LastWorksheetName),n?((o.IsSpecialSheetName(e)||o.IsSpecialSheetName(o.LastWorksheetName))&&(n="'"+n.replace("'","''")+"'"),n+="!"):""===e&&(n="!"),n},t.prototype.IsSpecialSheetName=function(e){var o,n;if(!b.isNullOrUndefined(e)){if(e===t.ErrorWorksheetName)return!1;for(o=0;o<e.length;o++)if(!((n=e[o])>="A"&&n<="Z"||n>="a"&&n<="z"||n>="0"&&n<="9"||"_"===n))return!0}return!1},t.prototype.GetColumnIndexInA1Letter=function(t){for(var e=[],o=0;(o=t%26,!isNaN(o))&&(e.unshift("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[o]),0!==(t=parseInt(t/26+"",10)));)t--;return e.join("")},t.ErrorWorksheetName="#REF",t}(),e.Reference=x,e.ChartConstants={XValuesMinMax:"XValuesMinMax",ValuesMinMax:"ValuesMinMax",PrimaryValuesMinMax:"PrimaryValuesMinMax",SecondaryValuesMinMax:"SecondaryValuesMinMax",PrimaryXValuesMinMax:"PrimaryXValuesMinMax",SecondaryXValuesMinMax:"SecondaryXValuesMinMax",Collection:"Collection",Restore:"Restore",ChartType:"ChartType",AxisGroup:"AxisGroup",AreAllXValuesDateTime:"AreAllXValuesDateTime",XValuesFormula:"XValuesFormula",XValues:"XValues",CategoryNames:"CategoryNames",CategoryType:"CategoryType",SecondaryPlot:"SecondaryPlot",SplitType:"SplitType",SplitValue:"SplitValue",IsMultiLevelXValues:"IsMultiLevelXValues",PlotOrder:"PlotOrder",FIELD_TYPE_CELLRANGE:"CELLRANGE",FIELD_TYPE_SERIESNAME:"SERIESNAME",FIELD_TYPE_CATEGORYNAME:"CATEGORYNAME",FIELD_TYPE_VALUE:"VALUE",FIELD_TYPE_XVALUE:"XVALUE",FIELD_TYPE_YVALUE:"YVALUE",FIELD_TYPE_BUBBLESIZE:"BUBBLESIZE",FIELD_TYPE_PERCENTAGE:"PERCENTAGE",FIELD_TYPE_TXLINK:"TxLink",FIELD_TEXT_CELLRANGE:"[CELLRANGE]",FIELD_TEXT_SERIESNAME:"[SERIES NAME]",FIELD_TEXT_CATEGORYNAME:"[CATEGORY NAME]",FIELD_TEXT_VALUE:"[VALUE]",FIELD_TEXT_XVALUE:"[XVALUE]",FIELD_TEXT_YVALUE:"[YVALUE]",FIELD_TEXT_BUBBLESIZE:"[BUBBLE SIZE]",CHART_LATIN_HEAD_FONT:"+mj-lt",CHART_LATIN_BODY_FONT:"+mn-lt",CHART_EA_HEAD_FONT:"+mj-ea",CHART_EA_BODY_FONT:"+mn-ea",CHART_CS_HEAD_FONT:"+mj-cs",CHART_CS_BODY_FONT:"+mn-cs",DefaultLineColorBrightness:.85,DefaultMarkerSize:7},e.ShapeConstants={ShapeTypePrefix:"Shape",PositiveFixedAngleConvert:6e4,PositionConver:1e5,CropPositionConver:1e3,ShadeConver:2e5,DefaultBrightness:.5,RelativeRectConver:1e3,DefaultTransparent:0,PositiveFixedPercentageConvert:1e5,DefaultOffset:2.07995176},A=["","Dotted-5%","Dotted-10%","Dotted-20%","Dotted-25%","Dotted-30%","Dotted-40%","Dotted-50%","Dotted-60%","Dotted-70%","Dotted-75%","Dotted-80%","Dotted-90%","HorizontalStripes-Dark","VerticalStripes-Dark","DiagonalStripes-DarkDownward","DiagonalStripes-DarkUpward","SmallCheckerBoard","Trellis","HorizontalStripes-Light","VerticalStripes-Light","DiagonalStripes-LightDownward","DiagonalStripes-LightUpward","SmallGrid","DottedDiamondGrid","DiagonalStripes-WideDownward","DiagonalStripes-WideUpward","Stripes-Slashes","Stripes-Backslashes","VerticalStripes-Narrow","HorizontalStripes-Narrow","VerticalStripes-AlternatingVerticalLines","HorizontalStripes-AlternatingHorizontalLines","LargeConfetti","LargeGrid","HorizontalBrick","LargeCheckerBoard","SmallConfetti","ZigZag","SolidDiamondGrid","DiagonalBrick","OutlinedDiamondGrid","Plaid","Sphere","Weave","DottedGrid","Divot","Shingle","Wave"],function(t){t[t["background 1"]=0]="background 1",t[t["background 2"]=2]="background 2",t[t["text 1"]=1]="text 1",t[t["text 2"]=3]="text 2",t[t["accent 1"]=4]="accent 1",t[t["accent 2"]=5]="accent 2",t[t["accent 3"]=6]="accent 3",t[t["accent 4"]=7]="accent 4",t[t["accent 5"]=8]="accent 5",t[t["accent 6"]=9]="accent 6",t[t.hyperlink=10]="hyperlink",t[t.followedhyperlink=11]="followedhyperlink"}(I||(I={})),R=function(){function t(){}return t.Kqa=function(t,e){},t.Yra=function(t,e){return e===r.ThemeFont.Major?t.getFont("Headings"):e===r.ThemeFont.Minor?t.getFont("Body"):""},t.colorFormatToString=function(e,o,n,r){var i=e&&e.Color;return t.colorFormatToStringImp(i,o,n,r)},t.colorFormatToStringImp=function(e,o,n,i){var a,s;if(e&&e.ColorType!==r.SolidColorType.None){if(o&&(a=e.GetColorData()).ColorType===r.ColorType.Theme)return t.toThemeColorString(a.Value,a.Tint);if(s=e.RGB)return n?"rgba("+s.R+","+s.G+","+s.B+","+s.A/255+")":"rgb("+s.R+","+s.G+","+s.B+")"}else if(e&&e.ColorType===r.SolidColorType.None&&i)return"";return"transparent"},t.getFillFormatResult=function(e,o,n,r,i){var a,s,l,u,c;return 1===(e&&e.Type)?(a={},s=e&&e.PatternColor,l=e&&e.Color,u=t.colorFormatToStringImp(s,o,n,r),c=t.colorFormatToStringImp(l,o,n,r),i?(a.type="Pattern",a.color=c,a.pattern=[],a.pattern.push({style:{fill:u},content:A[e.Pattern]})):(a.type=e.Pattern,a.foregroundColor=u,a.backgroundColor=c),a):t.colorFormatToString(e,o,n,r)},t.getTransparencyFromColorFormat=function(t,e){var o,n=t&&t.Color;if(n&&(n.ColorType!==r.SolidColorType.None||e)){if(!b.isNullOrUndefined(n.Transparency))return parseFloat(n.Transparency.toFixed(2));if(o=n.RGB)return parseFloat((o.A/255).toFixed(2))}return 0},t.toThemeColorString=function(t,e){return I[t]+" "+parseInt(100*e+"",10)},t.fromThemeColorString=function(t){var e,o=t.split(" "),n=o.length,r=o[0].toLowerCase(),i=o[1],a=o[2];if("hyperlink"===r||"followedhyperlink"===r){if(1===n)return{index:I[r],tint:0};if(2===n)return{index:I[r],tint:parseInt(i,10)/100}}if(n>=2&&(e=I[r+" "+i])!==c){if(2===n)return{index:e,tint:0};if(3===n)return{index:e,tint:parseInt(a,10)/100}}},t.InitPresetColors=function(){var e=t.presetColors;e[r.ST_PresetColorVal.aliceBlue]=[240,248,255],e[r.ST_PresetColorVal.antiqueWhite]=[250,235,215],e[r.ST_PresetColorVal.aqua]=[0,255,255],e[r.ST_PresetColorVal.aquamarine]=[127,255,212],e[r.ST_PresetColorVal.azure]=[240,255,255],e[r.ST_PresetColorVal.beige]=[245,245,220],e[r.ST_PresetColorVal.bisque]=[255,228,196],e[r.ST_PresetColorVal.black]=[0,0,0],e[r.ST_PresetColorVal.blanchedAlmond]=[255,235,205],e[r.ST_PresetColorVal.blue]=[0,0,255],e[r.ST_PresetColorVal.blueViolet]=[138,43,226],e[r.ST_PresetColorVal.brown]=[165,42,42],e[r.ST_PresetColorVal.burlyWood]=[222,184,135],e[r.ST_PresetColorVal.cadetBlue]=[95,158,160],e[r.ST_PresetColorVal.chartreuse]=[127,255,0],e[r.ST_PresetColorVal.chocolate]=[210,105,30],e[r.ST_PresetColorVal.coral]=[255,127,80],e[r.ST_PresetColorVal.cornflowerBlue]=[100,149,237],e[r.ST_PresetColorVal.cornsilk]=[255,248,220],e[r.ST_PresetColorVal.crimson]=[220,20,60],e[r.ST_PresetColorVal.cyan]=[0,255,255],e[r.ST_PresetColorVal.darkBlue]=[0,0,139],e[r.ST_PresetColorVal.darkCyan]=[0,139,139],e[r.ST_PresetColorVal.darkGoldenrod]=[184,134,11],e[r.ST_PresetColorVal.darkGray]=[169,169,169],e[r.ST_PresetColorVal.darkGreen]=[0,100,0],e[r.ST_PresetColorVal.darkGrey]=[169,169,169],e[r.ST_PresetColorVal.darkKhaki]=[189,183,107],e[r.ST_PresetColorVal.darkMagenta]=[139,0,139],e[r.ST_PresetColorVal.darkOliveGreen]=[85,107,47],e[r.ST_PresetColorVal.darkOrange]=[255,140,0],e[r.ST_PresetColorVal.darkOrchid]=[153,50,204],e[r.ST_PresetColorVal.darkRed]=[139,0,0],e[r.ST_PresetColorVal.darkSalmon]=[233,150,122],e[r.ST_PresetColorVal.darkSeaGreen]=[143,188,143],e[r.ST_PresetColorVal.darkSlateBlue]=[72,61,139],e[r.ST_PresetColorVal.darkSlateGray]=[47,79,79],e[r.ST_PresetColorVal.darkSlateGrey]=[47,79,79],e[r.ST_PresetColorVal.darkTurquoise]=[0,206,209],e[r.ST_PresetColorVal.darkViolet]=[148,0,211],e[r.ST_PresetColorVal.deepPink]=[255,20,147],e[r.ST_PresetColorVal.deepSkyBlue]=[0,191,255],e[r.ST_PresetColorVal.dimGray]=[105,105,105],e[r.ST_PresetColorVal.dimGrey]=[105,105,105],e[r.ST_PresetColorVal.dkBlue]=[0,0,139],e[r.ST_PresetColorVal.dkCyan]=[0,139,139],e[r.ST_PresetColorVal.dkGoldenrod]=[184,134,11],e[r.ST_PresetColorVal.dkGray]=[169,169,169],e[r.ST_PresetColorVal.dkGreen]=[0,100,0],e[r.ST_PresetColorVal.dkGrey]=[169,169,169],e[r.ST_PresetColorVal.dkKhaki]=[189,183,107],e[r.ST_PresetColorVal.dkMagenta]=[139,0,139],e[r.ST_PresetColorVal.dkOliveGreen]=[85,107,47],e[r.ST_PresetColorVal.dkOrange]=[255,140,0],e[r.ST_PresetColorVal.dkOrchid]=[153,50,204],e[r.ST_PresetColorVal.dkRed]=[139,0,0],e[r.ST_PresetColorVal.dkSalmon]=[233,150,122],e[r.ST_PresetColorVal.dkSeaGreen]=[143,188,139],e[r.ST_PresetColorVal.dkSlateBlue]=[72,61,139],e[r.ST_PresetColorVal.dkSlateGray]=[47,79,79],e[r.ST_PresetColorVal.dkSlateGrey]=[47,79,79],e[r.ST_PresetColorVal.dkTurquoise]=[0,206,209],e[r.ST_PresetColorVal.dkViolet]=[148,0,211],e[r.ST_PresetColorVal.dodgerBlue]=[30,144,255],e[r.ST_PresetColorVal.firebrick]=[178,34,34],e[r.ST_PresetColorVal.floralWhite]=[255,250,240],e[r.ST_PresetColorVal.forestGreen]=[34,139,34],e[r.ST_PresetColorVal.fuchsia]=[255,0,255],e[r.ST_PresetColorVal.gainsboro]=[220,220,220],e[r.ST_PresetColorVal.ghostWhite]=[248,248,255],e[r.ST_PresetColorVal.gold]=[255,215,0],e[r.ST_PresetColorVal.goldenrod]=[218,165,32],e[r.ST_PresetColorVal.gray]=[128,128,128],e[r.ST_PresetColorVal.green]=[0,128,0],e[r.ST_PresetColorVal.greenYellow]=[173,255,47],e[r.ST_PresetColorVal.grey]=[128,128,128],e[r.ST_PresetColorVal.honeydew]=[240,255,240],e[r.ST_PresetColorVal.hotPink]=[255,105,180],e[r.ST_PresetColorVal.indianRed]=[205,92,92],e[r.ST_PresetColorVal.indigo]=[75,0,130],e[r.ST_PresetColorVal.ivory]=[255,255,240],e[r.ST_PresetColorVal.khaki]=[240,230,140],e[r.ST_PresetColorVal.lavender]=[230,230,250],e[r.ST_PresetColorVal.lavenderBlush]=[255,240,245],e[r.ST_PresetColorVal.lawnGreen]=[124,252,0],e[r.ST_PresetColorVal.lemonChiffon]=[255,250,205],e[r.ST_PresetColorVal.lightBlue]=[173,216,230],e[r.ST_PresetColorVal.lightCoral]=[240,128,128],e[r.ST_PresetColorVal.lightCyan]=[224,255,255],e[r.ST_PresetColorVal.lightGoldenrodYellow]=[250,250,210],e[r.ST_PresetColorVal.lightGray]=[211,211,211],e[r.ST_PresetColorVal.lightGreen]=[144,238,144],e[r.ST_PresetColorVal.lightGrey]=[211,211,211],e[r.ST_PresetColorVal.lightPink]=[255,182,193],e[r.ST_PresetColorVal.lightSalmon]=[255,160,122],e[r.ST_PresetColorVal.lightSeaGreen]=[32,178,170],e[r.ST_PresetColorVal.lightSkyBlue]=[135,206,250],e[r.ST_PresetColorVal.lightSlateGray]=[119,136,153],e[r.ST_PresetColorVal.lightSlateGrey]=[119,136,153],e[r.ST_PresetColorVal.lightSteelBlue]=[176,196,222],e[r.ST_PresetColorVal.lightYellow]=[255,255,224],e[r.ST_PresetColorVal.lime]=[0,255,0],e[r.ST_PresetColorVal.limeGreen]=[50,205,50],e[r.ST_PresetColorVal.linen]=[250,240,230],e[r.ST_PresetColorVal.ltBlue]=[173,216,230],e[r.ST_PresetColorVal.ltCoral]=[240,128,128],e[r.ST_PresetColorVal.ltCyan]=[224,255,255],e[r.ST_PresetColorVal.ltGoldenrodYellow]=[250,250,120],e[r.ST_PresetColorVal.ltGray]=[211,211,211],e[r.ST_PresetColorVal.ltGreen]=[144,238,144],e[r.ST_PresetColorVal.ltGrey]=[211,211,211],e[r.ST_PresetColorVal.ltPink]=[255,182,193],e[r.ST_PresetColorVal.ltSalmon]=[255,160,122],e[r.ST_PresetColorVal.ltSeaGreen]=[32,178,170],e[r.ST_PresetColorVal.ltSkyBlue]=[135,206,250],e[r.ST_PresetColorVal.ltSlateGray]=[119,136,153],e[r.ST_PresetColorVal.ltSlateGrey]=[119,136,153],e[r.ST_PresetColorVal.ltSteelBlue]=[176,196,222],e[r.ST_PresetColorVal.ltYellow]=[255,255,224],e[r.ST_PresetColorVal.magenta]=[255,0,255],e[r.ST_PresetColorVal.maroon]=[128,0,0],e[r.ST_PresetColorVal.medAquamarine]=[102,205,170],e[r.ST_PresetColorVal.medBlue]=[0,0,205],e[r.ST_PresetColorVal.mediumAquamarine]=[102,205,170],e[r.ST_PresetColorVal.mediumBlue]=[0,0,205],e[r.ST_PresetColorVal.mediumOrchid]=[186,85,211],e[r.ST_PresetColorVal.mediumPurple]=[147,112,219],e[r.ST_PresetColorVal.mediumSeaGreen]=[60,179,113],e[r.ST_PresetColorVal.mediumSlateBlue]=[123,104,238],e[r.ST_PresetColorVal.mediumSpringGreen]=[0,250,154],e[r.ST_PresetColorVal.mediumTurquoise]=[72,209,204],e[r.ST_PresetColorVal.mediumVioletRed]=[199,21,133],e[r.ST_PresetColorVal.medOrchid]=[186,85,211],e[r.ST_PresetColorVal.medPurple]=[147,112,219],e[r.ST_PresetColorVal.medSeaGreen]=[60,179,113],e[r.ST_PresetColorVal.medSlateBlue]=[123,104,238],e[r.ST_PresetColorVal.medSpringGreen]=[0,250,154],e[r.ST_PresetColorVal.medTurquoise]=[72,209,204],e[r.ST_PresetColorVal.medVioletRed]=[199,21,133],e[r.ST_PresetColorVal.midnightBlue]=[25,25,112],e[r.ST_PresetColorVal.mintCream]=[245,255,250],e[r.ST_PresetColorVal.mistyRose]=[255,228,225],e[r.ST_PresetColorVal.moccasin]=[255,228,181],e[r.ST_PresetColorVal.navajoWhite]=[255,222,173],e[r.ST_PresetColorVal.navy]=[0,0,128],e[r.ST_PresetColorVal.oldLace]=[253,245,230],e[r.ST_PresetColorVal.olive]=[128,128,0],e[r.ST_PresetColorVal.oliveDrab]=[107,142,35],e[r.ST_PresetColorVal.orange]=[255,165,0],e[r.ST_PresetColorVal.orangeRed]=[255,69,0],e[r.ST_PresetColorVal.orchid]=[218,112,214],e[r.ST_PresetColorVal.paleGoldenrod]=[238,232,170],e[r.ST_PresetColorVal.paleGreen]=[152,251,152],e[r.ST_PresetColorVal.paleTurquoise]=[175,238,238],e[r.ST_PresetColorVal.paleVioletRed]=[219,112,147],e[r.ST_PresetColorVal.papayaWhip]=[255,239,213],e[r.ST_PresetColorVal.peachPuff]=[255,218,185],e[r.ST_PresetColorVal.peru]=[205,133,63],e[r.ST_PresetColorVal.pink]=[255,192,203],e[r.ST_PresetColorVal.plum]=[221,160,221],e[r.ST_PresetColorVal.powderBlue]=[176,224,230],e[r.ST_PresetColorVal.purple]=[128,0,128],e[r.ST_PresetColorVal.red]=[255,0,0],e[r.ST_PresetColorVal.rosyBrown]=[188,143,143],e[r.ST_PresetColorVal.royalBlue]=[65,105,225],e[r.ST_PresetColorVal.saddleBrown]=[139,69,19],e[r.ST_PresetColorVal.salmon]=[250,128,114],e[r.ST_PresetColorVal.sandyBrown]=[244,164,96],e[r.ST_PresetColorVal.seaGreen]=[46,139,87],e[r.ST_PresetColorVal.seaShell]=[255,245,238],e[r.ST_PresetColorVal.sienna]=[160,82,45],e[r.ST_PresetColorVal.silver]=[192,192,192],e[r.ST_PresetColorVal.skyBlue]=[135,206,235],e[r.ST_PresetColorVal.slateBlue]=[106,90,205],e[r.ST_PresetColorVal.slateGray]=[112,128,144],e[r.ST_PresetColorVal.slateGrey]=[112,128,144],e[r.ST_PresetColorVal.snow]=[255,250,250],e[r.ST_PresetColorVal.springGreen]=[0,255,127],e[r.ST_PresetColorVal.steelBlue]=[70,130,180],e[r.ST_PresetColorVal.tan]=[210,180,140],e[r.ST_PresetColorVal.teal]=[0,128,128],e[r.ST_PresetColorVal.thistle]=[216,191,216],e[r.ST_PresetColorVal.tomato]=[255,99,71],e[r.ST_PresetColorVal.turquoise]=[64,224,208],e[r.ST_PresetColorVal.violet]=[238,130,238],e[r.ST_PresetColorVal.wheat]=[245,222,179],e[r.ST_PresetColorVal.white]=[255,255,255],e[r.ST_PresetColorVal.whiteSmoke]=[245,245,245],e[r.ST_PresetColorVal.yellow]=[255,255,0],e[r.ST_PresetColorVal.yellowGreen]=[154,205,50]},t.GetPresetColorRGB=function(e){return t.presetColors[e]},t.GetDimensioin=function(t){return{0:-1,1:2,33:2,34:2,35:2,36:2,11:3,48:3,57:2,58:2}[t]||1},t.AreValuesAllNum=function(t,e,o){var n,r,i;if(b.isNullOrUndefined(e))return null;for(n=t.getArray(e.row,e.col,e.rowCount,e.colCount),r=!0,i=0;i<n.length;i++)if(!this.AreAllNumbers(n[i],o)){r=!1;break}return r},t.AreValuesDateTime=function(e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,w;if(b.isNullOrUndefined(o)||0===o.length)return!1;for(r=!0,a=this.GetStylesFromCellRefers(e,o,n),s=this.GetValuesFromCellRefers(e,o,n),l=0;l<a.length;l++){for(c=(u=a[l]).length,f=u[0]&&u[0].length,h=0;h<f;h++){for(p=0;p<c;p++)if(d=u[p][h],i=s[l]&&s[l][p]&&s[l][p][h],!b.isNullOrUndefined(i)&&!(i instanceof Date)&&(b.isNullOrUndefined(d)||!t.IsDatesOrTimesNumberFormat(d.FormatCode)||!D(i))){r=!1;break}if(!r)break}if(!r)break}if(r){for(g=0,m=s;g<m.length;g++)for(y=0,C=m[g];y<C.length;y++)if(v=C[y],!b.isNullOrUndefined(v))for(w=0;w<v.length;w++)if(i=v[w],!b.isNullOrUndefined(i))return!0;return!1}return!1},t.AreAllNumbers=function(t,e){var o,n,r,i,a,s;if(!t)return!1;for(o=!0,n=0,r=t;n<r.length;n++)if(a=D(i=r[n]),s=e&&(null===i||i&&i._error),!a&&!s){o=!1;break}return o},t.AreAllNull=function(t){var e,o,n=!0;for(e=0,o=t;e<o.length;e++)if(null!=o[e]){n=!1;break}return n},t.AreAllDate=function(t,e){var o,n,r,i;for(o=0,n=t;o<n.length;o++)if(r=n[o],i=e&&(null===r||r&&r._error),!(r instanceof Date||i))return!1;return!0},t.TryAllToNumbers=function(t,e,o){var n,r,i,a,l,u;if(b.isNullOrUndefined(t)||0===t.length)return!1;for(n=!0,r=[],i=t.length,a=0;a<i;a++)l=t[a],b.isNullOrUndefined(l)?o||r.push(l):(u={value:void 0},this.TryToDouble(l,u)?r.push(u.value):(s.Convert&&s.Convert.jja(l)?r.push(Number.NaN):r.push(0),n=!1));return Array.prototype.push.apply(e,r),n},t.TryToDouble=function(t,e,o){var n,r,i,a,s=u;if(!t)return e.value=0,!0;n=typeof t;try{if("number"===n)s=t;else if("string"===n&&o){if(0===(t=t.trim()).length)return e.value=0,!0;if(r=".",",",i=!1,"%"===t.charAt(t.length-1)&&(i=!0,t=t.substr(0,t.length-1)),"$"===t[0]||"$"===t[t.length-1])return!1;if(t.indexOf(r)!==t.lastIndexOf(r))return!1;if(t.length>=2&&"0"===t[0]&&"x"===t[1])return!1;if(s=+t,v.isNaNOrInfinite(s)){if(a=t.charCodeAt(0),a|=32,t.length>4&&a>=96&&a<=122&&!{JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12}[(t[0]+t[1]+t[2]).toUpperCase()])return!1;if("/"===t[0]||"/"===t[t.length-1])return!1;if("#"===t[0]||"#"===t[t.length-1])return!1;if(s=new Date(t),v.isNaNOrInfinite(s.valueOf()))return!1;s=C.ToOADate(s)}i&&(s/=100)}else if("boolean"===n)s=t?1:0;else{if(!(t instanceof Date))return!1;s=C.ToOADate(t)}}catch(t){return!1}return e.value=s,!0},t.IsBarChart=function(t){return t===r.ChartType.barClustered||t===r.ChartType.barClustered3D||t===r.ChartType.barStacked||t===r.ChartType.barStacked100||t===r.ChartType.barStacked1003D||t===r.ChartType.barStacked3D},t.zpa=function(e){var o,n=t.chartTypeDict;if(!n)for(o in n=t.chartTypeDict={},r.ChartType)n[r.ChartType[o]]=o.toLowerCase();return n[e]},t.IsColumnChart=function(e){return t.zpa(e).indexOf("column")>=0},t.IsAnyPieChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)||this.IsOfPieChart(t)},t.IsFunnelChart=function(t){return t===r.ChartType.funnel},t.IsPieChart=function(e){return t.zpa(e).indexOf("pie")>=0},t.IsPieOrDoughnutChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)},t.IsRadarChart=function(t){return t===r.ChartType.radar||t===r.ChartType.radarFilled||t===r.ChartType.radarMarkers},t.IsOfPieChart=function(t){return t===r.ChartType.pieOfPie||t===r.ChartType.barOfPie},t.IsStackedChart=function(e){return t.zpa(e).indexOf("stacked")>=0},t.IsStacked100Chart=function(e){return t.zpa(e).indexOf("stacked100")>=0},t.IsLineChart=function(t){return t===r.ChartType.line3D||t===r.ChartType.line||t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100||t===r.ChartType.lineStacked||t===r.ChartType.lineStacked100},t.IsLineMarkerChart=function(t){return t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100},t.IsLineSeries=function(t){return t===r.ChartType.line||t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100||t===r.ChartType.lineStacked||t===r.ChartType.lineStacked100||t===r.ChartType.xyScatterLines||t===r.ChartType.xyScatterLinesNoMarkers||t===r.ChartType.xyScatterSmooth||t===r.ChartType.xyScatterSmoothNoMarkers||t===r.ChartType.radar||t===r.ChartType.radarMarkers},t.IsMarkerSeries=function(t){return t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100||t===r.ChartType.radarMarkers||t===r.ChartType.xyScatter||t===r.ChartType.xyScatterLines||t===r.ChartType.xyScatterSmooth},t.IsErrorBarSeries=function(e){return!t.Is3DChart(e)&&(t.IsBarChart(e)||t.IsAreaChart(e)||t.IsLineChart(e)||t.IsColumnChart(e)||t.IsScatterChart(e)||t.IsBubbleChart(e))},t.IsTrendlineSeries=function(e){return!t.Is3DChart(e)&&!t.IsStackedChart(e)&&(e===r.ChartType.barClustered||e===r.ChartType.columnClustered||e===r.ChartType.line||e===r.ChartType.lineMarkers||e===r.ChartType.area||t.IsScatterChart(e)||t.IsBubbleChart(e))},t.IsFillSeries=function(t){return!this.IsLineSeries(t)&&t!==r.ChartType.xyScatter},t.IsAreaChart=function(e){return t.zpa(e).indexOf("area")>=0},t.IsScatterChart=function(e){return t.zpa(e).indexOf("scatter")>=0},t.IsSurfaceChart=function(e){return t.zpa(e).indexOf("surface")>=0},t.IsBubbleChart=function(e){return t.zpa(e).indexOf("bubble")>=0},t.IsSmoothLine=function(e){return t.zpa(e).indexOf("smooth")>=0},t.Is3DChart=function(e){var o=t.zpa(e);return o.indexOf("3d")>=0&&e!==r.ChartType.bubble3DEffect||this.IsSurfaceChart(e)||o.indexOf("cylinder")>=0||o.indexOf("cone")>=0||o.indexOf("pyramid")>=0},t.IsSurface3DChart=function(t){return t===r.ChartType.surface||t===r.ChartType.surfaceWireframe},t.IsDoughnutChart=function(t){return t===r.ChartType.doughnut||t===r.ChartType.doughnutExploded},t.IsExplodedChart=function(t){return t===r.ChartType.pieExploded3D||t===r.ChartType.doughnutExploded||t===r.ChartType.pieExploded},t.HasSeriesAx=function(t){return t===r.ChartType.column3D||t===r.ChartType.area3D||t===r.ChartType.line3D||this.IsSurfaceChart(t)},t.IsStockChart=function(e){return t.zpa(e).indexOf("stock")>=0},t.IsTreeMap=function(t){return t===r.ChartType.treemap},t.IsSunburstChart=function(t){return t===r.ChartType.sunburst},t.IsSunburstOrTreemapChart=function(e){return t.IsTreeMap(e)||t.IsSunburstChart(e)},t.IsStockHLC=function(t){return t===r.ChartType.stockHLC},t.IsBuiltInComboChart=function(t){return this.IsStockChart(t)},t.ConvertToTextUnderlineType=function(t){var e=r.TextUnderlineType.None;return t===r.UnderlineType.Single?e=r.TextUnderlineType.Single:t===r.UnderlineType.Double&&(e=r.TextUnderlineType.Double),e},t.ToUnderlineType=function(t){var e=r.UnderlineType.None;return t===r.TextUnderlineType.Single?e=r.UnderlineType.Single:t===r.TextUnderlineType.Double&&(e=r.UnderlineType.Double),e},t.MapToGroupType=function(t){return{12:9,13:9,14:9,15:3,16:3,17:3,6:3,18:8,19:8,20:8,21:2,22:2,23:2,9:11,24:11,25:11,26:11,27:11,28:11,5:4,10:12,29:12,30:12,32:12,31:5,4:5,1:14,33:14,34:14,35:14,36:14,8:7,37:7,38:7,39:1,40:1,7:1,3:10,41:10,2:13,42:13,43:13,44:6,45:6,46:6,47:6,11:14,48:14,49:11,50:11,51:11,52:11}[t]||O.UnKnown},t.HasSeriesLines=function(t){return this.IsOfPieChart(t)},t.HasHiLoLines=function(t){return this.IsStockChart(t)},t.HasUpDownBars=function(t){return t===r.ChartType.stockOHLC||t===r.ChartType.stockVOHLC},t.RangeToReferences=function(e){var o,n,r,i=[];for(o=0,n=e.Areas;o<n.length;o++)r=n[o],i.push(t.CreateReference(r.Worksheet.name(),r.Row,r.Column,r.RowCount,r.ColumnCount));return i},t.CreateReference=function(t,e,o,n,r){return 1===n&&1===r?new x(t,e,o):new x(t,e,o,e+n-1,o+r-1)},t.ReferencesToFormula=function(t,e){var o,n;if(e===c&&(e=!1),b.isNullOrUndefined(t)||0===t.length)return u;for(o=[],n=0;n<t.length;n++)n>0&&o.push(","),e?o.push(t[n].ToR1C1Text()):o.push(t[n].ToA1Text(0,0));return o.join("")},t.getRangeInfoByFormula=function(t,e){var o,n;return e&&((o=i.formulaToRanges(t,e,0,0)[0])&&(n=t.parent.getSheetFromName(o.sheetName)))?{sheet:n,range:o.ranges&&o.ranges[0]}:{range:{}}},t.isContinuousRange=function(t,e,o){if(t.sheet!==e.sheet)return!1;var n,r,i,a,s,l,u,c,f,h;if(o){if(i=(n=t.range).rowCount,a=n.col,s=n.colCount,c=(l=e.range).rowCount,f=l.col,i===c&&a+s===f)return!0}else if(i=(n=t.range).rowCount,r=n.row,s=n.colCount,h=(l=e.range).colCount,u=n.row,s===h&&r+i===u)return!0},t.GetValuesFromCellRefers=function(t,e,o){var n,r,i,a,s=[];if(b.isNullOrUndefined(e)||0===e.length||e.some((function(t){return t.IsError})))return s;for(n=0,r=e;n<r.length;n++)i=r[n],a=this.GetValuesFromCellRefer(t,i,o),b.isNullOrUndefined(a)||s.push(a);return s},t.GetValuesFromCellRefer=function(t,e,o){var n=t.Apa(e.WorksheetName);return b.isNullOrUndefined(n)?u:o?n.Bpa(e.Row,e.Column,e.RowCount,e.ColumnCount,!0):n.Cpa(e.Row,e.Column,e.RowCount,e.ColumnCount,!0)},t.GetStylesFromCellRefers=function(t,e,o){var n,r,i,a,s=[];if(b.isNullOrUndefined(e)||0===e.length||e.some((function(t){return t.IsError})))return s;for(n=0,r=e;n<r.length;n++)i=r[n],a=this.GetStylesFromCellRefer(t,i,o),b.isNullOrUndefined(a)||s.push(a);return s},t.GetStylesFromCellRefer=function(t,e,o){var n=t.Apa(e.WorksheetName);return b.isNullOrUndefined(n)?u:o?n.Dpa(e.Row,e.Column,e.RowCount,e.ColumnCount):n.Epa(e.Row,e.Column,e.RowCount,e.ColumnCount)},t.GetPrimaryAxises=function(t){var e,o,n=[],r=t.axes.length;if(t.axes&&r>0)for(e=0;e<r;e++)o=t.axes[e],a.isNullOrUndefined(o.AxisGroup)?r>2?0!==e&&1!==e||(n.push(o.axId),n.push(o.crossAx),n.axisGroup=o.AxisGroup):0===e&&(n.push(o.axId),n.push(o.crossAx),n.axisGroup=o.AxisGroup):0===o.AxisGroup&&(n.push(o.axId),n.push(o.crossAx),n.axisGroup=o.AxisGroup);return n},t.GetAxises=function(e,o){var n,i,a,s,l,u=t.GetPrimaryAxises(e);if(o===r.AxisGroup.primary)return u;if(n=[],!b.isNullOrUndefined(e.axes))for(i=e.axes.filter((function(t){return u.indexOf(t.axId)<0})),a=0,s=i;a<s.length;a++)l=s[a],n.push(l.axId);return n},t.GetCategoryAxises=function(t){var e,o,n,r=[];for(e=0,o=t.chartGroups;e<o.length;e++)n=o[e],!b.isNullOrUndefined(n.axId)&&n.axId.length>0&&r.push(n.axId[0]);return r},t.GetIs2016ChartByPlotArea=function(e){return!!t.Get2016ChartType(e)},t.GetIs2016ChartByChartType=function(t){return 53===t||54===t||55===t||56===t||57===t||58===t||59===t||60===t},t.Get2016ChartType=function(t){var e,o=t&&t.plotAreaRegion&&t.plotAreaRegion.series;return o&&o.length>0&&(e=o[0].layoutId),e},t.GetChartType=function(e){var o,n,i,a,s,l,u=t.Get2016ChartType(e);if(u)return t.GetChartTypeBy2016InnerChartType(u);if(o=this.GetStockChartType(e),!b.isNullOrUndefined(o))return o;for(n=[],i=0,a=e.chartGroups;i<a.length;i++)s=a[i],l=t.GetChartTypeByChartBase(s),n.indexOf(l)<0&&n.push(l);return 0===n.length?r.ChartType.columnClustered:n.length>1?r.ChartType.combo:n[0]},t.GetStockChartType=function(e){var o=t.GetStockChart(e);if(0===o.length)return u;if(!b.isNullOrUndefined(e.chartGroups)&&e.chartGroups.length>1){if(3===o[0].ser.length)return r.ChartType.stockVHLC;if(4===o[0].ser.length)return r.ChartType.stockVOHLC}else{if(3===o[0].ser.length)return r.ChartType.stockHLC;if(4===o[0].ser.length)return r.ChartType.stockOHLC}return u},t.GetChartTypeByChartBase=function(e,o){return o===c&&(o=u),e.chartType===r.CT_ChartType.CT_BarChart||e.chartType===r.CT_ChartType.CT_Bar3DChart?t.GetChartTypeByBarChart(e):e.chartType===r.CT_ChartType.CT_AreaChart||e.chartType===r.CT_ChartType.CT_Area3DChart?t.GetChartTypeByAreaChart(e):e.chartType===r.CT_ChartType.CT_LineChart||e.chartType===r.CT_ChartType.CT_Line3DChart?t.GetChartTypeByLineChart(e,o):[r.CT_ChartType.CT_PieChart,r.CT_ChartType.CT_Pie3DChart,r.CT_ChartType.CT_DoughnutChart,r.CT_ChartType.CT_OfPieChart].indexOf(e.chartType)>=0?t.GetChartTypeByPieChart(e):e.chartType===r.CT_ChartType.CT_RadarChart?t.GetChartTypeByRadarChart(e,o):e.chartType===r.CT_ChartType.CT_ScatterChart?t.GetChartTypeByScatterChart(e,o):e.chartType===r.CT_ChartType.CT_BubbleChart?t.GetChartTypeByBubbleChart(e):e.chartType===r.CT_ChartType.CT_SurfaceChart||e.chartType===r.CT_ChartType.CT_Surface3DChart?t.GetChartTypeBySurfaceChart(e):r.ChartType.columnClustered},t.GetChartTypeBy2016InnerChartType=function(t){if(!b.isNullOrUndefined(t))switch(t){case r.CT_ChartType.CT_BoxWhisker:return r.ChartType.boxWhisker;case r.CT_ChartType.CT_Funnel:return r.ChartType.funnel;case r.CT_ChartType.CT_ParetoLine:return r.ChartType.paretoLine;case r.CT_ChartType.CT_RegionMap:return r.ChartType.regionMap;case r.CT_ChartType.CT_Sunburst:return r.ChartType.sunburst;case r.CT_ChartType.CT_Treemap:return r.ChartType.treemap;case r.CT_ChartType.CT_Waterfall:return r.ChartType.waterfall;case r.CT_ChartType.CT_ClusteredColumn:return r.ChartType.clusteredColumn}return r.CT_ChartType.CT_Treemap},t.Get2016InnerChartTypeByChartType=function(t){if(!b.isNullOrUndefined(t))switch(t){case r.ChartType.boxWhisker:return r.CT_ChartType.CT_BoxWhisker;case r.ChartType.funnel:return r.CT_ChartType.CT_Funnel;case r.ChartType.paretoLine:return r.CT_ChartType.CT_ParetoLine;case r.ChartType.regionMap:return r.CT_ChartType.CT_RegionMap;case r.ChartType.sunburst:return r.CT_ChartType.CT_Sunburst;case r.ChartType.treemap:return r.CT_ChartType.CT_Treemap;case r.ChartType.waterfall:return r.CT_ChartType.CT_Waterfall;case r.ChartType.clusteredColumn:return r.CT_ChartType.CT_ClusteredColumn}return r.CT_ChartType.CT_Treemap},t.GetChartTypeByBarChart=function(t){var e=t.chartType===r.CT_ChartType.CT_Bar3DChart;if(b.isNullOrUndefined(t.grouping))return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered3D:r.ChartType.columnClustered3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered:r.ChartType.columnClustered;switch(t.grouping){case r.ST_BarGrouping.percentStacked:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked1003D:r.ChartType.columnStacked1003D:t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked100:r.ChartType.columnStacked100;case r.ST_BarGrouping.clustered:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered3D:r.ChartType.columnClustered3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered:r.ChartType.columnClustered;case r.ST_BarGrouping.standard:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered3D:r.ChartType.column3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered:r.ChartType.columnClustered;case r.ST_BarGrouping.stacked:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked3D:r.ChartType.columnStacked3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked:r.ChartType.columnStacked}return r.ChartType.columnClustered},t.GetChartTypeByAreaChart=function(t){var e=t.chartType===r.CT_ChartType.CT_Area3DChart;if(b.isNullOrUndefined(t.grouping))return e?r.ChartType.area3D:r.ChartType.area;switch(t.grouping){case r.ST_Grouping.percentStacked:return e?r.ChartType.areaStacked1003D:r.ChartType.areaStacked100;case r.ST_Grouping.standard:return e?r.ChartType.area3D:r.ChartType.area;case r.ST_Grouping.stacked:return e?r.ChartType.areaStacked3D:r.ChartType.areaStacked}return r.ChartType.area},t.GetChartTypeByLineChart=function(t,e){var o=t.chartType===r.CT_ChartType.CT_Line3DChart,n=t.marker;if(b.isNullOrUndefined(t.grouping)){if(o)return r.ChartType.line3D}else switch(t.grouping){case r.ST_Grouping.percentStacked:return o?r.ChartType.line3D:n?r.ChartType.lineMarkersStacked100:r.ChartType.lineStacked100;case r.ST_Grouping.standard:return o?r.ChartType.line3D:n?r.ChartType.lineMarkers:r.ChartType.line;case r.ST_Grouping.stacked:return o?r.ChartType.line3D:n?r.ChartType.lineMarkersStacked:r.ChartType.lineStacked;default:return r.ChartType.area}return n?r.ChartType.lineMarkers:r.ChartType.line},t.GetChartTypeByPieChart=function(t){return t.chartType===r.CT_ChartType.CT_PieChart?r.ChartType.pie:t.chartType===r.CT_ChartType.CT_Pie3DChart?r.ChartType.pie3D:t.chartType===r.CT_ChartType.CT_OfPieChart?t.ofPieType===r.ST_OfPieType.bar?r.ChartType.barOfPie:r.ChartType.pieOfPie:t.chartType===r.CT_ChartType.CT_DoughnutChart?r.ChartType.doughnut:r.ChartType.pie},t.GetChartTypeByRadarChart=function(t,e){var o=e&&e.marker&&e.marker.symbol&&e.marker.symbol===r.MarkerStyle.MarkerStyleNone;if(!b.isNullOrUndefined(t.radarStyle))switch(t.radarStyle){case r.ST_RadarStyle.standard:case r.ST_RadarStyle.marker:return o?r.ChartType.radar:r.ChartType.radarMarkers;case r.ST_RadarStyle.filled:return r.ChartType.radarFilled}return 2},t.GetChartTypeByScatterChart=function(t,e){var o,n,i,a,s,l,u=t.scatterStyle;return b.isNullOrUndefined(u)?r.ChartType.xyScatter:(o={0:1,1:36,2:35,3:r.ChartType.xyScatter,4:34,5:33},n=u,a=4===((i=e||t.ser[0])&&i.marker&&i.marker.symbol),l=(s=i&&i.spPr&&i.spPr.ln)&&s.noFill,2===n?l?n=3:a&&(n=1):5===n&&a&&(n=4),o[n])},t.GetChartTypeByBubbleChart=function(t){return t.bubble3D?r.ChartType.bubble3DEffect:r.ChartType.bubble},t.GetChartTypeBySurfaceChart=function(t){return t.chartType===r.CT_ChartType.CT_Surface3DChart?t.wireframe?r.ChartType.surfaceWireframe:r.ChartType.surface:t.wireframe?r.ChartType.surfaceTopViewWireframe:r.ChartType.surfaceTopView},t.GetTextFieldTypeString=function(t){return{0:e.ChartConstants.FIELD_TYPE_CELLRANGE,1:e.ChartConstants.FIELD_TYPE_SERIESNAME,2:e.ChartConstants.FIELD_TYPE_CATEGORYNAME,3:e.ChartConstants.FIELD_TYPE_VALUE,4:e.ChartConstants.FIELD_TYPE_XVALUE,5:e.ChartConstants.FIELD_TYPE_YVALUE,6:e.ChartConstants.FIELD_TYPE_BUBBLESIZE,7:e.ChartConstants.FIELD_TYPE_PERCENTAGE,8:e.ChartConstants.FIELD_TYPE_TXLINK}[t]||""},t.GetTextFieldTypeText=function(t){return{0:e.ChartConstants.FIELD_TEXT_CELLRANGE,1:e.ChartConstants.FIELD_TEXT_SERIESNAME,2:e.ChartConstants.FIELD_TEXT_CATEGORYNAME,3:e.ChartConstants.FIELD_TEXT_VALUE,4:e.ChartConstants.FIELD_TEXT_XVALUE,5:e.ChartConstants.FIELD_TEXT_YVALUE,6:e.ChartConstants.FIELD_TEXT_BUBBLESIZE}[t]||""},t.GetTextFieldType=function(t){var o=r.TextFieldType.CellRange;switch(t){case e.ChartConstants.FIELD_TYPE_CELLRANGE:o=r.TextFieldType.CellRange;break;case e.ChartConstants.FIELD_TYPE_SERIESNAME:o=r.TextFieldType.SeriesName;break;case e.ChartConstants.FIELD_TYPE_CATEGORYNAME:o=r.TextFieldType.CategoryName;break;case e.ChartConstants.FIELD_TYPE_VALUE:o=r.TextFieldType.Value;break;case e.ChartConstants.FIELD_TYPE_XVALUE:o=r.TextFieldType.XValue;break;case e.ChartConstants.FIELD_TYPE_YVALUE:o=r.TextFieldType.YValue;break;case e.ChartConstants.FIELD_TYPE_BUBBLESIZE:o=r.TextFieldType.BubbleSize;break;case e.ChartConstants.FIELD_TYPE_PERCENTAGE:o=r.TextFieldType.Percentage;break;case e.ChartConstants.FIELD_TYPE_TXLINK:o=r.TextFieldType.TxLink}return o},t.GetPrimaryPieChart=function(t){return t[0]},t.GetPlotAreaCharts=function(t,e){return t.chartGroups?t.chartGroups.filter((function(t){return t.chartType===e})):[]},t.GetAreaChart=function(e){return t.GetPlotAreaCharts(e,4)},t.GetArea3DChart=function(e){var o=t.GetPlotAreaCharts(e,5);return o.length>0?o[0]:u},t.GetBarChart=function(e){return t.GetPlotAreaCharts(e,6)},t.GetBar3DChart=function(e){var o=t.GetPlotAreaCharts(e,7);return o.length>0?o[0]:u},t.GetLineChart=function(e){return t.GetPlotAreaCharts(e,8)},t.GetLine3DChart=function(e){var o=t.GetPlotAreaCharts(e,9);return o.length>0?o[0]:u},t.GetStockChart=function(e){return t.GetPlotAreaCharts(e,0)},t.GetRadarChart=function(e){return t.GetPlotAreaCharts(e,2)},t.GetScatterChart=function(e){return t.GetPlotAreaCharts(e,1)},t.GetPieCharts=function(t){var e=[10,11,12,13];return t.chartGroups?t.chartGroups.filter((function(t){return e.indexOf(t.chartType)>=0})):[]},t.GetPieChart=function(e){return t.GetPlotAreaCharts(e,10)},t.GetPie3DChart=function(e){var o=t.GetPlotAreaCharts(e,11);return o.length>0?o[0]:u},t.GetDoughnutChart=function(e){return t.GetPlotAreaCharts(e,12)},t.GetOfPieChart=function(e){return t.GetPlotAreaCharts(e,13)},t.GetSurfaceChart=function(e){return t.GetSurface3DChartOrChart(e,14)},t.GetSurface3DChart=function(e){return t.GetSurface3DChartOrChart(e,15)},t.GetSurface3DChartOrChart=function(e,o){var n=t.GetPlotAreaCharts(e,o);return n.length>0?n[0]:u},t.GetBubbleChart=function(e){return t.GetPlotAreaCharts(e,3)},t.GetAxes=function(t,e){return t.axes.filter((function(t){return t.axisType===e}))},t.removeEmptyArrayProperties=function(t){var e,o;for(e in t)t.hasOwnProperty(e)&&(o=t[e],Array.isArray(o)&&0===o.length&&delete t[e])},t.allSeriesIsScatterOrBubble=function(e){var o,n,r,i,a=e.ChartType;if(t.IsBubbleChart(a)||t.IsScatterChart(a))return!0;if(0===a&&(n=(o=e.SeriesCollection.AllSers).length)>0){if(r=o[0].ChartType,i=void 0,t.IsBubbleChart(r)){for(i=1;i<n;i++)if(!t.IsBubbleChart(o[i].ChartType))return!1;return!0}if(t.IsScatterChart(r)){for(i=1;i<n;i++)if(!t.IsScatterChart(o[i].ChartType))return!1;return!0}}return!1},t.getLineFormatInfo=function(e,o,n,r,i){var s,l,c,f=e&&e.Format&&e.Format.Line;return f?(l={},(s=f.Weight)>=0&&(l.width=s),c=t.colorFormatToString(f,o,n,r),n||(l.transparency=t.getTransparencyFromColorFormat(f,i)),(c||""===c&&r)&&(l.color=c),a.isNullOrUndefined(f.DashStyle)||(l.dashStyle=f.DashStyle),l):u},t.isSupportConnectedLineChartType=function(t){return t===r.ChartType.line||t===r.ChartType.lineMarkers||t===r.ChartType.xyScatterLines||t===r.ChartType.xyScatterLinesNoMarkers||t===r.ChartType.xyScatterSmooth||t===r.ChartType.xyScatterSmoothNoMarkers},t.isSupportConnected=function(e,o){var n,r,i;if(t.isSupportConnectedLineChartType(e)||t.IsRadarChart(e))return!0;if(0===e)for(n=o.SeriesCollection.AllSers,r=0;r<n.length;r++)if(i=n[r].ChartType,t.isSupportConnectedLineChartType(i)||t.IsRadarChart(i))return!0;return!1},t.isSupportGaps=function(t){return t!==r.ChartType.sunburst&&t!==r.ChartType.treemap&&t!==r.ChartType.lineMarkersStacked&&t!==r.ChartType.lineMarkersStacked100&&t!==r.ChartType.lineStacked&&t!==r.ChartType.lineStacked100},t.IsDatesOrTimesNumberFormat=function(e){var o,n,r,i,a,s,l,c;if(!e||0===e.length)return!1;if("["===(e=e.toUpperCase().trim())[0]){if(-1===(o=e.indexOf("]"))||o===e.length-1)return!1;e=e.substr(o+1)}for(n=-1,r=0,i=!1,a=u,s=0;s<e.length;s++){if("["===(c=e[s]))do{c=e[s],s++}while(s<e.length&&"]"!==c);if("Y"===c||"D"===c||"M"===c||"H"===c||"S"===c)i?r++:0!==s&&"\\"===e[s-1]||(i=!0,n=s,r=1);else{if(i=!1," "===c&&a)return!0;0!==r&&(l=e.substr(n,r),n=s,r=0,a=(b.isNullOrUndefined(a)||a)&&t.IsValidDateOrTimeFormatPattern(l))}}return 0!==r&&s===e.length&&(l=e.substr(n,r),a=(b.isNullOrUndefined(a)||a)&&t.IsValidDateOrTimeFormatPattern(l)),a},t.IsValidDateOrTimeFormatPattern=function(t){var e,o,n,r,i,a={Y:4,D:4,M:5,H:2,S:2};if(!t)return!1;for(e={},o=0;o<t.length;o++)e[n=t[o]]?e[n]=e[n]+1:e[n]=1;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(i=a[r]))return!1;if(e[r]>i)return!1}return!0},t.presetColors={},t.defineProperty=F,t.simpleJSONObject=j,t.umb=L,t}(),e.ChartUtility=R,R.InitPresetColors(),M=function(){function t(){}return t.InitGradientStopPresetColor=function(t,e){},t.InitGradientStopTwoColor=function(t,e){},t.InitGradientTwoColorCornerStops=function(t,e){},t.InitGradientTwoColorCenterStops=function(t,e){},t.InitGradientOneColorCornerStops=function(t,e){},t.InitGradientOneColorCenterStops=function(t,e){},t.InitGradientStopOneColor=function(t,e){},t.InitGradientStops=function(t,e,o){},t.GetGradientAngle=function(t,e){var o=0;switch(t){case r.GradientStyle.GradientHorizontal:1===e?o=90:2===e||4===e?o=270:3===e&&(o=90);break;case r.GradientStyle.GradientVertical:1===e||3===e?o=0:2!==e&&4!==e||(o=180);break;case r.GradientStyle.GradientDiagonalUp:1===e||3===e?o=45:2!==e&&4!==e||(o=225);break;case r.GradientStyle.GradientDiagonalDown:1===e||3===e?o=135:2!==e&&4!==e||(o=315);break;case r.GradientStyle.GradientFromCorner:case r.GradientStyle.GradientFromCenter:o=135}return o},t.GetTintAndShadeByDegree=function(t){return 2*(t-.5)},t.ToLum=function(t){return 1e5-p(2e5*(1-t))},t.FromLum=function(t){return 1-(1e5-t)/2e5},t}(),e.ShapeUtility=M,k=function(){function t(){}return t.CalculateValidMinimum=function(t,e,o,n,r,i){return o?t===v.DOUBLE_MAX_VALUE||t<=0?e===v.DOUBLE_MIN_VALUE||e<=0?t=1:e<1?t=e/n:1===e?t=1/n:1<e&&(t=1):e<=t?e===v.DOUBLE_MIN_VALUE||e<=0||(e<1&&r&&!i?t=e/n:1===e&&r&&!i?t=1/n:1<e&&(r||!i)&&(t=1)):r&&(t=1):t===v.DOUBLE_MAX_VALUE?e===v.DOUBLE_MIN_VALUE?t=0:e<0?t=2*e:0===e?t=-1:0<e&&(t=0):e<=t&&(e===v.DOUBLE_MIN_VALUE||(e<0&&r&&!i?e!==t&&(t=2*e):0===e&&r&&!i?t=-1:0<e&&(r||!i)&&(t=0))),t},t.CalculateValidMaximum=function(t,e,o,n){return o?e<=t&&(t<1?e=1:1===t?e=n:1<t&&(e=t*n)):e<=t&&(t<0?e=0:0===t?e=1:0<t&&e!==t&&(e=2*t)),e},t.calcMinMax=function(t,e,o,n){var r,i,a=e-t,s=.05*a,l=n.ChartType;return o?(r=t,i=e,e<1&&(r=i=1)):t>=0?(i=e,B(n)&&(i+=s),6*a>e?r=0:(r=t-a/2,(R.IsScatterChart(l)||R.IsBubbleChart(l))&&(r=t))):e<=0?(r=t,B(n)&&(r-=s),6*a+t>0?i=0:(i=e+a/2,(R.IsScatterChart(l)||R.IsBubbleChart(l))&&(i=e))):(r=t-s,i=e+s),{Min:r,Max:i}},t.CalculateMinimum2=function(t,e,o,n,r){return n?g(r,p(v.log(t,r))):p(t/o)*o},t.Gpa={},t.CalculateMaximum2=function(t,e,o,n,r){return n?g(r,m(v.log(e,r))):m(e/o)*o},t.CalculateMajorUnit=function(t,e,o,n,r,i){var a,s=y(e-t);return r?a=i:(s/(a=g(10,p(v.log(s,10))))<=1.6?a/=5:s/a<=4?a/=2:s/a>8&&(a*=2),o||(a=f(a,n))),a},t.CalculateMinorUnit=function(t,e,o,n){return n?o:o/5},t.GenerateAxisId=function(){for(var t=0;;)if(t=p(9e7*Math.random())+1e7,!this.Gpa[t]){this.Gpa[t]=!0;break}return t},t}(),e.AxisUtility=k,N=function(){function t(){}return Object.defineProperty(t.prototype,"ChartFormat",{get:function(){return b.isNullOrUndefined(this.Kb)&&(this.Kb=this.GetDefaultFormat()),this.Kb},enumerable:!0,configurable:!0}),t.prototype.CreateFormat=function(){return u},t.prototype.GetDefaultFormat=function(){return this.CreateFormat()},t.prototype.GetFormatInternal=function(){return this.Kb},t.prototype.FromShapeProperties=function(t){var e=this;b.isNullOrUndefined(t)?e.ClearFormat():(b.isNullOrUndefined(e.Kb)&&(e.Kb=e.CreateFormat()),e.Kb.FromOOModel(t))},t.prototype.ToShapeProperties=function(){return b.isNullOrUndefined(this.Kb)?u:this.Kb.ToOOModel()},t.prototype.Delete=function(){b.isNullOrUndefined(this.Kb)||(this.Kb.ParentStateful=u)},t.prototype.ClearFormat=function(){var t=this;b.isNullOrUndefined(t.Kb)||(t.Kb.SetParentForChildren(u),t.Kb.ParentStateful=u,t.Kb=u)},t}(),e.ChartElementBase=N,function(t){t[t.BevelNone=0]="BevelNone",t[t.BevelRelaxedInset=1]="BevelRelaxedInset",t[t.BevelCircle=2]="BevelCircle",t[t.BevelSlope=3]="BevelSlope",t[t.BevelCross=4]="BevelCross",t[t.BevelAngle=5]="BevelAngle",t[t.BevelSoftRound=6]="BevelSoftRound",t[t.BevelConvex=7]="BevelConvex",t[t.BevelCoolSlant=8]="BevelCoolSlant",t[t.BevelDivot=9]="BevelDivot",t[t.BevelRiblet=10]="BevelRiblet",t[t.BevelHardEdge=11]="BevelHardEdge",t[t.BevelArtDeco=12]="BevelArtDeco"}(e.BevelType||(e.BevelType={})),function(t){t[t.UnKnown=0]="UnKnown",t[t.Area3DGroup=1]="Area3DGroup",t[t.Bar3DGroup=2]="Bar3DGroup",t[t.Column3DGroup=3]="Column3DGroup",t[t.Line3DGroup=4]="Line3DGroup",t[t.Pie3DGroup=5]="Pie3DGroup",t[t.SurfaceGroup=6]="SurfaceGroup",t[t.AreaGroup=7]="AreaGroup",t[t.BarGroup=8]="BarGroup",t[t.ColumnGroup=9]="ColumnGroup",t[t.DoughnutGroup=10]="DoughnutGroup",t[t.LineGroup=11]="LineGroup",t[t.PieGroup=12]="PieGroup",t[t.RadarGroup=13]="RadarGroup",t[t.XYGroup=14]="XYGroup"}(O=e.ChartGroupType||(e.ChartGroupType={}))},"./dist/plugins/floatingObject/drawing/drawingInterface.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.noStrike=0]="noStrike",t[t.sngStrike=1]="sngStrike",t[t.dblStrike=2]="dblStrike"}(e.ST_TextStrikeType||(e.ST_TextStrikeType={})),function(t){t[t.rnd=0]="rnd",t[t.sq=1]="sq",t[t.flat=2]="flat"}(e.ST_LineCap||(e.ST_LineCap={})),function(t){t[t.email=0]="email",t[t.screen=1]="screen",t[t.print=2]="print",t[t.hqprint=3]="hqprint",t[t.none=4]="none"}(e.ST_BlipCompression||(e.ST_BlipCompression={})),function(t){t[t.shape=0]="shape",t[t.circle=1]="circle",t[t.rect=2]="rect"}(e.ST_PathShadeType||(e.ST_PathShadeType={})),function(t){t[t.legacyMatte=0]="legacyMatte",t[t.legacyPlastic=1]="legacyPlastic",t[t.legacyMetal=2]="legacyMetal",t[t.legacyWireframe=3]="legacyWireframe",t[t.matte=4]="matte",t[t.plastic=5]="plastic",t[t.metal=6]="metal",t[t.warmMatte=7]="warmMatte",t[t.translucentPowder=8]="translucentPowder",t[t.powder=9]="powder",t[t.dkEdge=10]="dkEdge",t[t.softEdge=11]="softEdge",t[t.clear=12]="clear",t[t.flat=13]="flat",t[t.softmetal=14]="softmetal"}(e.ST_PresetMaterialType||(e.ST_PresetMaterialType={})),function(t){t[t.maxMin=0]="maxMin",t[t.minMax=1]="minMax"}(e.ST_Orientation||(e.ST_Orientation={})),function(t){t[t.between=0]="between",t[t.midCat=1]="midCat"}(e.ST_CrossBetween||(e.ST_CrossBetween={})),function(t){t[t.TwoCellAnchor=0]="TwoCellAnchor",t[t.OneCellAnchor=1]="OneCellAnchor",t[t.AbsoluteAnchor=2]="AbsoluteAnchor",t[t.RelSizeAnchor=3]="RelSizeAnchor",t[t.AbsSizeAnchor=4]="AbsSizeAnchor"}(e.AnchorType||(e.AnchorType={})),function(t){t[t.SolidColorFillProperties=0]="SolidColorFillProperties",t[t.PatternFillProperties=1]="PatternFillProperties",t[t.GradientFillProperties=2]="GradientFillProperties",t[t.BlipFillProperties=3]="BlipFillProperties",t[t.GroupFillProperties=4]="GroupFillProperties",t[t.NoFillProperties=5]="NoFillProperties"}(e.ColorFillType||(e.ColorFillType={})),function(t){t[t.CT_StockChart=0]="CT_StockChart",t[t.CT_ScatterChart=1]="CT_ScatterChart",t[t.CT_RadarChart=2]="CT_RadarChart",t[t.CT_BubbleChart=3]="CT_BubbleChart",t[t.CT_AreaChart=4]="CT_AreaChart",t[t.CT_Area3DChart=5]="CT_Area3DChart",t[t.CT_BarChart=6]="CT_BarChart",t[t.CT_Bar3DChart=7]="CT_Bar3DChart",t[t.CT_LineChart=8]="CT_LineChart",t[t.CT_Line3DChart=9]="CT_Line3DChart",t[t.CT_PieChart=10]="CT_PieChart",t[t.CT_Pie3DChart=11]="CT_Pie3DChart",t[t.CT_DoughnutChart=12]="CT_DoughnutChart",t[t.CT_OfPieChart=13]="CT_OfPieChart",t[t.CT_SurfaceChart=14]="CT_SurfaceChart",t[t.CT_Surface3DChart=15]="CT_Surface3DChart",t[t.CT_BoxWhisker=16]="CT_BoxWhisker",t[t.CT_Funnel=17]="CT_Funnel",t[t.CT_ParetoLine=18]="CT_ParetoLine",t[t.CT_RegionMap=19]="CT_RegionMap",t[t.CT_Sunburst=20]="CT_Sunburst",t[t.CT_Treemap=21]="CT_Treemap",t[t.CT_Waterfall=22]="CT_Waterfall",t[t.CT_ClusteredColumn=23]="CT_ClusteredColumn"}(e.CT_ChartType||(e.CT_ChartType={})),function(t){t[t.CT_CatAx=0]="CT_CatAx",t[t.CT_DateAx=1]="CT_DateAx",t[t.CT_SerAx=2]="CT_SerAx",t[t.CT_ValAx=3]="CT_ValAx"}(e.CT_AxisType||(e.CT_AxisType={})),function(t){t[t.CT_HiddenScene3dExtension=0]="CT_HiddenScene3dExtension",t[t.CT_HiddenFillPropertiesExtension=1]="CT_HiddenFillPropertiesExtension",t[t.CT_HiddenLinePropertiesBaseExtension=2]="CT_HiddenLinePropertiesBaseExtension",t[t.CT_HiddenShape3dExtension=3]="CT_HiddenShape3dExtension",t[t.CT_OfficeArtExtension=4]="CT_OfficeArtExtension"}(e.CT_HiddenExtensionType||(e.CT_HiddenExtensionType={})),function(t){t[t.major=0]="major",t[t.minor=1]="minor",t[t.none=2]="none"}(e.ST_FontCollectionIndex||(e.ST_FontCollectionIndex={})),function(t){t[t.aliceBlue=0]="aliceBlue",t[t.antiqueWhite=1]="antiqueWhite",t[t.aqua=2]="aqua",t[t.aquamarine=3]="aquamarine",t[t.azure=4]="azure",t[t.beige=5]="beige",t[t.bisque=6]="bisque",t[t.black=7]="black",t[t.blanchedAlmond=8]="blanchedAlmond",t[t.blue=9]="blue",t[t.blueViolet=10]="blueViolet",t[t.brown=11]="brown",t[t.burlyWood=12]="burlyWood",t[t.cadetBlue=13]="cadetBlue",t[t.chartreuse=14]="chartreuse",t[t.chocolate=15]="chocolate",t[t.coral=16]="coral",t[t.cornflowerBlue=17]="cornflowerBlue",t[t.cornsilk=18]="cornsilk",t[t.crimson=19]="crimson",t[t.cyan=20]="cyan",t[t.darkBlue=21]="darkBlue",t[t.darkCyan=22]="darkCyan",t[t.darkGoldenrod=23]="darkGoldenrod",t[t.darkGray=24]="darkGray",t[t.darkGreen=25]="darkGreen",t[t.darkGrey=26]="darkGrey",t[t.darkKhaki=27]="darkKhaki",t[t.darkMagenta=28]="darkMagenta",t[t.darkOliveGreen=29]="darkOliveGreen",t[t.darkOrange=30]="darkOrange",t[t.darkOrchid=31]="darkOrchid",t[t.darkRed=32]="darkRed",t[t.darkSalmon=33]="darkSalmon",t[t.darkSeaGreen=34]="darkSeaGreen",t[t.darkSlateBlue=35]="darkSlateBlue",t[t.darkSlateGray=36]="darkSlateGray",t[t.darkSlateGrey=37]="darkSlateGrey",t[t.darkTurquoise=38]="darkTurquoise",t[t.darkViolet=39]="darkViolet",t[t.deepPink=40]="deepPink",t[t.deepSkyBlue=41]="deepSkyBlue",t[t.dimGray=42]="dimGray",t[t.dimGrey=43]="dimGrey",t[t.dkBlue=44]="dkBlue",t[t.dkCyan=45]="dkCyan",t[t.dkGoldenrod=46]="dkGoldenrod",t[t.dkGray=47]="dkGray",t[t.dkGreen=48]="dkGreen",t[t.dkGrey=49]="dkGrey",t[t.dkKhaki=50]="dkKhaki",t[t.dkMagenta=51]="dkMagenta",t[t.dkOliveGreen=52]="dkOliveGreen",t[t.dkOrange=53]="dkOrange",t[t.dkOrchid=54]="dkOrchid",t[t.dkRed=55]="dkRed",t[t.dkSalmon=56]="dkSalmon",t[t.dkSeaGreen=57]="dkSeaGreen",t[t.dkSlateBlue=58]="dkSlateBlue",t[t.dkSlateGray=59]="dkSlateGray",t[t.dkSlateGrey=60]="dkSlateGrey",t[t.dkTurquoise=61]="dkTurquoise",t[t.dkViolet=62]="dkViolet",t[t.dodgerBlue=63]="dodgerBlue",t[t.firebrick=64]="firebrick",t[t.floralWhite=65]="floralWhite",t[t.forestGreen=66]="forestGreen",t[t.fuchsia=67]="fuchsia",t[t.gainsboro=68]="gainsboro",t[t.ghostWhite=69]="ghostWhite",t[t.gold=70]="gold",t[t.goldenrod=71]="goldenrod",t[t.gray=72]="gray",t[t.green=73]="green",t[t.greenYellow=74]="greenYellow",t[t.grey=75]="grey",t[t.honeydew=76]="honeydew",t[t.hotPink=77]="hotPink",t[t.indianRed=78]="indianRed",t[t.indigo=79]="indigo",t[t.ivory=80]="ivory",t[t.khaki=81]="khaki",t[t.lavender=82]="lavender",t[t.lavenderBlush=83]="lavenderBlush",t[t.lawnGreen=84]="lawnGreen",t[t.lemonChiffon=85]="lemonChiffon",t[t.lightBlue=86]="lightBlue",t[t.lightCoral=87]="lightCoral",t[t.lightCyan=88]="lightCyan",t[t.lightGoldenrodYellow=89]="lightGoldenrodYellow",t[t.lightGray=90]="lightGray",t[t.lightGreen=91]="lightGreen",t[t.lightGrey=92]="lightGrey",t[t.lightPink=93]="lightPink",t[t.lightSalmon=94]="lightSalmon",t[t.lightSeaGreen=95]="lightSeaGreen",t[t.lightSkyBlue=96]="lightSkyBlue",t[t.lightSlateGray=97]="lightSlateGray",t[t.lightSlateGrey=98]="lightSlateGrey",t[t.lightSteelBlue=99]="lightSteelBlue",t[t.lightYellow=100]="lightYellow",t[t.lime=101]="lime",t[t.limeGreen=102]="limeGreen",t[t.linen=103]="linen",t[t.ltBlue=104]="ltBlue",t[t.ltCoral=105]="ltCoral",t[t.ltCyan=106]="ltCyan",t[t.ltGoldenrodYellow=107]="ltGoldenrodYellow",t[t.ltGray=108]="ltGray",t[t.ltGreen=109]="ltGreen",t[t.ltGrey=110]="ltGrey",t[t.ltPink=111]="ltPink",t[t.ltSalmon=112]="ltSalmon",t[t.ltSeaGreen=113]="ltSeaGreen",t[t.ltSkyBlue=114]="ltSkyBlue",t[t.ltSlateGray=115]="ltSlateGray",t[t.ltSlateGrey=116]="ltSlateGrey",t[t.ltSteelBlue=117]="ltSteelBlue",t[t.ltYellow=118]="ltYellow",t[t.magenta=119]="magenta",t[t.maroon=120]="maroon",t[t.medAquamarine=121]="medAquamarine",t[t.medBlue=122]="medBlue",t[t.mediumAquamarine=123]="mediumAquamarine",t[t.mediumBlue=124]="mediumBlue",t[t.mediumOrchid=125]="mediumOrchid",t[t.mediumPurple=126]="mediumPurple",t[t.mediumSeaGreen=127]="mediumSeaGreen",t[t.mediumSlateBlue=128]="mediumSlateBlue",t[t.mediumSpringGreen=129]="mediumSpringGreen",t[t.mediumTurquoise=130]="mediumTurquoise",t[t.mediumVioletRed=131]="mediumVioletRed",t[t.medOrchid=132]="medOrchid",t[t.medPurple=133]="medPurple",t[t.medSeaGreen=134]="medSeaGreen",t[t.medSlateBlue=135]="medSlateBlue",t[t.medSpringGreen=136]="medSpringGreen",t[t.medTurquoise=137]="medTurquoise",t[t.medVioletRed=138]="medVioletRed",t[t.midnightBlue=139]="midnightBlue",t[t.mintCream=140]="mintCream",t[t.mistyRose=141]="mistyRose",t[t.moccasin=142]="moccasin",t[t.navajoWhite=143]="navajoWhite",t[t.navy=144]="navy",t[t.oldLace=145]="oldLace",t[t.olive=146]="olive",t[t.oliveDrab=147]="oliveDrab",t[t.orange=148]="orange",t[t.orangeRed=149]="orangeRed",t[t.orchid=150]="orchid",t[t.paleGoldenrod=151]="paleGoldenrod",t[t.paleGreen=152]="paleGreen",t[t.paleTurquoise=153]="paleTurquoise",t[t.paleVioletRed=154]="paleVioletRed",t[t.papayaWhip=155]="papayaWhip",t[t.peachPuff=156]="peachPuff",t[t.peru=157]="peru",t[t.pink=158]="pink",t[t.plum=159]="plum",t[t.powderBlue=160]="powderBlue",t[t.purple=161]="purple",t[t.red=162]="red",t[t.rosyBrown=163]="rosyBrown",t[t.royalBlue=164]="royalBlue",t[t.saddleBrown=165]="saddleBrown",t[t.salmon=166]="salmon",t[t.sandyBrown=167]="sandyBrown",t[t.seaGreen=168]="seaGreen",t[t.seaShell=169]="seaShell",t[t.sienna=170]="sienna",t[t.silver=171]="silver",t[t.skyBlue=172]="skyBlue",t[t.slateBlue=173]="slateBlue",t[t.slateGray=174]="slateGray",t[t.slateGrey=175]="slateGrey",t[t.snow=176]="snow",t[t.springGreen=177]="springGreen",t[t.steelBlue=178]="steelBlue",t[t.tan=179]="tan",t[t.teal=180]="teal",t[t.thistle=181]="thistle",t[t.tomato=182]="tomato",t[t.turquoise=183]="turquoise",t[t.violet=184]="violet",t[t.wheat=185]="wheat",t[t.white=186]="white",t[t.whiteSmoke=187]="whiteSmoke",t[t.yellow=188]="yellow",t[t.yellowGreen=189]="yellowGreen"}(e.ST_PresetColorVal||(e.ST_PresetColorVal={})),function(t){t[t.percentStacked=0]="percentStacked",t[t.standard=1]="standard",t[t.stacked=2]="stacked"}(e.ST_Grouping||(e.ST_Grouping={})),function(t){t[t.none=0]="none",t[t.line=1]="line",t[t.lineMarker=2]="lineMarker",t[t.marker=3]="marker",t[t.smooth=4]="smooth",t[t.smoothMarker=5]="smoothMarker"}(e.ST_ScatterStyle||(e.ST_ScatterStyle={})),function(t){t[t.standard=0]="standard",t[t.marker=1]="marker",t[t.filled=2]="filled"}(e.ST_RadarStyle||(e.ST_RadarStyle={})),function(t){t[t.percentStacked=0]="percentStacked",t[t.clustered=1]="clustered",t[t.standard=2]="standard",t[t.stacked=3]="stacked"}(e.ST_BarGrouping||(e.ST_BarGrouping={})),function(t){t[t.bar=0]="bar",t[t.col=1]="col"}(e.ST_BarDir||(e.ST_BarDir={})),function(t){t[t.pie=0]="pie",t[t.bar=1]="bar"}(e.ST_OfPieType||(e.ST_OfPieType={})),function(t){t[t.b=0]="b",t[t.l=1]="l",t[t.r=2]="r",t[t.t=3]="t"}(e.ST_AxPos||(e.ST_AxPos={})),function(t){t[t.OuterShadowEffect=0]="OuterShadowEffect",t[t.InnerShadowEffect=1]="InnerShadowEffect",t[t.PresetShadowEffect=2]="PresetShadowEffect"}(e.ShadowEffectType||(e.ShadowEffectType={})),function(t){t[t.BarSer=0]="BarSer",t[t.AreaSer=1]="AreaSer",t[t.LineSer=2]="LineSer",t[t.PieSer=3]="PieSer",t[t.RadarSer=4]="RadarSer",t[t.ScatterSer=5]="ScatterSer",t[t.BubbleSer=6]="BubbleSer",t[t.SurfaceSer=7]="SurfaceSer",t[t.boxWhisker=16]="boxWhisker",t[t.funnel=17]="funnel",t[t.paretoLine=18]="paretoLine",t[t.regionMap=19]="regionMap",t[t.sunburst=20]="sunburst",t[t.treemap=21]="treemap",t[t.waterfall=22]="waterfall",t[t.clusteredColumn=23]="clusteredColumn"}(e.SeriesType||(e.SeriesType={})),function(t){t[t.InvertSolidFillFmt=0]="InvertSolidFillFmt",t[t.SeriesDataLabelsRange=1]="SeriesDataLabelsRange",t[t.ChartDispNaAsBlank=2]="ChartDispNaAsBlank"}(e.ExtDataType||(e.ExtDataType={})),function(t){t[t.RegularTextRun=0]="RegularTextRun",t[t.TextLineBreak=1]="TextLineBreak",t[t.TextField=2]="TextField"}(e.TextParagraphElementType||(e.TextParagraphElementType={})),function(t){t[t.None=0]="None",t[t.Font=1]="Font",t[t.Fill=2]="Fill",t[t.Border=4]="Border",t[t.Alignment=8]="Alignment",t[t.Protection=16]="Protection",t[t.FormatCode=32]="FormatCode",t[t.All=63]="All"}(e.StyleDataFlag||(e.StyleDataFlag={})),function(t){t[t.None=-4142]="None",t[t.LT1=0]="LT1",t[t.DK1=1]="DK1",t[t.LT2=2]="LT2",t[t.DK2=3]="DK2",t[t.Accent1=4]="Accent1",t[t.Accent2=5]="Accent2",t[t.Accent3=6]="Accent3",t[t.Accent4=7]="Accent4",t[t.Accent5=8]="Accent5",t[t.Accent6=9]="Accent6",t[t.Hlink=10]="Hlink",t[t.FolHlink=11]="FolHlink"}(e.ColorSchemeIndex||(e.ColorSchemeIndex={})),function(t){t[t.None=0]="None",t[t.Major=1]="Major",t[t.Minor=2]="Minor"}(e.ThemeFont||(e.ThemeFont={})),function(t){t[t.Empty=0]="Empty",t[t.Row=1]="Row",t[t.Column=2]="Column",t[t.RowIsRelative=4]="RowIsRelative",t[t.ColumnIsRelative=8]="ColumnIsRelative",t[t.LastRowIsRelative=16]="LastRowIsRelative",t[t.LastColumnIsRelative=32]="LastColumnIsRelative",t[t.Range=64]="Range",t[t.Error=128]="Error"}(e.ReferenceKind||(e.ReferenceKind={})),function(t){t[t.Shape=0]="Shape",t[t.Chart=1]="Chart",t[t.Picture=2]="Picture",t[t.Connector=3]="Connector",t[t.GroupShape=4]="GroupShape"}(e.DrawingType||(e.DrawingType={})),function(t){t[t.TextureTopLeft=0]="TextureTopLeft",t[t.TextureTop=1]="TextureTop",t[t.TextureTopRight=2]="TextureTopRight",t[t.TextureLeft=3]="TextureLeft",t[t.TextureCenter=4]="TextureCenter",t[t.TextureRight=5]="TextureRight",t[t.TextureBottomLeft=6]="TextureBottomLeft",t[t.TextureBottom=7]="TextureBottom",t[t.TextureBottomRight=8]="TextureBottomRight"}(e.TextureAlignment||(e.TextureAlignment={})),function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Both=3]="Both"}(e.TextureFlipType||(e.TextureFlipType={})),function(t){t[t.TextureTypeNone=0]="TextureTypeNone",t[t.TexturePreset=1]="TexturePreset",t[t.TextureUserDefined=2]="TextureUserDefined"}(e.TextureType||(e.TextureType={})),function(t){t[t.Solid=0]="Solid",t[t.Patterned=1]="Patterned",t[t.Gradient=2]="Gradient",t[t.Textured=3]="Textured",t[t.Background=4]="Background",t[t.Picture=5]="Picture",t[t.Group=6]="Group"}(e.FillType||(e.FillType={})),function(t){t[t.GradientEarlySunset=0]="GradientEarlySunset",t[t.GradientLateSunset=1]="GradientLateSunset",t[t.GradientNightfall=2]="GradientNightfall",t[t.GradientDaybreak=3]="GradientDaybreak",t[t.GradientHorizon=4]="GradientHorizon",t[t.GradientDesert=5]="GradientDesert",t[t.GradientOcean=6]="GradientOcean",t[t.GradientCalmWater=7]="GradientCalmWater",t[t.GradientFire=8]="GradientFire",t[t.GradientFog=9]="GradientFog",t[t.GradientMoss=10]="GradientMoss",t[t.GradientPeacock=11]="GradientPeacock",t[t.GradientWheat=12]="GradientWheat",t[t.GradientParchment=13]="GradientParchment",t[t.GradientMahogany=14]="GradientMahogany",t[t.GradientRainbow=15]="GradientRainbow",t[t.GradientRainbowII=16]="GradientRainbowII",t[t.GradientGold=17]="GradientGold",t[t.GradientGoldII=18]="GradientGoldII",t[t.GradientBrass=19]="GradientBrass",t[t.GradientChrome=20]="GradientChrome",t[t.GradientChromeII=21]="GradientChromeII",t[t.GradientSilver=22]="GradientSilver",t[t.GradientSapphire=23]="GradientSapphire"}(e.PresetGradientType||(e.PresetGradientType={})),function(t){t[t.TexturePapyrus=0]="TexturePapyrus",t[t.TextureCanvas=1]="TextureCanvas",t[t.TextureDenim=2]="TextureDenim",t[t.TextureWovenMat=3]="TextureWovenMat",t[t.TextureWaterDroplets=4]="TextureWaterDroplets",t[t.TexturePaperBag=5]="TexturePaperBag",t[t.TextureFishFossil=6]="TextureFishFossil",t[t.TextureSand=7]="TextureSand",t[t.TextureGreenMarble=8]="TextureGreenMarble",t[t.TextureWhiteMarble=9]="TextureWhiteMarble",t[t.TextureBrownMarble=10]="TextureBrownMarble",t[t.TextureGranite=11]="TextureGranite",t[t.TextureNewsprint=12]="TextureNewsprint",t[t.TextureRecycledPaper=13]="TextureRecycledPaper",t[t.TextureParchment=14]="TextureParchment",t[t.TextureStationery=15]="TextureStationery",t[t.TextureBlueTissuePaper=16]="TextureBlueTissuePaper",t[t.TexturePinkTissuePaper=17]="TexturePinkTissuePaper",t[t.TexturePurpleMesh=18]="TexturePurpleMesh",t[t.TextureBouquet=19]="TextureBouquet",t[t.TextureCork=20]="TextureCork",t[t.TextureWalnut=21]="TextureWalnut",t[t.TextureOak=22]="TextureOak",t[t.TextureMediumWood=23]="TextureMediumWood"}(e.PresetTexture||(e.PresetTexture={})),function(t){t[t.GradientColorNone=0]="GradientColorNone",t[t.GradientOneColor=1]="GradientOneColor",t[t.GradientTwoColors=2]="GradientTwoColors",t[t.GradientPresetColors=3]="GradientPresetColors",t[t.GradientMultiColor=4]="GradientMultiColor"}(e.GradientColorType||(e.GradientColorType={})),function(t){t[t.none=0]="none",t[t.dottedPercent5=1]="dottedPercent5",t[t.dottedPercent10=2]="dottedPercent10",t[t.dottedPercent20=3]="dottedPercent20",t[t.dottedPercent25=4]="dottedPercent25",t[t.dottedPercent30=5]="dottedPercent30",t[t.dottedPercent40=6]="dottedPercent40",t[t.dottedPercent50=7]="dottedPercent50",t[t.dottedPercent60=8]="dottedPercent60",t[t.dottedPercent70=9]="dottedPercent70",t[t.dottedPercent75=10]="dottedPercent75",t[t.dottedPercent80=11]="dottedPercent80",t[t.dottedPercent90=12]="dottedPercent90",t[t.darkHorizontal=13]="darkHorizontal",t[t.darkVertical=14]="darkVertical",t[t.darkDownwardDiagonal=15]="darkDownwardDiagonal",t[t.darkUpwardDiagonal=16]="darkUpwardDiagonal",t[t.smallCheckerBoard=17]="smallCheckerBoard",t[t.trellis=18]="trellis",t[t.lightHorizontal=19]="lightHorizontal",t[t.lightVertical=20]="lightVertical",t[t.lightDownwardDiagonal=21]="lightDownwardDiagonal",t[t.lightUpwardDiagonal=22]="lightUpwardDiagonal",t[t.smallGrid=23]="smallGrid",t[t.dottedDiamond=24]="dottedDiamond",t[t.wideDownwardDiagonal=25]="wideDownwardDiagonal",t[t.wideUpwardDiagonal=26]="wideUpwardDiagonal",t[t.dashedUpwardDiagonal=27]="dashedUpwardDiagonal",t[t.dashedDownwardDiagonal=28]="dashedDownwardDiagonal",t[t.narrowVertical=29]="narrowVertical",t[t.narrowHorizontal=30]="narrowHorizontal",t[t.dashedVertical=31]="dashedVertical",t[t.dashedHorizontal=32]="dashedHorizontal",t[t.largeConfetti=33]="largeConfetti",t[t.largeGrid=34]="largeGrid",t[t.horizontalBrick=35]="horizontalBrick",t[t.largeCheckerBoard=36]="largeCheckerBoard",t[t.smallConfetti=37]="smallConfetti",t[t.zigZag=38]="zigZag",t[t.solidDiamond=39]="solidDiamond",t[t.diagonalBrick=40]="diagonalBrick",t[t.outlinedDiamond=41]="outlinedDiamond",t[t.plaid=42]="plaid",t[t.sphere=43]="sphere",t[t.weave=44]="weave",t[t.dottedGrid=45]="dottedGrid",t[t.divot=46]="divot",t[t.shingle=47]="shingle",t[t.wave=48]="wave"}(e.PatternType||(e.PatternType={})),function(t){t[t.GradientHorizontal=0]="GradientHorizontal",t[t.GradientVertical=1]="GradientVertical",t[t.GradientDiagonalUp=2]="GradientDiagonalUp",t[t.GradientDiagonalDown=3]="GradientDiagonalDown",t[t.GradientFromCorner=4]="GradientFromCorner",t[t.GradientFromTitle=5]="GradientFromTitle",t[t.GradientFromCenter=6]="GradientFromCenter",t[t.GradientTopSpotlight=7]="GradientTopSpotlight",t[t.GradientBottomSpotlight=8]="GradientBottomSpotlight"}(e.GradientStyle||(e.GradientStyle={})),function(t){t[t.short=0]="short",t[t.medium=1]="medium",t[t.long=2]="long"}(e.ArrowheadLength||(e.ArrowheadLength={})),function(t){t[t.none=0]="none",t[t.triangle=1]="triangle",t[t.stealth=2]="stealth",t[t.diamond=3]="diamond",t[t.oval=4]="oval",t[t.open=5]="open"}(e.ArrowheadStyle||(e.ArrowheadStyle={})),function(t){t[t.narrow=0]="narrow",t[t.medium=1]="medium",t[t.wide=2]="wide"}(e.ArrowheadWidth||(e.ArrowheadWidth={})),function(t){t[t.solid=0]="solid",t[t.squareDot=1]="squareDot",t[t.dash=2]="dash",t[t.longDash=3]="longDash",t[t.dashDot=4]="dashDot",t[t.longDashDot=5]="longDashDot",t[t.longDashDotDot=6]="longDashDotDot",t[t.sysDash=7]="sysDash",t[t.sysDot=8]="sysDot",t[t.sysDashDot=9]="sysDashDot",t[t.dashDotDot=10]="dashDotDot",t[t.roundDot=11]="roundDot"}(e.LineDashStyle||(e.LineDashStyle={})),function(t){t[t.flat=2]="flat",t[t.square=1]="square",t[t.round=0]="round"}(e.LineCapStyle||(e.LineCapStyle={})),function(t){t[t.round=0]="round",t[t.miter=1]="miter",t[t.bevel=2]="bevel"}(e.LineJoinStyle||(e.LineJoinStyle={})),function(t){t[t.LineSingle=0]="LineSingle",t[t.LineThinThin=1]="LineThinThin",t[t.LineThinThick=2]="LineThinThick",t[t.LineThickThin=3]="LineThickThin",t[t.LineThickBetweenThin=4]="LineThickBetweenThin"}(e.LineStyle||(e.LineStyle={})),function(t){t[t.PictureAutomatic=0]="PictureAutomatic",t[t.PictureGrayscale=1]="PictureGrayscale",t[t.PictureBlackAndWhite=2]="PictureBlackAndWhite",t[t.PictureWatermark=3]="PictureWatermark"}(e.PictureColorType||(e.PictureColorType={})),function(t){t[t.Shadow1=0]="Shadow1",t[t.Shadow2=1]="Shadow2",t[t.Shadow3=2]="Shadow3",t[t.Shadow4=3]="Shadow4",t[t.Shadow5=4]="Shadow5",t[t.Shadow6=5]="Shadow6",t[t.Shadow7=6]="Shadow7",t[t.Shadow8=7]="Shadow8",t[t.Shadow9=8]="Shadow9",t[t.Shadow10=9]="Shadow10",t[t.Shadow11=10]="Shadow11",t[t.Shadow12=11]="Shadow12",t[t.Shadow13=12]="Shadow13",t[t.Shadow14=13]="Shadow14",t[t.Shadow15=14]="Shadow15",t[t.Shadow16=15]="Shadow16",t[t.Shadow17=16]="Shadow17",t[t.Shadow18=17]="Shadow18",t[t.Shadow19=18]="Shadow19",t[t.Shadow20=19]="Shadow20",t[t.Shadow21=20]="Shadow21",t[t.Shadow22=21]="Shadow22",t[t.Shadow23=22]="Shadow23",t[t.Shadow24=23]="Shadow24",t[t.Shadow25=24]="Shadow25",t[t.Shadow26=25]="Shadow26",t[t.Shadow27=26]="Shadow27",t[t.Shadow28=27]="Shadow28",t[t.Shadow29=28]="Shadow29",t[t.Shadow30=29]="Shadow30",t[t.Shadow31=30]="Shadow31",t[t.Shadow32=31]="Shadow32",t[t.Shadow33=32]="Shadow33",t[t.Shadow34=33]="Shadow34",t[t.Shadow35=34]="Shadow35",t[t.Shadow36=35]="Shadow36",t[t.Shadow37=36]="Shadow37",t[t.Shadow38=37]="Shadow38",t[t.Shadow39=38]="Shadow39",t[t.Shadow40=39]="Shadow40",t[t.Shadow41=40]="Shadow41",t[t.Shadow42=41]="Shadow42",t[t.Shadow43=42]="Shadow43"}(e.ShadowType||(e.ShadowType={})),function(t){t[t.ShadowStyleInnerShadow=0]="ShadowStyleInnerShadow",t[t.ShadowStyleOuterShadow=1]="ShadowStyleOuterShadow"}(e.ShadowStyle||(e.ShadowStyle={})),function(t){t[t.SoftEdgeTypeNone=0]="SoftEdgeTypeNone",t[t.SoftEdgeType1=1]="SoftEdgeType1",t[t.SoftEdgeType2=2]="SoftEdgeType2",t[t.SoftEdgeType3=3]="SoftEdgeType3",t[t.SoftEdgeType4=4]="SoftEdgeType4",t[t.SoftEdgeType5=5]="SoftEdgeType5",t[t.SoftEdgeType6=6]="SoftEdgeType6"}(e.SoftEdgeType||(e.SoftEdgeType={})),function(t){t[t.CameraLegacyObliqueTopLeft=0]="CameraLegacyObliqueTopLeft",t[t.CameraLegacyObliqueTop=1]="CameraLegacyObliqueTop",t[t.CameraLegacyObliqueTopRight=2]="CameraLegacyObliqueTopRight",t[t.CameraLegacyObliqueLeft=3]="CameraLegacyObliqueLeft",t[t.CameraLegacyObliqueFront=4]="CameraLegacyObliqueFront",t[t.CameraLegacyObliqueRight=5]="CameraLegacyObliqueRight",t[t.CameraLegacyObliqueBottomLeft=6]="CameraLegacyObliqueBottomLeft",t[t.CameraLegacyObliqueBottom=7]="CameraLegacyObliqueBottom",t[t.CameraLegacyObliqueBottomRight=8]="CameraLegacyObliqueBottomRight",t[t.CameraLegacyPerspectiveTopLeft=9]="CameraLegacyPerspectiveTopLeft",t[t.CameraLegacyPerspectiveTop=10]="CameraLegacyPerspectiveTop",t[t.CameraLegacyPerspectiveTopRight=11]="CameraLegacyPerspectiveTopRight",t[t.CameraLegacyPerspectiveLeft=12]="CameraLegacyPerspectiveLeft",t[t.CameraLegacyPerspectiveFront=13]="CameraLegacyPerspectiveFront",t[t.CameraLegacyPerspectiveRight=14]="CameraLegacyPerspectiveRight",t[t.CameraLegacyPerspectiveBottomLeft=15]="CameraLegacyPerspectiveBottomLeft",t[t.CameraLegacyPerspectiveBottom=16]="CameraLegacyPerspectiveBottom",t[t.CameraLegacyPerspectiveBottomRight=17]="CameraLegacyPerspectiveBottomRight",t[t.CameraOrthographicFront=18]="CameraOrthographicFront",t[t.CameraIsometricTopUp=19]="CameraIsometricTopUp",t[t.CameraIsometricTopDown=20]="CameraIsometricTopDown",t[t.CameraIsometricBottomUp=21]="CameraIsometricBottomUp",t[t.CameraIsometricBottomDown=22]="CameraIsometricBottomDown",t[t.CameraIsometricLeftUp=23]="CameraIsometricLeftUp",t[t.CameraIsometricLeftDown=24]="CameraIsometricLeftDown",t[t.CameraIsometricRightUp=25]="CameraIsometricRightUp",t[t.CameraIsometricRightDown=26]="CameraIsometricRightDown",t[t.CameraIsometricOffAxis1Left=27]="CameraIsometricOffAxis1Left",t[t.CameraIsometricOffAxis1Right=28]="CameraIsometricOffAxis1Right",t[t.CameraIsometricOffAxis1Top=29]="CameraIsometricOffAxis1Top",t[t.CameraIsometricOffAxis2Left=30]="CameraIsometricOffAxis2Left",t[t.CameraIsometricOffAxis2Right=31]="CameraIsometricOffAxis2Right",t[t.CameraIsometricOffAxis2Top=32]="CameraIsometricOffAxis2Top",t[t.CameraIsometricOffAxis3Left=33]="CameraIsometricOffAxis3Left",t[t.CameraIsometricOffAxis3Right=34]="CameraIsometricOffAxis3Right",t[t.CameraIsometricOffAxis3Bottom=35]="CameraIsometricOffAxis3Bottom",t[t.CameraIsometricOffAxis4Left=36]="CameraIsometricOffAxis4Left",t[t.CameraIsometricOffAxis4Right=37]="CameraIsometricOffAxis4Right",t[t.CameraIsometricOffAxis4Bottom=38]="CameraIsometricOffAxis4Bottom",t[t.CameraObliqueTopLeft=39]="CameraObliqueTopLeft",t[t.CameraObliqueTop=40]="CameraObliqueTop",t[t.CameraObliqueTopRight=41]="CameraObliqueTopRight",t[t.CameraObliqueLeft=42]="CameraObliqueLeft",t[t.CameraObliqueRight=43]="CameraObliqueRight",t[t.CameraObliqueBottomLeft=44]="CameraObliqueBottomLeft",t[t.CameraObliqueBottom=45]="CameraObliqueBottom",t[t.CameraObliqueBottomRight=46]="CameraObliqueBottomRight",t[t.CameraPerspectiveFront=47]="CameraPerspectiveFront",t[t.CameraPerspectiveLeft=48]="CameraPerspectiveLeft",t[t.CameraPerspectiveRight=49]="CameraPerspectiveRight",t[t.CameraPerspectiveAbove=50]="CameraPerspectiveAbove",t[t.CameraPerspectiveBelow=51]="CameraPerspectiveBelow",t[t.CameraPerspectiveAboveLeftFacing=52]="CameraPerspectiveAboveLeftFacing",t[t.CameraPerspectiveAboveRightFacing=53]="CameraPerspectiveAboveRightFacing",t[t.CameraPerspectiveContrastingLeftFacing=54]="CameraPerspectiveContrastingLeftFacing",t[t.CameraPerspectiveContrastingRightFacing=55]="CameraPerspectiveContrastingRightFacing",t[t.CameraPerspectiveHeroicLeftFacing=56]="CameraPerspectiveHeroicLeftFacing",t[t.CameraPerspectiveHeroicRightFacing=57]="CameraPerspectiveHeroicRightFacing",t[t.CameraPerspectiveHeroicExtremeLeftFacing=58]="CameraPerspectiveHeroicExtremeLeftFacing",t[t.CameraPerspectiveHeroicExtremeRightFacing=59]="CameraPerspectiveHeroicExtremeRightFacing",t[t.CameraPerspectiveRelaxed=60]="CameraPerspectiveRelaxed",t[t.CameraPerspectiveRelaxedModerately=61]="CameraPerspectiveRelaxedModerately",t[t.PresetCameraNone=62]="PresetCameraNone"}(e.PresetCamera||(e.PresetCamera={})),function(t){t[t.LightingTopLeft=0]="LightingTopLeft",t[t.LightingTop=1]="LightingTop",t[t.LightingTopRight=2]="LightingTopRight",t[t.LightingLeft=3]="LightingLeft",t[t.LightingNone=4]="LightingNone",t[t.LightingRight=5]="LightingRight",t[t.LightingBottomLeft=6]="LightingBottomLeft",t[t.LightingBottom=7]="LightingBottom",t[t.LightingBottomRight=8]="LightingBottomRight"}(e.PresetLightingDirection||(e.PresetLightingDirection={})),function(t){t[t.LightRigLegacyFlat1=0]="LightRigLegacyFlat1",t[t.LightRigLegacyFlat2=1]="LightRigLegacyFlat2",t[t.LightRigLegacyFlat3=2]="LightRigLegacyFlat3",t[t.LightRigLegacyFlat4=3]="LightRigLegacyFlat4",t[t.LightRigLegacyNormal1=4]="LightRigLegacyNormal1",t[t.LightRigLegacyNormal2=5]="LightRigLegacyNormal2",t[t.LightRigLegacyNormal3=6]="LightRigLegacyNormal3",t[t.LightRigLegacyNormal4=7]="LightRigLegacyNormal4",t[t.LightRigLegacyHarsh1=8]="LightRigLegacyHarsh1",t[t.LightRigLegacyHarsh2=9]="LightRigLegacyHarsh2",t[t.LightRigLegacyHarsh3=10]="LightRigLegacyHarsh3",t[t.LightRigLegacyHarsh4=11]="LightRigLegacyHarsh4",t[t.LightRigThreePoint=12]="LightRigThreePoint",t[t.LightRigBalanced=13]="LightRigBalanced",t[t.LightRigSoft=14]="LightRigSoft",t[t.LightRigHarsh=15]="LightRigHarsh",t[t.LightRigFlood=16]="LightRigFlood",t[t.LightRigContrasting=17]="LightRigContrasting",t[t.LightRigMorning=18]="LightRigMorning",t[t.LightRigSunrise=19]="LightRigSunrise",t[t.LightRigSunset=20]="LightRigSunset",t[t.LightRigChilly=21]="LightRigChilly",t[t.LightRigFreezing=22]="LightRigFreezing",t[t.LightRigFlat=23]="LightRigFlat",t[t.LightRigTwoPoint=24]="LightRigTwoPoint",t[t.LightRigGlow=25]="LightRigGlow",t[t.LightRigBrightRoom=26]="LightRigBrightRoom"}(e.LightRigType||(e.LightRigType={})),function(t){t[t.Category=0]="Category",t[t.Value=1]="Value",t[t.SeriesAxis=2]="SeriesAxis"}(e.AxisType||(e.AxisType={})),function(t){t[t.high=0]="high",t[t.low=1]="low",t[t.nextToAxis=2]="nextToAxis",t[t.none=3]="none"}(e.TickLabelPosition||(e.TickLabelPosition={})),function(t){t[t.ScaleLogarithmic=0]="ScaleLogarithmic",t[t.ScaleLinear=1]="ScaleLinear"}(e.ScaleType||(e.ScaleType={})),function(t){t[t.days=0]="days",t[t.months=1]="months",t[t.years=2]="years"}(e.TimeUnit||(e.TimeUnit={})),function(t){t[t.cross=0]="cross",t[t.inside=1]="inside",t[t.none=2]="none",t[t.outside=3]="outside"}(e.TickMark||(e.TickMark={})),function(t){t.hundreds="hundreds",t.thousands="thousands",t.tenThousands="tenThousands",t.hundredThousands="hundredThousands",t.millions="millions",t.tenMillions="tenMillions",t.hundredMillions="hundredMillions",t.billions="billions",t.trillions="trillions"}(e.DisplayUnit||(e.DisplayUnit={})),function(t){t.automatic="auto",t.maximum="max",t.minimum="min"}(e.AxisCrossPoint||(e.AxisCrossPoint={})),function(t){t[t.minMax=0]="minMax",t[t.maxMin=1]="maxMin"}(e.AxisOrientation||(e.AxisOrientation={})),function(t){t[t.AutomaticScale=0]="AutomaticScale",t[t.CategoryScale=1]="CategoryScale",t[t.TimeScale=2]="TimeScale",t[t.ValueScale=3]="ValueScale"}(e.CategoryType||(e.CategoryType={})),function(t){t[t.primary=0]="primary",t[t.secondary=1]="secondary"}(e.AxisGroup||(e.AxisGroup={})),function(t){t[t.ConeToPoint=0]="ConeToPoint",t[t.ConeToMax=1]="ConeToMax",t[t.Box=2]="Box",t[t.Cylinder=3]="Cylinder",t[t.PyramidToPoint=4]="PyramidToPoint",t[t.PyramidToMax=5]="PyramidToMax"}(e.BarShape||(e.BarShape={})),function(t){t[t.combo=0]="combo",t[t.xyScatter=1]="xyScatter",t[t.radar=2]="radar",t[t.doughnut=3]="doughnut",t[t.pie3D=4]="pie3D",t[t.line3D=5]="line3D",t[t.column3D=6]="column3D",t[t.area3D=7]="area3D",t[t.area=8]="area",t[t.line=9]="line",t[t.pie=10]="pie",t[t.bubble=11]="bubble",t[t.columnClustered=12]="columnClustered",t[t.columnStacked=13]="columnStacked",t[t.columnStacked100=14]="columnStacked100",t[t.columnClustered3D=15]="columnClustered3D",t[t.columnStacked3D=16]="columnStacked3D",t[t.columnStacked1003D=17]="columnStacked1003D",t[t.barClustered=18]="barClustered",t[t.barStacked=19]="barStacked",t[t.barStacked100=20]="barStacked100",t[t.barClustered3D=21]="barClustered3D",t[t.barStacked3D=22]="barStacked3D",t[t.barStacked1003D=23]="barStacked1003D",t[t.lineStacked=24]="lineStacked",t[t.lineStacked100=25]="lineStacked100",t[t.lineMarkers=26]="lineMarkers",t[t.lineMarkersStacked=27]="lineMarkersStacked",t[t.lineMarkersStacked100=28]="lineMarkersStacked100",t[t.pieOfPie=29]="pieOfPie",t[t.pieExploded=30]="pieExploded",t[t.pieExploded3D=31]="pieExploded3D",t[t.barOfPie=32]="barOfPie",t[t.xyScatterSmooth=33]="xyScatterSmooth",t[t.xyScatterSmoothNoMarkers=34]="xyScatterSmoothNoMarkers",t[t.xyScatterLines=35]="xyScatterLines",t[t.xyScatterLinesNoMarkers=36]="xyScatterLinesNoMarkers",t[t.areaStacked=37]="areaStacked",t[t.areaStacked100=38]="areaStacked100",t[t.areaStacked3D=39]="areaStacked3D",t[t.areaStacked1003D=40]="areaStacked1003D",t[t.doughnutExploded=41]="doughnutExploded",t[t.radarMarkers=42]="radarMarkers",t[t.radarFilled=43]="radarFilled",t[t.surface=44]="surface",t[t.surfaceWireframe=45]="surfaceWireframe",t[t.surfaceTopView=46]="surfaceTopView",t[t.surfaceTopViewWireframe=47]="surfaceTopViewWireframe",t[t.bubble3DEffect=48]="bubble3DEffect",t[t.stockHLC=49]="stockHLC",t[t.stockOHLC=50]="stockOHLC",t[t.stockVHLC=51]="stockVHLC",t[t.stockVOHLC=52]="stockVOHLC",t[t.boxWhisker=53]="boxWhisker",t[t.funnel=54]="funnel",t[t.paretoLine=55]="paretoLine",t[t.regionMap=56]="regionMap",t[t.sunburst=57]="sunburst",t[t.treemap=58]="treemap",t[t.waterfall=59]="waterfall",t[t.clusteredColumn=60]="clusteredColumn"}(e.ChartType||(e.ChartType={})),function(t){t[t.exponential=0]="exponential",t[t.linear=1]="linear",t[t.logarithmic=2]="logarithmic",t[t.movingAverage=3]="movingAverage",t[t.polynomial=4]="polynomial",t[t.power=5]="power"}(e.TrendlineType||(e.TrendlineType={})),function(t){t[t.bestFit=0]="bestFit",t[t.below=1]="below",t[t.center=2]="center",t[t.insideBase=3]="insideBase",t[t.insideEnd=4]="insideEnd",t[t.left=5]="left",t[t.outsideEnd=6]="outsideEnd",t[t.right=7]="right",t[t.above=8]="above"}(e.DataLabelPosition||(e.DataLabelPosition={})),function(t){t[t.MarkerStyleCircle=0]="MarkerStyleCircle",t[t.MarkerStyleDash=1]="MarkerStyleDash",t[t.MarkerStyleDiamond=2]="MarkerStyleDiamond",t[t.MarkerStyleDot=3]="MarkerStyleDot",t[t.MarkerStyleNone=4]="MarkerStyleNone",t[t.MarkerStylePicture=5]="MarkerStylePicture",t[t.MarkerStylePlus=6]="MarkerStylePlus",t[t.MarkerStyleSquare=7]="MarkerStyleSquare",t[t.MarkerStyleStar=8]="MarkerStyleStar",t[t.MarkerStyleTriangle=9]="MarkerStyleTriangle",t[t.MarkerStyleX=10]="MarkerStyleX",t[t.MarkerStyleAutomatic=11]="MarkerStyleAutomatic"}(e.MarkerStyle||(e.MarkerStyle={})),function(t){t[t.both=0]="both",t[t.minus=1]="minus",t[t.plus=2]="plus"}(e.ErrorBarType||(e.ErrorBarType={})),function(t){t[t.custom=0]="custom",t[t.fixedValue=1]="fixedValue",t[t.percentage=2]="percentage",t[t.standardDeviation=3]="standardDeviation",t[t.standardError=4]="standardError"}(e.ErrorBarValueType||(e.ErrorBarValueType={})),function(t){t[t.Stretch=0]="Stretch",t[t.Stack=1]="Stack",t[t.StackScale=2]="StackScale"}(e.DrawingPictureType||(e.DrawingPictureType={})),function(t){t[t.SizeIsArea=0]="SizeIsArea",t[t.SizeIsWidth=1]="SizeIsWidth"}(e.SizeRepresents||(e.SizeRepresents={})),function(t){t[t.SplitByPosition=0]="SplitByPosition",t[t.SplitByValue=1]="SplitByValue",t[t.SplitByPercentValue=2]="SplitByPercentValue",t[t.SplitByCustomSplit=3]="SplitByCustomSplit"}(e.ChartSplitType||(e.ChartSplitType={})),function(t){t[t.custom=0]="custom",t[t.top=1]="top",t[t.right=2]="right",t[t.left=3]="left",t[t.bottom=4]="bottom",t[t.topRight=5]="topRight"}(e.LegendPosition||(e.LegendPosition={})),function(t){t[t.rows=0]="rows",t[t.columns=1]="columns"}(e.RowCol||(e.RowCol={})),function(t){t[t.circle=0]="circle",t[t.dash=1]="dash",t[t.diamond=2]="diamond",t[t.dot=3]="dot",t[t.none=4]="none",t[t.picture=5]="picture",t[t.plus=6]="plus",t[t.square=7]="square",t[t.star=8]="star",t[t.triangle=9]="triangle",t[t.x=10]="x"}(e.SymbolShape||(e.SymbolShape={})),function(t){t[t.solid=0]="solid",t[t.dot=1]="dot",t[t.dash=2]="dash",t[t.lgDash=3]="lgDash",t[t.dashDot=4]="dashDot",t[t.lgDashDot=5]="lgDashDot",t[t.lgDashDotDot=6]="lgDashDotDot",t[t.sysDash=7]="sysDash",t[t.sysDot=8]="sysDot",t[t.sysDashDot=9]="sysDashDot",t[t.sysDashDotDot=10]="sysDashDotDot"}(e.LineType||(e.LineType={})),function(t){t[t.Baseline=0]="Baseline",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(e.VertAlignType||(e.VertAlignType={})),function(t){t[t.MoveAndSize=0]="MoveAndSize",t[t.Move=1]="Move",t[t.FreeFloating=2]="FreeFloating"}(e.Placement||(e.Placement={})),function(t){t[t.All=0]="All",t[t.Chart=1]="Chart",t[t.PlotArea=2]="PlotArea",t[t.Series=3]="Series",t[t.SeriesCollection=4]="SeriesCollection",t[t.Point=5]="Point",t[t.DataLabel=6]="DataLabel",t[t.DataMarker=7]="DataMarker",t[t.CategoryAxis=8]="CategoryAxis",t[t.ValueAxis=9]="ValueAxis",t[t.SeriesAxis=10]="SeriesAxis",t[t.Lengend=11]="Lengend",t[t.FloorWall=12]="FloorWall",t[t.SideWall=13]="SideWall",t[t.BackWall=14]="BackWall",t[t.ChartTitle=15]="ChartTitle",t[t.AxisTitle=16]="AxisTitle",t[t.ChartGroup=17]="ChartGroup"}(e.ChartElements||(e.ChartElements={})),function(t){t[t.PNG=0]="PNG",t[t.JPG=1]="JPG",t[t.JPEG=2]="JPEG",t[t.EMF=3]="EMF"}(e.ImageType||(e.ImageType={})),function(t){t[t.None=0]="None",t[t.Automatic=1]="Automatic",t[t.RGB=2]="RGB",t[t.Theme=3]="Theme"}(e.SolidColorType||(e.SolidColorType={})),function(t){t[t.None=0]="None",t[t.Words=1]="Words",t[t.Single=2]="Single",t[t.Double=3]="Double",t[t.Heavy=4]="Heavy",t[t.Dotted=5]="Dotted",t[t.DottedHeavy=6]="DottedHeavy",t[t.Dash=7]="Dash",t[t.DashHeavy=8]="DashHeavy",t[t.DashLong=9]="DashLong",t[t.DashLongHeavy=10]="DashLongHeavy",t[t.DotDash=11]="DotDash",t[t.DotDashHeavy=12]="DotDashHeavy",t[t.DotDotDash=13]="DotDotDash",t[t.DotDotDashHeavy=14]="DotDotDashHeavy",t[t.Wavy=15]="Wavy",t[t.WavyHeavy=16]="WavyHeavy",t[t.WavyDouble=17]="WavyDouble"}(e.TextUnderlineType||(e.TextUnderlineType={})),function(t){t[t.ReflectionTypeNone=0]="ReflectionTypeNone",t[t.ReflectionType1=1]="ReflectionType1",t[t.ReflectionType2=2]="ReflectionType2",t[t.ReflectionType3=3]="ReflectionType3",t[t.ReflectionType4=4]="ReflectionType4",t[t.ReflectionType5=5]="ReflectionType5",t[t.ReflectionType6=6]="ReflectionType6",t[t.ReflectionType7=7]="ReflectionType7",t[t.ReflectionType8=8]="ReflectionType8",t[t.ReflectionType9=9]="ReflectionType9"}(e.ReflectionType||(e.ReflectionType={})),function(t){t[t.CellRange=0]="CellRange",t[t.SeriesName=1]="SeriesName",t[t.CategoryName=2]="CategoryName",t[t.Value=3]="Value",t[t.XValue=4]="XValue",t[t.YValue=5]="YValue",t[t.BubbleSize=6]="BubbleSize",t[t.Percentage=7]="Percentage",t[t.TxLink=8]="TxLink"}(e.TextFieldType||(e.TextFieldType={})),function(t){t[t.None=0]="None",t[t.Single=1]="Single",t[t.Double=2]="Double",t[t.SingleAccounting=3]="SingleAccounting",t[t.DoubleAccounting=4]="DoubleAccounting"}(e.UnderlineType||(e.UnderlineType={})),function(t){t[t.None=0]="None",t[t.Auto=1]="Auto",t[t.RGB=2]="RGB",t[t.Index=3]="Index",t[t.Theme=4]="Theme"}(e.ColorType||(e.ColorType={})),function(t){t[t.connected=0]="connected",t[t.gaps=1]="gaps",t[t.zero=2]="zero"}(e.DisplayBlanksAs||(e.DisplayBlanksAs={})),function(t){t[t.Color=1]="Color",t[t.PatternColor=2]="PatternColor",t[t.BeginArrowheadLength=4]="BeginArrowheadLength",t[t.BeginArrowheadStyle=8]="BeginArrowheadStyle",t[t.BeginArrowheadWidth=16]="BeginArrowheadWidth",t[t.DashStyle=32]="DashStyle",t[t.EndArrowheadLength=64]="EndArrowheadLength",t[t.EndArrowheadStyle=128]="EndArrowheadStyle",t[t.EndArrowheadWidth=256]="EndArrowheadWidth",t[t.InsetPen=512]="InsetPen",t[t.Pattern=1024]="Pattern",t[t.Style=2048]="Style",t[t.Transparency=4096]="Transparency",t[t.Visible=8192]="Visible",t[t.Weight=16384]="Weight",t[t.CapStyle=32768]="CapStyle",t[t.JoinStyle=65536]="JoinStyle"}(e.LineFormatStates||(e.LineFormatStates={})),function(t){t[t.Brightness=1]="Brightness",t[t.ObjectThemeColor=2]="ObjectThemeColor",t[t.RGB=4]="RGB",t[t.TintAndShade=8]="TintAndShade",t[t.ColorType=16]="ColorType",t[t.Transparency=32]="Transparency"}(e.ColorFormatStates||(e.ColorFormatStates={})),function(t){t[t.PictureShape=0]="PictureShape",t[t.PictureFill=1]="PictureFill",t[t.TextureFill=2]="TextureFill"}(e.PictureFormatType||(e.PictureFormatType={}))},"./dist/plugins/floatingObject/drawing/effects.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/stateful.js"),r=o("./dist/plugins/floatingObject/drawing/common.js"),i=o("./dist/plugins/floatingObject/drawing/colorFormat.js"),a=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),function(t){t[t.Blur=1]="Blur",t[t.Offset=2]="Offset",t[t.Size=4]="Size",t[t.Transparency=8]="Transparency",t[t.Type=16]="Type"}(s||(s={})),l=r.UnitHelper.isNullOrUndefined,u=Math.floor,c=Math.sqrt,function(t){t[t.Blur=1]="Blur",t[t.Obscured=2]="Obscured",t[t.OffsetX=4]="OffsetX",t[t.OffsetY=8]="OffsetY",t[t.RotateWithShape=16]="RotateWithShape",t[t.Size=32]="Size",t[t.Style=64]="Style",t[t.Transparency=128]="Transparency",t[t.Type=256]="Type",t[t.Visible=512]="Visible"}(f||(f={})),h=function(t){function e(e,o){var n=t.call(this,o)||this,i=n;return i.Ira=5,i.Jra=!1,i.Kra=r.ShapeConstants.DefaultOffset,i.Lra=r.ShapeConstants.DefaultOffset,i.Mra=!1,i.Oz=100,i.Gqa=0,i.bz=!1,i.presetShadowOffset=-6,i.xc=e,i.hqa=o,n}return y(e,t),e.prototype.OnStyleChange=function(){var t=this;t.Ira=0,t.Kra=0,t.Lra=0,t.Oz=100,t.Gqa=0,t.UnDirty(f.Type),t.Style===a.ShadowStyle.ShadowStyleInnerShadow?t.Mra=!1:t.Style===a.ShadowStyle.ShadowStyleOuterShadow&&(t.Mra=!0)},e.prototype.OnTypeChange=function(){var t=this;t.Ira=5,t.Kra=t.presetShadowOffset,t.Lra=t.presetShadowOffset,t.Oz=100,t.Gqa=.5,t.UnDirty(f.Style)},e.prototype.GetDefaultColor=function(){var t=new i.ColorFormat(this.xc,this.hqa&&this.hqa.Nra);return t.ColorType=a.SolidColorType.None,t},e.prototype.IncrementOffsetX=function(t){this.OffsetX+=t},e.prototype.IncrementOffsetY=function(t){this.OffsetY+=t},e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e.prototype.ToCT_PresetShadowEffect=function(){var t=this,e=t.OffsetX,o=t.OffsetY,n=c(e*e+o*o),i={dist:0,dir:0};return i.dist=n,i.dir=u(r.NumberExtension.GetTriangleAngle(e,o,n)*r.ShapeConstants.PositiveFixedAngleConvert),i.prst=t.Type,t.ToCT_Color(i),i},e.prototype.ToCT_InnerShadowEffect=function(){var t=this,e=t.OffsetX,o=t.OffsetY,n=c(e*e+o*o),i={blurRad:0,dist:0,dir:0};return i.blurRad=t.Blur,i.dist=n,0===e&&0===o||(i.dir=u(r.NumberExtension.GetTriangleAngle(e,o,n)*r.ShapeConstants.PositiveFixedAngleConvert)),i.scrgbClr=t.ToCT_ScRgbColor(),i},e.prototype.ToCT_OuterShadowEffect=function(){var t=this,e=t.OffsetX,o=t.OffsetY,n=c(e*e+o*o),i={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:a.TextureAlignment.TextureBottom,rotWithShape:!0};return i.blurRad=t.Blur,i.dist=n,0===e&&0===o||(i.dir=u(r.NumberExtension.GetTriangleAngle(e,o,n)*r.ShapeConstants.PositiveFixedAngleConvert)),i.rotWithShape=!0===t.RotateWithShape,i.sx=u(t.Size*r.ShapeConstants.RelativeRectConver),i.sy=u(t.Size*r.ShapeConstants.RelativeRectConver),i.scrgbClr=t.ToCT_ScRgbColor(),i},e.prototype.ToCT_Color=function(t){var e,o,n,i,s,c=this;l(c.Nra)||(c.Nra.ColorType===a.SolidColorType.Theme?((i={}).val=c.Nra.ObjectThemeColor,0!==c.Nra.Brightness&&(e=u(1e5*c.Nra.Brightness),i.lumMod=[e],o=u(1e5*(1-c.Nra.Brightness)),i.lumOff=[o]),c.Nra.TintAndShade>0&&c.Nra.TintAndShade<1&&(n=u(c.Nra.TintAndShade*r.ShapeConstants.ShadeConver),i.shade=[n]),t.schemeClr=i):c.Nra.ColorType===a.SolidColorType.RGB&&((s={}).val=[c.Nra.RGB.R,c.Nra.RGB.G,c.Nra.RGB.B],0!==c.Nra.Brightness&&(e=u(1e5*c.Nra.Brightness),s.lumMod=[e],o=u(1e5*(1-c.Nra.Brightness)),s.lumOff=[o]),0!==c.Transparency&&(n=u(c.Transparency*r.ShapeConstants.PositiveFixedPercentageConvert),s.alpha=[n]),t.srgbClr=s))},e.prototype.ToCT_ScRgbColor=function(){var t,e={};return 0!==this.Transparency&&(t=u(this.Transparency*r.ShapeConstants.PositiveFixedPercentageConvert),e.alpha=[t]),e},e.prototype.SetState=function(e,o){t.prototype.SetState.call(this,e,o),e!==f.Blur&&e!==f.OffsetX&&e!==f.OffsetY&&e!==f.RotateWithShape&&e!==f.Size&&e!==f.Transparency||this.GetState(f.Style)||(this.Wqa=a.ShadowStyle.ShadowStyleOuterShadow)},Object.defineProperty(e.prototype,"ForeColor",{get:function(){var t=this;return l(t.Nra)&&(t.Nra=t.GetDefaultColor()),t.Nra},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Obscured",{get:function(){var t=this;return t.GetState(f.Obscured)||l(t.hqa)?t.Jra:t.hqa.Obscured},set:function(t){this.Jra=t,this.SetState(f.Obscured,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Blur",{get:function(){var t=this;return t.GetState(f.Blur)||l(t.hqa)?t.Ira:t.hqa.Blur},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Blue",{set:function(t){this.Ira=t,this.SetState(f.Blur,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetX",{get:function(){var t=this;return t.GetState(f.OffsetX)||l(t.hqa)?t.Kra:t.hqa.OffsetX},set:function(t){this.Kra=t,this.SetState(f.OffsetX,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetY",{get:function(){var t=this;return t.GetState(f.OffsetY)||l(t.hqa)?t.Lra:t.hqa.OffsetY},set:function(t){this.Lra=t,this.SetState(f.OffsetY,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotateWithShape",{get:function(){var t=this;return t.GetState(f.RotateWithShape)||l(t.hqa)?t.Mra:t.hqa.RotateWithShape},set:function(t){var e=this;e.Style===a.ShadowStyle.ShadowStyleInnerShadow||e.GetState(f.Type)||(e.Mra=t,e.SetState(f.RotateWithShape,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this;return t.GetState(f.Size)||l(t.hqa)?t.Oz:t.hqa.Size},set:function(t){this.Oz=t,this.SetState(f.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Style",{get:function(){var t=this;return t.GetState(f.Style)||l(t.hqa)?t.Wqa:t.hqa.Style},set:function(t){var e=this;e.Style!==t&&e.OnStyleChange(),e.Wqa=t,e.SetState(f.Style,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(f.Transparency)||l(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){this.Gqa=t,this.SetState(f.Transparency,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){var t=this;return t.GetState(f.Type)||l(t.hqa)?t.Nc:t.hqa.Type},set:function(t){this.Nc=t,this.SetState(f.Type,!0),this.OnTypeChange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var t=this;return t.GetState(f.Visible)||l(t.hqa)?t.bz:t.hqa.Visible},set:function(t){var e=this;e.bz=t,e.SetState(f.Visible,!0),!1===t||e.GetState(f.Style)||(e.Wqa=a.ShadowStyle.ShadowStyleOuterShadow)},enumerable:!0,configurable:!0}),e}(n.StatefullBase),e.ShadowFormat=h,p=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e}(n.StatefullBase),e.SoftEdgeFormat=p,d=function(t){function e(e,o){var n=t.call(this,o)||this,r=n;return r.Oz=100,r.Nc=a.ReflectionType.ReflectionType1,r.presetShadowOffset=-6,r.xc=e,r.hqa=o,n}return y(e,t),Object.defineProperty(e.prototype,"Blur",{get:function(){var t=this;return t.GetState(s.Blur)||l(t.hqa)?t.Ira:t.hqa.Blur},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Blue",{set:function(t){this.Ira=t,this.SetState(s.Blur,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){var t=this;return t.GetState(s.Offset)||l(t.hqa)?t.UP:t.hqa.Offset},set:function(t){this.UP=t,this.SetState(s.Offset,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this;return t.GetState(s.Size)||l(t.hqa)?t.Oz:t.hqa.Size},set:function(t){this.Oz=t,this.SetState(s.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(s.Transparency)||l(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){this.Gqa=t,this.SetState(s.Transparency,!0)},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e.prototype.OnTypeChange=function(){var t=this;t.Ira=5,t.UP=t.presetShadowOffset,t.Oz=100,t.Gqa=.5},e}(n.StatefullBase),e.ReflectionFormat=d,function(t){t[t.Color=1]="Color",t[t.Radius=2]="Radius",t[t.Transparency=4]="Transparency"}(g||(g={})),m=function(t){function e(e,o){var n=t.call(this,o)||this;return n.xc=e,n.hqa=o,n}return y(e,t),Object.defineProperty(e.prototype,"Color",{get:function(){var t=this;return l(t.tE)&&(t.tE=t.GetDefaultColor()),t.tE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Radius",{get:function(){var t=this;return t.GetState(g.Radius)||l(t.hqa)?t.radius:t.hqa.Radius},set:function(t){this.radius=t,this.Dirty(g.Radius)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(g.Transparency)||l(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){this.Gqa=t,this.Dirty(g.Transparency)},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e.prototype.GetDefaultColor=function(){var t=new i.ColorFormat(this.xc,this.hqa&&this.hqa.Color);return t.ColorType=a.SolidColorType.None,t},e.prototype.SetState=function(e,o){var n=this;t.prototype.SetState.call(n,e,o),e!==g.Radius&&e!==g.Transparency||n.tE&&n.tE.ColorType===a.SolidColorType.None&&(n.tE.ColorType=a.SolidColorType.RGB)},e.prototype.ToCT_Color=function(t){var e,o,n,i,s,c,f,h=this,p=h.tE;l(p)||(i=p.ColorType,s=p.Brightness,i===a.SolidColorType.Theme?((c={}).val=p.ObjectThemeColor,0!==s&&(e=u(1e5*s),c.lumMod=[e],o=u(1e5*(1-s)),c.lumOff=[o]),p.TintAndShade>0&&p.TintAndShade<1&&(n=u(p.TintAndShade*r.ShapeConstants.ShadeConver),c.shade=[n]),t.schemeClr=c):i===a.SolidColorType.RGB&&((f={}).val=[p.RGB.R,p.RGB.G,p.RGB.B],0!==s&&(e=u(1e5*s),f.lumMod=[e],o=u(1e5*(1-s)),f.lumOff=[o]),0!==h.Transparency&&(n=u(h.Transparency*r.ShapeConstants.PositiveFixedPercentageConvert),f.alpha=[n]),t.srgbClr=f))},e}(n.StatefullBase),e.GlowFormat=m},"./dist/plugins/floatingObject/drawing/fillFormat.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/stateful.js"),r=o("./dist/plugins/floatingObject/drawing/common.js"),i=o("./dist/plugins/floatingObject/drawing/colorFormat.js"),a=o("./dist/plugins/floatingObject/drawing/gradient.js"),s=o("./dist/plugins/floatingObject/drawing/picture.js"),l=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=r.ShapeConstants,c=u.PositiveFixedPercentageConvert,f=u.PositiveFixedAngleConvert,h=u.PositionConver,p=r.ShapeUtility,d=r.UnitHelper,g=d.isNullOrUndefined,m=null,y=Math.floor,C="The specified value is out of range",function(t){t[t.GradientStops=1]="GradientStops",t[t.GradientStyle=2]="GradientStyle",t[t.GradientColorType=4]="GradientColorType",t[t.Pattern=8]="Pattern",t[t.PresetTexture=16]="PresetTexture",t[t.RotateWithObject=32]="RotateWithObject",t[t.TextureAlignment=64]="TextureAlignment",t[t.TextureHorizontalScale=128]="TextureHorizontalScale",t[t.TextureName=256]="TextureName",t[t.TextureOffsetX=512]="TextureOffsetX",t[t.TextureOffsetY=1024]="TextureOffsetY",t[t.TextureTile=2048]="TextureTile",t[t.TextureType=4096]="TextureType",t[t.TextureVerticalScale=8192]="TextureVerticalScale",t[t.Transparency=16384]="Transparency",t[t.Type=32768]="Type",t[t.Visible=65536]="Visible",t[t.Color=131072]="Color",t[t.PatternColor=262144]="PatternColor",t[t.PictureFormat=524288]="PictureFormat",t[t.GradientDegree=1048576]="GradientDegree",t[t.GradientAngle=2097152]="GradientAngle",t[t.GradientVariant=4194304]="GradientVariant",t[t.PresetGradientType=8388608]="PresetGradientType"}(v||(v={})),b=function(t){function e(e,o,n,r){var i=t.call(this,o)||this,u=i;return u.dqa=!0,u.eqa=l.ST_PathShadeType.rect,u.wE=l.PatternType.none,u.fqa=!0,u.bz=!0,u.gqa=m,u.xc=e,u.Nc=l.FillType.Solid,u.hqa=o,u.iqa=n,u.xo=r,u.jqa=new s.PictureFormat(l.PictureFormatType.PictureFill,o&&o.PictureFormat),u.jqa.Container=r,u.kqa=1,u.lqa=1,u.mqa=new a.GradientStops(u.xc),i}return w(e,t),Object.defineProperty(e.prototype,"Parent",{get:function(){return this.hqa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PictureFormat",{get:function(){return this.jqa},set:function(t){var e,o=this;g(o.jqa)||o.jqa.SetParentForChildren(t),e=o.jqa,o.jqa=t,g(e)||(o.jqa.ParentStateful=e.ParentStateful)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PatternColor",{get:function(){return this.PatternColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.ColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientAngle",{get:function(){var t=this;if(!t.IsDirty(v.GradientAngle)&&!g(t.hqa))return t.hqa.GradientAngle;if(t.GradientStyle===l.GradientStyle.GradientFromCenter||t.GradientStyle===l.GradientStyle.GradientFromCorner)throw Error();return t.nqa},set:function(t){this.nqa=t,this.Dirty(v.GradientAngle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientColorType",{get:function(){return this.GetGradientColorType()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientDegree",{get:function(){var t=this;return t.IsDirty(v.GradientDegree)||g(t.hqa)?t.oqa:t.hqa.GradientDegree},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientStops",{get:function(){var t=this;return t.IsDirty(v.GradientStops)||g(t.hqa)?t.mqa:t.hqa.GradientStops},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientStyle",{get:function(){var t=this;return t.IsDirty(v.GradientStyle)||g(t.hqa)?t.qqa:t.hqa.GradientStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientVariant",{get:function(){var t=this;return t.IsDirty(v.GradientVariant)||g(t.hqa)?t.sqa:t.hqa.GradientVariant},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pattern",{get:function(){var t=this;return t.IsDirty(v.Pattern)||g(t.hqa)?t.wE:t.hqa.Pattern},set:function(t){this.wE=t,this.Dirty(v.Pattern)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetGradientType",{get:function(){var t=this;return t.IsDirty(v.PresetGradientType)||g(t.hqa)?t.wqa:t.hqa.PresetGradientType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotateWithObject",{get:function(){var t=this;return t.IsDirty(v.RotateWithObject)||g(t.hqa)?t.fqa:t.hqa.RotateWithObject},set:function(t){this.fqa=t,this.Dirty(v.RotateWithObject)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureAlignment",{get:function(){var t=this;return t.IsDirty(v.TextureAlignment)||g(t.hqa)?t.yqa:t.hqa.TextureAlignment},set:function(t){this.yqa=t,this.Dirty(v.TextureAlignment)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureHorizontalScale",{get:function(){var t=this;return t.IsDirty(v.TextureHorizontalScale)||g(t.hqa)?t.kqa:t.hqa.TextureHorizontalScale},set:function(t){this.kqa=t,this.Dirty(v.TextureHorizontalScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureOffsetX",{get:function(){var t=this;return t.IsDirty(v.TextureOffsetX)||g(t.hqa)?t.zqa:t.hqa.TextureOffsetX},set:function(t){this.zqa=t,this.Dirty(v.TextureOffsetX)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureOffsetY",{get:function(){var t=this;return t.IsDirty(v.TextureOffsetY)||g(t.hqa)?t.Aqa:t.hqa.TextureOffsetY},set:function(t){this.Aqa=t,this.Dirty(v.TextureOffsetY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureVerticalScale",{get:function(){var t=this;return t.IsDirty(v.TextureVerticalScale)||g(t.hqa)?t.lqa:t.hqa.TextureVerticalScale},set:function(t){this.lqa=t,this.Dirty(v.TextureVerticalScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.IsDirty(v.Transparency)||g(t.hqa)?t.ColorInternal.Transparency:t.hqa.Transparency},set:function(t){this.ColorInternal.Transparency=t,this.Dirty(v.Transparency)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){var t=this;return t.IsDirty(v.Type)||g(t.hqa)?t.Nc:t.hqa.Type},set:function(t){this.Nc=t,this.Dirty(v.Type)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var t=this;return t.IsDirty(v.Visible)||g(t.hqa)?t.bz:t.hqa.Visible},set:function(t){this.bz=t,this.Dirty(v.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorInternal",{get:function(){var t=this;return g(t.tE)&&(t.tE=new i.ColorFormat(t.xc,g(t.hqa)?m:t.hqa.Color),t.tE.AutoColorFormat=t.iqa),t.tE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PatternColorInternal",{get:function(){var t=this;return g(t.Bqa)&&(t.Bqa=new i.ColorFormat(t.xc,g(t.hqa)?m:t.hqa.PatternColor)),t.Bqa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetTexture",{get:function(){var t=this;return t.IsDirty(v.PresetTexture)||g(t.hqa)?t.Cqa:t.hqa.PresetTexture},set:function(t){this.Cqa=t,this.Dirty(v.PresetTexture)},enumerable:!0,configurable:!0}),e.prototype.GetGradientColorType=function(){var t,e,o,n,r=[];for(t=0,e=this.mqa.GradientStopList;t<e.length;t++)o=e[t],this.FindInColorStops(o.Color,r)||r.push(o.Color);return 0===(n=r.length)?l.GradientColorType.GradientColorNone:1===n?l.GradientColorType.GradientOneColor:2===n?l.GradientColorType.GradientTwoColors:l.GradientColorType.GradientMultiColor},e.prototype.FindInColorStops=function(t,e){var o,n,r,i;for(o=0,n=e;o<n.length;o++)if((i=(r=n[o]).ColorType)===t.ColorType)if(i===l.SolidColorType.Theme){if(r.ObjectThemeColor===t.ObjectThemeColor&&r.TintAndShade===t.TintAndShade)return!0}else if(i===l.SolidColorType.RGB&&r.RGB.Equals(t.RGB)&&r.TintAndShade===t.TintAndShade)return!0;return!1},e.prototype.pqa=function(t){this.oqa=t,this.Dirty(v.GradientDegree)},e.prototype.Fpa=function(t){this.mqa=t,this.Dirty(v.GradientStops)},e.prototype.rqa=function(t){this.qqa=t,this.Dirty(v.GradientStyle)},e.prototype.tqa=function(t){this.sqa=t,this.Dirty(v.GradientVariant)},e.prototype.uqa=function(t){if(t===l.PatternType.none)throw Error(C);var e=this;e.Pattern===l.PatternType.none&&e.vqa(l.FillType.Patterned),e.wE=t,e.Dirty(v.Pattern)},e.prototype.xqa=function(t){this.wqa=t,this.Dirty(v.PresetGradientType)},e.prototype.vqa=function(t){this.Nc=t,this.Dirty(v.Type)},e.prototype.InitGradientInfo=function(t,e,o){if(t===l.GradientStyle.GradientFromTitle)throw Error(C);var n=this;n.rqa(t),n.tqa(e),n.vqa(l.FillType.Gradient),n.xqa(o)},e.prototype.OneColorGradient=function(t,e,o){if(o<0||o>1)throw Error(C);var n=this;n.InitGradientInfo(t,e,l.PresetGradientType.GradientEarlySunset),n.pqa(o),p.InitGradientStops(n.xc,n,l.GradientColorType.GradientOneColor)},e.prototype.TwoColorGradient=function(t,e){this.InitGradientInfo(t,e,l.PresetGradientType.GradientEarlySunset),p.InitGradientStops(this.xc,this,l.GradientColorType.GradientTwoColors)},e.prototype.PresetGradient=function(t,e,o){this.InitGradientInfo(t,e,o),p.InitGradientStops(this.xc,this,l.GradientColorType.GradientPresetColors)},e.prototype.Patterned=function(t){this.SetPatternColor(),this.vqa(l.FillType.Patterned),this.uqa(t)},e.prototype.SetPatternColor=function(){var t=this;t.Color.ObjectThemeColor=l.ColorSchemeIndex.LT1,t.PatternColor.ObjectThemeColor=l.ColorSchemeIndex.Accent1,t.Color.ClearModel(),t.PatternColor.ClearModel()},e.prototype.Solid=function(){this.vqa(l.FillType.Solid),g(this.tE)||this.tE.ClearModel()},e.prototype.ClearColor=function(){this.tE=m},e.prototype.GetState=function(e,o){var n=this;return undefined===o&&(o=!1),e!==v.Color||g(n.tE)?e!==v.PatternColor||g(n.Bqa)?t.prototype.GetState.call(n,e,o):n.Bqa.IsDirtyIncludingParent(o):n.tE.IsDirtyIncludingParent(o)},e.prototype.IsDirtyIncludingParent=function(e){void 0===e&&(e=!1);var o=this;return!(g(o.Bqa)||!o.Bqa.IsDirtyIncludingParent())||!(g(o.tE)||!o.tE.IsDirtyIncludingParent())||!g(o.mqa)&&o.mqa.Count>0||!(g(o.jqa)||!o.jqa.IsDirtyIncludingParent())||t.prototype.IsDirtyIncludingParent.call(o,e)},e.prototype.OnParentChanged=function(t){var e=this;e.hqa=t,g(e.hqa)?(g(e.tE)||(e.tE.ParentStateful=m),g(e.Bqa)||(e.Bqa.ParentStateful=m)):(g(e.tE)||(e.tE.ParentStateful=e.hqa.Color),g(e.Bqa)||(e.Bqa.ParentStateful=e.hqa.PatternColor))},e.prototype.FromOOModel=function(t,e){if(g(e))throw Error("colorFillType not provided!");var o=this;o.gqa=t,e===l.ColorFillType.SolidColorFillProperties?(o.ColorInternal.FromOOModel(o.gqa),o.Nc=l.FillType.Solid,o.SetState(v.Type,!0)):e===l.ColorFillType.PatternFillProperties?(o.FromCT_PatternFillProperties(t),o.Nc=l.FillType.Patterned,o.SetState(v.Type,!0)):e===l.ColorFillType.GradientFillProperties?(o.FromCT_GradientFillProperties(t),o.Nc=l.FillType.Gradient,o.SetState(v.Type,!0)):e===l.ColorFillType.BlipFillProperties?(o.jqa.FromOOModel(t),o.Nc=l.FillType.Picture,o.SetState(v.Type,!0)):e===l.ColorFillType.GroupFillProperties?(o.Nc=l.FillType.Group,o.SetState(v.Type,!0)):e===l.ColorFillType.NoFillProperties&&(o.Nc=l.FillType.Solid,o.SetState(v.Type,!0))},e.prototype.ToOOModel=function(t){var e;if(this.Visible)switch(this.Type){case l.FillType.Solid:e=this.ToCT_SolidColorFillProperties();break;case l.FillType.Patterned:e=this.ToCT_PatternFillProperties();break;case l.FillType.Gradient:e=this.ToCT_GradientFillProperties();break;case l.FillType.Textured:e=this.ToCT_TileFillProperties();break;case l.FillType.Background:break;case l.FillType.Picture:e=this.ToCT_PictureFillProperties();break;case l.FillType.Group:e={colorFillType:l.ColorFillType.GroupFillProperties}}else e={colorFillType:l.ColorFillType.NoFillProperties};return e},e.prototype.FromCT_PatternFillProperties=function(t){this.uqa(t.prst),this.ColorInternal.FromOOModel(t.bgClr),this.PatternColorInternal.FromOOModel(t.fgClr)},e.prototype.ToCT_PatternFillProperties=function(){var t,e=this;return e.xc.DrawingType===l.DrawingType.GroupShape?m:((t={colorFillType:l.ColorFillType.PatternFillProperties}).prst=e.Pattern,e.PatternColorInternal.ColorType!==l.SolidColorType.None&&(t.fgClr=e.PatternColorInternal.Color_ToOOModel()),e.Color.ColorType!==l.SolidColorType.None&&(t.bgClr=e.Color.Color_ToOOModel()),t)},e.prototype.FromCT_GradientFillProperties=function(t){var e=this;e.Fpa(new a.GradientStops(e.xc)),e.mqa.FromOOModel(t.gsLst),e.RotateWithObject=t.rotWithShape,g(t.path)?g(t.lin)||(e.FromCT_LinearShadeProperties(t.lin),e.FromTitleCT_RelativeRect(t.tileRect)):e.FromCT_PathShadeProperties(t.path)},e.prototype.ToCT_GradientFillProperties=function(){var t=this,e={colorFillType:l.ColorFillType.GradientFillProperties};return e.rotWithShape=t.RotateWithObject,!g(t.GradientStops)&&t.GradientStops.Count>0&&(e.gsLst=t.GradientStops.ToOOModel()),t.GradientStyle===l.GradientStyle.GradientFromCenter||t.GradientStyle===l.GradientStyle.GradientFromCorner||t.GradientStyle===l.GradientStyle.GradientTopSpotlight||t.GradientStyle===l.GradientStyle.GradientBottomSpotlight?e.path=t.ToCT_PathShadeProperties():e.lin=t.ToCT_LinearShadeProperties(),e.tileRect=t.ToTitleCT_RelativeRect(),e},e.prototype.ToCT_PictureFillProperties=function(){return this.jqa.ToOOModel()},e.prototype.FromTitleCT_RelativeRect=function(t){var e=this;g(t)||(t.l===-c&&t.t===-c?e.tqa(1):t.t===-c&&t.r===-c?e.tqa(2):t.l===-c&&t.b===-c?e.tqa(3):t.r===-c&&t.b===-c&&e.tqa(4))},e.prototype.ToTitleCT_RelativeRect=function(){var t={l:0,r:0,t:0,b:0},e=this.GradientVariant;return this.GradientStyle===l.GradientStyle.GradientFromCorner&&(1===e?(t.l=-c,t.t=-c):2===e?(t.t=-c,t.r=-c):3===e?(t.l=-c,t.b=-c):4===e&&(t.r=-c,t.b=-c)),t},e.prototype.FromCT_LinearShadeProperties=function(t){this.GradientAngle=t.ang/f,this.Vkb=!0,this.dqa=t.scaled},e.prototype.ToCT_LinearShadeProperties=function(){return{ang:y(this.GradientAngle*f),scaled:this.dqa}},e.prototype.FromCT_PathShadeProperties=function(t){g(t)||(this.eqa=t.path,this.FromCT_RelativeRect(t.fillToRect))},e.prototype.ToCT_PathShadeProperties=function(){return{path:this.eqa,fillToRect:this.ToCT_RelativeRect()}},e.prototype.FromCT_RelativeRect=function(t){var e,o;g(t)||(e=.5*c,o=this,t.l===e&&t.t===e&&t.r===e&&t.b===e?o.rqa(l.GradientStyle.GradientFromCenter):t.r===c&&t.b===c?(o.rqa(l.GradientStyle.GradientFromCorner),o.tqa(1)):t.l===c&&t.b===c?(o.rqa(l.GradientStyle.GradientFromCorner),o.tqa(2)):t.r===c&&t.t===c?(o.rqa(l.GradientStyle.GradientFromCorner),o.tqa(3)):t.l===c&&t.t===c?(o.rqa(l.GradientStyle.GradientFromCorner),o.tqa(4)):t.l===e&&t.t===.8*-c?o.rqa(l.GradientStyle.GradientTopSpotlight):t.l===e&&t.t===1.3*c&&o.rqa(l.GradientStyle.GradientBottomSpotlight))},e.prototype.ToCT_RelativeRect=function(){var t,e={l:0,r:0,t:0,b:0},o=.5*c;return this.GradientStyle===l.GradientStyle.GradientFromCenter?(e.l=o,e.t=o,e.r=o,e.b=o):this.GradientStyle===l.GradientStyle.GradientFromCorner?1===(t=this.GradientVariant)?(e.r=c,e.b=c):2===t?(e.l=c,e.b=c):3===t?(e.t=c,e.r=c):4===t&&(e.l=c,e.t=c):this.GradientStyle===l.GradientStyle.GradientTopSpotlight?(e.l=o,e.r=o,e.t=.8*-f,e.b=1.8*c):this.GradientStyle===l.GradientStyle.GradientBottomSpotlight&&(e.l=o,e.r=o,e.t=1.3*c,e.b=.3*-f),e},e.prototype.ToCT_SolidColorFillProperties=function(){return this.ColorInternal.ToOOModel()},e.prototype.ToCT_TileFillProperties=function(){var t=this.jqa.ToOOModel();return t.tile=this.ToCT_TileInfoProperties(),t},e.prototype.ToCT_TileInfoProperties=function(){var t=this;return{algn:t.TextureAlignment,tx:t.TextureOffsetX,ty:t.TextureOffsetY,sx:y(t.TextureHorizontalScale*h),sy:y(t.TextureVerticalScale*h)}},e.prototype.Clone=function(){var t=this,o=new e(t.xc,t.hqa,t.iqa,t.xo);return g(t.Bqa)||(o.Bqa=t.Bqa.Clone()),g(t.tE)||(o.tE=t.tE.Clone()),o.oqa=t.oqa,o.dqa=t.dqa,o.mqa=t.mqa,o.sqa=t.sqa,o.wE=t.wE,o.wqa=t.wqa,o.Cqa=t.Cqa,o.Dqa=t.Dqa,o.Eqa=t.Eqa,o.Nc=t.Nc,o.nqa=t.nqa,o.fqa=t.fqa,o.yqa=t.yqa,o.kqa=t.kqa,o.zqa=t.zqa,o.Aqa=t.Aqa,o.Fqa=t.Fqa,o.lqa=t.lqa,o.Gqa=t.Gqa,o.bz=t.bz,o.rpa=t.rpa,o.hqa=t.hqa,o},e}(n.StatefullBase),e.FillFormat=b},"./dist/plugins/floatingObject/drawing/fontData.js":function(t,e,o){"use strict";var n,r,i,a,s,l;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/common.js"),r=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),i=o("./dist/plugins/floatingObject/drawing/colorData.js"),a=n.UnitHelper.isNullOrUndefined,function(t){t[t.None=0]="None",t[t.Color=1]="Color",t[t.Size=2]="Size",t[t.Name=4]="Name",t[t.Family=8]="Family",t[t.CharSet=16]="CharSet",t[t.Scheme=32]="Scheme",t[t.Bold=64]="Bold",t[t.Italic=128]="Italic",t[t.Underline=256]="Underline",t[t.Strike=512]="Strike",t[t.VertAlign=1024]="VertAlign",t[t.Shadow=2048]="Shadow",t[t.Outline=4096]="Outline",t[t.Condense=8192]="Condense",t[t.Extend=16384]="Extend",t[t.All=32767]="All"}(s||(s={})),l=function(){function t(){var t=this;t.Flag=s.None,t.Size=0,t.Family=0,t.CharSet=0,t.Scheme=r.ThemeFont.None,t.Underline=r.UnderlineType.None,t.VertAlign=r.VertAlignType.Baseline}return t.prototype.Equals=function(t){if(a(t))return!1;var e=this;return e.Size===t.Size&&e.Color.Equals(t.Color)&&e.Name===t.Name&&e.Family===t.Family&&e.CharSet===t.CharSet&&e.Scheme===t.Scheme&&e.Bold===t.Bold&&e.Italic===t.Italic&&e.Underline===t.Underline&&e.Strike===t.Strike&&e.VertAlign===t.VertAlign&&e.Shadow===t.Shadow&&e.Outline===t.Outline&&e.Condense===t.Condense&&e.Extend===t.Extend&&e.NotUsed===t.NotUsed},t.prototype.Clone=function(){var e=new t,o=this;return e.Color=o.Color,e.Size=o.Size,e.Name=o.Name,e.Family=o.Family,e.CharSet=o.CharSet,e.Scheme=o.Scheme,e.Bold=o.Bold,e.Italic=o.Italic,e.Underline=o.Underline,e.Strike=o.Strike,e.VertAlign=o.VertAlign,e.Shadow=o.Shadow,e.Outline=o.Outline,e.Condense=o.Condense,e.Extend=o.Extend,e.Flag=o.Flag,e.NotUsed=o.NotUsed,e},t.prototype.UpdateDefaultValueFlag=function(){var t=this,e=s.None;t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==i.ColorDataFlag.None&&(e|=s.Color),0!==t.Size&&(e|=s.Size),a(t.Name)||(e|=s.Name),0!==t.Family&&(e|=s.Family),0!==t.CharSet&&(e|=s.CharSet),t.Scheme!==r.ThemeFont.None&&(e|=s.Scheme),t.Bold&&(e|=s.Bold),t.Italic&&(e|=s.Italic),t.Underline!==r.UnderlineType.None&&(e|=s.Underline),t.Strike&&(e|=s.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(e|=s.VertAlign),t.Shadow&&(e|=s.Shadow),t.Outline&&(e|=s.Outline),t.Condense&&(e|=s.Condense),t.Extend&&(e|=s.Extend),t.Flag=e},t.prototype.UpdateFlagFromBottom=function(){var t=this;t.Color.UpdateFlagFromBottom(),t.Color.Flag===i.ColorDataFlag.None?t.Flag&=~s.Color:t.Flag|=s.Color},t.prototype.UpdateDefaultValueFlagForDxf=function(){var t=this,e=t.Flag,o=s.None;(e&s.Bold)===s.Bold&&(o|=s.Bold),(e&s.Italic)===s.Italic&&(o|=s.Italic),t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==i.ColorDataFlag.None&&(o|=s.Color),0!==t.Size&&(o|=s.Size),a(t.Name)||(o|=s.Name),0!==t.Family&&(o|=s.Family),0!==t.CharSet&&(o|=s.CharSet),t.Scheme!==r.ThemeFont.None&&(o|=s.Scheme),t.Underline!==r.UnderlineType.None&&(o|=s.Underline),t.Strike&&(o|=s.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(o|=s.VertAlign),t.Shadow&&(o|=s.Shadow),t.Outline&&(o|=s.Outline),t.Condense&&(o|=s.Condense),t.Extend&&(o|=s.Extend),t.Flag=o},t.prototype.Compose=function(t,e){void 0===e&&(e=!0),t.Flag!==s.None&&(e?this.ConflictCompose(t):this.NonConflictCompose(t))},t.prototype.ConflictCompose=function(t){var e=this,o=t.Flag;(o&s.Color)===s.Color&&e.Color.Compose(t.Color),(o&s.Size)===s.Size&&(e.Size=t.Size),(o&s.Name)===s.Name&&(e.Name=t.Name),(o&s.Family)===s.Family&&(e.Family=t.Family),(o&s.CharSet)===s.CharSet&&(e.CharSet=t.CharSet),(o&s.Scheme)===s.Scheme?e.Scheme=t.Scheme:(o&s.Name)===s.Name&&(e.Scheme=r.ThemeFont.None,o&=~s.Scheme),(o&s.Bold)===s.Bold&&(e.Bold=t.Bold),(o&s.Italic)===s.Italic&&(e.Italic=t.Italic),(o&s.Underline)===s.Underline&&(e.Underline=t.Underline),(o&s.Strike)===s.Strike&&(e.Strike=t.Strike),(o&s.VertAlign)===s.VertAlign&&(e.VertAlign=t.VertAlign),(o&s.Shadow)===s.Shadow&&(e.Shadow=t.Shadow),(o&s.Outline)===s.Outline&&(e.Outline=t.Outline),(o&s.Condense)===s.Condense&&(e.Condense=t.Condense),(o&s.Extend)===s.Extend&&(e.Extend=t.Extend),e.Flag|=o},t.prototype.NonConflictCompose=function(t){var e=this,o=e.Flag;e.Color.Compose(t.Color,!1),(o&s.Size)!==s.Size&&(e.Size=t.Size),(o&s.Name)!==s.Name&&(e.Name=t.Name),(o&s.Family)!==s.Family&&(e.Family=t.Family),(o&s.CharSet)!==s.CharSet&&(e.CharSet=t.CharSet),(o&s.Scheme)!==s.Scheme&&(e.Scheme=t.Scheme),(o&s.Bold)!==s.Bold&&(e.Bold=t.Bold),(o&s.Italic)!==s.Italic&&(e.Italic=t.Italic),(o&s.Underline)!==s.Underline&&(e.Underline=t.Underline),(o&s.Strike)!==s.Strike&&(e.Strike=t.Strike),(o&s.VertAlign)!==s.VertAlign&&(e.VertAlign=t.VertAlign),(o&s.Shadow)!==s.Shadow&&(e.Shadow=t.Shadow),(o&s.Outline)!==s.Outline&&(e.Outline=t.Outline),(o&s.Condense)!==s.Condense&&(e.Condense=t.Condense),(o&s.Extend)!==s.Extend&&(e.Extend=t.Extend),e.Flag|=t.Flag},t.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},t.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},t.prototype.Compare=function(t,e){var o,n,r,a=this,l=a.Flag,u=t.Flag,c=[],f=!1;if((l&s.Color)===s.Color&&((o=(u&s.Color)!==s.Color)||(e?(f=a.Color.RemoveDifferentStyle(t.Color),o=a.Color.Flag===i.ColorDataFlag.None):(f=a.Color.RemoveDuplicateStyle(t.Color),o=a.Color.Flag!==i.ColorDataFlag.None)),(e?o:!o)&&c.push(s.Color)),(l&s.Size)===s.Size&&(o=(u&s.Size)!==s.Size||a.Size!==t.Size,(e?o:!o)&&c.push(s.Size)),(l&s.Name)===s.Name&&(o=(u&s.Name)!==s.Name||a.Name!==t.Name,(e?o:!o)&&c.push(s.Name)),(l&s.Family)===s.Family&&(o=(u&s.Family)!==s.Family||a.Family!==t.Family,(e?o:!o)&&c.push(s.Family)),(l&s.CharSet)===s.CharSet&&(o=(u&s.CharSet)!==s.CharSet||a.CharSet!==t.CharSet,(e?o:!o)&&c.push(s.CharSet)),(l&s.Scheme)===s.Scheme&&(o=(u&s.Scheme)!==s.Scheme||a.Scheme!==t.Scheme,(e?o:!o)&&c.push(s.Scheme)),(l&s.Bold)===s.Bold&&(o=(u&s.Bold)!==s.Bold||a.Bold!==t.Bold,(e?o:!o)&&c.push(s.Bold)),(l&s.Italic)===s.Italic&&(o=(u&s.Italic)!==s.Italic||a.Italic!==t.Italic,(e?o:!o)&&c.push(s.Italic)),(l&s.Underline)===s.Underline&&(o=(u&s.Underline)!==s.Underline||a.Underline!==t.Underline,(e?o:!o)&&c.push(s.Underline)),(l&s.Strike)===s.Strike&&(o=(u&s.Strike)!==s.Strike||a.Strike!==t.Strike,(e?o:!o)&&c.push(s.Strike)),(l&s.VertAlign)===s.VertAlign&&(o=(u&s.VertAlign)!==s.VertAlign||a.VertAlign!==t.VertAlign,(e?o:!o)&&c.push(s.VertAlign)),(l&s.Shadow)===s.Shadow&&(o=(u&s.Shadow)!==s.Shadow||a.Shadow!==t.Shadow,(e?o:!o)&&c.push(~s.Shadow)),(l&s.Outline)===s.Outline&&(o=(u&s.Outline)!==s.Outline||a.Outline!==t.Outline,(e?o:!o)&&c.push(s.Outline)),(l&s.Condense)===s.Condense&&(o=(u&s.Condense)!==s.Condense||a.Condense!==t.Condense,(e?o:!o)&&c.push(s.Condense)),(l&s.Extend)===s.Extend&&(o=(u&s.Extend)!==s.Extend||a.Extend!==t.Extend,(e?o:!o)&&c.push(s.Extend)),(n=c.length)>0)for(f=!0,r=0;r<n;r++)l&=~c[r];return a.Flag=l,f},t.prototype.ClearFlag=function(){this.Color.ClearFlag(),this.Flag=s.None},t.prototype.SetFullFlag=function(){this.Color.SetFullFlag(),this.Flag=s.All},t.prototype.IsFullFlag=function(){return this.Flag===s.All&&this.Color.IsFullFlag()},t}(),e.FontData=l},"./dist/plugins/floatingObject/drawing/fontFormat.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./dist/plugins/floatingObject/drawing/stateful.js"),i=o("./dist/plugins/floatingObject/drawing/common.js"),a=o("./dist/plugins/floatingObject/drawing/fillFormat.js"),s=o("./dist/plugins/floatingObject/drawing/fontData.js"),l=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=n.Common.j,c=u.za,f=i.ChartUtility,h=f.umb,p=i.ChartConstants,d=i.UnitHelper,g=d.isNullOrUndefined,m=null,y=void 0,C=function(){function t(t){this.Hpa=t}return Object.defineProperty(t.prototype,"Formula",{get:function(){return this.GetFormula(!1)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormulaR1C1",{get:function(){return this.GetFormula(!0)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Parent",{get:function(){return this.Hpa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ReferingText",{get:function(){return this.GetReferingText()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Worksheet",{get:function(){return this.Hpa.sheet()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TextRefer",{get:function(){return this.Ipa},set:function(t){this.SetTextRefer(t)},enumerable:!0,configurable:!0}),t.prototype.SetTextRefer=function(t,e){e===y&&(e=!0),this.SetTextReferInternal(t,e),this.OnSetTextRefer(t)},t.prototype.OnSetTextRefer=function(t){},t.prototype.GetReferingText=function(){var t,e,o="";if(!g(this.Ipa))for(t=0,e=this.GetTextList(this.Ipa);t<e.length;t++)o+=e[t];return o},t.prototype.GetTextList=function(t){var e,o,n,r,i=[],a=this.Worksheet;for(g(t.WorksheetName)&&(t.WorksheetName=a.name()),e=a.Apa(t.WorksheetName),o=t.Row;o<=t.LastRow;o++)for(n=t.Column;n<=t.LastColumn;n++)r=e.Jpa(o,n).Text,i.push(g(r)?"":r);return i},t.prototype.SetTextReferInternal=function(t,e){this.Ipa=t},t.prototype.GetFormula=function(t){var e,o;return t===y&&(t=!1),(e=this.Ipa)?(o=this.Worksheet.name(),t?e.ToR1C1Text(o):e.ToA1Text(0,0,o)):""},t.prototype.UpdateTextByFormulas=function(t,e){var o;e===y&&(e=!1),o=this.Worksheet.Kpa(t,0,0,e).references,this.Ipa=o?o[0]:m},t}(),e.ReferenceText=C,v=function(t){function e(e,o,n,r){var i,a=t.call(this,e)||this;return o===y&&(o=m),n===y&&(n=m),r===y&&(r=m),(i=a).Lpa=m,i.Mpa=m,i.Npa=n||"",i.Opa=r,i.InitRichTextFields(o),a}return N(e,t),e.prototype.InitRichTextFields=function(t){var e=this,o=new R(e.Hpa,e.Opa);g(e.Lpa)||e.Lpa.Font.SetParentForChildren(o.Font),e.Lpa=o,e.Lpa.Font.ParentStateful=t,g(e.Npa)||e.Lpa.AddParagraph(e.Npa)},Object.defineProperty(e.prototype,"TextBody",{get:function(){return this.Lpa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Font",{get:function(){return this.Lpa.Font},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return g(this.TextRefer)?this.Lpa.Text:this.ReferingText},set:function(t){this.SetTextInternal(t)},enumerable:!0,configurable:!0}),e.prototype.SetTextInternal=function(t){this.SetTextReferInternal(m),this.UpdateTextBody(t)},e.prototype.UpdateTextBody=function(t){this.Lpa.Clear();var e=g(t)?this.Npa:t;g(e)||this.Lpa.AddParagraph(e)},e.prototype.OnSetTextRefer=function(e){t.prototype.OnSetTextRefer.call(this,e),this.UpdateTextBody(m)},e.prototype.FromOOModel=function(t){var e=this;e.Mpa=t,e.InitRichTextFields(e.Lpa.Font.ParentStateful),g(t.rich)||e.Lpa.FromOOModel(t.rich),!g(t.strRef)&&t.strRef.f&&e.UpdateTextByFormulas(t.strRef.f)},e.prototype.ToOOModel=function(t){var e=this,o=g(e.Mpa)?{}:e.Mpa;return g(e.Ipa)?o.rich=this.Lpa.ToOOModel(t):(o.strRef={f:e.Formula},o.rich=e.Lpa.ToOOModel(t)),o},e.prototype.SetParagraphSplitFlag=function(t){var e,o,n=this.Lpa;for(e=0,o=n.Count;e<o;e++)n.Get(e).SplitSpaceFlag=t},e.prototype.UpdateFiledElementTextLink=function(t){var e,o,n,r,i,a,s=this.Lpa;for(e=0,o=s.Count;e<o;e++)for(r=0,i=(n=s.Get(e)).Count;r<i;r++)if(a=n.Get(r),!g(a)&&a.Type===l.TextFieldType.TxLink)return void a.UpdateTextByFormulas(t)},e}(C),e.DrawingText=v,b={Bold:1,Color:2,Italic:4,Name:8,OutlineFont:16,Shadow:32,Size:64,Strikethrough:128,Subscript:256,Superscript:512,ThemeFont:1024,Underline:2048},w=function(t){function e(e,o,n){var r;return o===y&&(o=m),n===y&&(n=m),(r=t.call(this,o)||this).Ora=l.ThemeFont.None,r.Pra=m,r.Qra=m,r.Rra=m,r.xc=e,r.Zpa=new a.FillFormat(e,o&&o.FillInternal),r.hqa=o,n&&(g(n.Size)||(r.Oz=n.Size),g(n.Bold)||(r.Sra=n.Bold)),r}return N(e,t),Object.defineProperty(e.prototype,"Bold",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Bold)?t.Bold:this.Sra},set:function(t){this.Sra=t,this.SetState(b.Bold,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.FillInternal.Color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Italic",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Italic)?t.Italic:this.Tra},set:function(t){this.Tra=t,this.SetState(b.Italic,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){var t=this.hqa;return t&&!this.HasOwnFont()?t.Name:this.GetOwnFont()},set:function(t){this.SetFont(t),this.ClearOOFontNames()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Size)?t.Size:this.Oz},set:function(t){this.Oz=t,this.SetState(b.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Strikethrough",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Strikethrough)?t.Strikethrough:this.Ura},set:function(t){this.Ura=t,this.SetState(b.Strikethrough,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Subscript",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Subscript)?t.Subscript:this.Vra},set:function(t){this.Vra=t,this.SetState(b.Subscript,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Superscript",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Superscript)?t.Superscript:this.Wra},set:function(t){this.Wra=t,this.SetState(b.Superscript,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Underline",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Underline)?t.Underline:this.Xra},set:function(t){this.Xra=t,this.SetState(b.Underline,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ThemeFont",{get:function(){var t=this.hqa;return t&&!this.GetState(b.ThemeFont)?t.ThemeFont:this.Ora},set:function(t){this.SetThemeFont(t),this.ClearOOFontNames()},enumerable:!0,configurable:!0}),e.prototype.IsDirtyIncludingParent=function(e){return!(!this.Zpa||!this.Zpa.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},e.prototype.HasOwnFont=function(){return this.IsDirty(b.Name)||this.IsDirty(b.ThemeFont)},e.prototype.OnParentChanged=function(t){this.hqa=t,this.Zpa&&(this.Zpa.ParentStateful=t&&t.FillInternal)},e.prototype.GetOwnFont=function(){return this.Ora===l.ThemeFont.None?this.Cj:this.xc.Yra(this.Ora)},e.prototype.SetFont=function(t){var e=this;t===p.CHART_CS_HEAD_FONT||t===p.CHART_EA_HEAD_FONT||t===p.CHART_LATIN_HEAD_FONT?e.SetThemeFont(l.ThemeFont.Major):t===p.CHART_CS_BODY_FONT||t===p.CHART_EA_BODY_FONT||t===p.CHART_LATIN_BODY_FONT?e.SetThemeFont(l.ThemeFont.Minor):(e.Cj=t,e.SetState(b.Name,!0),e.Ora=l.ThemeFont.None,e.SetState(b.ThemeFont,!1))},e.prototype.SetThemeFont=function(t){var e=this;e.Ora=t,e.SetState(b.ThemeFont,!0),e.Cj=m,e.SetState(b.Name,!1)},e.prototype.ClearOOFontNames=function(){this.Qra=m,this.Rra=m,this.Pra=m},e.prototype.GetActualFormat=function(){var t,o,n=new e(this.xc);for(t in b)if(o=b[t],this.IsDirty(o))switch(o){case b.Bold:n.Bold=this.Bold;break;case b.Italic:n.Italic=this.Italic;break;case b.Name:n.Name=this.Name;break;case b.Size:n.Size=this.Size;break;case b.Strikethrough:n.Strikethrough=this.Strikethrough;break;case b.Subscript:n.Superscript=this.Superscript;break;case b.Superscript:n.Subscript=this.Subscript;break;case b.ThemeFont:n.ThemeFont=this.ThemeFont;break;case b.Underline:n.Underline=this.Underline}return n},Object.defineProperty(e.prototype,"FillInternal",{get:function(){var t=this;return t.Zpa||(t.Zpa=new a.FillFormat(t.xc,t.hqa&&t.hqa.FillInternal)),t.Zpa},enumerable:!0,configurable:!0}),e.prototype.TextCharacterProperties_FromOOModel=function(t){var e,o=this;o.SuspendClearChildrenState(),o.Zra=t,g(t.latin)||(o.Qra=t.latin.typeface),g(t.ea)||(o.Pra=t.ea.typeface),g(t.cs)||(o.Rra=t.cs.typeface),o.Qra?o.SetFont(o.Qra):o.Pra?o.SetFont(o.Pra):o.Rra&&o.SetFont(o.Rra),g(t.sz)||(e=t.sz,o.Oz!==e&&(o.Size=e)),g(t.b)||(o.Bold=t.b),g(t.i)||(o.Italic=t.i),g(t.strike)||(o.Strikethrough=t.strike===l.ST_TextStrikeType.sngStrike||t.strike===l.ST_TextStrikeType.dblStrike),g(t.u)||(o.Underline=t.u),g(t.baseline)||0===t.baseline?o.Subscript=!1:o.Subscript=!0,g(t.solidFill)?g(t.noFill)?g(t.blipFill)?g(t.gradFill)?g(t.pattFill)?o.SetFillField(m):o.FillInternal.FromOOModel(t.pattFill,l.ColorFillType.PatternFillProperties):o.FillInternal.FromOOModel(t.gradFill,l.ColorFillType.GradientFillProperties):o.FillInternal.FromOOModel(t.blipFill,l.ColorFillType.BlipFillProperties):o.FillInternal.Color.ColorType=l.SolidColorType.None:o.FillInternal.FromOOModel(t.solidFill,l.ColorFillType.SolidColorFillProperties),o.ResumeClearChilrenState()},e.prototype.AdjustStateful=function(t,e){g(t)||(t.SetParentForChildren(e),g(e)||(e.ParentStateful=t.ParentStateful),t.ParentStateful=m)},e.prototype.SetFillField=function(t){this.AdjustStateful(this.Zpa,t),this.Zpa=t},e.prototype.TextCharacterProperties_ToOOModel=function(){var t,e,o,n,r=this;return r.IsDirtyIncludingParent(!0)?(t=r.Zra||{},r.IsPropDirtyIncludingParent(b.Name,!0)?(e=r.Name,g(t.latin)&&(t.latin={}),t.latin.typeface=e):r.IsPropDirtyIncludingParent(b.ThemeFont,!0)&&r.ThemeFont!==l.ThemeFont.None?(g(t.latin)&&(t.latin={}),t.latin.typeface=r.ThemeFont===l.ThemeFont.Major?p.CHART_LATIN_HEAD_FONT:p.CHART_LATIN_BODY_FONT):(r.Qra||r.Pra||r.Rra)&&(r.Qra&&(g(t.latin)&&(t.latin={}),t.latin.typeface=r.Qra),r.Pra&&(g(t.ea)&&(t.ea={}),t.ea.typeface=r.Pra),r.Rra&&(g(t.cs)&&(t.cs={}),t.cs.typeface=r.Rra)),r.IsPropDirtyIncludingParent(b.Size,!0)&&r.Size>1?t.sz=r.Size:delete t.sz,r.IsPropDirtyIncludingParent(b.Bold,!0)&&(t.b=r.Bold),r.IsPropDirtyIncludingParent(b.Italic,!0)&&(t.i=r.Italic),r.IsPropDirtyIncludingParent(b.Strikethrough,!0)&&(t.strike=r.Strikethrough?l.ST_TextStrikeType.sngStrike:l.ST_TextStrikeType.noStrike),r.IsPropDirtyIncludingParent(b.Underline,!0)&&(t.u=r.Underline),r.Subscript&&g(t.baseline)?t.baseline=-25e3:r.Superscript&&g(t.baseline)?t.baseline=3e4:r.Subscript||r.Superscript||delete t.baseline,h(t),!g(r.Zpa)&&r.Zpa.IsDirtyIncludingParent(!0)&&((n=(o=r.Zpa.ToOOModel()).colorFillType)===l.ColorFillType.SolidColorFillProperties?t.solidFill=o:n===l.ColorFillType.PatternFillProperties?t.pattFill=o:n===l.ColorFillType.GradientFillProperties?t.gradFill=o:n===l.ColorFillType.BlipFillProperties?t.blipFill=o:n===l.ColorFillType.NoFillProperties&&(t.noFill=!0),delete o.colorFillType),t):{}},e.prototype.FromOOModel=function(t){var e=this;e.Bold=t.Bold,e.Italic=t.Italic,e.Name=t.Name,t.Scheme!==l.ThemeFont.None&&(e.ThemeFont=t.Scheme),e.Size=t.Size,e.Underline=f.ConvertToTextUnderlineType(t.Underline),e.Strikethrough=t.Strike,e.Subscript=(t.VertAlign&l.VertAlignType.Subscript)===l.VertAlignType.Subscript,e.Superscript=(t.VertAlign&l.VertAlignType.Superscript)===l.VertAlignType.Superscript,e.FillInternal.ColorInternal.ColorData_FromOOModel(t.Color)},e.prototype.ToOOModel=function(){var t,e=this,o=new s.FontData;return o.Bold=e.Bold,o.Italic=e.Italic,o.Name=e.Name,o.Scheme=e.ThemeFont,o.Size=e.Size,o.Underline=f.ToUnderlineType(e.Underline),o.Strike=e.Strikethrough,e.Subscript?o.VertAlign=l.VertAlignType.Subscript:e.Superscript&&(o.VertAlign=l.VertAlignType.Superscript),(t=e.Zpa)&&t.ColorInternal.IsDirtyIncludingParent(!0)&&t.ColorInternal.ColorType!==l.SolidColorType.None&&(o.Color=t.ColorInternal.ColorData_ToOOModel()),o},e}(r.StatefullBase),e.FontFormat=w,T=function(){function t(t,e){var o=this;o.xc=t,o.$ra=e,o._font=new w(t),o._font.ParentStateful=e.Font}return Object.defineProperty(t.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsCustomText",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.Delete=function(){this.$ra.DeleteElement(this),this.$ra=m},t.prototype.FromOOModel=function(t){},t.prototype.ToOOModel=function(){},t}(),e.DrawingTextElement=T,S=function(t){function e(e,o,n){var r=t.call(this,e,n)||this,i=r;return i._ra=m,i._text=o,i.xc=e,i.elementType=l.TextParagraphElementType.RegularTextRun,r}return N(e,t),Object.defineProperty(e.prototype,"Text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){var e=this;e._ra=t,e._text=t.t,g(t.rPr)?e._font=new w(e.xc,e._font.ParentStateful):e._font.TextCharacterProperties_FromOOModel(t.rPr)},e.prototype.ToOOModel=function(){var t=this._ra||{elementType:l.TextParagraphElementType.RegularTextRun};return t.t=this.Text,t.rPr=this._font.TextCharacterProperties_ToOOModel(),t},e}(T),e.DrawingTextRun=S,x=function(t){function e(e,o,n){var r=t.call(this,e,n)||this,i=r;return i.Nc=o,i.Hpa=e,i.asa=new C(i.Hpa),i.elementType=l.TextParagraphElementType.TextField,r}return N(e,t),Object.defineProperty(e.prototype,"Type",{get:function(){return this.Nc},set:function(t){this.Nc=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.Type===l.TextFieldType.TxLink?this.asa.ReferingText:f.GetTextFieldTypeText(this.Type)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Worksheet",{get:function(){return this.Hpa&&this.Hpa.Parent},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){var e=this;e.Lqa=t,e.Type=f.GetTextFieldType(t.type),g(t.rPr)?e._font=new w(e.xc,e._font.ParentStateful):e._font.TextCharacterProperties_FromOOModel(t.rPr)},e.prototype.kLb=function(){return("{"+this.lLb(8)+"-"+this.lLb(4)+"-"+this.lLb(4)+"-"+this.lLb(4)+"-"+this.lLb(12)+"}").toUpperCase()},e.prototype.lLb=function(t){return Math.random().toString(16).slice(-t)},e.prototype.ToOOModel=function(){var t=this,e=t.Lqa||{elementType:l.TextParagraphElementType.TextField};return(g(e.id)||e.id&&!/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/.test(e.id))&&(e.id=this.kLb()),e.type=f.GetTextFieldTypeString(t.Type),g(e.rPr)&&(e.rPr={}),e.rPr=t._font.TextCharacterProperties_ToOOModel(),e.t=t.Text,e},e.prototype.UpdateTextByFormulas=function(t,e){this.asa.UpdateTextByFormulas(t,e)},e}(T),e.DrawingTextField=x,A=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.elementType=l.TextParagraphElementType.TextLineBreak,n}return N(e,t),Object.defineProperty(e.prototype,"Text",{get:function(){return"\r\n"},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa||{elementType:l.TextParagraphElementType.TextLineBreak}},e}(T),e.DrawingLineBreak=A,I=function(){function t(t,e){var o=this;o.bsa=m,o.csa=" ",o.xc=t,o.Lpa=e,o._font=new w(t),o._font.ParentStateful=o.Lpa.Font,o.rM=[]}return Object.defineProperty(t.prototype,"SplitSpaceFlag",{get:function(){return this.csa},set:function(t){this.csa=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){var t,e,o,n="";for(t=0,e=this.rM;t<e.length;t++)o=e[t],g(o.Text)||(n+=o.Text);return n},set:function(t){this.Clear(),this.AddRun(t)},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){return this.rM[t]},Object.defineProperty(t.prototype,"Count",{get:function(){return this.rM.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),t.prototype.AddRun=function(t,e){return this.AddRunInternal(t,e)},t.prototype.AddField=function(t){return this.AddFieldInternal(t)},t.prototype.Clear=function(){var t,e;for(t=0,e=this.rM;t<e.length;t++)e[t].Font.ParentStateful=m;this.rM.length=0},t.prototype.FromOOModel=function(t){var e,o,n,r,i,a,s,u=this;if(u.bsa=t,t.pPr&&t.pPr.defRPr&&u._font.TextCharacterProperties_FromOOModel(t.pPr.defRPr),t.elements)for(e=t.elements.length,o=u.rM=[],n=u.xc,r=0;r<e;r++)s=void 0,(a=(i=t.elements[r]).elementType)===l.TextParagraphElementType.RegularTextRun?s=new S(n,i.t,u):a===l.TextParagraphElementType.TextLineBreak?s=new A(n,u):a===l.TextParagraphElementType.TextField&&(s=new x(n,f.GetTextFieldType(i.type),u)),s&&(s.FromOOModel(i),o.push(s))},t.prototype.AddRunInternal=function(t,e){var o,n;return e===y&&(e=-1),o=new S(this.xc,t,this),n=this.rM,e<0||e>=n.length?n.push(o):n.splice(e,0,o),o},t.prototype.AddFieldInternal=function(t){var e=new x(this.xc,t,this);return this.rM.push(e),e},t.prototype.ToOOModel=function(){var t,e,o,n,r,i=this,a=i.bsa||{elements:[]};for(a.pPr||(a.pPr={}),t=a.pPr,g(i._font)||(t.defRPr=i._font.TextCharacterProperties_ToOOModel()),e=a.elements=[],o=0,r=(n=i.rM).length;o<r;o++)e.push(n[o].ToOOModel());return(i.xc.DrawingType===l.DrawingType.Chart||g(i.bsa))&&g(a.endParaRPr)&&(a.endParaRPr={}),a},t.prototype.To2016ChartOOModel=function(){var t,e,o,n,r,i=this,a=i.bsa||{elements:[]};for(a.pPr||(a.pPr={}),t=a.pPr,g(i._font)||(t.defRPr=i._font.TextCharacterProperties_ToOOModel()),e=a.elements=[],o=0,r=(n=i.rM).length;o<r;o++)e.push(n[o].ToOOModel());return g(i._font)||(a.endParaRPr=i._font.TextCharacterProperties_ToOOModel()),a},t.prototype.Delete=function(){var t,e=this;for(t=e.rM.length-1;t>=0;t--)e.DeleteElement(e.rM[t]);e.Lpa.DeleteParagraph(e),e.Lpa=m},t.prototype.DeleteElement=function(t){t.Font.ParentStateful=m;var e=this.rM.indexOf(t);e>=0&&this.rM.splice(e,1)},t}(),e.DrawingTextParagraph=I,R=function(){function t(t,e){this.dsa=[],this.esa=m,this.xc=t,this.Opa=e,this._font=new w(t,m,e),this.kO=void 0}return Object.defineProperty(t.prototype,"Text",{get:function(){var t,e,o="";for(t=0,e=this.dsa;t<e.length;t++)""!==o&&(o+="\r\n"),o+=e[t].Text;return o},set:function(t){this.Clear(),this.AddParagraph(t)},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){return this.dsa[t]},Object.defineProperty(t.prototype,"Count",{get:function(){return this.dsa.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rotation",{get:function(){return this.kO},set:function(t){this.kO=t},enumerable:!0,configurable:!0}),t.prototype.setFontColor=function(t,e){var o,n=this,r=n.dsa.length;for(n._font&&n._font.Color.setColor(t,e),o=0;o<r;o++)n.dsa[o].Font.Color.setColor(t,e)},t.prototype.setFontTransparency=function(t){var e,o=this,n=o.dsa.length;for(o._font&&(o._font.Color.Transparency=t),e=0;e<n;e++)o.dsa[e].Font.Color.Transparency=t},t.prototype.updateFont=function(t,e,o,n){var r=[this._font];this.dsa.forEach((function(t){r.push(t.Font)})),r.forEach((function(r){r&&(r.Name=t,r.Size=e,r.Bold=o,r.Italic=n)}))},t.prototype.AddParagraph=function(t,e){var o,n;return e===y&&(e=-1),o=new I(this.xc,this),g(t)||o.AddRun(t),n=this.dsa,e<0||e>=n.length?n.push(o):n.splice(e,0,o),o},t.prototype.Clear=function(){var t,e;for(t=0,e=this.dsa;t<e.length;t++)e[t].Font.ParentStateful=m;this.dsa.length=0},t.prototype.ToOOModel=function(t){var e,o,n,r,i,a=this,s=a.esa||{p:[]},l=this.dsa,u=l.length;if(0===u&&!this._font.IsDirtyIncludingParent())return m;if(e=s.p=[],u>0)for(o=0;o<u;o++)n=l[o],e.push(t?n.To2016ChartOOModel():n.ToOOModel());else(r=new I(a.xc,a).ToOOModel()).pPr.defRPr=a._font.TextCharacterProperties_ToOOModel(),e.push(r);return g(s.bodyPr)&&(s.bodyPr={}),i=this.Rotation,g(i)||(s.bodyPr.rot=i),g(s.lstStyle)&&(s.lstStyle={}),s},t.prototype.FromOOModel=function(t){var e,o,n,r,i,a,s,l,u,f,h,p,d,y,C=this;for(C.esa=t,e=0,o=C.dsa;e<o.length;e++)o[e].Clear();if(C.dsa.length=0,n=new w(C.xc,m,C.Opa),(r=C._font)&&(r.SetParentForChildren(n),n.ParentStateful=r.ParentStateful,r.ParentStateful=m),C._font=n,t.p&&t.p.length)for(i=t.p[0].pPr,a=t.p[0].elements&&t.p[0].elements[0]&&t.p[0].elements[0].rPr,s=t.p[0].endParaRPr,l=void 0,i&&i.defRPr&&!c(i.defRPr)?(l=i.defRPr,a&&!c(a.solidFill)&&(l=a)):s&&!c(s)&&(l=s),l&&C._font.TextCharacterProperties_FromOOModel(l),u=0,f=t.p;u<f.length;u++)h=f[u],(p=new I(C.xc,C)).FromOOModel(h),C.dsa.push(p);(d=t.bodyPr)&&(y=d.rot,g(y)||(this.kO=y))},t.prototype.Delete=function(){for(var t=this.dsa,e=t.length-1;e>=0;e--)this.DeleteParagraph(t[e])},t.prototype.DeleteParagraph=function(t){t.Font.ParentStateful=m;var e=this.dsa.indexOf(t);e>=0&&this.dsa.splice(e,1)},t}(),e.DrawingTextBody=R,M=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.Format1=e,r.Format2=o,n}return N(e,t),Object.defineProperty(e.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Brightness",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.Brightness,!1)?t.Format2.Brightness:t.Format1.Brightness},set:function(t){this.Format1.Brightness=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorType",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.ColorType,!1)?t.Format2.ColorType:t.Format1.ColorType},set:function(t){this.Format1.ColorType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ObjectThemeColor",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.ObjectThemeColor,!1)?t.Format2.ObjectThemeColor:t.Format1.ObjectThemeColor},set:function(t){this.Format1.ObjectThemeColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RGB",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.RGB,!1)?t.Format2.RGB:t.Format1.RGB},set:function(t){this.Format1.RGB=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TintAndShade",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.TintAndShade,!1)?t.Format2.TintAndShade:t.Format1.TintAndShade},set:function(t){this.Format1.TintAndShade=t},enumerable:!0,configurable:!0}),e.prototype.GetState=function(){},e.prototype.SetState=function(){},e.prototype.IsDirtyIncludingParent=function(){},e.prototype.IsPropDirtyIncludingParent=function(t,e){return this.Stateful1.IsPropDirtyIncludingParent(t,e)||this.Stateful2.IsPropDirtyIncludingParent(t,e)},e.prototype.Dirty=function(){},e.prototype.UnDirty=function(){},e.prototype.SuspendClearChildrenState=function(){},e.prototype.ResumeClearChilrenState=function(){},e.prototype.AddChildInternal=function(){},e.prototype.RemoveChildInternal=function(){},e}(r.StatefullBase),e.ComboColorFormat=M,k=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.Format1=e,r.Format2=o,n}return N(e,t),Object.defineProperty(e.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Bold",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Bold,!1)?t.Format2.Bold:t.Format1.Bold},set:function(t){this.Format1.Bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return new M(this.Format1.Color,this.Format2.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Italic",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Italic,!1)?t.Format2.Bold:t.Format1.Bold},set:function(t){this.Format1.Bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Name,!1)?t.Format2.Name:t.Format1.Name},set:function(t){this.Format1.Name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Size,!1)?t.Format2.Size:t.Format1.Size},set:function(t){this.Format1.Size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Strikethrough",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Strikethrough,!1)?t.Format2.Strikethrough:t.Format1.Strikethrough},set:function(t){this.Format1.Strikethrough=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Subscript",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Subscript,!1)?t.Format2.Subscript:t.Format1.Subscript},set:function(t){this.Format1.Subscript=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Superscript",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Superscript,!1)?t.Format2.Superscript:t.Format1.Superscript},set:function(t){this.Format1.Superscript=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ThemeFont",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.ThemeFont,!1)?t.Format2.ThemeFont:t.Format1.ThemeFont},set:function(t){this.Format1.ThemeFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Underline",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Underline,!1)?t.Format2.Underline:t.Format1.Underline},set:function(t){this.Format1.Underline=t},enumerable:!0,configurable:!0}),e.prototype.GetState=function(){},e.prototype.SetState=function(){},e.prototype.IsDirtyIncludingParent=function(){},e.prototype.IsPropDirtyIncludingParent=function(t,e){return this.Stateful1.IsPropDirtyIncludingParent(t,e)||this.Stateful2.IsPropDirtyIncludingParent(t,e)},e.prototype.Dirty=function(){},e.prototype.UnDirty=function(){},e.prototype.SuspendClearChildrenState=function(){},e.prototype.ResumeClearChilrenState=function(){},e.prototype.AddChildInternal=function(){},e.prototype.RemoveChildInternal=function(){},e}(r.StatefullBase),e.ComboFontFormat=k},"./dist/plugins/floatingObject/drawing/gradient.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f;function h(t,e,o){var n=new c(t);return n.Position=e,n.Color=o,n}function p(t){return r.ARGBColor.FromArgb(t)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/common.js"),r=o("./dist/plugins/floatingObject/drawing/color.js"),i=o("./dist/plugins/floatingObject/drawing/colorFormat.js"),a=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),s=n.ShapeConstants.PositionConver,l=n.ShapeUtility,u=void 0,c=function(){function t(t){this.nzb=t,this.tE=new i.ColorFormat(this.nzb)}return Object.defineProperty(t.prototype,"Color",{get:function(){return this.tE},set:function(t){this.tE=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Position",{get:function(){return this.SH},set:function(t){this.SH=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Transparency",{get:function(){return this.tE.Transparency},set:function(t){this.tE.Transparency=t},enumerable:!0,configurable:!0}),t.prototype.FromOOModel=function(t){this.Position=t.pos/s,this.tE.FromOOModel(t)},t.prototype.ToOOModel=function(){var t=this.tE.ToOOModel();return t.pos=Math.round(this.Position*s),t},t}(),e.GradientStop=c,f=function(){function t(t){this.Nqa=t,this.Oqa=[]}return t.prototype.Item=function(t){return this.Oqa[t]},Object.defineProperty(t.prototype,"Count",{get:function(){return this.Oqa.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GradientStopList",{get:function(){return this.Oqa},enumerable:!0,configurable:!0}),t.prototype.Delete=function(t){-1===t&&(t=this.Count-1),this.Oqa.splice(t,1)},t.prototype.Insert=function(t,e,o,n,i){o===u&&(o=0),n===u&&(n=-1),i===u&&(i=0);var a=new c(this.Nqa);a.Color.RGB=r.ARGBColor.FromArgb(t),a.Position=e,a.Transparency=o,a.Color.Brightness=i,n<0?this.Oqa.push(a):this.Oqa.splice(n,0,a)},t.prototype.FromOOModel=function(t){var e,o,n,r;for(e=0,o=t.gs;e<o.length;e++)n=o[e],(r=new c(this.Nqa)).FromOOModel(n),this.GradientStopList.push(r)},t.prototype.ToOOModel=function(){var t,e,o,n={gs:[]};for(t=0,e=this.Oqa;t<e.length;t++)o=e[t],n.gs.push(o.ToOOModel());return n},t}(),e.GradientStops=f,l.InitGradientStopPresetColor=function(t,e){var o,n,r,s,l,u,c,f,d,g,m,y,C,v=e.GradientStops.GradientStopList;switch(e.PresetGradientType){case a.PresetGradientType.GradientEarlySunset:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),n=h(t,.3,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6684815))),r=h(t,.64999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12189798))),s=h(t,.89999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16711680))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16744960))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l);break;case a.PresetGradientType.GradientLateSunset:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(0))),n=h(t,.2,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(64))),r=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(4194368))),s=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(9371712))),l=h(t,.89999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15889152))),u=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16760576))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u);break;case a.PresetGradientType.GradientNightfall:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(0))),n=h(t,.39999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(660108))),r=h(t,.7,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1580231))),s=h(t,.88,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(7341524))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(9190801))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l);break;case a.PresetGradientType.GradientDaybreak:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6201087))),n=h(t,.39999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8766207))),r=h(t,.7,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12900075))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16772090))),v.push(o),v.push(n),v.push(r),v.push(s);break;case a.PresetGradientType.GradientHorizon:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14478325))),n=h(t,.08,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8628163))),r=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(7770041))),s=h(t,.21001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8628163))),l=h(t,.52,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),u=h(t,.56,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10249571))),c=h(t,.58,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8400941))),f=h(t,.71001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12603982))),d=h(t,.94,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15456980))),g=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(5580316))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f),v.push(d),v.push(g);break;case a.PresetGradientType.GradientDesert:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16555979))),n=h(t,.87,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16298057))),r=h(t,.78999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16298057))),s=h(t,.37,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16705522))),l=h(t,.33,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16339616))),u=h(t,.31,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12912713))),c=h(t,.17999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(11812485))),f=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16298057))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f);break;case a.PresetGradientType.GradientOcean:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(251048))),n=h(t,.25,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2217696))),r=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(34790))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(23743))),v.push(o),v.push(n),v.push(r),v.push(s);break;case a.PresetGradientType.GradientCalmWater:o=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13421823))),n=h(t,.41001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),r=h(t,.32,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10053375))),s=h(t,.195,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13408767))),l=h(t,.8999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),u=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13421823))),c=h(t,.59,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),f=h(t,.68,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10053375))),d=h(t,.805,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13408767))),g=h(t,.91001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),m=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13421823))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f),v.push(d),v.push(g),v.push(m);break;case a.PresetGradientType.GradientFire:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16773632))),n=h(t,.45,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16742912))),r=h(t,.7,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16712448))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(5048328))),v.push(o),v.push(n),v.push(r),v.push(s);break;case a.PresetGradientType.GradientFog:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8685764))),n=h(t,.53,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13950719))),r=h(t,.83,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13950719))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(9874324))),v.push(o),v.push(n),v.push(r),v.push(s);break;case a.PresetGradientType.GradientMoss:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14543823))),n=h(t,.25,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10270830))),r=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1403667))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14543823))),l=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10270830))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l);break;case a.PresetGradientType.GradientPeacock:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3381759))),n=h(t,.16,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(52428))),r=h(t,.47,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10066431))),s=h(t,.60001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3041170))),l=h(t,.71001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3355596))),u=h(t,.81,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1143039))),c=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(26265))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c);break;case a.PresetGradientType.GradientWheat:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16509639))),n=h(t,.17999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16705522))),r=h(t,.36,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16435069))),s=h(t,.61,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16492925))),l=h(t,.82001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16503964))),u=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16705522))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u);break;case a.PresetGradientType.GradientParchment:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16773073))),n=h(t,.64999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15789013))),r=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13747103))),v.push(o),v.push(n),v.push(r);break;case a.PresetGradientType.GradientMahogany:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14070172))),n=h(t,.15,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13934188))),r=h(t,.35,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10900776))),s=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6696978))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14070172))),u=h(t,.85,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13934188))),c=h(t,.65,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10900776))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c);break;case a.PresetGradientType.GradientRainbow:o=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10879915))),n=h(t,.395,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(530939))),r=h(t,.32499,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1740104))),s=h(t,.24,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16776960))),l=h(t,.135,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15613719))),u=h(t,.6,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15210342))),c=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10879915))),f=h(t,.60501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(530939))),d=h(t,.67501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1740104))),g=h(t,.76,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16776960))),m=h(t,.865,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15613719))),y=h(t,.94,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15210342))),C=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10879915))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f),v.push(d),v.push(g),v.push(m),v.push(y),v.push(C);break;case a.PresetGradientType.GradientRainbowII:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16724889))),n=h(t,.25,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16737843))),r=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16776960))),s=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(108431))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3368703))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l);break;case a.PresetGradientType.GradientGold:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15129772))),n=h(t,.12,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15128458))),r=h(t,.3,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13085772))),s=h(t,.45,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15128458))),l=h(t,.77,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13085772))),u=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15129772))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u);break;case a.PresetGradientType.GradientGoldII:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16508078))),n=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12423722))),r=h(t,.21001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12423722))),s=h(t,.63,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16508078))),l=h(t,.67,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12423722))),u=h(t,.69,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8609303))),c=h(t,.82001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10651977))),f=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16442295))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f);break;case a.PresetGradientType.GradientBrass:o=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),n=h(t,.87,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),r=h(t,.72,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),s=h(t,.57001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),l=h(t,.42,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),u=h(t,.28,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),c=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),f=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f);break;case a.PresetGradientType.GradientChrome:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),n=h(t,.16,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2039583))),r=h(t,.17999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),s=h(t,.42,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6513507))),l=h(t,.53,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13619151))),u=h(t,.66,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13619151))),c=h(t,.75999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2039583))),f=h(t,.78999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),d=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8355711))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f),v.push(d);break;case a.PresetGradientType.GradientChromeII:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13355979))),n=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6250335))),r=h(t,.21001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6250335))),s=h(t,.63,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),l=h(t,.67,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(11711154))),u=h(t,.69,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2697513))),c=h(t,.82001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(7829367))),f=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15395562))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f);break;case a.PresetGradientType.GradientSilver:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),n=h(t,.03501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),r=h(t,.16,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),s=h(t,.235,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),l=h(t,.42501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),u=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),c=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),f=h(t,.965,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),d=h(t,.84,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),g=h(t,.765,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),m=h(t,.575,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f),v.push(d),v.push(g),v.push(m);break;case a.PresetGradientType.GradientSapphire:o=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),n=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),r=h(t,.28,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),s=h(t,.42999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),l=h(t,.58,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),u=h(t,.72,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),c=h(t,.87,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),f=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),v.push(o),v.push(n),v.push(r),v.push(s),v.push(l),v.push(u),v.push(c),v.push(f)}},l.InitGradientStopTwoColor=function(t,e){var o,n,r=e.GradientStyle;return r===a.GradientStyle.GradientFromCenter?void this.InitGradientTwoColorCenterStops(t,e):r===a.GradientStyle.GradientFromCorner?void this.InitGradientTwoColorCornerStops(t,e):(o=e.GradientStops.GradientStopList,void(1===(n=e.GradientVariant)||2===n?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))))):3===n?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===n&&(o.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),o.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))))))},l.InitGradientTwoColorCornerStops=function(t,e){var o=e.GradientStops.GradientStopList;o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))))},l.InitGradientTwoColorCenterStops=function(t,e){var o=e.GradientStops.GradientStopList,n=e.GradientVariant;1===n?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))))):2===n?(o.push(h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):3===n?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===n&&(o.push(h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),o.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))))},l.InitGradientOneColorCornerStops=function(t,e){var o=i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(e.GradientDegree)),n=e.GradientStops.GradientStopList;n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,o))},l.InitGradientOneColorCenterStops=function(t,e){var o=i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(e.GradientDegree)),n=e.GradientStops.GradientStopList,r=e.GradientVariant;1===r?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,o))):2===r?(n.push(h(t,0,o)),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):3===r?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,.5,o)),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===r&&(n.push(h(t,0,o)),n.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,o)))},l.InitGradientStopOneColor=function(t,e){var o,n,r,s=e.GradientStyle;return s===a.GradientStyle.GradientFromCenter?void this.InitGradientOneColorCenterStops(t,e):s===a.GradientStyle.GradientFromCorner?void this.InitGradientOneColorCornerStops(t,e):(o=this.GetTintAndShadeByDegree(e.GradientDegree),n=e.GradientStops.GradientStopList,void(1===(r=e.GradientVariant)||2===r?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,o)))):3===r?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,o))),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===r&&(n.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,o))))))},l.InitGradientStops=function(t,e,o){var n=this;if(e.Fpa(new f(t)),o===a.GradientColorType.GradientOneColor)n.InitGradientStopOneColor(t,e);else if(o===a.GradientColorType.GradientTwoColors)n.InitGradientStopTwoColor(t,e);else{if(o!==a.GradientColorType.GradientPresetColors)throw Error();n.InitGradientStopPresetColor(t,e)}e.GradientAngle=n.GetGradientAngle(e.GradientStyle,e.GradientVariant)}},"./dist/plugins/floatingObject/drawing/lineFormat.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function h(t,e,o){return t>=e&&t<=o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/stateful.js"),r=o("./dist/plugins/floatingObject/drawing/common.js"),i=o("./dist/plugins/floatingObject/drawing/fillFormat.js"),a=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),s=r.ChartUtility.umb,l=r.UnitHelper.isNullOrUndefined,u=null,c=function(t){function e(e,o,n){var r=t.call(this,o)||this,s=r;return s.Pqa=a.ArrowheadLength.medium,s.Qqa=a.ArrowheadStyle.none,s.Rqa=a.ArrowheadWidth.medium,s.Sqa=a.LineDashStyle.solid,s.Tqa=a.ArrowheadLength.medium,s.Uqa=a.ArrowheadStyle.none,s.Vqa=a.ArrowheadWidth.medium,s.Wqa=a.LineStyle.LineSingle,s.bz=!0,s.Xqa=-1,s.Yqa=u,s.xc=e,s.hqa=o,s.iqa=n,s.vmb=a.LineCapStyle.flat,s.wmb=a.LineJoinStyle.round,s.Zpa=new i.FillFormat(e,o&&o.FillInternal,n),r}return f(e,t),Object.defineProperty(e.prototype,"PatternColor",{get:function(){return this.FillInternal.PatternColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.FillInternal.ColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BeginArrowheadLength",{get:function(){return this.IsDirty(a.LineFormatStates.BeginArrowheadLength)||l(this.hqa)?this.Pqa:this.hqa.BeginArrowheadLength},set:function(t){this.Pqa=t,this.Dirty(a.LineFormatStates.BeginArrowheadLength)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BeginArrowheadStyle",{get:function(){return this.IsDirty(a.LineFormatStates.BeginArrowheadStyle)||l(this.hqa)?this.Qqa:this.hqa.BeginArrowheadStyle},set:function(t){this.Qqa=t,this.Dirty(a.LineFormatStates.BeginArrowheadStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BeginArrowheadWidth",{get:function(){return this.IsDirty(a.LineFormatStates.BeginArrowheadWidth)||l(this.hqa)?this.Rqa:this.hqa.BeginArrowheadWidth},set:function(t){this.Rqa=t,this.Dirty(a.LineFormatStates.BeginArrowheadWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DashStyle",{get:function(){return this.IsDirty(a.LineFormatStates.DashStyle)||l(this.hqa)?this.Sqa:this.hqa.DashStyle},set:function(t){h(t,0,11)&&(this.Sqa=t,this.Dirty(a.LineFormatStates.DashStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CapStyle",{get:function(){return this.IsDirty(a.LineFormatStates.CapStyle)||l(this.hqa)?this.vmb:this.hqa.CapStyle},set:function(t){h(t,0,2)&&(this.vmb=t,this.Dirty(a.LineFormatStates.CapStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JoinStyle",{get:function(){return this.IsDirty(a.LineFormatStates.JoinStyle)||l(this.hqa)?this.wmb:this.hqa.JoinStyle},set:function(t){h(t,0,2)&&(this.wmb=t,this.Dirty(a.LineFormatStates.JoinStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndArrowheadLength",{get:function(){return this.IsDirty(a.LineFormatStates.EndArrowheadLength)||l(this.hqa)?this.Tqa:this.hqa.EndArrowheadLength},set:function(t){this.Tqa=t,this.Dirty(a.LineFormatStates.EndArrowheadLength)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndArrowheadStyle",{get:function(){return this.IsDirty(a.LineFormatStates.EndArrowheadStyle)||l(this.hqa)?this.Uqa:this.hqa.EndArrowheadStyle},set:function(t){this.Uqa=t,this.Dirty(a.LineFormatStates.EndArrowheadStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndArrowheadWidth",{get:function(){return this.IsDirty(a.LineFormatStates.EndArrowheadWidth)||l(this.hqa)?this.Vqa:this.hqa.EndArrowheadWidth},set:function(t){this.Vqa=t,this.Dirty(a.LineFormatStates.EndArrowheadWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InsetPen",{get:function(){return this.IsDirty(a.LineFormatStates.InsetPen)||l(this.hqa)?this.Zqa:this.hqa.InsetPen},set:function(t){this.Zqa=t,this.Dirty(a.LineFormatStates.InsetPen)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pattern",{get:function(){return this.FillInternal.Pattern},set:function(t){this.FillInternal.uqa(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetGradientType",{get:function(){return this.FillInternal.PresetGradientType},enumerable:!0,configurable:!0}),e.prototype.xqa=function(t){this.FillInternal.xqa(t)},Object.defineProperty(e.prototype,"GradientAngle",{get:function(){return this.FillInternal.GradientAngle},set:function(t){this.FillInternal.GradientAngle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientColorType",{get:function(){return this.FillInternal.GradientColorType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientDegree",{get:function(){return this.FillInternal.GradientDegree},enumerable:!0,configurable:!0}),e.prototype.pqa=function(t){this.FillInternal.pqa(t)},Object.defineProperty(e.prototype,"GradientStops",{get:function(){return this.FillInternal.GradientStops},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientStyle",{get:function(){return this.FillInternal.GradientStyle},enumerable:!0,configurable:!0}),e.prototype.rqa=function(t){this.FillInternal.rqa(t)},Object.defineProperty(e.prototype,"GradientVariant",{get:function(){return this.FillInternal.GradientVariant},enumerable:!0,configurable:!0}),e.prototype.tqa=function(t){this.FillInternal.tqa(t)},Object.defineProperty(e.prototype,"Style",{get:function(){return this.IsDirty(a.LineFormatStates.Style)||l(this.hqa)?this.Wqa:this.hqa.Style},set:function(t){h(t,0,4)&&(this.Wqa=t,this.Dirty(a.LineFormatStates.Style))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){return this.FillInternal.Transparency},set:function(t){this.FillInternal.Transparency=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){return this.IsDirty(a.LineFormatStates.Visible)||l(this.hqa)?this.bz:this.hqa.Visible},set:function(t){this.bz=t,this.Dirty(a.LineFormatStates.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Weight",{get:function(){return this.IsDirty(a.LineFormatStates.Weight)||l(this.hqa)?this.Xqa:this.hqa.Weight},set:function(t){this.Xqa=t,this.Dirty(a.LineFormatStates.Weight)},enumerable:!0,configurable:!0}),e.prototype.OneColorGradient=function(t,e,o){this.FillInternal.OneColorGradient(t,e,o)},e.prototype.TwoColorGradient=function(t,e){this.FillInternal.TwoColorGradient(t,e)},e.prototype.PresetGradient=function(t,e,o){this.FillInternal.PresetGradient(t,e,o)},e.prototype.Solid=function(){this.FillInternal.Solid()},e.prototype.Patterned=function(t){this.FillInternal.Patterned(t)},Object.defineProperty(e.prototype,"FillInternal",{get:function(){var t=this;return t.Zpa||(t.Zpa=new i.FillFormat(t.xc,t.hqa&&t.hqa.FillInternal,t.iqa)),t.Zpa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.FillInternal.Type},enumerable:!0,configurable:!0}),e.prototype.GetState=function(e,o){var n=this.Zpa;if(n){if(e===a.LineFormatStates.Color&&n.Color)return n.Color.IsDirtyIncludingParent(o);if(e===a.LineFormatStates.PatternColor&&n.PatternColor)return n.PatternColor.IsDirtyIncludingParent(o)}return t.prototype.GetState.call(this,e,o)},e.prototype.IsDirtyIncludingParent=function(e){var o=this.Zpa;return!(!o||!o.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},e.prototype.OnParentChanged=function(t){this.hqa=t;var e=this.Zpa;e&&t&&(e.ParentStateful=t.FillInternal)},e.prototype.FromOOModel=function(t){this.Yqa=t,this.FromCT_LineProperties(t)},e.prototype.ToOOModel=function(){return this.ToCT_LineProperties()},e.prototype.FromCT_LineProperties=function(t){var e=this;l(t.solidFill)?l(t.pattFill)?l(t.gradFill)?l(t.noFill)||(e.FillInternal.ColorInternal.ColorType=a.SolidColorType.None):e.FillInternal.FromOOModel(t.gradFill,a.ColorFillType.GradientFillProperties):e.FillInternal.FromOOModel(t.pattFill,a.ColorFillType.PatternFillProperties):e.FillInternal.FromOOModel(t.solidFill,a.ColorFillType.SolidColorFillProperties),l(t.headEnd)||e.FromCT_LineEndProperties(t.headEnd),l(t.tailEnd)||e.FromCT_TailLineEndProperties(t.tailEnd),!l(t.w)&&t.w>=0?e.Weight=t.w:l(t.solidFill)&&l(t.gradFill)?(e.Xqa=-1,e.UnDirty(a.LineFormatStates.Weight)):e.Weight=1,l(t.cmpd)||(e.Style=t.cmpd),e.Round=!!t.round,l(t.prstDash)?e.UnDirty(a.LineFormatStates.DashStyle):e.DashStyle=t.prstDash,l(t.cap)||(e.CapStyle=t.cap),t.bevel?e.JoinStyle=a.LineJoinStyle.bevel:t.round?e.JoinStyle=a.LineJoinStyle.round:t.miter&&(e.JoinStyle=a.LineJoinStyle.miter)},e.prototype.ToCT_LineProperties=function(){var t,e,o,n,r=this,i=r.Yqa;return r.IsDirtyIncludingParent()||l(i)?(s(t=i||{}),r.bz?l(r.Zpa)||((e=r.Zpa.ToOOModel()).colorFillType===a.ColorFillType.SolidColorFillProperties?t.solidFill=e:e.colorFillType===a.ColorFillType.PatternFillProperties?t.pattFill=e:e.colorFillType===a.ColorFillType.GradientFillProperties?t.gradFill=e:e.colorFillType===a.ColorFillType.NoFillProperties&&(t.noFill=!0),delete e.colorFillType):t.noFill=!0,(o=r.ToCT_HeadLineEndProperties())&&(t.headEnd=o),(o=r.ToCT_TailLineEndProperties())&&(t.tailEnd=o),r.Weight>=0&&(t.w=r.Weight),r.GetState(a.LineFormatStates.Style,!0)&&(t.cmpd=r.Style),r.GetState(a.LineFormatStates.DashStyle,!0)&&(t.prstDash=r.DashStyle),r.Round&&(t.round=!0),r.GetState(a.LineFormatStates.CapStyle,!0)&&(t.cap=r.CapStyle),delete t.bevel,delete t.round,delete t.miter,r.GetState(a.LineFormatStates.JoinStyle,!0)&&((n=r.JoinStyle)===a.LineJoinStyle.bevel?t.bevel={}:n===a.LineJoinStyle.round?t.round=!0:n===a.LineJoinStyle.miter&&(t.miter={lim:8e5})),t):i},e.prototype.FromCT_LineEndProperties=function(t){var e=this;e.Qqa=t.type,e.Rqa=t.w,e.Pqa=t.len,e.SetState(a.LineFormatStates.BeginArrowheadStyle,!0),e.SetState(a.LineFormatStates.BeginArrowheadWidth,!0),e.SetState(a.LineFormatStates.BeginArrowheadLength,!0)},e.prototype.ToCT_HeadLineEndProperties=function(){var t={w:a.ArrowheadWidth.medium,len:a.ArrowheadLength.medium},e=this,o=!1;return e.GetState(a.LineFormatStates.BeginArrowheadStyle,!0)&&(t.type=e.BeginArrowheadStyle,o=!0),e.GetState(a.LineFormatStates.BeginArrowheadWidth,!0)&&(t.w=e.BeginArrowheadWidth,o=!0),e.GetState(a.LineFormatStates.BeginArrowheadLength,!0)&&(t.len=e.BeginArrowheadLength,o=!0),o?t:u},e.prototype.FromCT_TailLineEndProperties=function(t){if(!l(t)){var e=this;e.Uqa=t.type,e.Vqa=t.w,e.Tqa=t.len,e.SetState(a.LineFormatStates.EndArrowheadStyle,!0),e.SetState(a.LineFormatStates.EndArrowheadWidth,!0),e.SetState(a.LineFormatStates.EndArrowheadLength,!0)}},e.prototype.ToCT_TailLineEndProperties=function(){var t={w:a.ArrowheadWidth.medium,len:a.ArrowheadLength.medium},e=!1,o=this;return o.GetState(a.LineFormatStates.EndArrowheadStyle,!0)&&(t.type=o.EndArrowheadStyle,e=!0),o.GetState(a.LineFormatStates.EndArrowheadWidth,!0)&&(t.w=o.EndArrowheadWidth,e=!0),o.GetState(a.LineFormatStates.EndArrowheadLength,!0)&&(t.len=o.EndArrowheadLength,e=!0),e?t:u},e.prototype.Clone=function(){var t=this,o=new e(t.xc);return o.Zpa=t.Zpa&&t.Zpa.Clone(),o.Pqa=t.Pqa,o.Qqa=t.Qqa,o.Rqa=t.Rqa,o.Sqa=t.Sqa,o.Tqa=t.Tqa,o.Uqa=t.Uqa,o.Vqa=t.Vqa,o.Zqa=t.Zqa,o.bz=t.bz,o.Xqa=t.Xqa,o.rpa=t.rpa,o.hqa=t.hqa,o},e}(n.StatefullBase),e.LineFormat=c},"./dist/plugins/floatingObject/drawing/picture.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/stateful.js"),r=o("./dist/plugins/floatingObject/drawing/common.js"),i=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=r.ShapeConstants.PositionConver,s=r.ShapeConstants.PositiveFixedPercentageConvert,l=r.ShapeUtility.FromLum,u=r.ShapeUtility.ToLum,c=r.UnitHelper.isNullOrUndefined,f=null,h=void 0,p=function(){function t(t){var e=this;e.qva=0,e.rva=0,e.sva=0,e.tva=0,e.xo=t}return Object.defineProperty(t.prototype,"PictureHeight",{get:function(){return this.tva},set:function(t){this.tva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PictureOffsetX",{get:function(){return this.qva},set:function(t){this.qva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PictureOffsetY",{get:function(){return this.rva},set:function(t){this.rva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PictureWidth",{get:function(){return this.sva},set:function(t){this.sva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeHeight",{get:function(){return this.xo.Height},set:function(t){this.xo.Height=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeLeft",{get:function(){return this.xo.Left},set:function(t){this.xo.Left=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeTop",{get:function(){return this.xo.Top},set:function(t){this.xo.Top=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeWidth",{get:function(){return this.xo.Width},set:function(t){this.xo.Width=t},enumerable:!0,configurable:!0}),t.prototype.Clone=function(){var e=this,o=new t(e.xo);return o.tva=e.tva,o.qva=e.qva,o.rva=e.rva,o.sva=e.sva,o},t}(),e.Crop=p,d=function(t){function e(e,o){var n;return e===h&&(e=i.PictureFormatType.PictureShape),o===h&&(o=f),(n=t.call(this,o)||this).Jqa=r.ShapeConstants.DefaultBrightness,n.Xba=i.PictureColorType.PictureAutomatic,n.uva=r.ShapeConstants.DefaultBrightness,n.vva=r.ShapeConstants.DefaultTransparent,n.wva=e,n.hqa=o,n.xva=n.wva===i.PictureFormatType.PictureShape,n.Gqa=r.ShapeConstants.DefaultTransparent,n.sMc={left:0,right:0,top:0,bottom:0},n.tMc={offsetX:0,offsetY:0,scaleX:1,scaleY:1,alignment:0,mirrorType:0},n}return g(e,t),Object.defineProperty(e.prototype,"Brightness",{get:function(){return this.IsDirty(1)||c(this.hqa)?this.Jqa:this.hqa.Brightness},set:function(t){if(t<0||t>1)throw Error();this.Jqa=t,this.Dirty(1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorType",{get:function(){return this.IsDirty(2)||c(this.hqa)?this.Xba:this.hqa.ColorType},set:function(t){t===i.PictureColorType.PictureAutomatic?(this.Jqa=r.ShapeConstants.DefaultBrightness,this.uva=r.ShapeConstants.DefaultBrightness):t===i.PictureColorType.PictureWatermark&&(this.Jqa=.85,this.uva=.15),this.Xba=t,this.Dirty(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Contrast",{get:function(){return this.IsDirty(4)||c(this.hqa)?this.uva:this.hqa.Contrast},set:function(t){if(t<0||t>1)throw Error();this.uva=t,this.Dirty(4)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Crop",{get:function(){var t=this;return t.yva||(t.yva=new p(t.zva)),t.yva},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropBottom",{get:function(){return this.Crop.ShapeTop+this.Crop.ShapeHeight},set:function(t){this.Crop.ShapeHeight=t-this.Crop.ShapeTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropLeft",{get:function(){return this.Crop.ShapeLeft},set:function(t){this.Crop.ShapeLeft=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropRight",{get:function(){return this.Crop.ShapeLeft+this.Crop.ShapeWidth},set:function(t){this.Crop.ShapeWidth=t-this.Crop.ShapeLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropTop",{get:function(){return this.Crop.ShapeTop},set:function(t){this.Crop.ShapeTop=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Stretch",{get:function(){return this.sMc},set:function(t){this.sMc=JSON.parse(JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tile",{get:function(){return this.tMc},set:function(t){this.tMc=JSON.parse(JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){return this.Gqa},set:function(t){t=Math.max(0,t),t=Math.min(1,t),this.Gqa=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TransparencyColor",{get:function(){return this.IsDirty(8)||c(this.hqa)?this.vva:this.hqa.TransparencyColor},set:function(t){this.vva=t,this.Dirty(8)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TransparentBackground",{get:function(){return this.IsDirty(16)||c(this.hqa)?this.xva:this.hqa.TransparentBackground},set:function(t){this.xva=t;var e=this.zva.Fill;t&&(e.Transparency=1),e.Solid(),this.Dirty(16)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Container",{get:function(){return this.zva},set:function(t){if(this.zva=t,t){var e=this.Crop;e.PictureWidth=t.Width,e.PictureHeight=t.Height}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PicFill",{get:function(){return this.IsDirty(32)||c(this.hqa)?this.Ava:this.hqa.PicFill},set:function(t){this.Ava=t,this.Dirty(32)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PicType",{get:function(){return this.IsDirty(64)||c(this.hqa)?this.Bva:this.hqa.PicType},set:function(t){this.Bva=t,this.Dirty(64)},enumerable:!0,configurable:!0}),e.prototype.ClearModel=function(){var t,e;for(this.Tpa=f,t=0,e=this.Children;t<e.length;t++)e[t].ClearModel()},Object.defineProperty(e.prototype,"PictureFormatType",{get:function(){return this.wva},set:function(t){this.wva=t},enumerable:!0,configurable:!0}),e.prototype.HasOwnPicture=function(){return this.IsDirty(1)||this.IsDirty(2)||this.IsDirty(4)||this.IsDirty(8)||this.IsDirty(16)},e.prototype.SetPictureInfo=function(t,e,o){this.PicFill=t,this.PicType=e,this.PictureFormatType=o},e.prototype.IncrementBrightness=function(t){this.Brightness+=t},e.prototype.IncrementContrast=function(t){this.Contrast+=t},e.prototype.FromOOModel=function(t){var e,o=this;o.Tpa=t,c(t)||(o.FromCT_Blip(t.blip),e=o.zva,c(e)||(c(t.tile)||(o.PictureFormatType=i.PictureFormatType.TextureFill),o.Crop.PictureWidth=e.Width,o.Crop.PictureHeight=e.Height,o.PictureFormatType===i.PictureFormatType.PictureShape?o.FromCT_RelativeRect(t.srcRect):o.PictureFormatType===i.PictureFormatType.PictureFill?o.FromCT_Stretch(t.stretch):o.PictureFormatType===i.PictureFormatType.TextureFill&&o.FromCT_Tile(t.tile)))},e.prototype.ToOOModel=function(){var t,e,o=this,n=o.Tpa||{};return n.colorFillType=i.ColorFillType.BlipFillProperties,n.blip=o.ToCT_Blip(),t=o.zva,c(t)||((e=o.PictureFormatType)===i.PictureFormatType.PictureShape?(n.srcRect=o.ToCT_RelativeRect(),n.stretch={},n.stretch.fillRect={l:0,r:0,t:0,b:0}):e===i.PictureFormatType.PictureFill?(n.stretch=o.ToCT_Strecth(),n.srcRect={l:0,r:0,t:0,b:0},n.tile=f):e===i.PictureFormatType.TextureFill&&(n.stretch=f,n.srcRect=f,n.tile=o.ToCT_Tile())),n},e.prototype.FromCT_Blip=function(t){if(!c(t)){var e=this;e.FromCT_ColorChangeEffect(t.clrChange),e.FromCT_LuminanceEffect(t.lum),c(t.alphaModFix)||(e.Transparency=1-t.alphaModFix.amt/s),c(t.grayscl)?c(t.biLevel)||(e.ColorType=i.PictureColorType.PictureBlackAndWhite):e.ColorType=i.PictureColorType.PictureGrayscale,e.FromCT_BlipBlob(t.blipBlob)}},e.prototype.ToCT_Blip=function(){var t=this,e=t.Tpa&&t.Tpa.blip||{cstate:i.ST_BlipCompression.none};return t.TransparencyColor!==r.ShapeConstants.DefaultTransparent&&(e.clrChange=t.ToCT_ColorChangeEffect()),t.Brightness===r.ShapeConstants.DefaultBrightness&&t.Contrast===r.ShapeConstants.DefaultBrightness||(e.lum=t.ToCT_LuminanceEffect()),t.Transparency!==r.ShapeConstants.DefaultTransparent?e.alphaModFix={amt:(1-t.Transparency)*s}:delete e.alphaModFix,t.ColorType===i.PictureColorType.PictureGrayscale?e.grayscl={}:t.ColorType===i.PictureColorType.PictureBlackAndWhite&&(e.biLevel={thresh:5e4}),e.blipBlob=t.ToCT_BlipBlob(),e},e.prototype.FromCT_ColorChangeEffect=function(t){t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},e.prototype.ToCT_ColorChangeEffect=function(){var t=this.ToColorByteArr(this.vva);return{useA:!0,clrFrom:{srgbClr:{val:t}},clrTo:{srgbClr:{val:t,alpha:[0]}}}},e.prototype.FromColorByteArr=function(t){this.vva=0|t[2]<<16|t[1]<<8|t[0]},e.prototype.ToColorByteArr=function(t){var e=[];return e[3]=Math.floor(t/(1<<24)),t%=1<<24,e[2]=Math.floor(t/65536),t%=65536,e[1]=Math.floor(t/256),t%=256,e[0]=Math.floor(t),e},e.prototype.FromCT_LuminanceEffect=function(t){t&&(this.Brightness=l(t.bright),this.Contrast=l(t.contrast))},e.prototype.ToCT_LuminanceEffect=function(){return{bright:u(this.Brightness),contrast:u(this.Contrast)}},e.prototype.FromCT_BlipBlob=function(t){if(t){var e=this;e.Ava=t.blob,e.Dirty(32),e.Bva=t.type,e.Dirty(64)}},e.prototype.ToCT_BlipBlob=function(){var t=this,e=t.Tpa&&t.Tpa.blip&&t.Tpa.blip.blipBlob||{type:i.ImageType.PNG};return e.blob=t.PicFill,e.type=t.PicType,e},e.prototype.FromCT_Tile=function(t){this.tMc={offsetX:t.tx,offsetY:t.ty,scaleX:t.sx/a,scaleY:t.sy/a,alignment:t.algn,mirrorType:t.flip}},e.prototype.ToCT_Tile=function(){var t=this.Tile;return{tx:t.offsetX,ty:t.offsetY,sx:Math.round(t.scaleX*a),sy:Math.round(t.scaleY*a),algn:t.alignment,flip:t.mirrorType}},e.prototype.FromCT_Stretch=function(t){var e,o,n,r,i=t&&t.fillRect;c(i)||(e=i.l/a,o=i.r/a,n=i.t/a,r=i.b/a,this.sMc={left:e,right:o,top:n,bottom:r})},e.prototype.ToCT_Strecth=function(){var t=this.Stretch,e=t.left,o=t.right,n=t.top,r=t.bottom;return{fillRect:{l:Math.round(e*a),r:Math.round(o*a),t:Math.round(n*a),b:Math.round(r*a)}}},e.prototype.FromCT_RelativeRect=function(t){var e,o,n,r,i,s,l,u=this.zva;c(t)||c(u)||(e=t.l/a,o=t.r/a,n=t.t/a,r=t.b/a,s=(i=this.Crop).PictureWidth=u.Width/(1-e-o),l=i.PictureHeight=u.Height/(1-n-r),i.PictureOffsetX=(s-u.Width)/2-e*s,i.PictureOffsetY=(l-u.Height)/2-n*l)},e.prototype.ToCT_RelativeRect=function(){var t,e,o,n,r=this.zva,i=this.Crop,s=i.ShapeHeight,l=i.ShapeWidth;return c(r)||0===s||0===l?{l:0,r:0,t:0,b:0}:(t=i.PictureWidth,e=i.PictureHeight,o=i.PictureOffsetX,n=i.PictureOffsetY,{l:((t-l)/2-o)/t*a,r:((t-l)/2+o)/t*a,t:((e-s)/2-n)/e*a,b:((e-s)/2+n)/e*a})},e.prototype.Clone=function(){var t=this,o=new e;return o.Jqa=t.Jqa,o.uva=t.uva,o.Xba=t.Xba,t.yva&&(o.yva=t.yva.Clone()),o.Gqa=t.Gqa,o.tMc=JSON.parse(JSON.stringify(t.tMc)),o.sMc=JSON.parse(JSON.stringify(t.sMc)),o.Ava=t.Ava,o.wva=t.wva,o.Bva=t.Bva,o.zva=t.zva,o.vva=t.vva,o.xva=t.xva,o},e.prototype.OnParentChanged=function(t){this.hqa=t},e}(n.StatefullBase),e.PictureFormat=d},"./dist/plugins/floatingObject/drawing/stateful.js":function(t,e,o){"use strict";var n,r,i;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common").Common.j,r=n.Fa,i=function(){function t(t){var e=this;e.oi=[],e.qpa=0,e.rpa=0,e.spa=t,e.spa&&e.spa.AddChildInternal(e)}return t.prototype.SetState=function(t,e){var o=this,n=t;e?o.rpa|=n:o.rpa&=~n,o.IsClearChildrenStateSuspended||o.oi.forEach((function(e){e.SetState(t,!1)}))},t.prototype.GetState=function(t,e){var o=this,n=t,i=(n&o.rpa)===n;return i||!e||r(o.spa)||(i=o.spa.GetState(t,!0)),i},t.prototype.OnStateChanged=function(t){},t.prototype.Dirty=function(t){this.SetState(t,!0)},t.prototype.UnDirty=function(t){this.SetState(t,!1)},t.prototype.UnDirtyAll=function(){this.rpa=0},t.prototype.IsDirty=function(t){return this.GetState(t)},t.prototype.IsPropDirtyIncludingParent=function(t,e){var o=this;return!!o.GetState(t)||!(!e||r(o.spa))&&o.spa.IsPropDirtyIncludingParent(t,!0)},t.prototype.IsDirtyIncludingParent=function(t){var e=this;return e.rpa>0||!(!t||r(e.spa))&&e.spa.IsDirtyIncludingParent(!0)},t.prototype.AddChildInternal=function(t){var e=this.oi;-1===e.indexOf(t)&&e.push(t)},t.prototype.RemoveChildInternal=function(t){var e=this.oi,o=e.indexOf(t);-1!==o&&e.splice(o,1)},t.prototype.SetParentForChildren=function(t){this.oi.slice(0).forEach((function(e){e.ParentStateful=t}))},t.prototype.OnParentChanged=function(t){},t.prototype.SuspendClearChildrenState=function(){this.qpa++},t.prototype.ResumeClearChilrenState=function(){this.qpa--},Object.defineProperty(t.prototype,"ParentStateful",{get:function(){return this.spa},set:function(t){var e=this;t!==e.spa&&(e.spa&&e.spa.RemoveChildInternal(this),e.spa=t,e.spa&&e.spa.AddChildInternal(this),e.OnParentChanged(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Children",{get:function(){return this.oi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsClearChildrenStateSuspended",{get:function(){return this.qpa>0},enumerable:!0,configurable:!0}),t}(),e.StatefullBase=i},"./dist/plugins/floatingObject/drawing/threeDFormat.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/floatingObject/drawing/common.js"),r=o("./dist/plugins/floatingObject/drawing/stateful.js"),i=o("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=n.ShapeConstants.PositiveFixedAngleConvert,s=n.UnitHelper.isNullOrUndefined,function(t){t[t.BevelBottomDepth=1]="BevelBottomDepth",t[t.BevelBottomInset=2]="BevelBottomInset",t[t.BevelBottomType=4]="BevelBottomType",t[t.BevelTopDepth=8]="BevelTopDepth",t[t.BevelTopInset=16]="BevelTopInset",t[t.BevelTopType=32]="BevelTopType",t[t.ContourColor=64]="ContourColor",t[t.ContourWidth=128]="ContourWidth",t[t.Depth=256]="Depth",t[t.ExtrusionColor=512]="ExtrusionColor",t[t.ExtrusionColorType=1024]="ExtrusionColorType",t[t.FieldOfView=2048]="FieldOfView",t[t.LightAngle=4096]="LightAngle",t[t.Perspective=8192]="Perspective",t[t.PresetCamera=16384]="PresetCamera",t[t.PresetExtrusionDirection=32768]="PresetExtrusionDirection",t[t.PresetLighting=65536]="PresetLighting",t[t.PresetLightingDirection=131072]="PresetLightingDirection",t[t.PresetLightingSoftness=262144]="PresetLightingSoftness",t[t.PresetMaterial=524288]="PresetMaterial",t[t.PresetThreeDFormat=1048576]="PresetThreeDFormat",t[t.ProjectText=2097152]="ProjectText",t[t.RotationX=4194304]="RotationX",t[t.RotationY=8388608]="RotationY",t[t.RotationZ=16777216]="RotationZ",t[t.Visible=33554432]="Visible",t[t.Z=67108864]="Z",t[t.AutoScale=134217728]="AutoScale",t[t.DepthPercent=268435456]="DepthPercent",t[t.HeightPercent=536870912]="HeightPercent",t[t.RightAngleAxes=1073741824]="RightAngleAxes"}(l=e.ThreeDFormatStates||(e.ThreeDFormatStates={})),function(t){t[t.ExtrusionColorAutomatic=0]="ExtrusionColorAutomatic",t[t.ExtrusionColorCustom=1]="ExtrusionColorCustom"}(u||(u={})),c=null,f=function(t){function e(e,o){var r=t.call(this,o)||this,a=r;return a.$qa=n.BevelType.BevelNone,a._qa=n.BevelType.BevelNone,a.ara=u.ExtrusionColorAutomatic,a.bra=45,a.bz=!0,a.cra=c,a.dra=!0,a.era=100,a.fra=100,a.gra=!0,a.xc=e,a.hra=30,a.hqa=o,a.ira(i.PresetCamera.PresetCameraNone),r}return h(e,t),e.prototype.ira=function(t){this.jra=t,this.Dirty(l.PresetCamera)},e.prototype.InitDicCameraType=function(){var t=this.cra=[];t[i.PresetCamera.CameraLegacyObliqueTopLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueTop]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueTopRight]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueFront]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueRight]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueBottomLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueBottom]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueBottomRight]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveTopLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveTop]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveTopRight]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveFront]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveRight]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveBottomLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveBottom]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveBottomRight]=[0,0,0],t[i.PresetCamera.CameraOrthographicFront]=[0,0,0],t[i.PresetCamera.CameraIsometricTopUp]=[314.7191,324.6037,60.16242],t[i.PresetCamera.CameraIsometricTopDown]=[45.28088,324.6037,299.8376],t[i.PresetCamera.CameraIsometricBottomUp]=[45.28088,35.39627,60.16242],t[i.PresetCamera.CameraIsometricBottomDown]=[314.7191,35.39627,299.8376],t[i.PresetCamera.CameraIsometricLeftUp]=[45,325,0],t[i.PresetCamera.CameraIsometricLeftDown]=[45,35,0],t[i.PresetCamera.CameraIsometricRightUp]=[315,35,0],t[i.PresetCamera.CameraIsometricRightDown]=[315,325,0],t[i.PresetCamera.CameraIsometricOffAxis1Left]=[64,18,0],t[i.PresetCamera.CameraIsometricOffAxis1Right]=[334,18,0],t[i.PresetCamera.CameraIsometricOffAxis1Top]=[306.5457,301.2619,57.6425],t[i.PresetCamera.CameraIsometricOffAxis2Left]=[26,18,0],t[i.PresetCamera.CameraIsometricOffAxis2Right]=[296,18,0],t[i.PresetCamera.CameraIsometricOffAxis2Top]=[53.45424,301.2619,302.3575],t[i.PresetCamera.CameraIsometricOffAxis3Left]=[64,342,0],t[i.PresetCamera.CameraIsometricOffAxis3Right]=[334,342,0],t[i.PresetCamera.CameraIsometricOffAxis3Bottom]=[306.5457,58.73808,302.3575],t[i.PresetCamera.CameraIsometricOffAxis4Left]=[26,342,0],t[i.PresetCamera.CameraIsometricOffAxis4Right]=[296,342,0],t[i.PresetCamera.CameraIsometricOffAxis4Bottom]=[53.45424,58.73808,57.64252],t[i.PresetCamera.CameraObliqueTopLeft]=[0,0,0],t[i.PresetCamera.CameraObliqueTop]=[0,0,0],t[i.PresetCamera.CameraObliqueTopRight]=[0,0,0],t[i.PresetCamera.CameraObliqueLeft]=[0,0,0],t[i.PresetCamera.CameraObliqueRight]=[0,0,0],t[i.PresetCamera.CameraObliqueBottomLeft]=[0,0,0],t[i.PresetCamera.CameraObliqueBottom]=[0,0,0],t[i.PresetCamera.CameraObliqueBottomRight]=[0,0,0],t[i.PresetCamera.CameraPerspectiveFront]=[0,0,0],t[i.PresetCamera.CameraPerspectiveLeft]=[20,0,0],t[i.PresetCamera.CameraPerspectiveRight]=[340,0,0],t[i.PresetCamera.CameraPerspectiveAbove]=[0,340,0],t[i.PresetCamera.CameraPerspectiveBelow]=[0,20,0],t[i.PresetCamera.CameraPerspectiveAboveLeftFacing]=[14.33758,39.30647,341.1238],t[i.PresetCamera.CameraPerspectiveAboveRightFacing]=[345.6624,39.30647,18.87615],t[i.PresetCamera.CameraPerspectiveContrastingLeftFacing]=[43.93887,10.39642,356.4465],t[i.PresetCamera.CameraPerspectiveContrastingRightFacing]=[316.0611,10.39642,3.553517],t[i.PresetCamera.CameraPerspectiveHeroicLeftFacing]=[14.29302,348.9837,2.626817],t[i.PresetCamera.CameraPerspectiveHeroicRightFacing]=[345.7069,348.9837,357.3732],t[i.PresetCamera.CameraPerspectiveHeroicExtremeLeftFacing]=[34.46068,8.12245,357.0914],t[i.PresetCamera.CameraPerspectiveHeroicExtremeRightFacing]=[325.5393,8.12245,2.9086],t[i.PresetCamera.CameraPerspectiveRelaxed]=[0,309.5601,0],t[i.PresetCamera.CameraPerspectiveRelaxedModerately]=[0,324.844,0]},e.prototype.SetPresetCamera=function(t){this.jra=t,this.Dirty(l.PresetCamera)},e.prototype.UpdatePresetCamera=function(){this.jra===i.PresetCamera.PresetCameraNone&&this.SetPresetCamera(i.PresetCamera.CameraOrthographicFront)},e.prototype.IncrementRotationX=function(t){this.RotationX+=t},e.prototype.IncrementRotationY=function(t){this.RotationY+=t},e.prototype.IncrementRotationZ=function(t){this.RotationZ+=t},e.prototype.ResetRotation=function(){var t=this;t.RotationX=0,t.RotationY=0,t.RotationZ=0},e.prototype.Clone=function(){var t=this,o=new e(t.xc);return o.pra=t.pra,o.qra=t.qra,o.$qa=t.$qa,o.rra=t.rra,o.sra=t.sra,o._qa=t._qa,s(t.tra)||(o.tra=t.tra.Clone()),o.ura=t.ura,o.ora=t.ora,s(t.vra)||(o.vra=t.vra.Clone()),o.ara=t.ara,o.bra=t.bra,o.wra=t.wra,o.hra=t.hra,o.jra=t.jra,o.xra=t.xra,o.yra=t.yra,o.zra=t.zra,o.Ara=t.Ara,o.Bra=t.Bra,o.Cra=t.Cra,o.Dra=t.Dra,o.kra=t.kra,o.lra=t.lra,o.mra=t.mra,o.bz=t.bz,o.nra=t.nra,o.rpa=t.rpa,o.hqa=t.hqa,o},e.prototype.IsDirtyIncludingParent=function(e){var o=this;return!(!o.tra||!o.tra.IsDirtyIncludingParent(e))||!(!o.vra||!o.vra.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},e.prototype.OnParentChanged=function(t){var e=this;e.hqa=t,s(e.hqa)&&(e.tra&&(e.tra.ParentStateful=c),e.vra&&(e.vra.ParentStateful=c))},e.prototype.FromOOModel=function(t){var e=this;e.Lqa=t,e.FromCT_Scene3D(e.Lqa.Scene3D),e.FromCT_View3D(e.Lqa.View3D),e.FromCT_Shape3D(e.Lqa.Shape3D)},e.prototype.ToOOModel=function(t){var e=this,o=e.Lqa||{};return o.View3D=e.ToCT_View3D(),e.PresetCamera!==i.PresetCamera.PresetCameraNone&&(o.Scene3D=e.ToCT_Scene3D()),(e.IsPropDirtyIncludingParent(l.Depth,!0)||e.IsPropDirtyIncludingParent(l.Z,!0))&&(o.Shape3D=e.ToCT_Shape3D()),o},e.prototype.FromCT_View3D=function(t){var e=this;s(t)||(s(t.hPercent)||(e._HeightPercent=t.hPercent),s(t.depthPercent)||(e._DepthPercent=t.depthPercent),s(t.rotX)||(e.RotationY=t.rotX),s(t.rotY)||(e.RotationX=t.rotY),s(t.rAngAx)?e._RightAngleAxes=!1:e._RightAngleAxes=t.rAngAx,s(t.perspective)||(e.Perspective=t.perspective/2))},e.prototype.ToCT_View3D=function(){var t=this,e=t.Lqa&&t.Lqa.View3D||{};return!t._AutoScale&&t.IsDirty(l.HeightPercent)&&(e.hPercent=t._HeightPercent),t.IsDirty(l.DepthPercent)&&(e.depthPercent=t._DepthPercent),t.IsDirty(l.RotationY)&&(e.rotX=t.RotationY),t.IsDirty(l.RotationX)&&(e.rotY=t.RotationX),t.IsDirty(l.RightAngleAxes)&&(e.rAngAx=t._RightAngleAxes),!t._RightAngleAxes&&t.IsDirty(l.Perspective)&&(e.perspective=2*t.Perspective),e},e.prototype.FromCT_Scene3D=function(t){s(t)||this.FromCT_Camera(t.camera)},e.prototype.ToCT_Scene3D=function(){var t=this,e=t.Lqa,o=e&&e.Scene3D||{};return o.camera=t.ToCT_Camera(),!s(o.camera)&&s(o.lightRig)&&(o.lightRig=t.ToDefaultCT_LightRig()),s(o.camera)&&s(o.backdrop)&&s(o.lightRig)?c:o},e.prototype.GetActualCT_Scene3D=function(){var t=this;return s(t.Lqa)||s(t.Lqa.Scene3D)?s(t.hqa)?c:t.GetActualCT_Scene3D():t.Lqa.Scene3D},e.prototype.FromCT_Shape3D=function(t){var e=this;s(t)||(0!==t.extrusionH&&(e.Depth=t.extrusionH,e.Dirty(l.Depth)),0!==t.z&&(e.Z=t.z,e.Dirty(l.Z)))},e.prototype.ToCT_Shape3D=function(){var t=this,e=t.Lqa,o=e&&e.Shape3D||{z:0,extrusionH:0,contourW:0,prstMaterial:i.ST_PresetMaterialType.warmMatte};return o.extrusionH=t.Depth,o.z=t.Z,o},e.prototype.ToDefaultCT_LightRig=function(){return{rig:i.LightRigType.LightRigThreePoint,dir:i.PresetLightingDirection.LightingTopLeft}},e.prototype.FromCT_Camera=function(t){s(t)||(this.ira(t.prst),s(t.rot)||this.FromCameraCT_SphereCoords(t.rot))},e.prototype.ToCT_Camera=function(){var t,e,o=this;return o.xc.DrawingType===i.DrawingType.Shape||o.xc.DrawingType===i.DrawingType.GroupShape?((t={zoom:1e5}).prst=o.PresetCamera,t.rot=o.ToCameraCT_SphereCoords(),t):(e=o.Lqa)&&e.Scene3D&&e.Scene3D.camera||c},e.prototype.FromCameraCT_SphereCoords=function(t){var e=this;s(t)||(e.RotationX=t.lon/a,e.RotationY=t.lat/a,e.RotationZ=t.rev/a)},e.prototype.ToCameraCT_SphereCoords=function(){var t,e,o,n,r=this;return 0===r.RotationX&&0===r.RotationY&&0===r.RotationZ?c:(t={},e=r.RotationX,o=r.RotationY,n=r.RotationZ,t.lon=e*a,t.lat=o*a,t.rev=n*a,t)},Object.defineProperty(e.prototype,"Perspective",{get:function(){var t=this;return t.Dirty(l.Perspective),s(t.hqa)?t.hra:t.hqa.Perspective},set:function(t){this.hra=t,this.Dirty(l.Perspective)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetCamera",{get:function(){var t=this;return t.Dirty(l.PresetCamera),s(t.hqa)?t.jra:t.hqa.PresetCamera},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotationX",{get:function(){var t=this;return t.Dirty(l.RotationX),s(t.hqa)?t.Visible?t.kra:0:t.hqa.RotationX},set:function(t){var e=this;t!==e.kra&&(e.kra=t,e.Dirty(l.RotationX),e.UpdatePresetCamera())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotationY",{get:function(){var t=this;return t.Dirty(l.RotationY),s(t.hqa)?t.Visible?t.lra:0:t.hqa.RotationY},set:function(t){var e=this;if(e.xc.DrawingType===i.DrawingType.Chart){if(t<-90&&t>=180)return}else if(t<0&&t>=360)return;e.lra=t,e.Dirty(l.RotationY),e.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotationZ",{get:function(){var t=this;return t.Dirty(l.RotationZ),s(t.hqa)?t.Visible?t.mra:0:t.hqa.RotationZ},set:function(t){var e=this;t!==e.mra&&(e.mra=t,e.Dirty(l.RotationZ),e.UpdatePresetCamera())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var t=this;return t.Dirty(l.Visible),s(t.hqa)?t.bz:t.hqa.Visible},set:function(t){this.bz=t,this.Dirty(l.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Z",{get:function(){var t=this;return t.Dirty(l.Z),s(t.hqa)?t.Visible?t.nra:0:t.hqa.Z},set:function(t){var e=this;e.nra=t,e.Dirty(l.Z),e.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Depth",{get:function(){var t=this;return t.Dirty(l.Depth),s(t.hqa)?t.Visible?t.ora:0:t.hqa.Depth},set:function(t){var e=this;e.ora=t,e.Dirty(l.Depth),e.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DicCameraType",{get:function(){var t=this;return s(t.cra)&&t.InitDicCameraType(),t.cra},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_InternalVisible",{get:function(){return this.bz},set:function(t){this.bz=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_AutoScale",{get:function(){return this.dra},set:function(t){this.dra=t,this.Dirty(l.AutoScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_DepthPercent",{get:function(){return this.era},set:function(t){t>=20&&t<=2e3&&(this.era=t,this.Dirty(l.DepthPercent))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_HeightPercent",{get:function(){return this.fra},set:function(t){t>=5&&t<=500&&(this.fra=t,this.Dirty(l.HeightPercent))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_RightAngleAxes",{get:function(){return this.gra},set:function(t){this.gra=t,this.Dirty(l.RightAngleAxes)},enumerable:!0,configurable:!0}),e}(r.StatefullBase),e.ThreeDFormat=f},"./dist/plugins/floatingObject/floatingobject-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function G(t){var e=t.wr,o=!1;return e&&e.zR().forEach((function(t){t&&t[I]()&&(o=!0)})),o}function B(t,e,o,n,r){var i,a,s,l=t.parent,u=[],c=t.wr;if(n)u=n;else for(i=0;i<o.length;i++)u.push(c.NR(o[i]));l&&e.xC&&u[0]&&(a=u[0].startRow(),s=u[0].startColumn(),l.changeSelectionInCommandExecuting(e,a,s,[],u),e.xC.JLc=r)}function _(t){var e,o=t,n=o.kj;return!!o.canUndo()&&(o.Lz(n,!0),e=r.Commands.bWa(n.name()),n.ITa.undo(o.VQ[e]),o.Mz(n,!0),!0)}function V(t){var e=[];return t.wr.zR().forEach((function(t){t[I]()&&e.push(t[R]())})),e}function H(t,e,o){var n,r,a,s,u=t.BR(),c=u.fromSheet;for(u.fromSheet=t,u.isCutting=o,n=new i.yR,r=0,a=0;a<l(e);a++)(s=t.wr.NR(e[a]))&&(n.push(s),r++);return c&&(c.CR=null),t.CR=n,r>0}function z(t){var e;switch(t.typeName){case"0":case"1":break;case"2":e="Chart "}return e}function U(t){return function(e,o){var n,i,a=r.Commands.bT(e,o),s=0;return t===P.left?s=-1:t===P.right&&(s=1),n=0,t===P.up?n=-1:t===P.down&&(n=1),i=V(a),l(i)>0&&a.wu().execute({cmd:b,sheetName:a.name(),floatingObjects:i,offsetX:s,offsetY:n})}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("./dist/plugins/floatingObject/floatingobject.js"),a=r.GC$,s=a.isArray,l=n.Common.k.ac,u=Math.min,c=n.Common.j.Fa,f="unSelectAllFloatingObjects",h="deleteFloatingObjects",p="navigationNextFloatingObject",d="navigationPreviousFloatingObject",g="cutFloatingObjects",m="copyFloatingObjects",y="pasteFloatingObjects",C="dragCopyFloatingObjects",v="selectAllFloatingObjects",b="moveFloatingObjects",w="moveFloatingObjectsUp",T="moveFloatingObjectsDown",S="moveFloatingObjectsLeft",x="moveFloatingObjectsRight",A="resizeFloatingObjects",I="isSelected",R="name",M=r.Commands.h4,k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return L(e,t),e.prototype.canExecute=function(){return!!G(this.kj)},e.prototype.canUndo=function(){var t=r.Commands.bWa(this.kj.name()),e=this.VQ[t],o=e&&e.CUa;return!!(o&&l(o)>0)||!!((o=e&&e.EUa)&&l(o)>0)},e}(r.Commands.ActionBase),e.FloatingObjectUndoActionBase=k,N=function(t){function e(e,o){return t.call(this,e,o)||this}return L(e,t),e.prototype.execute=function(){var t,e,o,n,i,a=this,u=!1,c=a.kj,f=a.VQ,h=f.floatingObjects;if(a.canExecute()&&s(h)){for(B(c,f,h),c.ITa.startTransaction(),a.Lz(c,!0),t=c.wr,e=0,o=l(h);e<o;e++)(n=t.NR(h[e]))&&(i=c.slicers,a.zS(n)&&i&&i.vV(n[R]()),t.Fb(h[e],!0),n[I](!1));c.GJ(),a.Mz(c,!0),f[r.Commands.bWa(c.name())]=c.ITa.endTransaction(),u=l(h)>0}return u},e.prototype.undo=function(){var t,e=this,o=e.VQ,n=e.kj;return!!e.canUndo()&&(e.Lz(n,!0),t=r.Commands.bWa(n.name()),n.ITa.undo(o[t]),n.EJ(),e.Mz(n,!0),!0)},e.prototype.zS=function(t){return t&&"Slicer"===t.typeName},e}(k),e.DeleteFloatingObjectUndoAction=N,O=function(t){function e(e,o){return t.call(this,e,o)||this}return L(e,t),e.prototype.canExecute=function(){return!0},e.prototype.execute=function(){var t,e,o,n,i,a=this,u=!1,c=a.VQ,f=c.floatingObjects,h=a.kj;if(a.canExecute()&&s(f)){for(B(h,c,f),h.ITa.startTransaction(),a.Lz(h,!0),t=h.wr,e=0,o=l(f);e<o;e++)(n=t.NR(f[e])).allowMove()&&(i=n.position(),n.position(new r.Point(i.x+c.offsetX,i.y+c.offsetY)));a.Mz(h,!0),c[r.Commands.bWa(h.name())]=h.ITa.endTransaction(),u=l(f)>0}return u},e.prototype.undo=function(){return _(this)},e}(k),e.MovingFloatingObjectUndoAction=O,D=function(t){function e(e,o){return t.call(this,e,o)||this}return L(e,t),e.prototype.execute=function(){var t,e,o,n,i,a=this,u=!1,c=a.VQ,f=c.floatingObjects,h=a.kj;if(function(t,e){var o,n,r=l(e);if(l(e)>0)for(o=0;o<r;o++)(n=t.wr.NR(e[o]))&&n.isSelected(!0)}(h,f),a.canExecute()&&s(f)){for(B(h,c,f),h.ITa.startTransaction(),a.Lz(h,!0),t=h.wr,e=0,o=l(f);e<o;e++)i=(n=t.NR(f[e])).position(),n.width(n.width()+c.offsetWidth),n.height(n.height()+c.offsetHeight),n.position(new r.Point(i.x+c.offsetX,i.y+c.offsetY));a.Mz(h,!0),c[r.Commands.bWa(h.name())]=h.ITa.endTransaction(),u=l(f)>0}return u},e.prototype.undo=function(){return _(this)},e}(k),e.ResizingFloatingObjectUndoAction=D,F=function(t){function e(){var e=t.call(this)||this;return e.kj=null,e}return L(e,t),e.prototype.canExecute=function(){var t=this.VQ.floatingObjects;return!!(l(t)>0&&this.ES(t))},e.prototype.canUndo=function(){var t=r.Commands.bWa(this.kj.name()),e=this.VQ[t],o=e&&e.CUa;return!!(o&&l(o)>0)},e.prototype.ES=function(t){var e,o,n,r=this.kj,i=r.wr;for(e=0,o=l(t);e<o;e++)if((n=i.NR(t[e]))&&!r.ER(n))return!1;return!0},e.prototype.zS=function(t){return t&&"Slicer"===t.typeName},e}(r.Commands.ActionBase),e.FloatingObjectCopyPasteUndoAction=F,E=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.OFFSET=15,r.kj=e,r.VQ=o,c(o.clipboardFloatingObjectData)&&(o.clipboardFloatingObjectData=o.fromSheet.CR),n}return L(e,t),e.prototype.execute=function(){var t,e,o,n,i,a,s,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,M,k,N,O,D,F,E,j,P=this,L=P.VQ,_=L.floatingObjects;if(P.canExecute()){for(t=P.kj,e=L.fromSheet,t.ITa.startTransaction(),P.Lz(t,!0),o=[],n=t.wr,i=L.clipboardFloatingObjectData,void 0===L.Jl&&(G(t)&&n.zR().forEach((function(t){t&&t[I]()&&o.push(t)})),L.Jl=P.kj.getActiveRowIndex(),L.GS=P.kj.getActiveColumnIndex()),G(t)&&n.zR().forEach((function(t){t&&t[I]()&&t[I](!1)})),a=[],s=void 0,c=void 0,h=f=Number.MAX_VALUE,p=f,d=[],c=l(_),s=0;s<c;s++)g=i.find(_[s]).position(),h=u(h,g.x),p=u(p,g.y),d.push(new r.Point(g.x-h,g.y-p));if(m=0,y=0,o.length)C=f,v=f,o.forEach((function(t){if(t){var e=t.position();C=u(C,e.x),v=u(v,e.y)}})),m=C<f?C+P.OFFSET:0,y=v<f?v+P.OFFSET:0;else{for(b=0;b<L.Jl;b++)y+=t.Yr(b,3);for(w=0;w<L.GS;w++)m+=t.$r(w,3)}for(c=l(_),s=0;s<c;s++)T=d[s],a.push(new r.Point(m+T.x,y+T.y));for(S=L.isCutting,x=e.wr,A=[],M=[],c=l(_),s=0;s<c;s++)(N=(k=i.find(_[s])).clone(t)).sheet(t),A.push(N),M.push(k);if(O=!1,D={sheet:t,sheetName:t.name(),objects:A,cancel:!1},t.Wq(r.Events.ClipboardPasting,D),!D.cancel){for(s=0;s<c;s++)N=A[s],F=void 0,E=!1,k=M[s],!S||x.NR(_[s])||n.NR(_[s])?(E=N.name()===k.name())&&(j=z(N),F=P.zS(N)?t.slicers.HS(N[R]()):n.FS(j)):F=k.name(),E&&N[R](F),P.zS(N)&&(t.slicers.Cz(N),N.width(k.width()),N.height(k.height())),N.isVisible(!0),N.position(a[s]),N[I](!0),n.Sb(N);B(t,L,null,A,!0),t.Wq(r.Events.ClipboardPasted,{sheet:t,sheetName:t.name(),objects:A}),O=!0}return P.Mz(t,!0),L[r.Commands.bWa(t.name())]=t.ITa.endTransaction(),O||(L.vgc=!0),O}return!1},e.prototype.undo=function(){var t,e,o=this;return!!o.canUndo()&&(t=o.kj,o.Lz(t,!0),e=r.Commands.bWa(t.name()),t.ITa.undo(o.VQ[e]),o.Mz(t,!0),!0)},e}(F),e.ClipboardPasteFloatingObjectUndoAction=E,j=function(t){function e(e,o){var n=t.call(this)||this,r=n;return r.kj=e,r.VQ=o,n}return L(e,t),e.prototype.execute=function(){var t,e,o,n,i,a,s,u,c=this,f=!1,h=c.VQ,p=h.floatingObjects,d=c.kj;if(c.canExecute()){for(B(d,h,p),d.ITa.startTransaction(),c.Lz(d,!0),t=d.wr,e=l(p),o=0;o<e;o++)(n=t.NR(p[o]))&&((i=n.clone(d)).sheet(d),a=n.position(),i.position(new r.Point(a.x+h.offsetX,a.y+h.offsetY)),i[R](t.FS()),i[I](!0),n[I](!1),c.zS(i)&&d.slicers&&(s=i,u=d.slicers.HS(s.columnName()),s[R](u),d.slicers.Cz(s)),t.Sb(i));c.Mz(d,!0),h[r.Commands.bWa(d.name())]=d.ITa.endTransaction(),f=!0}return f},e.prototype.undo=function(){var t,e=this,o=e.kj;return!!e.canUndo()&&(e.Lz(o,!0),t=r.Commands.bWa(o.name()),o.ITa.undo(e.VQ[t]),e.Mz(o,!0),!0)},e}(F),e.DragCopyFloatingObjectUndoAction=j,r.Commands[f]={canUndo:!1,execute:function(t,e){var o=r.Commands.bT(t,e);return!!G(o)&&(o.suspendPaint(),o.uQ(),o.GJ(),o.resumePaint(),!0)}},r.Commands[v]={canUndo:!1,execute:function(t,e){var o=r.Commands.bT(t,e);o.isEditing()||(o.suspendPaint(),o.wr.zR().forEach((function(t){t[I](!0)})),o.resumePaint())}},r.Commands[h]={canUndo:!0,execute:function(t,e,o){var n,i=r.Commands.bT(t,e);return o||(e.cmd||(e.cmd=h),e.floatingObjects||(n=V(i),e.floatingObjects=n)),l(e.floatingObjects)>0&&M(t,N,e,o)}},r.Commands[p]={canUndo:!1,execute:function(t,e){var o,n,i,a,s,l,u,c=r.Commands.bT(t,e);if(G(c)){for(c.suspendPaint(),o=void 0,n=void 0,i=void 0,a=void 0,l=(s=c.wr.zR()).length,a=0;a<l;a++){if(u=s[a],n||(n=u),o){i=u;break}u&&u[I]()&&(o=u)}return c.uQ(),i||(i=n),i&&i[I](!0),c.resumePaint(),!0}return!1}},r.Commands[d]={canUndo:!1,execute:function(t,e){var o,n,i,a,s,l,u=r.Commands.bT(t,e);if(G(u)){for(u.suspendPaint(),o=void 0,n=void 0,i=void 0,s=(a=u.wr.zR()).length,i=0;i<s;i++)if(l=a[i],o||(o=l),o[I]())n=l;else if(l[I]()||(n=l),l[I]())break;return n&&(u.uQ(),n[I](!0)),u.resumePaint(),!0}return!1}},r.Commands[g]={canUndo:!0,execute:function(t,e,o){var n,i,a,s,u,c,f=!1;return o?f=M(t,N,e,o):(n=r.Commands.bT(t,e),e.cmd||(e.cmd=g),i=n.BR(),e.floatingObjects||(a=V(n),e.floatingObjects=a,e.fromSheet=i.fromSheet,e.isCutting=i.isCutting),s=e.floatingObjects,u=void 0,c=void 0,void 0,l(s)>0&&(c=s.map((function(t){return n.wr.NR(t)})),u={sheet:n,sheetName:n.name(),objects:c,cancel:!1},n.Wq(r.Events.ClipboardChanging,u),u.cancel?e.vgc=!0:(H(n,s,!0)&&(n.Sob&&n.Sob(),r.Commands.Yxb(n.parent)),f=M(t,N,e,o),n.Wq(r.Events.ClipboardChanged,{sheet:n,sheetName:n.name(),objects:c})))),f}},r.Commands[m]={canUndo:!1,execute:function(t,e){var o,n,i,a=r.Commands.bT(t,e),s=function(t){var e=[];return t.wr.zR().forEach((function(t){t[I]()&&e.push(t[R]())})),e}(a);if(l(s)>0){if(o=s.map((function(t){return a.wr.NR(t)})),n={sheet:a,sheetName:a.name(),objects:o,cancel:!1},a.Wq(r.Events.ClipboardChanging,n),!n.cancel)return(i=H(a,s,!1))&&(a.Sob&&a.Sob(),r.Commands.Yxb(a.parent)),a.Wq(r.Events.ClipboardChanged,{sheet:a,sheetName:a.name(),objects:o}),i;e.vgc=!0}return!1}},r.Commands[y]={canUndo:!0,execute:function(t,e,o){var n,i,a,s,u=r.Commands.bT(t,e);return!u.isEditing()&&(!!(a=(i=(n=u.BR()).fromSheet)&&i.CR)&&(s=[],a.each((function(t){s.push(t[R]())})),0!==l(s)&&!u.Js&&(o||(e.cmd||(e.cmd=y),e.floatingObjects||(e.floatingObjects=s,e.fromSheet=i,e.isCutting=n.isCutting)),l(e.floatingObjects)>0&&M(t,E,e,o))))}},r.Commands[C]={canUndo:!0,execute:function(t,e,o){return M(t,j,e,o)}},function(t){t[t.left=0]="left",t[t.up=1]="up",t[t.right=2]="right",t[t.down=3]="down"}(P||(P={})),r.Commands[S]=U(P.left),r.Commands[w]=U(P.up),r.Commands[x]=U(P.right),r.Commands[T]=U(P.down),r.Commands[b]={canUndo:!0,execute:function(t,e,o){return(0!==e.offsetX||0!==e.offsetY)&&M(t,O,e,o)}},r.Commands[A]={canUndo:!0,execute:function(t,e,o){return M(t,D,e,o)}},r.Commands.JR=function(t){var e=r.Ul.sl(),o=!e,n=e;t.register(f,r.Commands[f],27,!1,!1,!1,!1),t.register(v,r.Commands[v],65,o,!1,!1,n),t.register(h,r.Commands[h],e?8:46,!1,!1,!1,!1),t.register(p,r.Commands[p],9,!1,!1,!1,!1),t.register(d,r.Commands[d],9,!1,!0,!1,!1),t.register(g,r.Commands[g],88,o,!1,!1,n),t.register(m,r.Commands[m],67,o,!1,!1,n),t.register(C,r.Commands[C]),t.register(y,r.Commands[y],86,o,!1,!1,n),t.register(b,r.Commands[b]),t.register(w,r.Commands[w],38,!1,!1,!1,!1),t.register(T,r.Commands[T],40,!1,!1,!1,!1),t.register(S,r.Commands[S],37,!1,!1,!1,!1),t.register(x,r.Commands[x],39,!1,!1,!1,!1),t.register(A,r.Commands[A])}},"./dist/plugins/floatingObject/floatingobject-touch.js":function(t,e,o){"use strict";var n,r,i,a,s,l;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Touch"),r=o("Core"),i=o("./dist/plugins/floatingObject/floatingobject.js"),a=r.Ul.nl,s=function(){function t(t,e,o){var r,i,a=this;a.yM=new n.jR(a),a.DQ=new n.kR(t,"FL_"+e.name,a.yM,2,200),a.BQ=o,a.CQ=new l(t,e),r=a.CQ,(i=a.DQ)._M=function(){return e.YR.isSelected()},i.bN=function(){return!0},i.dN=function(t){return r.jQ(t)},i.eN=function(t){return r.lQ(t)},i.fN=function(t){return r.pQ(t)},i.hN=function(t){return r.qQ(t)},i.iN=function(t){return r.sQ(t)}}return t.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},t.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),l=function(){function t(t,e){var o=this;o.MS=e,o.YR=e.YR,o.NS=t,o.hQ=new n.TP(e.kj)}return t.prototype.OS=function(t){var e,o=new n.oP(t.X,t.Y),i=r.GC$(this.NS).offset();return i&&(e=document.body,o.X+=i.left+e.clientLeft||0,o.Y+=i.top+e.clientTop||0),o},t.prototype.jQ=function(t){t.DO=3},t.prototype.lQ=function(t,e){var o=this,n=e?t.rN:o.OS(t.rN);o.MS.AD({target:t.GP,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}),e||o.hQ.OP()},t.prototype.pQ=function(t,e){var o=this,n=e?t.rN:o.OS(t.rN),r=t.dP.rO,i=o.MS.kj,a=i.parent;1!==r&&a&&a.options.allowUserZoom&&!e?(i.mm.O3=!1,o.MS.rS(),o.hQ.PP(r)):o.MS.BD({isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}})},t.prototype.qQ=function(t,e){var o=this,n=e?t.rN:o.OS(t.rN),r=t.dP.rO,i=o.MS.kj.parent;1!==r&&i&&i.options.allowUserZoom&&!e?o.hQ.SP(r):this.MS.CD({isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}})},t.prototype.sQ=function(e,o){var n,i=this,a={e:{rN:o?e.rN:i.OS(e.rN)},r:null};if(t.ao(i,"preProcessTapped",a),!a.r)try{(n=i.MS.kj).suspendPaint(),i.YR.isSelected()||(n.uQ(),i.YR.isSelected(!0),n.Wq(r.Events.FloatingElementSelected,{type:"floatingObject"}),r.Vl.Zl(n)),n.clearSelection()}finally{n.resumePaint()}},t}(),e.FloatingObjectTouchEventHandler=l,r.Zn(l),r.Rxb.touch&&i.FloatingObjectRender.$n("touch",{init:function(t){var e=this;(e.wR=new s(t,e,e.kj.parent.BQ)).EQ()},dispose:function(){var t=this.wR;t&&t.FQ()},preProcessMouseDown:function(t){var e=t.e,o=this.wR;o&&!e.isTouch&&o.GQ(e)&&(a(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,o=this.wR;o&&!e.isTouch&&o.IQ(e)&&(a(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,o=this.wR;o&&!e.isTouch&&o.HQ(e)&&(a(e),t.r=!0)}})},"./dist/plugins/floatingObject/floatingobject.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/floatingObject/picture.js")),n(o("./dist/plugins/floatingObject/floatingobject.js")),n(o("./dist/plugins/floatingObject/floatingobject-actions.js")),n(o("./dist/plugins/floatingObject/floatingobject-touch.js")),n(o("./dist/plugins/floatingObject/floatingobject.ns.js"));var r=o("./dist/plugins/floatingObject/drawing/chart.ns.js");e.Drawing=r},"./dist/plugins/floatingObject/floatingobject.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt;function rt(t,e,o,n,r){var i=r[R.mHc](),a=r[R.oHc](),s=r[R.qHc](),l=r[R.sHc]();return t<=i&&e<=a&&o>=s&&n>=l}function it(t,e){var o=this;return e||(e={}),n.GC$.each(t,(function(t,n){var r=o[n],i=r.call(o);r.isDefault(i)||(e[n]=i)})),e}function at(t,e){if(e){var o=this;n.GC$.each(t,(function(t,n){e[n]!==w&&o[n].call(o,e[n],!1)}))}}function st(t){var e=t;return function(t,o){var n=this,r=n.sheet();e===R.$Hc&&(n.KR=!0),r&&r.$p(),n.onPropertyChanged(e,t,o)}}function lt(t){var e=t;return function(t,o){var n=this,r=n.sheet();r&&(ct(n),n.CXc||gt(n),r.$p()),n.onPropertyChanged(e,t,o)}}function ut(t){var e=t;return function(t,o){var n=this,r=n.sheet();r&&(wt(n),r.$p()),n.onPropertyChanged(e,t,o)}}function ct(t){var e,o,r,i,a=t.sheet();function s(e,o,n,r){var i=0,s=e.call(t);return i=o.call(t,a,0,s),ft.call(t,e,n,r),i+n.call(t)}a&&(e=s(t[R.mHc],ht,t[R.nHc],a.getRowHeight),o=s(t[R.oHc],pt,t[R.pHc],a.getColumnWidth),r=t.x(),i=t.y(),r===o&&i===e||(t.x(o,!1),t.y(e,!1),t.onPropertyChanged("position",new n.Point(o,e),new n.Point(r,i))))}function ft(t,e,o){var n=this,r=e.call(n),i=o.call(n.sheet(),t.call(n),3);i>0&&i--,r>i&&e.call(n,i,!1)}function ht(t,e,o,n){var r,i=0;for(r=e;r<o&&!((i+=t.getRowHeight(r,3))>n);r++);return i}function pt(t,e,o,n){var r,i=0;for(r=e;r<o&&!((i+=t.getColumnWidth(r,3))>n);r++);return i}function dt(t){var e=t.sheet();function o(e,o,n,r,i){var a=mt(t,e,o),s=a.index;r.call(t,a.offset,!1),-1===a.offset&&(s+=1,r.call(t,0),s===i&&(s=i-1)),n.call(t,s,!1)}e&&(o(!0,t.y(),t[R.mHc],t[R.nHc],e.getRowCount()),o(!1,t.x(),t[R.oHc],t[R.pHc],e.getColumnCount()))}function gt(t){function e(e,o,n,r){var i=mt(t,e,o);n.call(t,i.index,!1),r.call(t,i.offset,!1)}t.sheet()&&(e(!0,t.y()+t[R.jGc](),t[R.qHc],t[R.rHc]),e(!1,t.x()+t[R.iGc](),t[R.sHc],t[R.tHc]))}function mt(t,e,o){var n,r,i=0,a=0,s=t.sheet(),l=e?s.getRowCount():s.getColumnCount();for(n=0;n<l;n++){if((a=(i+=r=e?s.getRowHeight(n,3):s.getColumnWidth(n,3))-o)>0){a=a>0?r-a:-1;break}if(0===a){a=0,n+=1;break}}return n>=l&&(n=l-1,a=e?s.getRowHeight(n,3):s.getColumnWidth(n,3)),{offset:a,index:n}}function yt(t,e){t&&(t.style.zIndex=e+"")}function Ct(t){var e=t.PR;return f(e)&&(e=t.Cka),e}function vt(t){var e=t.sheet();t.isNeedToUpdateLayout=!0,e.QP(e.Dr())}function bt(t,e,o){return o&&o.width>0&&o.height>0&&(o.x===t||o.y===e||o.contains(t,e))}function wt(t){var e,o,n,r,i=t.sheet();function a(e,o,n,r,a,s){var l=0,u=e.call(t),c=o.call(t);return l=n.call(t,i,u,c),u===c?(ft.call(t,o,s,r),l=s.call(t)-a.call(t)):(r.call(i,u,3)>0&&(l-=a.call(t)),ft.call(t,o,s,r),l+=s.call(t)),l}i&&(e=a(t[R.mHc],t[R.qHc],ht,i.getRowHeight,t[R.nHc],t[R.rHc]),(o=a(t[R.oHc],t[R.sHc],pt,i.getColumnWidth,t[R.pHc],t[R.tHc]))<0&&(o=0),e<0&&(e=0),(n=t[R.iGc]())!==o&&(t[R.iGc](o,!1),t.onPropertyChanged(R.iGc,o,n)),(r=t[R.jGc]())!==e&&(t[R.jGc](e,!1),t.onPropertyChanged(R.jGc,e,r)))}function Tt(t){return Z.indexOf(t)>=0}function St(t){return function(e,o){this.onPropertyChanged(t,e,o)}}function xt(t,e){return function(o,n){var r=this,i=r.sheet();i&&(e&&Rt(r),Mt(r),Ot(r),i.$p()),r.onPropertyChanged(t,o,n)}}function At(t,e,o,n){var r,i,a=this;a.CXc=!0,r=t.call(a),i=e.call(a),o<=r?a.dynamicMove()&&(t.call(a,r+n),e.call(a,i+n)):o<i&&a.dynamicSize()&&e.call(a,i+n),a.CXc=!1}function It(t,e,o,n,r,i,a){var s,l,u,c=this;c.CXc=!0,s=t.call(c),l=o.call(c),r<=s?a<s?c.dynamicMove()&&(t.call(c,s-i),o.call(c,l-i)):a<l&&(u=l-s+1-(a-s+1),c.dynamicMove()&&(t.call(c,r),e.call(c,0)),c.dynamicSize()&&o.call(c,r+u-1)):r<=l&&(a<l?c.dynamicSize()&&o.call(c,l-i):c.dynamicSize()&&(o.call(c,r),n.call(c,0))),c.CXc=!1}function Rt(t){var e=kt(t,t[R.jGc]()),o=Nt(t,t[R.iGc]());t[R.iGc]()>o&&t[R.iGc](o,!1),t[R.jGc]()>e&&t[R.jGc](e,!1)}function Mt(t){var e,o,n=t.x()+t[R.iGc](),r=Nt(t,n);n>r&&t.x(x(0,r-t[R.iGc]()),!1),t.x()<0&&t.x(0,!1),(e=t.y()+t[R.jGc]())>(o=kt(t,e))&&t.y(x(0,o-t[R.jGc]()),!1),t.y()<0&&t.y(0,!1)}function kt(t,e){var o,n=t.sheet();return n?(o=n.getRowCount(),ht(n,0,o,e)):R.gHc}function Nt(t,e){var o,n=t.sheet();return n?(o=n.getColumnCount(),pt(n,0,o,e)):R.gHc}function Ot(t){dt(t),gt(t)}function Dt(t,e,o,n,r,i,a){var s,l=0,u=a?i.getRowHeight:i.getColumnWidth;for(s=t;s<e;s++)l+=T(u.call(i,s)*r);return(l-=T((o||0)*r))+T((n||0)*r)}function Ft(t,e,o,n){var r,i=0;for(r=0;r<t;r++)i+=n?o.getRowHeight(r,3):o.getColumnWidth(r,3);return i+e}function Et(t){var e=n.GC$(t),o=e.position();return new n.Rect(o.left,o.top,e[R.iGc](),e[R.jGc]())}function jt(t,e,o,r,i,a){n.GC$(t).css([R.OLb,R.fGc,R.iGc,R.jGc],[[r-1],[o-1],i,a]).addClass(R.QHc).appendTo(e)}function Pt(t){var e,o,n,r,i,a=t,s=a.kj,l=a.WE,u=a.aS,c=s.frozenTrailingRowCount(),f=s.frozenTrailingColumnCount(),h=s.am(),p=h.Ft(l,u),d=a.YR,g=d[R.mHc](),m=d[R.oHc](),y=d[R.qHc](),C=d[R.sHc](),v=s.frozenRowCount(),b=s.frozenColumnCount(),w=s.getRowCount(3)-c-1,T=s.getColumnCount(3)-f-1;return l===R.fHc?(v>0&&(e=s.getViewportTopRow(l),(g<v||e===v)&&(p.y-=h.fs,p[R.jGc]+=h.fs)),c>0&&(o=s.getViewportBottomRow(l),y>w&&o===w&&(p[R.jGc]+=h.gs))):l===R.fHc-1?(y>=(e=s.getViewportTopRow(l+1))||e===v)&&(i=h.Ft(l+1,u),p[R.jGc]+=i[R.jGc]):l===R.fHc+1&&((g<=(o=s.getViewportBottomRow(l-1))||o===w)&&(i=h.Ft(l-1,u),p.y=i.y,p[R.jGc]+=i[R.jGc])),u===R.fHc?(b>0&&(n=s.getViewportLeftColumn(u),(m<b||n===b)&&(p.x-=h.hs,p[R.iGc]+=h.hs)),s.frozenTrailingColumnCount()>0&&(r=s.getViewportRightColumn(u),(C>T||r===T)&&(p[R.iGc]+=h.js))):u===R.fHc-1?(C>=(n=s.getViewportLeftColumn(u+1))||n===b)&&(i=h.Ft(l,u+1),p[R.iGc]+=i[R.iGc]):u===R.fHc+1&&((m<=(r=s.getViewportRightColumn(u-1))||r===T)&&(i=h.Ft(l,u-1),p.x=i.x,p[R.iGc]+=i[R.iGc])),p}function Lt(t,e,o,r,i){var a=Et(t);n.GC$(t).css([R.OLb,R.fGc,R.iGc,R.jGc],[a.y+o,a.x+e,a[R.iGc]+r,a[R.jGc]+i])}function Gt(t){var e,o,r,i,a,s,l,u,c,f,h,p,d=t;if(d.bS)for(p in e=d.$F,o=Pt(d),r=d.cS,void 0,a=function(t,e,o){var r,i,a,s,l=t.$R;switch(e){case L:r=A(l[R.gIc]+l[R.iIc],o.x),i=A(l[R.hIc]+l[R.jIc],o.y),a=I(o.x-l[R.gIc]-l[R.iIc]),s=I(o.y-l[R.hIc]-l[R.jIc]);break;case G:r=l[R.gIc],i=A(l[R.hIc]+l[R.jIc],o.y),a=l[R.iIc],s=I(o.y-l[R.hIc]-l[R.jIc]);break;case B:r=A(l[R.gIc],o.x),i=A(l[R.hIc]+l[R.jIc],o.y),a=I(o.x-l[R.gIc]),s=I(o.y-l[R.hIc]-l[R.jIc]);break;case _:r=A(l[R.gIc]+l[R.iIc],o.x),i=l[R.hIc],a=I(o.x-l[R.gIc]-l[R.iIc]),s=l[R.jIc];break;case V:r=A(l[R.gIc],o.x),i=l[R.hIc],a=I(o.x-l[R.gIc]),s=l[R.jIc];break;case H:r=A(l[R.gIc]+l[R.iIc],o.x),i=A(l[R.hIc],o.y),a=I(o.x-l[R.gIc]-l[R.iIc]),s=I(o.y-l[R.hIc]);break;case z:r=l[R.gIc],i=A(l[R.hIc],o.y),a=l[R.iIc],s=I(o.y-l[R.hIc]);break;case U:r=A(l[R.gIc],o.x),i=A(l[R.hIc],o.y),a=I(o.x-l[R.gIc]),s=I(o.y-l[R.hIc])}return new n.Rect(r,i,a,s)}(d,(i=d.$R).direction,e=new n.Point(e.x-o.x,e.y-o.y)),i.endX=a.x,i.endY=a.y,i.endWidth=a[R.iGc],i.endHeight=a[R.jGc],s=Et(r),l=a.y-s.y,Lt(r,u=a.x-s.x,l,c=a[R.iGc]-s[R.iGc],f=a[R.jGc]-s[R.jGc]),h=d.dS)v(h,p)&&Lt(h[p].moveResizeDiv,u,l,c,f)}function Bt(t,e){var o=t.kj;o&&(!1===o.RF(e)&&n.Ul.nl(e))}function _t(t,e,o){var r=n.GC$(t),i=n.GC$(t).position();r.css([R.OLb,R.fGc],[i[R.OLb]+o,i[R.fGc]+e])}function Vt(t){var e,o,r,i,a,s,l,u=t,c=u.hS&&u._R;if(c&&!u.cS){for(s in e=u.iS=g(R.VKb),u.cS=g(R.VKb),u.dS={},u.gS.jS.each((function(t){var e,o=t.YR;o&&o.name()!==u.YR.name()&&o.isSelected()&&!u.dS[o.name()]&&(e=t._R,u.dS[o.name()]={offsetX:e.x-c.x,offsetY:e.y-c.y,height:e[R.jGc],width:e[R.iGc],moveResizeDiv:g(R.VKb)})})),o=Pt(u),n.GC$(e).css([R.dHc,R.OLb,R.fGc,R.iGc,R.jGc,R.HHc],[R.EHc,o.y,o.x,o[R.iGc],o[R.jGc],"rgba(255,255,255,0.01)"]).addClass(R.PHc).bind(R.eIc,(function(t){u.BD(t)})).bind(R.fIc,(function(t){u.CD(t)})),r=c.y-o.y,i=c.x-o.x,jt(u.cS,e,i,r,c[R.iGc],c[R.jGc]),a=u.dS)v(a,s)&&jt((l=a[s]).moveResizeDiv,u.iS,i+l.offsetX,r+l.offsetY,l[R.iGc],l[R.jGc]);u.Ks&&n.GC$(u.Ks).append(u.iS)}}function Ht(t){var e=t;e.RB||(n.GC$(C).bind(R.eIc+R.iHc,(function(t){e.BD(t)})).bind(R.fIc+R.iHc,(function(t){e.CD(t)})),e.RB=!0)}function zt(t,e,o,r,i,a,s,l,u,c){var h,p,d,g,m=t,y=n.GC$(o,m.hS),C=tt.mS;e?y.css([R.fGc,R.OLb,R.gGc,R.hGc,R.iGc,R.jGc,R.DGc],[r,i,a,s,C,C,l]).addClass(R.LHc).attr("resizeDirection",u):Ut(m,o),c&&(h=n.GC$(m.hS),p=0,d=0,f(r)||(p=r),f(i)||(d=i),f(a)||(p=h.width()-a-C),f(s)||(d=h.height()-s-C),g=new n.Rect(p,d,C,C),c.push({rect:g,cursor:l,direction:u}))}function Ut(t,e){n.GC$(e,t.hS).removeClass(R.LHc).addClass(R.MHc)}function Wt(t,e){n.GC$(R.RHc,e).removeClass(R.LHc).addClass(R.MHc),t.ZR=!1}function qt(t,e,o,n){var r,i,a,s,l,u,c,f,h=t.kj,p=new y,d=h.wr;return d.isNeedToUpdateLayout&&(function(t){t.zR().forEach((function(t){t.dynamicMove()?ct(t):dt(t),t.dynamicSize()?wt(t):gt(t)}))}(d),d.isNeedToUpdateLayout=!1),r=h.am(),i=h.ss,a=h.it(o),s=h.jt(e),a.length<=0||s.length<=0||(l=a[0],u=a[a.length-1],c=s[0],f=s[s.length-1],d.zR().forEach((function(t){var e,o,d,g,m,y,C,v,b,w,T,S,x,A,I;if(t&&t.isVisible()){if(e=void 0,o=void 0,d=t[R.mHc](),g=t[R.oHc](),m=t[R.qHc](),y=t[R.sHc](),t.fixedPosition())e=(C=t.position()).x*n+r.kt,o=C.y*n+r.nt;else{if(v=a.findCol(g))e=v.x;else if(g<l.col)for(e=l.x,b=l.col-1;b>=g;b--)e-=i._m(b);else for(e=u.x+u[R.iGc],w=u.col+1;w<=g;w++)e+=i._m(w);if(e+=t[R.pHc]()*n,T=s.findRow(d))o=T.y;else if(d<c.row)for(o=c.y,S=c.row-1;S>=d;S--)o-=i.Sl(S);else for(o=f.y+f[R.jGc],x=f.row+1;x<=d;x++)o+=i.Sl(x);o+=t[R.nHc]()*n}void 0,void 0,A=t.wxb(n),I=t.xxb(n),function(t,e,o,n,r){var i,a,s;if(t.rowOutlines)for(i=!0,s=e;s<=n;s++)if(!t.rowOutlines.isCollapsed(s)){i=!1;break}if(t.columnOutlines)for(a=!0,s=o;s<=r;s++)if(!t.columnOutlines.isCollapsed(s)){a=!1;break}return i||a}(h,d,g,m,y)||p.push({name:t.name(),x:e,y:o,width:A,height:I})}}))),p}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/floatingObject/floatingobject.ns.js"),a=function(){function t(){this.rM={}}return t.prototype.push=function(t){this.rM[function(t){return"string"==typeof t[R.jHc]?t[R.jHc]:t[R.jHc]()}(t)]=t},t.prototype.remove=function(t){delete this.rM[t]},t.prototype.find=function(t){return this.rM[t]},t.prototype.empty=function(){delete this.rM,this.rM={}},t.prototype.each=function(t){var e,o=this.rM;for(e in o)o.hasOwnProperty(e)&&t(o[e])},t.prototype.isEmpty=function(){var t,e=this.rM;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},t}(),e.yR=a,s=new r.Common.ResourceManager(i.SR,"FloatingObjects"),l=s.getResource.bind(s),u=r.Common.j,c=r.Common.D,f=u.Fa,h=u.Ma,p=n.Ul.Pl,d=n.Ul.Ol,g=n.Ul.Nl,m=n.Ul.Rl,y=a,C=document,v=c,b=null,w=void 0,T=Math.ceil,S=Math.floor,x=Math.max,A=Math.min,I=Math.abs,M=(R={VKb:"div",cHc:"on",dHc:"z-index",dGc:"move",eHc:"unselectable",fHc:1,JLb:"border",gHc:9007199254740992,hHc:"floatingObjects",iHc:".gcFloatingObject",jHc:"name",kHc:"scroll",hFc:"x",lHc:"y",iGc:"width",jGc:"height",mHc:"startRow",nHc:"startRowOffset",oHc:"startColumn",pHc:"startColumnOffset",qHc:"endRow",rHc:"endRowOffset",sHc:"endColumn",tHc:"endColumnOffset",uHc:"isSelected",vHc:"isLocked",wHc:"isVisible",xHc:"canPrint",yHc:"dynamicSize",zHc:"dynamicMove",AHc:"fixedPosition",BHc:"allowResize",CHc:"allowMove",DHc:700,EHc:701,FHc:"position",GHc:"absolute",HHc:"background",IHc:"gc-no-user-select",JHc:"gc-floatingobject-selected",KHc:"gc-floatingobject-unselected",LHc:"gc-floatingobject-resize-indicator-select",MHc:"gc-floatingobject-resize-indicator-unSelect",NHc:"gc-floatingobject-content-container",OHc:"gc-floatingobject-container",PHc:"gc-floatingobject-moving-container",QHc:"gc-floatingobject-moving-div",RHc:".gc-floatingobject-resize-indicator",SHc:"gc-floatingobject-resize-indicator",THc:"gc-floatingobject-absolute",UHc:"gc-floatingobject-top",VHc:"gc-floatingobject-middle",WHc:"gcfloatingobject-bottom",XHc:"gc-floatingobject-left",YHc:"gc-floatingobject-center",ZHc:"gc-floatingobject-right",$Hc:"content",HGc:"gc-no-user-select",_Hc:"100%",aIc:"gc-floatingobject-background-cover",bIc:".fos",fGc:"left",cIc:"center",gGc:"right",OLb:"top",dIc:"middle",hGc:"bottom",VGc:"-resize",DGc:"cursor",eIc:"mousemove",fIc:"mouseup",gIc:"startX",hIc:"startY",iIc:"startWidth",jIc:"startHeight",kIc:"endX",lIc:"endY",mIc:"startTopRow",nIc:"startLeftColumn"}).VKb+"."+R.SHc,k=M+"."+R.UHc+"."+R.XHc,N=M+"."+R.VHc+"."+R.XHc,O=M+"."+R.WHc+"."+R.XHc,D=M+"."+R.UHc+"."+R.YHc,F=M+"."+R.WHc+"."+R.YHc,E=M+"."+R.UHc+"."+R.ZHc,j=M+"."+R.VHc+"."+R.ZHc,P=M+"."+R.WHc+"."+R.ZHc,L=R.OLb+R.fGc,G=R.OLb+R.cIc,B=R.OLb+R.gGc,_=R.dIc+R.fGc,V=R.dIc+R.gGc,H=R.hGc+R.fGc,z=R.hGc+R.cIc,U=R.hGc+R.gGc,W=function(){var t=this;t.uQ=function(){var t=this.wr;t&&t.zR().forEach((function(t){t.isSelected(!1)}))},t.AR=function(){var t=this.wr;t&&(t.isNeedToUpdateLayout=!0)},t.BR=function(){var t=this,e=t.parent,o=t.tv,n=e&&e.tv;return o||(o=t.tv=n||{fromSheet:b,isCutting:!1}),o},t.ex=function(){var t=this.BR(),e=t&&t.fromSheet;e&&(e.CR=b),t.fromSheet=b,t.isCutting=!1},t.DR=function(t){var e=this.options;return!e.isProtected||!t.isLocked()||e.protectionOptions.allowEditObjects},t.ER=function(t){var e=this.options;return!e.isProtected||!t.isLocked()||e.protectionOptions.allowEditObjects},t.isPasteFloatingObject=function(){var t=this.BR().fromSheet,e=this.CR;return!e&&t&&(e=t.CR),e&&!e.isEmpty()},t.IR=function(t,e){var o=this;return o.FR||(o.FR=[]),o.FR[t]||(o.FR[t]=[]),o.FR[t][e]||(o.FR[t][e]=new et(o)),o.FR[t][e]},t.QP=function(t,e){var o,n,r,i,a=this;if(!a.fI&&a.wr&&a.yl&&a.yl.bm())for(o=a.am(),void 0,e!==b&&void 0!==e||(e=a.zoom()),n=0;n<=2;n++)for(r=0;r<=2;r++)o.Ft(n,r)&&((i=a.IR(n,r))&&i.yl(n,r,e))}},W.call(n.Worksheet.prototype),e.toJsonFn=it,e.fromJsonFn=at,e.propertyRefreshCallback=st,q=function(){function t(t,e){this.kj=t,this.g3=e}return t.prototype.no=function(){this.kj=b},t.prototype.add=function(t,e,o,n,r,i,a,s){var l,u=this;return"1"===u.g3?l=Q.ozb(t,e,o,n,r,i):"0"===u.g3&&(l=t),u.kj.wr.Sb(l),l},t.prototype.get=function(t){return this.kj.wr.NR(t)},t.prototype.remove=function(t){this.kj.wr.Fb(t)},t.prototype.clear=function(){return this.kj.wr.$b(this.g3)},t.prototype.all=function(){return this.kj.wr.zR(this.g3)},t.prototype.zIndex=function(t,e){return this.kj.wr.PR(t,e)},t.prototype.tTa=function(t,e,o){this.all().forEach((function(n){var r=o?n.startRow():n.startColumn(),i=o?n.endRow():n.endColumn();e<r||t>i||!n.dynamicSize()||wt(n),ct(n)}))},t}(),e.FloatingObjectCollection=q,J=function(){function t(t){var e=this;e.sheet(t),function(t){var e=t.sheet();e&&(n.GC$(C.body).bind("scroll"+R.iHc,(function(){var t=e.parent&&e.parent.getActiveSheet();t&&t.wr&&e.QP(t.Dr())})),e.Fu(n.Events.ColumnChanged+R.iHc,(function(e,o){var n=o.propertyName;n!==R.iGc&&n!==R.wHc||vt(t)})),e.Fu(n.Events.RowChanged+R.iHc,(function(e,o){var n=o.propertyName;n!==R.jGc&&n!==R.wHc||vt(t)})),e.Fu(n.Events.ColumnWidthChanged+R.iHc,(function(){vt(t)})),e.Fu(n.Events.RowHeightChanged+R.iHc,(function(){vt(t)})))}(e),e.QR={}}return t.prototype.Dka=function(t){this.zR().forEach((function(e){!function(t,e){f(t.PR)&&(t.Cka+=e)}(e,t)}))},t.prototype.Sb=function(t,e){var o,n=this,r=n.sheet();if(r.suspendPaint(),!(o=t.name()))throw r.resumePaint(),Error(l().Exp_FloatingObjectNameEmptyError);if(n.QR[o]){if(!e)throw r.resumePaint(),Error(l().Exp_FloatingObjectHasSameNameError);o=n.FS(o+"__"),t.name(o)}r.ITa.AUa(),n.Dka(-1),t.sheet(r),n.QR[o]=t,r.Zoa(t),r.resumePaint()},t.prototype.NR=function(t){return this.QR[t]},t.prototype.Fb=function(t,e){var o,r,i,a=this;return!!t&&(o=a.sheet(),r=a.NR(t),o.ITa.AUa(),o.suspendPaint(),e?(i={sheet:o,sheetName:o.name(),floatingObject:r,cancel:!1},o.Wq(n.Events.FloatingObjectRemoving,i),!1===i.cancel&&(delete a.QR[t],o.Wq(n.Events.FloatingObjectRemoved,{sheet:o,sheetName:o.name(),floatingObject:r}))):delete a.QR[t],o.resumePaint(),!0)},t.prototype.U3=function(t,e){var o,n=this,r=n.sheet();if(r.suspendPaint(),!e)throw Error(l().Exp_FloatingObjectNameEmptyError);if(n.QR[e])throw Error(l().Exp_FloatingObjectHasSameNameError);o=n.QR[t],delete n.QR[t],n.QR[e]=o,o.onNameChanged&&o.onNameChanged(t,e),r.resumePaint()},t.prototype.$b=function(t){var e=this,o=e.sheet();o.suspendPaint(),n.GC$.each(this.QR,(function(o,n){t&&t!==n.g3||e.Fb(n.name())})),o.resumePaint()},t.prototype.zR=function(t){var e=[];return n.GC$.each(this.QR,(function(o,n){t&&t!==n.g3||e.push(n)})),e},t.prototype.PR=function(t,e){var o=isNaN(e),n=this.NR(t);if(n){if(o)return Ct(n);!function(t,e){t.PR=e,t.qo.forEach((function(t){for(var o=t.parentElement;-1===o.className.indexOf(R.OHc);)o=o.parentElement;yt(o,e)}))}(n,e)}if(o)return-1},t.prototype.toJSON=function(){var t=[];return this.zR().forEach((function(e){var o,n;e instanceof Q&&e.hga()&&(o=e.toJSON(),n=e.PR,isNaN(n)||(o.zIndex=n),t.push(o))})),t},t.prototype.fromJSON=function(t,e){var o,r,i,a,s,l,u,c,h,p;if(t&&0!==t.length)for(o=0;o<t.length;o++)i=void 0,(r=t[o])&&(a=void 0,s=r.floatingObjectType,"0"===(l=n.Ul.Ol(s)?s+"":r.typeName)?i=new Q:"1"===l?i=Q.ozb():(a=n.getTypeFromString(l))&&(i=new a),i&&(h=(c=(u=this.sheet())&&u.parent)&&c.GBb,i.fromJSON(r,e,h),this.Sb(i),p=r.zIndex,f(p)||(i.PR=p)))},t.prototype.no=function(t){n.GC$(C.body).unbind("scroll"+R.iHc);var e=this,o=e.sheet();o&&(o.Gu(n.Events.ColumnChanged+R.iHc),o.Gu(n.Events.RowChanged+R.iHc),o.Gu(n.Events.ColumnWidthChanged+R.iHc),o.Gu(n.Events.RowHeightChanged+R.iHc)),!1!==t&&(e.QR&&n.GC$.each(e.QR,(function(e,o){o.no(t)})),e.sheet(b))},t.prototype.hitTest=function(t,e,o){var n,r,i,a,s=this.sheet(),l=s.am(),u=b;if(l)for(n=0;n<=2;n++)for(r=0;r<=2;r++)if((i=l.Ft(n,r))&&i.contains(t,e)&&((a=s.IR&&s.IR(n,r))&&a.jS.each((function(n){var r=n.YR;r&&r.isVisible()&&(s.DR(r)||o)&&bt(t,e,n.Tka)&&(u?Ct(u.floatingObject)<Ct(r)&&(u.floatingobject=r):u={x:t,y:e,floatingObject:r,yl:n})})),u))return u;return u},t.prototype.FS=function(t){var e,o;for(t||(t="FloatingObject"),o=t+""+(e=1);this.NR(o);)o=t+""+ ++e;return o},t}(),e.FloatingObjectModel=J,X={sheet:p("sheet",w)},n.GC$.extend(J.prototype,X),Z=["dotted","dashed","solid","double","groove","ridge","inset","outset"],Y=[R.jHc,R.hFc,R.lHc,R.iGc,R.jGc,R.mHc,R.nHc,R.oHc,R.pHc,R.qHc,R.rHc,R.sHc,R.tHc,R.xHc,R.uHc,R.vHc,R.wHc,R.zHc,R.yHc,R.AHc,R.BHc,R.CHc,"alt"],K=[["sheet",b,function(){!function(t){var e,o,n,r;Rt(t),Mt(t),e=t[R.mHc](),o=t[R.oHc](),f(e)||f(o)?dt(t):ct(t),n=t[R.qHc](),r=t[R.sHc](),f(n)||f(r)?gt(t):wt(t)}(this)}],[R.jHc,w,function(t,e){var o,n=this,r=n.sheet();r&&((o=r.wr).NR(e)===n&&o.U3(e,t)),n.onPropertyChanged("name",t,e)},function(t){var e;if(d(t)&&("string"!=typeof t||""===t))throw Error(l().Exp_FloatingObjectNameEmptyError);return this,t!==this.name()&&(!(e=this.sheet())||!e.wr.NR(t))}],[R.hFc,0,xt(R.hFc,!1)],[R.lHc,0,xt(R.lHc,!1)],[R.jGc,0,xt(R.jGc,!0)],[R.iGc,0,xt(R.iGc,!0)],[R.mHc,w,lt(R.mHc)],[R.nHc,0,lt(R.nHc)],[R.oHc,w,lt(R.oHc)],[R.pHc,0,lt(R.pHc)],[R.qHc,w,ut(R.qHc)],[R.rHc,0,ut(R.rHc)],[R.sHc,w,ut(R.sHc)],[R.tHc,0,ut(R.tHc)],[R.uHc,!1,st(R.uHc)],[R.vHc,!0,St(R.vHc)],[R.xHc,!0,St(R.xHc)],[R.wHc,!0,st(R.wHc)],[R.zHc,!0,function(t,e){St(R.zHc).call(this,t,e)},function(t){return"boolean"==typeof t&&(t||this.dynamicSize(!1,!1),!this.fixedPosition())}],[R.yHc,!0,function(t,e){St(R.yHc).call(this,t,e)},function(t){return"boolean"==typeof t&&this.dynamicMove()&&!this.fixedPosition()}],[R.AHc,!1,function(t,e){var o=this;t&&(o.dynamicMove(!1,!1),o.dynamicSize(!1,!1)),o.onPropertyChanged(R.AHc,t,e)}],[R.BHc,!0,st(R.BHc)],[R.CHc,!0,st(R.CHc)],["alt","",St("alt")]],Q=function(){function t(t,e,o,n,r){var i=this;i.LR={startRowOffset:w,startColumnOffset:w,endRowOffset:w,endColumnOffset:w},i.typeName="0",i.g3="0",i.name(t),i.x(e||0,!1),i.y(o||0,!1),i[R.iGc](n||0,!1),i[R.jGc](r||0,!1),i.qo=[],i.KR=!1,i.Cka=R.DHc,i.CXc=!1}return t.prototype.position=function(t){var e,o,r=this,i=r.sheet();return 0===arguments.length?new n.Point(r.x(),r.y()):(e=r.x(),o=r.y(),!h(t,n.Point)||e===t.x&&o===t.y||(r.x(t.x,!1),r.y(t.y,!1),Mt(r),Ot(r),i&&i.$p(),r.onPropertyChanged("position",t,new n.Point(e,o))),r)},t.prototype.cloneContent=function(){var t,e,o=this.content();return o?(t=void 0,o.cloneNode?t=o.cloneNode(!0):((e=g(R.VKb)).innerHTML=o.outerHTML,t=e.firstChild),n.GC$(t).removeAttr("id")[0]):b},t.prototype.refreshContent=function(t){var e,o,r,i,a,s,l=this;l.KR&&t&&((e=n.GC$(t)).empty(),o=l.cloneContent(),r=R._Hc,i=R._Hc,a="",s="",o&&o.style&&(a=o.style.width,s=o.style.height),""!==a&&(r=a),""!==s&&(i=s),o!==b?(n.GC$(o).css({width:r,height:i}).addClass(R.aIc).addClass(R.IHc).attr(R.eHc,R.cHc).appendTo(t),e.css(R.HHc,"")):e.css(R.HHc,""),l.KR=!1)},t.prototype.toJSON=function(){var t,e=this,o=it.call(e,Y),r=e.LR;for(t in r)f(r[t])||(o[t]=r[t]);return o.typeName=e.typeName,o[R.$Hc]=n.GC$(g(R.VKb)).append(e.cloneContent()).html(),o},t.prototype.fromJSON=function(t,e){var o,r;t&&((o=this).TR=!0,at.call(this,Y,t,e),f(t[R.mHc])&&Ot(o),t.content&&((r=g(R.VKb)).innerHTML=t.content,o.content(n.GC$(r.firstChild)[0])),o.TR=w)},t.prototype.clone=function(e){var o=this,r=n.getTypeFromString(o.typeName),i=r?new r:new t,a=JSON.stringify(o.toJSON());return i.fromJSON(JSON.parse(a)),i.content(o.cloneContent()),i},t.prototype.onPropertyChanged=function(t,e,o){var n,r=this;r.TR||(n=r.sheet())&&(n.ITa.BUa(r,t,o),r.Wq({sheet:n,sheetName:n.name(),floatingObject:r,propertyName:t}))},t.prototype.Wq=function(t){var e,o=this.sheet();o&&(o.Wq(n.Events.FloatingObjectChanged,t),t.propertyName===R.uHc&&(e={sheet:t.sheet,sheetName:t.sheetName,floatingObject:t.floatingObject},o.Wq(n.Events.FloatingObjectSelectionChanged,e)))},t.prototype.rI=function(t,e){var o=this;t=T(t),e=T(e),At.call(o,o[R.mHc],o[R.qHc],t,e)},t.prototype.GR=function(t,e){var o=this,n=t+e-1;It.call(o,o[R.mHc],o[R.nHc],o[R.qHc],o[R.rHc],t,e,n)},t.prototype.tI=function(t,e){var o=this;t=T(t),e=T(e),At.call(o,o[R.oHc],o[R.sHc],t,e)},t.prototype.HR=function(t,e){var o,n=this;o=(t=T(t))+(e=T(e))-1,It.call(n,n[R.oHc],n[R.pHc],n[R.sHc],n[R.tHc],t,e,o)},t.prototype.getHost=function(t,e){var o,n,r=this.qo.concat();if(!f(t)&&!f(e)){for(o=0;o<r.length;o++)if((n=r[o]).rowViewportIndex===t&&n.columnViewportIndex===e)return n;return b}return r},t.prototype.UR=function(t,e,o){var n=this.qo;t&&n.indexOf(t)<0&&(t.rowViewportIndex=e,t.columnViewportIndex=o,n.push(t))},t.prototype.VR=function(t){var e=this.qo,o=e.indexOf(t);o>=0&&e.splice(o,1)},t.prototype.WR=function(t,e){var o,r,i,a,s,l,u=g(R.VKb);return n.GC$(u).addClass(R.HGc).addClass(R.NHc).attr(R.eHc,R.cHc).css(R.FHc,R.GHc),o=this.cloneContent(),r=R._Hc,i=R._Hc,a="",s="",(l=o&&o.style)&&(a=l.width,s=l.height),""!==a&&(r=a),""!==s&&(i=s),o!==b&&n.GC$(o).css({width:r,height:i}).addClass(R.aIc).addClass(R.HGc).attr(R.eHc,R.cHc).appendTo(u),this.UR(u,t,e),u},t.prototype.hga=function(){return!0},t.prototype.no=function(t){},t.prototype.Toa=function(){ct(this),wt(this)},t.prototype.wxb=function(t){var e,o,n=this;return 1===t?S(n.width()):(e=Ft(n.startColumn(),n.startColumnOffset(),n.sheet(),!1),o=mt(n,!1,e+n[R.iGc]()),Dt(n.startColumn(),o.index,n.startColumnOffset(),o.offset,t,n.sheet(),!1))},t.prototype.xxb=function(t){var e,o,n=this;return 1===t?S(n.height()):(e=Ft(n.startRow(),n.startRowOffset(),n.sheet(),!0),o=mt(n,!0,e+n[R.jGc]()),Dt(n.startRow(),o.index,n.startRowOffset(),o.offset,t,n.sheet(),!0))},t}(),e.FloatingObject=Q,$={content:p(R.$Hc,b,st(R.$Hc))},n.GC$.each(K,(function(t,e){$[e[0]]=p(e[0],e[1],e[2],e[3])})),n.GC$.extend(Q.prototype,$),tt=function(){function t(t,e){this.XR="";var o=this;o.YR=t,o.name=t?t.name():"",o.kj=e,o.RB=!1,o.ZR=!1}return t.prototype.gV=function(t){var e,o,r,i,a,s,l=n.GC$(t.target).attr("resizeDirection");if(l)return l;if(e=n.GC$(this.hS).offset(),o=t.pageX-e.left,r=t.pageY-e.top,i=this.pmb)for(a=0;a<i.length;a++)if((s=i[a]).rect.contains(o,r))return s.direction},t.prototype.smb=function(t){var e,o,r,i,a,s,l=t.target;if(n.GC$(l).attr("resizeDirection"))return l.style.cursor;if(e=n.GC$(this.hS).offset(),o=t.pageX-e.left,r=t.pageY-e.top,i=this.pmb)for(a=0;a<i.length;a++)if((s=i[a]).rect.contains(o,r))return s.cursor},t.prototype.AD=function(e){var o,r,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=d.YR,y=g.ITa.Ky,C=d.WE,v=d.aS;if(g.ER(m)&&g.endEdit()&&(g.zt(!0),o={e:e,r:b},t.ao(d,"preProcessMouseDown",o),!o.r)){if(0===e.button||2===e.button){if(r=m.isSelected(),e.ctrlKey||e.shiftKey?m.isSelected(!r):r||(g.uQ(),m.isSelected(!0)),r||n.Vl.Zl(g),y&&y.vQ(),g.EJ(),g.hm&&g.hm(),2===e.button)return;if(i=g.mm,a=g.Vs(),s=d.gV(e),l=new n.Point(e.pageX-a.left,e.pageY-a.top),u=function(t,e){if(!t._R)return b;var o={inMoving:!1};return e||(o.inMoving=!0),o}(d,s),!m.allowMove()&&(!m.allowResize()||u.inMoving))return;d.$F=l,d.pS=!0,d.bS=u,u.inMoving?((c={}).startTopRow=g.getViewportTopRow(C),c.startLeftColumn=g.getViewportLeftColumn(v),c.startX=l.x,c.startY=l.y,d.eS=c):(Vt(d),f={},h=Et(d.cS),f.startX=h.x,f.startY=h.y,f.startWidth=h[R.iGc],f.startHeight=h[R.jGc],f.startTopRow=g.getViewportTopRow(C),f.startLeftColumn=g.getViewportLeftColumn(v),f.cursor=d.smb(e),f.direction=s,d.$R=f),Ht(d),p=g.hitTest(l.x,l.y),i.rG={KG:p.rowViewportIndex,MG:p.colViewportIndex,sG:p.hitTestType},i.$F=l,i.qG(),i.O3=!0,g.Wq(n.Events.FloatingElementSelected,{type:"floatingObject"})}return!1}},t.prototype.BD=function(e){var o,r,i,a,s,l,u,c,f=this,h=f.kj,p=f.hS,d=f.iS;if(h.ER(f.YR))return o={e:e,r:b},t.ao(f,"preProcessMouseMove",o),o.r?void((r=o.cursor)&&n.GC$(p).css(R.DGc,r)):(a=(i=f.YR).isLocked()&&h.options.isProtected,n.GC$(p).css(R.DGc,a||!i.allowMove()?"default":R.dGc),h.dG?(p&&n.GC$(p).css(R.DGc,"default"),!0):(s=h.mm,l=h.Vs(),u=new n.Point(e.pageX-l.left,e.pageY-l.top),f.pS?(f.bS.inMoving?(f.qS=!0,Vt(f),function(t,e,o){var n,r,i,a,s=t,l=s.cS;if(l)for(a in _t(l,n=o.x-e.x,r=o.y-e.y),i=s.dS)v(i,a)&&_t(i[a].moveResizeDiv,n,r)}(f,f.$F,u),n.GC$(d).css(R.DGc,R.dGc)):f.YR.allowResize()&&(f.kv=!0,Gt(f),n.GC$(d).css(R.DGc,f.$R[R.DGc])),(f.qS||f.kv)&&(f.$F=u,s.$F=u,s.NG(),n.GC$(C.body).addClass(R.IHc).attr(R.eHc,R.cHc))):(c=h.parent).options.enableAccessibility&&c.dgc(i.alt()),!1))},t.prototype.CD=function(e){var o,r,i,a,s,l=this,u=l.kj,c=u.mm,f=l.YR,h=l.hS,p=l.bS;if(u.ER(f)&&(o={e:e,r:b},t.ao(l,"preProcessMouseUp",o),!o.r))return u.dG?(n.GC$(h).css(R.DGc,R.dGc),!0):(c.O3=!1,c.RG(),r=u.Vs(),i=new n.Point(e.pageX-r.left,e.pageY-r.top),(a=l.eS)&&(a.endX=i.x,a.endY=i.y),p&&(s=f.fixedPosition(),p.inMoving&&l.qS?(s&&function(t){var e,o,n,r,i,a,s,l,u,c,f,h=t,p=h.eS;p&&(e=h.YR,r=(n=(o=h.kj).am())[R.iGc]-n.Br-n.zr,i=n[R.jGc]-n.Cr-n.Ar,a=p.startX,s=p.startY,l=e.position().x,u=e.position().y,c=e[R.iGc](),f=e[R.jGc](),l+p.endX-a<0&&(p.endX=a-l),u+p.endY-s<0&&(p.endY=s-u),l+c+p.endX-a>r&&(p.endX=r+a-l-c),u+f+p.endY-s>i&&(p.endY=i+s-u-f),p.startTopRow=o.getViewportTopRow(h.WE),p.startLeftColumn=o.getViewportLeftColumn(h.aS))}(l),e.ctrlKey?function(t){var e,o,n,r,i,a,s,l=t,u=l.kj,c=l.eS;if(c){if(e=m(u,c[R.mIc],u.getViewportTopRow(l.WE),!0),o=m(u,c[R.nIc],u.getViewportLeftColumn(l.aS),!1),n=c[R.kIc]-c[R.gIc]+(c[R.kIc]>c[R.gIc]?o:-1*o),r=c[R.lIc]-c[R.hIc]+(c[R.lIc]>c[R.hIc]?e:-1*e),0===n&&0===r)return;for(s in(i=[]).push(l.YR.name()),a=l.dS)v(a,s)&&i.push(s);u.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:u.name(),floatingObjects:i,offsetX:n,offsetY:r})}}(l):function(t){var e,o,n,r,i,a,s,l=t,u=l.kj,c=l.eS,f=u.zoom();if(c){for(s in e=m(u,c[R.mIc],u.getViewportTopRow(l.WE),!0),o=m(u,c[R.nIc],u.getViewportLeftColumn(l.aS),!1),n=c[R.kIc]-c[R.gIc]+(c[R.kIc]>c[R.gIc]?o:-1*o),r=c[R.lIc]-c[R.hIc]+(c[R.lIc]>c[R.hIc]?e:-1*e),n/=f,r/=f,(i=[]).push(l.YR.name()),a=l.dS)v(a,s)&&i.push(s);u.wu().execute({cmd:"moveFloatingObjects",sheetName:u.name(),floatingObjects:i,offsetX:n,offsetY:r})}}(l)):l.kv&&(s&&function(t){var e,o,r,i,a,s=t,l=s.$R;l&&(r=(o=(e=s.kj).am())[R.iGc]-o.Br-o.zr,i=o[R.jGc]-o.Cr-o.Ar,a=(a=new n.Rect(l.endX,l.endY,l.endWidth,l.endHeight)).getIntersect(0,0,r,i),l.endX=a.x,l.endY=a.y,l.endWidth=a[R.iGc],l.endHeight=a[R.jGc],l.startTopRow=e.getViewportTopRow(s.WE),l.startLeftColumn=e.getViewportLeftColumn(s.aS))}(l),function(t){var e,o,n,r,i,a,s,l,u,c=t,f=c.kj,h=f.zoom(),p=c.YR,d=c.$R;if(d){for(u in e=m(f,d[R.mIc],f.getViewportTopRow(c.WE),!0),o=m(f,d[R.nIc],f.getViewportLeftColumn(c.aS),!1),n=d[R.kIc]-d[R.gIc]+(d[R.kIc]>d[R.gIc]?o:-1*o),n/=h,r=d[R.lIc]-d[R.hIc]+(d[R.lIc]>d[R.hIc]?e:-1*e),r/=h,i=(d.endWidth+o)/h-p[R.iGc](),a=(d.endHeight+e)/h-p[R.jGc](),(s=[]).push(p.name()),l=c.dS)v(l,u)&&s.push(u);f.wu().execute({cmd:"resizeFloatingObjects",sheetName:f.name(),floatingObjects:s,offsetX:n,offsetY:r,offsetWidth:i,offsetHeight:a})}}(l)),n.GC$(C.body).removeClass(R.IHc)),l.rS(),!1)},t.prototype.rS=function(){var t=this;t.$R=b,t.eS=b,t.dS=b,n.GC$(t.iS).remove(),t.cS=b,t.pS=!1,function(t){var e=t;e.RB&&(e.RB=!1,n.GC$(C).unbind(R.eIc+R.iHc).unbind(R.fIc+R.iHc))}(t),t.qS=!1,t.kv=!1},t.prototype.yl=function(t,e){var o,r,i,a,s,l,u,c=this,f=c.YR,h=c.kj;if(f){if(o=!1,c.sS=t,!(r=c.hS)){if(t.width<=0||t.height<=0)return;r=c.hS=function(t){var e,o,r,i,a,s,l,u,c=g(R.VKb),f=n.GC$(c),h=t;return f.addClass(R.OHc).addClass(R.IHc).attr(R.eHc,R.cHc).css(R.dHc,R.DHc).bind("mousedown",(function(t){h.AD(t)})).bind(R.eIc,(function(t){h.BD(t)})).bind(R.fIc,(function(t){h.CD(t)})),c.addEventListener("mousewheel",(function(t){Bt(h,t)}),!1),c.addEventListener("DOMMouseScroll",(function(t){Bt(h,t)}),!1),e=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.UHc+" "+R.XHc+" "+R.THc),o=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.UHc+" "+R.YHc+" "+R.THc),r=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.UHc+" "+R.ZHc+" "+R.THc),i=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.VHc+" "+R.XHc+" "+R.THc),a=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.VHc+" "+R.ZHc+" "+R.THc),s=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.WHc+" "+R.XHc+" "+R.THc),l=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.WHc+" "+R.YHc+" "+R.THc),u=n.GC$(g(R.VKb)).addClass(R.SHc+" "+R.WHc+" "+R.ZHc+" "+R.THc),f.append(e).append(o).append(r).append(i).append(a).append(s).append(l).append(u),tt.ao(h,"init",c),c}(c),function(t,e){yt(e,Ct(t))}(f,r),(i=h.parent)&&((a=c.Ks=i.xv())&&n.GC$(a).append(r))}(s=c.kS)||(s=c.kS=f.WR(c.WE,c.aS),"1"===f.typeName?(c.lS=g(R.VKb),n.GC$(c.lS).addClass(R.IHc+" "+R.NHc).attr(R.eHc,R.cHc),r.appendChild(c.lS),c.lS.appendChild(s)):(r.appendChild(s),o=!0)),c.lS&&(function(t,e,o){var r,i,a,s,l=t.lS,u=t.YR,c=u.borderWidth(),f=u.borderStyle(),h=n.Rm.Om(u.sheet(),u.borderColor()),p=u.borderRadius(),d=0,g=S(tt.mS/2+1);Tt(f)&&!u.noFill()||(c=0),c<g&&(d=g-c),r=d,i=d,a=d,s=d,g=x(c,g),e.x<0?r+=e.x-g:(r+=e.x<g?e.x-g:0,s=o[R.iGc]-r-e[R.iGc]-2-2*c),e.y<0?i+=e.y-g:(i+=e.y<g?e.y-g:0,a=o[R.jGc]-i-e[R.jGc]-2-2*c),n.GC$(l).css([R.FHc,R.fGc,R.OLb,R.hGc,R.gGc,R.JLb+"-width",R.JLb+"-style",R.JLb+"-color",R.JLb+"-radius"],[R.GHc,r,i,a,s,c,f,h,p])}(c,e,t),e.x=0,e.y=0),l=n.GC$(s),n.GC$(r).css([R.OLb,R.fGc,R.iGc,R.jGc],[t.y,t.x,t[R.iGc],t[R.jGc]]),l.css([R.OLb,R.fGc,R.iGc,R.jGc],[e.y,e.x,e[R.iGc],e[R.jGc]]),c.Tka=t,f.refreshContent&&f.refreshContent(s),c.lS&&function(t){var e,o,r,i,a,s,l,u,c,f=t,h=f.YR,p=h.qmb||h.src(),d=h.pictureStretch(),g=n.Rm.Om(h.sheet(),h.backColor()),m=f.kS;p&&m&&(e=n.GC$(m),f.XR!==p&&(f.XR=p,e.css([R.HHc+"-image",R.HHc+"-repeat"],["url('"+p+"')","no-repeat"])),e.css(R.HHc+"-color",g),d!==b&&d!==w&&h.oS&&(o=h.getOriginalWidth(),r=h.getOriginalHeight(),i=e[R.iGc](),a=e[R.jGc](),l=void 0,(s=h.rmb)&&(u=i/s.width,c=a/s.height,l={position:-u*s.left+"px "+-c*s.top+"px",size:u+"px "+c+"px"}),n.Ul.ql(m,i,a,o,r,d,l)))}(c),f.isSelected()?(l.removeClass(R.KHc).addClass(R.JHc),f.allowResize()?function(t,e){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;n.GC$(R.RHc,e).removeClass(R.MHc),r=Et((o=t).hS),i=o.kS,a=o.YR,o.lS&&(i=o.lS),s=tt.mS,u=(l=Et(i)).x,c=l.y,f=r[R.jGc]-l.y-l[R.jGc],h=r[R.iGc]-l.x-l[R.iGc],p=0,d=s+2,g=S(s/2+1),"1"===a.typeName&&(m=a.borderWidth(),Tt(a.borderStyle())||(m=0),m>=g&&(p=m-g),f=r[R.jGc]-c-l[R.jGc]-m,h=r[R.iGc]-u-l[R.iGc]-m,u+=m,c+=m),y=[],u>0?(zt(o,c>0,k,p,p,w,w,"nw"+R.VGc,L,y),zt(o,r[R.jGc]>0,N,p,(l[R.jGc]-d)/2+c,w,w,"w"+R.VGc,_,y),zt(o,f>0,O,p,w,w,p,"ne"+R.VGc,H,y)):(Ut(o,k),Ut(o,N),Ut(o,O)),zt(o,c>0,D,(l[R.iGc]-d)/2+u,p,w,w,"n"+R.VGc,G,y),zt(o,f>0,F,(l[R.iGc]-d)/2+u,w,w,p,"n"+R.VGc,z,y),h>0?(zt(o,c>0,E,w,p,p,w,"sw"+R.VGc,B,y),zt(o,r[R.jGc]>0,j,w,(l[R.jGc]-d)/2+c,p,w,"w"+R.VGc,V,y),zt(o,f>0,P,w,w,p,p,"se"+R.VGc,U,y)):(Ut(o,E),Ut(o,j),Ut(o,P)),o.ZR=!0,o.pmb=y}(c,r):c.ZR&&Wt(c,r)):(l.removeClass(R.JHc).addClass(R.KHc),Wt(c,r)),o&&(u=s.firstChild,h.Wq(n.Events.FloatingObjectLoaded,{sheet:h,sheetName:h.name(),floatingObject:f,element:u}))}},t.prototype.no=function(){var e=this,o=e.YR,r=e.hS,i=e.iS,a=e.kS;t.ao(e,"dispose"),a&&o.VR&&(o.VR(a),o.no(!1)),r&&(n.GC$(r).remove(),e.hS=b),i&&(n.GC$(i).remove(),e.iS=b)},t.mS=7,t}(),e.FloatingObjectRender=tt,n.Zn(tt),et=function(){function t(t){this.kj=t,this.jS=new y}return t.prototype.no=function(){var t=this.jS;t.each((function(t){t.no()})),t.empty(),this.kj=b},t.prototype.yl=function(t,e,o){var r,i,a,s,l,u,c,f,h,p;if(!(t<0||e<0)){for(i=(r=this).kj,a=r.jS,s=i.wr,l=qt(r,t,e,o),u=[],a.each((function(t){l.find(t.name)||u.push(t)})),f=u.length,c=0;c<f;c++)(h=u[c]).gS=b,a.remove(h.name),h.no();p=i.parent&&i.parent.options.useTouchLayout,tt.mS=p?11:7,l.each((function(o){var l,u,c,f,h,p,d,g,m,y,C,v,b,w,T=s.NR(o.name),A=S(tt.mS/2+1);T&&"1"===T.typeName&&(l=T.borderWidth(),Tt(T.borderStyle())||(l=0),l>A&&(A=l)),u=function(t,e,o){var r,i,a,s,l,u=t.kj,c=u.it(o),f=0,h=0,p=0,d=0;return c&&c.length>0&&(r=c[0],i=c[c.length-1],f=r.x,p=i.x+i[R.iGc]-f),(a=u.jt(e))&&a.length>0&&(s=a[0],l=a[a.length-1],h=s.y,d=l.y+l[R.jGc]-h),u.am().Ft(e,o).getIntersect(f,h,p,d)||new n.Rect(0,0,0,0)}(r,t,e),c=o.x-A-1,f=o.y-A-1,h=o[R.iGc]+2*A+2,g=o[R.jGc]+2*A+2,m=h,v=-1*A-1,(y=f-(p=x(u.y,f))+(y=A))<=0?(g+=y,g+=v):y<A&&y>0&&(g-=A-y),(C=c-(d=x(u.x,c))+(C=A))<=0?(m+=C,m+=v):C<A&&C>0&&(m-=A-C),(b=a.find(o.name))||((b=new tt(s.NR(o.name),i)).gS=r,a.push(b)),b._R=o,b.WE=t,b.aS=e,w=new n.Rect(u.x,u.y,u[R.iGc],u[R.jGc]),b.yl(new n.Rect(d,p,m,g).getIntersectRect(w)||new n.Rect(d,p,0,0),new n.Rect(C,y,o[R.iGc],o[R.jGc]))}))}},t}(),ot={init:function(){var t=this,e=t.$oa=[];t.Zoa=function(t){e.forEach((function(e){e.Wva&&e.Wva(t)}))},t.wr=t.ITa.wr,t.pictures=new q(t,"1"),t.floatingObjects=new q(t,"0")},dispose:function(t){var e=this;(function(t,e){var o,n,r,i,a,s,l,u=t.FR;if(u){for(o=void 0,n=void 0,i=void 0,r=u.length,o=0;o<r;o++)if(a=u[o]){for(i=a.length,n=0;n<i;n++)(s=a[n])&&s.no();a.length=0}u.length=0,t.FR=b}(l=t.wr)&&!1!==e&&l.no()})(e,t.clearCache),e.wr&&n.GC$.each(e.wr.zR(),(function(e,o){o.no(t.clearCache)})),!1!==t.clearCache&&(e.pictures&&(e.pictures.no(),e.pictures=b),e.floatingObjects&&(e.floatingObjects.no(),e.floatingObjects=b),e.QP=b,e.Zoa=b,e.IR=b),e.unbind(n.Events.TableFiltered+R.bIc),e.unbind(n.Events.RangeFiltered+R.bIc),e.unbind(n.Events.FloatingElementSelected+R.bIc)},setHost:function(t){if(t){var e=this;e.bind(n.Events.TableFiltered+R.bIc,(function(){e.AR()})),e.bind(n.Events.RangeFiltered+R.bIc,(function(){e.AR()})),e.bind(n.Events.FloatingElementSelected+R.bIc,(function(t,o){"floatingObject"!==o.type&&e.uQ()}))}},onLayoutChanged:function(t){var e=t.changeType,o=t.row,n=t.rowCount,r=t.col,i=t.colCount,a=this.wr;"addRows"===e?function(t,e,o){t.zR().forEach((function(t){t.rI(e,o)}))}(a,o,n):"deleteRows"===e?function(t,e,o){var n,r,i=[];for(t.zR().forEach((function(n){rt(e,-1,e+o-1,t.sheet().getColumnCount(),n)&&(n.dynamicMove()||n.dynamicSize())?i.push(n):n.GR(e,o)})),r=i.length,n=0;n<r;n++)t.Fb(i[n].name())}(a,o,n):"addColumns"===e?function(t,e,o){t.zR().forEach((function(t){t.tI(e,o)}))}(a,r,i):"deleteColumns"===e&&function(t,e,o){var n,r,i=[];for(t.zR().forEach((function(n){rt(-1,e,t.sheet().getRowCount(),e+o-1,n)&&(n.dynamicMove()||n.dynamicSize())?i.push(n):n.HR(e,o)})),r=i.length,n=0;n<r;n++)t.Fb(i[n].name())}(a,r,i)},paint:function(t){var e=t.clipRect;this.QP(e)},lastNonNullRowAndCol:function(){var t=0,e=0,o=this.wr;return o&&o.zR().forEach((function(o){o&&(o[R.qHc]()>t&&(t=o[R.qHc]()),o[R.sHc]()>e&&(e=o[R.sHc]()))})),{lastNonNullRow:t,lastNonNullCol:e}},toJson:function(t,e){var o;e&&e.ignoreStyle||(o=this.wr.toJSON()).length>0&&(t.floatingObjects=o)},fromJson:function(t,e,o){var n,r,i;o&&o.ignoreStyle||((n=this).wr=new J(n),n.ITa.wr=n.wr,r=t&&t.floatingObjectArray,(i=e?r&&r.floatingObjects:t.floatingObjects)&&n.wr.fromJSON(i,e))},preProcessMouseDown:function(t){var e,o,n=t.e,r=this.Vs(),i=n.pageX-r.left,a=n.pageY-r.top;!this.Cw&&this.Cva&&((o=(e=this.hitTest(i,a))&&e.formulaRangeHitInfo)&&(o.inBorder||o.inTopLeft||o.inTopRight||o.inBottomLeft||o.inBottomRight))||this.uQ()},processKeyDown:function(t){var e,o,n,r=this.wr;if(r)for(o=void 0,n=(e=r.zR()).length,o=0;o<n;o++)if(e[o].isSelected())return void(t.r=!0)},onGroupChanged:function(t){this.floatingObjects.tTa(t.start,t.end,t.isRow),this.pictures.tTa(t.start,t.end,t.isRow)}},n.Worksheet.$n(R.hHc,ot),nt={init:function(){n.Commands.JR(this.commandManager())},onCommandExecuting:function(t){t.wr.zR().forEach((function(t){t.isSelected(!1)}))},onCultureChanged:function(){l()}},n.Workbook.$n(R.hHc,nt),n.GC$.extend(n.lUa.prototype,{BUa:function(t,e,o){var n,r=this.zTa;r&&((n=r.CUa)||(n=r.CUa=[]),n.push({type:"property",floatingObject:t,name:e,value:o}))},AUa:function(){var t,e,o,r=this.zTa;r&&((t=r.CUa)||(t=r.CUa=[]),e={},o=this.wr,n.GC$.each(o.QR,(function(t,o){e[t]=o})),t.push({type:"collection",floatingObjects:e}))},DUa:function(t){var e,o,n,r,i,a,s;if(t)for(e=this.wr,o=t.length-1;o>=0;o--)"collection"===(n=t[o]).type?e.QR=n.floatingObjects:"property"===n.type&&(r=["startRow","startRowOffset","startColumn","startColumnOffset","endRow","endRowOffset","endColumn","endColumnOffset"],i=n.floatingObject,a=n.name,s=n.value,i[a](s),r.indexOf(a)>=0&&(ct(i),wt(i),i.sheet().$p()))}}),n.lUa.$n(R.hHc,{init:function(){this.wr=new J(this.kj)},undo:function(t){var e=t.CUa;e&&this.DUa(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.wr&&(e.wr.no(),e.wr=b)}})},"./dist/plugins/floatingObject/floatingobject.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/floatingObject/floatingobject.res.en.js");e.SR={en:n}},"./dist/plugins/floatingObject/floatingobject.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",e.Exp_FloatingObjectNameEmptyError="Floating object must have name"},"./dist/plugins/floatingObject/picture.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function S(t){return"number"==typeof t&&!isNaN(t)}function x(t){var e,o,r=t,i=r.src(),a=r.sheet();r.bt||(r.bt=new n.oo((function(){x(r)}))),e=r.bt;try{e.ko(i)?(r.oS=!0,o=e.lo(i),r.KS=o.width,r.LS=o.height,r.tmb&&r.tmb%90==0&&(r.qmb=function(t,e,o,n){var r,i,a=e,s=o;return 90!==n&&270!==n||(a=o,s=e),r=document.createElement("canvas"),r.width=a,r.height=s,i=r.getContext("2d"),i.translate(a/2,s/2),i.rotate(n/180*Math.PI),i.translate(-a/2,-s/2),i.drawImage(t,0,0,e,o,(a-e)/2,(s-o)/2,e,o),i.setTransform(1,0,0,1,0,0),r.toDataURL()}(o,o.width,o.height,r.tmb)),r.JS&&(r.width(o.width,!0),r.height(o.height,!0),r.JS=!1),r.Wq({sheet:a,sheetName:a.name(),picture:r,propertyName:"originalSize"}),r.isVisible()&&a&&a.repaint()):e.fo(i)}catch(t){}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("./dist/plugins/floatingObject/floatingobject.js"),i=n.Ul.Nl,a=n.Ul.Pl,s=n.GC$,l=null,u=void 0,C=[c="src",f="backColor",p="borderRadius",d="borderWidth",g="borderStyle",y="noFill",m="borderColor",h="pictureStretch"],r.FloatingObject.ozb=function(t,e,o,n,r,i){return new v(t,e,o,n,r,i)},v=function(t){function e(e,o,n,r,i,a){var s=t.call(this,e,n,r,i,a)||this,u=s;return u.typeName="1",u.g3="1",u.bt=l,u.oS=!1,u.JS=!1,"string"==typeof o&&(u.JS=!(S(i)&&S(a)),u.src(o)),s}return T(e,t),e.prototype.onPropertyChanged=function(t,e,o){var n,r=this;r.TR||(n=r.sheet())&&(n.ITa.BUa(r,t,o),this.Wq({sheet:n,sheetName:n.name(),picture:r,propertyName:t}))},e.prototype.toJSON=function(){var e,o,n,i=this,a=t.prototype.toJSON.call(this);return r.toJsonFn.call(i,C,a),a.originalWidth=i.getOriginalWidth(),a.originalHeight=i.getOriginalHeight(),i.tmb&&(a.rot=i.tmb),(e=i.rmb)&&(o=e.left,n=e.top,a.srcRect={l:o,t:n,r:1-o-e.width,b:1-n-e.height}),delete a.content,a},e.prototype.fromJSON=function(e,o,n){var i,a,s,l;e&&((i=this).TR=!0,n&&(S(e.x)&&S(e.y)&&S(e.width)&&S(e.height)&&(e.endRow=null,e.endRowOffset=null,e.endColumn=null,e.endColumnOffset=null)),t.prototype.fromJSON.call(this,e,o),r.fromJsonFn.call(i,C,e,o),e.rot&&(i.tmb=e.rot),i.oS=!1,(a=e.srcRect)&&(s=a.l,l=a.t,i.rmb={left:s,top:l,width:1-s-a.r,height:1-l-a.b}),x(i),i.TR=u)},e.prototype.clone=function(){var t=new e,o=JSON.stringify(this.toJSON());return t.fromJSON(JSON.parse(o)),t},e.prototype.getOriginalWidth=function(){return this.KS},e.prototype.getOriginalHeight=function(){return this.LS},e.prototype.nS=function(t){return["dotted","dashed","solid","double","groove","ridge","inset","outset"].indexOf(t)>=0},e.prototype.WR=function(t,e){var o=i("div");return s(o).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(o,t,e),o},e.prototype.Wq=function(t){var e,o=this.sheet();o&&(o.Wq(n.Events.PictureChanged,t),"isSelected"===t.propertyName&&(e={sheet:t.sheet,sheetName:t.sheetName,picture:t.picture},o.Wq(n.Events.PictureSelectionChanged,e)))},e.prototype.no=function(t){var e=this;e.bt&&!1!==t&&(e.bt.no(),e.bt=l)},e}(r.FloatingObject),e.Picture=v,b=[[c,u,function(t,e){var o=this;o.oS=!1,x(o),o.srccallback||(o.srccallback=r.propertyRefreshCallback(c)),o.srccallback.call(o,t,e)}],[f,l,r.propertyRefreshCallback(f)],[p,-1,r.propertyRefreshCallback(p),S],[d,1,r.propertyRefreshCallback(d),S],[g,"none",function(t,e){var o=this;o.nS(t)||o.borderWidth(0),o.bscallback||(o.bscallback=r.propertyRefreshCallback(g)),o.bscallback.call(o,t,e)}],[y,u],[m,l,r.propertyRefreshCallback(m)],[h,0,r.propertyRefreshCallback(h)]],w=v.prototype,s.each(b,(function(t,e){w[e[0]]=a(e[0],e[1],e[2],e[3])}))},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(t,e,o){"use strict";var n,r;function i(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),i(o("./dist/plugins/formulaTextbox/formulatextbox.js")),i(o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),o("./dist/plugins/formulaTextbox/formulatextbox-event.js"),o("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),o("./dist/plugins/formulaTextbox/formulatextbox-render.js"),r=o("./dist/plugins/formulaTextbox/formulatextbox.js"),e.findControl=function(t){return"string"==typeof t&&(t=document.getElementById(t)),n.GC$(t).data(r.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(t,e,o){"use strict";var n,r,i,a;function s(t){var e=n.Ul.Nl("textarea");return n.GC$(e).css({display:"none"}),n.GC$(t).append(e),e}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("./dist/plugins/formulaTextbox/formulatextbox.js"),e.W4=s,i=function(){function t(){var t=this;t.nT=-1,t.Mk=-1,t._text="",t.Q2=-1,t.kj=null,t.MH=!1,t.R2=-1,t.I0=null,t.OC=null,t.f1=null}return t.prototype.$b=function(){var t=this;t.S2(),t.nT=-1,t.Mk=-1,t._text="",t.Q2=-1,t.MH=!1,t.R2=-1,t.kj=null,t.OC=null,t.f1=null},t.prototype.S2=function(){var t,e,o=this;o.kj.Js||(t=o.kj.getCellType(o.nT,o.Mk),e={sheet:o.kj,row:o.nT,col:o.Mk,sheetArea:3},o.I0&&o.I0.firstChild&&t.deactivateEditor(o.I0.firstChild.firstChild,e)),n.GC$(o.I0).remove(),o.I0=null},t.prototype.T2=function(t){var e=this,o=t.Cw;o&&(e._text=o.text(),e.nT=t.getActiveRowIndex(),e.Mk=t.getActiveColumnIndex(),e.Q2=o.caret(),e.MH=o.MH,e.R2=o.C1(),e.V4=o.V4,e.C5=o.C5,e.Nfa=o.Nfa,e.kj=t,e.OC=t.parent,e.f1=t.mm.bG())},t.prototype.VF=function(t){var e=this;t.Cw&&(e._text=t.Cw.text(),e.Q2=t.Cw.caret(),e.MH=t.Cw.MH,e.R2=t.Cw.C1())},t.prototype.U2=function(t){var e=this,o=t.Cw;o&&(o.V4=e.V4,o.C5=e.C5,o.Nfa=e.Nfa,o.text(e._text),o.caret(e.Q2),e.MH&&(o.B1(),o.C1(e.R2)))},t.prototype.V2=function(t){var e,o=t.oldSheet,n=this,r=o&&o.Cw;if(r)if(r.close(),(!n.kj||n.kj.Js)&&r.M0()||n.C5!==r.C5){n.T2(o),e=o.getValue(o.Jl,o.Kl,3),o.suspendEvent();try{if(!o.endEdit(!0))return}finally{o.resumeEvent()}o.setValue(o.Jl,o.Kl,e,3,!0),o.Px=1,t.needTriggerSheetChange=!1}else n._text&&(n.VF(o),r.destroy(),o.Cw=null,t.needTriggerSheetChange=!1)},t.prototype.W2=function(t){var e,o=t.oldSheet,n=t.newSheet,i=this;n.Js||(i.I0&&""===i._text&&(o.GJ(),i.$b()),i._text&&i.kj===n?(n.Px=0,n.zt(),n.suspendEvent(),i.V4?(e=s(n.parent.qo),r.J0(n,e),n.Px=2,n.yl.uH()):n.startEdit(!1),n.resumeEvent(),i.U2(n),i.VK(n,i.nT,i.Mk),o.GJ(),i.$b()):i._text&&!i.I0?(n.Px=1,o.Px=1,i.X2(n),n.EJ()):i._text&&i.kj!==n&&(n.Px=1,o.Px=1,i.X2(n),o.GJ(),n.EJ()))},t.prototype.X2=function(t){var e,o,i,a,s,l,u,c=this,f=c.kj;f.Js||(e=c.nT,o=c.Mk,i=f.getCellType(e,o),a={sheet:f,row:e,col:o,sheetArea:3,canvasOffset:this.f1},i.isImeAware(a)&&(t.Px=1,s=i.a5(a),c.I0&&c.S2(),c.I0=s,n.GC$(s).css("position","absolute"),l=f.getCellRect(e,o),n.GC$(s).attr("id","across"),u=f.getActualStyle(e,o),i.d5(s,u,l,a),(c.OC&&c.OC.getHost()||document.body).insertBefore(s,null),c.V4&&n.GC$(s).css({display:"none"}),r.J0(t,i.getEditingElement(),!0),s.firstChild&&!c.V4&&i.focus(s.firstChild.firstChild),c.U2(t),i.g5(s,u,l,a)))},t.prototype.VK=function(t,e,o){var n,r=t.getCellType(e,o),i=t.BF,a=t.am(),s=t.getActualStyle(e,o),l=t.getCellRect(e,o);l&&l.width>0&&l.height>0&&l.x>=a.kt&&l.y>=a.nt&&l.x+l.width<=a.lt+a.js&&l.y+l.height<=a.ot+a.gs&&(n={sheet:t,row:e,col:o,sheetArea:3},i&&i.parentNode&&r.g5(i.parentNode.parentNode,s,l,n))},t}(),a=function(){function t(){}return t.Q0=function(e,o){t.H0||(t.H0=new i),t.H0.V2(o)},t.R0=function(e,o){t.H0||(t.H0=new i),t.H0.W2(o)},t}(),e.G0=a},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u;function c(t){var e=t.Cw,o=t.mm;return e.MH?o.E2:o.E2={anchorRow:t.Jl,anchorCol:t.Kl,leadingRow:t.Qr,leadingCol:t.Rr}}function f(t,e,o,r,a){var s,u,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=t.Cw,O=t.parent,D=O&&O.options;if(N&&N.M0()&&D&&D.allowUserEditFormula&&D.enableFormulaTextbox){switch(u=(s=c(t)).anchorRow,f=s.anchorCol,h=s.leadingRow,p=s.leadingCol,l(r)&&(r=u),l(a)&&(a=f),d=t.mm,e){case 3:v=t.iy(r,a,o,h);break;case 4:v=t.hy(r,a,o,h);break;case 1:v=t.HJ(r,a,o,p);break;case 2:v=t.LJ(r,a,o,p);break;case 5:v=t.OJ();break;case 6:v=t.NJ()}v&&(g=v.row,m=v.col,y=v.leadingCellRow?v.leadingCellRow:g,C=v.leadingCellCol?v.leadingCellCol:m,t.IJ(g,m)&&(s.anchorRow=g,s.anchorCol=m,s.leadingRow=y,s.leadingCol=C,b=t.pivotTables&&t.pivotTables.findPivotTable(y,C),w=N.shift,T=N.ctrl,x=(S=b&&b.getPivotInfoImp(y,C,!1,!0))&&S.area,!N.Nfa&&b&&S&&4===x?(N.uMc=new n.Range(y,C,1,1),A=S.valueFieldName,I=S.rowInfos,R=S.colInfos,(I||R)&&((M=t.mm.vMc(x,A,I,R,b.position()))&&(N.v1(M,w,!T,!0),N.OG=!1))):(delete N.uMc,(k=i.C2(d.kj,n.kf(g,m,1,1)))&&N.v1(k,!1,!0)),g>=0&&m>=0&&t.Yq(g,m)))}}function h(t,e,o){var r,a,s,l,u,f,h,p,d=t.Cw,g=t.parent,m=g&&g.options;d&&d.M0()&&m&&m.allowUserEditFormula&&m.enableFormulaTextbox&&(r=t.mm,s=(a=c(t)).anchorRow,l=a.anchorCol,d.MH?(f=d.m1(),u=i.L0(t,f.text)):u=n.kf(s,l,1,1),u&&(h=t.UJ(u,e,o,s,l),(p=i.C2(r.kj,h))&&d.v1(p,!0,!1)))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/formulaTextbox/formulatextbox.js"),a=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),s=void 0,l=r.Common.j.Fa,n.Commands.Ox=function(t,e){if(t){if(2===t.Px)return!1;var o=t.Cw;return o&&o.M0()?(f(t,e,!1),!0):(o&&(t=u.O2(t)),t.yx(e,!1),!0)}return!1},n.Commands.Qx=function(t,e,o,n){if(t){if(2===t.Px)return!1;var r=t.Cw;return r&&r.M0()?(f(t,e,!1,o,n),!0):(r&&(t=u.O2(t)),t.yx(e,!1,o,n),!0)}return!1},n.Commands.Rx=function(t,e,o){if(t){if(2===t.Px)return!1;var n=t.Cw;return n&&n.M0()?(h(t,e,o),!0):(n&&(t=u.O2(t)),!!t.endEdit()&&(t.Sx(e,o),!0))}return!1},u=function(){function t(){}return t.fv=function(e){return t.O2(e)},t.Xx=function(e){return t.O2(e)},t.Yx=function(e){return t.O2(e)},t.O2=function(e){var o=e,n=a.G0.H0;return n&&n._text&&(o=n.kj,t.G2(o)),o},t.G2=function(t,e){var o,n;void 0===e&&(e=!0),o=t.parent,(n=a.G0.H0)&&n._text&&o.hw(t,e)},t.Zx=function(e,o,r){var a,s,l=!1,u=e.Cw;return u&&u.M0()?((a=c(e)).anchorRow=o,a.leadingRow=o,(s=i.C2(e,n.kf(a.anchorRow,a.anchorCol,1,1)))&&u.v1(s,!1,!0),e.mq(r),l=!0):u&&(e=t.O2(e)),{sheet:e,r:l}},t._x=function(e,o,r){var a,s,l=!1,u=e.Cw;return u&&u.M0()?((a=c(e)).anchorRow=o,a.leadingRow=o,(s=i.C2(e,n.kf(a.anchorRow,a.anchorCol,1,1)))&&u.v1(s,!1,!0),e.mq(r),l=!0):u&&(e=t.O2(e)),{sheet:e,r:l}},t.pzb=function(e,o){var n=!1,r=o?5:6,i=e.Cw,a=e.Jl,s=e.Kl;return i&&i.M0()?(i.MH||(e.mm.E2={anchorRow:a,anchorCol:s,leadingRow:e.Qr,leadingCol:e.Rr}),f(e,r,!1,a,s),n=!0):i&&(e=t.O2(e)),{sheet:e,r:n}},t.ay=function(e){return t.pzb(e,!0)},t.by=function(e){return t.pzb(e,!1)},t.ey=function(e){return t.O2(e)},t.gy=function(e){return t.O2(e)},t.jy=function(e){var o,n,r,l=a.G0.H0;if(l&&l._text&&(e=l.kj,o=l.nT,n=l.Mk,t.G2(e,!1),i.K0(e),l.V4||e.Sr(o,n,s,s,1),e.isEditing()))return r=e.getValue(o,n,3),!!e.gv(!0,void 0,void 0,!0)&&(e.setValue(o,n,r,3,!0),!0)},t}(),n.Commands.Wx=u},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("@grapecity/js-calc"),i=o("SheetsCalc"),a=o("./dist/plugins/formulaTextbox/formulatextbox.js"),s=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),l=n.GC$.extend,u=null,c=void 0,f=Math.max,h=Math.min,l(n.iI.prototype,{D2:function(t){var e,o,r,i,s,l,u,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=this,O=N.kj,D=O.Cw;D&&(N.Kka(),e=O.frozenRowCount(),o=O.frozenColumnCount(),(r=D.MH)&&N.E2||(N.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),i=O.getRowCount(),s=O.getColumnCount(),l=t.hitTestType,u=t.row,f=t.col,h=N.shift,p=N.ctrl,g=(d=N.E2).anchorRow,m=d.anchorCol,y=-1,C=-1,0===l?(y=e?O.ar():O.lq,C=o?O.$q():O.qq,v=n.kf(-1,-1,-1,-1),D.v1(a.C2(O,v),h,!p),N.OG=!0):1===l?(y=e?O.ar():O.lq,C=f,v=O.Jx(0,f,i-1,f,!0),h&&m>=0&&(v=O.Jx(0,f,i-1,m,!0)),v=n.kf(-1,v.col,-1,v.colCount),D.v1(a.C2(O,v),h,!p),N.OG=!0):2===l?(y=u,C=o?O.$q():O.qq,v=O.Jx(u,0,u,s-1,!0),h&&g>=0&&(v=O.Jx(u,0,g,s-1,!0)),v=n.kf(v.row,-1,v.rowCount,-1),D.v1(a.C2(O,v),h,!p),N.OG=!0):3===l&&(y=u,C=f,u!==c&&f!==c&&(b=t.row,w=t.col,x=(S=(T=t.pivotTableInfo)&&T.getPivotInfoImp(b,w,!1,!0))&&S.area,A=t.tableSelectInfo&&t.tableSelectInfo.tableSelection,!D.Nfa&&T&&S&&4===x?(D.uMc=new n.Range(b,w,1,1),I=S.valueFieldName,R=S.rowInfos,M=S.colInfos,(R||M)&&((k=N.vMc(x,I,R,M,T.position()))&&(D.v1(k,h,!p,!0),N.OG=!0,N.SLc=!0))):(delete D.uMc,A?v=A:(v=O.Jx(u,f,u,f,!0),v=n.kf(v.row,v.col,1,1),h&&g>=0&&m>=0&&(v=O.Jx(u,f,g,m,!0))),D.v1(a.C2(O,v),h,!p),N.OG=!0))),N.DG=N.OG,h&&r||(d.anchorRow=y,d.anchorCol=C,d.leadingRow=y,d.leadingCol=C),N.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},N.qG())},vMc:function(t,e,o,r,i){var s,l,u,c,f,h,p,d,g=this.kj;if(4===t)return void 0,void 0,"",u=i.row,c=i.col,f=n.kf(u,c,1,1),s=a.C2(g,f,!0),h=[],p=[],(p=Array.isArray(o)&&Array.isArray(r)?o.concat(r):Array.isArray(o)&&o||Array.isArray(r)&&r)&&p.forEach((function(t){"number"==typeof t.fieldName?h.push(t.fieldName):h.push('"'+t.fieldName+'"'),"number"==typeof t.itemName?h.push(t.itemName):h.push('"'+t.itemName+'"')})),d='GETPIVOTDATA("'+e+'",'+s,""!==(l=h.join(","))&&(d+=","+l),d+")"},F2:function(t){var e,o,r=!1,i=s.G0.H0;if(i&&i.I0)if(e=i.kj,(o=t.Cw)&&e.setFormula(i.nT,i.Mk,o.text()),e!==t){if(n.Commands.Wx.G2(e),!e.endEdit())return;r=!0}else o&&(o.destroy(),t.Cw=u),i.$b();return r},EG:function(){var t,e=this,o=e.rG;o&&e.OG&&(3===(t=o.sG)?e.H2():2===t?e.I2():1===t&&e.J2())},H2:function(){var t,e,o,n,r=this,i=r.E2,s=i.anchorRow,l=i.anchorCol,u=r.fH(),c=r.gH();s>=0&&l>=0&&u>=0&&c>=0&&(e=(t=r.kj).Jx(u,c,s,l,!0),(o=a.C2(t,e))&&(n=t.Cw,r.SLc?e.equals(n.uMc)||(delete n.uMc,n.v1(o,!0,!0)):n.v1(o,!0,!1))),r.NG()},I2:function(){var t,e,o,r=this,i=r.E2.anchorRow,s=r.fH();i>=0&&s>=0&&(e=(t=r.kj).Jx(s,0,i,t.getColumnCount()-1,!0),e=n.kf(e.row,-1,e.rowCount,-1),(o=a.C2(t,e))&&t.Cw.v1(o,!0,!1)),r.NG()},J2:function(){var t,e,o,r=this,i=r.E2.anchorCol,s=r.gH();i>=0&&s>=0&&(e=(t=r.kj).Jx(0,s,t.getRowCount()-1,i,!0),e=n.kf(-1,e.col,-1,e.colCount),(o=a.C2(t,e))&&t.Cw.v1(o,!0,!1)),r.NG()},yH:function(){var t=this;t.RG(),t.rG=u,t.OG=!1,t.DG=!1},iG:function(t){var e,o,n,r,i,s,l,u,c=this,f=c.kj,h=c._oa(),p=t.formulaRangeHitInfo;p&&p.inBorder&&h&&(h.MH&&h.NH(),h.close(),(o=(e=p.paramRange)&&e.text)&&((n=a.L0(f,o))&&(c.Kka(),r=f.Tq(n),i=t.row,s=t.col,i<r.row&&(i=r.row),i>=r.row+r.rowCount&&(i=r.row+r.rowCount-1),s<r.col&&(s=r.col),s>=r.col+r.colCount&&(s=r.col+r.colCount-1),l=i-r.row,u=s-r.col,c.OG=!0,c.FG=!0,c.K2={paramRange:e,fromRange:n,rowOffset:l,colOffset:u},c.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},c.qG())))},GG:function(){var t,e,o,r,i,s,l,u,c,p,d,g,m,y,C,v,b,w,T,S,x=this;x.OG&&x.FG&&(t=x.fH(),e=x.gH(),t>=0&&e>=0&&(r=(o=x.K2).fromRange,i=o.rowOffset,s=o.colOffset,l=o.toRow,u=o.toCol,p=e,(c=t)===l&&p===u||(o.toRow=c,o.toCol=p,g=(d=x.kj).getRowCount(),m=d.getColumnCount(),y=r.row,C=r.col,v=r.rowCount,b=r.colCount,w=y<0?-1:f(0,h(g-v,t-i)),T=C<0?-1:f(0,h(m-b,e-s)),(S=a.C2(d,n.kf(w,T,v,b)))&&x._oa().D1(o.paramRange.index,S,!0))),x.NG())},zH:function(){var t,e=this;e.RG(),e.OG=!1,e.FG=!1,e.K2=u,(t=e._oa()).onRangeMoved&&t.onRangeMoved()},jG:function(t){var e,o,n,r,i,s,l,u,c,f,h,p=this,d=p.kj,g=p._oa(),m=t.formulaRangeHitInfo;if(m&&g&&(g.MH&&g.NH(),o=(e=m.paramRange)&&e.text,e&&o&&(n=a.L0(d,o)))){if(p.Kka(),r=n.row,i=n.row<0?-1:n.row+n.rowCount-1,s=n.col,l=n.col<0?-1:n.col+n.colCount-1,m.inTopLeft)u=i,c=l,f=r,h=s;else if(m.inTopRight)u=i,c=s,f=r,h=l;else if(m.inBottomLeft)u=r,c=l,f=i,h=s;else{if(!m.inBottomRight)return;u=r,c=s,f=i,h=l}p.OG=!0,p.HG=!0,p.L2={paramRange:e,anchorRow:u,anchorCol:c,toRow:f,toCol:h},p.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},p.qG()}},kG:function(t,e){var o=t.Cw;return o&&o.M0()?(this.D2(e),!0):!!this.F2(t)},IG:function(){var t,e,o,r,i,s,l,u,c,p,d,g,m,y,C,v,b,w,T,S=this;S.OG&&S.HG&&(t=S.fH(),e=S.gH(),t>=0&&e>=0&&(r=(o=S.L2).anchorRow,i=o.anchorCol,s=o.toRow,l=o.toCol,c=e,(u=t)===s&&c===l||(o.toRow=u,o.toCol=c,d=(p=S.kj).getRowCount(),g=p.getColumnCount(),y=i<0?g-1:i,C=h(m=r<0?d-1:r,u),v=h(y,c),b=f(m,u)-C+1,w=f(y,c)-v+1,0===C&&b===d&&(C=-1,b=-1),0===v&&w===g&&(v=-1,w=-1),(T=a.C2(p,n.kf(C,v,b,w)))&&S._oa().D1(o.paramRange.index,T,!0))),S.NG())},AH:function(){var t,e,o=this;o.RG(),o.OG=!1,o.HG=!1,o.L2=u,(t=o._oa()).V4&&(t.W0=1,-1!==(e=t.text().lastIndexOf(",",t.caret()))&&(t.W0=e+1)),t.onRangeResized&&t.onRangeResized()},vr:function(t,e,o){var n,r,i,l,c,f,h,p,d,g,m,y=this.kj,C=this._oa(),v=C&&C.l1();if(!v||0===v.length||!C.UQa)return u;if(n=t.rowViewportIndex,r=t.colViewportIndex,this.qH(n,r,e,o))return u;for(f=v.length-1;f>=0;f--)if(!1!==(i=v[f]).allowDrag&&((!(h=s.G0.H0)||!h._text)&&(l=a.L0(y,i.text)))){if(5,p=(c=y.getRangeRect(n,r,l)).x-2,d=c.x+c.width+1-5,g=c.y-2,m=c.y+c.height+1-5,p+5<=e&&e<d&&(g+1<=o&&o<=g+3||m+1<=o&&o<=m+3))return{paramRange:i,inBorder:!0};if(g+5<=o&&o<m&&(p+1<=e&&e<=p+3||d+1<=e&&e<=d+3))return{paramRange:i,inBorder:!0};if(d<=e&&e<d+5&&m<=o&&o<m+5)return{paramRange:i,inBottomRight:!0};if(p<=e&&e<p+5&&m<=o&&o<m+5)return{paramRange:i,inBottomLeft:!0};if(d<=e&&e<d+5&&g<=o&&o<g+5)return{paramRange:i,inTopRight:!0};if(p<=e&&e<p+5&&g<=o&&o<g+5)return{paramRange:i,inTopLeft:!0}}return u},_oa:function(){var t=this.kj;return t.Cw||t.Cva},ly:function(){var t,e,o,n,a,s,l,c,f,h,p,d,g=this,m=g.kj,y=m.Cw;if(y)if(t=m.Jl,e=m.Kl,n=(o=m.parent)&&1===o.options.referenceStyle,a=new i.SheetParserContext(m,n,r.pf(t,e)),s=new r.Parser,y.MH)for(f=y.u1(),h=0;h<f.length;h++){l=f[h];try{c=s.parse(a,l.text)}catch(t){c=u}c&&1===c.type&&(g.M2(c,t,e,!0,!0),y.D1(l.index,s.unparse(a,c)))}else{if(!(l=y.m1()))return;try{c=s.parse(a,l.text)}catch(t){c=u}if(!c)return;1!==c.type||c.sf()?1===c.type&&(g.N2(c,t,e),y.D1(l.index,s.unparse(a,c))):(p=l.textOffset+l.text.lastIndexOf(":"),y.caret()<=p?(g.M2(c,t,e,!0,!1),d=s.unparse(a,c),y.D1(l.index,d),y.caret(l.textOffset+d.lastIndexOf(":"))):(g.M2(c,t,e,!1,!0),y.D1(l.index,s.unparse(a,c))))}},M2:function(t,e,o,n,r){var i,a,s=t.rowRelative,l=t.columnRelative;n&&(s&&l?(t.rowRelative=!1,t.columnRelative=!1,t.row+=e,t.column+=o):s?(t.columnRelative=!0,t.column-=o):l?(t.rowRelative=!0,t.columnRelative=!1,t.row-=e,t.column+=o):(t.columnRelative=!0,t.column-=o)),i=t.endRowRelative,a=t.endColumnRelative,r&&(i&&a?(t.endRowRelative=!1,t.endColumnRelative=!1,t.endRow+=e,t.endColumn+=o):i?(t.endColumnRelative=!0,t.endColumn-=o):a?(t.endRowRelative=!0,t.endColumnRelative=!1,t.endRow-=e,t.endColumn+=o):(t.endColumnRelative=!0,t.endColumn-=o))},N2:function(t,e,o){var n=t.rowRelative,r=t.columnRelative;n&&r?(t.rowRelative=!1,t.columnRelative=!1,t.row+=e,t.column+=o):n?(t.columnRelative=!0,t.column-=o):r?(t.rowRelative=!0,t.columnRelative=!1,t.row-=e,t.column+=o):(t.columnRelative=!0,t.column-=o)},Kka:function(){var t,e=this.kj.Cw;e&&((t=e.qo)&&e.Cia(t)&&e.Jka())}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(t,e,o){"use strict";var n,r,i,a,s,l;function u(t,e,o,n,s,u){var c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P=t.kj,L=P.mm,G=u&&u.l1(),B=G&&G.length;if(!(B<=0)&&(c=t.VI(o,n,s))){for(e.save(),e.rect(c.x,c.y,c.width,c.height),e.clip(),e.beginPath(),f=[],h=L.isFormulaRangeHoving,p=L.tH,d=L.FG,g=L.K2,m=L.HG,y=L.L2,S=0;S<B;S++)if(v=(C=G[S]).text,b=C.ranges&&C.ranges.length>0?C.ranges:[i.L0(P,v)]){if((x=a.G0.H0)&&x.kj&&void 0!==v)if(l.Bb(v,"!")){if(A=l.Ib(v,"!"),P.name()!==A&&"'"+P.name()+"'"!==A)continue}else if(I=l.Ib(v,"["),R=P.tables,!(P.getCustomNames()[I]||R&&R.findByName(I)))continue;for(w=t.XI(o,n,b,c),M=0;M<w.length;M++)(k=w[M])&&k.width>0&&k.height>0&&(T=u.o1(S),u.t1(C)||C.isPivotClickCell?(h&&p.paramRange.index===S&&(e.beginPath(),e.lineWidth=2,e.strokeStyle=T,e.rect(k.x+1,k.y+1,k.width-3,k.height-3),e.stroke()),t.fJ(e,k,T)):h&&p.paramRange.index===S||d&&g.paramRange.index===S||m&&y.paramRange.index===S?(e.beginPath(),e.lineWidth=2,e.strokeStyle=T,e.rect(k.x+1,k.y+1,k.width-3,k.height-3),e.stroke()):(e.beginPath(),e.lineWidth=2,e.strokeStyle=T,e.rect(k.x,k.y,k.width-1,k.height-1),e.stroke()),u.n1(C)&&((N=r.Common.pc.ec(T)).a=.1,e.beginPath(),e.fillStyle=r.Common.pc.bc(N),e.fillRect(k.x+1,k.y+1,k.width-3,k.height-3)),f.push({rect:k,color:T,allowDrag:C.allowDrag}))}if(f.length>0&&u.UQa)for(O=f.length,S=0;S<O;S++)k=f[S].rect,T=f[S].color,5,D=k.x-2,F=k.x+k.width+1-5,E=k.y-2,j=k.y+k.height+1-5,!1!==f[S].allowDrag&&((x=a.G0.H0)&&x._text||(e.beginPath(),e.fillStyle=T,e.fillRect(D,E,5,5),e.fillRect(F,E,5,5),e.fillRect(D,j,5,5),e.fillRect(F,j,5,5)));e.beginPath(),e.restore()}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/formulaTextbox/formulatextbox.js"),a=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),s=n.GC$.extend,l=r.Common.u,s(n.oJ.prototype,{uH:function(){var t,e,o=this,n=o.kj;n.Xq>0||(t=n.am(),e=o.bm(),o.Mx(t.x,t.y,t.width,t.height),o.Pw(e))}}),n.Worksheet.$n("formulatextboxrender",{paintAdornment:function(t){var e,o,n,r=this,i=t.ctx,a=t.clipRect,s=r.yl,l=r.am(),c=r.mm._oa();if(c)for(o=0;o<=2;o++)for(n=0;n<=2;n++)(e=l.Ft(o,n))&&0!==e.width&&0!==e.height&&u(s,i,o,n,a,c)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G;function B(t){var e,o=[];return a.GC$.each(t,(function(t,n){(e=n.description())&&(e.name=t,o.push(e))})),o}function _(t){var e=n.getMapping()&&n.getMapping().builtInFunctionsMapping,o=e&&e[t]&&e[t].alias||t;return m.Ob(o)}function V(t,e,o){var r,i,s,l,u,c=t.parent,f=c&&c.options;(e&&f&&f.allowUserEditFormula&&f.enableFormulaTextbox||o)&&(t.Cw&&t.Cw.destroy(),t.Cw=new G(e,null,c),r=t.Cw.text(),i=t.getFormulaInformation(t.Jl,t.Kl),"="!==r[0]||i&&i.hasFormula||(r="'"+r,t.Cw.text(r)),s=t.Cw,l=t.mm,u=t.yl,s.bind("AppendStarted",(function(){s.close();var e=t.Px;1!==e&&(t.Px=1,t.Cu(e,1))})),s.bind("AppendEnded",(function(){u.uH()})),s.bind(I,(function(e,o){if(!t.Js){if(o&&o.type!==S){l.Qw(o);var n=t.Jl,r=t.Kl,i=t.getCellType(n,r);t.Wq(a.Events.EditChange,{sheet:t,sheetName:t.name(),row:n,col:r,editingText:i.getEditorValue(t.BF)})}u.uH(),t.Wq(a.Events.FormulaTextBoxTextChanged,{sheet:t,sheetName:t.name(),text:s.text()})}})),s.bind("CaretChanged",(function(){u.uH(),t.Wq(a.Events.FormulaTextBoxCaretChanged,{sheet:t,sheetName:t.name(),caret:s.caret()})})),s.add(function(){var t=[];return a.GC$.each(n.sR()._h,(function(e,o){n.Functions.bi[e]&&(o.name=e,t.push(o))})),t}()),s.add(B(n.Functions.ci)),s.add(B(t.Su).concat(B(c.Su))),u.uH())}function H(t){t.Cw&&(t.Cw.destroy(),t.Cw=l,t.yl.uH());var e=t.parent&&t.parent.CF;g.activeElement===(e&&e.qo)&&t.mm.Qq()}function z(t){var e,o=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE"];for(e=0;e<o.length;e++)if(t===o[e])return!0}function U(){var t,e,o,n=d.getSelection();n.rangeCount>0&&(t=n.getRangeAt(0),(e=g.createElement("span")).innerHTML="<br/>​",t.insertNode(e),(o=g.createRange()).setStartAfter(e),o.setEndAfter(e),o.collapse(!1),n.removeAllRanges(),n.addRange(o))}function W(t){return"gcAttachedFormulaTextBox"===t.target.getAttribute("gcuielement")}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-calc"),r=o("SheetsCalc"),i=o("Common"),a=o("Core"),s=o("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),l=null,u=void 0,c=Math.max,f=Math.min,h=a.GC$.extend,p=a.Ul.Nl,d=window,g=document,m=i.Common.u,y=a.Ul.nl,C=i.Common.j.Fa,v=a.Ul.Ml,b=v.msie&&parseInt(v.version,10)<10,w=m.Nb,e.CONST_FORMULATEXTBOX="formulatextbox",T="gcUIElement",S="input",x=".gcFormulaTextBoxInternal",A=".gcFormulaTextBox",I="TextChanged",R="CaretChanged",M={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},k=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],N='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',O="background",D="background-repeat",F="text-before",E="caret-before",e.C2=function(t,e,o){var n,i,u,c,f,h,p,d,g,m,y,C;return e?(n=t.Cw,c=(u=(i=s.G0.H0)&&i.kj||t).Jl,f=u.Kl,p=(h=t.parent)&&1===h.options.referenceStyle,d=15,(t.Cw&&t.Cw.Nfa||o)&&(d=0),e.row<0&&e.col<0&&(e=new a.Range(0,-1,t.getRowCount(),-1)),m=(g=t.tables)&&g.find(e.row,e.col),(i&&i.Nfa||o)&&(d=0),n&&!n.V4&&function(t,e){if(!t)return!1;var o=!1,n=!1;if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return!0;if(t.hasTotalsRow()&&e.row===t.endRow())return!0}else t.hasHeadersRow()&&e.row===t.startRow()&&(e.rowCount===t.dataRange().rowCount+1&&(o=!0),t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1&&(o=!0)),e.row===t.dataRange().row&&(e.rowCount===t.dataRange().rowCount&&(o=!0),t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1&&(o=!0));return e.col+e.colCount<=t.startColumn()+t.dataRange().colCount&&(n=!0),o&&n}(m,e)?(i&&i._text&&i.kj!==t&&(c=f=-1),r.rangeToFormulaWithStructReference(t,e,c,f,d,p,m)):(y=r.rangeToFormula(e,c,f,d,p),(i&&i._text||t.Cw&&t.Cw.V4&&t.Cw.ria)&&(C=function(t){var e=t.name();return r.jma(e.split(""),!1)?e:"'"+function(t){return t.replace(/'/g,"''")}(e)+"'"}(t),y=C+"!"+y),y)):l},a.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",a.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",d.Yl.km.push((function(t,e){var o,n=s.G0;!e&&t.endEdit&&n&&((o=n.H0)&&o.I0&&t.Cw&&(t.Cw&&t.Cw.destroy(),t.Cw=l,o.$b()))})),e.J0=V,e.K0=H,e.L0=function(t,e){var o,n,i,a;if(!e)return l;i=(n=(o=s.G0.H0)&&o.kj||t).Jl,a=n.Kl;try{return r.formulaToRange(t,e,i,a)}catch(t){}return l},h(a.DC.prototype,{bE:function(t){return!(t&&t.Cw&&t.Cw.M0())}}),a.Worksheet.$n(e.CONST_FORMULATEXTBOX,{startEdit:function(t){V(this,t.element)},endEdit:function(){H(this)}}),j=a.DC.prototype,P=j.dE,a.DC.$n(e.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(t){var e=a.sJc(this.OC),o=e?e.Cw:void 0,n=o&&o.M0(),r=s.G0.H0;n?t.r=!1:r&&r.I0&&r.$b()}}),j.dE=function(){var t=a.sJc(this.OC),e=t&&t.Cw,o=s.G0.H0,n=o&&o._text;return P.call(this)&&!n&&!e},L=1,G=function(){function t(t,o,n){var r,i,l,u=this,c=t;if(u.V4=!1,u.Nfa=!1,u.ria=!0,u.Ac=[],u.Bc=[],u._gc=[],o&&o.rangeSelectMode&&(!0===o.absoluteReference&&(u.Nfa=!0),!1===o.needSheetName&&(u.ria=!1),u.V4=!0,u.D5=!1,u.E5=!1,u.cga=t,r=function(t,e){var o,n,r,i,s,l,u,c,f,h,d=a.GC$(t);return d.attr("contenteditable","false"),o=p("table"),a.GC$(o).css("border-spacing","0"),a.GC$(o).css("width","100%"),d.append(o),n=p("tbody"),o.appendChild(n),r=document.createElement("tr"),n.appendChild(r),i=document.createElement("td"),a.GC$(i).css("padding-right","0px"),r.appendChild(i),s=document.createElement("td"),a.GC$(s).css("width","23px"),a.GC$(s).css("padding-right","0px"),r.appendChild(s),l=d.width()-a.GC$(s).width(),u=p("div"),c=p("div"),a.GC$(c).width(l),a.GC$(c).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),c.appendChild(u),i.appendChild(c),f=p("div"),s.appendChild(f),a.GC$(u).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),a.GC$(u).width(l),a.GC$(u).attr("contenteditable","true"),a.GC$(u).attr("spellcheck","false"),(h=a.GC$(f)).css({display:"block",float:"right",width:"23px",height:"23px",background:N,"background-repeat":"no-repeat"}),h.bind("click",(function(){e.D5?(e.OC.Wq("RangeSelectEnding",e),e.endSelectMode()):e.startSelectMode()})),{contentDiv:u,button:f}}(t,u),c=r.contentDiv,u.sia=r.button,u.tia=t,u.C5=L,L++),u.UQa=!0,u.ad(n&&n.getHost()||g.body),c&&u.N0(c),n&&(u.O0=!0,u.P0(n),u.OC.Gu(a.Events.FormulatextboxActiveSheetChanging,s.G0.Q0),u.OC.Fu(a.Events.FormulatextboxActiveSheetChanging,s.G0.Q0),u.OC.Gu(a.Events.FormulatextboxActiveSheetChanged,s.G0.R0),u.OC.Fu(a.Events.FormulatextboxActiveSheetChanged,s.G0.R0)),i=u.text(),u.S0=u.T0(i),u.Cia(c)){u.V0(u.S0);try{(l=d.getSelection()).selectAllChildren(c),l.rangeCount>0&&l.collapseToEnd()}catch(t){}a.GC$(u.qo).data(F,i)}a.GC$(t).data(e.CONST_FORMULATEXTBOX,u)}return t.prototype.j5=function(t){var e,o,n,r,i,a,l=this;l.O1(),l.UF(),l.E5=!0,e=s.W4(l.OC.qo),(o=l.a1())&&(o.suspendPaint(),V(o,e,!0),(n=o.Cw).V4=!0,n.C5=l.C5,n.Nfa=l.Nfa,n.ria=l.ria,t&&(l.text(t),l.caret(t.length)),r=l.text(),(i=l.caret())<=0&&(i=r.length),l.focus(),l.caret(i),l.MH=!0,l.W0=1,-1!==(a=r.lastIndexOf(",",i))&&(l.W0=a+1),r||(l.text("="),r="=",l.caret(1),i=1),0!==r.indexOf("=")&&(r="="+r,i++),n.text(r),n.caret(i),n.MH=l.MH,n.W0=l.W0,o.resumePaint())},t.prototype.startSelectMode=function(t){var e,o=t;o&&0!==o.indexOf("=")&&(o="="+o),(e=this).V4=!0,e.D5=!0,a.GC$(e.sia).css([O,D],['url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',"no-repeat"]),e.j5(o)},t.prototype.endSelectMode=function(){this.D5=!1,this.H5(),a.GC$(this.sia).css([O,D],[N,"no-repeat"])},t.prototype.H5=function(){var t=this.a1();t&&(t.gv(!0,u,!0),t.repaint())},t.prototype.rgc=function(t){this._gc=[t]},t.prototype.ahc=function(){return this._gc},t.prototype.destroy=function(){var t=this;t.D5&&t.H5(),t._gc=l,t.MH=!1,t.W0=-1,t.X0(),t.Y0(),a.GC$(t.Z0).remove(),a.GC$(t.$0).remove(),a.GC$(t._0).remove()},t.prototype.bind=function(t,e,o){var n=this.qo;n&&t&&(t=t.split(/\s+/).join(A+" "),a.GC$(n).bind(t+A,e,o))},t.prototype.unbind=function(t,e){var o=this.qo;o&&t&&(t=t.split(/\s+/).join(A+" "),a.GC$(o).unbind(t+A,e))},t.prototype.unbindAll=function(){var t=this.qo;t&&a.GC$(t).unbind(A)},t.prototype.caret=function(t){var e,o,n=this,r=n.qo;if(r)return e=g.activeElement===r,o=a.GC$(r),0===arguments.length?e?n.b1(r).end:o.data(E):void(t!==n.caret()&&(e?(n.c1(r,t),o.data(E,n.b1(r).end)):o.data(E,t),n.Wq(R,{})))},t.prototype.b1=function(t){var e,o,n,r=-1,i=-1;return this.d1(t)?(r=t.selectionStart,i=t.selectionEnd):this.Cia(t)&&((e=d.getSelection()).rangeCount>0&&((n=(o=e.getRangeAt(0)).cloneRange()).selectNodeContents(t),n.setEnd(o.endContainer,o.endOffset),i=(""+n).length,(n=o.cloneRange()).selectNodeContents(t),n.setEnd(o.startContainer,o.startOffset),r=(""+n).length,n.detach())),{start:r,end:i}},t.prototype.c1=function(t,e){var o,n,r,i;this.d1(t)?t.setSelectionRange(e,e):this.Cia(t)&&((r=this.e1(t,e))&&(o=d.getSelection(),n=g.createRange(),(i=r.node)&&1===i.childNodes.length?n.setStart(i.firstChild,r.offset):i.lastChild&&i.lastChild.length&&n.setStart(i.lastChild,i.lastChild.length),n.collapse(!0),o.removeAllRanges(),o.addRange(n),this.V4&&(t.parentElement.scrollTop=t.parentElement.scrollHeight)))},t.prototype.text=function(t){var e,o,n,r,i,l,u,c=this,f=c.qo,h=c.a1();if(!f||!h||h.Js)return"";if(e=c.d1(f),o=c.Cia(f),0===arguments.length){if(n="",e)n=f.value;else if(o){if(f.getElementsByClassName("gcsj-func-gray-formula").length>0)return"";(n=(n=b?a.Ul.Woa(f):f.innerText).replace(/\r\n?/g,"\n")).indexOf(" ")>=0&&(n=a.Ul.Ika(n," "," "))}return n}null!=t||(t=""),t!==c.text()&&(r=c.mLb(t),c.S0=r?c.T0(r):c.T0(t),e?f.value=t:o&&(i=c.nLb(c.S0,t),c.V0(i),c.caret(t.length)),l={},(u=s.G0.H0)&&u._text&&(l={sheet:u.kj,editor:u.I0&&u.I0.firstChild.firstChild,canvasOffset:u.f1}),c.Wq(I,l)),c.oLb&&c.pLb()},t.prototype.BXc=function(){a.GC$(this.qo).data(F,this.text())},t.prototype.autoComplete=function(t){return 0===arguments.length?this.g1:void(this.g1=t)},t.prototype.showHelp=function(t){return 0===arguments.length?this.h1:void(this.h1=t)},t.prototype.add=function(t){var e,o;if(t)if(a.GC$.isArray(t))for(e=t.length,o=0;o<e;o++)this.Sb(t[o]);else this.Sb(t)},t.prototype.Sb=function(t){var e,o,n,r,i=t&&w(_(t.name));if(i){for(o=(e=this.i1).length,n=0;n<o;n++){if((r=w(e[n].name))===i)return;if(r>i)break}e.splice(n,0,t)}},t.prototype.remove=function(t){var e,o,n;if(t)for(t=w(t),o=(e=this.i1).length,n=0;n<o;n++)if(w(e[n].name)===t){e.splice(n,1);break}},t.prototype.workbook=function(t){var e=this;return 0===arguments.length?e.OC:void(t===l?e.V4&&e.H5():(e.P0(t),e.j1()))},t.prototype.P0=function(t){var e;t&&((e=this).OC&&e.Y0(),e.qo&&(e.OC=t))},t.prototype.l1=function(){var t,e,o,n,r=[],i=this.S0,a=i&&i.length,s=0,l=0;if(a>0)for(o=0;o<a;o++)e=(t=i[o]).text,11===t.type&&(r.push({textOffset:s,text:e,ranges:t.ranges,index:l,allowDrag:t.allowDrag}),l++),s+=e.length;return(n=this.uMc)&&r.push({ranges:[n],index:l,allowDrag:!1,isPivotClickCell:!0}),r},t.prototype.m1=function(){var t,e,o,n,r,i=this.qo,a=this.l1();if(i&&a&&a.length>0)for(t=this.caret(),e=a.length,o=void 0,n=void 0,r=0;r<e;r++){if((n=(o=a[r]).textOffset)<t&&t<=n+o.text.length)return o;if(n>=t)break}return l},t.prototype.n1=function(t){var e,o,n;return!!t&&(e=this.caret(),o=t.text,(n=t.textOffset)<e&&e<=n+o.length)},t.prototype.o1=function(t){var e,o,n,r,i,a,s,l=this.l1(),u=l.length;if(t<0||u<=t)return"";for(e=[],n=0,r=0;r<u;r++){for(o=l[r],i=!1,a=0;a<e.length;a++)if(o.text&&e[a].text.replace(/\s+/g,"").toUpperCase()===o.text.replace(/\s+/g,"").toUpperCase()){i=!0;break}if(i){if(t===r){n=a;break}}else if(e.push(o),t===r){n=e.length-1;break}}return(s=k)[n%s.length]},t.prototype.M0=function(){var t,e,o;return!!this.MH||!!this.V4||!!(t=this.s1(this.caret()))&&(e=t.type,o=t.text,1===e||8===e||7===e&&"%"!==o||5===e||9===e||15===e)},t.prototype.t1=function(t){if(!t||!this.MH)return!1;var e=this.W0,o=this.caret(),n=t.textOffset;return e<=n&&n<o},t.prototype.u1=function(){var t,e,o=[],n=this.l1(),r=n.length;if(r>0)for(e=0;e<r;e++)t=n[e],this.t1(t)&&o.push(t);return o},t.prototype.v1=function(t,e,o,n){var r,a,l,u,c,f,h,p,d,g,m,y=this,C=y.qo;if(t&&C){if(!y.MH){if(!y.M0())return;e=!1,y.MH=!0,y.W0=y.caret(),y.Wq("AppendStarted",{})}r=y.W0,a=y.text(),l=y.caret(),a||(a="=",r=y.W0=1,l=1),u=l,o&&(e=!1,a=a.substr(0,r)+(l<0?"":a.substr(l)),y.S0=y.T0(a),u=l=r),c=y.s1(l),e?(f=(f=a.substr(0,l)).substr(0,f.length-c.text.length)).length>=r&&(c.text=t,u=f.length+t.length):(h=y.S0,p=i.Common.k.Cb(h,c),d=y.V4&&h.length>1&&p===h.length-1&&11===c.type,n?(t=l>r||d?a+this.w1()+t:a.slice(0,l)+t+a.slice(l),y.S0=y.T0(t)):l>r||d?(h.splice(p+1,0,{text:this.w1(),type:8}),h.splice(p+2,0,{text:t,type:11}),t=","+t):h.splice(p+1,0,{text:t,type:11}),u=l+t.length),y.z1(),g={},(m=s.G0.H0)&&m._text&&(g={sheet:m.kj,editor:m.I0&&m.I0.firstChild.firstChild,canvasOffset:m.f1}),y.Wq(I,g),y.caret(u)}},t.prototype.NH=function(){var t=this;t.MH&&(t.MH=!1,t.W0=-1,t.Wq("AppendEnded",{}))},t.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},t.prototype.C1=function(t){return void 0!==t&&(this.W0=t),this.W0},t.prototype.D1=function(t,e,o){var n,r,i,a,s,l,u,c=this;if(c.qo&&!(t<0)&&e){for(n="",r=!1,a=(i=c.S0)&&i.length,l=0,u=0;u<a;u++){if(11===(s=i[u]).type&&l++===t){i[u]={text:e,type:11},r=!0;break}n+=s.text}r&&(c.z1(),c.Wq(I,{}),o?c.caret(c.text().length):c.caret(n.length+e.length))}},t.prototype.j1=function(){var t,e,o=this;o.OC&&(t=o.qo,o.OC&&t&&(t.setAttribute(T,"gcAttachedFormulaTextBox"),o.V4||(o.OC.CF=o),o.OC.Fu(a.Events.FormulatextboxEditStarted,o,o.E1),o.OC.Fu(a.Events.FormulatextboxEnterCell,o,o.F1),o.OC.Fu(a.Events.FormulatextboxEditEnded,o,o.G1),o.OC.Fu(a.Events.FormulatextboxActiveSheetChanged,o,o.H1),o.OC.Fu(a.Events.FormulatextboxRangeChanged,o,o.I1),o.OC.Fu(a.Events.FormulaTextBoxTextChanged,o,o.J1),o.OC.Fu(a.Events.FormulaTextBoxCaretChanged,o,o.K1),o.OC.Fu(a.Events.ValueChanged,o,o.qLb),(e=a.sJc(o.OC))&&!o.V4&&o.text(o.L1(e,e.Jl,e.Kl)),o.Fu(I,o,o.M1),o.Fu(R,o,o.N1)))},t.prototype.refresh=function(t){var e,o=this.OC,n=this;o&&((e=a.sJc(o))&&!n.V4&&(n.OG=!!t||n.OG,n.text(n.L1(e,e.Jl,e.Kl)),n.OG=!1))},t.prototype.Y0=function(){var t=this,e=t.OC;!t.O0&&e&&(t.V4||(e.CF=null,e.Gu(a.Events.FormulatextboxEditStarted,t.E1),e.Gu(a.Events.FormulatextboxEnterCell,t.F1),e.Gu(a.Events.FormulatextboxEditEnded,t.G1),e.Gu(a.Events.FormulatextboxActiveSheetChanged,t.H1),e.Gu(a.Events.FormulatextboxRangeChanged,t.I1),e.Gu(a.Events.FormulaTextBoxTextChanged,t.J1),e.Gu(a.Events.FormulaTextBoxCaretChanged,t.K1),e.Gu(a.Events.ValueChanged,t.qLb),t.Gu(I,t.M1),t.Gu(R,t.N1)),t.text("")),t.OC=null},t.prototype.O1=function(){var t,e,o=this;o.OG||(o.OG=!0,(e=(t=this.OC)&&a.sJc(t))&&!e.isEditing()?(o.V4||e.EF(null,e.Jl,e.Kl,null,null,!1,null),o.Q1=!0):o.Q1=!1,o.OG=!1,o.R1||o.S1())},t.prototype.rLb=function(){var t=this,e=t.qo,o=t.sLb;e.insertBefore(o,e.firstChild),o.innerText=t.oLb},t.prototype.tLb=function(t,e){t&&(this.uLb!==e&&(this.uLb=e,t.style.display=e?"":"none"))},t.prototype.pLb=function(){var t,e=this,o=e.qo;e.Cia(o)?((t=e.sLb)||((t=e.sLb=p("span")).className="gcsj-func-gray-formula"),e.tLb(t,!0),e.rLb()):o.placeholder=e.oLb},t.prototype.vLb=function(){var t,e=this;e.oLb&&(e.oLb="",t=e.qo,e.Cia(t)?e.tLb(e.sLb,!1):t&&(t.placeholder=""))},t.prototype.UF=function(){var t,e,o,n,r,i,s=this,l=s.OC,u=l&&a.sJc(l);u&&(t=u.Cw,s.Q1&&t&&(e=t.text(),(o=s.text())!==e&&(n=s.caret(),r=u.getFormulaInformation(u.getActiveRowIndex(),u.getActiveColumnIndex()),s.text(e),r.isArrayFormula&&(n>=o.length&&(n-=1),n=c(0,n-1)),s.caret(n))),(s.Q1&&t||s.V4)&&(2!==(i=u.Px)&&(u.Px=2,u.Cu(i,2))))},t.prototype.L1=function(t,e,o){var n,r,i,s,l,u="";if(t){if(r=(n=t.parent)&&n.options,(i=t.getFormulaInformation(e,o))&&i.hasFormula){if(u="="+i.formulaWithCulture,i.isDynamicArray)return this.oLb=u,"";this.oLb="",i.isArrayFormula&&(u="{"+u+"}")}else s=t.getActualStyle(e,o),u="string"==typeof(l=t.getValue(e,o))&&s.quotePrefix||u.length>0&&"="===u[0]&&r&&r.allowUserEditFormula?"'"+l:a.Ul.Il(s,l,t)||"";this.vLb()}return u},t.prototype.H1=function(t,e){var o,n,r=t.data;r.OG||(o=e.newSheet,r.V4||(r.OG=!0,r.close(),e&&(n=o,r.text(r.L1(n,n.Jl,n.Kl))),r.OG=!1))},t.prototype.E1=function(t){var e,o,n,r=t.data;r.OG||(n=(o=(e=r.OC)&&a.sJc(e))&&o.Cw)&&r.V4===n.V4&&r.C5===n.C5&&(r.vLb(),r.OG=!0,r.text(n.text()),r.OG=!1)},t.prototype.F1=function(t,e){var o=t.data;o.V4||o.OG||(o.OG=!0,e&&o.text(o.L1(e.sheet,e.row,e.col)),o.OG=!1)},t.prototype.I1=function(t,e){var o,n,r,i,s,l=t.data;l.OG||l.V4||(l.OG=!0,e&&(o=e.sheet,n=e.row,r=e.col,i=e.rowCount,s=e.colCount,new a.Range(n,r,i,s).contains(o.Jl,o.Kl)&&l.text(l.L1(o,o.Jl,o.Kl))),l.OG=!1)},t.prototype.G1=function(t,e){var o=t.data;return o.V4&&o.D5&&o.E5?void(e.ignore=!0):void(o.OG||(o.OG=!0,o.close(),e&&e.sheet.Cw&&!e.sheet.Cw.V4&&!o.V4&&o.text(o.L1(e.sheet,e.row,e.col)),o.OG=!1))},t.prototype.qLb=function(e,o){var n=o.sheet,r=n&&n.parent&&n.parent.CF;r&&r.e2()===o.row&&r.f2()===o.col&&r.a1()===n&&e.data instanceof t&&(o.text=n.getText(o.row,o.col),e.data.J1(e,o))},t.prototype.J1=function(t,e){var o,n=t.data;n.OG||(!e.sheet.Cw||n.V4===e.sheet.Cw.V4&&n.C5===e.sheet.Cw.C5)&&(n.OG=!0,e&&(o=n.caret(),n.text(e.text),n.caret(o)),n.OG=!1)},t.prototype.K1=function(t,e){var o=t.data;o.OG||(!e.sheet.Cw||o.V4===e.sheet.Cw.V4&&o.C5===e.sheet.Cw.C5)&&(o.OG=!0,e&&o.caret(e.caret),o.OG=!1)},t.prototype.M1=function(t){var e,o,n,r,i,s,l,u,c=t.data;if(!c.OG&&(o=(e=c.OC)&&a.sJc(e))){if(o.isEditing()||(c.O1(),c.focus()),c.OG=!0,n=o.Jl,r=o.Kl,i=o.Cw,s=o.getCellType(n,r),i){if(c.V4!==i.V4||c.C5!==i.C5)return;l=i.caret(),i.text(c.text()),i.caret(l)}else u={sheet:o,row:n,col:r,sheetArea:3},s.setEditorValue(o.BF,c.text(),u);c.OG=!1}},t.prototype.N1=function(t){var e,o,n,r=t.data;r.OG||(o=(e=r.OC)&&a.sJc(e))&&o.isEditing()&&((!(n=o.Cw)||r.V4===n.V4&&r.C5===n.C5)&&(r.OG=!0,n&&(n.caret(r.caret()),r.S1()),r.OG=!1))},t.prototype.ad=function(t){var e,o,n,r=this;r.T1=!1,r.U1=!1,r.MH=!1,r.W0=-1,r.i1=[],r.g1=!0,r.h1=!0,r.V1=!0,(e=p("div")).className="gcsj-func-ac-popup",e.style.display="none",e.setAttribute(T,"gcFuncACPopup"),t.insertBefore(e,l),r.Z0=e,r.R1=!1,(o=p("div")).className="gcsj-func-help-popup",o.style.display="none",o.setAttribute(T,"gcFuncHelpPopup"),t.insertBefore(o,l),r.$0=o,r.W1=!1,a.GC$(e).bind("mouseover",(function(){r.V1=!1})).bind("mouseout",(function(){r.V1=!0})),a.GC$(o).bind("mouseover",(function(){r.V1=!1})).bind("mouseout",(function(){r.V1=!0})),a.GC$(e).bind("scroll",(function(){r.X1&&clearTimeout(r.X1),r.X1=d.setTimeout((function(){r.qo&&r.qo.focus()}),100)})),(n=p("div")).style.display="none",n.setAttribute(T,"gcFuncHelpDiv"),t.insertBefore(n,l),r._0=n,r.OC=null,r.OG=!1,r.Q1=!1,r.O0=!1},t.prototype.N0=function(t){var e,o,n;t&&(o=(e=this).Cia(t),(e.d1(t)||o)&&(n=a.GC$(t),e.qo&&e.X0(),e.qo=t,v&&(v.msie||v.chrome)?o||b||v.chrome?(e.Fu("focus",(function(){n.data(F,e.text())})),e.Fu("click",(function(){n.focus()})),"input keydown keyup cut paste".split(" ").forEach((function(t){e.Fu(t,(function(){e.Y1()}))}))):e.Fu(S,(function(){e.Z1()})):e.Fu(S,(function(){if(o){var t=e.qo.lastChild;v.chrome&&t&&"BR"===t.tagName&&e.qo.removeChild(t)}e.Z1()})),e.Fu("keydown",(function(t){var n,r,i,s,l,u=t.ctrlKey,c=t.shiftKey,f=t.altKey,h=t.metaKey,p=u||c||f||h,d=t.keyCode;!p&&e.R1&&(d===M.down?(e._1(1),y(t)):d===M.up?(e._1(-1),y(t)):d===M.tab&&(e.a2(),y(t))),d===M.esc&&e.close(),e.b2(t),r=(n=a.sJc(e.OC))&&n.mm.LH(t),e.V4&&r&&((i=n.Cw)&&i.MH&&i.NH()),o&&(r?(8===d?W(t)&&a.uHb.processBackspaceAndLeftArrowKeyEvent(t,!0):46===d&&W(t)&&a.uHb.processDeleteAndRightArrowKeyEvent(t,!0),e.Jka()):13===d&&(u||f)?(W(t)&&U(),e.Jka(!0)):37===d?W(t)&&a.uHb.processBackspaceAndLeftArrowKeyEvent(t,!1):39===d&&W(t)&&a.uHb.processDeleteAndRightArrowKeyEvent(t,!1),o&&u&&(90===d||89===d)&&y(t)),s=e.text(),a.Ul.sl()&&o&&h&&(l=void 0,90===d&&(c?(l=e.Bc.pop())&&(e.text(l),e.Ac.push(s)):(l=e.Ac.pop()||"",e.text(l),e.Bc.push(s)),t.preventDefault(),t.stopPropagation()))})),e.Fu("keyup",(function(t){var n,r,i,a;e.b2(t),n=e.text(),o&&(r=void 0,i=t.keyCode,(a=t.ctrlKey)&&90===i?(r=e.Ac.pop()||"",e.text(r),e.Bc.push(n)):a&&89===i&&((r=e.Bc.pop())&&(e.text(r),e.Ac.push(n))))})),e.Fu("focus",(function(t){v&&v.mozilla&&!e.qo.innerText&&(e.qo.innerText=""),e.b2(t),e.V4&&e.D5&&(e.E5=!0,e.j5())})),e.Fu("blur",(function(){e.V1&&e.close(),e.V4&&(e.H5(),e.E5=!1)})),e.Fu("mousedown",(function(){e.E5=!0,e.uLb&&(e.vLb(),e.wLb=!0),e.O1()})),e.Fu("mouseup",(function(){if(e.wLb){e.wLb=!1;var t=e.qo,o=d.getSelection();t!==o.anchorNode&&o.selectAllChildren(t)}e.UF()})),e.Fu("click",(function(t){var o,n,r;e.MH&&e.NH(),(r=(n=(o=e.OC)&&a.sJc(o))&&n.Cw)&&r.MH&&!r.V4&&r.NH(),e.b2(t)})),e.Fu("compositionstart",(function(){e.T1=!0})),e.Fu("compositionend",(function(){e.T1=!1,(v.edge||v.chrome||v.msie)&&e.Y1()}))))},t.prototype.X0=function(){var t,o=this,n=o.qo;n&&((t=a.GC$(n)).removeData(F),t.removeData(E),t.removeAttr(T),t.data(e.CONST_FORMULATEXTBOX)&&t.data(e.CONST_FORMULATEXTBOX,l),o.nu(),o.unbindAll(),o.V4&&(a.GC$(o.cga).empty(),o.cga=l),o.qo=l)},t.prototype.Y1=function(){var t=this,e=a.GC$(t.qo),o=t.text();e.data(F)!==o&&(t.T1||e.data(F,o),t.Z1())},t.prototype.b2=function(t){if(v&&v.msie){setTimeout(function(t,e){return function(){t.d2(t,e)}}(this,t),10)}else this.d2(this,t)},t.prototype.d2=function(t,e){var o,n,r,i,s,l=e.keyCode,u=l===M.left||l===M.right||l===M.home||l===M.end||l===M.pdn||l===M.pup||l===M.tab||l===M.enter;if(t.g1||(u=u||l===M.up||l===M.down),o=void 0!==e.button,u||o){if(n=t.qo,r=a.GC$(n),(i=t.b1(n)).start!==i.end)return;s=i.end,r.data(E)!==s&&(r.data(E,s),t.Wq(R,{}),t.S1())}},t.prototype.e2=function(){var t=this.a1();return t?t.Jl:u},t.prototype.f2=function(){var t=this.a1();return t?t.Kl:u},t.prototype.a1=function(){if(this.OC)return a.sJc(this.OC)},t.prototype.parseInternal=function(t,e,o,i){var a,s,l=[];return t&&"="===t[0]&&function(t,e){var o,n=0;for(o=0;o<t.length;o++)t[o]===e&&n++;return n}(t,'"')%2!=1?(a=new n.Parser,s=r.qzb(a,t,e,o,i,!0),l=this.i2(s)):(l.push({text:t,type:17}),l)},t.prototype.T0=function(t){return this.parseInternal(t,this.a1(),this.e2(),this.f2())},t.prototype.Z1=function(){var t,e,o,n=this,r=n.text();return"\n"!==r&&r.indexOf("\n")>=0?void n.Wq(I,{type:S}):(t=n.qo,e=a.GC$(t),n.U1=!0,n.S0=n.T0(r),n.Cia(t)?n.T1||("\n"===r?(e.empty(),n.Wq(I,{type:S})):(o=n.caret(),n.V0(n.S0),n.Wq(I,{type:S}),n.caret(o))):n.Wq(I,{type:S}),o=n.caret(),e.data(E)!==o&&(e.data(E,o),n.Wq(R,{})),n.c2(),void(n.R1||n.S1()))},t.prototype.j2=function(){return i.Common.CultureManager.q4().NumberFormat},t.prototype.h2=function(){var t=this.j2();return t&&t.arrayGroupSeperator||";"},t.prototype.l2=function(){var t=this.j2();return t&&t.arrayListSeparator||","},t.prototype.w1=function(){var t=this.j2();return t&&t.listSeparator||","},t.prototype.g2=function(){var t=this.j2();return t&&t.numberDecimalSeparator||"."},t.prototype.i2=function(t){var e,o,n,r,a=[],s=[],l=this.h2(),u=this.l2(),c=!1;for(e=0;e<t.length;e++)e>0&&e<t.length-1&&";"===t[e-1].text&&","===t[e].text&&"ARRAYROW"===t[e+1].text||(o=t[e],n=this.m2(o,s),r=o.text,2===n?a.push({text:r,type:n}):c&&8===n&&","===r?a.push({text:u,type:9}):c&&8===n&&";"===r?a.push({text:l,type:10}):8===n?a.push({text:r,type:n}):3===n?("ARRAY"===r&&(c=!0),a.push({text:"{",type:3})):4===n?"ARRAY"===r?(c=!1,a.push({text:"}",type:4})):a.push({text:r,type:4}):6===n?a.push({text:")",type:n}):13===n?a.push({text:i.Common.o.nb(r),type:n,ranges:o.ranges,allowDrag:o.canDrag}):null!==n&&a.push({text:r,type:n,ranges:o.ranges,allowDrag:o.canDrag}));return a},t.prototype.m2=function(t,e){var o,n=t.type,r=t.subType,i=t.text,a=t.value;if(1===n){if(1===r)return"ARRAY"===i||"ARRAYROW"===i?(e.push(3),3):(e.push(5),"@"===a||"("===a.trim()?5:2);if(2===r){if(")"===a.trim())return 6;if(e.length>0){if(3===(o=e[e.length-1]))return e.pop(),4;if(5===o)return e.pop(),6}}if("="===a.trim())return 1}else if(3===n){if(0===r)return 8}else{if(5===n||6===n||4===n)return 7;if(0===n)return 7===r||0===r?11:5===r?12:4===r?13:3===r?14:6===r?16:14;if(7===n)return 15;if(8===n)return 17}return 17},t.prototype.z1=function(){var t,e=this,o=e.qo,n=e.S0,r="",i=n&&n.length;for(t=0;t<i;t++)r+=n[t].text;e.d1(o)?o.value=r:e.Cia(o)&&e.V0(n)},t.prototype.d1=function(t){var e=t&&t.tagName;return"TEXTAREA"===e||"INPUT"===e},t.prototype.Cia=function(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable},t.prototype.Dia=function(t){return"gcEditingInput"===a.GC$(t).attr(T)},t.prototype.bW=function(t){return t&&"="===t[0]},t.prototype.Fu=function(t,e,o){var n=this.qo;n&&t&&(t=t.split(/\s+/).join(x+" "),a.GC$(n).bind(t+x,e,o))},t.prototype.Gu=function(t,e){var o=this.qo;o&&t&&(t=t.split(/\s+/).join(x+" "),a.GC$(o).unbind(t+x,e))},t.prototype.nu=function(){var t=this.qo;t&&a.GC$(t).unbind(x)},t.prototype.Wq=function(t,e){var o=this.qo;o&&a.GC$(o).trigger(t,e)},t.prototype.s1=function(t){var e,o,n,r,i;if(t<=0)return l;if((o=(e=this.S0)&&e.length)>0)for(n=0,r=void 0,i=0;i<o;i++)if((n+=(r=e[i]).text.length)>=t)return r;return l},t.prototype.n2=function(){var t,e,o,n,r,i=this.OC;if(i&&((t=a.sJc(i))&&(e=t.getCalcService().allowDynamicArray,o=t.Cw))){for(r=(n=[].concat(o.i1)).length-1;r>=0;r--)!e&&n[r]&&z(n[r].name)?n.splice(r,1):n[r].isFunc=!0;return n.concat(this.o2(i,t)).concat(this.q2(i.sheets)).concat(this.wMc(i))}return this.i1},t.prototype.o2=function(t,e){var o,n=[],r=e.getCustomNames();return r&&a.GC$.each(r,(function(t,e){n.push({name:e.Cj,description:e.kT})})),(o=t.getCustomNames())&&a.GC$.each(o,(function(t,e){n.push({name:e.Cj,description:e.kT})})),n},t.prototype.q2=function(t){var e=[];return t.forEach((function(t){var o,r,i=t.tables;if(i&&(o=i.all()))for(r=0;r<o.length;r++)e.push({name:o[r].name(),description:n.sR().Fbx_TableName_Description+o[r].name()})})),e},t.prototype.wMc=function(t){var e,o=[],r=t.pJc;for(e=0;e<r.length;e++)o.push({name:r[e].name(),description:n.sR().Fbx_TableSheetName_Description+r[e].name()});return o},t.prototype.s2=function(t,e){var o,n,r,i;for(t=w(t),m.Bb(t,"[")&&(t=t.substr(t.lastIndexOf("[")+1),t=m.Gb(t,"@","")),o=[],n=e&&e.length,i=0;i<n;i++)r=e[i],0===w(_(r.name)).indexOf(t)&&o.push(r);return o},t.prototype.t2=function(){var t,e,o,n,r,i=this.caret();if(i<=0)return"";if((e=(t=this.S0)&&t.length)>0)for(o=0,n=void 0,r=0;r<e;r++){if(o+(n=t[r]).text.length>=i)return n.text.substring(0,i-o);o+=n.text.length}return""},t.prototype.u2=function(){var t,e,o,n,r,i,a,s,u,c=this.caret(),f=this.S0,h=f&&f.length,p=[],d=0;for(e=0;e<h;e++){if(t=f[e],p.push(t),6===t.type)for(o=0;p.length>0;)if(6===(n=p.pop()).type&&o++,5===n.type&&o--,0===o){p.length>0&&((n=p[p.length-1])&&2===n.type&&p.pop());break}if((d+=t.text.length)>=c)break}if(p.length>0)for(r=0;p.length>0;)if(8===(t=p.pop()).type)r++;else if(2===t.type){for(i=w(t.text),s=(a=this.n2())&&a.length,u=void 0,e=0;e<s;e++)if(u=a[e],w(_(u.name))===i)return{func:u,activeParamterIndex:r,isFunc:u.isFunc};break}return l},t.prototype.c2=function(){var t,e,o,n,r,i,s,l,u=this,c=u.v2();if(u.g1&&u.bW(u.text())&&c&&c.length>0&&!u.MH&&!u.T1&&!u.V4){for(u.w2(),t=u.Z0,c.length>8?(t.style.height="204px",t.style.overflowY="scroll"):(t.style.height="auto",t.style.overflowY=""),e="",o=c.length,n=void 0,r=0;r<o;r++)e+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(n=c[r]).isFunc+">"+_(n.name)+"</div><div class='gcsj-func-ac-row-description'>"+(n.description||"")+"</div></div>";(i=a.GC$(u.Z0)).html(e).show(),u.R1=!0,(s=i.find(".gcsj-func-ac-row")).length>0&&(l="gcsj-ac-row-active",a.GC$(s[0]).addClass(l),s.bind("mouseover",(function(){s.removeClass(l),a.GC$(this).addClass(l)})),s.bind("click",(function(){u.a2()}))),u.SH()}else u.z2()},t.prototype.v2=function(){var t,e,o,r,i,a,s,l=this,u=l.s1(l.caret()),c=u&&u.text,f=[],h=l.S0.indexOf(u);if(u&&14===u.type)return f;if((t=l.A2(h)).length>0){for(i in e=JSON.parse(JSON.stringify(n.sR().B2)),o=n.getMapping()&&n.getMapping().tableFunctionsMapping,r=[],e)(a=o&&o[e[i].name])&&(e[i].name=a),r.push(e[i]);if(f=f.concat(t).concat(r),m.jb(c,"[")||m.jb(c,"[@"))return f}else f=this.n2();return s=[],(c=l.t2())&&(s=l.s2(c,f)),s},t.prototype.A2=function(t){var e,o,n,r,i,s,u,c,f=[],h=this.S0,p=h&&h.length;if(t<0||t>=h.length)return f;if(o=(e=this.OC)&&a.sJc(e),n={},void 0!==t&&t!==l||(t=p),o&&(r=h[t],s=(i=o.tables)&&i.findByName(m.Ib(r.text,"[")),C(s)&&(s=e.getSheetTab(m.Ib(r.text,"["))),void 0!==s&&s!==l&&!n[s])){for(n[s]=!0,u=0,c="";c!==l;)c=s.getColumnName(u),u++,c!==l&&f.push({name:c,description:""});if(f.length>0)return f}return f},t.prototype.z2=function(){a.GC$(this.Z0).hide(),this.R1=!1},t.prototype._1=function(t){var e,o,n,r,i,s,l=a.GC$(this.Z0).find(".gcsj-func-ac-row"),u=l.length;if(0!==u){if(e="gcsj-ac-row-active",o=0,t)for(n=0;n<u;n++)if(a.GC$(l[n]).hasClass(e)){o=n+t;break}r=a.GC$(this.Z0).scrollTop(),l.removeClass(e),i=0,u>0&&(i=l[0].offsetHeight),o=c(o,0),s=l[o=f(o,u-1)],a.GC$(s).addClass(e),s.offsetTop+s.offsetHeight>a.GC$(this.Z0).scrollTop()+a.GC$(this.Z0).height()?a.GC$(this.Z0).scrollTop(a.GC$(this.Z0).scrollTop()+i):s.offsetTop<a.GC$(this.Z0).scrollTop()?a.GC$(this.Z0).scrollTop(s.offsetTop):a.GC$(this.Z0).scrollTop(r)}},t.prototype.a2=function(){var t,e,o,n,r,i,s,u,c,f,h,p,d,g,y,C=this,v=a.GC$(C.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),b=v.text(),w="true"===v.attr("isFunc");if(b){for(t=C.caret(),o=(e=C.S0)&&e.length,n=0,r=0,i=0,s=l;i<o&&!(n+(r=(s=e[i]).text.length)>=t);)i++,n+=r;u=t-n,c=s.text,f=0,h=0,m.Bb(c,"[")?-1===(f=c.lastIndexOf("[",u-1))?(f=c.indexOf("["),s.text=-1===f?b:b+c.substr(f),f=0):(f++,"@"===c.charAt(f)&&(f+=1),-1===(h=c.indexOf("]",u))&&(h=c.length),s.text=c.substring(0,f)+b+c.substr(h)):(s.text=b,(p=c.substr(u))&&((d=C.T0("="+p)).length>1&&e.splice(i+1,0,d[1]))),s.type=w?2:11,y=e[g=i+1],!w||y&&5===y.type||e.splice(g,0,{text:"(",type:5}),C.z2(),C.qo.focus(),C.z1(),C.caret(n+b.length+f+(w?1:0)),C.S1(),C.S0=C.T0(C.text()),C.Wq(I,{})}},t.prototype.S1=function(){var t,e,o,r,i,s,u,c,h,p,d,g,m=this;if(m.R1&&m.z2(),(t=m.u2())!==l&&!0===t.isFunc)if(e=m.w1(),m.h1&&m.bW(m.text())&&t&&!m.MH&&!m.T1&&!m.V4){for(i=(r=(o=t.func).parameters)&&r.length,s=f(i-1,t.activeParamterIndex),u=void 0,c="",h=0;h<i;h++)p=(u=r[h]).name,u.repeatable&&(p+=e+"..."),u.optional&&(p="["+p+"]"),d=h===i-1?"":e+" ",c+=p=h===s?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+p+"</span>"+d:"<span class='gcsj-func-help-paramter'>"+p+"</span>"+d;g="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+_(o.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+c+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>"+("<div class='gcsj-func-help-body'>"+("<div class='gcsj-func-help-section-content'>"+("<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+n.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(o.description||"")+"</div></div>")+"</div>")+"</div>"),a.GC$(m.$0).html(g).show(),m.W1=!0,m.SH()}else m.w2();else m.w2()},t.prototype.w2=function(){a.GC$(this.$0).hide(),this.W1=!1},t.prototype.close=function(){this.z2(),this.w2()},t.prototype.BH=function(t,e){var o,n,r,i,a,s;return!this.MH&&(o=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,n=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.metaKey,(s=t.srcElement||t.target)&&e&&e.isEditing&&"gcAttachedFormulaTextBox"===s.getAttribute("gcUIElement")?67===n&&(r||a)&&!i||88===n&&(r||a)&&!i:this.R1&&!o&&(n===M.down||n===M.up||n===M.tab))},t.prototype.SH=function(){var t,e,o,n,r,i,u,c,f,h,p,d,m,y,C=this,v=l;if(C.R1?v=C.Z0:C.W1&&(v=C.$0),v){if(t=a.GC$(C.qo),e=a.GC$(v),(o=s.G0.H0)&&o.kj)return n=o.kj.getCellRect(o.nT,o.Mk),r=o.f1,void e.css("top",n.y+n.height+r.top).css("left",n.x+r.left);i=t.parent(),u=t.outerHeight(),C.Dia(C.qo)&&(u=(i=i.parent()).outerHeight()),c=i.css("top"),f=parseFloat(c),isNaN(f)||(c=f),h=i.css("left"),"auto"===c&&(c=t.offset().top,h=t.offset().left),p=c+u,d=a.GC$(g.body).outerHeight(),p+(m=e.outerHeight())>d&&((y=c-m)>=0&&(p=y)),e.css("top",p).css("left",h)}},t.prototype.focus=function(){a.GC$(this.qo).focus()},t.prototype.V0=function(t){var e,o,n,r,i=this,a="",s="",l=t&&t.length,u=0;for(o=0;o<l;o++)n="",11===(e=t[o]).type&&(n=" style='color: "+i.o1(u)+"'",u++),i._0.innerText=e.text,a+="<span"+n+" class='gcsj-func-color-text'>"+i._0.innerHTML+"</span>",s+=e.text;if(s||i.text())if(r=i.qo,a)r.innerHTML="<span class='gcsj-func-color-content'>"+a+"</span>";else for(;r.firstChild;)r.removeChild(r.firstChild)},t.prototype.e1=function(t,e){var o,n,r,i=a.GC$(t).find(".gcsj-func-color-content .gcsj-func-color-text"),s=i.length;for(e=c(0,e),r=0;r<s;r++)if((e-=(n=(o=i[r]).innerText).length)<=0)return{node:o,offset:n.length+e};return n?{node:o,offset:n.length}:l},t.prototype.iIb=function(t,e){var o=d.getSelection(),n=this.qo.children[0],r=document.createRange();r.setStart(n,t),r.setEnd(n,e),o.removeAllRanges(),o.addRange(r)},t.prototype.Jka=function(t){var e=this,o=e.qo,n=e.Cia(o),r=e.text();n&&r&&(r=t?r.substr(0,r.length-2):r,e.Ac.push(r))},t.prototype.nLb=function(t,e){var o,n,r,i,a,s,l;if(e)for(o=0,n=0,r=0,i=e.length,a=0;a<t.length;a++){for(s=t[a].text;n<i;n++)if((l=e[n].toUpperCase())===(s[r]?s[r].toUpperCase():void 0))r+=1;else{if("\n"!==l)break;n+1<i&&"​"===e[n+1]&&(n+=1)}t[a].text=e.substring(o,n),o=n,r=0}return t},t.prototype.mLb=function(t){var e,o,n,r,i;if("="===t[0]&&-1!==t.indexOf("\n")){for(e=[],o=t.length,n=!1,r=0;r<o;r++)'"'===(i=t[r])&&(n=!n),n||"\n"!==i?e.push(i):r+1<o&&"​"===t[r+1]&&(r+=1);return e.join("")}},t}(),e.FormulaTextBox=G},"./dist/plugins/group/group-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function k(t){var e=t.kj;return t.ML?e.rowOutlines:e.columnOutlines}function N(t){var e,o,n,r,i,a=this,s=!1;return(t?a.canExecute():a.canUndo())&&(e=a.kj,o=a.VQ.index,n=a.VQ.count,r=k(a),e&&r&&!d(o)&&!d(n)&&(i=t?r.group:r.ungroupRange,a.Lz(e,!0),i.call(r,o,n),a.Mz(e,!0),s=!0)),s}function O(t,e,o,n,r){var i,a=0;for(i=e;i<=o&&i<n;i++)a+=r.call(t,i)*t.zoom();return a}function D(t,e,o,n,r){if(e<n)return n;if(e>r)return r;for(var i=e;i<=r;i++)if(o.call(t,i))return i;return-1}function F(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b=this.kj,w=o.index,T=e?b.getRowCount():b.getColumnCount(),S=void 0;w<0||w>=T||(r=1===(n=k(this)).direction(),i=b.am(),a=e?b.frozenRowCount():b.frozenColumnCount(),s=e?b.frozenTrailingRowCount():b.frozenTrailingColumnCount(),l=e?i.pKc:i.sKc,u=e?b.qKc:b.tKc,c=e?b.getRowHeight:b.getColumnWidth,f=e?b.getViewportTopRow:b.getViewportLeftColumn,h=e?b.getViewportHeight:b.getViewportWidth,p=f.call(b,1),(y=n.find(r?w-1:w+1,o.level))&&(C=r?y.start:w,v=r?w:y.end,r?(t?C=w:C<a&&(C=a),C<p&&(p=C),v>=T-s&&(v=T-s-1),d=h.call(b,1),d+=u?0:l,(g=O(b,p,v,T,c))>d&&(p=function(t,e,o,n,r){var i,a=0;for(i=e;i<n&&a<o;i++)e++,a+=r.call(t,i)*t.zoom();return e>=n?n-1:e}(b,p,g-d,T,c)),m=D(b,p,c,a,T-1)):(t?v=w:v>=T&&(v=T-1),v>=T-s&&(v=T-s-1),C<p?m=D(b,C,c,a,T-1):(d=h.call(b,1),d+=u?0:l,(g=O(b,p,v,T,c))>d&&(m=D(b,C,c,a,T-1)))),e&&m!==S?(b.lq=m,b.os()):e||m===S||(b.qq=m,b.qs())))}function E(t){var e,o,n,r,i,a,s=this,l=!1;return(t?s.canExecute():s.canUndo())&&(e=s.kj,o=s.VQ,n=k(s),r=o.collapsed,i=o.index,a=o.level,!e||!n||d(r)||d(i)||d(a)||(s.Lz(e,!0),t||(r=!r),(1===n.direction()?n.find(i-1,a):n.find(i+1,a))&&n.setCollapsed(i,r),F.call(s,r,s.ML,o),s.Mz(e,!0),l=!0)),l}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),e.Commands=r.Commands,i=r.Commands.ActionBase,r.GC$,a="outlineColumn",s="removeColumnOutline",l="expandColumnOutline",u="expandColumnOutlineForLevel",c="outlineRow",f="removeRowOutline",h="expandRowOutline",p="expandRowOutlineForLevel",d=n.Common.j.Fa,g=function(t){function e(e,o,n){var r=t.call(this,e,o)||this;return r.ML=n,r}return M(e,t),e.prototype.execute=function(){return N.call(this,!0)},e.prototype.undo=function(){return N.call(this,!1)},e}(i),m=function(t){function e(e,o){return t.call(this,e,o,!1)||this}return M(e,t),e}(g),y=function(t){function e(e,o){return t.call(this,e,o,!0)||this}return M(e,t),e}(g),C=function(t){function e(e,o,n){var r=t.call(this,e,o)||this;return r.ML=n,r}return M(e,t),e.prototype.execute=function(){var t,e,o,n,i=this,a=i.kj,s=a.ITa,l=!1;return i.canExecute()&&(e=(t=i.VQ).index,o=t.count,n=k(i),a&&n&&!d(e)&&!d(o)&&(s.startTransaction(),i.Lz(a,!0),n.ungroupRange(e,o),i.Mz(a,!0),t[r.Commands.bWa(a.name())]=s.endTransaction(),l=!0)),l},e.prototype.undo=function(){var t,e,o=this,n=!1,i=o.kj;return o.canUndo()&&(t=r.Commands.bWa(i.name()),e=o.VQ[t],i&&e&&(o.Lz(i,!0),i.ITa.undo(e),o.Mz(i,!0),n=!0)),n},e}(i),v=function(t){function e(e,o){return t.call(this,e,o,!1)||this}return M(e,t),e}(C),b=function(t){function e(e,o){return t.call(this,e,o,!0)||this}return M(e,t),e}(C),w=function(t){function e(e,o,n){var r=t.call(this,e,o)||this;return r.ML=n,r}return M(e,t),e.prototype.execute=function(){return E.call(this,!0)},e.prototype.undo=function(){return E.call(this,!1)},e}(i),T=function(t){function e(e,o){return t.call(this,e,o,!1)||this}return M(e,t),e}(w),S=function(t){function e(e,o){return t.call(this,e,o,!0)||this}return M(e,t),e}(w),x=function(t){function e(e,o,n){var r=t.call(this,e,o)||this;return r.ML=n,r}return M(e,t),e.prototype.execute=function(){var t,e,o,n,i=this,a=i.kj,s=!1;if(i.canExecute()&&(t=void 0,e=i.VQ.level,o=k(i),a&&o&&!d(e))){for(a.ITa.startTransaction(),i.Lz(a,!0),a.suspendCalcService(),t=0;t<e;t++)o.expand(t,!0);o.expand(e,!1),a.resumeCalcService(!0),i.Mz(a,!0),n=r.Commands.bWa(a.name()),i.VQ[n]=a.ITa.endTransaction(),s=!0}return s},e.prototype.undo=function(){var t,e,o,n=this,i=!1;return n.canUndo()&&(t=n.kj,e=r.Commands.bWa(t.name()),o=n.VQ[e],t&&o&&(n.Lz(t,!0),t.ITa.undo(o),i=!0,n.Mz(t,!0))),i},e}(i),A=function(t){function e(e,o){return t.call(this,e,o,!1)||this}return M(e,t),e}(x),I=function(t){function e(e,o){return t.call(this,e,o,!0)||this}return M(e,t),e}(x),R=r.Commands.h4,r.Commands[a]={canUndo:!0,execute:function(t,e,o){return R(t,m,e,o)}},r.Commands[c]={canUndo:!0,execute:function(t,e,o){return R(t,y,e,o)}},r.Commands[s]={canUndo:!0,execute:function(t,e,o){return R(t,v,e,o)}},r.Commands[f]={canUndo:!0,execute:function(t,e,o){return R(t,b,e,o)}},r.Commands[l]={canUndo:!0,execute:function(t,e,o){return R(t,T,e,o)}},r.Commands[h]={canUndo:!0,execute:function(t,e,o){return R(t,S,e,o)}},r.Commands[u]={canUndo:!0,execute:function(t,e,o){return R(t,A,e,o)}},r.Commands[p]={canUndo:!0,execute:function(t,e,o){return R(t,I,e,o)}},r.Commands.SL=function(t){t.register(a,r.Commands[a]),t.register(c,r.Commands[c]),t.register(s,r.Commands[s]),t.register(f,r.Commands[f]),t.register(l,r.Commands[l]),t.register(h,r.Commands[h]),t.register(u,r.Commands[u]),t.register(p,r.Commands[p])}},"./dist/plugins/group/group.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/group/group-actions.js")),n(o("./dist/plugins/group/group.js")),n(o("./dist/plugins/group/group.ns.js"))},"./dist/plugins/group/group.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q;function J(t,e){t.Wq(r.Events.RangeGroupStateChanging,e)}function X(t,e){t.Wq(r.Events.RangeGroupStateChanged,e)}function Z(t,e){var o,n=t.options;return!n.isProtected||(o=n.protectionOptions,e?o.allowOutlineRows:o.allowOutlineColumns)}function Y(t,o){var n,i,a,s=o.what===D,l=Z(t,s);t.isEditing&&t.isEditing()||!l?l||t.Os(r.InvalidOperationType.groupProtected,e.getSR().Exp_GROUP_PROTECTED):(i=s?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",J(t,a=Q(t,s,-1,n=o.info.index,!0)),a&&!1===a.cancel&&(t.wu().execute({cmd:i,sheetName:t.name(),level:n}),X(t,Q(t,s,-1,n,!1))))}function K(t,o){var n,i,a,s,l,u,c=o.what===E,f=Z(t,c);t.isEditing&&t.isEditing()||!f?f||t.Os(r.InvalidOperationType.groupProtected,e.getSR().Exp_GROUP_PROTECTED):nt(c,t)&&(a=i=(n=o.info).index,s=n.level,void 0,u=c?"expandRowOutline":"expandColumnOutline",1===n.lineDirection?i--:i++,J(t,l=Q(t,c,i,s,!0)),l&&!1===l.cancel&&(t.wu().execute({cmd:u,sheetName:t.name(),index:a,level:s,collapsed:n.isExpanded}),X(t,Q(t,c,i,s,!1))))}function Q(t,e,o,n,r){var i={sheet:t,sheetName:t.name(),isRowGroup:e,index:o,level:n};return r&&(i.cancel=!1),i}function $(t,e){var o,n,i,a,s=this,u=s.Gt(),c=u.width,f=u.height;return c||f?(o=s.am(),n=new r.Rect(u.x,u.y,c,o.height),i=new r.Rect(u.x,u.y,o.width,f),n.contains(t,e)||i.contains(t,e)?((a=tt(s,t,e,u.rowMaxLevel,!0))||(a=tt(s,t,e,u.colMaxLevel,!1)),a||{what:"empty",info:l}):l):l}function tt(t,e,o,n,r){var i,a,s=new G(t,r,n).WL(e,o,r);if(s)return{what:r?D:F,info:s};for(i=et(t,r,n),a=0;a<=2;a++)if(s=i[a].XL(e,o,r))return{what:r?E:j,info:s};return l}function et(t,e,o){var n,r=[new B(t,e,0,o),new B(t,e,1,o),new B(t,e,2,o)];for(n=0;n<=2;n++)r[n].YL();return r}function ot(t,e){var o=e?t.width:t.height;return c(0,(o-2*this.PADDING)/(this.ZL+2))}function nt(t,e){return t?e.rowOutlines:e.columnOutlines}function rt(t,e,o){var n,r,i,a;if(o>0){for(n=t.items,r=void 0,i=void 0,a=[],r=0;r<o;r++)a.push(l);if(t.items=n=n.slice(0,e).concat(a,n.slice(e)),t.V3<=0&&e>0&&(i=n[e-1]))for(r=0;r<o;r++)n[e+r]=new z(i);ct(t)}}function it(t,e,o){o>0&&(t.items.splice(e,o),ct(t))}function at(t,e,o){for(var n,r,i,a,s=l,u=t.items,c=e,f=b(u);c<f&&(!(n=u[c])||n.level<o||(s||(s=new H(t,c,c,o)),n.level>o&&(c=(r=at(t,c,o+1)).index,s.addChild(r.g)),c>s.end&&(s.end=c),!t.isGroupEnd(c,o)));c++);if(s)for(i=s.end+1,a=s.start;a<i;a++)u[a].groupInfo||(u[a].groupInfo=s);return{g:s,index:c}}function st(t,e){return e>=-1&&e<b(t.items)}function lt(t,e,o){var n,r,i=t&&t.items;if(i)for(n=i[e]&&i[e].groupInfo;n;){if((r=n.level)===o)return n;if(!(r>o))break;n=n.parent}return l}function ut(t,e){switch(t){case"head":case"tail":return e===l;case"direction":return 1===e;case"itemsData":return 0===b(e);default:return!1}}function ct(t){t.Zka=l,t.refresh()}function ft(t,e){!e&&t.Wka||(t.Zka=t.createRangeGroup(),pt(t))}function ht(t){t.Wka&&!t.Zka&&(t.Zka=t.createRangeGroup())}function pt(t,e){t.groupChangeHandler&&t.groupChangeHandler(e)}function dt(t,o,n){if(gt(t,o),!st(t,o+n-1))throw Error(e.getSR().Exp_InvalidCount)}function gt(t,o){if(!st(t,o))throw Error(e.getSR().Exp_InvalidIndex)}function mt(t,e){for(var o=t.parent;o&&(e?t.end===o.end:t.start===o.start);)t=o,o=o.parent;return t}function yt(t){return t&&new z(t)}function Ct(t){return{items:t.items.map(yt),head:yt(t.head),tail:yt(t.tail),wz:t.wz,direction:t.direction()}}function vt(t,e){t.items=e.items.map(yt),t.head=yt(e.head),t.tail=yt(e.tail),t.wz=e.wz,t.direction(e.direction),ft(t,!0)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("./dist/plugins/group/group-actions.js"),a=o("./dist/plugins/group/group.ns.js"),s={},l=null,u=void 0,c=Math.max,f=Math.min,h=Math.round,p=Math.ceil,d=r.GC$,g=d.each,m=r.Im.Lm,y=n.Common.k,C=y._b,v=y.$b,b=y.ac,w=r.Ul.Ol,T=n.Common.j.Fa,S=r.Ul.Pl,x=r.Ul.fp,A="rangegroup",M=(R=(I="gc-group")+"-box")+"-expand",k=R+"-collapsed",N=I+"-line",O=I+"-dot",D="rgh",F="cgh",E="rg",j="cg",P=new n.Common.ResourceManager(a.SR,"Outlines"),e.getSR=P.getResource.bind(P),L={Gt:function(){var t,e,o,n,r,i,a=this,s=a.TL;return s||(e={x:(t=a.options.sheetAreaOffset).left,y:t.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},o=a.rowOutlines,n=a.columnOutlines,r=17*a.zoom(),a.showRowOutline()&&o&&!o.iT()&&((i=o.getMaxLevel())>=0&&(e.width=r*(i+2)+4,e.rowMaxLevel=i)),a.showColumnOutline()&&n&&!n.iT()&&((i=n.getMaxLevel())>=0&&(e.height=r*(i+2)+4,e.colMaxLevel=i)),a.TL=e,e)},showRowOutline:S("showRowOutline",!0,(function(){this.$p()})),showColumnOutline:S("showColumnOutline",!0,(function(){this.$p()}))},d.extend(r.Worksheet.prototype,L),G=function(){function t(t,e,o){var n=this;n.PADDING=2,n.kj=t,n.ML=e,n.ZL=w(o)?o:nt(e,t).getMaxLevel()}return t.prototype._L=function(t){var e,o,n,r,i,a,s,l,u,f,p,d,g,y,C,v,b,w,T,S,A,M,k,N,O,D,F,E=this,j=E.kj,P=E.ZL;if(!(P<0)&&(e=E.ML,o=j.Gt(),n=ot.call(E,o,e))){if(r=P+2,i=E.PADDING,a=j.options,s=o.width,l=o.height,u=o.x,f=o.y,d=(p=j.am()).width,g=p.height,y=p.Cr,C=p.Br,v=p.zr,b=p.Ar,t.save(),t.fillStyle=m(I).backgroundColor,t.strokeStyle=m(I).borderTopColor,t.lineWidth=1,t.fillRect(u,f,e?s:d,e?g:l),t.strokeRect(u-.5,f-.5,e?s:d+1,e?g+1:l),e?t.strokeRect(u-.5,b-.5,s,y):t.strokeRect(v-.5,f-.5,C,l),w=(e?y:C)-n,S=c(0,(e?b-a.sheetAreaOffset.top:v-a.sheetAreaOffset.left)+w/2),A=i,e&&(k=S,S=A,A=k),t.restore(),T=e?a.colHeaderVisible:a.rowHeaderVisible,t.save(),T&&w>=0)for(M=0;M<r;M++)N=n-1,void 0,D=u+S,F=f+A,e?D=h(D)+.5:F+=.5,t.fillStyle=m(R).backgroundColor,t.fillRect(D,F,N,N),t.font=8.25*j.zoom()+"pt Arial",t.strokeStyle=m(R).borderTopColor,t.strokeRect(D,F,N,N),t.fillStyle=m(R).color,O=x(t.font),E.pM(t,D,F,N,n,M+1,O),e?S+=n:A+=n;t.restore()}},t.prototype.pM=function(t,e,o,n,r,i,a){var s=""+i,l=t.measureText(s).width;l<=n&&a<=r&&(t.textBaseline="middle",t.fillText(s,e+(n-l)/2,o+n/2))},t.prototype.WL=function(t,e,o){var n,r,i,a,s=this,u=s.kj,c=s.ZL;return c<0?l:(n=c+2,r=u.am(),a=(i=u.options).sheetAreaOffset,o?s.qM(u,t,e,o,i.colHeaderVisible,r.Cr,r.Ar-a.top,n):s.qM(u,t,e,o,i.rowHeaderVisible,r.Br,r.zr-a.left,n))},t.prototype.qM=function(t,e,o,n,i,a,s,u){var f,h,p,d,g=t.Gt(),m=ot.call(this,g,n),y=a-m;if(m&&i&&y>=0)for(f=c(0,s+y/2),h=this.PADDING,n&&(d=f,f=h,h=d),p=0;p<u;p++){if(new r.Rect(g.x+f,g.y+h,m,m).contains(e,o))return{index:p};n?f+=m:h+=m}return l},t}(),B=function(){function t(t,e,o,n){var r=this;r.PADDING=2,r.LINE_SIZE=2,r.START_LINE_SIZE=6,r.bM=[],r.cM=[],r.dM=[],r.kj=t,r.ML=e,r.eM=o,r.ZL=w(n)?n:nt(e,t).getMaxLevel()}return t.prototype.YL=function(){var t,e=this;-1!==e.ZL&&(t=e.fM(0,e.ML),g(t,(function(t,o){e.gM(o)})))},t.prototype.gM=function(t){var e,o,n,r,i,a,s,u,h,p,d,m,y,C,v,w,T,S,x=this,A=x.kj,I=x.ML,R=nt(I,A).direction(),M=1===R,k=0===R,N=x.hM(!0,I),O=x.hM(!1,I),D=t.start,F=t.end,E=t.level;if(M?e=F+1:k&&(e=D-1),0===t.state()){if(o=!0,(n=t.parent)&&(k&&D===n.start||M&&F===n.end)&&(o=!1),o&&x.iM(!0,E,e,N,O,R),D<=O&&F>=N){for(r=c(N,D),i=f(O,F),a=void 0,s=void 0,o&&(a={start:r,end:i,level:E,startLine:l},(M&&r===D||k&&i===F)&&(a.startLine=!0),x.bM.push(a)),h=[],p=t.children,s=r;s<=i;s++)h.push(!1);for(g(p,(function(t,e){var o=e.start,n=e.end;if(1===e.state())for(u=o;u<=n;u++)h[u-r]=!0;h[(M?n+1:n-1)-r]=!0,x.gM(e)})),d=!0,s=0;s<b(p);s++){if(y=(m=p[s]).start,w=(C=m.end)===F,(v=y===D)&&w){d=!1;break}if(M&&w||k&&v)for(u=y;u<=C;u++)h[u-r]=!0}if(d)for(T=r;T<=i;T++)h[T-r]||(S={index:T,level:E+1},x.cM.push(S))}}else 1===t.state()&&x.iM(!1,E,e,N,O,R)},t.prototype.iM=function(t,e,o,n,r,i){var a={isExpanded:t,level:e};t&&(a.paintLine=!0),o>=n&&o<=r&&(a.index=o,a.lineDirection=i,this.dM.push(a))},t.prototype.jM=function(t){var e=this,o=e.kj,n=e.eM;return e.ML?o.Gr(n).findRow(t):o.Hr(n).findCol(t)},t.prototype.aM=function(t){var e,o,n,r,i,a,s,l=this;-1!==l.ZL&&(e=l.kj.Gt(),o=l.ML,(n=ot.call(l,e,o))&&(r=parseInt(m(N).borderTopWidth,10),r=isNaN(r)?2:r,i=h(n/3),s=(n-r)/2+(a=l.PADDING),t.save(),t.fillStyle=m(I).color,l.kM(t,l.cM,o,e,n,s,r),o?l.D_a(t,l.bM,o,e,n,s,r,i):l.E_a(t,l.bM,o,e,n,s,r,i),l.mM(t,l.dM,o,e,n,s,r,a),t.beginPath(),t.restore()))},t.prototype.kM=function(t,e,o,n,r,i,a){var s,l,u,f=this,h=f.kj.options.sheetAreaOffset,p=h.left,d=h.top;t.save(),t.fillStyle=m(O).color,u=f.bM,g(e,(function(e,h){var g,m,y,C,v,b=h.index,w=h.level,T=f.jM(b);T&&(f.C0a(u,b,w)||(g=o?T.y:T.x,(m=(o?T.height:T.width)-a)>=0&&(s=g+c(0,m/2),l=h.level*r+i,o?(y=s,s=l+.5,l=y,l-=d):(l+=.5,s-=p),t.strokeStyle="transparent",t.lineWidth=0,(C=n.x+s)%1!=0&&(C+=.5),(v=n.y+l)%1!=0&&(v+=.5),t.strokeRect(C,v,2,2),t.fillRect(C,v,2,2))))})),t.restore()},t.prototype.C0a=function(t,e,o){var n,r=!1,i=b(t);for(n=0;n<i;n++)if(t[n].level===o&&t[n].start<=e&&t[n].end>=e){r=!0;break}return r},t.prototype.D_a=function(t,e,o,n,r,i,a,s){var l,u,f,h,d,g,y,C,v,w,T,S,x,A,I;for(t.save(),t.strokeStyle=m(N).borderTopColor,t.fillStyle=m(N).borderTopColor,t.lineWidth=a,f=nt(o,u=(l=this).kj).direction(),d=u.options.sheetAreaOffset.top,h=0;h<b(e);h++){y=(g=e[h]).start,C=g.end,v=void 0,w=void 0;do{v=l.jM(y),y++}while(!v&&y<=C);do{w=l.jM(C),C--}while(!w&&C>=y);(v||w)&&(v?w||(w=v):v=w,T=v.y,S=g.level*r+i,x=a,A=c(0,w.y+w.height-v.y),1===f?T+=1:T-=1,T-=d,t.beginPath(),I=n.x+S+x/2,I=p(I),t.moveTo(I,n.y+T),t.lineTo(I,n.y+T+A),t.stroke(),g.startLine&&r/2-2*a>0&&(0===f&&(T=T+A-a-d),T>=v.y-d&&T<w.y+w.height-d&&t.fillRect(p(n.x+S),n.y+T,s,a)))}t.restore()},t.prototype.E_a=function(t,e,o,n,r,i,a,s){var l,u,f,h,d,g,y,C,v,w,T,S,x,A;for(t.save(),t.strokeStyle=m(N).borderTopColor,t.fillStyle=m(N).borderTopColor,t.lineWidth=a,f=nt(o,u=(l=this).kj).direction(),d=u.options.sheetAreaOffset.left,h=0;h<b(e);h++){y=(g=e[h]).start,C=g.end,v=void 0,w=void 0;do{v=l.jM(y),y++}while(!v&&y<=C);do{w=l.jM(C),C--}while(!w&&C>=y);(v||w)&&(v?w||(w=v):v=w,T=v.x,S=g.level*r+i,x=c(0,w.x+w.width-v.x),1===f&&(T+=1),T-=d,A=n.y+S+a/2,A=p(A),t.beginPath(),t.moveTo(n.x+T,A),t.lineTo(n.x+T+x,A),t.stroke(),g.startLine&&r/2-2*a>0&&(0===f&&(T=T+x-a-d),T>=v.x-d&&T<w.x+w.width-d&&t.fillRect(n.x+T,p(n.y+S),a,s)))}t.restore()},t.prototype.r0a=function(t){var e=m(t).backgroundImage;return"none"===e&&(e=""),e&&(e=(e=(e=e.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()),e},t.prototype.mM=function(t,e,o,n,r,i,a,s){var l,u,h,d,g,y,C,v,w,T,S,x,A,I,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K=this,Q=K.kj,$=Q.options,tt=$.sheetAreaOffset.left,et=$.sheetAreaOffset.top,ot=m(R).borderTopColor,nt=m(R).backgroundColor,rt=m(R).color,it=m(N).borderTopColor,at=Q.vu(),st=K.r0a(M),lt=K.r0a(k);for(st&&!at.ko(st)&&at.fo(st),lt&&!at.ko(lt)&&at.fo(lt),u=lt&&at.lo(lt),h=st&&at.lo(st),d=m(M),g=m(k),y=h?d.backgroundColor:"",C=u?g.backgroundColor:"",v=h?d.borderTopColor:"",w=u?g.borderTopColor:"",l=0;l<b(e);l++)t.save(),I=e[l],(O=K.jM(I.index))?(D=o?O.height:O.width)<=0?t.restore():(F=c(0,(D-r)/2),void 0,void 0,P=(o?O.y-et:O.x-tt)+F,L=I.level*r+s,B=r,_=void 0,V=void 0,H=D-(G=f(r,D)),o?(z=P,P=L,L=z,U=G,G=B,B=U,_=.5,V=0):(_=0,V=.5),x=I.isExpanded?v:w,t.strokeStyle=x||ot,t.lineWidth=1,S=I.isExpanded?y:C,t.fillStyle=S||nt,t.fillRect(n.x+P,n.y+L,G,B),E=n.x+P+_,j=n.y+L+V,t.strokeRect(E,j,G,B),t.fillStyle=rt,T=I.isExpanded?st:lt,K.nM(t,I.isExpanded,T,E,j,G,B),t.restore(),I.paintLine&&H>0&&(t.save(),t.strokeStyle=it,P=o?O.y-et:O.x-tt,L=I.level*r+i,W=0===I.lineDirection,q=o?a:F,J=o?F:a,o?(X=P,P=L,L=X,W&&(L+=F+B,J=H-F)):W&&(P+=F+G,q=H-F),t.beginPath(),t.lineWidth=a,Z=p(n.x+P+a/2),Y=p(n.y+L+a/2),o?(t.moveTo(Z,n.y+L),t.lineTo(Z,n.y+L+J-1)):(A=0,u&&!I.isExpanded&&(A=1),t.moveTo(n.x+P,Y),t.lineTo(n.x+P+_+q+A,Y)),t.stroke(),t.restore())):t.restore()},t.prototype.nM=function(t,e,o,n,r,i,a){var s,l,u,c=this.kj.vu();if(o&&c.ko(o)){l=(s=c.lo(o)).width,u=s.height;try{t.drawImage(s,0,0,l,u,h(n),h(r),i-1,a-1)}catch(t){}}else this.u0a(t,e,n,r,i,a)},t.prototype.u0a=function(t,e,o,n,r,i){var a,s,l=h(r/4),u=h(r/2);e||(a=h(i/4),s=h(i/2),t.fillRect(o+r/2-1,n+a,2,i-s)),t.fillRect(o+l,n+i/2-1,u,2)},t.prototype.fM=function(t,e){var o,n,r,i=this.kj,a=[],s=-1,l=-1,u=nt(e,i),h=(e?i.Gr:i.Hr).call(i,this.eM),p=b(h);for(p&&(n=h[0],r=h[p-1],s=c(0,(e?n.row:n.col)-1),l=e?f(i.getRowCount(),r.row+2):f(i.getColumnCount(),r.col+2));s<l;)(o=u.find(s,t))?(s=o.end+1,a.push(o)):s++;return a},t.prototype.hM=function(t,e){var o=-1,n=this.kj,r=this.eM,i=n.frozenRowCount(),a=n.frozenColumnCount(),s=n.frozenTrailingRowCount(),l=n.frozenTrailingColumnCount(),u=n.getRowCount(),c=n.getColumnCount();return 0===r?o=t?0:(e?i:a)-1:1===r?o=t?e?i:a:(e?u-s:c-l)-1:2===r&&(o=t?e?u-s:c-l:(e?u:c)-1),o},t.prototype.oM=function(t){t&&this.kj.CH&&(t.x-=2,t.y-=2,t.width+=4,t.height+=4)},t.prototype.XL=function(t,e,o){var n,i,a,s,u,h,p,d,g,m,y,C,v,w,T,S,x=this,A=x.ZL,I=x.kj,R=I.options,M=R.sheetAreaOffset.left,k=R.sheetAreaOffset.top;if(A<0)return l;if(n=I.Gt(),!(i=ot.call(x,n,o)))return l;for(a=x.dM,h=0;h<b(a);h++)if(d=(p=a[h]).index,g=p.level*i+x.PADDING,(m=x.jM(d))&&(!((s=o?m.height:m.width)<=0)&&(y=f(i,s),C=i,v=(o?m.y-k:m.x-M)+c(0,(s-i)/2),w=g,o&&(T=y,y=C,C=T,S=v,v=w,w=S),u=new r.Rect(n.x+v+.5,n.y+w+.5,y,C),x.oM(u),u.contains(t,e))))return p;return l},t}(),function(t){t[t.backward=0]="backward",t[t.forward=1]="forward"}(_=e.OutlineDirection||(e.OutlineDirection={})),s.OutlineDirection=_,function(t){t[t.expanded=0]="expanded",t[t.collapsed=1]="collapsed"}(V=e.OutlineState||(e.OutlineState={})),s.OutlineState=V,H=function(){function t(t,e,o,n){var r=this;r.children=[],r.parent=l,r.model=t,r.start=e,r.end=o,r.level=n}return t.prototype.state=function(t){var e=this,o=e.model;return arguments.length?void(o&&o.expandGroup(e,0===t)):o?o.getState(e):0},t.prototype.contains=function(t){return this.start<=t&&t<=this.end},t.prototype.addChild=function(t){t&&(this.children.push(t),t.parent=this)},t}(),e.OutlineInfo=H,s.OutlineInfo=H,z=function(t){this.level=t?t.level:0,this.collapsed=!!t&&t.collapsed,this.viewCollapsed=!!t&&t.viewCollapsed},U=function(){function t(t,e,o){var n=this;n.head=l,n.tail=l,n.Zka=l,n.items=Array(t),n.V3=0,n.wz=!0,n.kj=e,n.ML=o}return t.prototype.no=function(){this.kj=l},t.prototype.group=function(t,e){var o,n,r=this;for(dt(r,t,e),r.kj.ITa.vUa(r.ML),o=0;o<e;o++)n=t+o,r.items[n]?r.items[n].level++:r.items[n]=new z;r.Wka&&r.Zka&&(r.Zka=l),ft(r),r.wz=!1},t.prototype.Lia=function(){this.Wka=!0,this.Zka=l},t.prototype.Mia=function(){this.Wka=!1,this.refresh()},t.prototype.ungroupRange=function(t,e){var o,n,r=this;for(dt(r,t,e),r.kj.ITa.vUa(r.ML),o=0;o<e;o++)(n=r.items[t+o])&&n.level>-1&&n.level--;ft(r)},t.prototype.ungroup=function(){var t=this,e=b(t.items);t.kj.ITa.vUa(t.ML),t.items=Array(e),ft(t),t.wz=!0},t.prototype.expand=function(t,o){var n,r,i,a,s,l;if(t<-1)throw Error(e.getSR().Exp_InvalidLevel);for(r=(n=this).items,n.kj.ITa.vUa(n.ML),ht(n),(a=n.kj.Cf()).suspend(),s=0,l=r.length;s<l;s++)r[s]&&((i=n.find(s,t))&&n.expandGroup(i,o));a.resume(!1)},t.prototype.expandGroup=function(t,o){if(!t)throw Error(e.getSR().Exp_GroupInfoIsNull);var n=this,r=n.direction(),i=-1;n.kj.ITa.vUa(n.ML),0===r?i=t.start-1:1===r&&(i=t.end+1),n.setCollapsed(i,!o,t.level),n.kj.$p()},t.prototype.Xr=function(t){return!(!this.wz&&st(this,t)&&this.isCollapsed(t))},t.prototype.isCollapsed=function(t){var e=this.items[t];return!!(e&&e.viewCollapsed&&e.level>-1)},t.prototype.find=function(t,e){var o,n=this;return ht(n),-1===e?o=n.Zka:(gt(n,t),o=lt(n,t,e)),o},t.prototype.getLevel=function(t){var e=this.items[t];return e?e.level:-1},t.prototype.getCollapsed=function(t){var e=this.items[t];return!!e&&!!e.collapsed},t.prototype.B4=function(t,e,o,n){var r,i;for(r=e;r<=o;r++)(i=t[r])||((i=t[r]=new z).level=-1),i.viewCollapsed=n},t.prototype.setCollapsed=function(t,e,o){var n,r,i,a,s,l,c=this,f=!1,h=c.items,p=[];if(c.kj.ITa.vUa(c.ML),ht(c),t<0?(n=c.head)||(n=c.head=new z):t<b(h)?(n=h[t])||((n=h[t]=new z).level=-1):(n=c.tail)||(n=c.tail=new z),r=1===c.direction(),(i=o!==u)||n.collapsed===e?i&&(n.level===o-1&&(n.collapsed=e),f=!0,c.E4(t,e,o)):(n.collapsed=e,f=!0,c.E4(t,e,o)),f&&(t+=r?-1:1,s=c.find(t,c.getLevel(t)))){for(l=s.start;l<=s.end;l++)p.push(l);a={indexes:p}}pt(c,a)},t.prototype.dPa=function(t,e){var o,n=this.items;n[t]?n[t].collapsed!==e&&(n[t].collapsed=e):((o=n[t]=new z).level=-1,o.collapsed=e)},t.prototype.E4=function(t,e,o){var n,r,i,a,s,l,c,f,h,p=this,d=p.items,g=1===p.direction(),m=o!==u,y=t+(g?-1:1),C=m?o:p.getLevel(y),v=lt(p,y,C);if(v&&((g?v.end+1:v.start-1)!==t&&(v=null)),T(v)&&(C=m?o:p.getLevel(t),v=lt(p,t,C)),v)if(n=void 0,r=v.parent,e)m||(n=g?v.end+1:v.start-1,p.dPa(n,!0),v=mt(v,g)),p.B4(d,v.start,v.end,!0);else{for(i=!1,a=void 0;r;){if(d[a=g?r.end+1:r.start-1]&&d[a].collapsed&&d[a].level>-1){i=!0;break}r=r.parent}if(!i)for(m||(n=g?v.end+1:v.start-1,p.dPa(n,!1),v=mt(v,g)),p.B4(d,v.start,v.end,!1),s=[v],l=0;l>=0;)if(c=s[l],l--,d[a=g?c.end+1:c.start-1]&&d[a].collapsed&&-1!==d[a].level)p.B4(d,c.start,c.end,!0);else for(f=c.children,h=0;f&&h<f.length;h++)s[++l]=f[h]}},t.prototype.getMaxLevel=function(){var t,e=-1,o=this.items;return g(o,(function(o,n){n&&((t=n.level)>e&&(e=t))})),e},t.prototype.cB=function(t,e,o,n){var r,i,a,s,l;if(!(o<=0||t===e)){for((r=this).kj.ITa.vUa(r.ML),t<0&&(t=0),e<0&&(e=0),i=[],a=r.items,s=C(a,t-1);s>=0&&s<t+o;)l=new z(a[s]),i.push({index:s-t,value:l}),s=C(a,s);n&&v(a,t,o),v(a,e,o),g(i,(function(t,o){a[e+o.index]=o.value})),ct(r)}},t.prototype.bB=function(t,e,o,n,r){var i,a,s=this;if(s.kj.ITa.vUa(s.ML),e<0&&(e=0),o<0&&(o=0),i=[],t)for(a=C(t.items,e-1);a>=0&&a<e+n;)i[a-e]=new z(t.items[a]),a=C(t.items,a);v(s.items,o,n),i.length>0&&i.forEach((function(t,e){s.items[o+e]=t})),r&&v(t.items,e,n)},t.prototype.refresh=function(){this.wz||ft(this)},t.prototype.VL=function(t){var e=this,o=e.items,n=t-b(o);n<0?o.splice(t,-n):e.items=o.concat(Array(n)),ct(e)},t.prototype.getState=function(t){var e,o=this,n=o.items,r=o.direction(),i=-1;return 0===r?i=t.start-1:1===r&&(i=t.end+1),(e=i<0?o.head:i<b(n)?n[i]:o.tail)&&e.collapsed?1:0},t.prototype.Ez=function(t,e){var o=this,n=o.items;t<0?(o.head||(o.head=new z),o.head.level=e):t<b(n)?(n[t]||(n[t]=new z),n[t].level=e):(o.tail||(o.tail=new z),o.tail.level=e),ct(o)},t.prototype.suspendAdding=function(){this.V3++},t.prototype.resumeAdding=function(){this.V3--},t.prototype.createRangeGroup=function(){for(var t,e,o=this,n=o.items,r=b(o.items),i=new H(o,0,r-1,-1),a=0;a<r;)n[a]&&(n[a].groupInfo=l),a++;for(a=0;a<r;)n[a]?(e=(t=at(o,a,0)).g,a=t.index+1,e&&e.level>-1&&i.addChild(e)):a++;return i},t.prototype.qec=function(t,e){return 1===this.direction()?e===t.end+1:e===t.start-1},t.prototype.rec=function(t,e,o,n){var r=this,i=-1,a=0;if(1===r.direction()&&(i=0,a=1),t===e)return r.qec(t,o)||r.qec(t,n)?{start:t.start,end:t.end,level:t.level}:{start:o,end:n,level:t.level};for(;t.level>e.level;){if(e===t.parent)return r.qec(e,n)?{start:e.start,end:e.end,level:e.level}:{start:t.start+i,end:n,level:t.level-1};t=t.parent}for(;t.level<e.level;){if(t===e.parent)return r.qec(t,o)?{start:t.start,end:t.end,level:t.level}:{start:o,end:e.end+a,level:e.level-1};e=e.parent}for(;t.level>=0;){if(t.parent===e.parent)return{start:t.start+i,end:e.end+a,level:e.level-1};t=t.parent,e=e.parent}return{start:t.start+i,end:e.end+a,level:e.level-1}},t.prototype.sec=function(t){var e,o=this.items,n=o[t];return e=1===this.direction()?o[t-1]:o[t+1],(n?n.level:-1)<(e?e.level:-1)?e&&e.groupInfo:n&&n.groupInfo},t.prototype.kec=function(t,e){var o,n,r=this,i=r.sec(t),a=r.sec(t+e-1);if(T(i)&&T(a))return{start:t,end:t+e-1,count:e,level:-1};if(!i||!a){for(o=i||a;o&&-1!==o.level;)o=o.parent;i||(i=o),a||(a=o)}return(n=r.rec(i,a,t,t+e-1)).count=n.end-n.start+1,n},t.prototype.pec=function(t,e){var o,n,r,i,a=this.items;for(o=t;o<t+e;o++)if(n=a[o]&&a[o].groupInfo&&a[o].groupInfo.level,!T(n)&&n>=0)return!0;return i=a[r=1===this.direction()?t-1:t+e]&&a[r].groupInfo&&a[r].groupInfo.level,!T(i)&&i>=0},t.prototype.tec=function(t){var e=this.items,o=e[t]&&e[t].groupInfo&&e[t].groupInfo.level;return T(o)?-1:o},t.prototype.uec=function(t,e,o){var n,r=[],i=[];for(n=t;n<t+e;n++)this.tec(n)===o&&i.push(n),this.tec(n+1)<o&&i.length>0&&(r.push(i),i=[]);return i.length>0&&r.push(i),r},t.prototype.lec=function(t,e){var o,n,r,i,a=this;if(1===e)return a.uec(t.start,t.count,t.level);for(o=[],n=a.getMaxLevel(),r=2===e?t.level+1:t.level,i=n;i>=r&&i>=-1;i--)o=o.concat(a.uec(t.start,t.count,i));return o},t.prototype.nec=function(t,e,o){var n,r,i,a=this;for(n=t.length-1;n>=0;n--)(r=t[n]).collapse&&a.setCollapsed(r.head,!1),a.ungroupRange(r.start,r.count);for(n=t.length-1;n>=0;n--)r=t[n],i=y.Cb(e,r.head)+o,1===a.direction()?a.group(i-r.count,r.count):a.group(i+1,r.count),r.collapse&&a.setCollapsed(i,r.collapse)},t.prototype.mec=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=this,d=p.items;if(1===o)for(n=p.getMaxLevel(),r=e.level+1;r<=n;r++)t.splice.apply(t,[0,0].concat(p.uec(e.start,e.count,r)));else 2===o&&t.push.apply(t,p.uec(e.start,e.count,e.level));for(a=t[(i=t.length)-1].concat([]),s=[],r=i-2;r>=0;r--)u=(l=d[t[r][0]]).groupInfo,1===p.direction()?(c=u.end+1,f=y.Cb(a,c),a.splice.apply(a,[f,0].concat(t[r])),s.push({head:c,start:u.start,count:c-u.start,collapse:l.viewCollapsed})):(c=u.start-1,f=y.Cb(a,c),a.splice.apply(a,[f+1,0].concat(t[r])),s.push({head:c,start:u.start,count:u.end-c,collapse:l.viewCollapsed}));for(h=!1,r=0;r<e.count;r++)if(a[r]!==r+e.start){h=!0;break}return{array:a,isChanged:h,groupSwap:s}},t.prototype.isGroupEnd=function(t,e){var o,n,r,i,a,s=this.items,l=t+1;return!st(this,l)||!(o=s[l])||(i=!1,(n=o.level)<(r=s[t].level)&&((a=r-e)>=0&&a<r-n&&(i=!0)),i)},t.prototype.hitTest=function(t,e,o){return $.call(t,e,o)},t.prototype.jp=function(t,e,o,n){var r,i,a,s,l,u,c=t.Gt(),f=t.am(),h=t.ss,p=c.width,d=c.height;if(p||d){if(r=n?p:f.width,i=n?f.height:d,a=n?c.rowMaxLevel:c.colMaxLevel,s=n?h.bn:h.dn,e.save(),e.beginPath(),!o||o.intersect(c.x,c.y,r,i))for(l=void 0,u=void 0,new G(t,n,a)._L(e),l=s.call(t.ss,(function(){return et(t,n,a)})),u=0;u<=2;u++)l[u].aM(e);e.beginPath(),e.restore()}},t.prototype.UL=function(t,e){if(e){var o=e.what;o===D||o===F?Y(t,e):o!==E&&o!==j||K(t,e)}},t.prototype.iT=function(){return this.wz},t.prototype.s0a=function(){var t=parseInt(m(N).borderTopWidth,10);return isNaN(t)?2:t},t.prototype.fromJSON=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p,d=e&&e.ignoreStyle;if(t&&!d){if(n=(o=this).items,r=t.items,i=t.itemsData,a=t.direction,s=t.head,l=t.tail,h=[],T(a)||o.direction(a),s&&(o.head=s),l&&(o.tail=l),r&&r.length>0)for(p=0;p<r.length;p++)T(r[p])||(n[p]=new z(r[p]),o.wz=!1);else g(i,(function(t,e){if(u=e.index,c=e.info,u>=0&&c){for(f=0;f<e.count&&!(u+f>=b(n));f++)e.info.collapsed&&h.push(e),n[u+f]=new z(c);o.wz=!1}}));for(ft(o,!0),p=0;p<h.length;p++)o.E4(h[p].index,!0)}},t.prototype.toJSON=function(t){var e,o,n,r,i,a,s,l,c,f;if(!(t&&t.ignoreStyle)){for(o=[],n=(e=this).items,i=-1,a=[],r=0;r<b(n);r++)s=o[i],(l=n[r])&&(a[r]={level:l.level,collapsed:l.collapsed,viewCollapsed:l.viewCollapsed},i>=0&&r===s.count+s.index&&l.level===s.info.level&&l.collapsed===s.info.collapsed?o[i].count++:o[++i]={index:r,count:1,info:{level:l.level,collapsed:l.collapsed}});return c={items:a,itemsData:o,direction:e.direction(),head:e.head,tail:e.tail},f={},g(c,(function(t,e){ut(t,e)||(f[t]=e)})),d.isEmptyObject(f)?u:f}},t}(),e.Outline=U,U.prototype.direction=S("direction",1),s.Outline=U,d.extend(r.lUa.prototype,{vUa:function(t){var e=this,o=e.zTa;o&&(o.wUa||(o.wUa=[]),t&&!o.wUa[0]?o.wUa[0]=Ct(e.xUa):t||o.wUa[1]||(o.wUa[1]=Ct(e.yUa)))},zUa:function(t,e){var o;void 0!==e&&(this.kj.outlineColumn.YQa=e),t&&((o=t[0])&&vt(this.xUa,o),(o=t[1])&&vt(this.yUa,o))}}),r.lUa.$n(A,{init:function(){var t=this,e=t.kj;t.yUa=new U(t.getColumnCount(),e,!1),t.xUa=new U(t.getRowCount(),e,!0)},undo:function(t){var e=t.wUa;(e||t.WIc)&&(this.zUa(e,t.WIc),this.kj.$p())},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&(e.yUa&&(e.yUa.no(),e.yUa=l),e.xUa&&(e.xUa.no(),e.xUa=l))}}),W={init:function(){var t=this;t.rowOutlines=t.ITa.xUa,t.columnOutlines=t.ITa.yUa,t.rowOutlines.groupChangeHandler=function(e){var o,n,i,a,s,l=e&&e.indexes;l&&t.recalcRows&&((o=t.getCalcService())&&!o.IsSuspended()&&t.recalcRows(l)),(n=t.parent)&&t!==n.getActiveSheet()||t.au(),l?(i=l[0],a=l[l.length-1],s=!0):(i=0,a=t.getRowCount()-1,s=!1),r.Worksheet.ao(t,"onGroupChanged",{start:i,end:a,isRow:!0,fromSetCollapsed:s})},t.columnOutlines.groupChangeHandler=function(e){var o,n,i,a,s=t.parent;s&&t!==s.getActiveSheet()||t.bu(),(o=e&&e.indexes)?(n=o[0],i=o[o.length-1],a=!0):(n=0,i=t.getColumnCount()-1,a=!1),r.Worksheet.ao(t,"onGroupChanged",{start:n,end:i,isRow:!1,fromSetCollapsed:a})},t.Wr.push(t.rowOutlines),t.Zr.push(t.columnOutlines)},dispose:function(t){var e=this;!1!==t.clearCache&&(e.rowOutlines&&(e.rowOutlines.groupChangeHandler=l),e.columnOutlines&&(e.columnOutlines.groupChangeHandler=l)),d(e.Ws()).unbind("mousedown.group")},setHost:function(t){if(t){var e=this;t.bind("mousedown.group",(function(t){var o,n=e.Vs(),r=$.call(e,t.pageX-n.left,t.pageY-n.top);r&&((o=r.what)===E||o===D?e.rowOutlines.UL(e,r):o!==j&&o!==F||e.columnOutlines.UL(e,r))}))}},onPaintSuspend:function(t){var e=this;t.suspend?(e.rowOutlines.Lia(),e.columnOutlines.Lia()):(e.rowOutlines.Mia(),e.columnOutlines.Mia())},beforeLayoutChanged:function(t){"invalidateLayout"===t.changeType&&(this.TL=l)},onLayoutChanged:function(t){var e=this,o=t.changeType,n=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=t.sheetArea,u=e.rowOutlines,c=e.columnOutlines,f=this.ITa;"addRows"===o?(f.vUa(!0),rt(u,n,r)):"deleteRows"===o?(f.vUa(!0),it(u,n,r)):"addColumns"===o?(f.vUa(!1),rt(c,i,a)):"deleteColumns"===o?(f.vUa(!1),it(c,i,a)):"invalidateLayout"===o?e.TL=l:"setColumnCount"===o?(f.vUa(!1),3!==s&&1!==s||c.VL(a)):"setRowCount"!==o||3!==s&&2!==s||(f.vUa(!0),u.VL(r))},paint:function(t){var e=t.ctx,o=t.clipRect,n=this,r=n.rowOutlines,i=n.columnOutlines;r&&r.jp(n,e,o,!0),i&&i.jp(n,e,o,!1)},fromJson:function(t,e,o){if(t){var n=this,r=void 0,i=t.showRowRangeGroup,a=t.showColumnRangeGroup,s=w(i)?i:t.showRowOutline,l=w(a)?a:t.showColumnOutline;T(s)||n.showRowOutline(s),T(l)||n.showColumnOutline(l),(r=t.rowRangeGroup||t.rowOutlines)&&n.rowOutlines.fromJSON(r,o),(r=t.colRangeGroup||t.columnOutlines)&&n.columnOutlines.fromJSON(r,o)}},toJson:function(t,e){var o,n=this,r=n.rowOutlines,i=n.columnOutlines,a=n.showRowOutline();!0!==a&&(t.showRowOutline=a),!0!==(o=n.showColumnOutline())&&(t.showColumnOutline=o),t.rowOutlines=r?r.toJSON(e):u,t.columnOutlines=i?i.toJSON(e):u}},r.Worksheet.$n(A,W),q={init:function(){i.Commands.SL(this.commandManager())},onCultureChanged:function(){e.getSR()}},r.Workbook.$n(A,q)},"./dist/plugins/group/group.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/group/group.res.en.js");e.SR={en:n}},"./dist/plugins/group/group.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidIndex="Invalid index",e.Exp_InvalidCount="Invalid count",e.Exp_InvalidLevel="Invalid level",e.Exp_GroupInfoIsNull="groupInfo is null",e.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/hyperlink/hyperlink.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function Y(t,e,o,n){return h(n)&&(n=3),!h(t.getHyperlink(e,o,n))}function K(){var t=s(F);return u(t).css(w,T).css(S,0).css(I,2).css(R,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(M,N).css(k,D).css(x,"9pt Arial"),t}function Q(t){var e=(t&&t.zo()).getElementsByClassName(E)[0];h(e)||u(e).hide()}function $(t,e){h(e)||(e.drawUnderline&&(h(t.textDecoration)?t.textDecoration=1:0!==t.textDecoration&&1!=(1&t.textDecoration)&&(t.textDecoration+=1)),e.isVisited?e.visitedLinkColor===m?t.foreColor="rgba(0,0,0,0)":e.visitedLinkColor===g?t.foreColor=P:t.foreColor=e.visitedLinkColor:h(e.linkColor)?e.linkColor===g&&t.foreColor||(t.foreColor=j):t.foreColor=e.linkColor)}function tt(t){if(t&&t.cellType){var e=t.cellType.typeName;if(!X[e])return!0}return!1}function et(t){var e={context:t,value:0};return f.ao(t.sheet,"getOutlineColumnOffset",e),e.value}function ot(t,e){var o=a(e);return{x:0,y:0,width:y(0,n.Vn.Xn(t,e,!0)),height:t.split(/\r\n|\r|\n/).length*o}}function nt(t,e,o,n,r,i,a){var s=ot(t,n),l=function(t,e,o,n,r,i,a){var s=0,l=0,u=t.width,c=t.height,f=et(a);return f&&(u-=f),s=i=i||0,1===n?s=(u-e)/2:2===n&&(s=u-e-i),1===r?l=(c-o)/2:2===r&&(l=c-o),f&&(s+=f),{x:s,y:l}}(r,s.width,s.height,e,o,i,a);return s.x=l.x,s.y=l.y,s}function rt(t,e,o,r,i,a){var s,u,c,f,p,d,g,m,y,v,b,w,T,S=i.sheet,x=S.yl;if(h(o))return!1;if(o.textOrientation)return!0;if(s=S.getValue(i.row,i.col,i.sheetArea),a||(a=S.getText(i.row,i.col,i.sheetArea)),!a)return!1;for(a=a.replace(/\s+/g," "),u=o&&o.font?o.font:x.Bl(),u=x.Cl(u),c=[a],f=function(t){return 8*(t.textIndent||0)}(o),o.wordWrap&&(a=(c=n.Vn.Wn(a,r.width-3-f,u)).join("\r\n")),p=o.hAlign,d=o.vAlign,3===p&&(p=l(p,s,o.formatter)),g=nt(a,p,d,u,r,f,i),m=r.y+g.y,y=0;y<c.length;y++)if(v=nt(c[y],p,d,u,r,f,i),b=r.x+v.x,w=C(b+v.width,r.x+r.width),m=C((T=m)+v.height,r.y+r.height),b<=t&&t<w&&T<=e&&e<m)return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("SheetsCalc"),a=n.Ul.fp,s=n.Ul.Nl,l=n.Ul.ol,u=n.GC$,c=n.Commands.ActionBase,f=n.CellTypes.Base,h=r.Common.j.Fa,p=r.Common.j.C4,d=r.Common.u.BIc,r.Common.pc,g=void 0,m=null,y=Math.max,C=Math.min,Math.floor,v=window.open,b=r.Common.u.kb,w="position",T="absolute",S="margin",x="font",A="left",I="padding",R="border",M="box-sizing",k="background-color",N="content-box",O="default",D="white",F="div",E="gc-spread-hyperlink-tooltip",j="hyperlink",P="followedHyperlink",L="hyperlink",G="openUrl",B="generateHyperlink",_=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,V=/^(mailto:\/\/)?([A-Za-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([A-Za-z0-9\-])+\.([A-Za-z0-9\-]){2,63}(\?subject=.+)?$/gi,H=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(e.HyperlinkTargetType||(e.HyperlinkTargetType={})),n.GC$.extend(n.lUa.prototype,{getHyperlink:function(t,e,o){var n;return h(o)&&(o=3),this,(n=this.XTa(o).RTa(t,e))&&!h(n.hyperlink)?n.hyperlink:m},setHyperlink:function(t,e,o,n){var r,i,a,s,l,u,c=this;if(h(n)&&(n=3),(r=o&&o.url)&&r.match(H)&&r.match(H).length>0?("www.",b(r,"www.")&&(o.url="http://"+r)):r&&r.match(V)&&r.match(V).length>0&&(b(r,i="mailto:")||(o.url=i+r)),a=c.WTa>0?[["sheetModels",n],g]:g,s=c.XTa(n).RTa(t,e,!0,a?a[0]:g),h(s))a&&(a.length=0);else{if(l=s.hyperlink,h(o))s.hyperlink=null,delete s.hyperlink;else for(u in s.hyperlink={url:"",linkColor:g,visitedLinkColor:g,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)o[u]!==g&&(s.hyperlink[u]=o[u]);a&&(a[0].push("hyperlink"),a[1]=l)}a&&a.length>0&&c.zTa.push(a)}}),n.GC$.extend(n.Worksheet.prototype,{getHyperlink:function(t,e,o){var n;return 0===o?m:(h(o)&&(o=3),this,n=this.ITa,p(n.getHyperlink(t,e,o)))},setHyperlink:function(t,e,o,n){var r,i,a;0!==n&&(h(n)&&(n=3),this,i=(r=this.ITa).getRowCount(n),a=r.getColumnCount(n),t<0||t>=i||e<0||e>=a||(r.do("setHyperlink",t,e,o,n),this.$p()))}}),z=function(t){function e(e,o){return t.call(this,e,o)||this}return Z(e,t),e.prototype.execute=function(){var t,e,o,a,s,l,u,c,f,p,g,m,y=this,C=y.kj,w=y.VQ.url;if(h(w))return false;if(t=y.VQ.target||0,e="sjs://",0===w.indexOf(e)||"#"===w[0]){if(6,o="#"===w[0]?w.substr(1):w.substr(6),(a=i.formulaToRanges(C,o,0,0,!0))&&a.length>0){if(s=a[0].sheetName,l=a[0].ranges[0],s!==C.name()){if(f={oldSheet:c=C,newSheet:(u=C.parent).getSheetFromName(s),cancel:!1},u.Wq(n.Events.ActiveSheetChanging,f),f.cancel)return;u.setActiveSheet(s),p=u.getActiveSheetIndex(),u.YJc.RIc(p),c!==(C=u.getActiveSheet())&&u.Wq(n.Events.ActiveSheetChanged,{oldSheet:c,newSheet:C})}C.Yq(l.row+l.rowCount,l.col+l.colCount),C.setSelection(l.row,l.col,l.rowCount,l.colCount)}}else h(w)||(g="mailto:",w.match(H)&&w.match(H).length>0?("www.",b(w,"www.")&&(w="http://"+w)):w.match(V)&&w.match(V).length>0&&(b(w,g)||(w=g+w)),b(w,g)&&r.Common.u.Jb(w,"?")>1&&(m=w.split("?"),w=m[0]+"?"+m.slice(1).join("%3F")),v(d(w),["_blank","_self","_parent","_top"][t]));return false},e}(c),n.Commands[G]={canUndo:!1,execute:function(t,e,o){return n.Commands.h4(t,z,e,o)}},U=function(t){function e(e,o){return t.call(this,e,o)||this}return Z(e,t),e.prototype.execute=function(){var t,e,o,r=this,i=r.kj,a=r.VQ,s=a.url,l=a.row,u=a.col,c=a.sheetArea;if(null===s)t=null;else{if("string"!=typeof s)return!1;if((!(e=s.match(H))||e.length<1)&&((!(e=s.match(V))||e.length<1)&&(e=s.match(_))),!(e&&e.length>0&&0===s.indexOf(e[0])&&s.length===e[0].length))return!1;t={url:s,linkColor:j,visitedLinkColor:P}}return i.ITa.startTransaction(),i.suspendPaint(),i.suspendEvent(),i.setHyperlink(l,u,t,c),i.resumeEvent(),i.resumePaint(),o=n.Commands.bWa(i.name()),r.VQ[o]=i.ITa.endTransaction(),!0},e.prototype.undo=function(){var t,e=this.kj;return e.suspendPaint(),e.suspendEvent(),t=n.Commands.bWa(e.name()),e.ITa.undo(this.VQ[t]),e.resumeEvent(),e.resumePaint(),!0},e}(c),n.Commands[B]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,U,e,o)}},W={init:function(){this.commandManager().register(G,n.Commands[G]),this.commandManager().register(B,n.Commands[B])}},n.Workbook.$n(L,W),q={setHyperlinkWhenEditing:function(t){var e=t.url,o=t.row,n=t.col,r=t.sheetArea,i=this.getParent();i.options.allowAutoCreateHyperlink&&i.commandManager().execute({cmd:B,sheetName:this.name(),url:e,row:o,col:n,sheetArea:r})}},n.Worksheet.$n(L,q),J={applyHyperlinkStyle:function(t){var e=t.style,o=t.sheet.getHyperlink(t.row,t.col,t.sheetArea);!tt(e)&&$(e,o)},getCellTextHitInfo:function(t){var e,o,n,r,i,a,s=t.context.sheetArea,l=t.cellStyle,u=t.context,c=u.sheet,f=u.row,p=u.col;Y(c,f,p,s)&&!tt(l)&&((e=t.cellRect)&&(o=c.Er(f),n=c.Fr(p),r=c.am(),i=void 0,h(s)||3===s?i=r.Ft(o,n):2===s?i=r.fm(o):1===s&&(i=r.gm(n)),i&&(e=e.getIntersectRect(i))),h(s)&&3!==s||!l||!e||(a=c.getText(f,p,s),t.paddingHitInfo={row:f,col:p,x:t.x,y:t.y,sheetArea:s,sheet:c,isFocusAware:!0,isReservedLocation:rt(t.x,t.y,l,e,u,a)}))},processMouseUpOnCellPadding:function(t){var e,o,r,i,a,s=t.sheet,l=t.cellStyle,u=t.row,c=t.col,f=t.sheetArea;s&&!s.isEditing()&&Y(s,u,c,f)&&!tt(l)&&t.isReservedLocation&&(e=s.Ws(),Q(s),e&&(e.style.cursor=O),(o=s.ITa.getHyperlink(u,c,f)).isVisited=!0,r=o.command,h(r)||""===r||r===G?s.getParent().commandManager().execute({cmd:G,sheetName:s.name(),url:o.url,target:o.target}):"string"==typeof r?s.getParent().commandManager().execute({cmd:r,row:u,col:c,sheetName:s.name(),sheetArea:f}):"function"==typeof r&&r.call(m,s,u,c,f),i=s.getColumnCount(),a=new n.Range(u,-1,1,i),s.repaint(s.getRangeRect(1,1,a)))},processMouseMoveOnCellPadding:function(t){var e,o,n=t.row,r=t.col,i=t.sheet,a=t.cellStyle,s=t.sheetArea;Y(i,n,r,s)&&!tt(a)&&(!i||i.isEditing()&&i.getActiveRowIndex()===n&&i.getActiveColumnIndex()===r||(e=i.Ws(),o=i.getHyperlink(n,r,s),t.isReservedLocation?e&&(function(t,e,o){var n,r,i,a,s,l,c;o&&(n=t&&t.zo(),r=n.getElementsByClassName(E)[0],i=!1,h(r)&&(r=K(),r.className=E,n.insertBefore(r,m),i=!0),a=u(r),!i&&a.isVisible()||(a.text(o),s=t.mm.bG(),l=s.left+e.x,c=s.top+e.y+20,a.css("top",c).css(A,l),a.show()))}(i,t,o.tooltip),e.style.cursor="pointer"):(Q(i),e&&(e.style.cursor=O))))},processMouseLeaveOnCellPadding:function(t){var e,o=t.sheet,n=t.row,r=t.col,i=t.sheetArea;Q(o),Y(o,n,r,i)&&o&&((e=o.Ws())&&(e.style.cursor=O))},onUpdateContainer:function(t){var e=t.cellStyle,o=t.context.row,n=t.context.col,r=t.context.sheet.getHyperlink(o,n);!tt(e)&&$(e,r)}},f.$n(L,J),X={0:!0,1:!0,2:!0,3:!0,4:!0}},"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function y(t,e,o,n){return C(t,e,o,n)}function C(t,e,o,n){var r,i,s,l,u,c,f,h,p,d=a(n)?t.getActiveColumnIndex():n;if(!t.outlineColumn.XQa(d))return null;if(r=e?1:-1,i=t.getActiveRowIndex(),s=t.getSelections()[0].rowCount,u=!0,a(o))for(o={},u=!1,l=i;l<s+i;l++)0!==l&&(c=t.rowOutlines.getLevel(l),e&&(c>t.rowOutlines.getLevel(l-1)&&!o[l-1])||(f=c+r,h=t.outlineColumn.options(),(p=a(h.maxLevel)?t.outlineColumn.Oia().maxLevel:h.maxLevel)&&f+1>p||f+1<0||(o[l]={row:l,original:c+1,current:f+1},u=!0)));return u?o:null}function v(t,e,o,n){var r,i,s,l=C(t,e,o,n);if(!l)return null;for(i in r=a(n)?t.getActiveColumnIndex():n,t.outlineColumn.Lia(),t.suspendPaint(),l)Object.prototype.hasOwnProperty.call(l,i)&&(s=l[i],t.getCell(s.row,r).textIndent(s.current));t.resumePaint(),t.outlineColumn.Mia()}function b(t,e,o,n){var r,i,a,s,l,u=0,c=0,f=t.rowOutlines.getLevel(e);if(t.outlineColumn.Kia.updateCheckStatus(e,n),null!==(i=e<=t.getRowCount()-2?t.rowOutlines.find(e+1,f+1):null)&&null!==n)for(a=i.start;a<i.end+1;a++)t.outlineColumn.Kia.updateCheckStatus(a,n);for(i=t.rowOutlines.find(e,f);null!==i&&null!==i.parent;){if(i.start>0){for(u=i.start-1,c=t.rowOutlines.getLevel(u),t.outlineColumn.Kia.updateCheckStatus(u,n),a=(r=t.rowOutlines.find(u+1,c+1)).start;a<r.end+1;a++)if((s=t.outlineColumn.Kia.QR[a].checkBox.checkStatus)!==n){l="number"==typeof s&&"number"==typeof n&&3,t.outlineColumn.Kia.updateCheckStatus(u,l);break}a===r.end+1&&!0===n&&t.outlineColumn.Kia.updateCheckStatus(u,!0)}i=i.parent}}function w(t){var e=t.kj,o=r.Commands.bWa(e.name()),n=t.VQ[o];e.ITa.undo(n)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),e.commands=r.Commands,i=r.Commands.ActionBase,a=n.Common.j.Fa,s="increaseCellIndent",l="decreaseCellIndent",u="updateOutlineColumnCheckStatus",c="updateOutlineColumnOption",e.outlineColumnCheckStatus="outlineColumnCheckStatus",f=r.Commands.h4,e.setCheckStatus=b,h=function(t){function e(e,o){return t.call(this,e,o)||this}return m(e,t),e.prototype.canExecute=function(){return!!y(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns)},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t,e;return!!this.canExecute()&&((t=this.kj).ITa.startTransaction(),t.outlineColumn.Kia.JVa(),v(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns),e=r.Commands.bWa(t.name()),this.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.undo=function(){var t=this.kj,e=r.Commands.bWa(t.name()),o=this.VQ[e];return t.ITa.undo(o),!0},e}(i),p=function(t){function e(e,o){return t.call(this,e,o)||this}return m(e,t),e.prototype.canExecute=function(){return!!y(this.kj,!1,this.VQ.changingRows,this.VQ.changingColumns)},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t,e;return!!this.canExecute()&&((t=this.kj).ITa.startTransaction(),t.outlineColumn.Kia.JVa(),v(t,!1,this.VQ.changingRows,this.VQ.changingColumns),e=r.Commands.bWa(t.name()),this.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.undo=function(){return w(this),!0},e}(i),d=function(t){function e(e,o){return t.call(this,e,o)||this}return m(e,t),e.prototype.canExecute=function(){return!0},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t,e=this.kj,o=this.VQ,n=o.options,i=JSON.parse(JSON.stringify(e.outlineColumn.YQa));return e.ITa.startTransaction(),e.outlineColumn.YQa=n,e.outlineColumn.refresh(),o[t=r.Commands.bWa(e.name())]=e.ITa.endTransaction(),o[t].WIc=i,!0},e.prototype.undo=function(){return w(this),this.kj.outlineColumn.refresh(),!0},e}(i),g=function(t){function e(e,o){return t.call(this,e,o)||this}return m(e,t),e.prototype.canExecute=function(){return!0},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t=this.kj,e=this.VQ,o=e.row,n=e.col,i=e.status;return t.ITa.startTransaction(),b(t,o,0,i),t.outlineColumn.refresh(),e[r.Commands.bWa(t.name())]=t.ITa.endTransaction(),function(t,e,o,n){t.Wq(r.Events.OutlineColumnCheckStatusChanged,{sheet:t,sheetName:t.name(),row:e,col:o,status:n})}(t,o,n,i),!0},e.prototype.undo=function(){return w(this),this.kj.outlineColumn.refresh(),!0},e}(i),r.Commands[s]={canUndo:!0,execute:function(t,e,o){return e.cmd=s,f(t,h,e,o)}},r.Commands[l]={canUndo:!0,execute:function(t,e,o){return e.cmd=l,f(t,p,e,o)}},r.Commands[c]={canUndo:!0,execute:function(t,e,o){return e.cmd=c,f(t,d,e,o)}},r.Commands[u]={canUndo:!0,execute:function(t,e,o){return e.cmd=u,f(t,g,e,o)}},r.Commands.$Qa=function(t){var e=r.Ul.sl(),o=!e,n=e;t.register(s,r.Commands[s],221,o,!1,!0,n),t.register(l,r.Commands[l],219,o,!1,!0,n),t.register(u,r.Commands[u]),t.register(c,r.Commands[c])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/outlineColumn/outlineColumn.js")),n(o("./dist/plugins/outlineColumn/outlineColumn-actions.js")),n(o("./dist/plugins/outlineColumn/outlineColumn.ns.js"))},"./dist/plugins/outlineColumn/outlineColumn.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D;function F(t,e){return t&&t.outlineColumn&&t.outlineColumn.options()&&t.outlineColumn.options().columnIndex===e}function E(t,e,o,n,r){var i,a=o.x+n.x,s=n.y+n.height/2-o.height/2,l=o.width,u=o.height;if(!(n.x+n.width<a+l)&&e&&"none"!==e&&r)try{r.ko(e)?(i=r.lo(e),t.drawImage(i,a,s,l,u)):r.fo(e)}catch(t){}}function j(t,e,o,n){var r={sheet:t,sheetName:t.name(),isRowGroup:!0,index:e,level:o};return n&&(r.cancel=!1),r}function P(t,e,o){var r,i,a=t.options;a.isProtected&&!a.protectionOptions.allowOutlineRows?t.Os(n.InvalidOperationType.groupProtected,I().Exp_GROUP_PROTECTED):(r=t.rowOutlines.getLevel(e),p(o)&&(o=!t.rowOutlines.getCollapsed(e)),i=j(t,e+1,r+1,!0),t.Wq(n.Events.RangeGroupStateChanging,i),i&&!1===i.cancel&&(t.wu().execute({cmd:"expandRowOutline",sheetName:t.name(),index:e,level:r+1,collapsed:o}),t.Wq(n.Events.RangeGroupStateChanged,j(t,e+1,r+1,!1))))}function L(t,e,o,n){var r,i;p(n)&&(n=typeof(r=t.outlineColumn.getCheckStatus(e))===S?1===r?2:1:!r),i={cmd:"updateOutlineColumnCheckStatus",row:e,col:o,status:n,sheetName:t.name()},t.wu().execute(i)}function G(t,e){return p(t[e])?R[e]:t[e]}function B(t,e,o){var n,r,i=-1,a=0,s=t.children;for(n=t.start;n<=t.end;n++)if(r=void 0,s&&s[a]&&s[a].start-1===n?(r=B(s[a],e,o),n=s[a].end,a++):r=e[n]&&e[n].checkBox&&e[n].checkBox.checkStatus,-1===i)i=r;else if(i!==r){i=typeof r===S&&typeof i===S&&3;break}for(;a<t.children.length;a++)B(s[a],e,o);return o.updateCheckStatus(t.start-1,i),i}function _(t){var e=t.rowOutlines,o=t.outlineColumn.Kia,n=e.find(0,-1);n.children&&n.children.forEach((function(t){B(t,o.QR,o)}))}function V(t,e,o){var n,r,i,a,s=t.outlineColumn.options(),l=s&&s.columnIndex;if(!p(l))return n={value:0},r=0,(i=t.getActualStyle(e,l))&&i.textIndent&&(r=i.textIndent),0!==e&&(r-(a=t.rowOutlines.getLevel(e-1))>=3&&(r=a+2)),n.value+=8*r,function(t,e,o){var n,r,i,a=t.getLevel(e);if(o!==a+1)for(n=o-(a+1),r=0,i=Math.abs(n);r<i;r++)n>0?t.group(e,1):t.ungroupRange(e,1)}(t.rowOutlines,e,r),function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,m;G(o,"showIndicator")?(s=t.zoom(),l=t.getRowCount(),u=!!t.rowOutlines.isCollapsed(e+1),c=d*s,f=g*s,h=null,p=null,o.expandIndicator&&(h=o.expandIndicator,u&&(c=b*s,f=w*s)),o.collapseIndicator&&(p=o.collapseIndicator,u||(c=b*s,f=w*s)),e<l-1&&((m=t.getActualStyle(e+1,n))&&m.textIndent>r?a.indicator={x:i.value+y*s,y:-f/2,width:c,height:f,collapsed:u,collapseIndicator:p,expandIndicator:h}:delete a.indicator),i.value+=2*y*s+c):delete a.indicator}(t,e,s,l,r,n,o),function(t,e,o,n,r,i){var a,s;(p(o.showCheckBox)?R.showCheckBox:o.showCheckBox)?(a=!p(i.checkBox)&&1!==i.checkBox&&i.checkBox.checkStatus,s=t.zoom(),i.checkBox={x:r.value+y*s,y:-m*s,width:2*m*s,height:2*m*s,checkStatus:a},r.value+=2*y*s+2*m*s):delete i.checkBox}(t,0,s,0,n,o),function(t,e,o,n,r){var i,a,s,l;(p(o.showImage)?R.showImage:o.showImage)?(i=o.images,a=t.zoom(),i&&i.length&&(s=e>i.length-1?i[i.length-1]:i[e],l=n.value+y*a,r.images={image:s,x:l,y:0,width:C*a,height:v*a},n.value+=2*y*a+C*a)):delete r.images}(t,r,s,n,o),o.cellContent={left:n.value,x:n.value,y:0,width:-n.value,height:0},o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/outlineColumn/outlineColumn-actions.js"),a=o("./dist/plugins/outlineColumn/outlineColumn.ns.js"),s=r.Common.k,l=s.ac,u=r.Common.A,c=r.Common.B,f=n.GC$.each,h=n.GC$.isEmptyObject,p=r.Common.j.Fa,d=5,g=6,m=6,y=3,C=16,v=16,b=16,w=16,T=void 0,S="number",x=null,A=new r.Common.ResourceManager(a.SR,"OutlineColumn"),I=A.getResource.bind(A),R={columnIndex:T,showCheckBox:!1,showImage:!1,images:T,showIndicator:!0,expandIndicator:T,collapseIndicator:T,maxLevel:10},M=function(){function t(t){this.kj=t,this.YQa={},this.$e=0}return t.prototype.no=function(){var t=this;t.kj=x,t.Kia=x,t.YQa=x},t.prototype.LRa=function(t,e){return this.YQa&&this.YQa.columnIndex===e?this.Kia.QR[t].cellContent.left:null},t.prototype.options=function(t){var e=this,o=e.YQa;return l(arguments)?(e.YQa=t,e.refresh(),e):o},t.prototype.refresh=function(){var t=this.kj;p(this.YQa)||p(this.YQa.columnIndex)||0===this.$e&&(t.suspendPaint(),t.outlineColumn.Kia.updateModel(),t.resumePaint())},t.prototype.setCheckStatus=function(t,e){var o=this.YQa.columnIndex;p(o)||L(this.kj,t,o,e)},t.prototype.Wlb=function(t){this.kj.outlineColumn.Kia.setAllTiemCheckStatus(t),this.refresh()},t.prototype.getCheckStatus=function(t){var e,o;if(l(arguments))return this.kj.outlineColumn.Kia.getCheckStatus(t);for(e=[],o=this.kj.getRowCount(),t=0;t<o;t++)e[t]=this.kj.outlineColumn.Kia.getCheckStatus(t);return e},t.prototype.setCollapsed=function(t,e){P(this.kj,t,e)},t.prototype.getCollapsed=function(t){var e,o;if(l(arguments))return this.kj.outlineColumn.Kia.getCollapsed(t);for(e=[],o=this.kj.getRowCount(),t=0;t<o;t++)e[t]=this.kj.outlineColumn.Kia.getCollapsed(t);return e},t.prototype.reset=function(){if(!p(this.YQa)&&!p(this.YQa.columnIndex)){var t=this.kj;this.YQa=R,t.suspendPaint(),t.outlineColumn.Kia.updateModel(),t.resumePaint()}},t.prototype.XQa=function(t){return this.YQa&&this.YQa.columnIndex===t},t.prototype.ZQa=function(){return this.YQa&&!p(this.YQa.columnIndex)},t.prototype.Lia=function(){this.$e++},t.prototype.Mia=function(){this.$e>0&&this.$e--,0===this.$e&&this.refresh()},t.prototype.Nia=function(t,e){this.kj.outlineColumn.Kia.insertRows(t,e)},t.prototype.STa=function(t,e){this.kj.outlineColumn.Kia.deleteRows(t,e)},t.prototype.Oia=function(){return R},t.prototype.Pia=function(){return{TRIANGLE_HEIGHT:d,TRIANGLE_BASE:g,CHECKBOX_RADIUS:m,GAP:y,IMAGE_WIDTH:C,IMAGE_HEIGHT:v,INDICATOR_IMAGE_WIDTH:b,INDICATOR_IMAGE_HEIGHT:w}},t.prototype.Gka=function(t){var e;for(e in t)t.hasOwnProperty(e)&&((this.Kia.QR[e]=this.Kia.QR[e]||{}).checkBox={checkStatus:t[e].checked})},t.prototype.CXa=function(t,e){var o=this.YQa.columnIndex;p(o)||i.setCheckStatus(this.kj,t,o,e)},t.prototype.WZa=function(){return this.Kia.QR},t}(),e.OutlineColumn=M,k=function(){function t(t){this.kj=t,this.QR={}}return t.prototype.no=function(){this.kj=x},t.prototype.updateIndicatorCollapsed=function(t,e){var o=this;p(o.QR[t])||p(o.QR[t].indicator)||(o.QR[t].indicator.collapsed=e)},t.prototype.updateCheckStatus=function(t,e){var o=this;o.JVa(t),p(o.QR[t])||(o.QR[t].checkBox.checkStatus=e)},t.prototype.setAllTiemCheckStatus=function(t){var e,o=this.QR;for(e in o)o.hasOwnProperty(e)&&(o[e].checkBox.checkStatus=t)},t.prototype.getCheckStatus=function(t){var e=this;return p(e.QR[t])||p(e.QR[t].checkBox)?null:e.QR[t].checkBox.checkStatus},t.prototype.getCollapsed=function(t){var e=this;return!p(e.QR[t])&&!p(e.QR[t].indicator)&&e.QR[t].indicator.collapsed},t.prototype.updateModel=function(){var t,e,o=this,n=o.kj,r=n.getRowCount();for(n.rowOutlines.direction(0),t=0;t<r;t++)o.QR[t]=o.QR[t]||{},V(n,t,o.QR[t]);e=n.outlineColumn.options(),(p(e.showCheckBox)?R.showCheckBox:e.showCheckBox)&&_(n)},t.prototype.insertRows=function(t,e){this.oEc(t,e),this.kEc(t,e)},t.prototype.oEc=function(t,e){var o,n,r,i=this.kj,a=i.outlineColumn.options();p(a)||(o=a.columnIndex,p(o)||(r=0,(n=i.getActualStyle(t-1,o))&&n.textIndent&&(r=n.textIndent),i.getRange(t,o,e,1).textIndent(r)))},t.prototype.kEc=function(t,e){var o,n=this.QR,r=n[t-1],i=r&&r.checkBox,a=this.kj.getRowCount();for(u(n,a,t,e),o=0;o<e;o++)n[t+o]={checkBox:{checkStatus:i&&i.checkStatus}}},t.prototype.deleteRows=function(t,e){this.lEc(t,e)},t.prototype.lEc=function(t,e){var o=this.QR,n=this.kj.getRowCount();c(o,n,t,e)},t.prototype.KVa=function(t,e){var o,n=this.QR[e];n&&!t[e]&&(o=n.checkBox,t[e]={checked:o&&o.checkStatus})},t.prototype.LVa=function(t){var e,o=this.QR;for(e in o)o.hasOwnProperty(e)&&this.KVa(t,e)},t.prototype.MVa=function(t){var e,o=this.QR;for(e in t)p(t[e].checked)||(o[e].checkBox.checkStatus=t[e].checked)},t.prototype.NVa=function(){var t=this.kj.ITa.zTa;return t?(t.OVa||(t.OVa={items:{}}),t.OVa):T},t.prototype.JVa=function(t){var e=this,o=e.NVa();o&&!o.all&&(p(t)?(o.all=!0,e.LVa(o.items)):e.KVa(o.items,t))},t.prototype.PVa=function(t){this.MVa(t.items)},t}(),n.GC$.extend(n.lUa.prototype,{PVa:function(t){var e=this.QVa,o=e.Kia;e.ZQa()&&(o.updateModel(),t&&o.PVa(t),this.kj.$p())}}),n.lUa.$n("outlineColumn",{init:function(){var t=this,e=t.kj;t.QVa=new M(e),t.QVa.Kia=new k(e)},undo:function(t){var e=t.OVa;e&&!t.WIc&&this.PVa(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.QVa&&(e.QVa.Kia&&(e.QVa.Kia.no(),e.QVa.Kia=x),e.QVa.no(),e.QVa=x)}}),N={init:function(){this.outlineColumn=this.ITa.QVa},dispose:function(t){if(!1!==t.clearCache){var e=this.outlineColumn;e&&(e.no(),this.outlineColumn=x)}},toJson:function(t){var e,o,n,r,i,a,s,l;if(e=this.outlineColumn,o=e.YQa,n=e.Kia.QR,!p(o)){if(r={},f(R,(function(t){i=o[t],p(i)||function(t,e){return R[t]===e}(t,i)||(r[t]=i)})),a={},o.showCheckBox)for(s in n)n.hasOwnProperty(s)&&((l=n[s].checkBox.checkStatus)&&(a[s]={checked:l}));h(a)||(r.data=a),t.outlineColumnOptions=r}},fromJson:function(t){var e,o,n,r=this.outlineColumn,i=t.outlineColumnOptions;if(i){if(o=void 0,e=i.data){for(n in o={},i)"data"!==n&&(o[n]=i[n]);r.Gka(e)}r.options(p(o)?i:o),r.refresh()}},onLayoutChanged:function(t){var e,o,n=this,r=n.outlineColumn,i=t.changeType,a=t.rowCount,s=t.row;if("addRows"===i)r.Kia.JVa(),r.Nia(s,a),r.refresh();else if("deleteRows"===i)r.Kia.JVa(),r.STa(s,a),r.refresh();else if("zoomSheet"===i)r.refresh();else if("invalidateLayout"===i&&r.Kia.QR&&!h(r.Kia.QR)&&n.rowOutlines.items&&!h(n.rowOutlines.items))for(o in e=n.rowOutlines.items)e.hasOwnProperty(o)&&r.Kia.updateIndicatorCollapsed(parseInt(o,10),n.rowOutlines.isCollapsed(parseInt(o,10)+1))},sortRangeChanged:function(t){for(var e=this.outlineColumn,o=t.column,n=t.columnCount,r=o;e.XQa(r)&&r<=o+n;)e.refresh(),r+=1}},n.Worksheet.$n("outlineColumn",N),O={paintCellPadding:function(t){var e,o=t.options.rect,n=t.options.context.sheet,r=t.options.context,i=r.row,a=r.col,s=t.ctx;F(n,a)&&o.width>0&&o.height>0&&((e=n.outlineColumn.Kia.QR[i])&&(s.save(),e.indicator&&function(t,e,o,n){var r=e.collapsed,i=e.x+o.x,a=o.y+o.height/2-e.height/2,s=e.height,l=e.width;o.x+o.width<i+l||(r?e.expandIndicator?E(t,e.expandIndicator,e,o,n):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(i,a),t.lineTo(i,a+s),t.lineTo(i+l,a+s/2),t.fill(),t.restore()):e.collapseIndicator?E(t,e.collapseIndicator,e,o,n):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(i,a+s),t.lineTo(i+l,a+s),t.lineTo(i+l,a),t.fill(),t.restore()))}(s,e.indicator,o,r.imageLoader),e.checkBox&&function(t,e,o){var n=e.x+o.x,r=o.y+o.height/2-e.height/2,i=e.height,a=e.width;o.x+o.width<n+a||(t.save(),t.beginPath(),t.strokeStyle="black",t.strokeRect(n,r,a,i),t.fillStyle="white",t.fillRect(n,r,a,i),3===e.checkStatus?(t.beginPath(),t.fillStyle="black",t.rect(n+a/5,r+i/5,a-.4*a,i-.4*i),t.fill()):!0!==e.checkStatus&&1!==e.checkStatus||(t.beginPath(),t.lineWidth=a/5,t.moveTo(n+a/6,r+i/2),t.lineTo(n+2*a/5,r+5/7*i),t.lineTo(n+5/6*a,r+i/6),t.stroke()),t.restore())}(s,e.checkBox,o),e.images&&E(s,e.images.image,e.images,o,r.imageLoader),s.restore(),e.cellContent&&(o.x+=e.cellContent.left,o.width-=e.cellContent.left)))},getCellPaddingRect:function(t){var e,o=t.options.rect,n=t.options.context.sheet,r=t.options.context,i=r.row;F(n,r.col)&&o.width>0&&o.height>0&&((e=n.outlineColumn.Kia.QR[i])&&e.cellContent&&(o.x+=e.cellContent.left,o.width-=e.cellContent.left))},getCellPaddingHitInfo:function(t){var e,o,n,r,i=t.context.sheet,a=t.context.col,s=t.context.row,l=t.x,u=t.y,c=t.cellRect,f=i.outlineColumn;if(t.paddingHitInfo=null,f&&f.YQa){for(e=f.Kia.QR[s],o=f.YQa.columnIndex,c=c.clone();a>o;)a--,c.x-=i.getColumnWidth(a);e&&a===o&&(n=void 0,r=void 0,e.indicator&&(n=e.indicator.x,l>=(r=e.indicator.x+c.x)&&l<r+e.indicator.width&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{indicator:!0}})),e.checkBox&&(n||(n=e.checkBox.x),l>=(r=e.checkBox.x+c.x)&&l<r+e.checkBox.width&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{checkBox:!0}})),e.images&&(n||(n=e.images.x),l>=(r=e.images.x+c.x)&&l<r+e.images.width&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{image:!0}})),n&&l>=c.x&&l<c.x+n&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{blank:!0}}))}},processMouseDownOnCellPadding:function(t){var e=t.sheet,o=t.row,n=t.col,r=t.outlineColumnHitInfo;p(r)||(r.indicator?P(e,o):r.checkBox?L(e,o,n):r.image||r.blank)},getOutlineColumnOffset:function(t){var e,o=t.context.sheet;F(o,t.context.col)&&(G(e=o.outlineColumn.options(),"showIndicator")&&(t.value+=y,function(t){return!(!t.expandIndicator&&!t.collapseIndicator)}(e)?t.value+=b:t.value+=d,t.value+=y),G(e,"showCheckBox")&&(t.value+=y,t.value+=2*m,t.value+=y),G(e,"showImage")&&(t.value+=y,t.value+=C,t.value+=y))}},n.CellTypes.Base.$n("outlineColumn",O),D={init:function(){i.commands.$Qa(this.commandManager())},onCultureChanged:function(){I()}},n.Workbook.$n("outlineColumn",D)},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/outlineColumn/outlineColumn.res.en.js");e.SR={en:n}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/search/search.entry.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/search/search.js");e.SearchResult=n.SearchResult,e.SearchCondition=n.SearchCondition,e.SearchFlags=n.SearchFlags,e.SearchOrder=n.SearchOrder,e.SearchFoundFlags=n.SearchFoundFlags},"./dist/plugins/search/search.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h;function p(t,e,o){if(!t)return!1;if(t=""+t,e=""+e,0===o)return t.indexOf(e)>-1;var n=(2&o)>0,r=(1&o)>0;return(4&o)>0?(e=(n?s.zb(e,!1,!0):s.ub(e))||e,(r?s.sb(e):s.qb(e)).test(t)):(r&&(e=e.toLowerCase(),t=t.toLowerCase()),n?e===t:t.indexOf(e)>=0)}function d(t,e,o,n,r,i,a,s){var u=l,c=t+1,f=e+1;return 0===o?f>=0&&f<=s?u={r:t,c:f}:c>=0&&c<=i&&(u={r:c,c:n?a:0}):c<=i?u={r:c,c:e}:f<=s&&(u={r:n?r:0,c:f}),u}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("@grapecity/js-calc"),a=!!i,s=r.Common.q,l=null,u=Math.max,c="string",n.Worksheet.prototype.search=function(t){var e,o,r,i,s,f,g,m,y,C,v,b,w,T,S,x,A,I,R,M;if(!t)return l;if(e=this,o=t.sheetArea,r=t.searchString,i=t.searchTarget,s=t.searchFlags,f=e.getRowCount(o),g=e.getColumnCount(o),m=new h,!r||0===i||f<=0&&g<=0)return m;for(y=u(0,t.rowStart),C=u(0,t.columnStart),w=(8&s)>0,((v=t.rowEnd)<0||!w)&&(v=f-1),((b=t.columnEnd)<0||!w)&&(b=g-1),x=(T=t.findBeginRow)<0?y:T,A=(S=t.findBeginColumn)<0?C:S;x>=0&&A>=0;){if(I=e.getCell(x,A,o),R=void 0,(1&i)>0&&(""!==(R=t.callback?t.callback(I,e):I.text())&&p(R,r,s)&&(m.searchFoundFlag|=1,m.foundString=R)),a&&(8&i)>0&&(typeof(R=n.util.$Xc(e,x,A))===c&&""!==R&&p(R,r,s)&&(m.searchFoundFlag|=8,m.foundString=R)),(4&i)>0&&(typeof(R=I.tag())===c&&""!==R&&p(R,r,s)&&(m.searchFoundFlag|=4,m.foundString=R)),0!==m.searchFoundFlag)return m.foundRowIndex=x,m.foundColumnIndex=A,m;if(!(M=d(x,A,t.searchOrder,w,y,v,C,b)))break;x=M.r,A=M.c}return m},n.Workbook.prototype.search=function(t){var e,o,n,r,i,a;if(!t)return l;if(this,0,e=this.getSheetCount(),o=new h,!t.searchString||0===t.searchTarget||e<=0)return o;if(-1===t.startSheetIndex&&(t.startSheetIndex=0),-1===t.endSheetIndex&&(t.endSheetIndex=e-1),i=t.startSheetIndex,(a=t.endSheetIndex)>=i&&0<=i&&i<e&&0<=a&&a<e)for(n=i;n<=a;n++)if((r=this.getSheet(n).search(t))&&0!==r.searchFoundFlag)return r.foundSheetIndex=n,r;return o},f=function(){this.startSheetIndex=-1,this.endSheetIndex=-1,this.searchString=l,this.searchFlags=0,this.searchOrder=0,this.searchTarget=1,this.sheetArea=3,this.rowStart=-1,this.columnStart=-1,this.rowEnd=-1,this.columnEnd=-1,this.findBeginRow=-1,this.findBeginColumn=-1},e.SearchCondition=f,h=function(){this.foundColumnIndex=-1,this.foundRowIndex=-1,this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundString=l},e.SearchResult=h,function(t){t[t.none=0]="none",t[t.ignoreCase=1]="ignoreCase",t[t.exactMatch=2]="exactMatch",t[t.useWildCards=4]="useWildCards",t[t.blockRange=8]="blockRange"}(e.SearchFlags||(e.SearchFlags={})),function(t){t[t.zOrder=0]="zOrder",t[t.nOrder=1]="nOrder"}(e.SearchOrder||(e.SearchOrder={})),function(t){t[t.none=0]="none",t[t.cellText=1]="cellText",t[t.cellTag=4]="cellTag",t[t.cellFormula=8]="cellFormula"}(e.SearchFoundFlags||(e.SearchFoundFlags={}))},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function O(t){return t.indexOf("LET(")>-1&&"LET"}function D(t,e,o,r,i,a){var l,u=t&&t instanceof n.Worksheet&&t,c=new s.Parser;return o=o===d?0:o,r=r===d?0:r,l=new R(u,!!i,s.pf(o,r)),a&&(l.culture=!0),c.parse(l,e)}function F(t,e,o,n,r){var i,a,l=t.Cf();return o===d&&(o=t.getActiveRowIndex()),n===d&&(n=t.getActiveColumnIndex()),i=!0,r&&r.convertNullToZero!==d&&(i=r.convertNullToZero),a=t.yj(),l.Hg(a,e,s.pf(o,n),!1,i)}function E(t,e,o,n,r){var i,u,c,f=t.row,h=t.col,d=t.row+t.rowCount-1,g=t.col+t.colCount-1,m=!1,y=!1,C=!1,v=!1;return arguments.length>=4&&(f-=(m=0!=(1&n))?e:0,d-=(y=0!=(4&n))?e:0,h-=(C=0!=(2&n))?o:0,g-=(v=0!=(8&n))?o:0),r&&(u=j(t,r,e),c=P(t,r,e),u&&c)?i=a.StructureReferenceResolver.create(r,u,c,t.col-r.dataRange().col,t.col+t.colCount-r.dataRange().col-1):(1===t.rowCount&&1===t.colCount?i=s.rf(p,p,f,h,m,C):(t.row<0&&(f=d=l.BAND_INDEX_CONST),t.col<0&&(h=g=l.BAND_INDEX_CONST),i=s.uf(p,p,f,h,d,g,m,C,y,v,e,o)),i)}function j(t,e,o){if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow())return 2;if(e.hasTotalsRow()&&t.row===e.endRow())return 8;if(o===t.row)return 1}else{if(e.hasHeadersRow()&&t.row===e.startRow()){if(t.rowCount===e.dataRange().rowCount+1)return 6;if(e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1)return 14}if(t.row===e.dataRange().row){if(t.rowCount===e.dataRange().rowCount)return 3;if(e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1)return 12}}return d}function P(t,e,o){return t.col===e.startColumn()&&t.colCount===e.dataRange().colCount?1:1===t.colCount?2:t.col>=e.startColumn()&&t.col+t.colCount-1<=e.endColumn()?4:d}function L(t,e,o,r){var i,a,s,l,u,c,f,h;if(!e)return null;if(o=o||0,r=r||0,i=t.Cf().parse(t.yj(),e,o,r,!0,!0))if((a=i.source)&&13===i.type);else if(1===i.type&&i.endSource){for(s=i.source,l=i.endSource,u=s.getSources(l),c=!1,f=0;f<u.length;f++)if(u[f]===t.yj()){c=!0;break}i=c&&i}return!i||!i.getRange||a&&a!==t.yj()?null:(h=i.getRange(o,r))?new n.Range(h.row,h.col,h.rowCount,h.colCount):null}function G(t,e,o,n,r,i){var a,s,l,u="";for(a=0;a<o.length;a++)s=E(o[a],n,r,i),l=t.unparse(e,s),u+=a>0?", "+l:l;return u}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Core"),i=o("Common"),a=o("./dist/plugins/sheetsCalc/parser-sheets.js"),s=o("@grapecity/js-calc"),l=o("./dist/plugins/sheetsCalc/calc.ns.js"),u=i.Common.j,c=i.Common.u,f=u.Ia,h=u.za,p=null,d=void 0,g=["v","n","s","b","d","sn"],m=s.Errors.Value,s.Errors.Calc,y=i.Formatter&&i.Formatter.GeneralFormatter,C=s.Convert.vf,s.Convert.Fh,s.Convert.Ca,s.Errors.Reference,s.Errors.NotAvailable,s.Errors.Name,i.Common.A,i.Common.B,v=u.Fa,b=function(t){return s.Convert.Na(t,!0)},w=n.Range.prototype.contains,T=c.Nb,(S=s.CalcSource.prototype).referenceToArray=function(t,e,o,n,r,i,a,l){var u,c,f,h,g,y,C,v,b,w,T,S,x=this,A=1,I=1,R=[],M=t.getRangeCount();if(0===M)return R.isError=!0,R;for(C=x.getRowCount(),v=x.getColumnCount(),o=o===d||o,b=0;b<M;b++){if(o||(y=[],R.push(y)),0===(A=t.getRowCount(b)))return R.isError=!0,R;if(0===(I=t.getColumnCount(b)))return R.isError=!0,R;if(f=t.getRow(b),h=t.getColumn(b),f>=C||h>=v)return(R=[p]).rowCount=1,R.colCount=1,R.rangeCount=1,R;for(f+A>C&&(A=C-f),h+I>v&&(I=v-h),w=void 0,T=0;T<A;T++)for(u=f+T,o||(w=[],y.push(w)),S=0;S<I;S++){if(c=h+S,g=x.getValue(u,c),n&&s.Convert.vf(g))return(R=[g]).isError=!0,R;if(g=s.Convert.wf(g,e,!s.ExcelCompatibleCalcMode,i,l),r&&g===s.Convert.CalcConvertedError)return(R=[m]).isConvertError=!0,R;g===p&&i||(o?R.push(g):w.push(g))}}return o||1!==M||(R=R[0]),R.rowCount=A,R.colCount=I,R.rangeCount=M,R},S.getSheetReference=function(){var t=this;return t.Df=t.Df||new s.CalcReference(t),t.Df},function(t){t[t.a1=0]="a1",t[t.r1c1=1]="r1c1"}(x=e.ReferenceStyle||(e.ReferenceStyle={})),r.ReferenceStyle=x,A=function(){function t(t,e,o,n,r){var i=this;i.Cj=t,i.Uu=o,i.Vu=n,i.Lf=e,v(r)||(i.kT=r)}return t.prototype.getName=function(){return this.Cj},t.prototype.getRow=function(){return this.Uu},t.prototype.getColumn=function(){return this.Vu},t.prototype.getExpression=function(){return this.Lf},t.prototype.getComment=function(){return this.kT},t.prototype.fg=function(t,e){e&&e.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=t},t}(),e.NameInfo=A,r.NameInfo=A,s.CalcSource.prototype.createSourceModel=function(t){return new s.CalcSourceModel(t,this)},I=function(t){function e(e){var o=t.call(this,p)||this;return o.references=e,o}return N(e,t),e.prototype.toArray=function(t,e,o,n,r){var i,a,s=this.references,l=[];for(i=0;i<s.length;i++){if((a=s[i].xf.referenceToArray(s[i],t,e,o,n,r)).isError&&o)return a;e?Array.prototype.push.apply(l,a):l.push(a[0]),i||(l.rowCount=a.rowCount,l.colCount=a.colCount)}return l.rangeCount=s.length,l},e}(s.CalcReference),e.SheetRangeReference=I,R=function(t){function e(o,r,i,s){var l,u,c,f=t.call(this,o&&o.yj(),r,i,s)||this;for(o||(o=e.hYc=e.hYc||new n.Worksheet),f.kj=o,f.row=i&&i.row||0,f.column=i&&i.col||0,u=(l=o.getCalcService()).getResolvers(),c=0;c<u.length;c++)if(u[c]instanceof a.SheetReferenceResolver)return f;return l.addResolver(new a.SheetReferenceResolver(o)),l.addResolver(new a.StructureReferenceResolver(o)),f}return N(e,t),e.prototype.getExternalSource=function(t,e){var o,n,r,i=this,a=i.kj.parent;if(t&&(!a||a.name!==t))return p;if(!a)return c.Mb(i.kj.name(),e)?i.kj.yj():p;if((o=a.sheets)&&o.length>0)for(n=0;n<o.length;n++)if(r=o[n],c.Mb(r.name(),e))return r.yj();return s.ParserContext.prototype.getExternalSource.call(this,t,e)},e.prototype.getExternalSourceToken=function(t){return t.getName()},e.prototype.getTableByName=function(t){var e,o,n=this.kj.tables,r=n?n.findByName(t):p;if(!r&&(e=this.kj.parent&&this.kj.parent.sheets))for(o=0;o<e.length&&(!(n=e[o].tables)||!(r=n.findByName(t)));o++);return r||this.kj.parent&&this.kj.parent.getSheetTab(t)},e.prototype.getTableByIndex=function(t,e){var o=this.kj.tables;return o?o.find(t,e):p},e.prototype.setSource=function(t){this.source=t;var e=t;e&&e.getSheet&&(this.kj=e.getSheet())},e.prototype.no=function(){this.kj&&this.kj!==e.hYc&&this.kj.no(),this.kj=p},e}(s.ParserContext),e.SheetParserContext=R,new i.Common.ResourceManager(n.SR),M=function(t){function e(o,n){var r=t.call(this,p)||this;return r.getCalcSourceModel=function(){return this.Bf},r.createSourceModel=function(t){return new s.CalcSourceModel(t,this)},r.getRangeKey=function(t,e){return t.id+","+e.row+","+e.col+","+e.rowCount+","+e.colCount},r.getSheetRangeReference=function(t){var o,n,r,i,a,s=this.kj,l=s&&s.parent;if(t.endSource&&l&&l.sheets&&t.endSource instanceof e){for(o=l.sheets,n=!1,r=void 0,i=[],a=0;a<o.length;a++){if((r=o[a].yj())===this)n=!0;else if(r===t.endSource){i.push(r.getReference(t));break}n&&i.push(r.getReference(t))}return new I(i)}},r.kj=o,r.Wz=n||3,r}return N(e,t),e.prototype.startCalculation=function(){this.Hu||this.xLb()},e.prototype.endCalculation=function(){this.Hu=p,this.zIc(),this.Iu=p;var t=this.Bf.ug(!1);t&&t.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},e.prototype.ZIc=function(){var t=this;t.$Ic?t.Iu&&(t._Ic=t._Ic.concat(t.Iu),t.Iu=[]):(t._Ic=t.Iu||[],t.$Ic=setTimeout((function(){t.zIc(t._Ic),delete t._Ic,delete t.$Ic}),0))},e.prototype.zIc=function(t){var e,o=t||this.Iu;o&&o.length>0&&(e=this.kj).Wq(n.Events.RangeChanged,{isUndo:!1,sheet:e,sheetName:e.name(),row:0,col:0,rowCount:e.getRowCount(),colCount:e.getColumnCount(),changedCells:o,action:6},e.vxb)},e.prototype.clearValueCache=function(){this.xLb()},e.prototype.xLb=function(){var t=this.getRowCount(),e=this.getColumnCount();this.Hu={rowCount:t,colCount:e,arrayInfo:[]},this.Iu=[]},e.prototype.OHb=function(){this.Hu=p,this.Iu=p},e.prototype.getValue=function(t,e){var o,r,i,a,l,u,c,f,h,y,C,v,b,w=[];for(o=2;o<arguments.length;o++)w[o-2]=arguments[o];if(i=(r=this).kj,"number"==typeof t)a=arguments[0],l=arguments[1],e=arguments[2];else if(t.row!==d)a=t.row,l=t.col;else if(t.name)return null;return u=r.Wz,e=e||0,a<0||l<0?m:i.Ju&&i.Ku===a&&i.Lu===l?i.Mu:(c=r.Hu,f=g[e],c?(h=c.rowCount,y=c.colCount,C=void 0,v=void 0,b=void 0,a>=h||l>=y?p:((C=c[a])||(C=c[a]={}),(v=C[l])||(v=C[l]={v:i.getValue(a,l,u)}),(b=v[f])===d&&(b=s.Convert.wf(v.v,e,!s.ExcelCompatibleCalcMode),v[f]=b),b=n.Ul.w0a(b))):a>=r.getRowCount()||l>=r.getColumnCount()?p:r.kj.getValue(a,l,u))},e.prototype.getIdentity=function(t,e){var o=this,n=e.row,r=e.rowCount||1,i=e.column,a=e.columnCount||1;return-1===n&&(n=0,r=o.getRowCount()),-1===i&&(i=0,a=o.getColumnCount()),o.getName()+"."+n+"."+r+"."+i+"."+a},e.prototype.getReference=function(t){var e,o,n,r,i,a,l=this,u=t.row,c=t.col;if(-1===u&&(t.row=0,t.rowCount=l.getRowCount()),-1===c&&(t.col=0,t.colCount=l.getColumnCount()),e=!1,t.spillRef)if(o=l.yLb().getAnchorCell(u,c))t.rowCount=o.rowCount,t.colCount=o.colCount,e=!o.isValid;else{if(r=(n=l.getCalcSourceModel()).Qf(u,c))return r.row===u&&r.col===c?(t.rowCount=r.rowCount,t.colCount=r.colCount,new s.CalcReference(l,[t])):void 0;if(!(i=n.Kf(u,c))||33!==i.type)return i&&("@"===i.functionName||i instanceof s.ReferenceExpression)?(t.rowCount=1,t.colCount=1,new s.CalcReference(l,[t])):void 0;e=!0,t.rowCount=1,t.colCount=1}return a=new s.CalcReference(l,[t]),e&&(a.isSpillError=!0),a},e.prototype.getSources=function(t){var o,n,r,i,a;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&t instanceof e){for(o=this.kj.parent.sheets,n=!1,r=void 0,i=[],a=0;a<o.length;a++){if((r=o[a].yj())===this&&(n=!0),r===t){i.push(r);break}n&&i.push(r)}return i}},e.prototype.Ppb=function(t,e){var o,n=this.Hu,r=n&&n.arrayInfo;r&&(o=!1,r.forEach((function(i,a){if(i){var s=i.reference,l=i.key;w.call(s.yf[0],t,e)&&(delete n[l],r[a]=d,o=!0)}})),o&&(n.arrayInfo=[],r.forEach((function(t){t&&n.arrayInfo.push(t)}))))},e.prototype.referenceToArray=function(t,e,o,n,r,i,a,l){var c,f,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F=this,E=1,j=1,P=[],L=F.kj,G=F.Hu,B=g[e],_=t.getRangeCount();if(0===_)return P.isError=!0,P;if(G&&(b=G[S=t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+e+"_"+o]))return b;for(x=this.getRowCount(),A=this.getColumnCount(),o=o===d||o,I=0;I<_;I++){if(o||(w=[],P.push(w)),0===(E=t.getRowCount(I)))return P.isError=!0,P;if(0===(j=t.getColumnCount(I)))return P.isError=!0,P;if(C=t.getRow(I),v=t.getColumn(I),C>=x||v>=A)return(P=o?[p]:[[p]]).rowCount=1,P.colCount=1,P.rangeCount=1,P;for(C+E>x&&(E=x-C),v+j>A&&(j=A-v),R=void 0,M=void 0,k=L.Ju,N=0;N<E;N++)for(c=C+N,o||(R=[],w.push(R)),G&&(G[c]||(G[c]={}),T=G[c]),O=0;O<j;O++){if(f=v+O,k&&L.Ku===c&&L.Lu===f)b=L.Mu,k=!1;else{if(G?(M=T[f])?b=M.v:(b=L.getValue(c,f,F.Wz),M=T[f]={v:b}):b=L.getValue(c,f,F.Wz),a&&(void 0,"@"===((D=L.getFormatter())instanceof y?D.formatString():D)?b=L.getText(c,f):b instanceof Date&&(b=u.Pa(b)),h(M)||(M=T[f]={v:b})),n&&s.Convert.vf(b))return(P=[b]).isError=!0,P;if(M&&M[B]!==d)b=M[B];else if(b=s.Convert.wf(b,e,!s.ExcelCompatibleCalcMode,i,l),M&&(M[B]=b),r&&M===b)return(P=[m]).isConvertError=!0,P}s.Convert.j$a(b,i)||(o?P.push(b):R.push(b))}}return o||1!==_||(P=P[0]),P.rowCount=E,P.colCount=j,P.rangeCount=_,G&&!isNaN(_)&&!isNaN(E)&&!isNaN(j)&&_*E*j>100&&_*E*j<1e6&&G.arrayInfo.length<50&&(G[S]=P,G[S].rowCount=E,G[S].colCount=j,G[S].rangeCount=_,G.arrayInfo.push({reference:t,key:S})),P},e.prototype.getColumnCount=function(){var t=this.kj;return t.Js?0:t.getColumnCount(this.Wz)},e.prototype.getRowCount=function(){var t=this.kj;return t.Js?0:t.getRowCount(this.Wz)},e.prototype.isHiddenRow=function(t,e){var o=this.kj;return!(!(o.Nu&&o.Nu())&&e)&&0===o.getRowHeight(t)},e.prototype.getName=function(){var t=this.Wz,e=v(this.JXc)?this.kj.name():this.JXc;return t===n.SheetArea.colHeader?e+"CH":t===n.SheetArea.rowHeader?e+"RH":e},e.prototype.yLb=function(){var t=this,e=t.ZHb;return e||(e=t.ZHb=t.kj.ITa.ZHb),e},e.prototype.setArray=function(t,e,o,n,r){return this.yLb().setArray(this,t,e,o,n,r)},e.prototype.updateItem=function(t,e,o){return this.yLb().updateItem(this,t,e,o)},e.prototype.GIb=function(t,e){this.yLb().GIb(t,e)},e.prototype.HIb=function(){this.yLb().HIb()},e.prototype.setValue=function(t){var e,o,r,i,a,s,l,u,c,h,p,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=[];for(e=1;e<arguments.length;e++)N[e-1]=arguments[e];if(r=(o=this).kj,s=o.Wz,t.row!==d)i=t.row,a=t.col,l=1;else{if(t.name)return;i=arguments[0],a=arguments[1],l=2}u=arguments[l],c=arguments[l+1],(h=o.Hu)&&((p=h[i])&&((g=p[a])&&(g.v=u,g.b!==d&&(g.b=d),g.d!==d&&(g.d=d),g.n!==d&&(g.n=d),g.s!==d&&(g.s=d),g.sn=d))),m=n.Ul.x0a(u),y=r.ITa,C=!1,b=(v=r.tables)&&v.find(i,a),3===s&&b&&(w=b.showHeader()&&i===b.headerIndex(),T=b.showFooter()&&i===b.footerIndex(),w||T||(C=b.yq(i,a,m))),S=r.wq,3===s&&!C&&S&&S.Ou&&(A=!1,(x=S.getValue(i,a)).hasBinding&&(I=void 0,h?(I=(R=h.bindingRows=h.bindingRows||{})[i])||(I=R[i]=f({},r.getDataItem(i))):I=f({},r.getDataItem(i)),y.Cp(i,a,{Dp:I,Ep:x.value}),A=S.setValue(i,a,m,y.zTa)),C="dataManagerBindingSource"===S.CL?A:x.hasBinding),C||(M="hyperlink","__proto__","string"==typeof m&&m[M]&&(k={url:m[M]},y.setHyperlink&&y.do("setHyperlink",i,a,k),delete m.__proto__.hyperlink),y.do("setValue",i,a,m,s,!0,!0,arguments[l+2])),r.cJc=!0,this.Iu?this.Iu.push({row:i,col:a}):r.Wq(n.Events.CellChanged,{sheet:r,sheetName:r.name(),row:i,col:a,sheetArea:s,propertyName:"value",oldValue:c,newValue:u})},e.prototype.getCustomFunction=function(t){return this.kj?this.kj.Pu(t):p},e.prototype.getCustomName=function(t){t=T(t);var e=this.kj?this.kj.getCustomName(t):p;return e?e.getExpression():p},e.prototype.getSheet=function(){return this.kj},e.prototype.setFormula=function(t,e,o){},e.prototype.setArrayFormula=function(t,e,o,n,r){},e.prototype.setFormulaByName=function(t,e){},e.prototype.refresh=function(){this.kj.repaint()},e.prototype.toJSON=function(t,e,o,n,r){var i,a,s,l,u,c,f,p,d,g,m,y,C,b,w,T=e,S=t.data||{},x=!0,A=this.Cf();for(A.UIc=!0,c=0;c<=o;c++)if(i=S.dataTable||{},a=T[c]){for(x=!(l=i[c]),l=l||{},f=0;f<=n;f++)if((s=a[f])&&s.Lf){u=l[f]||{};try{d=O(p=A.unparse(this,s.Lf,c,f,!1,!0)),g=void 0,d&&(v(u.prefix)&&(u.prefix={}),p=(g=p).replace(/_xlpm\./g,"")),!s.Pf&&p&&0===p.indexOf("@")&&L(this.kj,p.slice(1,p.length),0,0)&&(p=p.slice(1,p.length),d&&(g=g.slice(1,g.length))),s.Pf?s.Pf.row===c&&s.Pf.col===f&&(u.arrayInfo=s.Pf,u.formula=p,d&&(u.prefix[d]=g)):(u.formula=p,d&&(u.prefix[d]=g)),x=!1,l[f]=u}catch(t){}}if(x){if(i!==S.dataTable)continue}else i[c]=l;S.dataTable=i}if(r){for(m=S.columnDataArray||[],y=0;y<r.length;y++)(C=r[y])&&C.Lf&&(b=this.Cf().unparse(this,C.Lf,0,y,!1,!0),(w=m[y]||{}).formula=b,m[y]=w);m.length>0&&(S.columnDataArray=m)}h(S)||(t.data=S),delete A.UIc},e}(s.CalcSource),e.SheetSource=M,M.prototype.getParserContext=function(t,e,o){return e=e||s.pf(0,0),new R(this.kj,t,e,o)},k=function(t){function e(e){var o=t.call(this,p)||this;return o.createSourceModel=function(t){return new s.CalcSourceModel(t,this)},o.Qu=e,o}return N(e,t),e.prototype.getCustomFunction=function(t){return this.Qu?this.Qu.getCustomFunction(t):p},e.prototype.getCustomName=function(t){var e=this.Qu?this.Qu.getCustomName(t)||this.Qu.aJb(t):p;return e?e.getExpression():p},e}(s.CalcSource),e.SpreadSource=k,e.formulaToExpression=D,e.expressionToFormula=function(t,e,o,r,i,a){var l,u=t&&t instanceof n.Worksheet&&t,c=new s.Parser;return o=o===d?0:o,r=r===d?0:r,(l=new R(u,!!i,s.pf(o,r))).YSa=a,c.unparse(l,e)},e.evaluateFormula=function(t,e,o,n,r){return o===d&&(o=0),n===d&&(n=0),F(t,D(t,e,o,n,r,!0),o,n)},e.evaluateExpression=F,e.rangeToExpression=E,e.rangeToFormula=function(t,e,o,n,r){var i=E(t,e,o,n),a=new R(p,!!r,s.pf(e,o)),l=(new s.Parser).unparse(a,i);return a.no(),l},e.rangeToFormulaWithStructReference=function(t,e,o,n,r,i,a){var l=E(e,o,n,r,a),u=new R(t,!!i,s.pf(o,n));return(new s.Parser).unparse(u,l)},e.formulaToRange=L,e.formulaToRanges=function(t,e,o,r,i){var l,u,c,f,p,g,m,y,C,b,w=[],T=[];if(!e)return w;for(l={},o=o||0,r=r||0,u=new s.Parser,c=a.qzb(u,e,t,o,r,d,i),f=0;f<c.length;f++)if((p=c[f].sheetRanges)&&!h(p))for(g=0;g<p.sheets.length;g++)for((T=l[m=p.sheets[g]])||(l[m]=T=[],w.push({sheetName:m,ranges:T})),y=p[m],C=0;C<y.length;C++)b=y[C],v(b)||T.push(new n.Range(b.row,b.col,b.rowCount,b.colCount));return w},e.rangesToFormula=function(t,e,o,n,r){var i=new s.Parser,a=new R(p,!!r,s.pf(e,o)),l=G(i,a,t,e,o,n);return a.no(),l},e.ALb=G,e.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},e.goalSeek=function(t,e,o,n,r,a,s){var l,u,c,f,h=n.getValue(e,o),p=!1,d=.01,g=(b(h)?+h:0)-s,m=n.getValue(r,a),y=(b(m)?+m:0)-s;if(b(m)&&Math.abs(y)<.001)p=!0;else if(C(m))p=!1;else for(l=g+(0===g?d:d*g),c=0;!p&&c<100;c++)l=i.Common.o.Lma(l,13),t.setValue(e,o,l),m=n.getValue(r,a),u=(b(m)?+m:0)-s,b(m)&&Math.abs(u)<.001?p=!0:C(m)?l=(g+l)/2:g-l==0?l=g+(0===g?d:d*g):y-u==0?l=g+2*(l-g):(f=l-u*(g-l)/(y-u),g=l,y=u,l=f);return p||t.setValue(e,o,h),p}},"./dist/plugins/sheetsCalc/calc.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BAND_INDEX_CONST=-2147483648,e.MAX_ROW_COUNT=1048576,e.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b;function w(t,e){var o,n,r,i;return e||(e=this),o=h(t.row,e.row),n=h(t.column,e.column),r=f(t.row+t.rowCount,e.row+e.rowCount),i=f(t.column+t.columnCount,e.column+e.columnCount),o>=r||n>=i?d:{row:o,column:n,rowCount:r-o,columnCount:i-n,intersectWith:w}}function T(t,e,o,n){return(!n||t<e)&&o}function S(t){return[t.row,t.col,t.rowCount,t.colCount].join(",")}function x(t,e,o,n){var r=t[e];r||(r=t[e]={}),r[o]=n}function A(t,e,o){var n=t[e];return!!n&&n[o]}function I(t,e,o,n,r,i,a,s,l,u,c,f){var h,p,d,g;return o>=0||!r?(h=n+(r?o:0),p=i+(a?o:0),d=c&&L(s,t,c),g=!c&&L(s,t,c),(d||g)&&(!f&&l+u<=o||f&&l<=o)&&(h-=r?u:0,p-=a?u:0),d=c&&L(s,e,c),g=!c&&L(s,e,c),(d||g)&&(!f&&l<=h||f&&(r&&o+n>=l||!r&&n>=l)?(h+=u,p+=u):(!f&&l<=p||f&&(a&&o+i>=l||!a&&i>=l))&&(p+=u)),h-=r?o:0,p-=a?o:0,f&&l+u<=o&&(h+=r?u:0,p+=a?u:0),{index:h,endIndex:p}):{index:n,endIndex:i}}function R(t,e,o,r,i,a,s,l,u,c,f,h){if(e&&!h){var p=u?i.row:i.column,d=u?i.rowRelative:i.columnRelative,m=void 0;if(u&&o>=0||!u&&r>=0||!d){if(c)m=I(t,e,u?o:r,p,d,-1,!1,a,s,l,u,f).index;else if(m=P(t,e,u?o:r,p,d,a,s,l,u,f),g(m))return n.Hh(m);m!==p&&(i=i.offset(u?m-p:0,u?0:m-p,!0))}}return i}function M(t,e,o,r,i,a,s,l,u,c,f,h){var p,d,m,y,C,v,b,w;if(e&&!h){if(3===(p=i.tf())||u&&2===p||!u&&1===p)return i;if(d=u?i.rowRelative:i.columnRelative,m=u?i.endRowRelative:i.endColumnRelative,y=u?i.row:i.column,C=u?i.endRow:i.endColumn,v=void 0,u&&o>=0||!u&&r>=0||!d||!m){if(c)v=I(t,e,u?o:r,y,d,C,m,a,s,l,u,f);else if(v=G(t,e,u?o:r,y,d,C,m,a,s,l,u,f),g(v))return n.Hh(v);b=v.index,w=v.endIndex,b===y&&w===C||(i=i.offset2(u?b-y:0,u?0:b-y,u?w-C:0,u?0:w-C,o,r))}}return i}function k(t,e,o,r,i,a,s,l,u,c,f,h){var g,m,y,C,v,b,w,T,S=k,x=r;if(r){if(1===r.type&&r.sf()||33===r.type)x=R(t,r.source||t,e,o,r,i,a,s,l,u,f,h);else if(1===r.type)x=M(t,r.source||t,e,o,r,i,a,s,l,u,f,h);else if(10===r.type)(g=S(t,e,o,r.value,i,a,s,l,u,p,f,h))!==r.value&&(x=n.Lh(g));else if(9===r.type)m=S(t,e,o,r.value,i,a,s,l,u,p,f,h),y=r.value2&&S(t,e,o,r.value2,i,a,s,l,u,p,f,h),m===r.value&&y===r.value2||(x=n.Kh(r.operatorType,m,y));else if(7===r.type){for(C=d,v=void 0,b=void 0,T=(w=r).arguments.length,b=0;b<T;b++)if((g=S(t,e,o,v=w.arguments[b],i,a,s,l,u,p,f,h))!==v){(C=[])[b]=g;break}if(C){for(b=0;b<T;b++)v=w.arguments[b],C[b]!==p&&C[b]!==d||(C[b]=S(t,e,o,v,i,a,s,l,u,p,f,h));x=n.Jh(w,C)}}else f||l||13!==r.type||(x=function(t,e,o,n,r,i,a,s,l){if(e&&r)return r.offsetWhenInsertRemoveColumn(a,s,l);return r}(0,t,0,0,r,0,a,s,u));return x}}function N(t,e,o,n,r,i,a,s,l,u){var c=t.getSheet(),f=c.uja&&(c.parent||c).tja(),h=c.ITa&&c.ITa.dUa();O(f,(function(r,i,a,s){return e.call(this,r,a,s,i,t,o,n,l,u)}),l,h)}function O(t,e,o,n){var r,i,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S;if(t)for(u=0;u<t.length;u++){for(c=!0,f=!0,h=a.maxRowCount-1,p=a.maxColumnCount-1,g=0,m=(d=(r=t[u].validator).n5).length;g<m&&(C=(y=d[g]).rowCount,v=y.colCount,s=y.row,l=y.col,-1!==C&&(f=!1,h=h>s?s:h),-1!==v&&(c=!1,p=p>l?l:p),c||f);g++);if(!(o&&f||!o&&c)&&(b=t[u].sheet.yj(),(w=(i=r.condition()).getExpressions())&&w.length>0)){for(T=0;T<w.length;T++)S=w[T],w[T]=e(b,S,h,p);i.setExpressions(w,n)}}}function D(t){var e=[],o=t.parent;return(o&&o.sheets||[t]).forEach((function(t){var o=t.conditionalFormats,n=o&&o.getRules();n&&n.length&&n.forEach((function(o){o.xyb&&e.push({rule:o,sheet:t})}))})),e}function F(t,e,o,n,r,i){var a=t.getSheet();E(D(a),(function(a,s,l,u){return e.call(this,a,l,u,s,t,o,n,r,i)}),a.ITa&&a.ITa.dUa(),r,i)}function E(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F;if(t)for(i=0,a=t.length;i<a;i++){if(l=(s=t[i].rule).ranges(),c=(u=y(l)).r,f=u.c,p=(h=t[i].sheet).yj(),d=s.condition(),(g=h.tables)&&l&&1===l.length&&(C=(m=l[0]).row,v=m.col,b=m.rowCount,w=m.colCount,T=void 0,r&&n?T=g.KFc(C,v,b,w):h.dJb&&h.zFc&&(T=[h.zFc]),T&&T.length)){for(S=!1,x=0,A=T.length;x<A;x++)if(R=(I=T[x]).row,M=I.col,k=I.rowCount,N=I.colCount,C===R&&b===k&&v>=M&&v+w<=M+N){S=!0;break}if(S)continue}if(d||(s.initCondition(),d=s.condition()),(O=d&&d.getExpressions())&&O.length>0){for(D=0;D<O.length;D++)F=O[D],O[D]=e(p,F,c,f);d.setExpressions(O,o)}}}function j(t,e,o){var n=t.getSheet();E(D(n),(function(t,n,r,i){return rt.call(this,t,r,i,n,e,o)}),n.ITa.dUa())}function P(t,e,o,n,r,i,a,s,l,u){var c,f,h,p,d;if(o>=0||!r){if(c=n+(r?o:0),f=l&&L(i,t,l),h=!l&&L(i,t,l),(f||h)&&a<=o&&(c+=r?s:0),f=l&&L(i,e,l),h=!l&&L(i,e,l),f||h)if(p=o+n,d=o+s+n,!u&&a+s<=c||u&&p>=a+s)c-=s;else if(!u&&a<=c||u&&p>=a&&a<=d&&d<=a+s)return m;return c-=r?o:0,u&&a<=o&&(c-=r?s:0),c}return n}function L(t,e,o){var n=o?{2:!0}:{1:!0};return t===e||t.kj===e.kj&&(3===t.Wz&&n[e.Wz]||n[t.Wz]&&3===e.Wz)}function G(t,e,o,n,r,i,a,s,l,u,c,f){var h,p,d,g,y,C,v;if(o>=0||!r){if(h=n+(r?o:0),p=i+(a?o:0),d=l+u-1,g=c&&L(s,t,c),y=!c&&L(s,t,c),(g||y)&&l<=o&&(h+=r?u:0,p+=a?u:0),g=c&&L(s,e,c),y=!c&&L(s,e,c),g||y)if(C=o+n,v=o+i,!f&&d<h||f&&d<C)h-=u,p-=u;else{if(!f&&l<=h&&d>=p||f&&l<=C&&d>=v)return m;!f&&l>p||f&&l>v||(!f&&d<=p||f&&d<=v?(h=!f&&l>=h||f&&l>=C?h:l,p-=u):p=l-1)}return h-=r?o:0,p-=a?o:0,f&&l<=o&&(h-=r?u:0,p-=r?u:0),{index:h,endIndex:p}}return{index:n,endIndex:i}}function B(t,e,o){var r,i,a,s,l,u,f,h,g,m,y,C,v,b,w,T=B,S=e;if(e)if(e.source)if(s=e.source,(l=e.endSource)&&s!==l){if(!(u=s.kj&&s.kj.parent))return n.Ih;l===o?(f=o.VDc,S.endSource=u.getSheet(f-1).yj()):s===o&&(h=o.VDc,S.source=u.getSheet(h).yj()),delete o.VDc,S.source===S.endSource&&delete S.endSource}else(t!==o&&s===o||t===o&&s!==o)&&(S=n.Ih);else if(10===e.type)(r=T(t,e.value,o))!==e.value&&(S=n.Lh(r));else if(9===e.type)g=T(t,e.value,o),m=e.value2&&T(t,e.value2,o),g===e.value&&m===e.value2||(S=n.Kh(e.operatorType,g,m));else if(7===e.type){for(y=d,C=e.arguments.length,a=0;a<C;a++)if((r=T(t,i=e.arguments[a],o))!==i){(y=[])[a]=r;break}if(y){for(a=0;a<C;a++)i=e.arguments[a],y[a]!==p&&y[a]!==d||(y[a]=T(t,i,o));S=n.Jh(e,y)}}else 8===e.type&&(v=t||o,b=c(e.value),(w=v.getCustomName(b))&&w.source?s=w.source:(w=(v.Af.getGlobalSourceModel()||v.getCalcSourceModel()).getSource().getCustomName(b))&&w.source&&(s=w.source),s&&(t!==o&&s===o||t===o&&s!==o)&&(S=n.Ih));return S}function _(t,e,o,n,r){return B(t,n,r)}function V(t,e,o,r,i,a,s,l){return s?n.BLb(l,t,e,o,r,i,a):n.rf(t,e,o,r,i,a)}function H(t,e){if(!(e=t.getIntersect(e,0,0)))return d;var o=t.row,n=t.col,r=t.rowCount,i=t.colCount;return t.rowCount===e.rowCount&&t.colCount===e.colCount||(t.rowCount===e.rowCount?(t.col===e.col&&(n=t.col+e.colCount),i=t.colCount-e.colCount):t.colCount===e.colCount&&(t.row===e.row&&(o=t.row+e.rowCount),r=t.rowCount-e.rowCount)),s.kf(o,n,r,i)}function z(t,e,o,n){var r,i=H(t,e);return i?(r=i.union(o),n?(r.col=t.col,r.colCount=t.colCount):(r.row=t.row,r.rowCount=t.rowCount)):r=o,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function U(t,e,o,n,r){var i,a=H(t,e),s=t.getIntersect(e,0,0);return s?(s.row+=n,s.col+=r,{startRow:(i=a?a.union(s):o).row,endRow:i.row+i.rowCount-1,startColumn:i.col,endColumn:i.col+i.colCount-1}):d}function W(t,e){var o=t.row,n=t.col,r=t.rowCount,i=t.colCount,a=e.row,s=e.col,l=e.rowCount,u=e.colCount;return 1===r&&1!==i?s<n&&n<=s+u-1||s<=n+i-1&&n+i-1<s+u-1:1!==i||1===r||a<o&&o<=a+l-1||a<=o+r-1&&o+r-1<a+l-1}function q(t,e,o,n,r,i){var a,l,u,c,f=function(t,e,o){var n=t.getRange(e,o);return s.kf(n.row,n.col,n.rowCount,n.colCount)}(n,r,i),h=f.row,p=f.row+f.rowCount-1,d=f.col,g=f.col+f.colCount-1,m=t.Vj,y=m+t.Xj-1,C=t.Wj,v=C+t.Yj-1,b=t.Tj,w=t.Uj,T=s.kf(m,C,t.Xj,t.Yj),S=s.kf(b,w,t.Xj,t.Yj),x=f.getIntersect(S,0,0);if(function(t,e,o,n,r){var i;return!(!e||!t||(i=e.getIntersect(t,0,0),(i||!e.getIntersect(o,0,0))&&(!i||i.rowCount!==e.rowCount||0===r)&&(!i||i.colCount!==e.colCount||0===n)))}(T,f,S,e,o))if(u=void 0,c=void 0,l=0!==e)if(c=p>=m&&p<=y,(u=h>=m&&h<=y)&&c)h+=e,p+=e;else if(u&&!c)if(e<=0)h+=e;else if(m+e>p);else{if(!(y+e<p))return U(f,T,S,e,o);if(m===h)return z(f,T,S,l);h+=e}else if(!u&&c)if(e>=0)p+=e;else if(y+e<h);else{if(!(b>h))return U(f,T,S,e,o);if(y===p)return z(f,T,S,l);p+=e}else x&&!x.equals(S)&&W(f,S)&&(h=(a=H(f,x)).row,p=a.row+a.rowCount-1,d=a.col,g=a.col+a.colCount-1);else if(c=g>=C&&g<=v,(u=d>=C&&d<=v)&&c)d+=o,g+=o;else if(u&&!c)if(o<0)d+=o;else if(C+o>g);else{if(!(v+o<g))return U(f,T,S,e,o);if(C===d)return z(f,T,S,l);d+=o}else if(!u&&c)if(o>0)g+=o;else if(v+o<d);else{if(!(w>d))return U(f,T,S,e,o);if(v===g)return z(f,T,S,l);g+=o}else x&&!x.equals(S)&&W(f,S)&&(h=(a=H(f,x)).row,p=a.row+a.rowCount-1,d=a.col,g=a.col+a.colCount-1);return{startRow:h,endRow:p,startColumn:d,endColumn:g}}function J(t,e,o,n){return o>e||o+n-1<t}function X(t,e,o,n){return o<=t&&o+n-1>=e}function Z(t,e,o,n){return o>t&&o+n-1<e}function Y(t,e,o,n){return o===t&&o+n-1<e||o>t&&o+n-1===e}function K(t,e,o,n){return o<t&&o+n-1>=t&&o+n-1<e||o>t&&o<=e&&o+n-1>e}function Q(t,e,o,n,r){return o<=t&&r<=t||o+n-1>=e&&r+n-1>=e}function $(t,e,o,n,r){var i,a,s=[J,X,Z,Y,K];for(a=0;a<s.length;a++)if(s[a](t,e,o,n)){i=a+"_";break}if(o===r)i+="9";else for(a=0;a<s.length;a++)if(o!==r&&s[a](t,e,r,n)){i+=a;break}return i}function tt(t,e,o,r,i,a,s,u,c){return l(a)&&(a=e.startRow),l(s)&&(s=e.startColumn),l(u)&&(u=e.endRow),l(c)&&(c=e.endColumn),n.uf(i||t.source,d,t.rowRelative?a-o:a,t.columnRelative?s-r:s,t.endRowRelative?u-o:u,t.endColumnRelative?c-r:c,t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative,o,r)}function et(t,e,o,r,i){var a,s,l,u,c,p,g,m,y,C,v=function(t,e,o,n,r){return t===r.Qj&&r.Tj<=e&&e<=r.Xj+r.Tj-1&&r.Uj<=o&&o<=r.Yj+r.Uj-1&&(e=e+r.Vj-r.Tj,o=o+r.Wj-r.Uj),{startRow:n.row+(n.rowRelative?e:0),endRow:n.endRow+(n.endRowRelative?e:0),startColumn:n.column+(n.columnRelative?o:0),endColumn:n.endColumn+(n.endColumnRelative?o:0)}}(t,e,o,r,i),w=r.source||t;if(i.Rj===w&&i.Qj===w)switch(a=$(v.startRow,v.endRow,i.Vj,i.Xj,i.Tj),s=$(v.startColumn,v.endColumn,i.Wj,i.Yj,i.Uj),l=a+"-"+s,u=i.Tj-i.Vj,c=i.Uj-i.Wj,p=function(t,e,o,n,r){return{row:h(t.startRow,e),col:h(t.startColumn,o),endRow:f(t.endRow,n),endCol:f(t.endColumn,r)}}(v,i.Vj,i.Wj,i.Vj+i.Xj-1,i.Wj+i.Yj-1),g=void 0,m=void 0,y=void 0,C=void 0,l){case b.outToCover+"-"+b.outToCover:case b.crossToCover+"-"+b.outToCover:case b.outToCover+"-"+b.crossToCover:case b.crossToCover+"-"+b.crossToCover:case b.coverToCover+"-"+b.outToCover:case b.outToCover+"-"+b.coverToCover:case b.coverNoMove+"-"+b.outToCover:case b.outToCover+"-"+b.coverNoMove:return n.Ih;case b.outToCross+"-"+b.outToCover:case b.coverToCross+"-"+b.outToCover:case b.insideToCross+"-"+b.outToCover:case b.partToCross+"-"+b.outToCover:case b.crossToCross+"-"+b.outToCover:case b.crossNoMove+"-"+b.outToCover:case b.outToCross+"-"+b.coverNoMove:case b.outToCross+"-"+b.coverToCover:case b.outToCross+"-"+b.crossToCover:case b.insideToCross+"-"+b.coverNoMove:case b.insideToCross+"-"+b.coverToCover:case b.insideToCross+"-"+b.crossToCover:return i.Tj<=v.startRow?tt(r,v,e,o,d,i.Tj+i.Xj):tt(r,v,e,o,d,d,d,i.Tj-1);case b.outToCover+"-"+b.outToCross:case b.outToCover+"-"+b.coverToCross:case b.outToCover+"-"+b.insideToCross:case b.outToCover+"-"+b.partToCross:case b.outToCover+"-"+b.crossToCross:case b.outToCover+"-"+b.crossNoMove:case b.coverNoMove+"-"+b.outToCross:case b.coverToCover+"-"+b.outToCross:case b.crossToCover+"-"+b.outToCross:case b.coverNoMove+"-"+b.insideToCross:case b.coverToCover+"-"+b.insideToCross:case b.crossToCover+"-"+b.insideToCross:return i.Uj<v.startColumn?tt(r,v,e,o,d,d,i.Uj+i.Yj):tt(r,v,e,o,d,d,d,d,i.Uj-1);case b.partToOut+"-"+b.coverNoMove:case b.crossToOut+"-"+b.coverNoMove:if(!Q(v.startRow,v.endRow,i.Vj,i.Xj,i.Tj))return tt(r,v,e,o);case b.coverNoMove+"-"+b.partToOut:case b.coverNoMove+"-"+b.crossToOut:if(a===b.coverNoMove&&!Q(v.startColumn,v.endColumn,i.Wj,i.Yj,i.Uj))return tt(r,v,e,o);case b.crossToInside+"-"+b.coverNoMove:case b.coverNoMove+"-"+b.crossToInside:return v.startRow>=i.Vj&&s===b.coverNoMove||v.startColumn>=i.Wj&&a===b.coverNoMove?tt(r,v,e,o,d,p.row+u,p.col+c):tt(r,v,e,o,d,d,d,p.endRow+u,p.endCol+c);case b.partToInside+"-"+b.coverNoMove:return v.startRow>=i.Vj?tt(r,v,e,o,d,f(p.row+u,p.endRow+1)):tt(r,v,e,o,d,d,d,h(p.endRow+u,p.row-1));case b.coverNoMove+"-"+b.partToInside:return v.startColumn>=i.Wj&&a===b.coverNoMove?tt(r,v,e,o,d,d,f(p.col+c,p.endCol+1)):tt(r,v,e,o,d,d,d,d,h(p.endCol+c,p.col-1));case b.partToCross+"-"+b.coverNoMove:case b.crossToPart+"-"+b.coverNoMove:case b.crossToCross+"-"+b.coverNoMove:if(Q(v.startRow,v.endRow,i.Vj,i.Xj,i.Tj))return v.startRow>=i.Vj?tt(r,v,e,o,d,p.row+u):tt(r,v,e,o,d,d,d,p.endRow+u);case b.crossToCover+"-"+b.coverNoMove:case b.partToPart+"-"+b.coverNoMove:return i.Vj<i.Tj?tt(r,v,e,o,d,f(p.row+u,p.endRow+1),d,p.endRow+u):tt(r,v,e,o,d,p.row+u,d,h(p.endRow+u,p.row-1));case b.coverNoMove+"-"+b.partToCross:case b.coverNoMove+"-"+b.crossToPart:case b.coverNoMove+"-"+b.crossToCross:if(Q(v.startColumn,v.endColumn,i.Wj,i.Yj,i.Uj))return v.startColumn>=i.Wj?tt(r,v,e,o,d,d,p.col+c):tt(r,v,e,o,d,d,d,d,p.endCol+c);case b.coverNoMove+"-"+b.crossToCover:case b.coverNoMove+"-"+b.partToPart:return i.Wj<i.Uj?tt(r,v,e,o,d,d,f(p.col+c,p.endCol+1),d,p.endCol+c):tt(r,v,e,o,d,d,p.col+c,d,h(p.endCol+c,p.col-1));case b.crossToCross+"-"+b.coverToCover:case b.crossToPart+"-"+b.coverToCover:case b.partToCross+"-"+b.coverToCover:if(Q(v.startRow,v.endRow,i.Vj,i.Xj,i.Tj))return tt(r,v,e,o);case b.coverToCover+"-"+b.crossToCross:case b.coverToCover+"-"+b.crossToPart:case b.coverToCover+"-"+b.partToCross:if(a===b.coverToCover&&Q(v.startColumn,v.endColumn,i.Wj,i.Yj,i.Uj))return tt(r,v,e,o);case b.coverToCover+"-"+b.partToPart:case b.partToPart+"-"+b.coverToCover:case b.coverToCover+"-"+b.crossToCover:case b.crossToCover+"-"+b.coverToCover:return tt(r,v,e,o,d,p.row+u,p.col+c,p.endRow+u,p.endCol+c);case b.partToPart+"-"+b.crossToCover:case b.partToCross+"-"+b.crossToCover:case b.crossToPart+"-"+b.crossToCover:case b.crossToCross+"-"+b.crossToCover:return Q(v.startRow,v.endRow,i.Vj,i.Xj,i.Tj)?tt(r,v,e,o):(p.row===v.startRow?p.col===v.startColumn?(y=v.endColumn,C=p.col+c,g=p.endRow+u,m=p.row+u):(y=v.startColumn,C=p.endCol+c,g=a===b.partToCross||a===b.crossToCross?i.Vj+u-1:v.endRow,m=v.startRow):p.col===v.startColumn?(y=v.endColumn,C=p.col+c,g=v.endRow,m=a===b.partToCross||a===b.crossToCross?i.Vj+i.Xj-1+u+1:v.startRow):(y=v.startColumn,C=p.endCol+c,g=a===b.partToCross||a===b.crossToCross?p.row+u:v.startRow,m=p.endRow+u),tt(r,v,e,o,d,f(g,m),f(y,C),h(g,m),h(y,C)));case b.crossToCover+"-"+b.partToPart:case b.crossToCover+"-"+b.partToCross:case b.crossToCover+"-"+b.crossToPart:case b.crossToCover+"-"+b.crossToCross:return Q(v.startColumn,v.endColumn,i.Wj,i.Yj,i.Uj)?tt(r,v,e,o):(p.row===v.startRow?p.col===v.startColumn?(y=p.endCol+c,C=p.col+c,g=v.endRow,m=p.row+u):(y=v.endColumn,C=s===b.partToCross||s===b.crossToCross?i.Wj+i.Yj-1+c+1:v.startColumn,g=v.endRow,m=p.row+u):p.col===v.startColumn?(y=v.startColumn,C=s===b.partToCross||s===b.crossToCross?i.Wj+c-1:v.endColumn,g=p.endRow+u,m=v.startRow):(y=s===b.partToCross||s===b.crossToCross?p.col+c:v.startColumn,C=p.endCol+c,g=v.startRow,m=p.endRow+u),tt(r,v,e,o,d,f(g,m),f(y,C),h(g,m),h(y,C)));case b.coverToOut+"-"+b.coverToOut:case b.coverToOut+"-"+b.coverToCross:case b.coverToOut+"-"+b.coverToCover:case b.coverToOut+"-"+b.coverNoMove:case b.coverToCross+"-"+b.coverToOut:case b.coverToCross+"-"+b.coverToCross:case b.coverToCross+"-"+b.coverToCover:case b.coverToCross+"-"+b.coverNoMove:case b.coverToCover+"-"+b.coverToOut:case b.coverToCover+"-"+b.coverToCross:case b.coverToCover+"-"+b.coverToCover:case b.coverToCover+"-"+b.coverNoMove:case b.coverNoMove+"-"+b.coverToOut:case b.coverNoMove+"-"+b.coverToCross:case b.coverNoMove+"-"+b.coverToCover:return tt(r,v,e,o,d,v.startRow+u,v.startColumn+c,v.endRow+u,v.endColumn+c);default:return tt(r,v,e,o)}}function ot(t,e,o,r,i,a,s,l){var u,c,f,h,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E=!!r.source,j=E?r.source:t,P=a&&a.isDataValidator,L=function(t,e){return t.Qj===t.Rj&&e!==t.Qj}(i,t),G=!1,B=r.rowRelative,_=r.columnRelative,V=r.endRowRelative,H=r.endColumnRelative;if(e>=0||!B||!V||o>=0||!_||!H){if(u=r.row+(B?e:0),c=r.endRow+(V?e:0),f=r.column+(_?o:0),g=c-u+1,m=(h=r.endColumn+(H?o:0))-f+1,!P&&L){if(i.Sj(i.Rj,u,f,g,m))return r.offset(s,l,!0);if(i.Pj(j,u,f,g,m))return n.Ih;if(j!==i.Rj||j!==i.Qj||0!==s&&0!==l)return r;G=!0}if(a&&a.isNameID||t===i.Rj&&(t===i.Qj?b=i.Pj(i.Qj,e,o,1,1):(w=e,T=o,a&&a.crossSheetMoved&&(w-=s,T-=l),b=i.Sj(i.Rj,w,T,1,1))),(G||t===j&&t===i.Rj&&t===i.Qj)&&(S=e,x=o,b&&(S-=s,x-=l),0===s||0===l)){if(!(A=q(i,s,l,r,S,x)))return n.Ih;if(0===l&&s&&A.endColumn>=h&&A.startColumn<=f||0===s&&l&&A.endRow>=c&&A.startRow<=u)return I=A.startRow,R=A.startColumn,M=A.endRow,k=A.endColumn,I===u&&M===c&&R===f&&k===h?r:(B&&(I-=e),V&&(M-=e),_&&(R-=o),H&&(k-=o),n.uf(r.source,d,I,R,M,k,B,_,V,H,e,o))}if(b&&(N=i.Tj-i.Vj,O=i.Uj-i.Wj,g+=(B?-N:0)+(V?N:0),m+=(_?-O:0)+(H?O:0)),j===i.Qj&&i.Pj(j,u,f,g,m)&&!m&&(!B&&!_&&!V&&!H||!b))return n.Ih;if(v=(E&&j===i.Rj||!E&&t===i.Rj)&&(!b&&i.Sj(i.Rj,u,f,g,m)||b&&i.Pj(i.Qj,B?u:u+s,_?f:f+l,g,m)),b&&(u-=B?s:0,c-=V?s:0,f-=_?l:0,h-=H?l:0),D=!1,v)u+=y=s,c+=y,f+=C=l,h+=C;else if(i.Pj(j,u,f,g,m)){if(!(F=i.intersectWith(j,u,f,g,m))||F.rowCount!==g&&F.colCount!==m)return n.Ih;u=F.row+s,f=F.col+l,c=u+F.rowCount,h=f+F.colCount,D=!0}if(u-=B?e:0,c-=V?e:0,f-=_?o:0,h-=H?o:0,i.Rj===i.Qj?j=E?r.source:p:(j=r.source,v&&b&&E?j=i.Qj:v&&b||(v?j=i.Qj:b&&!E&&(j=i.Rj))),u!==r.row||f!==r.column||c!==r.endRow||h!==r.endColumn||D||j!==r.source)return n.uf(j,d,u,f,c,h,B,_,V,H,e,o)}else if(!(e>=0)&&B&&V||-1!==o){if(-1===e&&(o>=0||!_||!H)){if((f=r.column+(_?o:0))>(h=r.endColumn+(H?o:0)))return n.Ih;if(i.Pj(t,e,o,1,1)&&(f-=_?l:0,h-=H?l:0),m=h-f+1,i.Sj(j,-1,f,-1,m))f+=C=l,h+=C;else if(i.Pj(j,-1,f,-1,m))return n.Ih;if(h-=H?o:0,(f-=_?o:0)!==r.column||h!==r.endColumn)return n.uf(r.source,d,r.row,f,r.endRow,h,r.rowRelative,_,r.endRowRelative,H,e,o)}}else{if((u=r.row+(B?e:0))>(c=r.endRow+(V?e:0)))return n.Ih;if(i.Pj(t,e,o,1,1)&&(u-=B?s:0,c-=V?s:0),g=c-u+1,i.Sj(j,u,-1,g,-1))u+=y=s,c+=y;else if(i.Pj(j,u,-1,g,-1))return n.Ih;if(c-=V?e:0,(u-=B?e:0)!==r.row||c!==r.endRow)return n.uf(r.source,d,u,r.column,c,r.endColumn,B,r.columnRelative,V,r.endColumnRelative,e,o)}}function nt(t,e,o,r,a,s){var l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P=!!r.source?r.source:t,L=r.tf(),G=e,B=o,_=a.Qj.kj;if(s&&s.isCustomName&&(y=r.row,C=r.column,G=a.Tj+(y-a.Vj)+_.MLc(a.Tj,y-a.Vj+1,!0),B=a.Uj+(C-a.Wj)+_.MLc(a.Uj,C-a.Wj+1)),v=a.Nj(G),b=a.Oj(B),0===L){if(w=!a.aYc&&et(t,e,o,r,a))return w;if(w=ot(t,e,o,r,a,s,v,b))return w}else if(1===L){if(l=r.rowRelative,c=r.endRowRelative,e>=0||!l||!c){if((h=r.row+(l?e:0))>(p=r.endRow+(c?e:0)))return n.Ih;if(m=t===a.Rj&&t===a.Qj&&a.Pj(a.Qj,e,o,1,1),P===a.Rj&&P===a.Qj&&0===a.Wj&&0===a.Uj&&a.Yj===P.getColumnCount()){if(T=a.Vj,S=a.Tj,m&&(h-=v,p-=v),A=T+(x=a.Xj),R=p>=T&&A>p,(I=h>=T&&A>h)&&R)return m?r:r.offset(v,b,!0);if(M=S+x,I&&S<=p?(h+=v,M>p&&p>=S&&(p=M-1,h=A)):R&&M>=h&&(p+=v,S<=h&&d<M&&(h=S,p=T-1)),p-=c?e:0,(h-=l?e:0)!==r.row||p!==r.endRow)return n.uf(r.source,r.endSource,h,i.BAND_INDEX_CONST,p,i.BAND_INDEX_CONST,l,u,c,f,e,o)}if(m)return r.offset(-v,b,!0)}}else if(2===L){if(u=r.columnRelative,f=r.endColumnRelative,(d=r.column+(u?o:0))>(g=r.endColumn+(f?o:0)))return n.Ih;if(m=t===a.Rj&&t===a.Qj&&a.Pj(a.Qj,e,o,1,1),P===a.Rj&&P===a.Qj&&0===a.Vj&&0===a.Tj&&a.Xj===P.getRowCount()){if(k=a.Wj,N=a.Uj,m&&(d-=b,g-=b),D=k+(O=a.Yj),E=g>=k&&D>g,(F=d>=k&&D>d)&&E)return m?r:r.offset(v,b,!0);if(j=N+O,F&&N<=g?(d+=b,j>g&&g>=N&&(g=j-1,d=D)):E&&j>=d&&(g+=b,N<=d&&d<j&&(d=N,g=k-1)),g-=f?o:0,(d-=u?o:0)!==r.column||g!==r.endColumn)return n.uf(r.source,r.endSource,i.BAND_INDEX_CONST,d,i.BAND_INDEX_CONST,g,l,u,c,f,e,o)}if(m)return r.offset(v,-b,!0)}return r}function rt(t,e,o,r,i,a,s){var l,u,c,f,h,g,m,y=rt,C=r;if(1===r.type&&r.sf()||33===r.type)C=a?function(t,e,o,r,i,a){var s,l,u,c,f,h,p,g,m,y,C,v,b=!!r.source,w=r.source||t,T=r.rowRelative,S=r.columnRelative,x=e,A=o,I=i.Qj.kj;if(a&&a.isCustomName&&(f=r.row,h=r.column,x=i.Tj+(f-i.Vj)+I.MLc(i.Tj,f-i.Vj+1,!0),A=i.Uj+(h-i.Wj)+I.MLc(i.Uj,h-i.Wj+1)),p=i.Nj(x),g=i.Oj(A),y=(m=33===r.type)&&r.contextSource,(e>=0||!T)&&(o>=0||!S)){if(s=r.row+(T?e:0),l=r.column+(S?o:0),a&&a.isNameID||t===i.Rj&&(t===i.Qj?c=i.Pj(i.Qj,e,o,1,1):(C=e,v=o,a&&a.crossSheetMoved&&(C-=p,v-=g),c=i.Sj(i.Rj,C,v,1,1))),w===i.Qj&&i.Pj(w,s,l,1,1)&&!i.Sj(w,s,l,1,1)&&(!T&&!S||!c))return n.Ih;if(u=(b&&w===i.Rj||!b&&t===i.Rj)&&(!c&&i.Sj(i.Rj,s,l,1,1)||c&&i.Pj(i.Qj,T?s:s+p,S?l:l+g,1,1)),c&&(s-=T?p:0,l-=S?g:0),u&&(s+=p,l+=g),s-=T?e:0,l-=S?o:0,w=r.source,i.Rj!==i.Qj&&(u&&c?b&&(w=i.Qj):u?w=i.Qj:c&&!b&&(w=i.Rj)),s!==r.row||l!==r.column||w!==r.source)return V(w,d,s,l,T,S,m,y)}else if((e>=0||!T)&&-1===o){if(s=r.row+(T?e:0),i.Pj(t,e,o,1,1)&&(s-=T?p:0),i.Sj(w,s,-1,1,-1))s+=p;else if(i.Pj(w,s,-1,1,-1))return n.Ih;if((s-=T?e:0)!==r.row)return V(r.source,d,s,r.column,T,r.columnRelative,m,y)}else if(-1===e&&o>=0&&!S){if(l=r.column+(S?o:0),i.Pj(t,e,o,1,1)&&(l-=S?g:0),i.Sj(w,s,l,1,1))l+=g;else if(i.Pj(w,s,l,1,1))return n.Ih;if(l-=S?o:0,s!==r.row||l!==r.column)return V(r.source,r.endSource,r.row,l,r.rowRelative,S,m,y)}return r}(t,e,o,r,i,s):function(t,e,o,n,r){var i,a,s=n.source||t,l=n.rowRelative,u=n.columnRelative,c=r.Nj(e),f=r.Oj(o),h=33===n.type,p=h&&n.contextSource;if((e>=0||!l)&&(o>=0||!u)){if(i=n.row+(l?e:0),a=n.column+(u?o:0),r.Pj(t,e,o,1,1)?(i-=l?c:0,a-=u?f:0):r.Sj(t,i,a,1,1)&&(i+=l?c:0,a+=u?f:0),r.Sj(s,i,a,1,1)?(i+=c,a+=f):r.Pj(s,i,a,1,1)&&(i-=c,a-=f),a-=u?o:0,(i-=l?e:0)!==n.row||a!==n.column)return V(n.source,d,i,a,l,u,h,p)}else if((e>=0||!l)&&-1===o){if(i=n.row+(l?e:0),r.Pj(t,e,-1,1,-1)?i-=l?c:0:r.Sj(t,i,-1,1,-1)&&(i+=l?c:0),r.Sj(s,i,-1,1,-1)?i+=c:r.Pj(s,i,-1,1,-1)&&(i-=c),(i-=l?e:0)!==n.row||a!==n.column)return V(n.source,d,i,n.column,l,n.columnRelative,h,p)}else if(-1===e&&o>=0&&!u&&(a=n.column+0,r.Pj(t,-1,o,-1,1)?a-=0:r.Sj(t,-1,a,-1,1)&&(a+=0),r.Sj(s,-1,a,-1,1)?a+=f:r.Pj(s,-1,a,-1,1)&&(a-=f),a-=0,i!==n.row||a!==n.column))return V(n.source,d,n.row,a,n.rowRelative,u,h,p);return n}(t,e,o,r,i);else if(1===r.type)C=a?nt(t,e,o,r,i,s):at(t,e,o,r,i);else if(10===r.type)(l=y(t,e,o,r.value,i,a,s))!==r.value&&(C=n.Lh(l));else if(9===r.type)u=y(t,e,o,r.value,i,a,s),c=r.value2&&y(t,e,o,r.value2,i,a,s),u===r.value&&c===r.value2||(C=n.Kh(r.operatorType,u,c));else if(7===r.type){for(f=d,h=void 0,g=void 0,m=r.arguments.length,g=0;g<m;g++)if((l=y(t,e,o,h=r.arguments[g],i,a,s))!==h){(f=[])[g]=l;break}if(f){for(g=0;g<m;g++)h=r.arguments[g],f[g]!==p&&f[g]!==d||(f[g]=y(t,e,o,h,i,a,s));C=n.Jh(r,f)}}return C}function it(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d=e.Rj.getSheet().ITa.dUa();for(n=0;n<t.length;n++)if(i=(r=t[n].validator).n5,s=(a=y(i)).r,l=a.c,u=t[n].sheet.yj(),(f=(c=r.condition()).getExpressions())&&f.length>0){for(h=0;h<f.length;h++)p=f[h],f[h]=rt(u,s,l,p,e,o,{isDataValidator:!0});c.setExpressions(f,d)}}function at(t,e,o,r,a){var s,l,u,c,f,h,p,g,m,y,C,v,b=r.source||t,w=r.tf(),T=a.Nj(e),S=a.Oj(o);if(0===w){if(p=r.rowRelative,g=r.columnRelative,m=r.endRowRelative,y=r.endColumnRelative,!(e>=0)&&p&&m||!(o>=0)&&g&&y)if(!(e>=0)&&p&&m||-1!==o){if(-1===e&&(o>=0||!g||!y)){if((u=r.column+(g?o:0))<(c=r.endColumn+(y?o:0)))return n.Ih;if(a.Pj(t,-1,o,-1,1)?(u-=g?S:0,c-=y?S:0):a.Sj(t,-1,o,-1,1)&&(u+=g?S:0,c+=y?S:0),h=c-u,a.Sj(b,-1,u,-1,h)?(u+=v=S,c+=v):a.Pj(b,-1,u,-1,h)&&(u-=v=S,c-=v),c-=y?o:0,(u-=g?o:0)!==r.column||c!==r.endColumn)return n.uf(r.source,d,u,r.endRow,c,r.rowRelative,g,r.endRowRelative,y,e,o)}}else{if((s=r.row+(p?e:0))<(l=r.endRow+(m?e:0)))return n.Ih;if(a.Pj(t,e,-1,1,-1)?(s-=p?T:0,l-=p?T:0):a.Sj(t,e,-1,1,-1)&&(s+=p?T:0,l+=p?T:0),f=l-s,a.Sj(b,s,-1,f,-1)?(s+=C=T,l+=C):a.Pj(b,s,-1,f,-1)&&(s-=C=T,l-=C),l-=m?e:0,(s-=p?e:0)!==r.row||l!==r.endRow)return n.uf(r.source,d,s,r.column,l,r.endColumn,p,r.columnRelative,m,r.endColumnRelative,e,o)}else if(s=r.row+(p?e:0),l=r.endRow+(m?e:0),u=r.column+(g?o:0),f=l-s,h=(c=r.endColumn+(y?o:0))-u,a.Pj(t,e,o,1,1)?(s-=p?T:0,l-=m?T:0,u-=g?S:0,c-=y?S:0):a.Sj(t,s,u,f,h)&&(s+=p?T:0,l+=m?T:0,u+=g?S:0,c+=y?S:0),a.Sj(b,s,u,f,h)?(s+=C=T,l+=C,u+=v=S,c+=v):a.Pj(b,s,u,f,h)&&(s-=C=T,l-=C,u-=v=S,c-=v),l-=m?e:0,u-=g?o:0,c-=y?o:0,(s-=p?e:0)!==r.row||u!==r.column||l!==r.endRow||c!==r.endColumn)return n.uf(r.source,d,s,u,l,c,p,g,m,y,e,o)}else if(1===w){if(p=r.rowRelative,m=r.endRowRelative,e>=0||!p||!m){if((s=r.row+(p?e:0))<(l=r.endRow+(m?e:0)))return n.Ih;if(a.Pj(t,e,-1,1,-1)?(s-=p?T:0,l-=m?T:0):a.Sj(t,e,-1,1,-1)&&(s+=p?T:0,l+=m?T:0),f=l-s,a.Sj(b,s,-1,f,-1)?(s+=C=T,l+=C):a.Pj(b,s,-1,f,-1)&&(s-=C=T,l-=C),l-=m?e:0,(s-=p?e:0)!==r.row||l!==r.endRow)return n.uf(r.source,d,s,i.BAND_INDEX_CONST,l,i.BAND_INDEX_CONST,p,!1,m,!1,e,o)}}else if(2===w){if(g=r.columnRelative,y=r.endColumnRelative,(u=r.column+(g?o:0))>(c=r.endColumn+(y?o:0)))return n.Ih;if(a.Pj(t,-1,o,-1,1)?(u-=g?S:0,c-=y?S:0):a.Sj(t,-1,o,-1,1)&&(u+=g?S:0,c+=y?S:0),h=c-u,a.Sj(b,-1,u,-1,h)?(u+=v=S,c+=v):a.Pj(b,-1,u,-1,h)&&(u-=v=S,c-=v),c-=y?o:0,(u-=g?o:0)!==r.column||c!==r.endColumn)return n.uf(r.source,d,i.BAND_INDEX_CONST,u,i.BAND_INDEX_CONST,c,!1,g,!1,y,e,o)}return r}function st(t,e,o,n,r,i){t._g(e,o,n,r,!0,!1,i)}function lt(t,e,o){var r,i,a,s,l,u,c,f=lt,h=e;if(8===e.type){if(e.value===o&&(!e.source||e.source===t.getSource()))return n.Hh(m,e.source)}else if(10===e.type)(r=f(t,e.value,o))!==e.value&&(h=n.Lh(r));else if(9===e.type)s=f(t,e.value,o),l=e.value2&&f(t,e.value2,o),s===e.value&&l===e.value2||(h=n.Kh(e.operatorType,s,l));else if(7===e.type){for(u=d,c=e.arguments.length,a=0;a<c;a++)if((r=f(t,i=e.arguments[a],o))!==i){(u=[])[a]=r;break}if(u){for(a=0;a<c;a++)i=e.arguments[a],u[a]!==p&&u[a]!==d||(u[a]=f(t,i,o));h=n.Jh(e,u)}}return h}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-calc"),r=o("Common"),i=o("./dist/plugins/sheetsCalc/calc.ns.js"),a=o("./dist/plugins/sheetsCalc/parser-sheets.js"),s=o("Core"),l=r.Common.j.Fa,u=r.Common.u,c=u.Nb,f=Math.min,h=Math.max,p=void 0,d=null,g=n.Convert.vf,m=n.Errors.Reference,y=s.util.l_a,C=function(){function t(t,e,o,n,r,i,a,s){var l=this;l.Rj=t,l.Vj=e,l.Wj=o,l.Qj=n,l.Tj=r,l.Uj=i,l.Xj=a,l.Yj=s}return t.prototype.Nj=function(t){var e,o,n=this,r=n.Qj.kj;return n.aYc=r&&r.KLc(),n.aYc&&t>=0?(e=t-n.Tj+1,o=r.NLc(n.Tj,e,!0),n.Tj-n.Vj+o):n.Tj-n.Vj},t.prototype.Oj=function(t){var e,o,n=this,r=n.Qj.kj;return n.aYc=r&&r.KLc(),n.aYc&&t>=0?(e=t-n.Uj+1,o=r.NLc(n.Uj,e),n.Uj-n.Wj+o):n.Uj-n.Wj},t.prototype.Sj=function(t,e,o,n,r){var i=this;return i.Rj===t&&(-1===i.Vj||i.Vj<=e&&e+n<=i.Vj+i.Xj)&&(-1===i.Wj||i.Wj<=o&&o+r<=i.Wj+i.Yj)},t.prototype.Pj=function(t,e,o,n,r){var i=this,a=i.Qj.kj,s=a&&a.KLc(),l=i.Tj,u=i.Uj,c=i.Xj,f=i.Yj;return s&&(c+=a.MLc(l,c,!0),f+=a.MLc(u,f)),i.Qj===t&&(-1===l||l<=e&&e+n<=l+c)&&(-1===u||u<=o&&o+r<=u+f)},t.prototype.intersectWith=function(t,e,o,n,r){var i,a=this;return a.Qj!==t?d:(i=a.Zj(t,e,o,n,r),a.Zj(t,a.Vj,a.Wj,n,r).intersectWith(i))},t.prototype.Zj=function(t,e,o,n,r){return{row:-1===e?0:e,column:-1===o?0:o,rowCount:-1===e||-1===n?t.rowCount:n,columnCount:-1===o||-1===r?t.colCount:r,intersectWith:w}},t}(),e.MoveSwapInfo=C,v=function(){function t(){}return t.zj=function(e,o,r,a,s,l,u,c,h,p,d){var g,y,C,v,b,w,T=r,S=t,x=this.zj;if(!r)return T;if(10===(C=r.type))T=n.Lh(x.call(S,e,o,r.value,a,s,l,u,c,h,p,d));else if(1===C&&r.sf()||33===C){if(g=f((r.source||o).getRowCount(),i.MAX_ROW_COUNT),y=f((r.source||o).getColumnCount(),i.MAX_COLUMN_COUNT),r.rowRelative&&(r.row+a<0||r.row+a>=g)||r.columnRelative&&(r.column+s<0||r.column+s>=y))return n.Hh(m,r.source);T=r.offset(0,0,!1)}else if(1===C){if(g=f((r.source||o).getRowCount(),i.MAX_ROW_COUNT),y=f((r.source||o).getColumnCount(),i.MAX_COLUMN_COUNT),(v=r).rowRelative&&!r.isFullColumn&&(v.row+a<0||v.row+a>g)||v.columnRelative&&!r.isFullRow&&(v.column+s<0||v.column+s>y)||v.endRowRelative&&!r.isFullColumn&&(v.endRow+a<0||v.endRow+a>g)||v.endColumnRelative&&!r.isFullRow&&(v.endColumn+s<0||v.endColumn+s>y))return n.Hh(m,r.source,r.endSource);T=r.offset(0,0,!1,a,s)}else if(9===r.type)T=n.Kh(r.operatorType,x.call(S,e,o,r.value,a,s,l,u,c,h,p,d),r.value2&&x.call(S,e,o,r.value2,a,s,l,u,c,h,p,d));else if(7===C){if(b=[],r.arguments&&r.arguments.length>0)for(w=0;w<r.arguments.length;w++)b[w]=x.call(S,e,o,r.arguments[w],a,s,l,u,c,h,p,d);T=n.Jh(r,b)}else 13===C&&(T=r.offsetWhenCopy(e,o,a,s,l,u,c,h,p,d));return T},t.copyFormula=function(e,o,r,i,a,s,l,u,c,h){var d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K=e,Q=i,$=e.getSource(),tt=i.getSource(),et=t;if(K&&Q){for(d=tt&&tt.getSheet().ITa.dUa(),g=o,m=r,y=a,C=s,v=l,b=u,o<0&&(g=0,v=f(e.rC(),i.rC())),r<0&&(m=0,b=f(e.cC(),i.cC())),a<0&&(y=0),s<0&&(C=0),w=new n.CalcSourceModel(e.Cf(),$),I=tt.getSheet(),R=!h&&I.KLc(),M=v,k=b,N=I.getRowCount(),O=I.getColumnCount(),T=0;T<v;T++)for(S=0;S<b;S++)K.Uf(w,T+g,S+m,T,S);for(D={},F=i.Cf(),T=0,x=0;T<v&&T+y<N;T++)if(E=T+y,R&&0===I.getRowHeight(E))v++;else if(c&&tt.isHiddenRow(E,!0))x++;else{for(S=0,A=0,b=k;S<b&&S+C<O;S++)if(j=S+C,R&&0===I.getColumnWidth(j))b++;else{if(P=w.Kf(x,A)){if(P===D)continue;if(L=a+T-o-x,G=s+S-r-A,P=et.zj($,tt,P,E,j,L,G,a,s,M,k),B=w.Qf(x,A),tt){if(R&&B)continue;if(B&&!B.isDynamicArray){for(_=B.rowCount,V=B.colCount,(H=g-B.row)>0&&(_-=H),(z=v-T)<_&&(_=z),(U=m-B.col)>0&&(V-=U),(W=b-S)<V&&(V=W),q=0;q<_;q++)for(J=0;J<V;J++)w.Rf(T+q,S+J,D);i.setArrayFormula(E,j,_,V,F.unparse(tt,P,E,j),p,d)}else X=P?F.unparse(tt,P,E,j):p,tt.setFormula(E,j,X),(Z=w.Mf(x,A))&&(Y=new n.EvaluateContext(tt,n.pf(E,j),!1),Z=(Z=n.Mh(Y,P,!1,0,0))===P?p:Z),Q.ig(E,j,P,Z,B,d)}else Q.Rf(E,j,P),Q.Xf(E,j,B)}else Q&&Q.Kf(E,j)&&Q.ig(E,j,p,p,p,d);A++}x++}}},t.moveFormula=function(t,e,o,n,r,i,a,l){var u,c,h,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B=t.Bj(),_=n.Bj(),V=B.Cf();if(B&&_){for(u=n.getRowCount(),c=n.getColumnCount(),h=B.dUa(),g=_.dUa(),m=V.ih(),e<0&&(e=0,a=f(t.getRowCount(),u)),r<0&&(r=0),o<0&&(o=0,l=f(t.getColumnCount(),c)),i<0&&(i=0),y=!(t===n&&t.name()===n.name()),C=a,v=l,b=a,(T=n.KLc())&&(C+=n.MLc(r,a,!0),v+=n.MLc(i,l)),B.Sg(e,o,a,l),st(B,e,o,a,l),_.Sg(r,i,C,v),st(_,r,i,C,v),S=[],x=0;x<a;x++)for(A=0;A<l;A++)I=B.Kf(x+e,A+o),R=B.Qf(x+e,A+o),M=B.Mf(x+e,A+o),I?(S.push({Lf:I,Pf:R,Nf:M}),B.Sf(x+e,A+o,h)):S.push(d);for(D=y?{}:null,x=0,k=0;x<b&&x+r<u;x++)if(F=x+r,T&&0===n.getRowHeight(F))b++;else{for(A=0,N=0,w=l;A<w&&i+A<c;A++)if(E=A+i,T&&0===n.getColumnWidth(E))w++;else{if(j=S[k*l+N]){if(I=j.Lf,R=j.Pf,T&&R){N++;continue}V&&R&&!R.isDynamicArray&&R.row===e+x&&R.col===o+A&&(O=s.kf(F,E,R.rowCount,R.colCount)),P=R&&!R.isDynamicArray?O:p,M=j.Nf,_.FTa(g,F,E),_.Rf(F,E,I),_.Xf(F,E,P),_.Wf(F,E,M),y&&(D[F+", "+E]=I)}else _.FTa(g,F,E),_.Rf(F,E,p),_.Xf(F,E,p);N++}k++}m.Dj(B,e,o,a,l),m.Dj(_,r,i,C,v),G=(L=B.getSource().getSheet()).uja&&(L.parent||L).tja(),m.Ej(G,B.getSource(),e,o,_.getSource(),r,i,a,l,!0,D),!0===y&&m.Ej(G,B.getSource(),e,o,_.getSource(),r,i,a,l,!0,D)}},t.prototype.isAdjustCell=function(t){return t.preAdj||this.imb&&t===this.imb[0]},t.prototype.isAdjust=function(t){return t.preAdj||this.imb&&t===this.imb[0]},t.prototype.hh=function(t,e){var o,n,r=this;isNaN(e)||(r.imb||(r.imb={},r.jmb={}),o=r.imb[e],n=r.jmb[e],t&&!t.preAdj&&t!==o&&(o?n.nextAdj=t:r.imb[e]=t,t.preAdj=n,t.nextAdj=d,r.jmb[e]=t))},t.prototype.Fj=function(t,e){var o,n,r,i=this;isNaN(e)||(o=i.imb&&i.imb[e],t&&(t.preAdj||t===o)&&(n=t.preAdj,r=t.nextAdj,n?n.nextAdj=r:i.imb[e]=r,r?r.preAdj=n:i.jmb[e]=n,t.preAdj=d,t.nextAdj=d))},t.prototype.Gj=function(t,e,o,n,r,i,a){this.Hj(t,k,e,o,n,r,i,a);var s=0,l=0,u=0,c=0;0===e&&(n&&r?u=o:n?s=o:r?c=o:l=o),N(t,k,e,o,s,l,u,c,n,r),F(t,k,e,o,n,r)},t.prototype.Hj=function(t,e,o,n,r,i,a,s){var l,u,c,f,h,d,g,m,y,C,v,b,w,S,I,R,M,k,N,O=this,D=O.imb;if(D){for(m={};D[0];)if(g=(l=(h=D[0]).ah).dUa(),d=l.getSource(),A(m,u=h.row,c=h.column))O.Fj(h,0);else{if(f=l.Kf(u,c))if(f=e.call(O,d,u,c,f,t,o,n,r,i,p,a,s),y=l.Qf(u,c)){if(d===t&&(C=i?n:-n,r?o<=y.row&&(y.row+=C):o<=y.col&&(y.col+=C)),u===y.row&&c===y.col)if(y.isDynamicArray)l.fg(u,c,f,y,!0,T(r?u:c,o,g,t.id===d.id));else for(v=u;v<u+y.rowCount;v++)for(m[v]||(m[v]={}),b=c;b<c+y.colCount;b++)l.fg(v,b,f,y,v===u&&b===c,T(r?v:b,o,g,t.id===d.id)),x(m,v,b,!0)}else l.fg(u,c,f,y,!0,T(r?u:c,o,g,t.id===d.id));else(l.getRowExpression&&l.getRowExpression(u)||l.getColumnExpression&&l.getColumnExpression(c))&&l.Ag(u,c,1,1);O.Fj(h,0)}for(;D[1];)g=(l=(h=D[1]).ah).dUa(),u=h.row,l.getRowExpression&&((f=l.getRowExpression(u))&&l.fg&&(d=l.getSource(),l.fg(u,-1,e.call(O,d,u,-1,f,t,o,n,r,i),p,!0,T(u,o,g,t.id===d.id)))),O.Fj(h,1);for(;D[2];)g=(l=(h=D[2]).ah).dUa(),c=h.column,l.getColumnExpression&&((f=l.getColumnExpression(c))&&l.fg&&(d=l.getSource(),l.fg(-1,c,e.call(O,d,-1,c,f,t,o,n,r,i),p,!0,T(c,o,g,t.id===d.id)))),O.Fj(h,2);for(;D[3];)S=(w=D[3]).name,f=(l=w.ah).DTa(S),I=e.call(O,l.getSource(),0,0,f,t,o,n,r,i,{isNameID:!0}),l.gg(S,I),O.Fj(w,3);for(R in D)if((M=+R)>3&&D.hasOwnProperty(R))for(;D[R];)N=(k=D[R]).ah,f=e.call(O,N,0,0,k.expression,t,o,n,r,i),N.setExpression(k.id,k.name,f),O.Fj(k,M)}},t.prototype.ph=function(t){st(t.getCalcSourceModel(),0,0,t.getRowCount(),t.getColumnCount()),this.Hj(t,_),N(t,_,0,0,0,0,0,0,!0,!1),F(t,_,0,0,!0,!1)},t.prototype.Ej=function(t,e,o,n,r,i,a,s,l,u,c){var f,h,d,g,m,y,v,b,w,T,I,R,M,k,N,O,D,F,E,P,L,G,B=this,_=rt,V=new C(e,o,n,r,i,a,s,l),H={};if(t&&it(t,V,u),j(e,V,u),w={},v=B.imb){for(;v[0];)if(f=(h=v[0]).ah,d=h.row,g=h.column,y=f.dUa(),A(H,d,g))B.Fj(h,0);else{if(m=f.Kf(d,g),b=f.getSource(),m)if(T=p,c&&c[d+", "+g]&&(b=e,T={crossSheetMoved:!0}),m=_.call(B,b,d,g,m,V,u,T),R=void 0,(I=f.Qf(d,g))&&!I.isDynamicArray)if(R=S(I),d===I.row&&g===I.col)for(w[R]=!0,M=d;M<d+I.rowCount;M++)for(H[M]||(H[M]={}),k=g;k<g+I.colCount;k++)f.fg(M,k,m,I,M===d&&k===g,y),x(H,M,k,!0);else w[R]||(f.fg(d,g,m,I,!1,y),x(H,d,g,!0));else f.fg(d,g,m,I,!0,y);else(f.getRowExpression&&f.getRowExpression(d)||f.getColumnExpression&&f.getColumnExpression(g))&&f.Ag(d,g,1,1);B.Fj(h,0)}for(;v[1];)f=(h=v[1]).ah,d=h.row,y=f.dUa(),f.getRowExpression&&((m=f.getRowExpression(d))&&f.jg&&f.jg(d,_.call(B,b,d,-1,m,V,u),p,y)),B.Fj(h,1);for(;v[2];)f=(h=v[2]).ah,g=h.column,y=f.dUa(),f.getColumnExpression&&((m=f.getColumnExpression(g))&&f.kg&&f.kg(g,_.call(B,b,-1,g,m,V,u),p,y)),B.Fj(h,2);for(;v[3];)O=(N=v[3]).name,m=(f=N.ah).DTa(O),D=_.call(B,b,0,0,m,V,u),f.gg(O,D),B.Fj(N,3);for(F in v)if((E=+F)>3&&v.hasOwnProperty(F))for(;v[F];)G=(L=(P=v[F]).ah).getSource(),m=_.call(B,G,0,0,P.expression,V,u),L.setExpression(P.id,P.name,m),B.Fj(P,E)}},t.prototype.Dj=function(t,e,o,n,r){var i,a,s,l,u,c=e+n,f=o+r;for(s=e;s<c;s++)for(l=o;l<f;l++)i=t.Yf(s,l),a=t.Kf(s,l),(i||a)&&(this.Fj(i,0),t.Q3(s,l,0),u=t.qg(s,l,!0),this.hh(u,0))},t.prototype.Ij=function(t,e,o){var n,r;for(n=e;-1!==n&&n<e+o;n++)(t.Yf(-1,n)||t.Kf(-1,n))&&(t.Q3(-1,n,2),r=t.sg(n,!0),this.hh(r,2))},t.prototype.Jj=function(t,e,o){var n,r;for(n=e;-1!==n&&n<e+o;n++)(t.Yf(n,-1)||t.Kf(n,-1))&&(t.Q3(n,-1,1),r=t.rg(n,!0),this.hh(r,1))},t.prototype.Kj=function(t){var e,o,r,i,a,s=t.Cf().getAllSourceModels();for(r=0;r<s.length;r++)if((i=s[r]).lmb)for(e=i.lmb(),a=0;a<e.length;a++)(o=e[a])&&o.isVolatile&&o instanceof n.CellCalc&&!this.isAdjustCell(o)&&this.hh(o,0)},t.prototype.onBeforeAddRemoveRows=function(t,e,o){[t,o].forEach((function(t){if(t){var o=t.rC(),n=t.cC();t.Sg(e,0,o-e,n),t.Ug(e,o-e),st(t,e,-1,o-e,-1,!0)}}))},t.prototype.onAfterAddRemoveRows=function(t,e,o,n,r,i){var a=this;[t,i].forEach((function(t){if(t){var r=t.rC(),i=t.cC();n?t.Ag(e,0,o,i):r+=o,a.Dj(t,e,0,r-e,i),a.Jj(t,e,r-e),a.Kj(t)}})),a.Gj(t.getSource(),e,o,!0,n,p,r),t.Cf().autoCalculation&&t.Cf().recalculateAll(!1)},t.prototype.onAfterAddRemoveColumns=function(t,e,o,n,r,i){var a=this;[t,i].forEach((function(t){if(t){var r=t.rC(),i=t.cC();n?t.Ag(0,e,r,o):i+=o,a.Dj(t,0,e,r,i-e),a.Ij(t,e,i-e),a.Kj(t)}})),a.Gj(t.getSource(),e,o,!1,n,p,r),t.Cf().autoCalculation&&t.Cf().recalculateAll(!1)},t.prototype.onBeforeAddRemoveColumns=function(t,e,o){[t,o].forEach((function(t){if(t){var o=t.rC(),n=t.cC();t.Sg(0,e,o,n-e),t.Wg(e,n-e),st(t,-1,e,-1,n-e,!0)}}))},t.prototype.onAfterRemoveName=function(t,e){var o=t.wg(e,!1);o&&(o.updateListening(!0,!1),o.fh(),o.updateListeningOnRemoved())},t.prototype.adjustFormulaOnRemoveName=function(t,e,o){return lt(t,e,o)},t.prototype.invalidName=function(t,e){var o;e&&((o=t.getCalcSourceModel().wg(e.toUpperCase(),!0))&&o.Yg())},t.prototype.onAfterRemoveTable=function(e,o){var n,r,i,a,l,u,c,f,h,p,d,g,m=this;for(l=0;l<e.length;l++)st((u=e[l]).source().getCalcSourceModel(),u.startRow(),u.startColumn(),u.endRow()-u.startRow()+1,u.endColumn()-u.startColumn()+1);if(c=m.imb)for(f={};c[0];)if(n=(h=c[0]).ah,A(f,r=h.row,i=h.column))m.Fj(h,0);else{if(a=n.Kf(r,i))if(a=t.adjustExpressionOnRemoveTable(a,e,r,i,o),(p=n.Qf(r,i))&&!p.isDynamicArray)for(p=s.kf(r,i,p.rowCount,p.colCount),d=r;d<r+p.rowCount;d++)for(f[d]||(f[d]={}),g=i;g<i+p.colCount;g++)n.fg(d,g,a,p,d===r&&g===i),x(f,d,g,!0);else n.fg(r,i,a,p,!0);else(n.getRowExpression&&n.getRowExpression(r)||n.getColumnExpression&&n.getColumnExpression(i))&&n.Ag(r,i,1,1);m.Fj(h,0)}},t.adjustExpressionOnRemoveTable=function(e,o,r,i,a){var s,l,u,c,f,h,p,g,m,y,C,v,b,w,T,S,x=t.adjustExpressionOnRemoveTable;if(9===e.type){if(s=e.value,l=e.value2,u=x(s,o,r,i,a),c=l&&x(l,o,r,i,a),s!==u||l!==c)return n.Kh(e.operatorType,u,c)}else if(7===e.type){for(f=!1,h=[],p=0;p<e.arguments.length;p++)m=x(g=e.arguments[p],o,r,i,a),f=f||g!==m,h.push(m);if(f)return n.Jh(e,h)}else if(10===e.type){if((y=e.value)!==(C=x(y,o,r,i,a)))return n.Lh(C)}else if(13===e.type)for(v=e,p=0;p<o.length;p++)if(v.baseTable===o[p])return a?n.Ih:(b=v.getRange(-1===r?0:r,-1===i?0:i,!0),w=-1===r||1===v.referencePortions(),T=1===b.rowCount&&1===b.columnCount,S=v.source,T?n.rf(S,d,b.row,b.col,w,!1):n.uf(S,d,b.row,b.col,b.row+b.rowCount-1,b.col+b.colCount-1,w,!1,w,!1));return e},t}(),e.CalcOperatorAdjustor=v,n.CalcService.prototype.uzb=function(){return new v},function(t){t.outToOut="0_0",t.outToCover="0_1",t.outToInside="0_2",t.outToPart="0_3",t.outToCross="0_4",t.outNoMove="0_9",t.coverToOut="1_0",t.coverToCover="1_1",t.coverToCross="1_4",t.coverNoMove="1_9",t.insideToOut="2_0",t.insideToInside="2_2",t.insideToPart="2_3",t.insideToCross="2_4",t.insideNoMove="2_9",t.partToOut="3_0",t.partToInside="3_2",t.partToPart="3_3",t.partToCross="3_4",t.partNoMove="3_9",t.crossToOut="4_0",t.crossToCover="4_1",t.crossToInside="4_2",t.crossToPart="4_3",t.crossToCross="4_4",t.crossNoMove="4_9"}(b||(b={})),e.adjustFormulaOnMoveSwap=rt},"./dist/plugins/sheetsCalc/parser-sheets.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function k(t){return u(t+1).split("")}function N(t,e){var o=e+1;return t<0?t%o+o:t>e?t%o:t}function O(t){return new i.ErrorSource(t)}function D(t,e,o,n,r){var a,l,u=s.BAND_INDEX_CONST,c={cj:u,dj:u,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},f=e?j(t,o,n,0):E(t,0,r);return f.hj?(c.cj=f.ij,c.ej=f.jj):(c.dj=f.ij,c.fj=f.jj),c.li=f.li,c.gj=f.gj,!f.gj||f.li>=t.length?c:!e&&f.hj||e&&!f.hj?{gj:!1}:(a=t[c.li],!e&&(i.isNumber(a)||"$"===a)||e&&("C"===a||"c"===a)?(l=e?j(t,o,n,c.li):E(t,c.li,r),c.li=l.li,!l.gj||!e&&!l.hj||e&&l.hj?(c.gj=!1,c):(l.CLb&&(c.CLb=!0),c.li<t.length&&(c.Vka=!1),e?(c.dj=l.ij,c.fj=l.jj):(c.cj=l.ij,c.ej=l.jj),c.gj=!0,c)):{gj:!1})}function F(t){return i.ei(t)||95===t.charCodeAt(0)}function E(t,o,n){var r,a,s,l,u,c,f,p,d,g={jj:!0,gj:!1},m=t.length;if(o>=m)return g;if("$"===t[o]&&(g.jj=!1,o++),o>=m)return g;if(a=0,s=t[r=o],l=!1,i.isNumber(s)&&"0"!==s){for(g.hj=!0;r<m&&i.isNumber(s);)++r<m&&(s=t[r]);if(r+1===m&&"#"===s&&n&&(l=!0),r-o>7)return g;for(u=r-1,c=0;u>=o;u--,c++)a+=(t[u].charCodeAt(0)-48)*b[c];if(a<=e.maxRowCount)return g.ij=a-1,g.li=l?m:r,g.CLb=l,g.gj=!0,g}else if(i.ei(s)){for(g.hj=!1;r<m&&i.ei(s);)++r<m&&(s=t[r]);if(r-o>3)return g;if(function(t,e,o){for(var n=t,r=e[t],i=!1;n<o&&!F(r);)++n<o&&(r=e[n]);if(n<o){for(;n<o&&F(r);)++n<o&&(r=e[n]);n<o&&(i=!0)}return i}(r,t,m))return g;for(a=0,p=f=r-1;p>=o;p--){if(!((d=t[p].charCodeAt(0))>=65&&d<=90||d>=97&&d<=122))return g;a+=((32|d)-96)*h[f-p]}if(a<=e.maxColumnCount)return g.ij=a-1,g.li=r,g.gj=!0,g}return g}function j(t,o,n,r){var a,l,u,c,f,h={li:r,ij:s.BAND_INDEX_CONST,hj:!0,jj:!1,gj:!1},p=t.length;if(r>=p)return h;if("R"===(l=t[a=r])||"r"===l)h.hj=!0,u=o;else{if("C"!==l&&"c"!==l)return h;h.hj=!1,u=n}if(a++,++r>=p)return h.li=r,h.ij=u,h.jj=!0,h.gj=!0,h;if("["===(l=t[a])&&(r++,a++,h.jj=!0),r>=p)return h;if(c=!1,l=t[a],h.jj&&"-"===l&&(r++,a++,c=!0),r>=p)return h;if(l=t[a],!i.isNumber(l))return h.jj||(h.li=r,h.ij=u,h.jj=!0,h.gj=!0),h;for(;a<p&&i.isNumber(l);)++a<p&&(l=t[a]);if(f=parseInt(t.slice(r,a).join(""),10),h.jj){if(a>=p||"]"!==t[a])return h;a++}return f<(h.hj?e.maxRowCount:e.maxColumnCount)?(h.jj?(f=c?-f:f,h.ij=f+u):h.ij=f-1,h.li=a,h.gj=!0,h):void 0}function P(t,e,o,n){var r,a,s,l,u,c=t.source&&t.source.Af,f=t.row||0,h=t.column||0,d=t.Eh;if(o.source===i.BangSource)n.push("!");else if(o.source&&!B(t,n,o.source,o.endSource))return void n.push("#","R","E","F","!");if(a=33===(r=o.type),8===r||5===r)n.push(""+o.value);else if(100===r)s="_xlpm.",o.bhc&&c.UIc?n.push(s+""+o.value):n.push(""+o.value);else if(o.value&&o._error)n.push(""+o.value);else if(a||o.sf()){if(l=void 0,s=void 0,u=void 0,a&&(s=(l=w[d?0:1]).prefix,u=l.surfix,n.push(s),o.isReferenceError))return n.push("#REF!"),void n.push(u);!o.source&&t.addSheetName&&t.source&&B(t,n,t.source,p),L(t.useR1C1,f,h,o.row,o.column,o.rowRelative,o.columnRelative,n),a&&n.push(u)}else!o.source&&t.addSheetName&&t.source&&B(t,n,t.source,p),G(t.source,t.useR1C1,f,h,o.row,o.column,o.endRow,o.endColumn,o.rowRelative,o.columnRelative,o.endRowRelative,o.endColumnRelative,n,o.tf())}function L(t,o,n,r,a,s,l,u,c){var f,h;if(c=c||0,f=e.maxRowCount-1,(0===c||1===c)&&r>-f&&r<=2*f&&(r=N(r+=s?o:0,f)),h=e.maxColumnCount-1,(0===c||2===c)&&a>-h&&a<=2*h&&(a=N(a+=l?n:0,h)),function(t,e,o,n,r,i,a){return 3===a||o>=0&&n>=0||1===a&&o>=0||2===a&&n>=0}(0,0,r,a,0,0,c))if(t){if(2!==c&&(u.push("R"),r>=0&&(o!==r||!s)&&(s?u.push("["+(r-o)+"]"):(r++,u.push(r+""))),a<0))return;1!==c&&(u.push("C"),n===a&&l||(l?u.push("["+(a-n)+"]"):(a++,u.push(a+""))))}else{if(a>=0&&(l||u.push("$"),u.push.apply(u,k(a))),r<0)return;r++,s||u.push("$"),u.push(r+"")}else u.push(""+i.Errors.Reference)}function G(t,o,n,r,i,a,l,u,c,f,h,p,d,g){3===(g=g||0)&&(i=0,l=t?t.getRowCount():e.maxRowCount-1,g=1),L(o,n,r,i,a,c,f,d,g);var m=s.BAND_INDEX_CONST;(!o||i!==l||a!==u||l!==m&&u!==m)&&(l===m&&u===m||(d.push(":"),L(o,n,r,l,u,h,p,d,g)))}function B(t,e,o,n){if(t.getExternalSourceToken){if(o!==i.BangSource){var r=_(t,t.getExternalSourceToken(o).split(""),n&&t.getExternalSourceToken(n).split(""));if(!(r.length>0))return!1;e.push.apply(e,r)}return e.push("!"),!0}return!1}function _(t,e,o){if(!e||0===e.length||V(t,e)||V(t,o))return[];var n,r=e;if(z(e,!1)||o&&z(o,!1)){for(r=["'"],n=0;n<e.length;n++)"'"===e[n]&&r.push("'"),r.push(e[n]);if(o)for(r.push(":"),n=0;n<o.length;n++)"'"===o[n]&&r.push("'"),r.push(o[n]);r.push("'")}else if(o)for(r.push(":"),n=0;n<o.length;n++)r.push(o[n]);return r}function V(t,e){if(!e||0===e.length||!t.Eh)return!1;var o="'"===e[0]?1:0;return"["===e[o]&&e.indexOf("]")>o}function H(t,e){var o,n;if(!t||0===t.length)return!0;if(!e){if(i.isNumber(t[0]))return!1;if(function(t){var e=t.join("").toUpperCase();return!!("RC"===e||"C"===e||"R"===e||y.test(e)||C.test(e)&&function(t){var e=t.search(/[0-9]/),o=t.substr(0,e),n=parseInt(t.substr(e),10);return(e<=2||3===e&&o<="XFD")&&n<=1048576}(e))}(t))return!1;if(v.test(t[0]))return!1}for(n=0;n<t.length;n++)if(o=t[n],e){if("*"===o||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return!1}else if(m[o]||i.operaterTypesMap[o])return!1;return!0}function z(t,e){var o,n,r;return!!i.isDigit(+t[0])||(o=[],n=t,"["===t[0]&&((r=t.lastIndexOf("]"))>0&&(o=t.slice(1,r),n=t.slice(r+1))),!function(t,e){var o,n;if(!t||0===t.length)return!0;for(n=0;n<t.length;n++)if(o=t[n],e){if("*"===o||":"===o||"["===o||"]"===o||"?"===o)return!1;if("'"===o&&(0===n||n>=t.length-1||"'"!==t[n+1]))return!1}else if("'"===o||"["===o||"]"===o||"?"===o||"%"===o||i.operaterTypesMap[o])return!1;return!0}(o)||!H(n,e))}function U(t){var e=new i.Expression(8);return e.value=t,e}function W(t){var e=t;return t&&t.length>=3&&"["===t[0]&&"0"===t[1]&&"]"===t[2]&&(e=3===t.length?"":t.substring(3)),e}function q(t,e,o,n,r){return 0===e.Nc&&0===e.hi||!n&&0===e.Nc&&4===e.hi&&(!r||o<t.length-2&&":"===t[o+1].ni&&0===t[o+2].Nc&&4===t[o+2].hi)}function J(t,e,o,n,r){return e<=t.startRow()&&o<=t.startColumn()&&e+n>t.endRow()&&o+r>t.endColumn()}function X(t,e,o){var n,r,i,a,s,u,c,f,h,p=o,d=0,g=e[d],m=function(t,e,o,n){for(var r,i,a=0,s=e.length;"["!==n&&o<s;)o++,n=e[o];return a=o,a>0?(i=Z(e,0,a),r=t.getTableByName(i)):r=t.getTableByIndex(t.row,t.column),{sj:r,tj:o,uj:n}}(t,e,d,g),y=m.sj;for(y||ot(),p.baseTable=y,d=m.tj,g=e[++d],n=d;" "===g;)g=e[++d];for("@"!==g&&"["!==g&&(g=e[d=n]),r=1,i=!1,a=!1,s=e.length;0!==r&&d<s;)if("["===g&&(r++,g=e[++d]),"#"===g)i&&r<=1&&ot(),c=(u=et(e,d,g,r)).vj,d=u.tj,g=u.uj,r=u.wj,i?2===p.qj&&3===c||2===c&&3===p.qj?p.qj=6:3===p.qj&&8===c||3===c&&8===p.qj?p.qj=12:ot():p.qj=c,i=!0;else if("@"===g){for((r>1||i)&&ot(),i=!0,p.qj=1,g=e[++d];" "===g;)g=e[++d];","===g&&ot()}else{for(f=d;!l.isNullOrUndefined(g)&&"]"!==g&&"["!==g;)if("'"===g&&d++,","===g){for(g=e[++d],h=d;" "===g;)g=e[++d];if("["===g){d=h,g=",";break}}else g=e[++d];if(d>f&&((a||"["===g&&r>1)&&ot(),d=(u=Y(p,e,d,g,r,f)).tj,g=u.uj,r=u.wj,a=!0),"]"===g){if(0===--r)break;d>=e.length&&ot(),g=e[++d]}","===g&&(g=e[++d])}i||(p.qj=t.DLb?1:16),a||(p.oj=0,p.pj=p.lj.endColumn()-p.lj.startColumn(),p.rj=1)}function Z(t,e,o){return t.slice(e,o).join("")}function Y(t,e,o,n,r,i){var a,s,l,u,c,f,h=t,d=[],g="",m=!1,y=!1;if(r>1)m=!0,r--,d=e.slice(i,o),":"===(n=e[++o])&&(y="["===(n=e[++o]),g=(s=$(e,o,n,r)).xj,o=s.tj,n=s.uj,r=s.wj);else if("["===n){for(y=!0,n=e[a=o-1];" "===n;)n=e[--a];":"!==n&&ot(),d=function(t){for(var e=t.length-1;e>=0&&" "===t[e];)e--;for(;e>=0&&" "!==t[e];)e--;return e>=0?t.slice(e+1,t.length-e-1):t}(d=e.slice(i,a)),g=(s=$(e,o,n=e[o],r)).xj,o=s.tj,n=s.uj,r=s.wj}else h.qj!==p&&16!==h.qj||(m=!0),(a=(l=e.slice(i,o)).indexOf(":"))>0?(d=l.slice(0,a),"["!==(g=l.slice(a+1))[0]&&ot()):d=l;if(u=K(h,d,m),g?(c=K(h,g,y),h.rj=4):(c=u,h.rj=2),u>c&&(f=u,u=c,c=f),h.oj=u,h.pj=c,++o<e.length)for(n=e[o];" "===n;)n=e[++o];return{tj:o,uj:n,wj:r}}function K(t,e,o){var n,r,i,a;if(e&&function(t,e){var o,n,r;if(e)return!0;if(o="",o=t[0],n=o,"#"===o||"@"===o||" "===o||","===o||":"===o||"["===o||"]"===o)return!1;for(r=1;r<t.length;r++){if(","===(o=t[r])||":"===o||"["===o&&"'"!==n||"]"===o&&"'"!==n||"@"===o&&"'"!==n||"#"===o&&"'"!==n)return!1;n=o}return!0}(e,o)){for(n=[],r=0,i=e.length;r<i;r++)"'"===e[r]&&r<i-1&&r++,n.push(e[r]);return e=n,(a=t.lj.getColumnIndexInTable(e.join("")))<0&&ot(),a}return-1}function Q(t){var e,o,n=[];for(o=0;o<t.length;o++)"["!==(e=t[o])&&"]"!==e&&"@"!==e&&"#"!==e&&"'"!==e||n.push("'"),n.push(e);return n}function $(t,e,o,n){var r,i,a=!1;if("["===o)for(a=!0,n++,o=t[++e];" "===o;)o=t[++e];for(r=e;"]"!==o&&(","!==o||n>1);)"'"===o&&e++,o=t[++e];return e<=r&&ot(),i=t.slice(r,e),n>1&&n--,a||(i=function(t){for(var e,o=0,n=t.length;o<n&&" "===t[o];)o++;for(e=o,o=n-1;o>e&&" "===t[o];)o++;return o>=e?t.slice(e,o+1):t}(i)),{xj:i,tj:e,uj:o,wj:n}}function tt(t){var e,o=i.getMapping()&&i.getMapping().tableFunctionsMapping;if(!l.isNullOrUndefined(o))for(e in o)if(o[e].toLowerCase()===t)return e.toLowerCase();return t}function et(t,e,o,n){for(var r,i,a,s=14,l=e;"]"!==o;)"'"===o&&e++,o=t[++e];for(r=tt(r=Z(t,l,e).toLowerCase().trim()),i=!1,a=0;a<g.length;a++)if(r===g[a]){s=R[r],i=!0;break}if(i||ot(),++e>=t.length)n--;else{for(o=t[e];" "===o;)o=t[++e];if(","===o){for(n<=1&&ot(),o=t[++e];" "===o;)o=t[++e];"["===o&&(n++,o=t[++e])}n>1&&n--}return{vj:s,tj:e,uj:o,wj:n}}function ot(){throw f().Exp_FormulaInvalid}function nt(t){return 1===t.Nc&&"ARRAY"===t.ni?1:0===t.Nc&&3===t.hi?(t.HTa||t.ni).length+2:0===t.Nc&&12===t.hi?t.ni.length+3:t.ni.length}function rt(t,e,o){var n,r;t&&e&&((r=t[n=e.getName&&e.getName()||"!"])||(r=t[n]=[],t.sheets||(t.sheets=[]),t.sheets.push(n)),r.push(o))}function it(t,e,o,n,r,a){var s,l,u;if(t){for(;10===t.type;)t=t.value;if(12===t.type&&(t=t.value),t.type>=2&&t.type<=6);else if(1===t.type)s=t.getRange(r,a),!n.source||t.source&&t.source!==n.source||e.push(s),rt(o,t.source||n.source,s);else if(13===t.type)s=t.getRange(r,a),t.source===n.source&&s&&e.push(s),rt(o,t.source||n.source,s);else if(8===t.type)l=d,t.source?t.source.Cf()&&(l=new i.EvaluateContext(t.source,i.pf(r,a))):l=n,it(l.getName(t.value),e,o,l,r,a);else if(9===t.type)it(t.value,e,o,n,r,a),t.value2&&it(t.value2,e,o,n,r,a);else if(7===t.type)for(u=0;u<t.arguments.length;u++)it(t.arguments[u],e,o,n,r,a)}}function at(t,e,o,n,r,s,l){var u,c,f,h,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N=p,O=n.yj(),D=n.Cf();for(D?(u=new a.SheetParserContext(n,!l&&D.useR1C1,i.pf(r,s)),N=new i.EvaluateContext(O,i.pf(r,s),!1)):u=new i.ParserContext(d,!1,i.pf(0,0)),u.ignoreError=!0,c=[],h=0;h<e.length;h++)try{if("["===(f=e[h]).ni||"#"===f.Qb[0]||3===f.hi){c.push({text:f.HTa||f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni});continue}if(h=st(t,u,e,h,g=[]),m=void 0,g.length>0){for(y=0;y<g.length;y++)if((C=g[y])instanceof i.FormulaToken)c.push({text:o.slice(C.mi,C.li+1).join(""),type:C.Nc,subType:C.hi,canDrag:m,ranges:[],value:C.ni});else if(C.Lf){if(b=(v=C.Lf).type,w=v.source,T=o.slice(C.mi,C.li+1).join(""),S=[],x={},m=!0,A=v.getRange&&v.getRange(r,s),8===b)m=!1,N&&(I=N,v.source&&(I=new i.EvaluateContext(v.source,i.pf(r,s),!1)),it(I.getName(v.value),S,x,N,r,s));else if(13===b)m=!1,w===O&&A?S.push(A):S=null,rt(x,w,A);else if(33===b)(w||v.contextSource)===O&&(A||(A=i.getRangeForReference(v,r,s)),S.push(A),w||(w=O)),rt(x,w,A);else if(1===b)if(v.endSource)for(R=w,M=v.endSource,k=R.getSources(M),y=0;y<k.length;y++){if(k[y]===O){S.push(A);break}rt(x,k[y],A)}else rt(x,w||O,A),w&&w!==O||S.push(A);else S=null;S&&S.length>0?c.push({text:T,type:0,subType:7,canDrag:m,ranges:S,value:T,sheetRanges:x}):c.push({text:T,type:f.Nc,subType:f.hi,canDrag:m,ranges:S,value:T,sheetRanges:x})}}else c.push({text:f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni})}catch(t){c.push({text:f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni})}return c}function st(t,e,o,n,r){var i,a,s,l,u,c,f=o[n];return f&&"function"!=typeof f&&0===f.Nc?(i=[],a=t.resolveToken(e,o,i,n)-1,1===(l=(s=i[0]).type)||13===l||33===l||8===l||5===l&&s.source?(u=o[a],c={mi:f.mi,li:u.li,Lf:s},r.push(c),a):n):n}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("@grapecity/js-calc"),a=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),s=o("./dist/plugins/sheetsCalc/calc.ns.js"),l=o("./node_modules/util/util.js"),u=n.util.xq,c=new r.Common.ResourceManager(n.SR),f=c.getResource.bind(c),i.Errors.Reference,e.maxRowCount=1048576,e.maxColumnCount=16384,h=[1,26,676],p=void 0,d=null,g=["#all","#data","#headers","#totals","#this row"],m={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"（":!0,"）":!0,".":!0,";":!0},y=/^(R|C|RC)?(0*[1-9]\d*)/,C=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,v=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/,b=[1,10,100,1e3,1e4,1e5,1e6,1e6],w=[{prefix:"ANCHORARRAY(",surfix:")"},{prefix:"",surfix:"#"}],e.jma=H,e.validateSheetName=H,T=function(t){function e(e){var o=t.call(this,8e3)||this;return o.kj=e,o}return M(e,t),e.prototype.resolveToken=function(t,e,o,n){var r,a,u,c,f,h,p,g,m,y,C,v,b,w,T,S,x,A,I=t.useR1C1,R=t.row||0,M=t.column||0,k=o.length,N=o[n],F=N.ni,E=N.Nc,j=N.hi;if(0!==E&&6!==j)return!1;if(0===E&&0===j&&n<k-2&&":"===o[n+1].ni&&12===o[n+2].hi&&o[n+2].ni.indexOf(":")<0||0===E&&12===j){if(f=void 0,h=void 0,F&&(F.indexOf(":")>0?(p=F.indexOf(":"),f=F.substring(1,p-1),h=F.substring(p+1,F.length-2)):("'"===(f=F).charAt(0)&&(f=f.substring(1,f.length-1)),0===j&&("'"===(h=o[n+2].ni).charAt(0)&&(h=h.substring(1,h.length-1))))),n++,c=!!f,(f=W(f))&&(a=(a=F?t.getExternalSource("",f):i.BangSource)||O(f),(h=W(h))&&(u=(u=t.getExternalSource("",h))||O(h),n+=2)),(N=o[n])&&"["===N.Qb[0])return!1;if(!N)return U(F);F=N.ni}if(g=n===k-1?d:o[n+1],q(o,N,n,I,!0)){if(m=t&&t.source&&t.source.Af&&t.source.Af.allowDynamicArray,!(y=D(N.Qb,I,R,M,m)).gj&&!c)return!1;if(N.hi=7,y.gj&&y.Vka){if(C=y.cj,v=y.dj,b=y.ej,w=y.fj,T=y.CLb,n<k-2&&5===g.Nc&&":"===g.ni&&(q(o,g=o[n+2],n+2,I,!1)&&((S=D(g.Qb,I,R,M)).gj&&C===s.BAND_INDEX_CONST==(S.cj===s.BAND_INDEX_CONST)&&v===s.BAND_INDEX_CONST==(S.dj===s.BAND_INDEX_CONST))))return R=C===s.BAND_INDEX_CONST?0:R,M=v===s.BAND_INDEX_CONST?0:M,{index:n+3,expr:i.uf(a,u,C-(b?R:0),v-(w?M:0),S.cj-(S.ej?R:0),S.dj-(S.fj?M:0),b,w,S.ej,S.fj,R,M)};if(C===s.BAND_INDEX_CONST||v===s.BAND_INDEX_CONST){if(I)return C-=C!==s.BAND_INDEX_CONST&&b?R:0,v-=v!==s.BAND_INDEX_CONST&&w?M:0,{index:n+1,expr:i.uf(a,u,C,v,C,v,b,w,b,w,R,M)};if(!a)return!1;r=U(F)}if(!r)return l.isNullOrUndefined(a)&&(a=function(t,e,o){var n,r,i,a,s=t.source;return s&&(r=s.q$a,i=s.cDc,a=s.dDc,r&&(e>=0&&e<i&&o>=a||e>=i&&o>=0&&o<a)&&(n=s)),n}(t,R,M)),x=C-(b?R:0),A=v-(w?M:0),{index:n+1,expr:r=T?i.BLb(t.source,a,u,x,A,b,w):i.rf(a,u,x,A,b,w)}}else r=U(F)}else if(6===N.hi)(r=new i.Expression(5)).value=i.CalcError.parse(N.ni);else{if(!a)return!1;r=U(F)}return a&&(r.source=a),u&&(r.endSource=u),{index:n+1,expr:r}},e.prototype.unparse=function(t,e,o,n){var r=o&&o.type;return(1===r||8===r||5===r||33===r||100===r)&&(P(t,0,o,n),!0)},e}(i.TokenResolver),e.SheetReferenceResolver=T,function(t){t[t.ThisRow=1]="ThisRow",t[t.Headers=2]="Headers",t[t.Data=3]="Data",t[t.Totals=8]="Totals",t[t.HeadersAndData=6]="HeadersAndData",t[t.DataAndTotals=12]="DataAndTotals",t[t.All=14]="All",t[t.NotSpecific=16]="NotSpecific"}(S=e.StructReferencePortions||(e.StructReferencePortions={})),function(t){t[t.All=1]="All",t[t.NotSpecific=1]="NotSpecific",t[t.SingleColumn=2]="SingleColumn",t[t.ColumnRange=4]="ColumnRange"}(x=e.StructReferenceColumnSpecifier||(e.StructReferenceColumnSpecifier={})),A=function(t){function e(){return t.call(this,13)||this}return M(e,t),e.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(e.prototype,"baseTable",{get:function(){return this.lj},set:function(t){this.lj=t,this.source=t.source()},enumerable:!0,configurable:!0}),e.prototype.JUa=function(){this.vzb=this.lj.startColumn()},e.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},e.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},e.prototype.referencePortions=function(){return this.qj},e.prototype.referenceColumnSpecifier=function(){return this.rj},e.prototype.getRange=function(t,e,o){var n,r,a,s,l,u,c,f,h,p,g,m=this,y=m.lj;switch(m.JUa(),c=y.startRow(),f=y.endRow(),h=y.hasTotalsRow(),p=y.hasHeadersRow(),m.qj){case 3:case 16:n=p?c+1:c,a=h?f-1:f;break;case 2:if(p)n=c,a=c;else{if(!o)return d;n=c-1,a=c-1}break;case 8:if(h)n=f,a=f;else{if(!o)return d;n=f+1,a=f+1}break;case 1:n=t,a=t;break;case 6:n=c+(o&&!p?-1:0),a=h?f-1:f;break;case 12:n=p?c+1:c,a=f+(o&&!h?1:0);break;default:n=c+(o&&!p?-1:0),a=f+(o&&!h?1:0)}return r=m.columnReferenceStart(),s=m.columnReferenceEnd(),g=y.endColumn(),1===m.rj&&(s=g),r>g||s>g?(m._error=!0,d):a<n||!o&&n<c||!o&&a>f?d:(l=a-n+1,u=s-r+1,i.qf(n,r,l,u))},e.prototype.offsetWhenInsertRemoveColumn=function(t,o,n,r){var a,s,l=this,u=l.vzb;return t<u||t===u&&n&&!r||t>l.pj+u?l:(o=n?o:-o,a=t-u,(s=new e).baseTable=l.lj,s.pj=l.pj+o,s.oj=l.oj,t<=u+l.oj&&(s.oj+=o,s.oj<a&&(s.oj=a)),s.rj=l.rj,s.qj=l.qj,s.pj<s.oj?i.Ih:s)},e.prototype.offsetWhenCopy=function(t,e,o,n,r,s,l,u,c,f){var h,p,d,g,m,y=new a.SheetParserContext(e.kj,e.Af.useR1C1,i.pf(o,n)),C=y.getTableByIndex(o,n),v=this.offset();return C&&(h=o-r,p=n-s,d=l-r,g=u-s,m=void 0,t===e?m=y.getTableByIndex(h,p):m=new a.SheetParserContext(t.kj,t.Af.useR1C1,i.pf(h,p)).getTableByIndex(h,p),m!==C&&m===this.lj&&J(m,d,g,c,f)&&J(C,l,u,c,f)&&(v.baseTable=C)),v},e.prototype.Jma=function(t){var o,n=this,r=new e;return r.baseTable=n.lj,r.pj=n.pj,r.oj=n.oj,2===n.rj&&t&&(t%=o=n.lj.endColumn()-n.lj.startColumn()+1,r.oj+=t,r.oj<0&&(r.oj+=o),r.pj=r.oj),r.rj=n.rj,r.qj=n.qj,r},e.prototype.offset=function(t,o,n){var r=this,i=new e;return i.baseTable=r.baseTable,i.qj=r.qj,i.oj=r.oj,i.pj=r.pj,i.rj=r.rj,i},e.prototype.Kma=function(t,e){var o=this.lj;return t>=o.startRow()&&e>=o.startColumn()&&t<=o.endRow()&&e<=o.endColumn()},e.prototype.tzb=function(t,e,o){this.lj.wzb(t,e,o)},e}(i.Expression),e.xzb=A,I=function(t){function o(e){var o=t.call(this,7900)||this;return o.kj=e,o}return M(o,t),o.prototype.resolveToken=function(t,e,n,r){var i,a,s,l,u,c=n[r],f=n[r+1];if(0===c.Nc){if(i=void 0,a=void 0,0===c.hi||7===c.hi)i=c.ni;else{if(12!==c.hi||!f||0!==f.Nc||0!==f.hi||"["!==f.Qb[0])return d;"'"===(s=c.ni)[0]&&(s=s.substr(1,s.length-2)),i=s+f.ni,a=!0}if("]"===i.charAt(i.length-1))try{return l=new A,X(t,i.split(""),l),a?{index:r+2,expr:l}:l}catch(t){}else if(u=t.getTableByName&&t.getTableByName(i))return o.create(u)}return d},o.prototype.unparse=function(t,o,n,r){var a,s,u,c,f,h,p,g,m,y;return 13===n.type&&(s=(a=n).lj.KXc,u=l.isNullOrUndefined(s)?a.lj.tableName():s,t.YSa?(c=a.getRange(t.row,t.column,!0),P(t,0,i.uf(a.source,d,c.row,c.col,c.row+c.rowCount-1,c.col+c.colCount-1,!1,!1,!1,!1),r),!0):16===a.qj&&1===a.rj?(r.push(u),void(t.Eh&&r.push("[]"))):(h=r.length,t.source===a.lj.source()&&a.Kma(t.row,t.column)&&!t.Eh||(p=l.isNullOrUndefined(s)?a.lj.tableName():s,a.lj.kj.xUc&&!e.validateSheetName(p.split(""))&&(p=_(t,p.split(""),null).join("")+"!"),r.push(p)),r.push("["),16!==a.qj&&(g=function(t,e,o){var n=i.getMapping()&&i.getMapping().tableFunctionsMapping,r=i.sR().B2,a=n?n["#All"]:r.All.name,s=n?n["#This row"]:r.thisRow.name,l=n?n["#Headers"]:r.Headers.name,u=n?n["#Data"]:r.Data.name,c=n?n["#Totals"]:r.Totals.name;switch(t){case 1:return o?"["+s+"]":"@";case 2:return e?"["+l+"]":l;case 3:return e?"["+u+"]":u;case 8:return e?"["+c+"]":c;case 6:return"["+l+"], ["+u+"]";case 12:return"["+u+"], ["+c+"]"}return e?"["+a+"]":a}(a.qj,1!==a.rj,t.Eh),r.push(g)),1!==a.rj&&(1===a.qj&&!t.Eh||16===a.qj||r.push(", "),(m=a.lj.getColumnName(a.oj))?m=Q(m.split("")).join(""):f=!0,f||(4===a.rj?(y=a.lj.getColumnName(a.pj))?(y=Q(y.split("")).join(""),r.push("[",m,"]:[",y,"]")):f=!0:1===a.qj&&!t.Eh&&!function(t){var e,o="";if(o=t[0],"#"===o||" "===o||"@"===o||" "===o||","===o||":"===o||"["===o||"]"===o)return!0;for(e=1;e<t.length;e++)if(" "===(o=t[e])||","===o||":"===o||"["===o||"]"===o||"@"===o||"#"===o)return!0;return!1}(m)||16===a.qj?r.push(m):r.push("[",m,"]"))),f?(r.length=h,r.push("#REF!")):r.push("]"),!0))},o.create=function(t,e,o,n,r){void 0===e&&(e=S.NotSpecific),void 0===o&&(o=x.NotSpecific),void 0===n&&(n=0),void 0===r&&(r=t.endColumn()-t.startColumn());var i=new A;return i.baseTable=t,i.qj=e,i.oj=n,i.pj=r,i.rj=o,i},o}(i.TokenResolver),e.StructureReferenceResolver=I,R={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},e.qzb=function(t,e,o,n,r,a,s){var l,u,c;t.setParserOption(a),l=[],u=e.split("");try{c=o.yj().getParserContext(!s&&o.Cf().useR1C1,i.pf(n,r),d),l=t.parseToTokens(c,u,!1)}catch(t){}return l=function(t,e){var o,n,r,a,s,l,u,c,f,h;for(t.unshift(new i.FormulaToken("=",1,0,0,0)),a=[],s=0,r=t.length-1;r>0;r--)t[r].mi===t[r-1].mi&&t[r].ni===t[r-1].ni||(a[s]=t[r],s++);for(a[s]=t[r],a.reverse(),l=[],u=0,c=0;c<a.length-1;c++,u++)n=nt(a[c]),l[u]=a[c],a[c+1].mi-a[c].mi-n>0&&(o=new i.FormulaToken(e.slice(a[c].mi+n,a[c+1].mi),7,a[c].mi+n),l[++u]=o);for(l[u]=a[c],n=nt(l[u]),l.length>0&&e.length>l[u].mi+n&&(o=new i.FormulaToken(e.slice(l[u].mi+n,e.length),7,l[u].mi+n),l[u+1]=o),f=0;f<l.length;f++)h=l[f].ni.trim(),3===l[f].hi?l[f].ni='"'+l[f].ni+'"':"("===h||"{"===h?(l[f].Nc=1,l[f].hi=1):")"!==h&&"}"!==h||(l[f].Nc=1,l[f].hi=2);return l}(l,u),at(t,l,u,o,n,r,s)}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/sheetsCalc/calc.ns.js")),n(o("./dist/plugins/sheetsCalc/parser-sheets.js")),n(o("./dist/plugins/sheetsCalc/calc-spreadjs.js")),n(o("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),n(o("./dist/plugins/sheetsCalc/worksheet-formula.js")),o("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Core"),i=o("Common"),a=o("@grapecity/js-calc"),s=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=s.SpreadSource,c=i.Common.u.Nb,f=new i.Common.ResourceManager(n.SR),h=f.getResource.bind(f),p=void 0,i.Common.j,(d=n.Workbook.prototype).qv=function(t){var e=this,o=e.Wu;e.Wu=new a.CalcService,e.Wu.useR1C1=1===e.options.referenceStyle,e.Wu.allowDynamicArray=e.options.allowDynamicArray,e.Wu.iterativeCalculation=e.options.iterativeCalculation,e.Wu.iterativeCalculationMaximumIterations=e.options.iterativeCalculationMaximumIterations,e.Wu.iterativeCalculationMaximumChange=e.options.iterativeCalculationMaximumChange,t&&o&&e.Wu.cloneFrom(o),e.yv=new u(e),e.zv=e.Wu.getGlobalSourceModel(e.yv)},d.addCustomFunction=function(t){this.Xu(t)},d.Xu=function(t){if(!(t&&t instanceof a.Functions.Function))throw Error(h().Exp_InvalidCustomFunction);t.name=c(t.name),this.Su[t.name]=t},d.getCustomFunction=function(t){return t?this.Su[c(t)]:p},d.removeCustomFunction=function(t){t&&(delete this.Su[c(t)],this.iK())},d.clearCustomFunctions=function(){this.Su={}},d.addCustomName=function(t,e,o,n,r){this.Yu(this.Tu,t,e,o,n,!1,r)},d.H$a=function(t){return!this.Tu[c(t)]},d.isValidCustomName=function(t){return t&&n.Ul.G$a(t)&&this.H$a(t)},d.Yu=function(t,e,o,r,i,a,s){var u,f,p,d,g=this;if(!e||!o||!a&&!g.isValidCustomName(e))throw Error(h().Exp_InvalidCustomName);if(g.Wu){if(f=(u=n.sJc(this))?u.yj():null,p=void 0,a)try{p=g.Wu.parse(f,o,r,i,!1,!1,!0)}catch(t){}else p=g.Wu.parse(f,o,r,i);t[c(e)]=new l.NameInfo(e,p,r,i,s),a||((d={})[e]=e,this.Zu(d,!0))}},d.getCustomName=function(t){return t?this.Tu[c(t)]:p},d.aJb=function(t){return t?this.QHb[c(t)]:p},d.getCustomNames=function(){var t=[];return n.GC$.each(this.Tu,(function(e,o){t.push(o)})),t},d.ELb=function(){var t=[];return n.GC$.each(this.QHb,(function(e,o){t.push(o)})),t},d.removeCustomName=function(t){if(t){delete this.Tu[c(t)];var e={};e[t]=t,this.Zu(e,!1)}},d.RHb=function(t){if(t){delete this.QHb[c(t)];var e={};e[t]=t,this.Zu(e,!1)}},d.clearCustomNames=function(){var t=this.Tu;this.Tu={},this.Zu(t,!1)},d.FLb=function(){var t=this.QHb;this.QHb={},this.Zu(t,!1)},d.Zu=function(t,e){var o,n;if(t){for(n in o=this.zv,t)o&&o.updateNameCalc(n,e);this.iK()}},d.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var t=this.getActiveSheet();t&&(t.suspendPaint(),this.Wu.recalculateAll(),t.resumePaint())}},d.getCalcService=function(){return this.Wu},d.Cf=function(){return this.Wu},d.suspendCalcService=function(t){this.Wu&&this.Wu.suspend(t)},d.resumeCalcService=function(t){this.Wu&&this.Wu.resume(t)},d.getCircularReference=function(){var t,e,o,n=this.chc();for(e in t=[],n=this.dhc(n))Object.prototype.hasOwnProperty.call(n,e)&&(o=e.split("\\"),t.push({row:+o[1],col:+o[2],rowCount:1,colCount:1,sheetName:o[0]}));return t},d.chc=function(){var t={};return this.sheets.forEach((function(e){var o,n,r,i,a,s,l,u=e.Bj(),c=e.getRowCount(),f=e.getColumnCount(),h=e.name();if(u)for(o=0;o<c;o++)for(n=0;n<f;n++)for(r=h+"\\"+o+"\\"+n,i=e.VXc(o,n),!t[r]&&i.length>0&&(t[r]={from:[],to:[]}),a=0;a<i.length;a++)l=(s=i[a]).sheetName+"\\"+s.row+"\\"+s.col,t[l]||(t[l]={from:[],to:[]}),t[l].from.push(r),t[r].to.push(l)})),t},d.dhc=function(t){var e,o,n;function r(t,e){t.splice(t.indexOf(e),1)}for(e=!0;Object.keys(t).length>0&&e;)for(n in e=!1,o=function(o){if(Object.prototype.hasOwnProperty.call(t,o)){var n=t[o];0===n.from.length?(n.to.forEach((function(e){r(t[e].from,o)})),delete t[o],e=!0):0===n.to.length&&(n.from.forEach((function(e){r(t[e].to,o)})),delete t[o],e=!0)}},t)o(n);return t},n.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.QHb={}},toJson:function(t){var e,o,r,i,a,s,l,u=this,c=u.Su;n.GC$.isEmptyObject(c)||(t.customFunctions=c),e=[],o=[],r=u.getCustomNames(),i=u.ELb(),a=u.Wu,s=this.getActiveSheet(),l=s?s.yj():null,r&&a&&(n.GC$.each(r,(function(t,o){var n,r=o.getName(),i=o.getRow(),s=o.getColumn(),u=o.getExpression(),c=o.getComment();u&&(n={name:r,formula:a.unparse(l,u,i,s,!1,!0),row:i,col:s},c&&(n.comment=c),e.push(n))})),n.GC$.each(i,(function(t,e){var n,r=e.getName(),i=e.getRow(),s=e.getColumn(),u=e.getExpression(),c=e.getComment();u&&(n={name:r,formula:a.unparse(l,u,i,s,!1,!0),row:i,col:s},c&&(n.comment=c),o.push(n))})),e.length>0&&(t.names=e),o.length>0&&(t.formatStringNames=o))},fromJson:function(t,e,o){var n,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x=this,A=x.Wu;if(A&&A.suspend(),x.clearCustomNames(),n=t.names)for(i=0;i<n.length;i++)a=n[i],x.Yu(this.Tu,a.name,a.formula,a.row,a.col,!0,a.comment);if(x.FLb(),s=t.formatStringNames)for(i=0;i<s.length;i++)a=s[i],x.Yu(this.QHb,a.name,a.formula,a.row,a.col,!0,a.comment);if(x.clearCustomFunctions(),l=t.customFunctions)for(u in l)l.hasOwnProperty(u)&&(c=l[u],(f=r.getTypeFromString(c.typeName))&&((h=new f).fromJSON(c,e),x.Xu(h)));if(m=[],g=t.sheets){for(C in p=0,g)"string"==typeof C&&(v=g[C],d=x.getSheetFromName(v.name||C),m.push(d),d.nameFunctionsFromJSON(v,e,o),p++);for(y=m.length,p=0;p<y;p++)(d=m[p]).yj().q$a=!0,d.formulaFromJSON(g[d.name()],e,o)}for(b=t.noRecalc||o&&o.doNotRecalculateAfterLoad,A&&(b?A.resumeWithoutCalc():A.resume(!0)),w=0,T=m;w<T.length;w++)(S=(d=T[w]).yj()).HIb(),delete S.q$a},egc:function(t,e,o){var n,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v=this,b=v.Wu;if(b&&b.suspend(),v.clearCustomNames(),n=t.names)for(i=0;i<n.length;i++)a=n[i],v.Yu(this.Tu,a.name,a.formula,a.row,a.col,!0,a.comment);if(v.clearCustomFunctions(),s=t.customFunctions)for(l in s)s.hasOwnProperty(l)&&(u=s[l],(c=r.getTypeFromString(u.typeName))&&((f=new c).fromJSON(u,e),v.Xu(f)));if(d=t.sheets,g=[],d){for(y in h=0,d)"string"==typeof y&&(C=d[y],p=v.getSheetFromName(C.name||y),g.push(p),p.nameFunctionsFromJSON(C,e,o),h++);for(m=g.length,h=0;h<m;h++)(p=g[h]).yj().q$a=!0,p.formulaFromJSON(d[p.name()],e,o)}o.incrementLoadTask.addTask((function(e,n,r){var i,a,s;for(b&&(t.noRecalc||o&&o.doNotRecalculateAfterLoad?b.resumeWithoutCalc():(b.resume(!0),v.getActiveSheet().$p())),i=0,a=g;i<a.length;i++)(s=(p=a[i]).yj()).HIb(),delete s.q$a}),[b,t,o])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function C(t){return t.Cf()}function v(){var t=this;return t.Ru?void(t.Ru=!1):(t.Su={},t.Tu={},t.eDc?t.eDc.clearAll():t.fDc=new s.SheetSource(t,n.SheetArea.colHeader),t.gDc?t.gDc.clearAll():t.hDc=new s.SheetSource(t,n.SheetArea.rowHeader),void(t.et?t.et.clearAll():t.ft=new s.SheetSource(t,n.SheetArea.viewport)))}function b(t,e,o,n,r,i){var a=t.Ms(e,o,n,r,i),s=a&&a.formulas;return s&&s.length>0}function w(t,e,o,n,r,i){var a,s=n.yj(),l=t&&t.formula;l&&(l=l.replace(/ANCHORARRAY\(([A-Z]+[0-9]+)\)/gi,"$1#").replace(/SINGLE\((.*)\)/gi,"@$1").replace(/ANCHORARRAY\((#[A-Z]+[\?!])\)/gi,"$1#"),(a=t.arrayInfo)&&!a.isDynamicArray?n.bv(e,o,m(a.rowCount,10),m(a.colCount,10),l,!0,i):(a&&(a.isInvalid&&s.GIb(e,o),s.yLb().setArray(s,a.row,a.col,a.rowCount,a.colCount,[],!0)),n._u(e,o,l,u,!0,i,!0,!a)))}function T(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d=r&&r.incrementLoadTask;if(d&&!d.isTerminated){for(s=d.isBusyFunc,l=i=i||0,t.suspendPaint(),30,u=new Date;l<o;){if(c=e[l])for(f=0;f<n;f++)w(c[f],l,f,t,0,a);if(l++,s&&s())break;if(new Date-u>30)break}t.resumePaint(),r||(r={}),(h=r&&r.incrementalLoading)&&h.loading&&(h.loadStatus.formulaLoad+=l-i,p=function(t,e){var o=t.formulaLoad/t.total;return e?.4*o+.5:.3*o+.4}(h.loadStatus,r.doNotRecalculateAfterLoad),h.loading(p,{sheet:t})),l<o&&r.incrementLoadTask.pushTask(T,[t,e,o,n,r,l])}}function S(t,e,o,r){var i=n.Worksheet._n;i&&f(i,(function(n,i){var a=i.fromJsonAfterFormula;a&&a.call(t,e,o,r)}))}function x(t,e,o,n,r){var i,a,s,l,u,c,h,p,d,m=!n&&t.ITa.dUa();if(t.parent&&t.parent.sheets)for(l=t.parent.sheets,u=t.parent.getCustomNames(),c=t.parent.ELb(),h=!g(t.parent.AO)&&t.parent.aXc(),u&&f(u,(function(i,l){a=l.getExpression(),(s=A(null,t,e,o,n,r,a))!==a&&l.fg(s,m)})),c&&f(c,(function(i,l){a=l.getExpression(),(s=A(null,t,e,o,n,r,a))!==a&&l.fg(s,m)})),h&&f(h,(function(i,l){a=l.getExpression(),(s=A(null,t,e,o,n,r,a))!==a&&l.fg(s,m)})),p=function(u){(i=l[u].getCustomNames())&&f(i,(function(i,c){a=c.getExpression(),(s=A(l[u],t,e,o,n,r,a))!==a&&c.fg(s,m)}))},d=0;d<l.length;d++)p(d);else(i=t.getCustomNames())&&f(i,(function(i,l){a=l.getExpression(),(s=A(t,t,e,o,n,r,a))!==a&&l.fg(s,m)}))}function A(t,e,o,n,r,i,s){var l,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,I,R,M,k,N,O,D,F,E,j,P,L,G=e.yj(),B=a.Hh(a.Errors.Reference,G);if(9===s.type){if(c=s.value,f=s.value2,h=A(t,e,o,n,r,i,c),p=f&&A(t,e,o,n,r,i,f),c!==h||f!==p)return a.Kh(s.operatorType,h,p)}else if(7===s.type){for(d=!1,g=[],m=void 0,y=0;y<s.arguments.length;y++)C=A(t,e,o,n,r,i,m=s.arguments[y]),d=d||m!==C,g.push(C);if(d)return a.Jh(s,g)}else if(1===s.type&&s.sf()){if(l=s.source||t&&t.yj(),w=v=s.row,T=b=s.column,l&&l===G&&(i&&!s.rowRelative||!i&&!s.columnRelative)){if(i&&r)v+=v>=o?n:0;else if(!i&&r)b+=b>=o?n:0;else if(i){if(v>=o+n)v-=n;else if(v>=o)return B}else if(b>=o+n)b-=n;else if(b>=o)return B;if(v!==w||b!==T)return a.rf(G,u,v,b,s.rowRelative,s.columnRelative)}}else if(1===s.type){if(l=s.source||t&&t.yj(),S=s.row,x=s.column,I=s.endRow,R=s.endColumn,M=s.rowRelative,k=s.columnRelative,N=s.endRowRelative,O=s.endColumnRelative,D=S,F=x,E=I,j=R,l&&l===G){if(i&&r)S+=!M&&S>=o?n:0,I+=!N&&I>=o?n:0;else if(!i&&r)x+=!k&&x>=o?n:0,R+=!O&&R>=o?n:0;else if(i&&!r){if(!M&&S>=o&&!N&&I<o+n)return B;if(M&&N||I<o)return s;if(!M)if(S>=o+n)S-=n;else if(S<o);else{if(N)return B;S>o&&(S=o)}if(!N)if(I>=o+n)I-=n;else{if(M)return B;I<o+n&&(I=o-1)}}else{if(!k&&x>=o&&!O&&R<o+n)return B;if(k&&O||R<o)return s;if(!k)if(x>=o+n)x-=n;else if(x<o);else{if(O)return B;x>o&&(x=o)}if(!O)if(R>=o+n)R-=n;else{if(k)return B;R<o+n&&(R=o-1)}}if(x!==F||R!==j||S!==D||I!==E)return a.uf(G,u,S,x,I,R,M,k,N,O)}}else if(10===s.type){if((P=s.value)!==(L=A(t,e,o,n,r,i,P)))return a.Lh(L)}else 13===s.type&&((l=s.source||t&&t.yj())&&l===G&&!i&&(s=s.offsetWhenInsertRemoveColumn(o,n,r)));return s}function I(t,e){var o,n,r,i,a,s,l,u=e.ah,c=u.getSource(),f=-1,h=-1;e.name?(n=e.name,i=e.id,g(i)?o=u.getNodeByName(n):(o={Lf:e.expression},r=!0)):(f=void 0===(f=e.row)?-1:f,h=void 0===(h=e.column)?-1:h,o=u.getNode(f,h)),a=o.Lf,s=o.Pf,l=t.unparse(c,a,f<0?0:f,h<0?0:h),s&&(!0!==t.allowDynamicArray||!0===t.allowDynamicArray&&!s.isDynamicArray)?f===s.row&&h===s.col&&u.setArrayFormula(s.row,s.col,s.rowCount,s.colCount,l):n?r?u.setFormula(i,n,l):u.setFormulaByName(n,l):u.setFormula(f,h,l,null,!0,!0),o.Lf.ehc=a.ehc}function R(t){var e,o,r,i,s,l,u,c,f,h,p=C(t),d=[p.getSourceModel(t.yj(n.SheetArea.colHeader)),p.getSourceModel(t.yj(n.SheetArea.rowHeader)),p.getSourceModel(t.yj())];for(e=0;e<d.length;e++){if(!(o=d[e]))return;for(r=o.getAllNodes(),i=0;i<r.length;i++)if(s=r[i].calc)for(l=s.Ze,u=void 0,c=0;c<l.length;c++)if(f=s[l[c]])for(h in f)(u=f[h])&&u instanceof a.PathCalc&&I(p,u)}}function M(t,e){var o=t.offset(0,0,!1,0,0);return o.rowRelative=o.endRowRelative=o.columnRelative=o.endColumnRelative=e,o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Core"),i=o("Common"),a=o("@grapecity/js-calc"),s=o("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=o("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),u=null,c=void 0,f=n.GC$.each,h=i.Common.u.Nb,p=new i.Common.ResourceManager(n.SR),d=p.getResource.bind(p),g=i.Common.j.Fa,m=parseInt,(y=n.Worksheet.prototype).resetCalc=function(){v.call(this),this.Ru=!0},y.recalcAll=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d,g=C(this);if(g){if(this.suspendPaint(),g.suspend(!0),t)for(void 0,o=(e=this.parent)&&e.sheets||[this],n=0;n<o.length;n++){if(i=(r=o[n]).Tu,a=r.yj(),i)for(s in i)u=(l=i[s]).Lf,c=g.unparse(a,u,0,0),l.Lf=g.parse(a,c,0,0);for(f=a.getCalcSourceModel().getAllNodes(),h=0;h<f.length;h++)(d=(p=f[h]).calc)&&p.Lf&&I(g,d)}g.resume(!0),this.resumePaint()}},y.recalcRange=function(t,e,o,n){var r=C(this);r&&r.recalcRange(this.yj(),t,e,o,n)},y.recalcRows=function(t){var e,o=C(this);if(o&&!o.ignoreDirty()){for(o.suspend(),e=0;e<t.length;e++)o.recalculate(this.ft,t[e],-1);o.resume(!1)}},y.recalcCols=function(t){var e,o=C(this);if(o&&!o.ignoreDirty()){for(o.suspend(),e=0;e<t.length;e++)o.recalculate(this.ft,-1,t[e]);o.resume(!1)}},y.zq=function(t,e,o){var n,r=C(this);r&&!r.ignoreDirty()&&(n=this.ft,1===o?n=this.fDc:2===o&&(n=this.hDc),r.recalculate(n,t,e))},y.getCalcService=function(){return this.Wu||(this.Wu=new a.CalcService,this.yj(n.SheetArea.colHeader).setCalcService(this.Wu),this.yj(n.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},y.Cf=function(){return this.getCalcService()},y.suspendCalcService=function(t){var e=C(this);e&&e.suspend(t)},y.resumeCalcService=function(t){var e=C(this);e&&e.resume(t)},y.yj=function(t){return g(t)||3===t?this.ft:1===t?this.fDc:2===t?this.hDc:u},y.Bj=function(t){var e=this;return 1===t?(!e.eDc&&e.fDc&&(e.eDc=e.Cf().getSourceModel(e.fDc)),e.eDc):2===t?(!e.gDc&&e.hDc&&(e.gDc=e.Cf().getSourceModel(e.hDc)),e.gDc):(!e.et&&e.ft&&(e.et=e.Cf().getSourceModel(e.ft)),e.et)},y.iDc=function(t,e,o,n,r){var i=this.Bj(r);return i&&i.tg(t,e,o,n,!0,!0)},y.Ns=function(t,e,o,n,r,i){var a=this.iDc(t,e,o,n,3);return!a&&r&&(n=this.getColumnCount(2),a=this.iDc(t,0,o,n,2)),!a&&i&&(o=this.getRowCount(1),a=this.iDc(0,e,o,n,1)),a},y.Ms=function(t,e,o,n,r){var i=this.Bj(r);return i&&i.tg(t,e,o,n,!1,!0)},y.Vq=function(t,e,o,n,r,i,a){var s,l;return void 0===r&&(r=!0),s=r&&this.Ns(t,e,o,n,i,a),l=!r&&function(t,e,o,n,r,i,a){var s=b(t,e,o,n,r,3);return!s&&i&&(r=t.getColumnCount(2),s=b(t,e,0,n,r,2)),!s&&a&&(n=t.getRowCount(1),s=b(t,0,o,n,r,1)),s}(this,t,e,o,n,i,a),!s&&!l||(this.Os(4,d().Exp_ChangePartOfArray),!1)},y.addCustomFunction=function(t){this.Xu(t),this.recalcAll()},y.Xu=function(t){if(!(t&&t instanceof a.Functions.Function))throw Error(d().Exp_InvalidCustomFunction);t.name=h(t.name),this.Su[t.name]=t},y.getCustomFunction=function(t){return t?this.Su[h(t)]:u},y.removeCustomFunction=function(t){t&&(delete this.Su[h(t)],this.recalcAll())},y.clearCustomFunctions=function(){this.Su={},this.recalcAll()},y.Pu=function(t){var e,o;return t?(this,e=this.parent,!(o=this.getCustomFunction(t))&&e&&e.getCustomFunction&&(o=e.getCustomFunction(t)),o):u},y.addCustomName=function(t,e,o,n,r){this.Yu(t,e,o,n,!1,r)},y.getCustomName=function(t){return t?this.Tu[h(t)]:c},y.getCustomNames=function(){var t=[];return f(this.Tu,(function(e,o){t.push(o)})),t},y.removeCustomName=function(t){var e,o;t&&(e=h(t),delete this.Tu[e],(o={})[e]=e,this.Zu(o,!1))},y.clearCustomNames=function(){var t=this.Tu;this.Tu={},this.Zu(t,!1)},y.createNameInfo=function(t,e,o,n,r){var i,a=C(this),l=this.yj();return a&&l?(i=a.parse(l,e,n,r),new s.NameInfo(t,i,n,r,o)):u},y.H$a=function(t){var e,o=!this.Tu[h(t)];return o&&((e=this.tables)&&(o=!e.findByName(t))),o},y.isValidCustomName=function(t){return t&&n.Ul.G$a(t)&&this.H$a(t)},y.Yu=function(t,e,o,n,r,i){var a,l,u,c,f=this;if(!t||!e||!r&&!f.isValidCustomName(t))throw Error(d().Exp_InvalidCustomName);if(a=C(f),l=f.yj(),a&&l){if(u=void 0,r)try{u=a.parse(l,e,o,n,!1,!1,!0)}catch(t){}else u=a.parse(l,e,o,n);f.Tu[h(t)]=new s.NameInfo(t,u,o,n,i),r||((c={})[t]=t,this.Zu(c,!0))}},y.Zu=function(t,e){var o,n=this.Bj();if(n){for(o in t)n.updateNameCalc(o,e);this.recalcAll()}},y.$u=function(t){var e,o;return t?(this,e=this.parent,!(o=this.getCustomName(t))&&e&&e.getCustomName&&(o=e.getCustomName(t)),o):u},y.setFormula=function(t,e,o,n){this._u(t,e,o,u,!1,n)},y._u=function(t,e,o,n,r,i,a,s,l){var f,h,p,m,y,C,v,b,w=this;return g(i)&&(i=3),t<0||t>=w.getRowCount(i)||e<0||e>=w.getColumnCount(i)?void w.Os(0,d().Exp_IndexOutOfRange):(f=t>=0?t:0,h=e>=0?e:0,p=w.yj(i),(n=n||(o&&w.Wu?w.Wu.parse(p,o,f,h,!1,r,r):u))&&s&&(n.ensureSingle=!0),m=w.tables,void(3===i&&t>=0&&e>=0&&m&&!m.Hma(t,e,1,1,o,n)||(y=w.Bj(i),C=w.conditionalFormats,y&&(v=y.getFormula(t,e),b=w.ITa,y.setFormula(t,e,o,n,r,c,b.dUa(),l),C&&C.Nm(),a?w.WXc(w,[{row:t,col:e}],0):w.Bq("formula",t,e,i,v,o)),w.t4&&w.t4(t,e,1,1,i),w.$p())))},y.setArrayFormula=function(t,e,o,n,r,i){this.bv(t,e,o,n,r,!1,i)},y.bv=function(t,e,o,n,r,i,a,s){var l,u,c,f,h,p,g;if(void 0===a&&(a=3),l=this,t<0||t+o>l.getRowCount()||e<0||e+n>l.getColumnCount())l.Os(0,d().Exp_IndexOutOfRange);else if(l.ITa.MTa(t,e,o,n))l.Os(0,d().Exp_ArrayFormulaSpan);else if(u=l.tables,!(3===a&&t>=0&&e>=0&&u)||u.Hma(t,e,o,n,r)){if(c=l.Bj(a),f=l.conditionalFormats,c&&(l.suspendEvent(),c.setArrayFormula(t,e,o,n,r,i,l.ITa.dUa(),s),l.resumeEvent(),f&&f.Nm(),l.jm<1)){for(h=[],p=t;p<t+o;p++)for(g=e;g<e+n;g++)h.push({row:p,col:g});l.Bu(t,e,o,n,h,5,a,r)}l.$p()}},y.getFormula=function(t,e,o,n){var r=this.Bj(o);return r?r.getFormula(t,e,n):u},y.Ima=function(t,e,o){var n=this.Bj(o);return n?n.Kf(t,e):u},y.getFormulaInformation=function(t,e){var o,r,i,a,s,l={},u=this.Bj();return u&&((o=u.Kf(t,e))?(r=u.Qf(t,e),l.hasFormula=!0,r&&!r.isDynamicArray&&(l.baseRange=new n.Range(r.row,r.col,r.rowCount,r.colCount)),l.isArrayFormula=r&&!r.isDynamicArray,t=r?r.row:t,e=r?r.col:e,l.formula=this.Wu.unparse(this.ft,o,t,e),l.formulaWithCulture=this.Wu.unparse(this.ft,o,t,e,!0),l.hasFormula=!!l.formula):(i=this.ITa.getDynamicArrayInfo(t,e))&&i.isValid&&(a=i.row,s=i.col,t===a&&e===s||(o=u.Kf(a,s),l.formulaWithCulture=this.Wu.unparse(this.ft,o,a,s,!0),l.hasFormula=!0,l.isDynamicArray=!0))),l},y.ngc=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,y;for(o||(o=this,n=t,r=e,i=[]),a=o.VXc(n,r),s=this.name(),l=0;l<a.length;l++){if(i[c=(u=a[l]).sheetName+"_"+u.row+"_"+u.col+"_"+u.rowCount+"_"+u.colCount])return!1;if(i[c]=!0,(u.row<=t&&t<u.row+u.rowCount||-1===u.rowCount)&&(u.col<=e&&e<u.col+u.colCount||-1===u.colCount)&&s===u.sheetName)return!0;for(f=u.sheetName===s?o:o.parent.getSheetFromName(u.sheetName),h=u.rowCount,p=u.row,d=u.colCount,g=u.col,-1===h&&(h=f.getRowCount(),p=0),-1===d&&(d=f.getColumnCount(),g=0),m=p;m<h+p;m++)for(y=g;y<d+g;y++)if(this.ngc(t,e,f,p,g,i))return!0}return!1},y.getPrecedents=function(t,e){var o,n,r,i,a=[],s=this.Bj();return s&&(o=s.Mf(t,e)||s.Kf(t,e),r=(n=this.getFormulaInformation(t,e).baseRange)?n.row:t,i=n?n.col:e,this.VGb(o,r,i,a),a=function(t){var e,o,n,r=[],i=[];for(e=0;e<t.length;e++)n=""+(o=t[e]).row+o.col+o.rowCount+o.colCount+o.sheetName,r.indexOf(n)<0&&(r.push(n),i.push(o));return i}(a)),a},y.getDependents=function(t,e){var o=[],n=this.parent&&this.parent.sheets||[this],r=this.name();return n.forEach((function(n){var i,a,s,l,u,c=n.getRowCount(),f=n.getColumnCount(),h=n.name();for(i=0;i<c;i++)for(a=0;a<f;a++)for(s=n.getPrecedents(i,a),l=0;l<s.length;l++)if((u=s[l]).sheetName===r&&(-1===u.row||u.row<=t&&t+1<=u.row+u.rowCount)&&(-1===u.col||u.col<=e&&e+1<=u.col+u.colCount)){o.push({row:i,col:a,rowCount:1,colCount:1,sheetName:h});break}})),o},y.VXc=function(t,e){var o,n,r,i,a,s,l,u,c,f={},h=this.Bj().qg(t,e),p=this.Bj().ug();if(h)for(n in o=h[0])o.hasOwnProperty(n)&&(a=(i=(r=o[n]).ah.xf)?i.kj.name():this.name(),f[(i?i.kj._id:this._id)+" "+r.row+" "+r.column]={row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a});if(p)for(n in s=p[0])if(s.hasOwnProperty(n)&&((-1===(l=s[n]).row||l.row<=t&&t+1<=l.row+l.rowCount)&&(-1===l.col||l.col<=e&&e+1<=l.col+l.colCount)))for(c in u=l.content)a=(i=(r=u[c]).ah.xf)?i.kj.name():this.name(),f[(i?i.kj._id:this._id)+" "+r.row+" "+r.column]={row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a};return function(t){var e,o=[];for(e in t)t.hasOwnProperty(e)&&o.push(t[e]);return o}(f)},y.VGb=function(t,e,o,n){var r,i,s,l,u;if(t)switch(t.type){case a.ExpressionType.reference:case a.ExpressionType.structReference:case a.ExpressionType.spillReference:r=t.getRange(e,o),n.push({row:r.row,col:r.col,rowCount:r.rowCount,colCount:r.colCount,sheetName:t.source&&t.source.kj?t.source.kj.name():this.name()});break;case a.ExpressionType.operator:this.VGb(t.value,e,o,n),this.VGb(t.value2,e,o,n);break;case a.ExpressionType.expand:case a.ExpressionType.parentheses:this.VGb(t.value,e,o,n);break;case a.ExpressionType.name:i=this.$u(t.value),this.VGb(i.getExpression(),e,o,n);break;case a.ExpressionType.function:for(s=t.arguments,l=0;l<s.length;l++)u=s[l],this.VGb(u,e,o,n)}},y.hasFormula=function(t,e){var o=this.Bj();return!!o&&o.hasFormula(t,e)},y.dv=function(){var t=this.Bj();t&&t.oYc((function(t){t.ng(),t.og()}))},y.clearFormula=function(t,e,o,n,r){var i,a,s=this;for(t<0&&(t=0,o=s.getRowCount()),e<0&&(e=0,n=s.getColumnCount()),i=0;i<o;i++)if(r(s,i+t))for(a=0;a<n;a++)s.setFormula(i+t,a+e,u)},y.nameFunctionsFromJSON=function(t,e,o,n){var i,a,s,l,u,c,f,h,p;if(t){if(i=this,a=t.customFunctions)for(s in a)a.hasOwnProperty(s)&&(l=a[s],(u=r.getTypeFromString(l.typeName))&&((c=new u).fromJSON(l,e),i.Xu(c)));if((f=t.names)&&f.length>0){for(h=0;h<f.length;h++)p=f[h],i.Yu(p.name,p.formula,p.row,p.col,!0,p.comment);i.dv()}n&&n()}},y.formulaFromJSON=function(t,e,o){var n,r,i;t&&(n=this,r=o&&o.ignoreFormula,i=o&&o.incrementalLoading,[t.colHeaderData,t.rowHeaderData,t.data].forEach((function(t,e){var a,s,l,u;t&&!r&&t.dataTable&&(a=e+1,s=t.dataTable,l=n.getRowCount(a),u=n.getColumnCount(a),i?T(n,s,l,u,o,0,a):function(t,e,o,n,r){var i,a,s;for(i=0;i<o;i++)if(a=e[i])for(s=0;s<n;s++)w(a[s],i,s,t,0,r)}(n,s,l,u,a))})),i?o.incrementLoadTask.pushTask(S,[n,t,e,o]):S(n,t,e,o))},y.ev=function(t){var e=this,o=e.Wu;o&&!t||(e.Wu=t||new a.CalcService,e.yj(n.SheetArea.colHeader).setCalcService(e.Wu),e.yj(n.SheetArea.rowHeader).setCalcService(e.Wu),e.yj(n.SheetArea.viewport).setCalcService(e.Wu),e.Wu.initParserContext(e.yj()),o?(t.setSourceModel(e.fDc,o.getSourceModel(e.fDc)),t.setSourceModel(e.hDc,o.getSourceModel(e.hDc)),t.setSourceModel(e.ft,o.getSourceModel(e.ft))):(e.eDc=e.Wu.getSourceModel(e.fDc),e.gDc=e.Wu.getSourceModel(e.hDc),e.et=e.Wu.getSourceModel(e.ft)))},y.setCalc=function(t,e){this.Wu=t,this.ft=e||this.ft,this.et=t.getSourceModel(this.ft),this.parent&&(this.parent.Wu=t)},y.fv=function(){this.gv(!1,1)},y.mUa=function(t,e){var o,r,i,a,s,l,u,c,f=this,h=t.changeType,p=t.row,d=t.rowCount,g=t.col,m=t.colCount,y=f.Bj();y&&(r=(o=f.ITa).dUa(),i=C(y),a=y.xf,s=i.ih(),l=i.lh.asyncManager,"addingRows"===h?f.Vq(p,0,0,f.getColumnCount(),void 0,!0,!1)?(u=f.Bj(2),s.onBeforeAddRemoveRows(y,p,u),e||n.clearSpillValuesOnAddRemove(o,p,d,!0,!0),x(f,p,d,!0,!0),[y,u].forEach((function(t){t.addRows(p,d)})),l.addRows(a,p,d)):t.canAdd=!1:"addRows"===h?(i.suspend(),u=f.Bj(2),s.onAfterAddRemoveRows(y,p,d,!0,e,u),i.resume(!1),r&&r.push({type:"addRows",row:p,rowCount:d})):"deletingRows"===h?f.Vq(p,0,d,f.getColumnCount(),void 0,!0,!1)?(u=f.Bj(2),s.onBeforeAddRemoveRows(y,p,u),e||n.clearSpillValuesOnAddRemove(o,p,d,!1,!0),x(f,p,d,!1,!0),[y,u].forEach((function(t){t.deleteRows(p,d)})),l.deleteRows(a,p,d)):t.canDelete=!1:"deleteRows"===h?(i.suspend(),u=f.Bj(2),s.onAfterAddRemoveRows(y,p,d,!1,e,u),i.resume(!1),r&&r.push({type:"deleteRows",row:p,rowCount:d})):"addingColumns"===h?f.Vq(0,g,f.getRowCount(),0,void 0,!1,!0)?(c=f.Bj(1),s.onBeforeAddRemoveColumns(y,g,c),e||n.clearSpillValuesOnAddRemove(o,g,m,!0,!1),x(f,g,m,!0,!1),[y,c].forEach((function(t){t.addColumns(g,m)})),l.addColumns(a,p,d)):t.canAdd=!1:"addColumns"===h?(i.suspend(),c=f.Bj(1),s.onAfterAddRemoveColumns(y,g,m,!0,e,c),i.resume(!1),r&&r.push({type:"addColumns",col:g,colCount:m})):"deletingColumns"===h?f.Vq(0,g,f.getRowCount(),m,void 0,!1,!0)?(c=f.Bj(1),s.onBeforeAddRemoveColumns(y,g,c),e||n.clearSpillValuesOnAddRemove(o,g,m,!1,!1),x(f,g,m,!1,!1),[y,c].forEach((function(t){t.deleteColumns(g,m)})),l.deleteColumns(a,p,d)):t.canDelete=!1:"deleteColumns"===h&&(i.suspend(),c=f.Bj(1),s.onAfterAddRemoveColumns(y,g,m,!1,e,c),i.resume(!1),r&&r.push({type:"deleteColumns",col:g,colCount:m})))},y.nUa=function(t,e,o){var n=o.type,r=this;"addRows"===n?(o.changeType="deletingRows",r.mUa(o,!0),o.changeType="deleteRows",r.mUa(o,!0)):"deleteRows"===n?(o.changeType="addingRows",r.mUa(o,!0),o.changeType="addRows",r.mUa(o,!0)):"addColumns"===n?(o.changeType="deletingColumns",r.mUa(o,!0),o.changeType="deleteColumns",r.mUa(o,!0)):"deleteColumns"===n?(o.changeType="addingColumns",r.mUa(o,!0),o.changeType="addColumns",r.mUa(o,!0)):"customName"===n?o.nameInfo.fg(o.expr):"condition"===n&&o.condition.setExpressions(o.expressions)},y.gUa=function(t){var e,o=C(this),n=this.Bj();for(o.suspend();t.length;)(e=t.pop()).type?this.nUa(o,n,e):n.$Va.apply(n,e);o.resume(!1)},y.getReferenceRange=function(t){var e,o=this.yj(),r=this.getCalcService().evaluate(o,t,0,0,!0);if(r instanceof a.CalcReference&&(e=r.getSource().getName(),r.getRangeCount()>0))return 0,{sheetName:e,range:n.kf(r.getRow(0),r.getColumn(0),r.getRowCount(0),r.getColumnCount(0))}},e.kDc=x,e.vyb=function(t,e,o,n,r,i,a,s,u,c){l.CalcOperatorAdjustor.copyFormula(t.Bj(),e,o,n.Bj(),r,i,a,s,u,c)},e.uyb=function t(e,o,n,r,i,s,u,c,f,h){var p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,k,N,O,D;if(9===h.type){if(p=h.value,d=h.value2,g=t(e,o,n,r,i,s,u,c,f,p),m=d&&t(e,o,n,r,i,s,u,c,f,d),p!==g||d!==m)return a.Kh(h.operatorType,g,m)}else if(7===h.type){for(y=!1,C=[],v=void 0,b=0;b<h.arguments.length;b++)w=t(e,o,n,r,i,s,u,c,f,v=h.arguments[b]),y=y||v!==w,C.push(w);if(y)return a.Jh(h,C)}else if(1===h.type){if(T=!function(t){return t.rowRelative}(h)&&!function(t){return t.columnRelative}(h),S=!function(t){return t.endRowRelative}(h)&&!function(t){return t.endColumnRelative}(h),x=o.yj(),(!h.source||h.source===x)&&T&&S)return A=i.yj(),I=new l.MoveSwapInfo(x,n,r,A,s,u,c,f),R=M(h,!0),k={isCustomName:!0},(N=l.adjustFormulaOnMoveSwap(x,0,0,R,I,!0,k))===R?h:1===N.type&&M(N,!1)||N}else if(10===h.type&&(O=h.value)!==(D=t(e,o,n,r,i,s,u,c,f,O)))return a.Lh(D);return h},n.Worksheet.$n("calc",{priority:1e3,init:v,dispose:function(t){var e,o,n,r=this;!1!==t.clearCache&&(r.ft=u,r.hDc=u,r.fDc=u,r.Wu=u,(e=r.et)&&(!0===t.isSheetDestroy?e.eHb():e.rzb(),r.et=u),(o=r.gDc)&&(!0===t.isSheetDestroy?o.eHb():o.rzb(),r.gDc=u),(n=r.eDc)&&(!0===t.isSheetDestroy?n.eHb():n.rzb(),r.eDc=u))},attach:function(t){t instanceof n.Workbook?this.ev(t.Wu):this.ev()},onLayoutChanged:function(t){this.Cf().isAdjustSuspended()||this.mUa(t)},toJson:function(t,e){var o,r,i,a,s,l,u,c=this,h=c.Su;n.GC$.isEmptyObject(h)||(t.customFunctions=h),o=e&&e.newWorkSheetName,r=[],i=c.getCustomNames(),a=C(c),s=c.Bj(),l=s.xf,i&&a&&(!g(o)&&s&&l&&(l.JXc=o),f(i,(function(t,e){var o,n=e.getName(),i=e.getRow(),s=e.getColumn(),l=e.getExpression(),u=e.getComment();l&&(o={name:n,formula:a.unparse(c.yj(),l,i,s,!1,!0,!0),row:i,col:s},u&&(o.comment=u),r.push(o))})),r.length>0&&(t.names=r),delete l.JXc),e&&e.ignoreFormula||(u=[c.et,c.eDc,c.gDc],[t.data,t.colHeaderData,t.rowHeaderData].forEach((function(t,e){var n=u[e];n&&(l=n.xf,g(o)||(l.JXc=o),n.toJSON({data:t}),delete l.JXc)})))},fromJson:function(t,e,o,n){var r=this;o&&o.incrementalLoading||(r.clearCustomFunctions(),r.clearCustomNames()),n&&(r.nameFunctionsFromJSON(t,e,o),r.formulaFromJSON(t,e,o))},setName:function(t){R(this),C(this.Bj()).lh.asyncManager.changeSourceName(t.oldName,t.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./dist/plugins/slicer/slicer-actions.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function c(t){if(t.canUndo()){var e=t.kj,o=n.Commands.bWa(e.name()),r=t.VQ[o];return t.Lz(e,!0),e.ITa.undo(r),t.Mz(e,!0),!0}return!1}function f(t,e,o){var n,r,i=t.parent,a=t.slicers.get(o);i&&e.xC&&a&&(n=a.startRow(),r=a.startColumn(),i.changeSelectionInCommandExecuting(e,n,r,[],[a]))}function h(t,e){for(var o=0;o<t.length;o++)if(t[o].columnName===e)return t[o]._ps&&t[o]._ps.name}Object.defineProperty(e,"__esModule",{value:!0}),r=(n=o("Core")).Commands.ActionBase,i=function(t){function e(e,o){return t.call(this,e,o)||this}return u(e,t),e.prototype.canExecute=function(){return!!this.VQ.slicerData},e.prototype.execute=function(){var t,e,o=this,r=o.VQ;return!!o.canExecute()&&(f(t=o.kj,r,h(r.slicerData.Ze,r.columnName)),t.ITa.startTransaction(),o.Lz(t,!0),r.slicerData.doFilter(r.columnName,{exclusiveRowIndexes:r.newValue}),o.Mz(t,!0),e=n.Commands.bWa(t.name()),o.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.canUndo=function(){return!!this.VQ.slicerData},e.prototype.undo=function(){return c(this)},e}(r),a=function(t){function e(e,o){return t.call(this,e,o)||this}return u(e,t),e.prototype.canExecute=function(){return!!this.VQ.slicerData},e.prototype.execute=function(){var t,e,o=this,r=o.VQ;return!!o.canExecute()&&(f(t=o.kj,r,h(r.slicerData.Ze,r.columnName)),t.ITa.startTransaction(),o.Lz(t,!0),r.slicerData.doUnfilter(r.columnName),o.Mz(t,!0),e=n.Commands.bWa(t.name()),o.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.canUndo=function(){return!!this.VQ.slicerData},e.prototype.undo=function(){return c(this)},e}(r),s=function(t){function e(e,o){return t.call(this,e,o)||this}return u(e,t),e.prototype.canExecute=function(){return!!this.VQ.slicer},e.prototype.execute=function(){var t,e=this,o=e.VQ;return!!e.canExecute()&&(f(t=e.kj,o,h(o.slicerData.Ze,o.columnName)),e.Lz(t,!0),o.slicer[o.propertyName](o.newValue),e.Mz(t,!0),!0)},e.prototype.canUndo=function(){return!!this.VQ.slicer},e.prototype.undo=function(){var t,e=this,o=e.VQ;return!!e.canUndo()&&(t=e.kj,e.Lz(t,!0),o.slicer[o.propertyName](o.oldValue),e.Mz(t,!0),!0)},e}(r),l=n.Commands.h4,n.Commands.filterSlicer={canUndo:!0,execute:function(t,e,o){return l(t,i,e,o)}},n.Commands.unfilterSlicer={canUndo:!0,execute:function(t,e,o){return l(t,a,e,o)}},n.Commands.changeSlicerProperty={canUndo:!0,execute:function(t,e,o){return l(t,s,e,o)}},n.Commands.unfilterSlicerByKey={canUndo:!1,execute:function(t,e){var o,r,i,a=n.Commands.bT(t,e),s=a.slicers.UX();if(1===s.length&&(r=(o=s[0]).YX()))return i=r.getFilteredIndexes(o.columnName()),a.wu().execute({cmd:"unfilterSlicer",sheetName:a.name(),slicerData:r,columnName:o.columnName(),value:i})}}},"./dist/plugins/slicer/slicer.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n(o("./dist/plugins/slicer/slicer.ns.js")),o("./dist/plugins/slicer/slicer-actions.js"),n(o("./dist/plugins/slicer/tableSlicer.js"))},"./dist/plugins/slicer/slicer.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/slicer/slicer.res.en.js");e.SR={en:n}},"./dist/plugins/slicer/slicer.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Blank="(blank)",e.Exp_SlicerNameInvalid="The slicer name is not valid.",e.Exp_SlicerNameExist="The slicer name is already in use; please enter a unique name."},"./dist/plugins/slicer/tableSlicer.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt,Yt,Kt,Qt,$t,te,ee,oe,ne,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,Ce,ve,be,we,Te,Se,xe,Ae,Ie,Re,Me,ke,Ne,Oe,De,Fe,Ee,je,Pe,Le,Ge=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();for(Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("FloatingObject"),a=o("Tables"),s=o("ConditionalFormatting"),l=o("./dist/plugins/slicer/slicer.ns.js"),u=new r.Common.ResourceManager(l.SR,"Slicers"),c=u.getResource.bind(u),f=r.Common.D,h=r.Common.k,p=n.Ul.Nl,d=n.Ul.Pl,g=n.Ul.Ol,m=h.ac,y=n.Ul.hZa,C=n.GC$.isArray,v=n.GC$.extend,b=document,w=void 0,T=null,S="normal 11pt calibri",x=parseFloat,A=r.Common.j,I=A.Fa,R=r.Slicers.GeneralSlicerData,function(t){t[t.CONTAINER=0]="CONTAINER",t[t.H_SPACE=1]="H_SPACE",t[t.H_CAPTION=2]="H_CAPTION",t[t.H_SPLITLINE=3]="H_SPLITLINE",t[t.H_CLEARFILTER=4]="H_CLEARFILTER",t[t.B_ITEM=5]="B_ITEM",t[t.B_ITEMSPACER=6]="B_ITEMSPACER",t[t.B_TAIL=7]="B_TAIL",t[t.B_SCROLLBAR=8]="B_SCROLLBAR"}(M||(M={})),function(t){t[t.HOVERED=1]="HOVERED",t[t.SELECTED=2]="SELECTED",t[t.UNSELECTED=4]="UNSELECTED",t[t.HASDATA=8]="HASDATA",t[t.NODATA=16]="NODATA"}(k||(k={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ACTIVE=1]="ACTIVE",t[t.HOVERED=2]="HOVERED"}(N||(N={})),D="name",F="style",E="light",j="dark",P="white",L="black",G="solid",B="color",_="background-color",V="width",H="height",z="font","setBorders",U="back"+(O={GLb:"Style",HLb:"Color",ILb:"Width",JLb:"border",KLb:"WithDataStyle",LLb:"WithNoDataStyle",MLb:"electedItem",NLb:"hovered",OLb:"top",PLb:"gc-slicer-",QLb:"container",RLb:"header",SLb:"clearfilter",TLb:"body",ULb:"itemscontainer",VLb:"item"}).HLb,W="fore"+O.HLb,q=O.JLb+"Width",J=O.JLb+O.GLb,X=O.JLb+O.HLb,Z=O.JLb+"Left",Y=O.JLb+"Top",K=O.JLb+"Right",Q=O.JLb+"Bottom",$="textDecoration",tt="wholeSlicer"+O.GLb,et="header"+O.GLb,ot="s"+O.MLb+O.KLb,nt="s"+O.MLb+O.LLb,rt="unS"+O.MLb+O.KLb,it="unS"+O.MLb+O.LLb,at=O.NLb+"S"+O.MLb+O.KLb,st=O.NLb+"S"+O.MLb+O.LLb,lt=O.NLb+"UnS"+O.MLb+O.KLb,ut=O.NLb+"UnS"+O.MLb+O.LLb,ct="undoFilter",ft="undoAdd",ht="undoRemove",pt="undoUpdateTableSlicer",dt="div",gt="px",mt="default",yt="cursor",Ct="position",vt="absolute",bt="padding",wt="margin-"+O.OLb,Tt="left",St="right",xt="text-align",At="overflow",It="hidden",Rt="auto",Mt="text-overflow",kt="ellipsis",Nt="white-space",Ot="nowrap",Dt="unselectable",Ft="on",Et="font-weight",jt="font-size",Pt="border-radius",Lt="box-sizing",Gt="content-box",Bt="button",_t="✗",Vt="mark",Ht="itemValue",zt="Accent ",Ut="Slicer"+O.GLb,Wt="#999999",qt="#828282",Jt="#CCCCCC",Xt=O.PLb+O.QLb,Zt=O.PLb+O.RLb,Yt=O.PLb+"header-borderDiv",Kt=O.PLb+"caption",Qt=O.PLb+O.SLb,$t=O.PLb+O.TLb,te=O.PLb+"table",ee=O.PLb+"tr",oe=O.PLb+"td1",ne=O.PLb+"td2",re=O.PLb+O.ULb,ie=O.PLb+O.VLb,ae="gc-no-user-select",se=function(){function t(e,o,n,r,i,a,s,l){for(var u=0,c=m(t.properties);u<c;u++)this[t.properties[u]](arguments[u])}return t.prototype.setBorders=function(t){this[Z](t)[Y](t)[K](t)[Q](t)},t.prototype.fromJSON=function(e){if(e&&!n.GC$.isEmptyObject(e)){var o=this;t.properties.forEach((function(t){var n,r=e[t];g(r)&&(t.indexOf(O.JLb)>=0?((n=_e()).fromJSON(r),o[t](n,!1)):o[t](r,!1))}))}},t.prototype.toJSON=function(){var e=this,o={};return t.properties.forEach((function(t){var n=e[t]();e[t].isDefault(n)||(o[t]=n&&n.toJSON?n.toJSON():n)})),o},t.properties=[U,W,z,Z,Y,K,Q,$],t}(),e.SlicerStyleInfo=se,le=0,ue=m(se.properties);le<ue;le++)se.prototype[se.properties[le]]=d(se.properties[le]);function Be(t){var e,o;return t&&0!==m(t)?0===t.indexOf(E)?(o=parseInt(t.replace(E,""),10),e=me[E+o]()):0===t.indexOf(j)?(o=parseInt(t.replace(j,""),10),e=me[j+o]()):me[t]&&(e=me[t]()):e=new se,e}for(ce=function(){function t(e,o,n){for(var r=0;r<t.properties.length;r++)this[t.properties[r]](arguments[r])}return t.prototype.fromJSON=function(e){var o,r;if(e&&!n.GC$.isEmptyObject(e))for(o=0;o<t.properties.length;o++)r=t.properties[o],g(e[r])&&this[r](e[r],!1)},t.prototype.toJSON=function(){var e,o,n,r={};for(e=0;e<t.properties.length;e++)r[t.properties[e]]=this[t.properties[e]]();for(n in o={},r)r[n]!==w&&r[n]!==T&&(o[n]=r[n]);return o},t.properties=[q,J,X],t}(),e.SlicerBorder=ce,fe=function(t,e,o){return d(t,e,o,(function(e){var o=typeof e;return t===q?"number"===o&&e>=0:"string"===o}))},le=0;le<ce.properties.length;le++)ce.prototype[ce.properties[le]]=fe(ce.properties[le],w,w);function _e(t,e,o){return new ce(t,e,o)}function Ve(t){var e=0;return t.indexOf(Ut+"Light")>-1&&17===m(t)&&(e=parseInt(t[16],10)),t.indexOf(Ut+"Dark")>-1&&16===m(t)&&(e=parseInt(t[15],10)),e>=1&&e<=6}for(he=function(){function t(){this[D]("",!1),this[tt](function(){var t=new ce(0,"",""),e=new se(P,L,S);return e.setBorders(t),e}(),!1)}return t.prototype.fromJSON=function(e){var o,r,i,a;if(e&&!n.GC$.isEmptyObject(e))return o=this,r=e.name,g(r)&&(o.name(r),Ve(r))?(i=r.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),a=Be(i),void t.properties.forEach((function(t){o[t](a[t](),!1)}))):void t.properties.forEach((function(t){var n,r=e[t];t!==D&&g(r)&&((n=Be()).fromJSON(r),o[t](n,!1))}))},t.prototype.toJSON=function(){var t,e,o,r=this;for(o in e={},t=Ve(r.name())?{name:r.name()}:r.toJSONInternal())t[o]===T||t[o]===w||n.GC$.isEmptyObject(t[o])||(e[o]=t[o]);return e},t.prototype.toJSONInternal=function(){var e,o,n,r=this,i={};for(i[D]=r.name(),e=1,o=m(t.properties);e<o;e++)i[n=t.properties[e]]=r[n]()?r[n]().toJSON():T;return i},t.properties=[D,tt,et,ot,nt,rt,it,at,st,lt,ut],t}(),e.SlicerStyle=he,pe=function(t,e,o,n){return d(t,e,o,n)},le=1,de=m(he.properties);le<de;le++)he.prototype[he.properties[le]]=pe(he.properties[le]);function He(){return new he}function ze(t,e,o){var n=Be();return n[W](t)[U](e).setBorders(o),n}function Ue(t){var e=zt+t;return ge("Light",t,S,P,_e(1,G,e),_e(0,"",""),_e(1,G,e),L,e+",Lighter 60%",_e(1,G,Wt),qt,e+",Lighter 80%",_e(1,G,Jt),L,P,_e(1,G,Jt),qt,P,_e(1,G,"#E0E0E0"),L,"#F9E36F",_e(1,G,Wt))}function We(t){var e=zt+t,o=",Lighter 60%";return ge("Dark",t,S,P,_e(1,G,e),_e(0,"",""),_e(1,G,e),P,e,_e(1,G,e),e+",Darker 25%",e+o,_e(1,G,e+o),L,"#C0C0C0",_e(1,G,"#C0C0C0"),"#959595","#DFDFDF",_e(1,G,"#DFDFDF"),L,"#F9E36F",_e(1,G,Wt))}for(he.prototype.name=pe(D,""),ge=function(t,e,o,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w){var T,S,x=He(),A=Ut+t+e;return x[D](A),(T=Be()).font(o),T.backColor(n),T.setBorders(r),x.wholeSlicerStyle(T),(S=Be()).borderLeft(i),S.borderTop(i),S.borderRight(i),S.borderBottom(a),x.headerStyle(S),x[ot](ze(s,l,u)),x[nt](ze(c,f,h)),x[rt](ze(p,d,g)),x[it](ze(m,y,C)),function(t,e){t[at](e)[st](e)[lt](e)[ut](e)}(x,ze(v,b,w)),x},me=function(){},e.SlicerStyles=me,ye=1;ye<=6;ye++)me["light"+ye]=function(t){return function(){return Ue(t)}}(ye),me["dark"+ye]=function(t){return function(){return We(t)}}(ye);function qe(t,e){var o,n,r,i,a,s=t.KW,l=t._caption,u=Ye(t.slicerData),c=t.zoomFactor();if(e)for(a in e[tt]&&(Qe(t.xo,e[tt],u,l,c),Co(t,O.QLb)),o=t.LW,n=Xe(e[tt],e[et]),function(t){var e,o=t[et];return!(o&&(o[Z]||o[Y]||o[K]||o[K])&&(e=Xe(t[tt],o),!(e[Q]&&e[Q][q]>0)||e[Z]&&0!==e[Z][q]||e[Y]&&0!==e[Y][q]||e[K]&&0!==e[K][q]))}(e)?(i=(r=n[Q])&&r[q]||0,o[F][H]=(t.MW-i)*$e(e)*c+gt,Ke(o,r,u,Q),n[Z]=n[Y]=n[K]=n[Q]=T):(o[F][Q+V]=0+gt,o[F][H]=s[F][H]),Qe(s,n,u,l,c),Co(t,O.RLb),t.NW)f(t.NW,a)&&go(t,parseInt(a,10))}function Je(t,e,o){var r,i,a={};if(e&&o&&m(e)===m(o)){for(r=0,i=m(e);r<i;r++)a[e[r]]=o[r];n.GC$(t).css(a)}}function Xe(t,e){var o,n={};if(e)for(o in e)f(e,o)&&(n[o]=e[o]);if(t)for(o in t)n[o]===w&&t[o]!==w&&(n[o]=t[o]);return n}function Ze(t,e){return e?(t&&e.getColor&&(o=e.getColor(t)),o):t;var o}function Ye(t){var e=t&&t.OW&&t.OW();return e&&e.currentTheme()}function Ke(t,e,o,n){if(t){var r=e&&e[q]||0,i=e&&e[J]||"",a=e&&e[X]||"";t[F][n+O.ILb]=r+gt,t[F][n+O.GLb]=i,t[F][n+O.HLb]=Ze(a,o)}}function Qe(t,e,o,i,a){var s,l,u,c;t&&e&&(s=e[W]||L,l=e[U]||P,u=e[z]||S,t[F][_]=Ze(l,o),t[F][B]=Ze(s,o),t[F][z]=y(n.To.No(u,a)[z]),Ke(t,e[Z],o,Z),Ke(t,e[Y],o,Y),Ke(t,e[K],o,K),Ke(t,e[Q],o,Q),c=n.To.So(e[$]),r.Common.u.Bb(t.className,Zt)?i[F][$]=c:r.Common.u.Bb(t.className,ie)&&(t[F][$]=c))}function $e(t){var e,o,r,i,a,s,l,u,c;return t?(e=Xe(t[tt],t[et]))&&e[z]?(o=e[z],r=1,s=(i=n.To.Ko)((a=n.To.Jo)(S)).fontSize,l=i(a(o)).fontSize,s&&l&&(u=x(s),c=x(l),isNaN(c)||(r=c/u)),r):1:1}function to(t){var e,o,n,r,i,a=0,s=0;return t&&(o=(e=t[F])[Z+O.ILb],n=e[Y+O.ILb],r=e[K+O.ILb],i=e[Q+O.ILb],o&&(a+=x(o)),n&&(s+=x(n)),r&&(a+=x(r)),i&&(s+=x(i))),{widthOffset:a,heightOffset:s}}function eo(t){var e,o,n=[];if(t)for(o=0;o<m(t);o++)e=t[o]===w||t[o]===T||""===t[o]?c().Blank:t[o]+"",n.push(e);return n}function oo(t){var e=p(dt);return Je(e,[Ct,bt,Lt,At],[vt,6*t.zoomFactor(),Gt,It]),n.GC$(e).addClass(Xt),Co(t,O.QLb),n.GC$(e).append(function(t){var e,o,r,i,a,s,l,u,c=p(dt),f=p(dt),h=p("span"),d=p(dt),g=t.zoomFactor(),m=t.style();return Je(c,[V,Ct,O.OLb,Tt,St,Lt,At],[Rt,vt,0,0,0,Gt,It]),n.GC$(c).addClass(Zt),t.KW=c,e=t.PW*g,Je(f,[V,Ct,Tt,St,Lt,At],[Rt,vt,e,e,Gt,It]),n.GC$(f).addClass(Yt),t.LW=f,n.GC$(c).append(f),o=t.QW*$e(m)*g,r=ro(t)*g,Je(h,[Lt,Ct,O.OLb,At,V,Mt,Nt],[Gt,vt,o,It,r,kt,Ot]),n.GC$(h).text(t.captionName()).attr(Dt,Ft).addClass(Kt+" "+ae),t._caption=h,i=t.RW*g,a=t.SW*g,s=t.TW*$e(m)*g,l=t.UW*g,u=t.VW*g+gt,Je(d,[V,H,yt,Ct,O.OLb,St,xt,Lt,Et,Pt,At,jt],[i,a,mt,vt,s,l,"center",Gt,"normal",2,It,u]),n.GC$(d).attr("title","Clear Filter (Alt+C)").attr(Dt,Ft).text(_t).addClass(Qt+" "+ae),t.WW=d,Co(t,O.RLb),n.GC$(f).append(h).append(d),c}(t)).append(function(t){var e,o=p(dt),r=p("table"),i=p("tr"),a=p("td"),s=p("td"),l=(t.MW-t.PW+t.XW)*$e(t.style())*t.zoomFactor();return Je(o,[V,At,wt,Lt],[Rt,It,l,Gt]),n.GC$(o).attr(Dt,Ft).addClass($t+" "+ae),t.YW=o,Je(r,[Lt,"border-spacing"],[Gt,0+gt]),n.GC$(r).attr(Dt,Ft).addClass(te+" "+ae),t.ZW=r,n.GC$(i).css(Lt,Gt).addClass(ee),t.$W=i,Je(a,[bt,Lt],[0,Gt]),n.GC$(a).addClass(oe),t._W=a,Je(s,[bt,Lt,yt],[0,Gt,mt]),n.GC$(s).addClass(ne),t.aX=s,n.GC$(a).append(function(t){var e,o,r,i,a,s,l,u=p(dt),c=t.zoomFactor();for(t.cX=u,o=io(t),t.dX=o,e=ao(t),t.eX=e,Je(u,[V,H,jt],[e*c,o*c,t.VW*c+gt]),n.GC$(u).attr(Dt,Ft).addClass(re+" "+ae),r=lo(t),t.fX=r,i=Math.min(so(t),m(r)),a=0;a<i;a++)s=r[a],l=no(t,s,a),n.GC$(u).append(l),t._items.push(l),t.NW[t.gX.indexOf(s)]=l;return u}(t)),e=uo(t),n.GC$(s).append(e),t.bX=e,n.GC$(i).append(a).append(s),n.GC$(r).append(i),n.GC$(o).append(r),o}(t)),e}function no(t,e,o){var r,i,a=e,s=p(Bt),l=t.zoomFactor(),u=t.hX*l+gt;return Je(s,[xt,Nt,wt,yt,Lt,Pt,bt,At,Mt,_],[Tt,Ot,u,mt,Gt,5,"1px 6px",It,kt,P]),n.GC$(s).attr("type",Bt).attr(Dt,Ft).text(a).addClass(ie+" "+ae),(r=t.slicerData.kj)&&(i=r.parent),i&&i.options.enableAccessibility&&n.GC$(s).attr("tabindex",-1),(o+1)%t.columnCount()!=0&&n.GC$(s).css("margin-right",t.hX*l+gt),Co(t,O.VLb,s),s}function ro(t){var e,o,n=t.xo,r=t.KW,i=1,a=1,s=0,l=0,u=function(t){return t?x(t):0},c=O.JLb+"Left"+O.ILb,f=O.JLb+"Right"+O.ILb;return n&&(i=u((e=n.style)[c]),a=u(e[f])),r&&(s=u((o=r.style)[c]),l=u(o[f])),t.width()-(i+a)-2*t.PW-(s+l)-t.RW}function io(t){var e=to(t.xo),o=t.height()-2*t.PW-e.heightOffset;return t.showHeader()?o-t.MW*$e(t.style())-t.XW:o}function ao(t){var e=to(t.xo),o=t.width()-2*t.PW-e.widthOffset-1;return t.iX()?o-t.jX:o}function so(t){return Math.ceil(t.dX/(t.itemHeight()+2*(t.kX+t.lX)+t.hX))*t.columnCount()}function lo(t){var e,o,n,r,i,a,s=t.gX,l=t.mX(s.slice(0),t.sortState()),u=t.slicerData.getFilteredOutIndexes(t.columnName,2);if(t.showNoDataItems()){if(t.visuallyNoDataItems()&&t.showNoDataItemsInLast()){for(e=[],n=m(l),r=void 0,i=void 0,r=0;r<n;r++)i=l[r],h.Bb(u,s.indexOf(i))||e.push(i);for(r=0;r<n;r++)i=l[r],h.Bb(u,s.indexOf(i))&&e.push(i);l=e}}else for(e=l.concat(),o=0;o<m(e);o++)h.Bb(u,s.indexOf(e[o]))&&h.Fb(l,e[o]);return a=c().Blank,h.Bb(l,a)&&(h.Fb(l,a),l.push(a)),l}function uo(t){var e,o=new n.hv(!1);return t.nX=o,e=o.Bv(),n.GC$(e).bind("scroll.gcScrollbar",(function(e,o){var n=o.scrollEventType,r=o.scrollOrientation;e.data=t,1===r&&([0,1,2,3,5].indexOf(n)>=0&&t.Bw(e,o))})),e}function co(t){var e=t.slicerData;t.data=e.getData(t.columnName),t.exclusiveDatas=e.getExclusiveData(t.columnName),t.oX=eo(t.data),t.gX=eo(t.exclusiveDatas),t.fX=lo(t),yo(t),po(t)}function fo(t,e){var o,r=t.style(),i=t.xo;i&&(e!==w&&e!==t.zoomFactor()&&(t.zoomFactor(e),qe(t,r)),n.GC$(i).css(bt,6*e),Co(t,O.QLb),function(t){var e,o,r,i,a,s,l,u,c,f,h=t.zoomFactor(),p=t.KW,d=t.YW,g=t._caption,y=t.WW,C=t.style();t.showHeader()?(t.xo.firstChild!==p&&(n.GC$(p).insertBefore(d),n.GC$(d).css(wt,(t.MW+t.XW)*$e(C)*h)),n.GC$(p).css(H,t.MW*$e(C)*h),e=t.PW*h,Je(t.LW,[Tt,St],[e,e]),g.innerHTML!==t.captionName()&&n.GC$(g).text(t.captionName()),o=t.QW*$e(C)*h,r=ro(t)*h,Je(g,[O.OLb,V,Et],[o,r,"bold"]),i=t.pX,a=i&&m(i)>0?1:0,So(t,a),s=t.RW*h,l=s,u=t.TW*$e(C)*h,c=t.UW*h,f=t.VW*h+gt,Je(y,[V,H,O.OLb,St,jt],[s,l,u,c,f]),Co(t,O.RLb)):n.GC$(p).remove()}(t),o=t.showHeader()?(t.MW+t.XW-t.PW)*$e(r)*e:0,n.GC$(t.YW).css(wt,o),ho(t),yo(t))}function ho(t){var e,o=t.zoomFactor(),n=io(t);t.dX=n,e=ao(t),t.eX=e,Je(t.cX,[V,H,jt],[e*o,n*o,t.VW*o]),po(t)}function po(t){var e,o,r,i,a,s,l,u,c=t.fX;if(c){for((e=t._items)&&m(e)>0&&n.GC$(e).remove(),t._items=[],e=t._items,t.NW={},o=Math.min(so(t),m(c)),r=t.iX()?t.nX.value()*t.columnCount():0,i=Math.min(r+o,m(c)),a=r;a<i;a++)l=no(t,s=c[a],a),n.GC$(t.cX).append(l),e.push(l),t.NW[t.gX.indexOf(s)]=l;if(0!==m(e))for(u in t.NW)f(t.NW,u)&&go(t,parseInt(u,10))}}function go(t,e){var o=t.qX,n=o?t.gX.indexOf(o[Ht]):-1,r=t.pX,i=t.rX,a=t.NW[e],s=0;e===n&&(s|=1),s|=h.Bb(r,e)?4:2,s|=h.Bb(i,e)&&t.visuallyNoDataItems()?16:8,mo(t,a,s)}function mo(t,e,o){var n,r=t.style();if(e&&r){switch(o){case 10:n=ot;break;case 18:n=nt;break;case 12:n=rt;break;case 20:n=it;break;case 11:n=at;break;case 19:n=st;break;case 13:n=lt;break;case 21:n=ut}Qe(e,Xe(r[tt],r[n]),Ye(t.slicerData),t._caption,t.zoomFactor()),Co(t,O.VLb,e)}}function yo(t){var e,o,r,i,a,s=t.bX,l=t.aX;t.iX()?(s||(s=uo(t)),l.firstChild!==s&&(n.GC$(l).append(s),ho(t)),e=t.zoomFactor(),o=t.dX,r=Math.floor(o/(t.itemHeight()+2*t.kX+t.hX)),(i=t.nX).value(t.sX),i.Vo(t.jX*e,!1),i._v(o*e,!1),i.bw(0),i.cw(Math.ceil(m(t.gX)/t.columnCount())-r),i.dw(r),i.qB(1),i.rB(r-1),i.ew()):(l.firstChild===s&&((a=s.parentElement)&&a.removeChild(s),ho(t)),t.sX=0)}function Co(t,e,o){var r,i,a,s,l,u,c,f,h,p,d=t.zoomFactor();switch(e){case O.QLb:l=to(s=t.xo),u=t.PW,r=(t.width()-2*u)*d-l.widthOffset,i=(t.height()-2*u)*d-l.heightOffset,a=s;break;case O.RLb:f=to(c=t.KW),h=t.MW*$e(t.style())*d-f.heightOffset,n.GC$(c).css(H,h),r=t.RW*d,i=t.SW*d,a=t.WW;break;case O.VLb:p=to(o),r=function(t,e){var o=t.columnCount();return(e-(o-1)*t.hX)/o}(t,t.eX)*d-2*t.tX-p.widthOffset,i=t.itemHeight()*d-p.heightOffset,a=o}Je(a,[V,H],[r,i])}function vo(t){var e=t.xo,o=".slicer",r="mouse",i="wheel",a="DOMMouseScroll";e&&(n.GC$(e).bind(r+"down"+o,(function(e){t.AD(e)})).bind(r+"move"+o,(function(e){t.BD(e)})).bind(r+"out"+o,(function(e){t.uX()})),e.addEventListener(r+i,(function(e){t.Rw(e)}),!1),e.addEventListener(a,(function(e){t.Rw(e)}),!1),n.GC$(b).bind(r+"up"+o,(function(e){!function(t,e){var o=t.qX;t.CD(e),o=o?new we(o[Vt],o[Ht]):T,t.qX=T,xo(t,o)}(t,e)})).bind("keydown"+o,(function(e){t.nm(e)})).bind("keyup"+o,(function(e){t.om(e)})),b.addEventListener(r+i,(function(e){t.Rw(e)}),!1),b.addEventListener(a,(function(e){t.Rw(e)}),!1))}function bo(t){var e,o,n,r,i,a=t._items;if(a&&0!==m(a))for(e=t.rX,o=0,n=m(a);o<n;o++)r=a[o],i=t.gX.indexOf(a[o].innerHTML),mo(t,r,h.Bb(e,i)?20:12)}function wo(t,e){var o,n,r=t.gX;if(r)for(o=0,n=m(r);o<n;o++)if(r[o]===e)return o;return-1}function To(t,e){var o,n,r=t.pX,i=t.rX;for(o=0;o<m(e);o++)n=0,n|=t.yX?h.Bb(r,e[o])?2:4:2,n|=h.Bb(i,e[o])&&t.visuallyNoDataItems()?16:8,mo(t,t.NW[e[o]],n)}function So(t,e){var o,r,i,a=t.WW;if(a)switch(o=t.style(),r=Xe(o[tt],o[et]),i=r&&r[U],i||(i=P),t.zX=i,e){case 0:t.AX=!1,Je(a,[B,_],[t.BX,i]);break;case 1:t.AX=!0,Je(a,[B,_],[t.CX,i]);break;case 2:n.GC$(a).css(_,t.DX)}}function xo(t,e){var o,n;if(e)switch(o=t.vX,e[Vt]){case 4:if(!t.WW)return;t.AX?So(t,1):So(t,0);break;case 5:n=t.gX.indexOf(e[Ht]),o&&h.Bb(o,n)?To(t,o):go(t,n)}}function Ao(t,e){var o,n,r=t._items;if(r&&e!==T)for(o=0;o<m(r);o++)if((n=r[o]).innerHTML.toLowerCase()===e.toLowerCase())return n;return T}function Io(t,e){var o,n,r,i,a,s,l,u,c,f,h,p=Ro(t,O.QLb),d=T,g=T;if(!p)return T;if(o=e.pageX,n=e.pageY,r=Ro(t,O.RLb),i=Ro(t,O.SLb),a=Ro(t,O.TLb),s=Ro(t,O.ULb),r&&r.contains(o,n))d=i&&i.contains(o,n)?4:1;else if(a&&a.contains(o,n))if(l=t._items,s&&s.contains(o,n)&&l){for(u=void 0,u=0;u<m(l);u++)if((c=Ro(t,O.VLb,u))&&c.contains(o,n)){for(f in d=5,t.NW)if(t.NW[f]===l[u]){g=t.gX[f];break}break}u>=m(l)&&(d=(h=Ro(t,O.VLb,m(l)-1))&&n<h.y+t.itemHeight()*t.zoomFactor()?6:7)}else d=8;else d=0;return new we(d,g)}function Ro(t,e,o){var r,i,a,s,l,u,c,f,h,p,d=e===O.QLb?w:Ro(t,O.QLb),g=t.xo,y=t.EX,C=t.PW,v=t.zoomFactor(),b=t.style(),S=t.showHeader(),x=t.MW,A=t.RW,I=t.gX;switch(e){case O.QLb:r=0,i=0,a=g.offsetWidth,s=g.offsetHeight;do{r+=g.offsetLeft,i+=g.offsetTop,g=g.offsetParent}while(g);break;case O.RLb:if(!d||!S)return T;r=d.x+y*v,i=d.y+y*v,a=t.width()*v,s=x*$e(b)*v;break;case O.SLb:if(!d||!S)return T;r=d.x+d.width-(y+C+A)*v,i=d.y+y+t.QW*$e(b)*v,a=A*v,s=t.SW*v;break;case O.TLb:if(!d)return T;l=y+C,0,u=x*$e(b)+t.XW,r=d.x+l*v,i=d.y+0*v+(S?u*v:0),a=(t.width()-2*l)*v,s=d.height-0*v-(S?u*v:0);break;case O.ULb:if(!(c=Ro(t,O.TLb)))return T;if(!t.iX())return c;r=c.x,i=c.y,a=c.width-t.jX*t.zoomFactor(),s=c.height;break;case O.VLb:if(!d||0===m(I)||o>=m(I))return T;if(!(f=Ro(t,O.ULb)))return T;h=t.columnCount(),p=t.hX,a=(f.width-(h-2)*p*v)/h,s=t.itemHeight()*v+2*t.lX,r=f.x+o%h*(a+p*v),i=f.y+Math.floor(o/h)*(s+p*v)}return new n.Rect(r,i,a,s)}function Mo(t){return t>0}function ko(t){return function(e,o){var n=this;n.fX=lo(n),fo(n),n.onPropertyChanged(t,e,o)}}function No(t,e,o,r){return o||(o=function(t){return function(e,o){fo(this),this.onPropertyChanged(t,e,o)}}(t)),n.Ul.Pl(t,e,o,r)}for(me.other1=function(){return ge("Other",1,S,P,_e(1,G,"#808080"),_e(0,"",""),_e(1,G,"#A6A6A6"),L,"#BFBFBF",_e(1,G,Wt),L,"#D9D9D9",_e(1,G,Jt),L,P,_e(1,G,Jt),"#959595",P,_e(1,G,"#E0E0E0"),L,"#F9E36F",_e(1,G,Wt))},me.other2=function(){return ge("Other",2,S,P,_e(1,G,"#4F81BD"),_e(0,"",""),_e(1,G,"#4F81BD"),L,"#A9C1E3",_e(1,G,Wt),qt,"#D5E2F6",_e(1,G,Jt),L,P,_e(1,G,Jt),qt,P,_e(1,G,"#E0E0E0"),L,"#F9E36F",_e(1,G,Wt))},Ce=function(){function t(t,e,o){var n=this;n.name(t,!1),n.xo=T,n.PW=6,n.EX=1,n.VW=14,n.KW=T,n.MW=27,n.XW=5,n._caption=T,n.WW=T,n.RW=28,n.SW=25,n.TW=3,n.UW=0,n.AX=!1,n.QW=3,n.YW=T,n.ZW=T,n.$W=T,n._W=T,n.aX=T,n.cX=T,n.eX=0,n.dX=0,n.bX=T,n.FX=2,n._items=[],n.NW={},n.lX=1,n.kX=1,n.tX=6,n.hX=2,n.jX=17,n.sX=0,n.zX=P,n.DX="#F9E578",n.CX="red",n.BX="#B0ADB0",n.GX=!1,n.HX=!1,n.vX=[],n.wX=[],n.xX=0,n.fX=[],n.pX=[],n.rX=[],n.gX=[],n.oX=[],n.slicerData=e,n.columnName=o,n.data=e.getData(o),n.exclusiveDatas=e.getExclusiveData(o),n.slicerData.attachListener(n),n.IX()}return t.getDefaultStyle=function(){var t=function(t,e,o,n,r,i,a,s){var l={};return l[U]=t,l[W]=e,l[z]=o,l[Z]=n,l[Y]=r,l[K]=i,l[Q]=a,l[$]=s,l},e=function(t,e,o){var n={};return n[q]=t,n[J]=e,n[X]=o,n},o=e(1,G,"#808080"),n=e(0,"",""),r=e(1,G,"#999999"),i=e(1,G,"#CCCCCC"),a=e(1,G,"#E0E0E0"),s=t("#F9E36F",L,S,r,r,r,r),l={};return l[tt]=t(P,L,S,o,o,o,o),l[et]=t(P,L,"bold 11pt calibri",n,n,n,e(1,G,"#A6A6A6")),l[ot]=t("#BFBFBF",L,S,r,r,r,r),l[nt]=t("#D9D9D9",L,S,i,i,i,i),l[rt]=t(P,L,S,i,i,i,i),l[it]=t(P,"#959595",S,a,a,a,a),l[at]=s,l[st]=s,l[lt]=s,l[ut]=s,l},t.prototype.IX=function(){var t=this;t.oX=eo(t.data),t.gX=eo(t.exclusiveDatas),t.xo=oo(t),t.captionName(t.columnName,!1),vo(t),t.onFiltered(),qe(t,t.style()),fo(t)},t.prototype.getDOMElement=function(){return this.xo},t.prototype.mX=function(t,e){var o,n,i=[];if(0!==e){for(o=r.Slicers.jf.quickSort(t),n=0;n<m(o);n++)i[n]=o[n].value;return 2===e&&i.reverse(),i}},t.prototype.iX=function(){var t=this,e=t.gX,o=t.showNoDataItems()?m(e):m(e)-m(t.rX);return Math.ceil(o/t.columnCount())*(t.itemHeight()+2*(t.lX+t.kX)+t.hX)>t.dX},t.prototype.Bw=function(t,e){this.JX(t,e)},t.prototype.JX=function(t,e){var o=this,n=e.newValue;n!==o.sX&&n<=o.nX.cw()&&(o.sX=n,yo(o),po(o))},t.prototype.onDataChanged=function(){co(this)},t.prototype.onRowsChanged=function(){co(this)},t.prototype.onColumnNameChanged=function(t,e){var o=this;o.columnName===t&&o._caption&&(o.columnName=e,o.captionName(e,!1),n.GC$(o._caption).text(e))},t.prototype.onColumnRemoved=function(t){var e=this;t===e.columnName&&(e.slicerData.doUnfilter(t),function(t){var e=t.xo;e&&n.GC$(e).unbind(".slicer")}(e),n.GC$(e.xo).remove(),e.xo=T)},t.prototype.onFiltered=function(){var t=this,e=t.slicerData,o=t.columnName;t.fX=lo(t),t.rX=e.getFilteredOutIndexes(o,2),t.pX=e.getFilteredOutIndexes(o,1),fo(t)},t.prototype.xmb=function(t){var e,o=Io(this,t);return!!o&&(5===(e=o.mark)||6===e||8===e||4===e)},t.prototype.AD=function(t){var e=this,o=Io(e,t);o&&(8===o[Vt]&&(e.HX=!0),5===o[Vt]&&(e.wX=[],e.GX=!0,t.ctrlKey?function(t,e){var o,n,r,i=t.exclusiveDatas,a=t.pX,s=wo(t,e[Ht]),l=t.vX,u=t.wX;for(h.Bb(l,s)?h.Fb(l,s):l.push(s),o=0;o<m(i);o++)h.Bb(a,o)||u.push(o);for(n=0;n<m(l);n++)h.Bb(u,l[n])?h.Fb(u,l[n]):u.push(l[n]);if(0===m(u))for(r=0;r<m(t.gX);r++)u.push(r);t.xX=s}(e,o):t.shiftKey?function(t,e){var o,n,r,i,a,s,l,u,c=t.fX,f=t.gX,h=f[t.xX];for(bo(t),o=c.indexOf(h),n=c.indexOf(e[Ht]),r=Math.min(o,n),i=Math.max(o,n),a=r;a<=i;a++)s=f.indexOf(c[a]),l=t.vX,u=t.wX,-1===l.indexOf(s)&&l.push(s),-1===u.indexOf(s)&&u.push(s)}(e,o):function(t,e){bo(t);var o=wo(t,e[Ht]);go(t,o),t.vX.push(o),t.wX.push(o),t.xX=o}(e,o)),To(e,e.vX),(5===o[Vt]||6===o[Vt]||8===o[Vt]||4===o[Vt]&&e.AX)&&t.stopPropagation())},t.prototype.CD=function(t){var e,o,n,r=this,i=Io(r,t);i&&(e=r.slicerData,o=r.vX,n=!1,4===i[Vt]?r.AX&&(e.doUnfilter(r.columnName),So(r,0),n=!0):o&&m(o)>0&&!r.yX&&!r.KX&&(e.doFilter(r.columnName,{exclusiveRowIndexes:r.wX}),n=!0),r.GX=!1,r.HX=!1,n&&(r.vX=[],r.wX=[]))},t.prototype.BD=function(t){var e,o,n,r,i,a,s,l,u,c,f,p,d,g=this,y=g.qX,C=y?new we(y[Vt],y[Ht]):T,v=Io(g,t),b=g.gX,w=g.wX;if(v&&(!C||C[Vt]!==v[Vt]||5===C[Vt]&&C[Ht]!==v[Ht])){if(!g.GX)return g.qX=v,xo(g,C),void function(t,e){if(e)switch(e[Vt]){case 4:if(!t.WW||!t.AX)return;So(t,2);break;case 5:var o=t.gX.indexOf(e[Ht]);go(t,o);break;case 6:t.cX.style.cursor=mt}}(g,v);if(5===v[Vt])if(e=b.indexOf(v[Ht]),o=g.rX,n=void 0,r=void 0,i=void 0,h.Bb(w,e)){for(s=(a=g.fX).indexOf(b[g.xX]),l=a.indexOf(v[Ht]),u=Math.min(s,l),c=Math.max(s,l),f=[],p=m(w),n=0;n<p;n++)d=w[n],((r=a.indexOf(b[d]))>c||r<u)&&f.push(d);for(p=m(f),n=0;n<p;n++)i=Ao(g,b[r=f[n]]),h.Bb(o,r)?mo(g,i,20):mo(g,i,12),h.Fb(w,r)}else i=Ao(g,b[e]),h.Bb(o,e)?mo(g,i,18):mo(g,i,10),h.Sb(w,e);g.qX=v}},t.prototype.uX=function(){var t=this,e=t.qX,o=e?new we(e[Vt],e[Ht]):T;t.qX=T,xo(t,o)},t.prototype.Rw=function(t){return 8===Io(this,t)[Vt]&&(t.stopPropagation(),!0)},t.prototype.nm=function(t){var e=this;17!==t.keyCode||e.yX||(e.yX=!0),16!==t.keyCode||e.KX||(e.KX=!0)},t.prototype.om=function(t){var e=this,o=e.slicerData;17===t.keyCode&&e.yX&&(e.yX=!1),16===t.keyCode&&e.KX&&(e.KX=!1),!e.yX&&!e.KX&&m(e.vX)>0&&(o.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),e.vX=[],e.wX=[])},t.prototype.onPropertyChanged=function(t,e,o){var n=this;n.slicerData.OW&&n.slicerData.OW().ITa.xVa(n,t,o)},t}(),e.ItemSlicer=Ce,ve=[[D],[V,180],[H,210],["captionName",""],["columnCount",1,T,Mo],["itemHeight",21,T,Mo],["showHeader",!0],["sortState",1,ko("sortState")],["showNoDataItems",!0,ko("showNoDataItems")],["showNoDataItemsInLast",!0,ko("showNoDataItemsInLast")],["visuallyNoDataItems",!0,ko("visuallyNoDataItems")],[F,Ce.getDefaultStyle(),function(t,e){qe(this,t),fo(this),this.onPropertyChanged("visuallyNoDataItems",t,e)}],["zoomFactor",1,T,Mo],["isLocked"],["disableResizingAndMoving"]],le=0,be=m(ve);le<be;le++)Ce.prototype[ve[le][0]]=No(ve[le][0],ve[le][1],ve[le][2],ve[le][3]);function Oo(t,e,o){var n,r,i,a,s=t.kj,l=t.dataRange(),u=l.row+l.rowCount-1,c=l.col+l.colCount-1;for(n=l.row;n<=u;n++)for(r=[],e.push(r),i=l.col;i<=c;i++)r.push({value:s.getValue(n,i),text:s.getText(n,i)});for(i=0;i<l.colCount;i++)a=t.getColumnName(i)||"",o.push(a)}function Do(t,e,o){var n,r,i,a,s,l,u,c,f,p,d,g,y,C,v,b;for(n=0;n<o.length;n++){if(r=t.sj,i=t.xr,l=(a=o[n]-r.range().col)+(s=r.dataRange()).col,u=t.columnNames[a],c=[],f={},h.Bb(i.Je,l)){for(p=[],d=s.row;d<s.row+s.rowCount;d++)i.E0a(d,l)||p.push(d);for(g=0;g<m(p);g++)y=p[g]-s.row,f[C=t.getExclusiveRowIndex(u,y)]||(f[C]=!0,c.push(C))}else for(v=m(t.getExclusiveData(u)),b=0;b<v;b++)c.push(b);Fo(Eo(t,u),c)||(e.prototype.doFilter.call(t,u,{exclusiveRowIndexes:c}),t.onFiltered(),t.kj.$p())}}function Fo(t,e){if(I(t)&&I(e))return!0;if(I(t)&&!I(e)||!I(t)&&I(e)||!I(t)&&!I(e)&&(!C(t)||!C(e))||t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}function Eo(t,e){var o,n=t.getExclusiveData(e),r=t.getFilteredOutIndexes(e,1),i=[];for(o=0;o<m(n);o++)h.Bb(r,o)&&i.push(o);return i}function jo(t){var e=t.sj,o=e.kj,n=e&&e.rowFilter();return!o.options.isProtected||n&&n.TX(o)}function Po(t,e){var o,n,r=t.VX;if(e){for(o=e.getTable(),n=0;n<m(r);n++)if(r[n].getTable()===o)return;r.push(e)}}function Lo(t,e){h.Fb(t.VX,e)}function Go(t,e){var o,n,r,i=t.VX;for(o=0;o<m(i);o++)if(r=(n=i[o]).getTable(),n&&r&&r.tableName()===e)return n;return T}function Bo(t,e,o){var n;return e?f(_o(t),e)&&(n=c().Exp_SlicerNameExist):n=c().Exp_SlicerNameInvalid,n&&o&&(o.error=Error(n)),!n}function _o(t){var e,o,n,r=t.kj,i={},a=r&&r.parent&&r.parent.sheets;if(a)for(e=0;e<m(a);e++)for(n in o=a[e].slicers.XX())f(o,n)&&(i[n]=o[n]);return i}function Vo(t){return t.ZX.getTable()}function Ho(t){return t.$X}function zo(t,e,o,n){return De.push(t),d(t,e,(function(e,n){o.call(this,t,e,n)}),n)}function Uo(t,e){var o,n,r,i;for(o=0,n=t.sheets;o<n.length;o++)for(r=0,i=n[o].slicers.all();r<i.length;r++)if(i[r].name().toLowerCase()===e.toLowerCase())return!0;return!1}function Wo(t,e,o){var n,r,i=this,a=i.$X||[];for(n=0;n<m(a);n++)a[n][t]&&("style"===t?a[n][t](e.toJSONInternal()):a[n][t](e));(r=i.sheet())&&(r.ITa.xVa(i,t,o),i.Wq({sheet:r,sheetName:r.name(),slicer:i,propertyName:t}))}for(we=function(t,e){this[Vt]=t===w?T:t,this[Ht]=e===w?T:e},Te=function(t){function e(e){var o,n,r=[],i=[],a=e.rowFilter();return Oo(e,r,i),n=t.call(this,r,i)||this,(o=n).sj=e,o.kj=e.kj,o.xr=a,o.MX=T,function(t,e){var o,n,r=t.kj,i=t.sj.rowFilter();for(r.suspendPaint(),o=i&&i.Je||[],n=0;n<m(o);n++)Do(t,e,[o[n]]);r.resumePaint()}(o,R),a&&(a.filterHandler=function(t){Do(o,R,t.columns)}),n}return Ge(e,t),e.prototype.no=function(){var t=this;t.MX=T,t.sj=T,t.xr&&(t.xr.filterHandler=T,t.xr=T),t.kj=T},e.prototype.OW=function(){return this.kj},e.prototype.getTable=function(){return this.sj},e.prototype.doFilter=function(e,o,n){var r,i,a,l,u,c,f,h,p,d,g,y,C,v,b,w,T=this,S=T.kj,x=T.sj,A=T.xr,I=o.ranges,R=o.exclusiveRowIndexes,M=!!R;if(S.ITa.xVa(T,ct,{columnName:e,oldValue:T.getFilteredIndexes(e)}),!((r=T.getColumnIndex(e))<0||!M&&!I))if(n)t.prototype.doFilter.call(this,e,o,n);else{if(i=M?T.getExclusiveData(e):T.getData(e),a=[],M)a=R;else for(l=T.ef(),u=T.ff(),l[r]||T.We(r),c=l[r],f=0;f<m(I);f++)for(h=I[f],d=(p=T.Xe(c,h)).start;d<=p.end;d++)a.push(u[r][d]);if(S.suspendPaint(),g=x.startColumn()+r,A&&A.removeFilterItems(g,!0),S.AR(),s.$V){for(y=[],C=0;C<m(a);C++)(v=s.$V(2,0,i[a[C]])).useWildCards(!1),y.push(v);A&&A.addFilterItem(g,y)}t.prototype.hf.call(this,e,o),b=[],w={},T.gf(e,b,w),A&&(A.filter(g,!0),A.onFilter(A.SX(0,[g]))),T.onFiltered(),S.resumePaint()}},e.prototype.doUnfilter=function(e){var o,n=this,r=n.kj,i=n.sj,a=n.getColumnIndex(e),s=n.xr;-1!==a&&(r.ITa.xVa(n,ct,{columnName:e,oldValue:n.getFilteredIndexes(e)}),o=i.startColumn()+a,s.removeFilterItems(o),t.prototype.if.call(this,e),s.unfilter(o,!0),s.onFilter(s.SX(0,[o])),n.onFiltered(),n.kj.$p())},e.prototype.refresh=function(){var t=[],e=[];Oo(this.sj,t,e),this.bf(t,e)},e.prototype.onColumnNameChanged=function(e,o){t.prototype.onColumnNameChanged.call(this,e,o),this.kj.slicers.all().forEach((function(t){t.columnName(o)}))},e.prototype.onRowsAdded=function(e,o){var n,r,i=this,a=i.kj,s=i.sj.dataRange();for(t.prototype.onRowsAdded.call(this,e,o,!0),n=e;n<e+o;n++)for(r=0;r<m(i.columnNames);r++)i.data[n][r]={value:a.getValue(s.row+n,s.col+r),text:a.getText(s.row+n,s.col+r)};i.bf(i.data,i.columnNames),i.cf("onRowsChanged",e,o,!0)},e.prototype.onRowsRemoved=function(e,o){t.prototype.df.call(this,e,o,!1)},e.prototype.onColumnsAdded=function(t,e){var o,n,r,i,a=this,s=a.kj,l=a.sj,u=l.dataRange(),c=a.data,f=a.columnNames;for(o=0;o<m(c);o++)for(n=t;n<t+e;n++)c[o].splice(n,0,{value:s.getValue(u.row+o,u.col+n),text:s.getText(u.row+o,u.col+n)});for(r=t;r<t+e;r++)i=l.getColumnName(r)||"",f.splice(r,0,i);a.bf(c,f)},e.prototype.onColumnsRemoved=function(e,o){var n,r,i=this,a=i.kj,s=i.sj.name(),l=i.columnNames,u=[];for(n=e;n<e+o;n++)u.push(l[n]);t.prototype.onColumnsRemoved.call(this,e,o),r=a&&a.slicers,u.forEach((function(t){r.all(s,t).forEach((function(t){r.remove(t.name())}))}))},e.prototype.onTableRemoved=function(t){var e,o,n,r=this;t&&t===r.sj&&(r.MX=[],e=r.kj,o=e.slicers,n=t.name(),o.all(n).forEach((function(t){r.MX.push(t),o.remove(t.name())})),o&&Lo(o,r),r.Ze=[])},e.prototype.onTableAdded=function(t){var e=this.kj.slicers;e&&t&&t.Aq()&&Po(e,t.getSlicerData()),(this.MX||[]).forEach((function(t){var o=t.name(),n=t.ZX.sj.name(),r=t.columnName(),i=t.style();e.add(o,n,r,i)}))},e}(R),e.TableSlicerData=Te,a.Table&&n.GC$.extend(a.Table.prototype,{getSlicerData:function(){var t=this;return t.ZX||(t.ZX=new Te(t)),t.ZX}}),Se=function(t){function e(e,o,n){var r=t.call(this,e,o,n)||this;return r.isSelected(!1),r}return Ge(e,t),e.prototype.no=function(){var t=this;t.sj=T,t.slicer(T),t.sheet(T)},e.prototype.IX=function(){var e=this,o=e.slicerData;o&&o instanceof Te&&(e.sheet(o.OW()),e.sj=o.getTable()),t.prototype.IX.call(this)},e.prototype.onColumnRemoved=function(t){var e,o=this,n=o.sheet(),r=o.sj,i=o.slicerData;t===o.columnName&&(e=i.getFilteredOutIndexes(t,1),0!==m(e)&&i.doUnfilter(t),n&&r&&n.wr.Fb(o.name()))},e.prototype.mX=function(t,e){var o,n,i,a,s,l,u=this,c=u.slicerData,f=c.getColumnIndex(u.columnName),h=u.sj.dataRange(),p=[];if(0===e)return t;for(o=[],n=c.OW(),i=0;i<m(t);i++)a=c.getRowIndexes(u.columnName,i),o.push(n.getValue(h.row+a[0],h.col+f));for(s=r.Slicers.jf.quickSort(o),l=0;l<m(s);l++)p[l]=t[s[l].index];return 2===e&&p.reverse(),p},e.prototype.Bw=function(e,o){var n,r,i=this.sheet(),a=this.slicer();for(a&&i.ER(a)||(o.newValue=o.oldValue),n=Ho(a),r=0;r<m(n);r++)t.prototype.JX.call(this,e,o)},e.prototype.AD=function(e){var o,n,r,i=this,a=i.sheet(),s=i.slicer();if(s&&a.ER(s)){if(o=Io(i,e),!jo(i)&&(5===o[Vt]||6===o[Vt]||8===o[Vt]))return void e.stopPropagation();for(n=Ho(s),r=0;r<m(n);r++)t.prototype.AD.call(this,e)}},e.prototype.CD=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d,g=this,y=g.sheet(),C=g.slicer();if(C&&y.ER(C)&&jo(g)&&(e=Io(g,t))){for(o=g.slicerData,n=g.vX,r=g.wX,i=o.getExclusiveData(g.columnName),a=!1,s=T,4===e[Vt]||5===e[Vt]&&m(r)===m(i)&&!g.yX&&!g.KX?(l=o.getFilteredIndexes(g.columnName),s=y.wu().execute({cmd:"unfilterSlicer",sheetName:y.name(),slicerData:o,columnName:g.columnName,value:l}),a=!0):n&&m(n)>0&&!g.yX&&!g.KX&&(u=o.getFilteredIndexes(g.columnName),c=r.concat(),s=y.wu().execute({cmd:"filterSlicer",sheetName:y.name(),slicerData:o,columnName:g.columnName,oldValue:u,newValue:c}),a=!0),f=Ho(C),h=0,p=m(f);h<p;h++)(d=f[h]).GX=!1,d.HX=!1,a&&(d.vX=[],d.wX=[]);return!!s}},e.prototype.BD=function(e){var o,n,r=this,i=r.sheet(),a=r.slicer();if(a&&!r.HX&&i.ER(a))for(o=Ho(a),n=0;n<m(o);n++)t.prototype.BD.call(this,e)},e.prototype.uX=function(){var e,o,n=this.sheet(),r=this.slicer();if(r&&n.ER(r))for(e=Ho(r),o=0;o<m(e);o++)t.prototype.uX.call(this)},e.prototype.Rw=function(e){var o,n,r,i,a=this;return!(!t.prototype.Rw.call(this,e)&&(o=a.sheet(),I(o)||(n=o.slicers,r=n&&n.UX(),i=a.nX,!(r&&1===m(r)&&a.isSelected()&&a.iX()&&i)||(i.sC(e),e.stopPropagation(),0))))},e.prototype.om=function(t){var e,o,n,r,i=this,a=i.slicerData,s=i.sheet(),l=i.wX;17===t.keyCode&&i.yX&&(i.yX=!1),16===t.keyCode&&i.KX&&(i.KX=!1),!i.yX&&!i.KX&&m(i.vX)>0&&(e=m(a.getExclusiveData(i.columnName)),m(l)===e?(o=a.getFilteredIndexes(i.columnName),s.wu().execute({cmd:"unfilterSlicer",sheetName:s.name(),slicerData:a,columnName:i.columnName,value:o})):(n=a.getFilteredIndexes(i.columnName),r=l.concat(),s.wu().execute({cmd:"filterSlicer",sheetName:s.name(),slicerData:a,columnName:i.columnName,oldValue:n,newValue:r})),i.vX=[],i.wX=[])},e}(Ce),Se.prototype.isSelected=d("isSelected",!1),Se.prototype.sheet=d("sheet"),Se.prototype.slicer=d("slicer"),xe=function(){function t(t){var e=this;e.kj=t,e.VX=[],e.WX={}}return t.prototype.no=function(){var t=this;t.WX&&(n.GC$.each(t.WX,(function(t,e){e.no()})),t.WX=T),t.VX&&(t.VX.forEach((function(t){t.no()})),t.VX=T),t.kj=T},t.prototype.add=function(t,e,o,n){var r,i=this.kj,a=i.parent.jga(e);return a&&-1!==a.getColumnIndexInTable(o)?(i.suspendPaint(),r=new Fe(t,a,o),n&&r.style(n),this.Cz(r),i.wr.Sb(r),i.resumePaint(),r):T},t.prototype.Cz=function(t){var e,o,n=this,r=n.kj;if(t){if(!Bo(n,e=t.name(),o={}))throw o.error;n.WX[e]=t,Po(n,t.YX()),r.ITa.xVa(n,ft,e)}},t.prototype.get=function(t){return t===T||t===w?T:this.WX[t]},t.prototype.remove=function(t){var e=this.kj;this.vV(t),e.wr.Fb(t)},t.prototype.vV=function(t){var e,o,n,r=this,i=r.kj,a=r.WX,s=r.get(t);if(s&&f(a,t)){for(e=s.YX(),o=Ho(s),n=0;n<m(o);n++)e.detachListener(o[n]);i.ITa.xVa(r,ht,s),delete r.WX[t]}},t.prototype.U3=function(t,e){var o,n=this,r=n.kj,i={};if(!Bo(n,e,i))throw i.error;o=n.WX[t],delete n.WX[t],n.WX[e]=o,r.wr.U3(t,e)},t.prototype.clear=function(){var t=this,e=t.kj;e.suspendPaint(),n.GC$.each(this.WX,(function(e,o){t.remove(o.name())})),e.resumePaint()},t.prototype.all=function(t,e){var o=[];return n.GC$.each(this.WX,(function(n,r){t&&(Vo(r).name()!==t||e&&r.columnName()!==e)||o.push(r)})),o},t.prototype.tTa=function(t,e,o){i.FloatingObjectCollection.prototype.tTa.call(this,t,e,o)},t.prototype.XX=function(){return this.WX},t.prototype.HS=function(t){var e,o,n=_o(this);if(!f(n,t))return t;for(e=1," ",o=t.split(" ")[0];f(n,o+" "+e);)e++;return o+" "+e},t.prototype.UX=function(){var t,e,o,r=this.WX;if(!r||n.GC$.isEmptyObject(r))return[];for(e in t=[],r)f(r,e)&&((o=r[e])&&o.isSelected()&&t.push(o));return t},t.prototype.W3=function(t){var e,o,n=this.UX();if(1!==m(n))return!1;if(e=Ho(n[0]),m(e)>0){for(o=0;o<m(e);o++)e[o].Rw(t);return!0}return!1},t.prototype.toJSON=function(t){var e,o=[],r=this.WX;if(r&&!n.GC$.isEmptyObject(r))for(e in r)f(r,e)&&o.push(r[e].toJSON(t));return o},t.prototype.fromJSON=function(t){var e,o,n,r,i,a,s;if(t&&0!==m(t))for(this,o=(e=this.kj).parent,this.WX={},n=0;n<m(t);n++)r=t[n].tableName,i=t[n].columnName,r&&i&&((a=o.jga(r))&&-1!==a.getColumnIndexInTable(i)&&((s=new Fe(t[n].name,a,i)).sheet(e),s.fromJSON(t[n]),e.slicers.Cz(s),e.wr.Sb(s)))},t}(),e.SlicerCollection=xe,"nameInFormula",Ae="captionName","columnCount",Ie="columnName","itemHeight","showHeader","sortState",Re="disableResizingAndMoving","showNoDataItems","showNoDataItemsInLast","visuallyNoDataItems","isSelected",Me="dynamicMove",ke="dynamicSize",Ne="tableName",Oe="Slicer",100,100,192,250,De=[],Fe=function(t){function e(e,o,n){var r,i,a=t.call(this,e,100,100,192,250)||this,s=a;return s.typeName=Oe,s.g3=Oe,o&&(r=o.kj,s.sheet(r),i=Go(r.slicers,o.tableName())),i||(i=o.getSlicerData()),s.ZX=i,s[Ie](n),s.$X=[],s._X=n,s.nameInFormula(Oe+"_"+n),s[Ae](n),s[ke](!1),s[Me](!1),a}return Ge(e,t),e.prototype.no=function(t){if(!1!==t){var e=this;e.$X&&(e.$X.forEach((function(t){t.no()})),e.$X=T),e.ZX&&(e.ZX.no(),e.ZX=T),e.sheet(T)}},e.prototype.sourceName=function(){return this._X},e.prototype.cloneContent=function(){var t=this,e=t.sheet(),o=t.ZX,n=new Se(t.name(),o,t.columnName());return n.width(t.width(),!1),n.height(t.height(),!1),n.captionName(t.captionName()),n.columnCount(t.columnCount()),n.itemHeight(t.itemHeight()),n.showHeader(t.showHeader()),n.sortState(t.sortState()),n.isLocked(t.isLocked()),n.disableResizingAndMoving(t.disableResizingAndMoving()),n.showNoDataItems(t.showNoDataItems()),n.showNoDataItemsInLast(t.showNoDataItemsInLast()),n.visuallyNoDataItems(t.visuallyNoDataItems()),n.style(t.style().toJSONInternal()),n.zoomFactor(e.zoom()),n.isSelected(t.isSelected()),n.slicer(t),n.sheet()!==e&&n.sheet(e),t.$X.push(n),n.getDOMElement()},e.prototype.YX=function(){return this.ZX},e.prototype.hga=function(){return!1},e.prototype.refresh=function(t){var e,o=this.$X;for(e=0;e<m(o);e++)fo(o[e],t)},e.prototype.refreshContent=function(t){var e=this,o=e.sheet().zoom();o!==e.MP&&(e.MP=o,e.refresh(o))},e.prototype.clone=function(t){var o,n=this;return!n.sheet()&&t&&n.sheet(t,!1),(o=new e(n.name(),Vo(n),n.columnName())).sheet(n.sheet(),!1),o.fromJSON(n.toJSON(),!1,n.ZX),o},e.prototype.LXc=function(t){for(var e=1,o=t,n=this.sheet().parent;Uo(n,o);)o=t+e,e++;return o},e.prototype.fromJSON=function(e,o,r){var i,a,s,l,u,c,f,h,p,d;e&&(i=this,a=e.tableName,s=e[Ie],a&&s&&(t.prototype.fromJSON.call(this,e),u=(l=i.sheet()).slicers,c=l.parent,(f=r||Go(u,a))||Po(u,f=c.jga(a).getSlicerData()),i.ZX=f,i[Ie](s),h=e.x!==w?e.x:100,p=e.y!==w?e.y:100,i.position(new n.Point(h,p)),i[V](e[V]!==w?e[V]:192,!1),i[H](e[H]!==w?e[H]:250,!1),e.sourceName!==w&&(i._X=e.sourceName),De.forEach((function(t){var o=e[t];o!==w&&i[t](o,!1)})),e.style!==w&&((d=He()).fromJSON(e.style),i.style(d,!1))))},e.prototype.toJSON=function(t){var e,o,n,r=this,i={};return["x","y",V,H,Me,ke,"isLocked","fixedPosition"].forEach((function(t){var e=r[t]();r[t].isDefault(e)&&t!==Me&&t!==ke||(i[t]=e)})),(e=r._X)&&(i.sourceName=e),r[F]()&&(i[F]=r[F]().toJSON()),o=r.ZX.getTable(),n=I(o.KXc)?o[Ne]():o.KXc,I(t)?i[D]=r.name():i[D]=r.LXc(r.name()),o[Ne]&&(i[Ne]=n),De.forEach((function(t){var e=r[t]();t===F||r[t].isDefault(e)||t!==D&&(i[t]=e)})),i},e.prototype.Wq=function(t){var e=this.sheet();e&&e.Wq(n.Events.SlicerChanged,t)},e}(i.FloatingObject),e.Slicer=Fe,Fe.prototype.nameInFormula=zo("nameInFormula","",Wo),Fe.prototype.onPropertyChanged=Wo,Ee=[[D,"",function(t,e,o){!function(t,e,o){var n,r,i=t.ZX;i&&(n=i.OW(),(r=n.slicers).all().forEach((function(n){n===t&&(r.U3(e,o),t.onPropertyChanged(D,o,e))})))}(this,o,e)},function(t){var e,o,n,r;if(!t)return!1;if(e=this.ZX,t===this.name())return!1;if(e&&(n=(o=e.OW())&&o.slicers)&&!Bo(n,t,r={}))throw r.error;return!0}],[Ae,"",Wo],["columnCount",1,Wo,Mo],["itemHeight",21,Wo,Mo],["showHeader",!0,Wo],["sortState",1,Wo],[Re,!1,function(t,e,o){var n,r=this;r.allowMove(!e,!1),r.allowResize(!e,!1),Wo.call(r,Re,e,o),(n=r.sheet())&&n.$p()}],["showNoDataItems",!0,Wo],["showNoDataItemsInLast",!0,Wo],["visuallyNoDataItems",!0,Wo],[F,me.light1(),Wo],[Ie,"",function(t,e,o){var n=this;n._X=e,n.captionName(e,!1),n.sheet().ITa.xVa(n,t,o)}]],le=0,be=m(Ee);le<be;le++)Fe.prototype[Ee[le][0]]=zo(Ee[le][0],Ee[le][1],Ee[le][2],Ee[le][3]);v(n.Worksheet.prototype,{t4:function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p;if(r===w&&(r=3),a=(i=this).tables){for(s=0;s<o;s++)for(l=0;l<n;l++)u=s+t,c=l+e,f=a.find(u,c),3===r&&f&&f.Aq()&&((h=f.dataRange()).contains(u,c)&&((p=f.getSlicerData())&&p.onDataChanged([{columnName:f.getColumnName(c-h.col),row:u-h.row,data:{value:i.getValue(u,c),text:i.getText(u,c)}}])));i.ITa.xVa(null,pt,{row:t,col:e,rowCount:o,colCount:n,sheetArea:r})}}}),je={priority:900,init:function(){this.slicers=new xe(this)},setHost:function(){var t=this;t.bind("tableRemoved",(function(e,o){var n,r,i,a=o.tables;for(n=0;n<m(a);n++)(i=Go(r=t.slicers,a[n].name()))&&Lo(r,i)}))},dispose:function(t){!1!==t.clearCache&&(this.slicers&&(this.slicers.no(),this.slicers=T),this.unbind("tableRemoved"))},toJson:function(t,e){var o,n=e&&e.ignoreStyle,r=e&&e.newWorkSheetName;n||(o=this.slicers.toJSON(r)).length>0&&(t.slicers=o),function(t){var e,o;for(e=0,o=t.tables.all();e<o.length;e++)o[e].KXc=T}(this)},fromJson:function(t,e,o,n,r){var i,a,s;if(!(o&&o.ignoreStyle)&&(a=(i=this).parent,!I(a)&&!r&&((s=t&&t.slicers)&&s.length>0))){if(Uo(a,s[0].name))return;i.slicers.fromJSON(s)}},preProcessMouseWheel:function(t){var e=this.slicers;e&&e.W3(t.e)&&(t.r=!0)},onGroupChanged:function(t){this.slicers.tTa(t.start,t.end,t.isRow)}},n.Worksheet.$n("slicer",je),Pe=function(t){var e="unfilterSlicerByKey",o="filterSlicer",r="unfilterSlicer",i="changeSlicerProperty";t.register(e,n.Commands[e],67,!1,!1,!0,!1),t.register(o,n.Commands[o]),t.register(r,n.Commands[r]),t.register(i,n.Commands[i])},Le={init:function(){Pe(this.commandManager())},fromJson:function(t,e,o){var n,r,i,a,s;if(!(o&&o.ignoreStyle))for(this,n=0,r=this.getSheetCount();n<r;n++)i=this.getSheet(n),(s=(a=t.sheets&&t.sheets[i.name()])&&a.slicers)&&i.slicers.fromJSON(s)},onCommandExecuting:function(t){t.slicers.all().forEach((function(t){t.isSelected(!1)}))},onCultureChanged:function(){c()}},n.Workbook.$n("slicer",Le),n.GC$.extend(n.lUa.prototype,{xVa:function(t,e,o){var n,r=this.zTa;r&&((n=r.EUa)||(n=r.EUa=[]),n.push({slicerItem:t,name:e,value:o}))},yVa:function(t){var e,o,n,r,i,a,s,l,u;if(t)for(e=t.length-1;e>=0;e--)if(n=(o=t[e]).slicerItem,r=o.name,i=o.value,r===ct)a=i.columnName,s=i.oldValue,n.doFilter(a,{exclusiveRowIndexes:s});else if(r===ft)n.vV(i);else if(r===ht){if(!i)return;n.Cz(i),(l=i.ZX.MX)&&((u=l.indexOf(i))>=0&&l.splice(u,1))}else if(r===pt){if(!i)return;this.kj.t4(i.row,i.col,i.rowCount,i.colCount,i.sheetArea)}else n[r](i)}}),n.lUa.$n("SLICER_PROPERTYCHANGE",{priority:5500,undo:function(t){var e=t.EUa;e&&this.yVa(e)}})},"./dist/plugins/sparkline/functions-sparkline.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function yt(t){return 0===t}function Ct(t){return 0===t||2===t}function vt(t){return Ct(t)||8===t}function bt(t){return 0===t||1===t}function wt(t){return 0<=t&&t<=2}function Tt(t){return 2===t||3===t}function St(t){return 1===t||2===t}function xt(t,e){var o,n,r,i,a,s,l,u,h,p,d=[];if(c(t))for(o=0,n=t.getRangeCount();o<n;o++)for(r=t.getRowCount(o),i=t.getColumnCount(o),a=0;a<r;a++)for(s=0;s<i;s++)d.push(t.getValue(o,a,s));else if(e&&f(t))for(l=t.getRowCount(),u=t.getColumnCount(),h=0;h<l;h++)for(p=0;p<u;p++)d.push(t.getValue(h,p));return d}function At(t,e,o){var n,r,i,a,s,l,u,h,p=[];if(c(t)){if(t.getRangeCount()>e)for(n=t.getRowCount(e),r=t.getColumnCount(e),i=0;i<n;i++)for(p[i]=[],a=0;a<r;a++)p[i].push(t.getValue(e,i,a))}else if(o&&f(t))for(s=t.getRowCount(),l=t.getColumnCount(),u=0;u<s;u++)for(p[u]=[],h=0;h<l;h++)p[u][h]=t.getValue(u,h);return p}function It(t){var e;return c(t)?e=t.getValue(0,0,0):d(t)||(e=t),e}function Rt(t,e){function o(t){return new r.Range(t.getRow(0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))}function n(t){return new r.Range(0,0,t.getRowCount(),t.getColumnCount())}var i=new h(t,2,5);return i.evaluate=function(t){var r,i,s,l,u,h,p,g,m,y,C,v,b,w=t[0],T=f(w);if((c(w)||T)&&(T?1:w.getRangeCount())>0){for(C in r=T?n(w):o(w),i=T?"":w.getSource().getSheet().name(),s=t[1],l=t[2],u=void 0,h=void 0,p=void 0,g=f(l),(c(l)||g)&&(p=g?"":l.getSource().getSheet().name(),(g?1:l.getRangeCount())>0&&(u=g?n(l):o(l),h=t[3])),m=function(t){var e,o,n,r,i,a={},s=!1,l=!0,u="",c="";if(t){for(e=0,o=(t=t.substr(1,t.length-2)).length;e<o;e++)":"===(n=t.charAt(e))?l=!1:","!==n||s?"'"===n||'"'===n||("("===n?s=!0:")"===n&&(s=!1),l?u+=n:c+=n):(a[u]=c,u="",c="",l=!0);for(r in u&&(a[u]=c),a)a.hasOwnProperty(r)&&(i=a[r],d(i)||("TRUE"===i.toUpperCase()?a[r]=!0:"FALSE"===i.toUpperCase()?a[r]=!1:!I(i)&&isFinite(i)&&(a[r]=R(i))))}return a}(t[4]||"{}"),y={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})y.hasOwnProperty(C)&&m.hasOwnProperty(C)&&(m[y[C]]=m[C]);return 1===(b=(v=new a.SparklineSetting(m)).options).maxAxisType&&(b.maxAxisType=0),1===b.minAxisType&&(b.minAxisType=0),{data:r,dataSheetName:i,dataOrientation:s,dateAxisData:u,dateAxisDataSheetName:p,dateAxisOrientation:h,sparklineType:e,displayDateAxis:u&&!d(h),setting:v,values:At(w,0,!0),dateValues:At(l,0,!0)}}},i.acceptsReference=Ct,i.acceptsArray=Ct,i}function Mt(t,e,o,n,i,s,l){var u,c,f=a.Sparkline.cT,h=l.sheet,p=h.parent.getSheetFromName(e.dataSheetName),d=h.parent.getSheetFromName(e.dateAxisDataSheetName),g=e.setting;g&&g.options||(g=new a.SparklineSetting(g)),u=g.options.displayHidden,c={sparklineType:e.sparklineType,displayDateAxis:e.displayDateAxis,zoomFactor:l.zoomFactor,values:f(e.values,p||h,u,e.data,e.dataOrientation),dateValues:f(e.dateValues,d||h,u,e.dateAxisData,e.dateAxisOrientation,!0),settings:g,getColor:function(t){if(h&&t){var e=r.Rm.Om(h,t);if(e)return e}return t}},(new y).paint(t,c,o,n,i,s)}function kt(t,e,o){return{value:t,font:e,label:o,normalFontHeight:b(e),normalFontWidth:w(o,e),fontAfterZoom:null}}function Nt(t){t&&(gt[t.name()]=t)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("@grapecity/js-calc"),r=o("Core"),i=o("Common"),a=o("./dist/plugins/sparkline/sparkline-wrapper.js"),c=n.Convert.Fh,f=n.Convert.Ca,h=n.Functions&&n.Functions.Function,p=n.Functions&&n.Functions.bi,d=i.Common.j.Fa,(g=r.GC$).inherit,m=g.extend,y=i.Sparklines.SparklineRender,C=i.Sparklines.SparklineExRenders,v=n.Errors.Value,b=r.util.fp,w=r.Vn.Xn,T=r.To.No,S=Math.floor,x=Math.min,A=void 0,I=isNaN,R=parseFloat,M="12px Calibri",k="PIESPARKLINE",N="AREASPARKLINE",O="SCATTERSPARKLINE",D="BULLETSPARKLINE",F="SPREADSPARKLINE",E="STACKEDSPARKLINE",j="HBARSPARKLINE",P="VBARSPARKLINE",L="VARISPARKLINE",G="BOXPLOTSPARKLINE",B="CASCADESPARKLINE",_="PARETOSPARKLINE",V="MONTHSPARKLINE",H="YEARSPARKLINE",z="GAUGEKPISPARKLINE",U="HISTOGRAMSPARKLINE",function(t){t[t.fit=1]="fit",t[t.entireFit=2]="entireFit",t[t.originFit=3]="originFit",t[t.custom=4]="custom"}(W||(W={})),q=function(){function t(t,e){this.name=t,this.value=e,this.typeName="SparklineExValue"}return t.prototype.toString=function(){return""},t}(),e.SparklineExValue=q,J=function(){function t(){var t,e,o=this.createFunction();o&&(t=o.name,e=o.evaluate,o.evaluate=function(){var o=e.call(this,arguments);return o instanceof n.CalcError?o:o?new q(t,o):null},this.Cj=t,t&&!n.Functions.findGlobalFunction(t)&&(n.Functions.ci[t]=o)),this.typeName=""}return t.prototype.name=function(){return this.Cj},t.prototype.createFunction=function(){return null},t.prototype.paint=function(t,e,o,n,r,i,a){},t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)d(t[e])||(this[e]=t[e])},t}(),e.SparklineEx=J,X=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.PieSparkline=X,m(X.prototype,{createFunction:function(){var t=new h(k,1,255);return t.evaluate=function(t){var e=t[0],o=xt(e,!0);return o.length<=0&&!d(e)&&o.push(e),{values:o,colors:Array.prototype.slice.call(t,1)}},t.acceptsReference=yt,t.acceptsArray=yt,t},paint:C[k]}),Z=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.AreaSparkline=Z,m(Z.prototype,{createFunction:function(){var t=new h(N,1,7);return t.evaluate=function(t){return{points:xt(t[0],!0),mini:t[1],maxi:t[2],line1:t[3],line2:t[4],colorPositive:t[5],colorNegative:t[6]}},t.acceptsReference=yt,t.acceptsArray=yt,t},paint:C[N]}),Y=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.ScatterSparkline=Y,m(Y.prototype,{createFunction:function(){var t=new h(O,1,18);return t.evaluate=function(t){return{points1:At(t[0],0,!0),points2:At(t[1],0,!0),minX:t[2],maxX:t[3],minY:t[4],maxY:t[5],hLine:t[6],vLine:t[7],xMinZone:t[8],xMaxZone:t[9],yMinZone:t[10],yMaxZone:t[11],tags:t[12],drawSymbol:t[13],drawLines:t[14],color1:t[15],color2:t[16],dash:t[17]}},t.acceptsReference=bt,t.acceptsArray=bt,t},paint:C[O]}),K=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.BulletSparkline=K,m(K.prototype,{createFunction:function(){var t=new h(D,3,17);return t.evaluate=function(t){return{measure:It(t[0]),target:It(t[1]),maxi:It(t[2]),good:It(t[3]),bad:It(t[4]),forecast:It(t[5]),tickUnit:It(t[6]),colorScheme:t[7],vertical:t[8],measureColor:t[9],targetColor:t[10],maxiColor:t[11],goodColor:t[12],badColor:t[13],forecastColor:t[14],allowMeasureOverMaxi:t[15],barSize:t[16]}},t.acceptsReference=function(t){return 0<=t&&t<=6},t},paint:C[D]}),Q=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.SpreadSparkline=Q,m(Q.prototype,{createFunction:function(){var t=new h(F,1,7);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u=xt(t[0],!0),c=[];if(!d(u)&&(u=function(t){var e,o,n,r,i=[];for(o=0,n=0,r=t.length;o<r;o++)e=R(t[o]),!I(e)&&isFinite(e)&&(i[n]=e,n++);return i}(u),c=function(t){var e,o,n,r,i,a={};for(e=0,o=void 0,n=t.length;e<n;e++)a[o=t[e]]?a[o]++:a[o]=1;for(i in r=[],a)a.hasOwnProperty(i)&&r.push({key:R(i),value:a[i]});return r.sort((function(t,e){return t.key-e.key}))}(u),3===(e=t[4])))for(o=0,n=c.length;o<n;o++){for(i=(r=c[o]).value,a=[],s=Math.max(100,10*i),l=0;l<s+i-1;l++)a.push(Math.random());r.randomNumbers=a}return{spreadData:c,showAverage:t[1],scaleStart:t[2],scaleEnd:t[3],style:e,colorScheme:t[5],vertical:t[6]}},t.acceptsReference=yt,t.acceptsArray=yt,t},paint:C[F]}),$=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.StackedSparkline=$,m($.prototype,{createFunction:function(){var t=new h(E,1,13);return t.evaluate=function(t){return{points:xt(t[0],!0),colorRange:xt(t[1],!0),labelRange:xt(t[2],!0),maximum:t[3],targetRed:t[4],targetGreen:t[5],targetBlue:t[6],targetYellow:t[7],color:t[8],highlightPosition:t[9],vertical:t[10],textOrientation:t[11],textSize:t[12]}},t.acceptsReference=wt,t.acceptsArray=wt,t},paint:C[E]}),tt=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.HBarSparkline=tt,m(tt.prototype,{createFunction:function(){var t=new h(j,1,4);return t.evaluate=function(t){return{value:It(t[0]),colorScheme:t[1],axisVisible:t[2],barHeight:t[3]}},t.acceptsReference=yt,t},paint:C[j]}),et=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.VBarSparkline=et,m(et.prototype,{createFunction:function(){var t=new h(P,1,4);return t.evaluate=function(t){return{value:It(t[0]),colorScheme:t[1],axisVisible:t[2],barWidth:t[3]}},t.acceptsReference=yt,t},paint:C[P]}),ot=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.VariSparkline=ot,m(ot.prototype,{createFunction:function(){var t=new h(L,1,10);return t.evaluate=function(t){return{variance:It(t[0]),reference:It(t[1]),mini:It(t[2]),maxi:It(t[3]),mark:It(t[4]),tickUnit:It(t[5]),legend:t[6],colorPositive:t[7],colorNegative:t[8],vertical:t[9]}},t.acceptsReference=function(t){return 0<=t&&t<=5},t},paint:C[L]}),nt=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.BoxPlotSparkline=nt,m(nt.prototype,{createFunction:function(){function t(t,e){return c(t)&&!I(e)&&0<=e&&e<=100?p.PERCENTILE.evaluate(t,e/100):NaN}function e(t){return c(t)?p.STDEVP.evaluate(t):NaN}var o=new h(G,1,10);return o.evaluate=function(o){var n=o[0];return{points:xt(n,!0),boxPlotClass:o[1],showAverage:o[2],scaleStart:It(o[3]),scaleEnd:It(o[4]),acceptableStart:It(o[5]),acceptableEnd:It(o[6]),colorScheme:o[7],style:o[8],vertical:o[9],perc02:t(n,2),perc09:t(n,9),perc10:t(n,10),perc90:t(n,90),perc91:t(n,91),perc98:t(n,98),q1:t(n,25),q3:t(n,75),median:t(n,50),stDev:e(n)}},o.acceptsReference=yt,o.acceptsArray=yt,o},paint:C[G]}),rt=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.CascadeSparkline=rt,m(rt.prototype,{createFunction:function(){var t=new h(B,1,10);return t.evaluate=function(t){return{points:xt(t[0],!0),pointIndex:It(t[1]),labels:xt(t[2],!0),minimum:It(t[3]),maximum:It(t[4]),colorPositive:t[5],colorNegative:t[6],vertical:t[7],itemTypeRange:xt(t[8],!0),colorTotal:t[9]}},t.acceptsReference=vt,t.acceptsArray=vt,t},paint:C[B]}),it=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.ParetoSparkline=it,m(it.prototype,{createFunction:function(){var t=new h(_,2,12);return t.evaluate=function(t){return{points:xt(t[0],!0),pointIndex:It(t[1]),colorRange:xt(t[2],!0),target:It(t[3]),target2:It(t[4]),highlightPosition:It(t[5]),label:t[6],vertical:t[7],targetColor:t[8],target2Color:t[9],labelColor:t[10],barSize:t[11]}},t.acceptsReference=Ct,t.acceptsArray=Ct,t},paint:C[_]}),at=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.MonthSparkline=at,m(at.prototype,{createFunction:function(){var t=new h(V,3,7);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u,h=t[0],p=t[1],d=t[2],g=d;for((c(d)||f(d))&&(g=At(d,0,!0)),e=t[3],o=[],(c(e)||f(e))&&(o=At(e,0,!0)),n=[],r=[],i=0,a=g.length;i<a;i++)(s=g[i])&&("string"==typeof(l=s[0])&&(l=new Date(l)),l&&l.getFullYear()===h&&l.getMonth()+1===p&&(n[u=l.getDate()-1]=s[1],o.length>0&&(r[u]=o[i][0])));return o.length>0?{year:h,month:p,values:n,colors:r}:{year:h,month:p,values:n,emptyColor:e,startColor:t[4],middleColor:t[5],endColor:t[6]}},t.acceptsReference=Tt,t.acceptsArray=Tt,t},paint:C[V]}),st=function(t){function e(){return t.call(this)||this}return mt(e,t),e.daysOfMonth=function(t,e){switch(e){case 2:return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},e.dayInYear=function(t){var o,n=t.getFullYear(),r=t.getMonth(),i=t.getDate();for(o=1;o<r+1;o++)i+=e.daysOfMonth(n,o);return i},e}(J),e.YearSparkline=st,m(st.prototype,{createFunction:function(){var t=new h(H,2,6);return t.evaluate=function(t){var e,o,n,r,i,a,s,l,u,h=t[0],p=t[1],d=p;for((c(p)||f(p))&&(d=At(p,0,!0)),e=t[2],o=[],(c(e)||f(e))&&(o=At(e,0,!0)),n=[],r=[],i=0,a=d.length;i<a;i++)(s=d[i])&&("string"==typeof(l=s[0])&&(l=new Date(l)),l&&l.getFullYear()===h&&(n[u=st.dayInYear(l)-1]=s[1],o.length>0&&(r[u]=o[i][0])));return o.length>0?{year:h,values:n,colors:r}:{year:h,values:n,emptyColor:e,startColor:t[3],middleColor:t[4],endColor:t[5]}},t.acceptsReference=St,t.acceptsArray=St,t},paint:C[H]}),lt=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.HistogramSparkline=lt,m(lt.prototype,{createFunction:function(){var t=this,e=new h(U,1,9);return e.acceptsArray=function(){return!0},e.evaluate=function(e){var o,r,i,a,s,l,u,c,f,h=e[0];if(!(h instanceof n.CalcArray||h instanceof n.CalcReference))throw n.CalcError;if(f=t.xMc(h),o=e[1],d(o)&&(o=!0),r=!0===e[2],i=e[3],d(i)&&(i=1),i<=0)throw n.CalcError;if(a=e[4],d(a)&&(a=1),a>1||a<=0)throw n.CalcError;return s=e[5]||"#5B9BD5",l=e[6],u=e[7]||"#000000",c=e[8]||"#C0C0C0",{values:o?t.yMc(f,i):t.zMc(f),continuous:o,paintLabel:r,barWidth:a,barColor:s,labelFontStyle:l,labelColor:u,edgeColor:c}},e.acceptsReference=function(t){return 0===t},e},xMc:function(t){var e,o,r=[];if(t instanceof n.CalcArray)for(e=t.toArray(1),o=0;o<e.length;o++)r.push(e[o]);else(e=At(t,0)).forEach((function(t){t.forEach((function(t){d(t)||"number"!=typeof t||isNaN(t)||r.push(t)}))}));return r},yMc:function(t,e){var o,n,r,a,s,l,u,c=[],f=0,h=this;for(t.forEach((function(t){c[f]=t,f++})),o=[],n=a=c[0],c.forEach((function(t){n=Math.min(t,n),a=Math.max(t,a)})),r=S(n/e)*e,s=Math.ceil(a/e)*e,l=1!==c.length?Math.round((s-r)/e):1,f=0;f<l;f++)o[f]=i.Common.o.Lma(f*e+r,15);for(a>=o[f-1]&&(o[f]=o[f-1]+e),u=[],f=0,l=o.length-1;f<l;f++)u[f]={value:0};for(u.length>0&&(u[0].axis="["+o[0]+","+o[1]+"]"),f=1;f<o.length-1;f++)d(o[f+1])?u[f].axis="("+o[f]+","+(o[f]+e)+"]":u[f].axis="("+o[f]+","+o[f+1]+"]";return c.forEach((function(t){var e=h.AMc(o,t);u[e].value++})),u.length>0&&0===u[0].value&&u.splice(0,1),u},zMc:function(t){var e,o,n,r,i={};for(e=0,o=t.length;e<o;++e)n=t[e],void 0===i[n]?i[n]=1:i[n]++;return(r=this.BMc(i)).sort((function(t,e){return t-e})),r.map((function(t){return{axis:t,value:i[t]}}))},BMc:function(t){var e,o=[];for(e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&null!==t[e]&&o.push(e);return o},AMc:function(t,e){var o,n,r,i,a=t.length;if(t[0]===e)return 0;if(0===a)return 0;o=0,r=S((n=a-1)/2);do{if(i=r,e>t[r]&&e<=t[r+1])return r;e<=t[r]?r=S(((n=r)+o)/2):e>t[r+1]&&(o=r,r=S((r+n)/2))}while(i!==r)},paint:function(t,e,o,n,i,a,s){var l,u,c=e.labelFontStyle,f=s.zoomFactor;d(c)&&(c=t.font),l=r.To.No(c,f),u=r.To.Ko(l.font),e.afterZoomFontStyle={fontStyle:u.fontStyle,fontFamily:u.fontFamily,fontSize:u.fontSize,fontWeight:u.fontWeight,fontPixelSize:l.fontSize},C[U](t,e,o,n,i,a,s)}}),ut=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.ImageSparkline=ut,m(ut.prototype,{createFunction:function(){var t=new h("IMAGE",1,10);return t.evaluate=function(t){var e=t[0],o=t[1]||W.fit,i=t[2],a=t[3],s=t[4]||0,l=t[5]||0,u=t[6],c=t[7],f=t[8],h=t[9];if(-1===[0,1,2].indexOf(f)&&(f=r.VerticalAlign.center),-1===[0,1,2].indexOf(h)&&(h=r.HorizontalAlign.center),o===W.custom&&(i===A||a===A))throw n.CalcError;return i=i<0?0:i,a=a<0?0:a,l=l<0?0:l,s=s<0?0:s,u=u<0?0:u,c=c<0?0:c,-1===[1,2,3,4].indexOf(o)&&(o=1),{url:e,drawType:o,height:i,width:a,clipY:s,clipX:l,clipWidth:c,clipHeight:u,vAlign:f,hAlign:h}},t},CMc:function(t,e,o,n,i){var a,s,l,u,c,f,h,p=t.width,d=t.height,g=t.x,m=t.y,y=e.width,C={clipX:0,clipY:0,clipHeight:e.height,clipWidth:y,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if(p/d<(a=(C=this.DMc(C,e,o)).clipWidth/C.clipHeight))switch(s=n.vAlign,C.paintWidth=p,l=p/a,C.paintHeight=l,C.paintX=g,s){case r.VerticalAlign.top:C.paintY=m;break;case r.VerticalAlign.center:u=d-l,C.paintY=m+u/2;break;case r.VerticalAlign.bottom:C.paintY=m+d-l}else switch(c=n.hAlign,C.paintHeight=d,f=d*a,C.paintWidth=f,C.paintY=m,c){case r.HorizontalAlign.left:C.paintX=g;break;case r.HorizontalAlign.center:h=p-f,C.paintX=g+h/2;break;case r.HorizontalAlign.right:C.paintX=g+p-f}return C},EMc:function(t,e,o,n,r){var i={cutX:0,cutY:0,cutHeight:e.width,cutWidth:e.height,paintX:t.x,paintY:t.y,paintHeight:t.height,paintWidth:t.width};return this.DMc(i,e,o)},DMc:function(t,e,o){var n=e.width,r=e.height,i=o.clipX||0,a=o.clipY||0;return d(o.clipX)||(t.clipX=x(o.clipX,n)),d(o.clipY)||(t.clipY=x(o.clipY,r)),d(o.clipWidth)?t.clipWidth=n-t.clipX:t.clipWidth=o.clipWidth+i>n?n-i:o.clipWidth,d(o.clipHeight)?t.clipHeight=r-t.clipY:t.clipHeight=o.clipHeight+a>r?r-a:o.clipHeight,t},FMc:function(t,e,o,n,i){var a,s,l,u,c,f,h,p,d,g,m,y,C,v=t.width,b=t.height,w=t.x,T=t.y,S={imgWidth:e.width,imgHeight:e.height,offsetX:0,offsetY:0};if(a=(S=this.GMc(S,e,o)).imgWidth,s=S.imgHeight,l=S.offsetX,u=S.offsetY,c=a*i,f=s*i,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},p=n.hAlign,d=n.vAlign,c>v){switch(h.paintWidth=v,h.paintX=w,g=(c-v)/c*a,p){case r.HorizontalAlign.left:h.clipX=S.offsetX;break;case r.HorizontalAlign.center:h.clipX=S.offsetX+g/2;break;case r.HorizontalAlign.right:h.clipX=S.offsetX+g}h.clipWidth=v}else{switch(h.clipWidth=a,h.clipX=0,h.paintWidth=c,m=v-c,p){case r.HorizontalAlign.general:case r.HorizontalAlign.left:h.paintX=w;break;case r.HorizontalAlign.center:h.paintX=w+m/2;break;case r.HorizontalAlign.right:h.paintX=w+m}h.clipX+=l}if(f>b){switch(h.paintY=T,h.paintHeight=b,y=(f-b)/f*s,d){case r.VerticalAlign.top:h.clipY=S.offsetY;break;case r.VerticalAlign.center:h.clipY=S.offsetY+y/2;break;case r.VerticalAlign.bottom:h.clipY=S.offsetY+y}h.clipHeight=b}else{switch(h.clipHeight=s,h.clipY=0,h.paintHeight=f,C=b-f,d){case r.VerticalAlign.top:h.paintY=T;break;case r.VerticalAlign.center:h.paintY=T+C/2;break;case r.VerticalAlign.bottom:h.paintY=T+C}h.clipY+=u}return h},HMc:function(t,e,o,n,i){var a,s,l,u,c,f,h,p,g,m,y,C,v,b,w,T,S,x={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},A=e.customWidth*i,I=e.customHeight*i;if(null===A||A<0||null===I||A<0)return x;if(a=t.width,s=t.height,l=t.x,u=t.y,c={imgWidth:e.width,imgHeight:e.height,offsetX:0,offsetY:0},f=(c=this.GMc(c,e,o)).imgWidth,h=c.imgHeight,p=c.offsetX,g=c.offsetY,m=n.hAlign,y=n.vAlign,A>a){switch(x.paintWidth=a,x.paintX=l,v=(C=(A-a)/A)*f,m){case r.HorizontalAlign.left:x.clipX=c.offsetX;break;case r.HorizontalAlign.center:x.clipX=c.offsetX+v/2;break;case r.HorizontalAlign.right:x.clipX=c.offsetX+v}x.clipWidth=c.imgWidth*(1-C)}else{switch(x.clipWidth=f,x.clipX=0,x.paintWidth=A,b=a-A,m){case r.HorizontalAlign.general:case r.HorizontalAlign.left:x.paintX=l;break;case r.HorizontalAlign.center:x.paintX=l+b/2;break;case r.HorizontalAlign.right:x.paintX=l+b}x.clipX+=p}if(I>s){switch(x.paintY=u,x.paintHeight=s,T=(w=(I-s)/I)*h,y){case r.VerticalAlign.top:x.clipY=c.offsetY;break;case r.VerticalAlign.center:x.clipY=c.offsetY+T/2;break;case r.VerticalAlign.bottom:x.clipY=c.offsetY+T}x.clipHeight=c.imgHeight*(1-w)}else{switch(x.clipHeight=d(o.clipHeight)?h:c.imgHeight,x.clipY=0,x.paintHeight=I,S=s-I,y){case r.VerticalAlign.top:x.paintY=u;break;case r.VerticalAlign.center:x.paintY=u+S/2;break;case r.VerticalAlign.bottom:x.paintY=u+S}x.clipY+=g}return x},GMc:function(t,e,o){var n=e.width,r=e.height;return d(o.clipX)||(t.offsetX=x(n,o.clipX)),d(o.clipY)||(t.offsetY=x(r,o.clipY)),d(o.clipWidth)?t.imgWidth=n-t.offsetX:t.imgWidth=o.clipWidth+t.offsetX>n?n-t.offsetX:o.clipWidth,d(o.clipHeight)?t.imgHeight=r-t.offsetY:t.imgHeight=o.clipHeight+t.offsetY>r?r-t.offsetY:o.clipHeight,t},paint:function(t,e,o,n,r,i,a){var s,l={x:o,y:n,width:r,height:i},u=a.sheet.vu();try{s=e.url,u.ko(s)?this.IMc(t,e,l,a):u.fo(s)}catch(t){}},IMc:function(t,e,o,n){var r,i,a,s,l,u,c=this,f=e.url,h=n.sheet,p=e.drawType,d=h.bt;if(f&&"string"==typeof f&&d.bgc(f)){switch(i={width:(r=d.lo(f)).width,height:r.height},a={clipY:e.clipY,clipX:e.clipX,clipWidth:e.clipWidth,clipHeight:e.clipHeight},s={vAlign:e.vAlign,hAlign:e.hAlign},u=n.zoomFactor,p){case W.fit:l=c.CMc(o,i,a,s,u);break;case W.entireFit:l=c.EMc(o,i,a,s,u);break;case W.originFit:l=c.FMc(o,i,a,s,u);break;case W.custom:i.customWidth=e.width,i.customHeight=e.height,l=c.HMc(o,i,a,s,u)}l.img=r,"IMAGESPARKLINE",C.IMAGESPARKLINE(t,l,o.x,o.y,o.width,o.height,n)}}}),ct=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.LineSparkline=ct,m(ct.prototype,{createFunction:function(){return Rt("LINESPARKLINE",0)},paint:Mt}),ft=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.ColumnSparkline=ft,m(ft.prototype,{createFunction:function(){return Rt("COLUMNSPARKLINE",1)},paint:Mt}),ht=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.WinlossSparkline=ht,m(ht.prototype,{createFunction:function(){return Rt("WINLOSSSPARKLINE",2)},paint:Mt}),pt=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.RangeBlockSparkline=pt,m(pt.prototype,{createFunction:function(){var t=new h("RANGEBLOCKSPARKLINE",2,2);return t.evaluate=function(t){var e=t[0],o=e.source.getSheet(),i=t[1],a=i.getSource().getSheet(),s=i.getRow(0),l=i.getColumn(0),u=i.getRowCount(0),c=i.getColumnCount(0),f=new r.Range(e.row,e.column,1,1),h=new r.Range(s,l,u,c);if(o.name()===a.name()&&h.containsRange(f))throw n.CalcError;return{templateSheetName:a.name(),templateRange:{row:s,col:l,rowCount:u,colCount:c},bindingObject:t[2]}},t.isContextSensitive=function(){return!0},t.acceptsReference=yt,t},paint:function(t,e,n,r,i,a,c){var f,h,p,d,g,m=e.templateSheetName,y=e.templateRange;m&&((h=(f=c.sheet.parent)&&f.getSheetFromName(m))&&(l||(p=o("CellTypes"),l=p.Xgc,s=p.Wgc,u=p.paintRangeTemplate),d=(new l).YE(h,y),g=(new s).YE(h,y),u(t,{x:n,y:r,width:i,height:a},e.bindingObject,c,d,g.NJb)))}}),dt=function(t){function e(){return t.call(this)||this}return mt(e,t),e}(J),e.GaugeKPISparkline=dt,m(dt.prototype,{createFunction:function(){var t=new h(z,4,255);return t.evaluate=function(t){var e,o,r,i,a,s,l,u,c,f,h,p=[],g=t.length,m=It(t[0]),y=It(t[1]),C=It(t[2]),b=It(t[3]),w=It(t[5]),T=It(t[6]),S=It(t[7]),x=It(t[8]),A=It(t[10]),R=It(t[11]),k=It(t[12]),N=t[4],O=t[13];if(!function(t,e,o,n,r,i,a,s){if(d(t)||d(e)||d(o)||d(n))return!1;if(I(t)||I(e)||I(o)||I(n))return!1;if(o>=n||e<o||e>n||t<o||t>n)return!1;if(!d(a)&&0!==a&&1!==a&&2!==a)return!1;if(0===a||d(a)){if(!d(r)&&!d(i)&&(I(i)||I(r)||r>=i||r<-180||i>180))return!1;if(!d(s)&&(I(s)||s>1||s<0))return!1}return!0}(m,y,C,b,A,R,O,k))return v;for(t[9]instanceof n.CalcArray&&(o=(u=t[9].toArray(2))[0],r=u[1],i=u[2],a=u[3]),o=o||"16px Calibri",r=r||"bold 22px Calibri",i=i||M,a=a||M,w=d(w)?m:w,T=d(T)?y:T,S=d(S)?C:S,x=d(x)?b:x,c={minAngle:d(A)?-90:A,maxAngle:d(R)?90:R,radiusRatio:d(k)?0:k,targetValueOption:kt(m,o,w),currentValueOption:kt(y,r,T),minValueOption:kt(C,i,S),maxValueOption:kt(b,a,x),gaugeType:d(O)?0:O,ranges:void 0,showLabel:!!d(N)||!!N},f=14;f<g;f++)if((h=t[f])instanceof n.CalcArray){if(s=(e=h.toArray(0))[0],l=e[1],d(s)||d(l)||I(s)||I(l)||s>l||s<C||s>b||l>b||l<C)return v;p.push({start:s,end:l,color:e[2]})}return c.ranges=p,c},t.acceptsArray=function(t){return 9===t||t>=14},t.acceptsReference=function(t){return t<=3&&t>=0||t>=5&&t<=8||t>=10&&t<=12},t},paint:function(t,e,o,n,r,i,a){var s=a.zoomFactor;e.currentValueOption.fontAfterZoom=T(e.currentValueOption.font,s).font,e.targetValueOption.fontAfterZoom=T(e.targetValueOption.font,s).font,e.minValueOption.fontAfterZoom=T(e.minValueOption.font,s).font,e.maxValueOption.fontAfterZoom=T(e.maxValueOption.font,s).font,C[z](t,e,o,n,r,i,a)}}),gt={},e.w_a=gt,h&&(Nt(new X),Nt(new Z),Nt(new Y),Nt(new K),Nt(new Q),Nt(new $),Nt(new tt),Nt(new et),Nt(new ot),Nt(new nt),Nt(new rt),Nt(new it),Nt(new at),Nt(new st),Nt(new ct),Nt(new ft),Nt(new ht),Nt(new pt),Nt(new dt),Nt(new lt),Nt(new ut)),m(r.Workbook.prototype,{addSparklineEx:function(t){this.dT||(this.dT={});var e=this.dT;t&&(e[t.name()]=t)},getSparklineEx:function(t){var e,o=gt[t];return o||(e=this.dT)&&e[t]},removeSparklineEx:function(t){var e=this.dT;e&&(e[t]=void 0)}}),r.Workbook.$n("sparklineEx",{toJson:function(t){var e,o,n=this.dT,r=[];if(n){for(e in n)n.hasOwnProperty(e)&&((o=n[e].toJSON())&&o.typeName&&r.push(o));r.length>0&&(t.sparklineExs=r)}},fromJson:function(t){var e,o,n,i,a=t.sparklineExs;if(a)for(e=0;e<a.length;e++)o=a[e],(n=r.getTypeFromString(o.typeName))&&((i=new n).fromJSON(o),this.addSparklineEx(i))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(t,e,o){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./dist/plugins/sparkline/functions-sparkline.js"),e.w_a=n.w_a,e.PieSparkline=n.PieSparkline,e.AreaSparkline=n.AreaSparkline,e.ScatterSparkline=n.ScatterSparkline,e.BulletSparkline=n.BulletSparkline,e.SpreadSparkline=n.SpreadSparkline,e.StackedSparkline=n.StackedSparkline,e.HBarSparkline=n.HBarSparkline,e.VBarSparkline=n.VBarSparkline,e.VariSparkline=n.VariSparkline,e.BoxPlotSparkline=n.BoxPlotSparkline,e.CascadeSparkline=n.CascadeSparkline,e.ParetoSparkline=n.ParetoSparkline,e.MonthSparkline=n.MonthSparkline,e.YearSparkline=n.YearSparkline,e.LineSparkline=n.LineSparkline,e.ColumnSparkline=n.ColumnSparkline,e.WinlossSparkline=n.WinlossSparkline,e.RangeBlockSparkline=n.RangeBlockSparkline,e.GaugeKPISparkline=n.GaugeKPISparkline,e.SparklineEx=n.SparklineEx,e.SparklineExValue=n.SparklineExValue,e.HistogramSparkline=n.HistogramSparkline,e.ImageSparkline=n.ImageSparkline,r=o("./dist/plugins/sparkline/sparkline-wrapper.js"),e.EmptyValueStyle=r.EmptyValueStyle,e.SparklineAxisMinMax=r.SparklineAxisMinMax,e.SparklineSetting=r.SparklineSetting,e.SparklineType=r.SparklineType,e.DataOrientation=r.DataOrientation,e.Sparkline=r.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M;function k(t,e){var o=a.formulaToRanges(t,e,0,0)[0],n=o&&o.ranges&&o.ranges[0];return n?{range:n,sheetName:o.sheetName}:m}function N(t,e,o,n){var r=this.ZA;r.JUa(t,e,n),n&&r.add(n.group()),this.Bq("sparkline",t,e,3,o,n)}function O(t,e){return t+"_"+e}function D(t,e,o){return o?t>o.row+o.rowCount-1?o:t>o.row?l(o.row,o.col,o.rowCount+e,o.colCount):l(o.row+e,o.col,o.rowCount,o.colCount):m}function F(t,e,o){return o?t>o.col+o.colCount-1?o:t>o.col?l(o.row,o.col,o.rowCount,o.colCount+e):l(o.row,o.col+e,o.rowCount,o.colCount):m}function E(t,e,o,r,i){var a,s,l,u,c,f,h,p,d,g,y,C,v=new n.KTa;for(a=0;a<t.length;a++)for(l=(s=t[a]).PS,s.displayDateAxis&&(void 0,c=s.dateAxisData(),u=r?D(e,o,c):F(e,o,c),s.dateAxisData(u)),f=0;f<l.length;f++)h=l[f],e<=(r?h.row:h.column)&&(v.set(a,f,h),i.JUa(h.row,h.column,m),r?h.row+=o:h.column+=o),void 0,d=h.data(),p=r?D(e,o,d):F(e,o,d),h.data(p);for(g=0;g<t.length;g++)for(y=t[g].PS,C=0;C<y.length;C++)i.SUa(v.get(g,C))}function j(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,C,v,b;for(a=0;a<n.length;a++)(s=n[a]).displayDateAxis&&(u=(l=s.OW()).ITa,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),void 0,h=s.dateAxisData(),f=o?D(t,e,h):F(t,e,h),s.dateAxisData(f),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=y));for(p=0;p<r.length;p++)m=(g=(d=r[p]).bT()).ITa,C=!1,i&&!m.zTa&&(m.zTa=[],C=!0),void 0,b=d.data(),v=o?D(t,e,b):F(t,e,b),d.data(v),C&&(i.push({sheetName:g.name(),changes:m.zTa}),m.zTa=y)}function P(t,e,o){var n=G(o.col,o.col+o.colCount-1,t,t+e-1);return n?l(o.row,n.start,o.rowCount,n.end-n.start+1):m}function L(t,e,o){var n=G(o.row,o.row+o.rowCount-1,t,t+e-1);return n?l(n.start,o.col,n.end-n.start+1,o.colCount):m}function G(t,e,o,n){var r,i,a,s,l,u=-1;if(n<t)return{start:u=t-(i=n-o+1),end:e-i};if(o>e)return{start:u=t,end:e};if(o<=t){for(a=e-t+1,s=0,r=t;r<=n&&r<=e;r++)s++;return{start:u=o,end:u+a-s-1}}for(l=0,r=t;r<=e;r++)-1===u&&(r<o||r>n)&&(u=r),(r<o||r>n)&&l++;return-1!==u&&l>0?{start:u,end:u+l-1}:m}function B(t,e,o,r,i){var a,s,l,c,f,p,d,g,y,v,b,w,T,S,x=new n.KTa,A=t.length,I=0;for(a=A-1;a>-1;a--){if((s=t[a]).displayDateAxis){if(void 0,c=s.dateAxisData(),l=r?L(e,o,c):P(e,o,c),u(l)){s.clear(),i.remove(s);continue}s.dateAxisData(l)}for(f=(f=[]).concat(s.PS),p=h(f),I=C(p,I),d=p-1;d>-1;d--)g=f[d],(y=r?g.row:g.column)>=e&&y<e+o?(s.remove(g),i.JUa(g.row,g.column,m)):(e<=y&&(i.JUa(g.row,g.column,m),r?g.row-=o:g.column-=o,x.set(a,d,g)),void 0,b=g.data(),v=r?L(e,o,b):P(e,o,b),u(v)?s.remove(g):g.data(v));s.count()<=0&&i.remove(s)}for(T=0;T<A;T++)for(S=0;S<I;S++)(w=x.get(T,S))&&i.SUa(w)}function _(t,e,o,n,r,i){var a,s,l,c,f,h,p,d,g,m,C,v,b,w,T;for(a=n.length-1;a>-1;a--)(s=n[a]).displayDateAxis&&(c=(l=s.OW()).ITa,f=!1,i&&!c.zTa&&(c.zTa=[],f=!0),void 0,p=s.dateAxisData(),h=o?L(t,e,p):P(t,e,p),u(h)?(s.clear(),s.ZA.remove(s)):s.dateAxisData(h),f&&(i.push({sheetName:l.name(),changes:c.zTa}),c.zTa=y));for(d=r.length-1;d>-1;d--)C=(m=(g=r[d]).bT()).ITa,v=!1,i&&!C.zTa&&(C.zTa=[],v=!0),void 0,w=g.data(),b=o?L(t,e,w):P(t,e,w),u(b)?((T=g.group()).remove(g),T.count()<=0&&T.ZA.remove(T)):g.data(b),v&&(i.push({sheetName:m.name(),changes:C.zTa}),C.zTa=y)}function V(t,e){var o=!1;return"setting"===t||"axisReference"===t?o=e===m:"displayDateAxis"===t?o=!1===e:"axisOrientation"===t?o=1===e:"sparklines"===t&&(o=0===e.length),o}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("@grapecity/js-calc"),a=o("SheetsCalc"),s=n.GC$.isEmptyObject,l=n.kf,u=r.Common.j.Fa,c=r.Common.k,f=c.Fb,h=c.ac,p=c.Bb,d=r.Sparklines.Vd,g=r.Sparklines.SparklineRender,m=null,y=void 0,C=Math.max,v=Number.MAX_VALUE,n.GC$.extend(n.lUa.prototype,{FUa:function(t){var e,o,n,r=this.zTa,i=arguments[1];if(r){switch(r.GUa||(r.GUa=[]),e={type:t},t){case 0:void 0,n=(o=i)&&o.sparkline?o.sparkline:m,e.HUa={row:o.row,col:o.col,sparkline:n};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:e.HUa=i}r.GUa.push(e)}},IUa:function(t){var e,o,n,r,i,a,s,u,c,p,d,g=this,y=t.HUa;switch(t.type){case 12:y.sparkline?(y.sparkline.row=y.row,y.sparkline.column=y.col,g.ZA.JUa(y.row,y.col,y.sparkline)):g.ZA.JUa(y.row,y.col,m);break;case 0:g.ZA.JUa(y.row,y.col,y.sparkline),y.sparkline&&!g.ZA.contains(y.sparkline.group())&&g.ZA.add(y.sparkline.group());break;case 1:for(e=void 0,o=void 0,n=void 0,r=h(y),i=0;i<r;i++)e=y[i].row,o=y[i].col,n=g.ZA.KUa(e,o),0===i&&n.cb.count()===r&&g.ZA.remove(n.cb),this.ZA.add(n.group(y[i].group).cb);break;case 2:for(a=[],s=0;s<h(y);s++)a.push(g.ZA.KUa(y[s].row,y[s].col));g.ZA.kj.groupSparkline(a);break;case 3:g.ZA.KUa(y.row,y.col).sparklineType(y.sparklineType);break;case 4:g.ZA.KUa(y.row,y.col).setting(y.setting);break;case 5:y.sparkline.data(y.data);break;case 15:g.ZA.KUa(y.row,y.col).dataSheetName(y.dataSheetName);break;case 6:g.ZA.KUa(y.row,y.col).dataOrientation(y.dataOrientation);break;case 7:g.ZA.KUa(y.row,y.col).displayDateAxis(y.displayDateAxis);break;case 8:void 0,u=(c=y.rangeInfo)?l(c.row,c.col,c.rowCount,c.colCount):c,y.group.dateAxisData(u);break;case 16:y.group.dateAxisDataSheetName(y.dateAxisDataSheetName);break;case 9:y.group.dateAxisOrientation(y.dateAxisOrientation);break;case 10:for(y.group.PS.forEach((function(t){g.ZA.vZa(t)})),y.group.PS=y.PS,p=y.group.PS,d=0;d<h(p);d++)p[d].group(y.group);p.forEach((function(t){g.ZA.tZa(t)}));break;case 11:g.ZA.KUa(y.row,y.col).group(y.group);break;case 13:f(g.ZA.groups(),y),g.ZA.yZa(y);break;case 14:g.ZA.groups().push(y),g.ZA.zZa(y)}},LUa:function(t){var e;for(e=h(t)-1;e>=0;e--)this.IUa(t[e])},MUa:function(t,e){this.ZA.rI(t,e)},NUa:function(t,e){this.ZA.GR(t,e)},OUa:function(t,e){this.ZA.tI(t,e)},PUa:function(t,e){this.ZA.HR(t,e)},QUa:function(t,e,o,n){this.ZA.clear(t,e,o,n)},wZa:function(){var t=this.zTa;return t?(t.xZa||(t.xZa=[]),t.xZa):m}}),n.lUa.$n("sparkline",{init:function(){var t=this.kj;this.ZA=new T(t)},undo:function(t){var e,o,n=t.GUa;n&&this.LUa(n),e=this.kj,(o=t.xZa)&&o.forEach((function(t){e.parent.getSheetFromName(t.sheetName).ITa.undo(t.changes)}))}}),b={init:function(){this.ZA=this.ITa.ZA},dispose:function(t){if(!1!==t.clearCache){var e=this;e.ZA&&(e.ZA.kj=m,e.ZA.evaluator=m,e.ZA=m),e.ITa&&(e.ITa.ZA=m)}},onLayoutChanged:function(t){var e,o=t.changeType,n=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=this.ITa;"addRows"===o?s.MUa(n,r):"deleteRows"===o?s.NUa(n,r):"addColumns"===o?s.OUa(i,a):"deleteColumns"===o?s.PUa(i,a):"clear"===o&&(e=t.type,3===t.sheetArea&&16==(16&e)&&s.QUa(n,i,r,a))},toJson:function(t,e){e&&e.ignoreStyle||(t.sparklineGroups=this.ZA.toJSON())},fromJson:function(t,e,o){var n=o&&o.ignoreStyle,r=this.ZA,i=t.sparklineGroupManager,a=e?i&&i.groups:t.sparklineGroups;a&&!n&&r.RUa(a,e)},setName:function(t){var e=t.oldName,o=t.newName;this.ZA.jOa(e,o)}},n.Worksheet.$n("sparkline",b),w={getSparkline:function(t,e){return this.ZA?this.ZA.KUa(t,e):m},setSparkline:function(t,e,o,n,r,i,a,s){var l,c,f,h,p,d,g=this;if(!g.ZA)return m;if("string"==typeof o){if(!(c=k(g,o)))return m;o=c.range,l=c.sheetName}if(f=new M(t,e,o,n,r,i),l&&l!==g.name()&&f.dataSheetName(l),a&&!u(s)){if(h=void 0,"string"==typeof a){if(!(p=k(g,a)))return m;a=p.range,h=p.sheetName}f.dateAxisData(a),h&&h!==g.name()&&f.dateAxisDataSheetName(h),f.dateAxisOrientation(s),f.group().displayDateAxis=!0}return d=g.getSparkline(t,e),g.removeSparkline(t,e),N.call(g,t,e,d,f),g.$p(),f},WLb:function(t,e,o){var n=this.getSparkline(t,e);N.call(this,t,e,n,o)},removeSparkline:function(t,e){var o,n,r,i=this,a=i.ZA;a&&(n={row:t,col:e,sparkline:o=i.getSparkline(t,e)},i.ITa.FUa(0,n),o&&((r=o.group()).remove(o),r.count()<=0&&a.remove(r),N.call(i,t,e,o,m)),i.$p())},groupSparkline:function(t){var e,o,n,r,i,a,s=this,l=s.ZA;if(!l)return m;for(e=m,o=[],n=s.ITa.zTa!==y,r=0;r<t.length;r++)(i=t[r])&&(n&&o.push({group:i.group().clone(),row:i.row,col:i.column}),e?((a=i.group()).remove(i),e.add(i),a.count()<=0&&l.remove(a)):e=i.group());return s.$p(),s.ITa.FUa(1,o),e},ungroupSparkline:function(t){var e,o,n,r,i,a,s=this,l=s.ZA;if(l&&t){for(e=[],o=[],n=s.ITa.zTa!==y,e=e.concat(t.PS),r=0;r<e.length;r++)(i=e[r])&&(n&&o.push({row:i.row,col:i.column}),t.remove(i),(a=t.clone()).add(i),l.add(a));l.remove(t),s.ITa.FUa(2,o),s.$p()}}},n.GC$.extend(n.Worksheet.prototype,w),T=function(){function t(t){this.Ub=[],this.kj=t,this.xn={},this.qZa=[],this.rZa=[]}return t.prototype.RUa=function(t,e){var o=this;o.fromJSON(t,e),o.groups().forEach((function(t){t.PS.forEach((function(t){o.SUa(t)}))}))},t.prototype.SUa=function(t){t&&this.JUa(t.row,t.column,t)},t.prototype.JUa=function(t,e,o){if(this.kj.ITa.zTa){var n={row:t,col:e,sparkline:this.KUa(t,e)};this.kj.ITa.FUa(12,n)}o?this.xn[O(t,e)]=o:delete this.xn[O(t,e)]},t.prototype.KUa=function(t,e){return this.xn[O(t,e)]||m},t.prototype.groups=function(t){return 0===arguments.length?this.Ub:void(this.Ub=t)},t.prototype.add=function(t){var e=this;e.kj.ITa.FUa(13,t),e.groups().push(t),t.ZA=e,t.QS(),e.zZa(t)},t.prototype.zZa=function(t){var e=this;e.sZa(t),t.all().forEach((function(t){e.tZa(t)}))},t.prototype.remove=function(t){var e=this;e.kj.ITa.FUa(14,t),f(e.groups(),t),e.yZa(t)},t.prototype.yZa=function(t){var e=this;e.uZa(t),t.all().forEach((function(t){e.vZa(t)}))},t.prototype.contains=function(t){return p(this.groups(),t)},t.prototype.count=function(){return this.groups().length},t.prototype.rI=function(t,e){E(this.Ub,t,e,!0,this),j(t,e,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.tI=function(t,e){E(this.Ub,t,e,!1,this),j(t,e,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.GR=function(t,e){B(this.Ub,t,e,!0,this),_(t,e,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.HR=function(t,e){B(this.Ub,t,e,!1,this),_(t,e,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.jOa=function(t,e){this.rZa.forEach((function(o){o.dateAxisDataSheetName()===t&&o.dateAxisDataSheetName(e)})),this.qZa.forEach((function(o){o.dataSheetName()===t&&o.dataSheetName(e)}))},t.prototype.tZa=function(t){var e,o,n=this.kj,r=t.dataSheetName();r&&r!==n.name()&&((e=n.parent.getSheetFromName(r))&&((o=e.ZA.qZa).indexOf(t)<0&&o.push(t)))},t.prototype.vZa=function(t){var e,o,n,r=t.dataSheetName();r&&((e=this.kj.parent.getSheetFromName(r))&&((n=(o=e.ZA.qZa).indexOf(t))>=0&&o.splice(n,1)))},t.prototype.sZa=function(t){var e,o,n=this.kj,r=t.dateAxisDataSheetName();r&&r!==n.name()&&((e=n.parent.getSheetFromName(r))&&((o=e.ZA.rZa).indexOf(t)<0&&o.push(t)))},t.prototype.uZa=function(t){var e,o,n,r=t.dateAxisDataSheetName();r&&((e=this.kj.parent.getSheetFromName(r))&&((n=(o=e.ZA.rZa).indexOf(t))>=0&&o.splice(n,1)))},t.prototype.clear=function(t,e,o,n){var r,i,a,s,l,u,c,f,p,d=this;if(0===arguments.length){for(r=d.Ub,i=h(r)-1;i>-1;i--)if(a=r[i]){for(s=a.count()-1;s>-1;s--)l=a.PS[s],d.JUa(l.row,l.column,m),a.remove(l);d.remove(a)}}else for(u=t;u<t+o;u++)for(c=e;c<e+n;c++)(f=d.RS(u,c))&&(d.JUa(f.row,f.column,m),(p=f.group()).remove(f),0===p.count()&&d.remove(p))},t.prototype.RS=function(t,e){var o,n,r,i,a=this.Ub;for(o=0;o<a.length;o++)for(n=a[o],r=0;r<n.count();r++)if((i=n.PS[r])&&i.row===t&&i.column===e)return i;return m},t.prototype.Zz=function(t,e,o,r,i,a,s,l){var c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R=this,M=R.kj;if(M){for(c=new n.KTa,f=o-t,h=r-e,g=M.getRowCount(),m=M.getColumnCount(),v=i,b=a,w=M.ZA,T=!l&&M.KLc(),p=0,y=0;p<i&&o+p<g;p++)if(T&&0===M.getRowHeight(o+p))i++;else if(s&&M.Ps&&M.Ps(o+p))y++;else{for(d=0,C=0,a=b;d<a&&r+d<m;d++)T&&0===M.getColumnWidth(r+d)?a++:((S=M.getSparkline(t+y,e+C))&&((x=S.clone()).row=o+p,x.column=r+d,A=x.dateAxisData(),T&&(f=o-t+p-y,h=r-e+d-C),!u(A)&&R.SS(A,f,h,g,m)&&x.dateAxisData(A.offset(h,f)),I=x.data(),!u(I)&&R.SS(I,f,h,g,m)&&x.data(I.offset(h,f)),R.add(x.group()),c.set(p,d,x)),C++);y++}for(p=0,i=v;p<i&&o+p<g;p++)if(T&&0===M.getRowHeight(o+p))i++;else if(!(s&&M.Ps&&M.Ps(o+p)))for(d=0,a=b;d<a&&r+d<m;d++)T&&0===M.getColumnWidth(r+d)?a++:w.JUa(o+p,r+d,c.get(p,d))}},t.prototype.SS=function(t,e,o,n,r){var i,a,s,l,u=this.TS(t);return!(!u||(i=C(u.row,0),a=C(u.col,0),s=u.row<0?n:u.rowCount,l=u.col<0?r:u.colCount,i+e<0||a+o<0||i+s+e>n||a+l+o>r))},t.prototype.aB=function(t,e,o,r,i,a){var s,l,u,c,f,h,p,d,g,y,C,v,b=this.kj;if(b){for(u=b.KLc(),c=a,f=i,this.US(t,e,o,r,i,a),h=b.ZA,p=new n.KTa,y=b.getRowCount(),C=b.getColumnCount(),d=0,s=0;d<i&&d+o<y;d++)if(u&&0===b.getRowHeight(o+d))i++;else{for(g=0,l=0,a=c;g<a&&r+g<C;g++)u&&0===b.getColumnWidth(r+g)?a++:((v=b.getSparkline(t+s,e+l))&&(v.row=o+d,v.column=r+g,p.set(s,l,v)),h.JUa(t+s,e+l,m),l++);s++}for(d=0,s=0,i=f;d<i&&d+o<y;d++)if(u&&0===b.getRowHeight(o+d))i++;else{for(g=0,l=0,a=c;g<a&&r+g<C;g++)u&&0===b.getColumnWidth(r+g)?a++:(b.removeSparkline(o+d,r+g),h.JUa(o+d,r+g,p.get(s,l)),l++);s++}}},t.prototype.US=function(t,e,o,n,r,i,a){var s,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I=this;if(a&&(I=a),u=(s=I.kj).KLc(),c=l(t,e,r,i),p=i,C=s.getRowCount(),v=s.getColumnCount(),b=I.Ub,u)for(g=0,y=0;g<r&&g+o<C;g++)if(0!==s.getRowHeight(o+g)){for(d=0,m=0,i=p;d<i&&d+n<v;d++)if(0!==s.getColumnWidth(n+d)){if(w=s.getSparkline(t+y,e+m))for(f=o-t+g-y,h=n-e+d-m,T=w.cb.PS,S=0;S<T.length;S++)(x=T[S])&&I.JMc(x,f,h,c);m++}else i++;y++}else r++;else for(f=o-t,h=n-e,S=0;S<b.length;S++)for(T=b[S].PS,A=0;A<T.length;A++)(w=T[A])&&I.JMc(w,f,h,c)},t.prototype.JMc=function(t,e,o,n){var r,i,a=t.dateAxisData(),s=this.TS(a);s&&n.containsRange(s)&&n.contains(t.row,t.column)&&t.dateAxisData(a.offset(o,e)),r=t.data(),(i=this.TS(r))&&n.containsRange(i)&&n.contains(t.row,t.column)&&t.data(r.offset(o,e))},t.prototype.TS=function(t){return t},t.prototype._A=function(t,e,o,n,r,i,a,s,l){var c,f,h,p,d,g,y,C,v,b,w,T,S,x,A,I=this,R=I.kj;if(R){if(t===R)return void I.Zz(e,o,n,r,i,a);for(c=n-e,f=r-o,h=R.ZA,p=!l&&R.KLc(),d=R.getRowCount(),g=R.getColumnCount(),y=a,C=0,b=0;C<i&&n+C<d;C++)if(p&&0===R.getRowHeight(n+C))i++;else if(s&&R.Ps&&R.Ps(n+C))b++;else{for(v=0,w=0,a=y;v<a&&r+v<g;v++)p&&0===R.getColumnWidth(r+v)?a++:((T=t.getSparkline(e+b,o+w))?((S=T.clone()).row=n+C,S.column=r+v,x=S.dateAxisData(),p&&(c=n+C-e-b,f=r-o+v-w),!u(x)&&I.SS(x,c,f,d,g)&&S.dateAxisData(x.offset(f,c)),A=S.data(),!u(A)&&I.SS(A,c,f,d,g)&&S.data(A.offset(f,c)),I.add(S.group()),h.JUa(n+C,r+v,S)):h.JUa(n+C,r+v,m),w++);b++}}},t.prototype.$A=function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g,y,C,v=this,b=v.kj;if(b){if(t===b)return void v.aB(e,o,n,r,i,a);for(s=b.KLc(),l=a,u=t.ZA,c=b.ZA,p=b.getRowCount(),d=b.getColumnCount(),v.VS(t,e,o,n,r,i,a),f=0,0;f<i&&n+f<p;f++)if(s&&0===b.getRowHeight(n+f))i++;else for(h=0,0,a=l;h<a&&r+h<d;h++)s&&0===b.getColumnWidth(r+h)?a++:((g=t.getSparkline(e+0,o+0))?(g.row=n+f,g.column=r+h,C=(y=g.group()).clone(),y.remove(g),y.count()<=0&&u.remove(y),C.add(g),v.add(C),c.JUa(n+f,r+h,g)):c.JUa(n+f,r+h,m),u.JUa(e+0,o+0,m))}},t.prototype.VS=function(t,e,o,n,r,i,a){var s=this.kj;t&&s&&this.US(e,o,n,r,i,a,t.ZA)},t.prototype.toJSON=function(){var t,e=this.Ub,o=[];for(t=0;e&&t<e.length;t++)o.push(e[t].toJSON());return 0===o.length?y:o},t.prototype.fromJSON=function(t,e){var o,n,r;for(this.Ub.length=0,this.xn={},o=0;t&&o<t.length;o++)n=t[o],(r=new R).fromJSON(n,e),this.add(r)},t}(),function(t){t[t.gaps=0]="gaps",t[t.zero=1]="zero",t[t.connect=2]="connect"}(e.EmptyValueStyle||(e.EmptyValueStyle={})),function(t){t[t.individual=0]="individual",t[t.group=1]="group",t[t.custom=2]="custom"}(e.SparklineAxisMinMax||(e.SparklineAxisMinMax={})),S=r.Common.pc.bc(255,149,179,215),x=r.Common.pc.bc(255,36,64,98),A={axisColor:"black",firstMarkerColor:S,highMarkerColor:"Blue",lastMarkerColor:S,lowMarkerColor:"Blue",markersColor:x,negativeColor:"Brown",seriesColor:x,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},I=function(){function t(t){var e,o=this;for(e in o.options={},A)A.hasOwnProperty(e)&&(o.options[e]=t&&t[e]?t[e]:A[e]);o.WS=m}return t.prototype.clone=function(){return new t(this.options)},t.prototype.toJSON=function(){var t,e=this.options,o={};for(t in e)A[t]!==e[t]&&(o[t]=e[t]);return s(o)?y:o},t}(),e.SparklineSetting=I,function(t){t[t.line=0]="line",t[t.column=1]="column",t[t.winloss=2]="winloss"}(e.SparklineType||(e.SparklineType={})),function(t){t[t.vertical=0]="vertical",t[t.horizontal=1]="horizontal"}(e.DataOrientation||(e.DataOrientation={})),R=function(){function t(t,e){var o=this;o.displayDateAxis=!1,o.ZA=m,o.PS=[],o.XS=m,o.YS=1,o.setting=e,o.sparklineType=t}return t.prototype.OW=function(){var t;return this.ZA&&(t=this.ZA.kj),t},t.prototype.TUa=function(){var t,e=this,o=e.OW();o&&o.ITa.zTa&&(t={group:e,PS:e.PS.concat()},o.ITa.FUa(10,t))},t.prototype.add=function(t){var e,o=this;t&&(o.TUa(),o.PS.push(t),t.group(o),o.QS(),(e=o.ZA)&&e.tZa(t),o.onGroupChanged())},t.prototype.clear=function(){this.TUa();var t=this.ZA;t&&this.PS.forEach((function(e){t.vZa(e)})),this.PS=[]},t.prototype.all=function(){return this.PS},t.prototype.remove=function(t){var e,o=this,n=o.PS;return o.TUa(),f(n,t),t.onSparklineChanged(),t.cb=o.clone(),o.QS(),(e=o.ZA)&&e.vZa(t),o.onGroupChanged(),n},t.prototype.contains=function(t){return p(this.PS,t)},t.prototype.onGroupChanged=function(){var t,e,o=this.PS;if(o)for(t=0;t<o.length;t++)(e=o[t])&&e.onSparklineChanged()},t.prototype.clone=function(){var e=this,o=e.setting?e.setting.clone():m,n=new t(e.sparklineType,o);return n.displayDateAxis=e.displayDateAxis,n.XS=e.XS,n.nZa=e.nZa,n.YS=e.YS,n},t.prototype.dateAxisData=function(t){var e,o,n,r=this;return 0===arguments.length?r.XS:((e=r.OW())&&e.ITa.zTa&&(void 0,o={group:r,rangeInfo:r.XS?{row:r.XS.row,col:r.XS.col,rowCount:r.XS.rowCount,colCount:r.XS.colCount}:m},e.ITa.FUa(8,o)),n=r.XS,r.XS=t,void(n!==t&&r.onGroupChanged()))},t.prototype.dateAxisDataSheetName=function(t){var e,o,n,r=this;return 0===arguments.length?r.nZa:(e=r.nZa,(o=r.OW())&&o.ITa.zTa&&(n={group:r,dateAxisDataSheetName:e},o.ITa.FUa(16,n)),e!==t&&(e&&o&&o.ZA.uZa(r),r.nZa=t,t&&o&&o.ZA.sZa(r),r.onGroupChanged()),r)},t.prototype.dateAxisOrientation=function(t){var e,o,n,r=this;return 0===arguments.length?r.YS:((e=r.OW())&&e.ITa.zTa&&(o={group:r,dateAxisOrientation:r.YS},e.ITa.FUa(9,o)),n=r.YS,r.YS=t,void(n!==t&&r.onGroupChanged()))},t.prototype.count=function(){return this.PS.length},t.prototype.QS=function(){var t,e,o,n,r,i,a,s,l=this,u=l.setting,c=l.PS;if(u&&((t=u.options).groupMaxValue=-v,t.groupMinValue=v,e=1===t.maxAxisType,o=1===t.minAxisType,e||o))for(n=0;n<c.length;n++)r=c[n],a=(i=l.ZS(r)).min,s=i.max,e&&t.groupMaxValue<s&&(t.groupMaxValue=s),o&&t.groupMinValue>a&&(t.groupMinValue=a)},t.prototype.ZS=function(t){var e,o,n,r,i,a,s=-v,l=v,u=t.data();if(u)for(o=(e=t.bT())&&e.parent.getSheetFromName(t.dataSheetName()),n=t.$S(u,t.dataOrientation(),!1,o||e),r=0;r<n.length;r++)(i=n[r])===d&&(i=0),"number"==typeof i&&(s=s<(a=i)?a:s,l=l>a?a:l);return{min:l,max:s}},t.prototype.toJSON=function(){var t,e,o,n=this,r={setting:n.setting?n.setting.toJSON():m,displayDateAxis:n.displayDateAxis,sparklineType:n.sparklineType,axisOrientation:n.YS,sparklines:n.PS.map((function(t){return t.toJSON()}))},i=n.XS;for(e in i&&(r.axisReference={row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount,sheetName:n.nZa}),t={},r)r.hasOwnProperty(e)&&(V(e,o=r[e])||(t[e]=o));return s(t)?y:t},t.prototype.fromJSON=function(t,e){var o,n,r,i,a,s,c,f,h;if(t&&(o=this,n=t.displayDateAxis,r=t.sparklineType,i=t.axisReference,a=t.axisOrientation,s=t.sparklines,o.setting=new I(t.setting),u(n)||(o.displayDateAxis=n),u(r)||(o.sparklineType=r),u(i)||(o.XS=l(i.row,i.col,i.rowCount,i.colCount),o.nZa=i.sheetName),u(a)||(o.YS=a),s))for(o.PS=[],c=0,f=s.length;c<f;c++)(h=new M).fromJSON(s[c]),o.add(h)},t}(),M=function(){function t(t,e,o,n,r,i){var a=this;a.row=t,a.column=e,a._S=n,a.aT=o,a.cb=new R(r,i),a.cb.add(a)}return t.prototype.group=function(t){var e,o,n,r,i=this;return 0===arguments.length?((e=i.cb)||((e=new R).add(i),i.cb=e),e):(o=i.cb,(n=i.bT())&&n.ITa.zTa&&(r={row:i.row,col:i.column,group:o},n.ITa.FUa(11,r)),t!==o&&(o&&o.remove(i),i.cb=t,t&&!t.contains(i)&&t.add(i),i.onSparklineChanged()),n&&n.$p(),i)},t.prototype.sparklineType=function(t){var e,o,n,r,i=this;return 0===arguments.length?i.group().sparklineType:((o=(e=i.group()).sparklineType)!==t&&(e.sparklineType=t,(n=i.bT())&&n.ITa.zTa&&(r={row:i.row,col:i.column,sparklineType:o},n.ITa.FUa(3,r)),i.onSparklineChanged(),n&&n.$p()),i)},t.prototype.onSparklineChanged=function(){var t=this.bT();t&&t.Wq(n.Events.SparklineChanged,{sheet:t,sheetName:t.name(),sparkline:this})},t.prototype.setting=function(t){var e,o=this,r=o.group(),i=o.bT(),a=i&&i.ITa.zTa;return 0===arguments.length?(void 0,a?n.GC$.extend(!0,{},r.setting):r.setting):(a&&(e={row:o.row,col:o.column,setting:n.GC$.extend(!0,{},r.setting)},i.ITa.FUa(4,e)),r.setting=t,i&&i.$p(),o)},t.prototype.data=function(t){var e,o,r=this;return 0===arguments.length?r.aT:((e=r.bT())&&e.ITa.zTa&&(o={row:r.row,col:r.column,sparkline:r,data:n.GC$.extend(!0,{},r.aT)},e.ITa.FUa(5,o)),r.aT!==t&&(r.aT=t,r.onSparklineChanged()),e&&e.$p(),r)},t.prototype.dataSheetName=function(t){var e,o,n,r=this;return 0===arguments.length?r.oZa:(e=r.oZa,(o=r.bT())&&o.ITa.zTa&&(n={row:r.row,col:r.column,dataSheetName:e},o.ITa.FUa(15,n)),e!==t&&(e&&o&&o.ZA.vZa(r),r.oZa=t,t&&o&&o.ZA.tZa(r),r.onSparklineChanged()),r)},t.prototype.dataOrientation=function(t){var e,o,n=this;return 0===arguments.length?n._S:((e=n.bT())&&e.ITa.zTa&&(o={row:n.row,col:n.column,dataOrientation:n._S},e.ITa.FUa(6,o)),n._S!==t&&(n._S=t,n.onSparklineChanged()),e&&e.$p(),n)},t.prototype.dateAxisData=function(t){var e=this.group();return 0===arguments.length?e.dateAxisData():(e.dateAxisData(t),this)},t.prototype.dateAxisDataSheetName=function(t){var e=this.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(t),this)},t.prototype.dateAxisOrientation=function(t){var e=this.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(t),this)},t.prototype.displayDateAxis=function(t){var e,o,n=this,r=n.group();return 0===arguments.length?r.displayDateAxis:((e=n.bT())&&e.ITa.zTa&&(o={row:n.row,col:n.column,displayDateAxis:r.displayDateAxis},e.ITa.FUa(7,o)),r.displayDateAxis=t,n)},t.prototype.clone=function(){var e=this,o=new t;return o.row=e.row,o.column=e.column,o.data(e.data()),o.dataSheetName(e.dataSheetName()),o.dataOrientation(e.dataOrientation()),o.group(e.group().clone()),o},t.prototype.paintSparkline=function(t,e,o,r,i){var a,s,l,u=this,c=u.bT();c&&c.parent&&(a=c.parent.getSheetFromName(u.dataSheetName()),s=c.parent.getSheetFromName(u.dateAxisDataSheetName())),this.lKb&&(c=this.lKb),l={sparklineType:u.sparklineType(),displayDateAxis:u.displayDateAxis(),zoomFactor:c.zoom(),values:u.hKb||u.$S(u.data(),u.dataOrientation(),!1,a||c),dateValues:u.jKb||u.$S(u.dateAxisData(),u.dateAxisOrientation(),!0,s||c),settings:u.setting(),getColor:function(t){if(c&&t){var e=n.Rm.Om(c,t);if(e)return e}return t}},(new g).paint(t,l,e,o,r,i)},t.prototype.iKb=function(t){var e=this;return e.$S(e.data(),e.dataOrientation(),!1,t)},t.prototype.kKb=function(t){var e=this;return e.$S(e.dateAxisData(),e.dateAxisOrientation(),!0,t)},t.prototype.$S=function(e,o,n,r){var i=this.setting().options.displayHidden;return t.cT(y,r,i,e,o,n)},t.prototype.bT=function(){var t=this.group(),e=t&&t.ZA;return e?e.kj:m},t.prototype.toJSON=function(){var t=this;return{row:t.row,col:t.column,orientation:t._S,data:{row:t.aT.row,rowCount:t.aT.rowCount,col:t.aT.col,colCount:t.aT.colCount,sheetName:t.oZa}}},t.prototype.fromJSON=function(t){var e,o,n,r,i,a;t&&(e=this,o=t.row,n=t.col,r=t.orientation,i=t.data,u(o)||(e.row=o),u(n)||(e.column=n),u(r)||(e._S=r),i&&(a=i,e.aT=l(a.row,a.col,a.rowCount,a.colCount),e.oZa=a.sheetName))},t.cT=function(t,e,o,n,a,s){var l,c,f,h,p,g="number",m=[],y=1===a;if(e&&n)for(l=0,c=y?n.colCount:n.rowCount;l<c;l++)f=y?0:l,h=y?l:0,(p=t?t[f][h]:e.getValue(n.row+f,n.col+h))instanceof i.CalcError||(!o&&(e.getRowHeight(n.row+f)<=0||e.getColumnWidth(n.col+h)<=0)?p=NaN:u(p)||(s?p=typeof p===g?r.Common.l.Xb(p):Date.parse(p):typeof p!==g&&(p=d)),m.push(p));return m},t}(),e.Sparkline=M},"./dist/plugins/statusBar/baseStatusBar.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("./dist/plugins/statusBar/statusItem.js"),i=n.GC$,a=null,s="left",l="right",u=function(){function t(t){this.yzb=[],this.zzb=[],this.Azb=[],this.mi=0,this.qo=a,this.ET=t,this.Bzb()}return t.prototype.Bzb=function(){var t=this.qo,e=this.Czb;t||(t=this.qo=document.createElement("div"),e=this.Czb=document.createElement("div")),this.ET.appendChild(t),this.ET.appendChild(e)},t.prototype.Dzb=function(t){t.name||(t.name="statusItem"+this.mi,this.mi++)},t.prototype.mL=function(t,e){return t instanceof r.StatusItem&&!this.Jp(t.name)&&(this.Dzb(t),e>=0&&e<this.yzb.length?this.yzb.splice(e,0,t):this.yzb.push(t),t.align=t.align||s,t.Ezb(this.ET),!0)},t.prototype.Fzb=function(t,e){var o,n,r,i,s=!1,u=this.yzb,c=e>=0&&e<u.length,f=a,h=a;if(c&&(h=(f=u[e]).Gzb()),this.mL(t,e)){o=t.align===l;try{o?(r=(n=this.Azb).indexOf(f),i=n.length-1,h&&r>=0&&r<i?h=n[r+1].Gzb():h===a?h=n[0].Gzb():(h&&r<0||r===i)&&(h=a),this.Azb.push(t)):this.zzb.push(t),this.qo.insertBefore(t.Gzb(),h),this.xc&&t.onBind(this.xc),s=!0}catch(e){o?this.Azb.splice(this.Azb.indexOf(t),1):this.zzb.splice(this.zzb.indexOf(t),1),this.yzb.splice(this.yzb.indexOf(t),1)}}return s},t.prototype.Hzb=function(t){var e,o,n=this.yzb,r=!1;for(e=0;e<n.length;e++)if(t===(o=n[e]).name){r=!0;break}return!!r&&(o.onUnbind(),o.align===l?this.Azb.splice(this.Azb.indexOf(o),1):this.zzb.splice(this.zzb.indexOf(o),1),this.yzb.splice(e,1),this.qo.removeChild(o.Gzb()),!0)},t.prototype.Jp=function(t){var e,o,n=this.yzb;for(e=0;e<n.length;e++)if(t===(o=n[e]).name)return o;return a},t.prototype.Izb=function(t){this.xc=t,this.yzb.forEach((function(e){e.onBind(t),e.onUpdate()}))},t.prototype.hZ=function(){this.zzb=[],this.Azb=[],i(this.qo).empty()},t.prototype.Jzb=function(){var t,e=this,o=this.qo,n=s;this.hZ(),this.yzb.forEach((function(r){n=r.align,(t=r.Gzb()).style.float=n,n===l?e.Azb.unshift(r):(e.zzb.unshift(r),o.appendChild(t))})),this.Azb.forEach((function(t){o.appendChild(t.Gzb())}))},t.prototype.Kzb=function(){this.yzb.forEach((function(t){t.onUpdate()})),this.Jzb()},t.prototype.Lzb=function(){var t=[];return this.yzb.forEach((function(e){t.push(e.Mzb())})),t},t.prototype.Nzb=function(t){var e,o,n=this.yzb,r=t.name;for(e=0;e<n.length;e++)if((o=n[e]).name===r){o.Nzb(t);break}},t.prototype.Ozb=function(){return this.yzb},t.prototype.Pzb=function(){var t,e=this.yzb;for(this.xc=a,t=0;t<e.length;t++)e[t].onUnbind()},t.prototype.no=function(){var t,e,o=this.yzb;if(this.qo){for(t=0;t<o.length;t++)e=o[t],this.qo.removeChild(e.Qzb),e.onDispose();this.qo.parentElement&&this.qo.parentElement.removeChild(this.qo),this.Czb.parentElement&&this.Czb.parentElement.removeChild(this.Czb),this.qo=a,this.Czb=a}this.mi=a,this.yzb=a,this.zzb=a,this.Azb=a},t}(),e.BaseStatusBar=u},"./dist/plugins/statusBar/statusBar.entry.js":function(t,e,o){"use strict";var n,r,i;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("./dist/plugins/statusBar/statusBar.js"),e.StatusBar=r.StatusBar,i=o("./dist/plugins/statusBar/statusItem.js"),e.StatusItem=i.StatusItem,function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o("./dist/plugins/statusBar/statusBar.ns.js")),e.findControl=function(t){return"string"==typeof t&&(t=document.getElementById(t)),n.GC$(t).data("statusbar")}},"./dist/plugins/statusBar/statusBar.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function rt(t,e){return"_SUBTOTALFORSTATUSBAR("+t+r.Common.CultureManager.q4().NumberFormat.listSeparator+e+")"}function it(t,e){t.splice(e,1)}function at(t,e){var o,n=e,r=e.length,i=[];if(r>1){for(i.push(e[0]),o=1;o<r;o++)i=st(t,e[o],i);return i}return n}function st(t,e,o){var n,r,i,a,s,l,u=t.getRowCount(3),c=t.getColumnCount(3),f=[],h=[];for(f.push(e),a=o.length,s=0;s<a;s++)for(n=o[s],l=0;l<f.length;)(i=(r=f[l]).getIntersect(n,u,c))?(h=t.v_a(r,i,u,c),it(f,l),f=h.concat(f),l+=h.length):l++;return f.concat(o)}function lt(t){var e=t;return t>0&&t<=4&&(e=Math.floor(+parseFloat((100*t).toPrecision(12)))),e}function ut(t,e,o){if(t&&t.parent&&t.parent.options.allowUserZoom){var r={sheet:t,sheetName:t.name(),newZoomFactor:e,oldZoomFactor:o,cancel:!1};if(t.Wq(n.Events.ViewZooming,r),r&&!0===r.cancel)return;(e=r.newZoomFactor)!==o&&(t.wu().execute({cmd:_,sheetName:t.name(),newZoomFactor:e,oldZoomFactor:o}),ht(t,e,o))}}function ct(t){for(var e,o,n,r={top:t.offsetTop,left:t.offsetLeft},i=t.offsetParent;i;)r.top+=i.offsetTop,r.left+=i.offsetLeft,i=i.offsetParent;return o=(e=document.body).clientTop,n=e.clientLeft,isNaN(o)||(r.top+=o),isNaN(n)||(r.left+=n),r}function ft(t){return""!==t}function ht(t,e,o){t.Wq(n.Events.UserZooming,{sheet:t,sheetName:t.name(),oldZoomFactor:o,newZoomFactor:e}),t.Wq(n.Events.ViewZoomed,{sheet:t,sheetName:t.name(),oldZoomFactor:o,newZoomFactor:e})}function pt(t,e){t.xc=e,e.bind(n.Events.ActiveSheetChanged+t.Rzb,(function(){t.onUpdate()}))}function dt(t){var e,o;u.StatusItem.prototype.onUpdate.call(t),(e=n.sJc(t.xc))&&(o=e.zoom(),t.qAb(o))}function gt(t){t.xc&&(t.xc.unbind(n.Events.ActiveSheetChanged+t.Rzb),t.xc=b)}function mt(){q&&J.call(this)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("@grapecity/js-calc"),a=o("SheetsCalc"),s=o("ContextMenu"),l=o("./dist/plugins/statusBar/statusBar.ns.js"),u=o("./dist/plugins/statusBar/statusItem.js"),c=o("./dist/plugins/statusBar/baseStatusBar.js"),f=n.GC$,h=n.Ul,p=h.Nl,d=h.nl,g=r.Common.j,m=r.Common.u.Kb,y=g.Fa,C=n.Commands.ActionBase,v=i.Convert.vf,b=null,w=f.inherit,x=(T="gc-statusbar-")+(S="slider-")+"btn",A=T+S+"add-btn",I=T+S+"back-progress",R=T+S+"back",M=T+S+"middle-line",k=T+S+"drag-bar",N=T+"zoom-panel",O=T+S+"btn-container",D=T+S+"add-btn-container",F=T+"menu-host",E="%",j="px",P="div",L="none",G="inline",B="right",_="statusbarZoom",V="statusBar",H="click",z="contextmenu",U=".statusbar",W=["average","count","numericalCount","min","max","sum"],q=!!s,s&&(J=s.MenuView,X=s.Cyb),Z=new r.Common.ResourceManager(l.SR,"StatusBar"),Y=Z.getResource.bind(Z),K=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.Rzb=U+n.name,n}return nt(e,t),e.prototype.onBind=function(t){var e,o=this;o.xc=t,t.bind(n.Events.EditorStatusChanged+o.Rzb,(function(t,n){e=o.Szb(n.newStatus),o.Tzb(e)})),t.bind(n.Events.ActiveSheetChanged+o.Rzb,(function(){o.onUpdate()}))},e.prototype.onUpdate=function(){var e,o,r;t.prototype.onUpdate.call(this),(e=n.sJc(this.xc))&&(o=e.editorStatus(),r=this.Szb(o),this.Tzb(r))},e.prototype.Szb=function(t){var e;switch(t){case 0:e=Y().cellModeReady;break;case 1:e=Y().cellModeEnter;break;case 2:e=Y().cellModeEdit}return e},e.prototype.Tzb=function(t){if(t!==this.value){this.value=t,this.tipText=m(Y().toolTipCellMode,[t]);var e=this.TJa;e&&(e.parentElement.title=this.tipText,y(this.value)||(e.innerText=this.value+""))}},e.prototype.onUnbind=function(){this.xc&&(this.xc.unbind(n.Events.EditorStatusChanged+this.Rzb),this.xc.unbind(n.Events.ActiveSheetChanged+this.Rzb),this.xc=b)},e}(u.StatusItem),Q=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.Uzb=": ",n.fhc=!1,n.Uk=o.prefix,n.Rzb=U+n.name,n.XLb=Number.MAX_VALUE,n.ghc={},n}return nt(e,t),e.prototype.onBind=function(t){var e=this;e.xc=t,t.bind(n.Events.SelectionChanging+e.Rzb,(function(t,o){e.Vzb(o)})),t.bind(n.Events.SelectionChanged+e.Rzb,(function(t,o){e.Vzb(o)})),t.bind(n.Events.ValueChanged+e.Rzb,(function(t,o){var n=o.sheet,r=o.row,i=o.col;n.vp(r,i)&&e.onUpdate()})),t.bind(n.Events.RangeChanged+e.Rzb,(function(){e.onUpdate()})),t.bind(n.Events.DragFillBlockCompleted+e.Rzb,(function(){e.onUpdate()})),t.bind(n.Events.ActiveSheetChanged+e.Rzb,(function(){e.onUpdate()})),t.bind(n.Events.TopRowChanged+e.Rzb,(function(){e.hhc(!0)})),t.bind(n.Events.RowChanged+e.Rzb,(function(){e.hhc(!1)})),t.bind(n.Events.ColumnChanged+e.Rzb,(function(){e.hhc(!1)})),t.bind(n.Events.RangeFiltered+e.Rzb,(function(){e.hhc(!1)})),t.bind(n.Events.TableFiltered+e.Rzb,(function(){e.hhc(!1)})),t.bind(n.Events.TableFilterCleared+e.Rzb,(function(){e.hhc(!1)})),t.bind(n.Events.RangeFilterCleared+e.Rzb,(function(){e.hhc(!1)}))},e.prototype.hhc=function(t){this.fhc=t},e.prototype.YLb=function(t){var e=n.sJc(this.xc),o=0;return t.forEach((function(t){var n=e.Tq(t);o+=n.rowCount*n.colCount})),o<this.XLb},e.prototype.Vzb=function(t){var e,o,n=this,r=t.sheet,i=t.newSelections;n.YLb(i)?1===i.length&&1===i[0].rowCount&&1===i[0].colCount?(e=n.Wzb(r,b),n.Tzb(e[n.name])):ft(o=n.ZLb(at(r,i)))?(e=n.Wzb(r,o),n.Tzb(e[n.name])):y(n.value)&&n.Xzb(!1):n.Tzb(b)},e.prototype.Wzb=function(t,e){var o,n,r,i,s,l,u,c,f,h,p,d,g=this,m=a.evaluateFormula,C=0,w=b,T=b,S=b,x=b,A=b;return e&&(n=(o=g.ghc)[e],!g.fhc||y(n)?(g.hhc(!1),(C=m(t,rt(103,e)))>1&&((w=m(t,rt(102,e)))>0&&(r=m(t,rt(101,e)),i=m(t,rt(105,e)),s=m(t,rt(104,e)),l=m(t,rt(109,e)),v(r)||v(i)||v(s)||v(l)||(u=t.getActiveRowIndex(),c=t.getActiveColumnIndex(),f=t.getCellType(u,c),h=function(t,e,o){var n=t.tq(e,o,"formatter");return n||(n=t.tq(e,o,"_autoFormatter")),n}(t,u,c),p={},S=f.format(r,h,p),x=f.format(i,h,p),A=f.format(s,h,p),T=f.format(l,h,p)))),o[e]={average:S,numericalCount:w,minimum:x,maximum:A,sum:T,count:C}):(S=n.average,w=n.numericalCount,x=n.minimum,A=n.maximum,T=n.sum,C=n.count)),(d={}).average=S,d.numericalCount=w>0?w:b,d.min=x,d.max=A,d.sum=T,d.count=C>1?C:b,d},e.prototype.Xzb=function(t){this.Qzb&&(this.Qzb.style.display=t?"inline-block":L)},e.prototype.Tzb=function(t){var e=this.Uzb,o=this.TJa,n=this.Uk,r=this.visible,i=!1;this.value=t,o.innerText=n+e+t,!y(t)&&r&&(i=!0),this.Xzb(i)},e.prototype.Av=function(t){if(t){var e=t.menuContent,o=t.tipText;this.menuContent=e,this.Uk=e,this.tipText=o,this.Qzb.title=o}},e.prototype.onUpdate=function(){var e,o,r,i,a,s;t.prototype.onUpdate.call(this),e=this,(o=n.sJc(e.xc))&&(r=o.getSelections(),e.YLb(r)?1===r.length&&1===r[0].rowCount&&1===r[0].colCount?(i=e.Wzb(o,b),e.Tzb(i[e.name])):ft(a=e.ZLb(at(o,r)))?(s=(i=e.Wzb(o,a))[e.name],(y(s)||s!==e.value)&&(e.value=s,e.Tzb(s))):y(e.value)&&e.Xzb(!1):e.Tzb(b))},e.prototype.onUnbind=function(){var t=this.xc,e=this.Rzb;t&&(t.unbind(n.Events.SelectionChanging+e),t.unbind(n.Events.SelectionChanged+e),t.unbind(n.Events.ValueChanged+e),t.unbind(n.Events.RangeChanged+e),t.unbind(n.Events.DragFillBlockCompleted+e),t.unbind(n.Events.ActiveSheetChanged+e),t.unbind(n.Events.TopRowChanged+e),t.unbind(n.Events.RowChanged+e),t.unbind(n.Events.ColumnChanged+e),t.unbind(n.Events.RangeFiltered+e),t.unbind(n.Events.TableFiltered+e),t.unbind(n.Events.TableFilterCleared+e),t.unbind(n.Events.RangeFilterCleared+e),this.xc=b)},e.prototype.ZLb=function(t,e,o,n,r){var s,l=this.kh;return l||(l=this.kh=new i.Parser),(s=this.Dh)||(s=this.Dh=new a.SheetParserContext(b,!!r,i.pf(e,o))),a.ALb(l,s,t,e,o,n)},e.prototype.onDispose=function(){t.prototype.onDispose.call(this),this.kh=b,this.ghc=b,this.Dh&&(this.Dh.no(),this.Dh=b)},e}(u.StatusItem),$=function(t){function e(e,o,n){var r=t.call(this,o,n)||this;return r.min=25,r.max=400,r.middle=100,r.step=10,r.Yzb=1,r.Zzb=4,r.$zb=120,r._zb=Math.round((r.$zb+r.Yzb)/2),r.aAb=Math.round((r.$zb+r.Zzb)/2),r.bAb=!1,r.cAb=e,r.Rzb=U+r.name,r}return nt(e,t),e.prototype.onCreateItemView=function(t){var e,o,n,r,i,a,s,l,u=this,c=u._v,h=c+j;t.style.display=this.visible?G:L,(e=this.dAb)||(e=this.dAb=p(P)),f(e).addClass(O),e.style.height=h,e.style.lineHeight=h,(o=this.eAb)||(o=this.eAb=p(P)),o.title=Y().toolTipZoomOut,f(o).addClass(x),o.style.height=h,o.addEventListener(H,(function(){u.fAb(!1)})),(n=this.gAb)||(n=this.gAb=p(P)),f(n).addClass(D),n.style.height=h,n.style.lineHeight=h,(r=this.hAb)||(r=this.hAb=p(P)),r.title=Y().toolTipZoomIn,f(r).addClass(A),r.style.height=h,r.addEventListener(H,(function(){u.fAb(!0)})),(i=this.iAb)||(i=this.iAb=p(P)),f(i).addClass(I),i.style.marginTop=Math.floor(c/2+1)+j,i.addEventListener(H,(function(){return!1})),(a=this.jAb)||(a=this.jAb=p(P)),f(a).addClass(M),a.style.top=Math.floor((c-8)/2+1)+j,a.style.left=u._zb+j,(s=this.kAb)||(s=this.kAb=p(P)),s.title=Y().toolTipSlider,f(s).addClass(k),s.style.top=Math.floor((c-10)/2+1)+j,s.style.right=u.aAb+j,s.addEventListener("mousedown",(function(){u.bAb=!0})),document.addEventListener("mouseup",(function(){u.bAb=!1})),document.addEventListener("mousemove",(function(t){if(u.bAb){var e=t.pageX,o=ct(i).left+i.offsetWidth+u.Zzb-e;u.lAb(o)}})),(l=this.mAb)||(l=this.mAb=p(P)),l.title=Y().toolTipSlider,f(l).addClass(R),l.style.height=h,l.style.lineHeight=h,l.addEventListener(H,(function(t){var e,o,n=t.target;n!==s&&(n===a?e=u.aAb:(o=t.offsetX,e=l.offsetWidth-o),u.lAb(e))})),e.appendChild(o),t.appendChild(e),l.appendChild(a),l.appendChild(i),l.appendChild(s),t.appendChild(l),n.appendChild(r),t.appendChild(n)},e.prototype.M4=function(){this.xc&&this.xc.focus()},e.prototype.onBind=function(t){pt(this,t)},e.prototype.onUpdate=function(){dt(this)},e.prototype.fAb=function(t){var e,o=this.value;o%10==0?o=t?o+this.step:o-this.step:(e=o/10,o=t?Math.ceil(e):Math.floor(e),o*=10),o=(o=o>this.max?this.max:o)<this.min?this.min:o,this.nAb(o)},e.prototype.lAb=function(t){var e,o,r,i,a,s,l,u,c,f=this;t<0&&(t=0),t>f.$zb&&(t=f.$zb+f.Zzb),o=f.value/100,r=f.aAb,i=f.$zb,a=3*f.Zzb/2,s=f.min,l=f.middle,u=f.max,(c=t<=r?(r-t)/r*(u-l)+l:(i-t+a)/r*(l-s)+s)<=s+5?c=s:c>=u-5&&(c=u),e=c/100,ut(n.sJc(this.xc),e,o),f.M4()},e.prototype.nAb=function(t){t&&(t=lt(t),ut(n.sJc(this.xc),t/100,this.value/100),this.M4())},e.prototype.oAb=function(t){var e,o=this,n=o.min,r=o.middle,i=o.max,a=o.Zzb,s=o.aAb;e=o.$zb-(e=t<=r?(t-n)/(r-n)*s-a/2:(t-r)/(i-r)*s+s-a/2),this.pAb(e)},e.prototype.pAb=function(t){var e=this,o=e.Zzb/2,n=e.Zzb;t<=n?t+=n:t<e.$zb&&(t+=o),e.kAb.style.right=t+j},e.prototype.qAb=function(t){t&&(t=lt(t)),t!==this.value&&(this.value=parseInt(t+"",10),this.oAb(this.value))},e.prototype.rAb=function(t){return t===this.iAb||t===this.jAb||t===this.kAb||t===this.mAb},e.prototype.sAb=function(t){var e=t.target;this.rAb(e)&&this.tAb(.7)},e.prototype.uAb=function(t){var e=t.target;this.rAb(e)&&this.tAb(1)},e.prototype.tAb=function(t){this.kAb.style.opacity=t+""},e.prototype.Av=function(t){if(t){var e=t.tipText;this.menuContent=t.menuContent,this.tipText=e,this.eAb.title=e[0],this.hAb.title=e[1],this.kAb.title=e[2],this.mAb.title=e[2]}},e.prototype.onUnbind=function(){gt(this)},e.prototype.onDispose=function(){this.cAb=b,u.StatusItem.prototype.onDispose.call(this)},e}(u.StatusItem),tt=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.Rzb=U+n.name,n}return nt(e,t),e.prototype.onCreateItemView=function(t){t.style.display=this.visible?G:L;var e=this.vAb;e||(e=this.vAb=p("span")),f(e).addClass(N),e.innerText="100%",t.appendChild(e)},e.prototype.onBind=function(t){pt(this,t)},e.prototype.onUpdate=function(){dt(this)},e.prototype.qAb=function(t){var e;t&&(e=lt(t)),e!==parseInt(this.value+"",10)&&(e=parseInt(e,10),this.value=e+E,this.wAb(e))},e.prototype.wAb=function(t){var e=this.vAb;e&&(e.innerText=t+E)},e.prototype.onUnbind=function(){gt(this)},e}(u.StatusItem),et=function(){function t(t,e){var o,n;t&&(n=(o=this).xAb=new c.BaseStatusBar(t),o.yAb(n,e),o.qo=n.qo,this.Czb=n.Czb,o.zAb={},o.AAb(t),o.maxCalcCells=5e4,f(t).data("statusbar",o))}return Object.defineProperty(t.prototype,"maxCalcCells",{get:function(){return this.XLb},set:function(t){this.XLb=t,this.xAb.Ozb().forEach((function(e){e instanceof Q&&(e.XLb=t)}))},enumerable:!0,configurable:!0}),t.prototype.yAb=function(t,e){var o,n,r,i,a,s,l=["formulaAverage","formulaCount","formulaNumericalCount","formulaMin","formulaMax","formulaSum"],u=["toolTipFormulaAverage","toolTipFormulaCount","toolTipFormulaNumericalCount","toolTipFormulaMin","toolTipFormulaMax","toolTipFormulaSum"],c=[Y().formulaAverage,Y().formulaCount,Y().formulaNumericalCount,Y().formulaMin,Y().formulaMax,Y().formulaSum],f=[Y().toolTipFormulaAverage,Y().toolTipFormulaCount,Y().toolTipFormulaNumericalCount,Y().toolTipFormulaMin,Y().toolTipFormulaMax,Y().toolTipFormulaSum],h=[!0,!0,!1,!1,!1,!0],p=[];for(c.forEach((function(t,e){var o={};o.menuContent=t,o.prefix=t,o.align=B,o.tipText=f[e],o.visible=h[e],o.BAb=l[e],o.CAb=u[e],p.push(o)})),o={menuContent:Y().cellMode,value:Y().cellModeReady,tipText:m(Y().toolTipCellMode,[Y().cellModeReady]),BAb:"cellMode",CAb:"toolTipCellMode"},n={value:100,menuContent:Y().zoomSlider,showStatusInContexMenu:!1,align:B,BAb:"zoomSlider",CAb:["toolTipZoomOut","toolTipZoomIn","toolTipSlider"]},r={value:100+E,tipText:Y().toolTipZoomPanel,menuContent:Y().zoom,align:B,BAb:"zoom",CAb:"toolTipZoomPanel"},i=[new K("cellMode",o),new Q(W[0],p[0]),new Q(W[1],p[1]),new Q(W[2],p[2]),new Q(W[3],p[3]),new Q(W[4],p[4]),new Q(W[5],p[5]),new $(this,"zoomSlider",n),new tt("zoomPanel",r)],e&&e.items instanceof Array&&(i=i.concat(e.items)),s=0;s<i.length;s++)a=i[s],t.mL(a);t.Jzb()},t.prototype.AAb=function(t){var e,o=this.qo,n=this.Czb,r=t.clientHeight;o&&(f(o).addClass("gc-statusbar"),f(n).addClass(F),e=r,r<15&&(t.style.minHeight=15+j,e=15),n.style.top="-"+e+j)},t.prototype.DAb=function(){var t=this.qo;t&&(this.EAb=this.FAb.bind(this),t.addEventListener(z,this.EAb))},t.prototype.FAb=function(t){var e,o,n,r,i,a;d(t),o=(e=this).zAb,n=e.xc,q&&n&&(e.Ela||(e.Ela=new X(e.Czb,f(e.xc.sv))),r=o.menuView,a=ct(i=e.qo).left,r.hostInfo={top:i.getBoundingClientRect().top,width:i.clientWidth,height:i.clientHeight},o.menuData=e.xAb.Lzb(),e.Ela.OT(r,o.menuData,t.clientX-a,t.offsetY,n))},t.prototype.GAb=function(t){if(q){var e=new mt;this.zAb.menuView=e,this.nla(t)}},t.prototype.nla=function(t){var e=this,o={canUndo:!1,execute:function(t,o){var n=o.commandOptions;e.xAb.Nzb(n)}};t.commandManager().register("gc.spread."+V,o)},t.prototype.bind=function(t){this.unbind(),t&&(this.xc=t,t.cAb=this,this.xAb.Izb(t),this.GAb(t),this.DAb())},t.prototype.unbind=function(){this.xAb&&this.xAb.Pzb(),this.xc&&(this.xc.cAb=b,this.xc=b),this.qo&&(this.qo.removeEventListener(z,this.EAb),this.EAb=b),this.Ela&&(this.Ela.close(),this.Ela=b)},t.prototype.add=function(t,e){return this.xAb.Fzb(t,e)},t.prototype.remove=function(t){return this.xAb.Hzb(t)},t.prototype.get=function(t){return this.xAb.Jp(t)},t.prototype.all=function(){return this.xAb.Ozb()},t.prototype.update=function(){this.xAb.Kzb()},t.prototype.dispose=function(){this.unbind(),this.zAb=b,this.Ela=b,this.xAb&&(this.xAb.no(),this.xAb=b),this.qo&&(this.qo=b)},t}(),e.StatusBar=et,q&&w(mt,J),mt.prototype.getCommandOptions=function(t){return t},ot=function(t){function e(e,o){var n=t.call(this)||this;return n.kj=e,n.HAb=o,n}return nt(e,t),e.prototype.canExecute=function(){return!0},e.prototype.execute=function(){var t=this.kj,e=this.HAb,o=e.newZoomFactor;if(this.canExecute()){t.ITa.startTransaction();try{t.zoom(o)}finally{e[n.Commands.bWa(t.name())]=t.ITa.endTransaction()}return!0}return!1},e.prototype.canUndo=function(){return!0},e.prototype.undo=function(){var t=this.kj,e=this.HAb[n.Commands.bWa(t.name())][0].value,o=t.zoom();return e!==o&&(t.zoom(e),ht(t,e,o)),!0},e}(C),n.Commands[_]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,ot,e,o)}},n.Worksheet.$n(_,{setHost:function(t){if(t){var e=this.wu();e[_]||e.register(_,n.Commands[_])}},onLayoutChanged:function(t){var e,o;"invalidateLayout"===t.changeType&&((e=this.parent)&&!e.isPaintSuspended()&&((o=e.cAb)&&o.update()))}}),n.Workbook.$n(V,{onCultureChanged:function(){var t,e,o=this.cAb,n=Y(),r=[];o&&o.xAb&&o.xAb.Ozb().forEach((function(o){t=o.CAb,e=n[t],t instanceof Array&&(t.forEach((function(t){r.push(n[t])})),e=r),o.Av({menuContent:n[o.BAb],tipText:e})}))}})},"./dist/plugins/statusBar/statusBar.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/statusBar/statusBar.res.en.js");e.SR={en:n}},"./dist/plugins/statusBar/statusBar.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cellMode="Cell Mode",e.cellModeReady="Ready",e.cellModeEnter="Enter",e.cellModeEdit="Edit",e.formulaAverage="Average",e.formulaCount="Count",e.formulaNumericalCount="Numerical Count",e.formulaMin="Min",e.formulaMax="Max",e.formulaSum="Sum",e.zoomSlider="Zoom Slider",e.zoom="Zoom",e.toolTipCellMode="In {0} mode",e.toolTipFormulaAverage="Average of selected cells",e.toolTipFormulaCount="Number of selected cells that contain data",e.toolTipFormulaNumericalCount="Number of selected cells that contain numerical data",e.toolTipFormulaMin="Minimum value in selection",e.toolTipFormulaMax="Maximum value in selection",e.toolTipFormulaSum="Sum of selected cells",e.toolTipZoomOut="Zoom Out",e.toolTipZoomIn="Zoom In",e.toolTipSlider="Zoom",e.toolTipZoomPanel="Zoom level"},"./dist/plugins/statusBar/statusItem.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=n.Ul.Nl,a=n.GC$,s=r.Common.j,l=s.Fa,u="none",c="mousemove",f="mouseout",h=null,p="left",d="statusBar",g="10px",m=function(){function t(t,e){if(this._marginLeft=0,this._marginRight=0,this.Vo="auto",this.Qzb=h,this.TJa=h,this.name=t,e){var o=e.align,n=e.menuContent,r=e.tipText,i=e.visible,a=e.showStatusInContexMenu,s=e.value,u=e.BAb,c=e.CAb;this.align=l(o)?p:o,this.menuContent=l(n)?h:n,this.tipText=l(r)?"":r,this.visible=!!l(i)||i,this.showStatusInContexMenu=!!l(a)||a,this.value=l(s)?h:s,this.BAb=l(u)?h:u,this.CAb=l(c)?h:c}}return t.prototype.Ezb=function(t){var e,o,n=this.align===p;this._marginLeft=n?g:0,this._marginRight=n?0:g,e=t.clientHeight,this._v=e>15?e:15,o=this.IAb(),this.Qzb=o,this.onCreateItemView(o),this.QQ(o)},t.prototype.IAb=function(){var t=this.Qzb,e=this._v&&this._v+"px";return t||((t=this.Qzb=i("div")).title=this.tipText,a(t).addClass("gc-statusbar-statusitem-container"),a(t).css({height:e,lineHeight:e,float:this.align,marginLeft:this._marginLeft+"",marginRight:this._marginRight+""}),!1===this.visible&&(t.style.display=u)),t},t.prototype.onCreateItemView=function(t){var e=this.TJa;e||((e=this.TJa=i("span")).innerText=this.value+""),t.appendChild(e)},t.prototype.onBind=function(t){},t.prototype.QQ=function(t){t.addEventListener(c,this.sAb.bind(this)),t.addEventListener(f,this.uAb.bind(this))},t.prototype.Gzb=function(){return this.Qzb},t.prototype.sAb=function(t){},t.prototype.uAb=function(t){},t.prototype.Mzb=function(){var t=this.JAb();return t.type=d,t.workArea=d,t},t.prototype.Nzb=function(t){this.visible=!t.visible,this.onUpdate()},t.prototype.JAb=function(){var t=this.showStatusInContexMenu?this.KAb():null;return function(t,e,o,n){return{name:t,menuContent:e,visible:o,status:n,command:"gc.spread."+d}}(this.name,this.menuContent,this.visible,t)},t.prototype.KAb=function(){return this.value},t.prototype.D4=function(){this.Qzb&&(this.Qzb.style.display=this.visible?"inline-block":u)},t.prototype.Av=function(t){t&&(this.menuContent=t.menuContent,this.tipText=t.tipText,this.Qzb.title=this.tipText)},t.prototype.onUpdate=function(){this.D4()},t.prototype.onUnbind=function(){},t.prototype.onDispose=function(){this.onUnbind(),this.TJa=h,this.Qzb&&(this.Qzb.removeEventListener(c,this.sAb),this.Qzb.removeEventListener(f,this.uAb),a(this.Qzb).empty(),this.Qzb=h)},t}(),e.StatusItem=m},"./dist/plugins/table/table-action.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/table/table-util.js"),a=i.Util.$Lb,s=i.Util.PIb,l=i.Util.QIb,u=i.Util._getTable,c=i.Util._Mb,f=n.Commands.ActionBase,h=r.Common.j.Fa,p="tableResize",d="tableInsertRows",g="tableDeleteRows",m="tableInsertColumns",y="tableDeleteColumns",C="tableToRange",v="tableTotalRowFormula",b="DoInsertRows",w="tableShowFooter",T="tableInsertRowsAboveForContextMenu",S="tableInsertRowsBelowForContextMenu",x="tableDeleteRowsForContextMenu",A="tableInsertColumnsLeftForContextMenu",I="tableInsertColumnsRightForContextMenu",R="tableDeleteColumnsForContextMenu",M=void 0,k=function(t){function e(e,o){var n=t.call(this,e)||this;return n._Lb=o,n.aMb=o.tableName,n.bMb=o.resizeToRange,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,s,l,u=this,c=!1;if(u.canExecute()){e=(t=u.kj).ITa,o=u.aMb,r=u._Lb,e.startTransaction(),u.Lz(t,!0);try{(i=t.tables.findByName(o))&&(s=i.range(),l=u.bMb,t.tables.resize(i,l),a(t,i,s,l),c=!0)}finally{u.Mz(t),r[n.Commands.bWa(t.name())]=e.endTransaction()}}return c},e.prototype.undo=function(){var t,e,o,r,i=this,s=i.kj,l=i.aMb,u=!1;if(i.canUndo()){i.Lz(s,!0);try{t=i._Lb,e=s.ITa,o=s.tables.findByName(l),(r=t[n.Commands.bWa(s.name())])&&(e.undo(r),a(s,o,t.resizeToRange,o.range()),e.wVa(r.uVa),u=!0)}finally{i.Mz(s,!0)}}return u},e}(f),n.Commands[p]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,k,e,o)}},N=function(t){function e(e,o){var n=t.call(this,e)||this;return n.cMb=o,n.aMb=o.tableName,n.cj=o.row,n.Jb=o.count,n.dMb=o.isAfter,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a,l,u,c,f=this,h=!1;if(f.canExecute()){e=(t=f.kj).ITa,o=f.aMb,r=f.cj,i=f.Jb,a=f.dMb,e.startTransaction(),f.Lz(t,!0);try{(l=t.tables.findByName(o))&&(u=l.Xj,l.Nia(r,i,a),h=!0,l.Xj-u===i&&s(t,l,d,r,i,a))}finally{f.Mz(t),c=n.Commands.bWa(t.name()),f.cMb[c]=e.endTransaction()}}return h},e.prototype.undo=function(){var t,e,o,r,i,a,l,u,f=this,h=f.kj,p=!1;if(f.canUndo()){f.Lz(h,!0);try{t=f.cMb,e=h.ITa,o=t[n.Commands.bWa(h.name())],r=t.row,i=t.count,a=t.isAfter,o&&(e.undo(o),e.wVa(o.uVa),(l=h.tables.findByName(f.aMb))&&(u=a?r+1:r,l.ihc(u,i),l.NAb(),l.WNb(u,i,c(!0)),s(h,l,g,r,i,M,l.nKb())),p=!0)}finally{f.Mz(h,!0)}}return p},e}(f),n.Commands[d]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,N,e,o)}},O=function(t){function e(e,o){var n=t.call(this,e)||this;return n.cMb=o,n.aMb=o.tableName,n.cj=o.row,n.Jb=o.count,n.dMb=o.isAfter,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a,l,u,c=this,f=!1;if(c.canExecute()){e=(t=c.kj).ITa,o=c.aMb,r=c.cj,i=c.Jb,a=c.dMb,e.startTransaction(),c.Lz(t,!0);try{(l=t.tables.findByName(o))&&(l.eMb(r,i,a,!1),s(t,l,d,r,i,a),c.cMb.row=r,c.cMb.count=i,f=!0)}finally{c.Mz(t),u=n.Commands.bWa(t.name()),c.cMb[u]=e.endTransaction()}}return f},e.prototype.undo=function(){var t,e,o,r,i,a,l,u,f,h,p,d=this,m=d.kj,y=!1;if(d.canUndo()){d.Lz(m,!0);try{t=d.cMb,e=m.ITa,o=t[n.Commands.bWa(m.name())],r=t.row,i=t.count,a=t.isAfter,o&&(u=(l=m.tables.findByName(d.aMb))&&l.LZ(),f=void 0,h=a?r+1:r,u&&(p=l.dataRange(),f=u.slice(h-p.row,h-p.row+i)),e.undo(o),e.wVa(o.uVa),l&&(l.ihc(h,i),l.NAb(),l.WNb(h,i,c(!0)),s(m,l,g,r,i,a,f||l.nKb())),y=!0)}finally{d.Mz(m,!0)}}return y},e}(f),n.Commands[b]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,O,e,o)}},D=function(t){function e(e,o){var n=t.call(this,e)||this;return n.fMb=o,n.aMb=o.tableName,n.kJc=o.changeRows,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a,l,u,c,f,h=this,p=!1;if(h.canExecute()){e=(t=h.kj).ITa,o=h.aMb,r=h.kJc,e.startTransaction(),h.Lz(t,!0);try{if(i=t.tables.findByName(o))for(a=r.length-1;a>=0;a--)l=r[a].row,u=r[a].count,c=i.Xj,i.STa(l,u),p=!0,c-i.Xj===u&&s(t,i,g,l,u,M,i.nKb())}finally{h.Mz(t),f=n.Commands.bWa(t.name()),h.fMb[f]=e.endTransaction()}}return p},e.prototype.undo=function(){var t,e,o,r,i,a,l,u,c=this,f=c.kj,h=!1;if(c.canUndo()){c.Lz(f,!0);try{if(t=c.fMb,e=f.ITa,o=t[n.Commands.bWa(f.name())],r=c.kJc,o)for(e.undo(o),e.wVa(o.uVa),(i=f.tables.findByName(c.aMb))&&i.NAb(),h=!0,a=r.length-1;a>=0;a--)l=r[a].row,u=r[a].count,s(f,i,d,l,u,!1)}finally{c.Mz(f,!0)}}return h},e}(f),n.Commands[g]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,D,e,o)}},F=function(t){function e(e,o){var n=t.call(this,e)||this;return n.gMb=o,n.aMb=o.tableName,n.dj=o.col,n.Jb=o.count,n.dMb=o.isAfter,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a,s,u,c,f=this,h=!1;if(f.canExecute()){e=(t=f.kj).ITa,o=f.aMb,r=f.dj,i=f.Jb,a=f.dMb,e.startTransaction(),f.Lz(t,!0);try{(s=t.tables.findByName(o))&&(u=s.OZ,s.hMb(r,i,a),h=!0,s.OZ-u===i&&l(t,s,m,r,i,a))}finally{f.Mz(t),c=n.Commands.bWa(t.name()),f.gMb[c]=e.endTransaction()}}return h},e.prototype.undo=function(){var t,e,o,r,i,a,s=this,u=s.kj,c=!1;if(s.canUndo()){s.Lz(u,!0);try{t=s.gMb,e=u.ITa,o=t[n.Commands.bWa(u.name())],r=t.col,i=t.count,o&&(e.undo(o),e.wVa(o.uVa),(a=u.tables.findByName(s.aMb))&&a.NAb(),c=!0,l(u,a,y,r,i))}finally{s.Mz(u,!0)}}return c},e}(f),n.Commands[m]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,F,e,o)}},E=function(t){function e(e,o){var n=t.call(this,e)||this;return n.iMb=o,n.aMb=o.tableName,n.dj=o.col,n.Jb=o.count,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a,s,u,c=this,f=!1;if(c.canExecute()){e=(t=c.kj).ITa,o=c.aMb,r=c.dj,i=c.Jb,e.startTransaction(),c.Lz(t,!0);try{(a=t.tables.findByName(o))&&(s=a.OZ,a.TTa(r,i),f=!0,s-a.OZ===i&&l(t,a,y,r,i))}finally{c.Mz(t),u=n.Commands.bWa(t.name()),c.iMb[u]=e.endTransaction()}}return f},e.prototype.undo=function(){var t,e,o,r,i,a,s=this,u=s.kj,c=!1;if(s.canUndo()){s.Lz(u,!0);try{t=s.iMb,e=u.ITa,o=t[n.Commands.bWa(u.name())],r=t.col,i=t.count,o&&(e.undo(o),e.wVa(o.uVa),(a=u.tables.findByName(s.aMb))&&a.NAb(),c=!0,l(u,a,m,r,i,!1))}finally{s.Mz(u,!0)}}return c},e}(f),n.Commands[y]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,E,e,o)}},j=function(t){function e(e,o){var n=t.call(this,e)||this;return n.jMb=o,n.aMb=o.tableName,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a=this,s=!1;if(a.canExecute()){e=(t=a.kj).ITa,o=a.aMb,e.startTransaction(),a.Lz(t,!0);try{(r=t.tables.findByName(o))&&(t.tables.remove(r,3),s=!0)}finally{a.Mz(t),i=n.Commands.bWa(t.name()),a.jMb[i]=e.endTransaction()}}return s},e.prototype.undo=function(){var t,e,o,r,i=this,a=i.kj,s=!1;if(i.canUndo()){i.Lz(a,!0);try{t=i.jMb,e=a.ITa,(o=t[n.Commands.bWa(a.name())])&&(e.undo(o),e.wVa(o.uVa),(r=a.tables.findByName(i.aMb))&&r.NAb(),s=!0)}finally{i.Mz(a,!0)}}return s},e}(f),n.Commands[C]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,j,e,o)}},P=function(t){function e(e,o){var n=t.call(this,e)||this,r=n;return r.kMb=o,r.cj=o.row,r.dj=o.col,r.Yw=o.newValue,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a,s=this,l=!1;if(s.canExecute()){(e=(t=s.kj).ITa).startTransaction(),s.Lz(t,!0);try{o=s.cj,r=s.dj,i=s.Yw,t.setFormula(o,r,i),i||t.setValue(o,r,null),l=!0}finally{s.Mz(t),a=n.Commands.bWa(t.name()),s.kMb[a]=e.endTransaction()}}return l},e.prototype.undo=function(){var t,e,o,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{t=r.kMb,e=i.ITa,(o=t[n.Commands.bWa(i.name())])&&(e.undo(o),e.wVa(o.uVa),a=!0)}finally{r.Mz(i,!0)}}return a},e}(f),n.Commands[v]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,P,e,o)}},L=function(t){function e(e,o){var n=t.call(this,e)||this;return n.lMb=o,n.aMb=o.tableName,n}return G(e,t),e.prototype.execute=function(){var t,e,o,r,i,a=this,s=!1;if(a.canExecute()){e=(t=a.kj).ITa,o=a.aMb,e.startTransaction(),a.Lz(t,!0);try{(r=t.tables.findByName(o))&&(r.showFooter(!0),s=!0)}finally{a.Mz(t),i=n.Commands.bWa(t.name()),a.lMb[i]=e.endTransaction()}}return s},e.prototype.undo=function(){var t,e,o,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{t=r.lMb,e=i.ITa,(o=t[n.Commands.bWa(i.name())])&&(e.undo(o),e.wVa(o.uVa),a=!0)}finally{r.Mz(i,!0)}}return a},e}(f),n.Commands[w]={canUndo:!0,execute:function(t,e,o){return n.Commands.h4(t,L,e,o)}},n.Commands[T]={canUndo:!0,execute:function(t,e,o){var r,i,a,s,l,c,f;return e.cmd=T,h(e.row)&&h(e.count)?(r=n.Commands.bT(t,e),a=void 0,s=void 0,l=void 0,c=void 0,1===(i=e.selections).length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,f=s.footerIndex()===l,e.row=f?l-1:l,e.count=c,e.tableName=s.name(),e.isAfter=f),n.Commands.h4(t,N,e,o))):n.Commands.h4(t,N,e,o)}},n.Commands[S]={canUndo:!0,execute:function(t,e,o){if(e.cmd=S,h(e.row)&&h(e.count)){var r=n.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,e.row=l,e.count=c,e.tableName=s.name(),e.isAfter=!0),n.Commands.h4(t,N,e,o))}return n.Commands.h4(t,N,e,o)}},n.Commands[x]={canUndo:!0,execute:function(t,e,o){var r,i,a,s,l,c,f,p,d,g;if(e.cmd=x,h(e.changeRows)&&h(e.changeRows)){for(r=n.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,e.changeRows=[],c=0;c<i.length;c++){if(f=i[c],!(p=u(r,f)))return!1;if(a){if(a!==p)return!1}else a=p}for(c=0;c<i.length;c++)for(d=c+1;d<i.length;d++){if(f=i[c],g=i[d],f.row>=g.row&&f.row<=g.row+g.rowCount-1)return!1;if(f.row+f.rowCount-1>=g.row&&f.row+f.rowCount-1<=g.row+g.rowCount-1)return!1;if(f.row<=a.cj||f.row+f.rowCount>a.cj+a.Xj)return!1;if(g.row<=a.cj||g.row+g.rowCount>a.cj+a.Xj)return!1}for(i.sort((function(t,e){return t.row-e.row})),c=0;c<i.length;c++)s=(f=i[c]).row,l=f.rowCount,e.changeRows.push({row:s,count:l});return e.tableName=a.name(),n.Commands.h4(t,D,e,o)}return n.Commands.h4(t,D,e,o)}},n.Commands[A]={canUndo:!0,execute:function(t,e,o){if(e.cmd=A,h(e.col)&&h(e.count)){var r=n.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,e.col=l,e.count=c,e.tableName=s.name(),e.isAfter=!1),n.Commands.h4(t,F,e,o))}return n.Commands.h4(t,F,e,o)}},n.Commands[I]={canUndo:!0,execute:function(t,e,o){if(e.cmd=I,h(e.col)&&h(e.count)){var r=n.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,e.col=l,e.count=c,e.tableName=s.name(),e.isAfter=!0),n.Commands.h4(t,F,e,o))}return n.Commands.h4(t,F,e,o)}},n.Commands[R]={canUndo:!0,execute:function(t,e,o){if(e.cmd=R,h(e.col)&&h(e.count)){var r=n.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,e.col=l,e.count=c,e.tableName=s.name()),n.Commands.h4(t,E,e,o))}return n.Commands.h4(t,E,e,o)}},n.Commands.mMb=function(t){t.register(p,n.Commands[p]),t.register(d,n.Commands[d]),t.register(b,n.Commands[b]),t.register(g,n.Commands[g]),t.register(m,n.Commands[m]),t.register(y,n.Commands[y]),t.register(C,n.Commands[C]),t.register(v,n.Commands[v]),t.register(w,n.Commands[w]),t.register(T,n.Commands[T]),t.register(S,n.Commands[S]),t.register(x,n.Commands[x]),t.register(A,n.Commands[A]),t.register(I,n.Commands[I]),t.register(R,n.Commands[R])}},"./dist/plugins/table/table-event.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("./dist/plugins/table/table.js"),a=o("./dist/plugins/table/table.ns.js"),s=o("./dist/plugins/table/table-util.js"),l=r.Common.j.Fa,u=null,c=Math.abs,f=new r.Common.ResourceManager(a.SR),h=f.getResource.bind(f),p=s.Util.nMb,d=s.Util.oMb,g=s.Util.pMb,n.GC$.extend(n.iI.prototype,{oIb:function(t,e){var o=this.qgc(t,e);o&&e.setSelection(o.row,o.col,o.rowCount,o.colCount)},qgc:function(t,e){var o,r,a,s,c,f,h,p,d=e.getSelections(),g=t.tableSelectInfo;if(!e.isEditing()||e.getActiveRowIndex()===t.row&&e.getActiveColumnIndex()===t.col||e.endEdit(),r=0,a=0,(o=g.table).NZ&&(r=1),o.MZ&&(a=1),s=u,c=g.action,f=e.Cw&&e.Cw.ahc(),!l(f)&&f.length>0&&(d=f),c===i.TableSelectionType.TABLE_ROW_SELECT)s=n.kf(t.row,o.dj,1,o.OZ);else if(c===i.TableSelectionType.TABLE_COL_SELECT){for(h=0;h<d.length;h++)if((p=d[h]).col===t.col&&p.row===o.cj+a&&1===p.colCount&&p.rowCount===o.Xj-a-r){s=n.kf(o.cj,t.col,o.Xj,1);break}l(s)&&(s=n.kf(o.cj+a,t.col,o.Xj-a-r,1))}else if(c===i.TableSelectionType.TABLE_CORNER_SELECT){for(h=0;h<d.length;h++)if((p=d[h]).col===o.dj&&p.row===o.cj+a&&p.colCount===o.OZ&&p.rowCount===o.Xj-a-r){s=n.kf(o.cj,o.dj,o.Xj,o.OZ);break}l(s)&&(s=n.kf(o.cj+a,o.dj,o.Xj-a-r,o.OZ))}else c===i.TableSelectionType.TABLE_SELECT&&(s=n.kf(o.cj,o.dj,o.Xj,o.OZ));return s},iJb:function(t,e){var o,n,r,i,a,s,l,c,f,h,g,m,y,C,v=this.kj,b=u;return v&&!v.options.isProtected&&!v.isEditing()&&e&&e.showResizeHandle()?(o=t.row,n=t.col,r=t.x,i=t.y,a=t.rowViewportIndex,s=t.colViewportIndex,l=p(v,e),c=d(v,e),o===l&&n===c&&(h=(f=v.getCellRect(o,n,a,s)).x,g=f.y,m=f.width,C=g+f.height,r>=(y=h+m)-10&&r<=y&&i>=C-10&&i<=C&&(b={x:r,y:i,table:e})),b):b},pIb:function(t){var e,o,n,r,i,a=this;!0!==a.qIb&&!0!==a.OG&&(e=a.kj,(n=(o=t.resizeTableHitInfo)&&o.table)&&!n.hJb()&&(a.qIb=!0,a.OG=!0,a.qMb=n,a.rMb=n.cj,a.sMb=n.dj,a.tMb=n.Xj,a.uMb=n.OZ,r=a.rMb+a.tMb-1,i=a.sMb+a.uMb-1,a.vMb=e.getCellRect(r,i),a.wMb=n.range(),a.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},a.qG()))},rIb:function(){var t,e=this,o=e.kj;e.rG&&e.qIb&&e.OG&&e.qMb&&(e.xMb(),e.yMb()&&(e.zMb=e.AMb(),e.BMb(),e.CMb(),(t=e.DMb)||(t=e.EMb()),t.equals(e.FMb)||(e.DMb=n.kf(e.FMb.row,e.FMb.col,e.FMb.rowCount,e.FMb.colCount),g(o,e.qMb,e.EMb(),e.FMb))),e.NG())},wIb:function(){var t,e=this,o=e.kj;return e.RG(),e.qIb&&e.OG&&e.FMb&&e.qMb?(e.qIb=!1,e.OG=!1,void(e.HMb()?(t=e.EMb(),e.IMb(),t.equals(e.FMb)?o.yl.JMb():o.wu().execute({cmd:"tableResize",sheetName:o.name(),tableName:e.qMb.name(),resizeToRange:e.FMb}),e.GMb()):(e.GMb(),o.yl.JMb()))):void e.GMb()},EMb:function(){var t=this.qMb;return n.kf(t.cj,t.dj,t.Xj,t.OZ)},xMb:function(){var t=this,e=t.fH(),o=t.gH();t.KMb=e,t.LMb=o},yMb:function(){var t=this,e=t.rMb,o=t.sMb,n=t.KMb,r=t.LMb;return n>=(t.qMb.MZ?e+1:e)&&r>=o},AMb:function(){var t=this.$F,e=this.vMb,o=e.x+e.width,n=e.y+e.height,r=t.x,i=t.y;return c(n-i)>=c(o-r)?i<n?2:3:r<o?0:1},BMb:function(){var t=this,e=t.rMb,o=t.sMb,r=t.KMb,i=t.LMb,a=t.zMb,s=t.tMb,l=t.uMb;switch(a){case 0:case 1:l=c(i-o)+1;break;case 2:case 3:s=c(r-e)+1}t.FMb?(t.FMb.rowCount=s,t.FMb.colCount=l):t.FMb=n.kf(e,o,s,l)},CMb:function(){var t=this;t.kj.yl.JMb(),t.wMb=t.MMb()},MMb:function(){var t=this.FMb,e=t.row,o=t.col,r=t.rowCount,i=t.colCount;return n.kf(e,o,r,i)},IMb:function(){var t=this,e=t.qMb;2===t.zMb&&e.NZ&&(t.FMb.rowCount+=1)},HMb:function(){var t=this,e=t.kj,o=!1,n=e.ITa,r=e.tables,i=t.qMb,a=t.FMb,s=a.row,l=a.col,u=a.rowCount,c=a.colCount,f=t.KMb,g=t.LMb,m=p(e,i),y=d(e,i),C=t.zMb,v=i.xr;return m&&y?(n.MTa(s,l,u,c)||n.qu(s,l,u,c)?e.Os(6,h().Exp_TableResizeToSpan):v&&v.isFiltered()?2===C?e.Os(6,h().Exp_TableResizeWithHidden):3===C&&i.NZ?e.Os(6,h().Exp_TableResizeWithFilter):o=!0:2===C&&t.NMb(m,f)||0===C&&t.OMb(y,g)?e.Os(6,h().Exp_TableResizeWithHidden):1===C&&(r.rn(s,y+1,u,g-y)||r.HZ(s,y+1,u,g-y))||3===C&&(r.rn(m+1,l,f-m,c)||r.HZ(m+1,l,f-m,c))?e.Os(6,h().Exp_TableResizeToTable):o=!0,o):o},NMb:function(t,e){var o,n=this.kj,r=!1;for(o=t;o>e;o--)if(n.getRowHeight(o)<=0){r=!0;break}return r},OMb:function(t,e){var o,n=this.kj,r=!1;if(!r)for(o=t;o>e;o--)if(n.getColumnWidth(o)<=0){r=!0;break}return r},GMb:function(){var t=this;t.qIb=!1,t.OG=!1,t.rG=u,t.FMb=u,t.DMb=u}})},"./dist/plugins/table/table-render.js":function(t,e,o){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),(0,(n=o("Core")).GC$.extend)(n.oJ.prototype,{JMb:function(){this.kj.Xq>0||this.im()}}),n.Worksheet.$n("tableRender",{paintAdornment:function(t){var e=t.ctx,o=this.mm;o&&o.rG&&o.qIb&&function(t,e,o,n){var r=t.mm,i=r.FMb,a=t.getRangeRect(o,n,i);e.strokeStyle=t.getSelectionBorderColor(),e.strokeRect(a.x,a.y,a.width,a.height)}(this,e,o.iH(),o.jH())}})},"./dist/plugins/table/table-theme.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B;function _(t,e){return isNaN(e)?e:new n.LineBorder(t,e)}function V(t,e,o,n,r,i,a,s,l,u){var c=new E;return e&&(c.backColor=e),o&&(c.foreColor=o),n&&(c.font=I),r&&(c.borderLeft=_(t,r)),i&&(c.borderTop=_(t,i)),a&&(c.borderRight=_(t,a)),s&&(c.borderBottom=_(t,s)),l&&(c.borderHorizontal=_(t,l)),u&&(c.borderVertical=_(t,u)),c}function H(t){return 0===t?"Text 1":"Accent "+t}function z(t){var e,o=t-1,n=h,r=c(o/7);return r>=0&&r<3&&(e="Light"+t,(n=[U,W,q][r](o%7)).name&&n.name(e),n.builtInName&&n.builtInName(e)),n}function U(t){var e=H(t),o=e+" 80",n=new j;return n[p](V(e,0,e,1,0,0,0,1)),n[g](V(e,0,e,0,0,1,0,1)),n[C](V(e,o)),n[y](V(e,0,e,1)),n[m](V(e,0,e,1)),n[b](V(e,o)),n[d](V(e,0,e,1,0,1)),n}function W(t){var e=H(t),o=new j;return o[p](V(e,e,P,1)),o[g](V(e,0,0,0,1,1,1,1)),o[C](V(e,0,0,0,0,1)),o[v](V(e,0,0,0,0,1)),o[b](V(e,0,0,0,1)),o[w](V(e,0,0,0,1)),o[y](V(e,0,0,1)),o[m](V(e,0,0,1)),o[d](V(e,0,0,1,0,6)),o}function q(t){var e=H(t),o=e+" 80",n=new j;return n[p](V(e,0,0,1,0,0,0,2)),n[g](V(e,0,0,0,1,1,1,1,1,1)),n[C](V(e,o)),n[b](V(e,o)),n[y](V(e,0,0,1)),n[m](V(e,0,0,1)),n[d](V(e,0,0,1,0,6)),n}function J(t){var e,o=t-1,n=h,r=c(o/7);return r>=0&&r<4&&(e="Medium"+t,(n=[X,Z,Y,K][r](o%7)).name(e),n.builtInName(e)),n}function X(t){var e=H(t),o=e+" 20",n=e,r=e+" 80",i=new j;return i[p](V(o,n,P,1)),i[g](V(o,0,0,0,1,1,1,1,1)),i[C](V(o,r)),i[b](V(o,r)),i[y](V(o,0,0,1)),i[m](V(o,0,0,1)),i[d](V(o,0,L,1,0,6)),i}function Z(t){var e=H(t),o=P,n=e,r=e+" 60",i=e+" 80",a=new j;return a[p](V(o,n,P,1,0,0,0,2,0,1)),a[g](V(o,i,0,0,0,0,0,0,1,1)),a[C](V(o,r)),a[b](V(o,r)),a[y](V(o,n,P,1)),a[m](V(o,n,P,1)),a[d](V(o,n,P,1,0,2,0,0,0,1)),a}function Y(t){var e="#D3D3D3",o=H(t),r=e,i=0===t?L:e,a=new j;return a[p](V(L,o,P,1,0,2,0,2)),a[g](V(i,0,0,0,1,new n.LineBorder(L,2),1,new n.LineBorder(L,2),0===t?1:0,1)),a[C](V(i,r)),a[b](V(i,r)),a[y](V(i,o,P)),a[m](V(i,o,P)),a[T](V(i,o,P,1)),a[S](V(i,o,P,1)),a[d](V(L,0,L,0,0,6)),a}function K(t){var e=H(t),o=e,r=e+" 40",i=e+" 80",a=e+" 60",s=e+" 80",l=new j;return l[p](V(r,i,L,1,1,1,1,1,0,1)),l[g](V(r,i,0,0,1,1,1,1,1,1)),l[C](V(r,a)),l[b](V(r,a)),l[y](V(r,0,0,1)),l[m](V(r,0,0,1)),l[d](V(r,s,L,1,1,new n.LineBorder(o,2),1,1,0,1)),l}function Q(t){var e,o=t-1,n=h,r=c(o/7);return r>=0&&r<2&&(e="Dark"+t,(n=[$,tt][r](o%7)).name(e),n.builtInName(e)),n}function $(t){var e=H(t),o=L,n=0===t?e+" 25":e+" -25",r=0===t?e+" 50":e,i=0===t?e:e+" -50",a=new j;return a[p](V(P,o,P,1,0,0,0,2)),a[g](V(e,r,P)),a[C](V(e,n)),a[b](V(e,n)),a[y](V(P,n,P,1,0,0,2)),a[m](V(P,n,P,1,2)),a[d](V(P,i,P,1,0,2)),a}function tt(t){var e,o,n,r,i,a;function s(t,e){if(t<0||t>3)return"";return{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[e][t]}return e=H(t),o=s(t,"headerColor"),n=s(t,"stripColor"),i=r=s(t,"tableBackground"),(a=new j)[p](V(e,o,P)),a[g](V(e,r)),a[C](V(e,n)),a[b](V(e,n)),a[y](V(e,0,0,1)),a[m](V(e,0,0,1)),a[d](V(L,i,0,1,0,6)),a}for(Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=n.GC$.each,i=n.GC$.isEmptyObject,a=n.Ul.Ol,s=JSON.stringify,l=JSON.parse,u=n.Ul.Pl,c=Math.floor,f=void 0,h=null,"firstHeaderCellStyle","lastHeaderCellStyle",x=[p="headerRowStyle",d="footerRowStyle",g="wholeTableStyle",m="highlightLastColumnStyle",y="highlightFirstColumnStyle",C="firstRowStripStyle",v="secondRowStripStyle",b="firstColumnStripStyle",w="secondColumnStripStyle","firstHeaderCellStyle","lastHeaderCellStyle",T="firstFooterCellStyle",S="lastFooterCellStyle"],"firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize",A=["firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize"],"name",I="bold 11pt calibri",F=["backColor","foreColor","font",R="borderLeft",M="borderTop",k="borderRight",N="borderBottom",O="borderHorizontal",D="borderVertical","textDecoration"],E=function(){function t(t,e,o,n,i,a,s,l,u,c){var f=this,h=arguments;r(F,(function(t,e){f[e]=h[t]}))}return t.prototype.Yo=function(t,e,o,n,i){var s=this;o&&a(s[R])&&!a(t[R])&&(t[R]=s[R],t[R].level=20),e&&a(s[M])&&!a(t[M])&&(t[M]=s[M],t[M].level=20),i&&a(s[k])&&!a(t[k])&&(t[k]=s[k],t[k].level=20),n&&a(s[N])&&!a(t[N])&&(t[N]=s[N],t[N].level=20),e||!a(s[O])||a(t[M])||(t[M]=s[O],t[M].level=20),n||!a(s[O])||a(t[N])||(t[N]=s[O],t[N].level=20),o||!a(s[D])||a(t[R])||(t[R]=s[D],t[R].level=20),i||!a(s[D])||a(t[k])||(t[k]=s[D],t[k].level=20),r(F,(function(e,o){o.indexOf("border")>=0||a(s[o])&&!a(t[o])&&(t[o]=s[o])}))},t.prototype.Uo=function(){var e=new t,o=s(this.toJSON());return e.fromJSON(l(o)),e},t.prototype.toJSON=function(){var t=this,e={};return r(F,(function(o,n){var r=t[n],a=r&&r.toJSON?r.toJSON():r;e[n]=i(a)?f:a})),e},t.prototype.fromJSON=function(t,e){if(t){var o=this;r(F,(function(r,i){var s,l=t[i];a(l)&&(i.indexOf("border")>=0?((s=new n.LineBorder).fromJSON(l,e),o[i]=s):o[i]=l)}))}},t}(),e.TableStyle=E,j=function(){function t(){}return t.prototype.toJSON=function(){var t,e,o=this,n=o.builtInName();return n?{buildInName:n}:(t={name:o.name()},r(x,(function(n,r){(e=o[r]())&&(t[r]=e.toJSON())})),r(A,(function(n,r){1!==(e=o[r]())&&(t[r]=e)})),i(t)?f:t)},t.prototype.fromJSON=function(t,e){var o,n,i,s;if(t){if(o=this,n=t.buildInName)return void function(t,e){t.name(e.name()),r(A,(function(o,n){t[n](e[n]())})),r(x,(function(o,n){var r=e[n]();t[n](r?r.Uo():h)})),t.builtInName(e.builtInName(),!1)}(o,G[n.toLowerCase()]);i=t.name,s=a(i)?i:t.Cj,a(s)&&o.name(s,!1),r(A,(function(e,n){var r=t[n]!==f?t[n]:t["_"+n];r&&o[n](r,!1)})),r(x,(function(n,r){var i,a=t[r]!==f?t[r]:t["_"+r];a&&((i=new E).fromJSON(a,e),o[r](i,!1))}))}},t}(),e.TableTheme=j,j.prototype.name=u("name"),j.prototype.builtInName=u("builtInName"),r(x,(function(t,e){j.prototype[e]=u(e)})),r(A,(function(t,e){j.prototype[e]=u(e,1)})),P="white",L="black",G=function(){},e.TableThemes=G,B=1;B<=28;B++)B<=21&&(G["light"+B]=z(B)),B<=11&&(G["dark"+B]=Q(B)),G["medium"+B]=J(B)},"./dist/plugins/table/table-util.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g;function m(t){throw Error(t)}function y(t){t.suspendPaint()}function C(t){t.resumePaint()}function v(t){i&&t.suspendCalcService()}function b(t,e){i&&t.resumeCalcService(e)}function w(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||t.length>=255)}function T(t,e,o,n,r){return r=r===c||r,t.Wu.unparse(t.yj(),e,o,n,!1,r)}function S(t,e,o){var n=t.getValue(e,o);return!(n===u||!l(n))||!!(t.getSparkline&&t.getSparkline(e,o))||x(t.Iq(e,o))}function x(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.diagonalDown||t.diagonalUp))}function A(t,e,o,n,r,i,a,s){return t>=r&&!(e===a&&e+n-1===s)&&(e<a&&e+n>=a||e>=a&&e<=s&&e+n-1>s)}function I(t,e,o,n,r,i,a,s){return e>=a&&!(t===r&&t+o-1===i)&&(t<r&&t+o>=r||t>=r&&t<=i&&t+o-1>i)}function R(t){var e,o,n,r,i=t.ITa,a=i.XTa(3).dataTable,s=i.getLastNonNullRow(3,!0),l=t.getRowCount(),u=t.getColumnCount();for(n=l-1;n>-1;n--)if(e=a[n])for(r=0;r<u;r++)if((o=e[r])&&!h(o.value))return f(n,s);return f(-1,s)}function M(t){var e,o,n,r,i=t.ITa,a=i.XTa(3).dataTable,s=i.getLastNonNullCol(3,!0),l=t.getRowCount();for(n=t.getColumnCount()-1;n>-1;n--)for(r=0;r<l;r++)if((o=(e=a[r])&&e[n])&&!h(o.value))return f(n,s);return f(-1,s)}function k(t,e){var o=t.cj;return e-(t.MZ?o+1:o)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("SheetsCalc"),i=o("@grapecity/js-calc"),a=o("Common"),s=o("./dist/plugins/table/table.ns.js"),l=n.Ul.Ol,u=null,c=void 0,f=Math.max,h=a.Common.j.Fa,p=0,d=new a.Common.ResourceManager(s.SR),g=d.getResource.bind(d),e.Util={throwError:m,setFormulaToSheet:function(t,e,o,n,r){!n&&r&&(n=T(t,r,e,o)),i&&t._u(e,o,n,r)},setValue:function(t,e,o,n){t.setValue(e,o,n)},suspendPaint:y,resumePaint:C,ih:function(t){return t.Cf().ih()},suspendCalcService:v,resumeCalcService:b,RMb:function(t){t&&(y(t),t.suspendEvent(),v(t))},SMb:function(t){t&&(b(t),t.resumeEvent(),C(t))},getRowCount:function(t){return t.rowCount},getColCount:function(t){return t.colCount},isValidTableName:w,formulaToExpression:function(t,e,o,n,r){var i,a=t.yj();return a.DLb=r,i=t.Wu.parse(a,e,o,n,!1,!1,!1),delete a.DLb,i},expressionToFormula:T,checkTableName:function(t){var e,o,n,r;return!(!t||(w(t)||m(g().Exp_TableNameInvalid),e=this,o=e.name(),n=e.tc,t===o||n&&(r=n.findByName(t),r&&e!==r)))},TMb:function(t,e,o){return{col:e,leadingCellRow:o,row:t}},nMb:function(t,e,o){var n=u,r=e.cj,i=e.endRow();for(o&&(i-=e.NZ?1:0);i>=r&&t.getRowHeight(i)<=0;)i--;return i>=r&&(n=i),n},oMb:function(t,e){for(var o=u,n=e.dj,r=e.endColumn();r>=n&&t.getColumnWidth(r)<=0;)r--;return r>=n&&(o=r),o},UMb:function(t,e){var o,r,i,a=e.tc,s=e.cj+e.Xj-1,l=e.dj,u=l+e.OZ-1,c=R(t),h=a?a.PMb():-1;return o=s,(c=f(c,h))>s&&(r=s+1,i=new n.Range(r,l,c-s,u-l+1),o=f(function(t,e,o,n,r){var i,a,s;for(i=o;i>=e;i--)for(a=n;a<=r;a++){if(x(t.Iq(i,a)))return i;if(S(t,i,a))return i;if(s=t.ITa.findSpan(i,a))return s.row+s.rowCount-1}return-1}(t,r,c,l,u),a.PMb(i))),o},VMb:function(t,e){var o,r,i,a=e.tc,s=e.cj,l=s+e.Xj-1,u=e.dj+e.OZ-1,c=M(t),h=a?a.QMb():-1;return o=u,(c=f(c,h))>u&&(r=u+1,i=new n.Range(s,r,l-s+1,c-u),o=f(function(t,e,o,n,r){var i,a,s;for(a=r;a>=n;a--)for(i=e;i<=o;i++){if(x(t.Iq(i,a)))return a;if(S(t,i,a))return a;if(s=t.ITa.findSpan(i,a))return s.col+s.colCount-1}return-1}(t,s,l,r,c),a.QMb(i))),o},WMb:function(t,e,o,n,r,i,a,s,l,u){var c,f,h=t.getRowCount()-1,p=t.getColumnCount()-1,d=t.ITa.getSpans(),y=e.tc&&e.tc.l$;return!s&&(!l&&h-n<a||l&&p-i<a)?(u||m(g().Exp_TableAddRowNoEnoughRoom),!0):(c=l?I:A,f=d.some((function(t){var e=t.row,a=t.col,s=t.rowCount,l=t.colCount;return c(e,a,s,l,o,n,r,i)})),f?u||m(g().Exp_TableAddRowIntersectSpan):y&&(f=y.some((function(t){var e=t.cj,a=t.dj,s=t.Xj,l=t.OZ;return c(e,a,s,l,o,n,r,i)})),f&&!u&&m(g().Exp_TableAddRowIntersectTable)),f)},XMb:function(t,e,o){var r,i,a,s=e.row,l=e.col,u=s+e.rowCount,f=l+e.colCount;for(r=s;r<u;r++)for(i=l;i<f;i++)if((a=t.getCell(r,i)).value()||t.ITa.findSpan(r,i)){if(o&&o.equals(new n.Range(a.row,a.col,1,1)))continue;return new n.Range(r,i,1,1)}return c},YMb:function(t,e){return{action:e,table:t}},ZMb:k,$Mb:function(t,e){return e-t.dj},_Mb:function(t){var e=p;return t&&p++,e},aNb:function(t){return"string"==typeof t},pMb:function(t,e,o,r){var i={sheet:t,table:e,oldRange:o,newRange:r};t.Wq(n.Events.TableResizing,i)},$Lb:function(t,e,o,r){var i={sheet:t,table:e,oldRange:o,newRange:r};t.Wq(n.Events.TableResized,i)},PIb:function(t,e,o,r,i,a,s){var l={sheet:t,table:e,propertyName:o,row:k(e,r),count:i};h(a)||(l.isAfter=a),s&&(l.deletedItem=s),t.Wq(n.Events.TableRowsChanged,l)},QIb:function(t,e,o,r,i,a){var s={sheet:t,table:e,propertyName:o,col:r-e.dj,count:i};h(a)||(s.isAfter=a),t.Wq(n.Events.TableColumnsChanged,s)},bNb:function(t,e,o){var n=0;if(t.VZ(e,o))for(n=2;t.VZ(e+n,n);)n++;return n>0&&(e+=n),e},bW:function(t){return t&&"="===t[0]},cNb:function(t){var e,o,n=-1;if(t)for(e=t.arguments,void 0,o=0;o<e.length;o++)if(e[o]instanceof r.xzb){n=o;break}return n},dNb:function(t,e,o){var n=t.dataRange(),r=n.row,i=n.col;return(o?r:i)+e},eNb:function(t){var e=t;return t&&"="===t[0]&&(e=t.slice(1)),e},fNb:function(t,e){var o,n;for(n=0;n<t.length;n++)if((o=t[n])&&e===o.col)return o;return u},_getTable:function(t,e){var o,n,r;if(!e)return null;for(o=e.row;o<e.row+e.rowCount;o++)for(n=e.col;n<e.col+e.colCount;n++)if(t.tables&&(r=t.tables.find(o,n)))return r;return null},Pda:function(t,e){return e?t.tables.s$(e.row,e.col,e.rowCount,e.colCount):null},jhc:function(t){return h(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t},gNb:function(t){return t===c}}},"./dist/plugins/table/table.entry.js":function(t,e,o){"use strict";function n(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/plugins/table/table.interface.js"),o("./dist/plugins/table/table-event.js"),o("./dist/plugins/table/table-render.js"),o("./dist/plugins/table/table-action.js"),o("./dist/plugins/table/table-util.js"),n(o("./dist/plugins/table/table-theme.js")),n(o("./dist/plugins/table/table.js")),n(o("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt,Yt,Kt,Qt,$t,te=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),ee=this&&this.__assign||function(){return ee=Object.assign||function(t){var e,o,n,r;for(o=1,n=arguments.length;o<n;o++)for(r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ee.apply(this,arguments)};function oe(t,e){var o,n,r=!1;if(C(t[e]))r=!0;else for(o=t.length-1;o>e;o--){if(C(t[n=o-1])){r=!0;break}t[o]=t[n]}return r}function ne(t,e){var o={position:n.ButtonPosition.right,imageType:n.ButtonImageType.dropdown,visibility:n.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},r={items:[{text:Jt().Table_None,value:null},{text:Jt().Table_Average,value:"=SUBTOTAL(101,["+e+"])"},{text:Jt().Table_Count,value:"=SUBTOTAL(103,["+e+"])"},{text:Jt().Table_Count_Numbers,value:"=SUBTOTAL(102,["+e+"])"},{text:Jt().Table_Max,value:"=SUBTOTAL(104,["+e+"])"},{text:Jt().Table_Min,value:"=SUBTOTAL(105,["+e+"])"},{text:Jt().Table_Sum,value:"=SUBTOTAL(109,["+e+"])"},{text:Jt().Table_StdDev,value:"=SUBTOTAL(107,["+e+"])"},{text:Jt().Table_Var,value:"=SUBTOTAL(110,["+e+"])"}]},i=new n.Style;return i.cellButtons=[o],i.dropDowns=[{type:n.DropDownType.list,option:r,submitCommand:"tableTotalRowFormula"}],i}function re(t){return function(e,o){var n=this.kj;n&&e!==o&&(Yt.ao(n,"tableNameChanged",{oldName:o,newName:e}),n.ITa.pVa(this,t,o))}}function ie(t,e,o,n,r){var i,a,s=0===r,l=s?t.Ts:t.nNb,u=-1;for(a=0;a<l.length;a++)if((i=l[a])&&i.key===n){u=a;break}u>-1&&l.splice(u,C(o)?1:o),s&&t.phc()}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("SheetsCalc"),i=o("Common"),a=o("@grapecity/js-calc"),s=o("Filters"),l=o("Bindings"),u=o("./dist/plugins/table/table.ns.js"),c=o("./dist/plugins/table/table-theme.js"),f=o("./dist/plugins/table/table-util.js"),h=n.Ul.Pl,p=n.Ul.Ol,d=n.Ul.bc,g=n.GC$.inArray,m=n.GC$.each,y=n.GC$.isEmptyObject,C=i.Common.j.Fa,v=i.Common.l,b=i.Common.k.Bb,i.Common.k.ac,w=i.Common.D,T=f.Util.throwError,S=f.Util.setFormulaToSheet,x=f.Util.setValue,A=f.Util.suspendPaint,I=f.Util.resumePaint,R=f.Util.ih,M=f.Util.suspendCalcService,k=f.Util.resumeCalcService,N=f.Util.getRowCount,O=f.Util.getColCount,D=f.Util.checkTableName,F=f.Util.isValidTableName,E=f.Util.formulaToExpression,j=f.Util.expressionToFormula,P=f.Util.TMb,L=f.Util.nMb,G=f.Util.oMb,B=f.Util.UMb,_=f.Util.VMb,V=f.Util.WMb,H=f.Util.XMb,z=f.Util.YMb,U=f.Util.ZMb,W=f.Util.$Mb,q=f.Util._Mb,J=f.Util.aNb,X=f.Util.RMb,Z=f.Util.SMb,Y=f.Util.PIb,K=f.Util.QIb,Q=f.Util.bNb,$=f.Util.bW,tt=f.Util.cNb,et=f.Util.dNb,ot=f.Util.eNb,nt=f.Util.fNb,rt=f.Util.Pda,it=f.Util.jhc,at=f.Util.gNb,st=null,lt=void 0,ut=Math.min,ct=Math.ceil,ft=Math.max,ht=JSON.stringify,pt=JSON.parse,Ct="highlightFirstColumn",vt="highlightLastColumn",bt="bandRows",wt="bandColumns",Tt="autoGenerateColumns",St=".table",xt="Column",kt="footerRowStyles",Nt=["id",dt="name",gt="cellType",mt="value",yt="formatter",At="dataField",It="footerFormula",Rt="dataAreaFormula",Mt="footerValue"],Ot="table",Dt="tableInsertRows",Ft="tableDeleteRows",Et="tableInsertColumns",jt="tableDeleteColumns",Pt="collection",Lt="tableColumn",Gt="property",Bt="dataSource",_t="rowsChange",Vt="range",Ht="columns",zt="tableExpression",Ut="sheetExpression",Wt="string",qt=new i.Common.ResourceManager(u.SR,"Tables"),Jt=qt.getResource.bind(qt),function(t){t.TABLE_ROW_SELECT="tableRowSelect",t.TABLE_COL_SELECT="tableColSelect",t.TABLE_CORNER_SELECT="tableCornerSelect",t.TABLE_SELECT="tableSelect"}(Xt=e.TableSelectionType||(e.TableSelectionType={})),function(t){t[t.deleted=0]="deleted",t[t.dirty=1]="dirty"}(Zt||(Zt={})),n.Worksheet.$n(Ot,{priority:2e3,init:function(){var t=this;t.tables=t.ITa.noa,t.unbind(St),t.bind(n.Events.BeforeDragDrop+St,(function(e,o){var n,r=t,i=t.tables,a=Jt().Exp_DragDropChangePartOfTable,s=o.fromRow,l=o.fromColumn,u=N(o),c=o.columnCount,f=r.mm.gA,h=f.row,p=f.col,d=o.isDragInsert,g=o.isDragCopy,m=st;!d||-1!==s&&-1!==l||(l>=0?(t.isDragCopy&&(p<=l||p>=l+c)||!g&&(p<l||p>l+c))&&(n=!1,i.HZ(-1,p,-1,1)&&(n=!0,m=Jt().Exp_DragDropShiftTableCell),n||g||!i.HZ(-1,l,-1,c)||(m=a)):s>=0&&l<0&&(g&&(h<=s||h>=s+u)||!g&&(h<s||h>s+u))&&!g&&i.HZ(s,-1,u,-1)&&(m=a)),o.invalidMessage=m})),t.bind(n.Events.RowChanged+St,(function(e,o){var n=t.tables,r=n.$m,i=o.propertyName;"isVisible"===i?(!1===o.newValue?r[o.row]=0:r[o.row]=lt,n.hNb(o.row)):"height"===i&&(r[o.row]=lt,n.hNb(o.row))})),t.bind(n.Events.RowHeightChanged+St,(function(e,o){var n,r,i,a,s=t.tables,l=s.$m;for(n=0,r=o.rowList;n<r.length;n++)l[i=r[n]]=lt,a=o.sheet.getRowHeight(i),s.hNb(i,a>0)})),t.bind(n.Events.ColumnChanged+St,(function(e,o){var n=t.tables,r=n.an;"isVisible"===o.propertyName?(!1===o.newValue?r[o.col]=0:r[o.col]=lt,n.iNb(o.col)):"width"===o.propertyName&&(r[o.col]=lt,n.iNb(o.col))})),t.bind(n.Events.ColumnWidthChanged+St,(function(e,o){var n,r,i,a=t.tables,s=a.an;for(n=0,r=o.colList;n<r.length;n++)s[i=r[n]]=lt,a.iNb(i)})),t.bind(n.Events.RangeFiltered+St,(function(e,o){var n,r=t.tables,i=r.$m,a=o.sheet.xr.range;for(n=0;n<a.rowCount;n++)i[a.row+n]=lt,r.hNb(a.row+n)})),t.bind(n.Events.TableFiltered+St,(function(e,o){var n,r=t.tables,i=r.$m,a=o.table.range();for(n=0;n<a.rowCount;n++)i[a.row+n]=lt,r.hNb(a.row+n)})),t.bind(n.Events.TableFilterCleared+St,(function(e,o){t.tables.Nm()}))},resetBinding:function(t){this.tables.IZ()},initBinding:function(t){var e,o,n,r,i=this,a=i.tables;for(a.IZ(),M(i),o=0,n=(e=a.all()).length;o<n;o++)(r=e[o])&&r.JZ();k(i)},dispose:function(t){!1!==t.clearCache&&(this.unbind(St),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var t=this.tables;t&&t.Xec()},onGroupChanged:function(t){var e,o,n=this.tables;if(t.fromSetCollapsed)for(e=t.isRow?n.$m:n.an,o=t.start;o<=t.end;o++)e[o]=lt,t.isRow?n.hNb(o):n.iNb(o)},onLayoutChanged:function(t){var e,o=t.changeType,n=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=this.tables;"addRows"===o?(s.rI(n,r),s.Nm()):"addRows2"===o?s.KZ(n,r):"deleteRows"===o?(s.GR(n,r),s.Nm()):"addColumns"===o?(s.tI(i,a),s.Nm()):"deleteColumns"===o?(s.HR(i,a),s.Nm()):"addColumns2"===o||"deleteColumns2"===o?s.khc(i):"clear"===o?(e=t.sheetArea,t.ignoreTable||3!==e&&!C(e)||s.$b(n,i,r,a,t.type)):("setRowCount"===o||"setColumnCount"===o)&&s.Nm()},toJson:function(t,e){var o,n,r,i;o=this.tables,n=e&&e.ignoreStyle,r=e&&e.newWorkSheetName,n||(o&&(t.tables=o.toJSON(r)),e&&e.includeBindingSource&&((i=t.data).dataTable=i.dataTable||{},function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p,d,g=t.tables.all();for(o=0,n=g.length;o<n;o++)if(i=(r=g[o]).LZ(),s=(a=r.dataRange()).row,l=a.col,u=s+N(a)-1,c=l+O(a)-1,i)for(f=s;f<=u;f++)for(h=l;h<=c;h++)(p=r.ge(f,h)).gt&&(d=p.Qb,v.Ska(d)&&(d=v.Daa(d)),t.qI(e,f,h,d))}(this,i.dataTable)))},fromJson:function(t,e,o){var n=this.tables,r=t.tableManager,i=e?r&&r.tables:t.tables,a=o&&o.ignoreStyle;p(i)&&!a&&n&&n.fromJSON(i,e)},fromJsonAfterFormula:function(t,e,o){this.tables.all().forEach((function(t){t.formulaFromJSON()}))},lastNonNullRowAndCol:function(){var t,e,o,n,r,i,a=0,s=0,l=this.tables.all();if(l)for(t=0,e=l.length;t<e;t++)(o=l[t])&&((r=(n=o.range()).row+N(n)-1)>a&&(a=r),(i=n.col+O(n)-1)>s&&(s=i));return{lastNonNullRow:a,lastNonNullCol:s}},paintCell:function(t){var e,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v=this;t.isPrinting||t.sheetArea!==n.SheetArea.viewport||v.options.isProtected||(e=v.tables,o=t.ctx,i=(r=t.cell).row,a=r.col,(s=e.find(i,a))&&s.showResizeHandle()&&!s.hJb()&&(l=L(v,s),u=G(v,s),i===l&&a===u&&(c=r.x,f=r.y,h=r.width,p=r.height,d=v.zoom(),g=ct(4*d),m=ct(2*d),y=c+h,C=f+p,o&&h>0&&p>0&&(o.save(),o.rect(c,f,h,p),o.clip(),o.fillStyle="#485DB1",o.beginPath(),o.moveTo(y-g,C),o.lineTo(y,C),o.lineTo(y,C-m),o.lineTo(y-g,C-m),o.fill(),o.beginPath(),o.moveTo(y,C-m),o.lineTo(y-m,C-m),o.lineTo(y-m,C-g),o.lineTo(y,C-g),o.fill(),o.restore()))))},composeTableFooterList:function(t){var e=t.table,o=t.row,n=t.col,r=t.style;e.jNb(o,n,r)}}),n.Worksheet.prototype.PIb=function(t,e,o,n,r,i){var a=i?lt:t.nKb();Y(this,t,e,o,n,r,a)},n.Worksheet.prototype.QIb=function(t,e,o,n,r){K(this,t,e,o,n,r)},n.Workbook.prototype.jga=function(t){var e,o,n,r=this.sheets;if(r)for(n=0;n<r.length;n++)if((o=r[n].tables)&&(e=o.findByName(t)))return e;return st},Yt=function(){function t(t,e,o,n,r,i,a){var s,l=this;for(l.MZ=!a||a.showHeader===lt||a.showHeader,l.NZ=!(!a||a.showFooter===lt)&&a.showFooter,l.kNb=!(!a||a.useFooterDropDownList===lt)&&a.useFooterDropDownList,l.lNb=!(!a||a.showResizeHandle===lt)&&a.showResizeHandle,l.mNb=[],l.wq=st,l.xr=st,l.tc=st,l.lhc=!1,p(t)&&l.name(t),l.cj=p(e)?e:-1,l.dj=p(o)?o:-1,l.Xj=p(n)?n:-1,l.OZ=p(r)?r:-1,p(i)&&l.style(i),l.Nz=[],s=0;s<l.OZ;s++)l.Nz.push(new Qt(s+1));l.ZX=st,l.LAb={},l.Bec=[],l.Ts=[],l.nNb=[],l.mhc=[],l.oNb=[],l.pNb=[],l.qNb=!0}return t.prototype.no=function(){var t=this;t.Nz=[],t.mNb=[],t.Ts=[],t.nNb=[],t.mhc=[],t.LAb={},t.Bec=[],t.kj=st,t.tc=st,t.xr&&(t.xr.no(),t.xr=st),t.Nm()},t.prototype.Nm=function(){this.oNb=[],this.pNb=[]},t.prototype.range=function(){var t=this;return n.kf(t.cj,t.dj,t.Xj,t.OZ)},t.prototype.dataRange=function(){var t=this,e=t.MZ?t.cj+1:t.cj,o=t.MZ?t.Xj-1:t.Xj;return t.NZ&&o--,n.kf(e,t.dj,o,t.OZ)},t.prototype.headerIndex=function(){return this.MZ?this.cj:-1},t.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},t.prototype.showHeader=function(t){var e,o=this;return 0===arguments.length?o.MZ:(o.MZ!==t&&((e=o.kj)&&e.suspendPaint(),o.qVa(t),e&&e.resumePaint()),o)},t.prototype.qVa=function(t){var e,o=this,n=o.kj;n&&n.ITa.pVa(o,"showHeader",o.MZ),(o.MZ=t)?(o.cj>0&&(o.cj=o.cj-1,o.Xj+=1),o.PZ()):(e=o.cj,o.cj=o.cj+1,o.Xj-=1,o.QZ(e),o.RZ()),n&&a&&n.recalcRange(o.cj+(t?0:-1),o.dj,1,o.OZ)},t.prototype.showFooter=function(t,e){var o,n=this;if(0===arguments.length)return n.NZ;if(n.NZ!==t){(o=n.kj)&&o.suspendPaint();try{n.rVa(t,!!e&&e)}finally{o&&o.resumePaint()}}return n},t.prototype.expandBoundRows=function(t){var e=this;return 0===arguments.length?e.lhc:(e.lhc!==t&&(e.lhc=t),e)},t.prototype.rVa=function(t,e){var o,n,r,i,s,l,u,c,f,h,p,d=this,g=d.kj;if(g&&g.ITa.pVa(d,"showFooter",d.NZ),o=d.Xj,t){if((!g||d.cj+o<g.getRowCount())&&(!e||d.rNb(!0,o)))for(d.NZ=t,d.Xj+=1,r=(n=d.Nz).length,i=d.footerIndex(),s=d.dj,l=0;l<r;l++)f=s+l,(c=(u=n[l])&&u.footerFormula())&&((h=j(g,c,i,f))&&(c=E(g,h,i,f),u.footerFormula(c)));d.SZ()}else d.NZ=t,p=d.cj+o-1,d.Xj-=1,d.QZ(p),d.NAb(),d.Cec(0),e&&d.rNb(!1,o);g&&a&&g.recalcRange(d.cj+d.Xj+(t?-1:0),d.dj,1,d.OZ)},t.prototype.rNb=function(t,e){var o,r=this,i=r.kj,a=r.cj+e,s=r.dj,l=r.OZ,u=s+l-1,c=B(i,r),f=c>=a,h=H(i,new n.Range(a,s,c-a+1,u-s+1)),p=(h&&h.row)===a;return!(p&&V(i,r,a,c,s,u,1)||(p&&f&&(o=t?a+1:a-1,i.moveTo(a,s,o,s,c-a+1,l,1023)),0))},t.prototype.sNb=function(t){var e,o,n,r=this,i=r.Nz,a=i.length,s=r.dj,l=[],u=r.name();for(e=0;e<a;e++)o=s+e,n=r.getColumnName(e),l.push(ne(0,n)),t||(0===e?r.j$(o,Jt().Table_Total,!0):e===a-1&&(i[e].footerFormula()||(r.tNb(o)?r.i$(e,"=SUBTOTAL(109,"+u+"["+n+"])"):r.i$(e,"=SUBTOTAL(103,"+u+"["+n+"])"))));r.mNb=l},t.prototype.tNb=function(t){var e,o,n=this.kj,r=this.dataRange(),i=!0,a=r.rowCount,s=r.row;for(e=0;e<a;e++)if(o=n.getValue(s+e,t),!C(o)&&"number"!=typeof o){i=!1;break}return i},t.prototype.uNb=function(){return this.mNb&&this.mNb.length>0},t.prototype.vNb=function(t,e,o){var n=this,r=this.kj;n.uNb()&&(r&&r.ITa.pVa(n,kt,n.wNb()),e>=0&&(o?n.mNb.splice(t,e,o):n.mNb.splice(t,e)))},t.prototype.wNb=function(){var t=this.mNb,e=[];return t.forEach((function(t){t&&e.push(t.clone())})),e},t.prototype.xNb=function(t,e,o){var n=this,r=p(o)?ne(n.name(),o):st;n.uNb()&&n.vNb(t,e,r)},t.prototype.useFooterDropDownList=function(t){var e=this,o=e.kj;return 0===arguments.length?e.kNb:(o&&(o.suspendPaint(),e.kNb!==t&&(o.ITa.pVa(e,"useFooterDropDownList",e.kNb),e.kNb=t,e.kNb&&!e.uNb()&&(e.sNb(),e.e$())),o.resumePaint()),e)},t.prototype.showResizeHandle=function(t){var e=this,o=e.kj;return 0===arguments.length?e.lNb:(o&&(o.suspendPaint(),e.lNb!==t&&(o.ITa.pVa(e,"showResizeHandle",e.lNb),e.lNb=t),o.resumePaint()),e)},t.prototype.rowFilter=function(){var t=this;return!t.xr&&e.MAb&&(t.xr=new e.MAb(t),t.xr.EZ(t.dataRange())),t.xr},t.prototype.bindColumns=function(t){var e,o,n,r,i,a,s,l,u,c,f=this,h=[];if(t)for(e=t.length,f.autoGenerateColumns||(e=ut(f.OZ,t.length)),o=0;o<e;o++)(n=f.Nz[o])||(n=new Qt(f.TZ()),f.Nz[o]=n),i=(r=t[o]).id(),a=r.name(),s=r.dataField(),l=r.value(),u=Q(f,a,o),n.id(i),n.name(u),n.dataField(s),n.value(l),n.cellType(r.cellType()),n.formatter(r.formatter()),c={name:u,value:l,dataField:s},s&&h.push(c),f.xNb(o,1,u);f.yNb=h,f.wq&&(f.wq.qia=h)},t.prototype.bindingPath=function(t){var e=this;return 0===arguments.length?e.UZ:(e.UZ=t,e.JZ(),e)},t.prototype.bind=function(t,e,o){var n=this,r=o;return C(t)||n.bindColumns(t),C(o)&&(r=n.LZ()),e&&(n.UZ=e,r=l.LL(r,e)),l.qL&&r&&n.zNb(r),n},t.prototype.getColumnName=function(t){var e,o,n=this.Nz;return n&&0<=t&&t<n.length&&(e=n[t])?((o=e.name())!==st&&(o=d(o)),o):st},t.prototype.setColumnName=function(t,e){var o,n,r,i,a=this;return a.VZ(e)||(o=a.Nz)&&0<=t&&t<o.length&&((n=o[t])||(n=a.Nz[t]=new Qt(a.TZ())),r=n.name(),i=a.kj,r!==e&&i&&(i.ITa.sVa(n,"name",r),n.name(e)),a.MZ&&i&&i.setText(a.headerIndex(),a.dj+t,e),a.WZ(r,n.name(),t)),a},t.prototype.WZ=function(t,e,o){var n,r=this.Nz[o];this.xNb(o,1,r.name()),(n=this.ZX)&&n.onColumnNameChanged(t,e)},t.prototype.setColumnDataField=function(t,e){var o,n,r,i=this,a=i.Nz;return a&&0<=t&&t<a.length&&((o=a[t])||(o=i.Nz[t]=new Qt(i.TZ())),n=i.kj,r=o.dataField(),n&&e!==r&&n.ITa.sVa(o,"dataField",r),o.dataField(e)),i},t.prototype.getColumnDataField=function(t){var e,o,n=this.Nz;return n&&0<=t&&t<n.length&&(e=n[t])?((o=e.dataField())!==st&&(o=d(o)),o):st},t.prototype.getColumnFormula=function(t){var e,o,n,r,i=this.Nz,a=this.kj;return i&&a&&0<=t&&t<i.length&&(e=i[t])?(o=this.footerIndex(),n=this.dj+t,(r=e.footerFormula())&&j(a,r,o,n,!1)):st},t.prototype.setColumnFormula=function(t,e){return this.i$(t,e),this},t.prototype.setColumnDataFormula=function(t,e){var o,n,r,i,s,l,u,c,f,h;if(a){if((n=(o=this).Nz)&&0<=t&&t<n.length&&(r=n[t])){for(i=o.kj,M(i),s=t+o.dj,l=o.cj,u=o.Xj,o.showHeader()&&(l++,u--),o.showFooter()&&u--,c=E(i,e,l,s,!0),f=r.dataAreaFormula(),i&&c!==f&&i.ITa.sVa(r,"dataAreaFormula",f),r.ANb(e),r.dataAreaFormula(c),h=l;h<l+u;h++)S(i,h,s,e,c);k(i,!1)}return o}},t.prototype.getColumnValue=function(t){var e,o,n=this,r=n.Nz;return r&&0<=t&&t<r.length&&(e=r[t])?n.NZ&&e.footerFormula()&&(o=n.kj)?o.getValue(n.footerIndex(),n.dj+t):e.footerValue():st},t.prototype.setColumnValue=function(t,e){var o,n,r=this,i=r.Nz,a=r.kj;return i&&0<=t&&t<i.length&&((o=i[t])&&(n=o.footerValue(),a&&e!==n&&a.ITa.sVa(o,"footerValue",n),o.footerValue(e)),r.NZ&&a&&x(a,r.footerIndex(),r.dj+t,e)),r},t.prototype.filterButtonVisible=function(t,e){var o,n,r,i,a=this,s=a.kj,l=a.rowFilter();if(!(t<0||t>=a.OZ))switch(o=arguments,o.length){case 0:return l&&l.filterButtonVisible();case 1:if("number"===(r=typeof(n=o[0])))return l&&l.filterButtonVisible(n);if("boolean"===r&&l){for(A(s),i=0;i<a.OZ;i++)l.filterButtonVisible(i,n);I(s)}return a;case 2:return l&&l.filterButtonVisible(t,e),a}},t.prototype.allowAutoExpand=function(t){var e=this,o=e.kj;return 0===arguments.length?e.qNb:(e.qNb!==t&&(o.ITa.pVa(e,"allowAutoExpand",e.qNb),e.qNb=t),e)},t.prototype.Aq=function(){return!!this.ZX},t.prototype.Yv=function(t){var e=this,o=e.tc;e.BNb(t),e.kj&&e.kj.ITa&&e.kj.ITa.CNb(e,o)},t.prototype.BNb=function(t){var e,o=this;o.tc=t,o.kj=t&&t.kj,e=o.xr,t&&e&&e.kj!==t.kj&&e.table(o)},t.prototype.Fu=function(t){var e,o,n,r,i,a,s,l,u,c=this,f=c.autoGenerateColumns(),h=c.xr&&c.xr.qZ;if(c.RZ(),(e=c.kj)&&(o=c.dataRange(),f?e.cg(o.row,o.col,N(o),O(o),3,17,!1,!0):m(c.Nz,(function(t,n){n.dataField()&&e.cg(o.row,o.col+t,N(o),1,3,17,!1,!0)}))),f&&(n=c.range(),c.$b(n.row,n.col,N(n),O(n)),c.SZ(n.col,O(n),!0)),t.qia=c.yNb,c.wq=t,t)if(e&&e.ITa.pVa(c,Vt,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ}),r=t.getRowCount(),i=t.getColumnCount(),c.MZ&&r++,c.NZ&&r++,c.Xj=r,f){for(c.OZ=i,c.Nz=[],a=t.rL(),s=0;s<c.OZ;s++)l=new Qt(s+1),c.Nz[s]=l,a&&(l.name(a[s]),l.dataField(a[s]));c.kNb&&(c.mNb=[],c.JNb(c.dj))}else u=[],c.Nz.forEach((function(t){var e=t.dataField();e&&u.push(e)})),t.Nka(u);c.xr&&(c.xr.EZ(c.dataRange()),c.xr.qZ=h)},t.prototype.XZ=function(t){var e,o,n,r,i,a=this,s=a.wq;if(s&&(e=s.rL()))for(n=(o=a.Nz[t-a.startColumn()])&&o.dataField(),r=0,i=e.length;r<i;r++)if(e[r]===n)return r;return-1},t.prototype.ge=function(t,e){var o,n=!1,r=lt,i=this,a=i.wq,s=t-i.dataRange().row;return a&&s<a.getRowCount()&&((o=i.XZ(e))>=0&&(n=!0,r=a.getValue(s,o).value)),{gt:n,Qb:r}},t.prototype.yq=function(t,e,o,n){var r,i,a,s,l,u,c=this,f=c.wq,h=U(c,t),p=c.xr,d=!1;return f&&((r=c.XZ(e))>=0&&(n&&p&&p.isRowFilteredOut(t)||(i=(a=f.getValue(h,r)).value,(l=(s=c.kj)&&s.ITa)&&a.hasBinding&&i!==o&&(u=q(!0),c.DNb(t,h,u),l.ENb(c,t,st,u,Zt.dirty),l.Cp(t,e,{Ep:i})),f.setValue(h,r,o,l&&l.zTa)),d=!0)),d},t.prototype.Gq=function(t,e,o){var r=new n.Style;return this.Yo(t,e,r,o),r},t.prototype.D3=function(t){var e,o=this.tc.$m,n=o[t];return n!==lt?n:(e=this.kj,n=o[t]=e.getRowHeight(t))},t.prototype.C3=function(t){return this.kj.getColumnWidth(t)},t.prototype.Yo=function(t,e,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J=this,X=J.style();if(X){if(i=J.kj,a=J.MZ,s=J.NZ,l=J.Nz,u=J.highlightLastColumn(),c=J.highlightFirstColumn(),f=J.headerIndex(),h=J.footerIndex(),p=a?t===J.cj+1:t===J.cj,d=s?t===J.cj+J.Xj-2:t===J.cj+J.Xj-1,g=e===J.dj,m=e===J.dj+J.OZ-1,y=a?t===f:t===J.cj,C=s?t===h:t===J.cj+J.Xj-1,v=X.highlightLastColumnStyle(),b=X.highlightFirstColumnStyle(),w=new n.Style,f===t)T=X.lastHeaderCellStyle(),m&&u&&T&&T.Yo(w,!0,!0,!0,!0),S=X.firstHeaderCellStyle(),g&&c&&S&&S.Yo(w,!0,!0,!0,!0),(x=X.headerRowStyle())&&x.Yo(w,!0,g,!0,m),m&&u&&v&&v.Yo(w,!0,!0,!1,!0),g&&c&&b&&b.Yo(w,!0,!0,!1,!0);else if(h===t)A=X.lastFooterCellStyle(),m&&u&&A&&A.Yo(w,!0,!0,!0,!0),I=X.firstFooterCellStyle(),g&&c&&I&&I.Yo(w,!0,!0,!0,!0),(R=X.footerRowStyle())&&R.Yo(w,!0,g,!0,m),m&&u&&v&&v.Yo(w,!1,!0,!0,!0),g&&c&&b&&b.Yo(w,!1,!0,!0,!0);else{if(m&&u&&v&&v.Yo(w,y,!0,C,!0),g&&c&&b&&b.Yo(w,y,!0,C,!0),M=a?t-J.cj-1:t-J.cj,k=e-J.dj,N=void 0,O=void 0,D=void 0,F=void 0,E=void 0,j=void 0,P=void 0,L=!r||"cellType"!==r&&"formatter"!==r,J.bandRows()&&L&&(O=(N=X.firstRowStripSize())+X.secondRowStripSize())>0){if(void 0===(D=J.oNb[t])){if(n.mn.nn&&n.mn.sn){for(G=n.mn.sn,B=J.dataRange().row;-1===G[B];)B++;if(B>t)return;M=G[t]-G[B]}else if(i){for(_=0,B=J.dataRange().row;B<t;B++)J.D3(B)>0&&_++;M=_}D=J.oNb[t]=M%O}F=X.firstRowStripStyle(),E=X.secondRowStripStyle(),D<N&&F?(j=0===D,P=d||D===N-1,F.Yo(w,j,g,P,m)):D>=N&&E&&(j=D===N,P=d||D===O-1,E.Yo(w,j,g,P,m))}if(J.bandColumns()&&L&&(O=(N=X.firstColumnStripSize())+X.secondColumnStripSize())>0){if(void 0===(D=J.pNb[e])){if(V=0,i)for(H=J.dj;H<e;H++)J.C3(H)>0&&V++;D=J.pNb[e]=V%O}F=X.firstColumnStripStyle(),E=X.secondColumnStripStyle(),D<N&&F?(j=0===D,P=m||D===N-1,F.Yo(w,p,j,d,P)):D>=N&&E&&(j=D===N,P=m||D===O-1,E.Yo(w,p,j,d,P))}l&&l.length>0&&((z=l[k])&&(U=z.cellType(),W=z.formatter(),U&&(w.cellType=U),W&&(w.formatter=W)))}(q=X.wholeTableStyle())&&q.Yo(w,y,g,C,m),J.Oka(o,w)}},t.prototype.jNb=function(t,e,o){var n,r,i,a=this,s=a.NZ,l=a.kNb;a.footerIndex()===t&&s&&a.uNb()&&((n=a.mNb[e-a.dj])&&l&&(r=o.cellButtons,i=o.dropDowns,C(r)&&(r=[]),o.cellButtons=r.concat(n.cellButtons),C(i)&&(i=[]),o.dropDowns=i.concat(n.dropDowns)))},t.prototype.Oka=function(t,e){var o,n,r,i,a=t;C(a.backColor)&&(a.backColor=e.backColor),at(a.foreColor)&&(a.foreColor=e.foreColor),C(a.themeFont)&&C(a.font)?(a.themeFont=e.themeFont,a.font=e.font):!C(a.themeFont)&&C(a.font)&&(a.font=e.font),C(a.borderLeft)&&(o=e.borderLeft,a.borderLeft=o&&o.Uo()||o,a.borderLeft&&(a.borderLeft.level=20)),C(a.borderTop)&&(n=e.borderTop,a.borderTop=n&&n.Uo()||n,a.borderTop&&(a.borderTop.level=20)),C(a.borderRight)&&(r=e.borderRight,a.borderRight=r&&r.Uo()||r,a.borderRight&&(a.borderRight.level=20)),C(a.borderBottom)&&(i=e.borderBottom,a.borderBottom=i&&i.Uo()||i,a.borderBottom&&(a.borderBottom.level=20)),C(a.textDecoration)&&(a.textDecoration=e.textDecoration),C(a.cellType)&&(a.cellType=e.cellType),C(a.formatter)&&(a.formatter=e.formatter)},t.prototype.YZ=function(t,e){var o,n,r,i,a,s=this;if((t!==s.cj||e!==s.dj)&&(o=s.kj)){if((t<0||o.getRowCount()<t+s.Xj||e<0||o.getColumnCount()<e+s.OZ)&&T(Jt().Exp_TableMoveOutOfRange),r=void 0,i=void 0,n=s.tc)for(i=0,a=(r=n.l$).length;i<a;i++)if(r[i]===s){r.splice(i,1),s.ZZ();break}o.moveTo(s.cj,s.dj,t,e,s.Xj,s.OZ,3),r&&i<=a&&(s.$Z(t,e),r.splice(i,0,s),s._Z()),this.Cec(1)}},t.prototype.$Z=function(t,e){var o=this,n=o.kj;n&&n.ITa.pVa(o,Vt,{row:o.cj,col:o.dj,rowCount:o.Xj,colCount:o.OZ}),o.cj=t,o.dj=e,o.a$(),o.Nm()},t.prototype.ZZ=function(t,e,o){var n,r,i,s,l,u,c,f,h,p,d,g,m,y,v=this,b=v.kj;if(b&&a){for(n=v.Nz,r=v.footerIndex(),i=v.range(),l=(s=v.dataRange()).row,u=N(s),C(t)&&(t=0,e=n.length);t<e;t++)if(c=n[t],f=i.col+t,c){for(c.footerFormula()&&r>=0&&(S(b,r,f,st),x(b,r,f,st)),h=c.ANb(),p=ot(h),d=void 0,g=void 0,m=0;m<u;m++)g=l+m,d=b.getFormula(g,f),C(d)||(C(v.FNb)&&(v.FNb=[]),v.FNb.push({row:g,col:f,formula:d})),C(d)||!C(p)&&j(b,E(b,p,v.cj,f),g,f)===d||(C(v.GNb)&&(v.GNb=[]),y=nt(v.GNb,f),C(y)?((y={}).col=f,y.rowIndexes=[],y.rowIndexes.push(g),v.GNb.push(y)):y.rowIndexes.push(g));if(c.ANb(lt),c.dataAreaFormula())for(m=0;m<u;m++)S(b,g=l+m,f,st),x(b,g,f,st)}!0===o&&(v.FNb=[])}},t.prototype.HNb=function(t,e,o){var n,r,i,a,s,l,u=this,c=u.kj,f=u.FNb;if(f){for(i=0;i<f.length;i++)n=!0,(r=f[i])&&(a=r.row,s=r.col,l=r.formula,a>=t&&(!0===o&&(a+=e),!1===o&&(a<t+e?n=!1:a-=e)),n&&S(c,a,s,l));u.FNb=[]}u.Gj(t,e,!0,o)},t.prototype.INb=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,x=this,A=x.kj,I=x.FNb;if(I){for(i=0;i<I.length;i++)n=!0,(r=I[i])&&(a=r.row,s=r.col,l=r.formula,s>=t&&(!0===o&&(s+=e),!1===o&&(s<t+e?n=!1:s-=e)),n&&S(A,a,s,l));for(u=x.GNb||[],c=void 0,i=0;i<u.length;i++)(c=u[i])&&((f=c.col)>=t&&(!0===o&&(c.col+=e),!1===o&&f>=t+e&&(c.col-=e)));for(x.Gj(t,e,!1,o),p=(h=x.Nz).length,g=(d=x.dataRange()).row,m=d.col,y=d.rowCount,C=void 0,v=void 0,void 0,b=void 0,w=void 0,i=0;i<p;i++)if(w=m+i,(v=h[i])&&v.dataAreaFormula()){for(C=g,T=0;T<u.length;T++)if((c=u[T])&&c.col===w){for(;c.rowIndexes.indexOf(C)>-1&&C<g+y;)C++;break}C<g+y&&((b=A.getFormula(C,w))&&v.dataAreaFormula(E(A,b,g,w)))}x.FNb=[],x.GNb=[]}},t.prototype.Gj=function(t,e,o,n,r){var i,a,s,l,u,c,f=this,h=f.kj,p=f.Nz,d=f.footerIndex(),g=f.dataRange(),m=g.row,y=g.col,C=g.rowCount,v=g.colCount,b=h.Bj(),w=h.Wu;if(w&&b&&((i=w.ih())&&(r||(i.Dj(b,m,y,C,v),i.Gj(b.xf,t,e,o,n,!0)),f.NZ)))for(r||(i.Dj(b,d,y,1,v),i.Gj(b.xf,t,e,o,n,!1)),c=0;c<v;c++)(a=p[c])&&(u=y+c,(s=a.footerFormula())&&((l=h.getFormula(d,u))&&(h&&h.ITa.sVa(a,"footerFormula",s),a.footerFormula(E(h,l,d,u)))))},t.prototype._Z=function(){var t,e,o,n=this,r=n.kj;r&&a&&(t=n.footerIndex(),e=n.range(),o=n.dataRange(),m(n.Nz,(function(n,i){var a,s,l,u=e.col+n,c=i.footerFormula(),f=i.dataAreaFormula();if(c&&t>=0&&S(r,t,u,st,c),f)for(a=0,s=N(o);a<s;a++)l=o.row+a,S(r,l,u,st,f)})))},t.prototype.b$=function(t){var e,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,S,x,A,I,R,M,k,D,F=this,E=F.dataRange();if(!t.equals(F.range())){if(e=t.row,o=t.col,r=N(t),i=O(t),a=F.MZ,s=F.NZ,l=F.kNb,u=0,1,a&&(u+=1),s&&(u+=1),(c=F.kj)&&((r<u||i<1||e+r>c.getRowCount()||o+i>c.getColumnCount())&&T(Jt().Exp_TableResizeOutOfRange),e===F.cj&&t.intersect(F.cj,F.dj,F.Xj,F.OZ)||T(Jt().Exp_TableResizeInvalidRange),c.ITa.pVa(F,Vt,{row:F.cj,col:F.dj,rowCount:F.Xj,colCount:F.OZ}),c.ITa.pVa(F,Ht,F.Nz.slice())),f=F.Nz,h=o,p=o+i-1,d=F.dj,g=F.dj+F.OZ-1,m=F.OZ,F.dj=o,F.OZ=i,h<d){for(y=0,C=h;C<d;C++)v=new Qt(F.TZ()),f.splice(y,0,v),y++;a&&F.PZ(0,d-h),s&&F.SZ(0,d-h)}else h<=g&&(F.ZZ(d,h),f.splice(0,h-d));if(p>g){for(C=g+1;C<=p;C++)v=new Qt(F.TZ()),f.push(v);a&&F.PZ(m,p-g),s&&F.SZ(m,p-g),l&&F.JNb(m)}else p>=d&&(F.ZZ(p,g),f.splice(f.length-(g-p),g-p));r!==F.Xj&&(b=F.wq,S=(w=F.dataRange()).row,x=N(w),b?r>F.Xj?(A=S+x-1,I=r-F.Xj,c&&(R=A+I+1,(M=H(c,new n.Range(R,h,c.getRowCount()-R,p)))&&M.row<R||F.eMb(A,I,!0,!1))):c&&(k=F.Xj-r,F.STa(S+x-k,k)):(D=void 0,s&&(F.SZ(),D=F.footerIndex()),F.Xj=r,F.LNb(),s&&(F.e$(),F.QZ(D)))),F.a$(),F.f$(E,F.dataRange()),F.NAb(),F.Cec(0)}},t.prototype.f$=function(t,e){var o,n,r,i,a,s,l,u,c,f,h=this.ZX;h&&(o=t.col,n=N(t),r=O(t),i=e.col,a=N(e),s=O(e),l=t.row+n,u=o+r,f=i+s,(c=e.row+a)<l&&h.onRowsRemoved(a,l-c),c>l&&h.onRowsAdded(n,c-l),i>o&&h.onColumnsRemoved(0,i-o),f<u&&h.onColumnsRemoved(s,u-f),i<o&&h.onColumnsAdded(0,o-i),f>u&&h.onColumnsAdded(o+r-i,f-u))},t.prototype.a$=function(){var t=this.xr;t&&(t.EZ(this.dataRange()),t.reFilter())},t.prototype.RZ=function(){var t=this.xr;t&&(t.unfilter(),t.reset())},t.prototype.VZ=function(t,e){var o;for(t!==st&&(t=d(t)),o=0;o<this.OZ;o++)if(o!==e&&t===this.getColumnName(o))return!0;return!1},t.prototype.g$=function(t){var e,o,n,r=this,i=r.Nz;return r.MZ&&i?0<=(e=t-r.dj)&&e<i.length&&(o=i[e])?(n=o.name(),C(n)||(n=d(n)),n):st:st},t.prototype.h$=function(t,e){var o,n,r,i,a,s=this,l=s.Nz;s.MZ&&l&&(o=l.length,0<=(n=t-s.dj)&&n<o&&((r=l[n])&&(i=r.name(),(a=s.kj)&&e!==i&&a.ITa.sVa(r,"name",i),r.name(e),s.WZ(i,r.name(),n))))},t.prototype.i$=function(t,e,o){var n,r,i=this,s=i.Nz,l=i.footerIndex(),u=i.dj+t,c=i.kj;a&&0<=t&&t<s.length&&(n=s[t],e&&!o&&c&&(o=E(c,e,l,u),i.NZ&&S(c,l,u,e,o)),n&&(r=n.footerFormula(),c&&o!==r&&c.ITa.sVa(n,"footerFormula",r),n.footerFormula(o)))},t.prototype.j$=function(t,e,o){var n,r,i,a,s=this,l=s.Nz;(o||s.NZ)&&l&&(0<=(n=t-s.dj)&&n<l.length&&((r=l[n])&&(e!==(i=r.footerValue())&&((a=s.kj)&&(a.ITa.sVa(r,"footerValue",i),a.ITa.Cp(s.cj+s.Xj-1,t,{Ep:r.footerValue()}))),r.footerValue(e))))},t.prototype.TZ=function(){var t,e,o=this.Nz,n=o&&o.length,r=[];for(e=0;e<n;e++)(t=o[e])&&t.k$()&&r.push(t.id());if(r.sort((function(t,e){return t-e})),(n=r.length)>0){for(e=0;e<n;e++)if(r[e]!==e+1)return e+1;return n+1}return 1},t.prototype.dga=function(t,e){var o,n,r,i;if(t&&!this.VZ(t,e))return t;if(n=xt,r=0,t)n=t,r=1;else if(e>0&&(t=this.Nz[e-1].name(),i=/[0-9]+$/.exec(t))){if(o=(n=t.substr(0,i.index))+((r=parseInt(t.substr(i.index),10))+1),!this.VZ(o))return o;n=t,r=1}for(;;)if(o=n+ ++r,!this.VZ(o))return o},t.prototype.PZ=function(t,e,o){var n,r,i,s,l,u,c,f,h,p,d=this,m=d.Nz,y=d.kj;if(d.MZ&&m&&y)for(n=m.length,r=d.headerIndex(),i=d.dj,C(t)&&(t=0),C(e)&&(e=n),l=ut(n,t+e),c=t;c<l;c++)(s=m[c])&&(f=d.tc.l$,(h=g(d,f))>-1&&f.splice(h,1),u=it(y.getValue(r,i+c)),h>-1&&f.splice(h,0,d),S(y,r,i+c,st),u&&(o?(d.KNb=o,y.setText(r,i+c,s.name()),delete d.KNb):(a&&y.zq(r,i+c),(p=d.dga(u,c))===u?(y.ITa.sVa(s,"name",s.name()),s.name(u)):y.setText(r,i+c,p))))},t.prototype.JNb=function(t){var e,o,n=this.Nz;for(e=t;e<n.length;e++)o=ne(this.name(),n[e].name()),this.mNb.push(o)},t.prototype.SZ=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=this,d=p.Nz,g=p.kj;if(p.NZ&&d&&g)for(p.useFooterDropDownList()&&!p.uNb()&&p.sNb(),n=d.length,r=p.footerIndex(),i=p.dj,C(t)&&(t=0),C(e)&&(e=n),C(o)&&(o=p.nhc),s=ut(n,t+e),c=t;c<s;c++)(a=d[c])&&(u=g.getValue(r,i+c),C(u)||o?(p.KNb=o,x(g,r,i+c,a.footerValue()),delete p.KNb):(u!==(f=a.footerValue())&&g.ITa.sVa(a,"footerValue",f),a.footerValue(u)),(l=g.Ima&&g.Ima(r,i+c))&&!o?(l!==(h=a.dataAreaFormula())&&g.ITa.sVa(a,"dataAreaFormula",h),a.footerFormula(l)):p.S3||(p.KNb=o,S(g,r,i+c,st,a.footerFormula()),delete p.KNb))},t.prototype.m$=function(t,e){var o,n,r,i,a,s,l=this,u=l.Nz;if(l.MZ&&u)for(o=u.length,C(t)&&(t=0),C(e)&&(e=o),r=ut(o,t+e),i=t;i<r;i++)(n=u[i])&&(a=n.name(),(s=l.kj)&&a!==st&&s.ITa.sVa(n,"name",a),n.name(st),l.WZ(a,n.name(),i))},t.prototype.n$=function(t){var e,o,n,r,i,a,s,l,u=this,c=u.dataRange();if(c.containsRange(t)){for(e=t.row,o=t.col,n=N(t),r=O(t),i=[],a=0;a<n;a++)for(s=0;s<r;s++)u.yq(e+a,o+s,st,!0),i.push({columnName:u.getColumnName(o+s-c.col),row:e+a-c.row,data:""});(l=u.ZX)&&l.onDataChanged(i)}},t.prototype.o$=function(t,e){var o,n,r,i,a,s,l=this,u=l.Nz;if(l.NZ&&u)for(C(t)&&(t=0),C(e)&&(e=u.length),n=ut(u.length,t+e),r=t;r<n;r++)(o=u[r])&&(i=l.kj,a=o.footerFormula(),i&&st!==a&&i.ITa.sVa(o,"footerFormula",a),o.footerFormula(st),s=o.footerValue(),i&&st!==s&&i.ITa.sVa(o,"footerValue",s),o.footerValue(st))},t.prototype.e$=function(){var t,e,o,n,r,i,a,s=this,l=s.Nz;if(s.NZ&&l&&(t=s.kj))for(e=l.length,n=s.dj,i=s.footerIndex(),a=0;a<e;a++)(o=l[a])&&(x(t,i,r=n+a,o.footerValue()),S(t,i,r,st,o.footerFormula()))},t.prototype.QZ=function(t){var e,o,n,r,i=this,a=i.kj;if(a&&!(t<0||a.getRowCount()<=t))for(e=i.dj,o=i.OZ,r=0;r<o;r++)S(a,t,n=e+r,st),x(a,t,n,st)},t.prototype.rI=function(t,e,o,n,r){var i,a,s,l=this,u=!1,c=o?1:0;return t>=l.cj+l.Xj+c||((i=l.kj)&&i.ITa.pVa(l,Vt,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),l.ohc(t,e,!1),a=l.cj,s=l.cj+l.Xj-1+c,t<=a&&!r?l.cj+=e:t<=s&&(n||(u=l.c$(t,e)),l.Xj+=e)),u},t.prototype.KZ=function(t,e,o){var n,r,i,a=this,s=a.cj+a.Xj-1;!o&&t>=a.cj&&t<=s&&a.LNb(t,e),o||(a.Gj(t,e,!0,!0,!0),a.MNb()),n=a.ZX,r=a.dataRange().row,i=a.endRow(),t>=r&&t<=i&&n&&n.onRowsAdded(t-r,e),a.xr&&a.xr.rI(t,e)},t.prototype.c$=function(t,e){var o,n,r,i=this.wq;return!!i&&(r=void 0,(n=(o=this.kj)&&o.ITa.zTa)&&((r=n.uVa)||(r=[])),i.uL(U(this,t),e,r),!0)},t.prototype.LNb=function(t,e){if(a){var o=this,n=o.kj,r=o.dataRange();C(t)&&(t=r.row),C(e)&&(e=r.rowCount),M(n),m(o.Nz,(function(r,i){var a,s,l=i.dataAreaFormula();if(l)for(a=r+o.dj,s=t;s<t+e;s++)S(n,s,a,st,l)})),k(n,!1)}},t.prototype.MNb=function(){if(a){var t,e,o=this,n=o.kj,r=n.Bj(),i=o.dataRange();C(t)&&(t=i.row),C(e)&&(e=i.rowCount),M(n),m(o.Nz,(function(n,i){var a,s,l,u,c=i.NNb();if(c&&c.isArrayFormula)for(a=c.isDynamicArray,s=n+o.dj,l=t;l<t+e;l++)C(r.Qf(l,s))&&(u={row:l,col:s,rowCount:1,colCount:1,isDynamicArray:a},r.Xf(l,s,u))})),k(n,!1)}},t.prototype.tI=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g=this,m=o?1:0;if(!(t>=g.dj+g.OZ+m)){if(i=g.dj,(a=g.kj)&&(a.ITa.pVa(g,Vt,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),a.ITa.pVa(g,Ht,g.Nz.slice())),t<=g.dj&&!r)g.dj+=e;else if(t<g.dj+g.OZ+m&&(g.OZ+=e,s=g.Nz)){for(l=t-g.dj,u=0;u<e;u++)c=g.TZ(),f=l+u,(h=new Qt(c)).name(g.dga(st,f)),s.splice(f,0,h),p=g.getColumnName(f),g.xNb(f,0,p);n&&g.PZ(l,lt,!0)}g.xr&&g.xr.tI(t,e),t>=i&&((d=g.ZX)&&d.onColumnsAdded(t-i,e))}},t.prototype.khc=function(){var t,e,o,n,r=this,i=r.kj.Bj();i&&r.NZ&&(t=r.Nz,e=r.footerIndex(),o=r.dj,t.forEach((function(t,r){n=i.Kf(e,o+r),C(n)||t.footerFormula(n)})))},t.prototype.GR=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g=this,m=!1;return t>=g.cj+g.Xj||(i=(r=g.dataRange()).row,a=N(r),s=g.cj,l=g.cj+g.Xj-1,u=g.kj,c=g.wq,u&&((h=u.ITa).pVa(g,Vt,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),(f=h.zTa)&&((p=f.uVa)||(p=[]))),g.ohc(t,e,!0),t<s?t+e<=s&&(g.cj-=e):t===s?g.MZ||(g.Xj-=ut(l-t+1,e),!o&&c&&(h&&h.ENb(g,t,e,n,Zt.deleted),c.wL(U(g,t),ut(l-t+1,e),p),m=!0)):t<=l&&(g.Xj-=ut(l-t+1,e),!o&&c&&(h&&h.ENb(g,t,e,n,Zt.deleted),c.wL(U(g,t),ut(l-t+1,e),p),m=!0),t===l&&g.NZ&&(u&&u.ITa.pVa(g,"showFooter",g.NZ),g.NZ=!1)),g.xr&&g.xr.GR(t,e),t>=i&&t<i+a&&((d=g.ZX)&&d.onRowsRemoved(t-i,e))),m},t.prototype.HR=function(t,e){var o,n,r,i,a,s=this,l=s.Nz;t>=s.dj+s.OZ||((o=s.kj)&&(o.ITa.pVa(s,Vt,{row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ}),o.ITa.pVa(s,Ht,s.Nz.slice())),n=s.dj,r=s.dj,i=s.dj+s.OZ-1,t<r?t+e<=r?s.dj-=e:(s.dj=t,s.OZ-=t+e-r,l&&(l.splice(0,t+e-r),s.xNb(0,t+e-r))):(s.OZ-=ut(i-t+1,e),l&&(l.splice(t-r,ut(i-t+1,e)),s.xNb(t-r,ut(i-t+1,e)))),s.xr&&s.xr.HR(t,e),t>=n&&((a=s.ZX)&&a.onColumnsRemoved(t-n,e)))},t.prototype.$b=function(t,e,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y=this,C=o,v=r,b=y.kj;b&&(C=b.getRowCount(),v=b.getColumnCount()),i=t<0?0:t,a=e<0?0:e,s=t<0?C:o,l=e<0?v:r,u=n.kf(i,a,s,l),c=y.headerIndex(),y.MZ&&i<=c&&c<i+s&&(f=n.kf(c,y.dj,1,y.OZ),(h=u.getIntersect(f,C,v))&&y.m$(h.col-y.dj,O(h))),p=y.dataRange(),(d=u.getIntersect(p,C,v))&&y.n$(d),g=y.footerIndex(),y.NZ&&i<=g&&g<i+s&&(m=n.kf(g,y.dj,1,y.OZ),(h=u.getIntersect(m,C,v))&&y.o$(h.col-y.dj,O(h))),y.xr&&y.xr.$b(t,e,o,r)},t.prototype.toJSON=function(t){var e,o,n,r,i,a,s,l,u,c=this,f=c.style(),h=c.rowFilter(),p="columns";for(C(t)?e=c.name():(e=t,c.KXc=e),(o={name:[e,st],row:[c.cj,-1],col:[c.dj,-1],rowCount:[c.Xj,-1],colCount:[c.OZ,-1],showHeader:[c.MZ,!0],showFooter:[c.NZ,!1],useFooterDropDownList:[c.kNb,!1],showResizeHandle:[c.lNb,!1],highlightFirstColumn:[c.highlightFirstColumn(),!1],highlightLastColumn:[c.highlightLastColumn(),!1],bandRows:[c.bandRows(),!0],expandBoundRows:[c.expandBoundRows(),!1],bandColumns:[c.bandColumns(),!1],style:[f?f.toJSON():st,st],autoGenerateColumns:[c.autoGenerateColumns(),!0],bindingPath:[c.bindingPath(),lt],rowFilter:[h?h.toJSON():st,st],reservedElement:[c.ONb,st],allowAutoExpand:[c.qNb,!0]})[p]=[[]],n=0;n<c.Nz.length;n++)i=(r=c.Nz[n].toJSON())[It],a=r[Rt],i&&(r[It]=j(c.kj,i,c.footerIndex(),n+c.dj)),a&&(r[Rt]=j(c.kj,a,c.dataRange().row,n+c.dj)),o[p][0][n]=r;for(l in o[p][1]=st,s={},o)(u=o[l])[0]!==u[1]&&(s[l]=u[0]);return y(s)?lt:s},t.prototype.fromJSON=function(t,o){var n,r,i,a,s,u,f,h,d,g,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L;if(t){if(n=this,m([dt,Ct,vt,bt,wt,Tt],(function(e,o){p(t[o])&&n[o](t[o],!1)})),r=t.row,p(r)&&(n.cj=r),i=t.col,p(i)&&(n.dj=i),a=t.rowCount,p(a)&&(n.Xj=a),s=t.colCount,p(s)&&(n.OZ=s),u=t.showHeader,p(u)&&(n.MZ=u),f=t.showFooter,p(f)&&(n.NZ=f),h=t.expandBoundRows,p(h)&&(n.lhc=h),d=t.useFooterDropDownList,p(d)&&(n.kNb=d),g=t.showResizeHandle,p(g)&&(n.lNb=g),(y=t.style)&&((C=new c.TableTheme).fromJSON(y,o),n.style(C)),v=t.dataSource,b=t.dataBinding,w=t.bindingPath,o?(v&&l.qL&&(n.wq=new l.qL,n.wq.bind(v)),b&&l.qL&&(n.wq=new l.qL,n.wq.fromJSON(b))):w&&(n.UZ=w,S=(T=n.kj)&&T.getDataSource&&T.getDataSource(),l.CellBindingSource&&S instanceof l.CellBindingSource&&((x=l.LL(S.getSource(),w))&&(n.wq=new l.qL,n.wq.bind(x)))),A=t.columns){for(R=(I=A).length,M=n.Nz=[],k=void 0,N=void 0,O=0;O<R;O++)N=I[O],(k=new Qt(n.TZ())).fromJSON(N),D=k.name(),F=n.dga(D,O),M.push(k),F!==D&&n.setColumnName(O,F);n.Qdc()}n.kNb&&n.sNb(!0),(E=t.rowFilter)&&((j=e.MAb&&new e.MAb)&&(j.table(n),j.fromJSON(E,o),n.xr=j,n.xr.reFilter())),(P=t.reservedElement)&&(n.ONb=P),L=t.allowAutoExpand,p(L)&&(n.qNb=L)}},t.prototype.formulaFromJSON=function(){var t,e,o,n,r,i,a=this,s=a.kj,l=s.Bj(),u=a.Nz,c=a.footerIndex(),f=a.dataRange().row,h=a.dj;for(o=0;o<u.length;o++)e=o+h,(n=(t=u[o]).footerFormula())&&typeof n===Wt&&t.footerFormula(E(s,n,c,e)),(r=t.dataAreaFormula())&&l&&(i=l.Qf(f,e),C(i)||t.NNb({isArrayFormula:!0,isDynamicArray:i.isDynamicArray})),r&&typeof r===Wt&&t.dataAreaFormula(E(s,r,f,e))},t.prototype.Qdc=function(){var t,e,o=this.Nz,n=o.length;for(e=0;e<n;e++)(t=o[e]).id()<1&&t.id(this.TZ())},t.prototype.startRow=function(){return this.cj},t.prototype.startColumn=function(){return this.dj},t.prototype.endRow=function(){return this.cj+this.Xj-1},t.prototype.endColumn=function(){return this.dj+this.OZ-1},t.prototype.hasHeadersRow=function(){return this.MZ},t.prototype.hasTotalsRow=function(){return this.NZ},t.prototype.tableName=function(){return this.name()},t.prototype.getColumnIndexInTable=function(t){t=t.toLowerCase().replace(/\u00A0/g," ");var e=-1,o=i.Common.u.Gb(t,"\r\n","\n");return C(t)||m(this.Nz,(function(n,r){var i=(""+r.name()).toLowerCase().replace(/\u00A0/g," ");if(i===t||i===o)return e=n,!1})),e},t.prototype.source=function(){var t=this.kj;return t&&t.yj&&t.yj()},t.prototype.JZ=function(){var t,e,o,n=this,r=n.kj;r&&((t=n.bindingPath())&&(e=r.getDataSource&&r.getDataSource(),l.CellBindingSource&&e instanceof l.CellBindingSource&&(o=l.LL(e.getSource(),t),n.zNb(o))))},t.prototype.zNb=function(t){var e,o,n,r,i,s,u,c=this,f=c.kj;if(t){o=(e=c.dataRange()).row,n=N(e),(r=new l.qL).bind(t,f.ITa.zTa),i=r.getRowCount();try{A(f),c.wq=st,i>n?c.lhc?f.addRows(o+n,i-n):((s=f.wq)&&s.aLb&&(s.bLb=!0),c.PNb=!0,0===n?c.Nia(o,i):c.Nia(o+n-1,i-n,!0),delete c.PNb):i<n&&(c.lhc?f.deleteRows(o+i,n-i):(c.PNb=!0,c.STa(o+i,n-i),delete c.PNb)),c.Fu(r),(u=a&&f.Cf())&&!u.IsSuspended()&&f.recalcAll()}finally{I(f)}}},t.prototype.clone=function(){var e=new t,o=ht(this.toJSON());return e.Yv(this.tc),e.fromJSON(pt(o)),e},t.prototype.p$=function(t){var e=new l.qL;e.bind(t),this.wq=e},t.prototype.Az=function(t){if(t&&!t.bindingPath()){var e=t.wq;e&&this.p$(e.getSource())}},t.prototype.LZ=function(){var t=this.wq;return t?t.getSource():st},t.prototype.q$=function(){var t=this.wq;return t?t.getRowCount():0},t.prototype.Eec=function(t,e){var o,n=this.Bec;e?n.push(t):-1!==(o=n.indexOf(t))&&n.splice(o,1)},t.prototype.Cec=function(t){var e=this;e.Bec.forEach((function(o){o.Jec(e,t)})),2===t&&(e.Bec=[])},t.prototype.wzb=function(t,e,o){var n,r;this.OAb||((r=(n=this.LAb)[o])||(r=n[o]={}),r[[t,e].join(",")]=!0)},t.prototype.NAb=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=this,d=p.kj,g=d&&d.getCalcService&&d.getCalcService();if(p.OAb=!0,g)for(r in r=void 0,n=p.LAb)if(i=g.jh[r])for(l in a=i.dUa(),s=n[r])c=+(u=l.split(","))[0],f=+u[1],(h=i.Kf(c,f))?(p.QNb(c,f)||p.RNb(h,t,e,o,!1,c,f),i.fg(c,f,h,void 0,!1,a)):delete s[l];else delete n[r];delete p.OAb},t.prototype.SNb=function(t,e,o){var n,r,i,a,s,l,u,c,f,h=this,p=h.kj,d=p&&p.getCalcService();if(h.OAb=!0,d)for(r in r=void 0,n=h.LAb)for(a in i=d.jh[r],n[r])l=+(s=a.split(","))[0],u=+s[1],(c=i.Kf(l,u))&&t===l&&e===u&&((f=tt(c))>-1&&(c.arguments[f]=o));delete h.OAb},t.prototype.QNb=function(t,e){var o,n,r=this,i=r.footerIndex(),a=!1;return i>-1&&t===i&&(n=(o=r.dj)+r.OZ,a=e>=o&&e<n),a},t.prototype.sort=function(t,e){var o=this,n=o.kj,r=o.dataRange(),i=o.rowFilter();n&&0<=t&&t<r.colCount&&(n.suspendPaint(),n.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:t+r.col,ascending:e}]),i&&(i.zZ={index:t+r.col,ascending:e}),n.resumePaint())},t.prototype.hJb=function(){return!!this.wq},t.prototype.eMb=function(t,e,o,r,i){var a,s,l,u,c,f,h,p=this,d=p.kj,g=p.cj,m=p.dj,y=p.Xj,C=p.OZ,v=g+y-1,b=o?t+1:t,w=b+e,T=p.dataRange();X(d);try{p.eJb(!1),p.TNb(),p.rI(b,e,o,!1,!0),p.NAb(),a=n.CopyToOptions.value|n.CopyToOptions.formula|n.CopyToOptions.comment|n.CopyToOptions.outline|n.CopyToOptions.sparkline|n.CopyToOptions.span|n.CopyToOptions.style|n.CopyToOptions.tag|n.CopyToOptions.bindingPath|n.CopyToOptions.hyperlink,r&&!p.UNb&&(l=(s=v+1)+e,u=i-s+1,d.moveTo(s,m,l,m,u,C,a)),c=v-b+1,(!o||t!==v)&&c>0&&(d.dJb=!0,d.zFc=T,d.moveTo(b,m,w,m,c,C,a),delete d.zFc,delete d.dJb),f=d.ITa,h=p.dataRange(),f._Ua&&f._Ua(b,e,[h],!0),f.CVa&&f.CVa(b,e,[h]),p.VNb(),p.KZ(b,e,!0),p.LNb(),p.HNb(b,e,!0),p.MNb(),p.tc.Nm()}finally{p.eJb(!0),Z(d),p.Cec(0),d.recalcAll(!0)}},t.prototype.eJb=function(t){this.kj.eJb(t)},t.prototype.insertRows=function(t,e,o){if(!(C(t)||C(e)||e<=0)){t=et(this,t,!0),this.Nia(t,e,o)}},t.prototype.Nia=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p;C(t)||C(e)||e<=0||(r=(n=this).kj,a=(i=n.dataRange()).row,0===(s=i.rowCount)&&t===a||!(t<a||t>=a+s)||T(Jt().Exp_RowParamOutOfRange),l=n.cj,u=n.dj,c=l+n.Xj-1,f=u+n.OZ-1,p=(h=B(r,n))>c,V(r,n,c+1,h,u,f,e)||n.eMb(t,e,o,p,h))},t.prototype.deleteRows=function(t,e){if(!(C(t)||C(e)||e<=0)){t=et(this,t,!0),this.STa(t,e)}},t.prototype.STa=function(t,e){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,w,S,x,A,I;if(!(C(t)||C(e)||e<=0||(o=this,r=o.kj,i=o.dataRange(),a=i.row,s=i.rowCount,(t<a||t>=a+s)&&T(Jt().Exp_RowParamOutOfRange),l=o.cj,u=o.dj,c=o.Xj,f=o.OZ,h=l+c-1,p=u+f-1,(c<=1||t===a&&!o.MZ&&!o.NZ&&e>=s)&&T(Jt().Exp_TableDeleteCountInvalid),d=B(r,o),g=d>h,V(r,o,h+1,d,u,p,e,!0)))){X(r);try{o.eJb(!1),m=o.hJb(),y=void 0,m&&(y=q(!0),o.WNb(t,e,y)),o.TNb(),o.GR(t,e,lt,y),o.NAb(),v=ut(e,h-t+1),r.clear(t,u,v,f,3,383),b=n.CopyToOptions.value|n.CopyToOptions.formula|n.CopyToOptions.comment|n.CopyToOptions.outline|n.CopyToOptions.sparkline|n.CopyToOptions.span|n.CopyToOptions.style|n.CopyToOptions.tag|n.CopyToOptions.bindingPath|n.CopyToOptions.hyperlink,t+e<=h&&!m&&r.moveTo(t+e,u,t,u,h-e-t+1,f,b),g&&(S=(w=h+1)-v,x=d-w+1,r.moveTo(w,u,S,u,x,f,b)),A=r.ITa,I=o.dataRange(),A.aVa&&A.aVa(t,e,[I],!0),o.VNb(),o.LNb(),o.HNb(t,e,!1),o.tc.Nm()}finally{o.eJb(!0),Z(r),o.Cec(0),r.recalcAll(!0)}}},t.prototype.insertColumns=function(t,e,o){if(!(C(t)||C(e)||e<=0)){t=et(this,t,!1),this.hMb(t,e,o)}},t.prototype.hMb=function(t,e,o){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,w,S,x,A,I,R,M,k,N,O;if(!(C(t)||C(e)||e<=0||(i=this,a=i.kj,s=i.dataRange(),l=s.row,u=s.col,c=s.rowCount,f=s.colCount,(t<u||t>=u+f)&&T(Jt().Exp_ColParamOutOfRange),h=i.cj,p=i.dj,d=i.Xj,g=i.OZ,m=h+d-1,y=p+g-1,v=_(a,i),b=v>y,V(a,i,h,m,y+1,v,e,!1,!0)))){S=(w=o?t+1:t)+e,X(a);try{i.eJb(!1),i.TNb(),x=!i.hJb(),I=(A=y+1)+e,R=v-A+1,M=n.CopyToOptions.value|n.CopyToOptions.formula|n.CopyToOptions.comment|n.CopyToOptions.outline|n.CopyToOptions.sparkline|n.CopyToOptions.span|n.CopyToOptions.style|n.CopyToOptions.tag|n.CopyToOptions.bindingPath|n.CopyToOptions.hyperlink,b&&a.moveTo(h,A,h,I,d,R,M),i.tI(w,e,o,x,!0),i.XNb(w,e,!0),i.NAb(w,e,!0),o&&t===y||!x||(a.dJb=!0,k=i.NZ?1:0,a.moveTo(l,w,l,S,c+k,y-w+1,M),delete a.dJb),N=a.ITa,O=i.dataRange(),N.bVa&&N.bVa(w,e,[O],!0),N.EVa&&N.EVa(w,e,[O]),i.VNb(),i.LNb(),i.INb(w,e,!0),r.kDc(a,w,e,!0,!1),i.tc.Nm()}finally{i.eJb(!0),Z(a),i.Cec(0),a.recalcAll(!0)}}},t.prototype.deleteColumns=function(t,e){if(!(C(t)||C(e)||e<=0)){t=et(this,t,!1),this.TTa(t,e)}},t.prototype.TTa=function(t,e){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b,w,S,x,A,I;if(!(C(t)||C(e)||e<=0||(o=this,i=o.kj,a=o.dataRange(),s=a.col,l=a.colCount,(t<s||t>=s+l)&&T(Jt().Exp_ColParamOutOfRange),u=o.cj,c=o.dj,f=o.Xj,h=o.OZ,p=u+f-1,d=c+h-1,g=o.NZ?1:0,(h<=1||t===c&&e>=h)&&T(Jt().Exp_TableDeleteCountInvalid),m=_(i,o),y=m>d,V(i,o,u,p,d+1,m,e,!0,!0)))){X(i);try{o.eJb(!1),o.TNb(),o.HR(t,e),o.XNb(t,e,!1),o.NAb(t,e,!1),v=ut(e,d-t+1),i.clear(u,t,f,v,3,383),b=n.CopyToOptions.value|n.CopyToOptions.formula|n.CopyToOptions.comment|n.CopyToOptions.outline|n.CopyToOptions.sparkline|n.CopyToOptions.span|n.CopyToOptions.style|n.CopyToOptions.tag|n.CopyToOptions.bindingPath|n.CopyToOptions.hyperlink,t+e<=d&&i.moveTo(u,t+e,u,t,f-g,d-e-t+1,b),y&&(S=(w=d+1)-v,x=m-w+1,i.moveTo(u,w,u,S,f,x,b)),A=i.ITa,I=o.dataRange(),A.cVa&&A.cVa(t,e,[I],!0),o.VNb(!0),o.LNb(),o.INb(t,e,!1),r.kDc(i,t,e,!1,!1),o.tc.Nm()}finally{o.eJb(!0),Z(i),o.Cec(0),i.recalcAll(!0)}}},t.prototype.TNb=function(){var t=this,e=t.kj,o=t.tc.l$;e&&e.ITa.tVa([t]),o.splice(o.indexOf(t),1),t.ZZ()},t.prototype.VNb=function(t){var e=this;e.PNb=!0,e.nhc=t,e.tc.Cz(e),delete e.nhc,delete e.PNb},t.prototype.XNb=function(t,e,o){var n,r,i,a=this,s=a.Nz,l=s.length,u=W(a,t);for(r=u;r<l;r++)i=void 0,o?r>u+e-1&&(i=r-e):r>=u&&(i=r+e),(n=s[r].footerFormula())&&a.RNb(n,t,e,o,!0,i)},t.prototype.RNb=function(t,e,o,n,i,a,s){var l,u,c,f,h,p,d,g=this.kj;if(o>0&&t&&t.arguments)for(l=t.arguments,u=void 0,c=void 0,f=0;f<l.length;f++)(u=l[f])instanceof r.xzb&&(g&&(i?(h=a,g.ITa.YNb(this,u,h)):(p=a,d=s,g.ITa.ZNb(this,u,p,d))),u.JUa(),c=u.offsetWhenInsertRemoveColumn(e,o,n,i),l[f]=c)},t.prototype.ru=function(t){var e,o,n,r,i,a,s,l=this,u=l.wq,c=l.kj,f=l.MZ?1:0,h=l.cj+f+t,p=l.dj;if(!u||0===u.getRowCount())return st;if(e=l.OZ,o={},n=u.ru(t))for(r in n)w(n,r)&&"function"!=typeof r&&(o[r]=n[r]);for(i=0;i<e;i++)s=(a=l.Nz[i])&&a.dataField(),a&&s&&s.length>0&&C(o[s])&&(o[s]=c.getValue(h,p+i));return o},t.prototype.WNb=function(t,e,o){var n,r,i,a,s=this,l=[],u=s.wq;if(u)for(r=u.getRowCount(),i=0;i<e;i++)a=st,(n=U(s,t+i))<r&&(a=s.ru(n)),l.push({key:o,data:a});s.Ts=l},t.prototype.nKb=function(){var t=[],e=this.Ts;return e&&m(e,(function(e,o){o&&!n.GC$.isFunction(o)&&t.push(o.data)})),t},t.prototype.DNb=function(t,e,o){var n,r,i,a,s=this;s.kj.gga>0||(n=s.nNb,(r=s.wq)&&(i=st,e<r.getRowCount()&&(i=s.ru(e)),a={key:o,data:i},n[t]=a))},t.prototype.ohc=function(t,e,o){var n,r,i,a=this;if(!(a.kj.gga>0))if(n=a.nNb,o)r=n.splice(t,e),a.mhc.push({rowIndex:t,count:e,deletedDirtyItems:r});else for(i=0;i<e;i++)n.splice(t,0,st)},t.prototype.ihc=function(t,e){this.nNb.splice(t,e)},t.prototype.phc=function(){var t,e,o=this.mhc.pop(),n=o.rowIndex,r=o.count,i=o.deletedDirtyItems;for(t=0;t<r;t++)e=i[t],this.nNb[n+t]=ee({},e)},t.prototype.getDirtyRows=function(){var t,e,o,n=this,r=n.nNb,i=[];for(o=0;o<r.length;o++)t=r[o],C(t)||(e=U(n,o),i.push({row:e,originalItem:t.data,item:n.ru(e)}));return i},t.prototype.clearPendingChanges=function(){this.nNb=[]},t.prototype.footerRowDropDowns=function(t,e){var o,n,r,i,a=this.mNb[t];if(a){if(1===arguments.length)return a.dropDowns&&a.dropDowns.slice();if(o=a.dropDowns[0],e)return n=e.listOption,r=e.submitCommand,i=e.type,n&&(o.option=n),r&&(o.submitCommand=r),p(i)&&(o.type=i),this}},t.prototype.checkTableLastRow=function(t){var e=this.dataRange();return this.headerIndex()===t||e.row+e.rowCount-1!==t},t.prototype.checkTableLastCol=function(t){var e=this.dataRange();return e.col+e.colCount-1!==t},t.prototype.PIb=function(t,e,o,n,r){var i,a,s,l=this,u=l.kj;Y(u,l,o?Ft:Dt,t,e,n,r),i=u.ITa,a=o?Dt:Ft,s=!o&&lt,i&&i.ZVa(["tableRowsChanged",l,a,t,e,s,o])},t.prototype.QIb=function(t,e,o,n){var r,i,a,s=this,l=s.kj;K(l,s,o?jt:Et,t,e,n),r=l.ITa,i=o?Et:jt,a=!o&&lt,r&&r.ZVa(["tableColumnsChanged",s,i,t,e,a])},t}(),e.Table=Yt,n.Zn(Yt),Yt.prototype.name=h(dt,"",re(dt),D),Yt.prototype.bandRows=h(bt,!0,re(bt)),Yt.prototype.bandColumns=h(wt,!1,re(wt)),Yt.prototype.highlightFirstColumn=h(Ct,!1,re(Ct)),Yt.prototype.highlightLastColumn=h(vt,!1,re(vt)),Yt.prototype.style=h("style",lt,re("style")),Yt.prototype.autoGenerateColumns=h(Tt,!0,re(Tt)),s&&s.HideRowFilter&&(Kt=function(t){function e(e){var o=t.call(this)||this;return o.table(e),o}return te(e,t),e.prototype.oZ=function(){return 0},e.prototype.pZ=function(){return this.range.colCount},e.prototype.table=function(t){var e=this;return 0===arguments.length?e.sj:(e.sj=t,void(t&&(e.kj=t.kj)))},e.prototype.unfilter=function(e,o){var n,r=this.kj;r&&r.suspendPaint(),t.prototype.unfilter.call(this,e,o),(n=this.sj)&&n.tc&&n.tc.Nm(),r&&r.resumePaint()},e.prototype.rI=function(e,o){var n=this.sj;t.prototype.rI.call(this,e,o),n&&this.BZ(n.dataRange())},e.prototype.GR=function(e,o){var n=this.sj;t.prototype.GR.call(this,e,o),n&&this.BZ(n.dataRange())},e.prototype.no=function(){this.sj=st,this.kj=st},e}(s.HideRowFilter),e.MAb=Kt),Qt=function(){function t(t,e,o,n,r,i){var a=this;a.id(t),a.dataField(e),a.name(o||e||xt+a.id()),a.formatter(n),a.cellType(r),a.value(i)}return t.prototype.k$=function(){return this.id()>0},t.prototype.toJSON=function(){var t=this,e={};return m(Nt,(function(o,n){var r=t[n]();C(r)||(n===gt&&r.toJSON&&"function"==typeof r.toJSON?e[n]=r.toJSON():e[n]=r)})),y(e)?lt:e},t.prototype.fromJSON=function(t){if(t){var e=this;m(Nt,(function(o,r){var i,a,s,l,u=t[r]!==lt?t[r]:t["_"+r];C(u)||r===gt&&(i=u.typeName,(s=(a=n.CellTypes&&n.CellTypes._o)&&a[i]||a[u.type]||n.getTypeFromString(i))&&((l=new s).fromJSON(u,!1),u=l)),C(u)||e[r](u,!1)}))}},t}(),e.TableColumn=Qt,Qt.prototype.id=function(t){var e=h("id",lt,(function(t){this.name()||this.name(xt+t)}));return 0===arguments.length?e.call(this):C(t)?this:e.call(this,t)},Qt.prototype.name=h(dt,lt,(function(t){if(!t){this.name(xt+this.id())}})),Qt.prototype.formatter=h(yt),Qt.prototype.cellType=h(gt),Qt.prototype.value=h(mt),Qt.prototype.dataField=h(At),Qt.prototype.footerValue=h(Mt),Qt.prototype.dataAreaFormula=h(Rt),Qt.prototype.footerFormula=h(It),Qt.prototype.ANb=h("dataAreaFormulaStr"),Qt.prototype.NNb=h("isArrayFormula"),$t=function(){function t(t){this.kj=t,this.l$=[],this.$m=[],this.an=[]}return t.prototype.no=function(){var t,e,o=this,n=o.l$,r=n.length;for(e=0;e<r;e++)(t=n[e])&&t.no();o.l$=[],o.Nm(),o.kj=st},t.prototype.Nm=function(){var t,e,o,n=this;for(n.$m=[],n.an=[],e=(t=n.l$).length,o=0;o<e;o++)t[o].Nm()},t.prototype.hNb=function(t,e){var o,n,r=this.l$,i=r.length;for(n=0;n<i;n++)o=r[n],!e&&oe(o.oNb,t)?o.oNb=[]:C(o.oNb[t])||(o.oNb[t]=lt)},t.prototype.iNb=function(t){var e,o,n=this.l$,r=n.length;for(o=0;o<r;o++)oe((e=n[o]).pNb,t)?e.pNb=[]:C(e.pNb[t])||(e.pNb[t]=lt)},t.prototype.add=function(t,e,o,n,r,i,a){var s=this;return s.LA(s.kj,t,e,o,n,r,!0),s.Cz(new Yt(t,e,o,n,r,i||c.TableThemes.medium2,a))},t.prototype.addFromDataSource=function(t,e,o,n,r,i){var a,s,u,c,f;if(n||T(Jt().Exp_TableDataSourceNullError),l.qL)return this,(a=this.kj).suspendPaint(),(s=new l.qL).bind(n),u=s.getRowCount()+1,c=s.getColumnCount(),(f=this.add(t,e,o,u,c,r,i)).Fu(s),a.clearPendingChanges(),a.resumePaint(),f},t.prototype.find=function(t,e){var o,n,r,i=this.l$,a=i.length;for(n=0;n<a;n++)if((r=(o=i[n]).range()).row<=t&&t<r.row+N(r)&&r.col<=e&&e<r.col+O(r))return o;return st},t.prototype.findByName=function(t){var e,o,n=this.l$,r=n.length;for(o=0;o<r;o++)if((e=n[o]).name().toLowerCase()===t.toLowerCase())return e;return st},t.prototype.pJb=function(t,e,o,r){var i,a,s=this.l$,l=s.length,u=n.kf(t,o,e,r),c=[];for(a=0;a<l;a++)i=s[a],u.containsRange(i.range())&&c.push(i);return c},t.prototype.s$=function(t,e,o,n){var r,i,a=this.l$,s=a.length,l=[];for(i=0;i<s;i++)(r=a[i]).range().intersect(t,e,o,n)&&l.push(r);return l},t.prototype.KHb=function(){var t=this.kj,e=this.find(t.Jl,t.Kl);if(e)return t.cm(new n.Range(-1,e.dj,-1,e.OZ))},t.prototype.Cz=function(t,e){var o,n;if(t)return(o=this).findByName(t.name())&&T(Jt().Exp_TableHasSameNameError),(n=o.kj).suspendPaint(),t.Yv(o),n.ITa.tVa([]),o.l$.push(t),t.PNb||t.JZ(),t.showHeader()&&t.PZ(),!e&&t.showFooter()&&t.SZ(),o.t$(t),n.resumePaint(),t},t.prototype.vV=function(t){var e,o=this,n=g(t,o.l$);return n>-1?((e=o.kj)&&e.ITa.tVa([t]),o.l$.splice(n,1),o.u$([t],!1),t):st},t.prototype.remove=function(t,e){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,b=this;if(J(t)&&(t=b.findByName(t)),t&&(e=e||0,t.RZ(),t=b.vV(t))){o=t.range(),r=b.kj;try{if(A(r),i=o.row,a=o.row+N(o),s=o.col,l=o.col+O(o),u=void 0,c=void 0,f=t.showHeader(),h=t.headerIndex(),1!=(1&e))for(u=i;u<a;u++)for(c=s;c<l;c++)S(r,u,c,st),x(r,u,c,st);else if(t.hJb()){if(f)for(u=h,c=s;c<l;c++)r.setValue(u,c,t.getColumnName(c-o.col));for(g=(d=(p=t.dataRange()).row)+N(p),void 0,m=void 0,y=void 0,u=d;u<g;u++)for(c=s;c<l;c++)(m=t.Nz[W(t,c)])&&(y=t.ru(U(t,u))[m.dataField()],C(y)||r.setValue(u,c,y))}else if(f)for(u=h,c=s;c<l;c++)r.setValue(u,c,t.getColumnName(c-o.col));if(2==(2&e))for(u=i;u<a;u++)for(c=s;c<l;c++)v=r.getStyle(u,c)||new n.Style,t.Yo(u,c,v),r.setStyle(u,c,v)}finally{I(r)}t.Cec(2)}return t},t.prototype.move=function(t,e,o){var n,r,i,a=this,s=a.kj;if(J(t)&&(t=a.findByName(t)),t&&e>=0&&o>=0&&(n=t.range(),0===(i=(r=a.s$(e,o,N(n),O(n))).length)||1===i&&r[0]===t)){A(s);try{t.YZ(e,o)}finally{I(s)}}},t.prototype.resize=function(t,e){var o,r,i,a,s,l,u,c,f,h=this,p=h.kj;if(J(t)&&(t=h.findByName(t)),t&&(o=t.range(),r=t.dataRange(),a=e,3===(i=arguments).length&&(a=n.kf(o.row,o.col,i[1],i[2])),a&&(s=N(a),l=O(a),s>=0&&l>=0&&h.s$(a.row,a.col,s,l).length<=1))){X(p);try{t.b$(a),t.hJb()||(u=p.conditionalFormats,c=p.uja,f=a.rowCount-o.rowCount,u&&u.XXc(o,r,f),c&&c.XXc(o,r,f))}finally{Z(p)}}},t.prototype.all=function(){var t=[];return m(this.l$,(function(e,o){t.push(o)})),t},t.prototype.Xec=function(t){var e,o=t||this.l$,n=o.length;for(e=0;e<n;e++)o[e].clearPendingChanges()},t.prototype.Nec=function(t,e,o,n){var r,i,a=[],s=this.l$,l=s.length;for(r=0;r<l;r++)(i=s[r]).cj>=t&&i.dj>=e&&i.cj+i.Xj<=t+o&&i.dj+i.OZ<=e+n&&a.push(i);return a},t.prototype.Oec=function(t,e,o,n){var r=this.s$(t,e,o,n),i=this.Nec(t,e,o,n),a=[];return i.length>0?r.forEach((function(t){-1===i.indexOf(t)&&a.push(t)})):a=r,a},t.prototype.Pec=function(t,e,o){var n,r,i=t.length;for(n=0;n<i;n++)if((r=t[n].range()).row<=e&&e<r.row+N(r)&&(o<0||r.col<=o&&o<r.col+O(r)))return!0;return!1},t.prototype.LA=function(t,e,o,n,r,i,s){var l,u,c,f;return e?F(e)?o<0||r<1||o+r>t.getRowCount()?(s&&T(Jt().Exp_TableInvalidRow),!1):n<0||i<1||n+i>t.getColumnCount()?(s&&T(Jt().Exp_TableInvalidColumn),!1):(l=t.tables).rn(o,n,r,i)?(s&&T(Jt().Exp_TableIntersectError),!1):l.findByName(e)?(s&&T(Jt().Exp_TableHasSameNameError),!1):(c=(u=a&&t.Ms(o,n,r,i))&&u.ranges,f=!0,c&&m(u,(function(t,e){if(N(e)>1||O(e)>1)return s&&T(Jt().Exp_ArrayFormulaTable),f=!1,!1})),f):(s&&T(Jt().Exp_TableNameInvalid),!1):(s&&T(Jt().Exp_TableEmptyNameError),!1)},t.prototype.$Hb=function(t,e,o,n){var r,i,a=[],s=this.l$;for(r=0;r<s.length;r++)(i=s[r]).cj>=t&&i.dj>=e&&i.cj+i.Xj<=t+o&&i.dj+i.OZ<=e+n&&a.push(i.name());return a},t.prototype.HZ=function(t,e,o,r){var i,a,s,l,u=this.all();if(u)for(i=n.kf(t,e,o,r),a=u.length,s=void 0,l=0;l<a;l++)if(s=u[l].range(),i.intersect(s.row,s.col,N(s),O(s))&&!i.containsRange(s))return!0;return!1},t.prototype.rn=function(t,e,o,n){var r,i=this.l$,a=i.length;for(r=0;r<a;r++)if(i[r].range().intersect(t,e,o,n))return!0;return!1},t.prototype._getTable=function(t,e,o,n,r){var i,a,s,l=t.tables.all(),u=l.length,c=[];for(a=0;a<u;a++)(s=(i=l[a]).range()).row>=e&&s.col>=o&&s.row+s.rowCount<=e+n&&s.colCount+s.col<=o+r&&c.push({table:i,index:a});return c},t.prototype.zxb=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p=o.tables.all(),d=p.length;if(!C(e)&&(a=n.row-e.row,s=n.col-e.col,0!==(l=this._getTable(t,e.row,e.col,e.rowCount,e.colCount)).length))for(u=0;u<d;u++)for(i=p[u],c=0;c<l.length;c++)if(f=l[c],(!r||u!==f.index)&&(h=f.table.range(),i.range().intersect(h.row+a,h.col+s,h.rowCount,h.colCount)))return o.Os(6,Jt().Exp_TableIntersectError),!0;return!1},t.prototype.KZ=function(t,e){var o,n,r=this.l$;for(o=0,n=r.length;o<n;o++)r[o].KZ(t,e);this.kj.filterRowsVisibleInfo.NTa(t,e)},t.prototype.rI=function(t,e){var o,r,i,a,s,l,u,c,f,h,p=this.l$,d=[];for(o=0,r=p.length;o<r;o++)a=(i=p[o]).LZ(),b(d,a)?i.rI(t,e,!0):i.rI(t,e)&&d.push(a);s=this.kj;try{for(A(s),l=void 0,u=void 0,o=0,r=p.length;o<r;o++)l=(i=p[o]).q$(),u=i.dataRange(),l>0&&l!==N(u)&&(c=l,i.showHeader()&&(c+=1),i.showFooter()&&(c+=1),f=i.range(),h=n.kf(f.row,f.col,c,O(u)),i.b$(h))}finally{I(s)}},t.prototype.tI=function(t,e){var o,n=this.l$,r=n.length;for(o=0;o<r;o++)n[o].tI(t,e)},t.prototype.khc=function(t){var e,o,n,r,i=this.l$,a=i.length;for(r=0;r<a;r++)o=(e=i[r]).dj,n=e.endColumn(),o<=t&&n>=t&&e.khc()},t.prototype.GR=function(t,e){var o,r,i,a,s,l,u,c,f,h,p,d=this,g=d.l$,m=[],y=[],C=[];for(o=0,r=g.length;o<r;o++)a=(i=g[o]).LZ(),t<=(s=i.range()).row&&s.row+N(s)<=t+e?C.push(i):(b(m,a)?i.GR(t,e,!0):(i.hJb()&&i.WNb(t,e,q(!0)),i.GR(t,e)&&m.push(a)),y.push(i));d.kj.filterRowsVisibleInfo.PTa(t,e),d.kj.ITa.tVa(C),d.l$=y,d.u$(C,!0),l=d.kj;try{for(A(l),g=d.l$,u=void 0,c=void 0,o=0,r=g.length;o<r;o++)u=(i=g[o]).q$(),c=i.dataRange(),u>0&&u!==N(c)&&(f=u,i.showHeader()&&(f+=1),i.showFooter()&&(f+=1),h=i.range(),p=n.kf(h.row,h.col,f,O(c)),i.b$(p))}finally{I(l)}},t.prototype.HR=function(t,e){var o,n,r,i=this,a=i.l$,s=[],l=[],u=a.length;for(n=0;n<u;n++)t<=(r=(o=a[n]).range()).col&&r.col+O(r)<=t+e?l.push(o):(o.HR(t,e),s.push(o));i.kj.ITa.tVa(l),i.l$=s,i.u$(l,!0)},t.prototype.$b=function(t,e,o,r,i){var a,s,l,u,c,f=this,h=n.kf(t,e,o,r),p=[],d=f.kj;if(1==(1&i)){for(u=[],s=(a=f.l$).length,c=0;c<s;c++)l=a[c],h.containsRange(l.range())?p.push(l):u.push(l);for(s=u.length,c=0;c<s;c++)(l=u[c]).$b(t,e,o,r);d&&d.ITa.tVa(p),f.l$=u}if(2==(2&i))for(s=(a=f.l$).length,c=0;c<s;c++)l=a[c],h.containsRange(l.range())&&(d&&d.ITa.pVa(l,"style",l.style()),l.style(st));return f.u$(p,!0),p},t.prototype.u$=function(t,e){if(t&&0!==t.length){var o=this.kj;n.GC$.each(t,(function(t,e){e.Aq()&&e.getSlicerData().onTableRemoved(e),e.uNb()&&(o&&o.ITa.pVa(e,kt,e.wNb()),e.mNb=[])})),a&&function(t,e,o){var n=t.parent,i=R(t);function a(e,n){m(e,(function(e,a){var s=a.getExpression(),l=r.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(s,n,-1,-1,o);l!==s&&(a.fg(l),i.invalidName(t.yj(),a.getName()))}))}n?(a(n.getCustomNames(),e),m(n.sheets,(function(t,o){a(o.getCustomNames(),e)}))):a(t.getCustomNames(),e),i.onAfterRemoveTable(e,o)}(this.kj,t,e)}},t.prototype.t$=function(t){t&&t.Aq()&&t.getSlicerData().onTableAdded(t)},t.prototype.v$=function(t){for(var e=1,o=t,n=this.MXc();!this.NXc(o,n);)o=t+e,e++;return o},t.prototype.MXc=function(){var t,e,o,n,r,i=[];for(t=0,e=this.kj.parent.sheets;t<e.length;t++)for(o=0,n=e[t].tables.all();o<n.length;o++)r=n[o],i.push(r);return i},t.prototype.NXc=function(t,e){var o,n;for(o=0,n=e;o<n.length;o++)if(n[o].name().toLowerCase()===t.toLowerCase())return!1;return!0},t.prototype.ge=function(t,e){var o=!1,n=st,r=this.find(t,e);return r&&(r.showHeader()&&t===r.headerIndex()?(n=r.g$(e),C(n)||(n=d(n)),o=!0):(o=(n=r.ge(t,e)).gt,n=n.Qb)),{gt:o,Qb:n}},t.prototype.yq=function(t,e,o){var n=!1,r=!0,i=this.find(t,e);return i&&!0!==i.KNb&&(i.showHeader()&&t===i.headerIndex()?i.VZ(o)?r=!1:(o=C(o)?o:d(o),i.h$(e,o)):i.showFooter()&&t===i.footerIndex()?i.j$(e,o):n=i.yq(t,e,o)),n||!r},t.prototype.Hma=function(t,e,o,n,r,i){var s=this.find(t,e);if(a&&s){if(o>1||n>1)return this.kj.Os(0,Jt().Exp_ArrayFormulaTable),!1;if(s.showHeader()&&t===s.headerIndex()&&r)return!1;!s.KNb&&s.showFooter()&&t===s.footerIndex()&&(C(r)||s.j$(e,st),s.i$(e-s.dj,r,i))}return!0},t.prototype.IZ=function(){var t,e,o,n=this.all();for(t=0,e=n.length;t<e;t++)(o=n[t]).bindingPath()&&(o.wq=st)},t.prototype.dB=function(t,e){var o,n,r,i=[],a=this;if(a&&(o=a.all()))for(r=o.length-1;r>=0;r--)n=o[r],t.containsRange(n.range())&&(e&&(this.kj&&this.kj.ITa.tVa([n]),a.l$.splice(r,1),n.ZZ(lt,lt,e)),i.push(n));return i},t.prototype.eB=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p=this,d=[];for(a=0,s=t.length;a<s;a++)l=t[a],u=void 0,c=void 0,i?c=l:(u=l.bindingPath()?lt:l.LZ(),(c=new Yt).Yv(p),c.fromJSON(pt(ht(l.toJSON()))),c.name(p.v$(c.name())),d.push(c)),f=c.range(),c.S3=!0,c.$Z(n+f.row-e,r+f.col-o),p.Cz(c,i),i?(h=c.ZX)&&(h.kj=p.kj,h.refresh()):u&&c.p$(u),c.S3=!1;for(a=0;a<d.length;a++)d[a].formulaFromJSON()},t.prototype.R3=function(t){for(var e=0,o=t.length;e<o;e++)t[e]._Z()},t.prototype.toJSON=function(t){var e,o=this.l$,n=[];if(o)for(e=0;e<o.length;e++)t?n.push(o[e].toJSON(this.v$(o[e].name()))):n.push(o[e].toJSON());return 0===n.length?lt:n},t.prototype.fromJSON=function(t,e){var o,n,r,i;if(t)for(this.l$=[],this.Nm(),o=0,n=t.length;o<n;o++)r=t[o],(i=new Yt).Yv(this),this.l$.push(i),i.fromJSON(r,e)},t.prototype.containTableHeaderTotalRowForSheet=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h=this.kj;if(h&&(t=h.getSelections(),o=void 0,n=void 0,r=void 0,(e=h.tables)&&t))for(i=e.l$,a=void 0,s=void 0,l=void 0,u=void 0,c=0;c<t.length;c++)for(r=(n=(o=t[c]).row)+o.rowCount-1,f=0;f<i.length;f++)if(s=(a=i[f]).range(),l=a.headerIndex(),u=a.footerIndex(),!o.containsRange(s)&&(l>=n&&l<=r||u>=n&&u<=r))return!0;return!1},t.prototype.containTableHeaderTotalRow=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;if(l&&(t=l.getSelections(),e=void 0,o=void 0,l.tables&&t)){if(t.length>1)return u;n=t[0],i=void 0,a=void 0,s=void 0,(r=rt(l,n))&&1===r.length&&(o=(e=n.row)+n.rowCount-1,a=(i=r[0]).headerIndex(),s=i.footerIndex(),(a>=e&&a<=o||s>=e&&s<=o)&&(u=!0))}return u},t.prototype.noRoomToInsertColumn=function(){var t,e,o,n,r,i,a,s,l=this.kj;return!!(l&&(t=l.getSelections(),e=l.tables,e&&t&&1===t.length&&(o=t[0],n=o.row,r=o.col,i=o.colCount,a=e.find(n,r),s=l.getColumnCount(3),a&&a.endColumn()+i>=s)))},t.prototype.noRoomToInsertRow=function(){var t,e,o,n,r,i,a,s,l=this.kj;return!!(l&&(t=l.getSelections(),e=l.tables,e&&t&&1===t.length&&(o=t[0],n=o.row,r=o.col,i=o.rowCount,a=e.find(n,r),s=l.getRowCount(3),a&&a.endRow()+i>=s)))},t.prototype.checkTableRow=function(){var t,e,o,n,r,i,a,s=this.kj;return!!(s&&(t=s.getSelections(),e=s.tables,e&&t&&1===t.length&&(o=t[0],n=o.row,r=o.col,i=e.find(n,r),a=i&&i.range(),i&&a&&!i.MZ&&!i.NZ&&1===a.rowCount)))},t.prototype.checkTableCol=function(){var t,e,o,n,r,i,a,s=this.kj;return!!(s&&(t=s.getSelections(),e=s.tables,e&&t&&1===t.length&&(o=t[0],n=o.row,r=o.col,i=e.find(n,r),a=i&&i.range(),a&&1===a.colCount)))},t.prototype.isAcrossTables=function(){var t,e,o,n=this.kj,r=!1;if(n&&(t=n.getSelections(),n.tables&&t)){if(t.length>1)return r;e=t[0],(o=rt(n,e))&&(r=o.length>1)}return r},t.prototype.isWholeTableCol=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;return l&&(t=l.getSelections(),l.tables&&t&&(t.length>1?u=!0:(e=t[0],1===(o=rt(l,e)).length&&(r=(n=o[0]).dj,i=n.OZ,a=e.col,s=e.colCount,u=r===a&&i===s)))),u},t.prototype.containTableHeader=function(){var t,e,o,n,r,i,a=this.kj,s=!1;if(a&&(t=a.getSelections(),e=void 0,o=void 0,a.tables&&t)){if(t.length>1)return s;n=t[0],(r=rt(a,n))&&1===r.length&&(i=r[0].headerIndex(),o=(e=n.row)+n.rowCount-1,e<=i&&o>=i&&(s=!0))}return s},t.prototype.mKb=function(){var t,e,o,n,r,i,a,s,l=this.kj,u=!1;if(l&&(t=l.getSelections(),(e=l.tables)&&t)){if(o=l.getActiveRowIndex(),n=l.getActiveColumnIndex(),t.length>1||!e.find(o,n))return u;for(r=e.l$,i=t[0],a=void 0,s=0;s<r.length;s++)a=r[s],i&&i.intersect(a.cj,a.dj,a.Xj,a.OZ)&&(u=!0)}return u},t.prototype.PMb=function(t){var e,o,n,r,i=-1,a=this.l$;if(a)for(e=a.length,o=void 0,void 0,void 0,n=void 0,r=0;r<e;r++)o=a[r].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||i<(n=o.row+o.rowCount-1)&&(i=n);return i},t.prototype.QMb=function(t){var e,o,n,r,i=-1,a=this.l$;if(a)for(e=a.length,o=void 0,void 0,void 0,n=void 0,r=0;r<e;r++)o=a[r].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||i<(n=o.col+o.colCount-1)&&(i=n);return i},t.prototype.fIb=function(t,e,o,n,r){var i,a,s,l,u,c,f,h=this;if(!h.kj.options.isProtected&&0!==(i=h.all()).length)for(l=0,u=i;l<u.length;l++)(a=u[l]).qNb&&(s=a.range(),c=e&&e.equals(s),f=e&&0!==h.kj.ITa.getSpans(e,3).length,e&&(c||f)||(a.UNb=n,h.$Nb(a,s,t,o,r),delete a.UNb))},t.prototype.$Nb=function(t,e,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x=this.kj,A=null,I=!1,R=e.row,M=e.col,k=e.rowCount,N=e.colCount,O=R+k-1,D=new n.Range(R,M,k,N);if(t.showFooter()){if(a=new n.Range(R+k-1,M,1,N),o.row===a.row&&o.col>=M&&o.col+o.colCount<=M+N)return;I=!0,D.rowCount--}if(i&&(s=t.showHeader()?k-1:k,i.push(new n.Range(R,M,s,N))),l=o.row,u=o.col,c=o.row+o.rowCount-1,f=o.col+o.colCount-1,h=R+k-1,p=M+N-1,d=lt,g=x.getRowCount(),m=D.contains(l-1,u)&&!D.contains(l,u),I||(m=m&&f<=p&&u>=M),y=D.contains(l,u-1)&&!D.contains(l,u)&&c<=O&&l>=e.row,D.contains(l,u)&&!D.contains(c,f)){if(C=ft(h,c)-R+1,v=ft(p,f)-M+1,f>p&&((b=H(x,new n.Range(R,p+1,k,f-p)))&&f>b.col&&(v=N)),A=new n.Range(R,M,C,v),I&&(A.rowCount++,c++),c>h&&(d=H(x,new n.Range(h+1,M,A.row+A.rowCount-1,N))),d&&(w=c-d.row+1)>0){if(H(x,new n.Range(g-Math.abs(w),M,Math.abs(w),N)))return void x.Os(6,Jt().Exp_TableAddRowNoEnoughRoom);x.moveTo(d.row,M,A.row+A.rowCount,M,g-A.row-A.rowCount,N,2047)}}else if(m&&!I){if(A=new n.Range(l,M,o.rowCount,N),(T=H(x,A,o))&&!o.containsRange(T))return}else if(y&&(A=new n.Range(R,u,e.rowCount,o.colCount),(T=H(x,A,o))&&!o.containsRange(T)))return;if(m&&!I&&$(r)&&(t.useFooterDropDownList(!0),function(t,e){t.wu().execute({cmd:"tableShowFooter",sheetName:t.name(),tableName:e.name()})}(x,t)),A){if(e.containsRange(A))return;S=e.union(A),this._Nb(t,e,S)}},t.prototype._Nb=function(t,e,o){var n=this.kj,r=n.getParent();r&&r.commandManager().execute({cmd:"tableResize",sheetName:n.name(),tableName:t.name(),resizeToRange:o})},t.prototype.gJb=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this,C=this.kj,v=o.col,b=o.row,w=Xt.TABLE_SELECT,T=Xt.TABLE_CORNER_SELECT,S=Xt.TABLE_COL_SELECT,x=Xt.TABLE_ROW_SELECT,A=C.getActiveRowIndex(),I=C.getActiveColumnIndex();if(-1===o.rowViewportIndex&&(n=C.getCellRect(b,v,o.rowViewportIndex,o.colViewportIndex),(r=y.find(A,I))instanceof Yt&&r.showHeader()&&A>=r.cj&&A<r.cj+r.Xj&&I>=r.dj&&I<r.dj+r.OZ&&r.cj<C.lq&&r.cj+r.Xj>C.lq&&o.col<r.dj+r.OZ&&o.col>=r.dj))if(t>n.x+5&&t<n.x+n.width-18&&e<n.height-5){for(i=C.getSelections(),a=0;a<i.length;a++)if(!((s=i[a]).col===o.col&&1===s.colCount&&s.row===r.cj&&s.rowCount===r.Xj||s.col===o.col&&1===s.colCount&&-1===s.row&&s.rowCount===C.getRowCount()))return z(r,S)}else if(t>n.x+18)return z(r,"default");if(l=C.getCellRect(b,v),y.find(b,v)instanceof Yt&&-1!==o.colViewportIndex&&-1!==o.rowViewportIndex){if(u=!1,r=y.find(b,v),c=y.find(A,I),f=!0,1===(i=C.getSelections()).length&&((h=i[0]).row<=b&&h.row+h.rowCount>b&&h.col<=v&&h.col+h.colCount>v&&(f=!1)),r===c&&(u=!0),v===r.dj&&b===r.cj){if(f&&u&&(t<=l.x+2||e<=l.y+2))return z(r,w);if(t>l.x+2&&t<l.x+18&&e>l.y+2&&e<l.y+6)return z(r,T);if(t>l.x+18&&e>l.y+2&&e<l.y+6)return z(r,S);if(t>l.x+2&&t<l.x+18&&e>l.y+6)return z(r,x)}if(v===r.dj+r.OZ-1&&b===r.cj){if(f&&u&&(t>=l.x+C.getColumnWidth(v)-2||e<=l.y+2))return z(r,w);if(t<l.x+C.getColumnWidth(v)-2&&e>l.y+2&&e<l.y+6)return z(r,S)}if(v===r.dj&&b===r.cj+r.Xj-1){if(f&&u&&(t<=l.x+2||e>=l.y+C.getRowHeight(b)-2))return z(r,w);if(t>l.x+2&&t<l.x+18&&e<l.y+C.getRowHeight(b)-2)return z(r,x)}if(f&&u&&v>r.dj&&v<r.dj+r.OZ&&b===r.cj&&e<=l.y+2)return z(r,w);if(v>r.dj&&v<r.dj+r.OZ&&b===r.cj&&e>l.y+2&&e<l.y+6)return z(r,S);if(f&&u&&b>r.cj&&b<r.cj+r.Xj&&v===r.dj&&t<=l.x+2)return z(r,w);if(b>r.cj&&b<r.cj+r.Xj&&v===r.dj&&t>l.x+2&&t<l.x+18)return z(r,x);if(p=C.getColumnWidth(r.dj+r.OZ-1),d=C.getRowHeight(r.cj+r.Xj-1),g=l.x+p,m=l.y+d,u&&(b>r.cj&&b<r.cj+r.Xj&&v===r.dj+r.OZ-1&&t>=g-2&&t<=g||v>r.dj&&v<r.dj+r.OZ&&b===r.cj+r.Xj-1&&e>=m-2&&e<=m)){if(v===r.dj+r.OZ-1&&b===r.cj+r.Xj-1&&e>=m-10&&t>=g-10)return st;if(f)return z(r,w)}}return st},t.prototype.bJb=function(t,e){var o,n,r,i,a=this,s=a.kj;if(a.find(t,e)instanceof Yt){for(n=0,(o=a.find(t,e)).NZ&&(n=1),r=0,o.MZ&&(r=1);t>0&&0===s.getRowHeight(t-1);)t--;if(1===r&&e===o.dj&&t===o.cj)return i=L(s,o,!0),P(i,o.dj+o.OZ-1,i);if(e===o.dj&&t===o.cj)return i=L(s,o,!0),P(i,o.dj+o.OZ-1,i);if(t>o.cj&&t<o.cj+o.Xj-n&&e===o.dj)return t===o.cj+r?(t=L(s,o,!0),P(t,o.dj+o.OZ-1,t)):P(t-1,o.dj+o.OZ-1,t-1)}return null},t.prototype.cJb=function(t,e){var o,r,i,a,s,l,u,c,f,h,p,d,g=this,m=g.kj;if(g.find(t,e)instanceof Yt){for(r=0,(o=g.find(t,e)).NZ&&(r=1),i=0,o.MZ&&(i=1),a=m.getRowCount()-1;t+1<m.getRowCount()&&0===m.getRowHeight(t+1);)t++;if(a!==t&&e===o.dj+o.OZ-1&&t<o.cj+o.Xj-r)return s=o.cj+o.Xj,u=(l=o.dj)+o.OZ-1,c=P(t+1,o.dj,t+1),t===s-r-1&&(o.qNb?(f=B(m,o),1===r&&V(m,o,s,f,l,u,1,!0,!1,!0)||(p=((h=H(m,new n.Range(s,l,f-s+1,u-l+1)))&&h.row)===s,s!==m.getRowCount()&&(p?function(t,e,o,n,r){t.wu().execute({cmd:Dt,sheetName:t.name(),tableName:e.name(),row:o,count:n,isAfter:r})}(m,o,t,1,!0):function(t,e,o,n,r){t.wu().execute({cmd:"DoInsertRows",sheetName:t.name(),tableName:e.name(),row:o,count:n,isAfter:r})}(m,o,t,1,!0)))):c=P(t,u+1,t)),c;if(m.getRowCount()-1===t&&e===o.dj+o.OZ-1&&0===r){for(d=o.cj+i;d+1<m.getRowCount()&&0===m.getRowHeight(d);)d++;return d+1===m.getRowCount()&&0===m.getRowHeight(d)?P(o.cj,o.dj,o.cj):P(d,o.dj,d)}}return null},t.prototype.fg=function(){var t,e=this.l$,o=e.length;for(t=0;t<o;t++)e[t].e$()},t.prototype.Cec=function(t,e){var o,n,r,i,a,s,l=this.l$,u=l.length;for(o=0;o<u;o++)n=l[o],t?(r=n.cj,i=n.cj+n.Xj-1,r<=e&&e<=i&&n.Cec(0)):(a=n.dj,s=n.dj+n.OZ-1,a<=e&&e<=s&&n.Cec(0))},t.prototype.KFc=function(t,e,o,n,r){var i,a,s,l=this.s$(t,e,o,n),u=[];for(i=0,a=l.length;i<a;i++)s=l[i].dataRange(),r?s.rowCount+=o:s.colCount+=n,u.push(s);return u},t}(),e.TableManager=$t,function(t){t[t.none=0]="none",t[t.keepData=1]="keepData",t[t.keepStyle=2]="keepStyle"}(e.TableRemoveOptions||(e.TableRemoveOptions={})),n.GC$.extend(n.lUa.prototype,{CNb:function(t,e){var o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:"changeTableManager",table:t,oldTableManager:e}))},pVa:function(t,e,o){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:Gt,table:t,name:e,value:o}))},tVa:function(t){var e,o,n=this.zTa;n&&(n.uVa||(n.uVa=[]),e=n.uVa,o=this.noa,e.push({type:Pt,tableList:o.l$.slice(),changedTables:t}))},sVa:function(t,e,o){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:Lt,tableColumn:t,name:e,value:o}))},vVa:function(t,e,o){var n=t.getValue(e,o).value,r=this.zTa;r&&(r.uVa||(r.uVa=[]),r.uVa.push({type:Bt,bindingManager:t,row:e,col:o,oldValue:n}))},ENb:function(t,e,o,n,r){var i=this.zTa;i&&(i.uVa||(i.uVa=[]),i.uVa.push({type:_t,table:t,key:n,row:e,count:o,stateType:r}))},YNb:function(t,e,o){var n=this.zTa;n&&(n.aOb||(n.aOb=[]),n.aOb.push({type:zt,table:t,expression:e,col:o}))},ZNb:function(t,e,o,n){var r=this.zTa;r&&(r.bOb||(r.bOb=[]),r.bOb.push({type:Ut,table:t,expression:e,row:o,col:n}))},wVa:function(t){var e,o,n,r,i,a,s,l;if(t)for(function(t){var e,o;if(t)for(e=t.length-1;e>=0;e--)(o=t[e]).bindingManager.sUa(o)}(t.rUa),e=t.length-1;e>=0;e--)switch(o=t[e],n=void 0,o.type){case Pt:r=this.noa,i=o.changedTables,r.l$=o.tableList,i&&i.length>0&&i.forEach((function(t){t&&(t.e$(),t.JZ())}));break;case Lt:o.tableColumn[o.name](o.value);break;case Gt:n=o.table,a=o.name,s=o.value,a===Vt?(n.cj=s.row,n.dj=s.col,n.Xj=s.rowCount,n.OZ=s.colCount):a===Ht?n.Nz=s:a===kt?n.mNb=s:n[a](s),n.Cec(0);break;case"changeTableManager":n=o.table,l=o.oldTableManager,n.BNb(l);break;case Bt:o.bindingManager.setValue(o.row,o.col,o.oldValue);break;case _t:ie(o.table,o.row,o.count,o.key,o.stateType)}},cOb:function(t){var e,o,n,r,i,a,s;if(t){for(e=void 0,o=t.length-1;o>=0;o--)(n=t[o]).type===zt&&(e=n.table,r=n.expression,i=n.col,a=void 0,(a=e.Nz[i].footerFormula())&&((s=tt(a))>-1&&(a.arguments[s]=r)));e&&e.e$()}},dOb:function(t){var e,o,n,r,i;if(t)for(e=t.length-1;e>=0;e--)(o=t[e]).type===Ut&&(n=o.expression,r=o.row,i=o.col,o.table.SNb(r,i,n))}}),n.lUa.$n(Ot,{priority:7e3,init:function(){this.noa=new $t(this.kj)},clearPendingChanges:function(t){var e=this.tables;e&&e.Xec(t.tableList)},undoAddRows:function(t){var e=this.kj,o=t.row,n=t.rowCount;e.tables.s$(o,-1,n,-1).forEach((function(t){t.WNb(o,n,q(!0))}))},getValue:function(t){var e,o=t.row,n=t.col,r=t.sheetArea,i=this.kj.tables;3===r&&i&&(i.find(o,n)&&(e=i.ge(o,n),t.isValueGet=e.gt,t.value=e.Qb))},setValue:function(t){var e,o=t.row,n=t.col,r=t.value,i=t.sheetArea,a=this.kj.tables;3===i&&a&&(a.find(o,n)&&(void 0,(e=t.changes)&&(e.uVa||(e.uVa=[])),t.isValueSet=a.yq(o,n,r)))},undo:function(t){var e=t.uVa,o=t.aOb,n=t.bOb;e&&this.wVa(e),o&&this.cOb(o),n&&this.dOb(n),this.noa.Nm()}}),n.Workbook.$n(Ot,{init:function(){n.Commands.mMb(this.commandManager())},onCultureChanged:function(){Jt()}})},"./dist/plugins/table/table.ns.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./dist/plugins/table/table.res.en.js");e.SR={en:n}},"./dist/plugins/table/table.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",e.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",e.Exp_TableEmptyNameError="The table name cannot be empty.",e.Exp_TableNameInvalid="The table name is not valid.",e.Exp_TableInvalidRow="Invalid row index or row count.",e.Exp_TableInvalidColumn="Invalid column index or column count.",e.Exp_TableIntersectError="The tables cannot be intersected.",e.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",e.Exp_TableDataSourceNullError="Table datasource cannot be null.",e.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",e.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",e.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",e.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",e.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",e.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",e.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",e.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",e.Exp_RowParamOutOfRange="The param row out of data range of table.",e.Exp_ColParamOutOfRange="The param col out of data range of table.",e.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",e.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",e.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",e.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",e.Table_Total="Total",e.Table_None="None",e.Table_Average="Average",e.Table_Count="Count",e.Table_Count_Numbers="Count Numbers",e.Table_Max="Max",e.Table_Min="Min",e.Table_Sum="Sum",e.Table_StdDev="StdDev",e.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o("./dist/plugins/touch/touch.js"))},"./dist/plugins/touch/touch.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function zt(t){return t.height}function Ut(t){return t.width}function Wt(t){clearInterval(t)}function qt(){return(new Date).valueOf()}function Jt(t,e){var o,n;return!(!t||!e)&&(13,15,13,13,15,15,o=t.X-e.X,n=t.Y-e.Y,v(o)<13&&v(n)<13&&I(o*o+n*n)<b(15,15))}function Xt(t){return t.getActiveSheet()}function Zt(t){return t.getSelections()}function Yt(t){return t.frozenTrailingColumnCount()}function Kt(t){return t.frozenTrailingRowCount()}function Qt(t,e){return t.getColumnCount(e)}function $t(t,e){return t.getRowCount(e)}function te(t){var e=l(t).offset(),o=q.body,n=0,r=0;return e&&(n=e.top+o.clientTop||0,r=e.left+o.clientLeft||0),{FB:n,EB:r}}function ee(t,e){var o=S(e.Y,e.X)-S(t.Y,t.X);return o>x?o-=2*x:o<-x&&(o+=2*x),o}function oe(t,e){return I((e.X-t.X)*(e.X-t.X)+(e.Y-t.Y)*(e.Y-t.Y))}function ne(t){return v(t)<=2220446049250313e-31}function re(t){return new et(t?A(t.X):-1,t?A(t.Y):-1)}function ie(t,e){var o=t*e;return o>4?o=4:o<.5&&(o=.5),o}function ae(t,e){return z(-e/(t/e+1)+e+"")}function se(t,e){return z(e*(-e/(t-e)-1)+"")}function le(t,e,o,n,r,i){t.fillStyle=e,t.fillRect(o,n,r,i)}function ue(t,e,o,n,i){var a,s,l,u,c,f=r.Im.Km(0,"gc-columnHeader-normal"),h=f&&f.backgroundImage,p=f&&f.backgroundColor;if(h&&-1!==h.indexOf("linear-gradient"))for(s=r.Ul.wl(h),a=t.createLinearGradient(e+n/2,o,e+n/2,o+i),l=0,u=s.length;l<u;l++)c=s[l],a.addColorStop(c.point,c.color);else p&&(a=p);return a}function ce(){var t=r.Im.Km(0,"gc-rowHeader-normal");return t&&t.backgroundColor}function fe(t,e,o,n,r,i){t.beginPath(),t.strokeStyle=e,t.moveTo(o,n),t.lineTo(r,i),t.stroke()}function he(t){var e=t.options.sheetAreaOffset;return t.Gt&&t.Gt()||{x:e.left,y:e.top,width:0,height:0}}function pe(t,e){var o,n,r,i,a,s=t.am(),l=t.yl.bm(),u=t.jt(1),c=he(t),f=t.Rt(-1),h=u.findRow(f),d=p("gc-group").color;h&&(o=s.qt,h.y-o>0&&e&&c.width>0&&0===s.Br&&fe(l,d,s.kt-.5,o,s.kt-.5,h.y)),n=t.it(1),r=t.Ot(-1),(i=n.findCol(r))&&(a=s.pt,i.x-a>0&&e&&c.height>0&&0===s.Cr&&fe(l,d,a,s.nt-.5,i.x,s.nt-.5))}function de(t,e){var o=0;return t||(o|=1),e||(o|=2),o}function ge(t,e,o,n){var r,i,s,l,u,c,f,h,p;if(0===t.selectionPolicy())return y;for(r=e.hitTestType,i=Te(t),s=Zt(t),l=3,t.CH&&s.length>0&&(-1!==(u=s[s.length-1]).row&&-1!==u.col?l=3:-1!==u.row?l=2:-1!==u.col&&(l=1)),c=0;c<i.length;c++)if((f=i[c])&&(f.x-=Ut(f),f.y-=zt(f),f.width*=3,f.height*=3,f.contains(o,n)))return a(e.row)&&((h=t.jt(1))&&h.length>0&&(e.row=h[h.length-1].row)),a(e.col)&&((p=t.it(1))&&p.length>0&&(e.col=p[p.length-1].col)),{x:o,y:n,type:l,isHeader:!1,isFirstIndicator:0===c};return 1===r?{x:o,y:n,type:1,isHeader:!0}:2===r?{x:o,y:n,type:2,isHeader:!0}:y}function me(t,e,o,n){var r,i,s,l,u,c,f,h,p,d,g,m,C=y,v=e.rowViewportIndex,b=e.colViewportIndex;if(a(v)||a(b))return C;if(r=t.parent,i=t.Ix(),v>=0&&b>=0&&1===t.ITa.getSelections().length){if(s=t.Tq(i),l=Yt(t),u=Kt(t),c=Qt(t)-l,f=$t(t)-u,1===b&&l>0&&s.col<c&&s.col+s.colCount>c&&((h=t.Hr(b))&&h.length>0&&o>(p=h[h.length-1]).x+Ut(p)))return C;if(1===v&&u>0&&s.row<f&&s.row+s.rowCount>f&&((d=t.Gr(v))&&d.length>0&&n>(g=d[d.length-1]).y+zt(g)))return C}return(m=ve(t))&&(C||(m.x-=Ut(m),m.y-=zt(m),m.width*=3,m.height*=3,m.contains(o,n)&&(C={action:"drag",side:"corner"})),r&&r.options.allowUserDragFill||C&&"corner"===C.side&&(C.side=y)),C}function ye(t,e,o,n,i){e===n&&o===i||(t.ITa.setCellState(e,o,r.CellStatesType.active,!1,r.SheetArea.viewport),t.xIb&&t.xIb(r.CellStatesType.active,e,o,r.SheetArea.viewport),t.ITa.setCellState(n,i,r.CellStatesType.active,!0,r.SheetArea.viewport),t.xIb&&t.xIb(r.CellStatesType.active,n,i,r.SheetArea.viewport))}function Ce(t,e,o,n){var r=t.vu();r.ko(e)?o.drawImage(r.lo(e),n.x,n.y,Ut(n),zt(n)):r.fo(e)}function ve(t){var e,o,n=y,i=Zt(t),a=i.length;return t.CH&&a>0&&(e=i[a-1],o=t.cm(e),17,20,n=new r.Rect(o.x+Ut(o)-17,o.y+zt(o),17,20)),n}function be(t,e,o){var n=t.Er(e),i=t.Fr(o),a=t.jt(n),s=t.it(i),l=0,u=0,c=0,f=0;return a.length>0&&(l=a[0].row,u=a[a.length-1].row),s.length>0&&(c=s[0].col,f=s[s.length-1].col),r.kf(l,c,u-l+1,f-c+1)}function we(t,e,o,n,r,i){var a=t.Er(e),s=t.Fr(o),l=t.am().Ft(a,s),u=be(t,e,o),c=u.row<=e&&e<=u.row+u.rowCount-1&&l.y<=r&&r<=l.y+zt(l),f=u.col<=o&&o<=u.col+u.colCount-1&&l.x<=n&&n<=l.x+Ut(l);return i&&i.colCheck?f:(i&&i.rowCheck||f)&&c}function Te(t){var e,o,n,i,a,s,l,u,c,f,h,p,d,g,m,C,v,b,w,T,S,x=Zt(t),A=[];if(t.CH&&x.length>0)for(e=x[x.length-1],o=t.cm(e),8,n=t.am(),i=e.row,a=e.row+e.rowCount-1,s=e.col,l=e.col+e.colCount-1,-1!==e.row&&-1!==e.col?(we(t,i,s,o.x,o.y)&&(A[0]=new r.Rect(o.x-8,o.y-8,16,16)),we(t,a,l,o.x+Ut(o),o.y+zt(o))&&(A[1]=new r.Rect(o.x+Ut(o)-8,o.y+zt(o)-8,16,16))):-1!==e.row?(u=n.Ft(1,0),c=n.Ft(1,1),f=u.x+(Ut(u)+Ut(c))/2-8,h=Qt(t)-1-Yt(t),(d=(p=t.it(1)).findCol(h))&&((g=t.it(0)[0]||p[0])&&(f=g.x+(d.x+Ut(d)-g.x)/2-8)),we(t,i,s,f+8,o.y,{rowCheck:!0})&&(A[0]=new r.Rect(f,o.y-8,16,16)),we(t,a,l,f+8,o.y+zt(o),{rowCheck:!0})&&(A[1]=new r.Rect(f,o.y+zt(o)-8,16,16))):-1!==e.col&&(u=n.Ft(0,1),c=n.Ft(1,1),m=u.y+(zt(u)+zt(c))/2-8,C=$t(t)-1-Kt(t),(b=(v=t.jt(1)).findRow(C))&&((w=t.jt(0)[0]||v[0])&&(m=w.y+(b.y+zt(b)-w.y)/2-8)),we(t,i,s,o.x,m+8,{colCheck:!0})&&(A[0]=new r.Rect(o.x-8,m,16,16)),we(t,a,l,o.x+Ut(o),m+8,{colCheck:!0})&&(A[1]=new r.Rect(o.x+Ut(o)-8,m,16,16))),T=void 0,S=A.length-1;S>=0;S--)(!(T=A[S])||T.x<0||T.y<0)&&(A[S]=y);return A}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("./dist/plugins/touch/touch.res.en.js"),e.SR={en:i},a=n.Common.j.Fa,s=r.Go,(l=r.GC$).extend,u=l.isEmptyObject,c=r.Ul.Nl,f=r.Ul.nl,h=r.Ul.Ml.mozilla,p=r.Im.Lm,d=r.Ul.rl(),g=d.ipad,m=g||d.iphone,y=null,C=void 0,v=Math.abs,b=Math.min,w=Math.max,T=Math.pow,S=Math.atan2,x=Math.PI,A=Math.round,I=Math.sqrt,R=Math.atan,M=Math.log,k=Math.floor,N="touch",O="none",D="MSPointerDown",F="MSPointerMove",E="MSPointerUp",j="pointerdown",P="pointermove",L="pointerup",G="touchstart",B="touchmove",_="touchend",V="MSPOINTER_TYPE_TOUCH",H=isNaN,z=parseInt,U=parseFloat,W=window,q=document,J=W.Yl,X="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",Z="AAAAAElFTkSuQmCC",r.Rxb.touch=!0,Y=new n.Common.ResourceManager(e.SR,"Touch"),K=Y.getResource.bind(Y),Q=function(){function t(){var t=this;t.rM=[],t.sM={length:0},t.tM=new $,t.uM=new tt}return t.prototype.vM=function(t){this.tM.vM=t},t.prototype.wM=function(t){this.tM.wM=t},t.prototype.xM=function(t){var e=this;e.tM.xM=function(o){if(t){t(o);var n=e.yM;n&&n.zM()}}},t.prototype.AM=function(t){this.tM.AM=t},t.prototype.BM=function(t){this.tM.BM=t},t.prototype.CM=function(t){this.uM.CM=t},t.prototype.DM=function(t){this.uM.DM=t},t.prototype.EM=function(t){this.uM.EM=t},t.prototype.FM=function(t){this.GM=t},t.prototype.HM=function(t){this.IM=t},t.prototype.JM=function(t,e){var o=e?e.KM:this.LM.KM;return r.Ul.Z3(t,o)},t.prototype.MM=function(t,e){var o,n,r,i,a,s=this,l=e.pointerType,u=e.target,c=e.offsetX,h=e.offsetY;l!==e[V]&&l!==N||(n=(o=s.JM(u,t)).EB,r=o.FB,s.NM(t,u,e.pointerId,new et(c+n,h+r),e.timeStamp)&&f(e),"sheet"===s.LM.OM&&(i=e.pageX-(c+n),a=e.pageY-(h+r),s.LM.KM.canvasOffset={top:a,left:i}))},t.prototype.PM=function(t){var e,o=this,n=t.pointerType,r=t.pointerId;if(n===t[V]||n===N){if(o.sM[r]===C)return!1;e=o.JM(t.target),o.aB(r,new et(t.offsetX+e.EB,t.offsetY+e.FB),t.timeStamp)&&f(t)}},t.prototype.QM=function(t){var e,o=this,n=t.pointerType,r=t.pointerId;if(n===t[V]||n===N){if(o.sM[r]===C)return!1;e=o.JM(t.target),o.RM(r,new et(t.offsetX+e.EB,t.offsetY+e.FB))&&f(t)}},t.prototype.SM=function(t){var e,o=this,n=t.pointerType,r=t.pointerId;if(n===t[V]||n===N){if(o.sM[r]===C)return!1;e=o.JM(t.target),o.TM(r,new et(t.offsetX+e.EB,t.offsetY+e.FB))&&f(t)}},t.prototype.UM=function(t,e){var o,n,r,i=te(t.KM),a=e.changedTouches,s=!1;for(o=0;o<a.length;o++)n=a[o],r=h?qt():e.timeStamp,s=this.NM(t,e.target,n.identifier,new et(n.pageX-i.EB,n.pageY-i.FB),r)||s;s&&f(e)},t.prototype.VM=function(t){var e,o,n,r=te(this.LM.KM),i=t.changedTouches,a=!1;for(e=0;e<i.length;e++)o=i[e],n=h?qt():t.timeStamp,a=this.aB(o.identifier,new et(o.pageX-r.EB,o.pageY-r.FB),n)||a;a&&f(t)},t.prototype.WM=function(t){var e,o,n=te(this.LM.KM),r=t.changedTouches,i=!1;for(e=0;e<r.length;e++)o=r[e],i=this.RM(o.identifier,new et(o.pageX-n.EB,o.pageY-n.FB))||i;i&&f(t)},t.prototype.XM=function(t){var e,o,n=te(this.LM.KM),r=t.changedTouches,i=!1;for(e=0;e<r.length;e++)o=r[e],i=this.TM(o.identifier,new et(o.pageX-n.EB,o.pageY-n.FB))||i;i&&f(t)},t.prototype.YM=function(t){var e,o,n=this.LM,r=this.ZM;n!==r&&(e=l(n.KM).offset(),o=l(r.KM).offset(),t.X+=e.left-o.left,t.Y+=e.top-o.top)},t.prototype.$M=function(t,e){var o,n,r,i,a,s=this,l=s.rM;for(s.ZM=y,s.yM=y,n=0;n<l.length;n++)if(l[n]===t){if(r=l[n],i=y,a=y,r._M&&!r._M()){for(n=0;n<l.length;n++)if((o=l[n])!==r&&o.aN>=0&&o.aN<r.aN&&(!o._M||o._M())){i=o;break}if(i===y)return!1}if(r.bN&&!r.bN()){for(n=0;n<l.length;n++)if((o=l[n])!==r&&o.aN>=0&&o.aN<r.aN&&(!o.bN||o.bN())){a=o;break}if(a===y)return!1}i===y&&(i=r),a===y&&(a=r),s.LM=r,s.ZM=i,s.cN=a,s.vM(a.dN||y),s.wM(i.eN||y),s.BM(i.fN||y),s.AM(i.gN||y),s.xM(i.hN||y),s.CM(a.iN||y),s.DM(a.jN||y),s.EM(a.kN||y),s.FM(i.GM||y),s.HM(i.IM||y),i.lN&&(s.yM=r.lN);break}return!0},t.prototype.NM=function(t,e,o,n,r){var i=this;return!(i.sM[o]!==C||0===i.sM.length&&!i.$M(t,e)||!i.ZM||!(i.sM.length>=i.ZM.mN)&&(i.yM&&i.yM.nN()||(i.YM(n),i.yM&&0===i.sM.length&&i.yM.oN(),i.sM[o]={id:o,time:qt(),position:n},i.sM.length++,i.tM.pN(e,o,n,r),i.tM.qN(o,n,i.sM.length,r),1===i.sM.length&&i.uM.qN(n),1===i.sM.length&&i.GM&&i.GM({rN:n}),0)))},t.prototype.aB=function(t,e,o){var n=this;return!(n.sM[t]===C||n.yM&&n.yM.sN()||(n.YM(e),n.sM[t]={id:t,time:qt(),position:e},n.tM.tN(t,e,o),0))},t.prototype.RM=function(t,e){var o=this;return o.sM[t]!==C&&(delete o.sM[t],o.sM.length--,!(o.yM&&o.yM.uN()||(o.YM(e),o.tM.vN(t),o.tM.wN(),0===o.sM.length&&(o.uM.vN(e),o.uM.wN()),0===o.sM.length&&o.IM&&o.IM({rN:e}),o.yM&&0===o.sM.length&&0===o.tM._process&&o.yM.zM(),0)))},t.prototype.TM=function(t,e){return this.RM(t,e)},t.prototype.xN=function(t,e){var o,i,s,u,c,f=this,h="."+t.OM,p=".gcSheet",d=D+p,g=F+p+h,m=E+p+h,y="MSPointerCancel"+p+h,C="MSLostPointerCapture"+p+h,v=j+p,b=P+p+h,w=L+p+h,T="LostPointerCapture"+p+h,S="pointercancel"+p+h,x=G+p,A=B+p,I=_+p,R="touchcancel"+p;function M(){l(q).unbind(g).unbind(b).unbind(m).unbind(w).unbind(y).unbind(S).unbind(C).unbind(T)}function k(e){l(q).bind(g,N).bind(m,V).bind(b,N).bind(w,V).bind(y,H).bind(C,H).bind(T,H).bind(S,H),f.MM(t,e)}function N(t){f.PM(t)}function V(t){f.QM(t),0===f.sM.length&&M()}function H(t){f.SM(t),0===f.sM.length&&M()}o=t.KM,i=f.rM,(s=n.Common.k.Cb(i,t))>=0&&e||s<0&&!e||(u=r.Ul._Va(),e?u?(c=o.style,a(c.msTouchAction)||(c.msTouchAction=O),a(c.touchAction)||(c.touchAction=O),l(o).bind(d,k).bind(v,k)):(l(o).bind(x,(function(e){f.UM(t,e)})),l(o).bind(A,(function(t){f.VM(t)})).bind(I,(function(t){f.WM(t)})).bind(R,(function(t){f.XM(t)}))):u?l(o).unbind(d).unbind(v):l(o).unbind(x).unbind(A).unbind(I).unbind(R),e?i.push(t):i.splice(s,1))},t.prototype.no=function(){var t,e=this.rM;for(t=e.length-1;t>=0;t--)this.xN(e[t],!1)},t}(),e.TouchEventProvider=Q,$=function(){function t(){var t=this;t.AN=0,t.BN=0,t.CN=1,t.DN=0,t.EN=0,t._process=0,t.FN=511,t.GN=new lt,t.HN=20,t.IN=new ot}return t.prototype.pN=function(t,e,o,n){var r,i=this;3===i._process&&i.JN(!0),i.KN=2===i._process&&1===i.GN.MN(),i.NN=t,(r={}).Np=e,r.ON=o,r.PN=o,i.GN.QN(r),i.RN=n,i.GN.MN()>1&&(i.SN=!1,i.TN=!1,1===i._process&&i.UN())},t.prototype.qN=function(t,e,o,n){0===this._process&&1===o&&this.VN(this.GN.WN(0).PN)},t.prototype.tN=function(t,e,o){var n,r,i,a,s,l,u,c=this;if(0!==c.FN&&c.GN.XN(t)){if(1===c._process&&1===c.GN.MN()){if(n=c.YN(),!c.ZN(1)&&!c.ZN(2)&&!n)return;if(Jt(e,r=c.GN.$N(t).PN))return;i=v(e.X-r.X),a=v(e.Y-r.Y),c._N(i,a)}if(!(o-c.RN<20)){if(c.GN.$N(t).aO=e,(s=c.GN.MN())>1)for(l=0;l<s;l++)if(!(u=c.GN.WN(l)).aO)return;for(c.bO(o),c.RN=o,s=c.GN.MN(),l=0;l<s;l++)(u=c.GN.WN(l)).ON=u.aO,u.aO=y}}},t.prototype.wN=function(){var t=this;t.cO&&(t.dO(t.cO),t.cO=y)},t.prototype.vN=function(t){var e=this;e.GN.XN(t)&&(e.GN.eO(t),2===e._process?0===e.GN.MN()&&(e.ZN(64)||e.ZN(256)||e.ZN(128)?e.fO():e.JN(!0)):3===e._process?e.JN(!0):1===e._process&&e.JN(!1))},t.prototype.bO=function(t){var e,o,n,r,i=this,a=i.gO(),s=a.hO,l=a.iO,u=a.SH,c=i.jO(),f=c.kO,h=c.eb,p=c.lO;if(i.AN+=s,i.BN+=l,i.CN*=h,i.DN+=f,i.EN+=p,(e={}).lO=p,e.kO=f,e.mO=t-i.RN,e.hO=s,e.iO=l,i.IN.nO(e),i.oO=u,1===i._process||2===i._process){if(1===i._process&&i.UN())return;if((o=new st).pO=p,o.qO=f,o.rO=h,o.sO=new et(s,l),n=new nt(i.IN),r=new ft(i.NN,i.tO(),o,!1,u,n),i.uO(r),r.vO)return void i.JN(!0)}},t.prototype.UN=function(){var t,e=this;return e._process=2,t=new pt(e.NN,e.GN.MN(),e.tO(),e.GN.WN(0).PN),e.wO(t),!!t.vO&&(e.JN(!0),!0)},t.prototype._N=function(t,e){var o=function(t,e){var o,n=!1,r=!1;return 0!==t&&(o=R(e/t)/x*180)<20&&(n=!0),(0===t||(o=R(e/t)/x*180)>75&&o<105)&&(r=!0),{yN:n,zN:r}}(t,e);this.SN=o.yN,this.TN=o.zN},t.prototype.gO=function(){var t=this.xO(),e=t.yO,o=t.zO,n=new et(e.X,e.Y);return{hO:e.X-o.X,iO:e.Y-o.Y,SH:n}},t.prototype.jO=function(){var t,e=this,o=0,n=1,r=0;return e.ZN(16)&&1===e.GN.MN()&&e.YN()&&(o=function(t,e,o){var n=new et(o._Center.X,o._Center.Y),r=new et(e.X-n.X,e.Y-n.Y),i=new et(t.X-n.X,t.Y-n.Y),a=b(1,T(oe(e,n)/o._Radius,4)),s=ee(r,i);return H(s)?0:s*a}(e.GN.WN(0).aO,e.GN.WN(0).ON,e.AO)),e.GN.MN()>1&&(o=(t=e.BO()).kO,n=t.eb,r=t.lO),{kO:o=o/x*180,eb:n,lO:r}},t.prototype.BO=function(){var t,e,o,n,r,i,a,s,l,u,c=this,f=c.xO(),h=f.yO,p=f.zO,d=c.YN(),g=d?c.AO._Center:new et(0,0),m=0,y=1,C=0,v=0,b=0,w=0,T=0,S=c.GN.MN();for(t=0;t<S;t++)o=(e=c.GN.WN(t)).aO,n=e.ON,r=oe(o,h),i=oe(n,p),a=d?new et(n.X-g.X,n.Y-g.Y):new et(n.X-p.X,n.Y-p.Y),s=d?new et(o.X-g.X,o.Y-g.Y):new et(o.X-h.X,o.Y-h.Y),l=oe(n,g),u=oe(o,g),i>=c.HN&&r>=c.HN&&(b++,w+=r,T+=i,(!d||l>=c.HN)&&u>=c.HN&&(m+=ee(a,s),v++));return v>0&&c.ZN(16)?m/=v:m=0,b>0&&c.ZN(32)?(c.KN||(y=w/T),C=(w-T)/b,c.CO=w/b):c.CO=0,{kO:m,eb:y,lO:C}},t.prototype.ZN=function(t){return 0!=(this.FN&t)},t.prototype.xO=function(){var t,e,o,n,r,i=0,a=0,s=0,l=0,u=this.GN,c=u.MN();for(t=0;t<c;t++)o=(e=u.WN(t)).ON,n=e.aO,i+=o.X,a+=o.Y,s+=n.X,l+=n.Y;return r=new et(i/c,a/c),{yO:new et(s/c,l/c),zO:r}},t.prototype.YN=function(){var t=this.AO;return t&&!H(t._Radius)},t.prototype.VN=function(t){var e=this,o=new dt(e.NN,e.FN,y,t);return o.DO=511,e.EO(o),e.FO=o.DO,0===o.DO?(e.JN(!1),!1):(e.FN=o.DO,e.AO=o.GO,e._process=1,!0)},t.prototype.JN=function(t){var e,o=this,n=3===o._process;o._process=0,o.HO&&(Wt(o.HO),o.HO=y),t&&(e=new ct(o.NN,o.tO(),n,re(o.oO),new nt(o.IN)),3===o._process?o.cO=e:o.dO(e)),o.IN.IO(),o.GN.IO(),o.AO=y,o.AN=0,o.BN=0,o.CN=1,o.DN=0,o.EN=0,o.SN=!1,o.TN=!1,o.FN=0},t.prototype.fO=function(){var t,e,o=this,n={},r=new nt(o.IN);return n.JO=o.ZN(64)?r.KO().X:0,n.LO=o.ZN(64)?r.KO().Y:0,n.MO=o.ZN(256)?r.pO():0,n.NO=o.ZN(128)?r.OO():0,0===n.JO&&0===n.LO&&0===n.MO&&0===n.NO?void o.JN(!0):(n.PO=new at(n.JO,n.LO),n.QO=new rt(n.MO),n.RO=new it(n.NO),r=new nt(y,n.JO,n.LO,n.NO,n.MO),t=new ht(o.NN,o.tO(),new st,r,n.QO,n.RO,n.PO),o.SO(t),n.PO=t.TO,n.QO=t.QO,n.RO=t.RO,n.PO.UO<=0&&n.PO.VO<=0&&n.PO.WO(.003),n.QO.XO()<=0&&n.QO.WO(.002),n.RO.XO()<=0&&n.RO.WO(.003),e=qt(),n.YO=e,n.ZO=e,n.$O=0,n._O=0,o._process=3,void(o.HO=W.setInterval((function(){try{o.aP(n)}catch(t){}}),20)))},t.prototype.aP=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d=this,g=qt(),m=g-t.ZO;if(0!==m){if(e=t.JO,o=t.LO,n=t.MO,r=t.NO,t.JO=d.bP(m,t.PO.UO,t.JO),t.LO=d.bP(m,t.PO.VO,t.LO),t.MO=d.bP(m,t.QO.XO(),t.MO),t.NO=d.bP(m,t.RO.XO(),t.NO),e=(e+t.JO)/2,o=(o+t.LO)/2,n=(n+t.MO)/2,r=(r+t.NO)/2,t.ZO=g,i=!1,ne(e)&&ne(o)&&ne(n)&&ne(r)&&(i=!0),a=m*e,s=m*o,l=m*n,u=m*r,c=1,d.CO>0&&(d.CO+2*l<0&&(l=-d.CO/2+1),0!==d.CO&&(c=(d.CO+2*l)/d.CO)),d.EN+=l,d.DN+=u,d.AN+=a,d.BN+=s,d.CN*=c,d.CO+=l,d.oO=new et(d.oO.X+a,d.oO.Y+s),t.$O+=a,t._O+=s,i){if(a=A(t.$O),s=A(t._O),ne(a)&&ne(s))return void d.JN(!0)}else v(t.$O)>=1&&(a=t.$O,t.$O-=a),v(t._O)>=1&&(s=t._O,t._O-=s);return(f=new st).sO=new et(a,s),f.rO=c,f.pO=l,f.qO=u,h=new nt(y,t.JO,t.LO,t.NO,t.MO),p=new ft(d.NN,d.tO(),f,!0,re(d.oO),h),d.uO(p),p.vO?void d.JN(!0):void(i&&d.JN(!0))}},t.prototype.bP=function(t,e,o){return ne(o)?0:(((n=o<0?o+e*t:o-e*t)<0&&o>0||n>0&&o<0)&&(n=0),n);var n},t.prototype.tO=function(){var t=this,e=new st;return e.pO=t.EN,e.qO=t.DN,e.rO=t.CN,e.sO=new et(t.AN,t.BN),e},t.prototype.cP=function(t,e,o,n){var r,i=this,a=new st,s=new st,l=0,u=0,c=0,f=0,h=i.ZN(4)&&i.SN,p=i.ZN(8)&&i.TN;return!i.ZN(1)||p||t&&!i.ZN(64)||(a.sO.X=e.sO.X,s.sO.X=o.sO.X,l=n.KO().X),!i.ZN(2)||h||t&&!i.ZN(64)||(a.sO.Y=e.sO.Y,s.sO.Y=o.sO.Y,u=n.KO().Y),!i.ZN(32)||t&&!i.ZN(256)?(a.rO=e.rO,s.rO=1):(a.rO=e.rO,a.pO=e.pO,s.rO=o.rO,s.pO=o.pO,f=n.pO()),!i.ZN(16)||t&&!i.ZN(128)||(a.qO=e.qO,s.qO=o.qO,c=n.OO()),r=new nt(y,l,u,c,f),new ut(a,s,r)},t.prototype.EO=function(t){this.vM&&t&&this.vM(t)},t.prototype.wO=function(t){this.wM&&t&&this.wM(t)},t.prototype.dO=function(t){var e,o=this;o.xM&&t&&(e=o.cP(!1,t.dP,t.dP,t.eP),t.dP=e.dP,t.eP=e.eP,o.xM(t))},t.prototype.SO=function(t){var e,o=this;o.AM&&t&&(e=o.cP(!1,t.dP,t.fP,t.eP),t.dP=e.dP,t.fP=e.fP,t.eP=e.eP,o.AM(t))},t.prototype.uO=function(t){var e,o=this;o.BM&&t&&(e=o.cP(t.gP,t.dP,t.fP,t.eP),t.dP=e.dP,t.fP=e.fP,t.eP=e.eP,o.BM(t))},t}(),tt=function(){function t(){}return t.prototype.qN=function(t){var e,o=this;o._pointerCount++,o._pointerCount>1||(e=qt(),o.hP&&Jt(t,o.hP)&&e-o.iP<400?o.Jb++:(o.hP=t,o.Jb=1),o.jP=t,o.iP=e)},t.prototype.wN=function(){var t=this;t.cO&&(t.cO instanceof gt?t.kP(t.cO):t.cO instanceof mt&&t.lP(t.cO),t.cO=y)},t.prototype.vN=function(t){var e,o=this;o._pointerCount--,o._pointerCount>0||(e=qt(),Jt(t,o.jP)?e-o.iP>1e3?o.cO=new mt(o.jP):o.Jb>1?(o.Jb=0,o.mP(new yt(o.hP)),o.hP=y):o.cO=new gt(o.jP):o.hP=y)},t.prototype.nP=function(){this.hP=y},t.prototype.kP=function(t){this.CM&&t&&this.CM(t)},t.prototype.mP=function(t){this.DM&&t&&this.DM(t)},t.prototype.lP=function(t){this.EM&&t&&this.EM(t)},t}(),et=function(t,e){this.X=t,this.Y=e},e.oP=et,ot=function(){function t(){var t=this;t.Jb=0,t.oI=0,t.pP=10,t.qP=[]}return t.prototype.rP=function(t){var e,o,n,r,i,a,s=this;if(0===s.Jb)return 0;for(e=0,o=(1+s.Jb)*s.Jb/2,n=s.Jb-1;n>=0;n--)r=0,i=s.sP(n),0===t?r=i.hO:1===t?r=i.iO:2===t?r=i.lO:3===t&&(r=i.kO),a=s.tP(r,i.mO),e+=a*=n+1;return e/o},t.prototype.tP=function(t,e){return t/e},t.prototype.sP=function(t){return this.qP[this.uP(t)]},t.prototype.vP=function(){return this.qP[this.Jb-1]},t.prototype.nO=function(t){var e,o,n=this;for(10===n.Jb&&n.wP(),n.Jb++,n.qP[n.uP(n.Jb-1)]=t,e=20*n.pP,o=0;o<n.Jb;o++)t.mO-n.qP[o].mO>e&&(n.wP(),o--)},t.prototype.wP=function(){var t=this;t.oI++,t.oI===t.pP&&(t.oI=0),t.Jb--},t.prototype.IO=function(){this.Jb=0},t.prototype.uP=function(t){return(this.oI+t)%this.pP},t}(),nt=function(){function t(t,e,o,n,r){var i=this;t?i.qP=t:(i.xP=new et(e,o),i.yP=n,i.lO=r)}return t.prototype.KO=function(){var t=this;return t.xP||(t.xP=new et(t.qP.rP(0),t.qP.rP(1))),t.xP},t.prototype.OO=function(){var t=this;return a(t.yP)&&(t.yP=t.qP.rP(3)),t.yP},t.prototype.pO=function(){var t=this;return a(t.lO)&&(t.lO=t.qP.rP(2)),t.lO},t}(),rt=function(){function t(t){this.zP=t,this.AP=0}return t.prototype.XO=function(){var t=this,e=t._DesiredExpansion,o=t._DesiredDeceleration,n=t.zP;return H(e)||0===e?H(o)?t.AP:o:.5*n*n/e},t.prototype.WO=function(t){this.AP=t},t}(),it=function(){function t(t){this.zP=t,this.AP=0}return t.prototype.XO=function(){var t=this,e=t._DesiredRotation,o=t._DesiredDeceleration,n=t.zP;return H(e)||0===e?H(o)?t.AP:o:.5*n*n/e},t.prototype.WO=function(t){this.AP=t},t}(),at=function(){function t(t,e){var o=this;o.BP=t,o.CP=e,o.UO=0,o.VO=0,o.AP=0,o.DP=I(t*t+e*e)}return t.prototype.EP=function(){var t=this,e=t._DesiredDisplacement,o=t.DP,n=t.BP,r=t.CP,i=t.XO();H(e)||0===e?H(i)||0===i?(t.UO=0,t.VO=0):(t.UO=i*v(n)/o,t.VO=i*v(r)/o):(t.UO=.5*o*v(n)/e,t.VO=.5*o*v(r)/e)},t.prototype.XO=function(){var t=this,e=t._DesiredDeceleration;return H(e)&&H(t._DesiredDisplacement)?t.AP:e},t.prototype.WO=function(t){this.AP=t,this.EP()},t}(),st=function(){var t=this;t.sO=new et(0,0),t.rO=0,t.qO=0,t.pO=0},lt=function(){function t(){this.FP=[]}return t.prototype.XN=function(t){var e,o=this.FP;for(e=0;e<o.length;e++)if(o[e].Np===t)return!0;return!1},t.prototype.QN=function(t){this.FP.push(t)},t.prototype.eO=function(t){var e,o=this.FP;for(e=0;e<o.length;e++)if(o[e].Np===t){o.splice(e,1);break}},t.prototype.MN=function(){return this.FP.length},t.prototype.WN=function(t){return this.FP[t]},t.prototype.$N=function(t){var e,o,n=this.FP;for(e=0;e<n.length;e++)if((o=n[e]).Np===t)return o;return y},t.prototype.IO=function(){var t=this.FP;t.splice(0,t.length)},t}(),ut=function(t,e,o){var n=this;n.dP=t,n.fP=e,n.eP=o},ct=function(t,e,o,n,r){var i=this;i.GP=t,i.dP=e,i.gP=o,i.rN=n,i.eP=r},e.ManipulationCompletedEventArgs=ct,ft=function(t,e,o,n,r,i){var a=this;a.GP=t,a.dP=e,a.fP=o,a.gP=n,a.rN=r,a.eP=i},e.ManipulationDeltaEventArgs=ft,ht=function(t,e,o,n,r,i,a){var s=this;s.GP=t,s.dP=e,s.fP=o,s.eP=n,s.QO=r,s.RO=i,s.TO=a},pt=function(t,e,o,n){var r=this;r.GP=t,r.HP=e,r.dP=o,r.rN=n},e.ManipulationStartedEventArgs=pt,dt=function(t,e,o,n){var r=this;r.GP=t,r.DO=e,r.GO=o,r.rN=n},e.ManipulationStartingEventArgs=dt,gt=function(t){this.rN=t},mt=function(t){this.rN=t},yt=function(t){this.rN=t},Ct=function(){function t(t){this.kj=t}return t.prototype.IP=function(t,e){var o=this.Xs;return o?t===r.En.Nn(o)&&e===r.En.On(o)||r.En.Pn(o,t,e):(o=c("canvas"),r.En.Kn(o,y,this.kj),r.En.Pn(o,t,e)),o},t.prototype.JP=function(t,e,o,n){var i=this,a=r.En.Nn(t),s=r.En.On(t),l=i.IP(a,s),u=l.getContext("2d"),c=r.En.Ln(l),f=r.En.Mn(l);r.Bn.Cn(u,1,1),u.drawImage(t,0,0,Ut(l),zt(l),0,0,Ut(l),zt(l)),r.Bn.Cn(u,c,f),i.Xs=l,i.KP=e,i.LP=o,i.MP=n},t.prototype.NP=function(t,e,o){var n,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=r.En.Nn(t),C=r.En.On(t),v=Yt(g),b=Kt(g),w=v>0?1:0,T=b>0?1:0,S=d.LP,x=he(g),A=d.KP,I=g.am(),R=e/d.MP,M=t.getContext("2d"),k=r.En.Ln(t),N=r.En.Mn(t),O=d.Xs;M.save(),M.fillStyle=o,M.fillRect(0,0,m,C),h=g.rowOutlines,p=g.columnOutlines,h&&h.jp(g,M,y,!0),p&&p.jp(g,M,y,!1),n=S.x+Ut(S),i=S.y+zt(S),a=A.lt-n-w,s=A.ot-i-T,l=x.x+Ut(x),u=x.y+zt(x),c=a*R,f=s*R,n*=k,i*=N,a*=k,s*=N,l*=k,u*=N,c*=k,f*=N,r.Bn.Cn(M,1,1),M.drawImage(O,n,i,a,s,l,u,c,f),v>0&&(n=A.lt-w,i=S.y+zt(S),a=A.js+w,s=A.ot-i-T,l=I.lt-w,u=x.y+zt(x),c=I.js+w,f=s*R,n*=k,i*=N,a*=k,s*=N,l*=k,u*=N,c*=k,f*=N,M.drawImage(O,n,i,a,s,l,u,c,f)),b>0&&(n=S.x+Ut(S),i=A.ot-T,a=A.lt-n-w,s=A.gs+T,l=x.x+Ut(x),u=I.ot-T,c=a*R,f=I.gs+T,n*=k,i*=N,a*=k,s*=N,l*=k,u*=N,c*=k,f*=N,M.drawImage(O,n,i,a,s,l,u,c,f)),v>0&&b>0&&(n=A.lt-w,i=A.ot-T,a=A.js+w,s=A.gs+T,l=I.lt-w,u=I.ot-T,c=I.js+w,f=I.gs+T,n*=k,i*=N,a*=k,s*=N,l*=k,u*=N,c*=k,f*=N,M.drawImage(O,n,i,a,s,l,u,c,f)),r.Bn.Cn(M,k,N),M.restore()},t.prototype.OP=function(){var t=this.kj,e=t.zoom(),o=t.yl.vI();o&&this.JP(o.canvas,t.am(),he(t),e)},t.prototype.PP=function(t){var e,o,n,i,a,s,l=this,u=l.kj;if(u.endEdit()&&(e=ie(t,l.MP),o=u.zoom(),n=u.name(),o!==e)){if(i={sheet:u,sheetName:n,oldZoomFactor:o,newZoomFactor:e,cancel:!1},u.Wq(r.Events.ViewZooming,i),i&&!0===i.cancel)return;e=i.newZoomFactor,u.XSa(e),u.Wq(r.Events.UserZooming,{sheet:u,sheetName:n,oldZoomFactor:o,newZoomFactor:e}),u.Wq(r.Events.ViewZoomed,{sheet:u,sheetName:n,oldZoomFactor:o,newZoomFactor:e}),u.invalidateLayout(),(s=(a=u.yl).bm())&&l.NP(s.canvas,e,a.zI(!1)),u.QP&&u.QP(y,e),u.RP&&u.RP(y)}},t.prototype.SP=function(t){var e,o=this.kj,n=o.name(),i=ie(t,this.MP),a=o.zoom();if(i!==a){if(e={sheet:o,sheetName:n,oldZoomFactor:a,newZoomFactor:i,cancel:!1},o.Wq(r.Events.ViewZooming,e),e&&!0===e.cancel)return;i=e.newZoomFactor,o.XSa(i),o.Wq(r.Events.UserZooming,{sheet:o,sheetName:n,oldZoomFactor:a,newZoomFactor:i}),o.Wq(r.Events.ViewZoomed,{sheet:o,sheetName:n,oldZoomFactor:a,newZoomFactor:i})}o.oq=!0,o.jq=!0,o.$p()},t}(),e.TP=Ct,vt=200,bt=function(){function t(t){this.kj=t}return t.prototype.VP=function(t){this.kj.eCb=t},t.prototype.WP=function(t){this.kj.cCb=t},t.prototype.XP=function(){this.kj.invalidateLayout()},t.prototype.ju=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,C,w,T,S,x,A,I,R,M,k=this,N=k.kj,O=N.options,D=function(t,e,o){var n,r,i=o,a=0,s=0,l=t.ss,u=t.am().qt,c=t.jt(1).findRow(i);if(c)if(e>0){for(n=t.Rt(-1),a=u-c.y;i>n&&a<e;)i--,a+=l.Sl(i);s=e-a}else if(e<0){for(r=t.ns(),a=-(c.y+zt(c)-u);i<r&&a>e;)i++,a-=l.Sl(i);s=e-a}return{cj:i,UP:s}}(N,t,N.lq),F=D.cj,E=D.UP;if(N.lq=F,N.Xq>0)return!1;if(i=N.Dr(),s=(a=N.am()).qt,l=N.oKc(a),u=a.gs,c=a.ot,f=a.pKc,h=i?i.x:a.x,p=Ut(a),y=O.sheetAreaOffset,C=N.qKc,p+=y.left,t<0)k.YP=0,k.ZP=0,w=void 0,T=void 0,(S=N.jt(1))&&S.length>0&&(w=S.findRow(F)),w&&((T=S[S.length-1]).row>=F&&(d=2+y.top,g=s+v(t),(m=b(s+l,T.y+zt(T))-g)>=0&&(m-=d,k.WP(E-zt(w)),o.x=h,o.y=g,o.width=p,o.height=m,o.tx=h,o.ty=s,x=C?l:l+u+f,n.x=h,n.y=s+m,n.width=p,n.height=x-m)));else if(t>0){if(A=N.Rt(-1),I=void 0,R=void 0,N.parent&&N.parent.options.scrollByPixel&&E>0&&(t-=E,E=0),F===A&&E>0)if(k.YP>0&&k.ZP>0){if(E=R=ae(I=k.YP+t,vt),(t=R-k.ZP)<=0)return e;if(e&&R>=20)return!0;k.YP=I,k.ZP=R}else{if(E>=vt&&(t-=E-199,E=199,t<=0))return e;if(I=se(E,vt),R=E,e&&R>=20)return!0;k.YP=I,k.ZP=R}else k.YP=0,k.ZP=0;t<(C?l:l+u)&&(d=2+y.top,g=s,m=l-t,Kt(N)>0&&(m-=1),k.WP(E),!C&&f>0&&(M=b(i.height-u-1,c-1+t),r.x=h,r.y=c-1,r.width=p,r.height=u+1,r.tx=h,r.ty=M),o.x=h,o.y=g,o.width=p,o.height=m+(C?0:b(t,f)-1),o.tx=h,o.ty=g+t,n.x=h,n.y=g,n.width=p,n.height=t+d)}return!1},t.prototype.lu=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,C,w,T,S,x,A,I,R,M,k,N=this,O=N.kj,D=function(t,e,o){var n,r,i=o,a=0,s=0,l=t.ss,u=t.am().pt,c=t.it(1).findCol(i);if(c)if(e>0){for(n=t.Ot(-1),a=u-c.x;i>n&&a<e;)i--,a+=l._m(i);s=e-a}else if(e<0){for(r=t.ps(),a=-(c.x+Ut(c)-u);i<r&&a>e;)i++,a-=l._m(i);s=e-a}return{dj:i,UP:s}}(O,t,O.qq),F=D.dj,E=D.UP;if(O.qq=F,O.Xq>0)return!1;if(i=O.Dr(),s=(a=O.am()).pt,l=O.rKc(a),u=a.js,c=a.lt,f=a.sKc,h=i?i.y:a.y,p=zt(a),w=O.options.sheetAreaOffset,T=O.tKc,p+=w.top,t<0)N.$P=0,N._P=0,S=void 0,x=void 0,(A=O.it(1))&&A.length>0&&(S=A.findCol(F)),S&&((x=A[A.length-1]).col>=F&&(d=2+w.left,g=s+v(t),(m=b(s+l,x.x+Ut(x))-g)>=0&&(m-=d,N.VP(E-Ut(S)),o.x=g,o.y=h,o.width=m,o.height=p,o.tx=s,o.ty=h,I=T?l:l+u+f,n.x=s+m,n.y=h,n.width=I-m,n.height=p)));else if(t>0){if(R=O.Ot(-1),O.parent&&O.parent.options.scrollByPixel&&E>0&&(t-=E,E=0),F===R&&E>0)if(N.$P>0&&N._P>0){if(E=C=ae(y=N.$P+t,vt),(t=C-N._P)<=0)return e;if(e&&C>=20)return!0;N.$P=y,N._P=C}else{if(E>=vt&&(t-=E-199,E=199,t<=0))return e;if(y=se(E,vt),C=E,e&&C>=20)return!0;N.$P=y,N._P=C}else N.$P=0,N._P=0;t<(T?l:l+u)&&(d=2+w.left,g=s,m=l-t,Yt(O)>0&&(m-=1),N.VP(E),M=0,!T&&f>0&&(M=u,k=b(i.width-M-1,c-1+t),r.x=c-1,r.y=h,r.width=M+1,r.height=p,r.tx=k,r.ty=h),o.x=g,o.y=h,o.width=m+(T?0:b(t,f)-1),o.height=p,o.tx=g+t,o.ty=h,n.x=g,n.y=h,n.width=t+d,n.height=p)}return!1},t.prototype.aQ=function(t,e,o,n){var i,s,l,u,c,f,h,p,d,g,m,y,C,v,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V=this,H=V.kj,z=!0,U=!0,W=H.yl,q=W.bm(),J=0!=(2&o),X=0!=(1&o);if(X||J)return c={},f={},h=H.Dr(),p=H.am(),d=h?h.y:p.y,g=zt(p),m=h?h.x:p.x,y=Ut(p),J&&(s={},i={},z=V.ju(e,n,i,s,c),C=c.x,v=c.y,T=Ut(c),S=zt(c),x=c.tx,A=c.ty,a(C)||W.Ow(C,v,T,S,x,A),W.Ow(i.x,i.y,Ut(i),zt(i),i.tx,i.ty)),X&&(l={},u={},U=V.lu(t,n,l,u,f),I=f.x,R=f.y,M=Ut(f),k=zt(f),N=f.tx,O=f.ty,a(I)||W.Ow(I,R,M,k,N,O),W.Ow(l.x,l.y,Ut(l),zt(l),l.tx,l.ty),J||(s=u)),(D=H.parent)&&!D.options.scrollbarShowMax&&(X&&(H.oq=!0),J&&(H.jq=!0)),V.XP(),F=H.rowOutlines&&!H.rowOutlines.iT()?1:0,E=H.columnOutlines&&!H.columnOutlines.iT()?1:0,X&&J?W._l(q,new r.Rect(s.x,s.y,Ut(s),zt(s)+F),new r.Rect(u.x,u.y,Ut(u)+E,zt(u))):W._l(q,new r.Rect(s.x,s.y,Ut(s)+E,zt(s)+F)),j=new r.Rect(m,d,y,g),(P=H.getSelections())&&P.length>0&&(L=H.getRangeRect(1,1,P[0]),G=w(j.x+j.width,L.x+L.width),B=w(j.y+j.height,L.y+L.height),j.x=b(j.x,L.x),j.y=b(j.y,L.y),j.width=G-j.x+1,j.height=B-j.y+1),W.Pw(q,j),function(t,e){var o,n,i,a,s,l=t.am(),u=t.yl,c=t.options.gridline.color,f=r.Im.Km(0,"gc-columnHeader-normal"),h=f&&f.borderBottomColor,p=u.bm(),d=t.jt(1),g=he(t),m=l.zr,y=Ut(l),C=t.Rt(-1),v=d.findRow(C);v&&(o=l.qt,(n=v.y-o)>0&&(fe(p,c,m,v.y-.5,m+y-g.width,v.y-.5),e&&(0===g.width&&fe(p,c,l.zr-.5,o,l.zr-.5,v.y),fe(p,h,l.kt-.5,o,l.kt-.5,v.y)))),i=t.it(1),o=l.Ar,n=zt(l),a=t.Ot(-1),(s=i.findCol(a))&&(m=l.pt,(y=s.x-m)>0&&(fe(p,c,s.x-.5,o,s.x-.5,o+n-g.height),e&&(0===g.height&&fe(p,c,m,l.Ar-.5,s.x,l.Ar-.5),fe(p,h,m,l.nt-.5,s.x,l.nt-.5))))}(H,!0),function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p=t.am(),d=t.yl,g=t.options.sheetAreaOffset,m=g.left,y=g.top,C=d.zI(!1),v=d.bm(),b=d.vI(),w=t.jt(1),T=he(t),S=p.$Lc,x=p.sKc,A=p._Lc,I=p.pKc,R=p.zr,M=m>=1?1:0,k=y>=1?1:0,N=Ut(p);v.save(),b.save(),r=t.Rt(-1),(i=w.findRow(r))&&(o=p.qt,(n=i.y-o-1-k)>0&&(e?(a=p.Br,le(v,s=ce(),R,o,a-1,n+1),le(b,s,R,o,a-1,n+1),le(v,C,R+a,o,N-a-T.width,n),le(b,C,R+a,o,N-a-T.width,n)):(le(v,C,R,o,N,n),le(b,C,R,o,N,n)))),I>1&&(le(v,C,R,A,N,n=I-1-k),le(b,C,R,A,N,n)),l=t.it(1),o=p.Ar,n=zt(p),u=t.Ot(-1),(c=l.findCol(u))&&(R=p.pt,(N=c.x-R-1-M)>0&&(e?(le(v,h=ue(v,R,o,N+1,(f=p.Cr)-1),R,o,N+1,f-1),le(b,h,R,o,N+1,f-1),le(v,C,R,o+f,N,n-f-T.height),le(b,C,R,o+f,N,n-f-T.height)):(le(v,C,R,o,N,n),le(b,C,R,o,N,n)))),x>1&&(le(v,C,S,o,N=x-1-M,n),le(b,C,S,o,N,n)),b.restore(),v.restore()}(H,!0),V.bQ(X,J),pe(H,!0),_=H.options.sheetAreaOffset,H.options.rowHeaderVisible||W.B0a(q,new r.Rect(m,d,2,g+_.top)),H.options.colHeaderVisible||W.B0a(q,new r.Rect(m,d,y+_.left,2)),z&&U},t.prototype.bQ=function(t,e){var o,n=this.kj;e&&n.os(),t&&n.qs(),n.mm.Qw(),(o=n.ITa.Ky)&&o.cQ()},t.prototype.dQ=function(t,e,o){function n(t,e,o,n){return T(.75,t/=o)*n*(e?1:-1)}function r(t,e,o){return t=v(t),M(t/=o)/M(.75)*e}var i=this,a=i.kj,s=vt,l=100,u=r(t,10,s),c=r(e,10,s),f=t,h=e,p=0,d=0,g=!1,m=!1;i.jI=W.setInterval((function(){var r,C,v,b,w;return g&&m?(a.ss.jn(),(r=a.parent)&&!r.options.scrollbarShowMax&&(a.oq=!0,a.jq=!0),a.ss.kn(),a.cCb=0,a.eCb=0,a.$p(),a.qs(),a.os(),Wt(i.jI),void(i.jI=y)):(c+=20,void((u+=20)>l&&c>l?(i.aQ(t-p,e-d,de(g,m),o),g=!0,m=!0):(u>l&&!g&&(i.aQ(t-p,0,1,o),g=!0),c>l&&!m&&(i.aQ(0,e-d,2,o),m=!0),C=n(u,t>0,10,s),v=n(c,e>0,10,s),b=k(f-C),w=k(h-v),i.aQ(b,w,de(g,m),o),f=C,h=v,p+=b,d+=w)))}),20)},t.prototype.qG=function(t){var e=this,o=e.kj,n=o.ss;e.jI&&(n.kn(),Wt(e.jI),e.jI=y),e.$P=0,e._P=0,e.YP=0,e.ZP=0,e.eQ=o.lq,e.fQ=o.qq,t&&n.hn()},t.prototype.NG=function(t,e){var o=this.kj.parent,n=o.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,i=o.nKc,a=o.kKc,s=o.ku,l=z(t.X+""),u=z(t.Y+""),c=function(t,e){var o=0;return(o|=0!==t?1:0)|(0!==e?2:0)}(l,u);return n&&(0!==u&&(i.Jwa(r.ScrollbarState.show),s.Rdc(!0)),0!==l&&(a.Jwa(r.ScrollbarState.show),s.Rdc(!1))),this.aQ(l,u,c,e)},t.prototype.gQ=function(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=d.eQ,y=g.lq,C=d.fQ,v=g.qq;return g.parent&&g.parent.options.scrollByPixel?(g.ss.kn(),g.$p(),void d.kXc()):(o=(e=g.am()).pt,n=e.qt,r=g.it(1),a=g.ps(),s=1,r&&r.length>0&&(i=r.findCol(v),v<a&&i&&i.x+Ut(i)-o<Ut(i)/2?v++:s=-1),l=g.jt(1),c=g.ns(),f=1,l&&l.length>0&&(u=l.findRow(y),y<c&&u&&u.y+zt(u)-n<zt(u)/2?y++:f=-1),h=0,p=0,r&&r.length>0&&(h=o-(i=r.findCol(v)).x),l&&l.length>0&&(p=n-(u=l.findRow(y)).y),y!==m&&g.mq(y,0,m),v!==C&&g.rq(v,0,C),h*=s,p*=f,void d.dQ(h,p,t))},t.prototype.kXc=function(){var t=this,e=t.kj,o=t.eQ,n=e.lq,i=t.fQ,a=e.qq;o!==n&&e.Wq(r.Events.TopRowChanged,{sheet:e,sheetName:e.name(),oldTopRow:o,newTopRow:n}),i!==a&&e.Wq(r.Events.LeftColumnChanged,{sheet:e,sheetName:e.name(),oldLeftCol:i,newLeftCol:a})},t}(),wt=function(){function t(t){var e=this;e.KN=!1,e.hQ=new Ct(t),e.iQ=new bt(t),e.kj=t}return t.prototype.jQ=function(t){var e=this.kj,o=e.am(),n=o.pt,r=o.qt,i=o.$Lc,a=o._Lc,s=o.lt,l=o.ot,u=t.rN,c=e.qKc,f=e.tKc,h=0,p=this.kQ(u.X,u.Y),d=p.dragInfo,g=p.x,m=p.y;p&&(p.resizeInfo||d&&"corner"===d.side||p.selectionHitInfo)?(h|=2,h|=1):(r<=m&&(c&&m<l||!c&&m<a)&&(h|=2),n<=g&&(f&&g<s||!f&&g<i)&&(h|=1),h|=96,e.parent&&(h|=12)),t.DO=h},t.prototype.lQ=function(e){var o,n,r,i,a,s,l,u,c,f,h,p,d=this,g={e:e,r:y};if(t.ao(d,"preProcessManipulationStarted",g),!g.r)if(o=e.rN,r=(n=d.kj).parent,i=n.mm,a=n.yl,l=(s=d.kQ(o.X,o.Y)).dragInfo,u=s.selectionHitInfo,n.yt=s,s.resizeInfo){if(!n.endEdit())return;i.fG(s)}else if(l&&"corner"===l.side)i.hG&&i.hG(s);else if(u){if(!n.endEdit())return;c=u.isHeader,f=u.isFirstIndicator,h=u.type,c&&i.ZG(s,!0),p=s.hitTestType,s.hitTestType=h,i.bH(s),s.hitTestType=p,function(t,e,o,n){var r,i,a,s;e||(i=(r=Zt(t))[r.length-1],a=t.Jl,s=t.Kl,o?3===n?(t.Jl=i.row+i.rowCount-1,t.Kl=i.col+i.colCount-1):2===n?(t.Jl=i.row+i.rowCount-1,t.Kl=0):1===n&&(t.Jl=0,t.Kl=i.col+i.colCount-1):3===n?(t.Jl=i.row,t.Kl=i.col):2===n?(t.Jl=i.row,t.Kl=0):1===n&&(t.Jl=0,t.Kl=i.col),ye(t,a,s,t.Jl,t.Kl))}(n,c,f,h),n.mQ=!1,a.DH()}else n.nQ&&(n.nQ().oQ=!1),n.mQ=!1,a.DH(),e.HP>1&&r&&r.options.allowUserZoom?(d.KN=!1,d.hQ.OP()):(d.KN=!0,d.iQ.qG(1===e.HP))},t.prototype.pQ=function(e){var o,n,r,i,a,s,l,u,c,f,h=this,p={e:e,r:y};if(t.ao(h,"preProcessManipulationDelta",p),!p.r&&(o=e.rN,r=(n=h.kj).mm,i=n.yt,a=o.X,s=o.Y,i))if(l=i.dragInfo,u=i.selectionHitInfo,i.resizeInfo)r.$F={e:e,x:a,y:s},r.WG();else if(l&&"corner"===l.side)r.$F={e:e,x:a,y:s},r.CG&&r.CG();else if(u||r.xG){if(u){if(!r.rG||!r.OG)return;if(!0===r.DA)return;c=u.type,r.$F={e:e,x:a,y:s},3===c?r.cH():2===c?r.dH():1===c&&r.eH()}}else h.KN?e.vO=h.iQ.NG(e.fP.sO,e.gP):(f=e.dP.rO,h.hQ.PP(f))},t.prototype.qQ=function(e){var o,n,r,i,a,s=this,l={e:e,r:y};t.ao(s,"preProcessManipulationCompleted",l),l.r||(n=(o=s.kj).mm,o.mQ=!0,i=(r=o.yt).selectionHitInfo,r.resizeInfo?n.YG():r.dragInfo&&n.BG?(n.xH&&n.xH(),o.parent.touchToolStrip.rQ()):i||n.xG?(n.hH(),i&&function(t,e,o,n){var r,i,a,s;e||(i=(r=Zt(t))[r.length-1],a=t.Jl,s=t.Kl,o&&(3===n?(t.Jl=i.row,t.Kl=i.col):2===n?(t.Jl=i.row,t.Kl=0):1===n&&(t.Jl=0,t.Kl=i.col)),ye(t,a,s,t.Jl,t.Kl))}(o,i.isHeader,i.isFirstIndicator,i.type),o.yl.im()):(o.nQ&&(o.nQ().oQ=!0),s.KN?s.iQ.gQ(e.gP):(a=e.dP.rO,s.hQ.SP(a))))},t.prototype.sQ=function(e){var o,n,i,s,l,u,c,f,h,p,d,m,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G=this,B={e:e,r:y};if(t.ao(G,"preProcessTapped",B),B.r)G.kj.repaint();else if(o=e.rN,n=G.kj,i=n.parent,s=!1,n.Uja=C,G.tQ(),n.uQ&&n.uQ(),(l=n.ITa.Ky)&&l.vQ(),u=n.mm,f=(c=G.kQ(o.X,o.Y,!0)).filterButtonHitInfo,h=c.hitTestType,p=c.row,d=c.col,m=c.outlineHitInfo)n.isEditing()||(v=m.what,b=n.rowOutlines,w=n.columnOutlines,"rg"===v||"rgh"===v?b&&b.UL(n,m):"cg"!==v&&"cgh"!==v||w&&w.UL(n,m));else if(n.yt=c,f){if(!n.endEdit())return;(T=f.rowFilter)&&T.openFilterDialog(f)}else if(c.resizeInfo);else if(n.Qs(c.rowViewportIndex<0?-1:p,c.colViewportIndex<0?-1:d)){if(n.wQ&&!u.BG&&i.touchToolStrip.rQ(),S=n.getActiveRowIndex(),x=n.getActiveColumnIndex(),A=c.cellTypeHitInfo){if(I=n.getCellType(A.row,A.col,h),A.sheet||(A.sheet=n),G.Sia(I,A))if(R=A.sheetArea,!a(R)&&3!==R||p===S&&d===x)n.yl.DH();else{if(n.suspendPaint(),!n.endEdit())return;if(M={sheet:n,sheetName:n.name(),row:S,col:x,cancel:!1},n.Wq(r.Events.LeaveCell,M),M&&!0===M.cancel)return;k=n.ITa.getSelections(),N=n.ITa.getSpan(p,d),O=[r.kf(N.row,N.col,N.rowCount,N.colCount)],n.yu(k,O),n.Wq(r.Events.FloatingElementSelected,{type:"worksheet"}),D=A.isReservedLocation&&A.isFocusAware,n.Sr(p,d,C,C,D?0:1),F={sheet:n,sheetName:n.name(),row:p,col:d},n.Wq(r.Events.EnterCell,F),n.Au(k),n.Uja=!0,u.cs&&u.cs(p,d),n.resumePaint(),s=!0}I.processCellAndPaddingMouseDown(A),I.XGb(A)}if(A&&A.isReservedLocation)return!0;A&&(A.cellButtonHitInfo||A.outlineColumnHitInfo)&&(s=!0),n.Wq(r.Events.CellClick,{sheet:n,sheetName:n.name(),sheetArea:h,row:c.row,col:c.col});try{if(u.mG=c,E=n.isEditing(),j=n.endEdit(),n.CH&&g&&E&&j&&(u.shift=!1),E&&S===n.getActiveRowIndex()&&x===n.getActiveColumnIndex()&&!j)return}finally{u.mG=y}if(a(p)||a(d))return;3===h&&u.cs&&u.cs(p,d),function(t,e,o,n){var r,i,s,l,u,c,f,h,p=!1,d=t.ITa.getSelections();for(r=0,i=d.length;r<i;r++){if(s=d[r],(l=3===n||a(n))&&(s=t.Tq(s)),u=s.row,c=s.col,f=s.rowCount,h=s.colCount,l)p=u<=e&&e<u+f&&c<=o&&o<c+h;else if(2===n)p=-1===c&&u<=e&&e<u+f;else if(1===n)p=-1===u&&c<=o&&o<c+h;else if(0===n)return p;if(p)break}return p}(n,p,d,h)&&!s?G.xQ=W.setTimeout((function(){var t={x:c.x,y:c.y,handled:!1},e=i.touchToolStrip;n.Wq(r.Events.TouchToolStripOpening,t),t.handled||e.open(c.x,c.y-100),G.tQ()}),420):(n.Wq(r.Events.FloatingElementSelected,{type:"worksheet"}),P=n.ITa.getSelections(),u.ZG(c),L=n.ITa.getSelections(),n.yu(P,L),u.hH())}},t.prototype.Sia=function(t,e){return!(t&&t.activedOnClick&&!t.activedOnClick()&&e.isReservedLocation)},t.prototype.yQ=function(e){var o,n,i,a,s,l,u,c,f,h,p,d,g,m,C,v,b=this,w={e:e,r:y};if(t.ao(b,"preProcessDoubleTapped",w),!w.r)if(o=b.kj,n=e.rN,b.tQ(),(s=o.yt)&&(o.Wq(r.Events.CellDoubleClick,{sheet:o,sheetName:o.name(),sheetArea:s.hitTestType,row:s.row,col:s.col}),l=s.resizeInfo))if(u=o.ITa.getSelections(),"sizeRow"===l.action||"sizeHiddenRow"===l.action){if(c=[],o.tp(l.index)){for(i=0;i<u.length;i++)if(-1===(a=u[i]).col)for(a=o.Tq(a),f=0;f<a.rowCount;f++)c.push({row:a.row+f})}else c.push({row:l.index});o.wu().execute({cmd:"autoFitRow",sheetName:o.name(),rows:c,columnHeader:1===l.sheetArea})}else{if(h=[],o.sp(l.index)){for(i=0;i<u.length;i++)if(-1===(a=u[i]).row)for(a=o.Tq(a),p=0;p<a.colCount;p++)h.push({col:a.col+p})}else h.push({col:l.index});o.wu().execute({cmd:"autoFitColumn",sheetName:o.name(),columns:h,rowHeader:2===l.sheetArea})}else!((d=b.kQ(n.X,n.Y,!0))&&d.row>=0&&d.col>=0&&d.rowViewportIndex>=0&&d.colViewportIndex>=0)||d.resizeInfo||o.options.isProtected&&o.tq(d.row,d.col,"locked")||((g=o.isCtrlPressed(d.hitTestType))||o.Tr(),m=o.Er(d.row),C=o.Fr(d.col),v=!0,o.Jl===d.row&&o.Kl===d.col||(v=!1),o.Kr(d.row,d.col,m,C,v),g?o.$p():o.addSelection(d.row,d.col,1,1),o.mm.dI(!1,!0),o.EF(o.Ws(),d.row,d.col))},t.prototype.zQ=function(t){var e,o=this,n=o.kj,r=t.rN,i=o.kQ(r.X,r.Y);n.isEditing()?i.row===n.Jl&&i.col===n.Kl||n.mm.cI(i):(o._target=i,(e=o.kQ(r.X,r.Y,!0))&&e.cellTypeHitInfo&&e.cellTypeHitInfo.isEditting||n.mm.cI(e))},t.prototype.AQ=function(t){var e,o,n,r,i=this.kj;i.isEditing()||(o=!0,(e=this._target)&&((n=e.cellTypeHitInfo)&&n.isReservedLocation?o=!1:(r=i.getCellType(e.row,e.col))&&r.isEditting()&&(o=!1)),o&&i.mm.dI(!0))},t.prototype.kQ=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,v,b=this.kj;return b.am(),n={x:t,y:e,rowViewportIndex:y,colViewportIndex:y,row:-1,col:-1,resizeInfo:y,hitTestType:y,outlineHitInfo:y,filterButtonHitInfo:y,dragInfo:y,cellTypeHitInfo:y,selectionHitInfo:y},r=b.rowOutlines,i=b.columnOutlines,r&&(a=r.hitTest(b,t,e)),!a&&i&&(a=i.hitTest(b,t,e)),a?n.outlineHitInfo=a:(void 0,void 0,s=b.nr(e),l=b.or(t),n.rowViewportIndex=s,n.colViewportIndex=l,n.row=b.pr(e,s),n.col=b.qr(t,l),s>=0&&s<=2&&l>=0&&((u=b.rr(s,l,C,n.row,n.col))&&(n.row=u.row,n.col=u.col)),n.hitTestType=b.sr(s,l),void 0,f=void 0,h=void 0,p=void 0,d=void 0,c=function(t,e,o,n,r){var i,a,s,l,u,c=t.parent,f=t.mm,h=t.options,p=e.rowViewportIndex,d=e.colViewportIndex,g=Zt(t),m=y;return t.CH&&g.length>0&&(a=(i=g[g.length-1]).row,s=i.row+i.rowCount-1,l=i.col,u=i.col+i.colCount-1,c&&!c.options.allowUserResize||(-1!==a&&-1===l&&p>=0&&d<0&&h.rowHeaderVisible?!(m=f.mH(t,e,r,2,n))||"sizeRow"!==m.action&&"sizeHiddenRow"!==m.action||2!==m.sheetArea||m.index===s||(m=y):-1===a&&-1!==l&&p<0&&d>=0&&h.colHeaderVisible&&(!(m=f.oH(t,e,r,1,o))||"sizeCol"!==m.action&&"sizeHiddenCol"!==m.action||1!==m.sheetArea||m.index===u||(m=y)))),m}(b,n,t,e,10),(p=(h=b.xr)&&h.hitTest(n,t,e))||(p=(v=(m=(g=b.tables)&&g.find(n.row,n.col))&&m.xr)&&v.hitTest(n,t,e)),b.wQ?(f=me(b,n,t,e),n.dragInfo=f):c?n.resizeInfo=c:p?n.filterButtonHitInfo=p:o?n.cellTypeHitInfo=b.yr(n,t,e):(d=ge(b,n,t,e),n.selectionHitInfo=d)),n},t.prototype.tQ=function(){var t=this.xQ;t&&(clearTimeout(t),this.xQ=y)},t}(),e.TouchEventHandler=wt,r.Zn(wt),Tt=function(){function t(t,e,o){var n=this;n.BQ=o,n.yM=new jt(e),n.CQ=new wt(e),n.DQ=new Pt(t,"sheet",n.yM,100,10),n.BQ.xN(n.DQ,!0)}return t.prototype.EQ=function(){var t=this.CQ,e=this.DQ;e.dN=function(e){return t.jQ(e)},e.eN=function(e){return t.lQ(e)},e.fN=function(e){return t.pQ(e)},e.hN=function(e){return t.qQ(e)},e.iN=function(e){return t.sQ(e)},e.jN=function(e){return t.yQ(e)},e.GM=function(e){return t.zQ(e)},e.IM=function(e){return t.AQ(e)}},t.prototype.FQ=function(){var t=this,e=t.DQ;e&&(t.BQ.xN(e,!1),e.dN=y,e.eN=y,e.fN=y,e.gN=y,e.hN=y,e.iN=y,e.jN=y,e.kN=y,e.GM=y,e.IM=y,t.DQ=y)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),St="gc-toolstrip-button",xt="gc-toolstrip-text",At="gc-toolstrip-image",It="gc-toolstrip-item",Rt="gc-touch-sperate-line",Mt="height",kt="width",Nt="px",Ot="button",Dt=function(t){function e(e,o){var n,i=t.call(this,o,r.Ul.vl(e.qo))||this,a=i;return a.JQ=32,a.KQ=45,a.LQ={},a.MQ=!1,a.OC=e,n=a.yo(),a.NQ=n,n.addClass("gc-toolstrip-default ui-state-default well"),n.appendTo(a.zo()),n.hide(),a.OQ(),a.PQ(),a.QQ(),i}return Ht(e,t),e.prototype.open=function(t,e){var o,n,i,a=this;if(Xt(a.OC)&&(r.Vl.Zl(y,!0),a.NQ.css({left:t,top:e}),a.Ao(),a.MQ=!0,a.Do(),!u(a.LQ)))for(n in o=a.LQ)o.hasOwnProperty(n)&&(!(i=o[n]).RQ||i.RQ.call(a)?l("#"+n).show():l("#"+n).hide())},e.prototype.add=function(t){var e,o,n,r;t&&(o=(e=this).LQ,t instanceof Et?(n=t.name())&&(o[n]=t,e.SQ(t.TQ(Rt,e.KQ+Nt))):t instanceof Ft&&(r=t.name(),e.getItem(r)||(o[r]=t,e.SQ(t.TQ(At,e.JQ+Nt,xt,St)))))},e.prototype.getItem=function(t){return this.LQ[t]},e.prototype.getItems=function(){var t,e=[],o=this.LQ;if(!u(o)){for(t in o)o.hasOwnProperty(t)&&e.push(o[t]);return e}return y},e.prototype.remove=function(t){var e,o=this;return o.getItem(t)?(l("#"+t).parent().remove(),e=o.LQ[t],delete o.LQ[t],e):y},e.prototype.clear=function(){var t=this;t.NQ&&(t.NQ.find("td."+It).remove(),t.LQ={})},e.prototype.close=function(){var t,e,o=this;J.Hm(),o.NQ&&o.NQ.hide(),o.MQ=!1,o.Eo(),(t=Xt(o.OC))&&(t.zt(),(e=Zt(t)).length>0&&!t.wQ&&-1===e[0].row&&-1===e[0].col&&t.Tr())},e.prototype.imageAreaHeight=function(t){var e=this;return 0===arguments.length?e.JQ:(t>0&&(e.JQ=t,e.NQ.find("span."+At).css(Mt,t+Nt)),e)},e.prototype.itemHeight=function(t){var e=this.NQ.find("button."+St);return 0===arguments.length?U(e.css(Mt)):(t>0&&e.css(Mt,t+Nt),this)},e.prototype.itemWidth=function(t){var e,o=this.NQ.find("button."+St);return 0===arguments.length?U(o.css(kt)):(t>0&&(e="min-width",U(o.css(e))>t&&o.css(e,t+Nt),o.css(kt,t+Nt)),this)},e.prototype.separatorHeight=function(t){var e=this;return 0===arguments.length?e.KQ:(t>0&&(e.KQ=t,e.NQ.find("div."+Rt).css(Mt,t+Nt)),e)},e.prototype.OQ=function(){var t="table",e=l(c(t)).css({padding:0,display:t}).attr({cellspacing:0,cellpadding:0});this.UQ=l(c("tr")).appendTo(e),e.appendTo(this.NQ)},e.prototype.no=function(){var t=this,e=t.NQ;e&&(t.MQ&&J.Hm(),e.unbind("click"),e.remove(),t.Eo(),t.NQ=y)},e.prototype.QQ=function(){var t=this;t.NQ.bind("click",(function(e){var o,n,r,i=e.target;i.tagName.toLowerCase()===Ot?o=i.id:(n=i.parentElement)&&n.tagName.toLowerCase()===Ot&&(o=n.id),r=t.LQ[o],o&&r&&r.VQ.call(t)}))},e.prototype.SQ=function(t){this.NQ&&t&&l(c("td")).append(t).appendTo(this.UQ).addClass(It)},e.prototype.PQ=function(){var t,e,o,n,r,i,a;function s(t){for(var e=0,o=t+e;q.getElementById(o);)o=t+ ++e;return o}n=(e={0:X+(t="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+Z,1:X+t+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+Z,2:X+t+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:X+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],r=e[1],i=e[2],a=e[3],(o=this).WQ=new Ft(s("wijspread_toolstrip_paste"),K().ToolStrip_PasteText,n,o.XQ),o.YQ=new Ft(s("wijspread_toolstrip_cut"),K().ToolStrip_CutText,r,o.ZQ),o.$Q=new Ft(s("wijspread_toolstrip_copy"),K().ToolStrip_CopyText,i,o._Q),o.aR=new Ft(s("wijspread_toolstrip_autofill"),K().ToolStrip_AutoFillText,a,o.bR,o.cR),o.add(o.WQ),o.add(o.YQ),o.add(o.$Q),o.add(new Et(o.cR)),o.add(o.aR)},e.prototype.cR=function(){var t,e,o,n=Xt(this.OC);if(!n)return!1;for(t=Zt(n),e=0;e<t.length;e++)if(-1===(o=t[e]).row&&-1===o.col)return!1;return!0},e.prototype.bR=function(){var t;this.close(),(t=Xt(this.OC))&&(Zt(t).length<=1&&(t.wQ=!0,t.yl.im()))},e.prototype.rQ=function(){var t=Xt(this.OC);t&&(t.wQ=!1,t.yl.im())},e.prototype._Q=function(){var t=Xt(this.OC);t&&(this.dR=t.ux(!0)),this.close()},e.prototype.ZQ=function(){var t=Xt(this.OC);t&&(this.dR=t.sx(!0)),this.close()},e.prototype.XQ=function(){var t=this,e=t.dR,o=Xt(t.OC);o&&!a(e)&&o.vx({pasteHtml:e.copyHtml,pasteText:e.copyText}),t.close()},e.prototype.eR=function(){var t=this,e="span."+xt;l("#"+t.WQ.Cj).find(e).text(K().ToolStrip_PasteText),l("#"+t.YQ.Cj).find(e).text(K().ToolStrip_CutText),l("#"+t.$Q.Cj).find(e).text(K().ToolStrip_CopyText),l("#"+t.aR.Cj).find(e).text(K().ToolStrip_AutoFillText)},e}(s),e.TouchToolStrip=Dt,Ft=function(){function t(t,e,o,n,r){this._font="normal 12px Arial";var i=this;i.Cj=t,i._text=e,i.fR=o,n&&(i.VQ=n),r&&(i.RQ=r)}return t.prototype.name=function(t){var e=this;return 0===arguments.length?e.Cj:(l("#"+e.Cj).attr("id",t),l("#"+e.Cj+"Text").attr("id",t+"Text"),l("#"+e.Cj+"Image").attr("id",t+"Image"),e.Cj=t,e)},t.prototype.text=function(t){var e=this;return 0===arguments.length?e._text:(e._text=t,l("#"+e.name()+"Text").text(t),e)},t.prototype.font=function(t){var e=this,o=l("#"+e.name()+"Text");return 0===arguments.length?e._font:(e._font=t,o.css("font",t),e)},t.prototype.foreColor=function(t){var e=this,o=l("#"+e.name()+"Text");return 0===arguments.length?e.Nra?e.Nra:o.css("color"):(o.css("color",t),e)},t.prototype.image=function(t){var e=this;return 0===arguments.length?e.fR:(e.fR=t,l("#"+e.name()+"Image").css("background-image","url("+t+")"),e)},t.prototype.TQ=function(t,e,o,n){var r,i,a,s,u=this,f=u.name(),h=u.font(),p=u.text(),d=l(c("span"));return d.attr("id",f+"Image"),d.addClass(t),d.css({"background-image":"url("+u.image()+")","background-repeat":"no-repeat",display:"block",height:e,"background-position-x":"50%"}),(r=l(c("span"))).attr("id",f+"Text"),r.addClass(o),r.css("font",h),r.text(p),i=function(t,e,o){var n,r=c("span"),i=q.body;return r.className=o,r.style.font=t,r.style.cssFloat="left",r.textContent=e,i.insertBefore(r,y),n=l(r).width(),i.removeChild(r),n}(h,p,o),i>(a=60)&&(a=i),(s=l(c(Ot))).attr("type",Ot),s.attr("id",f),s.addClass(n+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),s.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:a+Nt}),s.append(d),s.append(r),s[0]},t}(),e.TouchToolStripItem=Ft,Et=function(){function t(t){this.Cj=function(){for(var t="separator",e=0,o=t+""+e;q.getElementById(o);)o=t+""+ ++e;return o}(),t&&(this.RQ=t)}return t.prototype.name=function(){return this.Cj},t.prototype.TQ=function(t,e){var o=l(c("div"));return o.attr("id",this.name()),o.addClass(t),o.css({width:"1px",height:e,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),o[0]},t}(),e.TouchToolStripSeparator=Et,jt=function(){function t(t){this.tc=t}return t.prototype.oN=function(){this.gR=2,this.tc.CH=!0},t.prototype.zM=function(){this.gR=0,this.hR=qt()},t.prototype.nN=function(){return 1===this.gR},t.prototype.uN=function(){return 1===this.gR},t.prototype.sN=function(){return 1===this.gR},t.prototype.GQ=function(){var t=this;if(2===t.gR)return!0;if(t.hR){if(qt()-t.hR<=200)return t.iR++,!0;t.hR=0,t.iR=0,t.gR=1}else t.gR=1;return t.tc.CH=!1,!1},t.prototype.HQ=function(){var t=this;return t.iR?(t.iR--,!0):2===t.gR||(t.gR=0,!1)},t.prototype.IQ=function(){return 2===this.gR},t}(),e.jR=jt,Pt=function(t,e,o,n,r){var i=this;i.KM=t,i.lN=o,i.OM=e,i.mN=n,i.aN=r},e.kR=Pt,Lt=function(){function t(){}return t.prototype.lR=function(t,e){var o,n,r=t,i=r.touches,s=r.targetTouches,l=r.changedTouches;!1!==r.isPrimary&&(i&&i.length>=1&&s&&s.length>=1&&(i[0].clientX!==s[0].clientX||i[0].clientY!==s[0].clientY)||(f(t),o=a(l)?r:l[0],(n=q.createEvent("MouseEvents")).initMouseEvent(e,!0,!0,W,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,y),t.target.dispatchEvent(n)))},t.prototype.NM=function(t){var e,o=t.pointerType;if(!o||o===t[V]||o===N){if((e=t.data).mR)return;e.mR=!0,e.nR=!1,e.lR(t,"mouseover"),e.lR(t,"mousemove"),e.lR(t,"mousedown")}},t.prototype.aB=function(t){var e,o=t.pointerType;if(!o||o===t[V]||o===N){if(!(e=t.data).mR)return;e.nR=!0,e.lR(t,"mousemove")}},t.prototype.RM=function(t){var e,o=t.pointerType;if(!o||o===t[V]||o===N){if(!(e=t.data).mR)return;e.lR(t,"mouseup"),e.lR(t,"mouseout"),e.nR||e.lR(t,"click"),e.mR=!1}},t.prototype.oR=function(t,e,o){var n,i,s,u,c,f,h,p,d,g,m,y=this;"."!==o.charAt(0)&&(o="."+o),n=D+o,i=F+o,s=E+o,u=j+o,c=P+o,f=L+o,h=G+o,p=B+o,d=_+o,g=r.Ul._Va(),e?g?(m=t.style,a(m.msTouchAction)||(m.msTouchAction=O),a(m.touchAction)||(m.touchAction=O),l(t).bind(n,y,y.NM).bind(u,y,y.NM),l(q).bind(i,y,y.aB).bind(c,y,y.aB).bind(s,y,y.RM).bind(f,y,y.RM)):l(t).bind(h,y,y.NM).bind(p,y,y.aB).bind(d,y,y.RM):g?(l(t).unbind(n).unbind(u),l(q).unbind(i).unbind(c).unbind(s).unbind(f)):l(t).unbind(h).unbind(p).unbind(d)},t}(),e.pR=Lt,Gt="newSheet",Bt=function(){function t(t){this.YJc=t}return t.prototype.lQ=function(t){var e,o,n,i,a,s,l,u,c=this,f=t.rN,h=c.YJc,p=h.zJc(),d=Xt(h.OC);h.FD&&h.GD(d,!1),"resize"===(e=h.hitTest(f.X,f.Y).element)?(h.HD=!0,h.ID=f.X):"tab"!==e&&e!==Gt&&""!==e||(o=h.Xs,n=r.En.Nn(o),i=r.En.On(o),s=(a=c.IP(n,i)).getContext("2d"),l=r.En.Ln(a),u=r.En.Mn(a),r.Bn.Cn(s,1,1),s.drawImage(o,0,0,Ut(a),zt(a),0,0,Ut(a),zt(a)),r.Bn.Cn(s,l,u),c.Xs=a,c.qR=h.gq,c.rR=h.VC(),c.sR=h.UC(),c.KC=h.TC(),h.SC=p),c.tR=h.jw(-1),c.uR=h.rD(h.sD())},t.prototype.pQ=function(t){var e,o,n,i,s,l,u,c,f,h,p,d,g,m,y,C,b,w,T,S,x,A,I,R,M,k,N,O,D,F=this,E=t.rN.X,j=F.YJc,P=j.zJc();if(j.HD)e=E-j.ID,n=(o=j.OC).options,i=o.xs.clientWidth,n.tabStripRatio=o.Iv()+e/i,s=j.AJc()/i,1,o.Iv()<s?(n.tabStripRatio=s,j.ID=j.AJc()):o.Iv()>=1?(n.tabStripRatio=1,j.ID=i):j.ID=E;else{if(l=F.Xs,u=F.qR,!l||a(u))return;c=F.tR,f=F.uR,h=F.KC,p=F.rR,d=F.sR,g=P?t.dP.sO.X:t.dP.sO.Y,m=F.vR(g,u),j.gq=m.gq,y=m.Oz,(g>0&&u===c&&j.gq===c||g<0&&u===f&&j.gq===f)&&(y=0),g>0&&g>y+h?g=y+h:g<0&&g<y-h&&(g=y-h),0!==g&&(b=(C=j.Xs).getContext("2d"),w=r.En.Ln(C),T=r.En.Mn(C),b.save(),b.clearRect(0,0,r.En.Nn(C),r.En.On(C)),S=j.Dr(),j.dD(b,S),P?(x=void 0,A=0,I=void 0,R=zt(S),M=void 0,k=void 0,g>0?((I=d-(M=(x=p)+g))>0&&(r.Bn.Cn(b,1,1),b.drawImage(l,x*w,A,I*w,R*T,M*w,A,I*w,R*T),r.Bn.Cn(b,w,T)),k=g-y,d-p<=g&&(k=0),x=p,(I=y)>0&&(r.Bn.Dn(b,k,0),j.iE(b,new r.Rect(x,A,I,R)),r.Bn.Dn(b,-k,0))):g<0&&((I=d-(x=(M=p)+v(g)))>0&&(r.Bn.Cn(b,1,1),b.drawImage(l,x*w,A,I*w,R*T,M*w,A,I*w,R*T),r.Bn.Cn(b,w,T)),k=g-y,d-p<=v(g)&&(k=0),x=d-(I=v(y)),I>0&&(r.Bn.Dn(b,k,0),j.iE(b,new r.Rect(x,A,I,R)),r.Bn.Dn(b,-k,0))),r.Bn.Cn(b,1,1),x=0,I=p,b.drawImage(l,x*w,A,I*w,R*T,x*w,A,I*w,R*T),N=r.Im.Lm(""),z(N.zIndex)>2007&&(x=d,I=S.x+Ut(S)-j.AJc()-x,b.drawImage(l,x*w,A,I*w,R*T,x*w,A,I*w,R*T)),x=Ut(S)-j.AJc(),I=j.AJc(),b.drawImage(l,x*w,A,I*w,R*T,x*w,A,I*w,R*T),r.Bn.Cn(b,w,T)):(x=0,A=void 0,I=Ut(S),R=void 0,O=void 0,D=void 0,g>0?((R=d-(O=(A=p)+g))>0&&(r.Bn.Cn(b,1,1),b.drawImage(l,x*w,A*T,I*w,R*T,x*w,O*T,I*w,R*T),r.Bn.Cn(b,w,T)),D=g-y,d-p<=g&&(D=0),A=p,(R=y)>0&&(r.Bn.Dn(b,0,D),j.iE(b,new r.Rect(x,A,I,R)),r.Bn.Dn(b,0,-D))):g<0&&((R=d-(A=(O=p)+v(g)))>0&&(r.Bn.Cn(b,1,1),b.drawImage(l,x*w,A*T,I*w,R*T,x*w,O*T,I*w,R*T),r.Bn.Cn(b,w,T)),D=g-y,d-p<=v(g)&&(D=0),A=d-(R=v(y)),R>0&&(r.Bn.Dn(b,0,D),j.iE(b,new r.Rect(x,A,I,R)),r.Bn.Dn(b,0,-D))),r.Bn.Cn(b,1,1),A=0,R=p,b.drawImage(l,x*w,A*T,I*w,R*T,x*w,A*T,I*w,R*T),N=r.Im.Lm(""),z(N.zIndex)>2007&&(A=d,R=S.y+zt(S)-j.AJc()-A,b.drawImage(l,x*w,A*T,I*w,R*T,x*w,A*T,I*w,R*T)),A=zt(S)-j.AJc(),R=j.AJc(),b.drawImage(l,x*w,A*T,I*w,R*T,x*w,A*T,I*w,R*T),r.Bn.Cn(b,w,T)),b.restore())}},t.prototype.qQ=function(t){var e=this.YJc;e.HD?(e.HD=!1,e.OC.aq()):(e.SC=C,e.repaint())},t.prototype.sQ=function(t){var e,o,n,r,i=this.YJc,a=i.OC,s=t.rN,l=Xt(a);i.FD&&i.GD(l,!1),e=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],n=(o=i.hitTest(s.X,s.Y)).element,a.mv=!0;try{e.indexOf(n)>=0?i.JD(o.index,!0):"tab"===n?i.KD(o.index,o.position):n===Gt&&i.MD(o.position)}finally{a.mv=!1,(r=Xt(a))!==l&&(r.CH=!0,r.zt())}},t.prototype.yQ=function(t){return this.YJc.cE(t.rN.X,t.rN.Y)},t.prototype.IP=function(t,e){var o=this.Xs;return o?t===r.En.Nn(o)&&e===r.En.On(o)||r.En.Pn(o,t,e):(o=c("canvas"),r.En.Kn(o,this.YJc.OC),r.En.Pn(o,t,e)),o},t.prototype.vR=function(t,e){var o=this,n=o.YJc,r=n.WC,i=n.BJc,a=o.tR,s=o.uR,l=n.zJc(),u=e,c=0;if(t>0){for(;u>=a&&!(c>t);)c+=l?r[u]:i,u--;u<a&&(u=a)}else if(t<0&&-1!==s){for(;u<=s&&!(c<t);)c-=l?r[u]:i,u++;u>s&&(u=s)}return{gq:u,Oz:c}},t}(),_t=function(){function t(t,e,o){var n,r,i=this;i.yM=new jt(i),i.DQ=new Pt(t,"tabStrip",i.yM,1,-1),i.BQ=o,i.CQ=new Bt(e),n=i.CQ,(r=i.DQ).eN=function(t){return n.lQ(t)},r.fN=function(t){return n.pQ(t)},r.hN=function(t){return n.qQ(t)},r.iN=function(t){return n.sQ(t)},r.jN=function(t){return n.yQ(t)}}return t.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},t.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),r.oJ.prototype.DH=function(){var t=this.kj,e=Zt(t),o=e.length;t.Xq<=0&&o>0&&this.im(e[o-1],C,C,!0)},r.Worksheet.$n(N,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(t){var e=this,o=e.parent,n=o&&o.BQ||new Q,r=new Tt(t[0],e,n);r.EQ(),e.wR=r},dispose:function(t){var e=this;e.wR&&e.wR.FQ(),!1!==t.clearCache&&(e.wR=y)},startEdit:function(){this.yl.DH()},paintAdornment:function(t){var e=this,o=t.ctx;e.CH&&(e.options.isProtected||function(t,e){var o,n,i,a,s,l,u,c,f,h,p,d,g,m=t.am(),y=16,C=Zt(t);t.CH&&C.length>0&&(l=(s=C[C.length-1]).row,u=s.row+s.rowCount-1,c=s.col,f=s.col+s.colCount-1,p="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(h=t.parent)&&!h.options.allowUserResize||(-1!==l&&-1===c&&t.getRowResizable(u)?(d=t.Er(u),o=X+p+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",n=t.getCellRect(u,Qt(t,2)-1,d,-1),(a=m.fm(d)).y<=n.y&&n.y+zt(n)<=a.y+zt(a)&&(i=new r.Rect(m.kt-y,n.y+zt(n)-8,y,y))):-1===l&&-1!==c&&t.getColumnResizable(f)&&(g=t.Fr(f),o=X+p+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+Z,n=t.getCellRect($t(t,1)-1,f,-1,g),(a=m.gm(g)).x<=n.x&&n.x+Ut(n)<=a.x+Ut(a)&&(i=new r.Rect(n.x+Ut(n)-8,m.nt-y,y,y))),o&&i&&Ce(t,o,e,i)))}(e,o),e.wQ?function(t,e){var o=ve(t);o&&Ce(t,X+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+Z,e,o)}(e,o):function(t,e,o){var n,i,a,s;if(r.needPaintSelection(t)){if(t.isEditing()||!e||0===t.selectionPolicy())return;if(a=void 0,(i=(n=Te(t)).length)>0){for(o.save(),o.fillStyle=t.m_a()||"white",o.strokeStyle=t.getSelectionBorderColor(),s=0;s<i;s++)(a=n[s])&&(o.beginPath(),o.arc(a.x+Ut(a)/2,a.y+zt(a)/2,Ut(a)/2,0,2*Math.PI,!1),o.fill(),o.stroke());o.restore()}}}(e,e.mQ,o))},preProcessMouseDown:function(t){var e=t.e,o=this.wR;(m||o.GQ(e))&&(f(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,o=this.wR;(m||o.IQ(e))&&(f(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,o=this.wR;(m||o.HQ(e))&&(f(e),t.r=!0)},preProcessMouseDbClick:function(t){(m||this.CH)&&(t.r=!0)},preProcessMouseOut:function(t){m&&(t.r=!0)},preProcessMouseWheel:function(t){m&&(t.r=!0)}}),r.Workbook.$n(N,{init:function(){this.BQ=new Q},setHost:function(){var t=this;t.touchToolStrip=new Dt(t,t.xv())},dispose:function(){var t=this,e=t.BQ,o=t.touchToolStrip;e&&e.no(),o&&(o.no(),t.touchToolStrip=y)},onCultureChanged:function(){var t=this.touchToolStrip;t&&t.eR()}}),r.DC.$n(N,{setHost:function(){var t=this,e=new _t(t.Xs,t,t.OC.BQ);e.EQ(),t.wR=e},dispose:function(){var t=this.wR;t&&(t.FQ(),this.wR=y)},preProcessMouseDown:function(t){var e=this.wR,o=t.e;(m||e.GQ(o))&&(f(o),t.r=!1)},preProcessMouseMove:function(t){var e=this.wR,o=t.e;(m||e.IQ(o))&&(f(o),t.r=!1)},preProcessMouseUp:function(t){var e=this.wR,o=t.e;(m||e.HQ(o))&&(f(o),t.r=!1)},preProcessMouseDbClick:function(t){var e=Xt(this.OC);(m||e&&e.CH)&&(t.r=!1)},preProcessMouseOut:function(t){m&&(t.r=!1)}}),Vt=".gcScrollbar",r.hv.$n(N,{initEvents:function(t){(this.xR=new Lt).oR(t,!0,Vt)},dispose:function(t){var e=this.xR;e&&e.oR(t,!1,Vt)}})},"./dist/plugins/touch/touch.res.en.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToolStrip_PasteText="Paste",e.ToolStrip_CutText="Cut",e.ToolStrip_CopyText="Copy",e.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O;Object.defineProperty(e,"__esModule",{value:!0}),n=o("Core"),r=o("Common"),i=o("@grapecity/js-calc"),a=o("./dist/plugins/validation/datavalidation.js"),s=r.Common.j.Fa,l=r.Common.l,u=r.Common.u,c=n.Ul,f=n.kf,h=c.rl(),p=c.Ml,d=n.GC$,g=c.Nl,m=c.hZa,y=c.nl,C=document,v=Math.max,b=Math.min,w="position",T="absolute",S="border",x="font",A="background-color",I="top",R="left",M="z-index",k="auto",N="white",O="gcUIElement",d.extend(n.iI.prototype,{cs:function(t,e){var o,n,r,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt;function Tt(t,e){if(t&&t[e])return"function"==typeof t[e]?t[e]():t[e]}if((r=(n=(o=this).kj)&&n.parent)&&(n.hm()&&((D=r.getActiveSheet())||(F=r.getActiveSheetTab())&&(D=F.kj),D&&n.name()===D.name()&&((E=n.getDataValidator(t,e))&&(j=n.getCellRect(t,e),!o.oG(j)&&(P=r.xv(),L=r.getHost(),G=c.vl(L),Tt(E,"showInputMessage")&&Tt(E,"inputMessage")&&(V=(B=u.Gb)((_=u.Ob)(Tt(E,"inputTitle")),"\n","<br/>"),H=B(_(Tt(E,"inputMessage")),"\n","<br/>"),z=g("span"),d(z).css(w,T).css(S,"1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(A,"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(x,"normal normal normal 12px/normal Arial").width(k).height(k).css(I,j.y+j.height+5).css(R,j.x+j.width/2).css(M,G).html("<b>"+V+"</b><br/>"+H).attr(O,"gcValidationInputMessage").appendTo(P),n.KH=z),E&&3===Tt(E,"type")&&Tt(E,"inCellDropdown")&&Tt(E,"condition"))))))){for(U=Tt(E,"condition").getValidListImp(n,t,e),W=Tt(E,"condition").CIc(),q=U.length,J=g("select"),X=n.getText(t,e),Z=-1,Y=C.createDocumentFragment(),K=RegExp(String.fromCharCode(32),"g"),Q=String.fromCharCode(160),$=0;$<q;$++)tt=U[$].text,s(tt)||i&&tt instanceof i.CalcError||(Z<0&&tt===X&&(Z=$),tt instanceof Date&&(tt=l.Vb(tt,"M/d/yyyy h:mm:ss")),(et=g("option")).value=tt,et.text=tt.replace(K,Q),Y.appendChild(et));J.appendChild(Y),J.selectedIndex=Z>0?Z:0,ot=n.getActualStyle(t,e),nt=n.yl,rt=ot&&ot.font?ot.font:nt.Bl(),n.zoom()>1&&(rt=nt.Cl(rt)),at=1,(it=n.ITa.getSpans(f(t,e,1,1)))&&it.length>0&&it[0]&&(at=it[0].colCount),st=e+at-1==n.getColumnCount()-1,lt=n.Sl(t),ut=n.parent&&n.parent.options.useTouchLayout,lt=b(ut?50:15,lt),ct=h,ft=p.safari&&(ct.ipad||ct.iphone),ht=ct.android,pt=void 0,dt=void 0,gt=void 0,mt=void 0,yt=void 0,ft?(pt=j.width+3,dt=j.height+3,gt=j.y-1.5,mt=j.x-1.5,yt=N):(pt=v(j.width+(st?0:lt),n.defaults.colWidth),dt=q>8?140:k,gt=j.y+j.height,mt=(Ct=j.x+j.width+(st?0:lt)-pt)<n.Vs().left?j.x:Ct,yt=""),vt=d(J).css("outline","none").css(w,T).css(x,m(rt)).css(M,G).css(A,yt).width(pt).height(dt).css(R,mt).attr(O,"gcValidationSelect").appendTo(P).attr("size",q>2?q:2).hide().bind("click",(function(){ht||(o.pG(J,t,e,U,W),ft&&d(n.y$).show())})).bind("keydown",(function(r){13!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey?27!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey||d(J).hide():o.pG(J,t,e,U,W),ft&&d(n.y$).show()})).bind("change",(function(){ht&&o.pG(J,t,e,U,W)})),bt=d(L).height(),(dt=vt.outerHeight()+1)+gt>bt&&gt>dt&&(ft||(gt=j.y-dt)),vt.css(I,gt),ft&&vt.bind("blur",(function(){o.pG(J,t,e,U,W),d(n.y$).show()})),n.lm=J,(wt=g("input")).type="image",wt.src=a.zW(),wt.alt="v",d(wt).css(w,T).width(lt).height(lt).css(I,j.y+j.height-(lt+3)).css(R,j.x+j.width-(st?lt:0)).css(M,G).css(A,N).css(S,"1px solid gray").attr(O,"gcValidationButton").appendTo(P).bind("click",(function(t){n.isEditing()&&!n.endEdit()||(d(n.lm).toggle().focus(),ft&&d(n.y$).toggle(),y(t))})),n.y$=wt}}})},"./dist/plugins/validation/datavalidation.entry.js":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),o("./dist/plugins/validation/datavalidation-event.js");var n=o("./dist/plugins/validation/datavalidation.js");e.CriteriaType=n.CriteriaType,e.DataValidationResult=n.DataValidationResult,e.ErrorStyle=n.ErrorStyle,e.DefaultDataValidator=n.DefaultDataValidator,e.HighlightType=n.HighlightType,e.HighlightPosition=n.HighlightPosition,e.zW=n.zW,e.bW=n.bW,e.createNumberValidator=n.createNumberValidator,e.createDateValidator=n.createDateValidator,e.createTimeValidator=n.createTimeValidator,e.createTextLengthValidator=n.createTextLengthValidator,e.createFormulaValidator=n.createFormulaValidator,e.createFormulaListValidator=n.createFormulaListValidator,e.createListValidator=n.createListValidator},"./dist/plugins/validation/datavalidation.js":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F;function E(t){var e,o,r,i;if(t instanceof Date)return t;if("string"==typeof t){if(!(e=n.Common.l.Qa(t)))if(isNaN(t)){if(e=new Date(t),isNaN(e.valueOf()))return d;try{if(o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=n.Common.u.ib(n.Common.u.Db(t.replace(/ |\n/g,"")," ")," "),(i=o.exec(r))&&4===i.length&&(-1===i.indexOf(""+e.getFullYear())||-1===i.indexOf(""+e.getMonth())||-1===i.indexOf(""+e.getDate())))return d}catch(t){return d}}else if(!(e=n.Common.l.Xb(parseFloat(t))))return d;return e}return"number"==typeof t?isNaN(t)?d:(e=n.Common.l.Xb(t))||d:d}function j(t){return l&&t&&"="===t[0]}function P(t,e,o,n){var r,i,a,s,l=d,f=d,h=d,p=d;return j(e)?l=c(e,"="):f=e,j(o)?h=c(o,"="):p=o,r=d,6===t&&((i=u(1,3,f,l)).integerValue(n),(a=u(1,5,p,h)).integerValue(n),r=u(0,1,d,d,d,d,d,i,a)),7===t&&((i=u(1,4,f,l)).integerValue(n),(a=u(1,2,p,h)).integerValue(n),r=u(0,0,d,d,d,d,d,i,a)),t>=0&&t<=5&&(r=u(1,t,f,l)).integerValue(n),(s=new O(r)).type(n?1:2),s.comparisonOperator(t),s}function L(t,e,o,n,r){var i,a,s,l,f,h=d,p=d,g=d,m=d;if(j(e)?h=c(e,"="):p=e,j(o)?g=c(o,"="):m=o,i=d,6===t&&(a=u(n,5,p,h),s=u(n,3,m,g),i=u(0,1,d,d,d,d,d,a,s)),7===t&&(a=u(n,2,p,h),s=u(n,4,m,g),i=u(0,0,d,d,d,d,d,a,s)),t>=0&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}i=u(n,l,p,h)}return(f=new O(i)).type(r),f.comparisonOperator(t),f}function G(t,e,o){return L(t,e,o,5,4)}function B(t,e,o){return L(t,e,o,13,5)}function _(t,e,o){var n,r,i,a,s=d,l=d,f=d,h=d;return j(e)?s=c(e,"="):l=e,j(o)?f=c(o,"="):h=o,n=d,6===t&&(r=u(7,3,l,s),i=u(7,5,h,f),n=u(0,1,d,d,d,d,d,r,i)),7===t&&(r=u(7,4,l,s),i=u(7,2,h,f),n=u(0,0,d,d,d,d,d,r,i)),t>=0&&t<=5&&(n=u(7,t,l,s)),(a=new O(n)).type(6),a.comparisonOperator(t),a}function V(t){if(!l)return d;var e=new O(u(4,d,d,c(t,"="),4));return e.type(7),e}function H(t){if(!l)return d;var e=new O(i.Condition.fromFormula(t));return e.type(3),e}function z(t){var e=new O(i.Condition.fromSource(t));return e.type(3),e}function U(t){return this.Tq(t)}function W(t,e){var o=t.getRowCount(),n=t.getColumnCount();return e.map((function(t){return function(t,e,o){var n=t.rowCount,r=t.colCount,i=b(t.row,t.col,n,r);return 0===t.row&&n===e&&(i.row=-1),0===t.col&&r===o&&(i.col=-1),i}(t,o,n)}))}function q(t,e){var o,n,r,i,a,s,l,u,c=e.Eja;for(n=0,r=t.row,i=t.rowCount;n<i;n++,r++)if(o=c[r])for(a=0,s=t.col,l=t.colCount;a<l;a++,s++)(u=o[s])&&u.IW(t,e),o[s]=g}function J(t){var e,o,n=[];if(t)for(e in t)(o=t[e])&&n.push(o);return n}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("Core"),i=o("ConditionalFormatting"),a=o("SheetsCalc"),s=o("@grapecity/js-calc"),l=!!s,u=i.$V,c=n.Common.u.Db,f=n.Common.j.Fa,h=n.Common.j.C4,p=r.GC$,d=null,g=void 0,y=(m=r.Ul).Pl,C=m.Ol,v=m.T$a,b=r.kf,w=Math.min,T=Math.max,S=n.Common.l,x=".validator",I={type:0,color:A="red"},R={type:1,color:A,position:1},M={type:2,color:A,position:5,image:null},k=window,function(t){t[t.anyValue=0]="anyValue",t[t.wholeNumber=1]="wholeNumber",t[t.decimalValues=2]="decimalValues",t[t.list=3]="list",t[t.date=4]="date",t[t.time=5]="time",t[t.textLength=6]="textLength",t[t.custom=7]="custom"}(e.CriteriaType||(e.CriteriaType={})),function(t){t[t.forceApply=0]="forceApply",t[t.discard=1]="discard",t[t.retry=2]="retry"}(e.DataValidationResult||(e.DataValidationResult={})),function(t){t[t.stop=0]="stop",t[t.warning=1]="warning",t[t.information=2]="information"}(e.ErrorStyle||(e.ErrorStyle={})),function(t){t[t.circle=0]="circle",t[t.dogEar=1]="dogEar",t[t.icon=2]="icon"}(e.HighlightType||(e.HighlightType={})),function(t){t[t.topLeft=0]="topLeft",t[t.topRight=1]="topRight",t[t.bottomRight=2]="bottomRight",t[t.bottomLeft=3]="bottomLeft",t[t.outsideLeft=4]="outsideLeft",t[t.outsideRight=5]="outsideRight"}(e.HighlightPosition||(e.HighlightPosition={})),N=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],O=function(){function t(e){var o=this;o.id=t.w$,t.w$++,o.QAb=h(I),e&&(o.condition(e),o.condition().ignoreBlank(o.ignoreBlank())),o.n5=[]}return t.prototype.value1=function(t,e){var o,n=this.condition(),r=n&&n.item1()?n.item1():n;return r?(o=r.formula(t,e))&&o.length>0?"="+c(p.trim(""+o),"="):r.expected():d},t.prototype.value2=function(t,e){var o,n=this.condition(),r=n&&n.item2()?n.item2():n;return r?(o=r.formula(t,e))&&o.length>0?"="+c(p.trim(""+o),"="):r.expected():d},t.prototype.isValid=function(t,e,o,n){var r,i,a,s=this,l=s.condition();if(l){if(s.ignoreBlank()&&(f(n)||""===n))return!0;if(r=n,i=void 0,!f(n))switch(s.type()){case 0:return!0;case 2:case 1:i=function(t){if(f(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var e=parseFloat(t);if(!isNaN(e)&&""+e===t)return e}return d}(n),f(i)||(r=i);break;case 4:case 5:i=E(n),f(i)||(r=i)}t&&(t.lRa=!0),a=void 0;try{a=l.evaluate(t,e,o,r,r)}catch(t){a=!0}finally{t&&(t.lRa=!1)}return a}return!0},t.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.preciseCompareDate(!1),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(d),t.n5.length=0},t.prototype.getValidList=function(t,e,o){var n=this.condition();return n!==d&&3===this.type()&&12===n.conType()?n.getValidList(t,e,o):d},t.prototype.highlightStyle=function(t){var e,o,n=this;if(0===arguments.length)return n.QAb;if(!f(t)){if(n.QAb.type!==t.type)switch(t.type){case 1:n.QAb=h(R);break;case 2:n.QAb=h(M);break;default:n.QAb=h(I)}for(o in e=n.QAb)e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(e[o]=t[o]);return n.kj&&n.kj.repaint(),n}},t.prototype.toJSON=function(t){var e,o=this,n={};return N.forEach((function(e){var r=o[e]();o[e].isDefault(r)||(n[e]=r&&r.toJSON?r.toJSON(t):r)})),e=o.n5.map((function(t){return-1===t.row&&-1===t.col?b(-1,0,t.rowCount,t.colCount):t})),n.ranges=a.rangesToFormula(e,0,0,15,!1),n.highlightStyle=JSON.stringify(o.QAb),p.isEmptyObject(n)?g:n},t.prototype.fromJSON=function(t,e,o){var n,r,i,s,l;t&&!p.isEmptyObject(t)&&(n=this,t.ranges&&(n.n5=a.formulaToRanges(o,t.ranges,0,0,!0)[0].ranges),t.highlightStyle&&(n.QAb=JSON.parse(t.highlightStyle)),N.forEach((function(r){var i,a,s=t[r];C(s)&&("condition"===r?((i=u()).fromJSON(t.condition,o,e),n.condition(i,!1),(a=i.ranges())&&a.length?n.n5=a:i.ranges(n.n5),i.context(o)):n[r](s,!1))})),(r=t.validatorInfo)&&(i=o.Wu.useR1C1,s=function(t,e){var o,n,r;if(!f(t))return 1===t||2===t?o=P(e.operator,e.value1,e.value2,1===t):3===t?e.value?o=z(e.value):e.formula&&(o=H(e.formula)):4===t||5===t?(n=e.value1,r=e.value2,n&&"/OADate("===n.substr(0,8)&&(n=S.Rka(n)),r&&"/OADate("===r.substr(0,8)&&(r=S.Rka(r)),o=5===t?B(e.operator,n,r):G(e.operator,n,r)):6===t?o=_(e.operator,e.value1,e.value2):7===t&&void 0!==e.formula&&(o=V(e.formula)),o?o.condition():void 0}(t.type,r),l=r.operator,s&&(s.ranges(n.n5),s.ignoreBlank(n.ignoreBlank()),s.context(o),i&&v(s),n.condition(s)),f(l)||n.comparisonOperator(l)))},t.prototype.clone=function(e){var o,n;return this.Nja?((o=this.condition())&&o.initExpression(),this):((n=new t).fromJSON(this.toJSON(e),!1,e||this.kj),n.n5=[],n)},t.prototype.context=function(t){if(t){this.xc=t;var e=this.condition();e&&(e.ranges(this.n5),e.context(t))}return this.xc},t.prototype.xja=function(t){var e,o;if(t){for(e=this.n5,o=0;o<e.length;o++)if(e[o].containsRange(t))return;e.push(t)}},t.prototype.IW=function(t,e){var o,n,r,i,a,s,l,u,c=this,f=c.n5;t&&f.length&&(o=t.row,n=t.col,r=t.rowCount,i=t.colCount,a=[],s=!1,l=c.kj,u=l&&[l.getRowCount(),l.getColumnCount()],f.forEach((function(t){var e=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,C,v,S,x,A,I,R,M,k,N;return t.intersect(e,o,n,r)?(a=t.rowCount,s=t.colCount,l=T(0,t.row),u=T(0,t.col),c=!1,f=!1,h=!1,e=T(0,e),o=T(0,o),i||(i=[-1,-1]),p=i[0],d=i[1],-1===a&&(a=p-l,f=!0),-1===s&&(s=d-u,c=!0),-1===n&&(n=p-e),-1===r&&(r=d-o,h=!0),m=l+a-1,y=u,C=u+s-1,v=e,S=e+n-1,x=o,A=o+r-1,I=[],-1!==(g=l)&&-1!==y&&-1!==v&&-1!==x&&(x-y>0&&(R=b(g,y,f?-1:a,x-y),I.push(R)),C-A>0&&(M=b(g,A+1,f?-1:a,C-A),I.push(M)),v-g>0&&(k=b(g,T(x,y),v-g,c&&h?-1:w(A,C)-T(x,y)+1),I.push(k)),m-S>0&&(N=b(S+1,T(x,y),m-S,c&&h?-1:w(A,C)-T(x,y)+1),I.push(N))),I.PAb=!0,I):[t]}(t,o,n,r,i,u);e.PAb&&(s=!0),a.push(e)})),c.n5=[].concat.apply([],a),s&&e.RAb(c))},t.prototype.l1=function(){return this.n5},t.prototype.yyb=function(){this.condition()&&this.condition().initExpression()},t.prototype.YXc=function(t){this.condition()&&this.condition().ranges(t)},t.prototype.XXc=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=this,d=!1;for(p.yyb(),r=0,i=(n=p.n5).length;r<i;r++)s=(a=n[r]).row,l=a.rowCount,u=a.col,c=a.colCount,f=s===t.row&&l===t.rowCount&&t.col<=u&&c<=t.colCount,h=s===e.row&&l===e.rowCount&&e.col<=u&&c<=e.colCount,(f||h)&&(n[r]=b(s,u,l+o,c),d=!0);return d&&p.YXc(n),d},t.prototype.rI=function(t,e,o){var n,r,i,a,s,l,u;if(!(t<0||e<=0)){for(this.condition()&&this.condition().initExpression(),n=0;n<this.n5.length;n++){if(i=(r=this.n5[n]).row,o&&o.length>0){for(a=!1,s=0,l=o.length;s<l;s++)if((u=o[s])&&u.row===r.row&&u.row+u.rowCount-e===r.row+r.rowCount&&r.row===t){r.rowCount+=e,a=!0;break}if(a)break}t<=i?r.row+=e:t<=i+r.rowCount&&(r.rowCount+=e)}this.condition()&&this.condition().ranges(this.n5)}},t.prototype.GR=function(t,e){if(!(t<0||e<=0)){this.condition()&&this.condition().initExpression();var o=[];this.n5.forEach((function(n){var r,i=n.row,a=n.rowCount;t<i?((r=t+e-i)<=0?i-=e:(i-=r,n.rowCount-=r),i<0&&(n.rowCount+=i,i=0),n.row=i):i<=t&&t<i+a&&(n.rowCount-=w(e,i+a-t)),(n.rowCount>0||-1===n.row&&-1===n.rowCount)&&o.push(n)})),this.n5=o,this.condition()&&this.condition().ranges(this.n5)}},t.prototype.tI=function(t,e,o){var n,r,i,a,s,l,u,c;if(!(t<0||e<=0)){for(this.condition()&&this.condition().initExpression(),n=0;n<this.n5.length;n++){if(r=this.n5[n],o&&o.length>0){for(i=!1,a=!1,s=0,l=o.length;s<l;s++)if(!(u=o[s])||u.containsRange(r)){if(u&&u.col===r.col&&u.col+u.colCount-e===r.col+r.colCount&&u.col===t){r.colCount+=e,a=!0;break}}else i=!0;if(i)continue;if(a)break}t<=(c=r.col)?r.col+=e:t<=c+r.colCount&&(r.colCount+=e)}this.condition()&&this.condition().ranges(this.n5)}},t.prototype.HR=function(t,e){if(!(t<0||e<=0)){this.condition()&&this.condition().initExpression();var o=[];this.n5.forEach((function(n){var r,i=n.col,a=n.colCount;t<i?((r=t+e-i)<=0?i-=e:(i-=r,n.colCount-=r),i<0&&(n.colCount+=i,i=0),n.col=i):i<=t&&t<i+a&&(n.colCount-=w(e,i+a-t)),(n.colCount>0||-1===n.col&&-1===n.colCount)&&o.push(n)})),this.n5=o,this.condition()&&this.condition().ranges(this.n5)}},t.w$=1,t}(),e.DefaultDataValidator=O,D={errorStyle:y("errorStyle",0),ignoreBlank:y("ignoreBlank",!0,(function(t){this.condition()&&this.condition().ignoreBlank(t)})),preciseCompareDate:y("preciseCompareDate",!1,(function(t){this.condition()&&this.condition().preciseCompareDate(t)})),inCellDropdown:y("inCellDropdown",!0),showInputMessage:y("showInputMessage",!0),showErrorMessage:y("showErrorMessage",!0),inputTitle:y("inputTitle",""),errorTitle:y("errorTitle",""),inputMessage:y("inputMessage",""),errorMessage:y("errorMessage",""),comparisonOperator:y("comparisonOperator",6),condition:y("condition",d),type:y("type",0)},p.extend(O.prototype,D),e.zW=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},e.bW=j,e.createNumberValidator=P,e.createDateValidator=G,e.createTimeValidator=B,e.createTextLengthValidator=_,e.createFormulaValidator=V,e.createFormulaListValidator=H,e.createListValidator=z,p.extend(r.Worksheet.prototype,{getDataValidator:function(t,e,o){var n=this.dMc(t,e,o);return n?n[0]:g},dMc:function(t,e,o){return f(o)&&(o=3),3===o?this.uja.Aja(t,e):g},setDataValidator:function(t,e,o,n,r,i){var a,s,l,u,c=this,h=c.uja;if(arguments.length<5&&(r=o,i=n,o=-1===t?-1:1,n=-1===e?-1:1),f(i)&&(i=3),3===i){if(a=c.getDataValidator(t,e,i),(s=1===o&&1===n)&&a===r)return;c.ITa.zVa(),l=b(t,e,o,n),h.Cja(l),r&&h.Bja(r,l),u="validator",s&&(c.Bq(u,t,e,i,a,r),-1!==t&&-1===e?c.kq(t,i,u,r,a):-1===t&&-1!==e&&c.pq(e,i,u,r,a)),c.$p()}},isValid:function(t,e,o){var n,r=this;try{if(r.Ku=t,r.Lu=e,r.Mu=o,r.Ju=!0,n=r.getDataValidator(t,e))return n.isValid(r,t,e,o)}finally{r.Ku=-1,r.Lu=-1,r.Mu=d,r.Ju=!1}return!0},hm:function(){var t,e,o,n,r=this;return!r.x$&&(r.x$=!0,(t=r.KH)&&((e=t.parentNode)&&e.removeChild(t),r.KH=d),(o=r.y$)&&(p(o).unbind("click"),(e=o.parentNode)&&e.removeChild(o),r.y$=d),(n=r.lm)&&(p(n).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(e=n.parentNode)&&e.removeChild(n),r.lm=d),r.x$=!1,!0)},tja:function(){var t,e,o,n=[],r=this.uja,i=r&&r.Dja;if(i)for(t in i)(o=(e=i[t])&&e.condition())&&o.getExpressions&&o.getExpressions().length>0&&n.push({validator:e,sheet:this});return n}}),p.extend(r.Workbook.prototype,{tja:function(){var t=[];return this.sheets.forEach((function(e){var o=e.tja();o&&o.length&&o.forEach((function(e){t.push(e)}))})),t}}),p.extend(r.CellRange.prototype,{validator:function(t){var e=this,o=e.sheet,n=e.sheetArea,r=e.row,i=e.col,a=e.rowCount,s=e.colCount;return 0===arguments.length?o.getDataValidator(r,i,n):(o.setDataValidator(r,i,a,s,t,n),e)}}),F=function(){function t(t){this.WS=t,this.Dja={},this.Eja={},this.SAb=[]}return t.prototype.no=function(){this.WS=d},t.prototype.UV=function(t){return function(t,e){if(t&&e&&e.length)return e.map(U.bind(t))}(this.WS,t)},t.prototype.EW=function(t){return W(this.WS,t)},t.prototype.QV=function(t){var e,o,n=this,r=n.Dja;if(n.Eja={},r)for(e in r)(o=r[e])&&(t&&delete o.yja,n.FW(o,!0));n.Fja()},t.prototype.RAb=function(t){var e=this.SAb;-1===e.indexOf(t)&&e.push(t)},t.prototype.FW=function(t,e){var o=this,n=o.UV(t.l1()),r=o.WS,i=r.getRowCount(),a=r.getColumnCount();n&&(o.SAb.length=0,n.forEach((function(e){!function(t,e,o,n,r){var i,a,s,l,u,c,f=n.Eja,h=t.row,p=t.col,d=t.rowCount,g=t.colCount;for(h+d-1>=e&&(d=e-h),p+g-1>=o&&(g=o-p),i=0,a=h;i<d;i++,a++)for((s=f[a])||(f[a]=s={}),l=0,u=p;l<g;l++,u++)(c=s[u])&&c!==r&&c.IW(t,n),s[u]=r}(e,i,a,o,t)})),e||o.Fja())},t.prototype.GW=function(t){var e=this,o=e.UV(t.l1());e.SAb.length=0,o.forEach((function(t){q(t,e)})),e.Fja()},t.prototype.HW=function(t){var e=this;t&&q(e.WS.Tq(t),e),e.Fja()},t.prototype.Fja=function(){var t,e=this.SAb;e.length&&(t=this.Dja,e.forEach((function(e){e.l1().length?e.condition()&&e.condition().ranges(e.l1()):(delete t[e.id],delete e.kj)})),e.length=0)},t.prototype.Bja=function(t,e){var o=this,n=o.WS;if(e&&(t.kj&&n!==t.kj&&(t=t.clone(n)),t.kj=n,t.xja(e)),n)return t.context(n),o.Dja[t.id]=t,o.FW(t),t},t.prototype.Cja=function(t){if(t){var e=this.WS;this.HW(t),e.$p()}},t.prototype.$b=function(){var t=this;t.WS&&(t.Dja={},t.QV())},t.prototype.Aja=function(t,e){var o,n,r,i=this.Dja;return 0===arguments.length?J(i):(o=[],n=this.Eja,t===g&&(t=-1),e===g&&(e=-1),-1===t&&-1===e?J(i):(-1!==t&&-1!==e?(r=n[t])&&r[e]&&o.push(r[e]):-1===t?p.each(n,(function(t,n){var r=n[e];r&&-1===o.indexOf(r)&&o.push(r)})):(r=n[t])&&p.each(r,(function(t,e){e&&-1===o.indexOf(e)&&o.push(e)})),o))},t.prototype.XXc=function(t,e,o){var n,r,i=this,a=i.WS.ITa,s=i.Dja,l=!1;if(!f(s)){for(n in a.zVa(),s)(r=s[n])&&r.XXc(t,e,o)&&(l=!0);l&&i.QV()}},t.prototype._V=function(t,e,o,n){var r,i,a=this.Dja;if(a)for(r in a)(i=a[r])&&(o?i.rI(t,e,n):i.tI(t,e,n));this.QV()},t.prototype.rI=function(t,e,o){this._V(t,e,!0,o)},t.prototype.tI=function(t,e,o){this._V(t,e,!1,o)},t.prototype.aW=function(t,e,o){var n,r,i=this.Dja;if(i)for(n in i)(r=i[n])&&(o?r.GR(t,e):r.HR(t,e),0===r.n5.length&&(i[n]=g));this.QV()},t.prototype.GR=function(t,e){this.aW(t,e,!0)},t.prototype.HR=function(t,e){this.aW(t,e,!1)},t.prototype.toJSON=function(t){var e,o,n=this.Dja,r=[];for(e in n)(o=n[e])&&r.push(o.toJSON(t));return r},t.prototype.fromJSON=function(t,e,o){var n=this,r=n.WS;n.Dja={},t&&t.length&&(t.forEach((function(t){var i=new O;i.fromJSON(t,e,o),i.kj=r,n.Dja[i.id]=i})),n.QV())},t.prototype.vja=function(t,e,o){this.WS.setDataValidator(t,e,o)},t}(),p.extend(r.lUa.prototype,{zVa:function(){var t,e,o,n,r,i=this.zTa;if(i&&!i.AVa){for(o in e=[],t=this.uja.Dja)(n=t[o])&&(r=n.n5.map((function(t){return b(t.row,t.col,t.rowCount,t.colCount)})),e.push({validator:n,ranges:r}));i.AVa=e}},BVa:function(t){var e,o;t&&(e=this.uja,o={},t.forEach((function(t){var e=t.validator;e.n5=t.ranges,e.condition()&&e.condition().ranges(e.n5),o[e.id]=e})),e.Dja=o,e.QV(!1))},CVa:function(t,e,o){this.zVa(),this.uja.rI(t,e,o)},DVa:function(t,e){this.zVa(),this.uja.GR(t,e)},EVa:function(t,e,o){this.zVa(),this.uja.tI(t,e,o)},FVa:function(t,e){this.zVa(),this.uja.HR(t,e)},GVa:function(t){this.zVa(),this.uja.HW(t)},HVa:function(){this.zVa(),this.uja.QV()}}),r.lUa.$n("validator",{init:function(){this.uja=new F(this.kj)},undo:function(t){var e=t.AVa;e&&this.BVa(e)},dispose:function(t){!1!==(t&&t.clearCache)&&this.uja&&(this.uja.no(),this.uja=d)}}),r.Worksheet.$n("validator",{init:function(){var t=this;t.uja=t.ITa.uja,t.Gu(r.Events.FloatingElementSelected+x),t.Fu(r.Events.FloatingElementSelected+x,(function(e,o){"worksheet"!==o.type&&t.hm()}))},dispose:function(t){var e=this;e.hm(),t.clearCache&&e.uja.$b(),!1!==t.clearCache&&e.Gu(r.Events.FloatingElementSelected+x)},onLayoutChanged:function(t){var e=t.changeType,o=t.row,n=t.rowCount,r=t.col,i=t.colCount,a=t.sheetArea,s=this.ITa,l=this.tables;"addRows"===e?s.CVa(o,n,l&&l.KFc(o,-1,n,-1,!0)):"deleteRows"===e?s.DVa(o,n):"addColumns"===e?s.EVa(r,i,l&&l.KFc(-1,r,-1,i,!1)):"deleteColumns"===e?s.FVa(r,i):"clear"===e?3===a&&2==(2&t.type)&&s.GVa(b(o,r,n,i)):"setColumnCount"!==e&&"setRowCount"!==e||3!==a&&1!==a||s.HVa()},toJson:function(t,e){var o,n=this.uja,r=e&&e.ignoreStyle;n&&!r&&((o=n.toJSON(this))&&o.length&&(t.validations=o))},fromJson:function(t,e,o){var n,r=o&&o.ignoreStyle;t&&t.validations&&!r&&(n=t.validations,this.uja.fromJSON(n,e,this))}}),r.Style.$n("validator",{fromJson:function(t){if("validator"===t.p){var e=new O;e.fromJSON(t.v,t.noSchema,t.context),this.validator=e,t.r=!0}}}),k.Yl.km.push((function(t,e){!e&&t.hm&&t.hm()}))},"./node_modules/process/browser.js":function(t,e){var o,n,r,i,a,s,l=t.exports={};function u(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function f(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}function h(){i&&a&&(i=!1,a.length?r=a.concat(r):s=-1,r.length&&p())}function p(){var t,e;if(!i){for(t=f(h),i=!0,e=r.length;e;){for(a=r,r=[];++s<e;)a&&a[s].run();s=-1,e=r.length}a=null,i=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(t){n=c}}(),r=[],i=!1,s=-1,l.nextTick=function(t){var e,o=Array(arguments.length-1);if(arguments.length>1)for(e=1;e<arguments.length;e++)o[e-1]=arguments[e];r.push(new d(t,o)),1!==r.length||i||f(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=g,l.addListener=g,l.once=g,l.off=g,l.removeListener=g,l.removeAllListeners=g,l.emit=g,l.prependListener=g,l.prependOnceListener=g,l.listeners=function(t){return[]},l.binding=function(t){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}},"./node_modules/util/support/isBufferBrowser.js":function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"./node_modules/util/util.js":function(t,e,o){(function(t){var n,r,i,a,s=Object.getOwnPropertyDescriptors||function(t){var e,o=Object.keys(t),n={};for(e=0;e<o.length;e++)n[o[e]]=Object.getOwnPropertyDescriptor(t,o[e]);return n},l=/%[sdj%]/g;function u(t,o){var n={seen:[],stylize:f};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(o)?n.showHidden=o:o&&e.Ia(n,o),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),h(n,t,n.depth)}function c(t,e){var o=u.styles[e];return o?"["+u.colors[o][0]+"m"+t+"["+u.colors[o][1]+"m":t}function f(t,e){return t}function h(t,o,n){var r,i,a,s,l,u,c,f,y;if(t.customInspect&&o&&I(o.inspect)&&o.inspect!==e.inspect&&(!o.constructor||o.constructor.prototype!==o))return b(r=o.inspect(n,t))||(r=h(t,r,n)),r;if(i=p(t,o))return i;if(a=Object.keys(o),s=function(t){var e={};return t.forEach((function(t,o){e[t]=!0})),e}(a),t.showHidden&&(a=Object.getOwnPropertyNames(o)),A(o)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(o);if(0===a.length){if(I(o))return l=o.name?": "+o.name:"",t.stylize("[Function"+l+"]","special");if(T(o))return t.stylize(RegExp.prototype.toString.call(o),"regexp");if(x(o))return t.stylize(Date.prototype.toString.call(o),"date");if(A(o))return d(o)}return u="",c=!1,f=["{","}"],m(o)&&(c=!0,f=["[","]"]),I(o)&&(u=" [Function"+(o.name?": "+o.name:"")+"]"),T(o)&&(u=" "+RegExp.prototype.toString.call(o)),x(o)&&(u=" "+Date.prototype.toUTCString.call(o)),A(o)&&(u=" "+d(o)),0!==a.length||c&&0!=o.length?n<0?T(o)?t.stylize(RegExp.prototype.toString.call(o),"regexp"):t.stylize("[Object]","special"):(t.seen.push(o),y=c?function(t,e,o,n,r){var i,a,s=[];for(i=0,a=e.length;i<a;++i)k(e,i+"")?s.push(g(t,e,o,n,i+"",!0)):s.push("");return r.forEach((function(r){r.match(/^\d+$/)||s.push(g(t,e,o,n,r,!0))})),s}(t,o,n,s,a):a.map((function(e){return g(t,o,n,s,e,c)})),t.seen.pop(),function(t,e,o){var n=t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0);return n>60?o[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+o[1]:o[0]+e+" "+t.join(", ")+" "+o[1]}(y,u,f)):f[0]+u+f[1]}function p(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var o="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(o,"string")}return v(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):C(e)?t.stylize("null","null"):void 0}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function g(t,e,o,n,r,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),k(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=C(o)?h(t,l.value,null):h(t,l.value,o-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),w(a)){if(i&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function m(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function C(t){return null===t}function v(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return void 0===t}function T(t){return S(t)&&"[object RegExp]"===R(t)}function S(t){return"object"==typeof t&&null!==t}function x(t){return S(t)&&"[object Date]"===R(t)}function A(t){return S(t)&&("[object Error]"===R(t)||t instanceof Error)}function I(t){return"function"==typeof t}function R(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function N(t,e){if(!t){var o=Error("Promise was rejected with a falsy value");o.reason=t,t=o}return e(t)}e.format=function(t){var e,o,n,r,i,a;if(!b(t)){for(e=[],o=0;o<arguments.length;o++)e.push(u(arguments[o]));return e.join(" ")}for(o=1,r=(n=arguments).length,i=(t+"").replace(l,(function(t){if("%%"===t)return"%";if(o>=r)return t;switch(t){case"%s":return n[o++]+"";case"%d":return+n[o++];case"%j":try{return JSON.stringify(n[o++])}catch(t){return"[Circular]"}default:return t}})),a=n[o];o<r;a=n[++o])i+=C(a)||!S(a)?" "+a:" "+u(a);return i},e.deprecate=function(o,n){if(void 0!==t&&!0===t.noDeprecation)return o;if(void 0===t)return function(){return e.deprecate(o,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw Error(n);t.traceDeprecation?console.trace(n):console.error(n),r=!0}return o.apply(this,arguments)}},n={},e.debuglog=function(o){if(w(r)&&(r=t.env.NODE_DEBUG||""),o=o.toUpperCase(),!n[o])if(RegExp("\\b"+o+"\\b","i").test(r)){var i=t.pid;n[o]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",o,i,t)}}else n[o]=function(){};return n[o]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=m,e.isBoolean=y,e.isNull=C,e.isNullOrUndefined=function(t){return null==t},e.isNumber=v,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=T,e.isObject=S,e.isDate=x,e.isError=A,e.isFunction=I,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=o("./node_modules/util/support/isBufferBrowser.js"),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.log=function(){(function(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");[t.getDate(),i[t.getMonth()],e].join(" ")})(),e.format.apply(e,arguments)},e.inherits=o("./node_modules/util/node_modules/inherits/inherits_browser.js"),e.Ia=function(t,e){var o,n;if(!e||!S(e))return t;for(n=(o=Object.keys(e)).length;n--;)t[o[n]]=e[o[n]];return t},a="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(a&&t[a]){var e;if("function"!=typeof(e=t[a]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,a,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){var e,o,n,r=new Promise((function(t,n){e=t,o=n})),i=[];for(n=0;n<arguments.length;n++)i.push(arguments[n]);i.push((function(t,n){t?o(t):e(n)}));try{t.apply(this,i)}catch(e){o(e)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),a&&Object.defineProperty(e,a,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,s(t))},e.promisify.custom=a,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function o(){var o,n,r,i,a=[];for(o=0;o<arguments.length;o++)a.push(arguments[o]);if("function"!=typeof(n=a.pop()))throw new TypeError("The last argument must be of type Function");r=this,i=function(){return n.apply(r,arguments)},e.apply(this,a).then((function(e){t.nextTick(i,null,e)}),(function(e){t.nextTick(N,e,i)}))}return Object.setPrototypeOf(o,Object.getPrototypeOf(e)),Object.defineProperties(o,s(e)),o}}).call(this,o("./node_modules/process/browser.js"))},"./node_modules/webpack/buildin/global.js":function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(t,e,o){var n="object"==typeof n?n:{};n.Spread=n.Spread||{},n.Spread.CalcEngine=n.Spread.CalcEngine||{},n.Spread.CalcEngine.AdvancedFunctions=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){var n,r;if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(n=Object.create(null),o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/assets/",o(o.s="./src/advancedFunctions.entry.ts")}({"./src/advancedFunctions.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("CalcEngine");e.Functions=n.Functions,o("./src/functions-db.ts"),o("./src/functions-eng.ts"),o("./src/functions-fin.ts"),o("./src/functions-lookup.ts"),o("./src/functions-stat.ts")},"./src/functions-db.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T;function S(t,e,o,n){for(var r,i=0,a=new v(t,e,o);a.Pk();)r=a.Ok(),(r=n?s(r):r)&&i++;return u(i)}function x(t,e,o,n,r,i,h){for(var p,g,m,y,C=h?1:0,b=0,w=0,T=new v(t,e,o);T.Pk();)if(p=T.Ok(),s(p)){if(g=a(p),d(g))return f;C=h?C*g:C+g,b+=g*g,w++}else if(l(p))return p;return i||h?u(C):(m=Math.max(0,(w*b-C*C)/(w*(w-r))),y=n?Math.sqrt(m):m,w<=1?c:u(y))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("CalcEngine"),i=n.Common.q,a=r.Convert.Pa,s=r.Convert.Na,l=r.Convert.vf,u=r.Convert.Nh,c=r.Errors.DivideByZero,f=r.Errors.Value,h=r.Functions.ak,p=r.Functions.jk,d=isNaN,g=n.Common.u,m=g.kb,y=r.sR().Exp_InvalidCast,C=function(){function t(t,e,o){this.Gk=t,this.Hk=e,this.Wob=o}return t.prototype.Ik=function(t){var e=r.evaluateOperator({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.Gk],t,this.Hk);return!!r.Functions.ik(e)&&r.Convert.Vh(e)},t}(),v=function(){function t(t,e,o){var n=this;if(n.cj=0,n.Jk=t,n.Kk=o,n.Xob={},3===arguments.length){if(n.Lk=n.Mk(t,e),t.rowCount<2||t.colCount<1||o.rowCount<2||o.colCount<1||n.Lk<0||n.Jk.colCount<=n.Lk)throw y}else if(2===arguments.length&&(n.Lk=-1,t.rowCount<2||t.colCount<1||o.rowCount<2||o.colCount<1))throw y}return t.prototype.Mk=function(t,e){var o,n;if(p(e)){for(o=0;o<t.colCount;o++)if((n=r.Convert.bc(t[0][o]))&&this.Nk(n,e))return o;return-1}return r.Convert.Rh(e)-1},t.prototype.Ok=function(){var t=this;if(t.cj<=0||t.Jk.rowCount<=t.cj)throw r.sR().Exp_InvalidOperation;return t.Jk[t.cj][t.Lk]},t.prototype.Pk=function(){for(var t=this,e=!1,o=t.Jk.rowCount;!e&&t.cj<o;)t.cj++,t.cj<o&&(e=t.Qk());return e},t.prototype.Rk=function(t){var e,o,i,a,s;if(p(t)){for(e=["=","<>","<=",">=","<",">"],o=r.Convert.bc(t),i=void 0,a=void 0,i=0;i<e.length;i++)if(n.Common.u.kb(o,e[i]))return o=o.substring(e[i].length),s=n.Common.o.lb(o),d(s)?this.Nk("true",o)?t=!0:this.Nk("false",o)?t=!1:(t=o,a=0===i):t=s,new C(e[i],t,a);return new C("=",t)}return t?new C("=",t):null},t.prototype.Yob=function(t,e){var o,n=this,r=n.Xob,i=function(t,e){return[t,e].join(",")}(t,e),a=r[i];return a||(r[o="_"+i]||(a=r[i]=n.Rk(n.Kk[t][e]),r[o]=!0)),a},t.prototype.Qk=function(){var t,e,o,n,r,a,s,l,u,c=this,f=!1,h=c.Kk,d=c.cj,g=h.rowCount,y=h.colCount,C=c.Jk,v=c.Zob;if(!v){for(n=h[0],v=[],e=0;e<y;e++){if((o=c.Mk(C,n[e]))<0)return!1;v[e]=o}c.Zob=v}for(t=1;!f&&t<g;t++)for(f=!0,e=0;f&&e<y;e++)if(r=c.Yob(t,e)){if(a=C[d][v[e]],"="===r.Gk&&(s=r.Hk,p(s)&&p(a))){l=i.ub(s,!0),u=r.Wob,f=l?i.sb("^"+l+(u?"$":"")).test(a):u?a.toLowerCase()===s.toLowerCase():m(a,s,!0);continue}f=r.Ik(a)}return f},t.prototype.Nk=function(t,e){return t.toLowerCase()===e.toLowerCase()},t}(),h("DAVERAGE",(function(t,e,o){for(var n,i,a=0,h=0,p=new v(t,e,o);p.Pk();){if(n=p.Ok(),l(n))return n;if(s(n)){if(i={value:0},!r.Convert.Th(n,i))return f;a+=i.value,h++}}return 0===h?c:u(a/h)}),3,3,T=[w={Yi:!0,Hi:4,Ii:0},{Yi:!0},w],b="!= 1",b),h("DCOUNT",(function(t,e,o){return S(t,e,o,!0)}),3,3,T,b,b),h("DCOUNTA",(function(t,e,o){return S(t,e,o,!1)}),3,3,T,b,b),h("DGET",(function(t,e,o){var n,i=new v(t,e,o);return i.Pk()?(n=i.Ok(),i.Pk()?r.Errors.Number:n):f}),3,3,T,b,b),h("DMAX",(function(t,e,o){for(var n,i,c=!1,h=-r.Functions.hk,p=new v(t,e,o);p.Pk();){if(n=p.Ok(),l(n))return n;if(s(n)){if(i=a(n),d(i))return f;(!c||i>h)&&(h=i),c=!0}}return c?u(h):0}),3,3,T,b,b),h("DMIN",(function(t,e,o){for(var n,i,c=!1,h=r.Functions.hk,p=new v(t,e,o);p.Pk();){if(n=p.Ok(),l(n))return n;if(s(n)){if(i=a(n),d(i))return f;(!c||n<h)&&(h=n),c=!0}}return c?u(h):0}),3,3,T,b,b),h("DPRODUCT",(function(t,e,o){return x(t,e,o,!1,0,!1,!0)}),3,3,T,b,b),h("DSTDEV",(function(t,e,o){return x(t,e,o,!0,1)}),3,3,T,b,b),h("DSTDEVP",(function(t,e,o){return x(t,e,o,!0,0)}),3,3,T,b,b),h("DSUM",(function(t,e,o){return x(t,e,o,!1,0,!0)}),3,3,T,b,b),h("DVAR",(function(t,e,o){return x(t,e,o,!1,1)}),3,3,T,b,b),h("DVARP",(function(t,e,o){return x(t,e,o,!1,0)}),3,3,T,b,b)},"./src/functions-eng.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt;function Ut(t,e){return new r.Functions.Ui(t,e)}function Wt(t,e){return{Ld:t,_c:e}}function qt(t,e){var o,n=[];for(o=0;o<i(t);o++)n.push(Wt(t[o],e[o]));return n.push(Wt(null,0)),n}function Jt(t,e,o){var n,i,a,s,l,u,c,f=100,p=.5*t,d=p*p;for(p=h(p,m(e)),n=r.Functions.tk(e),i=1,a=0,s=m(e),u=.9*(l=p/n),c=!1;l!==u&&0!==f;)p*=d,n*=++a,i*=++s,u=l,l=o||c?l+p/n/i:l-p/n/i,f--,c=!c;return l}function Xt(t,e){var o=h(e,10),n=parseInt(t,e);return y(n)?v:o/2<=n?n-o:n}function Zt(t,e,o){t<0&&(t+=h(e,10));var n,r=t.toString(e),a=o-i(r);for(n=0;n<a;n++)r="0"+r;return r.toUpperCase()}function Yt(t,e){if(t<0)return v;var o=Xt(t,e);return x(o)?v:o}function Kt(t,e,o){var n=Zt(t,o,e.Qb);return 0<=n&&e.Qb<i(n)&&e.$i?v:n}function Qt(t,e,o,n,r){var a,s;return t<0?v:(a=Xt(t,o),x(a)||r&&(a<-r||r-1<a)?v:(s=Zt(a,n,e.Qb),0<=a&&e.Qb<i(s)&&e.$i?v:s))}function $t(t,e){var o=Number.POSITIVE_INFINITY,n=t.Pi(),r=t.Qi();return y(n)||n===o||y(r)||r===o?v:t.bc(e)}function te(t,e,o,n){var r=t,i=e,a=o.Pi(),s=o.Qi();return{Ri:t=n?r*a-i*s:r+a,Si:e=n?r*s+i*a:i+s}}function ee(t,e){var o,n,a,s,l,u,c,f,h=e?1:0,p=0;for(n=0;n<i(t);n++)if(r.Convert.Ca(t[n]))for(c=t[n],a=0;a<c.rowCount;a++)for(s=0;s<c.columnCount;s++){if(!(o=R(c.getValue(a,s))))return v;h=(u=te(h,p,o,e)).Ri,p=u.Si}else if(r.Convert.Fh(t[n]))for(f=t[n],l=0;l<f.getRangeCount();l++)for(a=0;a<f.getRowCount(l);a++)for(s=0;s<f.getColumnCount(l);s++){if(!(o=R(f.getValue(l,a,s))))return v;h=(u=te(h,p,o,e)).Ri,p=u.Si}else{if(!(o=R(t[n])))return v;h=(u=te(h,p,o,e)).Ri,p=u.Si}return $t(Ut(h,p))}function oe(t,e){var o=T(t*c(2)),n=2*o-1;return e.$i&&(n=2*(o=T(e.Qb*c(2)))-1-n),n}function ne(t){return 1-oe(t,{$i:!1})}function re(t){var e,o=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(e=0;o[e];e++)if(0===t.localeCompare(o[e]))return!1;return!0}function ie(t,e,o){var n,r,a=0,s=1;for(n=0;t[n].Ld;n++)if(0===o.localeCompare(t[n].Ld))return{Tk:!0,Uk:s,Vk:a=t[n]._c};if(e)for(n=0;e[n].Ld;n++)o.substr(0,1)===e[n].Ld.substr(0,1)&&re(o)&&(s=e[n]._c);for(n=0;t[n].Ld;n++)if(r=i(t[n].Ld),o.substr(1,r)===t[n].Ld.substr(0,r)&&re(o))return{Tk:!0,Uk:s,Vk:a=t[n]._c};return{Tk:!1,Uk:s,Vk:a}}function ae(t){if(Dt.indexOf(t)>=0)return!1;var e=[t.slice(0,1),t.slice(1)],o=e[0],n=e[1];return kt.indexOf(o)>=0&&Dt.indexOf(n)>=0}function se(t){for(var e=0;e<U.length;e++)if(t===U[e].Ld)return!0;return"sec"===t.slice(1)||"s"===t.slice(1)}function le(t){var e,o,n,r,i,a,s;if(t.indexOf(At.bit)>-1?(n=(e=[t.slice(0,-3),t.slice(-3)])[0],i=e[1]):t.indexOf(At.byte)>-1&&(n=(o=[t.slice(0,-4),t.slice(-4)])[0],i=o[1]),n)for(s=0;Ot[s].Ld;s++)n===Ot[s].Ld&&(r=Ot[s]._c);else r=1;return i===At.bit?a=xt[0]._c:i===At.byte&&(a=xt[1]._c),{Uk:r,Vk:a}}function ue(t){var e,o,n=1;if(It[t])return{unit:t,prefixNumber:n};if("K"===It[t.slice(1)]||"kel"===It[t.slice(1)]){for(e=t.slice(0,1),t=t.slice(1),o=0;Nt[o].Ld;o++)e===Nt[o].Ld&&(n=Nt[o]._c);return{unit:t,prefixNumber:n}}return{unit:void 0,prefixNumber:n}}function ce(t,e,o,n){var r,i;if(""===t&&""===e)return b;if(i={value:0},!0===k(t,r={value:0})&&!0===k(e,i)){if(e=i.value,(t=r.value)<0||t>M||t%1!=0)return v;if("bitOperator"===o){if(e<0||e>M||e%1!=0)return v}else if("shiftOperator"===o&&0===t)return 0;return n(t,e)}return b}function fe(t,e){if(""===t)return v;if(!0===t||!1===t)return b;var o=R(t);return o?e(o):v}function he(t){var e=t.Pi(),o=t.Qi();return Ut(l(e)*I(o,!1),u(e)*I(o,!0))}function pe(t){var e=t.Pi(),o=t.Qi();return Ut(u(e)*I(o,!1),-l(e)*I(o,!0))}function de(t){var e=t.Pi(),o=t.Qi();return Ut(I(e,!0)*u(o),I(e,!1)*l(o))}function ge(t){var e=t.Pi(),o=t.Qi();return Ut(I(e,!1)*u(o),I(e,!0)*l(o))}function me(t,e){var o,n,r=t.Pi(),i=t.Qi(),a=e.Pi(),s=e.Qi();return Math.abs(s)<Math.abs(a)?Ut((r+i*(o=s/a))/(a+s*o),(i-r*o)/(a+s*o)):Ut((i+r*(n=a/s))/(s+a*n),(i*n-r)/(s+a*n))}function ye(t,e){return t.Pi()===e.Pi()&&t.Qi()===e.Qi()}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("CalcEngine"),i=n.Common.k.ac,a=void 0,s=Math.abs,l=Math.sin,u=Math.cos,c=Math.sqrt,f=Math.log,h=Math.pow,p=Math.exp,d=Math.E,g=Math.atan2,m=parseFloat,y=isNaN,C=r.Errors.NotAvailable,v=r.Errors.Number,b=r.Errors.Value,w=r.Functions.ak,T=r.Functions.qk,S=r.Convert.Nh,x=r.Convert.vf,A=r.Functions.MathHelper,I=A.Dk,R=r.Functions.Wi,M=0xffffffffffff,k=r.Convert.Th,N=Ut(1,0),O=.00220462262184878,j=qt(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,O,602214179421676e9,.0352739619495804,15.432358352941462,D=O/100,D,F=O/112,F,F,.00015747304441777001,110231131092439e-20,E=O/2240,E,E]),G=(L=(P=1e4/254)/12)/3,_=qt(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,.000621371192237334,1/1852,P,L,G,1e10,2834.64566929134,.8748906386701663,105700083402462e-30,B=324077928966473e-31,236.2204724409449,.00062136994949495,B,2834.64566929134]),U=qt(["yr","day","hr","mn","sec","d","min","s"],[1,V=365.25,8766,H=525960,z=60*H,V,H,z]),W=qt(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),J=qt(["N","dyn","lbf","dy","pond"],[1,q=1e5,.22480894309971,q,101.971621297793]),Z=qt(["HP","W","h","w","PS"],[1,X=745.69987158227,1,X,1.013869665424]),et=qt(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,tt=.239005736137667,tt,Y=624150964712042e4,K=1/(3600*X),Q=1/3600,.737562149277265,$=.000947817120313317,Y,K,Q,$]),ot=qt(["T","ga"],[1,1e4]),dt=qt(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,nt=.00492892159375,.00867368942321863,1/96,nt,rt=492892159375e13,rt,1/32256,.000139870932189991,it=.00017406322338,it,at=.30078125,at,st=82073596535e-54,st,lt=492892159375e-17,lt,ut=118251117638e-26,ut,ct=64467860511e-16,ct,ft=775941468987e-27,ft,ht=112266,ht,ht,ht,pt=1740632233796e-18,pt,4351580584491e-18,nt]),gt=qt(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),St=qt(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,mt=10.7639104167097,mt,yt=144*mt,yt,Ct=mt/9,Ct,.000247105381467165,.000247104393046628,1e20,1e20,.01,1e-4,4e-4,vt=Ct/3097600,vt,bt=2.91553349598123e-7,bt,wt=8035216.07043214,wt,wt,wt,Tt=111725076312873e-46,Tt]),xt=qt(["bit","byte"],[1,.125]),At={bit:"bit",byte:"byte"},It={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},Rt=273.15,Mt=459.67,Nt=qt(kt=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Ot=qt(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Dt=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],Et={Hi:5},Gt={Hi:8},Bt={Hi:8,Oi:!0},Vt=[{Hi:0,aj:"<= 0"},Lt={Hi:2,aj:"< 0"}],Ht=[Ft={Hi:0},{Hi:0,_i:0}],zt=[jt={Hi:5,aj:["checkLength 10"]},Pt={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]}],w("BESSELI",(function(t,e){return S(Jt(t,e,!0))}),2,2,_t=[Ft,Lt]),w("BESSELJ",(function(t,e){return S(Jt(t,e,!1))}),2,2,_t),w("BESSELK",(function(t,e){var o,n,r,i,a,l,u,c,h,p=17976931348623157e292,d=.5772156649015329,g=0,m=.25*t*t,y=1,C=0,v=1,b=2/t;if(e>0){for(C=-d,i=1;i<e;i++)C+=1/i,y*=i+1;if(v=b,1===e)g=1/t;else{for(l=1,u=1,o=a=y/e,i=1;i<e;i++){if(o+=n=(a/=e-i)*(u*=-m)/(l*=i),p-s(n)<s(o)||b>1&&p/b<v)return p;v*=b}if(n=s(o*=.5),v>1&&p/v<n||n>1&&p/n<v)return p;g=o*v}}h=-d,0===e?(C=h,n=1):(C+=1/e,n=1/y),o=(h+C-(c=2*f(t/2)))*n,r=1;do{o+=((h+=1/r)+(C+=1/(r+e))-c)*(n*=m/(r*(r+e))),r++}while(s(n/o)>11102230246251565e-32);return o=.5*o/v,0!=(1&e)&&(o=-o),S(g+=o)}),2,2,Vt),w("BESSELY",(function(t,e){var o=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],n=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],r=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],i=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],a=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],s=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],h=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],p=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],d=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],g=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],y=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],C=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],v=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],b=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],w=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],T=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],x=.7978845608028654,A=2.356194490192345,I=.7853981633974483;function R(t,e,o,n){var r=0,i=m(e[r++]),a=o;n&&(i+=t,a--);do{i=i*t+m(e[r++])}while(0!=--a);return i}function M(t,e){var f,d,g,m,y,C=e?o:n,S=e?r:i,M=e?a:s,k=e?h:p,N=e?w:T;return t<=5?(d=t*t,e&&t<1e-5?1-d/4:(g=(d-(e?5.783185962946784:14.681970642123893))*(d-(e?30.471262343662087:49.2184563216946)),g*=f=R(d,e?v:b,3)/R(d,N,8,!0),e?g:g*t)):(f=5/t,g=R(d=e?25/(t*t):f*f,C,6)/R(d,S,6),m=R(d,M,7)/R(d,k,7,!0),(g=g*u(y=t-(e?I:A))-f*m*l(y))*x/c(t))}function k(t,e){var m,v,b,w,T,S=e?o:n,k=e?r:i,N=e?a:s,O=e?h:p,D=e?y:C,F=e?7:8;return t<=5?(m=(e?1:t)*R(v=t*t,e?d:g,e?7:5)/R(v,D,F,!0),m+=.6366197723675814*(e?f(t)*M(t,!0):M(t,!1)*f(t)-1/t)):(m=5/t,b=R(v=e?25/(t*t):m*m,S,6)/R(v,k,6),w=R(v,N,7)/R(v,O,7,!0),(b=b*l(T=t-(e?I:A))+m*w*u(T))*x/c(t))}return S(function(t,e){var o,n=k(t,!0),r=k(t,!1),i=1,a=2*i;if(0===e)return n;if(1===e)return r;do{o=a*r/t-n,n=r,r=o,a+=2,++i}while(i<e);return o}(t,e))}),2,2,Vt),w("BIN2DEC",(function(t){return Yt(t,2)}),1,1,jt),w("BIN2HEX",(function(t,e){return Qt(t,e,2,16)}),1,2,zt,a,a,{bk:1}),w("BIN2OCT",(function(t,e){return Qt(t,e,2,8)}),1,2,zt,a,a,{bk:1}),w("DEC2BIN",(function(t,e){return Kt(t,e,2)}),1,2,[{Hi:0,aj:["< -512","> 511"]},Pt],a,a,{bk:1}),w("DEC2HEX",(function(t,e){return Kt(t,e,16)}),1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},Pt],a,a,{bk:1}),w("DEC2OCT",(function(t,e){return Kt(t,e,8)}),1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},Pt],a,a,{bk:1}),w("HEX2BIN",(function(t,e){return Qt(t,e,16,2,512)}),1,2,zt,a,a,{bk:1}),w("HEX2DEC",(function(t){return Yt(t,16)}),1,1,jt),w("HEX2OCT",(function(t,e){return Qt(t,e,16,8,536870912)}),1,2,zt,a,a,{bk:1}),w("OCT2BIN",(function(t,e){return Qt(t,e,8,2,512)}),1,2,zt,a,a,{bk:1}),w("OCT2DEC",(function(t){return Yt(t,8)}),1,1,jt),w("OCT2HEX",(function(t,e){return Qt(t,e,8,16,549755813888)}),1,2,zt,a,a,{bk:1}),w("ERF",oe,1,2,[Ft,{Zi:!0,Hi:0}],a,a,{bk:1}),w("ERF.PRECISE",(function(t){return oe(t,{$i:!1})}),1,1,Ft),w("ERFC",ne,1,1,Ft),w("ERFC.PRECISE",ne,1,1,Ft),w("DELTA",(function(t,e){return r.Zh.Yh(t,e)?1:0}),1,2,Ht,a,a,{bk:1}),w("GESTEP",(function(t,e){return t>=e?1:0}),1,2,Ht,a,a,{bk:1}),w("COMPLEX",(function(t,e,o){return"i"!==o&&"j"!==o?r.Errors.Value:$t(Ut(t,e),o)}),2,3,[Ft,Ft,{Hi:5,_i:"i"}],a,a,{bk:2}),w("IMABS",(function(t){return S(c(t.Ri*t.Ri+t.Si*t.Si))}),1,1,Gt),w("IMAGINARY",(function(t){return S(t.Si)}),1,1,Gt),w("IMARGUMENT",(function(t){return 0===t.Ri&&0===t.Si?r.Errors.DivideByZero:S(g(t.Si,t.Ri))}),1,1,Gt),w("IMCONJUGATE",(function(t){return $t(Ut(t.Ri,-t.Si))}),1,1,Gt),w("IMCOS",(function(t){return $t(Ut(u(t.Ri)*I(t.Si,!1),-l(t.Ri)*I(t.Si,!0)))}),1,1,Gt),w("IMDIV",(function(t,e){var o=t.Ri,n=t.Si,r=e.Ri,i=e.Si;return $t(Ut((o*r+n*i)/(r*r+i*i),(n*r-o*i)/(r*r+i*i)))}),2,2,[Gt,Bt]),w("IMEXP",(function(t){return $t(Ut(p(t.Ri)*u(t.Si),p(t.Ri)*l(t.Si)))}),1,1,Gt),w("IMLN",(function(t){var e=t.Ri,o=t.Si;return $t(Ut(f(c(e*e+o*o)),g(o,e)))}),1,1,Bt),w("IMLOG10",(function(t){var e=t.Ri,o=t.Si,n=A.Ek(d,10);return $t(Ut(n*f(c(e*e+o*o)),n*g(o,e)))}),1,1,Bt),w("IMLOG2",(function(t){var e=t.Ri,o=t.Si,n=A.Ek(d,2);return $t(Ut(n*f(c(e*e+o*o)),n*g(o,e)))}),1,1,Bt),w("IMREAL",(function(t){return S(t.Ri)}),1,1,Gt),w("IMSIN",(function(t){return $t(Ut(l(t.Ri)*I(t.Si,!1),u(t.Ri)*I(t.Si,!0)))}),1,1,Gt),w("IMSQRT",(function(t){var e,o,n=t.Ri,r=t.Si;return 0===n&&0===r?"0":(e=c(n*n+r*r),o=g(r,n),$t(Ut(c(e)*u(o/2),c(e)*l(o/2))))}),1,1,Gt),w("IMSUB",(function(t,e){return $t(Ut(t.Ri-e.Ri,t.Si-e.Si))}),2,2,[Gt,Gt]),w("IMPOWER",(function(t,e){var o,n,r=t.Ri,i=t.Si;return 0===r&&0===i?e>0?"0":v:(o=c(r*r+i*i),n=g(i,r),$t(Ut(h(o,e)*u(e*n),h(o,e)*l(e*n))))}),2,2,[Gt,{Hi:2}]),w("IMPRODUCT",(function(){return ee(arguments,!0)}),1,255,a,-1,-1),w("IMSUM",(function(){return ee(arguments,!1)}),1,255,a,-1,-1),w("CONVERT",(function(t,e,o){var n,r,a,s,l,u,c,f,h,p,d;if(ue(e).unit&&ue(o).unit)return function(t,e,o){var n,r=ue(e);switch(r.unit){case It.Rank:n=function(t,e){var o,n=ue(e);switch(n.unit){case It.Rank:return t;case It.Reau:return.8*(t-Mt-32)*5/9;case It.C:case It.cel:return 5*(t-Mt-32)/9;case It.F:case It.fah:return t-Mt;case It.K:case It.kel:return o=n.prefixNumber,(Rt+5*(t-Mt-32)/9)/o}}(t,o);break;case It.Reau:n=function(t,e){var o,n=ue(e);switch(n.unit){case It.Rank:return 1.25*t*9/5+32+Mt;case It.Reau:return t;case It.C:case It.cel:return 1.25*t;case It.F:case It.fah:return 1.25*t*9/5+32;case It.K:case It.kel:return o=n.prefixNumber,(1.25*t+Rt)/o}}(t,o);break;case It.C:case It.cel:n=function(t,e){var o,n=ue(e);switch(n.unit){case It.Rank:return 9*t/5+32+Mt;case It.Reau:return.8*t;case It.cel:case It.C:return t;case It.F:case It.fah:return 9*t/5+32;case It.K:case It.kel:return o=n.prefixNumber,(t+Rt)/o}}(t,o);break;case It.F:case It.fah:n=function(t,e){var o,n=ue(e);switch(n.unit){case It.Rank:return t+Mt;case It.Reau:return 4*(t-32)/9;case It.F:case It.fah:return t;case It.C:case It.cel:return 5*(t-32)/9;case It.K:case It.kel:return o=n.prefixNumber,(5*(t-32)/9+Rt)/o}}(t,o);break;case It.K:case It.kel:n=function(t,e){var o=ue(e);switch(o.unit){case It.Rank:return 9*t/5;case It.Reau:return.8*(t-Rt);case It.C:case It.cel:return t-Rt;case It.F:case It.fah:return 9*(t-Rt)/5+32;case It.K:case It.kel:return t/o.prefixNumber}}(t*r.prefixNumber,o)}return n}(t,e,o);if(n=function(t,e){var o=t.indexOf("bit")>-1||t.indexOf("byte")>-1,n=e.indexOf("bit")>-1||e.indexOf("byte")>-1;return o&&n?2:n||o?1:0}(e,o),1===n)return C;if(2===n)return function(t,e,o){var n=le(e),r=le(o);return t*n.Uk/n.Vk*r.Vk/r.Uk}(t,e,o);if(se(e)&&se(o))return function(t,e,o){var n=ie(U,Nt,e),r=ie(U,Nt,o);return t*n.Uk/n.Vk*r.Vk/r.Uk}(t,e,o);if(ae(e)||ae(o))return C;for(r=[j,_,W,J,et,Z,ot,dt,ot,gt,St],a=0;a<i(r);a++)if(u=(l=ie(s=r[a],Nt,e)).Tk,c=l.Vk,f=l.Uk,h=(l=ie(s,Nt,o)).Tk,p=l.Uk,d=l.Vk,u&&h&&0!==c&&0!==p)return t*f/c*d/p;return C}),3,3,[{Hi:1},Et,Et]),w("BITAND",(function(t,e){return ce(t,e,"bitOperator",(function(t,e){return t&e}))}),0,2),w("BITLSHIFT",(function(t,e){return ce(t,e,"shiftOperator",(function(t,e){if(e>=48)return v;if(e<0&&t<1<<-e)return 0;var o=t<<e;return o>M?v:o}))}),0,2),w("BITOR",(function(t,e){return ce(t,e,"bitOperator",(function(t,e){return t|e}))}),0,2),w("BITRSHIFT",(function(t,e){return ce(t,e,"shiftOperator",(function(o,n){return n>53?v:e>=0?t>>e:t<<-e}))}),0,2),w("BITXOR",(function(t,e){return ce(t,e,"bitOperator",(function(t,e){return t^e}))}),0,2),w("IMCOSH",(function(t){return fe(t,(function(t){return $t(ge(t),t.lja())}))}),1,1),w("IMCOT",(function(t){return fe(t,(function(t){return ye(he(t),Ut(0,0))?v:$t(me(pe(t),he(t)),t.lja())}))}),1,1),w("IMCSC",(function(t){return fe(t,(function(t){return ye(t,Ut(0,0))?v:$t(function(t){return me(N,he(t))}(t),t.lja())}))}),1,1),w("IMCSCH",(function(t){return fe(t,(function(t){return ye(de(t),Ut(0,0))?v:$t(function(t){return me(N,de(t))}(t),t.lja())}))}),1,1),w("IMSEC",(function(t){return fe(t,(function(t){return ye(pe(t),Ut(0,0))?v:$t(function(t){return me(N,pe(t))}(t),t.lja())}))}),1,1),w("IMSECH",(function(t){return fe(t,(function(t){return ye(ge(t),Ut(0,0))?v:$t(function(t){return me(N,ge(t))}(t),t.lja())}))}),1,1),w("IMSINH",(function(t){return fe(t,(function(t){return $t(de(t),t.lja())}))}),1,1),w("IMTAN",(function(t){return fe(t,(function(t){return $t(function(t){return me(he(t),pe(t))}(t),t.lja())}))}),1,1)},"./src/functions-fin.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt;function wt(t){return t.getMonth()}function Tt(t){return t.getDate()}function St(t){return t.getFullYear()}function xt(t){return t instanceof Date?n.Common.l.Ra(t):t}function At(t,e,o){var n=St(e)-St(t),i=wt(e)-wt(t)+12*n,a=Tt(e)-Tt(t),s=-1;return 0===o?s=r.Functions.uk(t,e):u(o,[1,2,3])>=0?s=xt(e)-xt(t):4===o&&(s=30*i+a),s}function It(t,e,o,n,r){var i,s=w(1+t,e),l=a(s)?s:O;return 0===t?e:d(l)||(i=a(s=(s-1)/t)?s:O,d(i))?O:a(s=(-o*l-n)/((1+t*r)*i))?s:O}function Rt(t,e,o,n){var r=St(e),i=wt(e),a=Tt(e),s=new Date(1,0,1),l=0,u=a===L(r,i),c=12/o,f=r-St(t);s.setFullYear(1),f>0&&(f=(f-1)*o);do{f++,(s=new Date(r,i,a)).setMonth(i-f*c),u&&(l=L(St(s),wt(s)),s=new Date(St(s),wt(s),l))}while(G(t,s)<0);return n&&(f--,(s=new Date(r,i,a)).setMonth(i-f*c),u&&(l=L(St(s),wt(s)),s=new Date(St(s),wt(s),l))),s}function Mt(t,e,o,n){return B(Rt(t,e,o,!1),t,n)}function kt(t,e,o,n){return u(n,[0,2,4,5])>=0?360/o:3===n?365/o:B(Rt(t,e,o,!1),Rt(t,e,o,!0),1)}function Nt(t,e,o,n){return B(t,Rt(t,e,o,!0),n)}function Ot(t,e,o){var n=St(e),r=wt(e),i=Tt(e),a=new Date(n,r,i),l=r-wt(t)+12*(n-St(t));if(a.setMonth(wt(a)-l),i===L(n,r))for(;Tt(a)!==L(St(a),wt(a));)a.setDate(Tt(a)+1);return Tt(t)>=Tt(a)&&l--,s(""+(1+l/(12/o)))}function Dt(t,e,o){return e>0?(o.Wk?o.Xk?T(t-o.Yk)<T(o.Zk-o.Yk)&&(o.Zk=t,o.$k=e):e<o.$k&&(o.Zk=t,o.$k=e):(o.Zk=t,o.$k=e,o.Wk=!0),[!1,o]):e<0?(o.Xk?o.Wk?T(t-o.Zk)<T(o.Zk-o.Yk)&&(o.Yk=t,o._k=e):-e<-o._k&&(o.Yk=t,o._k=e):(o.Yk=t,o._k=e,o.Xk=!0),[!1,o]):isNaN(e)?[!1,o]:(o.al=t,[!0,o])}function Ft(t,e,o,n,r){var i,a=Rt(t,o,n,!0),s=Rt(t,o,n,!1);if(G(a,e)>=0)return B(t,e,r)/kt(s,a,n,r);for(i=B(t,a,r)/kt(s,a,n,r);;){if(s=new Date(St(a),wt(a),Tt(a)),a.setMonth(wt(a)+12/n),G(a,e)>=0)return i+B(s,e,r)/kt(s,a,n,r);i+=1}}function Et(t,e,o,n,r,i,a){var l,u=Mt(t,e,i,a),c=Nt(t,e,i,a),f=kt(t,e,i,a),h=s(""+Ot(t,e,i)),p=0,d=100*o/i,g=1+n/i,m=c/f;for(l=0;l<h;l++)p+=d/w(g,m+l);return r/w(g,h-1+c/f)+p-u/f*d}function jt(t,e,o,n,r,i,a,l,u){var c,f,h,p=B(l,t,a),d=B(t,u,a),g=B(l,u,a),m=kt(t,e,i,a),y=s(""+Ot(t,e,i)),C=100*o/i,v=1+n/i;if(d>m)switch(a){case 0:case 4:c=B(u,e,a),y=1+s(""+S(c/m));break;default:for(f=new Date(St(u),wt(u),Tt(u)),y=0;y<32767;y++)if(h=new Date(St(f),wt(f),Tt(f)),f.setMonth(wt(f)+12/i),G(f,e)>=0){y+=s(""+S(B(h,e,a))/kt(h,f,i,a))+1;break}p=m*Ft(l,t,u,i,a),d=m*Ft(t,u,u,i,a),g=m*Ft(l,u,u,i,a)}return r/w(v,y-1+d/m)+C*(g/m/w(v,d/m)+w(v,-d/m)*(w(v,-y)-1/v)/(1/v-1)-p/m)}function Pt(t,e){var o=t.substr(0,3),n={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return n[o]?E(n[o],e):-1}function Lt(t,e,o,n,r){var i=w(1+t,e);return-(0===t?n+o*e:n*i+o*(r>0?1+t:1)*(i-1)/t)}function Gt(t,e,o,n,r,i,a){if(i<r||i>o||0!==a&&1!==a)return O;var s,l,u=function(t,e,o,n,r){var i,a=w(1+t,e);return 0===t?i=(o+n)/e:(i=n*t/(a-1)+o*t/(1-1/a),r>0&&(i/=1+t)),-i}(e,o,n,0,a),c=0;for(1===r&&(t&&(c=u),a<=0&&(c+=t?n*e:-n),r++),s=r;s<=i;s++)l=a>0?Lt(e,s-2,u,n,1)-u:Lt(e,s-1,u,n,0),c+=t?u-l*e:l;return t?c:c*e}function Bt(t,e,o,n){var r=w(1+o,n),i=-(t*r*o+e*(r-1));return a(i)?i:O}function _t(t,e,o,n,r){return u(n,[1,2,4])<0||G(e,o)>=0?O:t(e,o,n,r)}function Vt(t,e,o,n,r,i){if(u(i,[1,2,4])<0||G(e,o)>0)return O;var a=function(t,e,o,n){var r,i=0,a=0;for(t*=100/y(o),e/=o,e++,r=1;r<n;r++)i+=r*t/w(e,r);for(i+=n*(t+100)/w(e,n),r=1;r<n;r++)a+=t/w(e,r);return(i/=a+=(t+100)/w(e,n))/y(o)}(n,r,i,Ot(e,o,i));return t?a/(1+r/i):a}function Ht(t,e,o,n,r,i,a,s,l){var c,f,h,p;if(u(a,[1,2,4])<0||G(e,o)>0||G(n,e)>0)return O;c=new Date(St(n),wt(n),Tt(n));do{c.setMonth(wt(c)+12/a)}while(G(c,o)<0);return f=Ft(n,e,c,a,s),h=Ft(n,o,c,a,s),p=Ft(e,o,c,a,s),t?(i*a+100*r*(h-f*(1+l*p/a)))/(l*p+a):(a*(i-l)+100*r*(h-f))/(p*l+100*r*f*p/a)}function zt(t,e,o){var n,r,i;return 0===o?k:(n=e<0?S(e):I(e),r=w(10,S(F.Ek(o,10))),i=e-n,g(n+(t?i*r/o:i*o/r)))}function Ut(t,e,o,n){var r,i,a=h(e),s=0,l=1+t,u=0;if(l>=.75&&l<=1.25&&a>12&&n&&(u=2.5),o)for(r=0;r<a;r++){if(i=-(r-u)*e[r]*Math.pow(l,-(r-u)-1),isNaN(i))return s;s+=i}else for(r=0;r<a;r++){if(i=e[r]*Math.pow(l,-(r-u)),isNaN(i))return s;s+=i}return s}function Wt(t,e,o,n){var r,i,s=0,l=h(e);for(t<=-1&&(t=1e-10-1),r=0;r<l;r++){if((i=xt(n[r])-xt(n[0]))<0)return[!1,o];s+=e[r]/F.Ck(t,i/365)}return a(s)?o=isNaN(s)?5e-324:s:s===Number.POSITIVE_INFINITY?o=j:s===Number.NEGATIVE_INFINITY&&(o=-j),[!0,o]}function qt(t,e,o,n){var r,i,a;return t>-1&&0!==t?(i=w(1+t,(r=o).bl-(n?1:0)),a=(w(1+t,r.bl)-1)/t,[!0,e=n?-r.cl*a/t+i*r.bl*(r.dl+r.cl*(r.Nc+1/t)):r.dl*i+r.cl*(1+t*r.Nc)*a+r.el,o]):[!1,e,o]}function Jt(t,e,o,n,r,i,a,s,l,u,f,h,p,d,g){var m,y,C,v,b=0,w=0,T=o-r,S=o+r,x=2===t;if(T<i.fl&&(T=o),S>i.gl&&(S=o),T===S)return x?[!1,n,i,a]:[!1,n,i];if(0===t?(m=e(a,s,l,T,f,h,p,d,g)-u,y=e(a,s,l,S,f,h,p,d,g)-u):1===t?(m=e(T,a,b,s),y=e(S,a,w,s)):(m=qt(T,b,a),y=qt(S,w,a)),c(m)){if(v=m[2],b=m[1],!(C=m[0]))return x?[C,n,i,v]:[C,n,i]}else b=m;if(c(y)){if(v=y[2],w=y[1],!(C=y[0]))return x?[C,n,i,v]:[C,n,i]}else w=y;return n=(w-b)/(S-T),x?[!0,n,i,v]:[!0,n,i]}function Xt(t,e,o,n,r,i,a,s,l,u,c,f,h){var p;return n<o.fl||n>o.gl?[!1,o]:(o=(p=Dt(n,t?Ut(n,r):e(r,i,a,n,l,u,c,f,h)-s,o))[1],[!!p[0],o])}function Zt(t,e,o){var n,r,i=0;return e<t.fl||e>t.gl?[!1,t,o]:(o=(n=qt(e,i,o))[2],i=n[1],n[0]?(t=(r=Dt(e,i,t))[1],[!!r[0],t,o]):[n[0],t,o])}function Yt(t,e,o,n,r,i,a,s,l,u){var c,f,h,p,d=0,g=t?15:2;if(!o.Wk||!o.Xk)return t?[!1,o,n]:[!1,o];for(f=T(o.Zk-o.Yk)/(T(o.Zk)+T(o.Yk)),c=0;c<100+4*g;c++)if(0,0,void 0,h=c%4==0?1:c%4==2?2:3,void 0,o=(p=t?oe(o,n,f,d,0,h):e?ne(!0,o,d,0,0,h,Wt,f,r,n,Jt):ne(!1,o,d,0,0,h,Et,f,i,a,s,n,r,l,u))[1],t&&(n=p[2]),d=t?p[3]:p[2],p[0])return t?[!0,o,n]:[!0,o];return t?[!1,o,n]:[!1,o]}function Kt(t,e,o,n,r,i,a,s,l,u,c){var h,p,d,g,m,y,C,w=0,S=t?15:2;if(!e.Wk||!e.Xk)return[!1,e];for(p=T(e.Zk-e.Yk)/(T(e.Zk)+T(e.Yk)),h=0;h<100+4*S;h++)if(d=0,g=0,void 0,m=h%4==0?1:h%4==2?2:3,e=(y=t?ne(!0,e,w,d,g,m,Ut,p,b,o,Jt):ne(!1,e,w,d,g,m,jt,p,a,s,l,o,n,u,c,r,i))[1],w=y[2],d=y[3],!(t&&y[0]===v||!t&&f(y[0]))){if(y[0])return[!0,e];if(e=(C=Dt(d,g=t?Ut(d,o):jt(o,n,a,d,l,u,c,r,i)-s,e))[1],C[0])return[!0,e];if((p=T(e.Zk-e.Yk)/(T(e.Zk)+T(e.Yk)))<e.hl)return e._k<g&&(g=e._k,d=e.Yk),e.$k<g&&(d=e.Zk),e.al=d,[!0,e]}return[!1,e]}function Qt(t,e,o,n,r,i,a,s,l,u,f,h,p){var d,g,m,y,C,v,b,w,S,x,A,I,R,M,k,N,O,D,F=o.hl/2,E=!1;for(g=0;g<20;g++){if(n<o.fl||n>o.gl){if(!t||o.Xk&&o.Wk||!(n<=-1))return[!1,o];n=-1,E=!0}if(C=t?Wt(n,r,0,i):e(r,i,a,n,l,u,f,h,p)-s,c(C)){if(y=C[1],!(m=C[0]))return[m,o]}else y=C;if(o=(v=Dt(n,y,o))[1],v[0])return[!0,o];if(E)return[!1,o];if(b=o.Xk&&o.Wk?T(o.Zk-o.Yk):o.gl-o.fl,w=(T(n)<1e-10?b:T(n))/1e6,S=0,o=(v=t?Jt(1,Wt,n,S,w,o,r,i):Jt(0,e,n,S,w,o,r,i,a,s,l,u,f,h,p))[2],S=v[1]<0?v[1]:-v[1],!(m=v[0]))return[m,o];if(0===S)return[!1,o];if((x=n-1.000001*y/S)===n)return o.al=n,[!0,o];if(t&&o.Xk&&o.Wk&&(x<(I=(A=[o.Zk,o.Yk])[0])==x<(R=A[1])&&(M=!0,I>R&&(I=(d=[R,I])[0],R=d[1],M=!1),N=(k=[o.$k,o._k])[0],O=k[1],x=I+T((M?N:O)/(O-N))*(R-I))),D=T(x-n)/(T(n)+T(x)),n=x,D<F)return o.al=n,[!0,o]}return[!1,o]}function $t(t,e,o){for(var n,r,a,s,l,u,c,f=t.hl/2,h=0;0===e[h];)h++;for(n=e.slice(h),a=[!1,null],s=[o],.1!==o&&s.push(.1),s.push(-.1,.99*t.gl,t.fl+.01),l=0;!a[0]&&l<s.length;l++)te(a=ee(i(t),n,s[l],f),n);if(!a[0]){for(u=0,l=1,c=n.length;l<c;l++)u+=n[l];r=-u/n[0]-1,a=ee(i(t),n,r,f)}return a}function te(t,e){var o,r,i,a;t[0]&&(r=15,"number"==typeof(o=t[1].al)&&o>-10&&o<10&&(((i=""+o).indexOf("000000000000")>1||i.indexOf("999999999999")>1)&&(r=14)),((a=re(o=n.Common.o.Lma(o,r),e))>.001||a<-.001)&&(t[0]=!1))}function ee(t,e,o,n){var r,i,a,s,l,u;for(r=0;r<32;r++){if(o<t.fl||o>t.gl)return[!1,t];if(t=(a=Dt(o,i=Ut(o,e,!1,!0),t))[1],a[0])return[!0,t];if(0===(s=Ut(o,e,!0,!0)))return[!1,t];if((l=o-1.0000001*i/s)===o)return t.al=o,[!0,t];if(u=T(l-o)/(T(o)+T(l)),o=l,u<n)return t.al=o,[!0,t]}return[!1,t]}function oe(t,e,o,n,r,i){var a,s,l,u,c,f,h;if(1===i){if(void 0,e=(s=qt(a=(t.Zk+t.Yk)/2,r,e))[2],r=s[1],!s[0])return[v,t,e,n];if(0===r)return[!0,t=Dt(a,r,t)[1],e,n];if(0===A(r*r-t.$k*t._k))return[v,t,e,n]}else if(2===i){if(l=void 0,void 0,u=0,c=0,o>.1)return oe(t,e,o,n,r,i=3);if(0===(f=n++%4))l=t.Zk,u=t.$k;else if(2===f)l=t.Yk,u=t._k;else if(e=(s=qt(l=(t.Zk+t.Yk)/2,u,e))[2],u=s[1],!s[0])return[v,t,e,n];if(e=(h=Jt(2,void 0,l,c,T(t.Zk-t.Yk)/1e6,t,e))[3],t=h[2],c=h[1],!h[0]||0===c)return[v,t,e,n];if((a=l-1.01*u/c)<t.Zk&&a<t.Yk||a>t.Zk&&a>t.Yk)return[v,t,e,n]}return[!1,t,e,n]}function ne(t,e,o,n,r,i,a,s,l,u,f,h,p,d,g,m,y){var C,b,w,S,x,I,R,M;switch(i){case 0:n=e.Zk-e.$k*((e.Yk-e.Zk)/(e._k-e.$k));break;case 1:if(n=(e.Zk+e.Yk)/2,C=t?a(n,u,r,l):a(h,p,l,n,f,d,g,m,y)-u,c(C)){if(r=C[1],!C[0])return[v,e,o,n,r,i]}else r=C;if(0===r)return[!0,e=Dt(n,r,e)[1],o,n,r,i];if(0===(b=A(r*r-e.$k*e._k)))return[v,e,o,n,r,i];n+=(n-e.Zk)*r/b;break;case 3:n=(e.Zk+e.Yk)/2;break;case 2:if(w=void 0,S=0,void 0,I=0,s>.1)return ne(t,e,o,n,r,i=3,a,s,l,u,f,h,p,d,g);if(0===(R=o++%4))w=e.Zk,S=e.$k;else if(2===R)w=e.Yk,S=e._k;else if(w=(e.Zk+e.Yk)/2,C=t?a(w,u,S,l):a(h,p,l,w,f,d,g,m,y)-u,c(C)){if(S=C[1],!C[0])return[v,e,o,n,r,i]}else S=C;if(x=T(e.Zk-e.Yk)/1e6,e=(M=t?f(1,a,w,I,x,e,u,l):Jt(0,a,w,I,x,e,h,p,l,u,f,d,g,m,y))[2],I=M[1],!M[0]||0===I)return[v,e,o,n,r,i];if((n=w-1.01*S/I)<e.Zk&&n<e.Yk||n>e.Zk&&n>e.Yk)return[v,e,o,n,r,i]}return C=t?a(n,u,r,l):a(h,p,l,n,f,d,g,m,y)-u,c(C)&&(r=C[1],!C[0])?[v,e,o,n,r,i]:Dt(n,r,e)[0]?[!0,e,o,n,r,i]:(s=T(e.Zk-e.Yk)/(T(e.Zk)+T(e.Yk)))<e.hl?(e._k<r&&(r=e._k,n=e.Yk),e.$k<r&&(r=e.$k,n=e.Zk),e.al=n,[!0,e,o,n,r,i]):[!1,e,o,n,r,i]}function re(t,e){var o,n,r,i=arguments,a=0,s=1;for(n=1;n<h(i);n++){if((r=m(i[n],1,!0,!0,!1,!0)).isError)return r[0];for(o=0;o<h(r);o++)r[o]!==C&&(a+=r[o]/w(1+t,s++))}return a}function ie(t,e,o){return xt(Rt(t,e,o,!0))}function ae(t,e,o){return xt(Rt(t,e,o,!1))}function se(t,e,o,n){var r,i,a=n.hl,s=n.Xk&&n.Wk?[n.Zk,n.Yk]:function(t,e,o,n){for(var r=.5,i=o-r,a=o+r,s=0;Wt(i,t,0,e)[1]*Wt(a,t,0,e)[1]>0&&s++<n;)i-=r,a+=r;return s>=n?[0,0]:[i,a]}(t,e,o,100),l=s[0],u=s[1],c=Wt(l,t,0,e)[1],f=Wt(u,t,0,e)[1],h=0;for(r=0;r<100&&!(c*f>0);r++)if((i=Wt(h=(l+u)/2,t,0,e)[1])*c<0?(u=h,f=i):(l=h,c=i),T(l-u)<a)return[!0,h];return[!1,h]}function le(t,e,o,n,r){var i,a,s,l=r/o;return l>=1?(l=1,a=1===n?t:0):a=t*w(1-l,n-1),(i=a-((s=t*w(1-l,n))<e?e:s))<0?0:i}function ue(t,e,o,n,r,i){var a,s,l,u=0,c=0,f=S(r),h=f,p=t-e,d=!1;for(l=1;l<=h;l++)d?s=c:(c=p/(n-(l-1)))>(a=le(t,e,o,l,i))?(s=c,d=!0):(s=a,p-=a),l===h&&(s*=r+1-f),u+=s;return u}function ce(t,e,o,n){var r,i,a;return""===t&&""===e&&""===o?N:(t=V(t,r={value:0}),e=V(e,i={value:0}),o=V(o,a={value:0}),!0===t&&!0===e&&!0===o?n(r,i,a):N)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("CalcEngine"),i=n.Common.j.C4,a=isFinite,s=parseInt,l=n.Common.j,u=l.Ea,c=l.Ca,f=l.Fa,h=n.Common.k.ac,p=r.Convert.Rh,d=r.Convert.vf,g=r.Convert.Nh,m=r.Convert.Ph,y=r.Convert.Pa,C=r.Convert.CalcConvertedError,v=null,b=void 0,w=Math.pow,T=Math.abs,S=Math.ceil,x=Math.log,A=Math.sqrt,I=Math.floor,R=Math.max,M=Math.min,k=r.Errors.DivideByZero,N=r.Errors.Value,O=r.Errors.Number,D=r.Functions.ak,F=r.Functions.MathHelper,E=F.Ak,j=r.Functions.hk,P=r.Functions.lk,L=r.Functions.nk,G=r.Functions.mk,B=r.Functions.pk,_=r.Functions.vk,V=r.Convert.Th,H=2.98023e-9,q={Hi:0,aj:"< 1"},J={Hi:0,aj:"< 0"},X={_i:.1,Hi:0},Z={_i:2,Hi:0},Y={_i:1e3,Hi:0,aj:"<= 0"},Q={Hi:5},$={_i:!1,Hi:7},nt={_i:0,Hi:2},it={Hi:2,aj:"= 0",bj:k},st={Hi:4,Ii:1,Ji:!0,Ki:!0},lt={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},ut={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ct={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},ft={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},ht=[K={Hi:6},K,tt={Hi:2},rt={_i:0,Hi:2,aj:["< 0","> 4"]}],pt=[K,K,z={Hi:0},z,tt,rt],dt=[K,K,W={Hi:0,aj:"<= 0"}],gt=[z,K,K,z,tt,W,{_i:0,Hi:2,aj:["< 0","> 4","= 2"]}],yt=[K,K,W,W,rt],Ct=[W,et={Hi:2,aj:"<= 0"},W,ot={Hi:2,aj:"< 1"},tt,tt],vt=[W,ot],bt=[z,at={Hi:2,aj:"< 0"}],D("FV",(function(t,e,o,n,r){r=r?1:0;var i=w(1+t,e);return g(-(i=0===t?o*e+n:n*i+o*(1+t*r)*(i-1)/t))}),3,5,mt=[z,z,z,U={_i:0,Hi:0},U],b,b,{bk:[3,4]}),D("FVSCHEDULE",(function(t,e){for(var o=0;o<h(e);o++)e[o]!==C&&(t*=1+e[o]);return t}),2,2,[z,st],1,1),D("NPV",re,2,b,z,"> 0","> 0"),D("PV",(function(t,e,o,n,r){if(r=r?1:0,0===t)return g(-(o*e+n));var i=w(1+t,e);return-1===t?k:g(-(n+o*(1+t*r)*(i-1)/t)/i)}),3,5,mt,b,b,{bk:[3,4]}),D("RECEIVED",(function(t,e,o,n,r){var i,a,s;return G(t,e)>=0?O:(i=At(t,e,r),a=P(t,r),i<=0||a<=0?O:(s=1-n*i/a)<=0?O:o/s)}),4,5,yt,b,b,{bk:3}),D("XNPV",(function(t,e,o){var n,r=h(e),i=0;if(r!==h(o))return O;if(e.some((function(t){return t===C})))return N;for(n=0;n<r;n++)i+=e[n]/w(1+t,(o[n]-o[0])/365);return i}),3,3,[z,ct,ct],"!= 0","!= 0"),D("CUMIPMT",(function(t,e,o,n,r,i){return Gt(!1,t,e,o,n,r,i)}),6,6,Ct),D("CUMPRINC",(function(t,e,o,n,r,i){return Gt(!0,t,e,o,n,r,i)}),6,6,Ct),D("IPMT",(function(t,e,o,n,r,i){return e>=o+1||0!==i&&1!==i?O:Bt(n,It(t,o,n,r,i),t,e-1)}),4,6,[z,q,q,z,U,nt],b,b,{bk:[4,5]}),D("ISPMT",(function(t,e,o,n){return g(n*t*(e/o-1))}),4,4,[z,tt,it,z]),D("PMT",(function(t,e,o,n,r){r=r?1:0;var i=w(1+t,e);return g(-(i=0===t?(o+n)/e:(o*i+n)/((1+t*r)*(i-1)/t)))}),3,5,[z,{Hi:0,aj:"= 0",bj:k},z,U,U],b,b,{bk:[3,4]}),D("PPMT",(function(t,e,o,n,r,i){var a,s;return i=i?1:0,e>=o+1?O:(a=It(t,o,n,r,i),d(a)||(s=Bt(n,a,t,e-1),d(s))?O:a-s)}),4,6,[z,q,z,z,U,U],b,b,{bk:[4,5]}),D("COUPDAYBS",(function(t,e,o,n){return _t(Mt,t,e,o,n)}),3,4,ht,b,b,{bk:3}),D("COUPDAYS",(function(t,e,o,n){return _t(kt,t,e,o,n)}),3,4,ht,b,b,{bk:3}),D("COUPDAYSNC",(function(t,e,o,n){return _t(Nt,t,e,o,n)}),3,4,ht,b,b,{bk:3}),D("COUPNCD",(function(t,e,o){return _t(ie,t,e,o)}),3,4,ht,b,b,{bk:3}),D("COUPNUM",(function(t,e,o){return _t(Ot,t,e,o)}),3,4,ht,b,b,{bk:3}),D("COUPPCD",(function(t,e,o){return _t(ae,t,e,o)}),3,4,ht,b,b,{bk:3}),D("DURATION",(function(t,e,o,n,r){return Vt(!1,t,e,o,n,r)}),5,6,pt,b,b,{bk:5}),D("MDURATION",(function(t,e,o,n,r){return n<0||o<0?O:Vt(!0,t,e,o,n,r)}),5,6,pt,b,b,{bk:5}),D("NPER",(function(t,e,o,n,r){return r=r?1:0,0===t?0===e?k:g(-(o+n)/e):g(x((e*(1+t*r)-n*t)/(o*t+e*(1+t*r)))/x(1+t))}),3,5,[{Hi:0,aj:"<= -1"},z,z,U,U],b,b,{bk:[3,4]}),D("YIELD",(function(t,e,o,n,r,i,a){var s,l,c,f,h,p,d;if(u(i,[1,2,4])<0||G(t,e)>0)return O;if(Ot(t,e,i)<=1)return s=Mt(t,e,i,a),l=Nt(t,e,i,a),(r/100+o/i-(n/100+s/(c=kt(t,e,i,a))*o/i))/(n/100+s/c*o/i)*(i*c/l);if(p=(d=Qt(!1,Et,p={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},h=.1,t,e,o,n,r,i,a))[1],!(f=d[0])){for(h=1e-10;h<p.gl;h*=2)p=Xt(!1,Et,p,h,t,e,o,n,r,i,a)[1];p=(d=Yt(!1,!1,p,t,e,o,n,r,i,a))[1],f=d[0]}return f?p.al:O}),6,7,[K,K,J,W,W,tt,rt],b,b,{bk:6}),D("YIELDDISC",(function(t,e,o,n,r){return G(t,e)>=0?O:(n/o-1)/_(t,e,r)}),4,5,[K,K,W,W,rt],b,b,{bk:3}),D("YIELDMAT",(function(t,e,o,n,r,i){var a;return G(t,e)>=0?O:(a=1+_(o,e,i)*n,a/=r/100+_(o,t,i)*n,a--,a/=_(t,e,i))}),5,6,[K,K,K,J,W,rt],b,b,{bk:5}),D("AMORDEGRC",(function(t,e,o,n,r,i,a){var s=1/i;return s>0&&s<1||s>1&&s<2||s>2&&s<3||s>4&&s<5||G(e,o)>0?O:function(t,e,o,n,r,i,a){var s,l,u,c,f,h=1/i;if(i*=h<3?1:h<5?1.5:h<=6?2:2.5,c=_(e,o,a),d(c))return 0;for(u=(t-=l=I(c*i*t+.5))-n,s=0;s<r;s++){if((u-=l=I(i*t+.5))<0)return 0===(f=r-s)||1===f?I(.5*t+.5):0;t-=l}return l}(t,e,o,n,r,i,a)}),6,7,gt,b,b,{bk:6}),D("AMORLINC",(function(t,e,o,n,r,i,a){return G(e,o)>0?O:function(t,e,o,n,r,i,a){var s,l,u,c=t*i,f=t-n,h=_(e,o,a);return d(h)?0:(l=(t-n-(s=h*i*t))/c,u=p((t-n-s)/c),0===r?s:r<=u?c*(l<1?l:1):r===u+1?f-c*u-s:0)}(t,e,o,n,r,i,a)}),6,7,gt,b,b,{bk:6}),D("ODDFYIELD",(function(t,e,o,n,r,i,a,s,l){var c,f,h,p=.1;if(u(s,[1,2,4])<0||G(o,t)>0||G(t,n)>0||G(n,e)>0)return O;if(c=(f=Qt(!1,jt,c={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},p,t,e,r,i,a,s,l,o,n))[1],h=f[0]){for(p=1e-10;p<c.gl;p*=2)c=Xt(!1,jt,c,p,t,e,r,i,a,s,l,o,n)[1];c=(f=Kt(!1,c,t,e,o,n,r,i,a,s,l))[1],h=f[0]}return h?c.al:O}),8,9,[K,K,K,K,J,W,W,tt,rt],b,b,{bk:8}),D("ODDLYIELD",(function(t,e,o,n,r,i,a,s){return Ht(!1,t,e,o,n,i,a,s,r)}),7,8,[K,K,K,J,W,W,z,rt],b,b,{bk:7}),D("ODDLPRICE",(function(t,e,o,n,r,i,a,s){return Ht(!0,t,e,o,n,i,a,s,r)}),7,8,[K,K,K,J,J,W,tt,rt],b,b,{bk:7}),D("TBILLEQ",(function(t,e,o){var n,r=xt(e)-xt(t);return G(t,e)>=0||r>365?O:0===(n=360-o*r)?k:n<0?O:g(365*o/n)}),3,3,dt),D("TBILLYIELD",(function(t,e,o){var n=xt(e)-xt(t);return G(t,e)>=0||n>365?O:(100-o)/o*(360/n)}),3,3,dt),D("IRR",(function(t,e){var o,n,r,i,a,s=h(t),l=[],u=!1,c=!1,f={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(T(e)>1&&(e=.1),o=-1,n=0,r=0;r<s;r++)(i=t[r])!==C&&(0!==i&&(n=l.length+1,-1===o&&(o=l.length)),l.push(i),i>0&&(u=!0),i<0&&(c=!0));return l=l.slice(o,n+1),!u||!c||h(l)<2?O:(f=(a=$t(f,l,e))[1],a[0]?f.al:O)}),1,2,[lt,X],0,0,{bk:1}),D("MIRR",(function(t,e,o){var n,r,i,a,s=0,l=0,u=0,c=0,f=0,p=[],d=h(t);if(d<2)return k;for(n=0;n<d;n++)(r=t[n])!==C&&(p.push(r),u++,0!==r&&(r>0?s++:l++));if(l<1||s<1)return k;for(i=0;i<u;i++)0!==(a=p[i])&&(a>0?c+=a/w(1+o,i):f+=a/w(1+e,i));return 0===f||0===c||o<=-1?k:w(-c*w(1+o,u)/(f*(1+o)),1/(u-1))-1}),3,3,[lt,z,z],0,0),D("XIRR",(function(t,e,o){var n,r,i,a,s,l,u,c=h(t);if(c!==h(e))return O;for(i=c-1;i>=0;i--)n=t[i]>0||n,r=t[i]<0||r,e[i]===C&&(0!==t[i]?e[i]=0:(t.splice(i,1),e.splice(i,1)));return n&&r?0===t[0]?0===o?4.88281e-9:H:(a=(s=Qt(!0,Jt,a={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},o,t,e))[1],s[0]?(l=a.al,Math.abs(l)<a.hl?H:l):(u=se(t,e,o,a))[0]?u[1]:O):O}),2,3,[ft,ut,X],"!= 2","!= 2",{bk:2}),D("RATE",(function(t,e,o,n,r,i){var a,s,l,u,c,f;if(r=r?1:0,a=w(17976931348623157e282,1/t),u=function(t,e,o){var n,r,i,a,s,l,u,c,f=t.hl/2;for(n=0;n<100;n++){if(a=void 0,s=0,l=0,o<t.fl||o>t.gl)return[!1,t,e];if(e=(u=qt(o,s,e))[2],s=u[1],!(a=u[0]))return[a,t,e];if(t=(c=Dt(o,s,t))[1],c[0])return[!0,t,e];if(e=(u=qt(o,l,e,!0))[2],l=u[1],!(a=u[0]))return[a,t,e];if(0===l)return[!1,t,e];if((r=o-1.000001*s/l)===o)return t.al=o,[!0,t,e];if(i=T(r-o)/(T(o)+T(r)),o=r,i<f)return t.al=o,[!0,t,e]}return[!1,t,e]}(s={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:R(-1e10,1-a),gl:M(1e10,a-1)},l={bl:t,cl:e,dl:o,el:n,Nc:r},i),l=u[2],s=u[1],!(c=u[0])){for(f=2;(!s.Xk||!s.Wk)&&f<100;f*=2)l=(u=Zt(s,i*f,l))[2],l=(u=Zt(s=u[1],i/f,l))[2],s=u[1];s=(u=Yt(!0,!1,s,l))[1],c=u[0]}return c?s.al:O}),3,6,[W,z,z,U,{_i:0,Hi:2,aj:"< 0",bj:N},X],b,b,{bk:[3,4,5]}),D("VDB",(function(t,e,o,n,r,i,a){return r<n?O:t<e&&0===n&&1===r?t-e:function(t,e,o,n,r,i,a){var s,l,u,c,f=I(n),h=f,p=S(r),d=p,g=0;if(a)for(s=h+1;s<=d;s++)l=le(t,e,o,s,i),s===h+1?l*=M(r,f+1)-n:s===d&&(l*=r+1-p),g+=l;else u=o,c=void 0,n!==I(n)&&i>1&&n>=o/2&&(c=n-o/2,n=o/2,r-=c,u+=1),t-=ue(t,e,o,u,n,i),g=ue(t,e,o,o-n,r-n,i);return g}(t,e,o,n,r,i,a)}),5,7,[J,J,at,J,J,Z,$],b,b,{bk:[5,6]}),D("ACCRINT",(function(t,e,o,n,r,i,a){var s,l,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A;if(u(i,[1,2,4])<0||G(t,o)>=0)return O;if(1===i||0===a||4===a)return function(t,e,o,n,r,i,a){var s=At(t,o,a),l=P(t,a);return s<0||l<=0?O:r*n*(s/l)}(t,0,o,n,r,0,a);for(s=t.getFullYear(),l=t.getMonth(),c=t.getDate(),f=o.getFullYear(),h=o.getMonth(),p=o.getDate(),d=e.getMonth(),g=e.getDate(),m=[],y=[],C=[],v=[31,28,31,30,31,30,31,31,30,31,30,31],b=0;b<i;b++)m[b]=(d+12*b/i)%12,y[b]=g<=v[m[b]]?g:v[m[b]],2===a?C[b]=360/i:3===a&&(C[b]=365/i);for(b=0;b<i;b++)T=m[w=b===i-1?0:b+1]>m[b]?2001:2002,C[b]=xt(new Date(T,m[w],y[w]))-xt(new Date(2001,m[b],y[b]));for(S=0,x=xt(o);s<f||s===f&&l<h||s===f&&l===h&&c<p;){for(b=0;b<i&&(l<m[b]||l===m[b]&&c<y[b])&&(0===b||m[b]>m[b-1]);)b++;for(;b<i&&(l>m[b]||l===m[b]&&c>=y[b])&&(l!==m[++b-1]||c!==y[b-1]););w=--b===i-1?0:b+1,T=l+12/i>=12?s+1:s,A=xt(new Date(s,l,c)),S+=r*n/i*(Math.min(xt(new Date(T,m[w],y[w])),x)-A)/C[b],s=T,l=m[w],c=y[w]}return S}),6,8,[K,K,K,W,Y,tt,rt],b,b,{bk:[4,6,7]}),D("ACCRINTM",(function(t,e,o,n,r){if(G(t,e)>0)return O;var i=At(t,e,r),a=P(t,r);return i<0||a<=0?O:n*o*i/a}),3,5,[K,K,W,Y,rt],b,b,{bk:[3,4]}),D("DISC",(function(t,e,o,n,r){if(G(t,e)>=0)return O;var i=P(t,r),a=At(t,e,r);return a<=0||i<=0?O:(n-o)/n*(i/a)}),4,5,[K,K,W,W,rt],b,b,{bk:3}),D("EFFECT",(function(t,e){return w(1+t/e,e)-1}),2,2,vt),D("INTRATE",(function(t,e,o,n,r){if(G(t,e)>=0)return O;var i=At(t,e,r),a=P(t,r);return i<=0||a<=0?O:(n-o)/o*(a/i)}),4,5,yt,b,b,{bk:3}),D("NOMINAL",(function(t,e){return e*(w(1+t,1/e)-1)}),2,2,vt),D("DB",(function(t,e,o,n,r){var i,a,s,l;if(o+(r<12?1:0)<n)return O;if(0===t)return 0;for(i=E(1-w(e/t,1/o),3),a=0,s=0,l=1;l<=n;l++)a+=s=1===l?t*i*r/12:l===o+1?(t-a)*i*(12-r)/12:(t-a)*i;return s}),4,5,[J,z,ot,ot,{_i:12,Hi:2,aj:["< 1","> 12"]}],b,b,{bk:3}),D("DDB",(function(t,e,o,n,r){var i,a=0,s=0;if(o<n)return O;if(t<=e)return 0;for(i=1;i<=n;i++)a+=s=M(s=r/o*(t-a),t-a-e);return s}),4,5,[J,z,et,et,{_i:2,Hi:0,aj:"<= 0"}],b,b,{bk:3}),D("SLN",(function(t,e,o){return(t-e)/o}),3,3,[z,z,it]),D("SYD",(function(t,e,o,n){return n>o?O:(t-e)*(o-n+1)*2/(o*(o+1))}),4,4,[z,J,ot,et]),D("DOLLARDE",(function(t,e){return e<1?k:zt(!0,t,e)}),2,2,bt),D("DOLLARFR",(function(t,e){return 0===e?k:zt(!1,t,e)}),2,2,bt),D("PRICE",(function(t,e,o,n,r,i,a){return u(i,[1,2,4])<0||G(t,e)>0?O:Et(t,e,o,n,r,i,a)}),6,7,[K,K,J,J,W,tt,rt],b,b,{bk:6}),D("PRICEDISC",(function(t,e,o,n,r){if(G(t,e)>=0)return O;var i=At(t,e,r),a=P(t,r);return i<=0||a<=0?O:n-o*n*i/a}),4,5,yt,b,b,{bk:3}),D("PRICEMAT",(function(t,e,o,n,r,i){var a,s,l,u,c;return G(t,e)>=0?O:(a=At(t,e,i),s=At(o,e,i),l=At(o,t,i),u=P(t,i),l<=0||u<=0||a<=0||s<=0?O:0===(c=1+a/u*r)?O:(100+s/u*n*100)/c-l/u*n*100)}),5,6,[K,K,K,J,J,rt],b,b,{bk:5}),D("ODDFPRICE",(function(t,e,o,n,r,i,a,s,l){return u(s,[1,2,4])<0||G(o,t)>0||G(t,n)>0||G(n,e)>0?O:jt(t,e,r,i,a,s,l,o,n)}),8,9,[K,K,K,K,J,J,W,tt,rt],b,b,{bk:8}),D("TBILLPRICE",(function(t,e,o){var n=xt(e)-xt(t);return G(t,e)>=0||n>365?O:100*(1-o*n/360)}),3,3,[K,K,W]),D("EURO",(function(t){var e=Pt(t,2);return e>=0?e:O}),1,1,Q),D("EUROCONVERT",(function(t,e,o,n,r){var i,a,s,l;return i=0,n||(i=function(t){var e=t.substr(0,3);return u(e,["BEF","LUF","ESP","ITL","LUX"])>=0?0:2}(o)),r.$i||(r.Qb=function(t){var e=t.substr(0,3);return u(e,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])>=0?0:2}(e)),s=Pt(e,r.Qb),l=Pt(o,r.Qb),s>=0&&l>=0?(a=t*l/s,n||(a=E(a,i)),a):N}),3,5,[z,Q,Q,$,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:N}],b,b,{bk:[3,4]}),D("PDURATION",(function(t,e,o){return ce(t,e,o,(function(t,e,o){var n,r;return e.value>0&&t.value>0&&o.value>0?(n=(Math.log(o.value)-Math.log(e.value))/Math.log(1+t.value),(r=Math.abs(n))<=179769e303?r>=22250738585072014e-324?n:0:k):O}))}),3,3),D("RRI",(function(t,e,o){return ce(t,e,o,(function(e,o,n){if(o.value>0&&e.value>0&&n.value>=0){t=Math.pow(n.value/o.value,1/e.value)-1;var r=Math.abs(t);if(r<=179769e303)return r>=22250738585072014e-324?t:0}return O}))}),3,3)},"./src/functions-lookup.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function q(t,e,o,n){return{row:t,col:e,rowCount:o,colCount:n}}function J(t,e,o){var n,r;return f(t)?i:t.isArray||t.isReference?(e>(n=t.colCount)&&(r=e,e=o,o=r),t[o*n+e]):t[0]}function X(t,e,o){return!((!o||null!==t&&null!==e)&&(f(e)||!((f(t)||C(t,!0))&&C(e,!0)||k(t)&&k(e))&&(!N(t)||!N(e))))}function Z(t,e,o,n,r){if(t<0||e<0||e<t||o<t||o>e)return-1;if(r)return O=t,D=e,E=o,j=n,P=n,F=o;if(j){if(++F>D){if(j!==P)return-1;F=E-1,j=!1}}else if(--F<O){if(j!==P)return-1;F=E+1,j=!0}return F}function Y(t,e,o){var n=c(t),r=o;return n===e?r=0:n>e?r=1:n<e&&(r=2),r}function K(t,e,o){var r,i,a,s;if(t===e)return 0;if(N(t)){if(!e&&0===h(""+t))return 0;if(C(e)&&!C(t))return 1;if(k(e))return 2;if(N(e)){r=void 0;try{r=(i=n.Common.CultureManager.getCultureInfo()).localeCompare?o?i.localeCompare(""+t,""+e):i.localeCompare(t.toLowerCase(),e.toLowerCase()):o?(""+t).localeCompare(""+e):t.toLowerCase().localeCompare(e.toLowerCase())}catch(n){r=o?(""+t).localeCompare(""+e):t.toLowerCase().localeCompare(e.toLowerCase())}return r<0?r=2:r>0&&(r=1),r}return e instanceof Date?Y(t,e,1):-1}return N(e)?t||0!==h(""+e)?C(t)?2:k(t)?1:t instanceof Date?Y(t,e,2):-1:0:k(t)&&C(e)?1:k(e)&&C(t)?2:(a=v(t))===(s=v(e))?0:a<s?2:1}function Q(t,e,o){var n=J(t,e,o);return f(n)?0:n}function $(t,e,o,n){var r,a,s,l,u=-1,c=0,f=-1,h=-1,p=n?e.rowCount:e.colCount;if(--p<c)return-1;for(;c<=p;){for(r=i,void 0,s=t[0],o>=1!=(2===u)&&(f=h),a=h=Z(c,p,h=m((c+p)/2),o>=0,!0);!X(s,r)&&-1!==h&&!X(s,r=n?J(e,0,h):J(e,h,0));)h=Z(0,0,0,!1,!1),o>=0&&h<a?p=h:o<0&&h>a&&(c=h);if(-1===h&&o>=1!=(2===u))return f;if(-1===h)return-1;if(u=K(s,r,!1),o>=1&&1===u)c=h+1;else if(o>=1&&2===u)p=h-1;else if(o<=-1&&1===u)p=h-1;else if(o<=-1&&2===u)c=h+1;else if(0===u){for(;o<=-1&&h>c||o>=0&&h<p;){if(0,l=o>=0?h+1:h-1,null===(r=n?Q(e,0,l):Q(e,l,0)))return-1;if(!X(s,r))break;if(0!==(u=K(s,r,!1)))break;h=l}return h}}return o>=1!=(2===u)?h:f}function tt(t,e,o,n,r,a){var l,u,c,f,h,p,d=i,g=-1,m=t[0],y=N(m),C=s.zb(m),v=n?e.rowCount:e.colCount;for(y&&C&&(c=s.sb(C)),u=0;u<v;u++)if(h=r?v-1-u:u,X(m,f=n?J(e,0,h):J(e,h,0),a))if(p=N(f),y&&p&&C?(c.lastIndex=0,l=c.test(f)?0:1):l=K(m,f,!1),o>=1&&1===l)l=-1,g>=0&&(l=K(f,d,!1)),(g<0||g>=0&&1===l)&&(g=h,d=f);else if(o<=-1&&2===l)l=-1,g>=0&&(l=K(f,d,!1)),(g<0||g>=0&&2===l)&&(g=h,d=f);else if(0===l)return h;return g}function et(t,e){var o,n;if(!e)for(o=h(t),n=void 0,n=1;n<o;n++)if(2===K(t[n-1],t[n],!1))return!1;return!0}function ot(t,e,o){var n,i,s,l,u;if(!t)return S;if(t.arrayFormulaMode,o?0:1,!(e=e!==a?e:t.getReference(t.source,q(t.row,t.column,t.rowCount,t.columnCount)))||1!==e.getRangeCount())return S;if(s=[],o){if(l=e.getRow(0)+1,(i=e.getRowCount(0))>1){for(n=0;n<i;n++)s.push([l+n]);return new r.CalcArray(s)}return l}if(u=e.getColumn(0)+1,(i=e.getColumnCount(0))>1){for(n=0;n<i;n++)s.push(u+n);return new r.CalcArray([s])}return u}function nt(t,e,o,n,i,s){var l,u,c,f,h,p,d;return t&&o instanceof r.CalcReference?(c=o.getRowCount(0),f=o.getColumnCount(0),u=o.create([{row:o.getRow(0),col:o.getColumn(0),rowCount:s?c:1,colCount:s?1:f}]),ct(t,o,u.getRow(0),u.getColumn(0),u.getRowCount(0),u.getColumnCount(0))):(o instanceof r.CalcArray?(c=o.getRowCount(),f=o.getColumnCount()):Array.isArray(o)&&(c=o.rowCount,f=o.colCount),u=o),s&&n>f||!s&&n>c?x:(l=r.Convert.Ph(u,0,!0,!1,!1)).isError||l.isConvertError?x:(h=i||i===a?$(e,l,1,s):tt(e,l,0,s))>=0?t&&o instanceof r.CalcReference?(p=s?h:n-1,d=s?n-1:h,ct(t,o,o.getRow(0)+p,o.getColumn(0)+d,1,1),o.getValue(0,p,d)):s?Q(l,n-1,h):Q(l,h,n-1):A}function rt(t,e,o,n,r){return nt(t,e,o,n,r,!1)}function it(t,e,o,n,r){return nt(t,e,o,n,r,!0)}function at(t,e,o,n){var r,i,a,l,u,c,h,p,d,g,m,y=e;if(!y.isArray&&!y.isReference)return A;if(r=y.colCount,i=y.rowCount,r>1&&i>1)return S;if(2===o&&(2===n||-2===n))return S;if(a=2===n&&!et(y,!0),l=-2===n&&!et(y,!1),a||l)return A;if(u=t,c=t&&t[0],h=-1,f(o)&&(o=0),(f(n)||0===n)&&(n=1),-1===n&&(p=!0),0!==o&&2!==o||(d=0),1===n||-1===n){if(1===o)d=-1;else if(-1===o){if(s.ub(c))return A;d=1}h=tt(u,y,d,i>1,p,!0)}else if(2===n||-2===n){if(1===r&&1===i){if(0,!X(c,g=y[0]))return A;if(0===(m=K(c,g,!1)))return 1;if(0===o)return 0===m?1:A;if(1===o)return 2===m?1:A;if(-1===o)return 1===m?1:A}h=$(u,y,d=2===n?1:-1,i>1)}return-1===h?A:0!==o||yt(c,y[h])?yt(c,y[h])?h+1:2===n&&1===o||-2===n&&-1===o?h+2:h+1:A}function st(t,e,o,n){return t+=e,n?0!==o&&(t+="[",t+=""+o,t+="]"):t+=o,t}function lt(t,e,o){o||(t+="$");for(var r=t.length;e>.1;e=parseInt(""+(e-1)/26,10))t=n.Common.u.Eb(t,r,String.fromCharCode("A".charCodeAt(0)+(e-1)%26));return t}function ut(t,e){if(e&&0<h(e)){var o=void 0,n=!r.ei(e[0])&&"_"!==e[0];for(o=1;!n&&o<h(e);o++)n=!r.fi(e[o])&&"_"!==e[o];n?(t+="'",t+=e.replace("'","''"),t+="'"):t+=e,t+="!"}return t}function ct(t,e,o,n,r,i){var a,s,l,u,c,f;t&&t.identity&&(a=t.identity.row,s=t.identity.col,l=t.source.getCalcSourceModel().qg(a,s),u=e.getSource(),l&&u.getRangeKey&&(c={id:u.id,row:o,col:n,rowCount:r,colCount:i},f=u.getRangeKey(u,c),l.eOb||(l.eOb={}),l.eOb[f]=c))}function ft(t,e){var o;return void 0===e&&(e=!1),b(t)||w(t)?o=t.toArray(0,!1):t.length&&t[0].length&&(o=t),o?ht(o,e):g(t)?t:S}function ht(t,e){var o,n,r,i,a,s,l;if(void 0===e&&(e=!1),n=t.rowCount,r=t.colCount,n||r||(n=t.length,r=t[0].length),i=t,e){for(i=[],a=0;a<r;a++)for(s=[],i.push(s),l=0;l<n;l++)s.push(t[l][a]);n=(o=[r,n])[0],r=o[1]}return i.rowCount=n,i.colCount=r,i}function pt(t){return 1===t||-1===t}function dt(t,e){var o=e.length;t.sort((function(t,n){var i,a,s,l;for(i=0;i<o;i++)if(s=(a=e[i])[0],0!==(l=r.gOb(t[s],n[s])))return a[1]?l:-l;return 0}))}function gt(t,e,o){if(o)t.forEach((function(t,o){t.push(e[o][0])}));else{var n=e[0];t.forEach((function(t,e){t.push(n[e])}))}}function mt(t,e,o){var n,i,a,s,l,u,c,f,h,p,d,m,y,C,v,T,x,A,I,R,M,k,N,O,D;for(void 0===o&&(o=1),n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];if(l=0,u=0,c=S,w(t)?a=t:b(t)&&(l=(s=t).getRow(),u=s.getColumn()),f=a||s){if(h=f.getColumnCount(),p=f.getRowCount(),g(t))return c;for(d=[],m=void 0,y=0,C=0,v=void 0,T=void 0,x=1,A=arguments.length;x<A;x+=2){if(R=[].concat(ft(I=arguments[x])),g(R))return c;if(M=I.getRowCount(),k=I.getColumnCount(),y||(y=(m=1===k)?2:1,T=[].concat(ft(t,!m))),!(!m&&1===M&&k===h||m&&1===k&&M===p))return c;if(N=w(I),b(I)&&(O=void 0,m?(O=u-I.getColumn())>=0&&O<h?v=O:N=!0:(O=l-I.getRow())>=0&&O<p?v=O:N=!0),N&&(C+=1,v=m?h++:p++,gt(T,R,m)),!pt(D=arguments[x+1]||1))return c;d.push([v,1===D])}return dt(T,d),C&&T.forEach((function(t){t.length-=C})),new r.CalcArray(m?T:ht(T,!0))}return c}function yt(t,e){return!!(t===e||p(t)&&p(e)&&d(t)===d(e)||g(t)&&g(e)&&t._code===e._code)}function Ct(t,e){var o,n;for(o=0,n=t.length;o<n;o++)if(!yt(t[o],e[o]))return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("CalcEngine"),i=null,a=void 0,s=n.Common.q,l=n.Common.j,u=n.Common.l,c=u.lb,f=l.Fa,l.G,h=n.Common.k.ac,p=u.Ska,d=u.Ra,g=r.Convert.vf,m=r.Convert.Rh,y=r.Convert.Sh,C=r.Convert.Na,v=r.Convert.Pa,b=r.Convert.Fh,w=r.Convert.Ca,T=r.Convert.bc,S=r.Errors.Value,x=r.Errors.Reference,A=r.Errors.NotAvailable,I=r.Errors.Null,R=r.Errors.Calc,M=r.Functions.ak,k=r.Functions.ik,N=r.Functions.jk,L=r.CalcReference.prototype,function(t){function e(e,o,n,r,i,a){var s,l=t.call(this,e,[q(o,n,r,i)])||this;return l.getValue=function(t,e,o){var n=this,r=n.Nc;return 0===r?n.getRow(0)+1+e:1===r?n.getColumn(0)+1+o:L.getValue.call(n,t,e,o)},(s=l).cj=o,s.Lk=n,s.Xj=r,s.Yj=i,s.Nc=a,l}W(e,t),e.prototype.type=function(){return this.Nc},e.prototype.toArray=function(t,e){var o,n,r,i,a,s,l=this,u=[],c=l.cj,f=l.Lk,h=l.Nc,p=l.getRangeCount(),d=l.Xj,g=l.Yj;for(o=0;o<p;o++)for(e||(r=[],u.push(r)),a=0;a<d;a++)for(e||(i=[],r.push(i)),s=0;s<g;s++)n=0===h?c+1+a:1===h?f+1+s:L.getValue.call(l,o,c+a,f+s),e?u.push(n):i.push(n);return e||1!==p||(u=u[0]),u.rowCount=d,u.colCount=g,u.rangeCount=p,u}}(r.CalcReference),G=function(t){function e(e){var o=t.call(this,a)||this;return o.il=e,o}return W(e,t),e.prototype.getRowCount=function(){return r.CalcArrayHelper.getColumnCount(this.il)},e.prototype.getColumnCount=function(){return r.CalcArrayHelper.getRowCount(this.il)},e.prototype.getValue=function(t,e){return r.CalcArrayHelper.getValue(this.il,e,t)},e}(r.CalcArray),_={Hi:7},H={Hi:2},z={Hi:2,aj:"<= 0",bj:S},U={Hi:4,Ii:0,Ji:!0},M("ADDRESS",(function(t,e,o,n,r){var i=3===o||4===o||7===o||8===o,a=2===o||4===o||6===o||8===o,s="";return t<1&&(n||!i)||t>1048576||e<1&&(n||!a)||e>16384||o<1||8<o?S:(s=ut(s,r),n?s=function(t,e,o){return o||(t+="$"),t+e}(s=lt(s,e,a),t,i):(s=st(s,"R",t,i),s=st(s,"C",e,a)),s)}),2,5,[V={Hi:2},V,{_i:1,Hi:2},B={_i:!0,Hi:7},{_i:"",Hi:5}],a,a,{bk:[2,3,4]}),M("INDEX",(function(t,e,o,n,s){var l,u,c,p,d,g,C,v,b,w,T,A,I;function R(t){return!f(t)&&!t._error}if(l=i,c=(u=t)!==i&&u.acceptsReference,p=u!==i&&u.arrayFormulaMode,e instanceof r.CalcReference){if(d={value:-1},g=e,s===a&&(s=1),(s=R(s)&&y(s,d)?d.value-1:l)>=g.getRangeCount())return x;if(s===l||s<0)return S;if(C=g.getRowCount(s),v=g.getColumnCount(s),b=g.getRow(s),w=g.getColumn(s),T=void 0,A=void 0,3===h(arguments)){if(1!==C&&1!==v)return x;1!==v?(n=o,o=1):1!==C&&(n=1)}if(o===a&&(o=0),-1===(o=R(o)&&y(o,d)?d.value-1:l)){if(1!==C&&!c&&!p&&(b>u.row||u.row>=b+C))return S}else{if(o<-1||o===l)return S;if(C<=o)return x;T=o+b}if(n===a&&(n=0),-1===(n=R(n)&&y(n,d)?d.value-1:l)){if(1!==v&&!c&&!p&&(w>u.column||u.column>=w+v))return S}else{if(n<-1||n===l)return S;if(v<=n)return x;A=n+w}return-1===o&&-1===n?(T=b,A=w):-1===o?(T=b,v=1):-1===n?(A=w,C=1):(v=1,C=1),ct(t,g,T,A,C,v),g.create([q(T,A,C,v)])}if(r.Convert.Ca(e))return C=(I=e).getRowCount(),o=o!==a?m(o):-1,n=n!==a?m(n):-1,1!==(s=s!==a?m(s)-1:1)?x:(-1===o&&-1===n?o=n=0:-1===n&&1===C&&(n=o,o=1),o=-1===o?0:o,n=-1===n?0:n,C=I.getRowCount(),v=I.getColumnCount(),o<0||n<0||s<0?S:(o>C&&1===C&&n===a&&(n=o,o=0),C<o||v<n?x:0===o&&0===n?I.slice(0,0,C,v):0===o?I.slice(0,n-1,C,1):0===n?I.slice(o-1,0,1,v):I.getValue(o-1,n-1)))}),2,4,a,0,0,{bk:[1,2,3],KMc:[0],dk:!0,fk:3}),M("OFFSET",(function(t,e,o,n,i,s){var l,u,c;return t?e&&e instanceof r.CalcReference&&1===e.getRangeCount()?(i=i!==a?m(i):e.getRowCount(0),s=s!==a?m(s):e.getColumnCount(0),l=e.getRow(0)+o,u=e.getColumn(0)+n,i<=0||s<=0||l<0||u<0?x:(c=e.create([{row:l,col:u,rowCount:i,colCount:s}]),ct(t,e,l,u,i,s),c)):S:A}),3,5,[{},V,V],0,0,{bk:[3,4],KMc:[0],dk:!0,fk:2,returnReference:!0}),M("ROW",(function(t,e){return ot(t,e,!0)}),0,1,a,-1,a,{dk:!0,KMc:-1,expandColumns:!1}),M("COLUMN",(function(t,e){return ot(t,e,!1)}),0,1,a,-1,a,{bk:0,dk:!0,KMc:-1,expandRows:!1}),M("ROWS",(function(t){return r.CalcArrayHelper.getRowCount(t)}),1,1,a,-1,-1,{KMc:-1,expandColumns:!1,ck:!0}),M("COLUMNS",(function(t){return r.CalcArrayHelper.getColumnCount(t)}),1,1,a,-1,-1,{KMc:-1,expandRows:!1,ck:!0}),M("TRANSPOSE",(function(t){return new G(t)}),1,1,a,-1,-1),M("LOOKUP",(function(t,e,o){var n,i,s,l,u,c,h,p=[];if(e)for(n=0;n<e.length;n++)p.push(e[n]);if(e.colCount<=e.rowCount?(p.colCount=e.colCount,p.rowCount=Math.ceil(p.length/p.colCount)):(p.rowCount=e.rowCount,p.colCount=Math.ceil(p.length/p.rowCount)),f(e.isReference)||(p.isReference=e.isReference),f(e.isArray)||(p.isArray=e.isArray),p.rangeCount=e.rangeCount,-1,l=p.colCount,u=p.rowCount,c=t,o===a)return h=l>u?rt(a,c,p,u,!0):it(a,c,p,l,!0),g(h)?A:h;if(s=r.Convert.Ph(o,0,!0,!1,!1)){if(s.colCount>1&&s.rowCount>1)return A}else s=p;return(i=$(c,p,1,!(l>u)))>=0?(l=s.colCount)>(u=s.rowCount)?Q(s,i,u-1):Q(s,l-1,i):A}),2,3,[U,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),M("HLOOKUP",rt,3,4,[U,{},z,_],1,1,{dk:!0,KMc:[1]}),M("VLOOKUP",it,3,4,[U,{},z,_],1,1,{dk:!0,KMc:[1],TAb:!0}),M("XLOOKUP",(function(t,e,o,n,i,a){var s,l,u,c,f,h,p,d,g,m,y,C=e.getRowCount(),v=e.getColumnCount(),b=1===C&&1===v,w=o.getRowCount(),T=o.getColumnCount(),x=1===C&&v>=1,I=1===w&&T>=1;if(b){if(w>1&&T>1)return S}else if(x&&v!==T||!x&&C!==w)return S;if((s=at(t,r.Convert.Ph(e,0,!0),i,a))===A)return l="string"==typeof n?n:A,b?l:new r.CalcArray([[l]]);if(s===S)return S;if(s>0){if(b)return o;if(s-=1,u=[],r.Convert.Ca(o)){if(x)for(c=0;c<w;c++)f=o.getValue(0,s),u.push([f]);else h=I?[o.getValue(0,s)]:[o.getValue(s,0)],u.push(h);return new r.CalcArray(u)}if(o instanceof r.CalcReference)return d=(p=o).getRow(),g=p.getColumn(),m=w,y=T,x?(g=p.getColumn()+s,y=1):(d=p.getRow()+s,m=1),p.create([{row:d,col:g,rowCount:m,colCount:y}])}}),3,6,[U,{},{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),M("CHOOSE",(function(t){var e=arguments;return t<1||h(e)<=t?S:f(e[t])?0:e[t]}),2,255,V,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var e={value:-1};return g(t)?-1:(y(t,e),e.value)}}),M("MATCH",(function(t,e,o){var n,r,s,l=t,u=e;return u.isArray||u.isReference?(n=u.colCount,r=u.rowCount,s=-1,n>1&&r>1||1===o&&!et(u,!0)||-1===o&&!et(u,!1)?A:(o===a?o=1:o===i&&(o=0),1===o?s=$(l,u,1,r>1):0===o?s=tt(l,u,0,r>1):-1===o&&(s=$(l,u,-1,r>1)),-1===s?A:s+1)):A}),2,3,[U,U,H],1,1,{}),M("XMATCH",at,2,4,[U,U,H,H],1,1,{}),M("INDIRECT",(function(t,e,o){var n,i,a,s,u,c,f,h,p,d,g,m,y;return t?e?(a={row:n=t.row,col:i=t.column},(s=t.parser)||(s=t.parser=new r.Parser),(c=(u=t.source).parserContext)?(c.useR1C1=!o,c.row=a&&a.row||0,c.column=a&&a.col||0,c.baseIdentity=a,c.source=t.source):(u.parserContext=c=t.source?t.source.getParserContext(!o,a):new r.ParserContext(t.source,!o,a),c.onlyValidateSourceNameWithSpecial=!0),o?f=s.parse(c,e):((p=u.expressions)||(p=u.expressions={}),(f=p[e])||(f=s.parse(c,e),p[e]=f)),f?(8===f.type&&(f.source?f=(h=f.source).getCustomName(f.value):f=t.getName(f.value)),!f||l.Ea(f.type,[1,13])<0?x:(h=f.source||t.source,25===f.type||26===f.type?h.getValueByName(f.nameIdentity):(d=f.getRange(n,i),13===f.type&&(h=f.source),g=t.source.getCalcSourceModel().qg(t.identity.row,t.identity.col),null,m=h.getReference(d),d.id=h.id,g&&h.getRangeKey&&(y=h.getRangeKey(h,d),g.eOb||(g.eOb={}),g.eOb[y]=d),m))):x):x:A}),1,2,[{Hi:5},B],a,a,{bk:2,dk:!0}),M("HYPERLINK",(function(t,e){var o;return(o=T(2===arguments.length?e:t)).__proto__.hyperlink=T(t),o}),1,2),M("AREAS",(function(){var t,e=0;for(t=0;t<h(arguments);t++){if(0===arguments[t].length)return I;arguments[t].isReference&&(e+=arguments[t].rangeCount)}return e}),1,a,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),M("FORMULATEXT",(function(t,e){var o=e.getRow(0),n=e.getColumn(0),r=e.getSource().getCalcSourceModel().getFormula(o,n);return r?"="+r:A}),1,1,a,-1,a,{dk:!0}),M("ISFORMULA",(function(t,e){var o=e.getRow(0),n=e.getColumn(0);return!!e.getSource().getCalcSourceModel().getFormula(o,n)}),1,1,a,-1,a,{dk:!0}),M("SORT",(function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,m,y,C,v,T,x,A,I,R,M,k;if(void 0===e&&(e=1),void 0===o&&(o=1),void 0===n&&(n=!1),i=[].concat(ft(t,n)),g(i))return i;if(a=i,s=[],b(e)||w(e)){if(h=(f=e.toArray(0,!1)).rowCount,p=f.colCount,d=0,b(o)||w(o)){if(d=(u=o.toArray(0,!1)).rowCount,1!==p){if(p<1||1!==u.colCount&&u.colCount!==p||1!==h||!function(t){if(t&&t.length&&t.length>=0){for(var e=0;e<t.length;e++)if("number"!=typeof t[e])return!1;return!0}return!1}(f[0]))return S;if((m=[]).push(t),n)for(a=ht(a,n),y=0;y<p;y++){for(C=[],v=0;v<a[0].length;v++)C.push(a[f[0][y]-1][v]);m.push(new r.CalcArray([C])),1===d?m.push(u[0][0]):m.push(u[y][0])}else for(y=0;y<p;y++){for(C=[],v=0;v<a.length;v++)C.push([a[v][f[0][y]-1]]);m.push(new r.CalcArray(C)),1===d?m.push(u[0][0]):m.push(u[y][0])}return mt.apply(mt,m)}if(1!==u.colCount||1!==d&&d!==h)return S;1===d&&(d=0,c=u[0][0])}else c=o;for(l=0;l<h;l++)s.push([f[l][0],l<d?u[l][0]:c])}else if(b(o)||w(o)){if(1!==(u=o.toArray(0,!1)).colCount||1!==u.rowCount)return S;s.push([e,u[0][0]])}else s.push([e,o]);for(T=a.colCount,x=[],A=0,I=s;A<I.length;A++){if(M=(R=I[A])[0],k=R[1],M<1||M>T||!pt(k))return S;x.push([M-1,1===k])}return dt(a,x),new r.CalcArray(n?ht(a,n):a)}),1,4,a,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),M("SORTBY",mt,2,a,a,[0,"%= 1"],[0,"%= 1"],a,!0),M("UNIQUE",(function(t,e,o){var n,i,a,s;return void 0===e&&(e=!1),void 0===o&&(o=!1),n=ft(t,e),g(n)?n:(a=[],s=(i=n).rowCount,i.forEach((function(t,e){var n,r,l;if(!t.duplicated){for(n=0,r=e+1;r<s;r++)Ct(t,l=i[r])&&(l.duplicated=!0,n++);o&&0!==n||a.push(t)}})),new r.CalcArray(e?ht(a,e):a))}),1,3,a,[0],[0],{bk:[1,2]},!0),M("FILTER",(function(t,e,o){var n,i,a,s=ft(t);return g(s)?s:(n=s,i=[].concat(ft(e)),a=[],1===i.length&&i[0].length===n[0].length?n.forEach((function(t,e){var o=[];t.forEach((function(t,e){i[0][e]&&o.push(t)})),a.push(o)})):n.forEach((function(t,e){i[e][0]&&a.push(t)})),0===a.length?f(o)?R:o:new r.CalcArray(a))}),2,3,a,[0,1,2],[0,1,2],a,!0),M("@",(function(t,e){var o,n,r,i,a,s,l,u,c,f;return w(e)?e.getValue(0,0):b(e)?(n=(o=e).getColumn(),r=o.getRow(),i=o.getColumnCount(),a=o.getRowCount(),u=(s=t.row)-r,c=(l=t.column)-n,f=t.source===o.getSource(),1===a&&(!f||r!==s)&&c>=0&&c<i?o.getValue(0,0,c):1===i&&(!f||n!==l)&&u>=0&&u<a?o.getValue(0,u,0):1===a&&1===i?o.getValue(0,0,0):S):e}),1,1,a,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt,Lt,Gt,Bt,_t,Vt,Ht,zt,Ut,Wt,qt,Jt,Xt,Zt;function Yt(t){var e,o,n;return 0===t?e=0:(o=.5*Math.abs(t))>=3?e=1:o<1?e=((((((((.000124818987*(n=o*o)-.001075204047)*n+.005198775019)*n-.019198292004)*n+.059054035642)*n-.151968751364)*n+.319152932694)*n-.5319230073)*n+.797884560593)*o*2:e=(((((((((((((-45255659e-12*(o-=2)+.00015252929)*o-19538132e-12)*o-.000676904986)*o+.001390604284)*o-.00079462082)*o-.002034254874)*o+.006549791214)*o-.010557625006)*o+.011630447319)*o-.009279453341)*o+.005353579108)*o-.002141268741)*o+.000535310849)*o+.999936657524,t>0?.5*(e+1):.5*(1-e)}function Kt(t,e,o,n){var r,a,s=[];return pe(t,s),0===(r=i(s))||e<s[0]||e>s[r-1]?I:(a=1===r?1:function(t,e,o){var n,r,a,s,l,u=i(t);if(e!==t[0]){for(a=0,s=t[0],r=1;r<u&&t[r]<e;r++)t[r]!==s&&(a=r,s=t[r]);t[r]!==s&&(a=r),e===t[r]?n=o?a/(u-1):(r+1)/(u+1):0===a?n=0:(l=(e-t[a-1])/(t[a]-t[a-1]),n=o?(a-1+l)/(u-1):(a+l)/(u+1))}else n=o?0:1/(u+1);return n}(s,e,n),0!==a?S(a*f(10,o))/f(10,o):a)}function Qt(t){return[22250738585072014e-324,17976931348623157e292,f(2,-53),f(2,-52),E.Ek(2,10)][t-1]||0}function $t(t,e,o){var n,r=0,i=0;if(e<1)return 0;for(n=1;n<=e;n++)if((i+=b(D(t[r=e-n])))>o)return r;return r}function te(t,e,o){var n,r,i,a,s;if(o<1||o>1e3||t<-1.1||t>1.1)return NaN;for(n=2*t,i=r=0,a=0,s=1;s<=o;s++)i=r,a=n*(r=a)-i+D(e[o-s]);return.5*(a-i)}function ee(t){var e,o=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],n=$t(o,15,Qt(3)),r=1/w(Qt(3)),i=v(p(T(Qt(2)/12),-T(12*Qt(1))));return t<10?NaN:t>=i?4930380657631324e-47:t<r?te((e=10/t)*e*2-1,o,n)/t:1/(12*t)}function oe(t){var e=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],o=$t(e,43,.1*Qt(3));return t<=-1?NaN:b(t)<=.375?t*(1-t*te(t/.375,e,o)):T(t+1)}function ne(t){var e,o,n,r,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(t>171)return 1e308;if(t===O(t))if(t>0)for(e=1,r=2;r<t;r++)e*=r;else e=1e308;else{if(b(t)>1){for(n=b(t),i=O(n),s=1,o=1;o<=i;o++)s*=n-o;n-=i}else n=t;for(a=l[24],o=23;o>=0;o--)a=a*n+l[o];e=1/(a*n),b(t)>1&&(e*=s,t<0&&(e=-y/(t*e*g(y*t))))}return e}function re(t){var e,o,n,r,i,a=0,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],l=t;if(t<=0)return 1e308;if(1===t||2===t)return 0;for(t<=7&&(l=t+(a=O(7-t))),o=1/(l*l),n=2*y,r=s[9],e=8;e>=0;e--)r=r*o+s[e];if(i=r/l+.5*T(n)+(l-.5)*T(l)-l,t<=7)for(e=1;e<=a;e++)i-=T(l-1),l-=1;return i}function ie(t,e){var o,n,r,i=n=t;return e<i&&(i=e),e>n&&(n=e),i<0?NaN:0===i?q:i>=10?(o=ee(i)+ee(n)-ee(i+n),-.5*T(n)+.9189385332046728+o+(i-.5)*T(i/(i+n))+n*oe(-i/(i+n))):n>=10?(o=ee(n)-ee(i+n),r=so(i),G(r)?NaN:D(r)+o+i-i*T(i+n)+(n-.5)*oe(-i/(i+n))):T(ne(i)*(ne(n)/ne(i+n)))}function ae(t,e,o){var n,r,i,a,s,l,u,c,f,g,m,y=Qt(3),C=T(y),b=Qt(1),w=T(b),S=t,x=e,A=o;if(x/(x+A)<t&&(S=1-S,x=o,A=e),(x+A)*S/(x+1)<y)n=0,(i=x*T(h(S,b))-T(x)-ie(x,A))>w&&0!==S&&(n=v(i)),S===t&&x===e||(n=1-n);else{if(0===(l=A-d(A))&&(l=1),n=0,(i=x*T(S)-ie(l,x)-T(x))>=w&&(r=(n=v(i))*x,1!==l))for(s=O(h(C/T(S),4)),u=1;u<=s;u++)n+=(r=r*((a=u)-l)*S/a)/(x+a);if(A>1){for(i=x*T(S)+A*T(1-S)-ie(x,A)-T(A),c=O(h(i/w,0)),r=v(i-c*w),g=A*(f=1/(1-S))/(x+A-1),m=0,A===(s=O(A))&&(s-=1),u=1;u<=s&&!(g<=1&&r/y<=m);u++)(r=(A-(a=u)+1)*f*r/(x+A-a))>1&&(c-=1,r*=b),0===c&&(m+=r);n+=m}S===t&&x===e||(n=1-n),n=h(p(n,1),0)}return n}function se(t,e,o,n){var r,i,a,s,l,u,c,f,p,d,g,m;function y(t,e){return t<0&&e>0||t>0&&e<0}for(1e-307,222045e-21,r=t.ge(e),i=t.ge(o),s=0;s<1e3&&!y(r,i);s++)b(r)<=b(i)?(a=e,(e+=2*(e-o))<0&&(e=0),o=a,i=r,r=t.ge(e)):(a=o,o+=2*(o-e),e=a,r=i,i=t.ge(o));if(0===r)return e;if(0===i)return o;if(!y(r,i))return n.jl=!0,0;for(l=e,u=r,c=o,f=i,p=e,d=r,g=.5*(e+o),m=!0,s=0;s<500&&b(d)>1e-307&&o-e>222045e-21*h(b(e),b(o));)m&&(u!==f&&f!==d&&d!==u?m=e<(g=l*d*f/(d-u)/(f-u)+p*f*u/(f-d)/(u-d)+c*u*d/(u-f)/(d-f))&&g<o:m=!1),m||(g=.5*(e+o),c=o,f=i,m=!0),l=c,c=p,p=g,u=f,f=d,y(r,d=t.ge(g))?(o=p,i=d):(e=p,r=d),m=m&&2*b(d)<=b(f),++s;return p}function le(t,e){var o,n,r,a,s=i(e);for(o=0;o<s;o++)a=(r=(n=D(e[o]))-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*r*a,t.N++,t.kl+=n}function ue(t){var e,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n=1.000000000190015,r=t,i=t+5.5;for(i-=(t+.5)*T(i),e=0;e<=5;e++)n+=o[e]/++r;return-i+T(2.5066282746310007*n/t)}function ce(t,e,o){var n,r,i,a,s,l,u,c,f,h,p,d,g,m=0===o||1===o?0:v(ue(t+e)-ue(t)-ue(e)+t*T(o)+e*T(1-o)),y=o>=(t+1)/(t+e+2);for(y&&(n=t,t=e,e=n,o=1-o),r=4450147717014403e-323,100,s=t-1,l=1,b(u=1-(i=t+e)*o/(a=t+1))<r&&(u=r),c=u=1/u,f=1,h=2;f<=100;f++,h+=2)if(b(u=1+(p=f*(e-f)*o/((s+h)*(t+h)))*u)<r&&(u=r),b(l=1+p/l)<r&&(l=r),c*=(u=1/u)*l,b(u=1+(p=-(t+f)*(i+f)*o/((t+h)*(a+h)))*u)<r&&(u=r),b(l=1+p/l)<r&&(l=r),c*=d=(u=1/u)*l,b(D(d-1))<5e-324)return g=m*c/t,y?1-g:g;return R}function fe(t,e){var o,n,r,a,s=i(e);for(o=0;o<s;o++)(n=e[o])!==J&&(a=(r=n-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*r*a,t.N++,t.kl+=n)}function he(t){t.sort((function(t,e){return t-e}))}function pe(t,e){var o,n;for(o=0;o<i(t);o++)(n=t[o])!==J&&e.push(n);he(e)}function de(t,e,o){var n,r,i,a,s,l,u,c,h=Math.expm1||function(t){return v(t)-1},p=Math.log1p||function(t){return T(1+t)};return t<=0?0:t>=1?1:1===o?f(t,e):1===e?-h(o*p(-t)):(r=.5-t+.5,i=p(-t),a=t,s=T(t),l=e,u=o,(c=t>e/(e+o))&&(l=o,u=e,a=r,r=t,s=i,i=T(t)),n=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=222045e-21,d=1,g=1,m=1-(e+o)/(e+1)*t;0===m?(n=0,r=1,a=1):(n=1,r=1/m,a=n*r),i=1,s=1,l=5e4,u=!1;do{n=(d=(n+(f=s*(o-s)*t/(((c=e+2*s)-1)*c))*d)*r)+(h=-(e+s)*(e+o+s)*t/(c*(c+1)))*n*r,0!=(m=(g=(m+f*g)*r)+h*m*r)&&(u=b(a-(i=n*(r=1/m)))<b(a)*p),a=i,s+=1}while(s<l&&!u);return a}(a,l,u),n/=l,n*=l>1&&u>1&&l/(l+u)<.97&&u/(l+u)<.97?ge(a,l,u)*a*r:v(l*s+u*i-me(!1,l,u)),c&&(n=.5-n+.5),n>1&&(n=1),n<0&&(n=0),n)}function ge(t,e,o){var n,r,i,a,s,l;return 1===e?1===o?1:2===o?-2*t+2:t<=.01?o+o*v((o-1)*T(1-t))-1:o*f(.5-t+.5,o-1):1===o?2===e?e*t:e*f(t,e-1):t<=0&&!(e<1&&0===t)||t>=1&&!(o<1&&1===t)?0:(n=T(Qt(2)),r=T(Qt(1)),i=T(t<.1?1+t:1-t),a=(e-1)*T(t),s=(o-1)*i,l=me(!1,e,o),a<n&&a>r&&s<n&&s>r&&l<n&&l>r&&a+s<n&&a+s>r?f(t,e-1)*f(.5-t+.5,o-1)/me(!0,e,o):v(a+s-l))}function me(t,e,o){var n,r,i,a,s,l,u,c=o,f=e;return e>o&&(n=c,c=f,f=n),t&&c+f<171.624376956302?Ce(c)/Ce(c+f)*Ce(f):(6.02468004077673,r=5.52468004077673,i=be(c),i/=be(c+f),i*=be(f),a=c+f+r,s=t?i*w(a/(c+r)/(f+r)):T(i)+.5*(T(a)-T(c+r)-T(f+r)),l=c/(f+r),u=-c*T(1+f/(c+r))-f*T(1+l)-r,t?v(u)*s:u+s)}function ye(t){var e=be(t),o=t+6.02468004077673-.5,n=f(o,t/2-.25);return e*=n,e/=v(o),e*=n,t<=20&&t===E.wk(t)&&(e=S(e)),e}function Ce(t){var e,o=T(y),n=T(Qt(2));return t>171.624376956302?R:t>=1?ye(t):t>=.5?ye(t+1)/t:t>=-.5?ye(t+2)-T(t+1)-T(b(t))>=n?R:ye(t+2)/(t+1)/t:(e=ye(1-t)+T(b(g(y*t))))-o>=n?0:e<0&&o-e>n?R:v(o-e)*(g(y*t)<0?-1:1)}function ve(t){return t>=171.624376956302?ye(t):t>=1?T(ye(t)):t>=.5?T(ye(t+1)/t):ye(t+2)-T(t+1)-T(t)}function be(t){var e,o,n,r,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(t<=1)for(e=i[12],o=a[12],n=11;n>=0;--n)e*=t,e+=i[n],o*=t,o+=a[n];else for(r=1/t,e=i[0],o=a[0],n=1;n<=12;++n)e*=r,e+=i[n],o*=r,o+=a[n];return e/o}function we(t,e){return t<=0?0:function(t,e){var o=t*T(e)-e-ve(t),n=v(o);return e>t+1?1-n*function(t,e){var o=Qt(3),n=.5*o,r=1/o,i=0,a=0,s=1-t,l=e+2-t,u=0,c=e+1,f=1,h=1,p=l*e,d=e,g=c/p,m=!1,y=0;do{u=c*(l+=2)-f*(a=(s+=1)*(i+=1)),0!=(h=p*l-d*a)&&(m=b((g-(y=u/h))/y)<=n,g=y),f=c,c=u,d=p,p=h,b(u)>r&&(f*=o,c*=o,d*=o,p*=o)}while(!m&&i<1e4);return m?g:A}(t,e):n*function(t,e){var o=.5*Qt(3),n=t,r=1/t,i=r,a=1;do{i+=r=r*e/(n+=1),a+=1}while(r/i>o&&a<=1e4);return a>1e4?A:i}(t,e)}(e/2,t/2)}function Te(t,e,o,n){var r,i,a,s=j(o,t);return G(s)?s:(r=D(s),s=j(n-o,e-t),G(s)?s:(i=D(s),s=j(n,e),G(s)?s:(a=D(s),k(r*i/a))))}function Se(t,e,o){var n,r=de(e/(e+t*t),e/2,.5);switch(o){case 1:return.5*r;case 2:return r;case 3:return f(1+t*t/e,-(e+1)/2)/(w(e)*me(!0,.5,e/2));case 4:return n=.5*de(e/(t*t+e),.5*e,.5),t<0?n:1-n}return A}function xe(t,e,o){var n={jl:!1},r=function(t,e,o){return{ge:function(n){return t-Se(n,e,o)}}}(t,e,o),i=se(r,.5*e,e,n);return n.jl?I:i}function Ae(t,e){var o,n,r,a,s,l=!1,u=0;for(n=0;n<i(e);n++)for(s=e[n],r=0;r<i(s);r++)if(a=s[r],L(a)||z(a)||U(a))o=U(a)?0:D(a),(!l||t&&o>u||!t&&o<u)&&(u=o),l=!0;else if(G(a))return a;return u}function Ie(t,e,o,n){var r,a,s,l=0,u=0,c=0;for(r=0;r<i(e);r++)(a=e[r])!==J&&(a<o?l++:o<a?c++:u++);return 0===u?I:(s=(0===n?c:l)+1,t?s:s+(u-1)/2)}function Re(t,e,o){var n,s,l,u,c,f,h,p;for(l=0;l<i(t);l++)for(f=!!(c=t[l]).isArray,h=!!c.isReference,u=0;u<i(c);u++)if((s=c[u])!==a)if(U(s)){if(r.ExcelCompatibleCalcMode){if(f)continue;if(h){e.n++;continue}}if(p={value:0},r.Convert.Th(s,p))n=p.value,e.ll+=n,e.ml+=n*n;else if(!c.isArray&&!c.isReference)return A;e.n++}else{if(G(s))return s;!L(s)||o&&"boolean"==typeof s&&c.isArray||(n=D(s),e.ll+=n,e.ml+=n*n,e.n++)}}function Me(t,e,o,n){var r,i={ll:0,ml:0,n:0},a=Re(t,i,n);return G(a)?a:i.n<=e?x:(r=h(0,(i.n*i.ml-i.ll*i.ll)/(i.n*(i.n-e))),r=o?w(r):r,k(r))}function ke(t,e,o){var n,r,a,s,l,u=0,c=0,f=0,h=0,p=i(e);if(p!==i(o))return I;for(a=0;a<p;a++)n=e[a],r=o[a],n!==J&&r!==J&&(u+=n,c+=r,h++);if(h<=1)return x;for(s=u/h,l=c/h,a=0;a<p;a++)n=e[a],r=o[a],n!==J&&r!==J&&(f+=(n-s)*(r-l));return k(t?f/h:f/(h-1))}function Ne(t,e){var o,n,r,a,s=t?1:0,l=0;for(r=0;r<i(e);r++)for(o=e[r],a=0;a<i(o);a++)if((n=o[a])!==J){if(n<=0)return R;s=t?s*n:s+1/n,l++}return t?l<=0?x:k(f(s,1/l)):0===s?x:k(l/s)}function Oe(t,e,o,n,i){var l,u,c,f,h,p,d,g,m,y,C,b,S,x,A,M,k,O,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y=e.rowCount,K=e.colCount;if(t?o=o!==s?N(o,1,!1,!0,!0):e:(l=o!==s?o:function(t,e){var o=[];for(u=0;u<t;u++)for(o[u]=[],c=0;c<e;c++)o[u][c]=u*e+c+1;return new r.CalcArray(o)}(Y,K),o=N(l,1,!1,!0,!0)),f=o.rowCount,h=o.colCount,Y===f&&K===h&&(n||!i)){for(g=t?f*h:D(f*h),O=0,F=0,E=0,j=0,P=0,L=void 0,u=0;u<f;u++)for(c=0;c<h;c++)m=o[u][c],y=e[u][c],t&&(y=T(y)),O+=m,F+=m*m,E+=y,j+=y*y,P+=m*y;return A=g*F-O*O,d=n?(g*P-O*E)/A:P/F,L=n?(E*F-O*P)/A:0,t&&(d=v(d),L=v(L)),S=[[d,L]],i&&(S[1]=[],S[2]=[],S[3]=[],S[4]=[],V=j-L*E-d*P,H=(_=g*P-O*E)*_/((G=g*F-O*O)*(B=g*j-E*E)),g<3?(S[1][0]=R,S[1][1]=R,S[2][1]=R,S[3][0]=R):(S[1][0]=w(V*g/(G*(g-2))),S[1][1]=w(V*F/(G*(g-2))),S[2][1]=w((B-_*_/G)/(g*(g-2))),S[3][0]=1===H?R:H*(g-2)/(1-H)),S[2][0]=H,S[3][1]=g-2,S[4][0]=B/g-V,S[4][1]=V),new r.CalcArray(S)}if(1===K&&Y===f||1===Y&&K===h){for(y=[],m=[],A=1===K,g=f,d=h,u=0;u<g;u++)y[u]=n?e[u][0]:e[0][u],t&&(y[u]=T(y[u]));for(u=0;u<g;u++)for(m[u]=[],c=0;c<d;c++)m[u][c]=A?o[u][c]:o[c][u];for(z=[],p=0;p<d+1;p++)z[p]=[];for(C=0;C<d+1;C++)for(b=0;b<d+2;b++)z[C][b]=0;for(U=[],C=0;C<d+2;C++)U[C]=0;for(W=i?[]:a,p=0;p<g;p++)for(U[d+1]+=y[p]*y[p],z[0][d+1]+=y[p],U[0]=z[0][d+1],u=0;u<d;u++)for(z[0][u+1]+=m[p][u],z[u+1][0]=z[0][u+1],z[u+1][d+1]+=m[p][u]*y[p],U[u+1]=z[u+1][d+1],c=u;c<d;c++)z[c+1][u+1]+=m[p][u]*m[p][c],z[u+1][c+1]=z[c+1][u+1];if(z[0][0]=g,i){for(C=0;C<d+1;C++)for(W[C]=[],b=0;b<d+1;b++)W[C][b]=0;for(u=0;u<d+1;u++)W[u][u]=1}for(q=n?0:1,u=0;u<d+1;u++){if(0===z[u][u]){for(x=!1,c=u+1;!x&&c<d+1;c++)if(0!==z[c][u]){for(p=0;p<d+2;p++)A=z[u][p],z[u][p]=z[c][p],z[c][p]=A;if(i)for(p=0;p<d+1;p++)A=W[u][p],W[u][p]=W[c][p],W[c][p]=A;x=!0}if(!x)return R}for(M=1/z[u][u],p=q;p<d+2;p++)z[u][p]*=M;if(i)for(p=q;p<d+1;p++)W[u][p]*=M;for(c=q;c<d+1;c++)if(c!==u){for(M=-z[c][u],p=q;p<d+2;p++)z[c][p]+=M*z[u][p];if(i)for(p=q;p<d+1;p++)W[c][p]+=M*W[u][p]}n||(z[0][d+1]=0)}for(S=t?[[],d+1]:[[]],u=0;u<d+1;u++)S[0][u]=t?v(z[d-u][d+1]):z[d-u][d+1];if(i){if(t)S[1]=[],S[2]=[],S[3]=[],S[4]=[];else for(C=1;C<5;C++)for(S[C]=[],b=0;b<d+1;b++)S[C][b]=0;for(J=void 0,void 0,void 0,X=U[d+1]-U[0]*U[0]/g,J=U[d+1],u=0;u<d+1;u++)J-=z[u][d+1]*U[u];if(Z=X-J,S[2][0]=0===X?R:Z/X,S[4][0]=Z,S[4][1]=J,0===(A=n?g-d-1:g-d)){for(u=0;u<d+1;u++)S[1][u]=R;S[2][1]=R}else{for(k=J/D(A),n||(S[1][d]=I),u=q;u<d+1;u++)S[1][d-u]=w(k*W[u][u]);S[2][1]=w(k)}for(S[3][0]=0===J?R:D(A)*Z/(J*D(d)),S[3][1]=D(A),u=2;u<5;u++)for(c=2;c<d+1;c++)S[u][c]=I}return new r.CalcArray(S)}return R}function De(t,e){var o,n,r,a,s,l=0,u=0,c=0,f=[];for(r=0;r<i(e);r++)for(s=e[r],f.push(s),a=0;a<i(s);a++)(o=s[a])!==J&&(l+=o,c++);for(n=l/c,r=0;r<i(e);r++)for(s=f[r],a=0;a<i(s);a++)(o=s[a])!==J&&(u+=t?(o-n)*(o-n):b(o-n));return t?k(u):0===c?x:k(u/c)}function Fe(){return _(arguments,2,7)}function Ee(t,e){return V([t,e],16)}function je(t,e,o,n){var r,a,l,u,c,f,h,p,g,m,y,C,v,b,w,T=o,S=o!==s&&F(o);if(o!==s){if(t=N(t,0,!0,!1,!1),(o=N(o,1,!0,!1,!1,!0,s,!0)).isError)return o[0]}else{if((t=N(t,1,!0,!1,!1,!0,s,!0)).isError)return t[0];o=t}if(r=0,a=0,l=P(e),t.rowCount!==o.rowCount||t.colCount!==o.colCount)return A;for(m=t.rowCount,S&&(u=n.row,c=n.column,f=T.getRow(0),h=T.getColumn(0),p=n.source.getCalcSourceModel().qg(u,c),g=T.getSource(),S=p&&g.getRangeKey),y=0;y<i(t);y++)if(C=t[y],l&&l(C,!0)&&(v=o[y],S&&(b={id:g.id,row:f+y%m,col:h+d(y/m),rowCount:1,colCount:1},w=g.getRangeKey(g,b),p.eOb||(p.eOb={}),p.eOb[w]=b),v!==J)){if(G(v))return v;r+=v,a++}return 0===a?x:k(r/a)}function Pe(t,e,o,n,i){var a,s,l,u=e,c=e,f=t?u.getRowCount():c.getRowCount(0),h=t?u.getColumnCount():c.getColumnCount(0),p=[];for(a=0;a<f;a++)for(p[a]=[],s=0;s<h;s++)l=t?u.getValue(a,s):c.getValue(0,a,s),p[a][s]=je(o,l,n,i);return new r.CalcArray(p)}function Le(){return V(arguments,13)}function Ge(t,e,o){var n=r.CalcArrayHelper;if(r.Convert.Fh(t)){if(1!==n.getLength(t))return A;t=n.getValueByIndex(t,0)}return t=D(t),l(t)?A:Ie(!0,e,t,o)}function Be(t,e,o){return Kt(t,e,o,!0)}function _e(t,e){return V([t,e],17)}function Ve(t,e){var o,n,r=0,s=0===e||"*"===e,l=P(e);for(o=0;o<i(t);o++)n=t[o],s&&n===a||!l||!l(n)||r++;return k(r)}function He(){return _(arguments,2,8)}function ze(){return _(arguments,2,10)}function Ue(){return _(arguments,2,11)}function We(t,e){return ke(!0,t,e)}function qe(t,e,o){var n=fo(t/2);return G(n)?n:-D(n)*(e/w(o))}function Je(t){var e,o=t,n=o+5.5;return n-=(o+.5)*T(n),e=1.000000000190015+76.18009172947146/(t+1),e-=86.50532032941678/(t+2),e+=24.01409824083091/(t+3),e-=1.231739572450155/(t+4),e+=.001208650973866179/(t+5),T(2.506628274631001*(e-=5395239384953e-18/(t+6))/o)-n}function Xe(t,e,o,n,r){var i,a,s,l,u,c,f;return t<n||r<t||n===r?R:(i=(t-n)/(r-n),a=Je(e+o),s=Je(e),l=Je(o),u=T(i),c=T(1-i),f=v(a-s-l+e*u+o*c)*function(t,e,o){var n,r,i,a,s,l=1e-50,u=t+e,c=t+1,f=t-1,h=1,p=1-u*o/c;for(b(p)<l&&(p=l),n=p=1/p,r=1;r<=300&&(b(p=1+(a=(e-r)*r*o/((f+(i=r+r))*(t+i)))*p)<l&&(p=l),b(h=1+a/h)<l&&(h=l),n*=(p=1/p)*h,b(p=1+(a=0-(t+r)*(u+r)*o/((t+i)*(c+i)))*p)<l&&(p=l),b(h=1+a/h)<l&&(h=l),n*=s=(p=1/p)*h,!(b(s-1)<1e-20));r++);return n}(o,e,1-i)/o,k(i<(e+1)/(e+o+2)?f:1-f))}function Ze(t,e,o,n,r){var i,a,s,l,u,c,p,d,g,m,y,C,S,x,A,I,R,M,N,O=3e-308,D=O,F=1-222e-18,E=ie(e,o);for(t<=.5?(l=t,d=e,m=o,i=0):(l=1-t,d=o,m=e,i=1),I=(y=w(-T(l*l)))-(2.30753+.27061*y)/(1+(.99229+.04481*y)*y),d>1&&m>1?(A=I*w((p=2/((C=1/(d+d-1))+(S=1/(m+m-1))))+(y=(I*I-3)/6))/p-(S-C)*(y+5/6-2/(3*p)),N=d/(d+m*v(A+A))):(S=(y=m+m)*f(1-(S=1/(9*m))+I*w(S),3))<=0?N=1-v((T((1-l)*m)+E)/m):N=(S=(4*d+y-2)/S)<=1?v((T(l*d)+E)/d):1-2/(S+1),y=1-d,S=1-m,R=0,u=1,N<D?N=D:N>F&&(N=F),M=h(1e-300,f(10,-13-2.5/(d*d)-.5/(l*l))),x=g=0,a=0;a<1e3;a++){for((I=((I=ae(N,d,m))-l)*v(E+y*T(N)+S*T(1-N)))*R<=0&&(g=h(b(u),O)),c=1,s=0;s<1e3;s++){if(b(u=c*I)<g&&((x=N-u)>=0&&x<=1)){if(g<=M)return 0!==i&&(N=1-N),k((r-n)*N+n);if(b(I)<=M)return 0!==i&&(N=1-N),k((r-n)*N+n);if(0!==x&&1!==x)break}c/=3}if(x===N)return 0!==i&&(N=1-N),k((r-n)*N+n);N=x,R=I}return 0!==i&&(N=1-N),k((r-n)*N+n)}function Ye(t,e,o,n){var r,i,a,s;if(e<t)return R;if(!n){if(0===(i=f(r=1-o,e))){if(0===(i=f(o,e)))return R;for(a=0;a<e-t&&i>0;a++)i*=D(e-a)/D(a+1)*r/o;return i}for(a=0;a<t&&i>0;a++)i*=D(e-a)/D(a+1)*o/r;return i}if(e===t)return 1;if(0===(i=f(r=1-o,e))){if(0===(i=f(o,e)))return R;for(s=1-i,a=0;a<e-t&&i>0;a++)s-=i*=D(e-a)/D(a+1)*r/o;return s<0?0:s}for(s=i,a=0;a<t&&i>0;a++)s+=i*=D(e-a)/D(a+1)*o/r;return s}function Ke(t,e,o){var n,r,i=1-e,a=f(i,t);if(0===a){if(0===(a=f(e,t)))return R;for(n=1-a,r=0;r<t&&n>=o;r++)n-=a*=D(t-r)/D((r+1)*i/e);return D(t-r)}for(n=a,r=0;r<t&&n<o;r++)n+=a*=D(t-r)/D((r+1)*e/i);return D(r)}function Qe(t,e){var o,n,r,i,a,s,l=T(w(y)),u=1/w(y),c=0,f=t,h=.5*f,p=e%2==0;if(e>1&&(c=v(-h)),a=H(-w(f)),G(a))return a;if(s=D(a),n=p?c:2*s,e>2){if(f=.5*(e-1),r=p?1:.5,h>20){for(o=p?0:l,i=T(h);r<=f;)o=T(r)+o,n+=v(i*r-h-o),r+=1;return n}for(o=p?1:u/w(h),i=0;r<=f;)i+=o*=h/r,r+=1;return i*c+n}return n}function $e(t,e){var o=ao(1-t,.5*e,2);return D(o)}function to(t,e){var o,n,r,a,s=0,l=t.rowCount,u=t.colCount;if(l!==e.rowCount||u!==e.colCount)return I;if(l>1&&u>1)o=(l-1)*(u-1);else if(l>1&&1===u)o=l-1;else{if(!(1===l&&u>1))return I;o=u-1}for(n=0;n<i(t);n++)if(r=t[n],a=e[n],r!==J&&a!==J){if(0===a)return x;s+=(r-a)*(r-a)/a}return s<0?R:Qe(s,o)}function eo(t,e,o){var n=v(-e*t);return k(o?1-n:e*n)}function oo(t,e,o){var n=Xe(e*t/(e*t+o),.5*e,.5*o,0,1);return G(n)?n:1-D(n)}function no(t,e,o){var n=Ze(1-(1-t),o/2,e/2,0,1);return G(n)?n:(1/D(n)-1)*(o/e)}function ro(t,e){var o,n,r,i,a,s,l={N:0,M:0,Q:0,kl:0};return fe(l,t),i=l.N-1,1===l.N?x:0===(o=l.Q/(l.N-1))?x:(l.N=0,l.M=0,l.Q=0,l.kl=0,fe(l,e),a=l.N-1,1===l.N?x:0===(n=l.Q/(l.N-1))?x:(s=oo(o/n,i,a),G(s)?s:((r=2*(1-D(s)))>1&&(r=2-r),r)))}function io(t,e,o,n){var r,i,a,s,c,h,d,g,m,y,C,S,A,I,M,k;if(!1===n)return r=f(o,e),l(r)||!u(r)?x:1/(r*ne(e))*(f(t,e-1)*v(-t/o));if(1/3,1e8,k=1e37,1e3,-88,(t/=o)<=0)return R;if(e>1e3)return M=uo(i=3*w(e)*(f(t/e,.3333333333333333)+1/(9*e)-1),0,1,!0),G(M)?M:D(M);if(t>1e8)return 1;if(t<=1||t<e){if(M=so(e+1),G(M))return M;g=e*T(t)-t-D(M),m=1,I=1,C=e;do{I+=m=m*t/(C+=1)}while(m>2220446049250313e-31);g+=T(I),I=0,g>=-88&&(I=v(g))}else{if(M=so(e),G(M))return M;for(g=e*T(t)-t-D(M),m=0,i=1,a=t,I=(s=t+1)/(c=t*(S=(C=1-e)+t+1));;){if(h=(S+=2)*s-(A=(C+=1)*(m+=1))*i,b(d=S*c-A*a)>0){if(b(I-(y=h/d))<=p(2220446049250313e-31,2220446049250313e-31*y))break;I=y}i=s,a=c,s=h,c=d,b(h)>=k&&(i/=k,a/=k,s/=k,c/=k)}g+=T(I),I=1,g>=-88&&(I=1-v(g))}return I}function ao(t,e,o){var n,r,i,a,s,l,u,c,h,p,d,g,m,y,C=2520;if(t<2e-6)return 0;if(t>.999998)return q;if(u=2*e,i=e-1,y=so(e),G(y))return y;if(s=D(y),u<-1.24*T(t)){if((a=f(t*e*v(s+.6931471805599453*e),1/e))<5e-7)return NaN}else if(u>.32){if(y=co(t,0,1),G(y))return y;g=D(y),(a=u*f(g*w(l=.222222/u)+1-l,3))>2.2*u+6&&(a=-2*(T(1-t)-i*T(.5*a)+s))}else{a=.4,n=T(1-t)+s+.6931471805599453*i;do{h=a,d=(4.67+2*a)/(l=1+a*(4.67+a))-.5-(6.73+a*(13.32+3*a))/(c=a*(6.73+a*(6.66+a))),a-=(1-v(n+.5*a)*c/l)/d}while(b(h/a-1)>.01)}for(m=1;m<=20;m++){if(h=a,y=io(l=.5*a,e,1,!0),G(y))return y;if(d=(c=t-D(y))*v(.6931471805599453*e+s+l-i*T(a)),b(h/(a+=d*(1+.5*d*(p=(210+(n=.5*d-(r=d/a)*i)*(140+n*(105+n*(84+n*(70+60*n)))))/420)-r*i*(p-r*((420+n*(735+n*(966+n*(1141+1278*n))))/C-r*((210+n*(462+n*(707+932*n)))/C-r*((252+n*(672+1182*n)+i*(294+n*(889+1740*n)))/5040-r*((84+2264*n+i*(1175+606*n))/C-r*((120+i*(346+127*i))/5040))))))))-1)>5e-7)return.5*o*a}return.5*o*a}function so(t){return re(t)}function lo(t,e,o){var n,r=fo(t);return G(r)?r:(n=D(r),k(v(e+o*n)))}function uo(t,e,o,n){return n?H((t-e)/o):k(v(-(t-e)*(t-e)/(2*o*o))/(w(2*y)*o))}function co(t,e,o){var n,r,i,a,s,l=t-.5;if(b(l)<=.42)r=l*(((-25.44106049637*(n=l*l)+41.39119773534)*n-18.61500062529)*n+2.50662823884)/((((3.13082909833*n-21.06224101826)*n+23.08336743743)*n-8.4735109309)*n+1);else{if(n=t,l>0&&(n=1-t),!(n>2220446049250313e-31))return n>1e-300?(r=-2*T(t),n=T(6.283185307179586*r),r=w(r*(1-(n=n/r+(2-n)/(r*r)+(6*n-14-n*n)/(2*r*r*r)))),l<0?-r:r):l<0?-q:q;r=(((2.32121276858*(n=w(-T(n)))+4.85014127135)*n-2.29796479134)*n-2.78718931138)/((1.63706781897*n+3.54388924762)*n+1),l<0&&(r=-r)}return a=.3989422804014327*v(-.5*(i=(r-0)/1)*i)/1,s=uo(r,0,1,!0),G(s)?s:e+o*(r-=(s-t)/a)}function fo(t){return co(t,0,1)}function ho(t,e,o){var n,i=0;if(o)for(n=0;n<=t;n++)i+=v(-e)*f(e,n)/r.Functions.tk(n);else i=v(-e)*f(e,t)/r.Functions.tk(t);return k(i)}function po(t,e,o){var n,r,i,a,s,l,u,c,f,h;if(1!==o&&2!==o)return R;if(r=t/w(n=e),i=n/(n+t*t),a=n-2,s=n%2,l=1,u=1,n=1,f=c=2+s,a>=2)for(h=O(c);h<=a&&(l+=u=u*i*(f-1)/f)!==n;h+=2)n=l,f+=2;return 1!==s?o*(1-(.5+.5*r*w(i)*l)):(1===e&&(l=0),o*(1-(.5+.3183098862*(r*i*l+C(r)))))}function go(t,e){var o,n,r,i,a,s,l,u,c,h,p=t/2,d=p;if(e>1e20)return fo(p);if(d<.5?(c=0,a=2*d):(c=1,a=2*(1-d)),b(e-2)<1e-12)s=a>0?w(2/(a*(2-a))-2):q;else if(D(e)<1+1e-12)a>0?s=-m(1.5707963267948966*(a+1)):s=q;else{if(i=((94.5/((n=48/((o=1/(e-.5))*o))+(r=((20700*o/n-98)*o-16)*o+96.36))-3)/n+1)*w(1.5707963267948966*o)*e,(u=f(i*a,2/e))>.05+o){if(h=fo(.5*a),G(h))return h;l=D(h),e<5&&(r+=.3*(e-4.5)*(l+.6)),u=(((((.4*(u=l*l)+6.3)*u+36)*u+94.5)/(r=(((.05*i*l-5)*l-7)*l-2)*l+n+r)-u-3)/n+1)*l,u=(u*=o*u)>.002?v(u)-1:.5*u*u+u}else u=((1/(((e+6)/(e*u)-.089*i-.822)*(e+2)*3)+.5/(e+4))*u-1)*(e+1)/(e+2)+1/u;s=w(e*u)}return 0!==c&&(s=-s),k(s)}function mo(t,e,o,n){var r,a,s,c,f,h,p,d,g,m,y,C,v,T,S,A,M,k,N,O,F={N:0,M:0,Q:0,kl:0};if(1!==o&&2!==o)return R;if(1===n){if(m=void 0,y=void 0,C=void 0,v=void 0,T=void 0,S=void 0,A=void 0,i(t)!==i(e))return I;for(M=i(t),A=0;A<M;A++)t[A]=t[A]-e[A];for(v=T=S=m=0,A=0;A<M;A++)v+=C=(y=(k=t[A])-v)/(S+1),T+=S*y*C,S++,m+=k;if(S-1==0||0===S)return x;if(c=w(T/(S-1)),l(c)||!u(c))return R;s=(r=m/S)/(c/w(S)),p=S-1}else F.N=0,F.M=0,F.Q=0,F.kl=0,le(F,t),f=F.Q/(F.N-1),r=F.kl/F.N,d=F.N,F.N=0,F.M=0,F.Q=0,F.kl=0,le(F,e),h=F.Q/(F.N-1),a=F.kl/F.N,g=F.N,2!==n?p=1/((N=f/d/(f/d+h/g))*N/D(d-1)+(1-N)*(1-N)/D(g-1)):p=D(d+g-2),s=(r-a)/w(f/D(d)+h/D(g));return O=ce(.5*p,.5,p/(p+(s=b(s))*s)),G(O)?O:.5*o*D(O)}function yo(t,e,o,n){var r=v(-f(t/o,e));return k(n?1-r:e/f(o,e)*f(t,e-1)*r)}function Co(t,e,o){var n,r,a,u,c,f,h=0,p=0,d=0,g=0;if(o!==s&&(h=D(o),l(h)))return A;for(u=0;u<i(t);u++)(c=t[u])!==J&&(p+=a=D(c),d+=a*a,g++);return 0===g?I:1===g?x:(n=p/g,0===(r=o!==s?h:w((g*d-p*p)/(g*(g-1))))?x:(f=H((n-e)/(r/w(g))),G(f)?f:k(1-D(f))))}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("CalcEngine"),i=n.Common.k.ac,a=null,s=void 0,l=isNaN,u=isFinite,c=parseInt,f=Math.pow,h=Math.max,p=Math.min,d=Math.floor,g=Math.sin,m=Math.tan,y=Math.PI,C=Math.atan,v=Math.exp,b=Math.abs,w=Math.sqrt,T=Math.log,S=Math.round,x=r.Errors.DivideByZero,A=r.Errors.Value,I=r.Errors.NotAvailable,R=r.Errors.Number,M=r.Errors.Null,k=r.Convert.Nh,N=r.Convert.Ph,O=r.Convert.Rh,D=r.Convert.Pa,F=r.Convert.Fh,E=r.Functions.MathHelper,j=E.Bk,P=E.xk,L=r.Convert.Na,G=r.Convert.vf,B=r.Functions.Hfc,_=r.Functions.sk,V=r.Functions.sja,H=r.Functions.qk,z=r.Functions.ik,U=r.Functions.jk,W=r.Functions.Na,q=r.Functions.hk,J=r.Convert.CalcConvertedError,X=r.Functions.ak,Z=r.Convert.Th,Y=r.Convert.Sh,rt={Hi:0,aj:["< 0",">= 1"]},gt={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},mt={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},yt={Hi:4,Ii:1,Ki:!0,Mi:!0},Ct={Hi:4,Ii:0,Ji:!0},wt={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},Tt={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},xt=[pt={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},{Hi:2}],At=[pt,nt={Hi:0},{_i:3,Hi:2,aj:"< 1"}],It=[it={Hi:0,aj:["<= 0",">= 1"]},at={Hi:0,aj:"<= 0"},tt={Hi:2,aj:"< 1"}],Rt=[it,at,at,st={_i:0,Hi:0},lt={_i:1,Hi:0}],Mt=[et={Hi:2,aj:"< 0"},et,ut={Hi:0,aj:["< 0","> 1"]},K={Hi:7}],kt=[et,ut,it],Nt=[ct={Hi:0,aj:"< 0"},ft={Hi:0,aj:["< 1","> 10000000000"]}],Ot=[ut,ot={Hi:2,aj:["< 1","> 10000000000"]}],Dt=[dt={Hi:4,Ii:1,Ji:!0,Ki:!0},dt],Ft=[ct,at,K],Et=[ct,ht={Hi:0,aj:["< 1",">= 10000000000"]},ht],jt=[ut,ht,ht],Pt=[pt,pt],Lt=[ct,at,at,K],Gt=[ut,at,at],Bt=[ut,nt,at],_t=[nt,nt,at,K],Vt=[vt={Hi:4,Ii:1,Ji:!0},vt],Ht=[et,ct,K],zt=[ct,tt],Ut=[bt={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},bt,$={Hi:2},{Hi:2,aj:["< 1","> 3"]}],Wt=[ct,at,at,K],qt=[pt,nt],Jt=[St={Hi:4,Ii:1,Ki:!0,Li:!0},{},Q={_i:!0,Hi:7},{_i:!1,Hi:7}],Xt=[{},pt,st],Zt=[{Hi:4,Ii:1,Ji:!0,Ki:!0,hOb:!0,Mi:!0},nt],X("TREND",(function(t,e,o,i){var a,l;for(e=e!==s?N(e,0,!1,!0,!1):t,o=o!==s?N(o,0,!1,!0,!1):e,a=0;a<t.rowCount;a++)for(l=0;l<t.colCount;l++)if(!L(t[a][l]))return A;for(a=0;a<e.rowCount;a++)for(l=0;l<e.colCount;l++)if(!L(e[a][l]))return A;for(a=0;a<o.rowCount;a++)for(l=0;l<o.colCount;l++)if(!L(o[a][l]))return A;return n.Common.qc(t,e,o,i,D,r.CalcArray,A,I)}),1,4,[{Hi:4,Ii:0,Ki:!0},{},{},Q],[0,1,2],[0,1,2],{bk:[1,2,3]}),X("GROWTH",(function(t,e,o,i){return e=e!==s?N(e,1,!1,!0,!0):t,o=o!==s?N(o,1,!1,!0,!0):e,n.Common.sc(t,e,o,i,r.CalcArray,R,I)}),1,4,[St,{},{},Q],"!= 3","!= 3",{bk:[1,2,3]}),X("FORECAST",(function(t,e,o){var n,r,a,s,l=0,u=0,c=0,f=0,h=i(e),p=0;if(h!==i(o))return I;for(n=0;n<h;n++)r=e[n],a=o[n],r!==J&&a!==J&&(l+=r,u+=a,c+=a*a,f+=a*r,p++);return 0===p||p*c-u*u==0?x:k(l/p-(s=(p*f-u*l)/(p*c-u*u))*(u/p)+s*t)}),3,3,[nt,pt,pt],"> 0","> 0"),X("AVERAGE",(function(){return B(arguments,2,1)}),1,s,s,-1,-1),X("STDEV",Fe,1,s,s,-1,-1),X("STDEV.S",Fe,1,s,s,-1,-1),X("PERCENTILE",Ee,2,2,s,0,0),X("PERCENTILE.INC",Ee,2,2,s,0,0),X("MAX",(function(){return B(arguments,2,4)}),1,s,s,-1,-1),X("MAXA",(function(){return Ae(!0,arguments)}),1,s,wt,-1,-1),X("MIN",(function(){return B(arguments,2,5)}),1,s,s,-1,-1),X("MINA",(function(){return Ae(!1,arguments)}),1,s,wt,-1,-1),X("LARGE",(function(t,e){return V([t,e],14)}),2,2,Zt,0,0),X("SMALL",(function(t,e){return V([t,e],15)}),2,2,Zt,0,0),X("AVERAGEA",(function(){var t,e,o,n,r=arguments,s=0,l=0;for(t=0;t<i(r);t++)for(n=r[t],e=0;e<i(n);e++)o=n[e],L(o,!0)||z(o)?(s+=D(o),l++):(o===a||U(o))&&l++;return 0===l?x:k(s/l)}),1,s,Tt,-1,-1),X("AVERAGEIF",(function(t,e,o,n){return r.Convert.Fh(o)?Pe(!1,o,e,n,t):r.Convert.Ca(o)?Pe(!0,o,e,n,t):je(e,o,n,t)}),2,3,s,[0,1,2],[0,1,2],{bk:2,KMc:[2],dk:!0}),X("MEDIAN",(function(){return V(arguments,12)}),1,s,gt,-1,-1),X("MODE",Le,1,s,gt,-1,-1),X("MODE.SNGL",Le,1,s,gt,-1,-1),X("GEOMEAN",(function(){return Ne(!0,arguments)}),1,s,mt,-1,-1),X("HARMEAN",(function(){return Ne(!1,arguments)}),1,s,gt,-1,-1),X("TRIMMEAN",(function(t,e){var o,n,r,i=0,a=[];for(pe(t,a),o=function(t){var e,o=0;for(e=0;e<t.length;e++)t[e]!==J&&o++;return o}(a),r=n=c(""+o*e/2);r<o-n;r++)i+=D(a[r]);return i/(o-2*n)}),2,2,[pt,rt],0,0),X("FREQUENCY",(function(t,e){var o,n,i,a,s,l,u,c,f,h,p,d,g=0,m=e.rowCount,y=e.colCount;for(o=0;o<m;o++)for(n=0;n<y;n++)e[o][n]!==J&&g++;for(a=t.rowCount,s=t.colCount,l=[],u=[],c=g+1,g=0,o=0;o<m;o++)for(n=0;n<y;n++)(i=e[o][n])!==J&&(l[g++]=D(i));for(f=l.slice(0),he(l),o=0;o<c;o++)u[o]=[0];for(o=0;o<a;o++)for(n=0;n<s;n++)if(i=t[o][n],L(i)){for(h=D(i),p=!1,d=0;!p&&d<g;d++)h<=l[d]&&(u[f.indexOf(l[d])][0]++,p=!0);p||u[g][0]++}return new r.CalcArray(u)}),2,2,[yt,yt],-1,-1),X("RANK",Ge,2,3,Xt,[0,1],[0,1],{bk:2}),X("RANK.EQ",Ge,2,3,Xt,[0,1],1,{bk:2}),X("KURT",(function(){var t,e,o,n,r,a,s=arguments,l=0,u=0,c=0,h=0,p=i(s),d=[];if(p>0){for(a=s[0],d.push(a),n=0;n<i(a);n++)(t=a[n])!==J&&(l+=t,u+=t*t,h++);if(h<=3)return x;if(e=l/h,0===(o=w((h*u-l*l)/(h*(h-1)))))return x;for(r=0;r<p;r++)for(a=d[r],n=0;n<i(a);n++)(t=a[n])!==J&&(c+=f((t-e)/o,4));return k(h*(h+1)*c/((h-1)*(h-2)*(h-3))-3*(h-1)*(h-1)/((h-2)*(h-3)))}}),1,s,gt,-1,-1),X("PERCENTRANK",Be,2,3,At,0,0,{bk:2}),X("PERCENTRANK.INC",Be,2,3,At,0,0,{bk:2}),X("PERCENTRANK.EXC",(function(t,e,o){return Kt(t,e,o,!1)}),2,3,At,0,0,{bk:2}),X("QUARTILE",_e,2,2,xt,0,0),X("QUARTILE.INC",_e,2,2,xt,0,0),X("COUNT",(function(){return B(arguments,2,2)}),1,s,s,-1,-1,{gk:-1}),X("COUNTA",(function(){return B(arguments,2,3)}),1,s,s,-1,-1,{gk:-1}),X("COUNTBLANK",(function(t){var e,o=0;for(e=0;e<i(t);e++)t[e]!==a&&""!==t[e]||o++;return o}),1,1,Ct,-1,-1),X("COUNTIF",(function(t,e){var o,n,i,a,s,u,c,f,h;if(e.isArray||e.isReference){for(o=void 0,n=void 0,i=0,a=[],s=e.rowCount,u=e.colCount,c=0;c<s;c++){for(f=[],h=0;h<u;h++,i++)n=Ve(t,e[i]),G(n)?f.push(n):(o=D(n),l(o)?f.push(A):f.push(o));a.push(f)}return new r.CalcArray(a)}return Ve(t,e[0])}),2,2,[Ct,Ct],[0,1],[0,1]),X("AVEDEV",(function(){return De(!1,arguments)}),1,s,gt,-1,-1),X("STDEVA",(function(){return Me(arguments,1,!0,!0)}),1,s,Tt,-1,-1),X("STDEVP",He,1,s,s,-1,-1),X("STDEV.P",He,1,s,s,-1,-1),X("STDEVPA",(function(){return Me(arguments,0,!0,!1)}),1,s,Tt,-1,-1),X("VAR",ze,1,s,s,-1,-1),X("VAR.S",ze,1,s,s,-1,-1),X("VARA",(function(){return Me(arguments,1,!1,!1)}),1,s,Tt,-1,-1),X("VARP",Ue,1,s,s,-1,-1),X("VAR.P",Ue,1,s,s,-1,-1),X("VARPA",(function(){return Me(arguments,0,!1,!1)}),1,s,Tt,-1,-1),X("COVAR",We,2,2,Dt,-1,-1),X("COVARIANCE.P",We,2,2,Dt,-1,-1),X("DEVSQ",(function(){return De(!0,arguments)}),1,s,gt,-1,-1),X("CONFIDENCE",qe,3,3,It),X("CONFIDENCE.NORM",qe,3,3,It),X("CONFIDENCE.T",(function(t,e,o){return 1===o?x:e*xe(t,o-1,2)/w(o)}),3,3,It),X("INTERCEPT",(function(t,e){var o,n,r,a=0,s=0,l=0,u=0,c=0,f=i(t);if(f!==i(e))return I;for(r=0;r<f;r++)o=t[r],(n=e[r])!==J&&o!==J&&(a+=o,s+=n,l+=n*n,u+=n*o,c++);return 0===c||c*l-s*s==0?x:k(a/c-(c*u-s*a)/(c*l-s*s)*(s/c))}),2,2,[gt,gt],-1,-1),X("LINEST",(function(t,e,o,n){return Oe(!1,t,e,o,n)}),1,4,Jt,[0,1],[0,1],{bk:[1,2,3],fk:1}),X("SLOPE",(function(t,e){var o,n,r,a,s,l=0,u=0,c=0,f=0,h=0,p=i(e);if(p!==i(t))return I;for(o=0;o<p;o++)n=t[o],(r=e[o])===J||n===J||G(r)||G(n)||(l+=a=D(n),u+=s=D(r),c+=s*s,f+=s*a,h++);return h*c-u*u==0?x:k((h*f-u*l)/(h*c-u*u))}),2,2,[gt,gt],-1,-1,{fk:1}),X("LOGEST",(function(t,e,o,n){return Oe(!0,t,e,o,n)}),1,4,Jt,[0,1],[0,1],{bk:[1,2,3]}),X("STEYX",(function(t,e){var o,n,r,a,s,l=0,u=0,c=0,f=0,h=0,p=0,d=i(t);if(d!==i(e))return I;for(r=0;r<d;r++)a=t[r],s=e[r],a!==J&&s!==J&&(l+=n=a,u+=n*n,c+=o=s,f+=o*o,h+=o*n,p++);return p*(p-2)==0||p*f-c*c==0?x:w((p*u-l*l-(p*h-c*l)*(p*h-c*l)/(p*f-c*c))/(p*(p-2)))}),2,2,Dt,-1,-1),X("BETADIST",Xe,3,5,[nt,at,at,st,lt],s,s,{bk:[3,4]}),X("BETA.DIST",(function(t,e,o,n,r,i){if(t<r||i<t||r===i)return R;var a=(t-r)/(i-r);return n?de(a,e,o):ge(a,e,o)/(i-r)}),4,6,[nt,at,at,K,st,lt],s,s,{bk:[5,6]}),X("BETAINV",Ze,3,5,Rt,s,s,{bk:[3,4]}),X("BETA.INV",Ze,3,5,Rt,s,s,{bk:[3,4]}),X("BINOMDIST",Ye,4,4,Mt),X("BINOM.DIST",Ye,4,4,Mt),X("NEGBINOMDIST",(function(t,e,o){if(t+e-1<=0)return R;var n=j(t+e-1,e-1);return G(n)?n:k(D(n)*f(o,e)*f(1-o,t))}),3,3,[$,$,rt]),X("NEGBINOM.DIST",(function(t,e,o,n){if(t+e-1<=0)return R;if(n)return 1-de(1-o,t+1,e);var r,i=f(o,e);for(r=0;r<t;r++)i*=(r+e)/(r+1)*(1-o);return i}),4,4,[et,tt,rt,K]),X("CRITBINOM",Ke,3,3,kt),X("BINOM.INV",Ke,3,3,kt),X("CHIDIST",Qe,2,2,Nt),X("CHISQ.DIST.RT",Qe,2,2,Nt),X("CHISQ.DIST",(function(t,e,o){return o?we(t,e):function(t,e){var o,n;if(t<=0)return 0;if(e*t>1391e3)o=v((.5*e-1)*T(.5*t)-.5*t-T(2)-ve(.5*e));else{for(e%2<.5?(o=.5,n=2):(o=1/w(2*t*y),n=1);n<e;)o*=t/n,n+=2;o=t>=1425?v(T(o)-t/2):o*v(-t/2)}return o}(t,e)}),3,3,[ct,ot,K]),X("CHIINV",$e,2,2,Ot),X("CHISQ.INV.RT",$e,2,2,[ut,tt]),X("CHISQ.INV",(function(t,e){var o=function(t,e){return{ge:function(o){return t-we(o,e)}}}(t,e),n={jl:!1},r=se(o,.5*e,e,n);return n.jl?I:r}),2,2,Ot),X("CHITEST",to,2,2,Dt,-1,-1),X("CHISQ.TEST",to,2,2,Dt,-1,-1),X("CORREL",(function(t,e){var o,n,a,s,l,u,c,f,h=r.ExcelCompatibleCalcMode?5:1,p=N(t,h,!0,!1,!1,!0),d=N(e,h,!0,!1,!1,!0),g=0,m=0,y=0,C=0,v=0,b=i(d);if(b!==i(p))return I;for(l=0,u=0;u<b;u++){if(c=p[u],f=d[u],G(c))return c;if(G(f))return f;c!==J&&f!==J&&(g+=c,m+=f,y+=c*c,C+=f*f,l++)}if(l<=1)return x;if(o=g/l,n=m/l,a=w((l*y-g*g)/(l*(l-1))),s=w((l*C-m*m)/(l*(l-1))),0===a||0===s)return x;for(u=0;u<b;u++)c=p[u],f=d[u],c!==J&&f!==J&&(v+=(c-o)*(f-n));return k(v/D((l-1)*a*s))}),2,2,s,-1,-1),X("EXPONDIST",eo,3,3,Ft),X("EXPON.DIST",eo,3,3,Ft),X("FDIST",oo,3,3,Et),X("F.DIST",(function(t,e,o,n){return n?1-de(o/(o+e*t),o/2,e/2):f(e/o,e/2)*f(t,e/2-1)/(f(1+t*e/o,(e+o)/2)*me(!0,e/2,o/2))}),4,4,[ct,ft,ft,K]),X("F.DIST.RT",oo,3,3,Et),X("FINV",no,3,3,jt),X("F.INV.RT",no,3,3,jt),X("F.INV",(function(t,e,o){var n=Ze(1-t,o/2,e/2,0,1);return G(n)?n:(1/D(n)-1)*(o/e)}),3,3,[ut,ot,ot]),X("FISHER",(function(t){return T((1+t)/(1-t))/2}),1,1,{Hi:0,aj:["<= -1",">= 1"]}),X("FISHERINV",(function(t){var e=v(2*t)-1,o=v(2*t)+1;return!u(e)&&e>0&&!u(o)&&o>0?1:e/o}),1,1,nt),X("FTEST",ro,2,2,Pt,-1,-1),X("F.TEST",ro,2,2,Pt,-1,-1),X("GAMMADIST",io,4,4,Lt),X("GAMMA.DIST",io,4,4,Lt),X("GAMMAINV",ao,3,3,Gt),X("GAMMA.INV",ao,3,3,Gt),X("GAMMALN",so,1,1,at),X("GAMMALN.PRECISE",so,1,1,at),X("HYPGEOMDIST",(function(t,e,o,n){return t>p(e,o)||t<h(0,e-n+o)||e>n||o>n?R:Te(t,e,o,n)}),4,4,[et,et,et,et]),X("HYPGEOM.DIST",(function(t,e,o,n,r){var i,a;if(t>p(e,o)||t<h(0,e-n+o)||e>n||o>n)return R;if(r){for(i=0,a=0;a<=t;a++)i+=Te(a,e,o,n);return i}return Te(t,e,o,n)}),5,5,[et,et,et,et,K]),X("LOGNORMDIST",(function(t,e,o){return H((T(t)-e)/o)}),3,3,[at,nt,at]),X("LOGNORM.DIST",(function(t,e,o,n){if(n)return H((T(t)-e)/o);var r=(T(t)-e)/o;return.3989422804014327*v(-r*r/2)/o/t}),4,4,[at,nt,at,K]),X("LOGINV",lo,3,3,Bt),X("LOGNORM.INV",lo,3,3,Bt),X("NORMDIST",uo,4,4,_t),X("NORM.DIST",uo,4,4,_t),X("NORMINV",co,3,3,Bt),X("NORM.INV",co,3,3,Bt),X("NORMSDIST",H,1,1,nt,s,s),X("NORMSINV",fo,1,1,ut),X("NORM.S.INV",fo,1,1,ut),X("NORM.S.DIST",(function(t,e){return e?function(t){var e,o;return e=D(t=.7071067811865475*-t),l(e)?A:(o=H(e*w(2)),G(o)?NaN:.5*(2-2*o))}(t):v(-f(t,2)/2)/w(2*y)}),2,2,[nt,K]),X("PEARSON",(function(t,e){var o,n,r,a,s=0,l=0,u=0,c=0,f=0,h=i(t);if(h!==i(e))return I;for(o=0,n=0;n<h;n++)r=t[n],a=e[n],W(r)&&W(a)&&(s+=r,l+=a,u+=r*r,c+=a*a,f+=r*a,o++);return o*u-s*s==0||o*c-l*l==0?x:(o*f-s*l)/w((o*u-s*s)*(o*c-l*l))}),2,2,Vt,-1,-1),X("RSQ",(function(t,e){var o,n,r,a,s,l=0,u=0,c=0,f=0,h=0,p=0,d=i(e);if(d!==i(t))return I;for(o=0;o<d;o++)n=e[o],r=t[o],W(n)&&W(r)&&(l+=n,u+=r,c+=n*n,f+=r*r,h+=n*r,p++);return 0===(a=w((p*c-l*l)*(p*f-u*u)))?x:k((s=(p*h-l*u)/a)*s)}),2,2,Vt,[0,1],[0,1]),X("POISSON",ho,3,3,Ht),X("POISSON.DIST",ho,3,3,Ht),X("PROB",(function(t,e,o,n){var r,a,u,c,f,h,p=o;if(n!==s&&(p=D(n),l(p)))return A;if(r=0,a=0,(u=i(t))!==i(e))return I;for(c=0;c<u;c++)if(f=t[c],h=e[c],f!==J&&h!==J){if(h<=0||1<h)return R;o<=f&&f<=p&&(r+=h),a+=h}return 1!==a?R:r}),3,4,[bt,dt,nt],[0,1],[0,1],{bk:3}),X("SKEW",(function(){var t,e,o,n,r,a,s=arguments,l=0,u=0,c=0,h=0,p=[];for(o=0;o<i(s);o++)for(a=s[o],p.push(a),n=0;n<i(a);n++)(r=a[n])!==J&&(l+=r,u+=r*r,h++);if(h<=2)return x;if(t=l/h,0===(e=w((h*u-l*l)/(h*(h-1)))))return x;for(o=0;o<i(p);o++)for(a=p[o],n=0;n<i(a);n++)(r=a[n])!==J&&(c+=f((r-t)/e,3));return k(h*c/((h-1)*(h-2)))}),1,s,gt,-1,-1),X("STANDARDIZE",(function(t,e,o){return(t-e)/o}),3,3,[nt,nt,at]),X("TDIST",po,3,3,[ct,tt,$]),X("T.DIST",(function(t,e,o){return Se(t,e,o?4:3)}),3,3,[ct,tt,K]),X("T.DIST.RT",(function(t,e){return po(t,e,1)}),2,2,zt),X("T.DIST.2T",(function(t,e){return po(t,e,2)}),2,2,zt),X("TINV",go,2,2,Ot),X("T.INV.2T",go,2,2,Ot),X("T.INV",(function(t,e){return t<.5?-xe(1-t,e,4):xe(t,e,4)}),2,2,[{Hi:0,aj:["<= 0","> 1"]},ot]),X("TTEST",mo,4,4,Ut,[0,1],[0,1]),X("T.TEST",mo,4,4,Ut,[0,1],[0,1]),X("WEIBULL",yo,4,4,Wt),X("WEIBULL.DIST",yo,4,4,Wt),X("ZTEST",Co,2,3,qt,0,0,{bk:2}),X("Z.TEST",Co,2,3,qt,0,0,{bk:2}),X("PERMUT",(function(t,e){t=D(O(t)),e=D(O(e));var o,n=1;if(t<0||e<0||t<e)return R;for(o=t-e+1;o<=t;o++)n*=o;return k(n)}),2,2),X("COVARIANCE.S",(function(t,e){return ke(!1,t,e)}),2,2,Dt,-1,-1),X("MODE.MULT",(function(){var t,e,o,n=0,a=[],s=function(t){var e,o=[];for(e=0;e<i(t);e++)pe(t[e],o);return o}(arguments),l=i(s);for(t=0;t<l;t++){for(e=0,o=t+1;o<l;o++)s[t]===s[o]&&e++;e>n?(n=e,(a=[]).push([s[t]])):e===n&&a.push([s[t]])}return 0===n?I:new r.CalcArray(a)}),1,s,mt,-1,-1),X("PERCENTILE.EXC",(function(t,e){return V([t,e],18)}),2,2,[pt,it],0,0),X("QUARTILE.EXC",(function(t,e){return V([t,e],19)}),2,2,[wt,$],0,0),X("RANK.AVG",(function(t,e,o){return t.rowCount>1||t.colCount>1?A:Ie(!1,e,t[0],o)}),2,3,[bt,vt,st],[0,1],1,{bk:2}),X("PERMUTATIONA",(function(t,e){var o,n=e;return t>=0&&t<2147483647&&n>=0&&n<2147483647&&(t=Math.pow(c(t),c(n)),(o=Math.abs(t))<=179769e303)?o>=22250738585072014e-324?t:0:R}),2,2,[nt,nt]),X("PHI",(function(t){var e,o;return""===t?A:!0===Z(t,e={value:0})?(t=.3989422804014327*Math.exp(-e.value*e.value*.5),(o=Math.abs(t))<=179769e303?o>=22250738585072014e-324?t:0:R):A}),1,1),X("BINOM.DIST.RANGE",(function(t,e,o,n){var r,i,a,s,l,u,c,f,h=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142,942594775983836e145,9614466715035127e146,990290071648618e149,10299016745145628e150,1081396758240291e153,1.1462805637347084e170,1226520203196138e157,1324641819451829e159,14438595832024937e160,1588245541522743e163,1.7629525510902446e180,1974506857221074e167,22311927486598138e168,25435597334721877e170,2925093693493016e173,3.393108684451898e190,3969937160808721e177,4684525849754291e179,5574585761207606e181,6689502913449127e183,8.094298525273444e200,9875044200833601e187,1214630436702533e190,1506141741511141e192,1882677176888926e194,2372173242880047e196,30126600184576594e197,3856204823625804e200,4974504222477287e202,6466855489220474e204,847158069087882e207,11182486511960043e208,14872707060906857e210,19929427461615188e212,2.6904727073180504e230,3659042881952549e217,5012888748274992e219,6917786472619489e221,9615723196941089e223,13462012475717526e225,1898143759076171e228,2695364137888163e230,3854370717180073e232,55502938327393044e233,8047926057471992e236,11749972043909107e238,1727245890454639e241,25563239178728654e242,3.80892263763057e260,5713383956445855e247,862720977423324e250,13113358856834524e251,20063439050956823e253,30897696138473508e255,4789142901463394e258,7471062926282894e260,11729568794264145e262,1.853271869493735e280,29467022724950384e266,47147236359920616e268,7590705053947219e271,12296942187394494e273,20044015765453026e275,3287218585534296e278,5423910666131589e280,9003691705778438e282,1.503616514864999e300,25260757449731984e286,4269068009004705e289,7257415615307999e291];function p(t){return t<171?t<0?NaN:h[t]:1/0}if(t=Y(t,r={value:0}),e=Z(e,i={value:0}),o=Y(o,a={value:0}),4===arguments.length&&n?n=Y(n,s={value:0}):(n=o,s=a),!0===t&&!0===e&&!0===o&&!0===n){if(t=r.value,e=i.value,o=a.value,n=s.value,t>=0&&t<=2147483646&&e>=0&&e<=1&&o>=0&&o<=t&&n>=o&&n<=t){if((l=t*e*(1-e))>100)return Yt((n-(e*=t)+.5)/(l=Math.sqrt(l)))-Yt((o-1-e+.5)/l);if(u=function(t,e){var o,n,r,i;if(t<=e)return t===e&&e>=0?1:A;if(t<2*e&&(e=t-e),e<2)return e>=0?0!==e?t:1:A;if(t<171)return p(t)/(p(e)*p(t-e));if(e>514)return A;if(t>8192){for(o=t,n=2;n<=e;n++)o*=--t/n;return o}for(r=t,t--,i=2;;)switch(e-i){case-1:return r;case 0:return t/i*r;case 1:return t*(t-1)/(i*(i+1))*r;case 2:return t*(t-1)*(t-2)/(i*(i+1)*(i+2))*r;default:r*=t*(t-1)*(t-2)*(t-3)/(i*(i+1)*(i+2)*(i+3)),i+=4,t-=4}}(t,o)*Math.pow(e,o)*Math.pow(1-e,t-o),0===u)return 0;for(c=u,l=u,e/=1-e,f=o;f<n;f++)c+=l*=(t-f)/(f+1)*e;return c<=1?c:1}return R}return A}),3,4,[{_i:0},{_i:0},{_i:0}]),X("GAMMA",(function(t){var e,o,n;if(t>0)t=Math.exp(re(t));else{if(0===(o=t+(e=Math.abs(c(t)))))return R;t=Math.pow(-1,e-1)*Math.exp(re(-o))*Math.exp(re(1+o))/Math.exp(re(e+1-o))}return(n=Math.abs(t))<=179769e303?n>=22250738585072014e-324?t:0:R}),1,1,at),X("GAUSS",(function(t){t=Yt(t)-.5;var e=Math.abs(t);return e<=179769e303?e>=22250738585072014e-324?t:0:R}),1,1,nt),X("SKEW.P",(function(){var t,e,o,n,r,a,s,l,u,c,h=arguments,p=0,d=0,g=[];for(o=0;o<i(h);o++){if(a=h[o],1===i(h)&&0===i(a))return M;for(n=0;n<i(a);n++)s={value:0},(r=a[n])!==J&&"boolean"!=typeof r&&Z(r,s)&&(p+=s.value,d++,g.push(s.value))}if(d<=2)return x;for(t=p/d,l=0,u=0,c=0,o=0;o<g.length;o++)c=g[o]-t,u+=f(c,2),l+=f(c,3);return 0===(e=w(u/d))?x:k(l/d/e/e/e)}),1,s,Tt,-1,-1)},CalcEngine:function(t,e){t.exports=o("@grapecity/js-calc")},Common:function(t,e){t.exports=o("Common")}}),t.exports=n.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(t,e,o){var n="object"==typeof n?n:{};n.Spread=n.Spread||{},n.Spread.CalcEngine=n.Spread.CalcEngine||{},n.Spread.CalcEngine.BasicFunctions=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){var n,r;if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(n=Object.create(null),o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/assets/",o(o.s="./src/basicFunctions.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},"./src/basicFunctions.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("CalcEngine");e.Functions=n.Functions,o("./src/functions-basic.ts")},"./src/functions-basic.ts":function(t,e,o){"use strict";(function(t){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt,wt,Tt,St,xt,At,It,Rt,Mt,kt,Nt,Ot,Dt,Ft,Et,jt,Pt;function Lt(t,e){for(;0!==e;){var o=t%e;t=e,e=o}return t}function Gt(t,e,o,n){return 0===e||0===t?0:0!==o&&t<0?!0===n?ut(t/Math.abs(e))*Math.abs(e):lt(t/Math.abs(e))*Math.abs(e):!0===n?lt(t/Math.abs(e))*Math.abs(e):ut(t/Math.abs(e))*Math.abs(e)}function Bt(t,e,o){var n,r,i,a,s,l,u=t[0],c=J(t[1],1,!0,!1,!1),h=f(c),p=c.rowCount,d=c.colCount,g=[],m=[],y=[],C=u.row,v=u.column,b=u.source.getCalcSourceModel().qg(C,v);function w(t){var e=t.getSource();return function(o){return{id:e.id,source:e,row:t.getRow(0)+o%p,col:t.getColumn(0)+x(o/p),rowCount:1,colCount:1}}}for(a=2;a<f(t);a+=2){if((l=J(t[a],0,!0,!1,!1)).rowCount!==p||l.colCount!==d)return D;s=st.xk(t[a+1]),g.push(l),m.push(s),a>=4&&b&&_(t[a])&&(l.getRef=w(t[a]))}for(b&&_(t[1])&&!o&&(c.getRef=w(t[1])),i=0;i<h;i++){for(r=!0,a=0;a<f(g)&&(s=m[a],n=g[a][i],r=s&&s(n),g[a].getRef&&Zt(b,g[a].getRef(i)),r);a++);r&&(c.getRef&&Zt(b,c.getRef(i)),n=c[i],(o||n!==G)&&y.push(n))}return e(y)}function _t(t,e){return e=e<0?x(e):Math.ceil(e),(t&&e%2==0||!t&&e%2!=0)&&(e+=e<0?-1:1),e}function Vt(t,e,o){return e>0&&o<0?L:e<0&&o>0?(o=-o,t?ut(e/o)*o:lt(e/o)*o):t?lt(e/o)*o:ut(e/o)*o}function Ht(t,e,o){var n,r,i,a=st.yk(b(o));return n=lt(e=o<0?e/a:e*a),r=ut(e),t&&(i=n,n=r,r=i),e=e<0?n:r,X(e=o<0?e*a:e/a)}function zt(t,e,o,n){var r,i,a,s=e?-1:1,l=0;if(f(o)!==f(n))return P;for(a=0;a<f(o);a++)r=o[a],i=n[a],r!==G&&i!==G&&(l+=t?(r-i)*(r-i):r*r+s*i*i);return X(l)}function Ut(){var t,e,o,n,r=arguments,i=0;for(t=0;t<f(r);t++){if(o=void 0,n=void 0,B(e=r[t]))return e;if(_(e)||V(e)){if((o=J(e,1,!0,!0,!1)).isError)return o[0]}else o=J(e,1,!0,!0,!0);for(n=0;n<f(o);n++)o[n]!==G&&(i+=o[n])}return i}function Wt(t,e,o){var n=D;return p(t,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?n=rt(o,e,t):p(t,[7,107,8,108,10,110,11,111])>=0&&(n=at(o,e,t)),n}function qt(t,e){return st.Ak(t,e)}function Jt(t,e){return Ht(!1,t,e)}function Xt(t,e){return lt(t/b(e))*b(e)}function Zt(t,e){var o,n=e.source;n.getRangeKey&&(o=n.getRangeKey(n,e),t.eOb||(t.eOb={}),t.eOb[o]=e)}function Yt(t){return X(Math.sin(t))}function Kt(t){return X(Math.cos(t))}function Qt(t){return X(st.Dk(t,!0))}function $t(t){return X(st.Dk(t,!1))}function te(t){var e=A(t),o=A(-t);return X(e-o)/(e+o)}function ee(t){return X(I((1+t)/(1-t))/2)}function oe(t,e){var o,n,i,a,s=!0;for(o=0;o<f(e);o++)for(i=e[o],n=0;n<f(i);n++){if(r.ExcelCompatibleCalcMode){if("string"==typeof i[n]||d(i[n]))continue;s=!1}if(a={value:g},i[n]=ft(i[n],a)?a.value:G,t){if(!i[n])return!1}else if(i[n]&&i[n]!==G)return!0}return r.ExcelCompatibleCalcMode&&s?D:!!t}function ne(t){var e,o=t.getFullYear(),n=t.getMonth(),r=t.getDate();for(e=0;e<n;e++)r+=ot(o,e);return r}function re(t){if(K(t)){if(7!==f(t)||y(v(t)))return D}else if(!y(t)){if(x(t)<1||x(t)>17)return L;t=""+t}var e,o=["1","2","3","4","5","6","7"],n=[0,0,0,0,0,0,0];switch(f(t)){case 1:if(p(t,o)>=0){n[((e=v(t))+4)%7]=1,n[(e+5)%7]=1;break}return L;case 2:if("1"===t[0]&&p(t[1],o)>=0){n[((e=v(t[1]))+5)%7]=1;break}return L;case 7:for(e=0;e<7;e++)n[e]=v(t[e]);break;default:return D}return n}function ie(t,e,o,n,r){var i,a=ce(e,3);if(B(a))return a;for(i=z(a);o<0;++o)e.setDate(e.getDate()-1),i=0===i?6:--i,(t&&(5===i||6===i)||!t&&r[i]||n.indexOf(l(e))>=0)&&o--;for(;o>0;--o)e.setDate(e.getDate()+1),i=6===i?0:++i,(t&&(5===i||6===i)||!t&&r[i]||n.indexOf(l(e))>=0)&&o++;return l(e)}function ae(t,e,o,n,r,i){var a,s,l,c,h,p,d,g,y;if(i&&(s=re(t=t!==m?t:"0000011"),B(s)))return s;if(e!==m&&(a=J(e,4,!0,!0,!1)),!a)return r;if(a.isError)return a[0];for(l=f(a),c=[],h=0;h<l;h++)p=a[h],g=(d=u(p)).getDay(),y=f(s)?s[ce(d,3)]:6===g||0===g,-1===c.indexOf(p)&&!y&&p>=o&&p<=n&&c.push(p);return r-f(c)}function se(t,e,o,n,r,i){var a,s,u,c=z(l(e)),f=z(l(o)),h=!1;return c>f&&(a=e,e=o,o=a,s=c,c=f,f=s,h=!0),u=i(e,o,u=f-c+1,n),t&&B(u)?u:u<=0?0:(u=ae(n,r,c,f,u,t),u=h?-u:u)}function le(t,e,o){var n,i;return e=r.Convert.Wh(e),(n=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(n.getMonth()+o),i=ot(n.getFullYear(),n.getMonth()),n.setDate(t?i:S(e.getDate(),i)),n}function ue(t){var e;return K(t)&&(e=c(t)),e?(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())/86400:D}function ce(t,e){var o=t.getDay();switch(e){case 1:return o+1;case 2:return 0===o?7:o;case 3:return 0===o?6:o-1;default:return L}}function fe(t,e,o,n){var r,i,a,s,l,u,c;if(r=re(n=n!==m?n:"0000011"),i=0,a=0,B(r))return r;for(s=0;s<f(r);s++)1===r[s]&&i++;if(o<30){for(s=0;s<o;s++)r[(z(ce(t,3))+s)%7]&&a++;return o-a}for(l=o,u=0,c=0,s=0;s<l&&z(ce(t,3)+s)%7!=0;s++)u++;for(s=0;s<u;s++)r[(z(ce(t,3))+s)%7]&&a++;for(s=0;s<l&&(z(ce(e,3))+7-s)%7!=6;s++)c++;for(s=0;s<c;s++)r[(z(ce(e,3))+7-s)%7]&&a++;return(o-=z((l=l-u-c)/7)*i)-a}function he(t){var e,o,n;if(isNaN(t))return L;function r(t){var e=new Date(t,0,4),o=e.getDay();return 0===o&&(o=7),e.setDate(e.getDate()+1-o),e}return e=new Date(1900,1,28),t.getTime()<=e.getTime()&&t.setDate(t.getDate()-1),1900===(o=t.getFullYear())?o+=400:9999===o&&(o-=400),t.setYear(o),t.getTime()<new Date(o,11,29).getTime()&&o--,n=r(o+1),t.getTime()<n.getTime()&&(n=r(o)),v(""+(t.getTime()-n.getTime())/864e5/7)+1}function pe(t){var e,o,n,r=""+t,i="",a=[];if(t<0&&(r=r.substr(1),i="-"),o=r.split("."),(n=f(o))<1||n>2)return D;for(2===n&&(a.push(o[1]),a.push(".")),r=o[0],e=f(r)-3;e>=0;e-=3)a.push(r.substr(e,3)),e>0&&a.push(",");return a.push(r.substring(0,e+3)),a.reverse(),i+a.join("")}function de(t,e){var o,n,r,i,a=[],s=f(t);for(o=0;o<s;o++){if(r=t[o],0===(i=f(r))&&"concat"===e)return N;for(n=0;n<i;n++)d(r[n])||a.push(W(r[n]))}return a.join("")}function ge(t,e,o){var n,r=[],i=0;for(n=0;n<e.length;n++)if("fourByte"===$(e[n])){if(0===i){i++;continue}i=0,r.push(e[n-1]+e[n])}else r.push(e[n]);return o>=r.length?e:r.splice(t?0:r.length-o,o).join("")}function me(t,e,o,n){var r,i,a=f(t);return e=S(e,a+1),o=S(o||0,a-e+1),r=t.substring(0,e-1),i=t.substr(e-1+o),r.concat(n).concat(i)}function ye(t,e,o){var n,r=f(e);if(0===r)return N;for(n=0;n<r;n++)d(e[n])||""===e[n]?o||t.push(""):t.push(W(e[n]))}function Ce(t,e,o){var n,i,a,s,l,u,c,f;if(be()||r.usedbcs){for(n=[],i=void 0,a=0,s=void 0,l=0,s=0;s<e.length;s++)if(i=e[s],"fourByte"===(u=$(e[s]))){if(a%2==0){a++;continue}a++,i=e[s-1]+e[s],n[n.length]=i}else"doubleByte"===u&&(l++,i=e[s]),n[s-(a>0?a/2:0)+l]=i;return t||(n=et(n)),o>=(c=n.length)?e:(f=void 0,t?(f=n.slice(0,o-1<0?0:o)).length>0&&d(f[f.length-1])&&(f[f.length-1]="​"):(f=n.slice(c-o)).length>0&&d(f[0])&&(f[0]="​"),f.join(""))}return ge(t,e,o)}function ve(t,e,o){e--;var n=f(t);return e>=n?"":n<e+o?t.substr(e):t.substr(e,o)}function be(){return!!n.Common.CultureManager.q4().isJCKCulture}function we(t,e,o){if(o<1||f(e)<o)return D;var n=e.indexOf(t,o-1);return-1===n?D:n+1}function Te(t,e,o){var n,r,a=-1;return(n=i.ub(t))?(r=i.sb(n).exec(e),a=d(r)?-1:r.index):a=e.toLowerCase().indexOf(t.toLowerCase(),--o),-1===a?D:a+1}function Se(t){for(var e=0;e<t.length;e++)d(t[e])&&t[e-1]&&2!==t[e-1].length&&(t[e]="​");return t.join("")}function xe(t,e){return e}function Ae(t){return t>=55296&&t<=57343}function Ie(t,e){return!(t<55296||t>56319)&&e>=56320&&e<=57343}function Re(t,e){return B(t)?P:V(t)?J(t,e,!0,!0,!1):J(t,e,!0,!0,!0)}function Me(t,e){var o,n,r,i=e;if(!i||i.length>dt)return D;if(o=null,XMLHttpRequest&&(o=new XMLHttpRequest),n=function(e){t.setAsyncResult(e)},r=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===o)return D;try{o.open("GET",i,!0),o.onreadystatechange=function(){var t,e,i;4===o.readyState&&(200===o.status?!(e=(t=o.response)&&t.type)||-1===e.indexOf("text")&&-1===r.indexOf(e)?n(D):((i=new FileReader).onloadend=function(){n(i.result)},i.onerror=function(){n(D)},i.readAsText(t)):n(D))},o.onerror=function(){n(D)},o.timeout=gt,o.ontimeout=function(){n(D)},o.responseType="blob",o.send(null)}catch(t){return D}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("CalcEngine"),i=n.Common.q,a=n.Common.u,s=n.Common.l,l=s.Ra,u=s.Xb,c=s.Qa,f=n.Common.k.ac,h=n.Common.j,p=h.Ea,d=h.Fa,g=null,m=void 0,y=isNaN,C=parseFloat,v=parseInt,Math.round,b=Math.abs,w=Math.sqrt,T=Math.max,S=Math.min,x=Math.floor,A=Math.exp,I=Math.log,R=Math.PI,M=Math.random,k=Math.pow,N=r.Errors.Null,O=r.Errors.DivideByZero,D=r.Errors.Value,F=r.Errors.Reference,E=r.Errors.Name,j=r.Errors.Calc,P=r.Errors.NotAvailable,L=r.Errors.Number,G=r.Convert.CalcConvertedError,B=r.Convert.vf,_=r.Convert.Fh,V=r.Convert.Ca,H=r.Convert.Uh,z=r.Convert.Rh,U=r.Convert.Pa,W=r.Convert.bc,q=r.Convert.Na,J=r.Convert.Ph,X=r.Convert.Nh,Z=r.Zh.tryExtractToSingleValue,Y=r.Functions.ik,K=r.Functions.jk,Q=r.Functions.kk,$=r.Functions.UAb,tt=r.Functions.VAb,et=r.Functions.WAb,ot=r.Functions.nk,nt=r.Functions.tk,rt=r.Functions.Hfc,it=r.Functions.mja,at=r.Functions.sk,st=r.Functions.MathHelper,lt=st.zk,ut=st.wk,ct=r.Functions.ak,ft=r.Convert.Th,ht=r.Convert.Uh,pt=r.Convert.jja,dt=2048,gt=1e4,mt=new Date(1900,0,1),yt=new Date(9999,11,31),vt={Hi:0,aj:"= 0",bj:O},bt={Hi:0,aj:"= 0",bj:0},wt={_i:1,Hi:0,aj:"= 0",bj:0},Tt={Hi:2,aj:"< 0"},St={Hi:0,aj:["> 134217728","< -134217728"]},xt={Hi:1},At={Hi:2},It={_i:1,Hi:2},Rt={_i:1,Hi:2,aj:"< 0",bj:D},Mt={Hi:5},kt={Hi:6},Nt={Hi:2,aj:"< 0",bj:D},Ot={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},Dt={Hi:4,Ii:1,Ki:!0,Li:!0},Ft={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},Et={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},jt={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},Pt=[0,"%= 1 && >= 3"],ct("ABS",(function(t){return X(b(t))}),1,1,Ct={Hi:0}),ct("ACOS",(function(t){return X(Math.acos(t))}),1,1,{Hi:0,aj:["> 1","< -1"]}),ct("ACOT",(function(t){return X(t<0?Math.PI+Math.atan(1/t):Math.atan(1/t))}),1,1,Ct),ct("ASIN",(function(t){return X(Math.asin(t))}),1,1,{Hi:0,aj:["> 1","< -1"]}),ct("ATAN",(function(t){return X(Math.atan(t))}),1,1,Ct),ct("ATAN2",(function(t,e){return 0===t&&0===e?O:X(Math.atan2(e,t))}),2,2,[Ct,Ct]),ct("COS",Kt,1,1,Ct),ct("SEC",(function(t){var e=Kt(t);return 0===e?O:1/e}),1,1,St),ct("CEILING",(function(t,e){return Vt(!0,t,e)}),2,2,[bt,bt]),ct("ODD",(function(t){return _t(!0,t)}),1,1,xt),ct("EVEN",(function(t){return _t(!1,t)}),1,1,xt),ct("FLOOR",(function(t,e){return Vt(!1,t,e)}),2,2,[bt,bt]),ct("LN",(function(t){return X(I(t))}),1,1,{Hi:1,aj:"<= 0"}),ct("SQRT",(function(t){return w(t)}),1,1,{Hi:0,aj:"< 0"}),ct("SIN",Yt,1,1,Ct),ct("CSC",(function(t){var e=Yt(t);return 0===e?O:1/e}),1,1,St),ct("TAN",(function(t){return X(Math.tan(t))}),1,1,Ct),ct("COT",(function(t){return 0===t?O:X(1/Math.tan(t))}),1,1,St),ct("SIGN",(function(t){return 0===t?0:-1}),1,1,{Hi:1,aj:"> 0",bj:1}),ct("GCD",(function(){var t,e,o,n,r=arguments,i=0;for(t=0;t<f(r);t++)for(o=r[t],e=0;e<f(o);e++)if((n=o[e])!==G){if(n<0)return L;i=Lt(i,z(n))}return i}),1,m,Ft,-1,-1),ct("LCM",(function(){var t,e,o,n,r=arguments,i=1,a=[];for(t=0;t<f(r);t++){for(o=r[t],e=0;e<f(o);e++)if((n=o[e])!==G){if(n<0)return L;if(0===n)return 0;a.push(z(n))}for(e=0;e<f(a);e++)i/=Lt(i,n=a[e]),i*=n}return i}),1,m,Ft,-1,-1),ct("PRODUCT",(function(){return rt(arguments,2,6)}),1,m,m,-1,-1),ct("POWER",(function(t,e){if(0===t&&e<0)return O;if(0===t&&0===e)return L;var o=r.Functions.MathHelper.YDc(t,e);return o===Number.POSITIVE_INFINITY||o===Number.NEGATIVE_INFINITY||isNaN(o)?L:o}),2,2,[Ct,Ct]),ct("MOD",(function(t,e){return t-e*x(t/e)}),2,2,[Ct,{Hi:0,aj:"= 0",bj:O}]),ct("QUOTIENT",(function(t,e){return v(""+t/e)}),2,2,[Ct,vt],m,m),ct("SUBTOTAL",(function(t){var e,o=arguments,n=[];for(e=1;e<f(o);e++)n[e-1]=o[e];return Wt(t,0,n)}),2,m,At,"!= 0"),ct("_SUBTOTALFORSTATUSBAR",(function(t){var e,o=arguments,n=[];for(e=1;e<f(o);e++)n[e-1]=o[e];return Wt(t,1,n)}),2,5e3,At,"!= 0"),ct("INT",(function(t,e){var o,n,r,i;if(_(e))if(o=e.getRow(0),n=e.getColumn(0),r=e.getRowCount(0),i=e.getColumnCount(0),1===r&&1===i)e=e.getValue(0,0,0);else if(1!==r&&1===i&&o<=t.row&&t.row<o+r)e=e.getValue(0,t.row-o,0);else{if(!(1===r&&1!==i&&n<=t.column&&t.column<n+i))return D;e=e.getValue(0,0,t.column-n)}return e=U(e),isNaN(e)?D:ut(e)}),1,1,m,[0],m,{dk:!0}),ct("MROUND",(function(t,e){return t<0&&e>0||e<0&&t>0?L:ut(t/e+.5)*e}),2,2,[bt,bt]),ct("ROUND",qt,2,2,[Ct,At]),ct("ROUNDDOWN",Jt,2,2,[Ct,At]),ct("ROUNDUP",(function(t,e){return Ht(!0,t,e)}),2,2,[Ct,At]),ct("TRUNC",Jt,1,2,[Ct,{_i:0,Hi:2}],m,m,{bk:1}),ct("EXP",(function(t){return X(A(t))}),1,1,Ct),ct("LOG",(function(t,e){return 1===e?O:X(st.Ek(t,e))}),1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],m,m,{bk:1}),ct("LOG10",(function(t){return X(st.Ek(t,10))}),1,1,{Hi:0,aj:"<= 0"}),ct("SUM",(function(){var t,e,o,n,i,a;if(!r.ExcelCompatibleCalcMode)return Ut.apply(null,arguments);for(t=arguments,e=0,o=0;o<f(t);o++){if(i=void 0,a=void 0,B(n=t[o]))return n;if(_(n)||V(n)){if((i=J(n,5,!0,!0,!1,!0)).isError)return i[0]}else i=J(n,1,!0,!0,!1,!0);for(a=0;a<f(i);a++)i[a]!==G&&(e+=i[a])}return e}),1,m,m,-1,-1),ct("SUMIF",(function(t,e,o,n){var r,i,a,s,l,u,c,h,p,g,y,C,v,b,w,T,S,x,A,I,R=n!==m&&_(n);if(n=n!==m?n:e,d(o)&&(o=0),r=0,i=st.xk(o),a=V(e),s=V(n),(a?1:e.getRangeCount())!==(s?1:n.getRangeCount()))return D;if(l=n,n===e||s||(u=a?e.getRowCount():e.getRowCount(0),c=a?e.getColumnCount():e.getColumnCount(0),u===n.getRowCount(0)&&c===n.getColumnCount(0)||(h=n.getRow(0),p=n.getColumn(0),l=n.create([{row:h,col:p,rowCount:u,colCount:c}]))),g=e.toArray(0,!1,!1),y=l.toArray(1,!1,!1),g.isError)return g[0];if(y.isError)return y[0];for(R&&(C=t.row,v=t.column,b=l.getRow(0),w=l.getColumn(0),T=t.source.getCalcSourceModel().qg(C,v),S=n.getSource(),R=T&&S.getRangeKey),x=0;x<f(g);x++)for(A=0;A<f(g[x]);A++)i&&i(g[x][A])&&((I=y[x]&&y[x][A])&&I!==G&&(r+=I),R&&Zt(T,{id:S.id,source:S,row:b+x,col:w+A,rowCount:1,colCount:1}));return X(r)}),2,3,m,[0,2],m,{bk:2,KMc:[2],fk:4,gk:1,dk:!0}),ct("SUMIFS",(function(){return Bt(arguments,(function(t){var e,o,n=0;for(e=0;e<t.length;e++){if(o=t[e],B(o))return o;n+=o}return n}))}),3,m,m,[0,"%= 1"],m,{KMc:Pt,fk:4,dk:!0}),ct("SUMPRODUCT",(function(){var t,e,o,n,r,i,a,s=arguments,l=0,u=[],c=0;for(t=0;t<f(s);t++){if((n=J(s[t],1,!0,!0,!1,!0)).isError)return n[0];if(n.isConvertError)return D;if(0===t)e=n.rowCount,o=n.colCount,c=f(n);else if(n.rowCount!==e||n.colCount!==o)return D;u.push(n)}for(t=0;t<c;t++){for(r=1,i=0;i<f(s);i++){if((a=u[i][t])===G){if(1===c)return D;r=0;break}r*=a}l+=r}return X(l)}),1,m,m,-1,-1,{fk:1}),ct("SUMSQ",(function(){var t,e,o,n,r=arguments,i=0;for(e=0;e<f(r);e++)for(n=r[e],o=0;o<f(n);o++)(t=n[o])!==G&&(i+=t*t);return X(i)}),1,m,Ft,-1,-1),ct("SUMX2MY2",(function(t,e){return zt(!1,!0,t,e)}),2,2,Ft,-1,-1),ct("SUMX2PY2",(function(t,e){return zt(!1,!1,t,e)}),2,2,Ft,-1,-1),ct("SUMXMY2",(function(t,e){return zt(!0,!1,t,e)}),2,2,Ft,-1,-1),ct("SERIESSUM",(function(t,e,o,n){var r,i,a=0;for(r=0;r<f(n);r++){if(i=U(n[r]),y(i))return D;a+=i*k(t,e+r*o)}return X(a)}),4,4,[Ct,At,At,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),ct("PI",(function(){return R}),0,0),ct("SQRTPI",(function(t){return X(w(t*R))}),1,1,{Hi:0,aj:"< 0"}),ct("DEGREES",(function(t){return 180*t/R}),1,1,xt),ct("RADIANS",(function(t){return R*t/180}),1,1,Ct),ct("COSH",$t,1,1,Ct),ct("SECH",(function(t){if(t>709||t<-709)return 0;var e=$t(t);return 0===e?O:1/e}),1,1,Ct),ct("ACOSH",(function(t){return X(I(t+w(t*t-1)))}),1,1,{Hi:0,aj:"< 1"}),ct("SINH",Qt,1,1,Ct),ct("CSCH",(function(t){if(t>709||t<-709)return 0;var e=Qt(t);return 0===e?O:1/e}),1,1,Ct),ct("ASINH",(function(t){return X(I(t+w(t*t+1)))}),1,1,Ct),ct("TANH",te,1,1,Ct),ct("COTH",(function(t){return 0===t?O:t>10?1:t<-10?-1:1/te(t)}),1,1,{Hi:0}),ct("ATANH",ee,1,1,{Hi:0,aj:["<= -1",">= 1"]}),ct("ACOTH",(function(t){return ee(1/t)}),1,1,{Hi:0}),ct("MDETERM",(function(t){var e,o,n,r,i,a,s,l,u=t.rowCount,c=1;if(t.rangeCount>1||u!==t.colCount)return D;for(e=0;e<u-1;e++){if(0===t[e][e]){for(a=!1,o=e+1;!a&&o<u;o++)if(0!==t[o][e]){for(r=e;r<u;r++)s=t[e][r],t[e][r]=t[o][r],t[o][r]=s;c*=-1,a=!0}if(!a)return 0}for(n=e+1;n<u;n++)if(0!==t[n][e])for(l=t[n][e]/t[e][e],i=e;i<u;i++)t[n][i]-=l*t[e][i]}for(e=0;e<u;e++)c*=t[e][e];return c}),1,1,Dt,-1,-1),ct("MINVERSE",(function(t){var e,o,n,i,a,s,l,u,c,f,h,p,d,g,m,y,C=t.rowCount,v=[];if(t.rangeCount>1||C!==t.colCount)return D;for(e=0;e<C;e++)for(v[e]=[C],i=0;i<C;i++)v[e][i]=e===i?1:0;for(o=0;o<C;o++){if(0===t[o][o]){for(y=!1,a=o+1;!y&&a<C;a++)if(0!==t[a][o]){for(l=o;l<C;l++)g=t[o][l],t[o][l]=t[a][l],t[a][l]=g;for(u=1;u<C;u++)m=v[o][u],v[o][u]=v[a][u],v[a][u]=m;y=!0}if(!y)return L}for(s=0;s<C;s++)if(s!==o&&0!==t[s][o]){for(p=t[s][o]/t[o][o],c=o;c<C;c++)t[s][c]-=p*t[o][c];for(f=0;f<C;f++)v[s][f]-=p*v[o][f]}}for(n=0;n<C;n++)for(d=t[n][n],h=0;h<C;h++)v[n][h]/=d;return new r.CalcArray(v)}),1,1,Dt,-1,-1),ct("MMULT",(function(t,e){var o,n,i,a,s,l,u=t.rowCount,c=t.colCount,f=e.rowCount,h=e.colCount,p=[];if(c!==f)return D;for(i=0;i<u;i++)for(p[i]=o=[],n=t[i],a=0;a<h;a++){for(l=0,s=0;s<f;s++)l+=n[s]*e[s][a];o[a]=l}return new r.CalcArray(p)}),2,2,[Dt,Dt],-1,-1),ct("FACT",(function(t){return nt(t)}),1,1,{Hi:3,aj:["< 0","> 170"]}),ct("FACTDOUBLE",(function(t){var e,o=1;for(e=t;e>1;e-=2)o*=e;return o}),1,1,{Hi:3,aj:["< 0","> 300"]}),ct("MULTINOMIAL",(function(){var t,e,o,n,r=arguments,i=0,a=1;for(e=0;e<f(r);e++)for(t=r[e],o=0;o<f(t);o++){if((n=z(t[o]))<0||170<n)return L;i+=n,a*=nt(n)}return i<0||170<i?L:nt(i)/a}),1,m,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),ct("RAND",(function(){return b(2*M()-1)}),0,0,m,m,m,{ck:!0}),ct("RANDBETWEEN",(function(t,e){return e<t?L:z(t+M()*(e-t+1))}),2,2,[At,At],m,m,{ck:!0}),ct("COMBIN",(function(t,e){var o,n=1;if(t<e)return L;for(e=S(t-e,e),o=1;o<=e;o++)n*=t-o+1,n/=o;return X(n)}),2,2,[Tt,Tt]),ct("COMBINA",(function(t,e){var o,n=1;for(o=1;o<=e;o++)n*=t+o-1;for(o=2;o<=e;o++)n/=o;return X(n)}),2,2,[Tt,Tt]),ct("DECIMAL",(function(t,e){var o,n,r,i,a,s,l;if(!t||t.length>255)return 0;if(0===(o=t.length))return 0;if("-"===t[0])return L;for(n=0;n<o&&" "===t[n];)n++;if(r=0,n===o)return 0;for(i=1,a=o-1;a>=n;a--){if((l=(s=t.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)>=0?s-87:s-48)<0||l>=e)return L;r+=l*i,i*=e}return r}),2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),ct("CEILING.MATH",(function(t,e,o){return Gt(t,e,o,!0)}),1,3,[Ct,{Hi:0,_i:1},{Hi:0,_i:0}]),ct("FLOOR.MATH",(function(t,e,o){return Gt(t,e,o,!1)}),1,3,[Ct,{Hi:0,_i:1},{Hi:0,_i:0}]),ct("BASE",(function(t,e,o){var n=""+t.toString(e);return o&&n.length<o?Array.apply(null,{length:o-n.length+1}).join(0)+n:n}),2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),ct("ROMAN",(function(t,e){var o,n,r,i,a,s,l,u,c=["M","D","C","L","X","V","I"],f=[1e3,500,100,50,10,5,1],h=[];if((o=Y(e)?e?0:4:e)>4||o<0)return D;for(n=0;n<7;n+=2){if(2<=n&&f[n-2]-f[n]<=t){for(r=n,i=n-2,a=void 0,a=0;a<o&&r+1<7&&f[i]-f[r+1]<=t;a++)r++;h.push(c[r]),h.push(c[i]),t+=f[r],t-=f[i]}if(1<=n&&f[n-1]<=t&&(h.push(c[n-1]),t-=f[n-1]),1<=n&&f[n-1]-f[n]<=t){for(s=n,l=n-1,u=void 0,u=0;u<o&&s+1<7&&f[l]-f[s+1]<=t;u++)s++;h.push(c[s]),h.push(c[l]),t+=f[s],t-=f[l]}for(;f[n]<=t;)h.push(c[n]),t-=f[n]}return h.join("")}),1,2,[{Hi:2,aj:["< 0","> 3999"],bj:D},{_i:0}],m,m,{bk:1}),ct("ARABIC",(function(t){var e,o,n,r,i,a,s,l,u,c;if(!t.length)return 0;if(t.length>255)return D;for(e=0,o=(t=t.toLowerCase()).length-1,r=0,s=-1;o>=0&&" "===t[o];)o--;for(l=0;l<=o&&" "===t[l];)l++;u=!1,l<=o&&"-"===t[l]&&(u=!0,l++);do{for(c=t[n=o],--o;o>=l&&(t[o].charCodeAt(0)|" ".charCodeAt(0))===c.charCodeAt(0);)--o;switch(c){case"i":i=n-o,a=1;break;case"v":i=5*(n-o),a=5;break;case"x":i=10*(n-o),a=10;break;case"l":i=50*(n-o),a=50;break;case"c":i=100*(n-o),a=100;break;case"d":i=500*(n-o),a=500;break;case"m":i=1e3*(n-o),a=1e3;break;default:return D}a>=s?(e+=i-r,s=a,r=0):r+=i}while(o>=l);return 0!==r&&(e-=r),u&&(e=-e),e}),1,1,Mt),ct("CEILING.PRECISE",Xt,1,2,[bt,wt]),ct("ISO.CEILING",Xt,1,2,[bt,wt]),ct("FLOOR.PRECISE",(function(t,e){return ut(t/b(e))*b(e)}),1,2,[bt,wt]),ct("MAXIFS",(function(){return Bt(arguments,(function(t){var e=null;return t.length>0&&(e=Math.max.apply(null,t)),e}))}),3,m,m,[0,"%= 1"],[0,"%= 1"],{KMc:Pt,dk:!0}),ct("MINIFS",(function(){return Bt(arguments,(function(t){var e=null;return t.length>0&&(e=Math.min.apply(null,t)),e}))}),3,m,m,[0,"%= 1"],[0,"%= 1"],{KMc:Pt,dk:!0}),ct("AVERAGEIFS",(function(t){return Bt(arguments,(function(t){var e,o,n=0,r=0;for(e=0;e<t.length;e++){if(o=t[e],B(o))return o;n+=o,r++}return 0===r?O:X(n/r)}))}),3,m,m,[0,"%= 1"],[0,"%= 1"],{KMc:Pt,dk:!0}),ct("COUNTIFS",(function(){var t,e=arguments,o=f(e),n=[e[0],e[1]];for(t=1;t<o;t++)n[t+1]=e[t];return Bt(n,(function(t){return t.length}),!0)}),2,m,m,"%= 0","%= 0",{KMc:["%= 0 && >= 2"],dk:!0}),ct("MUNIT",(function(t){for(var e=[],o=0,n=[];o<t;o++)n[o]=0;for(o=0;o<t;o++)e[o]=n.slice(0),e[o][o]=1;return new r.CalcArray(e)}),1,1,{Hi:2,aj:"<= 0",bj:D}),ct("SEQUENCE",(function(t,e,o,n){var i,a,s,l,u,c,f;if(void 0===t&&(t=1),void 0===e&&(e=1),void 0===o&&(o=1),void 0===n&&(n=1),i=o,0===t||0===e)return j;if(t<0||e<0)return D;if("string"==typeof o||o instanceof Date){if(a={},!r.Convert.Th(o,a))return D;i=a.value}for(s=[],l=0,u=i;l<t;l++)for(c=[],s.push(c),f=0;f<e;f++)c.push(u),u+=n;return new r.CalcArray(s)}),1,4,[At,At,Ct,Ct],m,m,{bk:[0,1,2,3]},!0),ct("RANDARRAY",(function(t,e,o,n,i){var a,s,l,u,c,f;if(void 0===t&&(t=1),void 0===e&&(e=1),void 0===o&&(o=0),void 0===n&&(n=1),void 0===i&&(i=!1),0===t||0===e)return j;if(t<0||e<0)return D;if(o>n)return D;if(i&&(o!==x(o)||n!==x(n)))return D;for(a=n-o,i&&a++,s=[],l=0;l<t;l++)for(u=[],s.push(u),c=0;c<e;c++)f=o+M()*a,i&&(f=v(f)),u.push(f);return new r.CalcArray(s)}),0,5,[At,At,Ct,Ct],m,m,{ck:!0,bk:[0,1,2,3,4]},!0),ct("AGGREGATE",(function(t,e,o){var n,r=arguments,i=[];for(n=3;n<f(r);n++)i[n-3]=r[n];return it(i,o,e,t)}),3,m,m,"> 1","> 1",{fk:1,dk:!0}),ct("AND",(function(){return oe(!0,arguments)}),1,m,jt,-1,-1),ct("OR",(function(){return oe(!1,arguments)}),1,m,jt,-1,-1),ct("NOT",(function(t){var e;return r.ExcelCompatibleCalcMode&&"string"==typeof t?D:(e={},r.Convert.Uh(t,e)?!e.value:D)}),1,1),ct("IF",(function(t,e,o){var n,r,i=e,a=Z(t);return B(t)?t:(n=o!==m?o:2!==f(arguments)&&null,r={},H(a.value,r),r.value?i:n)}),2,3,m,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(t){if(r.Convert.vf(t))return-1;var e={value:!1};return H(t,e),e.value?1:2}}),ct("IFERROR",(function(t,e){var o,n,r,i;if(!B(t)&&_(t)){if(t.getRangeCount()>1)return D;if(o=0,n=0,r=this.y0a)if(o=r.row,n=r.col,(i=t.yf&&t.yf[0])&&1===i.rowCount&&1===i.colCount)o=0,n=0;else if(i&&(o+1>i.rowCount||n+1>i.colCount))return e;t=t.getValue(0,o,n)}return function(t,e){return B(t)?d(e)?0:e:d(t)?0:t}(t,e)}),2,2,m,m,m,{gk:-1}),ct("TRUE",(function(){return!0}),0,0),ct("FALSE",(function(){return!1}),0,0),ct("IFNA",(function(t,e){return pt(t)?e:t}),2,2,m,m,m,{gk:-1}),ct("IFS",(function(){var t,e,o;for(t=0,e=arguments.length;t<e;t++){if(o={value:!1},B(arguments[t]))return arguments[t];if(!H(arguments[t++],o))return D;if(o.value)return arguments[t]}return P}),2,254,m,0,m,{gk:-1}),ct("SWITCH",(function(){var t,e,o,n,r=arguments;if(r.length<3)return D;if(B(t=r[0]))return t;for(t===g&&(t=0),e=1,o=r.length-1;e<o;e++){if(n=r[e],e++,B(n))return n;if(n===g&&(n=0),K(t)&&K(n)){if(t.toUpperCase()===n.toUpperCase())return r[e]}else if(t===n)return r[e]}return r.length%2==0?r[r.length-1]:P}),3,253,m,m,m,{gk:-1}),ct("XOR",(function(){var t,e,o,n=0;for(t=0;t<f(arguments);t++)for(o=arguments[t],e=0;e<f(o);e++)o[e]&&n++;return!!(n%2)}),1,m,Et,-1,-1),ct("DATE",(function(t,e,o){t<=1899&&(t+=1900);var n=new Date(t,e-1,o);return n<new Date(1899,11,30)?L:n}),3,3,[{Hi:2,aj:["< 0","> 9999"]},At,At]),ct("TIME",(function(t,e,o){var n=u(0);return n.setHours(t),n.setMinutes(e),n.setSeconds(o),n.setMilliseconds(0),n.getHours()<0&&n.getMinutes()<0&&n.getSeconds()<0?L:n}),3,3,[At,At,At]),ct("DATEVALUE",(function(t){var e,o,n,r;if(K(t)&&((e=c(t))||((e=new Date(t))&&!y(e.valueOf())||(e=null))),!e)return D;if(n=e.getFullYear(),r=ne(e),n<1900)return D;for(o=1900;o<n;o++)r+=365,Q(o)&&r++;return r}),1,1,{Ni:!0}),ct("TIMEVALUE",ue,1,1,{Ni:!0}),ct("NOW",(function(){return new Date}),0,0,m,m,m,{ck:!0}),ct("TODAY",(function(){var t=new Date;return t.setHours(0,0,0,0),t}),0,0,m,m,m,{ck:!0}),ct("HOUR",(function(t){return t.getHours()}),1,1,kt),ct("MINUTE",(function(t){return t.getMinutes()}),1,1,kt),ct("SECOND",(function(t){return t.getSeconds()}),1,1,kt),ct("DAY",(function(t){return t.getDate()}),1,1,kt),ct("MONTH",(function(t){return t.getMonth()+1}),1,1,kt),ct("YEAR",(function(t){return t.getFullYear()}),1,1,kt),ct("WEEKNUM",(function(t,e){var o,n,r;return 1===e||17===e||d(e)||2===e||11===e||12===e||13===e||14===e||15===e||16===e?(o=ne(t),n=new Date(t.getFullYear(),0,1).getDay(),2===e?n-=1:11===e||12===e||13===e||14===e||15===e?n=n-e+10:16===e&&(n+=1),n<0&&(n=7+n),(r=o-1-(6-n))<0&&(r=0),7===n&&16===e?z(r/7)+(r%7!=0?1:0):1+z(r/7)+(r%7!=0?1:0)):21===e?he(t):L}),1,2,[kt,It],m,m,{bk:1}),ct("WEEKDAY",ce,1,2,[kt,It],m,m,{bk:1}),ct("EDATE",(function(t,e){return le(!1,t,e)}),2,2,[kt,At]),ct("EOMONTH",(function(t,e){return le(!0,t,e)}),2,2,[kt,At]),ct("WORKDAY",(function(t,e,o){return ie(!0,t,e,o)}),2,3,[kt,At,Ot],2,2,{bk:2}),ct("WORKDAY.INTL",(function(t,e,o,n){d(o)&&0===e&&(o=1);var r=re(o);return B(r)?r:"1111111"===r.join("")?D:ie(!1,t,e,n,r)}),2,4,[kt,At,{_i:"0000011"},Ot],[3],[2,3],{bk:[2,3]}),ct("DAYS360",r.Functions.uk,2,3,[kt,kt,{_i:!1,Hi:7}],m,m,{bk:2}),ct("NETWORKDAYS",(function(t,e,o){return se(!1,t,e,m,o,(function(t,e,o){var n=z(l(e)-l(t))%7,r=z(ce(t,2)+n),i=0===t.getDay()?1:2;return(o-=n=(n=r>5?r-5:0)>i?i:n)-2*x(o/7)}))}),2,3,[kt,kt],2,2,{bk:2}),ct("NETWORKDAYS.INTL",(function(t,e,o,n){return se(!0,t,e,o,n,fe)}),2,4,[kt,kt],[2,3],[2,3],{bk:[2,3]}),ct("YEARFRAC",r.Functions.vk,2,3,[kt,kt,{_i:0,Hi:2}],m,m,{bk:2}),ct("DATEDIF",(function(t,e,o){var n,i;if(t.setHours(0,0,0,0),e.setHours(0,0,0,0),r.ExcelCompatibleCalcMode&&(t<mt||e>yt))return L;if(o=o.toLocaleUpperCase(),n=function(){var t=[];return t[0]=function(t,e){return e.getFullYear()-t.getFullYear()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?-1:0)},t[1]=function(t,e){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())+(e.getDate()<t.getDate()?-1:0)},t[2]=function(t,e){return(e.getTime()-t.getTime())/864e5},t[3]=function(t,e){var o=new Date(e.getFullYear(),e.getMonth()+(e.getDate()<t.getDate()?-1:0),t.getDate());return(e.getTime()-o.getTime())/864e5},t[4]=function(t,e){return e.getMonth()-t.getMonth()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?12:0)+(e.getDate()<t.getDate()?-1:0)},t[5]=function(t,e){var o=e.getFullYear()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?-1:0),n=t.getMonth(),r=t.getDate(),i=Q(t.getFullYear());return 1!==n||29!==r||Q(o)||r--,!i&&1===n&&28===r&&Q(o)&&r++,(e-new Date(o,n,r))/864e5},t}(),i=p(o,["Y","M","D","MD","YM","YD"]),e<t)return L;if(i<0)throw r.sR().Exp_NotSupported;return(0,n[i])(t,e)}),3,3,[kt,kt,Mt]),ct("DAYS",(function(t,e){var o,n={value:0};if(!ft(t,n))return D;if(!ft(e,o={value:0}))return D;function r(t){return t>=0&&t<2958466}return 2958465,r(n.value)&&r(o.value)?n.value-o.value:L}),2,2),ct("ISOWEEKNUM",he,1,1,kt),ct("CLEAN",(function(t){var e,o,n=[];for(e=0;e<f(t);e++)0<=(o=t.charCodeAt(e))&&o<=31||127===o||128<=o&&o<=159||n.push(t[e]);return n.join("")}),1,1,Mt),ct("TRIM",(function(t){var e,o,n,r,i;for(t=t.trim(),e=[],o=!0,n=0;n<f(t);n++)(i=" "===(r=t.charAt(n))||"\t"===r||"\n"===r)&&!o||e.push(r),o=!i;return e.join("")}),1,1,Mt),ct("DOLLAR",(function(t,e){return function(t){var e=pe(t),o=[];return t<0&&(e=e.substr(1)),o.push("$"),o.push(e),t<0&&(o.push(")"),o.unshift("(")),o.join("")}(t=U(qt(t,e)))}),1,2,[Ct,{_i:2,Hi:2,aj:"> 99",bj:D}],m,m,{bk:1}),ct("FIXED",(function(t,e,o){var n,r,i,a,s=0;if(e<0&&(t/=s=z(k(10,b(e)))),t=U(qt(t,T(0,e))),e<0&&(t*=s),n=o?""+t:pe(t),e>0)if(-1===(r=n.indexOf(".")))for(n+=".",i=0;i<e;i++)n+="0";else for(a=n.length-(r+1);a<e;a++)n+="0";return n}),1,3,[Ct,{_i:2,Hi:2},{_i:!1,Hi:7}],m,m,{bk:[1,2]}),ct("TEXT",(function(t,e){var o;if(""===e)return W(t);d(t)&&(t=0),"string"==typeof t&&(t=t.trim());try{return(o=n.Formatter&&n.Formatter.GeneralFormatter)?new o(e).format(t):""+t}catch(t){return D}}),2,2,[{},Mt]),ct("VALUE",(function(t){if(!t)return 0;var e,o=c(t);return d(o)?function(t){var e,o,i,s,l,u,c=n.Common.CultureManager.q4().NumberFormat;if("$"!==t[0]&&t[0]!==c.currencySymbol||(t=t.substring(1)),e=C(t),y(e))return D;for(("."===t[0]||"-"===t[0]&&"."===t[1])&&(t="-"===t[0]?t.replace(t[1],"0."):"0"+t),o=t.length,i=0,l=0,u=0;i<o;i++){for(s=t[i];i<o&&r.isDigit(s.charCodeAt(0));)s=t[++i];if(i===o){if(l&&i-l<=3)return D;break}if(s===c.numberGroupSeparator){if(u||l&&i-l<=3)return D;l=i}else if(s===c.numberDecimalSeparator){if(u||l&&i-l<=3)return D;u=i}}return t=a.Gb(t,",",""),C(t)}(t):(e=l(o),B(e)?ue(o):e)}),1,1,Mt),ct("LOWER",(function(t){return t.toLowerCase()}),1,1,Mt),ct("UPPER",(function(t){return t.toUpperCase()}),1,1,Mt),ct("PROPER",(function(t){var e,o,n,i=f(t),a=[];if(i>0)for(e=t.toUpperCase(),o=t.toLowerCase(),n=1,a[0]=e[0];n<i;)a[n]=r.ei(t[n-1])?o[n]:e[n],n++;return a.join("")}),1,1,Mt),ct("CHAR",(function(t){return String.fromCharCode(t)}),1,1,{Hi:2,aj:["> 255","< 1"],bj:D}),ct("CODE",(function(t){return t[0].charCodeAt(0)}),1,1,{Hi:5,Ni:!0}),ct("REPLACE",me,4,4,[Mt,{Hi:2,aj:"< 1",bj:D},Nt,Mt],m,m,{bk:2}),ct("SUBSTITUTE",(function(t,e,o,n){var r,i,s,l,u,c,h=f(e);if(f(arguments)>3){if(s=0,l=void 0,(i=z(n))<1)return D;for(l=0;l<i;l++){if(-1===(s=t.indexOf(e,s)))return t;s+=h}u=t.substring(0,s-h),c=t.substr(s),r=u.concat(o).concat(c)}else r=a.yb(t,e,o);return r}),3,4,[Mt,{Hi:5,Ni:!0},Mt],m,m,{bk:3}),ct("CONCATENATE",(function(){return de(arguments,"concatenate")}),1,m,{Hi:4,Ii:0,Ji:!0,Xi:!0},m,-1),ct("LEFT",(function(t,e){return ge(!0,t,e)}),1,2,[Mt,Rt],m,m,{bk:1}),ct("MID",ve,3,3,[Mt,{Hi:2,aj:"<= 0",bj:D},Nt]),ct("RIGHT",(function(t,e){return ge(!1,t,e)}),1,2,[Mt,Rt],m,m,{bk:1}),ct("REPT",(function(t,e){var o,n=[];if(e<0||e*f(t)>32767)return D;for(o=0;o<e;o++)n.push(t);return n.join("")}),2,2,[Mt,At]),ct("LEN",(function(t){return t?t.length:0}),1,1,Mt),ct("FIND",we,2,3,[Mt,Mt,It],m,m,{bk:2}),ct("SEARCH",Te,2,3,[Mt,Mt,Rt],m,m,{bk:2}),ct("EXACT",(function(t,e){return t===e}),2,2,[Mt,Mt]),ct("T",(function(t){return K(t)?t:""}),1,1),ct("UNICHAR",(function(t){if(t){var e=t;return e<=0||e>1114111?D:e>=55296&&e<=57343?P:e<1048576?String.fromCharCode(e):(e-=1048576,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return D}),1,1,[{Hi:2,bj:D}]),ct("UNICODE",(function(t){var e,o,n=W(t);return""===n||null===n?D:(e=n.charCodeAt(0))>=55296&&e<=56319?1===n.length?D:(void 0,(o=n.charCodeAt(1))>=56320&&o<=57343?e|o<<8:1):e>=56320&&e<=57343?e-53248+53248:e}),1,1),ct("BAHTTEXT",(function(t){var e,o;function n(t){var e,o,n,r,i=["ล้าน","สิบ","ร้อย","พัน","หมื่น","แสน",""],a=["ศูนย์","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],s=["ลบ","บาท","ถ้วน","สตางค์","ยี่","เอ็ด",","," ","฿"],l="",u=t+"",c=u.length;for(e=c;e>0;--e){if(n=a[o=v(u[c-e])],1===(r=1<e?(e-1)%6:6)&&2===o&&(n=s[4]),1===o)switch(r){case 0:case 6:l+=e<c?s[5]:n;break;case 1:break;default:l+=n}else{if(0===o){0===r&&(l+=i[r]);continue}l+=n}l+=i[r]}return l}return t?(e=Math.abs(v(t)),o=parseFloat((Math.abs(t)-e).toFixed(2)),0!==e?0===o?(t<0?"ลบ":"")+n(e)+"บาทถ้วน":(t<0?"ลบ":"")+n(e)+"บาท"+n(100*o)+"สตางค์":0!==o?(t<0?"ลบ":"")+n(100*o)+"สตางค์":"ศูนย์บาทถ้วน"):D}),1,1,[{Hi:0,bj:D}]),ct("CONCAT",(function(){return de(arguments,"concat")}),1,m,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ct("TEXTJOIN",(function(t,e){var o,n,r,i,a,s,l;if(t.isReference&&0===t.length)return N;if(o={value:!1},n=!!d(e[0])||e[0],!ht(n,o))return D;for(n=o.value,i=[],a=[],s=f(r=arguments),l=2;l<s;l++)ye(i,r[l],n);return ye(a,r[0],!1),function(t,e){if(0===t.length)return"";if(1===e.length)return t.join(e[0]);for(var o=t[0],n=1,r=0;n<t.length;n++,r++)r===e.length&&(r=0),o+=e[r]+t[n];return o}(i,a)}),3,m,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ct("FINDB",(function(t,e,o){var n,i,a,s,l,u;return be()||r.usedbcs?(n=tt(e),i=tt(t),a=n.length,o<1||a<o?D:(s=Se(n),l=Se(i),-1===(u=s.indexOf(l,o-1))?D:u+1)):we(t,e,o)}),2,3,[Mt,Mt,It],m,m,{bk:2}),ct("LEFTB",(function(t,e){return Ce(!0,t,e)}),1,2,[Mt,Rt],m,m,{bk:1}),ct("RIGHTB",(function(t,e){return Ce(!1,t,e)}),1,2,[Mt,Rt],m,m,{bk:1}),ct("MIDB",(function(t,e,o){var n,i,a;return be()||r.usedbcs?(i=(n=tt(t)).length,--e<0?D:e>=i?"":i<e+o?n.slice(e).join(""):(a=n.slice(e,e+o),"singleByte"!==$(a[a.length-1])&&(a[a.length-1]="​",d(a[0])&&(a[a.length]="​")),a.join(""))):ve(t,e,o)}),3,3,[Mt,Nt,Nt]),ct("LENB",(function(t){var e,o,i,a;if(!t)return 0;if(be()||r.usedbcs){for(e=0,o=0;o<t.length;o++)if(8203!==t[o].charCodeAt(0)&&(i=$(t[o]),a=n.Common.CultureManager.q4(),"doubleByte"===i&&9390!==t[o].charCodeAt(0))){if("ja-jp"===(a&&a.name().toLocaleLowerCase())&&(711===t[o].charCodeAt(0)||9356===t[o].charCodeAt(0)||8212===t[o].charCodeAt(0)))continue;e++}return t.length+e}return t.length}),1,1,Mt),ct("REPLACEB",(function(t,e,o,n){var i,a,s,l,u,c,f;if(be()||r.usedbcs){for(i=[],a=void 0,s=0,l=0;l<t.length;l++)a=t[l],"doubleByte"===$(t[l])&&(s++,a=t[l]),i[l+s]=a;return u=i.length,e=S(e,u+1),o=S(o||0,u-e+1),d(i[e-1])?(i[e-1]=" ",i[e]=" "):d(i[e-2])&&e>=2&&(i[e-2]=" ",i[e-1]=" "),c=i.slice(0,e-1).join(""),f=i.slice(e-1+o).join(""),c.concat(n).concat(f)}return me(t,e,o,n)}),4,4,[Mt,{Hi:2,aj:"< 1",bj:D},Nt,Mt],m,m,{bk:2}),ct("SEARCHB",(function(t,e,o){var n,i,a,s;return be()||r.usedbcs?(n=tt(e),i=tt(t),a=n.length,o<1||a<o?D:(s=Te(Se(i),Se(n),o))===D?D:s):Te(t,e,o)}),2,3,[Mt,Mt,Rt],m,m,{bk:2}),ct("ENCODEURL",(function(e){var o,n,r,i,a,s,l="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,c=l||u||Function("return this")();if(c&&c.encodeURIComponent)return encodeURIComponent(e).replace(/[!~'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}));if(o="",void 0,(n=e.length-1)<0)return"";for(r=0;r<=n;r++)if((i=e.charCodeAt(r))>="A".charCodeAt(0)&&i<="Z".charCodeAt(0)||i>="0".charCodeAt(0)&&i<="9".charCodeAt(0)||i>="a".charCodeAt(0)&&i<="z".charCodeAt(0)||i==="-".charCodeAt(0)||i==="_".charCodeAt(0)||i===".".charCodeAt(0))o+=e[r];else{if(a=void 0,Ae(i)){if(n===r||!Ie(i,e.charCodeAt(r+1)))return null;a=[i,e.charCodeAt(r+1)],r++}else a=[i];for(s=0;s<a.length;s++)o+="%",o+=a[s].toString(16).toUpperCase()}return o}),0,1,Mt),ct("ISERROR",(function(t){return B(t)}),1,1,m,m,m,{gk:-1}),ct("ISERR",(function(t){return!!B(t)&&t._code!==P._code}),1,1,m,m,m,{gk:-1}),ct("ISNA",(function(t){return!!B(t)&&t._code===P._code}),1,1,m,m,m,{gk:-1}),ct("ERROR.TYPE",(function(t){if(!d(t)&&B(t)){var e=p(t._code,[N._code,O._code,D._code,F._code,E._code,L._code,P._code]);if(e>=0)return e+1}return P}),1,1,m,m,m,{gk:-1}),ct("ISNUMBER",(function(t){return q(t,r.ExcelCompatibleCalcMode)}),1,1,m,m,m,{gk:-1}),ct("ISEVEN",(function(t){return ut(b(t))%2==0}),1,1,Ct,m,m),ct("ISODD",(function(t){return ut(b(t))%2!=0}),1,1,Ct,m,m),ct("N",(function(t){return q(t)?U(t):Y(t)?t?1:0:B(t)?t:0}),1,1,m,m,m),ct("ISBLANK",(function(t){return d(t)}),1,1,m,m,m,{gk:-1}),ct("ISLOGICAL",(function(t){return Y(t)}),1,1,m,m,m,{gk:-1}),ct("ISTEXT",(function(t){return K(t)}),1,1,m,m,m,{gk:-1}),ct("ISNONTEXT",(function(t){return!K(t)}),1,1,m,m,m,{gk:-1}),ct("ISREF",(function(t){return _(t)}),1,1,m,-1,m,{gk:-1}),ct("TYPE",(function(t){return Y(t)?4:q(t)?1:K(t)?2:B(t)?16:V(t)?64:D}),1,1,m,m,-1,{gk:-1}),ct("NA",(function(){return P}),0,0),ct("SHEET",(function(t,e){var o,n,i=0,a=t.source.kj;if(V(e))return P;if(e instanceof r.CalcReference||d(e))return n=(o=e)&&(o.xf||o.references[0].xf)||t.source,a.parent.getSheetIndex(n.kj.name())+1;if(q(e)||K(e))for(;i<a.parent.sheets.length;i++)if(e.toUpperCase()===a.parent.sheets[i].name().toUpperCase())return i+1;return P}),0,1,m,-1,m,{dk:!0}),ct("SHEETS",(function(t,e){var o,n,i,a=t.source.kj;return d(e)?a.parent.sheets.length:V(e)||q(e)?P:K(e)?D:e instanceof r.CalcReference?(n=(o=e).references)?n.length:(i=o.xf||t.source,a.parent.getSheetIndex(i.kj.name())+1):P}),0,1,m,-1,m,{dk:!0}),ct("LET",m,3,253,m,m,m,{argsValidator:function(t,e,o){if(o%2==0)throw r.sR().Exp_FormulaInvalid},subExpressionValidator:function(t,e){if(e%2==0&&(1===t.type||100===t.type&&t.value.indexOf(".")>-1))throw r.sR().Exp_FormulaInvalid},LMc:function(t,e){var o=e.source;o&&o.q$a&&t.bhc&&(t.value=t.value.replace(/\./g,"_"))}}),ct("OBJECT",(function(){var t,e,o,n,i,a,s,l,u,c,h,p,g,m,y,C,v=arguments,b=f(v);if(b<2||b%2!=0)return P;for(e=0;e<b;e+=2){if(i=v[e+1],a=Re(v[e],2),s=Re(i,0),B(a))return a;if(B(s))return s;if(a.isError||s.isError)return P;if(l=a.length,u=s.length,d(n))n=u;else if(n!==u)return P;if(l>u)return P;if(l<u){if(!1===o||l>1)return P;for(d(t)&&(t=[]),c=s.rowCount,h=s.colCount,p=a[0],g=0;g<c;g++){for(m=t[g],d(m)&&(m=t[g]=[]),y=0;y<h;y++)d(m[y])&&(m[y]={}),m[y][p]=s[y+g*h];t[g]=m}o=!0}else{if(!0===o)return P;for(d(t)&&(t={}),C=0;C<u;C++)t[a[C]]=s[C];o=!1}}return o?new r.CalcArray(t):t}),2,m,m,-1,-1),ct("PROPERTY",(function(){var t,e=arguments,o=e[0],n=e[1].split("."),r=n.length,i=o;if(d(o)||"object"!=typeof o)return P;for(t=0;t<r;t++)if(i=i[n[t]],d(i))return P;return i}),2,2,m),ct("GETPIVOTDATA",m,2,253,m,-1,m),ct("FILTERJSON",(function(t){var e,o,n,i,a;try{if(e=JSON.parse(t),Array.isArray(e)&&e.length>0){for(o=!0,n=0;n<e.length;n++)if(!Array.isArray(e[n])){o=!1;break}if(o)e=new r.CalcArray(e);else{for(i=[],a=0;a<e.length;a++)i.push([e[a]]);e=new r.CalcArray(i)}}return e}catch(t){return D}}),1,1,m),function(){var t=new r.Functions.AsyncFunction("WEBSERVICE",1,1);t.defaultValue=function(){return""},t.evaluate=Me,r.Functions.bi.WEBSERVICE=t}(),function(){var t=new r.Functions.AsyncFunction("REFRESH",1,3);t.evaluate=xe,r.Functions.bi.REFRESH=t}()}).call(this,o("./node_modules/webpack/buildin/global.js"))},CalcEngine:function(t,e){t.exports=o("@grapecity/js-calc")},Common:function(t,e){t.exports=o("Common")}}),t.exports=n.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(t,e,o){var n="object"==typeof n?n:{};n.Spread=n.Spread||{},n.Spread.CalcEngine=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){var n,r;if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(n=Object.create(null),o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/assets/",o(o.s="./src/calc.entry.ts")}({"./src/Parser.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function A(){throw r.sR().Exp_FormulaInvalid}function I(t,e,o){throw l.Kb(r.sR()[o||f],[t,e])}function R(t){return t<=255}function M(t){return t<=127}function k(t){return t===r.getBoolean().boolean_true||"TRUE"===t}function N(t){return t===r.getBoolean().boolean_false||"FALSE"===t}function O(t){return t>=48&&t<=57}function D(t,e,o,n,r,i){var a,s,l=t.length,u=o===n?0:1,c=[],f=0;for(a=e+1;a<l;a++)if((s=t[a])===r&&(c.push(s),f++,s=t[++a]),s===o&&u++,s===n)if(u--,o===n&&a+2<l&&t[a+1]===o)c.push(o),a++,f++;else{if(0===u)return{result:c,endIndex:a,skipCount:f};c.push(s)}else c.push(s);i&&I(n,o,"Exp_NoSyntax")}function F(t,e,o){var n,i,a,s,l=t.length,u=l-e;for(n=0;n<r.ErrorList.length;n++)if(e+(a=(i=r.ErrorList[n]).length)<=l&&(s=t.slice(e,e+a),a<=u&&i===s.join("").toUpperCase()))return{result:s,endIndex:e+a-1};o&&I([t[e],e])}function E(t,e){return C.apply(t,e),t}function j(t,e){if(!e||0===e.length||!t.Eh)return!1;var o="'"===e[0]?1:0;return"["===e[o]&&e.indexOf("]")>o}function P(t,e){var o,n,r;for(o=0;o<e.length;o++)for(n=e[o],r=0;r<n.length;r++)if(t===n[r])return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./src/calc.common.ts"),i=void 0,a=null,s="ARRAY",l=n.Common.u,u=n.Common.j,c=u.Fa,f="Exp_FormulaInvalidChar",e.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],h={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},p=".",d=",",g=";",m=",",y=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],e.isDigit=O,e.ei=function(t){var e=t.charCodeAt(0);return!R(e)||(M(e)?(e|=32)>=96&&e<=122:0===y[e]||1===y[e])},e.fi=function(t){var e=t.charCodeAt(0);return!R(e)||(M(e)?e<=57?e>=48:(e|=32)>=96&&e<=122:0===y[e]||1===y[e])},e.isNumber=function(t){var e=t.charCodeAt(0);return M(e)?e>=48&&e<=57:8===y[e]||10===y[e]},C=[].push,v=function(){function t(t,e,o,n,r){var i,a,l;this.oi=[],r=r||0,(i=this).Qb=t,a=Array.isArray(t)?t.join(""):t,i.Nc=e,i.mi=o,i.li=n||o+t.length-1,0===e&&0===r&&t?(k(l=a.toUpperCase())||N(l))&&(r=5,a=l):1===e&&a!==s&&(a=a.toUpperCase()),i.ni=a,i.hi=r}return t.prototype.type=function(){return this.Nc},t.prototype.subType=function(){return this.hi},t.prototype.stringValue=function(){return this.ni},t}(),e.FormulaToken=v,b=function(){function t(t){void 0===t&&(t=5e3),this.priority=t}return t.prototype.resolveToken=function(t,e,o,n,r,i){return 0},t.prototype.unparse=function(t,e,o,n){return!0},t}(),e.TokenResolver=b,e.preOperaterTypesMap={"+":0,"-":1},e.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},w=function(){function t(){}return t.prototype.setParserOption=function(e){var o,r;e!==i&&n.Common.CultureManager.q4()?(r="object"==typeof e&&e.NumberFormat?e.NumberFormat:n.Common.CultureManager.q4().NumberFormat,o=e?r:{}):r=o={},d=t.listSeparator=o.listSeparator||",",p=o.numberDecimalSeparator||".",!e&&t.numberDecimalSeparator||(t.numberGroupSeparator=r.numberGroupSeparator||",",t.numberDecimalSeparator=r.numberDecimalSeparator||"."),g=t.arrayGroupSeparator=o.arrayGroupSeparator||";",m=t.arrayListSeparator=o.arrayListSeparator||","},t.prototype.parse=function(t,e){var o,n;return this.setParserOption(t.culture),o=e.split(""),this.gi=o,n=this.parseToTokens(t,o,!t.ignoreError),this.buildExpressionTree(t,n,!t.ignoreError)},t.prototype.unparse=function(t,e,o){return void 0===o&&(o=[]),this.Cma(t,e,o),"@"===o[0]&&e&&e.arguments&&e.arguments[0]&&1===e.arguments[0].type&&t&&t.source&&t.source.Af&&!0!==t.source.Af.allowDynamicArray&&o.splice(0,1),o.join("")},t.prototype.Cma=function(t,e,o){var n,r;if(e)for(this.setParserOption(t.culture),n=t.getResolvers(),r=0;r<n.length&&!n[r].unparse(t,this,e,o);r++);},t.prototype.parseToTokens=function(t,o,n){var r,i,a,l,u,c,f,h,y,b,w,T,S,x,A;for(void 0===n&&(n=!0),r=this,i=function(t,e,o){return e.length>0&&t.push(new v(e,0,o)),[]},a=o.length,l=[],u=[],c=-1,f=[],b=0;b<a&&" "===o[b];)b++;for("="===o[b]&&b++,y=b,S=function(b){var S,A,R,M,k,N,j,P,L,G,B=o[b],_=B.charCodeAt(0),V=void 0;if(64===_&&t.kj&&t.kj.Wu&&!0===t.kj.Wu.allowDynamicArray)h=new v(B,1,b),l.push(h),y=b+1;else if(_>=97&&_<=122||_>=65&&_<=90)f.push(B);else if(34===_)f.length>0&&(f=i(l,f,y)),(V=D(o,b,'"','"',"",n))?(S=new v(V.result,0,b,b+V.result.length+2,3),V.skipCount&&(S.HTa=o.slice(b,V.endIndex+1).join(""),S.li+=V.skipCount),l.push(S),b=V.endIndex,y=b+1):(E(f,o.slice(b,a)),b=a-1);else if(39===_)(V=D(o,b,"'","'","",n))?(A=function(t){var e,o,n=[];if(t.indexOf(":")>-1)for(e=t.split(":"),o=0;o<e.length;o++)n.push("'"+e[o].replace(/'/g,"''")+"'");return n}(V.result.join("")),R=[],A.length>1&&(M=A.join(":").split(""),R=r.parseToTokens(t,M,n)),R&&R.length>0?(R.forEach((function(t){t.mi+=b,t.li+=b})),E(l,R)):(f.push("'"),E(f,V.result),f.push("'")),b=V.endIndex):(f.push("'"),b=a-1);else if(91===_)if(V=D(o,b,"[","]","'",n))f.push("["),E(f,V.result),f.push("]"),b=V.endIndex;else{if(r.lda&&0===f.length&&("R"===f[0]||"r"===f[0]||"C"===f[0]||"c"===f[0]))return x=b,"continue";E(f,o.slice(b,a)),b=a-1}else{if(13===_||10===_)return x=b,"continue";if(35===_)(k=F(o,b))?(l.push(new v(k.result,0,b,b+k.result.length-1,6)),y=b+1,b=k.endIndex):f.push(B);else if(33===_)f.length,(N=l.length)>0&&0===l[N-1].Nc?(j=l[N-1],C.apply(j.Qb,f),l[N-1]=new v(j.Qb,0,j.mi,b,12)):l.push(new v(f,0,y,b,12)),f=[],y=b+1;else if(43===_||45===_)P=0===l.length?null:l[l.length-1],0!==f.length?(l.push(new v(f,0,y)),l.push(new v(B,5,b)),f=[],y=b+1):(P&&7===P.Nc&&l.pop(),!P||2!==P.hi&&6!==P.Nc&&0!==P.Nc?(l.push(new v(B,4,b)),y=b+1):(l.push(new v(B,5,b)),y=b+1));else if(B===p||O(_))f.length>0?f.push(B):(L=function(t,e,o){var n,r,i=t.length,a=0,s=[];for(n=e;n<i;n++)if(O((r=t[n]).charCodeAt(0)))0===a?a=2:3===a?a=4:1===a?a=2:5!==a&&6!==a||(a=7),s.push(r);else if(r===o){if(2===a)a=4;else{if(0!==a&&1!==a)return{};a=3}s.push(".")}else if("+"===r||"-"===r){if(0===a)a=1;else{if(5!==a)return{num:s,endIndex:n-1};a=6}s.push(r)}else if("E"===r||"e"===r){if(2!==a&&4!==a)return{};a=5,s.push(r)}else if(2===a||4===a||7===a)return{num:s,endIndex:n-1};return 2===a||4===a||7===a?{num:s,endIndex:i-1}:{}}(o,b,p),L.num?(w=L.endIndex,G=L.num,w<=a-2&&"!"===o[w+1]?(E(f,G),y=w):(l.push(new v(G,0,b,w,4)),y=w+1),b=w):f.push(B));else if(123===_)f.length>0&&(n?I(B,b):f=i(l,f,y)),h=new v(s,1,b,b,1),l.push(h),u[++c]=h,y=b+1;else if(B===g&&c>=0&&u[c].value===s)f=i(l,f,y),c<0&&n&&I(B,b),l.push(new v(g,3,b,b)),y=b+1;else if(125===_)f=i(l,f,y),w<0&&n&&I(B,b),T=u[c--],T=new v(B,T.Nc,b,b,2),l.push(T),y=b+1;else if(32===_)f=i(l,f,y),y=b+1;else if(B===d||B===m||B===g)f=i(l,f,y),c<0||1!==u[c].Nc?l.push(new v(d,5,b,b,10)):l.push(new v(B,3,b,b)),y=b+1;else if(37===_)f=i(l,f,y),l.push(new v(o[b],6,b,b)),y=b+1;else if(b+2<=a&&e.operaterTypesMap[B+o[b+1]])f=i(l,f,y),l.push(new v(o.slice(b,b+2),5,b,b+1,5)),b++,y=b+1;else if(e.operaterTypesMap[B])f=i(l,f,y),l.push(new v(B,5,b,b)),y=b+1;else if("("===B)f.length>0?(h=new v(f,1,y,b,1),f=[]):h=new v(B,2,b,b,1),l.push(h),u[++c]=h,y=b+1;else if(")"===B){if(f=i(l,f,y),c<0)return n&&I(B,b),i(l,B,b),y=b+1,x=b,"continue";T=u[c--],T=new v(B,T.Nc,b,b,2),l.push(T),y=b+1}else if(":"===B)f=i(l,f,y),l.push(new v(B,5,b,b,11)),y=b+1;else if("\r"===B||"\n"===B);else{if("\\"===B){if(++b>=a)return n&&I(B,b),x=b,"continue";f.push(B),B=o[b]}f.push(B)}}x=b},A=b;A<a;A++)S(A),A=x;return i(l,f,y),l},t.prototype.buildExpressionTree=function(t,e,o){var n,r=this.ii(t,e,o),i=this.ji(t,r,o);return o&&(i||A(),this.rSa(i)),!((n=t.source)&&n.q$a)&&i&&(i.ehc=!0),i},t.prototype.rSa=function(t){for(var e,o,n,i,a,s;10===t.type;)t=t.value;if(e=this,9===t.type)t.value||A(),e.rSa(t.value),t.value2&&e.rSa(t.value2);else if(7===t.type)for(n=(o=t.arguments).length,(i=t.function)&&i.gEc(i.minArgs,i.maxArgs,n),a=0;a<n;a++)s=o[a],i?i.hEc(s,a):r.iEc(s,a),e.rSa(s)},t.prototype.ji=function(t,e,o){var n,i,a,s,l,u,c=this.ki(t,e,o);for(s=3;s<c.length;)if(l=c[s],9!==(u=c[s-2]).type&&o&&A(),l&&9===l.type){for(;s>=3&&h[l.value]>=h[u.value];)i=c[s-3],a=c[s-1],n=r.Kh(u.operatorType,i,a),c.splice(s-3,3,n),(s-=2)>=3&&(u=c[s-2]);s+=2}else s++;if(1===c.length)return c[0];for(s=c.length-2;s>0;s-=2)i=c[s-1],a=c[s+1],9!==c[s].type&&o&&A(),n=r.Kh(c[s].operatorType,i,a),c.splice(s-1,3,n);return n},t.prototype.ki=function(t,e,o){var n,i,a,s,l,u,c,f,h,p,g,m,y,C,v,b,w,T,S;for(n=[],i=(e=Array.isArray(e)?e:[e]).length,a=0;a<i;a++){if(l=s=e[a],9===s.type){if(0===s.operatorType||1===s.operatorType)if(a===i-1)o&&A();else{for(u=a;9===e[u].type&&e[u].operatorType<=1;)u++;for(c=this.ji(t,e[u]),f=u-1;f>=a;f--)c=l=r.Kh(e[f].operatorType,c);l=c,a=u}else if(2===s.operatorType){if(0!==a){l=r.Kh(s.operatorType,n[n.length-1]),n[n.length-1]=l;continue}o&&A()}}else if(10===s.type)s.value=this.ji(t,s.value),l=s;else if(7===s.type){if(h=0,p=s.arguments,g=[],m=[],y=s.function,C="LET"===s.functionName,p.length>0){for(v=[],C&&!t.MMc&&(t.MMc=[]),t.MMc&&t.MMc.push(v),b=0;b<=p.length;b++)w=p[b],T=void 0,b===p.length||0===w.type&&w.value===d?(T=h===b?new r.Expression(11):this.ji(t,m,o),g.push(T),S=g.length-1,C&&S%2==0&&100===T.type&&(b<p.length||b===p.length&&P(T.value,t.MMc))&&(T.bhc=!0,v.push(T.value)),h=b+1,m=[]):(T=w,m.push(T),100===T.type&&P(T.value,t.MMc)&&(T.bhc=!0)),y&&T&&(y.LMc&&y.LMc(T,t),T.bhc&&(t.getFunction("LET")||r.Functions.findGlobalFunction("LET")).LMc(T,t));s.arguments=g}l=s,C&&t.MMc&&t.MMc.pop()}n.push(l)}return n},t.prototype.ii=function(t,e,o){var n,r,i=[];for(n=0,r=e.length;n<r;)n=this.resolveToken(t,e,i,n,o);return i},t.prototype.resolveToken=function(t,e,o,n,s,l){var u,c,f,h,p,d=e[n],g=t.getResolvers();for(u=0;u<g.length;u++)if(c=g[u].resolveToken(t,this,e,n,s,l)){h=n-1,(f=c.expr)&&c.index!==i?n=c.index-1:f=c,(p=o.length>0?o[o.length-1]:a)&&0!==f.type&&7!==f.type&&f.type<9&&0!==p.type&&7!==p.type&&p.type<9&&(e[h].li<d.mi-1&&o.push(r.Kh(17," "))),o.push(f);break}return n+1},t.prototype.resolveSubTokens=function(t,e,o,n,r,i){for(var a=[];o<e.length&&2!==e[o].hi;)if(o=this.resolveToken(t,e,a,o,n,r),i){o--;break}return{exprs:a,index:o+1}},t}(),e.Parser=w,T=function(){function t(t,e,o,n){this.Eh=!1,this.ignoreError=!1;var r=this;r.useR1C1=e,r.baseIdentity=o,r.option=n,r.source=t}return t.prototype.getExternalSource=function(t,e){var o,n=this.source.getCalcService().getAllSourceModels();for(o=0;o<n.length;o++)if(l.Mb(n[o].getSource().getName(),e))return n[o].getSource();return a},t.prototype.getExternalSourceToken=function(t){return t.getName()},t.prototype.setSource=function(t){this.source=t},t.prototype.getResolvers=function(){var t=(this.source||this.kj).getCalcService();return t&&t.getResolvers()},t.prototype.addResolver=function(t){var e=(this.source||this.kj).getCalcService();e&&e.addResolver(t)},t.prototype.getFunction=function(t){var e,o=t,n=r.getMapping()&&r.getMapping().builtInFunctionsMapping;if(!c(n))for(e in n)n[e].alias===t&&(o=e);return this.source&&this.source.getCustomFunction(o)||r.Functions.findGlobalFunction(t)},t}(),e.ParserContext=T,r.CalcSource.prototype.getParserContext=function(t,e,o){return new T(this,t,e,o)},S=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return x(o,t),o.prototype.resolveToken=function(t,o,n,a,u,c){var f,h,p,d,m,y,C,v,b,w,T,S,x=n[a],I=x.ni,R=x.Qb,M=x.Nc,O=null,D=x.hi;if(0===M&&12===D){if(m=void 0,I&&("'"===(m=I).charAt(0)&&(m=m.substring(1,m.length-1))),a++,m&&(O=t.getExternalSource("",m)),!(x=n[a]))return(f=new r.Expression(8)).value=I,f;I=x.ni}if(0===M)0===x.hi?k(p=I.toUpperCase())||N(p)?(x.hi=5,x.ni=p,(f=new r.Expression(4)).value=k(p)):(y=c?100:8,(f=new r.Expression(y)).value=I):4===x.hi?((f=new r.Expression(2)).value=parseFloat(I),f.originalValue=I):3===x.hi?(f=new r.Expression(3)).value=I:5===x.hi?(f=new r.Expression(4)).value=k(I):6===x.hi?(f=new r.Expression(5)).value=r.CalcError.parse(I):7===x.hi&&(y=c?100:8,(f=new r.Expression(y)).value=I);else if(1===M){if(I===s){for(f=new r.Expression(6),a++,p=[[]],h=0,C=0,v=0;a<n.length&&2!==n[a].hi;){if(x=n[a],a<n.length-1&&4===x.Nc&&"-"===x.ni&&4===n[a+1].hi&&((x=n[++a]).Qb.unshift("-"),x.ni="-"+x.ni),3===x.Nc){if(x.ni===g){if(C!==v)throw l.Kb(r.sR().Exp_InvalidArrayColumns,[x.mi]);p.push([]),h++,v=0}}else{if(0!==x.Nc||4!==x.hi&&3!==x.hi&&5!==x.hi&&6!==x.hi)throw r.sR().Exp_InvalidArray;w=b=x.ni,4===x.hi?w=parseFloat(b):5===x.hi?w="TRUE"===b.toUpperCase():6===x.hi&&(w=r.CalcError.parse(b)),p[h].push(w),0===h&&C++,v++}a++}if(C!==v)throw l.Kb(r.sR().Exp_InvalidArrayColumns,[x.mi]);return a++,f.value=new r.CalcArray(p),{expr:f,index:a}}if(R.length>0)return T=t.source&&t.source.Af&&t.source.Af.allowDynamicArray,"@"!==R[0]||T||(x.ni=R.slice(1).join(""),I=x.ni),(f=new r.Expression(7)).functionName=I,S=t.getFunction(f.functionName)||r.Functions.findGlobalFunction(f.functionName),!1===T&&S&&!0===S.isDynamicArrayFunction&&(S=i),f.function=S,(d=o.resolveSubTokens(t,n,a+1,void 0,c||"LET"===I,"@"===R[0]&&T))?(f.arguments=d.exprs,{expr:f,index:d.index}):(f.arguments=[],f)}else if(4===M||6===M||5===M)f=r.Kh(4===M?e.preOperaterTypesMap[I]:e.operaterTypesMap[I],I);else if(2===M){if(f=new r.Expression(10),d=o.resolveSubTokens(t,n,a+1))return f.value=d.exprs,{expr:f,index:d.index};u&&A()}else 3===M&&((f=new r.Expression(0)).value=I);return O&&f&&(f.source=O,f={expr:f,index:a+1}),f},o.prototype.unparse=function(t,e,o,n){var i,a,s,l,u,c=this;if(6===o.type||4===o.type||2===o.type||5===o.type||3===o.type)c.qi(t,o,n);else if(9===o.type)c.ri(t,e,o,n);else if(10===o.type)n.push("("),e.Cma(t,o.value,n),n.push(")");else{if(7!==o.type)return(1===o.type||8===o.type)&&(c.unparseRefenceExpressions(t,e,o,n),!0);for(i=o.function&&o.function.name||o.functionName,E(n,((s=(a=r.getMapping()&&r.getMapping().builtInFunctionsMapping)&&a[i])&&s.alias||i).split("")),l="@"===i?["",""]:["(",")"],n.push(l[0]),u=0;u<o.arguments.length;u++)0!==u&&n.push(d),e.Cma(t,o.arguments[u],n);n.push(l[1])}return!0},o.prototype.unparseSource=function(t,e,o,n){if(t.getExternalSourceToken){if(o!==r.BangSource){var i=function(t,e,o){var n,r;if(!e||0===e.length||j(t,e)||j(t,o))return[];if(n=e,o)for(n.push(":"),r=0;r<o.length;r++)n.push(o[r]);return n}(t,t.getExternalSourceToken(o).split(""),n&&t.getExternalSourceToken(n).split(""));if(!(i.length>0))return!1;C.apply(e,i)}return e.push("!"),!0}return!1},o.prototype.unparseRefenceExpressions=function(t,e,o,n){if(o.source===r.BangSource)n.push("!");else if(o.source){if(!this.unparseSource(t,n,o.source,o.endSource))return void n.push("#","R","E","F","!")}8===o.type&&n.push(o.value)},o.prototype.ri=function(t,o,n,r){var i=n.operatorType;2===i?(o.Cma(t,n.value,r),r.push("%")):0===i||1===i?(r.push(e.di[i]),o.Cma(t,n.value,r)):(o.Cma(t,n.value,r),r.push(e.di[i]),o.Cma(t,n.value2,r))},o.prototype.qi=function(t,e,o){var n,s,u,c,f,h,d,y,C=r.sR().Exp_InvalidArray;if(3===e.type)o.push('"'),o.push(l.Gb(e.value,'"','""')),o.push('"');else if(2===e.type)n=e.originalValue||""+e.value,"."!==p&&(n=n.replace(".",p)),o.push(n);else if(4===e.type)o.push(e.value?r.getBoolean().boolean_true:r.getBoolean().boolean_false);else if(6===e.type){if(o.push("{"),(s=e.value).getRowCount()<=0)throw C;for(u=0,c=s.getRowCount();u<c;u++)for(u>=1&&o.push(g),f=0,h=s.getColumnCount();f<h;f++){if(0!==f&&o.push(m),(d=s.getValue(u,f))===i||d===a)throw C;"string"===(y=typeof d)?(o.push('"'),o.push(l.Gb(d,'"','""')),o.push('"')):"boolean"===y?o.push(d?r.getBoolean().boolean_true:r.getBoolean().boolean_false):"number"===y&&"."!==p?o.push((""+d).replace(".",p)):o.push(""+d)}o.push("}")}else 5===e.type?o.push(""+e.value):e.type},o}(b),e.DefaultTokenResolver=S,r.ParserWrapper.XAb=function(){w.numberDecimalSeparator===i&&(new w).setParserOption(!0);return w.numberDecimalSeparator},r.ParserWrapper.YAb=function(){w.numberGroupSeparator===i&&(new w).setParserOption(!0);return w.numberGroupSeparator}},"./src/calc.common.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function ft(t){return t&&t.toUpperCase()}function ht(t){var e,o;if(t){if(7===t.type&&("SUBTOTAL"===t.functionName||"AGGREGATE"===t.functionName))return!0;for(e=t.arguments&&t.arguments.length,o=0;o<e;o++)if(ht(t.arguments[o]))return!0;if(ht(t.value)||ht(t.value2))return!0}return!1}function pt(t){return isNaN(t)||!isFinite(t)}function dt(t,e){var o,n,r,l,u,c,f,h,p,d,g;if(!t)return e.value=0,!0;n=typeof t;try{if(n===i)o=t;else if(n===a){if(/[\f\n\r\t\v]/.test(t))return!1;if(r=t,0===(t=t.trim()).length)return e.value=0,!0;if(l=$.XAb(),u=$.YAb(),"."!==l&&"."!==u&&t.indexOf(".")>=0||","!==l&&","!==u&&t.indexOf(",")>=0)return!1;if(c=!1,f=!1,h=t[0],p=t[t.length-1],"("===t[0]&&")"===p){if(f=!0,"+"===(h=(t=t.substring(1,t.length-1).trim())[0])||"-"===h)return!1;p=t[t.length-1]}if("%"===h?(c=!0,t=t.substring(1)):"%"===p?(c=!0,t=t.substring(0,t.length-1)):"$"===h&&(t=t.substring(1)),""===t)return!1;if(t.indexOf(u)>=0&&(A.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+u+"\\d{3,})+(\\"+l+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$").test(t)&&(t=t.replace(A.qb("[ \\"+u+"]"),"")))," "===(t=t.trim())[1]&&("+"===t[0]?t=t.replace(/^\+ +/,"+"):"-"===t[0]&&(t=t.replace(/^\- +/,"-"))),"."!==l&&(t=t.replace(l,".")),t.indexOf(l)!==t.lastIndexOf(l))return!1;if(t.length>=2&&"0"===t[0]&&"x"===t[1])return!1;if(o=(+t).valueOf(),c&&(o/=100),f&&(o=-o),pt(o)){if(d=(t=r.trim()).charCodeAt(0),d|=32,t.length>4&&d>=97&&d<=122&&(g=(g=t[0]+t[1]+t[2]).toUpperCase(),!Q[g]))return!1;if(h=t[0],p=t[t.length-1],"/"===h||"-"===h||":"===h||"/"===p||"-"===p)return!1;if(A.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,\\z\\Z]").test(t))return!1;if(pt((o=new Date(t)).valueOf()))return!1;o=M.Ra(o)}}else if(n===s)o=t?1:0;else{if(!(t instanceof Date))return!1;o=M.Ra(t)}}catch(t){return!1}return e.value=o,!0}function gt(t){var o={value:0};if(dt(t,o))return o.value;throw e.sR().Exp_InvalidCast}function mt(t,e){return e&&(t===F||t===E||typeof t===a&&""===t.trim())}function yt(t,e){try{if(t)if(typeof t===s);else if(t instanceof Date)t=0!==M.Ra(t);else{if(!vt(t))return!1;t=0!==t}else t=!1}catch(t){return!1}return e.value=t,!0}function Ct(t,e,o,r,l){var u,c,f;if(bt(t))return t;if(u={value:F},c=z,0!==e&&mt(t,r))return c;switch(e){case 1:case 5:if(o&&5!==e){if(typeof t===s&&l)return c;t=dt(t,u)?u.value:c}else typeof t===i||(t=t instanceof Date?M.Ra(t):c);break;case 11:t=dt(t,u)?u.value:c;break;case 4:typeof t===a?t=(f=n.Common.l.Qa(t))!==E&&f!==F?M.Ra(f):c:o?t=dt(t,u)?u.value:c:typeof t===i||t instanceof Date||(t=c);break;case 3:o?t=dt(t,u)?u.value:c:typeof t!==s&&(t=c);break;case 2:t=t===F||t===E?"":""+t}return t}function vt(t,e){return typeof t===i||t instanceof Date||!e&&(typeof t===s||!isNaN(t)&&!isNaN(parseFloat(t)))}function bt(t){return t instanceof U}function wt(t){return t instanceof tt}function Tt(t){return t instanceof rt}function St(t,e,o){var n=new nt(5);return e&&(n.source=e),o&&(n.endSource=o),n.value=t,n}function xt(t,e){return t.charAt(e)}function At(t,e){for(var o=t.length,n=!1;e<o&&!isNaN(+xt(t,e));)e++,n=!0;for(e<o&&"."===xt(t,e)&&e++;e<o&&!isNaN(+xt(t,e));)e++,n=!0;if(e<o&&("E"===xt(t,e)||"e"===xt(t,e)))for(n=!1,++e<o&&("+"===xt(t,e)||"-"===xt(t,e))&&e++;e<o&&!isNaN(+xt(t,e));)e++,n=!0;return{Vi:n,mi:e}}function It(t){return"string"==typeof t}function Rt(t,o){if(!t||8===t.type&&t.value.indexOf("'")>=0)throw e.sR().Exp_FormulaInvalid}function Mt(t,e){return{row:t,col:e}}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./src/calcEngine.res.en.ts"),e.ExcelCompatibleCalcMode=!1,e.SR={en:r.resource},e.ErrorCodeList=[0,7,15,23,29,42,36,99,100],i="number",a="string",s="boolean",l="TRUE",u="FALSE",v=[c="#NULL!",f="#DIV/0!",h="#VALUE!",p="#REF!",d="#NAME?",g="#N/A",m="#NUM!",y="#SPILL!",C="#CALC!"],e.ErrorList=v,e.BAND_INDEX_CONST=-2147483648,e.MAX_ROW_COUNT=1048576,e.MAX_COLUMN_COUNT=16384,b=n.Common.j,w=b.Ca,T=b.Fa,S=b.Ea,x=n.Common.k.ac,A=n.Common.q,I=parseInt,R=isNaN,M=n.Common.l,k=M.Ra,N=n.Common.u,O=n.Common.o,D=new n.Common.ResourceManager(e.SR,"CalcEngine"),e.sR=D.getResource.bind(D),e.getMapping=function(){return lt&&lt.resourceMapping},e.getBoolean=function(){var t=e.getMapping()&&e.getMapping().booleanMapping;return{boolean_true:t&&t.boolean_true||l,boolean_false:t&&t.boolean_false||u}},F=null,E=void 0,j=Math.abs,P=Math.exp,L=Math.log,G=Math.pow,B=Math.floor,_=Math.ceil,V={},e.BangSource=V,H={},e.RefErrorSource=H,e.missingArgument=undefined,z={},U=function(){function t(o){var n=t.nf(o);if(!n)throw e.sR().Exp_NotSupported;this._error=n.error,this._code=n.code}return t.prototype.toString=function(){var t=e.getMapping()&&e.getMapping().clacErrorMapping;return t&&t[this._error]||this._error},t.prototype.clone=function(){return new t(this._error)},t.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},t.parse=function(e){try{return new t(e)}catch(t){return E}},t.nf=function(t){var o,n;if(t)for(o=0;o<v.length;o++)if((n=v[o])===t||n===ft(t))return{error:n,code:e.ErrorCodeList[o]};return E},t}(),e.CalcError=U,W={Name:new U(d),Null:new U(c),DivideByZero:new U(f),NotAvailable:new U(g),Value:new U(h),Reference:new U(p),Number:new U(m),Spill:new U(y),Calc:new U(C)},e.Errors=W,q=W.Value,J=W.Reference,X=W.Number,Z=W.DivideByZero,Y=W.NotAvailable,K=W.Null,Q={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},$=function(){},e.ParserWrapper=$,tt=function(){function t(t,e){this.array=t,this.referenceInTwoDimension=e}return t.prototype.getRowCount=function(){return this.array.length},t.prototype.getColumnCount=function(){var t=this.array[0];return t&&t.length||0},t.prototype.getValue=function(t,e){var o,n=this.array,r=t;return"number"!=typeof e&&(r=(o=t).row,e=o.column),r<0||e<0||r>=n.length||e>=n[0].length?q:this.array[r][e]},t.prototype.getValueByIndex=function(t){var e=this.getColumnCount(),o=B(t/e),n=t%e;return this.getValue(o,n)},t.prototype.toArray=function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g;if(void 0===e&&(e=!0),0,u=0,c=[],p=z,l=(s=this).getRowCount())for(u=s.getColumnCount(),d=0;d<l;d++)for(e||(h=[],c.push(h)),g=0;g<u;g++){if(f=s.getValue(d,g),s.referenceInTwoDimension&&Tt(f)&&(f=f.getValueByIndex(0)),o&&bt(f))return(c=[f]).isError=!0,c;if(f=Ct(f,t,!1,i),n&&f===p)return(c=[f]).isConvertError=!0,c;e?c.push(f):h.push(f)}return c.rowCount=l,c.colCount=u,c.rangeCount=1,c},t.prototype.slice=function(e,o,n,r){var i,a,s,l=this,u=l.array,c=[];for(o=o<0?0:o,n=(e=e<0?0:e)+n>l.getRowCount()?l.getRowCount()-e:n,r=o+r>l.getColumnCount()?l.getColumnCount()-o:r,a=0;a<n;a++)for(i=[],c.push(i),s=0;s<r;s++)i.push(u[a+e][s+o]);return new t(c)},t}(),e.CalcArray=tt,et=["o","n","s","b","d"],ot=function(){function t(){}return t.jja=function(t){return bt(t)&&t._code===e.ErrorCodeList[5]},t.Nh=function(t){return isNaN(t)||!isFinite(t)?X:t},t.Ph=function(e,o,n,r,i,a,s,l){var u,c,f;if(e&&e.length&&e.rowCount&&e.colCount)return e;if(wt(e))(u=e.toArray(o,n,r,i,a)).isArray=!0;else if(Tt(e))(u=e.toArray(o,n,r,i,a,s,l)).isReference=!0;else if(w(e)){if(u=[],0===e.length)return u;if(w(e[0]))return t.Oh(e,o,!0);for(c=0;c<e.length;c++)(f=Ct(e[c],o,!1))===t.CalcConvertedError&&(u.isConvertError=!0),u.push(f);u.rowCount=1,u.colCount=e.length,u.rangeCount=1}else e=Ct(e,o,!0,a),r&&t.vf(e)?(u=[q]).isError=!0:e===t.CalcConvertedError?(u=[t.CalcConvertedError]).isConvertError=!0:n?(u=[]).push(e):(u=[[]])[0].push(e),u.rowCount=1,u.colCount=1,u.rangeCount=1;return u},t.Oh=function(e,o,n){var r,a,l,u,c,f,h,p,d,g,m,y,C;if(!e||!e.length||!e[0].length)return(r=[]).isError=!0,[[q]];if(0===o)return e;if(a=et[o],l=e.length,u=e[0].length,p={value:F},d=!1,g=!1,m=t.CalcConvertedError,!(r=e[a]))for(r=[],e[a]=r,y=0;y<l;y++)for(c=e[y],f=r[y]=[],C=0;C<u;C++)if(bt(h=c[C]))d||(r.isError=!0,d=!0),f.push(h);else{switch(o){case 1:case 5:n&&5!==o?dt(h,p)?h=p.value:(g||(g=!0,r.isConvertError=!0),h=0):typeof h===i||h instanceof Date||(g||(g=!0,r.isConvertError=!0),h=m);break;case 3:n?yt(h,p)?h=p.value:(g||(g=!0,r.isConvertError=!0),h=!1):typeof h!==s&&(g||(g=!0,r.isConvertError=!0),h=m);break;case 2:h=h===F||h===E?"":""+h}f.push(h)}return r},t.Rh=function(t){var o=gt(t);if(j(o)<1e21)return parseInt(""+o,10);throw e.sR().Exp_InvalidCast},t.Sh=function(t,e){return""!==t&&(!!dt(t,e)&&j(e.value)<1e21&&(e.value=parseInt(""+e.value,10),!0))},t.Vh=function(o){if(!o)return!1;if(typeof o===s)return o;if(o instanceof Date)return 0!==M.Ra(o);if(t.Na(o))return 0!==o;if(t.vf(o))return!1;throw e.sR().Exp_InvalidCast},t.bc=function(t){try{if(t===E||t===F)return"";if(typeof t===s)return t?l:u;if(typeof t===a)return t;if(t instanceof Date)return""+M.Ra(t);if(wt(t))throw e.sR().Exp_InvalidCast;return typeof t===i?""+O.Lma(t,lt.CALC_PRECISION||15):""+t}catch(t){throw e.sR().Exp_InvalidCast}},t.Wh=function(o){var n={value:F};if(t.Xh(o,n))return n.value;throw e.sR().Exp_InvalidCast},t.Xh=function(t,e){var o,r,s,l;if(t)if(t instanceof Date)e.value=new Date(t.valueOf());else if(typeof t===a){if(!(o=n.Common.l.Qa(t)))if(isNaN(t)){if(o=new Date(t),isNaN(o.valueOf()))return!1;try{if(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,s=N.ib(N.Db(t.replace(/ |\n/g,"")," ")," "),(l=r.exec(s))&&4===l.length&&(-1===l.indexOf(""+o.getFullYear())||-1===l.indexOf(""+o.getMonth())||-1===l.indexOf(""+o.getDate())))return!1}catch(t){return!1}}else if(!(o=n.Common.l.Xb(parseFloat(t))))return!1;e.value=o}else{if(typeof t!==i)return!1;e.value=n.Common.l.Xb(t)}else e.value=n.Common.l.Xb(0);return!0},t.CalcConvertedError=z,t.Ca=wt,t.Na=vt,t.vf=bt,t.Fh=Tt,t.wf=Ct,t.j$a=mt,t.Qh=pt,t.Pa=gt,t.Th=dt,t.Uh=yt,t}(),e.Convert=ot,function(t){t[t.unknow=0]="unknow",t[t.reference=1]="reference",t[t.number=2]="number",t[t.string=3]="string",t[t.boolean=4]="boolean",t[t.error=5]="error",t[t.array=6]="array",t[t.function=7]="function",t[t.name=8]="name",t[t.operator=9]="operator",t[t.parentheses=10]="parentheses",t[t.missingArgument=11]="missingArgument",t[t.expand=12]="expand",t[t.structReference=13]="structReference",t[t.field=14]="field",t[t.spillReference=33]="spillReference",t[t.letLocalName=100]="letLocalName"}(e.ExpressionType||(e.ExpressionType={})),nt=function(){function t(t){this.type=t}return t.prototype.sf=function(){return F},t.prototype.offset=function(t,e,o,n,r){return F},t.prototype.offsetWhenCopy=function(t,e,o,n,r,i,a,s,l,u){return F},t.prototype.getRange=function(t,e){var o,n=[];for(o=2;o<arguments.length;o++)n[o-2]=arguments[o];return F},t}(),e.Expression=nt,rt=function(){function t(t,e){var o=this;o.xf=t,e?(o.yf=e,o.zf=e.length):o.zf=1}return t.prototype.getRangeCount=function(){return this.zf},t.prototype.getSource=function(){return this.xf},t.prototype.create=function(e){return new t(this.xf,e)},t.prototype.toArray=function(t,e,o,n,r,i,a){var s=this.xf,l=s.referenceToArray;return l&&l.call(s,this,t,e,o,n,r,i,a)},t.prototype.getRow=function(t){return this.yf?this.yf[t||0].row:0},t.prototype.getColumn=function(t){return this.yf?this.yf[t||0].col:0},t.prototype.getRowCount=function(t){return this.yf?this.yf[t||0].rowCount:this.xf.getRowCount()},t.prototype.getColumnCount=function(t){return this.yf?this.yf[t||0].colCount:this.xf.getColumnCount()},t.prototype.getValue=function(t,e,o){var n,r,a;if(typeof t===i?(n=arguments[1],r=arguments[2],e=arguments[0]):(n=t.row,r=t.col),e=e||0,n>=0||r>=0){if(!(a=this.yf))return this.xf.getValue(n,r);if(e<a.length)return this.xf.getValue(n+a[e].row,r+a[e].col)}return J},t.prototype.getValueByIndex=function(t){var e=this.getColumnCount(),o=B(t/e),n=t%e;return this.getValue(0,o,n)},t.prototype.isHiddenRow=function(t,e,o){return this.xf.isHiddenRow(e+this.getRow(t),o)},t.prototype.isSubtotal=function(t,e,o){var n=this.xf;return 0===t&&e<n.getRowCount()&&o<n.getColumnCount()&&ht(n.getCalcSourceModel().ATa(e,o))},t}(),e.CalcReference=rt,it=function(){function t(e){this.id=t.sourceId++,this.Af=e,this.Bf=null}return t.prototype.getCalcService=function(){return this.Af},t.prototype.Cf=function(){return this.Af},t.prototype.setCalcService=function(t){this.Af=t},t.prototype.getCalcSourceModel=function(){return this.Bf},t.prototype.setCalcSourceModel=function(t){this.Bf=t},t.prototype.getValue=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];return F},t.prototype.getName=function(){return""},t.prototype.getField=function(t){return F},t.prototype.setValue=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.getReference=function(t){return new rt(this,t&&[t])},t.prototype.getSources=function(t){return[this]},t.prototype.referenceToArray=function(t,e,o,n,r,i,a,s){return t.toArray(e,o,n,r,i,a,s)},t.prototype.setFormula=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.setArrayFormula=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.getRowCount=function(){return 1e3},t.prototype.getColumnCount=function(){return 100},t.prototype.isHiddenRow=function(t,e){return!1},t.prototype.startCalculation=function(){},t.prototype.endCalculation=function(){},t.prototype.getCustomFunction=function(t){return F},t.prototype.getCustomName=function(t){return F},t.prototype.refresh=function(){},t.prototype.toJSON=function(t,e){var o,n=[];for(o=2;o<arguments.length;o++)n[o-2]=arguments[o]},t.sourceId=1,t}(),e.CalcSource=it,e.Hh=St,e.Ih=St(J),e.Jh=function(t,e){var o=new nt(7);return o.arguments=e,t instanceof nt?(o.function=t.function,o.functionName=t.functionName):(o.function=t.name&&t,o.functionName=t.name||t),o},e.createExpandExpression=function(t,e){var o=new nt(12);return o.value=t,o.needExpendIndexs=e,o},e.Kh=function(t,e,o){var n=new nt(9);return n.operatorType=t,n.value=e,n.value2=o,n},e.Lh=function(t){var e=new nt(10);return e.value=t,e},e.createStringExpression=function(t){var e=new nt(3);return e.value=t,e},e.createNumberExpression=function(t){var e=new nt(2);return e.value=t,e},e.createBooleanExpression=function(t){var e=new nt(4);return e.value=t,e},at=function(){function t(){}return t.Yh=function(t,e){var o=16777216;return!!(t===e||j(t-e)<j(t)/(o*o))||(t=O.Lma(t,15),e=O.Lma(e,15),j(t-e)<j(t)/(o*o))},t.getArrayValue=function(t,e,o){return t?e<t.getRowCount()&&o<t.getColumnCount()?t.getValue(e,o):o>=t.getColumnCount()&&1===t.getColumnCount()&&e<t.getRowCount()?t.getValue(e,0):e>=t.getRowCount()&&1===t.getColumnCount()&&o<t.getColumnCount()?t.getValue(0,o):q:q},t.tryExtractToSingleValue=function(t){var e,o=!0;return(Tt(t)||wt(t))&&((e=ot.Ph(t,0,!1,!0)).isError?t=e[0]:1===e.rowCount&&1===e.colCount?t=e[0][0]:(t=e,o=!1)),{value:t,success:o}},t}(),e.Zh=at,e.charAtFunc=xt,st=function(){function t(t){this.Di=t}return t.prototype.$j=function(t){var e,o,n,r,i,a,s,l,u=this.Di;if(b.Ca(u)||(u=[u]),-1===u[0])return!0;for(e=0;e<u.length;e++)if(n=void 0,r=void 0,It(o=u[e])){for(i=o.split(" && "),a=!0,s=0;s<i.length;s++)n=(l=i[s].split(" "))[0],r=I(l[1]),"!="===n&&t!==r||">"===n&&t>r||">="===n&&t>=r||"%="===n&&t%2===r||(a=!1);if(a)return!0}else if(t===o)return!0;return!1},t.prototype._j=function(){return this.Di},t}(),e.iEc=Rt,function(t){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C;function v(){var e,o,n=t.bi,r=t.ci,i=[];for(e in n)i.push(n[e]);for(o in r)i.push(r[o]);return i}function w(n,r,i){var a,s,l;if(T(n))throw e.sR().Exp_InvalidFunctionName;if(n=n.toUpperCase(),t.bi[n])throw e.sR().Exp_InvalidOverrideFunction;if(a=t.bi[n]){if(!i||!i.override)throw e.sR().Exp_OverrideNotAllowed}else t.bi[n]=a=new o(n,0,255);return r&&"function"==typeof r&&(a.evaluate=r),"function"==typeof i.argsValidator&&(s=a.gEc,a.gEc=function(t,e,o){s(t,e,o),i.argsValidator(t,e,o)}),"function"==typeof i.subExpressionValidator&&(l=a.hEc,a.hEc=function(t,e){l(t,e),i.subExpressionValidator(t,e)}),b.H(i,(function(t,e){var o;S(t,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])>=0?(o=new st(e),a[t]=function(t){return o.$j(t)}):S(t,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])>=0?(o=new st(e),a[t]=function(){return o._j()}):i.hasOwnProperty(t)&&(a[t]=e)})),a}function M(t){return t%400==0||t%4==0&&t%100!=0||1900===t}function N(t,e){switch(e){case 0:case 2:case 4:return 360;case 1:return g(t.getFullYear())?366:365;case 3:return 365;default:return-1}}function D(t,e){return t-e}function V(t,e){return S(e,[0,2,4,6,7,9,11])>=0?31:S(e,[3,5,8,10])>=0?30:1===e?g(t)?29:28:void 0}function H(t,e,o,n){var r,i,a=o.getFullYear(),s=o.getMonth(),l=o.getDate(),u=n.getFullYear(),c=n.getMonth(),f=n.getDate();return t?(r=2===s&&m(a,s)===l,i=2===c&&m(u,c)===f,e?(r&&(l=30),i&&(f=30)):r&&i&&(l=30,f=30),31===f&&l>=30&&(f=30)):31===f&&(f=1,e&&c++),31===l&&(l=30),360*(u-a)+30*(c-s)+f-l}function W(t,e,o){var n,r=1;return D(t,e)>0&&(n=t,t=e,e=n,r=-1),S(o,[1,2,3])>=0?r*l(k(e)-k(t)):S(o,[4,5])>=0?r*H(!1,5===o,t,e):r*H(!0,6===o,t,e)}function J(t,o,n,r,i){var a,s,l,u,c,p,d,g,m,y,C,v,b,w,S=n<100,A=2===n||102===n,I=A||3===n||103===n,R=5===n||105===n,M=4===n||104===n||R,k=9===n||109===n,N=1===n||101===n||k||r,O=6===n||106===n,D=O?1:0,F=!1,E=0;for(a=0;a<x(t);a++){if(y=t[a],C=void 0,I?C=f(y,0,!1,!1,!1,A):(v=1,(!e.ExcelCompatibleCalcMode||wt(y)||Tt(y))&&(v=5),C=f(y,v,!1,!1,!1,!0)),C.isError)return C[0];if(C.isConvertError)return q;for(b=C.rangeCount,w=C.isReference,s=0;s<b;s++)for(l=b>1?C[s]:C,w&&(u=y.getRow(s),c=y.getColumn(s)),p=0;p<x(l);p++)if(2===o||!w||!y.isHiddenRow(s,p,S))for(g=l[p],d=0;d<x(g);d++)if(!(1!==o&&2!==o&&w&&y.isSubtotal(s,p+u,d+c)||(m=g[d],null===m||m===z))){if(m&&m._error&&!I)return i&&(i.sumx=0,i.sumx2=0,i.n=0),m;I&&!T(m)&&(!A||""!==m&&ot.Na(m,!0))?D++:M&&(!F||R&&m<D||!R&&m>D)?D=m:N?r?(i.sumx+=m,i.sumx2+=m*m,i.n++,i.values.push(m),i.values[0]!==m&&(i.allSame=!1)):(D+=m,E++):O&&(D*=m,E++),F=!0}}return N?k?D:r?void 0:0===E?Z:h(D/E):O?h(E>0?D:0):D}function Q(t,e,o){var n,r,i=o%100,a=7===i||8===i,s=7===i||10===i?1:0,l={sumx:0,sumx2:0,n:0,values:[],allSame:!1},u=J(t,e,o,!0,l);if(u&&u._error)return u;if(l.n<=s)return Z;if(l.allSame)u=0;else if(d(l.n*l.sumx2,l.sumx*l.sumx))for(u=0,n=l.sumx/l.n,r=0;r<l.n;r++)u+=G(l.values[r]-n,2);else u=l.sumx2-l.sumx*l.sumx/l.n;return u/=l.n-s,h(a?Math.sqrt(u):u)}function $(t){var e=t.charCodeAt(0);return e>=0&&e<129||63728===e||e>=65377&&e<65440||e>=63729&&e<63732?"singleByte":e>=55296&&e<=57343?"fourByte":"doubleByte"}function et(t){var e,o=[];for(e=0;e<t.length;e++)T(t[e])?(o[e]=t[e+1],e++):o[e]=t[e];return o.length===t.length-1&&(o[o.length]=E),o}function nt(t,e){var o,n;for(void 0===e&&(e=!0),o=[],n=0;n<x(t);n++)lt(t[n],o,e);return o}function it(t){t.sort((function(t,e){return t-e}))}function lt(t,e,o){var n,r;for(void 0===o&&(o=!0),n=0;n<x(t);n++)(r=t[n])!==z&&e.push(r);o&&it(e)}function ut(t,e,o){var n,r=[];return lt(e,r),n=x(r),o<1||n<o?X:(o=t?_(o):B(o),t?r[n-o]:r[o-1])}function ht(t,e){var o,n,r;return t=f(t,1,!0,!0,!1,!0),e=u(e),t.isError?t[0]:t.isConvertError||R(e)?q:(lt(t,o=[]),!x(o)||e<0||e>1?X:(r=(n=e*(x(o)-1))%1,n=I(""+n),0===r?o[n]:u(o[n])+r*(u(o[n+1])-u(o[n]))))}function pt(t,e){var o,n,r,i,a,s,l=x(t),u=[];for(o=0;o<l;o++)c(t[o],!0)&&u.push(t[o]);return u.length?(n=u.length,it(u),i=(r=e*(n+1)-1)%1,r<0||n-1<r?X:(s=u[a=B(r)],0===i?s:s+i*(u[a+1]-s))):X}function dt(t,e){var o=13===e,n=14===e,r=15===e,i=16===e,a=17===e,s=18===e,l=19===e;return 12===e?function(){var t,e,o,n=[];for(t=0;t<arguments.length;t++)n[t]=arguments[t];return e=nt(arguments[0]),0===(o=x(e))?X:o%2==0?(u(e[o/2-1])+u(e[o/2]))/2:e[I(""+o/2)]}(t):o?function(){var t,e,o,n,r,i,a,s,l=[];for(t=0;t<arguments.length;t++)l[t]=arguments[t];for(e=F,o=0,n=nt(arguments[0],!1),r=x(n),i=0;i<r;i++){for(s=0,a=0;a<r;a++)a!==i&&n[a]===n[i]&&s++;s>o&&(o=s,e=n[i])}return 0===o?Y:e}(t):n?function(t,e){return ut(!0,t,e)}(t[0],t[1]):r?function(t,e){return ut(!1,t,e)}(t[0],t[1]):i?ht(t[0],t[1]):a?function(t,e){var o=S(e,[0,1,2,3,4]);return o<0?X:ht(t,.25*o)}(t[0],t[1]):s?pt(t[0],t[1]):l?function(t,e){var o=S(e,[1,2,3]);return o<0?X:pt(t,.25*(o+1))}(t[0],t[1]):K}function gt(t,e,o){var n;return 0===t?n=e<=o:1===t?n=e>=o:2===t?n=e!==o:3===t?n=e<o:4===t?n=e===o:5===t&&(n=e>o),n}function mt(t,o){var r,i,a=-1,l=!0,u={value:0},f=A.zb(o);if(4!==t&&2!==t||!f||((i=o.replace(/\*+/g,"*"))!==o&&(f=A.zb(i)),r=function(e){if(""===e)return 2===t;var o=A.sb(f);return o.lastIndex=0,4===t?o.test(e):!o.test(e)}),4===t&&n.Common.F(o,Date))return function(t,e){var n={value:null};return!(!t||!ot.Xh(t,n))&&n.value.getTime()===o.getTime()};return T(o)?a=0:f||function(t){return 0===(""+t).trim().length}(o)||R(parseFloat(o))||!s(o,u)?l=!1:a=u.value,function(n,i){var u,h;return(""!==o||4===t||2===t)&&!(!i&&n instanceof U)&&(T(n)&&(n=""),u={value:0},!(e.ExcelCompatibleCalcMode&&l&&!c(n,!0)&&4!==t&&2!==t)&&(l&&s(n,u)?""===n?2===t:gt(t,u.value,a):f&&c(n,!0)?2===t:(h=T(o)?"":(""+o).toUpperCase(),f&&r?r(""+n):gt(t,(""+n).toUpperCase(),h))))}}!function(t){t[t.normal=0]="normal",t[t.allwaysExpand=1]="allwaysExpand",t[t.neverExpand=2]="neverExpand"}(t.ArrayArgumentEvaluateMode||(t.ArrayArgumentEvaluateMode={})),o=function(){function t(t,e,o,n){void 0===e&&(e=0),void 0===o&&(o=0),this.name=t,this.minArgs=e,this.maxArgs=o;this.$h=n,this.typeName=""}return t.prototype.description=function(){var t=this,o=e.sR()._h;return t.$h?t.$h:o&&o[t.name]},t.prototype.acceptsArray=function(t){return!1},t.prototype.acceptsReference=function(t){return!1},t.prototype.acceptsError=function(t){return!1},t.prototype.acceptsMissingArgument=function(t){return!1},t.prototype.isVolatile=function(){return!1},t.prototype.isContextSensitive=function(){return!1},t.prototype.isBranch=function(){return!1},t.prototype.findTestArgument=function(){return-1},t.prototype.findBranchArgument=function(t){return-1},t.prototype.expandRows=function(){return!0},t.prototype.expandColumns=function(){return!0},t.prototype.skipPrecedent=function(t){return!1},t.prototype.returnReference=function(){return!1},t.prototype.evaluate=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.evaluateWithContext=function(t,e){var o=this,n=e;return o.isContextSensitive()&&(n=[t].concat(n)),o.evaluate.apply(o,n)},t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==E&&(this[e]=t[e])},t.prototype.gEc=function(t,o,n){if(n<t||n>o)throw e.sR().Exp_FormulaInvalid},t.prototype.hEc=function(t,e){Rt(t)},t.ai=function(e,o,n){var r,i=new t(e,0,255);if(o&&"function"==typeof o&&(i.evaluate=o),n)for(r in n)n.hasOwnProperty(r)&&"override"!==r&&(i[r]=n[r]);return i},t}(),t.Function=o,r=function(t){function e(e,o,n,r){return t.call(this,e,o,n,r)||this}return ct(e,t),e.prototype.isContextSensitive=function(){return!0},e.prototype.evaluate=function(t,e){return this.evaluateAsync.apply(this,arguments)},e.prototype.evaluateAsync=function(t,e){this.evaluate.apply(this,arguments)},e.prototype.defaultValue=function(){return 0},e.prototype.evaluateMode=function(){return 0},e.prototype.evaluateWhenArgumentsIsSame=function(){return!0},e.prototype.interval=function(){return 1e4},e}(o),t.AsyncFunction=r,t.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},t.bi={},t.ci={},t.defineGlobalCustomFunction=function(e,o){return o.name=ft(o.name),t.ci[ft(e)]=o,o},t.findGlobalFunction=function(o){var n,r,i;return o?(o=ft(o),n=t.bi,r=t.ci,i=e.getMapping()&&e.getMapping().builtInFunctionsMapping,n&&(function(e,o){var n,r=t.bi;if(!T(e))for(n in e)if(e[n].alias===o)return r[n];return E}(i,o)||n[o])||r&&r[o]):v()},t.findGlobalFunctions=function(){return v()},t.removeGlobalFunction=function(e){if(!e)return t.bi={},void(t.ci={});e=ft(e);var o=t.bi,n=t.ci;o[e]?delete o[e]:n[e]&&delete n[e]},i=e.sR().Exp_Format,a=function(){function e(t,e,o){this.Ri=t,this.Si=e,this.kja=o||"i"}return e.prototype.Pi=function(){return this.Ri},e.prototype.Qi=function(){return this.Si},e.prototype.lja=function(){return this.kja},e.prototype.bc=function(e){e=e||"i";var o=this.Ri,n=this.Si,r="",i=t.CALC_PRECISION;return i&&(o=O.Lma(o,i),n=O.Lma(n,i)),0===o&&0!==n||(r+=""+o),-1===n?r+="-":0!==o&&n>0&&(r+="+"),-1!==n&&0!==n&&1!==n&&(r+=""+n),0!==n&&(r+=e),r},e}(),t.Ui=a,t.Wi=function(t){try{return t?"number"==typeof t?new a(t,0):"string"==typeof t?function(t){var o,n,r,s,l=0,u=0,c=!1,f=0,h=0,p=0,d=t.length;if(!t)throw e.sR().Exp_ArgumentNull;if(0===d)throw i;if(p<d&&("+"===xt(t,p)||"-"===xt(t,p))&&p++,p=(s=At(t,p)).mi,o=s.Vi,p<d&&("+"===xt(t,p)||"-"===xt(t,p))?(f=p,p=(s=At(t,++p)).mi,n=s.Vi,p<d&&("i"===xt(t,p)||"j"===xt(t,p))&&(r=xt(t,p),p++,c=!0),h=p-f):p<d&&("i"===xt(t,p)||"j"===xt(t,p))?(r=xt(t,p),h=++p,n=o,c=!0,o=!1):f=p,p<d)throw i;if(f>0){if(!o)throw i;l=parseInt(t.substr(0,f),10)}if(h>0){if(!c)throw i;if(1===h||2===h&&"+"===xt(t,f))u=1;else if(2===h&&"-"===xt(t,f))u=-1;else{if(!n)throw i;u=parseInt(t.substr(f,h-1),10)}}return new a(l,u,r)}(t):null:new a(0,0)}catch(t){return null}},s=ot.Th,l=ot.Rh,u=ot.Pa,c=ot.Na,f=ot.Ph,h=ot.Nh,p=ot.vf,d=at.Yh,t.ak=function(t,e,o,n,r,i,a,s,l){return s||(s={}),o!==E&&(s.minArgs=o),n!==E&&(s.maxArgs=n),i!==E&&(s.acceptsReference=i),a!==E&&(s.acceptsArray=a),r!==E&&(s.Ci=r),s.bk!==E&&(s.acceptsMissingArgument=s.bk),s.ck!==E&&(s.isVolatile=s.ck),s.dk!==E&&(s.isContextSensitive=s.dk),s.KMc!==E&&(s.skipPrecedent=s.KMc),s.fk!==E&&(s.arrayArgumentEvaluateMode=s.fk),s.gk!==E&&(s.acceptsError=s.gk),l!==E&&(s.isDynamicArrayFunction=l),w(t,e,s)},t.hk=179769e303,t.ik=function(t){return"boolean"==typeof t},t.jk=It,t.Na=function(t){return"number"==typeof t},t.kk=M,g=M,t.lk=N,t.mk=D,t.nk=V,m=V,t.pk=W,t.qk=function(t){var e,o,n;return 0===t?o=0:(n=.5*j(t))>=3?o=1:n<1?o=((((((((.000124818987*(e=n*n)-.001075204047)*e+.005198775019)*e-.019198292004)*e+.059054035642)*e-.151968751364)*e+.319152932694)*e-.5319230073)*e+.797884560593)*n*2:o=(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,t>0?.5*(o+1):.5*(1-o)},t.Hfc=J,t.sk=Q,t.mja=function(t,e,o,n){var r,i,a,s,c,h,d,g,m,y,C,v,b;if(null===o)return q;if((o=parseInt(o,10))<=0||o>19)return q;function w(t){var e,n,l,u,h,d,g,m,y,C,v,b=[];if((e=f(t,c?0:5,!1,!1,!1,!1)).isConvertError)return q;for(C=e.rangeCount,v=e.isReference,n=0;n<C;n++)for(l=C>1?e[n]:e,v&&(u=t.getRow(n),h=t.getColumn(n)),d=0;d<x(l);d++)if(!(v&&t.isHiddenRow(n,d,!1)&&r))for(m=l[d],g=0;g<x(m);g++)if(!(v&&i&&t.isSubtotal(n,d+u,g+h)||(y=m[g],null===y||a&&p(y)||p(y)&&s))){if(!a&&p(y)&&3!==o)return y;"object"==typeof y&&0===Object.keys(y).length||b.push(y)}return b}if(e||(e=0),r=1===e||3===e||5===e||7===e,i=1===e||2===e||3===e||0===e,a=2===e||3===e||6===e||7===e,c=(s=2===o)||3===o,h=12===o,d=13===o,g=14===o||15===o||16===o||17===o||18===o||19===o,m=[],y=x(t),g){if(2!==y)return q;if((m=w(t[0]))._error)return m;if(C=void 0,t[1]===F)return X;if(t[1]instanceof rt)C=function(t){var e,o=t.getRow(0),r=t.getColumn(0),i=t.getRowCount(0),a=t.getColumnCount(0);if(1===i&&1===a)e=t.getValue(0,0,0);else if(1!==i&&1===a&&o<=n.row&&n.row<o+i)e=t.getValue(0,n.row-o,0);else{if(!(1===i&&1!==a&&r<=n.column&&n.column<r+a))return q;e=t.getValue(0,0,n.column-r)}return e===F||""===e?X:isNaN(parseInt(e,10))?q:parseFloat(e)}(t[1]);else if(t[1]instanceof tt)C=t[1].array[0][0];else{if(isNaN(parseInt(t[1],10)))return q;C=u(t[1])}return C._error?C:(17!==o&&19!==o||(C=l(C)),dt([m,C],o))}for(v=0;v<y;v++)if(!(t[v]instanceof rt))return q;for(v=0;v<y;v++){if(!((b=w(t[v]))instanceof Array))return b;m.push.apply(m,b)}return h||d?dt([m],o):7===o||8===o||10===o||11===o?Q(m,i?1:0,o):J(m,1,o)},t.UAb=$,t.WAb=et,t.VAb=function(t){var e,o,n,r=[],i=0,a=0;for(o=0;o<t.length;o++){if(e=t[o],"doubleByte"===(n=$(t[o]))||"fourByte"===n)if("fourByte"===n){if(i%2==0){i++;continue}a++,i++,e=t[o-1]+t[o]}else a++,e=t[o];r[o-(i>0?i/2:0)+a]=e}return et(r)},t.sja=dt,t.tk=function(t){var e,o=1;for(e=t;e>1;e--)o*=e;return o},t.uk=function(t,e,o){var n=t.getDate(),r=e.getDate(),i=t.getMonth(),a=e.getMonth(),s=t.getFullYear(),l=e.getFullYear();return n=31===n?30:n,o?r=31===r?30:r:31===r&&(n<30?(r=1,++a>12&&(a=1,l++)):r=30),30*(12*(l-s)+a-i)+r-n},t.vk=function(t,e,o){return o<0||o>4?X:function(t,e,o){var n,r,i,a,s,c,f,h,p=W(t,e,o);return p<0&&(p=-p,r=t,t=e,e=r),1===o?(i=t.getFullYear(),a=e.getFullYear(),s=void 0,c=void 0,f=void 0,h=void 0,(s=new Date(t.valueOf())).setFullYear(s.getFullYear()+1),D(e,s)>0?(h=a+1-i,s=new Date(i,0,1),c=new Date(a+1,0,1),f=l(k(c)-k(s))-365*(a+1-i)):(h=1,f=g(i)&&t.getMonth()<2||g(a)&&256*e.getMonth()+e.getDate()>=285?1:0),n=365+u(f)/u(h)):n=N(new Date,o),p/n}(t,e,o)},y={},C=function(){function e(){}return e.wk=function(t){var e=B(t);return d(t,e+1)?e+1:e},e.xk=function(t){var e,o,n,r,i,a=t,s=y;if(s||(y=s={}),e=s[a])return e;if(c(t))return s[a]=mt(4,t);for("=><",o=T(t)?"":(""+t).toUpperCase(),n="\0",r=0;r<2&&r<x(o);r++){if(i=o[r],-1==="=><".indexOf(i)){if("<"===n)return s[a]=e=mt(3,o.substring(1)),e;if(">"===n)return s[a]=e=mt(5,o.substring(1)),e;break}if("="===i)return e="<"===n?mt(0,o.substring(2)):">"===n?mt(1,o.substring(2)):mt(4,"\0"===n?o.substring(1):t),s[a]=e,e;if("\0"===n)n=i;else{if("<"===n)return e=">"===i?mt(2,o.substring(2)):mt(3,o.substring(1)),s[a]=e,e;if(">"===n)return s[a]=e=mt(5,o.substring(1)),e}}return s[a]=e=mt(4,t),e},e.yk=function(t){var e=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][t];return t>308&&(t=308),T(e)?G(10,parseFloat(t)):e},e.zk=function(t){var e=_(t);return d(t,e-1)?e-1:e},e.Ak=function(t,o){var n,r,i=e.yk(j(o)),a=_,s=B;return n=(t=o<0?t/i:t*i).toExponential(),(r=I(n.split("e")[1])+1)<=15&&r>=-85&&(t=parseFloat(t.toFixed(15-r))),t=t<0?a(t-.5):s(t+.5),h(t=o<0?t*i:t/i)},e.Bk=function(t,e){var o,n;if(t<0||e<0||t<e)return X;for(o=1,e=Math.min(t-e,e),n=1;n<=e;n++)o*=t-n+1,o/=n;return h(o)},e.YDc=function(t,e){if(t<0&&j(e)<1){var o=(1/e).toPrecision(15);if(parseFloat(o)===parseInt(o,10)&&parseInt(o,10)%2!=0)return-G(-t,e)}return G(t,e)},e.Ck=function(e,o){var n=j(e)>.5?G(1+e,o):P(o*L(1+e));return isFinite(n)?R(n)&&(n=5e-324):n===Number.POSITIVE_INFINITY?n=t.hk:n===Number.NEGATIVE_INFINITY&&(n=-t.hk),n},e.Dk=function(t,e){return(P(t)+(e?-1:1)*P(-t))/2},e.Ek=function(t,e){return R(t)?t:R(e)?e:1!==e&&1===t||0!==e&&e!==Number.POSITIVE_INFINITY?L(t)/L(e):NaN},e}(),t.MathHelper=C}(lt||(lt={})),e.Functions=lt,e.gOb=function(t,e,o){var r,i,l,u,c,f,h,p,d,g;if(void 0===o&&(o=!0),bt(t))return t;if(bt(e))return e;if(l=typeof e===s,(i=typeof t===s)||l)r=i&&l?t===e?0:t>e?1:-1:i?1:-1;else{if(c=typeof e===a,h=(f=(u=typeof t===a)||c)?"":0,t=t===F||t===E?h:t,e=e===F||e===E?h:e,p=function(){var r,i;if(t===e)return 0;if(u&&c){r=void 0;try{r=(i=n.Common.CultureManager.getCultureInfo()).localeCompare?o?i.localeCompare(t,e):i.localeCompare(t.toUpperCase(),e.toUpperCase()):o?t.localeCompare(e):t.toUpperCase().localeCompare(e.toUpperCase())}catch(n){r=o?t.localeCompare(e):t.toUpperCase().localeCompare(e.toUpperCase())}return r}return u?1:c?-1:(t=O.Lma(t,15),e=O.Lma(e,15),t-e)},!f){if(g={value:0},!dt(t,d={value:0})||!dt(e,g))return q;t=d.value,e=g.value}r=p()}return r},ut=function(t){function e(e){var o=t.call(this,F)||this;return o.u4=e,o}return ct(e,t),e.prototype.startCalculation=function(){},e.prototype.endCalculation=function(){},e.prototype.getValue=function(){return W.Reference},e.prototype.getReference=function(){var t=new rt(this,[Mt(0,0)]);return t.getValue=function(){return W.Reference},t},e.prototype.referenceToArray=function(){var t=[W.Reference];return t.isError=!0,t},e.prototype.getName=function(){return this.u4},e.prototype.setValue=function(){},e}(it),e.ErrorSource=ut},"./src/calc.entry.ts":function(t,e,o){"use strict";var n,r;function i(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),i(o("./src/calc.common.ts")),i(o("./src/Parser.ts")),i(o("./src/evaluator.ts")),i(o("./src/calc.ts")),i(o("./src/referenceExpression.ts")),n=o("./src/calc.ts"),Object.defineProperty(e,"supportRowColumnFormula",{set:function(t){n.supportRowColumnFormula=t},get:function(){return n.supportRowColumnFormula}}),Object.defineProperty(e,"approximatelyEqual",{set:function(t){n.approximatelyEqual=t},get:function(){return n.approximatelyEqual}}),r=o("./src/calc.common.ts"),Object.defineProperty(e,"ExcelCompatibleCalcMode",{set:function(t){r.ExcelCompatibleCalcMode=t},get:function(){return r.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function z(t,e){var o,n,r,i,a,s;if(t)for(o in t)if(n=+o,r=t[o])for(i in r)a=+i,(s=r[i])&&e.setValue(n,a,s.value,s.oldValue,!0!==s.isAnchorCell)}function U(t,e){var o=e.split(",").map((function(t){return+t})),n=o[0],r=o[1],i=t[n];return i&&i[r]}function W(t,e,o){if(t){var n=o.anchors,r={};t.forEach((function(t){var i,a,s,l,u,c,f,h,p=t.row,d=t.col,g=function(t,e){return[t,e].join(",")}(p,d);for(e.Ag(p,d,1,1),r[g]=!0,i=t.rowCount,a=t.colCount,s=1,l=0;l<i;l++){for(;s<a;s++)if(u=o.getAnchorItem(l+p,s+d))for(f in c=u.anchorRefs)g!==f&&c[f]&&((h=U(n,f))&&!r[f]&&(e.Ag(h.row,h.col,1,1),r[f]=!0));s=0}}))}}function q(t,e,o,n,r,i){(function(t,e){return!(A(t)&&A(e)||!A(t)&&!A(e)&&Object.keys(t).join()===Object.keys(e).join())})(t.kOb,t.eOb)&&(t.kOb&&(X(o,t,t.kOb,!1),delete t.kOb),t.eOb&&(t.delay=X(o,t,t.eOb,!0,i),t.kOb=t.eOb,delete t.eOb))}function J(t,e,o,n,r,i,a,s,l){var u,c,f,h=0;for(u=o;u<=r;u++)for(c=n;c<=i;c++)f=e.qg(u,c,!0),a&&f&&f.lWc(0,t,s),l&&f&&f.$l&&h++;return h}function X(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,d,g=0;for(i in o)if(o.hasOwnProperty(i)){if(a=!1,s=o[i],!(l=t.jh[s.id]))continue;u=s.row,c=s.col,p=u+(f=s.rowCount)-1,d=c+(h=s.colCount)-1,l&&ot(u,c,f,h)&&(l.ug(!0).Jg(u,c,f,h,e,n,!0),a=!0),!l||a&&!r||(g+=J(e,l,u,c,p,d,!a,n,r))}return g}function Z(t,e){var o,n,r;for(o in t)(n=t[o])&&(e?Z(n):(r=n.calc)&&r.ng())}function Y(t){var e,o;for(e=0;e<t.length;e++)if((o=t[e].expr)&&7===o.type&&"LET"===o.functionName)return!0;return!1}function K(t,e,o,n,l,u,c){var f,h,g,b,w,T,S,x,I,R,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,et,ot,nt,rt,it,at,st,lt,ut=t.row,ct=t.column,ft=[],ht=0,pt=t.arrayIdentity?t.arrayIdentity.row:ut,dt=t.arrayIdentity?t.arrayIdentity.col:ct;for(ft[ht]={expr:e,acceptsArray:u||!1,acceptsRef:c||!1,index:-1},f=0,h=0,g=!1,w=n,T=l,S=!1;ht>=0;){if(x=ft[ht],ht--,I=x.acceptsArray,R=x.acceptsRef,e=x.expr,O=p,e)if(7===e.type){if(V=(_=e).arguments.length,!_.function){if(!t){O=r.Hh(m);continue}_.function=t.getFunction(_.functionName)}if(H=_.function,z=x.index,B=x.neeedExpendindexs,z<0?(x.arrayArgumentEvaluateMode=S,x.arrayFormulaCatchValue=o,H&&H.arrayArgumentEvaluateMode&&(S=H.arrayArgumentEvaluateMode),x.args=[]):(H&&H.acceptsArray(z)?f--:g&&(B||(B=[],x.neeedExpendindexs=B),_.arguments[z],B.push(z)),x.args.push(D)),z===V-1){if(S=x.arrayArgumentEvaluateMode,o=x.arrayFormulaCatchValue,W=!1,(U=x.args)&&U.length>0)for(q=0;q<U.length;q++)if(U[q]!==_.arguments[q]){W=!0;break}O=W?r.Jh(_,U):e,B&&B.length>0&&(O=r.createExpandExpression(O,B),g=!0)}else 0===z&&H&&3===H.arrayArgumentEvaluateMode&&3===S&&(S=0),g=!1,z++,x.index=z,H&&H.acceptsArray(z)&&f++,ft[++ht]=x,ft[++ht]={expr:_.arguments[z],acceptsArray:!!H&&H.acceptsArray(z),acceptsRef:!!H&&H.acceptsReference(z),index:-1}}else if(1===e.type&&e.sf())h&&(j=(E=e.source!==r.BangSource&&e.source||t.source).getRowCount(),P=E.getColumnCount(),L=(L=e.rowRelative?(e.row+pt)%r.MAX_ROW_COUNT%j:e.row)<0?L+j:L,G=(G=e.columnRelative?(e.column+dt)%r.MAX_COLUMN_COUNT%P:e.column)<0?G+P:G,e=i.rf(e.source&&E,p,L,G,!1,!1));else if(1===e.type||13===e.type){if(13===e.type){if(F=(J=e).getRange(ut,ct),J.tzb(ut,ct,t.source.id),!F){J._error?(delete J._error,O=D=y,t.iOb=1):(O=e,D=e);continue}e=i.uf(J.source===t.source?p:J.source,p,F.row,F.col,F.row+F.rowCount-1,F.col+F.colCount-1)}X=e.source!==r.BangSource&&e.source,Z=e,h&&(E=X||t.source,j=r.MAX_ROW_COUNT,P=r.MAX_COLUMN_COUNT,Y=Z.rowRelative?(Z.row+pt)%j:Z.row,K=Z.columnRelative?(Z.column+dt)%P:Z.column,ot=void 0,(Y=Y<0?Y+j:Y)>(Q=(Q=Z.endRowRelative?(Z.endRow+pt)%j:Z.endRow)<0?Q+j:Q)&&(ot=Y,Y=Q,Q=ot),(K=K<0?K+P:K)>(et=(et=Z.endColumnRelative?(Z.endColumn+dt)%P:Z.endColumn)<0?et+P:et)&&(ot=K,K=et,et=ot),Y>=(j=E.getRowCount())?(Y%=j,Q%=j):Q>=j&&(Q=j-1),K>=(P=E.getColumnCount())?(K%=P,et%=P):et>=P&&(et=P-1),e.row===r.BAND_INDEX_CONST&&(Y=Q=r.BAND_INDEX_CONST),e.column===r.BAND_INDEX_CONST&&(K=et=r.BAND_INDEX_CONST),e=i.uf(X,e.endSource,Y,K,Q,et,!1,!1,!1,!1)),R&&(I||!o&&1!==S&&3!==S)||ut<0||ct<0||4===S||(f>0&&!o&&1!==S&&3!==S||0===f||2===S?(F=Z.getRange(ut,ct),o||(R||I)&&1===S?!Z.isFullColumn&&1!==F.rowCount&&w>=F.rowCount||!Z.isFullRow&&1!==F.colCount&&T>=F.colCount?O=r.Hh(v):(L=(Z.isFullColumn?0:F.row)+(1===F.rowCount?0:w),G=(Z.isFullRow?0:F.col)+(1===F.colCount?0:T),O=i.rf(X,e.endSource,L,G,!1,!1)):F.rowCount>1&&F.colCount>1||F.rowCount>1&&!Z.isFullColumn&&(ut<F.row||ut>=F.row+F.rowCount)||F.colCount>1&&!Z.isFullRow&&(ct<F.col||ct>=F.col+F.colCount)?O=r.Hh(C):(L=Z.isFullColumn||F.rowCount>1?ut:F.row,G=Z.isFullRow||F.colCount>1?ct:F.col,O=i.rf(X,e.endSource,L,G,!1,!1))):g=!0)}else if(9===e.type)nt=e.operatorType>=15,o&&A(e.value2)&&(nt=I=!1),-1===x.index?(x.index=e.value2?0:1,ft[++ht]=x,ft[++ht]=$(e.value,nt,nt,-1)):0===x.index?(D!==e.value&&(O=r.Kh(e.operatorType,D,e.value2),x.expr=O),g&&((B=[]).push(0),x.neeedExpendindexs=B,g=!1),x.index=1,ft[++ht]=x,ft[++ht]=$(e.value2,nt,nt,-1)):(O=e.value2&&D!==e.value2?r.Kh(e.operatorType,e.value,D):A(e.value2)&&D!==e.value?r.Kh(e.operatorType,D,d):e,B=x.neeedExpendindexs,g&&(B?B.push(1):B=[e.value2&&e.value2===b?1:0]),B&&(O=r.createExpandExpression(O,B),g=!0));else if(10===e.type)-1===x.index?(x.index=0,ft[++ht]=x,ft[++ht]=$(e.value,I,R,-1)):e.value!==D&&(O=r.Lh(D));else if(8===e.type)1===x.index?(h--,O=D,x.context&&(t=x.context)):(h++,ft[++ht]=$(e,I,R,1,t),rt=void 0,it=t,at=void 0,e.source?(at=e.source===r.BangSource?t.source:e.source,(it=new s.EvaluateContext(at)).cloneFrom(t),rt=at.getCustomName(e.value)):(rt=t.getName(e.value),t.source.getCustomName(e.value)||(it=new s.GloableEvaluateContext(t.source)).cloneFrom(t)),rt||(rt=r.Hh(m)),t=it||t,ft[++ht]=$(rt,I,R,-1,t));else if(6===e.type)if(st=e,!I&&(f>0||o||1===S||3===S))g=!0,b=e;else if(!I&&0===f)if(w>=st.value.RowCount&&st.value.RowCount>1||T>=st.value.colCount&&st.value.colCount>1)O=r.Hh(v);else try{1===st.value.RowCount&&(w=0),1===st.value.colCount&&(T=0),typeof(lt=st.value.getValue(w,T))===k?O=r.createStringExpression(lt):typeof lt===M?O=r.createNumberExpression(lt):typeof lt===N?O=r.createBooleanExpression(lt):lt._error?O=r.Hh(lt):O=(new a.Parser).parse(t.source.getParserContext(t.useR1C1,tt(0,0)),""+lt)}catch(t){O=r.Hh(v)}O===p&&(O=e),D=O}return O}function Q(t,e,o,n,l,u,c){var f,h,g,b,w,T,S,x,I,R,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,K,Q,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt,bt=t.row,wt=t.column,Tt=[],St=0,xt=t.arrayIdentity?t.arrayIdentity.row:bt,At=t.arrayIdentity?t.arrayIdentity.col:wt;for(Tt[St]={expr:e,acceptsArray:u||!1,acceptsRef:c||!1,index:-1},f=0,h=0,g=!1,w=n,T=l,S=!1;St>=0;){if(x=Tt[St],St--,I=x.acceptsArray,R=x.acceptsRef,e=x.expr,O=p,e)if(7===e.type){if(H=(V=(_=e).arguments).length,!_.function){if(!t){O=r.Hh(m);continue}if("ANCHORARRAY"===(z=_.functionName)){1===H&&(W=(U=V[0]).source,q=t.source,1===U.type&&U.sf()?O=i.BLb(q,W,d,U.row,U.column,U.rowRelative,U.columnRelative):5===U.type&&(O=i.lOb(q,W))),O?t.iOb=2:O=r.Hh(m),_.ensureSingle&&(O.ensureSingle=!0),D=O;continue}_.function=t.getFunction(z)}if(J=_.function,X=x.index,B=x.neeedExpendindexs,X<0?(x.arrayArgumentEvaluateMode=S,x.arrayFormulaCatchValue=o,J&&J.arrayArgumentEvaluateMode&&(S=J.arrayArgumentEvaluateMode),x.args=[]):(J&&J.acceptsArray&&J.acceptsArray(X)?f--:g&&(B||(B=[],x.neeedExpendindexs=B),_.arguments[X],B.push(X)),x.args.push(D)),X===H-1){if(S=x.arrayArgumentEvaluateMode,o=x.arrayFormulaCatchValue,K=!1,(Z=x.args)&&Z.length>0)for(Q=0;Q<Z.length;Q++)if(Z[Q]!==_.arguments[Q]){K=!0;break}O=K?r.Jh(_,Z):e,B&&B.length>0&&(O=r.createExpandExpression(O,B),g=!0)}else 0===X&&J&&3===J.arrayArgumentEvaluateMode&&3===S&&(S=0),g=!1,X++,x.index=X,J&&J.acceptsArray&&J.acceptsArray(X)&&f++,Tt[++St]=x,Tt[++St]={expr:_.arguments[X],acceptsArray:!!J&&J.acceptsArray&&J.acceptsArray(X),acceptsRef:!!J&&J.acceptsReference&&J.acceptsReference(X),index:-1}}else if(1===e.type&&e.sf())h&&(j=(E=e.source!==r.BangSource&&e.source||t.source).getRowCount(),P=E.getColumnCount(),L=(L=e.rowRelative?(e.row+xt)%r.MAX_ROW_COUNT%j:e.row)<0?L+j:L,G=(G=e.columnRelative?(e.column+At)%r.MAX_COLUMN_COUNT%P:e.column)<0?G+P:G,e=i.rf(e.source&&E,p,L,G,!1,!1));else if(1===e.type||13===e.type){if(13===e.type){if(F=(et=e).getRange(bt,wt),et.tzb(bt,wt,t.source.id),!F){et._error?(delete et._error,O=D=y,t.iOb=1):(O=e,D=e);continue}e=i.uf(et.source===t.source?p:et.source,p,F.row,F.col,F.row+F.rowCount-1,F.col+F.colCount-1)}ot=e.source!==r.BangSource&&e.source,rt=(nt=e).ensureSingle,h&&(E=ot||t.source,j=r.MAX_ROW_COUNT,P=r.MAX_COLUMN_COUNT,it=nt.rowRelative?(nt.row+xt)%j:nt.row,at=nt.columnRelative?(nt.column+At)%P:nt.column,ut=void 0,(it=it<0?it+j:it)>(st=(st=nt.endRowRelative?(nt.endRow+xt)%j:nt.endRow)<0?st+j:st)&&(ut=it,it=st,st=ut),(at=at<0?at+P:at)>(lt=(lt=nt.endColumnRelative?(nt.endColumn+At)%P:nt.endColumn)<0?lt+P:lt)&&(ut=at,at=lt,lt=ut),it>=(j=E.getRowCount())?(it%=j,st%=j):st>=j&&(st=j-1),at>=(P=E.getColumnCount())?(at%=P,lt%=P):lt>=P&&(lt=P-1),e.row===r.BAND_INDEX_CONST&&(it=st=r.BAND_INDEX_CONST),e.column===r.BAND_INDEX_CONST&&(at=lt=r.BAND_INDEX_CONST),e=i.uf(ot,e.endSource,it,at,st,lt,!1,!1,!1,!1),rt&&(e.ensureSingle=!0)),c||R&&(I||!o&&1!==S&&3!==S)||bt<0||wt<0||(f>0&&!o&&1!==S&&3!==S||0===f||2===S?(F=nt.getRange(bt,wt),o||(R||I)&&1===S?!nt.isFullColumn&&1!==F.rowCount&&w>=F.rowCount||!nt.isFullRow&&1!==F.colCount&&T>=F.colCount?O=r.Hh(v):(L=(nt.isFullColumn?0:F.row)+(1===F.rowCount?0:w),G=(nt.isFullRow?0:F.col)+(1===F.colCount?0:T),O=i.rf(ot,e.endSource,L,G,!1,!1)):F.rowCount>1&&F.colCount>1||F.rowCount>1&&!nt.isFullColumn&&(bt<F.row||bt>=F.row+F.rowCount)||F.colCount>1&&!nt.isFullRow&&(wt<F.col||wt>=F.col+F.colCount)?O=r.Hh(C):(L=nt.isFullColumn||F.rowCount>1?bt:F.row,G=nt.isFullRow||F.colCount>1?wt:F.col,O=i.rf(ot,e.endSource,L,G,!1,!1))):g=!0)}else if(9===e.type)ct=e.operatorType>=15,ft=R&&t.source&&t.source.Af&&t.source.Af.allowDynamicArray,-1===x.index?(o&&A(e.value2)&&(ct=I=!1),x.index=e.value2?0:1,Tt[++St]=x,Tt[++St]=$(e.value,ct||I,ct||ft,-1)):0===x.index?(D!==e.value&&(O=r.Kh(e.operatorType,D,e.value2),x.expr=O),g&&((B=[]).push(0),x.neeedExpendindexs=B,g=!1),x.index=1,Tt[++St]=x,Tt[++St]=$(e.value2,ct||I,ct||ft,-1)):(O=e.value2&&D!==e.value2?r.Kh(e.operatorType,e.value,D):A(e.value2)&&D!==e.value?r.Kh(e.operatorType,D,d):e,B=x.neeedExpendindexs,g&&(B?B.push(1):B=[e.value2&&e.value2===b?1:0]),B&&(O=r.createExpandExpression(O,B),g=!0));else if(10===e.type)-1===x.index?(x.index=0,Tt[++St]=x,Tt[++St]=$(e.value,I,R,-1)):e.value!==D&&(O=r.Lh(D));else if(8===e.type)1===x.index?(h--,O=D,x.context&&(t=x.context)):(h++,Tt[++St]=$(e,I,R,1,t),ht=void 0,pt=t,dt=void 0,Y(Tt)?(ht=new r.Expression(100)).value=e.value:(e.source?(dt=e.source===r.BangSource?t.source:e.source,(pt=new s.EvaluateContext(dt)).cloneFrom(t),ht=dt.getCustomName(e.value)):(ht=t.getName(e.value),t.source.getCustomName(e.value)||(pt=new s.GloableEvaluateContext(t.source)).cloneFrom(t)),ht||(ht=r.Hh(m))),t=pt||t,Tt[++St]=$(ht,I,R,-1,t));else if(6===e.type)if(gt=e,mt=e.value,!I&&(f>0||o||1===S||3===S))g=!0,b=e;else if(!I&&0===f)if(yt=mt.getRowCount(),Ct=mt.getColumnCount(),w>=yt&&yt>1||T>=Ct&&Ct>1)O=r.Hh(v);else if(o||!(t.source&&t.source.Af&&t.source.Af.allowDynamicArray))try{1===yt&&(w=0),1===Ct&&(T=0),typeof(vt=gt.value.getValue(w,T))===k?O=r.createStringExpression(vt):typeof vt===M?O=r.createNumberExpression(vt):typeof vt===N?O=r.createBooleanExpression(vt):vt._error?O=r.Hh(vt):O=(new a.Parser).parse(t.source.getParserContext(t.useR1C1,tt(0,0)),""+vt)}catch(t){O=r.Hh(v)}O===p&&(O=e),D=O}return O}function $(t,e,o,n,r){return{expr:t,acceptsArray:e,acceptsRef:o,index:n,context:r}}function tt(t,e){return{row:t,col:e}}function et(t,e,o,n){return{row:t,col:e,rowCount:o,colCount:n}}function ot(t,e,o,n){return-1===t||-1===e||o*n>1}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./src/calc.common.ts"),i=o("./src/referenceExpression.ts"),a=o("./src/Parser.ts"),s=o("./src/evaluator.ts"),l=n.Common.F,u=n.Common.A,c=n.Common.B,f=n.Common.u,h=n.Common.l,p=null,d=void 0,g=Math.abs,m=r.Errors.Name,y=r.Errors.Reference,C=r.Errors.Value,v=r.Errors.NotAvailable,b=r.Errors.Calc,w=r.Convert.Ca,T=r.Convert.Fh,S=f.Nb,x=n.Common.j,A=x.Fa,I=Math.min,R="rowSliceListeners",M="number",k="string",N="boolean",e.approximatelyEqual=function(t,e,o){if(void 0===t&&(t=0),void 0===e&&(e=0),t===e||l(t,r.CalcError)&&l(e,r.CalcError)&&t._code===e._code)return!0;var n=1;return l(t,Date)&&l(e,Date)?n=864e5:l(t,Date)?t=h.Ra(t):l(e,Date)&&(e=h.Ra(e)),g(e-t)/n<o},e.supportRowColumnFormula=!1,O=function(){function t(t){this.Ze=[],this.ah=t}return t.prototype.getKey=function(){return""},t.prototype.hasListeners=function(){var t,e,o,n;for(t=0,e=this.Ze;t<e.length;t++)if(o=this[e[t]])for(n in o)if(o[n])return!0;return!1},t.prototype.gmb=function(t,e,o){var n,r=this[t],i=e.getKey();e.LDc&&e.LDc.length>=1&&((n=e.LDc)[n.length-1].push(this),i="?"+i),r||(this.Ze.push(t),r=this[t]={}),o?r[i]=e:delete r[i]},t.prototype.lWc=function(t,e,o){var n=this[t],r=e.getKey();r="!"+r,n||(this.Ze.push(t),n=this[t]={}),o?n[r]=e:delete n[r]},t.prototype.Yg=function(){var t,e,o,n,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=this.Ze,n=0;n<e.length;n++)if(r=this[e[n]])for(i in r)(o=r[i])&&o.bh()},t.prototype.Bg=function(){var t,e,o,n,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=this.Ze,n=0;n<e.length;n++)if(r=this[e[n]])for(i in r)!(o=r[i])||o.dh||o.eh||o.fh()},t.prototype.gh=function(){var t,e,o,n,r,i,a,s,l,u,c,f,h=[];for(t=0;t<arguments.length;t++)h[t]=arguments[t];for(e=h[0],o=this.Ze,n=e?1:-1,r=0;r<o.length;r++)if(i=this[o[r]])for(a in i)if(s=i[a],"?"===a[0]){if(e||!this.MDc)continue;for(;this.MDc.indexOf(s)>=0;)this.MDc.splice(this.MDc.indexOf(s),1),s.delay--}else s&&(s.delay+=n,e&&s.y$a&&s.y$a());if((l=this.node&&this.node.Pf)&&l.isDynamicArray)for(u=0;u<l.rowCount;u++)for(c=0;c<l.colCount;c++)0===u&&0===c||(f=this.ah.getNode(u+l.row,c+l.col))&&f.calc&&f.calc.gh(e)},t.prototype.bh=function(){},t.prototype.fh=function(){},t.prototype.ng=function(){},t.prototype.og=function(){},t.prototype.ZAb=function(){return this.ah.Cf()},t}(),e.BaseCalc=O,D=function(t){function e(e,o){var n=t.call(this,e)||this;return n.name=o,n.delay=0,n}return H(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+this.name},e.prototype.og=function(){this.ah.Og(this.name,!0)},e.prototype.ng=function(){this.ah.Og(this.name,!1)},e.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},e.prototype.fh=function(){this.ZAb().pg(this,3)},e}(O),e.NameIDCalc=D,F=function(t){function e(e,o,n){var r=t.call(this,e)||this;return r.id=o,r.name=n,r.delay=0,r}return H(e,t),e.prototype.getKey=function(){var t=this;return t.ah.getName()+","+t.id+"#"+t.name},e.prototype.og=function(){var t=this;t.ah.Ig(t.id,t.name,!0)},e.prototype.ng=function(){var t=this;t.ah.Ig(t.id,t.name,!1)},e.prototype.ZAb=function(){return this.ah.Af},e.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},e.prototype.fh=function(){this.ZAb().pg(this,6)},e}(O),e.PathCalc=F,E=function(){function t(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.mh=0,this.Bka=0,this.hmb=[];var t=this;t.kh=new a.Parser,t.lh=new s.Evaluator(t),t.nh=t.uzb&&t.uzb(),t.addResolver(new a.DefaultTokenResolver)}return t.prototype.getResolvers=function(){return this.hmb},t.prototype.addResolver=function(t){var e,o=this.hmb;for(e=0;;e++)if(!o[e]||t.priority>o[e].priority){o.splice(e,0,t);break}},t.prototype.dispose=function(){this.jh={},this.oh=p},t.prototype.cloneFrom=function(t){var e=this;e.useR1C1=t.useR1C1,e.mh=t.mh,e.qh=t.qh,e.calcOnDemand=t.calcOnDemand},t.prototype.ih=function(){return this.nh},t.prototype.getExternalSource=function(t,e){var o,n,r=this.getAllSourceModels();for(o=0,n=r.length;o<n;o++)if(f.Mb(r[o].getSource().getName(),e))return r[o].getSource();return p},t.prototype.getSourceModel=function(t){var e=this.jh[t.id];return e||(e=t.createSourceModel?t.createSourceModel(this):this.createSourceModel(this,t),this.jh[t.id]=e,t.setCalcSourceModel(e),t.setCalcService(this)),e},t.prototype.getGlobalSourceModel=function(t){return this.oh||((t=t||new r.CalcSource).createSourceModel?this.oh=t.createSourceModel(this):this.oh=this.createSourceModel(this,t),t.setCalcSourceModel(this.oh)),this.oh},t.prototype.setSourceModel=function(t,e){this.jh[t.id]=e,e.setCalcService(this)},t.prototype.getAllSourceModels=function(){var t,e=[],o=this.jh;for(t in o)e.push(o[t]);return e},t.prototype.removeSource=function(t){var e,o,n,r;for(o in this.suspend(),this.jh[t.id]&&(""!==t.getName()&&this.onRemoveSource(t),delete this.jh[t.id]),this.clearDirties(),e=this.jh)e[o].addDirtyNodesForCalc(!0);n=this.Dh&&this.Dh.kj,r=t&&t.kj,n&&r&&r===n&&(this.Dh=null),this.resume(!1)},t.prototype.clearSource=function(){this.jh={},this.Dh=null,this.clearDirties()},t.prototype.ignoreDirty=function(){return this.qh},t.prototype.suspend=function(t){this.mh++,this.qh=!!t},t.prototype.resume=function(t){var e=this;e.mh--,e.mh<0&&(e.mh=0),e.IsSuspended()||(e.rh=p,e.qh=!1,e.recalculateAll(t))},t.prototype.suspendAdjust=function(){this.Bka++},t.prototype.resumeAdjust=function(){var t=this;t.Bka--,t.Bka<0&&(t.Bka=0)},t.prototype.isAdjustSuspended=function(){return this.Bka>0},t.prototype.clearDirties=function(){var t,e,o,n=this,r=n.imb;if(r)for(t in r)if(r.hasOwnProperty(t))for(e=r[t];e;)(o=e.eh)?(e.$l=!1,e.eh=o.dh=d,e=o):e=p;n.imb=n.jmb=p},t.prototype.resumeWithoutCalc=function(){this.mh--,this.mh<0&&(this.mh=0),this.clearDirties(),this.qh=!1},t.prototype.IsSuspended=function(){return this.mh>0},t.prototype.recalculateAll=function(t,e){this.IsSuspended()||this.nYc(t,e)},t.prototype.nYc=function(t,e){var o,n,r,i=this;for(r in i.CIb=Date.now(),e||i.lh.startCache(),n=i.jh)(o=n[r]).getSource().startCalculation(),o.addDirtyNodesForCalc(t,e);for(r in i.Gg(),n)(o=n[r]).getSource().endCalculation();e||i.lh.endCache(),delete i.CIb},t.prototype.Gg=function(t){var e,o,n,r,i,a,s;if(void 0===t&&(t=!0),o=(e=this).imb){if(t){for(n in i=o[1]||o[2],o)o.hasOwnProperty(n)&&(a=parseInt(n),i&&1!==a&&2!==a||(r=o[n])&&(r.ah.addListenersToDirty(e,a),r.processed=!0));for(n in o)o.hasOwnProperty(n)&&((r=o[n])&&(r.processed?delete r.processed:r.ah.addListenersToDirty(e,parseInt(n))))}for(n in o)o.hasOwnProperty(n)&&o[n].ah.initDelay(e,parseInt(n));for(n in o)o.hasOwnProperty(n)&&o[n].ah.adjustDelayOfListeners(e,parseInt(n),!0);do{for(n in s=!1,o)o.hasOwnProperty(n)&&(o[n].ah.calculateDirtyNodes(e,parseInt(n))&&(s=!0))}while(s);for(n in o)o.hasOwnProperty(n)&&o[n].ah.calculateIterations(e,parseInt(n));e.imb=e.jmb=d}},t.prototype.initParserContext=function(t){this.Dh||(this.Dh=t.getParserContext(this.useR1C1))},t.prototype.getParserContext=function(t){var e=this,o=e.Dh;return o||(t?e.Dh=o=t.getParserContext(e.useR1C1):o=new a.ParserContext(p,e.useR1C1)),o.setSource(t),o},t.prototype.parseWithContext=function(t,e){return this.kh.parse(t,e)},t.prototype.unparseWithContext=function(t,e){return this.kh.unparse(t,e)},t.prototype.pg=function(t,e){var o,n,r,i,a=this;isNaN(e)||(r=a.imb,i=a.jmb,r||(r=a.imb={},i=a.jmb={}),o=r[e],n=i[e],t.$l=!0,t&&!t.dh&&t!==o&&(o?n.eh=t:r[e]=t,t.dh=n,t.eh=p,i[e]=t))},t.prototype.Bh=function(t,e){var o,n,r,i,a,s=this;isNaN(e)||(t.$l=!1,n=s.imb,r=s.jmb,n&&(o=s.imb[e]),t&&(t.dh||t===o)&&(i=t.dh,a=t.eh,i?i.eh=a:n&&(a?n[e]=a:delete n[e]),a?a.dh=i:r&&(i?r[e]=i:delete r[e]),t.dh=p,t.eh=p))},t.prototype.evaluateExpression=function(t,e,o){return this.lh.evaluateExpression(e,t.getEvaluatorContext(o,!1),!1)},t.prototype.onClearExpr=function(t,e){this.lh&&this.lh.asyncManager.clearCell(t,e)},t.prototype.parse=function(t,e,o,n,r,i,a){var s,l,u=this,c=u.rh,f=u.getParserContext(t);return f.useR1C1=!a&&u.useR1C1,f.ignoreError=i,f.row=o,f.column=n,f.culture=r,c?(s=c[e])?s:(l=u.kh.parse(f,e),c[e]=l,l):u.kh.parse(f,e)},t.prototype.unparse=function(t,e,o,n,r,i,a){var s,l=this.getParserContext(t);return l.useR1C1=this.useR1C1,l.row=o,l.column=n,l.culture=r,l.addSheetName=a,i&&(l.Eh=!0,l.useR1C1=!1),s=this.kh.unparse(l,e),l.Eh=!1,s},t.prototype.recalculate=function(t,e,o,n){var r=this.getSourceModel(t);-1===o?r.Ag(e,0,1,r.cC()):-1===e?r.Ag(0,o,r.rC(),1):r.Ag(e,o,1,1),this.IsSuspended()||this.recalculateAll(!1,n)},t.prototype.recalculateByName=function(t,e){var o,n;e&&(o=function(t,e){return t.getSourceModel(e)}(this,t),n=o.mg(S(e),!0),this.pg(n,3),this.IsSuspended()||this.recalculateAll(!1))},t.prototype.recalcRange=function(t,e,o,n,r){var i=this.getSourceModel(t);-1===o?i.Ag(e,0,n,i.cC()):-1===e?i.Ag(0,o,i.rC(),r):i.Ag(e,o,n,r),this.IsSuspended()||this.recalculateAll(!1)},t.prototype.evaluate=function(t,e,o,n,i){var a=e instanceof r.Expression?e:this.parse(t,e,o,n);return this.lh.evaluateExpression(a,t.getEvaluatorContext(tt(o,n),!1),!1,i,i)},t.prototype.Hg=function(t,e,o,n,i,a,s,l){var u,c,f,h,g,m,y,b,w,T,S,x=o.row||0,A=o.col||0,I=a?a.row:x,R=a?a.col:A,M=t.getEvaluatorContext(o,n,a,e);if(M.NMc=l,c=4===arguments.length&&n||s,this.allowDynamicArray&&!n&&(M.Exb=!0),(u=this.lh.evaluateExpression(e,M,i,c,c))&&u.pause)return u;if(t.ODc){for(f=0;f<t.ODc.length;f++)delete t.ODc[f].PDc;delete t.ODc}if(n&&arguments.length<=5)return u;if(!n&&s&&(r.Convert.Fh(u)||r.Convert.Ca(u)))return u;if(r.Convert.Fh(u)){if(h=u.getRowCount(0),g=u.getColumnCount(0),1!==u.getRangeCount())return C;try{if(m=n?x-I:x-u.getRow(0),y=n?A-R:A-u.getColumn(0),b=tt(0,0),1===h&&1===g);else if(1===h&&g>1&&y>=0&&y<g)b.col=y;else if(h>1&&1===g&&m>=0&&m<h)b.row=m;else{if(!(n&&m<h&&y<g))return n?v:C;b.row=m,b.col=y}u=u.getValue(b,0)}catch(t){return C}}else if(r.Convert.Ca(u))if(n){if(T=(w=u).getRowCount(),S=w.getColumnCount(),1!==T&&x-I>=T||1!==S&&A-R>=S)return v;u=u.getValue(1===T?0:x-I,1===S?0:A-R)}else u=u.getValueByIndex(0);return u===d||u===p?!1===i?u:0:u},t.prototype.onAddAdjust=function(t,e){this.nh.hh(t,e)},t.prototype.onRemoveSource=function(t){this.nh.ph(t)},t.prototype.createSourceModel=function(t,e){return new P(t,e)},t.prototype.NHb=function(){var t,e,o=this.jh;for(t in o)(e=o[t])instanceof P&&e.getAllNodes().forEach((function(t){var e=t.calc;e&&(e.$l=!1,(e.eh||e.dh)&&(e.dh=e.eh=p))}))},t}(),e.CalcService=E,e.setSpillValues=z,e.markAnchorCellDirty=W,j=function(){function t(){}return t.getLength=function(t,e){return w(t)?t.getRowCount()*t.getColumnCount():T(t)?(e=e||0,t.getRowCount(e)*t.getColumnCount(e)):void 0},t.getRowCount=function(t,e){return w(t)?t.getRowCount():T(t)?(e=e||0,t.getRowCount(e)):void 0},t.getColumnCount=function(t,e){return w(t)?t.getColumnCount():T(t)?(e=e||0,t.getColumnCount(e)):void 0},t.getValueByIndex=function(t,e,o){if(w(t))return t.getValueByIndex(e);if(T(t)){o=o||0;var n=t.getColumnCount(o);return t.getValue(o,parseInt(""+e/n,10),e%n)}},t.getValue=function(t,e,o,n){return w(t)?t.getValue(e,o):T(t)?(n=n||0,t.getValue(n,e,o)):void 0},t}(),e.CalcArrayHelper=j,P=function(){function t(t,e){this.Ef=0,this.Ff=0,this.Gf=[],this.OMc=[],this.qhc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;this.xf=e,this.Af=t}return t.prototype.getNode=function(t,e,o){var n,r=this,i=p;return t>=0&&e>=0?(n=r.dataTable[t],o&&!n&&(n=r.dataTable[t]={},t>r.Ef&&(r.Ef=t)),n&&(i=n[e],o&&!i&&(i=n[e]={},e>r.Ff&&(r.Ff=e)))):-1===t&&e>=0?(i=r.If[e],o&&!i&&(i=r.If[e]={},e>r.Ff&&(r.Ff=e))):t>=0&&-1===e?(i=r.Hf[t],o&&!i&&(i=r.Hf[t]={},e>r.Ff&&(r.Ff=e))):-1===t&&-1===e&&(i=r.Jf,o&&!i&&(i=r.Jf={})),i},t.prototype.getNodeByName=function(t,e){var o=this.dataTableByName[t];return e&&!o&&(o=this.dataTableByName[t]={}),o},t.prototype.Kf=function(t,e){var o=this.getNode(t,e);return o&&o.Lf},t.prototype.Mf=function(t,e){var o=this.getNode(t,e);return o&&o.Nf},t.prototype.Qf=function(t,e){return this.getWorkingNodeInfo(t,e,2)},t.prototype.BTa=function(t,e){return this.getWorkingNodeInfo(t,e,1)},t.prototype.ATa=function(t,e){return this.getWorkingNodeInfo(t,e,0)},t.prototype.CTa=function(t){var e=this.getNodeByName(t);return e&&e.Nf},t.prototype.DTa=function(t){var e=this.getNodeByName(t);return e&&e.Lf},t.prototype.clearAll=function(){var t=this;t.clear(-1,-1,-1,-1),t.dataTable={},t.dataTableByName={},t.Hf=[],t.If=[],t.Jf=p},t.prototype.clear=function(t,e,o,n,r){this.$b(t,e,o,n,r)},t.prototype.rzb=function(){var t=this;Z(t.Hf),Z(t.If),Z(t.dataTable,!0),Z(t.dataTableByName),t.eHb()},t.prototype.eHb=function(){var t=this;t.dataTable={},t.dataTableByName={},t.Hf=[],t.If=[],t.Jf=p,t.Gf=[],t.OMc=[],t.vg=p,t.xg=p},t.prototype.addRows=function(t,e){var o,n=this,r=n.rC();if(!(t<0||t>r||e<0))for(u(n.dataTable,r,t,e),u(n.Hf,r,t,e),o=0;o<e;o++)n.dataTable[t+o]&&(n.dataTable[t+o]={rs:"n"})},t.prototype.deleteRows=function(t,e){var o=this,n=o.rC();t<0||t>=n||e<=0||(t+e>n&&(e=n-t),c(o.dataTable,n,t,e),c(o.Hf,n,t,e))},t.prototype.addColumns=function(t,e){var o,n,r=this,i=r.rC(),a=r.cC();if(!(t<0||t>a||e<0)){for(o=0;o<i;o++)(n=r.dataTable[o])&&t<a&&u(n,a,t,e);u(this.If,a,t,e)}},t.prototype.deleteColumns=function(t,e){var o,n,r=this.rC(),i=this.cC();if(!(t<0||t>=i||e<0)){for(o=0;o<r;o++)(n=this.dataTable[o])&&c(n,i,t,e);c(this.If,i,t,e)}},t.prototype.ETa=function(t,e){var o=[t,e],n=this.getNode(t,e);return n&&o.push(n.Lf,n.Nf,n.Pf),o},t.prototype.FTa=function(t,e,o){t&&t.push(this.ETa(e,o))},t.prototype.dUa=function(){var t=this.getSource(),e=t&&t.getSheet(),o=e&&e.ITa;return o&&o.dUa()},t.prototype.$Va=function(t,e,o,n,r){var i=this;-1===t?i.kg(e,o,n):-1===e?i.jg(t,o,n):i.ig(t,e,o,n,r)},t.prototype.Rf=function(t,e,o,n){var r=this.getNode(t,e,!!o);r&&(n&&n.push([t,e,r.Lf]),r.Lf=o)},t.prototype.GTa=function(t,e,o,n,r,i,a){var s=this.getNode(t,e,!!o);s&&(this.FTa(a,t,e),s.Lf=o,(s.Nf||n)&&(s.Nf=n),(s.Pf||r)&&(s.Pf=r),s.isVolatile&&!o?this.Tf(s):(i||s.isVolatile)&&(s.isVolatile=i))},t.prototype.Sf=function(t,e,o){this.GTa(t,e,d,d,d,!1,o)},t.prototype.Uf=function(t,e,o,n,r,i){var a=this.getNode(e,o);a&&a.Lf&&t.GTa(n,r,a.Lf,a.Nf,a.Pf,a.isVolatile,i)},t.prototype.ega=function(t,e){var o=this.dataTable[t];return o&&o[e]},t.prototype.Wf=function(t,e,o){var n=this.getNode(t,e,!!o);n&&(n.Nf=o)},t.prototype.Xf=function(t,e,o){var n=this.getNode(t,e,!!o);n&&(n.Pf=o)},t.prototype.Yf=function(t,e){var o=this.getNode(t,e);return o&&o.calc},t.prototype.Zf=function(t,e,o){var n=this.getNode(t,e,!0);n&&(n.calc&&n.calc.isVolatile&&this.Tf(n),n.calc&&n.calc.isPivotData&&this.PMc(n),n.calc=o,o&&(o.node=n))},t.prototype.Q3=function(t,e,o){var n=this.getNode(t,e,!0);n&&n.calc&&(n.calc.isVolatile&&this.Tf(n),n.calc.isPivotData&&this.PMc(n),this.Af.Bh(n.calc,o),n.calc=d)},t.prototype.$f=function(t,e,o,n,r){var i,a=this;o>=0&&n>=0?((i=a.dataTable[o])||(i=a.dataTable[o]={}),i[n]=r,r&&r.calc&&delete r.calc):o>=0&&-1===n&&t>=0&&-1===e?a.Hf[o]=r:n>=0&&-1===o&&e>=0&&-1===t&&(a.If[n]=r)},t.prototype._f=function(t,e,o,n){var r=this,i=r.getNode(t,e),a=r.getNode(o,n);i&&i.Lf?r.$f(t,e,o,n,i):a&&a.Lf&&r.$f(t,e,o,n,p),a&&a.Lf?r.$f(o,n,t,e,a):i&&i.Lf&&r.$f(o,n,t,e,p)},t.prototype.rhc=function(t,e,o){t.isIterativeCalc||(t.isIterativeCalc=!0,this.qhc.push(t),e||function(t,e){var o,n,r,i=t.ah&&t.ah.getSource();i&&(o=t.row,n=t.column,r=i.getValue(o,n),i.setValue(o,n,e,r))}(t,o))},t.prototype.shc=function(t){delete t.isIterativeCalc},t.prototype.thc=function(){var t,e=this,o=[],n=e.qhc,r=e.qhc.length;for(t=0;t<r;t++)n[t].isIterativeCalc&&o.push(n[t]);return e.qhc=o,e.qhc},t.prototype.lmb=function(){return this.Gf},t.prototype.QMc=function(){return this.OMc},t.prototype.bg=function(t){t.isVolatile||(t.isVolatile=!0,this.Gf.push(t))},t.prototype.RMc=function(t){t.isPivotData||(t.isPivotData=!0,this.OMc.push(t))},t.prototype.Tf=function(t){var e,o,n,r,i;if(t.isVolatile=d,(e=this).B5++,e.B5>100){for(e.B5=0,o=[],n=e.Gf,r=e.Gf.length,i=0;i<r;i++)n[i].isVolatile&&o.push(n[i]);e.Gf=o}},t.prototype.PMc=function(t){var e,o,n,r,i;for(t.isPivotData=void 0,o=[],n=(e=this).OMc,r=e.OMc.length,i=0;i<r;i++)n[i].isPivotData&&o.push(n[i]);e.OMc=o},t.prototype.getCalcService=function(){return this.Af},t.prototype.setCalcService=function(t){this.Af=t},t.prototype.Cf=function(){return this.Af},t.prototype.getSource=function(){return this.xf},t.prototype.hasFormula=function(t,e){return t=t!==d?t:-1,e=e!==d?e:-1,!!this.ATa(t,e)},t.prototype.setFormula=function(t,e,o,n,r,i,a,s){var l,u,c,f,h,g=this;if(o&&0===o.length&&(o=p),!r&&g.dg(t,e,1,1)&&g.eg(),l=g.getFormula(t,e),i||l!==o&&(""!==l||o)&&(l||""!==o)||l===o&&g.Qf(t,e)){if(u=g.Cf(),c=p,u)try{f=t>=0?t:0,h=e>=0?e:0,c=n||(o?u.parse(g.xf,o,f,h,!1,r):p),g.fg(t,e,c,d,!1,a,s)}catch(t){if(!r)throw t}t>=0&&e>=0&&g.xf.setFormula(t,e,o)}},t.prototype.getFormula=function(t,e,o){var n,r,i=this.Cf();return i&&(n=this.ATa(t,e))?(t=(r=this.Qf(t,e))&&!0!==r.isDynamicArray?r.row:t,e=r&&!0!==r.isDynamicArray?r.col:e,i.unparse(this.xf,n,t,e,o)):p},t.prototype.setFormulaByName=function(t,e,o,n,r){var i,a,s,l;if(t&&(t=S(t),i=this,e&&0===e.length&&(e=p),(a=i.getFormulaByName(t))!==e&&(""!==a||e)&&(a||""!==e))){if(s=i.Cf(),l=p,s)try{l=e?s.parse(i.xf,e,0,0,!1,o):p,i.gg(t,l,d,!1,n,r)}catch(t){if(!o)throw t}i.xf.setFormula({name:t},e)}},t.prototype.getFormulaByName=function(t){var e,o=this.Cf();return o&&t&&(e=this.DTa(S(t)))?o.unparse(this.xf,e,0,0):p},t.prototype.eg=function(){throw r.sR().Exp_ArrayFromulaPart},t.prototype.rC=function(){return I(this.xf.getRowCount())},t.prototype.cC=function(){return I(this.xf.getColumnCount())},t.prototype.setArrayFormula=function(t,e,o,n,r,i,a,s){var l,u,c,f,h=this;if(r&&0===r.length&&(r=p),h.dg(t,e,o,n)&&h.eg(),t=t<0?0:t,e=e<0?0:e,(u=h.Cf())&&(h.$b(t,e,o,n,a),r)){try{l=r?u.parse(h.xf,r,t,e,!1,i,i):p}catch(t){if(!i)throw t;return}for(c=t;c<t+o;c++)for(f=e;f<e+n;f++)h.fg(c,f,l,et(t,e,o,n),!1,a,s);t>=0&&e>=0&&h.xf.setArrayFormula(t,e,o,n,u.unparse(h.xf,l,t,e))}},t.prototype.getWorkingNodeInfo=function(t,e,o){var n,r=this,i=r.xf;return t>=i.getRowCount()||e>=i.getColumnCount()?n:(t>=0&&e>=0?((!(n=r.getNode(t,e))||0===o&&!n.Lf||1===o&&!n.Nf||2===o&&!n.Pf)&&(n=r.getNode(t,-1)),(!n||0===o&&!n.Lf||1===o&&!n.Nf||2===o&&!n.Pf)&&(n=r.getNode(-1,e))):n=t>=0&&-1===e?r.getNode(t,-1):-1===t&&e>=0?r.getNode(-1,e):r.getNode(-1,-1),n&&(0===o&&n.Lf||1===o&&n.Nf||2===o&&n.Pf))},t.prototype.fg=function(t,e,o,n,r,i,a){var l,u,c,f,h,p,g,m,y,C,v,b,w=this,T=w.Cf();T.nia&&T.lh.asyncManager.endCalcCell(),u=(l=n!==d&&null!==n)?n.row:t,c=l?n.col:e,f=w.xf,h=new s.EvaluateContext(f,tt(u,c),l),p=T.allowDynamicArray?Q(h,o,l,l?t-n.row:0,l?e-n.col:0,!0,!0):K(h,o,l,l?t-n.row:0,l?e-n.col:0),(g=h.iOb)&&(delete h.iOb,2===g?o=p:1===g&&(m=T.unparse(f,o,u,c),o=T.parse(f,m,u,c))),p=p===o?d:p,n!==d&&(y=n),t>=0&&e>=0?((r===d||r)&&(C=t>=0?t:0,v=e>=0?e:0,b=o?T.unparse(f,o,C,v):d,w.xf.setFormula(t,e,b)),w.ig(t,e,o,p,y,i,a)):t>=0&&-1===e?w.jg(t,o,p,i,a):-1===t&&e>=0&&w.kg(e,o,p,i,a),T.autoCalculation&&!T.IsSuspended()&&T.recalculateAll(!1)},t.prototype.gg=function(t,e,o,n,r,i){var a,l=this,u=l.Cf(),c=Q(new s.EvaluateContext(l.xf,tt(0,0),!1),e,!1,0,0);c=c===e?d:c,n!==d&&!n||r||(a=e?u.unparse(l.xf,e,0,0):d,l.xf.setFormulaByName&&l.xf.setFormulaByName(t,a)),l.lg(t,e,c,null,i),u.autoCalculation&&!u.IsSuspended()&&(r||u.recalculateAll(!1))},t.prototype.getRowExpression=function(t){return this.Kf(t,-1)},t.prototype.getColumnExpression=function(t){return this.Kf(-1,t)},t.prototype.lg=function(t,e,o,n,r){var i,a=this.mg(t,!0);a&&(r||a.ng(),(i=this.getNodeByName(t,!0)).Lf=e,n&&(n[0].push("dataTable",t),n[1]=i.Lf),o=e&&o?o:d,i.Nf=o,r||a.og(),a.fh())},t.prototype.ig=function(t,e,o,n,r,i,a){var s,l=this,u=l.qg(t,e,!0);u&&(l.FTa(i,t,e),(s=l.Af).onClearExpr(l.xf,tt(t,e)),X(s,u,u.kOb,!1),delete u.kOb,delete u.eOb,u.ng(),l.Rf(t,e,o),o?((n||l.Mf(t,e))&&l.Wf(t,e,n),r&&!0===r.isDynamicArray||l.Xf(t,e,r)):(l.Wf(t,e,d),l.Xf(t,e,d)),u.og(),u.fh())},t.prototype.jg=function(t,e,o,n,r){var i=this,a=i.rg(t,!0);a&&(i.FTa(n,t,-1),r||a.ng(),i.Rf(t,-1,e),(o||i.Mf(t,-1))&&i.Wf(t,-1,o),r||a.og(),a.fh())},t.prototype.kg=function(t,e,o,n,r){var i=this,a=i.sg(t,!0);a&&(i.FTa(n,-1,t),r||a.ng(),i.Rf(-1,t,e),(o||i.Mf(-1,t))&&i.Wf(-1,t,o),r||a.og(),a.fh())},t.prototype.$b=function(t,e,o,n,r){var i,a,s,l,u,c=this,f=t<0?0:t,h=e<0?0:e,g=f+(t<0?c.rC():o)-1,m=h+(e<0?c.cC():n)-1,y=function(t,e){if(i=c.Mf(t,e),a=c.Kf(t,e),i||a){var o=(s=c.Qf(t,e))&&!0!==s.isDynamicArray?et(s.row,s.col,s.rowCount,s.colCount):d;c.fg(t,e,p,o,!0,r)}};for(l=f;l<=g&&l>=0;l++)for(e<0&&y(l,-1),u=h;u<=m&&u>=0;u++)l===f&&t<0&&y(-1,u),y(l,u);t<0&&e<0&&y(t,e)},t.prototype.dg=function(t,e,o,n){return this.tg(t,e,o,n,!0,!0)},t.prototype.tg=function(t,e,o,n,r,i){var a,s,l,u,c,f,h,p,d=this,g=t<0?0:t,m=e<0?0:e,y=t<0?d.rC():o,C=e<0?d.cC():n,v=g+(0===y?1:y)-1,b=m+(0===C?1:C)-1,w=!1,T=[],S=[],x=d.dataTable;for(l=g;l<=v&&l>=0&&!(l>d.Ef);l++)if(s=x[l])for(u=m;u<=b&&u>=0&&!(u>d.Ff);u++)if(a=s[u])if(f=void 0,(c=a.Pf)&&!c.isDynamicArray){if(c.row<g||c.row+c.rowCount-1>v||c.col<m||c.col+c.colCount-1>b){if(r)return h=c.row===t&&0===o,p=c.col===e&&0===n,!h&&!p;w=!0}if(l!==c.row&&l!==g)continue;T.push(et(c.row,c.col,c.rowCount,c.colCount)),f=a.Lf,S.push(f),u=c.col+c.colCount-1}else i||(f=a.Lf)&&(T.push({row:l,col:u}),S.push(f));return!r&&{hasPart:w,ranges:T,formulas:S}},t.prototype.getCalcObj=function(){var t,e,o,n,r,i,a,s,l,u,c,f=[];for(t=0;t<arguments.length;t++)f[t]=arguments[t];if(e=f[0],o=f[1],n=this,r=e.row,i=e.column,a=null,isNaN(r)||isNaN(i))e.name&&(a=n.mg(e.name,o));else if(r>=0&&i>=0)if(e.sf())a=n.qg(r,i,o);else for(s=e.endRow,l=e.endColumn,a=[],u=r;u<=s;u++)for(c=i;c<=l;c++)a.push(n.qg(u,c,o));else r>=0?a=n.rg(r,o):i>=0&&(a=n.sg(i,o));return a},t.prototype.mg=function(t,e){var o=p,n=this.getNodeByName(t,e);return n&&(!(o=n.calc)&&e&&(o=new D(this,t),n.calc=o,o.node=n)),o},t.prototype.oYc=function(t){var e,o,n=this;for(e in n.dataTable)for(o in n.dataTable[e])t(n.dataTable[e][o])},t.prototype.qg=function(t,e,o){var n,r,i,a=this,s=p;if(t>=0&&e>=0){if(!(r=(n=a.dataTable)[t])){if(!o)return s;r=n[t]={},t>a.Ef&&(a.Ef=t)}if(!(i=r[e]))return o&&(i=r[e]={},s=new L(a,t,e),i.calc=s,s.node=i,e>a.Ff&&(a.Ff=e)),s;!(s=i.calc)&&o&&(s=new L(a,t,e),i.calc=s,s.node=i,t>a.Ef&&(a.Ef=t),e>a.Ff&&(a.Ff=e))}return s},t.prototype.rg=function(t,e){var o=this,n=p;return t>=0&&(!(n=o.Yf(t,-1))&&e&&(n=new G(o,t),o.Zf(t,-1,n),t>o.Ef&&(o.Ef=t))),n},t.prototype.sg=function(t,e){var o=this,n=p;return t>=0&&(!(n=o.Yf(-1,t))&&e&&(n=new B(o,t),o.Zf(-1,t,n),t>o.Ff&&(o.Ff=t))),n},t.prototype.ug=function(t){var e=this;return!e.vg&&t&&(e.vg=new V(e)),e.vg},t.prototype.wg=function(t,e){var o,n=this;return t=S(t),n.xg||(n.xg={}),!(o=n.xg[t])&&e&&(o=n.xg[t]=new _(n,t)),o},t.prototype.updateNameCalc=function(t,e){var o=this.wg(S(t));o&&(o.updateListening(!0,e),o.fh())},t.prototype.yg=function(t,e){var o,n,r=this,i=I(r.Ff,t+e-1);for(o=t;-1!==o&&o<=i;o++)r.isDirty(-1,o)&&(n=r.sg(o,!0),r.Af.pg(n,2))},t.prototype.zg=function(t,e){var o,n,r=this,i=I(r.Ef,t+e-1);for(o=t;-1!==o&&o<=i;o++)r.isDirty(o,-1)&&(n=r.rg(o,!0),r.Af.pg(n,1))},t.prototype.Ag=function(t,e,o,n){var r,i,a,s=this,l=null,u=I(s.Ef,t+o-1),c=I(s.Ff,e+n-1);for(r=t;r<=u;r++)for(i=e;i<=c;i++)s.ega(r,i)&&(s.Af.calcOnDemand?(l=s.qg(r,i,!1))&&(l.Bg(),l.$l=!0):(l=s.qg(r,i,!0),s.Af.pg(l,0)));s.zg(t,o),s.yg(e,n),(a=s.ug(!1))&&a.Bg(t,e,o,n)},t.prototype.uhc=function(){var t,e,o,n,r,i=this,a=i.lmb().concat(i.thc()).concat(i.QMc());for(o=0;o<a.length;o++)n=a[o],i.Af.calcOnDemand&&n&&(n.isVolatile||n.isIterativeCalc)&&(n.$l=!0,n.Bg()),n&&(n.isVolatile||n.isIterativeCalc||n.isPivotData)&&n instanceof L&&!i.Dg(n)&&(r=i.qg(n.row,n.column,!0),i.Af.pg(r,0),(t=i.rg(n.row,!1))&&!i.Eg(t)&&i.zg(n.row,1),(e=i.sg(n.column,!1))&&!i.Eg(e)&&i.yg(n.column,1))},t.prototype.Dg=function(t){var e=this.getCalcService().imb;return!!t.dh||t===(e&&e[0])},t.prototype.Eg=function(t){var e=this.getCalcService().imb;return t.dh||t===(e&&e[1])},t.prototype.isDirtyColumn=function(t){var e=this.getCalcService().imb;return t.dh||t===(e&&e[2])},t.prototype.isDirty=function(t,e){return!(!this.Yf(t,e)&&!this.Kf(t,e))},t.prototype.recalculateForContext=function(t,e,o){var n=this.Af,r=n.getSourceModel(t),i=e.row,a=e.col;-1===a?r.Ag(i,0,1,r.cC()):-1===i?r.Ag(0,a,r.rC(),1):r.Ag(i,a,1,1),n.IsSuspended()||n.recalculateAll(!1,o)},t.prototype.recalculateCell=function(t,e,o){var n,a,s,l,u,c,f,g,m,y,v,w,T,S,x,I,R,k=this,N=k.xf,O=k.BTa(t,e)||k.ATa(t,e),D=N,F=D.q$a,E=D&&D.kj&&D.kj.ITa;if(E&&(E.SIb=!0),a=!1,O){if(s=tt(t,e),l=N.getValue(t,e),u=!1,c=void 0,f=void 0,g=void 0,m=void 0,(y=k.Qf(t,e))&&!0!==y.isDynamicArray&&(u=!0,c=y.row,f=y.col,g=y.rowCount,m=y.colCount),(v=k.Af).nia&&v.lh.asyncManager.startCalcCell(k.xf,s),w=v.Hg(k.xf,O,s,u,!0,y&&!0!==y.isDynamicArray&&et(c,f,g,m),v.allowDynamicArray,o),o&&w&&w.pause)return w;if(q(T=k.xf.getCalcSourceModel().qg(t,e),0,v,0,0,o),o&&T.delay>0)return{pause:"newDetectedRefs"};if(S=r.Convert.Fh(w)||r.Convert.Ca(w),!u&&(O.hJc||!O.ensureSingle&&S)&&(y={row:t,col:e,rowCount:g=w.getRowCount?w.getRowCount():1,colCount:m=w.getColumnCount?w.getColumnCount():1,isDynamicArray:!0},k.Xf(t,e,y)),a=!0,x=void 0,S&&((x=r.Convert.Ph(w,0,!1,!1,!1)).isError||x.isConvertError?(w=C,S=!1):(g=x.rowCount,m=x.colCount,0===g||0===m?(w=b,S=!1):1!==g||1!==m||O instanceof i.SpillReferenceExpression||(w=x[0][0],A(w)&&(w=0),S=!1),O.ensureSingle&&S&&!O.hJc&&(I=k.getNode(t,e),delete O.ensureSingle,O=I.Lf=r.Jh(r.Functions.findGlobalFunction("@"),[O]),I.Nf=d,w=O.function.evaluate({row:t,column:e},w),S=!1))),S)(R=D.setArray(t,e,g,m,x))&&z(R[1],D);else if((R=D.updateItem&&D.updateItem(t,e,w))&&(z(R[0],D),n=R[1]),"hyperlink",l!==w||"string"==typeof w&&w.hyperlink){if(l instanceof Date){if(w instanceof Date&&l.valueOf()===w.valueOf())return!1;if(typeof w===M){if(h.Ra(l)===w)return!1;w=h.Xb(w)}}N.setValue(t,e,w,l)}else a=!1;v.nia&&v.lh.asyncManager.endCalcCell(),D.Ppb&&D.Ppb(t,e)}else F||(R=D.updateItem&&D.updateItem(t,e,p))&&(z(R[0],D),n=R[1]);return E&&(n&&W(n,k,E.ZHb),E.SIb=!1),a},t.prototype.recalculateNameID=function(t){var e,o,n=this,r=n.xf,i=n.CTa(t)||n.DTa(t);if(i){if((e=r.getValueByName?r.getValueByName(t):r.getValue({name:t}))===(o=n.Af.Hg(n.xf,i,{name:t},!1,!0)))return;if(e instanceof Date&&o instanceof Date&&e.valueOf()===o.valueOf())return;r.setValueByName?r.setValueByName(t,o):r.setValue({name:t},o)}},t.prototype.addDirtyNodesForCalc=function(t,e){var o,n,r=this;!1!==t?(o=r.cC(),n=r.rC(),r.yg(0,o),r.zg(0,n),r.Ag(0,0,n,o)):e||r.uhc()},t.prototype.addListenersToDirtyForRow=function(t){for(var e,o,n,r;t.imb[1];){for(n=(o=(e=t.imb[1]).ah).cC(),r=0;r<n;r++)t.pg(o.qg(e.row,r,!0),0);t.Bh(e,1)}},t.prototype.addListenersToDirtyForCol=function(t){for(var e,o,n,r;t.imb[2];){if((n=(o=(e=t.imb[2]).ah).rC())>0)for(r=0;r<n;r++)t.pg(o.qg(r,e.column,!0),0);else e.Bg();t.Bh(e,2)}},t.prototype.Ah=function(t,e){for(var o=t.length,n=e;n;)t[o]=n,o++,n=n.eh},t.prototype.addListenersToDirty=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p,d,g;if(1===e)this.addListenersToDirtyForRow(t);else if(2===e)this.addListenersToDirtyForCol(t);else if(0===e)for(o=[],t.imb[2]&&this.Ah(o,t.imb[2]),n=t.imb[0];n;n=n.eh)for(r=n.ah,i=n.row,a=n.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),n.Bg(),s&&s.Bg(),l&&l.Bg(),u&&u.Bg(i,a,1,1),this.addListenersToDirtyForRow(t);t.imb[2];){for(c=t.imb[2],f=!1,h=0;h<o.length;h++)if(o[h]===c){f=!0;break}if(f)t.Bh(c,2);else{for(o[o.length]=c,p=(r=c.ah).rC(),d=0;d<p;d++)t.pg(r.qg(d,c.column,!0),0);t.Bh(c,2)}}else if(3===e)for(g=t.imb[3];g;g=g.eh)g.Bg()},t.prototype.initDelay=function(t,o){var n,r,i,a,s,l,u;if(0===o)for(n=null,r=t.imb[0];r;r=n)r.kOb&&(X(t,r,r.kOb,!1),delete r.kOb),n=r.eh,a=(i=r.ah).rC(),s=i.cC(),r.row<a&&r.column<s?(e.supportRowColumnFormula&&((l=i.sg(r.column,!1))&&(l.delay=0)),r.delay=0,delete r.MDc):t.Bh(r,0);else if(3===o)for(u=t.imb[3];u;u=u.eh)u.delay=0},t.prototype.adjustDelayOfListeners=function(t,e,o){var n,r,i,a,s,l,u,c;if(0===e)for(n=t.imb[e];n;n=n.eh)r=n.ah,i=n.row,a=n.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),n.gh(o),s&&s.gh(o),l&&l.gh(o),u&&u.gh(i,a,o);else if(3===e)for(c=t.imb[3];c;c=c.eh)c.gh(o)},t.prototype.calculateDirtyNodes=function(t,e){var o,n,r,i,a,s,l,u,c,f,h,p,d,g;if(t.calcOnDemand)return!1;if(o=!1,n=null,0===e){for(i=t.imb[e];i;i=r)if(r=i.eh,i.delay<=0){if(this.shc(i),n=i.ah,a=i.row,s=i.column,l=n.rg(a,!1),(u=n.sg(s,!1))&&u.delay)continue;if(c=n.ug(!1),(f=n.recalculateCell(a,s,!i.SMc||i.SMc<9))&&f.pause){if(i.SMc=i.SMc?i.SMc+1:1,f.branch)for(r=i,h=0;h<f.branch.length;h++)(f.branch[h].dh||f.branch[h].eh||f.branch[h]===i)&&(i.delay++,(p=f.branch[h]).MDc=p.MDc||[],p.MDc.push(i))}else delete i.SMc,t.Bh(i,0),i.gh(!1),l&&l.gh(!1),u&&u.gh(!1),c&&c.gh(a,s,!1),(d=i.node&&i.node.Lf)&&d.ehc&&delete d.ehc;o=!0}}else if(3===e)for(g=t.imb[e];g;g=r)r=g.eh,0===g.delay&&((n=g.ah).recalculateNameID(g.name),t.Bh(g,3),g.gh(!1),o=!0);return o},t.prototype.calculateIterations=function(t,o){var n,r,i,a,s,l,u,c,f,h,g,m,y;if(!t.calcOnDemand&&0===o&&(n=t.imb[o])){if(r=null,i=!0,t.iterativeCalculation){for(s in t.jh)t.jh.hasOwnProperty(s)&&((l=t.jh[s].getSource()).clearValueCache&&l.clearValueCache());for(u=0;i&&u<t.iterativeCalculationMaximumIterations;u++)for(i=!1,r=n;r;r=r.eh)a=r.node&&r.node.Lf&&r.node.Lf.ehc,this.rhc(r,!a,p),a&&(r.node.Lf.ehc=d),c=r.ah,f=r.row,h=r.column,g=c.getSource().getValue(f,h),c.recalculateCell(f,h),i||(m=c.getSource().getValue(f,h),e.approximatelyEqual(g,m,t.iterativeCalculationMaximumChange)||(i=!0))}else for(r=n;r;r=r.eh)a=r.node&&r.node.Lf&&r.node.Lf.ehc,this.rhc(r,!a,0),a&&(r.node.Lf.ehc=d);for(y=null,r=n;r;r=y)y=r.eh,r.eh=d,y&&(y.dh=d)}},t.prototype.Ig=function(t,e,o,n,a,s,l){var u,c,f,h,g,m,y,C,v,b,w,T,x,A,I,R,M,k,N,O,D,F,E,j,P,G,B,_,V,H,z,U,W=this;for(s&&W.shc(t);12===n.type;)n=n.value;for(;10===n.type;)n=n.value;for(;12===n.type;)n=n.value;if(a){for(;12===a.type;)a=a.value;for(;10===a.type;)a=a.value;for(;12===a.type;)a=a.value}if(13===n.type){if((m=n.getRange(e,o,!0))===p)return;n=1===m.rowCount&&1===m.colCount?i.rf(p,p,m.row,m.col,!1,!1):i.uf(p,p,m.row,m.col,m.row+m.rowCount-1,m.col+m.colCount-1,!1,!1,!1,!1)}if(a&&a!==n&&8===a.type){if(a.source instanceof r.ErrorSource)return;c=a.value,(f=(k=n.source||a.source||l||W.xf).getCustomName(c))?N=k.getCalcSourceModel():(f=(N=W.Af.getGlobalSourceModel()||k.getCalcSourceModel()).getSource().getCustomName(c))||k.getCalcSourceModel().wg(c,!0).gmb(0,t,s),(h=N.wg(c,!0)).gmb(0,t,s),a=null,f&&W.Ig(t,e,o,f,p,s,N.getSource())}if(1===n.type&&n.endSource)for(D=(O=n).source.getSources(O.endSource),u=0;u<D.length;u++)(F=i.uf(D[u],p,O.row,O.column,O.endRow,O.endColumn,O.rowRelative,O.columnRelative,O.endRowRelative,O.endColumnRelative,e,o)).isFullRow=O.isFullRow,F.isFullColumn=O.isFullColumn,W.Ig(t,e,o,F,p,s);else if(1===n.type){if(!(N=(k=n.source!==r.BangSource&&n.source||W.xf).getCalcSourceModel()))return;if(E=n,j=t.row===d||t.column===d,P=E.tf(),y=(G=i.getRangeForReference(E,e,o)).row,v=G.col,C=y+(w=G.rowCount)-1,b=v+(T=G.colCount)-1,0===P){if(0<=e&&0<=o)if(ot(undefined,undefined,w,T))g=N.ug(!0),j?g.Xoa(y,v,w,T,t,s):g.Jg(y,v,w,T,t,s);else for(R=y;R<=C;R++)for(M=v;M<=b;M++)x=N.qg(R,M,!0),j?x&&x.gmb(3,t,s):x&&x.gmb(0,t,s);else if(0<=e&&-1===o)for(R=y;R<=C;R++)for(M=v;M<=b;M++)E.columnRelative||E.endColumnRelative?(A=N.rg(R,!0))&&A.Kg(t.row,-M,s):(x=N.qg(R,M,!0))&&x.gmb(1,t,s);else if(0<=o&&-1===e)for(R=y;R<=C;R++)for(M=v;M<=b;M++)E.rowRelative||E.endRowRelative?(I=N.sg(M,!0))&&I.Mg(t,-R,s):(x=N.qg(R,M,!0))&&x.gmb(2,t,s)}else if(1===P){if(0<=e&&0<=o)g=N.ug(!0),j?g.Xoa(y,v,w,T,t,s):g.Jg(y,v,w,T,t,s);else if(0<=e&&-1===o);else if(-1===e&&0<=o)if(E.rowRelative||E.endRowRelative);else for(y=E.row,C=E.endRow,R=y;R<=C;R++)(A=N.rg(R,!0))&&A.gmb(2,t,s)}else if(2===P)if(0<=e&&0<=o)g=N.ug(!0),j?g.Xoa(y,v,w,T,t,s):g.Jg(y,v,w,T,t,s);else if(0<=e&&-1===o);else if(-1===e&&0<=o)for(M=v;M<=b;M++)(I=N.sg(M,!0))&&I.gmb(2,t,s)}else if(9===n.type)W.Ig(t,e,o,n.value,a&&9===a.type&&a.value,s),n.value2&&W.Ig(t,e,o,n.value2,a&&9===a.type&&a.value2,s);else if(8===n.type){if(k=n.source||l||W.xf,c=S(n.value),(f=k.getCustomName(c))?N=k.getCalcSourceModel():(f=(N=W.Af.getGlobalSourceModel()||k.getCalcSourceModel()).getSource().getCustomName(c))||k.getCalcSourceModel().wg(c,!0).gmb(0,t,s),!(h=N.wg(c,!0)))return;h.gmb(0,t,s),f&&W.Ig(t,e,o,f,p,s,N.getSource())}else if(7===n.type)for((B=n.function)&&(B.isVolatile()&&(s?W.bg(t):W.Tf(t)),"GETPIVOTDATA"===B.name&&(s?W.RMc(t):W.PMc(t)),B instanceof r.Functions.AsyncFunction&&(W.Af.nia=!0)),_=n.arguments.length,u=0;u<_;u++)B&&B.skipPrecedent(u)||(V=!1,B&&B.isBranch()&&B.findTestArgument()!==u&&t instanceof L&&(n.QDc=!0,n.RDc=n.RDc||[],n.RDc[u]=[],V=!0,t.LDc=t.LDc||[],t.LDc.push(n.RDc[u])),W.Ig(t,e,o,n.arguments[u],a&&7===a.type&&a.arguments[u],s),V&&t.LDc.pop());else if(25===n.type||26===n.type){if(H=n,!(z=(N=(k=n.source||W.xf).getCalcSourceModel()).mg(H.value,!0)))return;z.gmb(0,t,s)}else 33===n.type&&((U=n).isReferenceError||(N=(k=U.source||U.contextSource||W.xf).getCalcSourceModel(),G=i.getRangeForReference(U,e,o),(x=N.qg(G.row,G.col,!0))&&x.gmb(0,t,s)))},t.prototype.Og=function(t,e){var o=this.getNodeByName(t);o&&(o.Nf||o.Lf)&&this.Ig(this.mg(t),0,0,o.Nf||o.Lf,o.Lf,e)},t.prototype.Pg=function(t,e,o,n,r){var i,a,s,l,u,c,f=this,h=t+o,p=e+n;for(l=t;l<h;l++)for(u=e;u<p;u++)i=f.Mf(l,u),a=f.Kf(l,u),(i||a)&&(s=f.Qf(l,u),c=f.qg(l,u),s&&!0!==s.isDynamicArray?f.Ig(c,s.row,s.col,i||a,a,r):f.Ig(c,l,u,i||a,a,r),r||c.kOb&&X(c.ZAb(),c,c.kOb,!1,!1))},t.prototype.Qg=function(t,e,o){var n,r,i=t+e;for(n=t;-1!==n&&n<i;n++)(r=this.getColumnExpression(n))&&this.Ig(this.sg(n,!1),-1,n,r,r,o)},t.prototype.Rg=function(t,e,o,n){this.Pg(t,e,o,n,!0)},t.prototype.Sg=function(t,e,o,n){this.Pg(t,e,o,n,!1)},t.prototype.Tg=function(t,e){},t.prototype.Ug=function(t,e){},t.prototype.Vg=function(t,e){this.Qg(t,e,!0)},t.prototype.Wg=function(t,e){this.Qg(t,e,!1)},t.prototype.Xg=function(t,e,o,n,r,i,a){var s,l,u,c=t+o,f=e+n;for(s=t;s<c;s++)for(l=e;l<f;l++)(u=this.qg(s,l,!1))&&(this.FTa(a,s,l),r&&u.Yg(),i&&u.Bg())},t.prototype.Zg=function(t,e,o,n,r){var i,a,s,l,u=this.Hf;if(-1!==t&&u)for(i=I(t+e,u.length),a=t;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,a,-1),l=s.calc,o&&l.Yg(),n&&l.Bg())},t.prototype.$g=function(t,e,o,n,r){var i,a,s,l,u=this.If;if(-1!==t&&u)for(i=I(t+e,u.length),a=t;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,-1,a),l=s.calc,o&&l.Yg(),n&&l.Bg())},t.prototype._g=function(t,e,o,n,r,i,a){var s,l,u,c;(r||i)&&(s=this,l=void 0,a&&(l=s.dUa()),0<=t&&0<=e?(s.Xg(t,e,o,n,r,i,l),s.Zg(t,o,r,i,l),s.$g(e,n,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))):0<=t&&-1===e?(s.Xg(t,0,o,s.cC(),r,i,l),s.Zg(t,o,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))):-1===t&&0<=e?(s.Xg(0,e,s.rC(),n,r,i,l),s.$g(e,n,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))):-1===t&&-1===e&&(u=s.rC(),c=s.cC(),s.Xg(0,0,u,c,r,i,l),s.Zg(0,u,r,i,l),s.$g(0,c,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,o,n),i&&s.vg.Bg(t,e,o,n))))},t.prototype.getAllNodes=function(){var t,e,o,n,r=[],i=this.dataTable,a=this.Hf,s=this.If,l=this.Jf;for(e in l&&r.push(l),a)a.hasOwnProperty(e)&&((t=a[e])&&r.push(t));for(e in s)s.hasOwnProperty(e)&&((t=s[e])&&r.push(t));for(o in i)if(i.hasOwnProperty(o)&&(n=i[o]))for(e in n)n.hasOwnProperty(e)&&((t=n[e])&&r.push(t));return r},t.prototype.toJSON=function(t){e.supportRowColumnFormula?this.xf.toJSON(t,this.dataTable,this.Ef,this.Ff,this.If):this.xf.toJSON(t,this.dataTable,this.Ef,this.Ff)},t}(),e.CalcSourceModel=P,L=function(t){function e(e,o,n){var r=t.call(this,e)||this;return r.row=o,r.column=n,r.delay=0,r}return H(e,t),e.prototype.getKey=function(){var t=this,e=t.ah;return(null===e?"":e.xf.id+",")+t.row+","+t.column},e.prototype.og=function(){var t=this;t.ah.Rg(t.row,t.column,1,1)},e.prototype.ng=function(){var t=this;t.ah.Sg(t.row,t.column,1,1)},e.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},e.prototype.fh=function(){this.ah.Cf().pg(this,0)},e.prototype.Bg=function(){var t,e,o,n,r,i,a,s,l=this.ah.Cf(),u=this.Ze;for(e=0;e<u.length;e++)if(o=this[u[e]])for(n in o)o.hasOwnProperty(n)&&(!(t=o[n])||t.dh||t.eh||t.fh(),l.calcOnDemand&&t&&!t.$l&&(t.$l=!0,t.Bg()));if((r=this.node&&this.node.Pf)&&r.isDynamicArray)for(i=0;i<r.rowCount;i++)for(a=0;a<r.colCount;a++)0===i&&0===a||(s=this.ah.getNode(i+r.row,a+r.col))&&s.calc&&s.calc.Bg()},e.prototype.y$a=function(){var t,e,o,n,r,i,a,s=this,l=s.ah,u=l.getCalcService();u&&u.nia&&(!(e=(t=s.nia)&&s.z$a)&&A(t)&&((o=l.getSource())&&(n=o.getName(),(r=u.lh.asyncManager.y5[n])&&((i=r[s.row])&&((a=i[s.column])&&((e=a[0])?(s.nia=!0,s.z$a=e,e.h_a=s):s.nia=!1))))),e&&0===e.evaluateMode&&(e.v5=!1))},e}(O),e.CellCalc=L,G=function(t){function e(e,o){var n=t.call(this,e)||this;return n.row=o,n}return H(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+this.row+",-1"},e.prototype.og=function(){this.ah.Tg(this.row,1)},e.prototype.ng=function(){this.ah.Ug(this.row,1)},e.prototype.Kg=function(t,e,o){o?function(t,e,o){t[e]||(t[e]=[]),t[e].push(o)}(this,R,{row:t,columnOffset:e,columnCount:1}):function(t,e,o){var n,r=t[e];if(r)for(n=0;n<r.length;n++)if(r[n]===o)return void r.splice(n,1)}(this,R,{row:t,columnOffset:e,columnCount:1})},e.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},e.prototype.fh=function(){this.ah.Cf().pg(this,1)},e}(O),e.RowCalc=G,B=function(t){function e(e,o){var n=t.call(this,e)||this;return n.column=o,n}return H(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+"-1,"+this.column},e.prototype.og=function(){this.ah.Vg(this.column,1)},e.prototype.ng=function(){this.ah.Wg(this.column,1)},e.prototype.Mg=function(t,e,o){this.gmb(2,t,o)},e.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},e.prototype.fh=function(){this.ah.Cf().pg(this,2)},e}(O),e.ColumnCalc=B,_=function(t){function e(e,o){var n=t.call(this,e)||this;return n.name=o,n}return H(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+this.name},e.prototype.updateListening=function(t,e){var o,n,r,i,a,s,l,u,c=this.Ze;for(r=0;r<c.length;r++)if(i=this[c[r]]){for(s in a=[],i)i.hasOwnProperty(s)&&((o=i[s])&&a.push(o));for(l=a.length,u=0;u<l;u++)n=(o=a[u]).node,o.ng(),n&&(!n.Pf||n.Pf.row===o.row&&n.Pf.col===o.column)&&o.ah.fg(o.row,o.column,n.Lf,n.Pf,!0)}},e.prototype.updateListeningOnRemoved=function(){var t,e,o,n,r,i,a,s,l,u,c=this,f=c.Ze,h=c.ah,p=h.Cf();for(i=0;i<f.length;i++)if(a=c[f[i]])for(s in a)a.hasOwnProperty(s)&&((t=a[s])&&(e=t.ah,o=t.row,n=t.col,o=o===d?-1:o,n=n===d?-1:n,r=e.Kf(o,n),l=e.Qf(o,n),r&&((u=p.ih().adjustFormulaOnRemoveName(h,r,c.name))!==r&&e.fg(o,n,u,l,!0))))},e.prototype.fh=function(){var t,e,o,n,r=this.Ze;for(e=0;e<r.length;e++)if(o=this[r[e]])for(n in o)o.hasOwnProperty(n)&&((t=o[n])&&t.fh())},e}(O),e.NameCalc=_,V=function(t){function e(e){return t.call(this,e)||this}return H(e,t),e.prototype.processListener=function(t,e,o,n,r,i,a,s){var l,u,c,f=this,h=f[t],p=e+","+o+","+n+","+r;if(3!==t||i instanceof D){if(i.LDc&&i.LDc.length>=1&&((u=i.LDc)[u.length-1].push(this),p="?"+p),s&&(p="!"+p),h||(f.Ze.push(t),f[t]=h={}),!(l=h[p])){if(!a)return;(l=h[p]={}).content={},l.length=0,l.row=e,l.col=o,l.rowCount=n,l.colCount=r}if(c=i.getKey(),a){if(l.content[c])return;l.content[c]=i,l.length++}else l.content[c]&&(delete l.content[c],l.length--,l.length<1&&(delete l.content,delete h[p]));f.clearListenersCache()}},e.prototype.Jg=function(t,e,o,n,r,i,a){this.processListener(0,t,e,o,n,r,i,a)},e.prototype.Xoa=function(t,e,o,n,r,i){this.processListener(3,t,e,o,n,r,i)},e.prototype.Yg=function(t,e,o,n){this.visit(0,t,e,o,n)},e.prototype.clearListenersCache=function(){var t,e=this.Ze;for(t=0;t<e.length;t++)delete this[e[t]+"cached"]},e.prototype.getListeners=function(t,e){var o,r,i,a,s=t[e],l=this[s];if(l&&!(o=this[r=s+"cached"]))for(i in o=this[r]=new n.Common.rbush(16),l)l.hasOwnProperty(i)&&((a=l[i])&&o.insert({minX:a.col,minY:a.row,maxX:a.col+a.colCount-1,maxY:a.row+a.rowCount-1,item:a}));return o},e.prototype.visit=function(t,e,o,n,r){var i,a,s,l,u,c,f=this.Ze;for(i=0;i<f.length;i++)if(this[f[i]])for(a=this.getListeners(f,i).search({minX:o,minY:e,maxX:o+r-1,maxY:e+n-1}),s=0;s<a.length;s++)for(u in l=a[s].item.content)c=l[u],0===t?c.bh():c.fh()},e.prototype.Bg=function(t,e,o,n){this.visit(1,t,e,o,n)},e.prototype.gh=function(t,e,o){var n,r,i,a,s,u,c=this.Ze,f=o?1:-1;for(n=0;n<c.length;n++)if(this[c[n]])for(r=this.getListeners(c,n).search({minX:e,minY:t,maxX:e,maxY:t}),i=0;i<r.length;i++)for(s in a=r[i].item.content)u=a[s],l(u,O)&&(u.delay+=f)},e.prototype.og=function(){},e.prototype.ng=function(){},e}(O),e.RangeCalc=V,e.CWc=K,e.Mh=Q,e.pf=tt,e.qf=et},"./src/calcEngine.res.en.ts":function(t,e,o){"use strict";var n,r;function i(t,e){return{description:t,parameters:e}}function a(t,e){return{name:t,repeatable:e}}Object.defineProperty(e,"__esModule",{value:!0}),n="[start_num]",r="[significance]",e.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_h:{ABS:i("This function calculates the absolute value of the specified value.",[a("number")]),ACCRINT:i("This function calculates the accrued interest for a security that pays periodic interest.",[a("issue"),a("first_interest"),a("settlement"),a("rate"),a("par"),a("frequency"),a("basis")]),ACCRINTM:i("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[a("issue"),a("settlement"),a("rate"),a("par"),a("basis")]),ACOS:i("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[a("number")]),ACOSH:i("This function calculates the inverse hyperbolic cosine of the specified value.",[a("number")]),ADDRESS:i("This function uses the row and column numbers to create a cell address in text.",[a("row_num"),a("column_num"),a("abs_num"),a("a1style"),a("sheet_text")]),AGGREGATE:i("This function aggregate a list of numbers using a specified built-in function.",[a("function_num"),a("options"),a("ref1"),a("ref2",!0)]),AMORDEGRC:i("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[a("cost"),a("date_purchased"),a("first_period"),a("salvage"),a("period"),a("rate"),a("basis")]),AMORLINC:i("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[a("cost"),a("date_purchased"),a("first_period"),a("salvage"),a("period"),a("rate"),a("basis")]),AND:i("Check whether all arguments are True, and returns True if all arguments are True.",[a("logical1"),a("logical2")]),ASIN:i("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[a("number")]),ASINH:i("This function calculates the inverse hyperbolic sine of a number.",[a("number")]),ATAN:i("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[a("number")]),ATAN2:i("This function calculates the arctangent of the specified x- and y-coordinates.",[a("x_num"),a("y_num")]),ATANH:i("This function calculates the inverse hyperbolic tangent of a number.",[a("number")]),AVEDEV:i("This function calculates the average of the absolute deviations of the specified values from their mean.",[a("number1"),a("number2",!0)]),AVERAGE:i("This function calculates the average of the specified numeric values.",[a("number1"),a("number2",!0)]),AVERAGEA:i("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[a("value1"),a("value2",!0)]),AVERAGEIF:i("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[a("range"),a("criteria"),a("[average_range]")]),AVERAGEIFS:i("This function calculates the average of all cells that meet multiple specified criteria.",[a("average_range"),a("criteria_range1",!0),a("criteria1",!0)]),BESSELI:i("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[a("value"),a("order")]),BESSELJ:i("This function calculates the Bessel function of the first kind.",[a("value"),a("order")]),BESSELK:i("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[a("value"),a("order")]),BESSELY:i("This function calculates the Bessel function of the second kind.",[a("value"),a("order")]),BETADIST:i("This function calculates the cumulative beta distribution function.",[a("x"),a("alpha"),a("beta"),a("lower"),a("upper")]),BETAINV:i("This function calculates the inverse of the cumulative beta distribution function.",[a("probability"),a("alpha"),a("beta"),a("lower"),a("upper")]),BIN2DEC:i("This function converts a binary number to a decimal number",[a("number")]),BIN2HEX:i("This function converts a binary number to a hexadecimal number.",[a("number"),a("places")]),BIN2OCT:i("This function converts a binary number to an octal number.",[a("number"),a("places")]),BINOMDIST:i("This function calculates the individual term binomial distribution probability.",[a("number_s"),a("trials"),a("probability_s"),a("cumulative")]),CEILING:i("This function rounds a number up to the nearest multiple of a specified value.",[a("number"),a("significance")]),CHAR:i("This function returns the character specified by a number.",[a("number")]),CHIDIST:i("This function calculates the one-tailed probability of the chi-squared distribution.",[a("value"),a("deg_freedom")]),CHIINV:i("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[a("probability"),a("deg_freedom")]),CHITEST:i("This function calculates the test for independence from the chi-squared distribution.",[a("actual_range"),a("expected_range")]),CHOOSE:i("This function returns a value from a list of values.",[a("index_num"),a("value1"),a("value2",!0)]),CLEAN:i("This function removes all non-printable characters from text.",[a("text")]),CODE:i("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[a("text")]),COLUMN:i("This function returns the column number of a reference.",[a("reference")]),COLUMNS:i("This function returns the number of columns in an array.",[a("array")]),COMBIN:i("This function calculates the number of possible combinations for a specified number of items.",[a("number"),a("number_chosen")]),COMPLEX:i("This function converts real and imaginary coefficients into a complex number.",[a("real_num"),a("image_num"),a("suffix")]),CONCATENATE:i("This function combines multiple text strings or numbers into one text string.",[a("text1"),a("text2",!0)]),CONFIDENCE:i("This function returns confidence interval for a population mean.",[a("alpha"),a("standard_dev"),a("size")]),CONVERT:i("This function converts a number from one measurement system to its equivalent in another measurement system.",[a("number"),a("from_unit"),a("to_unit")]),CORREL:i("This function returns the correlation coefficient of the two sets of data.",[a("array1"),a("array2")]),COS:i("This function returns the cosine of the specified angle.",[a("number")]),COSH:i("This function returns the hyperbolic cosine of the specified value.",[a("number")]),COUNT:i("This function returns the number of cells that contain numbers.",[a("value1"),a("value2",!0)]),COUNTA:i("This function returns the number of number of cells that contain numbers, text, or logical values.",[a("value1"),a("value2",!0)]),COUNTBLANK:i("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[a("cellrange")]),COUNTIF:i("This function returns the number of cells that meet a certain condition",[a("cellrange"),a("criteria")]),COUNTIFS:i("This function returns the number of cells that meet multiple conditions.",[a("criteria_range1",!0),a("criteria1",!0)]),COUPDAYBS:i("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPDAYS:i("This function returns the number of days in the coupon period that contains the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPDAYSNC:i("This function calculates the number of days from the settlement date to the next coupon date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPNCD:i("This function returns a date number of the next coupon date after the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPNUM:i("This function returns the number of coupons due between the settlement date and maturity date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COUPPCD:i("This function returns a date number of the previous coupon date before the settlement date.",[a("settlement"),a("maturity"),a("frequency"),a("basis")]),COVAR:i("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),CRITBINOM:i("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[a("trials"),a("probability_s"),a("alpha")]),CUMIPMT:i("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[a("rate"),a("nper"),a("pval"),a("start_period"),a("end_period"),a("paytype")]),CUMPRINC:i("This function returns the cumulative principal paid on a loan between the start and end periods.",[a("rate"),a("nper"),a("pval"),a("start_period"),a("end_period"),a("paytype")]),DATE:i("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[a("year"),a("month"),a("day")]),DATEDIF:i("This function returns the number of days, months, or years between two dates.",[a("start_date"),a("end_date"),a("unit")]),DATEVALUE:i("This function returns a DateTime object of the specified date.",[a("date_text")]),DAVERAGE:i("This function calculates the average of values in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DAY:i("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[a("date")]),DAYS360:i("This function returns the number of days between two dates based on a 360-day year.",[a("start_date"),a("end_date"),a("method")]),DB:i("This function calculates the depreciation of an asset for a specified period using the fixed‑declining balance method",[a("cost"),a("salvage"),a("life"),a("period"),a("month")]),DCOUNT:i("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[a("database"),a("field"),a("criteria")]),DCOUNTA:i("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[a("database"),a("field"),a("criteria")]),DDB:i("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[a("cost"),a("salvage"),a("life"),a("period"),a("factor")]),DEC2BIN:i("This function converts a decimal number to a binary number.",[a("number"),a("places")]),DEC2HEX:i("This function converts a decimal number to a hexadecimal number",[a("number"),a("places")]),DEC2OCT:i("This function converts a decimal number to an octal number",[a("number"),a("places")]),DEGREES:i("This function converts the specified value from radians to degrees",[a("angle")]),DELTA:i("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[a("number1"),a("number2")]),DEVSQ:i("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[a("number1"),a("number2",!0)]),DGET:i("This function extracts a single value from a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DISC:i("This function calculates the discount rate for a security.",[a("settlement"),a("maturity"),a("price"),a("redemption"),a("basis")]),DMAX:i("This function returns the largest number in a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DMIN:i("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[a("database"),a("field"),a("criteria")]),DOLLAR:i("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[a("number"),a("decimals")]),DOLLARDE:i("This function converts a fraction dollar price to a decimal dollar price.",[a("fractional_dollar"),a("fraction")]),DOLLARFR:i("This function converts a decimal number dollar price to a fraction dollar price.",[a("decimal_dollar"),a("fraction")]),DPRODUCT:i("This function multiplies the values in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSTDEV:i("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSTDEVP:i("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DSUM:i("This function adds the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DURATION:i("This function returns the Macaulay duration for an assumed par value of $100.",[a("settlement"),a("maturity"),a("coupon"),a("yield"),a("frequency"),a("basis")]),DVAR:i("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),DVARP:i("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[a("database"),a("field"),a("criteria")]),EDATE:i("This function calculates the date that is the indicated number of months before or after a specified date.",[a("start_date"),a("months")]),EFFECT:i("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[a("nominal_rate"),a("npery")]),EOMONTH:i("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[a("start_date"),a("months")]),ERF:i("This function calculates the error function integrated between a lower and an upper limit.",[a("lower_limit"),a("upper_limit")]),ERFC:i("This function calculates the complementary error function integrated between a lower limit and infinity.",[a("lowerlimit")]),"ERROR.TYPE":i("This function returns a number corresponding to one of the error values.",[a("error_val")]),EURO:i("This function returns the equivalent of one Euro based on the ISO currency code.",[a("code")]),EUROCONVERT:i("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[a("number"),a("source"),a("target"),a("full_precision"),a("triangulation_precision")]),EVEN:i("This function rounds the specified value up to the nearest even integer.",[a("number")]),EXACT:i("This function returns true if two strings are the same; otherwise, false.",[a("text1"),a("text2")]),EXP:i("This function returns e raised to the power of the specified value.",[a("number")]),EXPONDIST:i("This function returns the exponential distribution or the probability density.",[a("value"),a("lambda"),a("cumulative")]),FACT:i("This function calculates the factorial of the specified number.",[a("number")]),FACTDOUBLE:i("This function calculates the double factorial of the specified number.",[a("number")]),FALSE:i("This function returns the value for logical FALSE.",[]),FDIST:i("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[a("value"),a("deg_freedom1"),a("deg_freedom2")]),FIND:i("This function finds one text value within another and returns the text value’s position in the text you searched.",[a("find_text"),a("within_text"),a(n)]),FINV:i("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),FISHER:i("This function returns the Fisher transformation for a specified value.",[a("value")]),FISHERINV:i("This function returns the inverse of the Fisher transformation for a specified value.",[a("value")]),FIXED:i("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[a("number"),a("decimals"),a("no_commas")]),FLOOR:i("This function rounds a number down to the nearest multiple of a specified value.",[a("number"),a("significance")]),FORECAST:i("This function calculates a future value using existing values.",[a("value"),a("Yarray"),a("Xarray")]),FREQUENCY:i("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[a("data_array"),a("bins_array")]),FTEST:i("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[a("array1"),a("array2")]),FV:i("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[a("rate"),a("numper"),a("paymt"),a("pval"),a("type")]),FVSCHEDULE:i("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[a("principal"),a("schedule")]),GAMMADIST:i("This function returns the gamma distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),GAMMAINV:i("This function returns the inverse of the gamma cumulative distribution.",[a("probability"),a("alpha"),a("beta")]),GAMMALN:i("This function returns the natural logarithm of the Gamma function, G(x).",[a("value")]),GCD:i("This function returns the greatest common divisor of two numbers.",[a("number1"),a("number2")]),GEOMEAN:i("This function returns the geometric mean of a set of positive data.",[a("number1"),a("number2",!0)]),GESTEP:i("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[a("number"),a("step")]),GROWTH:i("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[a("y"),a("x"),a("newx"),a("constant")]),HARMEAN:i("This function returns the harmonic mean of a data set.",[a("number1"),a("number2",!0)]),HEX2BIN:i("This function converts a hexadecimal number to a binary number.",[a("number"),a("places")]),HEX2DEC:i("This function converts a hexadecimal number to a decimal number.",[a("number")]),HEX2OCT:i("This function converts a hexadecimal number to an octal number.",[a("number"),a("places")]),HLOOKUP:i("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[a("lookup_value"),a("table_array"),a("row_index_num"),a("range_lookup")]),HOUR:i("This function returns the hour that corresponds to a specified time.",[a("time")]),HYPGEOMDIST:i("This function returns the hypergeometric distribution.",[a("sample_s"),a("number_sample"),a("population_s"),a("number_pop")]),IF:i("This function performs a comparison and returns one of two provided values based on that comparison.",[a("logical_test"),a("value_if_true"),a("value_if_false")]),IFERROR:i("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[a("value"),a("value_if_error")]),IMABS:i("This function returns the absolute value or modulus of a complex number.",[a("complexnum")]),IMAGINARY:i("This function returns the imaginary coefficient of a complex number.",[a("complexnum")]),IMARGUMENT:i("This function returns the argument theta, which is an angle expressed in radians.",[a("complexnum")]),IMCONJUGATE:i("This function returns the complex conjugate of a complex number.",[a("complexnum")]),IMCOS:i("This function returns the cosine of a complex number.",[a("complexnum")]),IMDIV:i("This function returns the quotient of two complex numbers.",[a("complexnum"),a("complexdenom")]),IMEXP:i("This function returns the exponential of a complex number.",[a("complexnum")]),IMLN:i("This function returns the natural logarithm of a complex number.",[a("complexnum")]),IMLOG2:i("This function returns the base-2 logarithm of a complex number.",[a("complexnum")]),IMLOG10:i("This function returns the common logarithm of a complex number.",[a("complexnum")]),IMPOWER:i("This function returns a complex number raised to a power.",[a("complexnum"),a("powernum")]),IMPRODUCT:i("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2",!0)]),IMREAL:i("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSIN:i("This function returns the sine of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSQRT:i("This function returns the square root of a complex number in the x+yi or x+yj text format.",[a("complexnum")]),IMSUB:i("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2")]),IMSUM:i("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[a("complexnum1"),a("complexnum2",!0)]),INDEX:i("This function returns a value or the reference to a value from within an array or range.",[a("array"),a("row_num"),a("column_num"),a("area_num")]),INDIRECT:i("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[a("ref_text"),a("[a1_style]")]),INT:i("This function rounds a specified number down to the nearest integer.",[a("number")]),INTERCEPT:i("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[a("dependent"),a("independent")]),INTRATE:i("This function calculates the interest rate for a fully invested security.",[a("settlement"),a("maturity"),a("investment"),a("redemption"),a("basis")]),IPMT:i("This function calculates the payment of interest on a loan.",[a("rate"),a("per"),a("nper"),a("pval"),a("fval"),a("type")]),IRR:i("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[a("arrayvals"),a("estimate")]),ISBLANK:i("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[a("cellreference")]),ISERR:i("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[a("cellreference")]),ISERROR:i("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[a("cellreference")]),ISEVEN:i("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[a("cellreference")]),ISLOGICAL:i("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[a("cellreference")]),ISNA:i("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[a("cellreference")]),ISNONTEXT:i("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[a("cellreference")]),ISNUMBER:i("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[a("cellreference")]),ISODD:i("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[a("cellreference")]),ISPMT:i("This function calculates the interest paid during a specific period of an investment.",[a("rate"),a("per"),a("nper"),a("pv")]),ISREF:i("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[a("cellreference")]),ISTEXT:i("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[a("cellreference")]),KURT:i("This function returns the kurtosis of a data set.",[a("number1"),a("number2"),a("number3"),a("number4",!0)]),LARGE:i("This function returns the nth largest value in a data set, where n is specified.",[a("array"),a("n")]),LCM:i("This function returns the least common multiple of two numbers.",[a("number1"),a("number2")]),LEFT:i("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[a("text"),a("num_chars")]),LEN:i("This function returns the length of the number of characters in a text string.",[a("text")]),LINEST:i("This function calculates the statistics for a line.",[a("y"),a("x"),a("constant"),a("stats")]),LN:i("This function returns the natural logarithm of the specified number.",[a("value")]),LOG:i("This function returns the logarithm base Y of a number X.",[a("number"),a("base")]),LOG10:i("This function returns the logarithm base 10 of the number given.",[a("number")]),LOGEST:i("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[a("y"),a("x"),a("constant"),a("stats")]),LOGINV:i("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),LOGNORMDIST:i("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[a("x"),a("mean"),a("standard_dev")]),LOOKUP:i("This function searches for a value and returns a value from the same location in a second area.",[a("lookup_value"),a("lookup_vector"),a("result_vector")]),LOWER:i("This function converts text to lower case letters.",[a("text")]),MATCH:i("This function returns the relative position of a specified item in a range.",[a("lookup_value"),a("lookup_array"),a("match_type")]),XMATCH:i("This function returns the relative position of an item in an array. By default, an exact match is required.",[a("lookup_value"),a("lookup_array"),a("[match_mode]"),a("[search_mode]")]),XLOOKUP:i("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[a("lookup_value"),a("lookup_array"),a("return_array"),a("[if_not_found]"),a("[match_mode]"),a("[search_mode]")]),MAX:i("This function returns the maximum value, the greatest value, of all the values in the arguments.",[a("number1"),a("number2",!0)]),MAXA:i("This function returns the largest value in a list of arguments, including text and logical values.",[a("value1"),a("value2",!0)]),MDETERM:i("This function returns the matrix determinant of an array.",[a("array")]),MDURATION:i("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[a("settlement"),a("maturity"),a("coupon"),a("yield"),a("frequency"),a("basis")]),MEDIAN:i("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[a("number1"),a("number2",!0)]),MID:i("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[a("text"),a("start_num"),a("num_chars")]),MIN:i("This function returns the minimum value, the least value, of all the values in the arguments.",[a("number1"),a("number2",!0)]),MINA:i("This function returns the minimum value in a list of arguments, including text and logical values.",[a("value1"),a("value2",!0)]),MINUTE:i("This function returns the minute corresponding to a specified time.",[a("time")]),MINVERSE:i("This function returns the inverse matrix for the matrix stored in an array.",[a("array")]),MIRR:i("This function returns the modified internal rate of return for a series of periodic cash flows.",[a("values"),a("finance_rate"),a("reinvest_rate")]),MMULT:i("This function returns the matrix product for two arrays.",[a("array1"),a("array2")]),MOD:i("This function returns the remainder of a division operation.",[a("dividend"),a("divisor")]),MODE:i("This function returns the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),MONTH:i("This function returns the month corresponding to the specified date value.",[a("date")]),MROUND:i("This function returns a number rounded to the desired multiple.",[a("number"),a("multiple")]),MULTINOMIAL:i("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[a("number1"),a("number2",!0)]),MUNIT:i("The function returns the unit matrix for the specified dimension.",[a("dimension")]),N:i("This function returns a value converted to a number.",[a("value")]),NA:i("This function returns the error value #N/A that means not available.",[]),SHEET:i("Returns the sheet number of reference sheet.",[a("[value]")]),SHEETS:i("Returns the number of sheets in a reference.",[a("[reference]")]),NEGBINOMDIST:i("This function returns the negative binomial distribution.",[a("number_f"),a("number_s"),a("probability_s")]),NETWORKDAYS:i("This function returns the total number of complete working days between the start and end dates.",[a("start_date"),a("end_date"),a("holidays")]),NOMINAL:i("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[a("effect_rate"),a("npery")]),NORMDIST:i("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[a("x"),a("mean"),a("standard_dev"),a("cumulative")]),NORMINV:i("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),NORMSDIST:i("This function returns the standard normal cumulative distribution function.",[a("value")]),NORMSINV:i("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[a("probability")]),NOT:i("This function reverses the logical value of its argument.",[a("logical")]),NOW:i("This function returns the current date and time.",[]),NPER:i("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[a("rate"),a("paymt"),a("pval"),a("fval"),a("type")]),NPV:i("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[a("rate"),a("value1"),a("value2",!0)]),OBJECT:i("This function converts the property/expression sequence to an object.",[a("property1",!0),a("expression1",!0)]),OCT2BIN:i("This function converts an octal number to a binary number.",[a("number"),a("places")]),OCT2DEC:i("This function converts an octal number to a decimal number.",[a("number")]),OCT2HEX:i("This function converts an octal number to a hexadecimal number.",[a("number"),a("places")]),ODD:i("This function rounds the specified value up to the nearest odd integer.",[a("number")]),ODDFPRICE:i("This function calculates the price per $100 face value of a security with an odd first period.",[a("settlement"),a("maturity"),a("issue"),a("first_coupon"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),ODDFYIELD:i("This function calculates the yield of a security with an odd first period.",[a("settlement"),a("maturity"),a("issue"),a("first_coupon"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),ODDLPRICE:i("This function calculates the price per $100 face value of a security with an odd last coupon period.",[a("settlement"),a("maturity"),a("last_interest"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),ODDLYIELD:i("This function calculates the yield of a security with an odd last period.",[a("settlement"),a("maturity"),a("last_interest"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),OFFSET:i("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[a("reference"),a("rows"),a("cols"),a("height"),a("width")]),OR:i("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[a("logical1"),a("logical2",!0)]),PEARSON:i("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[a("array_ind"),a("array_dep")]),PERCENTILE:i("This function returns the nth percentile of values in a range.",[a("array"),a("n")]),PERCENTRANK:i("This function returns the rank of a value in a data set as a percentage of the data set.",[a("array"),a("x"),a("significance")]),PERMUT:i("This function returns the number of possible permutations for a specified number of items.",[a("number"),a("number_chosen")]),PI:i("This function returns PI as 3.1415926536.",[]),PMT:i("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[a("rate"),a("nper"),a("pval"),a("fval"),a("type")]),POISSON:i("This function returns the Poisson distribution.",[a("nevents"),a("mean"),a("cumulative")]),POWER:i("This function raises the specified number to the specified power.",[a("number"),a("power")]),PPMT:i("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[a("rate"),a("per"),a("nper"),a("pval"),a("fval"),a("type")]),PRICE:i("This function calculates the price per $100 face value of a periodic interest security",[a("settlement"),a("maturity"),a("rate"),a("yield"),a("redemption"),a("frequency"),a("basis")]),PRICEDISC:i("This function returns the price per $100 face value of a discounted security.",[a("settlement"),a("maturity"),a("discount"),a("redemption"),a("basis")]),PRICEMAT:i("This function returns the price at maturity per $100 face value of a security that pays interest.",[a("settlement"),a("maturity"),a("issue"),a("rate"),a("yield"),a("basis")]),PROB:i("This function returns the probability that values in a range are between two limits.",[a("x_range"),a("prob_range"),a("lower_limit"),a("upper_limit")]),PRODUCT:i("This function multiplies all the arguments and returns the product.",[a("number1"),a("number2",!0)]),PROPER:i("This function capitalizes the first letter in each word of a text string.",[a("text")]),PROPERTY:i("This function returns the value of property path in object.",[a("data_expression"),a("property_path")]),PV:i("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[a("rate"),a("numper"),a("paymt"),a("fval"),a("type")]),QUARTILE:i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),QUOTIENT:i("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[a("numerator"),a("denominator")]),RADIANS:i("This function converts the specified number from degrees to radians.",[a("angle")]),RAND:i("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:i("This function returns a random number between the numbers you specify.",[a("bottom"),a("top")]),RANGEBLOCKSPARKLINE:i("This function returns a rangetemplate.",[a("template_range"),a("data_expression")]),RANK:i("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[a("number"),a("ref"),a("order")]),RATE:i("This function returns the interest rate per period of an annuity.",[a("nper"),a("pmt"),a("pval"),a("fval"),a("type"),a("guess")]),RECEIVED:i("This function returns the amount received at maturity for a fully invested security.",[a("settlement"),a("maturity"),a("investment"),a("discount"),a("basis")]),REPLACE:i("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[a("old_text"),a("start_num"),a("num_chars"),a("new_text")]),REPT:i("This function repeats text a specified number of times.",[a("text"),a("number_times")]),RIGHT:i("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[a("text"),a("num_chars")]),ROMAN:i("This function converts an Arabic numeral to a Roman numeral text equivalent.",[a("number"),a("form")]),ROUND:i("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROUNDDOWN:i("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROUNDUP:i("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[a("number"),a("num_digits")]),ROW:i("This function returns the number of a row from a reference.",[a("reference")]),ROWS:i("This function returns the number of rows in an array.",[a("array")]),RSQ:i("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[a("array_dep"),a("array_ind")]),SEARCH:i("This function finds one text string in another text string and returns the index of the starting position of the found text.",[a("find_text"),a("within_text"),a(n)]),SECOND:i("This function returns the seconds (0 to 59) value for a specified time.",[a("time")]),SERIESSUM:i("This function returns the sum of a power series.",[a("x"),a("n"),a("m"),a("coefficients")]),SIGN:i("This function returns the sign of a number or expression.",[a("cellreference")]),SIN:i("This function returns the sine of the specified angle.",[a("angle")]),SINH:i("This function returns the hyperbolic sine of the specified number.",[a("number")]),SKEW:i("This function returns the skewness of a distribution.",[a("number1"),a("number2",!0)]),SLN:i("This function returns the straight-line depreciation of an asset for one period.",[a("cost"),a("salvage"),a("life")]),SLOPE:i("This function calculates the slope of a linear regression.",[a("array_dep"),a("array_ind")]),SMALL:i("This function returns the nth smallest value in a data set, where n is specified.",[a("array"),a("n")]),SQRT:i("This function returns the positive square root of the specified number.",[a("value")]),SQRTPI:i("This function returns the positive square root of a multiple of pi (p).",[a("multiple")]),STANDARDIZE:i("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[a("x"),a("mean"),a("standard_dev")]),STDEVA:i("This function returns the standard deviation for a set of numbers, text, or logical values.",[a("value1"),a("value2",!0)]),STDEVP:i("This function returns the standard deviation for an entire specified population (of numeric values).",[a("number1"),a("number2",!0)]),STDEVPA:i("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[a("value1"),a("value2",!0)]),STEYX:i("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[a("array_dep"),a("array_ind")]),SUBSTITUTE:i("This function substitutes a new string for specified characters in an existing string.",[a("text"),a("old_text"),a("new_text"),a("instance_num")]),SUBTOTAL:i("This function calculates a subtotal of a list of numbers using a specified built-in function.",[a("function_num"),a("ref1"),a("ref2",!0)]),SUM:i("This function returns the sum of cells or range of cells.",[a("number1"),a("number2",!0)]),SUMIF:i("This function adds the cells using a given criteria.",[a("range"),a("criteria"),a("sum_range")]),SUMIFS:i("This function adds the cells in a range using multiple criteria.",[a("sum_range"),a("criteria_range1",!0),a("criteria1",!0)]),SUMPRODUCT:i("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[a("array1"),a("array2",!0)]),SUMSQ:i("This function returns the sum of the squares of the arguments.",[a("number1"),a("number2",!0)]),SUMX2MY2:i("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SUMX2PY2:i("This function returns the sum of the sum of squares of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SUMXMY2:i("This function returns the sum of the square of the differences of corresponding values in two arrays.",[a("array_x"),a("array_y")]),SYD:i("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[a("cost"),a("salvage"),a("life"),a("period")]),T:i("This function returns the text in a specified cell.",[a("value")]),TAN:i("This function returns the tangent of the specified angle.",[a("angle")]),TANH:i("This function returns the hyperbolic tangent of the specified number.",[a("number")]),TBILLEQ:i("This function returns the equivalent yield for a Treasury bill (or T-bill)",[a("settlement"),a("maturity"),a("discount")]),TBILLPRICE:i("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[a("settlement"),a("maturity"),a("discount")]),TBILLYIELD:i("This function returns the yield for a Treasury bill (or T-bill).",[a("settlement"),a("maturity"),a("priceper")]),TDIST:i("This function returns the probability for the t-distribution.",[a("x"),a("deg_freedom"),a("tails")]),TEXT:i("This function formats a number and converts it to text.",[a("value"),a("format_text")]),TIME:i("This function returns the TimeSpan object for a specified time.",[a("hour"),a("minute"),a("second")]),TIMEVALUE:i("This function returns the TimeSpan object of the time represented by a text string.",[a("time_text")]),TINV:i("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[a("probability"),a("deg_freedom")]),TODAY:i("This function returns the date and time of the current date.",[]),TRANSPOSE:i("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[a("array")]),TREND:i("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[a("y"),a("x"),a("newx"),a("constant")]),TRIM:i("This function removes extra spaces from a string and leaves single spaces between words.",[a("text")]),TRIMMEAN:i("This function returns the mean of a subset of data excluding the top and bottom data.",[a("array"),a("percent")]),TRUE:i("This function returns the value for logical TRUE.",[]),TRUNC:i("This function removes the specified fractional part of the specified number.",[a("number"),a("num_digits")]),TTEST:i("This function returns the probability associated with a t-test.",[a("array1"),a("array2"),a("tails"),a("type")]),TYPE:i("This function returns the type of value.",[a("value")]),UPPER:i("This function converts text to uppercase letters.",[a("text")]),VALUE:i("This function converts a text string that is a number to a numeric value.",[a("text")]),VAR:i("This function returns the variance based on a sample of a population, which uses only numeric values.",[a("number1"),a("number2",!0)]),VARA:i("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[a("value1"),a("value2",!0)]),VARP:i("This function returns variance based on the entire population, which uses only numeric values.",[a("number1"),a("number2",!0)]),VARPA:i("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[a("value1"),a("value2",!0)]),VDB:i("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[a("cost"),a("salvage"),a("life"),a("start_period"),a("end_period"),a("factor"),a("no_switch")]),VLOOKUP:i("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[a("lookup_value"),a("table_array"),a("col_index_num"),a("range_lookup")]),WEEKDAY:i("This function returns the number corresponding to the day of the week for a specified date.",[a("date"),a("type")]),WEEKNUM:i("This function returns a number that indicates the week of the year numerically.",[a("date"),a("weektype")]),WEIBULL:i("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),WORKDAY:i("This function returns the number of working days before or after the starting date.",[a("start_date"),a("days"),a("holidays")]),XIRR:i("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[a("values"),a("dates"),a("guess")]),XNPV:i("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[a("rate"),a("values"),a("dates")]),YEAR:i("This function returns the year as an integer for a specified date.",[a("date")]),YEARFRAC:i("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[a("start_date"),a("end_date"),a("basis")]),YIELD:i("This function calculates the yield on a security that pays periodic interest.",[a("settlement"),a("maturity"),a("rate"),a("price"),a("redemption"),a("frequency"),a("basis")]),YIELDDISC:i("This function calculates the annual yield for a discounted security.",[a("settlement"),a("maturity"),a("price"),a("redemption"),a("basis")]),YIELDMAT:i("This function calculates the annual yield of a security that pays interest at maturity.",[a("settlement"),a("maturity"),a("issue"),a("rate"),a("price"),a("basis")]),ZTEST:i("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[a("array"),a("x"),a("sigma")]),HBARSPARKLINE:i("This function returns a data set used for representing a Hbar sparkline",[a("value"),a("colorScheme"),a("axisVisible"),a("barHeight")]),VBARSPARKLINE:i("This function returns a data set used for representing a Vbar sparkline",[a("value"),a("colorScheme"),a("axisVisible"),a("barWidth")]),VARISPARKLINE:i("This function returns a data set used for representing a variance sparkline",[a("variance"),a("reference"),a("mini"),a("maxi"),a("mark"),a("tickunit"),a("legend"),a("colorPositive"),a("colorNegative"),a("vertical")]),PIESPARKLINE:i("This function returns a data set used for representing a pie sparkline",[a("range|percentage"),a("color",!0)]),AREASPARKLINE:i("This function returns a data set used for representing a area sparkline",[a("points"),a("mini"),a("maxi"),a("line1"),a("line2"),a("colorPositive"),a("colorNegative")]),SCATTERSPARKLINE:i("This function returns a data set used for representing a scatter sparkline",[a("points1"),a("points2"),a("minX"),a("maxX"),a("minY"),a("maxY"),a("hLine"),a("vLine"),a("xMinZone"),a("xMaxZone"),a("yMinZone"),a("yMaxZone"),a("tags"),a("drawSymbol"),a("drawLines"),a("color1"),a("color2"),a("dash")]),LINESPARKLINE:i("This function returns a data set used for representing a line sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),COLUMNSPARKLINE:i("This function returns a data set used for representing a column sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),WINLOSSSPARKLINE:i("This function returns a data set used for representing a win/loss sparkline",[a("data"),a("dataOrientation"),a("dateAxisData"),a("dateAxisOrientation"),a("setting")]),BULLETSPARKLINE:i("This function returns a data set used for representing a bullet sparkline",[a("measure"),a("target"),a("maxi"),a("good"),a("bad"),a("forecast"),a("tickunit"),a("colorScheme"),a("vertical"),a("measureColor"),a("targetColor"),a("maxiColor"),a("goodColor"),a("badColor"),a("forecastColor"),a("allowMeasureOverMaxi"),a("barSize")]),SPREADSPARKLINE:i("This function returns a data set used for representing a spread sparkline",[a("points"),a("showAverage"),a("scaleStart"),a("scaleEnd"),a("style"),a("colorScheme"),a("vertical")]),STACKEDSPARKLINE:i("This function returns a data set used for representing a stacked sparkline",[a("points"),a("colorRange"),a("labelRange"),a("maximum"),a("targetRed"),a("targetGreen"),a("targetBlue"),a("tragetYellow"),a("color"),a("highlightPosition"),a("vertical"),a("textOrientation"),a("textSize")]),BOXPLOTSPARKLINE:i("This function returns a data set used for representing a boxplot sparkline",[a("points"),a("boxPlotClass"),a("showAverage"),a("scaleStart"),a("scaleEnd"),a("acceptableStart"),a("acceptableEnd"),a("colorScheme"),a("style"),a("vertical")]),CASCADESPARKLINE:i("This function returns a data set used for representing a cascade sparkline",[a("pointsRange"),a("pointIndex"),a("labelsRange"),a("minimum"),a("maximum"),a("colorPositive"),a("colorNegative"),a("vertical"),a("itemTypeRange"),a("colorTotal")]),PARETOSPARKLINE:i("This function returns a data set used for representing a pareto sparkline",[a("points"),a("pointIndex"),a("colorRange"),a("target"),a("target2"),a("highlightPosition"),a("label"),a("vertical"),a("targetColor"),a("target2Color"),a("labelColor"),a("barSize")]),MONTHSPARKLINE:i("This function returns a data set used for representing a month sparkline",[a("year"),a("month"),a("dataRange"),a("emptyColor"),a("startColor"),a("middleColor"),a("endColor")]),YEARSPARKLINE:i("This function returns a data set used for representing a year sparkline",[a("year"),a("dataRange"),a("emptyColor"),a("startColor"),a("middleColor"),a("endColor")]),GAUGEKPISPARKLINE:i("This function returns a data set used for representing a gauge KPI sparkline",[a("targetValue"),a("currentValue"),a("minValue"),a("maxValue"),a("showLabel"),a("targetValueLabel"),a("currentValueLabel"),a("minValueLabel"),a("maxValueLabel"),a("fontArray"),a("minAngle"),a("maxAngle"),a("radiusRatio"),a("gaugeType"),a("colorRange"),a("...")]),HISTOGRAMSPARKLINE:i("This function returns a data set used for representing a histogram sparkline",[a("dateRange"),a("continuous"),a("paintLabel"),a("scale"),a("barWidth"),a("barColor"),a("labelFontStyle"),a("labelColor"),a("edgeColor")]),"CEILING.PRECISE":i("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[a("number"),a(r)]),"COVARIANCE.S":i("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),"FLOOR.PRECISE":i("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[a("number"),a(r)]),"PERCENTILE.EXC":i("This function returns the nth percentile of values in a range.",[a("array"),a("k")]),"QUARTILE.EXC":i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),"RANK.AVG":i("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[a("number"),a("ref"),a("[order]")]),"MODE.MULT":i("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),"STDEV.P":i("This function returns the standard deviation for an entire specified population (of numeric values).",[a("number1"),a("number2",!0)]),"VAR.P":i("This function returns variance based on the entire population, which uses only numeric values.",[a("number1"),a("number2",!0)]),"COVARIANCE.P":i("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[a("array1"),a("array2")]),"MODE.SNGL":i("This function returns the most frequently occurring value in a set of data.",[a("number1"),a("number2",!0)]),"PERCENTILE.INC":i("This function returns the nth percentile of values in a range.",[a("array"),a("k")]),"QUARTILE.INC":i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[a("array"),a("quart")]),"RANK.EQ":i("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[a("number"),a("ref"),a("[order]")]),STDEV:i("This function returns standard deviation is estimated based on a sample.",[a("number1"),a("number2",!0)]),"STDEV.S":i("This function returns standard deviation is estimated based on a sample.",[a("number1"),a("number2",!0)]),"VAR.S":i("This function returns the variance based on a sample of a population, which uses only numeric values.",[a("number1"),a("number2",!0)]),"BETA.INV":i("This function calculates the inverse of the cumulative beta distribution function.",[a("probability"),a("alpha"),a("beta"),a("[lower]"),a("[upper]")]),"BINOM.DIST":i("This function calculates the individual term binomial distribution probability.",[a("number_s"),a("trials"),a("probability_s"),a("cumulative")]),"BINOM.INV":i("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[a("trials"),a("probability_s"),a("alpha")]),"CHISQ.DIST.RT":i("This function calculates the one-tailed probability of the chi-squared distribution.",[a("value"),a("deg_freedom")]),"CHISQ.INV.RT":i("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[a("probability"),a("deg_freedom")]),"CHISQ.TEST":i("This function calculates the test for independence from the chi-squared distribution.",[a("actual_range"),a("expected_range")]),"CONFIDENCE.NORM":i("This function returns confidence interval for a population mean.",[a("alpha"),a("standard_dev"),a("size")]),"EXPON.DIST":i("This function returns the exponential distribution or the probability density.",[a("value"),a("lambda"),a("cumulative")]),"F.DIST.RT":i("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[a("value"),a("deg_freedom1"),a("deg_freedom2")]),"F.INV.RT":i("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),"F.TEST":i("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[a("array1"),a("array2")]),"GAMMA.DIST":i("This function returns the gamma distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),"GAMMA.INV":i("This function returns the inverse of the gamma cumulative distribution.",[a("probability"),a("alpha"),a("beta")]),"LOGNORM.INV":i("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),"NORM.DIST":i("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[a("x"),a("mean"),a("standard_dev"),a("cumulative")]),"NORM.INV":i("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[a("probability"),a("mean"),a("standard_dev")]),"NORM.S.INV":i("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[a("probability")]),"PERCENTRANK.INC":i("This function returns the rank of a value in a data set as a percentage of the data set.",[a("array"),a("n"),a(r)]),"POISSON.DIST":i("This function returns the Poisson distribution.",[a("nevents"),a("mean"),a("cumulative")]),"T.INV.2T":i("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[a("probability"),a("deg_freedom")]),"T.TEST":i("This function returns the probability associated with a t-test.",[a("array1"),a("array2"),a("tails"),a("type")]),"WEIBULL.DIST":i("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[a("x"),a("alpha"),a("beta"),a("cumulative")]),"Z.TEST":i("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[a("array"),a("x"),a("[sigma]")]),"T.DIST.RT":i("This function returns the right-tailed t-distribution.",[a("x"),a("deg_freedom")]),"T.DIST.2T":i("This function returns the two-tailed t-distribution.",[a("x"),a("deg_freedom")]),"ISO.CEILING":i("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[a("number"),a(r)]),"BETA.DIST":i("This function returns the beta distribution.",[a("x"),a("alpha"),a("beta"),a("cumulative"),a("lower"),a("upper")]),"GAMMALN.PRECISE":i("This function returns the natural logarithm of the gamma function.",[a("value")]),"ERF.PRECISE":i("This function returns the error function.",[a("lowerlimit")]),"ERFC.PRECISE":i("This function returns the complementary ERF function.",[a("lowerlimit")]),"PERCENTRANK.EXC":i("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[a("array"),a("x"),a(r)]),"HYPGEOM.DIST":i("This function returns the hypergeometric distribution.",[a("sample_s"),a("number_sample"),a("population_s"),a("number_pop"),a("cumulative")]),"LOGNORM.DIST":i("This function returns the log normal distribution of x.",[a("x"),a("mean"),a("stdev"),a("cumulative")]),"NEGBINOM.DIST":i("This function returns the negative binomial distribution.",[a("number_f"),a("number_s"),a("probability_s"),a("cumulative")]),"NORM.S.DIST":i("This function returns the standard normal distribution.",[a("z"),a("cumulative")]),"T.DIST":i("This function returns the t-distribution.",[a("x"),a("deg_freedom"),a("cumulative")]),"F.DIST":i("This function returns the F probability distribution.",[a("x"),a("deg_freedom1"),a("deg_freedom2"),a("cumulative")]),"CHISQ.DIST":i("This function returns the chi-squared distribution.",[a("x"),a("deg_freedom"),a("cumulative")]),"F.INV":i("This function returns the inverse of the F probability distribution.",[a("probability"),a("deg_freedom1"),a("deg_freedom2")]),"T.INV":i("This function returns the left-tailed inverse of the t-distribution.",[a("probability"),a("deg_freedom")]),"CHISQ.INV":i("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[a("probability"),a("deg_freedom")]),"CONFIDENCE.T":i("This function returns the confidence interval for a Student's t distribution.",[a("alpha"),a("standard_dev"),a("size")]),"NETWORKDAYS.INTL":i("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[a("start_date"),a("end_date"),a("[weekend]"),a("[holidays]")]),"WORKDAY.INTL":i("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[a("start_date"),a("days"),a("[weekend]"),a("[holidays]")]),REFRESH:i("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[a("formula"),a("evaluateMode"),a("interval")]),DAYS:i("This function returns the number of days between two dates.",[a("end_date"),a("start_date")]),ISOWEEKNUM:i("This function returns the number of the ISO week number of the year for a given date.",[a("date")]),BITAND:i('This function returns a bitwise "AND" of two numbers.',[a("number1"),a("number2")]),BITLSHIFT:i('This function returns a bitwise "OR" of two numbers.',[a("number"),a("shift_amount")]),BITOR:i('This function returns a bitwise "OR" of two numbers.',[a("number1"),a("number2")]),BITRSHIFT:i('This function returns a bitwise "OR" of two numbers.',[a("number"),a("shift_amount")]),BITXOR:i('This function returns a bitwise "XOR" of two numbers.',[a("number1"),a("number2")]),IMCOSH:i("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCOT:i("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCSC:i("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMCSCH:i("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMSEC:i("This function returns the secant of a complex number in x+yi of x+yj text format.",[a("complexnum")]),IMSECH:i("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[a("complexnum")]),IMSINH:i("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[a("complexnum")]),IMTAN:i("This function returns the tangent of a complex number in x+yi or x+yj text format.",[a("complexnum")]),PDURATION:i("This function returns the number of periods required by an investment to reach a specified value.",[a("rate"),a("pval"),a("fval")]),RRI:i("This function returns an equivalent interest rate for the growth of an investment.",[a("nper"),a("pval"),a("fval")]),ISFORMULA:i("This function tests whether contains a formula of a referenced cell.",[a("cellreference")]),IFNA:i("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[a("value"),a("value_if_na")]),IFS:i("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[a("logical_test1"),a("value_if_true1",!0)]),SWITCH:i("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[a("expression"),a("value1"),a("result1"),a("[default_or_value2]",!0),a("[result2]",!0)]),XOR:i("This function returns a logical exclusive or of all arguments.",[a("logical",!0)]),AREAS:i("This function returns the number of areas in a reference.",[a("reference")]),FORMULATEXT:i("This function returns a formula as a string.",[a("reference")]),HYPERLINK:i("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[a("link_location"),a("friendly_name")]),ACOT:i("This function calculates the inverse arccotangent of a number.",[a("number")]),ACOTH:i("This function calculates the inverse hyperbolic arccotangent of a number.",[a("number")]),ARABIC:i("This function converts a Roman numeral text to an Arabic numeral equivalent.",[a("text")]),BASE:i("This function converts a number into a text representation with the given radix (base).",[a("number"),a("radix"),a("[min_length]")]),"CEILING.MATH":i("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[a("number"),a(r),a("[mode]")]),COMBINA:i("This function calculates the number of possible combinations with repetitions for a specified number of items.",[a("number"),a("number_chosen")]),COT:i("This function returns the cotangent of the specified angle.",[a("angle")]),COTH:i("This function returns the hyperbolic cotangent of the specified number.",[a("value")]),CSC:i("This function returns the cosecant of the specified angle.",[a("angle")]),CSCH:i("This function returns the hyperbolic cosecant of the specified number.",[a("value")]),DECIMAL:i("This function converts a text representation of a number in a given base into a decimal number.",[a("text"),a("radix")]),"FLOOR.MATH":i("This function round a number down to the nearest integer or to the nearest multiple of significance.",[a("number"),a(r),a("[mode]")]),SEC:i("This function returns the secant of the specified angle.",[a("angle")]),SECH:i("This function returns the hyperbolic secant of the specified value.",[a("value")]),"BINOM.DIST.RANGE":i("This function calculates the probability of a trial result using a binomial distribution.",[a("trials"),a("probability_s"),a("number_s"),a("[number_s2]")]),GAMMA:i("This function returns the gamma function value.",[a("number")]),MAXIFS:i("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[a("max_range"),a("criteria_range",!0),a("criteria",!0)]),GAUSS:i("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[a("number")]),MINIFS:i("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[a("min_range"),a("criteria_range",!0),a("criteria",!0)]),PERMUTATIONA:i("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[a("number"),a("number_chosen")]),PHI:i("This function returns the value of the density function for a standard normal distribution.",[a("value")]),"SKEW.P":i("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[a("number1"),a("number2",!0)]),BAHTTEXT:i('This function converts a number to Thai text and adds a suffix of "Baht"',[a("number")]),CONCAT:i('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[a("text1"),a("text2",!0)]),FINDB:i("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[a("find_text"),a("within_text"),a(n)]),LEFTB:i("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[a("text"),a("num_bytes")]),LENB:i("This function returns the length of the number of bytes in a text string.",[a("text")]),MIDB:i("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[a("text"),a("start_num"),a("num_bytes")]),REPLACEB:i("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[a("old_text"),a("start_byte"),a("num_bytes"),a("new_text")]),RIGHTB:i("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[a("text"),a("num_bytes")]),SEARCHB:i("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[a("find_text"),a("within_text"),a(n)]),TEXTJOIN:i("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[a("delimiter"),a("ignore_empty"),a("text1"),a("text2",!0)]),UNICHAR:i("This function returns the Unicode character of a given numeric reference.",[a("number")]),UNICODE:i("This function returns the number corresponding to the first character of the text.",[a("text")]),ENCODEURL:i("This function returns a URL-encoded string.",[a("text")]),BC_QRCODE:i("This function returns a data set for representing a QRCode",[a("value"),a("color"),a("backgroundColor"),a("errorCorrectionLevel"),a("model"),a("version"),a("mask"),a("connection"),a("connectionNo"),a("charCode"),a("charset"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_EAN13:i("This function returns a data set for representing a EAN13.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("addOn"),a("addOnLabelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_EAN8:i("This function returns a data set for representing a EAN8.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODABAR:i("This function returns a data set for representing a CODABAR.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("checkDigit"),a("nwRatio"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE39:i("This function returns a data set for representing a CODE39.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("labelWithStartAndStopCharacter"),a("checkDigit"),a("nwRatio"),a("fullASCII"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE93:i("This function returns a data set for representing a CODE93.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("checkDigit"),a("fullASCII"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE128:i("This function returns a data set for representing a CODE128.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("codeSet"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_GS1_128:i("This function returns a data set for representing a GS1_128.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_CODE49:i("This function returns a data set for representing a CODE49.",[a("value"),a("color"),a("backgroundColor"),a("showLabel"),a("labelPosition"),a("grouping"),a("groupNo"),a("fontFamily"),a("fontStyle"),a("fontWeight"),a("textDecoration"),a("textAlign"),a("fontSize"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_PDF417:i("This function returns a data set for representing a PDF417.",[a("value"),a("color"),a("backgroundColor"),a("errorCorrectionLevel"),a("rows"),a("columns"),a("compact"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),BC_DATAMATRIX:i("This function returns a data set for representing a DATAMATRIX.",[a("value"),a("color"),a("backgroundColor"),a("eccMode"),a("ecc200SymbolSize"),a("ecc200EncodingMode"),a("ecc00_140SymbolSize"),a("structuredAppend"),a("structureNumber"),a("fileIdentifier"),a("quietZoneLeft"),a("quietZoneRight"),a("quietZoneTop"),a("quietZoneBottom")]),FILTER:i("This function filter a range or array.",[a("array"),a("include"),a("if_empty")]),RANDARRAY:i("This function returns an array of random numbers.",[a("rows"),a("columns"),a("min"),a("max"),a("whole_number")]),SEQUENCE:i("This function returns a sequence of numbers.",[a("rows"),a("columns"),a("start"),a("step")]),SINGLE:i("This function returns a single value when given a value, range or array.",[a("value")]),SORT:i("This function sorts a range or array.",[a("array"),a("sort_index"),a("sort_order"),a("by_col")]),SORTBY:i("This function sorts a range or array based on the values in a corresponding range or array.",[a("array"),a("by_array1"),a("sort_order1"),a("by_array2",!0),a("sort_order2",!0)]),UNIQUE:i("This function returns the unique values from a range or array.",[a("array"),a("by_col"),a("exactly_once")]),LET:i("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[a("name1"),a("name_value1"),a("calculation_or_name2"),a("[name_value2, ...")]),IMAGE:i("This function input an URL or a base64 string to show an image in cell",[a("URL"),a("[mode]"),a("[height]"),a("[width]"),a("[clipY]"),a("[clipX]"),a("[clipHeight]"),a("[clipWidth]"),a("[vAlign]"),a("[hAlign]")]),GETPIVOTDATA:i("This function extracts data stored in a PivotTable",[a("data_field"),a("pivot_table"),a("[field1, item1]"),a("...")]),WEBSERVICE:i("This function returns data from a web service",[a("url")]),FILTERJSON:i("This function parses json string to a scalar value, an object or an array of objects.",[a("json_string")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function E(t,e,o,n){return{row:t,col:e,rowCount:o,colCount:n}}function j(t,e){var o,n,r,i=t.getRangeCount(),a=t.xf,s=e.source.getCalcSourceModel().qg(e.identity.row,e.identity.col,!0);for(o=0;o<i;o++)(n=t.yf[o]).id=a.id,a.getRangeKey&&(r=a.getRangeKey(a,n),s&&(s.eOb||(s.eOb={}),s.eOb[r]=n))}function P(t,e){return t&&e?t.row===e.row&&t.col===e.col:t===e}function L(t){var e,o;for(o=0;o<t.oi.length;o++)(e=t.oi[o]).v5=!1,e.oi.length>0&&L(e)}function G(t){var e,o=!0,n=t;return t&&t.getValue&&((e=p(t,0,!1,!1)).isError?n=e[0]:1===e.rowCount&&1===e.colCount?n=e[0][0]:(n=e,o=!1)),{value:n,success:o}}function B(t,e,o){return h(e)?e:h(o)?o:t<=2?function(t,e,o){var n,i,a,s,l,u,c,f;if(0===t)return e;if(!e)return 0;if(n=G(e),n.success)return _(t,n.value);if(o){for(i=[],s=(a=n.value).rowCount,l=a.colCount,u=0;u<s;u++)for(c=i[u]=[],f=0;f<l;f++)c[f]=_(t,a[u][f]);return new r.CalcArray(i)}}(t,e,o):t<=14?function(t,e,o){var n,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b;if(n=t<=7?_:8===t?V:H,i=G(e),a=G(o),i.success&&a.success)return n(t,i.value,a.value);if(e=i.value,o=a.value,s=i.success?-1:e.rowCount,l=i.success?-1:e.colCount,u=a.success?-1:o.rowCount,c=a.success?-1:o.colCount,f=-1,h=-1,i.success||a.success)i.success?(f=u,h=c):(f=s,h=l);else{if(1!==s&&1!==u&&s!==u||1!==l&&1!==c&&l!==c)return v;f=1===s?u:s,h=1===l?c:l}for(p=[],d=0;d<f;d++)for(p[d]=[],g=0;g<h;g++)!i.success&&(1!==s&&s<f||1!==l&&l<h)||!a.success&&(1!==u&&u<f||1!==c&&c<h)?p[d][g]=v:(m=1===s?0:d,y=1===l?0:g,C=1===u?0:d,b=1===c?0:g,p[d][g]=n(t,i.success?e:e[m][y],a.success?o:o[C][b]));return new r.CalcArray(p)}(t,e,o):function(t,e,o){var n,i,a,s,l,f,h,p,d,g,m,C,v;if(!e||!o||(1!==e.getRangeCount()||1!==o.getRangeCount())&&16!==t||e.endSource||o.endSource)return y;if(n=e.getSource(),!n||n!==o.getSource())return y;if(16===t)i=e.yf.concat(o.yf);else{if(a=15===t?u:c,s=15===t?c:u,l=e.getRow(0),f=e.getColumn(0),h=o.getRow(0),p=o.getColumn(0),d=a(l,h),g=a(f,p),m=s(l+e.getRowCount(0),h+o.getRowCount(0))-d,C=s(f+e.getColumnCount(0),p+o.getColumnCount(0))-g,m<1||C<1)return r.Errors.Null;i=[E(d,g,m,C)]}return v=new r.CalcReference(n,i),v.ck=!0,v}(t,e,o)}function _(t,e,o){var i,a,s,u;function c(t){return"string"==typeof t&&0===t.trim().length}if(c(e)||c(o))return y;if(!f(e,i={value:0}))return e instanceof r.CalcError?e:y;if(a=i.value,o!==l){if(!f(o,i))return o instanceof r.CalcError?o:y;s=i.value}else s=0;return 1===t?-a:2===t?a/100:3===t?r.Zh.Yh(a,-s)?0:a+s:4===t?r.Zh.Yh(a,s)?0:a-s:5===t?n.Common.o.Lma(a*s,r.Functions.CALC_PRECISION||15):6===t?s?a/s:b:7===t?!a&&s<0?b:0===a&&0===s?w:(u=r.Functions.MathHelper.YDc(a,s))===Number.POSITIVE_INFINITY||u===Number.NEGATIVE_INFINITY||isNaN(u)?w:u:void 0}function V(t,e,o){if(8===t)return h(e)?e:h(o)?o:r.Convert.bc(e)+r.Convert.bc(o)}function H(t,e,o){var n=r.gOb(e,o,!1);return h(n)?n:9===t&&0===n||10===t&&0!==n||11===t&&n<0||12===t&&n<=0||13===t&&n>0||14===t&&n>=0}function z(t,e){var o,n,i,a=!0;switch(e.Hi){case 0:o=M(t),n=!0;break;case 1:o=parseFloat(t),n=!0;break;case 2:o=k(t),n=!0;break;case 3:o=parseInt(t,10),n=!0;break;case 4:(o=p(t,e.Ii,e.Ji||!1,e.Ki||!1,e.Li||!1,e.Mi,e.xTa,e.hOb)).isError&&(o=o[0],a=!1),o.isConvertError&&(o=y,a=!1);break;case 5:o=N(t),e.Ni&&""===o&&(o=y,a=!1);break;case 6:O(t,i={value:s})?o=i.value:(o=y,a=!1);break;case 7:o=D(t);break;case 8:!(o=r.Functions.Wi(t))||e.Oi&&0===o.Pi()&&0===o.Qi()?(o=r.Errors.Number,a=!1):o={Ri:o.Pi(),Si:o.Qi()};break;default:o=t}return n&&isNaN(o)&&(o=y,a=!1),{Ti:o,Ei:a}}function U(t,e,o){var n,i,a,s,u;for(Array.isArray(e)||(e=[e]),n=t.Ti,i=0;i<e.length;i++)if(s=(a=e[i].split(" "))[0],u=parseInt(a[1],10),"<"===s&&n<u||">"===s&&n>u||"<="===s&&n<=u||">="===s&&n>=u||"="===s&&n===u||"!="===s&&n!==u||"checkLength"===s&&n.length>u)return t.Ti=o===l?r.Errors.Number:o,void(t.Ei=!1)}function W(t,e){var o,n,i,a,s,u=[];if(!e)return{Di:t,Ei:!0};if(e.Xi)for(i=0;i<t.length;i++)u.push(e);else u=Array.isArray(e)?e:[e];for(n=0;n<u.length;n++){if((a=u[n]).Yi&&!t[n])throw r.sR().Exp_ArgumentNull;if(s=t[n]!==l){if(o=z(t[n],a),a.aj&&U(o,a.aj,a.bj),!o.Ei)break;t[n]=a.Zi?{$i:s,Qb:o.Ti}:o.Ti}else t[n]=a.Zi?{$i:s,Qb:a._i}:a._i}return o?{Di:t,Ei:o.Ei,Fi:o.Ti}:void 0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("Common"),r=o("./src/calc.common.ts"),i=o("./src/calc.ts"),a=n.Common.j.Fa,s=null,l=void 0,Math.pow,u=Math.min,c=Math.max,f=r.Convert.Th,h=r.Convert.vf,p=r.Convert.Ph,d=r.Convert.Ca,g=r.Convert.Fh,m=r.Errors.Reference,y=r.Errors.Value,C=r.Errors.Name,v=r.Errors.NotAvailable,b=r.Errors.DivideByZero,w=r.Errors.Number,T=function(){function t(t,e,o,n,r){var i,a,s=[];for(i=5;i<arguments.length;i++)s[i-5]=arguments[i];this.si=0,this.ti=0,this.ui=0,(a=this).source=t,a.arrayFormulaMode=!!o,a.identity=e||a.$Ab(0,0),a.arrayIdentity=n,a.row=n?n.row:a.identity.row||0,a.column=n?n.col:a.identity.col||0,a.rowOffset=n?a.identity.row-n.row:a.row,a.columnOffset=n?a.identity.col-n.col:a.column,a.Lf=r}return t.prototype.$Ab=function(t,e){return{row:t,col:e}},t.prototype.fga=function(t){return t===r.BangSource?this.source:t},t.prototype.getValue=function(t,e){return t?this.fga(t).getValue(e):m},t.prototype.getReference=function(t,e){return t?this.fga(t).getReference(e):m},t.prototype.getSheetRangeReference=function(t){return!t||!t.source||!t.endSource||t.source instanceof r.ErrorSource?m:this.fga(t.source).getSheetRangeReference(t)},t.prototype.getFunction=function(t){return this.source?this.source.getCustomFunction(t):s},t.prototype.getName=function(t){var e,o=this,n=o.source?o.source.getCustomName(t):s;return!n&&o.source&&(n=(e=o.source.Cf().getGlobalSourceModel())&&e.getSource().getCustomName(t)),n},t.prototype.getField=function(t){return this.source?this.source.getField(t):s},t.prototype.vi=function(){return this.ui>0},t.prototype.wi=function(){this.ui++},t.prototype.xi=function(){this.ui--},t.prototype.SetAsyncResult=function(t,e){this.source.Cf().lh.SetAsyncResult(t,e)},t.prototype.cloneFrom=function(t){this.acceptsReference=t.acceptsReference,this.arrayFormulaMode=t.arrayFormulaMode},t}(),e.EvaluateContext=T,r.CalcSource.prototype.getEvaluatorContext=function(t,e,o,n){return new T(this,t,e,o,n)},S=function(){function t(t,e){this.id=t.si++,this.ctx=t,this.row=t.row+(t.arrayFormulaMode&&t.rowOffset||0),this.col=t.column+(t.arrayFormulaMode&&t.columnOffset||0),this.node=e}return t.prototype.setAsyncResult=function(t){this.node.Fi=t,this.node.v5=!0,this.ctx.SetAsyncResult(this,t),this.ctx.source.refresh()},t.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},t.prototype.DIc=function(){var t,e=this.node&&this.node.parent&&this.node.parent.oi||[];for(t=0;t<e.length;t++)if(!e[t].v5)return!1;return!0},t}(),e.AsyncEvaluateContext=S,x=function(t){function e(e,o,n,r,i,a,l,u){var c=t.call(this,e,isNaN(u)?s:{row:l,col:u},o,isNaN(a)?s:{row:n,col:r,rowCount:i,colCount:a})||this,f=e.Cf().getGlobalSourceModel(e);return c.yi=f&&f.getSource(),c}return F(e,t),e.prototype.getName=function(t){return this.yi?this.yi.getCustomName(t):s},e}(T),e.GloableEvaluateContext=x,A=function(){function t(t){this.service=t,this.asyncManager=new R(this)}return t.prototype.evaluateExpression=function(t,e,o,i,a){var u,c,f=void 0===t.type&&t.Lf?t.Lf:t,h=this.evaluate(f,e,!!i,!!a);return h&&h.pause?h:h===l||h===s?!1===o?h:0:((d(h)&&!i||g(h)&&!a)&&(h=this.getOneValue(e,h)),u=15,"number"==typeof h&&h>-10&&h<10&&(((c=""+h).indexOf("000000000000")>1||c.indexOf("999999999999")>1)&&(u=14)),n.Common.o.Lma(h,r.Functions.CALC_PRECISION||u))},t.prototype.evaluate=function(t,e,o,n){var i,a,u,c;if(!t)throw r.sR().Exp_ExprIsNull;if(void 0===t.type){if(t._error)return t;t.Lf&&(t=t.Lf)}for(;10===t.type;)t=t.value;if(i=this,u=s,12===t.type?(u=t.needExpendIndexs,t=t.value):e.Exb&&(o=!0,u=[]),(c=t.type)>=2&&c<=6)a=i.evaluateConst(t,e,o);else if(1===c||13===c||33===c)a=i.evaluateReference(t,e,n,o);else if(8===c)a=i.evaluateName(t,e,o,n);else if(t&&100===t.type)a=i.evaluateLocalName(t,e,o,n);else if(9!==c||t.value2){if(9===c)a=i.evaluateBinaryOperation(t,e,o,n,u);else if(7===c){if(t.QDc&&e.NMc&&((a=i.evaluateBranchFunction(t,e,o,n,u))&&a.pause))return a;a=i.evaluateFunction(t,e,o,n,u)}else if(11===c)a=l;else if(14===c)a=i.evaluateField(t,e);else if(e.evaluate)return e.evaluate(t,o,n)}else a=i.evaluateUnaryOperation(t,e,o,n,u);return a},t.prototype.evaluateLocalName=function(t,e,o,n){var r,i,a;if(e.letContext)for(r=t.value,i=e.letContext.length-1;i>=0;i--)if((a=e.letContext[i])[r]!==l)return a[r];return t.type=8,delete t.bhc,this.evaluate(t,e,o,n)},t.prototype.evaluateConst=function(t,e,o){var n=t.value;return d(n)?o||e&&(e.arrayFormulaMode||e.vi())?n:n.getValue(0,0):n},t.prototype.evaluateReference=function(t,e,o,n){var i,a,s,l,u,c,f,h,p,d,g,C,v,b,w,T;if(!e)return y;if(i=t.source||e.source,a=isNaN(e.row)?0:e.row,s=isNaN(e.column)?0:e.column,l=t.getRange&&t.getRange(a,s),u=t.type,!l)return 13===u?y:m;if(33===u&&l.isSpillError)return r.Errors.Spill;if(c=l.row<0?0:l.row,f=l.col<0?0:l.col,h=l.rowCount,p=l.colCount,n&&(d=i.getRowCount(),g=i.getColumnCount(),(-1===h||h>d)&&(h=d),(-1===p||p>g)&&(p=g)),o||e.arrayFormulaMode)return t.endSource?e.getSheetRangeReference({source:t.source,endSource:t.endSource,row:c,col:f,rowCount:h,colCount:p}):e.getReference(i,l);if(n&&(h>1||p>1)){for(C=[],v=0;v<h;v++)for(C[v]=[],b=0;b<p;b++)C[v][b]=i.getValue(v+c,b+f);return new r.CalcArray(C)}if(h>1||p>1)if(w=a>=l.row&&a<l.row+h,T=s>=l.col&&s<l.col+p,w&&T)c=a,f=s;else{if(!w&&!T)return y;if(w&&1===p)c=a;else{if(!T||1!==h)return y;f=s}}else if(-1===l.row&&-1===h){if(1!==p)return y;c=a}else if(-1===l.col&&-1===p){if(1!==h)return y;f=s}return i.getValue(c,f)},t.prototype.evaluateName=function(t,e,o,n){var r,a;return e?(t.source&&(e=t.source.getEvaluatorContext(e.identity,e.arrayFormulaMode,e.arrayIdentity)),(r=e.getName(t.value))?(a=i.Mh(e,r,!1,0,0,o,n),this.evaluate(a,e,o,n)):C):C},t.prototype.evaluateUnaryOperation=function(t,e,o,n,i){var a,s=!1;return i&&i.length>0&&(o=!0,s=!0),(a=this.evaluate(t.value,e,o,s))&&a.pause||r.Convert.vf(a)?a:a===r.missingArgument?v:this.evaluateWithArgs(t,(function(o){return o[0]&&o[0].getRowCount&&e.Exb&&e.Lf&&(e.Lf.hJc=!0),B(t.operatorType,o[0],e.Exb)}),e,i,[a],o,n)},t.prototype.evaluateBinaryOperation=function(t,e,o,n,i){var a,s,l,u,c,f,h,p,d;if(e.Exb&&(o=!0),a=[o,o],l=[s=t.operatorType>=15,s],i&&i.length>0)for(u=0;u<i.length;u++)a[i[u]]=!0,l[i[u]]=!0;for(c=function(t,e){if(0===e){for(;10===t.type;)t=t.value;if(7===t.type&&t.function&&t.function.TAb)return null}return e},f=[t.value,t.value2],h=[],u=0;u<2;u++){if((p=this.evaluate(f[u],e,a[u],l[u]))&&p.pause)return p;if(d=c(f[u],p),r.Convert.vf(d))return d;if(d===r.missingArgument)return v;h[u]=d}return this.evaluateWithArgs(t,(function(o){return e.Lf&&(o[0]&&o[0].getRowCount||o[1]&&o[1].getRowCount)&&(e.Lf.hJc=!0),B(t.operatorType,o[0],o[1])}),e,i,h,o,n)},t.prototype.evaluateField=function(t,e){var o;return e?(t.source&&(e=t.source.getEvaluatorContext(e.identity,e.arrayFormulaMode,e.arrayIdentity)),o=e.getField(t.value),a(o)?v:o):C},t.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},t.prototype.endCache=function(){this.Bi=s},t.prototype.evaluateBranchFunction=function(t,e,o,n,r){var i,s,l,u,c,f,h;if(a(t.PDc))return i=t.function,s=t.arguments.length,l=i.findTestArgument(),c=(u=this.preprocessFunction(e,i,s,r,o)).acceptsArrays,f=u.keepArrayValuesFlagSet,(h=this.testArgGetBranch(e,i,t,c[l],!1,l))&&h.pause?h:(f&&delete e.Exb,h.branchArgument>=0&&"number"==typeof h.branchArgument?(t.PDc=!0,e.source.ODc=e.source.ODc||[],e.source.ODc.push(t),{pause:"Branch",branch:t.RDc[h.branchArgument]}):void(h.testArgValue._error||delete t.QDc))},t.prototype.evaluateLetFunction=function(t,e,o,n){var r,i,a,s,l,u,c,f,h=t.arguments.length;for(e.letContext=e.letContext||[],i={},a=1;a<h-1;a+=2){if(s=t.arguments[a-1],l=t.arguments[a],u=s.value,c=e,e.letContext.push(i),(r=this.evaluate(l,c,o,n))&&r.pause)return r;e.letContext.pop(),i[u]=r}return e.letContext.push(i),(f=this.evaluate(t.arguments[h-1],e,o,n))&&f.pause||(e.letContext.pop(),0===e.letContext.length&&delete e.letContext),f},t.prototype.evaluateGetPivotDataFunction=function(t,e,o,n){var i,s,l=t.arguments,u=l[0].value,c=l[1],f=[],h=c.source||e.source,p=isNaN(e.row)?0:e.row,d=isNaN(e.column)?0:e.column,g=c.getRange(p,d),y=h.kj,C=y.pivotTables&&g&&y.pivotTables.findPivotTable(g.row,g.col);if(a(C))return m;for(i=2;i<l.length;i++){if(s=l[i],(s=this.evaluate(s,e,o,n))&&s.pause||s instanceof r.CalcError)return s;f.push(s)}return C.evaluateGetPivotDataFunction(u,f)},t.prototype.preprocessFunction=function(t,e,o,n,r){var i,a,l,u,c=[],f=[],h=t.Exb,p=!1,d=s;for(!h&&(1===e.arrayArgumentEvaluateMode||4===e.arrayArgumentEvaluateMode&&r)&&(h=t.Exb=!0,p=!0),i=0;i<o;i++)c[i]=e.acceptsArray(i),f[i]=e.acceptsReference(i);if(n&&n.length>0||h){for(d=[],i=0;i<o;i++)d[i]=!0;for(a=h?o:n.length,i=0;i<a;i++)c[l=h?i:n[i]]=!0,f[l]=!0,(u=!(e.acceptsReference(l)&&!e.acceptsArray(l)))&&h&&e.acceptsReference(l)&&(u=!1),d[l]=u}return e.isBranch()&&(t.arrayFormulaMode||t.vi())&&(c[e.findTestArgument()]=!0,f[e.findTestArgument()]=!0),{acceptsArrays:c,acceptsReferences:f,getReferenceValues:d,keepArrayValuesFlagSet:p}},t.prototype.testArgGetBranch=function(t,e,o,n,r,i){var a,s=-1,l=t.Exb;return t.arrayFormulaMode&&(t.Exb=!0),e.acceptsArray(i)&&t.wi(),(a=this.evaluate(o.arguments[i],t,n,r))&&a.pause?a:(e.acceptsArray(i)&&t.xi(),t.Exb=l,g(a)||d(a)||(s=e.findBranchArgument(a)),{testArgValue:a,branchArgument:s})},t.prototype.evaluateFunction=function(t,e,o,n,i){var a,l,u,c,f,h,p,m,y,v,b,w,T,S,x,A,I,R,M,k,N;if(!t||!t.function||"string"==typeof t.function)return C;if(a=t.arguments.length,l=this,u=e.ti,"LET"===t.functionName)return l.evaluateLetFunction(t,e,o,n);if("GETPIVOTDATA"===t.functionName)return l.evaluateGetPivotDataFunction(t,e,o,n);if(c=t.function,f=[],p=s,c instanceof r.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(c,t,e),0!==a){if(v=(y=l.preprocessFunction(e,c,a,i,o)).acceptsArrays,b=y.acceptsReferences,p=y.getReferenceValues,m=y.keepArrayValuesFlagSet,w=void 0,T=void 0,S=void 0,c.isBranch()){if(T=c.findTestArgument(),(x=l.testArgGetBranch(e,c,t,v[T],b[T],T))&&x.pause)return x;w=x.testArgValue,S=x.branchArgument}for(A=0;A<a;A++){if(T===A)h=w;else{if(S>=0&&A!==S){f[A]=null;continue}if(c.acceptsArray(A)&&e.wi(),(h=l.evaluate(t.arguments[A],e,v[A],b[A]))&&h.pause)return h;c.acceptsArray(A)&&e.xi()}if(!c.acceptsArray(A)&&d(h)||!c.acceptsReference(A)&&g(h))if(I=d(h)?h:s,R=g(h)?h:s,I&&1===I.getRowCount()&&1===I.getColumnCount())h=I.getValue(0,0);else if(R&&1===R.getRowCount(0)&&1===R.getColumnCount(0))h=R.getValue(0,0,0);else{if(M=[],k=!1,i)for(N=0;N<i.length;N++)M.push(i[N]),i[N]===A&&(k=!0);k||(M.push(A),i=M)}if(r.Convert.vf(h)&&!c.acceptsError(A))return c instanceof r.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),h;h!==r.missingArgument||c.acceptsMissingArgument(A)||(h=s),f[A]=h,h&&"INDIRECT"!==t.functionName&&h.ck&&h.xf&&j(h,e)}}return m&&delete e.Exb,l.evaluateWithArgs(t,(function(t,o,i){var a,s,f,h,p,d=W(t,c.Ci);return t=d.Di,d.Ei?c.isContextSensitive()?(e.acceptsReference=n||e.vi(),c instanceof r.Functions.AsyncFunction?(l.T4=l.T4||{},c.evaluateWhenArgumentsIsSame()?l.evaluateAsyncFunction(e,o,c,u,t,i):l.evaluateWithCache(c,t,(function(){return l.evaluateAsyncFunction(e,o,c,u,t,i)}),l.T4)):c.evaluateWithContext(e,t)):((s=e.arrayFormulaMode)&&(c.y0a={row:e.rowOffset,col:e.columnOffset}),f=r.getMapping()&&r.getMapping().builtInFunctionsMapping,h=f&&f[c.name]&&f[c.name].specialFun,p=function(){return h&&h.apply(c,t)||c.evaluate.apply(c,t)},a=s?l.evaluateWithCache(c,t,p,l.Bi):p(),delete c.y0a,a):d.Fi}),e,i,f,o,n,p)},t.prototype.evaluateAsyncFunction=function(t,e,o,n,r,i){var a,s,u=this.asyncManager.getNode();if(u.v5)a=u.Fi;else if(u.canEvaluate()){if(s=new S(t,u),a=o.evaluateWithContext(s,r),s.notAsync)return a;a===l?a=u.Fi!==l?u.Fi:o.defaultValue():1===u.evaluateMode&&(u.v5=!0)}else a=u.Fi!==l?u.Fi:o.defaultValue();return u.Fi=a,i||this.asyncManager.endCalcFunction(),a},t.prototype.evaluateWithCache=function(t,e,o,n){var i,a,s,u,c,f,h,p,d,g,m,y;if(n)if(a=!1,i=n[t.name+e.length])for(s=0;s<i.length;s++){if(a=!1,(u=i[s]).args.length===e.length){for(a=!0,c=0;c<e.length;c++)if((f=u.args[c])!==(h=e[c])){if(!(f instanceof r.CalcReference&&h instanceof r.CalcReference)){a=!1;break}if(p=f.zf,f.xf!==h.xf||p!==h.zf){a=!1;break}for(d=0;d<p;d++)if(f.getRow(d)!==h.getRow(d)||f.getColumn(d)!==h.getColumn(d)||f.getRowCount(d)!==h.getRowCount(d)||f.getColumnCount(d)!==h.getColumnCount(d)){a=!1;break}}a&&!P(u.y0a,t.y0a)&&(a=!1)}if(a)return u.flag++,u.value}else i=n[t.name+e.length]=[];if(g=o(),n&&g!==l){if((m=i.length)>=100){for(y=[],s=0;s<m;s++)i[s].flag>0&&y.push(i[s]);y.sort((function(t,e){return e.flag-t.flag})),m=Math.min(50,y.length),i=y.slice(0,m),n[t.name+e.length]=i}i.push({args:e,value:g,flag:0,y0a:t.y0a})}return g},t.prototype.SetAsyncResult=function(t){if(t.DIc()){var e=t.ctx;e.source.Cf().recalculate(e.source,t.row,t.col,!0)}},t.prototype.evaluateWithArgs=function(t,e,o,n,i,a,s,l){var u,c,f,h,p,m,C,b,w,T,S,x,A,I,R=o.Exb;if(!R||n&&n.length>0||(n=[],(u=7===t.type&&t.function)&&i.forEach((function(t,e){(!u.acceptsArray(e)&&d(t)||!u.acceptsReference(e)&&g(t))&&n.push(e)}))),n&&n.length>0){if(!(f=this.Gi(o,t,i,n,l)))return v;for(h=[],p=f[0].length,m=f[0][0].length,C=0;C<p;C++)for(h[C]=[],b=0;b<m;b++)try{for(w=[],T=0;T<i.length;T++)w[T]=f[T][C][b];if(c=e(w,t,C+1!==p||b+1!==m),g(c)&&!R){if(7===t.type&&((u=t.function).returnReference&&u.returnReference()))return c;c=this.getOneValue(o,c)}h[C][b]=c,o.Lf.hJc=!0}catch(t){h[C][b]=y}return new r.CalcArray(h,R)}try{if(c=e(i,t),15===t.operatorType&&c&&c.ck&&j(c,o),o.arrayFormulaMode&&o.vi())return c;if(d(c)&&!a)return this.getOneValue(o,c);if(g(c)&&!s){if(S=c,a&&1===S.getRangeCount()){for(x=[],A=0;A<S.getRowCount(0);A++)for(x[A]=[],I=0;I<S.getColumnCount(0);I++)x[A][I]=S.getValue(0,A,I);return new r.CalcArray(x)}return this.getOneValue(o,c)}return c}catch(t){return y}},t.prototype.getOneValue=function(t,e){var o,n,r,i,a,s;return g(e)?(i=(r=e).getRowCount(0),a=r.getColumnCount(0),r.getRangeCount()>1||!t.arrayFormulaMode&&i>1&&a>1?e=y:(-1!==t.rowOffset||-1!==t.columnOffset?(o=1===i?0:t.arrayFormulaMode?t.rowOffset:t.rowOffset-r.getRow(0),n=1===a?0:t.arrayFormulaMode?t.columnOffset:t.columnOffset-r.getColumn(0)):(o=1===i?0:t.row-r.getRow(0),n=1===a?0:t.column-r.getColumn(0)),e=o>=i||n>=a?v:r.getValue(0,o,n))):d(e)&&(s=e,!t.arrayFormulaMode||-1===t.rowOffset&&-1===t.columnOffset?e=s.getValue(0,0):(o=1===s.getRowCount()?0:t.rowOffset,n=1===s.getColumnCount()?0:t.columnOffset,e=o>=s.getRowCount()||n>=s.getColumnCount()?v:s.getValue(o,n))),g(e)||d(e)?this.getOneValue(t,e):e},t.prototype.Gi=function(t,e,o,r,i){var a,u,c,f,h,p,m,y,C,b,w,T,S,x,A,I,R,M,k,N=1,O=1,D=-1,F=!0,j=!0,P=1,L=1,G=7===e.type?e:s,B=G&&G.function,_=t.arrayFormulaMode||t.source&&t.source.Af&&t.source.Af.allowDynamicArray;if(B&&!B.expandRows()&&(F=!1),B&&!B.expandColumns()&&(j=!1),B&&B.isBranch()&&(_||t.vi())){if(D=B.findTestArgument(),c=[],f=!1,r)for(h=0;h<r.length;h++)c.push(r[h]),r[h]===D&&(f=!0);if(f||d(o[D])||g(o[D])){for(p=0;p<G.arguments.length;p++)p!==D&&n.Common.k.Cb(c,p)<0&&(d(o[p])||g(o[p]))&&c.push(p);r=c}}for(m=[],C=r[y=0],b=o.length,S=[],w=0;w<b;w++)T=o[w],a=s,u=s,P=L=1,w===C?(a=d(T)?T:s,u=g(T)?T:s,(a||u)&&(P=a&&a.getRowCount()||(F&&u?u.getRowCount(0):1),L=a&&a.getColumnCount()||(j&&u?u.getColumnCount(0):1)),C=++y<r.length?r[y]:-1):i===l&&(a=d(T)?T:s,u=g(T)?T:s,(a||u)&&(P=a&&a.getRowCount()||(F&&u?u.getRowCount(0):1),L=a&&a.getColumnCount()||(j&&u?u.getColumnCount(0):1))),S[w]=[a,u,T,P,L],N=P>N?P:N,O=L>O?L:O;for(w=0;w<b;w++){if(x=m[w]=[],a=(A=S[w])[0],u=A[1],T=A[2],P=A[3],L=A[4],(a||u)&&(1!==P&&P!==N||1!==L&&L!==O)&&(-1===D||w===D)&&!_)return;for(I=0;I<N;I++)for(R=x[I]=[],M=0;M<O;M++)1!==P&&I>=P||1!==L&&M>=L?R[M]=v:a?(k=a.getValue(1===P?0:I,1===L?0:M),d(k)&&(k=k.getValue(0,0)),R[M]=k):u?!i||i[w]?R[M]=u.getValue(0,1===P?0:I,1===L?0:M):R[M]=u.create([E(u.getRow(0)+(1===P?0:I),u.getColumn(0)+(1===L?0:M),1,1)]):R[M]=T}return m},t}(),e.Evaluator=A,I=function(){function t(t,e){this.id=t,this.Fi=l,this.v5=!1,this.oi=[],e!==l&&(this.evaluateMode=e)}return t.prototype.canEvaluate=function(){var t,e=this.oi;for(t=0;t<e.length;t++)if(!e[t].v5)return!1;return!0},t}(),e.AsyncFunctionNode=I,R=function(){function t(t){var e=this;e.w5=[],e.x5=-1,e.y5={},e.lh=t,e.vQa=0}return t.prototype.startCalc=function(){var t,e,o,n,r,i,a,s,l;if(this.vQa)for(e in this.y5)if(o=this.y5[e])for(n in o)if(r=o[n])for(i in r)if((a=r[i])&&(a.root.oi=[],(t=a.length)>0))for(s=0;s<t;s++)0===(l=a[s]).evaluateMode&&(l.v5=!1)},t.prototype.startCalcCell=function(t,e){var o,n,r,i,a=this,s=t.getName(),l=e.row,u=e.col;a.source=t,(o=a.y5[s])||(o=a.y5[s]={}),(n=o[l])||(n=o[l]={}),(r=n[u])||(i=new I(-1),(r=n[u]=[]).root=i),a.vQa++,a.x5=0,a.cellNodes=r,a.row=l,a.col=u,a.w5[0]=r.root,a.evaluateMode=-1},t.prototype.startCalcFunction=function(t,e,o){var n,r,i,a,s,l,u,c,f,h,p=this,d=e.arguments,g=!1;if(0!==p.w5.length&&p.cellNodes||(g=!0,p.startCalcCell(o.source,o.identity)),n=p.evaluateMode,r=t.evaluateMode(),"REFRESH"===t.name?(r=d[1]?p.lh.evaluate(d[1],o,!1,!1):0,p.evaluateMode=r):-1!==n&&(r=n),a=o.identity?o.identity.row+"|"+o.identity.col:"0",e.PIc&&e.PIc[a]?i=e.PIc[a]:(e.PIc=e.PIc||{},i=e.PIc[a]=new I(p.cellNodes.length,r),p.cellNodes.push(i)),p.currentNode=i,p.w5[p.x5].oi.indexOf(i)<0&&(p.w5[p.x5].oi.push(i),i.parent=p.w5[p.x5],i.oi=[]),p.w5.push(i),p.x5++,2===r&&-1===n){for(6e4,s=p.intervals,l=t.interval()||6e4,"REFRESH"===t.name&&(i.isRefresh=!0,l=d[2]?p.lh.evaluate(d[2],o,!1,!1):6e4),s||(p.intervals=s={}),(u=s[l])||"object"!=typeof window||((u=s[l]=[]).intervalObj=window.setInterval((function(){var t,e,o=p.intervals[l];for(c=0;c<o.length;c++)(e=(t=o[c]).node).v5=!1,e.isRefresh&&L(e),p.lh.service.recalculate(t.source,t.row,t.col,!0),p.source.refresh()}),l)),f=!1,c=0;c<u.length;c++)if((h=u[c]).source===p.source&&h.node===i&&h.row===p.row&&h.col===p.col){f=!0;break}f||u.push({source:p.source,node:i,row:p.row,col:p.col})}return g&&p.endCalcCell(),i},t.prototype.getNode=function(){return this.currentNode},t.prototype.endCalcFunction=function(){this.w5.pop(),this.x5--,this.currentNode=this.currentNode.parent},t.prototype.endCalcCell=function(){this.x5=-1,this.w5=[]},t.prototype.clearCell=function(t,e){var o,n,r,i,a,s,u,c,f,h,p,d,g,m,y=this;if(y.vQa&&(o=t.getName(),n=e.row,r=e.col,y.source=t,(i=y.y5[o])&&((a=i[n])&&((s=a[r])&&((c=(u=s[0])&&u.h_a)&&(delete c.nia,delete c.z$a),a[r]=l,y.vQa--))),"object"==typeof window))for(h in f=y.intervals)if(p=f[h]){for(d=[],g=0;g<p.length;g++)(m=p[g]).source===t&&m.row===e.row&&m.col===e.col||d.push(m);d.length?d.length!==p.length&&(d.intervalObj=p.intervalObj,f[h]=d):(f[h]=l,window.clearInterval(p.intervalObj))}},t.prototype.setAsyncResult=function(t,e){t.Fi=e},t.prototype.addRows=function(t,e,o){this.GQa(t,e,o,!0)},t.prototype.deleteRows=function(t,e,o){this.GQa(t,e,o,!1)},t.prototype.GQa=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m=this;if(m.vQa){if(r=t.getName(),i=m.y5[r]){for(s in a={},i)(l=i[s])&&(u=parseInt(s,10),n?a[u>=e?u+o:u]=l:u<e?a[u]=l:u>=e+o&&(a[u-o]=l));m.y5[r]=a}for(f in c=m.intervals)if(h=c[f]){for(p=[],d=0;d<h.length;d++)(g=h[d]).source===t&&n&&g.row>=e?g.row+=o:g.source===t&&!n&&(g.row<e||g.row>=e+o)&&(g.row=g.row<e?g.row:g.row-o,p.push(g));n||p.length===h.length||(p.intervalObj=h.intervalObj,c[f]=p)}}},t.prototype.addColumns=function(t,e,o){this.HQa(t,e,o,!0)},t.prototype.deleteColumns=function(t,e,o){this.HQa(t,e,o,!1)},t.prototype.HQa=function(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,C=this;if(C.vQa){if(r=t.getName(),i=C.y5[r])for(a in i)if(s=i[a]){for(u in l={},s)(c=s[u])&&c.length&&(f=parseInt(u,10),n?l[f>=e?f+o:f]=c:f<e?l[f]=c:f>=e+o&&(l[f-o]=c));i[a]=l}for(p in h=C.intervals)if(d=h[p]){for(g=[],m=0;m<d.length;m++)(y=d[m]).source===t&&n&&y.col>=e?y.col+=o:y.source===t&&!n&&(y.col<e||y.col>=e+o)&&(y.col=y.col<e?y.col:y.col-o,g.push(y));n||g.length===d.length||(g.intervalObj=d.intervalObj,h[p]=g)}}},t.prototype.changeSourceName=function(t,e){var o,n=this;n.vQa&&((o=n.y5[t])&&(n.y5[e]=o,delete n.y5[t]))},t}(),e.evaluateOperator=B,M=r.Convert.Pa,k=r.Convert.Rh,N=r.Convert.bc,O=r.Convert.Xh,D=r.Convert.Vh},"./src/referenceExpression.ts":function(t,e,o){"use strict";var n,r,i,a,s,l=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function u(t,e,o,n,r,i){var s=new a(1);return s.row=o,s.column=n,s.rowRelative=r,s.columnRelative=i,t&&(s.source=t),e&&(s.endSource=e),s}function c(t,e,o,r,i,s,l,u,c,f,h,p,d){var g,m,y,C,v,b=new a(1);return b.isFullRow=r===n.BAND_INDEX_CONST,h=h||0,p=p||0,m=o-(l?0:h),y=r-(u?0:p),C=i-(c?0:h),v=s-(f?0:p),b.isFullRow&&0===o&&i===n.MAX_ROW_COUNT-1&&(o=i=n.BAND_INDEX_CONST),b.isFullColumn=o===n.BAND_INDEX_CONST,m>C&&(g=o,o=i,i=g,g=l,l=c,c=g),y>v&&(g=r,r=s,s=g,g=u,u=f,f=g),b.row=o,b.column=r,b.endRow=i,b.endColumn=s,b.rowRelative=l,b.columnRelative=u,b.endRowRelative=c,b.endColumnRelative=f,b.isArrayReference=d,t&&(b.source=t),e&&(b.endSource=e),b}function f(t,e,o){var r,a,s,l,u={row:-1,col:-1,rowCount:-1,colCount:-1};return t.isFullRow?(u.col=-1,u.colCount=-1):(t.columnRelative?s=(s=t.column+o)>=n.MAX_COLUMN_COUNT?s%n.MAX_COLUMN_COUNT:s:s=t.column,t.sf()?(u.col=s,u.colCount=1):(t.endColumnRelative?l=(l=t.endColumn+o)>=n.MAX_COLUMN_COUNT?l%n.MAX_COLUMN_COUNT:l:l=t.endColumn,u.col=s<=l?s:l,u.colCount=i(l-s)+1)),t.isFullColumn?(u.row=-1,u.rowCount=-1):(t.rowRelative?r=(r=t.row+e)>=n.MAX_ROW_COUNT?r%n.MAX_ROW_COUNT:r:r=t.row,t.sf()?(u.row=r,u.rowCount=1):(t.endRowRelative?a=(a=t.endRow+e)>=n.MAX_ROW_COUNT?a%n.MAX_ROW_COUNT:a:a=t.endRow,u.row=r<=a?r:a,u.rowCount=i(a-r)+1)),u}function h(t,e,o,n,r,i,a,l){var u=new s(n,r,i,a,l);return u.contextSource=t,u.source=e,u.endSource=o,u}function p(t,e){return h(t,e,r,0,0,!1,!1,!0)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/calc.common.ts"),r=void 0,i=Math.abs,a=function(t){function e(e){return t.call(this,e)||this}return l(e,t),e.prototype.sf=function(){return this.endRow===r||this.endColumn===r},e.prototype.tf=function(){var t=this;return t.isFullRow&&t.isFullColumn?3:t.isFullRow?1:t.isFullColumn?2:0},e.prototype.getRange=function(t,e){return f(this,t,e)},e.prototype.offset=function(t,e,o,n,r){var i,a=this,s=a.source,l=a.endSource;return a.sf()?u(s,l,a.row+(a.rowRelative||o?t:0),a.column+(a.columnRelative||o?e:0),a.rowRelative,a.columnRelative):((i=c(s,l,a.row+(a.rowRelative||o?t:0),a.column+(a.columnRelative||o?e:0),a.endRow+(a.isFullColumn||!a.endRowRelative&&!o?0:t),a.endColumn+(a.isFullRow||!a.endColumnRelative&&!o?0:e),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,n,r)).isFullRow=a.isFullRow,i.isFullColumn=a.isFullColumn,i)},e.prototype.offset2=function(t,e,o,n,r,i){var a=this,s=c(a.source,a.endSource,a.row+(a.isFullColumn?0:t),a.column+(a.isFullRow?0:e),a.endRow+(a.isFullColumn?0:o),a.endColumn+(a.isFullRow?0:n),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,r,i);return s.isFullRow=a.isFullRow,s.isFullColumn=a.isFullColumn,s},e}(n.Expression),e.ReferenceExpression=a,e.rf=u,e.uf=c,e.getRangeForReference=f,s=function(t){function e(e,o,n,r,i){var a=t.call(this,33)||this;return a.row=e,a.column=o,a.rowRelative=n,a.columnRelative=r,a.isReferenceError=i,a.sf=function(){return!this.isReferenceError},a.getRange=function(t,e){var o,n,r,i,a,s=this,l=s.source||s.contextSource;if(!s.isReferenceError&&l&&(n=(o=f(s,t,e)).row,r=o.col,i=l.getReference({row:n,col:r,spillRef:!0})))return a={spillRef:!0,row:n,col:r,rowCount:i.getRowCount(),colCount:i.getColumnCount()},i.isSpillError&&(a.isSpillError=!0),a},a.offset=function(t,e,o){var n=this,r=n.contextSource,i=n.source,a=n.endSource;return this.isReferenceError?p(r,i):h(r,i,a,n.row+(n.rowRelative||o?t:0),n.column+(n.columnRelative||o?e:0),n.rowRelative,n.columnRelative)},a}return l(e,t),e}(n.Expression),e.SpillReferenceExpression=s,e.BLb=h,e.lOb=p},Common:function(t,e){t.exports=o("Common")}}),t.exports=n.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(t,e){var o="object"==typeof o?o:{};o.Spread=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){var n,r;if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(n=Object.create(null),o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/assets/",o(o.s="./src/all.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()}catch(t){"object"==typeof window&&(o=window)}t.exports=o},"./src/all.entry.ts":function(t,e,o){"use strict";var n,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/common.entry.ts"),e.Common=n,r=o("./src/plugins/commands/commands.entry.ts"),e.Commands=r,i=o("./src/plugins/formatter/formatter.entry.ts"),e.Formatter=i,a=o("./src/plugins/sparkline/sparkline.entry.ts"),e.Sparklines=a,s=o("./src/plugins/slicer/slicer.entry.ts"),e.Slicers=s},"./src/common/common.entry.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h;function p(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/colorhelper.ts"),e.pc=n.pc,r=o("./src/common/util/types.ts"),e.j=r.j,i=o("./src/common/util/arrayhelper.ts"),e.k=i.k,a=o("./src/common/util/datetimehelper.ts"),e.l=a.l,s=o("./src/common/util/numberhelper.ts"),e.o=s.o,l=o("./src/common/util/regexhelper.ts"),e.q=l.q,u=o("./src/common/util/stringhelper.ts"),e.u=u.u,c=o("./src/common/util/rbush.ts"),e.rbush=c.rbush,f=o("./src/common/util/datetimehelper.ts"),e.FXc=f.getSR,p(o("./src/common/util/common.ts")),h=o("./src/common/culture/cultureInfo.ts"),e.CultureInfo=h.CultureInfo,e.CultureManager=h.CultureManager,p(o("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(t,e,o){"use strict";(function(t){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function R(t){return t.split(" ").join(" ").toUpperCase()}function M(t){var e,o,n=[];for(e=0,o=t.length;e<o;e++)n[e]=R(t[e]);return n}function k(t,e,o){var n=R(t),r=e.indexOf(n);return-1===r&&(r=o.indexOf(n)),r}function N(t,e,o){var n,r,i;for(r=0,i=e.length;r<i;r++)n=e[r],this[t][n]=o[r]}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/types.ts"),r=o("./src/common/util/common.ts"),i=o("./src/common/util/arrayhelper.ts"),a="undefined"!=typeof window?window:t,s=void 0,l=null,u=n.j.H,c=n.j.Ia,p=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],d=(f=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(h=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),u(f,(function(t,e){u(h,(function(t,o){t<h.length-4&&d.push(e+" "+o)}))})),d=d.concat(p),u(p,(function(t,e){u(h,(function(t,o){t<h.length-4&&d.push(e+" "+o)}))})),g=function(){function t(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"¤",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"‰",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={}}return t.prototype.ma=function(){var t,e,o,n;return this.na||(o=(o=[e=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),e+" h:mm",e+" h:mm:ss",e+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(d),1041===this.id&&(n=t.eraFormatter,o=(o=o.concat(this._Ab)).concat(n)),o=o.concat(t.preselectedFormatters),this.na=o),this.na},t.prototype.oa=function(t){var e=this;return e.pa||(e.pa=M(e.DateTimeFormat.monthNames),e.qa=M(e.DateTimeFormat.monthGenitiveNames)),k(t,e.pa,e.qa)},t.prototype.ra=function(t){var e=this;return e.sa||(e.sa=M(e.DateTimeFormat.abbreviatedMonthNames),e.ta=M(e.DateTimeFormat.abbreviatedMonthGenitiveNames)),k(t,e.sa,e.ta)},t.prototype.ua=function(t){var e=this;return e.va||(e.va=M(e.DateTimeFormat.dayNames)),e.va.indexOf(R(t))},t.prototype.wa=function(t){var e=this;return e.xa||(e.xa=M(e.DateTimeFormat.abbreviatedDayNames)),e.xa.indexOf(R(t))},t}(),e.CultureInfo=g,m=function(){function t(){}return t.I=function(e){return e>=t.J()&&e<=t.K()},t.L=function(){var t,e,o=g.eras;if(o!==s){for(t=[],e=0;e<o.length;e++)t[e]=new Date(o[e].startDate.replace(/-/g,"/"));return t}return this.O},t.P=function(e){var o,n,r,i,a;switch(e){case"g":o="symbol",n=t.R;break;case"gg":o="abbreviation",n=t.S;break;case"ggg":o="name",n=t.U;break;default:return[]}if(i=[],(r=g.eras)!==s){for(a=0;a<r.length;a++)i[a]=r[a][o];return i}return n},t.K=function(){var t,e=g.eras;return e!==s&&e.length>0?((t=new Date(e[e.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.W},t.J=function(){var t=g.eras;return t!==s&&t.length>0?new Date(t[0].startDate.replace(/-/g,"/")):this.Z},t.$=function(){var t=g.eras;return t!==s?t.length:this._},t.aa=function(){var t,e,o,n,r=g.eras;if(r!==s){for(t=[],e=1;e<r.length;e++)o=new Date(r[e-1].startDate.replace(/-/g,"/")),n=new Date(r[e].startDate.replace(/-/g,"/")),t[e-1]=n.getFullYear()-o.getFullYear()+1;return t[e-1]=99,t}return this.ba},t.ca=function(e){var o,n={da:-1,ea:-1};if(!t.I(e))return n;for(o=0;o<t.$();o++)if(e<(o+1!==t.$()?t.L()[o+1]:t.fa(t.K(),1))){n.da=o,n.ea=e.getFullYear()-t.L()[o].getFullYear()+1;break}return n},t.fa=function(t,e){var o=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return o.setMilliseconds(o.getMilliseconds()+e),new Date(o.valueOf())},t.ga=function(e,o){return t.L()[e].getFullYear()+o-1},t.ha=function(e,o){var n,r;for(o=o.toUpperCase(),n=t.P(e),r=0;r<n.length;r++)if(n[r]===o)return r;return-1},t.ia=function(e,o,n){var r,i,a,s=t,l=s.ca(o),u=l.da;if(u>=0&&(r=s.P(e)).length>0)return r[u];if((i=l.ea)>=0){if("1"===(a=""+i)&&n)return"元";if("ee"===e)return 1===a.length&&(a="0"+a),a;if("e"===e)return a}return""},t.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],t._=5,t.ba=[45,15,64,31,99],t.W=new Date(2117,11,31,23,59,59),t.Z=new Date(1868,8,8),t.ja=["1,m","2,t","3,s","4,h","5,r"],t.ka=[0,1,2,3,0,1,2,3],t.U=["明治","大正","昭和","平成","令和"],t.R=["M","T","S","H","R"],t.S=["明","大","昭","平","令"],t.la=99,t.eraExcelFormatter="[$-ja-JP-x-gannen]",t.eraInternalFormatter="[$-411]",t}(),e.aBb=m,y=function(t){function e(){var e,o=t.call(this)||this;return N.call(o,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),e=["MMM yyyy","MMMM yyyy"],N.call(o,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1,e]),o.DateTimeFormat.defaultDatePattern=o.DateTimeFormat.shortDatePattern+" H:mm:ss",o.name=function(){return"en-US"},o.id=1033,o}return I(e,t),e}(g),C=function(t){function e(){var e,o,n,r=t.call(this)||this,i={1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["〇","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["〇","壱","弐","参","四","伍","六","七","八","九"]},3:{letters:l,numbers:["０","１","２","３","４","５","６","７","８","９"]}};return N.call(r,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"¥",!1,"NaN (非数値)","-∞",1,1,"+∞",i,{Hundreds:"百",Thousands:"千",Millions:"百万",Billions:"十億",Trillions:"兆"}]),e=["1","2","3","4","5","6","7","8","9","10","11","12",""],o=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],n=["yyyy年M月d日","yyyy年M月dd日","yyyy年MM月d日","yyyy年MM月dd日"],N.call(r,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["日","月","火","水","木","金","土"],e,e,"午前",!1,["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],"yyyy'年'M'月'd'日' H:mm:ss","yyyy'年'M'月'd'日'","H:mm:ss","M'月'd'日'",o,o,"西暦 (日本語)","午後","yyyy/MM/dd",["日","月","火","水","木","金","土"],"H:mm","yyyy'年'M'月'","yyyy年/mmmm/d日",n,"ggge/mmmm/d日"]),r.DateTimeFormat.eras=!0,r.DateTimeFormat.defaultDatePattern=r.DateTimeFormat.shortDatePattern+" "+r.DateTimeFormat.longTimePattern,r._Ab=['gggee"年"MM"月"dd"日','gggee"年"M"月"d"日','ge"年"M"月"d"日','ggge"年"M"月"d"日','ggee"年"M"月"d"日','gge"年"M"月"d"日'],r.name=function(){return"ja-JP"},r.id=1041,r.isJCKCulture=!0,r}return I(e,t),e}(g),v=function(t){function e(){var e,o,n=t.call(this)||this,r={1:{letters:["兆","千","百","十","亿","千","百","十","万","千","百","十",""],numbers:["○","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","仟","佰","拾","亿","仟","佰","拾","万","仟","佰","拾",""],numbers:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"]},3:{letters:l,numbers:["０","１","２","３","４","５","６","７","８","９"]}};return N.call(n,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"¥",!1,"非数字","负无穷大",1,1,"正无穷大",r,{Hundreds:"百",Thousands:"千",Millions:"百万",Billions:"十亿",Trillions:"兆"}]),e=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月",""],o=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],N.call(n,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["周日","周一","周二","周三","周四","周五","周六"],e,e,"上午",!1,["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],1,"yyyy'年'M'月'd'日' H:mm:ss","yyyy'年'M'月'd'日'","H:mm:ss","M'月'd'日'",o,o,"公历","下午","yyyy/M/d",["日","一","二","三","四","五","六"],"H:mm","yyyy'年'M'月'","yyyy年/mmmm/d日"]),n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" "+n.DateTimeFormat.longTimePattern,n.name=function(){return"zh-cn"},n.id=2052,n.isJCKCulture=!0,n.localeCompare=function(t,e){return t.localeCompare(e,"en")},n}return I(e,t),e}(g),b=function(t){function e(){var e,o,n=t.call(this)||this;return N.call(n,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"₩",!1,{1:{letters:["兆","千","百","十","億","千","百","十","万","千","百","十",""],numbers:["０","一","二","三","四","五","六","七","八","九"]},2:{letters:["兆","阡","百","拾","億","阡","百","拾","萬","阡","百","拾",""],numbers:["零","壹","貳","參","四","伍","六","七","八","九"]},3:{letters:["兆","千","百","十","億","千","百","十","万","千","百","十",""],numbers:["０","１","２","３","４","５","６","７","８","９"]},4:{letters:["조","천","백","십","억","천","백","십","만","천","백","십",""],numbers:["○","일","이","삼","사","오","육","칠","팔","구"]}},{Hundreds:"백",Thousands:"천",Millions:"백만",Billions:"10억",Trillions:"조"}]),e=["1","2","3","4","5","6","7","8","9","10","11","12",""],o=["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월",""],N.call(n,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["일","월","화","수","목","금","토"],e,e,"오전",!1,["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],1,"yyyy'년' M'월' d'일' dddd h:mm:ss","yyyy'년' M'월' d'일' dddd","h:mm:ss","M'월' d'일'",o,o,"서기","오후","yyyy-MM-dd",["일","월","화","수","목","금","토"],"tt h:mm","yyyy'년' M'월'","yyyy년/mmmm/d일"]),n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" "+n.DateTimeFormat.longTimePattern,n.name=function(){return"ko-kr"},n.id=1042,n.isJCKCulture=!0,n}return I(e,t),e}(g),w={invariant:new g,"en-us":new y,"ja-jp":new C,"zh-cn":new v,"ko-kr":new b},T={},S=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],x=["wmk1","wmk2"],A=function(){function t(){this.bBb=1,this.OXc={}}return t.instance=function(){return this.cBb||(this.cBb=new this)},t.prototype.culture=function(e){return 0===arguments.length?t.dBb:void(e&&t.dBb!==e&&(t.dBb=e.toLowerCase(),this.bBb++,function(t,e){var o;"object"==typeof document&&("function"!=typeof CustomEvent?(o=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):o=new CustomEvent("cultureChanged",{}),o.cultureInfo=t,a.gcCultureInfo=t,a.gcCultureObj=e,document.dispatchEvent(o))}(t.dBb,t.cBb.getCultureInfo())))},t.prototype.addCultureInfo=function(t,e,o){var n,i,a,s;if(e&&e instanceof g){if(n=e.NumberFormat&&e.NumberFormat.numberDecimalSeparator,i=e.NumberFormat.arrayListSeparator,a=e.NumberFormat.arrayGroupSeparator,n===e.NumberFormat.listSeparator||a===i)throw new r.ResourceManager(r.SR).getResource().Exp_Separator;w[t.toLowerCase()]=e}o&&"object"==typeof o&&(s=t.toLowerCase(),T[s]=c(!0,{},o),this.bBb++)},t.prototype.getCultureInfo=function(e){var o,n,r;if(0===arguments.length)return w[t.dBb];for(r in"string"==typeof e&&(e=e.toLowerCase()),n=l,o=w)if(r===e||o[r].id!==s&&o[r].id===e){n=o[r];break}return n},t.prototype.getLanguage=function(t){if("string"==typeof t){var e=t.toLowerCase();return T[e]}return l},t.prototype.getResources=function(t){var e,o=this.culture().toLowerCase();return t!==l&&t!==s||(t=o),"string"==typeof t&&(e=t.toLowerCase(),this.OXc[e])?this.PXc(this.OXc[e]):l},t.prototype.PXc=function(t){var e,o="PivotTables",n="Sheets",r=c(!0,{},t);return r[o]&&this.QXc(r[o],x),r[n]&&this.QXc(r[n],S),(e=r.CalcEngine)&&(r.Functions=e._h,r.TableFunctions=e.B2,delete e._h,delete e.B2),r},t.prototype.QXc=function(t,e){var o,n;for(o=0,n=e;o<n.length;o++)delete t[n[o]]},t.prototype.eBb=function(t,e){var o,n,r=T[t.toLowerCase()];for(o in e)i.k.Bb(S,o)||null!==(n=this.fBb(r,o))&&"string"==typeof n&&"string"==typeof e[o]&&(e[o]=n);e._h&&r.Functions&&this.gBb(r.Functions,e._h),e.B2&&r.TableFunctions&&c(!0,e.B2,r.TableFunctions)},t.prototype.fBb=function(t,e){var o,n;if(t.hasOwnProperty(e))return t[e];for(o in t)if((n=t[o])&&"object"==typeof n&&n.hasOwnProperty(e))return n[e];return null},t.prototype.gBb=function(t,e){var o,n,r,i,a,s,l;for(o in e)if(t.hasOwnProperty(o))for(s in n=e[o],r=t[o],i=n.parameters,a=r.parameters,n.description=r.description,i)a.hasOwnProperty(s)&&("string"==typeof(l=a[s])&&(i[s].name=l));return{}},t.prototype.q4=function(e){var o=this.getCultureInfo(e);return o||((o=w[t.dBb])||(o=new g)),o},t.prototype.LZa=function(t,e){var o=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,n=o.filterDialogDateFormatter;return(e.indexOf("g")>=0||e.indexOf("e")>=0)&&(n=o.EraFilterDialogDateFormatter||n),n},t.dBb="en-us",t}(),e.CultureManager=A.instance()}).call(this,o("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(t,e,o){"use strict";var n,r;function i(t,e){var o,r;for(o in e)e.hasOwnProperty(o)&&(r=e[o],Array.isArray(r)?(t[o]=[],i(t[o],e[o])):r!==n&&"object"==typeof r?(t[o]={},i(t[o],e[o])):t[o]=e[o])}Object.defineProperty(e,"__esModule",{value:!0}),n=null,r=function(){function t(){}return t.Eb=function(t,e,o){t.splice(e,0,o)},t.Sb=function(t,e){t.push(e)},t.Bb=function(t,e){return t.indexOf(e)>-1},t.Fb=function(t,e){var o=t.indexOf(e);o>-1&&t.splice(o,1)},t.Zb=function(t,e){return t.slice(0,e).concat(t.slice(e+1))},t.Cb=function(t,e,o){return t.indexOf(e,o)},t.$b=function(t,e,o){if(!(e<0))for(var r=0;r<o&&e+r<t.length;r++)t[e+r]=n},t._b=function(t,e){var o;for(e<0&&(e=-1),o=e+1;o<t.length;o++)if(undefined!==t[o]&&t[o]!==n)return o;return-1},t.ac=function(t){return t&&t.length},t.Uo=function(t){var e=[];return i(e,t),e},t}(),e.k=r},"./src/common/util/colorhelper.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f;function h(t,e,o){return o<0&&(o+=240),o>240&&(o-=240),o<40?t+((e-t)*o+20)/40:o<120?e:o<160?t+((e-t)*(160-o)+20)/40:t}function p(t,e,o){var n,r,i,a,s;return 0===o?n=r=i=l(255*e/240+"",10):(void 0,void 0,n=d(a=2*e-(s=e<=120?l((e*(240+o)+120)/240+""):e+o-l((e*o+120)/240+"")),s,t+80),r=d(a,s,t),i=d(a,s,t-80)),{a:255,r:n,g:r,b:i}}function d(t,e,o){return i(l((255*h(t,e,o)+120)/240+""),255)}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/numberhelper.ts"),r=n.o.pb,i=Math.min,a=Math.max,s=Math.abs,l=parseInt,u=function(){function t(t){var e,o,n,r,s=this,u=t.r,c=t.g,f=t.b,h=a(a(u,c),f),p=i(i(u,c),f),d=h+p;s.kc=l((240*d+255)/510+"",10),0===(e=h-p)?(s.mc=0,s.lc=160):(s.kc<=120?s.mc=l((240*e+d/2)/d+"",10):s.mc=l((240*e+(510-d)/2)/(510-d)+"",10),o=(40*(h-u)+e/2)/e,n=(40*(h-c)+e/2)/e,r=(40*(h-f)+e/2)/e,s.lc=l(u===h?r-n+"":c===h?80+o-r+"":160+n-o+"",10),s.lc<0&&(s.lc+=240),s.lc>240&&(s.lc-=240))}return t.prototype.nc=function(t){var e=this,o=e.kc,n=e.oc(e.kc,500,!0);return p(e.lc,o+(n-o)*t,e.mc)},t.prototype.oc=function(t,e,o){return 0===e?t:o?e>0?(t*(1e3-e)+241*e)/1e3:t*(e+1e3)/1e3:((t+=240*e/1e3)<0&&(t=0),t>240&&(t=240),t)},t}(),c=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,f=function(){function t(){}return t.bc=function(t){var e=t.a,o=t.r,n=t.g,i=t.b;return 3===arguments.length&&(e=255,o=arguments[0],n=arguments[1],i=arguments[2]),4===arguments.length&&(e=arguments[0],o=arguments[1],n=arguments[2],i=arguments[3]),255===e?"#"+r(o,!0,2)+r(n,!0,2)+r(i,!0,2):"rgba("+o+","+n+","+i+","+e+")"},t.Pka=function(t,e){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(e):t.a===e.a&&t.r===e.r&&t.g===e.g&&t.b===e.b},t.dc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},t.hc=function(t,e){var o=255-s(t.r-e.r),n=255-s(t.g-e.g),r=255-s(t.b-e.b),i=s(t.a-e.a);return!!(((o/=255)+(n/=255)+(r/=255))/3>=.9&&i<=.05)},t.ic=function(e){var o=255^e.r,n=255^e.g,r=255^e.b;return t.bc(e.a,o,n,r)},t.hBb=function(e){var o,n,r;return"object"!=typeof document?function(t){var e,o,n,r;return/^#[A-Fa-f0-9]+$/.test(t)?(e=t.replace(/^#/,""),o=e.length,n=(n=e.split(3===o?/(.)/:/(..)/)).filter(Boolean).map((function(t){return 3===o?parseInt(t+t,16):parseInt(t,16)})),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),[n[0],n[1],n[2],1]):null!==(r=c.exec(t))?[r[1],r[2],r[3],1]:null}(e):((o=t.Yn)||(n=document.createElement("canvas"))&&n.getContext&&(o=t.Yn=n.getContext("2d")),o?(o.clearRect(1,1,1,1),o.fillStyle=e,o.fillRect(1,1,1,1),(r=o.getImageData(1,1,1,1))?r.data:null):e)},t.ec=function(e){var o,n,r,i,a;return e instanceof t||"object"==typeof e?e:(o=0,n=0,r=0,i=0,e&&((a=t.hBb(e))&&(n=a[0],r=a[1],i=a[2],o=a[3])),{a:o,r:n,g:r,b:i})},t.jc=function(e,o){var n,r;return 0===o?e:(n=new u(e),r=l((o>0?(240-n.kc)*o:n.kc*o)+"",10),t.gc(n.lc,n.kc+r,n.mc))},t.nc=function(e,o){var n=t.ec(e),r=new u(n).nc(o);return t.bc(r)},t.fc=h,t.gc=p,t}(),e.pc=f},"./src/common/util/common.ts":function(t,e,o){"use strict";var n,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/culture/cultureInfo.ts"),r=o("./src/common/util/util.res.en.ts"),i=o("./src/common/util/types.ts"),e.SR={en:r},a=i.j.Ia,s=function(){function t(t,e){this.res=t,this.RXc=e,this.OXc=n.CultureManager.OXc,this.cachedResource=this.iBb(t,!0),this.SXc(this.cachedResource,e),this.bBb=0}return t.prototype.getResource=function(){var t=this.iBb(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.SXc(this.cachedResource,this.RXc),this.cachedResource},t.prototype.SXc=function(t,e){var o;e&&(o=n.CultureManager.culture().toLowerCase(),this.OXc[o]=this.OXc[o]||{},this.OXc[o][e]=t,n.CultureManager.OXc=this.OXc)},t.prototype.iBb=function(t,e){var o,r,i,s=n.CultureManager.culture();if(t&&s){if(o=n.CultureManager.bBb,this.bBb===o&&!e)return;return this.bBb=o,n.CultureManager.getLanguage(s)?(r=a(!0,{},t.en),n.CultureManager.eBb(s,r),r):(i=s.substr(0,2).toLowerCase(),t.hasOwnProperty(i)?t[i]:t.en)}return{}},t}(),e.ResourceManager=s,e.A=function(t,e,o,n){var r,i,a,s,l;if(t&&0<=o&&o<e){for(r=[],void 0,a=void 0,a=o;a<e;a++)void 0!==t[a]&&r.push(a);for(i=r.length,a=0;a<i;a++)l=t[s=r[i-a-1]],t[s]=null,t[Math.floor(s)+n]=l}},e.B=function(t,e,o,n){var r,i,a,s,l,u;if(t&&0<=o&&o<e){for(r=[],void 0,a=o+n,s=void 0,s=o;s<e;s++)void 0!==t[s]&&(o<=s&&s<a?t[s]=null:s>=a&&r.push(s));for(i=r.length,s=0;s<i;s++)u=t[l=r[s]],t[l]=null,t[Math.floor(l)-n]=u}},e.D=function(t,e){return t.hasOwnProperty(e)},e.F=function(t,e){return t instanceof e}},"./src/common/util/datetimehelper.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C;function v(t,o,n,r){var i,s,l,c,f,h,m,y,C,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j=n.DateTimeFormat,P=j.Calendar.convert;if(!o||!o.length)return n&&n.name.length?P?v(t,j.fullDateTimePattern,n):t.toLocaleString():""+t;function L(){return c||f||(c=h.test(o),f=p),c}function G(t,e){if(C)return C[e];switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:return}}for(i=j.eras,s="",h=/([^d]|^)(d|dd)([^d]|$)/g,m=0,y=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g,!("s"===o)&&P&&(C=P.fromGregorian(t)),w=-2,T=-2,S={Qb:""},x=0;A=y.lastIndex,I=y.exec(o),R=o.slice(A,I?I.index:o.length),S.Qb="",m+=b(R,S),s+=S.Qb,I;x++)if(m%2!=1)switch(M=t.getFullYear(),k=t.getDay(),N=t.getHours(),O=t.getMinutes(),D=t.getSeconds(),F=t.getMilliseconds(),E=t.getTimezoneOffset(),I[0]){case"dddd":s+=j.dayNames[k];break;case"ddd":s+=j.abbreviatedDayNames[k];break;case"dd":c=p,s+=u(G(t,2),2);break;case"d":c=p,s+=G(t,2);break;case"MMMM":s+=j.monthGenitiveNames&&L()?j.monthGenitiveNames[G(t,1)]:j.monthNames[G(t,1)];break;case"MMM":s+=j.abbreviatedMonthGenitiveNames&&L()?j.abbreviatedMonthGenitiveNames[G(t,1)]:j.abbreviatedMonthNames[G(t,1)];break;case"MM":s+=u(G(t,1)+1,2);break;case"M":s+=G(t,1)+1;break;case"yyyy":case"yyy":s+=w>=0?a.aBb.ia("ee",t,r):u(C?C[0]:M,4);break;case"yy":s+=w>=0?a.aBb.ia("ee",t,r):u((C?C[0]:M)%100,2);break;case"y":s+=w>=0?a.aBb.ia("e",t,r):""+(C?C[0]:M)%100;break;case"hh":0===(l=N%12)&&(l=12),s+=u(l,2);break;case"h":0===(l=N%12)&&(l=12),s+=l;break;case"HH":s+=u(N,2);break;case"H":s+=""+N;break;case"mm":s+=u(O,2);break;case"m":s+=""+O;break;case"ss":s+=u(D,2);break;case"s":s+=""+D;break;case"tt":s+=N<12?j.amDesignator:j.pmDesignator;break;case"t":s+=(N<12?j.amDesignator:j.pmDesignator).charAt(0);break;case"f":case"0":s+=u(F,3).charAt(0);break;case"ff":case"00":s+=u(F,3).substr(0,2);break;case"fff":case"000":s+=u(F,3);break;case"z":s+=((l=E/60)<=0?"+":"-")+d(g(l));break;case"zz":s+=((l=E/60)<=0?"+":"-")+u(d(g(l)),2);break;case"zzz":s+=((l=E/60)<=0?"+":"-")+u(d(g(l)),2)+":"+u(g(E%60),2);break;case"g":case"gg":case"ggg":if(!i)break;if(w===x-1){w=x;break}s+=a.aBb.ia(I[0],t,r),w=x;break;case"e":case"ee":if(!i){s+=u(C?C[0]:M,4);break}if(T===x-1){T=x;break}s+=a.aBb.ia(I[0],t,r),T=x;break;case"/":s+=j.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":s+=I[0];break;default:throw Error(e.getSR().Exp_InvalidDateFormat)}else s+=I[0];return""+s}function b(t,e){var o,n,r,i=0,a=h;for(o=0,n=t.length;o<n;o++)switch(r=t.charAt(o)){case'"':a?e.Qb+="'":i++,a=h;break;case"\\":a&&(e.Qb+="\\"),a=!a;break;default:e.Qb+=r,a=h}return i}function w(t,e){var o,n=new Date;return t.DateTimeFormat.eras&&e<100&&((e+=(o=a.aBb.ca(n).ea)-o%100)>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(e-=100)),e}function T(t,o,n){var r,a,s,l,u,f,h,p,d,g,m;if(t.Rb){if(t.Rb[o])return t.Rb[o]}else t.Rb={};for(r=(r=(r=o).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),a="^",s={Qb:""},l=[],u=0,f=0,h=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g;(p=h.exec(r))!==c;)if(s.Qb="",d=r.slice(u,p.index),u=h.lastIndex,f+=b(d,s),a+=s.Qb,f%2!=1){switch(p[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":a+="(\\D+)";break;case"tt":case"t":a+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":a+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":a+=n?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":a+="(\\d{2}|\\d{4})";break;case"fff":case"000":a+="(\\d{3})";break;case"ff":case"00":a+="(\\d{2})";break;case"f":case"0":a+="(\\d)";break;case"zzz":a+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":a+="([+-]?\\d\\d?)";break;case"/":a+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw Error(e.getSR().Exp_InvalidDateFormat)}i.k.Sb(l,p[0])}else a+=p[0];return s.Qb="",b(r.slice(u),s),a+=s.Qb,m={Tb:g=(""+(a+="$")).replace(/\s+/g,"\\s+"),Ub:l,_a:RegExp(g)},t.Rb[o]=m,m}function S(t){var e=t.getTimezoneOffset();return-485===e&&(e=-485-43/60),-321===e&&(e=-321-10/60),-507===e&&(e=-507-52/60),e}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/common.ts"),r=o("./src/common/util/stringhelper.ts"),i=o("./src/common/util/arrayhelper.ts"),a=o("./src/common/culture/cultureInfo.ts"),s=o("./src/common/util/types.ts"),l=s.j.Fa,u=r.u.Sa,c=null,f=parseInt,h=!1,p=!0,d=Math.floor,g=Math.abs,m=new n.ResourceManager(n.SR,"Common"),e.getSR=m.getResource.bind(m),y={},C=function(){function t(){}return t.mb=function(t,e,o,n){return o||(o=a.CultureManager.q4()),v(t,e,o,n)},t.Vb=function(t,e,o){return v(t,e,o||a.CultureManager.q4())},t.gBa=function(e,o,n){var r,i,a,s,l,u=h;for((l=n).slice(1).forEach((function(t){t&&(u=!0)})),u||(l=l.concat(o.ma())),i=l.length,r=1;r<i;r++)if((s=l[r])&&(u=p,a=t.Wb(e,s,o)))return a;return c},t.Qa=function(e,o,n){var r,i;return o||n||void 0===(i=y[e])?(r=o?[e,o]:[e],i=t.gBa(e,n||a.CultureManager.q4(),r),o||n||(y[e]=i),i?new Date(i):i):i?new Date(i):i},t.lb=function(e,o){return t.gBa(e,a.CultureManager.q4("invariant"),[e,o])},t.Wb=function(t,e,o){var n,i,s,l,u,p,d,g,m,y,C,v,b,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B;if(t=t.trim(),(l=(s=T(n=o.DateTimeFormat,e,i=1041===o.id))._a.exec(t))===c)return c;for(u=s.Ub,p=c,d=c,g=c,m=c,y=c,C=0,b=0,S=0,x=0,A=c,I=h,R=h,M=0,k=u.length;M<k;M++)if(N=l[M+1])switch(u[M]){case"dd":case"d":if((m=f(N,10))<1||m>31)return c;break;case"MMMM":if((g=o.oa(N))<0||g>11)return c;break;case"MMM":if((g=o.ra(N))<0||g>11)return c;break;case"M":case"MM":case"%M":if((g=f(N,10)-1)<0||g>11)return c;break;case"e":case"ee":if((d=i&&"元"===N?1:w(o,f(N,10)))<0||d>9999)return c;break;case"y":case"yy":case"yyy":case"yyyy":if((d=f(N,10))<0||d>9999)return c;break;case"h":case"hh":case"H":case"HH":if((C=f(N,10))<0)return c;break;case"m":case"mm":if((b=f(N,10))<0||b>59)return c;break;case"s":case"ss":if((S=f(N,10))<0||S>59)return c;break;case"tt":case"t":if(I=(O=N.toUpperCase())===n.pmDesignator.toUpperCase(),R=O===n.amDesignator.toUpperCase(),!I&&!R)return c;break;case"f":case"0":if((x=100*f(N,10))<0||x>999)return c;break;case"ff":case"00":if((x=10*f(N,10))<0||x>999)return c;break;case"fff":case"000":if((x=f(N,10))<0||x>999)return c;break;case"dddd":if((y=o.ua(N))<0||y>6)return c;break;case"ddd":if((y=o.wa(N))<0||y>6)return c;break;case"zzz":if(2!==(D=N.split(/:/)).length)return c;if((v=f(D[0],10))<-12||v>13)return c;if((F=f(D[1],10))<0||F>59)return c;A=60*v+(r.u.kb(N,"-")?-F:F);break;case"z":case"zz":if((v=f(N,10))<-12||v>13)return c;A=60*v;break;case"g":case"gg":case"ggg":if(!(E=N)||!n.eras)return c;if((p=a.aBb.ha(u[M],E))<0)return c}if(P=(j=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(G=n.Calendar.convert)&&(L=G.fromGregorian(P)),G||(L=[P.getFullYear(),P.getMonth(),P.getDate()]),d===c?d=L[0]:d<100&&(n.eras&&p!==c?d=a.aBb.ga(p||0,d):d+=d>=30?1900:2e3),g===c&&(g=L[1]),m===c&&(m=j?L[2]:1),G){if((P=G.toGregorian(d,g,m))===c)return c}else{if(P.setFullYear(d,g,m),P.getDate()!==m)return c;if(y!==c&&P.getDay()!==y)return c}return I&&C<12?C+=12:R&&12===C&&(C=0),P.setHours(C,b,S,x),A!==c&&(B=P.getMinutes()-(A+P.getTimezoneOffset()),P.setHours(P.getHours()+B/60,B%60)),P},t.Xb=function(t){var e,o=t-25569,n=o>=0?1:-1,r=S(new Date(864e5*o)),i=(864e5*t*1440+n-3181192704e6+864e5*r)/1440,a=new Date(i),s=r>=0?1:-1,l=S(new Date(i+36e5*s));if(g(r-l)>=60)if(e=new Date(i+60*(l-r)*1e3),r>l){if(-1===s||l===S(a))return 999===e.getMilliseconds()?new Date(e.valueOf()+1):e}else if(r<l&&(1===s||l===S(a)))return 999===e.getMilliseconds()?new Date(e.valueOf()+1):e;return 999===a.getMilliseconds()?new Date(a.valueOf()+1):a},t.Rka=function(e){if("/OADate("===e.substr(0,8)){var o=parseFloat(e.substr(8,e.length-10));return t.Xb(o)}},t.Daa=function(e){return"/OADate("+t.Ra(e)+")/"},t.Ra=function(t){if(l(t))return 0;"number"==typeof t&&(t=new Date(t));var e=S(t);return(1440*t.getTime()+3181192704e6-864e5*e)/124416e6},t.Yb=function(o){var n,r,i=c,a=p;if(l(o)?i=t.Xb(0):o instanceof Date?i=new Date(o.valueOf()):"string"==typeof o?((n=t.Qa(o))||(isNaN(o)?t.fvb(o)?a=h:(n=new Date(o),isNaN(n.valueOf())&&(a=h),(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(o.replace(/ |\n/g,"").trim()))&&4===r.length&&(-1!==r.indexOf(""+n.getFullYear())&&-1!==r.indexOf(""+(n.getMonth()+1))&&-1!==r.indexOf(""+n.getDate())||(a=h))):(n=t.Xb(parseFloat(o)))||(a=h)),i=n):"number"==typeof o?i=t.Xb(o):a=h,a)return i;throw e.getSR().Exp_InvalidCast},t.fvb=function(t){var e=a.CultureManager.q4().DateTimeFormat,o=function(t,e){var o=0;return e.forEach((function(e){e&&t.indexOf(e)>-1&&o++})),o>1};return o(t,e.monthNames)||o(t,e.abbreviatedMonthNames)||o(t,e.dayNames)||o(t,e.abbreviatedDayNames)||function(t,e){if(t&&t.indexOf(" ")>-1){var o=t.split(" "),n=o.length;return n>=2&&e.indexOf(o[n-2])<=-1&&!isNaN(o[n-1])}return!1}(t,e.monthNames.concat(e.abbreviatedMonthNames))},t.Ska=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},t}(),e.l=C},"./src/common/util/functionhelper.ts":function(t,e,o){"use strict";var n,r,i;function a(t){return t}function s(t,e,o,a,s,l,u,c,f,h,p){var d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L=o[r],G=o[i],B=e[r],_=e[i],V=a[r],H=a[i],z=1===G,U=1===_;if(B===L&&_===G){for(N=0,O=0,D=0,F=0,b=L*G,d=0;d<L;d++)for(g=0;g<G;g++){if(y=l(o[d][g]),C=l(e[d][g]),t&&(n(y)||n(C)))return f;N+=y,O+=y*y,D+=C=h(C),F+=y*C}for(E=b*F-N*D,v=s?E/(b*O-N*N):F/O,w=s?(D*O-N*F)/(b*O-N*N):0,T=[],d=0;d<V;d++)for(T[d]=[],g=0;g<H;g++){if(y=l(a[d][g]),t&&n(y))return f;T[d][g]=0===E?e[0][0]:p(v*y+w)}return u?new u(T):T}if(U&&B===L||1===B&&_===G){for(y=[],C=[],M=G+1,k=G+2,d=0;d<L;d++){if(w=l(x=U?e[d][0]:e[0][d]),t&&n(w))return f;C[d]=z?h(w):w}for(d=0;d<L;d++)for(y[d]=[],g=0;g<G;g++){if(w=l(o[d][g]),t&&n(w))return f;y[d][g]=w}for(j=[],v=0;v<M;v++)for(j[v]=[],b=0;b<k;b++)j[v][b]=0;for(m=0;m<L;m++)for(j[0][M]+=C[m],d=0;d<G;d++)for(x=d+1,j[0][x]+=y[m][d],j[x][0]=j[0][x],j[x][M]+=y[m][d]*C[m],g=d;g<G;g++)j[I=g+1][x]+=y[m][d]*y[m][g],j[x][I]=j[I][x];for(j[0][0]=L,S=P=s?0:1;S<M;S++){if(t){if(0===j[S][S]){for(R=!1,g=S+1;!R&&g<M;g++)if(0!==j[g][S]){for(m=0;m<k;m++)I=j[S][m],j[S][m]=j[g][m],j[g][m]=I;R=!0}if(!R)return c}}else{for(d=S;d<M&&0===j[d][S];)d++;if(d>=M)return c;for(A=P;A<k;A++)x=j[S][A],j[S][A]=j[d][A],j[d][A]=x}for(x=1/j[S][S],A=P;A<k;A++)j[S][A]*=x;for(d=P;d<M;d++)if(d!==S)for(x=-j[d][S],A=0;A<k;A++)j[d][A]+=x*j[S][A];s||(j[0][M]=0)}for(T=[],U||(T[0]=[]),d=0;d<V;d++){for(U&&(T[d]=[]),x=j[0][M],g=0;g<G;g++){if(w=l(U?a[d][g]:a[g][d]),t&&n(w))return f;x+=j[g+1][M]*w}U?T[d][0]=p(x):T[0][d]=p(x)}return u?new u(T):T}return c}Object.defineProperty(e,"__esModule",{value:!0}),n=isNaN,r="rowCount",i="colCount",e.qc=function(t,e,o,n,r,i,l,u){return s(!0,t,e,o,n,r,i,u,l,a,a)},e.sc=function(t,e,o,n,l,u,c){var f,h;for(f=0;f<t[r];f++)for(h=0;h<t[i];h++)if(t[f][h]<=0)return u;return s(!1,t,e,o,n,a,l,c,null,Math.log,Math.exp)}},"./src/common/util/numberhelper.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O;function D(t,e,o,n){return e&&0!==e.length&&"i"!==e?function(t,e,o,n){var r=j(e);return z(t,r,o,n)}(t,e,o.NumberFormat,n):o&&o.name.length>0?t.toLocaleString():""+t}function F(t,e){for(var o,n,r,i,a,s,l,u=y(C(t)),c={Xa:1,Ya:0};u>=10;)u/=10,c.Xa++;return n=(o=""+t).search(/e/gi),r=o.indexOf(e),-1!==n?(a=S(o,0,n),s=S(o,n+1),l=0,-1!==r&&(l=S(a,r+1).length),(i=l-d(s))<0&&(i=0),c.Ya=i):(i=0,-1!==r&&(i=S(o,r+1).length),c.Ya=i),c}function E(t){var e,o={Za:t.charAt(0),$a:0,_a:0},n="";for(e=1;e<t.length;e++)if("+"===(n=t.charAt(e)))o.$a=1;else{if("-"!==n){if("0"===n){o._a=t.length-e;break}throw Error(I().Exp_InvalidExponentFormat)}o.$a=-1}return o}function j(t){var e,o,n,r,i,a,s={ab:f,bb:f,cb:g,eb:0,fb:0,Rja:0,hb:f},l="",u=g,c=g,h=g,p=g,d=g,y=g,C=f,v=[];for(o=0;o<t.length;o++){if(e=t.charAt(o),u)l+=e,'"'===e&&(v.push(l),l="",u=g);else if(c){if("E"===C||"e"===C){if(!(["+","-","0"].indexOf(e)>=0)){c=g,o--;continue}l+=e}else if("+"===C||"-"===C){if("0"!==e){c=g,o--;continue}l+=e}else if("0"===C){if("0"!==e){c=g,d||(d=m,s.hb=E(l)),o--;continue}l+=e}}else if("*"!==C&&"_"!==C&&"\\"!==C||""===l)if("*"===e||"_"===e||"\\"===e)y=g,""!==l&&(v.push(l),l=""),l+=e;else if("'"===e)y=g,""!==l&&(v.push(l),l=""),v.push(e);else if('"'===e)y=g,u=m,""!==l&&(v.push(l),l=""),l+=e;else if(N.indexOf(e)>=0)y=m,N.indexOf(C)<0&&""!==l&&(v.push(l),l=""),l+=e;else if("."!==e||h)if("%"===e)y=g,s.fb++,""!==l&&(v.push(l),l=""),v.push(e);else if("‰"===e)y=g,s.Rja++,""!==l&&(v.push(l),l=""),v.push(e);else if(","===e)if(y){for(n=void 0,""!==l&&(v.push(l),l=""),r=m,i="",a=o+1;a<t.length;a++)if(n=t.charAt(a),""===i)if('"'===n)i=n;else{if(N.indexOf(n)>=0){r=g;break}if("."===n||";"===n)break}else'"'===n&&(i="");r?s.eb++:h||(n=t.charAt(o+1))&&N.indexOf(n)>=0&&(p=m)}else l+=e;else"E"===e||"e"===e?(y=g,c=m,""!==l&&(v.push(l),l=""),l+=e):(y=g,N.indexOf(C)>=0&&""!==l&&(v.push(l),l=""),l+=e);else""!==l&&(v.push(l),l=""),s.ab=v,v=[],h=m,y=g;else l+=e,v.push(l),l="";C=e}return""!==l&&(c&&!d&&(s.hb=E(l)),v.push(l)),p&&(s.cb=m),h?s.bb=v:s.ab=v,s}function P(t,e,o,n){var r,i,a,s,l,u=e[0],c=1,f=0,h=g,p=t.length;for(r=0;r<p;r++)if("number"===(i=t[r].type)){for(a="",l=(s=t[r].value).length-1;l>=0;){if(!(1<=u&&u<=9||0===u&&c===e.length))throw Error(I().Exp_InvalidNumberGroupSize);/\d/gi.test(s[l])?(h&&(a&&t.push({type:"number",value:a}),t.push({type:"groupSeparator",value:o}),a="",h=g),f++):f=0,a=s[l]+a,f===u&&u>0&&(h=m,f=0,c<e.length&&(u=e[c],c++)),l--}a&&t.push({type:i,value:a})}else"fillingChar"===i&&(n.infillIndex=t.length-p),t.push({type:i,value:t[r].value});return t.splice(0,p)}function L(t,e,o,n,r,i){var a,s,l,f,h=q(t,-e);return isFinite(h)||(h=t),f=(a=""+(t=h)).split(/e/i),a=f[0],l=f.length>1?p(f[1],10):0,f=a.split("."),a=f[0],s=f.length>1?f[1]:"",l>0?(a+=(s=c(s,l)).slice(0,l),s=S(s,l)):l<0&&(l=-l,s=(a=t<0?i+u(a.replace(i,""),l+1):u(a,l+1)).slice(-l,a.length)+s,a=a.slice(0,-l)),e>0?s=r+(s=s.length>e?s.slice(0,e):c(s,e)):s="",a+s}function G(t,e,o,n){var r=t;return e>0&&(r=X(r*v(100,e),15)),o>0&&(r=X(r*v(1e3,o),15)),n>0&&(r=X(r/v(1e3,n),15)),r}function B(t){var e,o,n=f;if(t)for(n="",e=0;e<t.length;e++)o=t[e],/^(0|#|\?)+/g.test(o)&&(n+=o);return n}function _(t,e,o){var n,r={value:t,exponentValue:0},i=F(t,".").Xa,a=C(t),s=o?o.length:1;if(a>=1)i>s?(i-=s,r.value=t/v(10,i),r.exponentValue=i):r.exponentValue=0,-1===e.$a&&(e.$a=0);else if(a<1&&a>0){for(e.$a=-1,n=v(10,s);10*a<n;)a*=10,r.exponentValue++;r.value*=v(10,r.exponentValue)}return r}function V(t,e,o,n,r,i,a,s){var l,c,f,h,p,d,g,y,C,v,b,w=s.numberGroupSizes,T=s.numberGroupSeparator,x=s.negativeSign,A=s.percentSymbol,I=s.perMilleSymbol,R=n.hb,M=S(e,0,1);for(M===x&&(e=S(e,1)),e=0===(l=1===e.length&&"0"===e?0:e.length)?"":e,c=0,f="",h=t.length-1;h>=0;h--)if(p="",d=t[h],/^(0|#|\?)+/g.test(d)){if(f!==o){for(g=d.length,y=l-c-1;y>=0&&g>0;y--)p=e.charAt(y)+p,g--,c++;for(C=g-1;C>=0;C--)c++,"0"===(v=d[C])?p=v+p:"?"===v&&(""!==p&&(i.push({type:"number",value:p}),p=""),i.push({type:"numberPlaceholder",value:v}));(f=d+f)===o&&c<l&&(p=e.substr(0,l-c)+p),""!==p&&i.push({type:"number",value:p})}}else n.hb&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(a.replaceExponent=m,b="",b+=R.Za,b+=k[R.$a],b+=u(""+r,R._a),i.push({type:"exponent",value:b})):"_"===d[0]?i.push({type:"placeholder",value:d[1]}):"*"===d[0]?a.hasInfilling||(i.push({type:"fillingChar",value:d[1]}),a.hasInfilling=!0,a.infillIndex=i.length-1):"\\"===d[0]?2===d.length&&i.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?d.length>2&&i.push({type:"text",value:d.substr(1,d.length-2)}):d===A?i.push({type:"percent",value:d}):d===I?i.push({type:"permille",value:d}):O[d]?i.push({type:"currency",value:d}):i.push({type:"text",value:d});M===x&&o&&i.push({type:"text",value:M}),n.cb===m&&P(i,w,T,a),i.reverse(),a.infillIndex=i.length-1-a.infillIndex}function H(t,e,o,n,r,i,a,s,l){var c,f,h,p,d,g,y,C,v,b,w,T,S=l.numberDecimalSeparator,x=l.percentSymbol,A=l.perMilleSymbol,I=e.indexOf(S),N=r.hb;for((I>0||n!==R||o!==M)&&a.push({type:"decimalSeparator",value:S}),c=-1!==I?e.substring(I+1):"",f=0,h="",p=0;p<t.length;p++)if(d=t[p],/^(0|#|\?)+/g.test(d)){if(g="",h!==o){for(y=d.length,C=0,v=f;y>0&&c.length-f>0;)g+=c.charAt(v),y--,f++,C++,v++;for(b=C;y>0;)w=d[b],b++,f++,y--,"0"===w?g+=w:"?"===w&&(""!==g&&(a.push({type:"number",value:g}),g=""),a.push({type:"numberPlaceholder",value:w}));""!==g&&a.push({type:"number",value:g}),h+=d}}else N&&!s.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(s.replaceExponent=m,T="",T+=N.Za,T+=k[N.$a],T+=u(""+i,N._a),a.push({type:"exponent",value:T})):"_"===d[0]?a.push({type:"placeholder",value:d[1]}):"*"===d[0]?(a.push({type:"fillingChar",value:d[1]}),s.hasInfilling&&a.splice(s.infillIndex,1),s.hasInfilling=!0,s.infillIndex=a.length-1):"\\"===d[0]?2===d.length&&a.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?d.length>2&&a.push({type:"text",value:d.substr(1,d.length-2)}):d===x?a.push({type:"percent",value:d}):d===A?a.push({type:"permille",value:d}):O[d]?a.push({type:"currency",value:d}):a.push({type:"text",value:d})}function z(t,e,o,n){var r,i,a,s,l,u,c,f,h,p,d,m,y=[];return t=G(t,e.fb,e.Rja,e.eb),r=e.ab,i=e.bb,r||i?(a=B(r),(s=B(i))||(s=""),e.hb&&(t=(u=_(t,e.hb,a)).value,l=u.exponentValue),(c=F(t,".")).Xa+c.Ya>15&&(t=X(t,15)),o.numberGroupSizes,o.numberGroupSeparator,f=o.numberDecimalSeparator,h=o.negativeSign,p=L(t,b(c.Ya,s.length),0,0,f,h),n||(p=function(t,e){var o=t;return-1!==t.indexOf(e)&&(o=t.replace(/0+$/,"")),o}(p,f)),""===p?(y.push({type:"text",value:(r?r.join(""):"")+(i?i.join(""):"")}),y):(d={hasInfilling:g,infillIndex:-1,replaceExponent:g},"10"!==(m=p.split(f)[0])||isNaN(l)||(m="1",l+=e&&e.hb&&-1===e.hb.$a?-1:1),r&&V(r,m,a,e,l,y,d,o),"0"!==m&&""===a&&i&&y.push({type:"number",value:m}),i&&H(i,p,s,a,e,l,y,d,o),y)):y}function U(t,e){var o,n,r,i,s,u,c,h,g,m,y,C,v,b,w,T;return(t=l(t)?"":a.u.ib(t,"")).match(/^[+-]?infinity$/i)?d(t):t.match(/^0x[a-f0-9]+$/i)?p(t,10):(i=(r=W(t,o=e.NumberFormat,n=o.numberNegativePattern))[0],s=r[1],""===i&&1!==n&&(i=(r=W(t,o,1))[0],s=r[1]),""===i&&(i="+"),s[0]===o.currencySymbol&&(s=S(s,1)),(h=s.indexOf("e"))<0&&(h=s.indexOf("E")),h<0?(c=s,u=f):(c=S(s,0,h),u=S(s,h+1)),(y=c.indexOf("."))<0?(g=c,m=f):(g=S(c,0,y),m=S(c,y+1)),g=g.split(",").join(""),","!==(C=",".replace(/\u00A0/g," "))&&(g=g.split(C).join("")),v=i+g,m!==f&&(v+="."+m),v[v.length-1]===o.percentSymbol&&(v=S(v,0,v.length-1),-1===(b=(v=a.u.ib(v,"")).indexOf("."))&&(b=v.length),w="",w+=S(v,0,b-2),w+=".",w+=S(v,b-2,2),v=w+=S(v,b+1)),u!==f&&(""===(T=W(u,o,1))[0]&&(T[0]="+"),v+="e"+T[0]+T[1]),v.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?d(v):NaN)}function W(t,e,o){var n=e.negativeSign,r=e.positiveSign;if(4!==o&&2!==o||(n=" "+n,r=" "+r),4===o||3===o){if(a.u.jb(t,n))return["-",S(t,0,t.length-n.length)];if(a.u.jb(t,r))return["+",S(t,0,t.length-r.length)]}else if(2===o||1===o){if(a.u.kb(t,n))return["-",S(t,n.length)];if(a.u.kb(t,r))return["+",S(t,r.length)]}else{if(0!==o)throw Error("");if(a.u.kb(t,"(")&&a.u.jb(t,")"))return["-",S(t,1,t.length-2)]}return["",t]}function q(t,e){var o,n;return t=+t,e=+e,isNaN(t)||e%1!=0?NaN:(t=(o=t<0)?-t:t,typeof e===h||0===e?(t=Math.round(t),o?-t:t):(n=(""+t).split("e"),t=Math.round(+(n[0]+"e"+(n[1]?+n[1]-e:-e))),+((n=(""+(t=o?-t:t)).split("e"))[0]+"e"+(n[1]?+n[1]+e:e))))}function J(t){var e=s.CultureManager.q4().NumberFormat;return"string"==typeof t&&(e=s.CultureManager.q4(t).NumberFormat),e}function X(t,e){return"number"==typeof t&&(""+t).length>=e&&(t=+t.toPrecision(e)),t}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/common.ts"),r=o("./src/common/util/types.ts"),i=o("./src/common/util/regexhelper.ts"),a=o("./src/common/util/stringhelper.ts"),s=o("./src/common/culture/cultureInfo.ts"),l=r.j.Fa,u=a.u.Sa,c=a.u.Ta,f=null,h=void 0,p=parseInt,d=parseFloat,g=!1,m=!0,y=Math.floor,C=Math.abs,v=Math.pow,b=Math.min,w="#dot#",T="#group#",S=function(t,e,o){return t.substr(e,o)},x=function(t){return i.q.qb(t)},A=new n.ResourceManager(n.SR),I=A.getResource.bind(A),R="##################0",M="################",k={1:"+",0:"","-1":"-"},N=["0","#","?"],O={"¤":"¤",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH₵":"GH₵","ብር":"ብር","ر.س.‏":"ر.س.‏",XDR:"XDR","د.إ.‏":"د.إ.‏","د.ب.‏":"د.ب.‏","د.ج.‏":"د.ج.‏","ج.م.‏":"ج.م.‏","₪":"₪","د.ع.‏":"د.ع.‏","د.ا.‏":"د.ا.‏","ف.ج.ق.‏":"ف.ج.ق.‏","د.ك.‏":"د.ك.‏","ل.ل.‏":"ل.ل.‏","د.ل.‏":"د.ل.‏","د.م.‏":"د.م.‏","أ.م.‏":"أ.م.‏","ر.ع.‏":"ر.ع.‏","ر.ق.‏":"ر.ق.‏","ج.س.":"ج.س.",S:"S","£":"£","ل.س.‏":"ل.س.‏","د.ت.‏":"د.ت.‏","ر.ي.‏":"ر.ي.‏","₹":"₹",TSh:"TSh","€":"€","₼":"₼","₽":"₽",K:"K","лв.":"лв.","₦":"₦",CFA:"CFA","৳":"৳","¥":"¥",KM:"KM","КМ":"КМ",USh:"USh","Kč":"Kč","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","ރ.":"ރ.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","₱":"₱",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","₡":"₡",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","₲":"₲","Bs.":"Bs.","ريال":"ريال",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","֏":"֏",ISK:"ISK","₾":"₾","​":"​","₸":"₸","៛":"៛","₩":"₩","сом":"сом",Kz:"Kz","₭":"₭",MTn:"MTn","ден":"ден","₮":"₮","रु":"रु","Afl.":"Afl.","ߖߕ.":"ߖߕ.","руб.":"руб.","zł":"zł","؋":"؋",R$:"R$",Db:"Db",RON:"RON","₴":"₴",MAD:"MAD","රු.":"රු.","Lekë":"Lekë",den:"den",RSD:"RSD","дин.":"дин.","ܠ.ܣ.‏":"ܠ.ܣ.‏","Rs.":"Rs.","смн":"смн","฿":"฿","m.":"m.","₺":"₺","ⴷⵔ":"ⴷⵔ","soʻm":"soʻm","сўм":"сўм","₫":"₫",HK$:"HK$",MOP:"MOP",NT$:"NT$"},e.o={Qa:function(t){return U(t,s.CultureManager.q4())},lb:function(t){return U(t,s.CultureManager.q4("invariant"))},mb:function(t,e,o,n){return o||(o=s.CultureManager.q4()),D(t,e,o,n)},nb:function(t,e){var o,n,r;return"string"!=typeof t||(n=(o=J(e)).numberDecimalSeparator,r=o.numberGroupSeparator,"."!==n&&(t=t.replace(x("[.]"),w)),","!==r&&(t=t.replace(x("[,]"),T)),"."!==n&&(t=t.replace(x(w),n)),","!==r&&(t=t.replace(x(T),r))),t},Oa:function(t,e){var o,n,r;return"string"!=typeof t||(n=(o=J(e)).numberDecimalSeparator,r=o.numberGroupSeparator,"."!==n&&(t=t.replace(x("["+n+"]"),w)),","!==r&&(t=t.replace(x("["+r+"]"),T)),"."!==n&&(t=t.replace(x(w),".")),","!==r&&(t=t.replace(x(T),","))),t},Xia:function(t,e){var o,n,r;return!("string"==typeof t&&(o=J(e),n=o.numberDecimalSeparator,r=o.numberGroupSeparator,"."!==n&&"."!==r&&t.indexOf(".")>=0||","!==n&&","!==r&&t.indexOf(",")>=0))},ob:function(t,e){return d(this.Oa(t,e))},pb:function(t,e,o){if(0!==C(y(t)-t))throw Error(I().Exp_BadFormatSpecifier);var n=t>=0?t.toString(16):(4294967295+t+1).toString(16);return n=e?n.toLowerCase():n.toUpperCase(),!l(o)&&n.length<o?u(n,o):n},Hja:j,Ija:z,Jja:function(t){var e,o,n,r="";if(Array.isArray(t)&&t.length>0)for(e=0;e<t.length;e++)if(o=t[e].type,n=t[e].value,"placeholder"===o)r+=" ";else{if("fillingChar"===o)continue;r+="numberPlaceholder"===o?" ":n}return r},eka:R,fka:M,Lma:X}},"./src/common/util/rbush.ts":function(t,e,o){"use strict";function n(t,e){this.TMc=Math.max(4,t||9),this.UMc=Math.max(2,Math.ceil(.4*this.TMc)),e&&this.VMc(e),this.clear()}function r(t,e,o){if(!o)return e.indexOf(t);for(var n=0;n<e.length;n++)if(o(t,e[n]))return n;return-1}function i(t,e){a(t,0,t.children.length,e,t)}function a(t,e,o,n,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var i=e,a=void 0;i<o;i++)a=t.children[i],s(r,t.leaf?n(a):a);return r}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function p(t,e){var o=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),i=Math.min(t.maxY,e.maxY);return Math.max(0,r-o)*Math.max(0,i-n)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&(e.maxX>=0&&e.maxX<=t.maxX||t.maxX<0)&&(e.maxY>=0&&e.maxY<=t.maxY||t.maxY<0)}function g(t,e){return(-1===t.minY||-1===e.minY||t.minY<=e.maxY&&e.minY<=t.maxY)&&(-1===t.minX||-1===e.minX||t.minX<=e.maxX&&e.minX<=t.maxX)}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}Object.defineProperty(e,"__esModule",{value:!0}),e.rbush=n,n.prototype={all:function(){return this.zR(this.data,[])},search:function(t){var e,o,n,r,i,a=this.data,s=[],l=this.toBBox;if(!g(t,a))return s;for(e=[];a;){for(o=0,n=a.children.length;o<n;o++)r=a.children[o],g(t,i=a.leaf?l(r):r)&&(a.leaf?s.push(r):d(t,i)?this.zR(r,s):e.push(r));a=e.pop()}return s},collides:function(t){var e,o,n,r,i,a=this.data,s=this.toBBox;if(!g(t,a))return!1;for(e=[];a;){for(o=0,n=a.children.length;o<n;o++)if(r=a.children[o],g(t,i=a.leaf?s(r):r)){if(a.leaf||d(t,i))return!0;e.push(r)}a=e.pop()}return!1},insert:function(t){return t&&this.Eb(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var o,n,i,a,s=this.data,l=this.toBBox(t),u=[],c=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],o=c.pop(),a=!0),s.leaf&&-1!==(i=r(t,s.children,e)))return s.children.splice(i,1),u.push(s),this.WMc(u),this;a||s.leaf||!d(s,l)?n?(o++,s=n.children[o],a=!1):s=null:(u.push(s),c.push(o),o=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},zR:function(t,e){for(var o=[];t;)t.leaf?e.push.apply(e,t.children):o.push.apply(o,t.children),t=o.pop();return e},XMc:function(t,e,o,n){for(var r,i,a,s,l,u,f,p;n.push(e),!e.leaf&&n.length-1!==o;){for(f=p=1/0,r=0,i=e.children.length;r<i;r++)l=c(a=e.children[r]),(u=h(t,a)-l)<p?(p=u,f=l<f?l:f,s=a):u===p&&l<f&&(f=l,s=a);e=s||e.children[0]}return e},Eb:function(t,e,o){var n=this.toBBox,r=o?t:n(t),i=[],a=this.XMc(r,this.data,e,i);for(a.children.push(t),s(a,r);e>=0&&i[e].children.length>this.TMc;)this.YMc(i,e),e--;this.ZMc(r,i,e)},YMc:function(t,e){var o,n,r=t[e],a=r.children.length,s=this.UMc;this.$Mc(r,s,a),o=this._Mc(r,s,a),(n=m(r.children.splice(o,r.children.length-o))).height=r.height,n.leaf=r.leaf,i(r,this.toBBox),i(n,this.toBBox),e?t[e-1].children.push(n):this.aNc(r,n)},aNc:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},_Mc:function(t,e,o){var n,r,i,s,l,u,f,h;for(u=f=1/0,n=e;n<=o-e;n++)s=p(r=a(t,0,n,this.toBBox),i=a(t,n,o,this.toBBox)),l=c(r)+c(i),s<u?(u=s,h=n,f=l<f?l:f):s===u&&l<f&&(f=l,h=n);return h},$Mc:function(t,e,o){var n=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this.bNc(t,e,o,n)<this.bNc(t,e,o,r)&&t.children.sort(n)},bNc:function(t,e,o,n){t.children.sort(n);var r,i,l=this.toBBox,u=a(t,0,e,l),c=a(t,o-e,o,l),h=f(u)+f(c);for(r=e;r<o-e;r++)i=t.children[r],s(u,t.leaf?l(i):i),h+=f(u);for(r=o-e-1;r>=e;r--)i=t.children[r],s(c,t.leaf?l(i):i),h+=f(c);return h},ZMc:function(t,e,o){for(var n=o;n>=0;n--)s(e[n],t)},WMc:function(t){for(var e=t.length-1,o=void 0;e>=0;e--)0===t[e].children.length?e>0?(o=t[e-1].children).splice(o.indexOf(t[e]),1):this.clear():i(t[e],this.toBBox)},VMc:function(t){var e=["return a"," - b",";"];this.compareMinX=Function("a","b",e.join(t[0])),this.compareMinY=Function("a","b",e.join(t[1])),this.toBBox=Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},"./src/common/util/regexhelper.ts":function(t,e,o){"use strict";var n,r,i;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/stringhelper.ts"),r=!0,i=function(){function t(){}return t.qb=function(e){var o=t.rb[e];return o||(o=t.rb[e]=RegExp(e,"g")),o.lastIndex=0,o},t.sb=function(e){var o=t.tb[e];return o||(o=t.tb[e]=RegExp(e,"gi")),o.lastIndex=0,o},t.ub=function(e,o,n){var i,a,s,l,u;if(t.vb[e])return t.wb[e];if("[~?*]+",t.qb("[~?*]+").test(e)){for(i=[],a=e.split(""),s=void 0,l={".":r,"+":r,$:r,"^":r,"[":r,"]":r,"(":r,")":r,"{":r,"}":r,"|":r,"/":r,"\\":r},u=0;u<a.length;u++)"~"===(s=a[u])&&u<a.length-1?("*"===(s=a[++u])||"?"===s?i.push("\\"):o&&i.push("~"),i.push(s)):"?"===s?i.push("."):"*"===s?(i.push("[\\s\\S]"),n?i.push("+"):i.push("*")):l[s]?(i.push("\\"),i.push(s)):i.push(s);return i.join("")}return null},t.zb=function(e,o,n){var r=t.ub(e,o,n);return r&&(r="^"+r+"$"),r},t.xb=function(t,e){for(var o="#"+t+"0#",r=1;e.indexOf(o)>0;)o=n.u.yb(o,"#"+t+(r-1)+"#","#"+t+r+"#"),r++;return o},t.Ab=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},t.rb={},t.tb={},t.vb={},t.wb={},t}(),e.q=i},"./src/common/util/stringhelper.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("./src/common/util/regexhelper.ts");function r(t,e,o){return t.substr(e,o)}function i(t){return null==t}function a(t,e,o,n){var r,a;if(i(e))throw Error();return""===e||!(e.length>t.length)&&(r=t,a=e,o&&(r=r.toLowerCase(),a=a.toLowerCase()),n(r,a))}e.u={Bb:function(t,e,o){return o&&(t=t.toLowerCase(),e=e.toLowerCase()),""===e||t.indexOf(e)>=0},Cb:function(t,e,o){var n,r;return o?(n=t.toLowerCase(),r=e.toLowerCase(),n.indexOf(r)):t.indexOf(e)},Db:function(t,e){if(!e)return t;for(var o=t;r(o,0,e.length)===e;)o=r(o,e.length);return o},ib:function(t,e){if(!e)return t;for(var o=t;r(o,o.length-e.length,e.length)===e;)o=r(o,0,o.length-e.length);return o},Eb:function(t,e,o){if(e<0||e>t.length||i(o))throw Error();return r(t,0,e)+o+r(t,e,t.length-e)},Fb:function(t,e,o){if(i(o)&&(o=t.length-e),e<0||o<0||e+o>t.length)throw Error();return r(t,0,e)+r(t,e+o,t.length-e-o)},kb:function(t,e,o){return void 0===o&&(o=!1),a(t,e,o,(function(t,e){return t.slice(0,e.length)===e}))},jb:function(t,e,o){return void 0===o&&(o=!1),a(t,e,o,(function(t,e){return t.slice(-e.length)===e}))},Gb:function(t,e,o,n){if(!e)throw Error();return o=(""+o).replace(/\$/g,"$$$$"),t.replace(RegExp(e,"g"+(n?"i":"")),o)},Hb:function(t,o,r,i){return o=n.q.Ab(o),e.u.Gb(t,o,r,i)},Ib:function(t,e){var o=t.indexOf(e);return o<0||o>=t.length?t:r(t,0,o)},Jb:function(t,e){for(var o=0,n=t.indexOf(e);n>=0;)o+=1,n=t.indexOf(e,n+1);return o},yb:function(t,e,o){return t.split(e).join(o)},Kb:function(t,e){var o,n,r=t;for(o=0;o<e.length;o++)n=RegExp("\\{"+o+"\\}","g"),r=r.replace(n,e[o]);return r},Lb:function(t,e,o){var n,r=""+t;for(n=r.length;n<e;n++)r=o?"0"+r:r+"0";return r},Sa:function(t,o){return e.u.Lb(t,o,!0)},Ta:function(t,o){return e.u.Lb(t,o,!1)},Mb:function(t,e){return t===e||!t&&!e||t&&e&&t.toLowerCase()===e.toLowerCase()},Nb:function(t){return t.toUpperCase()},Ob:function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},o=n.q.qb("(?:&|<|>|\"|'|`)");return o.test(t)?t.replace(o,(function(t){return e[t]})):t},Pb:function(t){var e={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},o=n.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return o.test(t)?t.replace(o,(function(t){return e[t]})):t},BIc:function(t){return t.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.j={r4:null,H:function(t,o){var n,r,i;if(e.j.ya(t))for(n=0,r=t.length;n<r&&!1!==o.call(t[n],n,t[n]);n++);else for(i in t)if(t.hasOwnProperty(i)&&!1===o.call(t[i],i,t[i]))break;return t},za:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Aa:function(t){return"function"===e.j.Ba(t)},Ca:function(t){return Array.isArray?Array.isArray(t):"array"===e.j.Ba(t)},Da:function(t){return e.j.jk(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},jk:function(t){return"string"==typeof t},Ba:function(t){var o,n,r,i,a,s;if(null===t)return"null";if(!(o=e.j.r4))for(o=e.j.r4={},r=0,i=(n=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;r<i;r++)o["[object "+n[r]+"]"]=n[r].toLowerCase();return a=o.toString,"object"===(s=typeof t)||"function"===s?o[a.call(t)]||"object":s},Ea:function(t,o,n){var r,i;if(o){if(i=[].indexOf)return i.call(o,t,n);for(r=o.length,e.j.Fa(n)&&(n=0),n=n<0?Math.max(0,r+n):n;n<r;n++)if(n in o&&o[n]===t)return n}return-1},Ga:function(t,e){var o=e.length,n=t.length,r=0;if("number"==typeof o)for(;r<o;r++)t[n]=e[r],n++;else for(;void 0!==e[r];)t[n]=e[r],n++,r++;return t.length=n,t},Ha:function(t,o,n){var r,i,a,s,l=[];if(e.j.ya(t))for(i=0,a=t.length;i<a;i++)null!==(r=o(t[i],i,n))&&(l[l.length]=r);else for(s in s=void 0,t)t.hasOwnProperty(s)&&(null!==(r=o(t[s],s,n))&&(l[l.length]=r));return l.concat([])},Ia:function(){var t,o,n,r,i,a,s,l,u,c,f,h=[];for(t=0;t<arguments.length;t++)h[t]=arguments[t];for(l=h[0]||{},u=1,c=h.length,f=!1,"boolean"==typeof l&&(f=l,l=h[1]||{},u=2),"object"==typeof l||e.j.Aa(l)||(l={}),c===u&&(l=this,--u);u<c;u++)if(a=h[u],!e.j.Fa(a))for(i in a)o=l[i],l!==(r=a[i])&&(n=e.j.Ca(r),f&&r&&(e.j.Ja(r)||n)?(s=n?o&&e.j.Ca(o)?o:[]:o&&e.j.Ja(o)?o:{},l[i]=e.j.Ia(f,s,r)):void 0!==r&&(l[i]=r));return l},G:function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},Ka:function(t){return null!==t&&t===t.window},Ja:function(t){var o,n;if(!t||"object"!==e.j.Ba(t)||t.nodeType||e.j.Ka(t))return!1;o={}.hasOwnProperty;try{if(t.constructor&&!o.call(t,"constructor")&&!o.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(n in t);return void 0===n||o.call(t,n)},ya:function(t){if(e.j.Fa(t))return!1;var o=t.length,n=e.j.Ba(t);return!e.j.Ka(t)&&(!(1!==t.nodeType||!o)||"array"===n||"function"!==n&&(0===o||"number"==typeof o&&o>0&&o-1 in t))},La:function(t,o){var n=o||[];return null!==t&&(e.j.ya(Object(t))?e.j.Ga(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n},Ma:null,Fa:function(t){return null==t},Na:null,Pa:null,C4:function(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||e.j.Fa(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var o,n,r;for(n in o=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(n)&&(r=t[n],t.hasOwnProperty(n)&&o[n]!==r&&(o[n]="object"==typeof r?e.j.C4(r):r));return o.toString=t.toString,o.valueOf=t.valueOf,o}}},"./src/common/util/util.res.en.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidDateFormat="Invalid date format pattern",e.Exp_InvalidExponentFormat="invalid exponent format",e.Exp_InvalidSemicolons="invalid format : too many semicolons",e.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",e.Exp_BadFormatSpecifier="Bad Format Specifier",e.Exp_InvalidNumberFormat="Invalid number format pattern",e.Exp_InvalidCast="InvalidCastException",e.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."},"./src/plugins/commands/commands.entry.ts":function(t,e,o){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/plugins/commands/commands.ts"),e.Key=n.Key,e.CommandManager=n.CommandManager,r=o("./src/plugins/commands/undomanager.ts"),e.UndoManager=r.UndoManager},"./src/plugins/commands/commands.ts":function(t,e,o){"use strict";var n,r,i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.left=37]="left",t[t.right=39]="right",t[t.up=38]="up",t[t.down=40]="down",t[t.tab=9]="tab",t[t.enter=13]="enter",t[t.shift=16]="shift",t[t.ctrl=17]="ctrl",t[t.space=32]="space",t[t.altkey=18]="altkey",t[t.home=36]="home",t[t.end=35]="end",t[t.pup=33]="pup",t[t.pdn=34]="pdn",t[t.backspace=8]="backspace",t[t.del=46]="del",t[t.esc=27]="esc",t[t.a=65]="a",t[t.c=67]="c",t[t.v=86]="v",t[t.x=88]="x",t[t.z=90]="z",t[t.y=89]="y"}(n=e.Key||(e.Key={})),r=function(){function t(t,e,o){var n,r;this.tc=t,this.j4=e,this.Cj=o,n=this,Object.defineProperty(n,"shortcutKey",{get:function(){return n.vc},set:function(t){var e,o,i=n.vc;i!==t&&((e=(r=n.tc.wc)[i])&&((o=e.indexOf(n))>=0&&e.splice(o,1)),n.vc=t,t&&((e=r[t])||(r[t]=e=[]),e.splice(0,0,n)))}})}return t.prototype.canUndo=function(){return this.j4.canUndo},t.prototype.execute=function(t,e,o){var n,r=this,i=!0;r.j4&&e&&r.j4.canUndo&&r.tc.cNc({command:e,result:n,s4:o});try{i=!1!==(n=(r.j4.execute||r.j4)(t,e,1===o))}catch(t){i=!1}return e&&i&&r.tc.g4({command:e,result:n,s4:o}),n},t}(),i=function(){function t(t){this.xc=t,this.Ze={},this.dNc={},this.wc={}}return t.prototype.register=function(t,e,o,n,i,a,s){var l=this,u=new r(l,e,t);l[t]=u,o&&(u.shortcutKey=l.getShortcutKey(o,n,i,a,s))},t.prototype.getCommand=function(t){return this[t]},t.prototype.execute=function(t){var e=this[t.cmd];if(e)return e.execute(this.xc,t,0)},t.prototype.setShortcutKey=function(t,e,o,n,r,i){var a,s,l,u,c=this;if(t)(a=c[t])&&(a.shortcutKey=c.getShortcutKey(e,o,n,r,i));else if(s=c.getShortcutKey(e,o,n,r,i),l=c.getCommands(s))for(u=l.length-1;u>=0;u--)l[u].shortcutKey=void 0},t.prototype.getShortcutKey=function(t,e,o,r,i){if(t){var a="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):n[t];return a||(a=t),a+(e?"+ctrl":"")+(o?"+shift":"")+(r?"+alt":"")+(i?"+window":"")}},t.prototype.getCommands=function(t){return this.wc[t]},t.prototype.addListener=function(t,e){this.Ze[t]=e},t.prototype.removeListener=function(t){delete this.Ze[t]},t.prototype.g4=function(t){var e,o=this.Ze;for(e in o)o.hasOwnProperty(e)&&o[e](t)},t.prototype.EKc=function(t,e){this.dNc[t]=e},t.prototype.eNc=function(t){delete this.dNc[t]},t.prototype.cNc=function(t){var e,o=this.dNc;for(e in o)o.hasOwnProperty(e)&&o[e](t)},t.prototype.no=function(){this.xc=null},t}(),e.CommandManager=i},"./src/plugins/commands/undomanager.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,o){var n=this;n.xc=t,e<0&&(e=2147483647),n.yc=e,n.zc=o,n.Ac=[],n.Bc=[]}return t.prototype.Cc=function(t,e){var o,n,r,i=this;if(t)if(1===e)i.Bc.push(t);else{if(o=i.yc,n=i.Ac.length,o>0&&n>=o)for(r=0;r<n-o+1;r++)i.Ac.shift();i.Ac.push(t),0===e&&(i.Bc=[])}},t.prototype.canUndo=function(){return this.Ac.length>0},t.prototype.undo=function(){var t,e,o=this,n=o.Ac,r=!0;if(o.zc&&o.canUndo()){t=n[n.length-1];try{(e=o.xc.commandManager()[t.cmd])&&(t.yTa=!0,r=e.execute(o.xc,t,1))}catch(t){r=!1}delete t.yTa,!1!==r&&(n.pop(),o.Bc.push(t))}return r},t.prototype.canRedo=function(){return this.Bc.length>0},t.prototype.redo=function(){var t,e,o=this,n=o.Bc,r=!0;if(o.zc&&o.canRedo()){t=n[n.length-1];try{(e=o.xc.commandManager()[t.cmd])&&(t.yTa=!0,r=e.execute(o.xc,t,2))}catch(t){r=!1}delete t.yTa,!1!==r&&(n.pop(),o.Ac.push(t))}return r},t.prototype.getRedoStack=function(){return this.Bc.slice()},t.prototype.getUndoStack=function(){return this.Ac.slice()},t.prototype.maxSize=function(t){var e=this;return arguments.length<1?e.yc:(t>=0&&(e.yc=t),e)},t.prototype.clear=function(){this.Ac=[],this.Bc=[]},t.prototype.PY=function(t){this.Ac=this.Ac.filter(t),this.Bc=this.Bc.filter(t)},t.prototype.no=function(){this.xc=null},t}();e.UndoManager=n},"./src/plugins/formatter/formatter.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_TokenIsNull="token is null",e.Exp_InvalidBackslash="the '\\' cannot be evaluated",e.Exp_FormatIllegal="format is illegal.",e.Exp_ValueIsNull="value is null",e.Exp_DuplicatedDescriptor="The type of descriptor was added.",e.Exp_TokenIllegal="token is illegal.",e.Exp_ValueIllegal="value is illegal.",e.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function $(t,e,o){return t.substr(e,o)}function tt(t){return i.j.Fa(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:""+t}function et(t,e){if("\\"===t[e])throw Error(f().Exp_InvalidBackslash);if(e-1>0&&e-1<t.length&&"\\"===t[e-1]){if(e-2<0)return!0;if(e-2>0&&e-2<t.length)return"\\"!==t[e-2]}return!1}function ot(t){if(!t)throw Error(f().Exp_TokenIsNull);return"["+t+"]"}function nt(t){var e,o,n,r,i;if(t===p||t===h||""===t)return t;for(e="",o=0,n=!1,r=0;r<t.length;r++)'"'===(i=t[r])?(n=!n,e+=i):n?e+=i:"["===i?o++:"]"===i?--o<0&&(o=0):0===o&&(e+=i);return""+e}function rt(t){return t=it(t,"[",""),it(t,"]","")}function it(t,e,o){return!t||t===L.Dc||st(e,o,!0)?t:(e=e.replace(v,"\\$1"),t.replace(RegExp(e,"g"),o))}function at(t){var e,o,n=t.length,r=!1,i="";for(e=0;e<n;e++)"\\"===(o=t.charAt(e))?(r=!r)&&"@"!==t.charAt(e+1)||(i+=o):(r=!1,i+=o);return i}function st(t,e,o){return o?F(t)===F(e):t===e}function lt(t,e){var o,n,r,i;for(1===arguments.length&&(e=!0),o=!1,n="",r=0;r<t.length;r++){if('"'===(i=t[r]))o=!o;else if(!o&&!e&&"/"===i&&!et(t,r))continue;n+=i}return n}function ut(t,e){var o,n,r;if(!t||t===L.Dc)return!1;for(o=function(t){var e,o,n,r="",i=!1;for(e=0,o=t.length;e<o;e++)'"'===(n=t[e])&&(i=!i),"E"===n||i||(r+=F(n));return r}(lt(t)),n=0;n<e.length;n++){if(0===(r=o.indexOf(e[n])))return!0;if(r>0&&"_"!==o[r-1]&&"*"!==o[r-1])return!0}return!1}function ct(t,e,o,n){this.Ic=t,this.Jc=e,this.cultureName=o,this.nOb=n}function ft(t){this.Kc=t}function ht(t){var e,o,r=rt(t);return r&&r!==L.Dc?(o=r[0],["<",">","="].indexOf(o)>-1?(e=V).Name="ConditionalFormatPart":n.u.kb(r,"DBNum",!0)?(e=H).Name="DBNumberFormatPart":st(r[0],"$",!1)&&r.indexOf("-")>-1?(e=B).Name="LocaleIDFormatPart":function(t){var e,o=F(t),n=o[0];if("h"!==n&&"m"!==n&&"s"!==n)return!1;for(e=1;e<o.length;e++)if(n!==o[e])return!1;return!0}(r)?(e=U).Name="ABSTimeFormatPart":r.indexOf("$")<0&&r.length>=3&&((e=W).Name="ColorFormatPart"),e):e}function pt(t,e,o){var n,r;return n=t?t.cultureInfo():N(o),(e<4||4===e&&("ko-kr"===o||"ko-kr"===n.name()))&&(r=n.NumberFormat.dbNumber)?r[e]:h}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/stringhelper.ts"),r=o("./src/common/util/datetimehelper.ts"),i=o("./src/common/util/types.ts"),a=o("./src/common/util/numberhelper.ts"),s=o("./src/common/culture/cultureInfo.ts"),l=o("./src/common/util/common.ts"),u=o("./src/plugins/formatter/formatter.res.en.ts"),i.j.Ia(l.SR.en,u),c=new l.ResourceManager(l.SR),f=c.getResource.bind(c),i.j.Ma=function(t,e){if(i.j.Fa(t))return"null"===e;if(!e)return!1;if(e instanceof Function&&t instanceof e)return!0;if(typeof t===e)return!0;if("function"===e&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e.toLowerCase())return!0;if("DateTime"===e)return t instanceof Date;if("TimeSpan"===e){if(t instanceof Date){var o=r.l.Ra(t);return o>=0&&o<1}return!1}return"string"==typeof e&&"undefined number boolean string".indexOf(e),!1},i.j.Na=function(t,e){return!!a.o.Xia(t,e)&&(t=a.o.Oa(t,e),i.j.Ma(t,"number")||i.j.Ma(t,"DateTime")||i.j.Ma(t,"TimeSpan")||t&&!i.j.Ma(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(t.length>=2&&"0"===t[0]&&"x"===t[1]))},i.j.Pa=function(t){return i.j.Fa(t)||""===t?0:i.j.Ma(t,"number")?t:i.j.Ma(t,"string")&&!isNaN(t)?a.o.Qa(t):i.j.Ma(t,"boolean")?t?1:0:i.j.Ma(t,"DateTime")?r.l.Ra(t):i.j.Ma(t,"TimeSpan")?Math.floor(r.l.Ra(t)):parseFloat(t)},h=null,p=void 0,d=Math.abs,g={Rc:"yy",vd:"y",Qc:"yyyy",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},m=[g.vd,g.Rc,g.Qc,g.jd,g.hd,g.gd,g.fd,g.dd,g.ud,g.wd,g.kd,g.ld,g.md,g.nd,g.xd,g.yd,g.td,g.zd,"ggg","gg","g","ee","e"],y={Hc:0,Va:1,Ua:2,_text:3},C=[{Hc:0,Va:0,Ua:0,_text:0},{Hc:0,Va:1,Ua:0,_text:0},{Hc:0,Va:1,Ua:2,_text:0},{Hc:0,Va:1,Ua:2,_text:3}],v=RegExp("([.+?*$^\\[\\](){}|/])","g"),b=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],w=i.j.Ma,T=i.j.Ca,S=a.o,x=S.eka+"."+S.fka,A=S.Jja,I=S.mb,R=S.Lma,M=i.j.Fa,k=isNaN,N=function(t){return s.CultureManager.q4(t)},O=function(t){return N(t).DateTimeFormat},D=function(t){return N(t).NumberFormat},F=function(t){return t&&t.toLowerCase()},E=function(t){return t&&t.toUpperCase()},j=function(){throw Error(f().Exp_FormatIllegal)},P=function(){return s.CultureManager.booleanMapping},L={Dc:"",Kb:function(){var t,e,o,n,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(0===arguments.length)return h;for(n=e[0],r=1;r<arguments.length;r++)i=RegExp("\\{"+(r-1)+"\\}","gm"),n=n.replace(i,arguments[r]);return n},Ec:function(t){return!t||t===L.Dc}},G={Fc:function(t){var e=t.charCodeAt(0);return e>=48&&e<=57},Gc:function(t){var e=t.charCodeAt(0);return e>=9&&e<=13||32===e||133===e||160===e}},B=function(){function t(t,e){var o,r,i,a;if(ft.call(this,e),(o=this).Uc=t,i=st((r=o.Uc)[0],"$",!1),a=r.indexOf("-"),!(i&&a>-1))throw Error(f().Exp_TokenIllegal);o.Vc=$(r,1,a-1),(r=n.u.Fb(r,0,a+1)).length>0&&(o.Wc=parseInt(r,16))}return t.prototype.cultureInfo=function(){var t=this;return t.Xc||(t.Xc=N(t.Wc),t.Vc&&t.Vc!==L.Dc&&!t.Xc.NumberFormat.isReadOnly&&(t.Xc.NumberFormat.currencySymbol=t.Vc)),t.Xc},t.prototype.currencySymbol=function(){return this.Vc?n.u.Gb(this.Vc,"\\.",'"."'):L.Dc},t.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},t.prototype.toString=function(){return this.Uc?ot(this.Uc):L.Dc},t.Name="LocaleIDFormatPart",t}(),_=function(){function t(t,e){this.formatCached=t,this.cultureName=e,this.typeName=""}return t.prototype.format=function(t){return h},t.prototype.parse=function(t){return h},t.prototype.formatString=function(t){return this.formatCached},t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==p&&(this[e]=t[e])},t}(),e.FormatterBase=_,V=function(){function t(t,e){var o,r,i,a,s,l,u,c;for(ft.call(this,e),o=this,l=0,u=(s=["<=","<>",">=",">","<","="]).length;l<u;l++)if(r=s[l],n.u.kb(t,r,!0)){i=n.u.Fb(t,0,r.length),c=parseFloat(i),k(c)||(a=c);break}if(a===h&&a===p)throw Error(f().Exp_TokenIllegal);o.value=a,o.Sc=r,o.isMeetCondition=function(t){var e=o.Sc,n=o.value;switch(e){case"<=":return t<=n;case"<>":return t!==n;case">=":return t>=n;case">":return t>n;case"<":return t<n;case"=":return t===n}}}return t.prototype.toString=function(){return ot(this.Sc+""+this.value)},t}(),H=function(){function t(t,e){ft.call(this,e);var o=this;if(o.token=t,o.type=parseInt(n.u.Fb(t,0,5),10),o.type<0||o.type>4)throw Error(f().Exp_TokenIllegal)}return t.prototype.Pc=function(e,o,r){var i,a,s,l,u,c,f,h,p,d;if(!e||e===L.Dc)return e;for(i=e,a=e,s=-1,l=-1,u=!1,p=e.length-1;p>=0;p--)d=a[p],!k(d)&&!st(d," ",!1)||st(d,".",!1)&&!u?(st(d,".",!1)&&(u=!0),-1===s&&(s=p),l=p):l>-1&&s>-1&&(c=$(a,l,s-l+1),f=parseFloat(c),k(f)||(h=t.numberString(c,o,r),i=n.u.Fb(i,l,s-l+1),i=n.u.Eb(i,l,h)),s=-1,l=-1,u=!1);return l>-1&&s>-1&&(c=$(a,l,s-l+1),f=parseFloat(c),k(f)||(h=t.numberString(c,o,r),i=n.u.Fb(i,l,s-l+1),i=n.u.Eb(i,l,h))),i},t.prototype.toString=function(){if(this.type>-1)return ot("DBNum"+this.type);throw Error()},t.numberString=function(e,o,n){var r=t.formatNumberString,i=e.split(".");if(i){if(1===i.length)return r(i[0],o.numbers,n?o.letters:h);if(2===i.length)return r(i[0],o.numbers,n?o.letters:h)+"."+r(i[1],o.numbers)}throw Error(f().Exp_ValueIllegal)},t.formatNumberString=function(e,o,n){var r,i,a,s,l,u,c,f,h,p,d,g,m,y=e,C=0,v=0;if(2===arguments.length){for(i="",C=0;C<y.length;C++)r=$(y,C,1),i+=o[v=parseInt(r,10)];return i}if(3===arguments.length){if(!n)return t.formatNumberString(e,o);for(a=0,s="",l=y.length,u=!1,c=[],C=0;C<l;C++)(f=n.length-1-C)>-1?c.push(""+n[f]):c.push(L.Dc);for(h=[],p=c.length-1;p>=0;p--)h[c.length-p-1]=c[p];for(c=h,d=!1,p=0;p<l;p++)r=$(y,p,1),v=parseInt(r,10),g=void 0,m=L.Dc,l-p-16>0?(g=o[v],m="",d=!0):p!==l-1&&p!==l-5&&p!==l-9&&p!==l-13?"0"===r?(g="",m="",a+=1):"0"!==r&&0!==a?(g=o[0]+o[v],m=c[p],a=0):(g=o[v],m=c[p],a=0):"0"!==r&&0!==a?(g=o[0]+o[v],m=c[p],a=0):"0"!==r&&0===a||d?(g=o[v],m=c[p],a=0,d=!1):"0"===r&&a>=3?(g="",m="",a+=1):l>=11?(g="",a+=1):(g="",m=c[p],a+=1),g+m===L.Dc||(u=!1),p!==l-13||u||(m=c[p],u=!0),p!==l-9||u||(m=c[p],u=!0),p===l-1&&(m=c[p],u=!0),s=s+g+m;return 0===parseInt(e,10)?o[0]:s}},t}(),z=function(){function t(t,e,o,n,r,i){ct.call(this,e,o,n,i);var a=this;a.Yc=a.Zc(lt(t)),a.$c=r,a._c=2,a.ad()}return t.prototype.ad=function(){var e,o,n,r,i=this,a={Qb:i.Yc};if(t.Lc(a.Qb)){if(e=i.bd(a),o=O(this.cultureName).amDesignator&&O(this.cultureName).pmDesignator,i.hasJD=i.Gb(a.Qb,g.dd,'"'+g.ed+'"',!0,!1,a,!1),i.Gb(a.Qb,g.fd,"MMMM",!0,!1,a,!1),i.Gb(a.Qb,g.gd,"MMM",!0,!1,a,!1),i.kYc(a.Qb,a,"mm","MM"),i.kYc(a.Qb,a,"m","M"),i.Gb(a.Qb,g.kd,"ddd",!0,!0,a,!0),i.Gb(a.Qb,g.ld,"dddd",!0,!0,a,!0),e&&o||(i.Gb(a.Qb,g.md,"H",!0,!0,a,!1),i.Gb(a.Qb,g.nd,"HH",!0,!0,a,!1)),i.Jc&&(i.Ic||N(i.cultureName).NumberFormat.dbNumber)&&(i.od=i.od||i.Gb(a.Qb,g.Qc,'"@'+g.Qc+'"',!0,!1,a,!0),i.od=i.od||i.Gb(a.Qb,g.Rc,'"@'+g.Rc+'"',!0,!1,a,!0)),i.$c)for(n=0;n<i.$c.length;n++)r=i.$c[n],i.Gb(a.Qb,r.Kc,"@"+r.Kc,!0,!0,a,!0);i.pd=a.Qb}else j()},t.prototype.formatString=function(){return this.Yc},t.prototype.format=function(t){var e,o,i,a,s,l,u=this,c=L.Dc,f=h;try{if((f=r.l.Yb(t))&&k(f.valueOf())&&(f=h),f?t=f:c=""+t,f&&(c=r.l.mb(f,u.pd,u.Ic&&u.Ic.cultureInfo()||N(u.cultureName),u.nOb),u.hasJD&&(e=N(u.cultureName).DateTimeFormat.monthNames[f.getMonth()],c=n.u.Gb(c,g.ed,$(e,0,1))),u.$c))for(o=24*(r.l.Ra(f)-r.l.Ra(g.qd))*60*60*1e3,i=0;i<u.$c.length;i++)s=(a=u.$c[i]).Tc(o),M(s)||(l=a.Kc.replace("[","\\[").replace("]","\\]"),c=n.u.Gb(c,"@"+l,s))}catch(e){c=tt(t)}return function(t,e,o,n,i){var a,s=t;if(!M(n)&&e instanceof Date){if(!(a=pt(o,n.type,i)))return t;s=n.Pc(s,a,!0),1===n.type&&(s=s.replace(RegExp("一十","g"),"十")),s=(s=s.replace("@"+g.Qc,r.l.Vb(e,g.Qc))).replace("@"+g.Rc,r.l.Vb(e,g.Rc)),s=n.Pc(s,a,!1)}return s}(c,t,u.Ic,u.Jc,u.cultureName)},t.prototype.parse=function(t){var e,o,n,i,a;if(!t||t===L.Dc)return h;if(e=this,"true"===(n=F(o=t)))return!0;if("false"===n)return!1;if(e.pd&&(i=r.l.Wb(o,e.pd,N(e.cultureName))))return i;try{return(a=r.l.Yb(o))&&!k(a)?a:(a=new Date(o),k(a.valueOf())?o:a)}catch(t){return o}},t.prototype.Zc=function(t){var e,o,n,r=t,i="",a=!1;for(e=0;e<r.length;e++)'"'===(o=r[e])?a=!a:a||("Y"===o||"D"===o||"S"===o||"E"===o||"G"===o?o=F(o):"M"===o&&(st("A",n=r[e-1],!0)||st("P",n,!0)||(o=F(o)))),i+=o;return i},t.prototype.bd=function(t){var e,o,r,i=O(this.cultureName).amDesignator,a=O(this.cultureName).pmDesignator,s=[g.rd];for(i&&a?s.push(i+"/"+a):s.push(g.rd),s.push(g.sd),e=["tt","tt","t"],o=t.Qb,r=0;r<3;r++){if(n.u.Bb(o,e[r]))return!0;if(n.u.Bb(o,s[r],!0))return t.Qb=n.u.Gb(o,s[r],e[r],!0),!0}return!1},t.prototype.kYc=function(t,e,o,n){var r,i,a,s="",l=t.length,u=0;for(r=0;r<l;r++)if('"'===t[r]&&(u=(u+1)%2),"m"!==t[r]||u)s+=t[r];else{for(i="m";r+1<l&&"m"===t[r+1];)r++,i+="m";s+=i===o?n:i}a=RegExp(n+"(?=[^yYdDhHmM]*[Ss])|"+n+"(?=.0)","g"),s=(s=s.replace(a,o)).split("").reverse().join(""),a=RegExp(n+"(?=[^mM]*[Hh])","g"),s=(s=s.replace(a,o)).split("").reverse().join(""),e.Qb=s},t.prototype.Gb=function(e,o,r,i,a,s,l){var u,c,f,h,p,d,g,m,y,C,v;if(i||a){for(u=[],c=!0,!t.hasDate(e)&&t.hasTime(e)&&(c=!1),f=!1,h=0;h<e.length;h++){if(p=e[h],t.hasTime(p)&&!f?c=!1:t.hasDate(p)&&!f&&(c=!0),i&&st(p,o[0],l)&&c||a&&st(p,o[0],l)&&!c){for(d=!0,g=0;g<o.length;g++)if(g+h>=e.length||!st(o[g],e[g+h],l)){d=!1;break}if(m=h+o.length-1,d&&m+1<e.length){for(y=e[m],C=-1,C=m+1;C<e.length&&st(y,e[C],l);C++);C>m+1&&(h=C,d=!1)}d&&!f&&u.splice(0,0,h)}'"'===p&&(f=!f)}if(s.Qb=e,u.length>0){for(h=0;h<u.length;h++)v=u[h],s.Qb=n.u.Fb(s.Qb,v,o.length),s.Qb=n.u.Eb(s.Qb,v,r);return!0}return!1}return!1},t.hasTime=function(t){return n.u.Cb(t,g.md[0],!0)>-1||n.u.Cb(t,g.td[0],!0)>-1},t.hasDate=function(t){return n.u.Cb(t,g.Rc[0],!0)>-1||n.u.Cb(t,g.ud[0],!0)>-1},t.Lc=function(t,e){return ut(t,e||m)},t}(),e.lxb=z,U=function(){function t(t,e){var o,n;if(ft.call(this,e),this,"h"===(o=F(t)[0]))n=3600;else if("m"===o)n=60;else{if("s"!==o)throw Error(f().Exp_TokenIllegal);n=1}this.Tc=function(t){var e=t/1e3/n;return Math.abs(e-Math.round(e))<1e-6?Math.round(e):Math.floor(e)}}return t.Name="ABSTimeFormatPart",t}(),W=function(){function t(t,e){ft.call(this,e),this.foreColor=t}return t.prototype.toString=function(){return ot(this.foreColor)},t.Name="ColorFormatPart",t}(),q=function(){function t(t,e,o,n){var r,i,a,s,l;ct.call(this,e,o,n),(r=this).Ad=!1,r._c=1,r.Bd=nt(t),i=lt(t),e&&(i=it(i,r.Ic.Kc,r.Ic.currencySymbol())),(i=nt(i)).indexOf("/")>-1&&(a=function(t,e){var o,n,r,i,a,s=[];if(t===h||""===t)return s;for(o=!1,n=[],r=!1,i=0;i<t.length;i++)'"'!==(a=t[i])||o||(r=!r),o||r||a!==e?n.push(a):(s.push(n.join("")),n=[]),o="\\"===a&&!o;return s.push(n.join("")),s}(i,"/"),a&&2===a.length&&(r.Cd=a[1],(s=a[0])&&((l=s.lastIndexOf(" "))>-1?(r.Dd=$(s,0,l),r.Ed=$(s,l+1,s.length-l-1)):r.Ed=s))),r.Fd=i}return t.prototype.formatString=function(){return this.Bd},t.prototype.format=function(e){var o,n,r,a,s,l,u,c,f,p,d,g,m,y,C,v,b,T,S,x,R;return w(e,"boolean")?(""+e).toUpperCase():(o=this,n=i.j.Pa(e),k(n)||!isFinite(n)||k(e)?"string"==typeof e?e:h:(r=N(o.cultureName),o.Ed&&o.Cd?(f={value:0},p={value:0},d={value:0},g=o.bPa(),t.getFraction(n,g,f,p,d)?((m=t.getGCD(p.value,d.value))>1&&(p.value/=m,d.value/=m),o.Dd?(c="",1===d.value&&(f.value+=p.value,p.value=0,d.value=0),(y=A(I(f.value,o.Dd,r)))&&"0"!==y&&(c+=y,c+=" "),0===f.value&&n<0&&(c+=r.NumberFormat.negativeSign),0===n&&(c+="0"),a=o.Cd,s=parseFloat(a),!k(s)&&s>0&&(0!==p.value&&0!==d.value&&(p.value*=s/d.value),d.value=s,a=a.replace(/^\d+/,t.toNumberPlaceholder(s)),u=(l=Math.ceil(p.value))-p.value,p.value=u<=.5&&u>=0?parseFloat(""+l):parseFloat(""+(l-1))),C=o.Ed,v=parseFloat(C),k(v)||0!==v||((b=C.length)>(S=(T=""+p.value).length)?C=C.substr(0,b-(b-S)):b<S&&(T=T.substr(0,S-(S-b)),p.value=parseInt(T,10))),x=o.Mja(p.value,d.value,C,a,r),0===p.value&&(x=x.replace(/./g," "),""===y)?"0 "+x:""===(c+=x)?"0":c):(c="",R=f.value*d.value+p.value,a=o.Cd,(s=parseFloat(a))>0?(R*=s/d.value,d.value=s,c+=(R=(u=(l=Math.ceil(R))-R)<=.5&&u>=0?parseFloat(""+l):parseFloat(""+(l-1)))+"/"+d.value):c+=o.Mja(R,d.value,o.Ed,o.Cd,r),0===R?"0":c)):""+n):function(t,e,o,n,r){var i,a,s,l,u,c,f;if(!M(n)&&(i=pt(o,n.type,r),!M(i))){for(a=!1,s=void 0,l=N(r),u=void 0,c=0,f=t.length;c<f;c++)"decimalSeparator"===t[c].type&&(a=!0,t[c].value=n.Pc(t[c].value,i,e),s=t[c].value),"number"===t[c].type&&(t[c].value=a?n.Pc(s+t[c].value,i,e).slice(1):n.Pc(t[c].value,i,e),"ja-JP"===l.name()&&t[c].value.length>1&&("一千"!==(u=t[c].value.substr(0,2))&&"一百"!==u&&"一十"!==u||(t[c].value=t[c].value.substr(1))));return t}return t}(I(n,o.Fd,r),o.Ad,o.Ic,o.Jc,o.cultureName)))},t.prototype.parse=function(t){var e,o,r,i,a,s,l,u,c,f,p=this;return t&&t!==L.Dc?!!("TRUE"===(e=E(t))||e===P()&&P().boolean_true)||!("FALSE"===e||e===P()&&P().boolean_false)&&(o=p.Ed&&p.Cd,r=p.Jd(p.Fd).Kd,(o||r)&&(0<(i=t.indexOf("/"))&&i<t.length-1&&(a=parseInt(t.substr(0,i),10),s=parseInt(t.substr(i+1),10),!isNaN(a)&&!isNaN(s)&&0!==s))?a/s:(t=p.Hd(t),t=p.Id(t),u=(l=p.Jd(t)).Kd,c=l.Ld,p.jBb(c)&&(c=n.u.Hb(c,D(p.cultureName).numberGroupSeparator,"",!1),f=S.ob(c,p.cultureName),!k(f)&&isFinite(f))?(u&&(f=R(f/100,15)),f):h)):h},t.prototype.bPa=function(){var t,e,o=this.Cd,n=0;if(o)for(t=o.length,e=0;e<t&&o[e].match(/[#?0\d]/);e++)n++;return n},t.prototype.jBb=function(t){var e,o="",n=0,r=0,i=0,a=h,s=D(this.cultureName);for(e=t.length-1;e>-1;e--){if(t[e]===s.numberDecimalSeparator)n++,i>0&&(a=!1),o="";else if("e"===F(t[e])){if(r++,o="",e===t.length-1)return!1}else if(t[e]===s.numberGroupSeparator)a=3===o.length,i++,o="";else if("-"===t[e]||"+"===t[e]){if(e>0&&"e"!==F(t[e-1]))return!1}else{if(!G.Fc(t[e]))return!1;if(o+=t[e],0===e&&0===parseInt(o,10)&&a)return!1}if(n>1||r>1||!1===a)return!1}return!0},t.prototype.Hd=function(t){var e,o,r,i,a,s,l=t,u=[];for(e=0;e<l.length;e++)G.Fc(l[e])&&u.push(e);for(r=[(o=D(this.cultureName)).currencyDecimalSeparator,o.currencyGroupSeparator,o.currencySymbol,o.nanSymbol,o.negativeInfinitySymbol,o.negativeSign,o.numberDecimalSeparator,o.numberGroupSeparator,o.percentDecimalSeparator,o.percentGroupSeparator,o.percentSymbol,o.perMilleSymbol,o.positiveInfinitySymbol,o.positiveSign],i=l.length-1;i>-1;i--)if(a=l[i],!G.Gc(a)||r.indexOf(""+a)>-1){if(("-"===a||"+"===a)&&(s=i>0?""+l[i-1]:h,["e","E","(",D(this.cultureName).currencySymbol].indexOf(s)<0))break}else(i<u[0]||u[u.length-1]<i)&&(l=n.u.Fb(l,i,1));return l},t.prototype.Id=function(t){var e=D(this.cultureName).currencySymbol,o=n.u.kb(t,e)?n.u.Fb(t,0,e.length):t;return o.indexOf(e)<0?o:t},t.prototype.Jd=function(t){var e=D(this.cultureName).percentSymbol,o=!0,r=t;return n.u.kb(t,e)?r=n.u.Fb(t,0,e.length):n.u.jb(t,e)?r=n.u.Fb(t,t.length-e.length,e.length):o=!1,n.u.Bb(r,e)&&(o=!1),{Ld:r,Kd:o}},t.prototype.Mja=function(t,e,o,n,r){var i=A(I(t,o,r)),a=A(I("0."+e,"#."+n,r,!0)),s=i+"/"+a.substr(a.indexOf(".")+1);return""===o&&(s=t+s),""===n&&(s+=e),s},t.getGCD=function(t,e){var o,n;if(0===t)return d(e);if(0===e)return d(t);for(n=Math.max(t,e)%(o=Math.min(t,e));0!==n;)n=o%(o=n);return d(o)},t.getFraction=function(t,e,o,n,r){var i,a,s,l,u,c,f,h,p,g=0,m=0,y=0,C=0,v=Math.ceil;for(t>0?1===(C=t-v(t)+1)?(C=0,g=t):g=v(t)-1:t<0&&(g=v(t),C=v(t)-t),(i=Math.pow(10,e-1))<2&&(i=2),(a=Math.pow(10,e)-1)<2&&(a=2),s=!1,l=0,u=i;u<=a&&(c=u*C,f=Math.round(c),p=d((h=f/u)-C),!((!s||p<d(l-C))&&(s=!0,l=h,m=f,y=u,p<1e-5)));u++);return o.value=g,n.value=m,r.value=y,s},t.toNumberPlaceholder=function(t){return(""+t).replace(/\d/g,"?")},t}(),J=function(){function t(e,o,n,r){ct.call(this,o,n,r),arguments.length>0?(t.kBb(e)||j(),this.Bd=e):this.Bd="General",this._c=0}return t.kBb=function(t){var e,o,n="",r=!1,i=-1,a=t.length;for(e=0;e<a;e++)'"'===(o=t[e])?i=(r=!r)?e:-1:r||(n+=o);return i>0&&(n+=t.substring(i,a)),!(n.indexOf("0")>=0||n.indexOf("#")>=0||n.indexOf(".")>=0||n.indexOf("@")>=0)},t.prototype.Nd=function(){var t,e=this;return e.Od||(t=it(t=e.Bd,"General",x),e.Od=new q(t,e.Ic,e.Jc,e.cultureName),e.Od.Ad=!0),e.Od},t.prototype.Pd=function(){var t=this;return t.Qd||(t.Qd=new q("0.#####E+00",t.Ic,t.Jc,t.cultureName),t.Qd.Ad=!0),t.Qd},t.prototype.formatString=function(){return n.u.Gb(this.Bd,"@NumberFormat","General")},t.prototype.format=function(t){var e,o,r=this;if(i.j.Na(t,r.cultureName)){if(e=!r.Ic||r.Ic.allowScience(),(o=i.j.Pa(t))!==p&&o!==h)return d(o)>99999999999&&e||d(o)<1e-11&&0!==o?r.Pd().format(t):r.Nd().format(t)}else{if(w(t,"string"))return at(n.u.Gb(r.formatString(),'"',"")),t;if(w(t,"boolean"))return(""+t).toUpperCase()}return""},t.prototype.parse=function(t){var e,o,i,a,l,u,c,f,g,m,y,C,v,b;return L.Ec(t)?h:"number"==typeof t?t:(e=!1,o=t.trim(),(i=n.u.Cb(o,"-",!1))>0&&!st(o.charAt(i-1),"E",!0)&&(e=!0),u=(l=(a=N(this.cultureName)).DateTimeFormat).dateSeparator,c=l.timeSeparator,f=l.monthNames,g=l.abbreviatedMonthNames,m=function(t,e){var o,r,i;if(!e||0===e.length)return!1;for(o=!1,r=0,i=e.length;r<i;r++)if(n.u.Bb(t,e[r],!0)){o=!0;break}return o},(e||n.u.Bb(o,u,!1)||n.u.Bb(o,c,!1)||n.u.Bb(o,"/",!1)||n.u.Bb(o,":",!1)||n.u.Bb(o,"-",!1)||n.u.Bb(o,"年",!1)||n.u.Bb(o,"月",!1)||n.u.Bb(o,"日",!1)||m(o,f)||m(o,g)||"ja-JP"===a.name()&&s.aBb.R.indexOf(o[0].toUpperCase())>=0&&n.u.Bb(o,".",!1))&&(y=r.l.Qa(o))?y:(v="-"===o.charAt(0),(b="("===(o=v?n.u.Fb(o,0,1):o).charAt(0)&&")"===o.charAt(o.length-1))&&(o=o.substring(1,o.length-1)),(C=this.Nd().parse(o))!==h&&C!==p?(b||v)&&w(C,"number")?-1*d(C):C:t))},t}(),X=function(){function t(t,e,o,n){var r,i=this;ct.call(i,e,o,n),r=lt(t,!1),e&&(r=it(r,i.Ic.Kc,i.Ic.currencySymbol())),r=at(r=nt(r)),i.Yc=r,i._c=3}return t.prototype.format=function(t,e){var o,n,i=this;try{return void 0,void 0,o=t instanceof Date?""+r.l.Ra(t):tt(t),n=i.Kja(i.Yc),i.Lja(o,n.formatTokens,t,n.hasAtPart,e)}catch(t){return""}},t.prototype.parse=function(t){return t||""},t.prototype.formatString=function(){return this.Yc},t.prototype.Kja=function(t){var e,o,n=[],r=!1,i="",a=!1,s=h;for(o=0;o<t.length;o++)e=t.charAt(o),a?('"'!==e?i+=e:(i+=e,n.push(i),i="",a=!1),s=e):"*"!==s&&"_"!==s&&"\\"!==s||""===i?"*"!==e&&"_"!==e&&"\\"!==e?"@"!==e?'"'!==e?(i+=e,s=e):(s=e,""!==i&&n.push(i),i=e,a=!0):(s=e,""!==i&&(n.push(i),i=""),n.push(e),r=!0):(s=e,""!==i&&(n.push(i),i=""),i+=e):(i+=e,n.push(i),i="");return""!==i&&n.push(i),{formatTokens:n,hasAtPart:r}},t.prototype.Lja=function(t,e,o,n,r){var i,a,s=[],l=!1;if("string"!=typeof o||n||r)for(i=e.length-1;i>=0;i--)"*"===(a=e[i])[0]?l||(l=!0,s.push({type:"fillingChar",value:a[1]})):"_"===a[0]?s.push({type:"placeholder",value:a[1]}):'"'===a[0]&&'"'===a[a.length-1]?a.length>=2&&s.push({type:"text",value:a.substr(1,a.length-2)}):"\\@"===a?s.push({type:"text",value:"@"}):"@"===a[0]?s.push({type:"text",value:t}):s.push({type:"text",value:a});else s.push({type:"text",value:o});return s.reverse()},t}(),Z=function(){return{pattern:b,formatter:["d-mmm","mmm-yy",O().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",O().shortDatePattern+" h:mm",O().shortDatePattern+" h:mm:ss",O().shortDatePattern+" h:mm:ss.0"]}},Y=function(){function t(t,e){var o=this;0===arguments.length?(o.formatCached="General",o.Rd=new J):o.ad(t,e)}return t.prototype.ad=function(e,o){var n,r,i,a,l,u,c,f,d,g,m,y,C,v,b,w;for(e!==h&&e!==p||j(),n=e,(r=this).formatCached=e,i="",a="",l=!1,u=!1,c=!1,f=[],d=0;d<e.length;d++)'"'===(g=e[d])?(u=!u,a+=g):u?a+=g:"["===g?(l&&j(),a&&(i||(i=""),i+=a),a=""+g,l=!0):"]"===g?(l||j(),a?(m=""+(a+=g),(y=ht(""+a))?"ABSTimeFormatPart"===y.Name?(f.push(new y(t.preProcessPart(m),m)),i+=a):m===s.aBb.eraExcelFormatter?(r.addPart(y,s.aBb.eraInternalFormatter),c=!0):r.addPart(y,m):(i+=C=t.partToNormalStr(m),n=it(e,m,C)),a=""):j(),l=!1):a+=g;a?l?j():i+=a:i||(i=r.o$a()),r.localeIDFormatPart&&(o=r.localeIDFormatPart.cultureInfo().name()),v=function(t,e){var o,n=!1;return ut(t=t?""+t:L.Dc,["general"])?o=J:z.Lc(t)?o=z:ut(t,["E+","E-","#",".",",","%","0","/","?"])||e?(n=!0,o=q):(n=!0,o=X),{Mc:n,Nc:o}}(i,r.conditionalFormatPart),b=v.Nc,w=v.Mc?n:i,b?r.Rd=new b(w,r.localeIDFormatPart,r.dbNumberFormatPart,o,f.length>0?f:h,c):j()},t.prototype.o$a=function(){var e=this,o="";return e.dbNumberFormatPart&&(t.proNames.some((function(t){return"dbNumberFormatPart"!==t&&e[t]}))||(o="General")),o},t.prototype.formatString=function(){var e,o,n,r=this,i="";for(e=0,o=t.proNames.length;e<o;e++)r[n=t.proNames[e]]&&(i+=""+r[n]);return i+r.Rd.formatString()},t.prototype.addPart=function(e,o){var n,r,i,a=t.proNames,s=t.preProcessPart(o);for(n=0,r=a.length;n<r;n++)if(st(i=a[n],e.Name,!0)){if(this[i])throw Error(f().Exp_DuplicatedDescriptor);this[i]=new e(s,o)}},t.prototype.format=function(t,e){return this.Rd.format(t,e)},t.prototype.parse=function(t){return this.Rd.parse(t)},t.checkFormatter=function(t){if(!t||t===L.Dc)throw Error(f().Exp_TokenIllegal)},t.preProcessPart=function(e){t.checkFormatter(e);var o=rt(e);return t.checkFormatter(o),o},t.partToNormalStr=function(e){var o=t.preProcessPart(e);return"$"===o[0]&&(o=o.slice(1)),'"'+o+'"'},t.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],t}(),K=function(t){function e(e,o){var n=t.call(this,e,o)||this,r=n;return r.Sd=!0,r.PropertyChanged=[],L.Ec(e)&&(e="General"),r.formatCached=e,r.cultureName=o,r.init(),n}return Q(e,t),e.prototype.toJSON=function(){var t=this,e={formatCached:t.formatCached};return t.cultureName&&(e.customerCultureName=t.cultureName),"general"===F(t.formatCached)&&delete e.formatCached,e},e.prototype.hasFormatedColor=function(){var t,e;for(t in y)if(y.hasOwnProperty(t)&&((e=this.getFormatter(y[t]))&&e.colorFormatPart))return!0;return!1},e.prototype.formatString=function(t){var e,o,n,r=this;if(0===arguments.length){for(e=L.Dc,o=0,n=r.formatters.length;o<n;o++)e+=r.formatters[o].formatString(),o!==n-1&&(e+=";");return e}if(!t)throw Error(f().Exp_ValueIsNull);return r.formatters=h,r.formatCached=t,r.init(),r.Td("formatString"),r},e.prototype.getFormatter=function(t){return this.formatters&&this.formatters[t]},e.prototype.getPreferredEditingFormatter=function(t){var o,n,r=O(this.cultureName),a=e.defFormatter;return w(t,"TimeSpan")?a(r.longTimePattern):w(t,"DateTime")?(o=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",a(r.shortDatePattern+o)):i.j.Na(t,this.cultureName)?a((n=i.j.Pa(t))>=1e20||n<=1e-17&&n>0||n<=-1e20||n<0&&n>=-1e-17?"0.##E+00":x):a("General")},e.prototype.getPreferredDisplayFormatter=function(t,o){var a,s,l,u,c,f,p,d,g,m,y,C,v,b,T,S,x,A,I,R,M,k,O,F=this,E=e.defFormatter;if(o||(o={value:h}),o.value=h,L.Ec(t))return new e;if(a=t,s=o.value=F.parse(a),w(s,"DateTime")||w(s,"TimeSpan")){for(u=(l=Z()).pattern,c=l.formatter,(d=(p=(f=N(F.cultureName)).DateTimeFormat).preselectedFormatters).length>0&&(u=u.concat([d]),c=c.concat([d[0]])),"ja-JP"===f.name()&&(u=u.concat([p.eraFormatter]),c=c.concat(["ge.M.d"]),g=f._Ab.filter((function(t){return"ggge"===t.substr(0,4)})),u=u.concat([g]),c=c.concat(['ggge"年"M"月"d"日']),m=f._Ab.filter((function(t){return"gge"===t.substr(0,3)})),u=u.concat([m]),c=c.concat(['gge"年"M"月"d"日']),y=f._Ab.filter((function(t){return"ge"===t.substr(0,2)})),u=u.concat([y]),c=c.concat(['ge"年"M"月"d"日'])),C=0;C<u.length;C++)for(v=u[C],b=0;b<v.length;b++)if(T=v[b],(S=r.l.Qa(t,T))&&S-s==0)return new e(c[C])}else if(i.j.Na(s,F.cultureName)){if(A=(x=D(F.cultureName)).currencySymbol,I=x.numberDecimalSeparator,R=x.percentSymbol,M=x.numberGroupSeparator,"E",O=(k=n.u.Bb)(a,I)?".00":"",a[0]===A)return E(L.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",A,O));if(k(a,"E",!0))return E("0.00E+00");if(""+a[0]===R||""+a[a.length-1]===R)return E(L.Kb("0{0}%",O));if(k(a,M))return E(L.Kb("#,##0{0}",O))}return E("General")},e.prototype.format=function(t,e){var o,n,r,a,s,l,u;if(w(t,"boolean"))return P()&&(t=t?P().boolean_true:P().boolean_false),(""+t).toUpperCase();if(r=0,a=(o=this).Ud(t)){s=a.colorFormatPart,e&&s&&(e.conditionalForeColor=e.value=s.foreColor),(n=i.j.Na(t,o.cultureName))&&(r=i.j.Pa(t)),l=L.Dc;try{n&&a===o.getFormatter(y.Va)&&0!==this.expressionNumber?l=a.format(a.considerNegSymbol?r:d(r)):(l=a.value)===p&&(u=!o.Sd&&a===o.getFormatter(y._text),l=a.format(t,u)),e&&(e.content=T(l)?l:[{type:"text",value:l}]),T(l)&&(l=S.Jja(l))}catch(e){w(t,"string")&&(l=""+t)}return l}return n&&r<0?"-":w(t,"string")?""+t:t===p||t===h?L.Dc:""+t},e.prototype.parse=function(t){var e=this;return e.formatters&&e.formatters.length>0?e.formatters[0].parse(t):h},e.prototype.init=function(){var t,e,o,n=this,r=n.formatCached;for(L.Ec(r)&&j(),n.formatters=[],t=r.split(";"),n.Sd=1===t.length,(!t||t.length<1||t.length>4)&&j(),e=0;e<t.length;e++)-1!==t[e].indexOf("@")&&-1===t[e].indexOf("\\@")&&(e!==t.length-1?j():this.hasAt=!0),o=new Y(t[e],n.cultureName),n.formatters.push(o);n.getFormatter(y.Hc)||j(),this._Xc()},e.prototype._Xc=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var t=(0===this.expressionNumber?1:this.expressionNumber)-1;y=i.j.Ia({},C[t]),this.hasAt&&0!==this.expressionNumber&&(y._text=this.formatters.length-1)},e.prototype.Ud=function(t){var e,o,n,r,a,s,l,u,c,f,p=this;if(p._Xc(),o=(e=p.getFormatter(y.Hc))&&e.conditionalFormatPart,n=p.getFormatter(y._text),o&&(y.Ua=2,this.hasAt||(y._text=3)),"string"==typeof t&&k(t))return n||(o?t:e);if(i.j.Na(t,p.cultureName)||w(t,"boolean")){if(r=p.getFormatter(y.Va),a=p.getFormatter(y.Ua),s=i.j.Pa(t),l=o&&e.conditionalFormatPart.isMeetCondition(s),c=(u=r&&r.conditionalFormatPart)&&r.conditionalFormatPart.isMeetCondition(s),f=void 0,p.Sd||(o?l:s>0||0===s&&!a))f=e;else if(u?c:s<0)f=r;else if(a)f=a;else if(r){if(o&&u)return{value:s+""};f=r}return f&&(!o||u||f!==r||a||(f.considerNegSymbol=!0),o&&u&&f===r&&r.conditionalFormatPart&&r.conditionalFormatPart.isMeetCondition(1e-10)&&(f.considerNegSymbol=!0),this.expressionNumber<=1&&(f.considerNegSymbol=!0)),f}return h},e.prototype.Td=function(t){var e,o,n=this;if(n.PropertyChanged)for(e=0;e<n.PropertyChanged.length;e++)"function"==typeof(o=n.PropertyChanged[e])&&o(n,t)},e.defFormatter=function(t){var o=e[t];return o||(o=new e(t),e[t]=o),o},e}(_),e.GeneralFormatter=K},"./src/plugins/slicer/slicer.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f;function h(t){return t&&t.text!==r}function p(t,e){var o,n,u;if(t===i||t===r)return!1;if(w(t)===a)e.value=t;else if(w(t)===l)e.value=t?1:0;else if(t instanceof Date)e.value=c.Ra(t);else{if(w(t)!==s)return!1;if(0===T(t=t.trim()))return!1;if(o=!1,"%"===t.charAt(T(t)-1)&&(o=!0,t=t.substr(0,T(t)-1)),T(t)>=2&&"0"===t[0]&&"x"===t[1])return!1;if(n=(+t).valueOf(),isNaN(n)||!isFinite(n)){if(u=new Date(t),isNaN(u))return!1;n=c.Ra(u)}o&&(n/=100),e.value=n}return!0}function d(t){var e,o,n,r,i,a,s,l,u,c,f,h,p,d=t.Ce;for(d||(t.Ee=[],t.Ie=[]),e=d?t.De:t.Ee,o=t.Fe,n=t.Ge,r=d?t.He:t.Ie,i=t.Je,a=t.Ke,s=t.Le,l=T(t.data),c=0;c<l;c++){for(f=!1,h=void 0,p=0;p<T(i)&&(h=i[p],d&&h===t.Me||(n[h]?(u=t.getExclusiveRowIndex(t.columnNames[h],c),f=!n[h][u]):o[h]&&(f=!o[h][c]),!f));p++);!f&&d&&(a?f=!a[u=t.getExclusiveRowIndex(t.columnNames[h],c)]:s&&(f=!s[c])),f||(e[c]=!0)}for(p=0;p<T(e);p++)e[p]&&r.push(p)}function g(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?c.Ra(t):t}function m(t,e){var o,n,r,i,a,s,l,u=t.Oe,c=t.Pe,f=t.Se,p=t.Qe,d=t.Re,m=t.data,y=d[e]=[];for(t._e=[],u[e]=[],c[e]=[],f[e]={},p[e]=[],o={},n=0;n<T(m);n++)i=h(r=m[n][e])?r.text.trim():r,u[e].push(i),(a=o[g(i)])?(a.list.push(n),y[n]=a.index):(s=[n],c[e].push(i),p[e].push(s),l=T(p[e])-1,f[e][i]=l,y[n]=l,o[g(i)]={list:s,index:l})}function y(t,e,o){var n,r,i,a,s,l,u,c,f,p,d,g,m=t.Te,y=t.getColumnIndex(e),C=[];if(!y)return C;if(n=t.Ce?t.Ue:t.Ve[y],r=t.Ee,!n)return C;for(m[y]||t.We(y),i=[],a=m[y],s=0;s<T(a);s++)u=h(l=t.data[s][y])?l.value:l,i[a[s]]=u;for(c=t.af[y],s=0;s<T(n);s++){for(f=n[s],p=!1,g=(d=t.Xe(i,f)).start;g<=d.end;g++)if(r[c[g]]){p=!0;break}p!==o&&C.push(f)}return C}function C(t,e){var o,n,r,i,a,s,l,u=[],c={},f=t.getColumnIndex(e);if(f>=0)for(o=t.Ke||t.Le,n=t.Ge[f]||t.Fe[f],r=t.Ce&&f===t.Me?o:n,a=T((i=!!t.Fe[f])?t.getData(e):t.getExclusiveData(e)),s=0;s<a;s++)r&&!r[s]&&(c[l=i?t.getExclusiveRowIndex(e,s):s]||(c[l]=!0,u.push(l)));return u}function v(t,e){t.Ce=!1,t.Ke=[],t.He=[],t.De=[],t.Le=[],e&&t.onFiltered()}function b(t){return t===i||t===r}function w(t){return typeof t}function T(t){return t?t.length:0}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/datetimehelper.ts"),r=void 0,i=null,a="number",s="string",l="boolean",u=n.l.Ra,function(t){t[t.all=0]="all",t[t.byCurrentColumn=1]="byCurrentColumn",t[t.byOtherColumns=2]="byOtherColumns"}(e.FilteredOutDataType||(e.FilteredOutDataType={})),function(t){t[t.average=1]="average",t[t.count=2]="count",t[t.counta=3]="counta",t[t.max=4]="max",t[t.min=5]="min",t[t.product=6]="product",t[t.stdev=7]="stdev",t[t.stdevp=8]="stdevp",t[t.sum=9]="sum",t[t.vars=10]="vars",t[t.varp=11]="varp"}(e.SlicerAggregateType||(e.SlicerAggregateType={})),c=function(){function t(){}return t.Ra=function(t){return u(t)},t.quickSort=function(e){var o,n=T(e),r=[];for(o=0;o<n;o++)r[o]={index:o,value:e[o]};return t.quickSortImp(r)},t.quickSortImp=function(e){var o,n,r,i,a,s,l;if(T(e)<=1)return e;for(o=t,n=e[Math.floor(T(e)/2)],r=[],i=[],a=[],s=0;s<T(e);s++)(l=o.sortCompare(e[s].value,n.value))<0?r.push(e[s]):l>0?i.push(e[s]):a.push(e[s]);return o.quickSortImp(r).concat(a,o.quickSortImp(i))},t.isEquals=function(t,e){return!(!b(t)&&""!==t||!b(e)&&""!==e)||(t instanceof Date&&e instanceof Date?t.valueOf()===e.valueOf():w(t)===s&&w(e)===s?t.toLowerCase()===e.toLowerCase():t===e)},t.isGreaterThan=function(e,o){var n=w(e),r=w(o);return n===l?e=e?1:0:e instanceof Date&&(e=t.Ra(e)),r===l?o=o?1:0:o instanceof Date&&(o=t.Ra(o)),n===r||n!==a&&r!==a?n===s&&r===s?e.toLowerCase()>o.toLowerCase():e>o:w(o)===a},t.sortCompare=function(e,o){var n=t,r=b(e)||""===e||w(e)===a&&isNaN(e),i=b(o)||""===o||w(o)===a&&isNaN(o);return r&&i?0:r?1:i?-1:n.isEquals(e,o)?0:n.isGreaterThan(e,o)?1:-1},t}(),e.jf=c,f=function(){function t(t,e){var o,n=this;for(n.Ne={},n.Oe=[],n.Pe=[],n.Se=[],n.Qe=[],n.Re=[],n.Ge=[],n.Ye=[],n.Fe=[],n.Ve=[],n.Ee=[],n.Ie=[],n.Je=[],n.He=[],n.De=[],n.Ce=!1,n.Ze=[],n.$e=0,n._e=[],n.af=[],n.Te=[],n.bf(t,e),o=0;o<T(n.data);o++)n.Ee[o]=!0,n.Ie.push(o)}return t.prototype.inPreview=function(){return this.Ce},t.prototype.bf=function(t,e){var o=this;o.data=t,o.columnNames=e,function(t){var e,o,n=t.Ne={};for(t.Oe=[],t.Pe=[],t.Qe=[],t.Re=[],e=t.columnNames,o=0;o<T(e);o++)n[(e[o]+"").toUpperCase()]=o}(o)},t.prototype.onDataChanged=function(t){var e,o,n,r,i,a,s,l,u,c,f=this,p=Array(T(f.columnNames)),g=f.Ye,y=f.Pe,C=f.Ge,v=f.Oe;for(e=0;e<T(t);e++)n=(o=t[e]).data,r=o.row,i=f.getColumnIndex(o.columnName),f.data[r][i]=n,a=h(n)?n.text:n,v[i]&&(v[i][r]=a),p[i]=!0;for(s=0;s<T(p);s++)if(p[s]){for(l=g[s],g[s]=l?[]:void 0,C[s]=l?[]:void 0,u=[],e=0;l&&e<T(l);e++)u.push(y[s][l[e]]);for(m(f,s),e=0;e<T(u);e++)c=f.Se[s][u[e]],g[s].push(c),C[s][c]=!0}d(f),f.cf("onDataChanged",t)},t.prototype.cf=function(t){var e,o,n,r,i=[];for(e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(o=this.Ze||[],n=0;n<T(o);n++)(r=o[n])[t]&&r[t].apply(r,i)},t.prototype.onColumnNameChanged=function(t,e){var o=this,n=o.Ne,r=o.getColumnIndex(t);r<0||(o.columnNames[r]=e,delete n[t.toUpperCase()],n[e.toUpperCase()]=r,o.cf("onColumnNameChanged",t,e))},t.prototype.onRowsAdded=function(t,e,o){var n,a,s,l,u,f,h,p,d,g,m,y,C,v=this,b=T(v.columnNames),w=v.data,S=v.Oe,x=v.Pe,A=v.Qe,I=v.Re,R=v.Ge,M=v.Ye,k=v.Ee,N=v.Ie,O=v.Je;for(v._e=[],n=0;n<e;n++)w.splice(t,0,Array(b));for(a=0;a<b;a++){for(n=0;n<e;n++)S[a]&&S[a].splice(t,0,r);if(u=void 0,l=x[a]){for(f=i,h=0;h<T(l);h++){for(p=A[a][h],d=0;d<T(p);d++)p[d]>=t&&(p[d]+=e);c.isEquals(l[h],i)&&(f=p,u=h)}for(f||(f=[],l.push(i),u=T(l)-1,v.Se[a][i]=u,A[a].push(f),R[a]&&-1===O.indexOf(a)&&(R[a][u]=!0,M[a].push(u))),g=t;g<t+e;g++)f.push(g);for(s=t;s<t+e;s++)I[a].splice(s,0,u)}}for(m=!0,n=0;n<T(O);n++)y=I[a=O[n]][t],!0!==R[a][y]&&(m=!1);for(n=0;n<T(N);n++)N[n]>=t&&(N[n]+=e);for(s=T(w)-1;s>=t+e;s--)k[s]=k[s-e];for(C=T(O)>0,s=t;s<t+e;s++)m&&N.push(s),k[s]=!C;o||v.cf("onRowsChanged",t,e,!0)},t.prototype.onRowsRemoved=function(t,e){this.df(t,e,!0)},t.prototype.df=function(t,e,o){var n,r,i,a,s,l,u,c,f=this,h=f.Ye,p=f.Pe,g=f.Ge,y=f.data,C=T(f.columnNames),v=f.Oe;for(y.splice(t,e),r=0;r<C;r++){if(v[r]&&v[r].splice(t,e),a=[],(i=h[r])&&o){for(n=0;n<T(i);n++){for(s=f.getRowIndexes(f.columnNames[r],i[n]),l=!0,u=0;u<T(s);u++)if(s[u]<t||s[u]>=t+e){l=!1;break}l||a.push(p[r][i[n]])}h[r]=[],g[r]=[]}if(m(f,r),i&&o)for(n=0;n<T(a);n++)c=f.Se[r][a[n]],h[r].push(c),g[r][c]=!0}o&&d(f),f.cf("onRowsChanged",t,e,!1)},t.prototype.onColumnsRemoved=function(t,e){var o,n,r,i,a,s,l,u,c=this,f=c.data,h=[],p=c.Je,d=t+e;for(o=t;o<d;o++)n=c.columnNames[o],r=o,h.push(n),-1!==p.indexOf(r)&&c.doUnfilter(n);for(i=c.Ge||c.Fe,a=c.Ye||c.Ve,s=c.Ne,o=0;o<T(f);o++)f[o].splice(t,e);for(l in c._e=[],c.columnNames.splice(t,e),c.Oe.splice(t,e),c.Pe.splice(t,e),c.Se.splice(t,e),c.Qe.splice(t,e),c.Re.splice(t,e),i.splice(t,e),a.splice(t,e),s)s[l]>=t+e&&(s[l]-=e);for(o=0;o<T(h);o++)delete s[(n=h[o]).toUpperCase()],t=c.getColumnIndex(n),-1!==(u=p.indexOf(t))&&p.splice(u,1),c.cf("onColumnRemoved",h[o])},t.prototype.ef=function(){return this._e},t.prototype.ff=function(){return this.af},t.prototype.We=function(t){var e,o,n,r,i,a,s,l,u,f,p,d=this,g=d.data;for(d.Oe[t]||m(d,t),e=T(g),o=[],n=0;n<e;n++)i=h(r=g[n][t])?r.value:r,o.push(i);for(a=c.quickSort(o),s=d._e[t]=[],l=d.af[t]=[],u=d.Te[t]=[],f=0;f<T(a);f++)p=a[f],s.push(p.value),l.push(p.index),u[p.index]=f},t.prototype.getColumnIndex=function(t){var e=this.Ne[t.toUpperCase()];return void 0===e?-1:e},t.prototype.getFilteredRowIndexes=function(){var t=this;return t.Ce?t.He:t.Ie},t.prototype.getFilteredOutRowIndexes=function(){var t,e=this,o=T(e.data),n=e.Ce?e.De:e.Ee,r=[];for(t=0;t<o;t++)n[t]||r.push(t);return r},t.prototype.getData=function(t,e){var o,n,r,i,a,s,l,u=this,c=u.Oe,f=u.getColumnIndex(t);if(f>=0){if(e){for(u._e[f]||u.We(f),o=c[f],n=u._e[f],i=(r=u.Xe(n,e)).start,a=r.end,s=[],l=i;l<=a;l++)s.push(o[u.af[f][l]]);return s}return c[f]||m(u,f),c[f]}return[]},t.prototype.aggregateData=function(t,e,o){var n,i,a,s,l,u,c,f,h,p=this,d=p.getColumnIndex(t);return d<0?r:(p._e[d]||p.We(d),s=T(a=p._e[d]),n=(l=p.Xe(a,o)).start,i=l.end,5===e?n>=s?r:a[n]:4===e?i<0?r:a[i]:3===e?i<n?0:i-n+1:(c=(u=p.Qka(a,e,n,i)).data1,f=u.data2,h=u.data3,1===e?c/=f:7===e||10===e?(c=(h*f-c*c)/(h*(h-1)),c=7===e?Math.sqrt(c):c):8!==e&&11!==e||(c=(h*f-c*c)/(h*h),c=8===e?Math.sqrt(c):c),c))},t.prototype.Qka=function(t,e,o,n){var a,s,l,u=6===e?1:0,c=0,f=0;for(a=o;a<=n;a++)(s=t[a])===i&&s===r||p(s,l={value:i})&&(s=l.value,1===e?(u+=s,c++):2===e?u++:9===e?u+=s:6===e?u*=s:7!==e&&8!==e&&10!==e&&11!==e||(u+=s,c+=s*s,f++));return{data1:u,data2:c,data3:f}},t.prototype.Xe=function(t,e){var o,n,i,a,s=T(t);if(e){if(e.min===-1/0)o=0;else for(i=0;i<s;i++)if(a=t[i],c.isEquals(e.min,a)||c.isGreaterThan(a,e.min)){o=i;break}if(o===r&&(o=s),n===1/0)n=s-1;else{for(i=s-1;i>=0;i--)if(a=t[i],c.isEquals(a,e.max)||c.isGreaterThan(e.max,a)){n=i;break}n===r&&(n=-1)}}else o=0,n=s-1;return{start:o,end:n}},t.prototype.getExclusiveData=function(t){var e=this,o=e.Pe,n=e.getColumnIndex(t);return n>=0?(o[n]||m(e,n),o[n]):[]},t.prototype.getRowIndexes=function(t,e){var o=this,n=o.getColumnIndex(t);return n>=0?(o.Re[n]||m(o,n),o.Qe[n][e]):[]},t.prototype.getExclusiveRowIndex=function(t,e){var o=this,n=o.Re,r=o.getColumnIndex(t);return r>=0?(n[r]||m(o,r),n[r][e]):-1},t.prototype.getFilteredIndexes=function(t){var e=[];return this.gf(t,e,{}),e},t.prototype.gf=function(t,e,o){var n,r,i,a=this,s=a.Ce?a.He:a.Ie;for(n=0;n<T(s);n++)r=s[n],b(i=a.getExclusiveRowIndex(t,r))||(o[i]?o[i]++:(o[i]=1,e.push(i)))},t.prototype.getFilteredRanges=function(t){return y(this,t,!1)},t.prototype.getFilteredOutRanges=function(t){return y(this,t,!0)},t.prototype.getFilteredOutIndexes=function(t,e){var o=this;return 0===e?function(t,e){var o,n,r,i,a=[];if(t.getColumnIndex(e)>=0){for(o=T(t.getData(e)),n=t.Ce?t.De:t.Ee,r=0;r<o;r++)n[r]||(i=t.getExclusiveRowIndex(e,r),-1===a.indexOf(i)&&a.push(i));return a}}(o,t):1===e?C(o,t):function(t,e){var o,n,r,i,a,s,l,u,c,f={},h=t.columnNames,p=T(h);for(o=0;o<p;o++)if(h[o]!==e)for(n=C(t,h[o]),r=0;r<T(n);r++)for(i=t.getRowIndexes(h[o],n[r]),a=0;a<T(i);a++)f[i[a]]||(f[i[a]]=!0);for(s={},p=T(t.data),o=0;o<p;o++)l=t.getExclusiveRowIndex(e,o),f[o]||(s[l]=!0);for(u=T(t.getExclusiveData(e)),c=[],o=0;o<u;o++)s[o]||c.push(o);return c}(o,t)},t.prototype.attachListener=function(t){this.Ze.push(t)},t.prototype.detachListener=function(t){var e,o=this.Ze||[];for(e=0;e<T(o);e++)if(o[e]===t){o.splice(e,1);break}},t.prototype.suspendFilteredEvents=function(){this.$e++},t.prototype.resumeFilteredEvents=function(){var t=this;t.$e--,0===t.$e&&t.onFiltered()},t.prototype.doFilter=function(t,e,o){this.hf(t,e,o),this.onFiltered()},t.prototype.hf=function(t,e,o){var n=this,r=n.Je,i=n.getColumnIndex(t);i<0||(o?(n.Ce=!0,n.Me=i):n.Ce&&v(n,!1),r.indexOf(i)<0&&r.push(i),e.ranges?function(t,e,o,n){var r,i,a,s,l,u,c,f,p=t.getColumnIndex(e),g=t.Te;for(g[p]||t.We(p),r=[],i=g[p],a=0;a<T(i);a++)l=h(s=t.data[a][p])?s.value:s,r[i[a]]=l;for(u=[],a=0;a<T(o);a++)for(c=t.Xe(r,o[a]),f=0;f<T(i);f++)i[f]>=c.start&&i[f]<=c.end&&(u[f]=!0);n?(t.Le=u,t.Ue=o):(t.Ve[p]=o,t.Fe[p]=u,delete t.Ge[p],delete t.Ye[p]),d(t)}(n,t,e.ranges,o):function(t,e,o,n){var r,i=t.getColumnIndex(e),a=[];for(r=0;r<T(o);r++)a[o[r]]=!0;n?t.Ke=a:(t.Ge[i]=a,t.Ye[i]=o,delete t.Ve[i],delete t.Fe[i]),d(t)}(n,t,e.exclusiveRowIndexes,o))},t.prototype.clearPreview=function(){v(this,!0)},t.prototype.doUnfilter=function(t){this.if(t),this.onFiltered()},t.prototype.if=function(t){var e,o,n=this;n.Ce&&v(n,!1),(e=n.getColumnIndex(t))<0||(delete n.Ve[e],delete n.Fe[e],delete n.Ge[e],delete n.Ye[e],d(n),(o=n.Je.indexOf(e))>=0&&n.Je.splice(o,1))},t.prototype.onFiltered=function(){var t=this;0===t.$e&&t.cf("onFiltered",{rowIndexes:t.getFilteredRowIndexes(),isPreview:t.Ce})},t.prototype.getListener=function(){return this.Ze},t}(),e.GeneralSlicerData=f},"./src/plugins/sparkline/sparkline.entry.ts":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(t,e,o){"use strict";var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k,N,O,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,Ct,vt=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();function bt(t,e){return{x:t,y:e}}function wt(t,e,o,n){return{x:t,y:e,width:o,height:n}}function Tt(t,e){var o,n,r,i=t[0],a=i&&i.value?i.value:i;for(n=1,r=t.length;n<r;n++)o=(i=t[n])&&i.value?i.value:i,(e&&a>o||!e&&a<o)&&(a=o);return a}function St(t,e,o,n,r,i,a){i&&(t.strokeStyle=i),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(e,o),t.lineTo(n,r),t.stroke()}function xt(t,e,o,n,r,i,a,s){var l,u,c,f,h,p,d;if(t.save(),l=[i,a],t.setLineDash)t.beginPath(),t.strokeStyle=s,t.setLineDash(l),t.stroke(),t.moveTo(e,o),t.lineTo(n,r),t.stroke();else{for(t.beginPath(),t.lineWidth=1,t.strokeStyle=s,c={x:(n-e)/(u=b(v(n-e,2)+v(r-o,2))),y:(r-o)/u},f=0,h=0;f<u;)f+=p=m(l[h%2],u-f),(d=++h%2)&&t.moveTo(e,o),e+=p*c.x,o+=p*c.y,d&&t.lineTo(e,o);t.stroke()}t.restore()}function At(t,e,o,n,r,i,a,s,l,u,c,f){e?St(t,o,n,r,i,c,f):St(t,a,s,l,u,c,f)}function It(t,e,o,n,r,i,a,s){t.save(),a&&(t.fillStyle=a),t.textBaseline=s||z,t.beginPath(),t.font=r,t.textAlign=i,n="string"==typeof n?n:n+"",t.fillText(n,e,o),t.restore()}function Rt(t){return r.pc.dc(l(t))<127.5?F:E}function Mt(t,e,o,n,r,i,s,l){var u,c,f,h,p=l;return a(l)&&(p=r),s?(u=e+p+i,f=n-2*p,c=t+r,h=o-2*r):(u=t+p,f=o-2*p,c=e+r,h=n-2*r),{left:u,top:c,width:f,height:h}}function kt(t,e){var o,n,r=0;for(o=0,n=t.length;o<n;o++)r+=e&&!e(t[o])?0:t[o];return r}function Nt(t){return t*p/180}function Ot(t,e,o,n){var r,i,a,s,l=[];for(i=0,a=0,s=t.length;i<s;i++)e?(e(t[i])?l[a]=o?o(t[i]):t[i]:l[a]=0,a++):(r=I(t[i]),!A(r)&&isFinite(r)&&(l[a]=r,a++));return n&&n(l),l}function Dt(t,e,o,n,r,i){var a=C(e+n),s=C(o+r);e=C(e),o=C(o),n=C(a-e),r=C(s-o),t.beginPath(),t.fillStyle=i,t.fillRect(e,o,n,r),t.fill()}function Ft(t,e,o){return t=m(t,e),y(t,o)}function Et(t,e,o,n,r){t.save(),t.rect(e,o,n,r),t.clip()}function jt(t,e){var o,n,r,i;return!(!t||!e)&&(o=y(t.x+t.width,e.x+e.width),n=y(t.y+t.height,e.y+e.height),r=m(t.x,e.x),i=m(t.y,e.y),o-r<=t.width+e.width&&n-i<=t.height+e.height)}function Pt(t,e){var o,n,i,a,s,u,c=[],f=e.length;if(t<=f)c=e.slice(0,t);else{for(0===f?(c.push("darkgray"),f=1):c=e.slice(0),o=[],n=void 0,i=t-f+1,a=void 0,a=0;a<f;a++)o[a]=l(c[a]);for(a=f;a<t;a++){for(s in n=o[a%f])n.hasOwnProperty(s)&&(u=n[s],n[s]=h(u-u/i*(a/f)));n.a=255,c[a]=r.pc.bc(n)}}return c}function Lt(t,e,o){return{x:t,y:e,value:o}}function Gt(t,e,o,n,r){return((e-r)*o+(r-n)*t)/(e-n)}function Bt(t,e){var o,n,r=e?1:-1,i=e?m:y,a=new ut(bt(r*R,r*R)),s=t.length;for(n=0;n<s;n++)o=t[n],a.x=i(a.x,o.x),a.y=i(a.y,o.y);return a}function _t(t,e,o,n){return o/n*(e-t)+t}function Vt(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,C,w,T;if(a){for(s=b(v(n-e,2)+v(r-o,2)),l=0,6,2,4,c=void 0,f=void 0,h=void 0,p=void 0,e<=n?(c=e,f=n,h=e,p=o):(c=n,f=e,h=n,p=r),g=o-(d=(r-o)/(n-e))*e,(u=[]).push(new ut(bt(h,p))),m=[6,4,2,4];l<s;)for(y=0,C=m.length;y<C;y++)(l+=m[y])<=s&&(p=d*(h=_t(c,f,l,s))+g,u.push(new ut(bt(h,p))));for(w=0,T=u.length;w<T-1;w+=2)St(t,u[w].x,u[w].y,u[w+1].x,u[w+1].y,i)}else St(t,e,o,n,r,i)}function Ht(t){var e,o,n,r=[],i=t.length;if(i>0)if(i<(e=t[0].length)){if(i>=2)for(o=0;o<e;o++)r.push(new ut(bt(t[0][o],t[1][o])))}else if(e>=2)for(n=0;n<i;n++)r.push(new ut(bt(t[n][0],t[n][1])));return r}function zt(t,e,o,n){for(var r,i=[],a=y(100,10*t),s=0,l=[],u=0;i.length<t;)r=h(n[u]*e),u++,(s>a||Ut(r,l))&&(i.push(r),l.push([r-o,r+o])),s++;return i}function Ut(t,e){var o,n,r;for(o=0,n=e.length;o<n;o++)if((r=e[o])[0]<=t&&t<=r[1])return!1;return!0}function Wt(t,e,o,n,r,i){St(t,Xt(e),Xt(o),Xt(n),Xt(r),a(i)?E:i,1)}function qt(t,e,o,n,r){var i,a,s,l,u,c=.4*n;switch(e=Xt(e),o=Xt(o),t.beginPath(),t.moveTo(e,o),i=c/2,a=b(3)*c/2,s=c/b(3),r){case 0:l=[-i,0,i],u=[a,s,a];break;case 2:l=[-i,0,i],u=[-a,-s,-a];break;case 3:l=[a,s,a],u=[-i,0,i];break;case 1:l=[-a,-s,-a],u=[-i,0,i];break;default:l=[],u=[]}l.forEach((function(n,r){t.lineTo(Xt(e+n),Xt(o+u[r]))})),t.lineTo(e,o),t.closePath(),t.fillStyle=F,t.fill()}function Jt(t,e,o,n,r,i,s){var l,u,c,f,h,p,d,g,m,y,C,v,b,T,S=o.value,x=o.colorScheme,R=o.axisVisible,M=o.barHeight,k=o.barWidth,N=!1,O=I(S);if(!A(O)){if(a(d=0===t?M:k))g=.7;else{if(A(d)||d<=0)return;g=Math.min(1,d)}O>1?(O=1,N=!0):O<-1&&(O=-1,N=!0),x=a(x)?"grey":x,R=!!a(R)||R,e.save(),0===t?(m=i-10,y=s*g,O>=0?(N&&(l=new ut(bt(n+5+m-5,r+s/2))),u=new ct(wt(n+5,r+s*(1-g)/2,m*O,y)),c=new ut(bt(n+5,r+1)),f=new ut(bt(n+5,r+s)),h=1):(C=w(m*O),N&&(l=new ut(bt(n+5+5,r+s/2))),u=new ct(wt(n+i-5-C,r+s*(1-g)/2,C,y)),c=new ut(bt(n+i-5,r+1)),f=new ut(bt(n+i-5,r+s)),h=3),p=a(d)?s:s*g):1===t&&(v=s-10,b=i*g,O>=0?(u=new ct(wt(n+(1-g)/2*i,r+s-5-(T=v*O),b,T)),N&&(l=new ut(bt(n+i/2,r+s-5-T+5)),h=0),c=new ut(bt(n+1,r+s-5)),f=new ut(bt(n+i,r+s-5))):(O=w(O),u=new ct(wt(n+(1-g)/2*i,r+5,b,v*O)),N&&(l=new ut(bt(n+i/2,r+5+v-5)),h=2),c=new ut(bt(n+1,r+5)),f=new ut(bt(n+i,r+5))),p=a(d)?i:i*g),e.beginPath(),u&&(Dt(e,u.x,u.y,u.width,u.height,x),Et(e,u.x,u.y,u.width,u.height)),l&&qt(e,l.x,l.y,p,h),e.restore(),R&&c&&Wt(e,c.x,c.y,f.x,f.y),e.restore()}}function Xt(t){return C(t)-.5}function Zt(t,e,o,n,r){e=C(e),o=C(o),e===(n=C(n))&&(e=n-=.5),o===(r=C(r))&&(o=r-=.5),t.moveTo(e,o),t.lineTo(n,r)}function Yt(t,e,o,n,r,i,a,s,l,u,c){t.beginPath(),t.strokeStyle=o,e?Zt(t,n,r,i,a):Zt(t,s,l,u,c),t.stroke()}function Kt(t,e,o,n,r){t.rect(e,o,n,r),t.clip()}function Qt(t,e,o,n,r,i){var s,l,u,c,f,h=i.labelText,p=i.fontSize,d=i.startBox,g=i.endBox,m=i.boxColor,y=i.isInRightOrTopOfBox,C=i.fillStyle;t.save(),t.beginPath(),t.font=p+q,C=a(C)?E:C,i.vertical?(u=V,y?p+g-(d-o)>0&&d-g-o<g?(c=H,C=Rt(m),l=d-g+1,Kt(t,e,d-g,n,g)):(c=z,l=d-g-1):p-(o+r-d)>0&&o+r-d<g?(Kt(t,e,d-g,n,g),c=z,C=Rt(m),l=d-1):(c=H,l=d+1),t.textAlign=u,t.textBaseline=c,t.fillStyle=C,t.fillText(h,e+n/2,l)):(c=U,f=t.measureText(h),y?f.width+g-(e+n-d)>0&&e+n-(d+g)<g?(Kt(t,d,o,g,r),u=_,C=Rt(m),s=d+g-1):(u=B,s=d+g+1):f.width-(d-e)>0&&d-e<g?(Kt(t,d,o,g,r),s=d+1,u=B,C=Rt(m)):(u=_,s=d-1),t.textAlign=u,t.textBaseline=c,t.fillStyle=C,t.fillText(h,s,o+r/2)),t.restore()}function $t(t,e){switch(e){case 2:return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function te(t,e,o){var n,r,i,a,s,u;return t<0&&(t=0),t>1&&(t=1),n=l(e),r=l(o),i=n.a*(1-t)+r.a*t,a=n.r*(1-t)+r.r*t+"",s=n.g*(1-t)+r.g*t+"",u=n.b*(1-t)+r.b*t+"","rgba("+parseInt(a,10)+","+parseInt(s,10)+","+parseInt(u,10)+","+I(i/255+"")+")"}function ee(t,e,o){return t===e&&t===o?1:t<=e?0:t>=o?1:(t-e)/(o-e)}function oe(t,e,o,n,r,i,a){var s,l,u;n?t.forEach((function(t,r){0!==t&&t!==c&&t!==f&&(e[o+r]=n[r]||e[o+r])})):(s=function(t){var e=R,o=-R;return t.forEach((function(t){t!==c&&t!==f&&(e>t&&(e=t),o<t&&(o=t))})),{min:e,max:o}}(t),l=s.min,u=s.max,t.forEach((function(t,n){0!==t&&t!==c&&t!==f&&(e[o+n]=function(t,e,o,n,r,i){var a=(i+r)/2;return r<=n&&n<=a?te(ee(n,r,a),t,e):te(ee(n,a,i),e,o)}(r,i,a,t,l,u))})))}function ne(t){var e,o=t.getFullYear(),n=t.getMonth(),r=t.getDate();for(e=1;e<n+1;e++)r+=$t(o,e);return r}function re(t){var e,o,n=Nt(t.minAngle-90),r=Nt(t.maxAngle-90),i=t.minValueOption.value,a=t.maxValueOption.value,s=t.ranges,l=G,u=(r-n)/(a-i),c=[];return s.length>0&&s.forEach((function(t){e=t.start,o=t.end,c.push({start:u*(e-i)+n,end:u*(o-i)+n,color:t.color})})),c.unshift({start:n,end:r,color:l}),{paintRanges:c,fillColor:l,targetValueRadian:u*(t.targetValueOption.value-i)+n,currentValueRadian:u*(t.currentValueOption.value-i)+n,minValueRadian:n,maxValueRadian:r}}function ie(t,e,o,n,r,i,a){var s,l,u,c,p,d,g=i.zoomFactor,C=t.currentValueOption.normalFontHeight*g,v=t.minValueOption.normalFontHeight*g,b=t.maxValueOption.normalFontHeight*g,T=t.minAngle,S=t.maxAngle,x=t.currentValueOption.normalFontWidth*g,A=w(T)>90||w(S)>90,I=w(T)>120||w(S)>120,R=st*m(n,r);return a?(s=h(n/2*at),l=h(r*at),u=m(s,A?l/2:l),p=(r-(A?2*u:u))/2,d=.03*u,c={x:e+n/2,y:o+r/2+(A?0:u/2),outerRadius:u,innerRadius:u*t.radiusRatio,currentValuePoint:f,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:v<p,enoughShowMaxLabel:b<p,moreThanSemiCircle:A},A?I?2*C/3<p-d-y(b,v)&&x<n-2*R&&(c.currentValuePoint={x:c.x,y:c.y+u+d+C/2+y(b,v)},c.enoughShowCurrentLabel=!0):2*C/3<r/2-d&&x<n-2*R&&(c.currentValuePoint={x:c.x,y:c.y+2*d+C},c.enoughShowCurrentLabel=!0):C<p-d&&x<n-2*R&&(c.currentValuePoint={x:c.x,y:c.y+C},c.enoughShowCurrentLabel=!0)):(s=h(n/2*it),l=h(r*it),u=m(s,A?l/2:l),c={x:e+n/2,y:o+r/2+(A?0:u/2),outerRadius:u,innerRadius:u*t.radiusRatio}),c}function ae(t,e,o,n){return{x:t+g(o)*n,y:e+d(o)*n}}function se(t,e){return w(e.x-t.x)<.01?{x:e.x,y:e.y,textAlign:V}:e.x>t.x?{x:e.x+$,y:e.y,textAlign:B}:e.x<t.x?{x:e.x-$,y:e.y,textAlign:_}:{x:e.x,y:e.y,textAlign:B}}function le(t,e,o,n,r,i,s){var l,u,c,f,m,C,v,b,T,S,x,A,I,R,M,k,N,O,D,j,P,G,H,z,U,q,Y,$,tt,et,nt,rt,it,at=s.zoomFactor,st=!!a(e.showLabel)||e.showLabel,ut=ie(e,o,n,r,i,s,st);if(!(ut.outerRadius<=0))return l={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},u=ut.innerRadius,c=ut.outerRadius,f=ut.currentValuePoint,m=ut.moreThanSemiCircle,C={x:ut.x,y:ut.y},b=(v=re(e)).paintRanges,T=v.fillColor,t.save(),b.forEach((function(e){t.beginPath(),t.strokeStyle=F,t.moveTo(C.x,C.y),t.fillStyle=e.color||T,t.arc(C.x,C.y,c,e.start,e.end,!1),t.lineTo(C.x,C.y),t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.fillStyle=F,t.strokeStyle=F,t.moveTo(C.x,C.y),t.arc(C.x,C.y,u,e.start-lt,e.end+lt,!1),t.lineTo(C.x,C.y),t.closePath(),t.fill(),t.stroke()})),t.beginPath(),t.moveTo(C.x,C.y),t.fillStyle=E,t.arc(C.x,C.y,c*J,0,2*p,!1),t.fill(),S=ae(C.x,C.y,v.targetValueRadian,u),x=ae(C.x,C.y,v.targetValueRadian,c*Z),xt(t,S.x,S.y,x.x,x.y,K,Q,L),A=ae(C.x,C.y,v.currentValueRadian,c*Z),St(t,C.x,C.y,A.x,A.y,E,X*c),st&&(t.save(),t.beginPath(),t.textAlign=W,t.fillStyle=L,I=e.minValueOption.normalFontHeight*at,R=e.maxValueOption.normalFontHeight*at,M=e.minValueOption.normalFontWidth*at,k=e.maxValueOption.normalFontWidth*at,N=v.minValueRadian,O=v.maxValueRadian,D=e.currentValueOption.normalFontHeight*at,j=e.currentValueOption.normalFontWidth*at,P=void 0,void 0,void 0,ut.enoughShowCurrentLabel&&(It(t,f.x,f.y,e.currentValueOption.label,e.currentValueOption.fontAfterZoom,V),l.showCurrentLabel=!0,P={x:f.x-j/2,y:f.y-D,width:j,height:D}),ut.enoughShowMinLabel&&w(g(N)*c)+M<r/2-ot&&(G=ae(C.x,C.y,v.minValueRadian,c),jt({x:(H=se(C,G)).x-M,y:H.y,width:M,height:I},P)||(It(t,H.x,H.y+h(I),e.minValueOption.label,e.minValueOption.fontAfterZoom,_),l.showMinLabel=!0)),ut.enoughShowMaxLabel&&w(g(O)*c)+k<r/2-ot&&(z=ae(C.x,C.y,v.maxValueRadian,c),jt({x:(U=se(C,z)).x,y:U.y,width:k,height:R},P)||(It(t,U.x,U.y+h(R),e.maxValueOption.label,e.maxValueOption.fontAfterZoom,B),l.showMaxLabel=!0)),ut.enoughShowTargetLabel&&(q=e.targetValueOption.normalFontWidth*at,Y=e.targetValueOption.normalFontHeight*at,$=e.targetValueOption.label,tt=c+3*Y/2,x=ae(C.x,C.y,v.targetValueRadian,tt),et=se(C,x),nt=v.targetValueRadian,rt=m?(i-2*tt)/2+tt:i-(i-c)/2,w(g(nt)*tt)+q<r/2-ot&&w(d(nt)*tt)+Y/2+ot/2<rt&&(it=y(I,R)/2,It(t,et.x,et.y-(nt>p?it:-it),$,e.targetValueOption.fontAfterZoom,et.textAlign),l.showTargetLabel=!0)),t.restore()),t.restore(),l}function ue(t,e,o,n,r,i){var a=i.zoomFactor,s=t.showLabel,l=t.minValueOption.normalFontHeight*a,u=t.maxValueOption.normalFontHeight*a,c=t.targetValueOption.normalFontHeight*a,p=t.currentValueOption.normalFontHeight*a,d=t.minValueOption.normalFontWidth*a,g=t.maxValueOption.normalFontWidth*a,m=t.targetValueOption.normalFontWidth*a,C=t.currentValueOption.normalFontWidth*a,v=.05*n,b=h(r*nt),w=h(n*rt),T={x:e+n*(1-rt)/2,y:o+r*(nt+(1-nt)/2),graphWidth:w,graphHeight:b,targetValuePoint:f,currentValuePoint:f,minValuePoint:f,maxValuePoint:f};return s&&(l<(r-b)/2&&d<(n-w)/2-v&&(T.minValuePoint={x:T.x-d,y:T.y+l/3},T.enoughShowMinLabel=!0),u<(r-b)/2&&g<(n-w)/2-v&&(T.maxValuePoint={x:T.x-g,y:T.y-b+u/3},T.enoughShowMaxLabel=!0),(c<(r-b)/2||c/2<b)&&m<(n-w)/2-v-y(d,g)&&(T.targetValuePoint={x:T.x-m-y(d,g),y:f},T.enoughShowTargetLabel=!0),(p<(r-b)/2||p/2<b)&&C<(n-w)/2-v&&(T.currentValuePoint={x:T.x+w+v,y:f},T.enoughShowCurrentLabel=!0)),T}function ce(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,C,v=a.zoomFactor,b=e.showLabel,w=e.minValueOption,T=e.maxValueOption,S=e.currentValueOption,x=e.targetValueOption,A=ue(e,o,n,r,i,a),I=A.graphWidth,R=A.graphHeight;if(!(I<=0||R<=0))return s={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},l=A.currentValuePoint,u=A.targetValuePoint,c=A.minValuePoint,f=A.maxValuePoint,h={x:A.x,y:A.y},p=function(t,e){var o,n,r=t.minValueOption.value,i=t.maxValueOption.value,a=t.ranges,s=G,l=e.graphHeight/(i-r),u=[];return a.length>0&&a.forEach((function(t){o=t.start,n=t.end,u.push({start:e.y-l*(o-r),height:l*(n-o),color:t.color})})),u.unshift({start:e.y,height:e.graphHeight,color:s}),{paintRanges:u,fillColor:s,targetValueY:e.y-l*(t.targetValueOption.value-r),currentValueY:e.y-l*(t.currentValueOption.value-r)}}(e,A),d=p.paintRanges,g=S.normalFontHeight*v,m=x.normalFontHeight*v,y=p.targetValueY,C=p.currentValueY,t.save(),d.forEach((function(e){Dt(t,h.x,e.start,I,-e.height,e.color)})),xt(t,h.x-(Z-1)*I,y,h.x+I,y,K,Q,L),St(t,h.x,C,h.x+I*Z,C,E,Y*R),b&&(t.save(),t.beginPath(),A.enoughShowMinLabel&&(It(t,c.x,c.y,w.label,w.fontAfterZoom,B,L),s.showMinLabel=!0),A.enoughShowMaxLabel&&(It(t,f.x,f.y,T.label,T.fontAfterZoom,B,L),s.showMaxLabel=!0),A.enoughShowTargetLabel&&!(y-n+m/2>i||y-n-et<0)&&(It(t,u.x,p.targetValueY+x.normalFontHeight*v/3,x.label,x.fontAfterZoom,B,L),s.showTargetLabel=!0),A.enoughShowCurrentLabel&&!(C-n+g/2>i||C-n-et<0)&&(It(t,l.x,p.currentValueY+S.normalFontHeight*v/3,S.label,S.fontAfterZoom,B,L),s.showCurrentLabel=!0),t.restore()),t.restore(),s}function fe(t,e,o,n,r,i){var a=i.zoomFactor,s=t.showLabel,l=t.minValueOption.normalFontHeight*a,u=t.maxValueOption.normalFontHeight*a,c=t.targetValueOption.normalFontHeight*a,p=t.currentValueOption.normalFontHeight*a,d=t.minValueOption.normalFontWidth*a,g=t.maxValueOption.normalFontWidth*a,C=t.currentValueOption.normalFontWidth*a,v=t.targetValueOption.normalFontWidth*a,b=.1*m(n,r),w=h(r*rt),T=h(n*nt),S={x:e+n*(1-nt)/2,y:o+r*(1-rt)/2,graphWidth:T,graphHeight:w,targetValuePoint:f,currentValuePoint:f,minValuePoint:f,maxValuePoint:f};return s&&((C<3*(n-T)/4||C<T)&&p<(r-w)/2-ot&&(S.currentValuePoint={x:f,y:S.y-p/2},S.enoughShowCurrentLabel=!0),(v<3*(n-T)/4||v<T)&&c<(r-w)/2-y(l,u)&&(S.targetValuePoint={x:f,y:S.y+w+y(l,u)+c/4*3},S.enoughShowTargetLabel=!0),d<3*(n-T)/4&&l<(r-w)/2-b&&(S.minValuePoint={x:S.x-d/2,y:S.y+w+l},S.enoughShowMinLabel=!0),g<3*(n-T)/4&&u<(r-w)/2-b&&(S.maxValuePoint={x:S.x+T-g/2,y:S.y+w+u},S.enoughShowMaxLabel=!0)),S}function he(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,C,v=a.zoomFactor,b=e.showLabel,w=e.minValueOption,T=e.maxValueOption,S=e.currentValueOption,x=e.targetValueOption,A=fe(e,o,n,r,i,a),I=A.graphWidth,R=A.graphHeight;if(!(I<=0||R<=0))return s={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},l=A.currentValuePoint,u=A.targetValuePoint,c=A.minValuePoint,f=A.maxValuePoint,h={x:A.x,y:A.y},p=function(t,e){var o,n,r=t.minValueOption.value,i=t.maxValueOption.value,a=t.ranges,s=G,l=e.graphWidth/(i-r),u=[];return a.length>0&&a.forEach((function(t){o=t.start,n=t.end,u.push({start:e.x+l*(o-r),width:l*(n-o),color:t.color||s})})),u.unshift({start:e.x,width:e.graphWidth,color:s}),{paintRanges:u,fillColor:s,targetValueX:e.x+l*(t.targetValueOption.value-r),currentValueX:e.x+l*(t.currentValueOption.value-r)}}(e,A),d=p.paintRanges,g=S.normalFontWidth*v,m=x.normalFontWidth*v,y=p.targetValueX,C=p.currentValueX,t.save(),d.forEach((function(e){Dt(t,e.start,h.y,e.width,R,e.color)})),xt(t,y,h.y,y,h.y+R*Z,K,Q,L),function(t,e,o,n,r,i,a){t.save(),i&&(t.strokeStyle=i),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(e,o),t.lineTo(n,r),t.closePath(),t.stroke(),t.restore()}(t,C,h.y+R-1,C,h.y-R*(Z-1)-1,E,I*Y),b&&(t.save(),A.enoughShowMinLabel&&(It(t,c.x,c.y,w.label,w.fontAfterZoom,B,L),s.showMinLabel=!0),A.enoughShowMaxLabel&&(It(t,f.x,f.y,T.label,T.fontAfterZoom,B,L),s.showMaxLabel=!0),A.enoughShowTargetLabel&&!(y-o+m/2+tt>r||y-o-m/2-tt<0)&&(It(t,y-x.normalFontWidth*v/2,u.y,x.label,x.fontAfterZoom,B,L),s.showTargetLabel=!0),A.enoughShowCurrentLabel&&!(C-o+g/2+tt>r||C-o-g/2-tt<0)&&(It(t,C-S.normalFontWidth*v/2,l.y,S.label,S.fontAfterZoom,B,L),s.showCurrentLabel=!0),t.restore()),t.restore(),s}function pe(t,e,o,n,r){var i,a,s=!1;return t.save(),t.font=r,i=e.length,a=(o-6)/i,e.forEach((function(e,o){t.measureText(e.axis).width>a&&(s=!0)})),t.restore(),s}function de(t){return t.fontStyle+" "+t.fontWeight+" "+t.fontSize+" "+t.fontFamily}Object.defineProperty(e,"__esModule",{value:!0}),n=o("./src/common/util/types.ts"),r=o("./src/common/util/colorhelper.ts"),i=o("./src/common/util/arrayhelper.ts"),a=n.j.Fa,s=r.pc.nc,l=r.pc.ec,u=i.k.Cb,e.Vd={},c=null,f=void 0,h=Math.floor,p=Math.PI,d=Math.sin,g=Math.cos,m=Math.min,y=Math.max,C=Math.round,v=Math.pow,b=Math.sqrt,w=Math.abs,T=Math.ceil,S="undefined",x="string",A=isNaN,I=parseFloat,R=Number.MAX_VALUE,M=new Date(""),k="#969696",N="#CB0000",O="#646464",D="#DCDCDC",F="white",E="black",j="blue",P="green",L="grey",G="lightgrey",B="left",_="right",V="center",H="top",z="bottom",U="middle",W="start",q="px Arial",J=.05,X=.03,Z=1.06,Y=.02,K=4,Q=5,$=5,tt=3,et=10,ot=8,nt=.8,rt=.25,it=.9,at=.7,st=.1,lt=1/45*p,ut=function(t){this.x=t.x,this.y=t.y},ct=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},ft=function(t){function e(e){var o=t.call(this,bt(e.x,e.y))||this;return o.value=e.value,o}return vt(e,t),e}(ut),ht="7ns",pt="5ns",dt="tukey",gt="bowley",mt="sigma3",e.fNc=le,e.gNc=ce,e.hNc=he,yt=function(t,e,o,n){this.X=t,this.Y=e,this.Width=o,this.Height=n,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height},Ct=function(){function t(){this.Wd=2,this.Xd=M,this.Yd=M,this.Zd=R,this.$d=-R}return t.prototype.paint=function(t,e,o,n,r,i){var a,s,l,u=this;u.options=e,u.setting=e.settings,a=e.values,s=e.dateValues,l=e.zoomFactor,t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),0===e.sparklineType&&u._d(t,o,n,r,i,a,s,l),u.ae(t,o,n,r,i,a,s,l),u.be(t,o,n,r,i,a,s,l),t.restore()},t.prototype.ce=function(t){return 0===this.options.sparklineType?3+this.de(t)+1:3},t.prototype.ee=function(t,o){var n,r,a,s,l,h,p,d,g,y=this.fe;if(y)return y;if(y=this.fe=[],n=t.length,this.options.displayDateAxis){for(s=o.length,h=[],(l=m(n,s))>0&&(h=o.slice(0,l)),h.sort((function(t,o){return t===o?0:(t===e.Vd&&(t=0),o===e.Vd&&(o=0),t-o)})),p=h.length,d=void 0,g=void 0,r=0;r<p;r++)if(typeof(d=h[r])!==S&&d!==c){for(g=u(o,d);i.k.Bb(y,g);)g=u(o,d,g+1);isNaN(d)||((a=t[g])!==f&&a!==c&&isNaN(a)&&a!==e.Vd||y.push(g))}}else for(r=0;r<n;r++)typeof(a=t[r])!==S&&a!==c&&isNaN(a)&&a!==e.Vd||y.push(r);return y},t.prototype.ge=function(t,o){var n=o[t];return typeof n===S||n===c?1===this.setting.options.displayEmptyCellsAs&&(n=0):n===e.Vd&&(n=0),n},t.prototype._d=function(t,e,o,n,r,i,a,s){var l,u,f,h,p,d,g,m,y,C,v,b,w,T,x,A=this,I=A.ee(i,a),R=I.length-1;for(R<0&&(R=0),h=A.setting.options,p=A.linePos=[],v=h.displayEmptyCellsAs,l=0;l<R;l++)if(typeof(d=A.ge(I[l],i))!==S&&d!==c){if(m=l+1,typeof(g=A.ge(I[m],i))===S||g===c)if(1===v)g=0;else if(2===v)for(m=l+2;m<=R;m++)if(typeof(b=i[I[m]])!==S&&b!==c){g=b;break}typeof g!==S&&g!==c?(y=A.he(I[l],{Width:n,Height:r},i,a,s),C=A.he(I[m],{Width:n,Height:r},i,a,s),w=y.Width/2,u={X:y.X+w,Y:y.Y+w},f={X:C.X+w,Y:C.Y+w},p[l]={P1:u,P2:f}):l++}if((T=p.length)>0)for(t.strokeStyle=A.options.getColor(h.seriesColor),t.lineCap="round",t.lineWidth=A.de(s),l=0;l<T;l++)(x=p[l])&&(t.beginPath(),u=x.P1,f=x.P2,t.moveTo(e+u.X,o+u.Y),t.lineTo(e+f.X,o+f.Y),t.stroke(),t.closePath())},t.prototype.ie=function(t,e,o){var n,r=this,i=r.options,a=r.setting.options,s=c,l=r.ge(t,e),h=r.ee(e,o),p=h.length,d=i.getColor.bind(r);return typeof l!==S&&l!==c&&(r.Zd!==R&&r.$d!==-R||r.je(e),l===r.Zd&&a.showLow&&(s=d(a.lowMarkerColor)),l!==r.$d||!a.showHigh||typeof s!==S&&s!==c||(s=d(a.highMarkerColor)),typeof s!==S&&s!==c||(i.displayDateAxis?0===u(h,t)&&a.showFirst&&(s=d(a.firstMarkerColor)):0===t&&a.showFirst&&(s=d(a.firstMarkerColor))),typeof s!==S&&s!==c||(i.displayDateAxis?u(h,t)===p-1&&a.showLast&&(s=d(a.lastMarkerColor)):t===p-1&&a.showLast&&(s=d(a.lastMarkerColor))),l<0&&a.showNegative&&(typeof s===S||s===c)&&(s=d(a.negativeColor)),typeof s!==S&&s!==c||(0===(n=i.sparklineType)?a.showMarkers&&(s=d(a.markersColor)):(1===n||2===n)&&(s=d(a.seriesColor)))),s===f||s===c?"Transparent":s},t.prototype.ae=function(t,e,o,n,r,i,a,s){var l,u,c,f,d,g,m,y,C,v,b=this,w={Width:n,Height:r},T=b.ee(i,a),S=T.length,x=b.options.sparklineType;for(v=0;v<S;v++)l=T[v],u=b.ie(l,i,a),c=b.he(l,w,i,a,s),t.fillStyle!==u&&(t.fillStyle=u),0===x?(t.save(),f=e+c.X+c.Width/2,d=o+c.Y+c.Height/2,t.translate(f,d),t.rotate(45*p/180),t.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),t.restore()):(g=e+c.X+c.Width/4,g=h(g),m=o+c.Y,y=c.Width/2,C=c.Height,t.fillRect(g,m,y,C))},t.prototype.be=function(t,e,o,n,r,i,a,s){var l,u,c,f,p,d,g,m=this,y=m.setting&&m.setting.options;y&&y.displayXAxis&&m.ke(i,a)&&(l={Width:n,Height:r},u=m.ce(s),c=l.Width-m.ce(s),p=f=h(m.le(l,i,s))+.5,d=m.options.getColor(y.axisColor),(g=s)<1&&(g=1),t.strokeStyle!==d&&(t.strokeStyle=d),t.lineWidth!==g&&(t.lineWidth=g),t.beginPath(),t.moveTo(e+u,o+f),t.lineTo(e+c,o+p),t.stroke())},t.prototype.me=function(t){var e,o=this.ne(t);return o===-R||(e=this.oe(t))===R||o===e||o*e<=0},t.prototype.ke=function(t,e){var o,n,r,i,a=this.me(t);if(2!==this.options.sparklineType)return a;if(n=(o=this.ee(t,e)).length,!a&&n>0)for(i=0;i<n;i++)if(typeof(r=t[o[i]])!==S&&r!==c)return!0;return a},t.prototype.pe=function(t,e){var o=this.Xd;return isNaN(o&&o.valueOf())&&this.qe(t,e),this.Xd},t.prototype.re=function(t,e){var o=this.Yd;return isNaN(o&&o.valueOf())&&this.qe(t,e),this.Yd},t.prototype.qe=function(t,e){var o,n,r,i,a=this,s=new Date(0,0,0),l=R,u=a.ee(t,e),f=u.length;for(i=0;i<f;i++)n=e[o=u[i]],isNaN(n)||((r=a.ge(o,t))!==c&&typeof r===S||isNaN(r)||typeof n!==S&&n!==c&&(n>s&&(s=n),n<l&&(l=n)));a.Yd=s,a.Xd=l},t.prototype.se=function(t,e,o,n){var r,i,a,s,l,u,c=this,f=c.pe(e,o),h=c.re(e,o),p=[],d=c.ee(e,o),g=d.length;for(r=0;r<g;r++)(i=o[d[r]])&&!isNaN(i)&&p.push(i);if(p.sort((function(t,e){return t-e})),(a=p.length)>1&&f!==h){for(s=R,l=0,void 0,r=1;r<a;r++)(i=p[r]-p[r-1])<s&&i>0&&(s=i),l+=i;return(u=(t.Width-c.ce(n)-c.ce(n))*s/l/2)<2&&(u=2),u}return(t.Width-c.ce(n)-c.ce(n))/2},t.prototype.te=function(t,e,o,n){var r,i=this;return i.options.displayDateAxis?i.se(t,e,o,n):(r=i.ee(e,o).length,(t.Width-i.ce(n)-i.ce(n))/r)},t.prototype.ue=function(t,e,o,n,r){var i,a,s,l,c,f,p,d=this,g=d.ce(r);return d.options.displayDateAxis?(i=d.te(t,o,n,r),(a=d.re(o,n))===(s=d.pe(o,n))?g+i/2:(l=n[e])?(c=t.Width-g-d.ce(r),c-=i,f=a.valueOf()-s.valueOf(),g+h((l.valueOf()-s.valueOf())/f*c)):0):(i=d.te(t,o,n,r),p=u(d.ee(o,n),e),h(g+i*p))},t.prototype.ve=function(t,e){var o,n=this,r=t.Width-n.ce(e)-n.ce(e);return r=y(r,0),o=t.Height-n.ce(e)-n.ce(e),{Width:r,Height:o=y(o,0)}},t.prototype.je=function(t){var e,o,n=this,r=t.length;for(o=0;o<r;o++)typeof(e=t[o])!==S&&e!==c&&("number"!=typeof e&&(e=0),e<n.Zd&&(n.Zd=e),e>n.$d&&(n.$d=e))},t.prototype.ne=function(t){var e,o,n=this;return n.$d!==-R&&n.$d||n.je(t),0===(o=(e=n.setting.options).maxAxisType)?n.$d:1===o?e.groupMaxValue:2===o?e.manualMax:n.$d},t.prototype.oe=function(t){var e,o,n=this;return n.Zd!==R&&n.Zd||n.je(t),0===(o=(e=n.setting.options).minAxisType)?n.Zd:1===o?e.groupMinValue:2===o?e.manualMin:void 0},t.prototype.we=function(t,e,o,n){var r,i=this.ve(t,n),a=this.ne(o),s=this.oe(o),l=a-s;if(a===s){if(0===a)return 0;l=w(a)}return(r=o[e])||(r=0),r*(i.Height/l)},t.prototype.xe=function(t,e,o,n){var r,i,a,s=this,l=s.options.sparklineType;if(0===l)return s.we(t,e,o,n);if(1===l){if(r=o[e],1===s.setting.options.displayEmptyCellsAs&&(typeof r===S||r===c))return 0;if((i=s.we(t,e,o,n))>-s.Wd&&i<s.Wd){if(r>0)return i+s.Wd;if(r<0)return i-s.Wd}return i}return 2===l?typeof(r=o[e])===S||r===c||0===r||isNaN(r)?0:(a=s.ve(t,n),r>=0?a.Height/2:-a.Height/2):void 0},t.prototype.ye=function(t,e,o){var n,r,i=this,a=i.ve(t,o),s=i.ne(e),l=i.oe(e);if(s===-R||l===R)return t.Height/2;if(n=s-l,s===l){if(0===s)return t.Height/2;n=s,s<0&&(s=0)}return r=a.Height/n,i.ce(o)+s*r},t.prototype.le=function(t,e,o){return 2===this.options.sparklineType?t.Height/2:this.ye(t,e,o)},t.prototype.ze=function(t,e,o,n){var r,i,a=this,s=a.ve(t,n),l=a.ne(o),u=a.oe(o),f=l-u;if(l===u){if(0===l)return 0;f=l}return r=s.Height/f,typeof(i=a.ge(e,o))!==S&&i!==c||(i=0),l!==u&&l*u>0?(0,i>=0?(i-u)*r:(i-l)*r):i*r},t.prototype.Ae=function(t,e,o,n){var r,i,a,s=this,l=s.options.sparklineType;return 0===l?s.ze(t,e,o,n):1===l?(r=s.ze(t,e,o,n))>-(i=s.Wd)&&r<i&&(typeof(a=s.ge(e,o))!==S&&a!==c||(a=0),0!==a)?a>0?r+i:r-i:r:2===l?s.xe(t,e,o,n):void 0},t.prototype.Be=function(t,e,o,n,r){var i,a,s,l,u,c,f,p,d,g=this,m=g.te(e,o,n,r),C=g.ue(e,t,o,n,r);return m<0&&(m=0),(m=h(m))%2==1&&(m+=1),i=g.xe(e,t,o,r),a=g.le(e,o,r),s=g.ne(o),l=g.oe(o),u=0,s<0&&l<0?u=y(g.ce(r),a):(u=a,i>=0&&(u=a-i)),c=g.Ae(e,t,o,r),f=new yt(C,u,m,w(c)),0!==i&&(p=g.ce(r),f.Y<p&&f.Bottom<p+1?f.Height=h(f.Height+1):(d=e.Height-g.ce(r),f.Bottom>d&&f.Y>d-1&&(f.Y=d-c,f.Height=c))),f},t.prototype.de=function(t){var e=this.setting.options.lineWeight*t;return e<1&&(e=1),e},t.prototype.he=function(t,e,o,n,r){var i,a,s,l,u=this,f=u.de(r);return++f<2&&(f=2),i=u.Be(t,e,o,n,r),0===u.options.sparklineType&&(i.X=i.X+(i.Width-f)/2,typeof(a=u.ge(t,o))!==S&&a!==c?(a>=0?i.Y-=f/2:i.Y=i.Bottom-f/2,i.Width=f,i.Height=f):(i.Width=0,i.Height=0)),u.setting.options.rightToLeft&&(s=i.X,l=e.Width-s-i.Width,i=new yt(l,i.Y,i.Width,i.Height)),i},t}(),e.SparklineRender=Ct,e.SparklineExRenders={PIESPARKLINE:function(t,e,o,n,r,i){var s,l,u,c,f,h,y=o+r/2,C=n+i/2,v=m(r,i)/2-5,b=-.5*p,T=y+v*g(b),S=C+v*d(b),x=[],I=[];if(!(v<=0)){for(l=Ot(e.values,(function(t){return!a(t)&&!A(t)&&isFinite(t)}),(function(t){return w(t)}),(function(t){1===t.length&&(t[1]=1-t[0])})),c=Pt(u=l.length,e.colors),f=kt(l),t.save(),h=0;h<u;h++)s=b+l[h]/f*2*p,t.beginPath(),t.moveTo(y,C),t.lineTo(T,S),t.arc(y,C,v,b,s,!1),t.lineTo(y,C),t.fillStyle=c[h],t.fill(),x.push(T),I.push(S),T=y+v*g(b=s),S=C+v*d(b);for(h=0;h<u;h++)St(t,y,C,x[h],I[h],F);t.restore()}},AREASPARKLINE:function(t,e,o,n,r,i){var s,l,u,f,h,p,d,g,v,b,w,T,x,I,R,M,k,O,D,F,E,P,L,G,B,_,V,H,z,U,W;for(t.save(),s=e.points,l=e.mini,u=e.maxi,f=e.line1,h=e.line2,p=e.colorPositive,d=e.colorNegative,5,s=Ot(s,(function(t){return!a(t)&&!A(t)&&isFinite(t)})),p=a(p)?"#787878":p,d=a(d)?N:d,O=Tt(s,!1),u=a(u)?O:u,v=y(u,O),D=Tt(s,!0),l=a(l)?D:l,g=m(l,D),b=(b=(b=0)>(v=v<0?0:v)?v:b)<(g=g>0?0:g)?g-1:b,w=s.length,F=Mt(o,n,r,i,5),T=F.left,x=F.top,I=F.width,R=F.height,M=I/(w-1),E=[],_=x+(v-b)/(k=(v-g)/R),z=0;z<w;z++)P=s[z],V=T+M*z,H=x+(v-P)/k,0===z&&E.push(new ft(Lt(V,_,b))),z>0&&P*s[z-1]<0&&((G=E[E.length-1])&&(B=Gt(G.x,G.y,V,H,_),E.push(new ft(Lt(B,_,b))))),E.push(new ft(Lt(V,H,P))),z===w-1&&E.push(new ft(Lt(V,_,b)));for(t.beginPath(),U=0,W=E.length;U<W;U++)(L=E[U])&&(0===U?t.moveTo(L.x,L.y):t.lineTo(L.x,L.y),G=E[U-1],L.value===b&&G&&(t.fillStyle=G.value>b?p:d,t.fill(),U!==W-1&&(t.beginPath(),t.moveTo(L.x,L.y))));function q(e){var o,n;e===c&&typeof e!==S||(o=Ft(e,v,g),n=C(x+(0!==k?(v-o)/k:R/2))-.5,St(t,T,n,T+I,n,j))}q(f),q(h),t.restore()},SCATTERSPARKLINE:function(t,e,o,n,r,i){var s,l,u,c,f,h,d,g,v,b,w,T,S,x,A,I,M,O,F,E,j,P,L,G,B,_,V=e.points1,H=e.points2,z=e.minX,U=e.maxX,W=e.minY,q=e.maxY,J=e.hLine,X=e.vLine,Z=e.xMinZone,Y=e.xMaxZone,K=e.yMinZone,Q=e.yMaxZone,$=e.tags,tt=e.drawSymbol,et=e.drawLines,ot=e.color1,nt=e.color2,rt=e.dash,it=Mt(o,n,r,i,5),at=it.left,st=it.top,lt=it.width,ut=it.height;function ct(e,o,n,r){g=e[o],b=g.x,w=g.y,g=e[o+1],T=g.x,S=g.y,x=at+(b-f)*lt/(h-f),I=at+(T-f)*lt/(h-f),A=st+(c-w)*ut/(c-u),M=st+(c-S)*ut/(c-u),et&&Vt(t,x,A,I,M,n,rt),tt&&(0===o&&r(x,A),r(I,M))}function ft(t,e,o,n,r){var i=Bt(t,!0),s=Bt(t,!1);u=a(W)?i.y:e,c=a(q)?s.y:o,f=a(z)?i.x:n,h=a(U)?s.x:r,h=f>=h?f+1:h,c=u>=c?u+1:c}function ht(e,o,n){t.beginPath(),t.arc(e-2,o-2,2,0,2*p,!1),t.fillStyle=n,t.fill()}function pt(e,o){t.beginPath(),t.strokeStyle=ot,t.arc(e-2,o-2,2,0,2*p,!1),t.stroke()}function dt(e,o){t.beginPath(),t.strokeStyle=nt,t.strokeRect(e-2,o-2,4,4)}if(V&&!(V.length<=0)&&!((s=Ht(V)).length<=0||H&&H.length>0&&(l=Ht(H),l.length<=0))){for(Et(t,o,n,r,i),t.beginPath(),tt=!!a(tt)||tt,ot=a(ot)?k:ot,nt=a(nt)?N:nt,ft(s,W,q,z,U),!a(Z)&&!a(Y)&&!a(K)&&!a(Q)&&f<=Z&&Z<=h&&f<=Y&&Y<=h&&u<=K&&K<=c&&u<=Q&&Q<=c&&((L=y(f,Z))>=(G=m(h,Y))&&(G=L+1),(B=y(u,K))>=(_=m(c,Q))&&(_=B+1),Dt(t,at+(L-f)*lt/(h-f),st+(c-_)*ut/(c-u),(G-L)*lt/(h-f),(_-B)*ut/(c-u),D)),O=-R,F=-R,E=R,j=R,v=s.length,d=0;d<v-1;d++)ct(s,d,ot,pt),$&&(0===d&&(A>F&&(O=x,F=A),A<j&&(E=x,j=A)),M>F&&(O=I,F=M),M<j&&(E=I,j=M));if(l&&l.length>0)for(ft(l,u,c,f,h),v=l.length,d=0;d<v-1;d++)ct(l,d,nt,dt);$&&(ht(O,F,N),ht(E,j,"#0000FF")),!a(J)&&u<=J&&J<=c&&(P=C(st+(c-J)*ut/(c-u))-.5,Vt(t,at,P,at+lt,P,N)),!a(X)&&f<=X&&X<=h&&(P=C(at+(X-f)*lt/(h-f))-.5,Vt(t,P,st,P,st+ut,N)),t.restore()}},BULLETSPARKLINE:function(t,e,o,n,r,i){var l,u,c,f,p,d,g,m,v,b,w,T,S,x,I,R=e.measure,M=e.target,k=e.maxi,D=e.good,F=e.bad,E=e.forecast,j=e.tickUnit,P=e.colorScheme,L=e.vertical,G=e.measureColor,B=e.targetColor,_=e.maxiColor,V=e.goodColor,H=e.badColor,z=e.forecastColor,U=e.allowMeasureOverMaxi,W=e.barSize;function q(e,a,s,l,u){var h,p,d;t.fillStyle=e,h=c,(p=f*(a/s))>f&&!U&&(p=f),d=new ct(L?wt(o+r*l,h-p,r*u,p):wt(h,n+i*l,p,i*u)),t.fillRect(d.x,d.y,d.width,d.height)}if(!(a(k)||k<0)&&(a(W)||!(A(W)||W<=0))){if(W>1&&(W=1),R=a(R)||R<0?0:R,D=a(D)||D<0?0:D,F=a(F)||F<0?0:F,M=a(M)?0:M,E=a(E)?0:E,j=a(j)?0:j,P=a(P)?"#A0A0A0":P,l=a(G)?"#252525":G,R>k&&!U&&(R=k,l=N),D>k&&(D=k,l=N),F>k&&(F=k,l=N),M>k&&(M=0,l=N),E>k&&(E=k,l=N),u=Mt(o,n,r,i,5,i-10,L),c=u.left,f=u.width,t.save(),p=a(W)?.2:(1-W)/2,d=a(W)?.6:W,g=U?y(k,R):k,q(a(_)?s(P,1.66):_,k,g,p,d),q(a(V)?s(P,1.33):V,D,g,p,d),q(a(H)?P:H,F,g,p,d),m=.25*W/.6,q(l,R,g,a(W)?.375:(1-m)/2,a(W)?.25:m),E>0&&(v=c,(b=f*(E/g))>f&&(b=f),w=a(W)?3:3*W/.6,At(t,L,o+.5*r,v,o+.5*r,v-b,v,n+.5*i,v+b,n+.5*i,a(z)?"#3690BF":z,w)),M>0&&(T=C(c-(L?1:-1)*f*(M/g))-.5,At(t,L,o+r*p,T,o+r*(1-p),T,T,n+i*p,T,n+i*(1-p),a(B)?N:B,1)),j>0)for(S=h(g/j),x=void 0,I=0;I<=S;I++)x=C(c-f/g*j*(L?1:-1)*I)-.5,At(t,L,o,x,o+.05*r,x,x,n+i,x,n+.95*i,O,1);t.restore()}},SPREADSPARKLINE:function(t,e,o,n,r,i){var s,l,u,c,f,h,p,d,g,v,b,w,T,S,x,A,I,R,M,k,D=e.spreadData,F=e.showAverage,E=e.scaleStart,j=e.scaleEnd,P=e.style,L=e.colorScheme,G=e.vertical,B=D.length;if(!(B<=0)){for(s=D[0].key,l=D[B-1].key,E=a(E)?s:E,j=a(j)?l:j,P=a(P)?4:P,L=a(L)?O:L,c=(u=Mt(o,n,r,i,5,i-10,G)).left,f=u.width,h=u.top,p=u.height,Et(t,o,n,r,i),t.beginPath(),t.strokeStyle=L,t.fillStyle=L,t.lineWidth=2,v=Tt(D,!1),w=0,T=D.length;w<T;w++)if(x=(S=D[w]).key,A=S.value,d=c+(G?-1:1)*f*(x-E)/(j-E),G?(d=m(d,c),d=y(d,c-f)):(d=y(d,c),d=m(d,c+f)),d=C(d),1===P)At(t,G,I=h+p/2-(b=(b=A/2*p/v)<.5?.5:b),d,R=h+p/2+b,d,d,I,d,R);else if(4===P)At(t,G,h,d,h+(b=(b=A*p/v)<1?1:b),d,d,h+p,d,h+p-b);else if(6===P)At(t,G,h,d,h+p,d,d,h,d,h+p);else for(2,M=1;M<=A;M++){switch(P){case 2:g=h+p/2-5-(A/2-M)*p/v;break;case 3:g=h+p-5-zt(A,p,3,S.randomNumbers)[M-1];break;default:g=h+p-M*p/v}g=C(g),t.beginPath(),t.fillRect(G?g:d,G?d:g,2,2)}F&&(k=function(t){var e,o,n,r=0,i=0;for(e=0,o=t.length;e<o;e++)n=t[e],i+=n.value,r+=n.key*n.value;return 0===i?0:r/i}(D),At(t,G,h-5,d=c-(G?1:-1)*f*(k-E)/(j-E),h+p+5,d,d,h-5,d,h+p+5,N)),t.restore()}},STACKEDSPARKLINE:function(t,e,o,n,r,i,l){var u,h,p,d,g,m,y,v,b,w,T,S,x,I,R,M,k,D,F=e.points,E=F&&F.length,L=e.colorRange,G=e.labelRange,B=e.maximum,_=e.targetRed,H=e.targetGreen,z=e.targetBlue,W=e.targetYellow,J=e.color,X=e.highlightPosition,Z=e.vertical,Y=e.textOrientation,K=e.textSize;function Q(e,o,n){var r,i;o!==c&&o!==f&&(o=o>B?B:o,n&&!n(o)||(i=(o=o<0?0:o)/B*g,Z?(r=C(d-i)-.5,St(t,m,r,m+y,r,e)):(r=C(d+i)-.5,St(t,r,m,r,m+y,e))))}if(!(a(F)||E<=0)){if(J=a(J)?O:J,a(L)||L.length!==E||function(t){for(var e=0,o=t.length;e<o;e++)if(a(t[e]))return!0;return!1}(L))for(L=[],u=0;u<E;u++)L.push(s(J,1+u/E));for(h=kt(F,(function(t){return t>0})),B=a(B)||B<h?h:B,Y=a(Y)?0:Y,K=a(K)||K<=0?10:K,K=A(K)?K:K*l.zoomFactor,p=Mt(o,n,r,i,5,i-10,Z),d=p.left,g=p.width,m=p.top,y=p.height,t.save(),v=d,R=0,M=E;R<M;R++)(I=F[R])<=0||(b=I/B*g,Z?(w=o+.15*r,S=.7*r,T=v-b,x=b):(w=v,S=b,T=n+.15*i,x=.7*i),k=R+1===X?N:L[R],t.save(),t.fillStyle=k,t.fillRect(w,T,S,x),(D=G&&G[R])&&(t.save(),t.fillStyle=Rt(k),t.textBaseline=U,t.textAlign=V,t.font=K+q,t.rect(w,T,S,x),t.clip(),1===Y?(t.translate(w+S/2,T),t.rotate(Math.PI/2),t.fillText(D,x/2,0)):t.fillText(D,w+S/2,T+x/2),t.restore()),v+=(Z?-1:1)*b,t.restore());Q("red",_,(function(t){return t>0})),Q(P,H),Q(j,z),Q("yellow",W),t.restore()}},HBARSPARKLINE:function(t,e,o,n,r,i){Jt(0,t,e,o,n,r,i)},VBARSPARKLINE:function(t,e,o,n,r,i){Jt(1,t,e,o,n,r,i)},VARISPARKLINE:function(t,e,o,n,r,i,s){var l,u,c,f,h,p,d,g,m,y,C,v,T,S,x,R,M,O,D,F,j,L=e.variance,G=e.reference,W=e.mini,J=e.maxi,X=e.mark,Z=e.tickUnit,Y=e.legend,K=e.colorPositive,Q=e.colorNegative,$=e.vertical,tt=N,et=k,ot=13*s.zoomFactor,nt=I(L);function rt(e,a,s,u,c,f,d,m,y,C,v,w,T,A){var I,R,M,k,N;$?Dt(t,I=o+.25*r,R=0===a?S-x:S,M=.5*r,k=x,e):Dt(t,I=0===a?S:S-x,R=n+.25*i,M=x,k=.5*i,e),g&&(Et(t,I,R,M,k),$?qt(t,o+r/2,l+s,p,c):qt(t,l+u,n+i/2,p,f),t.restore()),Y&&(void 0,N=0,g&&(N=.4*p*b(3)/2+5+2),t.save(),t.beginPath(),t.font=ot+q,t.fillStyle=E,$?(t.textAlign=V,it(ot+x+d,A,e,m,y,I,R,M,k,$),t.fillText(h,o+r/2,S+T*(x-N))):(t.textBaseline=U,it(t.measureText(h).width+x+C,A,e,v,w,I,R,M,k,$),t.fillText(h,S+T*(N-x),n+i/2)),t.restore())}function it(e,o,n,r,i,a,s,l,u,c){c?t.textBaseline=r:t.textAlign=r,e>0&&o<x&&(t.rect(a,s,l,u),t.clip(),c?t.textBaseline=i:t.textAlign=i,t.fillStyle=Rt(n))}function at(e,o,n,r,i,a,s,l,u,c){$?Wt(t,e,o,n,r,u):Wt(t,i,a,s,l,c)}if(!(A(nt)||(Q=a(Q)?"red":Q,K=a(K)?P:K,Z=a(Z)?0:Z,J=a(J)?1:J,W=a(W)?-1:W,d=!a(G),d||(G=0),$?(l=n+i-5,u=i-10,c=r-20,f=-1):(l=o+5,u=r-10,c=i-20,f=1),Y&&(m=I(e.variance),A(m)||(y=""+m,C=y.substr(y.indexOf(".")+1).length,h=C>=2?(100*m).toFixed(C-2)+"%":(100*m).toFixed(0)+"%")),nt>J&&(nt=J,g=!0),nt<W&&(nt=W,g=!0),G=Ft(G,J,W),g&&(p=Ft(c,60,15)),v=w(J-W),T=u/v,S=l+f*w(W-G)*T,x=w(nt-G)*T,x>w(v)*T&&(x=w(v+W)*T),R=l+f*u,$&&S<R||!$&&S>R))){if(Et(t,o,n,r,i),nt>G?rt(K,0,5-u,u-5,0,1,n-S,z,H,S-o-r,B,_,-1,w(J-nt)*T):(x>w(v)*T&&(x=w(v+W)*T,S=l),rt(Q,1,-5,5,2,3,S-n-i,H,z,o-S,_,B,1,w(W-nt)*T)),d&&(M=l+f*(Math.abs(W-G)*T),at(o,M,o+r,M,M,n,M,n+i)),Z>0)for(t.beginPath(),O=v/Z,D=0;D<=O;D++)at(o,F=l+u/O*D*f,o+.1*r,F,F,n+.9*i,F,n+i,et,et);!a(X)&&W<=X&&X<=J&&(t.beginPath(),j=l-($?1:-1)*w(W-X)*T,at(o,j,o+.33*r,j,j,n+.66*i,j,n+i,tt,tt),t.fill()),t.restore()}},BOXPLOTSPARKLINE:function(t,e,o,n,r,i){var s,l,u,f,h,p,d,g,C,v,b,T,S,R,M,D,F,E,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut,ct,ft,yt,Ct,vt,bt,wt=e.points,St=e.boxPlotClass,xt=e.showAverage,It=e.scaleStart,Rt=e.scaleEnd,Nt=e.acceptableStart,Ft=e.acceptableEnd,jt=e.style,Pt=e.colorScheme,Lt=e.vertical,Gt=Tt(wt,!1),Bt=Tt(wt,!0);function _t(e,o,n,r,i,a,s,l,u){Lt?Dt(t,o,n,r,i,e):Dt(t,a,s,l,u,e)}function Vt(e,o,n,r){At(t,Lt,W+q*e,n,W+q*o,n,n,W+q*e,n,W+q*o,r)}if(!(a(wt)||(wt=Ot(wt),wt.length<=0))){for((St=St===c||typeof St!==x?pt:St.toLocaleLowerCase())!==pt&&St!==ht&&St!==dt&&St!==gt&&St!==mt&&(St=pt),s=I(It),s=A(s)?Bt:s,l=I(Rt),l=A(l)?Gt:l,u=I(Nt),f=I(Ft),Pt!==c&&typeof Pt===x||(Pt="#D2D2D2"),(jt===c||0!==jt&&1!==jt)&&(jt=0),h=N,s>Bt&&(Pt=h,s=Bt),l<Gt&&(Pt=h,l=Gt),Et(t,o,n,r,i),t.lineWidth=2,d=(p=Mt(o,n,r,i,5,i-10,Lt)).left,g=p.width,C=p.top,v=p.height,b=Lt?-1:1,T=e.perc02,S=e.perc09,R=e.perc10,M=e.perc90,D=e.perc91,F=e.perc98,E=e.q1,L=Bt,G=Gt,B=1.5*(P=(j=e.q3)-E),_=1.5*P,V=e.stDev,H=kt(wt)/y(1,wt.length),z=0,U=0,W=C+.1*v,q=.7*v,J=w(l-s),X=0,Z=wt.length;X<Z;X++)(Y=wt[X])<E&&Y>=E-1.5*P&&Y-(E-1.5*P)<B&&(B=Y-(E-1.5*P),L=Y),Y>j&&Y<=j+1.5*P&&j+1.5*P-Y<_&&(_=j+1.5*P-Y,G=Y),K=!1,z=d+b*(g*((Y-s)/J)),St===dt&&(Y<=E-1.5*P||Y>=j+1.5*P)&&(K=!0,U=Y<=E-3*P||Y>=j+3*P?0:1),St===ht&&(Y<=T||Y>=F)&&(K=!0,U=1),St===mt&&(Y<=H-2*V||Y>=H+2*V)&&(K=!0,U=Y<=H-3*V||Y>=H+3*V?0:1),Q=k,K&&(1===jt?1===U?Vt(.2,.8,z,Q):Vt(.3,.7,z,Q):(($=.1*v)<2&&($=2),t.beginPath(),t.strokeStyle=Q,tt=C+.45*v,et=z,t.arc(Lt?tt:et,Lt?et:tt,$/2,0,2*Math.PI),t.stroke()));switch((s>u||l<f)&&(Pt="#C0FF00"),(u=y(s,u))>(f=m(l,f))?Pt=h:u<f&&At(t,Lt,rt=C+.9*v,ot=d+b*(g*((u-s)/J)),rt,nt=d+b*(g*((f-s)/J)),ot,rt,nt,rt,O),at=w(d+b*(g*((j-s)/J))-(it=d+b*(g*((E-s)/J)))),st=d+b*(g*((e.median-s)/J)),St){case ht:ct=T,ft=F;break;case dt:ct=L,ft=G;break;case mt:at=w(d+b*(g*((H+V-s)/J))-(it=d+b*(g*((H-V-s)/J)))),st=d+b*(g*((H-s)/J)),ct=(yt=H-2*V)>s?yt:Bt,ft=(yt=H+2*V)<l?yt:Gt,xt=!1;break;default:ct=Bt,ft=Gt}lt=d+b*(g*((ct-s)/J)),ut=d+b*(g*((ft-s)/J)),Ct=k,1===jt?_t("#F2F2F2",W,ut,q,lt-ut,lt,W,ut-lt,q):At(t,Lt,vt=C+.45*v,lt,vt,ut,lt,vt,ut,vt,Ct),_t(Pt,W,it-at,q,at,it,W,at,q),At(t,Lt,W,st,W+q,st,st,W,st,W+q,Ct),0===jt&&(At(t,Lt,W+.3*q,ut,W+.7*q,ut,ut,W+.3*q,ut,W+.7*q,Ct),At(t,Lt,W+.3*q,lt,W+.7*q,lt,lt,W+.3*q,lt,W+.7*q,Ct)),St!==ht&&St!==gt||(void 0,void 0,St===ht?(ct=S,ft=D):(ct=R,ft=M),bt=d+b*(g*((ct-s)/J)),Vt(.3,.7,d+b*(g*((ft-s)/J)),Ct),Vt(.3,.7,bt,Ct)),xt&&Vt(.2,.8,z=d+b*(g*((H-s)/J)),h),t.restore()}},CASCADESPARKLINE:function(t,e,o,n,r,i,l){var u,f,h,p,d,g,C,v,b,T,S,R,M,k,N,O,F,j,P,L,G,B,_,V,H,z,U,W,q,J,X,Z,Y,K,Q,$,tt,et,ot,nt,rt,it,at,st,lt,ut=e.points,ct=e.labels,ft=e.pointIndex,ht=e.minimum,pt=e.maximum,dt=e.colorPositive,gt=e.colorNegative,mt=e.vertical,yt=e.itemTypeRange,Ct=e.colorTotal,vt=13*l.zoomFactor;if(!(a(ut)||(u=ut.length,u<=0||(f=parseInt(ft,10),A(f)||f<=0||f>u)))){for(ct=a(ct)?[]:ct,dt!==c&&typeof dt===x||(dt="#8CBF64"),gt!==c&&typeof gt===x||(gt="#D6604D"),typeof Ct!==x&&(Ct=c),h=dt,p=s(dt,1.3),d=gt,g=s(gt,1.3),C=1,v=0,b=0,T=0,S=0,R=[],M=0,k=0,O=0,F=u;O<F;O++)k=ut[O],N=yt[O],j=!1,P=1===C,(L=!a(N))&&("+"===N?k=w(k):"-"===N?k=-w(k):"="===N?(j=!0,P?v=k:k=v):L=!1),R[C]=[],G=R[C],A(k)?(G[0]=0,G[1]=v,G[2]=0):(G[0]=w(k),v=j?v:k+v,G[1]=k>0?b:v,G[2]=k),G[3]=C,T=m(b,T),S=y(b,S),((B=C===u)&&!L||j)&&(M=T<0?-T:0,G[1]=k>0?0:k),L&&j&&!P||(b=k+b,B&&L&&(T=m(b,T),S=y(b,S))),C++;_=!1,a(N)||(_=-1===["-","+","="].indexOf(N)),(a(N)||_)&&(v-=k),z=I(ht),A(z)||z>0||z>T?(V=T,z=T):(V=z,M=-z),U=I(pt),A(U)||U<0||U<S?H=S:(H=U,M=-z),q=(W=Mt(o,n,r,i,5,i-10,mt)).left,J=W.width,X=W.top,Z=W.height,Y=mt?-1:1,K=J/(H-V),Et(t,o,n,r,i),t.beginPath(),t.lineWidth=1,$=(Q=R[f])[2],tt=yt[f-1],et=q+Y*(Q[1]+M)*K,ot=Q[0]*K,rt="="===tt,it=(a(tt)||_)&&f===u||rt,nt=Ct&&it?Ct:1===f||it?$>=0?h:d:$>=0?p:g,mt?Dt(t,X,et-ot,Z,ot,nt):Dt(t,et,X,ot,Z,nt),mt?(1!==f&&(f!==u?Yt(t,$>0,D,o,et,X+Z,et,o,et-ot,X+Z,et-ot):Yt(t,!0,D,o,at=q-(v+M)*K,X+Z,at)),f!==u&&Yt(t,$>0,D,X,et-ot,o+r,et-ot,X,et,o+r,et)):(1!==f&&(f!==u?Yt(t,$>0,D,et,n,et,X+Z,et+ot,n,et+ot,X+Z):Yt(t,!0,D,st=q+(v+M)*K,n,st,X+Z)),f!==u&&Yt(t,$>0,D,et+ot,X,et+ot,n+i,et,X,et,n+i)),lt=ct[f-1],ct.length>0&&!a(lt)&&""!==lt&&Qt(t,o,n,r,i,{labelText:lt,vertical:mt,isInRightOrTopOfBox:$>0,fontSize:vt,startBox:et,endBox:ot,boxColor:nt}),Yt(t,mt,E,o,q-M*K,o+r,q-M*K,q+M*K,n,q+M*K,n+i),t.restore()}},PARETOSPARKLINE:function(t,e,o,n,r,i,s){var l,u,c,f,h,p,d,g,m,y,v,b,w,S,R,M,O,D,F,E,j,P,L,G,B,_,V=e.points,H=e.pointIndex,z=e.colorRange,U=e.target,W=e.target2,q=e.highlightPosition,J=e.label,X=e.vertical,Z=13*s.zoomFactor,Y=e.targetColor,K=e.target2Color,Q=e.labelColor,$=e.barSize;if(!a(V)&&(a($)||!(A($)||$<=0))&&($>1&&($=1),!((l=V.length)<=0||(u=parseInt(H,10),A(u)||u<=0||u>l)))){for(z=a(z)?[]:z,c=parseInt(J,10),c=A(c)?0:c,f=1,h=0,p=[],d=0,g=V.length;d<g;d++)m=V[d],p[f]=[],y=p[f],m<0||A(m)||a(m)?(y[0]=1===f?0:h,y[1]=0):(h+=m,y[0]=1===f?0:h-m,y[1]=m),f++;5,v=a($)?5:X?r*(1-$)/2:i*(1-$)/2,b=Mt(o,n,r,i,v,i-10,X,5),w=b.left,S=b.width,R=b.top,M=b.height,O=X?-1:1,D=S/h,Et(t,o,n,r,i),t.beginPath(),t.lineWidth=1,E=(F=p[u])[1],j=w+O*F[0]*D,P=F[1]*D,L=u===q?N:0===z.length||typeof z[u-1]!==x?k:z[u-1],X?Dt(t,R,j-P,M,P,L):Dt(t,j,R,P,M,L),1===c?G=(F[0]+E)/h*1e3:2===c&&(G=E/h*1e3),B=C(G)/10+"%",1!==c&&2!==c||""===B||Qt(t,o,n,r,i,{labelText:B,vertical:X,isInRightOrTopOfBox:(F[0]+F[1])*D<S/2,fontSize:Z,startBox:j,endBox:P,boxColor:L,fillStyle:Q}),_=[a(Y)?"#8CBF64":Y,a(K)?"#EE5D5D":K],[U,W].forEach((function(e,a){var s=function(t){var e=I(t);return(e=(e=A(e)?0:e)<0?0:e)>1?1:e}(e),l=T(w+O*S*s);Yt(t,X,_[a],o,l,o+r,l,l,n,l,n+i)})),t.restore()}},MONTHSPARKLINE:function(t,e,o,n,r,i){var a,s,l,u,c=e.year,f=e.month,h=e.values,p=e.emptyColor||"lightgray",d=e.startColor,g=e.middleColor,m=e.endColor,y="white",C=(r-14)/6,v=(i-16)/7,b=[],w=new Date(c,f-1,1).getDay();for(a=0;a<42;a++)a<w?b[a]=y:a<w+$t(c,f)?b[a]=p:b[a]=y;for(oe(h,b,w,e.colors,d,g,m),t.save(),t.rect(o,n,r,i),t.clip(),t.beginPath(),s=0,l=0;l<6;l++)for(u=0;u<7;u++)t.fillStyle=b[s],s++,t.fillRect(o+l*C+2*(l+1),n+u*v+2*(u+1),C,v);t.restore()},YEARSPARKLINE:function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,C,v,b,w,T,S,x,A,I,R,M,k=e.year,N=e.values,O=e.emptyColor||"lightgray",D=e.startColor,F=e.middleColor,E=e.endColor,j="white",P=parseInt(366/7+"",10)+2,L=[],G=new Date(k,0,1).getDay(),B=ne(new Date(k,11,31));for(s=0;s<7*P;s++)L[s]=s<G?j:s<G+B?O:j;for(oe(N,L,G,e.colors,D,F,E),t.save(),t.rect(o,n,r,i),t.clip(),c=o+(u=15*(l=a.zoomFactor)),f=n,h=r-u,p=i,t.save(),t.translate(o+u/2,f+p),t.rotate(-Math.PI/2),t.font=13*l+q,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(k+"",p/2,0),t.restore(),2,d=(h-2*(P+1))/P,g=(p-16)/7,m=0,b=[],C=0;C<P;C++)for(y=0;y<7;y++)v={x:c+C*d+2*(C+1),y:f+y*g+2*(y+1),w:d,h:g},b[m]=v,t.fillStyle=L[m],m++,t.fillRect(v.x,v.y,v.w,v.h);for(w=[],T={},S=0;S<12;S++)T[S]=ne(new Date(k,S,1))-1+G;for(x=T[11]+$t(k,12)-1,m=0,C=0;C<P;C++)for(y=0;y<7;y++)G<=m&&m<G+B&&(I=T[(A=new Date(k,0,m-G+1)).getMonth()],v=b[m],I<=m&&m<7+I&&w.push({x1:v.x,y1:v.y-1,x2:v.x,y2:v.y+v.h+1}),m!==I&&0!==A.getDay()||w.push({x1:v.x-1,y1:v.y,x2:v.x+v.w+1+(m===I?2:0),y2:v.y}),x-7<m&&m<=x&&w.push({x1:v.x+v.w,y1:v.y-1,x2:v.x+v.w,y2:v.y+v.h+1}),m!==x&&6!==A.getDay()||w.push({x1:v.x-1-(m===x?2:0),y1:v.y+v.h,x2:v.x+v.w+1,y2:v.y+v.h})),m++;for(t.strokeStyle="black",t.lineWidth=2,R=0;R<w.length;R++)M=w[R],t.beginPath(),t.moveTo(M.x1,M.y1),t.lineTo(M.x2,M.y2),t.stroke();t.restore()},GAUGEKPISPARKLINE:function(t,e,o,n,r,i,a){t.save(),t.rect(o,n,r,i),t.clip(),0===e.gaugeType?le(t,e,o,n,r,i,a):1===e.gaugeType?ce(t,e,o,n,r,i,a):2===e.gaugeType&&he(t,e,o,n,r,i,a),t.restore()},HISTOGRAMSPARKLINE:function(t,e,o,n,r,i,s){var l,u,c=e.barColor,f=e.values,h=e.paintLabel,p=e.barWidth,d=e.labelFontStyle,g=e.afterZoomFontStyle,m=e.edgeColor,y=e.labelColor;a(d)||(i<3*g.fontPixelSize||pe(t,f,r,0,de(g)))&&(h=!1),h&&a(d)&&(l=Math.floor(i/3>=12?12:Math.floor(i/3)),g.fontPixelSize=l,g.fontSize=l+"px",pe(t,f,r,0,de(g))&&(h=!1)),u=function(t,e,o,n,r,i,a,s){var l,u,c,f,h,p,d=[],g=t.length,m=0,y=a.fontPixelSize;if(i&&(m=y+3),0===g)return d;for(l=n/g,u=t[0].value,c=1;c<g;c++)u=Math.max(u,t[c].value);for(f=0;f<g;f++)h=o+r-m,(p=t[f].value/u*(r-m))<0&&(p=0),d.push({x:e+f*l+l*(1-s)/2,textX:e+f*l,y:h-p,width:l*s,textWidth:l,height:p,axis:t[f].axis});return d}(f,o+3,n+3,r-6,i-6,h,g,p),function(t,e,o,n){t.save(),t.fillStyle=o;for(var r=0;r<e.length;r++)t.fillRect(e[r].x,e[r].y,e[r].width,e[r].height);t.restore()}(t,u,c),function(t,e,o,n){if("none"!==n){t.save(),t.lineWidth=1,t.strokeStyle=n,t.beginPath();for(var r=0;r<e.length;r++)St(t,e[r].x,e[r].y,e[r].x+e[r].width,e[r].y),St(t,e[r].x,e[r].y+e[r].height,e[r].x+e[r].width,e[r].y+e[r].height),e[r-1]&&e[r-1].height>=e[r].height&&1===o||St(t,e[r].x,e[r].y,e[r].x,e[r].y+e[r].height),e[r+1]&&e[r+1].height>e[r].height&&1===o||St(t,e[r].x+e[r].width,e[r].y,e[r].x+e[r].width,e[r].y+e[r].height);t.stroke(),t.closePath(),t.restore()}}(t,u,p,m),h&&function(t,e,o,n){var r,i,a,s,l;for(t.save(),r=o.fontPixelSize,i=de(o),t.textAlign="center",t.fillStyle=n,a=0;a<e.length;a++)s=e[a].x+e[a].width/2,l=e[a].y+e[a].height+5+r,t.save(),t.font=i,t.beginPath(),t.rect(e[a].textX,e[a].y+e[a].height+1,e[a].textWidth,r+3),t.clip(),t.textBaseline="bottom",t.fillText(e[a].axis,s,l),t.restore();t.restore()}(t,u,g,y)},IMAGESPARKLINE:function(t,e,o,n,r,i,a){var s,l,u,c,f,h,p,d,g;t.save(),t.rect(o,n,r,i),t.clip(),s=e.clipX,l=e.clipY,u=e.clipWidth,c=e.clipHeight,f=e.paintX,h=e.paintY,p=e.paintWidth,d=e.paintHeight,g=e.img,u>0&&c>0&&p>0&&d>0&&t.drawImage(g,s,l,u,c,f,h,p,d),t.restore()}}}}),t.exports=o.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(t,e,o){t.exports=o("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},"@grapecity/js-calc":function(t,e){t.exports=r.Spread.CalcEngine},Bindings:function(t,e){t.exports=r.Spread.Sheets.Bindings},CellTypes:function(t,e){t.exports=r.Spread.Sheets.CellTypes},Common:function(t,e){t.exports=r.Spread},ConditionalFormatting:function(t,e){t.exports=r.Spread.Sheets.ConditionalFormatting},ContextMenu:function(t,e){t.exports=r.Spread.Sheets.ContextMenu},Core:function(t,e){t.exports=r.Spread.Sheets},Filters:function(t,e){t.exports=r.Spread.Sheets.Filter},FloatingObject:function(t,e){t.exports=r.Spread.Sheets.FloatingObjects},SheetsCalc:function(t,e){t.exports=r.Spread.Sheets.CalcEngine},Sparkline:function(t,e){t.exports=r.Spread.Sheets.Sparklines},Tables:function(t,e){t.exports=r.Spread.Sheets.Tables},Touch:function(t,e){t.exports=r.Spread.Sheets.Touch}}),n=r||{},"object"==typeof t.exports?t.exports=n:void 0===(o=function(){return n}.apply(e,[]))||(t.exports=o)},571104:function(t,e,o){t.exports=o(31040)}}]);