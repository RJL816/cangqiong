(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[1816],{765792:function(e,t,r){"use strict";r.r(t),t.default={"image-viewer":"_24S4pHJb","image-wrapper":"_2OlQk2lY",normal:"IOAy1h1Y","button-container":"PYUFGp3_",btn:"_23NPXHRG","btn-disabled":"_2t5b6Umz",hidden:"_2aNYmhS9"}},816956:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(182320),r(909112),r(697060),r(360776),r(622676),r(233696),r(505684),r(743924),r(693917),r(205960),r(976896),r(721300),r(846428),r(969e3),r(606200),r(534440),r(76152),r(76124),r(387912),r(690512),r(78504),r(776512),r(997308),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(9692),r(323784),r(633768),r(513640),r(86744);var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}(r(795520)),o=c(r(671252)),i=c(r(765792)),l=r(331428),u=r(419008);function c(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){var a;return a=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(a)?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h={marginLeft:0,marginTop:0,transition:"transform 0.3s ease 0s",transform:"scale(1) rotate(0deg)"},v=a.default.memo((function(e){var t=e.url,r=e.showToolBar,n=void 0===r||r,c=e.type,f=e.onLoad,s=e.visible,m=e.onClose,v=y((0,a.useState)(!1),2),g=v[0],w=v[1],b=y((0,a.useState)(h),2),E=b[0],P=b[1],T=(0,a.useRef)(),k=(0,a.useRef)(),A=(0,a.useRef)(),O=(0,a.useRef)(100),S=(0,a.useRef)(0),I=(0,a.useRef)(!1);(0,a.useEffect)((function(){return s?(P(h),window.addEventListener("mouseup",C)):window.removeEventListener("mouseup",C),function(){window.removeEventListener("mouseup",C)}}),[s]);var N=function(e){e=Math.min(20,Math.max(-20,e));var t=O.current;(t+=e)<=25?t=25:t>=8e3&&(t=8e3),O.current=t,P((function(e){return d(d({},e),{},{transform:e.transform.replace(/scale\([^\)]*\)/,"scale(".concat(t/100,")"))})}))},_=function(e){e.preventDefault(),e.stopPropagation()},C=function(e){_(e),w(!1)},x="kdfont kdfont-suoxiao kdhover-color ".concat(i.default.btn," ").concat(O.current<=25?i.default["btn-disabled"]:""),L="kdfont kdfont-fangda kdhover-color ".concat(i.default.btn," ").concat(O.current>=8e3?i.default["btn-disabled"]:""),M="kdfont kdfont-xuanzhuan kdhover-color ".concat(i.default.btn);return a.default.createElement("div",{className:(0,o.default)(i.default["image-viewer"],p({},i.default.hidden,!s)),onMouseDown:function(e){_(e),e.target===T.current?null==m||m():e.target===k.current&&(A.current={x:e.clientX,y:e.clientY},w(!0))},onMouseMove:function(e){if(g&&A.current&&k&&k.current){var t=e.clientX,r=e.clientY,n=A.current,a=n.x,o=n.y;A.current={x:t,y:r};var i=t-a,l=r-o;P((function(e){return d(d({},e),{},{marginTop:e.marginTop+l,marginLeft:e.marginLeft+i})}))}},onWheel:function(e){e.stopPropagation();var t=e.deltaY;u.isWin?N(t<0?15:-15):I.current||(I.current=!0,N(t),setTimeout((function(){I.current=!1}),50))}},a.default.createElement("div",{className:(0,o.default)(i.default["image-wrapper"]),ref:T},a.default.createElement("img",{draggable:!1,className:(0,o.default)(i.default.normal),style:E,"data-image-src":t,"data-image-type":c,ref:k,onLoad:function(){f&&f()}})),n?a.default.createElement("div",{className:i.default["button-container"]},a.default.createElement("a",{href:"",onClick:function(e){_(e),N(-25)},className:x,title:(0,l.getLangMsg)({key:"attachmentpanel.key0062"})}),a.default.createElement("a",{href:"",onClick:function(e){_(e),N(25)},className:L,title:(0,l.getLangMsg)({key:"attachmentpanel.key0061"})}),a.default.createElement("a",{href:"",onClick:function(e){_(e);var t=S.current+90;S.current=t,P((function(e){return d(d({},e),{},{transform:e.transform.replace(/rotate\([^\)]*\)/,"rotate(".concat(t,"deg)"))})}))},className:M,title:(0,l.getLangMsg)({key:"attachmentpanel.key0063"})})):null)}));t.default=v},571092:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(201364),r(697060),r(360776),r(22588),r(622676),r(505684),r(323784),r(885612),r(693917),r(205960),r(976896),r(721300),r(431480),r(443896),r(846428),r(708896),r(969e3),r(606200),r(534440),r(76152),r(670864),r(76124),r(880920),r(633768),r(690512),r(776512),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(233696),r(443616),r(743924),r(835164),r(387912),r(497448),r(660824),r(78504),r(997308),r(977864);var a=O(r(795520)),o=k(r(671252)),i=k(r(782504)),l=O(r(211152)),u=r(323968),c=r(439532),f=r(331428),s=k(r(250864)),d=k(r(153504)),p=k(r(353168)),y=k(r(816956)),m=k(r(267440)),h=r(248672),v=r(545072),g=r(580032),w=r(984844),b=k(r(127360)),E=k(r(937344)),P=r(24616),T=k(r(713564));function k(e){return e&&e.__esModule?e:{default:e}}function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(A=function(e){return e?r:t})(e)}function O(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=A(t);if(r&&r.has(e))return r.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}function S(){S=function(){return t};var e,t={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),l=new x(n||[]);return o(i,"_invoke",{value:I(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",y="suspendedYield",m="executing",h="completed",v={};function g(){}function w(){}function b(){}var E={};f(E,l,(function(){return this}));var P=Object.getPrototypeOf,T=P&&P(P(L([])));T&&T!==r&&a.call(T,l)&&(E=T);var k=b.prototype=g.prototype=Object.create(E);function A(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,l,u){var c=d(e[o],e,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==n(s)&&a.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,l,u)}),(function(e){r("throw",e,l,u)})):t.resolve(s).then((function(e){f.value=e,l(f)}),(function(e){return r("throw",e,l,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function I(t,r,n){var a=p;return function(o,i){if(a===m)throw new Error("Generator is already running");if(a===h){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var l=n.delegate;if(l){var u=N(l,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var c=d(t,r,n);if("normal"===c.type){if(a=n.done?h:y,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=h,n.method="throw",n.arg=c.arg)}}}function N(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,N(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(a.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:w,configurable:!0}),w.displayName=f(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,f(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},A(O.prototype),f(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new O(s(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(k),f(k,c,"Generator"),f(k,l,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return l.type="throw",l.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],l=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function I(e,t,r,n,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,a)}function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){var a;return a=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(a)?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var M=h.ATTACHMENT_PREVIEW_FILE_STATUS.INITIAL,j=h.ATTACHMENT_PREVIEW_FILE_STATUS.REQUEST_SUCCESS,R=h.ATTACHMENT_PREVIEW_FILE_STATUS.LOAD_SUCCESS,B=h.ATTACHMENT_PREVIEW_FILE_STATUS.FAILED,D=a.default.lazy((function(){return r.e(4260).then(r.bind(r,650336))})),F=a.default.lazy((function(){return Promise.all([r.e(7016),r.e(1768)]).then(r.bind(r,761768))})),Y=a.default.lazy((function(){return Promise.all([r.e(4074),r.e(7016),r.e(4260)]).then(r.bind(r,449168))})),U=a.default.lazy((function(){return Promise.all([r.e(2360),r.e(4260),r.e(312)]).then(r.bind(r,151400))})),W=a.default.forwardRef((function(e,t){var r=e.files,n=e.activedIndex,k=(e.onLoad,e.onClose),A=e.model,O=e.updateFile,N=e.hasPermission,C=e.previewLimitSize,L=e.showNotification,W=(0,a.useRef)(),z=(0,a.useRef)(),H=x((0,a.useState)(!0),2),K=H[0],G=H[1],Q=function(e){e.forEach((function(e){var t=e.contentRect.width;W.current.style.cssText="transform: translateX(-".concat(t*n,"px);")}))},q=(0,c.getAttachInfoFromRootConfig)(),Z=q.customPreviewUseDefaultType,V=q.previewType,J=void 0===V?h.PreviewByDefault:V,X=q.allowFileSuffix,$=void 0===X?[]:X,ee=q.onlyofficeServerUrl,te=q.wpsAppId,re=(0,c.getRootFormConfig)().accountId,ne=J===h.PreviewByYunZhiJia;(0,a.useEffect)((function(){var e=new i.default(Q);return e.observe(W.current),function(){e.disconnect(W.current)}}),[Q]),(0,a.useEffect)((function(){if(W.current){var e=W.current.getBoundingClientRect().width;W.current.style.cssText="transform: translateX(-".concat(e*n,"px);");var t;A&&((t=r[n])&&t.uid&&(0,g.savePreviewedAttamentIdToStorage)(A,t.uid))}}),[n,A]),(0,a.useEffect)((function(){if(r&&r[n]){var e=r[n];if(![B,j].includes(e.loadStatus))if(C>0&&e.size>C)O(_(_({},e),{},{loadStatus:j}),n);else{G(!0);var t=function(){var t,r=(t=S().mark((function t(r,a,o){var i,l,u;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(0,g.isPreviewByOnlyOffice)(e.type),t.prev=1,!i){t.next=8;break}return t.next=5,E.default.postApi((0,w.appendParamsToUrl)(r,{model:A}),{onlyOfficeData:(0,g.getOnlyOfficeData)(e)});case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,E.default.getApi((0,w.appendParamsToUrl)(r,{model:A}));case 10:t.t0=t.sent;case 11:"success"===(null==(l=t.t0)?void 0:l.status)?(u=_(_({},e),{},{loadStatus:j}),void 0!==l.token&&null!==l.token&&(u.token=l.token),l.data&&(u.excelData=l.data),l.url&&(u.realPreviewUrl=l.url),te&&(u.wpsFileId=l.fileId),O(u,n)):(null!=l&&l.description&&(null==L||L(l.description)),O(_(_({},e),{},{loadStatus:B}),n)),t.next=18;break;case 15:t.prev=15,t.t1=t.catch(1),O(_(_({},e),{},{loadStatus:B}),n);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})),function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(e){I(o,n,a,i,l,"next",e)}function l(e){I(o,n,a,i,l,"throw",e)}i(void 0)}))});return function(e,t,n){return r.apply(this,arguments)}}(),a=e.type.toLowerCase(),o=[h.PreviewByPublicWps,h.PreviewByPrivateWps,h.PreviewByYozo].includes(J),i=J===h.PreviewByDefault&&h.ATTACHMENT_PREVIEW_EXCEL.includes(a)||Z.includes(a),l=J===h.PreviewByYunZhiJia&&h.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(a),u=J===h.PreviewByCustom&&(0===$.length||$.includes(a));if(o||i||l||u||(0,g.isPreviewByKKFile)(a)||(0,g.isPreviewByOnlyOffice)(a))t((0,g.isCrossTenant)(null==A?void 0:A.pageId)?e.previewFilePath:e.previewurl);e.loadStatus===B&&G(!1)}}}),[n,r,J,A]),(0,a.useImperativeHandle)(t,(function(){return{getCurrentRef:function(){return z}}}),[]);var ae=function(){if(N("download")){var e=r[n];if(A&&(0,l.doGlobalDispatch)((0,u.attachOperationCount)(A,[{operationType:"download",uid:[e.uid]}])),e){var t=(0,g.isCrossTenant)(null==A?void 0:A.pageId)?e.downloadFilePath:e.url;window.open((0,w.appendParamsToUrl)(t,{model:A}))}}},oe=function(){var e=r[n];A&&(0,l.doGlobalDispatch)((0,u.attachOperationCount)(A,[{operationType:"preview",uid:[e.uid]}])),e&&window.open("".concat((0,g.appendParamsForUrl)(e.previewurl,A),"#toolbar=0"))};return a.default.createElement("ul",{className:T.default["list-container"],ref:W},r.map((function(e,t){var r=n===t,i=e.type,u=e.previewurl,c=e.url,E=(e.uid,e.loadStatus),O=e.visible,S=e.size,I=(e.onlyOfficeDownloadUrl,e.realPreviewUrl),N=e.previewFilePath;if(u=(0,g.isCrossTenant)(null==A?void 0:A.pageId)?N:u,O&&"1"!==O[0])return a.default.createElement(d.default,{key:e.uid});if(!u||C>0&&S>C)return a.default.createElement("li",{className:T.default["list-item"],key:e.uid},a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:!c||O&&"1"!==O[1]?null:(0,f.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:ae}));var _=t===n?z:null,x=i.toLowerCase();if(J===h.PreviewByYozo&&h.YozoFileType.includes(x))return a.default.createElement("li",{className:T.default["list-item"],key:e.uid},e.loadStatus===j?a.default.createElement("iframe",{ref:_,className:(0,o.default)(T.default["preview-content"]),style:{width:"100%",height:"100%"},src:I,topToolbarHeight:0}):e.loadStatus===B?a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:!c||O&&"1"!==O[1]?null:(0,f.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:ae}):a.default.createElement(a.default.Fragment,null,a.default.createElement(p.default,null)));if((0,g.isPreviewByWps)(x)){var L=te?Y:F,W=te?e.wpsFileId:e.uid;return a.default.createElement("li",{className:T.default["list-item"],key:"attachment_".concat(t)},r&&a.default.createElement(L,{accountId:re,appId:te,className:(0,o.default)(T.default["preview-content"]),url:I,fileId:W,type:i,token:e.token||(0,P.getResponseHeader)(v.CSRF_TOKEN)}))}var H=r&&J===h.PreviewByOnlyOffice;if(!(r&&E!==h.ATTACHMENT_PREVIEW_FILE_STATUS.INITIAL||H))return a.default.createElement("li",{className:T.default["list-item"],key:"attachment_".concat(t)},a.default.createElement(a.default.Fragment,null,a.default.createElement(b.default,null)));var Q=function(){G(!1)},q=a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:e.visible&&"1"!==e.visible[1]?null:(0,f.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:ae});if((ne&&$.length>0||(0,g.isPreviewByCustom)(x))&&!Z.includes(x)&&$.map((function(e){return e.toLowerCase()})).includes(x))return a.default.createElement("li",{className:T.default["list-item"],key:e.uid},e.loadStatus===M?null:e.loadStatus===j||e.loadStatus===R?a.default.createElement("iframe",{ref:_,className:(0,o.default)(T.default["preview-content"]),style:{width:"100%",height:"100%"},src:e.realPreviewUrl||(0,w.appendParamsToUrl)(u,{model:A}),topToolbarHeight:0,onLoad:Q}):a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:e.visible&&"1"!==e.visible[1]?null:(0,f.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:ae}));if((0,g.isPreviewByOnlyOffice)(x)&&(0,g.getDocumentTypeOfOnlyoffice)(x))return a.default.createElement("li",{className:T.default["list-item"],key:"attachment_".concat(t)},a.default.createElement("div",{style:{width:"100%",height:"100%",display:r?"block":"none"}},a.default.createElement(D,{file:e,documentServerUrl:ee,errorContent:q})));if(h.ATTACHMENT_PREVIEW_IMG_TYPE.includes(x)){var V=e.realPreviewUrl||(0,w.appendParamsToUrl)(u||c,{model:A,getParentId:function(e){return"bos_entryattach_upload"===e}});return q=ne&&!Z.includes(x)?h.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(i)&&e.loadStatus===M?null:a.default.createElement("iframe",{ref:_,className:(0,o.default)(T.default["preview-content"]),style:{width:"100%",height:"100%"},src:V,topToolbarHeight:0,onLoad:Q}):a.default.createElement(y.default,{visible:t===n,ref:_,url:V,type:i,onLoad:Q,onClose:function(){return k&&k()}}),a.default.createElement("li",{className:T.default["list-item"],key:e.uid},q,K&&a.default.createElement(p.default,null))}return(h.ATTACHMENT_PREVIEW_OFFICE.includes(x)||h.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(x)||(0,g.isPreviewByKKFile)(x))&&(ne&&!Z.includes(x)?e.loadStatus===j||e.loadStatus===R?h.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(x)&&(q=a.default.createElement(a.default.Fragment,null,a.default.createElement("iframe",{ref:_,className:(0,o.default)(T.default["preview-content"]),style:{width:"100%",height:"100%"},src:I||(0,w.appendParamsToUrl)(u,{model:A}),topToolbarHeight:0,onLoad:Q}),K&&a.default.createElement("div",{className:(0,o.default)(T.default["kkfile-loading"])},a.default.createElement(b.default,null)))):q=h.ATTACHMENT_PREVIEW_IFRAME_TYPE.includes(x)&&e.loadStatus===M?null:a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0053"}),btnText:(0,f.getLangMsg)({key:"attachmentpanel.key0054"}),onClick:oe}):q=(0,g.isPreviewByKKFile)(x)&&e.loadStatus===j?a.default.createElement(a.default.Fragment,null,a.default.createElement("iframe",{ref:_,className:(0,o.default)(T.default["preview-content"]),style:{width:"100%",height:"100%"},src:"".concat((0,w.appendParamsToUrl)(I,{model:A})),onLoad:Q}),K&&a.default.createElement("div",{className:(0,o.default)(T.default["kkfile-loading"])},a.default.createElement(b.default,null))):h.ATTACHMENT_PREVIEW_EXCEL.includes(x)?e.loadStatus===j||e.loadStatus===R?a.default.createElement(m.default,{file:e}):e.loadStatus===B?a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0055"}),btnText:e.visible&&"1"!==e.visible[1]?null:(0,f.getLangMsg)({key:"attachmentpanel.key0056"}),onClick:ae}):null:"error"===e.status?a.default.createElement(s.default,{title:(0,f.getLangMsg)({key:"attachmentpanel.key0058"})}):l.default[l.IS_IE]?a.default.createElement("iframe",{ref:_,className:(0,o.default)(T.default["preview-content"]),style:{width:"100%",height:"100%"},src:"".concat((0,w.appendParamsToUrl)(u,{model:A}),"#toolbar=0"),onLoad:Q}):a.default.createElement(U,{className:(0,o.default)(T.default["preview-pdf-content"]),url:"".concat((0,w.appendParamsToUrl)(u,{model:A})),ref:_,onLoad:Q})),a.default.createElement("li",{className:T.default["list-item"],key:"attachment_".concat(t)},q)})))}));t.default=W},811816:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r(201364),r(697060),r(360776),r(22588),r(233696),r(505684),r(323784),r(743924),r(885612),r(205960),r(976896),r(431480),r(443896),r(846428),r(708896),r(969e3),r(606200),r(534440),r(76152),r(670864),r(76124),r(880920),r(497448),r(633768),r(690512),r(78504),r(776512),r(997308),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(9692),r(622676),r(443616),r(835164),r(693917),r(721300),r(387912),r(660824);var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var r=C(t);if(r&&r.has(e))return r.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}(r(795520)),o=_(r(369396)),i=_(r(671252)),l=r(790832),u=r(891052),c=r(211152),f=_(r(571092)),s=_(r(238807)),d=r(323968),p=_(r(937344)),y=r(439532),m=r(984844),h=r(608008),v=r(545072),g=r(248672),w=_(r(713564)),b=r(738704),E=r(674260),P=r(868256),T=r(703188),k=r(580032),A=r(218652),O=r(331428),S=r(576900),I=r(49480),N=r(747325);function _(e){return e&&e.__esModule?e:{default:e}}function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(C=function(e){return e?r:t})(e)}function x(){x=function(){return t};var e,t={},r=Object.prototype,a=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},l=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),l=new C(n||[]);return o(i,"_invoke",{value:S(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var p="suspendedStart",y="suspendedYield",m="executing",h="completed",v={};function g(){}function w(){}function b(){}var E={};f(E,l,(function(){return this}));var P=Object.getPrototypeOf,T=P&&P(P(L([])));T&&T!==r&&a.call(T,l)&&(E=T);var k=b.prototype=g.prototype=Object.create(E);function A(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,i,l,u){var c=d(e[o],e,i);if("throw"!==c.type){var f=c.arg,s=f.value;return s&&"object"==n(s)&&a.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,l,u)}),(function(e){r("throw",e,l,u)})):t.resolve(s).then((function(e){f.value=e,l(f)}),(function(e){return r("throw",e,l,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function S(t,r,n){var a=p;return function(o,i){if(a===m)throw new Error("Generator is already running");if(a===h){if("throw"===o)throw i;return{value:e,done:!0}}for(n.method=o,n.arg=i;;){var l=n.delegate;if(l){var u=I(l,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var c=d(t,r,n);if("normal"===c.type){if(a=n.done?h:y,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=h,n.method="throw",n.arg=c.arg)}}}function I(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=d(a,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(a.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:w,configurable:!0}),w.displayName=f(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,f(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},A(O.prototype),f(O.prototype,u,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new O(s(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(k),f(k,c,"Generator"),f(k,l,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,a){return l.type="throw",l.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],l=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;_(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),v}},t}function L(e,t,r,n,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void r(e)}l.done?t(u):Promise.resolve(u).then(n,a)}function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t,r){var a;return a=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(a)?a:String(a))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return l}}(e,t)||F(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(e,t):void 0}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var U=g.ATTACHMENT_PREVIEW_FILE_STATUS.INITIAL,W=g.ATTACHMENT_PREVIEW_FILE_STATUS.REQUEST_SUCCESS,z={download:"attachmentpanel.key0086",newTab:"attachmentpanel.key0097",printFile:"attachmentpanel.key0098"},H=!1,K=function(e,t,r){var n=document.getElementById(g.ATTACHMENT_PRINT_IFRAME);n||((n=document.createElement("iframe")).id=g.ATTACHMENT_PRINT_IFRAME,n.style.cssText="width:100%;height:100%;z-index:-1000000000;position:absolute;top:0"),r||(n.src=(0,m.appendParamsToUrl)(e,{model:t})),n.onload=function(){r&&(r=r.cloneNode(),n.contentWindow.document.body.appendChild(r)),n.contentWindow.print()},document.body.appendChild(n)};t.default=function(e){var t=(0,a.useContext)(h.SystemUIContext),r=t.uiData,n=t.close,_=B((0,a.useState)(!0),2),C=_[0],M=(_[1],B((0,a.useState)(null),2)),F=M[0],Y=M[1],G=(0,a.useRef)(),Q=(0,a.useRef)(),q=(0,a.useRef)(),Z=(0,a.useRef)(),V=r.model,J=r.files,X=r.attachmentPermission,$=r.activedIndex,ee=r.pageId,te=r.isOpenInNewTabByDirective,re=r.curEntryRow,ne=r.fromPanel,ae=B((0,a.useState)($),2),oe=ae[0],ie=ae[1],le=(0,a.useState)(J.map((function(e){var t=function(e){var t=(0,y.getAttachInfoFromRootConfig)(),r=t.previewType,n=void 0===r?g.PreviewByDefault:r,a=t.allowFileSuffix,o=void 0===a?[]:a,i=e.toLowerCase(),l=o.length>0?o.map((function(e){return e.toLowerCase()})):[].concat(D(g.ATTACHMENT_PREVIEW_IMG_TYPE),D(g.ATTACHMENT_PREVIEW_OFFICE),["pdf","txt"]);return[g.PreviewByCustom,g.PreviewByYunZhiJia].includes(n)&&l.includes(i)||n===g.PreviewByDefault&&g.ATTACHMENT_PREVIEW_EXCEL.includes(i)||(0,k.isPreviewByWps)(i)||(0,k.isPreviewByYozo)(i)||(0,k.isPreviewByKKFile)(i)||(0,k.isPreviewByOnlyOffice)(i)?U:W}(e.type);return j(j({},e),{},{loadStatus:t})}))),ue=B(le,2),ce=ue[0],fe=ue[1],se=ce[oe];if(se&&V&&(0,c.doGlobalDispatch)((0,d.attachOperationCount)(V,[{operationType:"preview",uid:[se.uid]}])),!H&&V){var de=(0,y.getAttachInfoFromRootConfig)(),pe=de.previewType,ye=de.wpsAppId,me=R(R(R(R(R(R(R({},g.PreviewByDefault,"default"),g.PreviewByCustom,"custom"),g.PreviewByOnlyOffice,"onlyoffice"),g.PreviewByPrivateWps,"privateWps"),g.PreviewByPublicWps,"publicWps"),g.PreviewByYozo,"Yozo"),g.PreviewByYunZhiJia,"yunzhijia")[pe];H=!0,(0,S.sendCtrlPropsEventTracking)({pageId:(null==V?void 0:V.pageId)||ee,controlId:"attachment_previewer",controlType:"attachment_previewer",controlName:(0,O.getLangMsg)({key:"Preview.key001"}),controlProp:I.trackingExtendCtrlProps.ATTACHMENT_PREVIEWER_TYPE,controlValue:ye?"new".concat(me.charAt(0).toUpperCase()).concat(me.slice(1)):me})}(0,a.useEffect)((function(){document.addEventListener("click",ve),document.addEventListener("keydown",ge);var e=((0,E.getData)(P.KEY_FORBIDDEN_CODE)||(0,u.List)()).push(T.KEYS.ESC);return(0,E.setData)(P.KEY_FORBIDDEN_CODE,e),function(){document.removeEventListener("click",ve),document.removeEventListener("keydown",ge);var e=((0,E.getData)(P.KEY_FORBIDDEN_CODE)||(0,u.List)()).filter((function(e){return e!==T.KEYS.ESC}));(0,E.setData)(P.KEY_FORBIDDEN_CODE,e)}}),[]),(0,a.useEffect)((function(){if(r&&r.model){var e,t=r.model.pageId,n=(0,b.getPageData)(t,[v.HANDLE_SPLIT_SCREEN_FILE]);if(n)Y(null===(e=n.container)||void 0===e?void 0:e.querySelector("[data-container-key=renderContainer]"))}}),[r]),(0,a.useEffect)((function(){return function(){var e=document.getElementById(g.ATTACHMENT_PRINT_IFRAME);e&&document.body.removeChild(e)}}),[]),(0,a.useEffect)((function(){void 0===Z.current&&(Z.current=(0,k.getPreviewLimitSize)())}),[]);var he=function(){F||te||n&&n()},ve=function(e){(G.current&&e.target===G.current||Q.current&&e.target===Q.current)&&!te&&he()},ge=function(e){e.keyCode!==T.KEYS.ESC||te||he()},we=(0,a.useCallback)((function(){n&&n()}),[]),be=function(){var e,t=(e=x().mark((function e(){var t,r,n,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(se){e.next=2;break}return e.abrupt("return");case 2:if(!X||X.download){e.next=4;break}return e.abrupt("return",Pe("printFile"));case 4:if(!(0,k.isPreviewByYozo)(se.type)||!se.realPreviewUrl){e.next=8;break}return null==(t=document.querySelector('iframe[src="'.concat(se.realPreviewUrl,'"]')))||t.contentWindow.print(),e.abrupt("return");case 8:if(r=se.realPreviewUrl||se.previewurl,n=(0,k.isCrossTenant)(null==V?void 0:V.pageId)?se.previewFilePath:se.previewurl,!((0,k.isUpperCaseTypePreviewByWps)(se.type)||(0,k.isExcelPreviewByType)(se.type,g.PreviewByOnlyOffice)||(0,k.isExcelPreviewByType)(se.type,g.PreviewByDefault))){e.next=17;break}if(se.realPreviewUrl){e.next=17;break}return e.next=14,p.default.getApi((0,m.appendParamsToUrl)(n,{model:V}));case 14:return"success"===(a=e.sent).status&&a.url?K(a.url,V):(0,A.setDataMessages)((0,A.getRootPageId)()((0,c.getGlobalState)()),[{duration:3e3,content:a.description||(0,O.getLangMsg)({key:"attachmentpanel.key0102"}),type:v.AlertType.ERROR}]),e.abrupt("return");case 17:"tif"===se.type&&(o=document.querySelector('[data-image-src="'.concat((0,m.appendParamsToUrl)(n,{model:V}),'"]'))),K(r,V,o);case 19:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){L(o,n,a,i,l,"next",e)}function l(e){L(o,n,a,i,l,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),Ee=function(){if(X&&!X.download)return Pe("newTab");var e=ce.map((function(e){return e.uid})),t=null;ne&&(t=ce.map((function(e){return{uid:e.uid,previewurl:e.previewurl,size:e.size,name:e.name,url:e.url,status:e.status,attPkId:e.attPkId,type:e.type,onlyOfficeDownloadUrl:e.onlyOfficeDownloadUrl}})));var r=(0,l.isNumber)(re)?[{curEntryRow:re,activedIndex:oe,sortedUids:e,panelData:t}]:[{activedIndex:oe,sortedUids:e,panelData:t}],a=null!=V?V:{pageId:(0,A.getRootPageId)()};(0,c.doGlobalDispatch)((0,d.previewInNewTab)(a,r)),null==n||n()},Pe=function(e){var t=(0,c.getGlobalState)();if("download"===e&&V){var r=V.key,n=V.pageId,a=(0,b.getPageData)(n,[r,g.ATTACHMENT_PERMISSION_MSG]);return(0,A.setDataMessages)((0,A.getRootPageId)()(t),[{duration:3e3,content:a.download,type:v.AlertType.ERROR}])}var o=(null==V?void 0:V.pageId)||ee;"bos_entryattach_upload"===(0,A.getFormId)(o)(t)&&(o=(0,A.getParentPage)(o)(t)),(0,A.setDataMessages)((0,A.getRootPageId)()(t),[{duration:3e3,content:(0,O.getLangMsg)({key:z[e],variables:{formCaption:(0,A.getFormCaption)(o)(t)}}),type:v.AlertType.ERROR}])},Te=(0,a.useCallback)((function(){if(X&&!X.download)return Pe("download");V&&(0,c.doGlobalDispatch)((0,d.attachOperationCount)(V,[{operationType:"download",uid:[se.uid]}]));var e=(0,k.isCrossTenant)(null==V?void 0:V.pageId)?se.downloadFilePath:se.url,t=(0,m.appendParamsToUrl)(e,{model:V}),r=(0,m.getRequestParams)(V,{fileName:se.name});se&&(0,k.downloadFile)(t,r)}),[se]),ke=(0,i.default)(w.default["content-btn"],w.default["content-btn-left"],R(R(R({},w.default.hide,0===oe),w.default["left-btn-hide-animation"],!C),w.default["left-btn-show-animation"],C)),Ae=(0,i.default)(w.default["content-btn"],w.default["content-btn-right"],R(R(R({},w.default.hide,oe===ce.length-1),w.default["right-btn-hide-animation"],!C),w.default["right-btn-show-animation"],C)),Oe=(0,a.useMemo)((function(){var e=ce[oe];if(e){var t=e.type.toLowerCase(),r=(0,y.getAttachInfoFromRootConfig)(),n=r.previewType,a=r.allowFileSuffix,o=void 0===a?[]:a,i=r.wpsAppId,l=["txt","text/plain","pdf"].concat(D(g.ATTACHMENT_PREVIEW_OFFICE),D(g.ATTACHMENT_PREVIEW_IMG_TYPE)),u=n===g.PreviewByDefault&&!l.includes(t),c=[g.PreviewByYunZhiJia,g.PreviewByYozo,g.PreviewByCustom].includes(n),f=[g.PreviewByPublicWps,g.PreviewByPrivateWps].includes(n)&&!i&&g.WPS_FILE.includes(t),s=n===g.PreviewByPublicWps&&i&&!g.ATTACHMENT_PREVIEW_IMG_TYPE.includes(t),d=(0,k.isPreviewByKKFile)(t),p=u||c||f||s,m=e.visible&&"1"!==e.visible[1],h=m||p||"error"===e.status||e.excelData||(0,N.isDdWindowDesktop)()||d,v=m||"error"===e.status,w=te,b=m||te;if(o.length>0)b=!o.map((function(e){return e.toLowerCase()})).includes(t);else(!e.previewurl||Z.current>0&&e.size>Z.current||!l.includes(t))&&(b=!0);return{file:e,hideCloseBtn:w,hideDownloadBtn:v,hideNewTabBtn:b,hidePrintBtn:h,previewLimitSize:Z.current,close:we,download:Te,openNewTab:Ee,print:be}}}),[ce,oe,te]);return o.default.createPortal(a.default.createElement("div",{className:(0,i.default)("kd-cq-popup kd-cq-attachment-previewer-popup",w.default.preview,R({},w.default["preview-splitScreen"],F)),id:"attachmentPreviewEle"},!F&&a.default.createElement(s.default,Oe),a.default.createElement("div",{className:(0,i.default)(w.default.container),ref:G},a.default.createElement("div",{className:ke,onClick:function(e){oe<=0||ie((function(e){return e-1}))}},a.default.createElement("i",{className:(0,i.default)(w.default["handle-icons"],"kdfont kdfont-qianfan")})),a.default.createElement("div",{className:w.default["inner-container"],ref:Q},a.default.createElement(f.default,{ref:q,model:V,files:ce,activedIndex:oe,pageId:ee,onLoad:function(e){var t=ce[e];t.loadStatus!==g.ATTACHMENT_PREVIEW_FILE_STATUS.LOAD_SUCCESS&&fe((function(r){return r[e]=j(j({},t),{},{loadStatus:g.ATTACHMENT_PREVIEW_FILE_STATUS.LOAD_SUCCESS}),r}))},onClose:function(){he()},updateFile:function(e,t){fe((function(r){var n=(0,l.cloneDeep)(r);return n[t]=e,n}))},hasPermission:function(e){return!(X&&!X[e])||(Pe("download"),!1)},previewLimitSize:Z.current,showNotification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,A.setDataMessages)((0,A.getRootPageId)()((0,c.getGlobalState)()),[{duration:3e3,content:e,type:v.AlertType.ERROR}])}})),a.default.createElement("div",{className:Ae,onClick:function(e){oe!==ce.length-1&&ie((function(e){return e+1}))}},a.default.createElement("i",{className:(0,i.default)(w.default["handle-icons"],"kdfont kdfont-houfan")})))),F||document.body)}},238807:function(e,t,r){"use strict";r(697060),r(743924),r(606200),r(78504),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(360776),r(205960),r(721300),r(846428),r(387912),r(633768),r(513640),r(137984);var n=c(r(795520)),a=c(r(671252)),o=r(331428),i=r(248672),l=r(786392),u=c(r(713564));function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function s(e,t,r){var n;return n=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==f(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=n.default.memo((function(e){var t,r=e.file,c=e.hideCloseBtn,f=e.hidePrintBtn,d=e.hideDownloadBtn,p=e.hideNewTabBtn,y=e.print,m=e.download,h=e.close,v=e.openNewTab,g=e.isSplitScreen;return n.default.createElement("div",{className:(0,a.default)("kd-cq-attachment-previewer-header",u.default.header,s({},u.default["header-splitScreen"],g))},n.default.createElement("div",{className:(0,a.default)(u.default["header-left"])},n.default.createElement("span",{className:(0,a.default)(u.default["header-text"]),dangerouslySetInnerHTML:{__html:null===(t=r&&r.name)||void 0===t?void 0:t.replaceAll(" ","&nbsp;")}}),n.default.createElement("span",{className:(0,a.default)(u.default["file-size"])},r&&(0,l.formatFileSize)(r.size))),n.default.createElement("div",{className:u.default["header-right"]},n.default.createElement("div",{id:i.ATTACHMENT_PREVIEW_BY_NEW_TAB,className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,p)),onClick:v},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-wangye")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0054"}))),n.default.createElement("div",{className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,f)),onClick:y},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-dayin")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0059"}))),n.default.createElement("div",{className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,d)),onClick:m},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-xiazai2")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0026"}))),n.default.createElement("div",{className:(0,a.default)(u.default["header-btn"],s({},u.default.hide,c)),onClick:h},n.default.createElement("i",{className:(0,a.default)(u.default.icons,"kdfont kdfont-guanbi6")}),n.default.createElement("span",{className:(0,a.default)(u.default["header-text"])},(0,o.getLangMsg)({key:"attachmentpanel.key0060"})))))}));t.default=d},353168:function(e,t,r){"use strict";r(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.default.createElement("li",{className:o.default["list-item"]},n.default.createElement(n.default.Fragment,null,n.default.createElement(a.default,null)))};var n=i(r(795520)),a=i(r(127360)),o=i(r(713564));function i(e){return e&&e.__esModule?e:{default:e}}},153504:function(e,t,r){"use strict";r(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n.default.createElement("li",{className:i.default["list-item"]},n.default.createElement(a.default,{title:(0,o.getLangMsg)({key:"attachmentpanel.key0055"})}))};var n=l(r(795520)),a=l(r(250864)),o=r(331428),i=l(r(713564));function l(e){return e&&e.__esModule?e:{default:e}}},250864:function(e,t,r){"use strict";r(697060),r(743924),r(606200),r(78504),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(182320),r(909112),r(360776),r(205960),r(846428),r(387912);var n=l(r(795520)),a=l(r(671252)),o=l(r(713564)),i=l(r(272628));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t,r){var n;return n=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==u(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=function(e){var t=e.visible,r=void 0===t||t,l=e.title,u=e.btnText,f=e.onClick;return n.default.createElement("div",{className:(0,a.default)(o.default["alert-container"],c({},o.default.hide,!r))},n.default.createElement("img",{className:(0,a.default)(o.default["alert-img"]),src:i.default,alt:"预览"}),n.default.createElement("p",{className:(0,a.default)(o.default["alert-title"])},l||""),n.default.createElement("a",{className:(0,a.default)(o.default["alert-btn"]),onClick:function(){return f&&f()}},u||""))}},272628:function(e){e.exports="data:image/png;base64,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"}}]);