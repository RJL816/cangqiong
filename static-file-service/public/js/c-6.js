"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[6636],{

/***/ "./src/action/actionname/control/codeEditor/server/index.js":
/*!******************************************************************!*\
  !*** ./src/action/actionname/control/codeEditor/server/index.js ***!
  \******************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.CODE_EDIT_EDITOR_UPDATE_HINTS = exports.CODE_EDIT_EDITOR_SET_HINTS = exports.CODE_EDIT_EDITOR_INSERT_TEXT = void 0;\n/**\n  * showdoc\n  * @catalog 控件指令/代码编辑器/服务端\n  * @title 光标处插入内容\n  * @description 代码编辑器在光标处插入内容\n  * @ctrl_type 代码编辑器\n  * @method insertText\n  * @platform PC\n  * @eg {\"p\":[{\"key\":\"ctrlKey\",\"methodname\":\"insertText\",\"args\":[\"12345678903\"]}\n  * @eg_p key string 代码编辑器控件key\n  * @eg_p args Array 插入内容列表，该列表只有一个元素\n  * @version 1.0.0\n  */\nvar CODE_EDIT_EDITOR_INSERT_TEXT = exports.CODE_EDIT_EDITOR_INSERT_TEXT = 'insertText';\n\n/**\n  * showdoc\n  * @catalog 控件指令/代码编辑器/服务端\n  * @title 设置自定义提示\n  * @description 代码编辑器设置自定义提示\n  * @ctrl_type 代码编辑器\n  * @method setHints\n  * @platform PC\n  * @eg {\"p\":[{\"key\":\"ctrlKey\",\"methodname\":\"setHints\",\"args\":[]}\n  * @eg_p key string 代码编辑器控件key\n  * @eg_p args Array 自定义提示内容列表\n  * @version 1.0.0\n  */\nvar CODE_EDIT_EDITOR_SET_HINTS = exports.CODE_EDIT_EDITOR_SET_HINTS = 'setHints';\n\n/**\n  * showdoc\n  * @catalog 控件指令/代码编辑器/服务端\n  * @title 更新自定义提示\n  * @description 代码编辑器更新自定义提示\n  * @ctrl_type 代码编辑器\n  * @method setHints\n  * @platform PC\n  * @eg {\"p\":[{\"key\":\"ctrlKey\",\"methodname\":\"updateHints\",\"args\":[]}\n  * @eg_p key string 代码编辑器控件key\n  * @eg_p args Array 更新的自定义提示内容列表\n  * @version 1.0.0\n  */\nvar CODE_EDIT_EDITOR_UPDATE_HINTS = exports.CODE_EDIT_EDITOR_UPDATE_HINTS = 'updateHints';\n\n//# sourceURL=webpack://bos-platform/./src/action/actionname/control/codeEditor/server/index.js?");

/***/ }),

/***/ "./src/action/actionname/control/newCodeEditor/client/index.js":
/*!*********************************************************************!*\
  !*** ./src/action/actionname/control/newCodeEditor/client/index.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.GET_CODE_EDITOR_MODULES = exports.CODE_EDITOR_SEND_DEBUG_PROTOCOL = exports.CODE_EDITOR_LIST_MODULE_EXPORTS = exports.CODE_EDITOR_GET_GPT_CONFIG = exports.CODE_EDITOR_GET_FRAGMENT_TREE = exports.CODE_EDITOR_GET_FRAGMENT = exports.CODE_EDITOR_GET_CONFIG = exports.CODE_EDITOR_ACTION_SAVE = exports.CODE_EDITOR_ACTION = void 0;\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 获取KD代码编辑器依赖的modules\n * @description 获取KD代码编辑器依赖的modules\n * @ctrl_type 新代码编辑器\n * @method requestModule\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"requestModule\",\"args\":[{\"modules\":[]}],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\nvar GET_CODE_EDITOR_MODULES = exports.GET_CODE_EDITOR_MODULES = 'requestModule';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 代码编辑器同后端交互行为\n * @description 代码编辑器同后端交互行为， 保存代码，模块导出等。\n * @ctrl_type 新代码编辑器\n * @method requestModule\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"codeEditorAction\",\"args\":[\"listModuleExports\",{\"modules\":[]}],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\nvar CODE_EDITOR_ACTION = exports.CODE_EDITOR_ACTION = 'codeEditorAction';\n\n// 代码编辑器行为集合\nvar CODE_EDITOR_ACTION_SAVE = exports.CODE_EDITOR_ACTION_SAVE = 'saveCodeEditorCont';\nvar CODE_EDITOR_LIST_MODULE_EXPORTS = exports.CODE_EDITOR_LIST_MODULE_EXPORTS = 'listModuleExports';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 获取代码编辑器配置\n * @description 获取代码编辑器配置\n * @ctrl_type 新代码编辑器\n * @method getCodeEditorConfig\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"getCodeEditorConfig\",\"args\":[],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\nvar CODE_EDITOR_GET_CONFIG = exports.CODE_EDITOR_GET_CONFIG = 'getCodeEditorConfig';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 获取和设置脚本编辑器gpt配置\n * @description 获取和设置脚本编辑器gpt配置\n * @ctrl_type 新代码编辑器\n * @method getCodeEditorGptConfig\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"getCodeEditorGptConfig\",\"args\":[],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\nvar CODE_EDITOR_GET_GPT_CONFIG = exports.CODE_EDITOR_GET_GPT_CONFIG = 'getCodeEditorGptConfig';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 脚本编辑器发送调试协议\n * @description 脚本编辑器发送调试协议\n * @ctrl_type 脚本编辑器发送调试协议\n * @method sendCodeEditorDebugProtocol\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"sendCodeEditorDebugProtocol\",\"args\":[{\"debugId\":\"debugid\",\"cid\":\"1\",\"method\":\"Debugger.prepare\",\"params\":{\"enginePoolName\":\"COSMIC_PLUGIN\",\"scriptPaths\":[\"@cosmic/kdtest_panan-kdtest/kdtest_table_test/231324\"]}}],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\n\nvar CODE_EDITOR_SEND_DEBUG_PROTOCOL = exports.CODE_EDITOR_SEND_DEBUG_PROTOCOL = 'sendCodeEditorDebugProtocol';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 获取脚本编辑器代码片段树\n * @description 获取脚本编辑器代码片段树\n * @ctrl_type 新代码编辑器\n * @method getCodeEditorFragmentTree\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"getCodeEditorFragmentTree\",\"args\":[],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author wanhang_huang\n */\nvar CODE_EDITOR_GET_FRAGMENT_TREE = exports.CODE_EDITOR_GET_FRAGMENT_TREE = 'getCodeEditorFragmentTree';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/客户端\n * @title 获取脚本编辑器指定代码片段详细内容\n * @description 获取脚本编辑器指定代码片段详细内容\n * @ctrl_type 新代码编辑器\n * @method getCodeEditorFragment\n * @platform PC\n * @eg [{\"key\":\"kingscripteditap\",\"methodName\":\"getCodeEditorFragment\",\"args\":[],\"postData\":[{},[]]}]\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author wanhang_huang\n */\nvar CODE_EDITOR_GET_FRAGMENT = exports.CODE_EDITOR_GET_FRAGMENT = 'getCodeEditorFragment';\n\n//# sourceURL=webpack://bos-platform/./src/action/actionname/control/newCodeEditor/client/index.js?");

/***/ }),

/***/ "./src/action/actionname/control/newCodeEditor/server/index.js":
/*!*********************************************************************!*\
  !*** ./src/action/actionname/control/newCodeEditor/server/index.js ***!
  \*********************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.SET_CODE_EDITOR_MODULES = exports.CODE_EDITOR_SET_MODULE_EXPORTS = exports.CODE_EDITOR_SET_GPT_CONFIG = exports.CODE_EDITOR_SET_FRAGMENT_TREE = exports.CODE_EDITOR_SET_FRAGMENT = exports.CODE_EDITOR_SET_CONFIG = exports.CODE_EDITOR_GPT_RESPONSE = exports.CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE = void 0;\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 设置后端返回的modules\n * @description 设置后端返回的modules\n * @ctrl_type 新代码编辑器\n * @method setCodeEditorModules\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"setCodeEditorModules\", \"args\": [ [ \"/serverscript/getScript.do?path=xxxx/xxxx/xxxx/xxxx\" ] ] } ], \"a\": \"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @eg_p args[0] array 模块路径合集\n * @version 1.0.0\n * @author an_pan\n */\nvar SET_CODE_EDITOR_MODULES = exports.SET_CODE_EDITOR_MODULES = 'setCodeEditorModules';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 设置代码编辑器配置\n * @description 设置代码编辑器配置\n * @ctrl_type 新代码编辑器\n * @method setCodeEditorConfig\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"setCodeEditorConfig\", \"args\": [ [ { \"scriptPath\": \"@cosmic/kdtest_panan-kdtest/kdtest_table_test/231324.ts\", \"editEnable\": true, \"debugEnable\": true, \"scriptCode\": \"231324\", \"scriptName\": \"123123\" } ] ] } ], \"a\": \"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\n\nvar CODE_EDITOR_SET_CONFIG = exports.CODE_EDITOR_SET_CONFIG = 'setCodeEditorConfig';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 设置后端返回 Gpt 智能提示\n * @description 设置后端返回 Gpt 智能提示\n * @ctrl_type 新代码编辑器\n * @method setCodeEditorGptConfig\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"setCodeEditorGptConfig\", \"args\": [ [ { \"gptEnable\": false, \"codeGenTips\": [ { \"tips\": \"单据新增分录行后，设置付款日期。\", \"id\": 1807319641656131600 } ] } ] ] } ], \"a\": \"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\nvar CODE_EDITOR_SET_GPT_CONFIG = exports.CODE_EDITOR_SET_GPT_CONFIG = 'setCodeEditorGptConfig';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 向脚本编辑器响应调试\n * @description 向脚本编辑器响应调试\n * @ctrl_type 新代码编辑器\n * @method codeEditorDebugProtocolResponse\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"codeEditorDebugProtocolResponse\", \"args\": [ { \"debugId\": 1706191551276, \"isDebugSave\": true, \"cid\": \"0\", \"method\": \"Debugger.beforePrepare\" } ] } ], \"a\": \"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\n\nvar CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE = exports.CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE = 'codeEditorDebugProtocolResponse';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 设置脚本编辑器代码片段树数据\n * @description 设置脚本编辑器代码片段树数据\n * @ctrl_type 新代码编辑器\n * @method setCodeEditorFragmentTree\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"setCodeEditorFragmentTree\", \"args\": [[{ title: '代码标签', key: '2132', type: 0, children: [{ title: '代码片段', key: '2221', type: 1 }] }]], \"a\": \"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author wanhang_huang\n */\n\nvar CODE_EDITOR_SET_FRAGMENT_TREE = exports.CODE_EDITOR_SET_FRAGMENT_TREE = 'setCodeEditorFragmentTree';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 向脚本编辑器响应指定的代码片段详细内容\n * @description 向脚本编辑器响应指定的代码片段详细内容\n * @ctrl_type 新代码编辑器\n * @method setCodeEditorFragment\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"setCodeEditorFragment\", \"args\": [ { id: '123123', data: 'const a = 1' } ] } ], \"a\": \"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @version 1.0.0\n * @author an_pan\n */\n\nvar CODE_EDITOR_SET_FRAGMENT = exports.CODE_EDITOR_SET_FRAGMENT = 'setCodeEditorFragment';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title 设置kd脚本依赖导出类\n * @description 设置kd脚本依赖导出类，支持检索未定义参数是否属于kd脚本依赖导出类\n * @ctrl_type 新代码编辑器\n * @method setModuleExports\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"setModuleExports\", \"args\": [ \"modules exports string\" ] } ],\"a\":\"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @eg_p args[0] string 导出的模块代码的jsonstring后的字符串\n * @version 1.0.0\n * @author an_pan\n */\n\nvar CODE_EDITOR_SET_MODULE_EXPORTS = exports.CODE_EDITOR_SET_MODULE_EXPORTS = 'setModuleExports';\n\n/**\n * showdoc\n * @catalog 控件指令/新代码编辑器/服务端\n * @title ai机器人对问题响应回答信息\n * @description ai机器人对问题响应回答信息\n * @ctrl_type 新代码编辑器\n * @method sendEditorGptData\n * @platform PC\n * @eg { \"p\": [ { \"key\": \"kingscripteditap\", \"methodname\": \"sendEditorGptData\", \"args\": [{ data: \"gptResultData\", isEnd: false, cid: '当次问答客户端id', tips: [\"继续提问1\", \"继续提问2\"] }] } ],\"a\":\"InvokeControlMethod\" }\n * @eg_p key string 控件的标识\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @eg_p args[0] string 导出的模块代码的jsonstring后的字符串\n * @version 1.0.0\n * @author an_pan\n */\nvar CODE_EDITOR_GPT_RESPONSE = exports.CODE_EDITOR_GPT_RESPONSE = 'sendEditorGptData';\n\n//# sourceURL=webpack://bos-platform/./src/action/actionname/control/newCodeEditor/server/index.js?");

/***/ }),

/***/ "./src/action/actionname/control/weboffice/server/index.js":
/*!*****************************************************************!*\
  !*** ./src/action/actionname/control/weboffice/server/index.js ***!
  \*****************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.WEB_OFFICE_ACTION = void 0;\n/**\n * showdoc\n * @catalog 控件指令/weboffice/服务端\n * @title weboffice控件指令集合体\n * @description weboffice控件指令集合体\n * @ctrl_type weboffice\n * @method webOfficeAction\n * @platform PC\n * @eg {\"p\":[{\"key\":\"weboffice\",\"args\":[{data: []}],'methodname': \"webOfficeAction\"}],\"a\":\"InvokeControlMethod\"}\n * @eg_p key string 控件key\n * @eg_p methodname string 方法名\n * @eg_p args array 参数列表\n * @eg_p_args_title args参数说明\n * @eg_p_args data object 指令名以及指令参数\n * @version 6.0.0\n * @author shuo_jin\n */\nvar WEB_OFFICE_ACTION = exports.WEB_OFFICE_ACTION = 'webOfficeAction';\n\n//# sourceURL=webpack://bos-platform/./src/action/actionname/control/weboffice/server/index.js?");

/***/ }),

/***/ "./src/action/codeEditorAction.js":
/*!****************************************!*\
  !*** ./src/action/codeEditorAction.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.getCodeEditorConfig = getCodeEditorConfig;\nexports.getCodeEditorFragment = getCodeEditorFragment;\nexports.getCodeEditorFragmentTree = getCodeEditorFragmentTree;\nexports.getCodeEditorModules = getCodeEditorModules;\nexports.getEditorGptConfig = getEditorGptConfig;\nexports.getEditorGptData = getEditorGptData;\nexports.listModuleExports = listModuleExports;\nexports.sendCodeEditorDebugProtocol = sendCodeEditorDebugProtocol;\nexports.triggerSaveShortCut = triggerSaveShortCut;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\nvar action = _interopRequireWildcard(__webpack_require__(/*! ./actionWithSingle */ \"./src/action/actionWithSingle.js\"));\nvar _client = __webpack_require__(/*! @/action/actionname/control/newCodeEditor/client */ \"./src/action/actionname/control/newCodeEditor/client/index.js\");\nvar _appModelFunction = __webpack_require__(/*! ../model/appModelFunction */ \"./src/model/appModelFunction.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction getCodeEditorModules(model) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    action.invokeControlService(model, _client.GET_CODE_EDITOR_MODULES, args, post, dispatch);\n  };\n}\nfunction triggerSaveShortCut(model) {\n  var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    isDebugSave: false\n  };\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    var _args = [_client.CODE_EDITOR_ACTION_SAVE, args];\n    action.invokeControlService(model, _client.CODE_EDITOR_ACTION, _args, post, dispatch);\n  };\n}\nfunction getEditorGptData(model, gptType, content, cid) {\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    var _args = [gptType, {\n      content: content,\n      cid: cid\n    }];\n    action.invokeControlService(model, _client.CODE_EDITOR_ACTION, _args, post, dispatch);\n  };\n}\nfunction getEditorGptConfig(model) {\n  for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    args[_key2 - 1] = arguments[_key2];\n  }\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    action.invokeControlService(model, _client.CODE_EDITOR_GET_GPT_CONFIG, args, post, dispatch);\n  };\n}\nfunction listModuleExports(model) {\n  for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    args[_key3 - 1] = arguments[_key3];\n  }\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    var _args = [_client.CODE_EDITOR_LIST_MODULE_EXPORTS].concat(args);\n    action.invokeControlService(model, _client.CODE_EDITOR_ACTION, _args, post, dispatch);\n  };\n}\nfunction sendCodeEditorDebugProtocol(model, request) {\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    var _args = [request];\n    action.invokeControlService(model, _client.CODE_EDITOR_SEND_DEBUG_PROTOCOL, _args, post, dispatch);\n  };\n}\nfunction getCodeEditorConfig(model) {\n  for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    args[_key4 - 1] = arguments[_key4];\n  }\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    action.invokeControlService(model, _client.CODE_EDITOR_GET_CONFIG, args, post, dispatch);\n  };\n}\nfunction getCodeEditorFragmentTree(model) {\n  for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n    args[_key5 - 1] = arguments[_key5];\n  }\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    action.invokeControlService(model, _client.CODE_EDITOR_GET_FRAGMENT_TREE, args, post, dispatch);\n  };\n}\nfunction getCodeEditorFragment(model) {\n  for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n    args[_key6 - 1] = arguments[_key6];\n  }\n  return function (dispatch, getState) {\n    var post = (0, _appModelFunction.getPost)(model.pageId)(getState());\n    action.invokeControlService(model, _client.CODE_EDITOR_GET_FRAGMENT, args, post, dispatch);\n  };\n}\n\n//# sourceURL=webpack://bos-platform/./src/action/codeEditorAction.js?");

/***/ }),

/***/ "./src/action/webofficeaction.js":
/*!***************************************!*\
  !*** ./src/action/webofficeaction.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.beforeClose = void 0;\nexports.getOfficeToken = getOfficeToken;\nexports.sendValiResult = exports.save = void 0;\nvar proxy = _interopRequireWildcard(__webpack_require__(/*! ../proxy/formproxy */ \"./src/proxy/formproxy.js\"));\nvar _ajaxState = __webpack_require__(/*! ../api/ajaxState */ \"./src/api/ajaxState.js\");\nvar action = _interopRequireWildcard(__webpack_require__(/*! ./action */ \"./src/action/action.js\"));\nvar _appModelFunction = __webpack_require__(/*! ../model/appModelFunction */ \"./src/model/appModelFunction.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\n/**\n * 调试指令\n * spyApi.doPostActions(\"pageId\",'InvokeControlMethod',[{args: [ {data:{'name':'11', 'url':'http://www.officectrl.com/officecs/temp/file1.doc','uploadUrl':'https://feature.kingdee.com:2024/devbos/attachment/uploadFile.do'}, 'event':''} ], key: \"webofficeap\", methodname: \"open\"}])\n * spyApi.doPostActions(\"pageId\",'InvokeControlMethod',[{args: [ {data:{'name':'11', 'url':'http://www.officectrl.com/officecs/temp/file1.doc','uploadUrl':'https://feature.kingdee.com:2024/devbos/attachment/uploadFile.do'}, 'event':'openNew'} ], key: \"webofficeap\", methodname: \"webOfficeAction\"}])\n */\n\n// 前端返回文档保存路径、文件名给后端\nvar save = exports.save = function save(model) {\n  var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return function (dispatch, getState) {\n    var requestKey = (0, _ajaxState.makeAjaxKey)(model.pageId, model.key, 'upload');\n    proxy.disableDisposeAction(requestKey);\n    action.invokeControlService(model, 'upload', args, (0, _appModelFunction.getPost)(model.pageId)(getState()), dispatch);\n    proxy.allowDisposeAction(requestKey);\n  };\n};\n\n// 前端发送变量校验结果给后端\nvar sendValiResult = exports.sendValiResult = function sendValiResult(model) {\n  var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return function (dispatch, getState) {\n    var requestKey = (0, _ajaxState.makeAjaxKey)(model.pageId, model.key, 'reportData');\n    proxy.disableDisposeAction(requestKey);\n    action.invokeControlService(model, 'reportData', args, (0, _appModelFunction.getPost)(model.pageId)(getState()), dispatch);\n    proxy.allowDisposeAction(requestKey);\n  };\n};\nvar beforeClose = exports.beforeClose = function beforeClose(model) {\n  var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return function (dispatch, getState) {\n    action.invokeControlService(model, 'afterClose', args, (0, _appModelFunction.getPost)(model.pageId)(getState()), dispatch);\n  };\n};\n\n/**\n * 请求wps/onlyoffice token\n * @param {object} model model\n * @param {Array} args 参数\n * @returns\n */\nfunction getOfficeToken(model) {\n  var args = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return function (dispatch, getState) {\n    var requestKey = (0, _ajaxState.makeAjaxKey)(model.pageId, model.key, 'getOfficeToken');\n    proxy.disableDisposeAction(requestKey);\n    action.invokeControlService(model, 'getOfficeToken', args, (0, _appModelFunction.getPost)(model.pageId)(getState()), dispatch);\n    proxy.allowDisposeAction(requestKey);\n  };\n}\n\n// export const afterOperation = (model, args = []) => {\n//   return (dispatch, getState) => {\n//     const requestKey = makeAjaxKey(model.pageId, model.key, 'afterOperation')\n//     proxy.disableDisposeAction(requestKey)\n//     action.invokeControlService(\n//       model,\n//       'afterOperation',\n//       args,\n//       getPost(model.pageId)(getState()),\n//       dispatch\n//     )\n//     proxy.allowDisposeAction(requestKey)\n//   }\n// }\n\n//# sourceURL=webpack://bos-platform/./src/action/webofficeaction.js?");

/***/ }),

/***/ "./src/component/common/ChangeThemeWrap.js":
/*!*************************************************!*\
  !*** ./src/component/common/ChangeThemeWrap.js ***!
  \*************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.themeMap = exports.ChangeThemeWrap = void 0;\n__webpack_require__(/*! core-js/modules/es.array.find.js */ \"../../node_modules/core-js/modules/es.array.find.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; } /*\n 添加暗黑主题切换监听\n */\nvar themeMap = exports.themeMap = {\n  dark: 'dark',\n  light: 'light'\n};\nvar ChangeThemeWrap = exports.ChangeThemeWrap = function ChangeThemeWrap(WrapComponent) {\n  return function (props) {\n    var _htmlNode$dataset;\n    var htmlNode = document.documentElement;\n    var _useState = (0, _react.useState)((htmlNode === null || htmlNode === void 0 || (_htmlNode$dataset = htmlNode.dataset) === null || _htmlNode$dataset === void 0 ? void 0 : _htmlNode$dataset.darkreaderScheme) === themeMap.dark ? themeMap.dark : themeMap.light),\n      _useState2 = _slicedToArray(_useState, 2),\n      theme = _useState2[0],\n      setTheme = _useState2[1];\n    (0, _react.useEffect)(function () {\n      var config = {\n        attributeFilter: ['data-darkreader-scheme'],\n        attributes: true\n      };\n      var callback = function callback(mutations) {\n        var _iterator = _createForOfIteratorHelper(mutations),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var mutation = _step.value;\n            if (mutation.type === 'attributes') {\n              var _targetData$target;\n              var targetData = mutations.find(function (d) {\n                return d.attributeName === 'data-darkreader-scheme';\n              });\n              if (((_targetData$target = targetData.target) === null || _targetData$target === void 0 || (_targetData$target = _targetData$target.dataset) === null || _targetData$target === void 0 ? void 0 : _targetData$target.darkreaderScheme) === themeMap.dark) {\n                setTheme(themeMap.dark);\n              } else {\n                setTheme(themeMap.light);\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      };\n      var observer = new window.MutationObserver(callback);\n      observer.observe(htmlNode, config);\n      return function () {\n        observer.disconnect();\n      };\n    }, []);\n    return /*#__PURE__*/_react[\"default\"].createElement(WrapComponent, _extends({}, props, {\n      theme: theme\n    }));\n  };\n};\n\n//# sourceURL=webpack://bos-platform/./src/component/common/ChangeThemeWrap.js?");

/***/ }),

/***/ "./src/component/web/KDAudio.jsx":
/*!***************************************!*\
  !*** ./src/component/web/KDAudio.jsx ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _react = _interopRequireDefault(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _classnames = _interopRequireDefault(__webpack_require__(/*! classnames */ \"../../node_modules/classnames/index.js\"));\nvar _Audio = _interopRequireDefault(__webpack_require__(/*! ./base/Audio */ \"./src/component/web/base/Audio.jsx\"));\nvar _componentutil = __webpack_require__(/*! ../../util/componentutil */ \"./src/util/componentutil.js\");\nvar _commonUtils = _interopRequireDefault(__webpack_require__(/*! ../common/commonUtils */ \"./src/component/common/commonUtils.js\"));\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _memoryCacher = __webpack_require__(/*! ../../model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _dec, _class;\n/**\n * 音频控件\n */\n// import styles from './KDAudio.less';\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nvar KDAudio = (_dec = (0, _VisibleLockWrap[\"default\"])(true), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = /*#__PURE__*/function (_React$Component) {\n  _inherits(KDAudio, _React$Component);\n  function KDAudio() {\n    var _this;\n    _classCallCheck(this, KDAudio);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, KDAudio, [].concat(_args));\n    _this.invokeControlMethods = function (events) {\n      events.forEach(function (event) {\n        var methodName = event.methodname,\n          args = event.args;\n        switch (methodName) {\n          case 'play':\n            if (_this._audioInstance) {\n              // 直接通过ref方式访问子组件内部方法\n              args[0] !== false ? _this._audioInstance.play && _this._audioInstance.play() : _this._audioInstance.pause && _this._audioInstance.pause();\n            } else {\n              console.warn('audio instance is undefined, invoke play method fail.');\n            }\n            break;\n          default:\n            console.info(\"\".concat(methodName, \" is not been implemented\"));\n            break;\n        }\n      });\n    };\n    return _this;\n  }\n  _createClass(KDAudio, [{\n    key: \"setRef\",\n    value:\n    // 获取音频示例\n    function setRef(_setRef) {\n      this._audioInstance = _setRef;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      /*\n        绑定音频播放、暂停操作的控件方法，eventBus实现\n        这些操作与UI渲染没有关系，不用更新store\n      */\n      var model = this.props.model;\n      var pageId = model.pageId,\n        key = model.key;\n      if (pageId !== undefined && key !== undefined) {\n        // 监听音频控件方法'play'调用,播放/暂停\n        this.removeDirectivesListener = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', function (pageData) {\n          if (pageData === undefined) {\n            return;\n          }\n          _this2.invokeControlMethods(pageData);\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.removeDirectivesListener && this.removeDirectivesListener();\n      this._audioInstance = null;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n      var model = this.props.model;\n      var style = Object.assign({}, (0, _componentutil.getCommonStyle)(model), this.props.style);\n      var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n        Grow = _getCommonClass.Grow,\n        Shrink = _getCommonClass.Shrink,\n        AlignSelf = _getCommonClass.AlignSelf;\n      var src = (0, _componentutil.getComponentDataProperty)(model, 'src', 'src', false); // 音频地址\n      var autoPlay = (0, _componentutil.getComponentDataProperty)(model, 'autoPlay', 'autoPlay', false); // 自动播放\n\n      var rootClassName = (0, _classnames[\"default\"])({\n        // [styles['root']]: true\n      }, (0, _commonUtils[\"default\"])({\n        Grow: Grow,\n        Shrink: Shrink,\n        AlignSelf: AlignSelf\n      }));\n\n      // test data\n      // src = \"http://v2v.cc/~j/theora_testsuite/320x240.ogg\";\n      // src = src||\"avedio111111.mp4\";\n      // src = 'audio111111.mp3';\n\n      // 隐藏后也可正常播放(目前测试的浏览器：chrome,safari)\n      return /*#__PURE__*/_react[\"default\"].createElement(_Audio[\"default\"], _extends({\n        ref: function ref(d) {\n          return _this3.setRef(d);\n        },\n        className: rootClassName,\n        style: style,\n        id: model.key,\n        src: src,\n        autoPlay: autoPlay\n      }, this.props.attachData));\n    }\n  }]);\n  return KDAudio;\n}(_react[\"default\"].Component)) || _class) || _class);\nvar _default = exports[\"default\"] = KDAudio;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDAudio.jsx?");

/***/ }),

/***/ "./src/component/web/KDClientAjax.js":
/*!*******************************************!*\
  !*** ./src/component/web/KDClientAjax.js ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _react = _interopRequireDefault(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _formservice = _interopRequireDefault(__webpack_require__(/*! ../../api/formservice */ \"./src/api/formservice.js\"));\nvar _clientajaxaction = __webpack_require__(/*! ../../action/clientajaxaction */ \"./src/action/clientajaxaction.js\");\nvar _ControlInfoCollect = _interopRequireDefault(__webpack_require__(/*! @/component/common/ControlInfoCollect */ \"./src/component/common/ControlInfoCollect.js\"));\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _dec, _class;\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nvar KDClientAjax = (_dec = (0, _VisibleLockWrap[\"default\"])(false), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = (0, _ControlInfoCollect[\"default\"])(_class = /*#__PURE__*/function (_React$Component) {\n  _inherits(KDClientAjax, _React$Component);\n  function KDClientAjax() {\n    var _this;\n    _classCallCheck(this, KDClientAjax);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, KDClientAjax, [].concat(_args));\n    _this.invokeControlMethods = function (events) {\n      events.forEach(function (event) {\n        var methodName = event.methodname,\n          args = event.args;\n        switch (methodName) {\n          case 'request':\n            {\n              var dispatch = _this.props.dispatch;\n              var _args$ = args[0],\n                data = _args$.data,\n                url = _args$.url,\n                type = _args$.type,\n                contentType = _args$.contentType,\n                _args$$withCredential = _args$.withCredentials,\n                withCredentials = _args$$withCredential === void 0 ? true : _args$$withCredential;\n              if (type === 'GET') {\n                _formservice[\"default\"].getApi(url).then(function (responseDate) {\n                  var model = _this.props.model;\n                  dispatch((0, _clientajaxaction.afterReceiveResponse)(model, responseDate));\n                });\n              } else {\n                if (contentType === 'json') {\n                  var loginfo = data.loginfo;\n                  if (loginfo) {\n                    var arr = loginfo.split('#!');\n                    data.user = arr[0];\n                    data.password = arr[1];\n                  }\n                  withCredentials && _formservice[\"default\"].postJsonApi(url, data).then(function (responseDate) {\n                    var model = _this.props.model;\n                    dispatch((0, _clientajaxaction.afterReceiveResponse)(model, responseDate));\n                  });\n                  !withCredentials && _formservice[\"default\"].postJsonApiWithOutCredentials(url, data).then(function (responseDate) {\n                    var model = _this.props.model;\n                    dispatch((0, _clientajaxaction.afterReceiveResponse)(model, responseDate));\n                  });\n                } else {\n                  _formservice[\"default\"].postApi(url, data).then(function (responseDate) {\n                    var model = _this.props.model;\n                    dispatch((0, _clientajaxaction.afterReceiveResponse)(model, responseDate));\n                  });\n                }\n              }\n            }\n            break;\n          default:\n            console.log(\"\".concat(methodName, \" is not been implemented\"));\n        }\n      });\n    };\n    return _this;\n  }\n  _createClass(KDClientAjax, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      var _this$props$model = this.props.model,\n        pageId = _this$props$model.pageId,\n        key = _this$props$model.key;\n      this.removeDirectivesListener = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', function (pageData) {\n        if (pageData === undefined) {\n          return;\n        }\n        _this2.invokeControlMethods(pageData);\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.removeDirectivesListener && this.removeDirectivesListener();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", null);\n    }\n  }]);\n  return KDClientAjax;\n}(_react[\"default\"].Component)) || _class) || _class) || _class);\nvar _default = exports[\"default\"] = KDClientAjax;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDClientAjax.js?");

/***/ }),

/***/ "./src/component/web/KDCodeEdit.js":
/*!*****************************************!*\
  !*** ./src/component/web/KDCodeEdit.js ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.find.js */ \"../../node_modules/core-js/modules/es.array.find.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.array.map.js */ \"../../node_modules/core-js/modules/es.array.map.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _react = _interopRequireDefault(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _lodash = _interopRequireDefault(__webpack_require__(/*! lodash */ \"../../node_modules/lodash/lodash.js\"));\nvar _immutable = __webpack_require__(/*! immutable */ \"webpack/sharing/consume/default/immutable/immutable?f2ca\");\nvar _global = __webpack_require__(/*! @/global */ \"./src/global/index.js\");\nvar _appModelFunction = __webpack_require__(/*! ../../model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar _ComposeEnhance = _interopRequireDefault(__webpack_require__(/*! ../common/ComposeEnhance */ \"./src/component/common/ComposeEnhance.js\"));\nvar _PropsComparison = _interopRequireDefault(__webpack_require__(/*! ../common/PropsComparison */ \"./src/component/common/PropsComparison.js\"));\nvar _CodeEdit = _interopRequireDefault(__webpack_require__(/*! @/component/web/base/CodeEdit/CodeEdit.js */ \"./src/component/web/base/CodeEdit/CodeEdit.js\"));\nvar _componentutil = __webpack_require__(/*! ../../util/componentutil */ \"./src/util/componentutil.js\");\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _const = __webpack_require__(/*! @/constant/const.js */ \"./src/constant/const.js\");\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _crypto = __webpack_require__(/*! @/api/crypto.js */ \"./src/api/crypto.js\");\nvar _server = __webpack_require__(/*! ../../action/actionname/control/codeEditor/server */ \"./src/action/actionname/control/codeEditor/server/index.js\");\nvar _ControlInfoCollect = _interopRequireDefault(__webpack_require__(/*! @/component/common/ControlInfoCollect */ \"./src/component/common/ControlInfoCollect.js\"));\nvar _appModelFunction2 = __webpack_require__(/*! @/model/appModelFunction */ \"./src/model/appModelFunction.js\");\n__webpack_require__(/*! @/style/CodeMirror/codemirror.less */ \"./src/style/CodeMirror/codemirror.less\");\nvar _dec, _dec2, _class;\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n// 加载第三方样式\nvar KDCodeEdit = (_dec = (0, _VisibleLockWrap[\"default\"])(false), _dec2 = (0, _ComposeEnhance[\"default\"])(_PropsComparison[\"default\"]), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = _dec2(_class = (0, _ControlInfoCollect[\"default\"])(_class = /*#__PURE__*/function (_React$Component) {\n  _inherits(KDCodeEdit, _React$Component);\n  function KDCodeEdit(props) {\n    var _this;\n    _classCallCheck(this, KDCodeEdit);\n    _this = _callSuper(this, KDCodeEdit, [props]);\n    _this.getEncodeVal = function (value) {\n      var encodeValue;\n      var rootPageId = (0, _appModelFunction2.getRootPageId)()((0, _global.getGlobalState)());\n      var config = (0, _appModelFunction2.getFormConfig)(rootPageId)((0, _global.getGlobalState)()) || {};\n      if (config.kdEncoding) {\n        encodeValue = config.kdEncoding === 'base64' ? _const.ENCRYPTION_PREFIX_BASE64 + (0, _crypto.encryptByBase64)(value) : value;\n      } else {\n        var model = _this.props.model;\n        var contentencode = (0, _componentutil.getComponentDataProperty)(model, 'contentencode', 'contentencode', false); // 判断是否开启base64\n        encodeValue = contentencode ? _this.addPrefix((0, _crypto.getEncodeValue)(value)) : value;\n      }\n      return encodeValue;\n    };\n    _this.state = {\n      value: props.model.getDataValue() || '',\n      codeHints: [],\n      dynamicHintsCodes: [],\n      codeChanege: false\n    };\n    _this.prevSelection = '';\n    _this.prefix = [];\n    _this.openDynamicHints = false; // 启用动态提示语\n    _this.editorRef = /*#__PURE__*/_react[\"default\"].createRef();\n    return _this;\n  }\n  _createClass(KDCodeEdit, [{\n    key: \"changeAction\",\n    value: function changeAction(value) {\n      // 节流发送\n      // clearTimeout(this.timer)\n      // this.timer = setTimeout(() => {\n      //   const { model } = this.props\n      //   this.props.setPostControlValue(model, value)\n      // }, 500)\n      this.setState({\n        value: value\n      });\n      value = this.getEncodeVal(value);\n      var model = this.props.model;\n      var sendSelection = model.getMetaProperty('sendSelection');\n      var newPostValue = sendSelection ? {\n        v: value\n      } : value;\n      this.props.dispatch((0, _appModelFunction.convertAppModelFunctionAction)((0, _appModelFunction.setControlPostValue)(model.pageId, model.key, newPostValue)));\n    }\n  }, {\n    key: \"addPrefix\",\n    value: function addPrefix(value) {\n      return _const.ENCRYPTION_PREFIX + value;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      var _this$props$model = this.props.model,\n        pageId = _this$props$model.pageId,\n        key = _this$props$model.key;\n      this.removeInsertHandler = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', function (data) {\n        if (!data) return;\n        _this2.executeMethods(data);\n      });\n    }\n\n    // 更新提示语\n  }, {\n    key: \"updateHints\",\n    value: function updateHints(args) {\n      var _this3 = this;\n      var model = this.props.model;\n      var key = model.key,\n        pageId = model.pageId;\n      var codes = args[0].code || [];\n      var dynamicHints = args[0].dynamicHints;\n      var hintParams = (0, _memoryCacher.getPageData)(pageId, [_const.GET_HINT_PARAMS, key]);\n      var userInput = args[0].userInput;\n      var updateHints = {\n        codeChanege: !this.state.codeChanege\n      };\n      var mergeCodesArr = [];\n      // 二级提示语\n      var newCodeHints = this.state.codeHints.map(function (codeHints) {\n        var newCodes = codes.find(function (code) {\n          return code.name === codeHints.name;\n        });\n        if (newCodes) {\n          // 记录要合并值的name，后续将这些值删除\n          mergeCodesArr.push(newCodes.name);\n        }\n        return _lodash[\"default\"].merge(codeHints, newCodes);\n      });\n      // 删除已经合并的数据,由于可能会存在重复的code.name，所以需要删除时，遍历一遍所有的值\n      codes = codes.filter(function (code) {\n        return !mergeCodesArr.includes(code.name);\n      });\n      // 增量添加固定提示语\n      newCodeHints = newCodeHints.concat(codes);\n      updateHints.codeHints = newCodeHints;\n      // 动态提示语\n      if (hintParams && userInput && dynamicHints) {\n        // 返回参数相等时，更新提示语，否则缓存提示语\n        if (hintParams === userInput) {\n          // 开启动态提示\n          this.openDynamicHints = true;\n          updateHints.dynamicHintsCodes = dynamicHints;\n        }\n        (0, _memoryCacher.setPageData)(pageId, [_const.CACHE_HINT, key, userInput], dynamicHints);\n      }\n      this.setState(updateHints, function () {\n        if (hintParams && userInput) {\n          hintParams === userInput && _this3.editorRef.current.showAutocomplete();\n        }\n      });\n    }\n\n    /**\n     * 执行控件方法\n     * @param {[Object]} method 控件方法\n     */\n  }, {\n    key: \"executeMethods\",\n    value: function executeMethods(methods) {\n      var _this4 = this;\n      methods.forEach(function (method) {\n        var args = method.args,\n          methodname = method.methodname;\n        switch (methodname) {\n          case _server.CODE_EDIT_EDITOR_INSERT_TEXT:\n            {\n              var _args = _slicedToArray(args, 1),\n                content = _args[0];\n              if (content && _this4.editorRef.current && _this4.editorRef.current.insertContent) {\n                _this4.editorRef.current.insertContent(content);\n              }\n            }\n            break;\n          case _server.CODE_EDIT_EDITOR_SET_HINTS:\n            {\n              var codes = args[0].code;\n              _this4.prefix = args[0].prefix;\n              _this4.setState({\n                codeHints: codes,\n                codeChanege: !_this4.state.codeChanege\n              });\n            }\n            break;\n          case _server.CODE_EDIT_EDITOR_UPDATE_HINTS:\n            _this4.updateHints(args);\n            break;\n          default:\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"selectAction\",\n    value: function selectAction(selection) {\n      var model = this.props.model;\n      var pageId = model.pageId,\n        key = model.key;\n      var value = this.state.value;\n      value = this.getEncodeVal(value);\n      selection = this.getEncodeVal(selection);\n      var sendSelection = model.getMetaProperty('sendSelection');\n      var state = (0, _global.getGlobalState)();\n      var controlPost = (0, _appModelFunction2.getContorlPost)(pageId)(state);\n      var postValue = controlPost.get(key);\n      // const postValue = getPageData(pageId, ['post', 'controls', key])\n      var newPostValue = postValue ? {\n        selection: selection,\n        v: value\n      } : {\n        selection: selection\n      };\n      sendSelection && this.prevSelection !== selection && this.props.dispatch((0, _appModelFunction.convertAppModelFunctionAction)((0, _appModelFunction.setControlPostValue)(model.pageId, model.key, newPostValue)));\n      this.prevSelection = selection;\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var timesTamp = this.props.model.getDataProperty(_const.TIME_STAMP_FRESH);\n      var nextTimesTamp = nextProps.model.getDataProperty(_const.TIME_STAMP_FRESH);\n      if (timesTamp !== nextTimesTamp) {\n        var value = nextProps.model.getDataValue();\n        this.setState({\n          value: value\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n      var model = this.props.model;\n      var style = (0, _componentutil.getCommonStyle)(model);\n      var isLock = this.props.getLocked(model);\n      var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n        Grow = _getCommonClass.Grow,\n        Shrink = _getCommonClass.Shrink,\n        AlignSelf = _getCommonClass.AlignSelf;\n      var fileType = model.getMetaProperty('fileType') || 'javascript';\n      var isShowLineNumber = model.getMetaProperty('sln');\n      var isShowCopyBtn = model.getMetaProperty('scb');\n      var theme = model.getMetaProperty('theme') || 'eclipse';\n      var autoComplete = model.getDataProperty('autoComplete');\n      var keyWords = model.getDataProperty('keyWords') || (0, _immutable.Map)();\n      var realTimeGetHint = model.getDataProperty('realTimeGetHint');\n      var lineWrapping = (0, _componentutil.getComponentDataProperty)(model, 'lineWrapping', 'lineWrapping', false); // 自动换行\n      // const sendSelection = model.getMetaProperty('sendSelection') || true\n      return /*#__PURE__*/_react[\"default\"].createElement(_CodeEdit[\"default\"], _extends({\n        ref: this.editorRef,\n        style: style,\n        Grow: Grow,\n        Shrink: Shrink,\n        AlignSelf: AlignSelf,\n        id: model.key,\n        value: this.state.value,\n        fileType: fileType,\n        theme: theme,\n        isShowLineNumber: isShowLineNumber,\n        isShowCopyBtn: isShowCopyBtn,\n        onChange: function onChange(value) {\n          return _this5.changeAction(value);\n        },\n        onSelect: function onSelect(value) {\n          return _this5.selectAction(value);\n        },\n        pageId: model.pageId,\n        isLock: isLock,\n        dispatch: this.props.dispatch,\n        realTimeGetHint: realTimeGetHint,\n        keyWords: keyWords,\n        autoComplete: autoComplete,\n        codeChanege: this.state.codeChanege,\n        codeHints: this.state.codeHints,\n        dynamicHintsCodes: this.state.dynamicHintsCodes,\n        prefix: this.prefix,\n        openDynamicHints: this.openDynamicHints,\n        invokeControlService: this.props.invokeControlService,\n        lineWrapping: lineWrapping\n      }, this.props.attachData));\n    }\n  }]);\n  return KDCodeEdit;\n}(_react[\"default\"].Component)) || _class) || _class) || _class) || _class);\nvar _default = exports[\"default\"] = KDCodeEdit;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDCodeEdit.js?");

/***/ }),

/***/ "./src/component/web/KDCodeEditor/CodeEditorContainer.jsx":
/*!****************************************************************!*\
  !*** ./src/component/web/KDCodeEditor/CodeEditorContainer.jsx ***!
  \****************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _kdesign = __webpack_require__(/*! @kdcloudjs/kdesign */ \"webpack/sharing/consume/default/@kdcloudjs/kdesign/@kdcloudjs/kdesign\");\nvar _useFederationModule = __webpack_require__(/*! @/hooks/useFederationModule */ \"./src/hooks/useFederationModule.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n/**\n * CodeEditor 容器，用于模块联邦加载CodeEditor模块\n * @param {*} props\n * @returns jsx\n */\nvar CodeEditorContainer = function CodeEditorContainer(props, ref) {\n  var _useFederatedModule = (0, _useFederationModule.useFederatedModule)('codeEditor', './CodeEditor'),\n    module = _useFederatedModule.Component;\n  var CodeEditor = (module === null || module === void 0 ? void 0 : module[\"default\"]) || null;\n  var codeEditorRef = (0, _react.useRef)();\n  (0, _react.useImperativeHandle)(ref, function () {\n    var _codeEditorRef$curren;\n    return {\n      sendDebugReponse: (_codeEditorRef$curren = codeEditorRef.current) === null || _codeEditorRef$curren === void 0 ? void 0 : _codeEditorRef$curren.sendDebugReponse\n    };\n  });\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Suspense, {\n    fallback: \"Loading\"\n  }, CodeEditor ? /*#__PURE__*/_react[\"default\"].createElement(CodeEditor, _extends({}, props, {\n    ref: codeEditorRef\n  })) : /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      height: '100%',\n      justifyContent: 'center',\n      alignItems: 'center'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_kdesign.Spin, null)));\n};\nvar _default = exports[\"default\"] = /*#__PURE__*/_react[\"default\"].forwardRef(CodeEditorContainer);\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDCodeEditor/CodeEditorContainer.jsx?");

/***/ }),

/***/ "./src/component/web/KDCodeEditor/KDCodeEditor.jsx":
/*!*********************************************************!*\
  !*** ./src/component/web/KDCodeEditor/KDCodeEditor.jsx ***!
  \*********************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-properties.js */ \"../../node_modules/core-js/modules/es.object.define-properties.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptors.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptors.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.map.js */ \"../../node_modules/core-js/modules/es.array.map.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.ends-with.js */ \"../../node_modules/core-js/modules/es.string.ends-with.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.starts-with.js */ \"../../node_modules/core-js/modules/es.string.starts-with.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _global = __webpack_require__(/*! @/global */ \"./src/global/index.js\");\nvar _CodeEditorContainer = _interopRequireDefault(__webpack_require__(/*! ./CodeEditorContainer */ \"./src/component/web/KDCodeEditor/CodeEditorContainer.jsx\"));\nvar _appModelFunction = __webpack_require__(/*! @/model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar _crypto = __webpack_require__(/*! @/api/crypto.js */ \"./src/api/crypto.js\");\nvar _componentutil = __webpack_require__(/*! ../../../util/componentutil */ \"./src/util/componentutil.js\");\nvar _const = __webpack_require__(/*! @/constant/const.js */ \"./src/constant/const.js\");\nvar _appModelFunction2 = __webpack_require__(/*! ../../../model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar codeEditorAction = _interopRequireWildcard(__webpack_require__(/*! ../../../action/codeEditorAction */ \"./src/action/codeEditorAction.js\"));\nvar _server = __webpack_require__(/*! @/action/actionname/control/newCodeEditor/server */ \"./src/action/actionname/control/newCodeEditor/server/index.js\");\nvar _client = __webpack_require__(/*! @/action/actionname/control/newCodeEditor/client */ \"./src/action/actionname/control/newCodeEditor/client/index.js\");\nvar _componentutil2 = __webpack_require__(/*! @/util/componentutil */ \"./src/util/componentutil.js\");\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _useSetControlMount = _interopRequireDefault(__webpack_require__(/*! @/use/useSetControlMount */ \"./src/use/useSetControlMount.js\"));\nvar _invokeActionUtils = __webpack_require__(/*! @/component/common/invokeActionUtils */ \"./src/component/common/invokeActionUtils.js\");\nvar _IntlUniversal = _interopRequireDefault(__webpack_require__(/*! @/i18n/IntlUniversal */ \"./src/i18n/IntlUniversal.js\"));\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nvar CODE_STOP_AI_ANSWER = 'kingscript_code_stopAIAnswer'; // 停止回答\nvar KDCodeEditor = function KDCodeEditor(_ref) {\n  var model = _ref.model,\n    dispatch = _ref.dispatch;\n  var value = model.getDataValue() || '';\n  var debugResolves = (0, _react.useRef)({});\n  var codeEditorRef = (0, _react.useRef)();\n  var _getRootFormConfig = (0, _componentutil.getRootFormConfig)(),\n    _getRootFormConfig$ac = _getRootFormConfig.accountId,\n    accountId = _getRootFormConfig$ac === void 0 ? '' : _getRootFormConfig$ac;\n  var getCodeFragmentCallbacks = (0, _react.useRef)({});\n  var _useState = (0, _react.useState)(),\n    _useState2 = _slicedToArray(_useState, 2),\n    userInfo = _useState2[0],\n    setUserInfo = _useState2[1];\n  var _useState3 = (0, _react.useState)([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    modulesPath = _useState4[0],\n    setModulesPath = _useState4[1];\n  var _useState5 = (0, _react.useState)([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    codeFragmentTree = _useState6[0],\n    setCodeFragmentTree = _useState6[1];\n  var _useState7 = (0, _react.useState)({\n      scriptPaths: [],\n      menuList: [],\n      editEnable: true,\n      theme: 'Dark'\n    }),\n    _useState8 = _slicedToArray(_useState7, 2),\n    editorConfig = _useState8[0],\n    setEditorConfig = _useState8[1];\n  var _useState9 = (0, _react.useState)({}),\n    _useState10 = _slicedToArray(_useState9, 2),\n    moduleExports = _useState10[0],\n    setModuleExports = _useState10[1];\n  var debugTime = (0, _react.useRef)(new Date().getTime());\n  var AICid = (0, _react.useRef)(0);\n  var _useState11 = (0, _react.useState)({\n      gptEnable: false,\n      codeGenTips: []\n    }),\n    _useState12 = _slicedToArray(_useState11, 2),\n    gptConfig = _useState12[0],\n    setGptConfig = _useState12[1];\n  var sentAIActionRef = (0, _react.useRef)();\n  var _useState13 = (0, _react.useState)({\n      locale: _IntlUniversal[\"default\"].getCurrentLang(),\n      localeData: _IntlUniversal[\"default\"].getCurrentLangData()\n    }),\n    _useState14 = _slicedToArray(_useState13, 2),\n    localConfig = _useState14[0],\n    setLocalConfig = _useState14[1];\n  var ctrlSAwaitAction = (0, _react.useRef)();\n  (0, _useSetControlMount[\"default\"])(model);\n  var getEncodeVal = function getEncodeVal(newValue) {\n    var encodeValue;\n    var rootPageId = (0, _appModelFunction.getRootPageId)()((0, _global.getGlobalState)());\n    var config = (0, _appModelFunction.getFormConfig)(rootPageId)((0, _global.getGlobalState)()) || {};\n    if (config.kdEncoding) {\n      encodeValue = config.kdEncoding === 'base64' && _crypto.encryptByBase64 ? _const.ENCRYPTION_PREFIX_BASE64 + (0, _crypto.encryptByBase64)(newValue) : newValue;\n    } else {\n      var contentencode = (0, _componentutil.getComponentDataProperty)(model, 'contentencode', 'contentencode', false); // 判断是否开启base64\n      encodeValue = contentencode ? _const.ENCRYPTION_PREFIX + (0, _crypto.getEncodeValue)(newValue) : newValue;\n    }\n    return encodeValue;\n  };\n  var changeAction = function changeAction(newValue) {\n    newValue = getEncodeVal(newValue);\n    var sendSelection = model.getMetaProperty('sendSelection');\n    var newPostValue = sendSelection ? {\n      v: newValue\n    } : newValue;\n    dispatch((0, _appModelFunction2.convertAppModelFunctionAction)((0, _appModelFunction2.setControlPostValue)(model.pageId, model.key, newPostValue)));\n  };\n  var style = (0, _componentutil.getCommonStyle)(model);\n  var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n    Grow = _getCommonClass.Grow,\n    Shrink = _getCommonClass.Shrink,\n    AlignSelf = _getCommonClass.AlignSelf;\n  var controlActions = (0, _react.useMemo)(function () {\n    return (0, _componentutil2.createActions)(codeEditorAction, dispatch);\n  }, []);\n  var getModuleInfoWithPath = function getModuleInfoWithPath(path) {\n    var _path$split;\n    var moduleInfo = {};\n    var moduleInfoStr = (_path$split = path.split('?')) === null || _path$split === void 0 ? void 0 : _path$split[1];\n    var paramsArr = moduleInfoStr.split('&');\n    paramsArr.forEach(function (item) {\n      var itemInfo = item.split('=');\n      var key = itemInfo === null || itemInfo === void 0 ? void 0 : itemInfo[0];\n      var value = itemInfo === null || itemInfo === void 0 ? void 0 : itemInfo[1];\n      key && (moduleInfo[key] = value);\n    });\n    return moduleInfo;\n  };\n  var handleAfterGetModules = function handleAfterGetModules(args) {\n    var paths = (args === null || args === void 0 ? void 0 : args[0]) || [];\n    var newModulesPath = paths.map(function (path) {\n      path = path.startsWith('/') ? path.substring(1) : path;\n      var moduleInfo = getModuleInfoWithPath(path);\n      return {\n        path: path,\n        name: moduleInfo.path || '',\n        version: moduleInfo.v || '1.0.0'\n      };\n    });\n    setModulesPath(newModulesPath);\n  };\n  var handleAfterGetModuleExprots = function handleAfterGetModuleExprots(args) {\n    try {\n      var _moduleExports = JSON.parse((args === null || args === void 0 ? void 0 : args[0]) || '{}');\n      setModuleExports(_moduleExports);\n    } catch (e) {\n      console.warn(e);\n    }\n  };\n  var handleGptDataResponse = function handleGptDataResponse(args) {\n    var handleResult = function handleResult(result, isEnd, tips) {\n      var _sentAIActionRef$curr;\n      (_sentAIActionRef$curr = sentAIActionRef.current) === null || _sentAIActionRef$curr === void 0 || _sentAIActionRef$curr.call(sentAIActionRef, result, isEnd, tips);\n      isEnd && (sentAIActionRef.current = undefined);\n    };\n    try {\n      var invokeResult = (args === null || args === void 0 ? void 0 : args[0]) || {};\n      var cid = invokeResult.cid || '';\n      if (cid !== AICid.current + '') return; // cid对不上表示原先的对话已经被终止，不再处理\n      var data = invokeResult.data || '';\n      var isEnd = invokeResult.isEnd || false;\n      var tips = invokeResult.tips || [];\n      handleResult(data, isEnd, tips);\n    } catch (e) {\n      handleResult('', true, []);\n      console.warn(e);\n    }\n  };\n  var handleSetGptConfig = function handleSetGptConfig(args) {\n    try {\n      var _args$;\n      var _gptConfig = (args === null || args === void 0 || (_args$ = args[0]) === null || _args$ === void 0 ? void 0 : _args$[0]) || {};\n      if (!('gptEnable' in _gptConfig)) {\n        _gptConfig.gptEnable = false;\n      }\n      if (!('codeGenTips' in _gptConfig)) {\n        _gptConfig.codeGenTips = [];\n      }\n      setGptConfig(_gptConfig);\n      _gptConfig.gptEnable && setEditorConfig(function (config) {\n        var menuList = config.menuList;\n        menuList.unshift('ai');\n        return _objectSpread(_objectSpread({}, config), {}, {\n          menuList: menuList\n        });\n      });\n    } catch (e) {\n      console.warn(e);\n    }\n  };\n  var handleCodeEditorDebugProtocolResponse = function handleCodeEditorDebugProtocolResponse(args) {\n    try {\n      var response = args === null || args === void 0 ? void 0 : args[0];\n      if (debugResolves.current[response.cid]) {\n        debugResolves.current[response.cid](response);\n        delete debugResolves.current[response.cid];\n      } else {\n        var _codeEditorRef$curren, _codeEditorRef$curren2;\n        (_codeEditorRef$curren = codeEditorRef.current) === null || _codeEditorRef$curren === void 0 || (_codeEditorRef$curren2 = _codeEditorRef$curren.sendDebugReponse) === null || _codeEditorRef$curren2 === void 0 || _codeEditorRef$curren2.call(_codeEditorRef$curren, response);\n      }\n    } catch (e) {\n      console.warn(e);\n    }\n  };\n  var hadnleSetCodeEditorConfig = function hadnleSetCodeEditorConfig(args) {\n    try {\n      var _args$2;\n      var config = (args === null || args === void 0 || (_args$2 = args[0]) === null || _args$2 === void 0 ? void 0 : _args$2[0]) || {};\n      setEditorConfig(function (preConfig) {\n        var menuList = preConfig.menuList;\n        var _config$scriptPath = config.scriptPath,\n          scriptPath = _config$scriptPath === void 0 ? '' : _config$scriptPath,\n          _config$debugEnable = config.debugEnable,\n          debugEnable = _config$debugEnable === void 0 ? false : _config$debugEnable,\n          _config$editEnable = config.editEnable,\n          editEnable = _config$editEnable === void 0 ? true : _config$editEnable,\n          _config$codeDemoEnabl = config.codeDemoEnable,\n          codeDemoEnable = _config$codeDemoEnabl === void 0 ? false : _config$codeDemoEnabl,\n          _config$theme = config.theme,\n          theme = _config$theme === void 0 ? 'Dark' : _config$theme;\n        if (typeof scriptPath !== 'string') {\n          scriptPath = '';\n        }\n        if (typeof debugEnable !== 'boolean') {\n          debugEnable = false;\n        }\n        if (typeof codeDemoEnable !== 'boolean') {\n          codeDemoEnable = false;\n        }\n        if (typeof editEnable !== 'boolean') {\n          editEnable = true;\n        }\n        if (!['Dark', 'Light'].includes(theme)) {\n          theme = 'Dark';\n        }\n        debugEnable && menuList.push('debug');\n        if (codeDemoEnable) {\n          menuList.push('fragment');\n          controlActions.getCodeEditorFragmentTree(model);\n        }\n        scriptPath = scriptPath.endsWith('.ts') ? scriptPath.substring(0, scriptPath.length - 3) : scriptPath;\n        return {\n          editEnable: editEnable,\n          theme: theme,\n          menuList: menuList,\n          scriptPaths: [scriptPath]\n        };\n      });\n    } catch (e) {\n      console.warn(e);\n    }\n  };\n  var handleSetCodeEditorFragmentTree = function handleSetCodeEditorFragmentTree(args) {\n    try {\n      var fragmentTree = (args === null || args === void 0 ? void 0 : args[0]) || [];\n      if (!Array.isArray(fragmentTree)) return;\n      setCodeFragmentTree(fragmentTree);\n    } catch (e) {\n      console.warn(e);\n    }\n  };\n  var handleSetCodeEditorFragment = function handleSetCodeEditorFragment(args) {\n    var _getCodeFragmentCallb, _getCodeFragmentCallb2;\n    var id = (args === null || args === void 0 ? void 0 : args[0].id) || '';\n    var data = (args === null || args === void 0 ? void 0 : args[0].data) || '';\n    if (!id) return;\n    (_getCodeFragmentCallb = (_getCodeFragmentCallb2 = getCodeFragmentCallbacks.current)[id]) === null || _getCodeFragmentCallb === void 0 || _getCodeFragmentCallb.call(_getCodeFragmentCallb2, data);\n    delete getCodeFragmentCallbacks.current[id];\n  };\n  var executeMethods = function executeMethods(methods) {\n    methods.forEach(function (method) {\n      var args = method.args,\n        methodname = method.methodname;\n      switch (methodname) {\n        case _server.SET_CODE_EDITOR_MODULES:\n          {\n            handleAfterGetModules(args);\n            break;\n          }\n        case _server.CODE_EDITOR_GPT_RESPONSE:\n          {\n            handleGptDataResponse(args);\n            break;\n          }\n        case _server.CODE_EDITOR_SET_MODULE_EXPORTS:\n          {\n            handleAfterGetModuleExprots(args);\n            break;\n          }\n        case _server.CODE_EDITOR_SET_GPT_CONFIG:\n          {\n            handleSetGptConfig(args);\n            break;\n          }\n        case _server.CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE:\n          {\n            handleCodeEditorDebugProtocolResponse(args);\n            break;\n          }\n        case _server.CODE_EDITOR_SET_CONFIG:\n          {\n            hadnleSetCodeEditorConfig(args);\n            break;\n          }\n        case _server.CODE_EDITOR_SET_FRAGMENT_TREE:\n          {\n            handleSetCodeEditorFragmentTree(args);\n            break;\n          }\n        case _server.CODE_EDITOR_SET_FRAGMENT:\n          {\n            handleSetCodeEditorFragment(args);\n            break;\n          }\n        default:\n          break;\n      }\n    });\n  };\n  var handleCodeEditorActionAjaxState = function handleCodeEditorActionAjaxState(_ref2) {\n    var value = _ref2.value,\n      args = _ref2.args;\n    if ([_invokeActionUtils.AJAX_ERROR].includes(value) && sentAIActionRef.current) {\n      var _sentAIActionRef$curr2;\n      (_sentAIActionRef$curr2 = sentAIActionRef.current) === null || _sentAIActionRef$curr2 === void 0 || _sentAIActionRef$curr2.call(sentAIActionRef, '', true);\n      sentAIActionRef.current = undefined;\n    }\n  };\n  var handleListenLocalChange = function handleListenLocalChange() {\n    var removeGlobalDataChangeListener = (0, _GlobalDataCacher.addDataChangeListener)(_symbolConst.KEY_RELOAD_ROOT_PAGE, function () {\n      setLocalConfig({\n        locale: _IntlUniversal[\"default\"].getCurrentLang(),\n        localeData: _IntlUniversal[\"default\"].getCurrentLangData()\n      });\n    });\n    var removeDefaultLanguageChangeListener = (0, _GlobalDataCacher.addDataChangeListener)(_symbolConst.KEY_USE_DEFAULT_LANGUAGE, function (_ref3) {\n      var locale = _ref3.locale,\n        localeData = _ref3.localeData;\n      setLocalConfig({\n        locale: locale,\n        localeData: localeData\n      });\n    });\n    return function () {\n      removeGlobalDataChangeListener();\n      removeDefaultLanguageChangeListener();\n    };\n  };\n  var getUserInfo = (0, _react.useCallback)(function () {\n    var _systemParam$portalUs, _systemParam$portalUs2;\n    var systemParam = (0, _GlobalDataCacher.getData)(_symbolConst.KEY_SYSTEM_PARAM) || {};\n    setUserInfo({\n      name: (systemParam === null || systemParam === void 0 || (_systemParam$portalUs = systemParam.portalUserInfo) === null || _systemParam$portalUs === void 0 ? void 0 : _systemParam$portalUs.name) || '',\n      photo: (systemParam === null || systemParam === void 0 || (_systemParam$portalUs2 = systemParam.portalUserInfo) === null || _systemParam$portalUs2 === void 0 ? void 0 : _systemParam$portalUs2.photo) || ''\n    });\n  }, []);\n  (0, _react.useEffect)(function () {\n    (0, _GlobalDataCacher.setData)(_symbolConst.KEY_TRAYMENU, false);\n    return handleListenLocalChange();\n  }, []);\n  (0, _react.useEffect)(function () {\n    var pageId = model.pageId,\n      key = model.key;\n    return (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', function (data) {\n      if (!data) return;\n      executeMethods(data);\n    });\n  }, []);\n  (0, _react.useEffect)(function () {\n    controlActions.getCodeEditorModules(model, {\n      modules: model.getMetaProperty('modules')\n    });\n    controlActions.listModuleExports(model, {\n      modules: model.getMetaProperty('modules')\n    });\n    controlActions.getEditorGptConfig(model);\n    controlActions.getCodeEditorConfig(model);\n    getUserInfo();\n  }, []);\n  (0, _react.useEffect)(function () {\n    var pageId = model.pageId,\n      key = model.key;\n    return (0, _invokeActionUtils.addAjaxStateListener)(pageId, key, _client.CODE_EDITOR_ACTION, handleCodeEditorActionAjaxState);\n  }, [model]);\n  var handleAIActionSend = function handleAIActionSend(actionParams) {\n    var ability = actionParams.ability,\n      content = actionParams.value,\n      sendActionResult = actionParams.sendActionResult;\n    if (ability === CODE_STOP_AI_ANSWER) {\n      sentAIActionRef.current = undefined;\n    } else {\n      sentAIActionRef.current = sendActionResult;\n      AICid.current += 1;\n    }\n    controlActions.getEditorGptData(model, ability, content, AICid.current + '');\n  };\n  (0, _react.useEffect)(function () {\n    var _ctrlSAwaitAction$cur;\n    (_ctrlSAwaitAction$cur = ctrlSAwaitAction.current) === null || _ctrlSAwaitAction$cur === void 0 || _ctrlSAwaitAction$cur.call(ctrlSAwaitAction);\n  }, [model]);\n  var ctrlSToSave = (0, _react.useCallback)(function (event) {\n    if (!editorConfig.editEnable) return;\n    if (event.key === 's' && (event.metaKey || event.ctrlKey)) {\n      event.preventDefault();\n      var target = event.target;\n      var focusedElement = document.activeElement;\n      // 如果聚焦在其他输入框时需要让其他输入框失焦触发保存成功后在触发model变化后再执行保存\n      if (target.nodeName === 'INPUT') {\n        focusedElement.blur();\n        ctrlSAwaitAction.current = function () {\n          controlActions.triggerSaveShortCut(model);\n          focusedElement.focus();\n          ctrlSAwaitAction.current = undefined;\n        };\n      } else {\n        controlActions.triggerSaveShortCut(model);\n      }\n    }\n  }, [model, controlActions, editorConfig.editEnable]);\n  (0, _react.useEffect)(function () {\n    document.addEventListener('keydown', ctrlSToSave);\n    return function () {\n      document.removeEventListener('keydown', ctrlSToSave);\n    };\n  }, [ctrlSToSave]);\n  var sendDebugProcotolRequest = (0, _react.useCallback)(function (request, resolve) {\n    var debugId = \"\".concat(model.pageId, \"_\").concat(model.key, \"_\").concat(debugTime.current);\n    debugResolves.current[request.cid] = resolve;\n    controlActions.sendCodeEditorDebugProtocol(model, _objectSpread({\n      debugId: debugId\n    }, request));\n  }, [model.pageId, model.key]);\n  var sendSaveBeforeDebug = (0, _react.useCallback)(function (debugRequest, debugResolve) {\n    var beforeDebugCId = '0';\n    debugResolves.current[beforeDebugCId] = function (resopnse) {\n      var _resopnse$error;\n      if (resopnse !== null && resopnse !== void 0 && (_resopnse$error = resopnse.error) !== null && _resopnse$error !== void 0 && _resopnse$error.code) {\n        debugResolve(_objectSpread(_objectSpread({}, debugRequest), {}, {\n          debugId: \"\".concat(model.pageId, \"_\").concat(model.key, \"_\").concat(debugTime.current),\n          error: resopnse === null || resopnse === void 0 ? void 0 : resopnse.error\n        }));\n      } else {\n        sendDebugProcotolRequest(debugRequest, debugResolve);\n      }\n    };\n    controlActions.triggerSaveShortCut(model, {\n      debugId: debugTime.current,\n      isDebugSave: true,\n      cid: beforeDebugCId,\n      method: 'Debugger.beforePrepare'\n    });\n  }, [model, hadnleDebugProcotolRequest]);\n  var hadnleDebugProcotolRequest = (0, _react.useCallback)(function (request, resolve) {\n    if (request.cid === '1') {\n      debugTime.current = new Date().getTime();\n      editorConfig.editEnable ? sendSaveBeforeDebug(request, resolve) : sendDebugProcotolRequest(request, resolve);\n    } else {\n      sendDebugProcotolRequest(request, resolve);\n    }\n  }, [sendDebugProcotolRequest, sendSaveBeforeDebug, editorConfig.editEnable]);\n  var handleGetCodeFragment = (0, _react.useCallback)(function (id, cb) {\n    controlActions.getCodeEditorFragment(model, id);\n    getCodeFragmentCallbacks.current[id] = cb;\n  }, []);\n  return /*#__PURE__*/_react[\"default\"].createElement(_CodeEditorContainer[\"default\"], {\n    value: value,\n    onChange: changeAction,\n    style: style,\n    ref: codeEditorRef,\n    modulesDBSuffix: accountId,\n    modulesPath: modulesPath,\n    userInfo: userInfo,\n    onAIActionSend: handleAIActionSend,\n    moduleExports: moduleExports,\n    localeConfig: localConfig,\n    gptConfig: gptConfig,\n    onDebugProcotolRequest: hadnleDebugProcotolRequest,\n    scriptPaths: editorConfig.scriptPaths,\n    menuList: editorConfig.menuList,\n    readOnly: !editorConfig.editEnable,\n    codeFragmentTree: codeFragmentTree,\n    theme: editorConfig.theme,\n    onGetCodeFragment: handleGetCodeFragment,\n    Grow: Grow,\n    Shrink: Shrink,\n    AlignSelf: AlignSelf\n  });\n};\nvar _default = exports[\"default\"] = KDCodeEditor;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDCodeEditor/KDCodeEditor.jsx?");

/***/ }),

/***/ "./src/component/web/KDMapBase.js":
/*!****************************************!*\
  !*** ./src/component/web/KDMapBase.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\nvar _react = _interopRequireDefault(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _classnames2 = _interopRequireDefault(__webpack_require__(/*! classnames */ \"../../node_modules/classnames/index.js\"));\nvar _ComposeEnhance = _interopRequireDefault(__webpack_require__(/*! ../common/ComposeEnhance */ \"./src/component/common/ComposeEnhance.js\"));\nvar _PropsComparison = _interopRequireDefault(__webpack_require__(/*! ../common/PropsComparison */ \"./src/component/common/PropsComparison.js\"));\nvar _MapBase = _interopRequireDefault(__webpack_require__(/*! ./base/MapBase */ \"./src/component/web/base/MapBase.js\"));\nvar _AMap = _interopRequireDefault(__webpack_require__(/*! ./base/Map/AMap */ \"./src/component/web/base/Map/AMap.jsx\"));\nvar _GMap = _interopRequireDefault(__webpack_require__(/*! ./base/Map/GMap */ \"./src/component/web/base/Map/GMap.jsx\"));\nvar _mapaction = __webpack_require__(/*! ../../action/mapaction */ \"./src/action/mapaction.js\");\nvar _appModelFunction = __webpack_require__(/*! @/model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar _componentutil = __webpack_require__(/*! ../../util/componentutil */ \"./src/util/componentutil.js\");\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _serverproperties = __webpack_require__(/*! ../../constant/serverproperties */ \"./src/constant/serverproperties.js\");\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _ControlInfoCollect = _interopRequireDefault(__webpack_require__(/*! @/component/common/ControlInfoCollect */ \"./src/component/common/ControlInfoCollect.js\"));\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _mapUtil = __webpack_require__(/*! @/util/mapUtil */ \"./src/util/mapUtil.js\");\nvar _mapConst = __webpack_require__(/*! @/constant/mapConst */ \"./src/constant/mapConst.js\");\nvar _const = __webpack_require__(/*! @/constant/const */ \"./src/constant/const.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _MapBase2 = _interopRequireDefault(__webpack_require__(/*! @/component/web/base/MapBase.less */ \"./src/component/web/base/MapBase.less\"));\nvar _commonUtils = _interopRequireDefault(__webpack_require__(/*! @/component/common/commonUtils */ \"./src/component/common/commonUtils.js\"));\nvar _NoSecrectKey = _interopRequireDefault(__webpack_require__(/*! @/component/common/map/NoSecrectKey.js */ \"./src/component/common/map/NoSecrectKey.js\"));\nvar _dec, _dec2, _class;\n/**\n * pc端：地图控件\n */\n// import PropTypes from 'prop-types'\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nvar KDMapBase = (_dec = (0, _VisibleLockWrap[\"default\"])(false), _dec2 = (0, _ComposeEnhance[\"default\"])(_PropsComparison[\"default\"]), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = _dec2(_class = (0, _ControlInfoCollect[\"default\"])(_class = /*#__PURE__*/function (_React$Component) {\n  _inherits(KDMapBase, _React$Component);\n  function KDMapBase(props) {\n    var _this;\n    _classCallCheck(this, KDMapBase);\n    _this = _callSuper(this, KDMapBase, [props]);\n    _this.setMapConfig = function () {\n      _this.mapConfig = (0, _mapUtil.getMapConfig)();\n      if (_this.mapConfig.mapService === _mapConst.GaodeMap && _this.mapConfig.securityKey) {\n        window._AMapSecurityConfig = {\n          securityJsCode: _this.mapConfig.securityKey\n        };\n      }\n    };\n    /**\n     * 控件指令处理\n     * @param {object} data 后端指令参数\n     */\n    _this.handleDirectives = function (data) {\n      if (!data) return;\n      if (data[0].methodname === 'executeCustomEvent') {\n        var code = data[0].args[0];\n        _this.executeCustomEvent(code);\n      }\n    };\n    /**\n     * 执行自定义方法\n     * @param {string} code 代码字符串\n     */\n    _this.executeCustomEvent = function (code) {\n      if (_this.mapConfig.mapService === _mapConst.DefaultMap) {\n        _this.showMessage((0, _intlApi.getLangMsg)('MapBase.key0011'));\n        return;\n      }\n      var isLegalInvocation = code.includes('BMap') && _this.mapConfig.mapService === _mapConst.BaiduMap || code.includes('AMap') && _this.mapConfig.mapService === _mapConst.GaodeMap || code.includes('google.maps') && _this.mapConfig.mapService === _mapConst.GoogleMap;\n      if (!isLegalInvocation) {\n        _this.showMessage((0, _intlApi.getLangMsg)('MapBase.key0012'));\n        return;\n      }\n      _this.setState({\n        code: code\n      });\n    };\n    _this.selectPoint = function (address, coordSys) {\n      var _this$props = _this.props,\n        model = _this$props.model,\n        dispatch = _this$props.dispatch;\n      // 如果后端发送的坐标系与当前的相等，则就不转换了\n      var coord = (0, _componentutil.getComponentDataProperty)(model, 'coordSys', 'coordSys');\n      if ((coordSys === null || coordSys === void 0 ? void 0 : coordSys.from) === 'gcj02' && (coordSys === null || coordSys === void 0 ? void 0 : coordSys.to) === 'bd09ll' && coord !== (coordSys === null || coordSys === void 0 ? void 0 : coordSys.from)) {\n        var latitude = address.latitude,\n          longitude = address.longitude;\n        var _gcj02ToBD = (0, _mapUtil.gcj02ToBD09)(longitude, latitude),\n          _gcj02ToBD2 = _slicedToArray(_gcj02ToBD, 2),\n          newLng = _gcj02ToBD2[0],\n          newLat = _gcj02ToBD2[1];\n        address.latitude = newLat;\n        address.longitude = newLng;\n      }\n      dispatch((0, _mapaction.selectPoint)(model, address));\n    };\n    _this.showMessage = function (message) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _const.AlertType.WARNING;\n      (0, _appModelFunction.setDataMessages)(_this.props.model.pageId, {\n        type: type,\n        content: message,\n        duration: 3000\n      });\n    };\n    _this.state = {\n      code: ''\n    };\n    _this.setMapConfig();\n    return _this;\n  }\n  _createClass(KDMapBase, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      this.removeSystemParamListener = (0, _GlobalDataCacher.addDataChangeListener)(_symbolConst.KEY_SYSTEM_PARAM, function (systemParam) {\n        var _systemParam$mapServi;\n        if (((_systemParam$mapServi = systemParam.mapServiceConfiguration) === null || _systemParam$mapServi === void 0 ? void 0 : _systemParam$mapServi.mapService) !== _this2.mapConfig.mapService) {\n          _this2.setMapConfig();\n          _this2.forceUpdate();\n        }\n      });\n      var model = this.props.model;\n      var pageId = model.pageId,\n        key = model.key;\n      this.removeDirectivesListener = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', this.handleDirectives);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this$removeSystemPar, _this$removeDirective;\n      (_this$removeSystemPar = this.removeSystemParamListener) === null || _this$removeSystemPar === void 0 || _this$removeSystemPar.call(this);\n      (_this$removeDirective = this.removeDirectivesListener) === null || _this$removeDirective === void 0 || _this$removeDirective.call(this);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$mapConfig, _this$mapConfig2, _this$mapConfig3;\n      var model = this.props.model;\n      var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n        Grow = _getCommonClass.Grow,\n        Shrink = _getCommonClass.Shrink,\n        AlignSelf = _getCommonClass.AlignSelf;\n      var style = (0, _componentutil.getCommonStyle)(model);\n      var placeHolder = model.getMetaProperty(_serverproperties.PLACE_HOLDER);\n      var showSearchBox = (0, _componentutil.getComponentDataProperty)(model, 'showSearchBox', 'showSearchBox', false); // 显示搜索框\n      var selPoint = (0, _componentutil.getComponentDataProperty)(model, 'selectPoint', 'selectPoint', false); // server端动态指定的在地图上标记的一个点(经纬度)\n      var selAddress = (0, _componentutil.getComponentDataProperty)(model, 'selectAddress', 'selectAddress', false); // server端动态指定一个地址(string)标记在地图上\n      var canMarkerDraggble = (0, _componentutil.getComponentDataProperty)(model, 'canMarkerDraggble', 'canMarkerDraggble', false); // 标记marker是否可拖拽\n      var locale = model.getUserLocale();\n      if ((0, _mapUtil.isDefaultModeWithoutKey)(this.mapConfig)) {\n        var className = (0, _classnames2[\"default\"])(_defineProperty({}, _MapBase2[\"default\"].mapbase, true), (0, _commonUtils[\"default\"])({\n          Grow: Grow,\n          Shrink: Shrink,\n          AlignSelf: AlignSelf\n        }));\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", _extends({\n          style: style,\n          className: className,\n          id: model.key,\n          pageId: model.pageId\n        }, this.props.attachData), /*#__PURE__*/_react[\"default\"].createElement(_NoSecrectKey[\"default\"], null));\n      }\n      if (((_this$mapConfig = this.mapConfig) === null || _this$mapConfig === void 0 ? void 0 : _this$mapConfig.mapService) === _mapConst.BaiduMap || ((_this$mapConfig2 = this.mapConfig) === null || _this$mapConfig2 === void 0 ? void 0 : _this$mapConfig2.mapService) === 'default') {\n        var mapKey = this.mapConfig.mapKey;\n        var apiKey = this.mapConfig.apiKey;\n        return /*#__PURE__*/_react[\"default\"].createElement(_MapBase[\"default\"], _extends({\n          code: this.state.code,\n          id: model.key,\n          pageId: model.pageId,\n          mapKey: mapKey,\n          apiKey: apiKey,\n          style: style,\n          showSearchBox: showSearchBox,\n          placeHolder: placeHolder,\n          selectPoint: this.selectPoint,\n          selPoint: selPoint,\n          selAddress: selAddress,\n          canMarkerDraggble: canMarkerDraggble,\n          showMessage: this.showMessage,\n          Grow: Grow,\n          Shrink: Shrink,\n          AlignSelf: AlignSelf\n        }, this.props.attachData));\n      } else if (((_this$mapConfig3 = this.mapConfig) === null || _this$mapConfig3 === void 0 ? void 0 : _this$mapConfig3.mapService) === _mapConst.GoogleMap) {\n        return /*#__PURE__*/_react[\"default\"].createElement(_GMap[\"default\"], _extends({\n          code: this.state.code,\n          address: selAddress,\n          id: model.key,\n          pageId: model.pageId,\n          dragEnable: true,\n          style: style,\n          mapKey: this.mapConfig.mapKey,\n          markerDraggable: canMarkerDraggble,\n          placeholder: placeHolder || (0, _intlApi.getLangMsg)({\n            key: 'MapBase.key0001'\n          }),\n          point: selPoint,\n          showSearchBox: showSearchBox,\n          showMessage: this.showMessage,\n          selectPoint: this.selectPoint,\n          locale: locale\n        }, this.props.attachData));\n      }\n      return /*#__PURE__*/_react[\"default\"].createElement(_AMap[\"default\"], _extends({\n        code: this.state.code,\n        address: selAddress,\n        id: model.key,\n        pageId: model.pageId,\n        dragEnable: true,\n        style: style,\n        mapKey: this.mapConfig.mapKey,\n        markerDraggable: canMarkerDraggble,\n        placeholder: placeHolder || (0, _intlApi.getLangMsg)({\n          key: 'MapBase.key0001'\n        }),\n        point: selPoint,\n        showSearchBox: showSearchBox,\n        showMessage: this.showMessage,\n        selectPoint: this.selectPoint\n      }, this.props.attachData));\n    }\n  }]);\n  return KDMapBase;\n}(_react[\"default\"].Component)) || _class) || _class) || _class) || _class);\nvar _default = exports[\"default\"] = KDMapBase;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDMapBase.js?");

/***/ }),

/***/ "./src/component/web/KDQRCode.js":
/*!***************************************!*\
  !*** ./src/component/web/KDQRCode.js ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-properties.js */ \"../../node_modules/core-js/modules/es.object.define-properties.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptors.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptors.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\nvar _react = _interopRequireDefault(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _BaseQRCode = _interopRequireDefault(__webpack_require__(/*! ./base/BaseQRCode */ \"./src/component/web/base/BaseQRCode.js\"));\nvar _componentutil = __webpack_require__(/*! ../../util/componentutil */ \"./src/util/componentutil.js\");\nvar _ComposeEnhance = _interopRequireDefault(__webpack_require__(/*! ../common/ComposeEnhance */ \"./src/component/common/ComposeEnhance.js\"));\nvar _PropsComparison = _interopRequireDefault(__webpack_require__(/*! ../common/PropsComparison */ \"./src/component/common/PropsComparison.js\"));\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _commonUtils = _interopRequireDefault(__webpack_require__(/*! @/component/common/commonUtils */ \"./src/component/common/commonUtils.js\"));\nvar _KDQRCode = _interopRequireDefault(__webpack_require__(/*! ./KDQRCode.less */ \"./src/component/web/KDQRCode.less\"));\nvar _classnames2 = _interopRequireDefault(__webpack_require__(/*! classnames */ \"../../node_modules/classnames/index.js\"));\nvar _ControlInfoCollect = _interopRequireDefault(__webpack_require__(/*! @/component/common/ControlInfoCollect */ \"./src/component/common/ControlInfoCollect.js\"));\nvar _ChangeThemeWrap = __webpack_require__(/*! @/component/common/ChangeThemeWrap */ \"./src/component/common/ChangeThemeWrap.js\");\nvar _componentutil2 = __webpack_require__(/*! @/util/componentutil */ \"./src/util/componentutil.js\");\nvar _dec, _dec2, _class;\n/**\n * 二维码控件\n */\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nvar KDQRCode = (_dec = (0, _VisibleLockWrap[\"default\"])(false), _dec2 = (0, _ComposeEnhance[\"default\"])(_PropsComparison[\"default\"]), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = _dec2(_class = (0, _ControlInfoCollect[\"default\"])(_class = (0, _ChangeThemeWrap.ChangeThemeWrap)(_class = /*#__PURE__*/function (_React$Component) {\n  _inherits(KDQRCode, _React$Component);\n  function KDQRCode() {\n    _classCallCheck(this, KDQRCode);\n    return _callSuper(this, KDQRCode, arguments);\n  }\n  _createClass(KDQRCode, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        model = _this$props.model,\n        theme = _this$props.theme;\n      var value = (0, _componentutil.getComponentDataProperty)(model, 'url', 'value', false); // 二维码内容\n      var size = (0, _componentutil.getComponentDataProperty)(model, 'size', 'w', true); // 二维码尺寸(正方形)\n      var style = (0, _componentutil.getCommonStyle)(model);\n      var QrCodeStyle = model.getMetaProperty('qcs') || 0;\n      var displayValue = model.getMetaProperty('displayValue');\n      var fontSize = model.getMetaProperty('fs');\n      var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n        AlignSelf = _getCommonClass.AlignSelf;\n      var valueClass = (0, _classnames2[\"default\"])(_defineProperty({}, _KDQRCode[\"default\"]['QRCode-value'], true));\n      if (value && value !== '' && /^http|https/.test(value)) {\n        value = (0, _componentutil2.setAccountId)(value);\n      }\n      if (!value) {\n        value = 'QRCode is null';\n        // console.log('-----------QRCode is null-----------')\n      }\n      var className = (0, _classnames2[\"default\"])((0, _commonUtils[\"default\"])({\n        AlignSelf: AlignSelf\n      }));\n      var QRCodeBgStyle = theme === _ChangeThemeWrap.themeMap.dark ? {\n        bgColor: '#242525',\n        // 暗黑皮肤二维码显示为黑底白色\n        fgColor: '#ffffff'\n      } : {};\n      var mergeStyle = _objectSpread(_objectSpread({}, style), {}, {\n        color: theme === _ChangeThemeWrap.themeMap.dark ? '#fff' : '#000'\n      });\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", _extends({\n        className: className,\n        id: model.key\n      }, this.props.attachData, {\n        style: mergeStyle\n      }), /*#__PURE__*/_react[\"default\"].createElement(_BaseQRCode[\"default\"], _extends({\n        value: value,\n        size: size,\n        QrCodeStyle: QrCodeStyle,\n        style: mergeStyle,\n        displayValue: false,\n        fontSize: fontSize\n      }, QRCodeBgStyle)), displayValue ? /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: valueClass\n      }, value) : '');\n    }\n  }]);\n  return KDQRCode;\n}(_react[\"default\"].Component)) || _class) || _class) || _class) || _class) || _class);\nvar _default = exports[\"default\"] = KDQRCode;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDQRCode.js?");

/***/ }),

/***/ "./src/component/web/KDVideo.jsx":
/*!***************************************!*\
  !*** ./src/component/web/KDVideo.jsx ***!
  \***************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _classnames = _interopRequireDefault(__webpack_require__(/*! classnames */ \"../../node_modules/classnames/index.js\"));\nvar _Video = _interopRequireDefault(__webpack_require__(/*! ./base/Video */ \"./src/component/web/base/Video.jsx\"));\nvar _componentutil = __webpack_require__(/*! ../../util/componentutil */ \"./src/util/componentutil.js\");\nvar _commonUtils = _interopRequireDefault(__webpack_require__(/*! ../common/commonUtils */ \"./src/component/common/commonUtils.js\"));\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _ControlInfoCollect = _interopRequireDefault(__webpack_require__(/*! @/component/common/ControlInfoCollect */ \"./src/component/common/ControlInfoCollect.js\"));\nvar _requestParamsUtil = __webpack_require__(/*! @/util/requestParamsUtil */ \"./src/util/requestParamsUtil.js\");\nvar _immutable = __webpack_require__(/*! immutable */ \"webpack/sharing/consume/default/immutable/immutable?f2ca\");\nvar _dec, _class;\n/**\n * 视频控件\n */\n// import styles from './KDVideo.less';\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nvar KDVideo = (_dec = (0, _VisibleLockWrap[\"default\"])(true), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = (0, _ControlInfoCollect[\"default\"])(_class = /*#__PURE__*/function (_React$Component) {\n  _inherits(KDVideo, _React$Component);\n  function KDVideo(props) {\n    var _this;\n    _classCallCheck(this, KDVideo);\n    _this = _callSuper(this, KDVideo, [props]);\n    _this.setVideoConfig = function () {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!_this.videoRef.current) {\n        return;\n      }\n      var configKeys = Object.keys(config);\n      configKeys.forEach(function (key) {\n        _this.videoRef.current[key] = config[key];\n      });\n    };\n    _this.videoRef = /*#__PURE__*/(0, _react.createRef)();\n    _this.state = {\n      config: {}\n    };\n    return _this;\n  }\n  _createClass(KDVideo, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var immutableConfig = (0, _componentutil.getComponentDataProperty)(this.props.model, 'config', 'config', false);\n      this.setState({\n        config: (immutableConfig === null || immutableConfig === void 0 ? void 0 : immutableConfig.toJS()) || {}\n      });\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var model = this.props.model;\n      var nextModel = nextProps.model;\n      var immutableConfig = (0, _componentutil.getComponentDataProperty)(model, 'config', 'config', false);\n      var nextImmutableConfig = (0, _componentutil.getComponentDataProperty)(nextModel, 'config', 'config', false);\n      if (!(0, _immutable.is)(immutableConfig, nextImmutableConfig)) {\n        this.setState({\n          config: (nextImmutableConfig === null || nextImmutableConfig === void 0 ? void 0 : nextImmutableConfig.toJS()) || {}\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var model = this.props.model;\n      var style = Object.assign({}, (0, _componentutil.getCommonStyle)(model), this.props.style);\n      var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n        Grow = _getCommonClass.Grow,\n        Shrink = _getCommonClass.Shrink,\n        AlignSelf = _getCommonClass.AlignSelf;\n      var url = (0, _componentutil.getComponentDataProperty)(model, 'src', 'src', false);\n      var src = (0, _requestParamsUtil.appendParamsToUrl)(url, {\n        model: model\n      });\n      var autoPlay = (0, _componentutil.getComponentDataProperty)(model, 'autoPlay', 'autoPlay', false); // 自动播放\n      var rootClassName = (0, _classnames[\"default\"])((0, _commonUtils[\"default\"])({\n        Grow: Grow,\n        Shrink: Shrink,\n        AlignSelf: AlignSelf\n      }));\n\n      // test data\n      // src = \"http://v2v.cc/~j/theora_testsuite/320x240.ogg\";\n      // src = 'https://www.youtube.com/embed/u9Mv98Gr5pY';\n      // src = src||\"avedio111111.mp4\";\n\n      // 隐藏后也可正常播放(目前已测试的浏览器：chrome,safari)\n      return /*#__PURE__*/_react[\"default\"].createElement(_Video[\"default\"], _extends({\n        ref: this.videoRef,\n        className: rootClassName,\n        style: style,\n        id: model.key,\n        src: src,\n        autoPlay: autoPlay,\n        config: this.state.config\n      }, this.props.attachData));\n    }\n  }]);\n  return KDVideo;\n}(_react[\"default\"].Component)) || _class) || _class) || _class);\nvar _default = exports[\"default\"] = KDVideo;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDVideo.jsx?");

/***/ }),

/***/ "./src/component/web/KDWebOffice.jsx":
/*!*******************************************!*\
  !*** ./src/component/web/KDWebOffice.jsx ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.promise.js */ \"../../node_modules/core-js/modules/es.promise.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _classnames2 = _interopRequireDefault(__webpack_require__(/*! classnames */ \"../../node_modules/classnames/index.js\"));\nvar _global = __webpack_require__(/*! @/global */ \"./src/global/index.js\");\nvar _componentutil = __webpack_require__(/*! @/util/componentutil */ \"./src/util/componentutil.js\");\nvar _WebOffice = _interopRequireDefault(__webpack_require__(/*! ./base/WebOffice */ \"./src/component/web/base/WebOffice.jsx\"));\nvar _VisibleLockWrap = _interopRequireDefault(__webpack_require__(/*! ../common/VisibleLockWrap */ \"./src/component/common/VisibleLockWrap.js\"));\nvar _AttachDataWrap = _interopRequireDefault(__webpack_require__(/*! ../common/AttachDataWrap */ \"./src/component/common/AttachDataWrap.js\"));\nvar _commonUtils = _interopRequireDefault(__webpack_require__(/*! ../common/commonUtils */ \"./src/component/common/commonUtils.js\"));\nvar _appModelFunction = __webpack_require__(/*! ../../model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar webofficeaction = _interopRequireWildcard(__webpack_require__(/*! ../../action/webofficeaction */ \"./src/action/webofficeaction.js\"));\nvar _ControlInfoCollect = _interopRequireDefault(__webpack_require__(/*! @/component/common/ControlInfoCollect */ \"./src/component/common/ControlInfoCollect.js\"));\nvar _WPSPlugin = _interopRequireDefault(__webpack_require__(/*! @/component/web/base/WPS/WPSPlugin */ \"./src/component/web/base/WPS/WPSPlugin.jsx\"));\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _client = __webpack_require__(/*! @/util/client */ \"./src/util/client.js\");\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _webOffice = __webpack_require__(/*! @/constant/webOffice */ \"./src/constant/webOffice.js\");\nvar _const = __webpack_require__(/*! @/constant/const */ \"./src/constant/const.js\");\nvar _appModelFunction2 = __webpack_require__(/*! @/model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar _fetchResponseHeader = __webpack_require__(/*! @/util/fetchResponseHeader */ \"./src/util/fetchResponseHeader.js\");\nvar _KDWebOffice2 = _interopRequireDefault(__webpack_require__(/*! ./KDWebOffice.less */ \"./src/component/web/KDWebOffice.less\"));\nvar _dec, _class;\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nvar WpsClient = _webOffice.OfficeEditMode.WpsClient,\n  PublicWps = _webOffice.OfficeEditMode.PublicWps,\n  PrivateWps = _webOffice.OfficeEditMode.PrivateWps,\n  OnlyOffice = _webOffice.OfficeEditMode.OnlyOffice,\n  Yozo = _webOffice.OfficeEditMode.Yozo;\nvar OnlyOfficeEditor = /*#__PURE__*/_react[\"default\"].lazy(function () {\n  return __webpack_require__.e(/*! import() */ 4956).then(__webpack_require__.bind(__webpack_require__, /*! @/component/common/onlyoffice/OnlyOfficeEditor */ \"./src/component/common/onlyoffice/OnlyOfficeEditor.jsx\"));\n});\nvar YoZoEditor = /*#__PURE__*/_react[\"default\"].lazy(function () {\n  return __webpack_require__.e(/*! import() */ 9736).then(__webpack_require__.bind(__webpack_require__, /*! @/component/common/yongzhong/YozoEditor */ \"./src/component/common/yongzhong/YozoEditor.jsx\"));\n});\nvar WPSEditor = /*#__PURE__*/_react[\"default\"].lazy(function () {\n  return Promise.all(/*! import() */[__webpack_require__.e(4074), __webpack_require__.e(4260), __webpack_require__.e(5788)]).then(__webpack_require__.bind(__webpack_require__, /*! @/component/common/wps/WPSEditor */ \"./src/component/common/wps/WPSEditor.jsx\"));\n});\nvar WebOfficeEditor = /*#__PURE__*/_react[\"default\"].lazy(function () {\n  return Promise.all(/*! import() */[__webpack_require__.e(4074), __webpack_require__.e(4260), __webpack_require__.e(6544)]).then(__webpack_require__.bind(__webpack_require__, /*! @/component/common/wps/WebOfficeEditor */ \"./src/component/common/wps/WebOfficeEditor.jsx\"));\n});\nvar KDWebOffice = (_dec = (0, _VisibleLockWrap[\"default\"])(true), (0, _AttachDataWrap[\"default\"])(_class = _dec(_class = (0, _ControlInfoCollect[\"default\"])(_class = /*#__PURE__*/function (_Component) {\n  _inherits(KDWebOffice, _Component);\n  function KDWebOffice() {\n    var _this;\n    _classCallCheck(this, KDWebOffice);\n    _this = _callSuper(this, KDWebOffice);\n    _this.showMessage = function (message) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _const.AlertType.ERROR;\n      (0, _appModelFunction2.setDataMessages)((0, _appModelFunction2.getRootPageId)()((0, _global.getGlobalState)()), [{\n        duration: 3000,\n        content: message,\n        type: type\n      }]);\n    };\n    _this.getNewKey = function (key) {\n      if (_this.officeEditMode === OnlyOffice) return \"\".concat(key, \"_\").concat(_webOffice.OnlyOfficeCtrlKey);else if (_this.officeEditMode === PublicWps || _this.officeEditMode === PrivateWps) return \"\".concat(key, \"_\").concat(_webOffice.WpsCtrlKey);else if (_this.officeEditMode === Yozo) return \"\".concat(key, \"_\").concat(_webOffice.YozoCtrlKey);\n    };\n    _this.getToken = function () {\n      var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (![PrivateWps, OnlyOffice].includes(_this.officeEditMode)) {\n        return;\n      }\n      var model = _this.props.model;\n      _this.props.dispatch(webofficeaction.getOfficeToken(model, [option]));\n    };\n    var _getRootFormConfig = (0, _componentutil.getRootFormConfig)(),\n      onlyofficeServerUrl = _getRootFormConfig.onlyofficeServerUrl,\n      accountId = _getRootFormConfig.accountId;\n    var _getOfficeEditMode = (0, _componentutil.getOfficeEditMode)(),\n      officeEditMode = _getOfficeEditMode.officeEditMode,\n      appId = _getOfficeEditMode.appId;\n    var isNewPublicWPS = appId !== undefined;\n    _this.accountId = accountId;\n    _this.officeEditMode = officeEditMode;\n    _this.newPublicWPSAppId = isNewPublicWPS ? appId : '';\n    _this.onlyofficeServerUrl = onlyofficeServerUrl;\n    _this.withThirdEditor = [OnlyOffice, PublicWps, PrivateWps, Yozo].includes(_this.officeEditMode); // 懒加载进来的控件\n    return _this;\n  }\n  _createClass(KDWebOffice, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_TRAYMENU, false);\n      if (this.withThirdEditor) {\n        var _this$props$model = this.props.model,\n          pageId = _this$props$model.pageId,\n          key = _this$props$model.key;\n        this.removeDataChangeListener = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', function (data) {\n          if (!data) return;\n          var newKey = _this2.getNewKey(key);\n          (0, _memoryCacher.publishControlMethod)(pageId, newKey, 'directives', function () {\n            var list = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n            return list.concat(data);\n          });\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this$removeDataChang;\n      (_this$removeDataChang = this.removeDataChangeListener) === null || _this$removeDataChang === void 0 || _this$removeDataChang.call(this);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _getComponentDataProp,\n        _this3 = this;\n      var model = this.props.model;\n      var style = (0, _componentutil.getCommonStyle)(model);\n      var _getCommonClass = (0, _componentutil.getCommonClass)(model),\n        Grow = _getCommonClass.Grow,\n        Shrink = _getCommonClass.Shrink;\n      var rootClassName = (0, _classnames2[\"default\"])(_defineProperty({}, _KDWebOffice2[\"default\"].root, true), (0, _commonUtils[\"default\"])({\n        Grow: Grow,\n        Shrink: Shrink\n      }));\n      var config = model.getFormConfig();\n      var objId = model.key;\n      var dataProperty = (0, _appModelFunction.getDataValue)(model.pageId, model.key)(model.state) || '';\n      var showNoChangeTip = (_getComponentDataProp = (0, _componentutil.getComponentDataProperty)(model, 'showNoChangeTip', 'showNoChangeTip', false)) !== null && _getComponentDataProp !== void 0 ? _getComponentDataProp : true;\n      var sendValidResult = function sendValidResult(model, args) {\n        return _this3.props.dispatch(webofficeaction.sendValiResult(model, args));\n      };\n      var save = function save(model, args) {\n        return _this3.props.dispatch(webofficeaction.save(model, args));\n      };\n      if (this.withThirdEditor) {\n        sendValidResult = function sendValidResult(model) {\n          return function (params) {\n            return _this3.props.dispatch(webofficeaction.sendValiResult(model, params));\n          };\n        };\n        save = function save(model) {\n          return function (params) {\n            return _this3.props.dispatch(webofficeaction.save(model, params));\n          };\n        };\n      }\n      if (this.officeEditMode === OnlyOffice) {\n        return /*#__PURE__*/_react[\"default\"].createElement(OnlyOfficeEditor, {\n          accountId: this.accountId,\n          className: rootClassName,\n          pageId: model.pageId,\n          ctrlKey: model.key,\n          documentServerUrl: this.onlyofficeServerUrl,\n          style: style,\n          getToken: this.getToken,\n          save: save(model),\n          sendValidResult: sendValidResult(model),\n          showMessage: this.showMessage,\n          showNoChangeTip: showNoChangeTip\n        });\n      } else if (this.officeEditMode === PublicWps || this.officeEditMode === PrivateWps) {\n        var _Component2 = this.newPublicWPSAppId ? WebOfficeEditor : WPSEditor;\n        var token = (0, _fetchResponseHeader.getResponseHeader)(_const.CSRF_TOKEN);\n        var _getToken = null;\n        if (this.officeEditMode === PrivateWps) {\n          token = null;\n          _getToken = this.getToken;\n        }\n        return /*#__PURE__*/_react[\"default\"].createElement(_Component2, {\n          accountId: this.accountId,\n          appId: this.newPublicWPSAppId,\n          className: rootClassName,\n          pageId: model.pageId,\n          ctrlKey: model.key,\n          token: token,\n          save: save(model),\n          style: style,\n          getToken: _getToken,\n          sendValidResult: sendValidResult(model),\n          showNoChangeTip: showNoChangeTip\n        });\n      } else if (this.officeEditMode === Yozo) {\n        return /*#__PURE__*/_react[\"default\"].createElement(YoZoEditor, {\n          className: rootClassName,\n          pageId: model.pageId,\n          ctrlKey: model.key,\n          style: style,\n          save: save(model),\n          sendValidResult: sendValidResult(model),\n          showNoChangeTip: showNoChangeTip\n        });\n      } else if (!(0, _client.isWin)() || this.officeEditMode === WpsClient) {\n        return /*#__PURE__*/_react[\"default\"].createElement(_WPSPlugin[\"default\"], {\n          model: model,\n          sendValidResult: sendValidResult,\n          save: save\n        });\n      } else {\n        return /*#__PURE__*/_react[\"default\"].createElement(_WebOffice[\"default\"], _extends({\n          className: rootClassName,\n          isDesigner: false,\n          style: style\n        }, this.props.attachData, {\n          model: model,\n          objId: objId,\n          config: config\n        }, this.props, {\n          dataProperty: dataProperty\n        }, (0, _componentutil.createActions)(webofficeaction, this.props.dispatch)));\n      }\n    }\n  }]);\n  return KDWebOffice;\n}(_react.Component)) || _class) || _class) || _class);\nvar _default = exports[\"default\"] = KDWebOffice;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDWebOffice.jsx?");

/***/ }),

/***/ "./src/component/web/base/WPS/WPSPlugin.jsx":
/*!**************************************************!*\
  !*** ./src/component/web/base/WPS/WPSPlugin.jsx ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar wpsDirectives = _interopRequireWildcard(__webpack_require__(/*! @/util/wpsDirectives */ \"./src/util/wpsDirectives.js\"));\nvar _wpsUtils = __webpack_require__(/*! @/util/wpsUtils */ \"./src/util/wpsUtils.js\");\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nvar WPSPlugin = function WPSPlugin(_ref) {\n  var model = _ref.model,\n    sendValidResult = _ref.sendValidResult,\n    save = _ref.save;\n  var openStatus = (0, _react.useRef)(0); // 0 初始态，1 执行 open 中， 2 执行完毕\n  var delayFunctions = (0, _react.useRef)([]);\n  (0, _react.useEffect)(function () {\n    (0, _wpsUtils.install)();\n  }, []);\n  (0, _react.useEffect)(function () {\n    (0, _wpsUtils.getWpsApiEvent)().AddApiEventListener('DocumentBeforeSave', function (doc, saveAsUI, cancel) {\n      // 不允许保存\n      if (!saveAsUI) {\n        cancel.Value = true;\n      }\n    });\n    return function () {\n      (0, _wpsUtils.getWpsApiEvent)().RemoveApiEventListener('DocumentBeforeSave');\n    };\n  }, []);\n  (0, _react.useEffect)(function () {\n    if (!model) return;\n    var executeControlMethod = function executeControlMethod(event) {\n      if (event === undefined || Array.isArray(event) && event.length === 0) return;\n      if (event[0].methodname === 'webOfficeAction') {\n        var methodName = event[0].args[0].event;\n        var data = Array.isArray(event[0].args[0].data) ? event[0].args[0] : event[0].args[0].data;\n        var callbacks = {\n          sendValidResult: sendValidResult,\n          save: save\n        };\n        // open 指令后的指令都需要在 open 完成之后才能执行\n        // 否则文档还没打开的话，指令执行会出问题\n        if (methodName === 'open' && openStatus.current === 0) {\n          openStatus.current = 1;\n          callbacks.openSuccess = function () {\n            openStatus.current = 2;\n            delayFunctions.current.forEach(function (_ref2) {\n              var methodName = _ref2.methodName,\n                data = _ref2.data;\n              wpsDirectives[methodName](data, model, callbacks);\n            });\n            delayFunctions.current = [];\n          };\n          callbacks.openFailed = function () {\n            openStatus.current = 2;\n            delayFunctions.current.forEach(function (_ref3) {\n              var methodName = _ref3.methodName,\n                data = _ref3.data;\n              wpsDirectives[methodName](data, model, callbacks);\n            });\n            delayFunctions.current = [];\n          };\n          wpsDirectives.open(data, model, callbacks);\n        } else if (openStatus.current === 1) {\n          delayFunctions.current.push({\n            methodName: methodName,\n            data: data\n          });\n        } else {\n          wpsDirectives[methodName](data, model, callbacks);\n        }\n      }\n    };\n    var pageId = model.pageId,\n      key = model.key;\n    var removeListener = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', executeControlMethod);\n    return function () {\n      removeListener();\n    };\n  }, [model]);\n  return /*#__PURE__*/_react[\"default\"].createElement(\"div\", null);\n};\nvar _default = exports[\"default\"] = WPSPlugin;\n\n//# sourceURL=webpack://bos-platform/./src/component/web/base/WPS/WPSPlugin.jsx?");

/***/ }),

/***/ "./src/component/web/base/WebOffice.jsx":
/*!**********************************************!*\
  !*** ./src/component/web/base/WebOffice.jsx ***!
  \**********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-properties.js */ \"../../node_modules/core-js/modules/es.object.define-properties.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptors.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptors.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/web.timers.js */ \"../../node_modules/core-js/modules/web.timers.js\");\nvar _react = _interopRequireDefault(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _classnames2 = _interopRequireDefault(__webpack_require__(/*! classnames */ \"../../node_modules/classnames/index.js\"));\nvar _memoryCacher = __webpack_require__(/*! ../../../model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _server = __webpack_require__(/*! @/action/actionname/control/weboffice/server */ \"./src/action/actionname/control/weboffice/server/index.js\");\nvar _WebOffice2 = _interopRequireDefault(__webpack_require__(/*! ./WebOffice.less */ \"./src/component/web/base/WebOffice.less\"));\nvar allDirective = _interopRequireWildcard(__webpack_require__(/*! ../../../util/webOfficeDirective */ \"./src/util/webOfficeDirective.js\"));\nvar _intlApi = __webpack_require__(/*! ../../../i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _webOffice = __webpack_require__(/*! ../../../constant/webOffice */ \"./src/constant/webOffice.js\");\nvar _webOfficeUtil = __webpack_require__(/*! ../../../util/webOfficeUtil */ \"./src/util/webOfficeUtil.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); } // import PropTypes from 'prop-types'\nvar WebOffice = exports[\"default\"] = /*#__PURE__*/function (_React$Component) {\n  _inherits(WebOffice, _React$Component);\n  function WebOffice() {\n    var _this;\n    _classCallCheck(this, WebOffice);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, WebOffice, [].concat(_args));\n    _this.writePermission = function () {\n      if (_this.webOffice) {\n        _this.webOffice.UserName = _webOffice.PERMISSION_INFO;\n        _this.webOffice.Authorizer = _webOffice.SUPPLIER_URL;\n      }\n    };\n    _this.executeControlMethod = function (event) {\n      var timer = null;\n      if (event === undefined || Array.isArray(event) && event.length === 0) return;\n      if (event[0].methodname === _server.WEB_OFFICE_ACTION) {\n        var methodName = event[0].args[0].event;\n        var data = _this.getData(event[0].args[0]);\n        var eventFun = allDirective[methodName];\n        clearTimeout(timer);\n        timer = setTimeout(function () {\n          try {\n            console.log('weboffice执行', methodName);\n            _this.webOffice && eventFun && eventFun(data, _objectSpread({}, _this.props))(_this.webOffice);\n          } catch (err) {\n            console.warn(err);\n            // this.props.afterOperation(this.props.model, [{ key, methodName, result: 'failed' }])\n          }\n        }, 0);\n      }\n    };\n    _this.getData = function (args) {\n      return Array.isArray(args.data) ? args : args.data;\n    };\n    _this.loadCtrl = function () {\n      if (!!window.ActiveXObject || 'ActiveXObject' in window) {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"object\", {\n          style: {\n            width: '100%',\n            height: '100%'\n          },\n          ref: function ref(webOffice) {\n            _this.webOffice = webOffice;\n          },\n          id: _this.props.objId,\n          classID: _webOffice.CLASSID,\n          codebase: _webOffice.CODEBASE\n        }, /*#__PURE__*/_react[\"default\"].createElement(\"param\", {\n          name: \"Menubar\",\n          value: \"1\"\n        }), /*#__PURE__*/_react[\"default\"].createElement(\"param\", {\n          name: \"Titlebar\",\n          value: \"1\"\n        }), /*#__PURE__*/_react[\"default\"].createElement(\"param\", {\n          name: \"Toolbars\",\n          value: \"1\"\n        }));\n      } else {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: _WebOffice2[\"default\"]['weboffice-preview']\n        }, (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0001'\n        }));\n      }\n    };\n    return _this;\n  }\n  _createClass(WebOffice, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      this.writePermission();\n      var model = this.props.model;\n      if (!model) return;\n      var key = model.key,\n        pageId = model.pageId;\n      this.removeDataChangeListener = (0, _memoryCacher.subscribeControlMethod)(pageId, key, 'directives', this.executeControlMethod);\n      this.webOffice && (0, _webOfficeUtil.beforeClose)(function () {\n        return _this2.props.beforeClose(model, [{\n          key: key,\n          pageId: pageId\n        }]);\n      }, function () {\n        return allDirective.isDirty(_this2.webOffice);\n      });\n      this.webOffice && (0, _GlobalDataCacher.setData)(_symbolConst.KEY_WEBOFFICE_RUNNING, true);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.removeDataChangeListener && this.removeDataChangeListener();\n      var data = {};\n      allDirective.close(data, this)(this.webOffice);\n      this.webOffice && (0, _GlobalDataCacher.setData)(_symbolConst.KEY_WEBOFFICE_RUNNING, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        style = _this$props.style,\n        className = _this$props.className;\n      var rootlClassName = (0, _classnames2[\"default\"])(_defineProperty(_defineProperty({}, className, className), _WebOffice2[\"default\"]['weboffice-default'], true));\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        style: style,\n        className: rootlClassName\n      }, this.loadCtrl());\n    }\n  }]);\n  return WebOffice;\n}(_react[\"default\"].Component);\n\n//# sourceURL=webpack://bos-platform/./src/component/web/base/WebOffice.jsx?");

/***/ }),

/***/ "./src/util/webOfficeDirective.js":
/*!****************************************!*\
  !*** ./src/util/webOfficeDirective.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.toggleShowTraces = exports.showTracesByRole = exports.setTrackingMode = exports.setToolbars = exports.setTitlebar = exports.setTextAsTitle = exports.setSelectionEditArea = exports.setSelectionAsField = exports.setMenubar = exports.setDynamicTable = exports.setDocUnLimitByRole = exports.setDocUnLimit = exports.setDocLimitByRole = exports.setDocLimit = exports.setDocAsField = exports.setCheckBoxValue = exports.setCaption = exports.sendTextByField = exports.sendOpenStatus = exports.sendIsFieldRevise = exports.sendIsDocChange = exports.sendFieldExist = exports.sendAllField = exports.sendAllCheckBox = exports.saveAsLocal = exports.save = exports.openNew = exports.open = exports.modifyMark = exports.mergeDocs = exports.locateMark = exports.isDirty = exports.insertValue = exports.insertPictures = exports.docProtect = exports.docCompare = exports.deleteMark = exports.delMark = exports.close = exports.cancelSelectionEditArea = exports.callEditorFunction = exports.addTextMark = exports.addTableRows = exports.addTableColumns = exports.addPicMark = exports.addMark = exports.addCommentDialog = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.last-index-of.js */ \"../../node_modules/core-js/modules/es.array.last-index-of.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.parse-int.js */ \"../../node_modules/core-js/modules/es.parse-int.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.string.ends-with.js */ \"../../node_modules/core-js/modules/es.string.ends-with.js\");\n__webpack_require__(/*! core-js/modules/es.string.match.js */ \"../../node_modules/core-js/modules/es.string.match.js\");\n__webpack_require__(/*! core-js/modules/es.string.replace.js */ \"../../node_modules/core-js/modules/es.string.replace.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _componentutil = __webpack_require__(/*! ../util/componentutil */ \"./src/util/componentutil.js\");\nvar _appModelFunction = __webpack_require__(/*! ../model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar _intlApi = __webpack_require__(/*! ../i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _webOfficeUtil = __webpack_require__(/*! @/util/webOfficeUtil */ \"./src/util/webOfficeUtil.js\");\nvar _requestParamsUtil = __webpack_require__(/*! @/util/requestParamsUtil */ \"./src/util/requestParamsUtil.js\");\nvar _webOffice = __webpack_require__(/*! @/constant/webOffice */ \"./src/constant/webOffice.js\");\nvar _const = __webpack_require__(/*! @/constant/const */ \"./src/constant/const.js\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\n/**\n * 设置是否显示标题栏\n * @param {object} data {value:true\\false}\n * @param {object} props webOffice\n */\nvar setTitlebar = exports.setTitlebar = function setTitlebar(data, props) {\n  return function (webOffice) {\n    webOffice.Titlebar = data.value;\n  };\n};\n\n/**\n * 设置是否显示工具栏\n * @param {object} data {value:true\\false}\n * @param {object} props webOffice\n */\nvar setToolbars = exports.setToolbars = function setToolbars(data, props) {\n  return function (webOffice) {\n    webOffice.Toolbars = data.value;\n  };\n};\n\n/**\n * 设置是否显示菜单栏\n * @param {object} data {value:true\\false}\n * @param {object} props webOffice\n */\nvar setMenubar = exports.setMenubar = function setMenubar(data, props) {\n  return function (webOffice) {\n    webOffice.Menubar = data.value;\n  };\n};\n\n/**\n * 添加控件标题栏文字\n * @param {object} data {value:\"标题栏文字\"}\n * @param {object} props webOffice\n */\nvar setCaption = exports.setCaption = function setCaption(data, props) {\n  return function (webOffice) {\n    webOffice.Caption = data.value || (0, _intlApi.getLangMsg)({\n      key: 'webOffice.key0002'\n    });\n  };\n};\n\n/**\n * 打开Office文档包括（.doc、.docx、.xls、.xlsx），打开前先将本地Office窗口关闭\n * @param {object} data {\"url\":\"文档url\",\"userName\":\"用户名\",\"name\":\"文件名\"}\n * @param {object} props webOffice\n */\nvar open = exports.open = function open() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    var model = props.model;\n    var pageId = model.pageId;\n    var url = data.url,\n      userName = data.userName;\n    if (!url) {\n      (0, _appModelFunction.setDataMessages)(pageId, {\n        content: (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0003'\n        }),\n        type: _const.AlertType.ERROR\n      });\n      return;\n    }\n    var fileType = data.name && getFileExtension(data.name) || 'Word.Document';\n    try {\n      url = (0, _requestParamsUtil.appendParamsToUrl)(url, {\n        model: model\n      });\n      webOffice.Close();\n      webOffice.Open(url, false, fileType); // false  只读？\n      webOffice.SetCurrUserName(userName);\n    } catch (e) {\n      console.error('open 指令执行失败', e);\n      var msgData = {\n        messageType: 0,\n        msg: (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0004'\n        }),\n        detail: e\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n    }\n  };\n};\nvar getFileExtension = function getFileExtension(fileName) {\n  if (typeof fileName !== 'string') return;\n  var index = fileName.lastIndexOf('.');\n  var length = fileName.length;\n  return fileName.substring(index + 1, length);\n};\n\n/**\n * @param {object} data {\"fileType\":\"Word.Document\"}\n * @param {object} props webOffice\n */\nvar openNew = exports.openNew = function openNew(data, props) {\n  return function (webOffice) {\n    // \"Excel.Sheet\",\"Word.Document\",\"PowerPoint.Show\"\n    var fileType = data.fileType || 'Word.Document';\n    webOffice.CreateNew(fileType);\n  };\n};\n\n/**\n * 同步保存\n * @param {object} data {\"uploadUrl\":\"上传文件服务器地址（必须是完整url）\",\"name\":\"文件名称（包含后缀）\"}\n * @param {object} props webOffice\n */\nvar save = exports.save = function save() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    if (!webOffice.ActiveDocument) return;\n    var model = props.model;\n    // 服务器地址不对怎么办， 添加默认服务器地址,必须是完整url\n    // data.uploadUrl = 'https://feature.kingdee.com:2024/devbos/attachment/uploadFile.do'\n    var name = data.name,\n      uploadUrl = data.uploadUrl,\n      id = data.id,\n      isSplitRedis = data.isSplitRedis;\n    var uid = (0, _componentutil.createNewId)();\n    var formData = (0, _requestParamsUtil.getRequestParams)(model, {\n      name: name\n    });\n    try {\n      webOffice.HttpInit();\n      Object.keys(formData).forEach(function (key) {\n        if (formData[key]) {\n          webOffice.HttpAddPostString(key, formData[key]);\n        }\n      });\n      if (isSplitRedis || isSplitRedis === undefined) {\n        webOffice.HttpAddPostCurrFile('uid', uid); // 文件id\n      } else {\n        // MC参数 tempfile.cachetype的值非splitRedis时，后端会获取filename校验文件名后缀，原有filename为uid值，导致报错，故改之\n        webOffice.HttpAddPostString('uid', uid);\n        webOffice.HttpAddPostCurrFile('name', name); // 文件name\n      }\n      uploadUrl = (0, _requestParamsUtil.appendParamsToUrl)(uploadUrl);\n      var response = webOffice.HttpPost(uploadUrl);\n      var res = JSON.parse(response) || '';\n      // 302怎么处理\n      if (res.status === 'success') {\n        var args = [{\n          name: name,\n          // status: response.status,\n          // // type: data.type || '',//文件类型\n          // fileId: data.fileId || '',//id\n          // lastModified: new Date().getTime(),\n          // size: \"\",\n          // status: \"success\",\n          // type: \"type\",\n          uid: uid,\n          url: res.url,\n          id: id\n        }];\n        props.save && props.save(model, args);\n      } else {\n        var msgData = {\n          messageType: 0,\n          msg: (0, _intlApi.getLangMsg)({\n            key: 'webOffice.key0006'\n          })\n        };\n        (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n      }\n    } catch (e) {\n      console.error('save 指令执行失败', e);\n      var _msgData = {\n        msg: (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0006'\n        }),\n        detail: e\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, _msgData);\n    }\n  };\n};\n\n// 异步保存， 导致浏览器出错暂放弃\n// export const save1 = (webOffice, data) => { // This is likely due to browser flakiness浏览器脆弱原因导致保存不了\n//   console.log('执行weboffice document 的save方法', webOffice)\n//   // webOffice.Save('https://ierp.kingdee.com:2024/devpic/fileserver/attachment/uploadFile.do')\n//   try {\n//    webOffice.Save(' https://ierp.kingdee.com:2024/devpic/fileserver/attachment/uploadFile.do')\n//     window.alert('文档保存成功')\n//   } catch (e) {\n//     console.log('文档保存失败', e)\n//   }\n// }\n\n/**\n * 关闭文档\n * @param {object} data\n * @param {object} props webOffice\n */\nvar close = exports.close = function close(data, props) {\n  return function (webOffice) {\n    webOffice && webOffice.Close();\n  };\n};\n\n// 打开 spyApi.doPostActions(\"pageId\",'InvokeControlMethod',[{props: [ {data:{'uploadUrl':'https://feature.kingdee.com:2024/devbos/attachment/uploadFile.do', lockData:[{name:'甲方',isLock:'true', pwd:'123', dataField:[{'data1':[{field1:'标签1'},{'field2':'标签2'}]]}, {name:'乙方',isLock:'true', pwd:'123', dataField:[]}]}, 'event':'save'} ], key: \"webofficeap\", methodname: \"webOfficeAction\"}])\n/**\n * 在光标位置插入文本内容\n * @param {object} data {\"needEnterBefore\":true\\false是否需要在插入文本前添加回车换行（可触发office自动编号）}\n * @param {object} props webOffice\n */\nvar insertValue = exports.insertValue = function insertValue() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    var needEnterBefore = data.needEnterBefore,\n      value = data.value;\n    var enter = '';\n    if (needEnterBefore) {\n      enter = '\\r\\n';\n    }\n    var newValue = enter.concat(value);\n    webOffice.ActiveDocument && webOffice.ActiveDocument.Application.Selection.Range.InsertAfter(newValue);\n  };\n};\nvar addComment = function addComment(webOffice, data) {\n  webOffice.ActiveDocument.Application.Selection.Comments.Add(webOffice.ActiveDocument.Application.Selection.Range);\n  webOffice.ActiveDocument.Application.Selection.Comments.Item(1).Edit();\n};\n\n/**\n * 在光标位置或选中文字处插入批注\n * @param {object} data\n * @param {object} props webOffice\n */\nvar addCommentDialog = exports.addCommentDialog = function addCommentDialog(data, props) {\n  return function (webOffice) {\n    // webOffice.WebDialogs(161)\n    addComment(webOffice, data);\n  };\n};\n\n/**\n * 文本比较（暂不支持docx格式的文档比较），使用此功能需更改本地Office设置，比较结果会在本地Office打开\n * @param {object} data {\"currentFile\":\"原文档名称.doc\",currentFileUrl：\"原文档url\",\"compareFile\":\"比较文档名称.doc\",\"compareFileUrl\":\"比较文档url\"}\n * @param {object} props webOffice\n */\nvar docCompare = exports.docCompare = function docCompare() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    /**\n       * 判断是否为空, 比较失败可能因为文件损坏了\n       */\n    var currentFile = data.currentFile,\n      compareFile = data.compareFile,\n      currentFileUrl = data.currentFileUrl,\n      compareFileUrl = data.compareFileUrl; // word的文件名\n    if (!(currentFileUrl || compareFileUrl || currentFile || compareFile)) {\n      return;\n    }\n    // 打开后加入用于比较vba宏代码\n    var VBAScript = \"\\n        Sub AutoOpen()\\n        If IsFileExists(\\\"#path#\\\") Then\\n        ActiveDocument.Compare Name:=\\\"#path#\\\"\\n        End If\\n        End Sub\\n        Function IsFileExists(ByVal strFileName As String) As Boolean\\n            If Dir(strFileName, 16) <> Empty Then\\n                IsFileExists = True\\n            Else\\n                IsFileExists = False\\n            End If\\n        End Function\\n      \";\n    try {\n      // webOffice.UserName = '金蝶软件（中国）有限公司'\n      webOffice.Close();\n      webOffice.Open(currentFileUrl, true, 'Word.Document', '', '');\n      if (!webOffice.VBProject.VBComponents) {\n        var msgData = {\n          msg: (0, _intlApi.getLangMsg)({\n            key: 'webOffice.key0008'\n          }),\n          messageType: 0\n        };\n        (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n      }\n      var j = webOffice.VBProject.VBComponents(1).CodeModule.CountOfLines;\n      webOffice.VBProject.VBComponents(1).CodeModule.DeleteLines(1, j);\n      compareFile = webOffice.TempFilePath + '' + compareFile;\n      webOffice.DownLoadFile(compareFileUrl, compareFile);\n      VBAScript = VBAScript.replace(/#path#/g, compareFile);\n      webOffice.VBProject.VBComponents(1).CodeModule.AddFromString(VBAScript);\n      var strPath = webOffice.TempFilePath + '' + currentFile;\n      // 保存文档到本地\n      webOffice.ActiveDocument.Saveas(strPath, 0); // 0是关键doc，类型, 12xml , 16docx\n      webOffice.CompareOpen(strPath);\n      // webOffice.ActiveDocument.Application.ScreenRefresh()\n      // webOffice.ActiveDocument.Application.ScreenUpdating = true\n      // if (hasSave) {\n      //   webOffice.Close()\n      //   webOffice.Open(oldFileTempPath, true, 'Word.Document', '', '')\n      // }\n    } catch (e) {\n      console.error((0, _intlApi.getLangMsg)({\n        key: 'webOffice.key0004'\n      }), e);\n      var _msgData2 = {\n        messageType: 0,\n        msg: (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0009'\n        }),\n        detail: e\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, _msgData2);\n    }\n  };\n};\n\n/**\n * strFieldName：书签的名字\n * strSheetName：预留字段（值为空）\n * 返回值: 返回书签的值\n */\n\n// 批量添加变量，1.页面关闭前需要关闭控件，智能窗不存在这个问题 2.判断是否打开状态，3.设置变量后不能在前面添加， 4.失败的情况怎么处理，5.用到多个变量需要给他添加不同field名称，field是唯一的6.判断书签是否存在,标签值不允许为空 7.32位，以管理员运行\n/**\n * 在光标位置插入一个书签，用于定义模板变量，书签即变量\n * @param {object} data {\"field\":\"书签名称\",\"value\":\"{变量名称}\"}\n * @param {object} props webOffice\n */\nvar addMark = exports.addMark = function addMark() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    // 不允许连续插入书签\n    // data = { objId: 'webofficeap', data: [{ field: 'field1', value: '{变量}' }] }\n    // const items = data.data || [{ field: 'field1', value: '{变量}' }]\n    // if (Array.isArray(items)) {\n    //   items.forEach((item) => {\n    //     webOffice.SetFieldValue(item.field, item.value, '::ADDMARK::')\n    //   })\n    // }\n    var field = data.field,\n      value = data.value;\n    webOffice.SetFieldValue(field, value, '::ADDMARK::');\n  };\n};\n\n/**\n * 替换书签的值 （支持批量替换）\n * @param {object} data [{\"field\":\"书签名称1\",\"value\":\"变量的值1\"},{\"field\":\"书签名称2\",\"value\":\"变量的值2\"}]\n * @param {object} props webOffice\n */\nvar modifyMark = exports.modifyMark = function modifyMark(data, props) {\n  return function (webOffice) {\n    var items = data.data;\n    Array.isArray(items) && items.forEach(function (item) {\n      // const preValue = this.getValueByFieldName(webOffice, item.field)\n      var field = item.field,\n        value = item.value;\n      if (!isFieldExist(webOffice, field)) return;\n      // webOffice.ActiveDocument.Bookmarks.Item(field).Range.Text = value\n      var range = webOffice.ActiveDocument.Bookmarks.Item(field).Range;\n      range.Text = value;\n      webOffice.ActiveDocument.Bookmarks.Add(field, range);\n      // webOffice.ReplaceText(preValue, item.value, 1)\n      // webOffice.SetFieldValue(field, value, '::ADDMARK::')// 替换后书签会失效，需要重新设置标签\n    });\n  };\n};\n\n/**\n   * 删除文档中书签（支持批量删除）\n   * @param {object} data [{\"field\":\"书签名称1\"}, { \"field\":\"书签名称2\"}]\n   * @param {object} props webOffice\n   */\nvar deleteMark = exports.deleteMark = function deleteMark(data, props) {\n  return function (webOffice) {\n    var items = data.data;\n    if (Array.isArray(items)) {\n      items.forEach(function (item) {\n        isFieldExist(webOffice, item.field) && webOffice.SetFieldValue(item.field, '', '::DELMARK::');\n      });\n    }\n    // webOffice.SetFieldValue('fileName', '', '::DELMARK::')\n  };\n};\n\n/**\n   * 定位到某个书签的位置\n   * @param {object} data {\"field\":\"书签名称1\"}\n   * @param {object} props webOffice\n   */\nvar locateMark = exports.locateMark = function locateMark(data, props) {\n  return function (webOffice) {\n    var field = data.field;\n    isFieldExist(webOffice, field) && webOffice.SetFieldValue(field, '', '::GETMARK::');\n  };\n};\nvar isFieldExist = function isFieldExist(webOffice, field) {\n  return webOffice.ActiveDocument.BookMarks.Exists(field);\n};\n\n/**\n * todo:提示文档已锁定， 密码加密传输\n * isProtect参数设为0时，才能设置文档只允许修订\\只允许添加批注\\完全保护（不允许任何操作）\n * @param {object} data {\"isProtect\": 0保护\\1解除保护,\"protectType\":0只允许修订\\1只允许添加批注\\2完全保护,\"password\":\"文档保护的密码\"}\n * @param {object} props webOffice\n */\nvar docProtect = exports.docProtect = function docProtect() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    var isProtect = data.isProtect,\n      protectType = data.protectType,\n      password = data.password;\n    webOffice.ProtectDoc(isProtect, protectType, password);\n  };\n};\n\n// 先执行局部编辑， 再把可编辑区域划分出来\n\n/**\n * 开启区域限制，开启后文档将被限制编辑，只有允许编辑的区域才能被编辑\n * @param {object} data {\"password\":\"密码\"}\n * @param {object} props webOffice\n */\nvar setDocLimit = exports.setDocLimit = function setDocLimit() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    // 局部编辑\n    var password = data.password;\n    try {\n      webOffice.ActiveDocument.Protect(3, false, password, false, false); // 表格\n    } catch (e) {\n      console.error('setDocLimit 指令执行失败', e);\n    }\n  };\n};\n\n// 解除限制\n/**\n * 解除区域限制，文档恢复可编辑状态\n * @param {object} data {\"password\":\"密码\"}\n * @param {object} props webOffice\n */\nvar setDocUnLimit = exports.setDocUnLimit = function setDocUnLimit() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    var password = data.password;\n    webOffice.ActiveDocument.Application.ActiveDocument.UnProtect(password);\n  };\n};\n\n/**\n * 设置选中区域为可编辑区域，编辑模板时使用（选中区域将被设置为书签）\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar setSelectionEditArea = exports.setSelectionEditArea = function setSelectionEditArea() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    var field = data.field;\n    // webOffice.SetFieldValue(data.field, webOffice.ActiveDocument.Application.Selection.text, '::ADDMARK::')\n    webOffice.ActiveDocument.Bookmarks.Add(field, webOffice.ActiveDocument.Application.Selection.Range);\n    isFieldExist(webOffice, field) && webOffice.SetFieldValue(field, '', '::GETMARK::');\n    webOffice.ActiveDocument.Application.Selection.Editors.Add(-1);\n  };\n};\n\n/**\n * 取消选中区域的第一个书签内容的编辑状态（对应书签将被删除）\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar cancelSelectionEditArea = exports.cancelSelectionEditArea = function cancelSelectionEditArea() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {\n    var field = data.field;\n    webOffice.ActiveDocument.Application.Selection.Editors(-1).Delete();\n    // webOffice.SetFieldValue(field, '', '::DELMARK::')\n    webOffice.ActiveDocument.Bookmarks(field).Delete(); // 只删除书签，保留对应文本\n  };\n};\n\n/**\n * 批量设置书签内容为可编辑，并开启区域限制，其他区域将被锁定\n * @param {object} data {\"field\":[\"书签名称1\",\"书签名称2\"],\"password\":\"密码\"}\n * @param {object} props webOffice\n */\nvar setDocLimitByRole = exports.setDocLimitByRole = function setDocLimitByRole(data, props) {\n  return function (webOffice) {\n    var items = data.field;\n    var password = data.password;\n    items.forEach(function (item) {\n      var mark = item;\n      // const markNext = fieldNext// 暂时不用\n      // try {\n      webOffice.SetFieldValue(mark, '', '::GETMARK::');\n      // } catch (e) {\n      //   webOffice.SetFieldValue(markNext, '', '::GETMARK::')// 预留的书签\n      //   webOffice.SetFieldValue(markNext, '', '::DELMARK::')\n      //   webOffice.SetFieldValue(mark, '      ', '::ADDMARK::')\n      //   webOffice.SetFieldValue(markNext, '', '::ADDMARK::')\n      //   webOffice.ActiveDocument.Bookmarks(mark).range.Editors.Add(-1)// 设置书签为可编辑区域\n      // }\n      // 设定A1书签为可编辑状态\n      try {\n        webOffice.SetFieldValue(mark, '', '::GETMARK::'); // 查找书签\n        var a = webOffice.GetFieldValue(mark, ''); // 得到书签内容\n        if (a === '') {\n          webOffice.SetFieldValue(mark, '     ', '::ADDMARK::');\n        } // 加入空格符，用于提供输入位置\n        webOffice.ActiveDocument.Bookmarks(mark).range.Editors.Add(-1); // 设置书签为可编辑区域\n      } catch (e) {\n        console.error('setDocLimitByRole 指令执行失败', e);\n      }\n    });\n    // 最后一个参数是限制格式和编辑属性， 开启后无法在可编辑区域编辑格式\n    webOffice.ActiveDocument.Application.ActiveDocument.Protect(3, false, password, false, false); // 开启保护文档功能并设定密码为:123，mark1书签为可编辑\n  };\n};\n\n/**\n *批量取消取消书签内容的可编辑状态\n * @param {object} data [{\"field\":\"书签名称1\"}，{\"field\":\"书签名称2\"}]\n * @param {object} props webOffice\n */\nvar setDocUnLimitByRole = exports.setDocUnLimitByRole = function setDocUnLimitByRole(data, props) {\n  return function (webOffice) {\n    var items = data.data;\n    items.forEach(function (item) {\n      var mark = item.field;\n      try {\n        webOffice.ActiveDocument.Bookmarks(mark).range.Editors(-1).Delete();\n        // WebOffice.ActiveDocument.Application.ActiveDocument.UnProtect(\"123\");\n      } catch (e) {\n        console.error('setDocUnLimitByRole 指令执行失败', e);\n      }\n    });\n  };\n};\nvar getTextByField = function getTextByField(webOffice, field) {\n  return webOffice.GetFieldValue(field, '');\n};\n\n/**\n * 根据书签名称获取文本内容并发送后端\n * @param {object} data {\"field\":\"书签名称\",\"id\":\"回调的id\"}\n * @param {object} props webOffice\n */\nvar sendTextByField = exports.sendTextByField = function sendTextByField(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    var field = data.field,\n      id = data.id;\n    var result = getTextByField(webOffice, field);\n    sendValiResult(model, [{\n      data: {\n        result: result,\n        field: field\n      },\n      id: id,\n      type: 'getTextByField'\n    }]);\n  };\n};\nvar getRevisionsCountByField = function getRevisionsCountByField(webOffice, field) {\n  getSelectionByField(webOffice, field);\n  var selection = webOffice.ActiveDocument.Application.Selection;\n  return selection.Range.Revisions.Count;\n};\nvar isFieldRevise = function isFieldRevise(webOffice, field) {\n  return getRevisionsCountByField(webOffice, field) > 0;\n};\n\n/**\n * 书签内容是否有任意改动（包含样式、批注等），并将结果发给后端\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar sendIsFieldRevise = exports.sendIsFieldRevise = function sendIsFieldRevise(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    var field = data.field,\n      id = data.id;\n    var result = isFieldRevise(webOffice, field);\n    sendValiResult(model, [{\n      data: {\n        result: result,\n        field: field\n      },\n      id: id,\n      type: 'isFieldRevise'\n    }]);\n  };\n};\nvar getAllField = function getAllField(webOffice) {\n  var count = webOffice.ActiveDocument.Bookmarks.Count;\n  var nameArr = [];\n  for (var i = 1; i <= count; i++) {\n    nameArr.push(webOffice.ActiveDocument.Bookmarks(i).Name);\n  }\n  return nameArr;\n};\n\n/**\n * 判断当前书签是否存在，并将结果发送给后端\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar sendFieldExist = exports.sendFieldExist = function sendFieldExist(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    var field = data.field,\n      id = data.id;\n    var result = isFieldExist(webOffice, field);\n    sendValiResult(model, [{\n      data: {\n        result: result,\n        field: field\n      },\n      id: id,\n      type: 'fieldExist'\n    }]);\n  };\n};\n\n/**\n * 获取当前文档所有书签，并将结果发送给后端\n * @param {object} data\n * @param {object} props webOffice\n */\nvar sendAllField = exports.sendAllField = function sendAllField(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    var result = getAllField(webOffice);\n    var id = data.id;\n    sendValiResult(model, [{\n      data: result,\n      id: id,\n      type: 'allField'\n    }]);\n  };\n};\n\n/**\n * 判断当前文档是否已更改，并将结果发送给后端\n * @param {object} data\n * @param {object} props webOffice\n */\nvar sendIsDocChange = exports.sendIsDocChange = function sendIsDocChange(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    var result = isDirty(webOffice);\n    var id = data.id;\n    sendValiResult(model, [{\n      data: result,\n      id: id,\n      type: 'isDocChange'\n    }]);\n  };\n};\n\n// webOffice.GetApplication.username = userName || ''\n/**\n * 开启强制留痕模式,开启后所有修改痕迹将被记录\n * @param {object} data {\"userName\":\"\",\"trackType\":1开启留痕模式并开始修订\\0关闭留痕模式\\4接受当前所有修订}\n * @param {object} props webOffice\n */\nvar setTrackingMode = exports.setTrackingMode = function setTrackingMode(data, props) {\n  return function (webOffice) {\n    var userName = data.userName,\n      trackType = data.trackType;\n    webOffice.SetTrackRevisions(trackType); // 1开始修订，0进入非留痕， 4接受当前修订\n    webOffice.SetCurrUserName(userName);\n  };\n};\n\n/**\n * 切换显示痕迹（显示或隐藏修改痕迹）\n * @param {object} data\n * @param {object} props webOffice\n */\nvar toggleShowTraces = exports.toggleShowTraces = function toggleShowTraces(data, props) {\n  return function (webOffice) {\n    webOffice.ActiveDocument.ActiveWindow.ToggleShowAllReviewers();\n  };\n};\n\n/**\n * 按用户名称显示、隐藏修改痕迹\n * @param {object} data {userName: '用户名'，isShow:true}\n * @param {object} props webOffice\n */\nvar showTracesByRole = exports.showTracesByRole = function showTracesByRole(data, props) {\n  return function (webOffice) {\n    var userName = data.userName,\n      isShow = data.isShow;\n    var pageId = props.model.pageId;\n    try {\n      // webOffice.ActiveDocument.ShowRevisions = true\n      webOffice.ActiveDocument.ActiveWindow.View.Reviewers(userName).Visible = isShow;\n    } catch (e) {\n      console.error('showTracesByRole 指令执行失败', e);\n      (0, _appModelFunction.setDataMessages)(pageId, {\n        content: (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0011',\n          variables: {\n            userName: userName\n          }\n        }),\n        type: _const.AlertType.ERROR\n      });\n    }\n  };\n};\n\n/**\n * 在书签位置插入表格（tableData：表格数据，{\"row\":1,\"column\":2,\"value\":\"123123\"}表示第1行第2列的表格值为123123；tableSize：表格规格，{\"row\":3,\"column\":2}}表示表格规格为3行2列）\n * @param {object} data {\"field\":\"书签名称\",\"tableData\":[{\"row\":1,\"column\":2,\"value\":\"123123\"},{\"row\":1,\"column\":1,\"value\":\"123123\"}],\"tableSize\":{\"row\":3,\"column\":2}}\n * @param {object} props webOffice\n */\nvar setDynamicTable = exports.setDynamicTable = function setDynamicTable(data, props) {\n  return function (webOffice) {\n    //  { tableSize: { row: 1, column: 2 }, tableData: [{ row: 1, column: 2, value: '123123' }, { row: 1, column: 3, value: '123123' }] }\n    var tableSize = data.tableSize,\n      field = data.field,\n      tableData = data.tableData;\n    var row = tableSize.row,\n      column = tableSize.column;\n    var range = isFieldExist(webOffice, field) ? webOffice.ActiveDocument.Bookmarks.Item(field).Range : webOffice.ActiveDocument.Application.Selection.Range;\n    var _Format_ = 23; // 表格网状格式\n    var _ApplyBorders_ = true;\n    var _ApplyShading_ = true;\n    var _ApplyFont_ = true;\n    var _ApplyColor_ = true;\n    var _ApplyHeadingRows_ = false;\n    var _ApplyLastRow_ = false;\n    var _ApplyFirstColumn_ = true;\n    var _ApplyLastColumn_ = false;\n    var _AutoFit_ = false;\n    // 删除原有表格\n    if (range.Tables.Count === 1) {\n      range.Tables(1).Delete();\n    }\n    // 新增表格\n    // Add(range, row, column, 1, AutoFitBehavior)\n    // DefaultTableBehavior 指定Microsoft Word是否自动调整表中单元格的大小以适合内容（AutoFit）: wdWord8TableBehavior 0 禁用自动调整，默认。wdWord9TableBehavior 1 启用自动调整。\n    // AutoFitBehavior: wdAutoFitContent  1 表格会自动调整大小以适合表格中包含的内容。wdAutoFitFixed  0 该表设置为固定大小，而不管其内容如何，并且不会自动调整大小。wdAutoFitWindow  2 表格会自动调整为活动窗口的宽度。\n    var table = webOffice.ActiveDocument.Application.Selection.Tables.Add(range, row, column, 1, 2);\n\n    // 设置表格样式\n    // table.Style = '网格型' // 如何兼容多语言？？\n    table.AutoFormat(_Format_, _ApplyBorders_, _ApplyShading_, _ApplyFont_, _ApplyColor_, _ApplyHeadingRows_, _ApplyLastRow_, _ApplyFirstColumn_, _ApplyLastColumn_, _AutoFit_);\n    setTableData(table, tableData);\n\n    // 为表格重新添加书签\n    table.Select();\n    // webOffice.ActiveDocument.Application.Selection.Tables(1).AutoFitBehavior(2)\n    var range2 = webOffice.ActiveDocument.Application.Selection.Range;\n    webOffice.ActiveDocument.Bookmarks.Add(field, range2);\n  };\n};\nvar setTableData = function setTableData(table, data) {\n  data.forEach(function (item) {\n    table.Cell(item.row, item.column).Range.text = item.value;\n  });\n};\n\n// 根据书签名获取选中区域\nvar getSelectionByField = function getSelectionByField(webOffice, field) {\n  var range = isFieldExist(webOffice, field) && webOffice.ActiveDocument.Bookmarks.Item(field).Range;\n  range.Select();\n};\nvar getTableByField = function getTableByField(webOffice, field) {\n  getSelectionByField(webOffice, field);\n  return webOffice.ActiveDocument.Application.Selection.Tables(1);\n};\nvar getTableRows = function getTableRows(table) {\n  return table.Rows.Count;\n};\nvar getTableColumns = function getTableColumns(table) {\n  return table.Columns.Count;\n};\n\n// 获取新增一行的行数据\nvar getNewRowData = function getNewRowData(table, newRows, data) {\n  var rows = getTableRows(table);\n  var columns = getTableColumns(table);\n  var newData = [];\n  for (var i = 0; i < newRows; i++) {\n    for (var j = 0; j < columns; j++) {\n      var item = {\n        row: rows + i + 1,\n        column: j + 1,\n        value: data[i][j]\n      };\n      newData.push(item);\n    }\n  }\n  return newData;\n};\n\n// 获取新增一列的列数据\nvar getNewColumnData = function getNewColumnData(table, newColumns, data) {\n  var rows = getTableRows(table);\n  var columns = getTableColumns(table);\n  var newData = [];\n  for (var i = 0; i < newColumns; i++) {\n    for (var j = 0; j < rows; j++) {\n      var item = {\n        row: j + 1,\n        column: columns + i + 1,\n        value: data[i][j]\n      };\n      newData.push(item);\n    }\n  }\n  return newData;\n};\n\n/**\n * 为指定表格新增多行数据，需先将表格设为书签，否则默认是第一个表格\n * @param {object} data {\"field\":'表格所在的书签名', \"newRows\":2, \"newRowsData\":[['123123' , '123123' ], ['123123' , '123123' ]]}\n * @param {object} props webOffice\n */\nvar addTableRows = exports.addTableRows = function addTableRows(data, props) {\n  return function (webOffice) {\n    var field = data.field,\n      newRowsData = data.newRowsData,\n      newRows = data.newRows;\n    var table = isFieldExist(webOffice, field) ? getTableByField(webOffice, field) : webOffice.ActiveDocument.Application.Selection.Tables(1);\n    var tableData = getNewRowData(table, newRows, newRowsData);\n    for (var i = 1; i <= newRows; i++) {\n      table.Rows.Add();\n    }\n    setTableData(table, tableData);\n  };\n};\n\n/**\n * 为指定的表格新增多列数据，需先将表格设为书签，否则默认是第一个表格\n * @param {object} data {\"field\":'表格所在的书签名', \"newColumns\":2, \"newRowsData\":[['123123' , '123123' ], ['123123' , '123123' ]]}\n * @param {object} props webOffice\n */\nvar addTableColumns = exports.addTableColumns = function addTableColumns(data, props) {\n  return function (webOffice) {\n    var field = data.field,\n      newColumnsData = data.newColumnsData,\n      newColumns = data.newColumns;\n    var table = isFieldExist(webOffice, field) ? getTableByField(webOffice, field) : webOffice.ActiveDocument.Application.Selection.Tables(1);\n    // table.AutoFitBehavior(2)\n    // webOffice.ActiveDocument.Application.Selection.Tables(1).AutoFitBehavior(2)\n    var tableData = getNewColumnData(table, newColumns, newColumnsData);\n    for (var i = 1; i <= newColumns; i++) {\n      table.Columns.Add();\n    }\n    setTableData(table, tableData);\n    table.AutoFitBehavior(2);\n  };\n};\n\n/**\n * 合并文档，即在指定位置插入文档（原文档和合并文档的书签和复选框合并后仍可用）\n * @param {object} data {\"field\":书签名称\",\"mergeType\":0光标位置\\1文档开头\\2文档结尾\\3书签位置,\"docsUrl\":[\"文档的url\"]}\n * @param {object} props webOffice\n */\nvar mergeDocs = exports.mergeDocs = function mergeDocs(data, props) {\n  return function (webOffice) {\n    // 头部1, 尾部2， 光标0, 书签位置（是否需要记住原来书签）\n    var pageId = props.model.pageId;\n    var field = data.field,\n      mergeType = data.mergeType;\n    var items = data.docsUrl;\n    if (mergeType === 3) {\n      getSelectionByField(webOffice, field);\n      items.forEach(function (item) {\n        webOffice.InSertFile(item, 0);\n      });\n    } else if (mergeType === 0 || mergeType === 1 || mergeType === 2) {\n      items.forEach(function (item) {\n        webOffice.InSertFile(item, mergeType);\n      });\n    } else {\n      (0, _appModelFunction.setDataMessages)(pageId, {\n        content: (0, _intlApi.getLangMsg)({\n          key: 'webOffice.key0012'\n        }),\n        type: _const.AlertType.ERROR\n      });\n    }\n  };\n};\n\n/**\n * 设置选中区域内容为书签\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar setSelectionAsField = exports.setSelectionAsField = function setSelectionAsField(data, props) {\n  return function (webOffice) {\n    var field = data.field;\n    var range = webOffice.ActiveDocument.Application.Selection.Range;\n    // range.Text = value\n    webOffice.ActiveDocument.Bookmarks.Add(field, range);\n  };\n};\n\n/**\n * 设置整个文档内容为书签\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar setDocAsField = exports.setDocAsField = function setDocAsField(data, props) {\n  return function (webOffice) {\n    var field = data.field;\n    webOffice.ActiveDocument.Application.Selection.WholeStory();\n    var range = webOffice.ActiveDocument.Application.Selection.Range;\n    // range.Text = value\n    webOffice.ActiveDocument.Bookmarks.Add(field, range);\n    // 阻止屏幕刷新\n    // webOffice.ActiveDocument.Application.ScreenUpdating = false\n  };\n};\n\n// 检测文档是否变动，包含样式变动\nvar isDirty = exports.isDirty = function isDirty(webOffice) {\n  return webOffice && webOffice.isDirty;\n};\nvar getAllCheckBox = function getAllCheckBox(webOffice) {\n  var checkBoxArr = [];\n  var obj = {\n    title: '',\n    id: ''\n  };\n  var count = webOffice.ActiveDocument.ContentControls.Count;\n  for (var i = 1; i <= count; i++) {\n    var id = webOffice.ActiveDocument.ContentControls.Item(i).ID;\n    var value = webOffice.ActiveDocument.ContentControls.Item(i).Checked;\n    var title = webOffice.ActiveDocument.ContentControls.Item(i).Title || (0, _intlApi.getLangMsg)({\n      key: 'webOffice.key0014'\n    });\n    obj = {\n      id: id,\n      value: value,\n      title: title\n    };\n    checkBoxArr.push(obj);\n  }\n  console.log(checkBoxArr);\n  return checkBoxArr;\n};\n\n/**\n * 查找所有复选框，并将结果发送给后端\n * @param {object} data {\"fileType\":\"\"}\n * @param {object} props webOffice\n */\nvar sendAllCheckBox = exports.sendAllCheckBox = function sendAllCheckBox(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    var result = getAllCheckBox(webOffice);\n    var id = data.id;\n    //   [{\"id\":复选框id,\"value\":true\\false复选框的值,\"title\":\"复选框标题\"}]\n    sendValiResult(model, [{\n      data: result,\n      id: id,\n      type: 'allCheckBox'\n    }]);\n  };\n};\n\n/**\n * 获取当前文档的打开状态，并将结果发送给后端\n * @param {object} data {\"fileType\":\"\"}\n * @param {object} props webOffice\n */\nvar sendOpenStatus = exports.sendOpenStatus = function sendOpenStatus(data, props) {\n  return function (webOffice) {\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    // const { pageId, key } = model\n    // const result = getPageData(pageId, [key, WEBOFFICE_OPEN_STATUS]) || false\n    var result = getOpenStatus(webOffice);\n    var id = data.id;\n    // alert(result)\n    sendValiResult(model, [{\n      data: result,\n      id: id,\n      type: 'openStatus'\n    }]);\n  };\n};\nvar getOpenStatus = function getOpenStatus(webOffice) {\n  return !!webOffice.ActiveDocument;\n  // alert(webOffice.ActiveDocument.name)\n};\nvar getCheckBoxById = function getCheckBoxById(webOffice, id) {\n  var checkBoxArr = getAllCheckBox(webOffice);\n  var index;\n  checkBoxArr.forEach(function (item, i) {\n    if (item.id === id) {\n      index = i;\n    }\n  });\n  return index;\n};\n\n/**\n * 批量修改复选框的值\n * @param {object} data [{\"id\":复选框id1,\"value\":true\\false},{\"id\":复选框id2,\"value\":true\\false}]\n * @param {object} props webOffice\n */\nvar setCheckBoxValue = exports.setCheckBoxValue = function setCheckBoxValue(data, props) {\n  return function (webOffice) {\n    var pageId = props.model.pageId;\n    var items = data.data;\n    items.forEach(function (item) {\n      var index = getCheckBoxById(webOffice, item.id);\n      if (index !== undefined) {\n        webOffice.ActiveDocument.ContentControls.Item(index + 1).Checked = item.value;\n      } else {\n        (0, _appModelFunction.setDataMessages)(pageId, {\n          content: (0, _intlApi.getLangMsg)({\n            key: 'webOffice.key0014'\n          }),\n          type: _const.AlertType.ERROR\n        });\n      }\n    });\n    // webOffice.ActiveDocument.Application.Selection.Range.ContentControls.Add(8)\n  };\n};\n\n/**\n * 设置书签内容为标题1样式\n * @param {object} data {\"field\":\"书签名称\",\"style\":\"标题 1\"}\n * @param {object} props webOffice\n */\nvar setTextAsTitle = exports.setTextAsTitle = function setTextAsTitle(data, props) {\n  return function (webOffice) {\n    var field = data.field,\n      style = data.style;\n    isFieldExist(webOffice, field) && webOffice.SetFieldValue(field, '', '::GETMARK::');\n    var selection = webOffice.ActiveDocument.Application.Selection;\n    selection.Style = webOffice.ActiveDocument.Styles(style);\n  };\n};\n\n// 保存到本地对话框\nvar saveAsLocal = exports.saveAsLocal = function saveAsLocal(data, props) {\n  return function (webOffice) {\n    webOffice.showdialog(3);\n  };\n};\nvar insertPictures = exports.insertPictures = function insertPictures(data, props) {\n  return function (webOffice) {\n    var items = data.data;\n    items.forEach(function (item) {\n      var imageUrl = item.imageUrl,\n        field = item.field,\n        imageStyle = item.imageStyle;\n      isFieldExist(webOffice, field) && webOffice.SetFieldValue(field, '', '::GETMARK::');\n      var shapes = webOffice.ActiveDocument.Application.Selection.InlineShapes.AddPicture(imageUrl); // 插入图片\n      if (imageStyle) {\n        var width = getformatValue(webOffice, imageStyle.width);\n        var height = getformatValue(webOffice, imageStyle.height);\n        shapes.Width = width;\n        shapes.Height = height;\n      }\n    });\n  };\n};\nvar getformatValue = function getformatValue(webOffice, value) {\n  if (isString(value)) {\n    value.toLowerCase();\n    if (isCentimeter(value)) {\n      value = value.replace('cm', '');\n      return convert2Centimeter(webOffice, value);\n    } else if (isPX(value)) {\n      value = value.replace('px', '');\n      return convert2Int(value);\n    }\n    return value;\n  }\n  return value;\n};\nvar convert2Int = function convert2Int(value) {\n  return parseInt(value);\n};\nvar isString = function isString(value) {\n  return typeof value === 'string';\n};\nvar isCentimeter = function isCentimeter(value) {\n  return value.endsWith('cm');\n};\nvar isPX = function isPX(value) {\n  return value.endsWith('px');\n};\nvar convert2Centimeter = function convert2Centimeter(webOffice, value) {\n  return webOffice.ActiveDocument.Application.CentimetersToPoints(value);\n};\n\n// spyApi.doPostActions('', 'InvokeControlMethod',\n// [{\n//   args: [\n//     { data: { fontSize: 36, fontFamily: '宋体', left: '200px', top: '200px', fontColor: '#c0c0c0', rotation: 0, text: '樣本1', transparency: 0 }, event: 'addTextMark' }],\n//   key: 'webofficeap',\n//   methodname: 'webOfficeAction'\n// }])\n// left: 值可以是“200px”也可以是“left”、“center”、“right”；top: 值可以是“200px”也可以是“top”、“center”、“bottom”；\nvar addTextMark = exports.addTextMark = function addTextMark(data, props) {\n  return function (webOffice) {\n    var getVal = function getVal(value, defaultVal) {\n      return value === null || value === undefined || typeof value !== 'number' ? defaultVal : value;\n    };\n    var getLeft = function getLeft(value) {\n      var list = {\n        left: -999998,\n        center: -999995,\n        right: -999996\n      };\n      return typeof value === 'string' ? list[value] || -999995 : value;\n    };\n    var getTop = function getTop(value) {\n      var list = {\n        top: -999999,\n        center: -999995,\n        bottom: -999997\n      };\n      return typeof value === 'string' ? list[value] || -999995 : value;\n    };\n    var fontSize = data.fontSize || 120;\n    var fontFamily = data.fontFamily || '宋体';\n    var text = data.text || '样本';\n    var rotation = getVal(data.rotation, 0); // 315斜体  0 水平\n    var transparency = getVal(data.transparency, 0); // 透明度 半透明0.5, 不透明0\n    var fontColor = (0, _webOfficeUtil.HEX2Demical)(data.fontColor) || 12632256; // 6位十六进制颜色值 ,需要转成十进制,RGB #C0C0C0, 先转十进制,  6位十六进制颜色值\n    var left = getLeft(getformatValue(webOffice, data.left)); // -999998 左对齐   -999995中  右-999996  也可以是普通数字例如200 表示200px\n    var top = getTop(getformatValue(webOffice, data.top)); //  -999999 顶部 -999995中  下-999997\n    try {\n      if (webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count) {\n        webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete();\n      }\n      // START  兼容office，第一遍webOffice.ActiveDocument.Application.Selection.ShapeRange.TextEffect报异常的问题\n      webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 9;\n      webOffice.ActiveDocument.Sections(1).Headers(1).Shapes.AddTextEffect(0, text, fontFamily, fontSize, false, false, 0, 0).Select();\n      webOffice.ActiveDocument.Sections(1).Headers(1).Shapes(1).Name = 'PowerPlusWaterMarkObject30745'; // 手动添加name,不然点击office自带删除水印按钮无法删除,打开之前设置的水印无法删除\n      webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 0;\n      if (webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count) {\n        webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete();\n      }\n      // END\n      webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 9;\n      webOffice.ActiveDocument.Sections(1).Headers(1).Shapes.AddTextEffect(0, text, fontFamily, fontSize, false, false, 0, 0).Select();\n      webOffice.ActiveDocument.Sections(1).Headers(1).Shapes(1).Name = 'PowerPlusWaterMarkObject30745'; // 手动添加name,不然点击office自带删除水印按钮无法删除,打开之前设置的水印无法删除\n      // webOffice.ActiveDocument.Application.Selection.HeaderFooter.Shapes.AddTextEffect(0, text, fontFamily, fontSize, false, false, 0, 0).Select()\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.TextEffect.NormalizedHeight = false;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Line.Visible = false;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Fill.Visible = true;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Fill.Solid();\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Fill.ForeColor = fontColor;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Fill.Transparency = transparency; // 透明度，0表示不透明\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.Rotation = rotation\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio = true\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.Height = height\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.Width = width\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.AllowOverlap = true;\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Side = 3\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Type = 3\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.ZOrder(5)\n      // webOffice.ActiveDocument.Application.Selection.ShapeRange.ZOrder(0)\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Rotation = rotation;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Left = left;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Top = top;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio = true;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.RelativeHorizontalPosition = 0;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.RelativeVerticalPosition = 0;\n      webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 0;\n    } catch (e) {\n      console.error(e);\n      var msgData = {\n        messageType: 0,\n        msg: '水印添加失败！',\n        detail: e\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n    }\n  };\n};\n\n// spyApi.doPostActions(\"\",'InvokeControlMethod',[{args: [ {data:{'picUrl':'C:\\\\Users\\\\Administrator\\\\Desktop\\\\images\\\\12.gif', washout:false}, 'event':'webPicMark'} ], key: \"webofficeap\", methodname: \"webOfficeAction\"}])\n/**\n * 还不提供对外使用，后端还没有这个指令\n * @param {*} data data.washout冲蚀 ;\n * @param {*} props\n * @returns\n */\nvar addPicMark = exports.addPicMark = function addPicMark(data, props) {\n  return function (webOffice) {\n    var picUrl = data.picUrl;\n    var brightness = data.washout ? 0.85 : 0.5;\n    var contrast = data.washout ? 0.15 : 0.5;\n    try {\n      if (webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count) {\n        webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete();\n      }\n      webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 9; // The current page header.\n      webOffice.ActiveDocument.Application.Selection.HeaderFooter.Shapes.AddPicture(picUrl, false, true).Select();\n      webOffice.ActiveDocument.Sections(1).Headers(1).Shapes(1).Name = 'PowerPlusWaterMarkObject30745';\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.PictureFormat.Brightness = brightness;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.PictureFormat.Contrast = contrast;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio = true;\n\n      // WebOffice.ActiveDocument.Application.Selection.ShapeRange.Height = 100;\n      // WebOffice.ActiveDocument.Application.Selection.ShapeRange.Width = 200;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.AllowOverlap = true;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Side = 3;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Type = 3;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.RelativeHorizontalPosition = 0;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.RelativeVerticalPosition = 0;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Left = -999995;\n      webOffice.ActiveDocument.Application.Selection.ShapeRange.Top = -999995;\n      webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 0;\n    } catch (e) {\n      console.error(e);\n      var msgData = {\n        messageType: 0,\n        msg: '图片水印添加失败！',\n        detail: e\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n    }\n  };\n};\n\n// spyApi.doPostActions(\"\",'InvokeControlMethod',[{args: [{'event':'delMark'} ], key: \"webofficeap\", methodname: \"webOfficeAction\"}])\nvar delMark = exports.delMark = function delMark(data, props) {\n  return function (webOffice) {\n    try {\n      if (webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count) {\n        webOffice.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete();\n      }\n      // webOffice.ActiveDocument.Sections(1).Range.Select()\n      // webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 9\n      // console.log('Shapes', webOffice.ActiveDocument.Application.Selection.HeaderFooter.Shapes.Count)\n      // webOffice.ActiveDocument.Application.Selection.HeaderFooter.Shapes(1).Select()\n      // webOffice.ActiveDocument.Application.Selection.Delete()\n      // webOffice.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 0\n    } catch (e) {\n      console.error(e);\n      var msgData = {\n        messageType: 0,\n        msg: '水印删除失败！',\n        detail: e\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n    }\n  };\n};\n\n/**\n * 通用指令，用于后端自行传入方法调用 api\n * @param {object} data 后端发送的数据\n * @param {object} props\n * @param {object} yozoOffice 永中 Office\n */\nvar callEditorFunction = exports.callEditorFunction = function callEditorFunction(data, props) {\n  return function (webOffice) {\n    if (data.editorType !== _webOffice.OfficeEditMode.WebOffice) return;\n    var methods = data.methods;\n    var sendValiResult = props.sendValiResult,\n      model = props.model;\n    methods.forEach(function (_ref) {\n      var params = _ref.params,\n        func = _ref.func,\n        id = _ref.id;\n      var keys = func.split('.');\n      var result = webOffice;\n      for (var i = 0; i < keys.length; i++) {\n        var currentKey = keys[i];\n        var isFunction = false;\n        var paramKey = '';\n        if (/(\\w+)\\((\\$\\d+)?\\)/.test(currentKey)) {\n          var matchRes = currentKey.match(/(\\w+)\\((\\$\\d+)?\\)/);\n          currentKey = matchRes[1];\n          paramKey = matchRes[2];\n          isFunction = true;\n        }\n        try {\n          if (isFunction) {\n            var _result;\n            result = paramKey ? (_result = result)[currentKey].apply(_result, _toConsumableArray(params[paramKey])) : result[currentKey]();\n          } else {\n            result = result[currentKey];\n          }\n        } catch (err) {\n          console.error(\"\".concat(currentKey, \"\\u8C03\\u7528\\u51FA\\u9519\"));\n        }\n      }\n      if (id && result) {\n        sendValiResult === null || sendValiResult === void 0 || sendValiResult(model, [{\n          data: {\n            result: result\n          },\n          id: id,\n          type: 'getEditorResult'\n        }]);\n      }\n    });\n  };\n};\n\n//# sourceURL=webpack://bos-platform/./src/util/webOfficeDirective.js?");

/***/ }),

/***/ "./src/util/wpsDirectives.js":
/*!***********************************!*\
  !*** ./src/util/wpsDirectives.js ***!
  \***********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.toggleShowTraces = exports.showTracesByRole = exports.setTrackingMode = exports.setToolbars = exports.setTitlebar = exports.setTextAsTitle = exports.setSelectionEditArea = exports.setSelectionAsField = exports.setMenubar = exports.setDynamicTable = exports.setDocUnLimitByRole = exports.setDocUnLimit = exports.setDocLimitByRole = exports.setDocLimit = exports.setDocAsField = exports.setCheckBoxValue = exports.setCaption = exports.sendTextByField = exports.sendOpenStatus = exports.sendIsFieldRevise = exports.sendIsDocChange = exports.sendFieldExist = exports.sendAllField = exports.sendAllCheckBox = exports.saveToLocal = exports.saveAsLocal = exports.save = exports.openNew = exports.open = exports.modifyMark = exports.mergeDocs = exports.locateMark = exports.insertValue = exports.insertPicture = exports.docProtect = exports.docCompare = exports.deleteMark = exports.delMark = exports.close = exports.cancelSelectionEditArea = exports.callEditorFunction = exports.addTextMark = exports.addTableRows = exports.addTableColumns = exports.addMark = exports.addCommentDialog = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.match.js */ \"../../node_modules/core-js/modules/es.string.match.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\n__webpack_require__(/*! core-js/modules/web.timers.js */ \"../../node_modules/core-js/modules/web.timers.js\");\nvar _wpsUtils = __webpack_require__(/*! @/util/wpsUtils */ \"./src/util/wpsUtils.js\");\nvar _appModelFunction = __webpack_require__(/*! @/model/appModelFunction */ \"./src/model/appModelFunction.js\");\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _requestParamsUtil = __webpack_require__(/*! @/util/requestParamsUtil */ \"./src/util/requestParamsUtil.js\");\nvar _componentutil = __webpack_require__(/*! @/util/componentutil */ \"./src/util/componentutil.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _const = __webpack_require__(/*! @/constant/const */ \"./src/constant/const.js\");\nvar _webOffice = __webpack_require__(/*! @/constant/webOffice */ \"./src/constant/webOffice.js\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; } /**\n * WPS 响应方法\n */\n/**\n * 设置标题栏的显示\n * WPS 暂未从文档中发现这个属性，故方法置空\n */\nvar setTitlebar = exports.setTitlebar = function setTitlebar() {};\n\n/**\n * 设置工具栏的显示\n * WPS 暂未从文档中发现这个属性，故方法置空\n */\nvar setToolbars = exports.setToolbars = function setToolbars() {};\n\n/**\n * 设置菜单栏的显示\n * WPS 暂未从文档中发现这个属性，故方法置空\n */\nvar setMenubar = exports.setMenubar = function setMenubar() {\n  // 隐藏功能区\n  (0, _wpsUtils.getWpsActiveWindow)().ToggleRibbon();\n};\n\n/**\n * 设置标题栏文字\n * WPS 暂未从文档中发现这个属性，故方法置空\n */\nvar setCaption = exports.setCaption = function setCaption() {};\n\n/**\n * 打开文档\n * @param {object} param0 响应数据\n * @param {object} param1 model\n * @returns\n */\nvar open = exports.open = function open(_ref, model, callbacks) {\n  var url = _ref.url,\n    userName = _ref.userName;\n  var pageId = model.pageId;\n  if (!url) {\n    (0, _appModelFunction.setDataMessages)(pageId, {\n      content: (0, _intlApi.getLangMsg)({\n        key: 'webOffice.key0003'\n      }),\n      type: _const.AlertType.ERROR\n    });\n    return;\n  }\n  url = (0, _requestParamsUtil.appendParamsToUrl)(url, {\n    model: model\n  });\n  var joiner = url.includes('?') ? '&' : '?';\n  // 拼接 fileHeader = 1，表示后端返回的 header 中， content-disposition 需要修改为 attachment;filename=fileName.doc\n  url = \"\".concat(url).concat(joiner, \"fileHeader=1\");\n  if (window.Application) {\n    window.Application.Documents.OpenFromUrl(url, callbacks === null || callbacks === void 0 ? void 0 : callbacks.openSuccess, callbacks === null || callbacks === void 0 ? void 0 : callbacks.openFailed);\n  } else {\n    // 旧版本没有回调，默认成功\n    wps.Application.Documents.OpenFromUrl(url);\n    setTimeout(function () {\n      var _callbacks$openSucces;\n      (_callbacks$openSucces = callbacks.openSuccess) === null || _callbacks$openSucces === void 0 || _callbacks$openSucces.call(callbacks);\n    }, 1800);\n  }\n  var wpsApplication = (0, _wpsUtils.getWpsApplication)();\n  wpsApplication.UserName = userName;\n  wpsApplication.CommandBars.SetVisibleMso('FileMenu', false);\n  wpsApplication.CommandBars.SetVisibleMso('FileSave', false);\n  (0, _wpsUtils.handleClientClose)();\n  (0, _wpsUtils.handleTaskPaneClose)();\n  // disableSave()\n};\n\n/**\n * 新创建 WPS 文档\n */\nvar openNew = exports.openNew = function openNew() {\n  var wpsApplication = (0, _wpsUtils.getWpsApplication)();\n  wpsApplication.Documents.Add();\n  wpsApplication.CommandBars.SetVisibleMso('FileMenu', false);\n  wpsApplication.CommandBars.SetVisibleMso('FileSave', false);\n  // disableSave()\n  (0, _wpsUtils.handleClientClose)();\n  (0, _wpsUtils.handleTaskPaneClose)();\n};\n\n/**\n * 保存文件\n * @param {object} param0 指令数据\n * @param {string} param0.id 文件 id\n * @param {string} param0.name 文件名称\n * @param {string} param0.uploadUrl 上传路径\n */\nvar save = exports.save = function save(_ref2, model, _ref3) {\n  var id = _ref2.id,\n    _ref2$name = _ref2.name,\n    name = _ref2$name === void 0 ? 'file' : _ref2$name,\n    uploadUrl = _ref2.uploadUrl;\n  var save = _ref3.save;\n  var xhr = new window.XMLHttpRequest();\n  xhr.open('POST', (0, _requestParamsUtil.appendParamsToUrl)(uploadUrl));\n  var data = new window.FormData();\n  var uid = (0, _componentutil.createNewId)();\n  var formData = (0, _requestParamsUtil.getRequestParams)(model, {\n    name: name\n  });\n  Object.keys(formData).forEach(function (key) {\n    if (formData[key]) {\n      data.append(key, formData[key]);\n    }\n  });\n  var content = window.Application.ActiveDocument.SaveAsBinaryString();\n  if (window.Application && content) {\n    data.append('uid', (0, _wpsUtils.getFile)(content, name));\n  } else {\n    data.append('uid', (0, _wpsUtils.getFile)(saveToLocal(), name));\n  }\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState === 4) {\n      var res = JSON.parse(xhr.responseText);\n      if (res.status === 'success') {\n        save === null || save === void 0 || save(model, [{\n          name: name,\n          uid: uid,\n          id: id,\n          url: res.url\n        }]);\n      } else {\n        var msgData = {\n          messageType: 0,\n          msg: (0, _intlApi.getLangMsg)({\n            key: 'webOffice.key0006'\n          })\n        };\n        (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_MESSAGE_EVENT, msgData);\n      }\n    }\n  };\n  xhr.send(data);\n};\n\n/**\n * 保存到本地，仅低版本的wps用\n */\nvar saveToLocal = exports.saveToLocal = function saveToLocal() {\n  var tempPath = wps.Env.GetTempPath() + '/wps_temp';\n  if (!wps.FileSystem.Exists(tempPath)) {\n    var res = wps.FileSystem.Mkdir(wps.Env.GetTempPath() + '/wps_temp');\n    if (!res) {\n      alert('文件路径访问失败');\n      return;\n    }\n  }\n  var name = wps.WpsApplication().ActiveDocument.Name.includes('.') ? wps.WpsApplication().ActiveDocument.Name : \"\".concat(wps.WpsApplication().ActiveDocument.Name, \".doc\");\n  var file = \"\".concat(tempPath, \"/\").concat(name);\n  wps.WpsApplication().ActiveDocument.SaveAs(file);\n  return wps.FileSystem.readAsBinaryString(file);\n};\n\n/**\n * 关闭文档\n */\nvar close = exports.close = function close() {\n  (0, _wpsUtils.getWpsActiveDocuments)().Close();\n};\n\n/**\n * 在光标位置插入文本内容\n * @param {object} data {\"needEnterBefore\":true\\false是否需要在插入文本前添加回车换行（可触发office自动编号）}\n * @param {object} props webOffice\n */\nvar insertValue = exports.insertValue = function insertValue() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var needEnterBefore = data.needEnterBefore,\n    value = data.value;\n  var enter = '';\n  if (needEnterBefore) {\n    enter = '\\r\\n';\n  }\n  var newValue = enter.concat(value);\n  (0, _wpsUtils.getWpsApplication)().Selection.InsertBefore(newValue);\n};\n\n/**\n * 在光标或者选中文字处插入批注\n * @param {object} param0 响应参数\n */\nvar addCommentDialog = exports.addCommentDialog = function addCommentDialog() {\n  var _getWpsActiveDocument = (0, _wpsUtils.getWpsActiveDocuments)(),\n    Comments = _getWpsActiveDocument.Comments;\n  var Range = (0, _wpsUtils.getWpsApplication)().Selection.Range;\n  Comments.Add(Range);\n  Comments.Items(1).Edit();\n};\n\n/**\n * 文本比较\n * @param {object} param0 响应数据\n * @param {string} currentFile 源文档名称\n * @param {string} compareFile 比对的文档名称\n * @param {string} currentFileUrl 源文档地址\n * @param {string} compareFileUrl 比对文档的地址\n */\nvar docCompare = exports.docCompare = function docCompare(_ref4) {\n  var currentFile = _ref4.currentFile,\n    comapreFile = _ref4.comapreFile,\n    currentFileUrl = _ref4.currentFileUrl,\n    compareFileUrl = _ref4.compareFileUrl;\n  (0, _wpsUtils.getWpsApplication)().Documents.OpenFromUrl(currentFileUrl);\n  (0, _wpsUtils.getWpsActiveDocuments)().Compare(compareFileUrl);\n};\n\n/**\n * 添加书签\n * 1. 插入内容\n * 2. 选中内容并作为书签\n * @param {object}} param0 data: {field: \"variablelW0yqq_receivesupplier\", value: \"${收款方}\"}\n * @param {string} value 要成为书签的值\n * @param {string} field 书签对应的字段\n */\nvar addMark = exports.addMark = function addMark(_ref5) {\n  var value = _ref5.value,\n    field = _ref5.field;\n  insertValue({\n    value: value\n  });\n  (0, _wpsUtils.getWpsActiveDocuments)().Bookmarks.Add(field, (0, _wpsUtils.getWpsApplication)().Selection.Range);\n  // 将选定内容折叠到起始位置\n  (0, _wpsUtils.getWpsApplication)().Selection.Collapse((0, _wpsUtils.getWpsEnum)().wdCollapseStart);\n};\n\n/**\n * 修改书签\n * @param {object} param0\n * @returns\n */\nvar modifyMark = exports.modifyMark = function modifyMark(_ref6) {\n  var data = _ref6.data;\n  if (!Array.isArray(data)) return;\n  var _getWpsActiveDocument2 = (0, _wpsUtils.getWpsActiveDocuments)(),\n    Bookmarks = _getWpsActiveDocument2.Bookmarks;\n  data.forEach(function (item) {\n    var field = item.field,\n      value = item.value;\n    if (!(0, _wpsUtils.isBookmarkExists)(field)) return;\n    var range = Bookmarks.Item(field).Range;\n    range.Text = value;\n    Bookmarks.Add(field, range);\n  });\n};\n\n/**\n * 删除书签\n * @param {object} param0 \"data\": [{\"field\": \"variablelW0yqq_receivesupplier\", \"value\": \"\"}]\n * @param {string} param0.value 书签值\n * @param {string} param0.data 书签数组\n * @returns\n */\nvar deleteMark = exports.deleteMark = function deleteMark(_ref7) {\n  var data = _ref7.data;\n  var _getWpsActiveDocument3 = (0, _wpsUtils.getWpsActiveDocuments)(),\n    Bookmarks = _getWpsActiveDocument3.Bookmarks;\n  var _data = _slicedToArray(data, 1),\n    bookmark = _data[0];\n  if (!Bookmarks.Exists(bookmark.field)) {\n    console.log('不存在该书签');\n    return;\n  }\n  // 清空内容\n  Bookmarks.Item(bookmark.field).Range.Text = '';\n  Bookmarks.Item(bookmark.field).Delete();\n};\n\n/**\n * 定位书签\n * @param {object} param0 data: { field\": \"variablelW0yqq_receivesupplier\", \"value\": \"\"}\n * @param {string} param0.value 书签值\n * @param {string} param0.field 数值对应的字段\n * @returns\n */\nvar locateMark = exports.locateMark = function locateMark(_ref8) {\n  var field = _ref8.field;\n  var _getWpsActiveDocument4 = (0, _wpsUtils.getWpsActiveDocuments)(),\n    Bookmarks = _getWpsActiveDocument4.Bookmarks;\n  if (!Bookmarks.Exists(field)) {\n    console.log('不存在该书签');\n    return;\n  }\n  Bookmarks.Item(field).Select();\n};\n\n/**\n * todo:提示文档已锁定， 密码加密传输\n * isProtect参数设为0时，才能设置文档只允许修订\\只允许添加批注\\完全保护（不允许任何操作）\n * @param {object} param0\n */\nvar docProtect = exports.docProtect = function docProtect(_ref9) {\n  var password = _ref9.password,\n    isProtect = _ref9.isProtect,\n    protectType = _ref9.protectType;\n  if (isProtect) {\n    (0, _wpsUtils.getWpsActiveDocuments)().Protect(protectType, false, password);\n  } else {\n    (0, _wpsUtils.getWpsActiveDocuments)().Unprotect(password);\n  }\n};\n\n/**\n * 开启区域限制，开启后文档将被限制编辑，只有允许编辑的区域才能被编辑\n * @param {object} param0\n * @param {[string]} param0.password 密码\n */\nvar setDocLimit = exports.setDocLimit = function setDocLimit(_ref10) {\n  var password = _ref10.password;\n  (0, _wpsUtils.getWpsActiveDocuments)().Protect(3, false, password);\n};\n\n/**\n * 解除区域限制，文档恢复可编辑状态\n * @param {object} param0\n * @param {[string]} param0.password 密码\n */\nvar setDocUnLimit = exports.setDocUnLimit = function setDocUnLimit(_ref11) {\n  var password = _ref11.password;\n  (0, _wpsUtils.getWpsActiveDocuments)().Unprotect(password);\n};\n\n/**\n * 设置选中区域为可编辑区域，编辑模板时使用（选中区域将被设置为书签）\n * @param {object} param0\n * @param {[string]} param0.field 书签数组\n */\nvar setSelectionEditArea = exports.setSelectionEditArea = function setSelectionEditArea(_ref12) {\n  var field = _ref12.field;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  var range = wpsApp.ActiveDocument.Application.Selection.Range;\n  wpsApp.ActiveDocument.Bookmarks.Add(field, range);\n  wpsApp.ActiveDocument.Application.Selection.Editors.Add(-1);\n};\n\n/**\n * 取消选中区域的第一个书签内容的编辑状态（对应书签将被删除）\n * @param {object} param0\n * @param {[string]} param0.field 书签数组\n */\nvar cancelSelectionEditArea = exports.cancelSelectionEditArea = function cancelSelectionEditArea(_ref13) {\n  var field = _ref13.field;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  wpsApp.ActiveDocument.Application.Selection.Editors.Item(1).Delete();\n  wpsApp.ActiveDocument.Bookmarks.Item(field).Delete();\n};\n\n/**\n * 批量设置书签内容为可编辑，并开启区域限制，其他区域将被锁定\n * @param {object} param0\n * @param {[string]} param0.field 书签数组\n * @param {string} param0.password 密码\n */\nvar setDocLimitByRole = exports.setDocLimitByRole = function setDocLimitByRole(_ref14) {\n  var field = _ref14.field,\n    password = _ref14.password;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  field.forEach(function (item) {\n    var mark = item.field;\n    wpsApp.ActiveDocument.Bookmarks.Item(mark).range.Editors().Add(-1);\n  });\n  wpsApp.ActiveDocument.Protect(3, false, password, false, false);\n};\n\n/**\n * 批量取消取消书签内容的可编辑状态\n * @param {object} param0\n * @param {[object]} param0.data 书签\n */\nvar setDocUnLimitByRole = exports.setDocUnLimitByRole = function setDocUnLimitByRole(_ref15) {\n  var data = _ref15.data;\n  data.forEach(function (item) {\n    var mark = item.field;\n    (0, _wpsUtils.getWpsActiveDocuments)().Bookmarks.Item(mark).range.Editors(-1).Delete();\n  });\n};\n\n/**\n * 根据书签名称获取文本内容，将结果发送到后端\n * @param {object} param0\n * @param {string} param0.id`回调id\n * @param {string} param0.field 书签名\n * @param {function} sendValidResult\n * @param {object} model\n */\nvar sendTextByField = exports.sendTextByField = function sendTextByField(_ref16, model, _ref17) {\n  var _getWpsActiveDocument5;\n  var id = _ref16.id,\n    field = _ref16.field;\n  var sendValidResult = _ref17.sendValidResult;\n  var result = (_getWpsActiveDocument5 = (0, _wpsUtils.getWpsActiveDocuments)().Bookmarks.Item(field)) === null || _getWpsActiveDocument5 === void 0 || (_getWpsActiveDocument5 = _getWpsActiveDocument5.Range) === null || _getWpsActiveDocument5 === void 0 ? void 0 : _getWpsActiveDocument5.Text;\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: {\n      result: result,\n      field: field\n    },\n    id: id,\n    type: 'getTextByField'\n  }]);\n};\n\n/**\n * 判断给定的书签内容是否有任意改动（样式、批注等），将结果发送到后端\n * 需要在书签内容中间插入批注才能判断出是否有改动\n * @param {object} param0\n * @param {string} param0.id`回调id\n * @param {string} param0.field 书签名\n * @param {function} param0.sendValidResult\n * @param {object} param0.model\n */\nvar sendIsFieldRevise = exports.sendIsFieldRevise = function sendIsFieldRevise(_ref18, model, _ref19) {\n  var id = _ref18.id,\n    field = _ref18.field;\n  var sendValidResult = _ref19.sendValidResult;\n  // 先选中书签内容\n  (0, _wpsUtils.selectBookmark)(field);\n  var revisionsCount = (0, _wpsUtils.getWpsActiveDocuments)().Application.Selection.Range.Revisions.Count;\n  var isRevisionChanged = revisionsCount > 0;\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: {\n      result: isRevisionChanged,\n      field: field\n    },\n    id: id,\n    type: 'isFieldRevise'\n  }]);\n};\n\n/**\n * 判断给定的书签是否存在，将结果发送到后端\n * @param {object} param0\n * @param {string} param0.id`回调id\n * @param {string} param0.field 书签名\n * @param {function} param0.sendValidResult\n * @param {object} param0.model\n */\nvar sendFieldExist = exports.sendFieldExist = function sendFieldExist(_ref20, model, _ref21) {\n  var id = _ref20.id,\n    field = _ref20.field;\n  var sendValidResult = _ref21.sendValidResult;\n  var result = (0, _wpsUtils.isBookmarkExists)(field);\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: {\n      result: result,\n      field: field\n    },\n    id: id,\n    type: 'fieldExist'\n  }]);\n};\n\n/**\n * 获取当前文档所有书签，将结果发送到后端\n * @param {object} param0\n * @param {string} param0.id`回调id\n * @param {function} param0.sendValidResult\n * @param {object} param0.model\n */\nvar sendAllField = exports.sendAllField = function sendAllField(_ref22, model, _ref23) {\n  var id = _ref22.id;\n  var sendValidResult = _ref23.sendValidResult;\n  var bookmarks = (0, _wpsUtils.getAllBookmarks)();\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: bookmarks,\n    id: id,\n    type: 'allField'\n  }]);\n};\n\n/**\n * 开启强制留痕模式，开启后所有修改痕迹将被记录\n * @param {object} param0\n * @param {string} param0.userName 用户名\n * @param {number} param0.trackType 模式： 1 - 开启留痕并开始修订;0 - 关闭留痕模式;4 - 接受当前所有修订\n */\nvar setTrackingMode = exports.setTrackingMode = function setTrackingMode(_ref24) {\n  var userName = _ref24.userName,\n    trackType = _ref24.trackType;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  wpsApp.UserName = userName;\n  if (trackType === 4) {\n    wpsApp.ActiveDocument.Revisions.AcceptAll();\n    return;\n  }\n  var isOpen = trackType === 1;\n  wpsApp.ActiveDocument.TrackRevisions = isOpen;\n  wpsApp.ActiveDocument.ShowRevisions = isOpen;\n};\n\n/**\n * 切换显示痕迹（显示或隐藏修改痕迹）\n */\nvar toggleShowTraces = exports.toggleShowTraces = function toggleShowTraces() {\n  (0, _wpsUtils.getWpsActiveWindow)().ToggleShowAllReviewers();\n};\n\n/**\n * 按用户名称显示/隐藏修改痕迹\n * @param {string} userName 用户名\n * @param {boolean} isShow 是否显示\n * @param {object} model\n */\nvar showTracesByRole = exports.showTracesByRole = function showTracesByRole(_ref25, model) {\n  var userName = _ref25.userName,\n    isShow = _ref25.isShow;\n  var item = (0, _wpsUtils.getWpsActiveDocuments)().ActiveWindow.View.Reviewers.Item(userName);\n  if (!item) return;\n  item.Visible = isShow;\n};\n\n/**\n * 在书签位置插入表格（tableData：表格数据，{\"row\":1,\"column\":2,\"value\":\"123123\"}表示第1行第2列的表格值为123123；tableSize：表格规格，{\"row\":3,\"column\":2}}表示表格规格为3行2列）\n * @param {object} param0 {\"field\":\"书签名称\",\"tableData\":[{\"row\":1,\"column\":2,\"value\":\"123123\"},{\"row\":1,\"column\":1,\"value\":\"123123\"}],\"tableSize\":{\"row\":3,\"column\":2}}\n * @param {object} tableSize 表格大小\n * @param {object} tableData 数据\n */\nvar setDynamicTable = exports.setDynamicTable = function setDynamicTable(_ref26) {\n  var tableSize = _ref26.tableSize,\n    field = _ref26.field,\n    tableData = _ref26.tableData;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  var Bookmarks = wpsApp.ActiveDocument.Bookmarks;\n  var range = (0, _wpsUtils.isBookmarkExists)(field) ? Bookmarks.Item(field).Range : wpsApp.ActiveDocument.Application.Selection.Range;\n  // 删除原有的表格\n  if (range.Tables.Count === 1) {\n    range.Tables.Item(1).Delete();\n  }\n  var row = tableSize.row,\n    column = tableSize.column;\n  var table = wpsApp.ActiveDocument.Application.Selection.Tables.Add(range, row, column, 1, 2);\n  (0, _wpsUtils.setTableFormat)(table);\n  (0, _wpsUtils.setTableData)(table, tableData);\n\n  // 重新设置书签\n  table.Select();\n  var newRange = wpsApp.ActiveDocument.Application.Selection.Range;\n  Bookmarks.Add(field, newRange);\n};\n\n/**\n * 为指定表格新增多行数据。如该表格不是书签时，则为第一个表格\n * @param {object} param0\n * @param {string} param0.field 书签名\n * @param {number} param0.newRows 行数\n * @param {[object]} param0.newRowsData 数据\n */\nvar addTableRows = exports.addTableRows = function addTableRows(_ref27) {\n  var field = _ref27.field,\n    newRowsData = _ref27.newRowsData,\n    newRows = _ref27.newRows;\n  var _getWpsApplication = (0, _wpsUtils.getWpsApplication)(),\n    ActiveDocument = _getWpsApplication.ActiveDocument;\n  var table = (0, _wpsUtils.isBookmarkExists)(field) ? (0, _wpsUtils.getTableByBookmarks)(field) : ActiveDocument.Application.Selection.Tables.Item(1);\n  var data = (0, _wpsUtils.getNewRowData)(table, newRows, newRowsData);\n  for (var i = 1; i <= newRows; i++) {\n    table.Rows.Add();\n  }\n  (0, _wpsUtils.setTableData)(table, data);\n};\n\n/**\n * 为指定表格新增多列数据。如该表格不是书签时，则为第一个表格\n * @param {object} param0\n * @param {string} param0.field 书签名\n * @param {number} param0.newColumns 行数\n * @param {[object]} param0.newColumnsData 数据\n */\nvar addTableColumns = exports.addTableColumns = function addTableColumns(_ref28) {\n  var field = _ref28.field,\n    newColumnsData = _ref28.newColumnsData,\n    newColumns = _ref28.newColumns;\n  var _getWpsApplication2 = (0, _wpsUtils.getWpsApplication)(),\n    ActiveDocument = _getWpsApplication2.ActiveDocument;\n  var table = (0, _wpsUtils.isBookmarkExists)(field) ? (0, _wpsUtils.getTableByBookmarks)(field) : ActiveDocument.Application.Selection.Tables.Item(1);\n  var data = (0, _wpsUtils.getNewRowData)(table, newColumns, newColumnsData);\n  for (var i = 1; i <= newColumns; i++) {\n    table.Columns.Add();\n  }\n  (0, _wpsUtils.setTableData)(table, data);\n};\n\n/**\n * 合并文档，即在指定位置插入文档（原文档和合并文档的书签和复选框合并后仍可用）\n * @param {object} data {\"field\":书签名称\",\"mergeType\":0光标位置\\1文档开头\\2文档结尾\\3书签位置,\"docsUrl\":[\"文档的url\"]}\n * @param {object} props webOffice\n * @returns\n */\nvar mergeDocs = exports.mergeDocs = function mergeDocs(_ref29) {\n  var field = _ref29.field,\n    mergeType = _ref29.mergeType,\n    docsUrl = _ref29.docsUrl;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  if (mergeType === 3) {\n    var _range$Select;\n    var range = (0, _wpsUtils.isBookmarkExists)(field) && wpsApp.ActiveDocument.Bookmarks.Item(field).Range;\n    range === null || range === void 0 || (_range$Select = range.Select) === null || _range$Select === void 0 || _range$Select.call(range);\n    docsUrl.forEach(function (url) {\n      wpsApp.ActiveDocument.Application.Selection.InsertFile(url, 0);\n    });\n  } else if (mergeType < 3) {\n    docsUrl.forEach(function (url) {\n      wpsApp.ActiveDocument.Application.Selection.InsertFile(url, mergeType);\n    });\n  }\n};\n\n/**\n * 将选中区域内容作为书签\n * @param {object} param0\n * @param {string} param0.field 书签名\n */\nvar setSelectionAsField = exports.setSelectionAsField = function setSelectionAsField(_ref30) {\n  var field = _ref30.field;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  var range = wpsApp.ActiveDocument.Application.Selection.Range;\n  wpsApp.ActiveDocument.Bookmarks.Add(field, range);\n};\n\n/**\n * 将整个文档内容作为书签\n * @param {object} param0\n * @param {string} param0.field 书签名\n */\nvar setDocAsField = exports.setDocAsField = function setDocAsField(_ref31) {\n  var field = _ref31.field;\n  var _getWpsApplication3 = (0, _wpsUtils.getWpsApplication)(),\n    ActiveDocument = _getWpsApplication3.ActiveDocument;\n  ActiveDocument.Application.Selection.WholeStory();\n  var range = ActiveDocument.Application.Selection.Range;\n  ActiveDocument.Bookmarks.Add(field, range);\n};\n\n/**\n * 判断当前文档是否已更改，并将结果发送到后端\n * @param {object} param0\n */\nvar sendIsDocChange = exports.sendIsDocChange = function sendIsDocChange(_ref32, model, _ref33) {\n  var id = _ref32.id;\n  var sendValidResult = _ref33.sendValidResult;\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: true,\n    id: id,\n    type: 'isDocChange'\n  }]);\n};\n\n/**\n * 获取所有复选框(ContentControls)状态，发送到服务器\n * @param {object}} param0\n */\nvar sendAllCheckBox = exports.sendAllCheckBox = function sendAllCheckBox(_ref34, model, _ref35) {\n  var id = _ref34.id;\n  var sendValidResult = _ref35.sendValidResult;\n  var results = (0, _wpsUtils.getAllContentControls)();\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: results,\n    id: id,\n    type: 'allCheckBox'\n  }]);\n};\n\n/**\n * 获取当前文档的打开状态，将结果发送给后端\n * @param {*} param0\n */\nvar sendOpenStatus = exports.sendOpenStatus = function sendOpenStatus(_ref36, model, _ref37) {\n  var id = _ref36.id;\n  var sendValidResult = _ref37.sendValidResult;\n  var result = (0, _wpsUtils.isWpsOpen)();\n  sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n    data: result,\n    id: id,\n    type: 'openStatus'\n  }]);\n};\n\n/**\n * 批量设置复选框的值\n * @param {object} param0\n * @param {Array} param0.data\n * @param {string} param0.data.id 复选框 id\n * @param {boolean} param0.data.value 复选框的值\n */\nvar setCheckBoxValue = exports.setCheckBoxValue = function setCheckBoxValue(_ref38) {\n  var data = _ref38.data;\n  data.forEach(function (item) {\n    var idx = (0, _wpsUtils.getCheckBoxIndexById)(item.id);\n    if (idx !== -1) {\n      (0, _wpsUtils.getWpsActiveDocuments)().ContentControls.Item(idx).Checked = item.value;\n    }\n  });\n};\n\n/**\n * 设置书签内容为标题1样式\n * @param {object} param0 {\"field\":\"书签名称\",\"style\":\"标题 1\"}\n * @param {string} field 书签名\n * @param {string} style 样式\n */\nvar setTextAsTitle = exports.setTextAsTitle = function setTextAsTitle(_ref39) {\n  var field = _ref39.field,\n    style = _ref39.style;\n  if (!(0, _wpsUtils.isBookmarkExists)(field)) return;\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  var range = wpsApp.ActiveDocument.Bookmarks.Item(field);\n  range.Select();\n  wpsApp.ActiveDocument.Application.Selection.Style = (0, _wpsUtils.getHeadingStyle)(style);\n};\n\n// 保存到本地对话框\nvar saveAsLocal = exports.saveAsLocal = function saveAsLocal() {\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  wpsApp.Dialogs.Item((0, _wpsUtils.getWpsEnum)().wdDialogFileSaveAs).Display();\n};\n\n/**\n * 插入图片\n * @param {object} param0 响应数据\n * @param {[object]} param0.items 图片数据\n * @param {string} param0.items.imageUrl 图片地址\n * @param {string} param0.items.field 书签名\n * @param {string} param0.items.imageStyle.width 图片宽度\n * @param {string} param0.items.imageStyle.height 图片高度\n */\nvar insertPicture = exports.insertPicture = function insertPicture(_ref40) {\n  var data = _ref40.data;\n  data.items.forEach(function (item) {\n    var imageUrl = item.imageUrl,\n      field = item.field,\n      imageStyle = item.imageStyle;\n    var imgShape = (0, _wpsUtils.getWpsActiveDocuments)().InlineShapes.AddPicture(imageUrl);\n    if (imgShape && imageStyle) {\n      imgShape.Width = (0, _wpsUtils.getFormatValue)(imageStyle.width);\n      imgShape.Height = (0, _wpsUtils.getFormatValue)(imageStyle.height);\n    }\n  });\n};\n\n/**\n * 添加水印\n */\nvar addTextMark = exports.addTextMark = function addTextMark(data) {\n  var getVal = function getVal(val, defaultVal) {\n    return val === null || val === undefined || typeof val !== 'number' ? defaultVal : val;\n  };\n  var getLeft = function getLeft(value) {\n    var list = {\n      left: -999998,\n      center: -999995,\n      right: -999996\n    };\n    return typeof value === 'string' ? list[value] || -999995 : value;\n  };\n  var getTop = function getTop(value) {\n    var list = {\n      top: -999999,\n      center: -999995,\n      bottom: -999997\n    };\n    return typeof value === 'string' ? list[value] || -999995 : value;\n  };\n  var fontSize = data.fontSize || 120;\n  var fontFamily = data.fontFamily || '宋体';\n  var text = data.text || '样本';\n  var rotation = getVal(data.rotation, 0);\n  var transparency = getVal(data.transparency, 0); // 透明度\n  var fontColor = (0, _wpsUtils.HEX2Demical)(data.fontColor) || 12632256; // 六位16进制色值\n  var left = getLeft((0, _wpsUtils.getFormatValue)(data.left)); // -999998 左对齐 -999995 中 -999996 右\n  var top = getTop((0, _wpsUtils.getFormatValue)(data.top)); // -999999顶 -999995 中 -999997 下\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  try {\n    // 先删掉原来的\n    if (wpsApp.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Count) {\n      wpsApp.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Item(1).Delete();\n    }\n    wpsApp.ActiveWindow.ActivePane.View.SeekView = 9;\n    wpsApp.ActiveDocument.Sections.Item(1).Headers.Item(1).Shapes.AddTextEffect(0, text, fontFamily, fontSize, false, false, 0, 0).Select();\n    wpsApp.ActiveDocument.Sections.Item(1).Headers.Item(1).Shapes.Item(1).Name = 'PowerPlusWaterMarkObject30745';\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.TextEffect.NormalizedHeight = false;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Line.Visible = false;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Fill.Visible = true;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Fill.Solid();\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Fill.ForeColor = fontColor;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Fill.Transparency = transparency; // 透明度，0表示不透明\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.Rotation = rotation\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio = true\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.Height = height\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.Width = width\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.AllowOverlap = true;\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Side = 3\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Type = 3\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.ZOrder(5)\n    // webOffice.ActiveDocument.Application.Selection.ShapeRange.ZOrder(0)\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Rotation = rotation;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Left = left;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.Top = top;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio = true;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.RelativeHorizontalPosition = 0;\n    wpsApp.ActiveDocument.Application.Selection.ShapeRange.RelativeVerticalPosition = 0;\n    wpsApp.ActiveDocument.ActiveWindow.ActivePane.View.SeekView = 0;\n  } catch (err) {\n    console.warn(err);\n  }\n};\nvar delMark = exports.delMark = function delMark() {\n  var wpsApp = (0, _wpsUtils.getWpsApplication)();\n  if (wpsApp.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Count) {\n    wpsApp.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Item(1).Delete();\n  }\n};\n\n/**\n * 通用指令，用于后端自行传入方法调用 api\n * @param {object} data 后端发送的数据\n * @param {object} props\n * @param {object} yozoOffice 永中 Office\n */\nvar callEditorFunction = exports.callEditorFunction = function callEditorFunction(data, model, _ref41) {\n  var sendValidResult = _ref41.sendValidResult;\n  if (data.editorType !== _webOffice.OfficeEditMode.WpsClient) return;\n  var methods = data.methods;\n  methods.forEach(function (_ref42) {\n    var params = _ref42.params,\n      func = _ref42.func,\n      id = _ref42.id;\n    var keys = func.split('.');\n    var result = (0, _wpsUtils.getWpsApplication)();\n    for (var i = 0; i < keys.length; i++) {\n      var currentKey = keys[i];\n      var isFunction = false;\n      var paramKey = '';\n      if (/(\\w+)\\((\\$\\d+)?\\)/.test(currentKey)) {\n        var matchRes = currentKey.match(/(\\w+)\\((\\$\\d+)?\\)/);\n        currentKey = matchRes[1];\n        paramKey = matchRes[2];\n        isFunction = true;\n      }\n      try {\n        if (isFunction) {\n          var _result;\n          result = paramKey ? (_result = result)[currentKey].apply(_result, _toConsumableArray(params[paramKey])) : result[currentKey]();\n        } else {\n          result = result[currentKey];\n        }\n      } catch (err) {\n        console.error(\"\".concat(currentKey, \"\\u8C03\\u7528\\u51FA\\u9519\"));\n      }\n    }\n    if (id && result) {\n      sendValidResult === null || sendValidResult === void 0 || sendValidResult(model, [{\n        data: {\n          result: result\n        },\n        id: id,\n        type: 'getEditorResult'\n      }]);\n    }\n  });\n};\n\n//# sourceURL=webpack://bos-platform/./src/util/wpsDirectives.js?");

/***/ }),

/***/ "./src/component/web/KDQRCode.less":
/*!*****************************************!*\
  !*** ./src/component/web/KDQRCode.less ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"QRCode-value\":\"KDQRCode_QRCode-value_ia05\"});\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDQRCode.less?");

/***/ }),

/***/ "./src/component/web/KDWebOffice.less":
/*!********************************************!*\
  !*** ./src/component/web/KDWebOffice.less ***!
  \********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"root\":\"KDWebOffice_root_14us\"});\n\n//# sourceURL=webpack://bos-platform/./src/component/web/KDWebOffice.less?");

/***/ }),

/***/ "./src/component/web/base/WebOffice.less":
/*!***********************************************!*\
  !*** ./src/component/web/base/WebOffice.less ***!
  \***********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"weboffice-preview\":\"WebOffice_weboffice-preview_1AAO\",\"weboffice-default\":\"WebOffice_weboffice-default_35rp\"});\n\n//# sourceURL=webpack://bos-platform/./src/component/web/base/WebOffice.less?");

/***/ })

}]);