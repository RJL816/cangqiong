"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[9188],{

/***/ "./src/plugin/mobile/welink/plugin.js":
/*!********************************************!*\
  !*** ./src/plugin/mobile/welink/plugin.js ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = main;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.index-of.js */ \"../../node_modules/core-js/modules/es.array.index-of.js\");\nvar _clientEnv = __webpack_require__(/*! ../../clientEnv */ \"./src/plugin/clientEnv.js\");\nvar _const = __webpack_require__(/*! ../../const */ \"./src/plugin/const.js\");\nvar _promiseUtil = __webpack_require__(/*! @/api/promiseUtil */ \"./src/api/promiseUtil.js\");\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _PluginManager = __webpack_require__(/*! @/plugin/PluginManager */ \"./src/plugin/PluginManager.js\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction main(_ref, callback) {\n  var loadjs = _ref.loadjs,\n    releaseResource = _ref.releaseResource;\n  /**\n  * 插件提供的调用客户端api的集合\n  */\n  var plugin = {\n    // 设置页面标题\n    setWebViewTitle: function setWebViewTitle(title) {\n      window.HWH5.setNavigationBarTitle({\n        title: title\n      })[\"catch\"](function (error) {\n        console.log('设置标题异常', error);\n      });\n    },\n    // 关闭当前轻应用\n    closeWebView: function closeWebView() {\n      window.HWH5.close()[\"catch\"](function (error) {\n        console.log('关闭webview异常', error);\n      });\n    },\n    // 预览图片\n    previewImage: function previewImage(_ref2) {\n      var urls = _ref2.urls,\n        current = _ref2.current;\n      var index = urls.indexOf(current);\n      window.HWH5.previewImage({\n        index: index,\n        imageArray: JSON.stringify(urls),\n        waterMark: false // 也可以传参数进来控制\n      })[\"catch\"](function (error) {\n        console.log('打开失败', error);\n      });\n    },\n    // 扫码\n    scanQRCode: function scanQRCode(data, callback) {\n      window.HWH5.scanCode(data).then(function (result) {\n        var args = {\n          success: true,\n          data: {\n            qrcode_str: result.content\n          }\n        };\n        callback(args);\n      })[\"catch\"](function (error) {\n        console.log('扫码异常', error);\n      });\n    },\n    // 获取当前App的语言信息\n    // welink不支持繁体\n    getDevicedLang: function getDevicedLang(data, callback) {\n      window.HWH5.getAppInfo().then(function (result) {\n        var langMsg = result.language;\n        var lang = langMsg.indexOf('zh') > -1 ? 'zh_CN' : (0, _intlApi.getLanguage)(langMsg);\n        var data = {\n          success: true,\n          data: lang\n        };\n        callback(data);\n      })[\"catch\"](function (error) {\n        console.log('获取APP语言异常', error);\n        var data = {\n          success: false,\n          data: 'zh_CN'\n        };\n        callback(data);\n      });\n    },\n    releasePageBeforeClose: function releasePageBeforeClose(data) {\n      window.HWH5.addEventListener({\n        type: 'back',\n        func: function func() {\n          // 如果是page，并且page的config设置需要发送关闭请求到后端\n          var shouldCLoseWebView = data.shouldCLoseWebView;\n          var requestClosePage = data.requestClosePage;\n          if (requestClosePage()) {\n            // 请求服务器关闭页面\n            console.error('requestClosePage');\n            return false;\n          }\n          if (shouldCLoseWebView && shouldCLoseWebView()) {\n            try {\n              releaseResource(); // 通知释放服务器页面资源\n            } catch (error) {\n              console.error(error);\n            }\n            console.error('shouldCLoseWebView');\n            window.HWH5.close()[\"catch\"](function (error) {\n              console.log('关闭webview异常', error);\n            });\n            return true;\n          }\n          if (window.history.length <= 1) {\n            console.error('closeWebView');\n            return true;\n          } else {\n            console.error('history');\n            return true;\n          }\n        }\n      })[\"catch\"](function (error) {\n        console.error('监听事件发生异常', error);\n      });\n    }\n  };\n  loadjs(window.__kd_cdnPath__ + '/public/thirdjs/welink/hwh5-cloudonline.js', {\n    success: function success() {\n      console.log('welink插件加载成功');\n      (0, _PluginManager.loadDynamicPlugin)(plugin);\n      callback && callback(true);\n      (0, _promiseUtil.getRootConfigPromise)().then(function (config) {\n        (0, _clientEnv.getAppTrdAuthData)(_const.WE_LINK).then(function (authData) {\n          if ((0, _clientEnv.isAuthSuccess)(authData)) {\n            var data = authData.data;\n            setWXConfig(data);\n          } else {\n            console.error(\"\\u9274\\u6743\\u5931\\u8D25\\uFF0CgetAppTrdAuthData.do\\u63A5\\u53E3\\u8FD4\\u56DE\\u6570\\u636E\\uFF1A\".concat(JSON.stringify(authData)));\n          }\n        });\n      });\n    },\n    error: function error() {\n      console.error('welink插件加载失败');\n      callback && callback(true);\n    }\n  });\n  function setWXConfig(data) {\n    var _data$config = data.config,\n      signature = _data$config.signature,\n      timestamp = _data$config.timestamp,\n      nonce = _data$config.nonce,\n      appId = _data$config.appId;\n    var clientApiList = window.clientApiList || [];\n    window.HWH5.config({\n      appId: appId,\n      timestamp: timestamp,\n      noncestr: nonce,\n      signature: signature,\n      jsApiList: ['setNavigationBarTitle', 'close', 'previewImage', 'scanCode', 'getAppInfo', 'addEventListener'].concat(_toConsumableArray(clientApiList))\n    });\n    window.HWH5.ready(function () {\n      console.log('welink 鉴权成功');\n      (0, _PluginManager.loadDynamicPlugin)(clientApiList);\n    });\n    window.HWH5.error(function (err) {\n      console.log('welink 鉴权失败:', err);\n    });\n  }\n}\n\n//# sourceURL=webpack://bos-platform/./src/plugin/mobile/welink/plugin.js?");

/***/ })

}]);