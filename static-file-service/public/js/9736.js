"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[9736],{

/***/ "./src/component/common/yongzhong/YozoEditor.jsx":
/*!*******************************************************!*\
  !*** ./src/component/common/yongzhong/YozoEditor.jsx ***!
  \*******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-properties.js */ \"../../node_modules/core-js/modules/es.object.define-properties.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptors.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptors.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\n__webpack_require__(/*! core-js/modules/web.timers.js */ \"../../node_modules/core-js/modules/web.timers.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _memoryCacher = __webpack_require__(/*! @/model/memoryCacher */ \"./src/model/memoryCacher.js\");\nvar _server = __webpack_require__(/*! @/action/actionname/control/weboffice/server */ \"./src/action/actionname/control/weboffice/server/index.js\");\nvar _webOffice = __webpack_require__(/*! @/constant/webOffice */ \"./src/constant/webOffice.js\");\nvar _toolUtils = __webpack_require__(/*! @/util/toolUtils */ \"./src/util/toolUtils.js\");\nvar directives = _interopRequireWildcard(__webpack_require__(/*! ./yozoEditorDirective */ \"./src/component/common/yongzhong/yozoEditorDirective.js\"));\nvar _storage = _interopRequireDefault(__webpack_require__(/*! @/util/storage */ \"./src/util/storage.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; } /**\n * 永中文档编辑\n */\nfunction YoZoEditor(_ref) {\n  var className = _ref.className,\n    ctrlKey = _ref.ctrlKey,\n    pageId = _ref.pageId,\n    style = _ref.style,\n    url = _ref.url,\n    save = _ref.save,\n    sendValidResult = _ref.sendValidResult;\n  var _useState = (0, _react.useState)(url),\n    _useState2 = _slicedToArray(_useState, 2),\n    fileUrl = _useState2[0],\n    setFileUrl = _useState2[1];\n  var yozoRef = (0, _react.useRef)();\n  var queryCount = (0, _react.useRef)(0);\n  var cacheRef = (0, _react.useRef)([]);\n  var saveInfo = (0, _react.useRef)({});\n  var ctrlId = (0, _react.useRef)(\"\".concat(pageId, \"_\").concat(ctrlKey, \"_\").concat(_webOffice.YozoCtrlKey));\n  (0, _react.useEffect)(function () {\n    ctrlId.current = \"\".concat(pageId, \"_\").concat(ctrlKey, \"_\").concat(_webOffice.YozoCtrlKey);\n    (0, _memoryCacher.setControlMount)(pageId, \"\".concat(ctrlKey, \"_\").concat(_webOffice.YozoCtrlKey), true);\n    return function () {\n      (0, _memoryCacher.setControlMount)(pageId, \"\".concat(ctrlKey, \"_\").concat(_webOffice.YozoCtrlKey), false);\n    };\n  }, [pageId, ctrlKey]);\n  (0, _react.useEffect)(function () {\n    var removeDataChangeListener = (0, _memoryCacher.subscribeControlMethod)(pageId, \"\".concat(ctrlKey, \"_\").concat(_webOffice.YozoCtrlKey), 'directives', executeControlMethod);\n    return function () {\n      removeDataChangeListener();\n    };\n  }, [pageId, ctrlKey]);\n  var executeControlMethod = function executeControlMethod(event) {\n    if (event === undefined || Array.isArray(event) && event.length === 0) return;\n    if (event[0].methodname === _server.WEB_OFFICE_ACTION) {\n      var _yozoRef$current;\n      var methodName = event[0].args[0].event;\n      var data = Array.isArray(event[0].args[0]) ? event[0].args[0] : event[0].args[0].data;\n      if (methodName === 'open' || methodName === 'openNew') {\n        var _url = data.editUrlForYozo || data.newEditUrlForYozo;\n        var fileKey = (0, _toolUtils.getUrlParam)(_url, 'fid') || '';\n        _storage[\"default\"].set(fileKey, \"\".concat(pageId, \"$$\").concat(ctrlKey));\n        setFileUrl(_url);\n        return;\n      } else if (methodName === 'saveSuccess') {\n        var _url2 = data.url,\n          uid = data.fileKey;\n        save === null || save === void 0 || save([_objectSpread({\n          uid: uid,\n          url: _url2\n        }, saveInfo.current)]);\n        return;\n      } else if (methodName === 'save') {\n        saveInfo.current = {\n          name: data.name,\n          id: data.id\n        };\n      }\n      if ((_yozoRef$current = yozoRef.current) !== null && _yozoRef$current !== void 0 && (_yozoRef$current = _yozoRef$current.contentWindow) !== null && _yozoRef$current !== void 0 && (_yozoRef$current = _yozoRef$current.YozoOffice) !== null && _yozoRef$current !== void 0 && _yozoRef$current.Application) {\n        directives[methodName](data, {\n          sendValidResult: sendValidResult\n        })(ctrlId.current);\n        return;\n      }\n      cacheRef.current.push({\n        methodName: methodName,\n        data: data\n      });\n    }\n  };\n  var handleLoad = function handleLoad() {\n    // 永中没有提供生命周期方法，无法判定是否加载完成，\n    // 在 iframe onLoad 中进行轮询\n    var intervalId = setInterval(function () {\n      var _yozoRef$current2;\n      if ((_yozoRef$current2 = yozoRef.current) !== null && _yozoRef$current2 !== void 0 && (_yozoRef$current2 = _yozoRef$current2.contentWindow) !== null && _yozoRef$current2 !== void 0 && (_yozoRef$current2 = _yozoRef$current2.YozoOffice) !== null && _yozoRef$current2 !== void 0 && _yozoRef$current2.Application || queryCount.current === 8) {\n        var _yozoRef$current3;\n        clearInterval(intervalId);\n        if ((_yozoRef$current3 = yozoRef.current) !== null && _yozoRef$current3 !== void 0 && (_yozoRef$current3 = _yozoRef$current3.contentWindow) !== null && _yozoRef$current3 !== void 0 && (_yozoRef$current3 = _yozoRef$current3.YozoOffice) !== null && _yozoRef$current3 !== void 0 && _yozoRef$current3.Application && cacheRef.current.length > 0) {\n          cacheRef.current.forEach(function (_ref2) {\n            var methodName = _ref2.methodName,\n              data = _ref2.data;\n            directives[methodName](data, {\n              sendValidResult: sendValidResult\n            })(ctrlId.current);\n          });\n          cacheRef.current = [];\n        }\n      } else {\n        queryCount.current++;\n      }\n    }, 1000);\n  };\n  return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    style: _objectSpread({\n      width: '100%',\n      height: '100%'\n    }, style),\n    className: className\n  }, fileUrl && /*#__PURE__*/_react[\"default\"].createElement(\"iframe\", {\n    id: ctrlId.current,\n    style: {\n      width: '100%',\n      height: '100%'\n    },\n    src: fileUrl,\n    ref: yozoRef,\n    onLoad: handleLoad\n  }));\n}\nvar _default = exports[\"default\"] = YoZoEditor;\n\n//# sourceURL=webpack://bos-platform/./src/component/common/yongzhong/YozoEditor.jsx?");

/***/ }),

/***/ "./src/component/common/yongzhong/yozoEditorDirective.js":
/*!***************************************************************!*\
  !*** ./src/component/common/yongzhong/yozoEditorDirective.js ***!
  \***************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.toggleShowTraces = exports.showTracesByRole = exports.setTrackingMode = exports.setToolbars = exports.setTitlebar = exports.setTextAsTitle = exports.setSelectionEditArea = exports.setSelectionAsField = exports.setMenubar = exports.setDynamicTable = exports.setDocUnLimitByRole = exports.setDocUnLimit = exports.setDocLimitByRole = exports.setDocLimit = exports.setDocAsField = exports.setCheckBoxValue = exports.setCaption = exports.sendTextByField = exports.sendOpenStatus = exports.sendIsFieldRevise = exports.sendIsDocChange = exports.sendFieldExist = exports.sendAllField = exports.sendAllCheckBox = exports.saveAsLocal = exports.save = exports.openNew = exports.open = exports.modifyMark = exports.mergeDocs = exports.locateMark = exports.isDirty = exports.insertValue = exports.insertPictures = exports.docProtect = exports.docCompare = exports.deleteMark = exports.delMark = exports.close = exports.cancelSelectionEditArea = exports.callEditorFunction = exports.addTextMark = exports.addTableRows = exports.addTableColumns = exports.addMark = exports.addCommentDialog = exports.HEX2Demical = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.parse-int.js */ \"../../node_modules/core-js/modules/es.parse-int.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.string.ends-with.js */ \"../../node_modules/core-js/modules/es.string.ends-with.js\");\n__webpack_require__(/*! core-js/modules/es.string.match.js */ \"../../node_modules/core-js/modules/es.string.match.js\");\n__webpack_require__(/*! core-js/modules/es.string.replace.js */ \"../../node_modules/core-js/modules/es.string.replace.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _webOffice = __webpack_require__(/*! @/constant/webOffice */ \"./src/constant/webOffice.js\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; } /**\n * WPS 响应方法\n */\n/**\n * 设置是否显示标题栏\n * @param {object} data {value:true\\false}\n * @param {object} props webOffice\n */\nvar setTitlebar = exports.setTitlebar = function setTitlebar(data, props) {\n  return function (webOffice) {};\n};\n\n/**\n * 设置是否显示工具栏\n * @param {object} data {value:true\\false}\n * @param {object} props webOffice\n */\nvar setToolbars = exports.setToolbars = function setToolbars(data, props) {\n  return function (webOffice) {};\n};\n\n/**\n * 设置是否显示菜单栏\n * @param {object} data {value:true\\false}\n * @param {object} props webOffice\n */\nvar setMenubar = exports.setMenubar = function setMenubar(data, props) {\n  return function (webOffice) {};\n};\n\n/**\n * 添加控件标题栏文字\n * @param {object} data {value:\"标题栏文字\"}\n * @param {object} props webOffice\n */\nvar setCaption = exports.setCaption = function setCaption(data, props) {\n  return function (webOffice) {};\n};\n\n/**\n * 打开Office文档包括（.doc、.docx、.xls、.xlsx），打开前先将本地Office窗口关闭\n * @param {object} data {\"url\":\"文档url\",\"userName\":\"用户名\",\"name\":\"文件名\"}\n * @param {object} props webOffice\n */\nvar open = exports.open = function open() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (webOffice) {};\n};\n\n/**\n * @param {object} data {\"fileType\":\"Word.Document\"}\n * @param {object} props webOffice\n */\nvar openNew = exports.openNew = function openNew(data, props) {\n  return function (webOffice) {};\n};\n\n/**\n * 同步保存\n * @param {object} data {\"uploadUrl\":\"上传文件服务器地址（必须是完整url）\",\"name\":\"文件名称（包含后缀）\"}\n * @param {object} props webOffice\n */\nvar save = exports.save = function save() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (yozoOffice) {\n      yozoOffice.Application.ActiveDocument.Save();\n    }\n  };\n};\n\n/**\n * 关闭文档\n * @param {object} data\n * @param {object} props webOffice\n */\nvar close = exports.close = function close(data, props) {};\n\n// 打开 spyApi.doPostActions(\"pageId\",'InvokeControlMethod',[{props: [ {data:{'uploadUrl':'https://feature.kingdee.com:2024/devbos/attachment/uploadFile.do', lockData:[{name:'甲方',isLock:'true', pwd:'123', dataField:[{'data1':[{field1:'标签1'},{'field2':'标签2'}]]}, {name:'乙方',isLock:'true', pwd:'123', dataField:[]}]}, 'event':'save'} ], key: \"webofficeap\", methodname: \"webOfficeAction\"}])\n/**\n * 在光标位置插入文本内容\n * @param {object} data {\"needEnterBefore\":true\\false是否需要在插入文本前添加回车换行（可触发office自动编号）}\n * @param {object} props webOffice\n */\nvar insertValue = exports.insertValue = function insertValue() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var needEnterBefore = data.needEnterBefore,\n      value = data.value;\n    var enter = '';\n    if (needEnterBefore) {\n      enter = '\\r\\n';\n    }\n    var newValue = \"\".concat(enter).concat(value);\n    yozoOffice.Application.Selection.Text = newValue;\n  };\n};\n\n/**\n * 在光标位置或选中文字处插入批注\n * @param {object} data\n * @param {object} props webOffice\n */\nvar addCommentDialog = exports.addCommentDialog = function addCommentDialog(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var range = yozoOffice.Application.Selection.Range;\n    yozoOffice.Application.ActiveDocument.Comments.Add(range);\n  };\n};\n\n/**\n * 文本比较（暂不支持docx格式的文档比较），使用此功能需更改本地Office设置，比较结果会在本地Office打开\n * @param {object} data {\"currentFile\":\"原文档名称.doc\",currentFileUrl：\"原文档url\",\"compareFile\":\"比较文档名称.doc\",\"compareFileUrl\":\"比较文档url\"}\n * @param {object} props webOffice\n */\nvar docCompare = exports.docCompare = function docCompare() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n};\n\n/**\n * strFieldName：书签的名字\n * strSheetName：预留字段（值为空）\n * 返回值: 返回书签的值\n */\n\n// 批量添加变量，1.页面关闭前需要关闭控件，智能窗不存在这个问题 2.判断是否打开状态，3.设置变量后不能在前面添加， 4.失败的情况怎么处理，5.用到多个变量需要给他添加不同field名称，field是唯一的6.判断书签是否存在,标签值不允许为空 7.32位，以管理员运行\n/**\n * 在光标位置插入一个书签，用于定义模板变量，书签即变量\n * @param {object} data {\"field\":\"书签名称\",\"value\":\"{变量名称}\"}\n * @param {object} props webOffice\n */\nvar addMark = exports.addMark = function addMark() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field,\n      value = data.value;\n    var _yozoOffice$Applicati = yozoOffice.Application,\n      Selection = _yozoOffice$Applicati.Selection,\n      ActiveDocument = _yozoOffice$Applicati.ActiveDocument;\n    var Bookmarks = ActiveDocument.Bookmarks;\n    var range = Selection.Range;\n    var rangeStart = range.Start;\n    insertValue({\n      value: value\n    })(yozoOffice);\n    var newRange = ActiveDocument.Range(rangeStart, rangeStart + value.length);\n    Bookmarks.Add(field, newRange);\n  };\n};\n\n/**\n * 替换书签的值 （支持批量替换）\n * @param {object} data [{\"field\":\"书签名称1\",\"value\":\"变量的值1\"},{\"field\":\"书签名称2\",\"value\":\"变量的值2\"}]\n * @param {object} props webOffice\n */\nvar modifyMark = exports.modifyMark = function modifyMark(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice || !Array.isArray(data)) return;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    data.forEach(function (item) {\n      var field = item.field,\n        value = item.value;\n      if (!Bookmarks.Exists(field)) return;\n      var range = Bookmarks.Item(field).Range;\n      range.Text = value;\n      Bookmarks.Add(field, range);\n    });\n  };\n};\n\n/**\n   * 删除文档中书签（支持批量删除）\n   * @param {object} data [{\"field\":\"书签名称1\"}, { \"field\":\"书签名称2\"}]\n   * @param {object} props webOffice\n   */\nvar deleteMark = exports.deleteMark = function deleteMark(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice || !Array.isArray(data)) return;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    data.forEach(function (_ref) {\n      var field = _ref.field;\n      if (Bookmarks.Exists(field)) {\n        Bookmarks.Item(field).Delete();\n      }\n    });\n  };\n};\n\n/**\n   * 定位到某个书签的位置\n   * @param {object} data {\"field\":\"书签名称1\"}\n   * @param {object} props webOffice\n   */\nvar locateMark = exports.locateMark = function locateMark(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    if (!Bookmarks.Exists(field)) return;\n    Bookmarks.Item(field).Select();\n  };\n};\n\n/**\n * todo:提示文档已锁定， 密码加密传输\n * isProtect参数设为0时，才能设置文档只允许修订\\只允许添加批注\\完全保护（不允许任何操作）\n * @param {object} data {\"isProtect\": 0保护\\1解除保护,\"protectType\":0只允许修订\\1只允许添加批注\\2完全保护,\"password\":\"文档保护的密码\"}\n * @param {object} props webOffice\n */\nvar docProtect = exports.docProtect = function docProtect() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var isProtect = data.isProtect,\n      protectType = data.protectType,\n      password = data.password;\n    if (isProtect === 0) {\n      yozoOffice.Application.ActiveDocument.Protect(protectType, true, password);\n    } else {\n      yozoOffice.Application.ActiveDocument.Unprotect(password);\n    }\n  };\n};\n\n// 先执行局部编辑， 再把可编辑区域划分出来\n\n/**\n * 开启区域限制，开启后文档将被限制编辑，只有允许编辑的区域才能被编辑\n * @param {object} data {\"password\":\"密码\"}\n * @param {object} props webOffice\n */\nvar setDocLimit = exports.setDocLimit = function setDocLimit() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n};\n\n// 解除限制\n/**\n * 解除区域限制，文档恢复可编辑状态\n * @param {object} data {\"password\":\"密码\"}\n * @param {object} props webOffice\n */\nvar setDocUnLimit = exports.setDocUnLimit = function setDocUnLimit() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var password = data.password;\n    yozoOffice.Application.ActiveDocument.Unprotect(password);\n  };\n};\n\n/**\n * 设置选中区域为可编辑区域，编辑模板时使用（选中区域将被设置为书签）\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar setSelectionEditArea = exports.setSelectionEditArea = function setSelectionEditArea() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field;\n    var Application = yozoOffice.Application;\n    var range = Application.Selection.Range;\n    var Bookmarks = Application.ActiveDocument.Bookmarks;\n    if (Bookmarks.Exists(field)) {\n      Bookmarks.Add(field, range);\n    }\n    Application.Editors.Add(-1);\n  };\n};\n\n/**\n * 取消选中区域的第一个书签内容的编辑状态（对应书签将被删除）\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar cancelSelectionEditArea = exports.cancelSelectionEditArea = function cancelSelectionEditArea() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = arguments.length > 1 ? arguments[1] : undefined;\n  return function (domId) {\n    var _Bookmarks$Item;\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field;\n    var Application = yozoOffice.Application;\n    var Bookmarks = Application.ActiveDocument.Bookmarks;\n    Application.Selection.Editors.Item(-1).Delete();\n    (_Bookmarks$Item = Bookmarks.Item(field)) === null || _Bookmarks$Item === void 0 || _Bookmarks$Item.Delete(); // 只删除书签，保留对应文本\n  };\n};\n\n/**\n * 批量设置书签内容为可编辑，并开启区域限制，其他区域将被锁定\n * @param {object} data {\"field\":[\"书签名称1\",\"书签名称2\"],\"password\":\"密码\"}\n * @param {object} props webOffice\n */\nvar setDocLimitByRole = exports.setDocLimitByRole = function setDocLimitByRole(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var items = data.field;\n    var password = data.password;\n    var Application = yozoOffice.Application;\n    var Bookmarks = Application.ActiveDocument.Bookmarks;\n    items.forEach(function (item) {\n      var mark = item;\n      try {\n        Bookmarks.Add(mark);\n        Bookmarks.Item(mark).Range.Editors.Add(-1);\n      } catch (e) {\n        console.error('setDocLimitByRole 指令执行失败', e);\n      }\n    });\n    // 最后一个参数是限制格式和编辑属性， 开启后无法在可编辑区域编辑格式\n    Application.ActiveDocument.Protect(3, false, password, false, false); // 开启保护文档功能并设定密码为:123，mark1书签为可编辑\n  };\n};\n\n/**\n *批量取消取消书签内容的可编辑状态\n * @param {object} data [{\"field\":\"书签名称1\"}，{\"field\":\"书签名称2\"}]\n * @param {object} props webOffice\n */\nvar setDocUnLimitByRole = exports.setDocUnLimitByRole = function setDocUnLimitByRole(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var items = data.data;\n    items.forEach(function (item) {\n      var mark = item.field;\n      try {\n        var _yozoOffice$Applicati2;\n        (_yozoOffice$Applicati2 = yozoOffice.Application.ActiveDocument.Bookmarks.Item(mark)) === null || _yozoOffice$Applicati2 === void 0 || (_yozoOffice$Applicati2 = _yozoOffice$Applicati2.Range) === null || _yozoOffice$Applicati2 === void 0 || _yozoOffice$Applicati2.Editors.Item(-1).Delete();\n      } catch (e) {\n        console.error('setDocUnLimitByRole 指令执行失败', e);\n      }\n    });\n  };\n};\n\n/**\n * 根据书签名称获取文本内容并发送后端\n * @param {object} data {\"field\":\"书签名称\",\"id\":\"回调的id\"}\n * @param {object} props webOffice\n */\nvar sendTextByField = exports.sendTextByField = function sendTextByField(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var sendValidResult = props.sendValidResult;\n    var field = data.field,\n      id = data.id;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    var result = Bookmarks.Exists(field) ? Bookmarks.Item(field).Text : '';\n    sendValidResult([{\n      data: {\n        result: result,\n        field: field\n      },\n      id: id,\n      type: 'getTextByField'\n    }]);\n  };\n};\n\n/**\n * 书签内容是否有任意改动（包含样式、批注等），并将结果发给后端\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar sendIsFieldRevise = exports.sendIsFieldRevise = function sendIsFieldRevise(data, props) {\n  // const { sendValidResult, model } = props\n  // const { field, id } = data\n  // const { Bookmarks } = window.YozoOffice.Application.ActiveDocument\n  // if (Bookmarks.Exists(field)) {\n  //   const selection = Bookmarks.Item(field).Select()\n  //   const result = selection.Range.Revisions.Count\n  //   sendValidResult(model, [{ data: { result, field }, id, type: 'isFieldRevise' }])\n  // }\n};\n\n/**\n * 判断当前书签是否存在，并将结果发送给后端\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar sendFieldExist = exports.sendFieldExist = function sendFieldExist(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var sendValidResult = props.sendValidResult;\n    var field = data.field,\n      id = data.id;\n    var result = yozoOffice.Application.ActiveDocument.Bookmarks.Exists(field);\n    sendValidResult([{\n      data: {\n        result: result,\n        field: field\n      },\n      id: id,\n      type: 'fieldExist'\n    }]);\n  };\n};\n\n/**\n * 获取当前文档所有书签，并将结果发送给后端\n * @param {object} data\n * @param {object} props webOffice\n */\nvar sendAllField = exports.sendAllField = function sendAllField(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var sendValidResult = props.sendValidResult;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    var count = Bookmarks.Count;\n    var result = [];\n    for (var i = 1; i <= count; i++) {\n      result.push(Bookmarks.Item(i).Name);\n    }\n    var id = data.id;\n    sendValidResult([{\n      data: result,\n      id: id,\n      type: 'allField'\n    }]);\n  };\n};\n\n/**\n * 判断当前文档是否已更改，并将结果发送给后端\n * @param {object} data\n * @param {object} props webOffice\n */\nvar sendIsDocChange = exports.sendIsDocChange = function sendIsDocChange(data, props) {\n  return function (domId) {\n    var sendValidResult = props.sendValidResult;\n    var id = data.id;\n    sendValidResult([{\n      data: true,\n      id: id,\n      type: 'isDocChange'\n    }]);\n  };\n};\n\n// webOffice.GetApplication.username = userName || ''\n/**\n * 开启强制留痕模式,开启后所有修改痕迹将被记录\n * @param {object} data {\"userName\":\"\",\"trackType\":1开启留痕模式并开始修订\\0关闭留痕模式\\4接受当前所有修订}\n * @param {object} props webOffice\n */\nvar setTrackingMode = exports.setTrackingMode = function setTrackingMode(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var userName = data.userName,\n      trackType = data.trackType;\n    yozoOffice.Application.ActiveDocument.TrackRevisions = trackType !== 0;\n  };\n};\n\n/**\n * 切换显示痕迹（显示或隐藏修改痕迹）\n * @param {object} data\n * @param {object} props webOffice\n */\nvar toggleShowTraces = exports.toggleShowTraces = function toggleShowTraces(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var markup = yozoOffice.Application.ActiveWindow.View.RevisionsFilter.Markup;\n    yozoOffice.Application.ActiveWindow.View.RevisionsFilter.Markup = markup === 0 ? 2 : 0;\n  };\n};\n\n/**\n * 按用户名称显示、隐藏修改痕迹\n * @param {object} data {userName: '用户名'，isShow:true}\n * @param {object} props webOffice\n */\nvar showTracesByRole = exports.showTracesByRole = function showTracesByRole(data, props) {};\n\n/**\n * 在书签位置插入表格（tableData：表格数据，{\"row\":1,\"column\":2,\"value\":\"123123\"}表示第1行第2列的表格值为123123；tableSize：表格规格，{\"row\":3,\"column\":2}}表示表格规格为3行2列）\n * @param {object} data {\"field\":\"书签名称\",\"tableData\":[{\"row\":1,\"column\":2,\"value\":\"123123\"},{\"row\":1,\"column\":1,\"value\":\"123123\"}],\"tableSize\":{\"row\":3,\"column\":2}}\n * @param {object} props webOffice\n */\nvar setDynamicTable = exports.setDynamicTable = function setDynamicTable(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    //  { tableSize: { row: 1, column: 2 }, tableData: [{ row: 1, column: 2, value: '123123' }, { row: 1, column: 3, value: '123123' }] }\n    var tableSize = data.tableSize,\n      field = data.field,\n      tableData = data.tableData;\n    var row = tableSize.row,\n      column = tableSize.column;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n\n    // 新增表格\n    // Add(range, row, column, 1, AutoFitBehavior)\n    // DefaultTableBehavior 指定Microsoft Word是否自动调整表中单元格的大小以适合内容（AutoFit）: wdWord8TableBehavior 0 禁用自动调整，默认。wdWord9TableBehavior 1 启用自动调整。\n    // AutoFitBehavior: wdAutoFitContent  1 表格会自动调整大小以适合表格中包含的内容。wdAutoFitFixed  0 该表设置为固定大小，而不管其内容如何，并且不会自动调整大小。wdAutoFitWindow  2 表格会自动调整为活动窗口的宽度。\n    var ActiveDocument = yozoOffice.Application.ActiveDocument;\n    var Range = ActiveDocument.Range,\n      Tables = ActiveDocument.Tables;\n    var range;\n    if (Bookmarks.Exists(field)) {\n      var bookmarkRange = Bookmarks.Item(field).Range;\n      range = Range(bookmarkRange.Start, bookmarkRange.Start);\n    } else {\n      var selectionRange = yozoOffice.Application.Selection.Range;\n      range = Range(selectionRange.Start, selectionRange.Start);\n    }\n    var table = Tables.Add(range, row, column, 1, 2);\n    setTableData(table, tableData, yozoOffice);\n    // 为表格重新添加书签\n    table.Select();\n    // webOffice.ActiveDocument.Application.Selection.Tables(1).AutoFitBehavior(2)\n    var range2 = yozoOffice.Application.Selection.Range;\n    ActiveDocument.Bookmarks.Add(field, range2);\n  };\n};\nvar setTableData = function setTableData(table, data, yozoOffice) {\n  data.forEach(function (item) {\n    table.Cell(item.row, item.column).Goto();\n    yozoOffice.Application.Selection.Text = item.value;\n  });\n};\nvar getTableByField = function getTableByField(yozoOffice, field) {\n  yozoOffice.Application.ActiveDocument.Bookmarks.Item(field).Select();\n  return yozoOffice.Application.Selection.Tables(1);\n};\nvar getTableRows = function getTableRows(table) {\n  return table.Rows.Count;\n};\nvar getTableColumns = function getTableColumns(table) {\n  return table.Columns.Count;\n};\n\n// 获取新增一行的行数据\nvar getNewRowData = function getNewRowData(table, newRows, data) {\n  var rows = getTableRows(table);\n  var columns = getTableColumns(table);\n  var newData = [];\n  for (var i = 0; i < newRows; i++) {\n    for (var j = 0; j < columns; j++) {\n      var item = {\n        row: rows + i + 1,\n        column: j + 1,\n        value: data[i][j]\n      };\n      newData.push(item);\n    }\n  }\n  return newData;\n};\n\n// 获取新增一列的列数据\nvar getNewColumnData = function getNewColumnData(table, newColumns, data) {\n  var rows = getTableRows(table);\n  var columns = getTableColumns(table);\n  var newData = [];\n  for (var i = 0; i < newColumns; i++) {\n    for (var j = 0; j < rows; j++) {\n      var item = {\n        row: j + 1,\n        column: columns + i + 1,\n        value: data[i][j]\n      };\n      newData.push(item);\n    }\n  }\n  return newData;\n};\n\n/**\n * 为指定表格新增多行数据，需先将表格设为书签，否则默认是第一个表格\n * @param {object} data {\"field\":'表格所在的书签名', \"newRows\":2, \"newRowsData\":[['123123' , '123123' ], ['123123' , '123123' ]]}\n * @param {object} props webOffice\n */\nvar addTableRows = exports.addTableRows = function addTableRows(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field,\n      newRowsData = data.newRowsData,\n      newRows = data.newRows;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    var table = Bookmarks.Exists(field) ? getTableByField(yozoOffice, field) : yozoOffice.Application.ActiveDocument.Tables.Item(1);\n    var tableData = getNewRowData(table, newRows, newRowsData);\n    for (var i = 1; i <= newRows; i++) {\n      var rowCount = table.Rows.Count;\n      table.Rows.Item(rowCount).Add();\n    }\n    setTableData(table, tableData, yozoOffice);\n  };\n};\n\n/**\n * 为指定的表格新增多列数据，需先将表格设为书签，否则默认是第一个表格\n * @param {object} data {\"field\":'表格所在的书签名', \"newColumns\":2, \"newRowsData\":[['123123' , '123123' ], ['123123' , '123123' ]]}\n * @param {object} props webOffice\n */\nvar addTableColumns = exports.addTableColumns = function addTableColumns(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field,\n      newColumnsData = data.newColumnsData,\n      newColumns = data.newColumns;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    var table = Bookmarks.Exists(field) ? getTableByField(yozoOffice, field) : yozoOffice.Application.ActiveDocument.Tables.Item(1);\n    var tableData = getNewColumnData(table, newColumns, newColumnsData);\n    for (var i = 1; i <= newColumns; i++) {\n      var columnIndex = table.Columns.Count;\n      table.Columns.Item(columnIndex).Add();\n    }\n    setTableData(table, tableData, yozoOffice);\n    table.AutoFitBehavior(2);\n  };\n};\n\n/**\n * 合并文档，即在指定位置插入文档（原文档和合并文档的书签和复选框合并后仍可用）\n * @param {object} data {\"field\":书签名称\",\"mergeType\":0光标位置\\1文档开头\\2文档结尾\\3书签位置,\"docsUrl\":[\"文档的url\"]}\n * @param {object} props webOffice\n */\nvar mergeDocs = exports.mergeDocs = function mergeDocs(data, props) {\n  return function (domId) {};\n};\n\n/**\n * 设置选中区域内容为书签\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar setSelectionAsField = exports.setSelectionAsField = function setSelectionAsField(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field;\n    var range = yozoOffice.Application.Selection.Range;\n    yozoOffice.Application.ActiveDocument.Bookmarks.Add(field, range);\n  };\n};\n\n/**\n * 设置整个文档内容为书签\n * @param {object} data {\"field\":\"书签名称\"}\n * @param {object} props webOffice\n */\nvar setDocAsField = exports.setDocAsField = function setDocAsField(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field;\n    var myParaCount = yozoOffice.Application.ActiveDocument.Paragraphs.Count;\n    var myEnd = yozoOffice.Application.ActiveDocument.Paragraphs.Item(myParaCount).Range.End;\n    var myRange = yozoOffice.Application.ActiveDocument.Range(0, myEnd);\n    yozoOffice.Application.ActiveDocument.Bookmarks.Add(field, myRange);\n  };\n};\n\n// 检测文档是否变动，包含样式变动\nvar isDirty = exports.isDirty = function isDirty(domId) {};\nvar getAllCheckBox = function getAllCheckBox(domId) {};\n\n/**\n * 查找所有复选框，并将结果发送给后端\n * @param {object} data {\"fileType\":\"\"}\n * @param {object} props webOffice\n */\nvar sendAllCheckBox = exports.sendAllCheckBox = function sendAllCheckBox(data, props) {\n  return function (domId) {\n    // const { sendValidResult, model } = props\n    // const result = getAllCheckBox(webOffice)\n    // const { id } = data\n    // //   [{\"id\":复选框id,\"value\":true\\false复选框的值,\"title\":\"复选框标题\"}]\n    // sendValidResult(model, [{ data: result, id, type: 'allCheckBox' }])\n  };\n};\n\n/**\n * 获取当前文档的打开状态，并将结果发送给后端\n * @param {object} data {\"fileType\":\"\"}\n * @param {object} props webOffice\n */\nvar sendOpenStatus = exports.sendOpenStatus = function sendOpenStatus(data, props) {\n  return function (domId) {\n    var sendValidResult = props.sendValidResult;\n    var id = data.id;\n    sendValidResult([{\n      data: true,\n      id: id,\n      type: 'openStatus'\n    }]);\n  };\n};\n\n/**\n * 批量修改复选框的值\n * @param {object} data [{\"id\":复选框id1,\"value\":true\\false},{\"id\":复选框id2,\"value\":true\\false}]\n * @param {object} props webOffice\n */\nvar setCheckBoxValue = exports.setCheckBoxValue = function setCheckBoxValue(data, props) {\n  return function (domId) {};\n};\nfunction getFontSize(style) {\n  if (style === '标题 1') return 20;else if (style === '标题 2') return 17;else if (style === '标题 3') return 15;else if (style === '标题 4') return 13;else if (style === '标题 5') return 12;else if (style === '标题 6') return 11;else if (style === '标题 7') return 11;else if (style === '标题 8') return 11;else if (style === '标题 9') return 10.5;else return 11;\n}\n\n/**\n * 设置书签内容为标题1样式\n * @param {object} data {\"field\":\"书签名称\",\"style\":\"标题 1\"}\n * @param {object} props webOffice\n */\nvar setTextAsTitle = exports.setTextAsTitle = function setTextAsTitle(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var field = data.field,\n      style = data.style;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    if (Bookmarks.Exists(field)) {\n      yozoOffice.Application.Selection.Goto(-1, null, null, field);\n      yozoOffice.Application.ActiveDocument.Selection.Font.Size = getFontSize(style);\n    }\n  };\n};\n\n// 保存到本地对话框\nvar saveAsLocal = exports.saveAsLocal = function saveAsLocal(data, props) {\n  return function (domId) {};\n};\nvar insertPictures = exports.insertPictures = function insertPictures(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var items = data.data;\n    var Bookmarks = yozoOffice.Application.ActiveDocument.Bookmarks;\n    items.forEach(function (item) {\n      var imageUrl = item.imageUrl,\n        field = item.field,\n        imageStyle = item.imageStyle;\n      if (Bookmarks.Exists(field)) {\n        Bookmarks.Item(field).Select();\n        var width = null;\n        var height = null;\n        if (imageStyle) {\n          width = getformatValue(yozoOffice, imageStyle.width);\n          height = getformatValue(yozoOffice, imageStyle.height);\n        }\n        yozoOffice.Application.ActiveDocument.InlineShapes.AddPicture(imageUrl, false, false, null, null, width, height);\n      }\n    });\n  };\n};\nvar getformatValue = function getformatValue(webOffice, value) {\n  if (isString(value)) {\n    value.toLowerCase();\n    if (isCentimeter(value)) {\n      value = value.replace('cm', '');\n      return convert2Centimeter(webOffice, value);\n    } else if (isPX(value)) {\n      value = value.replace('px', '');\n      return convert2Int(value);\n    }\n    return value;\n  }\n  return value;\n};\nvar convert2Int = function convert2Int(value) {\n  return parseInt(value);\n};\nvar isString = function isString(value) {\n  return typeof value === 'string';\n};\nvar isCentimeter = function isCentimeter(value) {\n  return value.endsWith('cm');\n};\nvar isPX = function isPX(value) {\n  return value.endsWith('px');\n};\nvar convert2Centimeter = function convert2Centimeter(yozoOffice, value) {\n  return yozoOffice.ActiveDocument.CentimetersToPoints(value);\n};\n\n// spyApi.doPostActions('', 'InvokeControlMethod',\n// [{\n//   args: [\n//     { data: { fontSize: 36, fontFamily: '宋体', left: '200px', top: '200px', fontColor: '#c0c0c0', rotation: 0, text: '樣本1', transparency: 0 }, event: 'addTextMark' }],\n//   key: 'webofficeap',\n//   methodname: 'webOfficeAction'\n// }])\n// left: 值可以是“200px”也可以是“left”、“center”、“right”；top: 值可以是“200px”也可以是“top”、“center”、“bottom”；\nvar addTextMark = exports.addTextMark = function addTextMark(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice) return;\n    var doc = yozoOffice.Application.ActiveDocument;\n    var watermark = doc.Watermark;\n    watermark.Type = 2;\n    watermark.Text = data.text || '样本';\n    watermark.fontFamily = data.fontFamily || '宋体';\n    watermark.fontSize = data.fontSize || '宋体';\n    watermark.Color = HEX2Demical(data.fontColor) || 12632256;\n    watermark.Lean = 1;\n    watermark.SemTransparent = 1;\n    doc.Watermark = watermark;\n  };\n};\nvar delMark = exports.delMark = function delMark(data, props) {\n  return function (domId) {\n    yozoOffice.Application.ActiveDocument.ClearWatermark();\n  };\n};\nvar HEX2Demical = exports.HEX2Demical = function HEX2Demical(hex) {\n  // #0000FF\n  var result = 0;\n  for (var i = 0; i <= hex.length - 2; i++) {\n    var num = parseHex(hex.slice(1 + i, 2 + i));\n    result = result + num * Math.pow(16, hex.length - i - 2);\n  }\n  return result;\n};\nvar parseHex = function parseHex(letter) {\n  letter = letter.toLocaleLowerCase();\n  switch (letter) {\n    case '0':\n      return 0;\n    case '1':\n      return 1;\n    case '2':\n      return 2;\n    case '3':\n      return 3;\n    case '4':\n      return 4;\n    case '5':\n      return 5;\n    case '6':\n      return 6;\n    case '7':\n      return 7;\n    case '8':\n      return 8;\n    case '9':\n      return 9;\n    case 'a':\n      return 10;\n    case 'b':\n      return 11;\n    case 'c':\n      return 12;\n    case 'd':\n      return 13;\n    case 'e':\n      return 14;\n    case 'f':\n      return 15;\n  }\n};\n\n/**\n * 通用指令，用于后端自行传入方法调用 api\n * @param {object} data 后端发送的数据\n * @param {object} props\n * @param {object} yozoOffice 永中 Office\n */\nvar callEditorFunction = exports.callEditorFunction = function callEditorFunction(data, props) {\n  return function (domId) {\n    var yozoOffice = document.getElementById(domId).contentWindow.YozoOffice;\n    if (!yozoOffice || data.editorType !== _webOffice.OfficeEditMode.Yozo) return;\n    var methods = data.methods;\n    methods.forEach(function (_ref2) {\n      var params = _ref2.params,\n        func = _ref2.func,\n        id = _ref2.id;\n      var keys = func.split('.');\n      var result = yozoOffice.Application;\n      for (var i = 0; i < keys.length; i++) {\n        var currentKey = keys[i];\n        var isFunction = false;\n        var paramKey = '';\n        if (/(\\w+)\\((\\$\\d+)?\\)/.test(currentKey)) {\n          var matchRes = currentKey.match(/(\\w+)\\((\\$\\d+)?\\)/);\n          currentKey = matchRes[1];\n          paramKey = matchRes[2];\n          isFunction = true;\n        }\n        try {\n          if (isFunction) {\n            var _result;\n            result = paramKey ? (_result = result)[currentKey].apply(_result, _toConsumableArray(params[paramKey])) : result[currentKey]();\n          } else {\n            result = result[currentKey];\n          }\n        } catch (err) {\n          console.error(\"\".concat(currentKey, \"\\u8C03\\u7528\\u51FA\\u9519\"));\n        }\n      }\n      if (id && result) {\n        var _props$sendValidResul;\n        props === null || props === void 0 || (_props$sendValidResul = props.sendValidResult) === null || _props$sendValidResul === void 0 || _props$sendValidResul.call(props, [{\n          data: {\n            result: result\n          },\n          id: id,\n          type: 'getEditorResult'\n        }]);\n      }\n    });\n  };\n};\n\n//# sourceURL=webpack://bos-platform/./src/component/common/yongzhong/yozoEditorDirective.js?");

/***/ })

}]);