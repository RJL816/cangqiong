"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[9360],{609360:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(622676),n(505684),n(241872),n(743924),n(693917),n(205960),n(976896),n(846428),n(969e3),n(606200),n(534440),n(76152),n(76124),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(233696),n(323784),n(721300),n(387912),n(633768),n(513640),n(997308);var r=g(n(795520)),c=n(211152),a=n(738704),l=n(175144),i=n(218652),u=A(n(725940)),s=n(439532),f=g(n(615016)),d=A(n(212352)),p=n(325648),m=n(331428),v=n(545072),y=["accountId","className","ctrlKey","pageId","documentServerUrl","documentUrl","style","save","getToken","sendValidResult","showMessage","showNoChangeTip"];function A(e){return e&&e.__esModule?e:{default:e}}function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var l=c?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(r,a,l):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){var r;return r=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==o(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c,a,l=[],i=!0,u=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(o=c.call(n)).done)&&(l.push(o.value),l.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function O(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},c=Object.keys(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var G=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n)*n;return t};t.default=function(e){var t=e.accountId,n=e.className,o=e.ctrlKey,A=e.pageId,b=e.documentServerUrl,g=e.documentUrl,h=e.style,C=e.save,S=e.getToken,D=e.sendValidResult,R=e.showMessage,T=e.showNoChangeTip,E=(O(e,y),w((0,r.useState)(!1),2)),x=E[0],B=E[1],j=w((0,r.useState)(g),2),P=j[0],I=j[1],M=w((0,r.useState)(""),2),F=M[0],N=M[1],_=w((0,r.useState)(null),2),V=_[0],U=_[1],K=(0,r.useRef)([]),z=(0,r.useRef)(!1),L=(0,r.useRef)(!1),$=(0,r.useRef)(),W=(0,r.useRef)({}),J=(0,r.useRef)("");(0,r.useEffect)((function(){return(0,a.setControlMount)(A,"".concat(o,"_").concat(p.OnlyOfficeCtrlKey),!0),function(){(0,a.setControlMount)(A,"".concat(o,"_").concat(p.OnlyOfficeCtrlKey),!1)}}),[A,o]),(0,r.useEffect)((function(){var e=(0,a.subscribeControlMethod)(A,"".concat(o,"_").concat(p.OnlyOfficeCtrlKey),"directives",q);return function(){return e()}}),[A,o]);var H=(0,r.useCallback)((function(e){var n=(0,i.getRootPageId)()((0,c.getGlobalState)()),o=window.location,r=o.origin,a=o.pathname.replace("/index.html","").replace("/index","");return{document:{fileType:"docx",key:e,title:"",url:P,permissions:{print:!1,download:!1}},documentType:"word",editorConfig:{callbackUrl:"".concat(r).concat(a,"attachment/v1/3rd/file/onlyoffice?p=").concat(n,"&f=").concat(G(e),"&accountId=").concat(t),lang:"zh",customization:{compactHeader:!0,compactToolbar:x,feedback:!1,forcesave:!0,autosave:!0,toolbarHideFileName:!0,toolbarNoTabs:!0},user:{name:F}}}}),[x,F,P,t]);(0,r.useEffect)((function(){J.current=(0,s.createNewId)(),d.default.set(J.current,"".concat(A,"$$").concat(o))}),[A,o]),(0,r.useEffect)((function(){P&&(null==S||S(H(J.current)))}),[P]),(0,r.useEffect)((function(){var e=H(J.current);if(e.document.key&&e.document.url&&null!=V){var t=function(){var e;if(0!==K.current.length){z.current=!0;var t=null===(e=window.DocEditor)||void 0===e||null===(e=e.instances)||void 0===e?void 0:e.docxEditor.createConnector();K.current.forEach((function(e){var n=e.methodName,o=e.data,r=f[n];r&&r(t,o,{sendValidResult:D})})),K.current=[]}},n=function(){L.current=!0};return(0,u.default)("".concat(b,"web-apps/apps/api/documents/api.js"),{success:function(){$.current&&$.current.destroyEditor();var e=k(k({},H(J.current)),{},{events:{onDocumentReady:t,onDocumentStateChange:n}});V&&(e.token=V);try{$.current=new DocsAPI.DocEditor("".concat(A,"_").concat(o,"_editor"),e)}catch(e){}},error:function(){null==R||R((0,m.getLangMsg)({key:"webOffice.key0022"}))}}),function(){d.default.remove(J.current)}}}),[V]);var q=(0,r.useCallback)((function(e){if(!(void 0===e||Array.isArray(e)&&0===e.length)&&e[0].methodname===l.WEB_OFFICE_ACTION){var t,n=e[0].args[0].event,o=Array.isArray(e[0].args[0])?e[0].args[0]:e[0].args[0].data,r=null===(t=$.current)||void 0===t?void 0:t.createConnector();if("openNew"===n){var c=o.templateUrlForOnlyOffice;I(c)}else{if("setToolbars"===n){var a=o.value;return void B(!a)}if("open"===n){var i=o.url,u=o.userName,s=o.onlyOfficeDownloadUrl;I(s||i),N(u)}else if("sendIsDocChange"===n)D([{data:L.current,id:o.id,type:"isDocChange"}]);else{if("saveSuccess"===n){var d=o.url,p=o.fileKey;return void(null==C||C([k({uid:p,url:d},W.current)]))}if("save"===n){var m;W.current={name:o.name,id:o.id};var y={url:b,uid:J.current,showNotification:function(e){return R(e,v.AlertType.WARNING)},showNoChangeTip:T};return void(null===(m=f.save)||void 0===m||m.call(f,r,y))}if("getOfficeToken"===n){var A=o.token;return void U(A)}}}if(z.current&&r){var g=f[n];g&&g(r,o,{sendValidResult:D})}else K.current.push({methodName:n,data:o})}}),[b,T,R]);return r.default.createElement("div",{style:k({height:"100%"},h),className:n},r.default.createElement("div",{id:"".concat(A,"_").concat(o,"_editor")}))}},615016:function(e,t,n){n(182320),n(909112),n(697060),n(505684),n(323784),n(743924),n(693917),n(976896),n(721300),n(606200),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.addCommentDialog=function(){},t.addMark=function(e,t){Asc.scope.bookmark=t,e.callCommand((function(){var e=Asc.scope.bookmark,t=e.value,n=e.field,o=Api.GetDocument(),r=Api.CreateParagraph(),c=Api.CreateRun();c.AddText(t),r.AddElement(c);var a=o.Search(t);o.InsertContent([r],!0),setTimeout((function(){for(var e,r=o.Search(t),c=0;c<a.length;c++)if(a[c].Element!==r[c].Element){e=r[c];break}e||(e=r[r.length-1]),e&&e.AddBookmark(n)}),0)})),delete Asc.scope.bookmark},t.addTableColumns=function(e,t,n){Asc.scope.rows=t,e.callCommand((function(){for(var e,t=Asc.scope.rows,n=t.field,o=t.newRowsData,r=t.newRows,c=Api.GetDocument(),a=Api.GetBookmarkRange(n),l=c.GetStatistics().PageCount,i=0;i<l;i++){if(e=c.GetAllTableOnPage(i).find((function(e){return e.Select(),c.GetRangeBySelect()===a})))break}for(var u=[],s=0;s<r;s++)for(var f=0;f<o[0].length;f++)u.push({row:s+1,column:f+1,value:o[s][f]});if(e)e.AddColumn();else{var d={row:r,column:o[0].length},p=d.row,m=d.column,v=Api.GetDocument(),y=v.GetBookmarkRange(n);null==y||y.Delete();var A=Api.CreateTable(m,p);u.forEach((function(e){var t=e.value,n=e.row,o=e.column;A.GetCell(n,o).GetContent().GetElement(0).AddText(t)})),v.InsertContent([A]),A.Select(),v.GetRangeBySelect().AddBookmark(n)}})),delete Asc.scope.rows},t.addTableRows=function(e,t,n){Asc.scope.rows=t,e.callCommand((function(){for(var e,t=Asc.scope.rows,n=t.field,o=t.newRowsData,r=t.newRows,c=Api.GetDocument(),a=Api.GetBookmarkRange(n),l=c.GetStatistics().PageCount,i=0;i<l;i++){if(e=c.GetAllTableOnPage(i).find((function(e){return e.Select(),c.GetRangeBySelect()===a})))break}for(var u=[],s=0;s<r;s++)for(var f=0;f<o[0].length;f++)u.push({row:s+1,column:f+1,value:o[s][f]});if(e)e.AddRow();else{var d={row:r,column:o[0].length},p=d.row,m=d.column,v=Api.GetDocument(),y=v.GetBookmarkRange(n);null==y||y.Delete();var A=Api.CreateTable(m,p);u.forEach((function(e){var t=e.value,n=e.row,o=e.column;A.GetCell(n,o).GetContent().GetElement(0).AddText(t)})),v.InsertContent([A]),A.Select(),v.GetRangeBySelect().AddBookmark(n)}})),delete Asc.scope.rows},t.addTextMark=function(e,t,n){Asc.scope.mark=t,e.callCommand((function(){var e=Asc.scope.mark.text;Api.GetDocument().InsertMark(e)})),delete Asc.scope.mark},t.callEditorFunction=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(t.editorType!==r.OfficeEditMode.OnlyOffice)return;Asc.scope.customMethods=t.methods,Asc.scope.getResult=n.sendValidResult,e.callCommand((function(){var e=Api,t=Asc.scope.customMethods,n=Asc.scope.getResult;t.forEach((function(t){for(var o,r=t.params,a=t.func,l=t.id,i=a.split("."),u=0;u<i.length;u++){var s=i[u],f=!1,d="";if(/(\w+)\((\$\d+)?\)/.test(s)){var p=s.match(/(\w+)\((\$\d+)?\)/);s=p[1],d=p[2],f=!0}try{var m;if(f)e=d?(m=e)[s].apply(m,function(e){if(Array.isArray(e))return c(e)}(o=r[d])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):e[s]();else e=e[s]}catch(e){console.error("".concat(s,"调用出错"))}}l&&e&&(null==n||n([{data:{result:e},id:l,type:"getEditorResult"}]))}))}))},t.cancelSelectionEditArea=function(e,t){},t.close=function(){},t.delMark=function(e,t,n){},t.deleteMark=function(e,t){Asc.scope.bookmark=t,e.callCommand((function(){var e=Asc.scope.bookmark,t=Api.GetDocument();e.forEach((function(e){var n=e.field;t.GetBookmarkRange(n).Delete(),t.DeleteBookmark(n)}))}))},t.docCompare=function(e){},t.docProtect=function(e,t){},t.forceSave=a,t.insertPictures=function(e,t,n){var o=t.data;Asc.scope.pictures=o,e.callCommand((function(){var e=Asc.scope.pictures,t=Api.GetDocument();e.forEach((function(e){var n=e.field,o=e.imageUrl,r=Api.CreateParagraph(),c=Api.CreatePictureForm({key:n,required:!0,placeholder:"Photo",scaleFlag:"tooBig",lockAspectRatio:!0,respectBorders:!1,shiftX:50,shiftY:50});r.AddElement(c),c.SetImage(o),t.InsertContent([r],!0)}))})),delete Asc.scope.pictures},t.insertValue=function(e,t,n){Asc.scope.value=t,e.callCommand((function(){var e=Asc.scope.value,t=e.needEnterBefore,n=e.value,o=Api.GetDocument(),r=Api.CreateParagraph(),c=t?"\r\n":"";r.AddText("".concat(c).concat(n)),o.InsertContent([r],!0)})),delete Asc.scope.value},t.locateMark=function(e,t){Asc.scope.bookmark=t,e.callCommand((function(){var e=Asc.scope.bookmark.field;Api.GetDocument().GetBookmarkRange(e).Select()})),delete Asc.scope.bookmark},t.mergeDocs=function(e,t,n){},t.save=function(e,t){e.callCommand((function(){Api.Save()})),a(t.url,t.uid,t.showNotification,t.showNoChangeTip)},t.saveAsLocal=function(e,t,n){},t.sendAllCheckBox=function(e,t,n){Asc.scope.checkbox=t,Asc.scope.resultCb=n.sendValidResult,e.callCommand((function(){var e,t,n=Api.GetDocument().GetAllForms(),o=[];n.forEach((function(e){"checkBoxForm"===e.GetFormType()&&o.push({id:e.GetFormKey(),value:e.IsChecked(),title:e.GetText()})}));var r=Asc.scope.checkbox.id;null===(e=(t=Asc.scope).resultCb)||void 0===e||e.call(t,[{data:n,id:r,type:"allCheckBox"}])})),delete Asc.scope.checkbox,delete Asc.scope.resultCb},t.sendAllField=function(e,t,n){var o=n.sendValidResult,r=t.id,c=Api.GetDocument().GetAllBookmarksNames();o([{data:c,id:r,type:"allField"}])},t.sendFieldExist=function(e,t,n){Asc.scope.bookmark=t,Asc.scope.resultCb=n.sendValidResult,e.callCommand((function(){var e,t,n=Api.GetDocument().GetAllBookmarksNames(),o=Asc.scope.bookmark,r=o.field,c=o.id,a=n.includes(r);null===(e=(t=Asc.scope).resultCb)||void 0===e||e.call(t,[{data:[a,r],id:c,type:"fieldExist"}])})),delete Asc.scope.bookmark,delete Asc.scope.resultCb},t.sendIsDocChange=void 0,t.sendIsFieldRevise=function(e,t,n){},t.sendOpenStatus=function(e,t,n){var o,r=t.id;null===(o=n.sendValidResult)||void 0===o||o.call(n,[{data:!0,id:r,type:"openStatus"}])},t.sendTextByField=function(e,t,n){Asc.scope.field=t,Asc.scope.resultCb=n.sendValidResult,e.callCommand((function(){var e,t,n=Asc.scope.field,o=n.field,r=n.id,c=Api.GetDocument().GetBookmarkRange(o),a=(null==c?void 0:c.GetText())||"";null===(e=(t=Asc.scope).resultCb)||void 0===e||e.call(t,[{data:{result:a,field:o},id:r,type:"getTextByField"}])})),delete Asc.scope.field,delete Asc.scope.resultCb},t.setCaption=function(e,t){},t.setCheckBoxValue=function(e,t,n){Asc.scope.checkbox=t.data,e.callCommand((function(){var e=Api.GetDocument().GetAllForms().filter((function(e){return"checkBoxForm"===e.GetFormType()}));Asc.scope.checkbox.forEach((function(t){var n=e.find((function(e){return e.GetFormKey()===t.id}));null==n||n.SetChecked(t.value)}))})),delete Asc.scope.checkbox},t.setDocAsField=function(e,t,n){},t.setDocLimit=function(e,t){},t.setDocLimitByRole=function(e,t,n){},t.setDocUnLimit=function(e,t){},t.setDocUnLimitByRole=function(e,t,n){},t.setDynamicTable=function(e,t,n){Asc.scope.dynamicTable=t,e.callCommand((function(){var e=Asc.scope.dynamicTable,t=e.tableSize,n=e.field,o=e.tableData,r=t.row,c=t.column,a=Api.GetDocument(),l=a.GetBookmarkRange(n);null==l||l.Delete();var i=Api.CreateTable(c,r);o.forEach((function(e){var t=e.value,n=e.row,o=e.column;i.GetCell(n,o).GetContent().GetElement(0).AddText(t)})),a.InsertContent([i]),i.Select(),a.GetRangeBySelect().AddBookmark(n)})),delete Asc.scope.dynamicTable},t.setMenubar=function(e,t){},t.setSelectionAsField=function(e,t,n){Asc.scope.checkbox=t,e.callCommand((function(){var e=Api.GetDocument().GetRangeBySelect(),t=Asc.scope.checkbox.field;e.addMark(t)})),delete Asc.scope.checkbox},t.setSelectionEditArea=function(e,t){},t.setTextAsTitle=function(e,t,n){Asc.scope.text=t,Asc.scope.getFontSize=function(e){return"标题 1"===e?20:"标题 2"===e?17:"标题 3"===e?15:"标题 4"===e?13:"标题 5"===e?12:"标题 6"===e||"标题 7"===e||"标题 8"===e?11:"标题 9"===e?10.5:11},e.callCommand((function(){var e=Asc.scope.text,t=e.field,n=e.style,o=Api.GetDocument();if(o.GetAllBookmarksNames().includes(t)){var r=o.GetBookmarkRange(t),c=Asc.scope.getFontSize(n);null==r||r.SetFontSize(c)}})),delete Asc.scope.text,delete Asc.scope.getFontSize},t.setTitlebar=function(e,t){},t.setTrackingMode=function(e,t,n){},t.showTracesByRole=function(e,t,n){},t.toggleShowTraces=function(e,t,n){},n(9692),n(622676),n(305092),n(233696),n(443616),n(387912),n(497448),n(633768),n(660824),n(218080),n(997308),n(86744);var o=n(331428),r=n(325648);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function a(e,t,n,r){var c={method:"post",body:JSON.stringify({c:"forcesave",key:t}),mode:"cors",credentials:"same-origin"};window.fetch("".concat(e,"coauthoring/CommandService.ashx"),c).then((function(e){return e.json()})).then((function(e){4===e.error&&r?n((0,o.getLangMsg)({key:"webOffice.key0021"})):0!==e.error&&console.error("保存失败: ".concat(e.error))})).catch((function(e){n(e)}))}t.sendIsDocChange=function(e,t,n){(0,n.sendValidResult)([{data:!0,id:t.id,type:"isDocChange"}])}}}]);