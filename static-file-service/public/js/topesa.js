/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[9056],{

/***/ "./src/plugin/cert/topEsa/plugin.js":
/*!******************************************!*\
  !*** ./src/plugin/cert/topEsa/plugin.js ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = main;\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.index-of.js */ \"../../node_modules/core-js/modules/es.array.index-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.assign.js */ \"../../node_modules/core-js/modules/es.object.assign.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.string.match.js */ \"../../node_modules/core-js/modules/es.string.match.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nvar _global = _interopRequireWildcard(__webpack_require__(/*! @/global */ \"./src/global/index.js\"));\nvar _certService = __webpack_require__(/*! @/api/certService */ \"./src/api/certService.js\");\nvar _certConst = __webpack_require__(/*! @/constant/certConst */ \"./src/constant/certConst.js\");\nvar _dateUtil = __webpack_require__(/*! @/util/dateUtil */ \"./src/util/dateUtil.js\");\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _appModelFunction = __webpack_require__(/*! @/model/appModelFunction */ \"./src/model/appModelFunction.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction getCertName(cert) {\n  var t = cert.subject().match(/(S(?!N)|L|O(?!U)|OU|SN|CN|E)=([^=]+)(?=, |$)/g);\n  for (var i = 0; i < t.length; i++) {\n    if (t[i].indexOf('CN=') === 0) {\n      return t[i].substr(3, t[i].length);\n    }\n  }\n  return 'defaultName';\n}\nfunction main(caConfig) {\n  console.log('天威证书插件已经加载');\n  var plugin = {\n    importCert: function importCert(params, callback) {\n      var pageId = params.pageId;\n      try {\n        _certService.certService.loadCertJs(function () {\n          if (_certService.certService.topESAConfig()) {\n            _certService.certService.selectCert(pageId, function (cert, pageId) {\n              if (cert) {\n                var certInfo = {\n                  serialNumber: cert.serialNumber(),\n                  issuer: cert.issuer(),\n                  publicKey: cert.toBase64(),\n                  begin: cert.notBefore(),\n                  end: cert.notAfter(),\n                  certName: getCertName(cert)\n                };\n                var data = {\n                  success: true,\n                  data: certInfo\n                };\n                callback(data);\n              } else {\n                var callBackData = {\n                  success: false,\n                  status: _certConst.CERT_STATUS_NOCERT\n                };\n                callback(callBackData);\n              }\n              _certService.certService.closeDialog();\n            });\n          } else {\n            var callBackData = {\n              success: false,\n              status: _certConst.CERT_STATUS_NOPLGUIN\n            };\n            callback(callBackData);\n          }\n        });\n      } catch (error) {\n        var callBackData = {\n          success: false,\n          status: error.message\n        };\n        callback(callBackData);\n      }\n    },\n    signCert: function signCert(params, callback) {\n      var pageId = params.pageId,\n        serialNumber = params.serialNumber,\n        signText = params.signText,\n        clearPin = params.clearPin;\n      var encryptText = {};\n      var signStatus = true;\n      var clearStatus = clearPin === false;\n      _certService.certService.loadCertJs(function () {\n        if (_certService.certService.topESAConfig()) {\n          var cert = _certService.certService.getCurrentCert(serialNumber);\n          if (cert === null) {\n            var callBackData = {\n              success: false,\n              status: _certConst.CERT_STATUS_NOCERT\n            };\n            return callback(callBackData);\n          } else {\n            if (clearPin) {\n              clearStatus = cert && _certService.certService.clearpin(cert, pageId);\n            }\n            try {\n              var endTime = cert.notAfter();\n              var rootPageId = (0, _appModelFunction.getRootPageId)()((0, _global.getGlobalState)());\n              if ((0, _dateUtil.isDateExpired)(endTime)) {\n                var _callBackData = {\n                  success: false,\n                  status: _certConst.CERT_STATUS_EXPIRE\n                };\n                return callback(_callBackData);\n              } else if ((0, _dateUtil.isLessThan30Days)(endTime)) {\n                (0, _appModelFunction.setDataMessages)(rootPageId, {\n                  content: (0, _intlApi.getLangMsg)('cert.key0014'),\n                  type: 2,\n                  duration: 5000\n                });\n              }\n              Object.keys(signText).forEach(function (key) {\n                encryptText[key] = _certService.certService.sign(signText[key], cert);\n                if (encryptText[key] === null) {\n                  throw new Error();\n                }\n              });\n            } catch (error) {\n              signStatus = false;\n            }\n          }\n          if (clearPin === undefined) {\n            clearStatus = cert && _certService.certService.clearpin(cert, pageId);\n          }\n        } else {\n          var _callBackData2 = {\n            success: false,\n            status: _certConst.CERT_STATUS_NOPLGUIN\n          };\n          return callback(_callBackData2);\n        }\n        if (!signStatus) {\n          var _callBackData3 = {\n            success: false,\n            status: _certConst.CERT_STATUS_FAIL\n          };\n          return callback(_callBackData3);\n        }\n        if (encryptText !== null && signStatus && clearStatus) {\n          var data = {\n            success: true,\n            data: encryptText\n          };\n          callback(data);\n        } else {\n          var _callBackData4 = {\n            success: false,\n            status: _certConst.CERT_STATUS_FAIL\n          };\n          return callback(_callBackData4);\n        }\n      });\n    }\n  };\n  if (!_global[\"default\"][_global.KD_PLUGIN]) {\n    _global[\"default\"][_global.KD_PLUGIN] = {};\n  }\n  _global[\"default\"][_global.KD_PLUGIN] = Object.assign({}, _global[\"default\"][_global.KD_PLUGIN], plugin);\n}\n\n//# sourceURL=webpack://bos-platform/./src/plugin/cert/topEsa/plugin.js?");

/***/ }),

/***/ "../../node_modules/xss-filters/src/xss-filters.js":
/*!******************************************************************************************!*\
  !*** delegated ../../node_modules/xss-filters/src/xss-filters.js from dll-reference lib ***!
  \******************************************************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval("module.exports = (__webpack_require__(/*! dll-reference lib */ \"dll-reference lib\"))(8375);\n\n//# sourceURL=webpack://bos-platform/delegated_../../node_modules/xss-filters/src/xss-filters.js_from_dll-reference_lib?");

/***/ })

}]);