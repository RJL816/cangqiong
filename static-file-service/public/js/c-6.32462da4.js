"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[6636,9860],{169660:function(e,t,n){n.r(t),t.default={"QRCode-value":"ia05KmAo"}},920716:function(e,t,n){n.r(t),t.default={root:"_14usTsOp"}},461140:function(e,t,n){n.r(t),t.default={"weboffice-preview":"_1AAOhIT5","weboffice-default":"_35rpALWA"}},774688:function(e,t,n){n(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.CODE_EDIT_EDITOR_UPDATE_HINTS=t.CODE_EDIT_EDITOR_SET_HINTS=t.CODE_EDIT_EDITOR_INSERT_TEXT=void 0;t.CODE_EDIT_EDITOR_INSERT_TEXT="insertText",t.CODE_EDIT_EDITOR_SET_HINTS="setHints",t.CODE_EDIT_EDITOR_UPDATE_HINTS="updateHints"},983784:function(e,t,n){n(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.GET_CODE_EDITOR_MODULES=t.CODE_EDITOR_SEND_DEBUG_PROTOCOL=t.CODE_EDITOR_LIST_MODULE_EXPORTS=t.CODE_EDITOR_GET_GPT_CONFIG=t.CODE_EDITOR_GET_FRAGMENT_TREE=t.CODE_EDITOR_GET_FRAGMENT=t.CODE_EDITOR_GET_CONFIG=t.CODE_EDITOR_ACTION_SAVE=t.CODE_EDITOR_ACTION=void 0;t.GET_CODE_EDITOR_MODULES="requestModule",t.CODE_EDITOR_ACTION="codeEditorAction",t.CODE_EDITOR_ACTION_SAVE="saveCodeEditorCont",t.CODE_EDITOR_LIST_MODULE_EXPORTS="listModuleExports",t.CODE_EDITOR_GET_CONFIG="getCodeEditorConfig",t.CODE_EDITOR_GET_GPT_CONFIG="getCodeEditorGptConfig",t.CODE_EDITOR_SEND_DEBUG_PROTOCOL="sendCodeEditorDebugProtocol",t.CODE_EDITOR_GET_FRAGMENT_TREE="getCodeEditorFragmentTree",t.CODE_EDITOR_GET_FRAGMENT="getCodeEditorFragment"},460871:function(e,t,n){n(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.SET_CODE_EDITOR_MODULES=t.CODE_EDITOR_SET_MODULE_EXPORTS=t.CODE_EDITOR_SET_GPT_CONFIG=t.CODE_EDITOR_SET_FRAGMENT_TREE=t.CODE_EDITOR_SET_FRAGMENT=t.CODE_EDITOR_SET_CONFIG=t.CODE_EDITOR_GPT_RESPONSE=t.CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE=void 0;t.SET_CODE_EDITOR_MODULES="setCodeEditorModules",t.CODE_EDITOR_SET_CONFIG="setCodeEditorConfig",t.CODE_EDITOR_SET_GPT_CONFIG="setCodeEditorGptConfig",t.CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE="codeEditorDebugProtocolResponse",t.CODE_EDITOR_SET_FRAGMENT_TREE="setCodeEditorFragmentTree",t.CODE_EDITOR_SET_FRAGMENT="setCodeEditorFragment",t.CODE_EDITOR_SET_MODULE_EXPORTS="setModuleExports",t.CODE_EDITOR_GPT_RESPONSE="sendEditorGptData"},175144:function(e,t,n){n(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.WEB_OFFICE_ACTION=void 0;t.WEB_OFFICE_ACTION="webOfficeAction"},351588:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(387912),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.getCodeEditorConfig=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(t,o){var c=(0,a.getPost)(e.pageId)(o());r.invokeControlService(e,i.CODE_EDITOR_GET_CONFIG,n,c,t)}},t.getCodeEditorFragment=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(t,o){var c=(0,a.getPost)(e.pageId)(o());r.invokeControlService(e,i.CODE_EDITOR_GET_FRAGMENT,n,c,t)}},t.getCodeEditorFragmentTree=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(t,o){var c=(0,a.getPost)(e.pageId)(o());r.invokeControlService(e,i.CODE_EDITOR_GET_FRAGMENT_TREE,n,c,t)}},t.getCodeEditorModules=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(t,o){var c=(0,a.getPost)(e.pageId)(o());r.invokeControlService(e,i.GET_CODE_EDITOR_MODULES,n,c,t)}},t.getEditorGptConfig=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(t,o){var c=(0,a.getPost)(e.pageId)(o());r.invokeControlService(e,i.CODE_EDITOR_GET_GPT_CONFIG,n,c,t)}},t.getEditorGptData=function(e,t,n,o){return function(c,u){var l=(0,a.getPost)(e.pageId)(u()),s=[t,{content:n,cid:o}];r.invokeControlService(e,i.CODE_EDITOR_ACTION,s,l,c)}},t.listModuleExports=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(t,o){var c=(0,a.getPost)(e.pageId)(o()),u=[i.CODE_EDITOR_LIST_MODULE_EXPORTS].concat(n);r.invokeControlService(e,i.CODE_EDITOR_ACTION,u,c,t)}},t.sendCodeEditorDebugProtocol=function(e,t){return function(n,o){var c=(0,a.getPost)(e.pageId)(o()),u=[t];r.invokeControlService(e,i.CODE_EDITOR_SEND_DEBUG_PROTOCOL,u,c,n)}},t.triggerSaveShortCut=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isDebugSave:!1};return function(n,o){var c=(0,a.getPost)(e.pageId)(o()),u=[i.CODE_EDITOR_ACTION_SAVE,t];r.invokeControlService(e,i.CODE_EDITOR_ACTION,u,c,n)}},n(9692);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(r,a,u):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(244144)),i=n(983784),a=n(218652);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}},651264:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(387912),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.beforeClose=void 0,t.getOfficeToken=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n,o){var u=(0,i.makeAjaxKey)(e.pageId,e.key,"getOfficeToken");r.disableDisposeAction(u),a.invokeControlService(e,"getOfficeToken",t,(0,c.getPost)(e.pageId)(o()),n),r.allowDisposeAction(u)}},t.sendValiResult=t.save=void 0;var r=l(n(600192)),i=n(497168),a=l(n(251536)),c=n(218652);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}t.save=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n,o){var u=(0,i.makeAjaxKey)(e.pageId,e.key,"upload");r.disableDisposeAction(u),a.invokeControlService(e,"upload",t,(0,c.getPost)(e.pageId)(o()),n),r.allowDisposeAction(u)}},t.sendValiResult=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n,o){var u=(0,i.makeAjaxKey)(e.pageId,e.key,"reportData");r.disableDisposeAction(u),a.invokeControlService(e,"reportData",t,(0,c.getPost)(e.pageId)(o()),n),r.allowDisposeAction(u)}},t.beforeClose=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n,o){a.invokeControlService(e,"afterClose",t,(0,c.getPost)(e.pageId)(o()),n)}}},598460:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(505684),n(743924),n(693917),n(976896),n(297336),n(721300),n(336368),n(606200),n(534440),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.themeMap=t.ChangeThemeWrap=void 0,n(305092),n(323784),n(387912);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var u=a?Object.getOwnPropertyDescriptor(e,c):null;u&&(u.get||u.set)?Object.defineProperty(r,c,u):r[c]=e[c]}return r.default=e,n&&n.set(e,r),r}(n(795520));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var s=t.themeMap={dark:"dark",light:"light"};t.ChangeThemeWrap=function(e){return function(t){var n,o=document.documentElement,i=c((0,r.useState)((null==o||null===(n=o.dataset)||void 0===n?void 0:n.darkreaderScheme)===s.dark?s.dark:s.light),2),l=i[0],f=i[1];return(0,r.useEffect)((function(){var e=new window.MutationObserver((function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(e);try{for(n.s();!(t=n.n()).done;){var o;if("attributes"===t.value.type)(null===(o=e.find((function(e){return"data-darkreader-scheme"===e.attributeName})).target)||void 0===o||null===(o=o.dataset)||void 0===o?void 0:o.darkreaderScheme)===s.dark?f(s.dark):f(s.light)}}catch(e){n.e(e)}finally{n.f()}}));return e.observe(o,{attributeFilter:["data-darkreader-scheme"],attributes:!0}),function(){e.disconnect()}}),[]),r.default.createElement(e,a({},t,{theme:l}))}}},431904:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(743924),n(205960),n(297336),n(846428),n(708896),n(606200),n(670864),n(880920),n(836887),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(233696),n(336368),n(387912),n(997308);var r,i,a=v(n(795520)),c=v(n(671252)),u=v(n(438284)),l=n(439532),s=v(n(329132)),f=v(n(348896)),p=v(n(385384)),d=n(738704);function v(e){return e&&e.__esModule?e:{default:e}}function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},m.apply(this,arguments)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,g(o.key),o)}}function g(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function b(e,t,n){return t=E(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,n||[],E(e).constructor):t.apply(e,n))}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}var O=(r=(0,f.default)(!0),(0,p.default)(i=r(i=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=b(this,t,[].concat(o))).invokeControlMethods=function(t){t.forEach((function(t){var n=t.methodname,o=t.args;if("play"===n)e._audioInstance?!1!==o[0]?e._audioInstance.play&&e._audioInstance.play():e._audioInstance.pause&&e._audioInstance.pause():console.warn("audio instance is undefined, invoke play method fail.");else"".concat(n," is not been implemented")}))},e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(t,e),n=t,(o=[{key:"setRef",value:function(e){this._audioInstance=e}},{key:"componentDidMount",value:function(){var e=this,t=this.props.model,n=t.pageId,o=t.key;void 0!==n&&void 0!==o&&(this.removeDirectivesListener=(0,d.subscribeControlMethod)(n,o,"directives",(function(t){void 0!==t&&e.invokeControlMethods(t)})))}},{key:"componentWillUnmount",value:function(){this.removeDirectivesListener&&this.removeDirectivesListener(),this._audioInstance=null}},{key:"render",value:function(){var e=this,t=this.props.model,n=Object.assign({},(0,l.getCommonStyle)(t),this.props.style),o=(0,l.getCommonClass)(t),r=o.Grow,i=o.Shrink,f=o.AlignSelf,p=(0,l.getComponentDataProperty)(t,"src","src",!1),d=(0,l.getComponentDataProperty)(t,"autoPlay","autoPlay",!1),v=(0,c.default)({},(0,s.default)({Grow:r,Shrink:i,AlignSelf:f}));return a.default.createElement(u.default,m({ref:function(t){return e.setRef(t)},className:v,style:n,id:t.key,src:p,autoPlay:d},this.props.attachData))}}])&&y(n.prototype,o),r&&y(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(a.default.Component))||i)||i);t.default=O},80952:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(743924),n(205960),n(297336),n(846428),n(708896),n(606200),n(670864),n(880920),n(836887),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(233696),n(387912),n(997308);var r,i,a=d(n(795520)),c=d(n(348896)),u=d(n(385384)),l=d(n(937344)),s=n(601404),f=d(n(149236)),p=n(738704);function d(e){return e&&e.__esModule?e:{default:e}}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,m(o.key),o)}}function m(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function y(e,t,n){return t=b(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,n||[],b(e).constructor):t.apply(e,n))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}var E=(r=(0,c.default)(!1),(0,u.default)(i=r(i=(0,f.default)(i=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=y(this,t,[].concat(o))).invokeControlMethods=function(t){t.forEach((function(t){var n=t.methodname,o=t.args;if("request"===n){var r=e.props.dispatch,i=o[0],a=i.data,c=i.url,u=i.type,f=i.contentType,p=i.withCredentials,d=void 0===p||p;if("GET"===u)l.default.getApi(c).then((function(t){var n=e.props.model;r((0,s.afterReceiveResponse)(n,t))}));else if("json"===f){var v=a.loginfo;if(v){var m=v.split("#!");a.user=m[0],a.password=m[1]}d&&l.default.postJsonApi(c,a).then((function(t){var n=e.props.model;r((0,s.afterReceiveResponse)(n,t))})),!d&&l.default.postJsonApiWithOutCredentials(c,a).then((function(t){var n=e.props.model;r((0,s.afterReceiveResponse)(n,t))}))}else l.default.postApi(c,a).then((function(t){var n=e.props.model;r((0,s.afterReceiveResponse)(n,t))}))}else"".concat(n," is not been implemented")}))},e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=this,t=this.props.model,n=t.pageId,o=t.key;this.removeDirectivesListener=(0,p.subscribeControlMethod)(n,o,"directives",(function(t){void 0!==t&&e.invokeControlMethods(t)}))}},{key:"componentWillUnmount",value:function(){this.removeDirectivesListener&&this.removeDirectivesListener()}},{key:"render",value:function(){return a.default.createElement("div",null)}}])&&v(n.prototype,o),r&&v(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(a.default.Component))||i)||i)||i);t.default=E},625720:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(505684),n(323784),n(743924),n(693917),n(205960),n(976896),n(297336),n(846428),n(336368),n(708896),n(606200),n(670864),n(880920),n(836887),n(633768),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(622676),n(305092),n(233696),n(443616),n(835164),n(721300),n(387912),n(997308);var r,i,a,c=A(n(795520)),u=A(n(790832)),l=n(891052),s=n(211152),f=n(218652),p=A(n(747224)),d=A(n(562507)),v=A(n(621080)),m=n(439532),y=A(n(348896)),g=A(n(385384)),b=n(545072),h=n(738704),E=n(732512),S=n(774688),O=A(n(149236)),D=n(218652);function A(e){return e&&e.__esModule?e:{default:e}}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},w.apply(this,arguments)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,P(o.key),o)}}function P(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function R(e,t,n){return t=I(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,k()?Reflect.construct(t,n||[],I(e).constructor):t.apply(e,n))}function k(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}n(705568);var j=(r=(0,y.default)(!1),i=(0,p.default)(d.default),(0,g.default)(a=r(a=i(a=(0,O.default)(a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=R(this,t,[e])).getEncodeVal=function(e){var t,o=(0,D.getRootPageId)()((0,s.getGlobalState)()),r=(0,D.getFormConfig)(o)((0,s.getGlobalState)())||{};if(r.kdEncoding)t="base64"===r.kdEncoding?b.ENCRYPTION_PREFIX_BASE64+(0,E.encryptByBase64)(e):e;else{var i=n.props.model;t=(0,m.getComponentDataProperty)(i,"contentencode","contentencode",!1)?n.addPrefix((0,E.getEncodeValue)(e)):e}return t},n.state={value:e.model.getDataValue()||"",codeHints:[],dynamicHintsCodes:[],codeChanege:!1},n.prevSelection="",n.prefix=[],n.openDynamicHints=!1,n.editorRef=c.default.createRef(),n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(t,e),n=t,(o=[{key:"changeAction",value:function(e){this.setState({value:e}),e=this.getEncodeVal(e);var t=this.props.model,n=t.getMetaProperty("sendSelection")?{v:e}:e;this.props.dispatch((0,f.convertAppModelFunctionAction)((0,f.setControlPostValue)(t.pageId,t.key,n)))}},{key:"addPrefix",value:function(e){return b.ENCRYPTION_PREFIX+e}},{key:"componentDidMount",value:function(){var e=this,t=this.props.model,n=t.pageId,o=t.key;this.removeInsertHandler=(0,h.subscribeControlMethod)(n,o,"directives",(function(t){t&&e.executeMethods(t)}))}},{key:"updateHints",value:function(e){var t=this,n=this.props.model,o=n.key,r=n.pageId,i=e[0].code||[],a=e[0].dynamicHints,c=(0,h.getPageData)(r,[b.GET_HINT_PARAMS,o]),l=e[0].userInput,s={codeChanege:!this.state.codeChanege},f=[],p=this.state.codeHints.map((function(e){var t=i.find((function(t){return t.name===e.name}));return t&&f.push(t.name),u.default.merge(e,t)}));i=i.filter((function(e){return!f.includes(e.name)})),p=p.concat(i),s.codeHints=p,c&&l&&a&&(c===l&&(this.openDynamicHints=!0,s.dynamicHintsCodes=a),(0,h.setPageData)(r,[b.CACHE_HINT,o,l],a)),this.setState(s,(function(){c&&l&&c===l&&t.editorRef.current.showAutocomplete()}))}},{key:"executeMethods",value:function(e){var t=this;e.forEach((function(e){var n=e.args;switch(e.methodname){case S.CODE_EDIT_EDITOR_INSERT_TEXT:var o=_(n,1)[0];o&&t.editorRef.current&&t.editorRef.current.insertContent&&t.editorRef.current.insertContent(o);break;case S.CODE_EDIT_EDITOR_SET_HINTS:var r=n[0].code;t.prefix=n[0].prefix,t.setState({codeHints:r,codeChanege:!t.state.codeChanege});break;case S.CODE_EDIT_EDITOR_UPDATE_HINTS:t.updateHints(n)}}))}},{key:"selectAction",value:function(e){var t=this.props.model,n=t.pageId,o=t.key,r=this.state.value;r=this.getEncodeVal(r),e=this.getEncodeVal(e);var i=t.getMetaProperty("sendSelection"),a=(0,s.getGlobalState)(),c=(0,D.getContorlPost)(n)(a).get(o)?{selection:e,v:r}:{selection:e};i&&this.prevSelection!==e&&this.props.dispatch((0,f.convertAppModelFunctionAction)((0,f.setControlPostValue)(t.pageId,t.key,c))),this.prevSelection=e}},{key:"componentWillReceiveProps",value:function(e){if(this.props.model.getDataProperty(b.TIME_STAMP_FRESH)!==e.model.getDataProperty(b.TIME_STAMP_FRESH)){var t=e.model.getDataValue();this.setState({value:t})}}},{key:"render",value:function(){var e=this,t=this.props.model,n=(0,m.getCommonStyle)(t),o=this.props.getLocked(t),r=(0,m.getCommonClass)(t),i=r.Grow,a=r.Shrink,u=r.AlignSelf,s=t.getMetaProperty("fileType")||"javascript",f=t.getMetaProperty("sln"),p=t.getMetaProperty("scb"),d=t.getMetaProperty("theme")||"eclipse",y=t.getDataProperty("autoComplete"),g=t.getDataProperty("keyWords")||(0,l.Map)(),b=t.getDataProperty("realTimeGetHint"),h=(0,m.getComponentDataProperty)(t,"lineWrapping","lineWrapping",!1);return c.default.createElement(v.default,w({ref:this.editorRef,style:n,Grow:i,Shrink:a,AlignSelf:u,id:t.key,value:this.state.value,fileType:s,theme:d,isShowLineNumber:f,isShowCopyBtn:p,onChange:function(t){return e.changeAction(t)},onSelect:function(t){return e.selectAction(t)},pageId:t.pageId,isLock:o,dispatch:this.props.dispatch,realTimeGetHint:b,keyWords:g,autoComplete:y,codeChanege:this.state.codeChanege,codeHints:this.state.codeHints,dynamicHintsCodes:this.state.dynamicHintsCodes,prefix:this.prefix,openDynamicHints:this.openDynamicHints,invokeControlService:this.props.invokeControlService,lineWrapping:h},this.props.attachData))}}])&&T(n.prototype,o),r&&T(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(c.default.Component))||a)||a)||a)||a);t.default=j},343280:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(387912),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(297336),n(336368);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var u=i?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(r,a,u):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(795520)),i=n(199860),a=n(869504);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u.apply(this,arguments)}var l=function(e,t){var n=(0,a.useFederatedModule)("codeEditor","./CodeEditor").Component,o=(null==n?void 0:n.default)||null,c=(0,r.useRef)();return(0,r.useImperativeHandle)(t,(function(){var e;return{sendDebugReponse:null===(e=c.current)||void 0===e?void 0:e.sendDebugReponse}})),r.default.createElement(r.default.Suspense,{fallback:"Loading"},o?r.default.createElement(o,u({},e,{ref:c})):r.default.createElement("div",{style:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"}},r.default.createElement(i.Spin,null)))};t.default=r.default.forwardRef(l)},923656:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(622676),n(505684),n(743924),n(693917),n(205960),n(846428),n(969e3),n(606200),n(534440),n(76152),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(233696),n(443616),n(323784),n(835164),n(976896),n(721300),n(76124),n(387912),n(125048),n(660824),n(694904),n(997308);var r=A(n(795520)),i=n(211152),a=O(n(343280)),c=n(218652),u=n(732512),l=n(439532),s=n(545072),f=n(218652),p=A(n(351588)),d=n(460871),v=n(983784),m=n(439532),y=n(738704),g=O(n(472632)),b=n(654500),h=O(n(530912)),E=n(674260),S=n(868256);function O(e){return e&&e.__esModule?e:{default:e}}function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(D=function(e){return e?n:t})(e)}function A(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=D(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){var r;return r=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==o(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.default=function(e){var t=e.model,n=e.dispatch,o=t.getDataValue()||"",O=(0,r.useRef)({}),D=(0,r.useRef)(),A=(0,l.getRootFormConfig)().accountId,w=void 0===A?"":A,C=(0,r.useRef)({}),P=T((0,r.useState)(),2),R=P[0],k=P[1],I=T((0,r.useState)([]),2),M=I[0],j=I[1],F=T((0,r.useState)([]),2),N=F[0],W=F[1],B=T((0,r.useState)({scriptPaths:[],menuList:[],editEnable:!0,theme:"Dark"}),2),L=B[0],V=B[1],G=T((0,r.useState)({}),2),x=G[0],U=G[1],H=(0,r.useRef)((new Date).getTime()),K=(0,r.useRef)(0),Y=T((0,r.useState)({gptEnable:!1,codeGenTips:[]}),2),z=Y[0],X=Y[1],J=(0,r.useRef)(),$=T((0,r.useState)({locale:h.default.getCurrentLang(),localeData:h.default.getCurrentLangData()}),2),q=$[0],Q=$[1],Z=(0,r.useRef)();(0,g.default)(t);var ee=(0,l.getCommonStyle)(t),te=(0,l.getCommonClass)(t),ne=te.Grow,oe=te.Shrink,re=te.AlignSelf,ie=(0,r.useMemo)((function(){return(0,m.createActions)(p,n)}),[]),ae=function(e){e.forEach((function(e){var n=e.args;switch(e.methodname){case d.SET_CODE_EDITOR_MODULES:!function(e){var t=((null==e?void 0:e[0])||[]).map((function(e){var t=function(e){var t,n={};return(null===(t=e.split("?"))||void 0===t?void 0:t[1]).split("&").forEach((function(e){var t=e.split("="),o=null==t?void 0:t[0],r=null==t?void 0:t[1];o&&(n[o]=r)})),n}(e=e.startsWith("/")?e.substring(1):e);return{path:e,name:t.path||"",version:t.v||"1.0.0"}}));j(t)}(n);break;case d.CODE_EDITOR_GPT_RESPONSE:!function(e){var t=function(e,t,n){var o;null===(o=J.current)||void 0===o||o.call(J,e,t,n),t&&(J.current=void 0)};try{var n=(null==e?void 0:e[0])||{};if((n.cid||"")!==K.current+"")return;t(n.data||"",n.isEnd||!1,n.tips||[])}catch(e){t("",!0,[]),console.warn(e)}}(n);break;case d.CODE_EDITOR_SET_MODULE_EXPORTS:!function(e){try{var t=JSON.parse((null==e?void 0:e[0])||"{}");U(t)}catch(e){console.warn(e)}}(n);break;case d.CODE_EDITOR_SET_GPT_CONFIG:!function(e){try{var t,n=(null==e||null===(t=e[0])||void 0===t?void 0:t[0])||{};"gptEnable"in n||(n.gptEnable=!1),"codeGenTips"in n||(n.codeGenTips=[]),X(n),n.gptEnable&&V((function(e){var t=e.menuList;return t.unshift("ai"),_(_({},e),{},{menuList:t})}))}catch(e){console.warn(e)}}(n);break;case d.CODE_EDITOR_DEBUG_PROTOCOL_RESPONSE:!function(e){try{var t,n,o=null==e?void 0:e[0];O.current[o.cid]?(O.current[o.cid](o),delete O.current[o.cid]):null===(t=D.current)||void 0===t||null===(n=t.sendDebugReponse)||void 0===n||n.call(t,o)}catch(e){console.warn(e)}}(n);break;case d.CODE_EDITOR_SET_CONFIG:!function(e){try{var n,o=(null==e||null===(n=e[0])||void 0===n?void 0:n[0])||{};V((function(e){var n=e.menuList,r=o.scriptPath,i=void 0===r?"":r,a=o.debugEnable,c=void 0!==a&&a,u=o.editEnable,l=void 0===u||u,s=o.codeDemoEnable,f=void 0!==s&&s,p=o.theme,d=void 0===p?"Dark":p;return"string"!=typeof i&&(i=""),"boolean"!=typeof c&&(c=!1),"boolean"!=typeof f&&(f=!1),"boolean"!=typeof l&&(l=!0),["Dark","Light"].includes(d)||(d="Dark"),c&&n.push("debug"),f&&(n.push("fragment"),ie.getCodeEditorFragmentTree(t)),{editEnable:l,theme:d,menuList:n,scriptPaths:[i=i.endsWith(".ts")?i.substring(0,i.length-3):i]}}))}catch(e){console.warn(e)}}(n);break;case d.CODE_EDITOR_SET_FRAGMENT_TREE:!function(e){try{var t=(null==e?void 0:e[0])||[];if(!Array.isArray(t))return;W(t)}catch(e){console.warn(e)}}(n);break;case d.CODE_EDITOR_SET_FRAGMENT:!function(e){var t,n,o=(null==e?void 0:e[0].id)||"",r=(null==e?void 0:e[0].data)||"";o&&(null===(t=(n=C.current)[o])||void 0===t||t.call(n,r),delete C.current[o])}(n)}}))},ce=function(e){var t,n=e.value;e.args;[b.AJAX_ERROR].includes(n)&&J.current&&(null===(t=J.current)||void 0===t||t.call(J,"",!0),J.current=void 0)},ue=(0,r.useCallback)((function(){var e,t,n=(0,E.getData)(S.KEY_SYSTEM_PARAM)||{};k({name:(null==n||null===(e=n.portalUserInfo)||void 0===e?void 0:e.name)||"",photo:(null==n||null===(t=n.portalUserInfo)||void 0===t?void 0:t.photo)||""})}),[]);(0,r.useEffect)((function(){return(0,E.setData)(S.KEY_TRAYMENU,!1),e=(0,E.addDataChangeListener)(S.KEY_RELOAD_ROOT_PAGE,(function(){Q({locale:h.default.getCurrentLang(),localeData:h.default.getCurrentLangData()})})),t=(0,E.addDataChangeListener)(S.KEY_USE_DEFAULT_LANGUAGE,(function(e){var t=e.locale,n=e.localeData;Q({locale:t,localeData:n})})),function(){e(),t()};var e,t}),[]),(0,r.useEffect)((function(){var e=t.pageId,n=t.key;return(0,y.subscribeControlMethod)(e,n,"directives",(function(e){e&&ae(e)}))}),[]),(0,r.useEffect)((function(){ie.getCodeEditorModules(t,{modules:t.getMetaProperty("modules")}),ie.listModuleExports(t,{modules:t.getMetaProperty("modules")}),ie.getEditorGptConfig(t),ie.getCodeEditorConfig(t),ue()}),[]),(0,r.useEffect)((function(){var e=t.pageId,n=t.key;return(0,b.addAjaxStateListener)(e,n,v.CODE_EDITOR_ACTION,ce)}),[t]);(0,r.useEffect)((function(){var e;null===(e=Z.current)||void 0===e||e.call(Z)}),[t]);var le=(0,r.useCallback)((function(e){if(L.editEnable&&"s"===e.key&&(e.metaKey||e.ctrlKey)){e.preventDefault();var n=e.target,o=document.activeElement;"INPUT"===n.nodeName?(o.blur(),Z.current=function(){ie.triggerSaveShortCut(t),o.focus(),Z.current=void 0}):ie.triggerSaveShortCut(t)}}),[t,ie,L.editEnable]);(0,r.useEffect)((function(){return document.addEventListener("keydown",le),function(){document.removeEventListener("keydown",le)}}),[le]);var se=(0,r.useCallback)((function(e,n){var o="".concat(t.pageId,"_").concat(t.key,"_").concat(H.current);O.current[e.cid]=n,ie.sendCodeEditorDebugProtocol(t,_({debugId:o},e))}),[t.pageId,t.key]),fe=(0,r.useCallback)((function(e,n){O.current[0]=function(o){var r;null!=o&&null!==(r=o.error)&&void 0!==r&&r.code?n(_(_({},e),{},{debugId:"".concat(t.pageId,"_").concat(t.key,"_").concat(H.current),error:null==o?void 0:o.error})):se(e,n)},ie.triggerSaveShortCut(t,{debugId:H.current,isDebugSave:!0,cid:"0",method:"Debugger.beforePrepare"})}),[t,pe]),pe=(0,r.useCallback)((function(e,t){"1"===e.cid?(H.current=(new Date).getTime(),L.editEnable?fe(e,t):se(e,t)):se(e,t)}),[se,fe,L.editEnable]),de=(0,r.useCallback)((function(e,n){ie.getCodeEditorFragment(t,e),C.current[e]=n}),[]);return r.default.createElement(a.default,{value:o,onChange:function(e){e=function(e){var n,o=(0,c.getRootPageId)()((0,i.getGlobalState)()),r=(0,c.getFormConfig)(o)((0,i.getGlobalState)())||{};return n=r.kdEncoding?"base64"===r.kdEncoding&&u.encryptByBase64?s.ENCRYPTION_PREFIX_BASE64+(0,u.encryptByBase64)(e):e:(0,l.getComponentDataProperty)(t,"contentencode","contentencode",!1)?s.ENCRYPTION_PREFIX+(0,u.getEncodeValue)(e):e,n}(e);var o=t.getMetaProperty("sendSelection")?{v:e}:e;n((0,f.convertAppModelFunctionAction)((0,f.setControlPostValue)(t.pageId,t.key,o)))},style:ee,ref:D,modulesDBSuffix:w,modulesPath:M,userInfo:R,onAIActionSend:function(e){var n=e.ability,o=e.value,r=e.sendActionResult;"kingscript_code_stopAIAnswer"===n?J.current=void 0:(J.current=r,K.current+=1),ie.getEditorGptData(t,n,o,K.current+"")},moduleExports:x,localeConfig:q,gptConfig:z,onDebugProcotolRequest:pe,scriptPaths:L.scriptPaths,menuList:L.menuList,readOnly:!L.editEnable,codeFragmentTree:N,theme:L.theme,onGetCodeFragment:de,Grow:ne,Shrink:oe,AlignSelf:re})}},481888:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(505684),n(323784),n(743924),n(693917),n(205960),n(976896),n(297336),n(721300),n(846428),n(336368),n(708896),n(606200),n(670864),n(880920),n(387912),n(836887),n(633768),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(443616),n(660824);var r,i,a,c=k(n(795520)),u=k(n(671252)),l=k(n(747224)),s=k(n(562507)),f=k(n(528304)),p=k(n(857004)),d=k(n(118536)),v=n(52548),m=n(218652),y=n(439532),g=k(n(348896)),b=n(290600),h=k(n(385384)),E=k(n(149236)),S=n(331428),O=n(358524),D=n(653224),A=n(545072),w=n(868256),_=n(674260),C=n(738704),T=k(n(955800)),P=k(n(329132)),R=k(n(204872));function k(e){return e&&e.__esModule?e:{default:e}}function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},I.apply(this,arguments)}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function F(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,N(o.key),o)}}function N(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function W(e,t,n){return t=L(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,B()?Reflect.construct(t,n||[],L(e).constructor):t.apply(e,n))}function B(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(B=function(){return!!e})()}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}var G=(r=(0,g.default)(!1),i=(0,l.default)(s.default),(0,h.default)(a=r(a=i(a=(0,E.default)(a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=W(this,t,[e])).setMapConfig=function(){n.mapConfig=(0,O.getMapConfig)(),n.mapConfig.mapService===D.GaodeMap&&n.mapConfig.securityKey&&(window._AMapSecurityConfig={securityJsCode:n.mapConfig.securityKey})},n.handleDirectives=function(e){if(e&&"executeCustomEvent"===e[0].methodname){var t=e[0].args[0];n.executeCustomEvent(t)}},n.executeCustomEvent=function(e){n.mapConfig.mapService!==D.DefaultMap?e.includes("BMap")&&n.mapConfig.mapService===D.BaiduMap||e.includes("AMap")&&n.mapConfig.mapService===D.GaodeMap||e.includes("google.maps")&&n.mapConfig.mapService===D.GoogleMap?n.setState({code:e}):n.showMessage((0,S.getLangMsg)("MapBase.key0012")):n.showMessage((0,S.getLangMsg)("MapBase.key0011"))},n.selectPoint=function(e,t){var o=n.props,r=o.model,i=o.dispatch,a=(0,y.getComponentDataProperty)(r,"coordSys","coordSys");if("gcj02"===(null==t?void 0:t.from)&&"bd09ll"===(null==t?void 0:t.to)&&a!==(null==t?void 0:t.from)){var c=e.latitude,u=e.longitude,l=M((0,O.gcj02ToBD09)(u,c),2),s=l[0],f=l[1];e.latitude=f,e.longitude=s}i((0,v.selectPoint)(r,e))},n.showMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.AlertType.WARNING;(0,m.setDataMessages)(n.props.model.pageId,{type:t,content:e,duration:3e3})},n.state={code:""},n.setMapConfig(),n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=this;this.removeSystemParamListener=(0,_.addDataChangeListener)(w.KEY_SYSTEM_PARAM,(function(t){var n;(null===(n=t.mapServiceConfiguration)||void 0===n?void 0:n.mapService)!==e.mapConfig.mapService&&(e.setMapConfig(),e.forceUpdate())}));var t=this.props.model,n=t.pageId,o=t.key;this.removeDirectivesListener=(0,C.subscribeControlMethod)(n,o,"directives",this.handleDirectives)}},{key:"componentWillUnmount",value:function(){var e,t;null===(e=this.removeSystemParamListener)||void 0===e||e.call(this),null===(t=this.removeDirectivesListener)||void 0===t||t.call(this)}},{key:"render",value:function(){var e,t,n,o,r,i,a=this.props.model,l=(0,y.getCommonClass)(a),s=l.Grow,v=l.Shrink,m=l.AlignSelf,g=(0,y.getCommonStyle)(a),h=a.getMetaProperty(b.PLACE_HOLDER),E=(0,y.getComponentDataProperty)(a,"showSearchBox","showSearchBox",!1),A=(0,y.getComponentDataProperty)(a,"selectPoint","selectPoint",!1),w=(0,y.getComponentDataProperty)(a,"selectAddress","selectAddress",!1),_=(0,y.getComponentDataProperty)(a,"canMarkerDraggble","canMarkerDraggble",!1),C=a.getUserLocale();if((0,O.isDefaultModeWithoutKey)(this.mapConfig)){var k=(0,u.default)((o={},r=T.default.mapbase,i=!0,(r=N(r))in o?Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[r]=i,o),(0,P.default)({Grow:s,Shrink:v,AlignSelf:m}));return c.default.createElement("div",I({style:g,className:k,id:a.key,pageId:a.pageId},this.props.attachData),c.default.createElement(R.default,null))}if((null===(e=this.mapConfig)||void 0===e?void 0:e.mapService)===D.BaiduMap||"default"===(null===(t=this.mapConfig)||void 0===t?void 0:t.mapService)){var M=this.mapConfig.mapKey,j=this.mapConfig.apiKey;return c.default.createElement(f.default,I({code:this.state.code,id:a.key,pageId:a.pageId,mapKey:M,apiKey:j,style:g,showSearchBox:E,placeHolder:h,selectPoint:this.selectPoint,selPoint:A,selAddress:w,canMarkerDraggble:_,showMessage:this.showMessage,Grow:s,Shrink:v,AlignSelf:m},this.props.attachData))}return(null===(n=this.mapConfig)||void 0===n?void 0:n.mapService)===D.GoogleMap?c.default.createElement(d.default,I({code:this.state.code,address:w,id:a.key,pageId:a.pageId,dragEnable:!0,style:g,mapKey:this.mapConfig.mapKey,markerDraggable:_,placeholder:h||(0,S.getLangMsg)({key:"MapBase.key0001"}),point:A,showSearchBox:E,showMessage:this.showMessage,selectPoint:this.selectPoint,locale:C},this.props.attachData)):c.default.createElement(p.default,I({code:this.state.code,address:w,id:a.key,pageId:a.pageId,dragEnable:!0,style:g,mapKey:this.mapConfig.mapKey,markerDraggable:_,placeholder:h||(0,S.getLangMsg)({key:"MapBase.key0001"}),point:A,showSearchBox:E,showMessage:this.showMessage,selectPoint:this.selectPoint},this.props.attachData))}}])&&F(n.prototype,o),r&&F(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(c.default.Component))||a)||a)||a)||a);t.default=G},636484:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(622676),n(233696),n(743924),n(205960),n(297336),n(846428),n(336368),n(708896),n(969e3),n(606200),n(534440),n(76152),n(670864),n(76124),n(880920),n(387912),n(836887),n(78504),n(997308),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(633768);var r,i,a,c=E(n(795520)),u=E(n(845736)),l=n(439532),s=E(n(747224)),f=E(n(562507)),p=E(n(348896)),d=E(n(385384)),v=E(n(329132)),m=E(n(169660)),y=E(n(671252)),g=E(n(149236)),b=n(598460),h=n(439532);function E(e){return e&&e.__esModule?e:{default:e}}function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},S.apply(this,arguments)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_(o.key),o)}}function _(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function C(e,t,n){return t=P(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,T()?Reflect.construct(t,n||[],P(e).constructor):t.apply(e,n))}function T(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(T=function(){return!!e})()}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}var k=(r=(0,p.default)(!1),i=(0,s.default)(f.default),(0,d.default)(a=r(a=i(a=(0,g.default)(a=(0,b.ChangeThemeWrap)(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,t,arguments)}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.model,n=e.theme,o=(0,l.getComponentDataProperty)(t,"url","value",!1),r=(0,l.getComponentDataProperty)(t,"size","w",!0),i=(0,l.getCommonStyle)(t),a=t.getMetaProperty("qcs")||0,s=t.getMetaProperty("displayValue"),f=t.getMetaProperty("fs"),p=(0,l.getCommonClass)(t).AlignSelf,d=(0,y.default)(A({},m.default["QRCode-value"],!0));o&&""!==o&&/^http|https/.test(o)&&(o=(0,h.setAccountId)(o)),o||(o="QRCode is null");var g=(0,y.default)((0,v.default)({AlignSelf:p})),E=n===b.themeMap.dark?{bgColor:"#242525",fgColor:"#ffffff"}:{},O=D(D({},i),{},{color:n===b.themeMap.dark?"#fff":"#000"});return c.default.createElement("div",S({className:g,id:t.key},this.props.attachData,{style:O}),c.default.createElement(u.default,S({value:o,size:r,QrCodeStyle:a,style:O,displayValue:!1,fontSize:f},E)),s?c.default.createElement("div",{className:d},o):"")}}])&&w(n.prototype,o),r&&w(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(c.default.Component))||a)||a)||a)||a)||a);t.default=k},239568:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(743924),n(205960),n(297336),n(846428),n(708896),n(606200),n(534440),n(670864),n(880920),n(836887),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(233696),n(336368),n(76124),n(387912),n(997308);var r,i,a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(795520)),c=y(n(671252)),u=y(n(395092)),l=n(439532),s=y(n(329132)),f=y(n(348896)),p=y(n(385384)),d=y(n(149236)),v=n(984844),m=n(891052);function y(e){return e&&e.__esModule?e:{default:e}}function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},b.apply(this,arguments)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,E(o.key),o)}}function E(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function S(e,t,n){return t=D(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,O()?Reflect.construct(t,n||[],D(e).constructor):t.apply(e,n))}function O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}var w=(r=(0,f.default)(!0),(0,p.default)(i=r(i=(0,d.default)(i=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=S(this,t,[e])).setVideoConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.videoRef.current&&Object.keys(e).forEach((function(t){n.videoRef.current[t]=e[t]}))},n.videoRef=(0,a.createRef)(),n.state={config:{}},n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=(0,l.getComponentDataProperty)(this.props.model,"config","config",!1);this.setState({config:(null==e?void 0:e.toJS())||{}})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.model,n=e.model,o=(0,l.getComponentDataProperty)(t,"config","config",!1),r=(0,l.getComponentDataProperty)(n,"config","config",!1);(0,m.is)(o,r)||this.setState({config:(null==r?void 0:r.toJS())||{}})}},{key:"render",value:function(){var e=this.props.model,t=Object.assign({},(0,l.getCommonStyle)(e),this.props.style),n=(0,l.getCommonClass)(e),o=n.Grow,r=n.Shrink,i=n.AlignSelf,f=(0,l.getComponentDataProperty)(e,"src","src",!1),p=(0,v.appendParamsToUrl)(f,{model:e}),d=(0,l.getComponentDataProperty)(e,"autoPlay","autoPlay",!1),m=(0,c.default)((0,s.default)({Grow:o,Shrink:r,AlignSelf:i}));return a.default.createElement(u.default,b({ref:this.videoRef,className:m,style:t,id:e.key,src:p,autoPlay:d,config:this.state.config},this.props.attachData))}}])&&h(n.prototype,o),r&&h(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(a.default.Component))||i)||i)||i);t.default=w},731860:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(205960),n(297336),n(846428),n(336368),n(708896),n(606200),n(534440),n(670864),n(880920),n(836887),n(776512),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(443616),n(743924),n(387912),n(497448),n(660824),n(78504),n(977864);var r,i,a=P(n(795520)),c=C(n(671252)),u=n(211152),l=n(439532),s=C(n(464456)),f=C(n(348896)),p=C(n(385384)),d=C(n(329132)),v=n(218652),m=P(n(651264)),y=C(n(149236)),g=C(n(328720)),b=n(868256),h=n(674260),E=n(419008),S=n(738704),O=n(325648),D=n(545072),A=n(218652),w=n(24616),_=C(n(920716));function C(e){return e&&e.__esModule?e:{default:e}}function T(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(T=function(e){return e?n:t})(e)}function P(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=T(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},R.apply(this,arguments)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,I(o.key),o)}}function I(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function M(e,t,n){return t=F(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,j()?Reflect.construct(t,n||[],F(e).constructor):t.apply(e,n))}function j(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(j=function(){return!!e})()}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}var W=O.OfficeEditMode.WpsClient,B=O.OfficeEditMode.PublicWps,L=O.OfficeEditMode.PrivateWps,V=O.OfficeEditMode.OnlyOffice,G=O.OfficeEditMode.Yozo,x=a.default.lazy((function(){return n.e(9360).then(n.bind(n,609360))})),U=a.default.lazy((function(){return n.e(4632).then(n.bind(n,934632))})),H=a.default.lazy((function(){return Promise.all([n.e(4074),n.e(7016),n.e(7432)]).then(n.bind(n,497432))})),K=a.default.lazy((function(){return Promise.all([n.e(4074),n.e(7016),n.e(2720)]).then(n.bind(n,212720))})),Y=(r=(0,f.default)(!0),(0,p.default)(i=r(i=(0,y.default)(i=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=M(this,t)).showMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D.AlertType.ERROR;(0,A.setDataMessages)((0,A.getRootPageId)()((0,u.getGlobalState)()),[{duration:3e3,content:e,type:t}])},e.getNewKey=function(t){return e.officeEditMode===V?"".concat(t,"_").concat(O.OnlyOfficeCtrlKey):e.officeEditMode===B||e.officeEditMode===L?"".concat(t,"_").concat(O.WpsCtrlKey):e.officeEditMode===G?"".concat(t,"_").concat(O.YozoCtrlKey):void 0},e.getToken=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if([L,V].includes(e.officeEditMode)){var n=e.props.model;e.props.dispatch(m.getOfficeToken(n,[t]))}};var n=(0,l.getRootFormConfig)(),o=n.onlyofficeServerUrl,r=n.accountId,i=(0,l.getOfficeEditMode)(),a=i.officeEditMode,c=i.appId,s=void 0!==c;return e.accountId=r,e.officeEditMode=a,e.newPublicWPSAppId=s?c:"",e.onlyofficeServerUrl=o,e.withThirdEditor=[V,B,L,G].includes(e.officeEditMode),e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(t,e),n=t,o=[{key:"componentDidMount",value:function(){var e=this;if((0,h.setData)(b.KEY_TRAYMENU,!1),this.withThirdEditor){var t=this.props.model,n=t.pageId,o=t.key;this.removeDataChangeListener=(0,S.subscribeControlMethod)(n,o,"directives",(function(t){if(t){var r=e.getNewKey(o);(0,S.publishControlMethod)(n,r,"directives",(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).concat(t)}))}}))}}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.removeDataChangeListener)||void 0===e||e.call(this)}},{key:"render",value:function(){var e,t,n,o,r=this,i=this.props.model,u=(0,l.getCommonStyle)(i),f=(0,l.getCommonClass)(i),p=f.Grow,y=f.Shrink,b=(0,c.default)((t={},n=_.default.root,o=!0,(n=I(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t),(0,d.default)({Grow:p,Shrink:y})),h=i.getFormConfig(),S=i.key,O=(0,v.getDataValue)(i.pageId,i.key)(i.state)||"",A=null===(e=(0,l.getComponentDataProperty)(i,"showNoChangeTip","showNoChangeTip",!1))||void 0===e||e,C=function(e,t){return r.props.dispatch(m.sendValiResult(e,t))},T=function(e,t){return r.props.dispatch(m.save(e,t))};if(this.withThirdEditor&&(C=function(e){return function(t){return r.props.dispatch(m.sendValiResult(e,t))}},T=function(e){return function(t){return r.props.dispatch(m.save(e,t))}}),this.officeEditMode===V)return a.default.createElement(x,{accountId:this.accountId,className:b,pageId:i.pageId,ctrlKey:i.key,documentServerUrl:this.onlyofficeServerUrl,style:u,getToken:this.getToken,save:T(i),sendValidResult:C(i),showMessage:this.showMessage,showNoChangeTip:A});if(this.officeEditMode===B||this.officeEditMode===L){var P=this.newPublicWPSAppId?K:H,k=(0,w.getResponseHeader)(D.CSRF_TOKEN),M=null;return this.officeEditMode===L&&(k=null,M=this.getToken),a.default.createElement(P,{accountId:this.accountId,appId:this.newPublicWPSAppId,className:b,pageId:i.pageId,ctrlKey:i.key,token:k,save:T(i),style:u,getToken:M,sendValidResult:C(i),showNoChangeTip:A})}return this.officeEditMode===G?a.default.createElement(U,{className:b,pageId:i.pageId,ctrlKey:i.key,style:u,save:T(i),sendValidResult:C(i),showNoChangeTip:A}):(0,E.isWin)()&&this.officeEditMode!==W?a.default.createElement(s.default,R({className:b,isDesigner:!1,style:u},this.props.attachData,{model:i,objId:S,config:h},this.props,{dataProperty:O},(0,l.createActions)(m,this.props.dispatch))):a.default.createElement(g.default,{model:i,sendValidResult:C,save:T})}}],o&&k(n.prototype,o),r&&k(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(a.Component))||i)||i)||i);t.default=Y},328720:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(233696),n(323784),n(387912),n(997308);var r=l(n(795520)),i=n(738704),a=l(n(299128)),c=n(215660);n(331428);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}t.default=function(e){var t=e.model,n=e.sendValidResult,o=e.save,u=(0,r.useRef)(0),l=(0,r.useRef)([]);return(0,r.useEffect)((function(){(0,c.install)()}),[]),(0,r.useEffect)((function(){return(0,c.getWpsApiEvent)().AddApiEventListener("DocumentBeforeSave",(function(e,t,n){t||(n.Value=!0)})),function(){(0,c.getWpsApiEvent)().RemoveApiEventListener("DocumentBeforeSave")}}),[]),(0,r.useEffect)((function(){if(t){var e=t.pageId,r=t.key,c=(0,i.subscribeControlMethod)(e,r,"directives",(function(e){if(!(void 0===e||Array.isArray(e)&&0===e.length)&&"webOfficeAction"===e[0].methodname){var r=e[0].args[0].event,i=Array.isArray(e[0].args[0].data)?e[0].args[0]:e[0].args[0].data,c={sendValidResult:n,save:o};"open"===r&&0===u.current?(u.current=1,c.openSuccess=function(){u.current=2,l.current.forEach((function(e){var n=e.methodName,o=e.data;a[n](o,t,c)})),l.current=[]},c.openFailed=function(){u.current=2,l.current.forEach((function(e){var n=e.methodName,o=e.data;a[n](o,t,c)})),l.current=[]},a.open(i,t,c)):1===u.current?l.current.push({methodName:r,data:i}):a[r](i,t,c)}}));return function(){c()}}}),[t]),r.default.createElement("div",null)}},464456:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(622676),n(233696),n(743924),n(205960),n(846428),n(708896),n(969e3),n(606200),n(534440),n(76152),n(670864),n(76124),n(387912),n(836887),n(78504),n(776512),n(997308),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(323784),n(297336),n(880920),n(86744);var r=y(n(795520)),i=y(n(671252)),a=n(738704),c=n(175144),u=y(n(461140)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(243196)),s=n(331428),f=n(325648),p=n(399588),d=n(868256),v=n(674260);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function y(e){return e&&e.__esModule?e:{default:e}}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,E(o.key),o)}}function E(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function S(e,t,n){return t=D(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,O()?Reflect.construct(t,n||[],D(e).constructor):t.apply(e,n))}function O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}t.default=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=S(this,t,[].concat(o))).writePermission=function(){e.webOffice&&(e.webOffice.UserName=f.PERMISSION_INFO,e.webOffice.Authorizer=f.SUPPLIER_URL)},e.executeControlMethod=function(t){var n=null;if(!(void 0===t||Array.isArray(t)&&0===t.length)&&t[0].methodname===c.WEB_OFFICE_ACTION){var o=t[0].args[0].event,r=e.getData(t[0].args[0]),i=l[o];clearTimeout(n),n=setTimeout((function(){try{e.webOffice&&i&&i(r,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.props))(e.webOffice)}catch(e){console.warn(e)}}),0)}},e.getData=function(e){return Array.isArray(e.data)?e:e.data},e.loadCtrl=function(){return window.ActiveXObject||"ActiveXObject"in window?r.default.createElement("object",{style:{width:"100%",height:"100%"},ref:function(t){e.webOffice=t},id:e.props.objId,classID:f.CLASSID,codebase:f.CODEBASE},r.default.createElement("param",{name:"Menubar",value:"1"}),r.default.createElement("param",{name:"Titlebar",value:"1"}),r.default.createElement("param",{name:"Toolbars",value:"1"})):r.default.createElement("div",{className:u.default["weboffice-preview"]},(0,s.getLangMsg)({key:"webOffice.key0001"}))},e}var n,o,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=this;this.writePermission();var t=this.props.model;if(t){var n=t.key,o=t.pageId;this.removeDataChangeListener=(0,a.subscribeControlMethod)(o,n,"directives",this.executeControlMethod),this.webOffice&&(0,p.beforeClose)((function(){return e.props.beforeClose(t,[{key:n,pageId:o}])}),(function(){return l.isDirty(e.webOffice)})),this.webOffice&&(0,v.setData)(d.KEY_WEBOFFICE_RUNNING,!0)}}},{key:"componentWillUnmount",value:function(){this.removeDataChangeListener&&this.removeDataChangeListener(),l.close({},this)(this.webOffice),this.webOffice&&(0,v.setData)(d.KEY_WEBOFFICE_RUNNING,!1)}},{key:"render",value:function(){var e=this.props,t=e.style,n=e.className,o=(0,i.default)(b(b({},n,n),u.default["weboffice-default"],!0));return r.default.createElement("div",{style:t,className:o},this.loadCtrl())}}])&&h(n.prototype,o),m&&h(n,m),Object.defineProperty(n,"prototype",{writable:!1}),t}(r.default.Component)},243196:function(e,t,n){n(182320),n(909112),n(697060),n(505684),n(743924),n(693917),n(976896),n(606200),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.toggleShowTraces=t.showTracesByRole=t.setTrackingMode=t.setToolbars=t.setTitlebar=t.setTextAsTitle=t.setSelectionEditArea=t.setSelectionAsField=t.setMenubar=t.setDynamicTable=t.setDocUnLimitByRole=t.setDocUnLimit=t.setDocLimitByRole=t.setDocLimit=t.setDocAsField=t.setCheckBoxValue=t.setCaption=t.sendTextByField=t.sendOpenStatus=t.sendIsFieldRevise=t.sendIsDocChange=t.sendFieldExist=t.sendAllField=t.sendAllCheckBox=t.saveAsLocal=t.save=t.openNew=t.open=t.modifyMark=t.mergeDocs=t.locateMark=t.isDirty=t.insertValue=t.insertPictures=t.docProtect=t.docCompare=t.deleteMark=t.delMark=t.close=t.cancelSelectionEditArea=t.callEditorFunction=t.addTextMark=t.addTableRows=t.addTableColumns=t.addPicMark=t.addMark=t.addCommentDialog=void 0,n(9692),n(233696),n(323784),n(820444),n(721300),n(76124),n(387912),n(571176),n(633768),n(125048),n(218080),n(513640),n(997308);var o=n(439532),r=n(218652),i=n(331428),a=n(674260),c=n(868256),u=n(399588),l=n(984844),s=n(325648),f=n(545072);function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.setTitlebar=function(e,t){return function(t){t.Titlebar=e.value}},t.setToolbars=function(e,t){return function(t){t.Toolbars=e.value}},t.setMenubar=function(e,t){return function(t){t.Menubar=e.value}},t.setCaption=function(e,t){return function(t){t.Caption=e.value||(0,i.getLangMsg)({key:"webOffice.key0002"})}},t.open=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return function(n){var o=t.model,u=o.pageId,s=e.url,p=e.userName;if(s){var d=e.name&&v(e.name)||"Word.Document";try{s=(0,l.appendParamsToUrl)(s,{model:o}),n.Close(),n.Open(s,!1,d),n.SetCurrUserName(p)}catch(e){console.error("open 指令执行失败",e);var m={messageType:0,msg:(0,i.getLangMsg)({key:"webOffice.key0004"}),detail:e};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,m)}}else(0,r.setDataMessages)(u,{content:(0,i.getLangMsg)({key:"webOffice.key0003"}),type:f.AlertType.ERROR})}};var v=function(e){if("string"==typeof e){var t=e.lastIndexOf("."),n=e.length;return e.substring(t+1,n)}},m=(t.openNew=function(e,t){return function(t){var n=e.fileType||"Word.Document";t.CreateNew(n)}},t.save=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return function(n){if(n.ActiveDocument){var r=t.model,u=e.name,s=e.uploadUrl,f=e.id,p=e.isSplitRedis,d=(0,o.createNewId)(),v=(0,l.getRequestParams)(r,{name:u});try{n.HttpInit(),Object.keys(v).forEach((function(e){v[e]&&n.HttpAddPostString(e,v[e])})),p||void 0===p?n.HttpAddPostCurrFile("uid",d):(n.HttpAddPostString("uid",d),n.HttpAddPostCurrFile("name",u)),s=(0,l.appendParamsToUrl)(s);var m=n.HttpPost(s),y=JSON.parse(m)||"";if("success"===y.status){var g=[{name:u,uid:d,url:y.url,id:f}];t.save&&t.save(r,g)}else{var b={messageType:0,msg:(0,i.getLangMsg)({key:"webOffice.key0006"})};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,b)}}catch(e){console.error("save 指令执行失败",e);var h={msg:(0,i.getLangMsg)({key:"webOffice.key0006"}),detail:e};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,h)}}}},t.close=function(e,t){return function(e){e&&e.Close()}},t.insertValue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.needEnterBefore,o=e.value,r="";n&&(r="\r\n");var i=r.concat(o);t.ActiveDocument&&t.ActiveDocument.Application.Selection.Range.InsertAfter(i)}},t.addCommentDialog=function(e,t){return function(e){!function(e,t){e.ActiveDocument.Application.Selection.Comments.Add(e.ActiveDocument.Application.Selection.Range),e.ActiveDocument.Application.Selection.Comments.Item(1).Edit()}(e)}},t.docCompare=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.currentFile,o=e.compareFile,r=e.currentFileUrl,u=e.compareFileUrl;if(r||u||n||o){var l='\n        Sub AutoOpen()\n        If IsFileExists("#path#") Then\n        ActiveDocument.Compare Name:="#path#"\n        End If\n        End Sub\n        Function IsFileExists(ByVal strFileName As String) As Boolean\n            If Dir(strFileName, 16) <> Empty Then\n                IsFileExists = True\n            Else\n                IsFileExists = False\n            End If\n        End Function\n      ';try{if(t.Close(),t.Open(r,!0,"Word.Document","",""),!t.VBProject.VBComponents){var s={msg:(0,i.getLangMsg)({key:"webOffice.key0008"}),messageType:0};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,s)}var f=t.VBProject.VBComponents(1).CodeModule.CountOfLines;t.VBProject.VBComponents(1).CodeModule.DeleteLines(1,f),o=t.TempFilePath+""+o,t.DownLoadFile(u,o),l=l.replace(/#path#/g,o),t.VBProject.VBComponents(1).CodeModule.AddFromString(l);var p=t.TempFilePath+""+n;t.ActiveDocument.Saveas(p,0),t.CompareOpen(p)}catch(e){console.error((0,i.getLangMsg)({key:"webOffice.key0004"}),e);var d={messageType:0,msg:(0,i.getLangMsg)({key:"webOffice.key0009"}),detail:e};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,d)}}}},t.addMark=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.field,o=e.value;t.SetFieldValue(n,o,"::ADDMARK::")}},t.modifyMark=function(e,t){return function(t){var n=e.data;Array.isArray(n)&&n.forEach((function(e){var n=e.field,o=e.value;if(m(t,n)){var r=t.ActiveDocument.Bookmarks.Item(n).Range;r.Text=o,t.ActiveDocument.Bookmarks.Add(n,r)}}))}},t.deleteMark=function(e,t){return function(t){var n=e.data;Array.isArray(n)&&n.forEach((function(e){m(t,e.field)&&t.SetFieldValue(e.field,"","::DELMARK::")}))}},t.locateMark=function(e,t){return function(t){var n=e.field;m(t,n)&&t.SetFieldValue(n,"","::GETMARK::")}},function(e,t){return e.ActiveDocument.BookMarks.Exists(t)}),y=(t.docProtect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.isProtect,o=e.protectType,r=e.password;t.ProtectDoc(n,o,r)}},t.setDocLimit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.password;try{t.ActiveDocument.Protect(3,!1,n,!1,!1)}catch(e){console.error("setDocLimit 指令执行失败",e)}}},t.setDocUnLimit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.password;t.ActiveDocument.Application.ActiveDocument.UnProtect(n)}},t.setSelectionEditArea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.field;t.ActiveDocument.Bookmarks.Add(n,t.ActiveDocument.Application.Selection.Range),m(t,n)&&t.SetFieldValue(n,"","::GETMARK::"),t.ActiveDocument.Application.Selection.Editors.Add(-1)}},t.cancelSelectionEditArea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=e.field;t.ActiveDocument.Application.Selection.Editors(-1).Delete(),t.ActiveDocument.Bookmarks(n).Delete()}},t.setDocLimitByRole=function(e,t){return function(t){var n=e.field,o=e.password;n.forEach((function(e){var n=e;t.SetFieldValue(n,"","::GETMARK::");try{t.SetFieldValue(n,"","::GETMARK::"),""===t.GetFieldValue(n,"")&&t.SetFieldValue(n,"     ","::ADDMARK::"),t.ActiveDocument.Bookmarks(n).range.Editors.Add(-1)}catch(e){console.error("setDocLimitByRole 指令执行失败",e)}})),t.ActiveDocument.Application.ActiveDocument.Protect(3,!1,o,!1,!1)}},t.setDocUnLimitByRole=function(e,t){return function(t){e.data.forEach((function(e){var n=e.field;try{t.ActiveDocument.Bookmarks(n).range.Editors(-1).Delete()}catch(e){console.error("setDocUnLimitByRole 指令执行失败",e)}}))}},t.sendTextByField=function(e,t){return function(n){var o=t.sendValiResult,r=t.model,i=e.field,a=e.id,c=function(e,t){return e.GetFieldValue(t,"")}(n,i);o(r,[{data:{result:c,field:i},id:a,type:"getTextByField"}])}},function(e,t){return function(e,t){return b(e,t),e.ActiveDocument.Application.Selection.Range.Revisions.Count}(e,t)>0}),g=(t.sendIsFieldRevise=function(e,t){return function(n){var o=t.sendValiResult,r=t.model,i=e.field,a=e.id;o(r,[{data:{result:y(n,i),field:i},id:a,type:"isFieldRevise"}])}},t.sendFieldExist=function(e,t){return function(n){var o=t.sendValiResult,r=t.model,i=e.field,a=e.id;o(r,[{data:{result:m(n,i),field:i},id:a,type:"fieldExist"}])}},t.sendAllField=function(e,t){return function(n){var o=t.sendValiResult,r=t.model,i=function(e){for(var t=e.ActiveDocument.Bookmarks.Count,n=[],o=1;o<=t;o++)n.push(e.ActiveDocument.Bookmarks(o).Name);return n}(n);o(r,[{data:i,id:e.id,type:"allField"}])}},t.sendIsDocChange=function(e,t){return function(n){(0,t.sendValiResult)(t.model,[{data:O(n),id:e.id,type:"isDocChange"}])}},t.setTrackingMode=function(e,t){return function(t){var n=e.userName,o=e.trackType;t.SetTrackRevisions(o),t.SetCurrUserName(n)}},t.toggleShowTraces=function(e,t){return function(e){e.ActiveDocument.ActiveWindow.ToggleShowAllReviewers()}},t.showTracesByRole=function(e,t){return function(n){var o=e.userName,a=e.isShow,c=t.model.pageId;try{n.ActiveDocument.ActiveWindow.View.Reviewers(o).Visible=a}catch(e){console.error("showTracesByRole 指令执行失败",e),(0,r.setDataMessages)(c,{content:(0,i.getLangMsg)({key:"webOffice.key0011",variables:{userName:o}}),type:f.AlertType.ERROR})}}},t.setDynamicTable=function(e,t){return function(t){var n=e.tableSize,o=e.field,r=e.tableData,i=n.row,a=n.column,c=m(t,o)?t.ActiveDocument.Bookmarks.Item(o).Range:t.ActiveDocument.Application.Selection.Range;1===c.Tables.Count&&c.Tables(1).Delete();var u=t.ActiveDocument.Application.Selection.Tables.Add(c,i,a,1,2);u.AutoFormat(23,!0,!0,!0,!0,!1,!1,!0,!1,!1),g(u,r),u.Select();var l=t.ActiveDocument.Application.Selection.Range;t.ActiveDocument.Bookmarks.Add(o,l)}},function(e,t){t.forEach((function(t){e.Cell(t.row,t.column).Range.text=t.value}))}),b=function(e,t){(m(e,t)&&e.ActiveDocument.Bookmarks.Item(t).Range).Select()},h=function(e,t){return b(e,t),e.ActiveDocument.Application.Selection.Tables(1)},E=function(e){return e.Rows.Count},S=function(e){return e.Columns.Count},O=(t.addTableRows=function(e,t){return function(t){for(var n=e.field,o=e.newRowsData,r=e.newRows,i=m(t,n)?h(t,n):t.ActiveDocument.Application.Selection.Tables(1),a=function(e,t,n){for(var o=E(e),r=S(e),i=[],a=0;a<t;a++)for(var c=0;c<r;c++){var u={row:o+a+1,column:c+1,value:n[a][c]};i.push(u)}return i}(i,r,o),c=1;c<=r;c++)i.Rows.Add();g(i,a)}},t.addTableColumns=function(e,t){return function(t){for(var n=e.field,o=e.newColumnsData,r=e.newColumns,i=m(t,n)?h(t,n):t.ActiveDocument.Application.Selection.Tables(1),a=function(e,t,n){for(var o=E(e),r=S(e),i=[],a=0;a<t;a++)for(var c=0;c<o;c++){var u={row:c+1,column:r+a+1,value:n[a][c]};i.push(u)}return i}(i,r,o),c=1;c<=r;c++)i.Columns.Add();g(i,a),i.AutoFitBehavior(2)}},t.mergeDocs=function(e,t){return function(n){var o=t.model.pageId,a=e.field,c=e.mergeType,u=e.docsUrl;3===c?(b(n,a),u.forEach((function(e){n.InSertFile(e,0)}))):0===c||1===c||2===c?u.forEach((function(e){n.InSertFile(e,c)})):(0,r.setDataMessages)(o,{content:(0,i.getLangMsg)({key:"webOffice.key0012"}),type:f.AlertType.ERROR})}},t.setSelectionAsField=function(e,t){return function(t){var n=e.field,o=t.ActiveDocument.Application.Selection.Range;t.ActiveDocument.Bookmarks.Add(n,o)}},t.setDocAsField=function(e,t){return function(t){var n=e.field;t.ActiveDocument.Application.Selection.WholeStory();var o=t.ActiveDocument.Application.Selection.Range;t.ActiveDocument.Bookmarks.Add(n,o)}},t.isDirty=function(e){return e&&e.isDirty}),D=function(e){for(var t=[],n={title:"",id:""},o=e.ActiveDocument.ContentControls.Count,r=1;r<=o;r++){n={id:e.ActiveDocument.ContentControls.Item(r).ID,value:e.ActiveDocument.ContentControls.Item(r).Checked,title:e.ActiveDocument.ContentControls.Item(r).Title||(0,i.getLangMsg)({key:"webOffice.key0014"})},t.push(n)}return t},A=(t.sendAllCheckBox=function(e,t){return function(n){(0,t.sendValiResult)(t.model,[{data:D(n),id:e.id,type:"allCheckBox"}])}},t.sendOpenStatus=function(e,t){return function(n){(0,t.sendValiResult)(t.model,[{data:A(n),id:e.id,type:"openStatus"}])}},function(e){return!!e.ActiveDocument}),w=(t.setCheckBoxValue=function(e,t){return function(n){var o=t.model.pageId;e.data.forEach((function(e){var t=function(e,t){var n;return D(e).forEach((function(e,o){e.id===t&&(n=o)})),n}(n,e.id);void 0!==t?n.ActiveDocument.ContentControls.Item(t+1).Checked=e.value:(0,r.setDataMessages)(o,{content:(0,i.getLangMsg)({key:"webOffice.key0014"}),type:f.AlertType.ERROR})}))}},t.setTextAsTitle=function(e,t){return function(t){var n=e.field,o=e.style;m(t,n)&&t.SetFieldValue(n,"","::GETMARK::"),t.ActiveDocument.Application.Selection.Style=t.ActiveDocument.Styles(o)}},t.saveAsLocal=function(e,t){return function(e){e.showdialog(3)}},t.insertPictures=function(e,t){return function(t){e.data.forEach((function(e){var n=e.imageUrl,o=e.field,r=e.imageStyle;m(t,o)&&t.SetFieldValue(o,"","::GETMARK::");var i=t.ActiveDocument.Application.Selection.InlineShapes.AddPicture(n);if(r){var a=w(t,r.width),c=w(t,r.height);i.Width=a,i.Height=c}}))}},function(e,t){return C(t)?(t.toLowerCase(),T(t)?(t=t.replace("cm",""),R(e,t)):P(t)?(t=t.replace("px",""),_(t)):t):t}),_=function(e){return parseInt(e)},C=function(e){return"string"==typeof e},T=function(e){return e.endsWith("cm")},P=function(e){return e.endsWith("px")},R=function(e,t){return e.ActiveDocument.Application.CentimetersToPoints(t)};t.addTextMark=function(e,t){return function(t){var n,o=function(e,t){return null==e||"number"!=typeof e?t:e},r=e.fontSize||120,i=e.fontFamily||"宋体",l=e.text||"样本",s=o(e.rotation,0),f=o(e.transparency,0),p=(0,u.HEX2Demical)(e.fontColor)||12632256,d="string"==typeof(n=w(t,e.left))?{left:-999998,center:-999995,right:-999996}[n]||-999995:n,v=function(e){return"string"==typeof e?{top:-999999,center:-999995,bottom:-999997}[e]||-999995:e}(w(t,e.top));try{t.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count&&t.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete(),t.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=9,t.ActiveDocument.Sections(1).Headers(1).Shapes.AddTextEffect(0,l,i,r,!1,!1,0,0).Select(),t.ActiveDocument.Sections(1).Headers(1).Shapes(1).Name="PowerPlusWaterMarkObject30745",t.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0,t.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count&&t.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete(),t.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=9,t.ActiveDocument.Sections(1).Headers(1).Shapes.AddTextEffect(0,l,i,r,!1,!1,0,0).Select(),t.ActiveDocument.Sections(1).Headers(1).Shapes(1).Name="PowerPlusWaterMarkObject30745",t.ActiveDocument.Application.Selection.ShapeRange.TextEffect.NormalizedHeight=!1,t.ActiveDocument.Application.Selection.ShapeRange.Line.Visible=!1,t.ActiveDocument.Application.Selection.ShapeRange.Fill.Visible=!0,t.ActiveDocument.Application.Selection.ShapeRange.Fill.Solid(),t.ActiveDocument.Application.Selection.ShapeRange.Fill.ForeColor=p,t.ActiveDocument.Application.Selection.ShapeRange.Fill.Transparency=f,t.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.AllowOverlap=!0,t.ActiveDocument.Application.Selection.ShapeRange.Rotation=s,t.ActiveDocument.Application.Selection.ShapeRange.Left=d,t.ActiveDocument.Application.Selection.ShapeRange.Top=v,t.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio=!0,t.ActiveDocument.Application.Selection.ShapeRange.RelativeHorizontalPosition=0,t.ActiveDocument.Application.Selection.ShapeRange.RelativeVerticalPosition=0,t.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0}catch(e){console.error(e);var m={messageType:0,msg:"水印添加失败！",detail:e};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,m)}}},t.addPicMark=function(e,t){return function(t){var n=e.picUrl,o=e.washout?.85:.5,r=e.washout?.15:.5;try{t.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count&&t.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete(),t.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=9,t.ActiveDocument.Application.Selection.HeaderFooter.Shapes.AddPicture(n,!1,!0).Select(),t.ActiveDocument.Sections(1).Headers(1).Shapes(1).Name="PowerPlusWaterMarkObject30745",t.ActiveDocument.Application.Selection.ShapeRange.PictureFormat.Brightness=o,t.ActiveDocument.Application.Selection.ShapeRange.PictureFormat.Contrast=r,t.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio=!0,t.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.AllowOverlap=!0,t.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Side=3,t.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.Type=3,t.ActiveDocument.Application.Selection.ShapeRange.RelativeHorizontalPosition=0,t.ActiveDocument.Application.Selection.ShapeRange.RelativeVerticalPosition=0,t.ActiveDocument.Application.Selection.ShapeRange.Left=-999995,t.ActiveDocument.Application.Selection.ShapeRange.Top=-999995,t.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0}catch(e){console.error(e);var i={messageType:0,msg:"图片水印添加失败！",detail:e};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,i)}}},t.delMark=function(e,t){return function(e){try{e.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange.Count&&e.ActiveDocument.Sections(1).Headers(1).Range.ShapeRange(1).Delete()}catch(e){console.error(e);var t={messageType:0,msg:"水印删除失败！",detail:e};(0,a.setData)(c.KEY_SHOW_MESSAGE_EVENT,t)}}},t.callEditorFunction=function(e,t){return function(n){if(e.editorType===s.OfficeEditMode.WebOffice){var o=e.methods,r=t.sendValiResult,i=t.model;o.forEach((function(e){for(var t=e.params,o=e.func,a=e.id,c=o.split("."),u=n,l=0;l<c.length;l++){var s=c[l],f=!1,d="";if(/(\w+)\((\$\d+)?\)/.test(s)){var v=s.match(/(\w+)\((\$\d+)?\)/);s=v[1],d=v[2],f=!0}try{var m;if(f)u=d?(m=u)[s].apply(m,p(t[d])):u[s]();else u=u[s]}catch(e){console.error("".concat(s,"调用出错"))}}a&&u&&(null==r||r(i,[{data:{result:u},id:a,type:"getEditorResult"}]))}))}}}},299128:function(e,t,n){n(182320),n(909112),n(697060),n(505684),n(743924),n(693917),n(976896),n(606200),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.toggleShowTraces=t.showTracesByRole=t.setTrackingMode=t.setToolbars=t.setTitlebar=t.setTextAsTitle=t.setSelectionEditArea=t.setSelectionAsField=t.setMenubar=t.setDynamicTable=t.setDocUnLimitByRole=t.setDocUnLimit=t.setDocLimitByRole=t.setDocLimit=t.setDocAsField=t.setCheckBoxValue=t.setCaption=t.sendTextByField=t.sendOpenStatus=t.sendIsFieldRevise=t.sendIsDocChange=t.sendFieldExist=t.sendAllField=t.sendAllCheckBox=t.saveToLocal=t.saveAsLocal=t.save=t.openNew=t.open=t.modifyMark=t.mergeDocs=t.locateMark=t.insertValue=t.insertPicture=t.docProtect=t.docCompare=t.deleteMark=t.delMark=t.close=t.cancelSelectionEditArea=t.callEditorFunction=t.addTextMark=t.addTableRows=t.addTableColumns=t.addMark=t.addCommentDialog=void 0,n(9692),n(233696),n(443616),n(323784),n(721300),n(76124),n(387912),n(633768),n(660824),n(218080),n(997308),n(86744);var o=n(215660),r=n(218652),i=n(331428),a=n(984844),c=n(439532),u=n(674260),l=n(868256),s=n(545072),f=n(325648);function p(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.setTitlebar=function(){},t.setToolbars=function(){},t.setMenubar=function(){(0,o.getWpsActiveWindow)().ToggleRibbon()},t.setCaption=function(){},t.open=function(e,t,n){var c=e.url,u=e.userName,l=t.pageId;if(c){var f=(c=(0,a.appendParamsToUrl)(c,{model:t})).includes("?")?"&":"?";c="".concat(c).concat(f,"fileHeader=1"),window.Application?window.Application.Documents.OpenFromUrl(c,null==n?void 0:n.openSuccess,null==n?void 0:n.openFailed):(wps.Application.Documents.OpenFromUrl(c),setTimeout((function(){var e;null===(e=n.openSuccess)||void 0===e||e.call(n)}),1800));var p=(0,o.getWpsApplication)();p.UserName=u,p.CommandBars.SetVisibleMso("FileMenu",!1),p.CommandBars.SetVisibleMso("FileSave",!1),(0,o.handleClientClose)(),(0,o.handleTaskPaneClose)()}else(0,r.setDataMessages)(l,{content:(0,i.getLangMsg)({key:"webOffice.key0003"}),type:s.AlertType.ERROR})},t.openNew=function(){var e=(0,o.getWpsApplication)();e.Documents.Add(),e.CommandBars.SetVisibleMso("FileMenu",!1),e.CommandBars.SetVisibleMso("FileSave",!1),(0,o.handleClientClose)(),(0,o.handleTaskPaneClose)()},t.save=function(e,t,n){var r=e.id,s=e.name,f=void 0===s?"file":s,p=e.uploadUrl,d=n.save,v=new window.XMLHttpRequest;v.open("POST",(0,a.appendParamsToUrl)(p));var m=new window.FormData,g=(0,c.createNewId)(),b=(0,a.getRequestParams)(t,{name:f});Object.keys(b).forEach((function(e){b[e]&&m.append(e,b[e])}));var h=window.Application.ActiveDocument.SaveAsBinaryString();window.Application&&h?m.append("uid",(0,o.getFile)(h,f)):m.append("uid",(0,o.getFile)(y(),f)),v.onreadystatechange=function(){if(4===v.readyState){var e=JSON.parse(v.responseText);if("success"===e.status)null==d||d(t,[{name:f,uid:g,id:r,url:e.url}]);else{var n={messageType:0,msg:(0,i.getLangMsg)({key:"webOffice.key0006"})};(0,u.setData)(l.KEY_SHOW_MESSAGE_EVENT,n)}}},v.send(m)};var y=t.saveToLocal=function(){var e=wps.Env.GetTempPath()+"/wps_temp";if(!wps.FileSystem.Exists(e)&&!wps.FileSystem.Mkdir(wps.Env.GetTempPath()+"/wps_temp"))return void alert("文件路径访问失败");var t=wps.WpsApplication().ActiveDocument.Name.includes(".")?wps.WpsApplication().ActiveDocument.Name:"".concat(wps.WpsApplication().ActiveDocument.Name,".doc"),n="".concat(e,"/").concat(t);return wps.WpsApplication().ActiveDocument.SaveAs(n),wps.FileSystem.readAsBinaryString(n)},g=(t.close=function(){(0,o.getWpsActiveDocuments)().Close()},t.insertValue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.needEnterBefore,n=e.value,r="";t&&(r="\r\n");var i=r.concat(n);(0,o.getWpsApplication)().Selection.InsertBefore(i)});t.addCommentDialog=function(){var e=(0,o.getWpsActiveDocuments)().Comments,t=(0,o.getWpsApplication)().Selection.Range;e.Add(t),e.Items(1).Edit()},t.docCompare=function(e){e.currentFile,e.comapreFile;var t=e.currentFileUrl,n=e.compareFileUrl;(0,o.getWpsApplication)().Documents.OpenFromUrl(t),(0,o.getWpsActiveDocuments)().Compare(n)},t.addMark=function(e){var t=e.value,n=e.field;g({value:t}),(0,o.getWpsActiveDocuments)().Bookmarks.Add(n,(0,o.getWpsApplication)().Selection.Range),(0,o.getWpsApplication)().Selection.Collapse((0,o.getWpsEnum)().wdCollapseStart)},t.modifyMark=function(e){var t=e.data;if(Array.isArray(t)){var n=(0,o.getWpsActiveDocuments)().Bookmarks;t.forEach((function(e){var t=e.field,r=e.value;if((0,o.isBookmarkExists)(t)){var i=n.Item(t).Range;i.Text=r,n.Add(t,i)}}))}},t.deleteMark=function(e){var t=e.data,n=(0,o.getWpsActiveDocuments)().Bookmarks,r=d(t,1)[0];n.Exists(r.field)&&(n.Item(r.field).Range.Text="",n.Item(r.field).Delete())},t.locateMark=function(e){var t=e.field,n=(0,o.getWpsActiveDocuments)().Bookmarks;n.Exists(t)&&n.Item(t).Select()},t.docProtect=function(e){var t=e.password,n=e.isProtect,r=e.protectType;n?(0,o.getWpsActiveDocuments)().Protect(r,!1,t):(0,o.getWpsActiveDocuments)().Unprotect(t)},t.setDocLimit=function(e){var t=e.password;(0,o.getWpsActiveDocuments)().Protect(3,!1,t)},t.setDocUnLimit=function(e){var t=e.password;(0,o.getWpsActiveDocuments)().Unprotect(t)},t.setSelectionEditArea=function(e){var t=e.field,n=(0,o.getWpsApplication)(),r=n.ActiveDocument.Application.Selection.Range;n.ActiveDocument.Bookmarks.Add(t,r),n.ActiveDocument.Application.Selection.Editors.Add(-1)},t.cancelSelectionEditArea=function(e){var t=e.field,n=(0,o.getWpsApplication)();n.ActiveDocument.Application.Selection.Editors.Item(1).Delete(),n.ActiveDocument.Bookmarks.Item(t).Delete()},t.setDocLimitByRole=function(e){var t=e.field,n=e.password,r=(0,o.getWpsApplication)();t.forEach((function(e){var t=e.field;r.ActiveDocument.Bookmarks.Item(t).range.Editors().Add(-1)})),r.ActiveDocument.Protect(3,!1,n,!1,!1)},t.setDocUnLimitByRole=function(e){e.data.forEach((function(e){var t=e.field;(0,o.getWpsActiveDocuments)().Bookmarks.Item(t).range.Editors(-1).Delete()}))},t.sendTextByField=function(e,t,n){var r,i=e.id,a=e.field,c=n.sendValidResult,u=null===(r=(0,o.getWpsActiveDocuments)().Bookmarks.Item(a))||void 0===r||null===(r=r.Range)||void 0===r?void 0:r.Text;null==c||c(t,[{data:{result:u,field:a},id:i,type:"getTextByField"}])},t.sendIsFieldRevise=function(e,t,n){var r=e.id,i=e.field,a=n.sendValidResult;(0,o.selectBookmark)(i);var c=(0,o.getWpsActiveDocuments)().Application.Selection.Range.Revisions.Count;null==a||a(t,[{data:{result:c>0,field:i},id:r,type:"isFieldRevise"}])},t.sendFieldExist=function(e,t,n){var r=e.id,i=e.field,a=n.sendValidResult,c=(0,o.isBookmarkExists)(i);null==a||a(t,[{data:{result:c,field:i},id:r,type:"fieldExist"}])},t.sendAllField=function(e,t,n){var r=e.id,i=n.sendValidResult,a=(0,o.getAllBookmarks)();null==i||i(t,[{data:a,id:r,type:"allField"}])},t.setTrackingMode=function(e){var t=e.userName,n=e.trackType,r=(0,o.getWpsApplication)();if(r.UserName=t,4!==n){var i=1===n;r.ActiveDocument.TrackRevisions=i,r.ActiveDocument.ShowRevisions=i}else r.ActiveDocument.Revisions.AcceptAll()},t.toggleShowTraces=function(){(0,o.getWpsActiveWindow)().ToggleShowAllReviewers()},t.showTracesByRole=function(e,t){var n=e.userName,r=e.isShow,i=(0,o.getWpsActiveDocuments)().ActiveWindow.View.Reviewers.Item(n);i&&(i.Visible=r)},t.setDynamicTable=function(e){var t=e.tableSize,n=e.field,r=e.tableData,i=(0,o.getWpsApplication)(),a=i.ActiveDocument.Bookmarks,c=(0,o.isBookmarkExists)(n)?a.Item(n).Range:i.ActiveDocument.Application.Selection.Range;1===c.Tables.Count&&c.Tables.Item(1).Delete();var u=t.row,l=t.column,s=i.ActiveDocument.Application.Selection.Tables.Add(c,u,l,1,2);(0,o.setTableFormat)(s),(0,o.setTableData)(s,r),s.Select();var f=i.ActiveDocument.Application.Selection.Range;a.Add(n,f)},t.addTableRows=function(e){for(var t=e.field,n=e.newRowsData,r=e.newRows,i=(0,o.getWpsApplication)().ActiveDocument,a=(0,o.isBookmarkExists)(t)?(0,o.getTableByBookmarks)(t):i.Application.Selection.Tables.Item(1),c=(0,o.getNewRowData)(a,r,n),u=1;u<=r;u++)a.Rows.Add();(0,o.setTableData)(a,c)},t.addTableColumns=function(e){for(var t=e.field,n=e.newColumnsData,r=e.newColumns,i=(0,o.getWpsApplication)().ActiveDocument,a=(0,o.isBookmarkExists)(t)?(0,o.getTableByBookmarks)(t):i.Application.Selection.Tables.Item(1),c=(0,o.getNewRowData)(a,r,n),u=1;u<=r;u++)a.Columns.Add();(0,o.setTableData)(a,c)},t.mergeDocs=function(e){var t=e.field,n=e.mergeType,r=e.docsUrl,i=(0,o.getWpsApplication)();if(3===n){var a,c=(0,o.isBookmarkExists)(t)&&i.ActiveDocument.Bookmarks.Item(t).Range;null==c||null===(a=c.Select)||void 0===a||a.call(c),r.forEach((function(e){i.ActiveDocument.Application.Selection.InsertFile(e,0)}))}else n<3&&r.forEach((function(e){i.ActiveDocument.Application.Selection.InsertFile(e,n)}))},t.setSelectionAsField=function(e){var t=e.field,n=(0,o.getWpsApplication)(),r=n.ActiveDocument.Application.Selection.Range;n.ActiveDocument.Bookmarks.Add(t,r)},t.setDocAsField=function(e){var t=e.field,n=(0,o.getWpsApplication)().ActiveDocument;n.Application.Selection.WholeStory();var r=n.Application.Selection.Range;n.Bookmarks.Add(t,r)},t.sendIsDocChange=function(e,t,n){var o=e.id,r=n.sendValidResult;null==r||r(t,[{data:!0,id:o,type:"isDocChange"}])},t.sendAllCheckBox=function(e,t,n){var r=e.id,i=n.sendValidResult,a=(0,o.getAllContentControls)();null==i||i(t,[{data:a,id:r,type:"allCheckBox"}])},t.sendOpenStatus=function(e,t,n){var r=e.id,i=n.sendValidResult,a=(0,o.isWpsOpen)();null==i||i(t,[{data:a,id:r,type:"openStatus"}])},t.setCheckBoxValue=function(e){e.data.forEach((function(e){var t=(0,o.getCheckBoxIndexById)(e.id);-1!==t&&((0,o.getWpsActiveDocuments)().ContentControls.Item(t).Checked=e.value)}))},t.setTextAsTitle=function(e){var t=e.field,n=e.style;if((0,o.isBookmarkExists)(t)){var r=(0,o.getWpsApplication)();r.ActiveDocument.Bookmarks.Item(t).Select(),r.ActiveDocument.Application.Selection.Style=(0,o.getHeadingStyle)(n)}},t.saveAsLocal=function(){(0,o.getWpsApplication)().Dialogs.Item((0,o.getWpsEnum)().wdDialogFileSaveAs).Display()},t.insertPicture=function(e){e.data.items.forEach((function(e){var t=e.imageUrl,n=(e.field,e.imageStyle),r=(0,o.getWpsActiveDocuments)().InlineShapes.AddPicture(t);r&&n&&(r.Width=(0,o.getFormatValue)(n.width),r.Height=(0,o.getFormatValue)(n.height))}))},t.addTextMark=function(e){var t,n=function(e,t){return null==e||"number"!=typeof e?t:e},r=e.fontSize||120,i=e.fontFamily||"宋体",a=e.text||"样本",c=n(e.rotation,0),u=n(e.transparency,0),l=(0,o.HEX2Demical)(e.fontColor)||12632256,s="string"==typeof(t=(0,o.getFormatValue)(e.left))?{left:-999998,center:-999995,right:-999996}[t]||-999995:t,f=function(e){return"string"==typeof e?{top:-999999,center:-999995,bottom:-999997}[e]||-999995:e}((0,o.getFormatValue)(e.top)),p=(0,o.getWpsApplication)();try{p.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Count&&p.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Item(1).Delete(),p.ActiveWindow.ActivePane.View.SeekView=9,p.ActiveDocument.Sections.Item(1).Headers.Item(1).Shapes.AddTextEffect(0,a,i,r,!1,!1,0,0).Select(),p.ActiveDocument.Sections.Item(1).Headers.Item(1).Shapes.Item(1).Name="PowerPlusWaterMarkObject30745",p.ActiveDocument.Application.Selection.ShapeRange.TextEffect.NormalizedHeight=!1,p.ActiveDocument.Application.Selection.ShapeRange.Line.Visible=!1,p.ActiveDocument.Application.Selection.ShapeRange.Fill.Visible=!0,p.ActiveDocument.Application.Selection.ShapeRange.Fill.Solid(),p.ActiveDocument.Application.Selection.ShapeRange.Fill.ForeColor=l,p.ActiveDocument.Application.Selection.ShapeRange.Fill.Transparency=u,p.ActiveDocument.Application.Selection.ShapeRange.WrapFormat.AllowOverlap=!0,p.ActiveDocument.Application.Selection.ShapeRange.Rotation=c,p.ActiveDocument.Application.Selection.ShapeRange.Left=s,p.ActiveDocument.Application.Selection.ShapeRange.Top=f,p.ActiveDocument.Application.Selection.ShapeRange.LockAspectRatio=!0,p.ActiveDocument.Application.Selection.ShapeRange.RelativeHorizontalPosition=0,p.ActiveDocument.Application.Selection.ShapeRange.RelativeVerticalPosition=0,p.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0}catch(e){console.warn(e)}},t.delMark=function(){var e=(0,o.getWpsApplication)();e.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Count&&e.ActiveDocument.Sections.Item(1).Headers.Item(1).Range.ShapeRange.Item(1).Delete()},t.callEditorFunction=function(e,t,n){var r=n.sendValidResult;e.editorType===f.OfficeEditMode.WpsClient&&e.methods.forEach((function(e){for(var n=e.params,i=e.func,a=e.id,c=i.split("."),u=(0,o.getWpsApplication)(),l=0;l<c.length;l++){var s=c[l],f=!1,d="";if(/(\w+)\((\$\d+)?\)/.test(s)){var v=s.match(/(\w+)\((\$\d+)?\)/);s=v[1],d=v[2],f=!0}try{var m;if(f)u=d?(m=u)[s].apply(m,p(n[d])):u[s]();else u=u[s]}catch(e){console.error("".concat(s,"调用出错"))}}a&&u&&(null==r||r(t,[{data:{result:u},id:a,type:"getEditorResult"}]))}))}}}]);