(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[1891],{259299:function(e,t,r){"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}r(182320),r(909112),r(697060),r(360776),r(241872),r(743924),r(205960),r(297336),r(846428),r(708896),r(606200),r(534440),r(670864),r(76124),r(880920),r(836887),r(78504),r(776512),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(323784),r(336368),r(387912),r(497448);var n,a,u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var r=D(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}(r(795520)),i=r(891052),c=I(r(348896)),l=I(r(385384)),s=I(r(182956)),f=r(738704),d=r(439532),m=r(90920),p=I(r(706144)),y=I(r(329132)),h=r(552032),g=r(545072),v=I(r(149236)),b=r(474144),C=r(218652),O=["data","configItems","lock","lang","themeColor","themeNum","cardRowData","gridRowData","subFormsArry","themeInfo"];function I(e){return e&&e.__esModule?e:{default:e}}function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(D=function(e){return e?r:t})(e)}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},w.apply(this,arguments)}function P(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function j(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,S(o.key),o)}}function S(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function M(e,t,r){return t=k(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_()?Reflect.construct(t,r||[],k(e).constructor):t.apply(e,r))}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}var R=(n=(0,c.default)(!1),(0,l.default)(a=(0,s.default)(a=n(a=(0,v.default)(a=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=M(this,t,[e])).getCustomInfo=function(e){var t=e.pageId,o=e.key,n=e.meta&&e.meta.toJS(),a=e.getDataValue();a&&a.toJS&&(a=a.toJS());var u=(0,d.getComponentDataProperty)(e,"ci","ci",!1);u=u&&u.toJS();var c=r.props.isLocked,l=e.getUserLocale(),s=(0,m.getCurrentTheme)(),f=s.themeNum,p=s.themeColor,y=s.themeInfo,h=e.state,g=(0,d.getCustomControlSubForms)(e.pageId,e.meta.get("id"),h),v=(0,m.getCardRowData)(r.props,e),b=e.getMetaProperty(["item","schemaInfo"])||e.getMetaProperty("schemaInfo")||(0,i.Map)({});return{pageId:t,controlKey:o,data:a,metaData:n,schemaId:b.get("schemaId"),isvId:b.get("isvId"),moduleId:b.get("moduleId"),configItems:u,lock:c,lang:l,themeColor:p,themeNum:f,cardRowData:v,subFormsArry:g,fileServer:e.getFormConfig()&&e.getFormConfig().fileserver,themeInfo:y}},r.invokeCustomMethod=function(e){var t=e.pageId,o=e.key,n=r.props.dispatch;return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r=Array.isArray(r)?r:[r],n((0,h.invokeCustomMethod)(t,o,e,r,a))}},r.setPostData=function(e){var t=e.pageId,r=e.key,o="controls";return e.getMetaProperty(["item"])&&(o="fields"),function(e){"controls"===o?(0,C.setControlPostValue)(t,r,e):(0,C.setFieldPostValue)(t,r,e)}},r.state={pageLoad:(0,f.getPageData)(e.model.pageId,g.PAGE_LOAD)},r.attachDataInstance=new b.InjectAttachData,r}var r,o,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(t,e),r=t,(o=[{key:"componentDidMount",value:function(){var e=this;if(!this.state.pageLoad){var t=this.props.model.pageId;this.removePageLoadDataChangeListener=(0,f.addDataChangeListener)(t,g.PAGE_LOAD,(function(t){e.setState({pageLoad:t})}))}}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props.model,o=e.model,n=r.getDataValue(),a=o.getDataValue(),u=(0,d.getComponentDataProperty)(r,"ci","ci",!1),c=(0,d.getComponentDataProperty)(o,"ci","ci",!1),l=this.props.isLocked,s=e.isLocked,f=(0,m.getCardRowData)(this.props,r),p=(0,m.getCardRowData)(e,o),y=r.getUserLocale(),h=o.getUserLocale(),g=r.getDataProperty("subForms"),v=o.getDataProperty("subForms");return!(this.state.pageLoad===t.pageLoad&&(0,i.is)(a,n)&&(0,i.is)(u,c)&&l===s&&(0,i.is)((0,i.fromJS)(f),(0,i.fromJS)(p))&&y===h&&(0,i.is)(g,v))}},{key:"componentWillUnmount",value:function(){this.removePageLoadDataChangeListener&&this.removePageLoadDataChangeListener()}},{key:"render",value:function(){var e=this.props,t=e.model,r=e.style,o=e.attachData;if(!this.state.pageLoad)return null;var n=this.getCustomInfo(t),a=Object.assign({},(0,d.getCommonStyle)(t),r),i=(0,y.default)((0,d.getCommonClass)(t));if(!t.getMetaProperty(["item","isCustom"])&&!t.getMetaProperty("schemaInfo")){var c=n.subFormsArry.outerForms,l=void 0===c?[]:c;return u.default.createElement("div",{style:a,className:i},l.length&&u.default.Children.toArray(l))}var s=n.data,f=n.configItems,m=n.lock,h=n.lang,g=n.themeColor,v=n.themeNum,b=n.cardRowData,C=n.gridRowData,I=n.subFormsArry,D=n.themeInfo,j=P(n,O),S={data:s,configItems:f,lock:m,lang:h,themeColor:g,themeNum:v,cardRowData:b,gridRowData:C,themeInfo:D};return u.default.createElement(p.default,w({setPostData:this.setPostData(t),invokeCustomMethod:this.invokeCustomMethod(t),model:t,style:a,className:i},o,j,{outerForms:I.outerForms,innerForms:I.innerForms,customProps:S,attachDataInstance:this.attachDataInstance}))}}])&&j(r.prototype,o),n&&j(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}(u.Component))||a)||a)||a)||a);t.default=R},706144:function(e,t,r){"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}r(182320),r(909112),r(697060),r(360776),r(505684),r(241872),r(743924),r(693917),r(205960),r(976896),r(297336),r(721300),r(846428),r(336368),r(969e3),r(606200),r(534440),r(76152),r(76124),r(633768),r(690512),r(78504),r(776512),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r=e.pageId,o=e.controlKey,C=e.metaData,O=e.schemaId,I=e.isvId,w=e.moduleId,j=e.invokeCustomMethod,M=e.innerForms,A=e.outerForms,L=e.customProps,U=e.fileServer,x=e.style,F=e.className,N=e.setPostData,T=e.attachDataInstance,K=(e.model,function(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,b)),J=(0,f.default)(),W=J.themeNum,V=J.themeColor,G=S((0,n.useState)(null),2),q=G[0],B=G[1],Y=(0,n.useRef)(null),z=(0,n.useRef)(null),$=(0,n.useRef)([]),H=(0,n.useRef)(!1),Q=S((0,n.useState)(M),2),X=Q[0],Z=Q[1],ee=(0,n.useRef)(L);(0,n.useEffect)((function(){(0,a.saveModel)({schemaId:O,isvId:I,moduleId:w,pageId:r,lang:n,controlKey:o},O);var e=L.cardRowData,t=L.gridRowData,n=L.lang,i=window.KDApi.nameSpace({schemaId:O,isvId:I,moduleId:w,pageId:r,controlKey:o,lang:n})+"index.js",c=(0,a.createCustomModel)({pageId:r,controlKey:o,dom:z.current,schemaId:O,isvId:I,moduleId:w,fileServer:U,metaData:C,cardRowData:e,gridRowData:t,lang:n,invokeCustomMethod:j,setPostData:N,injectAttachData:null==T?void 0:T.setAttachData});return(0,u.getCurrentCustomComponent)(c,O,i,I).then((function(e){if(Y.current=new e(c),Y.current.update&&(v.default.warn("CustomControl[".concat(o,']: "update" is not recommended, Please use "onPropsUpdate" instead.')),k.some((function(e){return"function"==typeof Y.current[e]})))){var t=(0,y.getLangMsg)({key:"CustomCtrl.key001",variables:{name:o}});return console.error(t),void(0,h.setDataMessages)(r,{type:g.AlertType.ERROR,content:t})}B(Y.current)})).catch((function(e){})),function(){Y.current&&(0,u.executeCustomCtrlMethod)(Y.current,"destoryed")}}),[]),(0,n.useEffect)((function(){var e;try{if(q){var t,n=!0!==(0,u.executeCustomCtrlMethod)(Y.current,"init",L),a=L.cardRowData;(0,d.fireControlBizEvent)(r,o,m.CUSTOM_MSG_EVENT,{type:"__init__",rowIndex:null==a?void 0:a.rowKey}),n&&(0,u.executeCustomCtrlMethod)(Y.current,"update",L),null!==(t=z.current)&&void 0!==t&&null!==(t=t.children)&&void 0!==t&&t.length&&E(M,Z,te,H,$,re),e=(0,u.customDomObserver)(z.current,(function(e){E(M,Z,te,H,$,re)})),(0,s.getData)(l.KEY_CUSTOM_CTRL_INIT)||((0,s.setData)(l.KEY_CUSTOM_CTRL_INIT,!0),(0,s.setData)(l.KEY_UI_ACTION,{pageId:r,key:o,schemaId:O,isvId:I,moduleId:w,lang:L.lang,methodName:"KDApi.register(init)",tableName:_}))}}catch(e){}return function(){e&&e.disconnect()}}),[q]),(0,n.useEffect)((function(){try{var e=(0,u.getCurrentTheme)().themeColor;(0,u.executeCustomCtrlMethod)(Y.current,"update",P(P({},L),{},{themeColor:e,themeNum:W}))}catch(e){}}),[(0,i.fromJS)(L).hashCode(),W,V]),(0,n.useEffect)((function(){var e=ee.current,t=e.data,r=e.lock,o=e.themeInfo,n=e.cardRowData,a=e.gridRowData,i=L.data,c=L.lock,l=L.themeInfo,s=L.cardRowData,f=L.gridRowData;try{(0,u.executeCustomCtrlMethod)(Y.current,"onPropsUpdate",L),p.default.isEqual(i,t)||(0,u.executeCustomCtrlMethod)(Y.current,"onDataUpdate",i),r!==c&&(0,u.executeCustomCtrlMethod)(Y.current,"onLockUpdate",c),p.default.isEqual(l,o)||(0,u.executeCustomCtrlMethod)(Y.current,"onThemeUpdate",l),p.default.isEqual(s,n)||(0,u.executeCustomCtrlMethod)(Y.current,"onCardRowDataUpdate",s),p.default.isEqual(f,a)||(0,u.executeCustomCtrlMethod)(Y.current,"onGridRowDataUpdate",f)}catch(e){console.error(e)}ee.current=L}),[(0,i.fromJS)(L).hashCode()]),(0,n.useEffect)((function(){var e=(0,c.subscribeControlMethod)(r,o,"directives",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];H.current?re(t):null===(e=$.current)||void 0===e||e.push(t)}));return function(){e()}}),[]),(0,n.useEffect)((function(){M.length&&(te(M).length?Z(te(M)):(0,u.customDomObserver)(z.current,(function(e){Z(te(M))})))}),[(0,i.fromJS)(M).hashCode()]);var te=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(e){var t=e.elementId;return t&&document.getElementById(t)}))},re=function(e){R(e,Y,L)},oe=null==T||null===(t=T.getAttachData())||void 0===t?void 0:t.innerFormsRootElement;return n.default.createElement("div",D({ref:z,style:x,className:F},K),A.length?n.default.Children.toArray(A):null,M.length?n.default.Children.toArray((0,u.parseInnerForms)(z,X,oe)):null)},t.domChangeCallback=E,t.initCustomComponentInstance=function(e){var t=e.pageId,r=e.controlKey,o=e.schemaId,n=e.isvId,i=e.moduleId,c=e.invokeCustomMethod,l=e.fileServer,s=e.customProps.lang,f=(0,a.getCustomComponent)(o);if(f)return new Promise((function(e){e(f)}));var d=window.KDApi.nameSpace({schemaId:o,isvId:n,moduleId:i,pageId:t,controlKey:r,lang:s})+"index.js",m=(0,a.createCustomModel)({pageId:t,controlKey:r,schemaId:o,isvId:n,moduleId:i,fileServer:l,lang:s,invokeCustomMethod:c});return(0,u.getCurrentCustomComponent)(m,o,d,n)},t.subscribeCallback=R,r(622676),r(233696),r(323784),r(704180),r(387912),r(497448),r(997308);var n=I(r(795520)),a=r(474144),u=r(90920),i=r(891052),c=r(738704),l=r(868256),s=r(674260),f=C(r(569788)),d=(I(r(211152)),r(543708)),m=r(873484),p=C(r(790832)),y=r(331428),h=r(218652),g=r(545072),v=C(r(882976)),b=["pageId","controlKey","metaData","schemaId","isvId","moduleId","invokeCustomMethod","innerForms","outerForms","customProps","fileServer","style","className","setPostData","attachDataInstance","model"];function C(e){return e&&e.__esModule?e:{default:e}}function O(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(O=function(e){return e?r:t})(e)}function I(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var r=O(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},D.apply(this,arguments)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e,t,r){var n;return n=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==o(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,a,u,i=[],c=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(o=a.call(r)).done)&&(i.push(o.value),i.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(l)throw n}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var _="cusctrl_action",k=["onPropsUpdate","onLockUpdate","onThemeUpdate","onCardRowDataUpdate","onGridRowDataUpdate"];function E(e,t,r,o,n,a){e.length&&t(r(e)),o.current=!0,Array.isArray(n.current)&&n.current.length>0&&(n.current.forEach((function(e){a(e)})),n.current=[])}function R(e,t,r){Array.isArray(e)&&e.forEach((function(e){var o=e.methodname,n=e.args;o&&(0,u.executeCustomCtrlMethod)(t.current,"handleDirective",r,o,n)}))}},713116:function(e,t,r){var o={"./grid/index.js":882508,"./tree/index.js":107620};function n(e){var t=a(e);return r(t)}function a(e){if(!r.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=a,e.exports=n,n.id=713116}}]);