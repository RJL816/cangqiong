"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[7016],{764328:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(182320),n(909112),n(697060),n(9692),n(305092),n(233696),n(443616),n(241872),n(323784),n(743924),n(686456),n(835164),n(693917),n(927184),n(976896),n(297336),n(846428),n(336368),n(708896),n(606200),n(28292),n(109064),n(670864),n(76124),n(880920),n(387912),n(804092),n(497448),n(460872),n(68396),n(326884),n(633768),n(690512),n(764840),n(660824),n(78504),n(218080),n(997308),n(977864);var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a,s,c,u,l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function d(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function f(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(a||(a={})).refreshToken="api.getToken",function(e){e.unknown="unknown",e.spreadsheet="s",e.writer="w",e.presentation="p",e.pdf="f"}(s||(s={})),function(e){e.nomal="nomal",e.simple="simple",e.embed="embed"}(c||(c={})),function(e){e[e.requestFullscreen=1]="requestFullscreen",e[e.exitFullscreen=0]="exitFullscreen"}(u||(u={}));var p=window.navigator.userAgent.toLowerCase(),h=/iPhone|iPod|iPad/i.test(p);function v(e){if(!e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var m,b=function(){function e(e,t,n,r,i,o,a){var s=this;void 0===i&&(i=!0),void 0===o&&(o=!1),void 0===a&&(a={}),this.instance=e,this.instanceId=t,this.url=n,this.mount=r,this.isListenResize=i,this.addedStyles=o,this.customAttrs=a,this.handleResize=function(){var e=s.mount,t=s.mountResizeObserver,n=e.clientHeight,r=e.clientWidth;0!==n||0!==r||t?0===n&&0===r||!t||(t.disconnect(),t=null):window.ResizeObserver&&(t=new ResizeObserver((function(e){s.handleResize()}))).observe(e),s.iframe.style.cssText+="height: "+e.clientHeight+"px; width: "+e.clientWidth+"px"},this.iframe=this.initIframe()}return e.prototype.initIframe=function(){var e=this,t=this.mount,n=document.createElement("iframe");n.classList.add("web-office-iframe");var r=this.mergeAttrs({id:"office-iframe-"+this.instanceId,src:this.url,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"clipboard-read; clipboard-write"});for(var i in t?(r.style="width: "+t.clientWidth+"px; height: "+t.clientHeight+"px;",this.isListenResize&&window.addEventListener("resize",this.handleResize)):((t=document.createElement("div")).classList.add("web-office-default-container"),this.addedStyles||this.addStylesheetRules(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100vw; height: 100vh; left: 0; top: 0;}"),document.body.appendChild(t),r.style="width: 100vw; height: 100vh;"),h&&window.visualViewport&&window.visualViewport.addEventListener("resize",(function(){var t=window.visualViewport,n=t.width,r=t.height,i=document.body.clientHeight-e.iframe.clientHeight;e.instance.sendMsgToWps({eventName:"visualViewportResize",data:{width:n,height:r-i}})})),r)n.setAttribute(i,r[i]);return t.appendChild(n),n.destroy=function(){window.removeEventListener("resize",e.handleResize),n.parentNode.removeChild(n),n=null,e.mountResizeObserver&&(e.mountResizeObserver.disconnect(),e.mountResizeObserver=null)},n},e.prototype.destroy=function(){this.iframe.parentNode.removeChild(this.iframe),window.removeEventListener("resize",this.handleResize)},e.prototype.addStylesheetRules=function(e){var t=document.createElement("style");document.head.appendChild(t);var n=t.sheet;n.insertRule(e,n.cssRules.length)},e.prototype.mergeAttrs=function(e){var t=this.customAttrs;if(t&&Object.keys(t).length&&t.allow){var n=t.allow instanceof Array?t.allow:t.allow.split(";");n.unshift("clipboard-write"),n.unshift("clipboard-read"),t.allow=n.join(";"),Object.assign(e,t)}return e},e}(),g=function(){function e(){this.HANDLE_LIST=[]}return e.prototype.add=function(e){this.HANDLE_LIST.push(e),window.addEventListener("message",e,!1)},e.prototype.remove=function(e){var t=this.HANDLE_LIST.indexOf(e);t>=0&&this.HANDLE_LIST.splice(t,1),window.removeEventListener("message",e,!1)},e.prototype.empty=function(){for(;this.HANDLE_LIST.length;){var e=this.HANDLE_LIST.shift();window.removeEventListener("message",e,!1)}},e.prototype.parse=function(e){try{return"object"==r(e)?e:e?JSON.parse(e):e}catch(t){return e}},e}(),y=function(){function e(e,t){var n=this;this.collectObjIdHandlers=new Set,this.polyfillApi=["ExportAsFixedFormat","GetOperatorsInfo","ImportDataIntoFields","ReplaceText","ReplaceBookmark","GetBookmarkText","GetComments"],this.getId=function(){return""},this.setterCallbacks={idMap:{}},this.sendMsgToWps=function(){},this.objId=0,this.origin="",this.apiChannel=function(e,t,r,i){return d(n,void 0,void 0,(function(){var n,o,a,s,c,u,l,p,h,v=this;return f(this,(function(m){switch(m.label){case 0:return n=this.getId(),s=new Promise((function(e,t){o=e,a=t})),c={},t.args?[4,this.reduceArgs(t.args)]:[3,2];case 1:u=m.sent(),l=u[0],p=u[1],t.args=l,c=p,m.label=2;case 2:return e!==this.prefix+"setter"?[3,4]:[4,this.handleApiSetter(t)];case 3:m.sent(),m.label=4;case 4:return h=function(){return v.message.add((function t(s){return d(v,void 0,void 0,(function(){var u,l,d;return f(this,(function(f){switch(f.label){case 0:return this.instance.originWhiteList.includes(s.origin)||this.origin===s.origin?(u=this.message.parse(s.data)).eventName===this.prefix+"callback"&&u.callbackId&&c[u.callbackId]?[4,c[u.callbackId].apply(c,u.data.args)]:[3,2]:[2];case 1:l=f.sent(),this.sendMsgToWps({result:l,eventName:this.prefix+"callback.reply",callbackId:u.callbackId}),f.label=2;case 2:return u.eventName===e+".reply"&&u.msgId===n&&(u.error?((d=new Error("")).stack=u.error+"\n"+r,i&&i(),a(d)):o(u.result),this.message.remove(t)),[2]}}))}))})),s},this.handleSendApiChannel([{eventName:e,data:t,msgId:n},h]),[2,s]}}))}))},this.handleApiSetter=function(e){return d(n,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,u,l,d=this;return f(this,(function(f){switch(f.label){case 0:return t=function(){return Object.keys(d.setterCallbacks.idMap).find((function(e){return d.setterCallbacks.idMap[e]===r+":"+n}))},n=e.prop,r=e.parentObjId,i=e.value,[4,this.reduceArgs([i])];case 1:return o=f.sent(),a=o[0],s=o[1],e.value=a[0],c=Object.keys(s)[0],u=this.setterCallbacks[r],null===i&&u&&u[n]&&((l=t())&&delete this.setterCallbacks.idMap[l],delete u[n],Object.keys(u).length||delete this.setterCallbacks[r],Object.keys(this.setterCallbacks.idMap).length||this.message.remove(this.setterCallbackSubscribe.bind(this))),c&&(Object.keys(this.setterCallbacks.idMap).length||this.message.add(this.setterCallbackSubscribe.bind(this)),this.setterCallbacks[r]||(this.setterCallbacks[r]={}),this.setterCallbacks[r][n]={callbackId:c,callback:s[c]},(l=t())&&delete this.setterCallbacks.idMap[l],this.setterCallbacks.idMap[c]=r+":"+n),[2]}}))}))},this.prefix=t,this.origin=e.origin,this.sendMsgToWps=e.sendMsgToWps.bind(e),this.getId=e.getId.bind(e),this.message=e.message,this.sdkInstanceId=e.instanceId,this.instance=e}return e.prototype.destroyApplication=function(){this.collectObjIdHandlers=new Set,this.objId=0},e.prototype.subEventHandle=function(e,t){var n=this,r={};this.message.add((function(e){return d(n,void 0,void 0,(function(){var t,n,i,o,a,s;return f(this,(function(c){switch(c.label){case 0:return this.instance.originWhiteList.includes(e.origin)||this.origin===e.origin?(t=this.message.parse(e.data),n=t.sdkInstanceId,t.eventName===this.prefix+"event"&&Number(n)===this.sdkInstanceId&&t.data?(i=t.data,o=i.eventName,a=i.data,(s=r[o])?[4,s(a)]:[3,2]):[3,2]):[2];case 1:c.sent(),c.label=2;case 2:return[2]}}))}))}));var i=function(i){var o=t[i];Object.defineProperty(e,o,{set:function(e){r[o]=e,n.sendMsgToWps({eventName:n.prefix+"event.register",data:{eventName:o,register:!!e,objId:n.objId+=1},sdkInstanceId:n.sdkInstanceId})}})};for(var o in t)i(o)},e.prototype.mixinProto=function(e,t){Object.assign(e,t)},e.prototype.makeCollectObjIdHandle=function(e){var t=this;return function(){var n=[],r=function(e){n.push(e)};return t.collectObjIdHandlers.add(r),{End:function(){e(n),t.collectObjIdHandlers.delete(r)}}}},e.prototype.assign=function(e,t,n){for(var r=this,i=t.slice(0),o=function(){var t=i.shift();!t.alias&&~a.polyfillApi.indexOf(t.prop)&&i.push(l(l({},t),{alias:t.prop+"Async"})),Object.defineProperty(e,t.alias||t.prop,{get:function(){var i=1===t.cache,o=i&&e["__"+t.prop+"CacheValue"];if(!o){var a=r.getError(),s=r.createObjId(i),c=function i(){for(var o,s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];return void 0!==t.caller?(o={objId:r.createObjId()},r.assign(o,n[t.caller],n)):o={},r.wrapper(i,o,r.prefix+"caller",{obj:i,args:s,parentObjId:e.objId,objId:o.objId,prop:t.prop},a),o};return c.objId=-1,void 0!==t.getter&&(c.objId=s,r.assign(c,n[t.getter],n)),r.wrapper(e,c,r.prefix+"getter",{parentObjId:e.objId,objId:c.objId,prop:t.prop},a,(function(){delete e["__"+t.prop+"CacheValue"]})),i&&(e["__"+t.prop+"CacheValue"]=c),c}return o},set:function(n){var i=r.getError();return r.wrapper(e,{},r.prefix+"setter",{value:n,parentObjId:e.objId,objId:-1,prop:t.prop},i)}})},a=this;i.length;)o()},e.prototype.wrapper=function(e,t,n,r,i,o){var a,s=this,c=(e.done?e.done():Promise.resolve()).then((function(){return a||(a=s.apiChannel(n,r,i,o)),a}));t.done=function(){return c},t.then=function(e,n){return r.objId>=0?(t.then=null,t.catch=null,c.then((function(){e(t)})).catch((function(e){return n(e)}))):c.then(e,n)},t.catch=function(e){return c.catch(e)},t.Destroy=function(){return this.apiChannel(this.prefix+"free",{objId:t.objId},"")}},e.prototype.handleSendApiChannel=function(e){var t=e[0],n=e[1];"function"==typeof(t=l({},t)).data&&(t.data=t.data()),n(),this.sendMsgToWps(t)},e.prototype.setterCallbackSubscribe=function(e){return d(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,u,l;return f(this,(function(d){switch(d.label){case 0:return this.instance.originWhiteList.includes(e.origin)||this.origin===e.origin?(t=this.message.parse(e.data),n=t.eventName,r=t.callbackId,i=t.data,r&&(o=this.setterCallbacks.idMap[r])?(a=o.split(":"),s=a[0],c=a[1],n===this.prefix+"callback"&&this.setterCallbacks[s]&&this.setterCallbacks[s][c]?[4,(l=this.setterCallbacks[s][c]).callback.apply(l,i.args)]:[3,2]):[3,2]):[2];case 1:u=d.sent(),this.sendMsgToWps({result:u,callbackId:r,eventName:this.prefix+"callback.reply"}),d.label=2;case 2:return[2]}}))}))},e.prototype.reduceArgs=function(e){return d(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,u,l,d;return f(this,(function(f){switch(f.label){case 0:t={},n=[],r=e.slice(0),f.label=1;case 1:return r.length?(i=void 0,[4,r.shift()]):[3,13];case 2:return(o=f.sent())&&o.done?[4,o.done()]:[3,4];case 3:f.sent(),f.label=4;case 4:if(!v(i))return[3,11];for(s in i={},a=[],o)a.push(s);c=0,f.label=5;case 5:return c<a.length?(u=a[c],l=o[u],/^[A-Z]/.test(u)?l&&l.done?[4,l.done()]:[3,7]:[3,8]):[3,10];case 6:f.sent(),f.label=7;case 7:l&&l.objId?l={objId:l.objId}:"function"==typeof l&&(d=this.getId(),t[d]=l,l={callbackId:d}),f.label=8;case 8:i[u]=l,f.label=9;case 9:return c++,[3,5];case 10:return[3,12];case 11:o&&o.objId?i={objId:o.objId}:"function"==typeof o&&void 0===o.objId?(d=this.getId(),t[d]=o,i={callbackId:d}):i=o,f.label=12;case 12:return n.push(i),[3,1];case 13:return[2,[n,t]]}}))}))},e.prototype.createObjId=function(e){return this.objId+=1,!e&&this.collectObjId(),this.objId},e.prototype.collectObjId=function(){var e=this;this.collectObjIdHandlers.forEach((function(t){return t(e.objId)}))},e.prototype.getError=function(){var e=new Error("");return(e.stack||e.message||"").split("\n").slice(2).join("\n")},e}(),w=function(e){function t(t,n,r){var i=e.call(this,t,r)||this,o={},a=t.officeType,c=n.Events,u=n.Enum,l=n.Props,d=l[0],f=l[1],p={objId:i.objId};switch(i.assign(p,d,f),p.Events=c,p.Enum=u,p.Sub={},o.Enum=p.Enum,o.Events=p.Events,o.Props=l,a){case s.writer:o.WordApplication=t.WpsApplication=function(){return p};break;case s.spreadsheet:o.ExcelApplication=t.EtApplication=function(){return p};break;case s.presentation:o.PPTApplication=t.WppApplication=function(){return p};break;case s.pdf:o.PDFApplication=function(){return p}}return o.Application=p,o.Free=function(e){return i.apiChannel(i.prefix+"free",{objId:e},"")},o.Stack=p.Stack=i.makeCollectObjIdHandle((function(e){i.apiChannel(i.prefix+"free",{objId:e},"")})),o.destroyApplication=function(){i.destroyApplication()},i.subEventHandle(p.Sub,c),i.mixinProto(t,o),i}return o(t,e),t}(y),k=function(e){function t(t,n,r){var i=e.call(this,t,r)||this,o={},a=n.Events,s=n.Enum,c=n.Props,u=c[0],l=c[1],d={objId:i.objId};return i.assign(d,u,l),d.Events=a,d.Enum=s,d.Sub={},o.CommonEnum=d.Enum,o.CommonEvents=d.Events,o.CommonProps=c,o.CommonApi=d,o.CommonFree=function(e){return i.apiChannel(i.prefix+"free",{objId:e},"")},o.CommonStack=d.Stack=i.makeCollectObjIdHandle((function(e){i.apiChannel(i.prefix+"free",{objId:e},"")})),o.destroyCommonApp=function(){i.destroyApplication()},i.subEventHandle(d.Sub,a),i.mixinProto(t,o),i}return o(t,e),t}(y),x=function(){function e(t){var n,r=this;this.id=0,this.origin="",this.originWhiteList=[],this.realOrigin="",this.iframeWH=null,this.cbConfigsSub={},this.readyEventNames=[{event:"ready",callback:function(){r.handleBaseReady()},after:!0},{event:"open.result"},{event:"api.ready",callback:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0];return new w(r,n,"api."),r.Application}},{event:"commonApi.ready",callback:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0];return new k(r,n,"commonApi."),r.CommonApi}}],this.cbConfigs=["refreshToken"],this.onEventNames={"open.result":"fileOpen","tab.switch":"tabSwitch","file.saved":"fileStatus",error:"error",stage:"stage"},this.polyfillConfigName=[["wpsOptions","wordOptions"],["etOptions","excelOptions"],["wppOptions","pptOptions"]],this.flag={advancedApiReadySended:!1,advancedApiReadySendedJust:!1,commonApiReadySended:!1,commonApiReadySendedJust:!1},this.baseReadyPromise=Promise.resolve(),this.fileOpenPromise=Promise.resolve(),this.advancedReadyPromise=Promise.resolve(),this.commonApiPromise=Promise.resolve(),this.iframeInstance=null,this.officeType="",this.url="",this.version="2.0.2",this.iframeReady=!1,this.forceIframeResize=function(){r.iframeInstance&&r.iframeInstance.handleResize()},this.isOtherEvent=function(e){return void 0!==e&&e!==r.instanceId},this.handleBaseReady=function(){r.sendMsgToWps({eventName:"setConfig",data:l(l({},r.sdkConfig),{version:r.version})}),r.tokenData&&r.setToken(l(l({},r.tokenData),{hasRefreshTokenConfig:!!r.sdkConfig.refreshToken})),r.flag.advancedApiReadySended&&r.sendMsgToWps({eventName:"api.ready"}),r.flag.commonApiReadySended&&r.sendMsgToWps({eventName:"commonApi.ready"}),r.iframeReady=!0},this.handleFullscreenChange=function(){var e={status:u.requestFullscreen};document.fullscreenElement?e.status=u.requestFullscreen:e.status=u.exitFullscreen,r.sendMsgToWps({data:e,eventName:"fullscreenchange"})},this.instanceId=e.instanceId,e.instanceId+=1,this.message=new g,this.mittInstance=(n=n||Object.create(null),{on:function(e,t){(n[e]||(n[e]=[])).push(t)},off:function(e,t){n[e]&&n[e].splice(n[e].indexOf(t)>>>0,1)},emit:function(e,t){(n[e]||[]).slice().map((function(e){e(t)})),(n["*"]||[]).slice().map((function(n){n(e,t)}))}}),this.handleConfig(t)}return e.config=function(t){return void 0===t&&(t={}),e.singleInstance||(e.singleInstance=new e(t)),e.singleInstance},e.prototype.setToken=function(e){return d(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.basicReady()];case 1:return t.sent(),this.tokenData=e,this.sendMsgToWps({eventName:"setToken",data:e}),[2]}}))}))},e.prototype.advancedApiReady=function(){return d(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return this.flag.advancedApiReadySendedJust?[3,2]:(this.flag.advancedApiReadySendedJust=!0,[4,this.fileOpenPromise]);case 1:e.sent(),this.flag.advancedApiReadySended||(this.flag.advancedApiReadySended=!0,this.sendMsgToWps({eventName:"api.ready"})),e.label=2;case 2:return[4,this.advancedReadyPromise];case 3:return[2,e.sent()]}}))}))},e.prototype.commonApiReady=function(){return d(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return this.flag.commonApiReadySendedJust?[3,2]:(this.flag.commonApiReadySendedJust=!0,[4,this.basicReady()]);case 1:e.sent(),this.flag.commonApiReadySended||(this.flag.commonApiReadySended=!0,this.sendMsgToWps({eventName:"commonApi.ready"})),e.label=2;case 2:return[4,this.commonApiPromise];case 3:return[2,e.sent()]}}))}))},e.prototype.destroy=function(){this.iframeInstance.destroy(),this.message.empty(),this.destroyApplication&&this.destroyApplication(),this.destroyCommonApp&&this.destroyCommonApp(),this.removeFullscreenEventListener()},e.prototype.on=function(e,t){return d(this,void 0,void 0,(function(){var n;return f(this,(function(r){switch(r.label){case 0:return[4,this.basicReady()];case 1:return r.sent(),n=e,"fullscreenChange"===e&&(n="fullscreenchange"),this.handleBasicEvent(n,"on"),this.mittInstance.on(e,t),[2]}}))}))},e.prototype.off=function(e,t){return d(this,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,this.basicReady()];case 1:return n.sent(),this.handleBasicEvent(e,"off"),this.mittInstance.off(e,t),[2]}}))}))},e.prototype.handleConfig=function(e){var t=this;void 0===e&&(e={});try{var n=this.userConfHandler(e),r=n.subscriptions,i=void 0===r?{}:r,o=n.mount,a=void 0===o?null:o,s=n.url,c=n.originWhiteList;this.origin=(s.match(/https*:\/\/[^\/]+/g)||[])[0],this.originWhiteList=c||[];var u=this.readyEventNames.map((function(e){return t.makeReady(e)})),l=u[0],d=u[1],f=u[2],p=u[3];this.baseReadyPromise=l,this.fileOpenPromise=d,this.advancedReadyPromise=f,this.commonApiPromise=p,this.iframeWH=a?{width:a.clientWidth+"px",height:a.clientHeight+"px"}:{width:"100vw",height:"100vh"},delete n.mount,s&&delete n.url,this.url=s,delete n.subscriptions,this.sdkConfig=n,this.iframeInstance=new b(this,this.instanceId,s,a,!0,!1,{allow:n.attrAllow}),this.iframe=this.iframeInstance.iframe,this.listener(i)}catch(e){return console.error(e),null}},e.prototype.listener=function(e){var t=this;this.message.add((function(n){return d(t,void 0,void 0,(function(){var t,r,i,o,a,s,c,u,l;return f(this,(function(d){return t=this.message.parse(n.data),r=t.eventName,i=void 0===r?"":r,o=t.data,a=void 0===o?null:o,s=t.url,c=void 0===s?null:s,u=t.sdkInstanceId,this.isOtherEvent(u)||-1!==["wps.jssdk.api"].indexOf(i)||((l=this.handleListenEvent(i,a))?l():Object.keys(this.onEventNames).includes(i)&&("open.result"===i&&(this.officeType=a.fileInfo.officeType),this.mittInstance.emit(this.onEventNames[i],a)),"function"==typeof e[i]&&e[i](this,c||a)),[2]}))}))}))},e.prototype.handleListenEvent=function(e,t){var n,r=this;return((n={"api.scroll":function(){return window.scrollTo(t.x,t.y)},"event.callback":function(){return d(r,void 0,void 0,(function(){var e,n,r,i,o,a,s;return f(this,(function(c){return e=t.eventName,n=t.data,r=e,"fullScreenChange"===e&&(r="fullscreenChange"),((null===(a=this.sdkConfig.commonOptions)||void 0===a?void 0:a.isBrowserViewFullscreen)||(null===(s=this.sdkConfig.commonOptions)||void 0===s?void 0:s.isParentFullscreen))&&"fullscreenchange"===r&&(i=n.status,o=n.isDispatchEvent,this.sdkConfig.commonOptions.isBrowserViewFullscreen?this.iframeWH&&function(e,t,n,r){0===e?t.style="position: static; width: "+n.width+"; height: "+n.height:1===e&&(t.style="position: absolute; width: 100%; height: 100%"),r&&function(e){["fullscreen","fullscreenElement"].forEach((function(t){Object.defineProperty(document,t,{get:function(){return!!e.status},configurable:!0})}));var t=new CustomEvent("fullscreenchange");document.dispatchEvent(t)}({status:e})}(i,this.iframe,this.iframeWH,o):this.sdkConfig.commonOptions.isParentFullscreen&&function(e,t){if(0===e){var n=document;(n.exitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen||n.webkitCancelFullScreen||n.webkitExitFullscreen).call(document)}else if(1===e){(t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen).call(t)}}(i,this.iframe)),this.mittInstance.emit(r,n),[2]}))}))}})[a.refreshToken]=function(){return d(r,void 0,void 0,(function(){var t,n;return f(this,(function(r){switch(r.label){case 0:t={token:!1},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.cbConfigsSub.refreshToken()];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),console.error("refreshToken: "+(n||"fail to get")),[3,4];case 4:return this.sendMsgToWps({eventName:e+".reply",data:t}),[2]}}))}))},n)[e]},e.prototype.basicReady=function(){return this.baseReadyPromise},e.prototype.userConfHandler=function(e,t){var n=this;void 0===t&&(t=!0);var r=l({},e),i=r.headers,o=void 0===i?{}:i,s=r.subscriptions,u=void 0===s?{}:s,d=r.commonOptions,f=r.url,p=void 0===f?"":f,h=r.wpsUrl,v=void 0===h?"":h,m=r.mode,b=void 0===m?c.nomal:m,g=r.debug,y=r.disablePlugins,w=r.hideGuide,k=r.readOnly;return Object.assign(r,this.handleHeadersAndSubscriptionsConfig(o,u,t)),r.url=this.handleUrlConfig(d,b,g,p,v,y,w,k),d&&(d.isParentFullscreen||d.isBrowserViewFullscreen)&&document.addEventListener("fullscreenchange",this.handleFullscreenChange),this.polyfillConfigName.map((function(e){var t=e[0],n=e[1];r[n]&&(r[t]=r[n])})),this.cbConfigs.map((function(e){var t,i=r[e];i&&(t=i,"Function","[object Function]"==={}.toString.call(t))&&(n.cbConfigsSub[e]=i,r[e]={eventName:a[e]})})),r.commandBars&&this.handleCommandBarsConfig(r.commandBars,!1),l({},r)},e.prototype.handleBasicEvent=function(e,t){if(!["error","fileOpen"].includes(e)){var n={eventName:"basic.event",data:{eventName:e,action:t}};this.sendMsgToWps(n)}},e.prototype.removeFullscreenEventListener=function(){document.removeEventListener("fullscreenchange",this.handleFullscreenChange)},e.prototype.handleHeadersAndSubscriptionsConfig=function(e,t,n){var r=e.backBtn,i=void 0===r?{}:r,o=e.shareBtn,a=void 0===o?{}:o,s=e.otherMenuBtn,c=void 0===s?{}:s,u=[["wpsconfig_back_btn",i],["wpsconfig_share_btn",a],["wpsconfig_other_menu_btn",c]],l=[];return c.items&&Array.isArray(c.items)&&c.items.forEach((function(e,t){void 0===e&&(e={}),"custom"===e.type&&l.push(["wpsconfig_other_menu_btn_"+t,e])})),u.concat(l).forEach((function(e){var r,i;r=e[1],i=e[0],r.subscribe&&"function"==typeof r.subscribe&&(r.callback=i,t[i]=r.subscribe,n&&delete r.subscribe)})),{}},e.prototype.handleUrlConfig=function(e,t,n,r,i,o,a,s){var u=[];u.push("sdkId="+this.instanceId),t===c.simple||e&&!1===e.isShowTopArea?u.push("simple","hidecmb"):t===c.embed&&u.push("simple=1","hidecmb=1","embed=1"),o&&u.push("disablePlugins"),a&&u.push("hideguide"),s&&u.push("readonly"),n&&u.push("debugger");var l=r||i;return l&&u.length&&(l=l+(l.indexOf("?")>=0?"&":"?")+u.join("&")),l},e.prototype.handleCommandBarsConfig=function(e,t){void 0===t&&(t=!0);var n=e.map((function(e){var t=e.attributes;if(!Array.isArray(t)){var n=[];for(var r in t)if(t.hasOwnProperty(r)){var i={name:r,value:t[r]};n.push(i)}e.attributes=n}return e}));return t&&this.sendMsgToWps({data:n,eventName:"setCommandBars"}),n},e.prototype.sendMsgToWps=function(e){var t,n,r=l(l({},e),{sdkInstanceId:this.instanceId});null===(n=null===(t=this.iframe)||void 0===t?void 0:t.contentWindow)||void 0===n||n.postMessage(JSON.stringify(r),this.realOrigin)},e.prototype.makeReady=function(e){var t=this,n=e.event,r=e.callback,i=e.after;return new Promise((function(e){t.message.add((function o(a){if(t.realOrigin=a.origin,t.originWhiteList.includes(a.origin)||t.origin===a.origin){var s=t.message.parse(a.data),c=s.eventName,u=s.data,l=s.sdkInstanceId;if(!t.isOtherEvent(l)&&c===n){var d=void 0;!i&&r&&(d=r(u)),e(d),i&&r&&r(u),t.message.remove(o)}}}))}))},e.prototype.getId=function(){return this.id+=1,this.instanceId+"-"+this.id},e.instanceId=1,e}(),A={executeCommandBar:"ExecuteCommandBar",off:"Off",save:"Save",setCommandBars:"SetCommandBars",setCooperUserColor:"SetCooperUserColor",tabs:"Tabs",Stack:"Stack",WhenStacksEmpty:"WhenStacksEmpty"};!function(e){e.Spreadsheet="s",e.Writer="w",e.Presentation="p",e.Pdf="f",e.Otl="o"}(m||(m={}));var I=function(e){function t(t){var n=e.call(this,t)||this;return t.token&&(v(t.token)?n.setToken(l({},t.token)):n.setToken({token:t.token})),n.ApiEvent={AddApiEventListener:function(e,t){n.on(e,t)},RemoveApiEventListener:function(e,t){n.off(e,t)}},n}return o(t,e),t.init=function(e){var n=l({},e);if("string"==typeof n.mount){var r=document.querySelector(n.mount);r?n.mount=r:(console.warn("[WebOfficeSDK.init] mount挂载节点未找到"),delete n.mount)}if(n.url)throw Error("[WebOfficeSDK.init] 不支持传递url，请使用appId、fileId、officeType、token等参数初始化！");if(!n.appId||!n.fileId||!n.officeType)throw Error("[WebOfficeSDK.init] appId、fileId、officeType为必选项！");n.endpoint=n.endpoint||"https://o.wpsgo.com";var i=new t(function(e){var t=l({},e);t.token=t.token||t.fileToken;var n=t.appId,r=t.fileId,i=t.officeType,o=t.token,a=t.endpoint,s=t.customArgs,c=void 0===s?"":s;if(!Object.values(m).includes(i))throw Error("[WebOfficeSDK.init] officeType属性值错误，可选值参考WebOfficeSDK.OfficeType: "+JSON.stringify(m));var u=o?1:0,d={token:""};if("string"==typeof o?d.token=o:v(o)&&(d=l({tokenData:d},o)),u&&!d.token)return console.error("[WebOfficeSDK.init] token设置无效"),t;if(t.url=a+"/office/"+i+"/"+r+"?_w_appid="+n+"&_w_tokentype="+u,v(c)){var f=Object.entries(c).map((function(e){var t=e[0],n=e[1];return t+"="+encodeURIComponent(n)})).join("&");t.url=t.url+"&"+f}return l({},t)}(n));return function(e,t){d(this,void 0,void 0,(function(){var n,r,i,o;return f(this,(function(a){switch(a.label){case 0:return[4,e.commonApiReady()];case 1:for(r in a.sent(),n=[],t)n.push(r);i=0,a.label=2;case 2:if(!(i<n.length))return[3,11];switch(o=n[i]){case"onHyperLinkOpen":return[3,3];case"onToast":return[3,5];case"getClipboardData":return[3,7]}return[3,9];case 3:return[4,e.CommonApi.Hooks.Add("hyperLink")];case 4:return a.sent().OnAction=t[o],[3,10];case 5:return[4,e.CommonApi.Hooks.Add("toast")];case 6:return a.sent().OnAction=t[o],[3,10];case 7:return[4,e.CommonApi.Hooks.Add("getClipboardData")];case 8:return a.sent().OnAction=t[o],[3,10];case 9:return[3,10];case 10:return i++,[3,2];case 11:return[2]}}))}))}(i,e),function(e,t){var n=this;return void 0===t&&(t={}),new Proxy(e,l(l({},{get:function(e,t){if(Object.keys(A).includes(t)){var r=A[t];return"Tabs"===r?function(e){var t=this;return{switchTab:function(n){return d(t,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,e.commonApiReady()];case 1:return t.sent(),[4,e.CommonApi.Tabs.SwitchTab(n.tabKey)];case 2:return[2,t.sent()]}}))}))},getTabs:function(){return d(t,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,e.commonApiReady()];case 1:return t.sent(),[4,e.CommonApi.Tabs.GetTabs()];case 2:return[2,t.sent()]}}))}))}}}(e):e.CommonApi?Reflect.get(e.CommonApi,r):function(){return d(n,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return[4,e.commonApiReady()];case 1:return n.sent(),[4,e.commonApiPromise];case 2:return n.sent(),"function"!=typeof e.CommonApi[r]?[3,4]:[4,e.CommonApi[r]()];case 3:return t=n.sent(),[3,5];case 4:t=e.CommonApi[r],n.label=5;case 5:return[2,t]}}))}))}}return Reflect.get(e,t)},set:function(e,t,n){return!!Reflect.has(e,t)&&Reflect.set(e,t,n)}}),t))}(i)},t.prototype.ready=function(){return d(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this.advancedApiReady()];case 1:return[2,e.sent()]}}))}))},t.OfficeType=Object.freeze({Spreadsheet:"s",Writer:"w",Presentation:"p",Pdf:"f",Otl:"o"}),t}(x);window.WPS=I;t.default=I},907160:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.config=void 0,n(182320),n(909112),n(697060),n(622676),n(305092),n(233696),n(241872),n(323784),n(743924),n(686456),n(835164),n(693917),n(927184),n(976896),n(297336),n(336368),n(708896),n(606200),n(109064),n(670864),n(76124),n(387912),n(497448),n(633768),n(690512),n(764840),n(78504),n(218080),n(513640),n(29885),n(997308),n(977864),n(86744);var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var s=function(){function e(){}return e.add=function(t){e.HANDLE_LIST.push(t),window.addEventListener("message",t,!1)},e.remove=function(t){var n=e.HANDLE_LIST.indexOf(t);n>=0&&e.HANDLE_LIST.splice(n,1),window.removeEventListener("message",t,!1)},e.empty=function(){for(;e.HANDLE_LIST.length;)window.removeEventListener("message",e.HANDLE_LIST.shift(),!1)},e.parse=function(e){try{return"object"==r(e)?e:e?JSON.parse(e):e}catch(t){return e}},e.HANDLE_LIST=[],e}();function c(e){return"[object Function]"==={}.toString.call(e)}var u,l,d,f,p,h={origin:""};function v(e,t){h[e]=t}function m(e){return h[e]}function b(e){var t=m("origin");return!!function(e,t){return e!==t&&(e.replace(/www\./i,"").toLowerCase()!==t.replace(/www\./i,"").toLowerCase()||(e.match("www.")?void 0:(v("origin",t),!1)))}(t,e.origin)&&(console.warn("postMessage 域名检查不通过",{safeOrigin:t,eventOrigin:e.origin}),!0)}(p=u||(u={})).unknown="unknown",p.spreadsheet="s",p.writer="w",p.presentation="p",p.pdf="f",function(e){e.wps="w",e.et="s",e.presentation="p",e.pdf="f"}(l||(l={})),function(e){e.nomal="nomal",e.simple="simple"}(d||(d={})),function(e){e[e.requestFullscreen=1]="requestFullscreen",e[e.exitFullscreen=0]="exitFullscreen"}(f||(f={}));var g,y,w,k=(g=0,function(){return g+=1}),x=function(e,t,n){void 0===n&&(n=!0);var r=t;if(!y){var i=function e(t){var n=t.clientHeight,r=t.clientWidth;0!==n||0!==r||w?0===n&&0===r||!w||(w.disconnect(),w=null):window.ResizeObserver&&(w=new ResizeObserver((function(n){e(t)}))).observe(t),y.style.cssText+="height: "+n+"px; width: "+r+"px"}.bind(null,r);(y=document.createElement("iframe")).classList.add("web-office-iframe");var o={id:"office-iframe",src:e,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true",allow:"clipboard-read; clipboard-write"};for(var a in r?(o.style="width: "+r.clientWidth+"px; height: "+r.clientHeight+"px;",n&&window.addEventListener("resize",i)):((r=document.createElement("div")).classList.add("web-office-default-container"),function(e){var t=document.createElement("style");document.head.appendChild(t);var n=t.sheet;n.insertRule(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100%; height: 100%; left: 0; top: 0;}",n.cssRules.length)}(),document.body.appendChild(r),o.style="position: fixed; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;"),o)y.setAttribute(a,o[a]);r.appendChild(y),y.destroy=function(){y.parentNode.removeChild(y),y=null,window.removeEventListener("resize",i),w&&(w.disconnect(),w=null)}}return y},A=function(e){x().contentWindow&&x().contentWindow.postMessage(JSON.stringify(e),m("origin"))};function I(e,t,n){return new Promise((function(r){var i=k();s.add((function e(t){if(!b(t)){var o=s.parse(t.data);o.eventName===n&&o.msgId===i&&(r(o.data),s.remove(e))}})),A({data:e,msgId:i,eventName:t})}))}var E=function(e){return I(e,"wps.jssdk.api","wps.api.reply")},O=function(e){return I(e,"api.basic","api.basic.reply")},S={idMap:{}};function C(e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,c,u,l,d,f;return a(this,(function(a){switch(a.label){case 0:return b(e)?[2]:(t=s.parse(e.data),n=t.eventName,r=t.callbackId,i=t.data,r&&(o=S.idMap[r])?(c=o.split(":"),u=c[0],l=c[1],"api.callback"===n&&S[u]&&S[u][l]?[4,(f=S[u][l]).callback.apply(f,i.args)]:[3,2]):[3,2]);case 1:d=a.sent(),A({result:d,callbackId:r,eventName:"api.callback.reply"}),a.label=2;case 2:return[2]}}))}))}var j=function(e){return o(void 0,void 0,void 0,(function(){function t(){return Object.keys(S.idMap).find((function(e){return S.idMap[e]===r+":"+n}))}var n,r,i,o,c,u,l,d,f;return a(this,(function(a){switch(a.label){case 0:return n=e.prop,r=e.parentObjId,[4,R([i=e.value])];case 1:return o=a.sent(),c=o[0],u=o[1],e.value=c[0],l=Object.keys(u)[0],d=S[r],null===i&&d&&d[n]&&((f=t())&&delete S.idMap[f],delete d[n],Object.keys(d).length||delete S[r],Object.keys(S.idMap).length||s.remove(C)),l&&(Object.keys(S.idMap).length||s.add(C),S[r]||(S[r]={}),S[r][n]={callbackId:l,callback:u[l]},(f=t())&&delete S.idMap[f],S.idMap[l]=r+":"+n),[2]}}))}))},T=function(e,t,n,r){return o(void 0,void 0,void 0,(function(){var c,u,l,d,f,p,h,v;return a(this,(function(m){switch(m.label){case 0:return c=k(),d=new Promise((function(e,t){u=e,l=t})),f={},t.args?[4,R(t.args)]:[3,2];case 1:p=m.sent(),h=p[0],v=p[1],t.args=h,f=v,m.label=2;case 2:return"api.setter"!==e?[3,4]:[4,j(t)];case 3:m.sent(),m.label=4;case 4:return function(e){var t=e[0],n=e[1];"function"==typeof(t=i({},t)).data&&(t.data=t.data()),n(),A(t)}([{eventName:e,data:t,msgId:c},function(){var t=this;return s.add((function i(d){return o(t,void 0,void 0,(function(){var t,o,p;return a(this,(function(a){switch(a.label){case 0:return b(d)?[2]:"api.callback"===(t=s.parse(d.data)).eventName&&t.callbackId&&f[t.callbackId]?[4,f[t.callbackId].apply(f,t.data.args)]:[3,2];case 1:o=a.sent(),A({result:o,eventName:"api.callback.reply",callbackId:t.callbackId}),a.label=2;case 2:return t.eventName===e+".reply"&&t.msgId===c&&(t.error?((p=new Error("")).stack=t.error+"\n"+n,r&&r(),l(p)):u(t.result),s.remove(i)),[2]}}))}))})),d}]),[2,d]}}))}))};function R(e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,s,c,u,l,d,f;return a(this,(function(a){switch(a.label){case 0:t={},n=[],r=e.slice(0),a.label=1;case 1:return r.length?(i=void 0,[4,r.shift()]):[3,13];case 2:return(o=a.sent())&&o.done?[4,o.done()]:[3,4];case 3:a.sent(),a.label=4;case 4:if(!function(e){if(!e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(i))return[3,11];for(c in i={},s=[],o)s.push(c);u=0,a.label=5;case 5:return u<s.length?(l=s[u],d=o[l],/^[A-Z]/.test(l)?d&&d.done?[4,d.done()]:[3,7]:[3,8]):[3,10];case 6:a.sent(),a.label=7;case 7:d&&d.objId?d={objId:d.objId}:"function"==typeof d&&(f=k(),t[f]=d,d={callbackId:f}),a.label=8;case 8:i[l]=d,a.label=9;case 9:return u++,[3,5];case 10:return[3,12];case 11:o&&o.objId?i={objId:o.objId}:"function"==typeof o&&void 0===o.objId?(f=k(),t[f]=o,i={callbackId:f}):i=o,a.label=12;case 12:return n.push(i),[3,1];case 13:return[2,[n,t]]}}))}))}var D=function(e,t){void 0===t&&(t=!0);var n=i({},e),o=n.headers,a=void 0===o?{}:o,s=n.subscriptions,c=void 0===s?{}:s,u=n.mode,l=void 0===u?d.nomal:u,f=n.commonOptions,p=a.backBtn,h=void 0===p?{}:p,v=a.shareBtn,m=void 0===v?{}:v,b=a.otherMenuBtn,g=void 0===b?{}:b,y=function(e,n){e.subscribe&&"function"==typeof e.subscribe&&(e.callback=n,c[n]=e.subscribe,t&&delete e.subscribe)};if(y(h,"wpsconfig_back_btn"),y(m,"wpsconfig_share_btn"),y(g,"wpsconfig_other_menu_btn"),g.items&&Array.isArray(g.items)){var w=[];g.items.forEach((function(e,t){switch(void 0===e&&(e={}),e.type){case"export_img":e.type=1,e.callback="export_img";break;case"export_pdf":e.type=1,e.callback="export_pdf";break;case"save_version":e.type=1,e.callback="save_version";break;case"about_wps":e.type=1,e.callback="about_wps";break;case"split_line":e.type=2;break;case"custom":e.type=3,y(e,"wpsconfig_other_menu_btn_"+t),w.push(e)}})),w.length&&(_||F)&&(g.items=w)}n.url=n.url||n.wpsUrl;var k=[];if((l===d.simple||f&&!1===f.isShowTopArea)&&k.push("simple","hidecmb"),n.debug&&k.push("debugger"),n.url&&k.length&&(n.url=n.url+(n.url.indexOf("?")>=0?"&":"?")+k.join("&")),f&&(f.isParentFullscreen||f.isBrowserViewFullscreen)&&(document.addEventListener("fullscreenchange",B),document.addEventListener("webkitfullscreenchange",B),document.addEventListener("mozfullscreenchange",B)),n.wordOptions&&(n.wpsOptions=n.wordOptions),n.excelOptions&&(n.etOptions=n.excelOptions),n.pptOptions&&(n.wppOptions=n.pptOptions),"object"==r(c.print)){var x="wpsconfig_print";"function"==typeof c.print.subscribe&&(c[x]=c.print.subscribe,n.print={callback:x},void 0!==c.print.custom&&(n.print.custom=c.print.custom)),delete c.print}return"function"==typeof c.exportPdf&&(c[x="wpsconfig_export_pdf"]=c.exportPdf,n.exportPdf={callback:x},delete c.exportPdf),n.commandBars&&P(n.commandBars,!1),i(i({},n),{subscriptions:c})},L=function(e){void 0===e&&(e="");var t="";if(!t&&e){var n=e.toLowerCase();-1!==n.indexOf("/office/s/")&&(t=u.spreadsheet),-1!==n.indexOf("/office/w/")&&(t=u.writer),-1!==n.indexOf("/office/p/")&&(t=u.presentation),-1!==n.indexOf("/office/f/")&&(t=u.pdf)}if(!t){var r=e.match(/[\?&]type=([a-z]+)/)||[];t=l[r[1]]||""}return t};function P(e,t){void 0===t&&(t=!0);var n=e.map((function(e){var t=e.attributes;if(!Array.isArray(t)){var n=[];for(var r in t)if(t.hasOwnProperty(r)){var i={name:r,value:t[r]};n.push(i)}e.attributes=n}return e}));return t&&A({data:n,eventName:"setCommandBars"}),n}var N=window.navigator.userAgent.toLowerCase(),_=/Android|webOS|iPhone|iPod|BlackBerry|iPad/i.test(N),F=function(){try{return-1!==window._parent.location.search.indexOf("from=wxminiprogram")}catch(e){return!1}}();function B(){var e={status:f.requestFullscreen},t=document,n=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement;e.status=n?f.requestFullscreen:f.exitFullscreen,A({data:e,eventName:"fullscreenchange"})}var M=function(){S.idMap={}};function W(){console.group("JSSDK 事件机制调整说明"),console.warn("jssdk.on、jssdk.off 和 jssdk.Application.Sub 将在后续版本中被弃用，建议使用改进后的 ApiEvent"),console.warn("具体请参考：https://wwo.wps.cn/docs/front-end/basic-usage/events/intro/"),console.groupEnd()}var H=0,V=new Set;function z(e){return H+=1,!e&&function(e){V.forEach((function(t){return t(e)}))}(H),H}function G(){var e=new Error("");return(e.stack||e.message||"").split("\n").slice(2).join("\n")}function q(e,t){var n,r=this,c=t.Events,l=t.Enum,d=t.Props,f=d[0],p=d[1],h={objId:H};switch(function e(t,n,r){for(var o=n.slice(0),a=function(){var n=o.shift();!n.alias&&~J.indexOf(n.prop)&&o.push(i(i({},n),{alias:n.prop+"Async"})),Object.defineProperty(t,n.alias||n.prop,{get:function(){var o=this,a=1===n.cache,s=a&&this["__"+n.prop+"CacheValue"];if(!s){var c=G(),u=z(a),l=function e(){for(var o,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return void 0!==n.caller?function e(t,n,r){for(var o=n.slice(0),a=function(){var n=o.shift();!n.alias&&~J.indexOf(n.prop)&&o.push(i(i({},n),{alias:n.prop+"Async"})),Object.defineProperty(t,n.alias||n.prop,{get:function(){var i=this,o=1===n.cache,a=o&&this["__"+n.prop+"CacheValue"];if(!a){var s=G(),c=z(o),u=function i(){for(var o,a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return void 0!==n.caller?e(o={objId:z()},r[n.caller],r):o={},U(i,o,"api.caller",{obj:i,args:a,parentObjId:t.objId,objId:o.objId,prop:n.prop},s),o};return u.objId=-1,void 0!==n.getter&&(u.objId=c,e(u,r[n.getter],r)),U(t,u,"api.getter",{parentObjId:t.objId,objId:u.objId,prop:n.prop},s,(function(){delete i["__"+n.prop+"CacheValue"]})),o&&(this["__"+n.prop+"CacheValue"]=u),u}return a},set:function(e){var r=G();return U(t,{},"api.setter",{value:e,parentObjId:t.objId,objId:-1,prop:n.prop},r)}})};o.length;)a()}(o={objId:z()},r[n.caller],r):o={},U(e,o,"api.caller",{obj:e,args:a,parentObjId:t.objId,objId:o.objId,prop:n.prop},c),o};return l.objId=-1,void 0!==n.getter&&(l.objId=u,e(l,r[n.getter],r)),U(t,l,"api.getter",{parentObjId:t.objId,objId:l.objId,prop:n.prop},c,(function(){delete o["__"+n.prop+"CacheValue"]})),a&&(this["__"+n.prop+"CacheValue"]=l),l}return s},set:function(e){var r=G();return U(t,{},"api.setter",{value:e,parentObjId:t.objId,objId:-1,prop:n.prop},r)}})};o.length;)a()}(h,f,p),h.Events=c,h.Enum=l,e.Enum=h.Enum,e.Events=h.Events,e.Props=d,L(e.url)){case u.writer:e.WordApplication=e.WpsApplication=function(){return h};break;case u.spreadsheet:e.ExcelApplication=e.EtApplication=function(){return h};break;case u.presentation:e.PPTApplication=e.WppApplication=function(){return h};break;case u.pdf:e.PDFApplication=function(){return h}}e.Application=h,e.Free=function(e){return T("api.free",{objId:e},"")},e.Stack=h.Stack=(n=function(t){e&&e.Free(t)},function(){var e=[],t=function(t){e.push(t)};return V.add(t),{End:function(){n(e),V.delete(t)}}});var v={};s.add((function(e){return o(r,void 0,void 0,(function(){var t,n,r,i,o;return a(this,(function(a){switch(a.label){case 0:return b(e)?[2]:"api.event"===(t=s.parse(e.data)).eventName&&t.data?(n=t.data,r=n.eventName,i=n.data,(o=v[r])?[4,o(i)]:[3,2]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))})),h.Sub={};var m=function(e){var t=c[e];Object.defineProperty(h.Sub,t,{set:function(e){W(),v[t]=e,A({eventName:"api.event.register",data:{eventName:t,register:!!e,objId:H+=1}})}})};for(var g in c)m(g)}var J=["ExportAsFixedFormat","GetOperatorsInfo","ImportDataIntoFields","ReplaceText","ReplaceBookmark","GetBookmarkText","GetComments"];function U(e,t,n,r,i,o){var a,s=(e.done?e.done():Promise.resolve()).then((function(){return a||(a=T(n,r,i,o)),a}));t.done=function(){return s},t.then=function(e,n){return r.objId>=0?(t.then=null,t.catch=null,s.then((function(){e(t)})).catch((function(e){return n(e)}))):s.then(e,n)},t.catch=function(e){return s.catch(e)},t.Destroy=function(){return T("api.free",{objId:t.objId},"")}}var K={},$=null,Y={fileOpen:"fileOpen",tabSwitch:"tabSwitch",fileSaved:"fileSaved",fileStatus:"fileStatus",fullscreenChange:"fullscreenChange",error:"error",stage:"stage"},Z={getToken:"api.getToken",onToast:"event.toast",onHyperLinkOpen:"event.hyperLinkOpen",getClipboardData:"api.getClipboardData"};function X(e,t,n,r,c,u,l){var d=this;void 0===n&&(n={}),s.add((function(f){return o(d,void 0,void 0,(function(){var o,d,p,h,v,m,g,y,w,k,x,I,E,O,S,C,j,T,R;return a(this,(function(a){switch(a.label){case 0:return b(f)?[2]:(o=s.parse(f.data),d=o.eventName,p=void 0===d?"":d,h=o.data,v=void 0===h?null:h,m=o.url,g=void 0===m?null:m,-1!==["wps.jssdk.api"].indexOf(p)?[2]:"ready"!==p?[3,1]:(c.apiReadySended&&function(e){var t=[];Object.keys(K).forEach((function(n){K[n].forEach((function(r){var i=n;e.off(i,r),t.push({handle:r,eventName:i})})),delete K[n]})),t.forEach((function(e){var t=e.eventName,n=e.handle;null==$||$.ApiEvent.AddApiEventListener(t,n)}))}(t),A({eventName:"setConfig",data:i(i({},n),{version:e.version})}),e.tokenData&&e.setToken(i(i({},e.tokenData),{hasRefreshTokenConfig:!!n.refreshToken})),e.iframeReady=!0,[3,15]));case 1:return"error"!==p?[3,2]:(t.emit(Y.error,v),[3,15]);case 2:return"open.result"!==p?[3,3]:(void 0!==(null===(j=null==v?void 0:v.fileInfo)||void 0===j?void 0:j.officeVersion)&&(e.mainVersion=v.fileInfo.officeVersion,e.mainVersion),t.emit(Y.fileOpen,v),[3,15]);case 3:return"api.scroll"!==p?[3,4]:(window.scrollTo(v.x,v.y),[3,15]);case 4:if(p!==Z.getToken)return[3,9];y={token:!1},a.label=5;case 5:return a.trys.push([5,7,,8]),[4,c.refreshToken()];case 6:return y=a.sent(),[3,8];case 7:return w=a.sent(),console.error("refreshToken: "+(w||"fail to get")),[3,8];case 8:return A({eventName:Z.getToken+".reply",data:y}),[3,15];case 9:if(p!==Z.getClipboardData)return[3,14];k={text:"",html:""},a.label=10;case 10:return a.trys.push([10,12,,13]),[4,c.getClipboardData()];case 11:return k=a.sent(),[3,13];case 12:return x=a.sent(),console.error("getClipboardData: "+(x||"fail to get")),[3,13];case 13:return A({eventName:Z.getClipboardData+".reply",data:k}),[3,15];case 14:p===Z.onToast?c.onToast(v):p===Z.onHyperLinkOpen?c.onHyperLinkOpen(v):"stage"===p?t.emit(Y.stage,v):"event.callback"===p?(I=v.eventName,E=v.data,O=I,"fullScreenChange"===I&&(O=Y.fullscreenChange),"file.saved"===I&&(O=Y.fileStatus),((null===(T=n.commonOptions)||void 0===T?void 0:T.isBrowserViewFullscreen)||(null===(R=n.commonOptions)||void 0===R?void 0:R.isParentFullscreen))&&"fullscreenchange"===O&&(S=E.status,C=E.isDispatchEvent,n.commonOptions.isBrowserViewFullscreen?function(e,t,n,r){0===e?t.style="position: static; width: "+n.width+"; height: "+n.height:1===e&&(t.style="position: absolute; width: 100%; height: 100%"),r&&function(e){["fullscreen","fullscreenElement"].forEach((function(t){Object.defineProperty(document,t,{get:function(){return!!e.status},configurable:!0})}));var t=new CustomEvent("fullscreenchange");document.dispatchEvent(t)}({status:e})}(S,u,l,C):n.commonOptions.isParentFullscreen&&function(e,t,n){var r=document.querySelector(n),i=r&&1===r.nodeType?r:t;if(0===e){var o=document;(o.exitFullscreen||o.mozCancelFullScreen||o.msExitFullscreen||o.webkitCancelFullScreen||o.webkitExitFullscreen).call(document)}else if(1===e){(i.requestFullscreen||i.mozRequestFullScreen||i.msRequestFullscreen||i.webkitRequestFullscreen).call(i)}}(S,u,n.commonOptions.isParentFullscreen)),t.emit(O,E)):"api.ready"===p&&q(e,v),a.label=15;case 15:return"function"==typeof r[p]&&r[p](e,g||v),[2]}}))}))}))}function Q(e){return new Promise((function(t){s.add((function n(r){b(r)||s.parse(r.data).eventName===e&&(t(),s.remove(n))}))}))}function ee(e){var t,n=this;void 0===e&&(e={}),$&&$.destroy();try{var r=D(e),i=r.subscriptions,u=void 0===i?{}:i,l=r.mount,d=void 0===l?null:l,f=r.url,p=r.refreshToken,h=r.onToast,m=r.onHyperLinkOpen,b=r.getClipboardData;v("origin",(f.match(/https*:\/\/[^\/]+/g)||[])[0]);var g=x(f,d),y=Q("ready"),w=Q("open.result"),k=Q("api.ready"),I=d?{width:d.clientWidth+"px",height:d.clientHeight+"px"}:{width:"100vw",height:"100vh"};delete r.mount,f&&delete r.url,delete r.subscriptions;var S=(t=t||Object.create(null),{on:function(e,n){(t[e]||(t[e]=[])).push(n)},off:function(e,n){t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)},emit:function(e,n){(t[e]||[]).slice().map((function(e){e(n)})),(t["*"]||[]).slice().map((function(t){t(e,n)}))}}),C={apiReadySended:!1},j=function(e,t,r){return o(n,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return function(e,t,n){if(K[e]){var r=!!K[e].find((function(e){return e===t}));return r&&"off"===n?(S.off(e,t),K[e]=K[e].filter((function(e){return e!==t})),!!K[e].length||(K[e]=void 0,!1)):(r||"on"!==n||(K[e].push(t),S.on(e,t)),!0)}return"on"===n?(K[e]=[],K[e].push(t),!1):"off"===n||void 0}(e,t,r)?[3,2]:[4,y];case 1:n.sent(),function(e,t){var n=e.eventName,r=e.type,i=e.handle;"on"===t?S.on(n,i):S.off(n,i),"base.event"===r&&A({eventName:"basic.event",data:{eventName:n,action:t}}),W()}(function(e,t){var n=e,r="base.event";switch(n){case Y.fileSaved:console.warn("fileSaved事件监听即将弃用， 推荐使用fileStatus进行文件状态的监听"),n="fileStatus";break;case Y.fullscreenChange:n="fullscreenchange";break;case"error":case"fileOpen":r="callback.event"}return{eventName:n,type:r,handle:t}}(e,t),r),n.label=2;case 2:return[2]}}))}))};return $={url:f,iframe:g,version:"1.1.19",iframeReady:!1,tokenData:null,commandBars:null,tabs:{getTabs:function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,y];case 1:return e.sent(),[2,O({api:"tab.getTabs"})]}}))}))},switchTab:function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,y];case 1:return t.sent(),[2,O({api:"tab.switchTab",args:{tabKey:e}})]}}))}))}},setCooperUserColor:function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,y];case 1:return t.sent(),[2,O({api:"setCooperUserColor",args:e})]}}))}))},setToken:function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,y];case 1:return t.sent(),$.tokenData=e,A({eventName:"setToken",data:e}),[2]}}))}))},ready:function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return C.apiReadySended?[3,2]:[4,w];case 1:e.sent(),C.apiReadySended=!0,A({eventName:"api.ready"}),e.label=2;case 2:return[4,k];case 3:return e.sent(),[2,new Promise((function(e){return setTimeout((function(){return e(null==$?void 0:$.Application)}),0)}))]}}))}))},destroy:function(){g.destroy(),s.empty(),$=null,V=new Set,H=0,document.removeEventListener("fullscreenchange",B),M()},save:function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,y];case 1:return e.sent(),[2,E({api:"save"})]}}))}))},setCommandBars:function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,y];case 1:return t.sent(),P(e),[2]}}))}))},updateConfig:function(e){return void 0===e&&(e={}),o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,y];case 1:return t.sent(),e.commandBars?(console.warn("Deprecated: `updateConfig()` 方法即将废弃，请使用`setCommandBars()`代替`updateConfig()`更新`commandBars`配置。"),[4,P(e.commandBars)]):[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},executeCommandBar:function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,y];case 1:return t.sent(),P([{cmbId:e,attributes:[{name:"click",value:!0}]}]),[2]}}))}))},on:function(e,t){return o(this,void 0,void 0,(function(){return a(this,(function(n){return[2,this.ApiEvent.AddApiEventListener(e,t)]}))}))},off:function(e,t){return o(this,void 0,void 0,(function(){return a(this,(function(n){return[2,this.ApiEvent.RemoveApiEventListener(e,t)]}))}))},ApiEvent:{AddApiEventListener:function(e,t){return o(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,j(e,t,"on")];case 1:return[2,n.sent()]}}))}))},RemoveApiEventListener:function(e,t){return o(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,j(e,t,"off")];case 1:return[2,n.sent()]}}))}))}}},function(e,t,n,r,i,o){t&&c(t)&&(i.refreshToken=t,e.refreshToken={eventName:Z.getToken}),o&&c(o)&&(i.getClipboardData=o,e.getClipboardData={eventName:Z.getClipboardData}),n&&c(n)&&(i.onToast=n,e.onToast={eventName:Z.onToast}),r&&c(r)&&(i.onHyperLinkOpen=r,e.onHyperLinkOpen={eventName:Z.onHyperLinkOpen})}(r,p,h,m,C,b),X($,S,r,u,C,g,I),$}catch(e){console.error(e)}}var te=Object.freeze({__proto__:null,listener:X,config:ee});window.WPS=te;t.config=ee,t.default={config:ee}},517876:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(201364),n(697060),n(22588),n(505684),n(743924),n(885612),n(976896),n(431480),n(443896),n(708896),n(606200),n(670864),n(880920),n(497448),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.docProtect=t.docCompare=t.deleteMark=t.delMark=t.close=t.cancelSelectionEditArea=t.callEditorFunction=t.addTextMark=t.addTableRows=t.addTableColumns=t.addMark=t.addCommentDialog=void 0,t.executeJsFunction=E,t.toggleShowTraces=t.showTracesByRole=t.setTrackingMode=t.setToolbars=t.setTitlebar=t.setTextAsTitle=t.setSelectionEditArea=t.setSelectionAsField=t.setMenubar=t.setDynamicTable=t.setDocUnLimitByRole=t.setDocUnLimit=t.setDocLimitByRole=t.setDocLimit=t.setDocAsField=t.setCheckBoxValue=t.setCaption=t.sendTextByField=t.sendOpenStatus=t.sendIsFieldRevise=t.sendIsDocChange=t.sendFieldExist=t.sendAllField=t.sendAllCheckBox=t.saveAsLocal=t.save=t.openNew=t.open=t.modifyMark=t.mergeDocs=t.locateMark=t.insertValue=t.insertPictures=void 0,n(9692),n(233696),n(443616),n(323784),n(693917),n(297336),n(721300),n(387912),n(571176),n(633768),n(125048),n(660824),n(218080),n(513640),n(997308),n(51704);var i=n(211152),o=n(218652),a=n(331428),s=n(399588),c=n(325648),u=n(545072),l=n(589200);function d(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=p(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(){v=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),s=new D(r||[]);return o(a,"_invoke",{value:C(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",h="suspendedYield",m="executing",b="completed",g={};function y(){}function w(){}function k(){}var x={};l(x,s,(function(){return this}));var A=Object.getPrototypeOf,I=A&&A(A(L([])));I&&I!==n&&i.call(I,s)&&(x=I);var E=k.prototype=y.prototype=Object.create(x);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(o,a,s,c){var u=f(e[o],e,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return a=a?a.then(i,i):i()}})}function C(t,n,r){var i=p;return function(o,a){if(i===m)throw new Error("Generator is already running");if(i===b){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var c=j(s,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=b,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=m;var u=f(t,n,r);if("normal"===u.type){if(i=r.done?b:h,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=b,r.method="throw",r.arg=u.arg)}}}function j(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=f(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(i.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(r(t)+" is not iterable")}return w.prototype=k,o(E,"constructor",{value:k,configurable:!0}),o(k,"constructor",{value:w,configurable:!0}),w.displayName=l(k,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},O(S.prototype),l(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new S(d(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(E),l(E,u,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:L(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function m(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){m(o,r,i,a,s,"next",e)}function s(e){m(o,r,i,a,s,"throw",e)}a(void 0)}))}}t.setTitlebar=function(e,t){return function(e){}},t.setToolbars=function(e,t,n){var r=t.value;["TabPrintPreview","HeaderLeft","HeaderMiddle","HeaderRight","HistoryRecord","HistoryVersion","MenuPrintPreview","HeaderHistoryMenuBtn","PreviewDownload","MoreMenus","ShareLink"].forEach((function(t){e.CommandBars(t).Visible=r}))},t.setMenubar=function(e,t,n){var r=t.value;["StartTab","InsertTab","ReviewTab","PageTab","TabStartTab","TabInsertTab","TabPageTab","TabReviewWord"].forEach((function(t){e.CommandBars(t).Visible=r}))},t.setCaption=function(e,t){return function(e){}},t.open=function(){return function(e){}},t.openNew=function(e,t){return function(e){}},t.save=function(){var e=b(v().mark((function e(t){var n,r,s=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2?s[2]:void 0,e.next=4,t.ActiveDocument.Save();case 4:"ok"!==(r=e.sent).result&&"nochange"===r.result&&n.showNoChangeTip&&(0,o.setDataMessages)((0,o.getRootPageId)()((0,i.getGlobalState)()),[{duration:3e3,content:(0,a.getLangMsg)({key:"webOffice.key0021"}),type:u.AlertType.WARNING}]);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.close=function(e,t){return function(e){}},t.insertValue=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.length>2?s[2]:void 0,r=(n=s.length>1&&void 0!==s[1]?s[1]:{}).needEnterBefore,i=n.value,o="",r&&(o="\r\n"),a=o.concat(i),e.next=8,t.ActiveDocument.ActiveWindow.Selection.InsertAfter({Text:a});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.addCommentDialog=function(){var e=b(v().mark((function e(t){var n,r,i,o,a=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.length>1&&void 0!==a[1]?a[1]:{},a.length>2?a[2]:void 0,e.next=4,t.ActiveDocument.ActiveWindow.Selection;case 4:return n=e.sent,e.next=7,n.Range;case 7:return r=e.sent,e.next=10,r.Start;case 10:return i=e.sent,e.next=13,r.End;case 13:return o=e.sent,e.next=16,t.ActiveDocument.Comments.Add({Range:{Start:i,End:o},Text:"TODO"});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.docCompare=function(){return function(e){}},t.addMark=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c,u=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},u.length>2?u[2]:void 0,e.next=4,t.ActiveDocument.ActiveWindow.Selection;case 4:return r=e.sent,e.next=7,r.Range;case 7:return i=e.sent,e.next=10,t.ActiveDocument.Bookmarks;case 10:return o=e.sent,a=n.value,s=n.field,e.next=14,r.InsertAfter(a);case 14:return e.next=16,i.Start;case 16:return c=e.sent,e.next=19,o.Add({Name:s,Range:{Start:c,End:c+a.length}});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.modifyMark=function(){var e=b(v().mark((function e(t){var n,r,i=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:[],i.length>2?i[2]:void 0,Array.isArray(n)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t.ActiveDocument.Bookmarks;case 6:r=e.sent,n.forEach(function(){var e=b(v().mark((function e(t){var n,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.field,i=t.value,e.next=3,r.Exists(n);case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,r.ReplaceBookmark([{name:n,type:"text",value:i}]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.deleteMark=function(){var e=b(v().mark((function e(t){var n,r,i=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:[],i.length>2?i[2]:void 0,Array.isArray(n)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t.ActiveDocument.Bookmarks;case 6:r=e.sent,n.forEach(function(){var e=b(v().mark((function e(n){var i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.field,e.next=3,r.Exists(i);case 3:if(!e.sent){e.next=10;break}return e.next=6,r.Item(i).Select();case 6:return e.next=8,t.ActiveDocument.ActiveWindow.Selection.Delete(1);case 8:return e.next=10,r.Item(i).Delete();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.locateMark=function(){var e=b(v().mark((function e(t){var n,r,i=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.length>2?i[2]:void 0,n=(i.length>1&&void 0!==i[1]?i[1]:{}).field,e.next=5,t.ActiveDocument.Bookmarks;case 5:return r=e.sent,e.next=8,r.Exists(n);case 8:if(e.sent){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,r.Item(n).Select();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.docProtect=function(){var e=b(v().mark((function e(t){var n,r,i=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.length>2?i[2]:void 0,(n=i.length>1&&void 0!==i[1]?i[1]:{}).isProtect,n.protectType,r=n.password,e.next=5,t.ActiveDocument.Protect(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.setDocLimit=function(){var e=b(v().mark((function e(t){var n,r=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2?r[2]:void 0,n=(r.length>1&&void 0!==r[1]?r[1]:{}).password,e.prev=3,e.next=6,t.ActiveDocument.Protect(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error("setDocLimit 指令执行失败",e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),t.setDocUnLimit=function(){var e=b(v().mark((function e(t){var n,r=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2?r[2]:void 0,n=(r.length>1&&void 0!==r[1]?r[1]:{}).password,e.next=5,t.ActiveDocument.Unprotect(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.setSelectionEditArea=function(){var e=b(v().mark((function e(t){var n,r,i,o,a=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.length>2?a[2]:void 0,n=(a.length>1&&void 0!==a[1]?a[1]:{}).field,e.next=5,t.ActiveDocument.Bookmarks;case 5:return r=e.sent,e.next=8,t.ActiveDocument.ActiveWindow.Selection;case 8:return i=e.sent,e.next=11,i.Range;case 11:o=e.sent,r.Add(n,o);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.cancelSelectionEditArea=function(){var e=b(v().mark((function e(t){var n,r=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2?r[2]:void 0,n=(r.length>1&&void 0!==r[1]?r[1]:{}).field,e.next=5,t.ActiveDocument.Bookmarks.Item(n).Delete();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.setDocLimitByRole=function(){var e=b(v().mark((function e(t){var n=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.length>1&&void 0!==n[1]?n[1]:{},n.length>2?n[2]:void 0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.setDocUnLimitByRole=function(e,t){return function(e){}},t.sendTextByField=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=(s.length>2?s[2]:void 0).sendValidResult,i=n.field,o=n.id,e.next=6,t.ActiveDocument.Bookmarks.GetBookmarkText(i);case 6:a=e.sent,r([{data:{result:a,field:i},id:o,type:"getTextByField"}]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendIsFieldRevise=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c,u,l,d,f,p,h,m,b,g=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.length>1&&void 0!==g[1]?g[1]:{},i=(r=g.length>2?g[2]:void 0).sendValidResult,r.model,o=n.field,a=n.id,e.next=6,t.ActiveDocument.Bookmarks;case 6:return s=e.sent,e.next=9,s.Item(o).Range;case 9:if(c=e.sent,u=!1,!c){e.next=30;break}return e.next=14,c.Start;case 14:return l=e.sent,e.next=17,c.End;case 17:return d=e.sent,e.next=20,t.ActiveDocument.Revisions.Json();case 20:f=e.sent,p=0;case 22:if(!(p<f.length)){e.next=30;break}if(h=f[p],m=h.begin,b=h.end,l!==m||d!==b){e.next=27;break}return u=!0,e.abrupt("break",30);case 27:p++,e.next=22;break;case 30:i([{data:{result:u,field:o},id:a,type:"isFieldRevise"}]);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendFieldExist=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{},i=(r=c.length>2?c[2]:void 0).sendValidResult,r.model,o=n.field,a=n.id,e.next=6,t.ActiveDocument.Bookmarks.Exists(o);case 6:s=e.sent,i([{data:{result:s,field:o},id:a,type:"fieldExist"}]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendAllField=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{},r=(c.length>2?c[2]:void 0).sendValidResult,e.next=5,t.ActiveDocument.Bookmarks.Json();case 5:for(i=e.sent,o=[],a=0;a<i.length;a++)o.push(i[a].name);s=n.id,r([{data:o,id:s,type:"allField"}]);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendIsDocChange=function(e,t,n){(0,n.sendValidResult)([{data:!0,id:t.id,type:"isDocChange"}])},t.setTrackingMode=function(){var e=b(v().mark((function e(t){var n,r,i=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.length>2?i[2]:void 0,(n=i.length>1&&void 0!==i[1]?i[1]:{}).userName,1!==(r=n.trackType)){e.next=7;break}t.ActiveDocument.TrackRevisions=!0,e.next=14;break;case 7:if(0!==r){e.next=11;break}t.ActiveDocument.TrackRevisions=!1,e.next=14;break;case 11:if(4!==r){e.next=14;break}return e.next=14,t.ActiveDocument.AcceptAllRevisionsShown();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.toggleShowTraces=function(){var e=b(v().mark((function e(t){var n,r,i=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.length>1&&void 0!==i[1]?i[1]:{},i.length>2?i[2]:void 0,e.next=4,t.ActiveDocument.ActiveWindow.View.Reviewers.Count;case 4:n=e.sent,r=1;case 6:if(!(r<=n)){e.next=14;break}return e.next=9,t.ActiveDocument.ActiveWindow.View.Reviewers.Item(r);case 9:e.sent.Visible=!0;case 11:r++,e.next=6;break;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.showTracesByRole=function(){var e=b(v().mark((function e(t){var n,r,i,s,c,l,d,f,p=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>2?p[2]:void 0,i=(n=p.length>1&&void 0!==p[1]?p[1]:{}).userName,s=n.isShow,c=r.model.pageId,e.prev=4,e.next=7,t.ActiveDocument.View.Reviewers.Count;case 7:l=e.sent,d=1;case 9:if(!(d<=l)){e.next=20;break}return e.next=12,t.ActiveDocument.View.Reviewers.Item(d);case 12:return f=e.sent,e.next=15,f.Author;case 15:e.sent===i&&(f.Visible=s);case 17:d++,e.next=9;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(4),console.error("showTracesByRole 指令执行失败",e.t0),(0,o.setDataMessages)(c,{content:(0,a.getLangMsg)({key:"webOffice.key0011",variables:{userName:i}}),type:u.AlertType.ERROR});case 26:case"end":return e.stop()}}),e,null,[[4,22]])})));return function(t){return e.apply(this,arguments)}}(),t.setDynamicTable=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c,u,d,p,h,m,g,y=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.length>2?y[2]:void 0,r=(n=y.length>1&&void 0!==y[1]?y[1]:{}).tableSize,i=n.field,o=n.tableData,a=r.row,s=r.column,e.next=6,t.ActiveDocument.Bookmarks.Exists(i);case 6:if(!(c=e.sent)){e.next=13;break}return e.next=10,t.ActiveDocument.Bookmarks.Item(i).Range;case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,t.ActiveDocument.ActiveWindow.Selection.Range;case 15:e.t0=e.sent;case 16:return u=e.t0,e.next=19,u.Start;case 19:return d=e.sent,e.next=22,u.End;case 22:if(p=e.sent,!c){e.next=28;break}return e.next=26,t.ActiveDocument.Range.SetRange(d,p);case 26:return e.next=28,t.ActiveDocument.ActiveWindow.Selection.Delete(1);case 28:return e.next=30,t.ActiveDocument.Range(d,d);case 30:return h=e.sent,e.next=33,t.ActiveDocument.Tables.Add(h,a,s,1,2);case 33:if(m=e.sent,g=function(){var e=b(v().mark((function e(){var n,r,a,s,c,u;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=f(o),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}return a=r.value,e.next=7,m.Rows.Item(a.row).Cells.Item(a.column).Range;case 7:e.sent.Text=a.value;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:return e.next=21,m.Range;case 21:return s=e.sent,e.next=24,s.Start;case 24:return c=e.sent,e.next=27,s.End;case 27:return u=e.sent,e.next=30,t.ActiveDocument.Bookmarks.Add({Name:i,Range:{Start:c,End:u}});case 30:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})));return function(){return e.apply(this,arguments)}}(),"ie"===(0,l.getBrowserData)()){e.next=39;break}queueMicrotask(b(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:case"end":return e.stop()}}),e)})))),e.next=41;break;case 39:return e.next=41,g();case 41:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var g=function(e){return e.Rows.Count},y=function(e){return e.Columns.Count},w=function(e,t,n){for(var r=g(e),i=y(e),o=[],a=0;a<t;a++)for(var s=0;s<i;s++){var c={row:r+a+1,column:s+1,value:n[a][s]};o.push(c)}return o},k=function(e,t,n){for(var r=g(e),i=y(e),o=[],a=0;a<t;a++)for(var s=0;s<r;s++){var c={row:s+1,column:i+a+1,value:n[a][s]};o.push(c)}return o},x=(t.addTableRows=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c,u=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>2?u[2]:void 0,r=(n=u.length>1&&void 0!==u[1]?u[1]:{}).field,i=n.newRowsData,o=n.newRows,e.next=5,t.ActiveDocument.Bookmarks.Exists(r);case 5:if(!e.sent){e.next=12;break}return e.next=9,t.ActiveDocument.Bookmarks.Item(r).Select();case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,t.ActiveDocument.Tables.Item(1);case 14:e.t0=e.sent;case 15:for(a=e.t0,s=w(a,o,i),c=1;c<=o;c++)a.Rows.Add();s.forEach((function(e){a.Rows.Item(e.row).Cells.Item(e.column).Range.Text=e.value}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.addTableColumns=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c,u=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>2?u[2]:void 0,r=(n=u.length>1&&void 0!==u[1]?u[1]:{}).field,i=n.newColumnsData,o=n.newColumns,e.next=5,t.ActiveDocument.Bookmarks.Exists(r);case 5:if(!e.sent){e.next=12;break}return e.next=9,t.ActiveDocument.Bookmarks.Item(r).Select();case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,t.ActiveDocument.Tables.Item(1);case 14:e.t0=e.sent;case 15:for(a=e.t0,s=k(a,o,i),c=1;c<=o;c++)a.Columns.Add();s.forEach((function(e){a.Rows.Item(e.row).Cells.Item(e.column).Range.Text=e.value}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.mergeDocs=function(e,t){return function(e){}},t.setSelectionAsField=function(){var e=b(v().mark((function e(t){var n,r,i,o,a=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.length>2?a[2]:void 0,n=(a.length>1&&void 0!==a[1]?a[1]:{}).field,e.next=5,t.ActiveDocument.ActiveWindow.Selection.Range;case 5:return r=e.sent,e.next=8,r.Start;case 8:return i=e.sent,e.next=11,r.End;case 11:return o=e.sent,e.next=14,t.ActiveDocument.Bookmarks.Add({Name:n,Range:{Start:i,End:o}});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.setDocAsField=function(){var e=b(v().mark((function e(t){var n,r,i,o,a=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.length>2?a[2]:void 0,n=(a.length>1&&void 0!==a[1]?a[1]:{}).field,e.next=5,t.ActiveDocument.Range;case 5:return r=e.sent,e.next=8,r.Start;case 8:return i=e.sent,e.next=11,r.End;case 11:return o=e.sent,e.next=14,t.ActiveDocument.Bookmarks.Add({Name:n,Range:{Start:i,End:o}});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),function(){var e=b(v().mark((function e(t){var n,r,i,o,s,c,u;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r={title:"",id:""},e.next=4,t.ActiveDocument.ContentControls.Count;case 4:i=e.sent,o=1;case 6:if(!(o<=i)){e.next=17;break}return e.next=9,t.ActiveDocument.ContentControls.Item(o).ID;case 9:s=e.sent,c=t.ActiveDocument.ContentControls.Item(o).Checked,u=t.ActiveDocument.ContentControls.Item(o).Title||(0,a.getLangMsg)({key:"webOffice.key0014"}),r={id:s,value:c,title:u},n.push(r);case 14:o++,e.next=6;break;case 17:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),A=(t.sendAllCheckBox=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},i=(r=s.length>2?s[2]:void 0).sendValidResult,r.model,e.next=5,x(t);case 5:o=e.sent,a=n.id,i([{data:o,id:a,type:"allCheckBox"}]);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.sendOpenStatus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=n.sendValidResult;n.model;r([{data:!0,id:t.id,type:"openStatus"}])},t.setCheckBoxValue=function(e,t){return function(e){}},t.setTextAsTitle=function(){var e=b(v().mark((function e(t){var n,r,i,o,a=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.length>2?a[2]:void 0,r=(n=a.length>1&&void 0!==a[1]?a[1]:{}).field,n.style,e.next=5,t.ActiveDocument.Bookmarks.Exists(r);case 5:if(!e.sent){e.next=9;break}return e.next=9,t.ActiveDocument.Bookmarks.Item(r).Select();case 9:return e.next=11,t.ActiveDocument.ActiveWindow.Selection.Range;case 11:return i=e.sent,e.next=14,i.Font;case 14:(o=e.sent).Size=22,o.Bold=!0;case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.saveAsLocal=function(e,t){return function(e){e.showdialog(3)}},t.insertPictures=function(){var e=b(v().mark((function e(t){var n=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.length>2?n[2]:void 0,(n.length>1&&void 0!==n[1]?n[1]:{}).data.forEach(function(){var e=b(v().mark((function e(n){var r,i,o,a,s,c,u;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.imageUrl,i=n.field,o=n.imageStyle,e.next=3,t.ActiveDocument.Bookmarks.Exists(i);case 3:if(!e.sent){e.next=19;break}return e.next=7,t.ActiveDocument.Bookmarks.Item(i);case 7:return a=e.sent,e.next=10,a.Start;case 10:return s=e.sent,e.next=13,a.End;case 13:return c=e.sent,e.next=16,t.ActiveDocument.Application.Selection.InlineShapes.AddPicture({FileName:r,LinkToFile:!1,SaveWithDocument:!1,Range:{Start:s,End:c}});case 16:(u=e.sent).Width=o.width,u.Height=o.height;case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.addTextMark=function(){var e=b(v().mark((function e(t){var n,r,i,o=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},o.length>2?o[2]:void 0,r=function(e,t){return null==e||"number"!=typeof e?t:e},e.next=5,t.ActiveDocument.Sections.Item(1).WaterMarks;case 5:return i=e.sent,e.next=8,i.AddTextWaterMark({Text:n.text||(0,a.getLangMsg)({key:"webOffice.key0023"}),FontName:n.fontFamily||(0,a.getLangMsg)({key:"webOffice.key0024"}),FontSize:n.fontSize||120,FontColor:(0,s.HEX2Demical)(n.fontColor)||"#C0C0C0",Transparency:r(n.transparency,0),Gradient:r(n.rotation,0),ApplyTo:1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.delMark=function(){var e=b(v().mark((function e(t){var n=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.length>1&&void 0!==n[1]?n[1]:{},n.length>2?n[2]:void 0,e.next=4,t.ActiveDocument.Sections.Item(1).WaterMarks;case 4:e.sent.DeleteWaterMark();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c.OfficeEditMode.PublicWps),I=c.OfficeEditMode.PrivateWps;t.callEditorFunction=function(){var e=b(v().mark((function e(t){var n,r,i,o,a,s,c,u,l,p,h,m,b,g,y,w,k,x,O,S,C,j,T,R,D=arguments;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=D.length>2?D[2]:void 0,i=(n=D.length>1&&void 0!==D[1]?D[1]:{}).methods,o=n.editorType,a=n.functions,[A,I].includes(o)){e.next=5;break}return e.abrupt("return");case 5:if(s=t,!i){e.next=49;break}c=f(i),e.prev=8,c.s();case 10:if((u=c.n()).done){e.next=41;break}l=u.value,p=l.params,h=l.func,m=l.id,b=h.split("."),g=0;case 14:if(!(g<b.length)){e.next=39;break}if(y=b[g],w=!1,k="",/(\w+)\((\$\d+)?\)/.test(y)&&(x=y.match(/(\w+)\((\$\d+)?\)/),y=x[1],k=x[2],w=!0),!w&&g!==b.length-1){e.next=32;break}if(!k){e.next=26;break}return e.next=23,(O=s)[y].apply(O,d(p[k]));case 23:e.t0=e.sent,e.next=29;break;case 26:return e.next=28,s[y]();case 28:e.t0=e.sent;case 29:s=e.t0,e.next=35;break;case 32:return e.next=34,s[y];case 34:s=e.sent;case 35:m&&s&&(null==r||null===(S=r.sendValidResult)||void 0===S||S.call(r,[{data:{result:s},id:m,type:"getEditorResult"}]));case 36:g++,e.next=14;break;case 39:e.next=10;break;case 41:e.next=46;break;case 43:e.prev=43,e.t1=e.catch(8),c.e(e.t1);case 46:return e.prev=46,c.f(),e.finish(46);case 49:if(!a){e.next=68;break}C=null!=r&&r.sendValidResult?r.sendValidResult:function(){},j=f(a),e.prev=52,j.s();case 54:if((T=j.n()).done){e.next=60;break}return R=T.value,e.next=58,E(R,t,C);case 58:e.next=54;break;case 60:e.next=65;break;case 62:e.prev=62,e.t2=e.catch(52),j.e(e.t2);case 65:return e.prev=65,j.f(),e.finish(65);case 68:case"end":return e.stop()}}),e,null,[[8,43,46,49],[52,62,65,68]])})));return function(t){return e.apply(this,arguments)}}();function E(e,t,n){return O.apply(this,arguments)}function O(){return O=b(v().mark((function e(t,n,r){var i,o=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:try{i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.length?t[t.length-1]:"",i=t.length?t.slice(0,t.length-1):[];return"ie"!==(0,l.getBrowserData)()?new Function("return async function(".concat(i,"){").concat(r,"}")).bind(o)():new Function("return function(".concat(i,"){return Promise.resolve().then(function() {").concat(r,"})}")).bind(o)()},new i("app","sendResult","".concat(t))(n,r)}catch(e){console.error(e)}case 3:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}}}]);