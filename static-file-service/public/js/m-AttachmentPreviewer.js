"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[4414],{

/***/ "./src/page/AttachmentPreviewer.jsx":
/*!******************************************!*\
  !*** ./src/page/AttachmentPreviewer.jsx ***!
  \******************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.async-iterator.js */ \"../../node_modules/core-js/modules/es.symbol.async-iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-string-tag.js */ \"../../node_modules/core-js/modules/es.symbol.to-string-tag.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.reverse.js */ \"../../node_modules/core-js/modules/es.array.reverse.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.json.to-string-tag.js */ \"../../node_modules/core-js/modules/es.json.to-string-tag.js\");\n__webpack_require__(/*! core-js/modules/es.math.to-string-tag.js */ \"../../node_modules/core-js/modules/es.math.to-string-tag.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-properties.js */ \"../../node_modules/core-js/modules/es.object.define-properties.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptors.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptors.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.reflect.construct.js */ \"../../node_modules/core-js/modules/es.reflect.construct.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = exports.PreviewItem = void 0;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.join.js */ \"../../node_modules/core-js/modules/es.array.join.js\");\n__webpack_require__(/*! core-js/modules/es.array.splice.js */ \"../../node_modules/core-js/modules/es.array.splice.js\");\n__webpack_require__(/*! core-js/modules/es.function.bind.js */ \"../../node_modules/core-js/modules/es.function.bind.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.promise.js */ \"../../node_modules/core-js/modules/es.promise.js\");\n__webpack_require__(/*! core-js/modules/es.string.ends-with.js */ \"../../node_modules/core-js/modules/es.string.ends-with.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nvar _react = _interopRequireWildcard(__webpack_require__(/*! react */ \"webpack/sharing/consume/default/react/react?dca2\"));\nvar _reactDom = _interopRequireDefault(__webpack_require__(/*! react-dom */ \"webpack/sharing/consume/default/react-dom/react-dom?418d\"));\nvar _global = __webpack_require__(/*! @/global */ \"./src/global/index.js\");\nvar _clientApi = _interopRequireWildcard(__webpack_require__(/*! @/plugin/clientApi */ \"./src/plugin/clientApi.js\"));\nvar _Loading = _interopRequireDefault(__webpack_require__(/*! ./mobile/Loading */ \"./src/page/mobile/Loading.js\"));\nvar _pushCostomUrl = _interopRequireWildcard(__webpack_require__(/*! ../util/pushCostomUrl */ \"./src/util/pushCostomUrl.js\"));\nvar _formservice = _interopRequireDefault(__webpack_require__(/*! ../api/formservice */ \"./src/api/formservice.js\"));\nvar _intlApi = __webpack_require__(/*! ../i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _attaPreviewUtil = __webpack_require__(/*! ../util/attaPreviewUtil */ \"./src/util/attaPreviewUtil.js\");\nvar _attachmentConst = __webpack_require__(/*! @/constant/attachmentConst */ \"./src/constant/attachmentConst.js\");\nvar _clientEnv = _interopRequireWildcard(__webpack_require__(/*! ../plugin/clientEnv */ \"./src/plugin/clientEnv.js\"));\nvar _ImagePreview = _interopRequireDefault(__webpack_require__(/*! @/component/mobile/base/ImagePreview */ \"./src/component/mobile/base/ImagePreview.jsx\"));\nvar _webOfficeSdkV = _interopRequireDefault(__webpack_require__(/*! @/component/common/wps/web-office-sdk-v1.1.19.es */ \"./src/component/common/wps/web-office-sdk-v1.1.19.es.js\"));\nvar _toolUtils = __webpack_require__(/*! @/util/toolUtils */ \"./src/util/toolUtils.js\");\nvar _componentutil = __webpack_require__(/*! @/util/componentutil */ \"./src/util/componentutil.js\");\nvar _OnlyOfficePreviewer = _interopRequireDefault(__webpack_require__(/*! @/component/common/onlyoffice/OnlyOfficePreviewer */ \"./src/component/common/onlyoffice/OnlyOfficePreviewer.jsx\"));\nvar _ExcelViewer = _interopRequireDefault(__webpack_require__(/*! @/page/AttachmentPreviewer/ExcelViewer */ \"./src/page/AttachmentPreviewer/ExcelViewer.jsx\"));\nvar _console = _interopRequireDefault(__webpack_require__(/*! @/api/console */ \"./src/api/console.js\"));\nvar _excelZoom = _interopRequireDefault(__webpack_require__(/*! @/page/AttachmentPreviewerMob/excelZoom */ \"./src/page/AttachmentPreviewerMob/excelZoom.js\"));\nvar _attachmentUtils = __webpack_require__(/*! @/util/attachmentUtils */ \"./src/util/attachmentUtils.js\");\nvar _attachmentpanelaction = __webpack_require__(/*! @/action/attachmentpanelaction */ \"./src/action/attachmentpanelaction.js\");\nvar _SystemUIProvider = __webpack_require__(/*! @/page/SystemUIProvider */ \"./src/page/SystemUIProvider.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _AttachmentPreviewer2 = _interopRequireDefault(__webpack_require__(/*! ./AttachmentPreviewer.less */ \"./src/page/AttachmentPreviewer.less\"));\nvar _Toolbar = _interopRequireDefault(__webpack_require__(/*! @/page/AttachmentPreviewerMob/Toolbar */ \"./src/page/AttachmentPreviewerMob/Toolbar.js\"));\nvar _lodash = __webpack_require__(/*! lodash */ \"../../node_modules/lodash/lodash.js\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); } /**\n * 移动端附件预览\n *\n * 支持图片、word、ppt、excel、pdf 以及 txt\n * 音视频由于 audio/video 标签部分机型不支持，所以不支持预览\n */ // import ImageViewer from '@/component/mobile/base/ImageViewer/ImageViewer'\n// import WebOfficePreviewer from '@/component/common/wps/WebOfficePreviewer'f\nvar WebOfficePreviewer = /*#__PURE__*/_react[\"default\"].lazy(function () {\n  return Promise.all(/*! import() */[__webpack_require__.e(4074), __webpack_require__.e(4260), __webpack_require__.e(6604)]).then(__webpack_require__.bind(__webpack_require__, /*! @/component/common/wps/WebOfficePreviewer */ \"./src/component/common/wps/WebOfficePreviewer.jsx\"));\n});\nvar isWxworkClient = (_clientEnv[\"default\"].isWxWork || _clientEnv[\"default\"].isWx) && !(0, _clientEnv.isMobileDevice)(); // 企业微信／微信 桌面客户端\nvar AttachmentPreviewer = exports[\"default\"] = /*#__PURE__*/function (_Component) {\n  _inherits(AttachmentPreviewer, _Component);\n  function AttachmentPreviewer(props) {\n    var _this;\n    _classCallCheck(this, AttachmentPreviewer);\n    _this = _callSuper(this, AttachmentPreviewer, [props]);\n    _this.openNewTab = function () {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        activedIndex = _ref.activedIndex,\n        sortedUids = _ref.sortedUids,\n        pageId = _ref.pageId,\n        key = _ref.key,\n        curEntryRow = _ref.curEntryRow,\n        panelData = _ref.panelData,\n        requestParams = _ref.requestParams;\n      var args = [{\n        activedIndex: activedIndex,\n        sortedUids: sortedUids,\n        curEntryRow: curEntryRow,\n        panelData: panelData,\n        requestParams: requestParams\n      }];\n      var _model = {\n        pageId: pageId,\n        key: key\n      };\n      (0, _global.doGlobalDispatch)((0, _attachmentpanelaction.previewInNewTab)(_model, args));\n    };\n    /**\n     * 预览文件\n     *\n     * 1. 第三方 app 有 previewImage 接口的，调用其功能预览图片\n     * 2. 在云之家 App 中，调用云之家 api\n     * 3. 在云之家桌面端可预览的进行预览，不可预览的进行下载\n     *\n     * @param {object} data\n     */\n    _this.showAttachmentPreviewer = function (data) {\n      var file = _this.hasFileURL(data);\n      var previewUrl = file.previewUrl,\n        downloadUrl = file.downloadUrl,\n        fileExt = file.fileExt,\n        _file$urlList = file.urlList,\n        urlList = _file$urlList === void 0 ? [] : _file$urlList,\n        _file$isDownloadOnly = file.isDownloadOnly,\n        isDownloadOnly = _file$isDownloadOnly === void 0 ? false : _file$isDownloadOnly,\n        fileName = file.fileName,\n        _file$previewType = file.previewType,\n        previewType = _file$previewType === void 0 ? _attachmentConst.PreviewByDefault : _file$previewType,\n        localId = file.localId,\n        _file$visible = file.visible,\n        visible = _file$visible === void 0 ? '1111' : _file$visible,\n        appPreviewClose = file.appPreviewClose;\n      fileExt = fileExt && fileExt.toLowerCase();\n      var isYzjPreview = previewType === _attachmentConst.PreviewByYunZhiJia;\n      var isWpsPreview = previewType === _attachmentConst.PreviewByPublicWps || previewType === _attachmentConst.PreviewByPrivateWps;\n      var isYozoPreview = previewType === _attachmentConst.PreviewByYozo;\n      var isOnlyoffice = previewType === _attachmentConst.PreviewByOnlyOffice;\n      var previewByThirdApp = _attachmentConst.PREVIEW_FILE_TYPE.image.includes(fileExt) && (0, _clientApi.existAppFunction)('previewImage') && !window.closeYzjPreview;\n      // 云之家或者自定义预览方式是否使用默认预览\n      var isCustomPreviewUseDefaultType = (0, _attachmentUtils.getIsCustomPreviewUseDefaultType)(previewType, fileExt);\n      _this.isYzjEnv = _clientEnv[\"default\"].isYzj && !appPreviewClose && !window.closeYzjPreview;\n      var isOpenNewTab = (0, _attachmentUtils.getIsOpenNewTab)() && file.sortedUids;\n      if (isOpenNewTab) {\n        return _this.openNewTab(file);\n      }\n      // 经过和产品沟通，在云之家app中，图片和视频类型的文件，不受appPreviewClose控制，直接调用云之家的预览api\n      if (previewByThirdApp && !isWxworkClient && !isDownloadOnly && (!isYzjPreview && !(0, _attachmentUtils.isPreviewByCustom)(fileExt) || isCustomPreviewUseDefaultType || _clientEnv[\"default\"].isYzj) && previewUrl && visible[0] === '1') {\n        // 开启预览参数 + 有预览按钮的自定义权限才能在app里直接预览\n        var imgurl = (isYzjPreview || (0, _attachmentUtils.isPreviewByCustom)(fileExt)) && _clientEnv[\"default\"].isYzj && !isCustomPreviewUseDefaultType ? downloadUrl : previewUrl;\n        var _data = {\n          current: imgurl,\n          urls: urlList\n        };\n        // 输出数据方便调试\n        _console[\"default\"].log('云之家图片预览', _data);\n        (0, _clientApi[\"default\"])('previewImage', {\n          data: _data\n        });\n        return;\n      }\n      if (_clientEnv[\"default\"].isYzj && _attachmentConst.PREVIEW_FILE_TYPE.video.includes(fileExt) && localId && visible[0] === '1') {\n        _this.showYzjVideoFile(file);\n        return;\n      }\n      if (_attachmentConst.PREVIEW_FILE_TYPE.gif.includes(fileExt) && (!isYzjPreview && !(0, _attachmentUtils.isPreviewByCustom)(fileExt) || isCustomPreviewUseDefaultType || _clientEnv[\"default\"].isYzj) && previewUrl && visible[0] === '1') {\n        // 开启预览参数 + 有预览按钮的自定义权限才能在app里直接预览\n        _this.setState({\n          file: data,\n          showPreviewPanel: true,\n          showLoading: false,\n          showErr: false\n        });\n        return;\n      }\n      if (isWpsPreview && _attachmentConst.WPS_FILE.includes(file.fileExt)) {\n        // 大写的后缀不支持\n        var _getAttachInfoFromRoo = (0, _componentutil.getAttachInfoFromRootConfig)(),\n          _previewType = _getAttachInfoFromRoo.previewType,\n          wpsAppId = _getAttachInfoFromRoo.wpsAppId;\n        var appId = wpsAppId;\n        _this.setState({\n          showPreviewPanel: true,\n          showLoading: true,\n          showErr: false\n        }, function () {\n          return _this.getWpsUrl(previewUrl, data, {\n            appId: appId,\n            previewType: _previewType\n          });\n        });\n      } else if (((isYzjPreview || (0, _attachmentUtils.isPreviewByCustom)(fileExt)) && !isCustomPreviewUseDefaultType || (0, _attachmentUtils.isPreviewByKKFile)(fileExt) || isOnlyoffice) && !_this.isYzjEnv || isYozoPreview) {\n        _this.setState({\n          showPreviewPanel: true,\n          showLoading: true,\n          showErr: false\n        }, function () {\n          return _this.getPreviewUrl(previewUrl, data, {\n            previewType: previewType,\n            fileData: file\n          });\n        });\n      } else if (_this.isYzjEnv) {\n        // 云之家 app && !mp4\n        _this.showYzjFile(file);\n      } else if (_clientEnv[\"default\"].isDesktop && (isDownloadOnly || !_this.canPreviewerTypes.includes(fileExt))) {\n        // 云之家桌面端，多对接一个下载功能，无法预览的文件调用下载接口\n        _this.downloadFile(file);\n      } else if (isDownloadOnly) {\n        // 非云之家app、桌面端的其他场景（第三方app、云之家网页版），直接下载\n        var container = document.createElement('iframe');\n        container.style.display = 'none';\n        document.body.appendChild(container);\n        container.src = downloadUrl;\n      } else {\n        // 第三方app、网页版预览\n        // excel 需要多发起一次请求获取 url\n        if (_attachmentConst.PREVIEW_FILE_TYPE.excel.includes(fileExt) && ![_attachmentConst.PreviewByOnlyOffice].includes(previewType)) {\n          _this.setState({\n            showPreviewPanel: true,\n            showLoading: true,\n            showErr: false\n          }, function () {\n            return _this.getXlsPreviewUrl(previewUrl, data);\n          });\n          return;\n        }\n        _this.setState({\n          file: data,\n          showPreviewPanel: true,\n          showLoading: false,\n          showErr: false\n        });\n      }\n    };\n    _this.getPreviewUrl = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(previewUrl, data, _ref2) {\n        var previewType, fileData, file;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              previewType = _ref2.previewType, fileData = _ref2.fileData;\n              _context.prev = 1;\n              _context.next = 4;\n              return (0, _attachmentUtils.requestPreviewUrl)({\n                previewUrl: previewUrl,\n                previewType: previewType,\n                fileData: fileData\n              });\n            case 4:\n              file = _context.sent;\n              if (file.status === 'success') {\n                data.previewSrc = file.url;\n                data.token = file.token;\n\n                // onlyoffice userAvatarUrl用户地址\n                if (!(0, _lodash.isNil)(file.userAvatarUrl)) {\n                  data.userAvatarUrl = file.userAvatarUrl;\n                }\n\n                // onlyoffice userName用户名\n                if (!(0, _lodash.isNil)(file.userName)) {\n                  data.userName = file.userName;\n                }\n                _this.setState({\n                  file: data,\n                  showPreviewPanel: true,\n                  showLoading: false,\n                  showErr: false\n                });\n              } else {\n                _this.setState({\n                  showPreviewPanel: true,\n                  showLoading: false,\n                  showErr: true\n                });\n                _console[\"default\"].error(JSON.stringify(file));\n              }\n              _context.next = 13;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              // 图片文件流，使用默认图片预览方式展示\n              if (_attachmentConst.PREVIEW_FILE_TYPE.image.includes(data.fileExt.toLowerCase())) {\n                data.isShowImgPreview = true;\n              }\n              data.previewSrc = previewUrl;\n              _this.setState({\n                file: data,\n                showPreviewPanel: true,\n                showLoading: false,\n                showErr: false\n              });\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[1, 8]]);\n      }));\n      return function (_x, _x2, _x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    _this.getXlsPreviewUrl = function (xlspreviewUrl, data) {\n      _formservice[\"default\"].getApi(xlspreviewUrl).then(function (file) {\n        if (file.status === 'success') {\n          if (file.data) {\n            data.excelData = file.data;\n          } else {\n            data.previewSrc = (0, _componentutil.setAccountId)(file.url);\n            data.xlsId = file.id;\n          }\n          _this.setState({\n            file: data,\n            showPreviewPanel: true,\n            showLoading: false,\n            showErr: false\n          });\n        } else {\n          _this.setState({\n            showPreviewPanel: true,\n            showLoading: false,\n            showErr: true\n          });\n          _console[\"default\"].error(JSON.stringify(file));\n        }\n      });\n    };\n    _this.getWpsUrl = function (previewUrl, data, _ref4) {\n      var appId = _ref4.appId,\n        previewType = _ref4.previewType;\n      _formservice[\"default\"].getApi(previewUrl).then(function (file) {\n        if (file.status === 'success') {\n          if (!appId) {\n            _this.setState({\n              file: data,\n              showPreviewPanel: true,\n              showLoading: false,\n              showErr: false\n            }, function () {\n              _this.wpsSDK = _webOfficeSdkV[\"default\"].config({\n                url: file.url,\n                mount: document.getElementById('wpsContainer'),\n                commonOptions: {\n                  isShowHeader: false // 隐藏头部区域\n                }\n              });\n              if (previewType === _attachmentConst.PreviewByPrivateWps && file.token) {\n                _this.wpsSDK.setToken({\n                  token: file.token,\n                  timeout: 60 * 60 * 1000\n                });\n              }\n              _this.wpsSDK.on('fileOpen', function (data) {\n                _console[\"default\"].log(data.success);\n              });\n              _this.wpsSDK.on('error', function (err) {\n                _console[\"default\"].log('发生错误：', err);\n              });\n            });\n          } else {\n            _this.setState({\n              file: _objectSpread(_objectSpread({}, data), {}, {\n                wpsFileId: file.fileId,\n                wpsAppId: appId\n              }),\n              showPreviewPanel: true,\n              showLoading: false,\n              showErr: false\n            });\n          }\n        } else {\n          _this.setState({\n            showPreviewPanel: true,\n            showLoading: false,\n            showErr: true\n          });\n          _console[\"default\"].error(JSON.stringify(file));\n        }\n      });\n    };\n    /* 判断是不是云之家内部文件\n    *rc-upload-xxxxxx: 苍穹pc端上传的文件-云之家外部文件\n    *id长度为12位的英文数字混合的是h5原生调相机相册上传的文件-云之家外部文件\n    *isP为true的是后端指令调预览的文件，统一视为云之家外部文件\n    *filesource文件来源：0：历史文件，1：非云之家文件，2：云之家文件\n    */\n    _this.editFile = function () {\n      var file = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var _file$previewType2 = file.previewType,\n        previewType = _file$previewType2 === void 0 ? _attachmentConst.PreviewByDefault : _file$previewType2;\n      // 6.0以前，自定义是走的云之家预览\n      var extension = file.fileExt.toLowerCase();\n      var isYzjPreview = previewType === _attachmentConst.PreviewByYunZhiJia || (0, _attachmentUtils.isPreviewByCustom)(extension);\n      // 云之家或者自定义预览方式是否使用默认预览\n      var isCustomPreviewUseDefaultType = (0, _attachmentUtils.getIsCustomPreviewUseDefaultType)(previewType, extension);\n      var isWpsPreview = previewType === _attachmentConst.PreviewByPublicWps || previewType === _attachmentConst.PreviewByPrivateWps;\n      // 预览链接不能直接访问合集\n      var isNoPreviewUrl = previewType === _attachmentConst.PreviewByOnlyOffice || (0, _attachmentUtils.isPreviewByKKFile)(extension);\n\n      // const fileId = file.fileId || file.id\n      // // 云盘文件fileId在上传到苍穹文件服务器时加了随机码以保证唯一性，预览时需要去掉\n      // const index = fileId.indexOf('__$kd$__')\n      // file.fileId = index > -1 ? fileId.substring(0, index) : fileId\n      // 金蝶云盘上传的文件已保存到苍穹服务器，不需要在区分云之家文件，所有文件都按第三方文件转换云之家需要的参数\n      // const isInstructions = file.fileShowByInstructions\n      // if (((fileId && (fileId.indexOf('rc-upload') > -1 || fileId.length === 12)) || isInstructions) || file.filesource !== AttachmentYzjFile) {\n      delete file.fileId;\n      // 云之家在线预览功能有文件类型要求\n      if (_attachmentConst.YZJ_SHOWFILE_ALLOW_TYPE.includes(extension)) {\n        if ((0, _toolUtils.getMobileOS)().includes('iOS') && (!isYzjPreview || isCustomPreviewUseDefaultType) && !isWpsPreview && !isNoPreviewUrl && !_attachmentConst.PREVIEW_FILE_TYPE.excel.includes(file.fileExt.toLowerCase())) {\n          file.filePreviewUrl = file.previewUrl;\n        } else {\n          file.supportOnlinePreview = true;\n        }\n      }\n      // 云之家预览的文件后缀名需要是小写\n      var nameArr = file.fileName.split('.');\n      var suffix = nameArr.splice(nameArr.length - 1, 1)[0] || '';\n      file.name = \"\".concat(nameArr.join('.'), \".\").concat(suffix.toLowerCase());\n      // }\n      return file;\n    };\n    // 云之家，调预览指令\n    _this.showYzjFile = function (file) {\n      file = _this.editFile(file);\n      _console[\"default\"].log('云之家', file);\n      (0, _clientApi[\"default\"])('showFile', {\n        data: file\n      });\n    };\n    // 云之家下载指令\n    _this.downloadFile = function (data) {\n      data = _this.editFile(data);\n      if (_clientEnv[\"default\"].isOldClient) {\n        window.open(data.downloadUrl);\n      } else {\n        (0, _clientApi[\"default\"])('downloadFile', {\n          data: data\n        });\n      }\n    };\n    // 云之家，下载预览视频\n    _this.showYzjVideoFile = function (file) {\n      // alert(JSON.stringify(file))\n      (0, _clientApi[\"default\"])('video_play', {\n        data: {\n          localId: file.localId\n        },\n        failCallback: function failCallback() {\n          (0, _clientApi[\"default\"])('video_download', {\n            data: {\n              serverId: file.fileId\n            },\n            callback: function callback(item) {\n              _console[\"default\"].log(JSON.stringify(item));\n              (0, _clientApi[\"default\"])('video_play', {\n                data: {\n                  localId: item.localId\n                }\n              });\n            }\n          });\n        }\n      });\n    };\n    _this.hasFileURL = function (data) {\n      if (data.fileDownloadUrl) {\n        return data;\n      } else {\n        data.fileDownloadUrl = data.downloadUrl;\n        return data;\n      }\n    };\n    _this.backEvent = function (event) {\n      if (_this.state.showPreviewPanel && !document.location.href.endsWith('?' + _pushCostomUrl.customUrl)) {\n        var _this$context$close, _this$context;\n        // const { previewSrc, xlsId } = this.state.file\n        // if (previewSrc && xlsId) {\n        //   const prefix = previewSrc.substring(0, previewSrc.indexOf('excelpreview'))\n        //   const removeExcelPreview = prefix + 'attachment/removeExcelPreview.do?id=' + xlsId\n        //   service.postJsonApi(removeExcelPreview)\n        // }\n        // this.setState({\n        //   showPreviewPanel: false,\n        //   showLoading: false,\n        //   showErr: false\n        // })\n        (_this$context$close = (_this$context = _this.context).close) === null || _this$context$close === void 0 || _this$context$close.call(_this$context);\n      }\n    };\n    _this.closePreviewer = function () {\n      var _this$context$close2, _this$context2;\n      if (_this.state.showPreviewPanel && document.location.href.endsWith('?' + _pushCostomUrl.customUrl)) {\n        window.history.go(-1);\n      }\n      // this.setState({\n      //   showPreviewPanel: false,\n      //   showLoading: false,\n      //   showErr: false\n      // })\n      (_this$context$close2 = (_this$context2 = _this.context).close) === null || _this$context$close2 === void 0 || _this$context$close2.call(_this$context2);\n    };\n    _this.state = {\n      file: {},\n      showPreviewPanel: false,\n      // 是否显示预览窗口\n      showLoading: false,\n      // 是否显示loading界面\n      showErr: false // 是否显示错误提示\n    };\n    _this.editFile = _this.editFile.bind(_assertThisInitialized(_this));\n    _this.isYzjEnv = _clientEnv[\"default\"].isYzj;\n    // 可预览的文件类型，不包括图片\n    _this.canPreviewerTypes = [].concat(_toConsumableArray(_attachmentConst.PREVIEW_FILE_TYPE.excel), _toConsumableArray(_attachmentConst.PREVIEW_FILE_TYPE.pdf), _toConsumableArray(_attachmentConst.PREVIEW_FILE_TYPE.txt), _toConsumableArray(_attachmentConst.PREVIEW_FILE_TYPE.word), _toConsumableArray(_attachmentConst.PREVIEW_FILE_TYPE.ppt));\n    return _this;\n  }\n  _createClass(AttachmentPreviewer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      this.showAttachmentPreviewer(this.context.uiData);\n      this.removeGlobalDataChangeListener = (0, _GlobalDataCacher.addDataChangeListener)(_symbolConst.KEY_SHOW_ATTACHMENT_PREVIEWER, function (data) {\n        var attachmentData = data && data[1];\n        _this2.showAttachmentPreviewer(attachmentData);\n      });\n      window.addEventListener('popstate', this.backEvent);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this$removeGlobalDat, _this$wpsSDK, _this$wpsSDK$destory;\n      (_this$removeGlobalDat = this.removeGlobalDataChangeListener) === null || _this$removeGlobalDat === void 0 || _this$removeGlobalDat.call(this);\n      window.removeEventListener('popstate', this.backEvent);\n      (_this$wpsSDK = this.wpsSDK) === null || _this$wpsSDK === void 0 || (_this$wpsSDK$destory = _this$wpsSDK.destory) === null || _this$wpsSDK$destory === void 0 || _this$wpsSDK$destory.call(_this$wpsSDK);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n        file = _this$state.file,\n        showPreviewPanel = _this$state.showPreviewPanel,\n        showLoading = _this$state.showLoading,\n        showErr = _this$state.showErr;\n      var _file$fileExt = file.fileExt,\n        fileExt = _file$fileExt === void 0 ? '' : _file$fileExt,\n        previewUrl = file.previewUrl,\n        previewSrc = file.previewSrc,\n        _file$isDownloadOnly2 = file.isDownloadOnly,\n        isDownloadOnly = _file$isDownloadOnly2 === void 0 ? false : _file$isDownloadOnly2,\n        previewType = file.previewType;\n      var fileType = fileExt.toLowerCase();\n      var inAppExpectYZJ = (!this.isYzjEnv || _attachmentConst.PREVIEW_FILE_TYPE.gif.includes(fileType)) && !isDownloadOnly;\n      var isThird = [_attachmentConst.PreviewByOnlyOffice, _attachmentConst.PreviewByPrivateWps, _attachmentConst.PreviewByPublicWps, _attachmentConst.PreviewByYozo, _attachmentConst.PreviewByCustom].includes(previewType);\n      if (inAppExpectYZJ || isThird) {\n        return /*#__PURE__*/_react[\"default\"].createElement(PreviewItem, {\n          showLoading: showLoading,\n          showErr: showErr,\n          showPreviewPanel: showPreviewPanel,\n          src: (0, _attachmentUtils.getAttSrc)(file, previewType, fileType),\n          previewUrl: previewUrl,\n          fileExt: fileExt,\n          previewSrc: previewSrc,\n          close: this.closePreviewer,\n          file: file,\n          previewType: previewType\n        });\n      } else {\n        return null;\n      }\n    }\n  }]);\n  return AttachmentPreviewer;\n}(_react.Component);\nAttachmentPreviewer.contextType = _SystemUIProvider.SystemUIContext;\nvar PreviewItem = exports.PreviewItem = /*#__PURE__*/function (_React$Component) {\n  _inherits(PreviewItem, _React$Component);\n  function PreviewItem(props) {\n    var _this3;\n    _classCallCheck(this, PreviewItem);\n    _this3 = _callSuper(this, PreviewItem, [props]);\n    _this3.handleClose = function () {\n      _this3.props.close && _this3.props.close();\n    };\n    _this3.handleExcelDidMount = function () {\n      _this3.ExcelZoom = new _excelZoom[\"default\"](_this3.excelRef.current);\n    };\n    _this3.handleExcelWillUnmount = function () {\n      _this3.ExcelZoom && _this3.ExcelZoom.removeListener();\n    };\n    _this3.renderPreviewer = function () {\n      var _this3$props = _this3.props,\n        src = _this3$props.src,\n        previewUrl = _this3$props.previewUrl,\n        previewSrc = _this3$props.previewSrc,\n        _this3$props$fileExt = _this3$props.fileExt,\n        fileExt = _this3$props$fileExt === void 0 ? '' : _this3$props$fileExt,\n        previewType = _this3$props.previewType,\n        _this3$props$file = _this3$props.file,\n        file = _this3$props$file === void 0 ? {} : _this3$props$file;\n      var defaultPreviewer = /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: _AttachmentPreviewer2[\"default\"].zipbox\n      }, (0, _intlApi.getLangMsg)({\n        key: 'attachmentpanel.key0043',\n        variables: {\n          ext: fileExt\n        }\n      }));\n      var wpsAppId = file.wpsAppId,\n        wpsFileId = file.wpsFileId,\n        fileId = file.fileId;\n      var extension = fileExt.toLowerCase();\n      var pdf = _attachmentConst.PREVIEW_FILE_TYPE.pdf,\n        txt = _attachmentConst.PREVIEW_FILE_TYPE.txt,\n        excel = _attachmentConst.PREVIEW_FILE_TYPE.excel,\n        word = _attachmentConst.PREVIEW_FILE_TYPE.word,\n        ppt = _attachmentConst.PREVIEW_FILE_TYPE.ppt,\n        image = _attachmentConst.PREVIEW_FILE_TYPE.image,\n        gif = _attachmentConst.PREVIEW_FILE_TYPE.gif;\n      var isYzj = previewType === _attachmentConst.PreviewByYunZhiJia;\n      var isOnlyoffice = previewType === _attachmentConst.PreviewByOnlyOffice;\n      var isYozo = previewType === _attachmentConst.PreviewByYozo;\n      // 云之家或者自定义预览方式是否使用默认预览\n      var isCustomPreviewUseDefaultType = (0, _attachmentUtils.getIsCustomPreviewUseDefaultType)(previewType, extension);\n      var isWpsPreview = [_attachmentConst.PreviewByPublicWps, _attachmentConst.PreviewByPrivateWps].includes(previewType) && _attachmentConst.WPS_FILE.includes(file.fileExt);\n      var isNewWps = !!wpsAppId;\n\n      // 默认预览方式kkfileview插件\n      if ((0, _attachmentUtils.isPreviewByKKFile)(extension)) {\n        return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(\"iframe\", {\n          src: previewSrc\n        }), /*#__PURE__*/_react[\"default\"].createElement(_Toolbar[\"default\"], {\n          onHandleClose: _this3.handleClose,\n          className: _AttachmentPreviewer2[\"default\"].kkFileToolbar\n        }));\n      }\n      if (isOnlyoffice && [].concat(_toConsumableArray(excel), _toConsumableArray(pdf), _toConsumableArray(txt), _toConsumableArray(word), _toConsumableArray(ppt)).includes(extension)) {\n        var documentServerUrl = (0, _componentutil.getAttachInfoFromRootConfig)().onlyofficeServerUrl;\n        return /*#__PURE__*/_react[\"default\"].createElement(_OnlyOfficePreviewer[\"default\"], {\n          url: src,\n          documentServerUrl: documentServerUrl,\n          file: (0, _attachmentUtils.mobTransformFileData)(file)\n        });\n      } else if (isWpsPreview) {\n        if (isNewWps) {\n          var _getRootFormConfig = (0, _componentutil.getRootFormConfig)(),\n            accountId = _getRootFormConfig.accountId;\n          return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Suspense, {\n            fallback: /*#__PURE__*/_react[\"default\"].createElement(\"div\", null)\n          }, /*#__PURE__*/_react[\"default\"].createElement(WebOfficePreviewer, {\n            accountId: accountId,\n            appId: wpsAppId,\n            type: extension,\n            fileId: wpsFileId,\n            token: fileId\n          }));\n        }\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          id: \"wpsContainer\",\n          style: {\n            width: '100%',\n            height: '100%'\n          }\n        });\n      } else if ((isYzj && !_this3.isYzjEnv || (0, _attachmentUtils.isPreviewByCustom)(extension)) && !isCustomPreviewUseDefaultType || isYozo) {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"iframe\", {\n          src: previewSrc\n        });\n      } else if ([].concat(_toConsumableArray(pdf), _toConsumableArray(word), _toConsumableArray(ppt), _toConsumableArray(txt)).includes(extension)) {\n        // PDF/WORD/PPT 使用 pdf 预览 || txt因为水印问题也转为pdf预览\n        return /*#__PURE__*/_react[\"default\"].createElement(LazyPDFPreviewer, {\n          src: previewUrl || src,\n          handleCloseViewer: _this3.props.close\n        });\n      } else if (image.includes(extension)) {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"img\", {\n          className: _AttachmentPreviewer2[\"default\"].imgbox,\n          src: previewUrl || src\n        });\n      } else if (gif.includes(extension)) {\n        var gifSrc = isYzj && _this3.isYzjEnv && !isCustomPreviewUseDefaultType ? src : previewUrl || src;\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          className: _AttachmentPreviewer2[\"default\"].gifbox,\n          onClick: _this3.handleClose\n        }, /*#__PURE__*/_react[\"default\"].createElement(\"img\", {\n          className: _AttachmentPreviewer2[\"default\"].gif,\n          src: gifSrc\n        }));\n      } else if (excel.includes(extension)) {\n        // Excel\n        return /*#__PURE__*/_react[\"default\"].createElement(_ExcelViewer[\"default\"], {\n          file: file,\n          hasToolbar: true,\n          onExcelDidMount: _this3.handleExcelDidMount,\n          onExcelWillUnmount: _this3.handleExcelWillUnmount,\n          ref: _this3.excelRef,\n          onHandleClose: _this3.handleClose\n        }); // <iframe src={previewSrc || src} />\n      } else if ((0, _attaPreviewUtil.isRunOnPc)()) {\n        // 判断是否运行在 PC 上，除去可以预览的文件，剩下的文件进行下载操作\n        return /*#__PURE__*/_react[\"default\"].createElement(\"iframe\", {\n          src: src\n        });\n      }\n\n      // 运行在手机上的第三方app，不能预览的文件只提示无法预览，不提供下载功能\n      return defaultPreviewer;\n    };\n    _this3.isImage = function () {\n      var _this3$props2 = _this3.props,\n        _this3$props2$fileExt = _this3$props2.fileExt,\n        fileExt = _this3$props2$fileExt === void 0 ? '' : _this3$props2$fileExt,\n        _this3$props2$preview = _this3$props2.previewType,\n        previewType = _this3$props2$preview === void 0 ? _attachmentConst.PreviewByDefault : _this3$props2$preview,\n        file = _this3$props2.file;\n      var extension = fileExt.toLowerCase();\n      var isYzjPreview = previewType === _attachmentConst.PreviewByYunZhiJia || (0, _attachmentUtils.isPreviewByCustom)(extension);\n      // 云之家或者自定义预览方式是否使用默认预览\n      var isCustomPreviewUseDefaultType = (0, _attachmentUtils.getIsCustomPreviewUseDefaultType)(previewType, extension);\n      if (file !== null && file !== void 0 && file.isShowImgPreview) {\n        return true;\n      }\n      return _attachmentConst.PREVIEW_FILE_TYPE.image.includes(extension) && !isWxworkClient && (!isYzjPreview || isCustomPreviewUseDefaultType);\n    };\n    _this3.container = document.body;\n    _this3.excelRef = /*#__PURE__*/_react[\"default\"].createRef(null);\n    _this3.ExcelZoom = null;\n    return _this3;\n  }\n  _createClass(PreviewItem, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // 在初始化时，showPreviewPanel就为true时，需要把?customurl加到url后缀。避免直接回退到上一页\n      var showPreviewPanel = this.props.showPreviewPanel;\n      showPreviewPanel && (0, _pushCostomUrl[\"default\"])();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProp) {\n      var showPreviewPanel = this.props.showPreviewPanel;\n      !prevProp.showPreviewPanel && showPreviewPanel && (0, _pushCostomUrl[\"default\"])();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n        showPreviewPanel = _this$props.showPreviewPanel,\n        showLoading = _this$props.showLoading,\n        showErr = _this$props.showErr,\n        file = _this$props.file,\n        src = _this$props.src,\n        previewUrl = _this$props.previewUrl;\n      if (!showPreviewPanel) return null;\n      var _getImageInfo = (0, _attachmentUtils.getImageInfo)(file, src, previewUrl),\n        imgUrls = _getImageInfo.imgUrls,\n        curIndex = _getImageInfo.curIndex;\n      return /*#__PURE__*/_reactDom[\"default\"].createPortal( /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: _AttachmentPreviewer2[\"default\"].preview\n      }, !showLoading && !showErr && (this.isImage() ? /*#__PURE__*/_react[\"default\"].createElement(_ImagePreview[\"default\"], {\n        key: \"preview\",\n        onClose: this.handleClose,\n        imgUrls: imgUrls,\n        curIndex: curIndex,\n        imageTypes: file.imageTypes\n      }) : this.renderPreviewer()), showLoading && !showErr && /*#__PURE__*/_react[\"default\"].createElement(_Loading[\"default\"], {\n        text: (0, _intlApi.getLangMsg)('attachmentpanel.key0076')\n      }), showErr && !showLoading && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: _AttachmentPreviewer2[\"default\"].errmsg\n      }, (0, _intlApi.getLangMsg)('attachmentpanel.key0048'))), this.container);\n    }\n  }]);\n  return PreviewItem;\n}(_react[\"default\"].Component);\n/**\n * 异步加载PDFPreviewer 预览组件\n * webpack会分片打包\n * @param {object} props 组件props对象\n */\nvar LazyPDFPreviewer = function LazyPDFPreviewer(props) {\n  var src = props.src,\n    handleCloseViewer = props.handleCloseViewer;\n  var PDFPreviewer = /*#__PURE__*/(0, _react.lazy)(function () {\n    return Promise.all(/*! import() | PDFPreviewer */[__webpack_require__.e(2360), __webpack_require__.e(4260), __webpack_require__.e(3684)]).then(__webpack_require__.bind(__webpack_require__, /*! ./mobile/PDFPreviewer */ \"./src/page/mobile/PDFPreviewer.jsx\"));\n  });\n  var loading = /*#__PURE__*/_react[\"default\"].createElement(_Loading[\"default\"], {\n    text: (0, _intlApi.getLangMsg)('attachmentpanel.key0074')\n  });\n  return /*#__PURE__*/_react[\"default\"].createElement(_react.Suspense, {\n    fallback: loading\n  }, /*#__PURE__*/_react[\"default\"].createElement(PDFPreviewer, {\n    url: src,\n    clientEnv: _clientEnv[\"default\"],\n    handleCloseViewer: handleCloseViewer\n  }));\n};\n\n//# sourceURL=webpack://bos-platform/./src/page/AttachmentPreviewer.jsx?");

/***/ }),

/***/ "./src/page/AttachmentPreviewerMob/excelZoom.js":
/*!******************************************************!*\
  !*** ./src/page/AttachmentPreviewerMob/excelZoom.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\nvar _FingerTransForm = _interopRequireDefault(__webpack_require__(/*! @/util/FingerTransForm */ \"./src/util/FingerTransForm.js\"));\nvar _gestureSubscriptionService = __webpack_require__(/*! @/service/mobile/gestureSubscriptionService */ \"./src/service/mobile/gestureSubscriptionService.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nvar excelZoom = /*#__PURE__*/_createClass(function excelZoom(_iframe) {\n  var _this = this;\n  _classCallCheck(this, excelZoom);\n  this.init = function (iframe) {\n    if (!iframe) return;\n    iframe.onload = function () {\n      _this.iframe = iframe.contentWindow.document.querySelector('frame') || iframe;\n      if (_this.iframe) {\n        // 第一次加载时，iframe的内容可能已经加载完毕，所以先绑定一次监听\n        _this.removeGestureService = (0, _gestureSubscriptionService.addGestureService)(_this.iframe.contentDocument);\n        _this.removeFingerTransForm = _this.addFingerTransForm(_this.iframe);\n        // 监听的过程中，如果内容重新onload，则重新监听\n        _this.iframe.onload = function () {\n          _this.removeListener();\n          _this.removeGestureService = (0, _gestureSubscriptionService.addGestureService)(_this.iframe.contentDocument);\n          _this.removeFingerTransForm = _this.addFingerTransForm(_this.iframe);\n        };\n      }\n    };\n  };\n  this.addFingerTransForm = function (target) {\n    // 初始化手势缩放css类\n    _this.fingerTransForm = new _FingerTransForm[\"default\"]({\n      viewerBox: target.contentWindow,\n      viewer: target.contentDocument.body,\n      minScale: 0.3,\n      maxScale: 2,\n      isShowScaleTip: true\n    });\n    _this.startScale = _this.fingerTransForm.getScale();\n    var removePinchListener = (0, _GlobalDataCacher.addDataChangeListener)(_symbolConst.KEY_GUESTURE_PINCH, _this.handleTouchMove);\n    var removeTouchEndListener = (0, _GlobalDataCacher.addDataChangeListener)(_symbolConst.KEY_TOUCH_END, _this.handleTouchEnd);\n    return function () {\n      removePinchListener && removePinchListener();\n      removeTouchEndListener && removeTouchEndListener();\n    };\n  };\n  this.removeListener = function () {\n    _this.removeFingerTransForm && _this.removeFingerTransForm();\n    _this.removeGestureService && _this.removeGestureService();\n  };\n  this.handleTouchMove = function (evt) {\n    evt.pinchScale = evt.pinchScale * _this.startScale;\n    _this.fingerTransForm.pinchMoveTransForm(evt);\n  };\n  this.handleTouchEnd = function () {\n    _this.startScale = _this.fingerTransForm.getScale();\n    _this.fingerTransForm.pinchEndTransFTorm();\n  };\n  this.iframe = null;\n  this.fingerTransForm = null;\n  this.removeGestureService = null;\n  this.removeFingerTransForm = null;\n  this.init(_iframe);\n});\nvar _default = exports[\"default\"] = excelZoom;\n\n//# sourceURL=webpack://bos-platform/./src/page/AttachmentPreviewerMob/excelZoom.js?");

/***/ }),

/***/ "./src/util/FingerTransForm.js":
/*!*************************************!*\
  !*** ./src/util/FingerTransForm.js ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-primitive.js */ \"../../node_modules/core-js/modules/es.symbol.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-primitive.js */ \"../../node_modules/core-js/modules/es.date.to-primitive.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.parse-float.js */ \"../../node_modules/core-js/modules/es.parse-float.js\");\n__webpack_require__(/*! core-js/modules/web.timers.js */ \"../../node_modules/core-js/modules/web.timers.js\");\nvar _symbolConst = __webpack_require__(/*! @/constant/symbolConst */ \"./src/constant/symbolConst.js\");\nvar _GlobalDataCacher = __webpack_require__(/*! @/model/GlobalDataCacher */ \"./src/model/GlobalDataCacher.js\");\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n* @Description:'缩放过程的css设置'\n* @authors he_ying_jin (he_ying_jin@kingdee.com)\n* @param {dom} viewerBox '目标元素的父级，需要设置overflow:auto'\n* @param {dom} viewer '目标元素'\n* @param {function} pdfViewer 'pdf初始化后返回的类 可选'\n* @returns {function} '类的实例'\n*/\nvar FingerTransForm = /*#__PURE__*/function () {\n  function FingerTransForm(_ref) {\n    var _this = this;\n    var viewerBox = _ref.viewerBox,\n      viewer = _ref.viewer,\n      pdfViewer = _ref.pdfViewer,\n      minScale = _ref.minScale,\n      maxScale = _ref.maxScale,\n      canSet = _ref.canSet,\n      isShowScaleTip = _ref.isShowScaleTip;\n    _classCallCheck(this, FingerTransForm);\n    this.getRootStyle = function () {\n      var style = window.getComputedStyle(_this.viewer);\n      var marginLeft = parseFloat(style.marginLeft) || 0;\n      var marginTop = parseFloat(style.marginTop) || 0;\n      var width = parseFloat(style.width) || 0;\n      var height = parseFloat(style.height) || 0;\n      return {\n        marginLeft: marginLeft,\n        marginTop: marginTop,\n        width: width,\n        height: height\n      };\n    };\n    this.getScale = function () {\n      return _this.scale;\n    };\n    this.getMoveY = function (center, origin, ratio, top, scrollX, scrollY) {\n      // 吸附\n      if (top >= 0) {\n        _this.viewerBox.scrollTo(scrollX, 0);\n        _this.scrollY = 0;\n        return (_this.scale * _this.rootHeight - _this.rootHeight) / 2;\n      }\n      // 按缩放中心移动\n      if (_this.canSet) {\n        return _this.moveY - (center.y - top - origin.y) * (ratio - 1);\n      }\n      return _this.moveY - (center.y - top - scrollY - origin.y) * (ratio - 1);\n    };\n    this.getMoveX = function (center, origin, ratio, left, scrollX, scrollY) {\n      // 吸附\n      if (left > 0) {\n        _this.viewerBox.scrollTo(0, scrollY);\n        _this.scrollX = 0;\n        return (_this.scale * _this.rootWidth - _this.rootWidth) / 2;\n      }\n      // 按缩放中心移动\n      if (_this.canSet) {\n        return _this.moveX - (center.x - left - origin.x) * (ratio - 1);\n      }\n      return _this.moveX - (center.x - left - scrollX - origin.x) * (ratio - 1);\n    };\n    this.setScale = function (scale, center) {\n      if (scale !== _this.scale) {\n        var ratio = scale / _this.scale;\n        _this.preScale = _this.scale;\n        _this.scale = scale;\n        if (center) {\n          var _this$viewer$getBound = _this.viewer.getBoundingClientRect(),\n            width = _this$viewer$getBound.width,\n            height = _this$viewer$getBound.height,\n            top = _this$viewer$getBound.top,\n            left = _this$viewer$getBound.left;\n          var _this$getScroll = _this.getScroll(),\n            scrollX = _this$getScroll.scrollX,\n            scrollY = _this$getScroll.scrollY;\n          var origin = {\n            x: width * 0.5,\n            y: height * 0.5\n          };\n          _this.moveX = _this.getMoveX(center, origin, ratio, left, scrollX, scrollY);\n          _this.moveY = _this.getMoveY(center, origin, ratio, top, scrollX, scrollY);\n        }\n      }\n    };\n    this.getScroll = function () {\n      var _this$viewerBox, _this$viewerBox2, _this$viewerBox3, _this$viewerBox4;\n      var scrollX = ((_this$viewerBox = _this.viewerBox) === null || _this$viewerBox === void 0 ? void 0 : _this$viewerBox.scrollX) || ((_this$viewerBox2 = _this.viewerBox) === null || _this$viewerBox2 === void 0 ? void 0 : _this$viewerBox2.scrollLeft) || 0;\n      var scrollY = ((_this$viewerBox3 = _this.viewerBox) === null || _this$viewerBox3 === void 0 ? void 0 : _this$viewerBox3.scrollY) || ((_this$viewerBox4 = _this.viewerBox) === null || _this$viewerBox4 === void 0 ? void 0 : _this$viewerBox4.scrollTop) || 0;\n      return {\n        scrollX: scrollX,\n        scrollY: scrollY\n      };\n    };\n    this.setScrollInfo = function () {\n      var _this$viewer$getBound2 = _this.viewer.getBoundingClientRect(),\n        left = _this$viewer$getBound2.left,\n        top = _this$viewer$getBound2.top;\n      var _this$getScroll2 = _this.getScroll(),\n        scrollX = _this$getScroll2.scrollX,\n        scrollY = _this$getScroll2.scrollY;\n      // 如果left/top <=0 说明内容已经超出屏幕，滚动条滚动到对应位置\n      if (left < 0) {\n        var diffy = scrollX - left * -1;\n        _this.moveX = _this.moveX - diffy + _this.rootStyle.marginLeft;\n        _this.scrollX = scrollX - diffy + _this.rootStyle.marginLeft;\n      }\n\n      // 如果left/top > 0 说明内容已经小于屏幕，滚动条重置为零, 并把内容吸附于屏幕最左侧/最上侧\n      if (left >= 0) {\n        _this.moveX = _this.moveX + left * -1 - scrollX + _this.rootStyle.marginLeft;\n        _this.scrollX = 0;\n      }\n      if (top < 0) {\n        var _diffy = scrollY - top * -1;\n        _this.moveY = _this.moveY - _diffy + _this.rootStyle.marginTop;\n        _this.scrollY = scrollY - _diffy + _this.rootStyle.marginTop;\n      }\n      if (top >= 0) {\n        _this.moveY = _this.moveY + top * -1 - scrollY + _this.rootStyle.marginTop;\n        _this.scrollY = 0;\n      }\n    };\n    this.getBoundaryZoom = function (scale, currentScale) {\n      if (currentScale * scale <= _this.minScale) {\n        _this.prefixMsg = (0, _intlApi.getLangMsg)({\n          key: 'attachmentpanel.key0109'\n        });\n        return _this.minScale / currentScale;\n      }\n      if (_this.maxScale && currentScale * scale > _this.maxScale) {\n        _this.prefixMsg = (0, _intlApi.getLangMsg)({\n          key: 'attachmentpanel.key0108'\n        });\n        return _this.maxScale / currentScale;\n      }\n      _this.prefixMsg = (0, _intlApi.getLangMsg)({\n        key: 'attachmentpanel.key0107'\n      });\n      return scale;\n    };\n    // 显示缩放比例\n    this._showScaleTip = function () {\n      var scalePer = Math.round(_this.scale * _this.currentScale * 100);\n      var confirmData = {\n        msg: \"\".concat(_this.prefixMsg).concat(scalePer, \"%\"),\n        style: {\n          'z-index': '999999',\n          'pointer-events': 'none'\n        },\n        duration: 500\n      };\n      (0, _GlobalDataCacher.setData)(_symbolConst.KEY_SHOW_CONFIRM_EVENT, confirmData);\n    };\n    this.reset = function () {\n      _this.preScale = 0;\n      _this.scale = 1;\n      _this.pinchIng = false;\n      _this.initTransform = _this.viewer.style.transform;\n      _this.inintTransformOrigin = _this.viewer.style.transformOrigin;\n      _this.scrollX = 0;\n      _this.scrollY = 0;\n      _this.rootStyle = _this.getRootStyle();\n      _this.rootHeight = _this.rootStyle.height || 0;\n      _this.rootWidth = _this.rootStyle.width || 0;\n      _this.moveX = _this.rootStyle.marginLeft || 0;\n      _this.moveY = _this.rootStyle.marginTop || 0;\n      _this.prefixMsg = (0, _intlApi.getLangMsg)({\n        key: 'attachmentpanel.key0107'\n      });\n    };\n    this.pinchEndTransFTorm = this.debounce(this._pinchEndTransFTorm, 300);\n    this.pinchEndTransFTormRender = this.debounce(this._pinchEndTransFTormRender, 300);\n    this.viewerBox = viewerBox;\n    this.viewer = viewer;\n    this.minScale = minScale;\n    this.maxScale = maxScale;\n    this.pdfViewer = pdfViewer;\n    this.preScale = 0;\n    this.scale = 1;\n    this.pinchIng = false;\n    this.initTransform = this.viewer.style.transform;\n    this.inintTransformOrigin = this.viewer.style.transformOrigin;\n    this.scrollX = 0;\n    this.scrollY = 0;\n    this.timer = null; // 用于结束计时\n    this.rootStyle = this.getRootStyle();\n    this.rootHeight = this.rootStyle.height || 0;\n    this.rootWidth = this.rootStyle.width || 0;\n    this.moveX = this.rootStyle.marginLeft || 0;\n    this.moveY = this.rootStyle.marginTop || 0;\n    this.canSet = canSet;\n    this.prefixMsg = (0, _intlApi.getLangMsg)({\n      key: 'attachmentpanel.key0107'\n    });\n    this.currentScale = 1;\n    this.isShowScaleTip = isShowScaleTip;\n  }\n  _createClass(FingerTransForm, [{\n    key: \"pinchMoveTransForm\",\n    value: function pinchMoveTransForm(evt) {\n      if (!isFinite(evt.pinchScale)) return;\n      // 清除结束的回调\n      if (this.timer) {\n        clearTimeout(this.timer);\n        this.timer = null;\n      }\n      this.currentScale = evt.currentScale || 1;\n      var scale = this.getBoundaryZoom(evt.pinchScale, this.currentScale);\n      if (scale === this.scale) return this.isShowScaleTip && this._showScaleTip();\n      this.setScale(scale, evt.center);\n      this.viewer.style.transform = \"matrix(\".concat(this.scale, \", 0, 0, \").concat(this.scale, \", \").concat(this.moveX, \", \").concat(this.moveY, \")\");\n      this.pinchIng = true;\n      this.isShowScaleTip && this._showScaleTip();\n    }\n  }, {\n    key: \"_pinchEndTransFTormRender\",\n    value:\n    // 可以设置缩放比例重新渲染页面的调用该方法\n    function _pinchEndTransFTormRender() {\n      var _this2 = this;\n      if (!isFinite(this.scale) || !this.pinchIng) return;\n      var _this$viewer$getBound3 = this.viewer.getBoundingClientRect(),\n        top = _this$viewer$getBound3.top,\n        left = _this$viewer$getBound3.left;\n      this.viewer.style.transform = this.initTransform;\n      this.viewer.style.transformOrigin = this.inintTransformOrigin;\n      if (this.pdfViewer) {\n        var newScale = this.pdfViewer.currentScale * this.scale;\n        if (newScale <= this.minScale) {\n          newScale = this.minScale;\n        }\n        this.pdfViewer.currentScale = newScale;\n      }\n      window.requestAnimationFrame(function () {\n        _this2.viewerBox.scrollTo(left * -1, top * -1);\n      });\n      this.pinchIng = false;\n      this.reset();\n    }\n\n    // 不能设置缩放比例重新渲染页面的调用该方法\n  }, {\n    key: \"_pinchEndTransFTorm\",\n    value: function _pinchEndTransFTorm() {\n      var _this3 = this;\n      if (!isFinite(this.scale) || !this.pinchIng) return;\n      this.pinchIng = false;\n      this.setScrollInfo();\n      this.viewer.style.transform = \"matrix(\".concat(this.scale, \", 0, 0, \").concat(this.scale, \", \").concat(this.moveX, \", \").concat(this.moveY, \")\");\n      window.requestAnimationFrame(function () {\n        _this3.viewerBox.scrollTo(_this3.scrollX, _this3.scrollY);\n      });\n    }\n  }, {\n    key: \"debounce\",\n    value: function debounce(fn) {\n      var delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 300;\n      this.timer = null;\n      return function () {\n        var _arguments = arguments,\n          _this4 = this;\n        clearTimeout(this.timer);\n        this.timer = setTimeout(function () {\n          fn.apply(_this4, _arguments);\n          _this4.timer = null;\n        }, delay);\n      };\n    }\n  }]);\n  return FingerTransForm;\n}();\nvar _default = exports[\"default\"] = FingerTransForm;\n\n//# sourceURL=webpack://bos-platform/./src/util/FingerTransForm.js?");

/***/ }),

/***/ "./src/util/attaPreviewUtil.js":
/*!*************************************!*\
  !*** ./src/util/attaPreviewUtil.js ***!
  \*************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.isRunOnPc = isRunOnPc;\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\nvar _clientEnv = _interopRequireDefault(__webpack_require__(/*! ../plugin/clientEnv */ \"./src/plugin/clientEnv.js\"));\nvar _toolUtils = __webpack_require__(/*! ./toolUtils */ \"./src/util/toolUtils.js\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n// 判断未知app移动端页面是否运行在pc端\n\nfunction isRunOnPc() {\n  var isUnknown = _clientEnv[\"default\"].isUnknown;\n  if (isUnknown) {\n    var mobileOS = (0, _toolUtils.getMobileOS)().toLocaleLowerCase();\n    return !(mobileOS.includes('ios') || mobileOS.includes('android'));\n  }\n  return false;\n}\n\n//# sourceURL=webpack://bos-platform/./src/util/attaPreviewUtil.js?");

/***/ }),

/***/ "./src/page/AttachmentPreviewer.less":
/*!*******************************************!*\
  !*** ./src/page/AttachmentPreviewer.less ***!
  \*******************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\"preview\":\"AttachmentPreviewer_preview_NPlU\",\"imgbox\":\"AttachmentPreviewer_imgbox_1-1l\",\"gifbox\":\"AttachmentPreviewer_gifbox_1w15\",\"gif\":\"AttachmentPreviewer_gif_2NSA\",\"zipbox\":\"AttachmentPreviewer_zipbox_3vCN\",\"audiobox\":\"AttachmentPreviewer_audiobox_oU2N\",\"videobox\":\"AttachmentPreviewer_videobox_1g5_\",\"loading\":\"AttachmentPreviewer_loading_2T6y\",\"errmsg\":\"AttachmentPreviewer_errmsg_3S36\",\"loadinggif\":\"AttachmentPreviewer_loadinggif_Sc4z\",\"kkFileToolbar\":\"AttachmentPreviewer_kkFileToolbar_3MKO\"});\n\n//# sourceURL=webpack://bos-platform/./src/page/AttachmentPreviewer.less?");

/***/ })

}]);