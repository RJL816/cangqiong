/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[3868],{

/***/ "./src/plugin/mobile/wxwork/plugin.js":
/*!********************************************!*\
  !*** ./src/plugin/mobile/wxwork/plugin.js ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.description.js */ \"../../node_modules/core-js/modules/es.symbol.description.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.async-iterator.js */ \"../../node_modules/core-js/modules/es.symbol.async-iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.iterator.js */ \"../../node_modules/core-js/modules/es.symbol.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.symbol.to-string-tag.js */ \"../../node_modules/core-js/modules/es.symbol.to-string-tag.js\");\n__webpack_require__(/*! core-js/modules/es.array.for-each.js */ \"../../node_modules/core-js/modules/es.array.for-each.js\");\n__webpack_require__(/*! core-js/modules/es.array.from.js */ \"../../node_modules/core-js/modules/es.array.from.js\");\n__webpack_require__(/*! core-js/modules/es.array.is-array.js */ \"../../node_modules/core-js/modules/es.array.is-array.js\");\n__webpack_require__(/*! core-js/modules/es.array.reverse.js */ \"../../node_modules/core-js/modules/es.array.reverse.js\");\n__webpack_require__(/*! core-js/modules/es.array.slice.js */ \"../../node_modules/core-js/modules/es.array.slice.js\");\n__webpack_require__(/*! core-js/modules/es.json.to-string-tag.js */ \"../../node_modules/core-js/modules/es.json.to-string-tag.js\");\n__webpack_require__(/*! core-js/modules/es.math.to-string-tag.js */ \"../../node_modules/core-js/modules/es.math.to-string-tag.js\");\n__webpack_require__(/*! core-js/modules/es.object.create.js */ \"../../node_modules/core-js/modules/es.object.create.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-own-property-descriptor.js */ \"../../node_modules/core-js/modules/es.object.get-own-property-descriptor.js\");\n__webpack_require__(/*! core-js/modules/es.object.get-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.get-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\n__webpack_require__(/*! core-js/modules/es.object.set-prototype-of.js */ \"../../node_modules/core-js/modules/es.object.set-prototype-of.js\");\n__webpack_require__(/*! core-js/modules/es.weak-map.js */ \"../../node_modules/core-js/modules/es.weak-map.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.for-each.js */ \"../../node_modules/core-js/modules/web.dom-collections.for-each.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = main;\n__webpack_require__(/*! core-js/modules/es.array.concat.js */ \"../../node_modules/core-js/modules/es.array.concat.js\");\n__webpack_require__(/*! core-js/modules/es.array.filter.js */ \"../../node_modules/core-js/modules/es.array.filter.js\");\n__webpack_require__(/*! core-js/modules/es.array.find.js */ \"../../node_modules/core-js/modules/es.array.find.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.array.index-of.js */ \"../../node_modules/core-js/modules/es.array.index-of.js\");\n__webpack_require__(/*! core-js/modules/es.array.iterator.js */ \"../../node_modules/core-js/modules/es.array.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.array.map.js */ \"../../node_modules/core-js/modules/es.array.map.js\");\n__webpack_require__(/*! core-js/modules/es.array-buffer.constructor.js */ \"../../node_modules/core-js/modules/es.array-buffer.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.array-buffer.slice.js */ \"../../node_modules/core-js/modules/es.array-buffer.slice.js\");\n__webpack_require__(/*! core-js/modules/es.data-view.js */ \"../../node_modules/core-js/modules/es.data-view.js\");\n__webpack_require__(/*! core-js/modules/es.date.to-string.js */ \"../../node_modules/core-js/modules/es.date.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.function.name.js */ \"../../node_modules/core-js/modules/es.function.name.js\");\n__webpack_require__(/*! core-js/modules/es.map.js */ \"../../node_modules/core-js/modules/es.map.js\");\n__webpack_require__(/*! core-js/modules/es.number.constructor.js */ \"../../node_modules/core-js/modules/es.number.constructor.js\");\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.parse-int.js */ \"../../node_modules/core-js/modules/es.parse-int.js\");\n__webpack_require__(/*! core-js/modules/es.promise.js */ \"../../node_modules/core-js/modules/es.promise.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.to-string.js */ \"../../node_modules/core-js/modules/es.regexp.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.string.includes.js */ \"../../node_modules/core-js/modules/es.string.includes.js\");\n__webpack_require__(/*! core-js/modules/es.string.iterator.js */ \"../../node_modules/core-js/modules/es.string.iterator.js\");\n__webpack_require__(/*! core-js/modules/es.string.match.js */ \"../../node_modules/core-js/modules/es.string.match.js\");\n__webpack_require__(/*! core-js/modules/es.string.replace.js */ \"../../node_modules/core-js/modules/es.string.replace.js\");\n__webpack_require__(/*! core-js/modules/es.string.starts-with.js */ \"../../node_modules/core-js/modules/es.string.starts-with.js\");\n__webpack_require__(/*! core-js/modules/es.string.link.js */ \"../../node_modules/core-js/modules/es.string.link.js\");\n__webpack_require__(/*! core-js/modules/web.dom-collections.iterator.js */ \"../../node_modules/core-js/modules/web.dom-collections.iterator.js\");\n__webpack_require__(/*! core-js/modules/web.timers.js */ \"../../node_modules/core-js/modules/web.timers.js\");\nvar _takePhotoUtil = __webpack_require__(/*! ../../../util/takePhotoUtil */ \"./src/util/takePhotoUtil.js\");\nvar _clientEnv = __webpack_require__(/*! ../../clientEnv */ \"./src/plugin/clientEnv.js\");\nvar _const = __webpack_require__(/*! ../../const */ \"./src/plugin/const.js\");\nvar _promiseUtil = __webpack_require__(/*! @/api/promiseUtil */ \"./src/api/promiseUtil.js\");\nvar _global = _interopRequireWildcard(__webpack_require__(/*! @/global */ \"./src/global/index.js\"));\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _PluginManager = __webpack_require__(/*! @/plugin/PluginManager */ \"./src/plugin/PluginManager.js\");\nvar _excluded = [\"errMsg\"];\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw new Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw new Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nvar selectDevice = null;\nvar connectedDevice = null;\nvar connectedCharacteristic = null;\nvar allDevices = null;\nvar workList = [];\nvar isWorking = false;\nfunction main(_ref, callback) {\n  var loadjs = _ref.loadjs,\n    releaseResource = _ref.releaseResource,\n    pluginReady = _ref.pluginReady;\n  var isAndroid = /android/.test(window.navigator.userAgent.toLowerCase());\n  var basePlugin = {\n    // 获取当前设备的语言信息\n    getDevicedLang: function getDevicedLang() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      var qingUserAgent = window.navigator.userAgent;\n      var langMsg = qingUserAgent.split(' ').find(function (item) {\n        return item.startsWith('Language');\n      }) || 'Language/zh';\n      // const lang = langMsg.indexOf('zh') > -1 ? 'zh_CN' : 'en_US'\n      var lang = '';\n      if (langMsg.includes('zh_HK')) {\n        // 企业微信设置繁体中文，ua里面是zh_HK\n        lang = 'zh_TW';\n      } else if (langMsg.includes('zh')) {\n        lang = 'zh_CN';\n      } else {\n        lang = (0, _intlApi.getLanguage)(langMsg);\n      }\n      var callbackData = {\n        success: true,\n        data: lang\n      };\n      callback(callbackData);\n    }\n  };\n  var plugin = {\n    isAndroid: isAndroid,\n    input: null,\n    // 关闭当前轻应用\n    closeWebView: function closeWebView() {\n      window.wx.closeWindow()[\"catch\"](function (error) {\n        console.log('关闭webview异常', error);\n      });\n    },\n    // 扫码\n    scanQRCode: function scanQRCode() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      var needResult = data ? data.needResult : 1;\n      if (isNaN(needResult)) {\n        needResult = 1;\n      }\n      window.wx.scanQRCode({\n        desc: 'scanQRCode desc',\n        needResult: needResult,\n        // 默认为0，扫描结果由企业微信处理，1则直接返回扫描结果，\n        scanType: ['qrCode', 'barCode'],\n        success: function success(res) {\n          var args = {\n            success: true,\n            data: {\n              qrcode_str: res ? res.resultStr : ''\n            }\n          };\n          callback(args);\n        },\n        error: function error(res) {\n          console.log('扫码异常', res);\n          callback({\n            success: false,\n            data: res\n          });\n          if (res.errMsg.indexOf('function_not_exist') > 0) {\n            console.log('版本过低请升级');\n          }\n        }\n      });\n    },\n    // 预览图片\n    previewImage: function previewImage() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      var current = data.current,\n        urls = data.urls;\n      current && urls && window.wx.previewImage({\n        current: current,\n        // 当前显示图片的http链接\n        urls: urls,\n        // 需要预览的图片http链接列表\n        success: function success(res) {\n          callback(res);\n        },\n        error: function error(err) {\n          callback(err);\n        }\n      });\n    },\n    chooseImageSuccess: function chooseImageSuccess(req, cb) {\n      var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      window.wx.getLocalImgData({\n        localId: req.localIds[i].toString(),\n        success: function success(res) {\n          console.log('getLocalImgData result:', res);\n          var localData = res.localData;\n          var imageBase64 = localData.replace(/\\n/g, '');\n          // 图片名称\n          var imageName = req.localIds[i].toString().split('/').pop();\n          (0, _takePhotoUtil.uploadBase64)(imageBase64).then(function (file) {\n            file.name = imageName;\n            var result = {\n              success: 'true',\n              data: file\n            };\n            cb(result);\n          });\n          if (i < req.localIds.length - 1) {\n            plugin.chooseImageSuccess(req, cb, i + 1);\n          }\n        },\n        fail: function fail(err) {\n          console.error('fail尝试获取图片base64数据, 但失败, 错误信息: ', err);\n          if (i < req.localIds.length - 1) {\n            plugin.chooseImageSuccess(req, cb, i + 1);\n          }\n        }\n      });\n    },\n    // 拍照或从手机相册中选图\n    selectPic: function selectPic() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      var type = data.type,\n        _data$count = data.count,\n        count = _data$count === void 0 ? 1 : _data$count,\n        _data$sizeType = data.sizeType,\n        sizeType = _data$sizeType === void 0 ? ['original'] : _data$sizeType;\n      var sourceType = !type || type === 'all' ? ['album', 'camera'] : [type];\n      window.wx.chooseImage({\n        count: count,\n        // 默认9\n        sizeType: sizeType,\n        // 原图或缩略图\n        sourceType: sourceType,\n        defaultCameraMode: 'normal',\n        isSaveToAlbum: 0,\n        success: function success(res) {\n          console.log('selectPic result:', res);\n          plugin.chooseImageSuccess(res, callback);\n        },\n        fail: function fail(err) {\n          return console.error('fail尝试调用企业微信的拍照功能, 但失败, 错误信息: ', err);\n        }\n      });\n    },\n    // 附件多选图片上传\n    choosePhotoImage: function choosePhotoImage() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      var _data$count2 = data.count,\n        count = _data$count2 === void 0 ? 9 : _data$count2,\n        _data$type = data.type,\n        type = _data$type === void 0 ? ['album'] : _data$type;\n      plugin.selectPic({\n        count: count,\n        type: type,\n        sizeType: ['original', 'compressed']\n      }, callback);\n    },\n    // 设置标题\n    setWebViewTitle: function setWebViewTitle(title) {\n      try {\n        document.title = title;\n        if (/ip(hone|od|ad)/i.test(navigator.userAgent)) {\n          var i = document.createElement('iframe');\n          i.src = '/favicon.ico';\n          i.style.display = 'none';\n          i.onload = function () {\n            setTimeout(function () {\n              i.remove();\n            }, 10);\n          };\n          document.body.appendChild(i);\n        }\n      } catch (error) {\n        console.error('setWebViewTitle', error);\n      }\n    },\n    // 语音转文字\n    translateVoice: function translateVoice(res, callback) {\n      window.wx.translateVoice({\n        localId: res.localId,\n        // 需要识别的音频的本地Id，由录音相关接口获得，音频时长不能超过60秒\n        isShowProgressTips: 1,\n        // 默认为1，显示进度提示\n        success: function success(res) {\n          // 语音识别的结果\n          var args = {\n            success: true,\n            data: res.translateResult\n          };\n          callback(args);\n        }\n      });\n    },\n    // 语音开始\n    startVoice: function startVoice() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      window.wx.startRecord();\n      // 监听录音自动停止接口\n      window.wx.onVoiceRecordEnd({\n        // 录音时间超过一分钟没有停止的时候会执行 complete 回调\n        complete: function complete(res) {\n          return plugin.translateVoice(res, callback);\n        }\n      });\n    },\n    // 语音结束\n    stopVoice: function stopVoice() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      window.wx.stopRecord({\n        success: function success(res) {\n          return plugin.translateVoice(res, callback);\n        }\n      });\n    },\n    // 获取地理位置\n    getLocation: function getLocation() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      var type = data && data.type ? data.type : 'wgs84';\n      window.wx.getLocation({\n        type: type,\n        // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\n        success: function success(res) {\n          var errMsg = res.errMsg,\n            others = _objectWithoutProperties(res, _excluded);\n          var status = false;\n          if (errMsg === 'getLocation:ok') {\n            status = true;\n          }\n          var data = {\n            data: others,\n            success: status,\n            error: errMsg\n          };\n          console.log('调用企业微信插件中getlocation，data:', data);\n          callback(data);\n        }\n      });\n    },\n    // 设置粘贴板内容\n    setClipboardData: function setClipboardData(data) {\n      window.wx.setClipboardData({\n        data: data,\n        success: function success(res) {\n          console.log('setClipboardData:', res.errMsg);\n        }\n      });\n    },\n    // 默认浏览器打开 此api仅在pc端生效，移动端不支持此api\n    openDefaultBrowser: function openDefaultBrowser(data) {\n      var url = data.url;\n      window.wx.invoke('openDefaultBrowser', {\n        url: url // 在默认浏览器打开redirect_uri，并附加code参数；也可以直接指定要打开的url，此时不会附带上code参数。\n      }, function (res) {\n        if (res.err_msg !== 'openDefaultBrowser:ok') {\n          console.error('打开默认浏览器失败', res.err_msg);\n          // 错误处理\n        }\n      });\n    },\n    /**\n     * 获取“转发”按钮点击状态及自定义分享内容接口\n     * 生效范围：移动端\n     */\n    onMenuShareAppMessage: function onMenuShareAppMessage(data) {\n      var title = data.title,\n        desc = data.desc,\n        link = data.link,\n        imgUrl = data.imgUrl,\n        _data$enableIdTrans = data.enableIdTrans,\n        enableIdTrans = _data$enableIdTrans === void 0 ? 0 : _data$enableIdTrans;\n      window.wx.onMenuShareAppMessage({\n        title: title,\n        // 分享标题\n        desc: desc,\n        // 分享描述\n        link: link,\n        // 分享链接；在微信上分享时，该链接的域名必须与企业某个应用的可信域名一致\n        imgUrl: imgUrl,\n        // 分享图标\n        enableIdTrans: enableIdTrans,\n        // 是否开启id转译，不填默认为0\n        success: function success() {\n          // 用户确认分享后执行的回调函数\n        },\n        error: function error(res) {\n          if (res.errMsg.indexOf('no permission') > 0) {\n            console.error('onMenuShareAppMessage 失败回调：未agentConfig');\n          }\n        },\n        cancel: function cancel() {\n          // 用户取消分享后执行的回调函数\n        }\n      });\n    },\n    openBluetooth: function openBluetooth() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n      window.wx.openBluetoothAdapter({\n        success: function success() {\n          getBluetoothAdapterState(function (resp) {\n            callback({\n              success: true,\n              data: resp\n            });\n          });\n        },\n        fail: function fail(err) {\n          sendErrorMessage(err, function (resp) {\n            callback({\n              success: true,\n              data: resp\n            });\n          });\n        }\n      });\n    },\n    bluetoothPrintData: function () {\n      var _bluetoothPrintData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var data,\n          callback,\n          payload,\n          _args = arguments;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              data = _args.length > 0 && _args[0] !== undefined ? _args[0] : {};\n              callback = _args.length > 1 ? _args[1] : undefined;\n              payload = data.payload;\n              workList.push(payload);\n              if (!isWorking) {\n                _context.next = 6;\n                break;\n              }\n              return _context.abrupt(\"return\", console.log('打印机工作中，请排队，当前还有' + workList.length + '个任务'));\n            case 6:\n              isWorking = true;\n              connectBluetooth(data, function () {\n                var result = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n                if (result.success) {\n                  printData(workList.shift(), function (_data) {\n                    return callback({\n                      success: true,\n                      data: _data\n                    });\n                  });\n                } else {\n                  sendErrorMessage(result, function (resp) {\n                    callback({\n                      success: true,\n                      data: resp\n                    });\n                  });\n                }\n              });\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      function bluetoothPrintData() {\n        return _bluetoothPrintData.apply(this, arguments);\n      }\n      return bluetoothPrintData;\n    }()\n  };\n  if (!isAndroid) {\n    // 安卓才支持这两个方法 choosePhotoImage\n    delete plugin.choosePhotoImage;\n  }\n  loadjs('https://res.wx.qq.com/open/js/jweixin-1.2.0.js', {\n    success: function success() {\n      console.log('wxwork jsBridge加载成功');\n      (0, _PluginManager.loadDynamicPlugin)(basePlugin);\n      callback && callback(false);\n      (0, _promiseUtil.getRootConfigPromise)().then(function (config) {\n        (0, _clientEnv.getAppTrdAuthData)(_const.WX_WORK).then(function (authData) {\n          if ((0, _clientEnv.isAuthSuccess)(authData)) {\n            var data = authData.data;\n            setWXConfig(data);\n          } else if (_global[\"default\"][_global.KD_PLUGIN]) {\n            console.error(\"\\u9274\\u6743\\u5931\\u8D25\\uFF0CgetAppTrdAuthData.do\\u63A5\\u53E3\\u8FD4\\u56DE\\u6570\\u636E\\uFF1A\".concat(JSON.stringify(authData)));\n            _global[\"default\"][_global.KD_PLUGIN][_const.AUTH_RESULT] = authData;\n            _global[\"default\"][_global.KD_PLUGIN][_const.AUTH_API_WHITE_LIST] = ['previewImage', 'scanQRCode', 'setClipboardData', 'getLocation', 'onMenuShareAppMessage'];\n            pluginReady && pluginReady();\n          }\n        });\n      });\n    },\n    error: function error() {\n      console.error('wxwork插件加载失败');\n      console.warn('外部插件安装失败: loadjs');\n    }\n  });\n  function setWXConfig(data) {\n    var config = data.config,\n      _data$agentConfig = data.agentConfig,\n      agentConfig = _data$agentConfig === void 0 ? {} : _data$agentConfig;\n    var signature = config.signature,\n      timestamp = config.timestamp,\n      nonce = config.nonce,\n      eid = config.eid;\n    var clientApiList = window.clientApiList || [];\n    var isConfigSuccess = true;\n    // 企业微信里的appId代表的是企业id不是应用id，所以这里应该取eid\n    window.wx.config({\n      beta: true,\n      // debug: true,\n      debug: false,\n      appId: eid,\n      timestamp: Number(timestamp),\n      nonceStr: nonce,\n      signature: signature,\n      jsApiList: ['closeWindow', 'scanQRCode', 'previewImage', 'chooseImage', 'getLocalImgData', 'startRecord', 'stopRecord', 'onVoiceRecordEnd', 'translateVoice', 'setClipboardData', 'openDefaultBrowser', 'onMenuShareAppMessage', 'getBluetoothDevices', 'getBLEDeviceServices', 'getBLEDeviceCharacteristics', 'writeBLECharacteristicValue', 'createBLEConnection', 'closeBLEConnection', 'openBluetoothAdapter', 'closeBluetoothAdapter', 'getBluetoothAdapterState', 'startBluetoothDevicesDiscovery', 'stopBluetoothDevicesDiscovery', 'onBluetoothAdapterStateChange', 'previewFile'].concat(_toConsumableArray(clientApiList))\n    });\n    // 微信API的奇葩设定: 进error之后还是会进入ready; 所以需要在外部声明一个变量, 用于进ready后的判断\n    window.wx.ready(function () {\n      if (isConfigSuccess) {\n        (0, _PluginManager.loadDynamicPlugin)(plugin);\n        pluginReady && pluginReady();\n        console.log('外部插件安装成功');\n        loadJwxwork(agentConfig);\n      }\n    });\n    window.wx.error(function () {\n      isConfigSuccess = false;\n      console.warn('外部插件安装失败: window.wx.error');\n    });\n  }\n\n  /**\n   *企业微信3.0.24以前的老版本，在调用wx.agentConfig之前，必须确保先成功调用wx.config\n   *agentConfig仅在企业微信2.5.0及以后版本支持，微信客户端不支持（微信开发者工具也不支持）\n   *仅部分接口才需要调用agentConfig，需注意每个接口的说明\n   *企业微信ios/mac 端如果出现 'wx.agentConfig undefined' 的报错，可将调用放在异步操作中进行，例如使用：setTimeout 包裹\n   */\n\n  function loadJwxwork(agentConfig) {\n    loadjs(window.__kd_cdnPath__ + '/public/thirdjs/wxwork/jwxwork-1.0.0.js', {\n      success: function success() {\n        console.log('jwxwork jsBridge加载成功');\n        var clientApiList = window.clientAgentApiList || [];\n        var corpid = agentConfig.eid,\n          agentId = agentConfig.agentId,\n          timestamp = agentConfig.timestamp,\n          nonce = agentConfig.nonce,\n          signature = agentConfig.signature;\n        window.wx.agentConfig({\n          corpid: corpid,\n          agentid: agentId,\n          // 应用id\n          timestamp: Number(timestamp),\n          nonceStr: nonce,\n          signature: signature,\n          jsApiList: ['selectExternalContact', 'onMenuShareAppMessage'].concat(_toConsumableArray(clientApiList)),\n          fail: function fail() {\n            console.error('jwxwork插件加载失败');\n          },\n          success: function success(res) {\n            console.error('jwxwork插件加载成功');\n          }\n        });\n      }\n    });\n  }\n  /**\n   * @description: 发送错误信息\n   * @param {*} data\n   * @return {*}\n   */\n  function sendErrorMessage(data, callback) {\n    selectDevice = null;\n    connectedDevice = null;\n    connectedCharacteristic = null;\n    allDevices = null;\n    isWorking = false;\n    workList = [];\n    console.error('error:', data);\n    if (data.hasOwnProperty('success')) {\n      callback && callback(data);\n    } else {\n      callback && callback({\n        success: false,\n        data: data\n      });\n    }\n  }\n  function sendSuccessMessage(data, callback) {\n    if (data.hasOwnProperty('success')) {\n      callback && callback(data);\n    } else {\n      callback && callback({\n        success: true,\n        data: data\n      });\n    }\n  }\n\n  /**\n   * @description: 检测本机蓝牙是否可用\n   * @param {*} callback\n   * @return {*}\n   */\n  function getBluetoothAdapterState(callback) {\n    window.wx.getBluetoothAdapterState({\n      success: function success() {\n        startBluetoothDevicesDiscovery(callback);\n      },\n      fail: function fail(res) {\n        sendErrorMessage(res, callback);\n      }\n    });\n  }\n\n  /**\n   * @description: 开始搜索蓝牙设备\n   * @param {*} callback\n   * @return {*}\n   */\n  function startBluetoothDevicesDiscovery(callback) {\n    setTimeout(function () {\n      window.wx.startBluetoothDevicesDiscovery({\n        success: function success() {\n          getBluetoothDevices(callback);\n        },\n        fail: function fail(res) {\n          sendErrorMessage(res, callback);\n        }\n      });\n    }, 1000);\n  }\n\n  /**\n   * @description: 获取蓝牙设备列表\n   * @param {*} callback\n   * @return {*}\n   */\n  function getBluetoothDevices(callback) {\n    setTimeout(function () {\n      window.wx.getBluetoothDevices({\n        services: [],\n        allowDuplicatesKey: false,\n        interval: 0,\n        success: function success(res) {\n          var devices = res.devices.filter(function (item) {\n            return item.name;\n          });\n          if (devices.length === 0) {\n            console.log('没有找到设备');\n            sendErrorMessage({\n              devices: devices\n            }, callback);\n            return;\n          }\n          allDevices = devices;\n          var deviceData = devices.map(function (item) {\n            return {\n              Name: item.name,\n              Code: item.deviceId\n            };\n          });\n          console.log('devices', devices);\n          var map = new Map();\n          var data = deviceData.filter(function (item) {\n            return !map.has(item.Code) && map.set(item.Code, item);\n          });\n          sendSuccessMessage(data, callback);\n        },\n        fail: function fail(res) {\n          console.log('获取蓝牙设备列表失败');\n          sendErrorMessage(res, callback);\n        }\n      });\n    }, 2000);\n  }\n  function getBLEDeviceServices(deviceId, callback) {\n    // 获取蓝牙设备的service服务\n    console.log('正在获取蓝牙设备服务');\n    setTimeout(function () {\n      window.wx.getBLEDeviceServices({\n        deviceId: deviceId,\n        success: function success(res) {\n          // 蓝牙模块提供的负责通信服务UUID字符串\n          console.log('res.services:', res.services);\n          getCharacteristic(deviceId, res.services, res.services.length - 1, callback);\n        },\n        fail: function fail(res) {\n          sendErrorMessage(res, callback);\n        }\n      });\n    }, 2000);\n  }\n  function getCharacteristic(deviceId, services, num, callback) {\n    if (num < 0) {\n      console.log('打印机无服务');\n      sendErrorMessage({}, callback);\n      return;\n    }\n    window.wx.getBLEDeviceCharacteristics({\n      deviceId: deviceId,\n      serviceId: services[num].uuid,\n      success: function success(res) {\n        for (var j = 0, leng = res.characteristics.length; j < leng; j++) {\n          if (res.characteristics[j].properties.write) {\n            // 找到支持写入特征值的第一个设备信息\n            connectedCharacteristic = {\n              deviceId: deviceId,\n              serviceId: services[num].uuid,\n              characteristicId: res.characteristics[j].uuid\n            };\n            // 找到可写入的设备，关闭蓝牙搜索\n            window.wx.stopBluetoothDevicesDiscovery({\n              success: function success() {\n                console.log('关闭蓝牙搜索');\n              }\n            });\n            // callback && callback({ success: true, data: true })\n            sendSuccessMessage(true, callback);\n            return;\n          }\n        }\n        // 没找到写入的设备，将num-1继续寻找。 当num === 0时，触发错误信息回调\n        if (num >= 0) {\n          num -= 1;\n          getCharacteristic(deviceId, services, num, callback);\n        }\n      },\n      fail: function fail() {\n        if (num >= 0) {\n          num -= 1;\n          getCharacteristic(deviceId, services, num, callback);\n        }\n      }\n    });\n  }\n  function openBluetoothAdapter(callback) {\n    window.wx.openBluetoothAdapter({\n      success: function success() {\n        getBluetoothAdapterState(callback);\n      },\n      fail: function fail(err) {\n        console.log(err);\n        sendErrorMessage(err, callback);\n      }\n    });\n  }\n  function connectBluetooth(_ref2, callback) {\n    var _allDevices;\n    var deviceCode = _ref2.deviceCode,\n      deviceName = _ref2.deviceName;\n    var isFirst = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    console.log('allDevices', allDevices);\n\n    // 是否第一次连接打印\n    // 这里有可能是从列表选中蓝牙后返回然后连接，也可能是根本没执行搜索蓝牙列表进行连接。\n    if (!((_allDevices = allDevices) !== null && _allDevices !== void 0 && _allDevices.length)) {\n      // 打印前判断是否有设备\n      // 如果没有，查找蓝牙设备\n      if (isFirst === false) {\n        return sendErrorMessage({\n          errMsg: '未寻找到蓝牙设备',\n          errCode: 10002\n        }, callback);\n      }\n      return openBluetoothAdapter(function () {\n        return connectBluetooth({\n          deviceCode: deviceCode,\n          deviceName: deviceName\n        }, callback, false);\n      });\n    }\n    selectDevice = allDevices.find(function (item) {\n      return (item === null || item === void 0 ? void 0 : item.name) === deviceName || (item === null || item === void 0 ? void 0 : item.deviceId) === deviceCode;\n    });\n    if (!selectDevice) {\n      return sendErrorMessage({\n        errMsg: '未寻找到蓝牙设备',\n        errCode: 10006\n      }, callback);\n    }\n    console.log('selectDevice', selectDevice);\n    window.wx.openBluetoothAdapter({\n      success: function success() {\n        console.log('connecting...');\n        window.wx.createBLEConnection({\n          deviceId: selectDevice.deviceId,\n          success: function success() {\n            connectedDevice = selectDevice;\n            getBLEDeviceServices(connectedDevice.deviceId, callback);\n          },\n          fail: function fail(err) {\n            console.log('connect fail', err);\n            sendErrorMessage(err, callback);\n          }\n        });\n      },\n      fail: function fail(err) {\n        console.log('init fail', err);\n        sendErrorMessage(err, callback);\n      }\n    });\n  }\n  /**\n   * @description: 关闭蓝牙设备连接\n   * @param {*} deviceId\n   * @return {*}\n   */\n  function closeAllBluetooth(deviceId) {\n    window.wx.closeBLEConnection({\n      deviceId: deviceId,\n      success: function success() {\n        console.log('closeBLEConnection，关闭蓝牙连接成功');\n        window.wx.closeBluetoothAdapter({\n          success: function success() {\n            return console.log('closeBluetoothAdapter关闭蓝牙适配器成功');\n          }\n        });\n      }\n    });\n  }\n  function printData(_x, _x2) {\n    return _printData.apply(this, arguments);\n  }\n  function _printData() {\n    _printData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(payload, callback) {\n      var isCanToastSuccess, toastSuccess, sendData, splitLen, _loop, i;\n      return _regeneratorRuntime().wrap(function _callee2$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            isCanToastSuccess = true;\n            console.log('正在发送打印数据', connectedCharacteristic);\n            // 成功提示。只提示一次（数据发送会连续成功）\n            toastSuccess = function toastSuccess() {\n              if (isCanToastSuccess) {\n                console.log('发送成功！');\n                isCanToastSuccess = false;\n              }\n            };\n            sendData = payload;\n            sendData = sendData.match(/[\\da-f]{2}/gi).map(function (h) {\n              return parseInt(h, 16);\n            });\n            // 系统与蓝牙设备会确定蓝牙4.0单次传输的数据大小，超过最大字节数后会发生写入错误，\n            // ios可能存在问题，如打印报错10008，则需要缩短延迟时间减小单次传输数据的大小为180/160/.../20\n            // 延迟时间过短会导致打印机卡死\n            console.log('打印数据', payload, sendData);\n            splitLen = 60;\n            _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n              var endLength, buffer, dataView, j;\n              return _regeneratorRuntime().wrap(function _loop$(_context2) {\n                while (1) switch (_context2.prev = _context2.next) {\n                  case 0:\n                    endLength = Math.min(splitLen, sendData.length - i);\n                    buffer = new ArrayBuffer(endLength);\n                    dataView = new DataView(buffer);\n                    for (j = 0; j < endLength; j++) {\n                      dataView.setUint8(j, sendData[i + j]);\n                    }\n                    _context2.prev = 4;\n                    _context2.next = 7;\n                    return new Promise(function (resolve, reject) {\n                      window.wx.writeBLECharacteristicValue({\n                        deviceId: connectedCharacteristic.deviceId,\n                        serviceId: connectedCharacteristic.serviceId,\n                        characteristicId: connectedCharacteristic.characteristicId,\n                        value: buffer,\n                        success: function success() {\n                          toastSuccess();\n                          resolve();\n                        },\n                        fail: function fail(res) {\n                          reject(res);\n                        }\n                      });\n                    });\n                  case 7:\n                    _context2.next = 13;\n                    break;\n                  case 9:\n                    _context2.prev = 9;\n                    _context2.t0 = _context2[\"catch\"](4);\n                    console.log('发送失败:', _context2.t0);\n                    sendErrorMessage(_context2.t0, callback);\n                  case 13:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }, _loop, null, [[4, 9]]);\n            });\n            i = 0;\n          case 9:\n            if (!(i < sendData.length)) {\n              _context3.next = 14;\n              break;\n            }\n            return _context3.delegateYield(_loop(), \"t0\", 11);\n          case 11:\n            i += splitLen;\n            _context3.next = 9;\n            break;\n          case 14:\n            if (workList.length) {\n              printData(workList.shift(), callback);\n            } else {\n              isWorking = false;\n              sendSuccessMessage(true, callback);\n              closeAllBluetooth(connectedCharacteristic.deviceId);\n            }\n          case 15:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee2);\n    }));\n    return _printData.apply(this, arguments);\n  }\n}\n\n//# sourceURL=webpack://bos-platform/./src/plugin/mobile/wxwork/plugin.js?");

/***/ }),

/***/ "./src/util/takePhotoUtil.js":
/*!***********************************!*\
  !*** ./src/util/takePhotoUtil.js ***!
  \***********************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.getImageFileFromH5Camera = getImageFileFromH5Camera;\nexports.getImageTypeFromBase64 = getImageTypeFromBase64;\nexports.uploadBase64 = uploadBase64;\n__webpack_require__(/*! core-js/modules/es.object.to-string.js */ \"../../node_modules/core-js/modules/es.object.to-string.js\");\n__webpack_require__(/*! core-js/modules/es.promise.js */ \"../../node_modules/core-js/modules/es.promise.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\n__webpack_require__(/*! core-js/modules/es.string.replace.js */ \"../../node_modules/core-js/modules/es.string.replace.js\");\n/**\n * @description 通过base64字符串, 去识别图片类型\n * @param [String]str base64字符串\n * @return [String]imageType 图片类型\n*/\nfunction getImageTypeFromBase64(str) {\n  var imageType = null;\n  switch (str.charAt(0)) {\n    case '/':\n      imageType = 'jpg';\n      break;\n    case 'i':\n      imageType = 'png';\n      break;\n    case 'R':\n      imageType = 'gif';\n      break;\n    case 'U':\n      imageType = 'webp';\n      break;\n    case 'Q':\n      imageType = 'bmp';\n      break;\n    default:\n      break;\n  }\n  return imageType;\n}\n\n/**\n * @description 去除前缀后, 将图片的base64数据, 按照云之家API格式上传\n * @param [String]imageBase64 base64字符串\n*/\nfunction uploadBase64(imageBase64Init) {\n  return new Promise(function (resolve, reject) {\n    // 正则去除base64标识, 传参需要\n    var rgx = /data:image\\/(\\S*);base64,/;\n    var imageBase64 = imageBase64Init.replace(rgx, '');\n    // 获取图片类型\n    var fileExt = getImageTypeFromBase64(imageBase64);\n    // 组合参数, 与云之家调用保持一致\n    // const result = {\n    //   success: 'true',\n    //   data: {\n    //     fileExt: fileExt || 'jpg',\n    //     fileData: imageBase64\n    //   }\n    // }\n    var result = {\n      fileExt: fileExt || 'jpg',\n      fileData: imageBase64\n    };\n    resolve(result);\n  });\n}\nvar input = null;\n/**\n * @description 从H5的拍照能力获取图片文件\n * \n*/\nfunction getImageFileFromH5Camera() {\n  return new Promise(function (resolve, reject) {\n    var resolveValue = function resolveValue(e) {\n      input.removeEventListener('change', resolveValue, false);\n      var file = e.target.files[0];\n      var reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = function (ev) {\n        var imageBase64 = ev.target.result;\n        resolve(imageBase64);\n      };\n    };\n    if (!input) {\n      input = document.createElement('input');\n      input.type = 'file';\n      input.accept = 'image/*';\n      input.capture = true;\n      input.style.display = 'none';\n      document.body.appendChild(input);\n    }\n    input.addEventListener('change', resolveValue, false);\n    input.click();\n  });\n}\n\n//# sourceURL=webpack://bos-platform/./src/util/takePhotoUtil.js?");

/***/ }),

/***/ "../../node_modules/core-js/modules/es.data-view.js":
/*!**********************************************************!*\
  !*** ../../node_modules/core-js/modules/es.data-view.js ***!
  \**********************************************************/
/***/ (function(__unused_webpack_module, __unused_webpack_exports, __webpack_require__) {

eval("var $ = __webpack_require__(/*! ../internals/export */ \"../../node_modules/core-js/internals/export.js\");\nvar ArrayBufferModule = __webpack_require__(/*! ../internals/array-buffer */ \"../../node_modules/core-js/internals/array-buffer.js\");\nvar NATIVE_ARRAY_BUFFER = __webpack_require__(/*! ../internals/array-buffer-native */ \"../../node_modules/core-js/internals/array-buffer-native.js\");\n\n// `DataView` constructor\n// https://tc39.github.io/ecma262/#sec-dataview-constructor\n$({ global: true, forced: !NATIVE_ARRAY_BUFFER }, {\n  DataView: ArrayBufferModule.DataView\n});\n\n\n//# sourceURL=webpack://bos-platform/../../node_modules/core-js/modules/es.data-view.js?");

/***/ })

}]);