"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[7856,9860],{704184:function(e,t,n){n.r(t),t.default={pageManage:"-T_D8zpF",dropPageMenu:"_1RhbludN",pageBtn:"M-SXYiuF",pageText:"_142T7-EZ",pageDeleteBtn:"_2RdvQfXP",selectedPageBtn:"_3-M7kMEP",pageAddBtn:"_2SC9tMYT","page-select":"_31lmWXZ0","drop-focus":"_3lGy61gW","page-dropdown-item":"_3350-vrA","arrow-down":"T1BmcdLM"}},41136:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(360776),n(505684),n(241872),n(323784),n(743924),n(205960),n(976896),n(297336),n(721300),n(846428),n(708896),n(969e3),n(606200),n(534440),n(76152),n(670864),n(76124),n(880920),n(836887),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(622676),n(233696),n(443616),n(686456),n(835164),n(492948),n(693917),n(927184),n(336368),n(387912),n(660824),n(997308);var a,o,i=I(n(211152)),u=I(n(795520)),l=M(n(790832)),s=n(218652),d=n(674260),c=M(n(385384)),f=n(868256),p=M(n(348896)),g=M(n(788008)),v=n(525896),m=n(545072),y=n(199860),h=M(n(882976)),P=n(869504),b=I(n(888344)),O=n(251536),E=n(331428),D=n(142408),S=["paper","pages"],_=["module"];function M(e){return e&&e.__esModule?e:{default:e}}function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(j=function(e){return e?n:t})(e)}function I(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=j(t);if(n&&n.has(e))return n.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(a,i,u):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function A(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e,t,n){return(t=L(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,u=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return u}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:String(t)}function U(e,t,n){return t=B(t),function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,V()?Reflect.construct(t,n||[],B(e).constructor):t.apply(e,n))}function V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(V=function(){return!!e})()}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}var W=0,Y=(a=(0,p.default)(!0),(0,c.default)(o=a(o=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=U(this,t,[e])).showMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=n.props.model.pageId,a={type:t,content:e,duration:2e3,level:m.MSG_LEVEL.warning,pageId:r};(0,s.setDataMessages)(r,a)},n.handleOpenCustomDsModal=function(){n.invokeComponentCustomEvent(D.CUSTOM_EVENT_OPEN_CUSTOMDS_MODAL)},n.handleOpenRefDsModal=function(){n.invokeComponentCustomEvent(D.CUSTOM_EVENT_OPEN_REFDS_MODAL)},n.handleChangePLang=function(e,t){t&&n.save();var r=n.props.model.getPost(),a=t?{language:e,postData:r}:{language:e};n.invokeComponentCustomEvent(D.CUSTOM_EVENT_CHANGE_PRINT_LANG,a)},n.handlePassGridActionGuide=function(){n.invokeComponentCustomEvent(D.CUSTOM_EVENT_PASS_GRID_ACTION_GUIDE)},n.handlePassPrintActionGuide=function(){n.invokeComponentCustomEvent(D.CUSTOM_EVENT_PASS_PRINT_ACTION_GUIDE)},n.handleOpenDGridSortSettingEdModal=function(e){n.invokeComponentCustomEvent(D.CUSTOM_EVENT_OPEN_GRID_SORT_FIELDS,e)},n.handleOpenDGridFilterSettingEdModal=function(e){n.invokeComponentCustomEvent(D.CUSTOM_EVENT_OPEN_GRID_FILTER_SETTING,e)},n.handleChangeFileName=function(e){n.invokeComponentCustomEvent("prtChangeFileName",e)},n.invokePrintDesignerCustomEvent=function(e,t){n.invokeComponentCustomEvent(e,t)},n.getPrintData=function(){n.save();var e=n.props,t=e.model,r=e.dispatch,a=l.default.cloneDeep(n.state.data);a.pages.forEach((function(e){e.forEach((function(e){var t;e.bindField=n.filterKeys(e.bindField),e.mergeByField=n.filterKeys(e.mergeByField),e.mergeSummaryField=(null===(t=e.mergeSummaryField)||void 0===t?void 0:t.map(n.filterKeys))||[]}))})),r((0,O.invokeControlService)(t,"updatePrintData",[a]))},n.componentDidMount=function(){n.setPropertyHandler=n.props.model.sub_Event("updateSortFields",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.setProperty(e)})),n.updateFilterSetting=n.props.model.sub_Event("updateFilterSetting",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.setProperty(e,"filterSetting")})),n.updateFileName=n.props.model.sub_Event("updateFileName",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.setProperty(e,"fileName")})),n.removeInstructListener=(0,d.addDataChangeListener)(f.KEY_GET_PRINT_DATA,n.getPrintData),n.removeValidateEventListener=(0,d.addDataChangeListener)(f.KEY_VALIDATE_EVENT,(function(e){var t=e.pageId;(void 0===t?"":t)===n.props.model.pageId&&n.save()}))},n.componentWillUnmount=function(){0===--W&&(0,d.setData)(f.KEY_TRAYMENU,!0),n.removeValidateEventListener&&n.removeValidateEventListener(),n.removeInstructListener&&n.removeInstructListener(),n.setPropertyHandler&&n.props.model.unsub_Event(n.setPropertyHandler),n.updateFilterSetting&&n.props.model.unsub_Event(n.updateFilterSetting),n.updateFileName&&n.props.model.unsub_Event(n.updateFileName)},n.setProperty=function(e,t){var r;null===(r=n.printDesignerRef.current)||void 0===r||r.setProperty(e,t)},n.filterKeys=function(e){return(null==e?void 0:e.split(".").filter((function(e){return!e.includes("$reportEntryGroup$")})).join("."))||""},n.save=function(){var e,t=n.props.model,r=t.key,a=t.pageId;null===(e=n.printDesignerRef.current)||void 0===e||e.beforeSave();var o=l.default.cloneDeep(n.state.data);o.pages.forEach((function(e){e.forEach((function(e){var t;e.bindField=n.filterKeys(e.bindField),e.mergeByField=n.filterKeys(e.mergeByField),e.mergeSummaryField=(null===(t=e.mergeSummaryField)||void 0===t?void 0:t.map(n.filterKeys))||[]}))})),n.props.dispatch((0,s.convertAppModelFunctionAction)((0,s.setControlPostValue)(a,r,o)))},n.invokeComponentCustomEvent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=n.props.model,a=r.pageId,o=[r.key,e,t||""];i.default[i.INVOKE_CUSTOM_EVENT](a,"",o)},n.componentWillMount=function(){W++,(0,d.setData)(f.KEY_TRAYMENU,!1);var e=(0,s.getDataProperty)(n.props.model.pageId,n.props.model.key,"open_args")(n.props.model.state);if(e){var t=R(e.toJS(),1)[0];if(n.previousOpenArgs=t,t.Datasource=J(t.Datasource),t){var r=t.Datasource,a=t.Metadata,o=t.IsFirstUseGrid,i=t.IsFirstVisit,u=t.Function;n.setState({definition:r,data:a,isFirstUseGrid:o,isFirstVisit:i,expressions:u})}else h.default.error("no open arg")}},n.resetAndSetState=function(e,t){var r,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=null===(r=n.printDesignerRef.current)||void 0===r?void 0:r.resetPatches,u=null===(a=n.printDesignerRef.current)||void 0===a?void 0:a.resetData;i(),u(t,!1),n.setState(T({data:e,undo:[],redo:[]},o))},n.UNSAFE_componentWillReceiveProps=function(e){var t=(0,s.getDataProperty)(e.model.pageId,e.model.key,"open_args")(e.model.state);if(t){var r,a=R(t.toJS(),1)[0],o=null===(r=n.printDesignerRef.current)||void 0===r?void 0:r.pushUndoPatch,i=a.Metadata,u=J(a.Datasource),d=i;if(l.default.isEqual(n.state.definition,u)||n.previousOpenArgs&&l.default.isEqual(u,n.previousOpenArgs.Datasource)||n.setState({definition:u}),n.isStashMeta||!l.default.isEqual(n.state.data,d)&&(!n.previousOpenArgs||!l.default.isEqual(i,n.previousOpenArgs.Metadata)))if(n.isStashMeta){var c=n.generatePrintData({data:d}).printData,f=n.generatePrintData().printData;n.resetAndSetState(d,c),o(f,c)}else{var p=n.generatePrintData({data:d,curPage:0}).printData;n.resetAndSetState(d,p,{currentPointedPageIdx:0})}n.previousOpenArgs&&l.default.isEqual(n.previousOpenArgs,a)||(n.previousOpenArgs=a)}},n.componentDidUpdate=function(e,t){n.state.currentPointedPageIdx,t.currentPointedPageIdx;var r=n.state.data,a=r.pages,o=void 0===a?[]:a,i=r.paper;n.dataRef.current.length=0,n.dataRef.current.push(i),o.forEach((function(e){e.forEach((function(e){n.dataRef.current.push(e)}))}))},n.onData=function(e,t,r){var a;h.default.log("onData idx",e,t,r);var o=null==r?void 0:r.type;if(!(null!=r&&r.value&&"Attr"===(null==r||null===(a=r.value)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.type)||"reset"===o)){var i=n.props.model,u=(i.key,i.pageId,l.default.cloneDeep(n.state.data).paper),s=(null==t?void 0:t.config)||{},d=!1;if("redo"===o||"undo"===o){var c,f=s.curPage,p=void 0===f?0:f,g=s.pages,v=void 0===g?1:g,m=n.state,y=m.undo,P=m.redo,b=l.default.cloneDeep(n.state.data.pages);if("undo"===o?(c=(y||[]).pop())&&P.push(c):(c=(P||[]).pop())&&y.push(c),v!==b.length){var O,E;if(v>b.length)if("delete"===(null===(O=c)||void 0===O?void 0:O.type)){var D=c,S=D.index,_=D.item;b.splice(S,0,_)}else b.push([]);else if("delete"===(null===(E=c)||void 0===E?void 0:E.type)){var M=c.index;b.splice(M,1)}else b.pop();var j=Object.assign({},n.state.data,{pages:b});return void n.setState({currentPointedPageIdx:p,data:j,undo:A(y),redo:A(P)})}if(p!==n.state.currentPointedPageIdx)return n.setState({currentPointedPageIdx:p})}else"BatchActions"===r.type&&(null==r?void 0:r.oldValue.config.pages)>(null==r?void 0:r.value.config.pages)||(d=!0);var I=t.items,w=R(I,1)[0],C=l.default.isEqual(w,u)?{}:{paper:w},N=l.default.cloneDeep(n.state.data.pages);N[n.state.currentPointedPageIdx]=I.slice(1);var F=Object.assign({},n.state.data,T({pages:N},C));if(!l.default.isEqual(F,n.state.data)){var k=d?{undo:[].concat(A(n.state.undo),[{eventPlaceholder:null}])}:{};n.setState(T({data:F},k))}}},n.addPage=function(){var e;if(!(n.state.data.pages.length>=b.LIMIT_PAGE_COUNT)){var t=null===(e=n.printDesignerRef.current)||void 0===e?void 0:e.attrActions,r=l.default.cloneDeep(n.state.data.pages).concat([[]]),a=Object.assign({},n.state.data,{pages:r}),o=r.length-1;t([{value:{curPage:o,pages:r.length},attrName:"config"},{value:n.generatePrintData({data:a,curPage:o}).pages[o],attrName:"items"}]),n.setState({currentPointedPageIdx:o,data:a})}},n.changePage=function(e){if(e!==n.state.currentPointedPageIdx){var t,r=null===(t=n.printDesignerRef.current)||void 0===t?void 0:t.attrActions,a=n.state.data,o=e,i=n.generatePrintData({data:a,curPage:o}).pages;r([{value:{curPage:o,pages:i.length},attrName:"config"},{value:i[o],attrName:"items"}]),n.setState({currentPointedPageIdx:o})}},n.deletePage=function(e,t){var r;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0;var a=n.state.currentPointedPageIdx,o=l.default.cloneDeep(n.state.data.pages),i=null===(r=n.printDesignerRef.current)||void 0===r?void 0:r.attrActions,u=o[t];o.splice(t,1);var s=Object.assign({},n.state.data,{pages:o}),d={index:t,item:u,type:"delete"},c=t<=a?Math.max(a-1,0):a;i([{value:{curPage:c,pages:n.generatePrintData({data:s,curPage:c}).pages.length},attrName:"config"}]),t>a?n.setState({data:s,undo:[].concat(A(n.state.undo||[]),[d])}):n.setState({currentPointedPageIdx:Math.max(a-1,0),data:s,undo:[].concat(A(n.state.undo||[]),[d])})},(0,v.getPrintMetadata)(e.model.componentData.getIn(["open_args",0,"Metadata","bizType"])).then((function(e){h.default.log(e),n.setState({meta:e})})).catch((function(e){h.default.log(e)}));var r={};return h.default.log("mock meta data",r),n.printDesignerRef=(0,u.createRef)(null),n.state={meta:null,data:r,definition:[],expressions:[],currentPointedPageIdx:0,undo:[],redo:[],isFirstUseGrid:!1,isFirstVisit:!1,isModuleExsit:!1},n.dataRef=u.default.createRef([]),n.dataRef.current=n.dataRef.current||[],n.previousOpenArgs=null,n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(t,e),n=t,r=[{key:"generatePrintData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?this.state.data:t,r=e.curPage,a=void 0===r?this.state.currentPointedPageIdx:r,o=n.paper,i=n.pages,u=C(n,S),l=i.map((function(e){return[o].concat(A(e))}));return{pages:l,printData:T(T({},u),{},{items:l[a],config:{curPage:a,pages:l.length}})}}},{key:"render",value:function(){var e=this;h.default.log(this.props);var t=this.state,n=t.data,r=t.meta,a=t.definition,o=t.currentPointedPageIdx,i=t.isFirstUseGrid,s=t.isFirstVisit,d=t.expressions;if(!r||l.default.isEmpty(n))return u.default.createElement(H,null);var c=this.generatePrintData({data:n,curPage:o}),f=c.pages,p=c.printData,g=u.default.createElement(b.default,{pages:f,changePage:this.changePage,deletePage:this.deletePage,addPage:this.addPage,currentPointedPageIdx:o});return u.default.createElement($,{ref:this.printDesignerRef,dataRef:this.dataRef,pageManage:g,expressions:d,meta:r,data:p,definition:a,onData:function(t,n){h.default.log("printDesigner---------ondata",t,n),e.onData(o,t,n)},showMessage:this.showMessage,handleOpenCustomDsModal:this.handleOpenCustomDsModal,handleOpenRefDsModal:this.handleOpenRefDsModal,handleChangePLang:this.handleChangePLang,handlePassGridActionGuide:this.handlePassGridActionGuide,handlePassPrintActionGuide:this.handlePassPrintActionGuide,handleOpenDGridSortSettingEdModal:this.handleOpenDGridSortSettingEdModal,handleOpenDGridFilterSettingEdModal:this.handleOpenDGridFilterSettingEdModal,handleChangeFileName:this.handleChangeFileName,invokePrintDesignerCustomEvent:this.invokePrintDesignerCustomEvent,isFirstUseGrid:i,isFirstVisit:s,getLangMsg:E.getLangMsg})}}],r&&x(n.prototype,r),a&&x(n,a),Object.defineProperty(n,"prototype",{writable:!1}),t}(u.default.Component))||o)||o),$=(0,u.forwardRef)((function(e,t){var n=(0,P.useFederatedModule)("print").Component;return n?u.default.createElement(q,w({},e,{ref:t,module:n})):u.default.createElement(H,null,u.default.createElement("div",{className:g.default.spinDivText},(0,E.getLangMsg)("PrintDesigner.key0002"))," ")})),q=(0,u.forwardRef)((function(e,t){var n=e.module,r=C(e,_),a=n||{},o=a.PrintDesigner,i=a.useInstallFontFamilyOnline,l=r.meta.FontMapping;return i(l&&l.reduce((function(e,t){t.Name;var n=t.RcId,r=t.Code;return n?(e[r]="".concat("api/print/download.do?rcId=").concat(n),e):e}),{}))?u.default.createElement(o,w({},r,{ref:t})):u.default.createElement(H,null,u.default.createElement("div",{className:g.default.spinDivText},(0,E.getLangMsg)("PrintDesigner.key0002"))," ")})),H=function(e){var t=e.children;return u.default.createElement("div",{className:g.default.spinDiv},u.default.createElement(y.Spin,{name:"Spin"}),t)},J=function e(t){if(t)return t.reduce((function(t,n){var r=n,a=r.Items,o=r.Type,i=r.Id,u=r.Name,l=r.Key;return"ReportEntryGroup"===o&&null!=a&&a.length?(n={Items:e(a),Id:i,bindField:i,dataSource:l,Name:u,Icon:"danjuti",isReportEntryGroup:!0,Key:"$$reportEntryGroup$$_".concat(l)},t.push(n)):null!=a&&a.length?(n=T(T({},n),{},{Items:e(a)}),t.push(n)):t.push(n),t}),[])};t.default=Y},888344:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(360776),n(622676),n(233696),n(505684),n(323784),n(743924),n(205960),n(976896),n(721300),n(846428),n(969e3),n(606200),n(534440),n(76152),n(76124),n(387912),n(633768),n(690512),n(78504),n(776512),n(997308),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultAndDropPages=t.default=t.LIMIT_PAGE_COUNT=void 0,n(9692),n(835164),n(693917);var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(a,i,u):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}(n(795520)),o=d(n(671252)),i=d(n(704184)),u=n(199860),l=d(n(139224)),s=n(331428);function d(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){var a;return a=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==r(a)?a:String(a))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,u=[],l=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return u}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=t.LIMIT_PAGE_COUNT=20,h=t.getDefaultAndDropPages=function(e,t){var n=e.slice(t),r=e.slice(0,t);return 1===n.length&&(r=r.concat(n),n=[]),{dropPages:n,defaultPages:r}};t.default=function(e){var t=e.pages,n=e.changePage,r=e.deletePage,d=e.addPage,c=e.currentPointedPageIdx,f=v((0,a.useState)(-1),2),m=f[0],P=f[1],b=v((0,a.useState)(y),2),O=b[0],E=b[1],D=v((0,a.useState)(-1),2),S=D[0],_=D[1],M=h(t,O),j=M.dropPages,I=M.defaultPages,w=v((0,a.useState)(I),2),C=w[0],A=w[1],N=v((0,a.useState)(j),2),T=N[0],F=N[1],R=(0,a.useRef)(t.length),k=(0,a.useRef)(),G=v((0,a.useState)(72),2),x=G[0],L=G[1];(0,a.useEffect)((function(){var e=h(t,O),n=e.dropPages,r=e.defaultPages;F(n),A(r)}),[O,t]),(0,a.useEffect)((function(){k.current&&L(Math.min(k.current.offsetWidth,150))}),[k.current]),(0,a.useEffect)((function(){var e=T.length+C.length,t=e-1;T.length>0?e>R.current?P(t):e<R.current?m>t&&P(t):-1===m?c>=C.length?P(c):P(t):m<C.length-1?P(t):c>=C.length?P(c):P(t):P(-1),R.current=e}),[C.length,T.length,c]);var U=(0,a.useRef)(),V=function(e){for(var t=document.getElementsByClassName("kdesigner-select-item-option"),n=t.length,r=0;r<n;){if(t[r].contains(e.target))return void _(r);r++}},B=function(){_(-1)},K=function(e,t){r(e,t)};return(0,a.useEffect)((function(){if(U.current){var e=(0,l.default)(U.current,(function(){if(U.current){var e=U.current.parentElement.clientWidth,t=32+(x+12),n=Math.floor((e-t)/x);E(n=n>y?y:n)}}));return function(){e.removeResizeObserve()}}}),[x]),a.default.createElement("div",{className:i.default.pageManage,ref:U},C.map((function(e,t,r){return a.default.createElement("div",{key:t,ref:t===r.length-1?k:null,className:(0,o.default)(i.default.pageBtn,g({},i.default.selectedPageBtn,c===t)),onClick:function(){return n(t)}},a.default.createElement("span",{className:i.default.pageText,title:"".concat((0,s.getLangMsg)("PrintDesigner.key0001")).concat(t+1)},(0,s.getLangMsg)("PrintDesigner.key0001"),t+1),r.length>1&&a.default.createElement("span",{className:i.default.pageDeleteBtn,onClick:function(e){return K(e,t)}},a.default.createElement(u.Icon,{type:"close"})))})),T.length>0&&a.default.createElement(u.Select,{borderType:"bordered",defaultValue:O,value:m,className:i.default["page-select"],onChange:function(e){P(e),n&&n(e)},dropdownRender:function(e){return a.default.cloneElement(e,p(p({},e.props),{},{onMouseOver:V,onMouseLeave:B}))}},T.map((function(e,t){return a.default.createElement(u.Select.Option,{value:t+O},a.default.createElement("div",{title:"".concat((0,s.getLangMsg)("PrintDesigner.key0001")).concat(O+t+1),className:(0,o.default)(i.default.dropPageMenu,g({},i.default["drop-focus"],c+1>C.length))},(0,s.getLangMsg)("PrintDesigner.key0001"),O+t+1,S===t&&a.default.createElement("span",{className:i.default.pageDeleteBtn,onClick:function(e){return K(e,t+O)}},a.default.createElement(u.Icon,{type:"close"}))))}))),t.length<y&&a.default.createElement("div",{onClick:function(){d()},className:i.default.pageAddBtn},a.default.createElement(u.Icon,{type:"add"})))}}}]);