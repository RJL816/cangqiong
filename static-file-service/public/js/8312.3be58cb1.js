"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[8312],{684648:function(t,e,n){n.r(e),e.default={"wave-progress-box-wrap":"_31uaz04w","wave-progress-box":"krLleyVI",wave:"M0EIHuVV","wave-mask":"_3XszlMQ1",toRotate:"_2ZmOrEqO","percent-txt":"gPd9Usjk",percent:"_1jUR4tOP"}},232464:function(t,e,n){n.r(e),e.default={"icon-container":"_3PoLdV0S",right0:"_2q6ytENL",no:"_1nxmWA5c","amount-box":"_18bJAv4N"}},755532:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n(182320),n(909112),n(697060),n(505684),n(743924),n(693917),n(976896),n(721300),n(606200),n(534440),n(387912),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(323784),n(571176);var o,u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=r(t)&&"function"!=typeof t)return{default:t};var n=i(e);if(n&&n.has(t))return n.get(t);var o={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var l=u?Object.getOwnPropertyDescriptor(t,a):null;l&&(l.get||l.set)?Object.defineProperty(o,a,l):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}(n(795520)),a=(o=n(790832))&&o.__esModule?o:{default:o};function i(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(i=function(t){return t?n:e})(t)}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,u,a,i=[],l=!0,c=!1;try{if(u=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=u.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var f=function(t,e,n,r,o,a,i,l,c){(0,u.useEffect)((function(){var u=function(u,i){var l,c=u,f=0,s=0,d=i||u.offsetWidth,p=u.offsetHeight;c.onmousedown=function(u){t&&t(!0),e(!0);var i=n.current,y=i.browserWidth,m=i.browserHeight;u=u||window.event;return l=u.clientX,f=u.clientX-this.offsetLeft,s=u.clientY-this.offsetTop,document.onmousemove=function(t){t=t||window.event;c.style.position="absolute",c.style.left=t.clientX-f+"px",c.style.right="auto",t.clientX-f<=0?c.style.left=0:d-f+t.clientX>=y&&(c.style.left=y-d+"px"),c.style.top=t.clientY-s+"px",t.clientY-s<=0?c.style.top=0:p-s+t.clientY>=m&&(c.style.top=m-p+"px"),r({left:c.style.left,top:c.style.top}),o({left:c.style.left,top:c.style.top,width:d,height:p})},document.onmouseup=function(n){t&&t(!1),e(!1),(n.clientX-l>3||n.clientX-l<-3)&&a&&a(!0),document.onmousemove=null,document.onmouseup=null},!1}};n.current.browserWidth=document.documentElement.clientWidth,n.current.browserHeight=document.documentElement.clientHeight,i.current&&c&&i.current.children[1]?u(i.current.children[1]):i.current&&i.current.firstElementChild&&u(i.current.firstElementChild,40)}),[c,l,i.current])},s=function(t,e,n,r,o){var i=function(e,n,o){var u,a,i=e.offsetLeft,l=e.offsetWidth,c=e.offsetHeight,f=e.offsetTop,s=t.current.browserWidth,d=t.current.browserHeight;i+l>t.current.browserWidth&&(u=s-l-(n-i-l)*s/n,e.style.left=u+"px"),f+c>t.current.browserHeight&&(a=d-c-(o-f-c)*d/o,e.style.top=a+"px"),r({left:u,top:a})};(0,u.useEffect)((function(){var r=a.default.throttle((function(){var r=t.current.browserWidth,o=t.current.browserHeight;t.current.browserWidth=document.documentElement.clientWidth,t.current.browserHeight=document.documentElement.clientHeight,e.current&&n&&e.current.children[1]?i(e.current.children[1],r,o):e.current&&e.current.firstElementChild&&i(e.current.firstElementChild,r,o)}),300);return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}}),[n,o,e.current])};e.default=function(t){var e=t.children,n=t.getPosition,r=t.setDragFlag,o=t.reRenderFlag,a=t.size,i=t.setDragIngFlag,c=(0,u.useRef)(null),d=(0,u.useRef)({}),p=l((0,u.useState)({}),2),y=p[0],m=p[1],v=l((0,u.useState)(!1),2),h=v[0],g=v[1];return f(i,g,d,n,m,r,c,a,o),s(d,c,o,n,a),u.default.createElement("div",{ref:c},e,h?u.default.createElement("div",{style:{width:"500px",height:"500px",position:"absolute",left:"".concat(parseInt(y.left)-(500-y.width)/2,"px"),top:"".concat(parseInt(y.top)-(500-y.height)/2,"px"),zIndex:2}}):null)}},416936:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(387912),n(78504),n(776512),n(977864),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(571176);var o,u=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=r(t)&&"function"!=typeof t)return{default:t};var n=i(e);if(n&&n.has(t))return n.get(t);var o={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var l=u?Object.getOwnPropertyDescriptor(t,a):null;l&&(l.get||l.set)?Object.defineProperty(o,a,l):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}(n(795520)),a=(o=n(684648))&&o.__esModule?o:{default:o};function i(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(i=function(t){return t?n:e})(t)}var l=function(t,e){var n=t.percent,r=t.doneRate,o="".concat(100===n?"-70":40-n,"%");return u.default.createElement("div",{className:a.default["wave-progress-box-wrap"]},u.default.createElement("div",{className:a.default["wave-progress-box"],ref:e},u.default.createElement("div",{className:a.default.wave}),u.default.createElement("div",{className:a.default["wave-mask"],style:{top:o}}),u.default.createElement("div",{className:"".concat(a.default["percent-txt"])},0===n?r:u.default.createElement(u.default.Fragment,null,parseInt(n),u.default.createElement("i",{className:a.default.percent},"%")))))};e.default=(0,u.forwardRef)(l)},232500:function(t,e,n){function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n(182320),n(909112),n(697060),n(505684),n(743924),n(693917),n(976896),n(721300),n(606200),n(534440),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(e,"__esModule",{value:!0}),e.useSystemTaskNotice=e.default=void 0,n(9692),n(622676),n(443616),n(323784),n(387912);var o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=r(t)&&"function"!=typeof t)return{default:t};var n=y(e);if(n&&n.has(t))return n.get(t);var o={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var i=u?Object.getOwnPropertyDescriptor(t,a):null;i&&(i.get||i.set)?Object.defineProperty(o,a,i):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}(n(795520)),u=p(n(369396)),a=p(n(232464)),i=p(n(123876)),l=p(n(416936)),c=n(608008),f=n(331428),s=p(n(755532)),d=p(n(790832));function p(t){return t&&t.__esModule?t:{default:t}}function y(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(y=function(t){return t?n:e})(t)}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,u,a,i=[],l=!0,c=!1;try{if(u=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=u.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var h=e.useSystemTaskNotice=function(){var t=m((0,o.useState)(!1),2),e=t[0],n=t[1],r=m((0,o.useState)(!1),2),u=r[0],a=r[1],i=m((0,o.useState)(!1),2),l=i[0],c=i[1],f=m((0,o.useState)(!1),2),s=f[0],d=f[1],p=(0,o.useRef)(),y=(0,o.useRef)();return{showList:e,taskListRef:p,IconWrapRef:y,handleFollowPosition:function(t){e&&y&&y.current&&(y.current.style.left=t.left,y.current.style.top=t.top)},setDragFlag:c,setInDrag:d,inDrag:s,setShowAmount:a,dragFlag:l,handleListShow:function(){a(!1);var t=p&&p.current;t&&(t.style.display=e?"none":"block"),n((function(t){return!t}))},showAmount:u,setShowList:n}},g=function(t,e,n){(0,o.useEffect)((function(){var r=function(r){var o=t&&t.current;if(o){for(var u=r.target;u;){if(u===o||u.parentNode===o)return;u=u.parentNode}e&&(o.style.display="none",n(!1))}};return document.addEventListener("click",r),function(){document.removeEventListener("click",r)}}),[t,e,n])},b=function(t,e,n){(0,o.useEffect)((function(){var r=d.default.throttle((function(){var r=t&&t.current;r&&e&&(r.style.display="none",n(!1))}),300);return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}}),[t,e])};e.default=function(){var t=(0,o.useContext)(c.SystemUIContext).uiData,e=h(),n=e.showList,r=e.taskListRef,d=e.IconWrapRef,p=e.handleFollowPosition,y=e.setDragFlag,m=e.setInDrag,v=e.inDrag,S=e.setShowAmount,_=e.dragFlag,w=e.handleListShow,E=e.showAmount,T=e.setShowList;g(r,n,T),b(r,n,T);var O=t.size,A=["RUNNING","BEGIN"],k=t.filter((function(t){return A.includes(t.get("status"))})).size||0,L=t.getIn([O-1,"progress"])/100*100,I="".concat(O-k,"/").concat(O);return O?u.default.createPortal(o.default.createElement(s.default,{getPosition:function(t){p(t)},setDragFlag:function(){y(!0)},reRenderFlag:n,size:t.size,setDragIngFlag:function(t){m(t)}},o.default.createElement("div",{className:"".concat(a.default["icon-container"]," ").concat(n?a.default.right0:""),onMouseEnter:function(){!v&&S(!0)},onMouseLeave:function(){S(!1)},onClick:function(t){t.stopPropagation(),_?y(!1):w()},ref:d},o.default.createElement(l.default,{percent:L,doneRate:I}),E&&k?o.default.createElement("div",{className:"".concat(a.default["amount-box"])},k,(0,f.getLangMsg)({key:"taskNotice.key0008"})):null),o.default.createElement(i.default,{taskList:t,isSystem:!0,ref:r,iconRef:d})),document.body,!0):null}},633216:function(t,e,n){n(606200),Object.defineProperty(e,"__esModule",{value:!0}),e.changeCount=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add";"add"===t?s++:s--},e.clearTasks=function(t,e){return f.default.postApi("task/clearTasks.do",e).then((function(e){(0,u.doPostActions)(t,e,o.doGlobalDispatch,!0)})).catch((function(t){}))},e.default=function(){var t=(0,i.getData)(l.KEY_SYSTEM_PARAM);t?d(t.initTasksInfo):(0,i.addDataChangeListener)(l.KEY_SYSTEM_PARAM,(function(){d((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).initTasksInfo)}));(0,u.addReducer)(a.ADD_TASK,(function(t,e){var n=e.data[0],r=(0,i.getData)(l.KEY_TASK_LISTS)||(0,c.List)();-1===r.findIndex((function(t){return t.get("taskid")===n.taskid}))&&(r=r.push((0,c.fromJS)(n)));var o=(0,i.getData)(l.KEY_SYSTEM_TASK_NOTICE)||[!1,(0,c.List)()];return o[0]=o.length&&o[0],s||(o[0]=!0),o[1]=r,(0,i.updateData)(l.KEY_SYSTEM_TASK_NOTICE,(0,c.List)([]),(function(){return o})),(0,i.setData)(l.KEY_TASK_LISTS,r),t})),(0,u.addReducer)(a.UPDATE_TASK,(function(t,e){var n=e.data[0];return(0,i.updateData)(l.KEY_TASK_LISTS,(0,c.List)(),(function(t){var e=t.findIndex((function(t){return t.get("taskid")===n.taskid}));-1!==e&&(t=t.update(e,(0,c.List)([]),(function(t){return(0,c.fromJS)(Object.assign({},t.toJS(),n))})));var r=(0,i.getData)(l.KEY_SYSTEM_TASK_NOTICE)||[!1,(0,c.List)()];return r[1]=t,(0,i.updateData)(l.KEY_SYSTEM_TASK_NOTICE,(0,c.List)([]),(function(){return r})),t})),t})),(0,u.addReducer)(a.DEL_TASK,(function(t,e){var n=e.data.map((function(t){return t.taskid}));return(0,i.updateData)(l.KEY_TASK_LISTS,(0,c.List)(),(function(t){t=t.filter((function(t){return!n.includes(t.get("taskid"))}));var e=(0,i.getData)(l.KEY_SYSTEM_TASK_NOTICE)||[!1,(0,c.List)()];return e[0]=e.length&&e[0],Boolean(t.size)||(e[0]=!1),e[1]=t,(0,i.updateData)(l.KEY_SYSTEM_TASK_NOTICE,(0,c.List)([]),(function(){return e})),t})),t}))},e.getCount=function(){return s},e.initTaskLists=d,e.taskClick=function(t,e){return f.default.postApi("task/taskClick.do",e).then((function(e){(0,u.doPostActions)(t,e,o.doGlobalDispatch,!0)})).catch((function(t){}))},n(622676),n(613468),n(443616),n(323784),n(835164),n(336368),n(387912),n(660824);var r,o=n(211152),u=n(251536),a=n(29804),i=n(674260),l=n(868256),c=n(891052),f=(r=n(937344))&&r.__esModule?r:{default:r};var s=0;function d(t){t&&Array.isArray(t)&&t.length>0&&((0,i.setData)(l.KEY_TASK_LISTS,(0,c.fromJS)(t)),(0,i.setData)(l.KEY_SYSTEM_TASK_NOTICE,[!0,(0,c.fromJS)(t)]))}}}]);