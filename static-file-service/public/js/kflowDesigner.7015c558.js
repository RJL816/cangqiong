"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[7192],{754232:function(e,t,n){n.r(t),t.default={"loading-wrapper":"_2qncALeb","kflow-designer-wrapper":"_1TA_FPch","tab-container":"_29nyDsu3","kflow-tab":"UevDHhFp","tab-page":"_2tviv0TG",hidden:"_Xigf84Y","modal-body":"_2i5ePIgB","modal-body-image":"_3JEc8q9Z","modal-body-prompt":"_1iZGK9Xr","modal-footer":"_257m0RtR","modal-title-icon":"_21ZQ15GM"}},707736:function(e,t,n){n(606200),Object.defineProperty(t,"__esModule",{value:!0}),t.KFLOWDESIGNER_SAVE_CLICK=t.KFLOWDESIGNER_PUBLICE_CLICK=t.KFLOWDESIGNER_EXIT_CLICK=void 0;t.KFLOWDESIGNER_SAVE_CLICK="designerBarClick",t.KFLOWDESIGNER_PUBLICE_CLICK="designerBarClick",t.KFLOWDESIGNER_EXIT_CLICK="designerBarClick"},828408:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(387912),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.exit=function(e){return o.invokeControlService(e,a.KFLOWDESIGNER_EXIT_CLICK,["exit",""])},t.publish=function(e){return o.invokeControlService(e,a.KFLOWDESIGNER_PUBLICE_CLICK,["distribution",""])},t.save=function(e){return o.invokeControlService(e,a.KFLOWDESIGNER_SAVE_CLICK,["save",""])},t.tabClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o.invokeControlService(e,"designerBarClick",t)};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(o,u,i):o[u]=e[u]}return o.default=e,n&&n.set(e,o),o}(n(251536)),a=n(707736);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}},491684:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(360776),n(505684),n(743924),n(693917),n(205960),n(976896),n(846428),n(969e3),n(606200),n(534440),n(76152),n(76124),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n,r,k=e.model,j=e.dispatch,D=F((0,o.useState)(),2),L=D[0],M=D[1],B=F((0,o.useState)(),2),T=B[0],U=B[1],x=F((0,o.useState)([]),2),V=x[0],X=x[1],q=F((0,o.useState)(!1),2),H=q[0],J=q[1],Z=F((0,o.useState)(!1),2),Q=Z[0],Y=Z[1];(0,p.default)(k);var $=(0,o.useRef)(),z=(0,o.useRef)(),ee=(0,o.useRef)(),te=(0,o.useRef)(),ne=((0,w.useFederatedModule)("kflow").Component||{}).KFlowDesigner;(0,o.useEffect)((function(){var e=k.pageId,t=k.key,n=(0,m.subscribeControlMethod)(e,t,"directives",(function(e){void 0!==e&&re(e)})),r=k.sub_Event("setProperty",(function(){return ue(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])})),o=k.sub_Event("showErrorList",(function(){return ie(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])}));return function(){n(),k.unsub_Event(r),k.unsub_Event(o)}}),[k]);var re=function(e){e.forEach((function(e){var t=e.methodname,n=e.args;switch(t){case f.KFLOWDESIGNER_OPEN:var r=n[0];(0,a.getKFlowMetadata)(r).then((function(e){M(e)}));var o=n[1];U(o);var l=(0,_.cloneDeep)(o);ee.current=l,z.current=o;break;case f.SHOW_GUIDE:J(n[0]);break;default:"".concat(t," is not been implemented")}}))},oe=function(e){return e.filter((function(e){return"HideEdge"!==e._Type_&&"HideAp"!==e._Type_}))},ae=function(){var e=k.pageId,t=k.key,n=(0,_.cloneDeep)(z.current),r=n.kflowmeta.Items;n.kflowmeta.Items=oe(r),ee.current=n,j((0,l.convertAppModelFunctionAction)((0,l.setControlPostValue)(e,t,n)))},le=function(){ae(),j((0,E.save)(k))},ue=(0,o.useCallback)((function(e){$.current&&$.current.setProperty(e)}),[]),ie=(0,o.useCallback)((function(){X((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])[0]||[])}),[]),ce=(0,o.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=k.pageId,r={type:t,content:e,duration:2e3,level:s.MSG_LEVEL.warning,pageId:n};(0,l.setDataMessages)(n,r)}),[k]),fe=(0,o.useCallback)((function(){var e=k.pageId,t=k.key,n=(0,_.cloneDeep)(z.current),r=n.kflowmeta.Items;if(n.kflowmeta.Items=oe(r),!(0,_.isEqual)(te.current,n)){te.current=n;var o={kflowdesigner:n};O.invokeControlServiceSimple(e,t,"mouseOutOfFocus",{args:[""],post:[o],dispatch:j})}}),[k]),se=(0,o.useCallback)((function(e,t){j((0,u.property_editor_click)(k,e,t))}),[k]),de=(0,o.useCallback)((function(e,t,n,r){var o=t,a=o.Id,l=n.Form,u=(0,_.cloneDeep)(z.current.kflowmeta.Items),c=oe(u),f=o[e];return[a,r,e,{form:(0,i.default)(l),value:f,context:c,item:{Id:a,_Type_:t._Type_}}]}),[]),pe=(0,o.useCallback)((function(e,t,n){if(!1!==n.Editable){var r=de(e,t,n,A);se("getPropertyAlias",r)}}),[]),me=(0,o.useCallback)((function(e,t,n){var r=de(e,t,n,A);se("click",r)}),[]),ve=(0,m.getUserUIState)(k),be=(null===(t=ve.getIn(["kflowDesigner","userConfig"]))||void 0===t?void 0:t.toJS())||{showLeftView:!0,showKey:!1,showType:!1,showFullRelationship:!1},ye=k.pageId,ge=k.key,Ee=(0,g.getCommonClass)(k),we=Ee.Grow,_e=Ee.Shrink,ke=Ee.AlignSelf,Ce=(0,b.default)(N({},d.default["kflow-designer-wrapper"],!0),(0,y.default)({Grow:we,Shrink:_e,AlignSelf:ke})),Oe=(0,b.default)(N({},d.default["kflow-tab"],!0)),he=null==T||null===(n=T[A])||void 0===n?void 0:n[G],Se=null==T||null===(r=T[A])||void 0===r?void 0:r[R],Ie=k.getMetaProperty(S.CONFIG_ITEMS),Pe=null==Ie?void 0:Ie.get(S.LOGO);if("ie"===(0,I.getBrowserData)())return o.default.createElement(P.default,null);return L&&T?o.default.createElement("div",{className:Ce},o.default.createElement(v.default,{isKFlow:!0,onCancel:function(){var e=z.current,t=ee.current;(0,_.isEqual)(e,t)?j((0,E.exit)(k)):Y(!0)},onPublish:function(){ae(),j((0,E.publish)(k))},showShortCutBtn:!1,showCancelBtn:!0,showPublishBtn:!0,menuOptions:[],showPreviewBtn:!1,onSave:le,pageId:ye,controlKey:ge,logo:Pe}),o.default.createElement("div",{className:d.default["tab-container"]},o.default.createElement("div",{className:Oe},o.default.createElement(o.default.Suspense,{fallback:"loading"},ne&&o.default.createElement(ne,{name:"KFlowDesigner",meta:L,data:T,errorList:V,showGuide:H,onData:function(e){z.current=e,fe()},onApi:function(e){$.current=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)},dragApi:function(){return{dragElement:C.dragElement,removeDragElement:C.removeDragElement}},getPropertyAliasValue:pe,invokeAction:se,validateAction:fe,showMessage:ce,handleCustomInputEditor:me,userConfig:be,onUserConfigChange:function(e){var t=$.current.getUserConfig();(0,m.setUserUIState)(k.pageId,["kflowDesigner","userConfig"],t,!0)},getLangMsg:h.getLangMsg})))),o.default.createElement(W,{visible:Q,callbackFn:function(e){switch(e){case"save":le(),j((0,E.exit)(k));break;case"unsave":j((0,E.exit)(k))}Y(!1)},name:he,number:Se})):o.default.createElement("div",{className:d.default["loading-wrapper"]},o.default.createElement(c.default,null))},n(9692),n(622676),n(233696),n(323784),n(721300),n(387912),n(997308);var o=L(n(795520)),a=(j(n(369396)),n(525896)),l=n(218652),u=n(887084),i=j(n(768696)),c=j(n(127360)),f=n(681868),s=n(545072),d=j(n(754232)),p=j(n(472632)),m=n(738704),v=j(n(345692)),b=j(n(671252)),y=j(n(329132)),g=n(439532),E=n(828408),w=n(869504),_=n(790832),k=n(199860),C=n(683088),O=L(n(251536)),h=n(331428),S=n(290600),I=n(589200),P=j(n(810972));function j(e){return e&&e.__esModule?e:{default:e}}function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(D=function(e){return e?n:t})(e)}function L(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=D(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var u=a?Object.getOwnPropertyDescriptor(e,l):null;u&&(u.get||u.set)?Object.defineProperty(o,l,u):o[l]=e[l]}return o.default=e,n&&n.set(e,o),o}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e,t,n){var o;return o=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==r(o)?o:String(o))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,l,u=[],i=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{if(!i&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return u}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A="kflowmeta",G="KFlowName",R="KFlowNumber";var W=function(e){var t=e.visible,n=e.callbackFn,r=e.name,a=void 0===r?"k流名称":r,l=e.number,u=void 0===l?"编码":l,i=function(e){n(e)},c=o.default.createElement("div",{className:d.default["modal-body"]},o.default.createElement("div",{className:d.default["modal-body-image"]}),o.default.createElement("div",{className:d.default["modal-body-prompt"]},"是否保存对“".concat(a,"（").concat(u,"）”的更改？")),o.default.createElement("div",{className:d.default["modal-body-prompt"]},"若不保存，退出后将丢失这些更改")),f=o.default.createElement("div",{className:d.default["modal-footer"]},o.default.createElement(k.Button,{className:d.default["modal-save-btn"],type:"primary",onClick:function(){return i("save")}},"保存"),o.default.createElement(k.Button,{className:d.default["modal-not-save-btn"],onClick:function(){return i("unsave")}},"不保存"),o.default.createElement(k.Button,{className:d.default["modal-cancel-btn"],onClick:function(){return i("cancel")}},"取消")),s=o.default.createElement("div",{className:d.default["modal-title-icon"]});return o.default.createElement(k.Modal,{body:c,footer:f,titleIcon:s,type:"normal",mask:!0,maskClosable:!1,width:469,height:340,title:"退出确认",closable:!0,destroyOnClose:!0,onCancel:function(){i("cancel")},visible:t})}}}]);