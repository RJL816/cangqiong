"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[2061],{489036:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=function(){try{var e=document.createElement("div");e.style.height="0px",e.style.width="0px";var t=null;return navigator.appName.indexOf("Internet")>=0||navigator.appVersion.indexOf("Trident")>=0?(t=document.createElement("object"),"x86"===window.navigator.cpuClass?(t.setAttribute("codebase","CryptoKit.Kingdee.x86.cab"),t.setAttribute("classid","clsid:061A390F-23BF-401C-BBD3-E4D4B83A7037")):(t.setAttribute("codebase","CryptoKit.Kingdee.x64.cab"),t.setAttribute("classid","clsid:5538CB4A-4BB6-4525-89A2-FC59BD4F7990")),e.appendChild(t)):((t=document.createElement("embed")).setAttribute("type","application/npCryptoKit.Kingdee.x86"),t.style.height="0px",t.style.width="0px",e.appendChild(t)),document.body.appendChild(e),t}catch(e){return null}}(),n={certType:a(e,"signAlg"),subjectDNFilter:a(e,"subjectDNFilter"),issuerDNFilter:a(e,"issuerDNFilter"),serialNumFilter:a(e,"serialNumFilter"),cspList:a(e,"cspList"),hashType:a(e,"hashType")},r=function(e){var n=e.subjectDNFilter,r=void 0===n?"":n,i=e.issuerDNFilter,o=void 0===i?"":i,c=e.serialNumFilter,a=void 0===c?"":c,u=e.cspList,f=void 0===u?"":u;try{var l=t.SelectCertificate(r,o,a,f);return l||s(t.GetLastErrorDesc()),l}catch(e){s(t.GetLastErrorDesc())}},c=function(){try{var e;e=t.GetVersion(),"CFCA插件版本号：".concat(e)}catch(e){s(o.CERT_STATUS_NOPLGUIN)}},u={importCert:function(e,i){try{if(c(),r(n)){var s=function(e){var t=function(e){for(var t=e.match(/(S(?!N)|L|O(?!U)|OU|SN|CN|E)=([^=]+)(?=, |$)/g),n=0;n<t.length;n++)if(0===t[n].indexOf("CN="))return t[n].substr(3,t[n].length);return"defaultName"},n=e.GetSignCertInfo("SubjectDN"),r=e.GetSignCertInfo("CertTimeFrom"),i=e.GetSignCertInfo("CertTimeOut"),o={serialNumber:e.GetSignCertInfo("SerialNumber"),issuer:e.GetSignCertInfo("IssuerDN"),publicKey:e.GetSignCertInfo("CertContent"),begin:new Date(r.replace(" ","T")),end:new Date(i.replace(" ","T")),certName:t(n)};return o}(t);i({success:!0,data:s})}}catch(e){var a={success:!1};e.message===o.CERT_STATUS_NOPLGUIN&&(a.status=o.CERT_STATUS_NOPLGUIN,a.pluginPath=o.CERT_FILE_URI_CFCA),e.message.indexOf("0xa0071001")>0&&(a.status=o.CERT_STATUS_NOCERT),i(a)}},signCert:function(e,i){try{var a=e=Object.assign({},e,n),u=a.serialNumber,f=a.signText,l=a.signType,d=void 0===l?"PKCS#1":l,p=a.hashType,w=void 0===p?"SHA-1":p,m=a.attachOriginal,y=void 0!==m&&m;if(!["PKCS#1","PKCS#7"].includes(d))return;if(c(),!r({serialNumFilter:u,cspList:n.cspList}))return;var g={};Object.keys(f).forEach((function(e){g[e]=function(e,n,r,i,o){try{if("PKCS#1"===n)return t.SignMsgPKCS1(e,r);if("PKCS#7"===n)return t.SignMsgPKCS7(e,r,i)}catch(e){s(t.GetLastErrorDesc())}}(f[e],d,w,y)})),"Utap CSP v6.0 (Kingdee)"===t.GetSignCertInfo("CSPName")&&t.DeleteKeyPin(),i({success:!0,data:g})}catch(e){var h={success:!1};e.message===o.CERT_STATUS_NOPLGUIN&&(h.status=o.CERT_STATUS_NOPLGUIN,h.pluginPath=o.CERT_FILE_URI_CFCA),e.message.indexOf("0xa0071001")>0||e.message.indexOf("0xA0071002")>0?h.status=o.CERT_STATUS_NOCERT:(e.message.indexOf("0xA0071107"),h.status=o.CERT_STATUS_FAIL),i(h)}}};i.default[i.KD_PLUGIN]||(i.default[i.KD_PLUGIN]={});i.default[i.KD_PLUGIN]=Object.assign({},i.default[i.KD_PLUGIN],u)},n(233696),n(443616),n(241872),n(976896),n(336368),n(76124),n(387912),n(633768),n(660824),n(218080),n(513640),n(321164),n(997308);var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(211152)),o=n(496260);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function s(e){throw new Error(e)}function a(e,t){var n=e.split("\n"),r="";return n.forEach((function(e){e.includes(t)&&(r=e.trim().replace("".concat(t,"="),"").replace("\r",""))})),r}},792915:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(505684),n(323784),n(693917),n(606200),n(534440),n(690512),n(776512),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=null,n=!0;try{var r=h();if(!("Chrome"===r.name&&parseInt(r.version)>41||"Firefox"===r.name&&parseInt(r.version)>52))return;(t=new y(r.name)).init().then((function(){})).catch((function(e){e.result,"Attempting to use a disconnected port object"!=e.result&&function(){var e=h();if("Firefox"===e.name){var t={"CryptoKit for Firefox":""};window.InstallTrigger.install(t)}else e.name}(),"Extension does not exist!"===e.result&&(n=!1)}))}catch(e){return}var c={certTyppe:b(e,"signAlg"),subjectDNFilter:b(e,"subjectDNFilter"),issuerDNFilter:b(e,"issuerDNFilter"),serialNumFilter:b(e,"serialNumFilter"),cspList:b(e,"cspList"),hashType:b(e,"hashType")},a={importCert:function(e,r){n?t.getVersion().then((function(e){e.result&&e.result,t.selectCertificate(c.subjectDNFilter,"cfca",c.serialNumFilter,c.cspList).then((function(e){(function(e){return new Promise((function(t,n){Promise.all([e.getSignCertInfo("SubjectDN"),e.getSignCertInfo("CertTimeFrom"),e.getSignCertInfo("CertTimeOut"),e.getSignCertInfo("SerialNumber"),e.getSignCertInfo("IssuerDN"),e.getSignCertInfo("CertContent")]).then((function(e){var n,r,i=(r=6,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,c,s=[],a=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);a=!0);}catch(e){u=!0,i=e}finally{try{if(!a&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(u)throw i}}return s}}(n,r)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],c=i[1],a=i[2],u=i[3],f=i[4],l=i[5],d=function(e){for(var t=e.match(/(S(?!N)|L|O(?!U)|OU|SN|CN|E)=([^=]+)(?=, |$)/g),n=0;n<t.length;n++)if(0===t[n].indexOf("CN="))return t[n].substr(3,t[n].length);return"defaultName"},p={serialNumber:u.result,issuer:f.result,publicKey:l.result,begin:new Date(c.result.replace(" ","T")),end:new Date(a.result.replace(" ","T")),certName:d(o.result)};t(p)})).catch((function(){}))}))})(t).then((function(e){r({success:!0,data:e})}))})).catch((function(e){null===e||(1===e.errorcode?e.result:t.getLastErrorDesc().then((function(e){e.result}))),r({success:!1,status:o.CERT_STATUS_NOCERT})}))})).catch((function(e){r({success:!1,status:o.CERT_STATUS_NOPLGUIN,pluginPath:o.CERT_FILE_URI_CFCA})})):r({success:!1,status:o.CERT_STATUS_NOPLGUIN,pluginPath:o.CERT_FILE_URI_CFCA})},signCert:function(e,n){var r=e=Object.assign({},e,c),i=r.serialNumber,s=r.signText,a=r.signType,u=void 0===a?"PKCS#1":a,f=r.hashType,l=void 0===f?"SHA-1":f,d=r.attachOriginal,p=void 0!==d&&d;["PKCS#1","PKCS#7"].includes(u)&&t.getVersion().then((function(e){e.result&&e.result,t.selectCertificate("","",i,c.cspList).then((function(e){var r=Object.keys(s).map((function(e){return function(e,t,n,r,i,o){if("PKCS#1"===n)return e.signMsgPKCS1(t,r);if("PKCS#7"===n)return e.signMsgPKCS7(t,r,i)}(t,s[e],u,l,p)}));Promise.all(r).then((function(e){var r={};Object.keys(s).forEach((function(t,n){r[t]=e[n].result})),t.getSignCertInfo("CSPName").then((function(e){"Utap CSP v6.0 (Kingdee)"===e.result?t.deleteKeyPin().then((function(e){e.result,n({success:!0,data:r})})).catch((function(e){})):n({success:!0,data:r})})).catch((function(e){}))})).catch((function(e){console.error(e),n({success:!1,status:o.CERT_STATUS_FAIL})}))})).catch((function(e){null===e||(1===e.errorcode?e.result:t.getLastErrorDesc().then((function(e){e.result}))),n({success:!1,status:o.CERT_STATUS_NOCERT})}))})).catch((function(e){n({success:!1,status:o.CERT_STATUS_NOPLGUIN,pluginPath:o.CERT_FILE_URI_CFCA})}))}};i.default[i.KD_PLUGIN]||(i.default[i.KD_PLUGIN]={});i.default[i.KD_PLUGIN]=Object.assign({},i.default[i.KD_PLUGIN],a)},n(233696),n(443616),n(241872),n(743924),n(835164),n(976896),n(721300),n(336368),n(76124),n(387912),n(571176),n(497448),n(633768),n(660824),n(78504),n(218080),n(513640),n(321164),n(997308),n(977864);var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(211152)),o=n(496260);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a="com.cfca.cryptokit.kingdee",u=a+".extension",f=a+".request",l=a+".response",d="Edge",p="Chrome",w="Firefox";function m(e,t){return n=t,r=new window.CustomEvent(f,{detail:n}),document.dispatchEvent(r),new Promise((function(e,t){var r=l;void 0!==n.funcInfo&&void 0!==n.funcInfo.randomId&&(r+="."+n.funcInfo.randomId),document.addEventListener(r,(function n(r){document.removeEventListener(r.type,n);var i=JSON.parse(r.detail);null!==i&&0===i.errorcode?e(i):t(i)}),!1)}));var n,r}function y(e){this.browser=e}function g(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",t="",n=0;n<10;n++)t+=e.charAt(Math.floor(62*Math.random()));return t}function h(){var e,t={name:"",version:""},n=window.navigator.userAgent;return(e=/edge\/([\d\.]+)/i.exec(n))?(t.name="Edge",t.version=e[1]):/msie/i.test(n)?(t.name="Internet Explorer",t.version=/msie ([\d\.]+)/i.exec(n)[1]):/Trident/i.test(n)?(t.name="Internet Explorer",t.version=/rv:([\d\.]+)/i.exec(n)[1]):/chrome/i.test(n)?(t.name="Chrome",t.version=/chrome\/([\d\.]+)/i.exec(n)[1]):/safari/i.test(n)?(t.name="Safari",t.version=/version\/([\d\.]+)/i.exec(n)[1]):/firefox/i.test(n)&&(t.name="Firefox",t.version=/firefox\/([\d\.]+)/i.exec(n)[1]),t}function b(e,t){var n=e.split("\n"),r="";return n.forEach((function(e){e.includes(t)&&(r=e.trim().replace("".concat(t,"="),"").replace("\r",""))})),r}y.prototype.init=function(){var e=this.browser;return function(e){return new Promise((function(t,n){var r=new window.Object;d===e||w===e||p===e?document.getElementById(u)?t(e):(r.errorcode=1,r.result="Extension does not exist!",n(r)):(r.errorcode=1,r.result="Only support Chrome/Edge/Firefox",n(r))}))}(e).then((function(e){var t=new window.Object;return t.action="connect",t.host=a,m(0,t)})).then((function(){var e=new window.Object,t=new window.Object,n=new window.Array,r=g();return t.function="checkHost",t.params=n,t.randomId=r,e.action="invoke",e.funcInfo=t,m(0,e)}))},y.prototype.uninit=function(){var e=new window.Object;return e.action="disconnect",e.host=a,m(this.browser,e)},y.prototype.selectCertificate=function(e,t,n,r){var i=new window.Object,o=new window.Object,c=new window.Array,s=g();return c.push(e),c.push(t),c.push(n),c.push(r),o.function="SelectCertificate",o.params=c,o.randomId=s,i.action="invoke",i.funcInfo=o,m(this.browser,i)},y.prototype.getSignCertInfo=function(e){var t=new window.Object,n=new window.Object,r=new window.Array,i=g();return r.push(e),n.function="getSignCertInfo",n.params=r,n.randomId=i,t.action="invoke",t.funcInfo=n,m(this.browser,t)},y.prototype.signMsgPKCS1=function(e,t){var n=new window.Object,r=new window.Object,i=new window.Array,o=g();return i.push(e),i.push(t),r.function="SignMsgPKCS1",r.params=i,r.randomId=o,n.action="invoke",n.funcInfo=r,m(this.browser,n)},y.prototype.signFilePKCS1=function(e,t){var n=new window.Object,r=new window.Object,i=new window.Array,o=g();return i.push(e),i.push(t),r.function="SignFilePKCS1",r.params=i,r.randomId=o,n.action="invoke",n.funcInfo=r,m(this.browser,n)},y.prototype.getKeyID=function(e){var t=new window.Object,n=new window.Object,r=new window.Array,i=g();return r.push(e),n.function="getKeyID",n.params=r,n.randomId=i,t.action="invoke",t.funcInfo=n,m(this.browser,t)},y.prototype.deleteKeyPin=function(){var e=new window.Object,t=new window.Object,n=new window.Array,r=g();return t.function="DeleteKeyPin",t.params=n,t.randomId=r,e.action="invoke",e.funcInfo=t,m(this.browser,e)},y.prototype.getVersion=function(){var e=new window.Object,t=new window.Object,n=new window.Array,r=g();return t.function="GetVersion",t.params=n,t.randomId=r,e.action="invoke",e.funcInfo=t,m(this.browser,e)},y.prototype.getLastErrorDesc=function(){var e=new window.Object,t=new window.Object,n=g();return t.function="GetLastErrorDesc",t.params=null,t.randomId=n,e.action="invoke",e.funcInfo=t,m(this.browser,e)}}}]);