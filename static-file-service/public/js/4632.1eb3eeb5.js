"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[4632],{934632:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n(182320),n(909112),n(697060),n(360776),n(622676),n(505684),n(743924),n(693917),n(205960),n(976896),n(846428),n(969e3),n(606200),n(534440),n(76152),n(76124),n(633768),n(690512),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9692),n(233696),n(323784),n(721300),n(387912),n(997308),n(86744);var r,i=m(n(795520)),c=n(738704),a=n(175144),u=n(325648),l=n(589200),f=m(n(791032)),d=(r=n(212352))&&r.__esModule?r:{default:r};function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function m(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var a=i?Object.getOwnPropertyDescriptor(e,c):null;a&&(a.get||a.set)?Object.defineProperty(r,c,a):r[c]=e[c]}return r.default=e,n&&n.set(e,r),r}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){var r;return r=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==o(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,c,a=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(o=i.call(n)).done)&&(a.push(o.value),a.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw r}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.default=function(e){var t=e.className,n=e.ctrlKey,o=e.pageId,r=e.style,s=e.url,m=e.save,v=e.sendValidResult,y=A((0,i.useState)(s),2),g=y[0],w=y[1],b=(0,i.useRef)(),h=(0,i.useRef)(0),E=(0,i.useRef)([]),D=(0,i.useRef)({}),k=(0,i.useRef)("".concat(o,"_").concat(n,"_").concat(u.YozoCtrlKey));(0,i.useEffect)((function(){return k.current="".concat(o,"_").concat(n,"_").concat(u.YozoCtrlKey),(0,c.setControlMount)(o,"".concat(n,"_").concat(u.YozoCtrlKey),!0),function(){(0,c.setControlMount)(o,"".concat(n,"_").concat(u.YozoCtrlKey),!1)}}),[o,n]),(0,i.useEffect)((function(){var e=(0,c.subscribeControlMethod)(o,"".concat(n,"_").concat(u.YozoCtrlKey),"directives",O);return function(){e()}}),[o,n]);var O=function(e){if(!(void 0===e||Array.isArray(e)&&0===e.length)&&e[0].methodname===a.WEB_OFFICE_ACTION){var t,r=e[0].args[0].event,i=Array.isArray(e[0].args[0])?e[0].args[0]:e[0].args[0].data;if("open"===r||"openNew"===r){var c=i.editUrlForYozo||i.newEditUrlForYozo,u=(0,l.getUrlParam)(c,"fid")||"";return d.default.set(u,"".concat(o,"$$").concat(n)),void w(c)}if("saveSuccess"===r){var s=i.url,y=i.fileKey;return void(null==m||m([p({uid:y,url:s},D.current)]))}if("save"===r&&(D.current={name:i.name,id:i.id}),null!==(t=b.current)&&void 0!==t&&null!==(t=t.contentWindow)&&void 0!==t&&null!==(t=t.YozoOffice)&&void 0!==t&&t.Application)return void f[r](i,{sendValidResult:v})(k.current);E.current.push({methodName:r,data:i})}};return i.default.createElement("div",{style:p({width:"100%",height:"100%"},r),className:t},g&&i.default.createElement("iframe",{id:k.current,style:{width:"100%",height:"100%"},src:g,ref:b,onLoad:function(){var e=setInterval((function(){var t,n;null!==(t=b.current)&&void 0!==t&&null!==(t=t.contentWindow)&&void 0!==t&&null!==(t=t.YozoOffice)&&void 0!==t&&t.Application||8===h.current?(clearInterval(e),null!==(n=b.current)&&void 0!==n&&null!==(n=n.contentWindow)&&void 0!==n&&null!==(n=n.YozoOffice)&&void 0!==n&&n.Application&&E.current.length>0&&(E.current.forEach((function(e){var t=e.methodName,n=e.data;f[t](n,{sendValidResult:v})(k.current)})),E.current=[])):h.current++}),1e3)}}))}},791032:function(e,t,n){n(182320),n(909112),n(697060),n(505684),n(743924),n(976896),n(721300),n(606200),n(690512),n(78504),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.toggleShowTraces=t.showTracesByRole=t.setTrackingMode=t.setToolbars=t.setTitlebar=t.setTextAsTitle=t.setSelectionEditArea=t.setSelectionAsField=t.setMenubar=t.setDynamicTable=t.setDocUnLimitByRole=t.setDocUnLimit=t.setDocLimitByRole=t.setDocLimit=t.setDocAsField=t.setCheckBoxValue=t.setCaption=t.sendTextByField=t.sendOpenStatus=t.sendIsFieldRevise=t.sendIsDocChange=t.sendFieldExist=t.sendAllField=t.sendAllCheckBox=t.saveAsLocal=t.save=t.openNew=t.open=t.modifyMark=t.mergeDocs=t.locateMark=t.isDirty=t.insertValue=t.insertPictures=t.docProtect=t.docCompare=t.deleteMark=t.delMark=t.close=t.cancelSelectionEditArea=t.callEditorFunction=t.addTextMark=t.addTableRows=t.addTableColumns=t.addMark=t.addCommentDialog=t.HEX2Demical=void 0,n(9692),n(233696),n(323784),n(693917),n(387912),n(571176),n(633768),n(125048),n(218080),n(513640),n(997308);var o=n(325648);function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.setTitlebar=function(e,t){return function(e){}},t.setToolbars=function(e,t){return function(e){}},t.setMenubar=function(e,t){return function(e){}},t.setCaption=function(e,t){return function(e){}},t.open=function(){return function(e){}},t.openNew=function(e,t){return function(e){}},t.save=function(){return function(e){var t=document.getElementById(e).contentWindow.YozoOffice;t&&t.Application.ActiveDocument.Save()}},t.close=function(e,t){};var c=t.insertValue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.needEnterBefore,r=e.value,i="";o&&(i="\r\n");var c="".concat(i).concat(r);n.Application.Selection.Text=c}}},a=(t.addCommentDialog=function(e,t){return function(e){var t=document.getElementById(e).contentWindow.YozoOffice;if(t){var n=t.Application.Selection.Range;t.Application.ActiveDocument.Comments.Add(n)}}},t.docCompare=function(){},t.addMark=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=e.value,i=n.Application,a=i.Selection,u=i.ActiveDocument,l=u.Bookmarks,f=a.Range.Start;c({value:r})(n);var d=u.Range(f,f+r.length);l.Add(o,d)}}},t.modifyMark=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n&&Array.isArray(e)){var o=n.Application.ActiveDocument.Bookmarks;e.forEach((function(e){var t=e.field,n=e.value;if(o.Exists(t)){var r=o.Item(t).Range;r.Text=n,o.Add(t,r)}}))}}},t.deleteMark=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n&&Array.isArray(e)){var o=n.Application.ActiveDocument.Bookmarks;e.forEach((function(e){var t=e.field;o.Exists(t)&&o.Item(t).Delete()}))}}},t.locateMark=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=n.Application.ActiveDocument.Bookmarks;r.Exists(o)&&r.Item(o).Select()}}},t.docProtect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.isProtect,r=e.protectType,i=e.password;0===o?n.Application.ActiveDocument.Protect(r,!0,i):n.Application.ActiveDocument.Unprotect(i)}}},t.setDocLimit=function(){},t.setDocUnLimit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.password;n.Application.ActiveDocument.Unprotect(o)}}},t.setSelectionEditArea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=n.Application,i=r.Selection.Range,c=r.ActiveDocument.Bookmarks;c.Exists(o)&&c.Add(o,i),r.Editors.Add(-1)}}},t.cancelSelectionEditArea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){var n,o=document.getElementById(t).contentWindow.YozoOffice;if(o){var r=e.field,i=o.Application,c=i.ActiveDocument.Bookmarks;i.Selection.Editors.Item(-1).Delete(),null===(n=c.Item(r))||void 0===n||n.Delete()}}},t.setDocLimitByRole=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=e.password,i=n.Application,c=i.ActiveDocument.Bookmarks;o.forEach((function(e){var t=e;try{c.Add(t),c.Item(t).Range.Editors.Add(-1)}catch(e){console.error("setDocLimitByRole 指令执行失败",e)}})),i.ActiveDocument.Protect(3,!1,r,!1,!1)}}},t.setDocUnLimitByRole=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;n&&e.data.forEach((function(e){var t=e.field;try{var o;null===(o=n.Application.ActiveDocument.Bookmarks.Item(t))||void 0===o||null===(o=o.Range)||void 0===o||o.Editors.Item(-1).Delete()}catch(e){console.error("setDocUnLimitByRole 指令执行失败",e)}}))}},t.sendTextByField=function(e,t){return function(n){var o=document.getElementById(n).contentWindow.YozoOffice;if(o){var r=t.sendValidResult,i=e.field,c=e.id,a=o.Application.ActiveDocument.Bookmarks;r([{data:{result:a.Exists(i)?a.Item(i).Text:"",field:i},id:c,type:"getTextByField"}])}}},t.sendIsFieldRevise=function(e,t){},t.sendFieldExist=function(e,t){return function(n){var o=document.getElementById(n).contentWindow.YozoOffice;if(o){var r=t.sendValidResult,i=e.field,c=e.id;r([{data:{result:o.Application.ActiveDocument.Bookmarks.Exists(i),field:i},id:c,type:"fieldExist"}])}}},t.sendAllField=function(e,t){return function(n){var o=document.getElementById(n).contentWindow.YozoOffice;if(o){for(var r=t.sendValidResult,i=o.Application.ActiveDocument.Bookmarks,c=i.Count,a=[],u=1;u<=c;u++)a.push(i.Item(u).Name);r([{data:a,id:e.id,type:"allField"}])}}},t.sendIsDocChange=function(e,t){return function(n){(0,t.sendValidResult)([{data:!0,id:e.id,type:"isDocChange"}])}},t.setTrackingMode=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){e.userName;var o=e.trackType;n.Application.ActiveDocument.TrackRevisions=0!==o}}},t.toggleShowTraces=function(e,t){return function(e){var t=document.getElementById(e).contentWindow.YozoOffice;if(t){var n=t.Application.ActiveWindow.View.RevisionsFilter.Markup;t.Application.ActiveWindow.View.RevisionsFilter.Markup=0===n?2:0}}},t.showTracesByRole=function(e,t){},t.setDynamicTable=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o,r=e.tableSize,i=e.field,c=e.tableData,u=r.row,l=r.column,f=n.Application.ActiveDocument.Bookmarks,d=n.Application.ActiveDocument,s=d.Range,m=d.Tables;if(f.Exists(i)){var v=f.Item(i).Range;o=s(v.Start,v.Start)}else{var p=n.Application.Selection.Range;o=s(p.Start,p.Start)}var y=m.Add(o,u,l,1,2);a(y,c,n),y.Select();var A=n.Application.Selection.Range;d.Bookmarks.Add(i,A)}}},function(e,t,n){t.forEach((function(t){e.Cell(t.row,t.column).Goto(),n.Application.Selection.Text=t.value}))}),u=function(e,t){return e.Application.ActiveDocument.Bookmarks.Item(t).Select(),e.Application.Selection.Tables(1)},l=function(e){return e.Rows.Count},f=function(e){return e.Columns.Count};t.addTableRows=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){for(var o=e.field,r=e.newRowsData,i=e.newRows,c=n.Application.ActiveDocument.Bookmarks.Exists(o)?u(n,o):n.Application.ActiveDocument.Tables.Item(1),d=function(e,t,n){for(var o=l(e),r=f(e),i=[],c=0;c<t;c++)for(var a=0;a<r;a++){var u={row:o+c+1,column:a+1,value:n[c][a]};i.push(u)}return i}(c,i,r),s=1;s<=i;s++){var m=c.Rows.Count;c.Rows.Item(m).Add()}a(c,d,n)}}},t.addTableColumns=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){for(var o=e.field,r=e.newColumnsData,i=e.newColumns,c=n.Application.ActiveDocument.Bookmarks.Exists(o)?u(n,o):n.Application.ActiveDocument.Tables.Item(1),d=function(e,t,n){for(var o=l(e),r=f(e),i=[],c=0;c<t;c++)for(var a=0;a<o;a++){var u={row:a+1,column:r+c+1,value:n[c][a]};i.push(u)}return i}(c,i,r),s=1;s<=i;s++){var m=c.Columns.Count;c.Columns.Item(m).Add()}a(c,d,n),c.AutoFitBehavior(2)}}},t.mergeDocs=function(e,t){return function(e){}},t.setSelectionAsField=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=n.Application.Selection.Range;n.Application.ActiveDocument.Bookmarks.Add(o,r)}}},t.setDocAsField=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=n.Application.ActiveDocument.Paragraphs.Count,i=n.Application.ActiveDocument.Paragraphs.Item(r).Range.End,c=n.Application.ActiveDocument.Range(0,i);n.Application.ActiveDocument.Bookmarks.Add(o,c)}}},t.isDirty=function(e){},t.sendAllCheckBox=function(e,t){return function(e){}},t.sendOpenStatus=function(e,t){return function(n){(0,t.sendValidResult)([{data:!0,id:e.id,type:"openStatus"}])}},t.setCheckBoxValue=function(e,t){return function(e){}};t.setTextAsTitle=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.field,r=e.style;n.Application.ActiveDocument.Bookmarks.Exists(o)&&(n.Application.Selection.Goto(-1,null,null,o),n.Application.ActiveDocument.Selection.Font.Size=function(e){return"标题 1"===e?20:"标题 2"===e?17:"标题 3"===e?15:"标题 4"===e?13:"标题 5"===e?12:"标题 6"===e||"标题 7"===e||"标题 8"===e?11:"标题 9"===e?10.5:11}(r))}}},t.saveAsLocal=function(e,t){return function(e){}},t.insertPictures=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=e.data,r=n.Application.ActiveDocument.Bookmarks;o.forEach((function(e){var t=e.imageUrl,o=e.field,i=e.imageStyle;if(r.Exists(o)){r.Item(o).Select();var c=null,a=null;i&&(c=d(n,i.width),a=d(n,i.height)),n.Application.ActiveDocument.InlineShapes.AddPicture(t,!1,!1,null,null,c,a)}}))}}};var d=function(e,t){return m(t)?(t.toLowerCase(),v(t)?(t=t.replace("cm",""),y(e,t)):p(t)?(t=t.replace("px",""),s(t)):t):t},s=function(e){return parseInt(e)},m=function(e){return"string"==typeof e},v=function(e){return e.endsWith("cm")},p=function(e){return e.endsWith("px")},y=function(e,t){return e.ActiveDocument.CentimetersToPoints(t)},A=(t.addTextMark=function(e,t){return function(t){var n=document.getElementById(t).contentWindow.YozoOffice;if(n){var o=n.Application.ActiveDocument,r=o.Watermark;r.Type=2,r.Text=e.text||"样本",r.fontFamily=e.fontFamily||"宋体",r.fontSize=e.fontSize||"宋体",r.Color=A(e.fontColor)||12632256,r.Lean=1,r.SemTransparent=1,o.Watermark=r}}},t.delMark=function(e,t){return function(e){yozoOffice.Application.ActiveDocument.ClearWatermark()}},t.HEX2Demical=function(e){for(var t=0,n=0;n<=e.length-2;n++){t+=g(e.slice(1+n,2+n))*Math.pow(16,e.length-n-2)}return t}),g=function(e){switch(e=e.toLocaleLowerCase()){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15}};t.callEditorFunction=function(e,t){return function(n){var i=document.getElementById(n).contentWindow.YozoOffice;i&&e.editorType===o.OfficeEditMode.Yozo&&e.methods.forEach((function(e){for(var n,o=e.params,c=e.func,a=e.id,u=c.split("."),l=i.Application,f=0;f<u.length;f++){var d=u[f],s=!1,m="";if(/(\w+)\((\$\d+)?\)/.test(d)){var v=d.match(/(\w+)\((\$\d+)?\)/);d=v[1],m=v[2],s=!0}try{var p;if(s)l=m?(p=l)[d].apply(p,r(o[m])):l[d]();else l=l[d]}catch(e){console.error("".concat(d,"调用出错"))}}a&&l&&(null==t||null===(n=t.sendValidResult)||void 0===n||n.call(t,[{data:{result:l},id:a,type:"getEditorResult"}]))}))}}}}]);