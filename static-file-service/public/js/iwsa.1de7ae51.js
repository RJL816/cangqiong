(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[7324],{669312:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n(182320),n(909112),n(697060),n(743924),n(606200),n(534440),n(78504),n(776512),n(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={},n={IWSAGetCertPublicKeyInfoForIndex:l,getAllCertsByDNFilter:S},r={importCert:function(e,r){var c=e.pageId;try{s.certService.loadCertJs((function(){f(new window.IWSAgent,r),s.certService.selectCert(c,(function(e,t,n){!function(e,t,n){if(e){var r={serialNumber:e.certSN,issuer:e.issuerDN,publicKey:t,begin:e.validBegin,end:e.validEnd,certName:a(e.certDN)};n&&n({success:!0,data:r})}else{n({success:!1,status:o.CERT_STATUS_IWSA_NOCERT})}s.certService.closeDialog()}(e,n,r)}),"IWSA",n,t)}),"IWSA")}catch(e){var u={success:!1,status:e.message};r(u)}},signCert:function(e,t){var n=e.serialNumber,r=e.signText,c=e.issue;try{s.certService.loadCertJs((function(){var e=new window.IWSAgent;f(e,t),function(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"RAW",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"SHA1",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){};try{var a=function(n){if(!n[0]){var r={success:!1,status:o.CERT_STATUS_IWSA_NOCERT};return u(r)}var a={},f="0",l={success:!1},S=function(e,n,r,c){"0"!==r&&(f=r),a[e]=c,Object.keys(t).length-1===n&&(l="0"===f?{success:!0,data:a}:"-20005"===f?{success:!1,status:o.CERT_STATUS_IWSA_NOCERT}:{success:!1,status:o.CERT_STATUS_FAIL},u(l))};"SM2"===n[0].CertType&&(c="Detached"),Object.keys(t).forEach((function(r,o){"Attached"===c?e.IWSAAttachedSignAdvDefaultDN(t[r],"",1,n[0].certDN,0,s,(function(e,t){S(r,o,e,t)})):"Detached"===c?e.IWSADetachedSignAdvDefaultDN(t[r],i,4,n[0].certDN,0,s,(function(e,t){S(r,o,e,t)})):"RAW"===c&&e.IWSARawSignDefaultDN(t[r],n[0].certDN,0,s,(function(e,t){S(r,o,e,t)}))}))};!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;if(!n||!t)return console.error("证书获取失败，无法完成签名"),c({success:!1,status:o.CERT_STATUS_NOT_FOUND});e.IWSAGetAllCertsListInfoByCertIssuerDNAndCertSN(i,"Sign",t,n,2,r,c)}(e,n,r,a,u)}catch(e){throw new Error(e)}}(e,r,c,n,"RAW","SHA1",t)}),"IWSA")}catch(e){var u={success:!1,status:e.message};t(u)}}};c.default[c.KD_PLUGIN]||(c.default[c.KD_PLUGIN]={});c.default[c.KD_PLUGIN]=Object.assign({},c.default[c.KD_PLUGIN],r)},n(233696),n(443616),n(241872),n(336368),n(76124),n(387912),n(633768),n(660824),n(218080),n(513640),n(321164),n(997308);var c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=r(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var c={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var i=o?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(c,s,i):c[s]=e[s]}return c.default=e,n&&n.set(e,c),c}(n(211152)),o=n(496260),s=n(111648);function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}var i="infosec.sm2";function a(e){for(var t=e.match(/(S(?!N)|L|O(?!U)|OU|SN|CN|E)=([^=]+)(?=, |$)/g),n=0;n<t.length;n++)if(0===t[n].indexOf("CN="))return t[n].substr(3,t[n].length);return"defaultName"}function f(e,t){try{var n=function(e,t){if(e.IWSASetAsyncMode(!1),!t)return;var n=t();return e.IWSASetAsyncMode(!0),n}(e,e.IWSAGetVersion);"信安世纪签名证书插件版本号：".concat(n)}catch(e){var r={success:!1};r.status=o.CERT_STATUS_NOPLGUIN,r.pluginPath=o.CERT_FILE_URI_IWSA,t(r)}}function l(e,t){(new window.IWSAgent).IWSAGetCertInfoForIndex(e,t)}function S(e,t){(new window.IWSAgent).IWSAGetAllCertsListInfo(i,"Sign",2,t)}},77240:function(e,t,n){e.exports=n(251656)(8375)}}]);