"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonp_bos-platform"] = self["webpackJsonp_bos-platform"] || []).push([[7152],{

/***/ "./src/control/proxy/listquerypanelProxy.js":
/*!**************************************************!*\
  !*** ./src/control/proxy/listquerypanelProxy.js ***!
  \**************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\n__webpack_require__(/*! core-js/modules/es.symbol.js */ \"../../node_modules/core-js/modules/es.symbol.js\");\n__webpack_require__(/*! core-js/modules/es.array.index-of.js */ \"../../node_modules/core-js/modules/es.array.index-of.js\");\n__webpack_require__(/*! core-js/modules/es.object.define-property.js */ \"../../node_modules/core-js/modules/es.object.define-property.js\");\n__webpack_require__(/*! core-js/modules/es.object.keys.js */ \"../../node_modules/core-js/modules/es.object.keys.js\");\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports[\"default\"] = void 0;\n__webpack_require__(/*! core-js/modules/es.array.find-index.js */ \"../../node_modules/core-js/modules/es.array.find-index.js\");\n__webpack_require__(/*! core-js/modules/es.array.includes.js */ \"../../node_modules/core-js/modules/es.array.includes.js\");\n__webpack_require__(/*! core-js/modules/es.regexp.exec.js */ \"../../node_modules/core-js/modules/es.regexp.exec.js\");\nvar _index = __webpack_require__(/*! ../utils/index */ \"./src/control/utils/index.js\");\nvar _index2 = __webpack_require__(/*! ../middleware/index */ \"./src/control/middleware/index.js\");\nvar _querypanelaction = __webpack_require__(/*! @/action/querypanelaction */ \"./src/action/querypanelaction.js\");\nvar _immutable = __webpack_require__(/*! immutable */ \"webpack/sharing/consume/default/immutable/immutable?f2ca\");\nvar _intlApi = __webpack_require__(/*! @/i18n/intlApi */ \"./src/i18n/intlApi.js\");\nvar _utils = __webpack_require__(/*! @/component/web/base/ListFilter/utils */ \"./src/component/web/base/ListFilter/utils.js\");\nvar _excluded = [\"isCommon\"],\n  _excluded2 = [\"isCommon\"];\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/** 需要支持的方法\n  quickQuery.props.model.getDataProperty('fields') // 从 model 中获取fields数据\n  quickQuery.onSchemeSelect(schemeId) // 选择方案\n  quickQuery.onDelSelectedScheme() // 删除选中方案\n  quickQuery.onQSDelCondition(fast[i].k, i) // 快速搜索删除条件\n  quickQuery.onQSSelectItem(fast[j].fieldName, captions[i]) // 快速搜索选中\n  quickQuery.onCommonSelect(fieldName, subkeys) // 常用过滤条件选择\n  quickQuery.onSelectedConditionDel(common[j].k) // 常用查询条件删除\n  quickQuery.props.invokeControlService(quickQuery.props.model,\"commonSearch\",[fast,common,entryId]) // 搜索查询\n  quickQuery.props.invokeControlService(quickQuery.props.model,\"f7Click\",[fieldName,false,[]]); // 打开 f7 列表\n */\nvar SUPPORTGETTER = ['fields', 'selected'];\nvar SUPPORTSETTER = ['fields', 'selected'];\nvar SUPPORTMETHOD = ['getData', 'updateSelected', 'getFilterParam', 'onSchemeSelect', 'onDelSelectedScheme', 'onQSDelCondition', 'onQSSelectItem', 'onCommonSelect', 'onSelectedConditionDel', 'f7Click'];\nvar listquerypanelProxy = function listquerypanelProxy(pageId, controlKey) {\n  return function (_ref) {\n    var instance = _ref.instance;\n    var model = instance.model,\n      selecteForTest = instance.selecteForTest,\n      dataForTest = instance.dataForTest,\n      _updateSelected = instance.updateSelected,\n      handleDeleteScheme = instance.handleDeleteScheme,\n      handleSelectedChange = instance.handleSelectedChange,\n      handleSchemSearch = instance.handleSchemSearch,\n      handleCommonSearch = instance.handleCommonSearch,\n      handleCommonF7Click = instance.handleCommonF7Click;\n    var getFilterParam = function getFilterParam() {\n      var selected = selecteForTest.current;\n      var data = dataForTest.current;\n      var fastConditions = (0, _utils.getFastConditions)(selected.get('fast'), (0, _utils.getFastOptions)(data.get('fast'), selected));\n      var commonConditions = (0, _utils.getCommonConditions)(selected.get('common'), data.get('common'));\n      var schmeConditions = (0, _utils.getSchmeSearchConditons)(selected.get('scheme'));\n      var entryenties = data.getIn(['scheme', 'entryenties']);\n      var selectedEntryEntity = (0, _utils.getSelectedEntryEntity)(selected.getIn(['scheme', 'grids']), entryenties);\n      var commonSearchParam = [fastConditions, commonConditions, selectedEntryEntity];\n      var schemeSearchParm = [fastConditions, schmeConditions, selectedEntryEntity];\n      return {\n        commonSearchParam: commonSearchParam,\n        schemeSearchParm: schemeSearchParm\n      };\n    };\n    var methods = {\n      // 选择方案\n      onSchemeSelect: function onSchemeSelect(schemeId) {\n        // todo:根据方案名直接触发查询，根据方案名去找需要发送的参数\n        var selected = selecteForTest.current;\n        var data = dataForTest.current;\n        var newSelectedScheme = (0, _utils.getSelectedScheme)(data, selected, schemeId);\n        var newSelected = selected.set('scheme', newSelectedScheme[\"delete\"]('status'));\n        selecteForTest.current = newSelected;\n        _updateSelected(newSelected);\n        var _getFilterParam = getFilterParam(),\n          schemeSearchParm = _getFilterParam.schemeSearchParm;\n        handleSchemSearch(schemeSearchParm);\n      },\n      // 删除选中方案\n      onDelSelectedScheme: function onDelSelectedScheme(schemeId) {\n        handleDeleteScheme(schemeId);\n      },\n      // 快速搜索删除条件\n      onQSDelCondition: function onQSDelCondition(args) {\n        var isCommon = args.isCommon,\n          others = _objectWithoutProperties(args, _excluded);\n        if (args.isCommon) {\n          handleCommonSearch(others);\n        } else {\n          handleSchemSearch(others);\n        }\n      },\n      // 快速搜索选中\n      onQSSelectItem: function onQSSelectItem(args) {\n        var isCommon = args.isCommon,\n          others = _objectWithoutProperties(args, _excluded2);\n        if (args.isCommon) {\n          handleCommonSearch(others);\n        } else {\n          handleSchemSearch(others);\n        }\n      },\n      // 常用过滤条件选择\n      onCommonSelect: function onCommonSelect(args) {\n        handleCommonSearch(args);\n      },\n      // 常用查询条件删除\n      onSelectedConditionDel: function onSelectedConditionDel(args) {\n        handleCommonSearch(args);\n      },\n      // 打开 f7 列表\n      f7Click: function f7Click() {\n        handleCommonF7Click.apply(void 0, arguments);\n      },\n      getFilterParam: getFilterParam,\n      updateSelected: function updateSelected() {\n        for (var _len = arguments.length, arg = new Array(_len), _key = 0; _key < _len; _key++) {\n          arg[_key] = arguments[_key];\n        }\n        var type = arg[0],\n          key = arg[1],\n          value = arg[2];\n        var selected = selecteForTest.current;\n        var newSelected;\n        var curType = selected.get(type);\n        if (type === 'common') {\n          var curIndex = curType.findIndex(function (item) {\n            return (item === null || item === void 0 ? void 0 : item.get('k')) === key;\n          });\n          if (curIndex === -1) {\n            throw new Error((0, _intlApi.getLangMsg)({\n              key: 'Control.key002'\n            }));\n          }\n          newSelected = selected.setIn([type, curIndex, 'v'], (0, _immutable.fromJS)(value));\n        }\n        if (type === 'fast') {\n          // todo：清空快速搜索值\n          if (key === 'clear') {\n            newSelected = selected.set(type, (0, _immutable.fromJS)([]));\n          } else {\n            newSelected = selected.set(type, (0, _immutable.fromJS)(value));\n          }\n        }\n        _updateSelected(newSelected);\n      },\n      getData: function getData() {\n        return {\n          selected: selecteForTest.current.toJS(),\n          data: dataForTest.current.toJS()\n        };\n      }\n    };\n    return {\n      get: function get(name) {\n        var caller = new _index2.ChainCaller();\n        caller.use(function (next) {\n          if (SUPPORTGETTER.includes(name)) {\n            return model.getDataProperty('name');\n          }\n          return next();\n        });\n        caller.use((0, _index2.checkSupportNames)({\n          name: name\n        }));\n        return caller.exec();\n      },\n      set: function set(name, value) {\n        var caller = new _index2.ChainCaller();\n        caller.use(function (next) {\n          if (name === 'selected') {\n            handleSelectedChange('selected', value);\n            return;\n          }\n          if (name === 'fields') {\n            (0, _querypanelaction.updateFields)(model, (0, _immutable.fromJS)(value));\n            return;\n          }\n          return next();\n        });\n        caller.use((0, _index2.checkSupportNames)({\n          name: name\n        }));\n        return caller.exec();\n      },\n      performControlMethod: function performControlMethod(methodName) {\n        for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n        // 获取方法并且执行\n        return methods[methodName].apply(methods, args);\n      },\n      // 支持内容字典\n      supportedProppertyNames: (0, _index.createSupportedProppertyNames)({\n        supportGetterNames: SUPPORTGETTER,\n        supportSetterNames: SUPPORTSETTER,\n        supportControlMethodNames: SUPPORTMETHOD\n      })\n    };\n  };\n};\nvar _default = exports[\"default\"] = listquerypanelProxy;\n\n//# sourceURL=webpack://bos-platform/./src/control/proxy/listquerypanelProxy.js?");

/***/ })

}]);