"use strict";(self["webpackJsonp_bos-platform"]=self["webpackJsonp_bos-platform"]||[]).push([[9299],{259299:function(e,t,r){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}r(182320),r(909112),r(697060),r(360776),r(241872),r(743924),r(205960),r(297336),r(846428),r(708896),r(606200),r(534440),r(670864),r(76124),r(880920),r(836887),r(78504),r(776512),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r(323784),r(336368),r(387912),r(497448);var n,a,u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var r=D(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}(r(795520)),i=r(891052),c=I(r(348896)),l=I(r(385384)),s=I(r(182956)),f=r(738704),d=r(439532),m=r(90920),p=I(r(706144)),y=I(r(329132)),g=r(552032),h=r(545072),v=I(r(149236)),b=r(474144),O=r(218652),C=["data","configItems","lock","lang","themeColor","themeNum","cardRowData","gridRowData","subFormsArry"];function I(e){return e&&e.__esModule?e:{default:e}}function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(D=function(e){return e?r:t})(e)}function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},P.apply(this,arguments)}function w(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function j(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,S(o.key),o)}}function S(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:String(t)}function _(e,t,r){return t=k(t),function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,M()?Reflect.construct(t,r||[],k(e).constructor):t.apply(e,r))}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}var E=(n=(0,c.default)(!1),(0,l.default)(a=(0,s.default)(a=n(a=(0,v.default)(a=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=_(this,t,[e])).getCustomInfo=function(e){var t=e.pageId,o=e.key,n=e.meta&&e.meta.toJS(),a=e.getDataValue();a&&a.toJS&&(a=a.toJS());var u=(0,d.getComponentDataProperty)(e,"ci","ci",!1);u=u&&u.toJS();var c=r.props.isLocked,l=e.getUserLocale(),s=(0,m.getCurrentTheme)(),f=s.themeNum,p=s.themeColor,y=e.state,g=(0,d.getCustomControlSubForms)(e.pageId,e.meta.get("id"),y),h=(0,m.getCardRowData)(r.props,e),v=e.getMetaProperty(["item","schemaInfo"])||e.getMetaProperty("schemaInfo")||(0,i.Map)({});return{pageId:t,controlKey:o,data:a,metaData:n,schemaId:v.get("schemaId"),isvId:v.get("isvId"),moduleId:v.get("moduleId"),configItems:u,lock:c,lang:l,themeColor:p,themeNum:f,cardRowData:h,subFormsArry:g,fileServer:e.getFormConfig()&&e.getFormConfig().fileserver}},r.invokeCustomMethod=function(e){var t=e.pageId,o=e.key,n=r.props.dispatch;return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r=Array.isArray(r)?r:[r],n((0,g.invokeCustomMethod)(t,o,e,r,a))}},r.setPostData=function(e){var t=e.pageId,r=e.key,o="controls";return e.getMetaProperty(["item"])&&(o="fields"),function(e){"controls"===o?(0,O.setControlPostValue)(t,r,e):(0,O.setFieldPostValue)(t,r,e)}},r.state={pageLoad:(0,f.getPageData)(e.model.pageId,h.PAGE_LOAD)},r.attachDataInstance=new b.InjectAttachData,r}var r,o,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(t,e),r=t,(o=[{key:"componentDidMount",value:function(){var e=this;if(!this.state.pageLoad){var t=this.props.model.pageId;this.removePageLoadDataChangeListener=(0,f.addDataChangeListener)(t,h.PAGE_LOAD,(function(t){e.setState({pageLoad:t})}))}}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props.model,o=e.model,n=r.getDataValue(),a=o.getDataValue(),u=(0,d.getComponentDataProperty)(r,"ci","ci",!1),c=(0,d.getComponentDataProperty)(o,"ci","ci",!1),l=this.props.isLocked,s=e.isLocked,f=(0,m.getCardRowData)(this.props,r),p=(0,m.getCardRowData)(e,o),y=r.getUserLocale(),g=o.getUserLocale(),h=r.getDataProperty("subForms"),v=o.getDataProperty("subForms");return!(this.state.pageLoad===t.pageLoad&&(0,i.is)(a,n)&&(0,i.is)(u,c)&&l===s&&(0,i.is)((0,i.fromJS)(f),(0,i.fromJS)(p))&&y===g&&(0,i.is)(h,v))}},{key:"componentWillUnmount",value:function(){this.removePageLoadDataChangeListener&&this.removePageLoadDataChangeListener()}},{key:"render",value:function(){var e=this.props,t=e.model,r=e.style,o=e.attachData;if(!this.state.pageLoad)return null;var n=this.getCustomInfo(t),a=Object.assign({},(0,d.getCommonStyle)(t),r),i=(0,y.default)((0,d.getCommonClass)(t));if(!t.getMetaProperty(["item","isCustom"])&&!t.getMetaProperty("schemaInfo")){var c=n.subFormsArry.outerForms,l=void 0===c?[]:c;return u.default.createElement("div",{style:a,className:i},l.length&&u.default.Children.toArray(l))}var s=n.data,f=n.configItems,m=n.lock,g=n.lang,h=n.themeColor,v=n.themeNum,b=n.cardRowData,O=n.gridRowData,I=n.subFormsArry,D=w(n,C),j={data:s,configItems:f,lock:m,lang:g,themeColor:h,themeNum:v,cardRowData:b,gridRowData:O};return u.default.createElement(p.default,P({setPostData:this.setPostData(t),invokeCustomMethod:this.invokeCustomMethod(t),model:t,style:a,className:i},o,D,{outerForms:I.outerForms,innerForms:I.innerForms,customProps:j,attachDataInstance:this.attachDataInstance}))}}])&&j(r.prototype,o),n&&j(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}(u.Component))||a)||a)||a)||a);t.default=E},706144:function(e,t,r){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}r(182320),r(909112),r(697060),r(360776),r(505684),r(241872),r(743924),r(693917),r(205960),r(976896),r(297336),r(721300),r(846428),r(336368),r(969e3),r(606200),r(534440),r(76152),r(76124),r(633768),r(690512),r(78504),r(776512),r(977864),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,r=e.pageId,o=e.controlKey,n=e.metaData,p=e.schemaId,y=e.isvId,h=e.moduleId,b=e.invokeCustomMethod,C=e.innerForms,w=e.outerForms,j=e.customProps,S=e.fileServer,_=e.style,M=e.className,k=e.setPostData,A=e.attachDataInstance,E=(e.model,function(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,m)),R=(0,d.default)(),L=R.themeNum,F=R.themeColor,N=O((0,a.useState)(null),2),K=N[0],T=N[1],x=(0,a.useRef)(null),J=(0,a.useRef)(null),U=(0,a.useRef)([]),W=(0,a.useRef)(!1),V=O((0,a.useState)(C),2),B=V[0],Y=V[1];(0,a.useEffect)((function(){(0,u.saveModel)({schemaId:p,isvId:y,moduleId:h,pageId:r,lang:a,controlKey:o},p);var e=j.cardRowData,t=j.gridRowData,a=j.lang,c=window.KDApi.nameSpace({schemaId:p,isvId:y,moduleId:h,pageId:r,controlKey:o,lang:a})+"index.js",l=(0,u.createCustomModel)({pageId:r,controlKey:o,dom:J.current,schemaId:p,isvId:y,moduleId:h,fileServer:S,metaData:n,cardRowData:e,gridRowData:t,lang:a,invokeCustomMethod:b,setPostData:k,injectAttachData:null==A?void 0:A.setAttachData});return(0,i.getCurrentCustomComponent)(l,p,c,y).then((function(e){x.current=new e(l),T(x.current)})).catch((function(e){})),function(){x.current&&(0,i.executeCustomCtrlMethod)(x.current,"destoryed")}}),[]),(0,a.useEffect)((function(){var e;try{var t;if(K)!0!==(0,i.executeCustomCtrlMethod)(x.current,"init",j)&&(0,i.executeCustomCtrlMethod)(x.current,"update",j),null!==(t=J.current)&&void 0!==t&&null!==(t=t.children)&&void 0!==t&&t.length&&D(C,Y,G,W,U,$),e=(0,i.customDomObserver)(J.current,(function(e){D(C,Y,G,W,U,$)})),(0,f.getData)(s.KEY_CUSTOM_CTRL_INIT)||((0,f.setData)(s.KEY_CUSTOM_CTRL_INIT,!0),(0,f.setData)(s.KEY_UI_ACTION,{pageId:r,key:o,schemaId:p,isvId:y,moduleId:h,lang:j.lang,methodName:"KDApi.register(init)",tableName:I}))}catch(e){}return function(){e&&e.disconnect()}}),[K]),(0,a.useEffect)((function(){try{var e=(0,i.getCurrentTheme)().themeColor;(0,i.executeCustomCtrlMethod)(x.current,"update",v(v({},j),{},{themeColor:e,themeNum:L}))}catch(e){}}),[(0,c.fromJS)(j).hashCode(),L,F]),(0,a.useEffect)((function(){var e=(0,l.subscribeControlMethod)(r,o,"directives",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];W.current?$(t):null===(e=U.current)||void 0===e||e.push(t)}));return function(){e()}}),[]),(0,a.useEffect)((function(){C.length&&(G(C).length?Y(G(C)):(0,i.customDomObserver)(J.current,(function(e){Y(G(C))})))}),[(0,c.fromJS)(C).hashCode()]);var G=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(e){var t=e.elementId;return t&&document.getElementById(t)}))},$=function(e){P(e,x,j)},q=null==A||null===(t=A.getAttachData())||void 0===t?void 0:t.innerFormsRootElement;return a.default.createElement("div",g({ref:J,style:_,className:M},E),w.length?a.default.Children.toArray(w):null,C.length?a.default.Children.toArray((0,i.parseInnerForms)(J,B,q)):null)},t.domChangeCallback=D,t.initCustomComponentInstance=function(e){var t=e.pageId,r=e.controlKey,o=e.schemaId,n=e.isvId,a=e.moduleId,c=e.invokeCustomMethod,l=e.fileServer,s=e.customProps.lang,f=(0,u.getCustomComponent)(o);if(f)return new Promise((function(e){e(f)}));var d=window.KDApi.nameSpace({schemaId:o,isvId:n,moduleId:a,pageId:t,controlKey:r,lang:s})+"index.js",m=(0,u.createCustomModel)({pageId:t,controlKey:r,schemaId:o,isvId:n,moduleId:a,fileServer:l,lang:s,invokeCustomMethod:c});return(0,i.getCurrentCustomComponent)(m,o,d,n)},t.subscribeCallback=P,r(622676),r(233696),r(323784),r(387912),r(497448),r(997308);var n,a=y(r(795520)),u=r(474144),i=r(90920),c=r(891052),l=r(738704),s=r(868256),f=r(674260),d=(n=r(569788))&&n.__esModule?n:{default:n},m=(y(r(211152)),["pageId","controlKey","metaData","schemaId","isvId","moduleId","invokeCustomMethod","innerForms","outerForms","customProps","fileServer","style","className","setPostData","attachDataInstance","model"]);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p=function(e){return e?r:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var r=p(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},g.apply(this,arguments)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){var n;return n=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==o(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,a,u,i=[],c=!0,l=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(o=a.call(r)).done)&&(i.push(o.value),i.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(l)throw n}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var I="cusctrl_action";function D(e,t,r,o,n,a){e.length&&t(r(e)),o.current=!0,Array.isArray(n.current)&&n.current.length>0&&(n.current.forEach((function(e){a(e)})),n.current=[])}function P(e,t,r){Array.isArray(e)&&e.forEach((function(e){var o=e.methodname,n=e.args;o&&(0,i.executeCustomCtrlMethod)(t.current,"handleDirective",r,o,n)}))}}}]);