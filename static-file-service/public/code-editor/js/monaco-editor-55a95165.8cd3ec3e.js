(self.webpackChunkcode_editor=self.webpackChunkcode_editor||[]).push([[7088],{33924:function(e,t,i){"use strict";i.d(t,{Km:function(){return n},Qx:function(){return r},_w:function(){return l},aK:function(){return a},kH:function(){return d},uC:function(){return s}});class o{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class n extends o{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class r{constructor(e,t,i){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i}}class s{static from(e){const t=new Array(e.length);for(let i=0,o=e.length;i<o;i++){const o=e[i];t[i]=new s(o.left,o.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class d{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class a{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class l{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}},50020:function(e,t,i){"use strict";i.d(t,{Y:function(){return s},o:function(){return d}});var o,n=i(36184),r=i(41852);class s{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Error("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(0===this.getCount())return null;const i=this.getStartLineNumber(),o=this.getEndLineNumber();if(t<i){const i=t-e+1;return this._rendLineNumberStart-=i,null}if(e>o)return null;let n=0,r=0;for(let s=i;s<=o;s++){const i=s-this._rendLineNumberStart;e<=s&&s<=t&&(0===r?(n=i,r=1):r++)}if(e<i){let o=0;o=t<i?t-e+1:i-e,this._rendLineNumberStart-=o}return this._lines.splice(n,r)}onLinesChanged(e,t){const i=e+t-1;if(0===this.getCount())return!1;const o=this.getStartLineNumber(),n=this.getEndLineNumber();let r=!1;for(let t=e;t<=i;t++)t>=o&&t<=n&&(this._lines[t-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(e,t){if(0===this.getCount())return null;const i=t-e+1,o=this.getStartLineNumber(),n=this.getEndLineNumber();if(e<=o)return this._rendLineNumberStart+=i,null;if(e>n)return null;if(i+e>n){return this._lines.splice(e-this._rendLineNumberStart,n-e+1)}const r=[];for(let e=0;e<i;e++)r[e]=this._createLine();const s=e-this._rendLineNumberStart,d=this._lines.slice(0,s),a=this._lines.slice(s,this._lines.length-i),l=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=d.concat(r).concat(a),l}onTokensChanged(e){if(0===this.getCount())return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let o=!1;for(let n=0,r=e.length;n<r;n++){const r=e[n];if(r.toLineNumber<t||r.fromLineNumber>i)continue;const s=Math.max(t,r.fromLineNumber),d=Math.min(i,r.toLineNumber);for(let e=s;e<=d;e++){const t=e-this._rendLineNumberStart;this._lines[t].onTokensChanged(),o=!0}}return o}}class d{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new s((()=>this._host.createVisibleLine()))}_createDomNode(){const e=(0,n.K)(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(139)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let e=0,i=t.length;e<i;e++){const i=t[e].getDomNode();i&&this.domNode.domNode.removeChild(i)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let e=0,i=t.length;e<i;e++){const i=t[e].getDomNode();i&&this.domNode.domNode.removeChild(i)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new a(this.domNode.domNode,this._host,e),o={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},n=i.render(o,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(n.rendLineNumberStart,n.lines)}}class a{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,o){const n={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(n.rendLineNumberStart+n.linesLength-1<t||i<n.rendLineNumberStart){n.rendLineNumberStart=t,n.linesLength=i-t+1,n.lines=[];for(let e=t;e<=i;e++)n.lines[e-t]=this.host.createVisibleLine();return this._finishRendering(n,!0,o),n}if(this._renderUntouchedLines(n,Math.max(t-n.rendLineNumberStart,0),Math.min(i-n.rendLineNumberStart,n.linesLength-1),o,t),n.rendLineNumberStart>t){const e=t,r=Math.min(i,n.rendLineNumberStart-1);e<=r&&(this._insertLinesBefore(n,e,r,o,t),n.linesLength+=r-e+1)}else if(n.rendLineNumberStart<t){const e=Math.min(n.linesLength,t-n.rendLineNumberStart);e>0&&(this._removeLinesBefore(n,e),n.linesLength-=e)}if(n.rendLineNumberStart=t,n.rendLineNumberStart+n.linesLength-1<i){const e=n.rendLineNumberStart+n.linesLength,r=i;e<=r&&(this._insertLinesAfter(n,e,r,o,t),n.linesLength+=r-e+1)}else if(n.rendLineNumberStart+n.linesLength-1>i){const e=Math.max(0,i-n.rendLineNumberStart+1),t=n.linesLength-1-e+1;t>0&&(this._removeLinesAfter(n,t),n.linesLength-=t)}return this._finishRendering(n,!1,o),n}_renderUntouchedLines(e,t,i,o,n){const r=e.rendLineNumberStart,s=e.lines;for(let e=t;e<=i;e++){const t=r+e;s[e].layoutLine(t,o[t-n])}}_insertLinesBefore(e,t,i,o,n){const r=[];let s=0;for(let e=t;e<=i;e++)r[s++]=this.host.createVisibleLine();e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const t=e.lines[i].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,o,n){const r=[];let s=0;for(let e=t;e<=i;e++)r[s++]=this.host.createVisibleLine();e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let o=0;o<t;o++){const t=e.lines[i+o].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,o){a._ttPolicy&&(i=a._ttPolicy.createHTML(i));const n=this.domNode.lastChild;t||!n?this.domNode.innerHTML=i:n.insertAdjacentHTML("afterend",i);let r=this.domNode.lastChild;for(let t=e.linesLength-1;t>=0;t--){const i=e.lines[t];o[t]&&(i.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const o=document.createElement("div");a._ttPolicy&&(t=a._ttPolicy.createHTML(t)),o.innerHTML=t;for(let t=0;t<e.linesLength;t++){const n=e.lines[t];if(i[t]){const e=o.firstChild,t=n.getDomNode();t.parentNode.replaceChild(e,t),n.setDomNode(e)}}}_finishRendering(e,t,i){const o=a._sb,n=e.linesLength,r=e.lines,s=e.rendLineNumberStart,d=[];{o.reset();let a=!1;for(let e=0;e<n;e++){const t=r[e];d[e]=!1;if(t.getDomNode())continue;t.renderLine(e+s,i[e],this.viewportData,o)&&(d[e]=!0,a=!0)}a&&this._finishRenderingNewLines(e,t,o.build(),d)}{o.reset();let t=!1;const a=[];for(let e=0;e<n;e++){const n=r[e];if(a[e]=!1,d[e])continue;n.renderLine(e+s,i[e],this.viewportData,o)&&(a[e]=!0,t=!0)}t&&this._finishRenderingInvalidLines(e,o.build(),a)}}}a._ttPolicy=null===(o=window.trustedTypes)||void 0===o?void 0:o.createPolicy("editorViewLayer",{createHTML:e=>e}),a._sb=new r.gh(1e5)},2880:function(e,t,i){"use strict";i.d(t,{W:function(){return n},y:function(){return r}});var o=i(32624);class n extends o.y{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class r{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return null===t?0:parseInt(t,10)}static collect(e,t){const i=[];let o=0;for(;e&&e!==document.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[o++]=this.read(e)),e=e.parentElement;const n=new Uint8Array(o);for(let e=0;e<o;e++)n[e]=i[o-e-1];return n}}},61504:function(e,t,i){"use strict";i.d(t,{qU:function(){return Pe}});i(3728),i(30980);var o=i(38744),n=i(69040),r=i(32096),s=i(50420),d=i(39048),a=i(34656),l=i(9384),h=i(27440),c=i(85432),u=i(95664),g=i(36184),m=i(81632),_=i(46208),f=i(35256),v=i(4400),p=i(58776);class w{constructor(e,t,i,o){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=o}paste(e,t,i,o){this.commandDelegate.paste(e,t,i,o)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,o){this.commandDelegate.compositionType(e,t,i,o)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){f.cV.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new v.J(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(75)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(75)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=p.Co&&t.get(102),o=t.get(20);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):2===e.mouseDownCount?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||o?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){f.cV.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){f.cV.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),f.cV.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),f.cV.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){f.cV.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){f.cV.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){f.cV.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){f.cV.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){f.cV.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){f.cV.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){f.cV.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){f.cV.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){f.cV.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class b{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;null===(t=this.onKeyDown)||void 0===t||t.call(this,e)}emitKeyUp(e){var t;null===(t=this.onKeyUp)||void 0===t||t.call(this,e)}emitContextMenu(e){var t;null===(t=this.onContextMenu)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;null===(t=this.onMouseMove)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;null===(t=this.onMouseLeave)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;null===(t=this.onMouseDown)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;null===(t=this.onMouseUp)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;null===(t=this.onMouseDrag)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;null===(t=this.onMouseDrop)||void 0===t||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;null===(e=this.onMouseDropCanceled)||void 0===e||e.call(this)}emitMouseWheel(e){var t;null===(t=this.onMouseWheel)||void 0===t||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return b.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i=Object.assign({},e);return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),5!==i.type&&8!==i.type||(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new v.J(e.afterLineNumber,1)).lineNumber}}}var C=i(66196),D=i(50020),L=i(2880);class S extends L.W{constructor(e){super(e),this._visibleLines=new D.o(this),this.domNode=this._visibleLines.domNode;const t=this._context.configuration.options.get(48);(0,C.K)(this.domNode,t),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++){if(this._dynamicOverlays[e].shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++){this._dynamicOverlays[e].dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new y(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let o=t;o<=i;o++){this._visibleLines.getVisibleLine(o).onConfigurationChanged(e)}const o=this._context.configuration.options.get(48);return(0,C.K)(this.domNode,o),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let i=0,o=t.length;i<o;i++){const o=t[i];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class y{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(64),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=(0,g.K)(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(64)}renderLine(e,t,i,o){let n="";for(let t=0,o=this._dynamicOverlays.length;t<o;t++){n+=this._dynamicOverlays[t].render(i.startLineNumber,e)}return this._renderedContent!==n&&(this._renderedContent=n,o.appendString('<div style="position:absolute;top:'),o.appendString(String(t)),o.appendString("px;width:100%;height:"),o.appendString(String(this._lineHeight)),o.appendString('px;">'),o.appendString(n),o.appendString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class E extends S{constructor(e){super(e);const t=this._context.configuration.options.get(139);this._contentWidth=t.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const t=this._context.configuration.options.get(139);return this._contentWidth=t.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class N extends S{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(139);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),(0,C.K)(this.domNode,t.get(48))}onConfigurationChanged(e){const t=this._context.configuration.options;(0,C.K)(this.domNode,t.get(48));const i=t.get(139);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}var M=i(24056),R=i(116),x=i(65168),T=i(19752),I=i(21160),O=i(43612),P=i(48568),V=i(12784),W=i(71491),F=i(68936),A=i(53976),k=i(3082),H=i(92468),B=i(82448),U=i(81260),z=i(85844),K=i(4184),Z=i(48068),Q=i(66984),q=i(46824),j=i(33924),$=i(26848),G=i(5196),J=i(32624),X=i(68992),Y=i(53204),ee=i(29892),te=i(42816),ie=i(7676);class oe extends J.y{constructor(e,t,i,o,n,r){super(),this._selections=[new u.G(1,1,1,1)],this._renderAnimationFrame=null;const s=new w(t,o,n,e);this._context=new $.A(t,i,o),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=new _.A(this._context,s,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=(0,g.K)(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=(0,g.K)(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=(0,g.K)(document.createElement("div")),L.y.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new T.w(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new V.Q(this._context,this._linesContent),this._viewZones=new q.T(this._context),this._viewParts.push(this._viewZones);const d=new B.A(this._context);this._viewParts.push(d);const a=new K.i(this._context);this._viewParts.push(a);const l=new E(this._context);this._viewParts.push(l),l.addDynamicOverlay(new R.yc(this._context)),l.addDynamicOverlay(new Z.W(this._context)),l.addDynamicOverlay(new O.s(this._context)),l.addDynamicOverlay(new x.y(this._context)),l.addDynamicOverlay(new ie.E(this._context));const h=new N(this._context);this._viewParts.push(h),h.addDynamicOverlay(new R.oL(this._context)),h.addDynamicOverlay(new I.C(this._context)),h.addDynamicOverlay(new A.O(this._context)),h.addDynamicOverlay(new W.y(this._context)),h.addDynamicOverlay(new P.i(this._context));const c=new F.c(this._context);c.getDomNode().appendChild(this._viewZones.marginDomNode),c.getDomNode().appendChild(h.getDomNode()),this._viewParts.push(c),this._contentWidgets=new M.w(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new Q.k(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new H.o(this._context),this._viewParts.push(this._overlayWidgets);const f=new z.A(this._context);this._viewParts.push(f);const v=new ee.o(this._context);this._viewParts.push(v);const p=new k.s(this._context);if(this._viewParts.push(p),d){const e=this._scrollbar.getOverviewRulerLayoutInfo();e.parent.insertBefore(d.getDomNode(),e.insertBefore)}this._linesContent.appendChild(l.getDomNode()),this._linesContent.appendChild(f.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(c.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(a.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(p.getDomNode()),this._overflowGuardContainer.appendChild(v.domNode),this.domNode.appendChild(this._overflowGuardContainer),r?r.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new m.Q(this._context,s,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){te.M.onRenderStart(),this._renderNow()}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new Y.cB(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new v.J(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const e=this._context.configuration.options.get(139);this.domNode.setWidth(e.width),this.domNode.setHeight(e.height),this._overflowGuardContainer.setWidth(e.width),this._overflowGuardContainer.setHeight(e.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(136)+" "+(0,X.Uh)(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=n.ac(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){!function(e){try{return e()}catch(e){(0,r.eU)(e)}}((()=>this._actualRender()))}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!n.UZ(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&0===e.length)return;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new G.o(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const o=new j.Km(this._context.viewLayout,i,this._viewLines);for(const t of e)t.prepareRender(o);for(const t of e)t.render(o),t.onDidRender()}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),o=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const n=this._viewLines.visibleRangeForPosition(new v.J(o.lineNumber,o.column));return n?n.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?b.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new U.O(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const e of this._viewParts)e.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,o,n,r,s,d,a;this._contentWidgets.setWidgetPosition(e.widget,null!==(i=null===(t=e.position)||void 0===t?void 0:t.position)&&void 0!==i?i:null,null!==(n=null===(o=e.position)||void 0===o?void 0:o.secondaryPosition)&&void 0!==n?n:null,null!==(s=null===(r=e.position)||void 0===r?void 0:r.preference)&&void 0!==s?s:null,null!==(a=null===(d=e.position)||void 0===d?void 0:d.positionAffinity)&&void 0!==a?a:null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null;this._overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}}var ne=i(5872),re=i(47776),se=i(90836),de=i(36732),ae=i(93428),le=i(25900),he=i(33568),ce=i(18252),ue=i(76),ge=i(11635),me=i(8296),_e=i(93636),fe=i(34572),ve=i(10772),pe=i(41972),we=i(32736),be=i(96196),Ce=i(28656),De=i(47300),Le=i(79375),Se=i(71456),ye=i(42792),Ee=i(81564);class Ne extends d.CC{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new d.Cg),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const e of t)this._pending.has(e.id)?(0,r.eU)(new Error(`Cannot have two contributions with the same id ${e.id}`)):this._pending.set(e.id,e);this._instantiateSome(0),this._register((0,Ee.kp)((()=>{this._instantiateSome(1)}))),this._register((0,Ee.kp)((()=>{this._instantiateSome(2)}))),this._register((0,Ee.kp)((()=>{this._instantiateSome(3)}),5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)"function"==typeof i.saveViewState&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)"function"==typeof i.restoreViewState&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register((0,Ee.kp)((()=>{this._instantiateSome(1)}),50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const e of t)this._instantiateById(e.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const e=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,e),"function"==typeof e.restoreViewState&&0!==t.instantiation&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(e){(0,r.eU)(e)}}}}var Me=i(73664),Re=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},xe=function(e,t){return function(i,o){t(i,o,e)}},Te=function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function d(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,d)}a((o=o.apply(e,t||[])).next())}))};let Ie=0;class Oe{constructor(e,t,i,o,n,r){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=o,this.listenersToRemove=n,this.attachedView=r}dispose(){(0,d.Mt)(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let Pe=class e extends d.CC{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,t,i,o,d,a,l,c,u,g,m,_){super(),this.languageConfigurationService=m,this._deliveryQueue=new s.Cu,this._contributions=this._register(new Ne),this._onDidDispose=this._register(new s.sl),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new We(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new Ve({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new Ve({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new We(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new We(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new We(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new We(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new We(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new We(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new We(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new We(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new We(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new We(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new s.sl({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),d.willCreateCodeEditor();const f=Object.assign({},t);let v;this._domElement=e,this._overflowWidgetsDomNode=f.overflowWidgetsDomNode,delete f.overflowWidgetsDomNode,this._id=++Ie,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,f,g)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const t=this._configuration.options;if(e.hasChanged(139)){const e=t.get(139);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=u,this._codeEditorService=d,this._commandService=a,this._themeService=c,this._register(new Fe(this,this._contextKeyService)),this._register(new Ae(this,this._contextKeyService,_)),this._instantiationService=o.createChild(new ve.M([_e.KK,this._contextKeyService])),this._modelData=null,this._focusTracker=new ke(e),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},v=Array.isArray(i.contributions)?i.contributions:h.UX.getEditorContributions(),this._contributions.initialize(this,v,this._instantiationService);for(const e of h.UX.getEditorActions()){if(this._actions.has(e.id)){(0,r.eU)(new Error(`Cannot have two actions with the same id ${e.id}`));continue}const t=new de.C(e.id,e.label,e.alias,(0,be.uy)(e.precondition),(()=>this._instantiationService.invokeFunction((t=>Promise.resolve(e.runEditorCommand(t,this,null))))),this._contextKeyService);this._actions.set(t.id,t)}const p=()=>!this._configuration.options.get(87)&&this._configuration.options.get(34).enabled;this._register(new n.wF(this._domElement,{onDragEnter:()=>{},onDragOver:e=>{if(!p())return;const t=this.getTargetAtClientPoint(e.clientX,e.clientY);(null==t?void 0:t.position)&&this.showDropIndicatorAt(t.position)},onDrop:e=>Te(this,void 0,void 0,(function*(){if(!p())return;if(this.removeDropIndicator(),!e.dataTransfer)return;const t=this.getTargetAtClientPoint(e.clientX,e.clientY);(null==t?void 0:t.position)&&this._onDropIntoEditor.fire({position:t.position,event:e})})),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;null===(t=this._modelData)||void 0===t||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i){return new l.U(e,t,this._domElement,i)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return ae.a.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Le.z.getWordAtPosition(this._modelData.model,this._configuration.options.get(125),e):null}getValue(e=null){if(!this._modelData)return"";const t=!(!e||!e.preserveBOM);let i=0;return e&&e.lineEnding&&"\n"===e.lineEnding?i=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(null===this._modelData&&null===t)return;if(this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),o=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const n={oldModelUrl:o?o.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(n),this._postDetachModelCleanup(o),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,o){const n=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(r.lineNumber,o)}getTopForLineNumber(t,i=!1){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,1,i):-1}getTopForPosition(t,i){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,i,!1):-1}static _getVerticalOffsetForPosition(e,t,i,o=!1){const n=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber,o)}getBottomForLineNumber(t,i=!1){return this._modelData?e._getVerticalOffsetAfterPosition(this._modelData,t,1,i):-1}setHiddenAreas(e,t){var i;null===(i=this._modelData)||void 0===i||i.viewModel.setHiddenAreas(e.map((e=>se.E.lift(e))),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return re.K.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!v.J.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,o){if(!this._modelData)return;if(!se.E.isIRange(e))throw new Error("Invalid arguments");const n=this._modelData.model.validateRange(e),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(n);this._modelData.viewModel.revealRange("api",i,r,t,o)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if("number"!=typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new se.E(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,o){if(!v.J.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new se.E(e.lineNumber,e.column,e.lineNumber,e.column),t,i,o)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=u.G.isISelection(e),o=se.E.isIRange(e);if(!i&&!o)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(o){const i={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(i,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new u.G(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,o){if("number"!=typeof e||"number"!=typeof t)throw new Error("Invalid arguments");this._sendRevealRange(new se.E(e,1,t,1),i,!1,o)}revealRange(e,t=0,i=!1,o=!0){this._revealRange(e,i?1:0,o,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,o){if(!se.E.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(se.E.lift(e),t,i,o)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let t=0,i=e.length;t<i;t++)if(!u.G.isISelection(e[t]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if("number"!=typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if("number"!=typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return!!this._modelData&&this._modelData.viewModel.viewLayout.hasPendingScrollAnimation()}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState();return{cursorState:this._modelData.viewModel.saveCursorState(),viewState:this._modelData.viewModel.saveState(),contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const e=t.cursorState;Array.isArray(e)?e.length>0&&this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]),this._contributions.restoreViewState(t.contributionsState||{});const i=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(i)}}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const t=i;return void this._type(e,t.text||"")}case"replacePreviousChar":{const t=i;return void this._compositionType(e,t.text||"",t.replaceCharCnt||0,0,0)}case"compositionType":{const t=i;return void this._compositionType(e,t.text||"",t.replacePrevCharCnt||0,t.replaceNextCharCnt||0,t.positionDelta||0)}case"paste":{const t=i;return void this._paste(e,t.text||"",t.pasteOnNewLine||!1,t.multicursorText||null,t.mode||null)}case"cut":return void this._cut(e)}const o=this.getAction(t);o?Promise.resolve(o.run(i)).then(void 0,r.eU):this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){this._modelData&&0!==t.length&&("keyboard"===e&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),"keyboard"===e&&this._onDidType.fire(t))}_compositionType(e,t,i,o,n){this._modelData&&this._modelData.viewModel.compositionType(t,i,o,n,e)}_paste(e,t,i,o,n){if(!this._modelData||0===t.length)return;const r=this._modelData.viewModel,s=r.getSelection().getStartPosition();r.paste(t,i,o,e);const d=r.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new se.E(s.lineNumber,s.column,d.lineNumber,d.column),languageId:n})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const o=h.UX.getEditorCommand(t);return!!o&&((i=i||{}).source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(o.runEditorCommand(e,this,i)).then(void 0,r.eU)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(87)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(87)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,t,i){if(!this._modelData)return!1;if(this._configuration.options.get(87))return!1;let o;return o=i?Array.isArray(i)?()=>i:i:()=>null,this._modelData.viewModel.executeEdits(e,t,o),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new He(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,(0,ne.uo)(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,(0,ne.uo)(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?0===e.length&&0===t.length?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){this._modelData&&0!==e.length&&this._modelData.model.changeDecorations((t=>{t.deltaDecorations(e,[])}))}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(139)}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarPointerDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const e=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const e=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,t):null}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;const i=this._modelData.model.validatePosition(t),o=this._configuration.options,n=o.get(139);return{top:e._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),left:this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft(),height:o.get(64)}}getOffsetForColumn(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,t):-1}render(e=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){(0,C.K)(e,this._configuration.options.get(48))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e)return void(this._modelData=null);const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),r=new ge.c(this._id,this._configuration,e,De.g.create(),Ce.A.create(this._configuration.options),(e=>n.AP(e)),this.languageConfigurationService,this._themeService,i);t.push(e.onWillDispose((()=>this.setModel(null)))),t.push(r.onEvent((t=>{switch(t.kind){case 0:this._onDidContentSizeChange.fire(t);break;case 1:this._editorTextFocus.setValue(t.hasFocus);break;case 2:this._onDidScrollChange.fire(t);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(t.reachedMaxCursorCount){const e=this.getOption(77),t=o.uy("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",e);this._notificationService.prompt(pe.qO.Warning,t,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:o.uy("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const e=[];for(let i=0,o=t.selections.length;i<o;i++)e[i]=t.selections[i].getPosition();const i={position:e[0],secondaryPositions:e.slice(1),reason:t.reason,source:t.source};this._onDidChangeCursorPosition.fire(i);const n={selection:t.selections[0],secondarySelections:t.selections.slice(1),modelVersionId:t.modelVersionId,oldSelections:t.oldSelections,oldModelVersionId:t.oldModelVersionId,source:t.source,reason:t.reason};this._onDidChangeCursorSelection.fire(n);break}case 7:this._onDidChangeModelDecorations.fire(t.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(t.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(t.event);break;case 10:this._onDidChangeModelContent.fire(t.event);break;case 11:this._onDidChangeModelOptions.fire(t.event);break;case 12:this._onDidChangeModelTokens.fire(t.event)}})));const[s,d]=this._createView(r);if(d){this._domElement.appendChild(s.domNode.domNode);let t=Object.keys(this._contentWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];s.addContentWidget(this._contentWidgets[i])}t=Object.keys(this._overlayWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];s.addOverlayWidget(this._overlayWidgets[i])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Oe(e,r,s,d,t,i)}_createView(e){let t;t=this.isSimpleWidget?{paste:(e,t,i,o)=>{this._paste("keyboard",e,t,i,o)},type:e=>{this._type("keyboard",e)},compositionType:(e,t,i,o)=>{this._compositionType("keyboard",e,t,i,o)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,t,i,o)=>{const n={text:e,pasteOnNewLine:t,multicursorText:i,mode:o};this._commandService.executeCommand("paste",n)},type:e=>{const t={text:e};this._commandService.executeCommand("type",t)},compositionType:(e,t,i,o)=>{if(i||o){const n={text:e,replacePrevCharCnt:t,replaceNextCharCnt:i,positionDelta:o};this._commandService.executeCommand("compositionType",n)}else{const i={text:e,replaceCharCnt:t};this._commandService.executeCommand("replacePreviousChar",i)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new b(e.coordinatesConverter);i.onKeyDown=e=>this._onKeyDown.fire(e),i.onKeyUp=e=>this._onKeyUp.fire(e),i.onContextMenu=e=>this._onContextMenu.fire(e),i.onMouseMove=e=>this._onMouseMove.fire(e),i.onMouseLeave=e=>this._onMouseLeave.fire(e),i.onMouseDown=e=>this._onMouseDown.fire(e),i.onMouseUp=e=>this._onMouseUp.fire(e),i.onMouseDrag=e=>this._onMouseDrag.fire(e),i.onMouseDrop=e=>this._onMouseDrop.fire(e),i.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),i.onMouseWheel=e=>this._onMouseWheel.fire(e);return[new oe(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(e){null==e||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}showDropIndicatorAt(t){const i=[{range:new se.E(t.lineNumber,t.column,t.lineNumber,t.column),options:e.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(i),this.revealPosition(t,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}};Pe.dropIntoEditorDecorationOptions=he.uw.register({description:"workbench-dnd-target",className:"dnd-target"}),Pe=Re([xe(3,fe.U9),xe(4,c.i),xe(5,me.a),xe(6,_e.KK),xe(7,X.q0),xe(8,pe.sx),xe(9,we.C),xe(10,Se.Gw),xe(11,ye.w)],Pe);class Ve extends d.CC{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new s.sl(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new s.sl(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class We extends s.sl{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class Fe extends d.CC{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=le.y.editorSimpleInput.bindTo(t),this._editorFocus=le.y.focus.bindTo(t),this._textInputFocus=le.y.textInputFocus.bindTo(t),this._editorTextFocus=le.y.editorTextFocus.bindTo(t),this._editorTabMovesFocus=le.y.tabMovesFocus.bindTo(t),this._editorReadonly=le.y.readOnly.bindTo(t),this._inDiffEditor=le.y.inDiffEditor.bindTo(t),this._editorColumnSelection=le.y.columnSelection.bindTo(t),this._hasMultipleSelections=le.y.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=le.y.hasNonEmptySelection.bindTo(t),this._canUndo=le.y.canUndo.bindTo(t),this._canRedo=le.y.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._register(Me.K.onDidChangeTabFocus((()=>this._editorTabMovesFocus.set(Me.K.getTabFocusMode("editorFocus"))))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(Me.K.getTabFocusMode("editorFocus")),this._editorReadonly.set(e.get(87)),this._inDiffEditor.set(e.get(59)),this._editorColumnSelection.set(e.get(20))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class Ae extends d.CC{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=le.y.languageId.bindTo(t),this._hasCompletionItemProvider=le.y.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=le.y.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=le.y.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=le.y.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=le.y.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=le.y.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=le.y.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=le.y.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=le.y.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=le.y.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=le.y.hasReferenceProvider.bindTo(t),this._hasRenameProvider=le.y.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=le.y.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=le.y.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=le.y.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=le.y.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=le.y.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=le.y.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=le.y.isInWalkThroughSnippet.bindTo(t);const o=()=>this._update();this._register(e.onDidChangeModel(o)),this._register(e.onDidChangeModelLanguage(o)),this._register(i.completionProvider.onDidChange(o)),this._register(i.codeActionProvider.onDidChange(o)),this._register(i.codeLensProvider.onDidChange(o)),this._register(i.definitionProvider.onDidChange(o)),this._register(i.declarationProvider.onDidChange(o)),this._register(i.implementationProvider.onDidChange(o)),this._register(i.typeDefinitionProvider.onDidChange(o)),this._register(i.hoverProvider.onDidChange(o)),this._register(i.documentHighlightProvider.onDidChange(o)),this._register(i.documentSymbolProvider.onDidChange(o)),this._register(i.referenceProvider.onDidChange(o)),this._register(i.renameProvider.onDidChange(o)),this._register(i.documentFormattingEditProvider.onDidChange(o)),this._register(i.documentRangeFormattingEditProvider.onDidChange(o)),this._register(i.signatureHelpProvider.onDidChange(o)),this._register(i.inlayHintsProvider.onDidChange(o)),o()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===a.eg.walkThroughSnippet)})):this.reset()}}class ke extends d.CC{constructor(e){super(),this._onChange=this._register(new s.sl),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(n.UF(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}class He{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations((i=>{this._isChangingDecorations||e.call(t,i)}),i)}getRange(e){return this._editor.hasModel()?e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e]):null}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const o=e.getDecorationRange(i);o&&t.push(o)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){0!==this._decorationIds.length&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations((t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)}))}finally{this._isChangingDecorations=!1}return this._decorationIds}}const Be=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),Ue=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function ze(e){return Be+encodeURIComponent(e.toString())+Ue}const Ke=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),Ze=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');(0,X.Sd)(((e,t)=>{const i=e.getColor(ue.o5h);i&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${ze(i)}") repeat-x bottom left; }`);const o=e.getColor(ue.g1m);o&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${ze(o)}") repeat-x bottom left; }`);const n=e.getColor(ue.khI);n&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${ze(n)}") repeat-x bottom left; }`);const r=e.getColor(ue.Ub8);var s;r&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${s=r,Ke+encodeURIComponent(s.toString())+Ze}") no-repeat bottom left; }`);const d=e.getColor(ce.MD);d&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${d.rgba.a}; }`)}))},31760:function(e,t,i){"use strict";i.d(t,{s:function(){return Ee}});var o,n=i(69040),r=i(36184),s=i(33024),d=i(75536),a=i(31572),l=i(81564),h=i(51708),c=i(32096),u=i(50420),g=i(39048),m=(i(92584),i(66196)),_=i(4024),f=i(27440),v=i(85432),p=i(43516),w=i(61504),b=(i(11376),i(38744)),C=i(5100),D=i(66368),L=i(43236),S=i(5872),y=i(84512),E=i(4400),N=i(9848),M=i(60200),R=i(93636),x=i(80120),T=i(23600),I=i(96372),O=i(13016),P=i(91188),V=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},W=function(e,t){return function(i,o){t(i,o,e)}},F=function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function d(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,d)}a((o=o.apply(e,t||[])).next())}))};class A{constructor(e,t,i,o){this.originalLineStart=e,this.originalLineEnd=t,this.modifiedLineStart=i,this.modifiedLineEnd=o}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class k{constructor(e){this.entries=e}}const H=(0,T._n)("diff-review-insert",h.C.add,b.uy("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),B=(0,T._n)("diff-review-remove",h.C.remove,b.uy("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),U=(0,T._n)("diff-review-close",h.C.close,b.uy("diffReviewCloseIcon","Icon for 'Close' in diff review."));let z=class e extends g.CC{constructor(e,t,i,o){super(),this._languageService=t,this._audioCueService=i,this._configurationService=o,this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=(0,r.K)(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=(0,r.K)(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new C.g(this.actionBarContainer.domNode)),this._actionBar.push(new L.So("diffreview.close",b.uy("label.close","Close"),"close-diff-review "+x.g.asClassName(U),!0,(()=>F(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=(0,r.K)(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=(0,r.K)(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new D.yw(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(e.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(n.IB(this.domNode.domNode,"click",(e=>{e.preventDefault();const t=n.So(e.target,"diff-review-row");t&&this._goToRow(t)}))),this._register(n.IB(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow(),"next")),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow(),"previous")),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033)||e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("accessibility.verbosity.diff-editor")&&this._diffEditor.updateOptions({accessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.diff-editor")})}))),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let t=-1;for(let e=0,i=this._diffs.length;e<i;e++)if(this._diffs[e]===this._currentDiff){t=e;break}e=this._diffs.length+t-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new E.J(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getPrevRow(),"previous")}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let t=-1;for(let e=0,i=this._diffs.length;e<i;e++)if(this._diffs[e]===this._currentDiff){t=e;break}e=t+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new E.J(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow(),"next")}accept(){let e=-1;const t=this._getCurrentFocusedRow();if(t){const i=parseInt(t.getAttribute("data-line"),10);isNaN(i)||(e=i)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new E.J(e,1)),this._diffEditor.revealPosition(new E.J(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){const e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e,t){const i=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),i&&i!==e&&(i.tabIndex=-1);const o=t?"next"===t?null==i?void 0:i.nextElementSibling:null==i?void 0:i.previousElementSibling:i;(null==o?void 0:o.classList.contains("line-insert"))?this._audioCueService.playAudioCue(O.Oi.diffLineInserted,!0):(null==o?void 0:o.classList.contains("line-delete"))&&this._audioCueService.playAudioCue(O.Oi.diffLineDeleted,!0),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,t,i){this._width=t,this.shadow.setTop(e-6),this.shadow.setWidth(t),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(t),this.domNode.setHeight(i),this._content.setHeight(i),this._content.setWidth(t),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const t=this._diffEditor.getLineChanges();if(!t||0===t.length)return[];const i=this._diffEditor.getOriginalEditor().getModel(),o=this._diffEditor.getModifiedEditor().getModel();return i&&o?e._mergeAdjacent(t,i.getLineCount(),o.getLineCount()):[]}static _mergeAdjacent(e,t,i){if(!e||0===e.length)return[];const o=[];let n=0;for(let r=0,s=e.length;r<s;r++){const d=e[r],a=d.originalStartLineNumber,l=d.originalEndLineNumber,h=d.modifiedStartLineNumber,c=d.modifiedEndLineNumber,u=[];let g=0;{const t=0===l?a:a-1,i=0===c?h:h-1;let o=1,n=1;if(r>0){const t=e[r-1];o=0===t.originalEndLineNumber?t.originalStartLineNumber+1:t.originalEndLineNumber+1,n=0===t.modifiedEndLineNumber?t.modifiedStartLineNumber+1:t.modifiedEndLineNumber+1}let s=t-3+1,d=i-3+1;if(s<o){const e=o-s;s+=e,d+=e}if(d<n){const e=n-d;s+=e,d+=e}u[g++]=new A(s,t,d,i)}0!==l&&(u[g++]=new A(a,l,0,0)),0!==c&&(u[g++]=new A(0,0,h,c));{const o=0===l?a+1:l+1,n=0===c?h+1:c+1;let d=t,m=i;if(r+1<s){const t=e[r+1];d=0===t.originalEndLineNumber?t.originalStartLineNumber:t.originalStartLineNumber-1,m=0===t.modifiedEndLineNumber?t.modifiedStartLineNumber:t.modifiedStartLineNumber-1}let _=o+3-1,f=n+3-1;if(_>d){const e=d-_;_+=e,f+=e}if(f>m){const e=m-f;_+=e,f+=e}u[g++]=new A(o,_,n,f)}o[n++]=new k(u)}let r=o[0].entries;const s=[];let d=0;for(let e=1,t=o.length;e<t;e++){const t=o[e].entries,i=r[r.length-1],n=t[0];0===i.getType()&&0===n.getType()&&n.originalLineStart<=i.originalLineEnd?(r[r.length-1]=new A(i.originalLineStart,n.originalLineEnd,i.modifiedLineStart,n.modifiedLineEnd),r=r.concat(t.slice(1))):(s[d++]=new k(r),r=t)}return s[d++]=new k(r),s}_findDiffIndex(e){const t=e.lineNumber;for(let e=0,i=this._diffs.length;e<i;e++){const i=this._diffs[e].entries;if(t<=i[i.length-1].modifiedLineEnd)return e}return 0}_render(){const t=this._diffEditor.getOriginalEditor().getOptions(),i=this._diffEditor.getModifiedEditor().getOptions(),o=this._diffEditor.getOriginalEditor().getModel(),r=this._diffEditor.getModifiedEditor().getModel(),s=o.getOptions(),d=r.getOptions();if(!this._isVisible||!o||!r)return n.Wc(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const a=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[a]===this._currentDiff)return;this._currentDiff=this._diffs[a];const l=this._diffs[a].entries,h=document.createElement("div");h.className="diff-review-table",h.setAttribute("role","list"),h.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),(0,m.K)(h,i.get(48));let c=0,u=0,g=0,_=0;for(let e=0,t=l.length;e<t;e++){const t=l[e],i=t.originalLineStart,o=t.originalLineEnd,n=t.modifiedLineStart,r=t.modifiedLineEnd;0!==i&&(0===c||i<c)&&(c=i),0!==o&&(0===u||o>u)&&(u=o),0!==n&&(0===g||n<g)&&(g=n),0!==r&&(0===_||r>_)&&(_=r)}const f=document.createElement("div");f.className="diff-review-row";const v=document.createElement("div");v.className="diff-review-cell diff-review-summary";const p=u-c+1,w=_-g+1;v.appendChild(document.createTextNode(`${a+1}/${this._diffs.length}: @@ -${c},${p} +${g},${w} @@`)),f.setAttribute("data-line",String(g));const C=e=>0===e?b.uy("no_lines_changed","no lines changed"):1===e?b.uy("one_line_changed","1 line changed"):b.uy("more_lines_changed","{0} lines changed",e),D=C(p),L=C(w);f.setAttribute("aria-label",b.uy({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",a+1,this._diffs.length,c,D,g,L)),f.appendChild(v),f.setAttribute("role","listitem"),h.appendChild(f);const S=i.get(64);let y=g;for(let n=0,a=l.length;n<a;n++){const a=l[n];e._renderSection(h,a,y,S,this._width,t,o,s,i,r,d,this._languageService.languageIdCodec),0!==a.modifiedLineStart&&(y=a.modifiedLineEnd)}n.Wc(this._content.domNode),this._content.domNode.appendChild(h),this.scrollbar.scanDomNode()}static _renderSection(t,i,o,n,r,s,d,a,l,h,c,u){const g=i.getType();let m="diff-review-row",_="";let f=null;switch(g){case 1:m="diff-review-row line-insert",_=" char-insert",f=H;break;case 2:m="diff-review-row line-delete",_=" char-delete",f=B}const v=i.originalLineStart,p=i.originalLineEnd,w=i.modifiedLineStart,C=i.modifiedLineEnd,D=Math.max(C-w,p-v),L=s.get(139),S=L.glyphMarginWidth+L.lineNumbersWidth,y=l.get(139),E=10+y.glyphMarginWidth+y.lineNumbersWidth;for(let i=0;i<=D;i++){const p=0===v?0:v+i,C=0===w?0:w+i,D=document.createElement("div");D.style.minWidth=r+"px",D.className=m,D.setAttribute("role","listitem"),0!==C&&(o=C),D.setAttribute("data-line",String(o));const L=document.createElement("div");L.className="diff-review-cell",L.style.height=`${n}px`,D.appendChild(L);const y=document.createElement("span");y.style.width=S+"px",y.style.minWidth=S+"px",y.className="diff-review-line-number"+_,0!==p?y.appendChild(document.createTextNode(String(p))):y.innerText=" ",L.appendChild(y);const N=document.createElement("span");N.style.width=E+"px",N.style.minWidth=E+"px",N.style.paddingRight="10px",N.className="diff-review-line-number"+_,0!==C?N.appendChild(document.createTextNode(String(C))):N.innerText=" ",L.appendChild(N);const M=document.createElement("span");if(M.className="diff-review-spacer",f){const e=document.createElement("span");e.className=x.g.asClassName(f),e.innerText="  ",M.appendChild(e)}else M.innerText="  ";let R;if(L.appendChild(M),0!==C){let t=this._renderLine(h,l,c.tabSize,C,u);e._ttPolicy&&(t=e._ttPolicy.createHTML(t)),L.insertAdjacentHTML("beforeend",t),R=h.getLineContent(C)}else{let t=this._renderLine(d,s,a.tabSize,p,u);e._ttPolicy&&(t=e._ttPolicy.createHTML(t)),L.insertAdjacentHTML("beforeend",t),R=d.getLineContent(p)}0===R.length&&(R=b.uy("blankLine","blank"));let T="";switch(g){case 0:T=p===C?b.uy({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",R,p):b.uy("equalLine","{0} original line {1} modified line {2}",R,p,C);break;case 1:T=b.uy("insertLine","+ {0} modified line {1}",R,C);break;case 2:T=b.uy("deleteLine","- {0} original line {1}",R,p)}D.setAttribute("aria-label",T),t.appendChild(D)}}static _renderLine(e,t,i,o,n){const r=e.getLineContent(o),s=t.get(48),d=y.U.createEmpty(r,n),a=M.GS.isBasicASCII(r,e.mightContainNonBasicASCII()),l=M.GS.containsRTL(r,a,e.mightContainRTL());return(0,N.AS)(new N.SQ(s.isMonospace&&!t.get(31),s.canUseHalfwidthRightwardsArrow,r,!1,a,l,0,d,[],i,0,s.spaceWidth,s.middotWidth,s.wsmiddotWidth,t.get(112),t.get(94),t.get(89),t.get(49)!==S.kT.OFF,null)).html}};z._ttPolicy=null===(o=window.trustedTypes)||void 0===o?void 0:o.createPolicy("diffReview",{createHTML:e=>e}),z=V([W(1,I.P),W(2,O.yC),W(3,P.Ci)],z);class K extends f.ay{constructor(){super({id:"editor.action.diffReview.next",label:b.uy("editor.action.diffReview.next","Go to Next Difference"),alias:"Go to Next Difference",precondition:R.cU.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(e,t){const i=Q(e);null==i||i.diffReviewNext()}}class Z extends f.ay{constructor(){super({id:"editor.action.diffReview.prev",label:b.uy("editor.action.diffReview.prev","Go to Previous Difference"),alias:"Go to Previous Difference",precondition:R.cU.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(e,t){const i=Q(e);null==i||i.diffReviewPrev()}}function Q(e){const t=e.get(v.i),i=t.listDiffEditors(),o=t.getActiveCodeEditor();if(!o)return null;for(let e=0,t=i.length;e<t;e++){const t=i[e];if(t.getModifiedEditor().getId()===o.getId()||t.getOriginalEditor().getId()===o.getId())return t}return null}(0,f.K_)(K),(0,f.K_)(Z);var q=i(90836),j=function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function d(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,d)}a((o=o.apply(e,t||[])).next())}))};class $ extends g.CC{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,o,r,s){super(),this._viewZoneId=e,this._marginDomNode=t,this.editor=i,this.diff=o,this._contextMenuService=r,this._clipboardService=s,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=x.g.asClassName(h.C.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=i.getOption(64),a=i.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);const l=[],c=0===o.modifiedEndLineNumber;l.push(new L.So("diff.clipboard.copyDeletedContent",c?o.originalEndLineNumber>o.modifiedStartLineNumber?b.uy("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):b.uy("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.originalEndLineNumber>o.modifiedStartLineNumber?b.uy("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):b.uy("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>j(this,void 0,void 0,(function*(){const e=new q.E(o.originalStartLineNumber,1,o.originalEndLineNumber+1,1),t=o.originalModel.getValueInRange(e);yield this._clipboardService.writeText(t)})))));let u,g=0;o.originalEndLineNumber>o.modifiedStartLineNumber&&(u=new L.So("diff.clipboard.copyDeletedLineContent",c?b.uy("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalStartLineNumber):b.uy("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalStartLineNumber),void 0,!0,(()=>j(this,void 0,void 0,(function*(){const e=o.originalModel.getLineContent(o.originalStartLineNumber+g);if(""===e){const e=o.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(0===e?"\n":"\r\n")}else yield this._clipboardService.writeText(e)})))),l.push(u));i.getOption(87)||l.push(new L.So("diff.inline.revertChange",b.uy("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>j(this,void 0,void 0,(function*(){const e=new q.E(o.originalStartLineNumber,1,o.originalEndLineNumber,o.originalModel.getLineMaxColumn(o.originalEndLineNumber)),t=o.originalModel.getValueInRange(e);if(0===o.modifiedEndLineNumber){const e=i.getModel().getLineMaxColumn(o.modifiedStartLineNumber);i.executeEdits("diffEditor",[{range:new q.E(o.modifiedStartLineNumber,e,o.modifiedStartLineNumber,e),text:a+t}])}else{const e=i.getModel().getLineMaxColumn(o.modifiedEndLineNumber);i.executeEdits("diffEditor",[{range:new q.E(o.modifiedStartLineNumber,1,o.modifiedEndLineNumber,e),text:t}])}})))));const m=(e,t)=>{this._contextMenuService.showContextMenu({getAnchor:()=>({x:e,y:t}),getActions:()=>(u&&(u.label=c?b.uy("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalStartLineNumber+g):b.uy("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalStartLineNumber+g)),l),autoSelectFirstItem:!0})};this._register(n.IB(this._diffActions,"mousedown",(e=>{const{top:t,height:i}=n.HT(this._diffActions),o=Math.floor(d/3);e.preventDefault(),m(e.posx,t+i+o)}))),this._register(i.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){e.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,g=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,d)):this.visibility=!1}else this.visibility=!1}))),this._register(i.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){e.target.detail.viewZoneId===this._viewZoneId&&(e.event.preventDefault(),g=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,d),m(e.event.posx,e.event.posy+d))}})))}_updateLightBulbPosition(e,t,i){const{top:o}=n.HT(e),r=t-o,s=Math.floor(r/i),d=s*i;if(this._diffActions.style.top=`${d}px`,this.diff.viewLineCounts){let e=0;for(let t=0;t<this.diff.viewLineCounts.length;t++)if(e+=this.diff.viewLineCounts[t],s<e)return t}return s}}var G=i(30096),J=i(8368),X=i(38356),Y=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},ee=function(e,t){return function(i,o){t(i,o,e)}},te=function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function d(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,d)}a((o=o.apply(e,t||[])).next())}))};let ie=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new u.sl,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;null===(e=this.diffAlgorithmOnDidChangeSubscription)||void 0===e||e.dispose()}computeDiff(e,t,i){var o;return te(this,void 0,void 0,(function*(){if("string"!=typeof this.diffAlgorithm)return this.diffAlgorithm.computeDiff(e,t,i);const n=G.U.create(!0),r=yield this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),s=n.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:s,timedOut:null===(o=null==r?void 0:r.quitEarly)||void 0===o||o}),!r)throw new Error("no diff result available");return r}))}setOptions(e){var t;let i=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(null===(t=this.diffAlgorithmOnDidChangeSubscription)||void 0===t||t.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,"string"!=typeof e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange((()=>this.onDidChangeEventEmitter.fire()))),i=!0),i&&this.onDidChangeEventEmitter.fire()}};ie=Y([ee(1,J.g),ee(2,X.L)],ie);var oe,ne=i(41852),re=i(93428),se=i(33568),de=i(57968),ae=i(94656),le=i(17400),he=i(72716),ce=i(34572),ue=i(10772),ge=i(41972),me=i(77483),_e=i(76),fe=i(68992),ve=i(50580),pe=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},we=function(e,t){return function(i,o){t(i,o,e)}};class be{constructor(e,t){this._contextMenuService=e,this._clipboardService=t,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter((e=>!this._zonesMap[String(e.id)]))}clean(e){this._zones.length>0&&e.changeViewZones((e=>{for(const t of this._zones)e.removeZone(t)})),this._zones=[],this._zonesMap={},e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,[])}))}apply(e,t,i,o){const n=o?p.O.capture(e):null;e.changeViewZones((t=>{var o;for(const e of this._zones)t.removeZone(e);for(const e of this._inlineDiffMargins)e.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let n=0,r=i.zones.length;n<r;n++){const r=i.zones[n];r.suppressMouseDown=!0;const s=t.addZone(r);this._zones.push(s),this._zonesMap[String(s)]=!0,i.zones[n].diff&&r.marginDomNode&&(r.suppressMouseDown=!1,0!==(null===(o=i.zones[n].diff)||void 0===o?void 0:o.originalModel.getValueLength())&&this._inlineDiffMargins.push(new $(s,r.marginDomNode,e,i.zones[n].diff,this._contextMenuService,this._clipboardService)))}})),null==n||n.restore(e),e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,i.decorations)})),null==t||t.setZones(i.overviewZones)}}let Ce=0;const De=(0,T._n)("diff-insert",h.C.add,b.uy("diffInsertIcon","Line decoration for inserts in the diff editor.")),Le=(0,T._n)("diff-remove",h.C.remove,b.uy("diffRemoveIcon","Line decoration for removals in the diff editor.")),Se=null===(oe=window.trustedTypes)||void 0===oe?void 0:oe.createPolicy("diffEditorWidget",{createHTML:e=>e}),ye=b.uy("diff-aria-navigation-tip"," use Shift + F7 to navigate changes");let Ee=class e extends g.CC{constructor(t,i,o,s,d,a,h,g,m,v,p){super(),this._editorProgressService=p,this._onDidDispose=this._register(new u.sl),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModel=this._register(new u.sl),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidUpdateDiff=this._register(new u.sl),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new u.sl),this._lastOriginalWarning=null,this._lastModifiedWarning=null,h.willCreateDiffEditor(),this._documentDiffProvider=this._register(a.createInstance(ie,i)),this._register(this._documentDiffProvider.onDidChange((e=>this._beginUpdateDecorationsSoon()))),this._codeEditorService=h,this._contextKeyService=this._register(d.createScoped(t)),this._instantiationService=a.createChild(new ue.M([R.KK,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=g,this._notificationService=m,this._id=++Ce,this._state=0,this._updatingDiffProgress=null,this._domElement=t,i=i||{},this._options=ze(i,{enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1}),void 0!==i.isInEmbeddedEditor?this._contextKeyService.createKey("isInEmbeddedDiffEditor",i.isInEmbeddedEditor):this._contextKeyService.createKey("isInEmbeddedDiffEditor",!1),this._updateDecorationsRunner=this._register(new l.sR((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=(0,r.K)(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(n.IB(this._overviewDomElement,n.Wi.POINTER_DOWN,(e=>{this._modifiedEditor.delegateVerticalScrollbarPointerDown(e)}))),this._register(n.Wq(this._overviewDomElement,n.Wi.MOUSE_WHEEL,(e=>{this._modifiedEditor.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new be(v,s),this._modifiedEditorState=new be(v,s),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new _.C(this._containerDomElement,i.dimension)),this._register(this._elementSizeObserver.onDidChange((()=>this._onDidContainerSizeChanged()))),i.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(i,o.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(i,o.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=a.createInstance(z,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new Ie(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new Pe(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(g.onDidColorThemeChange((t=>{this._strategy&&this._strategy.applyColors(t)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)})));const w=f.UX.getDiffEditorContributions();for(const e of w)try{this._register(a.createInstance(e.ctor,this))}catch(e){(0,c.eU)(e)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(e,t){let i="monaco-diff-editor monaco-editor-background ";return t&&(i+="side-by-side "),i+=(0,fe.Uh)(e.type),i}_disposeOverviewRulers(){this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose(),this._originalOverviewRuler=null),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose(),this._modifiedOverviewRuler=null)}_createOverviewRulers(){this._options.renderOverviewRuler&&(a.ok(!this._originalOverviewRuler&&!this._modifiedOverviewRuler),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(t,i){const o=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(t),i);this._register(o.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(o.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(o.onDidChangeConfiguration((e=>{o.getModel()&&(e.hasChanged(48)&&this._updateDecorationsRunner.schedule(),e.hasChanged(140)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(o.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(o.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const n=this._contextKeyService.createKey("isInDiffLeftEditor",o.hasWidgetFocus());return this._register(o.onDidFocusEditorWidget((()=>n.set(!0)))),this._register(o.onDidBlurEditorWidget((()=>n.set(!1)))),this._register(o.onDidContentSizeChange((t=>{const i=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,o=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:o,contentWidth:i,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),o}_createRightHandSideEditor(t,i){const o=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(t),i);this._register(o.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(o.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(o.onDidChangeConfiguration((e=>{o.getModel()&&(e.hasChanged(48)&&this._updateDecorationsRunner.schedule(),e.hasChanged(140)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(o.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(o.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(o.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const n=this._contextKeyService.createKey("isInDiffRightEditor",o.hasWidgetFocus());return this._register(o.onDidFocusEditorWidget((()=>n.set(!0)))),this._register(o.onDidBlurEditorWidget((()=>n.set(!1)))),this._register(o.onDidContentSizeChange((t=>{const i=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,o=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:o,contentWidth:i,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),this._register(o.onMouseDown((e=>{var t,i;if(!e.event.rightButton&&e.target.position&&(null===(t=e.target.element)||void 0===t?void 0:t.className.includes("arrow-revert-change"))){const t=e.target.position.lineNumber,o=e.target,n=null===(i=this._diffComputationResult)||void 0===i?void 0:i.changes.find((e=>(null==o?void 0:o.detail.afterLineNumber)===e.modifiedStartLineNumber||e.modifiedEndLineNumber>0&&e.modifiedStartLineNumber===t));return n&&this.revertChange(n),e.event.stopPropagation(),void this._updateDecorations()}}))),o}revertChange(e){const t=this._modifiedEditor,i=this._originalEditor.getModel(),o=this._modifiedEditor.getModel();if(!i||!o||!t)return;const n=e.originalEndLineNumber>0?new q.E(e.originalStartLineNumber,1,e.originalEndLineNumber,i.getLineMaxColumn(e.originalEndLineNumber)):null,r=n?i.getValueInRange(n):null,s=e.modifiedEndLineNumber>0?new q.E(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,o.getLineMaxColumn(e.modifiedEndLineNumber)):null,d=o.getEOL();if(0===e.originalEndLineNumber&&s){let i=s;e.modifiedStartLineNumber>1?i=s.setStartPosition(e.modifiedStartLineNumber-1,o.getLineMaxColumn(e.modifiedStartLineNumber-1)):e.modifiedEndLineNumber<o.getLineCount()&&(i=s.setEndPosition(e.modifiedEndLineNumber+1,1)),t.executeEdits("diffEditor",[{range:i,text:""}])}else if(0===e.modifiedEndLineNumber&&null!==r){const i=e.modifiedStartLineNumber<o.getLineCount()?new E.J(e.modifiedStartLineNumber+1,1):new E.J(e.modifiedStartLineNumber,o.getLineMaxColumn(e.modifiedStartLineNumber));t.executeEdits("diffEditor",[{range:q.E.fromPositions(i,i),text:e.modifiedStartLineNumber<o.getLineCount()?r+d:d+r}])}else s&&null!==r&&t.executeEdits("diffEditor",[{range:s,text:r}])}_createInnerEditor(e,t,i,o){return e.createInstance(w.qU,t,i,o)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return re.a.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(t){const i=ze(t,this._options),o=(n=this._options,r=i,{enableSplitViewResizing:n.enableSplitViewResizing!==r.enableSplitViewResizing,renderSideBySide:n.renderSideBySide!==r.renderSideBySide,renderMarginRevertIcon:n.renderMarginRevertIcon!==r.renderMarginRevertIcon,maxComputationTime:n.maxComputationTime!==r.maxComputationTime,maxFileSize:n.maxFileSize!==r.maxFileSize,ignoreTrimWhitespace:n.ignoreTrimWhitespace!==r.ignoreTrimWhitespace,renderIndicators:n.renderIndicators!==r.renderIndicators,originalEditable:n.originalEditable!==r.originalEditable,diffCodeLens:n.diffCodeLens!==r.diffCodeLens,renderOverviewRuler:n.renderOverviewRuler!==r.renderOverviewRuler,diffWordWrap:n.diffWordWrap!==r.diffWordWrap,diffAlgorithm:n.diffAlgorithm!==r.diffAlgorithm,accessibilityVerbose:n.accessibilityVerbose!==r.accessibilityVerbose});var n,r;this._options=i;const s=o.ignoreTrimWhitespace||o.renderIndicators||o.renderMarginRevertIcon,d=this._isVisible&&(o.maxComputationTime||o.maxFileSize);this._documentDiffProvider.setOptions(i),s?this._beginUpdateDecorations():d&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(t)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(t)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio),o.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new Ie(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new Pe(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),o.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(e){if(e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._disposeOverviewRulers(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._createOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport(),this._onDidChangeModel.fire()}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e,t="api"){this._modifiedEditor.setPosition(e,t)}revealLine(e,t=0){this._modifiedEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._modifiedEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._modifiedEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._modifiedEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._modifiedEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._modifiedEditor.revealPositionNearTop(e,t)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e,t="api"){this._modifiedEditor.setSelection(e,t)}setSelections(e,t="api"){this._modifiedEditor.setSelections(e,t)}revealLines(e,t,i=0){this._modifiedEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._modifiedEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._modifiedEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,o=!0){this._modifiedEditor.revealRange(e,t,i,o)}revealRangeInCenter(e,t=0){this._modifiedEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._modifiedEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._modifiedEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}saveViewState(){return{original:this._originalEditor.saveViewState(),modified:this._modifiedEditor.saveViewState()}}restoreViewState(e){if(e&&e.original&&e.modified){const t=e;this._originalEditor.restoreViewState(t.original),this._modifiedEditor.restoreViewState(t.modified)}}layout(e){this._elementSizeObserver.observe(e)}focus(){this._modifiedEditor.focus()}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}trigger(e,t,i){this._modifiedEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._modifiedEditor.createDecorationsCollection(e)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const t=this._elementSizeObserver.getHeight(),i=this._getReviewHeight(),o=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:e.ONE_OVERVIEW_WIDTH,right:o+e.ONE_OVERVIEW_WIDTH,height:t-i}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:e.ONE_OVERVIEW_WIDTH,height:t-i}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),e.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,t){return!e&&!t||!(!e||!t)&&e.toString()===t.toString()}_beginUpdateDecorations(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1);const t=this._originalEditor.getModel(),i=this._modifiedEditor.getModel();if(!t||!i)return;this._diffComputationToken++;const o=this._diffComputationToken,n=1024*this._options.maxFileSize*1024,r=e=>{const t=e.getValueLength();return 0===n||t<=n};r(t)&&r(i)?(this._setState(1),this._documentDiffProvider.computeDiff(t,i,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace,maxComputationTimeMs:this._options.maxComputationTime}).then((e=>{o===this._diffComputationToken&&t===this._originalEditor.getModel()&&i===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult={identical:e.identical,quitEarly:e.quitEarly,changes2:e.changes,changes:e.changes.map((e=>{let t,i,o,n,r=e.innerChanges;return e.originalRange.isEmpty?(t=e.originalRange.startLineNumber-1,i=0,r=void 0):(t=e.originalRange.startLineNumber,i=e.originalRange.endLineNumberExclusive-1),e.modifiedRange.isEmpty?(o=e.modifiedRange.startLineNumber-1,n=0,r=void 0):(o=e.modifiedRange.startLineNumber,n=e.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:t,originalEndLineNumber:i,modifiedStartLineNumber:o,modifiedEndLineNumber:n,charChanges:null==r?void 0:r.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))},this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(e=>{o===this._diffComputationToken&&t===this._originalEditor.getModel()&&i===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())}))):e._equals(t.uri,this._lastOriginalWarning)&&e._equals(i.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=t.uri,this._lastModifiedWarning=i.uri,this._notificationService.warn(b.uy("diff.tooLarge","Cannot compare files because one file is too large.")))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],t=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),i=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),o=this._options.renderMarginRevertIcon&&!this._modifiedEditor.getOption(87),n=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,o,t,i);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,n.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,n.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const t=Object.assign({},e);return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens,t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,t}_adjustOptionsForLeftHandSide(e){const t=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?t.wordWrapOverride1=this._options.diffWordWrap:(t.wordWrapOverride1="off",t.wordWrapOverride2="off"),e.originalAriaLabel&&(t.ariaLabel=e.originalAriaLabel),this._updateAriaLabel(t),t.readOnly=!this._options.originalEditable,t.dropIntoEditor={enabled:!t.readOnly},t.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}_updateAriaLabel(e){let t=e.ariaLabel;this._options.accessibilityVerbose?t+=ye:t&&(t=t.replaceAll(ye,"")),e.ariaLabel=t}_adjustOptionsForRightHandSide(t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),this._updateAriaLabel(i),i.wordWrapOverride1=this._options.diffWordWrap,i.revealHorizontalRightPadding=S.I9.revealHorizontalRightPadding.defaultValue+e.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const t=this._elementSizeObserver.getWidth(),i=this._elementSizeObserver.getHeight(),o=this._getReviewHeight(),n=this._strategy.layout();this._originalDomNode.style.width=n+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=t-n+"px",this._modifiedDomNode.style.left=n+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=i-o+"px",this._overviewDomElement.style.width=e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=t-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:n,height:i-o}),this._modifiedEditor.layout({width:t-n-(this._options.renderOverviewRuler?e.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:i-o}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(i-o,t,o),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const t=this._modifiedEditor.getScrollTop(),i=this._modifiedEditor.getScrollHeight(),o=Math.max(0,e.height),n=Math.max(0,o-0),r=i>0?n/i:0;return{height:Math.max(0,Math.floor(e.height*r)),top:Math.floor(t*r)}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){var t;null===(t=this._strategy)||void 0===t||t.dispose(),this._strategy=e,this._boundarySashes&&e.setBoundarySashes(this._boundarySashes),e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(e,t){const i=this._diffComputationResult?this._diffComputationResult.changes:[];if(0===i.length||e<t(i[0]))return null;let o=0,n=i.length-1;for(;o<n;){const r=Math.floor((o+n)/2),s=t(i[r]),d=r+1<=n?t(i[r+1]):1073741824;e<s?n=r-1:e>=d?o=r+1:(o=r,n=r)}return i[o]}_getEquivalentLineForOriginalLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.originalStartLineNumber));if(!t)return e;const i=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),o=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),n=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,r=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,s=e-i;return s<=n?o+Math.min(s,r):o+r-n+s}_getEquivalentLineForModifiedLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.modifiedStartLineNumber));if(!t)return e;const i=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),o=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),n=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,r=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,s=e-o;return s<=r?i+Math.min(s,n):i+n-r+s}getDiffLineInformationForOriginal(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(e)}:null}getDiffLineInformationForModified(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(e)}:null}};Ee.ONE_OVERVIEW_WIDTH=15,Ee.ENTIRE_DIFF_OVERVIEW_WIDTH=30,Ee.UPDATE_DIFF_DECORATIONS_DELAY=200,Ee=pe([we(3,le.i),we(4,R.KK),we(5,ce.U9),we(6,v.i),we(7,fe.q0),we(8,ge.sx),we(9,he.A),we(10,me.qA)],Ee);class Ne extends g.CC{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const t=e.getColor(_e.kBR)||(e.getColor(_e.yqy)||_e.MVX).transparent(2),i=e.getColor(_e.C8e)||(e.getColor(_e.gvt)||_e.MhI).transparent(2),o=!t.equals(this._insertColor)||!i.equals(this._removeColor);return this._insertColor=t,this._removeColor=i,o}getEditorsDiffDecorations(e,t,i,o,n,r){r=r.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber)),n=n.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber));const s=this._getViewZones(e,n,r,i),d=this._getOriginalEditorDecorations(s,e,t,i),a=this._getModifiedEditorDecorations(s,e,t,i,o);return{original:{decorations:d.decorations,overviewZones:d.overviewZones,zones:s.original},modified:{decorations:a.decorations,overviewZones:a.overviewZones,zones:s.modified}}}setBoundarySashes(e){}}class Me{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class Re{constructor(e,t,i,o,n){this._lineChanges=e,this._originalForeignVZ=t,this._modifiedForeignVZ=i,this._originalEditor=o,this._modifiedEditor=n}static _getViewLineCount(e,t,i){const o=e.getModel(),n=e._getViewModel();if(o&&n){const e=Ue(o,n,t,i);return e.endLineNumber-e.startLineNumber+1}return i-t+1}getViewZones(){const e=this._originalEditor.getOption(64),t=this._modifiedEditor.getOption(64),i=-1!==this._originalEditor.getOption(140).wrappingColumn,o=-1!==this._modifiedEditor.getOption(140).wrappingColumn,n=i||o,r=this._originalEditor.getModel(),s=this._originalEditor._getViewModel().coordinatesConverter,d=this._modifiedEditor._getViewModel().coordinatesConverter,a=[],l=[];let h=0,c=0,u=0,g=0,m=0,_=0;const f=(e,t)=>e.afterLineNumber-t.afterLineNumber,v=(e,t)=>{if(null===t.domNode&&e.length>0){const i=e[e.length-1];if(i.afterLineNumber===t.afterLineNumber&&null===i.domNode)return void(i.heightInLines+=t.heightInLines)}e.push(t)},p=new Me(this._modifiedForeignVZ),w=new Me(this._originalForeignVZ);let b=1,C=1;for(let i=0,o=this._lineChanges.length;i<=o;i++){const D=i<o?this._lineChanges[i]:null;null!==D?(u=D.originalStartLineNumber+(D.originalEndLineNumber>0?-1:0),g=D.modifiedStartLineNumber+(D.modifiedEndLineNumber>0?-1:0),c=D.originalEndLineNumber>0?Re._getViewLineCount(this._originalEditor,D.originalStartLineNumber,D.originalEndLineNumber):0,h=D.modifiedEndLineNumber>0?Re._getViewLineCount(this._modifiedEditor,D.modifiedStartLineNumber,D.modifiedEndLineNumber):0,m=Math.max(D.originalStartLineNumber,D.originalEndLineNumber),_=Math.max(D.modifiedStartLineNumber,D.modifiedEndLineNumber)):(u+=1e7+c,g+=1e7+h,m=u,_=g);let L=[],S=[];if(n){let e;e=D?D.originalEndLineNumber>0?D.originalStartLineNumber-b:D.modifiedStartLineNumber-C:r.getLineCount()-b+1;for(let t=0;t<e;t++){const e=b+t,i=C+t,o=s.getModelLineViewLineCount(e),n=d.getModelLineViewLineCount(i);o<n?L.push({afterLineNumber:e,heightInLines:n-o,domNode:null,marginDomNode:null}):o>n&&S.push({afterLineNumber:i,heightInLines:o-n,domNode:null,marginDomNode:null})}D&&(b=(D.originalEndLineNumber>0?D.originalEndLineNumber:D.originalStartLineNumber)+1,C=(D.modifiedEndLineNumber>0?D.modifiedEndLineNumber:D.modifiedStartLineNumber)+1)}for(;p.current&&p.current.afterLineNumber<=_;){let e;e=p.current.afterLineNumber<=g?u-g+p.current.afterLineNumber:m;let i=null;D&&D.modifiedStartLineNumber<=p.current.afterLineNumber&&p.current.afterLineNumber<=D.modifiedEndLineNumber&&(i=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),L.push({afterLineNumber:e,heightInLines:p.current.height/t,domNode:null,marginDomNode:i}),p.advance()}for(;w.current&&w.current.afterLineNumber<=m;){let t;t=w.current.afterLineNumber<=u?g-u+w.current.afterLineNumber:_,S.push({afterLineNumber:t,heightInLines:w.current.height/e,domNode:null}),w.advance()}if(null!==D&&We(D)){const e=this._produceOriginalFromDiff(D,c,h);e&&L.push(e)}if(null!==D&&Fe(D)){const e=this._produceModifiedFromDiff(D,c,h);e&&S.push(e)}let y=0,E=0;for(L=L.sort(f),S=S.sort(f);y<L.length&&E<S.length;){const e=L[y],t=S[E],i=e.afterLineNumber-u,o=t.afterLineNumber-g;i<o?(v(a,e),y++):o<i?(v(l,t),E++):e.shouldNotShrink?(v(a,e),y++):t.shouldNotShrink?(v(l,t),E++):e.heightInLines>=t.heightInLines?(e.heightInLines-=t.heightInLines,E++):(t.heightInLines-=e.heightInLines,y++)}for(;y<L.length;)v(a,L[y]),y++;for(;E<S.length;)v(l,S[E]),E++}return{original:Re._ensureDomNodes(a),modified:Re._ensureDomNodes(l)}}static _ensureDomNodes(e){return e.map((e=>(e.domNode||(e.domNode=He()),e)))}}function xe(e,t,i,o,n){return{range:new q.E(e,t,i,o),options:n}}const Te={arrowRevertChange:se.uw.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new ve.qE(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(b.uy("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+x.g.asClassName(h.C.arrowRight),zIndex:10001}),charDelete:se.uw.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:se.uw.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:se.uw.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:se.uw.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:se.uw.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:se.uw.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+x.g.asClassName(De),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:se.uw.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:se.uw.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+x.g.asClassName(Le),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:se.uw.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class Ie extends Ne{constructor(e,t,i){super(e),this._disableSash=!1===t,this._defaultRatio=i,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new d.k(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(e,t){this._defaultRatio=t;const i=!1===e;this._disableSash!==i&&(this._disableSash=i,this._sash.state=this._disableSash?0:3)}layout(e=this._sashRatio||this._defaultRatio){const t=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Ee.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let i=Math.floor((e||this._defaultRatio)*t);const o=Math.floor(this._defaultRatio*t);return i=this._disableSash?o:i||o,t>2*Ie.MINIMUM_EDITOR_WIDTH?(i<Ie.MINIMUM_EDITOR_WIDTH&&(i=Ie.MINIMUM_EDITOR_WIDTH),i>t-Ie.MINIMUM_EDITOR_WIDTH&&(i=t-Ie.MINIMUM_EDITOR_WIDTH)):i=o,this._sashPosition!==i&&(this._sashPosition=i),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const t=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Ee.ENTIRE_DIFF_OVERVIEW_WIDTH:0),i=this.layout((this._startSashPosition+(e.currentX-e.startX))/t);this._sashRatio=i/t,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=this._defaultRatio,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_getViewZones(e,t,i){const o=this._dataSource.getOriginalEditor(),n=this._dataSource.getModifiedEditor();return new Oe(e,t,i,o,n).getViewZones()}_getOriginalEditorDecorations(e,t,i,o){const n=this._dataSource.getOriginalEditor(),r=String(this._removeColor),s={decorations:[],overviewZones:[]},d=n.getModel(),a=n._getViewModel();for(const e of t)if(Fe(e)){s.decorations.push({range:new q.E(e.originalStartLineNumber,1,e.originalEndLineNumber,1073741824),options:o?Te.lineDeleteWithSign:Te.lineDelete}),We(e)&&e.charChanges||s.decorations.push(xe(e.originalStartLineNumber,1,e.originalEndLineNumber,1073741824,Te.charDeleteWholeLine));const t=Ue(d,a,e.originalStartLineNumber,e.originalEndLineNumber);if(s.overviewZones.push(new ae.WW(t.startLineNumber,t.endLineNumber,0,r)),e.charChanges)for(const t of e.charChanges)if(ke(t))if(i)for(let e=t.originalStartLineNumber;e<=t.originalEndLineNumber;e++){let i,o;i=e===t.originalStartLineNumber?t.originalStartColumn:d.getLineFirstNonWhitespaceColumn(e),o=e===t.originalEndLineNumber?t.originalEndColumn:d.getLineLastNonWhitespaceColumn(e),s.decorations.push(xe(e,i,e,o,Te.charDelete))}else s.decorations.push(xe(t.originalStartLineNumber,t.originalStartColumn,t.originalEndLineNumber,t.originalEndColumn,Te.charDelete))}return s}_getModifiedEditorDecorations(e,t,i,o,n){const r=this._dataSource.getModifiedEditor(),s=String(this._insertColor),d={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const r of t){if(n)if(r.modifiedEndLineNumber>0)d.decorations.push({range:new q.E(r.modifiedStartLineNumber,1,r.modifiedStartLineNumber,1),options:Te.arrowRevertChange});else{const t=e.modified.find((e=>e.afterLineNumber===r.modifiedStartLineNumber));t&&(t.marginDomNode=Be())}if(We(r)){d.decorations.push({range:new q.E(r.modifiedStartLineNumber,1,r.modifiedEndLineNumber,1073741824),options:o?Te.lineInsertWithSign:Te.lineInsert}),Fe(r)&&r.charChanges||d.decorations.push(xe(r.modifiedStartLineNumber,1,r.modifiedEndLineNumber,1073741824,Te.charInsertWholeLine));const e=Ue(a,l,r.modifiedStartLineNumber,r.modifiedEndLineNumber);if(d.overviewZones.push(new ae.WW(e.startLineNumber,e.endLineNumber,0,s)),r.charChanges)for(const e of r.charChanges)if(Ae(e))if(i)for(let t=e.modifiedStartLineNumber;t<=e.modifiedEndLineNumber;t++){let i,o;i=t===e.modifiedStartLineNumber?e.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(t),o=t===e.modifiedEndLineNumber?e.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(t),d.decorations.push(xe(t,i,t,o,Te.charInsert))}else d.decorations.push(xe(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn,Te.charInsert))}}return d}}Ie.MINIMUM_EDITOR_WIDTH=100;class Oe extends Re{constructor(e,t,i,o,n){super(e,t,i,o,n)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,t,i){return i>t?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:i-t,domNode:null}:null}_produceModifiedFromDiff(e,t,i){return t>i?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:t-i,domNode:null}:null}}class Pe extends Ne{constructor(e,t){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange((t=>{this._decorationsLeft!==t.decorationsLeft&&(this._decorationsLeft=t.decorationsLeft,e.relayoutEditors())})))}setEnableSplitViewResizing(e){}_getViewZones(e,t,i,o){const n=this._dataSource.getOriginalEditor(),r=this._dataSource.getModifiedEditor();return new Ve(e,t,i,n,r,o).getViewZones()}_getOriginalEditorDecorations(e,t,i,o){const n=String(this._removeColor),r={decorations:[],overviewZones:[]},s=this._dataSource.getOriginalEditor(),d=s.getModel(),a=s._getViewModel();let l=0;for(const i of t)if(Fe(i)){for(r.decorations.push({range:new q.E(i.originalStartLineNumber,1,i.originalEndLineNumber,1073741824),options:Te.lineDeleteMargin});l<e.modified.length;){const t=e.modified[l];if(t.diff&&t.diff.originalStartLineNumber>=i.originalStartLineNumber)break;l++}let t=0;if(l<e.modified.length){const o=e.modified[l];o.diff&&o.diff.originalStartLineNumber===i.originalStartLineNumber&&o.diff.originalEndLineNumber===i.originalEndLineNumber&&o.diff.modifiedStartLineNumber===i.modifiedStartLineNumber&&o.diff.modifiedEndLineNumber===i.modifiedEndLineNumber&&(t=o.heightInLines)}const o=Ue(d,a,i.originalStartLineNumber,i.originalEndLineNumber);r.overviewZones.push(new ae.WW(o.startLineNumber,o.endLineNumber,t,n))}return r}_getModifiedEditorDecorations(e,t,i,o,n){const r=this._dataSource.getModifiedEditor(),s=String(this._insertColor),d={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const e of t)if(We(e)){d.decorations.push({range:new q.E(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,1073741824),options:o?Te.lineInsertWithSign:Te.lineInsert});const t=Ue(a,l,e.modifiedStartLineNumber,e.modifiedEndLineNumber);if(d.overviewZones.push(new ae.WW(t.startLineNumber,t.endLineNumber,0,s)),e.charChanges){for(const t of e.charChanges)if(Ae(t))if(i)for(let e=t.modifiedStartLineNumber;e<=t.modifiedEndLineNumber;e++){let i,o;i=e===t.modifiedStartLineNumber?t.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),o=e===t.modifiedEndLineNumber?t.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),d.decorations.push(xe(e,i,e,o,Te.charInsert))}else d.decorations.push(xe(t.modifiedStartLineNumber,t.modifiedStartColumn,t.modifiedEndLineNumber,t.modifiedEndColumn,Te.charInsert))}else d.decorations.push(xe(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,1073741824,Te.charInsertWholeLine))}return d}layout(){return Math.max(5,this._decorationsLeft)}}class Ve extends Re{constructor(e,t,i,o,n,r){super(e,t,i,o,n),this._originalModel=o.getModel(),this._renderIndicators=r,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,t,i){const o=document.createElement("div");return o.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:i,domNode:document.createElement("div"),marginDomNode:o}}_produceModifiedFromDiff(e,t,i){const o=document.createElement("div");o.className=`view-lines line-delete ${s.A}`;const n=document.createElement("div");n.className="inline-deleted-margin-view-zone";const r={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:t,minWidthInPx:0,domNode:o,marginDomNode:n,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let t=e.originalStartLineNumber;t<=e.originalEndLineNumber;t++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(t),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(r),r}_finalize(e){const t=this._modifiedEditor.getOptions(),i=this._modifiedEditor.getModel().getOptions().tabSize,o=t.get(48),n=t.get(31),r=o.typicalHalfwidthCharacterWidth,s=t.get(99),d=this._originalModel.mightContainNonBasicASCII(),a=this._originalModel.mightContainRTL(),l=t.get(64),h=t.get(139).decorationsWidth,c=t.get(112),u=t.get(94),g=t.get(89),_=t.get(49),f=this._lineBreaksComputer.finalize();let v=0;for(let t=0;t<this._pendingLineChange.length;t++){const p=this._pendingLineChange[t],w=this._pendingViewZones[t],b=w.domNode;(0,m.K)(b,o);const C=w.marginDomNode;(0,m.K)(C,o);const D=[];if(p.charChanges)for(const e of p.charChanges)ke(e)&&D.push(new M.MF(new q.E(e.originalStartLineNumber,e.originalStartColumn,e.originalEndLineNumber,e.originalEndColumn),"char-delete",0));const L=D.length>0,S=new ne.gh(1e4);let y=0,E=0,N=null;for(let t=p.originalStartLineNumber;t<=p.originalEndLineNumber;t++){const r=t-p.originalStartLineNumber,s=this._originalModel.tokenization.getLineTokens(t),m=s.getLineContent(),b=f[v++],M=de.gZ.filter(D,t,1,m.length+1);if(b){let f=0;for(const e of b.breakOffsets){const t=s.sliceAndInflate(f,e,0),r=m.substring(f,e);y=Math.max(y,this._renderOriginalLine(E++,r,t,de.gZ.extractWrapped(M,f,e),L,d,a,o,n,l,h,c,u,g,_,i,S,C)),f=e}for(N||(N=[]);N.length<r;)N[N.length]=1;N[r]=b.breakOffsets.length,w.heightInLines+=b.breakOffsets.length-1;const v=document.createElement("div");v.className="gutter-delete",e.original.push({afterLineNumber:t,afterColumn:0,heightInLines:b.breakOffsets.length-1,domNode:He(),marginDomNode:v})}else y=Math.max(y,this._renderOriginalLine(E++,m,s,M,L,d,a,o,n,l,h,c,u,g,_,i,S,C))}y+=s;const R=S.build(),x=Se?Se.createHTML(R):R;if(b.innerHTML=x,w.minWidthInPx=y*r,N){const e=p.originalEndLineNumber-p.originalStartLineNumber;for(;N.length<=e;)N[N.length]=1}w.diff.viewLineCounts=N}e.original.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber))}_renderOriginalLine(e,t,i,o,n,r,s,d,a,l,h,c,u,g,m,_,f,v){f.appendString('<div class="view-line'),n||f.appendString(" char-delete"),f.appendString('" style="top:'),f.appendString(String(e*l)),f.appendString('px;width:1000000px;">');const p=M.GS.isBasicASCII(t,r),w=M.GS.containsRTL(t,p,s),b=(0,N.y8)(new N.SQ(d.isMonospace&&!a,d.canUseHalfwidthRightwardsArrow,t,!1,p,w,0,i,o,_,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,c,u,g,m!==S.kT.OFF,null),f);if(f.appendString("</div>"),this._renderIndicators){const t=document.createElement("div");t.className=`delete-sign ${x.g.asClassName(Le)}`,t.setAttribute("style",`position:absolute;top:${e*l}px;width:${h}px;height:${l}px;right:0;`),v.appendChild(t)}return b.characterMapping.getHorizontalOffset(b.characterMapping.length)}}function We(e){return e.modifiedEndLineNumber>0}function Fe(e){return e.originalEndLineNumber>0}function Ae(e){return e.modifiedStartLineNumber===e.modifiedEndLineNumber?e.modifiedEndColumn-e.modifiedStartColumn>0:e.modifiedEndLineNumber-e.modifiedStartLineNumber>0}function ke(e){return e.originalStartLineNumber===e.originalEndLineNumber?e.originalEndColumn-e.originalStartColumn>0:e.originalEndLineNumber-e.originalStartLineNumber>0}function He(){const e=document.createElement("div");return e.className="diagonal-fill",e}function Be(){const e=document.createElement("div");return e.className="arrow-revert-change "+x.g.asClassName(h.C.arrowRight),n.$("div",{},e)}function Ue(e,t,i,o){const n=e.getLineCount();return i=Math.min(n,Math.max(1,i)),o=Math.min(n,Math.max(1,o)),t.coordinatesConverter.convertModelRangeToViewRange(new q.E(i,e.getLineMinColumn(i),o,e.getLineMaxColumn(o)))}function ze(e,t){return{enableSplitViewResizing:(0,S.cT)(e.enableSplitViewResizing,t.enableSplitViewResizing),splitViewDefaultRatio:(0,S.EH)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,S.cT)(e.renderSideBySide,t.renderSideBySide),renderMarginRevertIcon:(0,S.cT)(e.renderMarginRevertIcon,t.renderMarginRevertIcon),maxComputationTime:(0,S.o9)(e.maxComputationTime,t.maxComputationTime,0,1073741824),maxFileSize:(0,S.o9)(e.maxFileSize,t.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,S.cT)(e.ignoreTrimWhitespace,t.ignoreTrimWhitespace),renderIndicators:(0,S.cT)(e.renderIndicators,t.renderIndicators),originalEditable:(0,S.cT)(e.originalEditable,t.originalEditable),diffCodeLens:(0,S.cT)(e.diffCodeLens,t.diffCodeLens),renderOverviewRuler:(0,S.cT)(e.renderOverviewRuler,t.renderOverviewRuler),diffWordWrap:(i=e.diffWordWrap,o=t.diffWordWrap,(0,S.Oy)(i,o,["off","on","inherit"])),diffAlgorithm:(0,S.Oy)(e.diffAlgorithm,t.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,S.cT)(e.accessibilityVerbose,t.accessibilityVerbose)};var i,o}(0,fe.Sd)(((e,t)=>{const i=e.getColor(_e.Y$W);t.addRule(`\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${i} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${i} 50%, ${i} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`)}))},4708:function(e,t,i){"use strict";i.d(t,{c:function(){return m}});var o=i(31572),n=i(50420),r=i(39048),s=i(34948),d=i(90836),a=i(13016),l=i(85432),h=i(32736),c=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},u=function(e,t){return function(i,o){t(i,o,e)}};const g={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0,findResultLoop:!0};let m=class extends r.CC{constructor(e,t={},i,o,r){super(),this._audioCueService=i,this._codeEditorService=o,this._accessibilityService=r,this._onDidUpdate=this._register(new n.sl),this._editor=e,this._options=s.Cc(t,g,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidDispose((()=>this.dispose()))),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this._updateAccessibilityState(e.position.lineNumber),this.nextIdx=-1)}))),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel((e=>{this.revealFirst=!0}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach((e=>{!this._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((e=>{this.ranges.push({rhs:!0,range:new d.E(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):0===e.modifiedEndLineNumber?this.ranges.push({rhs:!0,range:new d.E(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new d.E(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber+1,1)})})),this.ranges.sort(((e,t)=>d.E.compareRangesUsingStarts(e.range,t.range))),this._onDidUpdate.fire(this)}_initIdx(e){let t=!1;const i=this._editor.getPosition();if(i){for(let o=0,n=this.ranges.length;o<n&&!t;o++){const n=this.ranges[o].range;i.isBeforeOrEqual(n.getStartPosition())&&(this.nextIdx=o+(e?0:-1),t=!0)}t||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(e,t){if(o.ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const i=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const e=i.range.getStartPosition();this._editor.setPosition(e),this._editor.revealRangeInCenter(i.range,t),this._updateAccessibilityState(e.lineNumber,!0)}finally{this.ignoreSelectionChange=!1}}_updateAccessibilityState(e,t){var i;const o=null===(i=this._editor.getModel())||void 0===i?void 0:i.modified;if(!o)return;const n=o.getLineDecorations(e).find((e=>"line-insert"===e.options.className));if(n)this._audioCueService.playAudioCue(a.Oi.diffLineModified,!0);else{if(!t)return;this._audioCueService.playAudioCue(a.Oi.diffLineDeleted,!0)}const r=this._codeEditorService.getActiveCodeEditor();t&&r&&n&&this._accessibilityService.isScreenReaderOptimized()&&(r.setSelection({startLineNumber:e,startColumn:0,endLineNumber:e,endColumn:Number.MAX_VALUE}),r.writeScreenReaderContent("diff-navigation"))}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this.canNavigateNext()&&this._move(!0,e)}previous(e=0){this.canNavigatePrevious()&&this._move(!1,e)}canNavigateNext(){return this.canNavigateLoop()||this.nextIdx<this.ranges.length-1}canNavigatePrevious(){return this.canNavigateLoop()||0!==this.nextIdx}canNavigateLoop(){return Boolean(this._options.findResultLoop)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}};m=c([u(2,a.yC),u(3,l.i),u(4,h.C)],m)},57648:function(e,t,i){"use strict";i.d(t,{g:function(){return f}});var o=i(34948),n=i(85432),r=i(61504),s=i(8296),d=i(93636),a=i(34572),l=i(41972),h=i(68992),c=i(32736),u=i(71456),g=i(42792),m=function(e,t,i,o){var n,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(s=(r<3?n(s):r>3?n(t,i,s):n(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},_=function(e,t){return function(i,o){t(i,o,e)}};let f=class extends r.qU{constructor(e,t,i,o,n,r,s,d,a,l,h,c,u){super(e,Object.assign(Object.assign({},o.getRawOptions()),{overflowWidgetsDomNode:o.getOverflowWidgetsDomNode()}),i,n,r,s,d,a,l,h,c,u),this._parentEditor=o,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(o.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){o.Cc(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};f=m([_(4,a.U9),_(5,n.i),_(6,s.a),_(7,d.KK),_(8,h.q0),_(9,l.sx),_(10,c.C),_(11,u.Gw),_(12,g.w)],f)},92584:function(e,t,i){var o=i(22108),n=i(79824);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);var r={insert:"head",singleton:!1};o(n,r);e.exports=n.locals||{}},11376:function(e,t,i){var o=i(22108),n=i(64804);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);var r={insert:"head",singleton:!1};o(n,r);e.exports=n.locals||{}},30980:function(e,t,i){var o=i(22108),n=i(53936);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.id,n,""]]);var r={insert:"head",singleton:!1};o(n,r);e.exports=n.locals||{}},79824:function(e,t,i){(e.exports=i(22587)(!1)).push([e.id,"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n/* ---------- DiffEditor ---------- */\n\n.monaco-diff-editor .diffOverview {\n\tz-index: 9;\n}\n\n.monaco-diff-editor .diffOverview .diffViewport {\n\tz-index: 10;\n}\n\n/* colors not externalized: using transparancy on background */\n.monaco-diff-editor.vs\t\t\t.diffOverview { background: rgba(0, 0, 0, 0.03); }\n.monaco-diff-editor.vs-dark\t\t.diffOverview { background: rgba(255, 255, 255, 0.01); }\n\n.monaco-scrollable-element.modified-in-monaco-diff-editor.vs\t\t.scrollbar { background: rgba(0,0,0,0); }\n.monaco-scrollable-element.modified-in-monaco-diff-editor.vs-dark\t.scrollbar { background: rgba(0,0,0,0); }\n.monaco-scrollable-element.modified-in-monaco-diff-editor.hc-black\t.scrollbar { background: none; }\n.monaco-scrollable-element.modified-in-monaco-diff-editor.hc-light\t.scrollbar { background: none; }\n\n.monaco-scrollable-element.modified-in-monaco-diff-editor .slider {\n\tz-index: 10;\n}\n.modified-in-monaco-diff-editor\t\t\t\t.slider.active { background: rgba(171, 171, 171, .4); }\n.modified-in-monaco-diff-editor.hc-black\t.slider.active { background: none; }\n.modified-in-monaco-diff-editor.hc-light\t.slider.active { background: none; }\n\n/* ---------- Diff ---------- */\n\n.monaco-editor .insert-sign,\n.monaco-diff-editor .insert-sign,\n.monaco-editor .delete-sign,\n.monaco-diff-editor .delete-sign {\n\tfont-size: 11px !important;\n\topacity: 0.7 !important;\n\tdisplay: flex !important;\n\talign-items: center;\n}\n.monaco-editor.hc-black .insert-sign,\n.monaco-diff-editor.hc-black .insert-sign,\n.monaco-editor.hc-black .delete-sign,\n.monaco-diff-editor.hc-black .delete-sign,\n.monaco-editor.hc-light .insert-sign,\n.monaco-diff-editor.hc-light .insert-sign,\n.monaco-editor.hc-light .delete-sign,\n.monaco-diff-editor.hc-light .delete-sign {\n\topacity: 1;\n}\n\n.monaco-editor .inline-deleted-margin-view-zone {\n\ttext-align: right;\n}\n.monaco-editor .inline-added-margin-view-zone {\n\ttext-align: right;\n}\n\n.monaco-editor .arrow-revert-change {\n\tz-index: 10;\n\tposition: absolute;\n}\n\n.monaco-editor .arrow-revert-change:hover {\n\tcursor: pointer;\n}\n\n/* ---------- Inline Diff ---------- */\n\n.monaco-editor .view-zones .view-lines .view-line span {\n\tdisplay: inline-block;\n}\n\n.monaco-editor .margin-view-zones .lightbulb-glyph:hover {\n\tcursor: pointer;\n}\n\n.monaco-editor .char-insert, .monaco-diff-editor .char-insert {\n\tbackground-color: var(--vscode-diffEditor-insertedTextBackground);\n}\n\n.monaco-editor .line-insert, .monaco-diff-editor .line-insert {\n\tbackground-color: var(--vscode-diffEditor-insertedLineBackground, --vscode-diffEditor-insertedTextBackground);\n}\n\n.monaco-editor .line-insert,\n.monaco-editor .char-insert {\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-diffEditor-insertedTextBorder);\n}\n.monaco-editor.hc-black .line-insert, .monaco-editor.hc-light .line-insert,\n.monaco-editor.hc-black .char-insert, .monaco-editor.hc-light .char-insert {\n\tborder-style: dashed;\n}\n\n.monaco-editor .line-delete,\n.monaco-editor .char-delete {\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-diffEditor-removedTextBorder);\n}\n.monaco-editor.hc-black .line-delete, .monaco-editor.hc-light .line-delete,\n.monaco-editor.hc-black .char-delete, .monaco-editor.hc-light .char-delete {\n\tborder-style: dashed;\n}\n\n.monaco-editor .inline-added-margin-view-zone,\n.monaco-editor .gutter-insert, .monaco-diff-editor .gutter-insert {\n\tbackground-color: var(--vscode-diffEditorGutter-insertedLineBackground, --vscode-diffEditor-insertedLineBackground, --vscode-diffEditor-insertedTextBackground);\n}\n\n.monaco-editor .char-delete, .monaco-diff-editor .char-delete {\n\tbackground-color: var(--vscode-diffEditor-removedTextBackground);\n}\n\n.monaco-editor .line-delete, .monaco-diff-editor .line-delete {\n\tbackground-color: var(--vscode-diffEditor-removedLineBackground, --vscode-diffEditor-removedTextBackground);\n}\n\n.monaco-editor .inline-deleted-margin-view-zone,\n.monaco-editor .gutter-delete, .monaco-diff-editor .gutter-delete {\n\tbackground-color: var(--vscode-diffEditorGutter-removedLineBackground, --vscode-diffEditor-removedLineBackground, --vscode-diffEditor-removedTextBackground);\n}\n\n.monaco-diff-editor.side-by-side .editor.modified {\n\tbox-shadow: -6px 0 5px -5px var(--vscode-scrollbar-shadow);\n\tborder-left: 1px solid var(--vscode-diffEditor-border);\n}\n\n.monaco-diff-editor .diffViewport {\n\tbackground: var(--vscode-scrollbarSlider-background);\n}\n\n.monaco-diff-editor .diffViewport:hover {\n\tbackground: var(--vscode-scrollbarSlider-hoverBackground);\n}\n\n.monaco-diff-editor .diffViewport:active {\n\tbackground: var(--vscode-scrollbarSlider-activeBackground);\n}\n",""])},64804:function(e,t,i){(e.exports=i(22587)(!1)).push([e.id,"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n.monaco-diff-editor .diff-review-line-number {\n\ttext-align: right;\n\tdisplay: inline-block;\n\tcolor: var(--vscode-editorLineNumber-foreground);\n}\n\n.monaco-diff-editor .diff-review {\n\tposition: absolute;\n\tuser-select: none;\n\t-webkit-user-select: none;\n}\n\n.monaco-diff-editor .diff-review-summary {\n\tpadding-left: 10px;\n}\n\n.monaco-diff-editor .diff-review-shadow {\n\tposition: absolute;\n\tbox-shadow: var(--vscode-scrollbar-shadow) 0 -6px 6px -6px inset;\n}\n\n.monaco-diff-editor .diff-review-row {\n\twhite-space: pre;\n}\n\n.monaco-diff-editor .diff-review-table {\n\tdisplay: table;\n\tmin-width: 100%;\n}\n\n.monaco-diff-editor .diff-review-row {\n\tdisplay: table-row;\n\twidth: 100%;\n}\n\n.monaco-diff-editor .diff-review-spacer {\n\tdisplay: inline-block;\n\twidth: 10px;\n\tvertical-align: middle;\n}\n\n.monaco-diff-editor .diff-review-spacer > .codicon {\n\tfont-size: 9px !important;\n}\n\n.monaco-diff-editor .diff-review-actions {\n\tdisplay: inline-block;\n\tposition: absolute;\n\tright: 10px;\n\ttop: 2px;\n}\n\n.monaco-diff-editor .diff-review-actions .action-label {\n\twidth: 16px;\n\theight: 16px;\n\tmargin: 2px 0;\n}\n",""])},53936:function(e,t,i){(e.exports=i(22587)(!1)).push([e.id,"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* -------------------- IE10 remove auto clear button -------------------- */\n\n::-ms-clear {\n\tdisplay: none;\n}\n\n/* All widgets */\n/* I am not a big fan of this rule */\n.monaco-editor .editor-widget input {\n\tcolor: inherit;\n}\n\n/* -------------------- Editor -------------------- */\n\n.monaco-editor {\n\tposition: relative;\n\toverflow: visible;\n\t-webkit-text-size-adjust: 100%;\n\tcolor: var(--vscode-editor-foreground);\n\tbackground-color: var(--vscode-editor-background);\n}\n.monaco-editor-background {\n\tbackground-color: var(--vscode-editor-background);\n}\n.monaco-editor .rangeHighlight {\n\tbackground-color: var(--vscode-editor-rangeHighlightBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-rangeHighlightBorder);\n}\n.monaco-editor.hc-black .rangeHighlight, .monaco-editor.hc-light .rangeHighlight {\n\tborder-style: dotted;\n}\n.monaco-editor .symbolHighlight {\n\tbackground-color: var(--vscode-editor-symbolHighlightBackground);\n\tbox-sizing: border-box;\n\tborder: 1px solid var(--vscode-editor-symbolHighlightBorder);\n}\n.monaco-editor.hc-black .symbolHighlight, .monaco-editor.hc-light .symbolHighlight {\n\tborder-style: dotted;\n}\n\n/* -------------------- Misc -------------------- */\n\n.monaco-editor .overflow-guard {\n\tposition: relative;\n\toverflow: hidden;\n}\n\n.monaco-editor .view-overlays {\n\tposition: absolute;\n\ttop: 0;\n}\n\n/*\n.monaco-editor .auto-closed-character {\n\topacity: 0.3;\n}\n*/\n\n\n.monaco-editor .squiggly-error {\n\tborder-bottom: 4px double var(--vscode-editorError-border);\n}\n.monaco-editor .squiggly-error::before {\n\tdisplay: block;\n\tcontent: '';\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--vscode-editorError-background);\n}\n.monaco-editor .squiggly-warning {\n\tborder-bottom: 4px double var(--vscode-editorWarning-border);\n}\n.monaco-editor .squiggly-warning::before {\n\tdisplay: block;\n\tcontent: '';\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--vscode-editorWarning-background);\n}\n.monaco-editor .squiggly-info {\n\tborder-bottom: 4px double var(--vscode-editorInfo-border);\n}\n.monaco-editor .squiggly-info::before {\n\tdisplay: block;\n\tcontent: '';\n\twidth: 100%;\n\theight: 100%;\n\tbackground: var(--vscode-editorInfo-background);\n}\n.monaco-editor .squiggly-hint {\n\tborder-bottom: 2px dotted var(--vscode-editorHint-border);\n}\n.monaco-editor.showUnused .squiggly-unnecessary {\n\tborder-bottom: 2px dashed var(--vscode-editorUnnecessaryCode-border);\n}\n.monaco-editor.showDeprecated .squiggly-inline-deprecated {\n\ttext-decoration: line-through;\n\ttext-decoration-color: var(--vscode-editor-foreground, inherit);\n}\n",""])}}]);